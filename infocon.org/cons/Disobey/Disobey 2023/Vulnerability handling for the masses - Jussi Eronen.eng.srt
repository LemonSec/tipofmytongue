1
00:00:01,199 --> 00:00:04,199
foreign

2
00:00:08,290 --> 00:00:11,469
[Music]

3
00:00:14,170 --> 00:00:17,259
[Music]

4
00:00:21,480 --> 00:00:26,530
[Music]

5
00:00:32,940 --> 00:00:36,309
[Music]

6
00:00:45,600 --> 00:00:48,059
so hi everyone

7
00:00:48,059 --> 00:00:50,579
I'm UC uh

8
00:00:50,579 --> 00:00:53,579
uh

9
00:00:56,039 --> 00:00:58,079
and I'm here to talk about vulnerability

10
00:00:58,079 --> 00:00:59,460
handling

11
00:00:59,460 --> 00:01:03,840
in a large scale the massive scale

12
00:01:03,840 --> 00:01:05,280
that's

13
00:01:05,280 --> 00:01:08,700
vulnerability handling for the masses so

14
00:01:08,700 --> 00:01:09,780
um

15
00:01:09,780 --> 00:01:12,600
I started out in vulnerabilities back in

16
00:01:12,600 --> 00:01:14,280
99

17
00:01:14,280 --> 00:01:16,619
uh there was a

18
00:01:16,619 --> 00:01:19,320
Universal research research group up in

19
00:01:19,320 --> 00:01:21,240
all of our uspg

20
00:01:21,240 --> 00:01:24,060
we did something that was we tried to

21
00:01:24,060 --> 00:01:26,460
call robustness testing

22
00:01:26,460 --> 00:01:28,500
but everyone else started to talk uh

23
00:01:28,500 --> 00:01:30,600
talk about fuzzing so that's what it is

24
00:01:30,600 --> 00:01:34,259
and I think the first vulnerability I

25
00:01:34,259 --> 00:01:35,820
found out was

26
00:01:35,820 --> 00:01:38,640
actually in I calendar so if you looked

27
00:01:38,640 --> 00:01:41,759
at turmer's presentation earlier

28
00:01:41,759 --> 00:01:43,500
those are still abound

29
00:01:43,500 --> 00:01:45,119
uh

30
00:01:45,119 --> 00:01:47,159
and

31
00:01:47,159 --> 00:01:50,520
we had the idea back then that finding

32
00:01:50,520 --> 00:01:52,259
bugs is pretty hard finding

33
00:01:52,259 --> 00:01:53,640
vulnerability is pretty hard and that's

34
00:01:53,640 --> 00:01:55,079
why you need to have an engineering

35
00:01:55,079 --> 00:01:57,119
approach to finding vulnerabilities

36
00:01:57,119 --> 00:01:58,740
turns out

37
00:01:58,740 --> 00:02:01,979
uh finding vulnerabilities was

38
00:02:01,979 --> 00:02:05,640
actually pretty easy it still kind of is

39
00:02:05,640 --> 00:02:08,038
and uh

40
00:02:08,038 --> 00:02:10,318
my research problem turned into okay

41
00:02:10,318 --> 00:02:12,660
what now now that there are all these

42
00:02:12,660 --> 00:02:14,700
vulnerabilities out there and that

43
00:02:14,700 --> 00:02:16,620
brings me nicely

44
00:02:16,620 --> 00:02:18,840
looks like looks as though I planned it

45
00:02:18,840 --> 00:02:22,020
but I didn't to ncsc fi to National

46
00:02:22,020 --> 00:02:24,720
cyber security Center Finland where we

47
00:02:24,720 --> 00:02:27,120
think about okay what do we do

48
00:02:27,120 --> 00:02:29,280
now that we know that we have all these

49
00:02:29,280 --> 00:02:31,760
vulnerabilities

50
00:02:32,040 --> 00:02:35,280
uh I'm not going to do an intro on on

51
00:02:35,280 --> 00:02:38,220
ncsc suffice to say

52
00:02:38,220 --> 00:02:41,580
that this is our goal it's an old slide

53
00:02:41,580 --> 00:02:43,739
from Erica who might be there somewhere

54
00:02:43,739 --> 00:02:45,720
uh

55
00:02:45,720 --> 00:02:48,420
uh but the idea general idea is that we

56
00:02:48,420 --> 00:02:50,519
work towards a safer internet

57
00:02:50,519 --> 00:02:53,580
and well our mandate is in Finland so

58
00:02:53,580 --> 00:02:57,540
mostly safely safer Finnish internet

59
00:02:57,540 --> 00:02:59,819
uh I looked at our case Android

60
00:02:59,819 --> 00:03:01,760
repository

61
00:03:01,760 --> 00:03:05,640
and we do get all kinds of reports so

62
00:03:05,640 --> 00:03:07,860
I'll have to cheat a bit here you'll not

63
00:03:07,860 --> 00:03:10,200
you understand in a while

64
00:03:10,200 --> 00:03:13,019
so in recent months we had you know

65
00:03:13,019 --> 00:03:15,319
Services services from these

66
00:03:15,319 --> 00:03:17,819
disturbances some of them are maintain

67
00:03:17,819 --> 00:03:20,220
breaks actually but their report is just

68
00:03:20,220 --> 00:03:23,040
disturbances unwanted marketing cookie

69
00:03:23,040 --> 00:03:25,319
related issues spam spam spreading

70
00:03:25,319 --> 00:03:28,620
malware sex extortion scan all 365

71
00:03:28,620 --> 00:03:31,080
fishing bank fishing other forms of

72
00:03:31,080 --> 00:03:34,200
fishing whaling CEO of Road business

73
00:03:34,200 --> 00:03:37,140
email compromise SMS spam MMS spam

74
00:03:37,140 --> 00:03:39,480
number four juries International Revenue

75
00:03:39,480 --> 00:03:41,640
share fraud other types of Telecom fraud

76
00:03:41,640 --> 00:03:43,980
When giri Calls tech support scams

77
00:03:43,980 --> 00:03:46,379
investment scams Dragon death Dragon's

78
00:03:46,379 --> 00:03:49,440
Den scams romance camps subscript

79
00:03:49,440 --> 00:03:51,959
subscription traps other kinds of social

80
00:03:51,959 --> 00:03:55,739
media scams web shops uh fake web shops

81
00:03:55,739 --> 00:03:57,659
digital skimming information Steelers

82
00:03:57,659 --> 00:03:59,519
coin miners other kinds of malware

83
00:03:59,519 --> 00:04:01,860
botnets break-ins data leaks Key

84
00:04:01,860 --> 00:04:04,680
Management mishaps targeted attacks and

85
00:04:04,680 --> 00:04:06,540
well that's probably not all of it but

86
00:04:06,540 --> 00:04:09,780
that's what I could discern from it so

87
00:04:09,780 --> 00:04:14,700
in our case it's pretty easy actually to

88
00:04:14,700 --> 00:04:17,459
like think forget about vulnerability so

89
00:04:17,459 --> 00:04:18,779
I think that vulnerability is honest

90
00:04:18,779 --> 00:04:20,160
important

91
00:04:20,160 --> 00:04:22,380
but the fact is that in even in those

92
00:04:22,380 --> 00:04:25,080
cases vulnerabilities do play a role in

93
00:04:25,080 --> 00:04:26,940
some cases a major role

94
00:04:26,940 --> 00:04:28,259
so

95
00:04:28,259 --> 00:04:30,419
I'm going to speak about vulnerabilities

96
00:04:30,419 --> 00:04:32,400
from our context

97
00:04:32,400 --> 00:04:35,160
and the case might might not be

98
00:04:35,160 --> 00:04:37,380
all that familiar to some of you but I

99
00:04:37,380 --> 00:04:39,600
think it's all good fun anyway

100
00:04:39,600 --> 00:04:42,600
mostly when when search guys talk about

101
00:04:42,600 --> 00:04:44,280
vulnerabilities you see a chart

102
00:04:44,280 --> 00:04:46,380
something like this uh this is a

103
00:04:46,380 --> 00:04:49,440
vulnerability handling standards

104
00:04:49,440 --> 00:04:51,600
in the middle there are two standards

105
00:04:51,600 --> 00:04:54,060
for vendors on vulnerability disclosure

106
00:04:54,060 --> 00:04:57,300
how to get reports in how to handle them

107
00:04:57,300 --> 00:04:59,940
and on the right side how the

108
00:04:59,940 --> 00:05:02,220
vulnerability handling process goes

109
00:05:02,220 --> 00:05:06,680
after the initial disclosure

110
00:05:07,259 --> 00:05:10,320
the iso folks helpfully have disregarded

111
00:05:10,320 --> 00:05:12,600
the role of the of the reporter the

112
00:05:12,600 --> 00:05:13,620
researcher

113
00:05:13,620 --> 00:05:16,979
but I amended this chart with the ones

114
00:05:16,979 --> 00:05:19,979
from third CC who should know the thing

115
00:05:19,979 --> 00:05:21,540
they've been handling vulnerabilities

116
00:05:21,540 --> 00:05:25,320
since 1988 the Morris one so there's a

117
00:05:25,320 --> 00:05:26,960
researcher who discovers something

118
00:05:26,960 --> 00:05:29,460
reports it maybe through a coordinator

119
00:05:29,460 --> 00:05:31,800
and this is the part where I advertise

120
00:05:31,800 --> 00:05:33,720
that hey we do this also if you find a

121
00:05:33,720 --> 00:05:35,639
vulnerability suspect something you can

122
00:05:35,639 --> 00:05:37,800
contact us but I'm not going to talk

123
00:05:37,800 --> 00:05:39,360
about any of this

124
00:05:39,360 --> 00:05:42,120
this part look I'm not a vendor I'm not

125
00:05:42,120 --> 00:05:44,699
going to talk about our coordination

126
00:05:44,699 --> 00:05:47,160
uh triage anything like that I'm going

127
00:05:47,160 --> 00:05:50,460
to talk about what happens after all of

128
00:05:50,460 --> 00:05:54,660
this after the fix has been done or

129
00:05:54,660 --> 00:05:57,240
in some other way the vulnerability data

130
00:05:57,240 --> 00:05:58,620
is published

131
00:05:58,620 --> 00:06:02,280
after that we get into the realm where

132
00:06:02,280 --> 00:06:04,440
the Defenders should deploy the fixes

133
00:06:04,440 --> 00:06:06,000
because the attackers are already

134
00:06:06,000 --> 00:06:08,520
starting to exploit them

135
00:06:08,520 --> 00:06:10,560
for the uh

136
00:06:10,560 --> 00:06:13,680
end users there's another cycle there

137
00:06:13,680 --> 00:06:16,199
are lots of graphs related to this one I

138
00:06:16,199 --> 00:06:19,020
used one from Gartner basically because

139
00:06:19,020 --> 00:06:20,820
it has all these not all these nice

140
00:06:20,820 --> 00:06:21,960
icons

141
00:06:21,960 --> 00:06:27,660
so basically uh event uh targets or a

142
00:06:27,660 --> 00:06:29,940
Defender should access

143
00:06:29,940 --> 00:06:34,500
the infrastructure and see whether this

144
00:06:34,500 --> 00:06:36,960
vulnerability poses a threat to them

145
00:06:36,960 --> 00:06:39,060
has have a list of Prior uh

146
00:06:39,060 --> 00:06:41,100
vulnerabilities prioritize them at

147
00:06:41,100 --> 00:06:43,139
context then

148
00:06:43,139 --> 00:06:46,680
act to do something oh well well accept

149
00:06:46,680 --> 00:06:48,840
the risk not to do something

150
00:06:48,840 --> 00:06:51,660
there are no songs for the other icons I

151
00:06:51,660 --> 00:06:53,759
wish they were so we have a song for

152
00:06:53,759 --> 00:06:56,819
acceptories but maybe we should have for

153
00:06:56,819 --> 00:06:59,280
the rest of them and after that they

154
00:06:59,280 --> 00:07:01,500
should check whether

155
00:07:01,500 --> 00:07:04,680
it worked basically and then improved

156
00:07:04,680 --> 00:07:06,060
the cycle you know

157
00:07:06,060 --> 00:07:08,460
they are of course there's a whole

158
00:07:08,460 --> 00:07:09,900
industry

159
00:07:09,900 --> 00:07:12,000
trying to help defend us with this

160
00:07:12,000 --> 00:07:13,880
there's attack service management

161
00:07:13,880 --> 00:07:17,580
uh vulnerability data exchanges uh

162
00:07:17,580 --> 00:07:20,340
scanning services and so on and so forth

163
00:07:20,340 --> 00:07:23,340
so what's the problem why am I why am I

164
00:07:23,340 --> 00:07:24,419
still here

165
00:07:24,419 --> 00:07:27,120
it's because because of this well this

166
00:07:27,120 --> 00:07:29,160
is one of just one example from a couple

167
00:07:29,160 --> 00:07:30,479
of weeks ago

168
00:07:30,479 --> 00:07:33,479
there was a vulnerability two years ago

169
00:07:33,479 --> 00:07:35,759
and uh

170
00:07:35,759 --> 00:07:39,360
it was uh related to me and the ESX

171
00:07:39,360 --> 00:07:41,720
instances you needed to have a port open

172
00:07:41,720 --> 00:07:44,580
not only to have a vulnerable service

173
00:07:44,580 --> 00:07:47,400
but also to misconfigure it to have a

174
00:07:47,400 --> 00:07:49,259
port open that somebody could exploit it

175
00:07:49,259 --> 00:07:52,680
and still hey we have a huge problem so

176
00:07:52,680 --> 00:07:54,660
in spite of everything that people are

177
00:07:54,660 --> 00:07:59,160
doing we still have issues Finland had

178
00:07:59,160 --> 00:08:02,759
I think 90 of these servers mostly

179
00:08:02,759 --> 00:08:04,680
because of the data centers in Finland

180
00:08:04,680 --> 00:08:07,380
though so it was not a big deal but

181
00:08:07,380 --> 00:08:09,300
oftentimes these are

182
00:08:09,300 --> 00:08:11,759
so that's why I'm talking about

183
00:08:11,759 --> 00:08:14,099
vulnerability handling for the masses in

184
00:08:14,099 --> 00:08:17,099
order to keep the internet safe in order

185
00:08:17,099 --> 00:08:18,720
to keep the Finnish internet safe we

186
00:08:18,720 --> 00:08:21,419
have to take care of this part we have

187
00:08:21,419 --> 00:08:23,879
to remove vulnerable systems from the

188
00:08:23,879 --> 00:08:26,099
from the internet

189
00:08:26,099 --> 00:08:30,660
and uh as as a third we are pretty well

190
00:08:30,660 --> 00:08:32,339
um

191
00:08:32,339 --> 00:08:35,279
first to handle handle this I'm not

192
00:08:35,279 --> 00:08:37,380
going to talk about a law the law a lot

193
00:08:37,380 --> 00:08:39,958
I have a few legal slides

194
00:08:39,958 --> 00:08:42,659
this one is there to demonstrate that we

195
00:08:42,659 --> 00:08:44,520
actually have a capability written in

196
00:08:44,520 --> 00:08:47,279
the law that says that we can

197
00:08:47,279 --> 00:08:50,880
uh if need be forced the removal of

198
00:08:50,880 --> 00:08:53,580
system that causes hindrances to the to

199
00:08:53,580 --> 00:08:57,060
the network so yeah we can do this

200
00:08:57,060 --> 00:08:59,640
that's why we well

201
00:08:59,640 --> 00:09:02,160
should do this all the more

202
00:09:02,160 --> 00:09:05,820
obviously we can't it's not Pokemon we

203
00:09:05,820 --> 00:09:07,920
can't catch them all we can't remove all

204
00:09:07,920 --> 00:09:09,779
of the vulnerabilities from the from the

205
00:09:09,779 --> 00:09:12,360
internet so we have to focus our efforts

206
00:09:12,360 --> 00:09:15,300
we well we have a lot of people nowadays

207
00:09:15,300 --> 00:09:16,920
but even though

208
00:09:16,920 --> 00:09:21,000
we can't really uh do anything about all

209
00:09:21,000 --> 00:09:22,560
of this

210
00:09:22,560 --> 00:09:25,320
which ones do we start from the obvious

211
00:09:25,320 --> 00:09:27,540
ones are the ones that you see from the

212
00:09:27,540 --> 00:09:29,339
media the vulnerabilities such as the

213
00:09:29,339 --> 00:09:32,640
ex's ESX vulnerability there will be

214
00:09:32,640 --> 00:09:35,040
reports all over so it's a no-brainer we

215
00:09:35,040 --> 00:09:36,420
should look into that we should

216
00:09:36,420 --> 00:09:38,339
prioritize that probably at least

217
00:09:38,339 --> 00:09:41,120
investigate it

218
00:09:41,519 --> 00:09:43,500
but what about the others

219
00:09:43,500 --> 00:09:45,839
uh

220
00:09:45,839 --> 00:09:48,959
I'm pointing out a couple of

221
00:09:48,959 --> 00:09:52,080
a couple of resources one is the uh

222
00:09:52,080 --> 00:09:55,140
seesaw well our colleague agency from

223
00:09:55,140 --> 00:09:59,700
from the U.S that has a catalog of uh

224
00:09:59,700 --> 00:10:02,279
vulnerabilities that are under active

225
00:10:02,279 --> 00:10:04,740
exploitation the known exploit exploited

226
00:10:04,740 --> 00:10:06,839
vulnerability catalog if something Rises

227
00:10:06,839 --> 00:10:09,300
up to here it usually means that there's

228
00:10:09,300 --> 00:10:11,459
attack activity there is a proof of

229
00:10:11,459 --> 00:10:13,019
concept there is more than a proof of

230
00:10:13,019 --> 00:10:16,380
concept X exploit and that's a priority

231
00:10:16,380 --> 00:10:19,260
on the other thing there is the

232
00:10:19,260 --> 00:10:22,620
uh EPS score which basically says that

233
00:10:22,620 --> 00:10:26,100
uh these are the exploit prediction

234
00:10:26,100 --> 00:10:27,779
scoring system that's where it comes

235
00:10:27,779 --> 00:10:29,820
from basically means that these are the

236
00:10:29,820 --> 00:10:31,800
vulnerabilities that are more likely to

237
00:10:31,800 --> 00:10:33,839
be exploited in the coming

238
00:10:33,839 --> 00:10:37,980
um Coming days weeks months so these

239
00:10:37,980 --> 00:10:39,920
are kind of like the hints to prioritize

240
00:10:39,920 --> 00:10:43,380
vulnerabilities so where to start from

241
00:10:43,380 --> 00:10:45,740
so in order to

242
00:10:45,740 --> 00:10:49,140
defend Finland we need to know what

243
00:10:49,140 --> 00:10:52,079
Finland is and well in this case it's

244
00:10:52,079 --> 00:10:53,640
nowhere near on a map

245
00:10:53,640 --> 00:10:57,540
so what is Finland in the scope of

246
00:10:57,540 --> 00:10:59,399
Networks

247
00:10:59,399 --> 00:11:01,140
uh

248
00:11:01,140 --> 00:11:04,200
the basic answer on on the basic answer

249
00:11:04,200 --> 00:11:07,019
from what is Finland starts from routing

250
00:11:07,019 --> 00:11:10,079
if a packet finds a way to the Finnish

251
00:11:10,079 --> 00:11:13,260
networks then well there's a routing uh

252
00:11:13,260 --> 00:11:16,980
relationship somewhere and uh we know

253
00:11:16,980 --> 00:11:18,720
the owner of the

254
00:11:18,720 --> 00:11:21,300
of the networks that are are in the

255
00:11:21,300 --> 00:11:22,860
routing Network called the autonomous

256
00:11:22,860 --> 00:11:24,000
systems

257
00:11:24,000 --> 00:11:28,680
if we know if we know of the uh networks

258
00:11:28,680 --> 00:11:30,540
that belong The Finnish operators

259
00:11:30,540 --> 00:11:32,040
Finnish companies

260
00:11:32,040 --> 00:11:35,339
uh well we can track those and we can

261
00:11:35,339 --> 00:11:37,500
track from a router real time which

262
00:11:37,500 --> 00:11:42,660
networks they they have and well so on

263
00:11:42,660 --> 00:11:46,140
so a basic methodology has actually as

264
00:11:46,140 --> 00:11:48,660
it started was to print out the list of

265
00:11:48,660 --> 00:11:51,120
all the ass and okay this sounds

266
00:11:51,120 --> 00:11:53,220
finished let's put it in the list uh

267
00:11:53,220 --> 00:11:55,019
this sounds like something that is

268
00:11:55,019 --> 00:11:56,820
crucial to the functioning of the

269
00:11:56,820 --> 00:11:58,320
Finnish critical infrastructure of the

270
00:11:58,320 --> 00:12:00,899
society so okay we should be we should

271
00:12:00,899 --> 00:12:02,820
put that on the list

272
00:12:02,820 --> 00:12:04,200
and

273
00:12:04,200 --> 00:12:07,260
currently well not currently it was

274
00:12:07,260 --> 00:12:10,740
Monday on Monday this meant that there

275
00:12:10,740 --> 00:12:12,079
were

276
00:12:12,079 --> 00:12:16,320
245 autonomous systems that we mostly

277
00:12:16,320 --> 00:12:18,540
are interested about

278
00:12:18,540 --> 00:12:19,980
this is

279
00:12:19,980 --> 00:12:23,160
probably should be refreshed it should

280
00:12:23,160 --> 00:12:25,260
be refreshed more often than we do to be

281
00:12:25,260 --> 00:12:28,200
to be really Frank they have

282
00:12:28,200 --> 00:12:32,399
uh something like 1 300 IP ranges or

283
00:12:32,399 --> 00:12:33,480
ciders

284
00:12:33,480 --> 00:12:37,980
are ranging from slash 14 to slash 24 I

285
00:12:37,980 --> 00:12:41,640
think and that amounts to an IP space of

286
00:12:41,640 --> 00:12:45,899
close to 15 to 16 million IP addresses

287
00:12:45,899 --> 00:12:48,860
and that is

288
00:12:48,860 --> 00:12:51,420
disregarding the fact that it doesn't

289
00:12:51,420 --> 00:12:54,720
that tries to account for the fact that

290
00:12:54,720 --> 00:12:57,480
some of the autonomous systems are not

291
00:12:57,480 --> 00:13:00,540
exclusive to Finland we try to only take

292
00:13:00,540 --> 00:13:02,639
the Finnish IPS but in some cases that's

293
00:13:02,639 --> 00:13:04,680
difficult

294
00:13:04,680 --> 00:13:06,779
we are trying to look into other things

295
00:13:06,779 --> 00:13:08,040
besides

296
00:13:08,040 --> 00:13:10,920
uh you could of course look at the map

297
00:13:10,920 --> 00:13:12,839
you could look at different geoip

298
00:13:12,839 --> 00:13:16,320
servers services on what is Finland what

299
00:13:16,320 --> 00:13:19,620
is Finnish and we kind of do for example

300
00:13:19,620 --> 00:13:22,200
it's no secret that we do a lot of work

301
00:13:22,200 --> 00:13:24,300
with some of the internet superheroes

302
00:13:24,300 --> 00:13:26,940
like such as the Cyrus server and they

303
00:13:26,940 --> 00:13:30,000
send us two files each day this is The

304
00:13:30,000 --> 00:13:32,519
Finnish geographic region and this is

305
00:13:32,519 --> 00:13:34,800
The Finnish uh these are all the

306
00:13:34,800 --> 00:13:36,420
problems that we see from the suny's

307
00:13:36,420 --> 00:13:38,459
geographical region and these are the

308
00:13:38,459 --> 00:13:40,980
Finnish as and so they are two different

309
00:13:40,980 --> 00:13:42,060
things

310
00:13:42,060 --> 00:13:44,300
uh we could look at all the different

311
00:13:44,300 --> 00:13:48,779
Registries uh for example The Ripe who

312
00:13:48,779 --> 00:13:51,300
is database the problem with that is

313
00:13:51,300 --> 00:13:53,579
that it contains a lot of outdated data

314
00:13:53,579 --> 00:13:55,860
for example many of the state networks

315
00:13:55,860 --> 00:13:58,220
are registered under under

316
00:13:58,220 --> 00:14:01,860
vtkk the state uh

317
00:14:01,860 --> 00:14:05,600
computer center which was a thing until

318
00:14:05,600 --> 00:14:10,940
1992 so it hasn't existed in this

319
00:14:10,940 --> 00:14:13,260
Century but it's still down the record

320
00:14:13,260 --> 00:14:16,740
so that's kind of like doubtful uh

321
00:14:16,740 --> 00:14:19,019
there are services that try to clean it

322
00:14:19,019 --> 00:14:20,519
up we've been looking into those

323
00:14:20,519 --> 00:14:23,100
periodically and say that okay well we

324
00:14:23,100 --> 00:14:26,760
can take those things but usually uh it

325
00:14:26,760 --> 00:14:28,500
doesn't really

326
00:14:28,500 --> 00:14:31,860
we should uh update that continuously

327
00:14:31,860 --> 00:14:33,600
because the network changes I'll have an

328
00:14:33,600 --> 00:14:35,940
ex concrete example of that later we

329
00:14:35,940 --> 00:14:38,519
could look at domains.fi.ax that's a

330
00:14:38,519 --> 00:14:40,500
long work in progress actually

331
00:14:40,500 --> 00:14:43,680
uh where the actual domains are located

332
00:14:43,680 --> 00:14:45,240
and

333
00:14:45,240 --> 00:14:48,480
try to look at their vulnerabilities uh

334
00:14:48,480 --> 00:14:51,139
we are in the process of

335
00:14:51,139 --> 00:14:53,519
gathering.com.net dot whatever and

336
00:14:53,519 --> 00:14:55,940
looking at finished brands from there

337
00:14:55,940 --> 00:14:58,500
uh you can look at passive DNS

338
00:14:58,500 --> 00:15:00,540
certificate certificate transparency

339
00:15:00,540 --> 00:15:03,740
list for the things uh

340
00:15:03,740 --> 00:15:06,360
sub-domains for example to to the

341
00:15:06,360 --> 00:15:08,459
domains that won't appear in the TLD

342
00:15:08,459 --> 00:15:11,579
lists uh Jonas Workshop

343
00:15:11,579 --> 00:15:14,579
uh earlier today had some great

344
00:15:14,579 --> 00:15:17,000
resources in on how to actually do this

345
00:15:17,000 --> 00:15:19,680
uh you should check those you should

346
00:15:19,680 --> 00:15:21,420
check their slides

347
00:15:21,420 --> 00:15:23,459
if you're interested in this we've been

348
00:15:23,459 --> 00:15:25,320
Gathering Cloud infrastructure with the

349
00:15:25,320 --> 00:15:27,839
help of our partners so basically saying

350
00:15:27,839 --> 00:15:30,060
to companies that if you want us to give

351
00:15:30,060 --> 00:15:33,839
you better service uh please let us know

352
00:15:33,839 --> 00:15:36,600
in real time which Cloud IPS you are

353
00:15:36,600 --> 00:15:39,000
using and we've been scanning those for

354
00:15:39,000 --> 00:15:41,459
example in in the case of log for Shell

355
00:15:41,459 --> 00:15:44,519
so we could look at

356
00:15:44,519 --> 00:15:47,579
are there any obvious entry points for

357
00:15:47,579 --> 00:15:50,339
that vulnerability we are having a new

358
00:15:50,339 --> 00:15:52,199
project looking at the supply chain

359
00:15:52,199 --> 00:15:54,540
basically trying to figure out whether

360
00:15:54,540 --> 00:15:57,720
we should prioritize uh providers that

361
00:15:57,720 --> 00:15:59,880
uh people are using for example you

362
00:15:59,880 --> 00:16:02,160
could look at DNS txt records and work

363
00:16:02,160 --> 00:16:03,720
your way from there

364
00:16:03,720 --> 00:16:05,459
but there's a lot of stuff and we are

365
00:16:05,459 --> 00:16:08,279
trying to explore all of that but we

366
00:16:08,279 --> 00:16:11,160
already had a list of 15 to 60 million

367
00:16:11,160 --> 00:16:13,339
IPS so there's quite a lot to work with

368
00:16:13,339 --> 00:16:16,680
to to begin with the next obvious

369
00:16:16,680 --> 00:16:18,899
question the next obvious questions is

370
00:16:18,899 --> 00:16:20,399
about oh

371
00:16:20,399 --> 00:16:24,899
you didn't talk about IPv6 and which of

372
00:16:24,899 --> 00:16:27,899
these IPS are actually used well there's

373
00:16:27,899 --> 00:16:30,300
a comparison I've been using two

374
00:16:30,300 --> 00:16:32,699
Commercial Services Showdown and census

375
00:16:32,699 --> 00:16:36,979
which are basically IP search engines

376
00:16:37,079 --> 00:16:40,620
to look at how many IPS they currently

377
00:16:40,620 --> 00:16:42,480
have in their databases

378
00:16:42,480 --> 00:16:44,579
I've been having the privilege of

379
00:16:44,579 --> 00:16:47,040
looking at Road raw scanning data from

380
00:16:47,040 --> 00:16:49,740
each of these services and I performed a

381
00:16:49,740 --> 00:16:54,000
Country-Wide search for top 100 ports in

382
00:16:54,000 --> 00:16:57,420
as specified by animal nmap on Monday

383
00:16:57,420 --> 00:16:59,459
and here here are the numbers so

384
00:16:59,459 --> 00:17:03,540
Showdown says that there's like uh one

385
00:17:03,540 --> 00:17:05,459
and a half million

386
00:17:05,459 --> 00:17:09,179
uh eyepiece that I used census for some

387
00:17:09,179 --> 00:17:11,459
reason says that there are only 600 000

388
00:17:11,459 --> 00:17:13,799
although the raw data from only less

389
00:17:13,799 --> 00:17:15,660
than two months says has a figure

390
00:17:15,660 --> 00:17:18,540
similar to shoden and from The Showdown

391
00:17:18,540 --> 00:17:20,939
historical data you can see that these

392
00:17:20,939 --> 00:17:22,640
resources actually vary

393
00:17:22,640 --> 00:17:25,380
surprisingly much so I wouldn't have

394
00:17:25,380 --> 00:17:29,340
thought that uh in the data spanning

395
00:17:29,340 --> 00:17:30,780
four years there are two and a half

396
00:17:30,780 --> 00:17:32,940
million unique IPS so that means that

397
00:17:32,940 --> 00:17:34,919
the IP blocks have shifted from there

398
00:17:34,919 --> 00:17:38,039
here to there and the that's why you

399
00:17:38,039 --> 00:17:40,020
need to stay updated you need to have

400
00:17:40,020 --> 00:17:42,660
current data all the time and now data

401
00:17:42,660 --> 00:17:46,200
from 100 top boards or 100 1 million

402
00:17:46,200 --> 00:17:48,059
three hundred thousand answered so

403
00:17:48,059 --> 00:17:50,880
that's roughly the ballpark of the post

404
00:17:50,880 --> 00:17:52,440
that we are looking at

405
00:17:52,440 --> 00:17:55,140
so okay we have selected the

406
00:17:55,140 --> 00:17:56,400
vulnerability

407
00:17:56,400 --> 00:17:57,900
uh

408
00:17:57,900 --> 00:18:02,039
we know roughly what we should scan how

409
00:18:02,039 --> 00:18:05,520
can we find the vulnerable systems

410
00:18:05,520 --> 00:18:06,840
so

411
00:18:06,840 --> 00:18:10,140
the rough methodology is that I usually

412
00:18:10,140 --> 00:18:13,320
start with the third party systems are

413
00:18:13,320 --> 00:18:15,780
trying to further prioritize on whether

414
00:18:15,780 --> 00:18:17,760
okay this is the vulnerability which is

415
00:18:17,760 --> 00:18:19,679
a problem is it a problem for us is it a

416
00:18:19,679 --> 00:18:22,080
problem for Finland and then work from

417
00:18:22,080 --> 00:18:23,039
there

418
00:18:23,039 --> 00:18:24,900
let's take a hypothetical vulnerability

419
00:18:24,900 --> 00:18:26,940
no not a hypothetical or random

420
00:18:26,940 --> 00:18:30,179
vulnerability uh this is from Oracle I

421
00:18:30,179 --> 00:18:32,760
selected Oracle because I can never make

422
00:18:32,760 --> 00:18:34,799
heads or tales about Oracle advisories

423
00:18:34,799 --> 00:18:37,559
like 400 CVS and all kinds of products

424
00:18:37,559 --> 00:18:39,120
I've never heard of so that's why I

425
00:18:39,120 --> 00:18:42,000
picked Oracle and Oracle s bass I had no

426
00:18:42,000 --> 00:18:45,900
idea about this one uh so okay it's a 10

427
00:18:45,900 --> 00:18:48,539
it's a very serious vulnerability indeed

428
00:18:48,539 --> 00:18:52,140
let's try to to use this methodology how

429
00:18:52,140 --> 00:18:54,780
to find Oracle s bass okay I'll start

430
00:18:54,780 --> 00:18:57,980
from things like

431
00:18:58,080 --> 00:19:01,980
installation instructions uh

432
00:19:01,980 --> 00:19:05,880
videos uh Google searches stuff like

433
00:19:05,880 --> 00:19:09,600
that so here's the here's the first hit

434
00:19:09,600 --> 00:19:11,940
says that it has an upper Tomcat I'm

435
00:19:11,940 --> 00:19:13,380
feeling bad already

436
00:19:13,380 --> 00:19:17,280
uh and it follows up by saying that okay

437
00:19:17,280 --> 00:19:20,760
it uses agent uses Port one two one four

438
00:19:20,760 --> 00:19:23,280
three two three I have no idea what an

439
00:19:23,280 --> 00:19:25,080
agent is in this context but it doesn't

440
00:19:25,080 --> 00:19:26,179
matter

441
00:19:26,179 --> 00:19:30,179
there's a server which has a thousand

442
00:19:30,179 --> 00:19:32,220
ports okay I'm not looking at the ports

443
00:19:32,220 --> 00:19:36,539
about this ESS VR and then there's a

444
00:19:36,539 --> 00:19:39,240
Services server which uses one port okay

445
00:19:39,240 --> 00:19:41,039
I can work with those there's something

446
00:19:41,039 --> 00:19:43,080
I can work with so let's start doing

447
00:19:43,080 --> 00:19:48,360
this so the first search uh confusingly

448
00:19:48,360 --> 00:19:52,020
on the bottom essay VR doesn't have any

449
00:19:52,020 --> 00:19:55,860
results so okay well that was the tough

450
00:19:55,860 --> 00:19:59,340
one uh Port one four two three children

451
00:19:59,340 --> 00:20:01,980
says uh

452
00:20:01,980 --> 00:20:06,380
12 results and census says 256 results

453
00:20:06,380 --> 00:20:08,940
and I've used the search term service

454
00:20:08,940 --> 00:20:10,440
trunkey that falls

455
00:20:10,440 --> 00:20:14,340
which according to web law says that

456
00:20:14,340 --> 00:20:16,440
this should get rid of many of the

457
00:20:16,440 --> 00:20:18,780
Honeypot hits because in the honeypots

458
00:20:18,780 --> 00:20:21,960
the uh search hits are truncated because

459
00:20:21,960 --> 00:20:23,940
there's so many of them but it doesn't

460
00:20:23,940 --> 00:20:26,340
actually do a very good job with it so

461
00:20:26,340 --> 00:20:27,900
there's a lot of Honey parts and other

462
00:20:27,900 --> 00:20:31,020
things I shouldn't care about so not

463
00:20:31,020 --> 00:20:33,000
good searches

464
00:20:33,000 --> 00:20:35,400
another thing why we are seeing this

465
00:20:35,400 --> 00:20:37,679
discrepancy between shoulder and senses

466
00:20:37,679 --> 00:20:39,960
is that according to my observation

467
00:20:39,960 --> 00:20:43,559
census has a more much wider Port range

468
00:20:43,559 --> 00:20:46,260
so in some tests that I looked at

469
00:20:46,260 --> 00:20:50,220
Showdown looked at like 8 500 ports

470
00:20:50,220 --> 00:20:52,740
where our census looked at pretty much

471
00:20:52,740 --> 00:20:55,740
the whole TCP board space 65 000 ports

472
00:20:55,740 --> 00:20:58,140
so that might be a reason why there are

473
00:20:58,140 --> 00:21:02,000
more hits I don't know s base

474
00:21:02,000 --> 00:21:05,160
you can actually see that many uh well

475
00:21:05,160 --> 00:21:07,020
you can't see here because I wanted to

476
00:21:07,020 --> 00:21:09,000
make the text big enough for you to see

477
00:21:09,000 --> 00:21:12,419
it uh is that the first hit is in an

478
00:21:12,419 --> 00:21:15,140
oracle Network and it was actually

479
00:21:15,140 --> 00:21:17,580
majority of the hits where in Oracle

480
00:21:17,580 --> 00:21:19,200
Network so we are up to something

481
00:21:19,200 --> 00:21:23,100
probably here but yeah it's a thing it's

482
00:21:23,100 --> 00:21:24,900
not a thing for me it's not it's

483
00:21:24,900 --> 00:21:26,520
anything for Oracle and it's their

484
00:21:26,520 --> 00:21:27,299
problem

485
00:21:27,299 --> 00:21:28,740
uh

486
00:21:28,740 --> 00:21:33,000
looking at children that's like 187 and

487
00:21:33,000 --> 00:21:35,460
well doesn't look like there are any

488
00:21:35,460 --> 00:21:40,140
hits in outside of France in Europe so

489
00:21:40,140 --> 00:21:42,900
probably not not a problem for us

490
00:21:42,900 --> 00:21:49,020
and last one was the uh Port 3388

491
00:21:49,020 --> 00:21:51,720
there were there was a lot of that I

492
00:21:51,720 --> 00:21:54,120
added the tag Oracle because there's

493
00:21:54,120 --> 00:21:56,520
it's an undefined Port it's an ephemeral

494
00:21:56,520 --> 00:21:59,039
Port there's all kinds of crazy crazy

495
00:21:59,039 --> 00:22:01,980
stuff on that Port so you need to first

496
00:22:01,980 --> 00:22:04,500
put in Oracle or something to specify

497
00:22:04,500 --> 00:22:06,059
the search and then you get the honey

498
00:22:06,059 --> 00:22:09,299
parts and then minus tag honey part if

499
00:22:09,299 --> 00:22:10,860
you have the Enterprise license to show

500
00:22:10,860 --> 00:22:13,380
that which you need at this point or

501
00:22:13,380 --> 00:22:15,840
then download all the hits and work your

502
00:22:15,840 --> 00:22:17,460
way from there Road out there is nice

503
00:22:17,460 --> 00:22:20,700
Road that's nice and um

504
00:22:20,700 --> 00:22:23,100
then you get to see that okay for the

505
00:22:23,100 --> 00:22:25,559
hits and probably not in Finland

506
00:22:25,559 --> 00:22:28,860
in the in the uh

507
00:22:28,860 --> 00:22:30,840
in census

508
00:22:30,840 --> 00:22:34,740
we saw more hits on this as well

509
00:22:34,740 --> 00:22:37,140
I'm assuming it might have to do

510
00:22:37,140 --> 00:22:38,700
something to do with the way they scan

511
00:22:38,700 --> 00:22:41,220
both of these do rolling scans

512
00:22:41,220 --> 00:22:44,280
and from my empirical not statistic

513
00:22:44,280 --> 00:22:46,620
observation it looks like that census

514
00:22:46,620 --> 00:22:48,179
does one

515
00:22:48,179 --> 00:22:51,480
set of Networks the next week another

516
00:22:51,480 --> 00:22:53,940
set of networks the next week another

517
00:22:53,940 --> 00:22:55,980
set of networks and it kind of like

518
00:22:55,980 --> 00:22:59,520
Works smoothly away across all the IB

519
00:22:59,520 --> 00:23:02,220
space whereas Shona is like okay I'm

520
00:23:02,220 --> 00:23:04,440
scanning I'm scanning I'm scanning I'm

521
00:23:04,440 --> 00:23:06,720
scanning and it's like very difficult to

522
00:23:06,720 --> 00:23:09,299
follow up on what's actually happening

523
00:23:09,299 --> 00:23:11,220
there and which sports from which host

524
00:23:11,220 --> 00:23:15,480
it scans the other thing is that

525
00:23:15,480 --> 00:23:17,820
you know that they can't scan everything

526
00:23:17,820 --> 00:23:20,580
all the time so some of the results

527
00:23:20,580 --> 00:23:22,559
might be quite dated

528
00:23:22,559 --> 00:23:25,740
and that's a problem because well the

529
00:23:25,740 --> 00:23:27,480
last thing I want to do is to alert

530
00:23:27,480 --> 00:23:30,000
something about someone about something

531
00:23:30,000 --> 00:23:31,620
that's not a problem

532
00:23:31,620 --> 00:23:34,620
so I want to know when I send emails to

533
00:23:34,620 --> 00:23:36,120
somebody saying that hey you have a

534
00:23:36,120 --> 00:23:37,559
problem I want to make sure that they

535
00:23:37,559 --> 00:23:40,080
actually have a problem it does not mean

536
00:23:40,080 --> 00:23:42,059
it doesn't do me good much credit

537
00:23:42,059 --> 00:23:43,860
otherwise

538
00:23:43,860 --> 00:23:46,860
and that's why the next phase would be a

539
00:23:46,860 --> 00:23:49,799
pod scan I'm not going to go into the

540
00:23:49,799 --> 00:23:53,159
postcard methodology a lot uh it's

541
00:23:53,159 --> 00:23:55,559
because well it's basic everyone

542
00:23:55,559 --> 00:23:57,559
who is doing it the same way we haven't

543
00:23:57,559 --> 00:24:00,179
we don't have a silver bullet here so

544
00:24:00,179 --> 00:24:02,340
first use something that can handle a

545
00:24:02,340 --> 00:24:04,679
lot of networks quickly zip map must can

546
00:24:04,679 --> 00:24:08,039
then use something that finds the thing

547
00:24:08,039 --> 00:24:10,440
you need said grab or nmap or custom

548
00:24:10,440 --> 00:24:12,419
scripts or what have you so that's

549
00:24:12,419 --> 00:24:15,380
basically how we do it

550
00:24:25,640 --> 00:24:27,720
there are lots of legal debates

551
00:24:27,720 --> 00:24:30,000
surrounding scanning whether it's good

552
00:24:30,000 --> 00:24:32,340
whether it's bad I like the fact that

553
00:24:32,340 --> 00:24:36,179
the EU says that everyone all the

554
00:24:36,179 --> 00:24:38,520
c-search shoots gun and is mandatory

555
00:24:38,520 --> 00:24:40,799
pretty soon in network and Information

556
00:24:40,799 --> 00:24:43,200
Services directive

557
00:24:43,200 --> 00:24:45,480
and so that fixes the situator should

558
00:24:45,480 --> 00:24:47,340
fix the situation

559
00:24:47,340 --> 00:24:50,220
for us but they're still

560
00:24:50,220 --> 00:24:53,100
um I would like the legal situation this

561
00:24:53,100 --> 00:24:56,039
is my moment on the soapbox now so I

562
00:24:56,039 --> 00:24:58,559
would like the situation for the rest of

563
00:24:58,559 --> 00:25:01,080
us the rest of you to be much clearer in

564
00:25:01,080 --> 00:25:02,220
the future

565
00:25:02,220 --> 00:25:06,179
so Netherlands has made a pretty

566
00:25:06,179 --> 00:25:09,539
clear statements about what kind of

567
00:25:09,539 --> 00:25:13,980
testing is uh accepted a Belgium

568
00:25:13,980 --> 00:25:17,580
recently apparently said that testing is

569
00:25:17,580 --> 00:25:21,780
okay period uh so I'm not sure on how

570
00:25:21,780 --> 00:25:23,820
that will pan out but I'm what I'm sure

571
00:25:23,820 --> 00:25:26,640
about is that we in Finland should have

572
00:25:26,640 --> 00:25:30,120
some kind of position about what is

573
00:25:30,120 --> 00:25:33,120
accepted uh in in in vulnerability

574
00:25:33,120 --> 00:25:35,600
research

575
00:25:35,700 --> 00:25:37,020
thank you

576
00:25:37,020 --> 00:25:38,400
because well

577
00:25:38,400 --> 00:25:41,400
the fact of life is that the bad guys

578
00:25:41,400 --> 00:25:44,100
will scan if you try to sculpt the good

579
00:25:44,100 --> 00:25:46,380
guys from scanning what good will it do

580
00:25:46,380 --> 00:25:48,539
so we should be better

581
00:25:48,539 --> 00:25:51,659
all right that was the scanning part

582
00:25:51,659 --> 00:25:54,779
no now we have an idea that okay this is

583
00:25:54,779 --> 00:25:57,779
probably a x system is it vulnerable

584
00:25:57,779 --> 00:26:00,120
okay how do you determine if it's

585
00:26:00,120 --> 00:26:03,659
vulnerable the easiest way the ideal way

586
00:26:03,659 --> 00:26:05,419
would be to look at the version number

587
00:26:05,419 --> 00:26:07,919
and determine from there

588
00:26:07,919 --> 00:26:11,700
well was it the best version or not

589
00:26:11,700 --> 00:26:14,520
so there are many easy cases many many

590
00:26:14,520 --> 00:26:18,139
software that make this easy

591
00:26:19,400 --> 00:26:22,020
for example Exchange

592
00:26:22,020 --> 00:26:23,400
has

593
00:26:23,400 --> 00:26:26,100
there I think I'm at least two ways I

594
00:26:26,100 --> 00:26:28,140
think there are three ways that I know

595
00:26:28,140 --> 00:26:30,000
of but I lost the third one sorry for

596
00:26:30,000 --> 00:26:32,400
that uh that

597
00:26:32,400 --> 00:26:34,980
have a version number where it's readily

598
00:26:34,980 --> 00:26:39,059
available in HTTP HTML and these are

599
00:26:39,059 --> 00:26:40,200
good

600
00:26:40,200 --> 00:26:44,340
of again because you can look them up in

601
00:26:44,340 --> 00:26:45,840
Showdown instances

602
00:26:45,840 --> 00:26:48,179
except when

603
00:26:48,179 --> 00:26:50,460
they are right on the bottom of the page

604
00:26:50,460 --> 00:26:52,679
because more I think at least children

605
00:26:52,679 --> 00:26:55,740
only indexes the first X bytes of the

606
00:26:55,740 --> 00:26:57,659
page so if the version number stairs or

607
00:26:57,659 --> 00:26:59,460
your router lock but

608
00:26:59,460 --> 00:27:00,720
um

609
00:27:00,720 --> 00:27:03,120
if it's in HTTP address you'll see it

610
00:27:03,120 --> 00:27:05,640
anyway Confluence had it

611
00:27:05,640 --> 00:27:09,059
on the bottom of the page but I think uh

612
00:27:09,059 --> 00:27:11,640
debates wasn't long enough so you could

613
00:27:11,640 --> 00:27:15,440
look for it so good cases

614
00:27:16,080 --> 00:27:18,900
a couple of bad cases there's there

615
00:27:18,900 --> 00:27:21,120
would be many many many many examples

616
00:27:21,120 --> 00:27:23,460
here uh

617
00:27:23,460 --> 00:27:26,880
SharePoint there are a couple of

618
00:27:26,880 --> 00:27:29,520
files that I'm told contain the version

619
00:27:29,520 --> 00:27:31,620
number but they are never available

620
00:27:31,620 --> 00:27:34,380
everyone blocks access to these files

621
00:27:34,380 --> 00:27:37,200
it's probably all the better uh they've

622
00:27:37,200 --> 00:27:39,179
they probably have thought that okay

623
00:27:39,179 --> 00:27:41,100
those are dangerous resources and there

624
00:27:41,100 --> 00:27:42,960
are a lot of other dangerous resources

625
00:27:42,960 --> 00:27:44,880
that you shouldn't be able to reach and

626
00:27:44,880 --> 00:27:47,340
well that's probably good uh Microsoft

627
00:27:47,340 --> 00:27:51,120
DNS is is nice because well DNS

628
00:27:51,120 --> 00:27:55,679
specifies that you can do a chaos uh

629
00:27:55,679 --> 00:27:59,159
query where you are supposed to have the

630
00:27:59,159 --> 00:28:02,520
version number of the DNS server and it

631
00:28:02,520 --> 00:28:04,500
does it does have a version number six

632
00:28:04,500 --> 00:28:07,340
point for example here

633
00:28:07,340 --> 00:28:10,080
6.0.6003 and then the magic number in

634
00:28:10,080 --> 00:28:11,580
the parenthesis

635
00:28:11,580 --> 00:28:13,740
the magic number in parenthesis I have

636
00:28:13,740 --> 00:28:15,539
no idea what the first numbers are about

637
00:28:15,539 --> 00:28:18,419
but the last numbers are hexes that

638
00:28:18,419 --> 00:28:23,120
correspond in by in decimal to the last

639
00:28:23,120 --> 00:28:26,700
build numbers which you can find by

640
00:28:26,700 --> 00:28:28,820
Clickety clicking on Microsoft Pages

641
00:28:28,820 --> 00:28:32,279
endlessly until you find which versions

642
00:28:32,279 --> 00:28:35,279
are respond are related to any version

643
00:28:35,279 --> 00:28:38,640
so well it's kind of there but it kind

644
00:28:38,640 --> 00:28:40,500
of isn't

645
00:28:40,500 --> 00:28:42,419
and of course there's there are a lot of

646
00:28:42,419 --> 00:28:46,740
expectations to rule so uh I mentioned

647
00:28:46,740 --> 00:28:48,960
Confluence as a good example it's also a

648
00:28:48,960 --> 00:28:51,539
bad example because they had Hot patches

649
00:28:51,539 --> 00:28:53,279
for vulnerabilities that don't change

650
00:28:53,279 --> 00:28:56,400
the version number so yeah that's kind

651
00:28:56,400 --> 00:28:59,520
of screws things up for me uh of course

652
00:28:59,520 --> 00:29:02,960
everyone knows about uh operate

653
00:29:02,960 --> 00:29:05,760
free operating systems that

654
00:29:05,760 --> 00:29:08,100
do a back ports for patches so they are

655
00:29:08,100 --> 00:29:10,799
at this version but dispatch applied and

656
00:29:10,799 --> 00:29:12,360
it's kind of manageable but it still

657
00:29:12,360 --> 00:29:15,779
makes things pretty hard for Defenders

658
00:29:15,779 --> 00:29:18,240
uh as I mentioned the version numbers

659
00:29:18,240 --> 00:29:21,020
might not be indexed by Showdown census

660
00:29:21,020 --> 00:29:24,320
at all at some point

661
00:29:24,320 --> 00:29:27,299
the third party Services know that this

662
00:29:27,299 --> 00:29:30,659
is an oracle system and might already

663
00:29:30,659 --> 00:29:33,059
give you the version number and have you

664
00:29:33,059 --> 00:29:36,539
like service dot Oracle and version

665
00:29:36,539 --> 00:29:38,279
number and you can do searches like that

666
00:29:38,279 --> 00:29:40,919
like this I forgot to mention it earlier

667
00:29:40,919 --> 00:29:42,120
but

668
00:29:42,120 --> 00:29:45,360
I'll do it now I love likes the fact

669
00:29:45,360 --> 00:29:48,480
about census is that it has

670
00:29:48,480 --> 00:29:49,919
documentation

671
00:29:49,919 --> 00:29:52,860
uh it adheres to the documentation it

672
00:29:52,860 --> 00:29:54,740
actually works the way it's documented

673
00:29:54,740 --> 00:29:58,320
and uh there

674
00:29:58,320 --> 00:29:59,940
are many

675
00:29:59,940 --> 00:30:02,279
they are a great many tags that you can

676
00:30:02,279 --> 00:30:04,380
search for and you can do Boolean

677
00:30:04,380 --> 00:30:06,240
searches

678
00:30:06,240 --> 00:30:08,159
so it's like a

679
00:30:08,159 --> 00:30:10,620
production product it's like something

680
00:30:10,620 --> 00:30:14,039
that's like supported for you Showdown

681
00:30:14,039 --> 00:30:17,700
is cool Showdown is great uh it has a

682
00:30:17,700 --> 00:30:19,740
lot of creative Insight you can search

683
00:30:19,740 --> 00:30:22,020
for vulnerabilities you can the tags are

684
00:30:22,020 --> 00:30:25,380
nice but it kind of like works

685
00:30:25,380 --> 00:30:28,140
the way one guy intended and well he's

686
00:30:28,140 --> 00:30:29,840
not very being very

687
00:30:29,840 --> 00:30:32,760
precise about things so it's like dog

688
00:30:32,760 --> 00:30:35,340
and pony show compared to census but I

689
00:30:35,340 --> 00:30:36,899
still like the show

690
00:30:36,899 --> 00:30:38,820
uh

691
00:30:38,820 --> 00:30:40,799
in many cases it's considers best

692
00:30:40,799 --> 00:30:43,559
practice to Omit version numbers and

693
00:30:43,559 --> 00:30:46,140
this is one thing that I'm kind of like

694
00:30:46,140 --> 00:30:48,059
doubtful in the current day

695
00:30:48,059 --> 00:30:49,380
because well

696
00:30:49,380 --> 00:30:52,200
as far as I understood it attackers will

697
00:30:52,200 --> 00:30:53,760
attack you anyway

698
00:30:53,760 --> 00:30:57,000
so there are people that will

699
00:30:57,000 --> 00:30:59,220
package every any vulnerabilities they

700
00:30:59,220 --> 00:31:01,460
have

701
00:31:02,940 --> 00:31:04,380
come on

702
00:31:04,380 --> 00:31:06,980
reverse

703
00:31:11,640 --> 00:31:14,580
no so if if it would increase the work

704
00:31:14,580 --> 00:31:16,740
of attackers omitting version numbers

705
00:31:16,740 --> 00:31:18,840
would be good but I'm kind of like

706
00:31:18,840 --> 00:31:21,240
having the idea that currently there are

707
00:31:21,240 --> 00:31:23,220
there's so many attackers that just try

708
00:31:23,220 --> 00:31:25,559
to try everything against you so if you

709
00:31:25,559 --> 00:31:27,299
omit version numbers they'll still try

710
00:31:27,299 --> 00:31:29,580
it against you so it's I'm not I'm not

711
00:31:29,580 --> 00:31:31,679
quite sure how much that will accomplish

712
00:31:31,679 --> 00:31:33,960
whereas omitting version one was MIL

713
00:31:33,960 --> 00:31:36,419
mean for you that you will need to do

714
00:31:36,419 --> 00:31:38,580
the extra work to determine whether what

715
00:31:38,580 --> 00:31:41,100
your version number is so if you do omit

716
00:31:41,100 --> 00:31:43,260
the version number make sure that your

717
00:31:43,260 --> 00:31:46,080
inventory of assets is accurate and

718
00:31:46,080 --> 00:31:48,120
let's be honest nobody has an accurate

719
00:31:48,120 --> 00:31:51,739
asset inventory so

720
00:31:52,340 --> 00:31:56,039
if you do well it's good for you but the

721
00:31:56,039 --> 00:31:59,419
rest of you well you don't

722
00:32:00,539 --> 00:32:04,140
so in case the version detection fails

723
00:32:04,140 --> 00:32:07,380
then you need to do something scary you

724
00:32:07,380 --> 00:32:09,659
need to actually try to

725
00:32:09,659 --> 00:32:12,240
exploit something in order to see if

726
00:32:12,240 --> 00:32:14,580
it's vulnerable to the exploit and well

727
00:32:14,580 --> 00:32:17,159
at us being public servants that is kind

728
00:32:17,159 --> 00:32:19,260
of like the thing that we have to obey

729
00:32:19,260 --> 00:32:22,140
the law you know so we can't really

730
00:32:22,140 --> 00:32:25,080
commit any crimes and that kind of makes

731
00:32:25,080 --> 00:32:28,919
things tricky most of the

732
00:32:28,919 --> 00:32:34,380
POC scripted out try to do uh

733
00:32:34,380 --> 00:32:37,020
one or two one of two things one is

734
00:32:37,020 --> 00:32:39,899
remote code execution the other is uh

735
00:32:39,899 --> 00:32:42,600
try to get credentials and this is the

736
00:32:42,600 --> 00:32:45,899
an example of the ladder it's a cve for

737
00:32:45,899 --> 00:32:48,840
Apache two years ago

738
00:32:48,840 --> 00:32:52,940
and uh it's a very simple garden variety

739
00:32:52,940 --> 00:32:57,120
uh path traversal attack and

740
00:32:57,120 --> 00:32:59,700
the example says that hey you should

741
00:32:59,700 --> 00:33:01,500
probably head for the password file and

742
00:33:01,500 --> 00:33:03,360
this is what the attackers will well

743
00:33:03,360 --> 00:33:05,460
this the amount of piece of POC writers

744
00:33:05,460 --> 00:33:07,100
will want to do because they want to

745
00:33:07,100 --> 00:33:09,240
demonstrate that this is a good bad

746
00:33:09,240 --> 00:33:10,980
attack

747
00:33:10,980 --> 00:33:13,500
and well that's a password file for use

748
00:33:13,500 --> 00:33:17,580
you have that haven't seen one before so

749
00:33:17,580 --> 00:33:20,039
it's currently says that these are the

750
00:33:20,039 --> 00:33:21,899
users and these are some parameters of

751
00:33:21,899 --> 00:33:23,399
them

752
00:33:23,399 --> 00:33:26,460
and um I installed

753
00:33:26,460 --> 00:33:29,340
often when I have the possibility when

754
00:33:29,340 --> 00:33:31,260
there's a vulnerability I try to get the

755
00:33:31,260 --> 00:33:33,120
vulnerable version install it somewhere

756
00:33:33,120 --> 00:33:36,779
in the docker container and the top part

757
00:33:36,779 --> 00:33:40,679
is the uh vulnerable version

758
00:33:40,679 --> 00:33:42,600
and the bottom part is the fixed version

759
00:33:42,600 --> 00:33:44,279
well you can see for reversion numbers

760
00:33:44,279 --> 00:33:47,279
there also so

761
00:33:47,279 --> 00:33:49,919
um you you can see you can see from

762
00:33:49,919 --> 00:33:52,860
there that the vulnerable version

763
00:33:52,860 --> 00:33:55,740
says when you try to probe for the file

764
00:33:55,740 --> 00:33:58,140
it says 200

765
00:33:58,140 --> 00:34:00,840
and the non-vulnerable says 400 and

766
00:34:00,840 --> 00:34:02,519
that's something that you can use so

767
00:34:02,519 --> 00:34:06,480
simple as that in this case you could of

768
00:34:06,480 --> 00:34:08,460
course look for something that Etc

769
00:34:08,460 --> 00:34:10,139
something other than the EDC password

770
00:34:10,139 --> 00:34:12,659
but make sure that it's a file that is

771
00:34:12,659 --> 00:34:14,879
in all the Linux distributions and there

772
00:34:14,879 --> 00:34:17,879
aren't many of those and uh in this

773
00:34:17,879 --> 00:34:21,300
example I used the head request which is

774
00:34:21,300 --> 00:34:23,339
to say just tell me the status code

775
00:34:23,339 --> 00:34:25,500
don't send me any data and I think

776
00:34:25,500 --> 00:34:27,960
that's pretty safe in this in this

777
00:34:27,960 --> 00:34:28,918
context

778
00:34:28,918 --> 00:34:33,319
so that's a very simple example on that

779
00:34:33,540 --> 00:34:37,379
um okay in most cases our story would

780
00:34:37,379 --> 00:34:38,580
end here

781
00:34:38,580 --> 00:34:41,099
but in there are instances of the

782
00:34:41,099 --> 00:34:43,199
vulnerability coming out at the point

783
00:34:43,199 --> 00:34:45,899
that it's already known by someone it's

784
00:34:45,899 --> 00:34:48,540
already used in the attacks so you need

785
00:34:48,540 --> 00:34:50,460
we need we want to take that into

786
00:34:50,460 --> 00:34:51,359
account

787
00:34:51,359 --> 00:34:56,339
so as an example there was the

788
00:34:56,339 --> 00:34:58,560
exchange vulnerability a couple years

789
00:34:58,560 --> 00:35:00,859
ago

790
00:35:01,080 --> 00:35:02,760
where

791
00:35:02,760 --> 00:35:06,720
and threat actor called by Microsoft as

792
00:35:06,720 --> 00:35:10,920
half NuMe had already uh well basically

793
00:35:10,920 --> 00:35:13,200
they found the vulnerability by by the

794
00:35:13,200 --> 00:35:16,560
virtue of looking at these compromises

795
00:35:16,560 --> 00:35:19,680
and they were already many compromised

796
00:35:19,680 --> 00:35:22,440
servers servers out there

797
00:35:22,440 --> 00:35:24,780
so we had already

798
00:35:24,780 --> 00:35:26,820
because this is a cooking show this I'm

799
00:35:26,820 --> 00:35:29,280
I have done already the dish and I'm

800
00:35:29,280 --> 00:35:30,960
taking it out of the oven so I had

801
00:35:30,960 --> 00:35:33,240
already taken all the steps that I've

802
00:35:33,240 --> 00:35:35,940
discussed previously and this is the

803
00:35:35,940 --> 00:35:38,400
message that we send out the

804
00:35:38,400 --> 00:35:42,720
we identified vulnerable systems and as

805
00:35:42,720 --> 00:35:45,240
soon as we could determine that okay we

806
00:35:45,240 --> 00:35:46,859
know what we're talking about send a

807
00:35:46,859 --> 00:35:49,020
message out there that you are

808
00:35:49,020 --> 00:35:52,140
vulnerable check the parts levels and

809
00:35:52,140 --> 00:35:54,119
there was a mention about okay these

810
00:35:54,119 --> 00:35:56,460
have been already used in the attacks

811
00:35:56,460 --> 00:35:58,740
but it was not the Crux of the Magics

812
00:35:58,740 --> 00:36:00,839
the Crux was of the message was that you

813
00:36:00,839 --> 00:36:05,400
are vulnerable according to what we know

814
00:36:05,400 --> 00:36:08,040
uh at the same time

815
00:36:08,040 --> 00:36:10,980
as the Microsoft publication there was a

816
00:36:10,980 --> 00:36:13,380
another publication from a company

817
00:36:13,380 --> 00:36:16,440
called hunt tracks that had

818
00:36:16,440 --> 00:36:18,320
a list of

819
00:36:18,320 --> 00:36:21,960
358 web shell names so basically the

820
00:36:21,960 --> 00:36:24,180
attacker attack works so that the

821
00:36:24,180 --> 00:36:26,820
attacker had a specific payload which

822
00:36:26,820 --> 00:36:28,859
was inserted in the web route and then

823
00:36:28,859 --> 00:36:31,380
they had a China Chopper back door which

824
00:36:31,380 --> 00:36:33,300
is basically one line of PHP that is

825
00:36:33,300 --> 00:36:35,520
there username and password you need to

826
00:36:35,520 --> 00:36:38,339
know in order to execute PHP code of

827
00:36:38,339 --> 00:36:40,619
your choosing on the server

828
00:36:40,619 --> 00:36:43,260
so we knew that okay if something is

829
00:36:43,260 --> 00:36:45,240
vulnerable it might have one of these

830
00:36:45,240 --> 00:36:46,740
web shells

831
00:36:46,740 --> 00:36:50,820
so here is where we used uh Jonas

832
00:36:50,820 --> 00:36:54,540
excellent fast faster you fool tool to

833
00:36:54,540 --> 00:36:56,520
look at all

834
00:36:56,520 --> 00:36:59,579
the parts all the website parts that we

835
00:36:59,579 --> 00:37:01,980
knew of which amounted to something like

836
00:37:01,980 --> 00:37:04,980
six to seven hundred look at all the

837
00:37:04,980 --> 00:37:07,020
vulnerable systems and all the parts

838
00:37:07,020 --> 00:37:09,359
that might contain a web cell in the

839
00:37:09,359 --> 00:37:11,940
case the wall attackers are lazy and

840
00:37:11,940 --> 00:37:13,980
reuse the web cell names

841
00:37:13,980 --> 00:37:16,920
and try to determine from there if it

842
00:37:16,920 --> 00:37:19,920
says 200 from there it's probably

843
00:37:19,920 --> 00:37:21,960
uh compromised because there's a web

844
00:37:21,960 --> 00:37:24,119
shell there oh well they have a funny

845
00:37:24,119 --> 00:37:25,859
configuration but well that's their

846
00:37:25,859 --> 00:37:29,099
fault uh and there's also another uh

847
00:37:29,099 --> 00:37:30,480
case

848
00:37:30,480 --> 00:37:34,260
another set of servers that uh sent back

849
00:37:34,260 --> 00:37:39,900
a 500 reply which we then comp True by

850
00:37:39,900 --> 00:37:41,640
hand to see for additional

851
00:37:41,640 --> 00:37:42,900
vulnerabilities

852
00:37:42,900 --> 00:37:45,420
and we were able to send another set of

853
00:37:45,420 --> 00:37:50,540
messages to these compromised uh

854
00:37:50,579 --> 00:37:55,560
uh compromised host owners saying that

855
00:37:55,560 --> 00:37:58,140
your host is compromised so some of them

856
00:37:58,140 --> 00:38:02,339
cut first your vulnerable message then a

857
00:38:02,339 --> 00:38:04,320
period of delay where we while we figure

858
00:38:04,320 --> 00:38:06,420
out how to scan the rest of them and you

859
00:38:06,420 --> 00:38:09,240
are compromised so it came that

860
00:38:09,240 --> 00:38:11,760
escalated quickly for them and here the

861
00:38:11,760 --> 00:38:13,140
message was different

862
00:38:13,140 --> 00:38:17,400
the the uh basic idea was that hey you

863
00:38:17,400 --> 00:38:19,680
need to check for the signs of

864
00:38:19,680 --> 00:38:21,060
compromise they reboot the compromise

865
00:38:21,060 --> 00:38:23,220
clean your system reinstall your systems

866
00:38:23,220 --> 00:38:25,020
so it's a very different different

867
00:38:25,020 --> 00:38:27,540
signal and we are sending these messages

868
00:38:27,540 --> 00:38:30,720
mostly through operators so basically we

869
00:38:30,720 --> 00:38:34,140
don't know the customers of an ISP say

870
00:38:34,140 --> 00:38:37,140
Italia DNA Elisa they do know their

871
00:38:37,140 --> 00:38:39,240
customers so we sent this to operators

872
00:38:39,240 --> 00:38:41,339
and say that hey you know your customers

873
00:38:41,339 --> 00:38:44,839
please contact them with these messages

874
00:38:44,940 --> 00:38:47,000
in some cases

875
00:38:47,000 --> 00:38:49,339
they are also

876
00:38:49,339 --> 00:38:52,020
compromises already happening but there

877
00:38:52,020 --> 00:38:54,359
isn't there isn't a nice blog post about

878
00:38:54,359 --> 00:38:57,119
them we just know that there are attacks

879
00:38:57,119 --> 00:38:59,339
and there are compromises

880
00:38:59,339 --> 00:39:02,280
an example is uh this case from

881
00:39:02,280 --> 00:39:03,780
confluence

882
00:39:03,780 --> 00:39:05,640
uh

883
00:39:05,640 --> 00:39:08,099
where actually if I remember correctly

884
00:39:08,099 --> 00:39:10,500
they issued an advisory but they

885
00:39:10,500 --> 00:39:13,800
neglected to say in the advisory that

886
00:39:13,800 --> 00:39:15,480
hey this is a remote control execution

887
00:39:15,480 --> 00:39:17,700
you need you really really really need

888
00:39:17,700 --> 00:39:20,339
to do something now instead says yeah

889
00:39:20,339 --> 00:39:21,480
yeah that's an update that's a

890
00:39:21,480 --> 00:39:23,220
vulnerability

891
00:39:23,220 --> 00:39:24,720
and well

892
00:39:24,720 --> 00:39:26,940
that's it's only natural that many

893
00:39:26,940 --> 00:39:28,500
people didn't update and then they

894
00:39:28,500 --> 00:39:31,020
revised it and said that hey

895
00:39:31,020 --> 00:39:35,220
this is a serious business by that time

896
00:39:35,220 --> 00:39:39,480
all compromises were already occurring

897
00:39:39,480 --> 00:39:41,160
uh

898
00:39:41,160 --> 00:39:45,359
there was a nice person uh who might be

899
00:39:45,359 --> 00:39:47,040
there in the audience today I'm not

900
00:39:47,040 --> 00:39:51,540
seeing him uh who had system uh very

901
00:39:51,540 --> 00:39:53,520
very well monitored system with

902
00:39:53,520 --> 00:39:55,980
customers and one of the customers

903
00:39:55,980 --> 00:40:01,200
neglected to update their system

904
00:40:01,200 --> 00:40:03,599
um and because the system was so well

905
00:40:03,599 --> 00:40:06,599
monitored he we could we saw everything

906
00:40:06,599 --> 00:40:08,520
from this compromise this was a nice

907
00:40:08,520 --> 00:40:11,820
case uh so we saw the audit logs the

908
00:40:11,820 --> 00:40:14,220
access logs the grx logs what was

909
00:40:14,220 --> 00:40:17,099
executed on the server uh how the web

910
00:40:17,099 --> 00:40:21,359
server was attached uh there was a

911
00:40:21,359 --> 00:40:24,240
sample of the P CAP related to this

912
00:40:24,240 --> 00:40:26,520
compromise uh all the files that were

913
00:40:26,520 --> 00:40:28,680
dropped there the Chrome tabs that were

914
00:40:28,680 --> 00:40:31,500
installed I'm just like okay I've been

915
00:40:31,500 --> 00:40:33,960
handed a case on silver platter I made a

916
00:40:33,960 --> 00:40:36,300
make sure that I handled this one well

917
00:40:36,300 --> 00:40:37,980
because well I have all the necessary

918
00:40:37,980 --> 00:40:39,960
details

919
00:40:39,960 --> 00:40:43,020
so the first thing to do is to uh put

920
00:40:43,020 --> 00:40:43,800
this

921
00:40:43,800 --> 00:40:47,280
uh well yeah here you have kinsing which

922
00:40:47,280 --> 00:40:49,140
is an executable file as you can see

923
00:40:49,140 --> 00:40:51,599
from the from here there's a there's a

924
00:40:51,599 --> 00:40:54,780
library and someone some of you probably

925
00:40:54,780 --> 00:40:56,940
noticed that there's an XM rig binary

926
00:40:56,940 --> 00:40:58,260
there as well

927
00:40:58,260 --> 00:41:02,520
so you I put put the kinsing sample uh

928
00:41:02,520 --> 00:41:05,940
in the in Joe sandbox in one well in any

929
00:41:05,940 --> 00:41:07,680
of the sandbox it says

930
00:41:07,680 --> 00:41:10,260
here you can't see that it says that it

931
00:41:10,260 --> 00:41:12,900
detected an XM rig because it's well the

932
00:41:12,900 --> 00:41:15,359
color seam is screwed but it says that

933
00:41:15,359 --> 00:41:18,660
it detector XM cryptocurrency Miner and

934
00:41:18,660 --> 00:41:22,020
it says that it's a Trojan or Bard so

935
00:41:22,020 --> 00:41:24,000
there is probably a backdoor component

936
00:41:24,000 --> 00:41:25,380
to all of this

937
00:41:25,380 --> 00:41:26,940
so okay

938
00:41:26,940 --> 00:41:29,400
let's go back into investigation mode

939
00:41:29,400 --> 00:41:31,619
try to determine whether they are back

940
00:41:31,619 --> 00:41:34,320
doors that are still active in Finland

941
00:41:34,320 --> 00:41:37,859
from the pcap we could see that it has a

942
00:41:37,859 --> 00:41:40,560
CNC and it communicates to the CNC

943
00:41:40,560 --> 00:41:43,680
and the thing that it communicates

944
00:41:43,680 --> 00:41:47,220
is something that looks Global so

945
00:41:47,220 --> 00:41:49,800
probably encrypted in some form or an or

946
00:41:49,800 --> 00:41:51,180
another

947
00:41:51,180 --> 00:41:53,280
I I have to

948
00:41:53,280 --> 00:41:56,660
uh I have a whole slide set about

949
00:41:56,660 --> 00:41:59,520
reversing this malware but there's a lot

950
00:41:59,520 --> 00:42:01,680
of stuff today so I'll just cut to the

951
00:42:01,680 --> 00:42:02,460
chase

952
00:42:02,460 --> 00:42:05,700
uh it was a go binary and after working

953
00:42:05,700 --> 00:42:07,320
with that fact and using all the

954
00:42:07,320 --> 00:42:10,020
necessary tools you could massage it to

955
00:42:10,020 --> 00:42:11,460
the point where you can see that there

956
00:42:11,460 --> 00:42:14,880
is an HTTP rc4 key content

957
00:42:14,880 --> 00:42:18,420
uh variable which is kind of like a

958
00:42:18,420 --> 00:42:20,460
Telltale sign that there's an rc4

959
00:42:20,460 --> 00:42:22,140
encryption and is it this might be the

960
00:42:22,140 --> 00:42:22,800
key

961
00:42:22,800 --> 00:42:25,140
and sure enough if you put it in

962
00:42:25,140 --> 00:42:28,040
cybersev and take the

963
00:42:28,040 --> 00:42:31,560
binary payload from the P CAP use this

964
00:42:31,560 --> 00:42:35,099
key it says that here is a port number

965
00:42:35,099 --> 00:42:37,380
here's the username and password so

966
00:42:37,380 --> 00:42:40,260
basically it opens a backdoor channel on

967
00:42:40,260 --> 00:42:42,300
that port and these are the credentials

968
00:42:42,300 --> 00:42:44,579
used to go there

969
00:42:44,579 --> 00:42:46,859
and armed with that knowledge

970
00:42:46,859 --> 00:42:49,320
uh we could say that

971
00:42:49,320 --> 00:42:50,339
oh

972
00:42:50,339 --> 00:42:52,800
we could look it up in Showdown and

973
00:42:52,800 --> 00:42:55,740
Showdown doesn't index board both three

974
00:42:55,740 --> 00:42:57,540
one four five eight so we could think

975
00:42:57,540 --> 00:42:59,400
that okay everything is well we could

976
00:42:59,400 --> 00:43:01,500
look at its sensors where which actually

977
00:43:01,500 --> 00:43:04,319
does search for this board and then see

978
00:43:04,319 --> 00:43:06,900
that okay there are some

979
00:43:06,900 --> 00:43:10,619
uh in the world not in Finland and the

980
00:43:10,619 --> 00:43:12,960
ones that are out there in other

981
00:43:12,960 --> 00:43:15,839
countries mostly look like Honeypot so

982
00:43:15,839 --> 00:43:19,940
not a probably not a big problem

983
00:43:20,400 --> 00:43:23,099
we could also do a lot more

984
00:43:23,099 --> 00:43:25,819
so that's Basics but that's basics of

985
00:43:25,819 --> 00:43:27,839
vulnerably handling

986
00:43:27,839 --> 00:43:30,180
and that's usually

987
00:43:30,180 --> 00:43:32,819
everything that we do and then some but

988
00:43:32,819 --> 00:43:35,040
in some cases we've actually managed to

989
00:43:35,040 --> 00:43:36,300
do some more

990
00:43:36,300 --> 00:43:39,839
and other thirds in the world even even

991
00:43:39,839 --> 00:43:41,280
better

992
00:43:41,280 --> 00:43:45,839
in the exchange case uh Matthias was one

993
00:43:45,839 --> 00:43:47,819
of the one of the people who are

994
00:43:47,819 --> 00:43:48,960
coordinated

995
00:43:48,960 --> 00:43:52,200
uh an effort where we contacted everyone

996
00:43:52,200 --> 00:43:55,859
that had not patched their systems after

997
00:43:55,859 --> 00:43:58,319
a couple of days so we had like five

998
00:43:58,319 --> 00:44:01,079
people calling everybody on the phone

999
00:44:01,079 --> 00:44:03,000
that hey you have a vulnerable exchange

1000
00:44:03,000 --> 00:44:05,099
system and it's they have been popped

1001
00:44:05,099 --> 00:44:06,599
left and right

1002
00:44:06,599 --> 00:44:09,660
uh these are in Finnish these are actual

1003
00:44:09,660 --> 00:44:11,940
screenshots I've

1004
00:44:11,940 --> 00:44:14,280
blocked out the victims from there it's

1005
00:44:14,280 --> 00:44:17,900
like email service uh Service uh

1006
00:44:17,900 --> 00:44:21,240
breached there's a lot of stuff they are

1007
00:44:21,240 --> 00:44:24,000
uh written the backup making Security

1008
00:44:24,000 --> 00:44:26,760
checks making updates this is another

1009
00:44:26,760 --> 00:44:28,800
one this is a Linux server false

1010
00:44:28,800 --> 00:44:29,940
positive

1011
00:44:29,940 --> 00:44:32,940
uh they'll check again oh it was a

1012
00:44:32,940 --> 00:44:34,680
Windows Server okay now it's fixed

1013
00:44:34,680 --> 00:44:36,540
according to shonan they didn't bother

1014
00:44:36,540 --> 00:44:39,780
calling us back the last one was the sad

1015
00:44:39,780 --> 00:44:42,540
story it was preached the whole

1016
00:44:42,540 --> 00:44:46,200
environment had been rebuilt It's all

1017
00:44:46,200 --> 00:44:47,700
under control

1018
00:44:47,700 --> 00:44:50,460
I hope so

1019
00:44:50,460 --> 00:44:54,180
uh in some cases where we are the

1020
00:44:54,180 --> 00:44:57,180
coordinator for vulnerability we can uh

1021
00:44:57,180 --> 00:44:58,800
try to prepare

1022
00:44:58,800 --> 00:45:01,440
for the impact of the vulnerability this

1023
00:45:01,440 --> 00:45:03,980
is from 2014 to hot lead vulnerability

1024
00:45:03,980 --> 00:45:07,020
uh found by new method of Google and

1025
00:45:07,020 --> 00:45:10,500
co-founded by uh Finnish secretary 10

1026
00:45:10,500 --> 00:45:13,500
called conomicon you know but some of

1027
00:45:13,500 --> 00:45:15,960
you know know the story it was published

1028
00:45:15,960 --> 00:45:17,220
on the seventh

1029
00:45:17,220 --> 00:45:19,800
of

1030
00:45:19,800 --> 00:45:21,000
mod

1031
00:45:21,000 --> 00:45:23,520
March

1032
00:45:23,520 --> 00:45:26,220
I'm pretty sure that's that's

1033
00:45:26,220 --> 00:45:30,000
April yeah April yeah

1034
00:45:30,000 --> 00:45:32,040
yeah so here

1035
00:45:32,040 --> 00:45:37,319
and this is a pretty typical ish cycle

1036
00:45:37,319 --> 00:45:40,079
with us so first we have bad scanner

1037
00:45:40,079 --> 00:45:41,880
that sees only this

1038
00:45:41,880 --> 00:45:43,980
we improve the scanner then we see okay

1039
00:45:43,980 --> 00:45:46,859
it was a bit bigger problem than with

1040
00:45:46,859 --> 00:45:49,740
initially saw and then it starts to

1041
00:45:49,740 --> 00:45:52,859
declare decline in this case there was a

1042
00:45:52,859 --> 00:45:55,079
quick initial Decline and after that a

1043
00:45:55,079 --> 00:45:57,660
long tail and that's like

1044
00:45:57,660 --> 00:46:00,420
that's usual we always have long tails

1045
00:46:00,420 --> 00:46:03,900
in this case uh

1046
00:46:03,900 --> 00:46:08,339
what we were able to do was that we took

1047
00:46:08,339 --> 00:46:10,560
this scanner that we had ourselves built

1048
00:46:10,560 --> 00:46:12,359
there were there were a lot of hard

1049
00:46:12,359 --> 00:46:14,220
bleed scanners out there all of them

1050
00:46:14,220 --> 00:46:16,560
were faulty so we built our one of our

1051
00:46:16,560 --> 00:46:18,020
own that was

1052
00:46:18,020 --> 00:46:22,500
iteratively better and uh then we will

1053
00:46:22,500 --> 00:46:26,339
able to see more as as seen here so we

1054
00:46:26,339 --> 00:46:28,440
packaged it we built it into virtual

1055
00:46:28,440 --> 00:46:29,880
machine and gave it to the government

1056
00:46:29,880 --> 00:46:32,460
that hey this is very serious please

1057
00:46:32,460 --> 00:46:33,960
make sure to check your internal

1058
00:46:33,960 --> 00:46:36,480
networks also so I wish that we could

1059
00:46:36,480 --> 00:46:38,460
have time to do more and publish these

1060
00:46:38,460 --> 00:46:40,140
things also

1061
00:46:40,140 --> 00:46:42,720
the other thing that we could do while

1062
00:46:42,720 --> 00:46:45,960
preparing for the vulnerability was that

1063
00:46:45,960 --> 00:46:47,040
uh

1064
00:46:47,040 --> 00:46:50,280
we had analyzed it we knew how the

1065
00:46:50,280 --> 00:46:52,859
vulnerability could be exploited we knew

1066
00:46:52,859 --> 00:46:54,300
that it was a stealthy vulnerability

1067
00:46:54,300 --> 00:46:57,480
there would be no markings on logs about

1068
00:46:57,480 --> 00:47:02,819
attack that exploits so we built uh IDs

1069
00:47:02,819 --> 00:47:05,160
rules for for our early warning system

1070
00:47:05,160 --> 00:47:07,800
however we actually had also a small

1071
00:47:07,800 --> 00:47:10,200
honey net trying to monitor for any

1072
00:47:10,200 --> 00:47:13,619
incoming connections and and we didn't

1073
00:47:13,619 --> 00:47:16,859
say anything until the 8th at which

1074
00:47:16,859 --> 00:47:18,480
point there was a lot of scanning for

1075
00:47:18,480 --> 00:47:21,900
heartblade so if you are coordinating a

1076
00:47:21,900 --> 00:47:23,940
vulnerability and it's a network based

1077
00:47:23,940 --> 00:47:25,619
vulnerability

1078
00:47:25,619 --> 00:47:26,880
uh

1079
00:47:26,880 --> 00:47:29,160
we didn't want to scan the internet for

1080
00:47:29,160 --> 00:47:31,200
it because that would reveal to someone

1081
00:47:31,200 --> 00:47:33,000
that hey what are these strange buckets

1082
00:47:33,000 --> 00:47:35,040
and leaked vulnerability in the worst

1083
00:47:35,040 --> 00:47:36,839
case but you can still monitor for it

1084
00:47:36,839 --> 00:47:39,300
and you can see see still see if it's in

1085
00:47:39,300 --> 00:47:41,460
the wild so that's that's a nice thing

1086
00:47:41,460 --> 00:47:43,859
nice thing to do

1087
00:47:43,859 --> 00:47:49,020
uh a couple of our colleagues are doing

1088
00:47:49,020 --> 00:47:52,619
remediation packages for example here is

1089
00:47:52,619 --> 00:47:54,900
a recent one from

1090
00:47:54,900 --> 00:47:57,839
seesaw I'll call our U.S colleagues that

1091
00:47:57,839 --> 00:48:00,720
built a recovery package from the ESX

1092
00:48:00,720 --> 00:48:02,160
ransomware

1093
00:48:02,160 --> 00:48:05,640
JP third CC in Japan are prioritizing

1094
00:48:05,640 --> 00:48:07,859
malware that gets installed on computers

1095
00:48:07,859 --> 00:48:09,480
and there are removal guides from those

1096
00:48:09,480 --> 00:48:11,720
so that would that would

1097
00:48:11,720 --> 00:48:14,640
reduce the risks even further if we

1098
00:48:14,640 --> 00:48:17,160
could do more of that

1099
00:48:17,160 --> 00:48:18,780
okay

1100
00:48:18,780 --> 00:48:21,839
um so I'm feeling a bit like

1101
00:48:21,839 --> 00:48:24,540
uh sales funds one more thing exactly

1102
00:48:24,540 --> 00:48:26,940
two more two more things but one more

1103
00:48:26,940 --> 00:48:29,400
thing I'll try to those that was praised

1104
00:48:29,400 --> 00:48:33,839
basically the end of end of the uh

1105
00:48:33,839 --> 00:48:35,339
end of the

1106
00:48:35,339 --> 00:48:37,740
major part of the presentation but I

1107
00:48:37,740 --> 00:48:39,780
wanted to introduce a couple of problems

1108
00:48:39,780 --> 00:48:42,060
that we haven't figured out in hopes

1109
00:48:42,060 --> 00:48:45,480
that you will figure something out about

1110
00:48:45,480 --> 00:48:47,520
them and you will fix this

1111
00:48:47,520 --> 00:48:50,160
yourselves one of one of the problems

1112
00:48:50,160 --> 00:48:53,460
that we've often talked about is iot and

1113
00:48:53,460 --> 00:48:55,560
crappy iot home routers more

1114
00:48:55,560 --> 00:48:57,420
specifically one of the biggest one of

1115
00:48:57,420 --> 00:48:59,119
the big problems

1116
00:48:59,119 --> 00:49:01,079
today

1117
00:49:01,079 --> 00:49:03,300
uh I think that's gotten better at least

1118
00:49:03,300 --> 00:49:06,300
as far as home routers are concerned so

1119
00:49:06,300 --> 00:49:09,060
operators see that it's their problem if

1120
00:49:09,060 --> 00:49:12,300
they hand out crappy home routers and uh

1121
00:49:12,300 --> 00:49:14,359
their custom their customers become

1122
00:49:14,359 --> 00:49:18,180
compromised and those have gradually

1123
00:49:18,180 --> 00:49:20,700
gotten better at least on the internet

1124
00:49:20,700 --> 00:49:23,700
facing side on the local network side

1125
00:49:23,700 --> 00:49:26,339
they might still might be crap but most

1126
00:49:26,339 --> 00:49:28,440
of the traffic attack traffic comes from

1127
00:49:28,440 --> 00:49:30,300
the internet

1128
00:49:30,300 --> 00:49:32,339
on the other hand

1129
00:49:32,339 --> 00:49:35,220
uh that could change

1130
00:49:35,220 --> 00:49:38,400
in Brazil they already have had for some

1131
00:49:38,400 --> 00:49:39,300
years

1132
00:49:39,300 --> 00:49:41,579
uh

1133
00:49:41,579 --> 00:49:45,119
web-based compromises where a malicious

1134
00:49:45,119 --> 00:49:47,240
payload is inserted on the web page

1135
00:49:47,240 --> 00:49:51,300
which uh context JavaScript that tries

1136
00:49:51,300 --> 00:49:53,480
to enumerate through the local network

1137
00:49:53,480 --> 00:49:56,700
all the default web pages of all the

1138
00:49:56,700 --> 00:49:59,480
home routers all the management

1139
00:49:59,480 --> 00:50:02,400
interfaces and tries to change the DNS

1140
00:50:02,400 --> 00:50:04,859
settings there if you don't have CRS

1141
00:50:04,859 --> 00:50:07,260
csrf protection there as many of them

1142
00:50:07,260 --> 00:50:10,800
don't uh well you're screwed in in the

1143
00:50:10,800 --> 00:50:14,640
case of Brazil uh the bad guys are

1144
00:50:14,640 --> 00:50:16,500
looking for a

1145
00:50:16,500 --> 00:50:19,680
way to make an easy book and in this

1146
00:50:19,680 --> 00:50:22,319
case they might only change your DNS

1147
00:50:22,319 --> 00:50:24,660
settings so that they can serve you ads

1148
00:50:24,660 --> 00:50:27,720
instead of other ads instead of the ads

1149
00:50:27,720 --> 00:50:29,520
that you would normally see so they get

1150
00:50:29,520 --> 00:50:32,460
ad Revenue criminal ad Revenue I didn't

1151
00:50:32,460 --> 00:50:35,099
know that was the thing until some some

1152
00:50:35,099 --> 00:50:37,980
years ago so that's kind of like your

1153
00:50:37,980 --> 00:50:40,319
garden variety criminal uh doing

1154
00:50:40,319 --> 00:50:41,280
something

1155
00:50:41,280 --> 00:50:45,240
but it has a darker side this has been

1156
00:50:45,240 --> 00:50:49,920
going on for some years now that uh

1157
00:50:49,920 --> 00:50:52,619
the more determined criminals have

1158
00:50:52,619 --> 00:50:54,900
noticed that many of the companies are

1159
00:50:54,900 --> 00:50:57,000
not using home routers they're using

1160
00:50:57,000 --> 00:50:59,940
small office routers and boy those are

1161
00:50:59,940 --> 00:51:03,540
crap so there was a uh there are a lot

1162
00:51:03,540 --> 00:51:05,640
of old vulnerabilities

1163
00:51:05,640 --> 00:51:10,140
that are existing in gear or from these

1164
00:51:10,140 --> 00:51:13,040
vendors the products listings are huge

1165
00:51:13,040 --> 00:51:15,900
uh many of the

1166
00:51:15,900 --> 00:51:18,240
many of these are

1167
00:51:18,240 --> 00:51:23,099
out of date so end of life devices and

1168
00:51:23,099 --> 00:51:25,680
well they will sit there until the

1169
00:51:25,680 --> 00:51:28,200
hardware breaks basically on on until

1170
00:51:28,200 --> 00:51:31,020
you do something and there are a lot of

1171
00:51:31,020 --> 00:51:35,579
uh apt kind of malware that try to do

1172
00:51:35,579 --> 00:51:37,859
things with this there's a added nice

1173
00:51:37,859 --> 00:51:40,559
benefit for the criminals when I said

1174
00:51:40,559 --> 00:51:42,059
that the Brazilian criminals don't

1175
00:51:42,059 --> 00:51:42,839
really

1176
00:51:42,839 --> 00:51:45,420
do anything Advanced they might at this

1177
00:51:45,420 --> 00:51:47,460
point but they at least didn't used to

1178
00:51:47,460 --> 00:51:51,300
do now that they are between you and the

1179
00:51:51,300 --> 00:51:52,800
internet they are actually in the

1180
00:51:52,800 --> 00:51:54,960
adversary in the middle position and

1181
00:51:54,960 --> 00:51:56,640
suddenly all the vulnerabilities you

1182
00:51:56,640 --> 00:51:59,640
didn't care about like uh

1183
00:51:59,640 --> 00:52:02,579
of doing proper crypto things that

1184
00:52:02,579 --> 00:52:06,480
require the the meeting position that

1185
00:52:06,480 --> 00:52:08,579
they actually become exploitable there

1186
00:52:08,579 --> 00:52:10,559
and they can do a lot of stuff they can

1187
00:52:10,559 --> 00:52:14,160
of course also move to your internal Lan

1188
00:52:14,160 --> 00:52:16,859
Network which was protected and you can

1189
00:52:16,859 --> 00:52:20,579
do crappy soft stuff there

1190
00:52:20,579 --> 00:52:24,300
so that's a scary proposition and I I

1191
00:52:24,300 --> 00:52:27,780
don't have a good solution because the

1192
00:52:27,780 --> 00:52:30,240
um from the point of view of the users

1193
00:52:30,240 --> 00:52:32,520
nothing bad has happened yet

1194
00:52:32,520 --> 00:52:34,740
so they are at risk but they don't see

1195
00:52:34,740 --> 00:52:38,299
the risk as very very big one

1196
00:52:38,400 --> 00:52:43,760
uh even though even though the uh

1197
00:52:44,099 --> 00:52:46,319
Finnish intelligence service has also

1198
00:52:46,319 --> 00:52:48,720
issued a warning about this it still

1199
00:52:48,720 --> 00:52:51,540
seems quite a hard message to get

1200
00:52:51,540 --> 00:52:52,920
through

1201
00:52:52,920 --> 00:52:54,900
the last thing I promise this is lasting

1202
00:52:54,900 --> 00:53:00,380
is that uh there is uh

1203
00:53:00,540 --> 00:53:03,000
get more problems with the definition of

1204
00:53:03,000 --> 00:53:04,740
vulnerability

1205
00:53:04,740 --> 00:53:08,280
so a misconfigured server

1206
00:53:08,280 --> 00:53:10,260
many people don't consider that the

1207
00:53:10,260 --> 00:53:12,839
vulnerability uh it's been raising up in

1208
00:53:12,839 --> 00:53:16,020
a couple of presentations here uh it

1209
00:53:16,020 --> 00:53:18,960
will be trouble for you although it's

1210
00:53:18,960 --> 00:53:22,319
not a vulnerability another one is an

1211
00:53:22,319 --> 00:53:24,480
open service often combined with a

1212
00:53:24,480 --> 00:53:26,520
misconfiguration

1213
00:53:26,520 --> 00:53:29,040
so as you probably know

1214
00:53:29,040 --> 00:53:31,559
the denial of service attacks have

1215
00:53:31,559 --> 00:53:34,680
increased or at least high profile

1216
00:53:34,680 --> 00:53:37,099
denial service agree attacks have

1217
00:53:37,099 --> 00:53:40,200
increased in Finland recently

1218
00:53:40,200 --> 00:53:43,980
and the thing that the targets usually

1219
00:53:43,980 --> 00:53:46,680
do first the most effective stupid thing

1220
00:53:46,680 --> 00:53:49,859
to do is to say that okay we don't

1221
00:53:49,859 --> 00:53:52,260
accept traffic from outside Finland

1222
00:53:52,260 --> 00:53:54,960
okay the attack traffic mostly comes

1223
00:53:54,960 --> 00:53:57,119
from outside Finland and then the attack

1224
00:53:57,119 --> 00:54:00,180
attack traffic doesn't get to you and

1225
00:54:00,180 --> 00:54:03,180
you can serve your Finnish customers

1226
00:54:03,180 --> 00:54:04,980
that's probably not a good idea for many

1227
00:54:04,980 --> 00:54:06,720
of the many of the targets but still

1228
00:54:06,720 --> 00:54:09,359
it's been done and it's like okay we

1229
00:54:09,359 --> 00:54:11,160
took care of the problem

1230
00:54:11,160 --> 00:54:15,059
but then we have the case of

1231
00:54:15,059 --> 00:54:17,700
application attacks everyone probably

1232
00:54:17,700 --> 00:54:21,300
knows about these so especially in the

1233
00:54:21,300 --> 00:54:24,540
case of UDP where there is no real

1234
00:54:24,540 --> 00:54:26,940
connection between client server you can

1235
00:54:26,940 --> 00:54:29,280
send X one byte

1236
00:54:29,280 --> 00:54:33,180
to get like in case of net buyers 3.8

1237
00:54:33,180 --> 00:54:35,579
points to the Target of your choosing

1238
00:54:35,579 --> 00:54:39,000
and in extreme cases like 51 kilos the

1239
00:54:39,000 --> 00:54:41,520
target of your choosing and we we

1240
00:54:41,520 --> 00:54:43,380
combine this

1241
00:54:43,380 --> 00:54:45,780
fact with the fact that there are many

1242
00:54:45,780 --> 00:54:48,079
open services within Finland

1243
00:54:48,079 --> 00:54:51,240
you could actually do a denial of

1244
00:54:51,240 --> 00:54:54,540
service attack towards Finnish targets

1245
00:54:54,540 --> 00:54:56,280
from within Finland

1246
00:54:56,280 --> 00:54:59,640
by targeting these servers like we have

1247
00:54:59,640 --> 00:55:03,900
these are old figures I I was lazy I

1248
00:55:03,900 --> 00:55:05,880
didn't update them sorry for that it's

1249
00:55:05,880 --> 00:55:07,920
like okay we have

1250
00:55:07,920 --> 00:55:10,859
ten thousand open portmap instances we

1251
00:55:10,859 --> 00:55:15,660
have like 700 ssdps we have 142 memcast

1252
00:55:15,660 --> 00:55:18,480
and it's pretty hard to communicate to

1253
00:55:18,480 --> 00:55:21,359
users that hey you need you that's not

1254
00:55:21,359 --> 00:55:23,579
good for you you will get bitten by this

1255
00:55:23,579 --> 00:55:25,440
or you will of course harm to others

1256
00:55:25,440 --> 00:55:27,359
because of this

1257
00:55:27,359 --> 00:55:31,440
and uh the powers of taking down servers

1258
00:55:31,440 --> 00:55:34,800
because they have an open service seems

1259
00:55:34,800 --> 00:55:37,559
a bit Draconian so how to communicate

1260
00:55:37,559 --> 00:55:41,040
this effectively that a Target could

1261
00:55:41,040 --> 00:55:43,559
have an application factor of 8 million

1262
00:55:43,559 --> 00:55:46,500
by using these from within Finland and

1263
00:55:46,500 --> 00:55:48,000
the traditional defenses would stop

1264
00:55:48,000 --> 00:55:51,900
working so that's a message that we

1265
00:55:51,900 --> 00:55:54,780
as a community I think should get

1266
00:55:54,780 --> 00:55:58,020
through to system owners and now this

1267
00:55:58,020 --> 00:56:01,700
was the last thing that I had so thanks

1268
00:56:10,980 --> 00:56:13,260
I was promised that I can still accept

1269
00:56:13,260 --> 00:56:16,380
questions although it's late

1270
00:56:16,380 --> 00:56:18,660
you can also I'll be around you can just

1271
00:56:18,660 --> 00:56:20,040
grab me

1272
00:56:20,040 --> 00:56:22,700
by the

1273
00:56:32,040 --> 00:56:33,540
thank you for that a really good

1274
00:56:33,540 --> 00:56:35,040
presentation

1275
00:56:35,040 --> 00:56:38,460
um question do you have any follow-up

1276
00:56:38,460 --> 00:56:40,859
procedure mechanism or escalation path

1277
00:56:40,859 --> 00:56:43,680
if someone simply doesn't react and and

1278
00:56:43,680 --> 00:56:45,780
we still think they're causing a problem

1279
00:56:45,780 --> 00:56:52,140
to the finishing Network yeah so the uh

1280
00:56:52,140 --> 00:56:53,880
in case of malware it's pretty clear

1281
00:56:53,880 --> 00:56:56,220
I'll have to specify that we'll start

1282
00:56:56,220 --> 00:56:59,579
with that if you have malware uh

1283
00:56:59,579 --> 00:57:01,800
we have automated systems that will nag

1284
00:57:01,800 --> 00:57:04,440
the operator and they will nag at you

1285
00:57:04,440 --> 00:57:07,020
and then threaten with uh cutting you

1286
00:57:07,020 --> 00:57:08,700
off the internet and that will sort

1287
00:57:08,700 --> 00:57:10,500
itself out at some point

1288
00:57:10,500 --> 00:57:14,040
uh in case of vulnerabilities we aren't

1289
00:57:14,040 --> 00:57:18,000
quite there yet we we have a we look at

1290
00:57:18,000 --> 00:57:19,740
okay the graph is shrinking shrinking

1291
00:57:19,740 --> 00:57:21,599
shrinking okay we have another thing

1292
00:57:21,599 --> 00:57:24,540
coming up so there's always a residue of

1293
00:57:24,540 --> 00:57:26,220
vulnerabilities that we can't take care

1294
00:57:26,220 --> 00:57:29,720
of and that's the fact of life

1295
00:57:34,020 --> 00:57:36,839
okay I'm going to have a beer now thank

1296
00:57:36,839 --> 00:57:39,020
you

