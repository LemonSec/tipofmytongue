1
00:00:01,079 --> 00:00:03,060
good afternoon

2
00:00:03,060 --> 00:00:05,759
I think we can get started

3
00:00:05,759 --> 00:00:07,799
I've heard that I will be thrown off the

4
00:00:07,799 --> 00:00:10,080
states in 25 minutes so I probably

5
00:00:10,080 --> 00:00:12,240
need to be a little faster than I would

6
00:00:12,240 --> 00:00:14,519
actually enjoy to be but I will be

7
00:00:14,519 --> 00:00:15,900
talking a little about a couple of

8
00:00:15,900 --> 00:00:18,240
incidents that I have been investigating

9
00:00:18,240 --> 00:00:20,460
in the past and how those could have

10
00:00:20,460 --> 00:00:22,980
potentially been stopped

11
00:00:22,980 --> 00:00:24,660
um I will be telling a little bit about

12
00:00:24,660 --> 00:00:27,960
my background soon so the preventing

13
00:00:27,960 --> 00:00:30,000
methods the defending part is not really

14
00:00:30,000 --> 00:00:32,460
my forte so you probably might know

15
00:00:32,460 --> 00:00:34,680
things better than I do so please bear

16
00:00:34,680 --> 00:00:37,620
with me when we get to that stage

17
00:00:37,620 --> 00:00:40,200
but a couple of words of me so my name

18
00:00:40,200 --> 00:00:42,899
is Yoni mikkola I'm currently working as

19
00:00:42,899 --> 00:00:45,840
a dfir and stock development manager at

20
00:00:45,840 --> 00:00:49,860
nixu I'm uh leading our stock stock

21
00:00:49,860 --> 00:00:52,980
store teams CM teams and also also the

22
00:00:52,980 --> 00:00:55,980
DFI function been doing a lot of threat

23
00:00:55,980 --> 00:00:58,199
hunting in my past five years at Nixa

24
00:00:58,199 --> 00:01:00,059
and my first role when I joined the

25
00:01:00,059 --> 00:01:02,280
company was in incident response so I I

26
00:01:02,280 --> 00:01:04,920
was a technical incident responder four

27
00:01:04,920 --> 00:01:07,260
years in my career within nixu I I was

28
00:01:07,260 --> 00:01:08,939
actually getting a position to lead

29
00:01:08,939 --> 00:01:10,680
study of higher team a couple of months

30
00:01:10,680 --> 00:01:13,740
ago I got to cut my current position

31
00:01:13,740 --> 00:01:15,960
um my first actually one thing that I

32
00:01:15,960 --> 00:01:18,420
want to know this is my first time at

33
00:01:18,420 --> 00:01:20,820
this event it's nice to get to present

34
00:01:20,820 --> 00:01:22,080
that the first time that I attend

35
00:01:22,080 --> 00:01:23,640
actually so that's good

36
00:01:23,640 --> 00:01:26,520
um being 15 years in it and and Nixa is

37
00:01:26,520 --> 00:01:28,680
my first cyber security role before that

38
00:01:28,680 --> 00:01:30,600
diverse assistant admin or consultant

39
00:01:30,600 --> 00:01:33,240
doing things like Office 365 active

40
00:01:33,240 --> 00:01:36,000
directory link codes yes if you know

41
00:01:36,000 --> 00:01:38,579
know what those are and so forth

42
00:01:38,579 --> 00:01:42,659
so today I will be speaking of real life

43
00:01:42,659 --> 00:01:45,600
incidents real life preaches

44
00:01:45,600 --> 00:01:47,640
all the things that I speak of are

45
00:01:47,640 --> 00:01:49,380
something that has happened in in the

46
00:01:49,380 --> 00:01:51,960
reality it will be a fairly high level I

47
00:01:51,960 --> 00:01:54,000
will not be giving out details of course

48
00:01:54,000 --> 00:01:56,460
the companies which are affected by the

49
00:01:56,460 --> 00:01:58,740
crimes here do probably not want that

50
00:01:58,740 --> 00:02:01,020
they will be revealed in it which is why

51
00:02:01,020 --> 00:02:03,960
why I'm leaving a lot of details out of

52
00:02:03,960 --> 00:02:05,820
it also I don't want to be over the

53
00:02:05,820 --> 00:02:07,920
technical so if not all personal here

54
00:02:07,920 --> 00:02:10,380
are are super into techniques that you

55
00:02:10,380 --> 00:02:13,379
probably can understand what I'm saying

56
00:02:13,379 --> 00:02:15,959
I will only go to part of the techniques

57
00:02:15,959 --> 00:02:18,480
that we have observed in those

58
00:02:18,480 --> 00:02:20,819
um this these were hand-picked by me I

59
00:02:20,819 --> 00:02:22,200
thought they were at least partly

60
00:02:22,200 --> 00:02:23,940
interesting which is why I have chosen

61
00:02:23,940 --> 00:02:25,379
the ones that I'm actually speaking of

62
00:02:25,379 --> 00:02:26,220
today

63
00:02:26,220 --> 00:02:28,620
there would have been many other little

64
00:02:28,620 --> 00:02:30,420
leaders that I could have spoke of but

65
00:02:30,420 --> 00:02:32,160
yeah maybe next time

66
00:02:32,160 --> 00:02:35,400
also as I stated the last part of this

67
00:02:35,400 --> 00:02:37,920
presentation will be about how these

68
00:02:37,920 --> 00:02:40,560
three incidents could have been stopped

69
00:02:40,560 --> 00:02:42,420
not really going to speak how you are

70
00:02:42,420 --> 00:02:44,280
actually in in in general stopping

71
00:02:44,280 --> 00:02:46,260
breaches but how these three that I'm

72
00:02:46,260 --> 00:02:47,940
going to would have been stopped most

73
00:02:47,940 --> 00:02:50,819
likely and also good to note I'm

74
00:02:50,819 --> 00:02:54,239
following miter attack mattress and we

75
00:02:54,239 --> 00:02:56,760
can start with it so what this is it's

76
00:02:56,760 --> 00:02:58,260
basically something that has been

77
00:02:58,260 --> 00:03:00,920
developed uh since located on Martin

78
00:03:00,920 --> 00:03:04,319
released a cyber kill chain this is sort

79
00:03:04,319 --> 00:03:07,200
of a more broad version of it it has a

80
00:03:07,200 --> 00:03:09,780
lot of details in it so basically in the

81
00:03:09,780 --> 00:03:11,400
Enterprise mattress there is another one

82
00:03:11,400 --> 00:03:13,800
for OT for example but I'm I'm talking

83
00:03:13,800 --> 00:03:16,800
of the Enterprise or ID stuff here it

84
00:03:16,800 --> 00:03:20,220
has 40 in different tactics and they are

85
00:03:20,220 --> 00:03:22,739
trying to be in chronological order so

86
00:03:22,739 --> 00:03:24,540
there's 14 different starting which

87
00:03:24,540 --> 00:03:26,040
reckon going to Resource development

88
00:03:26,040 --> 00:03:28,099
initial access and so forth

89
00:03:28,099 --> 00:03:31,200
I'm not going to go through all of these

90
00:03:31,200 --> 00:03:33,659
tactics one by one but when I get to an

91
00:03:33,659 --> 00:03:35,879
interesting point I might say a word or

92
00:03:35,879 --> 00:03:37,980
two about some of them

93
00:03:37,980 --> 00:03:40,080
but what you need to remember there's 14

94
00:03:40,080 --> 00:03:41,879
of this and this is very very very good

95
00:03:41,879 --> 00:03:43,920
good thing to have a very good thing to

96
00:03:43,920 --> 00:03:45,180
follow when you are building your

97
00:03:45,180 --> 00:03:46,980
capabilities in detection site for

98
00:03:46,980 --> 00:03:48,720
example uh

99
00:03:48,720 --> 00:03:50,819
a single tactic here let's take for

100
00:03:50,819 --> 00:03:53,519
example execution as a tactic that could

101
00:03:53,519 --> 00:03:56,099
have hundreds of techniques in it

102
00:03:56,099 --> 00:03:58,379
techniques and sub techniques and those

103
00:03:58,379 --> 00:04:00,239
are very Hands-On stuff very very

104
00:04:00,239 --> 00:04:01,980
Hands-On so it could be something like

105
00:04:01,980 --> 00:04:03,780
CLI something is executing something

106
00:04:03,780 --> 00:04:06,780
with power cell so you can use those and

107
00:04:06,780 --> 00:04:08,640
map your visibility for example in stock

108
00:04:08,640 --> 00:04:10,920
if you would like to do so uh in

109
00:04:10,920 --> 00:04:13,080
incident response it's not chronological

110
00:04:13,080 --> 00:04:15,000
so this is how it looks in the reality

111
00:04:15,000 --> 00:04:17,100
when you're actually looking at how the

112
00:04:17,100 --> 00:04:18,478
attackers are dealing within the

113
00:04:18,478 --> 00:04:20,160
environment so they are jumping all over

114
00:04:20,160 --> 00:04:21,600
the place someone might be actually

115
00:04:21,600 --> 00:04:23,699
jumping from lateral movement to the

116
00:04:23,699 --> 00:04:25,740
actual impact phase impact phase being

117
00:04:25,740 --> 00:04:27,660
the last one which is when when data

118
00:04:27,660 --> 00:04:29,639
gets encrypted and all that fun stuff

119
00:04:29,639 --> 00:04:32,100
so it's not really chronological things

120
00:04:32,100 --> 00:04:34,380
tend to jump jump from one tactic to

121
00:04:34,380 --> 00:04:37,259
another and it's normal for the attacks

122
00:04:37,259 --> 00:04:39,000
if you are in incident response you'll

123
00:04:39,000 --> 00:04:41,100
most likely know this

124
00:04:41,100 --> 00:04:44,040
but from this we can actually jump to

125
00:04:44,040 --> 00:04:47,040
the interesting part so first case that

126
00:04:47,040 --> 00:04:50,759
I'm speaking of today called close call

127
00:04:50,759 --> 00:04:53,160
maybe someone can even

128
00:04:53,160 --> 00:04:56,340
guess what will happen in this incident

129
00:04:56,340 --> 00:04:59,520
maybe not but this one started with a

130
00:04:59,520 --> 00:05:02,220
resource development tactic and resource

131
00:05:02,220 --> 00:05:03,780
development is a tactic where the

132
00:05:03,780 --> 00:05:05,400
attacker is actually building something

133
00:05:05,400 --> 00:05:08,160
to gain access to your environment so

134
00:05:08,160 --> 00:05:09,900
they're good for example built-in on

135
00:05:09,900 --> 00:05:11,880
malware at this stage they could code

136
00:05:11,880 --> 00:05:13,500
something but they could also for

137
00:05:13,500 --> 00:05:16,320
example Facebook accounts and in this

138
00:05:16,320 --> 00:05:18,300
particular case the attacker got access

139
00:05:18,300 --> 00:05:21,060
to a credential user credentials

140
00:05:21,060 --> 00:05:23,639
we don't know how that wasn't really

141
00:05:23,639 --> 00:05:26,880
revealed in the investigation I mean if

142
00:05:26,880 --> 00:05:28,259
you are in incident response you

143
00:05:28,259 --> 00:05:31,259
probably know this when users credit

144
00:05:31,259 --> 00:05:33,360
installs are compromised and you can say

145
00:05:33,360 --> 00:05:35,280
that they are compromised then you go

146
00:05:35,280 --> 00:05:37,380
and ask the user this you click a link

147
00:05:37,380 --> 00:05:40,380
maybe they always say no no I didn't I

148
00:05:40,380 --> 00:05:42,660
didn't do anything bad and they are of

149
00:05:42,660 --> 00:05:44,160
course lying

150
00:05:44,160 --> 00:05:45,680
so yeah

151
00:05:45,680 --> 00:05:49,380
it's potentially a victim of a fishing

152
00:05:49,380 --> 00:05:51,120
attack but we don't know

153
00:05:51,120 --> 00:05:54,300
after this the threat actor was able to

154
00:05:54,300 --> 00:05:55,680
find

155
00:05:55,680 --> 00:05:58,860
publicly available remote access server

156
00:05:58,860 --> 00:06:01,800
it wasn't VPN in this case but sort of a

157
00:06:01,800 --> 00:06:03,479
similar thing so basically to attack I

158
00:06:03,479 --> 00:06:05,699
got access to publicly available server

159
00:06:05,699 --> 00:06:07,199
from which they could actually move

160
00:06:07,199 --> 00:06:10,199
further within the network

161
00:06:10,199 --> 00:06:12,720
it's fairly easy for the attacker to

162
00:06:12,720 --> 00:06:14,639
find these services so basically they

163
00:06:14,639 --> 00:06:16,320
can run public scans they can Target

164
00:06:16,320 --> 00:06:18,300
your own public subnets and they can

165
00:06:18,300 --> 00:06:19,919
find this stuff out if they want to and

166
00:06:19,919 --> 00:06:21,900
if they have working credentials

167
00:06:21,900 --> 00:06:23,699
they're good to go

168
00:06:23,699 --> 00:06:25,800
after that the threat actor was

169
00:06:25,800 --> 00:06:27,960
launching I'm writing here malware known

170
00:06:27,960 --> 00:06:29,819
as Corel strike but yeah it's not really

171
00:06:29,819 --> 00:06:32,639
malware Global strike is a tool for

172
00:06:32,639 --> 00:06:35,100
penetration testers and red teamers so

173
00:06:35,100 --> 00:06:37,919
basically it's sort of a C2 framework if

174
00:06:37,919 --> 00:06:41,180
you will works by client or B conserver

175
00:06:41,180 --> 00:06:44,400
methodology so basically attacker or the

176
00:06:44,400 --> 00:06:46,800
red team are here installs the global

177
00:06:46,800 --> 00:06:48,300
strike server somewhere in the internet

178
00:06:48,300 --> 00:06:51,060
then they try to get their clients or

179
00:06:51,060 --> 00:06:53,759
beacons inside your network and when

180
00:06:53,759 --> 00:06:55,979
they do that the clients or beacons will

181
00:06:55,979 --> 00:06:58,680
be calling home to the server

182
00:06:58,680 --> 00:07:00,300
then the attacker can actually launch

183
00:07:00,300 --> 00:07:01,979
whatever comments they like from the

184
00:07:01,979 --> 00:07:04,500
server targeting those endpoints but

185
00:07:04,500 --> 00:07:06,840
yeah it's not really a malware it's a

186
00:07:06,840 --> 00:07:08,699
legitimate tool and actually the vendor

187
00:07:08,699 --> 00:07:10,800
does not sell that you will do anyone so

188
00:07:10,800 --> 00:07:12,660
basically they have a quite quite some

189
00:07:12,660 --> 00:07:16,080
extensive vetting program if I as a

190
00:07:16,080 --> 00:07:18,000
person would go to them and hey I'd like

191
00:07:18,000 --> 00:07:19,500
to buy cobblestracks from you they

192
00:07:19,500 --> 00:07:22,080
probably would tell you go go away we

193
00:07:22,080 --> 00:07:23,819
don't really want to sell it to you but

194
00:07:23,819 --> 00:07:25,860
because it's a very good tool

195
00:07:25,860 --> 00:07:28,080
just right actors still like to use it

196
00:07:28,080 --> 00:07:30,780
they want to use it and they can because

197
00:07:30,780 --> 00:07:34,139
they can get the trial version of it

198
00:07:34,139 --> 00:07:37,080
or correct version

199
00:07:37,080 --> 00:07:38,759
nothing about it can be done by that

200
00:07:38,759 --> 00:07:40,620
unfortunately in this case it didn't

201
00:07:40,620 --> 00:07:43,380
really work uh malware products have

202
00:07:43,380 --> 00:07:44,940
stopped it and the virus stopped it

203
00:07:44,940 --> 00:07:47,699
partly we also had devices where there

204
00:07:47,699 --> 00:07:49,620
was no signs that antivirus would have

205
00:07:49,620 --> 00:07:51,120
been blocking it but still it failed for

206
00:07:51,120 --> 00:07:53,400
some reason nobody why but hey it is

207
00:07:53,400 --> 00:07:54,419
what it is

208
00:07:54,419 --> 00:07:56,160
that's right actor was

209
00:07:56,160 --> 00:07:58,919
Thailand for a couple of days after that

210
00:07:58,919 --> 00:08:01,380
they moved on to Powershell based threat

211
00:08:01,380 --> 00:08:03,479
remote access Trojan

212
00:08:03,479 --> 00:08:05,580
the remote access road sign itself was

213
00:08:05,580 --> 00:08:08,580
trying to bypass AMC quite again easy

214
00:08:08,580 --> 00:08:10,680
easy for anyone who understands the

215
00:08:10,680 --> 00:08:12,300
techniques it's not very hard to do that

216
00:08:12,300 --> 00:08:14,039
and they were trying to bypass it

217
00:08:14,039 --> 00:08:15,660
because well if you don't know what OMSI

218
00:08:15,660 --> 00:08:18,120
does it's trying to pinpoint malice's

219
00:08:18,120 --> 00:08:20,400
Powers I'll use it so yeah Power Cell is

220
00:08:20,400 --> 00:08:22,500
used very lot in in different kind of

221
00:08:22,500 --> 00:08:23,940
attacks so it's it's very very common

222
00:08:23,940 --> 00:08:25,620
tool for the attackers to be using so

223
00:08:25,620 --> 00:08:28,740
OMSI was built by Microsoft to stop that

224
00:08:28,740 --> 00:08:30,660
or prevent that

225
00:08:30,660 --> 00:08:34,219
in this case it was loaded with

226
00:08:34,219 --> 00:08:36,719
svr2.exe the dll which was trying to do

227
00:08:36,719 --> 00:08:38,399
the bypass

228
00:08:38,399 --> 00:08:41,640
uh while I did the threat actor was able

229
00:08:41,640 --> 00:08:43,500
to gain access to several different user

230
00:08:43,500 --> 00:08:44,760
accounts

231
00:08:44,760 --> 00:08:48,000
they had many accounts multiple accounts

232
00:08:48,000 --> 00:08:50,459
after which they use the power of the

233
00:08:50,459 --> 00:08:52,620
Rat which I described earlier and they

234
00:08:52,620 --> 00:08:54,959
were laterally moved within the network

235
00:08:54,959 --> 00:08:57,660
using the Powershell rat and the

236
00:08:57,660 --> 00:08:59,360
accounts that they had acquired

237
00:08:59,360 --> 00:09:01,440
interesting thing about this case is

238
00:09:01,440 --> 00:09:03,899
that they tried to Target every single

239
00:09:03,899 --> 00:09:05,640
device within the domain active

240
00:09:05,640 --> 00:09:07,380
directory domain so they pulled the list

241
00:09:07,380 --> 00:09:09,660
of computer accounts from the domain and

242
00:09:09,660 --> 00:09:12,959
targeted the attack against all of them

243
00:09:12,959 --> 00:09:14,820
fortunately

244
00:09:14,820 --> 00:09:17,040
the threat actor stole accounts which

245
00:09:17,040 --> 00:09:19,560
had pretty much quite low amount of

246
00:09:19,560 --> 00:09:21,600
privileges

247
00:09:21,600 --> 00:09:24,779
they only had a local admin privileges

248
00:09:24,779 --> 00:09:26,640
on some servers so they didn't really

249
00:09:26,640 --> 00:09:29,100
have domain admin level privileges if

250
00:09:29,100 --> 00:09:31,080
they would have that they probably would

251
00:09:31,080 --> 00:09:33,480
have infected thousands of devices but

252
00:09:33,480 --> 00:09:35,160
in this attack because they only had

253
00:09:35,160 --> 00:09:37,620
local admin privileges on on certain set

254
00:09:37,620 --> 00:09:39,779
of devices they were only able to infect

255
00:09:39,779 --> 00:09:42,560
tens of devices

256
00:09:42,620 --> 00:09:45,899
one unfortunate node in this attack was

257
00:09:45,899 --> 00:09:49,260
and why they succeeded is that the

258
00:09:49,260 --> 00:09:52,019
originally compromised account had local

259
00:09:52,019 --> 00:09:54,120
admin permissions on the remote access

260
00:09:54,120 --> 00:09:56,100
server

261
00:09:56,100 --> 00:09:58,440
so they're good potentially for example

262
00:09:58,440 --> 00:10:00,300
dump the credentials from there remote

263
00:10:00,300 --> 00:10:02,580
access servers is being used by a lot of

264
00:10:02,580 --> 00:10:05,040
different accounts so it's quite quite

265
00:10:05,040 --> 00:10:07,140
likely that other accounts were acquired

266
00:10:07,140 --> 00:10:10,140
acquired from there but the fortunate

267
00:10:10,140 --> 00:10:12,300
thing in this was that it was stopped

268
00:10:12,300 --> 00:10:13,860
before anything really malicious

269
00:10:13,860 --> 00:10:16,140
happened so tens of devices were

270
00:10:16,140 --> 00:10:19,760
actually affected but nothing else

271
00:10:19,800 --> 00:10:22,680
let's move on to the crossfire

272
00:10:22,680 --> 00:10:25,459
oh

273
00:10:25,800 --> 00:10:29,100
in this case the trade actor got access

274
00:10:29,100 --> 00:10:32,880
to Excel sheet Excel file the Excel file

275
00:10:32,880 --> 00:10:35,220
itself looked something like on the

276
00:10:35,220 --> 00:10:37,500
slide so basically there were list of

277
00:10:37,500 --> 00:10:40,440
user accounts and there were also list

278
00:10:40,440 --> 00:10:43,980
of passwords for those user accounts

279
00:10:43,980 --> 00:10:46,260
yeah also

280
00:10:46,260 --> 00:10:49,500
the particular list had list of VPN

281
00:10:49,500 --> 00:10:51,660
addresses publicly available VPN

282
00:10:51,660 --> 00:10:53,760
addresses so the threat actor actually

283
00:10:53,760 --> 00:10:55,440
didn't even run a scan here they didn't

284
00:10:55,440 --> 00:10:57,899
need to they had to information in a

285
00:10:57,899 --> 00:11:00,660
single Excel file all the information to

286
00:11:00,660 --> 00:11:02,459
compromise this environment

287
00:11:02,459 --> 00:11:05,040
IP addresses for internal servers names

288
00:11:05,040 --> 00:11:07,260
for internal servers roles for internal

289
00:11:07,260 --> 00:11:10,079
servers and of course quite high level

290
00:11:10,079 --> 00:11:11,700
highly privileged attack count

291
00:11:11,700 --> 00:11:13,079
information too

292
00:11:13,079 --> 00:11:15,720
someone maybe

293
00:11:15,720 --> 00:11:18,120
someone from the inside inside a trip

294
00:11:18,120 --> 00:11:20,279
maybe gave access to the attacker to

295
00:11:20,279 --> 00:11:21,779
that list

296
00:11:21,779 --> 00:11:23,519
um I don't want to give too much of

297
00:11:23,519 --> 00:11:26,459
details how that potential got acquired

298
00:11:26,459 --> 00:11:29,820
but there is a huge possibility that

299
00:11:29,820 --> 00:11:31,560
this was Insider threat

300
00:11:31,560 --> 00:11:34,079
and if it was this was the only time

301
00:11:34,079 --> 00:11:36,899
I've investigated hundreds of cases and

302
00:11:36,899 --> 00:11:39,779
this has been potentiality only time in

303
00:11:39,779 --> 00:11:41,820
Finland when there has been or in my

304
00:11:41,820 --> 00:11:43,740
investigations and of course because I'm

305
00:11:43,740 --> 00:11:45,360
working at nixo I'm mostly dealing with

306
00:11:45,360 --> 00:11:47,459
Finnish companies it's it's possible

307
00:11:47,459 --> 00:11:48,899
that this was the only case where there

308
00:11:48,899 --> 00:11:51,420
was actually inside a threat

309
00:11:51,420 --> 00:11:54,300
but of course that can be proven

310
00:11:54,300 --> 00:11:56,760
nevertheless after they got access to

311
00:11:56,760 --> 00:11:58,500
their environment internally they were

312
00:11:58,500 --> 00:12:02,100
running Discovery scans Discovery is a

313
00:12:02,100 --> 00:12:03,899
tactic where the attacker is trying to

314
00:12:03,899 --> 00:12:05,459
gain more information of the target

315
00:12:05,459 --> 00:12:07,680
Network after initial access after they

316
00:12:07,680 --> 00:12:09,060
got access in

317
00:12:09,060 --> 00:12:10,860
they were launching some Network scans

318
00:12:10,860 --> 00:12:13,019
and they were trying to find out if they

319
00:12:13,019 --> 00:12:14,880
had if the leash that they had contained

320
00:12:14,880 --> 00:12:16,320
actually all the devices in the network

321
00:12:16,320 --> 00:12:17,700
or not

322
00:12:17,700 --> 00:12:20,700
afterwards of course they laterally

323
00:12:20,700 --> 00:12:22,380
moved within the network they were

324
00:12:22,380 --> 00:12:25,380
mostly using RDP mostly moving manually

325
00:12:25,380 --> 00:12:27,660
within within the network and sometimes

326
00:12:27,660 --> 00:12:29,100
they were actually pushing something

327
00:12:29,100 --> 00:12:33,300
through smb2 but it was mostly rdb

328
00:12:33,300 --> 00:12:36,420
after which the attacker gains access

329
00:12:36,420 --> 00:12:39,420
they were able to find business data

330
00:12:39,420 --> 00:12:41,940
I mean it was only tens of gigabytes of

331
00:12:41,940 --> 00:12:44,279
business data so I guess that's good or

332
00:12:44,279 --> 00:12:48,139
bad depends on your business

333
00:12:50,820 --> 00:12:52,740
all the data was exfiltrated that the

334
00:12:52,740 --> 00:12:54,240
attacker deemed interesting of course

335
00:12:54,240 --> 00:12:55,440
which is normal

336
00:12:55,440 --> 00:12:57,959
and over what one interesting case about

337
00:12:57,959 --> 00:13:00,899
this the or detail of this case is that

338
00:13:00,899 --> 00:13:03,180
the attacker was using completely

339
00:13:03,180 --> 00:13:05,579
legitimate cloud service something that

340
00:13:05,579 --> 00:13:07,380
mostly at least some of you are using

341
00:13:07,380 --> 00:13:10,320
but I'll leave that unnamed

342
00:13:10,320 --> 00:13:11,760
then

343
00:13:11,760 --> 00:13:13,200
boo

344
00:13:13,200 --> 00:13:15,720
the environment was encrypted

345
00:13:15,720 --> 00:13:17,639
then the good news

346
00:13:17,639 --> 00:13:20,160
partly

347
00:13:20,160 --> 00:13:22,040
so

348
00:13:22,040 --> 00:13:25,860
last interesting fact of this case the

349
00:13:25,860 --> 00:13:29,820
threat actor was in a network which was

350
00:13:29,820 --> 00:13:31,680
um sort of I I don't want to say

351
00:13:31,680 --> 00:13:33,480
segmented but there were multiple

352
00:13:33,480 --> 00:13:35,040
subnets they did not didn't really have

353
00:13:35,040 --> 00:13:37,339
firewalls or anything in between of them

354
00:13:37,339 --> 00:13:40,139
but the threat actor didn't really

355
00:13:40,139 --> 00:13:42,899
realize that they had huge access to

356
00:13:42,899 --> 00:13:45,959
multiple tens of sites no firewalls in

357
00:13:45,959 --> 00:13:46,920
between

358
00:13:46,920 --> 00:13:48,839
would they have been a little bit better

359
00:13:48,839 --> 00:13:50,459
on what they are doing they would have

360
00:13:50,459 --> 00:13:51,959
noted that they have actually domain

361
00:13:51,959 --> 00:13:54,120
admin level account store in one of the

362
00:13:54,120 --> 00:13:56,700
servers uh this was the single active

363
00:13:56,700 --> 00:13:58,920
directory domain by the way

364
00:13:58,920 --> 00:14:01,620
should they have been stolen password of

365
00:14:01,620 --> 00:14:04,260
that particular attack and notice that

366
00:14:04,260 --> 00:14:05,820
actually we have Global access to

367
00:14:05,820 --> 00:14:07,260
anywhere they would have been actually

368
00:14:07,260 --> 00:14:09,180
encrypting all the devices of that

369
00:14:09,180 --> 00:14:11,279
company but this was fairly small brand

370
00:14:11,279 --> 00:14:13,680
service so fortunately territory wasn't

371
00:14:13,680 --> 00:14:15,120
too good

372
00:14:15,120 --> 00:14:16,860
not to really go into recap everything

373
00:14:16,860 --> 00:14:19,680
that I just said so let's move on to the

374
00:14:19,680 --> 00:14:20,880
last one

375
00:14:20,880 --> 00:14:24,019
anyone guess what happens

376
00:14:24,300 --> 00:14:27,660
yeah so initial access Vector here was

377
00:14:27,660 --> 00:14:29,519
VPN service

378
00:14:29,519 --> 00:14:31,800
once more

379
00:14:31,800 --> 00:14:33,899
nothing especially all of it but then

380
00:14:33,899 --> 00:14:35,579
one

381
00:14:35,579 --> 00:14:39,180
little bit of information unfortunately

382
00:14:39,180 --> 00:14:40,860
she stole an account the stolen

383
00:14:40,860 --> 00:14:44,160
credentials had dominated from the

384
00:14:44,160 --> 00:14:46,320
get-go and that's my real face when I

385
00:14:46,320 --> 00:14:49,620
found that out I mean come on who who

386
00:14:49,620 --> 00:14:51,600
gives dominant level access to anyone

387
00:14:51,600 --> 00:14:53,279
who can log in remotely

388
00:14:53,279 --> 00:14:54,959
well yeah quite many I guess but

389
00:14:54,959 --> 00:14:56,399
hopefully you don't

390
00:14:56,399 --> 00:14:59,459
anyways again Tia Decker was using

391
00:14:59,459 --> 00:15:03,540
mostly SFTP and RDP to move or at least

392
00:15:03,540 --> 00:15:05,660
to move some data within the network

393
00:15:05,660 --> 00:15:08,579
I'll tell you a little bit more of the

394
00:15:08,579 --> 00:15:11,699
SFTP usage later on

395
00:15:11,699 --> 00:15:13,920
this was mostly done manually so

396
00:15:13,920 --> 00:15:16,800
everything here rdb all sfdb and all

397
00:15:16,800 --> 00:15:18,839
that fun stuff manual work

398
00:15:18,839 --> 00:15:21,060
no automation or anything

399
00:15:21,060 --> 00:15:24,959
after the fact they were able to find

400
00:15:24,959 --> 00:15:28,079
hundreds of gigabytes of data and this

401
00:15:28,079 --> 00:15:30,120
is interesting case as in lately Detroit

402
00:15:30,120 --> 00:15:32,339
actors especially the ransomware actors

403
00:15:32,339 --> 00:15:34,380
are quite quick in their operations so

404
00:15:34,380 --> 00:15:36,779
take them in to encrypt your environment

405
00:15:36,779 --> 00:15:39,779
in two hours after this redactor was in

406
00:15:39,779 --> 00:15:41,220
this environment for weeks before they

407
00:15:41,220 --> 00:15:42,839
actually encrypted it so they had quite

408
00:15:42,839 --> 00:15:44,040
some time to actually find the

409
00:15:44,040 --> 00:15:45,480
interesting day that they had quite some

410
00:15:45,480 --> 00:15:47,459
time to actually write it out and of

411
00:15:47,459 --> 00:15:48,839
course they were very successful in

412
00:15:48,839 --> 00:15:50,940
stealing pretty much anything here

413
00:15:50,940 --> 00:15:52,680
and after this you probably guess what

414
00:15:52,680 --> 00:15:54,120
happens

415
00:15:54,120 --> 00:15:55,500
boom

416
00:15:55,500 --> 00:15:57,899
everything is encrypted

417
00:15:57,899 --> 00:16:00,480
I say everything and I mean it

418
00:16:00,480 --> 00:16:03,260
backups

419
00:16:04,139 --> 00:16:06,420
so let's get back to the sft building

420
00:16:06,420 --> 00:16:10,680
then so why SFTP this company

421
00:16:10,680 --> 00:16:14,100
used a lot of esxi well if you don't

422
00:16:14,100 --> 00:16:16,440
know what esxr is it's hypervisor so

423
00:16:16,440 --> 00:16:18,480
it's a server which is hosting other

424
00:16:18,480 --> 00:16:20,940
servers virtually

425
00:16:20,940 --> 00:16:23,760
um other products exist like hyper-v but

426
00:16:23,760 --> 00:16:25,860
in this case the company was using esxi

427
00:16:25,860 --> 00:16:27,779
servers to host different tens of

428
00:16:27,779 --> 00:16:29,399
different servers and they had around 10

429
00:16:29,399 --> 00:16:32,279
esxi hosts if I remember correctly

430
00:16:32,279 --> 00:16:34,320
there was a little bit of an unfortunate

431
00:16:34,320 --> 00:16:36,360
thing I mean you remember that the the

432
00:16:36,360 --> 00:16:38,279
threat actor had domain admin level

433
00:16:38,279 --> 00:16:40,500
level privileges from the get-go

434
00:16:40,500 --> 00:16:43,259
the same password of of the account was

435
00:16:43,259 --> 00:16:46,139
used for the local account on the esxi

436
00:16:46,139 --> 00:16:47,699
hosts

437
00:16:47,699 --> 00:16:49,800
so they were pretty much using the same

438
00:16:49,800 --> 00:16:52,079
account jumped into the esxi hosts

439
00:16:52,079 --> 00:16:54,540
encrypt those

440
00:16:54,540 --> 00:16:56,399
all the backup servers were hosted on

441
00:16:56,399 --> 00:16:59,220
those esxi servers so pretty much

442
00:16:59,220 --> 00:17:01,560
everything was lost

443
00:17:01,560 --> 00:17:05,839
no off-site backups nothing

444
00:17:06,419 --> 00:17:08,520
yeah the customer was a little bit

445
00:17:08,520 --> 00:17:10,319
panicky at this stage I can tell you

446
00:17:10,319 --> 00:17:12,500
that

447
00:17:14,760 --> 00:17:16,619
I'm not going to go to the recovery

448
00:17:16,619 --> 00:17:18,179
phase very much but

449
00:17:18,179 --> 00:17:21,179
um I know that the company here was at

450
00:17:21,179 --> 00:17:22,679
least trying to negotiate with the

451
00:17:22,679 --> 00:17:25,559
ransomware actor but I myself don't

452
00:17:25,559 --> 00:17:27,240
really recommend that and I don't want

453
00:17:27,240 --> 00:17:29,460
to be included in all that so

454
00:17:29,460 --> 00:17:33,960
yeah don't know what happened in the end

455
00:17:33,960 --> 00:17:35,940
so

456
00:17:35,940 --> 00:17:37,799
how good these have been prevented I

457
00:17:37,799 --> 00:17:40,620
have all my the six or so minutes to

458
00:17:40,620 --> 00:17:44,899
tell you about this so hey let's be fast

459
00:17:45,059 --> 00:17:47,160
so what was common in all of these

460
00:17:47,160 --> 00:17:49,640
attacks

461
00:17:50,220 --> 00:17:52,080
firstly

462
00:17:52,080 --> 00:17:53,460
identity

463
00:17:53,460 --> 00:17:55,559
by the way I need to check the slides

464
00:17:55,559 --> 00:17:56,760
every time that I'm changing them

465
00:17:56,760 --> 00:17:58,980
because my Mac is awesome I really

466
00:17:58,980 --> 00:18:01,580
recommend Max

467
00:18:02,160 --> 00:18:04,200
identity yeah the threat doctor was

468
00:18:04,200 --> 00:18:07,440
using real working credentials on all of

469
00:18:07,440 --> 00:18:09,179
these three cases they were able to

470
00:18:09,179 --> 00:18:11,220
steal Credence are somehow in all of

471
00:18:11,220 --> 00:18:13,400
this

472
00:18:13,679 --> 00:18:16,020
also interesting fact of course is that

473
00:18:16,020 --> 00:18:17,880
on two of calculations of these three is

474
00:18:17,880 --> 00:18:20,160
it had way too much permissions which

475
00:18:20,160 --> 00:18:22,380
are actually no I I'm lying it was all

476
00:18:22,380 --> 00:18:24,179
three guys as they they had way more

477
00:18:24,179 --> 00:18:26,460
more access that they should have icons

478
00:18:26,460 --> 00:18:27,960
which is logging in remote let's do a

479
00:18:27,960 --> 00:18:30,419
repo remote access server VPN or

480
00:18:30,419 --> 00:18:32,039
whatever students really have domain at

481
00:18:32,039 --> 00:18:34,740
me level privileges or even local admin

482
00:18:34,740 --> 00:18:36,600
privileges on the server which they are

483
00:18:36,600 --> 00:18:37,799
logging into

484
00:18:37,799 --> 00:18:40,679
it's quite bad I mean yeah the second

485
00:18:40,679 --> 00:18:42,480
thing lateral movement

486
00:18:42,480 --> 00:18:44,820
on all of these cases the attacker was

487
00:18:44,820 --> 00:18:47,039
successfully moving laterally in the

488
00:18:47,039 --> 00:18:47,880
network

489
00:18:47,880 --> 00:18:51,059
and thirdly this is very boring I mean I

490
00:18:51,059 --> 00:18:52,740
don't know why I even added this this is

491
00:18:52,740 --> 00:18:55,500
so lame malware all the incidents

492
00:18:55,500 --> 00:18:58,860
included at least single malware

493
00:18:58,860 --> 00:19:01,500
most of them had more than one but for

494
00:19:01,500 --> 00:19:03,419
example the last one which I showed to

495
00:19:03,419 --> 00:19:05,880
sft beating it only pretty much had one

496
00:19:05,880 --> 00:19:08,100
malware or well if if we tell you that

497
00:19:08,100 --> 00:19:10,380
or or think that the same malware is

498
00:19:10,380 --> 00:19:13,200
different on esxi or Linux source and

499
00:19:13,200 --> 00:19:15,179
window source so if you we take that in

500
00:19:15,179 --> 00:19:19,320
account then yes there was actually two

501
00:19:19,320 --> 00:19:22,559
so how you would uh product identity

502
00:19:22,559 --> 00:19:25,440
MFA I'm very late to the party here I

503
00:19:25,440 --> 00:19:30,240
mean everyone has implemented MFA right

504
00:19:30,240 --> 00:19:31,400
yeah

505
00:19:31,400 --> 00:19:33,000
no

506
00:19:33,000 --> 00:19:35,400
all these three cases have happened in

507
00:19:35,400 --> 00:19:37,620
recent history let's put it in that way

508
00:19:37,620 --> 00:19:41,340
so there's still MFA missing there's two

509
00:19:41,340 --> 00:19:43,260
management level privileges which can

510
00:19:43,260 --> 00:19:45,059
log in remotely and don't have MFA

511
00:19:45,059 --> 00:19:46,700
enabled

512
00:19:46,700 --> 00:19:49,679
uh of course I'm sure that Nicholas

513
00:19:49,679 --> 00:19:52,620
tarakar later today will tell us why MFA

514
00:19:52,620 --> 00:19:54,780
isn't perfect

515
00:19:54,780 --> 00:19:57,419
but still it's better than nothing

516
00:19:57,419 --> 00:20:00,240
user training against fishing so we

517
00:20:00,240 --> 00:20:02,400
weren't really sure how the accounts

518
00:20:02,400 --> 00:20:04,559
were compromised in in this case but

519
00:20:04,559 --> 00:20:06,360
it's quite likely that at least some of

520
00:20:06,360 --> 00:20:07,799
them were

521
00:20:07,799 --> 00:20:09,660
um compromised by phishing so user

522
00:20:09,660 --> 00:20:11,400
trading I guess is the best way to

523
00:20:11,400 --> 00:20:13,440
battle that there are technical means I

524
00:20:13,440 --> 00:20:15,900
know I know but no one has yet shown me

525
00:20:15,900 --> 00:20:18,960
the Silver Bullet for producting for

526
00:20:18,960 --> 00:20:22,080
fishing attacks and lastly principle of

527
00:20:22,080 --> 00:20:24,000
least privilege

528
00:20:24,000 --> 00:20:25,559
yeah

529
00:20:25,559 --> 00:20:27,299
no need to have domain at mirror level

530
00:20:27,299 --> 00:20:29,340
privileges on an account which cannot

531
00:20:29,340 --> 00:20:32,280
log in remotely and this is often

532
00:20:32,280 --> 00:20:34,879
forgotten

533
00:20:36,000 --> 00:20:38,039
a single user account should only have

534
00:20:38,039 --> 00:20:41,460
as much as much privilege as needed

535
00:20:41,460 --> 00:20:44,580
office user please don't have them have

536
00:20:44,580 --> 00:20:47,039
local admin permissions

537
00:20:47,039 --> 00:20:49,980
that's a bad idea

538
00:20:49,980 --> 00:20:51,840
let's move on to the lateral movement

539
00:20:51,840 --> 00:20:53,280
part

540
00:20:53,280 --> 00:20:54,480
so

541
00:20:54,480 --> 00:20:57,539
I'm no expert in active directory theory

542
00:20:57,539 --> 00:20:58,980
model so sorry

543
00:20:58,980 --> 00:21:02,460
but it's sort of trying to limit access

544
00:21:02,460 --> 00:21:04,380
between off the tiers so you shouldn't

545
00:21:04,380 --> 00:21:06,720
have tier zero accounts on dear one and

546
00:21:06,720 --> 00:21:09,360
all that so forth so basically on tier

547
00:21:09,360 --> 00:21:12,660
zero you should have your crown tools I

548
00:21:12,660 --> 00:21:15,120
didn't deserves domain controllers and

549
00:21:15,120 --> 00:21:18,360
management servers for those too uh on

550
00:21:18,360 --> 00:21:20,760
tier one production servers so for

551
00:21:20,760 --> 00:21:22,919
example email if you have exchange still

552
00:21:22,919 --> 00:21:25,919
move to Office 365 or you are

553
00:21:25,919 --> 00:21:28,140


554
00:21:28,140 --> 00:21:29,820
um yeah not really but yeah you know

555
00:21:29,820 --> 00:21:31,260
there's a lot of vulnerabilities around

556
00:21:31,260 --> 00:21:32,940
the exchange these days

557
00:21:32,940 --> 00:21:35,820
uh also file servers and on tier two you

558
00:21:35,820 --> 00:21:37,559
have your user accounts you have your

559
00:21:37,559 --> 00:21:39,360
laptops you have everything else that

560
00:21:39,360 --> 00:21:42,179
doesn't really fit to tr0 or tier one

561
00:21:42,179 --> 00:21:44,159
then let's

562
00:21:44,159 --> 00:21:47,760
local admin password solution if my

563
00:21:47,760 --> 00:21:49,559
memory serves me right

564
00:21:49,559 --> 00:21:52,440
so what this does is it's changed into

565
00:21:52,440 --> 00:21:55,380
local admin password on the devices it

566
00:21:55,380 --> 00:21:58,080
you can set it with Group Policy you can

567
00:21:58,080 --> 00:22:00,419
set complex passwords with it you can

568
00:22:00,419 --> 00:22:02,460
also set it so that it actually changed

569
00:22:02,460 --> 00:22:04,559
from time to time

570
00:22:04,559 --> 00:22:06,419
which is quite good

571
00:22:06,419 --> 00:22:07,860
also when you are monitoring it

572
00:22:07,860 --> 00:22:09,659
centrally you can see the actual

573
00:22:09,659 --> 00:22:12,299
password for particular admin account on

574
00:22:12,299 --> 00:22:15,059
active directory which is nice of course

575
00:22:15,059 --> 00:22:15,780
um

576
00:22:15,780 --> 00:22:18,600
if you were in Helsing I was talking of

577
00:22:18,600 --> 00:22:20,520
one incident then that that was actually

578
00:22:20,520 --> 00:22:23,039
one good good advocate for this in that

579
00:22:23,039 --> 00:22:25,100
particular incident actually local

580
00:22:25,100 --> 00:22:28,559
accounts were used to move laterally

581
00:22:28,559 --> 00:22:31,919
they had same password

582
00:22:31,919 --> 00:22:33,840
they had Labs but that was misconfigured

583
00:22:33,840 --> 00:22:35,640
but let's not go into the

584
00:22:35,640 --> 00:22:37,740
so Fireball is the second thing here or

585
00:22:37,740 --> 00:22:40,200
charity thing I guess at this stage

586
00:22:40,200 --> 00:22:43,080
I haven't seen this done anywhere so far

587
00:22:43,080 --> 00:22:44,940
but hey I don't really know how our

588
00:22:44,940 --> 00:22:46,740
customers for example are defended but

589
00:22:46,740 --> 00:22:48,900
let's not talk about that either so

590
00:22:48,900 --> 00:22:50,880
basically you most likely can block

591
00:22:50,880 --> 00:22:53,400
inbound access on workstation level or

592
00:22:53,400 --> 00:22:56,039
or server level for that matter only

593
00:22:56,039 --> 00:22:58,380
allow those inbound ports which are

594
00:22:58,380 --> 00:23:01,159
actually needed

595
00:23:01,919 --> 00:23:04,740
there are possibilities that you have

596
00:23:04,740 --> 00:23:06,840
some sort of a business application

597
00:23:06,840 --> 00:23:09,539
which needs to have inbound ports open

598
00:23:09,539 --> 00:23:12,179
on laptops or workstations but that's

599
00:23:12,179 --> 00:23:14,940
very rare these days

600
00:23:14,940 --> 00:23:17,880
then the malware prevention and this is

601
00:23:17,880 --> 00:23:20,340
again very boring so centrally managed

602
00:23:20,340 --> 00:23:23,760
antivirus solos and blah blah blah blah

603
00:23:23,760 --> 00:23:25,919
white listing is more interesting I

604
00:23:25,919 --> 00:23:26,700
guess

605
00:23:26,700 --> 00:23:27,900
so

606
00:23:27,900 --> 00:23:31,380
white listing is a solution where you

607
00:23:31,380 --> 00:23:33,600
are only allowing those applications

608
00:23:33,600 --> 00:23:36,000
which you need everything else is not

609
00:23:36,000 --> 00:23:40,080
allowed to run on the endpoint

610
00:23:40,080 --> 00:23:42,900
this can be very effective limiting

611
00:23:42,900 --> 00:23:44,760
power cell

612
00:23:44,760 --> 00:23:49,740
again this is a bit hard to do

613
00:23:49,740 --> 00:23:52,740
if you are going to block Powershell on

614
00:23:52,740 --> 00:23:55,500
your network from all the users you have

615
00:23:55,500 --> 00:23:57,539
those this admins who actually need to

616
00:23:57,539 --> 00:24:00,059
be able to manage some your devices

617
00:24:00,059 --> 00:24:02,640
somehow 24 minutes are up by the way my

618
00:24:02,640 --> 00:24:05,220
blog tells me that so they need to be

619
00:24:05,220 --> 00:24:07,919
able to actually admin those devices if

620
00:24:07,919 --> 00:24:09,720
you are going to block Powershell they

621
00:24:09,720 --> 00:24:11,580
might be using something stupid like PS

622
00:24:11,580 --> 00:24:14,280
access which leaves no locks behind oh

623
00:24:14,280 --> 00:24:17,039
no perfect so this is sort of a solution

624
00:24:17,039 --> 00:24:20,159
which needs a little bit planning

625
00:24:20,159 --> 00:24:24,179
and then attack surface reduction

626
00:24:24,179 --> 00:24:26,340
with attack service production but this

627
00:24:26,340 --> 00:24:28,679
is a Microsoft product or or capability

628
00:24:28,679 --> 00:24:30,600
in a product let's put it this way I'm

629
00:24:30,600 --> 00:24:32,340
sure there are others but what attack

630
00:24:32,340 --> 00:24:34,860
surface reduction does is it blocks

631
00:24:34,860 --> 00:24:37,380
malice's software Behavior so basically

632
00:24:37,380 --> 00:24:39,659
you can for example Block office

633
00:24:39,659 --> 00:24:41,940
applications from spawning other

634
00:24:41,940 --> 00:24:46,260
processes it can be very effective

635
00:24:46,260 --> 00:24:49,799
and then the last point the most

636
00:24:49,799 --> 00:24:52,500
important point of this presentation a

637
00:24:52,500 --> 00:24:53,940
slide which I actually added this

638
00:24:53,940 --> 00:24:56,120
morning

639
00:24:57,600 --> 00:25:01,459
this is the DFI our own call

640
00:25:02,520 --> 00:25:05,179
thank you

641
00:25:05,580 --> 00:25:08,740
[Applause]

