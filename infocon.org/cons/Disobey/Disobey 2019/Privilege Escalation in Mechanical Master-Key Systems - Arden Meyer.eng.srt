1
00:00:08,230 --> 00:00:23,640
[Music]

2
00:00:27,640 --> 00:00:40,070
hello everybody so thank you so I'm

3
00:00:38,030 --> 00:00:41,720
Arden Meyer I'm going to be talking to

4
00:00:40,070 --> 00:00:46,220
you today about privilege escalation and

5
00:00:41,720 --> 00:00:51,470
my master keyed mechanical systems so

6
00:00:46,220 --> 00:00:51,860
first off if this is going to work there

7
00:00:51,470 --> 00:00:53,989
we go

8
00:00:51,860 --> 00:00:55,129
so first off I am building on some other

9
00:00:53,989 --> 00:00:58,699
people's works I'd like to make sure

10
00:00:55,129 --> 00:01:01,040
that I give credit where it's due the

11
00:00:58,699 --> 00:01:04,610
chief of this comes from a paper that

12
00:01:01,040 --> 00:01:08,030
Matt blaze he's a professor wrote he

13
00:01:04,610 --> 00:01:12,530
published this paper 15 almost 16 years

14
00:01:08,030 --> 00:01:14,479
ago now and then also the lot of the

15
00:01:12,530 --> 00:01:19,700
slides the animations are courtesy of

16
00:01:14,479 --> 00:01:24,170
deviant next I was just not working

17
00:01:19,700 --> 00:01:26,090
there we go so Who am I this guy I am

18
00:01:24,170 --> 00:01:28,610
actually retired United States Air Force

19
00:01:26,090 --> 00:01:33,890
and then I'm currently a student at Iowa

20
00:01:28,610 --> 00:01:36,289
State University first we have a few

21
00:01:33,890 --> 00:01:37,340
rules in Loch sport and I always make

22
00:01:36,289 --> 00:01:39,640
sure that I throw these up when I'm

23
00:01:37,340 --> 00:01:42,409
teaching anybody about physical locks

24
00:01:39,640 --> 00:01:46,670
first do not pick locks that you do not

25
00:01:42,409 --> 00:01:49,909
own second do not pick blocks upon which

26
00:01:46,670 --> 00:01:52,520
you rely now for this presentation I've

27
00:01:49,909 --> 00:01:54,710
added a third rule just don't do this

28
00:01:52,520 --> 00:01:56,689
don't go back to your school your work

29
00:01:54,710 --> 00:02:00,199
your apartment and do this unless you

30
00:01:56,689 --> 00:02:02,148
have written permission I will not show

31
00:02:00,200 --> 00:02:05,060
up at court and testify

32
00:02:02,149 --> 00:02:07,039
I will not bail you out of jail this

33
00:02:05,060 --> 00:02:11,360
will be very expensive if you are caught

34
00:02:07,039 --> 00:02:12,319
doing this but now on to the fun so we

35
00:02:11,360 --> 00:02:17,330
all know what these are

36
00:02:12,319 --> 00:02:20,630
doorknobs padlocks dead bolts on the

37
00:02:17,330 --> 00:02:25,970
inside the mechanism is all the same we

38
00:02:20,630 --> 00:02:27,530
have our standard pins and this is what

39
00:02:25,970 --> 00:02:32,569
the stacks look like alongside one

40
00:02:27,530 --> 00:02:33,950
another these are normal locks what I'm

41
00:02:32,569 --> 00:02:36,290
talking to you today are gonna be about

42
00:02:33,950 --> 00:02:38,149
master keyed systems now where do we

43
00:02:36,290 --> 00:02:40,049
find master keyed systems

44
00:02:38,150 --> 00:02:43,620
we'll find them in

45
00:02:40,050 --> 00:02:47,720
high rises complexes will find them more

46
00:02:43,620 --> 00:02:51,120
commonly on universities in dormitories

47
00:02:47,720 --> 00:02:53,910
this is what a master keyed lock would

48
00:02:51,120 --> 00:02:55,970
look like so in addition to the key pin

49
00:02:53,910 --> 00:02:59,250
which is the red pins on the bottom and

50
00:02:55,970 --> 00:03:01,260
the driver pins the blue pins on top we

51
00:02:59,250 --> 00:03:04,830
also have these master pins in the

52
00:03:01,260 --> 00:03:08,070
middle that's what allows our master

53
00:03:04,830 --> 00:03:11,670
keys to function so what we don't know

54
00:03:08,070 --> 00:03:13,560
is if we're a user and we have a lock

55
00:03:11,670 --> 00:03:15,630
that looks like this remember which way

56
00:03:13,560 --> 00:03:18,210
my slides are we have a lock that looks

57
00:03:15,630 --> 00:03:22,500
like this we don't know whether that

58
00:03:18,210 --> 00:03:24,540
eight is truly an eight or if it's a six

59
00:03:22,500 --> 00:03:28,020
and two like we see in the middle in

60
00:03:24,540 --> 00:03:31,850
which case another key with the six

61
00:03:28,020 --> 00:03:34,110
would be able to operate that lock so

62
00:03:31,850 --> 00:03:39,299
we're gonna go through a little story

63
00:03:34,110 --> 00:03:41,880
this is fictional just an example I'm

64
00:03:39,300 --> 00:03:43,770
getting ahead of myself a little bit no

65
00:03:41,880 --> 00:03:45,060
this is this is correct so we have a

66
00:03:43,770 --> 00:03:48,739
little story here

67
00:03:45,060 --> 00:03:52,320
four we have Alice this is Alice's key

68
00:03:48,739 --> 00:03:54,300
we have Bob Bob works in a different

69
00:03:52,320 --> 00:03:57,870
Department so let's say Bob is a

70
00:03:54,300 --> 00:04:00,959
biologist Alice and Andy are both

71
00:03:57,870 --> 00:04:03,540
engineers these are their keys then we

72
00:04:00,959 --> 00:04:06,060
also have a maintenance guy our

73
00:04:03,540 --> 00:04:08,040
maintenance person he works for

74
00:04:06,060 --> 00:04:10,350
engineering so he needs to be able to

75
00:04:08,040 --> 00:04:12,600
open anybody's doors in engineering but

76
00:04:10,350 --> 00:04:15,120
he shouldn't be able to access Bob who

77
00:04:12,600 --> 00:04:19,858
works in biology now what are their keys

78
00:04:15,120 --> 00:04:23,340
pinned at this would be an example of

79
00:04:19,858 --> 00:04:26,460
their keys so Alice's key is a three six

80
00:04:23,340 --> 00:04:28,280
two three five these are the bidding

81
00:04:26,460 --> 00:04:31,820
depths read from the shoulder of the key

82
00:04:28,280 --> 00:04:35,510
Andy has a three five two three three

83
00:04:31,820 --> 00:04:38,580
Bob is a four seven three three four and

84
00:04:35,510 --> 00:04:41,430
our maintenance guy his key is a three

85
00:04:38,580 --> 00:04:44,760
four two three one everybody's got those

86
00:04:41,430 --> 00:04:46,530
numbers right okay this is crowd

87
00:04:44,760 --> 00:04:47,849
interaction audience interaction so

88
00:04:46,530 --> 00:04:49,830
these are what the keys would look like

89
00:04:47,850 --> 00:04:51,600
or the the locks M sorry these this is

90
00:04:49,830 --> 00:04:53,700
what the locks would look like so in the

91
00:04:51,600 --> 00:04:57,480
upper left hand corner we have Alice

92
00:04:53,700 --> 00:05:01,950
lock as you can see Alice's lock will

93
00:04:57,480 --> 00:05:06,570
accept either or I'm sorry her pinnings

94
00:05:01,950 --> 00:05:09,690
are a three key pin and a three master

95
00:05:06,570 --> 00:05:12,420
pin followed by a four key pin and a to

96
00:05:09,690 --> 00:05:14,520
master pin and so on through all of

97
00:05:12,420 --> 00:05:16,230
through the rest of her lock in the

98
00:05:14,520 --> 00:05:21,030
upper right hand corner we can see the

99
00:05:16,230 --> 00:05:21,660
example for andis lock the bottom left

100
00:05:21,030 --> 00:05:24,869
we can see

101
00:05:21,660 --> 00:05:26,490
Bob's lock now the janitor doesn't have

102
00:05:24,870 --> 00:05:27,900
his own lock I'm sorry the janitor the

103
00:05:26,490 --> 00:05:30,270
maintenance guy does not have his own

104
00:05:27,900 --> 00:05:34,620
lock because he can operate everybody in

105
00:05:30,270 --> 00:05:36,930
engineering so here's what would happen

106
00:05:34,620 --> 00:05:39,960
if Alice tries opening all of these

107
00:05:36,930 --> 00:05:41,730
locks with her own key the up in the

108
00:05:39,960 --> 00:05:44,159
upper left-hand corner that's her own

109
00:05:41,730 --> 00:05:46,710
door it will work there we know what we

110
00:05:44,160 --> 00:05:50,370
expect in the upper right-hand corner

111
00:05:46,710 --> 00:05:55,080
that is Andy's lock as you can see the

112
00:05:50,370 --> 00:05:57,900
second and fifth pin those won't work

113
00:05:55,080 --> 00:06:02,609
and then if Alice tries opening Bob's

114
00:05:57,900 --> 00:06:05,400
door the lower left you can see three of

115
00:06:02,610 --> 00:06:07,200
the four or four of the five pins she

116
00:06:05,400 --> 00:06:11,280
won't be able to open up so this is

117
00:06:07,200 --> 00:06:12,979
Alice's key here's what happens if Andy

118
00:06:11,280 --> 00:06:15,869
tries opening all the locks

119
00:06:12,980 --> 00:06:19,830
Andy's key does not work on Alice's lock

120
00:06:15,870 --> 00:06:24,150
it does work on his own it will not work

121
00:06:19,830 --> 00:06:28,560
on Bob's lock and finally here's Bob's

122
00:06:24,150 --> 00:06:31,890
key if Bob tries to open Alice's lock it

123
00:06:28,560 --> 00:06:34,500
doesn't work if he tries opening Andy's

124
00:06:31,890 --> 00:06:37,680
lock it doesn't work but it does work on

125
00:06:34,500 --> 00:06:41,180
his own now our favorite person

126
00:06:37,680 --> 00:06:43,410
maintenance the maintenance guy can open

127
00:06:41,180 --> 00:06:46,770
Alice's lock up in the upper left-hand

128
00:06:43,410 --> 00:06:49,080
corner he can open Andy's lock in the

129
00:06:46,770 --> 00:06:51,150
upper right-hand corner but Bob's

130
00:06:49,080 --> 00:06:53,760
building is on a different master keyed

131
00:06:51,150 --> 00:06:56,070
system as we can see the first or

132
00:06:53,760 --> 00:07:00,719
hopefully we can see the first and third

133
00:06:56,070 --> 00:07:04,510
pins still bind so our maintenance guy

134
00:07:00,720 --> 00:07:09,190
will not be able to open Bob's door

135
00:07:04,510 --> 00:07:13,460
again works in a different building so

136
00:07:09,190 --> 00:07:17,330
let's consider Alice's key so for a lock

137
00:07:13,460 --> 00:07:20,359
that she can access we know our change

138
00:07:17,330 --> 00:07:23,330
key bidding depths at three six two

139
00:07:20,360 --> 00:07:28,760
three five so obviously this is going to

140
00:07:23,330 --> 00:07:31,219
work in her lock and it opens that's

141
00:07:28,760 --> 00:07:34,610
what we expect but what can we infer

142
00:07:31,220 --> 00:07:39,139
what do we know about the inside of that

143
00:07:34,610 --> 00:07:43,190
lock well we know that the shear line

144
00:07:39,139 --> 00:07:45,919
between pins at each point inside of

145
00:07:43,190 --> 00:07:49,820
that lock line up with the plug so that

146
00:07:45,919 --> 00:07:52,010
it'll rotate now that could be a solid

147
00:07:49,820 --> 00:07:57,500
set of pins just like you would have on

148
00:07:52,010 --> 00:08:00,289
your home door but we don't know and we

149
00:07:57,500 --> 00:08:02,690
really want to figure this out all of

150
00:08:00,289 --> 00:08:04,490
those unknowns are hidden inside of that

151
00:08:02,690 --> 00:08:12,110
plug we cannot examine them with our

152
00:08:04,490 --> 00:08:15,320
eyes so what do we do well first step we

153
00:08:12,110 --> 00:08:18,050
want to but we call an exploratory key

154
00:08:15,320 --> 00:08:21,620
our first key so we're going to take

155
00:08:18,050 --> 00:08:22,820
that key looks like this and at that

156
00:08:21,620 --> 00:08:24,800
first shoulder

157
00:08:22,820 --> 00:08:27,919
the first bidding position we're going

158
00:08:24,800 --> 00:08:31,550
to leave it at a depth of zero we're not

159
00:08:27,919 --> 00:08:34,039
going to cut into it at all and then the

160
00:08:31,550 --> 00:08:36,140
remaining bidding depths we're going to

161
00:08:34,039 --> 00:08:38,630
use from our known change key the key

162
00:08:36,140 --> 00:08:43,218
that we were issued by the school to

163
00:08:38,630 --> 00:08:46,880
open our door now we're then going to

164
00:08:43,219 --> 00:08:51,230
sweep through this range and try every

165
00:08:46,880 --> 00:08:54,350
single bidding depth okay now one word

166
00:08:51,230 --> 00:08:58,870
of caution we have to be careful of max

167
00:08:54,350 --> 00:09:02,029
the maximum adjacent cut specification

168
00:08:58,870 --> 00:09:04,580
now this varies for each key weigh

169
00:09:02,029 --> 00:09:07,189
system in the example that we have up

170
00:09:04,580 --> 00:09:11,390
here my example slides are using the kw7

171
00:09:07,190 --> 00:09:13,940
on the kw7 the max is a four so if your

172
00:09:11,390 --> 00:09:16,310
adjacent pins are more than four bit

173
00:09:13,940 --> 00:09:17,690
depths apart the manufacturer does not

174
00:09:16,310 --> 00:09:18,109
recommend that because you can end up

175
00:09:17,690 --> 00:09:20,690
buying

176
00:09:18,110 --> 00:09:22,910
pins and getting a key stuck inside that

177
00:09:20,690 --> 00:09:27,350
lock so in this theoretical example

178
00:09:22,910 --> 00:09:31,310
right now we have a max violation but

179
00:09:27,350 --> 00:09:32,870
we'll file down one bit so position one

180
00:09:31,310 --> 00:09:36,530
in the kw7

181
00:09:32,870 --> 00:09:41,470
is the first valid position now how do

182
00:09:36,530 --> 00:09:41,470
we know what that is well we can take a

183
00:09:41,920 --> 00:09:46,849
easy tool like this that shows us our

184
00:09:44,480 --> 00:09:48,830
bit depth or if you don't have this

185
00:09:46,850 --> 00:09:51,230
available you can just read the

186
00:09:48,830 --> 00:09:52,940
specifications they they are available

187
00:09:51,230 --> 00:09:55,760
they have to be available from the

188
00:09:52,940 --> 00:09:57,980
manufacturer for locksmiths to use and

189
00:09:55,760 --> 00:10:00,590
just use a set of calipers and measure

190
00:09:57,980 --> 00:10:03,110
but a tool like this makes it that

191
00:10:00,590 --> 00:10:05,840
little card makes it much easier so

192
00:10:03,110 --> 00:10:09,470
again we're going to file down one bit

193
00:10:05,840 --> 00:10:12,290
so we are now at the first pin we have

194
00:10:09,470 --> 00:10:14,960
it at bit depth one technically this is

195
00:10:12,290 --> 00:10:18,219
still a max violation but let's try that

196
00:10:14,960 --> 00:10:22,310
key anyway so we put it inside the lock

197
00:10:18,220 --> 00:10:25,940
but the lock does not open so we pull

198
00:10:22,310 --> 00:10:28,489
the key out we'll file down a little bit

199
00:10:25,940 --> 00:10:31,160
more and we now have our first bidding

200
00:10:28,490 --> 00:10:34,580
depth or our first pin at the second

201
00:10:31,160 --> 00:10:37,670
bidding depth so we notice that the

202
00:10:34,580 --> 00:10:39,920
first and the third bidding first in the

203
00:10:37,670 --> 00:10:40,579
third pins are both at the second

204
00:10:39,920 --> 00:10:42,170
bidding depth

205
00:10:40,580 --> 00:10:44,900
however they look a little bit different

206
00:10:42,170 --> 00:10:47,890
that's because we the third pin we cut

207
00:10:44,900 --> 00:10:50,990
properly and we're manually filing our

208
00:10:47,890 --> 00:10:52,750
first position but they're still the

209
00:10:50,990 --> 00:10:56,150
same position on the inside of the lock

210
00:10:52,750 --> 00:10:58,960
now here we're not mad or not violating

211
00:10:56,150 --> 00:11:02,949
max anymore because we are at a

212
00:10:58,960 --> 00:11:06,860
difference of four so let's try that key

213
00:11:02,950 --> 00:11:11,090
put it in darn the lock still does not

214
00:11:06,860 --> 00:11:14,360
open so we pull out the key we'll file

215
00:11:11,090 --> 00:11:20,570
some more we'll get down to bidding

216
00:11:14,360 --> 00:11:21,910
depth three try it again and we're open

217
00:11:20,570 --> 00:11:26,510
yay

218
00:11:21,910 --> 00:11:29,350
but that was kind of expected right does

219
00:11:26,510 --> 00:11:29,350
anybody remember why

220
00:11:29,390 --> 00:11:36,130
our original change key this is we've

221
00:11:33,140 --> 00:11:40,220
just remade the key that we were issued

222
00:11:36,130 --> 00:11:45,680
so let's what we've learned here though

223
00:11:40,220 --> 00:11:51,920
is we know now that the the lower

224
00:11:45,680 --> 00:11:53,089
portion the key pin is solid so we still

225
00:11:51,920 --> 00:11:56,719
don't know anything about these chambers

226
00:11:53,089 --> 00:12:02,899
yet but we do know that the key pin in

227
00:11:56,720 --> 00:12:05,089
the first position is solid of course we

228
00:12:02,899 --> 00:12:09,800
could still have some mastering up above

229
00:12:05,089 --> 00:12:12,589
it so we want to continue so we'll take

230
00:12:09,800 --> 00:12:14,329
the key we'll file it down some more we

231
00:12:12,589 --> 00:12:17,360
don't have that first bit the first pin

232
00:12:14,329 --> 00:12:20,689
at a bit depth of four we'll try that

233
00:12:17,360 --> 00:12:23,510
key we're gonna find out that key

234
00:12:20,690 --> 00:12:29,649
doesn't work we're going to remove that

235
00:12:23,510 --> 00:12:29,649
key file it down some more try it again

236
00:12:30,250 --> 00:12:35,810
still doesn't work seeing some

237
00:12:34,399 --> 00:12:39,019
repetition here we're going to remove

238
00:12:35,810 --> 00:12:43,250
the key take it down to level six try it

239
00:12:39,019 --> 00:12:47,110
in the key oh we've just learned

240
00:12:43,250 --> 00:12:50,589
something the key opens at this level

241
00:12:47,110 --> 00:12:50,589
what have we learned

242
00:12:50,680 --> 00:12:59,540
so all drivers have to be at the right

243
00:12:54,110 --> 00:13:01,640
depth now so given this we know got to

244
00:12:59,540 --> 00:13:04,310
point to the correct side we know that

245
00:13:01,640 --> 00:13:07,790
on the inside of this first pin we have

246
00:13:04,310 --> 00:13:11,410
our key pin or the first position our

247
00:13:07,790 --> 00:13:15,709
key pin is a three and we have a three

248
00:13:11,410 --> 00:13:18,589
master pin as well now we still don't

249
00:13:15,709 --> 00:13:22,040
necessarily know beyond that so in the

250
00:13:18,589 --> 00:13:25,190
kw7 valid positions are 1 through 7 but

251
00:13:22,040 --> 00:13:27,500
we're going to assume for now that the

252
00:13:25,190 --> 00:13:28,760
we only have one mastering pin and we

253
00:13:27,500 --> 00:13:33,199
still don't know anything about those

254
00:13:28,760 --> 00:13:35,899
other four pins so this is what we know

255
00:13:33,199 --> 00:13:39,560
about the key pin we know that master

256
00:13:35,899 --> 00:13:41,460
pin again there's a chance of more shear

257
00:13:39,560 --> 00:13:44,859
line

258
00:13:41,460 --> 00:13:46,900
but in in in reality I wouldn't try this

259
00:13:44,860 --> 00:13:48,400
but for my demo we're going to go ahead

260
00:13:46,900 --> 00:13:50,620
and we're going to remove it we're gonna

261
00:13:48,400 --> 00:13:54,010
file down one more and we'll try that

262
00:13:50,620 --> 00:13:58,900
we'll try that key but it's not going to

263
00:13:54,010 --> 00:14:01,510
work so we can continue the rest of the

264
00:13:58,900 --> 00:14:02,439
bidding range if there was more on the

265
00:14:01,510 --> 00:14:04,689
kw7

266
00:14:02,440 --> 00:14:10,330
again valid positions are one through

267
00:14:04,690 --> 00:14:14,260
seven so quick set depths don't go

268
00:14:10,330 --> 00:14:16,990
beyond seven so now we're going to

269
00:14:14,260 --> 00:14:18,270
prepare another key for the second

270
00:14:16,990 --> 00:14:21,670
position

271
00:14:18,270 --> 00:14:24,370
so first we're going to put the first

272
00:14:21,670 --> 00:14:27,849
put the first pin at our newly

273
00:14:24,370 --> 00:14:29,890
discovered master pin depth then our

274
00:14:27,850 --> 00:14:34,720
second position we're going to leave

275
00:14:29,890 --> 00:14:36,850
that at a zero cut and our third fourth

276
00:14:34,720 --> 00:14:39,610
and fifth pins we're going to use our

277
00:14:36,850 --> 00:14:46,450
known key chain are known change key

278
00:14:39,610 --> 00:14:48,900
values so the zero depth is never used

279
00:14:46,450 --> 00:14:52,870
in a real system now if you're

280
00:14:48,900 --> 00:14:54,819
encountering this in a competition say

281
00:14:52,870 --> 00:14:57,370
upstairs in the lockpick village or the

282
00:14:54,820 --> 00:14:59,830
CTF maybe you want to actually be

283
00:14:57,370 --> 00:15:02,110
careful there because I can manually pin

284
00:14:59,830 --> 00:15:04,030
a lock that will work this way but it's

285
00:15:02,110 --> 00:15:06,480
not technically valid so we don't need

286
00:15:04,030 --> 00:15:09,160
to worry about that in a real scenario

287
00:15:06,480 --> 00:15:11,580
so to save time we're gonna just go

288
00:15:09,160 --> 00:15:16,060
ahead and go right down to the one depth

289
00:15:11,580 --> 00:15:20,890
again max is being violated here but

290
00:15:16,060 --> 00:15:24,250
let's try it anyway no the lock does not

291
00:15:20,890 --> 00:15:27,730
open we'll remove the key we'll file

292
00:15:24,250 --> 00:15:31,780
down two bit bit depth number two Max is

293
00:15:27,730 --> 00:15:35,580
now okay so let's try this again put it

294
00:15:31,780 --> 00:15:38,589
in the lock lock still does not open

295
00:15:35,580 --> 00:15:41,260
okay so we remove that key again we're

296
00:15:38,590 --> 00:15:45,490
gonna file down again now we're down at

297
00:15:41,260 --> 00:15:47,439
bit depth three try it in the key try

298
00:15:45,490 --> 00:15:53,380
the key in the lock but it still does

299
00:15:47,440 --> 00:15:54,400
not open remove the key again now we're

300
00:15:53,380 --> 00:15:58,660
down to bit depth

301
00:15:54,400 --> 00:16:02,370
or we're gonna try the key huzzah it

302
00:15:58,660 --> 00:16:02,370
opens what have we learned

303
00:16:02,640 --> 00:16:08,740
okay again we know that all the drivers

304
00:16:06,370 --> 00:16:13,750
must be at the shear line for the plug

305
00:16:08,740 --> 00:16:21,970
and on the inside we now know that we

306
00:16:13,750 --> 00:16:24,160
have a four key pin and we know the we

307
00:16:21,970 --> 00:16:26,830
also have a master pin in here does

308
00:16:24,160 --> 00:16:31,810
anybody know why we already know that we

309
00:16:26,830 --> 00:16:37,210
have a master pin just shout it I can

310
00:16:31,810 --> 00:16:39,250
kind of see a hand so we already know

311
00:16:37,210 --> 00:16:43,780
our change key our original change key

312
00:16:39,250 --> 00:16:46,330
so we've learned this earlier we don't

313
00:16:43,780 --> 00:16:49,410
know about the other three pins but

314
00:16:46,330 --> 00:16:53,830
we're currently working on a second pin

315
00:16:49,410 --> 00:16:56,410
so now we're done here essentially on

316
00:16:53,830 --> 00:17:00,490
that second pin so one of the things

317
00:16:56,410 --> 00:17:03,689
with your locks with with master keying

318
00:17:00,490 --> 00:17:06,730
systems we never have a one bit depth

319
00:17:03,690 --> 00:17:08,890
master pin they're just there they're

320
00:17:06,730 --> 00:17:11,079
too thin they get in the way they tend

321
00:17:08,890 --> 00:17:13,839
to bind and fold and they cause us too

322
00:17:11,079 --> 00:17:16,929
much troubles so knowing that we're

323
00:17:13,839 --> 00:17:20,020
essentially done here so we know there's

324
00:17:16,930 --> 00:17:25,660
a shear line here because of our change

325
00:17:20,020 --> 00:17:28,510
key now if we wanted to we could go

326
00:17:25,660 --> 00:17:30,940
ahead and file that just to check it but

327
00:17:28,510 --> 00:17:34,510
we're essentially we're done on position

328
00:17:30,940 --> 00:17:36,640
two because we've found the four we know

329
00:17:34,510 --> 00:17:38,350
there won't be a five we know that

330
00:17:36,640 --> 00:17:40,090
there's a six from our change key and

331
00:17:38,350 --> 00:17:43,149
again we also know that there won't be a

332
00:17:40,090 --> 00:17:47,429
seven back to the fact that master pins

333
00:17:43,150 --> 00:17:47,430
are never one bit depth deep

334
00:17:49,140 --> 00:17:58,679
so again single mass single depths

335
00:17:51,630 --> 00:18:01,620
mastering pins are rare and bad so if we

336
00:17:58,679 --> 00:18:03,600
wanted we could take our key and file it

337
00:18:01,620 --> 00:18:06,270
down to the number six as I said and try

338
00:18:03,600 --> 00:18:08,280
it just to make sure that our card is

339
00:18:06,270 --> 00:18:12,780
good or we are reading the right

340
00:18:08,280 --> 00:18:18,149
specification it's going to work we know

341
00:18:12,780 --> 00:18:20,010
what that bit depth was so further

342
00:18:18,150 --> 00:18:22,919
exploring here not really necessary we

343
00:18:20,010 --> 00:18:25,580
can take note of where we were at again

344
00:18:22,919 --> 00:18:28,679
a bit depth of seven would not be

345
00:18:25,580 --> 00:18:30,750
recommended because we have a valid bit

346
00:18:28,679 --> 00:18:37,230
depth of six and we don't want a single

347
00:18:30,750 --> 00:18:39,090
bit depth thick pin so we know the

348
00:18:37,230 --> 00:18:41,940
quick-set locks don't go past seven so

349
00:18:39,090 --> 00:18:45,600
now we have resolved the first two pins

350
00:18:41,940 --> 00:18:47,280
we have three chambers left to go so now

351
00:18:45,600 --> 00:18:51,809
we're going to step on and prepare our

352
00:18:47,280 --> 00:18:58,320
third exploratory key what depth do we

353
00:18:51,809 --> 00:19:03,480
put here at position number one what we

354
00:18:58,320 --> 00:19:09,030
found at the master so six is this a

355
00:19:03,480 --> 00:19:10,919
valid key by the way no this would not

356
00:19:09,030 --> 00:19:14,450
be a valid key this would be a max

357
00:19:10,919 --> 00:19:16,860
violation we're going from six to zero

358
00:19:14,450 --> 00:19:20,120
so what do we put what cut do we do

359
00:19:16,860 --> 00:19:20,120
position two at

360
00:19:22,730 --> 00:19:29,480
for I have one person playing along in

361
00:19:26,810 --> 00:19:31,520
the crowd okay so four is what we

362
00:19:29,480 --> 00:19:33,140
learned that's what that's the mastering

363
00:19:31,520 --> 00:19:35,300
key because it didn't or the mastering

364
00:19:33,140 --> 00:19:38,150
depth that didn't match our change key

365
00:19:35,300 --> 00:19:44,659
but it still worked on the lock so what

366
00:19:38,150 --> 00:19:46,010
do we put at position number three well

367
00:19:44,660 --> 00:19:47,630
we're gonna start at zero for now

368
00:19:46,010 --> 00:19:48,920
because this is the we're now moving on

369
00:19:47,630 --> 00:19:50,900
to that third pin and we're going to

370
00:19:48,920 --> 00:19:54,710
sweep through that and for the remaining

371
00:19:50,900 --> 00:19:57,860
parts of the key did anybody remember

372
00:19:54,710 --> 00:20:01,670
what those bit depths were from the

373
00:19:57,860 --> 00:20:07,820
change key we have three and five so

374
00:20:01,670 --> 00:20:10,400
let's explore or is it is it time to

375
00:20:07,820 --> 00:20:13,399
explore what do we know about that

376
00:20:10,400 --> 00:20:15,170
change from our change key does anybody

377
00:20:13,400 --> 00:20:21,110
remember what the change keys third bit

378
00:20:15,170 --> 00:20:25,790
depth was so our change key had a bit

379
00:20:21,110 --> 00:20:30,639
depth of two so knowing that what can we

380
00:20:25,790 --> 00:20:30,639
infer about bit depths one and three

381
00:20:31,840 --> 00:20:35,600
remember we know we're not they're not

382
00:20:34,040 --> 00:20:38,750
going to be valid because we're not

383
00:20:35,600 --> 00:20:44,030
going to use a one bit depth thick

384
00:20:38,750 --> 00:20:49,130
master pin so zero is not valid two was

385
00:20:44,030 --> 00:20:51,020
our change key one and three are not

386
00:20:49,130 --> 00:20:54,380
going to be there because we don't use

387
00:20:51,020 --> 00:20:59,990
one bit depth thick master pins so

388
00:20:54,380 --> 00:21:03,500
honestly - we already knew so honestly

389
00:20:59,990 --> 00:21:06,740
we can just start at position 4 at depth

390
00:21:03,500 --> 00:21:09,950
four and this is how we can rapidly go

391
00:21:06,740 --> 00:21:12,050
through all of the possibilities so

392
00:21:09,950 --> 00:21:15,440
we're gonna start at four just to be

393
00:21:12,050 --> 00:21:17,090
more efficient okay so our key number

394
00:21:15,440 --> 00:21:19,580
three our exploratory nope key number

395
00:21:17,090 --> 00:21:22,159
three is prepared we're going to put it

396
00:21:19,580 --> 00:21:24,649
in the lock and try it but in this

397
00:21:22,160 --> 00:21:28,160
scenario it doesn't work we remove the

398
00:21:24,650 --> 00:21:33,340
key we file down some more we give it a

399
00:21:28,160 --> 00:21:36,110
try huzzah our key has now opened lock

400
00:21:33,340 --> 00:21:39,980
so this is going to tell us an awful lot

401
00:21:36,110 --> 00:21:42,139
about this key or about this lock so

402
00:21:39,980 --> 00:21:46,700
what do we know at this point on the

403
00:21:42,140 --> 00:21:47,950
slock we have some valid positions this

404
00:21:46,700 --> 00:21:51,020
is where we're at right now

405
00:21:47,950 --> 00:21:53,720
here's what this look what we know the

406
00:21:51,020 --> 00:21:59,300
inside of that lock looks like so far on

407
00:21:53,720 --> 00:22:01,190
the first three positions so we don't

408
00:21:59,300 --> 00:22:02,690
have any news yet on those last two or

409
00:22:01,190 --> 00:22:05,270
so we haven't gotten there yet but

410
00:22:02,690 --> 00:22:07,600
otherwise position three seems to be

411
00:22:05,270 --> 00:22:11,780
we've got it resolved

412
00:22:07,600 --> 00:22:14,080
do we need to check depth number six

413
00:22:11,780 --> 00:22:14,080
okay

414
00:22:15,140 --> 00:22:21,620
I wouldn't now again if this were a

415
00:22:18,710 --> 00:22:23,780
challenge lock maybe somebody's being

416
00:22:21,620 --> 00:22:26,120
wicked and evil and they could put a

417
00:22:23,780 --> 00:22:28,160
single depth mastering pin in there but

418
00:22:26,120 --> 00:22:29,870
that's very unlikely again in your in

419
00:22:28,160 --> 00:22:33,410
the real world as well professional

420
00:22:29,870 --> 00:22:36,409
locksmiths just will not do this so what

421
00:22:33,410 --> 00:22:42,590
about depth number seven do we need to

422
00:22:36,410 --> 00:22:44,870
test that so it's possible to have

423
00:22:42,590 --> 00:22:47,090
multiple master keys systems in there

424
00:22:44,870 --> 00:22:50,000
multiple mastering pins it within the

425
00:22:47,090 --> 00:22:52,370
same chamber I would personally skip

426
00:22:50,000 --> 00:22:54,290
this at this point and just take a note

427
00:22:52,370 --> 00:22:56,360
that I stopped and that I did not test

428
00:22:54,290 --> 00:22:58,149
it if I have problems in the future I

429
00:22:56,360 --> 00:23:01,850
can then come back and test at this

430
00:22:58,150 --> 00:23:04,460
particular chamber so let's just move

431
00:23:01,850 --> 00:23:08,090
along and we're going to prepare our

432
00:23:04,460 --> 00:23:10,190
fourth exploratory key so we're gonna

433
00:23:08,090 --> 00:23:11,629
start out with the mastering pins the

434
00:23:10,190 --> 00:23:14,030
mastering depths that we've already

435
00:23:11,630 --> 00:23:16,750
discovered so we're gonna put our first

436
00:23:14,030 --> 00:23:18,860
three chambers at six four and three

437
00:23:16,750 --> 00:23:23,900
we're gonna leave that fourth position

438
00:23:18,860 --> 00:23:26,540
blank at zero and the last the fifth pin

439
00:23:23,900 --> 00:23:29,510
we use our change key violet or our

440
00:23:26,540 --> 00:23:33,710
change key position which is a mastering

441
00:23:29,510 --> 00:23:36,020
or is a bit depth of five so again keep

442
00:23:33,710 --> 00:23:40,550
in mind we do have this max violation

443
00:23:36,020 --> 00:23:45,260
right now but here's our range to sweep

444
00:23:40,550 --> 00:23:46,280
and remember our change key bidding

445
00:23:45,260 --> 00:23:50,390
depth

446
00:23:46,280 --> 00:23:54,740
was a three so to be efficient we really

447
00:23:50,390 --> 00:23:58,670
only need to test positions one five six

448
00:23:54,740 --> 00:24:03,350
and seven at most because we know that

449
00:23:58,670 --> 00:24:06,080
three was our master or was our change

450
00:24:03,350 --> 00:24:07,850
key and we know that we will not have a

451
00:24:06,080 --> 00:24:11,480
two or a four if this were a

452
00:24:07,850 --> 00:24:14,959
professional door so we can either code

453
00:24:11,480 --> 00:24:17,510
cut or file our fourth position to the

454
00:24:14,960 --> 00:24:21,410
number one bit depth and we'll give that

455
00:24:17,510 --> 00:24:26,330
a try in the lock well that didn't work

456
00:24:21,410 --> 00:24:28,340
so we removed the key now we could file

457
00:24:26,330 --> 00:24:30,530
down to depth number three from our

458
00:24:28,340 --> 00:24:32,510
change key and test it just to make sure

459
00:24:30,530 --> 00:24:34,550
that we are reading the write

460
00:24:32,510 --> 00:24:37,280
specifications again and we could give

461
00:24:34,550 --> 00:24:38,500
that a try it's going to work we know

462
00:24:37,280 --> 00:24:41,990
it's going to work

463
00:24:38,500 --> 00:24:46,280
that was our change keys depth so we'll

464
00:24:41,990 --> 00:24:49,130
remove that key we're going to skip four

465
00:24:46,280 --> 00:24:52,790
and go straight down to five and we're

466
00:24:49,130 --> 00:24:56,300
gonna give that a try in the lock well

467
00:24:52,790 --> 00:24:59,330
darn that didn't work so we removed the

468
00:24:56,300 --> 00:25:02,270
key we're gonna file it down again at

469
00:24:59,330 --> 00:25:03,050
bit depth six throw it in the lock give

470
00:25:02,270 --> 00:25:06,530
it a try

471
00:25:03,050 --> 00:25:10,399
no joy we still haven't found the

472
00:25:06,530 --> 00:25:11,720
mastering pin depth so what's left well

473
00:25:10,400 --> 00:25:16,040
we're gonna remove it we're gonna try

474
00:25:11,720 --> 00:25:18,910
the last possible depth seven we throw

475
00:25:16,040 --> 00:25:24,470
that in the key does it open the lock

476
00:25:18,910 --> 00:25:26,720
nope it doesn't open the lock what the

477
00:25:24,470 --> 00:25:29,870
hell I mean this is a master in key

478
00:25:26,720 --> 00:25:34,610
system we know that how could that be

479
00:25:29,870 --> 00:25:38,780
well not every single pin has to be

480
00:25:34,610 --> 00:25:43,520
master pinned in a master key system so

481
00:25:38,780 --> 00:25:45,200
this is what we know so far now sorry I

482
00:25:43,520 --> 00:25:47,270
threw in another sight so you could

483
00:25:45,200 --> 00:25:50,540
question yourself about that but again

484
00:25:47,270 --> 00:25:54,650
not every slide or not every pin has to

485
00:25:50,540 --> 00:25:58,639
be master pinned so in this case in this

486
00:25:54,650 --> 00:26:03,200
scenario our fourth pin is a standard

487
00:25:58,640 --> 00:26:06,260
pin it's not master keyed so this is

488
00:26:03,200 --> 00:26:09,110
what we know so far we have mastering

489
00:26:06,260 --> 00:26:11,600
pins in the first second and third

490
00:26:09,110 --> 00:26:13,790
chamber at depths six four and five and

491
00:26:11,600 --> 00:26:17,659
our fourth chamber we only have the one

492
00:26:13,790 --> 00:26:19,610
pin at depth three so let's go ahead and

493
00:26:17,660 --> 00:26:23,840
prepare that fifth and what should be

494
00:26:19,610 --> 00:26:26,899
last exploratory key so we're going to

495
00:26:23,840 --> 00:26:28,959
code cut to what we already know so we

496
00:26:26,900 --> 00:26:31,100
have a six a four a five and a three

497
00:26:28,960 --> 00:26:34,270
we're gonna leave that last position

498
00:26:31,100 --> 00:26:37,969
blank so that we can explore through it

499
00:26:34,270 --> 00:26:39,950
now we could code code cut it to a depth

500
00:26:37,970 --> 00:26:42,230
of one or we could just file it to one

501
00:26:39,950 --> 00:26:46,760
and we're gonna give that a try in our

502
00:26:42,230 --> 00:26:50,990
lock right off the bat it opens that's

503
00:26:46,760 --> 00:26:53,179
awesome huzzah

504
00:26:50,990 --> 00:26:56,360
we've right off the bat we found a

505
00:26:53,179 --> 00:26:59,780
mastering pin so this is what we know

506
00:26:56,360 --> 00:27:03,520
about the lock at this point we have

507
00:26:59,780 --> 00:27:06,950
found the mastering pin we're probably

508
00:27:03,520 --> 00:27:10,100
fully decoded at this point now we don't

509
00:27:06,950 --> 00:27:12,830
know we'd never did check the seventh

510
00:27:10,100 --> 00:27:15,260
position on the third pin and there are

511
00:27:12,830 --> 00:27:17,720
some potentially valid positions still

512
00:27:15,260 --> 00:27:20,629
left in the fifth pin that we could test

513
00:27:17,720 --> 00:27:24,980
but now we have found mastering pins in

514
00:27:20,630 --> 00:27:27,620
four of the chambers and we swept the

515
00:27:24,980 --> 00:27:31,340
entire range on the fourth on the the

516
00:27:27,620 --> 00:27:34,189
other chamber so while there could be

517
00:27:31,340 --> 00:27:36,709
some additional cuts in here there could

518
00:27:34,190 --> 00:27:40,309
even be more cuts up on top up on the

519
00:27:36,710 --> 00:27:43,340
the driver pin honestly though for me I

520
00:27:40,309 --> 00:27:48,379
would take this key and start checking

521
00:27:43,340 --> 00:27:49,970
other doors now one of the things this

522
00:27:48,380 --> 00:27:52,309
key isn't what our Keys gonna look like

523
00:27:49,970 --> 00:27:57,650
though is it our keys gonna look a

524
00:27:52,309 --> 00:28:00,350
little bit more like this so you might

525
00:27:57,650 --> 00:28:01,669
want to be a little more careful or you

526
00:28:00,350 --> 00:28:03,559
might want to be careful as to who sees

527
00:28:01,669 --> 00:28:08,240
this key because that's gonna stand out

528
00:28:03,559 --> 00:28:11,928
and look a little odd if the security

529
00:28:08,240 --> 00:28:15,679
happens to see you with this key now

530
00:28:11,929 --> 00:28:19,220
on the topic of file hand filing Keys we

531
00:28:15,679 --> 00:28:22,190
want to be very careful because we don't

532
00:28:19,220 --> 00:28:25,190
want our key to look like this when your

533
00:28:22,190 --> 00:28:28,929
hand filing you can Canyon and if you do

534
00:28:25,190 --> 00:28:31,690
this and you put this key into a lock

535
00:28:28,929 --> 00:28:35,840
you're not gonna get that key back out

536
00:28:31,690 --> 00:28:39,320
that second or the fourth pin is going

537
00:28:35,840 --> 00:28:41,959
to drop down into the canyon that depth

538
00:28:39,320 --> 00:28:43,428
of three and you are not going to be

539
00:28:41,960 --> 00:28:46,009
able to get it back out because you

540
00:28:43,429 --> 00:28:47,720
don't have the proper angle and now

541
00:28:46,009 --> 00:28:53,179
you're stuck at somebody else's door

542
00:28:47,720 --> 00:28:57,320
with a hand filed bogus key and it's

543
00:28:53,179 --> 00:28:59,029
time to find your exit plan so this is

544
00:28:57,320 --> 00:29:03,740
what we know on the internals of our

545
00:28:59,029 --> 00:29:07,340
original door lock so we have mastering

546
00:29:03,740 --> 00:29:10,009
pins in four of our five chambers and we

547
00:29:07,340 --> 00:29:14,049
have our values up on the slides these

548
00:29:10,009 --> 00:29:16,999
are their known mastering depths now the

549
00:29:14,049 --> 00:29:23,240
hypothetical alternative lock in the

550
00:29:16,999 --> 00:29:27,619
same system we put our key in and all of

551
00:29:23,240 --> 00:29:30,230
the chambers are the there is a shear

552
00:29:27,619 --> 00:29:33,259
line at the same as the plug so that we

553
00:29:30,230 --> 00:29:36,110
could operate andis door and now I'm in

554
00:29:33,259 --> 00:29:40,429
andis lab or I'm sorry alice is in andis

555
00:29:36,110 --> 00:29:46,758
lab stealing andis research huzzah a

556
00:29:40,429 --> 00:29:47,809
winner is you so I'm pretty sure nobody

557
00:29:46,759 --> 00:29:50,840
thought that I was actually gonna get

558
00:29:47,809 --> 00:29:55,129
through 226 slides in 30 minutes

559
00:29:50,840 --> 00:29:57,428
I still have 40 seconds left so thank

560
00:29:55,129 --> 00:30:01,360
you very much if you have any questions

561
00:29:57,429 --> 00:30:04,369
at this stage find me afterwards and

562
00:30:01,360 --> 00:30:07,439
I'll try to discuss your questions and

563
00:30:04,369 --> 00:30:15,009
help you out with them thank you

564
00:30:07,440 --> 00:30:15,009
[Applause]

