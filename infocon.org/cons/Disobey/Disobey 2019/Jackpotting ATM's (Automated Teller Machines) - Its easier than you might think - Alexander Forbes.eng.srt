1
00:00:00,300 --> 00:00:03,340
[Music]

2
00:00:08,090 --> 00:00:23,479
[Music]

3
00:00:31,020 --> 00:00:36,160
good evening everybody my name is

4
00:00:33,970 --> 00:00:38,200
Alexander Forbes I'm with IBM's x-force

5
00:00:36,160 --> 00:00:40,690
read otherwise known as our penetration

6
00:00:38,200 --> 00:00:41,980
testing or ethical hacking team I'm here

7
00:00:40,690 --> 00:00:43,870
tonight to talk about penetration

8
00:00:41,980 --> 00:00:46,000
testing of ATMs automated teller

9
00:00:43,870 --> 00:00:48,070
machines otherwise known this

10
00:00:46,000 --> 00:00:50,830
presentation is Jack potting ATMs it's

11
00:00:48,070 --> 00:00:52,600
easier than you might think I'll try and

12
00:00:50,830 --> 00:00:54,580
get the the corporates filled out very

13
00:00:52,600 --> 00:00:55,900
quickly or what I talked about here IBM

14
00:00:54,580 --> 00:00:58,420
does not endorse please don't go in

15
00:00:55,900 --> 00:01:01,170
attack ATMs unless you have a signed

16
00:00:58,420 --> 00:01:03,190
contract and you know what you're doing

17
00:01:01,170 --> 00:01:05,259
hopefully you'll you'll learn quite a

18
00:01:03,190 --> 00:01:07,479
lot about how we go about attacking an

19
00:01:05,259 --> 00:01:09,399
ATM and also the weaknesses that exist

20
00:01:07,479 --> 00:01:10,899
in the industry and where the industry

21
00:01:09,399 --> 00:01:14,890
needs to go to start improving the

22
00:01:10,899 --> 00:01:16,660
security of these devices big warning in

23
00:01:14,890 --> 00:01:18,970
advance the things that I talk about

24
00:01:16,660 --> 00:01:21,759
here do tend to go badly if you're doing

25
00:01:18,970 --> 00:01:22,929
them in public even if even if people

26
00:01:21,759 --> 00:01:25,000
are aware that you're going to be doing

27
00:01:22,930 --> 00:01:28,270
them if you're doing a pen test of an

28
00:01:25,000 --> 00:01:30,340
ATM somewhere in the wild at a shopping

29
00:01:28,270 --> 00:01:32,170
mall at a bank branch even if it's all

30
00:01:30,340 --> 00:01:34,869
fully signed off you do tend to get

31
00:01:32,170 --> 00:01:37,720
people with guns turning up even if even

32
00:01:34,869 --> 00:01:39,220
if it's legitimate that being said even

33
00:01:37,720 --> 00:01:42,760
if you don't have permission it's also a

34
00:01:39,220 --> 00:01:44,080
very bad idea again people with guns do

35
00:01:42,760 --> 00:01:47,619
tend to turn up and they tend to not be

36
00:01:44,080 --> 00:01:49,570
too happy I'll talk a bit towards the

37
00:01:47,619 --> 00:01:50,770
end about if you want to get away with

38
00:01:49,570 --> 00:01:54,610
it what you might need to consider

39
00:01:50,770 --> 00:01:56,408
before having a go without that the main

40
00:01:54,610 --> 00:01:59,020
main agenda I'll cover a brief history

41
00:01:56,409 --> 00:02:00,189
of ATMs this is important because to

42
00:01:59,020 --> 00:02:01,420
understand how the technologies

43
00:02:00,189 --> 00:02:04,570
developed and how the vulnerabilities

44
00:02:01,420 --> 00:02:06,040
have been added over time it's kind of

45
00:02:04,570 --> 00:02:08,228
critical to understand where the

46
00:02:06,040 --> 00:02:09,880
technology has grown from I'll talk

47
00:02:08,229 --> 00:02:11,650
about what is a modern ATM the

48
00:02:09,880 --> 00:02:14,640
components that consists of and the

49
00:02:11,650 --> 00:02:16,900
architecture that has evolved around

50
00:02:14,640 --> 00:02:18,578
dispensing cash to end consumers and

51
00:02:16,900 --> 00:02:20,350
providing the functionality that you see

52
00:02:18,579 --> 00:02:22,959
in a modern ATM

53
00:02:20,350 --> 00:02:24,910
I'll cover attack surfaces how we can

54
00:02:22,959 --> 00:02:27,430
attack them what different strategies

55
00:02:24,910 --> 00:02:29,440
you can take and the defense's that are

56
00:02:27,430 --> 00:02:32,590
already in place and how you can bypass

57
00:02:29,440 --> 00:02:33,910
them and how they are being evolved to

58
00:02:32,590 --> 00:02:36,150
try and protect against the kinds of

59
00:02:33,910 --> 00:02:38,799
attacks that I'll talk about later

60
00:02:36,150 --> 00:02:39,550
finally I'll give a brief discussion on

61
00:02:38,799 --> 00:02:41,050
what you

62
00:02:39,550 --> 00:02:43,350
you think about if you are attacking an

63
00:02:41,050 --> 00:02:45,600
ATM and how to get away with doing it

64
00:02:43,350 --> 00:02:47,560
please be careful with the knowledge and

65
00:02:45,600 --> 00:02:49,180
finally lessons learned if you are

66
00:02:47,560 --> 00:02:51,100
responsible for managing a network of

67
00:02:49,180 --> 00:02:52,870
ATMs or you work with clients who are

68
00:02:51,100 --> 00:02:54,430
what sort of things they should be

69
00:02:52,870 --> 00:02:57,610
considering and what sort of attack

70
00:02:54,430 --> 00:03:00,400
models they need to be aware of so

71
00:02:57,610 --> 00:03:01,620
briefly a history of how automated

72
00:03:00,400 --> 00:03:04,000
teller machines have been developed

73
00:03:01,620 --> 00:03:06,160
historically there were devices that

74
00:03:04,000 --> 00:03:08,260
people could use to access their account

75
00:03:06,160 --> 00:03:10,480
and do something well before what we

76
00:03:08,260 --> 00:03:12,459
know as an ATM was developed

77
00:03:10,480 --> 00:03:14,230
there's argument over who developed

78
00:03:12,460 --> 00:03:16,450
those and what they were some Delarue

79
00:03:14,230 --> 00:03:18,160
job another another vendors but what's

80
00:03:16,450 --> 00:03:20,410
defined as the modern ATM that is

81
00:03:18,160 --> 00:03:22,420
something with a card reader a pin entry

82
00:03:20,410 --> 00:03:24,280
pad probably a receipt printer of some

83
00:03:22,420 --> 00:03:26,019
kind and the ability to dispense cash

84
00:03:24,280 --> 00:03:27,820
was invented depending on which

85
00:03:26,020 --> 00:03:31,150
historian you ask why either IBM or

86
00:03:27,820 --> 00:03:34,180
docutel back in the 1960s historically

87
00:03:31,150 --> 00:03:36,130
back in and then that time though those

88
00:03:34,180 --> 00:03:37,960
systems were very specific to the

89
00:03:36,130 --> 00:03:39,460
organization they were part of so the

90
00:03:37,960 --> 00:03:41,500
backend banking infrastructure was

91
00:03:39,460 --> 00:03:43,750
generally quite custom and each ATM

92
00:03:41,500 --> 00:03:45,970
deployment was custom to that customer

93
00:03:43,750 --> 00:03:47,910
over time there's been a lot more

94
00:03:45,970 --> 00:03:51,340
standardization and consolidation

95
00:03:47,910 --> 00:03:54,040
whereas even as late as their mid to mid

96
00:03:51,340 --> 00:03:56,320
to late 1990s there were many ATM

97
00:03:54,040 --> 00:03:59,890
vendors in the fields Phillips Olivetti

98
00:03:56,320 --> 00:04:01,930
Hitachi Diebold Winkle Nixdorf Siemens

99
00:03:59,890 --> 00:04:04,809
nowadays there are very few major

100
00:04:01,930 --> 00:04:06,489
players this has gotten so bad that in

101
00:04:04,810 --> 00:04:07,870
some countries now regulatory

102
00:04:06,489 --> 00:04:10,209
authorities are getting involved to say

103
00:04:07,870 --> 00:04:13,870
actually there are too few vendors and

104
00:04:10,209 --> 00:04:16,988
too few suppliers in this space as a pen

105
00:04:13,870 --> 00:04:18,370
tester however this is fantastic news if

106
00:04:16,988 --> 00:04:20,380
you know that you have an attack that

107
00:04:18,370 --> 00:04:22,660
works on one particular vendors model

108
00:04:20,380 --> 00:04:23,260
and there are only three vendors widely

109
00:04:22,660 --> 00:04:25,090
used

110
00:04:23,260 --> 00:04:27,430
then you've generally got a portable

111
00:04:25,090 --> 00:04:29,229
attack that scales to many many devices

112
00:04:27,430 --> 00:04:33,190
often in many many countries and regions

113
00:04:29,230 --> 00:04:36,220
of the world these days for the UK

114
00:04:33,190 --> 00:04:38,560
specifically roughly a 99 percent market

115
00:04:36,220 --> 00:04:40,570
share is split between Diebold Nixdorf

116
00:04:38,560 --> 00:04:43,270
previously wink or Nixdorf Siemens

117
00:04:40,570 --> 00:04:45,940
Nixdorf and eyeballed merging NCR or

118
00:04:43,270 --> 00:04:47,289
national cash register and Triton in

119
00:04:45,940 --> 00:04:48,969
other countries the mix is slightly

120
00:04:47,290 --> 00:04:52,520
different but there's very very few

121
00:04:48,970 --> 00:04:54,440
other players in the market at this time

122
00:04:52,520 --> 00:04:56,450
I mentioned earlier that standardization

123
00:04:54,440 --> 00:04:58,130
had happened quite quite significantly

124
00:04:56,450 --> 00:05:00,860
over the time period to where we are

125
00:04:58,130 --> 00:05:03,290
today this mostly started back in the

126
00:05:00,860 --> 00:05:05,330
early 90s with something called XFS or

127
00:05:03,290 --> 00:05:07,190
extensions for financial services and

128
00:05:05,330 --> 00:05:09,200
the reason for this was driven by the

129
00:05:07,190 --> 00:05:11,690
banks they didn't want vendor lock-in

130
00:05:09,200 --> 00:05:13,610
with the ATM manufacturers so what's

131
00:05:11,690 --> 00:05:15,500
happened over time is you now have a

132
00:05:13,610 --> 00:05:17,870
middleware layer that abstracts the

133
00:05:15,500 --> 00:05:20,270
banking UI that they get to control and

134
00:05:17,870 --> 00:05:21,830
customize from the hardware of the ATMs

135
00:05:20,270 --> 00:05:25,340
that is interacted with by that

136
00:05:21,830 --> 00:05:27,349
application and that XFS api so a lot of

137
00:05:25,340 --> 00:05:29,599
the attacks that we see target this

138
00:05:27,350 --> 00:05:31,400
abstraction layer it's not particularly

139
00:05:29,600 --> 00:05:33,410
badly designed but it does have some

140
00:05:31,400 --> 00:05:35,870
fairly significant flaws which I will

141
00:05:33,410 --> 00:05:38,300
hopefully get to later but anyway in

142
00:05:35,870 --> 00:05:39,710
brief ATMs these days are fairly

143
00:05:38,300 --> 00:05:41,720
homogeneous they're very very common

144
00:05:39,710 --> 00:05:43,099
very very similar functionality most of

145
00:05:41,720 --> 00:05:44,480
them are built off the same fundamental

146
00:05:43,100 --> 00:05:46,700
platform and adhere to the same

147
00:05:44,480 --> 00:05:48,080
standards there are lots of

148
00:05:46,700 --> 00:05:50,150
discrepancies in various different

149
00:05:48,080 --> 00:05:52,430
models but fundamentally if an attack

150
00:05:50,150 --> 00:05:54,400
works on one ATM it's generally portable

151
00:05:52,430 --> 00:05:57,800
to all the others that you see out there

152
00:05:54,400 --> 00:05:59,650
so what a modern atm looks like pretty

153
00:05:57,800 --> 00:06:02,330
much it's a standard machine

154
00:05:59,650 --> 00:06:05,150
traditionally we know even traditionally

155
00:06:02,330 --> 00:06:07,880
across all of the ATMs that we mostly

156
00:06:05,150 --> 00:06:10,190
deal with they're running a relatively

157
00:06:07,880 --> 00:06:13,130
standard 32-bit machine often running

158
00:06:10,190 --> 00:06:16,820
Windows historically Windows XP nowadays

159
00:06:13,130 --> 00:06:18,050
windows 7 sometimes windows a some vista

160
00:06:16,820 --> 00:06:20,990
ones but i've not really seen any

161
00:06:18,050 --> 00:06:22,580
windows 10 yet there are a few and I

162
00:06:20,990 --> 00:06:24,490
stress for you a very small percentage

163
00:06:22,580 --> 00:06:26,780
of the market that are Windows EE based

164
00:06:24,490 --> 00:06:29,720
but again it's getting much and much

165
00:06:26,780 --> 00:06:32,330
more rare because as banks move to more

166
00:06:29,720 --> 00:06:34,340
complex ATM devices where people can say

167
00:06:32,330 --> 00:06:37,070
top-up their mobile phone or do other

168
00:06:34,340 --> 00:06:40,789
online banking tasks transfer money onto

169
00:06:37,070 --> 00:06:42,650
cards and do prepay systems those those

170
00:06:40,790 --> 00:06:44,330
features and capabilities are much more

171
00:06:42,650 --> 00:06:47,179
difficult to port to window seee

172
00:06:44,330 --> 00:06:51,140
simply due to lack of market support but

173
00:06:47,180 --> 00:06:54,050
anyway fundamentally you have a 32-bit

174
00:06:51,140 --> 00:06:55,789
system and connected to that system are

175
00:06:54,050 --> 00:06:58,010
the various pieces of peripherals

176
00:06:55,790 --> 00:07:00,890
referrals and pieces of equipment that

177
00:06:58,010 --> 00:07:02,900
make it an ATM a receipt printer is just

178
00:07:00,890 --> 00:07:05,210
like a normal USB printer in most ATMs

179
00:07:02,900 --> 00:07:06,830
it plugs in thermal printer exact

180
00:07:05,210 --> 00:07:09,440
the same thing you would find in most

181
00:07:06,830 --> 00:07:11,240
point-of-sale systems the pin entry pad

182
00:07:09,440 --> 00:07:14,349
is again a sort of self-contained unit

183
00:07:11,240 --> 00:07:16,940
that connects in most ATMs via USB

184
00:07:14,349 --> 00:07:18,680
some of them use touchscreens some of um

185
00:07:16,940 --> 00:07:20,870
use buttons alongside some of them

186
00:07:18,680 --> 00:07:22,520
support both capabilities

187
00:07:20,870 --> 00:07:25,190
the other key peripheral that you tend

188
00:07:22,520 --> 00:07:27,409
to find beyond the card reader and the

189
00:07:25,190 --> 00:07:29,569
cash dispenser there's some kind of

190
00:07:27,410 --> 00:07:32,270
security options you normally find

191
00:07:29,569 --> 00:07:34,180
sensors it's very very common for ATMs

192
00:07:32,270 --> 00:07:36,349
these days to have an integrated camera

193
00:07:34,180 --> 00:07:38,720
sometimes there are till and motion

194
00:07:36,349 --> 00:07:41,169
sensors and tamper switch is to identify

195
00:07:38,720 --> 00:07:43,220
when the casing has been been opened

196
00:07:41,169 --> 00:07:45,289
most of you will have seen something

197
00:07:43,220 --> 00:07:47,330
that looks like this ignore the brown

198
00:07:45,289 --> 00:07:50,539
splotches the brown splotches are there

199
00:07:47,330 --> 00:07:52,969
just to make sure we don't get sued but

200
00:07:50,539 --> 00:07:54,620
this this is a relatively modern common

201
00:07:52,970 --> 00:07:56,810
ATM model that you might see around

202
00:07:54,620 --> 00:07:59,539
you'll notice at the top that large

203
00:07:56,810 --> 00:08:01,250
black panel behind there is a camera in

204
00:07:59,539 --> 00:08:03,259
many models you'll also find a

205
00:08:01,250 --> 00:08:05,330
microphone there and depending on the

206
00:08:03,259 --> 00:08:07,610
configuration of the ATM it may do

207
00:08:05,330 --> 00:08:09,440
things like take pictures every 10

208
00:08:07,610 --> 00:08:11,630
seconds every minute or only take

209
00:08:09,440 --> 00:08:13,130
pictures when a card is inserted and put

210
00:08:11,630 --> 00:08:15,710
the card number into the picture that it

211
00:08:13,130 --> 00:08:17,300
saves the two mirrors that you see in

212
00:08:15,710 --> 00:08:18,770
the top left and right are there for a

213
00:08:17,300 --> 00:08:20,659
good reason I'll talk about that later

214
00:08:18,770 --> 00:08:22,729
but it's not just there to protect the

215
00:08:20,659 --> 00:08:25,340
ATM it's there to take the use case of

216
00:08:22,729 --> 00:08:26,870
someone using an ATM the other

217
00:08:25,340 --> 00:08:29,239
facilities that you can see there are

218
00:08:26,870 --> 00:08:30,770
all the core essential bits at the

219
00:08:29,240 --> 00:08:33,320
bottom of this picture you'll see a

220
00:08:30,770 --> 00:08:35,630
thick thick line that separates the top

221
00:08:33,320 --> 00:08:37,909
part of the ATM from the bottom part the

222
00:08:35,630 --> 00:08:40,219
top part known as the top box is where

223
00:08:37,909 --> 00:08:42,319
most of the electronic components are

224
00:08:40,219 --> 00:08:45,170
kept everything pretty much except the

225
00:08:42,320 --> 00:08:47,300
cash the bottom part is almost entirely

226
00:08:45,170 --> 00:08:49,010
taken up by a safe and that safe

227
00:08:47,300 --> 00:08:51,140
contains cassettes which hold the cash

228
00:08:49,010 --> 00:08:52,670
itself and the dispensing unit that

229
00:08:51,140 --> 00:08:54,410
dispenses the cash which is almost

230
00:08:52,670 --> 00:08:56,839
always completely contained within the

231
00:08:54,410 --> 00:08:59,990
safe other than the connection via USB

232
00:08:56,839 --> 00:09:02,240
and power to the top box this particular

233
00:08:59,990 --> 00:09:05,510
model has a sensor that you can see on

234
00:09:02,240 --> 00:09:07,459
the far left which shows which allows

235
00:09:05,510 --> 00:09:09,140
the the system to detect if somebody's

236
00:09:07,459 --> 00:09:10,880
forgotten to take their cash out of the

237
00:09:09,140 --> 00:09:13,839
machine after requesting it which is a

238
00:09:10,880 --> 00:09:16,400
surprisingly common issue that you see

239
00:09:13,839 --> 00:09:18,529
inside an ATM this is a different model

240
00:09:16,400 --> 00:09:19,010
but if you take the model before we

241
00:09:18,529 --> 00:09:20,600
slide

242
00:09:19,010 --> 00:09:23,090
front panel open we see something like

243
00:09:20,600 --> 00:09:25,430
this you can see the receipt printer

244
00:09:23,090 --> 00:09:28,430
here on the inside the camera up in the

245
00:09:25,430 --> 00:09:32,209
top right of there so I top left excuse

246
00:09:28,430 --> 00:09:35,329
me the air vents allow the the computer

247
00:09:32,210 --> 00:09:36,890
to vent hot air outside behind next to

248
00:09:35,330 --> 00:09:40,580
the camera you'll see there a latching

249
00:09:36,890 --> 00:09:42,470
mechanism and if you're able to see it

250
00:09:40,580 --> 00:09:44,810
it's a very very small silver dot in the

251
00:09:42,470 --> 00:09:46,820
top left of that of that picture that's

252
00:09:44,810 --> 00:09:51,140
where the locking mechanism to allow it

253
00:09:46,820 --> 00:09:52,850
to open and close is to the to the front

254
00:09:51,140 --> 00:09:55,040
of that you'll see that the PIN pad here

255
00:09:52,850 --> 00:09:57,020
is directly below the screen and again

256
00:09:55,040 --> 00:09:58,520
it's shielded so they've invested a

257
00:09:57,020 --> 00:10:00,050
little bit more in trying to shield

258
00:09:58,520 --> 00:10:02,810
shoulder surfing attacks in this

259
00:10:00,050 --> 00:10:04,819
particular model but fundamentally a

260
00:10:02,810 --> 00:10:07,910
computer and a bunch of peripherals plug

261
00:10:04,820 --> 00:10:10,160
together looking down into into the

262
00:10:07,910 --> 00:10:12,380
inside there you can see the receipt

263
00:10:10,160 --> 00:10:14,209
printer on the right of the picture

264
00:10:12,380 --> 00:10:16,730
below and on the left there's the card

265
00:10:14,210 --> 00:10:18,890
reader where your card gets put in every

266
00:10:16,730 --> 00:10:21,700
card reader I have seen has the

267
00:10:18,890 --> 00:10:24,080
capability to keep and retain cards

268
00:10:21,700 --> 00:10:26,270
whether they do so whether the software

269
00:10:24,080 --> 00:10:27,950
is configured to ever retain cards is

270
00:10:26,270 --> 00:10:29,930
something that the the vendor twos is

271
00:10:27,950 --> 00:10:32,270
the bank chooses and generally that may

272
00:10:29,930 --> 00:10:34,910
depend on whether the ATM is located in

273
00:10:32,270 --> 00:10:38,060
a bank facility or if it's somewhere

274
00:10:34,910 --> 00:10:40,250
else in this particular model that this

275
00:10:38,060 --> 00:10:42,020
picture is of the computing unit is

276
00:10:40,250 --> 00:10:43,100
integrated effectively with the screen

277
00:10:42,020 --> 00:10:45,560
it's one of the small form-factor

278
00:10:43,100 --> 00:10:47,540
machines and if we look towards the

279
00:10:45,560 --> 00:10:49,130
screen which you'll see in the picture

280
00:10:47,540 --> 00:10:51,620
on the right there it is

281
00:10:49,130 --> 00:10:53,840
behind a USB expansion board just a

282
00:10:51,620 --> 00:10:57,290
standard intel 32-bit computer running

283
00:10:53,840 --> 00:10:59,530
Windows 7 older ATMs sometimes have a

284
00:10:57,290 --> 00:11:02,719
tower form factor machine at the back

285
00:10:59,530 --> 00:11:05,209
rotated by 90 degrees but fundamentally

286
00:11:02,720 --> 00:11:09,050
the architecture is SATA connections or

287
00:11:05,210 --> 00:11:11,150
IDE connections USB or powered USB 4 for

288
00:11:09,050 --> 00:11:14,060
the peripherals and sometimes some

289
00:11:11,150 --> 00:11:16,670
custom components such as GPIO stuff for

290
00:11:14,060 --> 00:11:18,500
tamper switches here's an example

291
00:11:16,670 --> 00:11:20,150
looking you can see the extension board

292
00:11:18,500 --> 00:11:22,280
from the previous picture in the bottom

293
00:11:20,150 --> 00:11:24,829
right of this picture and above it you

294
00:11:22,280 --> 00:11:27,170
can see standard caddies for for small

295
00:11:24,830 --> 00:11:28,490
form-factor hard drives and above a

296
00:11:27,170 --> 00:11:31,870
connector that links it to the

297
00:11:28,490 --> 00:11:35,810
touchscreen pretty pretty simple for

298
00:11:31,870 --> 00:11:37,370
so they have made some efforts in most

299
00:11:35,810 --> 00:11:40,069
of these designs too hard in this

300
00:11:37,370 --> 00:11:41,990
platform everyone probably familiar that

301
00:11:40,070 --> 00:11:43,310
x86 has quite a lot of fundamental

302
00:11:41,990 --> 00:11:45,020
problems with its architecture when it

303
00:11:43,310 --> 00:11:47,030
comes to security so do all the

304
00:11:45,020 --> 00:11:50,060
operating systems and in this case the

305
00:11:47,030 --> 00:11:52,579
connections being standard USB or GPIO

306
00:11:50,060 --> 00:11:54,619
or others can be intercepted so there

307
00:11:52,580 --> 00:11:58,460
has been some work to try and harden

308
00:11:54,620 --> 00:12:00,350
these basic platforms on a on a high

309
00:11:58,460 --> 00:12:03,140
level if it's a windows-based system

310
00:12:00,350 --> 00:12:05,420
almost always the shell is in launched

311
00:12:03,140 --> 00:12:08,800
into is a custom one sometimes they have

312
00:12:05,420 --> 00:12:11,180
customer authentication providers good

313
00:12:08,800 --> 00:12:12,650
organizations will remove these

314
00:12:11,180 --> 00:12:14,689
certificates from the certificate trust

315
00:12:12,650 --> 00:12:16,400
store except for those for obviously

316
00:12:14,690 --> 00:12:18,170
Windows components that need Windows

317
00:12:16,400 --> 00:12:20,750
updates and digital signatures the

318
00:12:18,170 --> 00:12:22,760
people who manufacture the ATM and their

319
00:12:20,750 --> 00:12:25,310
own their own software or software

320
00:12:22,760 --> 00:12:27,860
they've installed aftermarket such as

321
00:12:25,310 --> 00:12:30,739
white listing protection software it's

322
00:12:27,860 --> 00:12:34,040
very common to see either McAfee solid

323
00:12:30,740 --> 00:12:37,250
call gmv ATM security Symantec critical

324
00:12:34,040 --> 00:12:40,189
system protection or other other system

325
00:12:37,250 --> 00:12:42,920
hardening utilities those are generally

326
00:12:40,190 --> 00:12:46,010
used in a lot of other use cases beyond

327
00:12:42,920 --> 00:12:48,439
ATMs that they're if configured properly

328
00:12:46,010 --> 00:12:49,930
they're very very good that being said

329
00:12:48,440 --> 00:12:52,280
they're not always configured properly

330
00:12:49,930 --> 00:12:54,380
there is also some things that the

331
00:12:52,280 --> 00:12:56,300
manufacturers of the ATMs customized

332
00:12:54,380 --> 00:12:59,060
with the hardware it's quite common to

333
00:12:56,300 --> 00:13:00,740
see customized biases and these are

334
00:12:59,060 --> 00:13:03,349
normally there to prevent you doing

335
00:13:00,740 --> 00:13:07,010
basic attacks such as booting from an

336
00:13:03,350 --> 00:13:08,870
external media some of them have options

337
00:13:07,010 --> 00:13:10,640
for using things like TPM chips for

338
00:13:08,870 --> 00:13:12,980
things like call driving crip ssin but

339
00:13:10,640 --> 00:13:14,600
it's quite uncommon to see them being

340
00:13:12,980 --> 00:13:16,220
implemented properly although the

341
00:13:14,600 --> 00:13:20,530
hardware may support those security

342
00:13:16,220 --> 00:13:24,950
capabilities adoption is pretty low so

343
00:13:20,530 --> 00:13:27,140
ATM attack surfaces ATM designers need

344
00:13:24,950 --> 00:13:29,150
to be aware of more than just the actual

345
00:13:27,140 --> 00:13:31,400
ATM itself because it's part of a much

346
00:13:29,150 --> 00:13:33,079
more complex system you have the backend

347
00:13:31,400 --> 00:13:34,550
environment that it needs to talk to the

348
00:13:33,080 --> 00:13:36,110
banking infrastructure that

349
00:13:34,550 --> 00:13:38,060
authenticates and authorizes

350
00:13:36,110 --> 00:13:41,600
transactions that are being attempted

351
00:13:38,060 --> 00:13:44,180
through an ATM therefore generally these

352
00:13:41,600 --> 00:13:45,560
ATMs are also designed with a software

353
00:13:44,180 --> 00:13:47,270
loading to triumph

354
00:13:45,560 --> 00:13:49,430
against a compromise of the backend to

355
00:13:47,270 --> 00:13:51,860
some extent so if somebody gets on the

356
00:13:49,430 --> 00:13:53,569
ATM network ideally you don't want them

357
00:13:51,860 --> 00:13:55,550
being able to port scan all your ATMs

358
00:13:53,570 --> 00:13:57,260
see they're running standard Windows 7

359
00:13:55,550 --> 00:13:59,359
and tri standard Windows 7 exploits

360
00:13:57,260 --> 00:14:02,210
against them or any other particular

361
00:13:59,360 --> 00:14:04,100
operating system the way that the the

362
00:14:02,210 --> 00:14:05,930
way that ATMs are designed to be

363
00:14:04,100 --> 00:14:08,300
maintained to be loaded with cash and

364
00:14:05,930 --> 00:14:11,300
unloaded is designed to prevent certain

365
00:14:08,300 --> 00:14:13,279
kinds of attacks so for example an ATM

366
00:14:11,300 --> 00:14:15,170
maintainer when they open an ATM

367
00:14:13,279 --> 00:14:17,450
normally can't access any the underlying

368
00:14:15,170 --> 00:14:19,279
functionality of the operating system

369
00:14:17,450 --> 00:14:21,200
when they open the ATM there is a

370
00:14:19,279 --> 00:14:23,210
physical switch they can press that

371
00:14:21,200 --> 00:14:25,460
switch sends a commands to the operating

372
00:14:23,210 --> 00:14:27,680
system which says change the on screen

373
00:14:25,460 --> 00:14:29,570
application to this other permitted on

374
00:14:27,680 --> 00:14:31,250
screen application but in theory they

375
00:14:29,570 --> 00:14:33,500
should have no access to the underlying

376
00:14:31,250 --> 00:14:35,630
for example Explorer shell or other

377
00:14:33,500 --> 00:14:37,520
applications on the system and indeed if

378
00:14:35,630 --> 00:14:39,110
configured properly the application

379
00:14:37,520 --> 00:14:41,720
whitelisting stuff shouldn't allow

380
00:14:39,110 --> 00:14:43,490
anything else to be started and again

381
00:14:41,720 --> 00:14:45,650
shouldn't allow anything else all the

382
00:14:43,490 --> 00:14:47,360
applications that are whitelist did to

383
00:14:45,650 --> 00:14:50,000
do things they are not whitelisted to do

384
00:14:47,360 --> 00:14:52,220
so for example if the maintenance

385
00:14:50,000 --> 00:14:52,850
application isn't supposed to open UDP

386
00:14:52,220 --> 00:14:54,589
sockets

387
00:14:52,850 --> 00:14:57,770
they shouldn't prevent shouldn't allow

388
00:14:54,589 --> 00:15:00,230
them to do that so there are protections

389
00:14:57,770 --> 00:15:03,470
against those kinds of threats somewhat

390
00:15:00,230 --> 00:15:04,790
trusted user threats they also have to

391
00:15:03,470 --> 00:15:08,180
obviously protect against physical

392
00:15:04,790 --> 00:15:10,010
threats cash-in-transit robbery and also

393
00:15:08,180 --> 00:15:12,439
a threat threats that attack the end

394
00:15:10,010 --> 00:15:13,819
user of the device so things to try and

395
00:15:12,440 --> 00:15:16,400
prevent things like shoulder surfing

396
00:15:13,820 --> 00:15:18,740
skimming attacks or simply somebody

397
00:15:16,400 --> 00:15:20,000
coming up and threatening someone so in

398
00:15:18,740 --> 00:15:21,530
that picture I mentioned earlier the two

399
00:15:20,000 --> 00:15:23,360
mirrors in the corner they are there to

400
00:15:21,530 --> 00:15:26,170
try and help people identify maybe I

401
00:15:23,360 --> 00:15:28,880
shouldn't be using this ATM right now

402
00:15:26,170 --> 00:15:30,469
the point being of this particular slide

403
00:15:28,880 --> 00:15:32,089
is to demonstrate when you're designing

404
00:15:30,470 --> 00:15:34,100
an ATM you need to consider a

405
00:15:32,089 --> 00:15:36,470
significant more than the security of

406
00:15:34,100 --> 00:15:38,240
the kiosk itself the positioning of the

407
00:15:36,470 --> 00:15:41,450
kiosk is often quite important making

408
00:15:38,240 --> 00:15:42,920
sure it's covered by CCTV normally you

409
00:15:41,450 --> 00:15:44,390
want it somewhere where people are going

410
00:15:42,920 --> 00:15:46,010
to be able to see it and use it and

411
00:15:44,390 --> 00:15:48,529
interact with it you want it in places

412
00:15:46,010 --> 00:15:50,480
where people will need money and will be

413
00:15:48,529 --> 00:15:53,470
getting money to spend so they're not

414
00:15:50,480 --> 00:15:56,450
normally in the middle of nowhere

415
00:15:53,470 --> 00:15:58,400
hopefully you also put them in places

416
00:15:56,450 --> 00:15:59,190
where people will report if something's

417
00:15:58,400 --> 00:16:00,420
going wrong they'll

418
00:15:59,190 --> 00:16:01,890
call the police if they see somebody

419
00:16:00,420 --> 00:16:04,229
tampering with it those sorts of things

420
00:16:01,890 --> 00:16:05,790
but as part of the overall system these

421
00:16:04,230 --> 00:16:08,250
factors are actually very important to

422
00:16:05,790 --> 00:16:11,520
securing an ATM predominantly cuz it

423
00:16:08,250 --> 00:16:16,200
limits the time an attacker has we to be

424
00:16:11,520 --> 00:16:18,930
able to pull off an attack so physical

425
00:16:16,200 --> 00:16:20,910
attack surfaces and network attack

426
00:16:18,930 --> 00:16:23,189
surfaces attacking the embedded ATM

427
00:16:20,910 --> 00:16:25,410
computer and attacking the ATM hardware

428
00:16:23,190 --> 00:16:26,730
that connects to it are all issues that

429
00:16:25,410 --> 00:16:30,180
you need to consider when you're

430
00:16:26,730 --> 00:16:33,000
constructing your ATM or deploying it so

431
00:16:30,180 --> 00:16:34,890
when we first first look at ATMs when

432
00:16:33,000 --> 00:16:36,360
when we're asked to assess one the first

433
00:16:34,890 --> 00:16:39,270
thing we look at is what is the physical

434
00:16:36,360 --> 00:16:41,130
security like so what would an attacker

435
00:16:39,270 --> 00:16:42,540
potentially look at what's the easiest

436
00:16:41,130 --> 00:16:45,540
way of getting the money out of this

437
00:16:42,540 --> 00:16:48,240
machine attacks that have been pulled

438
00:16:45,540 --> 00:16:50,760
off successfully against ATMs mostly

439
00:16:48,240 --> 00:16:52,260
tend to be brute force in nature most of

440
00:16:50,760 --> 00:16:54,540
the successful attacks that have gotten

441
00:16:52,260 --> 00:16:56,610
significant amounts of cash out tend to

442
00:16:54,540 --> 00:17:00,180
involved explosives heavy equipment

443
00:16:56,610 --> 00:17:01,860
trucks dragging them around so the way

444
00:17:00,180 --> 00:17:03,839
they mitigate against this is ATMs are

445
00:17:01,860 --> 00:17:05,790
very heavy they have a large safe in

446
00:17:03,840 --> 00:17:08,970
them they're often anchored or concreted

447
00:17:05,790 --> 00:17:10,770
into things that being said somebody

448
00:17:08,970 --> 00:17:12,630
with enough motivation and resources to

449
00:17:10,770 --> 00:17:15,270
and willingness to do those sorts of

450
00:17:12,630 --> 00:17:16,530
attacks generally has the opportunity to

451
00:17:15,270 --> 00:17:18,689
do so

452
00:17:16,530 --> 00:17:20,819
the location thing that I mentioned

453
00:17:18,689 --> 00:17:22,439
earlier where they're located that tends

454
00:17:20,819 --> 00:17:24,300
to again matter if they're located

455
00:17:22,439 --> 00:17:25,860
behind security bollards that stop them

456
00:17:24,300 --> 00:17:29,190
being Ram raided those sorts of

457
00:17:25,859 --> 00:17:31,740
protections can can help networking

458
00:17:29,190 --> 00:17:33,360
attacks are again things that you need

459
00:17:31,740 --> 00:17:35,940
to be particularly aware of with ATM

460
00:17:33,360 --> 00:17:37,800
generally ATMs are deployed to be

461
00:17:35,940 --> 00:17:39,870
available and reliable you don't want

462
00:17:37,800 --> 00:17:42,510
the network to be offline that means

463
00:17:39,870 --> 00:17:44,340
that a lot of banks and a lot of ATM

464
00:17:42,510 --> 00:17:46,920
owners are reluctant to patch and update

465
00:17:44,340 --> 00:17:48,720
the operating system that's particularly

466
00:17:46,920 --> 00:17:51,030
acute when it comes to networking issues

467
00:17:48,720 --> 00:17:53,910
a lot of the networking configuration

468
00:17:51,030 --> 00:17:55,980
that we see in ATMs is relatively weak

469
00:17:53,910 --> 00:17:57,990
and the reason for the weaknesses is

470
00:17:55,980 --> 00:18:00,030
partly because they don't have the deep

471
00:17:57,990 --> 00:18:02,430
systems knowledge of architecting secure

472
00:18:00,030 --> 00:18:04,230
end-to-end solutions they think this is

473
00:18:02,430 --> 00:18:05,670
on a secure network it's on the ATM

474
00:18:04,230 --> 00:18:07,500
network and that's not connected to the

475
00:18:05,670 --> 00:18:09,030
Internet so we don't necessarily need to

476
00:18:07,500 --> 00:18:11,910
think about these sorts of attack

477
00:18:09,030 --> 00:18:12,870
vectors and threat vectors universally

478
00:18:11,910 --> 00:18:15,809
this has proven to be a very

479
00:18:12,870 --> 00:18:17,549
terribly bad assumption I'll talk later

480
00:18:15,809 --> 00:18:19,860
of we've been able to man in the middle

481
00:18:17,549 --> 00:18:22,379
attack a lot of ATMs without without any

482
00:18:19,860 --> 00:18:23,309
significant challenges the ones that do

483
00:18:22,380 --> 00:18:24,960
it very well

484
00:18:23,309 --> 00:18:26,428
you can almost always eventually man in

485
00:18:24,960 --> 00:18:29,909
the middle to it if you're able to get

486
00:18:26,429 --> 00:18:32,039
any form of access into that top box the

487
00:18:29,909 --> 00:18:34,020
other things be aware of here is a lot

488
00:18:32,039 --> 00:18:38,610
of the traffic and the services that are

489
00:18:34,020 --> 00:18:40,320
exposed if you are able to review that

490
00:18:38,610 --> 00:18:41,760
traffic you can often intercept what's

491
00:18:40,320 --> 00:18:44,129
going to the back end in terms of

492
00:18:41,760 --> 00:18:46,970
logging data or auditing data so for

493
00:18:44,130 --> 00:18:50,220
example Tampa switches and some of those

494
00:18:46,970 --> 00:18:51,960
ancillary security devices don't use

495
00:18:50,220 --> 00:18:54,179
encrypted or authenticated connections

496
00:18:51,960 --> 00:18:55,980
so if an attacker is able to intercept

497
00:18:54,179 --> 00:18:57,750
and interact with a network link they

498
00:18:55,980 --> 00:19:00,539
can potentially reduce your ability to

499
00:18:57,750 --> 00:19:02,190
detect attacks are happening the

500
00:19:00,539 --> 00:19:03,929
embedded ATM computer being a

501
00:19:02,190 --> 00:19:05,580
fundamentally an x86 machine with

502
00:19:03,929 --> 00:19:07,679
Windows if you get root on the system

503
00:19:05,580 --> 00:19:11,220
well you can pretty much do anything you

504
00:19:07,679 --> 00:19:13,440
like there are some protection software

505
00:19:11,220 --> 00:19:14,700
so things like the the main what I

506
00:19:13,440 --> 00:19:16,559
mentioned earlier like solid core and

507
00:19:14,700 --> 00:19:19,169
other application whitelisting systems

508
00:19:16,559 --> 00:19:21,690
can be used to help in some of these

509
00:19:19,169 --> 00:19:23,600
areas but in reality once somebody's

510
00:19:21,690 --> 00:19:26,640
managed to get in that operating system

511
00:19:23,600 --> 00:19:28,699
all bets are off this is how most

512
00:19:26,640 --> 00:19:31,590
successful attacks tend tend to play out

513
00:19:28,700 --> 00:19:33,240
finally if you have access to the ATM

514
00:19:31,590 --> 00:19:35,370
attacking the hardware components is an

515
00:19:33,240 --> 00:19:38,340
option some of you may be familiar that

516
00:19:35,370 --> 00:19:41,250
back in 2015 we started seeing groups of

517
00:19:38,340 --> 00:19:43,620
hacker of hackers taking custom hardware

518
00:19:41,250 --> 00:19:46,320
so raspberry PI's or things that they've

519
00:19:43,620 --> 00:19:48,629
they've customized themselves written

520
00:19:46,320 --> 00:19:51,389
their own you written their own

521
00:19:48,630 --> 00:19:53,010
interface to the the ATM components and

522
00:19:51,390 --> 00:19:55,919
by connecting them in they can send

523
00:19:53,010 --> 00:19:57,750
commands directly these attacks have

524
00:19:55,919 --> 00:19:59,340
since evolved now they're no longer so

525
00:19:57,750 --> 00:20:01,049
stupid enough just to try and dump all

526
00:19:59,340 --> 00:20:03,750
the cache but they'll sniff all the data

527
00:20:01,049 --> 00:20:05,309
of the card users first for a for a fair

528
00:20:03,750 --> 00:20:07,850
number of weeks so they can sell that

529
00:20:05,309 --> 00:20:11,220
data and then dump the cache afterwards

530
00:20:07,850 --> 00:20:14,250
so I talked about some of the new threat

531
00:20:11,220 --> 00:20:17,010
models I mentioned for ATMs physically

532
00:20:14,250 --> 00:20:18,390
they're heavy if you are pen testing an

533
00:20:17,010 --> 00:20:19,740
ATM be careful when you're rocking a

534
00:20:18,390 --> 00:20:21,630
thing around because if it falls you're

535
00:20:19,740 --> 00:20:24,059
not gonna stop it falling that being

536
00:20:21,630 --> 00:20:25,290
said and a motivated attacker couple of

537
00:20:24,059 --> 00:20:27,180
strong people and some

538
00:20:25,290 --> 00:20:28,649
as you can normally get one you can

539
00:20:27,180 --> 00:20:30,960
normally move one without too much

540
00:20:28,650 --> 00:20:32,910
threat again defending against them put

541
00:20:30,960 --> 00:20:35,820
them into busy places try and make sure

542
00:20:32,910 --> 00:20:37,500
that they are covered by CCTV but be

543
00:20:35,820 --> 00:20:39,330
aware again part of the threat model a

544
00:20:37,500 --> 00:20:41,640
lot of these places aren't frequented at

545
00:20:39,330 --> 00:20:43,169
night if you go after an ATM at 3 in the

546
00:20:41,640 --> 00:20:46,230
morning that's probably not gonna be

547
00:20:43,170 --> 00:20:47,670
anyone there for a good hour or two some

548
00:20:46,230 --> 00:20:50,190
of the concerns with a physical security

549
00:20:47,670 --> 00:20:51,840
is that the casing of most of these ATMs

550
00:20:50,190 --> 00:20:54,680
is actually really really weak the

551
00:20:51,840 --> 00:20:57,629
fascia is normally just clear plastic

552
00:20:54,680 --> 00:20:59,820
the immediately behind that you may have

553
00:20:57,630 --> 00:21:01,440
some some thin sheet metal and that

554
00:20:59,820 --> 00:21:03,030
means that physically getting in if you

555
00:21:01,440 --> 00:21:05,880
can get round to the sides or the back

556
00:21:03,030 --> 00:21:07,889
of the ATM or even at the front you can

557
00:21:05,880 --> 00:21:09,420
get into it without a huge amount of

558
00:21:07,890 --> 00:21:11,760
amount of huge amount of force or

559
00:21:09,420 --> 00:21:13,320
challenge to do so the keys that I

560
00:21:11,760 --> 00:21:15,090
mentioned earlier and you saw in where

561
00:21:13,320 --> 00:21:18,030
some of the pictures of ATMs are

562
00:21:15,090 --> 00:21:19,500
universally terrible I'll show you on

563
00:21:18,030 --> 00:21:22,020
the next slide just just what I mean by

564
00:21:19,500 --> 00:21:24,360
universally terrible I can buy copies of

565
00:21:22,020 --> 00:21:26,010
these off eBay of some dark markets in

566
00:21:24,360 --> 00:21:27,870
tour and a family bar bar people will

567
00:21:26,010 --> 00:21:30,510
quite happily sell me keys for various

568
00:21:27,870 --> 00:21:33,030
ATM models and a lot of the physical

569
00:21:30,510 --> 00:21:34,740
security of these ATMs doesn't view that

570
00:21:33,030 --> 00:21:37,500
sort of attack vector with the right

571
00:21:34,740 --> 00:21:40,320
level of scrutiny so for example the

572
00:21:37,500 --> 00:21:42,270
model that I show here I was able to

573
00:21:40,320 --> 00:21:44,280
break into this ATM with a piece of wire

574
00:21:42,270 --> 00:21:45,960
going through one of the air vents to

575
00:21:44,280 --> 00:21:48,540
hook over that latch to pull it back to

576
00:21:45,960 --> 00:21:49,470
gain access to the top box for those of

577
00:21:48,540 --> 00:21:51,090
you that went to the lock-picking

578
00:21:49,470 --> 00:21:52,950
village or anybody here who knows about

579
00:21:51,090 --> 00:21:54,929
physical lock security which isn't it's

580
00:21:52,950 --> 00:21:57,180
not my field that key is not a

581
00:21:54,930 --> 00:21:59,460
particularly complex key and that's used

582
00:21:57,180 --> 00:22:01,620
by a current generation model of a

583
00:21:59,460 --> 00:22:04,590
widely deployed ATM to access the

584
00:22:01,620 --> 00:22:06,899
internals of it yeah you can buy those

585
00:22:04,590 --> 00:22:09,270
of Alibaba you can buy those off off

586
00:22:06,900 --> 00:22:12,540
tour and if you can get to an ATM you

587
00:22:09,270 --> 00:22:14,670
can pull open the insides when the

588
00:22:12,540 --> 00:22:16,860
physical security of ATM also extends to

589
00:22:14,670 --> 00:22:19,080
being linked to the network security of

590
00:22:16,860 --> 00:22:21,300
it so for example here is a relatively

591
00:22:19,080 --> 00:22:24,840
common kind of problem we find with ATM

592
00:22:21,300 --> 00:22:26,490
installations this ATM you can see on

593
00:22:24,840 --> 00:22:29,760
the right hand side is the big white box

594
00:22:26,490 --> 00:22:33,330
and it's within this cage that you can

595
00:22:29,760 --> 00:22:35,220
see on the left hand picture the person

596
00:22:33,330 --> 00:22:37,699
who was responsible for replacing the

597
00:22:35,220 --> 00:22:41,060
till roll the receipt roll

598
00:22:37,700 --> 00:22:42,860
in this atm had did not have the keys at

599
00:22:41,060 --> 00:22:44,659
one point so just decided to force a

600
00:22:42,860 --> 00:22:46,429
lock open but it kind of shows you the

601
00:22:44,660 --> 00:22:48,140
level of physical security that were the

602
00:22:46,430 --> 00:22:51,500
went into so the furniture of this

603
00:22:48,140 --> 00:22:52,940
particular atm even worse if your ask

604
00:22:51,500 --> 00:22:55,310
you and you look in the right picture at

605
00:22:52,940 --> 00:22:57,230
the bottom you'll hopefully see that

606
00:22:55,310 --> 00:22:59,450
there is a gap between the blue frame

607
00:22:57,230 --> 00:23:01,070
here and the floor there there wasn't

608
00:22:59,450 --> 00:23:02,630
there was no attachment of this frame to

609
00:23:01,070 --> 00:23:04,850
the floor we could just literally slide

610
00:23:02,630 --> 00:23:07,990
the frame back away from the ATM and

611
00:23:04,850 --> 00:23:11,179
access everything inside the back of it

612
00:23:07,990 --> 00:23:12,320
no thought whatsoever had gone into into

613
00:23:11,180 --> 00:23:13,910
the furniture in the deployment and

614
00:23:12,320 --> 00:23:15,679
that's actually a relatively common

615
00:23:13,910 --> 00:23:18,140
problem particularly with freestanding

616
00:23:15,680 --> 00:23:20,060
ATMs but also those that appear to be in

617
00:23:18,140 --> 00:23:22,130
bill but have nothing more than a tiny

618
00:23:20,060 --> 00:23:23,960
piece of plaster board or wood between

619
00:23:22,130 --> 00:23:26,120
them and another another atm

620
00:23:23,960 --> 00:23:28,250
the reason I mention this matters for

621
00:23:26,120 --> 00:23:29,719
network security is if you look here

622
00:23:28,250 --> 00:23:32,600
all those network cables are fully

623
00:23:29,720 --> 00:23:35,240
exposed this particular ATM connected

624
00:23:32,600 --> 00:23:37,580
straight into an LTE router so from here

625
00:23:35,240 --> 00:23:39,500
we were able to access the antenna for

626
00:23:37,580 --> 00:23:41,270
the LTE router fortunately they were

627
00:23:39,500 --> 00:23:43,640
sensibly enough to put the LTE router in

628
00:23:41,270 --> 00:23:45,680
the ATM itself but in other ones you

629
00:23:43,640 --> 00:23:47,630
sometimes find modems routers and other

630
00:23:45,680 --> 00:23:50,120
critical equipment that provide the

631
00:23:47,630 --> 00:23:51,770
connectivity outside of the ATM

632
00:23:50,120 --> 00:23:54,290
enclosure which gives you an immediate

633
00:23:51,770 --> 00:23:58,820
way into the networking stack of of that

634
00:23:54,290 --> 00:24:01,159
particular ATM it's a good installation

635
00:23:58,820 --> 00:24:03,470
we'll make sure that none of this stuff

636
00:24:01,160 --> 00:24:05,690
is accessible normally you would ideally

637
00:24:03,470 --> 00:24:07,700
want it to be a separate room that is

638
00:24:05,690 --> 00:24:09,650
physically locked and concreted in but a

639
00:24:07,700 --> 00:24:12,920
lot of real-world deployments just don't

640
00:24:09,650 --> 00:24:15,470
have that flexibility when it comes to

641
00:24:12,920 --> 00:24:18,050
the networks good practice and if this

642
00:24:15,470 --> 00:24:19,790
is rare but good practice tends to mean

643
00:24:18,050 --> 00:24:21,530
that you have multiple layers of

644
00:24:19,790 --> 00:24:23,720
encryption or authentication across it

645
00:24:21,530 --> 00:24:25,520
so if it's a deployed ATM and it's not

646
00:24:23,720 --> 00:24:27,470
using a physical connection you're using

647
00:24:25,520 --> 00:24:30,440
a private APN network verb for

648
00:24:27,470 --> 00:24:31,940
connectivity on top of that regardless

649
00:24:30,440 --> 00:24:34,550
of your connection you should be using a

650
00:24:31,940 --> 00:24:37,430
robust VPN and over the VPN you should

651
00:24:34,550 --> 00:24:39,230
be using at least TLS 1.2 with mutual

652
00:24:37,430 --> 00:24:41,360
verification of keys across the board

653
00:24:39,230 --> 00:24:43,550
and a good processor and making sure

654
00:24:41,360 --> 00:24:46,790
that those keys are sensibly updated and

655
00:24:43,550 --> 00:24:48,710
managed that being said 30% of the ATMs

656
00:24:46,790 --> 00:24:50,870
that we look at don't authenticate their

657
00:24:48,710 --> 00:24:51,500
back-end properly so for example I go to

658
00:24:50,870 --> 00:24:53,270
let Singh

659
00:24:51,500 --> 00:24:54,770
to generate myself a certificate for

660
00:24:53,270 --> 00:24:56,000
what he's supposedly the legitimate

661
00:24:54,770 --> 00:24:58,490
back-end and do a man-in-the-middle

662
00:24:56,000 --> 00:25:01,580
based on that and that attack simply

663
00:24:58,490 --> 00:25:03,440
works on 30% that allows me to authorize

664
00:25:01,580 --> 00:25:05,480
any transaction that supposedly comes

665
00:25:03,440 --> 00:25:06,650
from the ATM as long as I've done a

666
00:25:05,480 --> 00:25:10,250
little bit of work to reverse-engineer

667
00:25:06,650 --> 00:25:12,200
their particular protocol all those 30%

668
00:25:10,250 --> 00:25:14,450
that don't say authenticate the backend

669
00:25:12,200 --> 00:25:16,130
properly again a lot of them don't use

670
00:25:14,450 --> 00:25:18,020
any application encryption at all so

671
00:25:16,130 --> 00:25:20,750
your card data and the entire

672
00:25:18,020 --> 00:25:22,540
transaction goes completely not only in

673
00:25:20,750 --> 00:25:26,360
the clear but without any form of

674
00:25:22,540 --> 00:25:29,240
authentication to protect it universally

675
00:25:26,360 --> 00:25:30,860
with relatively few exceptions we find

676
00:25:29,240 --> 00:25:35,630
the roots are in networking gear that

677
00:25:30,860 --> 00:25:37,429
connects ATMs is pretty abysmal three or

678
00:25:35,630 --> 00:25:39,740
four different ones that we've looked at

679
00:25:37,430 --> 00:25:41,420
we found zero days in the in the either

680
00:25:39,740 --> 00:25:43,640
the router that they're using to provide

681
00:25:41,420 --> 00:25:45,650
uplink connectivity or in the networking

682
00:25:43,640 --> 00:25:49,760
architecture that connects that ATM to

683
00:25:45,650 --> 00:25:51,590
its back end there are there is best

684
00:25:49,760 --> 00:25:53,240
practice it is easy to avoid but a lot

685
00:25:51,590 --> 00:25:55,760
of vendors and a lot of banks don't

686
00:25:53,240 --> 00:25:57,950
don't implement it properly doing a good

687
00:25:55,760 --> 00:25:59,960
job of the networking security generally

688
00:25:57,950 --> 00:26:01,820
firewalling the ATM is off making sure

689
00:25:59,960 --> 00:26:03,740
they can't see others putting them into

690
00:26:01,820 --> 00:26:05,270
their own virtual LANs or making sure

691
00:26:03,740 --> 00:26:07,850
there is good firewall rules in the case

692
00:26:05,270 --> 00:26:10,610
of ipv6 is something that we just don't

693
00:26:07,850 --> 00:26:12,560
see being done well enough when you're

694
00:26:10,610 --> 00:26:14,479
seeing Windows machines exposing port

695
00:26:12,560 --> 00:26:16,550
four or five you're seeing them exposing

696
00:26:14,480 --> 00:26:18,230
other services because somebody's

697
00:26:16,550 --> 00:26:20,240
decided the bank image should install

698
00:26:18,230 --> 00:26:24,110
TeamViewer and Adobe Acrobat Reader on

699
00:26:20,240 --> 00:26:28,940
it allows for a much larger attack

700
00:26:24,110 --> 00:26:31,129
surface so there is in theory most

701
00:26:28,940 --> 00:26:32,660
organizations have a monitoring

702
00:26:31,130 --> 00:26:34,880
capability they have a security

703
00:26:32,660 --> 00:26:37,070
operation center maybe using tools like

704
00:26:34,880 --> 00:26:38,210
curator or arc site or elasticsearch

705
00:26:37,070 --> 00:26:40,970
that was mentioned in the previous

706
00:26:38,210 --> 00:26:42,740
presentation in reality most of those

707
00:26:40,970 --> 00:26:44,570
who are not monitoring the ATMs

708
00:26:42,740 --> 00:26:46,490
themselves they are monitoring the

709
00:26:44,570 --> 00:26:48,710
banking back-end system so if you

710
00:26:46,490 --> 00:26:50,420
connect the ATM network and then attack

711
00:26:48,710 --> 00:26:52,460
the bank's back-end they all know about

712
00:26:50,420 --> 00:26:54,140
it very quickly but if you connect in

713
00:26:52,460 --> 00:26:56,180
and attack the ATM there's a good chance

714
00:26:54,140 --> 00:26:58,550
you won't be detected because in many of

715
00:26:56,180 --> 00:27:02,110
the cases the ATMs are not providing

716
00:26:58,550 --> 00:27:04,780
logging data up to their abs their SOC

717
00:27:02,110 --> 00:27:06,790
short outages also aren't necessary

718
00:27:04,780 --> 00:27:08,950
followed-up machines get rebooted

719
00:27:06,790 --> 00:27:11,350
somebody trips over a power cable so

720
00:27:08,950 --> 00:27:13,240
when an ATM goes offline and comes back

721
00:27:11,350 --> 00:27:16,060
online it often doesn't trigger any form

722
00:27:13,240 --> 00:27:17,410
of alert that's normally something

723
00:27:16,060 --> 00:27:18,310
though there should be should be

724
00:27:17,410 --> 00:27:20,410
investigated

725
00:27:18,310 --> 00:27:22,419
somebody should consider do I need to

726
00:27:20,410 --> 00:27:24,370
check that ATM hasn't hasn't had any

727
00:27:22,420 --> 00:27:25,900
compromise when it comes back online but

728
00:27:24,370 --> 00:27:29,110
it's very rarely actually done in

729
00:27:25,900 --> 00:27:30,760
practice from what we've seen this is an

730
00:27:29,110 --> 00:27:32,139
example you probably won't be able to

731
00:27:30,760 --> 00:27:33,940
see what's happening in that in the top

732
00:27:32,140 --> 00:27:35,820
and bottom screenshots there but this is

733
00:27:33,940 --> 00:27:38,500
me just doing a man-in-the-middle

734
00:27:35,820 --> 00:27:41,950
interception on the TLS connection of a

735
00:27:38,500 --> 00:27:43,780
channel there below the s tunnel thing

736
00:27:41,950 --> 00:27:45,610
you see in the top screenshot there is a

737
00:27:43,780 --> 00:27:49,570
standard Wireshark dump just showing it

738
00:27:45,610 --> 00:27:52,240
on the one that you see to be right the

739
00:27:49,570 --> 00:27:55,990
that's a standard DSL modem it's a small

740
00:27:52,240 --> 00:27:58,270
face home office modem I found nothing

741
00:27:55,990 --> 00:28:00,910
for patching no other firmware the

742
00:27:58,270 --> 00:28:02,379
vendor that the manufactures it seemed

743
00:28:00,910 --> 00:28:04,870
to wash their hand we at the moment they

744
00:28:02,380 --> 00:28:08,380
kicked it out the door and we see that

745
00:28:04,870 --> 00:28:09,939
with other deployments as well when it

746
00:28:08,380 --> 00:28:11,980
comes to attacking the embedded systems

747
00:28:09,940 --> 00:28:15,520
although there has been some hardening

748
00:28:11,980 --> 00:28:18,010
done a lot of a lot of that can be

749
00:28:15,520 --> 00:28:20,410
bypassed or isn't isn't adopted properly

750
00:28:18,010 --> 00:28:22,060
so for example although the biopsies are

751
00:28:20,410 --> 00:28:23,980
set to not allow booting from external

752
00:28:22,060 --> 00:28:26,620
media in some brands and some models

753
00:28:23,980 --> 00:28:30,130
around 20% of the deployed ones don't

754
00:28:26,620 --> 00:28:31,929
have this BIOS level installed so the

755
00:28:30,130 --> 00:28:34,030
function is there but it's never been

756
00:28:31,930 --> 00:28:36,430
never been updated to use it

757
00:28:34,030 --> 00:28:38,440
swapping the hard drive out is trivial

758
00:28:36,430 --> 00:28:40,120
if you have physical access and this is

759
00:28:38,440 --> 00:28:42,250
probably the most critical problem that

760
00:28:40,120 --> 00:28:44,229
the ATMs have and aren't defending

761
00:28:42,250 --> 00:28:46,780
against at the moment whole disk

762
00:28:44,230 --> 00:28:48,940
encryption would defend against the

763
00:28:46,780 --> 00:28:50,950
majority of Jack botting attacks that we

764
00:28:48,940 --> 00:28:52,600
see currently if somebody isn't able to

765
00:28:50,950 --> 00:28:54,880
get in through the backend banking

766
00:28:52,600 --> 00:28:57,550
Network and they are doing their attack

767
00:28:54,880 --> 00:28:58,960
physically with the ATM if they're doing

768
00:28:57,550 --> 00:29:00,190
the rest of things with best practice

769
00:28:58,960 --> 00:29:01,360
that the whole disk encryption would

770
00:29:00,190 --> 00:29:03,070
pretty much stop everything it would

771
00:29:01,360 --> 00:29:04,959
stop the theft of data it would stop the

772
00:29:03,070 --> 00:29:07,060
ability for cache to be kicked out

773
00:29:04,960 --> 00:29:08,980
through services like XFS all the

774
00:29:07,060 --> 00:29:11,740
drivers of the manufacturer themselves

775
00:29:08,980 --> 00:29:14,410
that being said I have literally never

776
00:29:11,740 --> 00:29:16,150
seen it in the wild it is recommended if

777
00:29:14,410 --> 00:29:17,380
you go to NCR and get their

778
00:29:16,150 --> 00:29:18,410
documentation and recomendation

779
00:29:17,380 --> 00:29:20,750
practices today

780
00:29:18,410 --> 00:29:22,400
boy if you go to die bald and look at

781
00:29:20,750 --> 00:29:25,340
them there is recommendations from the

782
00:29:22,400 --> 00:29:27,320
vendors use hole disk encryption I've

783
00:29:25,340 --> 00:29:29,389
never seen it and from speaking to my

784
00:29:27,320 --> 00:29:32,090
peers there's less we believe less than

785
00:29:29,390 --> 00:29:35,090
10% of the deployed ATM s they actually

786
00:29:32,090 --> 00:29:39,139
use it problem there as I mentioned

787
00:29:35,090 --> 00:29:41,570
earlier the ubiquity of very common and

788
00:29:39,140 --> 00:29:42,950
very similar systems means that once you

789
00:29:41,570 --> 00:29:44,870
can develop an attack for one that

790
00:29:42,950 --> 00:29:47,900
attack is portable too to most of the

791
00:29:44,870 --> 00:29:50,389
others so what why people are able to

792
00:29:47,900 --> 00:29:52,370
attack one ATM if they can get a hard

793
00:29:50,390 --> 00:29:54,590
drive image out they can then create a

794
00:29:52,370 --> 00:29:58,219
new image to attack any other ATM of a

795
00:29:54,590 --> 00:30:00,500
similar model or design good IT hygiene

796
00:29:58,220 --> 00:30:02,030
would protect against a lot of the

797
00:30:00,500 --> 00:30:04,250
attacks that go on to embedded systems

798
00:30:02,030 --> 00:30:05,360
things like patching things like making

799
00:30:04,250 --> 00:30:07,580
sure that a good application

800
00:30:05,360 --> 00:30:10,100
whitelisting is is properly locked down

801
00:30:07,580 --> 00:30:11,899
but again back to the risk-averse nature

802
00:30:10,100 --> 00:30:14,209
of these organizations a lot of them

803
00:30:11,900 --> 00:30:18,620
their ATMs working let's not mess with

804
00:30:14,210 --> 00:30:20,900
it there there are organizations within

805
00:30:18,620 --> 00:30:23,419
banks that's job it is to maintain and

806
00:30:20,900 --> 00:30:25,010
build ata an ATM images and some of them

807
00:30:23,420 --> 00:30:27,740
are actually pretty good now at patching

808
00:30:25,010 --> 00:30:29,240
the OS after some of them were popped

809
00:30:27,740 --> 00:30:31,250
through things like eternal blue and

810
00:30:29,240 --> 00:30:32,930
previous zero exploits allowed them to

811
00:30:31,250 --> 00:30:34,880
totally take over the operating system

812
00:30:32,930 --> 00:30:36,860
banks began to learn quite quickly that

813
00:30:34,880 --> 00:30:39,110
perhaps patching Windows was a good idea

814
00:30:36,860 --> 00:30:41,620
that being said they often forget to

815
00:30:39,110 --> 00:30:44,570
patch all the other ancillary services

816
00:30:41,620 --> 00:30:47,659
amusingly this was not done by myself

817
00:30:44,570 --> 00:30:49,939
but them I this was done by an IBM

818
00:30:47,660 --> 00:30:51,290
company in some research they did they

819
00:30:49,940 --> 00:30:54,260
attacked the application whitelisting

820
00:30:51,290 --> 00:30:56,990
services themselves so McAfee solid-core

821
00:30:54,260 --> 00:31:00,770
gmv and we've done some subsequent work

822
00:30:56,990 --> 00:31:03,080
on those attacking attacking the system

823
00:31:00,770 --> 00:31:04,970
application whitelisting software given

824
00:31:03,080 --> 00:31:07,520
these tend to run as kernel drivers or

825
00:31:04,970 --> 00:31:09,200
as kernel level services tends to give

826
00:31:07,520 --> 00:31:12,139
you quite a unrestricted access to the

827
00:31:09,200 --> 00:31:14,480
machine in that particular instance an

828
00:31:12,140 --> 00:31:16,940
absolutely beautiful attack impersonate

829
00:31:14,480 --> 00:31:18,680
the system that provides the policy and

830
00:31:16,940 --> 00:31:20,000
use that to take over and take over the

831
00:31:18,680 --> 00:31:23,180
ATM of course

832
00:31:20,000 --> 00:31:24,860
big failure there the the whitelisting

833
00:31:23,180 --> 00:31:26,600
solution wasn't configured to properly

834
00:31:24,860 --> 00:31:30,459
validate it was talking to a legitimate

835
00:31:26,600 --> 00:31:32,260
update server so

836
00:31:30,460 --> 00:31:33,640
pulling out a hard drive from an ATM if

837
00:31:32,260 --> 00:31:34,930
it's not an encrypted drive which is

838
00:31:33,640 --> 00:31:36,970
almost always the case you will see

839
00:31:34,930 --> 00:31:39,250
something like this it's a relatively

840
00:31:36,970 --> 00:31:42,580
standard Windows when Windows disk image

841
00:31:39,250 --> 00:31:44,980
and in an attack that we did very very

842
00:31:42,580 --> 00:31:47,590
quick to do pulled the drive out were

843
00:31:44,980 --> 00:31:49,210
edited the registry offline to disable

844
00:31:47,590 --> 00:31:51,550
the application whitelisting services so

845
00:31:49,210 --> 00:31:53,470
we could run our own code extracted the

846
00:31:51,550 --> 00:31:55,450
passwords and usernames just in case we

847
00:31:53,470 --> 00:31:57,970
wanted to use them and replace the shell

848
00:31:55,450 --> 00:32:01,030
with something that we would use to kick

849
00:31:57,970 --> 00:32:06,070
to instruct the instance of the ATM to

850
00:32:01,030 --> 00:32:08,020
keep cash out to us good fun the ATM

851
00:32:06,070 --> 00:32:10,360
hardware so if you're not attacking the

852
00:32:08,020 --> 00:32:11,830
the ATM embedded machine you're not

853
00:32:10,360 --> 00:32:13,780
coming in through the network to attack

854
00:32:11,830 --> 00:32:15,820
a machine or attacking the back ends to

855
00:32:13,780 --> 00:32:17,580
allow the ATM to do things that

856
00:32:15,820 --> 00:32:20,139
otherwise it wouldn't be permitted to do

857
00:32:17,580 --> 00:32:23,710
your other option is to attack the ATM

858
00:32:20,140 --> 00:32:26,860
hardware there are some good defenses in

859
00:32:23,710 --> 00:32:28,680
place to protect ATM hardware so for

860
00:32:26,860 --> 00:32:31,120
example there's mutual authentication

861
00:32:28,680 --> 00:32:33,610
capability between the cash dispenser

862
00:32:31,120 --> 00:32:35,800
and the ATM software that runs to tell

863
00:32:33,610 --> 00:32:38,080
it to do dispensed cash this is part of

864
00:32:35,800 --> 00:32:40,210
the XFS standard to some extent but it

865
00:32:38,080 --> 00:32:42,129
only applies to cash dispensing so if

866
00:32:40,210 --> 00:32:44,110
you want to take over an ATM just to

867
00:32:42,130 --> 00:32:46,570
sniff people's card data and pull their

868
00:32:44,110 --> 00:32:48,520
pin out of the PIN pad those attacks are

869
00:32:46,570 --> 00:32:50,439
still perfectly viable because very few

870
00:32:48,520 --> 00:32:52,660
vendors have anything to do reach

871
00:32:50,440 --> 00:32:55,570
authentication beyond the cash dispenser

872
00:32:52,660 --> 00:32:57,130
in fact I don't know of any currently

873
00:32:55,570 --> 00:33:00,310
deployed models that actually allow you

874
00:32:57,130 --> 00:33:02,470
to configure that a lot of the other

875
00:33:00,310 --> 00:33:04,600
ancillary services that I mentioned so

876
00:33:02,470 --> 00:33:07,450
things like tamper switch is drilling

877
00:33:04,600 --> 00:33:09,250
sensors another another hardware like

878
00:33:07,450 --> 00:33:13,330
the camera for example again almost

879
00:33:09,250 --> 00:33:14,950
universally have no have no form of very

880
00:33:13,330 --> 00:33:19,240
verification of that they are trusted

881
00:33:14,950 --> 00:33:21,520
components that being said with the ATM

882
00:33:19,240 --> 00:33:25,660
hardware you have all of the problems of

883
00:33:21,520 --> 00:33:28,110
an x86 hardware stack and USB and and in

884
00:33:25,660 --> 00:33:30,460
some cases GPIO based interfaces I

885
00:33:28,110 --> 00:33:33,100
personally think that USB was a pretty

886
00:33:30,460 --> 00:33:34,480
bad choice for this it's a it's a

887
00:33:33,100 --> 00:33:38,230
standard it's quite easy to use but it's

888
00:33:34,480 --> 00:33:42,070
very difficult to reliably pull a secure

889
00:33:38,230 --> 00:33:43,929
secure transport mechanism on top the

890
00:33:42,070 --> 00:33:45,580
fact they're using x86 is all

891
00:33:43,929 --> 00:33:47,649
so in issue it opens it up to all of the

892
00:33:45,580 --> 00:33:49,990
attacks that we know apply to the x86

893
00:33:47,649 --> 00:33:51,869
platform Spectre meltdown all the other

894
00:33:49,990 --> 00:33:54,730
issues that you see appliance windows

895
00:33:51,869 --> 00:33:57,189
the other big problem you find with ATM

896
00:33:54,730 --> 00:33:58,450
hardware is internally as you may if I

897
00:33:57,190 --> 00:34:01,509
shoot back to some of these earlier

898
00:33:58,450 --> 00:34:03,490
pictures you may see in here there's a

899
00:34:01,509 --> 00:34:06,129
lot of space towards the back of the

900
00:34:03,490 --> 00:34:07,600
other device so if I do want to leave

901
00:34:06,129 --> 00:34:10,058
things in there there's normally a

902
00:34:07,600 --> 00:34:12,520
significant amount of room even if my

903
00:34:10,059 --> 00:34:14,859
components aren't relatively small in

904
00:34:12,520 --> 00:34:17,230
this particular model you can easily see

905
00:34:14,859 --> 00:34:18,098
where the brown splotches to the right

906
00:34:17,230 --> 00:34:19,929
where the screen is

907
00:34:18,099 --> 00:34:23,079
I could comfortably glue a mobile phone

908
00:34:19,929 --> 00:34:25,540
there or any other piece of hardware and

909
00:34:23,079 --> 00:34:32,319
attach things into the USB data lines to

910
00:34:25,540 --> 00:34:35,649
sniff those okay so the only successful

911
00:34:32,319 --> 00:34:37,839
bakbox attacks we've seen have been well

912
00:34:35,649 --> 00:34:40,270
reported on this is a picture of one of

913
00:34:37,839 --> 00:34:42,699
the devices from Krebs on security in

914
00:34:40,270 --> 00:34:44,589
most cases that mutual authentication is

915
00:34:42,699 --> 00:34:46,750
designed to protect against it but a

916
00:34:44,589 --> 00:34:47,469
large number of organizations simply

917
00:34:46,750 --> 00:34:48,668
don't use it

918
00:34:47,469 --> 00:34:51,040
they don't configure it they don't turn

919
00:34:48,668 --> 00:34:53,049
it on beyond that there are also

920
00:34:51,040 --> 00:34:55,299
weaknesses in the implementation of

921
00:34:53,049 --> 00:34:56,770
those so for example I know one of the

922
00:34:55,299 --> 00:34:57,819
cash dispensers although it fully

923
00:34:56,770 --> 00:34:59,829
supports mutually or think

924
00:34:57,819 --> 00:35:01,779
authentication it will quite happily

925
00:34:59,829 --> 00:35:03,460
expect plaintext instructions that

926
00:35:01,780 --> 00:35:06,819
aren't authenticated and still run them

927
00:35:03,460 --> 00:35:08,349
anyway so using sending your commands

928
00:35:06,819 --> 00:35:09,250
whether they're authenticated not is

929
00:35:08,349 --> 00:35:11,410
entirely optional

930
00:35:09,250 --> 00:35:13,960
even though supposedly it should only

931
00:35:11,410 --> 00:35:16,629
act on authenticated commands

932
00:35:13,960 --> 00:35:19,450
there are also protocol weaknesses so

933
00:35:16,630 --> 00:35:21,220
for example in the key negotiation phase

934
00:35:19,450 --> 00:35:23,020
if you can tamper with the data stream

935
00:35:21,220 --> 00:35:25,089
some of the crypto implementation is

936
00:35:23,020 --> 00:35:27,369
weak and you can abuse the traffic flow

937
00:35:25,089 --> 00:35:30,390
over the USB bus there to prevent them

938
00:35:27,369 --> 00:35:32,559
negotiating secure keys in some cases

939
00:35:30,390 --> 00:35:34,598
I've seen attack where it's possible to

940
00:35:32,559 --> 00:35:37,780
prevent them negotiating a key anything

941
00:35:34,599 --> 00:35:39,040
other than a null key so these sorts of

942
00:35:37,780 --> 00:35:40,660
attacks are practical and they're used

943
00:35:39,040 --> 00:35:43,450
but again they require physical access

944
00:35:40,660 --> 00:35:45,250
inside the other class of attacks that I

945
00:35:43,450 --> 00:35:48,669
haven't spent a lot of time talking on

946
00:35:45,250 --> 00:35:50,950
are ones that where people have attacked

947
00:35:48,670 --> 00:35:53,530
the back end and the ATM is just a way

948
00:35:50,950 --> 00:35:55,480
of extracting cash out I'll talk about

949
00:35:53,530 --> 00:35:57,940
this one with with successful attacks

950
00:35:55,480 --> 00:36:01,660
we've seen now so

951
00:35:57,940 --> 00:36:03,430
most ATM robberies most ATM extraction

952
00:36:01,660 --> 00:36:06,759
of cash involves a physical penetration

953
00:36:03,430 --> 00:36:08,919
of the ATM at some level either still

954
00:36:06,760 --> 00:36:11,380
the brute-force way of using large

955
00:36:08,920 --> 00:36:14,349
hammers explosives or what have you is

956
00:36:11,380 --> 00:36:16,720
the largest successful group of

957
00:36:14,349 --> 00:36:18,789
customers of attacks that we see more

958
00:36:16,720 --> 00:36:21,160
sophisticated attacks these days do

959
00:36:18,789 --> 00:36:23,740
target the embedded PC or the ATM

960
00:36:21,160 --> 00:36:25,868
hardware that being said the most

961
00:36:23,740 --> 00:36:28,779
successful attack in terms of extracting

962
00:36:25,869 --> 00:36:30,700
money from an ATM network involved the

963
00:36:28,780 --> 00:36:32,950
attackers attacking the backend banking

964
00:36:30,700 --> 00:36:34,779
infrastructure removing the daily

965
00:36:32,950 --> 00:36:36,160
withdrawal limits from that account and

966
00:36:34,780 --> 00:36:38,500
giving the account and unlimited

967
00:36:36,160 --> 00:36:40,808
overdraft late so somebody could then go

968
00:36:38,500 --> 00:36:43,690
up to an ATM and rather than having the

969
00:36:40,809 --> 00:36:45,730
300 or 400 or whatever number of euros a

970
00:36:43,690 --> 00:36:48,099
day limit could keep withdrawing cash

971
00:36:45,730 --> 00:36:49,569
out and because they'd updated the

972
00:36:48,099 --> 00:36:52,299
banking system to allow them unlimited

973
00:36:49,569 --> 00:36:54,940
overdraft they were able to continue to

974
00:36:52,299 --> 00:36:56,980
withdraw until they had to leave the ATM

975
00:36:54,940 --> 00:36:59,109
I'll talk about there this person got

976
00:36:56,980 --> 00:37:01,240
caught by the way all this group got

977
00:36:59,109 --> 00:37:02,890
caught and the reason for that is it

978
00:37:01,240 --> 00:37:06,279
actually takes quite a lot of time to

979
00:37:02,890 --> 00:37:07,930
get money out of an ATM the more

980
00:37:06,279 --> 00:37:10,240
sophisticated attacks that we see

981
00:37:07,930 --> 00:37:11,919
generally involve access to the top box

982
00:37:10,240 --> 00:37:14,229
very rarely do we see people actually

983
00:37:11,920 --> 00:37:15,880
targeting the safe itself predominantly

984
00:37:14,230 --> 00:37:19,059
because it's simply not the weakest link

985
00:37:15,880 --> 00:37:21,220
in the chain there are probably about 20

986
00:37:19,059 --> 00:37:23,140
active malware families for ATMs and

987
00:37:21,220 --> 00:37:24,788
many variants of them they call that

988
00:37:23,140 --> 00:37:26,680
middleware layer I talked about to

989
00:37:24,789 --> 00:37:28,720
instruct the dispenser to kick cash out

990
00:37:26,680 --> 00:37:30,940
you can of course write malware that

991
00:37:28,720 --> 00:37:33,098
talks the drivers directly by the vendor

992
00:37:30,940 --> 00:37:34,270
but why make your life difficult if

993
00:37:33,099 --> 00:37:35,589
you're writing a piece of malware for

994
00:37:34,270 --> 00:37:36,910
ATMs you might as well write the

995
00:37:35,589 --> 00:37:39,400
industry standard stuff that will work

996
00:37:36,910 --> 00:37:42,910
everywhere the black box attacks that I

997
00:37:39,400 --> 00:37:46,599
mentioned that the black box attacks I

998
00:37:42,910 --> 00:37:48,368
mentioned here again simple thing but

999
00:37:46,599 --> 00:37:50,799
again if the ATM is configured properly

1000
00:37:48,369 --> 00:37:52,270
you shouldn't be able to use these sorts

1001
00:37:50,799 --> 00:37:53,950
of mechanisms but flaws in the

1002
00:37:52,270 --> 00:37:55,839
implementation and the fact that it's

1003
00:37:53,950 --> 00:37:57,848
often not properly configured and not

1004
00:37:55,839 --> 00:38:00,520
being used means that these attacks do

1005
00:37:57,849 --> 00:38:01,779
work one of the ways I've seen this

1006
00:38:00,520 --> 00:38:03,250
being used and the reason you see this

1007
00:38:01,779 --> 00:38:07,420
one with a mobile phone is this

1008
00:38:03,250 --> 00:38:10,390
particular implant had SMS capability so

1009
00:38:07,420 --> 00:38:11,800
the your attacker could walk up the ATM

1010
00:38:10,390 --> 00:38:13,330
with their mobile phone

1011
00:38:11,800 --> 00:38:15,550
issue a command through an SMS message

1012
00:38:13,330 --> 00:38:17,020
and that would allow that would instruct

1013
00:38:15,550 --> 00:38:19,210
this piece of hardware to tell the

1014
00:38:17,020 --> 00:38:20,470
dispenser to kick money out this also

1015
00:38:19,210 --> 00:38:22,900
meant that it was very quick and they

1016
00:38:20,470 --> 00:38:25,450
could avoid CCTV so they could send the

1017
00:38:22,900 --> 00:38:27,280
message whilst watching the ATM when the

1018
00:38:25,450 --> 00:38:30,129
monies appeared they could walk straight

1019
00:38:27,280 --> 00:38:32,650
past and avoid CCTV cameras but of

1020
00:38:30,130 --> 00:38:35,110
course using Sims and phone means that

1021
00:38:32,650 --> 00:38:37,360
the phone data can be triangulated and

1022
00:38:35,110 --> 00:38:39,040
of course if you can get them on CCTV at

1023
00:38:37,360 --> 00:38:41,410
one point the police have something to

1024
00:38:39,040 --> 00:38:45,370
follow them on but quite a good attack

1025
00:38:41,410 --> 00:38:47,830
that one so of the successful attacks

1026
00:38:45,370 --> 00:38:49,270
the the mode the most successful that we

1027
00:38:47,830 --> 00:38:50,860
currently have are still the physical

1028
00:38:49,270 --> 00:38:53,200
ones but the more sophisticated attacks

1029
00:38:50,860 --> 00:38:55,150
are much more portable and they normally

1030
00:38:53,200 --> 00:38:56,560
involve a lot of components they're not

1031
00:38:55,150 --> 00:38:59,680
just attacking the ATMs they're also

1032
00:38:56,560 --> 00:39:01,840
attacking the backend so whilst I've

1033
00:38:59,680 --> 00:39:03,850
only got a few minutes left I will cover

1034
00:39:01,840 --> 00:39:05,200
again with another warning here what I'm

1035
00:39:03,850 --> 00:39:07,839
about to say you probably shouldn't do

1036
00:39:05,200 --> 00:39:08,879
please don't go pen testing pen testing

1037
00:39:07,840 --> 00:39:11,290
at ATM

1038
00:39:08,880 --> 00:39:12,760
without the owner's permission and be

1039
00:39:11,290 --> 00:39:16,090
aware that if you do getting away with

1040
00:39:12,760 --> 00:39:18,100
it can be difficult that being said if

1041
00:39:16,090 --> 00:39:19,210
you wish to go and attack an ATM these

1042
00:39:18,100 --> 00:39:21,610
are things you probably think about

1043
00:39:19,210 --> 00:39:24,120
beforehand knowing when the ATM is

1044
00:39:21,610 --> 00:39:26,380
refilled with cash is kind of important

1045
00:39:24,120 --> 00:39:28,029
it's all good and dandy when you turn up

1046
00:39:26,380 --> 00:39:29,410
to do your jackpot again ATM and then

1047
00:39:28,030 --> 00:39:32,170
figure out it's only got four hundred

1048
00:39:29,410 --> 00:39:33,759
and twenty euros in it lovely crafted

1049
00:39:32,170 --> 00:39:35,830
attack that's all been done but when you

1050
00:39:33,760 --> 00:39:37,840
turn up and it's not been reloaded with

1051
00:39:35,830 --> 00:39:39,880
cash you're potentially burning quite a

1052
00:39:37,840 --> 00:39:42,730
valuable quite a valuable attack quite

1053
00:39:39,880 --> 00:39:44,350
early on banks will notice having just

1054
00:39:42,730 --> 00:39:46,840
filled an ATM with four hundred thousand

1055
00:39:44,350 --> 00:39:48,370
euros that ATM is dead and empty of in

1056
00:39:46,840 --> 00:39:50,860
the next day that will generally be

1057
00:39:48,370 --> 00:39:53,080
noticed so again not dumping the entire

1058
00:39:50,860 --> 00:39:55,320
ATM of cash is probably something if

1059
00:39:53,080 --> 00:39:57,340
you're trying an attack not to do

1060
00:39:55,320 --> 00:39:58,870
ideally know what it's getting refilled

1061
00:39:57,340 --> 00:40:00,490
with cash and dump a small fraction of

1062
00:39:58,870 --> 00:40:03,819
it and multiply that over many different

1063
00:40:00,490 --> 00:40:06,040
ATMs you will get caught by CCTV a lot

1064
00:40:03,820 --> 00:40:07,930
in almost any Western country you'll be

1065
00:40:06,040 --> 00:40:10,120
caught by row traffic cameras the

1066
00:40:07,930 --> 00:40:12,549
cameras inside the ATM the cameras that

1067
00:40:10,120 --> 00:40:15,190
are positioned around the locations

1068
00:40:12,550 --> 00:40:17,260
where those ATMs are you will get caught

1069
00:40:15,190 --> 00:40:19,300
or audio sensors a lot of the ATMs

1070
00:40:17,260 --> 00:40:21,130
having bill microphones and they'll

1071
00:40:19,300 --> 00:40:23,740
record when the proximity sensors get

1072
00:40:21,130 --> 00:40:25,420
triggered be aware of that police

1073
00:40:23,740 --> 00:40:28,209
services will care they will

1074
00:40:25,420 --> 00:40:30,369
come after you just turning up on site

1075
00:40:28,210 --> 00:40:32,319
and starting to play around with an ATM

1076
00:40:30,369 --> 00:40:34,030
does elicit a response sometimes even if

1077
00:40:32,319 --> 00:40:38,079
you're fully approved and authorized to

1078
00:40:34,030 --> 00:40:39,579
do so physically if your ATM is load you

1079
00:40:38,079 --> 00:40:41,910
with a lot of cash a cash cassette is

1080
00:40:39,579 --> 00:40:45,369
roughly this big about this long holds

1081
00:40:41,910 --> 00:40:46,779
2500 notes so probably about 50,000

1082
00:40:45,369 --> 00:40:47,349
euros at most you know in a full

1083
00:40:46,780 --> 00:40:49,329
cassette

1084
00:40:47,349 --> 00:40:51,730
that's actually quite bulky so if you're

1085
00:40:49,329 --> 00:40:54,099
trying 20 an ATM of cash you have a

1086
00:40:51,730 --> 00:40:55,480
stack of cash about yay big and yay wide

1087
00:40:54,099 --> 00:40:57,190
that you then have to physically get out

1088
00:40:55,480 --> 00:40:58,510
of the work out of the place and of

1089
00:40:57,190 --> 00:41:02,829
course laundering that amount of cash

1090
00:40:58,510 --> 00:41:04,630
can be a challenge also I hear so the

1091
00:41:02,829 --> 00:41:07,599
average ATM has four to six cassettes

1092
00:41:04,630 --> 00:41:09,849
five is quite common you always have one

1093
00:41:07,599 --> 00:41:12,309
cassette reserved cassette is always

1094
00:41:09,849 --> 00:41:14,470
kept explicitly aside for notes that are

1095
00:41:12,309 --> 00:41:16,270
ejected so dispensing that's failed in

1096
00:41:14,470 --> 00:41:18,250
some cases people who've forgotten to

1097
00:41:16,270 --> 00:41:19,750
take money when it's been issued and in

1098
00:41:18,250 --> 00:41:21,900
cases where miss counting has happened

1099
00:41:19,750 --> 00:41:24,549
or there's been an error in the hardware

1100
00:41:21,900 --> 00:41:27,220
briefly how much cash is in the ATM

1101
00:41:24,549 --> 00:41:28,839
depends on where the ATM is located if

1102
00:41:27,220 --> 00:41:30,939
it's in an affluent area you might find

1103
00:41:28,839 --> 00:41:32,680
it's mostly 50 euro notes and 20-year

1104
00:41:30,940 --> 00:41:34,059
notes if it's in a student area you

1105
00:41:32,680 --> 00:41:37,118
might find it's more twenties and tens

1106
00:41:34,059 --> 00:41:39,640
in an airport some ATMs will only stock

1107
00:41:37,119 --> 00:41:42,150
50s depending on the country or in those

1108
00:41:39,640 --> 00:41:44,170
denominations will change anyway

1109
00:41:42,150 --> 00:41:46,569
depending on the loading you may have

1110
00:41:44,170 --> 00:41:49,390
anywhere from two hundred thousand four

1111
00:41:46,569 --> 00:41:50,859
hundred fifty thousand euros if you're

1112
00:41:49,390 --> 00:41:52,690
doing an attack that instructs the

1113
00:41:50,859 --> 00:41:54,880
dispenser so you're going after the ATM

1114
00:41:52,690 --> 00:41:55,809
or you're going ATM in Betty computer or

1115
00:41:54,880 --> 00:41:58,180
you're going after the dispenser

1116
00:41:55,809 --> 00:41:59,530
directly those dispensers have a limits

1117
00:41:58,180 --> 00:42:00,160
of how much cash they can give out at

1118
00:41:59,530 --> 00:42:02,589
any one time

1119
00:42:00,160 --> 00:42:05,308
typically it's 50 notes depending on the

1120
00:42:02,589 --> 00:42:08,200
manufacturer it also takes that

1121
00:42:05,309 --> 00:42:10,119
dispensing device somewhere between 17

1122
00:42:08,200 --> 00:42:11,919
and 20 seconds for most models to count

1123
00:42:10,119 --> 00:42:14,140
those 50 notes and then give them to you

1124
00:42:11,920 --> 00:42:16,869
which means in the best case if you want

1125
00:42:14,140 --> 00:42:18,220
to empty a cassette of 2500 notes you're

1126
00:42:16,869 --> 00:42:19,869
going to be standing in front of it

1127
00:42:18,220 --> 00:42:22,058
whilst it spits cash out every 20

1128
00:42:19,869 --> 00:42:25,030
seconds for somewhere around 15 minutes

1129
00:42:22,059 --> 00:42:27,430
an entire ATM with with five cassettes

1130
00:42:25,030 --> 00:42:31,420
there is 85 minutes that may be a bit

1131
00:42:27,430 --> 00:42:33,129
suspicious detection does happen out of

1132
00:42:31,420 --> 00:42:34,839
service ATMs do get reported and

1133
00:42:33,130 --> 00:42:36,160
somebody's standing in front of an ATM

1134
00:42:34,839 --> 00:42:37,990
spitting out money does tensed your

1135
00:42:36,160 --> 00:42:39,149
attention so just just consider being

1136
00:42:37,990 --> 00:42:43,660
aware of that

1137
00:42:39,150 --> 00:42:46,330
okay so if you are responsible for

1138
00:42:43,660 --> 00:42:47,710
defending ATMs if you are banking

1139
00:42:46,330 --> 00:42:49,540
institution if you're somebody who's

1140
00:42:47,710 --> 00:42:51,640
asked to advise about this or you want

1141
00:42:49,540 --> 00:42:54,070
to get into this field of testing ATMs

1142
00:42:51,640 --> 00:42:55,900
and devising clients what what sort of

1143
00:42:54,070 --> 00:42:58,599
things should you be doing well a lot of

1144
00:42:55,900 --> 00:43:00,250
it comes down to basic IT hygiene and

1145
00:42:58,599 --> 00:43:01,869
just doing the fundamentals properly

1146
00:43:00,250 --> 00:43:03,880
making sure you're using encryption

1147
00:43:01,869 --> 00:43:05,530
properly making sure you are following

1148
00:43:03,880 --> 00:43:08,640
the best practice guidance from the

1149
00:43:05,530 --> 00:43:11,050
vendor who makes that machine that

1150
00:43:08,640 --> 00:43:11,770
fundamentally listen to experts who know

1151
00:43:11,050 --> 00:43:14,920
what they're doing

1152
00:43:11,770 --> 00:43:16,690
that might be a bit self-serving but but

1153
00:43:14,920 --> 00:43:18,730
yeah if you're deploying these pay

1154
00:43:16,690 --> 00:43:20,440
experts whoever they happen to be and

1155
00:43:18,730 --> 00:43:21,790
remember that it's not just the ATM you

1156
00:43:20,440 --> 00:43:23,920
need to protect you need to protect the

1157
00:43:21,790 --> 00:43:26,020
entire complex system around the banking

1158
00:43:23,920 --> 00:43:27,490
infrastructure behind it the people who

1159
00:43:26,020 --> 00:43:29,589
write the image and the people who

1160
00:43:27,490 --> 00:43:31,450
develop and maintain that operating

1161
00:43:29,589 --> 00:43:32,890
system image that goes to the ATM is

1162
00:43:31,450 --> 00:43:35,379
something that needs a lot of scrutiny

1163
00:43:32,890 --> 00:43:37,690
before you ever deploy it pay attention

1164
00:43:35,380 --> 00:43:40,690
to the vendors and their guidance so

1165
00:43:37,690 --> 00:43:42,250
networking gear is universally bad for a

1166
00:43:40,690 --> 00:43:45,700
lot of ATM deployments there are very

1167
00:43:42,250 --> 00:43:48,700
few banking clients that I've had the

1168
00:43:45,700 --> 00:43:50,799
privilege of working with who have spent

1169
00:43:48,700 --> 00:43:53,200
decent money in securing their transport

1170
00:43:50,800 --> 00:43:54,550
the ATM people deploy the ATM and then

1171
00:43:53,200 --> 00:43:55,629
they tell networks email we need to

1172
00:43:54,550 --> 00:43:57,760
speak to this computer out in this

1173
00:43:55,630 --> 00:44:00,250
location and they then go and spend the

1174
00:43:57,760 --> 00:44:03,460
grand sum of $15 in buying something

1175
00:44:00,250 --> 00:44:06,460
like a cheap Chinese LTE router or some

1176
00:44:03,460 --> 00:44:08,530
terrible Taiwanese DSL router the big

1177
00:44:06,460 --> 00:44:10,750
four ATM vendors that I mentioned

1178
00:44:08,530 --> 00:44:12,820
earlier so try an NCR Diebold Nixdorf

1179
00:44:10,750 --> 00:44:15,040
and Hitachi know about all these attacks

1180
00:44:12,820 --> 00:44:16,720
a lot of this stuff isn't new and they

1181
00:44:15,040 --> 00:44:18,580
do have recommendations to mitigate

1182
00:44:16,720 --> 00:44:19,839
against some of them maybe not all of

1183
00:44:18,580 --> 00:44:22,330
them but if you don't bother following

1184
00:44:19,839 --> 00:44:23,619
that best practice then you're you're

1185
00:44:22,330 --> 00:44:27,130
leaving yourself exposed to those

1186
00:44:23,619 --> 00:44:28,690
attacks for your ATM installations my

1187
00:44:27,130 --> 00:44:30,940
personal advice and stuff that often

1188
00:44:28,690 --> 00:44:32,380
isn't properly covered in make sure the

1189
00:44:30,940 --> 00:44:34,060
physical installation is really up to

1190
00:44:32,380 --> 00:44:36,310
snuff most of the sophisticated

1191
00:44:34,060 --> 00:44:38,320
technical attacks and nearly all the

1192
00:44:36,310 --> 00:44:40,330
physical attacks require a reason about

1193
00:44:38,320 --> 00:44:41,770
a physical access to the machine so if

1194
00:44:40,330 --> 00:44:43,660
the thing is properly concreted into a

1195
00:44:41,770 --> 00:44:45,520
wall and not plasterboard it on the side

1196
00:44:43,660 --> 00:44:47,589
if the furniture is nailed into the

1197
00:44:45,520 --> 00:44:49,359
floor and the cables go directly down

1198
00:44:47,589 --> 00:44:51,400
from the ATM and not out the back song

1199
00:44:49,359 --> 00:44:52,240
where you dramatically limit the scope

1200
00:44:51,400 --> 00:44:53,920
for somebody's

1201
00:44:52,240 --> 00:44:56,500
pull off an attack make sure it's

1202
00:44:53,920 --> 00:44:58,660
covered by CCTV make sure that you have

1203
00:44:56,500 --> 00:45:01,810
a process around how you manage

1204
00:44:58,660 --> 00:45:03,609
detecting attacks on that ATM so if the

1205
00:45:01,810 --> 00:45:05,200
sensors are triggered make sure it goes

1206
00:45:03,609 --> 00:45:07,089
through a security operation center that

1207
00:45:05,200 --> 00:45:09,399
has a checklist they follows make sure

1208
00:45:07,089 --> 00:45:12,190
for the love of God use full disk

1209
00:45:09,400 --> 00:45:13,869
encryption store the keys in TPM module

1210
00:45:12,190 --> 00:45:16,060
store them on the network but use some

1211
00:45:13,869 --> 00:45:19,240
kind of full disk encryption that will

1212
00:45:16,060 --> 00:45:21,460
prevent an awful lot of attacks again

1213
00:45:19,240 --> 00:45:23,259
registering your machine not only to

1214
00:45:21,460 --> 00:45:25,570
kick money out but it will also prevent

1215
00:45:23,260 --> 00:45:27,790
a lot of compromise of your back end so

1216
00:45:25,570 --> 00:45:30,820
revealing sort of keys IP addresses and

1217
00:45:27,790 --> 00:45:32,259
other things for the ATM system images

1218
00:45:30,820 --> 00:45:34,150
if they're being if they're being

1219
00:45:32,260 --> 00:45:36,550
crafted in-house and most of them are

1220
00:45:34,150 --> 00:45:38,320
minimized the software follows general

1221
00:45:36,550 --> 00:45:41,050
good practice guidance about turning off

1222
00:45:38,320 --> 00:45:43,240
unnecessary services don't install junk

1223
00:45:41,050 --> 00:45:45,700
there is no reason for PowerPoint to be

1224
00:45:43,240 --> 00:45:47,680
installed on an ATM image I have seen

1225
00:45:45,700 --> 00:45:49,960
this there is no point for Adobe Reader

1226
00:45:47,680 --> 00:45:52,029
or Team Viewer to be installed I have

1227
00:45:49,960 --> 00:45:53,770
seen this I have even seen computer

1228
00:45:52,030 --> 00:45:55,990
games installed in some images that were

1229
00:45:53,770 --> 00:45:58,119
pushed out to ATMs it's not a good idea

1230
00:45:55,990 --> 00:45:59,740
so follow good best practice around

1231
00:45:58,119 --> 00:46:01,210
minimizing those sorts of things and

1232
00:45:59,740 --> 00:46:03,609
make sure that that software is

1233
00:46:01,210 --> 00:46:05,650
regularly patched and updated have a

1234
00:46:03,609 --> 00:46:07,569
testing function to do that and have a

1235
00:46:05,650 --> 00:46:09,400
small series of testing ATMs that you

1236
00:46:07,570 --> 00:46:11,890
test that image on before deploying it

1237
00:46:09,400 --> 00:46:13,930
across the entire network encryption

1238
00:46:11,890 --> 00:46:15,819
should be used everywhere for everything

1239
00:46:13,930 --> 00:46:17,770
all of the backend traffic all our

1240
00:46:15,820 --> 00:46:19,510
traffic that comes from that atm with

1241
00:46:17,770 --> 00:46:21,400
the possible exception of it looking for

1242
00:46:19,510 --> 00:46:23,619
our printing of that nature in which

1243
00:46:21,400 --> 00:46:25,000
case it should be using a static IP and

1244
00:46:23,619 --> 00:46:26,530
it should be shutting itself down and

1245
00:46:25,000 --> 00:46:28,900
not doing anything if it's detecting art

1246
00:46:26,530 --> 00:46:31,240
poisoning yes some ATMs are vulnerable

1247
00:46:28,900 --> 00:46:33,520
to art poisoning using the encryption

1248
00:46:31,240 --> 00:46:35,049
ubiquitously for everything is kind of

1249
00:46:33,520 --> 00:46:37,630
key and making sure it's mutually

1250
00:46:35,050 --> 00:46:39,310
verified don't just trust a certificate

1251
00:46:37,630 --> 00:46:41,080
from a trusted store make sure it's a

1252
00:46:39,310 --> 00:46:43,180
pin certificate to your back-end and

1253
00:46:41,080 --> 00:46:44,680
finally although there are flaws of

1254
00:46:43,180 --> 00:46:47,440
application whitelisting init is not a

1255
00:46:44,680 --> 00:46:51,098
panacea if you do a good policy if you

1256
00:46:47,440 --> 00:46:52,990
do a tight a policy for for your ATM and

1257
00:46:51,099 --> 00:46:54,700
you make sure the only trusted services

1258
00:46:52,990 --> 00:46:56,229
can run combined with whole disk

1259
00:46:54,700 --> 00:46:58,779
encryption that prevent that being

1260
00:46:56,230 --> 00:47:00,580
turned off you incredibly well limit the

1261
00:46:58,780 --> 00:47:03,099
scope for any kind of external attack

1262
00:47:00,580 --> 00:47:05,890
based off the network or on any local

1263
00:47:03,099 --> 00:47:10,220
compromise from being able to escalate

1264
00:47:05,890 --> 00:47:13,700
okay folks an awful lot about this I'll

1265
00:47:10,220 --> 00:47:15,290
summarize briefly concerns that are

1266
00:47:13,700 --> 00:47:18,379
going to apply in the future and then I

1267
00:47:15,290 --> 00:47:20,450
will Alfre open for questions right now

1268
00:47:18,380 --> 00:47:22,340
there needs to be some work on the

1269
00:47:20,450 --> 00:47:23,720
standard that middleware layer that XFS

1270
00:47:22,340 --> 00:47:25,550
that allow is portable attacks

1271
00:47:23,720 --> 00:47:27,950
doesn't have enough focus on security

1272
00:47:25,550 --> 00:47:29,630
there is some work being done to try and

1273
00:47:27,950 --> 00:47:32,259
extend for example mutual authentication

1274
00:47:29,630 --> 00:47:35,150
to other components but fundamentally

1275
00:47:32,260 --> 00:47:37,010
pentesters ethical hackers and people

1276
00:47:35,150 --> 00:47:38,900
who know about security have not focused

1277
00:47:37,010 --> 00:47:40,940
too much on on this standard in the past

1278
00:47:38,900 --> 00:47:43,250
the standard does need some work to

1279
00:47:40,940 --> 00:47:45,440
invent to harden it there is some

1280
00:47:43,250 --> 00:47:47,660
suggestion that they're going to try and

1281
00:47:45,440 --> 00:47:49,550
make sure software has to authenticate

1282
00:47:47,660 --> 00:47:51,049
itself to call this but I don't know how

1283
00:47:49,550 --> 00:47:53,300
practical that that's actually is going

1284
00:47:51,050 --> 00:47:56,360
to be default passwords are still

1285
00:47:53,300 --> 00:47:57,950
endemic for a lot of them admittedly to

1286
00:47:56,360 --> 00:48:00,230
be able to even use them you often need

1287
00:47:57,950 --> 00:48:02,240
some kind of physical access but again

1288
00:48:00,230 --> 00:48:04,250
there is no excuse in any production

1289
00:48:02,240 --> 00:48:06,049
system for default passwords to be used

1290
00:48:04,250 --> 00:48:09,230
the maintained opinion for some of them

1291
00:48:06,050 --> 00:48:11,270
is still set to eight zeros although

1292
00:48:09,230 --> 00:48:12,560
that may not allow although that may

1293
00:48:11,270 --> 00:48:14,270
mean that they've already got some kind

1294
00:48:12,560 --> 00:48:16,970
of physical access if you have used

1295
00:48:14,270 --> 00:48:19,370
whole drive encryption and and your

1296
00:48:16,970 --> 00:48:21,410
attacker hasn't got any other way of

1297
00:48:19,370 --> 00:48:23,330
getting into another application other

1298
00:48:21,410 --> 00:48:25,190
than the other than the normal use land

1299
00:48:23,330 --> 00:48:27,560
application if you leave a default

1300
00:48:25,190 --> 00:48:29,420
password in place something like for

1301
00:48:27,560 --> 00:48:31,100
example the default maintainer pin they

1302
00:48:29,420 --> 00:48:33,200
suddenly now have access to an entirely

1303
00:48:31,100 --> 00:48:34,940
new application that gives an awful lot

1304
00:48:33,200 --> 00:48:36,890
more capability and then to interact

1305
00:48:34,940 --> 00:48:38,420
with the system and also it tends to be

1306
00:48:36,890 --> 00:48:41,509
a trusted applications they can bypass

1307
00:48:38,420 --> 00:48:42,950
other system protections in place none

1308
00:48:41,510 --> 00:48:45,860
of the attacks I've talked about here

1309
00:48:42,950 --> 00:48:48,310
are a new none of them are specific 20

1310
00:48:45,860 --> 00:48:51,500
ATM they're all particularly portable

1311
00:48:48,310 --> 00:48:54,380
with that the banks should look into

1312
00:48:51,500 --> 00:48:55,820
whether whether that makes sense to be

1313
00:48:54,380 --> 00:48:57,590
locked down into a more just one or

1314
00:48:55,820 --> 00:48:59,750
specific vendor there may need to be

1315
00:48:57,590 --> 00:49:01,970
more heterogeneous deployments if you're

1316
00:48:59,750 --> 00:49:05,660
looking at wide scale reliability and

1317
00:49:01,970 --> 00:49:06,560
security final point a lot of people do

1318
00:49:05,660 --> 00:49:08,299
tend to think we're moving away from

1319
00:49:06,560 --> 00:49:09,740
cache and it's true in many economies we

1320
00:49:08,300 --> 00:49:12,110
are moving away from cached based

1321
00:49:09,740 --> 00:49:15,259
transactions so touch pay credit card

1322
00:49:12,110 --> 00:49:16,100
transactions is still is gaining more

1323
00:49:15,260 --> 00:49:18,800
and more traction

1324
00:49:16,100 --> 00:49:21,049
that being said ATMs are evolved

1325
00:49:18,800 --> 00:49:23,120
with this ATMs these days top-up mobile

1326
00:49:21,050 --> 00:49:25,010
phones you can make charity donations to

1327
00:49:23,120 --> 00:49:27,200
some of them some of them you can be

1328
00:49:25,010 --> 00:49:29,810
used now to buy gift cards various shops

1329
00:49:27,200 --> 00:49:31,520
and other things so the cash is still

1330
00:49:29,810 --> 00:49:35,509
very important and ATMs are still very

1331
00:49:31,520 --> 00:49:37,460
much a target not just in places like in

1332
00:49:35,510 --> 00:49:39,230
Asia in South America and Latin America

1333
00:49:37,460 --> 00:49:41,330
but we're also seeing I mean Europe

1334
00:49:39,230 --> 00:49:43,190
being actively targeted as well the

1335
00:49:41,330 --> 00:49:44,270
biggest preventer of attacks being done

1336
00:49:43,190 --> 00:49:45,650
in Europe is that we tend to have

1337
00:49:44,270 --> 00:49:48,800
reasonably good police forces that

1338
00:49:45,650 --> 00:49:52,160
aren't corrupt that being said that

1339
00:49:48,800 --> 00:49:55,900
they're still being targeted so thank

1340
00:49:52,160 --> 00:49:55,899
you very much I appreciate that was a

