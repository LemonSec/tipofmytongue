1
00:01:20,909 --> 00:01:26,939
like malware<font color="#E5E5E5"> articles</font><font color="#CCCCCC"> I'm not I'm not</font>

2
00:01:24,420 --> 00:01:28,500
showing<font color="#E5E5E5"> how to make malware but just an</font>

3
00:01:26,939 --> 00:01:31,919
analysis of the malware

4
00:01:28,500 --> 00:01:35,970
<font color="#E5E5E5">okay I also write some articles in our</font>

5
00:01:31,920 --> 00:01:38,070
blog post<font color="#CCCCCC"> that is actually</font><font color="#E5E5E5"> the sales</font>

6
00:01:35,970 --> 00:01:41,940
pitch and then the<font color="#E5E5E5"> said no more normal</font>

7
00:01:38,070 --> 00:01:44,520
says<font color="#E5E5E5"> I was a was they meet me at by one</font>

8
00:01:41,940 --> 00:01:49,229
<font color="#CCCCCC">of the Advisory Committee of</font><font color="#E5E5E5"> DEP</font><font color="#CCCCCC"> cam</font>

9
00:01:44,520 --> 00:01:51,000
there is in<font color="#E5E5E5"> Romanian</font><font color="#CCCCCC"> Conference</font><font color="#E5E5E5"> okay</font>

10
00:01:49,229 --> 00:01:54,300
most<font color="#E5E5E5"> of the</font><font color="#CCCCCC"> time</font><font color="#E5E5E5"> I used the other</font>

11
00:01:51,000 --> 00:01:57,300
picture as my profile pic but<font color="#E5E5E5"> this one</font>

12
00:01:54,300 --> 00:02:01,880
is the<font color="#E5E5E5"> the</font><font color="#CCCCCC"> prepared</font><font color="#E5E5E5"> version that's how I</font>

13
00:01:57,300 --> 00:02:01,880
feel when<font color="#E5E5E5"> I do analysis</font><font color="#CCCCCC"> Pedroia analysis</font>

14
00:02:02,119 --> 00:02:08,399
and those are some<font color="#E5E5E5"> of the</font><font color="#CCCCCC"> talk on</font><font color="#E5E5E5"> press</font>

15
00:02:05,729 --> 00:02:13,560
that I've been<font color="#E5E5E5"> with and sorry safety I</font>

16
00:02:08,399 --> 00:02:20,489
put<font color="#CCCCCC"> it's in the lower part how many of</font>

17
00:02:13,560 --> 00:02:23,030
you<font color="#E5E5E5"> obscene</font><font color="#CCCCCC"> a ploppies</font><font color="#E5E5E5"> don't be shy my</font>

18
00:02:20,489 --> 00:02:26,850
favorite one is<font color="#CCCCCC"> the three point pipe</font>

19
00:02:23,030 --> 00:02:28,200
<font color="#E5E5E5">during</font><font color="#CCCCCC"> my university years because</font><font color="#E5E5E5"> that</font>

20
00:02:26,850 --> 00:02:30,000
one<font color="#CCCCCC"> is not too</font><font color="#E5E5E5"> floppy</font>

21
00:02:28,200 --> 00:02:32,640
it's called plop it is because you can

22
00:02:30,000 --> 00:02:35,519
actually<font color="#E5E5E5"> bend it and then</font><font color="#CCCCCC"> that's</font><font color="#E5E5E5"> it but</font>

23
00:02:32,640 --> 00:02:38,309
the three point pipe is actually<font color="#E5E5E5"> harder</font>

24
00:02:35,519 --> 00:02:42,570
than<font color="#CCCCCC"> the other one</font><font color="#E5E5E5"> okay</font>

25
00:02:38,310 --> 00:02:47,370
but looking at the at this picture it it

26
00:02:42,570 --> 00:02:51,329
is<font color="#E5E5E5"> actually a one gig storage device but</font>

27
00:02:47,370 --> 00:02:55,019
it is also<font color="#E5E5E5"> 75 pounds imagine you can</font>

28
00:02:51,329 --> 00:02:59,220
imagine<font color="#CCCCCC"> a one gig</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> you can put in</font>

29
00:02:55,019 --> 00:03:01,709
your in your<font color="#E5E5E5"> key</font><font color="#CCCCCC"> on your</font><font color="#E5E5E5"> pocket right so</font>

30
00:02:59,220 --> 00:03:04,079
it's like<font color="#CCCCCC"> like</font><font color="#E5E5E5"> during that time you</font>

31
00:03:01,709 --> 00:03:07,560
should<font color="#CCCCCC"> be very very</font><font color="#E5E5E5"> strong just to carry</font>

32
00:03:04,079 --> 00:03:10,470
<font color="#E5E5E5">a one gig in your pocket but now okay</font>

33
00:03:07,560 --> 00:03:15,390
<font color="#E5E5E5">you can buy this this guy which is</font>

34
00:03:10,470 --> 00:03:18,540
<font color="#E5E5E5">actually 256 times of this but a bit</font>

35
00:03:15,390 --> 00:03:20,578
smaller<font color="#CCCCCC"> right you can now carry more</font>

36
00:03:18,540 --> 00:03:24,530
<font color="#CCCCCC">than that you can even carry probably</font>

37
00:03:20,579 --> 00:03:27,540
one<font color="#E5E5E5"> terabyte so of that 75 pounds</font>

38
00:03:24,530 --> 00:03:29,820
equivalent<font color="#E5E5E5"> anyway I just mentioned that</font>

39
00:03:27,540 --> 00:03:32,850
<font color="#CCCCCC">because we're going</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> look</font><font color="#E5E5E5"> into the</font>

40
00:03:29,820 --> 00:03:34,769
boot sector of those things<font color="#CCCCCC"> k even</font><font color="#E5E5E5"> if</font>

41
00:03:32,850 --> 00:03:37,260
you're using a properties or

42
00:03:34,770 --> 00:03:39,960
you're talking<font color="#CCCCCC"> about the hard drive they</font>

43
00:03:37,260 --> 00:03:42,929
both hub<font color="#E5E5E5"> a boot sector boot sector</font>

44
00:03:39,960 --> 00:03:45,300
mostly is the<font color="#CCCCCC"> very</font><font color="#E5E5E5"> per sector</font><font color="#CCCCCC"> of pure</font>

45
00:03:42,930 --> 00:03:48,480
<font color="#E5E5E5">drive so if</font><font color="#CCCCCC"> your is talking about the</font>

46
00:03:45,300 --> 00:03:50,340
<font color="#CCCCCC">pleiades</font><font color="#E5E5E5"> the very</font><font color="#CCCCCC"> per sector</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> actually</font>

47
00:03:48,480 --> 00:03:53,369
the boot sector<font color="#E5E5E5"> but if you're talking</font>

48
00:03:50,340 --> 00:03:57,450
<font color="#E5E5E5">about the hard drive there is what</font><font color="#CCCCCC"> we</font>

49
00:03:53,370 --> 00:04:00,600
<font color="#CCCCCC">call the MBR the Master Boot Record okay</font>

50
00:03:57,450 --> 00:04:03,329
so but the very<font color="#E5E5E5"> first one okay where the</font>

51
00:04:00,600 --> 00:04:06,090
hard drive is actually<font color="#E5E5E5"> the MBR and then</font>

52
00:04:03,330 --> 00:04:08,550
each partition<font color="#E5E5E5"> actually the MBR only can</font>

53
00:04:06,090 --> 00:04:10,910
contain<font color="#E5E5E5"> poor partitions</font><font color="#CCCCCC"> at any given</font>

54
00:04:08,550 --> 00:04:15,240
time<font color="#E5E5E5"> and then they can have your own</font>

55
00:04:10,910 --> 00:04:18,420
different<font color="#CCCCCC"> boot sector</font><font color="#E5E5E5"> okay and we</font>

56
00:04:15,240 --> 00:04:20,880
<font color="#E5E5E5">usually talk about</font><font color="#CCCCCC"> the cylinder head and</font>

57
00:04:18,420 --> 00:04:27,360
sector<font color="#CCCCCC"> okay so that is zero zero one</font>

58
00:04:20,880 --> 00:04:30,960
<font color="#CCCCCC">pour the MBR in the boot sector how do</font>

59
00:04:27,360 --> 00:04:33,110
you create an MBR<font color="#E5E5E5"> and what is a GPT</font>

60
00:04:30,960 --> 00:04:35,580
there is no a new version of

61
00:04:33,110 --> 00:04:37,110
partitioning<font color="#CCCCCC"> for your hard drive</font><font color="#E5E5E5"> okay of</font>

62
00:04:35,580 --> 00:04:39,990
course probably<font color="#CCCCCC"> you already</font><font color="#E5E5E5"> know them</font>

63
00:04:37,110 --> 00:04:42,960
<font color="#E5E5E5">okay for the NVR the very</font><font color="#CCCCCC"> first sector</font>

64
00:04:39,990 --> 00:04:46,140
<font color="#E5E5E5">is the Master Boot Record you can create</font>

65
00:04:42,960 --> 00:04:49,260
poor partitions for<font color="#E5E5E5"> the GPT it is mostly</font>

66
00:04:46,140 --> 00:04:51,440
used<font color="#CCCCCC"> by if you're trying to use the</font><font color="#E5E5E5"> UEFI</font>

67
00:04:49,260 --> 00:04:54,719
mostly new computers now they have the

68
00:04:51,440 --> 00:04:57,420
UEFI then you have to<font color="#E5E5E5"> create a</font><font color="#CCCCCC"> GB teeth</font>

69
00:04:54,720 --> 00:05:00,990
<font color="#CCCCCC">with partition table the main difference</font>

70
00:04:57,420 --> 00:05:05,040
<font color="#E5E5E5">of those things is for GPT you can</font>

71
00:05:00,990 --> 00:05:07,200
<font color="#E5E5E5">create many burp or MBR you can only</font>

72
00:05:05,040 --> 00:05:09,750
have you are limited<font color="#CCCCCC"> poor poor partition</font>

73
00:05:07,200 --> 00:05:11,670
<font color="#CCCCCC">okay if you want more partitions you</font>

74
00:05:09,750 --> 00:05:15,000
have to create logical<font color="#E5E5E5"> partitions for</font>

75
00:05:11,670 --> 00:05:18,690
the MBR but<font color="#E5E5E5"> with the GPT you can create</font>

76
00:05:15,000 --> 00:05:20,910
as many partitions as one okay<font color="#E5E5E5"> and of</font>

77
00:05:18,690 --> 00:05:24,920
course<font color="#E5E5E5"> the poor backward compatibility</font>

78
00:05:20,910 --> 00:05:27,660
<font color="#E5E5E5">the very</font><font color="#CCCCCC"> poor</font><font color="#E5E5E5"> sector is now called</font>

79
00:05:24,920 --> 00:05:30,150
protective and we are very<font color="#E5E5E5"> still an MBR</font>

80
00:05:27,660 --> 00:05:33,540
and the second<font color="#CCCCCC"> sector is actually</font><font color="#E5E5E5"> the</font>

81
00:05:30,150 --> 00:05:35,729
header<font color="#E5E5E5"> for the GPT</font><font color="#CCCCCC"> okay actually there's</font>

82
00:05:33,540 --> 00:05:40,590
another the second and the last sectors

83
00:05:35,730 --> 00:05:42,270
are actually the GPT headers if you're

84
00:05:40,590 --> 00:05:44,780
going<font color="#E5E5E5"> to use a tool called this</font>

85
00:05:42,270 --> 00:05:48,150
<font color="#E5E5E5">management it is available for Windows</font>

86
00:05:44,780 --> 00:05:51,150
you can<font color="#E5E5E5"> create a partition or</font><font color="#CCCCCC"> add</font>

87
00:05:48,150 --> 00:05:57,120
yes you can initiate<font color="#E5E5E5"> your</font><font color="#CCCCCC"> dis us MBR or</font>

88
00:05:51,150 --> 00:05:59,969
you can initiate a dis us<font color="#E5E5E5"> GPT</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> you</font>

89
00:05:57,120 --> 00:06:02,640
can<font color="#CCCCCC"> select whatever you</font><font color="#E5E5E5"> want to to do</font>

90
00:05:59,970 --> 00:06:06,390
but if you<font color="#E5E5E5"> happen to change your mind in</font>

91
00:06:02,640 --> 00:06:09,960
the<font color="#CCCCCC"> middle of your computing okay you</font>

92
00:06:06,390 --> 00:06:13,650
can convert the MBR to GPT<font color="#E5E5E5"> and you can</font>

93
00:06:09,960 --> 00:06:16,159
convert<font color="#CCCCCC"> your MBR</font><font color="#E5E5E5"> to or GPT to MBR but</font>

94
00:06:13,650 --> 00:06:18,780
there is a risk<font color="#CCCCCC"> if you already have put</font>

95
00:06:16,160 --> 00:06:22,320
information<font color="#E5E5E5"> or your data or your</font>

96
00:06:18,780 --> 00:06:26,909
pictures your videos<font color="#E5E5E5"> in a certain this</font>

97
00:06:22,320 --> 00:06:28,800
partitions or this this are<font color="#E5E5E5"> different</font>

98
00:06:26,910 --> 00:06:31,620
this for<font color="#E5E5E5"> example you have the MBR and</font>

99
00:06:28,800 --> 00:06:33,540
then you<font color="#E5E5E5"> decided to change it to GPT</font>

100
00:06:31,620 --> 00:06:40,320
<font color="#CCCCCC">there is a chance that you will</font><font color="#E5E5E5"> lose</font>

101
00:06:33,540 --> 00:06:42,810
your your videos so<font color="#CCCCCC"> just be careful okay</font>

102
00:06:40,320 --> 00:06:45,750
let's show now how how those things are

103
00:06:42,810 --> 00:06:49,620
separated so<font color="#CCCCCC"> this one</font><font color="#E5E5E5"> for this one I</font>

104
00:06:45,750 --> 00:06:51,900
created<font color="#E5E5E5"> an MBR version this</font><font color="#CCCCCC"> okay so you</font>

105
00:06:49,620 --> 00:06:54,540
can see<font color="#CCCCCC"> that we I only</font><font color="#E5E5E5"> have four</font>

106
00:06:51,900 --> 00:06:56,969
partitions<font color="#CCCCCC"> okay this one is</font><font color="#E5E5E5"> actually</font>

107
00:06:54,540 --> 00:06:59,670
<font color="#CCCCCC">actually</font><font color="#E5E5E5"> one partition but</font><font color="#CCCCCC"> they</font>

108
00:06:56,970 --> 00:07:02,730
different it has different logical

109
00:06:59,670 --> 00:07:05,520
partitions for<font color="#E5E5E5"> this - okay you can</font>

110
00:07:02,730 --> 00:07:09,510
create as many partitions as you want

111
00:07:05,520 --> 00:07:12,000
okay beep or<font color="#E5E5E5"> beep we usually have</font>

112
00:07:09,510 --> 00:07:14,849
partitions in order<font color="#E5E5E5"> to make your</font>

113
00:07:12,000 --> 00:07:17,610
processing faster<font color="#E5E5E5"> but nowadays because</font>

114
00:07:14,850 --> 00:07:20,430
<font color="#CCCCCC">you have a faster machine</font><font color="#E5E5E5"> compared to</font>

115
00:07:17,610 --> 00:07:22,680
the like<font color="#CCCCCC"> ten years ten years ago</font><font color="#E5E5E5"> okay</font>

116
00:07:20,430 --> 00:07:24,210
your<font color="#E5E5E5"> your machines is</font><font color="#CCCCCC"> faster now so</font>

117
00:07:22,680 --> 00:07:27,240
basically<font color="#CCCCCC"> you don't</font><font color="#E5E5E5"> actually need to</font>

118
00:07:24,210 --> 00:07:29,510
<font color="#CCCCCC">make</font><font color="#E5E5E5"> partitions actually my my</font>

119
00:07:27,240 --> 00:07:33,030
<font color="#CCCCCC">computer's at</font><font color="#E5E5E5"> home I don't</font><font color="#CCCCCC"> usually use</font>

120
00:07:29,510 --> 00:07:37,050
partitions anymore but<font color="#CCCCCC"> is still up to</font>

121
00:07:33,030 --> 00:07:39,059
<font color="#E5E5E5">you right for fun okay so this one is</font>

122
00:07:37,050 --> 00:07:40,620
the<font color="#E5E5E5"> important be</font><font color="#CCCCCC"> your primary partitions</font>

123
00:07:39,060 --> 00:07:44,550
<font color="#E5E5E5">and these are the</font><font color="#CCCCCC"> logical extended</font>

124
00:07:40,620 --> 00:07:47,190
partitions for<font color="#CCCCCC"> Jeep for GPT everything</font>

125
00:07:44,550 --> 00:07:49,560
is primary partitions<font color="#CCCCCC"> you can still</font>

126
00:07:47,190 --> 00:07:53,070
<font color="#E5E5E5">create logical partition everyone</font><font color="#CCCCCC"> okay</font>

127
00:07:49,560 --> 00:07:55,650
there's another<font color="#E5E5E5"> tool in in Windows you</font>

128
00:07:53,070 --> 00:07:59,190
<font color="#CCCCCC">call that the disk partition this</font><font color="#E5E5E5"> part</font>

129
00:07:55,650 --> 00:08:02,128
<font color="#E5E5E5">okay if you run it if you found this</font>

130
00:07:59,190 --> 00:08:05,099
asterisk<font color="#E5E5E5"> K</font><font color="#CCCCCC"> that means it</font><font color="#E5E5E5"> is</font>

131
00:08:02,129 --> 00:08:06,989
<font color="#CCCCCC">GPD</font><font color="#E5E5E5"> okay those are</font><font color="#CCCCCC"> just the different</font><font color="#E5E5E5"> of</font>

132
00:08:05,099 --> 00:08:09,449
<font color="#E5E5E5">that you can check if you</font><font color="#CCCCCC"> want to check</font>

133
00:08:06,989 --> 00:08:11,698
<font color="#E5E5E5">if your hard drive is</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> partition as</font>

134
00:08:09,449 --> 00:08:16,199
can be our GPT<font color="#E5E5E5"> okay what are now the</font>

135
00:08:11,699 --> 00:08:19,349
<font color="#E5E5E5">differences okay</font><font color="#CCCCCC"> for MBR we</font><font color="#E5E5E5"> called the</font>

136
00:08:16,199 --> 00:08:23,909
<font color="#E5E5E5">sectors in cylinder head sector</font>

137
00:08:19,349 --> 00:08:27,748
addressing<font color="#E5E5E5"> CHS for GPT we call them</font><font color="#CCCCCC"> LBA</font>

138
00:08:23,909 --> 00:08:29,399
<font color="#CCCCCC">okay logical block</font><font color="#E5E5E5"> addressing and of</font>

139
00:08:27,749 --> 00:08:31,379
course you<font color="#E5E5E5"> should</font><font color="#CCCCCC"> have</font><font color="#E5E5E5"> you can have a</font>

140
00:08:29,399 --> 00:08:33,899
partition<font color="#E5E5E5"> you can have the table for</font>

141
00:08:31,379 --> 00:08:36,539
<font color="#CCCCCC">porkin conversion of the computations</font>

142
00:08:33,899 --> 00:08:41,219
<font color="#CCCCCC">okay</font><font color="#E5E5E5"> why are we talking about those</font>

143
00:08:36,539 --> 00:08:45,779
things because<font color="#CCCCCC"> of this guy have you</font>

144
00:08:41,219 --> 00:08:48,990
<font color="#CCCCCC">heard of</font><font color="#E5E5E5"> it yeah it is actually</font><font color="#CCCCCC"> the</font>

145
00:08:45,779 --> 00:08:51,540
right prom from a movie James Bond movie

146
00:08:48,990 --> 00:08:53,730
<font color="#E5E5E5">okay the satellite thing it's called</font>

147
00:08:51,540 --> 00:08:56,370
<font color="#E5E5E5">petia but this guy we're going to talk</font>

148
00:08:53,730 --> 00:09:00,300
<font color="#E5E5E5">about the petia ransomware</font>

149
00:08:56,370 --> 00:09:02,670
okay<font color="#E5E5E5"> execution flow okay the new</font>

150
00:09:00,300 --> 00:09:07,310
executable image when<font color="#CCCCCC"> you execute</font><font color="#E5E5E5"> that</font>

151
00:09:02,670 --> 00:09:11,699
one there is<font color="#CCCCCC"> this list of instructions</font>

152
00:09:07,310 --> 00:09:14,939
okay<font color="#E5E5E5"> just to</font><font color="#CCCCCC"> the creep add the</font><font color="#E5E5E5"> word</font><font color="#CCCCCC"> for</font>

153
00:09:11,699 --> 00:09:16,680
bytes<font color="#E5E5E5"> okay you will execute this one if</font>

154
00:09:14,939 --> 00:09:18,360
you're<font color="#E5E5E5"> trying</font><font color="#CCCCCC"> to do a reverse</font>

155
00:09:16,680 --> 00:09:19,709
engineering of<font color="#E5E5E5"> this malware the very</font>

156
00:09:18,360 --> 00:09:22,110
first thing that<font color="#CCCCCC"> you'll</font><font color="#E5E5E5"> encounter is</font>

157
00:09:19,709 --> 00:09:24,949
this set of<font color="#CCCCCC"> instructions and then you</font>

158
00:09:22,110 --> 00:09:28,019
only get a D word<font color="#E5E5E5"> you will go back</font>

159
00:09:24,949 --> 00:09:31,109
execute again these things<font color="#E5E5E5"> to get to the</font>

160
00:09:28,019 --> 00:09:33,990
clip another set of D word<font color="#E5E5E5"> until you</font>

161
00:09:31,110 --> 00:09:38,910
finally decrypt the whole<font color="#E5E5E5"> petia code</font>

162
00:09:33,990 --> 00:09:41,550
<font color="#E5E5E5">okay that is the that version okay so</font>

163
00:09:38,910 --> 00:09:43,050
this is that<font color="#E5E5E5"> particular code okay you</font>

164
00:09:41,550 --> 00:09:44,880
will know that<font color="#E5E5E5"> you already done</font>

165
00:09:43,050 --> 00:09:47,099
decrypting the patria code

166
00:09:44,880 --> 00:09:49,860
<font color="#E5E5E5">okay if you can see not the header and</font>

167
00:09:47,100 --> 00:09:54,319
said and the PE that then you<font color="#CCCCCC"> already</font>

168
00:09:49,860 --> 00:09:58,709
<font color="#E5E5E5">have the that this image it is not drop</font>

169
00:09:54,319 --> 00:10:01,410
<font color="#E5E5E5">okay so the best</font><font color="#CCCCCC"> thing</font><font color="#E5E5E5"> to execute a</font><font color="#CCCCCC"> new</font>

170
00:09:58,709 --> 00:10:05,130
image is<font color="#CCCCCC"> actually to</font><font color="#E5E5E5"> get the API</font>

171
00:10:01,410 --> 00:10:07,649
<font color="#E5E5E5">it needs</font><font color="#CCCCCC"> key so poor</font><font color="#E5E5E5"> petia it actually</font>

172
00:10:05,130 --> 00:10:10,500
gets the get<font color="#CCCCCC"> rock address the very</font>

173
00:10:07,649 --> 00:10:14,579
visual<font color="#CCCCCC"> agile and then after that it will</font>

174
00:10:10,500 --> 00:10:16,080
gather and grab<font color="#E5E5E5"> all the needed</font><font color="#CCCCCC"> api's in</font>

175
00:10:14,579 --> 00:10:21,089
order to execute

176
00:10:16,080 --> 00:10:24,570
it's<font color="#E5E5E5"> functional</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> is second one it will</font>

177
00:10:21,089 --> 00:10:27,060
go it is going<font color="#CCCCCC"> to look</font><font color="#E5E5E5"> poor that xxx</font>

178
00:10:24,570 --> 00:10:31,110
that's<font color="#CCCCCC"> 4x</font><font color="#E5E5E5"> section is</font><font color="#CCCCCC"> that the name of</font>

179
00:10:27,060 --> 00:10:33,630
the section in<font color="#CCCCCC"> your in your</font><font color="#E5E5E5"> code okay so</font>

180
00:10:31,110 --> 00:10:36,390
that<font color="#E5E5E5"> this one okay okay but</font><font color="#CCCCCC"> you can see</font>

181
00:10:33,630 --> 00:10:38,310
here it is<font color="#E5E5E5"> now actually</font><font color="#CCCCCC"> a part</font><font color="#E5E5E5"> it is</font>

182
00:10:36,390 --> 00:10:42,120
part of the decrypted code<font color="#E5E5E5"> it is now</font>

183
00:10:38,310 --> 00:10:45,540
part of<font color="#CCCCCC"> the</font><font color="#E5E5E5"> can see this information</font><font color="#CCCCCC"> it</font>

184
00:10:42,120 --> 00:10:47,339
is<font color="#E5E5E5"> the ransom</font><font color="#CCCCCC"> note okay later</font><font color="#E5E5E5"> we will I</font>

185
00:10:45,540 --> 00:10:49,800
<font color="#CCCCCC">will I'm</font><font color="#E5E5E5"> going to show you how the</font>

186
00:10:47,339 --> 00:10:55,760
ransom note was displayed in your

187
00:10:49,800 --> 00:10:58,410
machine let's talk about bootable<font color="#E5E5E5"> disk</font>

188
00:10:55,760 --> 00:11:01,709
<font color="#E5E5E5">when we talk about bootable this usually</font>

189
00:10:58,410 --> 00:11:04,110
in order<font color="#CCCCCC"> for petia to know what kind</font><font color="#E5E5E5"> of</font>

190
00:11:01,709 --> 00:11:06,479
this that you<font color="#E5E5E5"> are using because</font><font color="#CCCCCC"> it needs</font>

191
00:11:04,110 --> 00:11:10,709
to<font color="#E5E5E5"> know if you're using and then we are</font>

192
00:11:06,480 --> 00:11:13,260
or if<font color="#CCCCCC"> you are</font><font color="#E5E5E5"> using a cheap ET y because</font>

193
00:11:10,709 --> 00:11:17,518
MBR<font color="#E5E5E5"> it doesn't need to</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> just need to</font>

194
00:11:13,260 --> 00:11:21,689
override your<font color="#E5E5E5"> MBR if it is a GP p this</font>

195
00:11:17,519 --> 00:11:23,940
it needs to overwrite your your MBR your

196
00:11:21,690 --> 00:11:26,100
purse your second sector<font color="#E5E5E5"> and the last</font>

197
00:11:23,940 --> 00:11:30,350
<font color="#E5E5E5">sector because ii</font><font color="#CCCCCC"> remember the second</font>

198
00:11:26,100 --> 00:11:35,010
and the last<font color="#E5E5E5"> sector is the GPT headers</font>

199
00:11:30,350 --> 00:11:38,250
so it's going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> use</font><font color="#E5E5E5"> this one</font><font color="#CCCCCC"> that</font>

200
00:11:35,010 --> 00:11:40,589
device IO control<font color="#E5E5E5"> okay in the device I</font>

201
00:11:38,250 --> 00:11:43,529
control you will be able<font color="#E5E5E5"> to know if it</font>

202
00:11:40,589 --> 00:11:45,420
<font color="#CCCCCC">is a logical drive or a physical drive</font>

203
00:11:43,529 --> 00:11:50,220
<font color="#E5E5E5">okay you will</font><font color="#CCCCCC"> be able to</font><font color="#E5E5E5"> tell if it is</font>

204
00:11:45,420 --> 00:11:52,529
<font color="#CCCCCC">Drive C or or other tribe the initial</font>

205
00:11:50,220 --> 00:11:54,810
call there is<font color="#CCCCCC"> a there</font><font color="#E5E5E5"> it patch of</font>

206
00:11:52,529 --> 00:11:58,110
malware calls<font color="#E5E5E5"> device IO control twice</font>

207
00:11:54,810 --> 00:12:02,219
<font color="#E5E5E5">okay the first one</font><font color="#CCCCCC"> is to check if</font><font color="#E5E5E5"> it can</font>

208
00:11:58,110 --> 00:12:05,190
access<font color="#E5E5E5"> your hard drive if it cannot</font><font color="#CCCCCC"> ok</font>

209
00:12:02,220 --> 00:12:08,550
it will<font color="#E5E5E5"> just skip the infection he make</font>

210
00:12:05,190 --> 00:12:10,440
<font color="#E5E5E5">sure that K to avoid</font><font color="#CCCCCC"> Pecha infection</font>

211
00:12:08,550 --> 00:12:12,300
<font color="#E5E5E5">actually one</font><font color="#CCCCCC"> of the thing that you have</font>

212
00:12:10,440 --> 00:12:16,199
to<font color="#E5E5E5"> do is to make</font><font color="#CCCCCC"> sure</font><font color="#E5E5E5"> that you don't</font>

213
00:12:12,300 --> 00:12:18,329
have admin access to<font color="#E5E5E5"> your machine if you</font>

214
00:12:16,199 --> 00:12:21,359
don't<font color="#E5E5E5"> have admin access to your machine</font>

215
00:12:18,329 --> 00:12:24,329
<font color="#E5E5E5">like just a regular</font><font color="#CCCCCC"> user access it won't</font>

216
00:12:21,360 --> 00:12:27,180
be able<font color="#E5E5E5"> to touch your hard drive</font><font color="#CCCCCC"> okay</font>

217
00:12:24,329 --> 00:12:29,998
<font color="#CCCCCC">but most</font><font color="#E5E5E5"> of us when</font><font color="#CCCCCC"> you when you buy</font>

218
00:12:27,180 --> 00:12:33,779
your your computer<font color="#CCCCCC"> a</font><font color="#E5E5E5"> automatic</font>

219
00:12:29,999 --> 00:12:36,989
your purse<font color="#CCCCCC"> login is actually an admin</font>

220
00:12:33,779 --> 00:12:40,859
access<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> you might not know but it</font><font color="#CCCCCC"> is</font>

221
00:12:36,989 --> 00:12:43,259
always<font color="#E5E5E5"> something like that okay so it</font>

222
00:12:40,859 --> 00:12:46,499
checks<font color="#E5E5E5"> if it is it what kind of a</font>

223
00:12:43,259 --> 00:12:48,509
partition<font color="#CCCCCC"> that you need okay and then it</font>

224
00:12:46,499 --> 00:12:51,720
checks if<font color="#E5E5E5"> it is accessible</font><font color="#CCCCCC"> if it is not</font>

225
00:12:48,509 --> 00:12:54,509
it<font color="#CCCCCC"> will</font><font color="#E5E5E5"> escape if it if it can access</font><font color="#CCCCCC"> by</font>

226
00:12:51,720 --> 00:12:57,149
using<font color="#E5E5E5"> create by an API then it will</font>

227
00:12:54,509 --> 00:13:00,059
<font color="#CCCCCC">proceed</font><font color="#E5E5E5"> on the next device IO control</font>

228
00:12:57,149 --> 00:13:03,079
<font color="#E5E5E5">check okay but first how do you check if</font>

229
00:13:00,059 --> 00:13:06,389
it is if it<font color="#CCCCCC"> is Drive see</font><font color="#E5E5E5"> okay</font>

230
00:13:03,079 --> 00:13:08,429
there are different names<font color="#E5E5E5"> for the drive</font>

231
00:13:06,389 --> 00:13:11,609
see the very first<font color="#CCCCCC"> drive of course path</font>

232
00:13:08,429 --> 00:13:15,659
<font color="#CCCCCC">is assuming that your first drive or</font>

233
00:13:11,609 --> 00:13:19,649
<font color="#CCCCCC">Drive see is your bootable Drive okay</font><font color="#E5E5E5"> so</font>

234
00:13:15,659 --> 00:13:22,709
<font color="#E5E5E5">poor backward compatibility</font><font color="#CCCCCC"> we can check</font>

235
00:13:19,649 --> 00:13:25,259
if it is d r0 d r0 is actually your

236
00:13:22,709 --> 00:13:28,378
first drive or if it is Windows NT

237
00:13:25,259 --> 00:13:31,649
<font color="#E5E5E5">you're looking for the bus hard is</font><font color="#CCCCCC"> 0</font>

238
00:13:28,379 --> 00:13:35,819
<font color="#E5E5E5">partition 0 or equivalent to</font><font color="#CCCCCC"> D r0</font>

239
00:13:31,649 --> 00:13:37,949
<font color="#CCCCCC">ok or you</font><font color="#E5E5E5"> can also use the legacy name</font><font color="#CCCCCC"> K</font>

240
00:13:35,819 --> 00:13:40,319
using<font color="#CCCCCC"> global and</font><font color="#E5E5E5"> fiscal driver usually</font>

241
00:13:37,949 --> 00:13:43,079
<font color="#CCCCCC">with the</font><font color="#E5E5E5"> 0 you know that it is the first</font>

242
00:13:40,319 --> 00:13:46,799
ride<font color="#E5E5E5"> and the way to access</font><font color="#CCCCCC"> that</font>

243
00:13:43,079 --> 00:13:49,469
programmatically<font color="#E5E5E5"> is you just need to use</font>

244
00:13:46,799 --> 00:13:52,499
create<font color="#E5E5E5"> pile because like likely not</font>

245
00:13:49,470 --> 00:13:55,259
Linux devices<font color="#E5E5E5"> everything</font><font color="#CCCCCC"> is a 5k pour</font>

246
00:13:52,499 --> 00:13:57,720
for this one<font color="#E5E5E5"> in your Windows system you</font>

247
00:13:55,259 --> 00:14:01,379
can<font color="#E5E5E5"> access your physical drive 0 or your</font>

248
00:13:57,720 --> 00:14:05,419
drive<font color="#E5E5E5"> C using the same function in which</font>

249
00:14:01,379 --> 00:14:09,599
you<font color="#CCCCCC"> open your file click create pile hey</font>

250
00:14:05,419 --> 00:14:13,499
there is a tool again in in<font color="#CCCCCC"> Windows</font>

251
00:14:09,599 --> 00:14:17,519
<font color="#CCCCCC">system ok you can you can use win</font><font color="#E5E5E5"> obj</font>

252
00:14:13,499 --> 00:14:20,789
win obj this one and then<font color="#E5E5E5"> you</font><font color="#CCCCCC"> can</font>

253
00:14:17,519 --> 00:14:23,849
actually check<font color="#E5E5E5"> ok what is the the way</font>

254
00:14:20,789 --> 00:14:26,399
your particular<font color="#CCCCCC"> windows windows version</font>

255
00:14:23,849 --> 00:14:30,989
is naming<font color="#E5E5E5"> your your hard drive and then</font>

256
00:14:26,399 --> 00:14:32,999
you<font color="#E5E5E5"> can probably do your checking hey</font>

257
00:14:30,989 --> 00:14:35,220
this is how the<font color="#CCCCCC"> malware this is the</font>

258
00:14:32,999 --> 00:14:37,859
<font color="#E5E5E5">multi part of the malware code it is now</font>

259
00:14:35,220 --> 00:14:41,699
<font color="#E5E5E5">going to check it is checking if your</font>

260
00:14:37,859 --> 00:14:43,589
drive is your drive<font color="#CCCCCC"> C and then it is</font>

261
00:14:41,699 --> 00:14:43,889
checking for<font color="#CCCCCC"> device</font><font color="#E5E5E5"> I control this one</font>

262
00:14:43,589 --> 00:14:46,879
does

263
00:14:43,889 --> 00:14:49,920
second device IO control<font color="#CCCCCC"> API is to check</font>

264
00:14:46,879 --> 00:14:52,949
this<font color="#E5E5E5"> one what kind of partition it is</font>

265
00:14:49,920 --> 00:14:55,799
<font color="#E5E5E5">going to check if it is an MBR</font><font color="#CCCCCC"> okay</font>

266
00:14:52,949 --> 00:15:00,649
<font color="#E5E5E5">because</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> this code okay it will know</font>

267
00:14:55,799 --> 00:15:04,879
if it<font color="#E5E5E5"> is an MBR</font><font color="#CCCCCC"> a GPT</font><font color="#E5E5E5"> or just a regular</font>

268
00:15:00,649 --> 00:15:07,519
<font color="#CCCCCC">hi this</font><font color="#E5E5E5"> the right type</font><font color="#CCCCCC"> row</font><font color="#E5E5E5"> okay</font>

269
00:15:04,879 --> 00:15:16,730
there is a tool

270
00:15:07,519 --> 00:15:16,730
oops<font color="#E5E5E5"> Robin oh no I'm impacted we're done</font>

271
00:15:18,829 --> 00:15:22,429
technical difficulties

272
00:15:25,880 --> 00:15:28,630
<font color="#E5E5E5">all right</font>

273
00:15:30,720 --> 00:15:36,350
<font color="#E5E5E5">I'm just</font><font color="#CCCCCC"> extending the</font><font color="#E5E5E5"> time so</font><font color="#CCCCCC"> that you</font>

274
00:15:32,819 --> 00:15:39,540
can cannot ask questions later

275
00:15:36,350 --> 00:15:48,660
it automatically cuts itself<font color="#E5E5E5"> in the</font>

276
00:15:39,540 --> 00:15:52,279
<font color="#CCCCCC">middle of the talk see</font><font color="#E5E5E5"> I already use up</font>

277
00:15:48,660 --> 00:15:52,279
my my time

278
00:16:10,940 --> 00:16:15,880
<font color="#E5E5E5">where am I I think this one</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> know</font>

279
00:16:19,519 --> 00:16:33,350
stooop<font color="#CCCCCC"> are go we know</font><font color="#E5E5E5"> BJ physical drive</font>

280
00:16:28,579 --> 00:16:34,790
<font color="#CCCCCC">oh this one</font><font color="#E5E5E5"> okay</font>

281
00:16:33,350 --> 00:16:37,069
<font color="#CCCCCC">there's a tool we call the process</font>

282
00:16:34,790 --> 00:16:40,339
monitor<font color="#E5E5E5"> okay you can actually download</font>

283
00:16:37,069 --> 00:16:42,199
<font color="#E5E5E5">that from sis internals okay you can get</font>

284
00:16:40,339 --> 00:16:44,809
actually<font color="#CCCCCC"> lots of different</font><font color="#E5E5E5"> tools in</font>

285
00:16:42,199 --> 00:16:47,479
sysinternals<font color="#E5E5E5"> key you can run the malware</font>

286
00:16:44,809 --> 00:16:49,219
<font color="#CCCCCC">for example you</font><font color="#E5E5E5"> have the malware</font><font color="#CCCCCC"> you</font>

287
00:16:47,480 --> 00:16:51,980
have the<font color="#CCCCCC"> petia okay you want to</font><font color="#E5E5E5"> monitor</font>

288
00:16:49,220 --> 00:16:54,499
<font color="#CCCCCC">APD's if it</font><font color="#E5E5E5"> is really going to impact</font>

289
00:16:51,980 --> 00:16:57,079
your heart risk<font color="#CCCCCC"> okay you can use you</font>

290
00:16:54,499 --> 00:16:59,240
have<font color="#E5E5E5"> to run this tool</font><font color="#CCCCCC"> ok process monitor</font>

291
00:16:57,079 --> 00:17:02,689
it<font color="#CCCCCC"> will tell you if it is going</font><font color="#E5E5E5"> to</font>

292
00:16:59,240 --> 00:17:05,510
access<font color="#CCCCCC"> your 5k using the create pipe API</font>

293
00:17:02,689 --> 00:17:08,359
<font color="#CCCCCC">okay</font><font color="#E5E5E5"> and now it is checking your first</font>

294
00:17:05,510 --> 00:17:09,079
drive okay and then the bus I control is

295
00:17:08,359 --> 00:17:11,329
<font color="#E5E5E5">being checked</font>

296
00:17:09,079 --> 00:17:13,039
normally process monitor will give you

297
00:17:11,329 --> 00:17:15,648
lots of<font color="#CCCCCC"> different information this is</font>

298
00:17:13,039 --> 00:17:19,789
<font color="#E5E5E5">already the clean version</font><font color="#CCCCCC"> okay and this</font>

299
00:17:15,648 --> 00:17:22,639
<font color="#E5E5E5">is</font><font color="#CCCCCC"> getting your information but never</font>

300
00:17:19,789 --> 00:17:25,490
ever execute the<font color="#CCCCCC"> malware in your machine</font>

301
00:17:22,640 --> 00:17:27,679
<font color="#CCCCCC">it is</font><font color="#E5E5E5"> it is not recommended to impact</font>

302
00:17:25,490 --> 00:17:29,630
yourself right<font color="#E5E5E5"> okay</font>

303
00:17:27,679 --> 00:17:32,149
but if you're already infected you won't

304
00:17:29,630 --> 00:17:34,610
be<font color="#E5E5E5"> able to use the process</font><font color="#CCCCCC"> motor</font><font color="#E5E5E5"> you</font>

305
00:17:32,149 --> 00:17:36,639
should have an<font color="#E5E5E5"> isolated machine if you</font>

306
00:17:34,610 --> 00:17:37,850
really want to check how the malware

307
00:17:36,640 --> 00:17:39,529
works

308
00:17:37,850 --> 00:17:42,110
<font color="#CCCCCC">okay I'm not telling you to grab the</font>

309
00:17:39,529 --> 00:17:46,340
<font color="#E5E5E5">petia</font><font color="#CCCCCC"> and then run it in your corporate</font>

310
00:17:42,110 --> 00:17:49,580
machine it is not my<font color="#CCCCCC"> intention</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> say so</font>

311
00:17:46,340 --> 00:17:52,699
<font color="#CCCCCC">hey there is only the tool okay let's go</font>

312
00:17:49,580 --> 00:17:56,110
<font color="#E5E5E5">now how</font><font color="#CCCCCC"> Pecha actually read in</font><font color="#E5E5E5"> trip and</font>

313
00:17:52,700 --> 00:17:59,360
<font color="#E5E5E5">all be right your your</font><font color="#CCCCCC"> hard drive okay</font>

314
00:17:56,110 --> 00:18:01,490
<font color="#E5E5E5">first it reads a copy of your sector</font>

315
00:17:59,360 --> 00:18:04,908
<font color="#E5E5E5">even though it</font><font color="#CCCCCC"> doesn't matter if it is</font>

316
00:18:01,490 --> 00:18:06,919
<font color="#E5E5E5">MBR Master Boot Record</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> protected</font>

317
00:18:04,909 --> 00:18:09,710
Master Boot Record for<font color="#E5E5E5"> your boot sector</font>

318
00:18:06,919 --> 00:18:13,850
it is<font color="#CCCCCC"> a copy</font><font color="#E5E5E5"> it save it somewhere</font><font color="#CCCCCC"> else</font>

319
00:18:09,710 --> 00:18:16,909
and then from sector 0 1<font color="#CCCCCC"> to</font><font color="#E5E5E5"> chapter 22</font>

320
00:18:13,850 --> 00:18:20,689
<font color="#CCCCCC">it will produce this</font><font color="#E5E5E5"> it will execute</font>

321
00:18:16,909 --> 00:18:24,620
this code and each of those bytes will

322
00:18:20,690 --> 00:18:28,039
be X or<font color="#E5E5E5"> 237 easy right you can just XOR</font>

323
00:18:24,620 --> 00:18:31,850
it back you<font color="#E5E5E5"> will be able to</font><font color="#CCCCCC"> get your MBR</font>

324
00:18:28,039 --> 00:18:33,170
<font color="#E5E5E5">is that that simple that is how simple</font>

325
00:18:31,850 --> 00:18:36,280
<font color="#E5E5E5">it is</font><font color="#CCCCCC"> to</font>

326
00:18:33,170 --> 00:18:40,180
<font color="#E5E5E5">impact simply simplicity for this</font><font color="#CCCCCC"> one 37</font>

327
00:18:36,280 --> 00:18:43,730
<font color="#E5E5E5">okay and then add after that</font><font color="#CCCCCC"> okay after</font>

328
00:18:40,180 --> 00:18:47,660
encrypting<font color="#CCCCCC"> 0 1 and</font><font color="#E5E5E5"> 20 up</font><font color="#CCCCCC"> to 21 setters</font>

329
00:18:43,730 --> 00:18:50,840
<font color="#CCCCCC">it tries not the new</font><font color="#E5E5E5"> MBR the new MBR is</font>

330
00:18:47,660 --> 00:18:53,900
actually the malware code part of the

331
00:18:50,840 --> 00:18:56,929
kernel<font color="#E5E5E5"> of the</font><font color="#CCCCCC"> malware code ok and then</font>

332
00:18:53,900 --> 00:19:01,400
after<font color="#CCCCCC"> that he starts writing a</font><font color="#E5E5E5"> small</font>

333
00:18:56,930 --> 00:19:04,370
kernel code is starting at sector<font color="#CCCCCC"> 22 ok</font>

334
00:19:01,400 --> 00:19:07,640
so MBR<font color="#E5E5E5"> part be the main purpose of the</font>

335
00:19:04,370 --> 00:19:11,419
new MBR<font color="#CCCCCC"> is to load the</font><font color="#E5E5E5"> kernel code is</font>

336
00:19:07,640 --> 00:19:14,540
starting at 22:00<font color="#E5E5E5"> sector twenty two hex</font>

337
00:19:11,420 --> 00:19:17,990
<font color="#CCCCCC">okay</font><font color="#E5E5E5"> how do you</font><font color="#CCCCCC"> know if it is actually</font>

338
00:19:14,540 --> 00:19:21,470
an MBR<font color="#E5E5E5"> or a boot sector usually it is</font>

339
00:19:17,990 --> 00:19:25,790
one<font color="#E5E5E5"> sector it is actually 0 X 200 bytes</font>

340
00:19:21,470 --> 00:19:28,970
<font color="#E5E5E5">K the last entry should be 50 pipe a a</font>

341
00:19:25,790 --> 00:19:31,790
<font color="#E5E5E5">if it is not 50 pipe a a that means it</font>

342
00:19:28,970 --> 00:19:33,380
is<font color="#E5E5E5"> not a boot sector it is not an MBR</font>

343
00:19:31,790 --> 00:19:36,530
<font color="#E5E5E5">how does it look like</font>

344
00:19:33,380 --> 00:19:39,860
it<font color="#CCCCCC"> looks</font><font color="#E5E5E5"> like this</font><font color="#CCCCCC"> ok</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> is a dump</font>

345
00:19:36,530 --> 00:19:42,230
<font color="#E5E5E5">appear of my boot sector in my MBR and</font>

346
00:19:39,860 --> 00:19:45,139
<font color="#E5E5E5">then there is a marker</font><font color="#CCCCCC"> here ok at the</font>

347
00:19:42,230 --> 00:19:48,260
<font color="#E5E5E5">train at the two hex 200 hex buys J</font>

348
00:19:45,140 --> 00:19:50,570
there's a pipe<font color="#E5E5E5"> pipe a a right and then</font>

349
00:19:48,260 --> 00:19:54,379
<font color="#CCCCCC">at</font><font color="#E5E5E5"> again you can use the process monitor</font>

350
00:19:50,570 --> 00:19:56,510
tool in order<font color="#E5E5E5"> to check</font><font color="#CCCCCC"> if it is actually</font>

351
00:19:54,380 --> 00:20:00,950
<font color="#CCCCCC">impacting your harddrive notice this</font><font color="#E5E5E5"> is</font>

352
00:19:56,510 --> 00:20:03,950
<font color="#E5E5E5">the size of the</font><font color="#CCCCCC"> the sector ok there is</font>

353
00:20:00,950 --> 00:20:06,260
another tool<font color="#CCCCCC"> okay it is not</font><font color="#E5E5E5"> from Windows</font>

354
00:20:03,950 --> 00:20:08,900
it is<font color="#E5E5E5"> that from Microsoft</font><font color="#CCCCCC"> okay you can</font>

355
00:20:06,260 --> 00:20:12,020
grab it online<font color="#CCCCCC"> I didn't put the link</font>

356
00:20:08,900 --> 00:20:15,650
where to<font color="#E5E5E5"> grab it could download it at</font>

357
00:20:12,020 --> 00:20:20,000
your own<font color="#CCCCCC"> risk you can actually use HD</font>

358
00:20:15,650 --> 00:20:24,080
hacker<font color="#CCCCCC"> ok</font><font color="#E5E5E5"> by this guy</font><font color="#CCCCCC"> okay you can</font>

359
00:20:20,000 --> 00:20:26,330
actually<font color="#E5E5E5"> read your content the sector it</font>

360
00:20:24,080 --> 00:20:28,129
you can specify which sector you can

361
00:20:26,330 --> 00:20:30,320
<font color="#E5E5E5">specify the number of sector here and</font>

362
00:20:28,130 --> 00:20:34,730
then you can save<font color="#E5E5E5"> it</font><font color="#CCCCCC"> okay</font>

363
00:20:30,320 --> 00:20:37,820
top<font color="#CCCCCC"> 5 ok but this</font><font color="#E5E5E5"> is a very very</font>

364
00:20:34,730 --> 00:20:41,030
dangerous<font color="#CCCCCC"> tool why because if you can</font>

365
00:20:37,820 --> 00:20:43,490
read the<font color="#CCCCCC"> sectors</font><font color="#E5E5E5"> you can also overwrite</font>

366
00:20:41,030 --> 00:20:46,790
<font color="#CCCCCC">your own sector</font><font color="#E5E5E5"> if you click the wrong</font>

367
00:20:43,490 --> 00:20:50,540
button here<font color="#CCCCCC"> ok you will</font>

368
00:20:46,790 --> 00:20:51,170
be<font color="#E5E5E5"> able to to destroy or to impact your</font>

369
00:20:50,540 --> 00:20:56,930
own machine

370
00:20:51,170 --> 00:21:00,560
even without running<font color="#CCCCCC"> the</font><font color="#E5E5E5"> patio again</font>

371
00:20:56,930 --> 00:21:03,980
this is from<font color="#CCCCCC"> Padilla it treats this code</font>

372
00:21:00,560 --> 00:21:06,790
<font color="#CCCCCC">okay this is the that</font><font color="#E5E5E5"> ultra-hd hacker</font>

373
00:21:03,980 --> 00:21:09,070
<font color="#E5E5E5">tool so you're</font><font color="#CCCCCC"> actually getting</font><font color="#E5E5E5"> the same</font>

374
00:21:06,790 --> 00:21:12,260
<font color="#CCCCCC">information</font>

375
00:21:09,070 --> 00:21:15,710
<font color="#E5E5E5">okay this is the code were in it</font>

376
00:21:12,260 --> 00:21:18,920
actually<font color="#CCCCCC"> XOR so it trusts this one crate</font>

377
00:21:15,710 --> 00:21:21,650
pile opens the sectors in impacts the

378
00:21:18,920 --> 00:21:23,960
sectors are encrypted with<font color="#CCCCCC"> 0 X 37 and</font>

379
00:21:21,650 --> 00:21:28,550
then write<font color="#E5E5E5"> it back so what happen is it</font>

380
00:21:23,960 --> 00:21:31,220
read<font color="#E5E5E5"> the sector from 0 1 X or H by 2 37</font>

381
00:21:28,550 --> 00:21:33,770
hex<font color="#E5E5E5"> and then write it</font><font color="#CCCCCC"> back to the same</font>

382
00:21:31,220 --> 00:21:37,310
sector and then read sector 2 and so<font color="#CCCCCC"> on</font>

383
00:21:33,770 --> 00:21:39,950
and so forth<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is this is what</font>

384
00:21:37,310 --> 00:21:44,149
happens when when you read the sector<font color="#CCCCCC"> C</font>

385
00:21:39,950 --> 00:21:49,790
it will<font color="#E5E5E5"> look like this</font><font color="#CCCCCC"> 0 X 37 in ascii</font>

386
00:21:44,150 --> 00:21:52,490
is<font color="#E5E5E5"> 7 e and then again you can again run</font>

387
00:21:49,790 --> 00:21:57,580
process monitor you will<font color="#E5E5E5"> be</font><font color="#CCCCCC"> able</font><font color="#E5E5E5"> to see</font>

388
00:21:52,490 --> 00:21:59,990
that it is<font color="#CCCCCC"> actually reading writing and</font>

389
00:21:57,580 --> 00:22:02,840
there's no writing<font color="#E5E5E5"> here others writing</font>

390
00:21:59,990 --> 00:22:05,540
so there's a<font color="#E5E5E5"> reading writing and some</font>

391
00:22:02,840 --> 00:22:08,389
support it is actually going to<font color="#CCCCCC"> desist</font>

392
00:22:05,540 --> 00:22:09,020
<font color="#CCCCCC">of the process if you see this ok</font><font color="#E5E5E5"> you</font>

393
00:22:08,390 --> 00:22:10,580
are<font color="#CCCCCC"> now</font>

394
00:22:09,020 --> 00:22:15,110
<font color="#CCCCCC">Pecha now is in the</font><font color="#E5E5E5"> process of</font>

395
00:22:10,580 --> 00:22:18,379
encrypting your<font color="#E5E5E5"> drive</font><font color="#CCCCCC"> ok so this</font><font color="#E5E5E5"> is the</font>

396
00:22:15,110 --> 00:22:21,590
<font color="#CCCCCC">part where</font><font color="#E5E5E5"> it writes the new MBR if you</font>

397
00:22:18,380 --> 00:22:25,550
can see this is the<font color="#CCCCCC"> original or the old</font>

398
00:22:21,590 --> 00:22:28,040
MBR this is the<font color="#CCCCCC"> petia</font><font color="#E5E5E5"> MBR this is the</font>

399
00:22:25,550 --> 00:22:30,159
loader<font color="#E5E5E5"> actually of its kernel code</font>

400
00:22:28,040 --> 00:22:33,770
<font color="#E5E5E5">actually if you want to make your own</font>

401
00:22:30,160 --> 00:22:35,960
kernel<font color="#E5E5E5"> code you can actually paulo how</font>

402
00:22:33,770 --> 00:22:38,290
<font color="#CCCCCC">pitcher does it okay you can learn</font>

403
00:22:35,960 --> 00:22:40,850
<font color="#CCCCCC">something from from the malware itself</font>

404
00:22:38,290 --> 00:22:43,159
<font color="#CCCCCC">ok the author is actually really really</font>

405
00:22:40,850 --> 00:22:46,490
<font color="#E5E5E5">cool</font><font color="#CCCCCC"> no I</font><font color="#E5E5E5"> don't know him</font>

406
00:22:43,160 --> 00:22:48,470
that means not<font color="#E5E5E5"> me ok so this is</font><font color="#CCCCCC"> the new</font>

407
00:22:46,490 --> 00:22:49,670
MBR code the new MBR code will look

408
00:22:48,470 --> 00:22:52,880
<font color="#E5E5E5">something like this</font>

409
00:22:49,670 --> 00:22:55,730
if you<font color="#CCCCCC"> disassemble this it will be like</font>

410
00:22:52,880 --> 00:22:58,700
<font color="#CCCCCC">say lioness actually this</font><font color="#E5E5E5"> is the start</font>

411
00:22:55,730 --> 00:23:00,440
of if you look<font color="#E5E5E5"> at the boot process code</font>

412
00:22:58,700 --> 00:23:03,230
<font color="#E5E5E5">it will be</font>

413
00:23:00,440 --> 00:23:06,530
<font color="#E5E5E5">we look similar like this hey this</font><font color="#CCCCCC"> is</font>

414
00:23:03,230 --> 00:23:11,450
<font color="#CCCCCC">not</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> new</font><font color="#E5E5E5"> MBR</font><font color="#CCCCCC"> okay it is downloaded</font>

415
00:23:06,530 --> 00:23:14,240
<font color="#CCCCCC">from</font><font color="#E5E5E5"> HD hacker this file okay what</font>

416
00:23:11,450 --> 00:23:18,970
happens<font color="#E5E5E5"> can you be impacted if you're</font>

417
00:23:14,240 --> 00:23:22,070
using an MBR<font color="#E5E5E5"> how about GPT</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> because</font>

418
00:23:18,970 --> 00:23:25,670
<font color="#E5E5E5">they are using both they're still using</font>

419
00:23:22,070 --> 00:23:28,700
<font color="#E5E5E5">petia doesn't doesn't care if it is MBR</font>

420
00:23:25,670 --> 00:23:32,090
or GPT<font color="#E5E5E5"> as long as it can access your</font>

421
00:23:28,700 --> 00:23:35,540
drive<font color="#CCCCCC"> okay both of them will be</font><font color="#E5E5E5"> impacted</font>

422
00:23:32,090 --> 00:23:38,090
<font color="#E5E5E5">it doesn't matter if it is MBR GPT the</font>

423
00:23:35,540 --> 00:23:42,170
problem is if you<font color="#CCCCCC"> are running an MBR</font>

424
00:23:38,090 --> 00:23:44,709
code before<font color="#CCCCCC"> when you when you reboot</font>

425
00:23:42,170 --> 00:23:47,930
<font color="#E5E5E5">your</font><font color="#CCCCCC"> system you will automatically see</font>

426
00:23:44,710 --> 00:23:52,010
the picture ransomware<font color="#E5E5E5"> okay that ransom</font>

427
00:23:47,930 --> 00:23:55,370
note<font color="#CCCCCC"> okay but if</font><font color="#E5E5E5"> you're running GPT with</font>

428
00:23:52,010 --> 00:23:58,190
UEFI<font color="#CCCCCC"> if you're infected with Pecha</font><font color="#E5E5E5"> you</font>

429
00:23:55,370 --> 00:24:00,620
won't see anything<font color="#E5E5E5"> because the GPT or</font>

430
00:23:58,190 --> 00:24:04,550
the<font color="#CCCCCC"> UF</font><font color="#E5E5E5"> I will not be able to load the</font>

431
00:24:00,620 --> 00:24:08,090
MBR<font color="#CCCCCC"> okay it will become a</font><font color="#E5E5E5"> regular MBR</font>

432
00:24:04,550 --> 00:24:10,280
partition<font color="#CCCCCC"> hey if you're infected with</font><font color="#E5E5E5"> it</font>

433
00:24:08,090 --> 00:24:13,280
<font color="#CCCCCC">petia</font><font color="#E5E5E5"> okay so you will know if</font><font color="#CCCCCC"> you are</font>

434
00:24:10,280 --> 00:24:14,450
<font color="#CCCCCC">infected</font><font color="#E5E5E5"> if your machine doesn't</font><font color="#CCCCCC"> start</font>

435
00:24:13,280 --> 00:24:18,740
<font color="#E5E5E5">anymore</font><font color="#CCCCCC"> okay</font>

436
00:24:14,450 --> 00:24:20,420
it probably<font color="#E5E5E5"> other malware</font><font color="#CCCCCC"> okay this one</font>

437
00:24:18,740 --> 00:24:23,780
this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> the part where in you can</font>

438
00:24:20,420 --> 00:24:26,500
<font color="#CCCCCC">actually read the code you can</font><font color="#E5E5E5"> using</font><font color="#CCCCCC"> HD</font>

439
00:24:23,780 --> 00:24:29,389
hacker<font color="#E5E5E5"> again you can</font><font color="#CCCCCC"> actually download</font>

440
00:24:26,500 --> 00:24:33,080
<font color="#E5E5E5">the kernel code so in pack your machine</font>

441
00:24:29,390 --> 00:24:35,840
and<font color="#CCCCCC"> then impact your isolated machine</font>

442
00:24:33,080 --> 00:24:39,260
and then you can you can<font color="#E5E5E5"> grab the code</font>

443
00:24:35,840 --> 00:24:42,470
<font color="#E5E5E5">starting at sector 22 then you can now</font>

444
00:24:39,260 --> 00:24:44,870
read the<font color="#E5E5E5"> origin the picture kernel code</font>

445
00:24:42,470 --> 00:24:47,480
<font color="#CCCCCC">okay it's something like you're making</font>

446
00:24:44,870 --> 00:24:50,659
<font color="#E5E5E5">your own</font><font color="#CCCCCC"> Linux</font><font color="#E5E5E5"> or you're making</font><font color="#CCCCCC"> your own</font>

447
00:24:47,480 --> 00:24:51,950
<font color="#E5E5E5">Windows</font><font color="#CCCCCC"> okay remember that</font><font color="#E5E5E5"> when you when</font>

448
00:24:50,660 --> 00:24:55,220
you turn on<font color="#E5E5E5"> your machine</font>

449
00:24:51,950 --> 00:24:58,610
<font color="#CCCCCC">okay the hardware itself still</font><font color="#E5E5E5"> doesn't</font>

450
00:24:55,220 --> 00:25:00,740
<font color="#CCCCCC">know if you're going</font><font color="#E5E5E5"> to execute Linux</font>

451
00:24:58,610 --> 00:25:02,780
and<font color="#E5E5E5"> windows of course you know</font><font color="#CCCCCC"> that</font>

452
00:25:00,740 --> 00:25:05,390
you're going<font color="#CCCCCC"> to use Linux</font><font color="#E5E5E5"> you know if</font>

453
00:25:02,780 --> 00:25:08,000
you're going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> use your Windows but the</font>

454
00:25:05,390 --> 00:25:11,570
machine itself doesn't<font color="#CCCCCC"> know yet so it</font>

455
00:25:08,000 --> 00:25:13,850
should boot and run the sector<font color="#E5E5E5"> the very</font>

456
00:25:11,570 --> 00:25:14,310
<font color="#E5E5E5">very per sector and then from that it</font>

457
00:25:13,850 --> 00:25:16,889
will

458
00:25:14,310 --> 00:25:19,020
<font color="#CCCCCC">this</font><font color="#E5E5E5"> side</font><font color="#CCCCCC"> okay whichever is that's why</font>

459
00:25:16,890 --> 00:25:21,360
you can have a dual boot<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> you can</font>

460
00:25:19,020 --> 00:25:22,920
choose<font color="#E5E5E5"> from</font><font color="#CCCCCC"> Linux you can</font><font color="#E5E5E5"> choose from</font>

461
00:25:21,360 --> 00:25:25,080
<font color="#E5E5E5">from</font><font color="#CCCCCC"> Windows</font><font color="#E5E5E5"> and so on</font>

462
00:25:22,920 --> 00:25:29,040
okay that is<font color="#E5E5E5"> this one the</font><font color="#CCCCCC"> original</font>

463
00:25:25,080 --> 00:25:31,710
<font color="#E5E5E5">mother the purse kernel code</font><font color="#CCCCCC"> k is the</font>

464
00:25:29,040 --> 00:25:33,780
one<font color="#E5E5E5"> that will decide which one</font><font color="#CCCCCC"> is going</font>

465
00:25:31,710 --> 00:25:35,820
<font color="#CCCCCC">to</font><font color="#E5E5E5"> be executed but if you're infected</font>

466
00:25:33,780 --> 00:25:39,240
<font color="#CCCCCC">with</font><font color="#E5E5E5"> petia okay</font>

467
00:25:35,820 --> 00:25:42,360
the first kernel code is<font color="#E5E5E5"> actually the</font>

468
00:25:39,240 --> 00:25:45,230
<font color="#CCCCCC">petia kernel code</font><font color="#E5E5E5"> okay this is how it</font>

469
00:25:42,360 --> 00:25:48,360
looks like<font color="#E5E5E5"> if</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> are</font><font color="#CCCCCC"> already infected</font>

470
00:25:45,230 --> 00:25:51,750
<font color="#E5E5E5">starting at sector 22 you will</font><font color="#CCCCCC"> be able</font>

471
00:25:48,360 --> 00:25:54,780
<font color="#E5E5E5">to see the ransom note somewhere</font><font color="#CCCCCC"> here</font>

472
00:25:51,750 --> 00:26:00,420
<font color="#E5E5E5">okay if you dump it it will be something</font>

473
00:25:54,780 --> 00:26:02,820
like<font color="#E5E5E5"> this okay and this is if you're</font>

474
00:26:00,420 --> 00:26:06,480
already infected<font color="#E5E5E5"> and you want to pay you</font>

475
00:26:02,820 --> 00:26:09,860
will be<font color="#E5E5E5"> able to see Kate the onion</font>

476
00:26:06,480 --> 00:26:12,150
address<font color="#CCCCCC"> kay I removed some of the</font>

477
00:26:09,860 --> 00:26:18,149
characters here so you don't<font color="#CCCCCC"> need to pay</font>

478
00:26:12,150 --> 00:26:20,160
for<font color="#CCCCCC"> me it's</font><font color="#E5E5E5"> okay okay what is the very</font>

479
00:26:18,150 --> 00:26:21,960
first<font color="#CCCCCC"> thing that</font><font color="#E5E5E5"> that happens when</font>

480
00:26:20,160 --> 00:26:23,820
you're infected with<font color="#CCCCCC"> Pecha when you're</font>

481
00:26:21,960 --> 00:26:25,650
infected with<font color="#CCCCCC"> Pecha</font><font color="#E5E5E5"> okay</font>

482
00:26:23,820 --> 00:26:29,790
your Master Boot Record will be

483
00:26:25,650 --> 00:26:32,610
overwritten<font color="#E5E5E5"> encrypted and whatever there</font>

484
00:26:29,790 --> 00:26:34,860
will<font color="#CCCCCC"> be kernel code but how is it</font><font color="#E5E5E5"> going</font>

485
00:26:32,610 --> 00:26:37,260
to<font color="#E5E5E5"> execute because if you're already</font>

486
00:26:34,860 --> 00:26:40,139
running<font color="#E5E5E5"> your</font><font color="#CCCCCC"> system you</font><font color="#E5E5E5"> won't be</font><font color="#CCCCCC"> able to</font>

487
00:26:37,260 --> 00:26:43,920
know if<font color="#E5E5E5"> you're</font><font color="#CCCCCC"> infected with</font><font color="#E5E5E5"> Pecha until</font>

488
00:26:40,140 --> 00:26:45,600
you reboot<font color="#E5E5E5"> okay you can still when</font>

489
00:26:43,920 --> 00:26:47,550
you're<font color="#E5E5E5"> in fact that you can still you</font>

490
00:26:45,600 --> 00:26:49,740
can<font color="#E5E5E5"> still run your your machine you can</font>

491
00:26:47,550 --> 00:26:53,909
still do<font color="#CCCCCC"> your</font><font color="#E5E5E5"> whatever you do whatever</font>

492
00:26:49,740 --> 00:26:56,520
you<font color="#CCCCCC"> you like</font><font color="#E5E5E5"> you're using Word Excel or</font>

493
00:26:53,910 --> 00:26:58,530
whatever<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> but once you reboot</font><font color="#E5E5E5"> and</font>

494
00:26:56,520 --> 00:27:00,930
then you're already<font color="#CCCCCC"> infected betcha</font>

495
00:26:58,530 --> 00:27:03,360
what happen is it will run the<font color="#E5E5E5"> kernel</font>

496
00:27:00,930 --> 00:27:05,340
code<font color="#E5E5E5"> it will run</font><font color="#CCCCCC"> the mother</font><font color="#E5E5E5"> itself but</font>

497
00:27:03,360 --> 00:27:09,090
<font color="#E5E5E5">don't worry if you're infected with</font>

498
00:27:05,340 --> 00:27:12,860
<font color="#E5E5E5">Pecha it will reset itself so you</font><font color="#CCCCCC"> don't</font>

499
00:27:09,090 --> 00:27:15,810
need to reset it will first get and

500
00:27:12,860 --> 00:27:21,439
escalate the privileges<font color="#E5E5E5"> okay using this</font>

501
00:27:15,810 --> 00:27:25,230
<font color="#CCCCCC">api's</font><font color="#E5E5E5"> okay and then it will</font><font color="#CCCCCC"> execute this</font>

502
00:27:21,440 --> 00:27:28,179
<font color="#CCCCCC">API the NT race hard error</font><font color="#E5E5E5"> okay once you</font>

503
00:27:25,230 --> 00:27:31,629
execute that<font color="#E5E5E5"> it will automatically</font>

504
00:27:28,179 --> 00:27:33,669
reboot<font color="#CCCCCC"> the system for you okay</font><font color="#E5E5E5"> once it</font>

505
00:27:31,629 --> 00:27:37,090
is<font color="#E5E5E5"> executed there is not the persuade</font>

506
00:27:33,669 --> 00:27:39,309
<font color="#E5E5E5">load once it</font><font color="#CCCCCC"> is executed</font><font color="#E5E5E5"> okay it is</font>

507
00:27:37,090 --> 00:27:41,559
something<font color="#E5E5E5"> like the</font><font color="#CCCCCC"> file</font><font color="#E5E5E5"> the malware</font>

508
00:27:39,309 --> 00:27:45,639
except the executable will now transfer

509
00:27:41,559 --> 00:27:49,119
the execution to the<font color="#CCCCCC"> MBR</font><font color="#E5E5E5"> to the Master</font>

510
00:27:45,639 --> 00:27:51,610
Boot Record<font color="#CCCCCC"> so now we risk it resets the</font>

511
00:27:49,119 --> 00:27:55,678
system<font color="#CCCCCC"> okay now we are going to though</font>

512
00:27:51,610 --> 00:27:59,168
to see how<font color="#CCCCCC"> it works how we can try to</font>

513
00:27:55,679 --> 00:28:01,659
reverse have you tried reversing or

514
00:27:59,169 --> 00:28:05,710
<font color="#E5E5E5">analyzing the Master Boot Record boot</font>

515
00:28:01,659 --> 00:28:11,440
sector<font color="#E5E5E5"> what what does</font><font color="#CCCCCC"> it use to use this</font>

516
00:28:05,710 --> 00:28:14,350
one yeah boss<font color="#CCCCCC"> I don't know how to say it</font>

517
00:28:11,440 --> 00:28:17,919
box or watch okay it is actually this

518
00:28:14,350 --> 00:28:19,990
sign to<font color="#E5E5E5"> emulate a DOS application</font>

519
00:28:17,919 --> 00:28:23,139
<font color="#E5E5E5">okay for example</font><font color="#CCCCCC"> your</font><font color="#E5E5E5"> windows you want</font>

520
00:28:19,990 --> 00:28:25,779
to play your favorite Mario<font color="#E5E5E5"> Brothers</font>

521
00:28:23,139 --> 00:28:27,610
those application<font color="#CCCCCC"> okay there's no way to</font>

522
00:28:25,779 --> 00:28:29,980
run it<font color="#E5E5E5"> because it's probably not gonna</font>

523
00:28:27,610 --> 00:28:33,248
<font color="#E5E5E5">run in your system</font><font color="#CCCCCC"> okay you can run this</font>

524
00:28:29,980 --> 00:28:35,950
using this one<font color="#E5E5E5"> it is you can download</font>

525
00:28:33,249 --> 00:28:38,350
this<font color="#E5E5E5"> one for free</font><font color="#CCCCCC"> okay and then you can</font>

526
00:28:35,950 --> 00:28:41,230
run<font color="#E5E5E5"> your system with that but this one I</font>

527
00:28:38,350 --> 00:28:45,580
didn't use<font color="#E5E5E5"> it to run Super Mario DOS</font>

528
00:28:41,230 --> 00:28:48,970
version<font color="#E5E5E5"> I use it to to debug the Master</font>

529
00:28:45,580 --> 00:28:51,939
Boot Record<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> okay this one the box</font>

530
00:28:48,970 --> 00:28:55,509
is actually can simulate your<font color="#E5E5E5"> Intel</font>

531
00:28:51,940 --> 00:28:58,899
<font color="#E5E5E5">eight-six KO x86 computers</font><font color="#CCCCCC"> okay you can</font>

532
00:28:55,509 --> 00:29:01,029
run all those program<font color="#CCCCCC"> ok</font><font color="#E5E5E5"> and now you can</font>

533
00:28:58,899 --> 00:29:03,939
<font color="#E5E5E5">use your you</font><font color="#CCCCCC"> can use it to debug your</font>

534
00:29:01,029 --> 00:29:05,590
Master Boot Record<font color="#CCCCCC"> okay it</font><font color="#E5E5E5"> doesn't</font>

535
00:29:03,940 --> 00:29:09,369
<font color="#E5E5E5">matter if it is impacted or not you can</font>

536
00:29:05,590 --> 00:29:12,158
just impact it<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> or you can just you</font>

537
00:29:09,369 --> 00:29:17,220
can just debug it<font color="#E5E5E5"> okay okay for this one</font>

538
00:29:12,159 --> 00:29:21,940
<font color="#CCCCCC">or</font><font color="#E5E5E5"> this particular infection</font><font color="#CCCCCC"> okay I</font>

539
00:29:17,220 --> 00:29:24,970
executed<font color="#CCCCCC"> books one by</font><font color="#E5E5E5"> one instruction by</font>

540
00:29:21,940 --> 00:29:29,980
instruction<font color="#E5E5E5"> I executed it like</font><font color="#CCCCCC"> five</font>

541
00:29:24,970 --> 00:29:33,399
million steps in order<font color="#E5E5E5"> to</font><font color="#CCCCCC"> go</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> 7000</font>

542
00:29:29,980 --> 00:29:36,340
<font color="#CCCCCC">that is</font><font color="#E5E5E5"> the very start of any operating</font>

543
00:29:33,399 --> 00:29:38,678
system<font color="#E5E5E5"> that is</font><font color="#CCCCCC"> that time it is going</font><font color="#E5E5E5"> to</font>

544
00:29:36,340 --> 00:29:42,370
<font color="#E5E5E5">decide which operating system it is</font>

545
00:29:38,679 --> 00:29:44,200
<font color="#CCCCCC">going to use</font><font color="#E5E5E5"> okay so maybe</font>

546
00:29:42,370 --> 00:29:46,679
<font color="#E5E5E5">to execute</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> on your own machine is</font>

547
00:29:44,200 --> 00:29:49,150
<font color="#E5E5E5">probably a different</font><font color="#CCCCCC"> number but I</font>

548
00:29:46,680 --> 00:29:52,210
specifically execute<font color="#E5E5E5"> this one so I think</font>

549
00:29:49,150 --> 00:29:55,720
<font color="#E5E5E5">it took</font><font color="#CCCCCC"> me two months to to press it</font>

550
00:29:52,210 --> 00:29:57,660
until<font color="#E5E5E5"> it I finally find the seven</font><font color="#CCCCCC"> CCC</font>

551
00:29:55,720 --> 00:30:00,760
and<font color="#CCCCCC"> just</font><font color="#E5E5E5"> doing that</font><font color="#CCCCCC"> for two months</font>

552
00:29:57,660 --> 00:30:03,430
that's my job<font color="#CCCCCC"> okay and then you will be</font>

553
00:30:00,760 --> 00:30:06,850
able to<font color="#CCCCCC"> see the very first</font><font color="#E5E5E5"> sector loaded</font>

554
00:30:03,430 --> 00:30:09,040
at zero seven zero zero zero and then

555
00:30:06,850 --> 00:30:11,050
that is<font color="#E5E5E5"> actually the bootstrap the</font>

556
00:30:09,040 --> 00:30:16,149
bootstrap is where it decides which

557
00:30:11,050 --> 00:30:20,020
kernel it is going<font color="#CCCCCC"> to execute see what</font>

558
00:30:16,150 --> 00:30:23,410
my hands<font color="#E5E5E5"> now</font><font color="#CCCCCC"> okay this is not</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> new</font>

559
00:30:20,020 --> 00:30:26,260
and<font color="#CCCCCC"> we are the new</font><font color="#E5E5E5"> MV r KP rich</font><font color="#CCCCCC"> zero</font><font color="#E5E5E5"> x</font>

560
00:30:23,410 --> 00:30:29,020
seven zero zero<font color="#E5E5E5"> location or upset okay</font>

561
00:30:26,260 --> 00:30:32,770
you will<font color="#CCCCCC"> be able to</font><font color="#E5E5E5"> to now execute this</font>

562
00:30:29,020 --> 00:30:35,520
one<font color="#E5E5E5"> okay the only problem with box this</font>

563
00:30:32,770 --> 00:30:38,470
is now how the Box looks like this is

564
00:30:35,520 --> 00:30:39,910
<font color="#E5E5E5">the emulator and the debugger itself</font>

565
00:30:38,470 --> 00:30:42,040
<font color="#CCCCCC">okay the only</font><font color="#E5E5E5"> problem with this one if</font>

566
00:30:39,910 --> 00:30:44,800
you're if<font color="#CCCCCC"> you're familiar with</font><font color="#E5E5E5"> early</font>

567
00:30:42,040 --> 00:30:46,750
debug or immunity debugger<font color="#CCCCCC"> it is</font><font color="#E5E5E5"> user</font>

568
00:30:44,800 --> 00:30:48,300
<font color="#E5E5E5">friendly</font><font color="#CCCCCC"> you can just every time</font><font color="#E5E5E5"> you</font>

569
00:30:46,750 --> 00:30:50,200
move something<font color="#E5E5E5"> instructions</font>

570
00:30:48,300 --> 00:30:53,350
automatically the rest of the windows

571
00:30:50,200 --> 00:30:55,840
<font color="#CCCCCC">follows</font><font color="#E5E5E5"> right but this</font><font color="#CCCCCC"> one</font><font color="#E5E5E5"> using box is</font>

572
00:30:53,350 --> 00:30:58,510
very hard because every time you execute

573
00:30:55,840 --> 00:31:01,689
something<font color="#E5E5E5"> you have</font><font color="#CCCCCC"> to refresh this</font>

574
00:30:58,510 --> 00:31:03,400
window and this window because it

575
00:31:01,690 --> 00:31:06,190
doesn't actually totally follow you

576
00:31:03,400 --> 00:31:09,610
<font color="#E5E5E5">right</font><font color="#CCCCCC"> okay if you want to this is</font><font color="#E5E5E5"> the</font>

577
00:31:06,190 --> 00:31:11,950
one that<font color="#E5E5E5"> I press</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> you press</font><font color="#CCCCCC"> C k five</font>

578
00:31:09,610 --> 00:31:15,959
million<font color="#E5E5E5"> times you will be</font><font color="#CCCCCC"> able to</font><font color="#E5E5E5"> see</font>

579
00:31:11,950 --> 00:31:18,460
your code or<font color="#CCCCCC"> 7000</font><font color="#E5E5E5"> execution this is your</font>

580
00:31:15,960 --> 00:31:20,080
register windows this<font color="#CCCCCC"> is your dump</font>

581
00:31:18,460 --> 00:31:22,750
window this is<font color="#CCCCCC"> the one</font><font color="#E5E5E5"> that you have to</font>

582
00:31:20,080 --> 00:31:25,059
refresh every time and this is<font color="#E5E5E5"> your code</font>

583
00:31:22,750 --> 00:31:27,370
the<font color="#E5E5E5"> only problem with this one is</font><font color="#CCCCCC"> if</font>

584
00:31:25,059 --> 00:31:30,490
you're used to analyzing<font color="#E5E5E5"> or reversing</font>

585
00:31:27,370 --> 00:31:34,169
<font color="#CCCCCC">windows application k the earth api s--</font>

586
00:31:30,490 --> 00:31:36,850
k<font color="#CCCCCC"> api</font><font color="#E5E5E5"> is like</font><font color="#CCCCCC"> like read the ball</font>

587
00:31:34,170 --> 00:31:39,790
instructions<font color="#CCCCCC"> okay pour this</font><font color="#E5E5E5"> one there's</font>

588
00:31:36,850 --> 00:31:42,309
no API<font color="#CCCCCC"> yet</font><font color="#E5E5E5"> because it doesn't know yet</font>

589
00:31:39,790 --> 00:31:48,730
<font color="#E5E5E5">if</font><font color="#CCCCCC"> you're</font><font color="#E5E5E5"> using Linux or Windows right</font>

590
00:31:42,309 --> 00:31:50,920
<font color="#E5E5E5">so it only uses interrupts have you</font>

591
00:31:48,730 --> 00:31:55,740
created<font color="#CCCCCC"> a program using</font><font color="#E5E5E5"> interrupts</font>

592
00:31:50,920 --> 00:31:58,679
assembly language<font color="#CCCCCC"> this one in order to</font>

593
00:31:55,740 --> 00:32:00,420
to read<font color="#E5E5E5"> the functions or for example</font><font color="#CCCCCC"> you</font>

594
00:31:58,679 --> 00:32:04,050
want<font color="#CCCCCC"> to</font><font color="#E5E5E5"> change the</font><font color="#CCCCCC"> video mode you have</font>

595
00:32:00,420 --> 00:32:06,300
<font color="#E5E5E5">to</font><font color="#CCCCCC"> use interrupts n if</font><font color="#E5E5E5"> you want to to do</font>

596
00:32:04,050 --> 00:32:09,960
some readings of the<font color="#E5E5E5"> version extended</font>

597
00:32:06,300 --> 00:32:12,720
read sectors<font color="#E5E5E5"> here to use function</font><font color="#CCCCCC"> 42k</font>

598
00:32:09,960 --> 00:32:14,520
<font color="#CCCCCC">interrupt 13 in</font><font color="#E5E5E5"> order to do that all you</font>

599
00:32:12,720 --> 00:32:16,890
<font color="#CCCCCC">have to do is to set up the registers</font>

600
00:32:14,520 --> 00:32:19,350
<font color="#CCCCCC">that is how you program in assembly</font><font color="#E5E5E5"> you</font>

601
00:32:16,890 --> 00:32:22,320
set up all the registers the bodies and

602
00:32:19,350 --> 00:32:25,830
<font color="#CCCCCC">everything and then execute interrupts</font>

603
00:32:22,320 --> 00:32:29,879
<font color="#E5E5E5">13 it will be able to do your functions</font>

604
00:32:25,830 --> 00:32:33,720
<font color="#CCCCCC">ok ok this</font><font color="#E5E5E5"> is the format were in</font><font color="#CCCCCC"> ok</font><font color="#E5E5E5"> this</font>

605
00:32:29,880 --> 00:32:36,420
is the content of<font color="#E5E5E5"> your boot sector part</font>

606
00:32:33,720 --> 00:32:39,570
of the boot sector we're in this is<font color="#E5E5E5"> now</font>

607
00:32:36,420 --> 00:32:43,100
<font color="#E5E5E5">where it tries to transfer your MBR it</font>

608
00:32:39,570 --> 00:32:46,409
tries to impact this is how<font color="#E5E5E5"> petia reads</font>

609
00:32:43,100 --> 00:32:49,050
<font color="#E5E5E5">the part</font><font color="#CCCCCC"> we're in it will read sector</font><font color="#E5E5E5"> 1</font>

610
00:32:46,410 --> 00:32:51,690
and creep<font color="#E5E5E5"> and write it back read sector</font>

611
00:32:49,050 --> 00:32:53,879
2 and so on<font color="#E5E5E5"> and</font><font color="#CCCCCC"> so forth ok this is what</font>

612
00:32:51,690 --> 00:32:57,120
we call the<font color="#E5E5E5"> da P that this address</font>

613
00:32:53,880 --> 00:32:59,070
pocket<font color="#CCCCCC"> cape or patias code this values</font>

614
00:32:57,120 --> 00:33:02,100
are<font color="#CCCCCC"> the very person this is not the</font><font color="#E5E5E5"> very</font>

615
00:32:59,070 --> 00:33:07,220
first part<font color="#E5E5E5"> or value of this one in order</font>

616
00:33:02,100 --> 00:33:14,639
<font color="#E5E5E5">to read your your MBR are still awake</font>

617
00:33:07,220 --> 00:33:16,940
sleeping<font color="#E5E5E5"> if you want to read</font><font color="#CCCCCC"> Cape you</font>

618
00:33:14,640 --> 00:33:21,390
want to read this<font color="#CCCCCC"> this one</font>

619
00:33:16,940 --> 00:33:24,000
it reads<font color="#E5E5E5"> 200 bytes from sector 22</font><font color="#CCCCCC"> and so</font>

620
00:33:21,390 --> 00:33:27,210
on and so forth<font color="#CCCCCC"> key in order</font><font color="#E5E5E5"> to to</font><font color="#CCCCCC"> to</font>

621
00:33:24,000 --> 00:33:30,540
hide the MBR<font color="#CCCCCC"> ok this is where</font><font color="#E5E5E5"> it</font>

622
00:33:27,210 --> 00:33:33,929
transfers the<font color="#CCCCCC"> when it runs the</font><font color="#E5E5E5"> the MBR</font>

623
00:33:30,540 --> 00:33:36,480
code<font color="#CCCCCC"> it gets the</font><font color="#E5E5E5"> 22 remember that the</font>

624
00:33:33,929 --> 00:33:38,700
sector 22 contains<font color="#CCCCCC"> awareness</font><font color="#E5E5E5"> it transfer</font>

625
00:33:36,480 --> 00:33:41,429
it<font color="#CCCCCC"> back and</font><font color="#E5E5E5"> then jumps back to that one</font>

626
00:33:38,700 --> 00:33:43,260
and<font color="#CCCCCC"> then execute the the kernel code</font>

627
00:33:41,429 --> 00:33:48,179
this is<font color="#E5E5E5"> now where it starts executing</font>

628
00:33:43,260 --> 00:33:49,980
<font color="#E5E5E5">its kernel ok again some of the</font>

629
00:33:48,179 --> 00:33:52,350
challenges of debugging<font color="#CCCCCC"> the MBR the</font>

630
00:33:49,980 --> 00:33:54,390
Master Boot Record using box is<font color="#CCCCCC"> Kate</font>

631
00:33:52,350 --> 00:33:56,790
<font color="#CCCCCC">Adam is not interactive yet to keep</font>

632
00:33:54,390 --> 00:34:00,000
refreshing it and then of course<font color="#E5E5E5"> it you</font>

633
00:33:56,790 --> 00:34:02,129
cannot put like<font color="#E5E5E5"> labels and</font><font color="#CCCCCC"> and comments</font>

634
00:34:00,000 --> 00:34:03,809
<font color="#E5E5E5">let's not try to initialize some video</font>

635
00:34:02,130 --> 00:34:06,260
screen<font color="#CCCCCC"> all you have to do is to run</font>

636
00:34:03,809 --> 00:34:09,000
<font color="#CCCCCC">interrupt n and then change it to</font><font color="#E5E5E5"> this</font>

637
00:34:06,260 --> 00:34:09,739
values those are<font color="#E5E5E5"> some of the codes in</font>

638
00:34:09,000 --> 00:34:13,129
picture

639
00:34:09,739 --> 00:34:19,069
<font color="#CCCCCC">okay this is the part where I stock up</font>

640
00:34:13,129 --> 00:34:21,290
is the MBR<font color="#CCCCCC"> and also</font><font color="#E5E5E5"> this one it is now</font>

641
00:34:19,070 --> 00:34:24,409
<font color="#E5E5E5">this one contains the tour addresses</font>

642
00:34:21,290 --> 00:34:28,129
<font color="#E5E5E5">okay if you see tour addresses in</font><font color="#CCCCCC"> your</font>

643
00:34:24,409 --> 00:34:30,440
<font color="#E5E5E5">set or in any sector that</font><font color="#CCCCCC"> you have</font><font color="#E5E5E5"> okay</font>

644
00:34:28,129 --> 00:34:36,259
<font color="#CCCCCC">you might be infected with Pecha</font><font color="#E5E5E5"> or</font>

645
00:34:30,440 --> 00:34:38,119
infected with some malware<font color="#E5E5E5"> okay this is</font>

646
00:34:36,260 --> 00:34:40,220
the one<font color="#E5E5E5"> that it reads the sector</font><font color="#CCCCCC"> the</font>

647
00:34:38,119 --> 00:34:42,950
<font color="#CCCCCC">only problem with</font><font color="#E5E5E5"> this one is this</font>

648
00:34:40,219 --> 00:34:45,439
particular byte in<font color="#CCCCCC"> doors in your boot</font>

649
00:34:42,949 --> 00:34:48,439
sector in your Master Boot Record<font color="#E5E5E5"> is the</font>

650
00:34:45,440 --> 00:34:52,070
encryption marker<font color="#E5E5E5"> okay Pecha</font><font color="#CCCCCC"> we'll we'll</font>

651
00:34:48,440 --> 00:34:56,089
check if that<font color="#E5E5E5"> byte or that marker</font><font color="#CCCCCC"> is 0</font>

652
00:34:52,070 --> 00:34:59,030
if it is 0 that<font color="#E5E5E5"> means your MBR the rest</font>

653
00:34:56,089 --> 00:35:02,240
of your MBR is not yet encrypted

654
00:34:59,030 --> 00:35:05,390
remember it encrypts your MBR using 37

655
00:35:02,240 --> 00:35:08,450
hex<font color="#CCCCCC"> ok</font><font color="#E5E5E5"> but it will go it is going to</font>

656
00:35:05,390 --> 00:35:10,970
encrypt the rest of your hard drive<font color="#CCCCCC"> ok</font>

657
00:35:08,450 --> 00:35:14,240
<font color="#E5E5E5">using a different encryption</font>

658
00:35:10,970 --> 00:35:17,480
<font color="#CCCCCC">I think it's using salsa 20 ok and then</font>

659
00:35:14,240 --> 00:35:21,740
if it is 0<font color="#CCCCCC"> it will start encrypting your</font>

660
00:35:17,480 --> 00:35:24,650
the recipe or your MBR and<font color="#E5E5E5"> then</font><font color="#CCCCCC"> if it</font><font color="#E5E5E5"> is</font>

661
00:35:21,740 --> 00:35:27,830
1 it will stop encrypting it will show

662
00:35:24,650 --> 00:35:32,290
you the ransom note<font color="#CCCCCC"> ok</font><font color="#E5E5E5"> there is a risk</font>

663
00:35:27,830 --> 00:35:35,330
on this checking<font color="#E5E5E5"> will show you later</font>

664
00:35:32,290 --> 00:35:38,060
this<font color="#CCCCCC"> is the initial display wherein if</font>

665
00:35:35,330 --> 00:35:44,619
you run your your<font color="#E5E5E5"> picture in the kernel</font>

666
00:35:38,060 --> 00:35:44,619
code<font color="#E5E5E5"> ok you will see something like this</font>

667
00:35:50,810 --> 00:36:00,049
it is an output up like a<font color="#CCCCCC"> toadstool do</font>

668
00:35:56,070 --> 00:36:03,810
you know<font color="#E5E5E5"> what's what</font><font color="#CCCCCC"> does</font><font color="#E5E5E5"> this anybody</font>

669
00:36:00,050 --> 00:36:07,860
<font color="#E5E5E5">it is</font><font color="#CCCCCC"> a check this it looks like a check</font>

670
00:36:03,810 --> 00:36:11,130
this okay<font color="#E5E5E5"> because it's like going to</font>

671
00:36:07,860 --> 00:36:15,270
<font color="#CCCCCC">this be poor when</font><font color="#E5E5E5"> you when you're trying</font>

672
00:36:11,130 --> 00:36:17,520
to<font color="#E5E5E5"> like reset your machine improperly it</font>

673
00:36:15,270 --> 00:36:20,400
it<font color="#CCCCCC"> trans this or you can actually</font><font color="#E5E5E5"> run</font>

674
00:36:17,520 --> 00:36:22,500
this on your<font color="#CCCCCC"> own</font><font color="#E5E5E5"> to check if your this</font>

675
00:36:20,400 --> 00:36:26,210
is still in good condition

676
00:36:22,500 --> 00:36:29,310
okay so<font color="#CCCCCC"> petia</font><font color="#E5E5E5"> is actually using the same</font>

677
00:36:26,210 --> 00:36:33,390
the same display or<font color="#E5E5E5"> the same strings</font>

678
00:36:29,310 --> 00:36:35,790
<font color="#CCCCCC">okay in order</font><font color="#E5E5E5"> to to try to pull you that</font>

679
00:36:33,390 --> 00:36:38,009
it is checking your<font color="#E5E5E5"> disk</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> this is</font>

680
00:36:35,790 --> 00:36:41,340
the code<font color="#CCCCCC"> where in this part of</font><font color="#E5E5E5"> the code</font>

681
00:36:38,010 --> 00:36:43,860
<font color="#CCCCCC">is the one</font><font color="#E5E5E5"> just displaying the bytes</font><font color="#CCCCCC"> one</font>

682
00:36:41,340 --> 00:36:50,340
by<font color="#E5E5E5"> one displaying the strings one by one</font>

683
00:36:43,860 --> 00:36:53,720
it is part of<font color="#CCCCCC"> petia kernel code what</font>

684
00:36:50,340 --> 00:36:58,440
happen<font color="#CCCCCC"> so this</font><font color="#E5E5E5"> is just displaying the</font>

685
00:36:53,720 --> 00:37:00,689
<font color="#E5E5E5">those codes okay and then again</font><font color="#CCCCCC"> it</font>

686
00:36:58,440 --> 00:37:03,600
checks for the encryption marker<font color="#E5E5E5"> if it</font>

687
00:37:00,690 --> 00:37:05,940
is 1 it<font color="#CCCCCC"> is already in cryptid</font><font color="#E5E5E5"> if it is</font>

688
00:37:03,600 --> 00:37:09,420
not it will<font color="#CCCCCC"> start encryption what</font>

689
00:37:05,940 --> 00:37:12,240
happens<font color="#CCCCCC"> okay this is the part where in</font>

690
00:37:09,420 --> 00:37:16,350
it gets the the sector<font color="#CCCCCC"> that it wants to</font>

691
00:37:12,240 --> 00:37:18,240
encrypt<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> but</font><font color="#CCCCCC"> petia unlike some</font>

692
00:37:16,350 --> 00:37:21,240
ransomware most of the ransomware that

693
00:37:18,240 --> 00:37:24,600
we know is actually<font color="#E5E5E5"> encrypting your</font>

694
00:37:21,240 --> 00:37:27,089
files right<font color="#E5E5E5"> you get</font><font color="#CCCCCC"> thing they get the</font>

695
00:37:24,600 --> 00:37:28,020
files<font color="#E5E5E5"> they encrypt it and then once you</font>

696
00:37:27,090 --> 00:37:30,270
pay the ransomware

697
00:37:28,020 --> 00:37:32,610
<font color="#E5E5E5">ok ransom note</font><font color="#CCCCCC"> and then they will</font><font color="#E5E5E5"> try to</font>

698
00:37:30,270 --> 00:37:36,030
give<font color="#CCCCCC"> you the</font><font color="#E5E5E5"> decryption key but this one</font>

699
00:37:32,610 --> 00:37:40,080
<font color="#E5E5E5">or Pecha it is not actually encrypting</font>

700
00:37:36,030 --> 00:37:42,600
your files<font color="#CCCCCC"> okay it it overrides your</font>

701
00:37:40,080 --> 00:37:47,220
Master Boot Record<font color="#CCCCCC"> but</font><font color="#E5E5E5"> it is going to</font>

702
00:37:42,600 --> 00:37:50,279
encrypt your<font color="#CCCCCC"> MFD the master master file</font>

703
00:37:47,220 --> 00:37:54,240
table<font color="#E5E5E5"> the master file table contains the</font>

704
00:37:50,280 --> 00:37:57,240
<font color="#E5E5E5">headers of your files</font><font color="#CCCCCC"> ok so if</font><font color="#E5E5E5"> you have</font>

705
00:37:54,240 --> 00:37:59,819
100 parts those 100 parts will contain

706
00:37:57,240 --> 00:38:04,029
an entry each of them will contain an

707
00:37:59,820 --> 00:38:06,100
entry in the<font color="#E5E5E5"> MIT in the</font><font color="#CCCCCC"> master files</font>

708
00:38:04,030 --> 00:38:09,190
okay so<font color="#E5E5E5"> pizza is not encrypting your</font>

709
00:38:06,100 --> 00:38:12,040
<font color="#E5E5E5">part it is encrypting your empty that</font>

710
00:38:09,190 --> 00:38:13,960
means if you're using<font color="#E5E5E5"> some forensic tool</font>

711
00:38:12,040 --> 00:38:16,630
capable<font color="#CCCCCC"> sample you're already infected</font>

712
00:38:13,960 --> 00:38:20,620
<font color="#CCCCCC">you can use some forensic tool to brute</font>

713
00:38:16,630 --> 00:38:23,170
force<font color="#CCCCCC"> okay to grab each file it may</font><font color="#E5E5E5"> not</font>

714
00:38:20,620 --> 00:38:26,980
have<font color="#CCCCCC"> the proper</font><font color="#E5E5E5"> file name but at least</font>

715
00:38:23,170 --> 00:38:29,110
you can still get your your files<font color="#CCCCCC"> that</font>

716
00:38:26,980 --> 00:38:30,670
<font color="#E5E5E5">is this version</font><font color="#CCCCCC"> may be the other</font>

717
00:38:29,110 --> 00:38:37,570
<font color="#E5E5E5">versions are already in creating the</font>

718
00:38:30,670 --> 00:38:40,030
files<font color="#E5E5E5"> okay the next</font><font color="#CCCCCC"> setup</font><font color="#E5E5E5"> display is</font>

719
00:38:37,570 --> 00:38:42,610
<font color="#E5E5E5">actually it is going to space this this</font>

720
00:38:40,030 --> 00:38:45,550
<font color="#E5E5E5">value here okay check this is repairing</font>

721
00:38:42,610 --> 00:38:48,370
sector<font color="#E5E5E5"> this actually repairing part is</font>

722
00:38:45,550 --> 00:38:51,250
actually<font color="#E5E5E5"> the infection part the</font><font color="#CCCCCC"> the</font>

723
00:38:48,370 --> 00:38:55,060
encryption<font color="#E5E5E5"> okay and this one is</font><font color="#CCCCCC"> actually</font>

724
00:38:51,250 --> 00:38:58,060
<font color="#CCCCCC">the number</font><font color="#E5E5E5"> of sectors that the</font><font color="#CCCCCC"> empty the</font>

725
00:38:55,060 --> 00:39:01,090
<font color="#CCCCCC">empty is occupying</font><font color="#E5E5E5"> okay</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> actually the</font>

726
00:38:58,060 --> 00:39:04,540
computation here<font color="#E5E5E5"> is actually precise it</font>

727
00:39:01,090 --> 00:39:08,800
dip it it depends on your number of

728
00:39:04,540 --> 00:39:12,310
sectors that contains the MFD it is

729
00:39:08,800 --> 00:39:14,920
going<font color="#E5E5E5"> to impact your file or</font><font color="#CCCCCC"> the mep</font><font color="#E5E5E5"> the</font>

730
00:39:12,310 --> 00:39:17,980
header scale so this is a typical<font color="#E5E5E5"> empty</font>

731
00:39:14,920 --> 00:39:20,080
entry<font color="#E5E5E5"> for a single file</font><font color="#CCCCCC"> okay after</font>

732
00:39:17,980 --> 00:39:22,630
<font color="#E5E5E5">infection</font><font color="#CCCCCC"> it will look something</font><font color="#E5E5E5"> like</font>

733
00:39:20,080 --> 00:39:25,810
this okay take note<font color="#CCCCCC"> that this is</font><font color="#E5E5E5"> not</font>

734
00:39:22,630 --> 00:39:28,930
encrypted<font color="#E5E5E5"> using</font><font color="#CCCCCC"> 0 x</font><font color="#E5E5E5"> 37 it is encrypted</font>

735
00:39:25,810 --> 00:39:31,150
<font color="#E5E5E5">with salsa</font><font color="#CCCCCC"> 20 with its own other keys</font>

736
00:39:28,930 --> 00:39:37,319
<font color="#E5E5E5">that's why you need</font><font color="#CCCCCC"> to have the key to</font>

737
00:39:31,150 --> 00:39:41,800
into the<font color="#E5E5E5"> creep this is how it tries to</font>

738
00:39:37,320 --> 00:39:44,950
<font color="#CCCCCC">encrypt then keep</font><font color="#E5E5E5"> your empty these are</font>

739
00:39:41,800 --> 00:39:47,770
the codes<font color="#E5E5E5"> to reduce it's just using</font><font color="#CCCCCC"> the</font>

740
00:39:44,950 --> 00:39:54,330
again still using some some interrupts

741
00:39:47,770 --> 00:39:58,120
inside those calls it will start

742
00:39:54,330 --> 00:40:00,880
<font color="#E5E5E5">counting those counting is actually when</font>

743
00:39:58,120 --> 00:40:03,040
is tried<font color="#CCCCCC"> to impacts each sector that</font>

744
00:40:00,880 --> 00:40:05,920
contains<font color="#CCCCCC"> them empty</font><font color="#E5E5E5"> so this is a typical</font>

745
00:40:03,040 --> 00:40:10,950
see<font color="#E5E5E5"> I have to depress every time that is</font>

746
00:40:05,920 --> 00:40:10,950
<font color="#E5E5E5">the typical</font><font color="#CCCCCC"> ma P entry</font>

747
00:40:12,290 --> 00:40:18,230
<font color="#CCCCCC">okay after</font><font color="#E5E5E5"> executing that function it</font>

748
00:40:14,960 --> 00:40:21,650
would actually be encrypted<font color="#CCCCCC"> okay refresh</font>

749
00:40:18,230 --> 00:40:25,040
again<font color="#E5E5E5"> hey there is</font><font color="#CCCCCC"> no your empty</font><font color="#E5E5E5"> that is</font>

750
00:40:21,650 --> 00:40:28,010
<font color="#CCCCCC">no your entry it is</font><font color="#E5E5E5"> now encrypted</font><font color="#CCCCCC"> it</font>

751
00:40:25,040 --> 00:40:30,369
will start going to do the same thing

752
00:40:28,010 --> 00:40:33,980
over and<font color="#E5E5E5"> over again until it finally</font>

753
00:40:30,369 --> 00:40:38,359
<font color="#E5E5E5">encrypts encrypts the whole</font><font color="#CCCCCC"> mep</font><font color="#E5E5E5"> the</font>

754
00:40:33,980 --> 00:40:41,240
problem is once you see this<font color="#E5E5E5"> particular</font>

755
00:40:38,359 --> 00:40:45,009
<font color="#E5E5E5">part of the infection appear in the</font>

756
00:40:41,240 --> 00:40:49,000
middle<font color="#CCCCCC"> of this one they</font><font color="#E5E5E5"> never ever</font>

757
00:40:45,010 --> 00:40:51,950
terminate or turn up your machine<font color="#E5E5E5"> why</font>

758
00:40:49,000 --> 00:40:53,869
because if it happens<font color="#E5E5E5"> that it is not yet</font>

759
00:40:51,950 --> 00:40:57,230
complete<font color="#CCCCCC"> if it is if you're in the</font>

760
00:40:53,869 --> 00:40:59,210
<font color="#E5E5E5">middle</font><font color="#CCCCCC"> of it for example it encrypts</font><font color="#E5E5E5"> 50%</font>

761
00:40:57,230 --> 00:41:01,820
and<font color="#E5E5E5"> you</font><font color="#CCCCCC"> might think that you can</font>

762
00:40:59,210 --> 00:41:05,260
actually<font color="#CCCCCC"> get get away</font><font color="#E5E5E5"> with it but the</font>

763
00:41:01,820 --> 00:41:09,260
<font color="#E5E5E5">problem is if you're</font><font color="#CCCCCC"> infected with</font><font color="#E5E5E5"> 50%</font>

764
00:41:05,260 --> 00:41:09,920
<font color="#CCCCCC">okay and then you decided</font><font color="#E5E5E5"> to pay the</font>

765
00:41:09,260 --> 00:41:13,910
ransomware

766
00:41:09,920 --> 00:41:16,760
<font color="#CCCCCC">okay what happens the ransomware if they</font>

767
00:41:13,910 --> 00:41:18,230
are going<font color="#E5E5E5"> to give you the key remember</font>

768
00:41:16,760 --> 00:41:21,859
that they will give you the decryption

769
00:41:18,230 --> 00:41:25,280
<font color="#E5E5E5">key</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> your decryption key will</font>

770
00:41:21,859 --> 00:41:28,670
decrypt the<font color="#CCCCCC"> 50%</font><font color="#E5E5E5"> what happens to the</font>

771
00:41:25,280 --> 00:41:32,109
other 50% your decryption key now is the

772
00:41:28,670 --> 00:41:35,030
key to encrypt the rest of your 50%

773
00:41:32,109 --> 00:41:38,690
<font color="#CCCCCC">remember</font><font color="#E5E5E5"> so that's why when you</font><font color="#CCCCCC"> see this</font>

774
00:41:35,030 --> 00:41:43,850
happening<font color="#E5E5E5"> never ever stop your machine</font>

775
00:41:38,690 --> 00:41:46,520
just<font color="#CCCCCC"> let</font><font color="#E5E5E5"> it go it's it's done right</font><font color="#CCCCCC"> you</font>

776
00:41:43,850 --> 00:41:49,400
<font color="#CCCCCC">saw that when</font><font color="#E5E5E5"> you when it's time for</font><font color="#CCCCCC"> you</font>

777
00:41:46,520 --> 00:41:52,220
to decide<font color="#CCCCCC"> to buy or</font><font color="#E5E5E5"> to paper the</font>

778
00:41:49,400 --> 00:41:55,310
<font color="#E5E5E5">ransomware</font><font color="#CCCCCC"> okay at least your decryption</font>

779
00:41:52,220 --> 00:41:58,459
key<font color="#E5E5E5"> will be</font><font color="#CCCCCC"> able</font><font color="#E5E5E5"> to decrypt the whole</font>

780
00:41:55,310 --> 00:42:00,619
thing 100% so keep in mind<font color="#CCCCCC"> if you're</font>

781
00:41:58,460 --> 00:42:02,470
interested with<font color="#CCCCCC"> Pecha k you have</font><font color="#E5E5E5"> to</font>

782
00:42:00,619 --> 00:42:06,560
complete I'm not endorsing the malware

783
00:42:02,470 --> 00:42:08,959
<font color="#E5E5E5">okay so make sure that you are in the</font>

784
00:42:06,560 --> 00:42:10,880
process<font color="#E5E5E5"> of it should be</font><font color="#CCCCCC"> able</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> dick to</font>

785
00:42:08,960 --> 00:42:17,960
encrypt the whole thing<font color="#E5E5E5"> otherwise you</font>

786
00:42:10,880 --> 00:42:20,540
will have a half-baked<font color="#CCCCCC"> MFP okay okay</font>

787
00:42:17,960 --> 00:42:24,290
after the encryption for example we

788
00:42:20,540 --> 00:42:26,200
decided to let<font color="#CCCCCC"> it</font><font color="#E5E5E5"> go okay</font><font color="#CCCCCC"> and then the</font>

789
00:42:24,290 --> 00:42:30,380
malware will actually

790
00:42:26,200 --> 00:42:33,379
do a second reboot<font color="#E5E5E5"> okay it will execute</font>

791
00:42:30,380 --> 00:42:37,400
a second reboot<font color="#E5E5E5"> okay in order for you to</font>

792
00:42:33,380 --> 00:42:40,849
to check it<font color="#CCCCCC"> we'll check again okay</font><font color="#E5E5E5"> if it</font>

793
00:42:37,400 --> 00:42:42,859
is it is now encrypted<font color="#E5E5E5"> it will check</font><font color="#CCCCCC"> the</font>

794
00:42:40,849 --> 00:42:45,109
infection marker if this one<font color="#E5E5E5"> it is</font>

795
00:42:42,859 --> 00:42:49,700
already infected<font color="#CCCCCC"> that means it will now</font>

796
00:42:45,109 --> 00:42:52,598
show<font color="#E5E5E5"> you this one okay same thing it</font>

797
00:42:49,700 --> 00:42:55,310
does send up an API<font color="#CCCCCC"> it is actually</font>

798
00:42:52,599 --> 00:42:58,550
<font color="#E5E5E5">outputting or displaying it byte per</font>

799
00:42:55,310 --> 00:43:01,990
byte<font color="#CCCCCC"> I just</font><font color="#E5E5E5"> out</font><font color="#CCCCCC"> rate per per line</font><font color="#E5E5E5"> okay</font>

800
00:42:58,550 --> 00:43:06,740
so<font color="#CCCCCC"> it is going</font><font color="#E5E5E5"> to display this famous</font>

801
00:43:01,990 --> 00:43:09,439
<font color="#E5E5E5">ransomware</font><font color="#CCCCCC"> screen hey it is going to do</font>

802
00:43:06,740 --> 00:43:11,450
the blinking<font color="#E5E5E5"> right there is a different</font>

803
00:43:09,440 --> 00:43:14,780
version of patch over<font color="#E5E5E5"> in you can see a</font>

804
00:43:11,450 --> 00:43:17,000
green skull<font color="#CCCCCC"> I think</font><font color="#E5E5E5"> and there is a white</font>

805
00:43:14,780 --> 00:43:20,660
version I think<font color="#CCCCCC"> and then it will</font><font color="#E5E5E5"> just</font>

806
00:43:17,000 --> 00:43:24,020
<font color="#E5E5E5">flash the screen right - it on the</font>

807
00:43:20,660 --> 00:43:26,598
screen<font color="#E5E5E5"> okay if you have the key for</font>

808
00:43:24,020 --> 00:43:28,940
<font color="#CCCCCC">example you pay because</font><font color="#E5E5E5"> you're rich I</font>

809
00:43:26,599 --> 00:43:31,300
<font color="#E5E5E5">don't know why you're paying okay there</font>

810
00:43:28,940 --> 00:43:34,880
is a<font color="#E5E5E5"> Pew pay take note that it is not</font>

811
00:43:31,300 --> 00:43:37,250
<font color="#CCCCCC">100% guarantee any other ransomware it</font>

812
00:43:34,880 --> 00:43:39,560
is not guaranteed<font color="#CCCCCC"> that you will</font><font color="#E5E5E5"> be able</font>

813
00:43:37,250 --> 00:43:42,680
<font color="#E5E5E5">to they will be able to</font><font color="#CCCCCC"> give you the key</font>

814
00:43:39,560 --> 00:43:43,520
<font color="#E5E5E5">okay otherwise you're just paying for</font>

815
00:43:42,680 --> 00:43:46,640
for nothing

816
00:43:43,520 --> 00:43:50,150
<font color="#CCCCCC">your best</font><font color="#E5E5E5"> defense is still backup your</font>

817
00:43:46,640 --> 00:43:53,480
system so this<font color="#E5E5E5"> is now your your</font>

818
00:43:50,150 --> 00:43:55,099
<font color="#E5E5E5">infection so after the</font><font color="#CCCCCC"> second reboot the</font>

819
00:43:53,480 --> 00:43:58,099
<font color="#CCCCCC">malware will know that it</font><font color="#E5E5E5"> is already</font>

820
00:43:55,099 --> 00:44:01,880
<font color="#E5E5E5">infected or encrypted it will ask you</font>

821
00:43:58,099 --> 00:44:04,609
for to pay here<font color="#E5E5E5"> okay you have to give</font>

822
00:44:01,880 --> 00:44:07,760
this information<font color="#CCCCCC"> okay this part is</font>

823
00:44:04,609 --> 00:44:11,060
actually and trying to test if I can if

824
00:44:07,760 --> 00:44:14,470
I can<font color="#E5E5E5"> guess the key okay I tried my name</font>

825
00:44:11,060 --> 00:44:17,420
didn't work<font color="#CCCCCC"> I don't know why</font>

826
00:44:14,470 --> 00:44:21,770
<font color="#CCCCCC">okay</font><font color="#E5E5E5"> I tried</font><font color="#CCCCCC"> I tried something</font><font color="#E5E5E5"> didn't</font>

827
00:44:17,420 --> 00:44:26,270
work<font color="#E5E5E5"> hey I</font><font color="#CCCCCC"> think I I was able to</font>

828
00:44:21,770 --> 00:44:31,880
actually guess the key<font color="#E5E5E5"> see I tried it</font>

829
00:44:26,270 --> 00:44:35,509
<font color="#CCCCCC">again using my name see I'm</font><font color="#E5E5E5"> still</font>

830
00:44:31,880 --> 00:44:38,839
debugging<font color="#E5E5E5"> as part of this and then</font>

831
00:44:35,510 --> 00:44:40,780
afterwards<font color="#E5E5E5"> after a certain time</font><font color="#CCCCCC"> you will</font>

832
00:44:38,839 --> 00:44:43,670
be<font color="#CCCCCC"> able</font><font color="#E5E5E5"> to see</font>

833
00:44:40,780 --> 00:44:46,610
<font color="#E5E5E5">okay it is now</font><font color="#CCCCCC"> going to decrypt</font><font color="#E5E5E5"> the same</font>

834
00:44:43,670 --> 00:44:48,680
sectors<font color="#E5E5E5"> okay but that one is</font><font color="#CCCCCC"> not</font>

835
00:44:46,610 --> 00:44:50,720
actually<font color="#E5E5E5"> it's not actually true okay</font>

836
00:44:48,680 --> 00:44:53,480
<font color="#E5E5E5">because</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> am debugging</font>

837
00:44:50,720 --> 00:44:55,399
I actually just jumped<font color="#CCCCCC"> to</font><font color="#E5E5E5"> the part where</font>

838
00:44:53,480 --> 00:44:57,560
it it is going<font color="#E5E5E5"> to show you that it is</font>

839
00:44:55,400 --> 00:45:00,980
decrypting but<font color="#CCCCCC"> I was not able</font><font color="#E5E5E5"> to guess</font>

840
00:44:57,560 --> 00:45:03,620
actually<font color="#E5E5E5"> the key</font><font color="#CCCCCC"> okay and then if you're</font>

841
00:45:00,980 --> 00:45:06,530
successful<font color="#CCCCCC"> it will</font><font color="#E5E5E5"> ask you to</font><font color="#CCCCCC"> reboot</font>

842
00:45:03,620 --> 00:45:13,009
your<font color="#CCCCCC"> computer</font><font color="#E5E5E5"> and then you'll be</font><font color="#CCCCCC"> able</font><font color="#E5E5E5"> to</font>

843
00:45:06,530 --> 00:45:13,430
have your computer<font color="#E5E5E5"> back</font><font color="#CCCCCC"> address keep or</font>

844
00:45:13,010 --> 00:45:17,390
<font color="#CCCCCC">panada</font>

845
00:45:13,430 --> 00:45:20,029
for stage<font color="#E5E5E5"> 1</font><font color="#CCCCCC"> ok that means you're going</font>

846
00:45:17,390 --> 00:45:23,569
<font color="#E5E5E5">to</font><font color="#CCCCCC"> execute the picture executable</font><font color="#E5E5E5"> it</font>

847
00:45:20,030 --> 00:45:26,330
<font color="#E5E5E5">copies and BR put the mini kernel code</font>

848
00:45:23,570 --> 00:45:29,900
to the hard<font color="#E5E5E5"> drive then reboots ok stage</font>

849
00:45:26,330 --> 00:45:33,410
2<font color="#CCCCCC"> ok displace the</font><font color="#E5E5E5"> page check this</font>

850
00:45:29,900 --> 00:45:36,920
encryption<font color="#CCCCCC"> MIT initiates the second</font>

851
00:45:33,410 --> 00:45:39,920
<font color="#CCCCCC">reboot ok displays your skull ok and</font>

852
00:45:36,920 --> 00:45:41,990
<font color="#CCCCCC">waits</font><font color="#E5E5E5"> for your Bitcoin payment</font><font color="#CCCCCC"> if you</font>

853
00:45:39,920 --> 00:45:45,140
<font color="#CCCCCC">want to pay I can give you my</font><font color="#E5E5E5"> Bitcoin</font>

854
00:45:41,990 --> 00:45:47,509
address<font color="#E5E5E5"> or rather just to check if it's</font>

855
00:45:45,140 --> 00:45:52,430
going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> the crib ok and these are some</font>

856
00:45:47,510 --> 00:45:59,500
of<font color="#CCCCCC"> the tools</font><font color="#E5E5E5"> that I use and of course</font>

857
00:45:52,430 --> 00:45:59,500
the boss debugger<font color="#E5E5E5"> and</font><font color="#CCCCCC"> I think that's it</font>

858
00:46:01,300 --> 00:46:06,520
thank you thank you<font color="#CCCCCC"> for staying</font>

859
00:46:10,140 --> 00:46:16,799
thank you very<font color="#E5E5E5"> pathological description</font>

860
00:46:14,020 --> 00:46:19,240
of the whole process thank you<font color="#E5E5E5"> thank you</font>

861
00:46:16,800 --> 00:46:21,070
<font color="#CCCCCC">so do we have questions for the audience</font>

862
00:46:19,240 --> 00:46:25,209
<font color="#E5E5E5">from</font><font color="#CCCCCC"> the audience</font><font color="#E5E5E5"> can we get a</font>

863
00:46:21,070 --> 00:46:29,740
microphone there are you still awake

864
00:46:25,210 --> 00:46:33,160
when I'm doing the debugging well I'm

865
00:46:29,740 --> 00:46:35,470
awake idli thank you<font color="#CCCCCC"> sorry if I missed</font>

866
00:46:33,160 --> 00:46:38,080
that<font color="#E5E5E5"> part</font><font color="#CCCCCC"> but how is the the key</font>

867
00:46:35,470 --> 00:46:39,669
actually<font color="#CCCCCC"> unwritten</font><font color="#E5E5E5"> is that during the</font>

868
00:46:38,080 --> 00:46:42,790
face when it's infecting it it's<font color="#E5E5E5"> sending</font>

869
00:46:39,670 --> 00:46:45,760
<font color="#E5E5E5">something to</font><font color="#CCCCCC"> restore services or</font><font color="#E5E5E5"> worry</font>

870
00:46:42,790 --> 00:46:47,950
<font color="#E5E5E5">the same key for everything</font><font color="#CCCCCC"> you mean</font>

871
00:46:45,760 --> 00:46:50,620
when you<font color="#E5E5E5"> pay</font><font color="#CCCCCC"> the ransomware</font><font color="#E5E5E5"> and then</font>

872
00:46:47,950 --> 00:46:54,009
when you<font color="#E5E5E5"> get the key well</font><font color="#CCCCCC"> the it need to</font>

873
00:46:50,620 --> 00:46:58,330
<font color="#E5E5E5">be</font><font color="#CCCCCC"> encrypted to some specific key yes</font>

874
00:46:54,010 --> 00:47:02,140
yes<font color="#E5E5E5"> so what happen is once you once the</font>

875
00:46:58,330 --> 00:47:04,360
picture<font color="#E5E5E5"> is done with the stage - okay he</font>

876
00:47:02,140 --> 00:47:07,569
is<font color="#CCCCCC"> already showing the</font><font color="#E5E5E5"> the blinking</font>

877
00:47:04,360 --> 00:47:09,640
<font color="#CCCCCC">skull it will give you</font><font color="#E5E5E5"> you remember the</font>

878
00:47:07,570 --> 00:47:12,370
part where it gives you the<font color="#E5E5E5"> pet onion</font>

879
00:47:09,640 --> 00:47:14,560
<font color="#CCCCCC">address</font><font color="#E5E5E5"> and then you will be</font><font color="#CCCCCC"> able</font><font color="#E5E5E5"> to go</font>

880
00:47:12,370 --> 00:47:16,450
to<font color="#E5E5E5"> that onion address and then give the</font>

881
00:47:14,560 --> 00:47:18,940
information<font color="#E5E5E5"> for your particular machine</font>

882
00:47:16,450 --> 00:47:20,710
and then if you're lucky you will<font color="#E5E5E5"> be</font>

883
00:47:18,940 --> 00:47:22,870
able<font color="#E5E5E5"> to get the decryption key and then</font>

884
00:47:20,710 --> 00:47:24,910
remembered<font color="#E5E5E5"> the part where I tried to</font>

885
00:47:22,870 --> 00:47:27,490
<font color="#CCCCCC">guess it with my name that's where you</font>

886
00:47:24,910 --> 00:47:30,339
put<font color="#CCCCCC"> your decryption key and then if it</font>

887
00:47:27,490 --> 00:47:33,189
<font color="#CCCCCC">is right it will be able to decrypt</font><font color="#E5E5E5"> your</font>

888
00:47:30,340 --> 00:47:35,050
<font color="#E5E5E5">I think I think the question is I think</font>

889
00:47:33,190 --> 00:47:38,710
the question<font color="#CCCCCC"> was when it's generating</font>

890
00:47:35,050 --> 00:47:43,630
the key to encrypt it if<font color="#CCCCCC"> you're</font>

891
00:47:38,710 --> 00:47:46,210
<font color="#E5E5E5">generating a a public and private</font><font color="#CCCCCC"> key</font>

892
00:47:43,630 --> 00:47:48,970
<font color="#CCCCCC">okay it generates the private key</font><font color="#E5E5E5"> and</font>

893
00:47:46,210 --> 00:47:51,670
actually<font color="#CCCCCC"> it's sense the</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> know the</font>

894
00:47:48,970 --> 00:47:55,419
<font color="#E5E5E5">public key will be will</font><font color="#CCCCCC"> be on the other</font>

895
00:47:51,670 --> 00:47:57,690
<font color="#E5E5E5">private key</font><font color="#CCCCCC"> is actually for the for the</font>

896
00:47:55,420 --> 00:48:00,880
one that<font color="#E5E5E5"> will be given to you from the</font>

897
00:47:57,690 --> 00:48:03,550
from the website that<font color="#CCCCCC"> you the onion part</font>

898
00:48:00,880 --> 00:48:06,430
<font color="#E5E5E5">the onion website it's generating the</font>

899
00:48:03,550 --> 00:48:09,970
keys<font color="#E5E5E5"> it's not going to generate the key</font>

900
00:48:06,430 --> 00:48:12,399
while you're being impacted everyone

901
00:48:09,970 --> 00:48:14,799
<font color="#E5E5E5">gets the same key every one gate gets</font>

902
00:48:12,400 --> 00:48:17,280
the no no you get the<font color="#E5E5E5"> yeah you get a</font>

903
00:48:14,800 --> 00:48:19,780
<font color="#E5E5E5">public key but it will be it will</font><font color="#CCCCCC"> be</font>

904
00:48:17,280 --> 00:48:23,080
mixed with<font color="#CCCCCC"> the</font><font color="#E5E5E5"> information for a</font>

905
00:48:19,780 --> 00:48:23,380
specific<font color="#CCCCCC"> machine</font><font color="#E5E5E5"> so even though you are</font>

906
00:48:23,080 --> 00:48:24,730
<font color="#CCCCCC">in</font>

907
00:48:23,380 --> 00:48:27,430
if the<font color="#CCCCCC"> mesh if there are two machines</font>

908
00:48:24,730 --> 00:48:31,030
<font color="#E5E5E5">infected with the same same public key</font>

909
00:48:27,430 --> 00:48:33,609
<font color="#E5E5E5">okay once you you</font><font color="#CCCCCC"> ask the</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> Pecha</font>

910
00:48:31,030 --> 00:48:38,920
<font color="#E5E5E5">author it will give you a private key</font>

911
00:48:33,610 --> 00:48:44,970
<font color="#CCCCCC">only for your specific machine</font><font color="#E5E5E5"> I don't</font>

912
00:48:38,920 --> 00:48:56,770
<font color="#CCCCCC">actually know it's</font><font color="#E5E5E5"> using salsa 20</font>

913
00:48:44,970 --> 00:48:59,200
algorithm<font color="#CCCCCC"> a</font><font color="#E5E5E5"> symmetric cipher</font><font color="#CCCCCC"> I didn't</font>

914
00:48:56,770 --> 00:49:00,580
actually go<font color="#CCCCCC"> into the doctor was there</font>

915
00:48:59,200 --> 00:49:01,960
<font color="#CCCCCC">actually</font><font color="#E5E5E5"> temperature the actual</font>

916
00:49:00,580 --> 00:49:04,090
encryption<font color="#E5E5E5"> is probably symmetrical</font>

917
00:49:01,960 --> 00:49:05,920
<font color="#E5E5E5">because</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> lot faster so there's</font>

918
00:49:04,090 --> 00:49:08,530
<font color="#E5E5E5">probably a hidden key that's encrypted</font>

919
00:49:05,920 --> 00:49:11,500
<font color="#CCCCCC">no I think I think it's not you</font><font color="#E5E5E5"> will not</font>

920
00:49:08,530 --> 00:49:16,210
be<font color="#CCCCCC"> able to find the key inside I think</font>

921
00:49:11,500 --> 00:49:18,300
<font color="#CCCCCC">no of</font><font color="#E5E5E5"> course any more questions from</font><font color="#CCCCCC"> the</font>

922
00:49:16,210 --> 00:49:18,300
<font color="#E5E5E5">audience</font>

923
00:49:22,710 --> 00:49:29,790
hello<font color="#CCCCCC"> is it possible</font><font color="#E5E5E5"> to put</font><font color="#CCCCCC"> the physical</font>

924
00:49:27,010 --> 00:49:34,770
disk<font color="#E5E5E5"> into box and just jump to that</font>

925
00:49:29,790 --> 00:49:37,840
decrypt me<font color="#E5E5E5"> place and recover your stuff</font>

926
00:49:34,770 --> 00:49:40,000
if you are you're<font color="#E5E5E5"> saying if you are</font>

927
00:49:37,840 --> 00:49:42,190
<font color="#CCCCCC">infected with your your hard drives</font>

928
00:49:40,000 --> 00:49:49,270
already infected<font color="#E5E5E5"> and then put it in</font>

929
00:49:42,190 --> 00:49:52,780
another<font color="#E5E5E5"> machine</font><font color="#CCCCCC"> to analyze yeah and then</font>

930
00:49:49,270 --> 00:49:56,590
get box to read the physical device<font color="#E5E5E5"> and</font>

931
00:49:52,780 --> 00:49:59,080
then tell<font color="#E5E5E5"> it to jump to the program</font>

932
00:49:56,590 --> 00:50:02,020
where<font color="#E5E5E5"> it says that it's decrypting so</font>

933
00:49:59,080 --> 00:50:05,350
you could<font color="#E5E5E5"> just bypass the</font><font color="#CCCCCC"> whole thing no</font>

934
00:50:02,020 --> 00:50:08,320
I don't think so<font color="#E5E5E5"> yeah because</font><font color="#CCCCCC"> yeah</font><font color="#E5E5E5"> once</font>

935
00:50:05,350 --> 00:50:10,750
you once<font color="#CCCCCC"> you are</font><font color="#E5E5E5"> infected and then you</font>

936
00:50:08,320 --> 00:50:13,780
actually<font color="#CCCCCC"> run it with the same same hard</font>

937
00:50:10,750 --> 00:50:15,310
<font color="#CCCCCC">drive it</font><font color="#E5E5E5"> will still us for your thing</font>

938
00:50:13,780 --> 00:50:17,830
that's the<font color="#E5E5E5"> only that's the problem with</font>

939
00:50:15,310 --> 00:50:20,470
the picture ransomware is<font color="#E5E5E5"> if you're a</font>

940
00:50:17,830 --> 00:50:24,040
home user here infected mostly you only

941
00:50:20,470 --> 00:50:27,220
have one machine<font color="#E5E5E5"> right so there's no way</font>

942
00:50:24,040 --> 00:50:29,800
actually<font color="#E5E5E5"> to</font><font color="#CCCCCC"> go to the onion address</font><font color="#E5E5E5"> you</font>

943
00:50:27,220 --> 00:50:31,419
have to go to<font color="#E5E5E5"> your neighbor okay to go</font>

944
00:50:29,800 --> 00:50:34,270
to the onion address<font color="#E5E5E5"> and then get the</font>

945
00:50:31,420 --> 00:50:36,100
decryption<font color="#E5E5E5"> key</font><font color="#CCCCCC"> okay but if</font><font color="#E5E5E5"> you're in the</font>

946
00:50:34,270 --> 00:50:36,759
<font color="#CCCCCC">corporate setup</font><font color="#E5E5E5"> you have lots of machine</font>

947
00:50:36,100 --> 00:50:38,770
or

948
00:50:36,760 --> 00:50:41,260
if they are<font color="#E5E5E5"> not yet infected then you</font>

949
00:50:38,770 --> 00:50:42,670
can do the that one you can get the

950
00:50:41,260 --> 00:50:44,890
decryption key but the problem is if you

951
00:50:42,670 --> 00:50:47,050
<font color="#CCCCCC">just bring the hard drive to an open box</font>

952
00:50:44,890 --> 00:50:50,470
is still<font color="#E5E5E5"> it will still execute the</font>

953
00:50:47,050 --> 00:50:53,230
<font color="#CCCCCC">ransomware</font><font color="#E5E5E5"> unless you have habit as a</font>

954
00:50:50,470 --> 00:50:57,009
slave<font color="#CCCCCC"> drive okay</font><font color="#E5E5E5"> yeah you might</font><font color="#CCCCCC"> be able</font>

955
00:50:53,230 --> 00:50:58,540
<font color="#E5E5E5">to to</font><font color="#CCCCCC"> prop</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> analyze yeah oh yeah</font>

956
00:50:57,010 --> 00:51:00,010
that's why if<font color="#CCCCCC"> you're</font><font color="#E5E5E5"> if you put it in</font>

957
00:50:58,540 --> 00:51:01,870
the<font color="#E5E5E5"> machine and then you</font><font color="#CCCCCC"> put it as a</font>

958
00:51:00,010 --> 00:51:04,030
slave<font color="#CCCCCC"> drive okay make sure</font><font color="#E5E5E5"> that you</font>

959
00:51:01,870 --> 00:51:05,980
don't actually put on<font color="#E5E5E5"> that machine and</font>

960
00:51:04,030 --> 00:51:10,540
that<font color="#E5E5E5"> right then you</font><font color="#CCCCCC"> will be able</font><font color="#E5E5E5"> to</font>

961
00:51:05,980 --> 00:51:13,570
analyze but don't decrypt it because you

962
00:51:10,540 --> 00:51:16,779
<font color="#E5E5E5">don't have the key</font><font color="#CCCCCC"> all right more</font>

963
00:51:13,570 --> 00:51:19,480
<font color="#E5E5E5">questions if you're</font><font color="#CCCCCC"> infected with</font><font color="#E5E5E5"> the</font>

964
00:51:16,780 --> 00:51:22,420
same variant of this one<font color="#E5E5E5"> because it</font>

965
00:51:19,480 --> 00:51:24,490
<font color="#E5E5E5">doesn't actually encrypt the the whole</font>

966
00:51:22,420 --> 00:51:26,950
hard drive you can brute force to<font color="#E5E5E5"> get</font>

967
00:51:24,490 --> 00:51:29,379
your files you can brute force<font color="#E5E5E5"> the whole</font>

968
00:51:26,950 --> 00:51:32,319
<font color="#E5E5E5">drive to grab the</font><font color="#CCCCCC"> parts it's just we</font>

969
00:51:29,380 --> 00:51:36,000
just<font color="#E5E5E5"> put the rename rename those things</font>

970
00:51:32,320 --> 00:51:36,000
yeah<font color="#CCCCCC"> you still be able</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> get</font><font color="#E5E5E5"> the place</font>

971
00:51:37,470 --> 00:51:41,230
<font color="#CCCCCC">all</font><font color="#E5E5E5"> right then</font>

972
00:51:39,550 --> 00:51:41,400
thank you very much<font color="#E5E5E5"> solver</font><font color="#CCCCCC"> Singh</font><font color="#E5E5E5"> thank</font>

973
00:51:41,230 --> 00:51:44,769
you

974
00:51:41,400 --> 00:51:44,769
[Applause]

