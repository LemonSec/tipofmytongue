1
00:00:04,080 --> 00:00:05,200
and

2
00:00:05,200 --> 00:00:07,120
i just want to hand the stage over to

3
00:00:07,120 --> 00:00:08,639
fabio and stack

4
00:00:08,639 --> 00:00:10,080
welcome hey

5
00:00:10,080 --> 00:00:12,320
good times

6
00:00:12,320 --> 00:00:14,920
hope you guys are excited because we are

7
00:00:14,920 --> 00:00:18,320
um so hi my name is tech this is fabio

8
00:00:18,320 --> 00:00:21,199
we are from trusec this is gone in 45

9
00:00:21,199 --> 00:00:23,359
minutes war stories from incident

10
00:00:23,359 --> 00:00:26,160
response yes so this is gonna be kind of

11
00:00:26,160 --> 00:00:29,199
a story driven like session which is not

12
00:00:29,199 --> 00:00:30,960
really my style but i'm gonna try

13
00:00:30,960 --> 00:00:32,399
something new it's his style but you

14
00:00:32,399 --> 00:00:34,719
know i'm embracing it yep uh i'm more of

15
00:00:34,719 --> 00:00:36,320
like the demo on the keyboard type of

16
00:00:36,320 --> 00:00:38,320
presentation but uh

17
00:00:38,320 --> 00:00:40,160
uh we're gonna go through some parts of

18
00:00:40,160 --> 00:00:41,680
some incident response cases we've

19
00:00:41,680 --> 00:00:44,239
handled over the last year so and we're

20
00:00:44,239 --> 00:00:45,360
gonna do it

21
00:00:45,360 --> 00:00:47,120
kind of like zooming in sometimes into

22
00:00:47,120 --> 00:00:48,559
some of the more

23
00:00:48,559 --> 00:00:50,640
interesting technical details and kind

24
00:00:50,640 --> 00:00:52,399
of jump a bit back and forth try to give

25
00:00:52,399 --> 00:00:54,000
a little bit of taste of different

26
00:00:54,000 --> 00:00:56,160
things and uh

27
00:00:56,160 --> 00:00:58,480
you know also keep in mind the tricks

28
00:00:58,480 --> 00:01:00,640
and stuff we're gonna show it's you know

29
00:01:00,640 --> 00:01:03,039
if you plan for these things beforehand

30
00:01:03,039 --> 00:01:05,119
there are much better ways to do these

31
00:01:05,119 --> 00:01:06,159
things but you know when you do

32
00:01:06,159 --> 00:01:08,560
forensics it's a lot of figuring things

33
00:01:08,560 --> 00:01:10,320
out with the data you have which is

34
00:01:10,320 --> 00:01:12,640
really incomplete and crappy data so

35
00:01:12,640 --> 00:01:14,479
there's some tricks about that you know

36
00:01:14,479 --> 00:01:15,920
so keep that in mind it's not like the

37
00:01:15,920 --> 00:01:17,520
state-of-the-art solutions here it's

38
00:01:17,520 --> 00:01:19,680
working with what we got all right

39
00:01:19,680 --> 00:01:21,439
um yeah

40
00:01:21,439 --> 00:01:23,600
and instead of just doing that typically

41
00:01:23,600 --> 00:01:26,240
kind of boring who am who am i

42
00:01:26,240 --> 00:01:28,479
interesting i'm actually interested

43
00:01:28,479 --> 00:01:31,119
about you so let me see a little bit of

44
00:01:31,119 --> 00:01:33,680
raise of hands here on how many of you

45
00:01:33,680 --> 00:01:36,159
has at some time in your life worked as

46
00:01:36,159 --> 00:01:39,360
a cis admin you know somebody that takes

47
00:01:39,360 --> 00:01:40,960
care of the computers in the network and

48
00:01:40,960 --> 00:01:42,880
that kind of stuff sweet there's

49
00:01:42,880 --> 00:01:44,320
actually a bunch of you i'm happy for

50
00:01:44,320 --> 00:01:45,280
that

51
00:01:45,280 --> 00:01:46,640
um

52
00:01:46,640 --> 00:01:48,000
and then the other question i have i

53
00:01:48,000 --> 00:01:50,399
only have two is that has any of you in

54
00:01:50,399 --> 00:01:53,280
here ever worked as a technical manager

55
00:01:53,280 --> 00:01:54,479
you know the ones that's actually

56
00:01:54,479 --> 00:01:57,119
responsible for the whole network and

57
00:01:57,119 --> 00:01:58,960
the system and everything and probably

58
00:01:58,960 --> 00:02:01,040
has a squad of people

59
00:02:01,040 --> 00:02:04,079
i see it barchelm cool the rest of you

60
00:02:04,079 --> 00:02:06,159
that hasn't worked as a technical

61
00:02:06,159 --> 00:02:08,959
manager well here's your chance because

62
00:02:08,959 --> 00:02:11,120
let's imagine for a second that you are

63
00:02:11,120 --> 00:02:14,400
the technical manager of a multinational

64
00:02:14,400 --> 00:02:17,360
manufacturing company and uh this is

65
00:02:17,360 --> 00:02:18,959
your office

66
00:02:18,959 --> 00:02:20,640
you know that place where you used to go

67
00:02:20,640 --> 00:02:22,800
to before the pandemic and do the work

68
00:02:22,800 --> 00:02:23,760
thing

69
00:02:23,760 --> 00:02:25,920
but now you're home in your bed you're

70
00:02:25,920 --> 00:02:28,080
sleeping and it's all sound and safe but

71
00:02:28,080 --> 00:02:30,160
somewhere around four o'clock in the

72
00:02:30,160 --> 00:02:32,080
morning you're getting a little bit of a

73
00:02:32,080 --> 00:02:34,239
rude awakening when your phone vibrates

74
00:02:34,239 --> 00:02:37,360
quite aggressively on your nightstand

75
00:02:37,360 --> 00:02:38,720
the first thought that goes through your

76
00:02:38,720 --> 00:02:41,120
head is obviously what kind of idiot

77
00:02:41,120 --> 00:02:42,560
he's calling you in the middle of the

78
00:02:42,560 --> 00:02:43,599
night

79
00:02:43,599 --> 00:02:45,360
but then you pick up the phone and you

80
00:02:45,360 --> 00:02:47,920
realize it's actually the production

81
00:02:47,920 --> 00:02:50,480
manager on one of you one of your

82
00:02:50,480 --> 00:02:53,280
company's factories in indonesia so you

83
00:02:53,280 --> 00:02:54,239
uh

84
00:02:54,239 --> 00:02:56,480
you pick up the phone

85
00:02:56,480 --> 00:02:59,518
uh hello

86
00:02:59,920 --> 00:03:01,200
okay

87
00:03:01,200 --> 00:03:04,159
what do you mean everything is down

88
00:03:04,159 --> 00:03:07,200
okay so you so you can't write your

89
00:03:07,200 --> 00:03:10,000
shipping orders and

90
00:03:10,000 --> 00:03:12,879
nothing works

91
00:03:13,440 --> 00:03:14,959
come down come down

92
00:03:14,959 --> 00:03:16,560
it's probably using some network

93
00:03:16,560 --> 00:03:18,319
interference

94
00:03:18,319 --> 00:03:21,599
have you tried restoring your computer

95
00:03:21,599 --> 00:03:23,200
at this stage you apparently hear the

96
00:03:23,200 --> 00:03:25,200
stress from the production manager on

97
00:03:25,200 --> 00:03:27,040
the other end and

98
00:03:27,040 --> 00:03:29,280
you promise to look into it so you look

99
00:03:29,280 --> 00:03:31,519
at your phone and see if there's any new

100
00:03:31,519 --> 00:03:33,680
alert emails there

101
00:03:33,680 --> 00:03:35,920
there's actually no new emails so you

102
00:03:35,920 --> 00:03:38,640
scooch over to your laptop right and

103
00:03:38,640 --> 00:03:42,480
decide to get on your rdp jump box to

104
00:03:42,480 --> 00:03:45,280
dig in to see whatever goes on

105
00:03:45,280 --> 00:03:46,799
but you're getting greeted with this

106
00:03:46,799 --> 00:03:49,120
message that the remote desktop gateway

107
00:03:49,120 --> 00:03:51,840
is currently unavailable

108
00:03:51,840 --> 00:03:53,439
you start you think a bit and then your

109
00:03:53,439 --> 00:03:56,159
phone vibrates again you realize that

110
00:03:56,159 --> 00:03:58,640
you have a couple of missed messages

111
00:03:58,640 --> 00:04:01,519
from phil one of the senior engineers

112
00:04:01,519 --> 00:04:03,120
down at the office

113
00:04:03,120 --> 00:04:06,799
and he's he's a little bit distressed

114
00:04:06,799 --> 00:04:08,640
so you find yourself in your car like

115
00:04:08,640 --> 00:04:11,439
half dressed right driving all the way

116
00:04:11,439 --> 00:04:14,000
down to the office and your mind is

117
00:04:14,000 --> 00:04:15,680
thinking about

118
00:04:15,680 --> 00:04:18,238
is it one of those song switches that's

119
00:04:18,238 --> 00:04:20,238
got the ball that again

120
00:04:20,238 --> 00:04:21,759
or is it

121
00:04:21,759 --> 00:04:24,479
the mpls connection to the

122
00:04:24,479 --> 00:04:26,960
data center that's acting up like it did

123
00:04:26,960 --> 00:04:28,880
last time

124
00:04:28,880 --> 00:04:30,479
you once again you're getting distracted

125
00:04:30,479 --> 00:04:33,520
by your phone vibrating and

126
00:04:33,520 --> 00:04:36,240
eventually you reach the parking lot and

127
00:04:36,240 --> 00:04:39,360
your phone is now running hot from all

128
00:04:39,360 --> 00:04:41,120
the incoming calls that you get from

129
00:04:41,120 --> 00:04:42,639
people asking

130
00:04:42,639 --> 00:04:46,240
what's going on and demanding answers

131
00:04:46,240 --> 00:04:48,000
but all you have

132
00:04:48,000 --> 00:04:50,080
is more questions

133
00:04:50,080 --> 00:04:52,160
you slam the door shut have your half

134
00:04:52,160 --> 00:04:54,080
drinking coffee right you're running

135
00:04:54,080 --> 00:04:56,080
over the parking lot and over up the

136
00:04:56,080 --> 00:04:57,680
stairs through the reception waving at

137
00:04:57,680 --> 00:04:59,759
the security guard dave there and

138
00:04:59,759 --> 00:05:03,919
eventually raises phil's office

139
00:05:04,000 --> 00:05:07,600
standing to take a breath for a while

140
00:05:07,840 --> 00:05:10,400
that's when he tells you that all the

141
00:05:10,400 --> 00:05:13,520
vms that you have in productions are

142
00:05:13,520 --> 00:05:14,639
down

143
00:05:14,639 --> 00:05:17,600
and actually on each and every of the

144
00:05:17,600 --> 00:05:19,520
cluster servers

145
00:05:19,520 --> 00:05:22,160
you have a nice little text file on the

146
00:05:22,160 --> 00:05:23,440
desktop

147
00:05:23,440 --> 00:05:27,280
that contains a ransom note

148
00:05:28,080 --> 00:05:30,880
then it suddenly dawns on you

149
00:05:30,880 --> 00:05:34,160
that production manager in indonesia

150
00:05:34,160 --> 00:05:36,400
was actually right

151
00:05:36,400 --> 00:05:39,680
everything and i mean everything

152
00:05:39,680 --> 00:05:41,759
is down

153
00:05:41,759 --> 00:05:44,720
not a great place to be isn't it

154
00:05:44,720 --> 00:05:46,320
and uh yeah

155
00:05:46,320 --> 00:05:47,360
we

156
00:05:47,360 --> 00:05:49,520
face compromised

157
00:05:49,520 --> 00:05:51,759
networks you know we do instant response

158
00:05:51,759 --> 00:05:52,720
and we meet

159
00:05:52,720 --> 00:05:54,320
people that have just experienced in

160
00:05:54,320 --> 00:05:57,360
this and it's a type of situation where

161
00:05:57,360 --> 00:05:58,479
you know it's easier to let your

162
00:05:58,479 --> 00:06:00,720
instincts take over and you know you may

163
00:06:00,720 --> 00:06:03,120
just want to like run around and just

164
00:06:03,120 --> 00:06:05,840
unplug everything shut everything down

165
00:06:05,840 --> 00:06:07,440
but that's something that ideally you

166
00:06:07,440 --> 00:06:09,520
shouldn't do

167
00:06:09,520 --> 00:06:11,360
because what you're

168
00:06:11,360 --> 00:06:13,039
experiencing now is basically like a

169
00:06:13,039 --> 00:06:15,280
crime scene uh you should and i know

170
00:06:15,280 --> 00:06:18,000
it's hard you know i'm there next to we

171
00:06:18,000 --> 00:06:20,800
just did it and i know it's hard but try

172
00:06:20,800 --> 00:06:22,000
not to touch anything in those

173
00:06:22,000 --> 00:06:24,080
situations because

174
00:06:24,080 --> 00:06:25,360
most likely you're gonna destroy some

175
00:06:25,360 --> 00:06:27,039
evidence and then when we do our

176
00:06:27,039 --> 00:06:28,639
investigation to try and figure out what

177
00:06:28,639 --> 00:06:30,000
happened how to clean it and all that

178
00:06:30,000 --> 00:06:32,000
stuff it's actually gonna be harder it's

179
00:06:32,000 --> 00:06:33,680
gonna take longer

180
00:06:33,680 --> 00:06:35,120
the investigation is going to be less

181
00:06:35,120 --> 00:06:36,240
accurate

182
00:06:36,240 --> 00:06:37,680
which means it's going to be harder to

183
00:06:37,680 --> 00:06:39,440
take the right decisions which

184
00:06:39,440 --> 00:06:41,199
ultimately is really what you want to do

185
00:06:41,199 --> 00:06:42,479
you want to take the right decisions but

186
00:06:42,479 --> 00:06:45,600
doing a thought investigation takes time

187
00:06:45,600 --> 00:06:48,160
right you want to do it right

188
00:06:48,160 --> 00:06:49,759
because you know when we do the

189
00:06:49,759 --> 00:06:51,199
investigations we

190
00:06:51,199 --> 00:06:52,560
obviously get questions all the time

191
00:06:52,560 --> 00:06:54,800
from the customer side like uh when can

192
00:06:54,800 --> 00:06:56,479
we do this you know can we can we

193
00:06:56,479 --> 00:06:57,919
connect the system to internet now is it

194
00:06:57,919 --> 00:06:59,680
safe to do this is it safe to do that

195
00:06:59,680 --> 00:07:00,400
and

196
00:07:00,400 --> 00:07:02,080
we're in the middle of the investigation

197
00:07:02,080 --> 00:07:03,520
and we don't know yet

198
00:07:03,520 --> 00:07:05,520
we just don't have those answers yet and

199
00:07:05,520 --> 00:07:07,440
we will maybe not have 100

200
00:07:07,440 --> 00:07:09,360
accurate answers anyways but at some

201
00:07:09,360 --> 00:07:11,599
point we'll have to have something

202
00:07:11,599 --> 00:07:13,599
but we need some more time and

203
00:07:13,599 --> 00:07:15,520
they don't really have time because

204
00:07:15,520 --> 00:07:17,440
their business is down and they're

205
00:07:17,440 --> 00:07:19,440
probably losing millions by the uh by

206
00:07:19,440 --> 00:07:20,560
the hour

207
00:07:20,560 --> 00:07:22,000
and you know

208
00:07:22,000 --> 00:07:23,280
we're gonna have to figure something out

209
00:07:23,280 --> 00:07:25,199
sooner or later uh that needs to be

210
00:07:25,199 --> 00:07:26,800
accurate enough

211
00:07:26,800 --> 00:07:28,560
and that's tricky how do you figure out

212
00:07:28,560 --> 00:07:30,160
exactly when it's a good time that you

213
00:07:30,160 --> 00:07:32,880
feel confident enough that you've looked

214
00:07:32,880 --> 00:07:34,319
at things and you understand them

215
00:07:34,319 --> 00:07:37,039
because too many times things don't

216
00:07:37,039 --> 00:07:39,440
really look the way they are right

217
00:07:39,440 --> 00:07:40,800
like this is

218
00:07:40,800 --> 00:07:43,199
for example customer calls us in says we

219
00:07:43,199 --> 00:07:45,199
have some kind of virus alert going on

220
00:07:45,199 --> 00:07:46,800
on one of the servers going to check it

221
00:07:46,800 --> 00:07:47,919
out

222
00:07:47,919 --> 00:07:49,520
we check it out

223
00:07:49,520 --> 00:07:51,360
mimikatz

224
00:07:51,360 --> 00:07:52,879
so

225
00:07:52,879 --> 00:07:53,840
we we

226
00:07:53,840 --> 00:07:56,000
we realized that okay so memcache is

227
00:07:56,000 --> 00:07:58,080
being run on this server and we trace it

228
00:07:58,080 --> 00:08:00,720
back and it shows up and it actually

229
00:08:00,720 --> 00:08:04,000
shows that it's originating from another

230
00:08:04,000 --> 00:08:06,720
box that's have rdp exposed to the

231
00:08:06,720 --> 00:08:09,199
internet and there's no shaming that i

232
00:08:09,199 --> 00:08:13,000
mean i for sure has put

233
00:08:13,000 --> 00:08:15,120
portuguese around the internet at some

234
00:08:15,120 --> 00:08:17,199
time in my life right and but at this

235
00:08:17,199 --> 00:08:19,599
stage apparently there's about 11

236
00:08:19,599 --> 00:08:21,440
400 something in sweden that

237
00:08:21,440 --> 00:08:23,199
continuously do that

238
00:08:23,199 --> 00:08:24,080
and

239
00:08:24,080 --> 00:08:27,360
that's all good and it's like it's not

240
00:08:27,360 --> 00:08:29,599
really but not really but it's 73 of

241
00:08:29,599 --> 00:08:31,840
those also you know they instead of just

242
00:08:31,840 --> 00:08:33,599
doing that normal kind of thing they

243
00:08:33,599 --> 00:08:35,919
they switch one port number so three

244
00:08:35,919 --> 00:08:37,440
eight eight three eight nine that's not

245
00:08:37,440 --> 00:08:39,519
really going to save you but hey go

246
00:08:39,519 --> 00:08:41,519
greetings anyway right

247
00:08:41,519 --> 00:08:43,200
so we were digging into this a little

248
00:08:43,200 --> 00:08:44,640
bit further because you can't just leave

249
00:08:44,640 --> 00:08:46,399
it there we realized that on another

250
00:08:46,399 --> 00:08:50,320
server there was um a local admin user

251
00:08:50,320 --> 00:08:53,600
added so at this stage we're having

252
00:08:53,600 --> 00:08:55,440
mimikaze credential extracted we're

253
00:08:55,440 --> 00:08:58,000
having this server that has a local user

254
00:08:58,000 --> 00:09:02,160
added to it and it all came from um

255
00:09:02,160 --> 00:09:04,000
in one rdp server that was connected to

256
00:09:04,000 --> 00:09:05,360
the internet so it's time to talk to the

257
00:09:05,360 --> 00:09:07,760
customer inform them so we say okay we

258
00:09:07,760 --> 00:09:10,640
have three iocs and uh

259
00:09:10,640 --> 00:09:12,399
we we want to come

260
00:09:12,399 --> 00:09:14,000
keep digging and the customer's like

261
00:09:14,000 --> 00:09:14,880
okay

262
00:09:14,880 --> 00:09:18,640
sweet but we just clean those right and

263
00:09:18,640 --> 00:09:19,519
then

264
00:09:19,519 --> 00:09:21,519
we can close the incident and it's all

265
00:09:21,519 --> 00:09:23,760
business as usual

266
00:09:23,760 --> 00:09:25,760
well it's not really business that you

267
00:09:25,760 --> 00:09:27,760
should that because if you see that some

268
00:09:27,760 --> 00:09:29,600
if an attacker breaks stealth to the

269
00:09:29,600 --> 00:09:31,440
level where they say it we're going

270
00:09:31,440 --> 00:09:33,760
to run mimikats on this box they got

271
00:09:33,760 --> 00:09:36,720
quite far into their operation so either

272
00:09:36,720 --> 00:09:39,200
that or somebody an admin has forgot all

273
00:09:39,200 --> 00:09:40,800
the passwords of all the users and

274
00:09:40,800 --> 00:09:42,240
figured that that was a good way to

275
00:09:42,240 --> 00:09:43,519
extract it

276
00:09:43,519 --> 00:09:45,120
so this is where the investigation

277
00:09:45,120 --> 00:09:46,160
begins

278
00:09:46,160 --> 00:09:48,560
and what we didn't know at that time and

279
00:09:48,560 --> 00:09:50,399
we're lucky about that

280
00:09:50,399 --> 00:09:52,399
is that at that current space time in

281
00:09:52,399 --> 00:09:55,279
space this was actually what's going on

282
00:09:55,279 --> 00:09:57,920
full domain compromise multiple back

283
00:09:57,920 --> 00:09:59,120
doors

284
00:09:59,120 --> 00:10:01,519
multiple c2 channels over hundreds of

285
00:10:01,519 --> 00:10:03,440
systems were compromised in files

286
00:10:03,440 --> 00:10:05,200
sensitive files had already been

287
00:10:05,200 --> 00:10:08,240
extracted extracted over ftp

288
00:10:08,240 --> 00:10:11,680
and it was in virus alert

289
00:10:11,680 --> 00:10:12,800
yeah that's what i mean we're doing with

290
00:10:12,800 --> 00:10:14,880
our investigation because you know

291
00:10:14,880 --> 00:10:16,079
when do you start when you feel like

292
00:10:16,079 --> 00:10:17,760
you've found enough and it's hard to

293
00:10:17,760 --> 00:10:19,519
tell sometimes because you never know

294
00:10:19,519 --> 00:10:22,560
beforehand if you're facing some you

295
00:10:22,560 --> 00:10:24,560
know like a lonely script kitty that is

296
00:10:24,560 --> 00:10:26,160
watching some tutorial on youtube how to

297
00:10:26,160 --> 00:10:28,560
run sql map and mimikatz or if you

298
00:10:28,560 --> 00:10:31,279
actually are up against a nation-state

299
00:10:31,279 --> 00:10:32,399
group

300
00:10:32,399 --> 00:10:34,720
right or just some very cold guy up

301
00:10:34,720 --> 00:10:36,880
there

302
00:10:36,880 --> 00:10:40,640
so but talking about nation state uh

303
00:10:40,640 --> 00:10:42,079
it is particularly important and of

304
00:10:42,079 --> 00:10:43,360
course you don't know beforehand right

305
00:10:43,360 --> 00:10:46,320
if you're facing those or not but

306
00:10:46,320 --> 00:10:48,240
we've done enough of those to know that

307
00:10:48,240 --> 00:10:50,720
you will figure that out eventually

308
00:10:50,720 --> 00:10:52,480
when you dig enough

309
00:10:52,480 --> 00:10:54,079
and this is a good example

310
00:10:54,079 --> 00:10:55,680
of something that might look just a

311
00:10:55,680 --> 00:10:57,040
fishing attack but it's actually

312
00:10:57,040 --> 00:10:58,320
something a bit more sophisticated if

313
00:10:58,320 --> 00:10:59,920
you look a little bit under the surface

314
00:10:59,920 --> 00:11:01,600
and it's a case we investigated earlier

315
00:11:01,600 --> 00:11:02,560
this year

316
00:11:02,560 --> 00:11:04,160
um where

317
00:11:04,160 --> 00:11:06,560
the initial access vector was fishing

318
00:11:06,560 --> 00:11:08,480
right obviously nothing new

319
00:11:08,480 --> 00:11:11,680
and they used rtf attachments uh as a

320
00:11:11,680 --> 00:11:13,920
payload delivery mechanism which also is

321
00:11:13,920 --> 00:11:15,360
nothing new

322
00:11:15,360 --> 00:11:16,480
but they were doing a couple things that

323
00:11:16,480 --> 00:11:18,480
were particularly interesting so we'll

324
00:11:18,480 --> 00:11:19,760
go through that

325
00:11:19,760 --> 00:11:22,800
so typical scenario normal one user gets

326
00:11:22,800 --> 00:11:24,560
phish email with

327
00:11:24,560 --> 00:11:26,240
some kind of blah blah you need to open

328
00:11:26,240 --> 00:11:28,160
this and then there's a document in

329
00:11:28,160 --> 00:11:30,240
there in this case it was something that

330
00:11:30,240 --> 00:11:33,279
name.doc but it was actually a rtf file

331
00:11:33,279 --> 00:11:35,920
and rtf is a rix text format created by

332
00:11:35,920 --> 00:11:38,399
microsoft in the vintage years and it's

333
00:11:38,399 --> 00:11:40,720
pretty text for text

334
00:11:40,720 --> 00:11:43,279
it takes base is easy to use reverse and

335
00:11:43,279 --> 00:11:45,120
look through but what's interesting

336
00:11:45,120 --> 00:11:48,240
about it is that since you're loading in

337
00:11:48,240 --> 00:11:50,240
the dot document document but it's

338
00:11:50,240 --> 00:11:53,120
actually an rtf file word would open it

339
00:11:53,120 --> 00:11:54,560
up and

340
00:11:54,560 --> 00:11:56,399
treat it the way that the rtf

341
00:11:56,399 --> 00:11:59,040
specifications works and those include

342
00:11:59,040 --> 00:12:00,639
something really interesting called

343
00:12:00,639 --> 00:12:01,839
templates

344
00:12:01,839 --> 00:12:02,959
yes

345
00:12:02,959 --> 00:12:04,639
so we open it up the attachment looks

346
00:12:04,639 --> 00:12:06,320
something like this

347
00:12:06,320 --> 00:12:08,399
uh and that's kind of like you know it's

348
00:12:08,399 --> 00:12:09,760
a punch in your eye you can't miss it

349
00:12:09,760 --> 00:12:12,160
right it's a template and then a url

350
00:12:12,160 --> 00:12:13,839
which really sticks out

351
00:12:13,839 --> 00:12:15,760
now of course this is zoom into a small

352
00:12:15,760 --> 00:12:17,120
part of it but still you go through it

353
00:12:17,120 --> 00:12:18,800
and you kind of see this right

354
00:12:18,800 --> 00:12:19,680
um

355
00:12:19,680 --> 00:12:22,079
so you want to go and check i mean i

356
00:12:22,079 --> 00:12:23,680
guess you get we have feeling for what a

357
00:12:23,680 --> 00:12:25,279
template is but you know you're going to

358
00:12:25,279 --> 00:12:27,440
check the specs and it says well the

359
00:12:27,440 --> 00:12:28,959
template is

360
00:12:28,959 --> 00:12:30,240
something that takes an argument that is

361
00:12:30,240 --> 00:12:34,399
the name of a related template file

362
00:12:34,560 --> 00:12:36,240
the argument we had there was a url

363
00:12:36,240 --> 00:12:37,040
right

364
00:12:37,040 --> 00:12:39,440
so this says you can take a name which i

365
00:12:39,440 --> 00:12:41,519
guess you would expect a file name or

366
00:12:41,519 --> 00:12:43,680
maybe a path to a local file apparently

367
00:12:43,680 --> 00:12:45,920
you can give it a url too that happens a

368
00:12:45,920 --> 00:12:48,240
lot right sometimes you know too often

369
00:12:48,240 --> 00:12:49,519
when you do

370
00:12:49,519 --> 00:12:50,480
you know

371
00:12:50,480 --> 00:12:52,160
living off the land deliveries in

372
00:12:52,160 --> 00:12:54,800
windows you can specify a name of a file

373
00:12:54,800 --> 00:12:57,680
you can also give it a unc path or a url

374
00:12:57,680 --> 00:13:00,560
many times whatever is doing that is

375
00:13:00,560 --> 00:13:02,079
very nice to you and go and find you for

376
00:13:02,079 --> 00:13:04,399
you right they're also

377
00:13:04,399 --> 00:13:06,320
usually proxy aware which is very nice

378
00:13:06,320 --> 00:13:07,760
when you build custom malware because

379
00:13:07,760 --> 00:13:08,959
then you're sure that you're going to

380
00:13:08,959 --> 00:13:10,720
hit the right the right configuration

381
00:13:10,720 --> 00:13:13,600
anyways uh that's what happened here

382
00:13:13,600 --> 00:13:16,079
uh you had uh you had the template

383
00:13:16,079 --> 00:13:17,360
fetching out

384
00:13:17,360 --> 00:13:18,160
uh

385
00:13:18,160 --> 00:13:19,760
well a template

386
00:13:19,760 --> 00:13:21,279
it's you know supposed to be a template

387
00:13:21,279 --> 00:13:22,880
anyway it was triggering work to make

388
00:13:22,880 --> 00:13:24,639
this connection to the attacker control

389
00:13:24,639 --> 00:13:26,160
server and putting that into the

390
00:13:26,160 --> 00:13:27,440
document

391
00:13:27,440 --> 00:13:29,440
and this is where it get a little bit

392
00:13:29,440 --> 00:13:30,720
more interesting in the beginning not

393
00:13:30,720 --> 00:13:32,720
that cool but here if you were asking

394
00:13:32,720 --> 00:13:34,440
and accessing that

395
00:13:34,440 --> 00:13:38,079
image.jsh file using a browser or curl

396
00:13:38,079 --> 00:13:40,320
or wget whatever you wouldn't get any

397
00:13:40,320 --> 00:13:42,240
connection nothing happened but if you

398
00:13:42,240 --> 00:13:44,639
use the user agent of word

399
00:13:44,639 --> 00:13:47,120
then suddenly voila the payload gets

400
00:13:47,120 --> 00:13:50,160
delivered so and then it all turns back

401
00:13:50,160 --> 00:13:52,480
to this boring thing again like super

402
00:13:52,480 --> 00:13:53,600
lame

403
00:13:53,600 --> 00:13:56,720
enable this to view content typical kind

404
00:13:56,720 --> 00:13:59,120
of fishing looking style and i think

405
00:13:59,120 --> 00:14:01,680
that's by purpose because if you can do

406
00:14:01,680 --> 00:14:04,160
that that's probably if an analyst looks

407
00:14:04,160 --> 00:14:05,839
at it and they send it in this is a

408
00:14:05,839 --> 00:14:08,079
phishing email somebody looks at it that

409
00:14:08,079 --> 00:14:09,680
is going to say oh yeah it's just a

410
00:14:09,680 --> 00:14:11,760
phishing email report it and it's all

411
00:14:11,760 --> 00:14:13,920
good and you you they kind of stay

412
00:14:13,920 --> 00:14:16,560
staying under the radar for what what

413
00:14:16,560 --> 00:14:18,320
the real campaign is going on because it

414
00:14:18,320 --> 00:14:20,560
was really sophisticated it might just

415
00:14:20,560 --> 00:14:22,639
be a little bit of interest to dig into

416
00:14:22,639 --> 00:14:23,519
it

417
00:14:23,519 --> 00:14:26,079
so when the user enables that this is

418
00:14:26,079 --> 00:14:27,680
the funny part and this is where they

419
00:14:27,680 --> 00:14:29,760
really played the game up now it turned

420
00:14:29,760 --> 00:14:31,839
into social engineering because a couple

421
00:14:31,839 --> 00:14:33,519
of weeks ago earlier they're already

422
00:14:33,519 --> 00:14:36,639
stolen internal documents and as soon as

423
00:14:36,639 --> 00:14:40,000
you enable that template that's a doc m

424
00:14:40,000 --> 00:14:43,199
file that's a fully macro enabled

425
00:14:43,199 --> 00:14:46,000
word document that then populates inside

426
00:14:46,000 --> 00:14:48,800
that word rtf file that you open up and

427
00:14:48,800 --> 00:14:51,519
it contains stolen information from that

428
00:14:51,519 --> 00:14:53,519
organization so the user will get that

429
00:14:53,519 --> 00:14:55,680
feeling oh i did the right thing this is

430
00:14:55,680 --> 00:14:57,519
my company stuff this is what it looks

431
00:14:57,519 --> 00:14:59,920
like but in the background the macro

432
00:14:59,920 --> 00:15:02,160
executes and all the bad stuff just

433
00:15:02,160 --> 00:15:03,839
happens

434
00:15:03,839 --> 00:15:05,440
yeah and that's the bad stuff oops one

435
00:15:05,440 --> 00:15:06,399
more

436
00:15:06,399 --> 00:15:09,360
dude let's decide who's that loved it

437
00:15:09,360 --> 00:15:10,959
where are we cool

438
00:15:10,959 --> 00:15:13,519
so that's the macro uh it was

439
00:15:13,519 --> 00:15:15,760
not really you know anything too fancy

440
00:15:15,760 --> 00:15:17,279
in terms of how you execute stuff it's a

441
00:15:17,279 --> 00:15:18,720
macro i guess a lot of people have seen

442
00:15:18,720 --> 00:15:22,240
a lot of those um so what it did is uh

443
00:15:22,240 --> 00:15:24,399
it created directory under c program

444
00:15:24,399 --> 00:15:26,720
data wc under proxy and then it drops

445
00:15:26,720 --> 00:15:28,560
well it fetched and dropped a couple of

446
00:15:28,560 --> 00:15:32,399
more files uh one exe and one dll

447
00:15:32,399 --> 00:15:34,000
and they were named them wc underscore

448
00:15:34,000 --> 00:15:37,519
proxy.exe and wc.dll they put those in

449
00:15:37,519 --> 00:15:39,680
the in the directory they just created

450
00:15:39,680 --> 00:15:42,639
and then there's some delay uh usually

451
00:15:42,639 --> 00:15:46,000
to avoid the scans right uh and then it

452
00:15:46,000 --> 00:15:47,839
starts the binary

453
00:15:47,839 --> 00:15:51,120
and well if you see that that kind of

454
00:15:51,120 --> 00:15:52,560
you know if you look into this a bit it

455
00:15:52,560 --> 00:15:54,320
kind of smells immediately like dll side

456
00:15:54,320 --> 00:15:56,320
loading if you haven't heard of the lsi

457
00:15:56,320 --> 00:15:58,480
loading this is a 30 seconds

458
00:15:58,480 --> 00:16:00,800
version of how it works

459
00:16:00,800 --> 00:16:02,959
you take a binary that is a legitimate

460
00:16:02,959 --> 00:16:05,040
binary and

461
00:16:05,040 --> 00:16:07,279
preferably signed right

462
00:16:07,279 --> 00:16:10,079
like the one here dwc proxy.exe that was

463
00:16:10,079 --> 00:16:11,519
a signed binary that you have up there

464
00:16:11,519 --> 00:16:14,079
on the left uh signed by ava software

465
00:16:14,079 --> 00:16:16,480
that is part of the avas antivirus

466
00:16:16,480 --> 00:16:18,079
uh you know not blaming avas or anything

467
00:16:18,079 --> 00:16:20,560
there is dll side loading issues all

468
00:16:20,560 --> 00:16:22,880
over the freaking place

469
00:16:22,880 --> 00:16:24,240
but anyway you take a binary that is

470
00:16:24,240 --> 00:16:26,800
legitimate and when you run it it's most

471
00:16:26,800 --> 00:16:28,079
likely going to look for some additional

472
00:16:28,079 --> 00:16:29,839
libraries and stuff to load right and

473
00:16:29,839 --> 00:16:32,160
it's going to be a sequence of uh you

474
00:16:32,160 --> 00:16:35,120
know places that it looks for where to

475
00:16:35,120 --> 00:16:36,320
load those libraries it's going to look

476
00:16:36,320 --> 00:16:38,480
first if it's already loaded obviously

477
00:16:38,480 --> 00:16:39,920
if it's defined as a known dll in the

478
00:16:39,920 --> 00:16:41,600
registry or if the application manifest

479
00:16:41,600 --> 00:16:43,839
specifies where to load it specifically

480
00:16:43,839 --> 00:16:44,880
then it's going to look into the

481
00:16:44,880 --> 00:16:46,399
directory where the binary was started

482
00:16:46,399 --> 00:16:48,240
from

483
00:16:48,240 --> 00:16:49,680
right and remember they put those two

484
00:16:49,680 --> 00:16:51,279
files together next to each other and

485
00:16:51,279 --> 00:16:52,720
then they start the binary it's going to

486
00:16:52,720 --> 00:16:54,959
go down all the way through this chain

487
00:16:54,959 --> 00:16:56,560
and eventually it's going to look for

488
00:16:56,560 --> 00:16:59,040
that dll that is named that way that's

489
00:16:59,040 --> 00:17:01,759
where the attacker code is loaded but

490
00:17:01,759 --> 00:17:03,759
it's loaded by the legitimate

491
00:17:03,759 --> 00:17:06,079
software right but legitimate binary

492
00:17:06,079 --> 00:17:08,079
so if this is gonna do like

493
00:17:08,079 --> 00:17:09,760
um you know connecting to a command

494
00:17:09,760 --> 00:17:11,359
control server or start doing something

495
00:17:11,359 --> 00:17:13,679
bad if you look at what process is doing

496
00:17:13,679 --> 00:17:15,919
it it's a signed binary by avas that is

497
00:17:15,919 --> 00:17:17,760
doing that so and it's kind of ironic

498
00:17:17,760 --> 00:17:18,959
that they choose they often choose

499
00:17:18,959 --> 00:17:20,880
antiviruses when they do this type of

500
00:17:20,880 --> 00:17:24,000
stuff and chinese actors love dll side

501
00:17:24,000 --> 00:17:25,359
loading i don't know how many examples

502
00:17:25,359 --> 00:17:26,959
we've seen of the site loading of all

503
00:17:26,959 --> 00:17:28,400
kinds of things

504
00:17:28,400 --> 00:17:29,919
and i can only imagine every time we see

505
00:17:29,919 --> 00:17:31,520
a different one getting my head the

506
00:17:31,520 --> 00:17:33,280
picture of the huge database that they

507
00:17:33,280 --> 00:17:35,600
must have like okay what the lsa loan

508
00:17:35,600 --> 00:17:36,559
you want to do today you want to pick

509
00:17:36,559 --> 00:17:38,000
avas you want to pick google you want to

510
00:17:38,000 --> 00:17:39,360
pick any of the million windows

511
00:17:39,360 --> 00:17:42,000
components that are vulnerable to this

512
00:17:42,000 --> 00:17:42,799
so

513
00:17:42,799 --> 00:17:44,160
it would be nice to have that database i

514
00:17:44,160 --> 00:17:46,559
guess for red teams but uh it's really

515
00:17:46,559 --> 00:17:48,799
not easy or it's really not hard to find

516
00:17:48,799 --> 00:17:50,480
to be honest so

517
00:17:50,480 --> 00:17:51,360
uh

518
00:17:51,360 --> 00:17:53,039
but from there you start kind of the

519
00:17:53,039 --> 00:17:55,039
whole post exploitation stuff right that

520
00:17:55,039 --> 00:17:56,320
we're not gonna go into that now for

521
00:17:56,320 --> 00:17:57,679
this incident but

522
00:17:57,679 --> 00:18:00,559
uh there were a few sneaky things about

523
00:18:00,559 --> 00:18:02,720
this right if we try to recap from the

524
00:18:02,720 --> 00:18:05,039
beginning there was that attachment

525
00:18:05,039 --> 00:18:06,640
and remember the macro was never in the

526
00:18:06,640 --> 00:18:08,160
attachment

527
00:18:08,160 --> 00:18:09,840
right so already there

528
00:18:09,840 --> 00:18:12,000
whatever email filtering thing that you

529
00:18:12,000 --> 00:18:13,600
have in front is gonna have a pretty

530
00:18:13,600 --> 00:18:14,799
hard time

531
00:18:14,799 --> 00:18:16,880
because there is no macro

532
00:18:16,880 --> 00:18:17,840
uh

533
00:18:17,840 --> 00:18:19,840
they might look into you know

534
00:18:19,840 --> 00:18:21,200
even assuming that they're gonna look

535
00:18:21,200 --> 00:18:22,880
into the attachment and find the url

536
00:18:22,880 --> 00:18:24,320
which i think is unlikely but either

537
00:18:24,320 --> 00:18:26,640
that or something down the line where

538
00:18:26,640 --> 00:18:29,039
some component does it prefetch

539
00:18:29,039 --> 00:18:31,120
remember the user agent thing

540
00:18:31,120 --> 00:18:34,320
you have to you have to use the uh the

541
00:18:34,320 --> 00:18:36,240
office user agent microsoft word user

542
00:18:36,240 --> 00:18:37,760
agent to be able to even get the second

543
00:18:37,760 --> 00:18:39,280
stage so if you have a prefetch

544
00:18:39,280 --> 00:18:41,520
filtering that's also not gonna

545
00:18:41,520 --> 00:18:43,760
unless they spoof office but

546
00:18:43,760 --> 00:18:45,840
yeah you know it's a bit unlikely

547
00:18:45,840 --> 00:18:46,880
um

548
00:18:46,880 --> 00:18:48,880
oh yeah more yeah yeah we had the fact

549
00:18:48,880 --> 00:18:51,200
that when you run the macro you actually

550
00:18:51,200 --> 00:18:54,000
get real content that was stolen by from

551
00:18:54,000 --> 00:18:56,320
that company before

552
00:18:56,320 --> 00:18:58,559
so that's another layer right there it's

553
00:18:58,559 --> 00:19:00,240
less likely for the user to actually

554
00:19:00,240 --> 00:19:02,480
report it after they fall for it which

555
00:19:02,480 --> 00:19:04,559
is exactly what you want to do right and

556
00:19:04,559 --> 00:19:06,640
it looked totally lame

557
00:19:06,640 --> 00:19:08,720
yeah and it looked really lame so

558
00:19:08,720 --> 00:19:10,480
if someone sees it's probably yeah it's

559
00:19:10,480 --> 00:19:12,160
just another fishing put it down you

560
00:19:12,160 --> 00:19:14,559
know the pile of fishing we some day

561
00:19:14,559 --> 00:19:17,360
we'll check we'll never do

562
00:19:17,360 --> 00:19:18,880
and of course the side loading which is

563
00:19:18,880 --> 00:19:20,480
nothing new but it's another extra thing

564
00:19:20,480 --> 00:19:22,880
to kind of avoid detection

565
00:19:22,880 --> 00:19:25,440
um

566
00:19:25,440 --> 00:19:26,400
so

567
00:19:26,400 --> 00:19:28,400
given all this

568
00:19:28,400 --> 00:19:29,760
you can of course like if we start

569
00:19:29,760 --> 00:19:31,120
thinking of how would you detect

570
00:19:31,120 --> 00:19:32,320
something like this

571
00:19:32,320 --> 00:19:35,280
uh having the right tooling ideally

572
00:19:35,280 --> 00:19:38,160
and you can of course looking for

573
00:19:38,160 --> 00:19:40,000
the specific attachment that they sent

574
00:19:40,000 --> 00:19:41,600
you get a hash of that then you search

575
00:19:41,600 --> 00:19:43,600
if you see that hash anywhere or you

576
00:19:43,600 --> 00:19:45,120
have a sender address or the email you

577
00:19:45,120 --> 00:19:46,559
can search for any emails we see from

578
00:19:46,559 --> 00:19:48,720
there you have maybe the file name if

579
00:19:48,720 --> 00:19:50,160
it's specific enough you can maybe

580
00:19:50,160 --> 00:19:52,160
search for that

581
00:19:52,160 --> 00:19:54,080
but if you have tooling that allows you

582
00:19:54,080 --> 00:19:56,320
to do a bit of more advanced queries and

583
00:19:56,320 --> 00:19:58,080
in this example our customers were using

584
00:19:58,080 --> 00:19:59,919
microsoft solutions so they were on like

585
00:19:59,919 --> 00:20:02,000
defender of 35 and all the defenders

586
00:20:02,000 --> 00:20:04,400
suite of things they also had an edr so

587
00:20:04,400 --> 00:20:07,520
we used that uh any you know other

588
00:20:07,520 --> 00:20:09,120
solution that allows you to do the same

589
00:20:09,120 --> 00:20:11,200
thing would probably work just as well

590
00:20:11,200 --> 00:20:13,600
uh it's the idea

591
00:20:13,600 --> 00:20:15,200
we basically did a query like this

592
00:20:15,200 --> 00:20:16,559
because you can look into the email

593
00:20:16,559 --> 00:20:18,559
stuff from here and you can do like can

594
00:20:18,559 --> 00:20:20,080
you give me all the attachment

595
00:20:20,080 --> 00:20:21,520
information

596
00:20:21,520 --> 00:20:25,760
uh where the attachment type is rdf

597
00:20:25,760 --> 00:20:27,679
but the file name doesn't end with dot

598
00:20:27,679 --> 00:20:29,919
rtf which is what they did right it was

599
00:20:29,919 --> 00:20:33,280
an rtf file but it was named doc

600
00:20:33,280 --> 00:20:35,120
and turns out this doesn't give post

601
00:20:35,120 --> 00:20:37,520
positives at all okay very few maybe but

602
00:20:37,520 --> 00:20:39,520
totally feasible to go through and

603
00:20:39,520 --> 00:20:41,679
figure out the first positives

604
00:20:41,679 --> 00:20:44,080
and it was a great way to find more

605
00:20:44,080 --> 00:20:45,520
variations

606
00:20:45,520 --> 00:20:47,520
of the of the different phishing waves

607
00:20:47,520 --> 00:20:49,039
they use in that campaign because it was

608
00:20:49,039 --> 00:20:49,919
a very

609
00:20:49,919 --> 00:20:52,400
time long extended campaign again it's a

610
00:20:52,400 --> 00:20:54,880
nation state uh campaign right so they

611
00:20:54,880 --> 00:20:56,159
have variations and stuff but they like

612
00:20:56,159 --> 00:20:57,840
this technique with rtf fast name dot

613
00:20:57,840 --> 00:21:00,640
talk so they keep they kept doing that

614
00:21:00,640 --> 00:21:02,159
and if you have the luxury also having

615
00:21:02,159 --> 00:21:04,240
an edr on top of that which we did so

616
00:21:04,240 --> 00:21:05,360
this is not the case i said at the

617
00:21:05,360 --> 00:21:06,559
beginning where you have to work with

618
00:21:06,559 --> 00:21:08,159
crappy data this is actually awesome

619
00:21:08,159 --> 00:21:09,840
when you do forensics this is exactly

620
00:21:09,840 --> 00:21:11,360
what you want

621
00:21:11,360 --> 00:21:12,799
but if you do have an edr you can

622
00:21:12,799 --> 00:21:15,120
actually take a step further and say i

623
00:21:15,120 --> 00:21:16,400
want to get all those suspicious

624
00:21:16,400 --> 00:21:18,400
attachments that have that type of

625
00:21:18,400 --> 00:21:20,640
characteristics so they are rtf but not

626
00:21:20,640 --> 00:21:22,000
name rtf

627
00:21:22,000 --> 00:21:23,919
and i want to search in all the device

628
00:21:23,919 --> 00:21:26,559
file events if any system has ever seen

629
00:21:26,559 --> 00:21:27,840
or touched

630
00:21:27,840 --> 00:21:30,240
any of those suspicious files and you're

631
00:21:30,240 --> 00:21:31,440
going to get a nice list of which

632
00:21:31,440 --> 00:21:33,200
devices and which process touch that

633
00:21:33,200 --> 00:21:34,320
file

634
00:21:34,320 --> 00:21:35,280
and

635
00:21:35,280 --> 00:21:36,720
in that case that actually allowed us to

636
00:21:36,720 --> 00:21:39,039
find a few more compromise systems

637
00:21:39,039 --> 00:21:40,080
because

638
00:21:40,080 --> 00:21:42,559
it came from another source so they were

639
00:21:42,559 --> 00:21:44,880
also doing internal phishing because

640
00:21:44,880 --> 00:21:47,600
they were after specific people in that

641
00:21:47,600 --> 00:21:50,000
organization so when they had control

642
00:21:50,000 --> 00:21:51,760
over already compromised mailboxes they

643
00:21:51,760 --> 00:21:53,679
would also send emails from that company

644
00:21:53,679 --> 00:21:56,000
mailbox to other people inside the

645
00:21:56,000 --> 00:21:57,200
organization

646
00:21:57,200 --> 00:21:58,559
so the source would be an internal

647
00:21:58,559 --> 00:22:00,480
source

648
00:22:00,480 --> 00:22:02,159
so we found those emails this way and

649
00:22:02,159 --> 00:22:03,360
then we realized they were doing that

650
00:22:03,360 --> 00:22:04,320
too

651
00:22:04,320 --> 00:22:06,559
sneaky sneaky yeah

652
00:22:06,559 --> 00:22:08,799
so

653
00:22:08,880 --> 00:22:11,280
to wrap this up it's basically

654
00:22:11,280 --> 00:22:13,679
the idea of trying and abstract the

655
00:22:13,679 --> 00:22:16,480
detection uh queries and hunting

656
00:22:16,480 --> 00:22:17,760
when you have the tooling and the

657
00:22:17,760 --> 00:22:20,080
possibility to do that because looking

658
00:22:20,080 --> 00:22:22,159
for hashes and specific things is is

659
00:22:22,159 --> 00:22:24,159
great and should definitely be there but

660
00:22:24,159 --> 00:22:26,080
when you can and when it's feasible to

661
00:22:26,080 --> 00:22:27,520
abstract that to a little bit higher

662
00:22:27,520 --> 00:22:29,280
level if you find the technique instead

663
00:22:29,280 --> 00:22:32,000
of specific iocs that usually takes you

664
00:22:32,000 --> 00:22:33,760
a step further especially when it's this

665
00:22:33,760 --> 00:22:35,120
advanced campaigns

666
00:22:35,120 --> 00:22:38,000
it can really pay off

667
00:22:39,360 --> 00:22:41,280
but you don't always have that luxury

668
00:22:41,280 --> 00:22:42,559
though

669
00:22:42,559 --> 00:22:44,720
because nobody not everyone has that er

670
00:22:44,720 --> 00:22:46,559
installing all that so

671
00:22:46,559 --> 00:22:48,640
how do you do if you want to track

672
00:22:48,640 --> 00:22:50,640
or find some persistence on the system

673
00:22:50,640 --> 00:22:52,559
specifically in services

674
00:22:52,559 --> 00:22:53,679
and

675
00:22:53,679 --> 00:22:56,480
you won't do that at scale because

676
00:22:56,480 --> 00:22:58,240
it's a tedious work to go through all

677
00:22:58,240 --> 00:23:00,960
the services um so let's imagine for a

678
00:23:00,960 --> 00:23:02,960
second um

679
00:23:02,960 --> 00:23:04,880
let's play around with this incident you

680
00:23:04,880 --> 00:23:07,039
are now currently an incident responder

681
00:23:07,039 --> 00:23:09,280
and you've been tasked by the the quest

682
00:23:09,280 --> 00:23:11,440
to identify if there's any weird

683
00:23:11,440 --> 00:23:13,600
services going on so the day of the

684
00:23:13,600 --> 00:23:16,960
breach was the 12th of august right

685
00:23:16,960 --> 00:23:18,960
and first okay you can go through the

686
00:23:18,960 --> 00:23:20,559
ebon log and see if there's any funny

687
00:23:20,559 --> 00:23:21,919
stuff there

688
00:23:21,919 --> 00:23:24,480
but there's not always that you have the

689
00:23:24,480 --> 00:23:26,720
possibility to find them it logs because

690
00:23:26,720 --> 00:23:29,039
they can either be cleared like this or

691
00:23:29,039 --> 00:23:31,520
they can have just been rotated right

692
00:23:31,520 --> 00:23:33,039
so

693
00:23:33,039 --> 00:23:35,120
what you normally would do is to see

694
00:23:35,120 --> 00:23:36,720
whatever kind of systems have been

695
00:23:36,720 --> 00:23:38,559
started on the system so you can use

696
00:23:38,559 --> 00:23:41,440
autoruns for that and you know just you

697
00:23:41,440 --> 00:23:44,159
probably sort by time date and see if

698
00:23:44,159 --> 00:23:46,559
there's that date there but your date is

699
00:23:46,559 --> 00:23:47,919
not showing up

700
00:23:47,919 --> 00:23:49,600
but you find this weird service called

701
00:23:49,600 --> 00:23:52,320
help svc right and

702
00:23:52,320 --> 00:23:54,400
if you look at it publisher's not

703
00:23:54,400 --> 00:23:57,760
verified and uh the image patch looks

704
00:23:57,760 --> 00:24:01,039
kind of weird is help soc.cc9

705
00:24:01,039 --> 00:24:04,559
but the timestamp has nothing to do with

706
00:24:04,559 --> 00:24:07,200
the kind of time that you're looking for

707
00:24:07,200 --> 00:24:08,320
what's really interesting with this

708
00:24:08,320 --> 00:24:10,080
service though because this is a bad

709
00:24:10,080 --> 00:24:12,240
service and if you weren't using

710
00:24:12,240 --> 00:24:15,200
autoruns but using services.msc

711
00:24:15,200 --> 00:24:16,320
instead

712
00:24:16,320 --> 00:24:18,640
you see this it wouldn't look shady at

713
00:24:18,640 --> 00:24:20,799
all because it would be svc host calling

714
00:24:20,799 --> 00:24:22,400
for it and you would it would look

715
00:24:22,400 --> 00:24:23,760
normal

716
00:24:23,760 --> 00:24:25,760
same thing would be if you use the get

717
00:24:25,760 --> 00:24:27,919
wmi object to see if you can find some

718
00:24:27,919 --> 00:24:29,840
more data same thing there nothing

719
00:24:29,840 --> 00:24:33,039
sticks out so we kind of need to rely on

720
00:24:33,039 --> 00:24:35,919
using tools like autoruns um

721
00:24:35,919 --> 00:24:38,559
and the dot cc nine one that kind of

722
00:24:38,559 --> 00:24:40,400
hurt me a bit so

723
00:24:40,400 --> 00:24:42,080
you need to search for that what is dot

724
00:24:42,080 --> 00:24:44,840
cc nine and it's not a valid file

725
00:24:44,840 --> 00:24:48,240
extension but what it is is a chinese

726
00:24:48,240 --> 00:24:51,279
iphone killer phone

727
00:24:51,279 --> 00:24:53,840
which doesn't really help

728
00:24:53,840 --> 00:24:55,600
so if you dig a bit more you do this a

729
00:24:55,600 --> 00:24:57,120
bit more scale you can use the command

730
00:24:57,120 --> 00:24:58,720
line version of auto runs run it across

731
00:24:58,720 --> 00:25:00,640
multiple systems build a nice timeline

732
00:25:00,640 --> 00:25:02,240
if we zoom into that particular service

733
00:25:02,240 --> 00:25:04,400
we're looking into we get like the hash

734
00:25:04,400 --> 00:25:07,279
for example uh throw that hash in virus

735
00:25:07,279 --> 00:25:10,640
total and there is no match

736
00:25:10,640 --> 00:25:12,400
which is weird right whether it's

737
00:25:12,400 --> 00:25:15,039
legitimate or not i mean if it's known

738
00:25:15,039 --> 00:25:16,880
bad it should be there if it's known

739
00:25:16,880 --> 00:25:18,080
good it should also be there because it

740
00:25:18,080 --> 00:25:20,480
should look something like this right

741
00:25:20,480 --> 00:25:22,880
especially because the service is

742
00:25:22,880 --> 00:25:24,799
posing as a microsoft service you would

743
00:25:24,799 --> 00:25:26,480
expect it to load windows components

744
00:25:26,480 --> 00:25:28,000
distributed by microsoft which is what

745
00:25:28,000 --> 00:25:30,240
various will tell you i'm guessing so

746
00:25:30,240 --> 00:25:32,080
just i mean you can do more research but

747
00:25:32,080 --> 00:25:34,159
just the fact that it's just not there

748
00:25:34,159 --> 00:25:36,960
it's empty it just doesn't feel right

749
00:25:36,960 --> 00:25:39,279
uh but the timestamp doesn't really

750
00:25:39,279 --> 00:25:42,240
match right remember the timestamp that

751
00:25:42,240 --> 00:25:44,000
uh alright gave you

752
00:25:44,000 --> 00:25:45,840
uh

753
00:25:45,840 --> 00:25:48,799
here it's 2019-1207

754
00:25:48,799 --> 00:25:49,600
it's

755
00:25:49,600 --> 00:25:53,039
not what we're looking for

756
00:25:53,919 --> 00:25:56,080
and where does autoruns get that from

757
00:25:56,080 --> 00:25:58,320
you know

758
00:25:59,279 --> 00:26:00,960
well it turns out it's the last right

759
00:26:00,960 --> 00:26:04,400
time attribute of the help svc.cc9 file

760
00:26:04,400 --> 00:26:06,480
which is loaded by the service

761
00:26:06,480 --> 00:26:09,279
which is fine it makes sense right

762
00:26:09,279 --> 00:26:10,960
but that's just one

763
00:26:10,960 --> 00:26:12,240
attribute right there are three

764
00:26:12,240 --> 00:26:14,720
timestamps on a file on windows you have

765
00:26:14,720 --> 00:26:16,640
creation time last right time and last

766
00:26:16,640 --> 00:26:18,720
access time and if you check the

767
00:26:18,720 --> 00:26:20,240
creation time

768
00:26:20,240 --> 00:26:22,240
of that file that is actually the

769
00:26:22,240 --> 00:26:25,360
interesting date for us

770
00:26:25,360 --> 00:26:29,279
so that was interesting

771
00:26:29,919 --> 00:26:32,240
if we fast forward a little bit and

772
00:26:32,240 --> 00:26:34,000
we'll actually show you the exact

773
00:26:34,000 --> 00:26:35,919
commands that the thread actor used to

774
00:26:35,919 --> 00:26:37,360
install that persistent malicious

775
00:26:37,360 --> 00:26:40,640
service this is exactly what they did

776
00:26:40,640 --> 00:26:42,080
they create a service and they point to

777
00:26:42,080 --> 00:26:44,559
spc host as a network service

778
00:26:44,559 --> 00:26:46,880
they give it a name and then they set a

779
00:26:46,880 --> 00:26:48,960
registry key under that service that

780
00:26:48,960 --> 00:26:50,960
says service dll and then the path to

781
00:26:50,960 --> 00:26:53,520
the help svc.cc9 file

782
00:26:53,520 --> 00:26:55,600
which is just a little bit clever way

783
00:26:55,600 --> 00:26:57,200
than just pointing your service to your

784
00:26:57,200 --> 00:26:59,520
malware you point to svc host and then

785
00:26:59,520 --> 00:27:01,919
you instruct svc host to load that when

786
00:27:01,919 --> 00:27:03,440
it runs

787
00:27:03,440 --> 00:27:05,039
kind of feels like a dll site loading in

788
00:27:05,039 --> 00:27:06,480
a way right you just use the legitimate

789
00:27:06,480 --> 00:27:08,400
process to do your bad stuff

790
00:27:08,400 --> 00:27:09,279
um

791
00:27:09,279 --> 00:27:11,440
but uh yeah then you give a description

792
00:27:11,440 --> 00:27:13,360
and then some settings for what to do

793
00:27:13,360 --> 00:27:15,279
when it fails then you have a powershell

794
00:27:15,279 --> 00:27:17,039
one niner down there that takes the last

795
00:27:17,039 --> 00:27:20,159
right time of your malicious.cc9 file

796
00:27:20,159 --> 00:27:22,799
and it sets it to the last right time of

797
00:27:22,799 --> 00:27:24,880
a legitimate dll in the season 32

798
00:27:24,880 --> 00:27:27,360
directory

799
00:27:27,600 --> 00:27:29,440
that's time stomping right you take you

800
00:27:29,440 --> 00:27:31,200
change the time of stuff it's time

801
00:27:31,200 --> 00:27:32,240
stomping

802
00:27:32,240 --> 00:27:34,399
obviously very easy to do right

803
00:27:34,399 --> 00:27:36,159
uh

804
00:27:36,159 --> 00:27:37,600
now they could have done the same for

805
00:27:37,600 --> 00:27:39,360
changing the creation time and the last

806
00:27:39,360 --> 00:27:40,880
access time

807
00:27:40,880 --> 00:27:42,480
i don't know what they did i didn't

808
00:27:42,480 --> 00:27:43,520
write this

809
00:27:43,520 --> 00:27:44,960
but uh

810
00:27:44,960 --> 00:27:46,840
i mean i would have changed all

811
00:27:46,840 --> 00:27:48,960
three but to be honest that's what

812
00:27:48,960 --> 00:27:51,120
autoruns gives you anyways right

813
00:27:51,120 --> 00:27:53,120
that's what we saw we had to manually

814
00:27:53,120 --> 00:27:55,120
look into the creation time of that file

815
00:27:55,120 --> 00:27:56,480
to figure out

816
00:27:56,480 --> 00:27:57,679
you know that something wasn't really

817
00:27:57,679 --> 00:27:59,279
matching

818
00:27:59,279 --> 00:28:01,200
um

819
00:28:01,200 --> 00:28:02,640
so then we started thinking how many

820
00:28:02,640 --> 00:28:04,399
other timestamps

821
00:28:04,399 --> 00:28:06,159
could be of interest when we want to

822
00:28:06,159 --> 00:28:08,320
narrow down some service installation

823
00:28:08,320 --> 00:28:11,200
events to a specific date

824
00:28:11,200 --> 00:28:12,240
uh

825
00:28:12,240 --> 00:28:13,520
other than these three that we're

826
00:28:13,520 --> 00:28:15,039
looking at now

827
00:28:15,039 --> 00:28:16,880
so we were a tool

828
00:28:16,880 --> 00:28:18,159
we were a tool that goes through the

829
00:28:18,159 --> 00:28:20,080
registry and grabs everything basically

830
00:28:20,080 --> 00:28:22,799
on the services uh this is something on

831
00:28:22,799 --> 00:28:24,799
github i'm going to put the link there

832
00:28:24,799 --> 00:28:27,279
in a second

833
00:28:27,279 --> 00:28:29,760
it basically you can run it on a system

834
00:28:29,760 --> 00:28:31,039
and then you can

835
00:28:31,039 --> 00:28:32,399
uh

836
00:28:32,399 --> 00:28:33,919
get a result that looks kind of like

837
00:28:33,919 --> 00:28:35,360
this you're going to get

838
00:28:35,360 --> 00:28:36,720
i mean you can just

839
00:28:36,720 --> 00:28:39,919
output it in json if you like

840
00:28:39,919 --> 00:28:41,679
and this is just to zoom into the help

841
00:28:41,679 --> 00:28:44,320
as pc servers we were looking at uh you

842
00:28:44,320 --> 00:28:46,240
have like information about the service

843
00:28:46,240 --> 00:28:48,480
itself and then you have like a couple

844
00:28:48,480 --> 00:28:50,240
of main sections you have

845
00:28:50,240 --> 00:28:52,880
uh the command line details

846
00:28:52,880 --> 00:28:54,559
that's what the service points to right

847
00:28:54,559 --> 00:28:56,320
that's the svc host and the three

848
00:28:56,320 --> 00:28:59,039
timestamps of spc host.exe which in our

849
00:28:59,039 --> 00:29:01,120
case were not very interesting because

850
00:29:01,120 --> 00:29:02,720
that was the legitimate one but if you

851
00:29:02,720 --> 00:29:03,840
have a service that actually points

852
00:29:03,840 --> 00:29:05,440
directly to a malicious file then those

853
00:29:05,440 --> 00:29:07,279
will be the three timestamps of that

854
00:29:07,279 --> 00:29:09,200
malicious file

855
00:29:09,200 --> 00:29:11,520
the other part is the actual service dll

856
00:29:11,520 --> 00:29:14,240
path right the one that is loaded

857
00:29:14,240 --> 00:29:17,279
at runtime by the service when it starts

858
00:29:17,279 --> 00:29:18,240
uh

859
00:29:18,240 --> 00:29:20,159
and the three timestamps of that file as

860
00:29:20,159 --> 00:29:20,960
well

861
00:29:20,960 --> 00:29:22,480
now in our case one of those was time

862
00:29:22,480 --> 00:29:24,559
stomped the other two weren't

863
00:29:24,559 --> 00:29:26,960
uh so we were actually good enough at

864
00:29:26,960 --> 00:29:29,120
that in a particular case we're good

865
00:29:29,120 --> 00:29:30,960
enough with this

866
00:29:30,960 --> 00:29:32,880
there's one extra

867
00:29:32,880 --> 00:29:35,520
time step that we can use

868
00:29:35,520 --> 00:29:36,720
uh

869
00:29:36,720 --> 00:29:38,880
because when you create a service

870
00:29:38,880 --> 00:29:41,679
uh that is created in the registry right

871
00:29:41,679 --> 00:29:44,320
and it creates a key under services

872
00:29:44,320 --> 00:29:47,360
uh and registry keys have timestamps too

873
00:29:47,360 --> 00:29:48,880
so you can actually check the right the

874
00:29:48,880 --> 00:29:51,120
last right time of the registry key in

875
00:29:51,120 --> 00:29:52,320
the registry

876
00:29:52,320 --> 00:29:54,159
uh right so you don't have to rely on

877
00:29:54,159 --> 00:29:56,080
files directly

878
00:29:56,080 --> 00:29:58,080
and it's not that common to time stomp

879
00:29:58,080 --> 00:29:59,760
this one

880
00:29:59,760 --> 00:30:02,399
uh might be possible maybe maybe stuck

881
00:30:02,399 --> 00:30:04,000
with that in a second but it's not that

882
00:30:04,000 --> 00:30:07,440
common to do anyways and uh

883
00:30:07,440 --> 00:30:10,159
that tool also gives you uh if you want

884
00:30:10,159 --> 00:30:12,080
a nice timeline that kind of looks like

885
00:30:12,080 --> 00:30:13,679
this so you can actually run it across a

886
00:30:13,679 --> 00:30:15,840
lot of systems and then build a time and

887
00:30:15,840 --> 00:30:17,200
zoom into the interesting point in time

888
00:30:17,200 --> 00:30:18,399
and then you see if

889
00:30:18,399 --> 00:30:20,240
you know you're looking at the image

890
00:30:20,240 --> 00:30:22,159
path creation time or a registry key

891
00:30:22,159 --> 00:30:23,600
last right time

892
00:30:23,600 --> 00:30:25,360
so that kind of helps

893
00:30:25,360 --> 00:30:27,200
identify that it's going to be a very

894
00:30:27,200 --> 00:30:28,559
long timeline but if you have a specific

895
00:30:28,559 --> 00:30:30,159
point in time

896
00:30:30,159 --> 00:30:33,760
uh then you know you can zoom in there

897
00:30:33,760 --> 00:30:36,240
and the tool is in up

898
00:30:36,240 --> 00:30:39,200
uh we put it there last night

899
00:30:39,200 --> 00:30:41,200
uh alex

900
00:30:41,200 --> 00:30:42,880
put it on the gate we gotta talk

901
00:30:42,880 --> 00:30:44,720
tomorrow

902
00:30:44,720 --> 00:30:46,799
uh no but really uh it's something that

903
00:30:46,799 --> 00:30:49,279
we we worked you know up until last

904
00:30:49,279 --> 00:30:51,039
night to make additional improvements

905
00:30:51,039 --> 00:30:52,159
and uh

906
00:30:52,159 --> 00:30:54,080
now it's out there so hopefully it will

907
00:30:54,080 --> 00:30:57,440
help in figuring out at least services

908
00:30:57,440 --> 00:30:59,679
uh in terms of potentially time stopped

909
00:30:59,679 --> 00:31:01,200
services and

910
00:31:01,200 --> 00:31:02,720
there is a lot of other persistence of

911
00:31:02,720 --> 00:31:04,480
course uh

912
00:31:04,480 --> 00:31:07,120
one thing at a time okay

913
00:31:07,120 --> 00:31:09,760
no but really it helped so

914
00:31:09,760 --> 00:31:11,279
we think it could help you guys too if

915
00:31:11,279 --> 00:31:15,440
you're doing a response or investigation

916
00:31:16,399 --> 00:31:19,840
okay so you know fabio talked about that

917
00:31:19,840 --> 00:31:22,559
register key well apparently that's not

918
00:31:22,559 --> 00:31:25,519
really exposed to powershell by itself

919
00:31:25,519 --> 00:31:27,600
so you can't use well you can talk to

920
00:31:27,600 --> 00:31:29,600
the api and talk to it but it's not

921
00:31:29,600 --> 00:31:32,320
really that easy and tricky but this

922
00:31:32,320 --> 00:31:33,840
homie here the guy in the middle with

923
00:31:33,840 --> 00:31:36,960
ukulele um he actually put a pretty

924
00:31:36,960 --> 00:31:37,919
smart

925
00:31:37,919 --> 00:31:40,399
c-sharp powershell thing that he built

926
00:31:40,399 --> 00:31:42,799
his name is up there he used to live in

927
00:31:42,799 --> 00:31:45,440
china his friends gave him a chinese not

928
00:31:45,440 --> 00:31:47,760
going to not eat going to even try to

929
00:31:47,760 --> 00:31:49,440
butcher it so

930
00:31:49,440 --> 00:31:51,919
you need to check them out um but if you

931
00:31:51,919 --> 00:31:54,480
take that script line and you smash that

932
00:31:54,480 --> 00:31:57,279
pop into powershell you can change this

933
00:31:57,279 --> 00:31:59,279
timeline here so you can set the date

934
00:31:59,279 --> 00:32:00,960
time to whatever time that you like

935
00:32:00,960 --> 00:32:02,320
which is particularly something that's

936
00:32:02,320 --> 00:32:04,399
good on the system and then you'll set

937
00:32:04,399 --> 00:32:06,399
it to whatever key that you want to

938
00:32:06,399 --> 00:32:08,960
timestamp in that reg key so make sure

939
00:32:08,960 --> 00:32:11,279
red teamers that you stomp all your keys

940
00:32:11,279 --> 00:32:13,360
because you want to stay sneaking

941
00:32:13,360 --> 00:32:15,279
underneath the radar and don't tell any

942
00:32:15,279 --> 00:32:16,880
of the attackers about this because that

943
00:32:16,880 --> 00:32:19,279
would be a problem for us

944
00:32:19,279 --> 00:32:21,200
but as you can see here you run it boom

945
00:32:21,200 --> 00:32:23,279
it updates this directly and it's all

946
00:32:23,279 --> 00:32:25,519
nice and shiny but if you went through

947
00:32:25,519 --> 00:32:27,919
all that process of just being all ultra

948
00:32:27,919 --> 00:32:29,840
sneaky you time stumped everything

949
00:32:29,840 --> 00:32:31,200
you're covering your tracks and then you

950
00:32:31,200 --> 00:32:32,880
decide

951
00:32:32,880 --> 00:32:35,519
to live off the land a bit and why not

952
00:32:35,519 --> 00:32:38,640
use rdp while you're at it so you're you

953
00:32:38,640 --> 00:32:40,240
have this compromised system and it's

954
00:32:40,240 --> 00:32:43,200
time to move on so you open up

955
00:32:43,200 --> 00:32:44,880
microsoft terminal services because

956
00:32:44,880 --> 00:32:46,640
you're going to jump box in the next box

957
00:32:46,640 --> 00:32:48,799
and see whatever goes on on that system

958
00:32:48,799 --> 00:32:51,360
that's a good thing but you will be

959
00:32:51,360 --> 00:32:53,600
leaving trails behind

960
00:32:53,600 --> 00:32:55,600
you will you will

961
00:32:55,600 --> 00:32:57,440
and it's uh you know

962
00:32:57,440 --> 00:32:59,600
you can't debate whether using rdp to

963
00:32:59,600 --> 00:33:01,200
jump around is good or not i guess there

964
00:33:01,200 --> 00:33:03,279
are goods and bads i mean

965
00:33:03,279 --> 00:33:05,840
that's what the admins do right so what

966
00:33:05,840 --> 00:33:08,399
better way do you have to kind of hide

967
00:33:08,399 --> 00:33:10,320
in plain then using exactly what the

968
00:33:10,320 --> 00:33:12,159
admins use

969
00:33:12,159 --> 00:33:14,640
so that's that's a pro i guess if you

970
00:33:14,640 --> 00:33:16,240
look at it that way or maybe you just

971
00:33:16,240 --> 00:33:17,519
don't know how to run command loop

972
00:33:17,519 --> 00:33:18,960
command line tools and then you have to

973
00:33:18,960 --> 00:33:20,960
use rdp whatever reason you're going to

974
00:33:20,960 --> 00:33:23,039
leave some traces behind and

975
00:33:23,039 --> 00:33:25,200
we're talking here about the case where

976
00:33:25,200 --> 00:33:26,640
you run

977
00:33:26,640 --> 00:33:29,760
an rdp client session uh from

978
00:33:29,760 --> 00:33:30,720
a system that you have already

979
00:33:30,720 --> 00:33:31,919
compromised

980
00:33:31,919 --> 00:33:34,399
right so say you jump on that rdp

981
00:33:34,399 --> 00:33:35,840
exposed system and then from there you

982
00:33:35,840 --> 00:33:37,519
rdp somewhere else

983
00:33:37,519 --> 00:33:39,840
that middle jump server i guess is now

984
00:33:39,840 --> 00:33:41,679
called

985
00:33:41,679 --> 00:33:43,440
that will leave some trace from the rdp

986
00:33:43,440 --> 00:33:44,640
client side

987
00:33:44,640 --> 00:33:45,600
right

988
00:33:45,600 --> 00:33:47,600
which lives here

989
00:33:47,600 --> 00:33:48,880
in your

990
00:33:48,880 --> 00:33:50,960
app data local directory for the user

991
00:33:50,960 --> 00:33:53,279
you're using currently to start the msds

992
00:33:53,279 --> 00:33:56,000
exe process uh it will leave some files

993
00:33:56,000 --> 00:33:57,279
here as soon as you establish that

994
00:33:57,279 --> 00:33:59,519
connection and you have a visual desktop

995
00:33:59,519 --> 00:34:01,919
in front of you for the remote system

996
00:34:01,919 --> 00:34:03,840
locally it's going to cache this stuff

997
00:34:03,840 --> 00:34:07,120
and that's basically cached images of

998
00:34:07,120 --> 00:34:08,560
the screen

999
00:34:08,560 --> 00:34:11,119
uh and that's simply there to

1000
00:34:11,119 --> 00:34:12,560
uh

1001
00:34:12,560 --> 00:34:15,119
we call it uh reduce bandwidth thank you

1002
00:34:15,119 --> 00:34:17,359
reduce bandwidth right so you avoid

1003
00:34:17,359 --> 00:34:18,960
sending those images back and forth if

1004
00:34:18,960 --> 00:34:20,320
it's the same image you have it cached

1005
00:34:20,320 --> 00:34:22,320
fine you just grab it locally

1006
00:34:22,320 --> 00:34:24,399
it's not readable in terms of you can

1007
00:34:24,399 --> 00:34:26,399
just open it up in an image viewer it's

1008
00:34:26,399 --> 00:34:28,800
not going to work it's binary stuff

1009
00:34:28,800 --> 00:34:31,599
but smart people have written tools and

1010
00:34:31,599 --> 00:34:34,399
you can run like this one bmc tools uh

1011
00:34:34,399 --> 00:34:36,320
you're gonna give it a just a path where

1012
00:34:36,320 --> 00:34:37,839
those files are

1013
00:34:37,839 --> 00:34:40,719
and uh it's gonna spit out

1014
00:34:40,719 --> 00:34:43,119
for an average session still like

1015
00:34:43,119 --> 00:34:44,560
thousands and thousands of very very

1016
00:34:44,560 --> 00:34:46,399
small images

1017
00:34:46,399 --> 00:34:48,560
without really an order

1018
00:34:48,560 --> 00:34:50,639
uh

1019
00:34:50,639 --> 00:34:52,159
and then it also has the option to

1020
00:34:52,159 --> 00:34:54,239
create a nice like all

1021
00:34:54,239 --> 00:34:56,079
stitched together type of image so

1022
00:34:56,079 --> 00:34:57,440
you're gonna get something that looks

1023
00:34:57,440 --> 00:34:58,720
like this

1024
00:34:58,720 --> 00:35:01,119
which is blurred on purpose but it's uh

1025
00:35:01,119 --> 00:35:04,320
usually like a 100 200 megabytes file

1026
00:35:04,320 --> 00:35:05,440
that you can really zoom into the

1027
00:35:05,440 --> 00:35:07,200
details

1028
00:35:07,200 --> 00:35:09,119
but it's not ordered

1029
00:35:09,119 --> 00:35:11,200
it's chaos uh it's a bit of a mac there

1030
00:35:11,200 --> 00:35:13,680
is some kind of ordering it goes

1031
00:35:13,680 --> 00:35:17,200
kind of like from from top uh right to

1032
00:35:17,200 --> 00:35:18,720
left and then up

1033
00:35:18,720 --> 00:35:21,280
uh but it also depends how you move your

1034
00:35:21,280 --> 00:35:23,359
mouse

1035
00:35:23,359 --> 00:35:25,119
i don't know so there's no there's no

1036
00:35:25,119 --> 00:35:27,119
real like way

1037
00:35:27,119 --> 00:35:28,880
i guess it's a proprietary algorithm

1038
00:35:28,880 --> 00:35:30,240
it's part of windows right part of the

1039
00:35:30,240 --> 00:35:33,200
mstsc client itself in figuring out how

1040
00:35:33,200 --> 00:35:35,119
to store it and how to actually reuse it

1041
00:35:35,119 --> 00:35:38,640
for uh for reducing the bandwidth

1042
00:35:38,640 --> 00:35:39,839
i don't know i leave that to someone

1043
00:35:39,839 --> 00:35:41,599
else to reverse and figure out but

1044
00:35:41,599 --> 00:35:43,680
anyway you get stuff like this and then

1045
00:35:43,680 --> 00:35:45,359
you zoom in

1046
00:35:45,359 --> 00:35:46,720
and you try to figure out what what they

1047
00:35:46,720 --> 00:35:49,040
did so we'll take a case

1048
00:35:49,040 --> 00:35:51,200
where this actually helped us a lot

1049
00:35:51,200 --> 00:35:52,240
because

1050
00:35:52,240 --> 00:35:53,839
uh

1051
00:35:53,839 --> 00:35:56,320
you don't always have logs right

1052
00:35:56,320 --> 00:35:57,920
you don't always have a nice scene where

1053
00:35:57,920 --> 00:35:59,440
you can actually do your query and you

1054
00:35:59,440 --> 00:36:00,880
don't have

1055
00:36:00,880 --> 00:36:03,040
whatever things you know things happen

1056
00:36:03,040 --> 00:36:06,000
so or not happen but uh

1057
00:36:06,000 --> 00:36:07,359
in that case we didn't have so much logs

1058
00:36:07,359 --> 00:36:09,040
we didn't have so many artifacts left on

1059
00:36:09,040 --> 00:36:10,960
disk so we had to rely on this type of

1060
00:36:10,960 --> 00:36:12,640
stuff and

1061
00:36:12,640 --> 00:36:14,079
we zoomed in a little bit and we saw

1062
00:36:14,079 --> 00:36:16,160
stuff like this

1063
00:36:16,160 --> 00:36:17,280
which

1064
00:36:17,280 --> 00:36:19,520
again it's all unordered and stuff but

1065
00:36:19,520 --> 00:36:21,599
to the keen eye

1066
00:36:21,599 --> 00:36:23,200
this is kind of

1067
00:36:23,200 --> 00:36:25,359
showing that they probably did this

1068
00:36:25,359 --> 00:36:27,040
right that's what it looks like it looks

1069
00:36:27,040 --> 00:36:28,800
like mimics there are some pieces there

1070
00:36:28,800 --> 00:36:29,599
like

1071
00:36:29,599 --> 00:36:32,160
uh you know the stars for the output

1072
00:36:32,160 --> 00:36:33,680
file the yellow part is stuff we

1073
00:36:33,680 --> 00:36:36,720
redacted because it's a real image

1074
00:36:36,720 --> 00:36:38,800
so

1075
00:36:38,800 --> 00:36:40,960
yeah you can kind of feel that yeah they

1076
00:36:40,960 --> 00:36:43,280
probably ran them against yeah you don't

1077
00:36:43,280 --> 00:36:45,839
know where because this this is just

1078
00:36:45,839 --> 00:36:47,680
showing you what the remote desktop

1079
00:36:47,680 --> 00:36:49,920
client was showing on screen for that

1080
00:36:49,920 --> 00:36:51,200
user though

1081
00:36:51,200 --> 00:36:52,960
for that user yes you don't know what

1082
00:36:52,960 --> 00:36:54,400
system that you can correlate with other

1083
00:36:54,400 --> 00:36:57,440
logs and you don't know even you know if

1084
00:36:57,440 --> 00:37:00,079
they manually wrote that output in the

1085
00:37:00,079 --> 00:37:01,680
command line or if it's actually

1086
00:37:01,680 --> 00:37:04,000
executed very likely they accurate right

1087
00:37:04,000 --> 00:37:06,000
but there's nothing telling you that so

1088
00:37:06,000 --> 00:37:07,680
it's not really a log right we'll get to

1089
00:37:07,680 --> 00:37:08,880
that

1090
00:37:08,880 --> 00:37:11,680
then we find stuff like this

1091
00:37:11,680 --> 00:37:13,599
uh

1092
00:37:13,599 --> 00:37:14,800
there in the middle we kind of have it

1093
00:37:14,800 --> 00:37:16,240
straight away it says hydra and then

1094
00:37:16,240 --> 00:37:18,640
some commands

1095
00:37:18,640 --> 00:37:20,800
so you know the network brute forcer

1096
00:37:20,800 --> 00:37:22,480
hydra

1097
00:37:22,480 --> 00:37:23,760
they ran it

1098
00:37:23,760 --> 00:37:26,880
you can see some targets.txt you can see

1099
00:37:26,880 --> 00:37:28,960
in the command line you can see some

1100
00:37:28,960 --> 00:37:29,760
some

1101
00:37:29,760 --> 00:37:31,440
parts of the output file you can see

1102
00:37:31,440 --> 00:37:33,359
they use some

1103
00:37:33,359 --> 00:37:35,359
some other text files and i guess some

1104
00:37:35,359 --> 00:37:37,599
word list or whatever

1105
00:37:37,599 --> 00:37:39,680
uh any other stuff like this

1106
00:37:39,680 --> 00:37:40,560
uh

1107
00:37:40,560 --> 00:37:42,960
which i was a little bit unfamiliar with

1108
00:37:42,960 --> 00:37:45,440
this when i found it but it's a freeware

1109
00:37:45,440 --> 00:37:47,680
that is called web browser pass view

1110
00:37:47,680 --> 00:37:49,119
apparently you can just run it and it

1111
00:37:49,119 --> 00:37:52,000
extracts like passwords and cookies and

1112
00:37:52,000 --> 00:37:54,880
stuff from web browsers

1113
00:37:54,880 --> 00:37:57,440
but it was kind of interesting because

1114
00:37:57,440 --> 00:38:00,880
this is in a specific user's cache right

1115
00:38:00,880 --> 00:38:02,320
and that user happened to already be a

1116
00:38:02,320 --> 00:38:05,599
domain administrator in that case

1117
00:38:05,599 --> 00:38:06,400
so

1118
00:38:06,400 --> 00:38:08,640
why would they do additional mimic ads

1119
00:38:08,640 --> 00:38:10,960
and network-based brute forcing against

1120
00:38:10,960 --> 00:38:13,680
other services and extracting passwords

1121
00:38:13,680 --> 00:38:15,359
from browsers when they already have a

1122
00:38:15,359 --> 00:38:16,880
domain administrator account they're

1123
00:38:16,880 --> 00:38:19,680
already paying with it

1124
00:38:19,680 --> 00:38:22,400
and well this was a ransomware case uh

1125
00:38:22,400 --> 00:38:24,320
so-called big game hunting right it's a

1126
00:38:24,320 --> 00:38:26,400
new like i guess not new anymore it's

1127
00:38:26,400 --> 00:38:28,800
been a while now but uh

1128
00:38:28,800 --> 00:38:30,640
what they normally do in those types of

1129
00:38:30,640 --> 00:38:34,400
campaign or attacks i guess

1130
00:38:34,800 --> 00:38:36,880
they not only take over the whole active

1131
00:38:36,880 --> 00:38:38,560
directory but then they go after very

1132
00:38:38,560 --> 00:38:40,560
specific things like

1133
00:38:40,560 --> 00:38:42,240
hypervisors

1134
00:38:42,240 --> 00:38:44,240
which are not necessarily domain joined

1135
00:38:44,240 --> 00:38:46,000
right that's what we found next in that

1136
00:38:46,000 --> 00:38:47,599
uh picture

1137
00:38:47,599 --> 00:38:50,000
uh you know that's the hyper-v vmm and

1138
00:38:50,000 --> 00:38:53,119
that's a vmware whisper vsphere client

1139
00:38:53,119 --> 00:38:54,400
uh

1140
00:38:54,400 --> 00:38:56,000
so obviously we're going for hypervisor

1141
00:38:56,000 --> 00:38:58,640
why would you go for hypervisors well

1142
00:38:58,640 --> 00:39:00,880
it's nice to find it's an easy way to go

1143
00:39:00,880 --> 00:39:02,079
through interesting systems it's

1144
00:39:02,079 --> 00:39:04,079
probably something named backup right

1145
00:39:04,079 --> 00:39:05,200
because backups are interesting you

1146
00:39:05,200 --> 00:39:07,359
wanna wipe the backups before pushing

1147
00:39:07,359 --> 00:39:08,720
around somewhere

1148
00:39:08,720 --> 00:39:10,240
um

1149
00:39:10,240 --> 00:39:11,440
and uh

1150
00:39:11,440 --> 00:39:12,880
there's actually run somewhere that

1151
00:39:12,880 --> 00:39:14,720
either manually or as part of the

1152
00:39:14,720 --> 00:39:16,960
ransomware they do

1153
00:39:16,960 --> 00:39:18,560
they shut down all the vms and then they

1154
00:39:18,560 --> 00:39:20,720
run the ransomware on the host so it's

1155
00:39:20,720 --> 00:39:22,400
going to encrypt the virtual disk files

1156
00:39:22,400 --> 00:39:24,480
from the host which is nasty to go

1157
00:39:24,480 --> 00:39:27,040
through because nothing starts obviously

1158
00:39:27,040 --> 00:39:29,359
so that's going to be that's a painful

1159
00:39:29,359 --> 00:39:32,000
painful investigation

1160
00:39:32,000 --> 00:39:35,200
and of course backup folders

1161
00:39:36,720 --> 00:39:38,800
and it's nice to steal credits using if

1162
00:39:38,800 --> 00:39:41,520
the admins be using that computer

1163
00:39:41,520 --> 00:39:43,599
logging into the support for the backup

1164
00:39:43,599 --> 00:39:46,400
system using that those credentials then

1165
00:39:46,400 --> 00:39:50,240
you have those there so go crazy

1166
00:39:50,240 --> 00:39:52,000
that's nice but

1167
00:39:52,000 --> 00:39:54,320
i i actually didn't know about this rdp

1168
00:39:54,320 --> 00:39:56,400
cache until i was digging into and doing

1169
00:39:56,400 --> 00:39:58,240
incidents and stuff but

1170
00:39:58,240 --> 00:40:00,079
just like this guy over here i'm into

1171
00:40:00,079 --> 00:40:02,480
puzzles so it's really intriguing to go

1172
00:40:02,480 --> 00:40:04,079
through those and just look at that

1173
00:40:04,079 --> 00:40:07,280
stuff and just have that vibe but it's a

1174
00:40:07,280 --> 00:40:09,359
mess and they're really hard to figure

1175
00:40:09,359 --> 00:40:11,760
out but some smart people out there

1176
00:40:11,760 --> 00:40:13,920
delivered developed this tool called rdp

1177
00:40:13,920 --> 00:40:16,240
cash stitcher so you can

1178
00:40:16,240 --> 00:40:21,279
friday night nice whiskey drag images

1179
00:40:21,359 --> 00:40:23,359
so i'm hoping that some of you ai

1180
00:40:23,359 --> 00:40:25,760
developer big brains out here tonight

1181
00:40:25,760 --> 00:40:27,599
can help stick out a bit and maybe

1182
00:40:27,599 --> 00:40:29,920
create the ai tool that will do this

1183
00:40:29,920 --> 00:40:32,400
thing for me so i can focus on only

1184
00:40:32,400 --> 00:40:34,640
having the drinks instead or reverse the

1185
00:40:34,640 --> 00:40:36,880
algorithm that the program uses to store

1186
00:40:36,880 --> 00:40:38,560
it then it's probably easier to walk it

1187
00:40:38,560 --> 00:40:40,720
back yeah we can do that

1188
00:40:40,720 --> 00:40:42,640
but like like fabio said this is not a

1189
00:40:42,640 --> 00:40:44,880
real science it's not a real log system

1190
00:40:44,880 --> 00:40:47,520
we can't rely on that because we need to

1191
00:40:47,520 --> 00:40:49,359
verify all the things that happen they

1192
00:40:49,359 --> 00:40:51,359
could open up a folder but not do

1193
00:40:51,359 --> 00:40:54,160
anything there but if they move around

1194
00:40:54,160 --> 00:40:57,280
the system they will eventually leave

1195
00:40:57,280 --> 00:41:00,560
more traces and that's called shellbacks

1196
00:41:00,560 --> 00:41:02,160
yeah it's one of them at least which is

1197
00:41:02,160 --> 00:41:03,440
particularly interesting in this case

1198
00:41:03,440 --> 00:41:05,760
because again you're rdping into a

1199
00:41:05,760 --> 00:41:07,440
remote system right so that is another

1200
00:41:07,440 --> 00:41:09,200
compromise system

1201
00:41:09,200 --> 00:41:11,119
on that system you're rdping you have a

1202
00:41:11,119 --> 00:41:12,400
nice ui

1203
00:41:12,400 --> 00:41:15,520
gui so uh you're probably gonna browse

1204
00:41:15,520 --> 00:41:17,119
around stuff right you're probably gonna

1205
00:41:17,119 --> 00:41:19,280
like use windows explorer this one

1206
00:41:19,280 --> 00:41:21,359
to browse around directories and files

1207
00:41:21,359 --> 00:41:23,040
now explorer has a nice feature that you

1208
00:41:23,040 --> 00:41:25,839
know if you resize a window or sort by

1209
00:41:25,839 --> 00:41:27,280
date or whatever

1210
00:41:27,280 --> 00:41:28,880
that stuff is going to be remember next

1211
00:41:28,880 --> 00:41:30,800
time you open that directory or file or

1212
00:41:30,800 --> 00:41:32,960
whatever right if you re if you have

1213
00:41:32,960 --> 00:41:34,720
like big or small icons whatever that

1214
00:41:34,720 --> 00:41:36,160
stuff is stored somewhere and it's

1215
00:41:36,160 --> 00:41:38,640
stored in the registry store here

1216
00:41:38,640 --> 00:41:41,280
these are called shell bags

1217
00:41:41,280 --> 00:41:42,800
which is particularly interesting

1218
00:41:42,800 --> 00:41:44,800
because

1219
00:41:44,800 --> 00:41:46,000
you can actually reconstruct a little

1220
00:41:46,000 --> 00:41:47,680
bit of a timeline from there it's not

1221
00:41:47,680 --> 00:41:49,040
something you can just read out the box

1222
00:41:49,040 --> 00:41:51,920
you need tools eric zimmerman among his

1223
00:41:51,920 --> 00:41:54,400
great great tools he also has a a shell

1224
00:41:54,400 --> 00:41:56,400
bag explorer which has a command line

1225
00:41:56,400 --> 00:41:59,119
tool version of it

1226
00:41:59,119 --> 00:42:00,960
like you use it down there

1227
00:42:00,960 --> 00:42:02,480
you could just point it to the place

1228
00:42:02,480 --> 00:42:03,760
where you have

1229
00:42:03,760 --> 00:42:06,400
the hives of the uh

1230
00:42:06,400 --> 00:42:09,200
the registry hives of the user you wanna

1231
00:42:09,200 --> 00:42:11,359
you wanna look into

1232
00:42:11,359 --> 00:42:13,119
uh and it's gonna spit out a really nice

1233
00:42:13,119 --> 00:42:15,280
csv for you that looks like this

1234
00:42:15,280 --> 00:42:17,359
it's going to tell you which directory

1235
00:42:17,359 --> 00:42:20,240
was part of that shell bag and the time

1236
00:42:20,240 --> 00:42:22,240
stamp on it which is very interesting

1237
00:42:22,240 --> 00:42:25,280
right then you know that

1238
00:42:25,280 --> 00:42:28,000
within that interactive session the user

1239
00:42:28,000 --> 00:42:31,280
had that directory open to do whatever

1240
00:42:31,280 --> 00:42:32,640
so

1241
00:42:32,640 --> 00:42:35,040
if you correlate for example with the

1242
00:42:35,040 --> 00:42:37,200
client side of the rdp with those images

1243
00:42:37,200 --> 00:42:38,720
if you figure like okay they were

1244
00:42:38,720 --> 00:42:40,160
probably in a folder called backup you

1245
00:42:40,160 --> 00:42:41,599
could go in the remote system check the

1246
00:42:41,599 --> 00:42:43,359
shell bags and you also have the

1247
00:42:43,359 --> 00:42:45,359
timestamp of when they were in that

1248
00:42:45,359 --> 00:42:46,319
folder

1249
00:42:46,319 --> 00:42:47,680
and then you have some parts of the

1250
00:42:47,680 --> 00:42:48,880
picture too

1251
00:42:48,880 --> 00:42:50,319
so you put it together

1252
00:42:50,319 --> 00:42:51,680
and it's also nice because it's going to

1253
00:42:51,680 --> 00:42:53,680
show you the unc path if you go to

1254
00:42:53,680 --> 00:42:55,040
network share from explorer it's going

1255
00:42:55,040 --> 00:42:56,560
to show up here as well

1256
00:42:56,560 --> 00:42:58,319
and also external drives if you put it

1257
00:42:58,319 --> 00:43:00,079
in the if you put it in a computer or

1258
00:43:00,079 --> 00:43:02,480
external backup disk whatever uh it's

1259
00:43:02,480 --> 00:43:04,000
gonna show up there as an external drive

1260
00:43:04,000 --> 00:43:07,839
as well so it's uh it's very helpful

1261
00:43:07,839 --> 00:43:09,680
um

1262
00:43:09,680 --> 00:43:11,200
and it's all good when we figure out

1263
00:43:11,200 --> 00:43:12,400
what

1264
00:43:12,400 --> 00:43:13,920
when we want to figure out what they did

1265
00:43:13,920 --> 00:43:14,720
right

1266
00:43:14,720 --> 00:43:17,680
sometimes we want to be a bit you know

1267
00:43:17,680 --> 00:43:20,000
want to try and take a step further and

1268
00:43:20,000 --> 00:43:21,680
try to figure out

1269
00:43:21,680 --> 00:43:23,599
maybe what they're going to do because

1270
00:43:23,599 --> 00:43:25,119
what best way is

1271
00:43:25,119 --> 00:43:26,720
there if you already know what your

1272
00:43:26,720 --> 00:43:29,359
opponent is going to do right yeah

1273
00:43:29,359 --> 00:43:31,119
absolutely and

1274
00:43:31,119 --> 00:43:33,280
remember this one you remember the shiny

1275
00:43:33,280 --> 00:43:35,599
state sponsor kind of

1276
00:43:35,599 --> 00:43:37,280
payload thingy the

1277
00:43:37,280 --> 00:43:38,800
that we had in the beginning that was

1278
00:43:38,800 --> 00:43:42,400
the first stage of that rdp or rtf um

1279
00:43:42,400 --> 00:43:44,640
phishing email

1280
00:43:44,640 --> 00:43:46,319
we figured that

1281
00:43:46,319 --> 00:43:48,880
these guys were continuously

1282
00:43:48,880 --> 00:43:50,560
making new fishing campaigns over and

1283
00:43:50,560 --> 00:43:52,720
over again and they were just

1284
00:43:52,720 --> 00:43:54,480
there there was it's been a bit of a

1285
00:43:54,480 --> 00:43:57,040
hassle to just be against somebody that

1286
00:43:57,040 --> 00:43:59,680
has unlimited resources and manpower

1287
00:43:59,680 --> 00:44:01,839
kind of so we needed to find out if

1288
00:44:01,839 --> 00:44:03,280
there was a way for us to actually stay

1289
00:44:03,280 --> 00:44:05,119
ahead of the curve to help this customer

1290
00:44:05,119 --> 00:44:07,359
out before you know it went totally out

1291
00:44:07,359 --> 00:44:10,000
of hand so if we look into this domain

1292
00:44:10,000 --> 00:44:11,920
we're going to see if we find something

1293
00:44:11,920 --> 00:44:14,880
funky about it so of course classic hoes

1294
00:44:14,880 --> 00:44:16,480
what we found well it's registered on

1295
00:44:16,480 --> 00:44:19,359
the 19th of january so that's okay and

1296
00:44:19,359 --> 00:44:22,480
the register of this is named silo

1297
00:44:22,480 --> 00:44:24,480
quick check out on the transparency log

1298
00:44:24,480 --> 00:44:26,880
over at city. it shows that on the 19th

1299
00:44:26,880 --> 00:44:28,560
says well yeah of course they got a

1300
00:44:28,560 --> 00:44:30,640
little bit of a certificate on it but we

1301
00:44:30,640 --> 00:44:33,280
don't really know what they did after

1302
00:44:33,280 --> 00:44:35,200
that we just know that they got a

1303
00:44:35,200 --> 00:44:37,040
certificate so

1304
00:44:37,040 --> 00:44:38,400
you could use

1305
00:44:38,400 --> 00:44:39,839
um

1306
00:44:39,839 --> 00:44:41,520
tools like security trades for this

1307
00:44:41,520 --> 00:44:43,839
because they store a lot of data and

1308
00:44:43,839 --> 00:44:46,079
they have something called historical

1309
00:44:46,079 --> 00:44:48,640
dns records which is pretty cool so if

1310
00:44:48,640 --> 00:44:50,800
we smashing favorite at a bus here we

1311
00:44:50,800 --> 00:44:53,920
see that it came up on the radar on the

1312
00:44:53,920 --> 00:44:57,760
20th um for security trails and it's

1313
00:44:57,760 --> 00:44:59,839
running there for 21 days it's hosting

1314
00:44:59,839 --> 00:45:02,400
itself in choppa you know who knows what

1315
00:45:02,400 --> 00:45:04,400
they had there but then

1316
00:45:04,400 --> 00:45:05,720
it goes to

1317
00:45:05,720 --> 00:45:08,880
127.001 and it stays there for nine days

1318
00:45:08,880 --> 00:45:12,319
then it comes back again same ip same

1319
00:45:12,319 --> 00:45:14,079
same good on shopa domain stays there

1320
00:45:14,079 --> 00:45:16,800
for four days until it eventually goes

1321
00:45:16,800 --> 00:45:18,960
to 127.001

1322
00:45:18,960 --> 00:45:22,560
and it's gone until the present day

1323
00:45:22,560 --> 00:45:24,000
interesting

1324
00:45:24,000 --> 00:45:27,040
so we will check out that 12700 one you

1325
00:45:27,040 --> 00:45:29,440
can ask yourself why would anyone like

1326
00:45:29,440 --> 00:45:31,280
to

1327
00:45:31,280 --> 00:45:33,839
hosts their domain with an internal

1328
00:45:33,839 --> 00:45:36,160
localhost ipad as well they could be

1329
00:45:36,160 --> 00:45:37,680
playing around and trying to get people

1330
00:45:37,680 --> 00:45:39,520
to own themselves that's obviously a

1331
00:45:39,520 --> 00:45:43,280
good reason for it but when 2.2 million

1332
00:45:43,280 --> 00:45:45,520
records have that there's got to be some

1333
00:45:45,520 --> 00:45:46,880
kind of reason

1334
00:45:46,880 --> 00:45:48,800
maybe it's for

1335
00:45:48,800 --> 00:45:51,040
i don't know maybe it is that

1336
00:45:51,040 --> 00:45:53,200
that would become something later maybe

1337
00:45:53,200 --> 00:45:56,079
is some of these domains might just be

1338
00:45:56,079 --> 00:45:59,440
kill switches or even sinkholes because

1339
00:45:59,440 --> 00:46:01,680
if you're running a malware on a system

1340
00:46:01,680 --> 00:46:03,440
and you want it to stop talking to the

1341
00:46:03,440 --> 00:46:05,200
internet what is better than making a

1342
00:46:05,200 --> 00:46:07,119
dns request to localhost and it's just

1343
00:46:07,119 --> 00:46:08,960
going to keep on talking until you

1344
00:46:08,960 --> 00:46:10,880
refresh the dns and one line goes out

1345
00:46:10,880 --> 00:46:12,720
again so

1346
00:46:12,720 --> 00:46:14,800
we kind of figured that that was going

1347
00:46:14,800 --> 00:46:15,920
on

1348
00:46:15,920 --> 00:46:18,480
later at this stage we realized that we

1349
00:46:18,480 --> 00:46:20,960
got another ifc from their c2 channel

1350
00:46:20,960 --> 00:46:23,040
that's the other part of the malware

1351
00:46:23,040 --> 00:46:25,760
that was kicking off and that domain was

1352
00:46:25,760 --> 00:46:29,280
this one the msft.ncsi

1353
00:46:29,280 --> 00:46:31,680
and it was registered in november

1354
00:46:31,680 --> 00:46:33,839
the well-trained eye here we see that

1355
00:46:33,839 --> 00:46:37,040
it's extremely simple similar to the

1356
00:46:37,040 --> 00:46:39,920
official microsoft one called msft and

1357
00:46:39,920 --> 00:46:42,319
csi that's the one without the dash

1358
00:46:42,319 --> 00:46:45,200
that's been around since 2005 and that's

1359
00:46:45,200 --> 00:46:47,359
actually the domain that any windows 10

1360
00:46:47,359 --> 00:46:49,760
box will try to access to see if they

1361
00:46:49,760 --> 00:46:52,079
have connection to the internet so you

1362
00:46:52,079 --> 00:46:54,079
can expect a lot of those requests in

1363
00:46:54,079 --> 00:46:56,880
your systems so it was a pretty sneaky

1364
00:46:56,880 --> 00:46:58,000
stuff

1365
00:46:58,000 --> 00:46:59,040
okay

1366
00:46:59,040 --> 00:47:00,880
can we find any similarities we looked

1367
00:47:00,880 --> 00:47:03,040
into this as well it started his life in

1368
00:47:03,040 --> 00:47:05,839
november back at cloudflare then it

1369
00:47:05,839 --> 00:47:08,640
moved around so it stayed for about

1370
00:47:08,640 --> 00:47:13,200
three months over at digital ocean

1371
00:47:13,200 --> 00:47:16,160
then it's sinkholed for a couple of days

1372
00:47:16,160 --> 00:47:18,160
interesting and then it came back only

1373
00:47:18,160 --> 00:47:19,599
node

1374
00:47:19,599 --> 00:47:20,400
so

1375
00:47:20,400 --> 00:47:22,960
if we look at that a bit further we'll

1376
00:47:22,960 --> 00:47:25,280
see that both domains

1377
00:47:25,280 --> 00:47:28,079
were registered using name silo so at

1378
00:47:28,079 --> 00:47:30,079
least we know they have a preference of

1379
00:47:30,079 --> 00:47:32,800
using a defined

1380
00:47:32,800 --> 00:47:35,359
registrar right and

1381
00:47:35,359 --> 00:47:37,839
thinking out of a business perspective

1382
00:47:37,839 --> 00:47:40,319
if your organization says we're only

1383
00:47:40,319 --> 00:47:42,079
using name silo

1384
00:47:42,079 --> 00:47:44,079
because that's what we have decided

1385
00:47:44,079 --> 00:47:45,440
that's kind of how chinese state

1386
00:47:45,440 --> 00:47:47,760
sponsors work they are very organized in

1387
00:47:47,760 --> 00:47:49,520
cert there's maybe they have even up

1388
00:47:49,520 --> 00:47:53,040
handling on that who knows so

1389
00:47:53,040 --> 00:47:55,280
when we look at these two ip addresses

1390
00:47:55,280 --> 00:47:57,920
we see here they both go offline for

1391
00:47:57,920 --> 00:48:00,480
exactly the same period for exactly the

1392
00:48:00,480 --> 00:48:02,640
same amount of days i don't think that

1393
00:48:02,640 --> 00:48:05,119
has nothing to do with the big lantern

1394
00:48:05,119 --> 00:48:06,880
festival which is a part of the chinese

1395
00:48:06,880 --> 00:48:08,720
new year but

1396
00:48:08,720 --> 00:48:10,640
in theory it could right

1397
00:48:10,640 --> 00:48:12,480
so what's interesting though is that

1398
00:48:12,480 --> 00:48:14,240
faurita the boss the first day's payload

1399
00:48:14,240 --> 00:48:16,160
never comes back again but the c2

1400
00:48:16,160 --> 00:48:19,040
channel makes a jump and moves closer to

1401
00:48:19,040 --> 00:48:21,760
the customer in a linode section instead

1402
00:48:21,760 --> 00:48:23,280
of the more

1403
00:48:23,280 --> 00:48:25,920
you know the more dirty droplet over at

1404
00:48:25,920 --> 00:48:27,680
digital ocean

1405
00:48:27,680 --> 00:48:30,400
so here we are thinking that okay

1406
00:48:30,400 --> 00:48:33,280
named silo sinkholing

1407
00:48:33,280 --> 00:48:35,040
they're doing this obviously because we

1408
00:48:35,040 --> 00:48:36,800
find more and more ifcs doing the same

1409
00:48:36,800 --> 00:48:38,000
kind of thing

1410
00:48:38,000 --> 00:48:40,160
how can we look into the crystal ball

1411
00:48:40,160 --> 00:48:43,280
and be uh ahead of the curve of this one

1412
00:48:43,280 --> 00:48:44,319
so

1413
00:48:44,319 --> 00:48:46,480
trailer thought was let's gather all the

1414
00:48:46,480 --> 00:48:48,480
localhost mains on the internet

1415
00:48:48,480 --> 00:48:50,079
and then we're going to collect the who

1416
00:48:50,079 --> 00:48:52,960
is data all those grip names silo and

1417
00:48:52,960 --> 00:48:55,200
monitor them for changes which was a

1418
00:48:55,200 --> 00:48:58,000
good idea so i needed to make a little

1419
00:48:58,000 --> 00:49:01,520
bit of poc on that so spice has 4.1

1420
00:49:01,520 --> 00:49:03,680
million records collected and historical

1421
00:49:03,680 --> 00:49:05,520
so why not use that because they have

1422
00:49:05,520 --> 00:49:06,960
this really neat

1423
00:49:06,960 --> 00:49:10,400
free filtering service so you type in

1424
00:49:10,400 --> 00:49:13,160
the register name silo in there and okay

1425
00:49:13,160 --> 00:49:17,119
645 000 domains that's a bunch of them

1426
00:49:17,119 --> 00:49:18,559
bear with me they are not all the

1427
00:49:18,559 --> 00:49:19,920
domains in the world regards to my name

1428
00:49:19,920 --> 00:49:21,280
silent but these are the ones that at

1429
00:49:21,280 --> 00:49:23,440
least spice knows about then we can add

1430
00:49:23,440 --> 00:49:25,440
another filter which it says i want to

1431
00:49:25,440 --> 00:49:28,160
look for the dns record that's 127.01

1432
00:49:28,160 --> 00:49:31,520
and we have now 373 records that's a

1433
00:49:31,520 --> 00:49:33,760
better number to work with

1434
00:49:33,760 --> 00:49:35,200
so

1435
00:49:35,200 --> 00:49:37,760
at that stage if you're like yeah 373

1436
00:49:37,760 --> 00:49:39,920
this is going to be easy breezy but then

1437
00:49:39,920 --> 00:49:42,000
you realize damn it that claims register

1438
00:49:42,000 --> 00:49:44,240
a new domain and that was historical

1439
00:49:44,240 --> 00:49:47,520
data so we need to be proactive in this

1440
00:49:47,520 --> 00:49:50,000
but fortunately the whois domain search

1441
00:49:50,000 --> 00:49:52,000
releases daily all the records of all

1442
00:49:52,000 --> 00:49:53,280
the domains that being registered all

1443
00:49:53,280 --> 00:49:55,680
the time and it's everything from 50 000

1444
00:49:55,680 --> 00:49:59,359
to 250 000 domains on every day so we

1445
00:49:59,359 --> 00:50:00,960
started to grip

1446
00:50:00,960 --> 00:50:02,800
get those daily right

1447
00:50:02,800 --> 00:50:05,440
and then it wrote a little crappy bash

1448
00:50:05,440 --> 00:50:08,559
script here that what it did is that

1449
00:50:08,559 --> 00:50:10,480
you know it it went through the name

1450
00:50:10,480 --> 00:50:12,160
silo file that we populate with all

1451
00:50:12,160 --> 00:50:14,720
these new domains all the time paul went

1452
00:50:14,720 --> 00:50:16,720
through a new which is a two by tom nom

1453
00:50:16,720 --> 00:50:19,040
nom that just only

1454
00:50:19,040 --> 00:50:20,960
um worked on the things that were new

1455
00:50:20,960 --> 00:50:22,640
and the ones that we've been processes

1456
00:50:22,640 --> 00:50:24,480
would end up being processed right you

1457
00:50:24,480 --> 00:50:26,800
know who is grip for name silo look for

1458
00:50:26,800 --> 00:50:28,319
whatever goes on and put that in

1459
00:50:28,319 --> 00:50:29,920
sinkhole.txt

1460
00:50:29,920 --> 00:50:31,839
run that with the cron job every day and

1461
00:50:31,839 --> 00:50:34,079
we collected all the data that we needed

1462
00:50:34,079 --> 00:50:36,400
then have this continuously running

1463
00:50:36,400 --> 00:50:38,960
other while loop where look for that use

1464
00:50:38,960 --> 00:50:41,839
dns x by project discovery to make a

1465
00:50:41,839 --> 00:50:44,400
really fast dns lookup for that

1466
00:50:44,400 --> 00:50:46,040
negative grip for the

1467
00:50:46,040 --> 00:50:49,599
127.01 because we know those and we're

1468
00:50:49,599 --> 00:50:52,720
extremely interested when things happen

1469
00:50:52,720 --> 00:50:55,920
so if that changes from 127.001

1470
00:50:55,920 --> 00:50:59,119
we want to get a little bit of that nice

1471
00:50:59,119 --> 00:51:01,599
in our slack channel that says that we

1472
00:51:01,599 --> 00:51:04,160
this has now left the sinkhole so we can

1473
00:51:04,160 --> 00:51:06,160
start to look into that and we use we

1474
00:51:06,160 --> 00:51:08,240
use notify for that which is also a tool

1475
00:51:08,240 --> 00:51:10,000
where you can just pipe anything into it

1476
00:51:10,000 --> 00:51:11,680
and it's going to throw things in your

1477
00:51:11,680 --> 00:51:13,760
telegram or

1478
00:51:13,760 --> 00:51:15,760
slack channel or discord or whatever and

1479
00:51:15,760 --> 00:51:17,599
then let it sleep for a while and you

1480
00:51:17,599 --> 00:51:20,160
know continuously run

1481
00:51:20,160 --> 00:51:22,400
so that was a way for us to just monitor

1482
00:51:22,400 --> 00:51:25,280
those and find the threat actor before

1483
00:51:25,280 --> 00:51:27,280
they knew where the next fishing

1484
00:51:27,280 --> 00:51:29,200
campaign was going to come come from

1485
00:51:29,200 --> 00:51:30,800
because we had already been there and

1486
00:51:30,800 --> 00:51:32,720
poked at the target and so we saw

1487
00:51:32,720 --> 00:51:34,240
whatever went on

1488
00:51:34,240 --> 00:51:36,079
yeah and i think that's a it's a great

1489
00:51:36,079 --> 00:51:38,160
example of

1490
00:51:38,160 --> 00:51:39,200
the the

1491
00:51:39,200 --> 00:51:40,319
the power

1492
00:51:40,319 --> 00:51:41,599
that we have if we use threat

1493
00:51:41,599 --> 00:51:43,760
intelligence right and you know not all

1494
00:51:43,760 --> 00:51:45,440
threat intelligence is useful threat

1495
00:51:45,440 --> 00:51:47,760
intelligence but the you know some is

1496
00:51:47,760 --> 00:51:48,480
and

1497
00:51:48,480 --> 00:51:50,960
uh so then the idea is how how do we

1498
00:51:50,960 --> 00:51:52,559
make this even better

1499
00:51:52,559 --> 00:51:53,440
uh

1500
00:51:53,440 --> 00:51:55,599
how can we be even better prepared uh

1501
00:51:55,599 --> 00:51:57,520
using threat intelligence

1502
00:51:57,520 --> 00:51:59,200
uh because

1503
00:51:59,200 --> 00:52:00,800
i mean just look at what's happening

1504
00:52:00,800 --> 00:52:02,480
like we live in a world where things it

1505
00:52:02,480 --> 00:52:03,359
kind of feels like they're kind of

1506
00:52:03,359 --> 00:52:04,800
getting out of control i mean we all

1507
00:52:04,800 --> 00:52:06,240
work in the business so it doesn't maybe

1508
00:52:06,240 --> 00:52:07,599
feel like this

1509
00:52:07,599 --> 00:52:09,599
for some but but i mean just look at

1510
00:52:09,599 --> 00:52:11,680
some of the stuff that is happening

1511
00:52:11,680 --> 00:52:13,359
you got ransomware gangs doing supply

1512
00:52:13,359 --> 00:52:14,960
chain attacks and mass deploying

1513
00:52:14,960 --> 00:52:16,800
ransomwares to hundreds of organizations

1514
00:52:16,800 --> 00:52:18,400
at once

1515
00:52:18,400 --> 00:52:19,920
you know you got criminals from these

1516
00:52:19,920 --> 00:52:21,680
groups that take interviews with

1517
00:52:21,680 --> 00:52:23,760
journalists and explain how the

1518
00:52:23,760 --> 00:52:25,839
operations work and

1519
00:52:25,839 --> 00:52:27,520
they advertise their new affiliate

1520
00:52:27,520 --> 00:52:28,880
programs

1521
00:52:28,880 --> 00:52:30,800
they actively try to recruit people in

1522
00:52:30,800 --> 00:52:32,400
potential victim organizations and

1523
00:52:32,400 --> 00:52:34,559
promise millions of dollars

1524
00:52:34,559 --> 00:52:36,000
if they get them access to the internal

1525
00:52:36,000 --> 00:52:37,839
network so they can do branson where

1526
00:52:37,839 --> 00:52:39,280
they even call them after they do

1527
00:52:39,280 --> 00:52:41,280
ransomware they call the victims and

1528
00:52:41,280 --> 00:52:43,119
threaten them on the phone

1529
00:52:43,119 --> 00:52:44,800
if they don't pay

1530
00:52:44,800 --> 00:52:47,200
so they're getting bald for real

1531
00:52:47,200 --> 00:52:48,480
and they're getting they're getting

1532
00:52:48,480 --> 00:52:50,480
organized they're getting methodical

1533
00:52:50,480 --> 00:52:52,079
and they're definitely getting rich

1534
00:52:52,079 --> 00:52:53,680
they're getting very rich because cyber

1535
00:52:53,680 --> 00:52:56,400
cyber crime is thriving right now and

1536
00:52:56,400 --> 00:52:58,160
i just feel like we we need to do

1537
00:52:58,160 --> 00:53:00,079
something about it which obviously you

1538
00:53:00,079 --> 00:53:02,559
know we're all doing but how can we do

1539
00:53:02,559 --> 00:53:03,920
it even better and i don't have all the

1540
00:53:03,920 --> 00:53:05,440
right answers here i don't know i'm just

1541
00:53:05,440 --> 00:53:08,000
thinking out loud really but

1542
00:53:08,000 --> 00:53:10,079
i feel like if we just

1543
00:53:10,079 --> 00:53:12,559
use completely concretely the stuff that

1544
00:53:12,559 --> 00:53:14,559
we have every day like all stuff that we

1545
00:53:14,559 --> 00:53:15,520
know

1546
00:53:15,520 --> 00:53:18,720
and that you know that we can share

1547
00:53:18,720 --> 00:53:20,319
that can collectively

1548
00:53:20,319 --> 00:53:22,160
help us to be more prepared

1549
00:53:22,160 --> 00:53:22,880
and

1550
00:53:22,880 --> 00:53:24,160
i'm talking about sharing actionable

1551
00:53:24,160 --> 00:53:25,520
threat intelligence and it's something

1552
00:53:25,520 --> 00:53:26,720
that we've been trying to do more and

1553
00:53:26,720 --> 00:53:29,599
more the last couple years and uh

1554
00:53:29,599 --> 00:53:30,720
but yeah it's something that we need to

1555
00:53:30,720 --> 00:53:32,559
do together right we need to come

1556
00:53:32,559 --> 00:53:34,960
together and join the fight together

1557
00:53:34,960 --> 00:53:36,400
right it is really a fight at least

1558
00:53:36,400 --> 00:53:38,480
that's how i feel about it uh and

1559
00:53:38,480 --> 00:53:40,240
together i mean as an industry and as a

1560
00:53:40,240 --> 00:53:41,599
community

1561
00:53:41,599 --> 00:53:43,920
so using our understanding our knowledge

1562
00:53:43,920 --> 00:53:45,280
of the threats and everything that we

1563
00:53:45,280 --> 00:53:46,160
see

1564
00:53:46,160 --> 00:53:49,200
uh putting that together because

1565
00:53:49,200 --> 00:53:51,359
that's a weapon we can use to just take

1566
00:53:51,359 --> 00:53:52,640
the right decisions because that's what

1567
00:53:52,640 --> 00:53:54,000
it's about right if we take the right

1568
00:53:54,000 --> 00:53:55,520
decisions we do the things that actually

1569
00:53:55,520 --> 00:53:56,720
matter

1570
00:53:56,720 --> 00:53:58,319
and that's how we can ensure that the

1571
00:53:58,319 --> 00:54:00,640
job and the work that we do every day

1572
00:54:00,640 --> 00:54:02,960
actually has a bigger impact

1573
00:54:02,960 --> 00:54:04,319
so we're always open to any type of

1574
00:54:04,319 --> 00:54:05,760
collaboration

1575
00:54:05,760 --> 00:54:07,359
joint research whatever

1576
00:54:07,359 --> 00:54:08,720
this is us

1577
00:54:08,720 --> 00:54:10,559
feel free to reach out

1578
00:54:10,559 --> 00:54:13,599
and thanks for listening

1579
00:54:20,079 --> 00:54:21,359
thanks awesome

1580
00:54:21,359 --> 00:54:22,720
um

1581
00:54:22,720 --> 00:54:24,160
i was just sitting there thinking as

1582
00:54:24,160 --> 00:54:26,079
like devil's advocate kind of stuff with

1583
00:54:26,079 --> 00:54:27,760
the ransomware

1584
00:54:27,760 --> 00:54:29,920
this is i mean it's all fun and good but

1585
00:54:29,920 --> 00:54:32,079
this is all the stuff that you do while

1586
00:54:32,079 --> 00:54:33,599
waiting for them to actually pay the

1587
00:54:33,599 --> 00:54:35,680
ransom right

1588
00:54:35,680 --> 00:54:37,440
they are going to pay the ransom you

1589
00:54:37,440 --> 00:54:39,040
know i wouldn't say also i wouldn't say

1590
00:54:39,040 --> 00:54:40,960
so uh

1591
00:54:40,960 --> 00:54:44,160
i mean now percentages varies uh because

1592
00:54:44,160 --> 00:54:45,520
obviously people don't like to talk

1593
00:54:45,520 --> 00:54:48,480
about that so much but uh

1594
00:54:48,480 --> 00:54:49,200
the

1595
00:54:49,200 --> 00:54:52,559
the companies we usually help it's very

1596
00:54:52,559 --> 00:54:54,400
i mean i don't have a number of my head

1597
00:54:54,400 --> 00:54:55,520
but

1598
00:54:55,520 --> 00:54:58,319
uh basically almost never or never paid

1599
00:54:58,319 --> 00:55:00,319
ransom

1600
00:55:00,319 --> 00:55:02,400
it's publicly

1601
00:55:02,400 --> 00:55:04,480
i mean we work with them so i can tell

1602
00:55:04,480 --> 00:55:06,559
you

1603
00:55:06,559 --> 00:55:08,640
and it's about how

1604
00:55:08,640 --> 00:55:10,799
now

1605
00:55:10,799 --> 00:55:14,559
it's a it's a hard thing to

1606
00:55:17,040 --> 00:55:19,520
try to find a good way to put it

1607
00:55:19,520 --> 00:55:21,520
obviously it's not nice to pay right

1608
00:55:21,520 --> 00:55:22,960
because you don't want to you don't want

1609
00:55:22,960 --> 00:55:25,119
to put that money into the criminal

1610
00:55:25,119 --> 00:55:26,960
environment right some companies just

1611
00:55:26,960 --> 00:55:28,240
don't have any other way so obviously

1612
00:55:28,240 --> 00:55:29,280
they're definitely going to consider

1613
00:55:29,280 --> 00:55:30,799
that and there are i mean one is the pay

1614
00:55:30,799 --> 00:55:31,920
they are going to get worse and worse

1615
00:55:31,920 --> 00:55:33,760
like you're saying they're going to call

1616
00:55:33,760 --> 00:55:35,520
and threaten you know where you know

1617
00:55:35,520 --> 00:55:37,680
it's where your kids go to school stuff

1618
00:55:37,680 --> 00:55:40,079
like that until you pay

1619
00:55:40,079 --> 00:55:41,680
yeah but i mean if we're talking about

1620
00:55:41,680 --> 00:55:43,760
ransomware purely ransomware right so

1621
00:55:43,760 --> 00:55:45,839
then it's about getting back to

1622
00:55:45,839 --> 00:55:47,760
operations right if the systems are down

1623
00:55:47,760 --> 00:55:49,920
they can't work then if you don't have

1624
00:55:49,920 --> 00:55:52,640
backups that's a much worse place to be

1625
00:55:52,640 --> 00:55:55,040
we have you know we've had several cases

1626
00:55:55,040 --> 00:55:57,200
where the backups were really bad but we

1627
00:55:57,200 --> 00:55:58,480
had just enough for the very very

1628
00:55:58,480 --> 00:56:00,319
critical stuff that we could

1629
00:56:00,319 --> 00:56:03,599
just take the important data uh and then

1630
00:56:03,599 --> 00:56:05,520
the rest you just rebuild

1631
00:56:05,520 --> 00:56:08,319
which is not always feasible of course

1632
00:56:08,319 --> 00:56:10,400
but as much as we can we do that and we

1633
00:56:10,400 --> 00:56:12,480
actually managed to succeed several

1634
00:56:12,480 --> 00:56:14,079
times so it

1635
00:56:14,079 --> 00:56:15,599
and we also put it in perspective when

1636
00:56:15,599 --> 00:56:16,799
we discuss with the customers but

1637
00:56:16,799 --> 00:56:17,920
obviously they're going to ask us should

1638
00:56:17,920 --> 00:56:19,920
we pay should we not pay what's you know

1639
00:56:19,920 --> 00:56:22,319
is it actually going to work if we pay

1640
00:56:22,319 --> 00:56:23,280
and

1641
00:56:23,280 --> 00:56:26,319
it might but it might also not and

1642
00:56:26,319 --> 00:56:28,559
usually the actual key works i mean it's

1643
00:56:28,559 --> 00:56:30,400
not something i would ever guarantee of

1644
00:56:30,400 --> 00:56:33,680
course but technically or statistically

1645
00:56:33,680 --> 00:56:35,359
it works in this case exactly it's good

1646
00:56:35,359 --> 00:56:37,200
for them to know or to let their victims

1647
00:56:37,200 --> 00:56:38,480
know that if they pay because the other

1648
00:56:38,480 --> 00:56:39,599
victim paid and they actually got it

1649
00:56:39,599 --> 00:56:42,640
back so absolutely but would you trust

1650
00:56:42,640 --> 00:56:44,480
using your systems after that you're

1651
00:56:44,480 --> 00:56:45,760
still going to have to do a thorough

1652
00:56:45,760 --> 00:56:47,920
recovery process and actually have to do

1653
00:56:47,920 --> 00:56:50,559
forensics on each recovered system or

1654
00:56:50,559 --> 00:56:52,559
encrypted system and all of that and

1655
00:56:52,559 --> 00:56:54,799
understand me correctly i think that we

1656
00:56:54,799 --> 00:56:56,880
we're heading into a direction where

1657
00:56:56,880 --> 00:56:58,799
i'm worried that the customer that we're

1658
00:56:58,799 --> 00:57:00,240
trying to help

1659
00:57:00,240 --> 00:57:01,760
are not going to be on our side they're

1660
00:57:01,760 --> 00:57:03,599
going to say can you fix it or do we

1661
00:57:03,599 --> 00:57:06,240
have to pay we need to know now

1662
00:57:06,240 --> 00:57:08,799
and that's just going to get worse

1663
00:57:08,799 --> 00:57:10,960
i think the more we bring organizations

1664
00:57:10,960 --> 00:57:13,119
back the more we can show that we can

1665
00:57:13,119 --> 00:57:16,079
help them without pain too yeah and that

1666
00:57:16,079 --> 00:57:18,240
let's see if this mic works and that's

1667
00:57:18,240 --> 00:57:19,920
actually leads to a next question from

1668
00:57:19,920 --> 00:57:22,000
the audience which is like in the case

1669
00:57:22,000 --> 00:57:24,640
of a full domain compromise how long

1670
00:57:24,640 --> 00:57:26,720
does this investigation take and and

1671
00:57:26,720 --> 00:57:28,880
when do you tell the client okay guys

1672
00:57:28,880 --> 00:57:31,520
we're good let's go into production

1673
00:57:31,520 --> 00:57:35,200
uh again it depends there are two main

1674
00:57:35,200 --> 00:57:37,040
uh i guess it depends is the default

1675
00:57:37,040 --> 00:57:39,440
answer for everything security but

1676
00:57:39,440 --> 00:57:41,280
uh if it's ransomware or not run

1677
00:57:41,280 --> 00:57:42,319
somewhere that's the main difference

1678
00:57:42,319 --> 00:57:43,520
because if it's from somewhere you're

1679
00:57:43,520 --> 00:57:46,559
already done okay it's ransomware okay

1680
00:57:46,559 --> 00:57:48,400
it depends if you have backups or not

1681
00:57:48,400 --> 00:57:50,559
that's another important question right

1682
00:57:50,559 --> 00:57:52,079
or at least if you have backups for your

1683
00:57:52,079 --> 00:57:54,799
critical business systems

1684
00:57:54,799 --> 00:57:56,400
then you can start working with those

1685
00:57:56,400 --> 00:57:58,640
and

1686
00:57:59,440 --> 00:58:00,799
there are many components i mean some

1687
00:58:00,799 --> 00:58:03,200
organizations have practical

1688
00:58:03,200 --> 00:58:04,799
issues when you even need to ship

1689
00:58:04,799 --> 00:58:06,799
computers to their to their different

1690
00:58:06,799 --> 00:58:08,400
offices around the world for example you

1691
00:58:08,400 --> 00:58:10,079
have all these issues and those are

1692
00:58:10,079 --> 00:58:11,359
usually the bottlenecks that you don't

1693
00:58:11,359 --> 00:58:13,760
think beforehand even if you have

1694
00:58:13,760 --> 00:58:15,680
thought about it the disaster recovery

1695
00:58:15,680 --> 00:58:17,440
plan and instant response plan there are

1696
00:58:17,440 --> 00:58:19,520
these little things that always take

1697
00:58:19,520 --> 00:58:21,280
longer than you think even if you have

1698
00:58:21,280 --> 00:58:23,599
backups we always ask do we have backups

1699
00:58:23,599 --> 00:58:24,559
yes

1700
00:58:24,559 --> 00:58:25,839
even in the case that they actually have

1701
00:58:25,839 --> 00:58:27,280
it offline

1702
00:58:27,280 --> 00:58:29,359
i hope more and more does

1703
00:58:29,359 --> 00:58:30,799
nowadays but

1704
00:58:30,799 --> 00:58:32,000
if they do that

1705
00:58:32,000 --> 00:58:33,520
we ask them have you tested them and

1706
00:58:33,520 --> 00:58:35,520
they say yes okay so how have you tested

1707
00:58:35,520 --> 00:58:38,799
them well that from the whatever backup

1708
00:58:38,799 --> 00:58:41,839
solution is used the testing is usually

1709
00:58:41,839 --> 00:58:43,680
can you bring back this folder from that

1710
00:58:43,680 --> 00:58:45,760
date yes test passed

1711
00:58:45,760 --> 00:58:47,040
that's not how

1712
00:58:47,040 --> 00:58:48,880
ransomware recovery works ransomware

1713
00:58:48,880 --> 00:58:51,200
recovery you have maybe 100 of servers

1714
00:58:51,200 --> 00:58:53,680
to bring back to a certain date at once

1715
00:58:53,680 --> 00:58:54,640
you're not going to even have the

1716
00:58:54,640 --> 00:58:56,640
hardware for that uh there's going to be

1717
00:58:56,640 --> 00:58:58,160
bottlenecks that you need to take into

1718
00:58:58,160 --> 00:58:59,760
account when you do the actual testing

1719
00:58:59,760 --> 00:59:02,160
so all that stuff comes up when it's

1720
00:59:02,160 --> 00:59:05,359
already too late uh so usually it's

1721
00:59:05,359 --> 00:59:07,359
those type of bottlenecks that

1722
00:59:07,359 --> 00:59:09,119
take it can take it all the way to two

1723
00:59:09,119 --> 00:59:11,599
three even four weeks in worse cases

1724
00:59:11,599 --> 00:59:12,880
when we're lucky and everything works

1725
00:59:12,880 --> 00:59:16,880
smooth it can be a few days only

1726
00:59:16,960 --> 00:59:19,280
that answer the question

1727
00:59:19,280 --> 00:59:20,720
i forgot the question i just went on a

1728
00:59:20,720 --> 00:59:22,079
road yeah

1729
00:59:22,079 --> 00:59:23,680
that was the question how how long does

1730
00:59:23,680 --> 00:59:25,599
it normally take to recover after a run

1731
00:59:25,599 --> 00:59:27,200
i guess i answered that yeah so yeah

1732
00:59:27,200 --> 00:59:28,400
okay cool

1733
00:59:28,400 --> 00:59:30,160
um and the other

1734
00:59:30,160 --> 00:59:31,760
question that i got from the audience is

1735
00:59:31,760 --> 00:59:32,480
like

1736
00:59:32,480 --> 00:59:34,880
after fishing what is the second most

1737
00:59:34,880 --> 00:59:37,599
common uh infection way for ransomware

1738
00:59:37,599 --> 00:59:39,760
uh external vulnerability exploitation

1739
00:59:39,760 --> 00:59:41,359
known exploits unpatched stuff on the

1740
00:59:41,359 --> 00:59:42,799
internet

1741
00:59:42,799 --> 00:59:44,319
definitely

1742
00:59:44,319 --> 00:59:47,200
patch your vpns and everything else too

1743
00:59:47,200 --> 00:59:49,200
but especially yeah if you put stuff on

1744
00:59:49,200 --> 00:59:50,559
the internet somebody's going to own it

1745
00:59:50,559 --> 00:59:53,520
for you if you don't own it yourself

1746
00:59:53,520 --> 00:59:56,640
yeah i guess yeah sure so

1747
00:59:56,640 --> 00:59:58,799
on first example

1748
00:59:58,799 --> 01:00:00,720
you have shared a snippet of that

1749
01:00:00,720 --> 01:00:01,839
malware right

1750
01:00:01,839 --> 01:00:04,799
it is using curl it is downloading using

1751
01:00:04,799 --> 01:00:07,359
curl but curly is not a binary of

1752
01:00:07,359 --> 01:00:09,200
windows operating system yeah in modder

1753
01:00:09,200 --> 01:00:11,359
the question is the macro was using curl

1754
01:00:11,359 --> 01:00:12,640
but it's not a binary windows in the

1755
01:00:12,640 --> 01:00:14,799
modern version it is you can call it by

1756
01:00:14,799 --> 01:00:16,480
default yes it works

1757
01:00:16,480 --> 01:00:18,559
was it uh

1758
01:00:18,559 --> 01:00:20,799
internal job because i see i have seen

1759
01:00:20,799 --> 01:00:23,520
in the directory there is ssh directory

1760
01:00:23,520 --> 01:00:25,440
in windows folder right

1761
01:00:25,440 --> 01:00:26,319
so

1762
01:00:26,319 --> 01:00:28,640
oh the

1763
01:00:29,520 --> 01:00:31,119
you're asking about the ssh directory in

1764
01:00:31,119 --> 01:00:32,720
that snapper for windows explorer that

1765
01:00:32,720 --> 01:00:35,040
is unrelated to that case that was just

1766
01:00:35,040 --> 01:00:36,960
some folder to show what is windows

1767
01:00:36,960 --> 01:00:38,559
explorer so we know we're talking about

1768
01:00:38,559 --> 01:00:40,640
it is not related to that attack

1769
01:00:40,640 --> 01:00:43,040
after my knowledge goes name silos give

1770
01:00:43,040 --> 01:00:44,799
who is privacy for free

1771
01:00:44,799 --> 01:00:47,280
yeah who would they prefer to buy from

1772
01:00:47,280 --> 01:00:49,760
like silo you get you get privacy guard

1773
01:00:49,760 --> 01:00:50,480
yeah

1774
01:00:50,480 --> 01:00:52,079
for free so it is

1775
01:00:52,079 --> 01:00:54,640
cheaper than any other

1776
01:00:54,640 --> 01:00:57,040
domain name provider yeah

1777
01:00:57,040 --> 01:00:59,359
so so if you connect domain silo with

1778
01:00:59,359 --> 01:01:03,119
digital ocean together shady stuff

1779
01:01:03,119 --> 01:01:05,359
yeah

1780
01:01:05,599 --> 01:01:06,799
pretty cool

1781
01:01:06,799 --> 01:01:08,480
um and then we had some questions

1782
01:01:08,480 --> 01:01:12,480
regarding the these rdp graph logs have

1783
01:01:12,480 --> 01:01:14,319
you guys been in contact with microsoft

1784
01:01:14,319 --> 01:01:16,960
or asking them to actually

1785
01:01:16,960 --> 01:01:19,280
maybe just publicly release how the hell

1786
01:01:19,280 --> 01:01:21,440
they stitch this together that is a good

1787
01:01:21,440 --> 01:01:24,079
point we haven't done that

1788
01:01:24,079 --> 01:01:25,359
worth a shot

1789
01:01:25,359 --> 01:01:27,520
because yeah that could help a lot using

1790
01:01:27,520 --> 01:01:29,760
it for for forensics sure sure and then

1791
01:01:29,760 --> 01:01:31,119
people love to reverse stuff anyway so

1792
01:01:31,119 --> 01:01:32,960
maybe some we have fun anyways but uh

1793
01:01:32,960 --> 01:01:35,359
definitely worth the show

1794
01:01:35,359 --> 01:01:38,319
i have one more of it's actually wrong

1795
01:01:38,319 --> 01:01:39,920
i have one more that's actually relevant

1796
01:01:39,920 --> 01:01:42,000
to that which is the idea of you you

1797
01:01:42,000 --> 01:01:44,880
guys split off and said okay we saw this

1798
01:01:44,880 --> 01:01:46,480
in the edr

1799
01:01:46,480 --> 01:01:48,799
uh that the client had but uh but this

1800
01:01:48,799 --> 01:01:50,480
is where we went off the track so i

1801
01:01:50,480 --> 01:01:52,480
realized that but the question is of all

1802
01:01:52,480 --> 01:01:54,160
the stuff that you had in terms of the

1803
01:01:54,160 --> 01:01:55,760
rest of what you were mentioning would

1804
01:01:55,760 --> 01:01:58,400
you have caught that in most edrs

1805
01:01:58,400 --> 01:02:00,640
or in some of the really good edrs

1806
01:02:00,640 --> 01:02:02,480
uh i would say

1807
01:02:02,480 --> 01:02:06,559
yes that we would have caught it um

1808
01:02:06,559 --> 01:02:09,119
now edrs you know

1809
01:02:09,119 --> 01:02:10,880
if we were to recommend something as a

1810
01:02:10,880 --> 01:02:13,359
type of product i i

1811
01:02:13,359 --> 01:02:15,200
usually start with edr because you can

1812
01:02:15,200 --> 01:02:16,720
do a lot of stuff you can have next-gen

1813
01:02:16,720 --> 01:02:19,280
firewalls you can have ndrs you can have

1814
01:02:19,280 --> 01:02:21,359
whatever uh i think if you start looking

1815
01:02:21,359 --> 01:02:23,119
into the endpoints and by endpoints i

1816
01:02:23,119 --> 01:02:24,400
mean clients and systems that's

1817
01:02:24,400 --> 01:02:25,520
eventually where stuff is going to

1818
01:02:25,520 --> 01:02:28,079
happen right so i i love starting with

1819
01:02:28,079 --> 01:02:29,680
an edr even if you have really crappy

1820
01:02:29,680 --> 01:02:31,200
security there's so many things you need

1821
01:02:31,200 --> 01:02:33,520
to do at least start having your eyes on

1822
01:02:33,520 --> 01:02:36,160
things it's a quick and very valuable

1823
01:02:36,160 --> 01:02:38,319
thing to do so that being said it also

1824
01:02:38,319 --> 01:02:40,480
depends how you use it right and you

1825
01:02:40,480 --> 01:02:42,319
know there are many edr's

1826
01:02:42,319 --> 01:02:43,920
some are better than others i think in

1827
01:02:43,920 --> 01:02:48,440
general it's they're great tools

1828
01:02:51,200 --> 01:02:55,439
uh the time sum on the registry uh

1829
01:02:55,520 --> 01:02:57,200
well i guess it depends how you do it

1830
01:02:57,200 --> 01:02:59,039
really i think the actual action of the

1831
01:02:59,039 --> 01:03:02,640
registry key edit or modified key event

1832
01:03:02,640 --> 01:03:03,520
uh

1833
01:03:03,520 --> 01:03:05,039
i think most edrs actually look at the

1834
01:03:05,039 --> 01:03:07,760
registry in that way

1835
01:03:07,760 --> 01:03:08,960
and then it also depends how you do it

1836
01:03:08,960 --> 01:03:10,640
right because if you do it with

1837
01:03:10,640 --> 01:03:12,160
powershell.c

1838
01:03:12,160 --> 01:03:13,680
registry load whatever you call the

1839
01:03:13,680 --> 01:03:16,319
function then that may be what's gonna

1840
01:03:16,319 --> 01:03:18,160
trigger an alert and then you look into

1841
01:03:18,160 --> 01:03:20,000
it and realize what it did

1842
01:03:20,000 --> 01:03:22,880
but that's kind of maybe you won't catch

1843
01:03:22,880 --> 01:03:24,720
that particular thing

1844
01:03:24,720 --> 01:03:26,079
but if you have your eyes on everything

1845
01:03:26,079 --> 01:03:27,599
that happens

1846
01:03:27,599 --> 01:03:29,359
eventually they're gonna step on a mine

1847
01:03:29,359 --> 01:03:31,680
and raise an alert right

1848
01:03:31,680 --> 01:03:33,119
i mean in most cases you can never be

1849
01:03:33,119 --> 01:03:35,359
100 sure but

1850
01:03:35,359 --> 01:03:37,680
i think that's a great start

1851
01:03:37,680 --> 01:03:38,960
and it's also important to understand

1852
01:03:38,960 --> 01:03:41,119
that not all these cases they are not

1853
01:03:41,119 --> 01:03:43,200
all connected and they are definitely

1854
01:03:43,200 --> 01:03:45,520
not all ransomware cases like

1855
01:03:45,520 --> 01:03:47,039
like we talked about before how long

1856
01:03:47,039 --> 01:03:47,760
time

1857
01:03:47,760 --> 01:03:50,240
how long does it take to detect well we

1858
01:03:50,240 --> 01:03:52,799
have incidents where they have a system

1859
01:03:52,799 --> 01:03:54,319
that actually monitors all the stuff but

1860
01:03:54,319 --> 01:03:56,000
if you're not looking at those logs and

1861
01:03:56,000 --> 01:03:57,760
know what you're doing then you're gonna

1862
01:03:57,760 --> 01:04:01,599
have a problem anyway so that's gonna be

1863
01:04:01,599 --> 01:04:03,680
always a risk factor you need to train

1864
01:04:03,680 --> 01:04:05,440
your sock people you need everybody

1865
01:04:05,440 --> 01:04:06,880
needs to know what's goes on you need to

1866
01:04:06,880 --> 01:04:08,640
be updated and

1867
01:04:08,640 --> 01:04:10,000
that's that's kind of how it works which

1868
01:04:10,000 --> 01:04:12,640
is easy to say but yeah practice can be

1869
01:04:12,640 --> 01:04:14,000
very hard right because there are so

1870
01:04:14,000 --> 01:04:15,599
many things you can possibly react to so

1871
01:04:15,599 --> 01:04:17,760
you need to choose and that's where you

1872
01:04:17,760 --> 01:04:19,440
can kind of integrate threat intel into

1873
01:04:19,440 --> 01:04:20,640
it right if you

1874
01:04:20,640 --> 01:04:22,480
try and think like okay we could

1875
01:04:22,480 --> 01:04:23,920
potentially look at

1876
01:04:23,920 --> 01:04:25,280
a million different things what do we

1877
01:04:25,280 --> 01:04:26,799
start with we'll start with the things

1878
01:04:26,799 --> 01:04:28,319
that are actually exploited in the wild

1879
01:04:28,319 --> 01:04:29,440
now

1880
01:04:29,440 --> 01:04:31,200
right isn't i think that's the best

1881
01:04:31,200 --> 01:04:32,559
place to start

1882
01:04:32,559 --> 01:04:33,839
if you can choose whatever choose the

1883
01:04:33,839 --> 01:04:35,200
ones that are actually a problem right

1884
01:04:35,200 --> 01:04:37,039
now there are a lot of others that we

1885
01:04:37,039 --> 01:04:39,520
don't know about right the stealthy ones

1886
01:04:39,520 --> 01:04:42,000
the nation-state stuff and whatever

1887
01:04:42,000 --> 01:04:42,720
and

1888
01:04:42,720 --> 01:04:45,119
it's probably you know

1889
01:04:45,119 --> 01:04:46,720
let's consider the ones we know and work

1890
01:04:46,720 --> 01:04:47,839
with those

1891
01:04:47,839 --> 01:04:49,280
it's a good start i think we need to be

1892
01:04:49,280 --> 01:04:50,559
pragmatic at least i like to be

1893
01:04:50,559 --> 01:04:52,319
chromatic

1894
01:04:52,319 --> 01:04:54,480
cool then and that actually leads to the

1895
01:04:54,480 --> 01:04:56,000
the last question from the audience

1896
01:04:56,000 --> 01:04:57,680
which comes to attribution again

1897
01:04:57,680 --> 01:04:59,359
attribution is always hard and you

1898
01:04:59,359 --> 01:05:02,160
attributed this to to chinese nation

1899
01:05:02,160 --> 01:05:04,160
state or chinese ransomware gang but

1900
01:05:04,160 --> 01:05:06,720
what would the motivation be for for the

1901
01:05:06,720 --> 01:05:09,680
chinese to run run somewhere if it is

1902
01:05:09,680 --> 01:05:12,079
nation state uh those are not the same

1903
01:05:12,079 --> 01:05:13,839
case the case we were talking about the

1904
01:05:13,839 --> 01:05:16,319
nation state was not a ransomware case

1905
01:05:16,319 --> 01:05:17,920
that makes sense because that i think

1906
01:05:17,920 --> 01:05:21,599
that i agree that would be unusual

1907
01:05:21,599 --> 01:05:23,359
well you can look at north korea i guess

1908
01:05:23,359 --> 01:05:25,440
but that's a bit of an exception

1909
01:05:25,440 --> 01:05:27,280
or some covert action where they're

1910
01:05:27,280 --> 01:05:29,039
trying to pose

1911
01:05:29,039 --> 01:05:31,599
as ransomware gangs while the stephen

1912
01:05:31,599 --> 01:05:34,559
stealing information yeah no exactly but

1913
01:05:34,559 --> 01:05:36,559
you don't actually you don't usually

1914
01:05:36,559 --> 01:05:38,559
have the motivation or the actual intent

1915
01:05:38,559 --> 01:05:40,720
to do a ransomware yeah for nation state

1916
01:05:40,720 --> 01:05:42,240
yeah you can have this there's no

1917
01:05:42,240 --> 01:05:44,799
payment service i mean there are uh uh

1918
01:05:44,799 --> 01:05:46,240
russian nation state actors who do

1919
01:05:46,240 --> 01:05:48,079
destructive operations right that

1920
01:05:48,079 --> 01:05:49,359
actually use ransomware that is not

1921
01:05:49,359 --> 01:05:51,760
really ransomware is wiper

1922
01:05:51,760 --> 01:05:53,839
malware

1923
01:05:53,839 --> 01:05:55,599
but that's destructive purpose it's not

1924
01:05:55,599 --> 01:05:58,079
ransomware

1925
01:05:59,119 --> 01:06:00,000
um

1926
01:06:00,000 --> 01:06:02,480
yeah and then that leads to to

1927
01:06:02,480 --> 01:06:04,559
do you see how roughly is there a

1928
01:06:04,559 --> 01:06:06,240
percentage how many of these serious

1929
01:06:06,240 --> 01:06:08,079
attacks are ransomware is that a

1930
01:06:08,079 --> 01:06:10,079
majority or are you seeing more nation

1931
01:06:10,079 --> 01:06:12,559
state ransomware or like just rogue

1932
01:06:12,559 --> 01:06:14,960
hackers in general in incident response

1933
01:06:14,960 --> 01:06:17,200
yeah in general the cyber crime side of

1934
01:06:17,200 --> 01:06:20,480
things is definitely a lot bigger than

1935
01:06:20,480 --> 01:06:22,240
nation state nation state is also like

1936
01:06:22,240 --> 01:06:24,799
you said hard to attribute uh so a lot

1937
01:06:24,799 --> 01:06:28,000
of things goes in the uncategorized

1938
01:06:28,000 --> 01:06:30,319
side of things uh

1939
01:06:30,319 --> 01:06:31,680
but definitely a lot of ransomware

1940
01:06:31,680 --> 01:06:33,200
that's definitely a big one i think our

1941
01:06:33,200 --> 01:06:35,039
own statistics from last year and half

1942
01:06:35,039 --> 01:06:38,000
of this year uh is about half of all the

1943
01:06:38,000 --> 01:06:40,000
incidents we've handled have ransomware

1944
01:06:40,000 --> 01:06:41,760
and they're usually coupled with the

1945
01:06:41,760 --> 01:06:44,240
data leak as well so uh i guess they

1946
01:06:44,240 --> 01:06:46,000
call it leakware these days but you know

1947
01:06:46,000 --> 01:06:48,640
you steal data uh and you do ransomware

1948
01:06:48,640 --> 01:06:49,839
at the same time and then you threaten

1949
01:06:49,839 --> 01:06:50,640
to

1950
01:06:50,640 --> 01:06:52,079
to release the data if they don't pay

1951
01:06:52,079 --> 01:06:55,680
for the key so it's additional pressure

1952
01:06:56,400 --> 01:06:58,319
you had a question too

1953
01:06:58,319 --> 01:07:00,799
have either ever seen nation states use

1954
01:07:00,799 --> 01:07:02,240
ransomware to cover their tracks or

1955
01:07:02,240 --> 01:07:04,240
encourage attribution

1956
01:07:04,240 --> 01:07:05,760
the question is if you've seen a nation

1957
01:07:05,760 --> 01:07:07,280
state using ransomware to cover the

1958
01:07:07,280 --> 01:07:09,680
tracks

1959
01:07:10,160 --> 01:07:12,240
well specifically around somewhere i

1960
01:07:12,240 --> 01:07:13,680
don't know

1961
01:07:13,680 --> 01:07:15,359
i mean

1962
01:07:15,359 --> 01:07:17,759
uh

1963
01:07:18,319 --> 01:07:19,520
trying to put stuff there that looks

1964
01:07:19,520 --> 01:07:22,319
like someone else it's definitely uh

1965
01:07:22,319 --> 01:07:25,039
it's definitely something not uncommon

1966
01:07:25,039 --> 01:07:26,240
uh i can't think of a specific

1967
01:07:26,240 --> 01:07:28,880
ransomware case to be honest right now

1968
01:07:28,880 --> 01:07:31,599
it might be and i just can't think of it

1969
01:07:31,599 --> 01:07:33,839
sorry

1970
01:07:34,160 --> 01:07:37,520
okay uh final question from the audience

1971
01:07:37,520 --> 01:07:39,920
what's your recommended platforms for

1972
01:07:39,920 --> 01:07:42,079
for sharing threat intelligence and how

1973
01:07:42,079 --> 01:07:43,599
can you convince your organization to

1974
01:07:43,599 --> 01:07:45,680
actually share threat intelligence with

1975
01:07:45,680 --> 01:07:48,000
others

1976
01:07:48,480 --> 01:07:50,720
i think platforms uh there are a lot of

1977
01:07:50,720 --> 01:07:53,359
platforms it's just important to

1978
01:07:53,359 --> 01:07:54,880
use the standards

1979
01:07:54,880 --> 01:07:58,400
so uh you know sticks is great standard

1980
01:07:58,400 --> 01:08:01,359
uh mitra does definitions as well so if

1981
01:08:01,359 --> 01:08:02,880
we talk the same language it's a lot

1982
01:08:02,880 --> 01:08:04,480
easier to use information in a

1983
01:08:04,480 --> 01:08:07,359
meaningful way so use the big standards

1984
01:08:07,359 --> 01:08:09,039
uh it's i guess step number one then

1985
01:08:09,039 --> 01:08:11,280
which platform i guess it doesn't really

1986
01:08:11,280 --> 01:08:12,640
matter in the end

1987
01:08:12,640 --> 01:08:14,960
uh as to convince the organization to

1988
01:08:14,960 --> 01:08:15,920
share

1989
01:08:15,920 --> 01:08:17,279
that's a hard one it depends on the

1990
01:08:17,279 --> 01:08:19,439
organization right and also depends what

1991
01:08:19,439 --> 01:08:21,839
you share

1992
01:08:22,080 --> 01:08:24,000
and how you share it i mean you can take

1993
01:08:24,000 --> 01:08:26,158
you can take an email you got and share

1994
01:08:26,158 --> 01:08:27,920
that which will probably contain your

1995
01:08:27,920 --> 01:08:29,759
own organization information or you can

1996
01:08:29,759 --> 01:08:32,238
have an internal process to to wash that

1997
01:08:32,238 --> 01:08:34,479
and then only provide the iocs because

1998
01:08:34,479 --> 01:08:36,080
that's not your information but that

1999
01:08:36,080 --> 01:08:38,000
takes that is more expensive internally

2000
01:08:38,000 --> 01:08:40,158
to do right so if you can't do that

2001
01:08:40,158 --> 01:08:41,520
that's ideal

2002
01:08:41,520 --> 01:08:42,880
but then you need to have resources for

2003
01:08:42,880 --> 01:08:45,120
that

2004
01:08:45,839 --> 01:08:47,920
okay thank you very much thank you very

2005
01:08:47,920 --> 01:08:50,200
much

2006
01:08:50,200 --> 01:08:55,870
[Applause]

2007
01:08:57,198 --> 01:08:59,278
you

