1
00:00:04,040 --> 00:00:06,540
thank you very much thanks for being

2
00:00:06,540 --> 00:00:08,519
here that early in the morning and that

3
00:00:08,519 --> 00:00:11,219
after a really nice party yesterday I

4
00:00:11,219 --> 00:00:13,500
just checked out the location it really

5
00:00:13,500 --> 00:00:16,199
looked really very good

6
00:00:16,199 --> 00:00:18,359
so just to wake you up I know you're

7
00:00:18,359 --> 00:00:20,760
here physically but maybe not mentally

8
00:00:20,760 --> 00:00:23,160
so much and that's why I decided to

9
00:00:23,160 --> 00:00:26,160
start out with a video right

10
00:00:26,160 --> 00:00:28,939
are you ready

11
00:00:31,859 --> 00:00:35,660
ah from

12
00:00:37,300 --> 00:00:40,370
[Applause]

13
00:00:44,480 --> 00:00:53,619
[Music]

14
00:00:56,330 --> 00:01:08,979
[Music]

15
00:01:12,960 --> 00:01:15,860
foreign

16
00:01:21,280 --> 00:01:30,110
[Music]

17
00:01:30,110 --> 00:01:33,189
[Applause]

18
00:01:33,940 --> 00:01:40,060
[Music]

19
00:01:42,390 --> 00:01:47,820
[Music]

20
00:01:47,820 --> 00:01:49,980
foreign

21
00:01:49,980 --> 00:01:53,140
[Applause]

22
00:01:53,140 --> 00:02:20,959
[Music]

23
00:02:20,959 --> 00:02:23,959
thank you

24
00:02:24,630 --> 00:02:53,500
[Music]

25
00:02:53,500 --> 00:02:57,860
[Applause]

26
00:02:57,860 --> 00:03:01,019
so what you just saw was a successful

27
00:03:01,019 --> 00:03:04,739
relay attack on the Tesla Model 3 and I

28
00:03:04,739 --> 00:03:06,599
hope it's not disappointing to you when

29
00:03:06,599 --> 00:03:08,940
I tell you that this was a staged video

30
00:03:08,940 --> 00:03:15,000
we didn't really so I that's being said

31
00:03:15,000 --> 00:03:17,519
there is this video you can find it on

32
00:03:17,519 --> 00:03:19,260
YouTube and I

33
00:03:19,260 --> 00:03:21,659
would appreciate if you like gave it a

34
00:03:21,659 --> 00:03:23,340
few views because the people that were

35
00:03:23,340 --> 00:03:25,560
helping me there were a little bit

36
00:03:25,560 --> 00:03:28,140
disappointed that this video where a lot

37
00:03:28,140 --> 00:03:31,560
of effort went in just the second rank

38
00:03:31,560 --> 00:03:35,580
of the videos I have in this uh talk

39
00:03:35,580 --> 00:03:39,300
so what to expect today it's about a lot

40
00:03:39,300 --> 00:03:41,220
of things it's why you shouldn't use

41
00:03:41,220 --> 00:03:43,440
your phone in order to unlock your car

42
00:03:43,440 --> 00:03:45,959
why you shouldn't use the NFC card of

43
00:03:45,959 --> 00:03:49,260
your tester how to track Teslas how to

44
00:03:49,260 --> 00:03:51,260
talk to Teslas how to

45
00:03:51,260 --> 00:03:54,299
resolve the the vehicle identification

46
00:03:54,299 --> 00:03:56,940
number of testers how to talk to testers

47
00:03:56,940 --> 00:03:59,959
how to emulate a tester and how to

48
00:03:59,959 --> 00:04:02,879
profile a Tesla so there's a lot of

49
00:04:02,879 --> 00:04:03,959
Tesla

50
00:04:03,959 --> 00:04:06,799
and first things first about

51
00:04:06,799 --> 00:04:08,780
trafficunite.org who has heard of

52
00:04:08,780 --> 00:04:12,000
trifonite.org by now

53
00:04:12,000 --> 00:04:15,120
all right so I guess it's a lot of young

54
00:04:15,120 --> 00:04:16,978
people here

55
00:04:16,978 --> 00:04:20,820
um in 2004 we founded that group and our

56
00:04:20,820 --> 00:04:23,580
primary we primarily focused on

57
00:04:23,580 --> 00:04:26,580
Bluetooth security research back then

58
00:04:26,580 --> 00:04:29,759
classic Bluetooth classic back then and

59
00:04:29,759 --> 00:04:32,040
we were participating in a lot of events

60
00:04:32,040 --> 00:04:34,380
that also the Bluetooth sick was

61
00:04:34,380 --> 00:04:37,320
organizing in order to help vendors to

62
00:04:37,320 --> 00:04:39,960
fix like Bluetooth bugs security

63
00:04:39,960 --> 00:04:42,780
Bluetooth bugs in their project or

64
00:04:42,780 --> 00:04:45,180
products back then so this was the time

65
00:04:45,180 --> 00:04:48,419
of Nokia feature phones and Sony

66
00:04:48,419 --> 00:04:52,280
Ericsson feature phones and so on

67
00:04:52,560 --> 00:04:55,259
I'm myself I'm living in Salzburg which

68
00:04:55,259 --> 00:04:58,139
is very close to Munich which is Munchen

69
00:04:58,139 --> 00:05:00,660
right like this place so this is not new

70
00:05:00,660 --> 00:05:02,639
to me here

71
00:05:02,639 --> 00:05:05,160
um I'm a regular participant at the

72
00:05:05,160 --> 00:05:07,740
German CCC and also spoke a few times

73
00:05:07,740 --> 00:05:11,400
there and of course I own a Tesla Model

74
00:05:11,400 --> 00:05:14,340
3 in order to do all that research it

75
00:05:14,340 --> 00:05:16,259
was necessary to have it available all

76
00:05:16,259 --> 00:05:18,620
the time

77
00:05:21,180 --> 00:05:23,400
so project Tampa is all about

78
00:05:23,400 --> 00:05:25,740
investigating the Bluetooth low energy

79
00:05:25,740 --> 00:05:28,919
interface of Teslas

80
00:05:28,919 --> 00:05:31,460
and

81
00:05:31,460 --> 00:05:34,320
as you might not know so that's why I'm

82
00:05:34,320 --> 00:05:36,660
explaining that a little bit

83
00:05:36,660 --> 00:05:40,320
um this Bluetooth interface which is

84
00:05:40,320 --> 00:05:43,020
solely used for unlocking car the car

85
00:05:43,020 --> 00:05:44,820
and controlling the security functions

86
00:05:44,820 --> 00:05:47,940
of the car has nothing to do with the

87
00:05:47,940 --> 00:05:50,280
Bluetooth infotainment system that is

88
00:05:50,280 --> 00:05:52,620
used in order to stream music so this is

89
00:05:52,620 --> 00:05:54,600
a Bluetooth low energy interface and

90
00:05:54,600 --> 00:05:57,900
it's found on about 2 million Tesla

91
00:05:57,900 --> 00:06:01,020
vehicles to date and you can do a lot of

92
00:06:01,020 --> 00:06:03,660
things with this interface and some of

93
00:06:03,660 --> 00:06:08,000
them might not be intended by Tesla

94
00:06:08,180 --> 00:06:10,320
some of the things I'm going to talk

95
00:06:10,320 --> 00:06:12,479
about today have been partially been

96
00:06:12,479 --> 00:06:16,380
fixed by Tesla and some some were kind

97
00:06:16,380 --> 00:06:19,800
of mitigated but not really heartfelt so

98
00:06:19,800 --> 00:06:22,380
there's still some opportunity for

99
00:06:22,380 --> 00:06:24,479
criminals

100
00:06:24,479 --> 00:06:26,580
most of the findings I'm going to

101
00:06:26,580 --> 00:06:28,740
present are reverse engineered from the

102
00:06:28,740 --> 00:06:30,960
official Tesla app that you can find in

103
00:06:30,960 --> 00:06:34,560
the Play Store so in the Android version

104
00:06:34,560 --> 00:06:37,319
and this research overall started in

105
00:06:37,319 --> 00:06:41,940
June 2019 but it I intensified when I

106
00:06:41,940 --> 00:06:43,860
found out about that relay attack and

107
00:06:43,860 --> 00:06:46,560
was able to read the messages passed on

108
00:06:46,560 --> 00:06:50,340
between the car and the phone so which

109
00:06:50,340 --> 00:06:52,800
is called VC Sac that's the name of the

110
00:06:52,800 --> 00:06:55,500
protocol and that's when the research I

111
00:06:55,500 --> 00:06:58,259
intensified and I found a few more

112
00:06:58,259 --> 00:07:00,560
things

113
00:07:01,740 --> 00:07:04,199
so the phone key is Tesla's very

114
00:07:04,199 --> 00:07:07,139
Innovative way of saying that the owners

115
00:07:07,139 --> 00:07:09,300
do not need to have any other device

116
00:07:09,300 --> 00:07:12,300
besides their smartphone in order to use

117
00:07:12,300 --> 00:07:15,000
the car it's been introduced with the

118
00:07:15,000 --> 00:07:16,819
model 3 in 2018

119
00:07:16,819 --> 00:07:21,539
and as said the phone is the key fob

120
00:07:21,539 --> 00:07:23,880
and it's now also used in the model Y

121
00:07:23,880 --> 00:07:27,840
and also in the model snx from 2021 plus

122
00:07:27,840 --> 00:07:29,880
so there's been a new version of that

123
00:07:29,880 --> 00:07:33,479
vehicle that has that is sold for like

124
00:07:33,479 --> 00:07:35,940
four weeks in Europe by now so you won't

125
00:07:35,940 --> 00:07:38,759
see a lot of Model S and model X with

126
00:07:38,759 --> 00:07:42,840
this feature for now but there are more

127
00:07:42,840 --> 00:07:46,039
to come also in Europe

128
00:07:46,139 --> 00:07:49,800
and also I believe that this phone as a

129
00:07:49,800 --> 00:07:52,340
key feature will find its way to the

130
00:07:52,340 --> 00:07:55,319
Roadster which when it ever gets

131
00:07:55,319 --> 00:07:57,780
produced will also have that since it

132
00:07:57,780 --> 00:07:59,759
doesn't have door handles it's going to

133
00:07:59,759 --> 00:08:00,900
be a

134
00:08:00,900 --> 00:08:03,000
difficult thing

135
00:08:03,000 --> 00:08:05,819
so in general there's three ways to

136
00:08:05,819 --> 00:08:09,060
unlock a Tesla the one is as just said

137
00:08:09,060 --> 00:08:11,819
the phone key the other one would be the

138
00:08:11,819 --> 00:08:15,000
NFC key card that every owner gets with

139
00:08:15,000 --> 00:08:16,979
the car

140
00:08:16,979 --> 00:08:19,159
foreign

141
00:08:19,919 --> 00:08:23,280
and the third method is a key fob it's

142
00:08:23,280 --> 00:08:27,780
sold separately it costs 160 euros and

143
00:08:27,780 --> 00:08:30,599
uh pretty much does what the phone does

144
00:08:30,599 --> 00:08:33,599
so it's enabling passive entry and you

145
00:08:33,599 --> 00:08:36,000
can also like proactively unlock the car

146
00:08:36,000 --> 00:08:38,899
and control the car

147
00:08:40,979 --> 00:08:43,679
so as said the NFC card comes with the

148
00:08:43,679 --> 00:08:46,020
vehicle you just tap it on the b-pillar

149
00:08:46,020 --> 00:08:47,880
or on the middle console in order to

150
00:08:47,880 --> 00:08:49,920
authorize your action whether you want

151
00:08:49,920 --> 00:08:52,260
to unlock the car or whether you want to

152
00:08:52,260 --> 00:08:55,080
start the car in order to drive it

153
00:08:55,080 --> 00:08:58,019
in this car a key card does not allow

154
00:08:58,019 --> 00:09:00,240
passive entry and by passive entry I

155
00:09:00,240 --> 00:09:02,580
mean that whenever you are in proximity

156
00:09:02,580 --> 00:09:04,560
of that vehicle the vehicle will

157
00:09:04,560 --> 00:09:06,600
recognize your device and unlock the car

158
00:09:06,600 --> 00:09:09,240
for you so there's no interaction needed

159
00:09:09,240 --> 00:09:12,660
for you as as the driver

160
00:09:12,660 --> 00:09:14,880
and this is not working for the NFC key

161
00:09:14,880 --> 00:09:16,800
card

162
00:09:16,800 --> 00:09:19,440
the phone key does allow that there's an

163
00:09:19,440 --> 00:09:22,620
official app for iOS and for Android and

164
00:09:22,620 --> 00:09:25,320
also the Android version does do NFC

165
00:09:25,320 --> 00:09:29,279
card emulation so you can emulate the

166
00:09:29,279 --> 00:09:31,200
NFC key card

167
00:09:31,200 --> 00:09:33,899
with the phone as well

168
00:09:33,899 --> 00:09:36,060
and this solution does allow passive

169
00:09:36,060 --> 00:09:39,720
entry and also basic allows you to

170
00:09:39,720 --> 00:09:43,760
control basic security functions

171
00:09:46,019 --> 00:09:48,240
and then there's this key fob Assad is

172
00:09:48,240 --> 00:09:50,339
not cheap and it's based on Bluetooth

173
00:09:50,339 --> 00:09:52,680
energy as well it behaves a little bit

174
00:09:52,680 --> 00:09:55,860
different compared to the phone but

175
00:09:55,860 --> 00:09:59,040
um it's also carried by the owner as a

176
00:09:59,040 --> 00:10:01,800
typical key fob and you can use it for

177
00:10:01,800 --> 00:10:03,839
authorization by tap on the B pillar as

178
00:10:03,839 --> 00:10:06,540
well since it's also emulating or also

179
00:10:06,540 --> 00:10:09,360
has a portion that is able to do the NFC

180
00:10:09,360 --> 00:10:12,120
protocol

181
00:10:12,120 --> 00:10:16,200
all right so when I asked on Twitter how

182
00:10:16,200 --> 00:10:18,480
the people or the owners of model 3 and

183
00:10:18,480 --> 00:10:21,120
why unlock their car this was the result

184
00:10:21,120 --> 00:10:25,740
so 83.7 percent of them given that very

185
00:10:25,740 --> 00:10:28,500
small sample of of people

186
00:10:28,500 --> 00:10:31,500
taking part in that poll use their phone

187
00:10:31,500 --> 00:10:34,140
in order to unlock the car so that was

188
00:10:34,140 --> 00:10:37,380
good news at the time since I was on to

189
00:10:37,380 --> 00:10:40,320
something in the direction of relaying

190
00:10:40,320 --> 00:10:43,580
that signal

191
00:10:44,040 --> 00:10:47,420
so in general the phone key

192
00:10:47,420 --> 00:10:50,640
the smartphone app finds the vehicle it

193
00:10:50,640 --> 00:10:53,040
identifies the vehicle checks if it's

194
00:10:53,040 --> 00:10:55,620
the right one to talk to connects to the

195
00:10:55,620 --> 00:10:57,899
vehicle and then communicates with the

196
00:10:57,899 --> 00:11:00,899
car and so the car unlock starts opens

197
00:11:00,899 --> 00:11:02,940
Etc

198
00:11:02,940 --> 00:11:05,160
this is done via a generic attributes

199
00:11:05,160 --> 00:11:07,980
protocol that's very common if you look

200
00:11:07,980 --> 00:11:12,500
into ble things so usually this

201
00:11:12,500 --> 00:11:17,820
gut attribute profile is communicating a

202
00:11:17,820 --> 00:11:20,519
name and so-called characteristics that

203
00:11:20,519 --> 00:11:23,820
you can write to like in the two vehicle

204
00:11:23,820 --> 00:11:26,459
case and characteristics in order to

205
00:11:26,459 --> 00:11:28,920
receive messages from the car in this

206
00:11:28,920 --> 00:11:31,160
case it's the from vehicle

207
00:11:31,160 --> 00:11:34,620
characteristic and also this whole

208
00:11:34,620 --> 00:11:38,279
Bluetooth device which is used for a

209
00:11:38,279 --> 00:11:41,519
passive entry is behaving like a high

210
00:11:41,519 --> 00:11:44,760
beacon it's a very known protocol and

211
00:11:44,760 --> 00:11:47,399
it's mainly done so that also iPhones

212
00:11:47,399 --> 00:11:50,100
can always discover vehicles and their

213
00:11:50,100 --> 00:11:52,640
proximity

214
00:11:54,959 --> 00:11:58,860
so there is a uuid connected to that I

215
00:11:58,860 --> 00:12:01,740
Beacon specification and disk uuid is

216
00:12:01,740 --> 00:12:03,959
specific to Tesla vehicles so every

217
00:12:03,959 --> 00:12:07,079
ibacon built in in a Tesla vehicle will

218
00:12:07,079 --> 00:12:10,140
look like that and there's like two IDs

219
00:12:10,140 --> 00:12:13,500
one major one minor ID but there's some

220
00:12:13,500 --> 00:12:17,240
more detail about that later on

221
00:12:17,760 --> 00:12:20,940
so how does the smartphone identify the

222
00:12:20,940 --> 00:12:23,760
vehicle so clearly if you scan for

223
00:12:23,760 --> 00:12:26,220
Bluetooth devices in the proximity and

224
00:12:26,220 --> 00:12:28,260
it happens to be that there's a Tesla

225
00:12:28,260 --> 00:12:31,380
Model 3 or model Y in your area you find

226
00:12:31,380 --> 00:12:33,600
the name which starts out with a capital

227
00:12:33,600 --> 00:12:37,260
S and there then there's eight bytes hex

228
00:12:37,260 --> 00:12:39,540
encoded and the last character would be

229
00:12:39,540 --> 00:12:43,920
a c and it used to be a DP or r as well

230
00:12:43,920 --> 00:12:46,740
but they got rid of the other three

231
00:12:46,740 --> 00:12:48,779
beacons usually or in the beginning

232
00:12:48,779 --> 00:12:51,300
every model three in every model y used

233
00:12:51,300 --> 00:12:53,519
to have four beacons and they reduced it

234
00:12:53,519 --> 00:12:54,899
down to one

235
00:12:54,899 --> 00:12:57,120
and that's just to guess what these

236
00:12:57,120 --> 00:13:00,240
characters stand for but that's not that

237
00:13:00,240 --> 00:13:01,500
important

238
00:13:01,500 --> 00:13:04,740
important is these eight bytes in HEX

239
00:13:04,740 --> 00:13:08,339
they seem very random at first but they

240
00:13:08,339 --> 00:13:10,860
are unique to a vehicle so you could

241
00:13:10,860 --> 00:13:14,579
tell every vehicle has a different eight

242
00:13:14,579 --> 00:13:17,660
byte sequence

243
00:13:18,899 --> 00:13:22,500
and I just thought that is not right

244
00:13:22,500 --> 00:13:25,920
since it's always turned on and this ID

245
00:13:25,920 --> 00:13:28,440
is visible visible to anyone with the

246
00:13:28,440 --> 00:13:30,480
ble radio like in the phone right

247
00:13:30,480 --> 00:13:33,959
everybody has it so and I was under the

248
00:13:33,959 --> 00:13:35,820
impression that this could be a privacy

249
00:13:35,820 --> 00:13:39,480
issue and could be used for stalking and

250
00:13:39,480 --> 00:13:41,399
if you compare this whole discussion

251
00:13:41,399 --> 00:13:44,160
about the Air Tech and I don't know have

252
00:13:44,160 --> 00:13:46,139
you heard about that air tag privacy

253
00:13:46,139 --> 00:13:47,459
issues

254
00:13:47,459 --> 00:13:49,380
of course it's been a big thing in the

255
00:13:49,380 --> 00:13:52,139
news thing is that Apple Air tags are

256
00:13:52,139 --> 00:13:54,839
doing a pretty good job in disguising

257
00:13:54,839 --> 00:13:57,060
the hardware address and also disguising

258
00:13:57,060 --> 00:13:59,700
their ID and still it's possible to

259
00:13:59,700 --> 00:14:02,639
follow air tags and to stock especially

260
00:14:02,639 --> 00:14:04,680
if you have that Apple device

261
00:14:04,680 --> 00:14:06,660
and then you using the Apple

262
00:14:06,660 --> 00:14:08,459
infrastructure then of course you can

263
00:14:08,459 --> 00:14:11,760
always identify the I Air Tech

264
00:14:11,760 --> 00:14:14,760
but in a way that never was an issue to

265
00:14:14,760 --> 00:14:18,000
Tesla even though Tesla implies so

266
00:14:18,000 --> 00:14:21,180
like this car is the driver and once you

267
00:14:21,180 --> 00:14:23,820
can spot the driver you know a lot of

268
00:14:23,820 --> 00:14:26,399
things about the driver

269
00:14:26,399 --> 00:14:28,740
so that's why I got in touch with Tesla

270
00:14:28,740 --> 00:14:31,620
in 2019 and asked them to change that

271
00:14:31,620 --> 00:14:34,260
and said I don't like that I'm an owner

272
00:14:34,260 --> 00:14:36,120
myself I don't want to be tracked by

273
00:14:36,120 --> 00:14:39,779
anybody that has a ble interface in the

274
00:14:39,779 --> 00:14:41,279
phone and maybe an app that is

275
00:14:41,279 --> 00:14:43,620
specialized doing that

276
00:14:43,620 --> 00:14:45,600
tester said yeah we know that already

277
00:14:45,600 --> 00:14:48,060
but you know as long as there's traffic

278
00:14:48,060 --> 00:14:51,300
cameras everywhere why should we change

279
00:14:51,300 --> 00:14:54,860
that ID behavior in our product

280
00:14:54,860 --> 00:14:59,639
and so I thought it would teach them a

281
00:14:59,639 --> 00:15:01,860
lesson if I published an app which is

282
00:15:01,860 --> 00:15:04,139
called Tesla radar which is exactly that

283
00:15:04,139 --> 00:15:06,899
it's an app running on phones spotting

284
00:15:06,899 --> 00:15:10,500
Tesla vehicles communicating that to a

285
00:15:10,500 --> 00:15:13,079
service that draws a heat map out of

286
00:15:13,079 --> 00:15:14,760
that

287
00:15:14,760 --> 00:15:17,459
at that time I had no understanding of

288
00:15:17,459 --> 00:15:19,139
all the inner workings I didn't know

289
00:15:19,139 --> 00:15:24,420
about what this ID also might be and

290
00:15:24,420 --> 00:15:28,199
yeah I just published that app and I

291
00:15:28,199 --> 00:15:30,300
hoped to get a lot of vehicle

292
00:15:30,300 --> 00:15:32,220
discoveries and

293
00:15:32,220 --> 00:15:34,800
at first this was showcasing the privacy

294
00:15:34,800 --> 00:15:37,620
issues that come with the Tesla

295
00:15:37,620 --> 00:15:41,100
then it I decided to gamify it so you

296
00:15:41,100 --> 00:15:44,100
get points for every Tesla you spot and

297
00:15:44,100 --> 00:15:47,160
there's a lot of thing going on in the

298
00:15:47,160 --> 00:15:49,500
Tesla fan Community it's not that many

299
00:15:49,500 --> 00:15:52,560
users but there's rankings and

300
00:15:52,560 --> 00:15:53,519
everything

301
00:15:53,519 --> 00:15:55,980
and of course it's a data collection for

302
00:15:55,980 --> 00:15:58,139
research which turned out to be pretty

303
00:15:58,139 --> 00:16:01,639
useful later on

304
00:16:01,920 --> 00:16:05,160
and this is about the app so as you

305
00:16:05,160 --> 00:16:09,420
might see of all places Norway is very

306
00:16:09,420 --> 00:16:12,240
good at Tesla radar so I'm just saying

307
00:16:12,240 --> 00:16:15,180
that for you as a little bit of a

308
00:16:15,180 --> 00:16:18,360
motivation to also install that app and

309
00:16:18,360 --> 00:16:20,639
also to spot Teslas

310
00:16:20,639 --> 00:16:23,459
um yeah Norway is not on that screenshot

311
00:16:23,459 --> 00:16:26,399
but I can tell you Norway for now is

312
00:16:26,399 --> 00:16:28,980
number one in spottings so you shouldn't

313
00:16:28,980 --> 00:16:32,240
leave it like that right

314
00:16:32,339 --> 00:16:34,019
so and you can see on the screenshot

315
00:16:34,019 --> 00:16:36,300
it's 51 countries playing or there's

316
00:16:36,300 --> 00:16:39,360
cars out of 51 countries that have been

317
00:16:39,360 --> 00:16:42,480
spotted it's been like more than

318
00:16:42,480 --> 00:16:43,880
100

319
00:16:43,880 --> 00:16:49,320
70 000 unique vehicles in almost 1.6

320
00:16:49,320 --> 00:16:53,519
million spotting events by 3 000 devices

321
00:16:53,519 --> 00:16:55,740
right there's some statistics on the

322
00:16:55,740 --> 00:16:58,620
page it might be interesting if you want

323
00:16:58,620 --> 00:17:00,959
to check it out it's a free app I would

324
00:17:00,959 --> 00:17:04,940
be happy if you install it and used it

325
00:17:05,099 --> 00:17:08,760
so but it took a while until December

326
00:17:08,760 --> 00:17:11,579
last year when I discovered by pure

327
00:17:11,579 --> 00:17:14,520
coincidence that these eight characters

328
00:17:14,520 --> 00:17:16,919
or these eight bytes that are hex

329
00:17:16,919 --> 00:17:18,959
encoded that are appearing in the name

330
00:17:18,959 --> 00:17:22,919
of my vehicle that they have to do with

331
00:17:22,919 --> 00:17:25,439
the VIN number the win as you might know

332
00:17:25,439 --> 00:17:28,620
is the vehicle identification number and

333
00:17:28,620 --> 00:17:30,540
usually it's it's a standard every

334
00:17:30,540 --> 00:17:32,880
vehicle does have one it's often related

335
00:17:32,880 --> 00:17:36,240
to registration of the car is used for

336
00:17:36,240 --> 00:17:39,960
garage references so the win is a very

337
00:17:39,960 --> 00:17:43,919
important number and just by coincidence

338
00:17:43,919 --> 00:17:47,220
I found out that these AIDS bites the

339
00:17:47,220 --> 00:17:50,820
right are derived by sha-1 hashing that

340
00:17:50,820 --> 00:17:53,340
wins win of that car

341
00:17:53,340 --> 00:17:56,640
and also like just chopping off the

342
00:17:56,640 --> 00:17:58,799
eight first eight bites of this

343
00:17:58,799 --> 00:18:02,160
otherwise 20 bytes sharp one string

344
00:18:02,160 --> 00:18:06,600
so knowing that you know a lot of the

345
00:18:06,600 --> 00:18:08,700
car details you know which model it is

346
00:18:08,700 --> 00:18:10,860
you know when it's been built you know

347
00:18:10,860 --> 00:18:13,860
uh what type it is you also find out

348
00:18:13,860 --> 00:18:16,200
about the battery tag used in it so

349
00:18:16,200 --> 00:18:18,539
these are the things encoded in the test

350
00:18:18,539 --> 00:18:20,840
living

351
00:18:20,940 --> 00:18:23,760
so as said you can

352
00:18:23,760 --> 00:18:26,580
reverse that process of having that Char

353
00:18:26,580 --> 00:18:29,880
one part of a hash and you reverse it

354
00:18:29,880 --> 00:18:32,220
back to the VIN by building a rainbow

355
00:18:32,220 --> 00:18:34,500
table and that's what I did so for every

356
00:18:34,500 --> 00:18:38,280
thinkable win I calculated that hash and

357
00:18:38,280 --> 00:18:41,220
that index is now about

358
00:18:41,220 --> 00:18:44,039
20 Gigabytes big but has a pretty high

359
00:18:44,039 --> 00:18:46,160
hit rate so

360
00:18:46,160 --> 00:18:51,419
98 of testers can be resolved uh the bin

361
00:18:51,419 --> 00:18:55,440
of 98 of the Teslas can be resolved with

362
00:18:55,440 --> 00:18:57,299
this

363
00:18:57,299 --> 00:19:00,000
um index so and that was around

364
00:19:00,000 --> 00:19:02,220
Christmas right and I do have family in

365
00:19:02,220 --> 00:19:04,020
Berlin and that's why I did an

366
00:19:04,020 --> 00:19:06,360
experiment I mounted

367
00:19:06,360 --> 00:19:09,960
a directional antenna on my new tripod

368
00:19:09,960 --> 00:19:13,500
which fits exactly in the rear window of

369
00:19:13,500 --> 00:19:15,120
my car

370
00:19:15,120 --> 00:19:17,039
and

371
00:19:17,039 --> 00:19:19,080
this is from the inside it's a perfect

372
00:19:19,080 --> 00:19:22,200
fit for that side pocket and this is on

373
00:19:22,200 --> 00:19:25,679
the way already to the gigafactory 4

374
00:19:25,679 --> 00:19:28,740
which is of course you cannot just enter

375
00:19:28,740 --> 00:19:31,380
and walk around there there's like a

376
00:19:31,380 --> 00:19:33,600
large area where you're not supposed to

377
00:19:33,600 --> 00:19:35,400
go to their security Personnel

378
00:19:35,400 --> 00:19:37,860
preventing you from entering it

379
00:19:37,860 --> 00:19:41,400
but with this antenna I was driving this

380
00:19:41,400 --> 00:19:42,380
path

381
00:19:42,380 --> 00:19:45,419
inwards pointing to the vehicle to the

382
00:19:45,419 --> 00:19:47,940
building right and trying to get out a

383
00:19:47,940 --> 00:19:49,320
few things

384
00:19:49,320 --> 00:19:51,720
and that was really fun because it was

385
00:19:51,720 --> 00:19:54,299
not only research prototypes that Tesla

386
00:19:54,299 --> 00:19:57,240
have and they have a certain bin

387
00:19:57,240 --> 00:19:59,880
attached so you can recognize that this

388
00:19:59,880 --> 00:20:01,980
is a research prototype

389
00:20:01,980 --> 00:20:04,880
it's also like all kind of mechanics

390
00:20:04,880 --> 00:20:07,260
machines that do expose the Bluetooth

391
00:20:07,260 --> 00:20:10,500
low energy interface So in theory you

392
00:20:10,500 --> 00:20:12,240
could tamper around with heavy machinery

393
00:20:12,240 --> 00:20:14,160
in that factory and probably hurt

394
00:20:14,160 --> 00:20:16,860
somebody so this is not something you

395
00:20:16,860 --> 00:20:20,059
should take that easy

396
00:20:20,580 --> 00:20:24,360
well again I got in touch with Tesla

397
00:20:24,360 --> 00:20:26,940
with the community outreach team with

398
00:20:26,940 --> 00:20:29,100
the back Bounty team and I told them

399
00:20:29,100 --> 00:20:32,460
that it's possible to do a relay attack

400
00:20:32,460 --> 00:20:35,220
the one you saw in the video

401
00:20:35,220 --> 00:20:37,500
and they said yeah we already know that

402
00:20:37,500 --> 00:20:39,720
no Bounty for you

403
00:20:39,720 --> 00:20:42,059
and it's a known limitation of our Pro

404
00:20:42,059 --> 00:20:44,940
of our product and the protocol and we

405
00:20:44,940 --> 00:20:48,179
strongly advise every owner to use pin

406
00:20:48,179 --> 00:20:51,240
to drive which is a four digit PIN that

407
00:20:51,240 --> 00:20:53,520
prevents a thief from

408
00:20:53,520 --> 00:20:56,580
driving away your car once the thief got

409
00:20:56,580 --> 00:20:59,360
into your car

410
00:21:00,480 --> 00:21:03,539
and very interesting I asked people on

411
00:21:03,539 --> 00:21:05,340
Twitter again this time a little bit

412
00:21:05,340 --> 00:21:08,820
more people participated in Nepal

413
00:21:08,820 --> 00:21:12,660
and I was asking which features are they

414
00:21:12,660 --> 00:21:15,000
using in their in their car right

415
00:21:15,000 --> 00:21:17,760
clearly it was a trick question I wanted

416
00:21:17,760 --> 00:21:21,059
to see how many people were there that

417
00:21:21,059 --> 00:21:23,520
used the PIN to drive feature

418
00:21:23,520 --> 00:21:26,340
and only one-third of the people back

419
00:21:26,340 --> 00:21:28,620
then used that feature so that means

420
00:21:28,620 --> 00:21:30,900
like two out of three cars

421
00:21:30,900 --> 00:21:35,240
could be stolen by a relay attack

422
00:21:36,360 --> 00:21:39,059
and there's something missing in this

423
00:21:39,059 --> 00:21:40,799
slide for some reason it always does

424
00:21:40,799 --> 00:21:44,100
that so that's the setup of the man in

425
00:21:44,100 --> 00:21:45,600
the middle attack you saw in the video

426
00:21:45,600 --> 00:21:48,059
it's like the phone connecting to the

427
00:21:48,059 --> 00:21:50,039
one Raspberry Pi it's a really old

428
00:21:50,039 --> 00:21:53,280
Raspberry Pi I just used that model

429
00:21:53,280 --> 00:21:55,380
because of the low energy consumption

430
00:21:55,380 --> 00:21:58,559
and then it was talking via VPN to a

431
00:21:58,559 --> 00:22:01,679
guitar instance

432
00:22:01,679 --> 00:22:04,700
and then relate to another

433
00:22:04,700 --> 00:22:07,140
Raspberry Pi which is not seen on the

434
00:22:07,140 --> 00:22:10,260
slide and that one is talking to the car

435
00:22:10,260 --> 00:22:13,980
and you cannot imagine how disappointed

436
00:22:13,980 --> 00:22:16,799
I was back then when I found out that

437
00:22:16,799 --> 00:22:19,860
this just works so there was no fiddling

438
00:22:19,860 --> 00:22:22,980
necessary there was no going an extra

439
00:22:22,980 --> 00:22:25,980
mile to make that work so that was in a

440
00:22:25,980 --> 00:22:28,140
way disappointing to me because at the

441
00:22:28,140 --> 00:22:30,780
time I was really a big big fan of Tesla

442
00:22:30,780 --> 00:22:33,360
and thought well they should get it

443
00:22:33,360 --> 00:22:35,539
right

444
00:22:35,640 --> 00:22:38,700
but talking about that guitar relay and

445
00:22:38,700 --> 00:22:41,520
that proxy what it is you find out about

446
00:22:41,520 --> 00:22:43,559
all the details that I partly already

447
00:22:43,559 --> 00:22:45,600
talked about and you can see the

448
00:22:45,600 --> 00:22:48,900
messages being passed back and forth

449
00:22:48,900 --> 00:22:51,120
so there's this so-called BC SEC

450
00:22:51,120 --> 00:22:54,419
protocol which is used to encode all the

451
00:22:54,419 --> 00:22:56,940
messages that come from the vehicle to

452
00:22:56,940 --> 00:23:00,559
the phone and vice versa and it's a

453
00:23:00,559 --> 00:23:03,780
protobuf protocol protobuf for the

454
00:23:03,780 --> 00:23:06,780
people here that do not know what it is

455
00:23:06,780 --> 00:23:09,720
it's like a binary Json form

456
00:23:09,720 --> 00:23:12,179
so it's like a protocol definition and

457
00:23:12,179 --> 00:23:15,059
you can cram a large message into a very

458
00:23:15,059 --> 00:23:19,200
short binary representation and that of

459
00:23:19,200 --> 00:23:20,940
course saves a lot of bandwidth and

460
00:23:20,940 --> 00:23:23,100
especially for Bluetooth low energy you

461
00:23:23,100 --> 00:23:25,200
do not have a lot of bandwidth so it's a

462
00:23:25,200 --> 00:23:28,220
very good match for that

463
00:23:28,679 --> 00:23:31,380
and it's of course not only used for the

464
00:23:31,380 --> 00:23:33,179
phone as the key feature it's also used

465
00:23:33,179 --> 00:23:35,760
by the key fob you can see that in the

466
00:23:35,760 --> 00:23:38,159
Practical messages it seems to be used

467
00:23:38,159 --> 00:23:40,320
for the tire pressure and pressure

468
00:23:40,320 --> 00:23:43,260
subsystem and it's also may be used for

469
00:23:43,260 --> 00:23:45,480
back-end communication

470
00:23:45,480 --> 00:23:48,000
and maybe there's even more use cases

471
00:23:48,000 --> 00:23:51,679
that I do not know of yet

472
00:23:51,780 --> 00:23:54,179
so we see Sac has a long history as well

473
00:23:54,179 --> 00:23:56,580
of course it started being integrated

474
00:23:56,580 --> 00:24:00,419
into the app by April 2018 when the

475
00:24:00,419 --> 00:24:02,460
model 3 was very new

476
00:24:02,460 --> 00:24:05,159
and back then it was using the protobuf

477
00:24:05,159 --> 00:24:06,960
implementation by Google

478
00:24:06,960 --> 00:24:08,820
the current APP version which is current

479
00:24:08,820 --> 00:24:12,840
version 4 is using a very similar

480
00:24:12,840 --> 00:24:14,520
implementation but by a different

481
00:24:14,520 --> 00:24:16,919
manufacturer it's now using the wire

482
00:24:16,919 --> 00:24:19,919
protocol made by square

483
00:24:19,919 --> 00:24:22,740
very similar output but it's not

484
00:24:22,740 --> 00:24:25,080
extractable by standard tools as it was

485
00:24:25,080 --> 00:24:27,659
before so it's a little bit more

486
00:24:27,659 --> 00:24:29,340
difficult to get out that protocol

487
00:24:29,340 --> 00:24:32,940
definition from that APK

488
00:24:32,940 --> 00:24:35,460
but over time that protocol kind of

489
00:24:35,460 --> 00:24:38,400
developed a lot so the latest version I

490
00:24:38,400 --> 00:24:41,340
was having a look a closer look onto had

491
00:24:41,340 --> 00:24:45,179
77 messages and 45 enums whereas the

492
00:24:45,179 --> 00:24:48,120
first version just had 22 messages and

493
00:24:48,120 --> 00:24:49,980
90 nums

494
00:24:49,980 --> 00:24:54,360
and this is a very coarse uml overview I

495
00:24:54,360 --> 00:24:57,659
colored uh the classes and enums with

496
00:24:57,659 --> 00:25:00,059
blue color because these were the

497
00:25:00,059 --> 00:25:02,159
objects being referenced in the ple

498
00:25:02,159 --> 00:25:05,039
subsystem of the Android apps so these

499
00:25:05,039 --> 00:25:06,900
were the interesting messages and then

500
00:25:06,900 --> 00:25:10,400
classes to look at

501
00:25:12,240 --> 00:25:14,340
and you can also once you catch one of

502
00:25:14,340 --> 00:25:17,460
these binary messages like the one here

503
00:25:17,460 --> 00:25:20,039
in the in the parenthesis you can easily

504
00:25:20,039 --> 00:25:23,460
decrypt them with a shell command all

505
00:25:23,460 --> 00:25:25,679
you need is to have that protobuf

506
00:25:25,679 --> 00:25:28,020
definition which you find on the GitHub

507
00:25:28,020 --> 00:25:31,440
repository so I put all the versions on

508
00:25:31,440 --> 00:25:33,659
there and then you need the protalk tool

509
00:25:33,659 --> 00:25:38,220
and you just trans transform that binary

510
00:25:38,220 --> 00:25:40,799
message into a human readable form which

511
00:25:40,799 --> 00:25:43,740
looks like that it's it's like it looks

512
00:25:43,740 --> 00:25:47,400
like in the Json representation you

513
00:25:47,400 --> 00:25:49,980
absolutely know what it's all about it

514
00:25:49,980 --> 00:25:52,440
says about the public key Shah so every

515
00:25:52,440 --> 00:25:55,140
key is referred to by its four bytes of

516
00:25:55,140 --> 00:25:59,100
the Char one hash uh it's very clear

517
00:25:59,100 --> 00:26:02,520
there's very little guesswork to do

518
00:26:02,520 --> 00:26:06,539
and of course you see the white list as

519
00:26:06,539 --> 00:26:10,980
a as a key term here so having a key in

520
00:26:10,980 --> 00:26:13,440
the white list of the car does allow you

521
00:26:13,440 --> 00:26:16,220
to use it so there's different key types

522
00:26:16,220 --> 00:26:19,919
there is the service key you can see it

523
00:26:19,919 --> 00:26:23,220
by the key role is role service so that

524
00:26:23,220 --> 00:26:26,100
is used by garages and so on it looks

525
00:26:26,100 --> 00:26:29,460
like an NFC card I can tell that by the

526
00:26:29,460 --> 00:26:31,200
properties it has

527
00:26:31,200 --> 00:26:34,080
and um yeah

528
00:26:34,080 --> 00:26:36,299
it has all the permissions they are

529
00:26:36,299 --> 00:26:39,419
there's a token there's a public key we

530
00:26:39,419 --> 00:26:41,100
will find out about a little more about

531
00:26:41,100 --> 00:26:43,320
these properties later on

532
00:26:43,320 --> 00:26:45,779
then there's the two NFC keycards that

533
00:26:45,779 --> 00:26:48,179
every owner gets with a car

534
00:26:48,179 --> 00:26:50,340
they look similar but have a different

535
00:26:50,340 --> 00:26:53,640
role here it's a role owner and then

536
00:26:53,640 --> 00:26:56,279
here's an example for a phone key in the

537
00:26:56,279 --> 00:26:59,039
white list it looks different it has a

538
00:26:59,039 --> 00:27:01,799
counter next to the Token in the bottom

539
00:27:01,799 --> 00:27:04,080
so the session info for talking with the

540
00:27:04,080 --> 00:27:06,059
car has a little more information that

541
00:27:06,059 --> 00:27:08,820
implies that this phone key is capable

542
00:27:08,820 --> 00:27:11,760
of doing passive entry

543
00:27:11,760 --> 00:27:14,279
and this is an example for a key fob

544
00:27:14,279 --> 00:27:15,960
which I of course got

545
00:27:15,960 --> 00:27:18,480
so the next slides are just there for

546
00:27:18,480 --> 00:27:21,059
reference I will skip over them since

547
00:27:21,059 --> 00:27:23,520
there's a lot of them you see a lot of

548
00:27:23,520 --> 00:27:26,520
the protocol classes these are the

549
00:27:26,520 --> 00:27:29,279
messages sent from BC SEC from the card

550
00:27:29,279 --> 00:27:32,700
to the phone and there's a few examples

551
00:27:32,700 --> 00:27:34,760
there's always a length header

552
00:27:34,760 --> 00:27:37,500
pre-pended to the message which is not

553
00:27:37,500 --> 00:27:39,720
part of the protobuf protocol definition

554
00:27:39,720 --> 00:27:42,360
it's something that Tesla introduced and

555
00:27:42,360 --> 00:27:44,520
I think they did that for fragmentation

556
00:27:44,520 --> 00:27:47,460
things in issues they have with

557
00:27:47,460 --> 00:27:50,820
fragmentation of messages

558
00:27:50,820 --> 00:27:53,340
and always you see like the translation

559
00:27:53,340 --> 00:27:55,860
to human readable there's also like the

560
00:27:55,860 --> 00:27:58,320
vice versa the other direction things

561
00:27:58,320 --> 00:28:02,520
you send to the car to VC Sac from the

562
00:28:02,520 --> 00:28:05,520
phone it's unsigned messages and sign

563
00:28:05,520 --> 00:28:09,120
messages usually unsigned messages are

564
00:28:09,120 --> 00:28:11,039
crammed into a signed message in order

565
00:28:11,039 --> 00:28:14,100
to have like a secure message then which

566
00:28:14,100 --> 00:28:17,279
has more or requires more security and

567
00:28:17,279 --> 00:28:20,360
more permission or more privilege

568
00:28:20,360 --> 00:28:23,520
cryptographic keys are easily generated

569
00:28:23,520 --> 00:28:27,120
so that's just the the openssl command

570
00:28:27,120 --> 00:28:30,480
on how to generate a valid key pair that

571
00:28:30,480 --> 00:28:32,700
can be used in order to be white listed

572
00:28:32,700 --> 00:28:36,419
in a car so there's no special Tesla CA

573
00:28:36,419 --> 00:28:39,960
that the key needs to be signed from

574
00:28:39,960 --> 00:28:42,480
so you just generate your key which is

575
00:28:42,480 --> 00:28:46,799
perfectly fine and yeah you you're able

576
00:28:46,799 --> 00:28:49,440
to then once this key is in enrolled

577
00:28:49,440 --> 00:28:51,720
into the car you can send signed

578
00:28:51,720 --> 00:28:54,960
messages and these are encrypted and

579
00:28:54,960 --> 00:28:58,140
signed with the galwa counter mode which

580
00:28:58,140 --> 00:29:00,299
is most known from its use in the SSH

581
00:29:00,299 --> 00:29:01,559
protocol

582
00:29:01,559 --> 00:29:03,840
so that's also very good crypto so

583
00:29:03,840 --> 00:29:05,400
there's nothing wrong

584
00:29:05,400 --> 00:29:09,299
and the scalawa counter mode does have a

585
00:29:09,299 --> 00:29:13,140
initialization Vector which is a rolling

586
00:29:13,140 --> 00:29:17,580
key in this way so there is a eight byte

587
00:29:17,580 --> 00:29:18,419
um

588
00:29:18,419 --> 00:29:21,000
eight byte invocation counter they call

589
00:29:21,000 --> 00:29:23,580
it which indicate in the case of Tesla

590
00:29:23,580 --> 00:29:26,159
is just four bytes long by the way but

591
00:29:26,159 --> 00:29:28,799
this is used as a rolling key feature

592
00:29:28,799 --> 00:29:31,740
and only higher numbers are always

593
00:29:31,740 --> 00:29:34,980
accepted by the vehicle

594
00:29:34,980 --> 00:29:36,600
well

595
00:29:36,600 --> 00:29:38,700
there's some actions in the protocol

596
00:29:38,700 --> 00:29:41,520
that you can use the messages for it's

597
00:29:41,520 --> 00:29:43,679
like things like open car open trunk

598
00:29:43,679 --> 00:29:45,960
open charge port these are the things

599
00:29:45,960 --> 00:29:48,059
that the app is also like having buttons

600
00:29:48,059 --> 00:29:50,820
for so it's pretty straightforward and

601
00:29:50,820 --> 00:29:53,760
pretty self-explanatory

602
00:29:53,760 --> 00:29:56,159
and in order to open the car of course

603
00:29:56,159 --> 00:29:58,140
you need to have more privilege and

604
00:29:58,140 --> 00:30:00,120
that's why these things are only working

605
00:30:00,120 --> 00:30:02,520
as signed messages of course

606
00:30:02,520 --> 00:30:06,120
and this class of messages is or this

607
00:30:06,120 --> 00:30:09,240
enumeration is showing you about showing

608
00:30:09,240 --> 00:30:12,659
you things that can go wrong so we see

609
00:30:12,659 --> 00:30:14,820
some of these messages in the attacks

610
00:30:14,820 --> 00:30:17,240
later on

611
00:30:17,700 --> 00:30:20,820
so and also there's like a short form of

612
00:30:20,820 --> 00:30:22,860
of commands that are used in the key fob

613
00:30:22,860 --> 00:30:25,440
which is more limited and has shorter

614
00:30:25,440 --> 00:30:27,120
message types and so on it's like

615
00:30:27,120 --> 00:30:29,399
something I did not fully comprehend by

616
00:30:29,399 --> 00:30:31,140
now

617
00:30:31,140 --> 00:30:33,299
so this is an example for a signed

618
00:30:33,299 --> 00:30:35,159
message and there's a lot of guesswork

619
00:30:35,159 --> 00:30:38,399
of what goes into the into the payload

620
00:30:38,399 --> 00:30:40,140
of a signed message since it's really

621
00:30:40,140 --> 00:30:42,480
hard to figure out once you just got the

622
00:30:42,480 --> 00:30:45,779
crypto string but that guesswork worked

623
00:30:45,779 --> 00:30:48,000
out and I have a fully functional client

624
00:30:48,000 --> 00:30:51,480
for the VC SEC protocol

625
00:30:51,480 --> 00:30:54,179
so what can you do with this unsigned

626
00:30:54,179 --> 00:30:56,399
messages for now you can find out

627
00:30:56,399 --> 00:30:59,940
whether a car has several Keys enrolled

628
00:30:59,940 --> 00:31:02,100
you can tell whether the driver or owner

629
00:31:02,100 --> 00:31:05,220
is an apple Fanboy or not you can see

630
00:31:05,220 --> 00:31:07,140
how much which key is going to get used

631
00:31:07,140 --> 00:31:08,520
because the counters are always

632
00:31:08,520 --> 00:31:12,539
increasing and you can tell there's a

633
00:31:12,539 --> 00:31:15,539
service key enrolled in that and funny

634
00:31:15,539 --> 00:31:18,419
enough it's never changing or there's

635
00:31:18,419 --> 00:31:20,700
two different Service keys that have

636
00:31:20,700 --> 00:31:24,240
alternating IDs and that implies that

637
00:31:24,240 --> 00:31:26,580
there must be an NFC service key card

638
00:31:26,580 --> 00:31:29,580
which is pretty neat to have right maybe

639
00:31:29,580 --> 00:31:33,139
someday you find that on eBay

640
00:31:34,679 --> 00:31:37,380
so what does it require to whitelist

641
00:31:37,380 --> 00:31:40,740
your own key so as said you have to

642
00:31:40,740 --> 00:31:42,899
speak the protocol you need to be able

643
00:31:42,899 --> 00:31:46,320
to talk vcsec to the car and there's a

644
00:31:46,320 --> 00:31:48,419
maximum number of 19 keys that can be

645
00:31:48,419 --> 00:31:50,700
enrolled per vehicle

646
00:31:50,700 --> 00:31:53,460
and there's also uh features called

647
00:31:53,460 --> 00:31:55,860
Fleet Management so I'm not really sure

648
00:31:55,860 --> 00:31:58,380
what this is used for I I'd say it's

649
00:31:58,380 --> 00:32:01,740
some corporate feature no idea

650
00:32:01,740 --> 00:32:04,200
and the whitelisted keys are referenced

651
00:32:04,200 --> 00:32:06,840
with the key ID which is the first first

652
00:32:06,840 --> 00:32:09,960
four bytes of a Sharp one hash over the

653
00:32:09,960 --> 00:32:13,860
public key of this the specific key pair

654
00:32:13,860 --> 00:32:16,020
you want to whitelist

655
00:32:16,020 --> 00:32:18,179
so what's usually happening if you have

656
00:32:18,179 --> 00:32:20,580
your official app you log into your

657
00:32:20,580 --> 00:32:23,640
Tesla account and the Tesla owner API

658
00:32:23,640 --> 00:32:26,159
gives you all the VIN numbers that you

659
00:32:26,159 --> 00:32:29,399
are allowed to talk to Tesla knows very

660
00:32:29,399 --> 00:32:30,419
much

661
00:32:30,419 --> 00:32:34,080
which win belongs to which person

662
00:32:34,080 --> 00:32:36,419
the bad thing about that is the car

663
00:32:36,419 --> 00:32:38,159
doesn't know that and as soon as

664
00:32:38,159 --> 00:32:40,620
somebody starts talking to the car the

665
00:32:40,620 --> 00:32:43,380
car has no means of proving that Tesla

666
00:32:43,380 --> 00:32:44,700
allowed that

667
00:32:44,700 --> 00:32:46,919
so that's a big flaw right there in the

668
00:32:46,919 --> 00:32:49,340
application

669
00:32:49,440 --> 00:32:52,380
um so once you get the win identifier or

670
00:32:52,380 --> 00:32:55,260
you just see a car that identifies as a

671
00:32:55,260 --> 00:32:56,760
Tesla

672
00:32:56,760 --> 00:32:58,620
you can begin the white listing process

673
00:32:58,620 --> 00:33:01,980
and you would send first please give me

674
00:33:01,980 --> 00:33:05,460
your public key then you send your

675
00:33:05,460 --> 00:33:08,580
public key and you kind of make that

676
00:33:08,580 --> 00:33:10,380
diffie-hellman key exchange and you

677
00:33:10,380 --> 00:33:13,980
derive a communication key

678
00:33:13,980 --> 00:33:16,019
and you of course get the number of

679
00:33:16,019 --> 00:33:18,299
whitelisted keys so you that you can

680
00:33:18,299 --> 00:33:20,940
after the process tell whether there's

681
00:33:20,940 --> 00:33:23,299
one new key enrolled which is your key

682
00:33:23,299 --> 00:33:27,539
and I won't go into very much detail

683
00:33:27,539 --> 00:33:29,840
here since it's just protocol and boring

684
00:33:29,840 --> 00:33:33,059
and yeah that's maybe interesting it was

685
00:33:33,059 --> 00:33:36,240
possible to tap the NFC keycard at the

686
00:33:36,240 --> 00:33:39,059
outer side of the car in order to enroll

687
00:33:39,059 --> 00:33:42,960
a new key which is a security issue

688
00:33:42,960 --> 00:33:46,019
and finally you receive your whitelisted

689
00:33:46,019 --> 00:33:48,120
key you get confirmation and then you're

690
00:33:48,120 --> 00:33:50,220
ready to start using it

691
00:33:50,220 --> 00:33:52,200
and this is when I thought about the

692
00:33:52,200 --> 00:33:54,240
authorization timer attack because as

693
00:33:54,240 --> 00:33:56,580
said you can tap the B pillar the

694
00:33:56,580 --> 00:33:58,919
outside of your car and you do that if

695
00:33:58,919 --> 00:34:01,500
you use your key card in order to unlock

696
00:34:01,500 --> 00:34:03,899
the car and lock the car and there every

697
00:34:03,899 --> 00:34:07,019
time you touch that b-pillar or the

698
00:34:07,019 --> 00:34:09,719
middle console there was a 130 seconds

699
00:34:09,719 --> 00:34:13,619
time in which every attacker in the

700
00:34:13,619 --> 00:34:16,020
vicinity of that vehicle could enroll

701
00:34:16,020 --> 00:34:19,800
his her own key right and drive your car

702
00:34:19,800 --> 00:34:22,260
and not only when you unlocked it but

703
00:34:22,260 --> 00:34:24,060
also when you locked it and left the car

704
00:34:24,060 --> 00:34:27,480
so even less chance of you finding out

705
00:34:27,480 --> 00:34:30,239
and during that 130 seconds there's no

706
00:34:30,239 --> 00:34:33,300
extra NFC heat tap necessary so that was

707
00:34:33,300 --> 00:34:35,339
a big issue Tesla never got in touch

708
00:34:35,339 --> 00:34:37,260
with me but they kind of mitigated it

709
00:34:37,260 --> 00:34:40,080
they said or they made it impossible to

710
00:34:40,080 --> 00:34:41,699
tap the b-pillar in order to enroll a

711
00:34:41,699 --> 00:34:44,159
new key but you still of course have to

712
00:34:44,159 --> 00:34:46,199
tap somewhere in order to authorize a

713
00:34:46,199 --> 00:34:48,179
new whitelisting of a key

714
00:34:48,179 --> 00:34:51,480
so there's some ways you can also force

715
00:34:51,480 --> 00:34:54,359
your victim to do the middle console tab

716
00:34:54,359 --> 00:34:58,500
so this is a half hearted mitigation so

717
00:34:58,500 --> 00:35:00,599
to say

718
00:35:00,599 --> 00:35:02,820
so that's a video I won't show that

719
00:35:02,820 --> 00:35:06,000
video to you it got almost 50 000 views

720
00:35:06,000 --> 00:35:08,160
so that's good for me because I'm not a

721
00:35:08,160 --> 00:35:09,839
YouTuber

722
00:35:09,839 --> 00:35:11,400
um but maybe you want to check it out

723
00:35:11,400 --> 00:35:14,579
it's it's a video that got viewed a lot

724
00:35:14,579 --> 00:35:17,099
of times and it shows that authorization

725
00:35:17,099 --> 00:35:20,420
timer attack

726
00:35:22,079 --> 00:35:24,599
so owning a key allows you to unlock and

727
00:35:24,599 --> 00:35:26,220
lock the vehicle in order to drive the

728
00:35:26,220 --> 00:35:28,859
vehicle but wait a moment there was this

729
00:35:28,859 --> 00:35:30,900
pin to drive right once I'm in the

730
00:35:30,900 --> 00:35:32,700
vehicle I can steal all the belongings

731
00:35:32,700 --> 00:35:34,859
of the owner but I can't drive the car

732
00:35:34,859 --> 00:35:36,420
so

733
00:35:36,420 --> 00:35:38,760
I would have to enter this four digit

734
00:35:38,760 --> 00:35:41,760
PIN so I thought about like having that

735
00:35:41,760 --> 00:35:44,820
Bluetooth based or like game controller

736
00:35:44,820 --> 00:35:47,820
which is USB cable to the vehicle it's a

737
00:35:47,820 --> 00:35:50,160
human interface device right what if I

738
00:35:50,160 --> 00:35:52,020
just pretend to be a keyboard and enter

739
00:35:52,020 --> 00:35:55,020
all the pins because there's no amount

740
00:35:55,020 --> 00:35:57,359
of tries that I do have for entering the

741
00:35:57,359 --> 00:35:59,540
key

742
00:36:00,960 --> 00:36:03,420
and four digits to start with is not a

743
00:36:03,420 --> 00:36:05,760
lot and usually it's like the known few

744
00:36:05,760 --> 00:36:08,339
pin keys that everybody uses right it's

745
00:36:08,339 --> 00:36:11,040
like in Germany it would be oh eight one

746
00:36:11,040 --> 00:36:13,440
five or one two three four or zero zero

747
00:36:13,440 --> 00:36:15,599
zero zero

748
00:36:15,599 --> 00:36:18,119
um it's like that but somebody told me

749
00:36:18,119 --> 00:36:21,839
and um this guy's credited afterwards he

750
00:36:21,839 --> 00:36:23,280
told me it's not about the numbers

751
00:36:23,280 --> 00:36:26,160
Martin once you have a key in that

752
00:36:26,160 --> 00:36:29,099
vehicle computer you can just bypass

753
00:36:29,099 --> 00:36:31,500
that dialogue so it just disappears and

754
00:36:31,500 --> 00:36:34,200
you drive away so everybody who was able

755
00:36:34,200 --> 00:36:36,599
to enroll a key doesn't need to know

756
00:36:36,599 --> 00:36:39,720
that pin anymore so that tip that Tesla

757
00:36:39,720 --> 00:36:43,500
gave to their to their owners on how

758
00:36:43,500 --> 00:36:46,800
they should use a PIN to drive is not

759
00:36:46,800 --> 00:36:50,160
worth a lot in that scenario

760
00:36:50,160 --> 00:36:52,500
one next thing and there's also a video

761
00:36:52,500 --> 00:36:55,140
if you want to check it out it's showing

762
00:36:55,140 --> 00:37:00,440
how to make that pin dialogue disappear

763
00:37:00,540 --> 00:37:02,940
and Tesla does have a very broken trust

764
00:37:02,940 --> 00:37:05,579
model so I showed you the messages that

765
00:37:05,579 --> 00:37:07,859
the phone sends to the vehicle

766
00:37:07,859 --> 00:37:10,260
but what about the messages that come

767
00:37:10,260 --> 00:37:12,900
from the vehicle to the phone these are

768
00:37:12,900 --> 00:37:16,020
interesting as well and for every phone

769
00:37:16,020 --> 00:37:18,359
talking to the vehicle it has to make

770
00:37:18,359 --> 00:37:20,579
sure that everything is proven

771
00:37:20,579 --> 00:37:23,099
cryptographically and and it shows that

772
00:37:23,099 --> 00:37:25,500
you do have a private key enrolled in

773
00:37:25,500 --> 00:37:29,099
that vehicle or a key enrolled and

774
00:37:29,099 --> 00:37:30,240
um

775
00:37:30,240 --> 00:37:32,940
this is not the case for the car talking

776
00:37:32,940 --> 00:37:35,820
to the phone so it's really interesting

777
00:37:35,820 --> 00:37:38,820
in becoming a car

778
00:37:38,820 --> 00:37:41,520
so how to emulate that and that's a

779
00:37:41,520 --> 00:37:43,740
little bit tricky because the standard

780
00:37:43,740 --> 00:37:46,380
Linux bluesy Library does not allow the

781
00:37:46,380 --> 00:37:49,260
use of the enhanced or extended inquiry

782
00:37:49,260 --> 00:37:52,920
response which is used for emulating

783
00:37:52,920 --> 00:37:55,859
that Beacon structure and also used for

784
00:37:55,859 --> 00:37:58,920
emulating that behavior so the scan

785
00:37:58,920 --> 00:38:01,140
response that encodes the name of the

786
00:38:01,140 --> 00:38:04,500
vehicle cannot easily be set

787
00:38:04,500 --> 00:38:06,300
but

788
00:38:06,300 --> 00:38:08,040
there's a tool for that it's called

789
00:38:08,040 --> 00:38:11,460
temporary and I show you in the last few

790
00:38:11,460 --> 00:38:14,900
minutes I show you about that

791
00:38:15,119 --> 00:38:16,800
um what can you do with that with

792
00:38:16,800 --> 00:38:19,079
emulating a card so you are very

793
00:38:19,079 --> 00:38:21,540
legitimate to to talk to that phone and

794
00:38:21,540 --> 00:38:23,760
you can tell it please send me an

795
00:38:23,760 --> 00:38:25,440
authorization and you would get an

796
00:38:25,440 --> 00:38:27,900
authorization from the phone and then

797
00:38:27,900 --> 00:38:30,359
you would say well

798
00:38:30,359 --> 00:38:32,579
the key you just used for signing that

799
00:38:32,579 --> 00:38:35,460
message I have never heard of that

800
00:38:35,460 --> 00:38:38,460
and the phone says but you should have

801
00:38:38,460 --> 00:38:41,400
heard of that and it would go please

802
00:38:41,400 --> 00:38:43,920
show me the list of your phone keys of

803
00:38:43,920 --> 00:38:47,700
your enlist in whitelisted keys and you

804
00:38:47,700 --> 00:38:50,280
as the fake vehicle would say see it's

805
00:38:50,280 --> 00:38:52,859
an almost empty list and they're sure

806
00:38:52,859 --> 00:38:56,099
not your phone on it and then the phone

807
00:38:56,099 --> 00:38:58,079
would just disconnect and Say Goodbye

808
00:38:58,079 --> 00:38:59,460
thanks

809
00:38:59,460 --> 00:39:02,760
and the owner would have to restart that

810
00:39:02,760 --> 00:39:05,880
key once the owner has to unlock the key

811
00:39:05,880 --> 00:39:08,460
the car again so there's a key

812
00:39:08,460 --> 00:39:11,220
restoration procedure

813
00:39:11,220 --> 00:39:14,160
which is not a full key enrollment so it

814
00:39:14,160 --> 00:39:16,079
doesn't even require that NFC card

815
00:39:16,079 --> 00:39:19,020
anymore so you just start the process

816
00:39:19,020 --> 00:39:21,839
the legitimate vehicle would say yeah

817
00:39:21,839 --> 00:39:24,839
I'm I might have been wrong before or

818
00:39:24,839 --> 00:39:26,660
you were talking to somebody else

819
00:39:26,660 --> 00:39:31,160
there's your key and you're allowed in

820
00:39:31,560 --> 00:39:33,980
and then I came up with another idea

821
00:39:33,980 --> 00:39:36,900
it's the crypto counter confusion attack

822
00:39:36,900 --> 00:39:39,960
so I said earlier there is a rolling key

823
00:39:39,960 --> 00:39:43,500
that only allows that that a new signed

824
00:39:43,500 --> 00:39:45,720
message is accepted by the vehicle

825
00:39:45,720 --> 00:39:48,859
whenever only that rolling key is higher

826
00:39:48,859 --> 00:39:51,619
than the last message

827
00:39:51,619 --> 00:39:55,260
received by the car was right if there's

828
00:39:55,260 --> 00:39:57,599
a an Android which has a current number

829
00:39:57,599 --> 00:40:01,380
of let's say 42 so the next number

830
00:40:01,380 --> 00:40:04,079
should be at least 43 for the car to

831
00:40:04,079 --> 00:40:06,780
accept it this is a very good measure in

832
00:40:06,780 --> 00:40:08,880
order to prevent replay attacks of

833
00:40:08,880 --> 00:40:11,060
course

834
00:40:11,820 --> 00:40:14,339
so but what happens if you let's say

835
00:40:14,339 --> 00:40:17,040
hike that value up and you say whatever

836
00:40:17,040 --> 00:40:20,220
you just signed the message with that ID

837
00:40:20,220 --> 00:40:23,400
was too slow too small you should be a

838
00:40:23,400 --> 00:40:25,740
higher value the next thing that happens

839
00:40:25,740 --> 00:40:28,619
is the phone would ask the car so what

840
00:40:28,619 --> 00:40:31,500
is like the next value I should use for

841
00:40:31,500 --> 00:40:35,160
for signing that message and the car

842
00:40:35,160 --> 00:40:37,260
would go or the fake car would go and

843
00:40:37,260 --> 00:40:40,980
say how about 4.2 billion which is the

844
00:40:40,980 --> 00:40:44,280
maximum value of a 32 unsigned integer

845
00:40:44,280 --> 00:40:48,480
variable which is used for that use case

846
00:40:48,480 --> 00:40:51,240
and when this happens the owner is in

847
00:40:51,240 --> 00:40:53,820
trouble because you have to uninstall

848
00:40:53,820 --> 00:40:56,520
the app as the app never forgets the key

849
00:40:56,520 --> 00:40:58,560
and you have to really delete the app

850
00:40:58,560 --> 00:41:00,599
from your phone which is not the natural

851
00:41:00,599 --> 00:41:02,760
thing to do and then you have to

852
00:41:02,760 --> 00:41:05,760
reinstall the app and enroll your phone

853
00:41:05,760 --> 00:41:08,579
again and buy that by doing that you

854
00:41:08,579 --> 00:41:11,339
have to tap the middle console again and

855
00:41:11,339 --> 00:41:14,280
you're open for that authorization timer

856
00:41:14,280 --> 00:41:17,000
attack again

857
00:41:17,940 --> 00:41:19,859
so there's a little bit of differences

858
00:41:19,859 --> 00:41:21,599
between the iOS and the Android

859
00:41:21,599 --> 00:41:23,880
implementation so the Android

860
00:41:23,880 --> 00:41:26,280
implementation is using a signed integer

861
00:41:26,280 --> 00:41:28,500
so it wouldn't accept values higher than

862
00:41:28,500 --> 00:41:31,619
like the half of 4.2 billion

863
00:41:31,619 --> 00:41:33,839
but that's not a big deal so you the

864
00:41:33,839 --> 00:41:37,200
tool I wrote you can attach or like tell

865
00:41:37,200 --> 00:41:41,118
it with which phone you're talking to

866
00:41:41,520 --> 00:41:43,800
so I did a video

867
00:41:43,800 --> 00:41:46,440
um it's fun with temporary

868
00:41:46,440 --> 00:41:48,839
I'm not sure if we have the time I think

869
00:41:48,839 --> 00:41:51,480
I will skip that it will at some point

870
00:41:51,480 --> 00:41:55,380
be on YouTube but

871
00:41:55,380 --> 00:41:57,839
it shows how it's possible to drop the

872
00:41:57,839 --> 00:42:00,060
key I just explained that and it's also

873
00:42:00,060 --> 00:42:03,540
showing you how to crypto confuse the

874
00:42:03,540 --> 00:42:06,740
rolling key mechanism

875
00:42:07,020 --> 00:42:10,640
so there's one more thing

876
00:42:11,040 --> 00:42:13,079
as said there is a session in for

877
00:42:13,079 --> 00:42:15,660
whenever the counter off is off that the

878
00:42:15,660 --> 00:42:17,820
phone is using it will ask for the

879
00:42:17,820 --> 00:42:20,940
session info and the session info tells

880
00:42:20,940 --> 00:42:23,640
the phone the next value for the counter

881
00:42:23,640 --> 00:42:27,060
and also tells the phone about a token

882
00:42:27,060 --> 00:42:29,780
which is used for the signed messages

883
00:42:29,780 --> 00:42:32,220
and this token is a very good idea

884
00:42:32,220 --> 00:42:34,680
because it it represents a challenge

885
00:42:34,680 --> 00:42:38,040
method so if this token changes a lot

886
00:42:38,040 --> 00:42:40,680
it's impossible for attackers to Guess

887
00:42:40,680 --> 00:42:43,140
that value and it's impossible for

888
00:42:43,140 --> 00:42:46,260
attackers to go as a fake car to that

889
00:42:46,260 --> 00:42:48,000
phone and ask it for authorization

890
00:42:48,000 --> 00:42:51,660
requests based on this token

891
00:42:51,660 --> 00:42:54,420
but what if this token would never

892
00:42:54,420 --> 00:42:57,180
change or not change as often as it

893
00:42:57,180 --> 00:42:59,940
should so I observed this token being

894
00:42:59,940 --> 00:43:03,599
the same value for over a week

895
00:43:03,599 --> 00:43:07,140
so what does that mean that means once I

896
00:43:07,140 --> 00:43:09,660
know that token as an attacker

897
00:43:09,660 --> 00:43:12,960
I can do an authorization request as a

898
00:43:12,960 --> 00:43:15,119
fake car talking to the legitimate phone

899
00:43:15,119 --> 00:43:18,300
and get like a like a bunch of

900
00:43:18,300 --> 00:43:21,060
authorization responses based on that

901
00:43:21,060 --> 00:43:24,839
token and I can then like use my laptop

902
00:43:24,839 --> 00:43:28,200
as a key to the vehicle and let's say

903
00:43:28,200 --> 00:43:31,560
have 100 authorization responses and I

904
00:43:31,560 --> 00:43:34,380
would just dispense them to the car as

905
00:43:34,380 --> 00:43:37,079
the car thinks that my laptop is the

906
00:43:37,079 --> 00:43:38,819
official phone

907
00:43:38,819 --> 00:43:41,640
so that's the replay attack there's no

908
00:43:41,640 --> 00:43:43,680
video yet that will be fun with

909
00:43:43,680 --> 00:43:46,980
temporary part two at some point also on

910
00:43:46,980 --> 00:43:49,140
YouTube

911
00:43:49,140 --> 00:43:51,500
right

912
00:43:51,900 --> 00:43:54,240
so there's a lot of tools and resources

913
00:43:54,240 --> 00:43:55,740
on GitHub

914
00:43:55,740 --> 00:43:56,900
um

915
00:43:56,900 --> 00:44:00,119
there's the GitHub repository address if

916
00:44:00,119 --> 00:44:02,220
you're interested and the very first

917
00:44:02,220 --> 00:44:05,640
tool I did is called tempura

918
00:44:05,640 --> 00:44:08,160
um it's it's used for talking to the

919
00:44:08,160 --> 00:44:11,880
Tesla via the VC Sac protocol it's based

920
00:44:11,880 --> 00:44:14,280
on the Bleak library and it's please

921
00:44:14,280 --> 00:44:16,020
only for testers you are allowed to

922
00:44:16,020 --> 00:44:17,839
tamper with

923
00:44:17,839 --> 00:44:22,200
and you can do there's some templates so

924
00:44:22,200 --> 00:44:24,300
that's the oldest tool I have I was

925
00:44:24,300 --> 00:44:27,180
presenting that in at kensek West in

926
00:44:27,180 --> 00:44:30,240
Vancouver for the first time so I it

927
00:44:30,240 --> 00:44:33,359
needs some work because my later tools

928
00:44:33,359 --> 00:44:35,760
are way better I think

929
00:44:35,760 --> 00:44:39,480
um it does support key enumeration and

930
00:44:39,480 --> 00:44:44,040
also the DN encoding of VC seg messages

931
00:44:44,040 --> 00:44:46,500
and then there's this temporary tool

932
00:44:46,500 --> 00:44:48,599
that you can use in order to impersonate

933
00:44:48,599 --> 00:44:51,359
a Tesla and what you can do with that is

934
00:44:51,359 --> 00:44:53,280
like doing the key drop attack doing the

935
00:44:53,280 --> 00:44:56,240
crypto counter attack to both together

936
00:44:56,240 --> 00:44:58,980
and also it shows you all the messages

937
00:44:58,980 --> 00:45:01,920
in human readable format which is pretty

938
00:45:01,920 --> 00:45:04,200
nice if you want to get into that whole

939
00:45:04,200 --> 00:45:07,260
protocol game with Tesla

940
00:45:07,260 --> 00:45:10,500
and to make things easier I made a new

941
00:45:10,500 --> 00:45:13,980
tool now for this SEC T conference and

942
00:45:13,980 --> 00:45:17,220
it's called the temporary profiler and

943
00:45:17,220 --> 00:45:20,040
what that does it extracts all the

944
00:45:20,040 --> 00:45:22,140
necessary values for the Json

945
00:45:22,140 --> 00:45:24,180
configuration file that you use with

946
00:45:24,180 --> 00:45:27,000
temporary which includes the Bluetooth

947
00:45:27,000 --> 00:45:30,420
address the extended Enquirer response

948
00:45:30,420 --> 00:45:32,339
the scan response and also the vehicles

949
00:45:32,339 --> 00:45:35,640
public key in order for you to emulate

950
00:45:35,640 --> 00:45:37,800
the car so that the official app will

951
00:45:37,800 --> 00:45:40,680
talk to your laptop so that's a new tool

952
00:45:40,680 --> 00:45:42,060
for now

953
00:45:42,060 --> 00:45:45,119
there's also that if you see seg archive

954
00:45:45,119 --> 00:45:48,180
with all the collected messages there is

955
00:45:48,180 --> 00:45:50,700
a vintag tool which is a wrapper around

956
00:45:50,700 --> 00:45:53,220
that API that you can also use in order

957
00:45:53,220 --> 00:45:55,980
to tell whether a certain eight byte hex

958
00:45:55,980 --> 00:45:59,460
value is a model 3 a model Y and for a

959
00:45:59,460 --> 00:46:01,560
small price you can also find out the

960
00:46:01,560 --> 00:46:05,280
bin about that car is a premium feature

961
00:46:05,280 --> 00:46:07,740
at some point I'm planning to release a

962
00:46:07,740 --> 00:46:10,020
car key or phone as a key replacement

963
00:46:10,020 --> 00:46:13,619
which is called Tesla key it's an app in

964
00:46:13,619 --> 00:46:15,839
the making so it's just used in order

965
00:46:15,839 --> 00:46:18,540
not to do all the things wrong with the

966
00:46:18,540 --> 00:46:20,880
official implementation it just doesn't

967
00:46:20,880 --> 00:46:23,760
talk to strangers which would be a great

968
00:46:23,760 --> 00:46:26,700
help for Tesla for the official Tesla

969
00:46:26,700 --> 00:46:29,280
app as well I'm not sure why they're not

970
00:46:29,280 --> 00:46:31,380
doing that

971
00:46:31,380 --> 00:46:34,380
so that's been it so far there's some

972
00:46:34,380 --> 00:46:36,420
conclusions so relay attacks are

973
00:46:36,420 --> 00:46:37,440
possible

974
00:46:37,440 --> 00:46:39,839
be very careful when using the NFC

975
00:46:39,839 --> 00:46:42,720
keycard as an owner

976
00:46:42,720 --> 00:46:45,599
the app should be improved in a way that

977
00:46:45,599 --> 00:46:48,300
there is a more joint understanding of

978
00:46:48,300 --> 00:46:51,240
the online and offline transactions that

979
00:46:51,240 --> 00:46:53,520
are done so why shouldn't it be that I

980
00:46:53,520 --> 00:46:55,920
without a proof of ownership can enroll

981
00:46:55,920 --> 00:46:59,460
a new key in the car

982
00:46:59,460 --> 00:47:02,040
we see SEC does not stand for vehicle

983
00:47:02,040 --> 00:47:04,920
control security what I first thought it

984
00:47:04,920 --> 00:47:08,880
stands for vehicle control secondary

985
00:47:08,880 --> 00:47:12,119
and as always the convenience in the

986
00:47:12,119 --> 00:47:15,180
user experience thoughts Trump the

987
00:47:15,180 --> 00:47:17,520
security ideas that there were

988
00:47:17,520 --> 00:47:19,680
and they got compromised a little bit

989
00:47:19,680 --> 00:47:22,520
over the process

990
00:47:22,980 --> 00:47:25,740
what about the key fob Assad research

991
00:47:25,740 --> 00:47:27,660
and progress maybe at some point I will

992
00:47:27,660 --> 00:47:29,640
have the chance to present my findings

993
00:47:29,640 --> 00:47:30,780
about that

994
00:47:30,780 --> 00:47:32,640
but for now there's nothing to talk

995
00:47:32,640 --> 00:47:33,540
about

996
00:47:33,540 --> 00:47:36,000
and here's the the slide with the

997
00:47:36,000 --> 00:47:39,480
credits uh Josh velder was the guy who

998
00:47:39,480 --> 00:47:42,420
told me about the PIN to drive bypass

999
00:47:42,420 --> 00:47:45,300
and that's nastin did a lot of similar

1000
00:47:45,300 --> 00:47:46,319
work

1001
00:47:46,319 --> 00:47:49,140
by documenting that the c-sec protocol

1002
00:47:49,140 --> 00:47:52,440
on his page we also got in touch uh he's

1003
00:47:52,440 --> 00:47:54,960
a nice guy from Ireland

1004
00:47:54,960 --> 00:47:58,140
so but what if it's too late what if you

1005
00:47:58,140 --> 00:47:59,760
have one of those implants for your

1006
00:47:59,760 --> 00:48:01,440
Tesla

1007
00:48:01,440 --> 00:48:04,560
you have one you should chop off your

1008
00:48:04,560 --> 00:48:06,920
hand now

1009
00:48:07,380 --> 00:48:10,319
uh yeah it's sold out where you can buy

1010
00:48:10,319 --> 00:48:13,920
it at dangerous things asset dangerous

1011
00:48:13,920 --> 00:48:16,319
you can have that NFC implant for your

1012
00:48:16,319 --> 00:48:18,480
hands but of course you could also

1013
00:48:18,480 --> 00:48:20,640
delete that entry from the whitelist of

1014
00:48:20,640 --> 00:48:23,760
your car or drop it off as you like

1015
00:48:23,760 --> 00:48:25,380
so thank you very much for your

1016
00:48:25,380 --> 00:48:27,119
attention there's

1017
00:48:27,119 --> 00:48:31,260
a few addresses things

1018
00:48:31,260 --> 00:48:33,900
yeah so thank you very much it was a

1019
00:48:33,900 --> 00:48:36,119
very interesting talk

1020
00:48:36,119 --> 00:48:38,700
um and we do have some questions from

1021
00:48:38,700 --> 00:48:41,099
the audience and but yes I was just

1022
00:48:41,099 --> 00:48:42,780
gonna say I'm sure Tesla is extremely

1023
00:48:42,780 --> 00:48:44,880
happy about all these features that you

1024
00:48:44,880 --> 00:48:46,560
adding to their product

1025
00:48:46,560 --> 00:48:48,780
so we say it again I think Tesla should

1026
00:48:48,780 --> 00:48:50,220
be very happy about all these features

1027
00:48:50,220 --> 00:48:52,380
that you're adding to their product yeah

1028
00:48:52,380 --> 00:48:53,480
right

1029
00:48:53,480 --> 00:48:56,220
they have any response from them

1030
00:48:56,220 --> 00:48:58,020
um I forgot to say there's a bag of

1031
00:48:58,020 --> 00:49:00,000
Mozart balls and everybody who will ask

1032
00:49:00,000 --> 00:49:02,640
a question gets a motor ball and also a

1033
00:49:02,640 --> 00:49:06,240
sticker Tesla radar sticker all right

1034
00:49:06,240 --> 00:49:09,119
did he had any any response from Tesla

1035
00:49:09,119 --> 00:49:10,920
have they said anything Teslas didn't

1036
00:49:10,920 --> 00:49:12,780
say anything so I was in touch two times

1037
00:49:12,780 --> 00:49:16,260
with the with the buck Bounty team but

1038
00:49:16,260 --> 00:49:19,140
my expectations were different I was a

1039
00:49:19,140 --> 00:49:21,839
little bit disappointed and I haven't

1040
00:49:21,839 --> 00:49:24,420
heard of somebody who ever got a reward

1041
00:49:24,420 --> 00:49:26,700
by the Tesla Buck Bounty program so far

1042
00:49:26,700 --> 00:49:29,160
so my assumption is that Tesla is not

1043
00:49:29,160 --> 00:49:31,140
going doing a very good job there so

1044
00:49:31,140 --> 00:49:33,420
that's just me saying that

1045
00:49:33,420 --> 00:49:36,300
sounds plausible okay we have some

1046
00:49:36,300 --> 00:49:37,980
intelligent questions from the audience

1047
00:49:37,980 --> 00:49:40,740
uh and from slido so if you would like

1048
00:49:40,740 --> 00:49:42,599
to more ask more questions later on just

1049
00:49:42,599 --> 00:49:45,300
post them on slido as well and one of

1050
00:49:45,300 --> 00:49:47,300
them is like okay some of these attacks

1051
00:49:47,300 --> 00:49:50,640
uh might be transferable to other like

1052
00:49:50,640 --> 00:49:52,920
car manufacturers there is Bosch doing a

1053
00:49:52,920 --> 00:49:55,140
lot of these systems is there similar

1054
00:49:55,140 --> 00:49:57,240
Research into others this only a Tesla

1055
00:49:57,240 --> 00:49:59,339
problem or can we expect other car

1056
00:49:59,339 --> 00:50:01,440
manufacturers to be as bad

1057
00:50:01,440 --> 00:50:03,660
um I think it's for now it's a Tesla

1058
00:50:03,660 --> 00:50:06,180
specific problem there is a car key

1059
00:50:06,180 --> 00:50:09,180
specification the digital key is

1060
00:50:09,180 --> 00:50:11,880
specified by the CCC which is not the

1061
00:50:11,880 --> 00:50:14,780
cause communication Club it's the car

1062
00:50:14,780 --> 00:50:18,240
con Forum whatever for car manufacturers

1063
00:50:18,240 --> 00:50:21,000
and they do have a lot of put a lot of

1064
00:50:21,000 --> 00:50:23,220
thought to that problem that Tesla

1065
00:50:23,220 --> 00:50:26,160
solved beforehand so they didn't wait

1066
00:50:26,160 --> 00:50:28,020
for that standard to have their product

1067
00:50:28,020 --> 00:50:32,760
out but that car key specification for

1068
00:50:32,760 --> 00:50:35,420
example uses Ultra White Band which

1069
00:50:35,420 --> 00:50:38,520
supports secure ranging of tokens you

1070
00:50:38,520 --> 00:50:41,339
can tell this is the device that should

1071
00:50:41,339 --> 00:50:44,339
be there so it's it's helping a lot of

1072
00:50:44,339 --> 00:50:46,400
these things that went wrong for tester

1073
00:50:46,400 --> 00:50:49,680
to be more secure

1074
00:50:49,680 --> 00:50:52,800
okay that makes sense but but what about

1075
00:50:52,800 --> 00:50:54,960
the tracking you said I mean a lot of

1076
00:50:54,960 --> 00:50:58,500
other cars might be the Tesla radar a

1077
00:50:58,500 --> 00:51:00,660
lot of cars now have like what you call

1078
00:51:00,660 --> 00:51:03,000
it monitoring for for the tire pressure

1079
00:51:03,000 --> 00:51:06,180
and stuff uh is it possible to take that

1080
00:51:06,180 --> 00:51:08,160
app and build a generic like here we

1081
00:51:08,160 --> 00:51:11,460
have GMCs here we have this many would

1082
00:51:11,460 --> 00:51:13,319
it be possible to

1083
00:51:13,319 --> 00:51:15,960
build on that for other manufacturers I

1084
00:51:15,960 --> 00:51:17,940
think other manufacturers would use a

1085
00:51:17,940 --> 00:51:19,619
different method of of encoding

1086
00:51:19,619 --> 00:51:21,839
information there I've heard a lot of

1087
00:51:21,839 --> 00:51:23,940
things about the tire pressure and

1088
00:51:23,940 --> 00:51:25,800
sensors they're not only based on

1089
00:51:25,800 --> 00:51:28,020
Bluetooth the newer ones are but there

1090
00:51:28,020 --> 00:51:31,020
used to be a 433 megahertz version which

1091
00:51:31,020 --> 00:51:33,780
also allowed tracking of vehicles but in

1092
00:51:33,780 --> 00:51:35,400
a different way so you needed

1093
00:51:35,400 --> 00:51:37,680
specialized hardware for that and now

1094
00:51:37,680 --> 00:51:39,300
it's possible with the Bluetooth capable

1095
00:51:39,300 --> 00:51:41,940
phone so it's like way easier now and I

1096
00:51:41,940 --> 00:51:43,319
have not really looked at other

1097
00:51:43,319 --> 00:51:46,619
manufacturers products so far

1098
00:51:46,619 --> 00:51:48,960
okay and then then another really

1099
00:51:48,960 --> 00:51:50,940
interesting question is like where did

1100
00:51:50,940 --> 00:51:53,160
you spend the most time on a dead end in

1101
00:51:53,160 --> 00:51:55,680
this research where do you like I and

1102
00:51:55,680 --> 00:51:58,079
didn't get it's like where did you go

1103
00:51:58,079 --> 00:52:01,200
wrong in your research or did you

1104
00:52:01,200 --> 00:52:03,900
um yeah there was a situation you first

1105
00:52:03,900 --> 00:52:05,700
off I have to say it is really

1106
00:52:05,700 --> 00:52:07,920
exhausting for me because my car is

1107
00:52:07,920 --> 00:52:09,720
parked in the garage which is not

1108
00:52:09,720 --> 00:52:12,300
connected to our power system so I

1109
00:52:12,300 --> 00:52:15,180
always have to bring a USB power bank to

1110
00:52:15,180 --> 00:52:18,059
the car in order to power my setup with

1111
00:52:18,059 --> 00:52:20,099
the Raspberry Pi in order to be able to

1112
00:52:20,099 --> 00:52:22,559
talk to the car so I have to go there

1113
00:52:22,559 --> 00:52:25,440
twice a day sometimes and that's like a

1114
00:52:25,440 --> 00:52:27,059
five minutes walk

1115
00:52:27,059 --> 00:52:29,280
and this was like a little bit

1116
00:52:29,280 --> 00:52:32,099
exhausting but uh over the time Tesla

1117
00:52:32,099 --> 00:52:34,140
changed stuff and at one point I thought

1118
00:52:34,140 --> 00:52:37,319
well I'm out they solved the relay issue

1119
00:52:37,319 --> 00:52:40,020
because both of my Raspberry Pi's use a

1120
00:52:40,020 --> 00:52:42,000
very high powered Bluetooth interface

1121
00:52:42,000 --> 00:52:43,859
like a hundred milliwatt which is a

1122
00:52:43,859 --> 00:52:45,780
Class one

1123
00:52:45,780 --> 00:52:48,300
and it turned out that talking to the

1124
00:52:48,300 --> 00:52:50,400
Tesla via relay the test is certain

1125
00:52:50,400 --> 00:52:52,500
suddenly decided not to unlock the car

1126
00:52:52,500 --> 00:52:55,079
anymore and I said whoa well done what

1127
00:52:55,079 --> 00:52:58,020
did they change and it turned out that I

1128
00:52:58,020 --> 00:53:00,599
got an alert message via Bluetooth which

1129
00:53:00,599 --> 00:53:02,640
is which is strange because if there is

1130
00:53:02,640 --> 00:53:04,740
an attacker coming to your car why

1131
00:53:04,740 --> 00:53:06,780
should that attacker be informed about

1132
00:53:06,780 --> 00:53:08,819
something that went wrong with the

1133
00:53:08,819 --> 00:53:10,619
process right but I did get that alert

1134
00:53:10,619 --> 00:53:13,140
message and it told me that the RSS I

1135
00:53:13,140 --> 00:53:16,260
read out on all four Beacon sensors was

1136
00:53:16,260 --> 00:53:18,839
too high so the car was not able to tell

1137
00:53:18,839 --> 00:53:20,819
where the owner with the phone is

1138
00:53:20,819 --> 00:53:23,760
standing so the fix for that was just to

1139
00:53:23,760 --> 00:53:25,440
replace that really high powered

1140
00:53:25,440 --> 00:53:28,079
Bluetooth interface with the class 2 a

1141
00:53:28,079 --> 00:53:30,240
normal Bluetooth interface and

1142
00:53:30,240 --> 00:53:31,260
everything

1143
00:53:31,260 --> 00:53:34,319
came back to normal again so the readout

1144
00:53:34,319 --> 00:53:37,020
the RSSI readout was okay again for the

1145
00:53:37,020 --> 00:53:40,440
car so it started to work again so that

1146
00:53:40,440 --> 00:53:42,420
was one of the situations where I had

1147
00:53:42,420 --> 00:53:43,500
some

1148
00:53:43,500 --> 00:53:45,480
questions whether this is still a talk

1149
00:53:45,480 --> 00:53:49,260
to presented SEC T Maybe

1150
00:53:49,260 --> 00:53:51,839
the the that's amazing do you have any

1151
00:53:51,839 --> 00:53:54,119
more questions from the audience over

1152
00:53:54,119 --> 00:53:59,180
there perhaps mic 2 coming up

1153
00:54:00,180 --> 00:54:01,859
because thank you

1154
00:54:01,859 --> 00:54:03,480
um great presentation it actually

1155
00:54:03,480 --> 00:54:05,579
reminds me of hikari's work on high tech

1156
00:54:05,579 --> 00:54:07,800
2 starting in 2011 he did a talk you

1157
00:54:07,800 --> 00:54:10,079
shot the sheriff or he was able to fully

1158
00:54:10,079 --> 00:54:12,839
clone uh high-tech two keys so BMWs

1159
00:54:12,839 --> 00:54:14,940
Mercedes and a bunch of stuff

1160
00:54:14,940 --> 00:54:18,660
um so I was curious oh over here if

1161
00:54:18,660 --> 00:54:20,339
you've actually seen any of that

1162
00:54:20,339 --> 00:54:22,319
research or do you know Hikari from

1163
00:54:22,319 --> 00:54:23,880
torcon

1164
00:54:23,880 --> 00:54:26,400
um yeah I know Hikaru from turkan but I

1165
00:54:26,400 --> 00:54:27,960
haven't been there I saw some videos

1166
00:54:27,960 --> 00:54:30,839
also about semi-carp

1167
00:54:30,839 --> 00:54:35,339
you know semi chem car yeah right so his

1168
00:54:35,339 --> 00:54:37,920
attack with the double that inspired me

1169
00:54:37,920 --> 00:54:40,619
a little bit like thinking about the the

1170
00:54:40,619 --> 00:54:43,079
um replay attack you saw

1171
00:54:43,079 --> 00:54:45,420
um yeah I watched this I also got that

1172
00:54:45,420 --> 00:54:48,359
connected car hackers handbook

1173
00:54:48,359 --> 00:54:50,760
um you know for me this is a new field

1174
00:54:50,760 --> 00:54:52,800
of research since I'm the Bluetooth one

1175
00:54:52,800 --> 00:54:55,500
trick pony suddenly I got some more toys

1176
00:54:55,500 --> 00:54:57,960
to play with right so that was nice and

1177
00:54:57,960 --> 00:55:01,500
of course I did some research so um cool

1178
00:55:01,500 --> 00:55:02,819
um if anything like I'd love to

1179
00:55:02,819 --> 00:55:04,079
introduce you if you have never spoken

1180
00:55:04,079 --> 00:55:05,819
with Hikari because I worked with him on

1181
00:55:05,819 --> 00:55:07,020
that actually if you see a video online

1182
00:55:07,020 --> 00:55:09,000
breaking into BMWs I'm the person

1183
00:55:09,000 --> 00:55:10,680
breaking the car

1184
00:55:10,680 --> 00:55:12,900
um so but as involved questions on

1185
00:55:12,900 --> 00:55:15,599
denial of service so I I may have missed

1186
00:55:15,599 --> 00:55:17,040
it but I was curious

1187
00:55:17,040 --> 00:55:20,220
um so uh what I'm I think I'm inferring

1188
00:55:20,220 --> 00:55:21,180
is that you could drive around

1189
00:55:21,180 --> 00:55:22,980
neighborhoods and enumerate every car

1190
00:55:22,980 --> 00:55:25,140
right yeah so effectively like hedge

1191
00:55:25,140 --> 00:55:26,700
fund managers could pay you for the

1192
00:55:26,700 --> 00:55:28,619
technology to sit at the manufacturing

1193
00:55:28,619 --> 00:55:30,599
plant to count all the cars right I

1194
00:55:30,599 --> 00:55:31,980
think they do have that right and that's

1195
00:55:31,980 --> 00:55:34,440
why they're changing that

1196
00:55:34,440 --> 00:55:36,540
um so I was curious um when I hear about

1197
00:55:36,540 --> 00:55:39,119
like does the disassociation of keys

1198
00:55:39,119 --> 00:55:40,619
um how long does that take

1199
00:55:40,619 --> 00:55:42,300
like for it's like like how long before

1200
00:55:42,300 --> 00:55:43,619
like let's say you sit by someone's

1201
00:55:43,619 --> 00:55:45,540
house and then like how long before you

1202
00:55:45,540 --> 00:55:46,920
can knock the keys off that they have to

1203
00:55:46,920 --> 00:55:48,540
reassociate or reinstall it that's

1204
00:55:48,540 --> 00:55:50,460
pretty well that's like within seconds

1205
00:55:50,460 --> 00:55:53,520
you just talk well you drive around

1206
00:55:53,520 --> 00:55:55,319
everywhere just disassociate everyone's

1207
00:55:55,319 --> 00:55:57,359
Keys it's not that easy because you have

1208
00:55:57,359 --> 00:55:59,760
to know the car of which the key you can

1209
00:55:59,760 --> 00:56:02,400
disassociate right oh you have to do the

1210
00:56:02,400 --> 00:56:05,220
temporary profiler on one of but it can

1211
00:56:05,220 --> 00:56:06,540
be a great part to trick if you go to

1212
00:56:06,540 --> 00:56:09,000
someone's party yeah everyone's but I

1213
00:56:09,000 --> 00:56:11,280
like your thinking

1214
00:56:11,280 --> 00:56:12,900
yeah

1215
00:56:12,900 --> 00:56:14,579
um and and uh follow-up to that which I

1216
00:56:14,579 --> 00:56:16,200
think would be interesting so uh for the

1217
00:56:16,200 --> 00:56:18,300
last seven years I've been working with

1218
00:56:18,300 --> 00:56:19,859
um security teams at companies where

1219
00:56:19,859 --> 00:56:21,359
they have stalkers and so I was working

1220
00:56:21,359 --> 00:56:24,119
on building a TPMS trackers so they

1221
00:56:24,119 --> 00:56:25,380
could see that the same car that maybe

1222
00:56:25,380 --> 00:56:27,660
swapped license plates so

1223
00:56:27,660 --> 00:56:29,760
um regardless of disassociation so would

1224
00:56:29,760 --> 00:56:32,460
you say that um if you had the right uh

1225
00:56:32,460 --> 00:56:34,440
tuned equipment you would be able to

1226
00:56:34,440 --> 00:56:37,559
profile every car but as you drive by or

1227
00:56:37,559 --> 00:56:39,359
parking lots as they come in so you have

1228
00:56:39,359 --> 00:56:42,260
a unique identifier for every Tesla

1229
00:56:42,260 --> 00:56:44,819
yeah it's possible I could even like

1230
00:56:44,819 --> 00:56:47,460
extend Tesla radar for that it should be

1231
00:56:47,460 --> 00:56:49,140
possible oh fun okay cool well thank you

1232
00:56:49,140 --> 00:56:50,460
I thought it was interesting extensions

1233
00:56:50,460 --> 00:56:51,599
I'd love to chat with you further after

1234
00:56:51,599 --> 00:56:55,400
that okay yeah it's a premium feature

1235
00:56:57,140 --> 00:57:00,440
thank you Martin

