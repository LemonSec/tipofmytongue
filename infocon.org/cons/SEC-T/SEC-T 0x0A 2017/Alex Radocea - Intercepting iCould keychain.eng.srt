1
00:00:00,000 --> 00:00:04,609
and I've got a few questions<font color="#E5E5E5"> for you</font>

2
00:00:01,589 --> 00:00:05,789
<font color="#CCCCCC">guys does anybody use iCloud</font><font color="#E5E5E5"> keychain</font>

3
00:00:04,609 --> 00:00:10,320
<font color="#CCCCCC">whew</font>

4
00:00:05,790 --> 00:00:12,480
<font color="#E5E5E5">okay and there's a really great typo</font><font color="#CCCCCC"> on</font>

5
00:00:10,320 --> 00:00:15,330
the website<font color="#CCCCCC"> somebody wrote intercepting</font>

6
00:00:12,480 --> 00:00:16,410
<font color="#E5E5E5">I could keychain</font><font color="#CCCCCC"> I thought that was</font>

7
00:00:15,330 --> 00:00:19,890
really clever<font color="#E5E5E5"> I didn't</font><font color="#CCCCCC"> think of that</font>

8
00:00:16,410 --> 00:00:22,439
<font color="#E5E5E5">though so I've been working</font><font color="#CCCCCC"> in security</font>

9
00:00:19,890 --> 00:00:26,070
for about<font color="#E5E5E5"> 15 years</font><font color="#CCCCCC"> now currently at a</font>

10
00:00:22,439 --> 00:00:27,630
small consultancy you can follow us on

11
00:00:26,070 --> 00:00:29,580
medium we have<font color="#E5E5E5"> some contact info</font><font color="#CCCCCC"> for</font>

12
00:00:27,630 --> 00:00:31,380
there and Sweden is actually very

13
00:00:29,580 --> 00:00:34,280
special for me<font color="#CCCCCC"> when it</font><font color="#E5E5E5"> comes to computer</font>

14
00:00:31,380 --> 00:00:36,570
security<font color="#E5E5E5"> because when I was 16 I kept a</font>

15
00:00:34,280 --> 00:00:38,520
really<font color="#E5E5E5"> normal sleep schedule and I was</font>

16
00:00:36,570 --> 00:00:40,410
really<font color="#CCCCCC"> interested in hacking which meant</font>

17
00:00:38,520 --> 00:00:42,450
<font color="#CCCCCC">that</font><font color="#E5E5E5"> when I got online I overlapped with</font>

18
00:00:40,410 --> 00:00:43,769
real<font color="#CCCCCC"> Swedish hackers</font><font color="#E5E5E5"> that didn't sleep</font>

19
00:00:42,450 --> 00:00:46,710
at night<font color="#CCCCCC"> they didn't do their homework</font>

20
00:00:43,770 --> 00:00:48,300
<font color="#CCCCCC">they stayed up until</font><font color="#E5E5E5"> like</font><font color="#CCCCCC"> 5 a.m.</font><font color="#E5E5E5"> which</font>

21
00:00:46,710 --> 00:00:50,420
overlaps perfectly with the New<font color="#CCCCCC"> York</font>

22
00:00:48,300 --> 00:00:52,709
<font color="#E5E5E5">Times own for a normal teenager</font><font color="#CCCCCC"> and</font>

23
00:00:50,420 --> 00:00:55,350
<font color="#CCCCCC">there was a web site called war games</font>

24
00:00:52,710 --> 00:00:58,649
that UNIX dot SC does anybody remember

25
00:00:55,350 --> 00:01:03,059
this<font color="#CCCCCC"> oh I would love to meet</font><font color="#E5E5E5"> up</font><font color="#CCCCCC"> with</font><font color="#E5E5E5"> you</font>

26
00:00:58,649 --> 00:01:05,339
<font color="#E5E5E5">guys it was</font><font color="#CCCCCC"> just like the</font><font color="#E5E5E5"> best people</font>

27
00:01:03,059 --> 00:01:07,080
<font color="#CCCCCC">were super super interested in</font><font color="#E5E5E5"> learning</font>

28
00:01:05,339 --> 00:01:09,330
how<font color="#E5E5E5"> to program learning how to code and</font>

29
00:01:07,080 --> 00:01:11,460
learning how to hack and there's a lot

30
00:01:09,330 --> 00:01:13,650
of<font color="#CCCCCC"> crazy stuff going on back there</font>

31
00:01:11,460 --> 00:01:15,149
major Linux distros being compromised

32
00:01:13,650 --> 00:01:18,210
every other month it seemed like it was

33
00:01:15,150 --> 00:01:20,220
<font color="#CCCCCC">it seemed like complete chaos white hats</font>

34
00:01:18,210 --> 00:01:23,639
were being hacked<font color="#E5E5E5"> by black hats</font><font color="#CCCCCC"> it was</font>

35
00:01:20,220 --> 00:01:24,960
like all this internet drama<font color="#CCCCCC"> and as a 16</font>

36
00:01:23,640 --> 00:01:26,369
year old<font color="#CCCCCC"> was like wow this is really</font>

37
00:01:24,960 --> 00:01:28,949
crazy and<font color="#E5E5E5"> this is really</font><font color="#CCCCCC"> interesting I</font>

38
00:01:26,369 --> 00:01:30,210
want<font color="#CCCCCC"> to learn</font><font color="#E5E5E5"> more</font><font color="#CCCCCC"> about this and what</font>

39
00:01:28,950 --> 00:01:32,369
was<font color="#E5E5E5"> really nice about</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> Swedish</font>

40
00:01:30,210 --> 00:01:34,949
<font color="#CCCCCC">website was they had a really friendly</font>

41
00:01:32,369 --> 00:01:36,960
<font color="#E5E5E5">environment there was no room for being</font>

42
00:01:34,950 --> 00:01:40,470
a jerk<font color="#E5E5E5"> basically so it was a great place</font>

43
00:01:36,960 --> 00:01:45,119
<font color="#CCCCCC">to learn</font><font color="#E5E5E5"> and today I'll</font><font color="#CCCCCC"> talk to you guys</font>

44
00:01:40,470 --> 00:01:46,710
about<font color="#E5E5E5"> iCloud keychain</font><font color="#CCCCCC"> in-depth iCloud</font>

45
00:01:45,119 --> 00:01:48,829
keychain<font color="#E5E5E5"> has been around since about</font>

46
00:01:46,710 --> 00:01:51,119
2012 but there's a lot<font color="#E5E5E5"> of stuff that's</font>

47
00:01:48,829 --> 00:01:53,039
really<font color="#CCCCCC"> not well documented so this</font>

48
00:01:51,119 --> 00:01:54,329
presentation sheds a lot of light on

49
00:01:53,040 --> 00:01:57,719
some<font color="#E5E5E5"> of the details about how it</font>

50
00:01:54,329 --> 00:02:00,298
<font color="#CCCCCC">actually</font><font color="#E5E5E5"> works and what is this service</font>

51
00:01:57,719 --> 00:02:04,408
iCloud keychain essentially there are

52
00:02:00,299 --> 00:02:06,240
<font color="#CCCCCC">two major components</font><font color="#E5E5E5"> secret syncing and</font>

53
00:02:04,409 --> 00:02:08,340
recovery so you can synchronize your

54
00:02:06,240 --> 00:02:09,989
<font color="#E5E5E5">secrets between all of your devices and</font>

55
00:02:08,340 --> 00:02:11,430
<font color="#E5E5E5">what kind of</font><font color="#CCCCCC"> secrets am</font><font color="#E5E5E5"> I talking</font><font color="#CCCCCC"> about</font>

56
00:02:09,989 --> 00:02:13,410
I'm<font color="#CCCCCC"> talking about credit</font><font color="#E5E5E5"> card numbers</font>

57
00:02:11,430 --> 00:02:16,200
Wi-Fi passwords so

58
00:02:13,410 --> 00:02:17,820
<font color="#CCCCCC">fari autofill specific application</font>

59
00:02:16,200 --> 00:02:20,190
passwords from different apps use that

60
00:02:17,820 --> 00:02:23,130
have<font color="#E5E5E5"> enrolled into this and it's done in</font>

61
00:02:20,190 --> 00:02:24,570
the cloud<font color="#E5E5E5"> and as some</font><font color="#CCCCCC"> people</font><font color="#E5E5E5"> working in</font>

62
00:02:23,130 --> 00:02:26,130
the<font color="#E5E5E5"> skewness she might know</font><font color="#CCCCCC"> cloud</font>

63
00:02:24,570 --> 00:02:28,140
security sometimes is a<font color="#E5E5E5"> little bit</font>

64
00:02:26,130 --> 00:02:30,930
<font color="#E5E5E5">cloudy and where exactly is iCloud</font>

65
00:02:28,140 --> 00:02:34,019
anyway it's not in the sky currently

66
00:02:30,930 --> 00:02:36,090
it's a bunch of big companies that<font color="#CCCCCC"> host</font>

67
00:02:34,020 --> 00:02:38,610
huge data centers that<font color="#CCCCCC"> are very scalable</font>

68
00:02:36,090 --> 00:02:40,470
companies<font color="#E5E5E5"> like Amazon with AWS Google</font>

69
00:02:38,610 --> 00:02:42,420
cloud Microsoft Azure<font color="#CCCCCC"> and of course</font>

70
00:02:40,470 --> 00:02:45,270
Apple<font color="#E5E5E5"> has their own servers as</font><font color="#CCCCCC"> well</font><font color="#E5E5E5"> and</font>

71
00:02:42,420 --> 00:02:47,130
in<font color="#E5E5E5"> certain countries for Apple to enter</font>

72
00:02:45,270 --> 00:02:49,980
<font color="#E5E5E5">those markets they were required</font><font color="#CCCCCC"> to use</font>

73
00:02:47,130 --> 00:02:52,010
<font color="#E5E5E5">that country's data centers like in</font>

74
00:02:49,980 --> 00:02:56,970
<font color="#E5E5E5">China and Russia</font>

75
00:02:52,010 --> 00:02:58,679
so Apple<font color="#E5E5E5"> designed iCloud keychain to be</font>

76
00:02:56,970 --> 00:03:00,180
very secure<font color="#E5E5E5"> because of</font><font color="#CCCCCC"> the sensitivity</font>

77
00:02:58,680 --> 00:03:01,260
<font color="#CCCCCC">of the information</font><font color="#E5E5E5"> their credit card</font>

78
00:03:00,180 --> 00:03:03,240
numbers and<font color="#E5E5E5"> so on there's a lot of</font>

79
00:03:01,260 --> 00:03:04,649
incentive to<font color="#E5E5E5"> break in there</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> also</font>

80
00:03:03,240 --> 00:03:06,180
because they don't necessarily control

81
00:03:04,650 --> 00:03:08,550
the computers<font color="#CCCCCC"> that are</font><font color="#E5E5E5"> holding the data</font>

82
00:03:06,180 --> 00:03:10,560
<font color="#CCCCCC">because they rely on third parties to</font>

83
00:03:08,550 --> 00:03:13,290
get to this<font color="#E5E5E5"> Apple scale we're talking</font>

84
00:03:10,560 --> 00:03:15,680
about hundreds of<font color="#E5E5E5"> millions</font><font color="#CCCCCC"> of users</font><font color="#E5E5E5"> and</font>

85
00:03:13,290 --> 00:03:17,670
<font color="#E5E5E5">they did this</font><font color="#CCCCCC"> with intent cryptography</font>

86
00:03:15,680 --> 00:03:20,850
have you guys heard about<font color="#CCCCCC"> intent</font>

87
00:03:17,670 --> 00:03:22,799
cryptography before<font color="#E5E5E5"> and we'll talk a bit</font>

88
00:03:20,850 --> 00:03:26,609
<font color="#CCCCCC">about</font><font color="#E5E5E5"> it and it's really great</font><font color="#CCCCCC"> for</font>

89
00:03:22,800 --> 00:03:29,280
privacy<font color="#CCCCCC"> because the keys to decrypt</font><font color="#E5E5E5"> the</font>

90
00:03:26,610 --> 00:03:32,340
<font color="#CCCCCC">data only</font><font color="#E5E5E5"> live on the and on the</font>

91
00:03:29,280 --> 00:03:35,100
endpoints on those devices and the cloud

92
00:03:32,340 --> 00:03:36,870
computers<font color="#E5E5E5"> in this scenario only act as a</font>

93
00:03:35,100 --> 00:03:38,700
conduit of<font color="#E5E5E5"> the encrypted</font><font color="#CCCCCC"> information</font>

94
00:03:36,870 --> 00:03:41,250
they don't<font color="#E5E5E5"> have the keys to</font><font color="#CCCCCC"> access that</font>

95
00:03:38,700 --> 00:03:44,970
info<font color="#E5E5E5"> and that lets Apple make claims</font>

96
00:03:41,250 --> 00:03:46,860
<font color="#E5E5E5">such</font><font color="#CCCCCC"> as even</font><font color="#E5E5E5"> if there's a rogue insider</font>

97
00:03:44,970 --> 00:03:48,989
at Apple or somebody breaks<font color="#CCCCCC"> into an</font>

98
00:03:46,860 --> 00:03:50,730
iCloud<font color="#E5E5E5"> server iCloud keychain is still</font>

99
00:03:48,989 --> 00:03:52,770
secure<font color="#E5E5E5"> and they had a little bit more</font>

100
00:03:50,730 --> 00:03:54,899
foresight than that even they also

101
00:03:52,770 --> 00:03:57,540
secured keychain even if an iCloud

102
00:03:54,900 --> 00:03:59,790
account<font color="#CCCCCC"> is compromised so in 2016</font>

103
00:03:57,540 --> 00:04:02,220
something like<font color="#E5E5E5"> 400 million passwords got</font>

104
00:03:59,790 --> 00:04:04,470
dumped from hacks over the past<font color="#E5E5E5"> couple</font>

105
00:04:02,220 --> 00:04:06,359
of years<font color="#E5E5E5"> a lot of passwords out there</font>

106
00:04:04,470 --> 00:04:07,950
password<font color="#E5E5E5"> use a huge problem</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> it's not</font>

107
00:04:06,360 --> 00:04:11,430
<font color="#CCCCCC">that</font><font color="#E5E5E5"> hard</font><font color="#CCCCCC"> to break</font><font color="#E5E5E5"> into random iCloud</font>

108
00:04:07,950 --> 00:04:13,290
account and try<font color="#CCCCCC"> to monetize it so</font><font color="#E5E5E5"> Apple</font>

109
00:04:11,430 --> 00:04:14,610
went one step<font color="#CCCCCC"> further requiring that</font><font color="#E5E5E5"> you</font>

110
00:04:13,290 --> 00:04:16,950
actually have to<font color="#CCCCCC"> have a</font><font color="#E5E5E5"> trusted device</font>

111
00:04:14,610 --> 00:04:18,870
<font color="#E5E5E5">in addition</font><font color="#CCCCCC"> to the</font><font color="#E5E5E5"> iCloud credentials</font>

112
00:04:16,950 --> 00:04:21,298
they really tried to<font color="#CCCCCC"> make</font><font color="#E5E5E5"> it water</font>

113
00:04:18,870 --> 00:04:23,280
<font color="#E5E5E5">watertight of course we're here at a</font>

114
00:04:21,298 --> 00:04:24,659
security<font color="#CCCCCC"> conference and one of the fun</font>

115
00:04:23,280 --> 00:04:27,000
things<font color="#CCCCCC"> about my job is</font><font color="#E5E5E5"> we get to</font>

116
00:04:24,660 --> 00:04:27,330
celebrate failures and we found some

117
00:04:27,000 --> 00:04:29,099
critic

118
00:04:27,330 --> 00:04:32,068
<font color="#E5E5E5">cause that undermined this antenna</font>

119
00:04:29,099 --> 00:04:33,479
cryptography<font color="#CCCCCC"> and it would have allowed</font>

120
00:04:32,069 --> 00:04:35,129
someone<font color="#E5E5E5"> to intercept those secrets</font>

121
00:04:33,479 --> 00:04:36,960
anyway<font color="#E5E5E5"> despite all the measures that an</font>

122
00:04:35,129 --> 00:04:39,120
<font color="#E5E5E5">effort that they put</font><font color="#CCCCCC"> into iCloud</font>

123
00:04:36,960 --> 00:04:40,049
<font color="#E5E5E5">keychain and they really spent a lot</font><font color="#CCCCCC"> of</font>

124
00:04:39,120 --> 00:04:43,169
<font color="#E5E5E5">money if you look at some of the</font>

125
00:04:40,050 --> 00:04:45,569
mechanisms<font color="#E5E5E5"> they used and what's</font>

126
00:04:43,169 --> 00:04:47,219
interesting is<font color="#CCCCCC"> that these flaws were in</font>

127
00:04:45,569 --> 00:04:49,110
parts of the protocol<font color="#CCCCCC"> that you wouldn't</font>

128
00:04:47,219 --> 00:04:50,849
find in<font color="#E5E5E5"> Apple's white paper</font><font color="#CCCCCC"> that weren't</font>

129
00:04:49,110 --> 00:04:54,180
well documented<font color="#E5E5E5"> although they were in</font>

130
00:04:50,849 --> 00:04:56,250
<font color="#CCCCCC">open-source</font><font color="#E5E5E5"> components and so we're</font>

131
00:04:54,180 --> 00:04:59,069
gonna describe some of<font color="#E5E5E5"> the previous work</font>

132
00:04:56,250 --> 00:05:01,289
<font color="#E5E5E5">on iCloud keychain</font><font color="#CCCCCC"> then I'll talk to you</font>

133
00:04:59,069 --> 00:05:02,639
<font color="#E5E5E5">guys about how iCloud keychain works</font><font color="#CCCCCC"> and</font>

134
00:05:01,289 --> 00:05:04,919
I'm gonna<font color="#CCCCCC"> really focus on the syncing</font>

135
00:05:02,639 --> 00:05:07,500
part which has<font color="#E5E5E5"> not really been</font>

136
00:05:04,919 --> 00:05:10,169
documented<font color="#E5E5E5"> before</font><font color="#CCCCCC"> and then we're going</font>

137
00:05:07,500 --> 00:05:13,919
<font color="#CCCCCC">to talk about</font><font color="#E5E5E5"> the bugs so some of the</font>

138
00:05:10,169 --> 00:05:16,198
prior work<font color="#E5E5E5"> and 2014 Andre from via</font>

139
00:05:13,919 --> 00:05:19,318
forensics<font color="#CCCCCC"> I think they're now called</font><font color="#E5E5E5"> now</font>

140
00:05:16,199 --> 00:05:21,629
secure the<font color="#CCCCCC"> did some research on</font><font color="#E5E5E5"> iCloud</font>

141
00:05:19,319 --> 00:05:23,580
keychain<font color="#E5E5E5"> and I</font><font color="#CCCCCC"> he'd really focus on the</font>

142
00:05:21,629 --> 00:05:25,849
recovery and<font color="#CCCCCC"> looked at</font><font color="#E5E5E5"> that and he was</font>

143
00:05:23,580 --> 00:05:28,258
<font color="#E5E5E5">very suspicious of iCloud keychain</font>

144
00:05:25,849 --> 00:05:29,849
<font color="#CCCCCC">because in the recovery mechanism by</font>

145
00:05:28,259 --> 00:05:31,319
default you<font color="#CCCCCC"> have like a six digit</font><font color="#E5E5E5"> PIN</font>

146
00:05:29,849 --> 00:05:35,909
code right<font color="#E5E5E5"> so you can</font><font color="#CCCCCC"> brute-force that</font>

147
00:05:31,319 --> 00:05:37,199
pretty<font color="#CCCCCC"> easily</font><font color="#E5E5E5"> however</font><font color="#CCCCCC"> there's some more</font>

148
00:05:35,909 --> 00:05:39,449
<font color="#E5E5E5">things in there preventing brute force</font>

149
00:05:37,199 --> 00:05:43,500
that we'll<font color="#E5E5E5"> talk</font><font color="#CCCCCC"> about he also found a</font>

150
00:05:39,449 --> 00:05:45,509
great bug report in<font color="#E5E5E5"> 2015 and then last</font>

151
00:05:43,500 --> 00:05:47,069
year at blackhat Apple went into more

152
00:05:45,509 --> 00:05:48,750
detail than<font color="#E5E5E5"> they had before about a lot</font>

153
00:05:47,069 --> 00:05:49,919
of<font color="#CCCCCC"> different iOS security features so if</font>

154
00:05:48,750 --> 00:05:51,270
<font color="#CCCCCC">you</font><font color="#E5E5E5"> really want to get your head around</font>

155
00:05:49,919 --> 00:05:53,698
iCloud keychain check out this

156
00:05:51,270 --> 00:05:55,650
<font color="#CCCCCC">presentation as well they're they'll</font>

157
00:05:53,699 --> 00:05:58,139
explain how they set up<font color="#CCCCCC"> their HSN and</font>

158
00:05:55,650 --> 00:05:59,878
they use a one-way hashing function<font color="#E5E5E5"> also</font>

159
00:05:58,139 --> 00:06:03,360
known as a blender<font color="#E5E5E5"> for the private keys</font>

160
00:05:59,879 --> 00:06:05,339
for their<font color="#CCCCCC"> hsn's and earlier</font><font color="#E5E5E5"> this year</font>

161
00:06:03,360 --> 00:06:07,409
<font color="#E5E5E5">the</font><font color="#CCCCCC"> CEO of</font><font color="#E5E5E5"> L come soft have you guys</font>

162
00:06:05,339 --> 00:06:09,419
<font color="#E5E5E5">heard of welcome soft</font><font color="#CCCCCC"> they're their</font>

163
00:06:07,409 --> 00:06:13,800
leader in forensics<font color="#CCCCCC"> I did a presentation</font>

164
00:06:09,419 --> 00:06:14,849
on iCloud<font color="#E5E5E5"> keychain</font><font color="#CCCCCC"> and he questioned</font>

165
00:06:13,800 --> 00:06:16,379
<font color="#CCCCCC">whether</font><font color="#E5E5E5"> or not the two-factor</font>

166
00:06:14,849 --> 00:06:18,990
authentication could be weakening the

167
00:06:16,379 --> 00:06:20,789
protocol so they didn't<font color="#E5E5E5"> find a solid</font>

168
00:06:18,990 --> 00:06:22,919
break<font color="#E5E5E5"> but they</font><font color="#CCCCCC"> imply that there might be</font>

169
00:06:20,789 --> 00:06:24,300
something<font color="#CCCCCC"> there so that's another</font>

170
00:06:22,919 --> 00:06:26,758
<font color="#E5E5E5">interesting one of course you have the</font>

171
00:06:24,300 --> 00:06:29,129
white paper<font color="#E5E5E5"> and the white paper is has a</font>

172
00:06:26,759 --> 00:06:30,599
lot<font color="#CCCCCC"> of explanations about how</font>

173
00:06:29,129 --> 00:06:32,580
<font color="#CCCCCC">something's</font><font color="#E5E5E5"> work but when it comes to</font>

174
00:06:30,599 --> 00:06:35,610
the level<font color="#CCCCCC"> of</font><font color="#E5E5E5"> detail that I would want or</font>

175
00:06:32,580 --> 00:06:37,620
a security<font color="#CCCCCC"> researcher that wants to</font><font color="#E5E5E5"> test</font>

176
00:06:35,610 --> 00:06:38,759
if a protocol<font color="#E5E5E5"> is really secure the white</font>

177
00:06:37,620 --> 00:06:40,389
paper<font color="#E5E5E5"> doesn't have that level of detail</font>

178
00:06:38,759 --> 00:06:42,789
<font color="#CCCCCC">just</font><font color="#E5E5E5"> like</font>

179
00:06:40,389 --> 00:06:44,259
acronyms the names of protocols<font color="#E5E5E5"> and kind</font>

180
00:06:42,789 --> 00:06:45,460
of<font color="#E5E5E5"> a very</font><font color="#CCCCCC"> high-level view but the actual</font>

181
00:06:44,259 --> 00:06:47,050
protocol how does it really<font color="#E5E5E5"> work</font>

182
00:06:45,460 --> 00:06:50,169
you're not gonna find that<font color="#E5E5E5"> in there</font>

183
00:06:47,050 --> 00:06:52,629
<font color="#CCCCCC">unfortunately and now when it</font><font color="#E5E5E5"> comes to</font>

184
00:06:50,169 --> 00:06:54,099
crypto<font color="#CCCCCC"> it's really great to know</font><font color="#E5E5E5"> how</font>

185
00:06:52,629 --> 00:06:57,159
equipped analysts think<font color="#E5E5E5"> so this is a</font>

186
00:06:54,099 --> 00:06:58,750
picture<font color="#CCCCCC"> of Robert Morris senior his son</font>

187
00:06:57,159 --> 00:07:01,180
<font color="#E5E5E5">Robert Morris</font><font color="#CCCCCC"> Jr's infamous for the</font>

188
00:06:58,750 --> 00:07:04,360
<font color="#CCCCCC">Morris form and besides having</font><font color="#E5E5E5"> an</font>

189
00:07:01,180 --> 00:07:06,879
excellent<font color="#E5E5E5"> beard</font><font color="#CCCCCC"> Robert</font><font color="#E5E5E5"> Morris senior was</font>

190
00:07:04,360 --> 00:07:08,680
a<font color="#E5E5E5"> Crypt analyst at the NSA and he says</font>

191
00:07:06,879 --> 00:07:11,770
you<font color="#CCCCCC"> should never</font><font color="#E5E5E5"> underestimate</font><font color="#CCCCCC"> the</font>

192
00:07:08,680 --> 00:07:13,270
attention risk money and time<font color="#E5E5E5"> that an</font>

193
00:07:11,770 --> 00:07:16,299
opponent will put into reading traffic

194
00:07:13,270 --> 00:07:17,799
so if you're building crypto you you

195
00:07:16,300 --> 00:07:19,120
have to be very<font color="#E5E5E5"> paranoid because you're</font>

196
00:07:17,800 --> 00:07:20,740
<font color="#CCCCCC">dealing with people</font><font color="#E5E5E5"> like Robert Moore</font>

197
00:07:19,120 --> 00:07:25,629
senior that will do whatever it takes<font color="#CCCCCC"> to</font>

198
00:07:20,740 --> 00:07:27,009
get your secrets<font color="#E5E5E5"> so iCloud keychain has</font>

199
00:07:25,629 --> 00:07:28,569
two aspects to<font color="#E5E5E5"> it one part is the</font>

200
00:07:27,009 --> 00:07:31,180
recovery<font color="#E5E5E5"> so what happens if you lose</font>

201
00:07:28,569 --> 00:07:34,150
<font color="#E5E5E5">your your iPhone you lose your Mac it's</font>

202
00:07:31,180 --> 00:07:36,810
all gone but you had a password there in

203
00:07:34,150 --> 00:07:38,830
autofill<font color="#E5E5E5"> that you have no way</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> getting</font>

204
00:07:36,810 --> 00:07:39,879
that<font color="#E5E5E5"> would be a pretty terrible</font>

205
00:07:38,830 --> 00:07:41,258
experience because you could have

206
00:07:39,879 --> 00:07:43,629
<font color="#E5E5E5">getting locked out</font><font color="#CCCCCC"> of all your accounts</font>

207
00:07:41,259 --> 00:07:46,779
<font color="#E5E5E5">so iCloud keychain lets you actually</font>

208
00:07:43,629 --> 00:07:51,370
recover all<font color="#CCCCCC"> this information</font><font color="#E5E5E5"> without</font>

209
00:07:46,779 --> 00:07:52,840
<font color="#E5E5E5">needing any of those devices now we'll</font>

210
00:07:51,370 --> 00:07:54,729
talk<font color="#E5E5E5"> about that in more detail but</font><font color="#CCCCCC"> a</font>

211
00:07:52,840 --> 00:07:56,529
feature<font color="#E5E5E5"> like this tends to</font><font color="#CCCCCC"> be very much</font>

212
00:07:54,729 --> 00:07:58,150
at<font color="#E5E5E5"> odds with end-to-end encryption</font>

213
00:07:56,529 --> 00:08:00,909
<font color="#E5E5E5">because you're supposed to need one of</font>

214
00:07:58,150 --> 00:08:02,560
<font color="#E5E5E5">those devices</font><font color="#CCCCCC"> to get</font><font color="#E5E5E5"> that data so</font>

215
00:08:00,909 --> 00:08:04,930
there's some interesting mechanisms

216
00:08:02,560 --> 00:08:07,180
there to make this secure<font color="#E5E5E5"> and then it's</font>

217
00:08:04,930 --> 00:08:08,740
syncing so as you're updating<font color="#E5E5E5"> secrets on</font>

218
00:08:07,180 --> 00:08:11,710
your Mac they show up on<font color="#E5E5E5"> your iPhone or</font>

219
00:08:08,740 --> 00:08:16,180
<font color="#CCCCCC">your</font><font color="#E5E5E5"> iPad and that's the second feature</font>

220
00:08:11,710 --> 00:08:17,948
for this service<font color="#E5E5E5"> and recovery</font><font color="#CCCCCC"> a lot of</font>

221
00:08:16,180 --> 00:08:20,830
it hinges on<font color="#E5E5E5"> this hardware security</font>

222
00:08:17,949 --> 00:08:22,300
module based escrow system<font color="#CCCCCC"> so</font><font color="#E5E5E5"> to prevent</font>

223
00:08:20,830 --> 00:08:24,909
brute-force attacks<font color="#E5E5E5"> Apple has</font>

224
00:08:22,300 --> 00:08:26,500
specialized<font color="#CCCCCC"> hardware in all their data</font>

225
00:08:24,909 --> 00:08:29,699
centers<font color="#CCCCCC"> that interact with</font><font color="#E5E5E5"> iCloud</font>

226
00:08:26,500 --> 00:08:31,719
<font color="#E5E5E5">keychain and</font><font color="#CCCCCC"> this specialized</font><font color="#E5E5E5"> hardware</font>

227
00:08:29,699 --> 00:08:34,779
prevents<font color="#CCCCCC"> brute force attacks because in</font>

228
00:08:31,719 --> 00:08:36,130
there they have<font color="#E5E5E5"> Hardware counters that</font>

229
00:08:34,779 --> 00:08:39,279
limit the number of<font color="#CCCCCC"> temps</font><font color="#E5E5E5"> that can</font>

230
00:08:36,130 --> 00:08:41,049
happen<font color="#E5E5E5"> so it's I don't remember the</font>

231
00:08:39,279 --> 00:08:42,760
exact use but something like after

232
00:08:41,049 --> 00:08:44,439
<font color="#CCCCCC">twenty eight tenths the data will be</font>

233
00:08:42,760 --> 00:08:46,800
<font color="#CCCCCC">wiped and it's gone and those secrets</font>

234
00:08:44,440 --> 00:08:49,750
<font color="#E5E5E5">are lost forever</font>

235
00:08:46,800 --> 00:08:52,329
<font color="#CCCCCC">another thing is SMS verification so we</font>

236
00:08:49,750 --> 00:08:54,560
know SMS isn't the most secure thing<font color="#CCCCCC"> we</font>

237
00:08:52,329 --> 00:08:57,279
know<font color="#E5E5E5"> a nation-state actors</font>

238
00:08:54,560 --> 00:08:59,630
get<font color="#CCCCCC"> SIM card manufacturers and telcos</font>

239
00:08:57,279 --> 00:09:04,610
but it does certainly<font color="#E5E5E5"> increase the</font>

240
00:08:59,630 --> 00:09:07,610
<font color="#CCCCCC">tacker cost and you</font><font color="#E5E5E5"> you also need</font>

241
00:09:04,610 --> 00:09:09,980
<font color="#E5E5E5">additional passwords so separate</font><font color="#CCCCCC"> from</font>

242
00:09:07,610 --> 00:09:11,210
the iCloud password<font color="#CCCCCC"> when you</font><font color="#E5E5E5"> set up</font>

243
00:09:09,980 --> 00:09:12,980
iCloud keychain you get something<font color="#CCCCCC"> called</font>

244
00:09:11,210 --> 00:09:14,510
<font color="#CCCCCC">an iCloud security code it's an</font>

245
00:09:12,980 --> 00:09:18,290
additional password that's<font color="#E5E5E5"> needed</font><font color="#CCCCCC"> for</font>

246
00:09:14,510 --> 00:09:19,460
this or if you're using<font color="#E5E5E5"> two-factor it's</font>

247
00:09:18,290 --> 00:09:20,870
a little bit<font color="#E5E5E5"> different and instead you</font>

248
00:09:19,460 --> 00:09:25,450
<font color="#E5E5E5">need one</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> your other devices</font><font color="#CCCCCC"> pass</font>

249
00:09:20,870 --> 00:09:27,560
<font color="#E5E5E5">codes and you might think</font><font color="#CCCCCC"> okay well</font>

250
00:09:25,450 --> 00:09:29,300
that's a<font color="#E5E5E5"> little bit risky because you're</font>

251
00:09:27,560 --> 00:09:31,369
still<font color="#E5E5E5"> sending your password so what's</font>

252
00:09:29,300 --> 00:09:34,160
the prevent a<font color="#CCCCCC"> man-in-the-middle during</font>

253
00:09:31,370 --> 00:09:36,320
the recovery<font color="#E5E5E5"> process that's hard to do</font>

254
00:09:34,160 --> 00:09:39,050
<font color="#E5E5E5">correctly well</font><font color="#CCCCCC"> Apple</font><font color="#E5E5E5"> also uses something</font>

255
00:09:36,320 --> 00:09:41,450
known as<font color="#CCCCCC"> secure email protocol it uses</font>

256
00:09:39,050 --> 00:09:44,170
some modular exponentiation<font color="#E5E5E5"> and hashing</font>

257
00:09:41,450 --> 00:09:47,330
sort of like<font color="#CCCCCC"> el-gamal</font><font color="#E5E5E5"> not exactly that</font>

258
00:09:44,170 --> 00:09:50,209
to do a<font color="#CCCCCC"> proof-of-work</font>

259
00:09:47,330 --> 00:09:53,089
<font color="#E5E5E5">sort of like a zero knowledge proof that</font>

260
00:09:50,210 --> 00:09:54,920
you know the password<font color="#CCCCCC"> that is in this</font>

261
00:09:53,089 --> 00:09:56,270
escrow system<font color="#CCCCCC"> but you'd never reveal to</font>

262
00:09:54,920 --> 00:09:58,729
the server<font color="#CCCCCC"> what that password is</font><font color="#E5E5E5"> and</font>

263
00:09:56,270 --> 00:10:00,410
<font color="#CCCCCC">actually the server doesn't</font><font color="#E5E5E5"> have the</font>

264
00:09:58,730 --> 00:10:02,480
password in the direct hash of the

265
00:10:00,410 --> 00:10:08,230
password<font color="#CCCCCC"> so they can't brute force</font><font color="#E5E5E5"> the</font>

266
00:10:02,480 --> 00:10:16,010
password either<font color="#CCCCCC"> using some nice math so</font>

267
00:10:08,230 --> 00:10:20,390
it seems<font color="#E5E5E5"> pretty good and let's see some</font>

268
00:10:16,010 --> 00:10:24,260
<font color="#CCCCCC">issues here with okay</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> this thinking</font>

269
00:10:20,390 --> 00:10:25,939
part so<font color="#E5E5E5"> secrets are being constantly</font>

270
00:10:24,260 --> 00:10:27,620
<font color="#E5E5E5">synced between</font><font color="#CCCCCC"> the different</font><font color="#E5E5E5"> devices and</font>

271
00:10:25,940 --> 00:10:29,270
this<font color="#E5E5E5"> is what I'm going to focus on and</font>

272
00:10:27,620 --> 00:10:31,270
go into<font color="#E5E5E5"> detail that</font><font color="#CCCCCC"> people haven't</font>

273
00:10:29,270 --> 00:10:33,500
<font color="#E5E5E5">really got into detail about before</font>

274
00:10:31,270 --> 00:10:35,839
<font color="#E5E5E5">there's</font><font color="#CCCCCC"> antenna encryption when this</font>

275
00:10:33,500 --> 00:10:37,670
thinking happens so it communicates to

276
00:10:35,839 --> 00:10:39,459
the<font color="#CCCCCC"> iCloud systems but what does</font>

277
00:10:37,670 --> 00:10:41,479
communicating is actually<font color="#E5E5E5"> encrypted data</font>

278
00:10:39,459 --> 00:10:43,339
<font color="#E5E5E5">Apple doesn't have the keys to that data</font>

279
00:10:41,480 --> 00:10:51,430
the keys are generated<font color="#E5E5E5"> on</font><font color="#CCCCCC"> the devices</font>

280
00:10:43,339 --> 00:10:51,430
<font color="#E5E5E5">and they never leave the devices</font><font color="#CCCCCC"> and</font>

281
00:10:51,760 --> 00:10:58,459
having a<font color="#E5E5E5"> little trouble with Wi-Fi in</font>

282
00:10:54,410 --> 00:11:02,199
here to do this<font color="#E5E5E5"> devices establish a</font>

283
00:10:58,459 --> 00:11:05,089
circle of<font color="#E5E5E5"> trust</font><font color="#CCCCCC"> and this circle</font><font color="#E5E5E5"> of trust</font>

284
00:11:02,200 --> 00:11:07,610
<font color="#CCCCCC">is what controls who can enter</font><font color="#E5E5E5"> the</font>

285
00:11:05,089 --> 00:11:08,430
secret<font color="#E5E5E5"> syncing and in order to join the</font>

286
00:11:07,610 --> 00:11:10,410
<font color="#CCCCCC">circle</font>

287
00:11:08,430 --> 00:11:12,089
you need approval from<font color="#CCCCCC"> one of the</font>

288
00:11:10,410 --> 00:11:14,010
<font color="#E5E5E5">devices that's already in the circle</font><font color="#CCCCCC"> or</font>

289
00:11:12,089 --> 00:11:16,230
<font color="#CCCCCC">you go with the recovery mechanisms</font>

290
00:11:14,010 --> 00:11:18,870
which requires those pass codes and<font color="#CCCCCC"> SMS</font>

291
00:11:16,230 --> 00:11:21,300
and so on<font color="#E5E5E5"> and the protocols involved</font>

292
00:11:18,870 --> 00:11:23,100
<font color="#CCCCCC">with the</font><font color="#E5E5E5"> syncing they're</font><font color="#CCCCCC"> their two major</font>

293
00:11:21,300 --> 00:11:24,959
ones<font color="#E5E5E5"> so there's one that I'll call SOS</font>

294
00:11:23,100 --> 00:11:27,290
<font color="#E5E5E5">circle this</font><font color="#CCCCCC"> is not like something you'll</font>

295
00:11:24,960 --> 00:11:30,270
<font color="#E5E5E5">find in RFC but it's a protocol that</font>

296
00:11:27,290 --> 00:11:32,310
Apple has developed in their in their

297
00:11:30,270 --> 00:11:34,290
code as a framework<font color="#CCCCCC"> for establishing a</font>

298
00:11:32,310 --> 00:11:36,390
circle of<font color="#E5E5E5"> trust between different</font>

299
00:11:34,290 --> 00:11:38,969
<font color="#E5E5E5">devices and</font><font color="#CCCCCC"> keychain SiC happens to be</font>

300
00:11:36,390 --> 00:11:40,589
one<font color="#E5E5E5"> of the applications and the second</font>

301
00:11:38,970 --> 00:11:42,240
part of that<font color="#E5E5E5"> is the off-the-record</font>

302
00:11:40,589 --> 00:11:45,630
protocol<font color="#E5E5E5"> have you guys heard of</font>

303
00:11:42,240 --> 00:11:47,430
off-the-record<font color="#CCCCCC"> so we had the fortune of</font>

304
00:11:45,630 --> 00:11:48,900
getting response from in<font color="#CCCCCC"> goldberg one of</font>

305
00:11:47,430 --> 00:11:51,660
the<font color="#E5E5E5"> authors and he was surprised to</font><font color="#CCCCCC"> find</font>

306
00:11:48,900 --> 00:11:53,130
<font color="#E5E5E5">out</font><font color="#CCCCCC"> oh T I was being used</font><font color="#E5E5E5"> here and if</font>

307
00:11:51,660 --> 00:11:55,110
you<font color="#E5E5E5"> check out that white paper and you</font>

308
00:11:53,130 --> 00:11:56,790
look up off the record<font color="#E5E5E5"> OTR you won't</font>

309
00:11:55,110 --> 00:11:58,740
find those words<font color="#E5E5E5"> in there so we're</font>

310
00:11:56,790 --> 00:12:04,650
pretty surprised to see this in<font color="#CCCCCC"> Apple's</font>

311
00:11:58,740 --> 00:12:06,930
code<font color="#CCCCCC"> and first</font><font color="#E5E5E5"> run through what SOS</font>

312
00:12:04,650 --> 00:12:08,819
<font color="#CCCCCC">Circle does</font><font color="#E5E5E5"> so there's a sign syncing</font>

313
00:12:06,930 --> 00:12:11,010
circle<font color="#E5E5E5"> so it's a blob of data being</font>

314
00:12:08,820 --> 00:12:13,620
stored<font color="#E5E5E5"> in</font><font color="#CCCCCC"> iCloud and it's signed by each</font>

315
00:12:11,010 --> 00:12:16,459
of the<font color="#CCCCCC"> devices that</font><font color="#E5E5E5"> have been trusted</font>

316
00:12:13,620 --> 00:12:19,980
<font color="#E5E5E5">and in order to</font><font color="#CCCCCC"> join this</font><font color="#E5E5E5"> you need that</font>

317
00:12:16,459 --> 00:12:21,479
<font color="#E5E5E5">iCloud credential the password and then</font>

318
00:12:19,980 --> 00:12:22,830
one of<font color="#E5E5E5"> these devices would have to</font>

319
00:12:21,480 --> 00:12:24,950
<font color="#E5E5E5">approve it</font><font color="#CCCCCC"> or you go through the</font>

320
00:12:22,830 --> 00:12:27,720
recovery path<font color="#E5E5E5"> using those</font><font color="#CCCCCC"> mechanisms and</font>

321
00:12:24,950 --> 00:12:33,150
the the math that this really hinges<font color="#E5E5E5"> on</font>

322
00:12:27,720 --> 00:12:33,750
is<font color="#E5E5E5"> 256-bit ECDSA using an s-curve</font><font color="#CCCCCC"> sect</font>

323
00:12:33,150 --> 00:12:39,300
p250

324
00:12:33,750 --> 00:12:42,330
<font color="#E5E5E5">sack</font><font color="#CCCCCC"> p</font><font color="#E5E5E5"> 256 or one</font><font color="#CCCCCC"> Bitcoin uses SEC</font><font color="#E5E5E5"> P 256</font>

325
00:12:39,300 --> 00:12:43,650
K<font color="#E5E5E5"> one and this is one that has some</font>

326
00:12:42,330 --> 00:12:47,430
constants that very paranoid

327
00:12:43,650 --> 00:12:49,650
cryptographers like<font color="#CCCCCC"> DJ be questioned but</font>

328
00:12:47,430 --> 00:12:52,229
if you're worried about this curve being

329
00:12:49,650 --> 00:12:53,880
used<font color="#E5E5E5"> in</font><font color="#CCCCCC"> iCloud keychain I probably be</font>

330
00:12:52,230 --> 00:12:57,839
more worried that<font color="#E5E5E5"> it's used in</font><font color="#CCCCCC"> kls all</font>

331
00:12:53,880 --> 00:13:00,740
<font color="#E5E5E5">over the place</font><font color="#CCCCCC"> so kind</font><font color="#E5E5E5"> of a</font><font color="#CCCCCC"> high-level</font>

332
00:12:57,839 --> 00:13:03,450
<font color="#CCCCCC">overview as explained in</font><font color="#E5E5E5"> the white paper</font>

333
00:13:00,740 --> 00:13:04,620
<font color="#E5E5E5">when this blob is created it includes</font>

334
00:13:03,450 --> 00:13:06,750
the<font color="#CCCCCC"> information</font><font color="#E5E5E5"> about all</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> different</font>

335
00:13:04,620 --> 00:13:09,180
peers<font color="#CCCCCC"> so it's got information about</font>

336
00:13:06,750 --> 00:13:13,050
<font color="#E5E5E5">device type the version of the protocol</font>

337
00:13:09,180 --> 00:13:14,459
it's on and<font color="#E5E5E5"> then the public key from</font>

338
00:13:13,050 --> 00:13:16,050
that<font color="#E5E5E5"> device</font><font color="#CCCCCC"> that was</font><font color="#E5E5E5"> generated on that</font>

339
00:13:14,459 --> 00:13:18,449
device<font color="#E5E5E5"> the private key</font><font color="#CCCCCC"> of course</font><font color="#E5E5E5"> never</font>

340
00:13:16,050 --> 00:13:21,180
leaves the device<font color="#E5E5E5"> but the public key is</font>

341
00:13:18,450 --> 00:13:22,260
there and the peer info is signed by

342
00:13:21,180 --> 00:13:24,479
that device

343
00:13:22,260 --> 00:13:26,640
and then the whole blob<font color="#E5E5E5"> is signed by the</font>

344
00:13:24,480 --> 00:13:31,080
device as well and then there's an

345
00:13:26,640 --> 00:13:32,130
interesting<font color="#E5E5E5"> addition here which which</font>

346
00:13:31,080 --> 00:13:34,950
<font color="#CCCCCC">really ties in where the user</font>

347
00:13:32,130 --> 00:13:37,880
<font color="#E5E5E5">interaction is needed the iCloud</font>

348
00:13:34,950 --> 00:13:43,200
password at the time is used to derive

349
00:13:37,880 --> 00:13:45,930
<font color="#E5E5E5">another elliptic key that</font><font color="#CCCCCC"> also signs a</font>

350
00:13:43,200 --> 00:13:48,450
circle<font color="#E5E5E5"> so you</font><font color="#CCCCCC"> need the interaction and</font>

351
00:13:45,930 --> 00:13:51,689
<font color="#CCCCCC">you need the password as well to join</font>

352
00:13:48,450 --> 00:13:52,590
the circle<font color="#E5E5E5"> so when a second device wants</font>

353
00:13:51,690 --> 00:13:55,710
to join they create an application

354
00:13:52,590 --> 00:13:57,330
ticket<font color="#CCCCCC"> that has the</font><font color="#E5E5E5"> peer info</font><font color="#CCCCCC"> again it</font>

355
00:13:55,710 --> 00:14:00,420
will have the public key of the identity

356
00:13:57,330 --> 00:14:03,930
of<font color="#CCCCCC"> that device and it will</font><font color="#E5E5E5"> be signed by</font>

357
00:14:00,420 --> 00:14:07,339
that and again with the password from

358
00:14:03,930 --> 00:14:10,380
with the key derived from the password

359
00:14:07,340 --> 00:14:12,240
<font color="#E5E5E5">when the first device approves will add</font>

360
00:14:10,380 --> 00:14:14,000
the peer info and sign it<font color="#E5E5E5"> and</font><font color="#CCCCCC"> then</font>

361
00:14:12,240 --> 00:14:17,100
something called counter signing happens

362
00:14:14,000 --> 00:14:18,480
<font color="#E5E5E5">and encounter signing if a device sees</font>

363
00:14:17,100 --> 00:14:20,160
that a device that they<font color="#CCCCCC"> trusted has</font>

364
00:14:18,480 --> 00:14:21,180
signed<font color="#E5E5E5"> the circle they'll stamp their</font>

365
00:14:20,160 --> 00:14:22,860
signature<font color="#E5E5E5"> on as well</font>

366
00:14:21,180 --> 00:14:24,689
this is<font color="#CCCCCC"> help</font><font color="#E5E5E5"> to help facilitate the</font>

367
00:14:22,860 --> 00:14:31,440
<font color="#E5E5E5">syncing</font><font color="#CCCCCC"> between all all the different</font>

368
00:14:24,690 --> 00:14:33,060
<font color="#E5E5E5">devices</font><font color="#CCCCCC"> in a seamless</font><font color="#E5E5E5"> way</font><font color="#CCCCCC"> so now when</font>

369
00:14:31,440 --> 00:14:35,610
<font color="#E5E5E5">you have a third device comes in</font><font color="#CCCCCC"> that</font>

370
00:14:33,060 --> 00:14:38,910
comes in<font color="#E5E5E5"> any of the</font><font color="#CCCCCC"> devices can now</font>

371
00:14:35,610 --> 00:14:43,440
approve it and automatically<font color="#CCCCCC"> the other</font>

372
00:14:38,910 --> 00:14:44,579
devices<font color="#E5E5E5"> will sign it</font><font color="#CCCCCC"> so this seems</font>

373
00:14:43,440 --> 00:14:46,950
pretty<font color="#CCCCCC"> ok but when you start thinking</font>

374
00:14:44,580 --> 00:14:48,960
<font color="#CCCCCC">about usability I you might see that</font>

375
00:14:46,950 --> 00:14:51,570
<font color="#CCCCCC">there are some</font><font color="#E5E5E5"> issues here for example</font>

376
00:14:48,960 --> 00:14:53,820
<font color="#CCCCCC">what happens if you're on the road at a</font>

377
00:14:51,570 --> 00:14:55,200
<font color="#CCCCCC">conference</font><font color="#E5E5E5"> you lose your phone you</font>

378
00:14:53,820 --> 00:14:57,180
didn't have your computer<font color="#E5E5E5"> with you and</font>

379
00:14:55,200 --> 00:14:59,010
you want to go<font color="#E5E5E5"> recover your stuff you</font>

380
00:14:57,180 --> 00:15:00,959
buy<font color="#CCCCCC"> and you</font><font color="#E5E5E5"> phone real quick</font><font color="#CCCCCC"> you go to</font>

381
00:14:59,010 --> 00:15:02,670
recover it<font color="#E5E5E5"> what happens to your other</font>

382
00:15:00,960 --> 00:15:05,220
<font color="#E5E5E5">devices would they be booted out or not</font>

383
00:15:02,670 --> 00:15:07,439
<font color="#E5E5E5">with what I've just described it has to</font>

384
00:15:05,220 --> 00:15:09,030
be<font color="#E5E5E5"> signed by another one</font><font color="#CCCCCC"> on devices so</font>

385
00:15:07,440 --> 00:15:10,710
it would<font color="#CCCCCC"> imply that you boot out the</font>

386
00:15:09,030 --> 00:15:13,319
others<font color="#E5E5E5"> but if you go and try this that's</font>

387
00:15:10,710 --> 00:15:15,000
<font color="#CCCCCC">not exactly what happens and I'll</font>

388
00:15:13,320 --> 00:15:17,520
explain what's actually going on in<font color="#CCCCCC"> a</font>

389
00:15:15,000 --> 00:15:19,470
<font color="#E5E5E5">minute</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> I know there's</font><font color="#CCCCCC"> a lot like all</font>

390
00:15:17,520 --> 00:15:21,420
<font color="#E5E5E5">these codes and passwords and</font><font color="#CCCCCC"> things</font>

391
00:15:19,470 --> 00:15:23,100
going<font color="#CCCCCC"> around so here's a chart that</font>

392
00:15:21,420 --> 00:15:25,110
<font color="#E5E5E5">explains</font><font color="#CCCCCC"> the different modes</font><font color="#E5E5E5"> of</font>

393
00:15:23,100 --> 00:15:27,300
operations<font color="#E5E5E5"> so there's a bit of a</font>

394
00:15:25,110 --> 00:15:29,490
difference between<font color="#E5E5E5"> having</font><font color="#CCCCCC"> to factor on</font>

395
00:15:27,300 --> 00:15:31,620
on<font color="#E5E5E5"> your phone and not having it without</font>

396
00:15:29,490 --> 00:15:35,340
two-factor to join<font color="#E5E5E5"> you just need the</font>

397
00:15:31,620 --> 00:15:36,150
<font color="#E5E5E5">Apple ID password on the device</font><font color="#CCCCCC"> that's</font>

398
00:15:35,340 --> 00:15:38,310
requesting<font color="#CCCCCC"> too</font>

399
00:15:36,150 --> 00:15:40,079
<font color="#CCCCCC">and then the other device just approves</font>

400
00:15:38,310 --> 00:15:42,150
in says yep it's<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> I trust this</font>

401
00:15:40,080 --> 00:15:44,880
device and<font color="#E5E5E5"> you enter the password</font><font color="#CCCCCC"> again</font>

402
00:15:42,150 --> 00:15:47,910
<font color="#CCCCCC">and to join without</font><font color="#E5E5E5"> it you go</font><font color="#CCCCCC"> through</font>

403
00:15:44,880 --> 00:15:50,760
the recovery path<font color="#E5E5E5"> more or less that's</font>

404
00:15:47,910 --> 00:15:52,439
<font color="#E5E5E5">where you need the SMS code and the</font>

405
00:15:50,760 --> 00:15:53,850
iCloud security code<font color="#E5E5E5"> which is something</font>

406
00:15:52,440 --> 00:15:56,700
<font color="#CCCCCC">that was set up when you rolled an</font>

407
00:15:53,850 --> 00:15:58,560
iCloud<font color="#E5E5E5"> and this lets you resort</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> a</font>

408
00:15:56,700 --> 00:16:00,330
device<font color="#CCCCCC"> without approval from</font><font color="#E5E5E5"> somewhere</font>

409
00:15:58,560 --> 00:16:04,170
<font color="#CCCCCC">and again it depends on that escrow</font>

410
00:16:00,330 --> 00:16:05,760
system<font color="#E5E5E5"> being</font><font color="#CCCCCC"> secured</font><font color="#E5E5E5"> this the second</font>

411
00:16:04,170 --> 00:16:07,949
path is if you do<font color="#CCCCCC"> have to factor in</font>

412
00:16:05,760 --> 00:16:11,010
abled<font color="#CCCCCC"> you need to go through the to FAA</font>

413
00:16:07,950 --> 00:16:12,900
approval steps and the iCloud security

414
00:16:11,010 --> 00:16:17,790
code is<font color="#E5E5E5"> swapped by one of the existing</font>

415
00:16:12,900 --> 00:16:20,040
<font color="#E5E5E5">device path codes so if</font><font color="#CCCCCC"> you look here</font>

416
00:16:17,790 --> 00:16:22,319
<font color="#CCCCCC">that there there must</font><font color="#E5E5E5"> be something else</font>

417
00:16:20,040 --> 00:16:24,300
<font color="#CCCCCC">going on to recover without booting the</font>

418
00:16:22,320 --> 00:16:27,270
<font color="#CCCCCC">other devices</font><font color="#E5E5E5"> because the identity</font><font color="#CCCCCC"> keys</font>

419
00:16:24,300 --> 00:16:31,229
don't leave the devices<font color="#E5E5E5"> but it has to</font><font color="#CCCCCC"> be</font>

420
00:16:27,270 --> 00:16:34,650
signed there<font color="#E5E5E5"> so we dug</font><font color="#CCCCCC"> into</font><font color="#E5E5E5"> exactly</font>

421
00:16:31,230 --> 00:16:36,150
what's<font color="#E5E5E5"> going on and here's some</font>

422
00:16:34,650 --> 00:16:37,590
<font color="#CCCCCC">information for the</font><font color="#E5E5E5"> documentation where</font>

423
00:16:36,150 --> 00:16:40,290
they spell<font color="#CCCCCC"> out the attributes that</font><font color="#E5E5E5"> are</font>

424
00:16:37,590 --> 00:16:43,770
<font color="#E5E5E5">set on the</font><font color="#CCCCCC"> keychain so set this device</font>

425
00:16:40,290 --> 00:16:45,900
only<font color="#E5E5E5"> I they don't get backed up to</font>

426
00:16:43,770 --> 00:16:47,880
iCloud<font color="#CCCCCC"> backup they don't go to iTunes</font>

427
00:16:45,900 --> 00:16:50,699
backup<font color="#CCCCCC"> they stay on the device they</font>

428
00:16:47,880 --> 00:16:52,950
don't leave<font color="#E5E5E5"> so it turns out that</font><font color="#CCCCCC"> there's</font>

429
00:16:50,700 --> 00:16:55,830
a hidden<font color="#CCCCCC"> peer</font><font color="#E5E5E5"> that's also not in the</font>

430
00:16:52,950 --> 00:16:57,870
white paper<font color="#E5E5E5"> and when the circles first</font>

431
00:16:55,830 --> 00:17:00,600
established this cloud peer also gets

432
00:16:57,870 --> 00:17:03,480
added in there and it has<font color="#CCCCCC"> an attribute</font>

433
00:17:00,600 --> 00:17:05,490
set for<font color="#E5E5E5"> kasich</font><font color="#CCCCCC"> atra synchronize Abul so</font>

434
00:17:03,480 --> 00:17:08,130
if you're an iOS<font color="#CCCCCC"> developer this is the</font>

435
00:17:05,490 --> 00:17:10,170
keychain attribute that<font color="#E5E5E5"> you set to get</font>

436
00:17:08,130 --> 00:17:12,209
your password<font color="#CCCCCC"> anti cloud keychain so the</font>

437
00:17:10,170 --> 00:17:14,550
private key for<font color="#E5E5E5"> this cloud peer ends up</font>

438
00:17:12,209 --> 00:17:16,200
in iCloud<font color="#E5E5E5"> keychain itself so that</font>

439
00:17:14,550 --> 00:17:19,079
<font color="#CCCCCC">implies that you can</font><font color="#E5E5E5"> get it through the</font>

440
00:17:16,200 --> 00:17:21,780
<font color="#E5E5E5">recovery mechanism so this is what the</font>

441
00:17:19,079 --> 00:17:23,819
sign sticking circle<font color="#E5E5E5"> actually</font><font color="#CCCCCC"> looks</font><font color="#E5E5E5"> like</font>

442
00:17:21,780 --> 00:17:26,639
<font color="#E5E5E5">you know in a more accurate portrayal</font>

443
00:17:23,819 --> 00:17:28,919
<font color="#CCCCCC">then</font><font color="#E5E5E5"> spelled</font><font color="#CCCCCC"> out in</font><font color="#E5E5E5"> the white paper why</font>

444
00:17:26,640 --> 00:17:31,620
not a<font color="#E5E5E5"> device is first set up there's</font>

445
00:17:28,920 --> 00:17:34,080
also this cloud peer that's there and it

446
00:17:31,620 --> 00:17:36,780
it's called out as a hidden peer in<font color="#E5E5E5"> the</font>

447
00:17:34,080 --> 00:17:38,669
code and<font color="#E5E5E5"> then if you have two devices</font>

448
00:17:36,780 --> 00:17:41,070
<font color="#CCCCCC">you have</font><font color="#E5E5E5"> the two</font><font color="#CCCCCC"> devices and then the</font>

449
00:17:38,670 --> 00:17:42,690
cloud<font color="#CCCCCC"> pair is shared there's no like new</font>

450
00:17:41,070 --> 00:17:45,570
cloud<font color="#CCCCCC"> peer for</font><font color="#E5E5E5"> each additional device</font>

451
00:17:42,690 --> 00:17:47,460
that just shared across all of them and

452
00:17:45,570 --> 00:17:48,689
as a security<font color="#E5E5E5"> researcher</font><font color="#CCCCCC"> you know you</font>

453
00:17:47,460 --> 00:17:49,929
get real excited<font color="#CCCCCC"> when you</font><font color="#E5E5E5"> find</font>

454
00:17:48,690 --> 00:17:51,399
undocumented stuff that

455
00:17:49,929 --> 00:17:53,320
be there there might be some protocol

456
00:17:51,399 --> 00:17:54,699
<font color="#E5E5E5">breaks because it seems pretty tricky</font><font color="#CCCCCC"> to</font>

457
00:17:53,320 --> 00:17:56,350
do<font color="#E5E5E5"> this correctly</font><font color="#CCCCCC"> and like where is</font><font color="#E5E5E5"> this</font>

458
00:17:54,700 --> 00:17:59,019
private<font color="#CCCCCC"> key gonna be backed up it's</font>

459
00:17:56,350 --> 00:18:00,969
already<font color="#CCCCCC"> in the cloud seems a little bit</font>

460
00:17:59,019 --> 00:18:02,470
tricky but it's mostly<font color="#CCCCCC"> okay as far</font><font color="#E5E5E5"> as I</font>

461
00:18:00,970 --> 00:18:04,570
could tell<font color="#E5E5E5"> but you can take a look and</font>

462
00:18:02,470 --> 00:18:06,460
see<font color="#CCCCCC"> if</font><font color="#E5E5E5"> you can find some</font><font color="#CCCCCC"> issues there I</font>

463
00:18:04,570 --> 00:18:09,460
don't<font color="#CCCCCC"> believe in</font><font color="#E5E5E5"> it's it's in the iCloud</font>

464
00:18:06,460 --> 00:18:11,710
backup key bags but even if you wore the

465
00:18:09,460 --> 00:18:14,259
the<font color="#CCCCCC"> keychains</font><font color="#E5E5E5"> when they get back to the</font>

466
00:18:11,710 --> 00:18:15,580
<font color="#CCCCCC">iCloud big backup can only be restored</font>

467
00:18:14,259 --> 00:18:18,610
for<font color="#E5E5E5"> the device they originated from</font>

468
00:18:15,580 --> 00:18:25,570
because they do<font color="#E5E5E5"> key wrapping with an</font><font color="#CCCCCC"> A s</font>

469
00:18:18,610 --> 00:18:27,399
key that's embedded<font color="#E5E5E5"> into iPhones</font><font color="#CCCCCC"> so they</font>

470
00:18:25,570 --> 00:18:30,189
should be<font color="#CCCCCC"> okay maybe from the Mac side</font>

471
00:18:27,399 --> 00:18:33,100
there might<font color="#CCCCCC"> be an interesting</font><font color="#E5E5E5"> angle and</font>

472
00:18:30,190 --> 00:18:34,990
then it's really<font color="#E5E5E5"> this keychain escrow</font>

473
00:18:33,100 --> 00:18:37,570
for recovery where you can get<font color="#E5E5E5"> the</font>

474
00:18:34,990 --> 00:18:40,629
private key<font color="#E5E5E5"> and that's how it's possible</font>

475
00:18:37,570 --> 00:18:42,970
<font color="#E5E5E5">to join a circle without booting out</font>

476
00:18:40,629 --> 00:18:44,980
other devices<font color="#E5E5E5"> which i think is a pretty</font>

477
00:18:42,970 --> 00:18:48,519
<font color="#E5E5E5">important protocol detail to understand</font>

478
00:18:44,980 --> 00:18:50,889
<font color="#CCCCCC">when looking at keychain syncing all</font>

479
00:18:48,519 --> 00:18:53,169
right now the OTR part so OTR is what

480
00:18:50,889 --> 00:18:54,969
provides that end-to-end encryption<font color="#E5E5E5"> and</font>

481
00:18:53,169 --> 00:18:57,129
the circle part<font color="#E5E5E5"> is what establishes that</font>

482
00:18:54,970 --> 00:18:59,379
circle of trust<font color="#CCCCCC"> and they do tie in</font>

483
00:18:57,129 --> 00:19:02,080
together so OTR provides forward secrecy

484
00:18:59,379 --> 00:19:04,928
<font color="#CCCCCC">if someone is observing traffic and</font>

485
00:19:02,080 --> 00:19:07,480
later on they get into<font color="#E5E5E5"> a device they</font><font color="#CCCCCC"> can</font>

486
00:19:04,929 --> 00:19:09,639
go look at<font color="#CCCCCC"> that past traffic and it</font>

487
00:19:07,480 --> 00:19:12,309
could the data it<font color="#E5E5E5"> also has some degree</font>

488
00:19:09,639 --> 00:19:17,860
<font color="#CCCCCC">of deniability which is not so relevant</font>

489
00:19:12,309 --> 00:19:19,570
for<font color="#E5E5E5"> iCloud keychain and OTR does</font>

490
00:19:17,860 --> 00:19:22,658
diffie-hellman with the ephemeral keys

491
00:19:19,570 --> 00:19:24,730
and then these<font color="#E5E5E5"> persistent identity keys</font>

492
00:19:22,659 --> 00:19:26,169
are what's used to verify<font color="#CCCCCC"> the peers and</font>

493
00:19:24,730 --> 00:19:28,059
those identity keys come from the

494
00:19:26,169 --> 00:19:31,179
science<font color="#CCCCCC"> sinking circle and the</font>

495
00:19:28,059 --> 00:19:33,850
encryption<font color="#E5E5E5"> is 120 bit</font><font color="#CCCCCC"> AAS</font><font color="#E5E5E5"> encounter mode</font>

496
00:19:31,179 --> 00:19:35,230
and OTR even rotates<font color="#E5E5E5"> keys to make things</font>

497
00:19:33,850 --> 00:19:38,320
like side channel attacks a lot more

498
00:19:35,230 --> 00:19:39,850
difficult to<font color="#E5E5E5"> pull off and so those were</font>

499
00:19:38,320 --> 00:19:41,668
the<font color="#CCCCCC"> protocols an</font><font color="#E5E5E5"> abstract sense but</font>

500
00:19:39,850 --> 00:19:45,279
where is this actually transmitted so

501
00:19:41,669 --> 00:19:47,499
devices talk to iCloud through at least

502
00:19:45,279 --> 00:19:49,509
two services one of<font color="#E5E5E5"> which is key value</font>

503
00:19:47,499 --> 00:19:52,629
called key value store it's just a big

504
00:19:49,509 --> 00:19:54,340
lookup table you get<font color="#E5E5E5"> about 10 megabytes</font>

505
00:19:52,629 --> 00:19:56,320
of data that you can<font color="#E5E5E5"> arbitrarily store</font>

506
00:19:54,340 --> 00:20:00,100
here<font color="#E5E5E5"> and one of the attributes is</font>

507
00:19:56,320 --> 00:20:02,049
reserved specifically for iCloud

508
00:20:00,100 --> 00:20:03,580
<font color="#E5E5E5">keychain and something third party apps</font>

509
00:20:02,049 --> 00:20:06,910
can access or modify

510
00:20:03,580 --> 00:20:09,010
and it's this<font color="#E5E5E5"> intended crip ssin</font><font color="#CCCCCC"> that</font>

511
00:20:06,910 --> 00:20:11,740
<font color="#E5E5E5">lets Apple claim that they can't access</font>

512
00:20:09,010 --> 00:20:14,020
the data<font color="#E5E5E5"> and what does the OTR key</font>

513
00:20:11,740 --> 00:20:17,410
exchange look like so<font color="#E5E5E5"> they set</font><font color="#CCCCCC"> up</font><font color="#E5E5E5"> some</font>

514
00:20:14,020 --> 00:20:20,170
diffie-hellman<font color="#E5E5E5"> and the</font><font color="#CCCCCC"> pure identity</font>

515
00:20:17,410 --> 00:20:21,850
keys from the SOS<font color="#E5E5E5"> circle or what's used</font>

516
00:20:20,170 --> 00:20:23,920
to<font color="#E5E5E5"> verify that those parameters came</font>

517
00:20:21,850 --> 00:20:25,419
from somebody that<font color="#E5E5E5"> was trusted so if</font>

518
00:20:23,920 --> 00:20:26,890
there's a<font color="#CCCCCC"> man-in-the-middle</font><font color="#E5E5E5"> attack</font><font color="#CCCCCC"> ER in</font>

519
00:20:25,420 --> 00:20:30,160
there<font color="#CCCCCC"> they can initiate</font><font color="#E5E5E5"> a diffie-hellman</font>

520
00:20:26,890 --> 00:20:32,980
key negotiation but they don't have the

521
00:20:30,160 --> 00:20:34,570
<font color="#CCCCCC">pure identity keys to sign those</font>

522
00:20:32,980 --> 00:20:36,520
parameters<font color="#E5E5E5"> so they can't prove that</font>

523
00:20:34,570 --> 00:20:40,030
<font color="#E5E5E5">they're trusted and they would be booted</font>

524
00:20:36,520 --> 00:20:41,680
out and ignored<font color="#E5E5E5"> so the security</font><font color="#CCCCCC"> of OTR</font>

525
00:20:40,030 --> 00:20:42,970
really hinges on<font color="#E5E5E5"> this key exchange</font>

526
00:20:41,680 --> 00:20:45,670
process and<font color="#CCCCCC"> that's signature</font>

527
00:20:42,970 --> 00:20:47,530
verification<font color="#E5E5E5"> and once the secure channel</font>

528
00:20:45,670 --> 00:20:49,270
<font color="#CCCCCC">is set up that's where the plaintext</font>

529
00:20:47,530 --> 00:20:51,850
<font color="#E5E5E5">password material the credit card number</font>

530
00:20:49,270 --> 00:20:54,820
is Wi-Fi passwords are transmitted

531
00:20:51,850 --> 00:20:56,290
<font color="#CCCCCC">there's nothing else beyond that</font><font color="#E5E5E5"> and one</font>

532
00:20:54,820 --> 00:20:58,659
<font color="#E5E5E5">of the things about OTR is that it</font>

533
00:20:56,290 --> 00:21:01,360
doesn't<font color="#CCCCCC"> have a group chat encryption so</font>

534
00:20:58,660 --> 00:21:03,430
actually iCloud keychain does a fan like

535
00:21:01,360 --> 00:21:05,830
a fan wise pair out negotiation which is

536
00:21:03,430 --> 00:21:07,480
a little bit noisy<font color="#CCCCCC"> but performance isn't</font>

537
00:21:05,830 --> 00:21:10,149
so important for password credentials

538
00:21:07,480 --> 00:21:12,370
because<font color="#E5E5E5"> they don't change</font><font color="#CCCCCC"> very often so</font>

539
00:21:10,150 --> 00:21:14,740
you<font color="#E5E5E5"> wouldn't necessarily want to use OTR</font>

540
00:21:12,370 --> 00:21:18,699
for<font color="#CCCCCC"> a group chat but it's fine for this</font>

541
00:21:14,740 --> 00:21:22,840
use case<font color="#E5E5E5"> and</font><font color="#CCCCCC"> quick recap of Apple's</font>

542
00:21:18,700 --> 00:21:23,920
security goals<font color="#E5E5E5"> so with what we've talked</font>

543
00:21:22,840 --> 00:21:26,050
<font color="#E5E5E5">about this is how they're able to</font>

544
00:21:23,920 --> 00:21:27,400
<font color="#E5E5E5">achieve these things so if someone</font>

545
00:21:26,050 --> 00:21:28,000
breaks into iCloud there's a rogue

546
00:21:27,400 --> 00:21:30,370
insider

547
00:21:28,000 --> 00:21:33,400
<font color="#CCCCCC">you need these identity</font><font color="#E5E5E5"> keys to set up</font>

548
00:21:30,370 --> 00:21:35,350
the OTR<font color="#E5E5E5"> exchange so it keeps people out</font>

549
00:21:33,400 --> 00:21:37,540
<font color="#E5E5E5">if you break into an iCloud account</font><font color="#CCCCCC"> and</font>

550
00:21:35,350 --> 00:21:39,580
you<font color="#CCCCCC"> can</font><font color="#E5E5E5"> start negotiating data on the</font>

551
00:21:37,540 --> 00:21:41,740
key value store again<font color="#E5E5E5"> you need those</font>

552
00:21:39,580 --> 00:21:43,480
identity<font color="#E5E5E5"> keys the private keys to</font>

553
00:21:41,740 --> 00:21:47,470
actually do a key exchange to get<font color="#E5E5E5"> the</font>

554
00:21:43,480 --> 00:21:49,210
secrets<font color="#E5E5E5"> and they're really multiple</font>

555
00:21:47,470 --> 00:21:51,460
layers of<font color="#E5E5E5"> security first of all you have</font>

556
00:21:49,210 --> 00:21:53,800
TLS<font color="#E5E5E5"> all on the outside</font><font color="#CCCCCC"> and the</font>

557
00:21:51,460 --> 00:21:56,370
communications<font color="#CCCCCC"> Thai</font><font color="#E5E5E5"> cloud then you have</font>

558
00:21:53,800 --> 00:21:59,770
the<font color="#CCCCCC"> security of the</font><font color="#E5E5E5"> server's themselves</font>

559
00:21:56,370 --> 00:22:01,780
<font color="#CCCCCC">iCloud</font><font color="#E5E5E5"> and they have all kinds</font><font color="#CCCCCC"> of</font>

560
00:21:59,770 --> 00:22:04,600
compliance regulations<font color="#E5E5E5"> it's pretty</font>

561
00:22:01,780 --> 00:22:06,670
<font color="#E5E5E5">heavy-duty stuff you can't just walk</font>

562
00:22:04,600 --> 00:22:08,409
into<font color="#E5E5E5"> to there and pull some drives and</font>

563
00:22:06,670 --> 00:22:11,560
then you have the intent encryption

564
00:22:08,410 --> 00:22:13,390
<font color="#E5E5E5">which is</font><font color="#CCCCCC"> achieved through SOS circle and</font>

565
00:22:11,560 --> 00:22:15,310
OTR<font color="#E5E5E5"> so if you're an attacker and you</font>

566
00:22:13,390 --> 00:22:17,620
want to break<font color="#E5E5E5"> into this what are your</font>

567
00:22:15,310 --> 00:22:20,020
options<font color="#E5E5E5"> so the most direct path</font>

568
00:22:17,620 --> 00:22:22,030
<font color="#E5E5E5">find some exploit send somebody a remote</font>

569
00:22:20,020 --> 00:22:23,620
jailbreak like the Pegasus exploit and

570
00:22:22,030 --> 00:22:24,970
just break<font color="#CCCCCC"> into the phone</font><font color="#E5E5E5"> and then</font><font color="#CCCCCC"> you</font>

571
00:22:23,620 --> 00:22:30,250
get<font color="#E5E5E5"> all the</font><font color="#CCCCCC"> passwords</font><font color="#E5E5E5"> that's the most</font>

572
00:22:24,970 --> 00:22:31,990
direct<font color="#E5E5E5"> route</font><font color="#CCCCCC"> and the second route is to</font>

573
00:22:30,250 --> 00:22:33,970
try<font color="#E5E5E5"> to attack this protocol itself and</font>

574
00:22:31,990 --> 00:22:36,220
to defeat the protocol you really got<font color="#E5E5E5"> to</font>

575
00:22:33,970 --> 00:22:38,350
get past two steps so<font color="#CCCCCC"> the first layer is</font>

576
00:22:36,220 --> 00:22:41,470
this outer layer with the TLS<font color="#E5E5E5"> or getting</font>

577
00:22:38,350 --> 00:22:43,300
<font color="#E5E5E5">access to the</font><font color="#CCCCCC"> iCloud account</font><font color="#E5E5E5"> or getting</font>

578
00:22:41,470 --> 00:22:44,980
into<font color="#E5E5E5"> the Apple</font><font color="#CCCCCC"> servers but even if</font>

579
00:22:43,300 --> 00:22:46,810
you've<font color="#E5E5E5"> done</font><font color="#CCCCCC"> that now you have then ten</font>

580
00:22:44,980 --> 00:22:48,460
encryption that's stopping you<font color="#CCCCCC"> so you</font>

581
00:22:46,810 --> 00:22:50,409
got to find<font color="#E5E5E5"> a flaw either with SOS</font>

582
00:22:48,460 --> 00:22:54,000
<font color="#E5E5E5">circle mechanism or you got to find a</font>

583
00:22:50,410 --> 00:22:58,080
flaw<font color="#CCCCCC"> with the OTR to actually break</font><font color="#E5E5E5"> in</font>

584
00:22:54,000 --> 00:23:01,600
<font color="#E5E5E5">and the flaws we found were with the OTR</font>

585
00:22:58,080 --> 00:23:04,560
<font color="#CCCCCC">so there was a</font><font color="#E5E5E5"> very severe cryptographic</font>

586
00:23:01,600 --> 00:23:07,240
problem with the cincture verification

587
00:23:04,560 --> 00:23:08,620
we also found memory corruption<font color="#CCCCCC"> that</font>

588
00:23:07,240 --> 00:23:11,740
could have led to remote code execution

589
00:23:08,620 --> 00:23:13,330
<font color="#E5E5E5">and a lot of both these issues were</font>

590
00:23:11,740 --> 00:23:15,790
exacerbated<font color="#CCCCCC"> by the fact that there's</font>

591
00:23:13,330 --> 00:23:18,100
<font color="#E5E5E5">been</font><font color="#CCCCCC"> no</font><font color="#E5E5E5"> TLS key pinning on the iCloud</font>

592
00:23:15,790 --> 00:23:20,950
communications<font color="#CCCCCC"> that's something that was</font>

593
00:23:18,100 --> 00:23:24,370
brought<font color="#CCCCCC"> up</font><font color="#E5E5E5"> back in 2014</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> Apple still</font>

594
00:23:20,950 --> 00:23:26,980
hasn't addressed yet<font color="#E5E5E5"> so this is where</font>

595
00:23:24,370 --> 00:23:28,360
the the crypto failure was and it was

596
00:23:26,980 --> 00:23:30,940
<font color="#E5E5E5">very similar to go to failed you guys</font>

597
00:23:28,360 --> 00:23:33,879
<font color="#E5E5E5">remember go to fail like</font><font color="#CCCCCC"> go to fail</font>

598
00:23:30,940 --> 00:23:36,070
<font color="#E5E5E5">repeated twice and semantically this bug</font>

599
00:23:33,880 --> 00:23:38,800
is actually<font color="#E5E5E5"> identical and even more</font>

600
00:23:36,070 --> 00:23:40,929
<font color="#E5E5E5">interesting is when that book came out</font>

601
00:23:38,800 --> 00:23:44,290
<font color="#E5E5E5">this used to be in the same code project</font>

602
00:23:40,930 --> 00:23:47,680
<font color="#E5E5E5">so people running static analysis tools</font>

603
00:23:44,290 --> 00:23:51,070
they failed<font color="#E5E5E5"> to find this bug</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> we'll</font>

604
00:23:47,680 --> 00:23:54,190
go through<font color="#CCCCCC"> the</font><font color="#E5E5E5"> code real</font><font color="#CCCCCC"> quick see if</font>

605
00:23:51,070 --> 00:23:56,200
<font color="#CCCCCC">you can spot it</font><font color="#E5E5E5"> while I'm talking so</font>

606
00:23:54,190 --> 00:23:59,650
this is a function called<font color="#CCCCCC"> SEC verify</font>

607
00:23:56,200 --> 00:24:01,210
signature and Mac<font color="#E5E5E5"> and it's responsible</font>

608
00:23:59,650 --> 00:24:03,040
for<font color="#CCCCCC"> going through extracting the</font>

609
00:24:01,210 --> 00:24:05,710
signature off the wire from the packet

610
00:24:03,040 --> 00:24:07,629
and then crunching some numbers running

611
00:24:05,710 --> 00:24:09,820
<font color="#E5E5E5">the math and seeing if the signature on</font>

612
00:24:07,630 --> 00:24:12,370
<font color="#E5E5E5">the parameters adds up and they are who</font>

613
00:24:09,820 --> 00:24:14,169
they<font color="#CCCCCC"> say they are it returns a result</font>

614
00:24:12,370 --> 00:24:16,389
code saying whether<font color="#E5E5E5"> or not the signature</font>

615
00:24:14,170 --> 00:24:21,760
was correct<font color="#CCCCCC"> and it also sets up</font><font color="#E5E5E5"> the</font>

616
00:24:16,390 --> 00:24:26,170
diffie-hellman key<font color="#CCCCCC"> so on this line they</font>

617
00:24:21,760 --> 00:24:29,830
reset through<font color="#E5E5E5"> the result code to success</font>

618
00:24:26,170 --> 00:24:31,330
when<font color="#E5E5E5"> it just extracts a few</font><font color="#CCCCCC"> 4 bytes off</font>

619
00:24:29,830 --> 00:24:33,100
the wire

620
00:24:31,330 --> 00:24:35,830
now if something<font color="#E5E5E5"> goes</font><font color="#CCCCCC"> wrong they have</font><font color="#E5E5E5"> to</font>

621
00:24:33,100 --> 00:24:38,769
reset<font color="#CCCCCC"> there is a result code and say</font>

622
00:24:35,830 --> 00:24:43,570
that something<font color="#CCCCCC"> went wrong otherwise</font><font color="#E5E5E5"> it</font>

623
00:24:38,769 --> 00:24:47,289
will it could fail quite horribly like

624
00:24:43,570 --> 00:24:49,629
on this line<font color="#E5E5E5"> where it just goes to the</font>

625
00:24:47,289 --> 00:24:52,239
exit routine<font color="#E5E5E5"> with the error code still</font>

626
00:24:49,629 --> 00:24:53,408
remaining as successful without<font color="#E5E5E5"> actually</font>

627
00:24:52,239 --> 00:25:00,220
<font color="#E5E5E5">doing the signature check it just</font>

628
00:24:53,409 --> 00:25:03,460
<font color="#CCCCCC">bypasses it completely so this is a a</font>

629
00:25:00,220 --> 00:25:06,999
really<font color="#CCCCCC"> like terrible</font><font color="#E5E5E5"> way to write C code</font>

630
00:25:03,460 --> 00:25:08,499
with macros like this<font color="#CCCCCC"> just really</font>

631
00:25:06,999 --> 00:25:11,859
shouldn't<font color="#E5E5E5"> do</font><font color="#CCCCCC"> anything like</font><font color="#E5E5E5"> this anywhere</font>

632
00:25:08,499 --> 00:25:14,499
<font color="#E5E5E5">near crypto and it it's quite trivial</font>

633
00:25:11,859 --> 00:25:18,220
<font color="#CCCCCC">and it lets you bypass the signature</font>

634
00:25:14,499 --> 00:25:20,619
verification completely<font color="#CCCCCC"> when we were</font>

635
00:25:18,220 --> 00:25:23,129
verifying this this looks a lot<font color="#E5E5E5"> like bug</font>

636
00:25:20,619 --> 00:25:25,509
doors you know so it was kind of fun<font color="#CCCCCC"> and</font>

637
00:25:23,129 --> 00:25:28,418
<font color="#E5E5E5">our trigger</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> smallest trigger we</font>

638
00:25:25,509 --> 00:25:31,600
<font color="#E5E5E5">could make was about 32 bytes for</font>

639
00:25:28,419 --> 00:25:33,279
fooling the signature check<font color="#E5E5E5"> and you can</font>

640
00:25:31,600 --> 00:25:36,189
see it<font color="#CCCCCC"> on the bottom left there some</font>

641
00:25:33,279 --> 00:25:37,509
<font color="#E5E5E5">base64 with the OTR message so something</font>

642
00:25:36,190 --> 00:25:39,399
like<font color="#E5E5E5"> this</font><font color="#CCCCCC"> would come across</font><font color="#E5E5E5"> the wire</font>

643
00:25:37,509 --> 00:25:41,710
<font color="#CCCCCC">after sending</font><font color="#E5E5E5"> the initial diffie-hellman</font>

644
00:25:39,399 --> 00:25:44,498
messages and this would<font color="#E5E5E5"> just bypass the</font>

645
00:25:41,710 --> 00:25:49,029
signature check<font color="#E5E5E5"> and then someone could</font>

646
00:25:44,499 --> 00:25:50,230
start negotiating<font color="#E5E5E5"> secrets and if you</font>

647
00:25:49,029 --> 00:25:52,929
think<font color="#E5E5E5"> about OTR because it's an</font>

648
00:25:50,230 --> 00:25:54,389
ephemeral key exchange<font color="#CCCCCC"> this is</font><font color="#E5E5E5"> all you</font>

649
00:25:52,929 --> 00:25:57,399
<font color="#E5E5E5">need to get into that</font><font color="#CCCCCC"> channel the</font>

650
00:25:54,389 --> 00:26:00,428
<font color="#CCCCCC">long-term identity keys that stick on</font>

651
00:25:57,399 --> 00:26:03,699
the device you<font color="#CCCCCC"> don't need those at all</font>

652
00:26:00,429 --> 00:26:05,470
<font color="#E5E5E5">and this attack is also</font><font color="#CCCCCC"> silent</font><font color="#E5E5E5"> there's</font>

653
00:26:03,700 --> 00:26:06,999
no kind of user notification if you look

654
00:26:05,470 --> 00:26:09,700
up the sign<font color="#E5E5E5"> singing circle there's been</font>

655
00:26:06,999 --> 00:26:12,549
no modification there<font color="#E5E5E5"> and it's also</font><font color="#CCCCCC"> 100%</font>

656
00:26:09,700 --> 00:26:14,470
<font color="#CCCCCC">reliable so it's a it's a great</font><font color="#E5E5E5"> bug if</font>

657
00:26:12,549 --> 00:26:17,739
you're a rogue attacker<font color="#E5E5E5"> on an apple</font>

658
00:26:14,470 --> 00:26:20,499
server and this<font color="#E5E5E5"> really undermined a lot</font>

659
00:26:17,739 --> 00:26:22,869
of their antenna encryption goals which

660
00:26:20,499 --> 00:26:26,350
are sort<font color="#E5E5E5"> of important</font>

661
00:26:22,869 --> 00:26:29,709
we also found<font color="#E5E5E5"> an additional flaw with</font>

662
00:26:26,350 --> 00:26:31,959
the way they're handling<font color="#CCCCCC"> stack memory if</font>

663
00:26:29,710 --> 00:26:35,109
<font color="#E5E5E5">you sent a very packed with a very large</font>

664
00:26:31,960 --> 00:26:38,259
size<font color="#E5E5E5"> it will overlap into the stack of</font>

665
00:26:35,109 --> 00:26:39,309
an adjacent<font color="#CCCCCC"> thread and since we reported</font>

666
00:26:38,259 --> 00:26:40,629
<font color="#E5E5E5">this there's some great research by</font>

667
00:26:39,309 --> 00:26:42,450
Wallace<font color="#E5E5E5"> where they really</font><font color="#CCCCCC"> talked about</font>

668
00:26:40,629 --> 00:26:44,750
<font color="#E5E5E5">this bug class so if you're</font><font color="#CCCCCC"> into C</font>

669
00:26:42,450 --> 00:26:48,260
definitely<font color="#CCCCCC"> look that up to</font><font color="#E5E5E5"> learn</font>

670
00:26:44,750 --> 00:26:50,510
about<font color="#E5E5E5"> stack clash vulnerabilities</font><font color="#CCCCCC"> and</font>

671
00:26:48,260 --> 00:26:52,460
this could have led to sandbox escape

672
00:26:50,510 --> 00:26:53,690
from what happened<font color="#E5E5E5"> to</font><font color="#CCCCCC"> sect D</font><font color="#E5E5E5"> again</font>

673
00:26:52,460 --> 00:26:56,360
that's where all the<font color="#CCCCCC"> keychain</font><font color="#E5E5E5"> secrets</font>

674
00:26:53,690 --> 00:26:59,930
are so pretty<font color="#CCCCCC"> good</font><font color="#E5E5E5"> Damon to break into</font>

675
00:26:56,360 --> 00:27:01,459
on iOS it's remotely<font color="#CCCCCC"> trick Google it is</font>

676
00:26:59,930 --> 00:27:03,380
very tricky to exploit though<font color="#E5E5E5"> because</font>

677
00:27:01,460 --> 00:27:05,900
<font color="#CCCCCC">you're racing between hitting the guard</font>

678
00:27:03,380 --> 00:27:07,790
page<font color="#E5E5E5"> between the two stacks and the</font>

679
00:27:05,900 --> 00:27:10,820
<font color="#CCCCCC">Jason thread actually</font><font color="#E5E5E5"> activating the</font>

680
00:27:07,790 --> 00:27:11,990
stack frame you corrupted so this

681
00:27:10,820 --> 00:27:14,510
category<font color="#CCCCCC"> of</font><font color="#E5E5E5"> bugs</font>

682
00:27:11,990 --> 00:27:20,480
it is definitely exploitable<font color="#CCCCCC"> but not in</font>

683
00:27:14,510 --> 00:27:22,820
a reliable fashion<font color="#E5E5E5"> so we'll wrap up real</font>

684
00:27:20,480 --> 00:27:24,530
quick one of them it's actually<font color="#CCCCCC"> quite</font>

685
00:27:22,820 --> 00:27:28,189
exciting to<font color="#E5E5E5"> see</font><font color="#CCCCCC"> antenna encryption used</font>

686
00:27:24,530 --> 00:27:29,810
by a very large<font color="#E5E5E5"> company</font><font color="#CCCCCC"> because it's one</font>

687
00:27:28,190 --> 00:27:34,400
<font color="#E5E5E5">of the best ways to have privacy for</font>

688
00:27:29,810 --> 00:27:35,810
people<font color="#E5E5E5"> and it's quite bold I think to</font>

689
00:27:34,400 --> 00:27:37,370
have<font color="#CCCCCC"> intend encryption because it's also</font>

690
00:27:35,810 --> 00:27:40,520
an<font color="#E5E5E5"> easy way</font><font color="#CCCCCC"> to lock people</font><font color="#E5E5E5"> out of their</font>

691
00:27:37,370 --> 00:27:46,129
data<font color="#E5E5E5"> and</font><font color="#CCCCCC"> recover the keychain sync</font>

692
00:27:40,520 --> 00:27:49,129
protocol and<font color="#E5E5E5"> OTR flaw reflecting on our</font>

693
00:27:46,130 --> 00:27:50,540
on<font color="#CCCCCC"> the security industry</font><font color="#E5E5E5"> I think this</font>

694
00:27:49,130 --> 00:27:53,540
should have really been found after<font color="#CCCCCC"> goto</font>

695
00:27:50,540 --> 00:27:55,940
fail so all<font color="#E5E5E5"> the people are invested in</font>

696
00:27:53,540 --> 00:27:57,379
static analysis<font color="#CCCCCC"> tools</font><font color="#E5E5E5"> around that time</font>

697
00:27:55,940 --> 00:27:59,330
<font color="#E5E5E5">thinking you know we should we</font><font color="#CCCCCC"> should</font>

698
00:27:57,380 --> 00:28:01,490
catch the<font color="#E5E5E5"> easy bugs they should have</font>

699
00:27:59,330 --> 00:28:03,290
<font color="#CCCCCC">probably caught</font><font color="#E5E5E5"> this one because</font>

700
00:28:01,490 --> 00:28:04,580
semantically it's very very<font color="#E5E5E5"> similar</font><font color="#CCCCCC"> I</font>

701
00:28:03,290 --> 00:28:08,500
don't<font color="#E5E5E5"> think you can find it with grep</font>

702
00:28:04,580 --> 00:28:10,310
you need to do<font color="#E5E5E5"> actual static analysis</font>

703
00:28:08,500 --> 00:28:12,110
<font color="#CCCCCC">another thing</font><font color="#E5E5E5"> that I would say is I</font>

704
00:28:10,310 --> 00:28:14,179
think<font color="#E5E5E5"> we</font><font color="#CCCCCC"> need a lot more transparency</font>

705
00:28:12,110 --> 00:28:15,620
into how protocols work so some

706
00:28:14,180 --> 00:28:17,060
companies<font color="#CCCCCC"> are trying</font><font color="#E5E5E5"> their best they</font>

707
00:28:15,620 --> 00:28:18,649
<font color="#CCCCCC">published white papers they actually go</font>

708
00:28:17,060 --> 00:28:20,929
into protocol details<font color="#E5E5E5"> and that's great I</font>

709
00:28:18,650 --> 00:28:23,240
<font color="#E5E5E5">think Apple maybe didn't deliver on the</font>

710
00:28:20,930 --> 00:28:25,370
transparency here<font color="#E5E5E5"> because there's a lot</font>

711
00:28:23,240 --> 00:28:26,840
<font color="#CCCCCC">of info in</font><font color="#E5E5E5"> that white paper but it would</font>

712
00:28:25,370 --> 00:28:28,939
be nice if<font color="#E5E5E5"> companies published very</font>

713
00:28:26,840 --> 00:28:31,850
detailed protocols when they roll their

714
00:28:28,940 --> 00:28:33,230
own crypto<font color="#E5E5E5"> and if you're really</font>

715
00:28:31,850 --> 00:28:35,060
interested in<font color="#CCCCCC"> iCloud keychain I would</font>

716
00:28:33,230 --> 00:28:36,860
<font color="#E5E5E5">encourage you to check</font><font color="#CCCCCC"> out some of</font><font color="#E5E5E5"> the</font>

717
00:28:35,060 --> 00:28:38,929
<font color="#E5E5E5">stuff that</font><font color="#CCCCCC"> outcome</font><font color="#E5E5E5"> soft is talking</font><font color="#CCCCCC"> about</font>

718
00:28:36,860 --> 00:28:40,810
I think the<font color="#E5E5E5"> two-factor implementation</font>

719
00:28:38,930 --> 00:28:43,190
<font color="#E5E5E5">needs a little bit more more research</font>

720
00:28:40,810 --> 00:28:45,889
<font color="#E5E5E5">some of the details and there are also</font>

721
00:28:43,190 --> 00:28:48,200
not very<font color="#E5E5E5"> well documented</font><font color="#CCCCCC"> so if if I were</font>

722
00:28:45,890 --> 00:28:53,500
<font color="#E5E5E5">to spend more time</font><font color="#CCCCCC"> on this</font><font color="#E5E5E5"> this is the</font>

723
00:28:48,200 --> 00:28:57,299
<font color="#E5E5E5">first place I would</font><font color="#CCCCCC"> look thank</font><font color="#E5E5E5"> you</font>

724
00:28:53,500 --> 00:28:57,299
[Applause]

