1
00:00:00,000 --> 00:00:08,429
thank you so<font color="#E5E5E5"> I'm this long title is</font>

2
00:00:06,299 --> 00:00:11,460
mainly about active directory<font color="#E5E5E5"> assistance</font>

3
00:00:08,429 --> 00:00:13,769
<font color="#E5E5E5">and kind of like where you can hide and</font>

4
00:00:11,460 --> 00:00:18,720
where you should look for potential

5
00:00:13,769 --> 00:00:21,150
compromised<font color="#E5E5E5"> security things in active</font>

6
00:00:18,720 --> 00:00:23,070
<font color="#E5E5E5">directory so</font><font color="#CCCCCC"> we're connect</font><font color="#E5E5E5"> attackers</font>

7
00:00:21,150 --> 00:00:26,459
<font color="#CCCCCC">high</font><font color="#E5E5E5"> time Jacob</font><font color="#CCCCCC"> heidelberger work with</font>

8
00:00:23,070 --> 00:00:29,369
<font color="#E5E5E5">for consult</font><font color="#CCCCCC"> we are part of ncc group</font>

9
00:00:26,460 --> 00:00:31,619
that many of you probably know this is a

10
00:00:29,369 --> 00:00:33,870
posting exploitation talk so I'm not

11
00:00:31,619 --> 00:00:36,360
going to drop any shells

12
00:00:33,870 --> 00:00:39,000
unfortunately this is about when the

13
00:00:36,360 --> 00:00:40,680
attackers<font color="#E5E5E5"> already have gone in if you</font>

14
00:00:39,000 --> 00:00:42,180
want<font color="#E5E5E5"> to hit me on twitter if you have</font>

15
00:00:40,680 --> 00:00:44,070
some interesting ideas after this

16
00:00:42,180 --> 00:00:47,309
<font color="#E5E5E5">chocolate be very much interested in</font>

17
00:00:44,070 --> 00:00:48,930
optimizing the material with the other

18
00:00:47,309 --> 00:00:52,919
ideas

19
00:00:48,930 --> 00:00:56,789
the usual disclaimer<font color="#E5E5E5"> this is</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> my own</font>

20
00:00:52,920 --> 00:01:00,930
opinions and<font color="#CCCCCC"> abuse this talk</font><font color="#E5E5E5"> is built on</font>

21
00:00:56,789 --> 00:01:04,470
other<font color="#E5E5E5"> people's work stuff that</font><font color="#CCCCCC"> I've</font>

22
00:01:00,930 --> 00:01:06,270
<font color="#CCCCCC">reached on for some time now I've</font>

23
00:01:04,470 --> 00:01:08,939
previously worked for<font color="#CCCCCC"> microsoft and also</font>

24
00:01:06,270 --> 00:01:11,580
<font color="#CCCCCC">I'm</font><font color="#E5E5E5"> got some</font><font color="#CCCCCC"> my ideas about how this</font>

25
00:01:08,939 --> 00:01:14,759
stuff is put together and seeing some

26
00:01:11,580 --> 00:01:17,400
stuff out there in in real life incident

27
00:01:14,760 --> 00:01:22,439
response cases<font color="#CCCCCC"> too</font><font color="#E5E5E5"> and sometimes</font><font color="#CCCCCC"> i get</font><font color="#E5E5E5"> a</font>

28
00:01:17,400 --> 00:01:25,140
crazy idea to the process years is like

29
00:01:22,439 --> 00:01:28,229
thinking<font color="#CCCCCC"> a we should split our minds as</font>

30
00:01:25,140 --> 00:01:31,049
we do<font color="#CCCCCC"> mr.</font><font color="#E5E5E5"> hackers split your mind and</font>

31
00:01:28,229 --> 00:01:33,179
look at it from an evil<font color="#E5E5E5"> perspective and</font>

32
00:01:31,049 --> 00:01:35,700
office<font color="#CCCCCC"> / spent</font><font color="#E5E5E5"> perspective and then look</font>

33
00:01:33,180 --> 00:01:37,920
at it from an a<font color="#CCCCCC"> defense perspective so</font>

34
00:01:35,700 --> 00:01:40,409
kind of what<font color="#CCCCCC"> I think</font><font color="#E5E5E5"> about this talk</font>

35
00:01:37,920 --> 00:01:43,380
here is a lot of people should probably

36
00:01:40,409 --> 00:01:46,320
start thinking about<font color="#E5E5E5"> could</font><font color="#CCCCCC"> I prevent</font>

37
00:01:43,380 --> 00:01:48,600
this<font color="#CCCCCC"> could I detect this</font><font color="#E5E5E5"> and what is</font>

38
00:01:46,320 --> 00:01:51,720
that actually happened or what if it has

39
00:01:48,600 --> 00:01:57,210
already happened in my environment<font color="#CCCCCC"> what</font>

40
00:01:51,720 --> 00:01:59,189
could<font color="#CCCCCC"> i do</font><font color="#E5E5E5"> about it and yeah</font><font color="#CCCCCC"> i</font><font color="#E5E5E5"> like the</font>

41
00:01:57,210 --> 00:02:02,460
approach of living off the land

42
00:01:59,189 --> 00:02:03,740
so this is not about<font color="#CCCCCC"> mold malware this</font>

43
00:02:02,460 --> 00:02:06,710
is not<font color="#CCCCCC"> about</font>

44
00:02:03,740 --> 00:02:09,258
<font color="#E5E5E5">like back to also rats you can download</font>

45
00:02:06,710 --> 00:02:12,230
<font color="#E5E5E5">somewhere you can use frameworks to</font>

46
00:02:09,258 --> 00:02:14,630
gently<font color="#CCCCCC"> veil framework or others to</font>

47
00:02:12,230 --> 00:02:17,030
generate some malware<font color="#CCCCCC"> this is about</font>

48
00:02:14,630 --> 00:02:19,910
building functionality that is inside

49
00:02:17,030 --> 00:02:25,489
the<font color="#CCCCCC"> operating system</font><font color="#E5E5E5"> built into active</font>

50
00:02:19,910 --> 00:02:28,550
directory itself<font color="#E5E5E5"> so the scenarios that</font>

51
00:02:25,489 --> 00:02:30,590
something bad really really bad happened

52
00:02:28,550 --> 00:02:33,200
somebody<font color="#CCCCCC"> gain</font><font color="#E5E5E5"> domain at admin</font>

53
00:02:30,590 --> 00:02:35,540
permissions and<font color="#E5E5E5"> then the environment we</font>

54
00:02:33,200 --> 00:02:37,429
<font color="#E5E5E5">don't actually know what how</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> that's</font>

55
00:02:35,540 --> 00:02:40,790
<font color="#E5E5E5">actually</font><font color="#CCCCCC"> it doesn't matter for this talk</font>

56
00:02:37,430 --> 00:02:42,410
it could be<font color="#CCCCCC"> a phishing email</font><font color="#E5E5E5"> it could be</font>

57
00:02:40,790 --> 00:02:45,739
some kind of<font color="#CCCCCC"> cereal date could be</font>

58
00:02:42,410 --> 00:02:49,730
whatever<font color="#E5E5E5"> lateral movement pass the hash</font>

59
00:02:45,739 --> 00:02:55,760
whatever<font color="#E5E5E5"> so this guy he owned your</font>

60
00:02:49,730 --> 00:02:57,709
environment and maybe here maybe he's

61
00:02:55,760 --> 00:02:59,420
actually an inside on<font color="#E5E5E5"> ex-employees</font>

62
00:02:57,709 --> 00:03:01,940
something<font color="#CCCCCC"> he doesn't have to be like</font>

63
00:02:59,420 --> 00:03:06,018
that evil guy<font color="#CCCCCC"> it could</font><font color="#E5E5E5"> be some</font>

64
00:03:01,940 --> 00:03:09,500
<font color="#E5E5E5">administrator who brought home a backup</font>

65
00:03:06,019 --> 00:03:10,730
of<font color="#E5E5E5"> of</font><font color="#CCCCCC"> active directory at some point I</font>

66
00:03:09,500 --> 00:03:14,570
<font color="#E5E5E5">just to be sure</font>

67
00:03:10,730 --> 00:03:17,358
<font color="#E5E5E5">yeah</font><font color="#CCCCCC"> how many in here actually</font>

68
00:03:14,570 --> 00:03:21,500
<font color="#E5E5E5">administer active directory on a daily</font>

69
00:03:17,359 --> 00:03:24,320
basis only<font color="#CCCCCC"> if</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> how many</font><font color="#E5E5E5"> of you are</font>

70
00:03:21,500 --> 00:03:25,880
<font color="#CCCCCC">administers somebody</font><font color="#E5E5E5"> else's</font><font color="#CCCCCC"> active</font>

71
00:03:24,320 --> 00:03:26,690
<font color="#CCCCCC">directory because you</font><font color="#E5E5E5"> own them at some</font>

72
00:03:25,880 --> 00:03:31,280
point

73
00:03:26,690 --> 00:03:33,680
<font color="#CCCCCC">ok no hands well that's good</font>

74
00:03:31,280 --> 00:03:35,750
<font color="#CCCCCC">ok so this is about the</font><font color="#E5E5E5"> back doors</font><font color="#CCCCCC"> they</font>

75
00:03:33,680 --> 00:03:37,700
<font color="#E5E5E5">out there somewhere</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> don't know where</font>

76
00:03:35,750 --> 00:03:39,530
<font color="#CCCCCC">let's</font><font color="#E5E5E5"> talk about this</font>

77
00:03:37,700 --> 00:03:41,899
so the assumption is that the crown

78
00:03:39,530 --> 00:03:46,970
jewels of stolen<font color="#E5E5E5"> are in active directory</font>

79
00:03:41,900 --> 00:03:50,600
<font color="#CCCCCC">since this is the NTS NTS that did file</font>

80
00:03:46,970 --> 00:03:52,790
and the system file which is part of the

81
00:03:50,600 --> 00:03:56,090
registry<font color="#E5E5E5"> those two files combined</font>

82
00:03:52,790 --> 00:03:58,400
together will give you<font color="#E5E5E5"> hashes of old</font>

83
00:03:56,090 --> 00:04:01,280
passwords for users and computers in

84
00:03:58,400 --> 00:04:05,209
<font color="#E5E5E5">active directory if an attacker attacks</font>

85
00:04:01,280 --> 00:04:06,709
you<font color="#CCCCCC"> if he's a if you want something bad</font>

86
00:04:05,209 --> 00:04:10,370
to happen<font color="#CCCCCC"> where</font><font color="#E5E5E5"> he wants to make sure</font>

87
00:04:06,709 --> 00:04:13,000
that he owns you<font color="#CCCCCC"> real hard</font><font color="#E5E5E5"> he will make</font>

88
00:04:10,370 --> 00:04:16,930
a backup of these files

89
00:04:13,000 --> 00:04:19,660
<font color="#E5E5E5">the most common attack after this is the</font>

90
00:04:16,930 --> 00:04:23,230
<font color="#E5E5E5">golden tickets attack where you can use</font>

91
00:04:19,660 --> 00:04:25,270
a particular account<font color="#E5E5E5"> call kar</font><font color="#CCCCCC"> bt</font><font color="#E5E5E5"> how</font>

92
00:04:23,230 --> 00:04:27,670
many people<font color="#E5E5E5"> in</font><font color="#CCCCCC"> here</font><font color="#E5E5E5"> know about the</font><font color="#CCCCCC"> KBG</font>

93
00:04:25,270 --> 00:04:31,030
<font color="#CCCCCC">okay great</font>

94
00:04:27,670 --> 00:04:32,530
like half or so<font color="#CCCCCC"> that's cool so with a</font>

95
00:04:31,030 --> 00:04:35,919
hash of that one we can generate

96
00:04:32,530 --> 00:04:38,650
<font color="#CCCCCC">chickens</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> your kind of everything are</font>

97
00:04:35,920 --> 00:04:41,410
<font color="#E5E5E5">so this is the method</font><font color="#CCCCCC"> our Juice</font><font color="#E5E5E5"> these</font>

98
00:04:38,650 --> 00:04:44,140
days<font color="#CCCCCC"> 2222 take a quick backup of the</font>

99
00:04:41,410 --> 00:04:46,180
environment and get out of there<font color="#CCCCCC"> maybe</font>

100
00:04:44,140 --> 00:04:48,400
<font color="#E5E5E5">stay low for</font><font color="#CCCCCC"> a while</font>

101
00:04:46,180 --> 00:04:51,190
it's really very easy<font color="#CCCCCC"> the commander's at</font>

102
00:04:48,400 --> 00:04:53,739
the top<font color="#E5E5E5"> if you just issue that in a</font>

103
00:04:51,190 --> 00:04:55,690
single line and not like<font color="#E5E5E5"> i did</font><font color="#CCCCCC"> in the</font>

104
00:04:53,740 --> 00:04:57,730
actual<font color="#CCCCCC"> screenshot you</font><font color="#E5E5E5"> will make</font><font color="#CCCCCC"> an</font>

105
00:04:55,690 --> 00:05:00,100
install from media backup of<font color="#CCCCCC"> Active</font>

106
00:04:57,730 --> 00:05:03,220
<font color="#CCCCCC">Directory it will</font><font color="#E5E5E5"> include the system and</font>

107
00:05:00,100 --> 00:05:07,240
the security keys from registry and also

108
00:05:03,220 --> 00:05:09,910
this<font color="#CCCCCC"> NCDs that did file</font><font color="#E5E5E5"> but in real life</font>

109
00:05:07,240 --> 00:05:12,610
<font color="#E5E5E5">there's no such thing as game over</font><font color="#CCCCCC"> arm</font>

110
00:05:09,910 --> 00:05:14,860
<font color="#CCCCCC">we have</font><font color="#E5E5E5"> to we cannot come out in an</font>

111
00:05:12,610 --> 00:05:16,840
incident response and say to customers

112
00:05:14,860 --> 00:05:19,479
<font color="#CCCCCC">okay</font><font color="#E5E5E5"> they got</font><font color="#CCCCCC"> you they</font><font color="#E5E5E5"> owned you</font>

113
00:05:16,840 --> 00:05:22,000
it's done<font color="#CCCCCC"> we have to figure out a way to</font>

114
00:05:19,479 --> 00:05:25,599
<font color="#E5E5E5">to either and she rebuilt in time</font>

115
00:05:22,000 --> 00:05:28,360
<font color="#E5E5E5">environment or can we actually look</font>

116
00:05:25,600 --> 00:05:32,110
somewhere and see you know this typical

117
00:05:28,360 --> 00:05:35,500
tgp<font color="#CCCCCC"> thingy techniques taxes</font><font color="#E5E5E5"> tactics and</font>

118
00:05:32,110 --> 00:05:37,810
procedures<font color="#CCCCCC"> I don't know if</font><font color="#E5E5E5"> it's really</font><font color="#CCCCCC"> a</font>

119
00:05:35,500 --> 00:05:39,640
<font color="#CCCCCC">thing</font><font color="#E5E5E5"> it's like looking for known things</font>

120
00:05:37,810 --> 00:05:43,090
you look for things you know could

121
00:05:39,640 --> 00:05:45,669
happen is<font color="#E5E5E5"> kinda like</font><font color="#CCCCCC"> antivirus and who</font>

122
00:05:43,090 --> 00:05:49,150
in here respects<font color="#E5E5E5"> antivirus</font><font color="#CCCCCC"> i don't know</font>

123
00:05:45,669 --> 00:05:51,820
i don't<font color="#E5E5E5"> actually directly is that guy</font>

124
00:05:49,150 --> 00:05:54,039
everybody<font color="#E5E5E5"> trusts the file</font><font color="#CCCCCC"> servers</font><font color="#E5E5E5"> the</font>

125
00:05:51,820 --> 00:05:56,140
print servers the internet service

126
00:05:54,040 --> 00:06:00,760
everybody look to active directory for

127
00:05:56,140 --> 00:06:01,990
<font color="#E5E5E5">authorization of our authentication and</font>

128
00:06:00,760 --> 00:06:03,940
that's why it's so interesting with

129
00:06:01,990 --> 00:06:06,040
<font color="#E5E5E5">active directory</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> what's even more</font>

130
00:06:03,940 --> 00:06:09,460
interesting is what<font color="#E5E5E5"> active directory</font>

131
00:06:06,040 --> 00:06:13,900
itself<font color="#CCCCCC"> trust what this actual directory</font>

132
00:06:09,460 --> 00:06:15,940
actually believe in<font color="#E5E5E5"> or depend on and</font>

133
00:06:13,900 --> 00:06:17,859
there's actually a lot of things<font color="#CCCCCC"> it's</font>

134
00:06:15,940 --> 00:06:21,969
not<font color="#E5E5E5"> just about domain</font><font color="#CCCCCC"> controllers this</font>

135
00:06:17,860 --> 00:06:25,299
thing so<font color="#CCCCCC"> and when you look at this</font><font color="#E5E5E5"> it's</font>

136
00:06:21,969 --> 00:06:27,399
<font color="#CCCCCC">yeah the chains is a isn't stronger than</font>

137
00:06:25,299 --> 00:06:31,599
the weakest link

138
00:06:27,399 --> 00:06:33,489
so once you can pinpoint some of the

139
00:06:31,599 --> 00:06:35,860
dependencies of<font color="#CCCCCC"> active directory and say</font>

140
00:06:33,489 --> 00:06:38,469
<font color="#CCCCCC">I own this part or this part is</font>

141
00:06:35,860 --> 00:06:42,339
compromised<font color="#E5E5E5"> actually</font><font color="#CCCCCC"> at the entire</font>

142
00:06:38,469 --> 00:06:44,919
<font color="#CCCCCC">active electric is compromised</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> I try</font>

143
00:06:42,339 --> 00:06:47,110
to<font color="#E5E5E5"> categorize some of these finding some</font>

144
00:06:44,919 --> 00:06:48,909
of the research<font color="#E5E5E5"> here</font><font color="#CCCCCC"> some of</font><font color="#E5E5E5"> the</font>

145
00:06:47,110 --> 00:06:50,649
<font color="#E5E5E5">security dependencies and the</font>

146
00:06:48,909 --> 00:06:53,769
interdependencies<font color="#E5E5E5"> of</font><font color="#CCCCCC"> Active Directory</font>

147
00:06:50,649 --> 00:06:55,929
<font color="#CCCCCC">this is my characterization</font><font color="#E5E5E5"> it might be</font>

148
00:06:53,769 --> 00:06:58,569
wrong you can do it in other ways but in

149
00:06:55,929 --> 00:07:01,239
overall i'm looking at<font color="#E5E5E5"> access control</font>

150
00:06:58,569 --> 00:07:03,699
and<font color="#E5E5E5"> permissions domain controllers as a</font>

151
00:07:01,239 --> 00:07:08,229
separate thing<font color="#E5E5E5"> administrative practices</font>

152
00:07:03,699 --> 00:07:10,149
<font color="#CCCCCC">management service and operating system</font>

153
00:07:08,229 --> 00:07:11,619
<font color="#CCCCCC">integrity that</font><font color="#E5E5E5"> is what we have domain</font>

154
00:07:10,149 --> 00:07:13,989
controllers<font color="#E5E5E5"> and management</font><font color="#CCCCCC"> service have</font>

155
00:07:11,619 --> 00:07:16,509
in common<font color="#E5E5E5"> and then</font><font color="#CCCCCC"> Group Policy</font><font color="#E5E5E5"> objects</font>

156
00:07:13,989 --> 00:07:19,448
<font color="#E5E5E5">and the last thing is one of the things</font>

157
00:07:16,509 --> 00:07:22,239
<font color="#E5E5E5">I</font><font color="#CCCCCC"> i</font><font color="#E5E5E5"> love the</font><font color="#CCCCCC"> most</font>

158
00:07:19,449 --> 00:07:24,069
let's start with this one<font color="#CCCCCC"> explain to</font>

159
00:07:22,239 --> 00:07:27,159
<font color="#E5E5E5">your bill about the</font><font color="#CCCCCC"> Sun and she just did</font>

160
00:07:24,069 --> 00:07:29,349
fine<font color="#E5E5E5"> many people actually don't know</font>

161
00:07:27,159 --> 00:07:31,239
where<font color="#CCCCCC"> their copies of these things are</font>

162
00:07:29,349 --> 00:07:33,459
<font color="#CCCCCC">lying around it could be backups</font><font color="#E5E5E5"> it</font>

163
00:07:31,239 --> 00:07:36,549
could be<font color="#E5E5E5"> all</font><font color="#CCCCCC"> disks that could be it</font>

164
00:07:33,459 --> 00:07:37,509
I mean it could be lying around

165
00:07:36,550 --> 00:07:40,569
everywhere

166
00:07:37,509 --> 00:07:42,489
<font color="#E5E5E5">vmware snapshots also what you need to</font>

167
00:07:40,569 --> 00:07:45,849
look at<font color="#CCCCCC"> is who actually has access to</font>

168
00:07:42,489 --> 00:07:48,518
these these files because<font color="#CCCCCC"> simply</font><font color="#E5E5E5"> simply</font>

169
00:07:45,849 --> 00:07:51,699
<font color="#E5E5E5">they are actually domain admins to if</font>

170
00:07:48,519 --> 00:07:54,610
they have access to these files

171
00:07:51,699 --> 00:07:56,829
<font color="#E5E5E5">I'm instantly</font><font color="#CCCCCC"> Carrick okay BTW</font><font color="#E5E5E5"> account</font>

172
00:07:54,610 --> 00:07:58,659
before<font color="#E5E5E5"> it's a disabled account but it's</font>

173
00:07:56,829 --> 00:08:01,419
the most important<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> the master key</font>

174
00:07:58,659 --> 00:08:04,659
for the entire<font color="#CCCCCC"> Active Directory</font><font color="#E5E5E5"> this one</font>

175
00:08:01,419 --> 00:08:08,229
and it's never changed<font color="#E5E5E5"> by default</font>

176
00:08:04,659 --> 00:08:09,669
I'll get back to that<font color="#E5E5E5"> so on</font><font color="#CCCCCC"> we have</font>

177
00:08:08,229 --> 00:08:12,308
these privileged accounts<font color="#CCCCCC"> and</font><font color="#E5E5E5"> active</font>

178
00:08:09,669 --> 00:08:13,869
<font color="#CCCCCC">directory</font><font color="#E5E5E5"> we have a often service</font>

179
00:08:12,309 --> 00:08:17,949
accounts that are also privileged

180
00:08:13,869 --> 00:08:21,699
accounts<font color="#E5E5E5"> we have sometimes still shared</font>

181
00:08:17,949 --> 00:08:23,889
<font color="#E5E5E5">accounts even shared and so she had</font>

182
00:08:21,699 --> 00:08:25,119
privileged accounts which is<font color="#CCCCCC"> really</font>

183
00:08:23,889 --> 00:08:28,800
<font color="#E5E5E5">really bad idea</font>

184
00:08:25,119 --> 00:08:31,169
simple things this group membership

185
00:08:28,800 --> 00:08:34,349
<font color="#E5E5E5">is even a problem out there these days</font>

186
00:08:31,169 --> 00:08:37,289
where we<font color="#E5E5E5"> get around and see customers</font>

187
00:08:34,349 --> 00:08:39,000
that have a pretty accomplished<font color="#E5E5E5"> complex</font>

188
00:08:37,289 --> 00:08:40,529
group structure in the<font color="#CCCCCC"> kid you haven't</font>

189
00:08:39,000 --> 00:08:44,339
been able to actually figure out that<font color="#E5E5E5"> at</font>

190
00:08:40,529 --> 00:08:46,560
some point<font color="#E5E5E5"> the</font><font color="#CCCCCC"> ite group</font><font color="#E5E5E5"> became a member</font>

191
00:08:44,339 --> 00:08:48,450
of the domain admins group making

192
00:08:46,560 --> 00:08:50,760
everybody that<font color="#E5E5E5"> is dropped into the</font><font color="#CCCCCC"> IG</font>

193
00:08:48,450 --> 00:08:54,450
<font color="#E5E5E5">grouper domain admins and it's this is</font>

194
00:08:50,760 --> 00:08:56,339
very very very simple right<font color="#E5E5E5"> and also</font>

195
00:08:54,450 --> 00:08:58,320
under access controls and permissions I

196
00:08:56,339 --> 00:09:00,779
have to put in password policies and

197
00:08:58,320 --> 00:09:03,750
password strength<font color="#E5E5E5"> because if you don't</font>

198
00:09:00,779 --> 00:09:05,850
have that you don't have a secure<font color="#E5E5E5"> active</font>

199
00:09:03,750 --> 00:09:08,279
directory if you can attack the

200
00:09:05,850 --> 00:09:10,709
passwords<font color="#CCCCCC"> is three characters whatever</font>

201
00:09:08,279 --> 00:09:14,100
<font color="#CCCCCC">of course you won't have a strong and</font>

202
00:09:10,709 --> 00:09:19,109
<font color="#E5E5E5">enter and strong actual virtual security</font>

203
00:09:14,100 --> 00:09:21,000
<font color="#E5E5E5">posture so I've seen</font><font color="#CCCCCC"> IT audits and a lot</font>

204
00:09:19,110 --> 00:09:23,880
of<font color="#CCCCCC"> IT orders</font><font color="#E5E5E5"> actually they only look at</font>

205
00:09:21,000 --> 00:09:25,950
these main groups and attributed to

206
00:09:23,880 --> 00:09:28,500
<font color="#CCCCCC">maine admins enterprise</font><font color="#E5E5E5"> admin</font><font color="#CCCCCC"> scheme</font>

207
00:09:25,950 --> 00:09:30,269
admins and they look to find members of

208
00:09:28,500 --> 00:09:31,800
those groups and they actually miss some

209
00:09:30,269 --> 00:09:35,070
of the very important ones like the

210
00:09:31,800 --> 00:09:39,149
building administrators or sometimes

211
00:09:35,070 --> 00:09:39,899
even the backup operators<font color="#CCCCCC"> this is</font><font color="#E5E5E5"> very</font>

212
00:09:39,149 --> 00:09:41,970
simple

213
00:09:39,899 --> 00:09:44,310
<font color="#E5E5E5">even when scripting and trying to figure</font>

214
00:09:41,970 --> 00:09:46,860
out who who are members of the<font color="#E5E5E5"> main</font>

215
00:09:44,310 --> 00:09:49,560
admins<font color="#E5E5E5"> they will create career the wrong</font>

216
00:09:46,860 --> 00:09:51,630
field like the member of<font color="#E5E5E5"> field on a</font>

217
00:09:49,560 --> 00:09:54,270
particular user that will not include

218
00:09:51,630 --> 00:09:55,680
the primary group which could be set to

219
00:09:54,270 --> 00:09:57,449
<font color="#E5E5E5">domain admins and</font><font color="#CCCCCC"> they</font><font color="#E5E5E5"> wouldn't figure</font>

220
00:09:55,680 --> 00:09:59,910
out this<font color="#CCCCCC"> that wouldn't figure out what</font>

221
00:09:57,450 --> 00:10:03,510
the<font color="#E5E5E5"> mystic mystic groups look like</font>

222
00:09:59,910 --> 00:10:06,149
either also attack<font color="#CCCCCC"> us they know that</font>

223
00:10:03,510 --> 00:10:09,270
shouldn't drop an accountant domain

224
00:10:06,149 --> 00:10:12,149
admins but that's another thing and

225
00:10:09,270 --> 00:10:14,040
often<font color="#CCCCCC"> i also</font><font color="#E5E5E5"> find that people have a</font>

226
00:10:12,149 --> 00:10:16,529
schedule where they<font color="#E5E5E5"> look for the group's</font>

227
00:10:14,040 --> 00:10:19,140
<font color="#E5E5E5">membership has a</font><font color="#CCCCCC"> change</font><font color="#E5E5E5"> since last time</font>

228
00:10:16,529 --> 00:10:20,970
then we send an alert something that's

229
00:10:19,140 --> 00:10:23,640
not the way to do security<font color="#CCCCCC"> you should</font>

230
00:10:20,970 --> 00:10:25,410
<font color="#E5E5E5">have an alert on an event</font><font color="#CCCCCC"> base</font><font color="#E5E5E5"> you</font>

231
00:10:23,640 --> 00:10:27,120
cannot just look once in<font color="#CCCCCC"> awhile</font><font color="#E5E5E5"> because</font>

232
00:10:25,410 --> 00:10:29,640
<font color="#CCCCCC">I</font><font color="#E5E5E5"> else the</font><font color="#CCCCCC"> checkers just</font><font color="#E5E5E5"> going to go in</font>

233
00:10:27,120 --> 00:10:32,550
and out<font color="#CCCCCC"> and just</font><font color="#E5E5E5"> make an account domain</font>

234
00:10:29,640 --> 00:10:34,960
admin<font color="#CCCCCC"> do the</font><font color="#E5E5E5"> bad stuff</font><font color="#CCCCCC"> could get out</font>

235
00:10:32,550 --> 00:10:38,469
again and just<font color="#CCCCCC"> sit and wait</font><font color="#E5E5E5"> around</font>

236
00:10:34,960 --> 00:10:41,350
<font color="#E5E5E5">and</font><font color="#CCCCCC"> what's</font><font color="#E5E5E5"> getting a bit more</font>

237
00:10:38,470 --> 00:10:44,080
complicated<font color="#E5E5E5"> this computer accounts being</font>

238
00:10:41,350 --> 00:10:46,810
dropped into these<font color="#E5E5E5"> highly privileged</font>

239
00:10:44,080 --> 00:10:48,790
groups even<font color="#CCCCCC"> Microsoft sem service you</font>

240
00:10:46,810 --> 00:10:51,819
will find articles<font color="#E5E5E5"> that state that you</font>

241
00:10:48,790 --> 00:10:53,980
should just<font color="#CCCCCC"> just drop</font><font color="#E5E5E5"> them into like</font><font color="#CCCCCC"> the</font>

242
00:10:51,820 --> 00:10:56,020
<font color="#E5E5E5">domain admins and things are</font><font color="#CCCCCC"> going to go</font>

243
00:10:53,980 --> 00:10:58,720
<font color="#E5E5E5">go good for you because there they won't</font>

244
00:10:56,020 --> 00:11:00,340
have any problems accessing stuff that

245
00:10:58,720 --> 00:11:03,640
<font color="#CCCCCC">you might not</font><font color="#E5E5E5"> be the best way to do it</font>

246
00:11:00,340 --> 00:11:06,460
<font color="#E5E5E5">if you</font><font color="#CCCCCC"> only sm server it could be like</font>

247
00:11:03,640 --> 00:11:09,730
you just get the other two energy<font color="#E5E5E5"> to to</font>

248
00:11:06,460 --> 00:11:10,870
drop<font color="#CCCCCC"> a</font><font color="#E5E5E5"> local admin user on that box</font><font color="#CCCCCC"> then</font>

249
00:11:09,730 --> 00:11:14,140
you actually own<font color="#E5E5E5"> active directory</font>

250
00:11:10,870 --> 00:11:16,000
because the<font color="#CCCCCC"> sm service running a system</font>

251
00:11:14,140 --> 00:11:17,860
on a domain controllers and<font color="#CCCCCC"> i'll explain</font>

252
00:11:16,000 --> 00:11:20,980
<font color="#E5E5E5">later that actually means</font><font color="#CCCCCC"> she's that</font>

253
00:11:17,860 --> 00:11:22,810
<font color="#E5E5E5">domain</font><font color="#CCCCCC"> admin</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> I mentioned the back of</font>

254
00:11:20,980 --> 00:11:24,790
our operators this is the<font color="#CCCCCC"> backup board</font>

255
00:11:22,810 --> 00:11:27,219
operator who<font color="#E5E5E5"> is locked onto</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> domain</font>

256
00:11:24,790 --> 00:11:29,560
controller<font color="#E5E5E5"> and did a system state</font><font color="#CCCCCC"> backup</font>

257
00:11:27,220 --> 00:11:32,500
<font color="#E5E5E5">that will include the most interesting</font>

258
00:11:29,560 --> 00:11:34,209
files in<font color="#CCCCCC"> Active Directory</font><font color="#E5E5E5"> locking on and</font>

259
00:11:32,500 --> 00:11:36,790
on a console<font color="#CCCCCC"> and the main control these</font>

260
00:11:34,210 --> 00:11:39,010
days<font color="#E5E5E5"> is not as hard as it was like five</font>

261
00:11:36,790 --> 00:11:40,390
years<font color="#CCCCCC"> ten years ago because</font><font color="#E5E5E5"> at that</font>

262
00:11:39,010 --> 00:11:41,980
point you have to go down into the

263
00:11:40,390 --> 00:11:44,920
server rooms and we're in the basement

264
00:11:41,980 --> 00:11:48,550
maybe or in<font color="#CCCCCC"> Stata Center</font><font color="#E5E5E5"> these days you</font>

265
00:11:44,920 --> 00:11:51,790
have<font color="#E5E5E5"> virtual console axis so if you can</font>

266
00:11:48,550 --> 00:11:53,530
get access to the the virtual

267
00:11:51,790 --> 00:11:55,900
environment for instance<font color="#E5E5E5"> you will have</font>

268
00:11:53,530 --> 00:11:57,670
access to if you get access to the<font color="#CCCCCC"> aisle</font>

269
00:11:55,900 --> 00:12:00,520
<font color="#CCCCCC">00</font><font color="#E5E5E5"> or some other kind of</font><font color="#CCCCCC"> network</font>

270
00:11:57,670 --> 00:12:03,339
<font color="#CCCCCC">attached kvm</font><font color="#E5E5E5"> then you will have access</font>

271
00:12:00,520 --> 00:12:05,710
to<font color="#CCCCCC"> to</font><font color="#E5E5E5"> this too so there you could</font>

272
00:12:03,340 --> 00:12:09,940
combine and do some very bad<font color="#E5E5E5"> bad things</font>

273
00:12:05,710 --> 00:12:12,100
just being a<font color="#E5E5E5"> backup operator and it's</font>

274
00:12:09,940 --> 00:12:13,810
not<font color="#E5E5E5"> just about default groups and this</font>

275
00:12:12,100 --> 00:12:16,660
is one of the things<font color="#CCCCCC"> are normally</font>

276
00:12:13,810 --> 00:12:19,689
<font color="#CCCCCC">torture idea</font><font color="#E5E5E5"> auditors about they tend to</font>

277
00:12:16,660 --> 00:12:22,000
look a lot of<font color="#E5E5E5"> and</font><font color="#CCCCCC"> the group stuff but</font>

278
00:12:19,690 --> 00:12:23,410
you have something called delegation<font color="#E5E5E5"> in</font>

279
00:12:22,000 --> 00:12:25,450
<font color="#CCCCCC">active directory</font><font color="#E5E5E5"> you can right-click the</font>

280
00:12:23,410 --> 00:12:29,079
domain and delegate kind of like

281
00:12:25,450 --> 00:12:31,720
anything any permission any right to<font color="#E5E5E5"> to</font>

282
00:12:29,080 --> 00:12:33,880
appeal to some user counter<font color="#CCCCCC"> it could be</font>

283
00:12:31,720 --> 00:12:37,510
a user could be a group it could<font color="#CCCCCC"> because</font>

284
00:12:33,880 --> 00:12:40,150
<font color="#CCCCCC">I'm a computer even</font><font color="#E5E5E5"> and that's actually</font>

285
00:12:37,510 --> 00:12:42,760
a very efficient way these days to hide

286
00:12:40,150 --> 00:12:44,980
out as an<font color="#E5E5E5"> attacker because really nobody</font>

287
00:12:42,760 --> 00:12:47,620
looks<font color="#E5E5E5"> there nobody knows what it should</font>

288
00:12:44,980 --> 00:12:49,510
look like and nobody actually<font color="#CCCCCC"> it</font>

289
00:12:47,620 --> 00:12:52,510
<font color="#E5E5E5">there's to mess around with it because</font>

290
00:12:49,510 --> 00:12:55,270
it looks really really really dangerous

291
00:12:52,510 --> 00:12:57,939
<font color="#E5E5E5">so the idea</font><font color="#CCCCCC"> of when he prefers to leave</font>

292
00:12:55,270 --> 00:13:03,910
it just<font color="#CCCCCC"> this</font>

293
00:12:57,940 --> 00:13:06,370
<font color="#E5E5E5">yeah</font><font color="#CCCCCC"> actually</font><font color="#E5E5E5"> relies on some</font>

294
00:13:03,910 --> 00:13:08,469
authentication of<font color="#CCCCCC"> course authorization</font>

295
00:13:06,370 --> 00:13:09,940
mechanisms<font color="#E5E5E5"> we talked about characters</font>

296
00:13:08,470 --> 00:13:12,070
and the<font color="#E5E5E5"> chickens for training with the</font>

297
00:13:09,940 --> 00:13:13,660
golden ticket<font color="#E5E5E5"> there are also tons of</font>

298
00:13:12,070 --> 00:13:14,320
silver<font color="#E5E5E5"> chickens</font><font color="#CCCCCC"> i'm not</font><font color="#E5E5E5"> going to go into</font>

299
00:13:13,660 --> 00:13:17,560
this

300
00:13:14,320 --> 00:13:20,500
<font color="#CCCCCC">there are over pass</font><font color="#E5E5E5"> the hash tickets you</font>

301
00:13:17,560 --> 00:13:23,890
can<font color="#E5E5E5"> have something that</font><font color="#CCCCCC"> was overlooked a</font>

302
00:13:20,500 --> 00:13:27,040
lot<font color="#E5E5E5"> these days is</font><font color="#CCCCCC"> curtis</font><font color="#E5E5E5"> delegation</font><font color="#CCCCCC"> so</font>

303
00:13:23,890 --> 00:13:29,260
on a user account you can have the<font color="#CCCCCC"> the</font>

304
00:13:27,040 --> 00:13:31,510
<font color="#CCCCCC">the</font><font color="#E5E5E5"> account being interrogated like</font>

305
00:13:29,260 --> 00:13:35,350
unconstrained delegation<font color="#E5E5E5"> where it's</font>

306
00:13:31,510 --> 00:13:37,450
actually able to impersonate<font color="#CCCCCC"> a</font><font color="#E5E5E5"> user that</font>

307
00:13:35,350 --> 00:13:39,130
authenticates to it so if you get<font color="#CCCCCC"> in</font><font color="#E5E5E5"> a</font>

308
00:13:37,450 --> 00:13:41,050
<font color="#E5E5E5">domain admin to authenticate you</font>

309
00:13:39,130 --> 00:13:43,570
computer<font color="#E5E5E5"> computer you</font><font color="#CCCCCC"> can do this by</font>

310
00:13:41,050 --> 00:13:45,670
<font color="#CCCCCC">Dennis was poisoning of spoofing</font>

311
00:13:43,570 --> 00:13:49,270
whatever you connect<font color="#E5E5E5"> your</font><font color="#CCCCCC"> share</font><font color="#E5E5E5"> on your</font>

312
00:13:45,670 --> 00:13:51,040
machine<font color="#E5E5E5"> you will get the ticket and you</font>

313
00:13:49,270 --> 00:13:53,290
can then from that point impersonate the

314
00:13:51,040 --> 00:13:57,130
<font color="#E5E5E5">use of because you have a like</font><font color="#CCCCCC"> added an</font>

315
00:13:53,290 --> 00:14:00,339
<font color="#E5E5E5">app</font><font color="#CCCCCC"> an</font><font color="#E5E5E5"> evil laps up that is delegated</font>

316
00:13:57,130 --> 00:14:04,029
control like this<font color="#E5E5E5"> and in my experience</font>

317
00:14:00,339 --> 00:14:06,279
nobody really looks for this do you know

318
00:14:04,029 --> 00:14:08,020
the<font color="#E5E5E5"> city's trick how many in here</font><font color="#CCCCCC"> no</font>

319
00:14:06,279 --> 00:14:12,490
thus it history trick

320
00:14:08,020 --> 00:14:15,310
<font color="#CCCCCC">okay okay</font><font color="#E5E5E5"> not that many</font><font color="#CCCCCC"> when you get a</font>

321
00:14:12,490 --> 00:14:18,370
<font color="#CCCCCC">car purrs ticket you can</font><font color="#E5E5E5"> also have a sit</font>

322
00:14:15,310 --> 00:14:20,529
history which is actually made for

323
00:14:18,370 --> 00:14:22,839
<font color="#CCCCCC">migration scenarios you get from one</font>

324
00:14:20,529 --> 00:14:25,930
domain<font color="#CCCCCC"> one forced to another another you</font>

325
00:14:22,839 --> 00:14:29,080
will have to gain<font color="#E5E5E5"> some take something</font>

326
00:14:25,930 --> 00:14:30,819
with you thus it from the<font color="#CCCCCC"> Old Forest so</font>

327
00:14:29,080 --> 00:14:32,440
you can still have indicated to resource

328
00:14:30,820 --> 00:14:34,690
in the in the<font color="#CCCCCC"> Old Forest while</font>

329
00:14:32,440 --> 00:14:39,160
immigration is going on basically<font color="#E5E5E5"> the</font>

330
00:14:34,690 --> 00:14:42,220
thing is if you can put in<font color="#E5E5E5"> a sit like</font>

331
00:14:39,160 --> 00:14:46,810
using a tool like many cats<font color="#CCCCCC"> lovely</font><font color="#E5E5E5"> tool</font>

332
00:14:42,220 --> 00:14:49,959
<font color="#CCCCCC">shout out</font><font color="#E5E5E5"> to mr.</font><font color="#CCCCCC"> Benjamin out there any</font>

333
00:14:46,810 --> 00:14:51,939
<font color="#CCCCCC">way</font><font color="#E5E5E5"> you can put in a set of forces</font><font color="#CCCCCC"> the</font>

334
00:14:49,959 --> 00:14:54,069
domain admins<font color="#CCCCCC"> or the administrator</font>

335
00:14:51,940 --> 00:14:56,320
account himself that<font color="#CCCCCC"> that's</font><font color="#E5E5E5"> 500</font>

336
00:14:54,070 --> 00:14:59,640
<font color="#CCCCCC">accountant in active</font><font color="#E5E5E5"> directory if you</font>

337
00:14:56,320 --> 00:15:01,770
just<font color="#CCCCCC"> look honest as a normal users</font>

338
00:14:59,640 --> 00:15:04,590
<font color="#CCCCCC">Nikki sent me somebody</font><font color="#E5E5E5"> whatever his name</font>

339
00:15:01,770 --> 00:15:06,750
<font color="#E5E5E5">is he looks like a normal user if you</font>

340
00:15:04,590 --> 00:15:08,940
look in the member of<font color="#CCCCCC"> checks of this guy</font>

341
00:15:06,750 --> 00:15:11,910
<font color="#E5E5E5">but you have to look really careful for</font>

342
00:15:08,940 --> 00:15:13,890
the<font color="#E5E5E5"> the</font><font color="#CCCCCC"> city's</font><font color="#E5E5E5"> history because he</font>

343
00:15:11,910 --> 00:15:16,740
actually could be<font color="#CCCCCC"> remaining and</font><font color="#E5E5E5"> remember</font>

344
00:15:13,890 --> 00:15:19,439
<font color="#E5E5E5">anyway you can have a hideout with this</font>

345
00:15:16,740 --> 00:15:24,120
trick and it's an old trick<font color="#CCCCCC"> it's like</font>

346
00:15:19,440 --> 00:15:26,430
<font color="#CCCCCC">10-15 I don't know 20</font><font color="#E5E5E5"> years old and</font>

347
00:15:24,120 --> 00:15:30,180
<font color="#CCCCCC">still</font><font color="#E5E5E5"> out there and</font><font color="#CCCCCC"> me because have a</font>

348
00:15:26,430 --> 00:15:32,130
great implementation of this and one

349
00:15:30,180 --> 00:15:35,130
thing I'm coming with here today as I

350
00:15:32,130 --> 00:15:37,920
think a new thing is is is using<font color="#CCCCCC"> smart</font>

351
00:15:35,130 --> 00:15:39,570
<font color="#CCCCCC">card logon</font><font color="#E5E5E5"> because what we're going to</font>

352
00:15:37,920 --> 00:15:41,969
look at what<font color="#E5E5E5"> what are people actually</font>

353
00:15:39,570 --> 00:15:43,470
doing when they attacked and they

354
00:15:41,970 --> 00:15:45,900
<font color="#E5E5E5">realized that</font><font color="#CCCCCC"> the start doing stuff</font>

355
00:15:43,470 --> 00:15:46,590
<font color="#E5E5E5">maybe resetting all passwords in the</font>

356
00:15:45,900 --> 00:15:49,620
domain

357
00:15:46,590 --> 00:15:51,510
<font color="#CCCCCC">I'm gonna get back to this</font><font color="#E5E5E5"> but if the</font>

358
00:15:49,620 --> 00:15:55,860
attacker<font color="#E5E5E5"> issue too smart to himself</font>

359
00:15:51,510 --> 00:15:57,810
<font color="#CCCCCC">smart headlock on</font><font color="#E5E5E5"> the only thing that he</font>

360
00:15:55,860 --> 00:15:59,730
needs<font color="#CCCCCC"> is to have</font><font color="#E5E5E5"> the user</font><font color="#CCCCCC"> principal name</font>

361
00:15:57,810 --> 00:16:01,589
on that smart card<font color="#E5E5E5"> and no matter what</font>

362
00:15:59,730 --> 00:16:03,300
the the password has been changed to

363
00:16:01,590 --> 00:16:04,860
he's still going to be able to lock on

364
00:16:03,300 --> 00:16:07,740
<font color="#CCCCCC">us that account and</font><font color="#E5E5E5"> that's the demo I</font>

365
00:16:04,860 --> 00:16:09,540
<font color="#CCCCCC">one of the demos I have</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> Dave will get</font>

366
00:16:07,740 --> 00:16:12,900
there<font color="#CCCCCC"> I even</font><font color="#E5E5E5"> see guest accounts being</font>

367
00:16:09,540 --> 00:16:14,939
enabled that means<font color="#E5E5E5"> anonymous axis almost</font>

368
00:16:12,900 --> 00:16:17,730
<font color="#CCCCCC">so you don't have to</font><font color="#E5E5E5"> give</font><font color="#CCCCCC"> in a password</font>

369
00:16:14,940 --> 00:16:20,100
to look out for this

370
00:16:17,730 --> 00:16:22,410
<font color="#E5E5E5">it's strange it shouldn't be there there</font>

371
00:16:20,100 --> 00:16:23,550
should be no guest accounts<font color="#CCCCCC"> it's just</font>

372
00:16:22,410 --> 00:16:26,910
<font color="#E5E5E5">not the way to do it</font>

373
00:16:23,550 --> 00:16:29,310
this is the<font color="#E5E5E5"> memory cats</font><font color="#CCCCCC"> if you haven't</font>

374
00:16:26,910 --> 00:16:31,020
played around with this tool<font color="#CCCCCC"> it's one of</font>

375
00:16:29,310 --> 00:16:36,239
the best tools out there and it's not

376
00:16:31,020 --> 00:16:38,460
just to see<font color="#E5E5E5"> the the</font><font color="#CCCCCC"> yeah this securely</font>

377
00:16:36,240 --> 00:16:40,590
<font color="#CCCCCC">and</font><font color="#E5E5E5"> and the privileges you have already</font>

378
00:16:38,460 --> 00:16:44,820
so many other things you can use this

379
00:16:40,590 --> 00:16:46,590
tool<font color="#E5E5E5"> to</font><font color="#CCCCCC"> did</font><font color="#E5E5E5"> you do and this is the</font>

380
00:16:44,820 --> 00:16:49,380
<font color="#E5E5E5">city's history</font><font color="#CCCCCC"> we're adding the</font><font color="#E5E5E5"> city of</font>

381
00:16:46,590 --> 00:16:50,910
the domain admins to a sexy user<font color="#E5E5E5"> from</font>

382
00:16:49,380 --> 00:16:52,740
that point even though he looks like a

383
00:16:50,910 --> 00:16:56,069
normal domain user<font color="#CCCCCC"> is actually also</font>

384
00:16:52,740 --> 00:16:58,350
<font color="#E5E5E5">domain admin this is the way to detect</font>

385
00:16:56,070 --> 00:17:02,010
it<font color="#E5E5E5"> or one way to detect it</font>

386
00:16:58,350 --> 00:17:05,730
<font color="#CCCCCC">I made a</font><font color="#E5E5E5"> small partial one-liner</font><font color="#CCCCCC"> it's a</font>

387
00:17:02,010 --> 00:17:07,680
<font color="#CCCCCC">one liner you can</font><font color="#E5E5E5"> see that but it is and</font>

388
00:17:05,730 --> 00:17:09,360
if you if you execute that<font color="#CCCCCC"> you will see</font>

389
00:17:07,680 --> 00:17:11,160
that there's something strange going on

390
00:17:09,359 --> 00:17:14,909
because this<font color="#E5E5E5"> you certainly has</font>

391
00:17:11,160 --> 00:17:16,830
<font color="#CCCCCC">a city</font><font color="#E5E5E5"> store value within that</font><font color="#CCCCCC"> what the</font>

392
00:17:14,910 --> 00:17:18,330
weather value of the domain is actually

393
00:17:16,829 --> 00:17:20,280
within the domain itself and that

394
00:17:18,329 --> 00:17:21,810
shouldn't happen<font color="#E5E5E5"> as I said some</font><font color="#CCCCCC"> merit</font>

395
00:17:20,280 --> 00:17:24,359
migration scenario should be from

396
00:17:21,810 --> 00:17:28,919
another domain<font color="#CCCCCC"> but this is one way to</font>

397
00:17:24,359 --> 00:17:30,840
detect it and a very interesting guy<font color="#E5E5E5"> at</font>

398
00:17:28,920 --> 00:17:33,780
<font color="#E5E5E5">mean SD</font><font color="#CCCCCC"> holder</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> this guy he's</font>

399
00:17:30,840 --> 00:17:37,919
holding<font color="#E5E5E5"> on to some</font><font color="#CCCCCC"> protected groups and</font>

400
00:17:33,780 --> 00:17:40,320
<font color="#E5E5E5">protected group uses accounts so</font><font color="#CCCCCC"> i will</font>

401
00:17:37,920 --> 00:17:43,500
list<font color="#E5E5E5"> them up here on the slide but he</font>

402
00:17:40,320 --> 00:17:45,960
will constantly<font color="#E5E5E5"> set permissions of these</font>

403
00:17:43,500 --> 00:17:49,170
on these objects that are<font color="#E5E5E5"> members of</font>

404
00:17:45,960 --> 00:17:52,980
these groups or<font color="#E5E5E5"> and the thing is</font>

405
00:17:49,170 --> 00:17:55,320
sometimes<font color="#CCCCCC"> admin will try to change it</font>

406
00:17:52,980 --> 00:17:57,420
back but if you actually<font color="#CCCCCC"> as an</font><font color="#E5E5E5"> attack</font>

407
00:17:55,320 --> 00:18:00,300
<font color="#CCCCCC">and manipulated the atomicity hold an</font>

408
00:17:57,420 --> 00:18:02,040
object there will be like 60 minutes

409
00:18:00,300 --> 00:18:03,510
<font color="#CCCCCC">from SF max</font><font color="#E5E5E5"> and it will</font><font color="#CCCCCC"> reapply you</font>

410
00:18:02,040 --> 00:18:06,420
could set that interval if you want

411
00:18:03,510 --> 00:18:08,700
<font color="#CCCCCC">something</font><font color="#E5E5E5"> else</font><font color="#CCCCCC"> i'm</font><font color="#E5E5E5"> i'm not encouraging</font>

412
00:18:06,420 --> 00:18:10,680
you to do that<font color="#E5E5E5"> I'm current encouraging</font>

413
00:18:08,700 --> 00:18:14,640
admins to look out for the<font color="#E5E5E5"> admin</font><font color="#CCCCCC"> st</font>

414
00:18:10,680 --> 00:18:16,890
holder<font color="#E5E5E5"> object because it's important you</font>

415
00:18:14,640 --> 00:18:18,900
<font color="#CCCCCC">can</font><font color="#E5E5E5"> control what groups should be</font>

416
00:18:16,890 --> 00:18:22,500
controlled by this you can you can set a

417
00:18:18,900 --> 00:18:24,150
value to exclude some groups<font color="#E5E5E5"> what will</font>

418
00:18:22,500 --> 00:18:25,800
actually happen<font color="#CCCCCC"> these like objects that</font>

419
00:18:24,150 --> 00:18:29,070
are<font color="#E5E5E5"> members of these groups will get the</font>

420
00:18:25,800 --> 00:18:30,990
<font color="#CCCCCC">app in</font><font color="#E5E5E5"> count equals 21 and from there</font>

421
00:18:29,070 --> 00:18:32,639
the the permissions will be<font color="#E5E5E5"> selling</font>

422
00:18:30,990 --> 00:18:36,060
those accounts to whatever you have

423
00:18:32,640 --> 00:18:37,890
configured and one interesting is the

424
00:18:36,060 --> 00:18:39,480
thing that<font color="#E5E5E5"> I think is that group policy</font>

425
00:18:37,890 --> 00:18:42,300
<font color="#CCCCCC">creator owners</font><font color="#E5E5E5"> they are not included</font>

426
00:18:39,480 --> 00:18:44,070
here<font color="#E5E5E5"> so if you can create</font><font color="#CCCCCC"> gpo's in the</font>

427
00:18:42,300 --> 00:18:48,540
domain<font color="#E5E5E5"> but you can link them but you</font>

428
00:18:44,070 --> 00:18:51,270
could create a gpo<font color="#E5E5E5"> just make another kik</font>

429
00:18:48,540 --> 00:18:54,240
account<font color="#CCCCCC"> link it and then go back into</font>

430
00:18:51,270 --> 00:18:56,190
the<font color="#E5E5E5"> group</font><font color="#CCCCCC"> policy greatest group and</font>

431
00:18:54,240 --> 00:18:57,150
modify that<font color="#CCCCCC"> DP 0 and you have like full</font>

432
00:18:56,190 --> 00:19:01,440
control

433
00:18:57,150 --> 00:19:05,550
I'll get back to that<font color="#E5E5E5"> trust is the issue</font>

434
00:19:01,440 --> 00:19:09,030
an issue for<font color="#CCCCCC"> self</font><font color="#E5E5E5"> people set up trusts</font>

435
00:19:05,550 --> 00:19:11,430
of<font color="#CCCCCC"> they're</font><font color="#E5E5E5"> like it's</font><font color="#CCCCCC"> a mic fusion</font>

436
00:19:09,030 --> 00:19:14,280
between two companies<font color="#E5E5E5"> maybe</font><font color="#CCCCCC"> it just</font><font color="#E5E5E5"> has</font>

437
00:19:11,430 --> 00:19:17,610
to go fast<font color="#CCCCCC"> so there's a full trust back</font>

438
00:19:14,280 --> 00:19:20,550
and forth and no<font color="#CCCCCC"> city-building</font><font color="#E5E5E5"> perhaps</font>

439
00:19:17,610 --> 00:19:22,949
<font color="#E5E5E5">so</font><font color="#CCCCCC"> I mean that means it's possible to</font>

440
00:19:20,550 --> 00:19:26,460
also do this city<font color="#E5E5E5"> street Rick</font>

441
00:19:22,950 --> 00:19:28,380
<font color="#E5E5E5">in that way lots of</font><font color="#CCCCCC"> ways</font><font color="#E5E5E5"> ways to abuse</font>

442
00:19:26,460 --> 00:19:30,660
<font color="#E5E5E5">trust one of the newer things that you</font>

443
00:19:28,380 --> 00:19:33,240
can with<font color="#CCCCCC"> Mema cats</font><font color="#E5E5E5"> for instance you can</font>

444
00:19:30,660 --> 00:19:36,060
actually extract the<font color="#E5E5E5"> truss key</font><font color="#CCCCCC"> into the</font>

445
00:19:33,240 --> 00:19:39,750
real key from a trust set up between two

446
00:19:36,060 --> 00:19:42,240
<font color="#E5E5E5">more domains actually two domains</font><font color="#CCCCCC"> their</font>

447
00:19:39,750 --> 00:19:45,000
individual video and you can steal that

448
00:19:42,240 --> 00:19:46,650
will normally<font color="#E5E5E5"> lasts for 30 days</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> you</font>

449
00:19:45,000 --> 00:19:49,140
can also configure this<font color="#E5E5E5"> how long time</font>

450
00:19:46,650 --> 00:19:53,520
it's gonna last<font color="#CCCCCC"> and then you can create</font>

451
00:19:49,140 --> 00:19:54,810
new tickets with the<font color="#CCCCCC"> trust</font><font color="#E5E5E5"> key itself so</font>

452
00:19:53,520 --> 00:19:57,900
that's interesting

453
00:19:54,810 --> 00:19:59,700
and another<font color="#E5E5E5"> thing</font><font color="#CCCCCC"> microsoft has</font><font color="#E5E5E5"> a great</font>

454
00:19:57,900 --> 00:20:01,410
<font color="#E5E5E5">you think</font><font color="#CCCCCC"> all microsoft local</font>

455
00:19:59,700 --> 00:20:04,320
administrator password solution<font color="#CCCCCC"> i just</font>

456
00:20:01,410 --> 00:20:06,990
look at this with the evil<font color="#CCCCCC"> it</font><font color="#E5E5E5"> switched</font>

457
00:20:04,320 --> 00:20:08,970
on and what you could do<font color="#CCCCCC"> is an attacker</font>

458
00:20:06,990 --> 00:20:11,700
would be<font color="#CCCCCC"> to to configure the permission</font>

459
00:20:08,970 --> 00:20:13,500
this is a schema extension and the

460
00:20:11,700 --> 00:20:15,570
permissions are set like microsoft

461
00:20:13,500 --> 00:20:18,330
recommends how you should set it<font color="#E5E5E5"> maybe</font>

462
00:20:15,570 --> 00:20:20,909
most people<font color="#E5E5E5"> do that way if you just</font>

463
00:20:18,330 --> 00:20:22,649
change that a bit as an attacker<font color="#CCCCCC"> so</font>

464
00:20:20,910 --> 00:20:25,410
maybe the guest account could read<font color="#CCCCCC"> the</font>

465
00:20:22,650 --> 00:20:28,050
<font color="#E5E5E5">this particular attribute</font><font color="#CCCCCC"> then you will</font>

466
00:20:25,410 --> 00:20:31,200
have actually<font color="#E5E5E5"> at access to all the local</font>

467
00:20:28,050 --> 00:20:33,360
administrator password for all machines

468
00:20:31,200 --> 00:20:36,270
in the environment<font color="#CCCCCC"> except the main</font>

469
00:20:33,360 --> 00:20:38,459
controls themselves but<font color="#CCCCCC"> I'll guarantee</font>

470
00:20:36,270 --> 00:20:40,530
you there's going to be a system that

471
00:20:38,460 --> 00:20:42,960
the the<font color="#E5E5E5"> main</font><font color="#CCCCCC"> control</font><font color="#E5E5E5"> is dependent on</font>

472
00:20:40,530 --> 00:20:45,240
that you will own<font color="#E5E5E5"> like management</font>

473
00:20:42,960 --> 00:20:48,570
<font color="#E5E5E5">service which will get back to</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> domain</font>

474
00:20:45,240 --> 00:20:50,820
controllers and<font color="#CCCCCC"> i'll get back</font><font color="#E5E5E5"> to general</font>

475
00:20:48,570 --> 00:20:54,270
operating system integrity in another

476
00:20:50,820 --> 00:20:56,070
section of this<font color="#E5E5E5"> anything that runs a</font>

477
00:20:54,270 --> 00:20:59,430
system<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the domain controller is</font>

478
00:20:56,070 --> 00:21:01,530
basically<font color="#CCCCCC"> the main admin</font><font color="#E5E5E5"> so if you have</font>

479
00:20:59,430 --> 00:21:04,020
systems out there<font color="#E5E5E5"> that are that are</font>

480
00:21:01,530 --> 00:21:07,139
running with<font color="#CCCCCC"> the</font><font color="#E5E5E5"> like</font><font color="#CCCCCC"> sm i mentioned and</font>

481
00:21:04,020 --> 00:21:11,220
<font color="#E5E5E5">survivors anything scheduled tasks</font>

482
00:21:07,140 --> 00:21:13,230
<font color="#E5E5E5">startup scripts</font><font color="#CCCCCC"> they will run with</font>

483
00:21:11,220 --> 00:21:15,510
domain admin permissions so an attacker

484
00:21:13,230 --> 00:21:17,940
could set up something running a system

485
00:21:15,510 --> 00:21:20,070
and just get out of there<font color="#CCCCCC"> he can do</font>

486
00:21:17,940 --> 00:21:21,960
<font color="#E5E5E5">anything with the</font><font color="#CCCCCC"> main really also</font>

487
00:21:20,070 --> 00:21:25,899
<font color="#E5E5E5">domain controllers rely on others if</font><font color="#CCCCCC"> one</font>

488
00:21:21,960 --> 00:21:28,810
<font color="#E5E5E5">get on</font><font color="#CCCCCC"> everybody's owned</font>

489
00:21:25,900 --> 00:21:30,340
<font color="#E5E5E5">so what if an attacker actually</font>

490
00:21:28,810 --> 00:21:33,580
introduced a new domain controller

491
00:21:30,340 --> 00:21:36,459
<font color="#E5E5E5">during the attack</font><font color="#CCCCCC"> also gone up</font><font color="#E5E5E5"> a virtual</font>

492
00:21:33,580 --> 00:21:39,550
<font color="#E5E5E5">machine from my</font><font color="#CCCCCC"> attack laptop whatever i</font>

493
00:21:36,460 --> 00:21:41,470
will negotiate with<font color="#E5E5E5"> the</font><font color="#CCCCCC"> main to become</font><font color="#E5E5E5"> a</font>

494
00:21:39,550 --> 00:21:43,810
domain<font color="#CCCCCC"> controller myself i'll start</font>

495
00:21:41,470 --> 00:21:45,940
synchronizing the<font color="#CCCCCC"> interactive directory</font>

496
00:21:43,810 --> 00:21:51,129
I'll do whatever harm harm<font color="#CCCCCC"> i want to do</font>

497
00:21:45,940 --> 00:21:52,870
and<font color="#CCCCCC"> I'll just</font><font color="#E5E5E5"> shut it down</font><font color="#CCCCCC"> and what</font>

498
00:21:51,130 --> 00:21:55,720
happened<font color="#E5E5E5"> that period is not going to be</font>

499
00:21:52,870 --> 00:21:57,310
very easy to detect because the event

500
00:21:55,720 --> 00:21:59,980
<font color="#E5E5E5">locking is happening on the on the</font>

501
00:21:57,310 --> 00:22:01,810
mission domain controller itself<font color="#E5E5E5"> so</font>

502
00:21:59,980 --> 00:22:05,080
that's<font color="#CCCCCC"> the kind of interesting scenario</font>

503
00:22:01,810 --> 00:22:06,820
so we should maybe try to detect if

504
00:22:05,080 --> 00:22:08,860
somebody answer domain controller to the

505
00:22:06,820 --> 00:22:12,399
environment and<font color="#CCCCCC"> I</font><font color="#E5E5E5"> really don't think</font>

506
00:22:08,860 --> 00:22:14,439
people would<font color="#E5E5E5"> input</font><font color="#CCCCCC"> spots such a thing</font>

507
00:22:12,400 --> 00:22:16,000
like<font color="#E5E5E5"> it's not something that's a common</font>

508
00:22:14,440 --> 00:22:18,670
to look for because people are not

509
00:22:16,000 --> 00:22:22,630
thinking with the evil evil bitch<font color="#E5E5E5"> switch</font>

510
00:22:18,670 --> 00:22:25,660
<font color="#E5E5E5">on and even active directory sync with</font>

511
00:22:22,630 --> 00:22:27,550
<font color="#CCCCCC">Asher</font><font color="#E5E5E5"> could be a potential attack vector</font>

512
00:22:25,660 --> 00:22:29,710
<font color="#E5E5E5">if somebody has access to the</font><font color="#CCCCCC"> edge</font>

513
00:22:27,550 --> 00:22:33,580
<font color="#CCCCCC">accounts just to say</font><font color="#E5E5E5"> there's a</font>

514
00:22:29,710 --> 00:22:37,990
dependency<font color="#E5E5E5"> there too</font>

515
00:22:33,580 --> 00:22:40,750
<font color="#CCCCCC">yep</font><font color="#E5E5E5"> so also the hashes</font><font color="#CCCCCC"> i mentioned its</font>

516
00:22:37,990 --> 00:22:42,910
uses hashes and computer hashes<font color="#E5E5E5"> we get</font>

517
00:22:40,750 --> 00:22:45,250
with the computer<font color="#E5E5E5"> hatches we also get</font>

518
00:22:42,910 --> 00:22:46,870
the main controller hashes and with

519
00:22:45,250 --> 00:22:49,420
those we can actually impersonate the

520
00:22:46,870 --> 00:22:53,739
main controls<font color="#CCCCCC"> there's an interesting</font><font color="#E5E5E5"> at</font>

521
00:22:49,420 --> 00:22:55,900
<font color="#E5E5E5">to love</font><font color="#CCCCCC"> their now d</font><font color="#E5E5E5"> sink from also the</font>

522
00:22:53,740 --> 00:22:57,850
<font color="#E5E5E5">same guy who wrote many cats and</font><font color="#CCCCCC"> their</font>

523
00:22:55,900 --> 00:23:02,020
<font color="#CCCCCC">section also</font><font color="#E5E5E5"> partial implementation of</font>

524
00:22:57,850 --> 00:23:04,659
this where you can<font color="#E5E5E5"> boot up on at the</font>

525
00:23:02,020 --> 00:23:06,850
script<font color="#E5E5E5"> or</font><font color="#CCCCCC"> up an application that will</font>

526
00:23:04,660 --> 00:23:08,500
start synchronizing only passwords with

527
00:23:06,850 --> 00:23:10,360
the main<font color="#E5E5E5"> domain</font><font color="#CCCCCC"> controller so we'll get</font>

528
00:23:08,500 --> 00:23:12,040
all the hashes down with<font color="#CCCCCC"> a domain</font>

529
00:23:10,360 --> 00:23:16,000
<font color="#E5E5E5">controller</font><font color="#CCCCCC"> kind of like acting another</font>

530
00:23:12,040 --> 00:23:17,590
<font color="#E5E5E5">like another domain controller and if an</font>

531
00:23:16,000 --> 00:23:20,020
attacker has all of these hashes

532
00:23:17,590 --> 00:23:21,760
<font color="#CCCCCC">normally there</font><font color="#E5E5E5"> would be reset after 30</font>

533
00:23:20,020 --> 00:23:24,580
days for computer accounts<font color="#E5E5E5"> they will</font>

534
00:23:21,760 --> 00:23:27,129
last up to 30 days<font color="#E5E5E5"> but an attacker could</font>

535
00:23:24,580 --> 00:23:29,860
also set a small change in the domain

536
00:23:27,130 --> 00:23:31,510
controller on the clients themselves to

537
00:23:29,860 --> 00:23:32,979
make sure that they will not change the

538
00:23:31,510 --> 00:23:34,530
<font color="#E5E5E5">password so we will</font><font color="#CCCCCC"> he</font><font color="#E5E5E5"> will have a</font>

539
00:23:32,980 --> 00:23:36,720
longer time with

540
00:23:34,530 --> 00:23:40,560
<font color="#E5E5E5">nice foothold in the environment</font>

541
00:23:36,720 --> 00:23:42,870
potentially so we could also<font color="#CCCCCC"> introduced</font>

542
00:23:40,560 --> 00:23:45,780
<font color="#E5E5E5">evil security support</font><font color="#CCCCCC"> provider</font>

543
00:23:42,870 --> 00:23:47,850
<font color="#E5E5E5">interfaces like</font><font color="#CCCCCC"> makassar there has two</font>

544
00:23:45,780 --> 00:23:50,010
implementations<font color="#CCCCCC"> I know</font><font color="#E5E5E5"> I said I wouldn't</font>

545
00:23:47,850 --> 00:23:52,530
talk about malware but<font color="#CCCCCC"> i really</font><font color="#E5E5E5"> don't</font>

546
00:23:50,010 --> 00:23:54,510
<font color="#E5E5E5">consider</font><font color="#CCCCCC"> mimikatz</font><font color="#E5E5E5"> malware maybe maybe</font><font color="#CCCCCC"> I</font>

547
00:23:52,530 --> 00:23:57,870
should<font color="#CCCCCC"> I don't know</font><font color="#E5E5E5"> but it's a nice tool</font>

548
00:23:54,510 --> 00:24:00,930
<font color="#E5E5E5">it can patch in memory and</font><font color="#CCCCCC"> kelso loaded</font>

549
00:23:57,870 --> 00:24:02,639
yellow on the<font color="#CCCCCC"> Box themselves and please</font>

550
00:24:00,930 --> 00:24:05,730
<font color="#CCCCCC">passwords wherever you want them to be</font>

551
00:24:02,640 --> 00:24:08,430
<font color="#CCCCCC">include</font><font color="#E5E5E5"> text for instance there was the</font>

552
00:24:05,730 --> 00:24:12,210
skeleton key<font color="#E5E5E5"> skeleton key that deserves</font>

553
00:24:08,430 --> 00:24:16,860
<font color="#E5E5E5">was a</font><font color="#CCCCCC"> super day attack</font><font color="#E5E5E5"> that was</font><font color="#CCCCCC"> so I</font>

554
00:24:12,210 --> 00:24:18,900
<font color="#CCCCCC">think</font><font color="#E5E5E5"> it hit the</font><font color="#CCCCCC"> kaspersky did this</font><font color="#E5E5E5"> is</font>

555
00:24:16,860 --> 00:24:21,300
like a<font color="#E5E5E5"> doomsday attack on our Windows</font>

556
00:24:18,900 --> 00:24:24,450
Active Directory environment because

557
00:24:21,300 --> 00:24:27,600
there was no validation of<font color="#E5E5E5"> of a part of</font>

558
00:24:24,450 --> 00:24:29,190
the chicken<font color="#E5E5E5"> so anybody who had a user</font>

559
00:24:27,600 --> 00:24:32,699
account active directory could change

560
00:24:29,190 --> 00:24:35,190
<font color="#CCCCCC">like whatever groups to remember</font><font color="#E5E5E5"> there's</font>

561
00:24:32,700 --> 00:24:38,670
a famous picture of somebody having up

562
00:24:35,190 --> 00:24:41,910
like<font color="#CCCCCC"> on Twitter a boarding pass</font><font color="#E5E5E5"> and then</font>

563
00:24:38,670 --> 00:24:43,560
he<font color="#CCCCCC"> broke</font><font color="#E5E5E5"> pilot pilot himself and handed</font>

564
00:24:41,910 --> 00:24:45,810
to the cabin crew and they<font color="#E5E5E5"> will just say</font>

565
00:24:43,560 --> 00:24:48,030
<font color="#CCCCCC">ok</font><font color="#E5E5E5"> welcome captain go into the cockpit</font>

566
00:24:45,810 --> 00:24:51,000
<font color="#CCCCCC">and let's get on so that's</font><font color="#E5E5E5"> actually the</font>

567
00:24:48,030 --> 00:24:54,660
same attack<font color="#E5E5E5"> just in an active directory</font>

568
00:24:51,000 --> 00:24:56,640
<font color="#CCCCCC">and another</font><font color="#E5E5E5"> thing</font><font color="#CCCCCC"> i will</font><font color="#E5E5E5"> demo today</font><font color="#CCCCCC"> I</font>

569
00:24:54,660 --> 00:25:01,800
hope is the directory services restore

570
00:24:56,640 --> 00:25:04,800
mode which blew my mind<font color="#E5E5E5"> like four five</font>

571
00:25:01,800 --> 00:25:07,080
<font color="#E5E5E5">six days</font><font color="#CCCCCC"> ago</font><font color="#E5E5E5"> also we are always</font><font color="#CCCCCC"> we've</font>

572
00:25:04,800 --> 00:25:09,030
always been taught that<font color="#CCCCCC"> adorn</font><font color="#E5E5E5"> my domain</font>

573
00:25:07,080 --> 00:25:12,120
<font color="#E5E5E5">controller</font><font color="#CCCCCC"> does not have local local</font>

574
00:25:09,030 --> 00:25:14,910
accounts<font color="#E5E5E5"> it turns out that is</font><font color="#CCCCCC"> a truth</font>

575
00:25:12,120 --> 00:25:18,600
with money modifications<font color="#CCCCCC"> it turns out</font>

576
00:25:14,910 --> 00:25:20,910
that<font color="#CCCCCC"> i actually has a local account</font><font color="#E5E5E5"> the</font>

577
00:25:18,600 --> 00:25:23,010
500<font color="#E5E5E5"> ministry</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> can actually also be</font>

578
00:25:20,910 --> 00:25:27,780
used while the domain controller is live

579
00:25:23,010 --> 00:25:29,730
<font color="#E5E5E5">just by setting a one</font><font color="#CCCCCC"> singular</font><font color="#E5E5E5"> registry</font>

580
00:25:27,780 --> 00:25:32,460
parameter<font color="#E5E5E5"> on the domain controller</font>

581
00:25:29,730 --> 00:25:33,840
itself<font color="#E5E5E5"> so we don't have to reboot the</font>

582
00:25:32,460 --> 00:25:35,850
domain controller<font color="#E5E5E5"> into directory</font>

583
00:25:33,840 --> 00:25:38,040
services restore<font color="#CCCCCC"> mode to lock on</font><font color="#E5E5E5"> us as</font>

584
00:25:35,850 --> 00:25:40,980
this local account<font color="#E5E5E5"> we can actually do it</font>

585
00:25:38,040 --> 00:25:43,560
online<font color="#E5E5E5"> while the</font><font color="#CCCCCC"> machine</font><font color="#E5E5E5"> is loaded so</font>

586
00:25:40,980 --> 00:25:46,140
this gives us another attack vector as

587
00:25:43,560 --> 00:25:46,730
an attacker<font color="#CCCCCC"> and you can have a back door</font>

588
00:25:46,140 --> 00:25:48,169
<font color="#CCCCCC">direct</font>

589
00:25:46,730 --> 00:25:49,880
<font color="#CCCCCC">Leon the domain controller with</font><font color="#E5E5E5"> the</font>

590
00:25:48,169 --> 00:25:51,620
local administrator account i think

591
00:25:49,880 --> 00:25:52,160
that's beautiful<font color="#CCCCCC"> i don't know it's just</font>

592
00:25:51,620 --> 00:25:54,709
me

593
00:25:52,160 --> 00:25:57,950
<font color="#CCCCCC">it even works with them</font><font color="#E5E5E5"> remote desktop</font>

594
00:25:54,710 --> 00:26:02,270
<font color="#CCCCCC">if you if you're on</font><font color="#E5E5E5"> Windows Server 2008</font>

595
00:25:57,950 --> 00:26:05,000
r2 or below in 2012 r2<font color="#CCCCCC"> i'm getting an</font>

596
00:26:02,270 --> 00:26:07,160
error at this point the local<font color="#CCCCCC"> section</font>

597
00:26:05,000 --> 00:26:09,679
<font color="#E5E5E5">manager service</font><font color="#CCCCCC"> field sign-in blah</font><font color="#E5E5E5"> blah</font>

598
00:26:07,160 --> 00:26:12,140
<font color="#CCCCCC">and</font><font color="#E5E5E5"> to me this looks like</font><font color="#CCCCCC"> it's Terminal</font>

599
00:26:09,679 --> 00:26:14,179
Server licensing issues<font color="#CCCCCC"> I I'm actually</font>

600
00:26:12,140 --> 00:26:16,040
kind of<font color="#CCCCCC"> that allowed to</font><font color="#E5E5E5"> logon pretenders</font>

601
00:26:14,179 --> 00:26:18,080
<font color="#E5E5E5">the terminal services</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> know you</font>

602
00:26:16,040 --> 00:26:19,100
don't<font color="#CCCCCC"> have a license</font><font color="#E5E5E5"> so I think I can</font>

603
00:26:18,080 --> 00:26:22,309
fix that

604
00:26:19,100 --> 00:26:25,580
<font color="#CCCCCC">huh</font><font color="#E5E5E5"> maybe some need some more research</font>

605
00:26:22,309 --> 00:26:28,309
this is an example of how it's done the

606
00:26:25,580 --> 00:26:31,129
the picture<font color="#E5E5E5"> up of the right says that</font>

607
00:26:28,309 --> 00:26:32,899
<font color="#CCCCCC">I'm</font><font color="#E5E5E5"> locked on here and</font><font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> trying to</font>

608
00:26:31,130 --> 00:26:36,559
launch<font color="#E5E5E5"> Active Directory users and</font>

609
00:26:32,900 --> 00:26:38,960
computers<font color="#CCCCCC"> these eight</font><font color="#E5E5E5"> MSC</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> it says</font>

610
00:26:36,559 --> 00:26:41,660
you can only<font color="#E5E5E5"> manage local</font><font color="#CCCCCC"> uses ok then I</font>

611
00:26:38,960 --> 00:26:44,090
<font color="#E5E5E5">love</font><font color="#CCCCCC"> yous peace except to just launch</font><font color="#E5E5E5"> us</font>

612
00:26:41,660 --> 00:26:46,280
<font color="#CCCCCC">the system accounting system context and</font>

613
00:26:44,090 --> 00:26:47,928
<font color="#CCCCCC">I do the same command and</font><font color="#E5E5E5"> I'm</font><font color="#CCCCCC"> comic</font>

614
00:26:46,280 --> 00:26:53,540
<font color="#E5E5E5">getting in there</font>

615
00:26:47,929 --> 00:26:55,730
this is a<font color="#CCCCCC"> Howard</font><font color="#E5E5E5"> one could see your</font>

616
00:26:53,540 --> 00:26:58,850
sneaky<font color="#CCCCCC"> backdoor method</font><font color="#E5E5E5"> that on a domain</font>

617
00:26:55,730 --> 00:27:00,530
controller<font color="#E5E5E5"> you can have some kind of</font>

618
00:26:58,850 --> 00:27:03,080
execution mechanism running their

619
00:27:00,530 --> 00:27:06,110
religion<font color="#E5E5E5"> built-in functionality of</font>

620
00:27:03,080 --> 00:27:09,439
course<font color="#E5E5E5"> partial</font><font color="#CCCCCC"> share profile going</font><font color="#E5E5E5"> to</font>

621
00:27:06,110 --> 00:27:12,139
show<font color="#CCCCCC"> in a bit</font><font color="#E5E5E5"> and you could have like</font>

622
00:27:09,440 --> 00:27:14,660
the local startup script running and the

623
00:27:12,140 --> 00:27:16,910
local machine constant context<font color="#E5E5E5"> software</font>

624
00:27:14,660 --> 00:27:18,410
installation whatever and that could

625
00:27:16,910 --> 00:27:20,059
point to somewhere else in the

626
00:27:18,410 --> 00:27:22,820
environment somewhere

627
00:27:20,059 --> 00:27:25,520
the attacker can control<font color="#CCCCCC"> so let's</font><font color="#E5E5E5"> say</font>

628
00:27:22,820 --> 00:27:27,559
<font color="#E5E5E5">I'm not in any group</font><font color="#CCCCCC"> i'm not at the</font>

629
00:27:25,520 --> 00:27:30,080
domain controller itself<font color="#E5E5E5"> only configure</font>

630
00:27:27,559 --> 00:27:32,240
this functionality and the<font color="#E5E5E5"> pointer out</font>

631
00:27:30,080 --> 00:27:34,790
some files here where<font color="#CCCCCC"> it will make sure</font>

632
00:27:32,240 --> 00:27:36,679
i have<font color="#E5E5E5"> share and write permissions to</font>

633
00:27:34,790 --> 00:27:39,710
the<font color="#CCCCCC"> NCAA</font><font color="#E5E5E5"> fish and</font><font color="#CCCCCC"> CBS permissions</font>

634
00:27:36,679 --> 00:27:41,690
whatever<font color="#E5E5E5"> so at some later point</font><font color="#CCCCCC"> I can</font>

635
00:27:39,710 --> 00:27:44,480
manipulate that part of the environment

636
00:27:41,690 --> 00:27:48,260
and maybe<font color="#E5E5E5"> put in another executable</font>

637
00:27:44,480 --> 00:27:50,330
another<font color="#CCCCCC"> MSI file</font><font color="#E5E5E5"> modify the script that</font>

638
00:27:48,260 --> 00:27:52,190
is included in the<font color="#CCCCCC"> locking scripts on</font>

639
00:27:50,330 --> 00:27:53,939
all the environments<font color="#E5E5E5"> all the computers</font>

640
00:27:52,190 --> 00:27:57,059
<font color="#CCCCCC">and environments including</font>

641
00:27:53,940 --> 00:27:59,700
<font color="#E5E5E5">domain controllers perhaps</font><font color="#CCCCCC"> I think this</font>

642
00:27:57,059 --> 00:28:03,330
<font color="#CCCCCC">is a neat trick</font>

643
00:27:59,700 --> 00:28:06,029
so<font color="#CCCCCC"> these are some</font><font color="#E5E5E5"> of the things</font><font color="#CCCCCC"> you</font>

644
00:28:03,330 --> 00:28:08,970
could do if you are running a system of

645
00:28:06,029 --> 00:28:10,500
the main controller<font color="#CCCCCC"> i particularly like</font>

646
00:28:08,970 --> 00:28:13,980
the one<font color="#E5E5E5"> where you're looking for new</font>

647
00:28:10,500 --> 00:28:16,590
<font color="#CCCCCC">DC's</font><font color="#E5E5E5"> constantly because in a resource of</font>

648
00:28:13,980 --> 00:28:18,509
our environment many people tend to boot

649
00:28:16,590 --> 00:28:20,158
up new domain controllers because then

650
00:28:18,509 --> 00:28:22,019
<font color="#E5E5E5">they trust those domain controllers and</font>

651
00:28:20,159 --> 00:28:23,639
will shut down the old ones<font color="#CCCCCC"> they know</font>

652
00:28:22,019 --> 00:28:25,440
they have<font color="#E5E5E5"> been compromised</font>

653
00:28:23,639 --> 00:28:27,059
but if the<font color="#E5E5E5"> old ones were just looking</font>

654
00:28:25,440 --> 00:28:29,070
for new domain<font color="#E5E5E5"> controllers and then</font>

655
00:28:27,059 --> 00:28:32,220
<font color="#CCCCCC">authenticating</font><font color="#E5E5E5"> to the new ones</font>

656
00:28:29,070 --> 00:28:34,080
installing themselves you really don't

657
00:28:32,220 --> 00:28:35,639
gain anything from from adding new

658
00:28:34,080 --> 00:28:38,340
domain controllers to<font color="#E5E5E5"> the environment</font><font color="#CCCCCC"> I</font>

659
00:28:35,639 --> 00:28:41,158
<font color="#CCCCCC">i don't know</font><font color="#E5E5E5"> maybe it's just me</font><font color="#CCCCCC"> I have</font>

660
00:28:38,340 --> 00:28:42,209
bad thoughts sometimes<font color="#CCCCCC"> group policy</font>

661
00:28:41,159 --> 00:28:44,820
<font color="#CCCCCC">updates</font>

662
00:28:42,210 --> 00:28:46,500
yeah<font color="#CCCCCC"> I</font><font color="#E5E5E5"> was surprised myself that a</font>

663
00:28:44,820 --> 00:28:49,379
domain controller actually had local

664
00:28:46,500 --> 00:28:51,360
group policy objects<font color="#CCCCCC"> by them</font><font color="#E5E5E5"> they</font><font color="#CCCCCC"> do so</font>

665
00:28:49,379 --> 00:28:54,750
<font color="#CCCCCC">there's a</font><font color="#E5E5E5"> great persistent mechanisms</font>

666
00:28:51,360 --> 00:28:57,178
inside the policy settings<font color="#E5E5E5"> there are</font>

667
00:28:54,750 --> 00:28:59,279
obvious things to use<font color="#E5E5E5"> I tend to like the</font>

668
00:28:57,179 --> 00:29:01,769
startup script and the<font color="#E5E5E5"> shutdown script</font>

669
00:28:59,279 --> 00:29:03,509
because it's running system context<font color="#E5E5E5"> but</font>

670
00:29:01,769 --> 00:29:04,620
even on the<font color="#E5E5E5"> domain controllers use lock</font>

671
00:29:03,509 --> 00:29:07,200
<font color="#E5E5E5">on a lock off</font>

672
00:29:04,620 --> 00:29:09,120
<font color="#E5E5E5">it's also run into maintenance mode most</font>

673
00:29:07,200 --> 00:29:10,679
likely<font color="#CCCCCC"> elicits that</font><font color="#E5E5E5"> one of these backup</font>

674
00:29:09,120 --> 00:29:13,258
operators<font color="#CCCCCC"> who is trying to</font><font color="#E5E5E5"> steal the</font>

675
00:29:10,679 --> 00:29:14,429
<font color="#E5E5E5">NTDs that</font><font color="#CCCCCC"> file I</font><font color="#E5E5E5"> don't know but I'm then</font>

676
00:29:13,259 --> 00:29:18,179
it's not<font color="#CCCCCC"> going to be domain admin</font>

677
00:29:14,429 --> 00:29:19,740
privileges<font color="#CCCCCC"> lot of things to do</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> I</font>

678
00:29:18,179 --> 00:29:22,409
don't know if you saw this<font color="#CCCCCC"> w sauce</font>

679
00:29:19,740 --> 00:29:25,019
<font color="#CCCCCC">windows</font><font color="#E5E5E5"> service update</font><font color="#CCCCCC"> server</font><font color="#E5E5E5"> server</font>

680
00:29:22,409 --> 00:29:29,519
well whatever<font color="#E5E5E5"> it's called</font><font color="#CCCCCC"> there's it was</font>

681
00:29:25,019 --> 00:29:31,409
an attack w suspect<font color="#E5E5E5"> there was released a</font>

682
00:29:29,519 --> 00:29:33,870
<font color="#E5E5E5">black and</font><font color="#CCCCCC"> I think</font><font color="#E5E5E5"> where you can actually</font>

683
00:29:31,409 --> 00:29:36,389
manipulate the<font color="#CCCCCC"> xml file while</font><font color="#E5E5E5"> while</font><font color="#CCCCCC"> they</font>

684
00:29:33,870 --> 00:29:38,039
<font color="#CCCCCC">are negotiating</font><font color="#E5E5E5"> the system that is</font>

685
00:29:36,389 --> 00:29:40,559
trying to be updated and the update

686
00:29:38,039 --> 00:29:42,690
server itself<font color="#CCCCCC"> so you can make it run all</font>

687
00:29:40,559 --> 00:29:45,690
the things<font color="#CCCCCC"> I mean you could point</font><font color="#E5E5E5"> the</font>

688
00:29:42,690 --> 00:29:48,990
<font color="#CCCCCC">wsus 22 your proxy server if you wanted</font>

689
00:29:45,690 --> 00:29:51,210
<font color="#E5E5E5">you to have this kind of axis so the</font>

690
00:29:48,990 --> 00:29:53,399
interesting thing is here<font color="#CCCCCC"> for defenders</font>

691
00:29:51,210 --> 00:29:55,350
to ask themselves what she would I spot

692
00:29:53,399 --> 00:29:57,178
this<font color="#CCCCCC"> but i</font><font color="#E5E5E5"> did check this</font><font color="#CCCCCC"> one had to</font>

693
00:29:55,350 --> 00:29:59,850
check<font color="#E5E5E5"> this for domain</font><font color="#CCCCCC"> Group Policy</font>

694
00:29:57,179 --> 00:30:02,680
<font color="#CCCCCC">objects</font><font color="#E5E5E5"> will check to check this for</font>

695
00:29:59,850 --> 00:30:05,860
local policy objects

696
00:30:02,680 --> 00:30:08,020
<font color="#CCCCCC">it could be just a small change and the</font>

697
00:30:05,860 --> 00:30:10,659
most significant one I think is where

698
00:30:08,020 --> 00:30:12,550
you change the<font color="#CCCCCC"> Commission on the axle if</font>

699
00:30:10,660 --> 00:30:15,400
you have a startup script or<font color="#E5E5E5"> logon</font>

700
00:30:12,550 --> 00:30:18,250
script<font color="#E5E5E5"> that</font><font color="#CCCCCC"> would be one way to do it</font>

701
00:30:15,400 --> 00:30:20,920
really hard to detect<font color="#E5E5E5"> you can even</font>

702
00:30:18,250 --> 00:30:24,010
<font color="#E5E5E5">really</font><font color="#CCCCCC"> introduced the</font><font color="#E5E5E5"> week</font>

703
00:30:20,920 --> 00:30:27,220
<font color="#E5E5E5">implementation of a local administrator</font>

704
00:30:24,010 --> 00:30:31,750
passwords<font color="#E5E5E5"> on</font><font color="#CCCCCC"> when that</font><font color="#E5E5E5"> we have with them</font>

705
00:30:27,220 --> 00:30:33,580
and was fortunate this<font color="#E5E5E5"> 025 this it turns</font>

706
00:30:31,750 --> 00:30:37,300
out that the key used by Group Policy

707
00:30:33,580 --> 00:30:40,689
preferences<font color="#CCCCCC"> was shared it was a shared</font>

708
00:30:37,300 --> 00:30:47,200
key<font color="#E5E5E5"> was a</font><font color="#CCCCCC"> static kee it was a yeah</font>

709
00:30:40,690 --> 00:30:49,570
<font color="#E5E5E5">symmetric encryption and cryptography</font>

710
00:30:47,200 --> 00:30:52,750
<font color="#CCCCCC">right</font><font color="#E5E5E5"> so on</font>

711
00:30:49,570 --> 00:30:55,510
once this was a public<font color="#CCCCCC"> microsoft</font>

712
00:30:52,750 --> 00:30:57,820
released something that blocks the UI

713
00:30:55,510 --> 00:31:01,210
<font color="#E5E5E5">the group policy management console so</font>

714
00:30:57,820 --> 00:31:04,540
you<font color="#E5E5E5"> can introduce new</font><font color="#CCCCCC"> password</font><font color="#E5E5E5"> for local</font>

715
00:31:01,210 --> 00:31:06,550
administrators like this but we could

716
00:31:04,540 --> 00:31:09,040
introduce it anyway but just dropping

717
00:31:06,550 --> 00:31:13,690
some<font color="#CCCCCC"> xml files out there in this world</font>

718
00:31:09,040 --> 00:31:17,110
for instance so that that we should look

719
00:31:13,690 --> 00:31:20,080
for that<font color="#E5E5E5"> right this is if</font><font color="#CCCCCC"> i</font><font color="#E5E5E5"> try</font><font color="#CCCCCC"> to</font>

720
00:31:17,110 --> 00:31:22,959
manipulate this<font color="#E5E5E5"> fall directly if I try</font>

721
00:31:20,080 --> 00:31:25,120
to<font color="#E5E5E5"> Train change the</font><font color="#CCCCCC"> NCAA</font><font color="#E5E5E5"> ntfs settings</font>

722
00:31:22,960 --> 00:31:28,030
<font color="#E5E5E5">the gpmc is going to pop up and say hey</font>

723
00:31:25,120 --> 00:31:30,520
<font color="#E5E5E5">something looks weird so this could be</font>

724
00:31:28,030 --> 00:31:33,370
an indicator of<font color="#E5E5E5"> compromise actually if</font>

725
00:31:30,520 --> 00:31:34,720
you if as<font color="#CCCCCC"> MC pops up like this but</font>

726
00:31:33,370 --> 00:31:36,820
what's going to happen is most likely

727
00:31:34,720 --> 00:31:40,180
the<font color="#CCCCCC"> admins just</font><font color="#E5E5E5"> going to say</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> oh and</font>

728
00:31:36,820 --> 00:31:41,200
<font color="#CCCCCC">it's gonna fix itself then</font><font color="#E5E5E5"> if it says</font>

729
00:31:40,180 --> 00:31:43,420
<font color="#CCCCCC">cancel</font>

730
00:31:41,200 --> 00:31:45,820
we still have<font color="#CCCCCC"> ntfs permissions</font><font color="#E5E5E5"> out there</font>

731
00:31:43,420 --> 00:31:48,340
<font color="#CCCCCC">it might</font><font color="#E5E5E5"> not be every day or every week</font>

732
00:31:45,820 --> 00:31:50,439
or every month<font color="#E5E5E5"> they</font><font color="#CCCCCC"> launched this</font><font color="#E5E5E5"> this</font>

733
00:31:48,340 --> 00:31:52,959
tool<font color="#E5E5E5"> so</font><font color="#CCCCCC"> at them</font><font color="#E5E5E5"> it might take some time</font>

734
00:31:50,440 --> 00:31:55,570
before the action<font color="#CCCCCC"> realized that we have</font>

735
00:31:52,960 --> 00:31:57,370
modified or are able to modify<font color="#CCCCCC"> Group</font>

736
00:31:55,570 --> 00:32:00,610
<font color="#CCCCCC">Policy</font><font color="#E5E5E5"> objects by manipulating the</font>

737
00:31:57,370 --> 00:32:05,199
actual files and<font color="#CCCCCC"> successful management</font>

738
00:32:00,610 --> 00:32:06,760
<font color="#E5E5E5">systems</font><font color="#CCCCCC"> are ya</font><font color="#E5E5E5"> often have system context</font>

739
00:32:05,200 --> 00:32:10,120
we have<font color="#CCCCCC"> scarred we have</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> believe we</font>

740
00:32:06,760 --> 00:32:12,910
have my backup servers<font color="#E5E5E5"> we have all kinds</font>

741
00:32:10,120 --> 00:32:14,159
of things that are allowed to do stuff

742
00:32:12,910 --> 00:32:16,800
on the domain<font color="#CCCCCC"> controllers</font>

743
00:32:14,160 --> 00:32:18,660
<font color="#E5E5E5">so if you compromise those even a</font>

744
00:32:16,800 --> 00:32:20,760
vulnerability scanner setup<font color="#CCCCCC"> for the</font>

745
00:32:18,660 --> 00:32:21,930
indicated<font color="#E5E5E5"> scans could be potentially</font>

746
00:32:20,760 --> 00:32:25,379
local administrator on a domain

747
00:32:21,930 --> 00:32:27,540
controller<font color="#E5E5E5"> so</font><font color="#CCCCCC"> the main admin actually</font>

748
00:32:25,380 --> 00:32:29,310
then we also have<font color="#E5E5E5"> the</font><font color="#CCCCCC"> deployment</font>

749
00:32:27,540 --> 00:32:31,290
services if<font color="#CCCCCC"> I'm in there and I can</font>

750
00:32:29,310 --> 00:32:32,639
<font color="#E5E5E5">manipulate what's going to be deployed</font>

751
00:32:31,290 --> 00:32:35,909
in the environment

752
00:32:32,640 --> 00:32:38,100
<font color="#CCCCCC">I just modifying an</font><font color="#E5E5E5"> iso file just modify</font>

753
00:32:35,910 --> 00:32:39,660
base image whatever they can start

754
00:32:38,100 --> 00:32:41,429
rebuilding the environment<font color="#CCCCCC"> although</font><font color="#E5E5E5"> i</font>

755
00:32:39,660 --> 00:32:44,820
care<font color="#E5E5E5"> because they're going to rebuild</font>

756
00:32:41,430 --> 00:32:47,850
with my settings<font color="#CCCCCC"> beautiful and I can</font>

757
00:32:44,820 --> 00:32:50,189
control patch management and<font color="#CCCCCC"> I</font><font color="#E5E5E5"> even</font>

758
00:32:47,850 --> 00:32:54,389
heard about<font color="#E5E5E5"> one of you guys informed me</font>

759
00:32:50,190 --> 00:32:57,060
about an attack<font color="#E5E5E5"> on on</font><font color="#CCCCCC"> ya</font><font color="#E5E5E5"> some</font><font color="#CCCCCC"> vendors</font>

760
00:32:54,390 --> 00:32:59,790
<font color="#E5E5E5">update service that was not</font><font color="#CCCCCC"> Microsoft</font>

761
00:32:57,060 --> 00:33:04,530
<font color="#E5E5E5">where you have an in-house</font><font color="#CCCCCC"> update server</font>

762
00:32:59,790 --> 00:33:06,659
<font color="#E5E5E5">could also be nice things to look out</font>

763
00:33:04,530 --> 00:33:08,520
for is these administrative<font color="#E5E5E5"> work station</font>

764
00:33:06,660 --> 00:33:10,380
<font color="#E5E5E5">jump service which also considered</font>

765
00:33:08,520 --> 00:33:12,810
management service because<font color="#E5E5E5"> on those you</font>

766
00:33:10,380 --> 00:33:15,690
will have credentials of<font color="#E5E5E5"> really powerful</font>

767
00:33:12,810 --> 00:33:17,700
highly privileged accounts<font color="#CCCCCC"> i'm</font><font color="#E5E5E5"> going to</font>

768
00:33:15,690 --> 00:33:19,410
<font color="#CCCCCC">come back</font><font color="#E5E5E5"> to that in a bit and also for</font>

769
00:33:17,700 --> 00:33:21,390
all the management<font color="#E5E5E5"> service if you're</font>

770
00:33:19,410 --> 00:33:24,690
operating system integrity is

771
00:33:21,390 --> 00:33:28,560
compromised you have a problem<font color="#E5E5E5"> and this</font>

772
00:33:24,690 --> 00:33:30,270
<font color="#CCCCCC">1i like</font><font color="#E5E5E5"> this is the one with the</font><font color="#CCCCCC"> PTI an</font>

773
00:33:28,560 --> 00:33:31,740
<font color="#CCCCCC">attacker could introduce a new</font><font color="#E5E5E5"> peak</font>

774
00:33:30,270 --> 00:33:34,800
behind<font color="#CCCCCC"> them environment in the</font>

775
00:33:31,740 --> 00:33:37,710
environment<font color="#E5E5E5"> so</font><font color="#CCCCCC"> I get in there see they</font>

776
00:33:34,800 --> 00:33:40,350
have an existing<font color="#CCCCCC"> PTI maybe I say okay I</font>

777
00:33:37,710 --> 00:33:42,690
can usually<font color="#E5E5E5"> utilize that and create a</font>

778
00:33:40,350 --> 00:33:44,459
<font color="#CCCCCC">smartlock on certificate template issue</font>

779
00:33:42,690 --> 00:33:46,920
that<font color="#E5E5E5"> do whatever</font><font color="#CCCCCC"> I want to delete the</font>

780
00:33:44,460 --> 00:33:49,470
template again<font color="#CCCCCC"> i have</font><font color="#E5E5E5"> the certificate or</font>

781
00:33:46,920 --> 00:33:50,970
<font color="#CCCCCC">i could</font><font color="#E5E5E5"> say</font><font color="#CCCCCC"> i want to create my own and</font>

782
00:33:49,470 --> 00:33:53,070
and published that in<font color="#CCCCCC"> Active Directory</font>

783
00:33:50,970 --> 00:33:55,620
<font color="#E5E5E5">everybody is</font><font color="#CCCCCC"> going to trust my</font>

784
00:33:53,070 --> 00:33:59,550
certificate authority<font color="#E5E5E5"> my root</font>

785
00:33:55,620 --> 00:34:02,250
certificate<font color="#E5E5E5"> so nice little way of doing</font>

786
00:33:59,550 --> 00:34:05,610
this and the<font color="#CCCCCC"> defenders should ask</font>

787
00:34:02,250 --> 00:34:08,790
themselves would<font color="#CCCCCC"> I detect if a new pki</font>

788
00:34:05,610 --> 00:34:11,909
<font color="#CCCCCC">hiroaki was introduced in my environment</font>

789
00:34:08,790 --> 00:34:13,859
<font color="#CCCCCC">I like</font><font color="#E5E5E5"> do</font><font color="#CCCCCC"> I get a warning</font>

790
00:34:11,909 --> 00:34:16,619
maybe not<font color="#CCCCCC"> i don't think so i haven't</font>

791
00:34:13,859 --> 00:34:20,940
<font color="#E5E5E5">seen that many places anyway most place</font>

792
00:34:16,619 --> 00:34:23,250
another<font color="#E5E5E5"> way to do this to become an</font>

793
00:34:20,940 --> 00:34:25,799
enrollment agent with the<font color="#E5E5E5"> enrollment</font>

794
00:34:23,250 --> 00:34:28,589
ancient<font color="#E5E5E5"> permission you can issue</font>

795
00:34:25,799 --> 00:34:33,538
certificates on behalf of any<font color="#CCCCCC"> use</font><font color="#E5E5E5"> in the</font>

796
00:34:28,589 --> 00:34:35,460
environment including domain admins so

797
00:34:33,539 --> 00:34:37,289
<font color="#E5E5E5">operating system</font><font color="#CCCCCC"> integrity i'm not going</font>

798
00:34:35,460 --> 00:34:38,490
to<font color="#E5E5E5"> go into this because this is probably</font>

799
00:34:37,289 --> 00:34:40,230
too basic

800
00:34:38,489 --> 00:34:42,328
this is everything you know about

801
00:34:40,230 --> 00:34:45,569
<font color="#CCCCCC">Windows exploitation and windows</font><font color="#E5E5E5"> back</font>

802
00:34:42,329 --> 00:34:47,220
<font color="#E5E5E5">doors</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> the host operating system has</font>

803
00:34:45,569 --> 00:34:50,219
some weaknesses whatever<font color="#CCCCCC"> patch</font>

804
00:34:47,219 --> 00:34:53,219
management<font color="#CCCCCC"> backup</font><font color="#E5E5E5"> if you restore from a</font>

805
00:34:50,219 --> 00:34:55,888
bad media<font color="#CCCCCC"> this one is kind of new maybe</font>

806
00:34:53,219 --> 00:34:59,788
<font color="#E5E5E5">I I like this one a lot</font>

807
00:34:55,889 --> 00:35:03,059
dropping a profile that<font color="#CCCCCC"> ps1 in this</font>

808
00:34:59,789 --> 00:35:05,010
directory on<font color="#E5E5E5"> on</font><font color="#CCCCCC"> a domain</font><font color="#E5E5E5"> controller</font><font color="#CCCCCC"> will</font>

809
00:35:03,059 --> 00:35:07,980
make sure that Mike Otis launched every

810
00:35:05,010 --> 00:35:11,220
time a domain admin launches the partial

811
00:35:07,980 --> 00:35:13,530
control on the system<font color="#E5E5E5"> so it's like a</font>

812
00:35:11,220 --> 00:35:15,328
<font color="#CCCCCC">shared profile everybody</font><font color="#E5E5E5"> on this domain</font>

813
00:35:13,530 --> 00:35:18,450
controller should run this code<font color="#E5E5E5"> every</font>

814
00:35:15,329 --> 00:35:20,369
<font color="#E5E5E5">time they</font><font color="#CCCCCC"> launched a partial console so</font>

815
00:35:18,450 --> 00:35:22,109
very powerful and it shouldn't turn<font color="#E5E5E5"> out</font>

816
00:35:20,369 --> 00:35:24,510
<font color="#CCCCCC">and read if you an attacker maybe you</font>

817
00:35:22,109 --> 00:35:29,700
<font color="#E5E5E5">should just not do any right or print</font>

818
00:35:24,510 --> 00:35:31,109
output<font color="#CCCCCC"> maybe Shawn's Pierce extensive</font>

819
00:35:29,700 --> 00:35:34,348
research on application compatibility

820
00:35:31,109 --> 00:35:36,180
<font color="#E5E5E5">seems very interesting to make sure</font><font color="#CCCCCC"> and</font>

821
00:35:34,349 --> 00:35:39,059
executable actually also does something

822
00:35:36,180 --> 00:35:42,750
else before executing<font color="#E5E5E5"> really powerful</font>

823
00:35:39,059 --> 00:35:45,720
<font color="#E5E5E5">you can have local</font><font color="#CCCCCC"> uses most places on</font>

824
00:35:42,750 --> 00:35:50,760
<font color="#E5E5E5">and there are some</font><font color="#CCCCCC"> new research going on</font>

825
00:35:45,720 --> 00:35:54,029
about<font color="#CCCCCC"> wmi you can have providers that</font>

826
00:35:50,760 --> 00:35:58,500
are really really really awful<font color="#CCCCCC"> malicious</font>

827
00:35:54,029 --> 00:36:00,960
<font color="#E5E5E5">evil the evil call them evil w my</font>

828
00:35:58,500 --> 00:36:03,119
provider<font color="#E5E5E5"> it's a</font><font color="#CCCCCC"> i'm linking</font><font color="#E5E5E5"> to the</font>

829
00:36:00,960 --> 00:36:05,579
research<font color="#E5E5E5"> later in this document</font><font color="#CCCCCC"> there</font>

830
00:36:03,119 --> 00:36:08,309
<font color="#CCCCCC">are also new</font><font color="#E5E5E5"> forensics capabilities in</font>

831
00:36:05,579 --> 00:36:09,930
this area until recently we<font color="#E5E5E5"> couldn't</font>

832
00:36:08,309 --> 00:36:12,599
actually actually to check this because

833
00:36:09,930 --> 00:36:14,640
of WM is in a binary file that it's not

834
00:36:12,599 --> 00:36:16,859
really easily interpreted but some guys

835
00:36:14,640 --> 00:36:19,770
actually did the work and<font color="#E5E5E5"> and we are</font>

836
00:36:16,859 --> 00:36:22,400
able to see through this if the

837
00:36:19,770 --> 00:36:24,380
virtualization platform has weaknesses

838
00:36:22,400 --> 00:36:27,289
<font color="#CCCCCC">your domain controller will have a</font>

839
00:36:24,380 --> 00:36:30,049
weakness<font color="#CCCCCC"> and so maybe in a few years</font>

840
00:36:27,289 --> 00:36:31,700
when we start encrypting<font color="#CCCCCC"> domain</font>

841
00:36:30,049 --> 00:36:34,609
<font color="#CCCCCC">controllers</font><font color="#E5E5E5"> in virtual virtual</font>

842
00:36:31,700 --> 00:36:37,640
<font color="#E5E5E5">environments and service so we might get</font>

843
00:36:34,609 --> 00:36:40,098
<font color="#E5E5E5">in</font><font color="#CCCCCC"> we might</font><font color="#E5E5E5"> be in a better place</font><font color="#CCCCCC"> the</font>

844
00:36:37,640 --> 00:36:43,098
storage platform is a problem obviously

845
00:36:40,099 --> 00:36:45,740
physical access all of these remote

846
00:36:43,099 --> 00:36:49,220
management options on my laptop<font color="#CCCCCC"> I have a</font>

847
00:36:45,740 --> 00:36:51,890
local user that is in the group called

848
00:36:49,220 --> 00:36:53,868
<font color="#E5E5E5">hyper-v administrators without one from</font>

849
00:36:51,890 --> 00:36:56,779
any machine if<font color="#CCCCCC"> I</font><font color="#E5E5E5"> dedicate to this one</font>

850
00:36:53,869 --> 00:36:59,839
<font color="#CCCCCC">assuming</font><font color="#E5E5E5"> the firewalls is along this</font>

851
00:36:56,779 --> 00:37:02,690
<font color="#E5E5E5">obviously and don't start attacking me</font>

852
00:36:59,839 --> 00:37:07,578
because it is offline<font color="#CCCCCC"> so no</font><font color="#E5E5E5"> need to try</font>

853
00:37:02,690 --> 00:37:10,220
but anyway<font color="#CCCCCC"> this is gonna make sure that</font>

854
00:37:07,579 --> 00:37:12,619
<font color="#CCCCCC">i can remote in and to console access to</font>

855
00:37:10,220 --> 00:37:17,149
anything<font color="#CCCCCC"> any</font><font color="#E5E5E5"> guess</font><font color="#CCCCCC"> thats host operating</font>

856
00:37:12,619 --> 00:37:22,039
system has inside<font color="#CCCCCC"> Highbury</font><font color="#E5E5E5"> very powerful</font>

857
00:37:17,150 --> 00:37:24,109
<font color="#CCCCCC">oh</font><font color="#E5E5E5"> all stuff even the</font><font color="#CCCCCC"> stickies</font><font color="#E5E5E5"> and</font>

858
00:37:22,039 --> 00:37:26,299
<font color="#CCCCCC">acceleration so you boot up</font><font color="#E5E5E5"> and there's</font>

859
00:37:24,109 --> 00:37:28,609
<font color="#CCCCCC">a</font><font color="#E5E5E5"> login</font><font color="#CCCCCC"> screen you hit the</font><font color="#E5E5E5"> stickies like</font>

860
00:37:26,299 --> 00:37:30,650
five times<font color="#CCCCCC"> shift</font><font color="#E5E5E5"> or so and put you have</font>

861
00:37:28,609 --> 00:37:31,130
a command prompt running system really

862
00:37:30,650 --> 00:37:33,859
nice

863
00:37:31,130 --> 00:37:35,900
<font color="#E5E5E5">autoruns</font><font color="#CCCCCC"> i love this tool everything in</font>

864
00:37:33,859 --> 00:37:36,980
here is relevant for operating system

865
00:37:35,900 --> 00:37:39,770
<font color="#E5E5E5">and</font><font color="#CCCCCC"> check Raji</font><font color="#E5E5E5"> right</font>

866
00:37:36,980 --> 00:37:42,529
what I particularly like is that<font color="#CCCCCC"> some</font>

867
00:37:39,770 --> 00:37:45,680
<font color="#CCCCCC">are red highlighted here</font><font color="#E5E5E5"> so for instance</font>

868
00:37:42,529 --> 00:37:48,380
this one<font color="#CCCCCC"> gather network info you see at</font>

869
00:37:45,680 --> 00:37:50,118
the bottom<font color="#E5E5E5"> and what if I meant</font>

870
00:37:48,380 --> 00:37:53,690
manipulated the code inside of that

871
00:37:50,119 --> 00:37:56,690
<font color="#CCCCCC">it'sit's</font><font color="#E5E5E5"> not validated by anything it's</font>

872
00:37:53,690 --> 00:38:00,049
<font color="#CCCCCC">rocky could</font><font color="#E5E5E5"> be could be run as</font><font color="#CCCCCC"> a system</font>

873
00:37:56,690 --> 00:38:01,910
<font color="#E5E5E5">so i have my own code running</font><font color="#CCCCCC"> its</font><font color="#E5E5E5"> VBS</font><font color="#CCCCCC"> I</font>

874
00:38:00,049 --> 00:38:04,038
have to do some work again to get back

875
00:38:01,910 --> 00:38:07,368
to<font color="#CCCCCC"> the house which is group VBS but</font>

876
00:38:04,039 --> 00:38:09,289
anyway you could do it and<font color="#E5E5E5"> you</font><font color="#CCCCCC"> could</font>

877
00:38:07,369 --> 00:38:11,690
just set up a trigger and<font color="#CCCCCC"> wood with the</font>

878
00:38:09,289 --> 00:38:15,500
defenders actually<font color="#E5E5E5"> spot this</font>

879
00:38:11,690 --> 00:38:19,549
I don't<font color="#E5E5E5"> know one interesting thing is</font>

880
00:38:15,500 --> 00:38:22,190
that actually<font color="#CCCCCC"> Ultron's also lists like I</font>

881
00:38:19,549 --> 00:38:23,750
<font color="#CCCCCC">set up on</font><font color="#E5E5E5"> a group policy local group</font>

882
00:38:22,190 --> 00:38:25,910
policy with<font color="#E5E5E5"> a startup script it will</font>

883
00:38:23,750 --> 00:38:28,210
actually<font color="#CCCCCC"> list</font><font color="#E5E5E5"> also you are able to check</font>

884
00:38:25,910 --> 00:38:31,569
those attacks if there should be any

885
00:38:28,210 --> 00:38:34,839
<font color="#E5E5E5">administrative practices</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> we should</font>

886
00:38:31,570 --> 00:38:38,440
<font color="#CCCCCC">use a lot of work on this because to be</font>

887
00:38:34,839 --> 00:38:41,710
honest<font color="#CCCCCC"> many things about Microsoft</font>

888
00:38:38,440 --> 00:38:45,310
platform<font color="#CCCCCC"> security</font><font color="#E5E5E5"> is about administering</font>

889
00:38:41,710 --> 00:38:46,780
<font color="#E5E5E5">from</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> right there</font><font color="#CCCCCC"> are good ways</font><font color="#E5E5E5"> of</font>

890
00:38:45,310 --> 00:38:49,150
doing things and<font color="#E5E5E5"> there are really bad</font>

891
00:38:46,780 --> 00:38:50,830
ways of doing things<font color="#E5E5E5"> and we have tended</font>

892
00:38:49,150 --> 00:38:53,890
to do things really bad since the

893
00:38:50,830 --> 00:38:56,348
nineteen nineties and<font color="#CCCCCC"> i'm not</font><font color="#E5E5E5"> saying is</font>

894
00:38:53,890 --> 00:38:58,420
just<font color="#CCCCCC"> a customer's fault</font><font color="#E5E5E5"> maybe maybe it's</font>

895
00:38:56,349 --> 00:39:00,430
<font color="#CCCCCC">microsoft</font><font color="#E5E5E5"> who didn't really know where</font>

896
00:38:58,420 --> 00:39:02,230
<font color="#E5E5E5">we were going and how things should be</font>

897
00:39:00,430 --> 00:39:04,598
<font color="#E5E5E5">set up but for instance the domain</font>

898
00:39:02,230 --> 00:39:07,119
administrators<font color="#CCCCCC"> having so many</font><font color="#E5E5E5"> domain</font>

899
00:39:04,599 --> 00:39:08,560
administrators really there's no point

900
00:39:07,119 --> 00:39:11,320
you only need<font color="#CCCCCC"> the main admin permissions</font>

901
00:39:08,560 --> 00:39:15,310
and very very few cases along the year

902
00:39:11,320 --> 00:39:18,369
<font color="#CCCCCC">not normal setup</font><font color="#E5E5E5"> there are other ways of</font>

903
00:39:15,310 --> 00:39:19,869
doing it<font color="#CCCCCC"> i'm storing credentials</font>

904
00:39:18,369 --> 00:39:21,880
everywhere in the environment

905
00:39:19,869 --> 00:39:25,030
<font color="#CCCCCC">I've even</font><font color="#E5E5E5"> seen</font><font color="#CCCCCC"> domain admin</font><font color="#E5E5E5"> accounts</font>

906
00:39:21,880 --> 00:39:28,359
locking on<font color="#E5E5E5"> running services on on</font>

907
00:39:25,030 --> 00:39:31,660
clients on<font color="#CCCCCC"> endpoints</font><font color="#E5E5E5"> just stupid</font>

908
00:39:28,359 --> 00:39:34,690
<font color="#E5E5E5">I mean</font><font color="#CCCCCC"> user being local admin is</font>

909
00:39:31,660 --> 00:39:37,330
actually<font color="#E5E5E5"> implicitly also domain admin</font>

910
00:39:34,690 --> 00:39:40,089
<font color="#E5E5E5">because</font><font color="#CCCCCC"> it can read the memory read</font><font color="#E5E5E5"> out</font>

911
00:39:37,330 --> 00:39:43,180
the<font color="#CCCCCC"> stored credentials</font><font color="#E5E5E5"> even</font><font color="#CCCCCC"> clearer</font>

912
00:39:40,089 --> 00:39:44,619
fixed in this case<font color="#E5E5E5"> people should know</font>

913
00:39:43,180 --> 00:39:46,480
the windows logon<font color="#E5E5E5"> types there's a</font>

914
00:39:44,619 --> 00:39:49,240
difference between doing an interactive

915
00:39:46,480 --> 00:39:52,180
<font color="#E5E5E5">interactive</font><font color="#CCCCCC"> logon</font><font color="#E5E5E5"> and doing a network on</font>

916
00:39:49,240 --> 00:39:54,339
in the fact that an insert interactive

917
00:39:52,180 --> 00:39:55,810
logon<font color="#CCCCCC"> belief credentials on the box so</font>

918
00:39:54,339 --> 00:39:57,940
it's<font color="#E5E5E5"> going to be interesting to attack</font>

919
00:39:55,810 --> 00:39:59,500
that one<font color="#E5E5E5"> if you justjust do a network</font>

920
00:39:57,940 --> 00:40:01,570
<font color="#E5E5E5">lock on you will not leave your</font>

921
00:39:59,500 --> 00:40:03,609
credentials<font color="#CCCCCC"> there so this</font><font color="#E5E5E5"> is about</font>

922
00:40:01,570 --> 00:40:06,099
credential<font color="#CCCCCC"> hygena i</font><font color="#E5E5E5"> really like the</font>

923
00:40:03,609 --> 00:40:08,710
concept and it's like firewalling and

924
00:40:06,099 --> 00:40:12,400
isolating your environment on<font color="#E5E5E5"> a group</font>

925
00:40:08,710 --> 00:40:14,260
and use of level<font color="#E5E5E5"> so</font><font color="#CCCCCC"> I've really high</font>

926
00:40:12,400 --> 00:40:16,839
privileged<font color="#CCCCCC"> accounts should not log onto</font>

927
00:40:14,260 --> 00:40:20,589
<font color="#E5E5E5">something that is in a trust</font><font color="#CCCCCC"> zone</font><font color="#E5E5E5"> and</font>

928
00:40:16,839 --> 00:40:22,270
secure<font color="#CCCCCC"> sewn</font><font color="#E5E5E5"> below his own much more in</font>

929
00:40:20,589 --> 00:40:24,250
the white papers<font color="#E5E5E5"> from</font><font color="#CCCCCC"> Microsoft which</font>

930
00:40:22,270 --> 00:40:26,560
everybody should read<font color="#CCCCCC"> if if they</font><font color="#E5E5E5"> work</font>

931
00:40:24,250 --> 00:40:31,330
with<font color="#E5E5E5"> this stuff</font><font color="#CCCCCC"> I didn't</font><font color="#E5E5E5"> miss something</font>

932
00:40:26,560 --> 00:40:37,150
<font color="#E5E5E5">oh</font><font color="#CCCCCC"> noes among</font><font color="#E5E5E5"> admins</font><font color="#CCCCCC"> ok so wish me luck</font>

933
00:40:31,330 --> 00:40:40,420
this is gonna be a demo of<font color="#E5E5E5"> i have two</font>

934
00:40:37,150 --> 00:40:45,700
machines here<font color="#E5E5E5"> so first</font><font color="#CCCCCC"> I would</font><font color="#E5E5E5"> really</font>

935
00:40:40,420 --> 00:40:48,310
love to demo<font color="#CCCCCC"> ok i can't</font><font color="#E5E5E5"> speak while</font>

936
00:40:45,700 --> 00:40:48,879
<font color="#E5E5E5">entering a password</font><font color="#CCCCCC"> that's</font><font color="#E5E5E5"> how my brain</font>

937
00:40:48,310 --> 00:40:53,950
works

938
00:40:48,880 --> 00:40:56,109
apparently<font color="#E5E5E5"> annoying</font><font color="#CCCCCC"> i have two machines</font>

939
00:40:53,950 --> 00:40:58,720
<font color="#CCCCCC">one is the main control here</font>

940
00:40:56,109 --> 00:41:00,190
<font color="#CCCCCC">do</font><font color="#E5E5E5"> not waste your time with installing</font>

941
00:40:58,720 --> 00:41:03,368
an<font color="#E5E5E5"> actual</font><font color="#CCCCCC"> director</font><font color="#E5E5E5"> certificate services</font>

942
00:41:00,190 --> 00:41:05,530
<font color="#CCCCCC">that i just</font><font color="#E5E5E5"> did that</font><font color="#CCCCCC"> beforehand</font><font color="#E5E5E5"> and if</font>

943
00:41:03,369 --> 00:41:07,720
this could be an<font color="#E5E5E5"> attacker doing that so</font>

944
00:41:05,530 --> 00:41:11,740
<font color="#E5E5E5">i installed on</font><font color="#CCCCCC"> the main control</font><font color="#E5E5E5"> because</font>

945
00:41:07,720 --> 00:41:15,848
it's easy and<font color="#CCCCCC"> I issued a smart lock on</font>

946
00:41:11,740 --> 00:41:19,450
<font color="#CCCCCC">certificate template i set it to 100</font>

947
00:41:15,849 --> 00:41:21,820
years<font color="#CCCCCC"> ago as</font><font color="#E5E5E5"> you can see this if not</font>

948
00:41:19,450 --> 00:41:24,460
<font color="#CCCCCC">i'll just show you here</font>

949
00:41:21,820 --> 00:41:27,430
<font color="#CCCCCC">ok</font><font color="#E5E5E5"> hundred years and maybe</font><font color="#CCCCCC"> 50 years for</font>

950
00:41:24,460 --> 00:41:31,180
renewal period<font color="#CCCCCC"> that should be fine I'll</font>

951
00:41:27,430 --> 00:41:33,250
be<font color="#E5E5E5"> dead but then maybe and one thing to</font>

952
00:41:31,180 --> 00:41:35,589
remember is that we configure this for

953
00:41:33,250 --> 00:41:38,740
<font color="#CCCCCC">smartcard log on this certificate</font>

954
00:41:35,589 --> 00:41:41,109
template and<font color="#CCCCCC"> on dr. chopped</font><font color="#E5E5E5"> chakra fee</font>

955
00:41:38,740 --> 00:41:44,290
<font color="#CCCCCC">we will make sure that this certificate</font>

956
00:41:41,109 --> 00:41:46,930
<font color="#E5E5E5">will come on</font>

957
00:41:44,290 --> 00:41:50,349
excuse me

958
00:41:46,930 --> 00:41:54,848
<font color="#E5E5E5">has this</font><font color="#CCCCCC"> Microsoft base mark</font><font color="#E5E5E5"> hard</font><font color="#CCCCCC"> triple</font>

959
00:41:50,349 --> 00:41:56,470
<font color="#CCCCCC">rider and this machine i have actually</font>

960
00:41:54,849 --> 00:42:00,520
<font color="#CCCCCC">its</font><font color="#E5E5E5"> market read about what I'm using is</font>

961
00:41:56,470 --> 00:42:04,480
a virtual<font color="#CCCCCC"> smartcard</font><font color="#E5E5E5"> step because it's</font>

962
00:42:00,520 --> 00:42:06,490
just easier<font color="#CCCCCC"> that I</font><font color="#E5E5E5"> could do the same</font><font color="#CCCCCC"> so</font>

963
00:42:04,480 --> 00:42:08,859
<font color="#CCCCCC">i have also issued the certificate</font>

964
00:42:06,490 --> 00:42:11,049
published it to the domain so over here

965
00:42:08,859 --> 00:42:13,150
from unlocking this<font color="#CCCCCC"> is the administrator</font>

966
00:42:11,050 --> 00:42:16,569
just to make things more easy here on

967
00:42:13,150 --> 00:42:17,829
<font color="#CCCCCC">our and normal mangement</font><font color="#E5E5E5"> machine and</font>

968
00:42:16,569 --> 00:42:20,950
some of this is going to take some time

969
00:42:17,829 --> 00:42:23,170
<font color="#E5E5E5">for just a allow me to explain</font><font color="#CCCCCC"> while</font>

970
00:42:20,950 --> 00:42:24,970
<font color="#E5E5E5">it's going like right now</font><font color="#CCCCCC"> I'm contacting</font>

971
00:42:23,170 --> 00:42:26,440
<font color="#E5E5E5">contacting active directory</font><font color="#CCCCCC"> that good</font>

972
00:42:24,970 --> 00:42:28,118
service<font color="#E5E5E5"> to figure out actually active</font>

973
00:42:26,440 --> 00:42:30,099
<font color="#CCCCCC">virtual figure out what templates out</font>

974
00:42:28,119 --> 00:42:32,410
there for me<font color="#CCCCCC"> to</font><font color="#E5E5E5"> to get and hopefully</font>

975
00:42:30,099 --> 00:42:36,250
we'll see you smart my smart card lock

976
00:42:32,410 --> 00:42:37,779
on so<font color="#CCCCCC"> i'll</font><font color="#E5E5E5"> click that and what should</font>

977
00:42:36,250 --> 00:42:39,520
happen<font color="#CCCCCC"> i click enroll this is going to</font>

978
00:42:37,780 --> 00:42:45,819
prompt me for the<font color="#E5E5E5"> pin code because we</font>

979
00:42:39,520 --> 00:42:46,720
want security<font color="#E5E5E5"> 12345678</font><font color="#CCCCCC"> mi</font><font color="#E5E5E5"> normal</font>

980
00:42:45,819 --> 00:42:50,109
password

981
00:42:46,720 --> 00:42:52,359
there we go so<font color="#E5E5E5"> it's enrolling and</font><font color="#CCCCCC"> if</font>

982
00:42:50,109 --> 00:42:54,430
everything<font color="#E5E5E5"> works out nicely</font>

983
00:42:52,359 --> 00:42:57,819
well we should<font color="#E5E5E5"> see is</font><font color="#CCCCCC"> I get a</font>

984
00:42:54,430 --> 00:43:00,460
certificate<font color="#E5E5E5"> down with success and over</font>

985
00:42:57,819 --> 00:43:04,720
here<font color="#E5E5E5"> afterwards</font><font color="#CCCCCC"> i'm going to reset the</font>

986
00:43:00,460 --> 00:43:07,240
administrator password so<font color="#E5E5E5"> and</font><font color="#CCCCCC"> log</font><font color="#E5E5E5"> out of</font>

987
00:43:04,720 --> 00:43:09,098
here and show that show you that<font color="#E5E5E5"> I can</font>

988
00:43:07,240 --> 00:43:10,930
actually still come back as a checker

989
00:43:09,099 --> 00:43:15,010
and lock on into the environment even

990
00:43:10,930 --> 00:43:18,700
though<font color="#CCCCCC"> i don't have the password so that</font>

991
00:43:15,010 --> 00:43:20,829
will hopefully be the case<font color="#CCCCCC"> and just to</font>

992
00:43:18,700 --> 00:43:22,720
cut<font color="#E5E5E5"> because</font><font color="#CCCCCC"> i don't have so much time</font>

993
00:43:20,829 --> 00:43:26,260
<font color="#E5E5E5">i'll just show you</font>

994
00:43:22,720 --> 00:43:28,720
oh there<font color="#E5E5E5"> is finish through so as I</font>

995
00:43:26,260 --> 00:43:30,670
promised I will lock off this machine

996
00:43:28,720 --> 00:43:34,149
that<font color="#E5E5E5"> I incidentally change the</font>

997
00:43:30,670 --> 00:43:36,190
resolution for<font color="#CCCCCC"> doing that I'll have to</font>

998
00:43:34,150 --> 00:43:37,720
close this one<font color="#E5E5E5"> I'm</font><font color="#CCCCCC"> right-clicking the</font>

999
00:43:36,190 --> 00:43:40,210
<font color="#E5E5E5">administrator here</font>

1000
00:43:37,720 --> 00:43:44,109
resetting the password and<font color="#E5E5E5"> I</font><font color="#CCCCCC"> you just</font>

1001
00:43:40,210 --> 00:43:48,790
have to trust me because<font color="#CCCCCC"> I'm trustworthy</font>

1002
00:43:44,110 --> 00:43:53,620
<font color="#CCCCCC">I'm i have configured a new password</font>

1003
00:43:48,790 --> 00:43:57,160
here so<font color="#CCCCCC"> I'll just come back</font><font color="#E5E5E5"> as an</font>

1004
00:43:53,620 --> 00:44:00,520
attacker<font color="#CCCCCC"> i'll choose something else here</font>

1005
00:43:57,160 --> 00:44:03,069
and here signing options<font color="#CCCCCC"> i now have you</font>

1006
00:44:00,520 --> 00:44:05,230
can see there's a smart house<font color="#CCCCCC"> I can</font><font color="#E5E5E5"> end</font>

1007
00:44:03,070 --> 00:44:08,140
this like a<font color="#E5E5E5"> chip the TPM chip</font><font color="#CCCCCC"> that's</font>

1008
00:44:05,230 --> 00:44:12,430
<font color="#E5E5E5">where my</font><font color="#CCCCCC"> virtuous Marcus passwords</font>

1009
00:44:08,140 --> 00:44:16,330
changed but<font color="#E5E5E5"> 12345678 and this will take</font>

1010
00:44:12,430 --> 00:44:20,230
probably<font color="#CCCCCC"> 10 20</font><font color="#E5E5E5"> minutes maybe</font>

1011
00:44:16,330 --> 00:44:23,500
so while it's trying to<font color="#E5E5E5"> log on hopefully</font>

1012
00:44:20,230 --> 00:44:25,570
not blowing up my demo<font color="#E5E5E5"> and</font><font color="#CCCCCC"> I'm proud</font>

1013
00:44:23,500 --> 00:44:28,030
atheist<font color="#CCCCCC"> so I</font><font color="#E5E5E5"> don't believe in in demo</font>

1014
00:44:25,570 --> 00:44:31,480
<font color="#E5E5E5">gods</font><font color="#CCCCCC"> i believe in</font><font color="#E5E5E5"> being prepared anyway</font>

1015
00:44:28,030 --> 00:44:38,470
<font color="#E5E5E5">um this is some the thing over here</font><font color="#CCCCCC"> I've</font>

1016
00:44:31,480 --> 00:44:41,410
configured is is<font color="#CCCCCC"> I've set</font><font color="#E5E5E5"> the LSA</font><font color="#CCCCCC"> a TS</font>

1017
00:44:38,470 --> 00:44:44,049
<font color="#CCCCCC">our admin</font><font color="#E5E5E5"> with the years are a madman</font>

1018
00:44:41,410 --> 00:44:46,210
<font color="#CCCCCC">lock on</font><font color="#E5E5E5"> behavior</font><font color="#CCCCCC"> value of to the</font><font color="#E5E5E5"> value</font>

1019
00:44:44,050 --> 00:44:49,600
of choose going to say<font color="#CCCCCC"> I can't be</font>

1020
00:44:46,210 --> 00:44:52,000
running<font color="#CCCCCC"> the domains active</font><font color="#E5E5E5"> directory</font>

1021
00:44:49,600 --> 00:44:53,830
domain<font color="#E5E5E5"> services while actually also</font>

1022
00:44:52,000 --> 00:44:56,590
being able to lock on without stopping

1023
00:44:53,830 --> 00:44:57,910
the service<font color="#E5E5E5"> if I had set it to one</font><font color="#CCCCCC"> I</font>

1024
00:44:56,590 --> 00:45:00,460
<font color="#CCCCCC">would</font><font color="#E5E5E5"> have to stop the active directory</font>

1025
00:44:57,910 --> 00:45:02,560
services and then<font color="#CCCCCC"> I could log on</font><font color="#E5E5E5"> about</font>

1026
00:45:00,460 --> 00:45:04,390
them with<font color="#CCCCCC"> to it's much more easy for</font><font color="#E5E5E5"> me</font>

1027
00:45:02,560 --> 00:45:06,490
<font color="#CCCCCC">as</font><font color="#E5E5E5"> an attacker okay over here</font>

1028
00:45:04,390 --> 00:45:10,390
<font color="#E5E5E5">actually</font><font color="#CCCCCC"> I'm left on I didn't have any</font>

1029
00:45:06,490 --> 00:45:12,520
password<font color="#CCCCCC"> I came back and</font><font color="#E5E5E5"> I min so what</font>

1030
00:45:10,390 --> 00:45:14,620
<font color="#CCCCCC">should we</font><font color="#E5E5E5"> remember check</font><font color="#CCCCCC"> is somebody</font>

1031
00:45:12,520 --> 00:45:15,370
issued certificates<font color="#E5E5E5"> while you were not</font>

1032
00:45:14,620 --> 00:45:19,120
looking

1033
00:45:15,370 --> 00:45:22,210
<font color="#CCCCCC">ok so we</font><font color="#E5E5E5"> will just finish this one up</font>

1034
00:45:19,120 --> 00:45:24,759
with<font color="#CCCCCC"> i told you that</font><font color="#E5E5E5"> this is a domain</font>

1035
00:45:22,210 --> 00:45:28,270
<font color="#E5E5E5">admin</font><font color="#CCCCCC"> who's locked</font><font color="#E5E5E5"> down here</font><font color="#CCCCCC"> the</font>

1036
00:45:24,760 --> 00:45:31,460
administrator here is my active

1037
00:45:28,270 --> 00:45:35,720
directory is called<font color="#CCCCCC"> 80</font><font color="#E5E5E5"> because I</font>

1038
00:45:31,460 --> 00:45:37,760
<font color="#CCCCCC">I like that so i'll try</font><font color="#E5E5E5"> again</font><font color="#CCCCCC"> I'll just</font>

1039
00:45:35,720 --> 00:45:40,220
<font color="#CCCCCC">can't</font><font color="#E5E5E5"> escape because now it's normal</font>

1040
00:45:37,760 --> 00:45:42,560
console<font color="#CCCCCC"> axis and I said</font><font color="#E5E5E5"> explain this</font>

1041
00:45:40,220 --> 00:45:46,730
actually also works remote but this is

1042
00:45:42,560 --> 00:45:47,210
just<font color="#E5E5E5"> 2012 r2</font><font color="#CCCCCC"> so there's</font><font color="#E5E5E5"> this licensing</font>

1043
00:45:46,730 --> 00:45:48,950
error

1044
00:45:47,210 --> 00:45:51,830
no<font color="#E5E5E5"> I don't want to</font><font color="#CCCCCC"> log on as</font><font color="#E5E5E5"> 80</font>

1045
00:45:48,950 --> 00:45:54,799
<font color="#E5E5E5">administrator</font><font color="#CCCCCC"> i'm going</font><font color="#E5E5E5"> to choose</font><font color="#CCCCCC"> dc1</font>

1046
00:45:51,830 --> 00:45:59,690
<font color="#E5E5E5">the name of the computer that the domain</font>

1047
00:45:54,800 --> 00:46:01,910
<font color="#E5E5E5">controllers running on</font><font color="#CCCCCC"> &</font><font color="#E5E5E5"> %</font><font color="#CCCCCC"> the password</font>

1048
00:45:59,690 --> 00:46:04,700
that we set while installing<font color="#E5E5E5"> active</font>

1049
00:46:01,910 --> 00:46:07,549
<font color="#E5E5E5">directory promise you on the DC promo</font>

1050
00:46:04,700 --> 00:46:09,470
for a directory services restore<font color="#CCCCCC"> mode</font>

1051
00:46:07,550 --> 00:46:12,320
<font color="#E5E5E5">password that is actually the local</font>

1052
00:46:09,470 --> 00:46:13,790
administrator account on the machine<font color="#E5E5E5"> you</font>

1053
00:46:12,320 --> 00:46:15,500
can<font color="#E5E5E5"> change</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> later on and as</font><font color="#CCCCCC"> the</font>

1054
00:46:13,790 --> 00:46:17,450
<font color="#E5E5E5">attacker you might not know what it is</font>

1055
00:46:15,500 --> 00:46:19,520
so you would use<font color="#CCCCCC"> introduce your new</font>

1056
00:46:17,450 --> 00:46:21,140
chill<font color="#E5E5E5"> to either set a particular</font>

1057
00:46:19,520 --> 00:46:21,980
password that you want<font color="#CCCCCC"> ok I'm just going</font>

1058
00:46:21,140 --> 00:46:24,319
<font color="#CCCCCC">to do it</font>

1059
00:46:21,980 --> 00:46:25,730
there we<font color="#E5E5E5"> are you can set it to something</font>

1060
00:46:24,320 --> 00:46:27,860
you want to know

1061
00:46:25,730 --> 00:46:31,190
<font color="#E5E5E5">and nobody's gonna know because nobody</font>

1062
00:46:27,860 --> 00:46:35,420
looks for that password change<font color="#CCCCCC"> be honest</font>

1063
00:46:31,190 --> 00:46:36,920
<font color="#E5E5E5">nobody</font><font color="#CCCCCC"> does</font><font color="#E5E5E5"> but you know it and you</font>

1064
00:46:35,420 --> 00:46:38,540
<font color="#E5E5E5">could also synchronize with a particular</font>

1065
00:46:36,920 --> 00:46:40,160
user<font color="#CCCCCC"> running</font><font color="#E5E5E5"> script that will</font>

1066
00:46:38,540 --> 00:46:41,660
synchronize with the user<font color="#CCCCCC"> and</font><font color="#E5E5E5"> active</font>

1067
00:46:40,160 --> 00:46:43,700
<font color="#CCCCCC">directory so you know you will maintain</font>

1068
00:46:41,660 --> 00:46:45,020
your<font color="#CCCCCC"> backdoor even though the stupid</font>

1069
00:46:43,700 --> 00:46:47,120
administrators<font color="#CCCCCC"> ask you to change</font>

1070
00:46:45,020 --> 00:46:50,330
password all the time<font color="#E5E5E5"> so</font><font color="#CCCCCC"> you'll just</font>

1071
00:46:47,120 --> 00:46:53,299
synchronize<font color="#CCCCCC"> ok what</font><font color="#E5E5E5"> I wanted to show in</font>

1072
00:46:50,330 --> 00:46:54,560
<font color="#E5E5E5">in this scenario is</font><font color="#CCCCCC"> i put</font><font color="#E5E5E5"> up a command</font>

1073
00:46:53,300 --> 00:46:58,340
prompt<font color="#CCCCCC"> I'm running as a local</font>

1074
00:46:54,560 --> 00:47:00,740
administrator<font color="#E5E5E5"> just the same as before</font><font color="#CCCCCC"> I</font>

1075
00:46:58,340 --> 00:47:02,780
<font color="#CCCCCC">share with</font><font color="#E5E5E5"> you this</font><font color="#CCCCCC"> star</font><font color="#E5E5E5"> lock it just</font>

1076
00:47:00,740 --> 00:47:04,939
says that to manage users<font color="#CCCCCC"> and groups</font><font color="#E5E5E5"> and</font>

1077
00:47:02,780 --> 00:47:09,890
computers<font color="#CCCCCC"> log on as a user with the main</font>

1078
00:47:04,940 --> 00:47:10,610
<font color="#E5E5E5">administration rights</font><font color="#CCCCCC"> ok water will do</font>

1079
00:47:09,890 --> 00:47:14,319
this

1080
00:47:10,610 --> 00:47:19,360
something else<font color="#CCCCCC"> I will do</font>

1081
00:47:14,319 --> 00:47:21,550
<font color="#CCCCCC">just</font>

1082
00:47:19,360 --> 00:47:23,290
<font color="#E5E5E5">I have some tools on this one could be</font>

1083
00:47:21,550 --> 00:47:27,070
done in other ways<font color="#CCCCCC"> it's just easier this</font>

1084
00:47:23,290 --> 00:47:30,790
way<font color="#E5E5E5"> and of course people will spot that</font>

1085
00:47:27,070 --> 00:47:33,160
somebody's using<font color="#CCCCCC"> PS except</font><font color="#E5E5E5"> right for</font>

1086
00:47:30,790 --> 00:47:38,020
licensing<font color="#CCCCCC"> yeah Thank You Marcus in which</font>

1087
00:47:33,160 --> 00:47:41,350
he's a great guy<font color="#E5E5E5"> so many great tools</font>

1088
00:47:38,020 --> 00:47:43,660
<font color="#CCCCCC">there we go</font>

1089
00:47:41,350 --> 00:47:45,730
<font color="#CCCCCC">ok so now I have a new</font><font color="#E5E5E5"> command</font><font color="#CCCCCC"> prompt</font>

1090
00:47:43,660 --> 00:47:48,879
here running also as an administrator

1091
00:47:45,730 --> 00:47:51,730
<font color="#E5E5E5">this time with system context let's do</font>

1092
00:47:48,880 --> 00:47:54,400
<font color="#CCCCCC">Who I am I i am the local system so</font>

1093
00:47:51,730 --> 00:47:56,470
<font color="#E5E5E5">let's go and run</font><font color="#CCCCCC"> is a dilemma see again</font>

1094
00:47:54,400 --> 00:47:58,180
and it's<font color="#CCCCCC"> going to pop up because I'm not</font>

1095
00:47:56,470 --> 00:48:00,129
now also a domain admin<font color="#E5E5E5"> in this</font>

1096
00:47:58,180 --> 00:48:01,060
environment so that was the demo<font color="#CCCCCC"> I</font>

1097
00:48:00,130 --> 00:48:05,740
<font color="#CCCCCC">survived</font>

1098
00:48:01,060 --> 00:48:08,950
nobody died<font color="#CCCCCC"> ok continuing the question</font>

1099
00:48:05,740 --> 00:48:10,569
is when can we state that this house is

1100
00:48:08,950 --> 00:48:13,930
clear clean<font color="#E5E5E5"> whatever</font>

1101
00:48:10,570 --> 00:48:18,010
actually I<font color="#CCCCCC"> mr. ok we looked at all the</font>

1102
00:48:13,930 --> 00:48:20,109
TTP's we look for all the<font color="#CCCCCC"> IOC's I now</font>

1103
00:48:18,010 --> 00:48:22,870
declare this house is clean

1104
00:48:20,110 --> 00:48:28,360
when is that<font color="#E5E5E5"> when</font><font color="#CCCCCC"> we ever able to do</font>

1105
00:48:22,870 --> 00:48:31,600
that<font color="#CCCCCC"> well I like the answer</font><font color="#E5E5E5"> really what</font>

1106
00:48:28,360 --> 00:48:36,430
people typically do after an attack

1107
00:48:31,600 --> 00:48:41,230
well<font color="#E5E5E5"> people companies organizations tend</font>

1108
00:48:36,430 --> 00:48:43,720
to try to not rebuild<font color="#CCCCCC"> that's really</font>

1109
00:48:41,230 --> 00:48:45,400
expensive<font color="#CCCCCC"> starting</font><font color="#E5E5E5"> from scratch new</font>

1110
00:48:43,720 --> 00:48:47,290
domain controllers new platform

1111
00:48:45,400 --> 00:48:49,240
obviously because we might only hardware

1112
00:48:47,290 --> 00:48:54,340
<font color="#CCCCCC">to we might on the fermi-level</font><font color="#E5E5E5"> whatever</font>

1113
00:48:49,240 --> 00:48:57,850
but rebuilding is<font color="#E5E5E5"> I've been never seen</font>

1114
00:48:54,340 --> 00:48:59,860
<font color="#E5E5E5">it</font><font color="#CCCCCC"> kinda it's very seldom</font><font color="#E5E5E5"> anyway</font><font color="#CCCCCC"> there</font>

1115
00:48:57,850 --> 00:49:01,180
<font color="#E5E5E5">were maybe</font><font color="#CCCCCC"> is reset all the user account</font>

1116
00:48:59,860 --> 00:49:04,360
<font color="#CCCCCC">passwords so annoying</font>

1117
00:49:01,180 --> 00:49:07,299
every user in the domain for no reason

1118
00:49:04,360 --> 00:49:08,710
<font color="#E5E5E5">maybe</font><font color="#CCCCCC"> more</font>

1119
00:49:07,300 --> 00:49:11,170
it should be taking the step<font color="#CCCCCC"> i'm not</font>

1120
00:49:08,710 --> 00:49:13,090
saying that but they forget to do all of

1121
00:49:11,170 --> 00:49:14,680
the other things<font color="#CCCCCC"> i'm</font><font color="#E5E5E5"> just going to leave</font>

1122
00:49:13,090 --> 00:49:17,440
the list<font color="#E5E5E5"> here the</font><font color="#CCCCCC"> slides are probably</font>

1123
00:49:14,680 --> 00:49:19,960
going to be available online<font color="#E5E5E5"> will to fix</font>

1124
00:49:17,440 --> 00:49:21,400
something with<font color="#E5E5E5"> a</font><font color="#CCCCCC"> 60</font><font color="#E5E5E5"> guys so it's going</font>

1125
00:49:19,960 --> 00:49:26,480
<font color="#E5E5E5">to be up there there's a lot of content</font>

1126
00:49:21,400 --> 00:49:28,970
in here<font color="#E5E5E5"> but continuing on the thought on</font>

1127
00:49:26,480 --> 00:49:32,240
<font color="#E5E5E5">resetting computer house that's really</font>

1128
00:49:28,970 --> 00:49:34,160
missed<font color="#E5E5E5"> people don't see the password for</font>

1129
00:49:32,240 --> 00:49:36,500
computers that's actually the same as

1130
00:49:34,160 --> 00:49:40,220
having out of an authenticated users

1131
00:49:36,500 --> 00:49:43,910
user natural mercury and the<font color="#E5E5E5"> trust</font><font color="#CCCCCC"> keys</font>

1132
00:49:40,220 --> 00:49:46,669
<font color="#E5E5E5">between domains</font><font color="#CCCCCC"> nobody actually took</font>

1133
00:49:43,910 --> 00:49:49,700
care of those<font color="#CCCCCC"> investigative</font><font color="#E5E5E5"> group policy</font>

1134
00:49:46,670 --> 00:49:52,550
changes<font color="#CCCCCC"> i don't</font><font color="#E5E5E5"> think so</font>

1135
00:49:49,700 --> 00:49:55,368
investigating<font color="#CCCCCC"> pki trust</font><font color="#E5E5E5"> and and issues</font>

1136
00:49:52,550 --> 00:49:57,350
<font color="#E5E5E5">of certificates people don't do that so</font>

1137
00:49:55,369 --> 00:49:59,900
<font color="#E5E5E5">i have here listed some things that will</font>

1138
00:49:57,350 --> 00:50:04,310
<font color="#E5E5E5">survive a domain wide use a password</font>

1139
00:49:59,900 --> 00:50:07,010
change and<font color="#E5E5E5"> it's not a complete list just</font>

1140
00:50:04,310 --> 00:50:11,210
to make sure you won't<font color="#E5E5E5"> blame me at some</font>

1141
00:50:07,010 --> 00:50:12,530
point later<font color="#E5E5E5"> if you were owned what</font>

1142
00:50:11,210 --> 00:50:14,930
survives<font color="#E5E5E5"> the domain controller</font>

1143
00:50:12,530 --> 00:50:17,359
replacement will<font color="#CCCCCC"> same as on the slide</font>

1144
00:50:14,930 --> 00:50:20,868
<font color="#E5E5E5">before and also these things</font><font color="#CCCCCC"> not a</font>

1145
00:50:17,359 --> 00:50:22,850
complete list<font color="#E5E5E5"> and the question is did we</font>

1146
00:50:20,869 --> 00:50:26,869
<font color="#E5E5E5">look everywhere</font>

1147
00:50:22,850 --> 00:50:28,759
no listen<font color="#CCCCCC"> is complete</font><font color="#E5E5E5"> and I'm afraid to</font>

1148
00:50:26,869 --> 00:50:30,950
say this and this is my honest opinion

1149
00:50:28,760 --> 00:50:33,500
of this<font color="#E5E5E5"> if you want to be a hundred</font>

1150
00:50:30,950 --> 00:50:36,319
percent sure<font color="#E5E5E5"> as some body and the</font>

1151
00:50:33,500 --> 00:50:38,240
audience also concluded<font color="#CCCCCC"> you have to</font>

1152
00:50:36,320 --> 00:50:39,080
<font color="#E5E5E5">really rebuild the environment from</font>

1153
00:50:38,240 --> 00:50:41,450
scratch

1154
00:50:39,080 --> 00:50:44,060
<font color="#E5E5E5">once</font><font color="#CCCCCC"> a domain admin always a domain</font>

1155
00:50:41,450 --> 00:50:45,740
admin<font color="#CCCCCC"> that's kind of the module I like</font>

1156
00:50:44,060 --> 00:50:47,750
<font color="#E5E5E5">to tell people out there in in</font>

1157
00:50:45,740 --> 00:50:51,290
organizations<font color="#E5E5E5"> they tend to give away</font>

1158
00:50:47,750 --> 00:50:53,810
these rights<font color="#E5E5E5"> like</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> you just hired</font><font color="#CCCCCC"> ok</font>

1159
00:50:51,290 --> 00:50:55,460
you have<font color="#CCCCCC"> to sit in</font><font color="#E5E5E5"> itu-r</font><font color="#CCCCCC"> IT help this</font>

1160
00:50:53,810 --> 00:50:57,680
guy you have to do some very important

1161
00:50:55,460 --> 00:51:00,410
things so now your domain admin<font color="#E5E5E5"> and from</font>

1162
00:50:57,680 --> 00:51:03,259
that point<font color="#E5E5E5"> he's gonna potentially on you</font>

1163
00:51:00,410 --> 00:51:07,310
<font color="#E5E5E5">for many many years until you reset the</font>

1164
00:51:03,260 --> 00:51:14,900
KBG<font color="#CCCCCC"> jejeje account or do some other</font>

1165
00:51:07,310 --> 00:51:16,730
stuff and just remember and the<font color="#E5E5E5"> checker</font>

1166
00:51:14,900 --> 00:51:19,280
could do all kinds of<font color="#E5E5E5"> answer forensics</font>

1167
00:51:16,730 --> 00:51:21,140
while being<font color="#E5E5E5"> in our environment so this</font>

1168
00:51:19,280 --> 00:51:23,270
<font color="#E5E5E5">that we look everywhere you maybe you</font>

1169
00:51:21,140 --> 00:51:25,870
looked but the attacker deleted some

1170
00:51:23,270 --> 00:51:30,520
stuff that should be there

1171
00:51:25,870 --> 00:51:34,600
<font color="#E5E5E5">and what is the state really out there</font>

1172
00:51:30,520 --> 00:51:40,120
on event monitoring<font color="#E5E5E5"> people say well we</font>

1173
00:51:34,600 --> 00:51:42,640
have a scene and we really<font color="#CCCCCC"> I</font><font color="#E5E5E5"> all it does</font>

1174
00:51:40,120 --> 00:51:45,880
<font color="#E5E5E5">many places</font><font color="#CCCCCC"> is just to collect</font><font color="#E5E5E5"> locks</font>

1175
00:51:42,640 --> 00:51:48,910
<font color="#E5E5E5">people don't really get anything of</font>

1176
00:51:45,880 --> 00:51:51,280
value out of it<font color="#CCCCCC"> maybe</font><font color="#E5E5E5"> you do</font><font color="#CCCCCC"> i would</font>

1177
00:51:48,910 --> 00:51:54,670
<font color="#E5E5E5">love to hear about it but what we see</font><font color="#CCCCCC"> as</font>

1178
00:51:51,280 --> 00:51:56,620
penetration<font color="#CCCCCC"> testing system</font><font color="#E5E5E5"> it's very</font><font color="#CCCCCC"> is</font>

1179
00:51:54,670 --> 00:52:01,120
it almost never happens that we<font color="#CCCCCC"> are</font>

1180
00:51:56,620 --> 00:52:03,009
<font color="#E5E5E5">spotted because of the seam thing anyway</font>

1181
00:52:01,120 --> 00:52:05,560
<font color="#E5E5E5">use your money</font><font color="#CCCCCC"> no use</font><font color="#E5E5E5"> your money</font>

1182
00:52:03,010 --> 00:52:10,360
somewhere else<font color="#CCCCCC"> use it to educate the</font>

1183
00:52:05,560 --> 00:52:13,180
administrators instead use it to<font color="#E5E5E5"> to get</font>

1184
00:52:10,360 --> 00:52:14,110
awareness around how<font color="#CCCCCC"> active directory</font>

1185
00:52:13,180 --> 00:52:18,100
<font color="#E5E5E5">really works</font>

1186
00:52:14,110 --> 00:52:20,050
that's my opinion<font color="#E5E5E5"> education</font><font color="#CCCCCC"> i have I</font>

1187
00:52:18,100 --> 00:52:21,520
could invent reinvent this and a lot of

1188
00:52:20,050 --> 00:52:23,800
stuff is actually also in the white

1189
00:52:21,520 --> 00:52:25,630
papers<font color="#E5E5E5"> i'm</font><font color="#CCCCCC"> going to</font><font color="#E5E5E5"> mention but</font><font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> this</font>

1190
00:52:23,800 --> 00:52:29,920
<font color="#CCCCCC">shawn metcalf i want to give a huge</font>

1191
00:52:25,630 --> 00:52:32,830
shout<font color="#E5E5E5"> up to him</font><font color="#CCCCCC"> i'm i'm a big fan</font><font color="#E5E5E5"> of his</font>

1192
00:52:29,920 --> 00:52:34,450
he doesn't<font color="#E5E5E5"> know but anyway he has</font><font color="#CCCCCC"> like</font>

1193
00:52:32,830 --> 00:52:37,360
some great<font color="#CCCCCC"> talks</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> def con and</font><font color="#E5E5E5"> black</font>

1194
00:52:34,450 --> 00:52:41,710
<font color="#E5E5E5">at this year and he</font><font color="#CCCCCC"> had</font><font color="#E5E5E5"> some mitigation</font>

1195
00:52:37,360 --> 00:52:44,140
steps that are very good

1196
00:52:41,710 --> 00:52:45,670
<font color="#CCCCCC">I may</font><font color="#E5E5E5"> not agree</font><font color="#CCCCCC"> with the order but</font>

1197
00:52:44,140 --> 00:52:49,569
instead of trying to reinvent something

1198
00:52:45,670 --> 00:52:52,660
new<font color="#CCCCCC"> i just added my own and is this is</font>

1199
00:52:49,570 --> 00:52:54,880
based on<font color="#CCCCCC"> and his work and we don't have</font>

1200
00:52:52,660 --> 00:52:57,430
time to go through without<font color="#E5E5E5"> it all this</font>

1201
00:52:54,880 --> 00:53:02,020
is<font color="#CCCCCC"> different</font><font color="#E5E5E5"> stuff you should definitely</font>

1202
00:52:57,430 --> 00:53:05,020
look at it<font color="#CCCCCC"> out here minimis</font><font color="#E5E5E5"> minimize</font><font color="#CCCCCC"> the</font>

1203
00:53:02,020 --> 00:53:08,680
<font color="#E5E5E5">the groups that have admin</font><font color="#CCCCCC"> that's just</font>

1204
00:53:05,020 --> 00:53:11,950
like basic stuff<font color="#E5E5E5"> go through these</font><font color="#CCCCCC"> i have</font>

1205
00:53:08,680 --> 00:53:14,410
five<font color="#E5E5E5"> lights of where this is going to</font>

1206
00:53:11,950 --> 00:53:16,750
surprise somebody the top one domain

1207
00:53:14,410 --> 00:53:18,879
happens<font color="#E5E5E5"> the</font><font color="#CCCCCC"> shoot</font><font color="#E5E5E5"> going on and what I</font>

1208
00:53:16,750 --> 00:53:21,580
want<font color="#E5E5E5"> to point out that this doesn't mean</font>

1209
00:53:18,880 --> 00:53:23,230
that an IT auditor should set up a

1210
00:53:21,580 --> 00:53:25,990
script that looks in this group and if

1211
00:53:23,230 --> 00:53:28,720
it's above<font color="#CCCCCC"> zero that's</font><font color="#E5E5E5"> going to be a red</font>

1212
00:53:25,990 --> 00:53:31,299
report<font color="#E5E5E5"> because even though it's</font><font color="#CCCCCC"> zero</font>

1213
00:53:28,720 --> 00:53:33,069
people<font color="#E5E5E5"> might be in other groups there</font>

1214
00:53:31,300 --> 00:53:35,830
might be delegation<font color="#CCCCCC"> I've gone through</font>

1215
00:53:33,070 --> 00:53:38,510
<font color="#E5E5E5">all of this that is a weakness in most</font>

1216
00:53:35,830 --> 00:53:40,190
<font color="#CCCCCC">accidentally environments</font><font color="#E5E5E5"> so just look</font>

1217
00:53:38,510 --> 00:53:41,900
in<font color="#E5E5E5"> a group I don't want to get there the</font>

1218
00:53:40,190 --> 00:53:44,090
people are thinking about domain admins

1219
00:53:41,900 --> 00:53:46,790
should be<font color="#CCCCCC"> so</font><font color="#E5E5E5"> all the time</font><font color="#CCCCCC"> so all</font><font color="#E5E5E5"> of</font>

1220
00:53:44,090 --> 00:53:49,280
these<font color="#E5E5E5"> things you've been</font><font color="#CCCCCC"> order</font>

1221
00:53:46,790 --> 00:53:50,990
there's like<font color="#CCCCCC"> a lot of tendency to just</font>

1222
00:53:49,280 --> 00:53:53,600
debate this issue that's what I'm saying

1223
00:53:50,990 --> 00:53:56,479
<font color="#E5E5E5">it's not all about the the default</font>

1224
00:53:53,600 --> 00:54:00,110
<font color="#E5E5E5">groups trust settings</font>

1225
00:53:56,480 --> 00:54:02,180
<font color="#CCCCCC">ok was that it actually have</font><font color="#E5E5E5"> some tools</font>

1226
00:54:00,110 --> 00:54:04,250
<font color="#E5E5E5">i would like to mention</font><font color="#CCCCCC"> i have mentioned</font>

1227
00:54:02,180 --> 00:54:06,410
<font color="#CCCCCC">maquettes you should have yourself you</font>

1228
00:54:04,250 --> 00:54:08,720
should definitely hang yourself<font color="#E5E5E5"> every</font>

1229
00:54:06,410 --> 00:54:11,270
<font color="#E5E5E5">organization should be able to to give</font>

1230
00:54:08,720 --> 00:54:13,310
permission<font color="#E5E5E5"> to people internally to try</font>

1231
00:54:11,270 --> 00:54:16,910
to hack themselves try to look at<font color="#CCCCCC"> this</font>

1232
00:54:13,310 --> 00:54:18,710
<font color="#E5E5E5">stuff</font><font color="#CCCCCC"> and we can do it also we get hired</font>

1233
00:54:16,910 --> 00:54:21,259
to stuff like that but everybody should

1234
00:54:18,710 --> 00:54:24,170
actually be able to to penetrate their

1235
00:54:21,260 --> 00:54:26,420
own environment try<font color="#E5E5E5"> to</font><font color="#CCCCCC"> i have a</font>

1236
00:54:24,170 --> 00:54:28,340
reference<font color="#E5E5E5"> a very new</font><font color="#CCCCCC"> 1i think it's from</font>

1237
00:54:26,420 --> 00:54:31,580
the<font color="#CCCCCC"> broken</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> 44 can</font><font color="#E5E5E5"> I don't remember</font>

1238
00:54:28,340 --> 00:54:32,780
<font color="#E5E5E5">there's a reference in my slides to a</font>

1239
00:54:31,580 --> 00:54:35,270
great

1240
00:54:32,780 --> 00:54:38,270
there's a great slide on some approaches

1241
00:54:35,270 --> 00:54:40,820
like<font color="#E5E5E5"> a step</font><font color="#CCCCCC"> 10-step</font><font color="#E5E5E5"> think what to do to</font>

1242
00:54:38,270 --> 00:54:44,480
<font color="#CCCCCC">want to try out like trying to get the</font>

1243
00:54:40,820 --> 00:54:46,190
service<font color="#CCCCCC"> principal</font><font color="#E5E5E5"> names on whatever you</font>

1244
00:54:44,480 --> 00:54:48,020
have registered in<font color="#E5E5E5"> in your</font><font color="#CCCCCC"> Active</font>

1245
00:54:46,190 --> 00:54:49,760
<font color="#CCCCCC">Directory because every service in</font>

1246
00:54:48,020 --> 00:54:52,670
actual<font color="#E5E5E5"> director like if you install a</font>

1247
00:54:49,760 --> 00:54:54,500
sequel server and you don't have to do

1248
00:54:52,670 --> 00:54:57,080
<font color="#CCCCCC">to do</font><font color="#E5E5E5"> much work to figure out that it's</font>

1249
00:54:54,500 --> 00:54:58,400
there you can just carry extra tree<font color="#E5E5E5"> and</font>

1250
00:54:57,080 --> 00:55:00,590
you can actually get the hash of the

1251
00:54:58,400 --> 00:55:03,410
service account<font color="#E5E5E5"> and that</font><font color="#CCCCCC"> is why one of</font>

1252
00:55:00,590 --> 00:55:06,200
these things is is make sure your

1253
00:55:03,410 --> 00:55:08,960
service account passwords<font color="#E5E5E5"> purpose</font>

1254
00:55:06,200 --> 00:55:11,689
<font color="#E5E5E5">service account passwords at least</font><font color="#CCCCCC"> are</font>

1255
00:55:08,960 --> 00:55:14,480
above 25 characters<font color="#E5E5E5"> or whatever you find</font>

1256
00:55:11,690 --> 00:55:17,690
this reasonable with the GPU<font color="#E5E5E5"> stuff we</font>

1257
00:55:14,480 --> 00:55:21,170
have<font color="#CCCCCC"> new it</font><font color="#E5E5E5"> now if we have a quantum</font>

1258
00:55:17,690 --> 00:55:23,570
maybe<font color="#CCCCCC"> she should</font><font color="#E5E5E5"> be</font><font color="#CCCCCC"> I don't know 1</font>

1259
00:55:21,170 --> 00:55:26,990
billion trillion<font color="#CCCCCC"> I don't know but I'm</font>

1260
00:55:23,570 --> 00:55:30,170
<font color="#CCCCCC">this one</font>

1261
00:55:26,990 --> 00:55:32,899
<font color="#CCCCCC">yeah just detecting the</font><font color="#E5E5E5"> stroller the</font>

1262
00:55:30,170 --> 00:55:34,790
bottom<font color="#CCCCCC"> the checking file integrity</font><font color="#E5E5E5"> for</font>

1263
00:55:32,900 --> 00:55:37,250
instance<font color="#E5E5E5"> on iso files for instance on</font>

1264
00:55:34,790 --> 00:55:38,840
the script files<font color="#E5E5E5"> the logon scripts that</font>

1265
00:55:37,250 --> 00:55:40,190
<font color="#E5E5E5">you're running</font><font color="#CCCCCC"> if they suddenly</font><font color="#E5E5E5"> change</font>

1266
00:55:38,840 --> 00:55:42,980
<font color="#CCCCCC">there should be a good reason for that</font>

1267
00:55:40,190 --> 00:55:44,990
<font color="#CCCCCC">window such</font><font color="#E5E5E5"> activity locker is buying</font>

1268
00:55:42,980 --> 00:55:47,660
<font color="#CCCCCC">see group we have a tool that can</font>

1269
00:55:44,990 --> 00:55:49,310
monitor<font color="#CCCCCC"> processes changing and and all</font>

1270
00:55:47,660 --> 00:55:51,980
kinds of nice things

1271
00:55:49,310 --> 00:55:56,509
it's kind of close to<font color="#E5E5E5"> someone that you</font>

1272
00:55:51,980 --> 00:55:58,850
may know this one

1273
00:55:56,510 --> 00:56:02,720
<font color="#CCCCCC">PJ I'm not many people i think i've</font>

1274
00:55:58,850 --> 00:56:05,750
heard of<font color="#E5E5E5"> it</font><font color="#CCCCCC"> it was</font><font color="#E5E5E5"> on the</font><font color="#CCCCCC"> Arsenal in the</font>

1275
00:56:02,720 --> 00:56:09,140
<font color="#CCCCCC">arsenal</font><font color="#E5E5E5"> room at blackhat and this guy</font>

1276
00:56:05,750 --> 00:56:11,420
from<font color="#CCCCCC"> Airbus the Airbus group here and</font>

1277
00:56:09,140 --> 00:56:15,170
they have a great tool that will take

1278
00:56:11,420 --> 00:56:18,050
the<font color="#CCCCCC"> NTDs</font><font color="#E5E5E5"> study it extracted and analyzed</font>

1279
00:56:15,170 --> 00:56:21,350
it and make make it possible to do a

1280
00:56:18,050 --> 00:56:24,650
comparison between<font color="#E5E5E5"> to like dates points</font>

1281
00:56:21,350 --> 00:56:27,170
in time<font color="#E5E5E5"> so we could say</font><font color="#CCCCCC"> okay we were</font>

1282
00:56:24,650 --> 00:56:29,510
<font color="#CCCCCC">attacked at this point</font><font color="#E5E5E5"> this is what is</font>

1283
00:56:27,170 --> 00:56:32,300
the active record looked like before

1284
00:56:29,510 --> 00:56:35,270
that<font color="#E5E5E5"> and how does</font><font color="#CCCCCC"> it look</font><font color="#E5E5E5"> now so you can</font>

1285
00:56:32,300 --> 00:56:37,640
do a very detailed analysis of<font color="#CCCCCC"> the</font>

1286
00:56:35,270 --> 00:56:42,950
<font color="#E5E5E5">delegation changes for instance not just</font>

1287
00:56:37,640 --> 00:56:45,080
<font color="#E5E5E5">groups advanced threat analytics from</font>

1288
00:56:42,950 --> 00:56:48,649
<font color="#CCCCCC">Microsoft</font><font color="#E5E5E5"> is coming out it will cost you</font>

1289
00:56:45,080 --> 00:56:50,750
money<font color="#CCCCCC"> it will</font><font color="#E5E5E5"> if you don't have the cows</font>

1290
00:56:48,650 --> 00:56:53,150
already<font color="#CCCCCC"> and many</font><font color="#E5E5E5"> people like many</font>

1291
00:56:50,750 --> 00:56:56,390
organizations actually do not<font color="#CCCCCC"> minor</font>

1292
00:56:53,150 --> 00:56:58,190
<font color="#CCCCCC">companies past but this is going to spot</font>

1293
00:56:56,390 --> 00:57:01,040
many of the attacks out there and it's

1294
00:56:58,190 --> 00:57:03,710
such a beautiful<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> almost like yeah</font>

1295
00:57:01,040 --> 00:57:05,660
<font color="#E5E5E5">it couldn't be any better</font><font color="#CCCCCC"> it's</font><font color="#E5E5E5"> it's</font>

1296
00:57:03,710 --> 00:57:07,970
tapping into the network interface of

1297
00:57:05,660 --> 00:57:11,149
<font color="#CCCCCC">the</font><font color="#E5E5E5"> main controls</font><font color="#CCCCCC"> it's not even part of</font>

1298
00:57:07,970 --> 00:57:13,549
the domain<font color="#E5E5E5"> and it's it's just listening</font>

1299
00:57:11,150 --> 00:57:16,609
for the traffic and watching the corpus

1300
00:57:13,550 --> 00:57:18,920
and the DNS traffic going on<font color="#CCCCCC"> really</font>

1301
00:57:16,609 --> 00:57:21,049
<font color="#CCCCCC">beautiful</font><font color="#E5E5E5"> and able to spot the most</font>

1302
00:57:18,920 --> 00:57:24,050
common things out there<font color="#CCCCCC"> i have a small</font>

1303
00:57:21,050 --> 00:57:25,880
tool<font color="#CCCCCC"> i must</font><font color="#E5E5E5"> admit</font><font color="#CCCCCC"> I'm i'm working on the</font>

1304
00:57:24,050 --> 00:57:27,950
next version that should be even better

1305
00:57:25,880 --> 00:57:29,960
<font color="#CCCCCC">I</font><font color="#E5E5E5"> don't have much time but this is just</font>

1306
00:57:27,950 --> 00:57:31,520
going to give a quick status of how does

1307
00:57:29,960 --> 00:57:34,130
this<font color="#CCCCCC"> actor-director</font><font color="#E5E5E5"> look so when</font><font color="#CCCCCC"> i get</font>

1308
00:57:31,520 --> 00:57:36,410
out<font color="#E5E5E5"> to the client</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> customer</font><font color="#CCCCCC"> and I</font>

1309
00:57:34,130 --> 00:57:38,670
prefer to run this before actually

1310
00:57:36,410 --> 00:57:41,040
cracking<font color="#CCCCCC"> other passwords</font><font color="#E5E5E5"> into</font><font color="#CCCCCC"> into</font>

1311
00:57:38,670 --> 00:57:43,290
<font color="#E5E5E5">main</font><font color="#CCCCCC"> and and compromising the the domain</font>

1312
00:57:41,040 --> 00:57:45,660
because<font color="#CCCCCC"> i have permission</font>

1313
00:57:43,290 --> 00:57:48,300
this is<font color="#E5E5E5"> going to give me a quick view of</font>

1314
00:57:45,660 --> 00:57:50,850
how the state is for instance if<font color="#CCCCCC"> i can</font>

1315
00:57:48,300 --> 00:57:53,250
see that the containers the computer

1316
00:57:50,850 --> 00:57:55,589
<font color="#E5E5E5">continuous is full of 500 computer</font>

1317
00:57:53,250 --> 00:57:57,300
objects<font color="#CCCCCC"> it's probably so</font><font color="#E5E5E5"> that they don't</font>

1318
00:57:55,590 --> 00:57:59,190
use active directory in the correct

1319
00:57:57,300 --> 00:58:01,110
manner<font color="#E5E5E5"> if they have guessed the council</font>

1320
00:57:59,190 --> 00:58:03,870
enable if they have<font color="#CCCCCC"> curves delegation I</font>

1321
00:58:01,110 --> 00:58:05,160
know this from this group<font color="#CCCCCC"> is surgery I</font>

1322
00:58:03,870 --> 00:58:09,120
can see when the<font color="#CCCCCC"> curb</font>

1323
00:58:05,160 --> 00:58:12,540
<font color="#CCCCCC">Gigi was last</font><font color="#E5E5E5"> reset so some shallots</font>

1324
00:58:09,120 --> 00:58:14,190
<font color="#E5E5E5">these guys</font><font color="#CCCCCC"> i really recommend people</font>

1325
00:58:12,540 --> 00:58:16,920
following these guys<font color="#E5E5E5"> if you are</font>

1326
00:58:14,190 --> 00:58:19,440
interested in the subject<font color="#CCCCCC"> they are</font>

1327
00:58:16,920 --> 00:58:22,080
really really really great at what

1328
00:58:19,440 --> 00:58:25,950
<font color="#CCCCCC">they're doing</font><font color="#E5E5E5"> and much better than I am</font>

1329
00:58:22,080 --> 00:58:30,120
<font color="#CCCCCC">so everything I know it's a</font><font color="#E5E5E5"> probably</font><font color="#CCCCCC"> to</font>

1330
00:58:25,950 --> 00:58:33,450
these guys fault<font color="#CCCCCC"> i have references in</font>

1331
00:58:30,120 --> 00:58:35,700
this as a<font color="#CCCCCC"> seven-man references probably</font>

1332
00:58:33,450 --> 00:58:38,100
Sean McAfee<font color="#E5E5E5"> I've</font><font color="#CCCCCC"> put in some very</font>

1333
00:58:35,700 --> 00:58:41,640
interesting<font color="#CCCCCC"> slides of his</font><font color="#E5E5E5"> also grant</font>

1334
00:58:38,100 --> 00:58:44,910
<font color="#CCCCCC">buger</font><font color="#E5E5E5"> from who did a talk at the at the</font>

1335
00:58:41,640 --> 00:58:46,589
<font color="#CCCCCC">defcon really interesting also about</font>

1336
00:58:44,910 --> 00:58:48,899
persistence<font color="#CCCCCC"> in Active Directory</font><font color="#E5E5E5"> he</font><font color="#CCCCCC"> goes</font>

1337
00:58:46,590 --> 00:58:54,570
a bit<font color="#E5E5E5"> more into the actual event the</font>

1338
00:58:48,900 --> 00:58:56,430
event IDs that<font color="#E5E5E5"> you can trace and see you</font>

1339
00:58:54,570 --> 00:58:58,650
can if you are able to handle that

1340
00:58:56,430 --> 00:59:03,299
amount of traffic actually in your

1341
00:58:58,650 --> 00:59:06,330
<font color="#CCCCCC">back-end</font><font color="#E5E5E5"> environment some amazing white</font>

1342
00:59:03,300 --> 00:59:08,460
<font color="#E5E5E5">papers</font><font color="#CCCCCC"> i</font><font color="#E5E5E5"> wanna hide</font><font color="#CCCCCC"> the mentioned in</font>

1343
00:59:06,330 --> 00:59:10,230
particular<font color="#E5E5E5"> or the</font><font color="#CCCCCC"> meeting pass the hash</font>

1344
00:59:08,460 --> 00:59:12,570
and other<font color="#CCCCCC"> credential</font><font color="#E5E5E5"> theft version too</font>

1345
00:59:10,230 --> 00:59:16,020
<font color="#E5E5E5">if you don't read</font><font color="#CCCCCC"> version1</font><font color="#E5E5E5"> just</font><font color="#CCCCCC"> great</font>

1346
00:59:12,570 --> 00:59:18,600
<font color="#CCCCCC">version to this</font><font color="#E5E5E5"> is where</font><font color="#CCCCCC"> Microsoft</font>

1347
00:59:16,020 --> 00:59:20,490
<font color="#CCCCCC">States assume</font><font color="#E5E5E5"> breach which is a mindset</font>

1348
00:59:18,600 --> 00:59:23,370
that everybody should have these days

1349
00:59:20,490 --> 00:59:25,620
you should be able to have an

1350
00:59:23,370 --> 00:59:31,020
environment where you know for sure that

1351
00:59:25,620 --> 00:59:33,089
one machine is back at least 11 users is

1352
00:59:31,020 --> 00:59:35,310
an insider<font color="#E5E5E5"> was trying to hurt you</font>

1353
00:59:33,090 --> 00:59:37,680
that should be your<font color="#E5E5E5"> mindset these days</font>

1354
00:59:35,310 --> 00:59:39,270
it shouldn't be that<font color="#E5E5E5"> all the bad guys</font>

1355
00:59:37,680 --> 00:59:40,799
<font color="#E5E5E5">out there they should</font><font color="#CCCCCC"> be the mindset</font>

1356
00:59:39,270 --> 00:59:42,630
should be<font color="#E5E5E5"> defense in death and you are</font>

1357
00:59:40,800 --> 00:59:44,670
able to protect even though they hit the

1358
00:59:42,630 --> 00:59:46,670
<font color="#E5E5E5">first machines in the environment like</font>

1359
00:59:44,670 --> 00:59:49,880
the clicking of the users

1360
00:59:46,670 --> 00:59:54,620
stuff<font color="#E5E5E5"> and one white paper</font><font color="#CCCCCC"> that is</font>

1361
00:59:49,880 --> 00:59:57,200
<font color="#CCCCCC">suddenly red because it's</font><font color="#E5E5E5"> it's huge</font>

1362
00:59:54,620 --> 00:59:59,060
by laura<font color="#E5E5E5"> robinson mainly as an editor</font>

1363
00:59:57,200 --> 01:00:00,830
best practices for securing<font color="#CCCCCC"> active</font>

1364
00:59:59,060 --> 01:00:02,840
<font color="#CCCCCC">directory</font><font color="#E5E5E5"> is really really good white</font>

1365
01:00:00,830 --> 01:00:05,270
paper and too few people actually read

1366
01:00:02,840 --> 01:00:08,450
it also lower here with an<font color="#E5E5E5"> admin free</font>

1367
01:00:05,270 --> 01:00:11,630
Active Directory<font color="#E5E5E5"> some great articles out</font>

1368
01:00:08,450 --> 01:00:17,419
there<font color="#CCCCCC"> so continuing with the references</font>

1369
01:00:11,630 --> 01:00:25,019
that was it

1370
01:00:17,420 --> 01:00:29,489
questions

1371
01:00:25,019 --> 01:00:32,129
<font color="#CCCCCC">thank</font><font color="#E5E5E5"> you thank you very much</font><font color="#CCCCCC"> shaking</font><font color="#E5E5E5"> so</font>

1372
01:00:29,489 --> 01:00:35,489
<font color="#CCCCCC">I don't know I I</font><font color="#E5E5E5"> don't know what I have</font>

1373
01:00:32,130 --> 01:00:38,069
<font color="#E5E5E5">kind of reaction to have</font><font color="#CCCCCC"> its sometimes</font>

1374
01:00:35,489 --> 01:00:40,769
you you hear<font color="#CCCCCC"> the expression if you don't</font>

1375
01:00:38,069 --> 01:00:45,058
do everything you've done nothing

1376
01:00:40,769 --> 01:00:48,629
<font color="#E5E5E5">yeah uh</font><font color="#CCCCCC"> by</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> I I critique people</font><font color="#E5E5E5"> for</font>

1377
01:00:45,059 --> 01:00:50,309
using<font color="#E5E5E5"> that uh that analogy but it kind</font>

1378
01:00:48,630 --> 01:00:53,039
of feels like<font color="#E5E5E5"> is there a point in trying</font>

1379
01:00:50,309 --> 01:00:55,499
to<font color="#CCCCCC"> salvage</font><font color="#E5E5E5"> things</font><font color="#CCCCCC"> is there a point in</font>

1380
01:00:53,039 --> 01:01:01,140
trying to salvage<font color="#CCCCCC"> lady</font>

1381
01:00:55,499 --> 01:01:04,408
yes I think<font color="#E5E5E5"> there is it is just a matter</font>

1382
01:01:01,140 --> 01:01:08,038
of how willing you are to<font color="#CCCCCC"> to take some</font>

1383
01:01:04,409 --> 01:01:11,459
risk because<font color="#E5E5E5"> I'm that's basically it</font><font color="#CCCCCC"> buu</font>

1384
01:01:08,039 --> 01:01:13,649
<font color="#CCCCCC">many companies are probably gonna close</font>

1385
01:01:11,459 --> 01:01:15,239
the doors and stuff business and<font color="#CCCCCC"> it</font><font color="#E5E5E5"> so</font>

1386
01:01:13,649 --> 01:01:17,669
it's a business decision really<font color="#E5E5E5"> it's not</font>

1387
01:01:15,239 --> 01:01:20,429
a technical decision<font color="#E5E5E5"> but it's a question</font>

1388
01:01:17,669 --> 01:01:22,558
<font color="#E5E5E5">is it's the functioning or not it will</font>

1389
01:01:20,429 --> 01:01:24,449
probably be functioning<font color="#CCCCCC"> I no actual</font>

1390
01:01:22,559 --> 01:01:26,009
<font color="#CCCCCC">directors out there</font><font color="#E5E5E5"> that are running</font>

1391
01:01:24,449 --> 01:01:28,409
where people know that they are

1392
01:01:26,009 --> 01:01:30,269
<font color="#E5E5E5">compromised to some extent and trying to</font>

1393
01:01:28,409 --> 01:01:31,859
build something more secure by the side

1394
01:01:30,269 --> 01:01:35,368
actually in the white paper you will<font color="#E5E5E5"> see</font>

1395
01:01:31,859 --> 01:01:39,328
and recommendation of having an<font color="#E5E5E5"> admin</font>

1396
01:01:35,369 --> 01:01:42,209
<font color="#CCCCCC">forst forst set up between a bit beside</font>

1397
01:01:39,329 --> 01:01:44,849
the<font color="#E5E5E5"> compromised maybe environment where</font>

1398
01:01:42,209 --> 01:01:47,519
you will have much more structure and

1399
01:01:44,849 --> 01:01:49,319
much more secure environment and being

1400
01:01:47,519 --> 01:01:51,118
able to administer that environment in a

1401
01:01:49,319 --> 01:01:53,009
secure way and<font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> not</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> go into</font>

1402
01:01:51,119 --> 01:01:55,079
<font color="#E5E5E5">that but</font><font color="#CCCCCC"> that's with ipsec settings and</font>

1403
01:01:53,009 --> 01:01:56,849
that was with the special way of

1404
01:01:55,079 --> 01:01:59,039
handling the<font color="#CCCCCC"> groups and then you'll from</font>

1405
01:01:56,849 --> 01:02:02,009
this point being a be able to handle the

1406
01:01:59,039 --> 01:02:05,819
other<font color="#CCCCCC"> actually</font><font color="#E5E5E5"> the thing is stuff like</font>

1407
01:02:02,009 --> 01:02:08,699
the<font color="#CCCCCC"> disunity doing state thing it could</font>

1408
01:02:05,819 --> 01:02:11,038
compromise still that you set up if you

1409
01:02:08,699 --> 01:02:12,719
have a security and we all live with the

1410
01:02:11,039 --> 01:02:15,029
fact that there are fewer days other

1411
01:02:12,719 --> 01:02:18,389
<font color="#E5E5E5">right now they're probably many more</font><font color="#CCCCCC"> she</font>

1412
01:02:15,029 --> 01:02:22,169
relation that we want to admit or<font color="#CCCCCC"> but</font>

1413
01:02:18,389 --> 01:02:25,319
<font color="#CCCCCC">think about</font><font color="#E5E5E5"> but I'm</font><font color="#CCCCCC"> yeah</font><font color="#E5E5E5"> we are</font>

1414
01:02:22,169 --> 01:02:27,118
vulnerable all the time and<font color="#CCCCCC"> I</font><font color="#E5E5E5"> think it's</font>

1415
01:02:25,319 --> 01:02:29,788
a matter of taking the steps where you

1416
01:02:27,119 --> 01:02:32,849
say these are low-hanging fruit so we

1417
01:02:29,789 --> 01:02:34,380
can actually get very far from<font color="#CCCCCC"> and</font>

1418
01:02:32,849 --> 01:02:36,010
that's why the things the mitigating

1419
01:02:34,380 --> 01:02:38,560
things are like in steps

1420
01:02:36,010 --> 01:02:42,340
<font color="#E5E5E5">start here then you will improve the</font>

1421
01:02:38,560 --> 01:02:45,700
security<font color="#E5E5E5"> but</font><font color="#CCCCCC"> i agree that we have</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> say</font>

1422
01:02:42,340 --> 01:02:47,830
or<font color="#E5E5E5"> incident responders</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> say</font><font color="#CCCCCC"> what we do</font>

1423
01:02:45,700 --> 01:02:51,370
when we come in we look for what the

1424
01:02:47,830 --> 01:02:54,370
attackers did so<font color="#CCCCCC"> with a try</font><font color="#E5E5E5"> to do some</font>

1425
01:02:51,370 --> 01:02:56,140
forensics but i'm not sure that all

1426
01:02:54,370 --> 01:02:57,790
forensics guys<font color="#E5E5E5"> who</font><font color="#CCCCCC"> are really</font><font color="#E5E5E5"> good</font><font color="#CCCCCC"> at</font>

1427
01:02:56,140 --> 01:03:00,759
looking<font color="#CCCCCC"> at for instance</font><font color="#E5E5E5"> network</font>

1428
01:02:57,790 --> 01:03:02,140
forensics or<font color="#CCCCCC"> just forensics</font><font color="#E5E5E5"> are</font>

1429
01:03:00,760 --> 01:03:03,910
necessarily<font color="#E5E5E5"> good at knowing what's</font>

1430
01:03:02,140 --> 01:03:05,140
happening inside<font color="#E5E5E5"> extra direction that</font>

1431
01:03:03,910 --> 01:03:07,569
there should be active directory

1432
01:03:05,140 --> 01:03:09,490
forensics<font color="#CCCCCC"> too</font><font color="#E5E5E5"> if you know what</font><font color="#CCCCCC"> I mean</font>

1433
01:03:07,570 --> 01:03:11,380
<font color="#E5E5E5">so</font><font color="#CCCCCC"> it's when something</font><font color="#E5E5E5"> bad has happened</font>

1434
01:03:09,490 --> 01:03:14,500
it's not enough to look at the discs of

1435
01:03:11,380 --> 01:03:15,640
<font color="#E5E5E5">offer of a few</font><font color="#CCCCCC"> computer</font><font color="#E5E5E5"> service in the</font>

1436
01:03:14,500 --> 01:03:17,170
environment and look at the<font color="#CCCCCC"> network</font>

1437
01:03:15,640 --> 01:03:19,240
traffic you should probably also look at

1438
01:03:17,170 --> 01:03:21,280
the at the<font color="#E5E5E5"> active directory itself but</font>

1439
01:03:19,240 --> 01:03:24,580
it's a matter of form and taking<font color="#CCCCCC"> risks</font>

1440
01:03:21,280 --> 01:03:26,080
<font color="#CCCCCC">and at some point you've done enough</font><font color="#E5E5E5"> and</font>

1441
01:03:24,580 --> 01:03:28,090
there are people out there who have been

1442
01:03:26,080 --> 01:03:31,509
<font color="#CCCCCC">very compromised a few weeks</font><font color="#E5E5E5"> after</font>

1443
01:03:28,090 --> 01:03:33,910
because they didn't take enough steps so

1444
01:03:31,510 --> 01:03:36,010
I using<font color="#E5E5E5"> my preference is</font><font color="#CCCCCC"> a using the</font>

1445
01:03:33,910 --> 01:03:37,660
<font color="#E5E5E5">using ad in the correct way</font><font color="#CCCCCC"> i think you</font>

1446
01:03:36,010 --> 01:03:39,850
said<font color="#CCCCCC"> yes</font>

1447
01:03:37,660 --> 01:03:43,060
<font color="#E5E5E5">references</font><font color="#CCCCCC"> like</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> incorrectly then</font>

1448
01:03:39,850 --> 01:03:44,170
and<font color="#CCCCCC"> yes stars there are correct ways of</font>

1449
01:03:43,060 --> 01:03:46,000
doing this

1450
01:03:44,170 --> 01:03:47,830
still<font color="#E5E5E5"> the series</font><font color="#CCCCCC"> is going to</font><font color="#E5E5E5"> be a</font>

1451
01:03:46,000 --> 01:03:49,510
problem if it's out there but<font color="#E5E5E5"> there are</font>

1452
01:03:47,830 --> 01:03:51,130
much better ways<font color="#E5E5E5"> of doing it</font><font color="#CCCCCC"> then we</font>

1453
01:03:49,510 --> 01:03:52,840
have<font color="#E5E5E5"> done so far and it's a matter of</font>

1454
01:03:51,130 --> 01:03:54,880
knowledge and getting it out there<font color="#E5E5E5"> how</font>

1455
01:03:52,840 --> 01:03:56,530
<font color="#CCCCCC">that should</font><font color="#E5E5E5"> be done and also getting the</font>

1456
01:03:54,880 --> 01:03:58,390
technical people to stand up to

1457
01:03:56,530 --> 01:04:01,450
management<font color="#CCCCCC"> and say he this needs to</font>

1458
01:03:58,390 --> 01:04:03,190
change because<font color="#E5E5E5"> I</font><font color="#CCCCCC"> I very often see that</font>

1459
01:04:01,450 --> 01:04:06,040
the technical people<font color="#E5E5E5"> that actually agree</font>

1460
01:04:03,190 --> 01:04:08,170
<font color="#E5E5E5">once they understand that what needs to</font>

1461
01:04:06,040 --> 01:04:10,509
happen that<font color="#E5E5E5"> the</font><font color="#CCCCCC"> workstation they work on</font>

1462
01:04:08,170 --> 01:04:12,760
<font color="#E5E5E5">needs to be</font><font color="#CCCCCC"> particularly protected and</font>

1463
01:04:10,510 --> 01:04:14,950
isolated from everything else and some

1464
01:04:12,760 --> 01:04:17,320
systems need to be isolated also<font color="#CCCCCC"> in a</font>

1465
01:04:14,950 --> 01:04:19,060
credential level etc etc<font color="#E5E5E5"> they agree on</font>

1466
01:04:17,320 --> 01:04:21,670
that<font color="#E5E5E5"> but bringing the</font><font color="#CCCCCC"> two</font><font color="#E5E5E5"> higher</font>

1467
01:04:19,060 --> 01:04:23,470
management<font color="#E5E5E5"> and seeing exactly why</font><font color="#CCCCCC"> I'm</font>

1468
01:04:21,670 --> 01:04:24,850
getting funding and getting approvals

1469
01:04:23,470 --> 01:04:27,250
and stuff they don't want to go there so

1470
01:04:24,850 --> 01:04:29,319
that's why sometimes<font color="#CCCCCC"> i have to kick in</font>

1471
01:04:27,250 --> 01:04:35,110
the door and and<font color="#CCCCCC"> try</font><font color="#E5E5E5"> to raise awareness</font>

1472
01:04:29,320 --> 01:04:36,760
and it<font color="#CCCCCC"> could be nice to have a</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> every</font>

1473
01:04:35,110 --> 01:04:39,350
<font color="#E5E5E5">time the technical guy standing behind</font>

1474
01:04:36,760 --> 01:04:42,170
and<font color="#CCCCCC"> seeing this has to be done because</font>

1475
01:04:39,350 --> 01:04:44,299
<font color="#CCCCCC">yeah</font><font color="#E5E5E5"> it's important</font><font color="#CCCCCC"> for this important</font>

1476
01:04:42,170 --> 01:04:47,840
<font color="#CCCCCC">i'm guessing we have questions in the</font>

1477
01:04:44,300 --> 01:04:50,900
audience<font color="#E5E5E5"> over here</font><font color="#CCCCCC"> or you're so are</font>

1478
01:04:47,840 --> 01:04:53,900
<font color="#E5E5E5">aware</font><font color="#CCCCCC"> think it's manual censored right</font>

1479
01:04:50,900 --> 01:04:56,900
now but how often<font color="#E5E5E5"> is running the system</font>

1480
01:04:53,900 --> 01:04:59,420
<font color="#CCCCCC">that it's correctly set up how</font><font color="#E5E5E5"> often do</font>

1481
01:04:56,900 --> 01:05:04,040
you run into<font color="#E5E5E5"> some</font><font color="#CCCCCC"> other secular systems</font>

1482
01:04:59,420 --> 01:05:09,260
or is<font color="#CCCCCC"> that</font><font color="#E5E5E5"> the majority</font><font color="#CCCCCC"> I I see a lot</font><font color="#E5E5E5"> of</font>

1483
01:05:04,040 --> 01:05:11,300
environments and it<font color="#E5E5E5"> there will always be</font>

1484
01:05:09,260 --> 01:05:13,190
room for improvement

1485
01:05:11,300 --> 01:05:15,140
so when I come<font color="#CCCCCC"> in I i should have</font>

1486
01:05:13,190 --> 01:05:18,050
something else to say<font color="#CCCCCC"> that they</font><font color="#E5E5E5"> already</font>

1487
01:05:15,140 --> 01:05:19,940
doing<font color="#E5E5E5"> and there will be stuff to do and</font>

1488
01:05:18,050 --> 01:05:20,570
maybe it's not right for them<font color="#CCCCCC"> maybe</font><font color="#E5E5E5"> it</font>

1489
01:05:19,940 --> 01:05:22,190
doesn't

1490
01:05:20,570 --> 01:05:25,550
they don't have to take that extra<font color="#E5E5E5"> step</font>

1491
01:05:22,190 --> 01:05:27,560
<font color="#E5E5E5">because of the</font><font color="#CCCCCC"> Fred and what do</font><font color="#E5E5E5"> you see</font>

1492
01:05:25,550 --> 01:05:30,050
the threats that they are facing<font color="#E5E5E5"> it</font>

1493
01:05:27,560 --> 01:05:31,820
might be an industry where is not that

1494
01:05:30,050 --> 01:05:34,130
relevant to be like<font color="#E5E5E5"> military-grade</font>

1495
01:05:31,820 --> 01:05:36,230
secure and having<font color="#E5E5E5"> an</font><font color="#CCCCCC"> African forest</font><font color="#E5E5E5"> for</font>

1496
01:05:34,130 --> 01:05:39,830
<font color="#CCCCCC">yourself it's surgery so it will depend</font>

1497
01:05:36,230 --> 01:05:42,200
<font color="#CCCCCC">there</font><font color="#E5E5E5"> will always be a next level</font><font color="#CCCCCC"> almost</font>

1498
01:05:39,830 --> 01:05:49,319
<font color="#CCCCCC">always I haven't</font><font color="#E5E5E5"> seen the perfect</font>

1499
01:05:42,200 --> 01:05:52,019
environment yet

1500
01:05:49,319 --> 01:05:58,680
<font color="#CCCCCC">the</font><font color="#E5E5E5"> microphone</font><font color="#CCCCCC"> here quickly i can</font>

1501
01:05:52,019 --> 01:06:00,538
<font color="#CCCCCC">recruit and the repeated yep one</font><font color="#E5E5E5"> quick</font>

1502
01:05:58,680 --> 01:06:03,690
thing to add is basically if you were to

1503
01:06:00,539 --> 01:06:06,900
go inside<font color="#CCCCCC"> its wood with microsoft and</font>

1504
01:06:03,690 --> 01:06:10,259
have a do this<font color="#CCCCCC"> it's intense intense</font>

1505
01:06:06,900 --> 01:06:12,690
intense monitoring of accounts and

1506
01:06:10,259 --> 01:06:15,630
<font color="#E5E5E5">logins and that sort of thing and then</font>

1507
01:06:12,690 --> 01:06:20,069
<font color="#E5E5E5">it's basically audit monitor audit</font>

1508
01:06:15,630 --> 01:06:22,349
monitor<font color="#CCCCCC"> and repeat</font><font color="#E5E5E5"> repeat repeat and</font><font color="#CCCCCC"> I</font>

1509
01:06:20,069 --> 01:06:24,449
mean like seriously<font color="#E5E5E5"> they know at the</font>

1510
01:06:22,349 --> 01:06:26,910
group<font color="#CCCCCC"> effort somebody adds to group</font>

1511
01:06:24,449 --> 01:06:30,150
<font color="#E5E5E5">professor bat you get</font><font color="#CCCCCC"> it's</font><font color="#E5E5E5"> caught like</font>

1512
01:06:26,910 --> 01:06:31,739
snap<font color="#CCCCCC"> yeah but it's it's a question of</font>

1513
01:06:30,150 --> 01:06:34,529
whether you want to make sure that you

1514
01:06:31,739 --> 01:06:36,569
you have the response to the fact that

1515
01:06:34,529 --> 01:06:39,089
you that anything changes you know

1516
01:06:36,569 --> 01:06:40,170
exactly what it was and exactly why it

1517
01:06:39,089 --> 01:06:45,569
happened

1518
01:06:40,170 --> 01:06:52,709
yeah<font color="#E5E5E5"> as</font><font color="#CCCCCC"> I said extra director defenses</font>

1519
01:06:45,569 --> 01:06:56,640
<font color="#E5E5E5">heart</font><font color="#CCCCCC"> it's not easy no more arms up I</font>

1520
01:06:52,709 --> 01:07:01,129
got<font color="#E5E5E5"> one over</font><font color="#CCCCCC"> there</font>

1521
01:06:56,640 --> 01:07:03,019
<font color="#E5E5E5">sorry making</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> run</font>

1522
01:07:01,130 --> 01:07:07,069
<font color="#E5E5E5">when you added the smart card</font>

1523
01:07:03,019 --> 01:07:09,200
authentication method it<font color="#CCCCCC"> in added a new</font>

1524
01:07:07,069 --> 01:07:11,420
sort of menu<font color="#E5E5E5"> option of the login prompt</font>

1525
01:07:09,200 --> 01:07:12,589
<font color="#E5E5E5">would that be hidden if the Machine</font>

1526
01:07:11,420 --> 01:07:14,660
didn't actually have<font color="#CCCCCC"> the smart card</font>

1527
01:07:12,589 --> 01:07:18,558
reader or<font color="#CCCCCC"> I mean it seems pretty obvious</font>

1528
01:07:14,660 --> 01:07:21,379
<font color="#CCCCCC">it will show that</font><font color="#E5E5E5"> i can because i'm</font>

1529
01:07:18,559 --> 01:07:23,809
<font color="#E5E5E5">using this enhanced session in hyper-v</font>

1530
01:07:21,380 --> 01:07:27,470
<font color="#E5E5E5">which will take whatever device</font><font color="#CCCCCC"> i have</font>

1531
01:07:23,809 --> 01:07:30,349
on my local<font color="#E5E5E5"> checker machine and and and</font>

1532
01:07:27,470 --> 01:07:32,000
we show them only to me<font color="#E5E5E5"> so it wouldn't</font>

1533
01:07:30,349 --> 01:07:34,460
be here if<font color="#E5E5E5"> it</font><font color="#CCCCCC"> that's</font><font color="#E5E5E5"> what</font><font color="#CCCCCC"> you get when</font>

1534
01:07:32,000 --> 01:07:38,779
you<font color="#CCCCCC"> sew in the</font><font color="#E5E5E5"> real world</font><font color="#CCCCCC"> set of if you</font>

1535
01:07:34,460 --> 01:07:41,509
if you started putting bring<font color="#CCCCCC"> that smart</font>

1536
01:07:38,779 --> 01:07:43,309
card authentication in and<font color="#CCCCCC"> have been</font>

1537
01:07:41,509 --> 01:07:46,039
<font color="#E5E5E5">went to a normal server it</font><font color="#CCCCCC"> wouldn't</font>

1538
01:07:43,309 --> 01:07:48,140
suddenly<font color="#CCCCCC"> out that no it only shows</font>

1539
01:07:46,039 --> 01:07:51,890
because<font color="#CCCCCC"> i'm showing at some hardware</font>

1540
01:07:48,140 --> 01:07:54,890
that has<font color="#CCCCCC"> smartcard</font><font color="#E5E5E5"> the device attached</font>

1541
01:07:51,890 --> 01:07:56,960
and<font color="#CCCCCC"> actually microsoft</font><font color="#E5E5E5"> causes the</font>

1542
01:07:54,890 --> 01:07:59,150
security wireless security device and

1543
01:07:56,960 --> 01:08:02,750
they<font color="#E5E5E5"> call</font><font color="#CCCCCC"> this marcus smart device but</font>

1544
01:07:59,150 --> 01:08:04,549
also in a remote<font color="#E5E5E5"> desktop session w it</font>

1545
01:08:02,750 --> 01:08:06,410
works<font color="#E5E5E5"> till you can still bring</font><font color="#CCCCCC"> you a</font>

1546
01:08:04,549 --> 01:08:09,740
<font color="#E5E5E5">smart</font><font color="#CCCCCC"> cards in a remote</font><font color="#E5E5E5"> desktop session</font>

1547
01:08:06,410 --> 01:08:12,348
so it doesn't have to look like this its

1548
01:08:09,740 --> 01:08:17,299
virtual<font color="#CCCCCC"> that's the virtual world that</font>

1549
01:08:12,349 --> 01:08:18,679
<font color="#E5E5E5">the virtual</font><font color="#CCCCCC"> hearts virtual</font><font color="#E5E5E5"> everything</font><font color="#CCCCCC"> I</font>

1550
01:08:17,299 --> 01:08:20,479
<font color="#E5E5E5">said there's no more questions I'm going</font>

1551
01:08:18,679 --> 01:08:26,949
to have you first of all<font color="#CCCCCC"> big-hat</font>

1552
01:08:20,479 --> 01:08:26,948
applause<font color="#E5E5E5"> good thank you</font>

