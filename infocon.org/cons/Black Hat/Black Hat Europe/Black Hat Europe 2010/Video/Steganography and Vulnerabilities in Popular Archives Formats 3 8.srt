1
00:00:00,060 --> 00:00:04,089
another few standpoint we found multiple
ways of finding files and formats and we

2
00:00:04,089 --> 00:00:04,509
gonna

3
00:00:04,509 --> 00:00:08,570
so a couple those in our demo at they
are quite nice

4
00:00:08,570 --> 00:00:13,019
nicely with incredible abilities we
found now from the one who built the

5
00:00:13,019 --> 00:00:16,690
standpoint be found high probability of
malware detection evasion

6
00:00:16,690 --> 00:00:19,830
so hunting over scanners affected by
these

7
00:00:19,830 --> 00:00:23,650
15 report the one abilities with more
pending at

8
00:00:23,650 --> 00:00:27,830
were unable to crack people says the
entire archive and that therefore

9
00:00:27,830 --> 00:00:31,279
were missing some them all over back
inside it

10
00:00:31,279 --> 00:00:34,460
now a their few

11
00:00:34,460 --> 00:00:37,870
types of struck level we can decide to
this you can say it's very high and it's

12
00:00:37,870 --> 00:00:38,480
critical

13
00:00:38,480 --> 00:00:43,120
because if you are at the gateway and
you want to scan all the email in old

14
00:00:43,120 --> 00:00:44,420
pas the computer network

15
00:00:44,420 --> 00:00:47,989
you gonna want to be able to scan
everything but

16
00:00:47,989 --> 00:00:51,910
if you're scanning on the death of or
your end points there's low impact

17
00:00:51,910 --> 00:00:52,559
because

18
00:00:52,559 --> 00:00:57,270
at for that malware to execute you still
have to extract it and that's where the

19
00:00:57,270 --> 00:01:00,440
anti-malware scanners gonna catch it so
any pending

20
00:01:00,440 --> 00:01:04,750
oh no which suffer security product you
are looking at

21
00:01:04,750 --> 00:01:08,189
the impact is either high or low

22
00:01:08,189 --> 00:01:13,770
now a we're gonna go over this thing on
a pea in the zip file format only

23
00:01:13,770 --> 00:01:17,110
and its achieved by a

24
00:01:17,110 --> 00:01:20,750
modifying the name all compressed file
inside heather's

25
00:01:20,750 --> 00:01:23,860
so basically just by inserting

26
00:01:23,860 --> 00:01:28,220
a new character in front in the first
the leather or the compressed file

27
00:01:28,220 --> 00:01:31,369
you are able to hide files from you

28
00:01:31,369 --> 00:01:36,020
but that only works for WinRAR and other
processors will show up

29
00:01:36,020 --> 00:01:42,399
and the and defiles lot now there are
other ways you can successfully hi files

30
00:01:42,399 --> 00:01:43,299
from oil guy

31
00:01:43,299 --> 00:01:47,509
microprocessors such as decreasing the
number of fact files inside Heather

32
00:01:47,509 --> 00:01:51,229
so if you have the last file backed
because the crease number and lost I'll

33
00:01:51,229 --> 00:01:52,530
not be registered

34
00:01:52,530 --> 00:01:55,799
and we can use extra fields and the
zipper

35
00:01:55,799 --> 00:02:00,020
following addition to camouflage some
the header data and can move the central

36
00:02:00,020 --> 00:02:00,689
directory

37
00:02:00,689 --> 00:02:04,640
to hide eat up from start to the archive
and we can also inject you dean of

38
00:02:04,640 --> 00:02:05,119
course

39
00:02:05,119 --> 00:02:08,379
now what are the implications of this
the color P

40
00:02:08,379 --> 00:02:11,580
point the other can of course be hidden
in zip archive

41
00:02:11,580 --> 00:02:16,700
but they can also be is hidden in the 00
XML file format which is the Open Office

42
00:02:16,700 --> 00:02:19,480
Excel file format to use buy microsoft
office

43
00:02:19,480 --> 00:02:24,910
but which is basically an basically just
zip archive containing lots of XML files

44
00:02:24,910 --> 00:02:28,989
so since this applies to archives it
also applies to the

45
00:02:28,989 --> 00:02:32,610
Microsoft Office file format now

46
00:02:32,610 --> 00:02:36,890
this is what's important because if we
have injected data inside a bit

47
00:02:36,890 --> 00:02:40,890
it can some struck and he can do that by
EE

48
00:02:40,890 --> 00:02:44,200
by the actions performed by the user

49
00:02:44,200 --> 00:02:49,160
so if I would too behind to file inside
word document and what you would to open

50
00:02:49,160 --> 00:02:50,050
that kinda file

51
00:02:50,050 --> 00:02:53,810
like South office with tell you this
file was damaged you want to repair it

52
00:02:53,810 --> 00:02:57,750
and as soon as you do the file the
injectors mammography data is gone

53
00:02:57,750 --> 00:03:01,190
saying can be achieved by AT&T fighters
author because

54
00:03:01,190 --> 00:03:04,909
if you back tomorrow we're inside and
additionally hi some single dating site

55
00:03:04,909 --> 00:03:05,250
at

56
00:03:05,250 --> 00:03:08,680
so if you're expecting that kinda filing
have a 92 artists wrecking

57
00:03:08,680 --> 00:03:12,050
gonna say oh I found the mall were in
this you wanna clean it and as soon as

58
00:03:12,050 --> 00:03:13,250
you do the data is gone

59
00:03:13,250 --> 00:03:16,290
so from the forensic standpoint

60
00:03:16,290 --> 00:03:21,239
if you are expecting the data and you
must make sure that no other tool is

61
00:03:21,239 --> 00:03:21,909
gonna

62
00:03:21,909 --> 00:03:25,989
interfere with the evidence course now

63
00:03:25,989 --> 00:03:29,280
implementations we found because we
didn't really invent this

64
00:03:29,280 --> 00:03:31,730
and we've been dealing with the great
you problems there are some

65
00:03:31,730 --> 00:03:32,900
implementations you can

66
00:03:32,900 --> 00:03:36,260
see on the Internet they're sitting on
the bike trainer John

67
00:03:36,260 --> 00:03:40,400
its published by CBO license it can kind
multiple files

68
00:03:40,400 --> 00:03:44,010
a his side zip archive which is stored
just before the central directory

69
00:03:44,010 --> 00:03:47,900
it can also encrypt files with password
and there's another solution

70
00:03:47,900 --> 00:03:51,709
song is called the gym ass by this issue
it's a freeware tool

71
00:03:51,709 --> 00:03:56,069
it sir can only height 150 inside

72
00:03:56,069 --> 00:04:00,260
either sit or a state-backed file it
does that by free pending the file to

73
00:04:00,260 --> 00:04:00,890
the archive

74
00:04:00,890 --> 00:04:04,010
it also damages the file in the process

75
00:04:04,010 --> 00:04:07,319
but it could be decompressed the
generically so

76
00:04:07,319 --> 00:04:10,930
if you use a top there's just such as
going well you will be able to

77
00:04:10,930 --> 00:04:12,030
decompress that america

78
00:04:12,030 --> 00:04:16,340
but since that's not valid archive we
really didn't want to bother with that

79
00:04:16,340 --> 00:04:19,639
now we can disclose the

80
00:04:19,639 --> 00:04:23,340
pitting one abilities we found not
before we do that

81
00:04:23,340 --> 00:04:27,169
I just want to say that we acted
responsibly this way and we

82
00:04:27,169 --> 00:04:31,389
published I'll we did this post oldest
one abilities to the affected when

83
00:04:31,389 --> 00:04:31,860
there's

84
00:04:31,860 --> 00:04:35,800
with this issue a shin with the
certified so

85
00:04:35,800 --> 00:04:42,240
overtime a most important thing is to
bring our investigation and stuff you

86
00:04:42,240 --> 00:04:43,130
gonna see now

87
00:04:43,130 --> 00:04:46,840
is mostly related to use it but that
there's at least one

88
00:04:46,840 --> 00:04:51,090
liberty for each of the affect file
formats so

89
00:04:51,090 --> 00:04:55,570
most these are zip the first one is
caused by excessive further

90
00:04:55,570 --> 00:04:57,310
modifications so what we did here

91
00:04:57,310 --> 00:05:00,520
is we wanted to create their own mistake
and other people in addition to

92
00:05:00,520 --> 00:05:04,080
decir till and in the process a we

93
00:05:04,080 --> 00:05:08,300
successfully hit have him in the file
but we did express some modification

94
00:05:08,300 --> 00:05:12,440
to the file header and S what caused the
problem with some

95
00:05:12,440 --> 00:05:16,360
securities operators so here's what we
did

96
00:05:16,360 --> 00:05:20,430
no we you sent to the rectory fields

97
00:05:20,430 --> 00:05:25,430
to store some information which broke
the file format to intentionally

98
00:05:25,430 --> 00:05:29,630
and and replace the first me if I name
on file with

99
00:05:29,630 --> 00:05:32,949
0 and you raise at the local other
content

100
00:05:32,949 --> 00:05:37,759
so that's why archive for the processors
in and why would suffer didn't really

101
00:05:37,759 --> 00:05:39,720
work right

102
00:05:39,720 --> 00:05:44,539
the second one was anyone could thought
this but this was a cool thing to try

103
00:05:44,539 --> 00:05:48,460
we partially protected in October the
passport so be protected the first file

104
00:05:48,460 --> 00:05:51,930
which is just an image with the password
and all the other files in the archive

105
00:05:51,930 --> 00:05:55,130
weren't protected with the password so
you can

106
00:05:55,130 --> 00:05:58,830
actually I'm normally and some antivirus
vendors a

107
00:05:58,830 --> 00:06:02,080
when correctly process this archive they
would find first follicles

108
00:06:02,080 --> 00:06:07,830
password protected and they're just
article like I was

109
00:06:07,830 --> 00:06:11,009
now this one next one is the this

110
00:06:11,009 --> 00:06:14,360
weird how bright hybrid the commented we
talked about

111
00:06:14,360 --> 00:06:18,210
so this is pretty II anything to do what
they did

112
00:06:18,210 --> 00:06:21,569
as we compressed a complicated stempel

113
00:06:21,569 --> 00:06:24,970
and we created a self-extracting
executable

114
00:06:24,970 --> 00:06:28,060
what is it and no 12 hours in the world
had a problem with this

115
00:06:28,060 --> 00:06:31,370
get because and as if it's a specific
format

116
00:06:31,370 --> 00:06:34,440
and when you are identifying the zip
archive you're going from the

117
00:06:34,440 --> 00:06:37,669
end of the file so what's being wanted
do is just

118
00:06:37,669 --> 00:06:41,840
offend another zip file to the end of
the ARCA to the end the SPX file

119
00:06:41,840 --> 00:06:45,080
and that's why when you are scanning the
archive you will be able

120
00:06:45,080 --> 00:06:49,280
only to see the last file which was
append and the SFX content which was

121
00:06:49,280 --> 00:06:52,910
extracted normally when you start to the
SFX program

122
00:06:52,910 --> 00:06:56,410
a to compress content was mother of
course

123
00:06:56,410 --> 00:07:00,949
and some and about as fun as well went
and this was the correct way to force

124
00:07:00,949 --> 00:07:01,830
Canada

125
00:07:01,830 --> 00:07:05,120
the file from the end and that's why the
only found

126
00:07:05,120 --> 00:07:09,680
the clean archive a pendant

127
00:07:09,680 --> 00:07:13,490
now p this morning is wanted the second
week

128
00:07:13,490 --> 00:07:17,449
implications to the zip archives so
there's an extra field

129
00:07:17,449 --> 00:07:21,220
behind every central directory entry
into

130
00:07:21,220 --> 00:07:25,340
deeper file Heather and if you uses data
which

131
00:07:25,340 --> 00:07:28,440
isn't really commonly used by any of the
archive processors

132
00:07:28,440 --> 00:07:33,240
you will be able to hide some data
behind it so by damaging d heather is

133
00:07:33,240 --> 00:07:34,090
that like that

134
00:07:34,090 --> 00:07:37,650
and just cloaking next next to item

135
00:07:37,650 --> 00:07:41,940
E enters zipper Heather we were able to

136
00:07:41,940 --> 00:07:45,410
successfully hi I'm over it because
antivirus of the just skip over that

137
00:07:45,410 --> 00:07:47,949
because they would

138
00:07:47,949 --> 00:07:50,970
processing the exe feel correctly

139
00:07:50,970 --> 00:07:55,860
now another weird file format example is
the

140
00:07:55,860 --> 00:08:00,000
which when I mentioned earlier is a way
to be and that some fields

141
00:08:00,000 --> 00:08:05,650
dude is a park I which made it look like
a sieve 64 but no

142
00:08:05,650 --> 00:08:09,030
I co-processor thought it was exit exit
64 it poses that

143
00:08:09,030 --> 00:08:12,410
that normally so that was a and there
are with the

144
00:08:12,410 --> 00:08:16,300
indicating the file formats of

145
00:08:16,300 --> 00:08:20,680
now a in next one is realigning the file
to you the

146
00:08:20,680 --> 00:08:24,639
forty hex bytes and realigned is quoted
because

147
00:08:24,639 --> 00:08:28,500
we leading to realign anything we just
that beep and bites

148
00:08:28,500 --> 00:08:31,500
and that actually breaks the archive

149
00:08:31,500 --> 00:08:36,950
but sense the the procurement has both
central and local directories you can

150
00:08:36,950 --> 00:08:40,209
also extract is the the genetically

151
00:08:40,209 --> 00:08:44,779
at and soccer which does that is WinRAR
and it was the only one who was able to

152
00:08:44,779 --> 00:08:46,560
do it

153
00:08:46,560 --> 00:08:49,649
and that of course even though this
isn't a valid archive

154
00:08:49,649 --> 00:08:54,220
it if it's still extractable by at least
$1.2 all

155
00:08:54,220 --> 00:08:58,880
anti-virus vendors want to support that
case as well

156
00:08:58,880 --> 00:09:02,320
now we use the fun common feel which is

157
00:09:02,320 --> 00:09:06,250
exactly the same like the extra field is
just additional data behind

158
00:09:06,250 --> 00:09:10,339
every entry in the head there and since
this is rarely used

159
00:09:10,339 --> 00:09:14,250
field and we haven't seen any of the
files using this

160
00:09:14,250 --> 00:09:19,000
some anti-virus when there's more just
confused about where to next heather is

161
00:09:19,000 --> 00:09:19,680
and didn't

162
00:09:19,680 --> 00:09:23,209
ways can the whole archive

163
00:09:23,209 --> 00:09:26,920
in the next one is also weird kinda
format

164
00:09:26,920 --> 00:09:30,950
a 82 placed the bet confessional written
but there's some pretty bad

165
00:09:30,950 --> 00:09:35,399
because specially crafted X File which
was introduced in wins it

166
00:09:35,399 --> 00:09:39,320
well version a it has a new compression

167
00:09:39,320 --> 00:09:42,399
4.8 X files themselves so if you
compressed

168
00:09:42,399 --> 00:09:46,390
a single image which is at a packed with
this new

169
00:09:46,390 --> 00:09:49,810
as effects were Asian and you just
rename the file said

170
00:09:49,810 --> 00:09:52,980
and use any other two in the world at
I'm another file

171
00:09:52,980 --> 00:09:57,089
inside that particular II we still have
a valid zip file because

172
00:09:57,089 --> 00:09:59,870
all headers on the same between the new
file

