1
00:00:00,000 --> 00:00:03,959
hello everybody welcome<font color="#CCCCCC"> to off</font><font color="#E5E5E5"> path</font>

2
00:00:02,760 --> 00:00:05,720
attacks against public key

3
00:00:03,959 --> 00:00:08,400
infrastructures

4
00:00:05,720 --> 00:00:10,800
my name is<font color="#CCCCCC"> Ilya safe dish and I'm a</font>

5
00:00:08,400 --> 00:00:12,360
student<font color="#E5E5E5"> at he security researcher for</font>

6
00:00:10,800 --> 00:00:14,370
<font color="#CCCCCC">Villanova</font><font color="#E5E5E5"> Institute for secure</font>

7
00:00:12,360 --> 00:00:16,890
information technology based in

8
00:00:14,370 --> 00:00:18,720
Darmstadt Germany<font color="#CCCCCC"> my</font><font color="#E5E5E5"> focus is on</font>

9
00:00:16,890 --> 00:00:22,710
<font color="#CCCCCC">Internet security in general and DNS</font>

10
00:00:18,720 --> 00:00:25,169
caches in particular my talk will be

11
00:00:22,710 --> 00:00:26,789
<font color="#E5E5E5">structured as follows</font><font color="#CCCCCC"> first we go</font>

12
00:00:25,170 --> 00:00:28,760
through<font color="#CCCCCC"> the objectives what are we going</font>

13
00:00:26,789 --> 00:00:31,489
to<font color="#E5E5E5"> attack and how are we going to do it</font>

14
00:00:28,760 --> 00:00:35,070
followed by<font color="#CCCCCC"> a</font><font color="#E5E5E5"> specific attack procedure</font>

15
00:00:31,489 --> 00:00:37,800
<font color="#E5E5E5">short impact analysis and discussion of</font>

16
00:00:35,070 --> 00:00:41,280
<font color="#E5E5E5">mitigation approaches</font><font color="#CCCCCC"> I conclude with a</font>

17
00:00:37,800 --> 00:00:45,030
summary let's start right off with<font color="#E5E5E5"> the</font>

18
00:00:41,280 --> 00:00:46,890
objectives in this presentation I'm

19
00:00:45,030 --> 00:00:47,520
going to<font color="#E5E5E5"> show</font><font color="#CCCCCC"> you a</font><font color="#E5E5E5"> specific attack on</font>

20
00:00:46,890 --> 00:00:49,860
web<font color="#CCCCCC"> PKI</font>

21
00:00:47,520 --> 00:00:50,520
but what is web peek a good for in the

22
00:00:49,860 --> 00:00:53,280
first<font color="#CCCCCC"> place</font>

23
00:00:50,520 --> 00:00:56,149
so assume a client wants<font color="#CCCCCC"> to exchange</font>

24
00:00:53,280 --> 00:00:59,550
sensitive data<font color="#E5E5E5"> with</font><font color="#CCCCCC"> the web server and</font>

25
00:00:56,149 --> 00:01:02,039
that connection<font color="#E5E5E5"> wasn't secured</font><font color="#CCCCCC"> it could</font>

26
00:00:59,550 --> 00:01:03,569
be if<font color="#CCCCCC"> stopped on or modified by a</font>

27
00:01:02,039 --> 00:01:07,920
nation-state attackers or the common

28
00:01:03,570 --> 00:01:11,820
<font color="#E5E5E5">evildoers to prevent that there's TLS</font>

29
00:01:07,920 --> 00:01:15,570
and TLS use user certificates that<font color="#CCCCCC"> bind</font>

30
00:01:11,820 --> 00:01:17,189
the public key<font color="#CCCCCC"> to identities and these</font>

31
00:01:15,570 --> 00:01:19,350
certificates<font color="#E5E5E5"> are issued by trusted</font>

32
00:01:17,189 --> 00:01:21,809
certificate authorities and the system

33
00:01:19,350 --> 00:01:26,130
<font color="#E5E5E5">that</font><font color="#CCCCCC"> manages</font><font color="#E5E5E5"> trust</font><font color="#CCCCCC"> behind these</font><font color="#E5E5E5"> is the</font>

34
00:01:21,810 --> 00:01:28,049
web<font color="#CCCCCC"> PKI if an attacker I used a</font>

35
00:01:26,130 --> 00:01:30,149
certificate which was not signed by a

36
00:01:28,049 --> 00:01:31,290
trusted certificate<font color="#E5E5E5"> authority</font><font color="#CCCCCC"> may be on</font>

37
00:01:30,150 --> 00:01:33,420
a man-in-the-middle attack or a

38
00:01:31,290 --> 00:01:36,960
personation attack<font color="#E5E5E5"> that attack would be</font>

39
00:01:33,420 --> 00:01:38,460
noticed our goal today is to have such a

40
00:01:36,960 --> 00:01:41,460
certificate issued<font color="#CCCCCC"> by a trusted</font>

41
00:01:38,460 --> 00:01:43,048
<font color="#CCCCCC">certificate authority but for a domain</font>

42
00:01:41,460 --> 00:01:46,530
which we do<font color="#E5E5E5"> not control but is rather on</font>

43
00:01:43,049 --> 00:01:48,270
<font color="#E5E5E5">the foreign operation the attacker model</font>

44
00:01:46,530 --> 00:01:51,090
we<font color="#E5E5E5"> are employing here is an off path</font>

45
00:01:48,270 --> 00:01:53,699
attacker who cannot eavesdrop on<font color="#CCCCCC"> blocked</font>

46
00:01:51,090 --> 00:01:55,530
delay or modified packets in any way he

47
00:01:53,700 --> 00:01:58,590
just is<font color="#CCCCCC"> able</font><font color="#E5E5E5"> to inject packets may be</font>

48
00:01:55,530 --> 00:02:00,270
with<font color="#E5E5E5"> spoofed and address the attack I'm</font>

49
00:01:58,590 --> 00:02:02,549
going to show you will leverage<font color="#CCCCCC"> IP the</font>

50
00:02:00,270 --> 00:02:04,530
<font color="#CCCCCC">fermentation cache poisoning to</font><font color="#E5E5E5"> achieve</font>

51
00:02:02,549 --> 00:02:08,039
<font color="#E5E5E5">DNS cache poisoning and we are</font><font color="#CCCCCC"> exporting</font>

52
00:02:04,530 --> 00:02:11,250
<font color="#E5E5E5">domain validation the manual Edition was</font>

53
00:02:08,038 --> 00:02:13,290
the mechanism<font color="#CCCCCC"> with which one can prove</font>

54
00:02:11,250 --> 00:02:15,590
<font color="#E5E5E5">ones ownership</font><font color="#CCCCCC"> over domain</font>

55
00:02:13,290 --> 00:02:18,420
and it's not heavily<font color="#E5E5E5"> made use of</font>

56
00:02:15,590 --> 00:02:20,810
conditions of certificates<font color="#E5E5E5"> let's see how</font>

57
00:02:18,420 --> 00:02:20,809
<font color="#CCCCCC">that works</font>

58
00:02:21,200 --> 00:02:26,730
so first the applicant creates<font color="#E5E5E5"> a</font>

59
00:02:24,780 --> 00:02:28,409
certificate signing request locally and

60
00:02:26,730 --> 00:02:31,590
uploads<font color="#E5E5E5"> it to the web server of the</font>

61
00:02:28,409 --> 00:02:33,060
certificate authority<font color="#E5E5E5"> then the DNS</font>

62
00:02:31,590 --> 00:02:35,400
<font color="#E5E5E5">resolver of the certificate authority</font>

63
00:02:33,060 --> 00:02:37,079
<font color="#CCCCCC">will ask the name server which is</font>

64
00:02:35,400 --> 00:02:39,420
authoritative for<font color="#E5E5E5"> the applicants domain</font>

65
00:02:37,079 --> 00:02:41,939
for the email<font color="#E5E5E5"> service name and IP</font>

66
00:02:39,420 --> 00:02:45,659
address which will answer that<font color="#E5E5E5"> of course</font>

67
00:02:41,939 --> 00:02:47,400
<font color="#CCCCCC">and now the email server sends</font><font color="#E5E5E5"> a</font>

68
00:02:45,659 --> 00:02:49,709
<font color="#E5E5E5">validation code for the domain</font>

69
00:02:47,400 --> 00:02:53,489
validation<font color="#E5E5E5"> to the mail server under the</font>

70
00:02:49,709 --> 00:02:57,060
applicants control using that validation

71
00:02:53,489 --> 00:02:59,459
<font color="#E5E5E5">code</font><font color="#CCCCCC"> the applicant can now enter it and</font>

72
00:02:57,060 --> 00:03:02,040
<font color="#E5E5E5">into the web server</font><font color="#CCCCCC"> of the certificate</font>

73
00:02:59,459 --> 00:03:05,099
authority which will then offer the same

74
00:03:02,040 --> 00:03:09,840
<font color="#CCCCCC">certificate for download what we are</font>

75
00:03:05,099 --> 00:03:12,450
going<font color="#CCCCCC"> to do now is</font><font color="#E5E5E5"> we</font><font color="#CCCCCC"> are going through</font>

76
00:03:09,840 --> 00:03:17,189
poison doing SEO service cache so that

77
00:03:12,450 --> 00:03:18,929
<font color="#CCCCCC">the validation</font><font color="#E5E5E5"> code is sent</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> us so to</font>

78
00:03:17,189 --> 00:03:22,400
better understand<font color="#CCCCCC"> that</font>

79
00:03:18,930 --> 00:03:24,389
let's first we have some concept of DNS

80
00:03:22,400 --> 00:03:26,639
when a client<font color="#CCCCCC"> wants to know an IP</font>

81
00:03:24,389 --> 00:03:29,579
address<font color="#CCCCCC"> of hosts on the</font><font color="#E5E5E5"> internet it will</font>

82
00:03:26,639 --> 00:03:31,530
<font color="#E5E5E5">ask its</font><font color="#CCCCCC"> DNS</font><font color="#E5E5E5"> resolver</font><font color="#CCCCCC"> for that and if the</font>

83
00:03:29,579 --> 00:03:33,569
resolver has already cached<font color="#E5E5E5"> the answer</font>

84
00:03:31,530 --> 00:03:36,180
from<font color="#E5E5E5"> the peers request it will answer</font>

85
00:03:33,569 --> 00:03:37,679
with<font color="#CCCCCC"> that phone cache and if not it will</font>

86
00:03:36,180 --> 00:03:41,069
do a recursive lookup of the answer

87
00:03:37,680 --> 00:03:43,440
until<font color="#E5E5E5"> the main server which is</font>

88
00:03:41,069 --> 00:03:45,690
authoritative for<font color="#E5E5E5"> the domain</font><font color="#CCCCCC"> the host is</font>

89
00:03:43,440 --> 00:03:47,909
located and will answer this<font color="#CCCCCC"> question</font>

90
00:03:45,690 --> 00:03:50,810
the resolver can catch the values and

91
00:03:47,909 --> 00:03:53,099
pass them to<font color="#E5E5E5"> the</font><font color="#CCCCCC"> client</font>

92
00:03:50,810 --> 00:03:55,049
DNS cache poisoning is simply the

93
00:03:53,099 --> 00:03:59,548
injection of spoofed values into the DNS

94
00:03:55,049 --> 00:04:02,090
resolvers cache in<font color="#CCCCCC"> the process to</font>

95
00:03:59,549 --> 00:04:02,090
prevent<font color="#E5E5E5"> that</font>

96
00:04:08,060 --> 00:04:13,560
to prevent<font color="#E5E5E5"> it there's a challenge</font>

97
00:04:10,620 --> 00:04:15,330
response mechanism built<font color="#CCCCCC"> into DNS</font><font color="#E5E5E5"> which</font>

98
00:04:13,560 --> 00:04:17,130
is meant to<font color="#E5E5E5"> provide security against off</font>

99
00:04:15,330 --> 00:04:19,170
path attacks and is useless<font color="#E5E5E5"> against men</font>

100
00:04:17,130 --> 00:04:22,140
<font color="#E5E5E5">in the middle so what we see here</font><font color="#CCCCCC"> is a</font>

101
00:04:19,170 --> 00:04:25,800
DNS message on the wire<font color="#CCCCCC"> you see the IP</font>

102
00:04:22,140 --> 00:04:28,229
<font color="#E5E5E5">header</font><font color="#CCCCCC"> as</font><font color="#E5E5E5"> a blue thing UDP header it's a</font>

103
00:04:25,800 --> 00:04:31,410
yellow<font color="#E5E5E5"> thing and the greenish thing</font><font color="#CCCCCC"> is</font>

104
00:04:28,230 --> 00:04:33,800
on the DNS message itself<font color="#E5E5E5"> the we</font>

105
00:04:31,410 --> 00:04:37,370
mentioned<font color="#CCCCCC"> challenge response</font><font color="#E5E5E5"> scheme</font>

106
00:04:33,800 --> 00:04:40,550
utilizes UDP<font color="#E5E5E5"> saw spot randomization as</font>

107
00:04:37,370 --> 00:04:44,130
well as transaction ID randomization and

108
00:04:40,550 --> 00:04:48,960
together these values give us up<font color="#E5E5E5"> to 32</font>

109
00:04:44,130 --> 00:04:52,110
random bits<font color="#E5E5E5"> guessing this is impractical</font>

110
00:04:48,960 --> 00:04:55,039
<font color="#CCCCCC">for our purposes which is why we're</font>

111
00:04:52,110 --> 00:04:57,450
<font color="#E5E5E5">doing an IP fragmentation attack instead</font>

112
00:04:55,040 --> 00:05:00,240
<font color="#CCCCCC">but what's IP fragmentation in the first</font>

113
00:04:57,450 --> 00:05:04,560
place<font color="#CCCCCC"> so assume Alice wants to send pop</font>

114
00:05:00,240 --> 00:05:06,780
a message<font color="#E5E5E5"> by a network and the packet</font>

115
00:05:04,560 --> 00:05:08,520
containing the message is bigger than

116
00:05:06,780 --> 00:05:11,429
<font color="#E5E5E5">the network</font><font color="#CCCCCC"> can handle so the</font><font color="#E5E5E5"> maximum</font>

117
00:05:08,520 --> 00:05:13,260
transmission<font color="#E5E5E5"> unit MTU of the network is</font>

118
00:05:11,430 --> 00:05:14,820
smaller than the packet size<font color="#E5E5E5"> now the</font>

119
00:05:13,260 --> 00:05:17,159
packet needs to<font color="#E5E5E5"> get screwed up into</font>

120
00:05:14,820 --> 00:05:19,650
multiple fragments<font color="#E5E5E5"> and that can happen</font>

121
00:05:17,160 --> 00:05:22,950
<font color="#CCCCCC">either in a route or on the</font><font color="#E5E5E5"> intermediate</font>

122
00:05:19,650 --> 00:05:24,450
<font color="#E5E5E5">network or if Alice had requested not to</font>

123
00:05:22,950 --> 00:05:26,400
have<font color="#CCCCCC"> it split</font><font color="#E5E5E5"> up at a root or the Rooter</font>

124
00:05:24,450 --> 00:05:28,590
will generate an ICMP error message and

125
00:05:26,400 --> 00:05:30,539
send it to<font color="#E5E5E5"> Alice indicating</font><font color="#CCCCCC"> that</font>

126
00:05:28,590 --> 00:05:34,049
fragmentation was needed but not

127
00:05:30,540 --> 00:05:35,490
requested to happen the<font color="#E5E5E5"> different</font>

128
00:05:34,050 --> 00:05:38,280
<font color="#CCCCCC">mentation</font><font color="#E5E5E5"> cache poisoning which is our</font>

129
00:05:35,490 --> 00:05:40,650
fragmentation attack as<font color="#E5E5E5"> also here the</font>

130
00:05:38,280 --> 00:05:42,840
injection of spoofed values this time

131
00:05:40,650 --> 00:05:46,260
into the IP<font color="#E5E5E5"> defragmentation cache of the</font>

132
00:05:42,840 --> 00:05:47,640
target of the receiver so<font color="#CCCCCC"> that the</font>

133
00:05:46,260 --> 00:05:48,419
spoofed fragments which carry<font color="#CCCCCC"> all</font>

134
00:05:47,640 --> 00:05:51,000
malicious payload

135
00:05:48,419 --> 00:05:53,930
<font color="#E5E5E5">get reassembled</font><font color="#CCCCCC"> with the true fragments</font>

136
00:05:51,000 --> 00:05:58,350
coming from the true sender

137
00:05:53,930 --> 00:05:59,790
what we are<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to do we want to have</font>

138
00:05:58,350 --> 00:06:01,980
the<font color="#E5E5E5"> challenge response values are</font>

139
00:05:59,790 --> 00:06:05,419
<font color="#CCCCCC">located on first fragment</font><font color="#E5E5E5"> and our</font>

140
00:06:01,980 --> 00:06:05,419
malicious payload<font color="#E5E5E5"> on the second fragment</font>

141
00:06:07,780 --> 00:06:11,229
we will cause the fragmentation<font color="#CCCCCC"> in the</font>

142
00:06:09,790 --> 00:06:14,200
first place using<font color="#E5E5E5"> the aforementioned</font>

143
00:06:11,230 --> 00:06:16,690
<font color="#E5E5E5">ICMP error message we're sending this</font>

144
00:06:14,200 --> 00:06:18,310
from our two IP address<font color="#E5E5E5"> through the name</font>

145
00:06:16,690 --> 00:06:21,160
server which is authoritative<font color="#E5E5E5"> for the</font>

146
00:06:18,310 --> 00:06:22,300
target<font color="#E5E5E5"> domain we can do this because the</font>

147
00:06:21,160 --> 00:06:25,350
name server<font color="#E5E5E5"> doesn't know we're not a</font>

148
00:06:22,300 --> 00:06:27,790
Rooter in the intermediary<font color="#CCCCCC"> network and</font>

149
00:06:25,350 --> 00:06:31,810
we will tell<font color="#E5E5E5"> him that</font><font color="#CCCCCC"> if he wants to</font>

150
00:06:27,790 --> 00:06:35,950
<font color="#E5E5E5">send messages</font><font color="#CCCCCC"> to the recursive resolver</font>

151
00:06:31,810 --> 00:06:37,120
<font color="#E5E5E5">of the certificate authority it has to</font>

152
00:06:35,950 --> 00:06:39,520
be aware that the maximum transmission

153
00:06:37,120 --> 00:06:44,860
<font color="#E5E5E5">unit of an intermediary network is one</font>

154
00:06:39,520 --> 00:06:49,599
of our choice having now fragmented the

155
00:06:44,860 --> 00:06:51,540
<font color="#E5E5E5">response which is to become which comes</font>

156
00:06:49,600 --> 00:06:54,310
from the name server of<font color="#E5E5E5"> the target</font><font color="#CCCCCC"> alain</font>

157
00:06:51,540 --> 00:06:57,160
<font color="#CCCCCC">the first fragment would look something</font>

158
00:06:54,310 --> 00:07:00,780
like this here<font color="#CCCCCC"> we've got the challenge</font>

159
00:06:57,160 --> 00:07:04,270
response<font color="#CCCCCC"> fellows values in this fragment</font>

160
00:07:00,780 --> 00:07:05,650
along with parts of<font color="#E5E5E5"> the DNS response we</font>

161
00:07:04,270 --> 00:07:09,549
will<font color="#E5E5E5"> always have parts of the DNS</font>

162
00:07:05,650 --> 00:07:13,239
response in there because<font color="#E5E5E5"> you see IP and</font>

163
00:07:09,550 --> 00:07:16,240
UDP had us together<font color="#CCCCCC"> only in this</font><font color="#E5E5E5"> case 28</font>

164
00:07:13,240 --> 00:07:17,950
bytes<font color="#CCCCCC"> and thus there will</font><font color="#E5E5E5"> always be some</font>

165
00:07:16,240 --> 00:07:22,860
part<font color="#E5E5E5"> of the DNS message message in there</font>

166
00:07:17,950 --> 00:07:22,860
because<font color="#E5E5E5"> the IP minimum fragment size 68</font>

167
00:07:23,250 --> 00:07:30,220
also notice we have to match the IP ID

168
00:07:27,160 --> 00:07:32,729
IP idea basically<font color="#E5E5E5"> identifies multiple</font>

169
00:07:30,220 --> 00:07:37,000
fragments<font color="#E5E5E5"> belonging to one packet and</font>

170
00:07:32,729 --> 00:07:39,250
<font color="#E5E5E5">the UDP checksum which has to match also</font>

171
00:07:37,000 --> 00:07:40,870
notice there are several<font color="#E5E5E5"> accounts for</font>

172
00:07:39,250 --> 00:07:43,000
<font color="#CCCCCC">example question count</font><font color="#E5E5E5"> answer record</font>

173
00:07:40,870 --> 00:07:45,040
current additional record count<font color="#E5E5E5"> as well</font>

174
00:07:43,000 --> 00:07:47,770
as<font color="#E5E5E5"> lengths which are encoded</font><font color="#CCCCCC"> on this</font>

175
00:07:45,040 --> 00:07:49,990
packet and<font color="#E5E5E5"> since since this is the</font>

176
00:07:47,770 --> 00:07:51,400
packet which will come<font color="#E5E5E5"> from the name</font>

177
00:07:49,990 --> 00:07:53,410
server<font color="#E5E5E5"> the target domain as a true</font>

178
00:07:51,400 --> 00:07:54,789
packet which we cannot spoof we do not

179
00:07:53,410 --> 00:07:59,620
have<font color="#CCCCCC"> control over these and have to</font>

180
00:07:54,790 --> 00:08:00,729
respect them the second fragment<font color="#E5E5E5"> as we</font>

181
00:07:59,620 --> 00:08:03,550
want<font color="#E5E5E5"> to spoof it would look something</font>

182
00:08:00,729 --> 00:08:05,110
like this<font color="#CCCCCC"> you see here the DNS payload</font>

183
00:08:03,550 --> 00:08:08,320
<font color="#E5E5E5">this is the part which we have control</font>

184
00:08:05,110 --> 00:08:11,110
<font color="#E5E5E5">over as well as IP ID which we have to</font>

185
00:08:08,320 --> 00:08:14,590
guess in the vast<font color="#E5E5E5"> majority of systems</font><font color="#CCCCCC"> IP</font>

186
00:08:11,110 --> 00:08:17,229
ID is implemented as a counter either

187
00:08:14,590 --> 00:08:18,818
<font color="#E5E5E5">incrementing on a global basis or local</font>

188
00:08:17,229 --> 00:08:22,610
<font color="#CCCCCC">per destination</font>

189
00:08:18,819 --> 00:08:24,949
and we can guess this by<font color="#E5E5E5"> simply sending</font>

190
00:08:22,610 --> 00:08:27,949
direct probes<font color="#E5E5E5"> if it's a global counter</font>

191
00:08:24,949 --> 00:08:33,380
<font color="#E5E5E5">or using sir channels but</font><font color="#CCCCCC"> I won't go too</font>

192
00:08:27,949 --> 00:08:35,000
much<font color="#E5E5E5"> into detail you also</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> UDP</font>

193
00:08:33,380 --> 00:08:44,500
checksum<font color="#E5E5E5"> can be guessed using the true</font>

194
00:08:35,000 --> 00:08:44,500
second fragment<font color="#CCCCCC"> if you look good you</font>

195
00:08:44,620 --> 00:08:51,290
<font color="#CCCCCC">simply subtract one checksum from the</font>

196
00:08:49,490 --> 00:08:54,260
other and what's left over<font color="#E5E5E5"> is what you</font>

197
00:08:51,290 --> 00:08:57,380
add up maybe in the Z field<font color="#E5E5E5"> zero flex of</font>

198
00:08:54,260 --> 00:08:59,510
the<font color="#E5E5E5"> neediness record or if we have</font>

199
00:08:57,380 --> 00:09:02,750
another<font color="#E5E5E5"> record which</font><font color="#CCCCCC"> includes so</font>

200
00:08:59,510 --> 00:09:04,700
<font color="#E5E5E5">time-to-live value which is 32 bits an</font>

201
00:09:02,750 --> 00:09:10,300
ordinary<font color="#E5E5E5"> load we</font><font color="#CCCCCC"> can simply</font><font color="#E5E5E5"> add these</font>

202
00:09:04,700 --> 00:09:10,300
<font color="#CCCCCC">values of</font><font color="#E5E5E5"> there okay</font>

203
00:09:18,450 --> 00:09:22,240
now that we know<font color="#E5E5E5"> how to poison will</font>

204
00:09:20,650 --> 00:09:25,060
resolve<font color="#E5E5E5"> us cash let's look how</font><font color="#CCCCCC"> that</font>

205
00:09:22,240 --> 00:09:27,250
would look<font color="#CCCCCC"> like in a real attack</font><font color="#E5E5E5"> for</font>

206
00:09:25,060 --> 00:09:29,650
that purpose we've<font color="#E5E5E5"> set up</font><font color="#CCCCCC"> attacker and</font>

207
00:09:27,250 --> 00:09:32,200
victim hosts and<font color="#CCCCCC"> a respective domains</font>

208
00:09:29,650 --> 00:09:34,689
<font color="#E5E5E5">both are running name servers and</font><font color="#CCCCCC"> mail</font>

209
00:09:32,200 --> 00:09:38,530
<font color="#CCCCCC">source and the name server</font><font color="#E5E5E5"> running under</font>

210
00:09:34,690 --> 00:09:42,730
<font color="#CCCCCC">the attacker serves values that point to</font>

211
00:09:38,530 --> 00:09:43,900
the attacker<font color="#E5E5E5"> but I meant to originate</font><font color="#CCCCCC"> in</font>

212
00:09:42,730 --> 00:09:45,820
<font color="#CCCCCC">the victim domain so we're mapping</font>

213
00:09:43,900 --> 00:09:50,560
victim domain names<font color="#E5E5E5"> to the</font><font color="#CCCCCC"> attackers</font>

214
00:09:45,820 --> 00:09:53,560
<font color="#CCCCCC">here first step</font><font color="#E5E5E5"> will be sending the ICMP</font>

215
00:09:50,560 --> 00:09:55,540
fragmentation message through<font color="#E5E5E5"> the name</font>

216
00:09:53,560 --> 00:09:57,280
server<font color="#CCCCCC"> for target to main so that</font>

217
00:09:55,540 --> 00:09:59,290
fragmentation then happens second step

218
00:09:57,280 --> 00:10:01,000
is probing the IP<font color="#E5E5E5"> ID which</font><font color="#CCCCCC"> is</font>

219
00:09:59,290 --> 00:10:03,400
implemented here for our demonstration

220
00:10:01,000 --> 00:10:05,850
purposes<font color="#E5E5E5"> as a global</font><font color="#CCCCCC"> increment encounter</font>

221
00:10:03,400 --> 00:10:08,439
<font color="#E5E5E5">and using that</font><font color="#CCCCCC"> we can</font><font color="#E5E5E5"> now Forge our</font>

222
00:10:05,850 --> 00:10:10,380
<font color="#E5E5E5">spoofed second</font><font color="#CCCCCC"> fragment and inject it</font>

223
00:10:08,440 --> 00:10:14,950
<font color="#E5E5E5">into the DNS resolvers cache</font>

224
00:10:10,380 --> 00:10:18,760
notice here the<font color="#CCCCCC"> second fragment Maps</font><font color="#E5E5E5"> the</font>

225
00:10:14,950 --> 00:10:20,680
victim domain to our name server so if

226
00:10:18,760 --> 00:10:22,120
there<font color="#E5E5E5"> is a question for the name server</font>

227
00:10:20,680 --> 00:10:24,339
which is authoritative for the victim

228
00:10:22,120 --> 00:10:27,480
domain it would be answered<font color="#E5E5E5"> with the</font>

229
00:10:24,340 --> 00:10:30,250
<font color="#E5E5E5">name server we set</font><font color="#CCCCCC"> up under the</font><font color="#E5E5E5"> attacker</font>

230
00:10:27,480 --> 00:10:32,680
let's see how<font color="#CCCCCC"> that looked in a recorded</font>

231
00:10:30,250 --> 00:10:34,360
demo<font color="#E5E5E5"> so we've got on the lower left and</font>

232
00:10:32,680 --> 00:10:36,609
<font color="#CCCCCC">that's just a traffic jam for later</font><font color="#E5E5E5"> and</font>

233
00:10:34,360 --> 00:10:45,550
on the upper<font color="#E5E5E5"> left</font><font color="#CCCCCC"> that's where the magic</font>

234
00:10:36,610 --> 00:10:47,830
<font color="#E5E5E5">happens now the implementation runs in</font>

235
00:10:45,550 --> 00:10:51,069
an infinite<font color="#E5E5E5"> loop which is because we</font>

236
00:10:47,830 --> 00:10:52,840
cannot<font color="#E5E5E5"> know when</font><font color="#CCCCCC"> exactly the DNS resolve</font>

237
00:10:51,070 --> 00:10:54,700
and certificate authority will send the

238
00:10:52,840 --> 00:10:58,050
DNS message

239
00:10:54,700 --> 00:11:01,390
the request to<font color="#E5E5E5"> the name server</font><font color="#CCCCCC"> and</font>

240
00:10:58,050 --> 00:11:03,400
notice here we're spoofing 64<font color="#E5E5E5"> for second</font>

241
00:11:01,390 --> 00:11:04,960
fragments which is basically the shotgun

242
00:11:03,400 --> 00:11:11,620
approach to guessing<font color="#E5E5E5"> the right IP are</font>

243
00:11:04,960 --> 00:11:13,150
you okay now that we've poisoned the IP

244
00:11:11,620 --> 00:11:16,210
defragmentation cache of<font color="#E5E5E5"> the DNS</font>

245
00:11:13,150 --> 00:11:18,189
resolver we can go on poisoning the DNS

246
00:11:16,210 --> 00:11:21,010
cache which we got that by<font color="#E5E5E5"> simply</font>

247
00:11:18,190 --> 00:11:22,780
issuing the certificate signing request

248
00:11:21,010 --> 00:11:25,689
to the web<font color="#E5E5E5"> server of the certificate</font>

249
00:11:22,780 --> 00:11:26,260
authority<font color="#E5E5E5"> which will then have its</font><font color="#CCCCCC"> dns</font>

250
00:11:25,690 --> 00:11:28,450
resolver

251
00:11:26,260 --> 00:11:29,500
after<font color="#CCCCCC"> two name server of</font><font color="#E5E5E5"> the victim</font>

252
00:11:28,450 --> 00:11:33,640
domain

253
00:11:29,500 --> 00:11:35,080
for the records<font color="#E5E5E5"> of a mail server</font><font color="#CCCCCC"> the</font>

254
00:11:33,640 --> 00:11:36,760
name server of<font color="#E5E5E5"> the victim</font><font color="#CCCCCC"> domain will</font>

255
00:11:35,080 --> 00:11:41,380
answer<font color="#E5E5E5"> fragmented</font><font color="#CCCCCC"> because we have</font>

256
00:11:36,760 --> 00:11:43,360
requested<font color="#CCCCCC"> to and</font><font color="#E5E5E5"> this name server</font>

257
00:11:41,380 --> 00:11:46,000
<font color="#E5E5E5">exposes the default behavior which we</font>

258
00:11:43,360 --> 00:11:48,430
see in<font color="#E5E5E5"> many name servers which is at</font>

259
00:11:46,000 --> 00:11:51,220
answers the question for the IP address

260
00:11:48,430 --> 00:11:53,560
<font color="#E5E5E5">but along</font><font color="#CCCCCC"> with that it gives updated</font>

261
00:11:51,220 --> 00:11:55,990
values for the name server of<font color="#E5E5E5"> the domain</font>

262
00:11:53,560 --> 00:12:02,140
which<font color="#CCCCCC"> is what we are</font><font color="#E5E5E5"> also</font><font color="#CCCCCC"> exploiting</font>

263
00:11:55,990 --> 00:12:04,660
here so triggering the<font color="#E5E5E5"> DNS</font><font color="#CCCCCC"> request works</font>

264
00:12:02,140 --> 00:12:06,990
like<font color="#E5E5E5"> this we're entering here our</font>

265
00:12:04,660 --> 00:12:12,969
certificate signing request<font color="#E5E5E5"> and</font>

266
00:12:06,990 --> 00:12:15,280
uploading<font color="#E5E5E5"> it using the button now we're</font>

267
00:12:12,970 --> 00:12:22,710
choosing email address<font color="#E5E5E5"> under the victim</font>

268
00:12:15,280 --> 00:12:22,709
domain and the request<font color="#CCCCCC"> the sent</font>

269
00:12:27,300 --> 00:12:31,649
okay now<font color="#E5E5E5"> that we've poisoned the DNS</font>

270
00:12:29,640 --> 00:12:34,170
resolvers cache we can go on<font color="#E5E5E5"> exploiting</font>

271
00:12:31,649 --> 00:12:36,149
domain validation<font color="#E5E5E5"> which we do we do</font>

272
00:12:34,170 --> 00:12:38,189
another time by issuing<font color="#E5E5E5"> another</font>

273
00:12:36,149 --> 00:12:41,390
certificate<font color="#E5E5E5"> signing request to the web</font>

274
00:12:38,190 --> 00:12:41,390
server of<font color="#CCCCCC"> the certificate authority</font>

275
00:12:41,810 --> 00:12:47,760
now the<font color="#CCCCCC"> DNS</font><font color="#E5E5E5"> resolver will ask our name</font>

276
00:12:45,510 --> 00:12:49,769
server which we've set up for<font color="#CCCCCC"> the email</font>

277
00:12:47,760 --> 00:12:51,950
address<font color="#E5E5E5"> for the IP address of the mail</font>

278
00:12:49,769 --> 00:12:54,779
server of<font color="#E5E5E5"> the victim domain because we</font>

279
00:12:51,950 --> 00:12:57,839
<font color="#E5E5E5">injected and</font><font color="#CCCCCC"> poisoned</font><font color="#E5E5E5"> the DNS resolvers</font>

280
00:12:54,779 --> 00:13:00,060
cache<font color="#E5E5E5"> we can answer that</font><font color="#CCCCCC"> question with</font>

281
00:12:57,839 --> 00:13:03,750
an IP address<font color="#E5E5E5"> which is running under</font><font color="#CCCCCC"> our</font>

282
00:13:00,060 --> 00:13:11,819
<font color="#E5E5E5">host we control that</font><font color="#CCCCCC"> looks something</font>

283
00:13:03,750 --> 00:13:13,950
like<font color="#E5E5E5"> this year here we choose another</font>

284
00:13:11,820 --> 00:13:17,970
<font color="#CCCCCC">email address running under the</font><font color="#E5E5E5"> victim</font>

285
00:13:13,950 --> 00:13:22,260
domain and<font color="#E5E5E5"> the requests are going out</font>

286
00:13:17,970 --> 00:13:28,399
and<font color="#CCCCCC"> now pay attention to the lower left</font>

287
00:13:22,260 --> 00:13:28,399
pane where we see the<font color="#E5E5E5"> traffic coming in</font>

288
00:13:29,990 --> 00:13:35,630
there this<font color="#E5E5E5"> DNS traffic</font><font color="#CCCCCC"> all right</font><font color="#E5E5E5"> looks</font>

289
00:13:33,540 --> 00:13:35,630
good

290
00:13:35,930 --> 00:13:42,359
okay<font color="#E5E5E5"> now the email server will send us</font>

291
00:13:39,540 --> 00:13:45,390
the validation<font color="#E5E5E5"> code and we can</font><font color="#CCCCCC"> echo that</font>

292
00:13:42,360 --> 00:13:47,820
the<font color="#E5E5E5"> new validation code to the web so of</font>

293
00:13:45,390 --> 00:13:49,350
the certificate authority<font color="#E5E5E5"> which will</font>

294
00:13:47,820 --> 00:13:56,390
then offer us the certificate for

295
00:13:49,350 --> 00:14:00,510
download let's see if there worked<font color="#CCCCCC"> ok</font>

296
00:13:56,390 --> 00:14:03,319
<font color="#E5E5E5">guess who's got friends whatever what</font>

297
00:14:00,510 --> 00:14:03,319
<font color="#E5E5E5">did they write us</font>

298
00:14:06,240 --> 00:14:13,420
<font color="#E5E5E5">okay here we see it and that email was</font>

299
00:14:09,520 --> 00:14:15,910
sent to the victim domain<font color="#E5E5E5"> but we went to</font>

300
00:14:13,420 --> 00:14:23,500
<font color="#CCCCCC">our</font><font color="#E5E5E5"> host the attacker host and that's</font>

301
00:14:15,910 --> 00:14:31,540
the<font color="#CCCCCC"> validation code</font><font color="#E5E5E5"> okay we could now go</font>

302
00:14:23,500 --> 00:14:34,450
on<font color="#E5E5E5"> we could now go</font><font color="#CCCCCC"> on and enter</font><font color="#E5E5E5"> that in</font>

303
00:14:31,540 --> 00:14:36,520
the<font color="#E5E5E5"> forum at the web server which we do</font>

304
00:14:34,450 --> 00:14:39,310
not<font color="#E5E5E5"> know we do</font><font color="#CCCCCC"> not do here</font><font color="#E5E5E5"> because we're</font>

305
00:14:36,520 --> 00:14:42,460
not<font color="#E5E5E5"> evil but we could and then we were</font>

306
00:14:39,310 --> 00:14:45,219
<font color="#E5E5E5">able to download the certificate using</font>

307
00:14:42,460 --> 00:14:47,710
<font color="#CCCCCC">this certificate we could</font><font color="#E5E5E5"> then go</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> and</font>

308
00:14:45,220 --> 00:14:51,340
impersonate a service running<font color="#E5E5E5"> under the</font>

309
00:14:47,710 --> 00:14:52,930
<font color="#E5E5E5">victim domain plausibly meaning the</font>

310
00:14:51,340 --> 00:14:54,730
attack would not be noticed if there

311
00:14:52,930 --> 00:14:57,160
were even<font color="#CCCCCC"> a first-year</font><font color="#E5E5E5"> lesson</font><font color="#CCCCCC"> news</font>

312
00:14:54,730 --> 00:15:00,510
because our certificate signed by a

313
00:14:57,160 --> 00:15:00,510
trusted certificate<font color="#E5E5E5"> authority</font>

314
00:15:14,260 --> 00:15:17,210
let's go on and<font color="#E5E5E5"> see what that means</font><font color="#CCCCCC"> for</font>

315
00:15:16,550 --> 00:15:20,750
the victims

316
00:15:17,210 --> 00:15:22,760
so for victim users the implications are

317
00:15:20,750 --> 00:15:27,500
derived from<font color="#E5E5E5"> any successful attack</font><font color="#CCCCCC"> on</font>

318
00:15:22,760 --> 00:15:28,610
TLS session<font color="#CCCCCC"> we could where we have a man</font>

319
00:15:27,500 --> 00:15:30,770
in<font color="#E5E5E5"> the middle for example we could</font>

320
00:15:28,610 --> 00:15:33,850
inject malware or<font color="#E5E5E5"> still credential</font>

321
00:15:30,770 --> 00:15:36,410
sensitive data identity you name it<font color="#E5E5E5"> and</font>

322
00:15:33,850 --> 00:15:38,330
if such an attack gets public<font color="#E5E5E5"> that</font>

323
00:15:36,410 --> 00:15:40,490
<font color="#E5E5E5">usually means a lot of loss of</font>

324
00:15:38,330 --> 00:15:43,280
reputation and<font color="#E5E5E5"> Trust for the victim</font>

325
00:15:40,490 --> 00:15:47,540
certificate authority<font color="#E5E5E5"> as well</font><font color="#CCCCCC"> as for the</font>

326
00:15:43,280 --> 00:15:50,510
<font color="#E5E5E5">target domain but how real are these</font>

327
00:15:47,540 --> 00:15:52,040
attacks<font color="#E5E5E5"> well we tested 17 certificate</font>

328
00:15:50,510 --> 00:15:54,590
authorities that perform<font color="#E5E5E5"> the main</font>

329
00:15:52,040 --> 00:15:57,560
validation<font color="#E5E5E5"> and together I cover more</font>

330
00:15:54,590 --> 00:15:59,390
than<font color="#E5E5E5"> 95% of the certificate market five</font>

331
00:15:57,560 --> 00:16:00,979
of<font color="#E5E5E5"> them are vulnerable but already one</font>

332
00:15:59,390 --> 00:16:02,840
vulnerable certificate authority is

333
00:16:00,980 --> 00:16:05,090
sufficient to obtain the target

334
00:16:02,840 --> 00:16:08,380
certificate which means<font color="#CCCCCC"> we're PKI</font>

335
00:16:05,090 --> 00:16:08,380
security is on the mind

336
00:16:18,410 --> 00:16:21,920
<font color="#CCCCCC">all right doesn't sound</font><font color="#E5E5E5"> good how could</font>

337
00:16:20,570 --> 00:16:25,790
we prevent this or at least make<font color="#CCCCCC"> it</font>

338
00:16:21,920 --> 00:16:28,280
<font color="#CCCCCC">Aurra let's first have a look at the</font>

339
00:16:25,790 --> 00:16:30,319
preconditions of the attack<font color="#CCCCCC"> for those we</font>

340
00:16:28,280 --> 00:16:31,750
exploited<font color="#CCCCCC"> two main validation</font><font color="#E5E5E5"> so this</font>

341
00:16:30,320 --> 00:16:34,670
needs<font color="#E5E5E5"> to</font><font color="#CCCCCC"> be offered in</font><font color="#E5E5E5"> the first place</font>

342
00:16:31,750 --> 00:16:36,710
we did an IP fragmentation attacks or IP

343
00:16:34,670 --> 00:16:38,120
fragmentation needs to be<font color="#CCCCCC"> allowed both</font>

344
00:16:36,710 --> 00:16:40,310
on the victim name server of attack

345
00:16:38,120 --> 00:16:43,640
domain as<font color="#E5E5E5"> well as in the certificate</font>

346
00:16:40,310 --> 00:16:48,500
authorities<font color="#CCCCCC"> network and</font><font color="#E5E5E5"> also we targeted</font>

347
00:16:43,640 --> 00:16:49,610
<font color="#CCCCCC">DNS via UDP so then could we</font><font color="#E5E5E5"> just is</font>

348
00:16:48,500 --> 00:16:52,880
<font color="#E5E5E5">able to manually d--ation</font>

349
00:16:49,610 --> 00:16:54,680
if<font color="#E5E5E5"> it's attackable well we could but</font>

350
00:16:52,880 --> 00:16:58,600
<font color="#E5E5E5">would leave</font><font color="#CCCCCC"> us only with much more</font>

351
00:16:54,680 --> 00:16:58,599
expensive alternatives<font color="#CCCCCC"> not the way to go</font>

352
00:16:58,810 --> 00:17:04,520
what about suppressing IP fragmentation

353
00:17:02,200 --> 00:17:06,709
<font color="#CCCCCC">also we could and some certificate</font>

354
00:17:04,520 --> 00:17:08,869
authorities<font color="#E5E5E5"> actually do this but</font><font color="#CCCCCC"> this</font>

355
00:17:06,709 --> 00:17:11,240
<font color="#E5E5E5">would disconnect some networks so</font><font color="#CCCCCC"> only</font>

356
00:17:08,869 --> 00:17:12,010
<font color="#E5E5E5">last resort defense mechanism here</font>

357
00:17:11,240 --> 00:17:14,420
definitely

358
00:17:12,010 --> 00:17:19,160
<font color="#CCCCCC">what about forcing dienes of the over</font>

359
00:17:14,420 --> 00:17:21,560
<font color="#CCCCCC">TCP</font><font color="#E5E5E5"> rather than using UDP</font><font color="#CCCCCC"> also we could</font>

360
00:17:19,160 --> 00:17:25,459
but<font color="#CCCCCC"> off path</font><font color="#E5E5E5"> TCP injection attacks to</font>

361
00:17:21,560 --> 00:17:27,290
exist let alone primarily on<font color="#E5E5E5"> HTTP HTTP</font>

362
00:17:25,459 --> 00:17:29,660
traffic for<font color="#CCCCCC"> example making assumptions</font>

363
00:17:27,290 --> 00:17:31,970
about the upper layers but it's probable

364
00:17:29,660 --> 00:17:35,480
<font color="#CCCCCC">that such</font><font color="#E5E5E5"> attacks will</font><font color="#CCCCCC"> be developed in</font>

365
00:17:31,970 --> 00:17:40,130
the<font color="#E5E5E5"> future</font><font color="#CCCCCC"> to also notice that we've</font>

366
00:17:35,480 --> 00:17:41,990
seen an increase in charlief<font color="#CCCCCC"> BGP prefix</font>

367
00:17:40,130 --> 00:17:43,850
hijacking attacks<font color="#E5E5E5"> with the purpose of</font>

368
00:17:41,990 --> 00:17:46,460
doing a man-in-the-middle<font color="#E5E5E5"> on DNS cache</font>

369
00:17:43,850 --> 00:17:49,580
<font color="#CCCCCC">poisoned</font><font color="#E5E5E5"> manual middle for DNS cache</font>

370
00:17:46,460 --> 00:17:51,320
poisoning<font color="#E5E5E5"> and the challenge response</font>

371
00:17:49,580 --> 00:17:52,879
values which we have<font color="#E5E5E5"> seen before do not</font>

372
00:17:51,320 --> 00:17:54,649
<font color="#E5E5E5">offer security against men</font><font color="#CCCCCC"> in the middle</font>

373
00:17:52,880 --> 00:17:57,260
<font color="#CCCCCC">because the</font><font color="#E5E5E5"> men in the middle could just</font>

374
00:17:54,650 --> 00:17:59,720
see the values and yeah echo them no

375
00:17:57,260 --> 00:18:02,480
<font color="#E5E5E5">problem here</font>

376
00:17:59,720 --> 00:18:06,170
things like this<font color="#CCCCCC"> happened for example I</font>

377
00:18:02,480 --> 00:18:10,820
think<font color="#CCCCCC"> it was in</font><font color="#E5E5E5"> in May when users of</font>

378
00:18:06,170 --> 00:18:12,680
those alpha cryptocurrency<font color="#CCCCCC"> service my</font>

379
00:18:10,820 --> 00:18:17,000
ether wallet fell prey to an

380
00:18:12,680 --> 00:18:22,250
impersonation attack<font color="#CCCCCC"> yes and this attack</font>

381
00:18:17,000 --> 00:18:24,320
was not<font color="#E5E5E5"> a spoof certificate used</font><font color="#CCCCCC"> and</font>

382
00:18:22,250 --> 00:18:26,300
<font color="#E5E5E5">it's not a</font><font color="#CCCCCC"> valid certificate so at the</font>

383
00:18:24,320 --> 00:18:27,790
<font color="#E5E5E5">attackers use our approach to getting</font>

384
00:18:26,300 --> 00:18:30,980
certificate authority

385
00:18:27,790 --> 00:18:31,670
signed certificate<font color="#CCCCCC"> us this attack would</font>

386
00:18:30,980 --> 00:18:37,070
have<font color="#E5E5E5"> been much</font>

387
00:18:31,670 --> 00:18:38,420
whatever staging<font color="#E5E5E5"> yeah</font><font color="#CCCCCC"> looks like we like</font>

388
00:18:37,070 --> 00:18:39,889
we need<font color="#CCCCCC"> to mend the middle resilient to</font>

389
00:18:38,420 --> 00:18:44,090
<font color="#CCCCCC">man validation</font><font color="#E5E5E5"> at least a long</font>

390
00:18:39,890 --> 00:18:46,190
<font color="#CCCCCC">perspective how could we do</font><font color="#E5E5E5"> this one</font>

391
00:18:44,090 --> 00:18:48,830
approach would be doing<font color="#E5E5E5"> DNS over HTTP or</font>

392
00:18:46,190 --> 00:18:50,750
TLS but that would mean we're securing a

393
00:18:48,830 --> 00:18:53,270
public key infrastructure with a very

394
00:18:50,750 --> 00:18:55,250
same public key infrastructure<font color="#E5E5E5"> so we're</font>

395
00:18:53,270 --> 00:18:58,400
assuming security concludes security

396
00:18:55,250 --> 00:19:00,140
<font color="#E5E5E5">nothing one here another approach is</font>

397
00:18:58,400 --> 00:19:00,500
<font color="#CCCCCC">seen ethic which is certainly</font><font color="#E5E5E5"> the way to</font>

398
00:19:00,140 --> 00:19:03,980
go

399
00:19:00,500 --> 00:19:06,350
<font color="#E5E5E5">so DNS records get signed by</font><font color="#CCCCCC"> the owner</font>

400
00:19:03,980 --> 00:19:09,470
<font color="#E5E5E5">and we're using basically public</font>

401
00:19:06,350 --> 00:19:11,810
<font color="#E5E5E5">infrastructure built into DNS but given</font>

402
00:19:09,470 --> 00:19:14,120
<font color="#E5E5E5">that it was drafted in the</font><font color="#CCCCCC"> mid-90s</font><font color="#E5E5E5"> and</font>

403
00:19:11,810 --> 00:19:17,360
it's<font color="#E5E5E5"> still not properly deployed we</font>

404
00:19:14,120 --> 00:19:18,739
cannot rely on that<font color="#E5E5E5"> one which is why we</font>

405
00:19:17,360 --> 00:19:20,570
<font color="#CCCCCC">had gone over have come up with a</font>

406
00:19:18,740 --> 00:19:24,440
<font color="#CCCCCC">probably</font><font color="#E5E5E5"> placement we call domain</font>

407
00:19:20,570 --> 00:19:26,870
validation plus<font color="#E5E5E5"> plus or</font><font color="#CCCCCC"> DV plus plus the</font>

408
00:19:24,440 --> 00:19:28,550
<font color="#CCCCCC">U plus plus uses</font><font color="#E5E5E5"> multiple vantage points</font>

409
00:19:26,870 --> 00:19:30,739
or AV agent which are<font color="#CCCCCC"> distributed over</font>

410
00:19:28,550 --> 00:19:33,169
<font color="#E5E5E5">the</font><font color="#CCCCCC"> Internet</font><font color="#E5E5E5"> and communicate with an</font>

411
00:19:30,740 --> 00:19:35,990
Orchestrator<font color="#E5E5E5"> in the certificate</font>

412
00:19:33,170 --> 00:19:40,300
authority<font color="#CCCCCC"> the DV agents all do the DNS</font>

413
00:19:35,990 --> 00:19:40,300
part of the main validation and

414
00:19:40,360 --> 00:19:44,750
communicate via<font color="#CCCCCC"> HTTPS with the</font>

415
00:19:42,440 --> 00:19:50,180
orchestrator who does the<font color="#CCCCCC"> voting of the</font>

416
00:19:44,750 --> 00:19:52,550
DNS responses and communication was<font color="#E5E5E5"> done</font>

417
00:19:50,180 --> 00:19:54,650
by<font color="#CCCCCC"> HTTPS using out of PKS certificates</font>

418
00:19:52,550 --> 00:19:56,720
picture dialect directory trusted

419
00:19:54,650 --> 00:19:58,880
certificates<font color="#E5E5E5"> because</font><font color="#CCCCCC"> if we use</font>

420
00:19:56,720 --> 00:20:02,090
certificates<font color="#E5E5E5"> which are part of</font><font color="#CCCCCC"> the web</font>

421
00:19:58,880 --> 00:20:03,920
<font color="#CCCCCC">PKI</font><font color="#E5E5E5"> that would again be relying on a PKI</font>

422
00:20:02,090 --> 00:20:07,370
for securing the<font color="#E5E5E5"> very same public</font>

423
00:20:03,920 --> 00:20:09,110
infrastructure communication happens

424
00:20:07,370 --> 00:20:11,899
over mostly<font color="#E5E5E5"> not overlapping paths</font>

425
00:20:09,110 --> 00:20:14,590
through<font color="#CCCCCC"> the internet and that aims</font><font color="#E5E5E5"> at</font>

426
00:20:11,900 --> 00:20:16,880
securing the certificate<font color="#E5E5E5"> authority side</font>

427
00:20:14,590 --> 00:20:19,840
even for<font color="#CCCCCC"> strongmen</font><font color="#E5E5E5"> in</font><font color="#CCCCCC"> the middle</font>

428
00:20:16,880 --> 00:20:19,840
nation-state attackers

429
00:20:30,700 --> 00:20:37,880
<font color="#E5E5E5">okay time</font><font color="#CCCCCC"> to draw</font><font color="#E5E5E5"> the conclusions</font>

430
00:20:34,030 --> 00:20:40,480
the summary we've seen<font color="#E5E5E5"> a</font><font color="#CCCCCC"> rough past</font>

431
00:20:37,880 --> 00:20:42,770
attack against the main validation which

432
00:20:40,480 --> 00:20:44,660
leveraged<font color="#CCCCCC"> IP</font><font color="#E5E5E5"> defragmentation cache</font>

433
00:20:42,770 --> 00:20:47,120
poisoning<font color="#CCCCCC"> to achieve DNS cache poisoning</font>

434
00:20:44,660 --> 00:20:49,580
<font color="#E5E5E5">and using that we</font><font color="#CCCCCC"> were able</font><font color="#E5E5E5"> to acquire</font>

435
00:20:47,120 --> 00:20:52,389
fraudulent certificates for domains

436
00:20:49,580 --> 00:20:55,909
which are<font color="#E5E5E5"> on the foreign operation</font>

437
00:20:52,390 --> 00:20:58,190
<font color="#CCCCCC">this means ultimately if</font><font color="#E5E5E5"> leave</font><font color="#CCCCCC"> web PKI</font>

438
00:20:55,910 --> 00:20:59,720
<font color="#E5E5E5">which is meant to provide security even</font>

439
00:20:58,190 --> 00:21:02,840
<font color="#CCCCCC">against strongmen</font><font color="#E5E5E5"> the middle attackers</font>

440
00:20:59,720 --> 00:21:04,490
relies on a<font color="#CCCCCC"> weak building block that can</font>

441
00:21:02,840 --> 00:21:10,189
be circumvented by<font color="#CCCCCC"> a week</font><font color="#E5E5E5"> of path</font>

442
00:21:04,490 --> 00:21:17,500
attacker thank you for your attention

443
00:21:10,190 --> 00:21:21,130
[Applause]

444
00:21:17,500 --> 00:21:21,130
<font color="#E5E5E5">all right questions</font>

445
00:21:28,660 --> 00:21:33,440
do you have any evidence<font color="#E5E5E5"> of this</font>

446
00:21:30,620 --> 00:21:35,810
happening for<font color="#E5E5E5"> boy real I thought we just</font>

447
00:21:33,440 --> 00:21:39,050
<font color="#E5E5E5">disclosed this this type of attack</font><font color="#CCCCCC"> I</font>

448
00:21:35,810 --> 00:21:41,240
think in<font color="#CCCCCC"> October was and we did not</font>

449
00:21:39,050 --> 00:21:43,909
collect<font color="#E5E5E5"> any evidence on that yet</font><font color="#CCCCCC"> so it's</font>

450
00:21:41,240 --> 00:21:59,450
<font color="#E5E5E5">very recently disclosed no data</font>

451
00:21:43,910 --> 00:22:02,270
available<font color="#CCCCCC"> yet you mentioned that</font><font color="#E5E5E5"> at the</font>

452
00:21:59,450 --> 00:22:05,710
17<font color="#CCCCCC"> CAS you try it was only</font><font color="#E5E5E5"> it worked on</font>

453
00:22:02,270 --> 00:22:07,700
five<font color="#CCCCCC"> of them</font><font color="#E5E5E5"> what are the reasons that</font>

454
00:22:05,710 --> 00:22:09,560
what are the<font color="#E5E5E5"> other reasons that it</font>

455
00:22:07,700 --> 00:22:11,290
didn't work<font color="#CCCCCC"> on the the rest of them and</font>

456
00:22:09,560 --> 00:22:16,280
are<font color="#E5E5E5"> those potential mitigation</font>

457
00:22:11,290 --> 00:22:18,290
mechanisms<font color="#CCCCCC"> okay as I mentioned for</font>

458
00:22:16,280 --> 00:22:20,420
<font color="#E5E5E5">example that not every</font><font color="#CCCCCC"> UCA supports</font>

459
00:22:18,290 --> 00:22:22,310
fragmentation and against that<font color="#E5E5E5"> very</font>

460
00:22:20,420 --> 00:22:24,200
specific attack we did the IP

461
00:22:22,310 --> 00:22:28,280
fragmentation<font color="#CCCCCC"> attack that helps</font>

462
00:22:24,200 --> 00:22:29,900
obviously<font color="#CCCCCC"> also</font><font color="#E5E5E5"> it's quite difficult to</font>

463
00:22:28,280 --> 00:22:32,149
<font color="#E5E5E5">forge through the second fragment given</font>

464
00:22:29,900 --> 00:22:35,240
that you don't<font color="#CCCCCC"> always have control</font><font color="#E5E5E5"> or</font>

465
00:22:32,150 --> 00:22:36,950
<font color="#E5E5E5">you don't have the most degree of</font>

466
00:22:35,240 --> 00:22:39,530
control over<font color="#CCCCCC"> a second fragment given</font>

467
00:22:36,950 --> 00:22:43,910
that the counts and lengths<font color="#E5E5E5"> and call it</font>

468
00:22:39,530 --> 00:22:46,670
in first fragment<font color="#E5E5E5"> so I wouldn't call</font>

469
00:22:43,910 --> 00:22:52,640
that<font color="#CCCCCC"> real right a reliable mitigation</font>

470
00:22:46,670 --> 00:22:54,440
mechanism<font color="#CCCCCC"> thoughts yes</font><font color="#E5E5E5"> okay so</font><font color="#CCCCCC"> in DV</font>

471
00:22:52,640 --> 00:22:56,720
plus plus as you described it there's

472
00:22:54,440 --> 00:22:59,480
multiple vantage points of this right

473
00:22:56,720 --> 00:23:03,320
here<font color="#E5E5E5"> there's multiple vantage points in</font>

474
00:22:59,480 --> 00:23:06,350
which you do the<font color="#E5E5E5"> D the DNS query</font><font color="#CCCCCC"> do</font>

475
00:23:03,320 --> 00:23:09,220
those is there any advantage<font color="#CCCCCC"> to having</font>

476
00:23:06,350 --> 00:23:12,889
those vantage points be<font color="#E5E5E5"> unpredictable or</font>

477
00:23:09,220 --> 00:23:14,720
different every time<font color="#E5E5E5"> or is it fine to</font>

478
00:23:12,890 --> 00:23:20,810
<font color="#CCCCCC">have these multiple vantage points be</font>

479
00:23:14,720 --> 00:23:22,790
statically<font color="#E5E5E5"> configured okay I</font><font color="#CCCCCC"> didn't</font>

480
00:23:20,810 --> 00:23:27,050
<font color="#E5E5E5">think about</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> yet</font><font color="#CCCCCC"> actually a good</font>

481
00:23:22,790 --> 00:23:30,680
question<font color="#CCCCCC"> I don't think</font><font color="#E5E5E5"> there would be</font>

482
00:23:27,050 --> 00:23:32,690
<font color="#E5E5E5">too much use but maybe as an add-on from</font>

483
00:23:30,680 --> 00:23:35,300
increased security if you really need

484
00:23:32,690 --> 00:23:36,980
that<font color="#E5E5E5"> maybe I can research that if you</font>

485
00:23:35,300 --> 00:23:39,720
want to just<font color="#E5E5E5"> leave me your email address</font>

486
00:23:36,980 --> 00:23:42,590
<font color="#CCCCCC">and</font><font color="#E5E5E5"> I can send you the answer</font>

487
00:23:39,720 --> 00:23:42,590
<font color="#E5E5E5">okay thank you</font>

488
00:23:52,920 --> 00:23:57,190
no questions<font color="#CCCCCC"> alright and thank</font><font color="#E5E5E5"> you for</font>

489
00:23:56,610 --> 00:24:00,769
<font color="#E5E5E5">your attention</font>

490
00:23:57,190 --> 00:24:00,769
[Applause]

