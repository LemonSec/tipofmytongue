1
00:00:00,060 --> 00:00:04,048
all right good morning everybody thank

2
00:00:02,129 --> 00:00:06,180
you for joining me here first thing in

3
00:00:04,049 --> 00:00:07,919
the morning from day two of blackhat I'm

4
00:00:06,180 --> 00:00:10,379
here to talk to you all about software

5
00:00:07,919 --> 00:00:12,540
supply chain attacks by way of quick

6
00:00:10,380 --> 00:00:14,219
introduction my name is Ryan kazansky

7
00:00:12,540 --> 00:00:15,928
and I'm chief product officer Itanium

8
00:00:14,219 --> 00:00:19,439
I'm based out of Alexandria Virginia

9
00:00:15,929 --> 00:00:21,180
right outside the DC area I've been in

10
00:00:19,439 --> 00:00:23,970
the security in the street for God

11
00:00:21,180 --> 00:00:25,529
almost 15 16 years now started out at

12
00:00:23,970 --> 00:00:27,960
PricewaterhouseCoopers where I focused

13
00:00:25,529 --> 00:00:29,970
on audit penetration testing and

14
00:00:27,960 --> 00:00:32,099
application security work moved over to

15
00:00:29,970 --> 00:00:33,780
mandiant spent six years leading

16
00:00:32,098 --> 00:00:35,550
Incident Response investigations for

17
00:00:33,780 --> 00:00:38,550
targeted breaches and then most recently

18
00:00:35,550 --> 00:00:40,649
have been in teh neom I also during that

19
00:00:38,550 --> 00:00:42,809
time co-authored Incident Response in

20
00:00:40,649 --> 00:00:45,030
computer forensics third edition did

21
00:00:42,809 --> 00:00:47,459
some previous work at prior black hats

22
00:00:45,030 --> 00:00:50,160
on PowerShell attacks and Windows DSC

23
00:00:47,460 --> 00:00:52,469
and then the last few years also spent a

24
00:00:50,160 --> 00:00:54,179
lot of time in my second job working

25
00:00:52,469 --> 00:00:56,039
with the mr. robot production team on

26
00:00:54,180 --> 00:00:58,260
seasons two in seasons three getting

27
00:00:56,039 --> 00:01:00,510
things like struts attacks and Ida Pro

28
00:00:58,260 --> 00:01:02,789
and other realistic hacks that we wove

29
00:01:00,510 --> 00:01:05,729
into the show incorporated with the

30
00:01:02,789 --> 00:01:08,460
writing and production team so let's

31
00:01:05,729 --> 00:01:10,380
talk about where this all started and

32
00:01:08,460 --> 00:01:12,390
I'm gonna begin with a brief timeline of

33
00:01:10,380 --> 00:01:14,729
software supply chain attacks and how I

34
00:01:12,390 --> 00:01:16,110
got involved in this research it

35
00:01:14,729 --> 00:01:18,929
actually began with really humble

36
00:01:16,110 --> 00:01:21,330
origins so I had moved to a new home and

37
00:01:18,930 --> 00:01:24,180
I had a bunch of crates full of DVDs of

38
00:01:21,330 --> 00:01:25,710
movies and TV shows that I wanted to rip

39
00:01:24,180 --> 00:01:27,780
so that I could stream them instead of

40
00:01:25,710 --> 00:01:29,908
having to deal with discs and so to do

41
00:01:27,780 --> 00:01:32,700
that I used handbrake a really popular

42
00:01:29,909 --> 00:01:35,100
tool for Mac OS that allows you to

43
00:01:32,700 --> 00:01:36,270
encode ripped video files and so then

44
00:01:35,100 --> 00:01:38,460
you can stream them with Plex or

45
00:01:36,270 --> 00:01:39,899
whatever media server you want so I've

46
00:01:38,460 --> 00:01:43,289
been using handbrake for a while turning

47
00:01:39,900 --> 00:01:45,180
away encoding discs and what was

48
00:01:43,290 --> 00:01:47,369
striking to me is I read in the news a

49
00:01:45,180 --> 00:01:49,020
couple of months later that handbrake

50
00:01:47,369 --> 00:01:51,119
had been hacked and for a period of a

51
00:01:49,020 --> 00:01:52,380
couple of days if you had downloaded

52
00:01:51,119 --> 00:01:54,299
handbrake from the website or from

53
00:01:52,380 --> 00:01:56,310
homebrew you actually got a malicious

54
00:01:54,299 --> 00:01:59,009
version that was delivering a variant of

55
00:01:56,310 --> 00:02:00,719
the proton Mac OS malware framework and

56
00:01:59,009 --> 00:02:03,119
that was really striking to me because I

57
00:02:00,719 --> 00:02:05,789
sensibly have a security background and

58
00:02:03,119 --> 00:02:08,280
try to stay fairly safe out in my day to

59
00:02:05,790 --> 00:02:09,929
day usage of my home computer and I

60
00:02:08,280 --> 00:02:11,190
realized if I was just unlucky enough to

61
00:02:09,929 --> 00:02:13,870
have downloaded the software at the

62
00:02:11,190 --> 00:02:16,569
wrong time I might have been popped

63
00:02:13,870 --> 00:02:19,450
and then of course a couple weeks after

64
00:02:16,569 --> 00:02:22,298
this was the infamous not petia attack

65
00:02:19,450 --> 00:02:24,159
which began as many of you might know

66
00:02:22,299 --> 00:02:26,110
with the compromise of a Ukrainian

67
00:02:24,159 --> 00:02:28,120
accounting software package called Medoc

68
00:02:26,110 --> 00:02:30,340
and this was very strategically chosen

69
00:02:28,120 --> 00:02:32,530
to have a show of force in terms of the

70
00:02:30,340 --> 00:02:34,750
impact and damage that this breach

71
00:02:32,530 --> 00:02:36,670
ultimately ended up having so what I

72
00:02:34,750 --> 00:02:38,980
started to do is chart out all of these

73
00:02:36,670 --> 00:02:40,988
supply chain attacks and get a broader

74
00:02:38,980 --> 00:02:42,640
sense of how many there actually were

75
00:02:40,989 --> 00:02:44,170
how prevalent they were and if there

76
00:02:42,640 --> 00:02:46,298
were any common threads or trends that I

77
00:02:44,170 --> 00:02:47,828
was seeing among them and so as I

78
00:02:46,299 --> 00:02:49,660
started to look back in time I found

79
00:02:47,829 --> 00:02:51,069
that there were quite a few some of

80
00:02:49,660 --> 00:02:53,109
which had actually kind of flown under

81
00:02:51,069 --> 00:02:56,230
the radar going back as early as

82
00:02:53,109 --> 00:02:57,940
2012-2013 and then I did an initial

83
00:02:56,230 --> 00:03:00,340
version of this presentation in late

84
00:02:57,940 --> 00:03:01,840
2017 and going all the way up to that

85
00:03:00,340 --> 00:03:04,510
there had been a flutter of additional

86
00:03:01,840 --> 00:03:06,700
supply chain attacks targeting trusted

87
00:03:04,510 --> 00:03:08,230
software and then in the past year I've

88
00:03:06,700 --> 00:03:09,849
continued to do this research and really

89
00:03:08,230 --> 00:03:11,200
try to understand whether that we're

90
00:03:09,849 --> 00:03:13,358
going to be continuing and evolving

91
00:03:11,200 --> 00:03:15,700
trends and as you can see it's been an

92
00:03:13,359 --> 00:03:17,829
extraordinarily busy two-year period in

93
00:03:15,700 --> 00:03:19,888
terms of software supply chain attacks

94
00:03:17,829 --> 00:03:23,200
against a variety of different targets

95
00:03:19,889 --> 00:03:24,880
proliferating in the past years if you

96
00:03:23,200 --> 00:03:26,440
look at each of these attacks they all

97
00:03:24,880 --> 00:03:28,709
have their own interesting story and

98
00:03:26,440 --> 00:03:31,959
objective and means for instance

99
00:03:28,709 --> 00:03:33,250
ultraedit really popular text editor

100
00:03:31,959 --> 00:03:35,590
used by a lot of developers and

101
00:03:33,250 --> 00:03:37,750
engineers this was targeted and what

102
00:03:35,590 --> 00:03:40,930
Microsoft called Operation wily supply

103
00:03:37,750 --> 00:03:43,150
in 2017 and the period of exposure was

104
00:03:40,930 --> 00:03:44,829
only one day and according to the

105
00:03:43,150 --> 00:03:46,359
reporting about two dozen companies were

106
00:03:44,829 --> 00:03:48,940
targeted and what was really a fairly

107
00:03:46,359 --> 00:03:51,129
targeted compromise you contrast that

108
00:03:48,940 --> 00:03:52,660
with when web developer extension on the

109
00:03:51,129 --> 00:03:55,120
Chrome Web extension store was popped

110
00:03:52,660 --> 00:03:57,310
that was a three day exposure period and

111
00:03:55,120 --> 00:03:58,989
millions of users were exposed that

112
00:03:57,310 --> 00:04:01,030
wasn't mean that meant for targeted

113
00:03:58,989 --> 00:04:03,549
compromise that was actually a means by

114
00:04:01,030 --> 00:04:05,739
which to distribute adware and then

115
00:04:03,549 --> 00:04:08,829
finally ccleaner which happened right

116
00:04:05,739 --> 00:04:10,480
after not Pecha and me doc that was also

117
00:04:08,829 --> 00:04:11,590
a very large exposure a malicious

118
00:04:10,480 --> 00:04:14,138
version of ccleaner was being

119
00:04:11,590 --> 00:04:15,910
distributed for over one month period

120
00:04:14,139 --> 00:04:18,070
and over two million people downloaded

121
00:04:15,910 --> 00:04:20,409
it but just like a watering hole attack

122
00:04:18,070 --> 00:04:23,130
the post compromised activity that Cisco

123
00:04:20,410 --> 00:04:26,169
Talos observed only impacted 18 firms

124
00:04:23,130 --> 00:04:27,639
and these are of course a very small

125
00:04:26,169 --> 00:04:29,770
subset of a much broader egos

126
00:04:27,639 --> 00:04:31,810
system of supply chain attacks those

127
00:04:29,770 --> 00:04:33,849
targeting enterprise software end-user

128
00:04:31,810 --> 00:04:36,009
software software development tool

129
00:04:33,849 --> 00:04:38,770
chains SAS and software provider it's

130
00:04:36,009 --> 00:04:40,569
hardware and firmware and so on for the

131
00:04:38,770 --> 00:04:42,128
purposes of this presentation especially

132
00:04:40,569 --> 00:04:43,749
because we have about half an hour I'm

133
00:04:42,129 --> 00:04:45,370
gonna focus only on two major areas

134
00:04:43,749 --> 00:04:47,469
enterprise software and end-user

135
00:04:45,370 --> 00:04:51,099
software and briefly touch on

136
00:04:47,469 --> 00:04:52,719
development tool chain as well so before

137
00:04:51,099 --> 00:04:54,460
we get into that let's talk a little bit

138
00:04:52,719 --> 00:04:56,650
about what's driving these attacks

139
00:04:54,460 --> 00:04:58,299
because ultimately compromising a

140
00:04:56,650 --> 00:05:01,239
trusted software vendor to get access to

141
00:04:58,300 --> 00:05:03,009
a victim is a fairly difficult way to

142
00:05:01,240 --> 00:05:05,050
breach someone and so it was interesting

143
00:05:03,009 --> 00:05:07,930
to me to think about why this is even a

144
00:05:05,050 --> 00:05:10,029
trend if you go back to the early to mid

145
00:05:07,930 --> 00:05:11,770
2010 and when I did a lot of Incident

146
00:05:10,029 --> 00:05:14,020
Response work we saw this quite often

147
00:05:11,770 --> 00:05:15,698
one of the many ways attackers would get

148
00:05:14,020 --> 00:05:17,830
access to targeted victims was the

149
00:05:15,699 --> 00:05:19,810
classic watering hole so in a watering

150
00:05:17,830 --> 00:05:21,490
hole attack if you want to get access to

151
00:05:19,810 --> 00:05:23,379
a certain set of victim companies you

152
00:05:21,490 --> 00:05:24,849
compromised a website that you think

153
00:05:23,379 --> 00:05:26,830
those victims are likely to encounter

154
00:05:24,849 --> 00:05:28,900
and then you get a whole bunch of

155
00:05:26,830 --> 00:05:30,818
victims and of that entire mass of

156
00:05:28,900 --> 00:05:33,039
victims you might only pursue secondary

157
00:05:30,819 --> 00:05:35,139
command and control on a subset that you

158
00:05:33,039 --> 00:05:37,509
care about and so we saw a lot of apt

159
00:05:35,139 --> 00:05:39,520
groups using this technique we also in

160
00:05:37,509 --> 00:05:41,199
the 2010s saw the proliferation of

161
00:05:39,520 --> 00:05:43,389
exploit kits that packaged together a

162
00:05:41,199 --> 00:05:45,069
whole bunch of browser exploits against

163
00:05:43,389 --> 00:05:48,639
either the browsers or the plugins they

164
00:05:45,069 --> 00:05:50,099
use and then sell those so that crime or

165
00:05:48,639 --> 00:05:52,089
criminal organizations and other

166
00:05:50,099 --> 00:05:53,919
opportunistic attackers could eat make

167
00:05:52,089 --> 00:05:56,349
easy use of them they had stuff like rig

168
00:05:53,919 --> 00:05:58,089
stuff like black hole really

169
00:05:56,349 --> 00:06:00,550
compromising millions and millions of

170
00:05:58,089 --> 00:06:01,449
users for different purposes then what

171
00:06:00,550 --> 00:06:04,120
happened

172
00:06:01,449 --> 00:06:06,759
starting in around 2013 we saw a shift

173
00:06:04,120 --> 00:06:08,500
in browser market share chrome

174
00:06:06,759 --> 00:06:10,529
ostensibly a pretty well designed really

175
00:06:08,500 --> 00:06:13,300
secure browser starts to take over

176
00:06:10,529 --> 00:06:14,830
internet explorer starts to dwindle we

177
00:06:13,300 --> 00:06:17,740
start to see users using adblock

178
00:06:14,830 --> 00:06:20,740
software not just the really technical

179
00:06:17,740 --> 00:06:23,259
expert users but we see mass adoption of

180
00:06:20,740 --> 00:06:25,029
AD adblock software which also has a

181
00:06:23,259 --> 00:06:28,000
side effect of suppressing in some cases

182
00:06:25,029 --> 00:06:29,259
malicious JavaScript and then finally we

183
00:06:28,000 --> 00:06:32,020
saw a thank goodness the death of

184
00:06:29,259 --> 00:06:34,089
plugins we saw flash go away we saw a

185
00:06:32,020 --> 00:06:35,948
Java Java plug-in start to go away we

186
00:06:34,089 --> 00:06:38,139
saw browsers start to disable these by

187
00:06:35,949 --> 00:06:40,830
default and all of these started to

188
00:06:38,139 --> 00:06:43,020
shrink the attack surface of

189
00:06:40,830 --> 00:06:45,150
exploitable web browsers and the plugins

190
00:06:43,020 --> 00:06:48,599
they use and as a result we saw a

191
00:06:45,150 --> 00:06:51,390
decline in exploit kits rig for example

192
00:06:48,600 --> 00:06:52,830
had a precipitous drop in the 2017

193
00:06:51,390 --> 00:06:54,810
period and really all the other major

194
00:06:52,830 --> 00:06:56,700
exploit kits followed suit

195
00:06:54,810 --> 00:06:59,370
there was a brief surge in early 2018

196
00:06:56,700 --> 00:07:02,729
the 2018 that you'll read about that was

197
00:06:59,370 --> 00:07:05,580
triggered by 2-0 days that was released

198
00:07:02,730 --> 00:07:08,160
in close proximity one was in flash one

199
00:07:05,580 --> 00:07:10,200
was in IE but by-and-large exploit kid

200
00:07:08,160 --> 00:07:12,300
activity has really died down and the

201
00:07:10,200 --> 00:07:15,360
introduction of new exploit kits has in

202
00:07:12,300 --> 00:07:17,460
parallel also died down quite a bit so

203
00:07:15,360 --> 00:07:19,260
what our attackers left to do how do

204
00:07:17,460 --> 00:07:21,359
they adapt well there's still many other

205
00:07:19,260 --> 00:07:23,969
ways that you can compromise victims of

206
00:07:21,360 --> 00:07:25,890
course one is simple social engineering

207
00:07:23,970 --> 00:07:27,570
so if I lead someone to a website and

208
00:07:25,890 --> 00:07:29,849
convince them that it's a good idea to

209
00:07:27,570 --> 00:07:32,370
download and execute install flash

210
00:07:29,850 --> 00:07:33,990
player XE there's no real exploit there

211
00:07:32,370 --> 00:07:35,880
other than tricking a user into running

212
00:07:33,990 --> 00:07:38,490
something they shouldn't and so we see a

213
00:07:35,880 --> 00:07:40,920
lot of that we see abuse of

214
00:07:38,490 --> 00:07:43,440
functionality that is legitimately baked

215
00:07:40,920 --> 00:07:45,270
in to productivity applications so why

216
00:07:43,440 --> 00:07:48,090
not have your spreadsheet able to launch

217
00:07:45,270 --> 00:07:50,010
a command that makes total sense so

218
00:07:48,090 --> 00:07:51,750
things like the dde attack and the slew

219
00:07:50,010 --> 00:07:54,150
of office productivity application

220
00:07:51,750 --> 00:07:55,980
exploits that leveraged native

221
00:07:54,150 --> 00:07:58,950
functionality built into these these

222
00:07:55,980 --> 00:08:00,840
tools to do bad things and then finally

223
00:07:58,950 --> 00:08:02,729
I think software supply chain attacks

224
00:08:00,840 --> 00:08:05,369
them as emerged in this space is another

225
00:08:02,730 --> 00:08:07,530
option for attackers to fill the void

226
00:08:05,370 --> 00:08:09,560
that the lack of browser exploit says

227
00:08:07,530 --> 00:08:12,239
has left behind

228
00:08:09,560 --> 00:08:14,490
so what else contributes to why as a

229
00:08:12,240 --> 00:08:16,650
general ecosystem were vulnerable to

230
00:08:14,490 --> 00:08:18,330
these types of attacks I think there are

231
00:08:16,650 --> 00:08:20,849
a couple of factors and the first begins

232
00:08:18,330 --> 00:08:23,250
with attackers getting really savvy at

233
00:08:20,850 --> 00:08:26,160
subverting our trust mechanisms and in

234
00:08:23,250 --> 00:08:28,470
particular I want to talk about signed

235
00:08:26,160 --> 00:08:30,270
code and digital certificates so we use

236
00:08:28,470 --> 00:08:32,190
code signing as a means of demonstrating

237
00:08:30,270 --> 00:08:34,710
integrity in the software that we create

238
00:08:32,190 --> 00:08:36,720
and trust and one of the interesting

239
00:08:34,710 --> 00:08:38,420
trends on the time line that I analyzed

240
00:08:36,720 --> 00:08:40,680
was which of the supply chain attacks

241
00:08:38,419 --> 00:08:43,110
incorporated the use of signed malware

242
00:08:40,679 --> 00:08:45,630
so everything bolded here used signed

243
00:08:43,110 --> 00:08:47,940
malware at some step of the payload the

244
00:08:45,630 --> 00:08:49,830
ones with an asterisks actually used a

245
00:08:47,940 --> 00:08:51,810
different digital certificate than the

246
00:08:49,830 --> 00:08:53,430
original developer so in some cases they

247
00:08:51,810 --> 00:08:54,719
were able to compromise the certificates

248
00:08:53,430 --> 00:08:56,790
of the originating soft

249
00:08:54,720 --> 00:08:58,500
publisher in some cases they just signed

250
00:08:56,790 --> 00:09:01,769
stuff with other certs that had been

251
00:08:58,500 --> 00:09:03,829
previously stolen or obtained when I

252
00:09:01,769 --> 00:09:06,720
actually worked cases in the early

253
00:09:03,829 --> 00:09:08,459
2012-2013 time period this was happening

254
00:09:06,720 --> 00:09:11,220
a lot more often than reported so one

255
00:09:08,459 --> 00:09:13,258
example is in 2013 there was a lot of

256
00:09:11,220 --> 00:09:14,970
publicity publicity about a hacking

257
00:09:13,259 --> 00:09:17,519
group that had attacked Apple Facebook

258
00:09:14,970 --> 00:09:19,379
Twitter and a slew of other technology

259
00:09:17,519 --> 00:09:21,870
companies and I worked a few of the non

260
00:09:19,379 --> 00:09:23,399
publicized cases here and one of the

261
00:09:21,870 --> 00:09:25,050
things that this gang was really good at

262
00:09:23,399 --> 00:09:26,189
was stealing digital certificates and

263
00:09:25,050 --> 00:09:28,410
going after the code signing

264
00:09:26,189 --> 00:09:30,000
infrastructure and technology companies

265
00:09:28,410 --> 00:09:31,259
and you knew they were good at it

266
00:09:30,000 --> 00:09:34,139
because the malware they would use that

267
00:09:31,259 --> 00:09:36,329
one victim was digitally signed by prior

268
00:09:34,139 --> 00:09:38,040
victims and in most cases when you do

269
00:09:36,329 --> 00:09:40,529
the IR you'd find that those certs had

270
00:09:38,040 --> 00:09:42,329
still not been revoked finally a couple

271
00:09:40,529 --> 00:09:44,399
years later academia started to do

272
00:09:42,329 --> 00:09:47,550
broader research on this one study done

273
00:09:44,399 --> 00:09:48,389
in 2017 looked at the corpus of malware

274
00:09:47,550 --> 00:09:50,550
on virustotal

275
00:09:48,389 --> 00:09:52,740
found a fair number of signed samples

276
00:09:50,550 --> 00:09:55,079
that they examined and found that they

277
00:09:52,740 --> 00:09:58,139
were comprised of about 112 stolen certs

278
00:09:55,079 --> 00:09:59,638
and 80% of those had not actually been

279
00:09:58,139 --> 00:10:02,220
revoked even though they had been in use

280
00:09:59,639 --> 00:10:03,600
for in some cases several years so

281
00:10:02,220 --> 00:10:05,519
clearly attackers know how to sign

282
00:10:03,600 --> 00:10:08,430
software to evade security and trust

283
00:10:05,519 --> 00:10:10,410
mechanisms a more recent study followed

284
00:10:08,430 --> 00:10:12,329
in this past year and showed that in

285
00:10:10,410 --> 00:10:14,309
addition to attackers stealing

286
00:10:12,329 --> 00:10:16,739
certificates there's also a growing

287
00:10:14,309 --> 00:10:18,990
underground economy of shady certificate

288
00:10:16,740 --> 00:10:20,670
brokers that are issuing not only code

289
00:10:18,990 --> 00:10:21,269
signing certs but even if you have the

290
00:10:20,670 --> 00:10:23,250
money for it

291
00:10:21,269 --> 00:10:25,649
authentic code certificates which have a

292
00:10:23,250 --> 00:10:29,069
higher bar and also offer for an

293
00:10:25,649 --> 00:10:30,180
attacker the ability to evade a lot of

294
00:10:29,069 --> 00:10:31,740
security controls that will

295
00:10:30,180 --> 00:10:35,430
intrinsically trust something that has

296
00:10:31,740 --> 00:10:38,459
an authentic code sir the second factor

297
00:10:35,430 --> 00:10:40,589
is the sheer software diversity that we

298
00:10:38,459 --> 00:10:42,209
encounter in most organizations and I

299
00:10:40,589 --> 00:10:44,279
really like this diagram that Holl var

300
00:10:42,209 --> 00:10:46,529
flake tweeted a couple years ago showing

301
00:10:44,279 --> 00:10:48,149
just the web of trust graphs that exist

302
00:10:46,529 --> 00:10:50,069
when you consider all the software that

303
00:10:48,149 --> 00:10:51,839
runs on your computer and in an

304
00:10:50,069 --> 00:10:53,370
enterprise context I look at this at two

305
00:10:51,839 --> 00:10:55,680
different layers and the first begins

306
00:10:53,370 --> 00:10:59,220
with the vendors that your companies and

307
00:10:55,680 --> 00:11:00,719
your employer's trust to provide the

308
00:10:59,220 --> 00:11:02,309
software that they buy and when people

309
00:11:00,720 --> 00:11:04,620
talk about businesses dealing with

310
00:11:02,309 --> 00:11:07,649
supply chain tax they're usually focused

311
00:11:04,620 --> 00:11:09,029
on this like looking at your vendors and

312
00:11:07,649 --> 00:11:10,769
software that they're providing because

313
00:11:09,029 --> 00:11:13,649
that's at least a smaller space of

314
00:11:10,769 --> 00:11:15,930
things to deal with in most enterprises

315
00:11:13,649 --> 00:11:18,360
organizations not surprisingly trust and

316
00:11:15,930 --> 00:11:20,099
use a lot of enterprise agents things

317
00:11:18,360 --> 00:11:22,079
that run persistently on all of your

318
00:11:20,100 --> 00:11:23,879
endpoints every year the Ponemon

319
00:11:22,079 --> 00:11:26,489
Institute does a study of this and the

320
00:11:23,879 --> 00:11:28,559
most recent results from 2017 showed

321
00:11:26,490 --> 00:11:31,379
that 32 percent of organizations have

322
00:11:28,559 --> 00:11:33,540
six to ten and point agents 27 percent

323
00:11:31,379 --> 00:11:35,939
have 10 or more agents that is a lot of

324
00:11:33,540 --> 00:11:37,498
long-lived persistent code running on

325
00:11:35,939 --> 00:11:39,209
every end point that probably has a

326
00:11:37,499 --> 00:11:42,749
whole slew of dependencies that each of

327
00:11:39,209 --> 00:11:44,399
them carry along what gets really scary

328
00:11:42,749 --> 00:11:46,290
though is when you compound that against

329
00:11:44,399 --> 00:11:48,360
all of the software that your end-users

330
00:11:46,290 --> 00:11:49,980
install on their computers to do their

331
00:11:48,360 --> 00:11:51,360
jobs or all the other stuff that they

332
00:11:49,980 --> 00:11:53,129
want to do on their work computer and

333
00:11:51,360 --> 00:11:55,170
that's where the number of trusted

334
00:11:53,129 --> 00:11:57,869
software or implicitly trusted software

335
00:11:55,170 --> 00:11:59,459
starts to really explode so in my day

336
00:11:57,869 --> 00:12:02,069
job this is something that we work with

337
00:11:59,459 --> 00:12:03,449
companies a lot on tracking and the

338
00:12:02,069 --> 00:12:06,269
metrics are actually pretty staggering

339
00:12:03,449 --> 00:12:08,699
so if you were to take a ratio of number

340
00:12:06,269 --> 00:12:11,040
of endpoints to the number of unique

341
00:12:08,699 --> 00:12:14,160
versions of software that are installed

342
00:12:11,040 --> 00:12:17,129
in smaller environments that ratio is 5

343
00:12:14,160 --> 00:12:19,019
to 7 X the number of endpoints so if you

344
00:12:17,129 --> 00:12:20,790
have under 100,000 endpoints you can

345
00:12:19,019 --> 00:12:23,550
expect five to seven times that number

346
00:12:20,790 --> 00:12:25,709
in unique pairings of applications and

347
00:12:23,550 --> 00:12:27,809
versions of those apps in larger

348
00:12:25,709 --> 00:12:30,209
networks that ratio expectedly goes down

349
00:12:27,809 --> 00:12:32,040
to about one to three x but to give you

350
00:12:30,209 --> 00:12:33,469
a specific example one of the

351
00:12:32,040 --> 00:12:36,929
organizations I've worked with with

352
00:12:33,470 --> 00:12:39,269
230,000 endpoints has 400,000 unique

353
00:12:36,929 --> 00:12:40,949
application version pairings and that is

354
00:12:39,269 --> 00:12:43,829
a tremendous about the software to worry

355
00:12:40,949 --> 00:12:45,990
about to manage to monitor and to assess

356
00:12:43,829 --> 00:12:49,349
if it's actually secure it's pretty much

357
00:12:45,990 --> 00:12:51,149
an impossible task and so how do

358
00:12:49,350 --> 00:12:53,189
security teams and most companies cope

359
00:12:51,149 --> 00:12:55,649
with this diversity well they have to

360
00:12:53,189 --> 00:12:57,540
make some really tough trade-offs one is

361
00:12:55,649 --> 00:12:58,889
if you're using antivirus or if you're

362
00:12:57,540 --> 00:13:00,809
trying to use something like application

363
00:12:58,889 --> 00:13:02,879
whitelisting you start to create more

364
00:13:00,809 --> 00:13:05,129
and more policy exclusions to allow

365
00:13:02,879 --> 00:13:06,749
through all of the uncommon good that

366
00:13:05,129 --> 00:13:08,850
might otherwise trigger your security

367
00:13:06,749 --> 00:13:10,769
controls and sometimes that leads to

368
00:13:08,850 --> 00:13:12,959
overly broad exclusions that are

369
00:13:10,769 --> 00:13:15,839
necessary just to allow people to run

370
00:13:12,959 --> 00:13:17,910
good software and get their jobs done it

371
00:13:15,839 --> 00:13:19,709
also makes hunting and monitoring really

372
00:13:17,910 --> 00:13:21,600
really difficult and frustrating anyone

373
00:13:19,709 --> 00:13:23,969
who's done proactive enterprise hunting

374
00:13:21,600 --> 00:13:26,459
large scale has probably encountered the

375
00:13:23,970 --> 00:13:28,649
bane of uncommon good and often times

376
00:13:26,459 --> 00:13:32,040
the difference between obscure software

377
00:13:28,649 --> 00:13:34,500
that's auto-updating and a initial

378
00:13:32,040 --> 00:13:36,509
dropper for malware is really really

379
00:13:34,500 --> 00:13:38,339
narrow they often look exactly the same

380
00:13:36,509 --> 00:13:40,350
and so this is really difficult for

381
00:13:38,339 --> 00:13:42,829
hunting teams and leads to a lot of

382
00:13:40,350 --> 00:13:45,750
noise that they have to cope with

383
00:13:42,829 --> 00:13:47,880
alright so with some of those factors in

384
00:13:45,750 --> 00:13:50,190
mind let's now turn to the trends and

385
00:13:47,880 --> 00:13:53,130
patterns that we've seen in supply chain

386
00:13:50,190 --> 00:13:54,930
attacks in the past year the first is

387
00:13:53,130 --> 00:13:57,569
the emergence of cryptocurrency payloads

388
00:13:54,930 --> 00:13:59,638
and I really like this tweet about it a

389
00:13:57,569 --> 00:14:02,130
firewall exploited to install a docker

390
00:13:59,639 --> 00:14:04,949
container that spawns a Bitcoin miner to

391
00:14:02,130 --> 00:14:06,569
steal CPU what a time to be alive the

392
00:14:04,949 --> 00:14:09,209
cryptocurrency payloads incorporate

393
00:14:06,569 --> 00:14:12,509
things like cryptocurrency miners for

394
00:14:09,209 --> 00:14:14,779
things like Manero also theft of data so

395
00:14:12,509 --> 00:14:17,069
like stealing wallet information

396
00:14:14,779 --> 00:14:18,899
basically in browser main in the middle

397
00:14:17,069 --> 00:14:20,279
of transactions things like that all

398
00:14:18,899 --> 00:14:23,160
fall under what I call a cryptocurrency

399
00:14:20,279 --> 00:14:25,649
related payloads if you look at the

400
00:14:23,160 --> 00:14:28,170
timeline that we started out with clear

401
00:14:25,649 --> 00:14:30,810
clustering here a significant portion of

402
00:14:28,170 --> 00:14:32,699
the software supply chain attacks that

403
00:14:30,810 --> 00:14:35,250
I've been tracking since about mid 2017

404
00:14:32,699 --> 00:14:37,109
have been cryptocurrency focused and in

405
00:14:35,250 --> 00:14:39,389
many ways and maybe I'm biased from

406
00:14:37,110 --> 00:14:41,370
doing a lot of targeted apt type

407
00:14:39,389 --> 00:14:43,380
incident response work I look at this as

408
00:14:41,370 --> 00:14:45,240
a massive waste of a great foothold

409
00:14:43,380 --> 00:14:47,399
because if you look at the number of

410
00:14:45,240 --> 00:14:50,189
victims or at least the exposure that

411
00:14:47,399 --> 00:14:52,319
these attacks had its enormous and you

412
00:14:50,189 --> 00:14:53,790
could have done really really evil bad

413
00:14:52,319 --> 00:14:56,069
things with access to this many

414
00:14:53,790 --> 00:14:58,349
endpoints but instead they targeted

415
00:14:56,069 --> 00:15:00,089
either crypto mining or cryptocurrency

416
00:14:58,350 --> 00:15:02,339
theft and didn't really make a whole lot

417
00:15:00,089 --> 00:15:04,680
of money from at least what I can tell

418
00:15:02,339 --> 00:15:06,959
but yeah the most recent one is npm

419
00:15:04,680 --> 00:15:08,609
event stream package this just happened

420
00:15:06,959 --> 00:15:10,529
a couple of weeks ago or at least was

421
00:15:08,610 --> 00:15:12,360
publicized a couple of weeks ago eight

422
00:15:10,529 --> 00:15:14,430
million people exposed over a

423
00:15:12,360 --> 00:15:16,250
three-month period where this open

424
00:15:14,430 --> 00:15:19,800
source NPM package had been subverted

425
00:15:16,250 --> 00:15:22,920
the docker user image hub the user

426
00:15:19,800 --> 00:15:24,990
submitted image of 17 images sat on the

427
00:15:22,920 --> 00:15:26,910
docker hub for 10 months with

428
00:15:24,990 --> 00:15:29,550
cryptocurrency miners built in with no

429
00:15:26,910 --> 00:15:31,639
one noticing that's actually not true a

430
00:15:29,550 --> 00:15:34,040
few people did notice and try to file

431
00:15:31,639 --> 00:15:35,209
notices to get them removed but

432
00:15:34,040 --> 00:15:37,250
it took ten months for that to happen

433
00:15:35,209 --> 00:15:39,109
and five million people downloaded them

434
00:15:37,250 --> 00:15:42,350
in the interim we've had browser

435
00:15:39,110 --> 00:15:44,630
extensions like mega the mega downloader

436
00:15:42,350 --> 00:15:46,279
extension had been compromised you can

437
00:15:44,630 --> 00:15:48,259
see the list here lots and lots of

438
00:15:46,279 --> 00:15:49,930
infected users the only one that

439
00:15:48,259 --> 00:15:53,060
actually had a public record of the

440
00:15:49,930 --> 00:15:55,579
dollar impacts or the the money that the

441
00:15:53,060 --> 00:15:58,250
attackers made was the docker case they

442
00:15:55,579 --> 00:16:00,349
earned about 545 manera coins which is

443
00:15:58,250 --> 00:16:02,000
ninety thousand dollars that's not a

444
00:16:00,350 --> 00:16:04,040
trivial amount of money but again I

445
00:16:02,000 --> 00:16:05,660
think about the exposure that was here

446
00:16:04,040 --> 00:16:09,829
and attackers could have done a lot

447
00:16:05,660 --> 00:16:12,459
worse we got away lucky conversely if

448
00:16:09,829 --> 00:16:14,630
you look at the targeted apts

449
00:16:12,459 --> 00:16:17,569
compromises what was interesting to me

450
00:16:14,630 --> 00:16:19,519
is most of these occurred prior to 2018

451
00:16:17,569 --> 00:16:21,740
now I think there's one of three things

452
00:16:19,519 --> 00:16:23,209
happening here the first is that these

453
00:16:21,740 --> 00:16:25,790
are continuing to happen and not getting

454
00:16:23,209 --> 00:16:27,768
publicized I'm skeptical of that because

455
00:16:25,790 --> 00:16:29,540
security firms love to publicize stuff

456
00:16:27,769 --> 00:16:32,209
even and honestly because it's great

457
00:16:29,540 --> 00:16:34,310
marketing the second is that it's still

458
00:16:32,209 --> 00:16:35,899
happening and not being detected I'm

459
00:16:34,310 --> 00:16:37,758
reasonably confident that's probably the

460
00:16:35,899 --> 00:16:39,649
case and the third is that it's probably

461
00:16:37,759 --> 00:16:41,240
not the most common way that targeted

462
00:16:39,649 --> 00:16:43,399
reaches are happening and I believe that

463
00:16:41,240 --> 00:16:45,740
as well because it is still a lot easier

464
00:16:43,399 --> 00:16:47,839
to say Spearfish someone then to try to

465
00:16:45,740 --> 00:16:53,720
pop software that a company happens to

466
00:16:47,839 --> 00:16:55,970
trust finally challenges with the

467
00:16:53,720 --> 00:16:57,410
detection of response time you would

468
00:16:55,970 --> 00:16:58,910
hope that we would get better at

469
00:16:57,410 --> 00:17:01,490
detecting and responding to this stuff

470
00:16:58,910 --> 00:17:03,350
quickly over the years but right now

471
00:17:01,490 --> 00:17:05,510
we're still in that very immature early

472
00:17:03,350 --> 00:17:07,189
stage where just like when targeted

473
00:17:05,510 --> 00:17:09,020
attacks first happened and the only way

474
00:17:07,189 --> 00:17:11,449
victims found out was when law

475
00:17:09,020 --> 00:17:13,240
enforcement did victim notifies same

476
00:17:11,449 --> 00:17:15,559
sort of thing is happening today where

477
00:17:13,240 --> 00:17:17,359
we have a handful of examples where

478
00:17:15,559 --> 00:17:19,939
these attacks were caught within a day

479
00:17:17,359 --> 00:17:21,740
and good on them that's awesome and then

480
00:17:19,939 --> 00:17:24,140
quite a few that took a month or longer

481
00:17:21,740 --> 00:17:26,089
to get detected these are approximations

482
00:17:24,140 --> 00:17:29,270
based on the publicly available data

483
00:17:26,089 --> 00:17:30,710
that I was able to glean so not super

484
00:17:29,270 --> 00:17:32,480
precise numbers but you get the picture

485
00:17:30,710 --> 00:17:34,669
it's still longer than you'd hope and

486
00:17:32,480 --> 00:17:37,040
what's also compelling is in almost

487
00:17:34,669 --> 00:17:39,380
every single one of these cases save for

488
00:17:37,040 --> 00:17:41,090
one and two it was an external means of

489
00:17:39,380 --> 00:17:43,540
detection meaning either a user a

490
00:17:41,090 --> 00:17:45,740
security researcher or a security firm

491
00:17:43,540 --> 00:17:47,930
notified the software owner that a

492
00:17:45,740 --> 00:17:50,450
breach had occurred not self detect

493
00:17:47,930 --> 00:17:52,190
if you read some of the ways that the

494
00:17:50,450 --> 00:17:54,230
open source community or user

495
00:17:52,190 --> 00:17:55,490
communities detected these it's both

496
00:17:54,230 --> 00:17:58,040
cool and terrifying

497
00:17:55,490 --> 00:18:00,530
so like the mega extension used by

498
00:17:58,040 --> 00:18:02,000
millions of users a reddit user

499
00:18:00,530 --> 00:18:03,620
discovered that it had been hacked and

500
00:18:02,000 --> 00:18:05,300
the way they did it was they noticed the

501
00:18:03,620 --> 00:18:07,669
permissions change when they updated the

502
00:18:05,300 --> 00:18:09,260
extension they posted on reddit about it

503
00:18:07,670 --> 00:18:10,640
a few people took a look at the

504
00:18:09,260 --> 00:18:12,890
JavaScript and they realized hey

505
00:18:10,640 --> 00:18:15,560
something nefarious got injected in here

506
00:18:12,890 --> 00:18:17,300
in the npm event stream case that

507
00:18:15,560 --> 00:18:19,490
happened a few weeks ago as i mentioned

508
00:18:17,300 --> 00:18:21,649
this was live for two to three months

509
00:18:19,490 --> 00:18:23,120
basically the original owner of this

510
00:18:21,650 --> 00:18:25,190
package decided they didn't want to

511
00:18:23,120 --> 00:18:26,570
update it anymore someone emailed him

512
00:18:25,190 --> 00:18:28,400
and said hey I'll take this over

513
00:18:26,570 --> 00:18:29,870
he gave him access to the repo and then

514
00:18:28,400 --> 00:18:31,850
that person committed malicious code

515
00:18:29,870 --> 00:18:34,010
there were people who noticed something

516
00:18:31,850 --> 00:18:36,409
was awry over that two to three months

517
00:18:34,010 --> 00:18:37,910
period but it took that that long of

518
00:18:36,410 --> 00:18:39,560
time for someone to finally nail down

519
00:18:37,910 --> 00:18:41,240
that yes there was malicious code here

520
00:18:39,560 --> 00:18:45,110
and again millions of people had

521
00:18:41,240 --> 00:18:46,790
downloaded it finally as scary as all

522
00:18:45,110 --> 00:18:48,409
these examples were there were a few

523
00:18:46,790 --> 00:18:50,420
that could have happened that didn't

524
00:18:48,410 --> 00:18:53,660
that would have been much worse in terms

525
00:18:50,420 --> 00:18:55,160
of scope of attack attack in 2017 a

526
00:18:53,660 --> 00:18:57,140
researcher took some of the public

527
00:18:55,160 --> 00:18:59,510
password disclosures from other breaches

528
00:18:57,140 --> 00:19:02,720
and determined that they could have used

529
00:18:59,510 --> 00:19:05,990
those passwords to gain access to 14% of

530
00:19:02,720 --> 00:19:09,020
NPM packages including if you track all

531
00:19:05,990 --> 00:19:12,890
the dependencies to those packages 54%

532
00:19:09,020 --> 00:19:13,790
of the entire NPM repo 15,000 495

533
00:19:12,890 --> 00:19:15,650
accounts

534
00:19:13,790 --> 00:19:18,560
tremendous tremendous level of exposure

535
00:19:15,650 --> 00:19:21,680
that could have been led to some really

536
00:19:18,560 --> 00:19:24,679
nasty breaches at one that really struck

537
00:19:21,680 --> 00:19:28,340
me was homebrew so how many here used

538
00:19:24,680 --> 00:19:29,690
homebrew how many of you diff and check

539
00:19:28,340 --> 00:19:32,870
the source code that gets pulled down

540
00:19:29,690 --> 00:19:35,150
every time you run brew update yeah I

541
00:19:32,870 --> 00:19:37,209
don't either and a researcher this year

542
00:19:35,150 --> 00:19:39,680
found that through a series of

543
00:19:37,210 --> 00:19:41,540
information leaks and vulnerabilities in

544
00:19:39,680 --> 00:19:43,520
30 minutes he was able to get commits

545
00:19:41,540 --> 00:19:44,780
access to the brew master branch and so

546
00:19:43,520 --> 00:19:46,310
he could have committed anything he

547
00:19:44,780 --> 00:19:47,389
wanted there and then if you ran brew

548
00:19:46,310 --> 00:19:49,940
update you would have pulled down his

549
00:19:47,390 --> 00:19:51,410
malicious code and the point he made in

550
00:19:49,940 --> 00:19:52,670
the medium article that talks about this

551
00:19:51,410 --> 00:19:53,990
is if he could have done this in 30

552
00:19:52,670 --> 00:19:55,790
minutes then a nation-state

553
00:19:53,990 --> 00:19:58,160
probably could have done a lot worse and

554
00:19:55,790 --> 00:20:00,050
I suspect probably has if not in

555
00:19:58,160 --> 00:20:01,740
homebrew somewhere else and that is

556
00:20:00,050 --> 00:20:04,168
really unsettling

557
00:20:01,740 --> 00:20:06,149
so with all these scary things in mind

558
00:20:04,169 --> 00:20:07,919
how do we respond then again I want to

559
00:20:06,149 --> 00:20:09,570
focus on the enterprise lens here

560
00:20:07,919 --> 00:20:11,159
because many of you probably work in

561
00:20:09,570 --> 00:20:13,230
organizations that are trying to defend

562
00:20:11,159 --> 00:20:14,520
against these attacks and you're not

563
00:20:13,230 --> 00:20:16,559
going to be able to tamp down all the

564
00:20:14,520 --> 00:20:18,029
software that's out there so how do you

565
00:20:16,559 --> 00:20:19,740
manage your attack surface for

566
00:20:18,029 --> 00:20:22,679
enterprise software and for end-user

567
00:20:19,740 --> 00:20:25,380
software the first point begins with

568
00:20:22,679 --> 00:20:27,149
assessing your visibility so many of you

569
00:20:25,380 --> 00:20:28,890
probably have EDR tooling in your

570
00:20:27,149 --> 00:20:31,500
environment that is continuously

571
00:20:28,890 --> 00:20:33,270
recording everything that executes along

572
00:20:31,500 --> 00:20:34,919
with the file and network activity that

573
00:20:33,270 --> 00:20:37,049
performs and that's really useful as a

574
00:20:34,919 --> 00:20:38,610
starting point if a supply chain attack

575
00:20:37,049 --> 00:20:40,770
gets disclosed and you need to hunt it

576
00:20:38,610 --> 00:20:42,658
down in your environment there's another

577
00:20:40,770 --> 00:20:44,580
layer of software identification which

578
00:20:42,659 --> 00:20:46,799
is predicated on what's on disk

579
00:20:44,580 --> 00:20:48,360
in other words EDR telemetry is good at

580
00:20:46,799 --> 00:20:50,340
giving you a rolling history of what

581
00:20:48,360 --> 00:20:52,408
runs but that needs to be complemented

582
00:20:50,340 --> 00:20:54,389
with an inventory of files at rest on

583
00:20:52,409 --> 00:20:56,669
your endpoints and the dependencies of

584
00:20:54,390 --> 00:20:58,470
those files at rest and then finally

585
00:20:56,669 --> 00:21:00,600
that needs to ultimately be blended in

586
00:20:58,470 --> 00:21:02,850
with normalized application inventory

587
00:21:00,600 --> 00:21:04,949
things that track the metadata about the

588
00:21:02,850 --> 00:21:06,959
versions of software's that group

589
00:21:04,950 --> 00:21:08,880
together packages not just by filename

590
00:21:06,960 --> 00:21:11,010
and hash but by common software

591
00:21:08,880 --> 00:21:12,929
groupings and entities and this is often

592
00:21:11,010 --> 00:21:14,669
in the remit of teams that do systems

593
00:21:12,929 --> 00:21:16,200
management rather than security if

594
00:21:14,669 --> 00:21:17,880
you're on the security team it's a good

595
00:21:16,200 --> 00:21:19,860
idea to buddy up with the IT ops teams

596
00:21:17,880 --> 00:21:20,850
that often own this data because you may

597
00:21:19,860 --> 00:21:24,479
find that it's a really valuable

598
00:21:20,850 --> 00:21:26,490
complement to your EDR tooling second is

599
00:21:24,480 --> 00:21:28,500
level of coverage a lot of companies

600
00:21:26,490 --> 00:21:29,789
have this tooling many don't have it

601
00:21:28,500 --> 00:21:31,679
across all of their end-user

602
00:21:29,789 --> 00:21:33,899
workstations and servers in a consistent

603
00:21:31,679 --> 00:21:35,789
manner and so ensuring if a supply chain

604
00:21:33,899 --> 00:21:37,620
attack gets disclosed that you can find

605
00:21:35,789 --> 00:21:39,899
a given piece of software and eversion

606
00:21:37,620 --> 00:21:42,418
on any system anywhere in your global

607
00:21:39,899 --> 00:21:44,039
environment is really critical and then

608
00:21:42,419 --> 00:21:45,990
finally understanding the accuracy and

609
00:21:44,039 --> 00:21:48,510
timeliness of the data how often is it

610
00:21:45,990 --> 00:21:50,520
refreshed how far back does it go how

611
00:21:48,510 --> 00:21:51,840
readily searchable is it these are all

612
00:21:50,520 --> 00:21:54,960
really good things to consider when

613
00:21:51,840 --> 00:21:58,199
preparing for this the second is

614
00:21:54,960 --> 00:22:00,029
managing your endpoint software one of

615
00:21:58,200 --> 00:22:01,529
the interesting ways many organizations

616
00:22:00,029 --> 00:22:04,409
I'm working with are starting to track

617
00:22:01,529 --> 00:22:05,789
risk among other factors is looking at

618
00:22:04,409 --> 00:22:08,640
how they can minimize the application

619
00:22:05,789 --> 00:22:10,649
sprawl for both enterprise and end-user

620
00:22:08,640 --> 00:22:13,230
software over time and if you use that

621
00:22:10,649 --> 00:22:15,469
sprawl as a metric for quantifying how

622
00:22:13,230 --> 00:22:17,899
well you're normalizing your in

623
00:22:15,470 --> 00:22:21,049
it's actually a really salient data

624
00:22:17,899 --> 00:22:23,090
point to get some better control over

625
00:22:21,049 --> 00:22:24,950
the risks of exposure of uncontrolled

626
00:22:23,090 --> 00:22:27,529
software especially software that

627
00:22:24,950 --> 00:22:29,539
updates itself on its own for more

628
00:22:27,529 --> 00:22:31,429
mature organizations and many of you

629
00:22:29,539 --> 00:22:33,259
might work in places that do this they

630
00:22:31,429 --> 00:22:35,539
might have an end user self-service

631
00:22:33,259 --> 00:22:37,159
catalog so this type of functionality is

632
00:22:35,539 --> 00:22:39,408
available in a lot of systems management

633
00:22:37,159 --> 00:22:41,269
tooling the basic idea is you have an

634
00:22:39,409 --> 00:22:43,250
end user portal where a user can opt

635
00:22:41,269 --> 00:22:45,230
into certain software that your company

636
00:22:43,250 --> 00:22:48,350
is centrally managing and then

637
00:22:45,230 --> 00:22:50,330
distributing now this doesn't stop a

638
00:22:48,350 --> 00:22:52,250
company from inadvertently introducing a

639
00:22:50,330 --> 00:22:55,009
compromised piece of software into the

640
00:22:52,250 --> 00:22:56,779
catalog but at least drives consistency

641
00:22:55,009 --> 00:22:58,399
and control across your organization and

642
00:22:56,779 --> 00:23:00,470
I would argue the security benefits of

643
00:22:58,399 --> 00:23:02,959
that consistency and the ability to

644
00:23:00,470 --> 00:23:05,360
respond quickly outweigh the risks of

645
00:23:02,960 --> 00:23:07,490
potentially having to assess what you

646
00:23:05,360 --> 00:23:09,139
bring into that catalog and so this is

647
00:23:07,490 --> 00:23:10,730
another good way to drive better control

648
00:23:09,139 --> 00:23:12,740
over what software is on end-user

649
00:23:10,730 --> 00:23:14,840
systems

650
00:23:12,740 --> 00:23:17,629
this is especially salient for browser

651
00:23:14,840 --> 00:23:19,519
extensions and if you're not using some

652
00:23:17,629 --> 00:23:21,799
things like enterprise G Google suite

653
00:23:19,519 --> 00:23:23,899
this is often a pain point can you get

654
00:23:21,799 --> 00:23:25,908
an inventory of every extension on every

655
00:23:23,899 --> 00:23:27,049
browser in your environment and more

656
00:23:25,909 --> 00:23:29,659
importantly can you actually start

657
00:23:27,049 --> 00:23:32,269
enforcing control over that both Google

658
00:23:29,659 --> 00:23:33,500
and Firefox provide GPO hooks now so if

659
00:23:32,269 --> 00:23:35,720
you're using group policy you can

660
00:23:33,500 --> 00:23:37,610
actually define white lists or black

661
00:23:35,720 --> 00:23:39,470
lists of allowed extensions and exercise

662
00:23:37,610 --> 00:23:40,939
more rigor here but what I typically

663
00:23:39,470 --> 00:23:42,950
find as most organizations are

664
00:23:40,940 --> 00:23:45,049
completely blind to the browser

665
00:23:42,950 --> 00:23:48,970
extensions that are installed let alone

666
00:23:45,049 --> 00:23:48,970
exercise and control over which get used

667
00:23:49,960 --> 00:23:54,169
one other thing I'll note Google is

668
00:23:52,070 --> 00:23:56,689
doing some really good work on extension

669
00:23:54,169 --> 00:23:58,309
security in the webstore after dealing

670
00:23:56,690 --> 00:23:59,450
with some of these breaches I think

671
00:23:58,309 --> 00:24:01,789
starting next year they're going to

672
00:23:59,450 --> 00:24:04,340
require two-factor authentication for

673
00:24:01,789 --> 00:24:06,139
example for developer developer accounts

674
00:24:04,340 --> 00:24:08,559
to stop things like account takeovers

675
00:24:06,139 --> 00:24:11,149
from occurring

676
00:24:08,559 --> 00:24:12,889
finally a caching post compromised

677
00:24:11,149 --> 00:24:14,719
activity if you're familiar with the

678
00:24:12,889 --> 00:24:17,269
attack matrix you know that the initial

679
00:24:14,720 --> 00:24:19,190
compromised phase is one of a very broad

680
00:24:17,269 --> 00:24:21,350
array of activities that attackers

681
00:24:19,190 --> 00:24:23,450
perform after they've reached an

682
00:24:21,350 --> 00:24:26,330
organization and so when you're popped

683
00:24:23,450 --> 00:24:28,490
by a supply chain attack it's not game

684
00:24:26,330 --> 00:24:29,330
over like you still have all of the

685
00:24:28,490 --> 00:24:31,160
opportunities to

686
00:24:29,330 --> 00:24:33,020
detect and stop an attacker as they move

687
00:24:31,160 --> 00:24:34,760
through out the attack lifecycle they're

688
00:24:33,020 --> 00:24:37,340
gonna have to drop second-stage malware

689
00:24:34,760 --> 00:24:39,650
establish persistence steal credentials

690
00:24:37,340 --> 00:24:41,570
and so on and so all of these are

691
00:24:39,650 --> 00:24:43,580
opportunities to detect them contain and

692
00:24:41,570 --> 00:24:46,879
respond that remain relevant in a supply

693
00:24:43,580 --> 00:24:48,560
chain attack and with that in mind you

694
00:24:46,880 --> 00:24:50,690
can actually use this information and

695
00:24:48,560 --> 00:24:52,460
what I've discovered here to incorporate

696
00:24:50,690 --> 00:24:55,310
supply chain attacks into your tabletop

697
00:24:52,460 --> 00:24:57,680
exercises and see how your organization

698
00:24:55,310 --> 00:24:59,360
would respond the tabletop scenarios

699
00:24:57,680 --> 00:25:01,160
Twitter account bad things daily has

700
00:24:59,360 --> 00:25:03,050
actually tweeted a few good examples of

701
00:25:01,160 --> 00:25:04,850
this malicious code distributed to your

702
00:25:03,050 --> 00:25:07,250
endpoints during routine update of a

703
00:25:04,850 --> 00:25:09,260
signed application or as we just

704
00:25:07,250 --> 00:25:11,360
discussed a Chrome extension is sold to

705
00:25:09,260 --> 00:25:13,580
a malicious developer and a bad update

706
00:25:11,360 --> 00:25:15,320
is introduced really interesting things

707
00:25:13,580 --> 00:25:17,030
to work through in a tabletop scenario

708
00:25:15,320 --> 00:25:22,280
next time you're assessing your

709
00:25:17,030 --> 00:25:24,770
organization's security alright as if

710
00:25:22,280 --> 00:25:27,379
the president wasn't terrifying enough I

711
00:25:24,770 --> 00:25:28,760
also wanted to close out by thinking a

712
00:25:27,380 --> 00:25:30,770
little bit about what the future of

713
00:25:28,760 --> 00:25:33,260
these attacks might look like and an

714
00:25:30,770 --> 00:25:35,840
interesting area that I kind of narrowed

715
00:25:33,260 --> 00:25:37,610
down on was on data providers what got

716
00:25:35,840 --> 00:25:40,250
me thinking about this is the explosion

717
00:25:37,610 --> 00:25:42,409
of investment in machine learning driven

718
00:25:40,250 --> 00:25:45,080
startups across all industries certainly

719
00:25:42,410 --> 00:25:47,690
security as you've all seen and one of

720
00:25:45,080 --> 00:25:49,580
the challenging things with any security

721
00:25:47,690 --> 00:25:51,440
startup and especially one that's trying

722
00:25:49,580 --> 00:25:53,330
to incorporate data science is getting

723
00:25:51,440 --> 00:25:55,400
access to your data to train your models

724
00:25:53,330 --> 00:25:57,169
if your Microsoft do you have telemetry

725
00:25:55,400 --> 00:25:58,760
from a billion Windows computers you

726
00:25:57,170 --> 00:26:00,890
have all the data you could want if

727
00:25:58,760 --> 00:26:03,080
you're a startup you don't have an agent

728
00:26:00,890 --> 00:26:04,460
running on every computer out there in

729
00:26:03,080 --> 00:26:06,100
the wild so you have to gather your data

730
00:26:04,460 --> 00:26:09,020
from open source intelligence

731
00:26:06,100 --> 00:26:10,730
repositories like virustotal and that

732
00:26:09,020 --> 00:26:13,190
means you're basically using external

733
00:26:10,730 --> 00:26:14,600
datasets to kind of drive the the models

734
00:26:13,190 --> 00:26:16,940
that you build and how you train them

735
00:26:14,600 --> 00:26:18,530
and so what this leads me to is worrying

736
00:26:16,940 --> 00:26:20,570
about how all of the startups that are

737
00:26:18,530 --> 00:26:24,440
relying on open source models and open

738
00:26:20,570 --> 00:26:26,419
source data how safe those datasets are

739
00:26:24,440 --> 00:26:28,580
and whether they can be poisoned

740
00:26:26,420 --> 00:26:31,790
yesterday blackhat Arsenal had a great

741
00:26:28,580 --> 00:26:34,129
talk from Maria oh gosh I'm blanking on

742
00:26:31,790 --> 00:26:36,649
her name now she's with IBM and she did

743
00:26:34,130 --> 00:26:38,600
a whole talk on adversarial attacks and

744
00:26:36,650 --> 00:26:40,810
IBM's published a toolkit around this

745
00:26:38,600 --> 00:26:42,629
there have been a few really interesting

746
00:26:40,810 --> 00:26:44,490
presentations and

747
00:26:42,630 --> 00:26:46,950
white papers on this in recent years and

748
00:26:44,490 --> 00:26:50,280
one that I've cited here from this past

749
00:26:46,950 --> 00:26:52,710
year talks about attacks we're taking

750
00:26:50,280 --> 00:26:54,389
publicly available datasets that are

751
00:26:52,710 --> 00:26:56,610
often used to train machine learning

752
00:26:54,390 --> 00:26:59,070
models and then modifying a single pixel

753
00:26:56,610 --> 00:27:01,620
in those images can be used to basically

754
00:26:59,070 --> 00:27:03,629
corrupt the training procedure and miss

755
00:27:01,620 --> 00:27:05,939
cause miss classification of images so

756
00:27:03,630 --> 00:27:07,830
as the example shows here you take a

757
00:27:05,940 --> 00:27:09,750
single pixel change and all of a sudden

758
00:27:07,830 --> 00:27:11,669
you can break the model in a way that a

759
00:27:09,750 --> 00:27:13,470
frog gets identified as a plane and a

760
00:27:11,670 --> 00:27:15,540
plane gets identified as not a plane

761
00:27:13,470 --> 00:27:17,160
take this concept and think about it

762
00:27:15,540 --> 00:27:18,960
with the publicly available data people

763
00:27:17,160 --> 00:27:21,480
might use to Train ml models used to

764
00:27:18,960 --> 00:27:23,220
classify is this malicious versus is

765
00:27:21,480 --> 00:27:26,480
this legitimate and you can start to

766
00:27:23,220 --> 00:27:29,190
think about what I'm worried about here

767
00:27:26,480 --> 00:27:31,530
all right so to wrap things up and put

768
00:27:29,190 --> 00:27:35,610
things in perspective dr. Eve Ian levy

769
00:27:31,530 --> 00:27:37,230
at the NCSC was talking about supply

770
00:27:35,610 --> 00:27:40,050
chain in the context of responding to

771
00:27:37,230 --> 00:27:42,360
Kaspersky and talked about how most of

772
00:27:40,050 --> 00:27:43,830
the incidents that have caused actual

773
00:27:42,360 --> 00:27:45,330
harm to businesses and organizations

774
00:27:43,830 --> 00:27:46,379
here in the UK have not been caused by

775
00:27:45,330 --> 00:27:48,240
supply chain attacks

776
00:27:46,380 --> 00:27:49,860
they've been caused by the basic hygiene

777
00:27:48,240 --> 00:27:51,900
factors of not keeping your software

778
00:27:49,860 --> 00:27:53,990
up-to-date poor configuration management

779
00:27:51,900 --> 00:27:55,890
poor credential management so as

780
00:27:53,990 --> 00:27:57,810
compelling and terrifying as these

781
00:27:55,890 --> 00:27:59,250
attacks are don't panic really there are

782
00:27:57,810 --> 00:28:01,679
more fundamental things that you should

783
00:27:59,250 --> 00:28:04,260
still focus on but what I think is

784
00:28:01,680 --> 00:28:05,760
important is that software supply chain

785
00:28:04,260 --> 00:28:07,560
attacks are just another means of

786
00:28:05,760 --> 00:28:09,990
initial compromise in the end the same

787
00:28:07,560 --> 00:28:11,639
foundational principles for attack

788
00:28:09,990 --> 00:28:14,600
surface reduction for detection

789
00:28:11,640 --> 00:28:17,400
containment and response all still apply

790
00:28:14,600 --> 00:28:18,840
the second point I made is that you

791
00:28:17,400 --> 00:28:21,120
should really focus on ensuring you have

792
00:28:18,840 --> 00:28:24,419
a complete timely and accurate record of

793
00:28:21,120 --> 00:28:26,610
all software that is either at rest or

794
00:28:24,420 --> 00:28:28,950
has executed on all of your computing

795
00:28:26,610 --> 00:28:30,570
devices and once you have that and have

796
00:28:28,950 --> 00:28:32,640
confidence that you can maintain and

797
00:28:30,570 --> 00:28:33,750
monitor and search and analyze that then

798
00:28:32,640 --> 00:28:35,550
you can drive towards stronger

799
00:28:33,750 --> 00:28:38,430
governance over what's actually deployed

800
00:28:35,550 --> 00:28:39,899
and installed on your endpoints and then

801
00:28:38,430 --> 00:28:41,370
finally if you're working with

802
00:28:39,900 --> 00:28:43,290
enterprise software vendors challenge

803
00:28:41,370 --> 00:28:45,360
them ensure that they're attesting to

804
00:28:43,290 --> 00:28:48,210
the investment that an attention that

805
00:28:45,360 --> 00:28:50,159
they're applying towards supply chain

806
00:28:48,210 --> 00:28:53,160
risk because as I said before we all

807
00:28:50,160 --> 00:28:55,050
trust a lot of software and the solution

808
00:28:53,160 --> 00:28:56,429
space of vendors that we choose to work

809
00:28:55,050 --> 00:28:58,320
with and do business with

810
00:28:56,429 --> 00:28:59,639
is a good starting point for ensuring

811
00:28:58,320 --> 00:29:00,658
that we're trusting the right companies

812
00:28:59,639 --> 00:29:04,649
that are applying the right due

813
00:29:00,659 --> 00:29:06,119
diligence to this problem uh thanks for

814
00:29:04,649 --> 00:29:07,830
your time if you have any questions feel

815
00:29:06,119 --> 00:29:09,600
free to reach out to me I will also have

816
00:29:07,830 --> 00:29:12,480
a copy of these slides on the blackhat

817
00:29:09,600 --> 00:29:13,830
site and on my speaker deck site but we

818
00:29:12,480 --> 00:29:17,210
have a couple of minutes so are there

819
00:29:13,830 --> 00:29:17,210
any questions that I can answer all

820
00:29:21,619 --> 00:29:25,769
right well if you'd like to reach grab

821
00:29:24,240 --> 00:29:27,629
me one-on-one I'll be lingering around

822
00:29:25,769 --> 00:29:30,649
after the talk but thank you all and

823
00:29:27,629 --> 00:29:30,649
have a great rest of your conference

