1
00:00:00,030 --> 00:00:03,360
well good afternoon and thank you for

2
00:00:01,319 --> 00:00:04,680
joining us for our talk and thanks the

3
00:00:03,360 --> 00:00:06,810
black hat for asking us to be here in

4
00:00:04,680 --> 00:00:07,949
the first place we like to spend a

5
00:00:06,810 --> 00:00:09,090
little bit of time sharing with you some

6
00:00:07,950 --> 00:00:10,710
of the work we've been doing creating

7
00:00:09,090 --> 00:00:14,190
synthetic persons for cyberspace

8
00:00:10,710 --> 00:00:16,049
operations a disclaimer this is more of

9
00:00:14,190 --> 00:00:19,080
an improv verse review than it is a

10
00:00:16,049 --> 00:00:22,170
product release so our intent is to show

11
00:00:19,080 --> 00:00:25,049
you our work warts and all and maybe

12
00:00:22,170 --> 00:00:26,699
start a conversation so so please be you

13
00:00:25,050 --> 00:00:27,900
know ask prodding questions we love

14
00:00:26,699 --> 00:00:30,090
those

15
00:00:27,900 --> 00:00:32,040
after all we're sort of take the company

16
00:00:30,090 --> 00:00:34,200
at which we work is in the business of

17
00:00:32,040 --> 00:00:36,570
research and development with emphasis

18
00:00:34,200 --> 00:00:38,910
on research so we all know how that pans

19
00:00:36,570 --> 00:00:41,670
out my role in the company is I'm a lead

20
00:00:38,910 --> 00:00:44,849
scientist I'm Fernando my me and Alex is

21
00:00:41,670 --> 00:00:46,860
one of our top engineers I'm Alex

22
00:00:44,850 --> 00:00:49,530
Nichols I'm the technical director for

23
00:00:46,860 --> 00:00:50,969
cyberspace operations in Star Trek I've

24
00:00:49,530 --> 00:00:52,739
another company about six and a half

25
00:00:50,969 --> 00:00:55,770
years or so I have a bachelor's degree

26
00:00:52,739 --> 00:00:57,149
in computer science and I've been with

27
00:00:55,770 --> 00:00:59,670
the company for a couple years before

28
00:00:57,149 --> 00:01:01,530
that I was in the Army for 25 years in

29
00:00:59,670 --> 00:01:04,260
the US Army doing cyberspace operations

30
00:01:01,530 --> 00:01:05,580
for a good chunk of that and then

31
00:01:04,260 --> 00:01:07,770
afterwards I stayed around for two years

32
00:01:05,580 --> 00:01:09,539
as civilian to stand up the Army's new

33
00:01:07,770 --> 00:01:11,070
think tank on cyber space issues and

34
00:01:09,540 --> 00:01:12,689
then decided there was enough to think

35
00:01:11,070 --> 00:01:15,179
about big things and it was time to

36
00:01:12,689 --> 00:01:17,639
start building some stuff so I joined i

37
00:01:15,180 --> 00:01:20,520
doing sore tech well today what we'd

38
00:01:17,640 --> 00:01:22,530
like to do with you is first start off

39
00:01:20,520 --> 00:01:24,899
with a really brief introduction to

40
00:01:22,530 --> 00:01:26,400
artificial intelligence just to get our

41
00:01:24,900 --> 00:01:28,080
terminology correct because there's a

42
00:01:26,400 --> 00:01:29,369
whole bunch of hype around it and I want

43
00:01:28,080 --> 00:01:30,990
to make sure we set the basis on that

44
00:01:29,369 --> 00:01:32,009
and then afterwards we're gonna talk

45
00:01:30,990 --> 00:01:34,350
about some threats that we have

46
00:01:32,009 --> 00:01:36,689
identified in and around the space of a

47
00:01:34,350 --> 00:01:38,880
in and around the intersection of AI and

48
00:01:36,689 --> 00:01:40,079
cyberspace and then then we're gonna get

49
00:01:38,880 --> 00:01:42,060
into the good stuff which is the three

50
00:01:40,079 --> 00:01:43,350
agents that we have built and then

51
00:01:42,060 --> 00:01:44,570
hopefully start a conversation about

52
00:01:43,350 --> 00:01:48,270
what what lies ahead

53
00:01:44,570 --> 00:01:49,949
so with that you ask 10 different people

54
00:01:48,270 --> 00:01:51,000
what artificial intelligence is and

55
00:01:49,950 --> 00:01:52,350
you're likely to get 10 different

56
00:01:51,000 --> 00:01:56,189
answers

57
00:01:52,350 --> 00:01:58,079
so basically firstly don't get angry at

58
00:01:56,189 --> 00:02:00,508
me if your favorite flavor of artificial

59
00:01:58,079 --> 00:02:02,339
intelligence isn't here don't throw

60
00:02:00,509 --> 00:02:03,600
rocks at me or anything it's just that

61
00:02:02,340 --> 00:02:05,579
you know you can only go so far before

62
00:02:03,600 --> 00:02:07,380
the font gets tiny and nobody can read

63
00:02:05,579 --> 00:02:09,090
it anyway but what I want you to get out

64
00:02:07,380 --> 00:02:11,038
of the slide is that there's really two

65
00:02:09,090 --> 00:02:12,480
basic branches or two main branches to

66
00:02:11,038 --> 00:02:13,708
the artificial intelligence field which

67
00:02:12,480 --> 00:02:15,298
is huge

68
00:02:13,709 --> 00:02:18,060
on the right hand side we have the

69
00:02:15,299 --> 00:02:19,709
symbolic approaches which are the if you

70
00:02:18,060 --> 00:02:21,540
think back to the 1980s and expert

71
00:02:19,709 --> 00:02:23,459
systems and that's what they were and of

72
00:02:21,540 --> 00:02:26,670
what they've grown up to be and that

73
00:02:23,459 --> 00:02:28,290
includes some cognitive architectures

74
00:02:26,670 --> 00:02:30,059
which are shown in here I'm highlighting

75
00:02:28,290 --> 00:02:31,650
soar because that's the one we happen to

76
00:02:30,060 --> 00:02:33,840
build our agents on but there's another

77
00:02:31,650 --> 00:02:35,609
famous one which is Akhtar Akhtar is

78
00:02:33,840 --> 00:02:37,769
promoted by this Carnegie Mellon

79
00:02:35,609 --> 00:02:39,269
University and soar is out of the

80
00:02:37,769 --> 00:02:41,069
University of Michigan both are

81
00:02:39,269 --> 00:02:44,670
open-source cognitive architectures

82
00:02:41,069 --> 00:02:47,129
these systems think in terms that humans

83
00:02:44,670 --> 00:02:48,958
can relate to using constructs or humans

84
00:02:47,129 --> 00:02:51,209
can relate to you on the left-hand side

85
00:02:48,959 --> 00:02:53,220
of the tree of the family tree are the

86
00:02:51,209 --> 00:02:54,629
non symbolic approaches which is what

87
00:02:53,220 --> 00:02:57,180
it's all the rave in the news right

88
00:02:54,629 --> 00:02:59,879
that's where neural networks are where

89
00:02:57,180 --> 00:03:01,319
hidden Markov models are L STM's we've

90
00:02:59,879 --> 00:03:04,260
heard other talks using some of these

91
00:03:01,319 --> 00:03:06,839
technologies so the left-hand side is is

92
00:03:04,260 --> 00:03:09,810
really good at finding I do three things

93
00:03:06,840 --> 00:03:11,939
really it's a classification clustering

94
00:03:09,810 --> 00:03:13,859
and predictive analytics that's that's

95
00:03:11,939 --> 00:03:15,689
if you can if you can distill the

96
00:03:13,859 --> 00:03:17,849
problem to those essence it goes on the

97
00:03:15,689 --> 00:03:19,410
left side if it's more complicated and

98
00:03:17,849 --> 00:03:21,750
it requires some knowledge engineering

99
00:03:19,410 --> 00:03:24,019
it typically falls on the right side so

100
00:03:21,750 --> 00:03:26,280
what does the left side look like

101
00:03:24,019 --> 00:03:27,660
essentially every non symbolic approach

102
00:03:26,280 --> 00:03:30,000
looks something like this

103
00:03:27,660 --> 00:03:31,769
and you can omit some pieces what I want

104
00:03:30,000 --> 00:03:33,599
to key in here is that the hard part

105
00:03:31,769 --> 00:03:35,940
about building non symbolic or machine

106
00:03:33,599 --> 00:03:37,500
learning systems isn't identifying what

107
00:03:35,940 --> 00:03:39,389
the what the features are that you're

108
00:03:37,500 --> 00:03:41,010
going to go after and some people just

109
00:03:39,389 --> 00:03:42,569
throw everything in there but it's

110
00:03:41,010 --> 00:03:44,909
better to be deliberate about it and

111
00:03:42,569 --> 00:03:46,560
then choose your algorithm correctly and

112
00:03:44,909 --> 00:03:48,989
thankfully we have things like cars and

113
00:03:46,560 --> 00:03:51,959
other platforms that allow us that or

114
00:03:48,989 --> 00:03:54,659
people have built these libraries of ALS

115
00:03:51,959 --> 00:03:56,579
TMS and other algorithms so that job the

116
00:03:54,659 --> 00:04:00,030
developer's job is a lot easier and in

117
00:03:56,579 --> 00:04:01,650
this case uh the bane of non symbolic

118
00:04:00,030 --> 00:04:03,989
learning is or not symbolic machine

119
00:04:01,650 --> 00:04:06,060
learning is that you need large sets of

120
00:04:03,989 --> 00:04:08,159
data to train the system and say yay or

121
00:04:06,060 --> 00:04:10,169
nay and we can play with that number but

122
00:04:08,159 --> 00:04:11,548
sometimes it's it's it's in a thousand

123
00:04:10,169 --> 00:04:14,069
sometimes in the millions of samples

124
00:04:11,549 --> 00:04:15,449
before we get some good results on the

125
00:04:14,069 --> 00:04:17,010
other side of the family we have

126
00:04:15,449 --> 00:04:19,849
symbolic approaches what I'm showing

127
00:04:17,010 --> 00:04:23,400
here in this as Alex calls it garish

128
00:04:19,849 --> 00:04:25,770
chart is my attempt at visualizing what

129
00:04:23,400 --> 00:04:26,929
soar looks like on the inside the magic

130
00:04:25,770 --> 00:04:29,000
happens in the middle that

131
00:04:26,930 --> 00:04:30,590
working memory representation and that's

132
00:04:29,000 --> 00:04:32,389
a part of the agent that thinks kind of

133
00:04:30,590 --> 00:04:34,849
like our executive you know processes in

134
00:04:32,389 --> 00:04:36,680
the brain do there are three pieces of

135
00:04:34,850 --> 00:04:39,169
important memory that we're gonna touch

136
00:04:36,680 --> 00:04:41,660
on later on the far left is procedural

137
00:04:39,169 --> 00:04:43,940
memory think of this as how to do things

138
00:04:41,660 --> 00:04:46,100
how to put together a peanut butter and

139
00:04:43,940 --> 00:04:47,960
jelly sandwich out - how to scan and

140
00:04:46,100 --> 00:04:49,669
network whatever that looks like then we

141
00:04:47,960 --> 00:04:51,169
have semantic memory which identifies

142
00:04:49,669 --> 00:04:52,430
how things are related to each other in

143
00:04:51,169 --> 00:04:54,919
the real world - think of it as an

144
00:04:52,430 --> 00:04:57,440
ontology or declarative knowledge and

145
00:04:54,919 --> 00:05:00,169
then episodic memory is where the agent

146
00:04:57,440 --> 00:05:01,940
as it experiences the world remembers

147
00:05:00,169 --> 00:05:03,620
how we dealt with the specific problems

148
00:05:01,940 --> 00:05:05,330
and actually learns from those

149
00:05:03,620 --> 00:05:07,820
experiences and improves its performance

150
00:05:05,330 --> 00:05:09,889
over time and then at the bottom you

151
00:05:07,820 --> 00:05:12,320
have output links so you can send

152
00:05:09,889 --> 00:05:14,210
commands out to a motor or whatever if

153
00:05:12,320 --> 00:05:16,039
it's a robot or some tool in the cyber

154
00:05:14,210 --> 00:05:18,409
world and then it has on the far left

155
00:05:16,039 --> 00:05:21,020
some input links where it takes feedback

156
00:05:18,410 --> 00:05:23,389
from the from the space so way different

157
00:05:21,020 --> 00:05:25,490
then non-symbolic approaches and this is

158
00:05:23,389 --> 00:05:27,889
what we base a lot of our work at the

159
00:05:25,490 --> 00:05:29,539
way we show share with you today on well

160
00:05:27,889 --> 00:05:30,800
before we do that let's talk briefly

161
00:05:29,539 --> 00:05:32,419
about some of the threats that we

162
00:05:30,800 --> 00:05:34,909
discovered that we're concerned about

163
00:05:32,419 --> 00:05:36,560
we're tracking two years ago I was

164
00:05:34,909 --> 00:05:38,990
fortunate enough to be part of a task

165
00:05:36,560 --> 00:05:41,270
force that the army stood up to to

166
00:05:38,990 --> 00:05:42,770
identify what the battlefield of 2050

167
00:05:41,270 --> 00:05:44,389
was going to look like and these are

168
00:05:42,770 --> 00:05:45,799
some of the take the key takeaways we

169
00:05:44,389 --> 00:05:47,599
came out with the full report is

170
00:05:45,800 --> 00:05:50,330
available for free at the Army Research

171
00:05:47,599 --> 00:05:52,760
Lab website but these are the ones that

172
00:05:50,330 --> 00:05:54,650
stuck with me anyway and I want you to

173
00:05:52,760 --> 00:05:56,270
remember that that middle one almost

174
00:05:54,650 --> 00:05:58,609
middle one the fourth one down

175
00:05:56,270 --> 00:06:00,889
micro-targeting because that gets after

176
00:05:58,610 --> 00:06:03,080
very very deliberate very very targeted

177
00:06:00,889 --> 00:06:04,190
fear phishing attacks and this is

178
00:06:03,080 --> 00:06:07,190
something we're already seeing in the

179
00:06:04,190 --> 00:06:09,800
wild and also the last two items are

180
00:06:07,190 --> 00:06:12,219
really what get to the key motivation

181
00:06:09,800 --> 00:06:14,509
for the work that we have done is the

182
00:06:12,220 --> 00:06:17,770
realization that autonomy is gonna play

183
00:06:14,509 --> 00:06:20,240
a key role out in cyberspace and

184
00:06:17,770 --> 00:06:23,659
cognitive models of adversaries and and

185
00:06:20,240 --> 00:06:27,080
friendly forces to is very important so

186
00:06:23,659 --> 00:06:28,610
that is what the future looks like I

187
00:06:27,080 --> 00:06:30,020
want to bring it back to the real - to

188
00:06:28,610 --> 00:06:32,509
the here and now and there's a lot of

189
00:06:30,020 --> 00:06:34,880
hype about AI power cyberattacks the

190
00:06:32,509 --> 00:06:36,650
reality is a little more nuanced we

191
00:06:34,880 --> 00:06:38,810
haven't seen an awful lot of effective

192
00:06:36,650 --> 00:06:40,460
applications of it in the wild these are

193
00:06:38,810 --> 00:06:43,370
just some examples that I pulled up

194
00:06:40,460 --> 00:06:45,138
deep exploit is down I was down in the

195
00:06:43,370 --> 00:06:47,600
Arsenal earlier it was originally

196
00:06:45,139 --> 00:06:49,760
released I believe at blackhat us this

197
00:06:47,600 --> 00:06:52,639
past summer but he's down there today

198
00:06:49,760 --> 00:06:54,020
briefing and then snap are which

199
00:06:52,639 --> 00:06:56,270
unfortunately hasn't seen very many

200
00:06:54,020 --> 00:06:59,180
updates that can that can see at least

201
00:06:56,270 --> 00:07:01,490
on github in the last couple years is

202
00:06:59,180 --> 00:07:03,500
all about that micro targeting I talked

203
00:07:01,490 --> 00:07:06,229
about so the idea here is they're using

204
00:07:03,500 --> 00:07:09,260
machine learning to analyze users

205
00:07:06,229 --> 00:07:10,909
targets Twitter feed and then craft

206
00:07:09,260 --> 00:07:13,219
messages that I have a high likelihood

207
00:07:10,910 --> 00:07:15,080
of being of generating and click from

208
00:07:13,220 --> 00:07:18,800
that user and then hopefully an

209
00:07:15,080 --> 00:07:20,630
infection so it's it's all it's it's all

210
00:07:18,800 --> 00:07:22,010
early-stage but if you do the math and

211
00:07:20,630 --> 00:07:23,540
you extrapolate from the very first

212
00:07:22,010 --> 00:07:25,370
slide I showed in the previous slide to

213
00:07:23,540 --> 00:07:26,960
this one and you can see where with the

214
00:07:25,370 --> 00:07:28,970
via that the trends are pointing in a

215
00:07:26,960 --> 00:07:31,760
clearer direction but even if it's not

216
00:07:28,970 --> 00:07:32,810
adversarial AI is not perfect so there's

217
00:07:31,760 --> 00:07:34,669
a whole bunch of things we should be

218
00:07:32,810 --> 00:07:36,520
concerned about whenever we we think

219
00:07:34,669 --> 00:07:39,549
about AI in the context of cybersecurity

220
00:07:36,520 --> 00:07:42,260
on the far left is probably my favorite

221
00:07:39,550 --> 00:07:45,560
anybody get to play with the Microsoft I

222
00:07:42,260 --> 00:07:47,810
before they shut it down no it was up

223
00:07:45,560 --> 00:07:50,090
for sixteen glorious minutes in 2016

224
00:07:47,810 --> 00:07:52,039
before some very creative folks decided

225
00:07:50,090 --> 00:07:54,500
to teach it how to behave rudely online

226
00:07:52,039 --> 00:07:56,389
and Microsoft pulled the plug so what

227
00:07:54,500 --> 00:07:58,190
happened there was it was designed to

228
00:07:56,389 --> 00:08:00,440
learn by interacting with humans and

229
00:07:58,190 --> 00:08:03,800
those humans turned out to be well

230
00:08:00,440 --> 00:08:05,330
fiendish I guess so that's that's an

231
00:08:03,800 --> 00:08:08,090
example of what happens when in real AI

232
00:08:05,330 --> 00:08:09,859
systems interact with the real world in

233
00:08:08,090 --> 00:08:11,479
the middle we I think maybe some of you

234
00:08:09,860 --> 00:08:14,539
may have heard of the MIT experiments

235
00:08:11,479 --> 00:08:16,909
where they put pieces of duct tape on

236
00:08:14,539 --> 00:08:18,830
stop signs to fool the vision systems on

237
00:08:16,910 --> 00:08:21,320
vehicles so they wouldn't recognize as a

238
00:08:18,830 --> 00:08:24,979
stop sign and cause an accident right

239
00:08:21,320 --> 00:08:28,430
nefarious but hey the some folks at that

240
00:08:24,979 --> 00:08:30,500
university Japan came up with a way to

241
00:08:28,430 --> 00:08:32,630
do the same thing essentially with a one

242
00:08:30,500 --> 00:08:34,099
pixel modification on the image and you

243
00:08:32,630 --> 00:08:35,689
can see the different classification

244
00:08:34,099 --> 00:08:37,459
between what it was supposed to be

245
00:08:35,690 --> 00:08:38,719
recognized that or classified as and

246
00:08:37,458 --> 00:08:41,478
would actually get ended up getting

247
00:08:38,719 --> 00:08:42,919
classified as and in the far right even

248
00:08:41,479 --> 00:08:44,750
in the absence of these things there's

249
00:08:42,919 --> 00:08:46,130
bias that we all introduce into the

250
00:08:44,750 --> 00:08:47,870
systems we build and a lot of times

251
00:08:46,130 --> 00:08:50,510
don't even realize that we're doing that

252
00:08:47,870 --> 00:08:52,790
so here we have an example of Google

253
00:08:50,510 --> 00:08:54,209
getting in trouble on 2016 over

254
00:08:52,790 --> 00:08:55,649
something that just was referred

255
00:08:54,209 --> 00:08:58,248
representative of what people were

256
00:08:55,649 --> 00:09:00,749
googling for if somebody googled for

257
00:08:58,249 --> 00:09:02,819
black three black teens they got

258
00:09:00,749 --> 00:09:05,490
pictures of teenagers in you know in

259
00:09:02,819 --> 00:09:08,550
prison and white teens on the right side

260
00:09:05,490 --> 00:09:10,579
while enjoying life not delivered there

261
00:09:08,550 --> 00:09:14,399
was no malice behind it it was just a

262
00:09:10,579 --> 00:09:16,829
byproduct of biases in the data sets so

263
00:09:14,399 --> 00:09:19,740
with this environment let's get to the

264
00:09:16,829 --> 00:09:21,420
meat of it and how how cyber psyche

265
00:09:19,740 --> 00:09:24,360
starter cognitive agents or psychic

266
00:09:21,420 --> 00:09:26,670
agents might fit into this what we were

267
00:09:24,360 --> 00:09:29,399
looking for was agents that can act in

268
00:09:26,670 --> 00:09:32,339
the in in cyberspace and do complicated

269
00:09:29,399 --> 00:09:33,990
tasks not just very narrow applications

270
00:09:32,339 --> 00:09:37,139
that we see in machine learning a lot of

271
00:09:33,990 --> 00:09:39,899
times to us in order to be classified as

272
00:09:37,139 --> 00:09:41,369
an autonomous agent the the entity has

273
00:09:39,899 --> 00:09:43,230
to be able to do four things that's the

274
00:09:41,369 --> 00:09:44,819
sense the environment think about the

275
00:09:43,230 --> 00:09:46,649
environment and its goals and what it

276
00:09:44,819 --> 00:09:49,529
should do about it and then act on it

277
00:09:46,649 --> 00:09:52,079
and over time the fourth one is to learn

278
00:09:49,529 --> 00:09:53,399
about it we applied this in three

279
00:09:52,079 --> 00:09:55,979
different spaces for different

280
00:09:53,399 --> 00:09:58,619
applications and different customers the

281
00:09:55,980 --> 00:10:01,199
first one was a somebody came to us and

282
00:09:58,619 --> 00:10:03,569
asked us to build a an autonomous agent

283
00:10:01,199 --> 00:10:05,549
that could behave as a red team member

284
00:10:03,569 --> 00:10:08,040
or more accurately a penetration tester

285
00:10:05,549 --> 00:10:10,079
and we did that but we discovered along

286
00:10:08,040 --> 00:10:12,449
the way it was this is way better at

287
00:10:10,079 --> 00:10:14,399
adversarial emulation than it was at

288
00:10:12,449 --> 00:10:15,689
Penn testing for a bunch of reasons that

289
00:10:14,399 --> 00:10:17,040
I really don't have time to get into

290
00:10:15,689 --> 00:10:18,290
right now unless you ask questions

291
00:10:17,040 --> 00:10:21,179
afterwards

292
00:10:18,290 --> 00:10:22,769
but it was very good at that job then

293
00:10:21,179 --> 00:10:24,480
somebody that somebody else came out

294
00:10:22,769 --> 00:10:26,600
afterwards and and and asked us hey can

295
00:10:24,480 --> 00:10:29,189
you use a similar approach to building

296
00:10:26,600 --> 00:10:31,079
autonomous defenders and we said sure we

297
00:10:29,189 --> 00:10:32,849
can try it and along the way we

298
00:10:31,079 --> 00:10:34,138
discovered there's enough similarity to

299
00:10:32,850 --> 00:10:36,689
the two that we should start extracting

300
00:10:34,139 --> 00:10:37,860
some of the code base because as alex is

301
00:10:36,689 --> 00:10:43,019
gonna point out here shortly

302
00:10:37,860 --> 00:10:46,259
writing code is not fun by a longshot

303
00:10:43,019 --> 00:10:49,379
so we we developed this this this family

304
00:10:46,259 --> 00:10:51,209
tree and then when DARPA came to us last

305
00:10:49,379 --> 00:10:54,089
year and I said can you do something

306
00:10:51,209 --> 00:10:56,910
like that but model regular users so we

307
00:10:54,089 --> 00:10:59,160
can do human vulnerability assessment we

308
00:10:56,910 --> 00:11:00,449
said sure and that's where the third the

309
00:10:59,160 --> 00:11:01,980
child in the family came up with his

310
00:11:00,449 --> 00:11:04,229
psychology you

311
00:11:01,980 --> 00:11:06,149
my apologies ahead of time psychic be we

312
00:11:04,230 --> 00:11:07,330
can't talk an awful lot about because of

313
00:11:06,149 --> 00:11:09,130
contractual reasons

314
00:11:07,330 --> 00:11:12,399
but we are going to touch on it briefly

315
00:11:09,130 --> 00:11:14,500
here in a couple of slides with that

316
00:11:12,399 --> 00:11:17,459
let's dig into what I call gay looks

317
00:11:14,500 --> 00:11:19,839
like and again the idea was to do a

318
00:11:17,459 --> 00:11:21,339
penetration tester and then we kind of

319
00:11:19,839 --> 00:11:23,920
morphed that into being an adversary

320
00:11:21,339 --> 00:11:26,170
adversary emulation system which is

321
00:11:23,920 --> 00:11:28,060
really I think where it shines but at

322
00:11:26,170 --> 00:11:31,329
the heart of this was the notion of we

323
00:11:28,060 --> 00:11:32,739
had to teach the agent target tactics

324
00:11:31,329 --> 00:11:34,870
techniques and procedures that were

325
00:11:32,740 --> 00:11:37,420
realistic and representative of some

326
00:11:34,870 --> 00:11:39,040
adversary in the real world and that's

327
00:11:37,420 --> 00:11:40,449
quite honestly that's the first part I'm

328
00:11:39,040 --> 00:11:43,269
going to pull out because when you're

329
00:11:40,450 --> 00:11:44,470
dealing with symbolic artificial

330
00:11:43,269 --> 00:11:46,420
intelligence that means you have to do

331
00:11:44,470 --> 00:11:48,130
all the knowledge engineering by hand

332
00:11:46,420 --> 00:11:50,500
ahead of time which means somebody has

333
00:11:48,130 --> 00:11:51,760
to code all these behaviors in there not

334
00:11:50,500 --> 00:11:53,920
so much with machine learning but you

335
00:11:51,760 --> 00:11:55,720
can get this complexity this richness of

336
00:11:53,920 --> 00:11:58,209
behaviors using strictly machine

337
00:11:55,720 --> 00:11:59,980
learning so that was our first first

338
00:11:58,209 --> 00:12:01,599
stumbling block but before I get ahead

339
00:11:59,980 --> 00:12:03,250
of myself here let me hand it over to

340
00:12:01,600 --> 00:12:06,670
Alex and he can walk you through the

341
00:12:03,250 --> 00:12:10,269
architecture of the system all right so

342
00:12:06,670 --> 00:12:11,560
this is our psychic architecture most

343
00:12:10,269 --> 00:12:12,850
these components are gonna go into a lot

344
00:12:11,560 --> 00:12:15,099
of detail in a few minutes so I'm gonna

345
00:12:12,850 --> 00:12:17,020
skip over most of them the tank made

346
00:12:15,100 --> 00:12:18,970
from this slide are this works as a

347
00:12:17,020 --> 00:12:20,199
single VM so all the components you need

348
00:12:18,970 --> 00:12:21,940
to run this agent are in a single

349
00:12:20,200 --> 00:12:24,160
virtual machine that you can then drop

350
00:12:21,940 --> 00:12:27,070
into whatever environment it is you want

351
00:12:24,160 --> 00:12:29,649
to test so this big box is one

352
00:12:27,070 --> 00:12:32,260
self-contained VM full of all of your

353
00:12:29,649 --> 00:12:34,510
phone tools at the top you have an agent

354
00:12:32,260 --> 00:12:35,770
and an abstraction layer so it can

355
00:12:34,510 --> 00:12:37,930
interface with tools the tools

356
00:12:35,770 --> 00:12:40,390
themselves I'll get into in heavy detail

357
00:12:37,930 --> 00:12:41,529
in a minute on the bottom are other

358
00:12:40,390 --> 00:12:43,149
things living on the machine there's a

359
00:12:41,529 --> 00:12:44,620
c4 server this is our command and

360
00:12:43,149 --> 00:12:46,360
control server so we can do fun things

361
00:12:44,620 --> 00:12:48,610
like start and stop the agents and tell

362
00:12:46,360 --> 00:12:51,010
them to hey go work over here or don't

363
00:12:48,610 --> 00:12:52,180
touch that thing or hey just hold up for

364
00:12:51,010 --> 00:12:53,890
a minute things like that it's

365
00:12:52,180 --> 00:12:56,319
controlled right now over IRC actually

366
00:12:53,890 --> 00:12:58,390
so you can use a standard IRC chat

367
00:12:56,320 --> 00:13:01,600
client to give it instructions and tell

368
00:12:58,390 --> 00:13:03,910
it what to do you'll also see it down

369
00:13:01,600 --> 00:13:06,070
there a TTP models and an asset DB box

370
00:13:03,910 --> 00:13:08,410
we're getting the TDP models again later

371
00:13:06,070 --> 00:13:10,449
but that's the instructions that tell it

372
00:13:08,410 --> 00:13:12,219
how to act as different people in

373
00:13:10,449 --> 00:13:14,019
cyberspace and then the asset DB is in

374
00:13:12,220 --> 00:13:16,120
the corner is how we restore all of the

375
00:13:14,019 --> 00:13:18,130
stuff we need to know about cyberspace

376
00:13:16,120 --> 00:13:20,529
it turns out this is a hard problem if

377
00:13:18,130 --> 00:13:21,909
you want your agents people to act and

378
00:13:20,529 --> 00:13:23,289
waves with different assets in

379
00:13:21,909 --> 00:13:25,389
cyberspace you need to record it somehow

380
00:13:23,289 --> 00:13:27,968
and that can be challenging at times so

381
00:13:25,389 --> 00:13:29,769
for example if I discover a host out in

382
00:13:27,969 --> 00:13:32,229
cyberspace I need to record that that

383
00:13:29,769 --> 00:13:34,119
host exists there is a physical network

384
00:13:32,229 --> 00:13:35,649
adapter attached to it that physical

385
00:13:34,119 --> 00:13:37,539
adapter corresponds to a logical adapter

386
00:13:35,649 --> 00:13:39,339
somewhere those that logical adapter has

387
00:13:37,539 --> 00:13:41,319
multiple forms of ways that can be

388
00:13:39,339 --> 00:13:43,839
addressed all of those things get stored

389
00:13:41,319 --> 00:13:47,259
in that asset database this is a

390
00:13:43,839 --> 00:13:49,539
screenshot of our attacker agent and

391
00:13:47,259 --> 00:13:53,859
don't hate us we are not user experience

392
00:13:49,539 --> 00:13:56,739
experts it's it only can be prettier at

393
00:13:53,859 --> 00:13:58,329
the top you have a task breakdown so

394
00:13:56,739 --> 00:14:00,399
this is a task tree it shows all of the

395
00:13:58,329 --> 00:14:03,368
different tasks and goals an agent is

396
00:14:00,399 --> 00:14:04,809
trying to break apart and use to move

397
00:14:03,369 --> 00:14:05,979
around in cyberspace we have a blown-up

398
00:14:04,809 --> 00:14:11,348
version of cinnamon I just ate lunch in

399
00:14:05,979 --> 00:14:13,029
the back squinting at it on the left you

400
00:14:11,349 --> 00:14:14,889
can see a little IRC

401
00:14:13,029 --> 00:14:16,089
built in and clients you can control it

402
00:14:14,889 --> 00:14:18,239
in the web interface at the bottom this

403
00:14:16,089 --> 00:14:20,859
piece is kind of cool it's a console

404
00:14:18,239 --> 00:14:23,079
it's an amalgamation of all of the

405
00:14:20,859 --> 00:14:24,549
different console windows that psychic

406
00:14:23,079 --> 00:14:26,858
is currently using so if it's running

407
00:14:24,549 --> 00:14:27,939
nmap and up hanging over here and sequel

408
00:14:26,859 --> 00:14:29,259
maps somewhere else all of those

409
00:14:27,939 --> 00:14:30,879
consoles get pushed together and you can

410
00:14:29,259 --> 00:14:32,259
actually see what the agent is typing

411
00:14:30,879 --> 00:14:36,099
and what the results of its commands are

412
00:14:32,259 --> 00:14:38,409
as it goes this is a similar screen shot

413
00:14:36,099 --> 00:14:40,329
of our defender agent most of it similar

414
00:14:38,409 --> 00:14:41,799
except this bottom panel change you can

415
00:14:40,329 --> 00:14:43,779
see there's these little tabs up here so

416
00:14:41,799 --> 00:14:46,089
we have different visualization widgets

417
00:14:43,779 --> 00:14:48,549
you can drop in this particular widget

418
00:14:46,089 --> 00:14:50,049
is a timeline it shows the different

419
00:14:48,549 --> 00:14:51,429
things that the agent has responded to

420
00:14:50,049 --> 00:14:53,289
and the different things that's done so

421
00:14:51,429 --> 00:14:55,959
something shows up on its alert feed

422
00:14:53,289 --> 00:14:57,220
response it Grox that and adds a

423
00:14:55,959 --> 00:14:59,589
firewall rule to deal with it and then

424
00:14:57,220 --> 00:15:01,119
to the right of that you have the alert

425
00:14:59,589 --> 00:15:03,099
feed your response so this is just an

426
00:15:01,119 --> 00:15:09,099
open source intelligence doctor

427
00:15:03,099 --> 00:15:11,889
intelligence feed all right so this is a

428
00:15:09,099 --> 00:15:13,059
breakdown of one of those tasks goal

429
00:15:11,889 --> 00:15:15,279
test trees I showed at the beginning

430
00:15:13,059 --> 00:15:19,449
this is the secret sauce of what makes

431
00:15:15,279 --> 00:15:20,889
our agents smart and what they are real

432
00:15:19,449 --> 00:15:22,899
quick so we can talk about this in the

433
00:15:20,889 --> 00:15:25,929
same terms I'm gonna shoot this is this

434
00:15:22,899 --> 00:15:27,909
lives at the bottom of a phishing attack

435
00:15:25,929 --> 00:15:30,669
so if I the agent decides that it wants

436
00:15:27,909 --> 00:15:32,480
to fish a adversary somehow it will

437
00:15:30,669 --> 00:15:34,639
propose the school that says

438
00:15:32,480 --> 00:15:36,050
use phishing injection method and then

439
00:15:34,639 --> 00:15:37,820
from there it starts to decompose it

440
00:15:36,050 --> 00:15:39,740
into different subtasks that needs to do

441
00:15:37,820 --> 00:15:42,199
to accomplish it so over here you see it

442
00:15:39,740 --> 00:15:43,579
selects it has to pick how it's going to

443
00:15:42,199 --> 00:15:45,560
deliver the mail where through the

444
00:15:43,579 --> 00:15:46,969
fishing it picks that it's going to use

445
00:15:45,560 --> 00:15:48,920
a web link as opposed to sending an

446
00:15:46,970 --> 00:15:51,050
attachment or something like that from

447
00:15:48,920 --> 00:15:52,639
there it assembles a payload puts a

448
00:15:51,050 --> 00:15:54,800
download at the end of where that link

449
00:15:52,639 --> 00:15:56,300
is gonna be and then it's a we have this

450
00:15:54,800 --> 00:15:57,620
stitch with content goal when you get to

451
00:15:56,300 --> 00:15:59,149
this goal what it's doing essentially is

452
00:15:57,620 --> 00:16:00,949
it's saying hey now we need to assemble

453
00:15:59,149 --> 00:16:03,980
an email so I need a from user

454
00:16:00,949 --> 00:16:05,149
I need a target user I need to build the

455
00:16:03,980 --> 00:16:07,370
body and the subject line of the email

456
00:16:05,149 --> 00:16:09,529
and then you see a little blue dot here

457
00:16:07,370 --> 00:16:12,199
in the corner that is the agent actually

458
00:16:09,529 --> 00:16:13,459
sending the email you'll notice all

459
00:16:12,199 --> 00:16:15,560
these are green this is because these

460
00:16:13,459 --> 00:16:16,760
goals have all succeeded if you look

461
00:16:15,560 --> 00:16:17,750
over here you can see some of the goals

462
00:16:16,760 --> 00:16:19,279
at yellow because they're in progress

463
00:16:17,750 --> 00:16:20,480
and occasionally also get red goals

464
00:16:19,279 --> 00:16:21,649
which we'll get into in a minute

465
00:16:20,480 --> 00:16:23,420
those are field goals and they're very

466
00:16:21,649 --> 00:16:29,420
important for the system to work as well

467
00:16:23,420 --> 00:16:32,209
as it does all right

468
00:16:29,420 --> 00:16:34,130
this is our breakdown this is the

469
00:16:32,209 --> 00:16:40,010
breakdown of our knowledge base so this

470
00:16:34,130 --> 00:16:43,970
is all of the different goals and goals

471
00:16:40,010 --> 00:16:45,589
that the agent can work towards you can

472
00:16:43,970 --> 00:16:47,180
think of this like a class definition

473
00:16:45,589 --> 00:16:49,490
much as you would think of this as a

474
00:16:47,180 --> 00:16:51,380
class instantiation it's worth noting

475
00:16:49,490 --> 00:16:53,240
that the overall knowledge base is a

476
00:16:51,380 --> 00:16:56,720
graph of goals that can be used to

477
00:16:53,240 --> 00:16:59,029
accomplish each other whereas this is a

478
00:16:56,720 --> 00:17:01,490
tree of goals that have been used to

479
00:16:59,029 --> 00:17:04,160
accomplish each other so even if I send

480
00:17:01,490 --> 00:17:05,390
100 phishing emails if I had them

481
00:17:04,160 --> 00:17:07,669
Texican 100 phishing though it's only

482
00:17:05,390 --> 00:17:11,030
gonna find a send email goal in here one

483
00:17:07,669 --> 00:17:12,890
time the beauty of this representation

484
00:17:11,030 --> 00:17:15,678
is what I'd like to call the critical

485
00:17:12,890 --> 00:17:19,689
mass effect so as we add more and more

486
00:17:15,679 --> 00:17:19,689
goals and activities to this hierarchy

487
00:17:20,260 --> 00:17:26,059
adding new ones gets easier and easier

488
00:17:22,250 --> 00:17:29,660
so for example if I want to add a goal

489
00:17:26,059 --> 00:17:31,580
in to allow myself to fish with email

490
00:17:29,660 --> 00:17:33,020
attachment instead of a web link I don't

491
00:17:31,580 --> 00:17:35,720
have to replace this whole structure all

492
00:17:33,020 --> 00:17:37,460
I need to do is add in a new goal that

493
00:17:35,720 --> 00:17:39,049
says hey fish with an email attachment

494
00:17:37,460 --> 00:17:40,820
and then I'll have to add something over

495
00:17:39,049 --> 00:17:42,799
here to actually assemble a payload that

496
00:17:40,820 --> 00:17:44,540
goes with an email but I don't have to

497
00:17:42,799 --> 00:17:45,200
reteach the agent how to send emails or

498
00:17:44,540 --> 00:17:47,210
how to build them

499
00:17:45,200 --> 00:17:49,700
the content should look like I just have

500
00:17:47,210 --> 00:17:51,139
to say hey here's one no let's walk out

501
00:17:49,700 --> 00:17:52,700
one piece of this and then it can choose

502
00:17:51,139 --> 00:17:55,580
to do that instead of choosing what it's

503
00:17:52,700 --> 00:17:59,090
chosen this example this is zoomed in on

504
00:17:55,580 --> 00:18:00,350
that goal model the guy who built this

505
00:17:59,090 --> 00:18:02,449
name is Randy Jones for those who you're

506
00:18:00,350 --> 00:18:04,010
curious why it says rage and lovely red

507
00:18:02,450 --> 00:18:08,450
flaming letters in the corner so it's

508
00:18:04,010 --> 00:18:11,899
Randy's goal editor this goes at the end

509
00:18:08,450 --> 00:18:13,000
of a sequel injection attack so this is

510
00:18:11,899 --> 00:18:16,489
saying hey I want to be sequel injection

511
00:18:13,000 --> 00:18:18,940
I need to find a host that I can do

512
00:18:16,490 --> 00:18:21,980
sequel injection on so it proposes this

513
00:18:18,940 --> 00:18:24,110
identified target host goal then it will

514
00:18:21,980 --> 00:18:25,429
propose this goal for identifying target

515
00:18:24,110 --> 00:18:27,889
hosts it will actually do some kind of

516
00:18:25,429 --> 00:18:30,409
scan on the network and find hosts that

517
00:18:27,889 --> 00:18:32,000
are running HTTP services from there it

518
00:18:30,409 --> 00:18:34,309
will crawl the HTTP services being

519
00:18:32,000 --> 00:18:36,110
hosted gathering up URLs and then it

520
00:18:34,309 --> 00:18:38,330
will take a look at those URLs looking

521
00:18:36,110 --> 00:18:41,000
for URLs that have parameters I could

522
00:18:38,330 --> 00:18:42,559
possibly be used for injection if all

523
00:18:41,000 --> 00:18:44,630
these goals work at the end it were

524
00:18:42,559 --> 00:18:47,330
agent record in its memory that hey I

525
00:18:44,630 --> 00:18:49,909
know of this host here's this URL that

526
00:18:47,330 --> 00:18:51,620
can be injected upon and I'm done and

527
00:18:49,909 --> 00:18:53,630
all these goals we marked as complete an

528
00:18:51,620 --> 00:18:55,309
agent can can move on with its overall

529
00:18:53,630 --> 00:18:56,570
process and this is also where things

530
00:18:55,309 --> 00:18:58,158
get a little dicey with the asset

531
00:18:56,570 --> 00:18:59,330
database because as its scanning the

532
00:18:58,159 --> 00:19:01,399
environment it's gonna pick up a whole

533
00:18:59,330 --> 00:19:03,139
bunch of things that are not relevant to

534
00:19:01,399 --> 00:19:04,729
this attack but it should remember those

535
00:19:03,139 --> 00:19:06,408
so there's there's an SMTP server

536
00:19:04,730 --> 00:19:08,500
somewhere out there listening we want to

537
00:19:06,409 --> 00:19:11,090
keep track of that in a database as well

538
00:19:08,500 --> 00:19:13,929
we can use it later if you want to do

539
00:19:11,090 --> 00:19:16,220
fishing in the spread the same operation

540
00:19:13,929 --> 00:19:18,230
Fernando mentioned earlier that soar is

541
00:19:16,220 --> 00:19:19,610
an interesting language to write for

542
00:19:18,230 --> 00:19:21,230
those of you are curious this is soar

543
00:19:19,610 --> 00:19:24,620
code this particular sir code is

544
00:19:21,230 --> 00:19:28,909
designed to deal with the results of

545
00:19:24,620 --> 00:19:31,129
scanning a network on the left you see a

546
00:19:28,909 --> 00:19:34,850
big XML chunk here this is one of the

547
00:19:31,130 --> 00:19:37,460
goals in that great big goal hierarchy

548
00:19:34,850 --> 00:19:40,399
diagram it's worth pointing out that our

549
00:19:37,460 --> 00:19:42,860
goals are data not code so adding new

550
00:19:40,399 --> 00:19:45,979
behaviors to the agent is a data process

551
00:19:42,860 --> 00:19:51,508
not a coding process for and we'll talk

552
00:19:45,980 --> 00:19:55,119
why that's important later yeah

553
00:19:51,509 --> 00:19:57,429
okay well let's let's talk about what

554
00:19:55,119 --> 00:19:59,738
makes our agents if effective at

555
00:19:57,429 --> 00:20:00,940
representing different kinds of users or

556
00:19:59,739 --> 00:20:02,649
different kinds of actors on the

557
00:20:00,940 --> 00:20:06,700
internet we have this concept of a

558
00:20:02,649 --> 00:20:08,439
persona file if you will or persona is

559
00:20:06,700 --> 00:20:09,759
the identity that the agent is going to

560
00:20:08,440 --> 00:20:12,969
assume and depending on the nature of

561
00:20:09,759 --> 00:20:15,279
the agent if it's an attack agent then

562
00:20:12,969 --> 00:20:17,469
it's this is where we store the TTP says

563
00:20:15,279 --> 00:20:19,869
that it knows about that it prefers it

564
00:20:17,469 --> 00:20:21,429
that every actor has a certain set of

565
00:20:19,869 --> 00:20:22,658
preferences whether it's on the

566
00:20:21,429 --> 00:20:24,759
defensive side are actually on the

567
00:20:22,659 --> 00:20:27,879
defensive side or on the defensive side

568
00:20:24,759 --> 00:20:30,429
as well and it it really shines when we

569
00:20:27,879 --> 00:20:31,779
trying to stimulate everyday users on a

570
00:20:30,429 --> 00:20:34,089
network because this is where I think I

571
00:20:31,779 --> 00:20:36,279
can model things like I have a

572
00:20:34,089 --> 00:20:39,399
particular interest in cute kittens or

573
00:20:36,279 --> 00:20:42,309
something and I have a I have a really

574
00:20:39,399 --> 00:20:44,228
positive interaction with Alex but alex

575
00:20:42,309 --> 00:20:45,428
has not that not so positive interaction

576
00:20:44,229 --> 00:20:47,429
with me he really doesn't like me all

577
00:20:45,429 --> 00:20:50,080
that much so that kind of nuanced

578
00:20:47,429 --> 00:20:51,879
interaction between actors on a network

579
00:20:50,080 --> 00:20:55,418
this is a this is where we're able to

580
00:20:51,879 --> 00:20:56,918
capture that information we discovered

581
00:20:55,419 --> 00:20:59,710
as we were trying to put this together

582
00:20:56,919 --> 00:21:02,200
that our concepts of cyberspace in terms

583
00:20:59,710 --> 00:21:04,179
of the persona layer are not all that

584
00:21:02,200 --> 00:21:06,820
sophisticated so we have to do a whole

585
00:21:04,179 --> 00:21:10,119
bunch of extra work to catch up so this

586
00:21:06,820 --> 00:21:11,678
is a partial ontology of how we see the

587
00:21:10,119 --> 00:21:14,049
interaction between entities at the

588
00:21:11,679 --> 00:21:16,629
persona layer of cyberspace we model

589
00:21:14,049 --> 00:21:18,489
this in three layers you know at the

590
00:21:16,629 --> 00:21:19,718
bottom is a physical layer a logical

591
00:21:18,489 --> 00:21:21,489
layer in between which is really well

592
00:21:19,719 --> 00:21:23,229
studied and then the persona layer which

593
00:21:21,489 --> 00:21:26,349
has a lot of open opportunities for

594
00:21:23,229 --> 00:21:29,499
research and then with that from that we

595
00:21:26,349 --> 00:21:34,210
then move into the agent itself so the

596
00:21:29,499 --> 00:21:36,759
persona file describes what the end what

597
00:21:34,210 --> 00:21:39,369
the agent is going to behave like we

598
00:21:36,759 --> 00:21:41,619
talked about implementing these agents

599
00:21:39,369 --> 00:21:43,238
in this or cognitive architecture which

600
00:21:41,619 --> 00:21:45,428
is what the attacker is an attacker and

601
00:21:43,239 --> 00:21:47,529
the defender are implemented in but

602
00:21:45,429 --> 00:21:49,119
there's a competing architecture akhtar

603
00:21:47,529 --> 00:21:51,070
I mentioned earlier from Carnegie Mellon

604
00:21:49,119 --> 00:21:53,019
University and this is what we used

605
00:21:51,070 --> 00:21:56,109
actually for the for for the site cog

606
00:21:53,019 --> 00:21:58,440
you agent and the reason for that is if

607
00:21:56,109 --> 00:22:01,779
you remember to my earlier statements

608
00:21:58,440 --> 00:22:03,190
the akhtar architecture is way better at

609
00:22:01,779 --> 00:22:05,200
simulating what goes on inside of a

610
00:22:03,190 --> 00:22:07,390
person's brain

611
00:22:05,200 --> 00:22:09,910
and whereas soar shines in terms of

612
00:22:07,390 --> 00:22:11,620
external behaviors so we we wanted to

613
00:22:09,910 --> 00:22:12,910
intentionally use Akhtar for two reasons

614
00:22:11,620 --> 00:22:14,678
one because we wanted to study human

615
00:22:12,910 --> 00:22:17,260
vulnerabilities the propensity is

616
00:22:14,679 --> 00:22:18,309
somebody to do something stupid and also

617
00:22:17,260 --> 00:22:20,320
because you wanted to show that the

618
00:22:18,309 --> 00:22:23,049
infrastructure for psycho you could plug

619
00:22:20,320 --> 00:22:24,460
in different flavors of agents which

620
00:22:23,049 --> 00:22:26,200
brings me to the last category with the

621
00:22:24,460 --> 00:22:28,210
Java and it's just a very very

622
00:22:26,200 --> 00:22:29,920
lightweight agent that we drop in there

623
00:22:28,210 --> 00:22:32,830
when we need to scale this thing and we

624
00:22:29,920 --> 00:22:34,179
are okay with approximate behavior

625
00:22:32,830 --> 00:22:37,360
somewhere in our network we don't have

626
00:22:34,179 --> 00:22:40,450
to have high fidelity models and by high

627
00:22:37,360 --> 00:22:42,939
fidelity I mean really high fidelity I

628
00:22:40,450 --> 00:22:44,559
know this is an eye chart but let me let

629
00:22:42,940 --> 00:22:46,840
me what I'm trying to show here is

630
00:22:44,559 --> 00:22:49,178
something that Akhtar is using calls

631
00:22:46,840 --> 00:22:52,290
called instance based learning and the

632
00:22:49,179 --> 00:22:55,540
idea is the agent learns by what by by

633
00:22:52,290 --> 00:22:57,580
upfront of uploading its past behaviors

634
00:22:55,540 --> 00:23:00,040
so in this case we with fed information

635
00:22:57,580 --> 00:23:02,439
from a from an email from an inbox at

636
00:23:00,040 --> 00:23:04,360
users inbox and also from a web proxy

637
00:23:02,440 --> 00:23:06,100
and what we were trying to do was map

638
00:23:04,360 --> 00:23:08,649
the user's behavior or likelihood to

639
00:23:06,100 --> 00:23:10,629
click on different links so the agent

640
00:23:08,650 --> 00:23:13,150
that we programmed learned that this

641
00:23:10,630 --> 00:23:16,179
particular actor called Alice in this

642
00:23:13,150 --> 00:23:17,710
case has a certain clicking behavior she

643
00:23:16,179 --> 00:23:19,750
she only clicks in certain certain

644
00:23:17,710 --> 00:23:21,610
emails under certain conditions and he

645
00:23:19,750 --> 00:23:24,040
didn't learn that by just watching the

646
00:23:21,610 --> 00:23:25,870
the the files that we fed it then

647
00:23:24,040 --> 00:23:28,720
afterwards through a process of blending

648
00:23:25,870 --> 00:23:30,580
we an attack an adversary it was a human

649
00:23:28,720 --> 00:23:32,770
in this instance was able to walk that

650
00:23:30,580 --> 00:23:34,270
actor back through and trick them into

651
00:23:32,770 --> 00:23:37,510
clicking on an email that they shouldn't

652
00:23:34,270 --> 00:23:39,580
have by retraining it much like a user

653
00:23:37,510 --> 00:23:41,350
could be duped through a in elaborate

654
00:23:39,580 --> 00:23:42,699
process of interaction with that person

655
00:23:41,350 --> 00:23:44,409
we can convince them that hey this is

656
00:23:42,700 --> 00:23:46,090
actually legit I'm not I'm not a robot

657
00:23:44,410 --> 00:23:48,100
somewhere out there which of course we

658
00:23:46,090 --> 00:23:50,889
are but once we get the actor to click

659
00:23:48,100 --> 00:23:52,209
then we need to switch back into the the

660
00:23:50,890 --> 00:23:54,340
technical guts and figure out how to

661
00:23:52,210 --> 00:23:58,720
make the click actually reflect on the

662
00:23:54,340 --> 00:24:01,240
real world on a cyber world ok so the

663
00:23:58,720 --> 00:24:03,610
bottom line here of this this little

664
00:24:01,240 --> 00:24:05,679
psychic stack is our abstraction layer I

665
00:24:03,610 --> 00:24:07,330
like to call this our hacker toolkit it

666
00:24:05,679 --> 00:24:09,160
contains a bunch of tooling we use to

667
00:24:07,330 --> 00:24:11,049
allow the agents to actually interactive

668
00:24:09,160 --> 00:24:13,210
cyberspace so it's got some offensive

669
00:24:11,049 --> 00:24:14,559
tools in it like end map a PD and sequel

670
00:24:13,210 --> 00:24:17,290
map and stuff of the store it's got some

671
00:24:14,559 --> 00:24:19,060
defensive tools like IP table and snort

672
00:24:17,290 --> 00:24:21,399
and then in order to facilitate our

673
00:24:19,060 --> 00:24:23,500
users we also have email reading and web

674
00:24:21,400 --> 00:24:26,650
browsing and there's a handful of other

675
00:24:23,500 --> 00:24:29,110
things in it as well the key

676
00:24:26,650 --> 00:24:30,940
breakthrough we've figured out to make

677
00:24:29,110 --> 00:24:32,229
this work better it was rather than

678
00:24:30,940 --> 00:24:33,820
teach all of our agents how to use

679
00:24:32,230 --> 00:24:36,580
things like I'm use on map and example

680
00:24:33,820 --> 00:24:39,310
here because it has an obscene number of

681
00:24:36,580 --> 00:24:41,080
parameters rather than teach the agent

682
00:24:39,310 --> 00:24:42,310
how to map out all the N map parameters

683
00:24:41,080 --> 00:24:44,080
and things that it needs to know to run

684
00:24:42,310 --> 00:24:46,000
those commands we taught the agent the

685
00:24:44,080 --> 00:24:47,560
concept of an activity stay in the

686
00:24:46,000 --> 00:24:49,150
network so if the agent needs to learn

687
00:24:47,560 --> 00:24:51,220
something about a network it proposes

688
00:24:49,150 --> 00:24:52,540
this scan network activity and we'll

689
00:24:51,220 --> 00:24:53,680
prama ties it in some ways they'll say

690
00:24:52,540 --> 00:24:56,080
things like hey I need to scan to

691
00:24:53,680 --> 00:24:58,960
complete quickly and I want X Y & Z

692
00:24:56,080 --> 00:25:00,909
side-effects to go with it it will then

693
00:24:58,960 --> 00:25:02,320
send this scan network activity to our

694
00:25:00,910 --> 00:25:04,270
objection service and this little big

695
00:25:02,320 --> 00:25:08,500
big long box in the middle the tool

696
00:25:04,270 --> 00:25:11,260
implementation translator and coda yeah

697
00:25:08,500 --> 00:25:13,210
we'll find a tool in this case and map

698
00:25:11,260 --> 00:25:16,720
capable of making that activity happen

699
00:25:13,210 --> 00:25:18,790
so then then this service will assemble

700
00:25:16,720 --> 00:25:19,990
the nen map command with all of the

701
00:25:18,790 --> 00:25:22,030
correct parameters that line up with

702
00:25:19,990 --> 00:25:23,410
ICTA things to complete the activity run

703
00:25:22,030 --> 00:25:25,600
the command take the output of it

704
00:25:23,410 --> 00:25:27,100
translate it into such a format that it

705
00:25:25,600 --> 00:25:28,330
matches what was originally requested in

706
00:25:27,100 --> 00:25:35,080
activity and hand it back off to the

707
00:25:28,330 --> 00:25:38,470
agent oh yeah and the other interesting

708
00:25:35,080 --> 00:25:40,120
part about this is the activities and

709
00:25:38,470 --> 00:25:41,650
the tools don't map one-to-one so you

710
00:25:40,120 --> 00:25:43,300
might have multiple tools that can focus

711
00:25:41,650 --> 00:25:44,950
on activities so for scanning a network

712
00:25:43,300 --> 00:25:46,750
there's there's many more than one ways

713
00:25:44,950 --> 00:25:49,840
to skin a network so we can put multiple

714
00:25:46,750 --> 00:25:54,160
tools out there and this it goes the

715
00:25:49,840 --> 00:25:57,189
other way as well I can have multiple

716
00:25:54,160 --> 00:25:58,780
non non related activities that are

717
00:25:57,190 --> 00:26:01,480
fulfilled by the same tool for example

718
00:25:58,780 --> 00:26:03,190
this is a horizontal type for scan

719
00:26:01,480 --> 00:26:04,660
horizontal type networks can if I want a

720
00:26:03,190 --> 00:26:07,210
vertical port scan I could use the same

721
00:26:04,660 --> 00:26:09,340
same tool for different activities it

722
00:26:07,210 --> 00:26:12,790
makes it much easier to implement

723
00:26:09,340 --> 00:26:14,740
tooling and it also is worth pointing

724
00:26:12,790 --> 00:26:16,570
out that the tools we talk about here

725
00:26:14,740 --> 00:26:18,540
are not custom tools we've written for

726
00:26:16,570 --> 00:26:21,129
agent they're standard off-the-shelf

727
00:26:18,540 --> 00:26:23,170
cybersecurity projects products

728
00:26:21,130 --> 00:26:27,520
developed by other people in this case

729
00:26:23,170 --> 00:26:28,810
they're all open source all right so

730
00:26:27,520 --> 00:26:31,000
we've given you a bunch of different

731
00:26:28,810 --> 00:26:32,290
pieces of this agent he's giving you the

732
00:26:31,000 --> 00:26:34,950
architecture if you're maintaining the

733
00:26:32,290 --> 00:26:36,940
goals a persona layer the goal graph

734
00:26:34,950 --> 00:26:40,060
where does it all fit together so this

735
00:26:36,940 --> 00:26:43,420
is Fernando's slightly garish soar

736
00:26:40,060 --> 00:26:46,330
diagram when we started let me start the

737
00:26:43,420 --> 00:26:47,980
agent up we load the all of the soraa

738
00:26:46,330 --> 00:26:49,929
code the psychic representations we need

739
00:26:47,980 --> 00:26:52,090
to do the tools the riddle architecture

740
00:26:49,930 --> 00:26:54,160
that's used to maintain the goals in a

741
00:26:52,090 --> 00:26:56,139
procedural memory we take the that big

742
00:26:54,160 --> 00:26:57,790
goal graph I showed you that had all of

743
00:26:56,140 --> 00:26:59,320
the different goal definitions in it and

744
00:26:57,790 --> 00:27:00,310
the parameters for the specific mission

745
00:26:59,320 --> 00:27:02,290
we're gonna work on we load those into

746
00:27:00,310 --> 00:27:05,350
working memory so the agent can reason

747
00:27:02,290 --> 00:27:06,879
across them we take those personas we

748
00:27:05,350 --> 00:27:08,469
stick them into semantic memories facts

749
00:27:06,880 --> 00:27:10,060
so hey there's a person called Jack out

750
00:27:08,470 --> 00:27:14,050
there this is his email account and he

751
00:27:10,060 --> 00:27:16,090
uses this this service to do to do this

752
00:27:14,050 --> 00:27:17,740
type of thing and then we take our

753
00:27:16,090 --> 00:27:19,750
abstraction service and hook it up to

754
00:27:17,740 --> 00:27:21,130
the input and output links so the agent

755
00:27:19,750 --> 00:27:22,350
connect to the world and when this

756
00:27:21,130 --> 00:27:26,880
starts running you start to see

757
00:27:22,350 --> 00:27:31,419
Fernando's fernanda's autonomy loop of

758
00:27:26,880 --> 00:27:33,640
thinking perceiving and acting and then

759
00:27:31,420 --> 00:27:39,220
it learns in these memories up here so

760
00:27:33,640 --> 00:27:41,290
that is how it all fits together from

761
00:27:39,220 --> 00:27:45,550
there we're gonna show you how it works

762
00:27:41,290 --> 00:27:47,370
okay or at least attempt to graph so one

763
00:27:45,550 --> 00:27:50,200
of two things are about to happen either

764
00:27:47,370 --> 00:27:53,320
this remote demo from Michigan is going

765
00:27:50,200 --> 00:27:54,940
to actually work or it's gonna fail and

766
00:27:53,320 --> 00:27:57,370
you get to laugh and then we switch over

767
00:27:54,940 --> 00:27:58,870
to video but we're gonna try because we

768
00:27:57,370 --> 00:28:01,300
are brave people and we haven't make it

769
00:27:58,870 --> 00:28:04,290
any decision a stupid decisions today so

770
00:28:01,300 --> 00:28:07,149
can I ask for you for your first name

771
00:28:04,290 --> 00:28:08,379
Richard okay Richard we're gonna put

772
00:28:07,150 --> 00:28:10,630
your name here just so you see that

773
00:28:08,380 --> 00:28:12,070
there's nothing under our sleeves in

774
00:28:10,630 --> 00:28:14,470
terms of this is one of the files that

775
00:28:12,070 --> 00:28:17,080
the agent is going to exit right because

776
00:28:14,470 --> 00:28:19,530
we are keying in on a key term project

777
00:28:17,080 --> 00:28:23,050
Titan so here we're simulating an

778
00:28:19,530 --> 00:28:25,780
attempt to to to steal files concerning

779
00:28:23,050 --> 00:28:27,970
this project from a target system the

780
00:28:25,780 --> 00:28:29,910
the mission is already pre-programmed so

781
00:28:27,970 --> 00:28:32,200
the parameters for the mission already

782
00:28:29,910 --> 00:28:37,420
plugged in there so we have to do is hit

783
00:28:32,200 --> 00:28:39,910
run and here aside from Michigan's we

784
00:28:37,420 --> 00:28:41,110
have about a four second input delay so

785
00:28:39,910 --> 00:28:42,970
it's gonna be a little bit slower than

786
00:28:41,110 --> 00:28:45,050
we'd like but anyway so here alex is

787
00:28:42,970 --> 00:28:46,790
logging into the IRC channel

788
00:28:45,050 --> 00:28:48,560
I'm sorry sorry this is the the scram

789
00:28:46,790 --> 00:28:51,889
agent logging in and saying hey I'm

790
00:28:48,560 --> 00:28:53,210
alive I'm here and Alex is going to we

791
00:28:51,890 --> 00:28:54,920
really need to use the shorter names for

792
00:28:53,210 --> 00:28:58,420
these agents but anyway alex is gonna

793
00:28:54,920 --> 00:28:58,420
say okay go ahead and start the mission

794
00:28:58,570 --> 00:29:03,050
so we switched over here is the gold

795
00:29:01,160 --> 00:29:04,520
graph on the top as you see it started

796
00:29:03,050 --> 00:29:07,010
to populate the agent knows that its

797
00:29:04,520 --> 00:29:09,410
mission is to extract the files with a

798
00:29:07,010 --> 00:29:10,940
term probably Titan from a target

799
00:29:09,410 --> 00:29:12,710
network that it is given

800
00:29:10,940 --> 00:29:13,970
it also looks through its store memory

801
00:29:12,710 --> 00:29:15,470
stores and finds that it has email

802
00:29:13,970 --> 00:29:16,910
addresses for users in there in this

803
00:29:15,470 --> 00:29:18,590
particular case only one and that's for

804
00:29:16,910 --> 00:29:21,620
Alice because we want to keep this

805
00:29:18,590 --> 00:29:27,340
contained so you can see here but you

806
00:29:21,620 --> 00:29:29,270
wanna take this wire sure so thank you

807
00:29:27,340 --> 00:29:30,889
there's two things that have happened as

808
00:29:29,270 --> 00:29:32,720
it started it decided we gave it a

809
00:29:30,890 --> 00:29:33,980
starting goal of possessing information

810
00:29:32,720 --> 00:29:36,950
so it's going to try to take information

811
00:29:33,980 --> 00:29:39,250
off of a target network there are four

812
00:29:36,950 --> 00:29:41,810
machines you see here up in our our

813
00:29:39,250 --> 00:29:44,540
VMware sphere these three are on a land

814
00:29:41,810 --> 00:29:47,179
and our attacker machine is on a way on

815
00:29:44,540 --> 00:29:48,710
outside of that land when this attacker

816
00:29:47,180 --> 00:29:51,290
started up it decided to possess

817
00:29:48,710 --> 00:29:52,610
information off of this land network it

818
00:29:51,290 --> 00:29:54,020
proposed bunch of goals I'll zoom in on

819
00:29:52,610 --> 00:29:55,219
these in a second one of the things

820
00:29:54,020 --> 00:29:57,590
that's done is it's connected to a

821
00:29:55,220 --> 00:29:59,660
command and control server for a rat

822
00:29:57,590 --> 00:30:03,230
that we're going to infect the local

823
00:29:59,660 --> 00:30:07,120
network with and it sent an email that

824
00:30:03,230 --> 00:30:07,120
email ends up in Alice's inbox

825
00:30:09,970 --> 00:30:12,970
eventually

826
00:30:15,830 --> 00:30:20,520
and it is an email about cute puppies

827
00:30:18,300 --> 00:30:22,379
and who would ever not click on an email

828
00:30:20,520 --> 00:30:25,020
about cute puppies that have supposedly

829
00:30:22,380 --> 00:30:26,640
a doc M file and Google Drive it's

830
00:30:25,020 --> 00:30:29,910
actually a file hosted on our attacker

831
00:30:26,640 --> 00:30:33,740
machine as I'm sure most of you can

832
00:30:29,910 --> 00:30:36,060
guess it is in fact not friendly file

833
00:30:33,740 --> 00:30:38,130
it's a really simple file just say a

834
00:30:36,060 --> 00:30:44,280
macro that's going to act as a

835
00:30:38,130 --> 00:30:46,680
downloader and install the rat for us we

836
00:30:44,280 --> 00:30:51,930
open up and with this it should be

837
00:30:46,680 --> 00:30:54,150
infected so the machine we just infect

838
00:30:51,930 --> 00:30:55,740
was gonna call home to this this IRC

839
00:30:54,150 --> 00:30:57,630
Channel we've logged into it's on a

840
00:30:55,740 --> 00:30:58,770
different channel than this command

841
00:30:57,630 --> 00:31:01,380
control so you're not gonna see its

842
00:30:58,770 --> 00:31:04,230
messages but it is indeed calling home

843
00:31:01,380 --> 00:31:06,120
to the same place we're gonna give it

844
00:31:04,230 --> 00:31:15,660
just a second here wait for it wait for

845
00:31:06,120 --> 00:31:17,550
it or it's gonna crash so it's important

846
00:31:15,660 --> 00:31:19,320
to note that if if the phishing attack

847
00:31:17,550 --> 00:31:22,500
failed after a certain amount of time it

848
00:31:19,320 --> 00:31:28,129
would try something else actually it

849
00:31:22,500 --> 00:31:31,560
worked that's lovely

850
00:31:28,130 --> 00:31:33,030
so you can not read any of this I

851
00:31:31,560 --> 00:31:36,240
promised I would show it to you big

852
00:31:33,030 --> 00:31:40,410
enough that we could show there's

853
00:31:36,240 --> 00:31:42,390
nothing ever sleeves so the AEGON is

854
00:31:40,410 --> 00:31:44,550
doing multiple things at this point we

855
00:31:42,390 --> 00:31:46,350
you saw the rat connect already let's

856
00:31:44,550 --> 00:31:48,899
this key in on the blue bubbles bubbles

857
00:31:46,350 --> 00:31:51,179
at the at the bottom the second bubble

858
00:31:48,900 --> 00:31:53,460
is a rat scan so it's it's a the rat is

859
00:31:51,180 --> 00:31:55,230
scanning the local environment for SMB

860
00:31:53,460 --> 00:31:56,760
services because it's going to use

861
00:31:55,230 --> 00:31:59,940
eternal blue to do a lateral movement

862
00:31:56,760 --> 00:32:03,240
and then on the if you scroll to the

863
00:31:59,940 --> 00:32:04,620
right we have the alien is also going to

864
00:32:03,240 --> 00:32:06,920
be looking through the local filesystem

865
00:32:04,620 --> 00:32:09,689
of that first computer oh look at that

866
00:32:06,920 --> 00:32:12,290
switch the video so if the Aegon is also

867
00:32:09,690 --> 00:32:12,290
going to look to

868
00:32:12,620 --> 00:32:17,060
a VPN from here to Michigan is just not

869
00:32:14,840 --> 00:32:21,770
it wasn't smart but hey go ahead and

870
00:32:17,060 --> 00:32:23,450
laugh I give you license only so this is

871
00:32:21,770 --> 00:32:24,560
the exact same video we just recorded it

872
00:32:23,450 --> 00:32:27,080
beforehand just in case something like

873
00:32:24,560 --> 00:32:28,580
this happened and on the far right hand

874
00:32:27,080 --> 00:32:30,560
side you can see that as the agent is

875
00:32:28,580 --> 00:32:32,240
scanning the local network the rat is

876
00:32:30,560 --> 00:32:34,040
scanning the local network it's also

877
00:32:32,240 --> 00:32:36,380
looking at a local file system for files

878
00:32:34,040 --> 00:32:40,250
that have the strength project Titan

879
00:32:36,380 --> 00:32:43,700
it's gonna find them and then eventually

880
00:32:40,250 --> 00:32:45,050
it's going to love I'm ahead of them

881
00:32:43,700 --> 00:32:53,810
another video can you fast forward a

882
00:32:45,050 --> 00:33:00,770
little bit please no ok we get to do

883
00:32:53,810 --> 00:33:02,149
this slower all right so it's it's gonna

884
00:33:00,770 --> 00:33:04,100
be looking in a local file system and

885
00:33:02,150 --> 00:33:05,390
when it finds them it's gonna exit right

886
00:33:04,100 --> 00:33:06,590
I'm in a really stupid way because we

887
00:33:05,390 --> 00:33:08,330
didn't have to get fancy on this thing

888
00:33:06,590 --> 00:33:10,070
so he's just gonna as soon as it finds a

889
00:33:08,330 --> 00:33:11,899
file it's gonna upload it to an HTTP

890
00:33:10,070 --> 00:33:14,480
server that's running on the only

891
00:33:11,900 --> 00:33:15,980
attackers box we can try this in any

892
00:33:14,480 --> 00:33:17,870
number of complex ways we just wanted to

893
00:33:15,980 --> 00:33:24,740
keep it simple for the demo trying to

894
00:33:17,870 --> 00:33:29,810
optimize our odds of it working almost

895
00:33:24,740 --> 00:33:31,730
there and over time it's gonna find if I

896
00:33:29,810 --> 00:33:34,060
find two other hosts I have smb2 other

897
00:33:31,730 --> 00:33:36,920
windows boxes we showed them earlier

898
00:33:34,060 --> 00:33:39,320
Carol and grace and it's going to infect

899
00:33:36,920 --> 00:33:42,620
them and then install rats and the rats

900
00:33:39,320 --> 00:33:44,419
are gonna phone home and then a grand

901
00:33:42,620 --> 00:33:46,280
total of I think four or five files are

902
00:33:44,420 --> 00:33:49,670
gonna be Excel traded at the end of the

903
00:33:46,280 --> 00:33:52,490
day and what won't you fast-forward to

904
00:33:49,670 --> 00:33:54,740
the end there the end of the video isn't

905
00:33:52,490 --> 00:33:57,200
as lovely because it shows me pulling up

906
00:33:54,740 --> 00:33:58,460
a copy of the machine the file I place

907
00:33:57,200 --> 00:34:01,400
in the beginning of the video which we

908
00:33:58,460 --> 00:34:03,200
didn't show I'm gonna take one more

909
00:34:01,400 --> 00:34:05,930
gamble here and I despite the fact that

910
00:34:03,200 --> 00:34:07,730
our GUI crashed I'm pretty sure the

911
00:34:05,930 --> 00:34:09,020
attack will have finished I should be

912
00:34:07,730 --> 00:34:11,620
able to show you that that file has

913
00:34:09,020 --> 00:34:11,620
excellent rated

914
00:34:14,400 --> 00:34:20,639
so a couple key book key takeaways here

915
00:34:17,909 --> 00:34:23,129
the first one is that the the agent is

916
00:34:20,639 --> 00:34:24,540
given some very very broad rule what

917
00:34:23,130 --> 00:34:26,970
brought goals it says you know go do

918
00:34:24,540 --> 00:34:28,889
this and it searches through its for its

919
00:34:26,969 --> 00:34:30,719
knowledge of TTP's and figure it out

920
00:34:28,889 --> 00:34:33,299
what is the best way to get from here to

921
00:34:30,719 --> 00:34:35,279
there as it tries and fails different

922
00:34:33,300 --> 00:34:36,720
approaches it will it can it can learn

923
00:34:35,280 --> 00:34:38,490
from the experience to say okay against

924
00:34:36,719 --> 00:34:40,649
this particular target I tried this and

925
00:34:38,489 --> 00:34:42,569
it didn't work before so next time I'm

926
00:34:40,650 --> 00:34:46,830
gonna try I'm not gonna try the same the

927
00:34:42,570 --> 00:34:48,120
same technique again in the interest of

928
00:34:46,830 --> 00:34:52,139
time you're gonna go over to the

929
00:34:48,120 --> 00:34:53,370
respective slides so if you caught that

930
00:34:52,139 --> 00:34:54,810
at the tail end of the video we showed

931
00:34:53,370 --> 00:34:57,779
how we actually went in and open up

932
00:34:54,810 --> 00:34:59,910
those files in different folders in the

933
00:34:57,780 --> 00:35:03,030
in the web server the reason we do that

934
00:34:59,910 --> 00:35:05,250
is we want to be able to keep keep track

935
00:35:03,030 --> 00:35:06,870
of where we got each file from so we can

936
00:35:05,250 --> 00:35:09,060
capture some metadata about users and

937
00:35:06,870 --> 00:35:12,839
locations and anything else we want to

938
00:35:09,060 --> 00:35:14,430
along the way so moving on to future

939
00:35:12,840 --> 00:35:16,530
work I want to key in on three things

940
00:35:14,430 --> 00:35:18,690
that we discovered we're a lot harder

941
00:35:16,530 --> 00:35:20,310
than we thought going into this and then

942
00:35:18,690 --> 00:35:22,830
we have to put circle back and put some

943
00:35:20,310 --> 00:35:24,150
more effort into so it's keeping track

944
00:35:22,830 --> 00:35:26,040
of cyber stuff and we kind of alluded to

945
00:35:24,150 --> 00:35:28,410
that already the second one is modeling

946
00:35:26,040 --> 00:35:30,450
TTP's in a formal way and then lastly

947
00:35:28,410 --> 00:35:35,069
the human-machine teaming aspect of the

948
00:35:30,450 --> 00:35:38,160
whole enterprise so keeping track of of

949
00:35:35,070 --> 00:35:40,170
cyber stuffs as we alluded to earlier is

950
00:35:38,160 --> 00:35:42,720
really really hard actually another

951
00:35:40,170 --> 00:35:45,780
client came to us and asked us to help

952
00:35:42,720 --> 00:35:47,520
them build models of cyberspace in these

953
00:35:45,780 --> 00:35:49,590
three layers and this is actually where

954
00:35:47,520 --> 00:35:51,930
a lot of the work came in analyzing the

955
00:35:49,590 --> 00:35:54,840
the work that had been done already at

956
00:35:51,930 --> 00:35:57,810
the persona layer analysis but what we

957
00:35:54,840 --> 00:36:00,180
have here is that we can it's not just

958
00:35:57,810 --> 00:36:01,770
about cybersecurity we can learn all

959
00:36:00,180 --> 00:36:03,149
kinds of interesting things about what's

960
00:36:01,770 --> 00:36:05,370
going on in a network some of the

961
00:36:03,150 --> 00:36:08,190
scenarios we came up with involve people

962
00:36:05,370 --> 00:36:09,509
doing strange things that need

963
00:36:08,190 --> 00:36:11,130
explanation and that could have a

964
00:36:09,510 --> 00:36:14,370
detrimental effect on our security

965
00:36:11,130 --> 00:36:17,250
posture so this was hard the second

966
00:36:14,370 --> 00:36:19,710
piece was building models of TTP's I

967
00:36:17,250 --> 00:36:22,590
mentioned earlier that said that non

968
00:36:19,710 --> 00:36:24,300
symbolic AI machine learning is really

969
00:36:22,590 --> 00:36:26,670
really really good at classification

970
00:36:24,300 --> 00:36:28,300
problems and that sort of thing not so

971
00:36:26,670 --> 00:36:30,490
good at the complex behaviors that we

972
00:36:28,300 --> 00:36:33,760
we are we implemented here using the

973
00:36:30,490 --> 00:36:36,669
symbolic approach but it turns out that

974
00:36:33,760 --> 00:36:38,230
if we are able to have to have models

975
00:36:36,670 --> 00:36:41,080
that that can be shared between the two

976
00:36:38,230 --> 00:36:42,970
we could detect TTP's using some non

977
00:36:41,080 --> 00:36:45,190
symbolic approaches and actually input

978
00:36:42,970 --> 00:36:47,350
them into symbolic system that can

979
00:36:45,190 --> 00:36:49,570
either defend or then use those to learn

980
00:36:47,350 --> 00:36:51,520
what targets are hitting apart or what

981
00:36:49,570 --> 00:36:53,500
attacks are threatening a particular

982
00:36:51,520 --> 00:36:58,240
environment and then do targeted pen

983
00:36:53,500 --> 00:37:01,600
testing in real time this is to show

984
00:36:58,240 --> 00:37:04,060
that our approach to to building TTP's

985
00:37:01,600 --> 00:37:07,779
is not built in isolation so this is

986
00:37:04,060 --> 00:37:10,330
actually an this is a an overlay of the

987
00:37:07,780 --> 00:37:14,110
mitre attack framework on top of TTP's

988
00:37:10,330 --> 00:37:15,819
that we modeled for apt 28 and the the

989
00:37:14,110 --> 00:37:19,810
pawn storm campaign that was well

990
00:37:15,820 --> 00:37:23,440
well-documented years ago so these are

991
00:37:19,810 --> 00:37:25,560
the these are techniques out of the the

992
00:37:23,440 --> 00:37:28,570
attack framework going back one slide

993
00:37:25,560 --> 00:37:31,360
those that then further decomposed into

994
00:37:28,570 --> 00:37:33,130
procedures and procedures is really the

995
00:37:31,360 --> 00:37:35,290
glue that ties the whole thing together

996
00:37:33,130 --> 00:37:36,880
at the very bottom we have observables

997
00:37:35,290 --> 00:37:38,560
things that you can see on your network

998
00:37:36,880 --> 00:37:40,530
like IP addresses and domain names and

999
00:37:38,560 --> 00:37:43,230
malware signatures and whatever you have

1000
00:37:40,530 --> 00:37:45,790
and then at the top we have these higher

1001
00:37:43,230 --> 00:37:47,290
concept kind of techniques so the

1002
00:37:45,790 --> 00:37:48,910
procedures are things that tie the two

1003
00:37:47,290 --> 00:37:52,150
together and say this particular

1004
00:37:48,910 --> 00:37:53,470
adversary uses these procedures every if

1005
00:37:52,150 --> 00:37:55,240
they're gonna do this thing they always

1006
00:37:53,470 --> 00:37:56,980
do it this way and there are variants of

1007
00:37:55,240 --> 00:37:59,589
it and that those variances is what we

1008
00:37:56,980 --> 00:38:01,810
capture inside the body of a of one of

1009
00:37:59,590 --> 00:38:04,600
our techniques and this allows us to map

1010
00:38:01,810 --> 00:38:05,650
out who might be acting on our network

1011
00:38:04,600 --> 00:38:07,870
and also what their goals

1012
00:38:05,650 --> 00:38:11,070
ultimately might be which gives us a

1013
00:38:07,870 --> 00:38:13,420
heads up in terms of intersecting that

1014
00:38:11,070 --> 00:38:17,320
now putting the whole thing together if

1015
00:38:13,420 --> 00:38:20,440
we can build as we develop these models

1016
00:38:17,320 --> 00:38:22,480
ett be models we wrote a paper last year

1017
00:38:20,440 --> 00:38:25,020
so we're hoping to to get the the whole

1018
00:38:22,480 --> 00:38:27,580
community energized in it we're also

1019
00:38:25,020 --> 00:38:31,150
talking to Palo Alto Networks Rick

1020
00:38:27,580 --> 00:38:32,740
Howard has a great project on Play Books

1021
00:38:31,150 --> 00:38:34,480
and adversarial play books that also

1022
00:38:32,740 --> 00:38:36,399
leverage the matter framework but are

1023
00:38:34,480 --> 00:38:37,780
still not a robust enough for machine to

1024
00:38:36,400 --> 00:38:39,880
a fire to visual intelligence to really

1025
00:38:37,780 --> 00:38:41,110
do much with so this is this is where

1026
00:38:39,880 --> 00:38:43,420
we're hoping to to

1027
00:38:41,110 --> 00:38:45,850
to tie in to that that effort so we

1028
00:38:43,420 --> 00:38:47,350
classify procedures from observables and

1029
00:38:45,850 --> 00:38:49,900
then from there we build techniques and

1030
00:38:47,350 --> 00:38:51,790
then because there's so much variance in

1031
00:38:49,900 --> 00:38:53,380
there we use abductive reasoning to come

1032
00:38:51,790 --> 00:38:54,790
up with the best explanation for the

1033
00:38:53,380 --> 00:38:56,950
observations that we're seeing on the

1034
00:38:54,790 --> 00:38:58,570
network and then this brings us to the

1035
00:38:56,950 --> 00:39:00,549
last piece which is the human-machine

1036
00:38:58,570 --> 00:39:02,860
symbiosis because everything on the left

1037
00:39:00,550 --> 00:39:04,990
is symbolic and non symbolic ai

1038
00:39:02,860 --> 00:39:06,730
symbiosis so leveraging the strengths

1039
00:39:04,990 --> 00:39:09,459
and to offset the weaknesses of each

1040
00:39:06,730 --> 00:39:11,710
approach with the other but on the far

1041
00:39:09,460 --> 00:39:13,870
right we we need a human to be part of

1042
00:39:11,710 --> 00:39:15,400
the system and how do we manage the

1043
00:39:13,870 --> 00:39:18,069
relationship and how do we build trust

1044
00:39:15,400 --> 00:39:21,280
is something we're very active in things

1045
00:39:18,070 --> 00:39:24,100
like how can a human teach a kanay

1046
00:39:21,280 --> 00:39:25,570
assistant how to learn experientially by

1047
00:39:24,100 --> 00:39:27,520
watching what the human does and then

1048
00:39:25,570 --> 00:39:29,560
how can we then take that that that it's

1049
00:39:27,520 --> 00:39:32,470
a psychic agent and have it teach a

1050
00:39:29,560 --> 00:39:36,270
novice human how to do things in

1051
00:39:32,470 --> 00:39:38,140
cyberspace and that's it not sure so

1052
00:39:36,270 --> 00:39:38,950
hopefully you have a lot of questions

1053
00:39:38,140 --> 00:39:40,420
and then we can continue the

1054
00:39:38,950 --> 00:39:42,689
conversation thank you very much for

1055
00:39:40,420 --> 00:39:42,690
your time

1056
00:40:07,280 --> 00:40:12,949
[Music]

1057
00:40:18,480 --> 00:40:22,930
okay so the the if I understand the

1058
00:40:21,579 --> 00:40:24,220
question correctly is what is the

1059
00:40:22,930 --> 00:40:27,430
relationship between psychology and

1060
00:40:24,220 --> 00:40:29,348
psychic you the the whole the whole

1061
00:40:27,430 --> 00:40:30,609
purpose of building psychic of you was

1062
00:40:29,349 --> 00:40:32,380
we wanted to identify human

1063
00:40:30,609 --> 00:40:33,670
vulnerabilities right so when would be

1064
00:40:32,380 --> 00:40:35,200
will click but that's that's a simple

1065
00:40:33,670 --> 00:40:36,160
example it's actually much broader than

1066
00:40:35,200 --> 00:40:38,799
that

1067
00:40:36,160 --> 00:40:40,480
the psychic a was used to do the testing

1068
00:40:38,799 --> 00:40:42,279
so we would build an environment with

1069
00:40:40,480 --> 00:40:45,160
psychic use and then we could launch

1070
00:40:42,279 --> 00:40:47,170
psycho gay against it many many many

1071
00:40:45,160 --> 00:40:50,739
times and then record results and see

1072
00:40:47,170 --> 00:40:53,529
how effective the the model that we

1073
00:40:50,739 --> 00:40:54,940
derived from a particular population how

1074
00:40:53,529 --> 00:40:57,609
effective was a particular attack

1075
00:40:54,940 --> 00:41:00,279
against it is that does that answer your

1076
00:40:57,609 --> 00:41:02,109
question no I missed the mark okay so

1077
00:41:00,279 --> 00:41:06,220
the other fun thing you can do these

1078
00:41:02,109 --> 00:41:07,359
agents is as cybersecurity grows we need

1079
00:41:06,220 --> 00:41:08,470
to train more professionals one of the

1080
00:41:07,359 --> 00:41:10,239
kind of things we do is we build cyber

1081
00:41:08,470 --> 00:41:12,488
ranges for people to actually experiment

1082
00:41:10,239 --> 00:41:14,619
on and test if you've ever worked on

1083
00:41:12,489 --> 00:41:15,880
those ranges experience people

1084
00:41:14,619 --> 00:41:16,960
frequently will sit down the first thing

1085
00:41:15,880 --> 00:41:18,279
they'll do is take a look at all the

1086
00:41:16,960 --> 00:41:19,720
traffic they can see and immediately

1087
00:41:18,279 --> 00:41:20,950
parse out that's generated this

1088
00:41:19,720 --> 00:41:22,149
generator this generator oh that's real

1089
00:41:20,950 --> 00:41:24,430
i but that's what's the interesting part

1090
00:41:22,150 --> 00:41:26,470
well if we can take cognitive agents

1091
00:41:24,430 --> 00:41:28,899
that are having conversations over email

1092
00:41:26,470 --> 00:41:31,058
that look somewhat realistic at least at

1093
00:41:28,900 --> 00:41:32,319
a cursory glance and then put some

1094
00:41:31,059 --> 00:41:33,940
attackers in this network and put some

1095
00:41:32,319 --> 00:41:36,788
defenders on it and then throw a human

1096
00:41:33,940 --> 00:41:38,319
in all of a sudden one person sitting by

1097
00:41:36,789 --> 00:41:40,180
themselves on a cyber range can work in

1098
00:41:38,319 --> 00:41:43,150
a very lively realistic looking

1099
00:41:40,180 --> 00:41:44,980
environment so we don't build products

1100
00:41:43,150 --> 00:41:46,180
we just kind of build smarts that go

1101
00:41:44,980 --> 00:41:47,829
into products and this is the

1102
00:41:46,180 --> 00:41:49,779
conversation we're having with with a

1103
00:41:47,829 --> 00:41:51,670
commercial transition partner is how do

1104
00:41:49,779 --> 00:41:55,230
we how we then use this for for

1105
00:41:51,670 --> 00:41:55,230
improving the quality of training events

1106
00:41:57,990 --> 00:42:33,660
a great question so we are not in the

1107
00:42:32,190 --> 00:42:35,520
business of creating fake social media

1108
00:42:33,660 --> 00:42:39,060
personas out there they put that on the

1109
00:42:35,520 --> 00:42:42,180
record real quick what if if you think

1110
00:42:39,060 --> 00:42:44,009
back to the the IBL the instance-based

1111
00:42:42,180 --> 00:42:45,890
learning example i showed up that

1112
00:42:44,010 --> 00:42:49,800
complicated chart with lots of questions

1113
00:42:45,890 --> 00:42:52,710
it was actually it went way beyond just

1114
00:42:49,800 --> 00:42:54,180
the cute puppies click on the link it

1115
00:42:52,710 --> 00:42:56,060
was it exploited the relationships

1116
00:42:54,180 --> 00:43:01,200
within alice and some of her co-workers

1117
00:42:56,060 --> 00:43:02,940
and so the agent learned the the model

1118
00:43:01,200 --> 00:43:04,710
of those interactions by observing the

1119
00:43:02,940 --> 00:43:08,160
environment and then sent very targeted

1120
00:43:04,710 --> 00:43:10,320
links it figured out that alice was only

1121
00:43:08,160 --> 00:43:12,420
likely to click a link that without

1122
00:43:10,320 --> 00:43:15,480
questioning it basically that came from

1123
00:43:12,420 --> 00:43:17,160
a very particular class of users and if

1124
00:43:15,480 --> 00:43:18,000
she saw that then she'd be more relaxed

1125
00:43:17,160 --> 00:43:19,649
and she would click on the link and

1126
00:43:18,000 --> 00:43:21,300
that's that's what the hacker exploited

1127
00:43:19,650 --> 00:43:26,310
does that answer your question

1128
00:43:21,300 --> 00:43:27,840
ok wonderful I don't know the

1129
00:43:26,310 --> 00:43:29,400
exfiltrated file did actually show up

1130
00:43:27,840 --> 00:43:33,270
despite the fact that we never confirmed

1131
00:43:29,400 --> 00:43:34,650
it and it's super tiny in the corona I

1132
00:43:33,270 --> 00:43:40,859
have no idea how to zoom in on this text

1133
00:43:34,650 --> 00:43:43,250
editor else how you're letting yourself

1134
00:43:40,859 --> 00:43:43,250
easy

1135
00:43:50,000 --> 00:44:00,780
I'm sorry one more time so I'm fairly

1136
00:43:58,740 --> 00:44:03,270
certain our IT team would have my head

1137
00:44:00,780 --> 00:44:04,650
if I actually ran this against our local

1138
00:44:03,270 --> 00:44:06,600
production environment so I have not

1139
00:44:04,650 --> 00:44:09,120
done that I can share one slight amusing

1140
00:44:06,600 --> 00:44:11,040
story though that rat in there is a a

1141
00:44:09,120 --> 00:44:12,900
Java rat and it does have some tooling

1142
00:44:11,040 --> 00:44:14,250
in it in one of our concerns for a while

1143
00:44:12,900 --> 00:44:15,870
was we wanted to make sure people

1144
00:44:14,250 --> 00:44:19,650
developing it weren't running it locally

1145
00:44:15,870 --> 00:44:23,130
and after working it for a couple weeks

1146
00:44:19,650 --> 00:44:24,660
I ran the IRC look up against it and

1147
00:44:23,130 --> 00:44:26,460
found that it was running in a

1148
00:44:24,660 --> 00:44:29,580
significant portion of the machines in

1149
00:44:26,460 --> 00:44:34,050
our business area for company it hides

1150
00:44:29,580 --> 00:44:36,569
itself fairly well and it worked of

1151
00:44:34,050 --> 00:44:39,180
course now we're on video admitting that

1152
00:44:36,570 --> 00:45:10,110
so wouldn't it be handing out resumes

1153
00:44:39,180 --> 00:45:13,890
later so my personal perspective on this

1154
00:45:10,110 --> 00:45:16,560
is we need autonomous agents to speed up

1155
00:45:13,890 --> 00:45:18,180
the process and to bring to the humans

1156
00:45:16,560 --> 00:45:20,700
the things that they should be paying

1157
00:45:18,180 --> 00:45:22,379
attention to right now I'm sure most of

1158
00:45:20,700 --> 00:45:23,819
you would agree that we have an awful

1159
00:45:22,380 --> 00:45:26,490
lot a brilliant

1160
00:45:23,820 --> 00:45:29,280
cyber security experts out there wasting

1161
00:45:26,490 --> 00:45:32,370
their lives away looking at stupid stuff

1162
00:45:29,280 --> 00:45:34,530
so the idea is to to focus these these

1163
00:45:32,370 --> 00:45:36,900
very valuable human assets and enhance

1164
00:45:34,530 --> 00:45:38,760
their performance the adversaries are

1165
00:45:36,900 --> 00:45:42,060
going to be using intelligent agents at

1166
00:45:38,760 --> 00:45:44,130
some point some my my guess is sometime

1167
00:45:42,060 --> 00:45:46,740
in the next couple years so we need to

1168
00:45:44,130 --> 00:45:49,410
do that just to keep up with the pace or

1169
00:45:46,740 --> 00:45:52,200
speed of these attacks that's but know

1170
00:45:49,410 --> 00:45:54,180
our work is we're trying to move humans

1171
00:45:52,200 --> 00:45:54,500
from being in the loop to being on the

1172
00:45:54,180 --> 00:45:55,759
loop

1173
00:45:54,500 --> 00:45:57,830
and then that's that's where that

1174
00:45:55,760 --> 00:45:59,510
human-machine symbiosis comes in is how

1175
00:45:57,830 --> 00:46:09,049
do we how we manage that relationship

1176
00:45:59,510 --> 00:46:11,660
between the two more five minutes left

1177
00:46:09,050 --> 00:46:54,320
you know this is amazing we kept going

1178
00:46:11,660 --> 00:46:57,649
over and over and over so they're very

1179
00:46:54,320 --> 00:46:59,210
different problems the attacking problem

1180
00:46:57,650 --> 00:47:02,630
is much more of an exploration problem

1181
00:46:59,210 --> 00:47:04,190
we wander into a environment we start

1182
00:47:02,630 --> 00:47:07,460
off with some targeting reticle and we

1183
00:47:04,190 --> 00:47:09,040
try to discover more and more things we

1184
00:47:07,460 --> 00:47:11,210
can do as we progress through

1185
00:47:09,040 --> 00:47:12,650
compromising network where as defense as

1186
00:47:11,210 --> 00:47:15,050
we start out with everything we can do

1187
00:47:12,650 --> 00:47:18,650
and then try to stop that attacker from

1188
00:47:15,050 --> 00:47:19,730
exploring our space they're really

1189
00:47:18,650 --> 00:47:21,230
different problems and like we said

1190
00:47:19,730 --> 00:47:22,040
we're not trying to replace humans

1191
00:47:21,230 --> 00:47:23,630
neither I don't think either of us

1192
00:47:22,040 --> 00:47:24,860
believe that we're gonna pull humans out

1193
00:47:23,630 --> 00:47:27,650
of the loop this is human on the loop

1194
00:47:24,860 --> 00:47:29,780
and like that defensive agent in the

1195
00:47:27,650 --> 00:47:32,750
screenshot example I showed it detects

1196
00:47:29,780 --> 00:47:33,860
something that it identifies as not

1197
00:47:32,750 --> 00:47:36,140
critical to the art to the

1198
00:47:33,860 --> 00:47:37,370
infrastructure and really unexpected and

1199
00:47:36,140 --> 00:47:39,950
it immediately creates a firewall rule

1200
00:47:37,370 --> 00:47:42,310
and then it tells the person hey I did

1201
00:47:39,950 --> 00:47:44,930
this action to block this thing so

1202
00:47:42,310 --> 00:47:47,420
reaction time is one we get a ton of

1203
00:47:44,930 --> 00:47:49,490
reaction time out of it into if things

1204
00:47:47,420 --> 00:47:52,340
do go haywire it's it's like having

1205
00:47:49,490 --> 00:47:53,930
extra people in the room so I wouldn't

1206
00:47:52,340 --> 00:47:55,970
expect this anytime soon to replace your

1207
00:47:53,930 --> 00:47:57,319
senior guys but replacing your junior

1208
00:47:55,970 --> 00:48:00,259
guys I could very much so see happening

1209
00:47:57,320 --> 00:48:01,850
on next few years so so a different

1210
00:48:00,260 --> 00:48:03,770
perspective on the answer is is it gonna

1211
00:48:01,850 --> 00:48:06,680
be I've been tazed for the office or the

1212
00:48:03,770 --> 00:48:07,500
defense at least initially keep in mind

1213
00:48:06,680 --> 00:48:10,348
that

1214
00:48:07,500 --> 00:48:11,580
we are what I'm concerned about is that

1215
00:48:10,349 --> 00:48:15,000
artificial

1216
00:48:11,580 --> 00:48:17,340
non-symbolic AI is gonna be used soon to

1217
00:48:15,000 --> 00:48:19,320
make attacks quicker and harder to

1218
00:48:17,340 --> 00:48:20,670
detect that's that's already happening

1219
00:48:19,320 --> 00:48:22,740
in some of the systems I showed up there

1220
00:48:20,670 --> 00:48:24,599
so what we're trying to do is kind of

1221
00:48:22,740 --> 00:48:25,859
its kind of prep for that by building

1222
00:48:24,599 --> 00:48:28,710
these agents that can respond at machine

1223
00:48:25,859 --> 00:48:31,259
speed to these to these attacks along

1224
00:48:28,710 --> 00:48:35,250
the way we would we hope to develop the

1225
00:48:31,260 --> 00:48:36,750
cycle gay agent to to anticipate what

1226
00:48:35,250 --> 00:48:38,310
some of these non symbolic approaches

1227
00:48:36,750 --> 00:48:40,109
are gonna be and how humans might help

1228
00:48:38,310 --> 00:48:41,880
them and we recycle Ganga China is that

1229
00:48:40,109 --> 00:48:43,319
allowing us to do these attacks many

1230
00:48:41,880 --> 00:48:45,599
many times in experiments and see oh

1231
00:48:43,320 --> 00:48:47,400
that's how we break those attacks or how

1232
00:48:45,599 --> 00:48:49,740
that's how we detect them or that's how

1233
00:48:47,400 --> 00:48:51,840
effective our defenses are one of the

1234
00:48:49,740 --> 00:48:53,399
some of the interest is that there's

1235
00:48:51,840 --> 00:48:55,470
there some agencies are very interested

1236
00:48:53,400 --> 00:48:57,300
in our work because they want to use it

1237
00:48:55,470 --> 00:48:59,730
to test the new capabilities like do you

1238
00:48:57,300 --> 00:49:01,109
raw you sell me a brand new firewall let

1239
00:48:59,730 --> 00:49:02,730
me see how well this stacks up against

1240
00:49:01,109 --> 00:49:05,310
the attacks that I'm facing so this is

1241
00:49:02,730 --> 00:49:07,849
all everything we show you today I think

1242
00:49:05,310 --> 00:49:10,759
has very strong defensive implications

1243
00:49:07,849 --> 00:49:12,480
could an attacker use these techniques

1244
00:49:10,760 --> 00:49:14,400
not anytime soon

1245
00:49:12,480 --> 00:49:16,230
it took us a while to get here and

1246
00:49:14,400 --> 00:49:17,880
hopefully hopefully we don't get hacked

1247
00:49:16,230 --> 00:49:21,710
as a result of this and lose it all but

1248
00:49:17,880 --> 00:49:29,910
that's okay is the answer your question

1249
00:49:21,710 --> 00:49:31,800
okay oh okay well we're here for a while

1250
00:49:29,910 --> 00:49:34,970
so please hit us up thank you so much

1251
00:49:31,800 --> 00:49:34,970
for your time and your questions

