1
00:00:00,000 --> 00:00:06,330
good morning I am Nicola McLean and I'm
going to talk about continuous

2
00:00:06,330 --> 00:00:11,160
integration tools and how their features
and miss contributions could be abused

3
00:00:11,160 --> 00:00:17,220
will talk about continuous inclusion of
ICAI that is continuous integration

4
00:00:17,220 --> 00:00:26,640
tools are Anadarko space rent starting
with some words of this from this is the

5
00:00:26,640 --> 00:00:32,520
court from our military strategist and
politician from ancient India as a

6
00:00:32,520 --> 00:00:38,190
single with the tree it's a flame god
this whole forestry bond so does a

7
00:00:38,190 --> 00:00:43,510
single improperly configured and
innocent division to destroy the whole

8
00:00:43,510 --> 00:00:48,218
enterprise network and really words of
wisdom he saw this thing two thousand

9
00:00:48,219 --> 00:00:57,270
years back so couple of things about me
I'm on Twitter so follow me I blog on

10
00:00:57,270 --> 00:01:03,789
lap of a penetration tester dot com
creator of Cordelia and shocking adele

11
00:01:03,789 --> 00:01:08,630
is a tool which you can use to ease
usage of human interface devices in

12
00:01:08,630 --> 00:01:13,580
penetration test and mission is a tool
for using powershell

13
00:01:13,580 --> 00:01:19,798
interesting and often offensive security
both of the 2011 on my YouTube account

14
00:01:19,799 --> 00:01:24,189
and I've been a frequent speaker for
past few years

15
00:01:24,189 --> 00:01:31,048
conferences in this talk we are going to
discuss a lot of things and I'm hoping

16
00:01:31,049 --> 00:01:37,369
I'm not run out of time obviously guilty
and innocent addition tools arvida

17
00:01:37,369 --> 00:01:45,280
useful for us we'll see hopefully live
demonstrations to abuse some of the most

18
00:01:45,280 --> 00:01:51,250
popular CI tools like Jenkins TeamCity
go no demonstrations for cruise control

19
00:01:51,250 --> 00:01:57,799
it's it's really all now then we'll see
zero revenue limit everyone is talking

20
00:01:57,799 --> 00:02:03,770
about are the double insulation baggage
was sitting idle for nine months no one

21
00:02:03,770 --> 00:02:08,970
noticed and then you'll see a common
Abuse Act for all the CI tools of what

22
00:02:08,970 --> 00:02:09,410
is the

23
00:02:09,410 --> 00:02:17,150
information or common features are
designed implementations or design flaws

24
00:02:17,150 --> 00:02:22,830
which all of this year due to most of
the CID share then we'll talk about

25
00:02:22,830 --> 00:02:28,010
defense for users that is enterprises
who would apply see I told in the

26
00:02:28,010 --> 00:02:35,179
environment and for them to possible and
that's it will also see that what others

27
00:02:35,180 --> 00:02:41,280
are doing what bad guys or others are
doing using schedules first of all what

28
00:02:41,280 --> 00:02:45,530
our country is in Division title so I
picked it up from Wikipedia continuous

29
00:02:45,530 --> 00:02:51,800
integration describes a set of software
engineering practices that speed up the

30
00:02:51,800 --> 00:02:57,460
delivery of software by using individual
banks are very easy to understand

31
00:02:57,460 --> 00:03:00,530
software that accomplishes this practice
is called continuous integration

32
00:03:00,530 --> 00:03:09,180
software or CID so see I do to use just
22 degrees the time of integrating

33
00:03:09,180 --> 00:03:16,450
different than it helps build team
source code management teams this is a

34
00:03:16,450 --> 00:03:18,790
typical implementation

35
00:03:18,790 --> 00:03:22,799
implementation of a simplified
implementation of of continuous

36
00:03:22,800 --> 00:03:28,450
integration in an enterprise there are
developers industry code repositories

37
00:03:28,450 --> 00:03:33,369
their buildings source code regimen
teens they have access to the continuous

38
00:03:33,370 --> 00:03:38,239
integration master all the bill jobs of
integration and all things are run on

39
00:03:38,239 --> 00:03:48,780
slaves and masters as well it depends on
the contribution so as we saw in the

40
00:03:48,780 --> 00:03:56,390
previous diagram in a typical industry
saddam jobs on honesty I do need a non

41
00:03:56,390 --> 00:04:03,029
master and slaves so there's like a huge
network with one node having access to a

42
00:04:03,030 --> 00:04:09,090
large number of nodes so obviously if a
hacker manages to get access to a CI

43
00:04:09,090 --> 00:04:14,239
tool he he owns a substantial part of
the network

44
00:04:14,239 --> 00:04:18,829
the master node the slave nodes the same
notes may include machines of different

45
00:04:18,829 --> 00:04:21,130
parts of buildings and

46
00:04:21,130 --> 00:04:27,550
you know a lot of different things which
includes different platforms Linux

47
00:04:27,550 --> 00:04:35,100
machines Windows machines in in such
case in a doctor also owns substantial

48
00:04:35,100 --> 00:04:40,880
part of sorts corn produced the build
process even if not the source code and

49
00:04:40,880 --> 00:04:46,030
a lot more things and obviously this
excess could be used for legitimate as

50
00:04:46,030 --> 00:04:52,880
we'll see this success because of the
mismanagement of creations in a Windows

51
00:04:52,880 --> 00:04:57,080
networks are in a president this success
could be used religious movement and

52
00:04:57,080 --> 00:05:03,740
getting access to much more things and
me I'm so good that there have been no

53
00:05:03,740 --> 00:05:09,470
penetration test which if I had access
to a CI to have always been a domain and

54
00:05:09,470 --> 00:05:18,300
so let's do you live demonstration
demanding that thing as well so I

55
00:05:18,300 --> 00:05:28,260
Jenkins control and go and be prepared
to reduce in city and Hudson city of

56
00:05:28,260 --> 00:05:35,010
Hudson are not tested separately and
we'll come back to that in a moment and

57
00:05:35,010 --> 00:05:41,180
look at future abuse or default
configuration or miss contributions are

58
00:05:41,180 --> 00:05:45,550
the things that you actually find
exposed to the internet or in internal

59
00:05:45,550 --> 00:05:52,690
penetration test will stick to that
there are always ways to the Securities

60
00:05:52,690 --> 00:05:57,100
2000 well but that is just like one
percent of the machines here you'll see

61
00:05:57,100 --> 00:06:04,180
the actual secure implementation
starting with Jenkins and is obviously

62
00:06:04,180 --> 00:06:11,520
if you are new to the sea i think you
must have heard about Jenkins it is most

63
00:06:11,520 --> 00:06:20,570
widely used see I do all the testing has
been done on line 163 vetoes latest

64
00:06:20,570 --> 00:06:28,420
when I started finalizing demonstrations
for the stock of October last month and

65
00:06:28,420 --> 00:06:31,380
yes hudson was not tested separately

66
00:06:31,380 --> 00:06:33,219
Hudson in Jenkins R

67
00:06:33,220 --> 00:06:40,280
sort of prints and in the CIA and clubs
it's still under medical thing that who

68
00:06:40,280 --> 00:06:48,229
forked who is it like it's the chicken
is one of the Jenkins which waldholtz

69
00:06:48,230 --> 00:06:54,960
unaudited some useful Jenkins so you can
safely assume that whatever plans to

70
00:06:54,960 --> 00:07:05,049
Jenkins players who had seen as Israel
so some of the security issues with no

71
00:07:05,050 --> 00:07:11,590
security in the default installation yes
you can always find these different

72
00:07:11,590 --> 00:07:18,859
install assurance given to the internet
so that's pretty lame of guys I mean

73
00:07:18,860 --> 00:07:23,400
dinkins is a great tool but this is
really to have a Northern Division the

74
00:07:23,400 --> 00:07:31,159
default installation in fact I forgot to
buy today I think the first user which

75
00:07:31,160 --> 00:07:37,270
science becomes an admin if I remember
correctly have to check that I think

76
00:07:37,270 --> 00:07:42,180
that's true even for the latest version
the first user who signs up on an

77
00:07:42,180 --> 00:07:48,220
unauthenticated Jenkins instance becomes
a good some bad news you know somebody

78
00:07:48,220 --> 00:07:59,020
that bad no protection against brute
force attacks you can if you have a list

79
00:07:59,020 --> 00:08:04,090
of the user and Jenkins were distributed
to get you can literally brute force all

80
00:08:04,090 --> 00:08:10,520
of them and in my experience Jenkins
users or anything I do losers delight to

81
00:08:10,520 --> 00:08:17,250
have the same username and password I
mean if the user name is John the

82
00:08:17,250 --> 00:08:22,600
Apostle John as well so it's really
trivial to brute force again tried an

83
00:08:22,600 --> 00:08:29,840
evil will you have permission to do that
obviously ok other than that the second

84
00:08:29,840 --> 00:08:33,390
and third point together no protection
against boutros addicts no password

85
00:08:33,390 --> 00:08:35,598
complexity that's a recipe for disaster

86
00:08:35,599 --> 00:08:41,130
you do not enforce any password
complexity do not have any possible

87
00:08:41,130 --> 00:08:45,510
history no password policy for us the
security folks

88
00:08:45,510 --> 00:08:51,860
these things have been a min so common
that it's baffling to see that an

89
00:08:51,860 --> 00:08:58,150
industry to look and really go with that
and that one which is so popular and on

90
00:08:58,150 --> 00:09:02,790
Windows machines across system
privileges so who uses Windows Phone

91
00:09:02,790 --> 00:09:09,439
Jenkins server maybe some maybe not but
you will always find nodes or slaves on

92
00:09:09,440 --> 00:09:18,310
Windows machines because so many people
have lives origins of this stool on the

93
00:09:18,310 --> 00:09:23,579
machine that you got to have at least
ended twenty percent of Windows machines

94
00:09:23,580 --> 00:09:29,850
in a Jenkins distributed network and
Brad was in 15 mins ago it was like

95
00:09:29,850 --> 00:09:38,540
eight to 10 months back and any animus
user can see build-out port scan list

96
00:09:38,540 --> 00:09:44,339
users which are are present on the on
the Jenkins machine still if you if

97
00:09:44,340 --> 00:09:51,080
you'll see if you see the publicly
available instances of Jenkins the story

98
00:09:51,080 --> 00:09:55,230
is still the same even if the ability to
the latest versions they keep it the

99
00:09:55,230 --> 00:10:04,630
same for what reasons so there's a
reason why I listed these issues going

100
00:10:04,630 --> 00:10:08,820
to assume that because of these
wonderful security controls we are going

101
00:10:08,820 --> 00:10:13,910
to assume that we have an open access on
all of the CI tools if you think that

102
00:10:13,910 --> 00:10:21,900
this assumption is it something not good
when you can try on any of the machines

103
00:10:21,900 --> 00:10:26,470
will you have permission and it is
treatable to get access to any of this

104
00:10:26,470 --> 00:10:36,110
yet who's so yes this is a shocker for
us you know so I building bill steps so

105
00:10:36,110 --> 00:10:42,610
this is a genuine books if you have a
configuration access to any of the bill

106
00:10:42,610 --> 00:10:48,160
project and it is not a high privileged
access you can add build steps abilities

107
00:10:48,160 --> 00:10:53,059
that means when when the bill is started
our country guard

108
00:10:53,059 --> 00:10:58,589
is regarded as a bill step it could be a
shell command or Windows command or

109
00:10:58,589 --> 00:11:04,609
something like that are due to the
distributed nature of Jenkins it is

110
00:11:04,609 --> 00:11:10,659
possible to execute commands and scripts
on large number of slaves as as we saw

111
00:11:10,659 --> 00:11:18,249
in the network so this is how it will
see the live demonstrations as well you

112
00:11:18,249 --> 00:11:28,919
can see that honestly machine honestly
have access as a sister so what makes

113
00:11:28,919 --> 00:11:36,199
the CIT also a little more a bad in
terms of security is example in many

114
00:11:36,199 --> 00:11:42,008
councils industrial tools or management
consultants if you have access even

115
00:11:42,009 --> 00:11:47,949
admin access to have happen solid is
really not easy to achieve command

116
00:11:47,949 --> 00:11:51,419
execution was that is considered a
little bleeding in most of the cases

117
00:11:51,419 --> 00:11:57,419
that if you get access to weapons so you
can execute commands on the underlying

118
00:11:57,419 --> 00:12:03,899
operating system but that is not the
case with CI tooth so this is how

119
00:12:03,899 --> 00:12:13,929
country user can execute commands I'll
show that this is not an admin user to

120
00:12:13,929 --> 00:12:20,509
this was one part where we can build
steps on a slave but if you can add bill

121
00:12:20,509 --> 00:12:22,839
steps on master it is a disaster

122
00:12:22,839 --> 00:12:29,699
rhymes good if you can build steps on a
mosque is a disaster why because you can

123
00:12:29,699 --> 00:12:36,468
effectively remove all security on on
the Jenkins console if you can add up to

124
00:12:36,469 --> 00:12:42,909
marcia you just need to remove country
got expelled from the Jenkins or you can

125
00:12:42,909 --> 00:12:48,179
just remove all security by replacing
you security through the use of security

126
00:12:48,179 --> 00:12:55,779
files and how hard is that to do it it's
not really hard on on Linux machines it

127
00:12:55,779 --> 00:13:00,130
may be a bit tricky you'll always find
Jenkins

128
00:13:00,130 --> 00:13:05,400
instances running as root for non-native
is not optimal but an idea of the nose

129
00:13:05,400 --> 00:13:12,980
machines it's always possible thanks so
it's really screwed up actually that

130
00:13:12,980 --> 00:13:20,660
means if you have access you can
literally destroy the whole intellectual

131
00:13:20,660 --> 00:13:27,390
property scenario of an enterprise big
words but just tried out another thing

132
00:13:27,390 --> 00:13:33,420
with Jenkins the capability of storing
creations for example if you want to

133
00:13:33,420 --> 00:13:39,719
executable stem by logging into Linux
machine using SSH are you are storing

134
00:13:39,720 --> 00:13:46,910
some nations those credentials could be
retrieved the entry attacks but you must

135
00:13:46,910 --> 00:13:53,199
have the ability to and Bill steps on
master major again depends on the kind

136
00:13:53,200 --> 00:14:00,030
of contribution you are trying to rest
so passwords as such permit he's passed

137
00:14:00,030 --> 00:14:04,770
presses a button could be retrieved in
include tax and this is not my fault I

138
00:14:04,770 --> 00:14:16,650
have taken it from from this blog so
this is how it looks like so many do you

139
00:14:16,650 --> 00:14:23,990
need to read three files from the
defendants must the boston won its

140
00:14:23,990 --> 00:14:29,120
relations Droid X and the master key and
Hudson don't you did not see them not

141
00:14:29,120 --> 00:14:34,630
going to go into details of what went
wrong cryptographically because that is

142
00:14:34,630 --> 00:14:35,500
not my forte

143
00:14:35,500 --> 00:14:45,420
you can always read that blog now but
I'll show you how this works at Andy's

144
00:14:45,420 --> 00:14:53,120
for Jenkins some of the bad uses our
relations in pre-tax are so many times

145
00:14:53,120 --> 00:14:58,440
left in bill parameters if you just
can't have a look at the console output

146
00:14:58,440 --> 00:15:05,670
on build log in things you may step onto
some credentials all the time and

147
00:15:05,670 --> 00:15:12,560
sometimes sensitive files could be found
at this salon I was the Jenkins URL /

148
00:15:12,560 --> 00:15:18,930
User Content see capital and you may get
access to some of the sensitive things

149
00:15:18,930 --> 00:15:28,160
there is pleased tried them on your own
dress dashboard entitled Jenkins for

150
00:15:28,160 --> 00:15:35,060
thinking instances and entitle dashboard
Jenkins in tax manager dinkins for

151
00:15:35,060 --> 00:15:41,989
unauthenticated Argentine instances
which are available on the internet so I

152
00:15:41,990 --> 00:15:43,089
use at your own risk

153
00:15:43,089 --> 00:15:51,420
are you can always find sensitive keys
passengers access to databases good

154
00:15:51,420 --> 00:15:56,900
gracious and so many things and it's
really easy to use even if it is

155
00:15:56,900 --> 00:16:04,350
publicly expose or not the most
important thing I found on public

156
00:16:04,350 --> 00:16:09,580
assistance is was there someone left a
message on one of the publicly exposed

157
00:16:09,580 --> 00:16:15,320
not intended another individual instance
enable LogMeIn stage dashboard it can be

158
00:16:15,320 --> 00:16:23,150
found with that dog tracks it is still
there I check the morning so and this

159
00:16:23,150 --> 00:16:31,100
one was also not indicated public
instance running as root so that is also

160
00:16:31,100 --> 00:16:39,460
pretty screwed up by four Life
demonstrations he's made me feel some of

161
00:16:39,460 --> 00:16:50,250
them so I have Jenkins instance running
on one of the local machines

162
00:16:50,250 --> 00:16:55,150
this is how it generally looked for it
if you could try any of those Google

163
00:16:55,150 --> 00:17:01,329
Docs and promised not to do something
silly right now this is how it looked to

164
00:17:01,330 --> 00:17:09,579
these are new build projects here you
can see the list of users on this

165
00:17:09,579 --> 00:17:22,490
machine and these are the master and the
slave nodes are you have some of the

166
00:17:22,490 --> 00:17:27,930
projects which have the ability to be
executed on master and somewhat would be

167
00:17:27,930 --> 00:17:38,930
executed on a slave to let's begin with
command execution so as I said earlier

168
00:17:38,930 --> 00:17:43,090
because it is trivial to brute force in
to see I totally have to assume that we

169
00:17:43,090 --> 00:17:52,540
have a non admin access of a user which
has the ability to config built so that

170
00:17:52,540 --> 00:17:59,180
I have to assume again if it doesn't
look good just tried out on one of the

171
00:17:59,180 --> 00:18:09,550
machines have permission to do so let's
just try this exact so you can add a

172
00:18:09,550 --> 00:18:22,169
bill this is what we were talking about
which allows you to either executive in

173
00:18:22,170 --> 00:18:43,559
this batch command or a linux shell ok
let me

174
00:18:43,559 --> 00:19:03,049
if I just run a simple now you can see
that the executive legislative machine

175
00:19:03,049 --> 00:19:11,740
and I use this powerful option here
because if if your sleeve or executive

176
00:19:11,740 --> 00:19:15,580
is on Windows machine it is best if you
stick to PowerShell to do different

177
00:19:15,580 --> 00:19:23,460
things and if it is a Linux north of
course you are really good with Linux

178
00:19:23,460 --> 00:19:31,320
again tonight ambitious club can do a
lot of things so for example let's let's

179
00:19:31,320 --> 00:19:39,590
just try to why use PowerShell was no
now I'm going to get a little shell from

180
00:19:39,590 --> 00:19:44,740
that machine using only PowerShell and
that's pretty neat because we'll be able

181
00:19:44,740 --> 00:19:52,619
to get their emotional with system with
a single build lysistrata don't I'm

182
00:19:52,619 --> 00:20:03,740
going to use power which is an adequate
potent power shell of a useful tool

183
00:20:03,740 --> 00:21:38,410
and now I'm going to contribute and
change the bill step made included

184
00:21:38,410 --> 00:22:16,060
r going to these credentials to decrypt
these things

185
00:22:16,060 --> 00:22:38,590
let's see what we are

186
00:22:38,590 --> 00:22:45,260
trying to do here is this as you saw on
the screen trying to hit this 3 files

187
00:22:45,260 --> 00:22:53,629
are from from the master so in this case
the bill will run on Dunkin smarter so

188
00:22:53,630 --> 00:23:00,279
this is a proper configuration may help
you if this bill is this this project

189
00:23:00,279 --> 00:23:05,929
called eclipse relations is unable to
run on mastered in this attack will feel

190
00:23:05,929 --> 00:23:13,010
but unfortunately most of the times no
one cares where the ignition is taking

191
00:23:13,010 --> 00:23:19,590
place but if it was unable to execute on
the master this attack with bill so what

192
00:23:19,590 --> 00:23:24,539
we are doing here reading relations with
XML in Blaine in these two key files as

193
00:23:24,539 --> 00:23:30,899
pipes and then they will rebuild these
bites on on on on the attack us machine

194
00:23:30,899 --> 00:23:36,299
and then pass it on to the pipe under
grip script with which someone else

195
00:23:36,299 --> 00:24:18,418
wrote and will decrypt the creations

196
00:24:18,419 --> 00:24:34,330
and

197
00:24:34,330 --> 00:24:55,129
let me just see a text file called it's
always think

198
00:24:55,130 --> 00:25:01,350
and now he can use some of those simple
partial script I wrote or any simple

199
00:25:01,350 --> 00:25:34,939
Linux command to them back to keys

200
00:25:34,940 --> 00:25:53,520
which is

201
00:25:53,520 --> 00:26:08,060
is similarly we can I use the secret
into OT let's not do that I already have

202
00:26:08,060 --> 00:26:25,020
that on my on my colleague instance

203
00:26:25,020 --> 00:26:32,720
script we are going to use this one so
good to be positive to it is in the

204
00:26:32,720 --> 00:26:46,150
slide notes to task for the master key

205
00:26:46,150 --> 00:26:51,450
ask for the master key continued in
secret and credentials so let's provide

206
00:26:51,450 --> 00:26:59,440
those things we have master key this
thing and credentials for example Israel

207
00:26:59,440 --> 00:27:05,480
and you can see that it is really driven
to retrieve saved relations from Jenkins

208
00:27:05,480 --> 00:27:13,230
instance this is really bad I don't know
why the encrypted this way I think this

209
00:27:13,230 --> 00:27:18,010
is the worst thing almost all of the
demonstrations so it it's really bad

210
00:27:18,010 --> 00:27:26,560
that was for Jenkins now let's move to
Team city to city is again it is a CI

211
00:27:26,560 --> 00:27:32,139
tune from judge prince I think a German
company that is easy to set up and free

212
00:27:32,140 --> 00:27:38,310
for small and medium being so generous
it is widely used I think it's the 2nd

213
00:27:38,310 --> 00:27:44,080
to 5th AV County Public instances after
Jenkins this is the most widely used to

214
00:27:44,080 --> 00:27:50,129
it supports again different operating
systems all the demonstrations will be

215
00:27:50,130 --> 00:28:00,880
done on density 93705 nine which again
is the latest last month some of the

216
00:28:00,880 --> 00:28:06,160
security issues with TeamCity it allows
registration of new users by the fold

217
00:28:06,160 --> 00:28:13,010
and all the registered users get
privileges of a project to project is

218
00:28:13,010 --> 00:28:19,240
not really good privileges cannot
configure bills that's that's good but

219
00:28:19,240 --> 00:28:25,580
still you can see a lot of things you
can enrich users can see things about

220
00:28:25,580 --> 00:28:33,620
projects the executives attack again
does have a protection against poop

221
00:28:33,620 --> 00:28:37,979
force that's another good thing with
TeamCity but again no password

222
00:28:37,980 --> 00:28:44,700
complexity can use of incorrect apostles
it also like Denton said transferred

223
00:28:44,700 --> 00:28:50,720
system privileges on Windows machines
there'd be a master or slave again about

224
00:28:50,720 --> 00:28:52,310
being in tracked

225
00:28:52,310 --> 00:28:58,120
for them as well these things are common
to all of the CI tools it's like a pot

226
00:28:58,120 --> 00:29:05,929
that is why I selected a woman abuse set
for all these tools so again abusing

227
00:29:05,930 --> 00:29:16,300
bill step if a user has the ability to
add their steps which a project

228
00:29:16,300 --> 00:29:23,620
administrator can institute is not admin
on a high privilege in the city at this

229
00:29:23,620 --> 00:29:32,659
not not mean you can execute commands
and script on the master of the slaves

230
00:29:32,660 --> 00:29:38,410
depending upon the contribution to do
the distributed nature of things to do

231
00:29:38,410 --> 00:29:43,090
like the engines are you don't execute
things on a very large number of

232
00:29:43,090 --> 00:29:51,620
machines using that so you can see that
country user is a project admin and you

233
00:29:51,620 --> 00:29:56,820
can build steps because I am targeting
of innovation again so I'm heading a

234
00:29:56,820 --> 00:30:03,889
powershell will disturb their

235
00:30:03,890 --> 00:30:11,100
mastered in city has a concept called
superuser if you have the capability of

236
00:30:11,100 --> 00:30:17,570
executing commands by adding bill steps
on master you can read the superuser to

237
00:30:17,570 --> 00:30:23,149
confirm this file in cities of a dot law
that is one team city 914 today it was

238
00:30:23,150 --> 00:30:30,310
something similar to prevail documented
is nothing which iPhone so you can just

239
00:30:30,310 --> 00:30:36,929
read that talk on and on the login
prompt you can just use that to log in

240
00:30:36,930 --> 00:30:44,920
to log into team city as a super user
and a fun fact is if you must login five

241
00:30:44,920 --> 00:30:52,050
times on a team city login page you can
lock out this super user for 1 minute so

242
00:30:52,050 --> 00:30:59,830
due to a nice someone ought to run a
simple denial of service attack you can

243
00:30:59,830 --> 00:31:05,810
just write a script which tries to login
with username and password every one

244
00:31:05,810 --> 00:31:18,330
minute and that way you can just lock on
the superuser so this is how you did not

245
00:31:18,330 --> 00:31:24,929
log file and you will find the superuser
talkin in there just use it I think

246
00:31:24,930 --> 00:31:30,180
without a password on the login machine
and you'll be able to logon as superuser

247
00:31:30,180 --> 00:31:39,720
again this is extremely escalation
because I tools have different lengths

248
00:31:39,720 --> 00:31:44,730
sort of security controls this doesn't
look very bad but imagine this in

249
00:31:44,730 --> 00:31:50,570
regards with any other console of of
anything it is used to manage your

250
00:31:50,570 --> 00:31:55,639
hardware devices or your security
products if you can do this sort of

251
00:31:55,640 --> 00:32:07,520
extreme pollutants than that that's
really bad and yes I know it's he's not

252
00:32:07,520 --> 00:32:11,270
so super user

253
00:32:11,270 --> 00:32:17,889
is much more than admin so he can for
example reset admin passwords and all

254
00:32:17,890 --> 00:32:26,150
kind of stuff are you can also read SSH
keys from us again for some god forsaken

255
00:32:26,150 --> 00:32:32,490
reason they are stored in plain so you
can read if you can add a bill stepan

256
00:32:32,490 --> 00:32:38,550
master that is execute commands there
and read a set of keys are stored in

257
00:32:38,550 --> 00:32:48,629
with the city include a tax it's really
bad took this as an example of that as

258
00:32:48,630 --> 00:32:55,850
you can see that we are reading and this
other countries other contents of this

259
00:32:55,850 --> 00:33:07,830
release right now there are some more
issues in city gas log in could be able

260
00:33:07,830 --> 00:33:12,350
if you go to the publicly available
instances you will see that they are so

261
00:33:12,350 --> 00:33:18,189
many public consensus which allow a gas
log is this not really something special

262
00:33:18,190 --> 00:33:24,240
which you can do the gas but the
starting step of adding users for a

263
00:33:24,240 --> 00:33:30,930
brutal start from that place and one
special thing which have seen here is

264
00:33:30,930 --> 00:33:36,930
our King City allows bill parameters to
be of type password so that the

265
00:33:36,930 --> 00:33:42,420
passwords are not visible in pain I have
seen so many users using text as the

266
00:33:42,420 --> 00:33:49,400
bill so you can also find US forces file
if you have only dreamed capabilities

267
00:33:49,400 --> 00:33:55,580
Google Docs for him City entitle
projects clean city for all the public

268
00:33:55,580 --> 00:34:01,810
instances entitled released a new
content ready for instances which

269
00:34:01,810 --> 00:34:07,840
provide user registration and more toxic
and can always figure them out as well

270
00:34:07,840 --> 00:34:14,840
the intermission which I found with
teens he was even more mind-boggling the

271
00:34:14,840 --> 00:34:19,840
iPhone with Jenkins such things I wish I
could name the

272
00:34:19,840 --> 00:34:24,170
those corporations bring in your mind

273
00:34:24,170 --> 00:34:32,050
top of software developers in the world
and at least 45 leak things like these

274
00:34:32,050 --> 00:34:40,060
it's not visible but they're on the
above screenshot

275
00:34:40,060 --> 00:34:46,590
instantiating our test environment made
creations Edmond Edmond withdrawal admin

276
00:34:46,590 --> 00:34:56,010
username testimony without a test run
with no role there some new sort of

277
00:34:56,010 --> 00:35:03,500
management platform and this was the
address of that belongs in the big black

278
00:35:03,500 --> 00:35:10,700
box and the password for the this is
publicly available if you can try it and

279
00:35:10,700 --> 00:35:19,509
hear some very smart game development as
a password in in their blogs so these

280
00:35:19,510 --> 00:35:24,590
are the kind of things which you which
you get to see when you start engaging

281
00:35:24,590 --> 00:35:31,270
publicly available CI tools and this is
just an example just so many thinks if

282
00:35:31,270 --> 00:35:35,290
you have permission of doing these
things this these things would be should

283
00:35:35,290 --> 00:35:47,060
be your first thing to go for it in a
penetration test of a demo for the city

284
00:35:47,060 --> 00:35:59,569
so I think I have been sitting on this
machine as well

285
00:35:59,569 --> 00:36:13,369
you have to login as a non-political so
this is not a non-religious it's not on

286
00:36:13,369 --> 00:36:23,069
admin user of IT project administrator
rights so that it can build or run bills

287
00:36:23,069 --> 00:36:46,109
so

288
00:36:46,109 --> 00:37:02,980
so I did a built in what it does is
always executed and we can't swim i so

289
00:37:02,980 --> 00:37:08,319
nothing really need you can you can
always use our connect back list or

290
00:37:08,319 --> 00:37:24,180
whatever you want here and here in a
little demonstration will see that it is

291
00:37:24,180 --> 00:37:29,680
a bit hard pill to do little movement
with Jenkins because it starts

292
00:37:29,680 --> 00:37:35,470
PowerShell in a bit mode and some of the
moves I was trying to use they just

293
00:37:35,470 --> 00:37:54,069
don't run on 32 bit mode so it's better
if you have an executive city

294
00:37:54,070 --> 00:37:59,190
I would like to give props to I don't
want to name the guy from one of the

295
00:37:59,190 --> 00:38:05,820
developers and symbols for one of the
developers of go on when I was treating

296
00:38:05,820 --> 00:38:09,060
about the documentation is how the
document in the distance could be done

297
00:38:09,060 --> 00:38:15,360
and then even reviewed my slides and you
should assume that there should be some

298
00:38:15,360 --> 00:38:21,610
improvements in both teams city and go
because of this thing I didn't contact

299
00:38:21,610 --> 00:38:28,400
anyone because these are all documented
creatures design of a little bilities if

300
00:38:28,400 --> 00:38:40,740
you see the blog now again running as
systems of great need

301
00:38:40,740 --> 00:39:56,919
system is on on many machines using this
thing if you are using

302
00:39:56,920 --> 00:40:14,790
and as you can see that it says to login
as superuser use any an empty username

303
00:40:14,790 --> 00:40:30,170
and this as a password on the login page
will assist try that

304
00:40:30,170 --> 00:40:43,810
if you can execute if you can add bill
staffs Executive Master also has its a

305
00:40:43,810 --> 00:40:57,500
superuser so so many things you can do
with it

306
00:40:57,500 --> 00:41:09,600
let's see if we can read SSH keys in
playing

307
00:41:09,600 --> 00:41:23,520
so he's a store in be so there's a build
directory this part is it depends on

308
00:41:23,520 --> 00:41:27,450
your contribution you can read all these
things in the billions it looking at

309
00:41:27,450 --> 00:41:39,310
right now are / config projects the
project name project is a project like I

310
00:41:39,310 --> 00:41:59,578
said give you everything inside the
city's directory

311
00:41:59,579 --> 00:42:03,099
and if we see them

312
00:42:03,099 --> 00:42:16,030
considered the city was destroyed in
plain text it's really bad

313
00:42:16,030 --> 00:42:22,730
so that was it for you goal goal is not
the goal was scored 10

314
00:42:22,730 --> 00:42:29,530
associate summer by the guys from almost
there were also the those who created

315
00:42:29,530 --> 00:42:34,890
cruise control all the damage will be
done go 15 or 20 again

316
00:42:34,890 --> 00:42:42,020
latest environment back some of the
security issues again no indication in

317
00:42:42,020 --> 00:42:46,790
the default installation that sucks no
protection against brute force attacks

318
00:42:46,790 --> 00:42:54,000
no password complexity history any kind
of password policy for passwords wants

319
00:42:54,000 --> 00:43:00,650
with system privileges on Windows
machines again and again same thing they

320
00:43:00,650 --> 00:43:05,180
want they want highest privileges they
don't want to predict possible to

321
00:43:05,180 --> 00:43:13,359
discuss have no different authentication
again using the common abuse said let's

322
00:43:13,360 --> 00:43:20,890
see if we can build a step in goal if
you have a pipeline group administrator

323
00:43:20,890 --> 00:43:26,350
privilege but there's a non admin
privilege you can exist and build steps

324
00:43:26,350 --> 00:43:32,049
and execute commands on the underlying
operating system and yet again

325
00:43:32,050 --> 00:43:37,560
also supports and distributed building
Jenkinson team today to you get access

326
00:43:37,560 --> 00:43:45,190
to so many machines in an environment
that this is how we do it in go I assure

327
00:43:45,190 --> 00:43:52,480
you our democracy as well we just need
to add a custom command in the deployed

328
00:43:52,480 --> 00:43:57,230
Sharmarke read the new German ad and you
can't run commands

329
00:43:57,230 --> 00:44:07,030
if you have the ability to to add bill
steps on a project which can exhibit

330
00:44:07,030 --> 00:44:14,050
command master like Jenkins and remove
all the security on the go so again

331
00:44:14,050 --> 00:44:20,570
that's that's really bad so from a
normal user you can just job minus all

332
00:44:20,570 --> 00:44:26,710
the security configuration it was
implemented on the machine + bind with

333
00:44:26,710 --> 00:44:33,770
goal is they do not provide an agent or
executed on master by default Jenkins to

334
00:44:33,770 --> 00:44:41,070
provide that if you execute on the
master when installed TeamCity it asks

335
00:44:41,070 --> 00:44:45,820
from the same package if you want to
install a slave what an executive on the

336
00:44:45,820 --> 00:44:51,210
master you can but fall goal you have to
shoot yourself to do not provide them up

337
00:44:51,210 --> 00:44:56,380
and executed on the master by default
you have to install its separate package

338
00:44:56,380 --> 00:45:05,750
so that's a plus for them I know the
state of security for this route is so

339
00:45:05,750 --> 00:45:12,070
bad that we have to give marks to
someone who has no authentication enable

340
00:45:12,070 --> 00:45:22,550
individual contribution so this is how
we do it obviously in Linux as well you

341
00:45:22,550 --> 00:45:28,760
just need to remove the extra mile from
the home directory that's it and then

342
00:45:28,760 --> 00:45:36,060
you have to restart to go to the server
as well

343
00:45:36,060 --> 00:45:46,940
security from Jenkins hello and goodbye
to yesterday that really bad relations

344
00:45:46,940 --> 00:45:53,080
storage again the password file option
so go provides a possible option million

345
00:45:53,080 --> 00:45:59,230
you can create a password file and
provide its URL in the summer

346
00:45:59,230 --> 00:46:07,089
contribution part to use authentication
with the bad thing about that is that

347
00:46:07,089 --> 00:46:14,160
possible filed a class passes to me has
to buy a shower one with north wall and

348
00:46:14,160 --> 00:46:20,710
then their base 64 encoded so anyone can
and if you if you can get access to the

349
00:46:20,710 --> 00:46:27,140
file you can just use that sector 22
brutal spots for another interesting

350
00:46:27,140 --> 00:46:32,368
thing which I saw was not in the
documentation go provides an example of

351
00:46:32,369 --> 00:46:41,580
the password badger so that I for at
least five instances of possible by july

352
00:46:41,580 --> 00:46:49,890
is being used so that's good that's
really the trucks actually I mean ok and

353
00:46:49,890 --> 00:46:53,770
cities are also stored in clear text
when the days are use of it

354
00:46:53,770 --> 00:46:58,310
ability to contribute jobs on Monster
indeed the keys as well again that's

355
00:46:58,310 --> 00:47:47,660
just really bad but this administration
go in URL go admin that is not indicated

356
00:47:47,660 --> 00:47:55,170
access and entitle goal of art for
foreign instance which asks for a

357
00:47:55,170 --> 00:48:01,710
condition but not so many public
publically not individual instances can

358
00:48:01,710 --> 00:48:11,300
count on my fingers but still good to
have a feel of how things are ok so

359
00:48:11,300 --> 00:48:22,099
they're more for this thing

360
00:48:22,099 --> 00:48:55,290
those because

361
00:48:55,290 --> 00:49:35,930
this is how it looks like the previous
one

362
00:49:35,930 --> 00:49:54,270
actively but you can find more instances
of cruise control

363
00:49:54,270 --> 00:50:01,120
publicly have labeled and then go right
now and have no demonstration of this is

364
00:50:01,120 --> 00:50:06,540
no need of having a look at that it has
no indication by the fall there are two

365
00:50:06,540 --> 00:50:13,300
interesting URLs you may like to use the
UN dashboard and / cruise control

366
00:50:13,300 --> 00:50:19,780
commands could be executed by adding an
exact builder in this category so if you

367
00:50:19,780 --> 00:50:26,840
go to to cruise control instance you'll
understand how you can execute the

368
00:50:26,840 --> 00:50:31,830
command and you can see the public
instances using this Google dog entitled

369
00:50:31,830 --> 00:50:39,880
ode there so many of these instances
still available and not only

370
00:50:39,880 --> 00:50:43,410
university's most of the time since
chances are available only from

371
00:50:43,410 --> 00:50:47,649
universities are there some I don't know
what's this visit with the game

372
00:50:47,650 --> 00:50:53,640
development companies most of the time
said what are not indicated instances

373
00:50:53,640 --> 00:51:00,069
are four-game developing companies
sakina something I surely will but not

374
00:51:00,070 --> 00:51:06,990
obsolete ok so I demo for penetration
testing are you we are going to assume

375
00:51:06,990 --> 00:51:15,200
that we have intrigued user level access
to Jenkins or any other side will pick

376
00:51:15,200 --> 00:51:23,970
dinkins in this case and we have an
agent or somewhere we have an executor

377
00:51:23,970 --> 00:51:30,009
on Windows machines will use PowerShell
scripts to a new metal considerable on

378
00:51:30,010 --> 00:51:35,520
the machine will find a domain
administrator and use that if you think

379
00:51:35,520 --> 00:51:36,940
that this is very simple

380
00:51:36,940 --> 00:51:40,710
tried out in one of the environment for
you have permission you will be

381
00:51:40,710 --> 00:51:44,820
pleasantly surprised so

382
00:51:44,820 --> 00:51:54,720
let me quickly go through this

383
00:51:54,720 --> 00:52:05,000
so what we're going to do here now is
some I think the scripts are here I'm

384
00:52:05,000 --> 00:52:07,990
going to use involve talking
manipulation from the power plant

385
00:52:07,990 --> 00:52:13,399
project here I'm going to pull that
script executed a little made using this

386
00:52:13,400 --> 00:52:22,020
command and then I have configured
because it's my lab

387
00:52:22,020 --> 00:52:28,410
station processes running of the domain
admin it will use its talkin using this

388
00:52:28,410 --> 00:52:36,879
command and then who will run the dead
process PowerShell command on the domain

389
00:52:36,880 --> 00:52:58,880
controller my lab is that unfair no need
to run this right now it looks like just

390
00:52:58,880 --> 00:53:05,490
show you this decide looks like I boil
it down the script and security so you

391
00:53:05,490 --> 00:53:17,629
can see that we have the process I D 56
so then I again pulled down the script

392
00:53:17,630 --> 00:53:25,830
on a date and for the process I D 56 was
this I asked my script 22 embattled that

393
00:53:25,830 --> 00:53:32,970
and then executive process and Security
Command led get process on the domain

394
00:53:32,970 --> 00:53:41,540
controller and here's the result so it's
really not enough to end the cute or

395
00:53:41,540 --> 00:53:47,570
command to dominate mistreated you we
have you know that on the machine their

396
00:53:47,570 --> 00:53:52,859
own domain admin login as in that event
when there are 25 or 30 or 50 or even

397
00:53:52,859 --> 00:53:58,680
100 slaves running Windows there would
be at least one of the machines will

398
00:53:58,680 --> 00:53:59,310
illuminate

399
00:53:59,310 --> 00:54:08,259
leftist lookin so it's really
interesting in there so yes we have the

400
00:54:08,260 --> 00:54:13,020
domain admin privileges or let's quickly
talk about this

401
00:54:13,020 --> 00:54:18,540
uncivilized vulnerability in common
collections Java library this library is

402
00:54:18,540 --> 00:54:23,570
used by Jenkins that is controlled by
the guys who military must have seen

403
00:54:23,570 --> 00:54:29,050
this thing used intensity and go as well
but didn't have time or capabilities to

404
00:54:29,050 --> 00:54:38,030
develop and exploit for that Jenkins has
an emergency medication didn't check for

405
00:54:38,030 --> 00:54:42,070
past two days but prior to that there
was no pics only medication for that

406
00:54:42,070 --> 00:54:54,210
this blog post from close security which
which made this famous then the exploit

407
00:54:54,210 --> 00:55:10,580
days is picked up from there s these
from the slide in north to exploit this

408
00:55:10,580 --> 00:55:22,319
is really just do what I'm doing here is
I'm just using powershell shell and that

409
00:55:22,320 --> 00:55:28,580
is redirected to bail out and then I
used the extra from the guys from Fox

410
00:55:28,580 --> 00:55:34,509
close security to run it on my local
machine and got a connect back the only

411
00:55:34,510 --> 00:55:40,230
solace with this thing right now is he
needs to connect to hire port here you

412
00:55:40,230 --> 00:55:46,150
can see that 64 20 so on public
instances you may not be able to test

413
00:55:46,150 --> 00:55:51,230
this out but for Internet penetration
test this thing is going to be a friend

414
00:55:51,230 --> 00:56:00,700
for coming three to four years at least
ok so let's let's keep the demo common

415
00:56:00,700 --> 00:56:03,040
abuse set minimum security by the fall

416
00:56:03,040 --> 00:56:07,750
security controls such a common for the
two thousand missing like simple

417
00:56:07,750 --> 00:56:12,210
password policies so this is a common
abuse it for all the tools you have

418
00:56:12,210 --> 00:56:17,680
ability to run commands and script on
operating system even from non admin

419
00:56:17,680 --> 00:56:18,830
users

420
00:56:18,830 --> 00:56:26,279
system privileges of an agent is running
on mars to all the security is used less

421
00:56:26,280 --> 00:56:32,830
effectively in secure storage of
credentials as cities and there are so

422
00:56:32,830 --> 00:56:40,490
many instances of this truth by even the
bigger corporations hundreds dead it

423
00:56:40,490 --> 00:56:46,609
makes it really prone to abuse couple of
Defense slides no buildings and

424
00:56:46,609 --> 00:56:53,200
executive should run on the master ever
noble executor should run on the master

425
00:56:53,200 --> 00:56:58,330
ever normal exhibitor should run on the
master ever so that that is the the

426
00:56:58,330 --> 00:57:06,210
baseline and it's Rick privileges which
allow configuration of bill steps agents

427
00:57:06,210 --> 00:57:12,720
together for specific projects secure
the administrators dashboard should not

428
00:57:12,720 --> 00:57:18,410
be easily available and anyone anyone
should not be able to boutros into it

429
00:57:18,410 --> 00:57:25,899
expose RCI due to the internet only if
necessary I do not provide retail is to

430
00:57:25,900 --> 00:57:31,450
anonymous users they can individual
users and Rainbow sandal things ask

431
00:57:31,450 --> 00:57:37,470
users at least not to use their username
as possible this is really bad ass is

432
00:57:37,470 --> 00:57:47,520
this a lot of pain and force password
policies are you must install explicitly

433
00:57:47,520 --> 00:57:54,440
and mr Sutton of the installer show them
big bad warnings do not store location

434
00:57:54,440 --> 00:57:59,240
please include a tax on desk please
don't do that and assume that you loser

435
00:57:59,240 --> 00:58:04,830
sadness and do nothing about to get
ready and what others are doing their

436
00:58:04,830 --> 00:58:06,598
been interesting things

437
00:58:06,599 --> 00:58:12,270
Jenkins Lisa security advisory on 4th
October that they are not indicated

438
00:58:12,270 --> 00:58:17,750
public instances are being abused by
someone go to bed bound p

439
00:58:17,750 --> 00:58:23,559
because they smoke used to run an
unauthenticated Jenkinson stance

440
00:58:23,559 --> 00:58:28,479
and someone got really good really bad
because again

441
00:58:28,479 --> 00:58:34,009
Jenkins and this is all the previous
work you can you can just grab the

442
00:58:34,009 --> 00:58:41,180
slides and read it but I have not is
mustard agent communication so no MITM

443
00:58:41,180 --> 00:58:46,448
attacks are compromising the integrity
of the source code and the build process

444
00:58:46,449 --> 00:58:52,279
of application related by liberal tease
memory corruption bugs so if you want to

445
00:58:52,279 --> 00:58:58,959
do thoughts on these things you can
control these things out so to conclude

446
00:58:58,959 --> 00:59:04,410
CI tools like many many basic security
controls still paying attention to the

447
00:59:04,410 --> 00:59:11,288
configuration and contribute improperly
will reduce the tax office a lot and you

448
00:59:11,289 --> 00:59:15,660
do the distributed nature of the voting
compromise of you are your dashboard

449
00:59:15,660 --> 00:59:23,058
even the non admin privs resulting
access to a large number of machines and

450
00:59:23,059 --> 00:59:27,640
running a poorly configured CID is like
riding are ready to use baden it for

451
00:59:27,640 --> 00:59:34,900
anyone to exploit and now this may make
more sense and that is it

452
00:59:34,900 --> 00:59:35,749
questions

