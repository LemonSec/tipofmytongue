1
00:00:00,000 --> 00:00:04,470
hello how are you I hope that you're
doing very well today we are here to

2
00:00:04,470 --> 00:00:09,719
speak about last bus possible my nine
years and just take a look how they work

3
00:00:09,719 --> 00:00:21,020
and how can we take a bath of them did
it so every time we are now

4
00:00:21,020 --> 00:00:25,198
percent or south of the very beginning
here's my team vehicle is here with me

5
00:00:25,199 --> 00:00:35,149
his call for it and this is a picture of
me anyone can guess which computer this

6
00:00:35,149 --> 00:00:49,780
is 25 years ago and I'm strapped CBC 28
you're too old and that's me I don't

7
00:00:49,780 --> 00:00:57,190
have any computer there I'm Alberto I
work at Salesforce to we do like all the

8
00:00:57,190 --> 00:01:03,019
research we are starting a team kind of
products hero by a deadly with the very

9
00:01:03,020 --> 00:01:07,619
cool things on sale sort of anyone wants
to join us once more information we

10
00:01:07,619 --> 00:01:12,520
always hiring so just come to me with me
and we can Sarah Roman code some

11
00:01:12,520 --> 00:01:20,140
information and yeah this is leg last
bus is going to be our target today we

12
00:01:20,140 --> 00:01:24,680
want to tell you a little bit why we
start to like taking a class I used to

13
00:01:24,680 --> 00:01:30,329
work in their rent them out at Air Force
and we were seeing a lot of my chance

14
00:01:30,329 --> 00:01:35,720
that we compromise that there was like
information was that last bus like file

15
00:01:35,720 --> 00:01:41,380
last bus yeah but basically lost lives
in the system and we really wanted to

16
00:01:41,380 --> 00:01:45,429
get all the information from this
deposit money like you and we have to

17
00:01:45,430 --> 00:01:51,060
take notice that normally when you're
doing a writing exercise to have a lot

18
00:01:51,060 --> 00:01:55,310
of time when you are in a compromise
just have some minutes you have some

19
00:01:55,310 --> 00:02:00,329
specific time and every time you spend
in a compromise my team is one more time

20
00:02:00,329 --> 00:02:05,729
one more minute one more time that
actually detection have to cut you it's

21
00:02:05,729 --> 00:02:10,199
very important that we gonna get into
amity we would we need to be fast as

22
00:02:10,199 --> 00:02:13,339
fast as possible three collect all the
information we collect

23
00:02:13,340 --> 00:02:18,040
angels and move on so that's something
that we had in mind and actually I came

24
00:02:18,040 --> 00:02:21,440
to our team because we have like 10
percent of our time to the researchers

25
00:02:21,440 --> 00:02:25,160
have fun with a mighty let's take a look
at this because I think super

26
00:02:25,160 --> 00:02:31,450
interesting from a post exploitation you
so we got a couple of gin tonics and we

27
00:02:31,450 --> 00:02:38,268
start to look at it this is what we saw
a glass box is one of the most popular

28
00:02:38,269 --> 00:02:43,110
possible model year so we can see older
they have what they call the Enterprise

29
00:02:43,110 --> 00:02:48,049
Edition so that's very interesting from
an attacker perspective because you know

30
00:02:48,049 --> 00:02:53,680
that they are gonna it's gonna be using
large corporations rate target and the

31
00:02:53,680 --> 00:02:58,730
interesting thing here is that the last
bus not only a store spots words they

32
00:02:58,730 --> 00:03:04,709
start SSH keys their store credit cars
social security numbers private notes

33
00:03:04,709 --> 00:03:07,079
I've seen PDP

34
00:03:07,079 --> 00:03:14,890
last bus that's great so that's how
everything started so here we have the

35
00:03:14,890 --> 00:03:19,649
agenda what we're gonna trade what we
are gonna speak about the different

36
00:03:19,650 --> 00:03:23,799
approaches does we're gonna get one of
them to the first line is going to be

37
00:03:23,799 --> 00:03:29,299
the blue to black inside the client-side
the second one when I speak about is

38
00:03:29,299 --> 00:03:34,380
about what last US House what's the
information that they collect

39
00:03:34,380 --> 00:03:41,040
they have access to our passwords and at
the end of the target we will chance are

40
00:03:41,040 --> 00:03:45,780
our point of view to like an outsider
not being less by us not being in the

41
00:03:45,780 --> 00:03:52,370
client just being like someone out of
those two different environments so

42
00:03:52,370 --> 00:03:56,760
let's start like speaking about what
last bus claims what do they say that

43
00:03:56,760 --> 00:04:03,700
they do they have or they they are they
have like among other claims they have

44
00:04:03,700 --> 00:04:06,089
five that with things that are very
important

45
00:04:06,090 --> 00:04:12,700
the first one is that they used local
I'm secure encryption second one is that

46
00:04:12,700 --> 00:04:18,260
they securely encrypt the keys that are
used to encrypt and decrypt revolt was

47
00:04:18,260 --> 00:04:22,930
your passwords are their line is that
they use secure storage in the

48
00:04:22,930 --> 00:04:25,020
client-side K

49
00:04:25,020 --> 00:04:31,680
before very funny thing is that the
credit are white from memory so those

50
00:04:31,680 --> 00:04:38,060
memory-based attacks are not gonna be
useful in these cakes and last but not

51
00:04:38,060 --> 00:04:41,120
least last bus has no access to your
data

52
00:04:41,120 --> 00:04:47,240
this is very important i love you trust
third-party applications I'm very

53
00:04:47,240 --> 00:04:52,520
another trustee guy so I'm not gonna
give my passwords to anybody that's

54
00:04:52,520 --> 00:04:57,280
going to be the remaining my computer or
if I send my puzzles to somebody else I

55
00:04:57,280 --> 00:05:01,190
will send encrypted and I will never do
you think the key to the crib at Salt

56
00:05:01,190 --> 00:05:09,490
Creek the passwords so we will speak
about that so to prove all those claims

57
00:05:09,490 --> 00:05:16,620
that as half we started with a script
would wrote a script that basically by

58
00:05:16,620 --> 00:05:24,729
the way we are from Spain that iraq
sending so weird broken English man you

59
00:05:24,729 --> 00:05:32,280
know I tell you something to prepare but
he has a girlfriend I guess you do you

60
00:05:32,280 --> 00:05:38,359
have a girlfriend so she always says my
team if you lose your acts under Spanish

61
00:05:38,360 --> 00:05:44,430
accent I will definitely leave you that
true she always say like everything I

62
00:05:44,430 --> 00:05:48,580
like every Saturday or Sunday will go
out for some drinks to say the same

63
00:05:48,580 --> 00:05:56,849
anyway let's move back so yeah like to
verify those claims the last bus said we

64
00:05:56,849 --> 00:06:01,539
grow this this script that basically
just inject a while I after every

65
00:06:01,539 --> 00:06:06,710
function in the coat in the JavaScript
code let's get some me myself a script

66
00:06:06,710 --> 00:06:13,270
code what they used and it will give us
the chronological order from like every

67
00:06:13,270 --> 00:06:18,008
function I was called a not only that
but the parameter is the warlike pass to

68
00:06:18,009 --> 00:06:23,210
every functional Scott so basically we
just like you run this script inject

69
00:06:23,210 --> 00:06:29,580
those like those lines to give us the
instrumentation and we were able to see

70
00:06:29,580 --> 00:06:31,219
like okay when we love him

71
00:06:31,219 --> 00:06:34,770
this is hard to function as I've been
having cold so that like help us to

72
00:06:34,770 --> 00:06:38,430
understand all of those claims so I said
the first claim is that

73
00:06:38,430 --> 00:06:44,430
the use local a secure encryption and
they do that they use AES 256 to encrypt

74
00:06:44,430 --> 00:06:50,200
your credentials the things that they
used CBC and ECB mode as you may know he

75
00:06:50,200 --> 00:06:54,620
CBS not to burst the best thing the best
practice the use of a custom

76
00:06:54,620 --> 00:07:00,630
implementation but it's it's okay and
then to encrypt your key to create to

77
00:07:00,630 --> 00:07:06,640
the creator of all the world' our do you
speak ADF to they were using 500 rounds

78
00:07:06,640 --> 00:07:11,250
now they're using five thousand rounds
by default you can modify the value but

79
00:07:11,250 --> 00:07:14,380
it's actually not very important that
you modified because you can do enough

80
00:07:14,380 --> 00:07:19,900
on Ultra us and also asked worried to
last pass just sending your username and

81
00:07:19,900 --> 00:07:26,390
they will tell you this many rounds ok
it just like something interesting to

82
00:07:26,390 --> 00:07:33,620
say the you secure encryption keys
secure encryption the case so they used

83
00:07:33,620 --> 00:07:39,850
to be the number of iterations and they
use their username assault case the

84
00:07:39,850 --> 00:07:48,120
restricted to search about the output
value secure storage I mean the panacea

85
00:07:48,120 --> 00:07:54,110
they secure supposedly storage their
credentials in the client side in the

86
00:07:54,110 --> 00:07:57,910
pants if you're using the plugin version
or the binary version if you're using

87
00:07:57,910 --> 00:08:06,260
the plugin version they use SQLite files
or that are encrypted and are not driven

88
00:08:06,260 --> 00:08:11,060
either the user Escalade that a basis of
files just files depending on the

89
00:08:11,060 --> 00:08:16,380
browser Firefox for a sample that use
files all the time and there's another

90
00:08:16,380 --> 00:08:20,730
banner version that they use words like
platform-specific secure storage storage

91
00:08:20,730 --> 00:08:25,280
if you smack it's kind of interesting
because they use their attempt to

92
00:08:25,280 --> 00:08:29,030
restore disinformation so that's that's
more interesting in the win this very

93
00:08:29,030 --> 00:08:30,770
seriously

94
00:08:30,770 --> 00:08:36,600
the security I remember taking a trip to
protect and preserve protect API so it's

95
00:08:36,600 --> 00:08:42,430
not very useful yellow claim that we saw
is that there they wipe their

96
00:08:42,429 --> 00:08:47,880
credentials from memory so as soon as
you enter your master password ok the

97
00:08:47,880 --> 00:08:50,180
master password is the walkways

98
00:08:50,180 --> 00:08:55,599
use to login against last bus after
doing some some appliances Microsystems

99
00:08:55,600 --> 00:09:01,190
but they this is basically the code that
they are you saying they are stating the

100
00:09:01,190 --> 00:09:07,100
viable DMC possible to about affects
them doing that and JavaScript so

101
00:09:07,100 --> 00:09:11,730
supposedly the variables which a
possible recovery room everything will

102
00:09:11,730 --> 00:09:13,130
be great

103
00:09:13,130 --> 00:09:17,540
the thing is that we thought that
they've all decryption key recite always

104
00:09:17,540 --> 00:09:21,480
in memory and you will say okay that's
normal

105
00:09:21,480 --> 00:09:25,760
you need to create every time that you
are going to use a specific password for

106
00:09:25,760 --> 00:09:29,480
a specific site you need to the cryptic
obviously Alberto the decryption key

107
00:09:29,480 --> 00:09:35,529
needs to be memory to be used but here's
the thing is that they decrypt the whole

108
00:09:35,529 --> 00:09:41,010
vault with all your password at the
beginning so in memory with only half

109
00:09:41,010 --> 00:09:45,160
the decryption key for the vault where
all the pacifier encrypted but we have

110
00:09:45,160 --> 00:09:51,399
the password in clear text that makes no
sense to come pick up one out of two but

111
00:09:51,399 --> 00:09:55,310
not like Boston MA thinks if you don't
want to the printer password at the

112
00:09:55,310 --> 00:09:55,900
beginning

113
00:09:55,900 --> 00:10:00,380
memory perfect unique to have the
decryption key market memory but the

114
00:10:00,380 --> 00:10:02,870
view that trip everything at the
beginning why do you need to put some

115
00:10:02,870 --> 00:10:03,830
kid anymore

116
00:10:03,830 --> 00:10:14,270
ok and the last one the last claim is
the last facile access to your data and

117
00:10:14,270 --> 00:10:20,060
that's actually true they don't have
access to your and decrypted vault ok

118
00:10:20,060 --> 00:10:26,219
here we would do is that we encrypt the
client side we encrypt the vault and

119
00:10:26,220 --> 00:10:31,839
then we sent to last past the encryption
key but only with one more round of the

120
00:10:31,839 --> 00:10:38,680
pkg of 2 only one more round so we can
apply 5,000 rounds but that will be left

121
00:10:38,680 --> 00:10:43,660
in this class side but we see when we
saw the key to last bus we are only

122
00:10:43,660 --> 00:10:49,680
sending one more round so what enters to
the last bus server is only one around

123
00:10:49,680 --> 00:10:56,550
the pkg of 2 suppose they they apply
another extra and one hundred thousand

124
00:10:56,550 --> 00:11:02,490
rounds but it gets to their server it's
just one more round of Acadia

125
00:11:02,490 --> 00:11:08,850
so let's start with the attacks now and
we more or less understand how last post

126
00:11:08,850 --> 00:11:16,690
war we know what they claim less tried
to figure out how to jump evolved so the

127
00:11:16,690 --> 00:11:19,970
first one the first scenario for summer
demand is attacking the client-side

128
00:11:19,970 --> 00:11:22,180
let's go for it

129
00:11:22,180 --> 00:11:28,569
well as you as you know there is like a
master plus Damascus Bosworth arrived to

130
00:11:28,570 --> 00:11:34,570
then encrypt the boat with autocrat
shells so let's attack when the user

131
00:11:34,570 --> 00:11:39,440
remember password let's understand how
it works how it's like how your master

132
00:11:39,440 --> 00:11:44,740
password is encrypted in this unless
let's take advantage of that so the

133
00:11:44,740 --> 00:11:48,959
credit are stole a store locally if you
remember domestic violence abuse store

134
00:11:48,959 --> 00:11:53,589
locally you're not gonna send it to us
of course so depending on the browser as

135
00:11:53,589 --> 00:12:00,459
I said before it the credit must have
key gets password gets a store in files

136
00:12:00,459 --> 00:12:06,069
in Firefox impress the RGS or in the
rest of the browser to use like an

137
00:12:06,070 --> 00:12:13,510
SQLite database and the ECB RCBC
depending on the version of last year we

138
00:12:13,510 --> 00:12:20,209
did can feel like a table with different
browsers and OSS and where those files

139
00:12:20,209 --> 00:12:28,459
are stored present here we can see the
Escalade that a vase and they they save

140
00:12:28,459 --> 00:12:33,359
as you can see there's like username and
password password is encrypted and the

141
00:12:33,360 --> 00:12:37,500
username is clear text and of course you
can access to these data base without

142
00:12:37,500 --> 00:12:41,940
being brute the table itself the table
what it is it's called a space saved log

143
00:12:41,940 --> 00:12:50,360
in to infer from this is a story
impressed rafters yes with extension the

144
00:12:50,360 --> 00:12:57,839
last must log-in users extensions died
last bastard login password us so how it

145
00:12:57,839 --> 00:12:58,740
is encrypted

146
00:12:58,740 --> 00:13:03,850
we want to get the master possible how
it is encrypted basically they're using

147
00:13:03,850 --> 00:13:15,970
AES 256 the use a random maybe that's
correct and the key is 256 of you name

148
00:13:15,970 --> 00:13:22,240
it simply takes a juicy before so
basically and the data that's what we

149
00:13:22,240 --> 00:13:26,880
need to the crypt basically their story
in the key and they are starting their

150
00:13:26,880 --> 00:13:33,560
scripted blob just together it's pretty
straightforward just the crypt in it and

151
00:13:33,560 --> 00:13:38,239
we will get the master bustle and that
that's it we get the master password we

152
00:13:38,240 --> 00:13:41,870
can use it to excessive old and access
of course all the Q's stores in the

153
00:13:41,870 --> 00:13:51,510
vault yeah so we we publish their
martine did that's their

154
00:13:51,510 --> 00:13:59,950
the status of his blog look at him
absolutely and then we palace he

155
00:13:59,950 --> 00:14:00,830
probably is this

156
00:14:00,830 --> 00:14:07,190
yeah he published it and like he got
like a lot of assets so that's when we

157
00:14:07,190 --> 00:14:11,570
were supposed to stop this research was
more research on the 40 specific plan

158
00:14:11,570 --> 00:14:16,950
test ok we got it we lose everything we
want to come over but then with all this

159
00:14:16,950 --> 00:14:21,540
in a way that people was interesting
last bus and ran his 1 I'm gonna

160
00:14:21,540 --> 00:14:30,349
chances in my eyes

161
00:14:30,350 --> 00:14:33,880
iraq yeah this was interesting because
we just did that for the pentose right

162
00:14:33,880 --> 00:14:39,089
with the 10% of the research we have a
10 source and he was it was really cool

163
00:14:39,089 --> 00:14:42,160
because suddenly on that said he was

164
00:14:42,160 --> 00:14:48,009
number one and all that sort of feedback
lot of of good feedback but feel but

165
00:14:48,009 --> 00:14:51,670
basically what we got from it is that
the community was very interesting

166
00:14:51,670 --> 00:14:55,979
understanding last pass and they were
all she could do with it so maybe it's

167
00:14:55,980 --> 00:15:00,470
worth just investing more time on it and
looking for that is more threats to it

168
00:15:00,470 --> 00:15:05,220
and share it with the community so the
first thing obviously I know what you

169
00:15:05,220 --> 00:15:09,170
guys are sinking and was gonna clear
remember passwords and I asked last

170
00:15:09,170 --> 00:15:13,509
person a lot of people that the first
thing was just don't just offer that

171
00:15:13,509 --> 00:15:20,699
option right and yeah it's actually a
lot of people that so I was saying oh

172
00:15:20,699 --> 00:15:24,139
yeah I have here so the first thing we
did was like ok let's do the classic

173
00:15:24,139 --> 00:15:27,490
right let's see what we get with the
cookies bad it's interesting because in

174
00:15:27,490 --> 00:15:28,360
LastPass

175
00:15:28,360 --> 00:15:31,680
Lucas are gonna get you basically why
last bus has and will last past houses

176
00:15:31,680 --> 00:15:35,979
supposedly not to be anything that you
can use to the crib the world so that

177
00:15:35,980 --> 00:15:39,399
was an interest in seeing so we actually
have to invest a little more time to see

178
00:15:39,399 --> 00:15:42,509
if we could do something with the
cookies and when it turns out is that

179
00:15:42,509 --> 00:15:47,139
the ball decryption key devoted
Christian Keyes the key that is derived

180
00:15:47,139 --> 00:15:50,980
from the master password used to decrypt
the vote is going to get a little bit we

181
00:15:50,980 --> 00:15:56,670
are all the corruption case during your
machine locally and class pass has the

182
00:15:56,670 --> 00:16:01,370
decryption key so when you sent over the
cookies they send you the decryption key

183
00:16:01,370 --> 00:16:07,819
you'll arrive well and they send you a
talking let's colleges there i think i

184
00:16:07,819 --> 00:16:12,699
shud 256 and you're the crib euro
locally and this is why when you restart

185
00:16:12,699 --> 00:16:16,550
your machine and opened a browser
automatically locks in again you never

186
00:16:16,550 --> 00:16:20,620
enter your credentials if last post I
still have them they can do they can

187
00:16:20,620 --> 00:16:26,350
direct the key but this is how we're
actually works so just to get out to be

188
00:16:26,350 --> 00:16:31,339
what I mentioned before you basically
impossible quest to track and you will

189
00:16:31,339 --> 00:16:32,170
pass your

190
00:16:32,170 --> 00:16:38,260
your session and it returns this
parameter that is they PWD key and they

191
00:16:38,260 --> 00:16:41,939
use a shot to fifty six to eight and I
will be your description and that's what

192
00:16:41,940 --> 00:16:46,810
we said before it was in their data base
the key to decrypt it and you got it

193
00:16:46,810 --> 00:16:52,268
awesome so that cookie cutters staff so
that was that was pretty cool but we

194
00:16:52,269 --> 00:16:57,320
still had more challenges right because
what we find is that if you have two

195
00:16:57,320 --> 00:17:03,240
factor authentication is not going to
work so we had to deal with that too so

196
00:17:03,240 --> 00:17:07,189
the next step was to understand how two
factor authentication works and this is

197
00:17:07,189 --> 00:17:11,089
how it looks like we never asked how
many last bus users are here for you

198
00:17:11,089 --> 00:17:15,280
guys raise your hand just to get an idea
that would be about five I don't believe

199
00:17:15,280 --> 00:17:19,839
that but okay and they're so they should
put a lot of two-factor authentication

200
00:17:19,839 --> 00:17:25,409
measures Google ought to be key to 40
lots of them so the first thing we did

201
00:17:25,410 --> 00:17:30,140
is we looked at the network traffic and
we didn't see any trusted Google which

202
00:17:30,140 --> 00:17:33,720
was pretty interesting show was to
tamper with a parameter soon realize

203
00:17:33,720 --> 00:17:39,260
that they want that we had to remove in
order to be prompted for two-factor was

204
00:17:39,260 --> 00:17:45,520
UUID so you are you actually the trusted
talking so how is the generator we

205
00:17:45,520 --> 00:17:48,610
wanted to understand first maybe we
could generative and they actually do

206
00:17:48,610 --> 00:17:52,750
something smart they basically reduced
to function they have to generate random

207
00:17:52,750 --> 00:17:56,520
passwords the whys that ok generate a
random password for me for this website

208
00:17:56,520 --> 00:18:01,830
put it on the ball today just reuse that
so basically they trusted talking it's a

209
00:18:01,830 --> 00:18:07,860
32 characters is basically a password
and it's it's generated at installation

210
00:18:07,860 --> 00:18:14,299
time isolation time from the plugging
and air so we're starting plain text for

211
00:18:14,299 --> 00:18:18,790
Firefox again its case it's starting out
as UID

212
00:18:18,790 --> 00:18:21,629
for the rest of the brown says she's
again I loco

213
00:18:21,630 --> 00:18:27,160
in this case it's a local storage now
this thing is why are we telling you all

214
00:18:27,160 --> 00:18:32,270
this in reality there is some problems
with this design right now said that

215
00:18:32,270 --> 00:18:38,540
encrypts here and not a pedo as UAB is
not encrypted either descent talking

216
00:18:38,540 --> 00:18:42,879
issues for older browser user so if you
have your corporate account do you have

217
00:18:42,880 --> 00:18:48,130
your personal accounting last post
something we do you'll have to send

218
00:18:48,130 --> 00:18:52,690
trusted talkin to me is that there is a
fixed talk until the plugging spring

219
00:18:52,690 --> 00:18:56,730
styles and that's how a lot of
consequences because if you can trust

220
00:18:56,730 --> 00:19:01,720
that process say because whatever you
thought it was compromised or whatever

221
00:19:01,720 --> 00:19:05,850
has no real effect because it's still
gonna be that talk and that is going to

222
00:19:05,850 --> 00:19:11,709
be someone you actually activated again
in fact if you generate a new pure color

223
00:19:11,710 --> 00:19:14,890
because you're too affair was
compromised system gonna be the same

224
00:19:14,890 --> 00:19:20,710
that that says actually an attacker
could set it for you before you

225
00:19:20,710 --> 00:19:24,530
activated when they when you when the
victim activated its gonna send they

226
00:19:24,530 --> 00:19:27,399
were set by the attacker but that's not
really interesting the interesting thing

227
00:19:27,400 --> 00:19:33,220
is we can proactively still the trusted
talking compromise smashing we get that

228
00:19:33,220 --> 00:19:37,530
stuff and the victim realizes it and
says okay you should you should have

229
00:19:37,530 --> 00:19:39,600
activated to attract ok I'm going to do
that now

230
00:19:39,600 --> 00:19:42,659
doesn't matter we already have to
talking to you the problem of not using

231
00:19:42,660 --> 00:19:49,670
trusted cookies in do this this kinda
descended they came up with so awesome

232
00:19:49,670 --> 00:19:53,030
so we gotta now we know how to get
credentials we know how to use the

233
00:19:53,030 --> 00:20:00,560
cookie to to the world we know how to do
two factor authentication but we still

234
00:20:00,560 --> 00:20:05,230
have the problem that you cannot be used
to cook as it is an active session if

235
00:20:05,230 --> 00:20:10,820
the user logs out that that is not valid
anymore so you can't retrieve the key to

236
00:20:10,820 --> 00:20:17,899
their decryption key to decrypt the vote
that is encrypted in your machine so we

237
00:20:17,900 --> 00:20:22,980
wanted basically to find the silver
bullet something that will allow us to

238
00:20:22,980 --> 00:20:26,710
in the client side to be able to the
crib the ball to get the encryption key

239
00:20:26,710 --> 00:20:29,840
and the crib the world no matter if you
don't have

240
00:20:29,840 --> 00:20:34,059
active session no matter if you don't
have to have a no matter if they're

241
00:20:34,059 --> 00:20:38,610
they're usually thinks there is still
the restored the credentials awesome so

242
00:20:38,610 --> 00:20:40,740
we we we we show that right

243
00:20:40,740 --> 00:20:44,640
account recovery and the first thing was
how is that even possible because she

244
00:20:44,640 --> 00:20:50,330
flashed by encryption key I forgot my
password I don't have my encryption key

245
00:20:50,330 --> 00:20:54,610
how how are you going to recover the
vault so it's actually as easy as 123

246
00:20:54,610 --> 00:21:00,590
first you do you go to last post /
recovering you enter your email and when

247
00:21:00,590 --> 00:21:05,139
you do that you will get our unique link
that's pretty straightforward basically

248
00:21:05,140 --> 00:21:09,630
how everyone that you click on the link
and it redirects you to these real nice

249
00:21:09,630 --> 00:21:13,899
page with a big red button that says
fresh to recover we were like ok can be

250
00:21:13,899 --> 00:21:17,320
daddy so we clicked on it and it was
that easy so many that count was

251
00:21:17,320 --> 00:21:23,570
recovered we have full unrestricted
access to the wall to our vault and we

252
00:21:23,570 --> 00:21:26,720
could set a new password but we then had
to which will start its funny because

253
00:21:26,720 --> 00:21:30,220
why would you recover your account it's
because you forgot your password

254
00:21:30,220 --> 00:21:35,700
you should set a new password and we
won't have prompted for to advance so we

255
00:21:35,700 --> 00:21:39,770
really wanted to understand how this
works because I never entered my master

256
00:21:39,770 --> 00:21:44,039
password I never do anything like that
and I still could have full access to my

257
00:21:44,039 --> 00:21:50,260
bolt and this is how it looks from the
moment you click the link that you click

258
00:21:50,260 --> 00:21:56,049
on the email you basically get this
request that returns with real chill 302

259
00:21:56,049 --> 00:22:00,020
redirects you to show you around a
contest for parameter is that we will

260
00:22:00,020 --> 00:22:04,980
talk about later but it's basically time
time has user and user name and then we

261
00:22:04,980 --> 00:22:09,010
will you say and then

262
00:22:09,010 --> 00:22:12,629
you get to that really nice page was the
right part and when you click on an

263
00:22:12,630 --> 00:22:19,890
apostle requests to dr. PHP we show only
one parameter that is harsh and every

264
00:22:19,890 --> 00:22:23,880
tongue tied up but the interesting
parameter that his friend key so let's

265
00:22:23,880 --> 00:22:28,910
dive into it first thing we wanted to
see if i dont need access to to the

266
00:22:28,910 --> 00:22:34,450
victims email right can I generate a URL
that's real to you are out so we looked

267
00:22:34,450 --> 00:22:37,970
at the parameter turns out time is the
time to time when the recovery was

268
00:22:37,970 --> 00:22:38,910
initiated

269
00:22:38,910 --> 00:22:50,520
basically when you set your email and
clicked the time has closed so what was

270
00:22:50,520 --> 00:22:55,290
the challenges here so we needed a body
timestamp run that was not easy because

271
00:22:55,290 --> 00:23:00,320
you actually have to hash it as well so
not only how do you have to get the

272
00:23:00,320 --> 00:23:06,370
right one but you have to have a swell
so important that we needed assault so

273
00:23:06,370 --> 00:23:13,270
we said ok let's start our own account
recovery and reuse our hashes on the

274
00:23:13,270 --> 00:23:18,600
victim 09 it actually worked which tells
us a couple things the same solved

275
00:23:18,600 --> 00:23:24,000
issues for all uses basically I started
my own recovery and I basically took

276
00:23:24,000 --> 00:23:27,960
that stance time with that tramp stamp /
pasted it into victims who were rallying

277
00:23:27,960 --> 00:23:33,260
at work so I already had about eight
times that I noticed in Douglas

278
00:23:33,260 --> 00:23:35,980
interesting is that the link doesn't
really expire

279
00:23:35,980 --> 00:23:39,980
the only thing that happens is that the
timestamp is validated against the tax

280
00:23:39,980 --> 00:23:40,420
time

281
00:23:40,420 --> 00:23:45,180
cash but it's it's not that they have
server-side something like it has been

282
00:23:45,180 --> 00:23:51,330
more than two hours for this and there
was no need to start account recovery so

283
00:23:51,330 --> 00:23:55,510
there was an unlikely recovery we have
died in the service I would know about

284
00:23:55,510 --> 00:24:02,160
it if you have a complaint that sold but
we still needed assault because we had

285
00:24:02,160 --> 00:24:06,470
two tanks that we had to stanch time had
we had the username bye week the user

286
00:24:06,470 --> 00:24:10,730
name of the victim so there was a
problem so basically the secret what we

287
00:24:10,730 --> 00:24:15,980
were missing is the global song is just
interesting that shots had not meant to

288
00:24:15,980 --> 00:24:17,159
be secret they are only

289
00:24:17,159 --> 00:24:22,899
need to be run them secure so when we
moved on to their to the query from when

290
00:24:22,899 --> 00:24:28,158
you click from the request from when you
play a game and press to recover and

291
00:24:28,159 --> 00:24:33,749
that only have one parameter which is so
we looked into it we use say they're the

292
00:24:33,749 --> 00:24:38,869
Python script and we saw that he was
paid their eyes to disable one-time

293
00:24:38,869 --> 00:24:43,689
password and it turns out that's what
types of one of them is the one you

294
00:24:43,690 --> 00:24:48,460
basically are aware of which is the one
you you basically print out and use to

295
00:24:48,460 --> 00:24:52,700
logging in and trusted machine it's only
valid for one but then they have the

296
00:24:52,700 --> 00:24:56,759
disabled one-time password from now on
we're gonna call it the OTP because

297
00:24:56,759 --> 00:25:02,749
gonna get a little confusing ok said the
OTP is used to recover your fault which

298
00:25:02,749 --> 00:25:05,489
in reality means for syndication

299
00:25:05,489 --> 00:25:09,549
it's not get the ball encryption key of
course if not that would be super easy

300
00:25:09,549 --> 00:25:12,029
but the most important thing here

301
00:25:12,029 --> 00:25:15,659
respect to their other attacks that we
that we percent it is that it said there

302
00:25:15,659 --> 00:25:19,970
by default so what we're doing stand-up
lagging you logging its set there by

303
00:25:19,970 --> 00:25:20,549
default

304
00:25:20,549 --> 00:25:25,989
locally ok cool so and when is it
starting house gang its complaint

305
00:25:25,989 --> 00:25:31,919
texting Firefox is in this shut with
your username underscored of affairs in

306
00:25:31,919 --> 00:25:36,259
the rest of the process again is an ad
that amazed that no root needed in clear

307
00:25:36,259 --> 00:25:41,979
text so how is actually the request for
each so we looked at the Tom we looked

308
00:25:41,979 --> 00:25:46,389
at the JavaScript of when you click the
button and basically gets injected by

309
00:25:46,389 --> 00:25:50,899
the Planning into the DOM English pass
and that's how it sent when you click

310
00:25:50,899 --> 00:25:58,228
the bottom awesome so how do we get from
their December one-time passwords stored

311
00:25:58,229 --> 00:26:02,739
locally on your machine in clear text to
the vault which is what we really want

312
00:26:02,739 --> 00:26:07,649
to know so basically the planning us to
local storage ok give me a one-time

313
00:26:07,649 --> 00:26:13,629
password that you have then what he does
is a shared 256 of a shot of 56 of the

314
00:26:13,629 --> 00:26:20,158
username + thereby disabled one-time
password is kinda like a man's age Mac

315
00:26:20,159 --> 00:26:23,380
and you start talking as an
authentication

316
00:26:23,380 --> 00:26:28,680
so we will send up talking together with
your name and then you get a violet

317
00:26:28,680 --> 00:26:32,480
session and together with the valley
session you get another parameter that

318
00:26:32,480 --> 00:26:36,980
is called around key and the next
request which CiCi's retrieves all the

319
00:26:36,980 --> 00:26:42,200
encrypted or from last pass and you get
it locally as well so the question here

320
00:26:42,200 --> 00:26:48,660
is why this round key so now that we got
Randy from last bus is not yet the bolt

321
00:26:48,660 --> 00:26:56,400
encryption TKIP encryption key encrypted
so how do with the cryptid so it's

322
00:26:56,400 --> 00:27:03,200
actually encryption AES 256 CBC Davis
random and the key basically the secret

323
00:27:03,200 --> 00:27:07,690
to the crib your old kid that allows
pets house is the disabled one-time

324
00:27:07,690 --> 00:27:13,740
password so you just do a shot 256 of
that and you can decrypt it again what

325
00:27:13,740 --> 00:27:19,300
is a one-time password is actually a
master password on steroids because you

326
00:27:19,300 --> 00:27:24,470
can use it to authenticate you can use
it to obtain the vault key encrypted but

327
00:27:24,470 --> 00:27:27,630
you can use it to the crypt that's well

328
00:27:27,630 --> 00:27:33,240
bypasses restrictions from the test with
some time ago it bypasses to a friend

329
00:27:33,240 --> 00:27:39,410
and its store locally by default which
is the real cool thing here and the

330
00:27:39,410 --> 00:27:44,240
world we actually turns out we have been
locally as well and critical in this

331
00:27:44,240 --> 00:27:48,700
format again in in in Firefox is in a
specific file for the rest of the

332
00:27:48,700 --> 00:27:55,610
browser's basically encoding base 64
that the encrypted so that's awesome

333
00:27:55,610 --> 00:28:00,990
because now we are able to get
encryption keys in all cases no matter

334
00:28:00,990 --> 00:28:04,740
if you have active sessions master
passwords whatever is just there by

335
00:28:04,740 --> 00:28:08,290
default and we can use it we know how to
retrieve it we know how to the right

336
00:28:08,290 --> 00:28:16,790
encryption key and we know how to the
credits so that is really cool I told

337
00:28:16,790 --> 00:28:18,690
you not to swear

338
00:28:18,690 --> 00:28:23,990
conclusions we know how to get the
credentials in their eyes them from the

339
00:28:23,990 --> 00:28:28,860
vault we know how to use a disabled
one-time passwords to obtain and decrypt

340
00:28:28,860 --> 00:28:34,429
the board keep a widow with encrypted
vote days we understand the format and

341
00:28:34,430 --> 00:28:38,700
we know how to decrypt it so we can
print all the passwords out so that was

342
00:28:38,700 --> 00:28:46,580
really cool awesome and actually Alberto
so we told you a lot of stuff and we saw

343
00:28:46,580 --> 00:28:51,040
it ok if if we have all this week we
contribute back to their to their

344
00:28:51,040 --> 00:28:57,440
community and actually especially to
Penn testers and so we won't let us play

345
00:28:57,440 --> 00:29:26,020
flagging a post expectations I'm not
going to tell you ok so it will be very

346
00:29:26,020 --> 00:29:30,220
easy for anybody to use it to when
they're doing a fantastic they are doing

347
00:29:30,220 --> 00:29:31,900
a Breton exercise

348
00:29:31,900 --> 00:29:37,140
access to their their credentials using
all the techniques we spoke about before

349
00:29:37,140 --> 00:29:53,990
to retrieve the credentials from there
from the vault

350
00:29:53,990 --> 00:30:10,230
basically it's a steal the to a fatal
can even if the user that have it

351
00:30:10,230 --> 00:30:17,150
activated we proactively still that so
the user in the future activated we are

352
00:30:17,150 --> 00:30:22,860
in we are still in it is still on the
rise the encryption key so you will not

353
00:30:22,860 --> 00:30:27,750
only did the actual plant a script by
the decryption key for the vault

354
00:30:27,750 --> 00:30:32,000
the crips the vote of course in Prince
print all the passwords that you haven't

355
00:30:32,000 --> 00:30:37,270
called I need support of the old those
different OS is Windows Mac Linux and

356
00:30:37,270 --> 00:30:45,110
those 44 browsers we are famous and the
integration with Internet Explorer to

357
00:30:45,110 --> 00:30:50,490
steal Internet Explorer ball to of
course we can use it for Metasploit a

358
00:30:50,490 --> 00:31:05,210
nice move to you sir

359
00:31:05,210 --> 00:31:12,090
so basically this is a victim he this is
Donald Trump an iView you know him

360
00:31:12,090 --> 00:31:17,840
tonight I will live in San Francisco
it's it's every day every day in the

361
00:31:17,840 --> 00:31:23,540
news so here we have a radius time
session opened I mean we're not we're

362
00:31:23,540 --> 00:31:27,490
not gonna get and how did you get access
to a machine that supposed to fruition

363
00:31:27,490 --> 00:31:38,150
model does something to you he has two
accounts right he has his own personal

364
00:31:38,150 --> 00:31:49,490
account and his girlfriend use the
machines second Windows account with

365
00:31:49,490 --> 00:31:51,779
friends last

366
00:31:51,779 --> 00:32:02,639
the only thing we need to said his
accession no matter whether session we

367
00:32:02,639 --> 00:32:12,738
we want to ruin this model against india
sail but very very straightforward or

368
00:32:12,739 --> 00:32:35,089
less on my toes fingers get into surgery
yesterday

369
00:32:35,089 --> 00:32:50,759
ok

370
00:32:50,759 --> 00:33:18,009
credentials from the master blaster ok
so we couldn't get the master possible

371
00:33:18,009 --> 00:33:23,309
but we could get the actual to affair
and the key to the christian Adams here

372
00:33:23,309 --> 00:33:41,168
we have another account

373
00:33:41,169 --> 00:33:51,129
we were able to remember so with the
cryptid and the same scene as you can

374
00:33:51,129 --> 00:33:56,589
see the two phases same for both counts
here and the other side as a different

375
00:33:56,589 --> 00:34:02,428
user that's the girlfriend of Donald
Trump and we couldn't get past were

376
00:34:02,429 --> 00:34:25,918
either but we were able to get to the
creation and cure Dahir

377
00:34:25,918 --> 00:34:40,480
the username and password like the same
that's your surname impossible here here

378
00:34:40,480 --> 00:34:47,819
we can do it with a date for the
personal crimes account for parade trams

379
00:34:47,819 --> 00:34:50,418
account

380
00:34:50,418 --> 00:35:09,140
I here we can see all the information
for the different accounts so it worked

381
00:35:09,140 --> 00:35:29,759
ok you're going to make me want to
conventional the good thing about this

382
00:35:29,760 --> 00:35:34,240
did you get into my tenure on display
and you get everything right away that

383
00:35:34,240 --> 00:35:37,720
something very useful when you're doing
a threat to my exercise because normally

384
00:35:37,720 --> 00:35:50,700
the blue team is there looking at you
trying to to get to so yeah let me go

385
00:35:50,700 --> 00:35:54,980
back two days one so what we're going to
do now is let's move on from their

386
00:35:54,980 --> 00:36:01,069
clients out attacks ok so now what we
want to see is a lot I don't want your

387
00:36:01,069 --> 00:36:07,410
close to me so now we know we moved on
from there from the client I will show

388
00:36:07,410 --> 00:36:12,240
you some different attacks we leave we
show you the model so now it's time to

389
00:36:12,240 --> 00:36:17,328
move on so it now we wanted to
understand what are the risks if last

390
00:36:17,329 --> 00:36:18,240
bus will be there

391
00:36:18,240 --> 00:36:24,508
the attacker which is not the case but
truth is that they had a bridge couple

392
00:36:24,509 --> 00:36:29,710
months ago showed a package can be on
last bus site and in addition we also

393
00:36:29,710 --> 00:36:33,329
have other things like an essay or
whatever they could try to force

394
00:36:33,329 --> 00:36:38,999
last pass to give some of your antenna
so we really wanted to understand what

395
00:36:38,999 --> 00:36:43,200
is said that with the information that
is on last bus service you can do which

396
00:36:43,200 --> 00:36:48,419
is in the end the the goal of this
business that they can do anything and

397
00:36:48,420 --> 00:36:55,670
there are some attacked so it's time to
get paranoid ok we r LastPass so let's

398
00:36:55,670 --> 00:36:59,549
get paranoid here and we brought here by
where I would have had this is very

399
00:36:59,549 --> 00:37:03,069
important when you want to get
professionally paranoid and we got some

400
00:37:03,069 --> 00:37:15,680
for you if you wanna put them there but
it is paranoid mode okay awesome we r

401
00:37:15,680 --> 00:37:19,788
last pass on the last bus service where
there's something like that

402
00:37:19,789 --> 00:37:29,359
ok so the first thing we wanted to see
his like okay let's look at what the /

403
00:37:29,359 --> 00:37:34,769
perceived reality already mentioned that
in order to the right your your

404
00:37:34,769 --> 00:37:40,049
encryption key your gold key from your a
dick spoke wrenches the USA PKD of two

405
00:37:40,049 --> 00:37:45,459
with 5,000 run right so you get your
encryption key and then what they only

406
00:37:45,459 --> 00:37:48,448
do apply an extra round reader
encryption key

407
00:37:48,449 --> 00:37:53,160
indicate so the first thing we realize
who was there is no really PBK the apt

408
00:37:53,160 --> 00:37:58,788
to protection it is locally for your a
cleartext credentials but not for your

409
00:37:58,789 --> 00:38:06,499
encryption key against last best shot
and I think we saw is that they the last

410
00:38:06,499 --> 00:38:11,089
four social has your wallet key
encrypted in couple different ways one

411
00:38:11,089 --> 00:38:15,788
of them we talked about which was a
disciple one-time password remember and

412
00:38:15,789 --> 00:38:21,900
a disabled 132 character so we are back
to 256 pace but if you just a regular

413
00:38:21,900 --> 00:38:30,140
one-time passwords and that's only 16
bytes so it's no big deal but it's like

414
00:38:30,140 --> 00:38:36,029
first of two protection for your
encryption key a now they have your

415
00:38:36,029 --> 00:38:42,199
encryption key encrypted by the RESET
key that is not really 256 bit because

416
00:38:42,199 --> 00:38:43,430
it

417
00:38:43,430 --> 00:38:48,098
they are ready now and there is no Peter
Kay the two so there is no brute force

418
00:38:48,099 --> 00:38:50,640
protection so there's something to keep
in mind as well

419
00:38:50,640 --> 00:38:56,490
paranoid mode again and then we have
their own crib that both which will have

420
00:38:56,490 --> 00:38:57,348
a look at it

421
00:38:57,349 --> 00:39:02,339
ok so this is an encrypted one day need
that same look very encrypted from from

422
00:39:02,339 --> 00:39:07,349
that picture right we see a lot of
morning Cody will see some javascript

423
00:39:07,349 --> 00:39:10,980
and there is some data masking but don't
worry we're not going to say it's not

424
00:39:10,980 --> 00:39:15,730
encrypted because then that's all we
would have said something crypt at Walt

425
00:39:15,730 --> 00:39:19,970
actually turns out that your URLs I can
see metadata is not really encrypted

426
00:39:19,970 --> 00:39:24,020
which which can be fined or not because
I don't know if you're the kind of guy

427
00:39:24,020 --> 00:39:29,309
that registers in Parkside for some
others are saying about in like if you

428
00:39:29,309 --> 00:39:35,280
are just are seeing some four rooms that
are politically incorrect or things like

429
00:39:35,280 --> 00:39:39,099
that you know basically you get no
privacy because last year you are out

430
00:39:39,099 --> 00:39:43,640
there in colon or encrypted and I know
it seems we we realize was that when you

431
00:39:43,640 --> 00:39:47,180
reset your password on Twitter you want
to receive your password usually the way

432
00:39:47,180 --> 00:39:50,868
it works is you click on reset your
password and you get a unique link on

433
00:39:50,869 --> 00:39:55,119
your email you click on educate
redirected prompted for new passwords

434
00:39:55,119 --> 00:40:00,059
and they and they basically what you
will do you enter your new password

435
00:40:00,059 --> 00:40:04,579
detects it suggests hey you want to
update your password but that deal early

436
00:40:04,579 --> 00:40:09,130
staking and now that you are at which is
the unique URL to reset your password

437
00:40:09,130 --> 00:40:15,670
now is the webmaster did not a good job
and did not expired that link on the

438
00:40:15,670 --> 00:40:17,530
link just never expires

439
00:40:17,530 --> 00:40:22,069
that is bad because they could reset and
when I mean they I don't mean last but i

440
00:40:22,069 --> 00:40:25,400
wanna make that clear we were with them
they are are so much so when I mean day

441
00:40:25,400 --> 00:40:29,530
even though we're talking last beside I
mean hackers that attempt to be there or

442
00:40:29,530 --> 00:40:36,119
NSA or I should say anything bad about
it so you know what I mean

443
00:40:36,119 --> 00:40:40,380
and a cool show I noticing we found was
that actually your your passwords are

444
00:40:40,380 --> 00:40:45,250
included with ECB remember like your
vote is really just an encrypted

445
00:40:45,250 --> 00:40:50,670
password itself is not encrypted chunk
of something that you can't understand

446
00:40:50,670 --> 00:40:53,480
anything more metadata was encrypted
values

447
00:40:53,480 --> 00:40:57,240
so in in this is not the best thing
because it will take some information

448
00:40:57,240 --> 00:41:00,368
about possible plans which actually
happens to CBC too bad

449
00:41:00,369 --> 00:41:04,480
yes something to point out that special
leave the passwords that identical

450
00:41:04,480 --> 00:41:08,830
because of how ECB works and you say
well that's not a big deal because they

451
00:41:08,830 --> 00:41:12,810
still don't know my password but one of
the things we saw DS think about all

452
00:41:12,810 --> 00:41:16,660
those damn so fast we're still happening
because they'll be sold 10 million

453
00:41:16,660 --> 00:41:22,680
pounds wheres your URL it is is in cold
it's only know where your register now

454
00:41:22,680 --> 00:41:27,549
they could know that you are you stating
that site that critics passwords or

455
00:41:27,550 --> 00:41:31,960
determine decrypted so I go there and I
look at your clear text password I go to

456
00:41:31,960 --> 00:41:36,320
your vote in ICU or register their and I
see your the ciphertext of your

457
00:41:36,320 --> 00:41:40,710
encrypted password now we face here that
same site for texting all their accounts

458
00:41:40,710 --> 00:41:45,150
I know it's the same password and I know
where you ever just because I know that

459
00:41:45,150 --> 00:41:49,200
you are out so this is why this is not
the best thing and then lick such

460
00:41:49,200 --> 00:41:55,089
information about similar passwords if
you have like hello 123 hello 1234 1235

461
00:41:55,090 --> 00:41:59,230
E C became leaked some of that
information and it's interesting because

462
00:41:59,230 --> 00:42:03,840
they stay encrypted log but I X version
we want to tampering with the API's and

463
00:42:03,840 --> 00:42:07,920
suddenly got this which is not used by
anybody any plugin or anything but it

464
00:42:07,920 --> 00:42:11,790
was cool to see it this way we were a
little more pattern here comes across as

465
00:42:11,790 --> 00:42:15,670
saying well as it seems we saw West
sorry didn't see very clear about its

466
00:42:15,670 --> 00:42:21,560
this parameter for every single account
that he's cast underscored yes and we

467
00:42:21,560 --> 00:42:26,060
said that he has JavaScript again this
is encrypted world this is clear text

468
00:42:26,060 --> 00:42:31,740
JavaScript on your encrypted vote so we
wanted like ok what exactly this for

469
00:42:31,740 --> 00:42:37,580
right and you charge the last best has
led to recent to have that is it can't

470
00:42:37,580 --> 00:42:43,480
always guess we're basically their input
notes are basically to inject your

471
00:42:43,480 --> 00:42:46,880
credentials right I go to facebook.com
and he always knows where to put the

472
00:42:46,880 --> 00:42:50,720
username and the password and there's a
lot of bad webmaster Saturday or the use

473
00:42:50,720 --> 00:42:54,609
flash or things like that to last post
may have a hard time to try to guess

474
00:42:54,609 --> 00:42:59,609
whether they are so they inject
JavaScript enabled to find those for you

475
00:42:59,609 --> 00:43:05,720
and custom years he's the one that has
that some one who really saying here

476
00:43:05,720 --> 00:43:11,209
here is that last bus or any attacker
compromise in their servers can not

477
00:43:11,210 --> 00:43:16,810
clear text credentials to your vote when
they say

478
00:43:16,810 --> 00:43:21,380
expression no sorry can add a javascript
payloads to your vote for every single

479
00:43:21,380 --> 00:43:28,270
account in that JavaScript will run into
domains context for example Exchange Act

480
00:43:28,270 --> 00:43:32,119
JavaScript to my facebook account as
soon as I get to Facebook that

481
00:43:32,119 --> 00:43:36,020
JavaScript will run which again is in
clear text email encrypted wall hanging

482
00:43:36,020 --> 00:43:41,740
last bus service hands and it's also
executor of every single page wrote in

483
00:43:41,740 --> 00:43:46,890
that demand not just on the login page
so what is actually cast mgs4 an

484
00:43:46,890 --> 00:43:51,410
attacker its need JavaScript payloads
are not encrypted the planning that's no

485
00:43:51,410 --> 00:43:57,049
one nation they just to create a script
note inject this close a script that's

486
00:43:57,050 --> 00:43:58,260
all

487
00:43:58,260 --> 00:44:02,460
victim doesn't notice anything strange
you can do payloads and nothing's gonna

488
00:44:02,460 --> 00:44:07,650
happen just crashing back on the years
payload execution of repatriated that I

489
00:44:07,650 --> 00:44:11,440
mentioned before the cool thing is
because you are so again I'm not

490
00:44:11,440 --> 00:44:15,430
encrypted in this is metadata that is
not encrypted either just about to lose

491
00:44:15,430 --> 00:44:24,399
someone at new accounts to our vote with
their GIS pelo se 21 St able a my my

492
00:44:24,400 --> 00:44:29,740
emails and I don't have my credentials
or not but because I just know the

493
00:44:29,740 --> 00:44:35,848
password so but they could inject a new
account or Gmail had a long and still

494
00:44:35,849 --> 00:44:39,540
going to run so that is something to be
mad at the best thing of all is that

495
00:44:39,540 --> 00:44:43,869
last battle against religious reasons
all first two variables that actually

496
00:44:43,869 --> 00:44:48,030
contain the cleartext a username and
password which these people are you sir

497
00:44:48,030 --> 00:44:53,140
and I will peak or pass so I don't even
have to wait which might pay low to come

498
00:44:53,140 --> 00:44:57,790
out we're OK with his dispatch gonna put
the credentials I have to write to wait

499
00:44:57,790 --> 00:45:02,790
till he writes them or or ok he was
already locked answer is never going to

500
00:45:02,790 --> 00:45:08,430
end it I can just use these two
variables in get clear text credentials

501
00:45:08,430 --> 00:45:14,109
and we did and we basically we're on the
network and we acted as if we were the

502
00:45:14,110 --> 00:45:18,840
last bus right and we actually put up a
low just to see if it would work and he

503
00:45:18,840 --> 00:45:22,500
would work as you can see here we only
alerted the cleartext passwords but

504
00:45:22,500 --> 00:45:27,660
basically what the plan will inject Dos
Palos in the dog and that's it no longer

505
00:45:27,660 --> 00:45:33,240
they should know nothing so we thought
okay let's play a game here and so you

506
00:45:33,240 --> 00:45:40,689
understand them they use case we r NSA
vs LA special care so you wanna play and

507
00:45:40,690 --> 00:46:03,000
it's a very very last time an assay hear
a joke I need access to email

508
00:46:03,000 --> 00:46:10,810
come on I know that you can see if you
have a gmail account

509
00:46:10,810 --> 00:46:19,980
way way way we can misuse their customs
yes and we can I pandas pelo

510
00:46:19,980 --> 00:46:30,230
Thanksgiving to you yeah you know you
have any toys have a say

511
00:46:30,230 --> 00:46:46,550
option here we can walk around just like
inject a new account to the vote and

512
00:46:46,550 --> 00:47:05,540
includes all the payload and create
these gmail hey look for him not to

513
00:47:05,540 --> 00:47:12,060
from the outside will happen if we are
not in the client we are not in that

514
00:47:12,060 --> 00:47:17,759
yeah we're not in the in the server side
we are just an outsider so do you

515
00:47:17,760 --> 00:47:24,290
remember like Firefox press the GES you
know the people uses when they have some

516
00:47:24,290 --> 00:47:28,320
troubleshooting they upload all the
configuration of his Firefox because

517
00:47:28,320 --> 00:47:32,340
they got some out to wear something that
they really want to remove the Adler so

518
00:47:32,340 --> 00:47:36,590
you just standard configuration
including president yes to the internet

519
00:47:36,590 --> 00:47:47,550
so basically we can just using Google
dork and search for that title google

520
00:47:47,550 --> 00:47:54,060
bookmarks so yeah maybe not a good idea
if you want to surgery encrypted

521
00:47:54,060 --> 00:48:13,830
password with your key to encrypt I last
heard any last bus so we want to be very

522
00:48:13,830 --> 00:48:18,049
clear here we have been made by going
forward last bus between that they have

523
00:48:18,050 --> 00:48:23,859
to take care of securities is awesome
they did a tremendous job actually most

524
00:48:23,859 --> 00:48:28,520
of the things that we sent to them that
we reported to them where states within

525
00:48:28,520 --> 00:48:35,970
72 hours of course these same issues may
happening all their password managers

526
00:48:35,970 --> 00:48:39,100
we're not saying the last bus is a wrong
decision

527
00:48:39,100 --> 00:48:40,650
action to use LastPass both

528
00:48:40,650 --> 00:48:46,390
that's why we we use some time on this
we care about our past warrant this is a

529
00:48:46,390 --> 00:48:51,960
list of the issues that we reported to
them and they fix that now the warning

530
00:48:51,960 --> 00:48:57,960
you when you try to store your password
or Master Password Recovery URL can be

531
00:48:57,960 --> 00:49:00,529
Fort anymore they change it

532
00:49:00,529 --> 00:49:04,700
recovery process needs to be initiated
now remember that we are saying that we

533
00:49:04,700 --> 00:49:09,569
were able to bypass initiation process
that's not a thing anymore they roll out

534
00:49:09,569 --> 00:49:16,520
recently an SMS functionality to recover
your account so that proper to affect

535
00:49:16,520 --> 00:49:24,538
5,000 longer Starcraft impressed I was
crying the whole day when I realized

536
00:49:24,539 --> 00:49:29,539
about it all users affected by dual
dorks with contacted by last buses that

537
00:49:29,539 --> 00:49:38,079
kind of thing and there's a lot of more
alert regarding sensitive option we have

538
00:49:38,079 --> 00:49:41,220
recommendations for you and we have a
commendation for last bus this morning

539
00:49:41,220 --> 00:49:45,439
the recommendations for you though not
the banner version of the planet if you

540
00:49:45,440 --> 00:49:47,430
can just do that

541
00:49:47,430 --> 00:49:54,220
version do will you will bypass some of
those problems we saw before and do not

542
00:49:54,220 --> 00:50:03,299
a story or master password place you say
now I don't do that but yeah yeah I mean

543
00:50:03,299 --> 00:50:10,259
I was working the red 200,000 my chance
people do is toward the master password

544
00:50:10,260 --> 00:50:16,910
or did your ball from a lease yet this
is kind of complicated but you don't

545
00:50:16,910 --> 00:50:21,960
know you espouse reminders activate to a
fair is not very useful using two affair

546
00:50:21,960 --> 00:50:28,230
but the last week an extra layer of
security prompt from formatted possible

547
00:50:28,230 --> 00:50:33,480
to reveal possible that's like another
option that you can activate it it's

548
00:50:33,480 --> 00:50:39,619
painful you can say that did lose the
actual way of like the EC massive using

549
00:50:39,619 --> 00:50:47,500
last bus but you can do that I'd contras
restrictions I'm gonna be in China if

550
00:50:47,500 --> 00:50:52,180
somebody like love singing my last bus
from China that will trigger some alerts

551
00:50:52,180 --> 00:50:56,220
you have that option there is that
feature to do this kind of restrictions

552
00:50:56,220 --> 00:51:03,009
randomized change their the number of
iterations for people to BB KDF to and

553
00:51:03,010 --> 00:51:03,529
the sale

554
00:51:03,529 --> 00:51:09,579
dismissal auteur la games last bus
include the entire fault in one time

555
00:51:09,579 --> 00:51:14,960
just do that then do that like we're
staying in Britain only some specific

556
00:51:14,960 --> 00:51:17,859
tax within their within the actual Walt

557
00:51:17,859 --> 00:51:27,630
ECB anymore that's dedicated encryption
get rid of customs yes we're about to

558
00:51:27,630 --> 00:51:32,480
let the big deal I really don't want
anybody to be injecting Jas like

559
00:51:32,480 --> 00:51:39,440
JavaScript in my dog in any website I
guess that's that's not good idea to

560
00:51:39,440 --> 00:51:45,609
between the client alaska's also instead
of using this one more round just do

561
00:51:45,609 --> 00:51:52,450
that extra step you 30 nm embrace open
source very useful because he said that

562
00:51:52,450 --> 00:51:57,399
it was JavaScript many minds to pain in
the ass actually to get through all of

563
00:51:57,400 --> 00:52:13,480
it and what do you think about this one
part and just politically he gets a lot

564
00:52:13,480 --> 00:52:21,369
of girls with that we are open to any
quest down thank you very much

