1
00:00:00,000 --> 00:00:03,159
well i good morning everybody and thanks
very much for coming out to our talk

2
00:00:03,159 --> 00:00:09,110
today bernie presenting breaking access
controls with the only key and just a

3
00:00:09,110 --> 00:00:13,660
quick synopsis of what we're going to
talk about is that most access controls

4
00:00:13,660 --> 00:00:18,420
really suck a lot of the systems used
for gaining access to buildings card

5
00:00:18,420 --> 00:00:25,260
readers are using very old technology
cleartext protocols and you still find

6
00:00:25,260 --> 00:00:30,150
them everywhere even in modern buildings
and we realize this is an old protocol

7
00:00:30,150 --> 00:00:33,820
that no wonder he looked at a lot of a
while it would be pretty easy to exploit

8
00:00:33,820 --> 00:00:41,579
with modern hardware so we decided to
build something and we're going to do is

9
00:00:41,579 --> 00:00:46,360
tell you about the two of us we built be
a lychee but before that we're going to

10
00:00:46,360 --> 00:00:52,719
explain sort of the state of RFID access
controls how we use that knowledge to

11
00:00:52,719 --> 00:00:58,120
build the tool how the tool can be used
to pull off some physical tax and how

12
00:00:58,120 --> 00:01:02,780
you can prevent these attacks and help
your company or something or contracting

13
00:01:02,780 --> 00:01:08,000
for deal with preventing this type of
thing so little bit about us

14
00:01:08,000 --> 00:01:12,670
my name's Eric haven't check embedded
systems architect in new company

15
00:01:12,670 --> 00:01:18,140
guarantee future come from Toronto
Canada along with my partner here mark

16
00:01:18,140 --> 00:01:25,689
thanks Eric ok Americas Asia managing
principal consultant company states

17
00:01:25,689 --> 00:01:31,279
called operatives from Canada and my
team doesn't stack and penetration work

18
00:01:31,280 --> 00:01:37,619
so we do network penetration social
engineering and of course physical

19
00:01:37,619 --> 00:01:44,920
physical penetrations well so a little
bit about why or how this talk came

20
00:01:44,920 --> 00:01:54,119
about what you see up here is a big bank
in Canada and also a refinery these are

21
00:01:54,119 --> 00:01:58,790
two places that you'll find controls
like these that that control access or

22
00:01:58,790 --> 00:02:01,360
are supposed to properly control access

23
00:02:01,360 --> 00:02:06,470
now just last month I was here in
Rotterdam I was another big company that

24
00:02:06,470 --> 00:02:16,579
used these controls controls there as
well and of course North America so they

25
00:02:16,580 --> 00:02:21,930
all use these really vulnerable access
controls and here you see Eric

26
00:02:21,930 --> 00:02:29,860
International Airport in Toronto with a
rebadged hid access control system now

27
00:02:29,860 --> 00:02:34,110
we're picking on hid but they're the
dominant player in the marketplace as

28
00:02:34,110 --> 00:02:38,290
you see a lot of other companies will
will rebrand their products

29
00:02:38,290 --> 00:02:43,310
white label them but there's also other
other manufacturers that use the same

30
00:02:43,310 --> 00:02:50,390
protocol that we're going to be
discussing today so we decided to make

31
00:02:50,390 --> 00:02:53,488
the device because you know no matter
where I when customers were very

32
00:02:53,489 --> 00:02:59,820
surprised when I said these don't work
right basically this card I can clone it

33
00:02:59,820 --> 00:03:10,130
you know Ctrl C Ctrl V basically with a
$30 cloner from ebay from Aliexpress is

34
00:03:10,130 --> 00:03:15,310
usually the place where where we will
get those lines so I want to actually

35
00:03:15,310 --> 00:03:20,570
tell you a little bit more about how
access control systems work so here's a

36
00:03:20,570 --> 00:03:29,910
typical hid a reader and for the reader
it sits on the wall and it sends out and

37
00:03:29,910 --> 00:03:37,680
there's a card present you have nothing
so the card readers bit lonely no cards

38
00:03:37,680 --> 00:03:46,750
so when we introduce a card to the mix
the card reader energizes the card and

39
00:03:46,750 --> 00:03:52,750
then the cards and a bit stream that the
reader reads picks up

40
00:03:52,750 --> 00:04:01,140
and it's quite happy about so how that
the reader has the data doesn't do

41
00:04:01,140 --> 00:04:07,109
something with this data and here is
what we're attacking today the reader

42
00:04:07,110 --> 00:04:14,760
the data to a backhand or upstream
controller and this is the part that is

43
00:04:14,760 --> 00:04:19,370
weakened and this is the part that we
exploit and this is what we're

44
00:04:19,370 --> 00:04:26,590
interested in today so we can use in
clear text it's been around for decades

45
00:04:26,590 --> 00:04:31,700
and I mean since the Apollo 11 era since
we put a man on the moon we've been

46
00:04:31,700 --> 00:04:36,919
using this protocol will go more into
the actual product a little bit later

47
00:04:36,919 --> 00:04:45,200
first I'm going to let actually first
this is the whole the whole system come

48
00:04:45,200 --> 00:04:50,640
in one slide just in case I went too
fast for you there now I'm gonna let

49
00:04:50,640 --> 00:04:55,490
Eric explain a little bit more about the
different rear technologies over the

50
00:04:55,490 --> 00:05:02,160
year and how they bolt and how they all
still pretty much use week thanks so we

51
00:05:02,160 --> 00:05:06,300
showed there are three main parts of
these systems you have the reader which

52
00:05:06,300 --> 00:05:12,200
sits in the middle of a card and a
upstream controller so different things

53
00:05:12,200 --> 00:05:14,940
that you can attack here I you can
attack the communication between the

54
00:05:14,940 --> 00:05:18,690
card in the reader the Reader in the
upstream controller so we just talked

55
00:05:18,690 --> 00:05:23,450
about the readers and I've been using
the cards have been used and what's bad

56
00:05:23,450 --> 00:05:31,219
about them so hid prox is the legacy
legacy technology but you'll still find

57
00:05:31,220 --> 00:05:36,240
it all over the place again this exact
reader with a different badge on it was

58
00:05:36,240 --> 00:05:42,169
International Airport you'll see the one
on the left all over the place as well

59
00:05:42,169 --> 00:05:47,070
there's also smaller versions of these
now they're very very cheap quite

60
00:05:47,070 --> 00:05:52,840
popular for about 20 years old then
resold by other companies so it might

61
00:05:52,840 --> 00:05:58,539
not see hid but it is and somebody in
this room probably has one of these

62
00:05:58,540 --> 00:06:02,690
cards in their pocket they're just so
prevalent for not only offices but

63
00:06:02,690 --> 00:06:03,560
apartment

64
00:06:03,560 --> 00:06:11,360
really and anything you can imagine
trying to lock down the other and so

65
00:06:11,360 --> 00:06:15,600
easy to write that you can buy $30 20
with two buttons on it

66
00:06:15,600 --> 00:06:21,430
$0.01 copy so you hold this to up to a
card and the copy button it babes take a

67
00:06:21,430 --> 00:06:25,669
writable card and hold the tool up to it
and hit the post button and then you

68
00:06:25,669 --> 00:06:33,700
have cloned occurred it's very easy the
cards they only 144 bits of data on them

69
00:06:33,700 --> 00:06:38,389
and whenever they send us across to the
reader

70
00:06:38,389 --> 00:06:43,150
there's only two supported formats for
sending out that the upstream door

71
00:06:43,150 --> 00:06:47,870
controller for routes are weekend which
is the most prevalent one and another

72
00:06:47,870 --> 00:06:51,729
clear text protocol called clock and
data it's just a different way of

73
00:06:51,729 --> 00:06:55,840
putting the same data on two wires
inside the reader there is actually just

74
00:06:55,840 --> 00:07:00,400
different terminal blocks you plug wires
and dear to choose which protocol so

75
00:07:00,400 --> 00:07:05,060
that always clear text there's there's
nothing good going on this year security

76
00:07:05,060 --> 00:07:09,470
wise some of these have a two-factor
authentication you're looking at the PIN

77
00:07:09,470 --> 00:07:14,200
pad here and thinking all this is better
cause now I need to know both Japan and

78
00:07:14,200 --> 00:07:16,909
have the card that sounds good

79
00:07:16,910 --> 00:07:20,760
no problem is that the way that this
works is when you push a button it just

80
00:07:20,760 --> 00:07:25,880
sends that number over the cleartext we
didn't line so if you're connected

81
00:07:25,880 --> 00:07:28,900
between the reader in the door
controller you're going to be able to

82
00:07:28,900 --> 00:07:35,489
get that data anyways so yes it has to
factor but it's it's very weak so lots

83
00:07:35,490 --> 00:07:40,460
of problems with hid prox just
everything is unencrypted so the next

84
00:07:40,460 --> 00:07:48,180
step was HID iCLASS and this dating
introduced encryption used deaths and

85
00:07:48,180 --> 00:07:53,600
the encryption is very broken the reason
being that the way that hid did this was

86
00:07:53,600 --> 00:07:58,729
they encrypt the data on the cards and
then they used a key symmetric key

87
00:07:58,729 --> 00:08:03,900
inside the reader to decrypt that value
so first of all the data center over

88
00:08:03,900 --> 00:08:07,960
those we can lines to the controller
upstream is still clear taxpayers no

89
00:08:07,960 --> 00:08:12,210
encryption there it's just between the
card in the reader the second problem is

90
00:08:12,210 --> 00:08:15,448
that the key that years was good

91
00:08:15,449 --> 00:08:22,110
believe the same for all of the readers
they sold and back in 2010 by the name

92
00:08:22,110 --> 00:08:26,139
of me lotion variac managed to recover
that symmetric key by dumping the

93
00:08:26,139 --> 00:08:30,460
firmware out of our inner city had the
symmetric desk here to the reader and

94
00:08:30,460 --> 00:08:36,110
you can then create jeans sorry create
cards that looked like ballad cards even

95
00:08:36,110 --> 00:08:42,589
though they were not there is a feature
called I class which means you pay more

96
00:08:42,589 --> 00:08:47,010
money for it and you get a unique key to
your site

97
00:08:47,010 --> 00:08:51,380
hid manages all of this for you you
can't really have any visibility into

98
00:08:51,380 --> 00:08:55,689
that but still not back and between the
reader in the upstream controller

99
00:08:55,690 --> 00:09:03,440
there's still no security so really I
mean this seemed to go and when it came

100
00:09:03,440 --> 00:09:08,589
out but unfortunately they're still
using these terms like enhanced security

101
00:09:08,589 --> 00:09:15,290
and mutual authentication encryption
today in 2015 on their website and it's

102
00:09:15,290 --> 00:09:18,860
just not true anymore like it's it's
been broken for a good number of years

103
00:09:18,860 --> 00:09:28,069
so this brings us to icons SEC which is
the newest hid today and it still does

104
00:09:28,069 --> 00:09:36,160
we did we get all these years later but
it supports a new upstream protocol with

105
00:09:36,160 --> 00:09:40,089
the help of some additional hardware
called open supervised device protocol

106
00:09:40,089 --> 00:09:50,430
SDP is a two-way communication so it's
based on our s 45 and it allows not only

107
00:09:50,430 --> 00:09:54,540
the reader to talk to the upstream
controller but also the controller talk

108
00:09:54,540 --> 00:09:58,480
to the reader and that gives you just a
lot more things you can do in terms of

109
00:09:58,480 --> 00:10:08,190
securing that exchange so there is a
protocol our way of using AES over SDP

110
00:10:08,190 --> 00:10:12,139
secure channel protocol and all these
things are implemented that will give

111
00:10:12,139 --> 00:10:18,569
you a secured communication from the
reader to the controller one of the big

112
00:10:18,569 --> 00:10:23,110
issues though is that we haven't been
able to actually buy any of the other

113
00:10:23,110 --> 00:10:26,810
does this because it doesn't appear to
be available yet so

114
00:10:26,810 --> 00:10:32,439
there are better solutions coming but
I'm on the phone with HID about a month

115
00:10:32,440 --> 00:10:35,950
ago and they admitted that only one
manufacturer actually makes a door

116
00:10:35,950 --> 00:10:40,529
controller that speaks the protocol and
so you not gonna see very widespread

117
00:10:40,529 --> 00:10:45,170
adoption of this specially when
buildings are usually more than two

118
00:10:45,170 --> 00:10:51,660
decades old and this is another issue
which is in very small on the bottom it

119
00:10:51,660 --> 00:10:57,490
says multi-class and this means of this
reader will by default out of the box

120
00:10:57,490 --> 00:11:04,180
read any card technology so even if
somebody is using a much more secure my

121
00:11:04,180 --> 00:11:10,380
class SSC card they can still be
compromised by somebody coming along

122
00:11:10,380 --> 00:11:14,950
with a prox card which is the old
technology that's really easy to read

123
00:11:14,950 --> 00:11:18,700
and write no encryption putting the
right string bets on it and then this

124
00:11:18,700 --> 00:11:22,460
reader will just assume it's a valid
card because it's designed to work be

125
00:11:22,460 --> 00:11:29,300
backwards compatible with all these old
technologies so we we hope this is a

126
00:11:29,300 --> 00:11:32,130
more secure solution but we haven't
actually been able to look at it too

127
00:11:32,130 --> 00:11:37,670
much because it's hard to get your hands
on so does anyone be used these reader

128
00:11:37,670 --> 00:11:42,510
is in their office to get into a
building apartment it's probably a

129
00:11:42,510 --> 00:11:47,210
couple very very popular in the USA are
somewhat popular here this building

130
00:11:47,210 --> 00:11:51,990
appears to have class readers on some of
the doors and looks like a rebranded I

131
00:11:51,990 --> 00:11:56,960
class w300 which can actually turn into
a writer as well so that they're all

132
00:11:56,960 --> 00:12:02,100
over the place and then pretty popular
but really what we're talking about is

133
00:12:02,100 --> 00:12:07,050
the back end between that reader and the
upstream upstream controller and so much

134
00:12:07,050 --> 00:12:10,900
gonna take it from here to explain how
that protocol works in detail and how we

135
00:12:10,900 --> 00:12:13,740
can exploit it thanks

136
00:12:13,740 --> 00:12:20,420
so John R weigand discovered a wire that
was embedded into cards and and these

137
00:12:20,420 --> 00:12:26,349
cards were called cards the cards are
very similar to magnetic stripe cards

138
00:12:26,350 --> 00:12:31,910
but there are more durable because the
wire was either embedded if there was a

139
00:12:31,910 --> 00:12:38,850
one in the data stream or there was a
lack of wire 40 so a series of wires and

140
00:12:38,850 --> 00:12:42,620
as you pull the card through reader you
could get the data stream of ones and

141
00:12:42,620 --> 00:12:49,020
zeros now that's that's we can wire but
the protocol that was used to transmit

142
00:12:49,020 --> 00:12:54,199
the data was also called the weekend
protocol and so that's where we get the

143
00:12:54,200 --> 00:13:00,990
protocol name but also the limitation on
the number of bits that that we see on

144
00:13:00,990 --> 00:13:07,770
the cards today forty four bits which
isn't very many and and the entire

145
00:13:07,770 --> 00:13:14,000
authentication control application is
stored in those forty four bits of card

146
00:13:14,000 --> 00:13:22,570
data so it was patented in 1974 and this
is where we see you know the business

147
00:13:22,570 --> 00:13:28,200
cycle of backwards compatibility people
was put in the products of people used

148
00:13:28,200 --> 00:13:28,860
it

149
00:13:28,860 --> 00:13:32,720
people were using it so that people
continue to use it in the next product

150
00:13:32,720 --> 00:13:39,100
and here we are forty years later and we
still have this protocol in our

151
00:13:39,100 --> 00:13:47,820
buildings so I wanna show you how easy
it is to read weekend with modern

152
00:13:47,820 --> 00:13:55,380
hardware like an Arduino which is $20 or
so in the States so what you see here is

153
00:13:55,380 --> 00:14:02,480
a facsimile of what you would see in a
logic analyzer program so we have two

154
00:14:02,480 --> 00:14:07,810
wires data 0 and data one for the
weekend protocol and also ground but for

155
00:14:07,810 --> 00:14:11,869
this purpose as we're looking at
basically two wires the vertical access

156
00:14:11,870 --> 00:14:19,850
here is volts so 025 bolts and the lines
are normally held high at five bullets

157
00:14:19,850 --> 00:14:29,710
when they want to send a bit they drop
the line 0 goals and their egos 2010 on

158
00:14:29,710 --> 00:14:36,140
the one line you have a one and as time
goes on you just read 20 waltzes and

159
00:14:36,140 --> 00:14:44,140
you've got a bit stream of 4444 bits
this as well as the number of bits in

160
00:14:44,140 --> 00:14:50,060
the in the card format is all you need
to indicate two to one of these readers

161
00:14:50,060 --> 00:14:58,589
to send the back end so here is the
actual screenshot protocol from the

162
00:14:58,590 --> 00:15:04,560
slowly logic program and go through it
just so you can see visually what it

163
00:15:04,560 --> 00:15:09,670
looks like so there's the entire that
the 26th pick are the different formats

164
00:15:09,670 --> 00:15:18,180
2632 some of the cards have bits for the
facility code 202 256 and their card

165
00:15:18,180 --> 00:15:31,599
code which is used the printed on the
card is 0 to 65535 got the first eight

166
00:15:31,600 --> 00:15:37,780
bits of 21 and then the remainder 16
bits

167
00:15:37,780 --> 00:15:45,800
card code of 29640 force those two
things along with the format of the card

168
00:15:45,800 --> 00:15:49,800
is all we need to get access and this is
one area can I started putting our heads

169
00:15:49,800 --> 00:15:54,939
together and thinking well let's make a
little device as we can put in the wall

170
00:15:54,940 --> 00:16:01,930
and and compromise so this is a bit of a
facepalm as well just kind of shows you

171
00:16:01,930 --> 00:16:09,349
a little bit of an indication of some of
the industry so this is a dual

172
00:16:09,350 --> 00:16:14,330
technology cards this works with old
readers Eric told you about and the

173
00:16:14,330 --> 00:16:19,300
newer I class rears its got to physical
antennas in there and it's got two chips

174
00:16:19,300 --> 00:16:27,520
and actually has the same syndication
data on both sides of the card so if I'm

175
00:16:27,520 --> 00:16:33,970
evil attacker person I want to get your
your card access information I can come

176
00:16:33,970 --> 00:16:35,360
by with a reader

177
00:16:35,360 --> 00:16:39,980
your belts even though you're you're
building may just be using encrypted

178
00:16:39,980 --> 00:16:47,910
technology you still transmitting
unencrypted the other facepalm Picard is

179
00:16:47,910 --> 00:16:56,269
that in yellow you'll see 270 that's the
card code and 0599 the facility code so

180
00:16:56,269 --> 00:17:02,660
all the data you need to indicate is
pretty much written on the card which is

181
00:17:02,660 --> 00:17:08,030
kind of dumb we think we brought this up
to two and they say that they're they're

182
00:17:08,030 --> 00:17:12,660
recommending that people use different
different codes on both sides of the

183
00:17:12,660 --> 00:17:16,110
card now for the technology but it's
just something to be aware of that most

184
00:17:16,109 --> 00:17:21,379
people are completely oblivious about as
well you know with these cards this is

185
00:17:21,380 --> 00:17:25,230
taken from a month ago or two months ago
from a Chinese website you see enhanced

186
00:17:25,230 --> 00:17:29,460
privacy and communicates no traceable
identifies during parts essence to

187
00:17:29,460 --> 00:17:34,380
prevent card data from being doubled
your clone by parties but we know what I

188
00:17:34,380 --> 00:17:38,710
just told you that that's not really
true so it may be true for the encrypted

189
00:17:38,710 --> 00:17:42,830
side which has really been audited
properly yet but it's it's definitely

190
00:17:42,830 --> 00:17:50,510
not for the unencrypted so the moral of
the story here is that physical access

191
00:17:50,510 --> 00:17:57,770
to these readers is winning now just
want to give some people some props were

192
00:17:57,770 --> 00:18:02,629
not the first people to realize this
this has been around for 20 years as we

193
00:18:02,630 --> 00:18:06,370
said a number of times and there is a
number of great people on the internet

194
00:18:06,370 --> 00:18:14,649
that helped us by releasing their code
page Mac has called on the internet that

195
00:18:14,650 --> 00:18:20,910
was the original Arduino code that I
used to decoding weekend and it's still

196
00:18:20,910 --> 00:18:25,490
there today if you google forum carl
from Crocs loans another great resource

197
00:18:25,490 --> 00:18:33,640
he's done a lot of stuff with a class up
to completely cloning are completely

198
00:18:33,640 --> 00:18:37,179
he's got a piece of hardware that
pretends it's a night class card and PIN

199
00:18:37,179 --> 00:18:39,920
dynamically adapt

200
00:18:39,920 --> 00:18:46,180
given information it will pretend to
read and reread it looks like it's tough

201
00:18:46,180 --> 00:18:52,600
and of course there's device called the
Gecko which was presented at 2008 and

202
00:18:52,600 --> 00:18:57,459
blackout by a gentleman named it did
something very similar it's out on the

203
00:18:57,460 --> 00:19:02,890
weekend lines and collected data but
there was no means to retrieve the data

204
00:19:02,890 --> 00:19:10,120
other than maybe slashing and led the
reader or to automatically no replay the

205
00:19:10,120 --> 00:19:14,800
data so we thought ok we're here number
of years later now we've got this great

206
00:19:14,800 --> 00:19:19,080
Billie technology that's you know
literally 10 bucks module lets make this

207
00:19:19,080 --> 00:19:23,909
attack much more practical so we can you
know we can walk up with a cell phone to

208
00:19:23,910 --> 00:19:29,350
a door and open it or get the data we
need to create a card to really show

209
00:19:29,350 --> 00:19:35,620
clients that you know if you really want
to secure you need to switch away from

210
00:19:35,620 --> 00:19:39,199
these

211
00:19:39,200 --> 00:19:46,950
bacharach so we don't think the Canadian
quarter for scale but just in case

212
00:19:46,950 --> 00:19:51,970
you're not familiar with the Canadian
quarter that's actually the most of

213
00:19:51,970 --> 00:20:02,620
their 18 by 30 millimetres and yes it's
based mostly on this Nordic NRF 5 182

214
00:20:02,620 --> 00:20:06,669
system-on-chip which is a really cool
chip that you find use in all sorts of

215
00:20:06,670 --> 00:20:12,990
peripherals for iPhone and Android
because it has a 2.4 gigahertz radio as

216
00:20:12,990 --> 00:20:17,790
well as a cortex and 0 are
microcontroller almost same package so

217
00:20:17,790 --> 00:20:21,909
that one piece again does your Bluetooth
and here

218
00:20:21,910 --> 00:20:28,260
application logic we get in this module
format this red red model and nice thing

219
00:20:28,260 --> 00:20:32,430
about that is it has all the approvals
so we don't have to deal with that new

220
00:20:32,430 --> 00:20:38,250
antenna matching and all those fun
things the other big part of it is this

221
00:20:38,250 --> 00:20:42,610
black box down the bottom line is an
insulation displacement connector or a

222
00:20:42,610 --> 00:20:44,070
punch down connector

223
00:20:44,070 --> 00:20:48,450
and what you mean about that is to
installous device you really just need a

224
00:20:48,450 --> 00:20:54,040
punch down tool and you can get the
weekend wires place them in and punch

225
00:20:54,040 --> 00:20:57,850
down and that will make an electrical
connection and it does so without

226
00:20:57,850 --> 00:21:02,179
actually breaking the wire so the reader
will continue working just like it was

227
00:21:02,180 --> 00:21:07,700
before nobody knows that you've done
this but you're now sitting on those we

228
00:21:07,700 --> 00:21:14,720
can lines some ass is really some level
shifting logic crystal to support the

229
00:21:14,720 --> 00:21:22,020
model and so much for doing programming
and debugging runs on a ser 1632 coin

230
00:21:22,020 --> 00:21:28,070
cells in the back there you just pop in
the corn so I was developed using some

231
00:21:28,070 --> 00:21:33,480
state of the art equipment here this
really is and isn't hard hard what about

232
00:21:33,480 --> 00:21:40,740
if you wanna get into developing
hardware it's you know tough and

233
00:21:40,740 --> 00:21:48,150
expensive nowadays you can get all the
tools suppliers

234
00:21:48,150 --> 00:21:51,860
really reasonable prices but also you
can get the hardware built for really

235
00:21:51,860 --> 00:21:55,639
regional presence as well sites like did
you can provide you with every component

236
00:21:55,640 --> 00:21:59,360
you could ever need so it really reached
a point where you know building this

237
00:21:59,360 --> 00:22:04,479
kind of hardware that you're going to
embed into device may be years ago that

238
00:22:04,480 --> 00:22:09,260
was considered to be something that
would be really expensive in really high

239
00:22:09,260 --> 00:22:13,820
tech and sure enough whenever these
devices that were originally built and

240
00:22:13,820 --> 00:22:22,030
put into building I'm sure that this was
beyond the ability of beer and in

241
00:22:22,030 --> 00:22:26,899
someone's house but nowadays it just
becomes so simple with the amount of

242
00:22:26,900 --> 00:22:30,920
stuff out there and it's simple enough
that the entire schematic fits on the

243
00:22:30,920 --> 00:22:37,660
one slide which is great so really the
module on there on the left there where

244
00:22:37,660 --> 00:22:43,250
the Cristo and the payouts the main
thing our level shifters because they

245
00:22:43,250 --> 00:22:47,750
actually started just fats used to pull
down those we knew Aires so those wires

246
00:22:47,750 --> 00:22:51,810
as we said they're normally pulled
higher to buy votes we disconnect them

247
00:22:51,810 --> 00:22:55,280
the ground through a rough out there

248
00:22:55,280 --> 00:22:59,010
and that gives us control over the wire
and we also do a little resistance

249
00:22:59,010 --> 00:23:03,590
fighter so that we can get back five
votes down to a lower voltage because

250
00:23:03,590 --> 00:23:11,790
the model only takes to 3.3 volts on its
i/o module anymore

251
00:23:11,790 --> 00:23:17,200
number just penthouse and led that's
that's all there is to it it's it's

252
00:23:17,200 --> 00:23:23,770
quite simple we used by CAD ECAD design
that's to do the schematic as well as

253
00:23:23,770 --> 00:23:32,280
the PCD we actually went through into
hardware revision versions first one

254
00:23:32,280 --> 00:23:37,790
which we actually have over here is
significantly larger it's just a zombie

255
00:23:37,790 --> 00:23:42,850
1-1 get all the components down on the
on the board and test it out and see if

256
00:23:42,850 --> 00:23:48,860
it worked and once that was done we get
another really just a different PCV

257
00:23:48,860 --> 00:23:54,050
layout in order to get it down to the
tiny size and we originally did the

258
00:23:54,050 --> 00:24:00,669
assembly of these with a hot air rework
station marks kitchen table it was

259
00:24:00,670 --> 00:24:04,790
annoying but it worked marks much better
if a hot area where should I am I was

260
00:24:04,790 --> 00:24:09,600
just like components fly all over the
place but once they get the air right

261
00:24:09,600 --> 00:24:15,370
around there well you can assemble these
by hand it's just quite frustrating so

262
00:24:15,370 --> 00:24:22,419
we want to make a few of them so we sent
materials and design files off to Asian

263
00:24:22,420 --> 00:24:26,870
house and they came back with fully
assembled individually packaged modules

264
00:24:26,870 --> 00:24:32,570
and tour again pretty reasonable price
you know Mom costs on these models

265
00:24:32,570 --> 00:24:40,899
somewhere around $10 which is alright so
we did make a pretty interesting mistake

266
00:24:40,900 --> 00:24:45,690
during the development and it's it makes
for a good story when we are doing

267
00:24:45,690 --> 00:24:50,660
development we had like five of these
things kicking around in marks office

268
00:24:50,660 --> 00:24:54,210
and you know when you're connected to
one you don't necessarily know cuz they

269
00:24:54,210 --> 00:24:59,710
all of the same blue ta ble kibaale you
want to know which one is sitting in

270
00:24:59,710 --> 00:25:04,250
front of you and your actually working
with your day with limited license and

271
00:25:04,250 --> 00:25:08,240
development you heard about the
Bluetooth device he probably didn't it

272
00:25:08,240 --> 00:25:13,200
random names that you can tell which
ones which now we're supposed to do is

273
00:25:13,200 --> 00:25:17,220
when you send the firmware off for
manufacturing you want to switch that

274
00:25:17,220 --> 00:25:25,490
name back to the real name of your
device now marc was we didn't have to be

275
00:25:25,490 --> 00:25:31,559
bugging and get an hour a day and he
said it was like last minute appeal

276
00:25:31,559 --> 00:25:35,850
outside the firmware out to this
courthouse in China and they came back

277
00:25:35,850 --> 00:25:43,590
with an email that said we have
successful but the billion aim is now

278
00:25:43,590 --> 00:25:50,059
marks company actually made to under the
isn't gave them out at Black Hat USA and

279
00:25:50,059 --> 00:25:55,120
thank you for this guy really don't know
please can you confirm again retail on

280
00:25:55,120 --> 00:26:02,610
his company giving these out and
everyone so thanks to but thanks to

281
00:26:02,610 --> 00:26:12,040
those guys once you have it and it has
the right to name the prox reader this

282
00:26:12,040 --> 00:26:15,010
is actually the reader that we have
mounted up there which will be doing

283
00:26:15,010 --> 00:26:19,740
some demos on and it fits in there with
tons of room to spare you can get the

284
00:26:19,740 --> 00:26:25,040
camera back and no one would ever know
that you put it in quite simple

285
00:26:25,040 --> 00:26:28,700
some other readers there quite a bit
thinner but they're often mounted on the

286
00:26:28,700 --> 00:26:36,020
junction boxes so there's space behind
to mount a leaky just depends on exactly

287
00:26:36,020 --> 00:26:42,350
what reader your own so we decided to do
a speed run and see how fast we can do

288
00:26:42,350 --> 00:26:50,800
it and so do it in a minute and what
he's doing now is just taking the top

289
00:26:50,800 --> 00:26:54,780
cover only takes

290
00:26:54,780 --> 00:27:05,889
and the stories careers and this is
actually looked up just four wires

291
00:27:05,890 --> 00:27:11,530
powered round we get data on and we
invade 20 and we need three of those

292
00:27:11,530 --> 00:27:20,129
wires wires so to as well as ground to
pull the ground and always the same

293
00:27:20,130 --> 00:27:26,660
color green white label the right on
that white piece of plastic reading data

294
00:27:26,660 --> 00:27:43,730
0 green communion he puts all those in
Pakistan connectors in just this place

295
00:27:43,730 --> 00:27:48,950
you just hit with a tool and that goes
in and he did it in a minute and then

296
00:27:48,950 --> 00:27:53,070
the North Star Wars is subtle purpose
that and in this case you are using a

297
00:27:53,070 --> 00:28:07,230
phone and now we can replay replay cats
will show this live by live here and no

298
00:28:07,230 --> 00:28:14,980
carried and sand are up so that devices
in there another showing how to get it

299
00:28:14,980 --> 00:28:18,560
in your probably wondering what the
point was and that's why I will go

300
00:28:18,560 --> 00:28:26,780
through different attacks you can do
once and marks going to do the

301
00:28:26,780 --> 00:28:31,629
demonstration I'm gonna top through what
he's doing so the first thing is quite

302
00:28:31,630 --> 00:28:32,880
simple

303
00:28:32,880 --> 00:28:38,200
recording recording the car Dana so
we're going to do for this and this

304
00:28:38,200 --> 00:28:44,070
situation where we have a person and
Alice she has a legitimate card she's

305
00:28:44,070 --> 00:28:49,600
going to tap that card on the rear is
already installed this be a leaky and so

306
00:28:49,600 --> 00:28:56,629
is going to be able to recover data over
blue 21 steve has that but string of

307
00:28:56,630 --> 00:29:02,970
bits should be able to actually create a
clone card that is going to look exactly

308
00:29:02,970 --> 00:29:14,150
act like alice's and nobody can tell the
difference so here we have a serial

309
00:29:14,150 --> 00:29:19,100
terminal not normally have done to a
serial terminal but for the purposes of

310
00:29:19,100 --> 00:29:24,049
this event we thought it would be useful
to show you kind of some debug output

311
00:29:24,049 --> 00:29:32,760
that we use while we're well we're
developing so there right now and go so

312
00:29:32,760 --> 00:29:42,669
that we see here is 36 bikes there is a
binary there's too much tax receipt

313
00:29:42,669 --> 00:29:50,630
another car it's a 26 there's the raw
and data as hex from from that bit

314
00:29:50,630 --> 00:29:54,980
string so again this is just 30 isn't
about getting so you can see you got a

315
00:29:54,980 --> 00:29:59,610
car here is the bets but is less
interesting to do that when the devices

316
00:29:59,610 --> 00:30:03,149
in a reader because I'm sorry you can't
connect a serial terminal and you want

317
00:30:03,150 --> 00:30:13,510
to get out so we do stuff so this
utility is going to allow us to do the

318
00:30:13,510 --> 00:30:25,419
same same time over Bluetooth connected
we are just uses the Linux get tools a

319
00:30:25,419 --> 00:30:29,260
rapper because there's no really good
pipeline module for this but it's a

320
00:30:29,260 --> 00:30:34,419
little bit kluge but nonetheless it
works and we're gonna be doing with a

321
00:30:34,419 --> 00:30:40,690
phone today because it's crazy with all
of its not in the audience to try to do

322
00:30:40,690 --> 00:30:45,150
that so we have a whitelist immorally
connecting with my computer

323
00:30:45,150 --> 00:30:50,770
demonstration is really simple we've
read a few cards are sending us out and

324
00:30:50,770 --> 00:30:54,650
he does take time to do it but there's
all those numbers and if you grab that

325
00:30:54,650 --> 00:31:04,230
rocks mark to all over there there is an
that number you'll be able to clone all

326
00:31:04,230 --> 00:31:10,030
those cards doesn't matter I class or
rocks because the encryption is broken

327
00:31:10,030 --> 00:31:12,920
and I class so you can just encrypt the
number and

328
00:31:12,920 --> 00:31:22,110
do it again and that's the first really
simple obvious attack you can do is

329
00:31:22,110 --> 00:31:27,540
replaying so this is a situation where
somebody with a valid card Alice should

330
00:31:27,540 --> 00:31:35,470
start and Doris been opened and then to
tailgate but maybe the company is good

331
00:31:35,470 --> 00:31:41,950
about tailgating parties can just walk
through the door so doors locked but it

332
00:31:41,950 --> 00:31:51,480
doesn't matter because using a Bluetooth
request which is TX this can be done

333
00:31:51,480 --> 00:31:55,820
from a phone that can be done from Apple
that we need to make backline work

334
00:31:55,820 --> 00:32:03,820
anything that can talk Bluetooth Low
Energy can just be sent the door pops

335
00:32:03,820 --> 00:32:07,689
open so there's already really obvious
things that you know you can clone

336
00:32:07,690 --> 00:32:13,340
people's credentials and you can just
walk into the facility already in the

337
00:32:13,340 --> 00:32:20,080
caddies are not not highly secure
locking down your bills but we were not

338
00:32:20,080 --> 00:32:23,939
more fun and we realize that we are
connected to these million lines and

339
00:32:23,940 --> 00:32:27,870
because they're not really pulled high
if we just pulled from low all the time

340
00:32:27,870 --> 00:32:31,879
nobody could unlock the door not even
the real reader and that seemed like a

341
00:32:31,880 --> 00:32:39,060
fun idea so in this case you're going to
have your attacker Eve here is going to

342
00:32:39,060 --> 00:32:46,659
use a controller cards or a card with a
predefined 100 X beef and whenever that

343
00:32:46,660 --> 00:32:51,690
happens to be a lychee and the device is
first going to replay on weekend the

344
00:32:51,690 --> 00:32:56,750
last valid card and they're also going
to pull both lines low and at that point

345
00:32:56,750 --> 00:33:09,720
there's no no getting in so we're gonna
show this one started by the control

346
00:33:09,720 --> 00:33:15,130
card market as they're gonna say twenty
seconds and that even with

347
00:33:15,130 --> 00:33:20,730
and opens wants to go locked out and
even on the ballot karen is now getting

348
00:33:20,730 --> 00:33:25,220
and he can run around the building and I
now feel some servers or whatever you

349
00:33:25,220 --> 00:33:33,390
want to do i mean kinda funny because
people would have to go get my hard keep

350
00:33:33,390 --> 00:33:39,920
that door and that could take them quite
a while and some so those are the elect

351
00:33:39,920 --> 00:33:44,380
a way that customers through their
server room window

352
00:33:44,380 --> 00:33:55,490
simple attacks there's no such this back
right now it's how long the battery

353
00:33:55,490 --> 00:34:00,010
lasts basically right now it's about two
to three days there's absolutely no

354
00:34:00,010 --> 00:34:04,310
energy optimization to our code because
we wanted to get ready for the

355
00:34:04,310 --> 00:34:15,219
presentation so could feasibly go to 30
days or even three months

356
00:34:15,219 --> 00:34:22,459
use the same same time are running for
three months on a coin cell battery

357
00:34:22,460 --> 00:34:27,530
optimization of its alright would get
through and do they question the and

358
00:34:27,530 --> 00:34:35,550
really relevant to this so the last
attack type we looked at was the skimmer

359
00:34:35,550 --> 00:34:43,460
and this is Mark's actually done a whole
bunch on sites that it works really well

360
00:34:43,460 --> 00:34:48,639
basically you get yourself a Mexi prox
reader which is the big one the EC used

361
00:34:48,639 --> 00:34:54,940
for parking garage is two times two
times its size height and width sets 12

362
00:34:54,940 --> 00:35:01,260
inches 30 centimeters because they're
they're interesting fly with that they

363
00:35:01,260 --> 00:35:05,710
don't look so great an extra but yeah
but this big and it can read a card in

364
00:35:05,710 --> 00:35:12,530
about three feet one meter away I don't
do Imperial here which is so you take

365
00:35:12,530 --> 00:35:17,930
that and you hide it in a backpack and
you see in at 12 volts of power but you

366
00:35:17,930 --> 00:35:24,649
can buy a 12 volt battery pack or get so
what then sells them together and plug

367
00:35:24,650 --> 00:35:27,570
it in that way so now you have a totally
bad

368
00:35:27,570 --> 00:35:32,200
powered system and you can walk around
and if you get within one meter of

369
00:35:32,200 --> 00:35:37,089
somebody might have a card read it and
once you do that you can take the day

370
00:35:37,090 --> 00:35:42,680
off guard and get inside even heard of
people doing things for physical

371
00:35:42,680 --> 00:35:47,710
penetration testing like walking into
the building and saying oh I am with I T

372
00:35:47,710 --> 00:35:52,320
we are doing an audit of badges could
you please get on this reader and they

373
00:35:52,320 --> 00:35:55,530
do and then you have their card
information and we didn't come up with

374
00:35:55,530 --> 00:36:00,260
this attack from Bishop Fox released the
tastic RFID

375
00:36:00,260 --> 00:36:05,130
but with the B league he can sit there
with push notifications to your cell

376
00:36:05,130 --> 00:36:09,740
phone walking around and you you know
which cards you've grabbed an elevator

377
00:36:09,740 --> 00:36:16,830
for example the next attack that the
people have been doing but it turns out

378
00:36:16,830 --> 00:36:22,400
to be a really great way to get people's
credentials and get around buildings so

379
00:36:22,400 --> 00:36:26,950
most of the time are you spoken to
people about this that use these systems

380
00:36:26,950 --> 00:36:32,589
and rely on them their surprise they
were sold something by the company that

381
00:36:32,590 --> 00:36:36,050
does usually the company selling
anything that does the installations

382
00:36:36,050 --> 00:36:39,050
they don't really have a security
background they're more like electrical

383
00:36:39,050 --> 00:36:46,460
wiring white people so they just don't
know and we've got a lot of that kind of

384
00:36:46,460 --> 00:36:51,270
reaction so marks gonna go through what
you can do if thats your face right now

385
00:36:51,270 --> 00:36:59,480
great so the first tactic of course is
to tamper detection and tamper detection

386
00:36:59,480 --> 00:37:06,790
is on most readers tiny switch on on the
new readers its optical as well so it'll

387
00:37:06,790 --> 00:37:09,930
sense which is easy

388
00:37:09,930 --> 00:37:16,109
down it'll be late but of course you
know if you were tricky figure out ways

389
00:37:16,110 --> 00:37:17,250
around that as well

390
00:37:17,250 --> 00:37:22,570
now one of the problems with this is we
found that most installers to save money

391
00:37:22,570 --> 00:37:27,130
don't actually run enough physical
copper lines to the readers to even

392
00:37:27,130 --> 00:37:29,619
attempt to detect

393
00:37:29,619 --> 00:37:36,890
and the second problem with this is that
most people don't watch the logs so that

394
00:37:36,890 --> 00:37:40,150
temper detectives not going to be very
useful for you

395
00:37:40,150 --> 00:37:47,690
computers sitting for example in the
cafeteria where I'm actually seen an

396
00:37:47,690 --> 00:37:55,299
access control computer at a chemical
plant or so definitely take a look at

397
00:37:55,299 --> 00:38:00,390
the logs you should probably even do to
your sticks so if you have that

398
00:38:00,390 --> 00:38:06,410
capability and you know that Joe comes
in every morning at 9 a.m. and uses

399
00:38:06,410 --> 00:38:13,180
three certain doors and all of a sudden
Joe's card is used at two on a backdoor

400
00:38:13,180 --> 00:38:18,259
that's never been used on before that
should probably line up light off an

401
00:38:18,259 --> 00:38:20,190
alarm bell somewhere

402
00:38:20,190 --> 00:38:27,680
the other thing and this is kind of
after the fact is you if you're going to

403
00:38:27,680 --> 00:38:32,759
use this system and you really concerned
about security you probably want to have

404
00:38:32,759 --> 00:38:36,359
a camera trained on all the doors that
you're really concerned about because

405
00:38:36,359 --> 00:38:42,598
verification as well to make sure that
the person that use the card is actually

406
00:38:42,599 --> 00:38:47,640
the person's card in the log as well and
one really interesting thing we saw in

407
00:38:47,640 --> 00:38:52,879
Vegas because we got invited by the
folks at MGM to go back into their room

408
00:38:52,880 --> 00:38:56,039
where they do all of the key terms for
the entire proper the keys for the

409
00:38:56,039 --> 00:39:01,329
entire property property including RFID
cards and whatnot is they've actually

410
00:39:01,329 --> 00:39:04,660
chosen to install readers behind the
drywall

411
00:39:04,660 --> 00:39:10,339
either reader no indication it's there
obviously unless your gonna punch a hole

412
00:39:10,339 --> 00:39:15,660
in the wall you won't get access to the
physical wires behind it so it's it's an

413
00:39:15,660 --> 00:39:21,879
interesting tactic to avoid this this
type of attack and even giving someone

414
00:39:21,880 --> 00:39:27,220
an indication that there might be
something important behind the door so I

415
00:39:27,220 --> 00:39:31,828
like that one personally myself I should
say these readers do provide some

416
00:39:31,829 --> 00:39:36,150
security we're not saying it's it's this
is accessible to everyone although it's

417
00:39:36,150 --> 00:39:40,630
we think that we've made it pretty easy
we think that the security that they

418
00:39:40,630 --> 00:39:41,349
provided above

419
00:39:41,349 --> 00:39:44,349
the same as a standard key because you
can take a camera like this take a

420
00:39:44,349 --> 00:39:50,420
picture of a key and make a copy now and
it's about the same with the tools that

421
00:39:50,420 --> 00:39:58,249
we talked about and and and the BLET so
in closing I guess I don't have my slide

422
00:39:58,249 --> 00:40:02,509
notes up right now but I think that I
just want to say thanks to everyone

423
00:40:02,509 --> 00:40:07,700
time to change from week and to some of
the protocol and we're really

424
00:40:07,700 --> 00:40:24,180
appreciative to to be here speaking
today thanks for having us and we got it

425
00:40:24,180 --> 00:40:30,839
twenty minutes three questions are
answered it had back there I'm sorry

426
00:40:30,839 --> 00:40:36,810
that was down to question here

427
00:40:36,810 --> 00:40:48,860
denial of service I suppose most
buildings have motion sensors on one

428
00:40:48,860 --> 00:40:56,240
side that will activate a remote exits
which we believe will circumvent the the

429
00:40:56,240 --> 00:41:08,689
readers weekend but theoretically it's
possible sorry he s really has to be

430
00:41:08,690 --> 00:41:15,540
override their motion sensor or physical
switch for or and this is what you see

431
00:41:15,540 --> 00:41:20,100
my stopped and there's the door handle
just opens the door for you usually see

432
00:41:20,100 --> 00:41:24,620
from the inside because like you said
Health and Safety Building catches fire

433
00:41:24,620 --> 00:41:28,230
you don't want people to be stuck
because the reader got disconnected

434
00:41:28,230 --> 00:41:54,810
that's an interesting question though is
that better reviews than there are other

435
00:41:54,810 --> 00:41:58,700
companies and the challenge saying he
now works in the company that uses

436
00:41:58,700 --> 00:42:03,560
something different so the first thing
about these demonstrators is it turns

437
00:42:03,560 --> 00:42:09,490
out a lot of them are actually on my HID
hid has brought out a lot of people in

438
00:42:09,490 --> 00:42:13,109
the last twenty years so they're in
there is a chance that is actually owned

439
00:42:13,110 --> 00:42:22,370
by hid and similar technology and these
weekends and companies that aren't hid

440
00:42:22,370 --> 00:42:26,810
there are still some out there using
using redundant the reason being that

441
00:42:26,810 --> 00:42:31,210
the upstream dark controller which we
didn't really show stuck behind here

442
00:42:31,210 --> 00:42:39,220
it's not specific to the readers so you
can buy a row readers from one company

443
00:42:39,220 --> 00:42:43,230
and a door controller for another and
often no work together because it's just

444
00:42:43,230 --> 00:42:47,040
weekend and it's just become sort of the
six set the standard

445
00:42:47,040 --> 00:42:51,790
there are some more secure solutions
like they're saying oh SDP insecure

446
00:42:51,790 --> 00:42:56,810
channel protocol we haven't seen any in
North America not sure there's companies

447
00:42:56,810 --> 00:43:03,210
doing that here some other weird
examples like for example where all of

448
00:43:03,210 --> 00:43:07,730
the decision is made on the lock itself
everything is stored there they're

449
00:43:07,730 --> 00:43:12,600
insecure for other reasons but that's
the other thing is it's really hard for

450
00:43:12,600 --> 00:43:17,160
security professionals to get access to
this type of technology for example even

451
00:43:17,160 --> 00:43:22,299
to get the server software for the back
end is difficult to any of this hardware

452
00:43:22,300 --> 00:43:30,890
an eBay for $200 but its original $600
controller and to get access to the wide

453
00:43:30,890 --> 00:43:34,310
variety of stuff that's out there is
difficult and to know to learn the

454
00:43:34,310 --> 00:43:45,029
industry is it takes a lot of work like
work so to speak

455
00:43:45,030 --> 00:43:53,400
basically yes so the question is can we
just grab power often or control

456
00:43:53,400 --> 00:44:00,380
airlines we looked at it the so it
should be radically be possible that

457
00:44:00,380 --> 00:44:05,650
issue being though that it's pulled up
through a 10 kilometres Mr C you have to

458
00:44:05,650 --> 00:44:10,130
set power like really carefully
otherwise even the polling the lines low

459
00:44:10,130 --> 00:44:15,900
and kinda looking at that we want we
really know how to make something that

460
00:44:15,900 --> 00:44:20,990
you install it like grapes that we want
to avoid breaking the actual

461
00:44:20,990 --> 00:44:25,770
installation that's why I went to bring
up the battery is it possible probably

462
00:44:25,770 --> 00:44:29,590
if you had some kind of like walter
capps or something and to trickle charge

463
00:44:29,590 --> 00:44:33,170
it off the lines because one line is
always high it so as long as you get

464
00:44:33,170 --> 00:44:37,460
right out those transients it should be
possible

465
00:44:37,460 --> 00:44:42,280
available to the controller but we made
a decision not to include that because

466
00:44:42,280 --> 00:44:48,780
of potential line noise by pulling it so
far down to 3.5 well and was we we did

467
00:44:48,780 --> 00:44:53,120
look at the 12 outline for power but
really in order to make it small enough

468
00:44:53,120 --> 00:44:56,210
that would have been putting a switching
regulator inside the reader

469
00:44:56,210 --> 00:45:00,710
and the reader already does Mrs stuff
like for products like around in the

470
00:45:00,710 --> 00:45:09,390
dark colored so so if you have a
twenty-two heard so it's converter with

471
00:45:09,390 --> 00:45:33,819
125 to hurt card could be a bad time
because the readers are quite down so if

472
00:45:33,820 --> 00:45:36,790
you're trying to replay the exact same
card right after that could be an issue

473
00:45:36,790 --> 00:45:41,450
but if you let the things that there for
a day and collect the whole ream of

474
00:45:41,450 --> 00:45:46,118
cards there is a feature that we didn't
demonstrate that's pretty much the

475
00:45:46,119 --> 00:45:51,310
replay but you passin argument of how
many cards back you want to go so you

476
00:45:51,310 --> 00:45:54,630
know if you know you have a hundred
cards and you just choose back 50 yards

477
00:45:54,630 --> 00:46:03,540
and passed background variables that
Billy just select if you just 85

478
00:46:03,540 --> 00:46:21,060
card number so it's better but not not
totally a solution either so per person

479
00:46:21,060 --> 00:46:25,880
we there's a first of all there is an
attack using the proxy clone intended to

480
00:46:25,880 --> 00:46:32,330
brute force and I think that with the B
league we haven't actually implemented a

481
00:46:32,330 --> 00:46:37,970
lot faster using direct access this
alien lines of course the pulse length

482
00:46:37,970 --> 00:46:44,819
is 50 milliseconds I believe between
each bit so we haven't experimented with

483
00:46:44,820 --> 00:46:48,000
trying to compress it down but I believe
there will probably work because the

484
00:46:48,000 --> 00:46:51,270
controllers not going to care about how
much spaces as long as as long as

485
00:46:51,270 --> 00:46:53,160
running fast enough to read the

486
00:46:53,160 --> 00:46:58,190
pulling it down theoretically you could
probably a pretty fast brute force I

487
00:46:58,190 --> 00:47:04,980
think 426 big card you know you know if
you just want to figure out the facility

488
00:47:04,980 --> 00:47:09,039
code which is not usually printed on the
card would only take 256 attempts rate

489
00:47:09,039 --> 00:47:14,460
wouldn't take much so it's just saw this
is by the way this is all open source on

490
00:47:14,460 --> 00:47:24,160
github if you one of us there we can
send it to you the link you can you can

491
00:47:24,160 --> 00:47:28,649
add that to the firmware please but I
really interesting thing with the denial

492
00:47:28,650 --> 00:47:32,319
of service would be the case for you
have a card count but not themselves

493
00:47:32,319 --> 00:47:37,788
account that comes out quite a bit I was
in one who sell their I had a fire

494
00:47:37,789 --> 00:47:44,789
lockbox forties which had a glass front
on it and in this fire lock box was a

495
00:47:44,789 --> 00:47:51,150
card numbers facing at the glass panel
so you can read the card cared about was

496
00:47:51,150 --> 00:47:56,520
walking up to their lobbies firebox and
looking at the card so in that case at

497
00:47:56,520 --> 00:48:10,579
2:56 translator and you're in the dark
and it literally just some bids

498
00:48:10,579 --> 00:48:14,640
the only issue right now is that we
time-out they want to do it really fast

499
00:48:14,640 --> 00:48:19,538
we time out pretty quickly you have to
increase that time out like so on hid

500
00:48:19,539 --> 00:48:26,049
prox that I class the pin is a bit
different so it's done on the actual

501
00:48:26,049 --> 00:48:29,309
card data stored there we have to look
into that

502
00:48:29,309 --> 00:48:34,500
100% on the eyeglass so that's one thing
worth mentioning is that I class does

503
00:48:34,500 --> 00:48:40,210
have their more secure a bio class as
well which is fingerprint reader

504
00:48:40,210 --> 00:48:46,380
versions it sounds better one of the big
issues of this though is that the actual

505
00:48:46,380 --> 00:48:51,490
biometric data is stored on the card and
if you're using those the non a leaked

506
00:48:51,490 --> 00:48:57,049
version which is using that globally to
keep pesky somebody could take a card

507
00:48:57,049 --> 00:49:01,759
and then in King County their own
biometric data onto that card but then

508
00:49:01,760 --> 00:49:03,410
changed the US only count

509
00:49:03,410 --> 00:49:09,308
and the card code so now I can walk up
use this card it has a different card

510
00:49:09,309 --> 00:49:13,000
counter and has a fake card code use
their own finger for the fingerprint

511
00:49:13,000 --> 00:49:17,109
reader the verification is done at the
reader and that sense that but where we

512
00:49:17,109 --> 00:49:22,109
goin back but just the card code back so
there is more secure bio class devices

513
00:49:22,109 --> 00:49:26,279
are still vulnerable to faking weekend
data and also you can close the cards

514
00:49:26,280 --> 00:49:36,490
but it's more complex we are going to do
another production right we've had a lot

515
00:49:36,490 --> 00:49:44,939
of people asking they don't do it
themselves so hundred and sell it for

516
00:49:44,940 --> 00:49:50,440
just around our costs are not interested
in making cash turning off that it is

517
00:49:50,440 --> 00:49:57,980
open source files are on the proposed
well so if you do want to make it please

518
00:49:57,980 --> 00:50:04,549
and some people have also emailed saying
I made wine and cider it really sucks so

519
00:50:04,549 --> 00:50:19,750
maybe we should do well I can you can
have it thanks everyone

