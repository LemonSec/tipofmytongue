1
00:00:00,000 --> 00:00:04,299
thank you for attending my presentation
so we're going to talk about ProxySG

2
00:00:04,299 --> 00:00:09,710
from puuko but before I begin to the
subject oh just tell you about them but

3
00:00:09,710 --> 00:00:16,129
I am and what I'm doing so I worked for
Evans group innovation which is the R&D

4
00:00:16,129 --> 00:00:20,820
department of the Airbus group which is
known for making plans and also security

5
00:00:20,820 --> 00:00:26,730
so we are a small research team we are
about 12 and we mostly work internally

6
00:00:26,730 --> 00:00:34,969
but none of Unix and regular I T stuff
and you do Securi some of you may have

7
00:00:34,969 --> 00:00:39,899
heard that this talk was supposed to a
pending says can back in March where it

8
00:00:39,899 --> 00:00:44,960
was canceled so before you ask the
question basically the campaign is

9
00:00:44,960 --> 00:00:49,960
exactly the same as you can with a few
real modifications but nothing was

10
00:00:49,960 --> 00:00:56,309
censored or nothing was removed from the
presentation from Cisco so we now have a

11
00:00:56,309 --> 00:01:00,510
peek into the blue coat so the goal
today is to give you an overview of the

12
00:01:00,510 --> 00:01:05,349
work we did reversing generating and
analyzing the ProxySG we going to follow

13
00:01:05,349 --> 00:01:10,619
the way we actually worked so we will
start low-level who is the file system

14
00:01:10,619 --> 00:01:16,130
storage and registry and we delay or so
until we reach application security so

15
00:01:16,130 --> 00:01:20,408
we'll give it a look at the Combine
raised in the current loan and

16
00:01:20,409 --> 00:01:26,350
mechanisms then way to dig into the
internals I we did get into the

17
00:01:26,350 --> 00:01:31,229
internals and then we'll see how the
global security of the system is and a

18
00:01:31,229 --> 00:01:38,710
complete about that so first what's good
proximity so it's no surprise proxy web

19
00:01:38,710 --> 00:01:43,699
proxy which is one of the most deployed
in be companies issue working at

20
00:01:43,700 --> 00:01:47,060
companies with tens of thousands of
people accessing the web

21
00:01:47,060 --> 00:01:52,079
there is quite a good chance that you're
going through Blue Coat ProxySG it's

22
00:01:52,079 --> 00:01:56,779
mainly used for you ever get the going
is Asian to feel through your access to

23
00:01:56,780 --> 00:02:03,280
YouTube outside of the lunch break but
it's also able to do way more people

24
00:02:03,280 --> 00:02:08,580
don't know that but it's also cable P
capable of intercepting and re-encoding

25
00:02:08,580 --> 00:02:12,310
video streaming it's also capable of
doing maybe in

26
00:02:12,310 --> 00:02:17,910
and somebody proxy it's very very very
complex he does a lot of features and

27
00:02:17,910 --> 00:02:22,180
what's really interesting is that it's
running proprietary OS it's not as most

28
00:02:22,180 --> 00:02:26,819
appliances running on Linux or FreeBSD
or whatever it's actually raining their

29
00:02:26,819 --> 00:02:29,000
own operating system which is called

30
00:02:29,000 --> 00:02:36,170
gos so what I group research books here
she doesn't seem like very well it's

31
00:02:36,170 --> 00:02:41,299
actually widely used in two groups it's
the most common way to access the

32
00:02:41,300 --> 00:02:48,190
internet from from from inside and well
since it's the end of the day between

33
00:02:48,190 --> 00:02:52,269
the web to internal network is very
interesting target commercial sectors be

34
00:02:52,269 --> 00:02:57,760
good if you can get into a precision
takeover takeover you can bypass looking

35
00:02:57,760 --> 00:03:01,959
you can well maybe compromise it from
the internet if you have a really good

36
00:03:01,959 --> 00:03:05,510
exploit you can also probably many of
them you don't see us connections

37
00:03:05,510 --> 00:03:10,450
because public proxies geez also well
known for being able to many many

38
00:03:10,450 --> 00:03:12,690
connections

39
00:03:12,690 --> 00:03:17,620
well it's a very interesting target and
there is no known previous research

40
00:03:17,620 --> 00:03:22,400
public research and approximately so we
didn't really know if it was secure or

41
00:03:22,400 --> 00:03:26,700
not and if you look at the security
buildings published by Blue Coat you

42
00:03:26,700 --> 00:03:33,548
just use and web web interface
administration bucks more interesting so

43
00:03:33,549 --> 00:03:37,140
the goal of this study was very true as
the global security little the ProxySG

44
00:03:37,140 --> 00:03:40,670
so we could know to remove them or not

45
00:03:40,670 --> 00:03:46,268
also to the mighty guys buy rating
recommendations for securing employment

46
00:03:46,269 --> 00:03:50,829
based on the things we had also be
prepared for n64 even know that the

47
00:03:50,829 --> 00:03:55,410
ProxySG was compromised know anybody
channel 3 helps to do a forensics

48
00:03:55,410 --> 00:04:00,950
investigation then ok where should we
publish about boxes do because we could

49
00:04:00,950 --> 00:04:05,440
do the research and compare results
internal well we really thought that's

50
00:04:05,440 --> 00:04:08,989
the first public information we
publishing here but officially not the

51
00:04:08,989 --> 00:04:12,810
first research and proximity I guess
some three day tours agencies babe based

52
00:04:12,810 --> 00:04:13,459
in the USA

53
00:04:13,459 --> 00:04:19,220
probably be some interesting work done
and proxies D and so our goal is to

54
00:04:19,220 --> 00:04:24,320
foster research and get researcher
looking to Park City maybe find bugs and

55
00:04:24,320 --> 00:04:25,540
then published them

56
00:04:25,540 --> 00:04:31,950
so they can get fixed and in the end
gets better security from precision so

57
00:04:31,950 --> 00:04:35,840
this presentation is going to focus on
the road technical results and also on

58
00:04:35,840 --> 00:04:41,299
the way we did it too and so as I said
we were going to go from the loadable to

59
00:04:41,300 --> 00:04:47,360
the high level and that's what we did we
also hear everything I'm going to talk

60
00:04:47,360 --> 00:04:50,940
about is going to apply to all the
current proxies you models that are

61
00:04:50,940 --> 00:04:56,830
running version 6 to court and 1 2015
because since we started talking about

62
00:04:56,830 --> 00:05:01,560
with blue coat made a few changes to the
rice and includes security so I'm going

63
00:05:01,560 --> 00:05:09,300
to tell you about the changes but mostly
this applies until well last year so if

64
00:05:09,300 --> 00:05:13,430
you want your inbox easy you have two
choices either you buy any plans which

65
00:05:13,430 --> 00:05:19,920
is basically recommittal server running
Intel CPUs weakest of the shelf

66
00:05:19,920 --> 00:05:24,770
components HDD's RAM nothing very
special or you can buy vmware planes did

67
00:05:24,770 --> 00:05:29,070
you put on ESX and running away
basically the way that you are really

68
00:05:29,070 --> 00:05:32,550
the same they're in the same operating
system there is no difference between

69
00:05:32,550 --> 00:05:33,300
the two

70
00:05:33,300 --> 00:05:38,740
it's also very interesting that it's
raining on committee chair but it's

71
00:05:38,740 --> 00:05:42,920
running a proprietary OS and there is
nothing published about it so I don't

72
00:05:42,920 --> 00:05:48,530
know why the conversion you could you
can find in the world are 535 it should

73
00:05:48,530 --> 00:05:55,080
be over by now but some older hardware
don't support 60 you may find some 525

74
00:05:55,080 --> 00:05:59,640
I'm going to talk about that 583 home
and some new security measures that we

75
00:05:59,640 --> 00:06:05,360
having six don't apply to 525 the one
you're probably going to find in 2006 22

76
00:06:05,360 --> 00:06:08,920
which is to produce long-term released
which is no deprecated so you should

77
00:06:08,920 --> 00:06:12,590
move to seize the five which is the
latest numbers it really is reporting

78
00:06:12,590 --> 00:06:21,359
that aids because we came into running
so we we worked on both VMware appliance

79
00:06:21,360 --> 00:06:27,200
is easier to work with but we want to
make sure that through results that we

80
00:06:27,200 --> 00:06:33,170
had also apply to how r so first you
want to get a look at the binaries you

81
00:06:33,170 --> 00:06:37,440
want to know what could he is running
into blue coat so just like certified

82
00:06:37,440 --> 00:06:38,050
system

83
00:06:38,050 --> 00:06:45,250
we started with older version there
since six which is based on truly

84
00:06:45,250 --> 00:06:49,789
proprietary disk partitioning so you
think to discover the Bluecoat you look

85
00:06:49,789 --> 00:06:54,240
at it and he likes this is not that this
is nothing I know the partition scheme

86
00:06:54,240 --> 00:06:57,379
is not standard to start from nothing

87
00:06:57,379 --> 00:07:02,949
fortunately from 64 this story to move
to a smaller 32 partition that then

88
00:07:02,949 --> 00:07:07,220
contains proprietary such system will
later so it's easier to start with

89
00:07:07,220 --> 00:07:13,430
something like sixty four so how do we
get into the filesystem just give you

90
00:07:13,430 --> 00:07:18,259
this morning prediction and how the
hardware works so the basic architecture

91
00:07:18,259 --> 00:07:23,659
is that you have three discs which is we
can have more but that's the minimum you

92
00:07:23,659 --> 00:07:28,789
can have and so usually have a small
compact luxury city which is used for

93
00:07:28,789 --> 00:07:32,949
their offerings operating system itself
and then you have two or more drive than

94
00:07:32,949 --> 00:07:38,409
I used to store everything else that's
mostly configuration data and also of

95
00:07:38,409 --> 00:07:43,360
course the cage file a proxy and all the
use and that sounded restored an

96
00:07:43,360 --> 00:07:48,389
appropriate social system so they are
Chu types of systems that you can

97
00:07:48,389 --> 00:07:53,680
finding the Bluecoats be sized to fit
the renewed is not really use you have

98
00:07:53,680 --> 00:07:57,909
the static readonly file system that is
used to store do operating system flies

99
00:07:57,909 --> 00:08:01,930
that cold be CFS and you will find their

100
00:08:01,930 --> 00:08:06,710
minorities and also static configuration
put on by Blue Coat regarding the

101
00:08:06,710 --> 00:08:10,628
current on everything we give they can
do that later then you have the Kachin

102
00:08:10,629 --> 00:08:18,740
chin which is where the data are stored
mostly due date on which is based on

103
00:08:18,740 --> 00:08:24,020
hash tables the most complete
documentation if you can call that the

104
00:08:24,020 --> 00:08:26,068
legalese it can find better

105
00:08:26,069 --> 00:08:30,909
well there's the buttons that describe
the principle of the CFS it's it's not

106
00:08:30,909 --> 00:08:34,899
really easy to read and you also have
even though it's not really if a system

107
00:08:34,899 --> 00:08:39,019
your said the registry which is thought
we just during the settings which is

108
00:08:39,019 --> 00:08:45,760
starting to see us so we don't really
know we tried researching CFS but it's

109
00:08:45,760 --> 00:08:50,829
really very complex and so I don't know
how it stored on disk itself so we

110
00:08:50,829 --> 00:08:51,550
didn't really

111
00:08:51,550 --> 00:08:58,170
go into that way to rid of research is
kind of a shame because the logs are

112
00:08:58,170 --> 00:09:02,160
stored in TFS so you want to define six
and extract the lugs you have to

113
00:09:02,160 --> 00:09:06,899
understand CFS correctly you know once
used interface but it's so complex we

114
00:09:06,899 --> 00:09:12,100
didn't have the time in 22 to dig into
it so today I'm going to present only

115
00:09:12,100 --> 00:09:20,709
dcfs which is the static by system story
starring do fighting fires batteries so

116
00:09:20,709 --> 00:09:25,709
where do you get into BC FSO issue we
look at the fat32 partitions of several

117
00:09:25,709 --> 00:09:31,800
fights at least I mean only five of them
and two of them start a scientist in one

118
00:09:31,800 --> 00:09:36,130
hour using busy office is very
interesting because we've Road

119
00:09:36,130 --> 00:09:40,170
bootloader which is based on their
proprietary OS so when you're starting

120
00:09:40,170 --> 00:09:46,449
to starting the bootloader still today
which is Mon 16 small for a bit it's a

121
00:09:46,450 --> 00:09:48,209
six megabytes binary

122
00:09:48,209 --> 00:09:53,529
containing a basic is Gio as with any
person or chrome and some drivers but no

123
00:09:53,529 --> 00:09:57,980
applications its goal is just to look
upon the disc look for the available

124
00:09:57,980 --> 00:10:01,770
systems that you can boot and then you
displays a grub like boot menu where you

125
00:10:01,770 --> 00:10:07,410
can choose which version of the OS you
want to start once you select in or just

126
00:10:07,410 --> 00:10:09,469
live default start

127
00:10:09,470 --> 00:10:14,760
boots one of the systems so but you only
have one which is system one which is

128
00:10:14,760 --> 00:10:18,740
the real operating system where you have
a fight over 200 megabytes

129
00:10:18,740 --> 00:10:25,370
which contains everything go to persist
o'connell the applications ever seen so

130
00:10:25,370 --> 00:10:31,890
far as the boot sequence you but the
BIOS Indian br br tix boot sector they

131
00:10:31,890 --> 00:10:37,089
need boots which is owned by a
hard-coded sector number with the tech

132
00:10:37,089 --> 00:10:41,940
stocks turned on the AC which is stored
in started a site which is the first

133
00:10:41,940 --> 00:10:47,790
time tree will see that it then it
starts sequencer EXI which is the second

134
00:10:47,790 --> 00:10:51,079
untrained started a site which is really
interesting because it's actually a

135
00:10:51,079 --> 00:10:55,609
script parser and Darcy configuration
files in the root of the flight system

136
00:10:55,610 --> 00:11:00,790
of the PCI Fast Five system where you
can try and well remained at CGI script

137
00:11:00,790 --> 00:11:04,520
which is basically the init script and
you will

138
00:11:04,520 --> 00:11:10,910
all the drivers and applications and
then I G N MAIN that if you start lot

139
00:11:10,910 --> 00:11:17,870
starters which display the menu and then
started to exist below to select System

140
00:11:17,870 --> 00:11:22,530
an interesting interesting boot sequence
which was kind of hard to get to because

141
00:11:22,530 --> 00:11:26,640
you had to reverse we had to reverse
engineer every step and understand how

142
00:11:26,640 --> 00:11:32,810
it came in handy in so just give you an
overview at the moment and then going to

143
00:11:32,810 --> 00:11:37,420
explain everything because not the goal
here this lady is going to be a

144
00:11:37,420 --> 00:11:40,550
reference if you want you begin to
define system you will go to the

145
00:11:40,550 --> 00:11:45,079
structures and if you look into an
exhibition on a detour and take a look

146
00:11:45,080 --> 00:11:46,270
at this it will make sense

147
00:11:46,270 --> 00:11:51,260
immediately but what's really
interesting is if you look at the way to

148
00:11:51,260 --> 00:11:57,140
store and you have several entries we
have a string table here a CPA table

149
00:11:57,140 --> 00:12:05,270
which basically stable with all the
outset and so it's so and back

150
00:12:05,270 --> 00:12:10,150
system which is readonly you just look
for the tables you manage to stream

151
00:12:10,150 --> 00:12:15,050
games with the upset in size and then
you can extract all the facts on the

152
00:12:15,050 --> 00:12:22,290
strains contain the full bus destroying
you will have good / USA / whatever so

153
00:12:22,290 --> 00:12:27,959
you have the full file system stored
liner in LA in in the final itself the

154
00:12:27,960 --> 00:12:32,010
thing is with this format you can really
change the size if you want to modify

155
00:12:32,010 --> 00:12:36,140
the system you can really change the
size of the fight because they are next

156
00:12:36,140 --> 00:12:40,390
to each other into my content block so
if you want to change the size you

157
00:12:40,390 --> 00:12:43,560
really have to rebuild the whole
structure so we don't really do that

158
00:12:43,560 --> 00:12:51,439
you're so have something that you must
pay attention to you have a CRC until

159
00:12:51,440 --> 00:12:57,730
six or 615 you also have to hedge my
which is supposed to guarantee the

160
00:12:57,730 --> 00:13:04,350
integrity of the point system that's it
is a quick and easy once you understood

161
00:13:04,350 --> 00:13:11,400
I would store on Nov 22 extracted data
also happening call the CBD which way to

162
00:13:11,400 --> 00:13:17,209
go about later right now so the CPD
artists system configuration variables

163
00:13:17,209 --> 00:13:23,018
which is basically like a basically like
your character known good command line

164
00:13:23,019 --> 00:13:33,179
Linux or Windows its doors do level
settings so the stricter interesting

165
00:13:33,179 --> 00:13:37,499
what's really need that you had to
variable names which are referenced

166
00:13:37,499 --> 00:13:42,209
actually basic shin and number so we
don't have names in the system itself

167
00:13:42,209 --> 00:13:47,059
but if you look into sequence or do you
have all the correspondence between the

168
00:13:47,059 --> 00:13:50,860
numbers and available names
unfortunately I discovered that like

169
00:13:50,860 --> 00:13:57,990
when I was writing to slice for you talk
so just to rehearse in get demeaning and

170
00:13:57,990 --> 00:14:05,749
from names some interesting by rebels
are in the section for colonel and 440

171
00:14:05,749 --> 00:14:10,809
variables which is the flags where you
you can enable and very interesting

172
00:14:10,809 --> 00:14:18,118
stuff like kernel debug logging the GB
team East has for an internet startup

173
00:14:18,119 --> 00:14:20,119
you can also change

174
00:14:20,119 --> 00:14:25,559
sporkin entry the console spin so the
deportees 9602 it's very slow so you can

175
00:14:25,559 --> 00:14:31,089
change it up and have a faster
consultants could you say so that's one

176
00:14:31,089 --> 00:14:37,079
of the things you can find in the in the
BCS system which is read only know a few

177
00:14:37,079 --> 00:14:41,618
words about CFS to the kitchen which is
the right number one we don't know

178
00:14:41,619 --> 00:14:47,019
really but as I said before it's a table
based it's it's very interesting because

179
00:14:47,019 --> 00:14:51,559
you by default you have no guarantee
that the fires that you store in to

180
00:14:51,559 --> 00:14:56,459
display system are going to be
permanently here they can get evicted if

181
00:14:56,459 --> 00:14:59,160
there is no space and if your entries to
old

182
00:14:59,160 --> 00:15:04,939
it would get if you need space so that's
good because they actually used that

183
00:15:04,939 --> 00:15:09,219
quote system to store their settings
under settings to disappear because

184
00:15:09,220 --> 00:15:13,910
you're starting to use all the disk
space so they have some kind of regular

185
00:15:13,910 --> 00:15:18,999
is that with this prefix so if you still
refining Desai system using this perfect

186
00:15:18,999 --> 00:15:22,910
you'll get there weren t that it's going
to be treated like a regular player and

187
00:15:22,910 --> 00:15:25,540
a good deal if the space is going up

188
00:15:25,540 --> 00:15:29,980
so if you just look for legacy cash
engine into binaries get a few

189
00:15:29,980 --> 00:15:37,019
interesting things things like a risky
asset register into it which is used to

190
00:15:37,019 --> 00:15:42,459
store settings so the registry is a tree
structure a bit like the Windows

191
00:15:42,459 --> 00:15:48,410
Registry of Deeds store in an XML file
on the see it as an issue like the code

192
00:15:48,410 --> 00:15:55,029
during the injuries and referenced by
during Super D collins company come take

193
00:15:55,029 --> 00:15:59,189
a tour going to look for users will get
you all the local use of some of the

194
00:15:59,190 --> 00:16:05,490
ProxySG from the registry so from from
the usual web interface you can get an

195
00:16:05,490 --> 00:16:10,019
access to do almost complete registry as
long as you have an admin access to do

196
00:16:10,019 --> 00:16:17,899
so if you use these URLs you can access
the registry unfortunately the interface

197
00:16:17,899 --> 00:16:23,769
and sores some some of the entries so we
gotta likes best words ashes are you

198
00:16:23,769 --> 00:16:28,990
sure you want to access do you might
want to get the best words then you have

199
00:16:28,990 --> 00:16:33,089
to use the CIA extensions that are here
and then we will talk about this year

200
00:16:33,089 --> 00:16:38,870
extensions later so do something about
the storage you have a fat32 partition

201
00:16:38,870 --> 00:16:43,389
which contains a steady fuck system
called DCFS which contains all the

202
00:16:43,389 --> 00:16:47,389
banner is the basis for the USA in the
web interface and everything and then

203
00:16:47,389 --> 00:16:51,699
USC first which is the rateable storage
which contains the web data and also the

204
00:16:51,699 --> 00:16:57,240
registry so once we managed to extract
everything of course we dig into banner

205
00:16:57,240 --> 00:17:02,170
is we want you to know I would do as
friends so the boundaries you can find

206
00:17:02,170 --> 00:17:06,780
them deep into the tree of the systems
that's not very interesting but in the

207
00:17:06,780 --> 00:17:11,569
end the stripped territory where you
have all the libraries and programs and

208
00:17:11,569 --> 00:17:16,309
you can also find to colonel and drivers
in the return to face them as I said

209
00:17:16,309 --> 00:17:20,760
before you have a complete configuration
files that are interpreted by sequence

210
00:17:20,760 --> 00:17:26,199
when you sell the system unit system
which set up some variables will start

211
00:17:26,199 --> 00:17:31,220
to minors so if you go back into strips
you of all the old the binaries the

212
00:17:31,220 --> 00:17:36,460
binaries are fights everything is in
place

213
00:17:36,460 --> 00:17:45,430
so take that kind of weird cuz they
exceed $80 so I guess it's because

214
00:17:45,430 --> 00:17:50,300
version 5 where else but using PE I
don't know why the change from peach

215
00:17:50,300 --> 00:17:58,560
provision reason so you can either 32 or
64 bit version of the operating system

216
00:17:58,560 --> 00:18:05,340
mostly just depending on hardware so if
you have a very small small amount of

217
00:18:05,340 --> 00:18:10,490
RAM meant to keep rates then you get it
to be it's an issue of more than four 4

218
00:18:10,490 --> 00:18:16,150
gigabytes you will get a 64 bit version
where cya later so all the code written

219
00:18:16,150 --> 00:18:22,240
by Blue is in C++ compiler is deeply
split with a custom target so there is

220
00:18:22,240 --> 00:18:28,500
all the binaries taken together our
amount to between 70 and 80 megabytes so

221
00:18:28,500 --> 00:18:29,440
you can imagine

222
00:18:29,440 --> 00:18:34,720
besides open source libraries it was an
easy policy of around 50 or 60 megabytes

223
00:18:34,720 --> 00:18:39,490
of C++ code to reverse a junior so it's
terrible

224
00:18:39,490 --> 00:18:46,770
fortunately the batteries are not just
C++ MT three things you have a lot of

225
00:18:46,770 --> 00:18:52,710
unit tests so everybody every library is
every library integrates unit tests that

226
00:18:52,710 --> 00:18:57,510
you can trigger from the web interface
to you can make sure everything works

227
00:18:57,510 --> 00:19:01,480
correctly using the unit this which is
very good for the reverse engineer

228
00:19:01,480 --> 00:19:05,600
because there is a lot of the
information do you need I mean the big

229
00:19:05,600 --> 00:19:11,590
screens so you can get inside so what's
going on just by looking and running the

230
00:19:11,590 --> 00:19:17,970
unit also you have a few while 2600
source file names that are referenced in

231
00:19:17,970 --> 00:19:23,550
the code sometimes to display their
bikes trains sometime soon for backtrace

232
00:19:23,550 --> 00:19:29,800
or whatever so you have also information
from the source file names unfortunately

233
00:19:29,800 --> 00:19:34,290
ever seen this trip so you don't have
the internal names on the brambles or

234
00:19:34,290 --> 00:19:40,220
whatever but sits down of libraries are
a lot of dynamic libraries you have a

235
00:19:40,220 --> 00:19:46,430
lot of external symbols so for example
of a bitch did you peter is so I several

236
00:19:46,430 --> 00:19:48,340
thousands of experts

237
00:19:48,340 --> 00:19:52,830
so it gives you an idea of what's going
on in a restriction because they are

238
00:19:52,830 --> 00:19:58,029
mostly call from external minors but
they are in then they are using C++ and

239
00:19:58,029 --> 00:20:03,820
template so that's an actual symbol that
you can find in the minors when you look

240
00:20:03,820 --> 00:20:08,418
at that you just don't want to see it
and of course to make things even worse

241
00:20:08,419 --> 00:20:14,549
in 32 bits down and using the usual Abia
we're doing our mentors for to function

242
00:20:14,549 --> 00:20:21,100
that but through stuck there were
probably with savings from GCC which

243
00:20:21,100 --> 00:20:27,059
passes to arguments were registers
instead of stuck which is very annoying

244
00:20:27,059 --> 00:20:32,158
because I didn't know how to try two
types of the arguments from fiction

245
00:20:32,159 --> 00:20:39,659
fiction and 64 bits day using this
system play p.m. so the first look is

246
00:20:39,659 --> 00:20:44,710
really work when am I going to do then
you look for

247
00:20:44,710 --> 00:20:48,309
of course open source libraries because
you know that people are taking a

248
00:20:48,309 --> 00:20:52,799
person's library because it is less work
so I just took a look in trying to find

249
00:20:52,799 --> 00:20:58,080
everything that was available
open-source the first thing I was very

250
00:20:58,080 --> 00:21:02,939
interesting do the numbers up from 65 a
bit more than one year ago is their

251
00:21:02,940 --> 00:21:08,750
memory memory cater the use cold begets
was a police 1072

252
00:21:08,750 --> 00:21:14,200
was okay so it's an open source when
it's actually very good very simple but

253
00:21:14,200 --> 00:21:18,520
it's kind of surprising they're mostly
using very old versions of the libraries

254
00:21:18,520 --> 00:21:26,720
so concerned that they they were full of
false but in conference called Blue Coat

255
00:21:26,720 --> 00:21:31,370
state that they actually back proposed
to fix is regularly without necessarily

256
00:21:31,370 --> 00:21:37,610
change and emissions so they don't worry
I don't know so some some of the members

257
00:21:37,610 --> 00:21:43,770
so we have the binaries and then we
wanted to know about the kernel into

258
00:21:43,770 --> 00:21:48,520
security security mechanism that you can
have so how does it work while the

259
00:21:48,520 --> 00:21:49,990
current practice is very small

260
00:21:49,990 --> 00:21:56,179
800 kilobytes and it's just basic
primitives like like you would expect

261
00:21:56,179 --> 00:22:00,130
from accounting lecture in directing an
exception in laying semaphores lower

262
00:22:00,130 --> 00:22:06,230
message passing through processes
drivers and as as you would do in

263
00:22:06,230 --> 00:22:12,149
Windows or Linux with the Lipsy in
altitude a DLL the Qur'an is not call

264
00:22:12,149 --> 00:22:19,199
directly from the binaries obstructed
you like the library link can LAPI so if

265
00:22:19,200 --> 00:22:23,390
you want to know what's going on and
what she calls I called you just reverse

266
00:22:23,390 --> 00:22:30,020
engineer the TAPI library there is
something very interesting to ease the

267
00:22:30,020 --> 00:22:35,740
current provides at the fixed address
structure pointer to a structure which

268
00:22:35,740 --> 00:22:38,750
is kind of like destroying the
environment broken windows which

269
00:22:38,750 --> 00:22:44,169
contains the PID the name of the task to
parent PID some some of the additional

270
00:22:44,169 --> 00:22:50,399
stuff that the process my want to know
about the kernel is very small but it

271
00:22:50,399 --> 00:22:55,820
provides more than 106 goals and it's
really nice because of all the other

272
00:22:55,820 --> 00:23:02,530
nice table with an existing number next
to eat the Cisco so you don't even have

273
00:23:02,530 --> 00:23:07,090
to reverse engineer at every school to
get what's good doing just look at the

274
00:23:07,090 --> 00:23:13,730
name and so we didn't spend that much
time looking at the current low but we

275
00:23:13,730 --> 00:23:18,960
want you to know about the way to
Cisco's I don't so you have two ways to

276
00:23:18,960 --> 00:23:20,740
call this the cumo

277
00:23:20,740 --> 00:23:27,760
32 bit and 64 bits there we did the same
you just call Colgate which is the fixed

278
00:23:27,760 --> 00:23:34,470
address and your best stricture point
you buy a case where you have a return

279
00:23:34,470 --> 00:23:37,299
code will be store when you get back
from this is called and then you have

280
00:23:37,299 --> 00:23:42,590
four arguments and the Cisco number
that's a very special exactly the same

281
00:23:42,590 --> 00:23:47,879
for 64 bit except of course difference
different and the structure is 64 bit

282
00:23:47,880 --> 00:23:54,840
variables instead of 32 but that's not
the most interesting thing about comment

283
00:23:54,840 --> 00:23:58,139
you just guessed at UFC school and
everything we were really wanted to know

284
00:23:58,139 --> 00:24:04,100
about the memory organization and the
way tasks are separated

285
00:24:04,100 --> 00:24:12,678
well that was really surprising
basically everything runs in ring 0

286
00:24:12,679 --> 00:24:19,150
everything so all the task the kernel
everything in the ring 0 so I didn't

287
00:24:19,150 --> 00:24:22,919
believe it at first I was like ok we're
back to the nineties that's kind of

288
00:24:22,919 --> 00:24:30,410
where I spend a few days to make sure I
wasn't mistaken and even if you look at

289
00:24:30,410 --> 00:24:38,120
the altar in 232 gets even sometimes
almost perfect mapping between virtual

290
00:24:38,120 --> 00:24:42,320
addresses and physical addresses so when
you access a vehicle address you have a

291
00:24:42,320 --> 00:24:47,600
99% chance you actually addressing the
physical address which is really really

292
00:24:47,600 --> 00:24:51,840
impressive so I think it was thought
performance because they mentioned it in

293
00:24:51,840 --> 00:24:56,889
their patent dates from the nineties but
while so every test can run everywhere

294
00:24:56,890 --> 00:25:03,960
no pretension weather prediction from
from anything also your parenting system

295
00:25:03,960 --> 00:25:08,909
is a bit special it's not like Windows
or Linux you cannot execute binaries you

296
00:25:08,909 --> 00:25:14,030
cannot load a binary into the system and
run it you only have one choice is you

297
00:25:14,030 --> 00:25:20,649
put your mind to read only dcfs you
mention and then went to come boots

298
00:25:20,650 --> 00:25:26,080
reload every binary from the image and
relocate them so you only have then you

299
00:25:26,080 --> 00:25:30,070
only have one choice if you want to
execute something has to be first thing

300
00:25:30,070 --> 00:25:35,918
you mentioned and it has to register an
entry point and he's referring to spend

301
00:25:35,919 --> 00:25:41,630
a kernel that you can call so basically
everything has to be a moot issue to run

302
00:25:41,630 --> 00:25:46,299
something or you have to find a way to
execute code but you can adjust do and

303
00:25:46,299 --> 00:25:51,780
put your exact file and run it so it
went when we did this research we will

304
00:25:51,780 --> 00:25:56,158
see want wanted a way to get into an
internal as easily have to do everything

305
00:25:56,159 --> 00:26:02,830
statically so we looked into things to
make our job easier so first we develop

306
00:26:02,830 --> 00:26:08,030
a few tools which we are not going to
release date right now

307
00:26:08,030 --> 00:26:09,399
United

308
00:26:09,400 --> 00:26:14,640
so if you are up against to just help
from the things I said before renamed to

309
00:26:14,640 --> 00:26:19,280
school at McKinley get the function
names from the debug logs get the source

310
00:26:19,280 --> 00:26:25,050
file names from the debug logs and also
the code if you can find all the CLI

311
00:26:25,050 --> 00:26:29,909
commands that you could type and as an
administrator that are stored in a very

312
00:26:29,910 --> 00:26:34,990
nice picture and so we wanted to make
sure everything was documented of course

313
00:26:34,990 --> 00:26:40,510
some of the command and document it is
interesting to get them the most

314
00:26:40,510 --> 00:26:44,170
two most important tool to to develop
when you're working with the Blue Coat

315
00:26:44,170 --> 00:26:49,720
ProxySG is to have a way to modify the
file system very easily so we develop

316
00:26:49,720 --> 00:26:52,710
the fuse to mount the system images

317
00:26:52,710 --> 00:26:58,550
read-write access without enabling says
change because he was 22 you too complex

318
00:26:58,550 --> 00:27:04,419
to implement and also to change the
system variables so of course when you

319
00:27:04,420 --> 00:27:09,050
mount attacks system its success
disparity and so if you want to change

320
00:27:09,050 --> 00:27:13,510
some things and some codes and variables
some whatever you just have to mounted

321
00:27:13,510 --> 00:27:20,320
change it and mountain then you can put
it into your machine for example so some

322
00:27:20,320 --> 00:27:24,750
useful tricks also a to get more
information out of your boxes G is to

323
00:27:24,750 --> 00:27:29,180
enable debug information so you need to
modify the system image that you're

324
00:27:29,180 --> 00:27:30,340
going to boot

325
00:27:30,340 --> 00:27:34,669
either physical access or maybe remote
code execution so you can you should

326
00:27:34,670 --> 00:27:38,750
change the flags for the company can
enable o crees que the day book club

327
00:27:38,750 --> 00:27:43,860
when you to system starts it will put a
lot of information about what it's doing

328
00:27:43,860 --> 00:27:49,560
by default it just tells you nothing and
most people only if you change one

329
00:27:49,560 --> 00:27:55,260
variable called crista moore release in
Maine CRDT if G so if you said customer

330
00:27:55,260 --> 00:28:00,600
release 20 basically you're changing
your ProxySG to a developer mode which

331
00:28:00,600 --> 00:28:04,919
gives you access to lots of debug
commands and information which is not

332
00:28:04,920 --> 00:28:08,580
possible may default so when you enable
the development you have access to more

333
00:28:08,580 --> 00:28:13,330
than 200 she likes tensions 2012
mentioned projects the registry for

334
00:28:13,330 --> 00:28:20,429
example and you can have their low you
checked all the internals of the use of

335
00:28:20,430 --> 00:28:22,509
nine components of the ProxySG

336
00:28:22,509 --> 00:28:28,669
so you have everything to dump your
configuration showed invent your email

337
00:28:28,669 --> 00:28:33,649
for management show the state of all the
service is shown to see what's listening

338
00:28:33,649 --> 00:28:38,008
on that port by default you cannot take
that so you might want to enable debug

339
00:28:38,009 --> 00:28:43,289
and the most important feature is that
almost every component that he's running

340
00:28:43,289 --> 00:28:49,859
almost every application you can enable
a very opposed the bill blog that will

341
00:28:49,859 --> 00:28:55,198
get you a lot of internal information
saying foreign policy with the police

342
00:28:55,199 --> 00:28:59,690
had been crazy so once you enable debug
Mon you have access to a lot of

343
00:28:59,690 --> 00:29:08,539
information so that just an example for
the CAG comment also you can just read

344
00:29:08,539 --> 00:29:15,269
without since or censorship for the best
words using one of those committee also

345
00:29:15,269 --> 00:29:20,799
very interesting the kernel provides a
GBA GBC so when you look at the core of

346
00:29:20,799 --> 00:29:24,699
the kernel is very obvious that there is
a beast because you have a dream like to

347
00:29:24,699 --> 00:29:30,539
be monitoring unfortunately it's not
stopping there so I was like ok I could

348
00:29:30,539 --> 00:29:34,658
you be enabled in standing me at the
beginning of KGB many thought stunning

349
00:29:34,659 --> 00:29:41,519
and then he took me weeks maybe one or
two to get into it because you can

350
00:29:41,519 --> 00:29:45,379
access it through to come one console
but that's the console that is used by

351
00:29:45,379 --> 00:29:49,668
the administrator to administrate the
bricks the ProxySG so by default when

352
00:29:49,669 --> 00:29:55,469
you typing commands is just like you are
looking into the ProxySG so GB would

353
00:29:55,469 --> 00:30:00,259
send commands to disturb they would get
into pretty by the login prompt onto

354
00:30:00,259 --> 00:30:05,979
just going to pray so I discovered that
you have to get an exception so that the

355
00:30:05,979 --> 00:30:11,459
system gets starts listening on come on
and then you have to send a magic

356
00:30:11,459 --> 00:30:17,349
sequence of 218 important on come on and
then the kernel starts are seeing the

357
00:30:17,349 --> 00:30:21,749
commands as GB comment and let us use
your own discretion commands so once

358
00:30:21,749 --> 00:30:26,509
you've done that ok you can send GB
comments but then they are not using the

359
00:30:26,509 --> 00:30:31,009
stand on GB remote critical so we have
to make sure that either you bet your

360
00:30:31,009 --> 00:30:35,500
client or use a special command to
disable the paging because Beijing is

361
00:30:35,500 --> 00:30:40,720
and on the claims and as usual but on
the server side you'd get lay the first

362
00:30:40,720 --> 00:30:45,220
8080 lines and then it would stop
waiting for a committed to continuing

363
00:30:45,220 --> 00:30:51,110
you would have to reboot your proxy so
you have to be so you can debug thats

364
00:30:51,110 --> 00:30:55,040
recall and you also have something very
interesting and and Indian about before

365
00:30:55,040 --> 00:30:59,270
is that you can have something called
money toward extinction so he can send

366
00:30:59,270 --> 00:31:04,120
commands to the colonel and so if you
take for example many torque a noun

367
00:31:04,120 --> 00:31:09,590
process is which is the one there it
will send the stream to the chrome and

368
00:31:09,590 --> 00:31:13,520
the kernel will give you the results and
so everything is implemented in the

369
00:31:13,520 --> 00:31:18,000
kernel and so you have like to recommend
that you can run into will display all

370
00:31:18,000 --> 00:31:22,770
the kernel internals so you want to
display all the active processes once

371
00:31:22,770 --> 00:31:26,080
you if you want to have the details of
when process you can show the process

372
00:31:26,080 --> 00:31:29,980
descriptor using Peedee you can also
lists all the images running on the

373
00:31:29,980 --> 00:31:34,610
images running on the ProxySG with their
address and everything so you don't even

374
00:31:34,610 --> 00:31:39,429
have to reverse engineer liquor and want
to find out the structures the kaminsky

375
00:31:39,430 --> 00:31:45,050
do everything that's nice so if you want
to get a practical understanding of the

376
00:31:45,050 --> 00:31:49,889
proxies do one thing you might want to
take is the way it parses HTTP requests

377
00:31:49,890 --> 00:31:56,780
because that might might be the easiest
to access to her that static surfaced

378
00:31:56,780 --> 00:32:02,020
that they would go through because you
just have to do an HTTP request to the

379
00:32:02,020 --> 00:32:07,530
ProxySG issue of availability to to get
remote code execution so in practice if

380
00:32:07,530 --> 00:32:13,170
you want to check how it works well you
just made the blog you make a request

381
00:32:13,170 --> 00:32:17,590
through a proxy get the log and
fortunately you get older function names

382
00:32:17,590 --> 00:32:22,709
in the long you just have to grip the
wineries and look for it to be done so

383
00:32:22,710 --> 00:32:27,850
for the cross reference for destroying
and you got your frenchmen so that's

384
00:32:27,850 --> 00:32:32,189
just an extra from their own and there
is a distinction that is apparently very

385
00:32:32,190 --> 00:32:37,880
interesting if you want to look for
vulnerabilities pass requests but then

386
00:32:37,880 --> 00:32:40,350
you go into into that

387
00:32:40,350 --> 00:32:51,289
so that's the CFG for requests defection
16 kilobytes so of course it's a plus +

388
00:32:51,289 --> 00:32:58,240
when you have to dig into this terrible
but then you realize no policy is

389
00:32:58,240 --> 00:33:02,860
actually done by this function does
Justin logic departing in the dark cause

390
00:33:02,860 --> 00:33:07,889
to C++ object to do to passing so we
just have to look at sixteen cuba's you

391
00:33:07,890 --> 00:33:13,750
have to look at like 50 or 60 kilobytes
of code in C++ and of course it's ready

392
00:33:13,750 --> 00:33:19,929
in just easy to look so you want to
debug and not just do static reverse

393
00:33:19,929 --> 00:33:24,240
engineering so you just look for the
image space using the GV monitor

394
00:33:24,240 --> 00:33:25,490
extension

395
00:33:25,490 --> 00:33:30,120
relocate the binary night and you set a
breakpoint using this year I am proxies

396
00:33:30,120 --> 00:33:34,280
D and then you can contact unfortunately
the stepping doesn't really work so you

397
00:33:34,280 --> 00:33:39,520
have to make sure and put all your break
points in my hand I don't know so even

398
00:33:39,520 --> 00:33:47,720
though you have access to everything
that well so I told you about where we

399
00:33:47,720 --> 00:33:53,780
did I'm not going to give you a bit of
information about the security of the

400
00:33:53,780 --> 00:34:03,260
product itself so for us where the
British ins application security we do

401
00:34:03,260 --> 00:34:06,770
overall goal was to get a global
assessment of the security of the boxes

402
00:34:06,770 --> 00:34:13,219
you know just a coma and Intel's so you
should check the labels for

403
00:34:13,219 --> 00:34:20,388
authentication for example by default
local bus 43 bsmt five and then that is

404
00:34:20,389 --> 00:34:25,030
also simple as blowfish the code is
there but I don't know how to trigger

405
00:34:25,030 --> 00:34:32,899
and hashing of Barcelona's easy but you
have also a way to authenticate to me is

406
00:34:32,899 --> 00:34:38,029
everything that exists on the planet to
manage the integration ed all the

407
00:34:38,030 --> 00:34:41,440
identity management things that you can
image in Oracle

408
00:34:41,440 --> 00:34:50,418
whatever indication you also may be for
when you just buy a new box on the only

409
00:34:50,418 --> 00:34:54,819
protocol that are enabling its GPS in
this age so you don't have to know that

410
00:34:54,820 --> 00:34:58,670
they are playing this protocol that's
good that's what you get for access

411
00:34:58,670 --> 00:35:03,930
control unit only two types of accounts
so you either have full admin access or

412
00:35:03,930 --> 00:35:07,830
you have a read only account and you
cannot have fine-grained access control

413
00:35:07,830 --> 00:35:12,970
to different variables or type of
configurations we only is interesting if

414
00:35:12,970 --> 00:35:16,339
you want to just money toward the
configuration or shown to give people

415
00:35:16,339 --> 00:35:23,820
access to good deeds or take the
configuration regarding Putin trust in

416
00:35:23,820 --> 00:35:28,560
the operating system the first
interesting thing is that dates are

417
00:35:28,560 --> 00:35:33,700
signed correctly so you cannot
compromise in the door of proxies G by

418
00:35:33,700 --> 00:35:36,569
state and doing an update with a bike
tour in pushing it

419
00:35:36,570 --> 00:35:40,490
Duratec correctly the code is OK

420
00:35:40,490 --> 00:35:44,930
unfortunately or fortunately local
images so the one they are started when

421
00:35:44,930 --> 00:35:52,060
you boot really trust cristobal because
before 65 you was only a CRC for

422
00:35:52,060 --> 00:35:57,529
integrity checks and from 65 they're
creating a change in the nature make

423
00:35:57,530 --> 00:36:03,600
sure one well took me less than two
hours to get the key so wasn't really an

424
00:36:03,600 --> 00:36:07,359
option protection and talk about talk
about that later

425
00:36:07,359 --> 00:36:11,250
again also when you want to check
application security you want to check

426
00:36:11,250 --> 00:36:13,130
that the crypto is done correctly

427
00:36:13,130 --> 00:36:18,970
almost everything is basement of an Asus
oh and they get the latest version so

428
00:36:18,970 --> 00:36:24,250
the best one maybe but at least it's not
their own custom curtain that their own

429
00:36:24,250 --> 00:36:29,530
and make sure that the patches that
should regularly and everything that is

430
00:36:29,530 --> 00:36:35,980
critical we gonna do security regaining
ground for example in generating private

431
00:36:35,980 --> 00:36:42,630
keys or or whatever is leading run them
securely open a center and they are

432
00:36:42,630 --> 00:36:48,780
using an entropy generator that seems
pretty well so it was good so basically

433
00:36:48,780 --> 00:36:51,690
application security is not that better
probably

434
00:36:51,690 --> 00:36:58,960
if you look into mister she need to pace
to different flavors the new one is the

435
00:36:58,960 --> 00:37:08,060
interface it's nice and well its
national but then you get worse than the

436
00:37:08,060 --> 00:37:12,640
real thing to put into place the one you
can do everything with is you know

437
00:37:12,640 --> 00:37:17,810
that's the kind of interface sure you
have your special Windows XP VMware ESX

438
00:37:17,810 --> 00:37:22,390
and Java 6 plugin that you don't want to
connect to the internet that the kind of

439
00:37:22,390 --> 00:37:27,160
interface we're talking about so
everything is running into any opinion

440
00:37:27,160 --> 00:37:34,890
but what's really interesting it's a bus
interface is actually posting CLI

441
00:37:34,890 --> 00:37:42,210
commands 222 a new URL so it does just
from tends to the CLI and if you

442
00:37:42,210 --> 00:37:46,130
remember that two types of accounts are
read only accounts and admin accounts

443
00:37:46,130 --> 00:37:53,589
and even for read only users posting
comments to enable she'll read only

444
00:37:53,589 --> 00:37:56,190
enable what could possibly go wrong

445
00:37:56,190 --> 00:38:01,480
like till it depicts two security number
eighty's a few years ago when it was

446
00:38:01,480 --> 00:38:07,010
very easy to do a privilege escalation
using this but then they restricted

447
00:38:07,010 --> 00:38:12,010
command so in theory you shouldn't be
able to modify the configuration because

448
00:38:12,010 --> 00:38:16,420
they restrict you to a set of commands
but I guess I didn't really look into it

449
00:38:16,420 --> 00:38:22,460
but I guess it well can probably go
brown also the gentle kisses something

450
00:38:22,460 --> 00:38:23,510
very special

451
00:38:23,510 --> 00:38:28,829
busy mechanism which is not really
interesting but instead of using HTTPS

452
00:38:28,829 --> 00:38:34,900
connection from the browser to actually
do a new connection using the Java stack

453
00:38:34,900 --> 00:38:39,160
and to connect to the post the commands
I don't know where that money is the

454
00:38:39,160 --> 00:38:42,990
mantra browser so you have to
necessarily stack that connected the

455
00:38:42,990 --> 00:38:48,009
same thing I don't have the same
security properties with what could

456
00:38:48,010 --> 00:38:53,180
possibly go wrong so just an example if
you want to use when you go to the gym

457
00:38:53,180 --> 00:38:57,660
interface shows you the version and it's
actually sending this request to

458
00:38:57,660 --> 00:39:02,330
December and you have to show version
command and then you have to replace

459
00:39:02,330 --> 00:39:08,170
there you know even have the ProxySG
prompt and you get to come and then the

460
00:39:08,170 --> 00:39:14,930
result we just bought so interesting so
foreign to summarize system of

461
00:39:14,930 --> 00:39:16,830
insecurity what you said before

462
00:39:16,830 --> 00:39:24,430
well some bad things first the code is
compiled with gcc but they didn enable

463
00:39:24,430 --> 00:39:30,279
the stock predictor so that countries if
you have a slow game over

464
00:39:30,280 --> 00:39:37,220
no yes there are so over everything in
10 came over Colgate

465
00:39:37,220 --> 00:39:44,069
address over but everything has been
actually you have a nixon able and most

466
00:39:44,070 --> 00:39:51,180
platforms and actually seems delayed
annex enabled everywhere to begin keep

467
00:39:51,180 --> 00:39:56,450
from the seventies they actually have
nice herself so they compared their

468
00:39:56,450 --> 00:40:02,350
search in and you don't have the way to
do you trust you call a nigga attacks

469
00:40:02,350 --> 00:40:08,330
like today's Dec actually you're running
version 5

470
00:40:08,330 --> 00:40:14,560
they don't have their s efforts so if
you if you're running about 15 to 65 or

471
00:40:14,560 --> 00:40:20,380
so well the read only file system for
binaries dcfs we are there to back door

472
00:40:20,380 --> 00:40:24,480
in the us- because even to get remote
code execution if you want to modify one

473
00:40:24,480 --> 00:40:28,920
binary or if you want to to make
something persistent on the on the on

474
00:40:28,920 --> 00:40:35,120
the cold side while you really have to
implement your parcel for the fact

475
00:40:35,120 --> 00:40:40,060
system and make sure you can motivate
each decir CRH bank so it's not like you

476
00:40:40,060 --> 00:40:46,920
can W gets back door in the running
running as root it's not really easy and

477
00:40:46,920 --> 00:40:50,520
so basically you need good executive
physical access to change a system image

478
00:40:50,520 --> 00:40:55,350
because well the dates are signed the
only ways to modify on the disc so let's

479
00:40:55,350 --> 00:41:01,140
not dead man and if you want to look
specifically into exploit ability so

480
00:41:01,140 --> 00:41:05,279
well what do we have that preceded it
exploits while you have the previous

481
00:41:05,280 --> 00:41:06,220
lives where

482
00:41:06,220 --> 00:41:11,770
08 are never think of course it's C++
HMO's everywhere you have function

483
00:41:11,770 --> 00:41:15,340
pointers everywhere raking in over
rights and get access to

484
00:41:15,340 --> 00:41:19,860
you too could execution if you ever
before and also it's raining C++ code so

485
00:41:19,860 --> 00:41:24,810
it's not like it's running a script
language where it's usually safer

486
00:41:24,810 --> 00:41:32,480
regarding memory cards but now you have
two things that are really a pain if you

487
00:41:32,480 --> 00:41:37,130
want to run an exploit because first
your ring 0 so you don't have any

488
00:41:37,130 --> 00:41:42,800
protection against memory access memory
access because you can just for example

489
00:41:42,800 --> 00:41:48,210
by person makes my changing deputies or
whatever but then if you fare well you

490
00:41:48,210 --> 00:41:54,590
reboot the system so it's going to abuse
you don't have a SLR but then remembered

491
00:41:54,590 --> 00:41:59,570
the binaries are marked the beginning of
the boot so takes all the banners from

492
00:41:59,570 --> 00:42:06,150
the system and that's them into memory
is continuously so every version as a

493
00:42:06,150 --> 00:42:11,170
different starting address for banner is
because if you change your one battery

494
00:42:11,170 --> 00:42:15,800
the size changes in the position in
memory will change so you don't have to

495
00:42:15,800 --> 00:42:23,130
fix a dress like a p/e that would get
loaded 40000 in on Windows so you would

496
00:42:23,130 --> 00:42:28,540
have to have a very precise fingerprints
of the Blue Coat ProxySG to make sure

497
00:42:28,540 --> 00:42:32,410
you have the right under asses but if
you have it then you have noise that are

498
00:42:32,410 --> 00:42:33,790
so that's it

499
00:42:33,790 --> 00:42:40,040
of course then well that's obvious that
you have a custom OS so you're not going

500
00:42:40,040 --> 00:42:44,120
to use my destroyed or meetup return
process do you have to write your own

501
00:42:44,120 --> 00:42:48,620
custom people to make a backdoor
accounts or whatever so it takes

502
00:42:48,620 --> 00:42:53,420
sometimes and also apparently agency it
myself but local tell me that they have

503
00:42:53,420 --> 00:43:00,490
guard pages somewhere so it might be
heard on for exploitation so

504
00:43:00,490 --> 00:43:07,240
if you want you can clean about the
security of the ProxySG well I think

505
00:43:07,240 --> 00:43:12,830
what's more interesting is you know I
completely unusual and entirely

506
00:43:12,830 --> 00:43:19,390
proprietary OS design which is even
though the security is kind of dated you

507
00:43:19,390 --> 00:43:24,029
you feel the design of the nineties to
colonel the code and affect the

508
00:43:24,030 --> 00:43:28,290
operating system itself is actually a
very well designed for what it meant

509
00:43:28,290 --> 00:43:34,310
poor performance and web caching so it
didn't really gradient to nowadays

510
00:43:34,310 --> 00:43:41,509
security standards not yet but it's
really good design the guys know what

511
00:43:41,510 --> 00:43:42,430
they're talking about

512
00:43:42,430 --> 00:43:50,049
also well know cornel usery's isolation
or exploit was can't really expect in

513
00:43:50,050 --> 00:43:55,570
the ring 0 I was really surprised I
guess it in the end the beginning was

514
00:43:55,570 --> 00:43:59,160
ready for performance because twenty
years ago or maybe she's ten years ago

515
00:43:59,160 --> 00:44:04,629
the performance up to hardware it was
re- not as good as today so it didn't

516
00:44:04,630 --> 00:44:10,580
really change and evaluate doing banks
now also I didn't really look for

517
00:44:10,580 --> 00:44:16,230
breaches per se just took a quick look
at new functions but I didn't find any

518
00:44:16,230 --> 00:44:23,780
abuse so that's not then but then if you
look at the release notes every new

519
00:44:23,780 --> 00:44:28,770
version they documented few software
restarts and so if you're looking to the

520
00:44:28,770 --> 00:44:35,670
details is like so if you can send this
kind of freaked where's there is down

521
00:44:35,670 --> 00:44:41,430
there it is not really respected you
have well read 0 full reboot so I guess

522
00:44:41,430 --> 00:44:49,960
you can probably find us to explode into
code so what recommendations for better

523
00:44:49,960 --> 00:44:55,750
security was boxes G and their beauty of
abuse but you did the KGB land or land

524
00:44:55,750 --> 00:44:59,730
for administration that baby fault you
don't have a way to do that easily so

525
00:44:59,730 --> 00:45:04,070
you have to dig into the documentation
you don't want to expose your job stuff

526
00:45:04,070 --> 00:45:10,440
222222 nets you just want you money till
they have been logged in

527
00:45:10,440 --> 00:45:13,450
mostly to investigate moot because if
you get a reboot

528
00:45:13,450 --> 00:45:17,939
we're rebooting your proxy gee maybe
well that someone tried to do and

529
00:45:17,940 --> 00:45:22,140
running explode and it so you want to
take then also since you don't have any

530
00:45:22,140 --> 00:45:26,960
secure boot mechanism yet you want you
physically protect your appliances to

531
00:45:26,960 --> 00:45:31,270
avoid someone putting the door into your
eyes and of course you when you secure

532
00:45:31,270 --> 00:45:38,220
passwords so that's the recommendations
so that didn't exist my origional

533
00:45:38,220 --> 00:45:43,970
presentation that was meant for sale is
the security enhancement in practice so

534
00:45:43,970 --> 00:45:50,348
we had quite a few discussions with on
what they could do to what they can do

535
00:45:50,349 --> 00:45:57,320
to improve the security so they made
sure recently that support was added in

536
00:45:57,320 --> 00:46:02,540
every version of support prices judaism
both in right now they also change

537
00:46:02,540 --> 00:46:06,359
things one thing that is really
interesting is changing system a

538
00:46:06,359 --> 00:46:11,839
tradition so you didn't reach into
mechanism but they publish the hash of

539
00:46:11,839 --> 00:46:19,730
every version of proxies did they
released so you can check and type a

540
00:46:19,730 --> 00:46:26,890
command to Abdul and every Tuesday
measures and check them against a schism

541
00:46:26,890 --> 00:46:33,540
so it's not a perfect security measure
because someone remote code execution in

542
00:46:33,540 --> 00:46:37,970
a bugged or it can change the hashes but
if you have an update there to keep up

543
00:46:37,970 --> 00:46:44,339
with all the updates so that's not the
best but it's it's a start and actually

544
00:46:44,339 --> 00:46:50,069
working on secure boots right now and it
should be available in a future release

545
00:46:50,069 --> 00:46:54,990
so that's good and of course they
removed everything that was the big

546
00:46:54,990 --> 00:47:00,410
related so you don't have any GB for CLI
commands anymore in the latest version

547
00:47:00,410 --> 00:47:05,759
so if you want to research voices really
recommend you to go to the older

548
00:47:05,760 --> 00:47:09,760
versions are you still have to debug
information and

549
00:47:09,760 --> 00:47:16,280
GB support and we are still discussing
with and they they really consider

550
00:47:16,280 --> 00:47:21,840
implementing the separation between user
and supervised are all super separation

551
00:47:21,840 --> 00:47:26,380
because they're actually supports that
it's just a configuration variable depth

552
00:47:26,380 --> 00:47:31,140
to change a combined time so they just
have to recompile Ruiz brings a ring 3

553
00:47:31,140 --> 00:47:34,560
separation and make sure the performance
is still good with the current are rare

554
00:47:34,560 --> 00:47:38,180
so they're going to do that soon

555
00:47:38,180 --> 00:47:41,379
well that concludes to talk

556
00:47:41,380 --> 00:47:45,010
thank you very much for attending an
issue of any question and be able to

557
00:47:45,010 --> 00:47:53,570
enter

558
00:47:53,570 --> 00:48:07,850
so a bit more than two months full time
but depending where she went off my

559
00:48:07,850 --> 00:48:12,640
colleagues directly working the party
system a few years before so I think if

560
00:48:12,640 --> 00:48:18,080
we take everything into account is
probably like three months full time so

561
00:48:18,080 --> 00:48:40,350
long but not too long and other question
yeah yes you might want to check here

562
00:48:40,350 --> 00:48:47,440
why I yes that's well one of the things
do go tell me when it first seems like

563
00:48:47,440 --> 00:48:52,810
yeah but you know you have access to
blue it's not really easy to get $100

564
00:48:52,810 --> 00:49:00,680
and eBay case an old one it's a small
one but you get you get the code and at

565
00:49:00,680 --> 00:49:05,270
some point you could go for the right
spring and get access to FTP server

566
00:49:05,270 --> 00:49:11,480
where you had a few matches music very
recent versions they kind of deleting

567
00:49:11,480 --> 00:49:16,530
them today since but don't know why but
the end are getting access to move but

568
00:49:16,530 --> 00:49:24,780
it's not really hard if you you can get
access to some plants his people and the

569
00:49:24,780 --> 00:49:33,970
other question

570
00:49:33,970 --> 00:49:46,060
data I know I didn't really try feeding

571
00:49:46,060 --> 00:49:50,400
reverse engineering to get an overview
of everything but we didn't try for

572
00:49:50,400 --> 00:50:02,930
thing saying you're looking for more
stuff any other question well thank you

573
00:50:02,930 --> 00:50:03,319
very much

