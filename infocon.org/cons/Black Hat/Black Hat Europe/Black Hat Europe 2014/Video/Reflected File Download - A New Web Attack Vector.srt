1
00:00:00,070 --> 00:00:04,230
so just before we merely get started on
one in

2
00:00:04,230 --> 00:00:07,230
do small intro and ask you

3
00:00:07,230 --> 00:00:10,290
1/2 what if I could download

4
00:00:10,290 --> 00:00:15,900
executable files from almost anywhere
including highly trusted web sites

5
00:00:15,900 --> 00:00:18,990
like Google and be what if

6
00:00:18,990 --> 00:00:22,970
one school Eagles file executed
immediately

7
00:00:22,970 --> 00:00:26,710
without any warnings to the user and
enable attackers

8
00:00:26,710 --> 00:00:31,039
to gain full control overdue user's
machine

9
00:00:31,039 --> 00:00:36,540
well RF the reflective file download is
in UN attack vector

10
00:00:36,540 --> 00:00:41,510
that enables attackers just that to gain
full control over the user's machine

11
00:00:41,510 --> 00:00:45,460
by here chill the downloading files

12
00:00:45,460 --> 00:00:49,170
arm from highly trusted domains

13
00:00:49,170 --> 00:00:52,379
and relief can be as simple as this
unique

14
00:00:52,379 --> 00:00:55,949
simply see a valid link for example to
Google Doc com

15
00:00:55,949 --> 00:01:00,059
I am you click ahead you get that
download

16
00:01:00,059 --> 00:01:03,660
and if you open it in this case and
shutting down your PC

17
00:01:03,660 --> 00:01:07,030
but in other cases it could do a lot
worse

18
00:01:07,030 --> 00:01:11,119
so if you wanna be an RFD expert

19
00:01:11,119 --> 00:01:14,530
I'm going to release a white paper with
all the tiny bits

20
00:01:14,530 --> 00:01:18,290
of the details for your convenience that
you follow my twitter

21
00:01:18,290 --> 00:01:22,619
on for my team's work and blog you'll
find the white paper there

22
00:01:22,619 --> 00:01:26,390
soon enough I hope that in the upcoming
weeks on

23
00:01:26,390 --> 00:01:29,780
this week or the week after it's going
to be available for you

24
00:01:29,780 --> 00:01:33,759
well it's the last stop for today

25
00:01:33,759 --> 00:01:38,600
so while let's get the party started in
the summer

26
00:01:38,600 --> 00:01:42,140
yet some are high be sound

27
00:01:42,140 --> 00:01:42,780
well

28
00:01:42,780 --> 00:01:46,350
do and have a month ago exactly two and
a half month ago

29
00:01:46,350 --> 00:01:50,320
I was on my way to handle only lasts
Vegas

30
00:01:50,320 --> 00:01:53,940
while Last Vegas is still amazing

31
00:01:53,940 --> 00:01:57,390
and especially around summertime it has

32
00:01:57,390 --> 00:02:01,540
some of the best pool party is in the
world you should check it out

33
00:02:01,540 --> 00:02:05,030
I am any also has

34
00:02:05,030 --> 00:02:08,670
still many fantastic

35
00:02:08,670 --> 00:02:13,340
amazing be used for beautiful

36
00:02:13,340 --> 00:02:18,420
the security professionals and

37
00:02:18,420 --> 00:02:22,989
there are gathering together in two
major security conference is the first

38
00:02:22,989 --> 00:02:24,900
one is black at followed by

39
00:02:24,900 --> 00:02:29,319
death got now why I'm even telling you
this

40
00:02:29,319 --> 00:02:33,519
because he realized standing in the
middle of the room full

41
00:02:33,519 --> 00:02:37,180
of security professionals talking about
security yet

42
00:02:37,180 --> 00:02:42,500
and I was telling those guys about
reflected file download the new attack

43
00:02:42,500 --> 00:02:47,840
the new when attacked a clear that I
created and how powerful I think it wise

44
00:02:47,840 --> 00:02:51,750
and what do you know they liked it they
told me

45
00:02:51,750 --> 00:02:58,100
you are right about it this is an issue
we should definitely fix that and I was

46
00:02:58,100 --> 00:02:59,440
excited

47
00:02:59,440 --> 00:03:03,500
I was living the dream because there is
nothing more joyful for a security

48
00:03:03,500 --> 00:03:04,480
professional

49
00:03:04,480 --> 00:03:09,290
then being told that you're right by
other security professionals

50
00:03:09,290 --> 00:03:16,290
am I not right so excitement cat on
growing

51
00:03:16,489 --> 00:03:19,530
as under very last day of my trip to
Vegas

52
00:03:19,530 --> 00:03:22,549
I get this email telling me that might
talk about

53
00:03:22,549 --> 00:03:25,799
reflect the file download got except
dead to black at your

54
00:03:25,799 --> 00:03:29,760
and I get a chance to convince other
security professionals

55
00:03:29,760 --> 00:03:34,120
that RFD is of some concern so by now

56
00:03:34,120 --> 00:03:38,579
you probably know that talk is about
reflected file download you probably

57
00:03:38,579 --> 00:03:39,200
know

58
00:03:39,200 --> 00:03:43,900
this is and you Wed attack vector about
what I haven't told you yet

59
00:03:43,900 --> 00:03:47,680
as that my name is or in half if and a
security

60
00:03:47,680 --> 00:03:52,760
I researcher for trust lace bridal ads
and i wanna thank you all for staying

61
00:03:52,760 --> 00:03:53,849
needed a stock

62
00:03:53,849 --> 00:03:57,739
an urge the last stop for today I'll be
you can find it interesting

63
00:03:57,739 --> 00:04:02,659
and really it's been a great conference
so kudos to the organizers

64
00:04:02,659 --> 00:04:05,870
and was really high class im gonna try
to maintain

65
00:04:05,870 --> 00:04:10,530
this level and before we start arm

66
00:04:10,530 --> 00:04:14,769
and African fence something I'm a
control freak and I like to know exactly

67
00:04:14,769 --> 00:04:16,150
what's going to happen so

68
00:04:16,150 --> 00:04:20,849
the first light for today's the agenda
so you you'll know what's coming up

69
00:04:20,849 --> 00:04:25,120
and we gonna set some objectives because
I'm here for a reason and there is

70
00:04:25,120 --> 00:04:25,849
something

71
00:04:25,849 --> 00:04:29,110
for you to take whether you are a
builder

72
00:04:29,110 --> 00:04:32,289
a break here already fender web
applications

73
00:04:32,289 --> 00:04:37,060
there is something I want you to take
item this session and surprise surprise

74
00:04:37,060 --> 00:04:41,289
the majority of the top beginning vast
in understanding

75
00:04:41,289 --> 00:04:47,289
reflected file download and will do this
by answering DoD three simple questions

76
00:04:47,289 --> 00:04:51,099
what is reflected font download what is
it all about

77
00:04:51,099 --> 00:04:57,039
why why should I care about it what's
the motivation behind the attack

78
00:04:57,039 --> 00:05:01,710
and of course that technical how to use
and technical details

79
00:05:01,710 --> 00:05:05,710
and eventually and that some advanced
exploitation

80
00:05:05,710 --> 00:05:10,250
of weirdos who you wanna get and ok a
little bit more technical

81
00:05:10,250 --> 00:05:13,860
about it so I've got a plan

82
00:05:13,860 --> 00:05:17,360
we gonna understand what is reflected
file download by each

83
00:05:17,360 --> 00:05:20,930
showing you a demo and analyzing the
damaged by

84
00:05:20,930 --> 00:05:24,620
by Dan I hope you'll get a general idea
of

85
00:05:24,620 --> 00:05:31,580
what is a reflected file download then
we gonna talk about a movie beige in

86
00:05:31,580 --> 00:05:36,530
behind the attack why would a checkers
choose this watery implications

87
00:05:36,530 --> 00:05:41,469
and we gonna also talk about that trust
model for Web

88
00:05:41,469 --> 00:05:45,240
now wants to know didn't address below I
should have said

89
00:05:45,240 --> 00:05:49,060
the lack of Trance model for web
downloads

90
00:05:49,060 --> 00:05:52,990
and how would really fuels up the
motivation

91
00:05:52,990 --> 00:05:56,030
are behind this attack and of course

92
00:05:56,030 --> 00:06:00,150
it's a technical conference L not been
spared the details

93
00:06:00,150 --> 00:06:02,160
up how to detect how to X

94
00:06:02,160 --> 00:06:05,790
boy and how to pierre Yves and RFT

95
00:06:05,790 --> 00:06:11,010
and we gonna do this by taking a real
example the real attack that I did on

96
00:06:11,010 --> 00:06:11,830
Google

97
00:06:11,830 --> 00:06:16,990
and reconstructing it together from
scratch so you'll have no excuses

98
00:06:16,990 --> 00:06:21,190
when you decide you wanna find your RFT
vulnerabilities

99
00:06:21,190 --> 00:06:25,130
well let me tell you just a tiny bit
about myself

100
00:06:25,130 --> 00:06:29,360
arm this Saturday I turn 28

101
00:06:29,360 --> 00:06:34,270
I this is like a big issue for me

102
00:06:34,270 --> 00:06:38,080
and anyways this reminds me that I've
been doing martial arts

103
00:06:38,080 --> 00:06:42,450
for the last nine years II kedo inkatha

104
00:06:42,450 --> 00:06:46,920
day and it's been a rough start as you
can see on the one hit in the floor

105
00:06:46,920 --> 00:06:51,700
on all three pictures but persistence
pays off

106
00:06:51,700 --> 00:06:55,840
and to downbeat in this other guy arm

107
00:06:55,840 --> 00:06:59,800
and using a lot of the concert out of
martial arts when

108
00:06:59,800 --> 00:07:04,740
I C one obligation so I'm be breaking
well implications for the last seven

109
00:07:04,740 --> 00:07:06,420
years this is what I do

110
00:07:06,420 --> 00:07:09,960
arm I've got it can always buy major
companies

111
00:07:09,960 --> 00:07:13,830
for finding bugs in the software whole
faints bad bounties

112
00:07:13,830 --> 00:07:17,510
arm and also add that if you see these
on my name

113
00:07:17,510 --> 00:07:20,580
so I believe I do know what my way
around

114
00:07:20,580 --> 00:07:25,160
web security but we're not here to talk
about myself

115
00:07:25,160 --> 00:07:29,450
we're here for a reason and this reason
is that I want

116
00:07:29,450 --> 00:07:33,760
you to take something out of this so if
you're a break here

117
00:07:33,760 --> 00:07:37,890
of web publications if you are a pen
testers

118
00:07:37,890 --> 00:07:41,750
if you're engaged insecurity audits for
your clients

119
00:07:41,750 --> 00:07:45,780
I N one gg be able to detect and report

120
00:07:45,780 --> 00:07:49,640
are if the issues now

121
00:07:49,640 --> 00:07:52,960
on the other hand if you are at the
fender

122
00:07:52,960 --> 00:07:56,650
if you are involved in configuration of
web servers

123
00:07:56,650 --> 00:08:00,960
if you have a security product if you
control the web application firewall

124
00:08:00,960 --> 00:08:04,370
you'll be able to block and prevent

125
00:08:04,370 --> 00:08:07,880
are the issues with is a few rebuild
their

126
00:08:07,880 --> 00:08:11,410
websites if you're a developer you gonna
be a better developer

127
00:08:11,410 --> 00:08:13,940
and you can ride more secure APIs

128
00:08:13,940 --> 00:08:20,350
and websites now this is a very good
friend of mine

129
00:08:20,350 --> 00:08:25,120
I like to introduce it you do this
little fellow this is Windows calculator

130
00:08:25,120 --> 00:08:29,670
90 the majority of the I did audience
might know this already

131
00:08:29,670 --> 00:08:33,710
but when this little fellow pops up it
means game over

132
00:08:33,710 --> 00:08:37,930
means we've got control over the machine
the checkered chooses to do it is says

133
00:08:37,930 --> 00:08:39,520
is very obvious and it's a

134
00:08:39,520 --> 00:08:43,960
great proof-of-concept but we could have
were made at NBC we could install trip

135
00:08:43,960 --> 00:08:44,960
to low cares

136
00:08:44,960 --> 00:08:49,220
we can shut down that the PC whatever so
let's watch the demo

137
00:08:49,220 --> 00:08:55,510
now let me walk you through what you're
seeing here

138
00:08:55,510 --> 00:09:00,000
as did Google+ page for in Google glass
you know this

139
00:09:00,000 --> 00:09:03,540
gluten special glasses they're
developing and there's been a long wait

140
00:09:03,540 --> 00:09:03,870
in

141
00:09:03,870 --> 00:09:08,510
Google glass any later so what I D Day
posted on this forum

142
00:09:08,510 --> 00:09:11,660
I Hugo this is the Google Doc com link

143
00:09:11,660 --> 00:09:15,180
HTTPS playing to the glass installer
that you

144
00:09:15,180 --> 00:09:18,460
will get you your any layer or whatever

145
00:09:18,460 --> 00:09:22,730
and once you click on it you can see
data file get download

146
00:09:22,730 --> 00:09:28,830
from Google dot com now this build up
trust and if you click on this file

147
00:09:28,830 --> 00:09:33,230
with no warning that's it that's game
over for the user

148
00:09:33,230 --> 00:09:37,490
now RFP as the web application issue

149
00:09:37,490 --> 00:09:40,630
and to prove it we gonna take this lead

150
00:09:40,630 --> 00:09:44,930
I'm we gonna pasted in different
browsers so let's take this link for

151
00:09:44,930 --> 00:09:46,440
done this with Firefox

152
00:09:46,440 --> 00:09:49,470
let's take it to crime and crime is a
min Raider

153
00:09:49,470 --> 00:09:53,060
because he doesn't even ask you if you
want to download a file just

154
00:09:53,060 --> 00:09:58,550
downloaded and again thing oblique no
running from the operating system

155
00:09:58,550 --> 00:10:02,290
and your exploit executes now I E

156
00:10:02,290 --> 00:10:06,930
I E takes a bit longer soap let me just
help I E for a bit

157
00:10:06,930 --> 00:10:11,010
yet well yeah just a sec n

158
00:10:11,010 --> 00:10:15,800
mile it's gonna happen eventually well
if the user is still here

159
00:10:15,800 --> 00:10:19,530
than when you click the when he clicks
there ron

160
00:10:19,530 --> 00:10:25,620
about an that said and it's working on
IE as well

161
00:10:25,620 --> 00:10:29,230
so now Denise on a demo last talk about
it what

162
00:10:29,230 --> 00:10:32,590
what actually happened here well the
user

163
00:10:32,590 --> 00:10:35,660
cool economic Valley glean to Google dot
com

164
00:10:35,660 --> 00:10:40,560
wants a once this happened and lish of

165
00:10:40,560 --> 00:10:44,360
militias file get downloaded from Google
Doc com

166
00:10:44,360 --> 00:10:48,070
and one school league are employed
executed without

167
00:10:48,070 --> 00:10:52,520
any popups or morning and long leave
windows calculator

168
00:10:52,520 --> 00:10:56,250
and that's a pretty simple attack flow

169
00:10:56,250 --> 00:11:01,950
and in order to get this level of
religious we normally have to use

170
00:11:01,950 --> 00:11:06,850
fancy browser bonds and warner bill it
is intended

171
00:11:06,850 --> 00:11:11,270
involves very technical people messing
up with the memory

172
00:11:11,270 --> 00:11:14,690
this is not the case with our if the
anyone

173
00:11:14,690 --> 00:11:17,910
any script kiddie can create this type
of

174
00:11:17,910 --> 00:11:21,760
exploit so by now

175
00:11:21,760 --> 00:11:24,910
I I want to lean on something I haven't
seen

176
00:11:24,910 --> 00:11:28,150
show you but no upload takes place

177
00:11:28,150 --> 00:11:31,980
I don't have upload privileges to any
global web server

178
00:11:31,980 --> 00:11:36,010
but if I'll get downloaded to disk in
the last

179
00:11:36,010 --> 00:11:40,390
ap load last downloads and I really like
this term because it's

180
00:11:40,390 --> 00:11:46,890
million reflects what the attack is so
by now I hope you get

181
00:11:46,890 --> 00:11:51,470
in general I D just a general idea what
is reflected file download

182
00:11:51,470 --> 00:11:55,890
but why would this be an attack vector
of choice

183
00:11:55,890 --> 00:12:00,030
for attackers will you can gain full
control

184
00:12:00,030 --> 00:12:04,310
already uses machine what else do you
want that's as far as I can go

185
00:12:04,310 --> 00:12:08,160
I can break it for you to like a
gazillion different ball at

186
00:12:08,160 --> 00:12:12,910
by this is pretty much it and it
circumvents confidentiality can steal

187
00:12:12,910 --> 00:12:14,500
everything on this machine

188
00:12:14,500 --> 00:12:18,000
it circumvents the availability format

189
00:12:18,000 --> 00:12:21,400
a-minus staff is a great command and I

190
00:12:21,400 --> 00:12:24,980
also damages integrity and I'm going to
show you

191
00:12:24,980 --> 00:12:29,200
something interesting in the majority of
when attacks

192
00:12:29,200 --> 00:12:33,630
we are locked within the browser are if
the

193
00:12:33,630 --> 00:12:37,120
take such a step our own up the browser

194
00:12:37,120 --> 00:12:40,390
interior operating system blacked

195
00:12:40,390 --> 00:12:43,820
we gonna get back into your browser but
with

196
00:12:43,820 --> 00:12:47,520
superpowers you get complete control
over chrome

197
00:12:47,520 --> 00:12:51,260
get cookies for any website from any
domain

198
00:12:51,260 --> 00:12:56,430
perform actions and still data off it to
this will be in the advance exploitation

199
00:12:56,430 --> 00:12:57,010
part

200
00:12:57,010 --> 00:13:01,770
now why wouldn't I just hit a point now
where

201
00:13:01,770 --> 00:13:05,540
and put it somewhere like on hosting
service

202
00:13:05,540 --> 00:13:09,030
why do you need RFT will to

203
00:13:09,030 --> 00:13:12,070
on 3rd this question we need to
understand

204
00:13:12,070 --> 00:13:16,130
how do we trust dowload what makes a
stressed downloads

205
00:13:16,130 --> 00:13:20,860
and to answer this question we need to
understand how do we trust

206
00:13:20,860 --> 00:13:25,890
web sites and we do have a trust model
for Web sites

207
00:13:25,890 --> 00:13:29,420
now there's no better example than
online banking banking

208
00:13:29,420 --> 00:13:32,540
the old used online banking and

209
00:13:32,540 --> 00:13:37,120
obviously we trust its own let's just
take on the leaves the number one bank

210
00:13:37,120 --> 00:13:42,130
in the US and this band has nothing to
do with

211
00:13:42,130 --> 00:13:45,160
RFT so please don't sue me and

212
00:13:45,160 --> 00:13:49,040
suggest a good example for how good
website looks

213
00:13:49,040 --> 00:13:52,350
arm well a lot of users

214
00:13:52,350 --> 00:13:56,480
not think about it look at this website
what makes you trusted

215
00:13:56,480 --> 00:14:00,130
what of course for a lot of user it's
the number

216
00:14:00,130 --> 00:14:06,870
of locks in the page will therefore
locks here so it makes us feel so secure

217
00:14:06,870 --> 00:14:10,250
and this is something I notice a lot
you're getting like

218
00:14:10,250 --> 00:14:14,400
chapel blocks from everywhere the you've
gotta feel secure

219
00:14:14,400 --> 00:14:18,470
but we do you actually have a trust
model for when

220
00:14:18,470 --> 00:14:22,410
up for web sites right especially HTTPS
web site

221
00:14:22,410 --> 00:14:25,490
if the ATP asses really HTP ash

222
00:14:25,490 --> 00:14:29,330
arm and you can see the entire

223
00:14:29,330 --> 00:14:33,410
address bar is like glowing green now
that's a pretty obvious security

224
00:14:33,410 --> 00:14:34,470
indicator

225
00:14:34,470 --> 00:14:38,329
the domain name as well is what we're
expecting it to be

226
00:14:38,329 --> 00:14:41,579
and that a certificate was

227
00:14:41,579 --> 00:14:44,769
find and issued for their rightful owner

228
00:14:44,769 --> 00:14:48,509
%uh distill me so if you think about it
we

229
00:14:48,509 --> 00:14:53,170
are not resting website we're trusting
domain names

230
00:14:53,170 --> 00:14:57,029
now its

231
00:14:57,029 --> 00:15:01,040
all about the trust this doesn't answer
yet how do we trust download

232
00:15:01,040 --> 00:15:04,519
and really really it's all about
trusting the download

233
00:15:04,519 --> 00:15:08,999
and if you failed to do this if you
trust the wrong download you can get the

234
00:15:08,999 --> 00:15:11,470
operating system dement severely

235
00:15:11,470 --> 00:15:18,470
as demonstrated in the following video
yep

236
00:15:19,290 --> 00:15:23,019
so we definitely want to get this one
right we don't do that then that's

237
00:15:23,019 --> 00:15:24,230
pretty painful

238
00:15:24,230 --> 00:15:27,619
om I know we can watch it all day but

239
00:15:27,619 --> 00:15:30,910
let's make and lets

240
00:15:30,910 --> 00:15:34,189
make the deal am I more clear the
conflict by

241
00:15:34,189 --> 00:15:39,809
looking at a more technical approach on
the first scenario did user is browsing

242
00:15:39,809 --> 00:15:40,889
around

243
00:15:40,889 --> 00:15:44,319
example dot com and tourism download
link their

244
00:15:44,319 --> 00:15:47,339
and this download link league stew

245
00:15:47,339 --> 00:15:51,220
Google Doc comp file this case it's a
crumb

246
00:15:51,220 --> 00:15:54,639
it's grown set up sorry well

247
00:15:54,639 --> 00:16:00,009
the setup downloads from my Google web
server but on the second example

248
00:16:00,009 --> 00:16:04,429
we are browsing around Google dot com we
all do this at least once a day I

249
00:16:04,429 --> 00:16:05,259
believe

250
00:16:05,259 --> 00:16:08,980
cannot paranoid and the leading

251
00:16:08,980 --> 00:16:14,100
to defile is placed on a global dot com
web page

252
00:16:14,100 --> 00:16:17,259
by the file actually sheet somewhere
house

253
00:16:17,259 --> 00:16:21,169
it could be SourceForge it could be get
had any host in service

254
00:16:21,169 --> 00:16:24,480
the file is downloaded from somewhere
else

255
00:16:24,480 --> 00:16:28,319
as would-be for for example if you will
not use

256
00:16:28,319 --> 00:16:32,350
RFT again first example

257
00:16:32,350 --> 00:16:36,129
first scenario file is downloaded from
an

258
00:16:36,129 --> 00:16:39,959
Google dot com web server which build up
trust

259
00:16:39,959 --> 00:16:44,009
but on the second example file the link
to the file

260
00:16:44,009 --> 00:16:48,149
is an igloo will not come web page which
builds out trust

261
00:16:48,149 --> 00:16:49,610
s well

262
00:16:49,610 --> 00:16:56,310
so which one would you trust and do some
%uh view it may be very clear you might

263
00:16:56,310 --> 00:16:59,360
think yourself while of Chris its option
A or

264
00:16:59,360 --> 00:17:03,020
yeah and I its option B or I'm not
resting

265
00:17:03,020 --> 00:17:06,420
anyone I'm a paranoid and don't not
downloading files anymore

266
00:17:06,420 --> 00:17:11,240
but really in or did you get the answer
to this question

267
00:17:11,240 --> 00:17:17,060
than wine and Jess asks why ask a lot of
people a lot of security professionals

268
00:17:17,060 --> 00:17:21,240
and users and this is what I got
eighty-one percent

269
00:17:21,240 --> 00:17:25,100
of the users said they will trust

270
00:17:25,100 --> 00:17:28,350
and download based on the hosting

271
00:17:28,350 --> 00:17:32,100
know me less than 20 percent no dad

272
00:17:32,100 --> 00:17:35,820
that what impacts them more is the links
location

273
00:17:35,820 --> 00:17:39,470
that's pretty that's pretty much it

274
00:17:39,470 --> 00:17:43,560
I mean for out of 5 people would trusted
download

275
00:17:43,560 --> 00:17:47,000
based on the Domaine de is downloaded
from

276
00:17:47,000 --> 00:17:50,700
and this is ladies and gentlemen exactly

277
00:17:50,700 --> 00:17:54,100
what rfb exploit exploits distrust

278
00:17:54,100 --> 00:17:57,240
and makes your social engineering
attacks

279
00:17:57,240 --> 00:18:00,260
and malware distribution F-word

280
00:18:00,260 --> 00:18:03,500
match more successful and

281
00:18:03,500 --> 00:18:08,150
on and worthwhile well yeah

282
00:18:08,150 --> 00:18:11,700
it is a technical conference by now

283
00:18:11,700 --> 00:18:15,530
you should have a general idea the of
what is our city

284
00:18:15,530 --> 00:18:19,540
you should get that and you know that
attackers one day

285
00:18:19,540 --> 00:18:23,580
gain complete control over our PC ride
and you know that

286
00:18:23,580 --> 00:18:26,620
dear probability to doing do so is
greater with

287
00:18:26,620 --> 00:18:31,510
RFT now only get to do is to teach you
that technical details

288
00:18:31,510 --> 00:18:34,570
we gonna do it is my recreating

289
00:18:34,570 --> 00:18:37,810
an entire I vulnerability that I found

290
00:18:37,810 --> 00:18:41,760
into Google autocomplete feature so
muscle you know this feature

291
00:18:41,760 --> 00:18:45,400
it's great you typing a word any trip
gives you

292
00:18:45,400 --> 00:18:49,790
a suggestion now we're not going to talk
about Google fails

293
00:18:49,790 --> 00:18:53,180
there is a whole website for that and

294
00:18:53,180 --> 00:18:57,170
and and it sometimes not so successful
for example

295
00:18:57,170 --> 00:19:00,790
here you typing why can't any auto
completes

296
00:19:00,790 --> 00:19:06,120
why can't I own a Canadien which is
something to think about seriously

297
00:19:06,120 --> 00:19:11,860
um disturbing and now the one when you
type in Americans

298
00:19:11,860 --> 00:19:17,130
think well American think that Obama is
a cactus now that's valuable

299
00:19:17,130 --> 00:19:20,290
information 40 elections campaign

300
00:19:20,290 --> 00:19:26,280
arm but we're not here to dad about this
we're here to talk about it won't have a

301
00:19:26,280 --> 00:19:28,060
latte and aloha to complete

302
00:19:28,060 --> 00:19:32,210
well this is not magic whenever you type

303
00:19:32,210 --> 00:19:35,760
a letter whenever he he you hit the
keyboard

304
00:19:35,760 --> 00:19:39,250
a request to send to this suggestion API

305
00:19:39,250 --> 00:19:43,060
and a goal will dot com ed processor
that

306
00:19:43,060 --> 00:19:46,810
at send it over to you who had their it
needs to send it over

307
00:19:46,810 --> 00:19:50,920
and then you're getting the suggestions
back

308
00:19:50,920 --> 00:19:54,730
in their response now no black cat TOC

309
00:19:54,730 --> 00:19:57,830
and correct me if I'm wrong is complete

310
00:19:57,830 --> 00:20:01,240
molesters is policed one slide with the
user

311
00:20:01,240 --> 00:20:04,990
a server and a bunch of lines going back
and forth

312
00:20:04,990 --> 00:20:08,600
so not going to disappoint you

313
00:20:08,600 --> 00:20:11,840
he really is so we just typed are if the

314
00:20:11,840 --> 00:20:16,660
and a request is sent to Google dot com
to this suggestion API that smart but

315
00:20:16,660 --> 00:20:17,710
the latter ass

316
00:20:17,710 --> 00:20:22,580
and it contains are a querystring that
was or if the

317
00:20:22,580 --> 00:20:27,270
the server process that they hit works
hard and we're getting the suggestions

318
00:20:27,270 --> 00:20:31,350
in this case it's a Jason response now

319
00:20:31,350 --> 00:20:35,300
someone you may know ended are input is
reflected

320
00:20:35,300 --> 00:20:38,610
to to respond s in reflected

321
00:20:38,610 --> 00:20:41,650
file down again

322
00:20:41,650 --> 00:20:44,900
I hope now it's it's clear while

323
00:20:44,900 --> 00:20:49,300
depend testers here in the audience I
want to tell you something

324
00:20:49,300 --> 00:20:53,090
I can read your minds you just thinking

325
00:20:53,090 --> 00:20:56,220
send a double quotes character why is
that so

326
00:20:56,220 --> 00:21:00,010
because are in third got reflected

327
00:21:00,010 --> 00:21:05,590
is enclosed with his double quotes and
we love breaking for Madison

328
00:21:05,590 --> 00:21:08,960
what we do if you wanna do adjacent
hijacking attack

329
00:21:08,960 --> 00:21:12,140
ever wanna do it prostate scripting in
some cases

330
00:21:12,140 --> 00:21:15,799
we wanna break deform until your wish is
my command let's end this

331
00:21:15,799 --> 00:21:19,480
character over and it got reflected
blood

332
00:21:19,480 --> 00:21:22,720
there is an additional character here

333
00:21:22,720 --> 00:21:27,740
and that's doubt backslash character

334
00:21:27,740 --> 00:21:31,730
and digest a party pooper air because

335
00:21:31,730 --> 00:21:34,750
he just tells the browser

336
00:21:34,750 --> 00:21:38,970
to ignore this special meaning of this
double quotes a week

337
00:21:38,970 --> 00:21:43,270
actually have been break for mint but
think about it

338
00:21:43,270 --> 00:21:47,440
its only in our minds is only in the
browser

339
00:21:47,440 --> 00:21:52,520
context what if we can go to have only
place

340
00:21:52,520 --> 00:21:57,649
where backslashes means nothing at all
then we'll be able to

341
00:21:57,649 --> 00:22:02,200
kind on invaded this technique of
protection

342
00:22:02,200 --> 00:22:06,380
and get her in putting Jack dead and
it's really on by the context

343
00:22:06,380 --> 00:22:09,669
take for example this little cute girl

344
00:22:09,669 --> 00:22:12,860
and she is Jess throwing bottles into
the air

345
00:22:12,860 --> 00:22:16,059
and look what happened when evil people
around the web

346
00:22:16,059 --> 00:22:21,090
are change in that context it yes
completely changes the meaning of the

347
00:22:21,090 --> 00:22:22,490
input I'm sorry I

348
00:22:22,490 --> 00:22:26,480
the the meaning of the picture is
completely changed

349
00:22:26,480 --> 00:22:29,520
no this makes you feel

350
00:22:29,520 --> 00:22:34,549
knots not unconscionable and probably I
apologize if it's too

351
00:22:34,549 --> 00:22:38,490
graphic the them probably the worst wine
yeah

352
00:22:38,490 --> 00:22:41,370
so

353
00:22:41,370 --> 00:22:43,970
it is all abide the context

354
00:22:43,970 --> 00:22:48,360
so let's play then what if gay y de if

355
00:22:48,360 --> 00:22:52,810
I could take dead Reese in the entire
response

356
00:22:52,810 --> 00:22:56,020
um that is generated from this

357
00:22:56,020 --> 00:22:59,400
and put RFT double quotes double pipe

358
00:22:59,400 --> 00:23:03,020
double pipe is the or command separator

359
00:23:03,020 --> 00:23:06,610
in Windows batch so double pipe call

360
00:23:06,610 --> 00:23:10,670
open sampling discount layer and the or
operator again

361
00:23:10,670 --> 00:23:13,800
and I can make this entire response open
up

362
00:23:13,800 --> 00:23:16,990
in Windows shell now I'm not going to do
any

363
00:23:16,990 --> 00:23:20,350
additional work on that in getting this
into Windows shell

364
00:23:20,350 --> 00:23:24,190
unless you're convinced that its
actually going to work

365
00:23:24,190 --> 00:23:28,340
so let's take it out and put it in a
Windows shell interpreter

366
00:23:28,340 --> 00:23:34,200
and first thing for Earth the shell
interpreter to command line prompt

367
00:23:34,200 --> 00:23:37,790
there it doesn't know what you send
older

368
00:23:37,790 --> 00:23:41,930
right so let's lose your ad marking and
starting from the beginning

369
00:23:41,930 --> 00:23:46,020
it's starting to parse there the
commands until it reaches

370
00:23:46,020 --> 00:23:51,370
that double pipe command separator any
tries to execute

371
00:23:51,370 --> 00:23:55,180
and you don't have to be a batch expert
to now

372
00:23:55,180 --> 00:24:00,550
that this is not a valid batch command
now if you have to guess

373
00:24:00,550 --> 00:24:03,600
what's the ball and value of this

374
00:24:03,600 --> 00:24:07,760
an hour would it be at true value

375
00:24:07,760 --> 00:24:12,030
or do you think it's going to be at
Pauls value

376
00:24:12,030 --> 00:24:16,220
well you guessed correctly its staff
falls value

377
00:24:16,220 --> 00:24:19,900
and says we have the Oro parade here
coming

378
00:24:19,900 --> 00:24:23,650
then we keep ongoing until something is
true

379
00:24:23,650 --> 00:24:28,060
right so the next game and we're going
to parse

380
00:24:28,060 --> 00:24:31,300
is the Kalka command and

381
00:24:31,300 --> 00:24:34,540
at a valid command guess what it's doing
ads

382
00:24:34,540 --> 00:24:37,059
we discount later again

383
00:24:37,059 --> 00:24:41,460
by one what's happening with the recipe
command just to show you two allied

384
00:24:41,460 --> 00:24:44,679
are calco pin-up successfully so

385
00:24:44,679 --> 00:24:48,630
it's true we have an or a barrier be
completely ignore

386
00:24:48,630 --> 00:24:53,200
arrested the command to I hope I
convince you that my efforts

387
00:24:53,200 --> 00:24:57,220
are not for nothing and now we can
invest the effort in getting this

388
00:24:57,220 --> 00:25:00,940
into you Windows I shell context

389
00:25:00,940 --> 00:25:04,000
great so

390
00:25:04,000 --> 00:25:07,710
here is that %ah die response and now we
want to make it

391
00:25:07,710 --> 00:25:10,870
download reflected filed owl you wanna
make it down

392
00:25:10,870 --> 00:25:14,730
and it's really really easy

393
00:25:14,730 --> 00:25:17,740
because we don't have to do anything
since the comment on his application

394
00:25:17,740 --> 00:25:19,419
Jason some browsers

395
00:25:19,419 --> 00:25:23,960
is simply download it for us they don't
know how to display it but Google did

396
00:25:23,960 --> 00:25:25,340
something even better

397
00:25:25,340 --> 00:25:28,490
day and the cross site scripting
mitigation here

398
00:25:28,490 --> 00:25:31,750
this is the content disposition header I

399
00:25:31,750 --> 00:25:34,990
which tells the browser don't render dis

400
00:25:34,990 --> 00:25:38,220
where death a I response

401
00:25:38,220 --> 00:25:41,520
just downloaded because they want to
prevent cross-site scripting for

402
00:25:41,520 --> 00:25:42,350
happening

403
00:25:42,350 --> 00:25:45,410
but this is set incorrectly and 18

404
00:25:45,410 --> 00:25:48,929
actually docs it makes RFD work

405
00:25:48,929 --> 00:25:53,690
cross-browser easily without any
additional afterwards

406
00:25:53,690 --> 00:25:57,700
okay so are shell commands are already
there

407
00:25:57,700 --> 00:26:02,669
our a file get downloaded but don't the
brother needs to know

408
00:26:02,669 --> 00:26:06,270
which changing into the download riding
me don't have like

409
00:26:06,270 --> 00:26:10,450
nameless files so it looks up in the URL

410
00:26:10,450 --> 00:26:13,850
and this is where our second injection
points.com

411
00:26:13,850 --> 00:26:17,150
any and what i do. here

412
00:26:17,150 --> 00:26:20,929
I'm using something that we like to
forget

413
00:26:20,929 --> 00:26:25,080
and its cold pack parameters so you can
see this

414
00:26:25,080 --> 00:26:29,919
sammy cahn out there and this is
something that is well defined in the

415
00:26:29,919 --> 00:26:31,760
your eyes specifications

416
00:26:31,760 --> 00:26:36,150
its also supported officially by the
Java Servlet specific asians

417
00:26:36,150 --> 00:26:40,160
and its actually legacy support for all
browsers

418
00:26:40,160 --> 00:26:44,190
dad do not support cookies

419
00:26:44,190 --> 00:26:48,070
now nothing years the web server will
completely ignored

420
00:26:48,070 --> 00:26:51,110
but the browser like

421
00:26:51,110 --> 00:26:56,159
all of the popular browsers they will
parse the file name

422
00:26:56,159 --> 00:26:59,470
out of this section film now

423
00:26:59,470 --> 00:27:03,899
written you're done are found is going
to be named said and on batch which is

424
00:27:03,899 --> 00:27:05,610
opened in Windows shell context

425
00:27:05,610 --> 00:27:09,309
it has our command inside wendy is a
open this file

426
00:27:09,309 --> 00:27:12,490
its yes game over so we need to take
this link

427
00:27:12,490 --> 00:27:16,919
send it to the user 1c clicks on the
link his getting the

428
00:27:16,919 --> 00:27:21,049
fed on batch file and clicking on this
file

429
00:27:21,049 --> 00:27:24,269
resolved in thats so

430
00:27:24,269 --> 00:27:27,649
to be often over does for Windows how
later

431
00:27:27,649 --> 00:27:31,830
you probably not going to use it ever
again arm

432
00:27:31,830 --> 00:27:36,710
but thats that's pretty much it no idea
what I promise to do

433
00:27:36,710 --> 00:27:40,610
right we'd we'd be recreated it and
everything is good except

434
00:27:40,610 --> 00:27:45,029
from four diff and that some love you
think to yourself world he's a liar

435
00:27:45,029 --> 00:27:48,299
well that's not very nice of you to
think

436
00:27:48,299 --> 00:27:52,990
arm because how come there were no
warnings

437
00:27:52,990 --> 00:27:56,470
at all like this one saying

438
00:27:56,470 --> 00:28:01,840
on this family is very very bad for me
unknown publisher don't open and a

439
00:28:01,840 --> 00:28:02,870
runway

440
00:28:02,870 --> 00:28:09,289
arm well like likely would treat this
message I will clean getaway but

441
00:28:09,289 --> 00:28:13,179
anyways just to show you I'm not a liar
let's bypass some Windows security

442
00:28:13,179 --> 00:28:13,809
feature

443
00:28:13,809 --> 00:28:17,769
so I'm giving you a windows seven
security feature bypass

444
00:28:17,769 --> 00:28:21,130
and it's going to conveniently Warrick

445
00:28:21,130 --> 00:28:26,580
for batch files it's gonna work footed
on bad and CMD extensions

446
00:28:26,580 --> 00:28:30,220
and it's going to cause at

447
00:28:30,220 --> 00:28:33,710
all warnings to disable to be disabled
and get our

448
00:28:33,710 --> 00:28:37,510
exploit executed immediately so

449
00:28:37,510 --> 00:28:40,769
this is where you have to be really
concentrate because this

450
00:28:40,769 --> 00:28:44,750
I'm getting really technical here to if
the finally

451
00:28:44,750 --> 00:28:48,070
contains setup installed

452
00:28:48,070 --> 00:28:55,070
or update then there will be no warnings
at all

453
00:28:56,910 --> 00:28:57,380
so

454
00:28:57,380 --> 00:29:00,450
because it's that complicated let's take
an example

455
00:29:00,450 --> 00:29:05,730
if you have a file that's named very
very bad update sense the word

456
00:29:05,730 --> 00:29:09,450
update is there is gone and the year
without any warnings

457
00:29:09,450 --> 00:29:13,830
so I'm not a liar I did what I promise
to do

458
00:29:13,830 --> 00:29:17,550
and

459
00:29:17,550 --> 00:29:20,580
let me show you some advance staff some

460
00:29:20,580 --> 00:29:24,620
more advanced af get to beat more
technical so you can go higher if the

461
00:29:24,620 --> 00:29:25,580
like a boss

462
00:29:25,580 --> 00:29:28,600
and tell you

463
00:29:28,600 --> 00:29:31,920
if you're in looking around to find are
the issues

464
00:29:31,920 --> 00:29:35,150
you 1 be you 1 be in trouble they're
everywhere

465
00:29:35,150 --> 00:29:39,540
trust me then there's three simple
requirements that are

466
00:29:39,540 --> 00:29:44,140
easy to memorize the first one is
reflected you need some input to get

467
00:29:44,140 --> 00:29:44,820
reflected

468
00:29:44,820 --> 00:29:48,880
and this'll where we put are shell
commands

469
00:29:48,880 --> 00:29:54,500
the second requirement is filed need to
control the file name this can be done

470
00:29:54,500 --> 00:29:55,200
using

471
00:29:55,200 --> 00:29:59,110
path parameters or it using otters waste
Ford

472
00:29:59,110 --> 00:30:02,810
permissive URL macking I'm and release

473
00:30:02,810 --> 00:30:07,430
all covered in the white paper and
download we need their response to

474
00:30:07,430 --> 00:30:08,260
download

475
00:30:08,260 --> 00:30:11,870
at be more specific where can we find

476
00:30:11,870 --> 00:30:15,970
RFT will any response with reflected
input

477
00:30:15,970 --> 00:30:19,920
and the lash common content-type: by
less common in Minot

478
00:30:19,920 --> 00:30:23,190
HTML not X amount arm

479
00:30:23,190 --> 00:30:26,560
is very likely to be vulnerable

480
00:30:26,560 --> 00:30:30,870
and surprise Jason API's

481
00:30:30,870 --> 00:30:33,870
and Jason Papi's are

482
00:30:33,870 --> 00:30:38,090
extremely vulnerable RFT is not AG San

483
00:30:38,090 --> 00:30:42,500
attack it to general attack with general
requirements

484
00:30:42,500 --> 00:30:46,290
but I'm not going to cry because

485
00:30:46,290 --> 00:30:50,320
Jason API's conveniently meet

486
00:30:50,320 --> 00:30:54,710
all those our requirements that we set
and Jason AP as our

487
00:30:54,710 --> 00:30:58,900
everywhere so our if he is everywhere
arm

488
00:30:58,900 --> 00:31:02,840
and we need the URL mapping to be
permissive by that I mean

489
00:31:02,840 --> 00:31:05,590
it's taller and for additional slash s

490
00:31:05,590 --> 00:31:09,570
or the semicolon and you'd be surprised
how common this

491
00:31:09,570 --> 00:31:13,430
is I just to give you a preview food
Jason

492
00:31:13,430 --> 00:31:17,500
arm restful API's death flash character

493
00:31:17,500 --> 00:31:21,830
is actually arm a resource separator

494
00:31:21,830 --> 00:31:25,180
in the URL so it's gonna be tolerant no
problem

495
00:31:25,180 --> 00:31:29,160
have fun now we find our

496
00:31:29,160 --> 00:31:32,830
our ft at split which our story

497
00:31:32,830 --> 00:31:35,980
are the vulnerability which exploit
should be uses

498
00:31:35,980 --> 00:31:39,930
will I deeply recommend that you will
use the bad and seen the extensions

499
00:31:39,930 --> 00:31:41,400
those are the easiest want

500
00:31:41,400 --> 00:31:46,060
he saw no warnings easy if you mean sis

501
00:31:46,060 --> 00:31:50,740
you can use the J St SE VBS eesh bbw Sep
HD a

502
00:31:50,740 --> 00:31:55,790
extensions as well as all those are
gonna get you into Windows Script Host

503
00:31:55,790 --> 00:31:56,910
context

504
00:31:56,910 --> 00:32:00,290
which is agreeable equivalent to running
shell commands

505
00:32:00,290 --> 00:32:05,360
and you can also exploit other warner
abilities in other

506
00:32:05,360 --> 00:32:08,920
installed software so if you put your
payload

507
00:32:08,920 --> 00:32:14,570
get the file download as a PDF if the
PDF reader is longer able to an attack

508
00:32:14,570 --> 00:32:18,190
you can are make user download pdf
opening up

509
00:32:18,190 --> 00:32:21,260
but seriously the first one is Mike

510
00:32:21,260 --> 00:32:25,070
is this one so why were card so let me
give you some batch streaks

511
00:32:25,070 --> 00:32:29,020
now you see there is the ampersand
character

512
00:32:29,020 --> 00:32:32,430
the pipe character last and greater than
your lines

513
00:32:32,430 --> 00:32:35,970
and the thing is you're all like good
coffee

514
00:32:35,970 --> 00:32:40,580
I like them whether you're single or
double you gonna do to treat you gonna

515
00:32:40,580 --> 00:32:41,080
Jess

516
00:32:41,080 --> 00:32:44,790
work now

517
00:32:44,790 --> 00:32:48,520
do let requirement was download too can
we force

518
00:32:48,520 --> 00:32:52,450
files to download all responses to
download

519
00:32:52,450 --> 00:32:56,370
well the answer it yes but it's
complicated

520
00:32:56,370 --> 00:33:00,330
and if you have a condom disposition
hair

521
00:33:00,330 --> 00:33:04,390
sure no problem going to work cross
Barack browser if it said incorrect when

522
00:33:04,390 --> 00:33:05,650
we gonna get to digest

523
00:33:05,650 --> 00:33:09,520
skyward if you're doing everything fine

524
00:33:09,520 --> 00:33:13,540
than it's still going to be exploitable

525
00:33:13,540 --> 00:33:16,260
using Chrome in upright because there is
a

526
00:33:16,260 --> 00:33:21,580
html5 feature that lets the attacker to
decide whether

527
00:33:21,580 --> 00:33:26,070
they wanted the response to download or
not so if they're creating

528
00:33:26,070 --> 00:33:29,470
art and and Kurt Adler like you see on
the slide

529
00:33:29,470 --> 00:33:33,470
and heading toward download is going to
get

530
00:33:33,470 --> 00:33:37,200
downloaded from your side if you're
trying not to cash

531
00:33:37,200 --> 00:33:41,770
anything most that's just off topic he
need to consider this factory

532
00:33:41,770 --> 00:33:47,570
and different browser behaves
differently for different content types

533
00:33:47,570 --> 00:33:51,580
now to make sense out of this question
please stay tuned

534
00:33:51,580 --> 00:33:55,380
for the white paper that will be
releasing very very soon

535
00:33:55,380 --> 00:34:00,360
and don't try to understand this table
of the slides you can see that I'm like

536
00:34:00,360 --> 00:34:04,850
psycho and II created those fancy tables
for you

537
00:34:04,850 --> 00:34:08,220
that you'll know how exactly how which
browser behave

538
00:34:08,220 --> 00:34:11,530
and you can see there many cases did
this is

539
00:34:11,530 --> 00:34:15,380
cross-browser now let's

540
00:34:15,380 --> 00:34:20,450
get to define part and do some advance
explanation we've seen at Cal players

541
00:34:20,450 --> 00:34:21,210
already

542
00:34:21,210 --> 00:34:25,560
arm of course you can do what you wish
into everything you running

543
00:34:25,560 --> 00:34:28,630
OS command but I would really recommend
using

544
00:34:28,630 --> 00:34:31,840
PowerShell and the explanation is its

545
00:34:31,840 --> 00:34:36,050
at power shell and have more powers

546
00:34:36,050 --> 00:34:39,120
you can even ask for admin rights and I
landed

547
00:34:39,120 --> 00:34:42,280
if you ask for admin rights with
PowerShell

548
00:34:42,280 --> 00:34:46,130
is gonna say Microsoft Windows a
certified

549
00:34:46,130 --> 00:34:51,340
very fine whatever is asking for admin
privileges so this is great

550
00:34:51,340 --> 00:34:55,230
and you can also use PowerShell to
create some

551
00:34:55,230 --> 00:34:59,910
some kind of had dropped her he just put
a general payload there

552
00:34:59,910 --> 00:35:04,210
and it's downloading the rest on the
malware whatever you want one at the

553
00:35:04,210 --> 00:35:05,660
file you want whatever

554
00:35:05,660 --> 00:35:08,960
you can just download it executed on the
spot

555
00:35:08,960 --> 00:35:12,420
and I think promised

556
00:35:12,420 --> 00:35:16,340
we gonna get back into the browser
contents we stepped out

557
00:35:16,340 --> 00:35:20,020
now we're getting back and the only
difference

558
00:35:20,020 --> 00:35:23,450
is we're going to have superpowers gonna
get

559
00:35:23,450 --> 00:35:27,930
full control other Google Chrome so I
have a question

560
00:35:27,930 --> 00:35:31,450
how many command line options do you
think

561
00:35:31,450 --> 00:35:36,259
Google Chrome has and can stroll out
numbers I want to hear what you think

562
00:35:36,259 --> 00:35:39,930
50 we've got a 50-50 first time fifty

563
00:35:39,930 --> 00:35:44,019
yeah 6464 the answer is

564
00:35:44,019 --> 00:35:48,369
over 900 then and

565
00:35:48,369 --> 00:35:54,529
to be exact 973 and counting

566
00:35:54,529 --> 00:35:58,660
and seriously we can use Jess do

567
00:35:58,660 --> 00:36:02,900
now this does not mean that the rest 971

568
00:36:02,900 --> 00:36:06,150
are not ass a bad but all I need is

569
00:36:06,150 --> 00:36:10,869
to out-of-date and I'm apologize because
whenever I rehearsed this slide

570
00:36:10,869 --> 00:36:14,259
I couldn't stop myself from laughing
when I announce

571
00:36:14,259 --> 00:36:17,710
the name of the first command line
option with the which he is

572
00:36:17,710 --> 00:36:22,170
this able web security yea

573
00:36:22,170 --> 00:36:25,730
so guess what in da

574
00:36:25,730 --> 00:36:29,430
in this a mauve web security and shuts
down

575
00:36:29,430 --> 00:36:32,940
same origin policy show that's great now

576
00:36:32,940 --> 00:36:35,940
what it means that any window from any
domain

577
00:36:35,940 --> 00:36:39,009
can access the cookie can access
everything

578
00:36:39,009 --> 00:36:42,099
in any other window of any other

579
00:36:42,099 --> 00:36:46,339
to me now what would be really great if
we had some command line

580
00:36:46,339 --> 00:36:49,710
to allow us to open if much windows as
we want

581
00:36:49,710 --> 00:36:52,779
0 disable pop-up blocker

582
00:36:52,779 --> 00:36:56,650
so yeah we've got those two together so
we can open up windows

583
00:36:56,650 --> 00:36:59,869
an axis everything no matter what's the
domain name

584
00:36:59,869 --> 00:37:03,460
in there does still resolved in browser

585
00:37:03,460 --> 00:37:08,769
anarchy and it's just one big mass and
you control chrome completely

586
00:37:08,769 --> 00:37:13,150
now I know the smalls here

587
00:37:13,150 --> 00:37:16,910
a bit arm the point here is a bit small

588
00:37:16,910 --> 00:37:21,249
but I'm going to walk you through so the
users getting a link to Google Doc com

589
00:37:21,249 --> 00:37:25,900
its clicking on it getting a file back
from the Google servers

590
00:37:25,900 --> 00:37:28,940
called crown set up once executed

591
00:37:28,940 --> 00:37:33,400
it opens up chrome with no security on
the attackers website

592
00:37:33,400 --> 00:37:36,310
the attackers website returns scripts

593
00:37:36,310 --> 00:37:40,460
that open windows and Texas what's in
those windows including

594
00:37:40,460 --> 00:37:47,460
that cookie well let's build exploit its
build an actual

595
00:37:47,590 --> 00:37:50,710
exploit and it's gonna be

596
00:37:50,710 --> 00:37:55,020
a bit more technical well

597
00:37:55,020 --> 00:37:58,880
the first part is what we seen before
it's invalid

598
00:37:58,880 --> 00:38:02,830
is gonna resulting in a row we have the
double pipe operator

599
00:38:02,830 --> 00:38:06,700
so we keep on going din X command

600
00:38:06,700 --> 00:38:10,300
as the task kill command I

601
00:38:10,300 --> 00:38:13,500
which shuts down playing because we want
to open an app and I'm

602
00:38:13,500 --> 00:38:17,590
in secure mode and it's also good for
our social engineering we said we are

603
00:38:17,590 --> 00:38:20,010
installing Chrome so let's shut down
from

604
00:38:20,010 --> 00:38:25,230
but this is actually sex at all I know
its confusing because we're closing

605
00:38:25,230 --> 00:38:25,760
chrome

606
00:38:25,760 --> 00:38:29,010
the clothes was successful this returns
true

607
00:38:29,010 --> 00:38:32,140
some gonna teach your Creek I'm using
the single pipe

608
00:38:32,140 --> 00:38:35,930
to redirect the output out of the
Catskill command

609
00:38:35,930 --> 00:38:39,150
into to make directory command and the

610
00:38:39,150 --> 00:38:43,130
now this is not valid and it will result
in a lower

611
00:38:43,130 --> 00:38:46,230
we have the double pike operator we keep

612
00:38:46,230 --> 00:38:49,430
on going then we're going to start whom

613
00:38:49,430 --> 00:38:52,600
is gonna start topping the attackers
website with this

614
00:38:52,600 --> 00:38:55,790
able web security and disable pop-up
blocker

615
00:38:55,790 --> 00:38:59,500
this is going to be successful the rest
the command is ignored

616
00:38:59,500 --> 00:39:03,600
now let's

617
00:39:03,600 --> 00:39:07,529
let's see a demo of me stealing some
gmail

618
00:39:07,530 --> 00:39:11,720
inbox and cookie now I want you to
remember

619
00:39:11,720 --> 00:39:15,090
that you'd it's not limited to Gmail you
can do this to

620
00:39:15,090 --> 00:39:19,440
any website and you can do this like 430
web sites at once

621
00:39:19,440 --> 00:39:26,440
okay so let's watch it

622
00:39:27,089 --> 00:39:30,740
now let's go into my gmail inbox and I
just got an email

623
00:39:30,740 --> 00:39:35,339
this happens occasionally from myself
and the shemale FAS

624
00:39:35,339 --> 00:39:39,319
that the ghouls there is a Google Chrome
security

625
00:39:39,319 --> 00:39:43,000
update and there's a link to Google Doc
com now

626
00:39:43,000 --> 00:39:47,510
I'm not easy to fall I'm clicking on
this link my I'm going to the Downloads

627
00:39:47,510 --> 00:39:48,440
folder

628
00:39:48,440 --> 00:39:52,780
to verify and was downloaded from an
HTTPS

629
00:39:52,780 --> 00:39:56,579
Google dot com address it was I click on
it

630
00:39:56,579 --> 00:40:01,299
and he tells me I'm awesome thank you
and it's installing Google Chrome

631
00:40:01,299 --> 00:40:04,710
that's it now let's take a look

632
00:40:04,710 --> 00:40:10,380
on the attackers website here's my gmail
kooky

633
00:40:10,380 --> 00:40:13,869
and if you want to read my emails if you
run

634
00:40:13,869 --> 00:40:17,609
wanna read mein teri inbox than here you
go

635
00:40:17,609 --> 00:40:23,299
so now we know we can execute

636
00:40:23,299 --> 00:40:28,200
any command and operating system we can
still any information out of the browser

637
00:40:28,200 --> 00:40:32,460
now we wanna spread this evil ness to
everyone

638
00:40:32,460 --> 00:40:36,029
what a better way than building a warm
so

639
00:40:36,029 --> 00:40:39,260
I hereby present what I believed to be

640
00:40:39,260 --> 00:40:42,839
the first cross social network form as
the

641
00:40:42,839 --> 00:40:45,839
the RFT warm and its gonna spreads
itself

642
00:40:45,839 --> 00:40:49,900
over all of the social networks did you
are connected to

643
00:40:49,900 --> 00:40:52,940
Facebook Twitter Google+

644
00:40:52,940 --> 00:40:56,420
and arm link the

645
00:40:56,420 --> 00:40:59,640
at: demo

646
00:40:59,640 --> 00:41:04,730
it's gonna be a bit it's gonna start
amid similar to the first one

647
00:41:04,730 --> 00:41:08,980
arm so if you haven't got any than the
first attempt

648
00:41:08,980 --> 00:41:13,529
is your chance my friend that was
attacked by a warm previously

649
00:41:13,529 --> 00:41:17,089
just shared a link saying again at
there's a

650
00:41:17,089 --> 00:41:21,430
from security update and I click on this
link I

651
00:41:21,430 --> 00:41:25,910
validated from Google dot com I

652
00:41:25,910 --> 00:41:30,370
validate yet thank you so

653
00:41:30,370 --> 00:41:34,750
here it is Google not complex click n
and fireworks happening again and cask

654
00:41:34,750 --> 00:41:35,740
ale blah blah blah

655
00:41:35,740 --> 00:41:40,040
and again we are %ah some way just
install Chrome

656
00:41:40,040 --> 00:41:43,120
but the only difference is that i'm
gonna be

657
00:41:43,120 --> 00:41:49,050
a very very lonely person because all of
my facebook friends

658
00:41:49,050 --> 00:41:52,430
Jess got attacked by two more miss well
s

659
00:41:52,430 --> 00:41:55,530
it maybe share the LinkedIn long liberal

660
00:41:55,530 --> 00:41:58,780
page old my Twitter Follow airs

661
00:41:58,780 --> 00:42:03,290
and this is a test the council please
follow me on there also

662
00:42:03,290 --> 00:42:07,500
attacked by two ish our mom warm

663
00:42:07,500 --> 00:42:11,800
and all of my i three Google PLAs
friends

664
00:42:11,800 --> 00:42:15,250
also got attacked by a swarm

665
00:42:15,250 --> 00:42:21,290
and my boss is going to fire me because
if he follows my LinkedIn activity

666
00:42:21,290 --> 00:42:24,330
he's also going to get attack by the war

667
00:42:24,330 --> 00:42:27,620
well

668
00:42:27,620 --> 00:42:32,490
I hope I convince you that this is an
issue and we need to fix said

669
00:42:32,490 --> 00:42:35,940
but let me tell you how I think we
should fix it

670
00:42:35,940 --> 00:42:39,440
now use exact URL mappings

671
00:42:39,440 --> 00:42:42,750
don't allow anything after UN

672
00:42:42,750 --> 00:42:48,650
ATI ni one of the most important
solutions here

673
00:42:48,650 --> 00:42:52,770
is never escape input escaping input is

674
00:42:52,770 --> 00:42:58,890
always bad for you because it contains
the regional problematic character

675
00:42:58,890 --> 00:43:02,360
this case it's a damn unquote but she
uses

676
00:43:02,360 --> 00:43:07,940
encoding instead as you can see in
coding is numeric is alphanumeric with a

677
00:43:07,940 --> 00:43:08,930
backslash

678
00:43:08,930 --> 00:43:12,990
and the double quote can be presented as
one of these

679
00:43:12,990 --> 00:43:16,760
and it really depends on the output
format but you'll find a proper

680
00:43:16,760 --> 00:43:17,750
including I'm sure

681
00:43:17,750 --> 00:43:22,080
add content-disposition: headers

682
00:43:22,080 --> 00:43:25,400
yeah I know and the content disposition
hatter's

683
00:43:25,400 --> 00:43:28,680
but do it correctly with the file name

684
00:43:28,680 --> 00:43:32,180
attributes this way the browser don't
have to

685
00:43:32,180 --> 00:43:35,300
start figuring out what's the following
looking to URL

686
00:43:35,300 --> 00:43:38,870
its always going to be the one dot txt

687
00:43:38,870 --> 00:43:40,270
mitigating

688
00:43:40,270 --> 00:43:47,270
the vulnerability require custom headers
for all of your API's

689
00:43:47,520 --> 00:43:50,910
API's are normally accessed by other

690
00:43:50,910 --> 00:43:56,570
software not by users so if you require
custom headers you're getting

691
00:43:56,570 --> 00:43:59,620
are the power of arm

692
00:43:59,620 --> 00:44:05,240
on the same origin policy if possible
use CSRF token to swell

693
00:44:05,240 --> 00:44:09,520
why please call back now I stopped
counting I ran outta fingers

694
00:44:09,520 --> 00:44:13,650
of how many attacks had been on Jason P
call backs

695
00:44:13,650 --> 00:44:17,100
has been in use a great view attack
right now I

696
00:44:17,100 --> 00:44:20,800
by been high and that shows that has
been resent a flash has been a lot of

697
00:44:20,800 --> 00:44:22,820
other stuff going on with white leaf

698
00:44:22,820 --> 00:44:28,360
on be because nothin no one white least
call back to whitelist your comments

699
00:44:28,360 --> 00:44:28,890
come on

700
00:44:28,890 --> 00:44:31,940
the comets are reflected by default any

701
00:44:31,940 --> 00:44:35,170
make seal almost there then leave
honorable

702
00:44:35,170 --> 00:44:40,040
to reflected file down and force X is a
sign mitigations like this and less for

703
00:44:40,040 --> 00:44:40,590
load

704
00:44:40,590 --> 00:44:43,650
never include API

705
00:44:43,650 --> 00:44:46,850
a error message s for user input in API

706
00:44:46,850 --> 00:44:50,300
error message s and

707
00:44:50,300 --> 00:44:53,790
remove support for path parameters

708
00:44:53,790 --> 00:44:59,240
I just found across a scripting on over
200 Google domains

709
00:44:59,240 --> 00:45:02,340
Jess because path parameters

710
00:45:02,340 --> 00:45:06,690
worth were allowed to game we did this
we don't need it anymore

711
00:45:06,690 --> 00:45:11,430
arm and music ex-con the type options
now sniff header

712
00:45:11,430 --> 00:45:15,870
if you're using text/plain formats I'm
going to show a new technique on how to

713
00:45:15,870 --> 00:45:18,160
make the browser download your files

714
00:45:18,160 --> 00:45:22,650
in that case in the white paper as well
now let's sum it up

715
00:45:22,650 --> 00:45:27,000
your site can be used to tech users
attackers can get full control over the

716
00:45:27,000 --> 00:45:28,200
victim's machine

717
00:45:28,200 --> 00:45:31,890
a file is downloaded but it's never
uploaded

718
00:45:31,890 --> 00:45:35,840
and and advance exploit I show you
advance explication

719
00:45:35,840 --> 00:45:40,640
including PowerShell chrome and Windows
security feature by Bess s

720
00:45:40,640 --> 00:45:44,660
and eventually I'm so scared please fix
it you know how to

721
00:45:44,660 --> 00:45:48,080
no in that manner just

722
00:45:48,080 --> 00:45:50,900
a last statement the last statement for
the stock to laugh

723
00:45:50,900 --> 00:45:55,279
slide who is responsible well

724
00:45:55,279 --> 00:45:58,829
I want to read you a quote update %ah to
the Google

725
00:45:58,829 --> 00:46:02,250
vulnerability reward program rules and
it said

726
00:46:02,250 --> 00:46:06,150
we recognize that the address bar

727
00:46:06,150 --> 00:46:09,390
is the only reliable security

728
00:46:09,390 --> 00:46:13,319
indicator in modern browsers ladies and
gentlemen

729
00:46:13,319 --> 00:46:16,740
if you own a domain name if you own
what's

730
00:46:16,740 --> 00:46:21,299
on there in the address bar you are
responsible for the content that you are

731
00:46:21,299 --> 00:46:21,990
returning

732
00:46:21,990 --> 00:46:25,720
and you're responsible for protecting
users like me

733
00:46:25,720 --> 00:46:29,660
from RFT thank you very much for coming
to to stop

734
00:46:29,660 --> 00:46:36,660
please follow my twitter

735
00:46:40,109 --> 00:46:45,709
thank you so much what watch out watch
out for help for the white paper

736
00:46:45,709 --> 00:46:50,099
that's coming you you've got all details
there and I'll be taking questions now

737
00:46:50,099 --> 00:46:54,900
so if you have any questions that would
be a good time

738
00:46:54,900 --> 00:47:01,900
yet

739
00:47:03,400 --> 00:47:06,210
yeah that it depends whether the link is

740
00:47:06,210 --> 00:47:09,880
same origin are not same origin links

741
00:47:09,880 --> 00:47:13,250
dad download attribute is getting
somewhere

742
00:47:13,250 --> 00:47:17,089
3/3 but you have to be same origin for
across

743
00:47:17,089 --> 00:47:20,760
origin links than there's been a fix
you're right about it

744
00:47:20,760 --> 00:47:25,280
it wasn't this way but right now they
prepare to content-disposition:

745
00:47:25,280 --> 00:47:32,280
header any other questions yep %um

746
00:47:33,270 --> 00:47:36,770
yeah I'm I morton

747
00:47:36,770 --> 00:47:40,040
the question one that does it all only
works on Windows seven

748
00:47:40,040 --> 00:47:45,250
the answer it works on every Windows PC
bind def thing with the warning

749
00:47:45,250 --> 00:47:48,890
users house are will get the warning if
it's not windows 7

750
00:47:48,890 --> 00:47:52,460
but both you and I know they're going to
click the warning away

751
00:47:52,460 --> 00:47:57,260
and they've decided to download a file
it's not the they're gonna open the file

752
00:47:57,260 --> 00:48:00,109
it's not gonna said there they don't
download files for nothing

753
00:48:00,109 --> 00:48:05,680
any other questions I'll

754
00:48:05,680 --> 00:48:11,309
yep here

755
00:48:11,309 --> 00:48:13,109
man I love you that's like dead

756
00:48:13,109 --> 00:48:18,400
the most often are questions after on he
asked if we can use the unique code

757
00:48:18,400 --> 00:48:19,359
character

758
00:48:19,359 --> 00:48:22,930
of r22 a twenty-two easy

759
00:48:22,930 --> 00:48:27,059
to are switched to left and left and
right

760
00:48:27,059 --> 00:48:30,519
Aurion tation and Facebook that

761
00:48:30,519 --> 00:48:35,779
some spot the extension of the file
unfortunately we can do this

762
00:48:35,779 --> 00:48:39,999
because its it's not fend and be decoded

763
00:48:39,999 --> 00:48:43,859
it stays in the browser level when it's
parsing the financial

764
00:48:43,859 --> 00:48:47,599
fortunate not bad that's great question
any other questions

765
00:48:47,599 --> 00:48:54,599
yet a question was what was it fits by
Google

766
00:48:56,119 --> 00:49:00,230
the answer is it's complicated they have
fixed it

767
00:49:00,230 --> 00:49:03,230
I hacked it again they fixed it

768
00:49:03,230 --> 00:49:07,069
right now we're talking about some other
stuff related

769
00:49:07,069 --> 00:49:11,690
om but eventually they didn't fix in a
core

770
00:49:11,690 --> 00:49:15,720
arm feature like that was organization

771
00:49:15,720 --> 00:49:20,789
will wide so it took them a lot of time
to gym several months to do

772
00:49:20,789 --> 00:49:24,420
by it's mostly fiction Google its fixed
on being

773
00:49:24,420 --> 00:49:28,140
but if I had to use just start Nini

774
00:49:28,140 --> 00:49:33,140
the number website that are alexei top
100 that are vulnerable to our city

775
00:49:33,140 --> 00:49:37,089
you guys are gonna stay in Amsterdam
forever so it's like

776
00:49:37,089 --> 00:49:42,680
is an endless least and I jest can't
responsibly disclose

777
00:49:42,680 --> 00:49:47,269
all over this before the black attack it
would be impossible and time-consuming

778
00:49:47,269 --> 00:49:51,299
any other questions I went out let you
guys go

779
00:49:51,299 --> 00:49:55,799
show are go party that's that's the end
of the contras

780
00:49:55,799 --> 00:49:59,249
have fun I'm here so if you have
questions you're shy

781
00:49:59,249 --> 00:50:01,999
come over out I'll take those questions
thank you

