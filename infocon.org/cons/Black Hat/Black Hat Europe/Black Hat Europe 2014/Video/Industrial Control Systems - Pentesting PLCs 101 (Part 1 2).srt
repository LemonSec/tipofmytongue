1
00:00:00,080 --> 00:00:03,560
welcome to disarm sky workshop which is
called

2
00:00:03,560 --> 00:00:06,859
industrial control systems and testing
PLC's

3
00:00:06,859 --> 00:00:10,349
101 so just a trick

4
00:00:10,349 --> 00:00:14,660
reminder that means that it's going to
be an in the introductory class

5
00:00:14,660 --> 00:00:18,680
and do not expect any or days this
afternoon

6
00:00:18,680 --> 00:00:22,080
on the goal is to give you some
knowledge about how you can bend test

7
00:00:22,080 --> 00:00:23,300
those devices were

8
00:00:23,300 --> 00:00:26,580
what is specific to those devices work
can what

9
00:00:26,580 --> 00:00:29,720
attack techniques you can use so

10
00:00:29,720 --> 00:00:34,280
basically that's the point I I'm sorry
we start a bit late but we have some

11
00:00:34,280 --> 00:00:37,390
issues with the let's do the hard
whether to bring

12
00:00:37,390 --> 00:00:40,809
some things broke during the during the
the trouble

13
00:00:40,809 --> 00:00:43,850
and just a

14
00:00:43,850 --> 00:00:48,210
10 seconds about me my name is on a
salir i'm french

15
00:00:48,210 --> 00:00:51,989
I work at sole income which is a French
management and IT consulting

16
00:00:51,989 --> 00:00:55,800
obviously I work in the IT parks from

17
00:00:55,800 --> 00:00:59,629
what are my interests I am I work in
security mostly at the

18
00:00:59,629 --> 00:01:04,580
as a pen tester so I got from all kind
of a web application penetration tests

19
00:01:04,580 --> 00:01:06,189
on network penetration test

20
00:01:06,189 --> 00:01:09,760
the client's and also industrial control
systems

21
00:01:09,760 --> 00:01:14,490
um I have a specific interest in Windows
Active Directory

22
00:01:14,490 --> 00:01:15,710
issues I

23
00:01:15,710 --> 00:01:18,770
I give a talk at the French the security
conference

24
00:01:18,770 --> 00:01:21,790
earlier this year so that there's a city
actually am

25
00:01:21,790 --> 00:01:24,830
a mistake on the slide its was the
senator

26
00:01:24,830 --> 00:01:28,770
last year and I also I like wine

27
00:01:28,770 --> 00:01:34,580
a lot but this study will not be covered
today um

28
00:01:34,580 --> 00:01:38,530
okay so this is a workshop so I expect
you to ask all the questions you want

29
00:01:38,530 --> 00:01:43,399
during the workshop no need to wait
until the end and there's going to be

30
00:01:43,399 --> 00:01:44,200
two parts

31
00:01:44,200 --> 00:01:47,210
on the first one would be about a

32
00:01:47,210 --> 00:01:50,780
let's and introduction to ACS so it's
gonna be a I

33
00:01:50,780 --> 00:01:53,800
mostly slides and in the second part a

34
00:01:53,800 --> 00:01:57,789
I will give you a view to a machine with
some exercises to do

35
00:01:57,789 --> 00:02:00,910
firstly on simulators and in the second
time

36
00:02:00,910 --> 00:02:04,759
we're gonna try to I access those
devices and try to

37
00:02:04,759 --> 00:02:08,239
understand I we can put in them the

38
00:02:08,239 --> 00:02:11,800
so I will you be new USB keys I am

39
00:02:11,800 --> 00:02:15,019
its arm VirtualBox virtual machine

40
00:02:15,019 --> 00:02:18,180
which is Kelly X on I think most %uh
view

41
00:02:18,180 --> 00:02:22,280
should be familiar with this early next
distribution to use for penetration

42
00:02:22,280 --> 00:02:23,070
testing

43
00:02:23,070 --> 00:02:26,660
I but some additional tools

44
00:02:26,660 --> 00:02:32,280
I'll specific to the ICS you will find
what this poem to get kids this can snap

45
00:02:32,280 --> 00:02:32,820
said on

46
00:02:32,820 --> 00:02:38,260
and also some I Metasploit modules and
also some

47
00:02:38,260 --> 00:02:41,630
pick up samples them some script that I
you wrote

48
00:02:41,630 --> 00:02:45,180
so I have the USB key just year

49
00:02:45,180 --> 00:02:49,100
aren't what I suggested that you could
be the

50
00:02:49,100 --> 00:02:52,540
luv you two machine and you try to
install it during the first part so when

51
00:02:52,540 --> 00:02:54,070
you come back after the break

52
00:02:54,070 --> 00:03:01,070
a everything works

53
00:03:03,629 --> 00:03:06,629
up I'm

54
00:03:06,629 --> 00:03:10,569
I'm low on years bitches what's up
please share it with your neighbors

55
00:03:10,569 --> 00:03:17,040
up ok yep

56
00:03:17,040 --> 00:03:24,040
day go

57
00:03:38,160 --> 00:03:44,450
yeah that's a bit six-year

58
00:03:44,450 --> 00:03:47,370
okay so as I told you on there would be
two part

59
00:03:47,370 --> 00:03:51,019
one mostly with the slides is going to
be the icing good tradition

60
00:03:51,019 --> 00:03:55,900
and the some specific on knowledge about
the Modbus protocol and then

61
00:03:55,900 --> 00:03:58,930
the last part attacking PLC's a

62
00:03:58,930 --> 00:04:03,650
so I'm gonna give you a quick word about
whether PLC is right now

63
00:04:03,650 --> 00:04:07,379
so here we have two different models
this one is from Siemens this one is

64
00:04:07,379 --> 00:04:07,930
from

65
00:04:07,930 --> 00:04:12,849
Snyder and

66
00:04:12,849 --> 00:04:16,570
on those little devices are used in most
of the plants are factory

67
00:04:16,570 --> 00:04:19,759
too lol automation I love the process

68
00:04:19,759 --> 00:04:24,590
so depending on a the inputs the value
of some sensors

69
00:04:24,590 --> 00:04:27,750
there we'll process this information and
poor there from

70
00:04:27,750 --> 00:04:30,800
I am some kind of actions with the hope

71
00:04:30,800 --> 00:04:35,250
outputs basically okay so let's start
with

72
00:04:35,250 --> 00:04:38,599
the introduction what is an investor
controller

73
00:04:38,599 --> 00:04:42,970
system ICS down so it's

74
00:04:42,970 --> 00:04:46,370
lets its divided in several parts I am
the

75
00:04:46,370 --> 00:04:50,060
lowest level 1 is what we call them the
production at work

76
00:04:50,060 --> 00:04:54,159
on which you can find sensors and
actuators

77
00:04:54,159 --> 00:04:57,430
which are basically the inputs and
outputs

78
00:04:57,430 --> 00:05:01,479
out the PLC's you can find some way
let's not know

79
00:05:01,479 --> 00:05:04,820
networks most of the time it's a

80
00:05:04,820 --> 00:05:07,830
let's classical WiFi network are

81
00:05:07,830 --> 00:05:11,789
sometimes some specific proprietary

82
00:05:11,789 --> 00:05:14,970
tools can be used also we can also find
some

83
00:05:14,970 --> 00:05:18,220
how to use which means a remote terminal
units

84
00:05:18,220 --> 00:05:21,479
and its use to remotely access

85
00:05:21,479 --> 00:05:25,820
I its in a PLC but meant to be used to
remotely

86
00:05:25,820 --> 00:05:30,039
down then we have the supervision at
work

87
00:05:30,039 --> 00:05:34,440
that's may also be called the the SCADA
network on which

88
00:05:34,440 --> 00:05:37,710
I you can find some workstation

89
00:05:37,710 --> 00:05:39,099
with the supervision

90
00:05:39,099 --> 00:05:44,449
software installed so this I is where
the operators the people working

91
00:05:44,449 --> 00:05:47,819
at the plant on the factory I S let's
say they

92
00:05:47,819 --> 00:05:52,750
from they manage the process you can
also find some

93
00:05:52,750 --> 00:05:56,409
I okay Nov laptops the use for
maintenance for example the people

94
00:05:56,409 --> 00:05:57,250
working to

95
00:05:57,250 --> 00:06:00,400
the laptop with them and they connect
directly to the PLC's

96
00:06:00,400 --> 00:06:05,680
or two other kind of device on the field
and of course you have some servers

97
00:06:05,680 --> 00:06:09,520
the some other indicated to them to
discuss supervision software that you

98
00:06:09,520 --> 00:06:10,020
use

99
00:06:10,020 --> 00:06:13,130
and some sever are quite specific in the
cold

100
00:06:13,130 --> 00:06:17,550
data is story on on their purpose is to
store all the data

101
00:06:17,550 --> 00:06:21,400
from the process at all the time in
order to be a

102
00:06:21,400 --> 00:06:26,490
let's hear analyze later so what vehicle
ice yes it's basically

103
00:06:26,490 --> 00:06:29,729
I the prediction that work and the
supervision at work

104
00:06:29,729 --> 00:06:32,849
most of the time

105
00:06:32,849 --> 00:06:36,610
everything is somehow connected to the
corporate network

106
00:06:36,610 --> 00:06:40,460
were you can find I'll it's all your
application the user who

107
00:06:40,460 --> 00:06:43,840
user's workstation um because

108
00:06:43,840 --> 00:06:47,800
most of the time I am some data needs to
be

109
00:06:47,800 --> 00:06:51,539
taking of the supervision network for
example from the date a story on

110
00:06:51,539 --> 00:06:55,529
and to be said into some specific
application in the corporate network

111
00:06:55,529 --> 00:06:58,810
for example I in ACP pro

112
00:06:58,810 --> 00:07:02,590
and you know the kind of GRP that allows
the people to

113
00:07:02,590 --> 00:07:06,479
let's say try to as a um to

114
00:07:06,479 --> 00:07:09,659
to have a better process to on to me

115
00:07:09,659 --> 00:07:15,940
let's say two to be more efficient so as
a conclusion on the slide

116
00:07:15,940 --> 00:07:19,630
I am basically what love I would like to
say that them

117
00:07:19,630 --> 00:07:23,219
you have to understand that corporate
information system on the and those the

118
00:07:23,219 --> 00:07:23,650
to

119
00:07:23,650 --> 00:07:28,520
whereas I what we call ICS actually
interfaces the data

120
00:07:28,520 --> 00:07:33,029
with the physical world so that means if
you pair from you send some packets

121
00:07:33,029 --> 00:07:36,400
some real things will happen in the
physical world

122
00:07:36,400 --> 00:07:40,640
that maybe our a light that will be a

123
00:07:40,640 --> 00:07:43,910
switched on on of or any kind of
physical action

124
00:07:43,910 --> 00:07:46,950
our next

125
00:07:46,950 --> 00:07:50,940
just a bit doesn't look at what you read
because I think its importance

126
00:07:50,940 --> 00:07:54,430
the ICS stands for industrial control
system

127
00:07:54,430 --> 00:07:58,300
I'm gonna say that at least a thousand
times this afternoon

128
00:07:58,300 --> 00:08:01,380
I it's quite it's exactly the same as I

129
00:08:01,380 --> 00:08:05,250
ACS which means industrial automation
and control system

130
00:08:05,250 --> 00:08:08,600
and as we saw earlier it's quite
different

131
00:08:08,600 --> 00:08:13,370
as from SCADA which means supervisory
control and data acquisition

132
00:08:13,370 --> 00:08:16,470
because st. days only one part

133
00:08:16,470 --> 00:08:20,500
%uh the led to the DACs and it's all so
different from

134
00:08:20,500 --> 00:08:23,600
DCS which is another kind of

135
00:08:23,600 --> 00:08:26,930
a let's say arm process a

136
00:08:26,930 --> 00:08:30,310
from them plan processing I

137
00:08:30,310 --> 00:08:33,890
however what's is also important to know
today

138
00:08:33,890 --> 00:08:37,370
most people tend to see SCADA for ICS so

139
00:08:37,370 --> 00:08:40,909
I if you encounter one of your client
thats is

140
00:08:40,909 --> 00:08:45,900
you want the scat assessment and that
could mean anything from the ACS that

141
00:08:45,900 --> 00:08:46,630
can be the

142
00:08:46,630 --> 00:08:50,000
the PLC the protection at work on the
the supervision software

143
00:08:50,000 --> 00:08:53,330
I am thats led to the trend today

144
00:08:53,330 --> 00:08:57,160
okay

145
00:08:57,160 --> 00:09:00,500
if I continue um I will detail the

146
00:09:00,500 --> 00:09:04,089
led to the role of the key components
that you can find in ICS

147
00:09:04,089 --> 00:09:08,930
please feel free to a to interrupt me
fait forget something or if you

148
00:09:08,930 --> 00:09:13,200
know any kind of device that you can
find so the

149
00:09:13,200 --> 00:09:16,710
first kind of device is what they called
early other sensors

150
00:09:16,710 --> 00:09:19,930
and the actual ito's so as I told you um

151
00:09:19,930 --> 00:09:23,940
these are the most low-level things you
can find so

152
00:09:23,940 --> 00:09:27,350
a basically what we call a um

153
00:09:27,350 --> 00:09:30,589
ascenso could be the some kind of speech
like this one

154
00:09:30,589 --> 00:09:34,310
and on actuator is something that
performs an action

155
00:09:34,310 --> 00:09:38,010
depending on the from the information
that he sent to in

156
00:09:38,010 --> 00:09:42,550
so on this picture you have the valve so
let's say you send some Electric Six

157
00:09:42,550 --> 00:09:44,470
signal to the valve and it shuts

158
00:09:44,470 --> 00:09:47,830
or nice shirts of the valve or maybe
opens it

159
00:09:47,830 --> 00:09:54,540
next stable thing you can encounter is
what we call a local

160
00:09:54,540 --> 00:09:57,780
age I is so means human machine
interface

161
00:09:57,780 --> 00:10:02,140
so over here we have one from

162
00:10:02,140 --> 00:10:07,790
a cements so lets in most of the time
the the plants are defector a quite big

163
00:10:07,790 --> 00:10:11,360
so the people are performing the
supervision from one

164
00:10:11,360 --> 00:10:15,410
the one central room but they also need
to have some information

165
00:10:15,410 --> 00:10:18,500
well when they are on the field sonya
the

166
00:10:18,500 --> 00:10:22,350
the process so in most of the plans you
can find those tiny screens

167
00:10:22,350 --> 00:10:26,600
sometimes there are out there screen
sometimes there is only some buttons

168
00:10:26,600 --> 00:10:31,080
it allows the operators to have some
eyelets Iran

169
00:10:31,080 --> 00:10:35,180
some information about what is going on
and well maybe before doing some kind of

170
00:10:35,180 --> 00:10:38,860
operation they can shut down the process
locally I'll

171
00:10:38,860 --> 00:10:41,930
so that's quite important PLC's

172
00:10:41,930 --> 00:10:46,490
which are islets in this subject of
today that means programmable logic

173
00:10:46,490 --> 00:10:47,240
control

174
00:10:47,240 --> 00:10:52,190
it manage all the senses and the
actuators also for example on that in

175
00:10:52,190 --> 00:10:53,120
the picture it's

176
00:10:53,120 --> 00:10:57,040
also appeared see from Schneider on trip
take a look

177
00:10:57,040 --> 00:11:00,100
here at the this PLC and you will see
that

178
00:11:00,100 --> 00:11:03,220
I am I'll come back to that later but

179
00:11:03,220 --> 00:11:07,540
just quickly you can see that there is
the power thats what you call the CPU so

180
00:11:07,540 --> 00:11:10,060
it processes the information and then we
have an

181
00:11:10,060 --> 00:11:13,410
inputs/outputs a card that the lows to
interact

182
00:11:13,410 --> 00:11:19,850
with the sensors and the actuators that
I mentioned

183
00:11:19,850 --> 00:11:23,360
supervision screen I'll so on as adjusts

184
00:11:23,360 --> 00:11:27,320
told you um most of the supervision in
the plans a factory

185
00:11:27,320 --> 00:11:32,510
is done from a a bigger room where you
have those kind of big screen with the

186
00:11:32,510 --> 00:11:36,110
green or red lights depending o on how
the process goes

187
00:11:36,110 --> 00:11:39,910
also that allows the people to have a
high level

188
00:11:39,910 --> 00:11:44,410
I overview of the hold the the plant on
the factories going

189
00:11:44,410 --> 00:11:49,630
and then again they tell a story and
that's the server so I didn't but

190
00:11:49,630 --> 00:11:53,140
in the future of server but more picture
of data I

191
00:11:53,140 --> 00:11:56,320
it recalls all the data from the
protection that works and

192
00:11:56,320 --> 00:12:00,450
although this data to be sometimes
forwarded to the corporate network

193
00:12:00,450 --> 00:12:04,330
where when the people who crunch all
these data to

194
00:12:04,330 --> 00:12:07,880
arm lets it to try to make the process
more efficient

195
00:12:07,880 --> 00:12:11,000
or in case of incidents if something
goes bad

196
00:12:11,000 --> 00:12:14,970
they can analyze the data and see a
where the problem came from

197
00:12:14,970 --> 00:12:19,940
any questions so far

198
00:12:19,940 --> 00:12:22,990
okay I next

199
00:12:22,990 --> 00:12:26,110
I am let's say arm the security are

200
00:12:26,110 --> 00:12:30,530
awareness the time line from SCADA
systems I think it's important to

201
00:12:30,530 --> 00:12:35,990
to understand I am that's quite a a big
shift know what days instead I want us

202
00:12:35,990 --> 00:12:39,320
so before the 2011 let's say

203
00:12:39,320 --> 00:12:43,260
a nobody cared about scat security
that's mostly rights

204
00:12:43,260 --> 00:12:47,870
except from specific industries meet
maybe in the nuclei up

205
00:12:47,870 --> 00:12:52,410
protection there were doing some
security but most of my clients never

206
00:12:52,410 --> 00:12:56,220
ASCOM never mentioned the scale the
security of ACS before that

207
00:12:56,220 --> 00:13:00,520
before 2011 then

208
00:13:00,520 --> 00:13:03,830
I oh my god Stuxnet I of course the

209
00:13:03,830 --> 00:13:07,270
that was kind of a big deal because it
made it to the news a

210
00:13:07,270 --> 00:13:10,520
and not only the specific eighty or
security

211
00:13:10,520 --> 00:13:14,690
a newspaper it was all over the place so
that was

212
00:13:14,690 --> 00:13:19,020
at least for me and for my company quite
the a game changer because we were asked

213
00:13:19,020 --> 00:13:23,350
allots for ICS assessments and for

214
00:13:23,350 --> 00:13:27,620
let's see our ICS consoling and maybe
one day

215
00:13:27,620 --> 00:13:32,210
as we do today for some of the corporate
networks will have some fancy dashboard

216
00:13:32,210 --> 00:13:32,880
that

217
00:13:32,880 --> 00:13:35,830
actually means nothing about the
security level but at least you have

218
00:13:35,830 --> 00:13:41,070
yet something okay

219
00:13:41,070 --> 00:13:44,540
a so let's continue and

220
00:13:44,540 --> 00:13:48,740
I let's try to find out I what is wrong
currently

221
00:13:48,740 --> 00:13:51,870
with the level of security of ICS

222
00:13:51,870 --> 00:13:55,149
now so that's mainly based on the way
i've seen

223
00:13:55,149 --> 00:13:58,630
please feel free to join in the
compensation and at some things

224
00:13:58,630 --> 00:14:02,740
or tell me if I'm wrong down so well

225
00:14:02,740 --> 00:14:06,779
the first but would be a warm this an
organization from what I've been able to

226
00:14:06,779 --> 00:14:07,250
see

227
00:14:07,250 --> 00:14:11,230
I most of the time there is no security
awareness

228
00:14:11,230 --> 00:14:16,450
I for people working in yes yes field I
am they care about safety

229
00:14:16,450 --> 00:14:19,520
which means the safety of the the people
working in the factory

230
00:14:19,520 --> 00:14:23,040
the safety of the people for leaving me
nearby the factory

231
00:14:23,040 --> 00:14:26,620
and also they try not to pollute the
environment

232
00:14:26,620 --> 00:14:30,080
but that's what you call safety and it's
quite different from security

233
00:14:30,080 --> 00:14:34,700
I'm so they they think a lot about what
could go wrong

234
00:14:34,700 --> 00:14:37,930
in the process in terms of food safety
of the people but

235
00:14:37,930 --> 00:14:41,930
the really not take into account the
fact that someone could

236
00:14:41,930 --> 00:14:45,740
may be remotely access the ICS and do
some bad things

237
00:14:45,740 --> 00:14:48,940
also it's kinda hard defined

238
00:14:48,940 --> 00:14:51,959
someone to talk to concerning security

239
00:14:51,959 --> 00:14:55,970
when you visit the plant or a factory so
in corporate networks

240
00:14:55,970 --> 00:14:59,540
most of the time we have a chief
information a

241
00:14:59,540 --> 00:15:03,260
security officers that's not the case
for most ice yes

242
00:15:03,260 --> 00:15:05,750
locally on the plan to factory I

243
00:15:05,750 --> 00:15:09,210
sometimes only a few people are
knowledgeable about I T

244
00:15:09,210 --> 00:15:12,360
and that does not include security so

245
00:15:12,360 --> 00:15:15,450
thats also can overlook a very big deal

246
00:15:15,450 --> 00:15:21,890
next subject the network segmentation

247
00:15:21,890 --> 00:15:26,990
down will gonna deep dive in that later
but

248
00:15:26,990 --> 00:15:30,220
let's say that a from what I've been
able to see

249
00:15:30,220 --> 00:15:33,870
most of the time as I told you some data
needs to

250
00:15:33,870 --> 00:15:36,950
get out of the ICS to be said into

251
00:15:36,950 --> 00:15:40,920
are some kind of network applications
most of the time it's

252
00:15:40,920 --> 00:15:45,310
done wrongly I R that means that
sometimes you

253
00:15:45,310 --> 00:15:48,990
but some ICS devices on the Internet
that means that

254
00:15:48,990 --> 00:15:52,520
sometimes I all your corporate network

255
00:15:52,520 --> 00:15:55,750
denotes access all the the lets the web
interfaces

256
00:15:55,750 --> 00:15:59,090
of all you ICS so when we're talking
about

257
00:15:59,090 --> 00:16:04,170
be companies that have maybe a 100,000
employees

258
00:16:04,170 --> 00:16:10,620
that's too much clearly on sometimes the
network segmentation is only done using

259
00:16:10,620 --> 00:16:13,780
I let's see some access control least on
the router

260
00:16:13,780 --> 00:16:18,250
there's no real firewall therein there
is no real DMZ on

261
00:16:18,250 --> 00:16:22,850
that the diode so let's see if an
attacker can

262
00:16:22,850 --> 00:16:27,600
can reach into your corporate network
and if there are some pen tester over

263
00:16:27,600 --> 00:16:28,070
here

264
00:16:28,070 --> 00:16:32,070
I'm sure they this they know that it's
quite easy IOM

265
00:16:32,070 --> 00:16:35,580
it's also quite easy to jump from the
corporate network to the ACS network

266
00:16:35,580 --> 00:16:39,920
most of the time the nobility management

267
00:16:39,920 --> 00:16:43,640
I also how to pitch lets its not

268
00:16:43,640 --> 00:16:47,520
so easy to do on renewable it team
management right

269
00:16:47,520 --> 00:16:50,520
in the corporate network its quite
harder

270
00:16:50,520 --> 00:16:54,400
in the ACS world iron most of the time

271
00:16:54,400 --> 00:16:58,030
let's say for them the PLC is there are
some security updates

272
00:16:58,030 --> 00:17:02,700
I am so you have to update the firmware
the problem is that

273
00:17:02,700 --> 00:17:05,780
when you want to add a few more you have
to I

274
00:17:05,780 --> 00:17:08,760
ton of your industrial process for a
moment

275
00:17:08,760 --> 00:17:12,000
so let's say you have a a hundred PLC is

276
00:17:12,000 --> 00:17:16,140
maybe a plant needs to be shut down for
12 days or maybe a week

277
00:17:16,140 --> 00:17:19,709
and then thats be lots of money most of
the time

278
00:17:19,709 --> 00:17:25,030
there on I 24/7 so it's not possible to
apply the patch during the nights

279
00:17:25,030 --> 00:17:29,820
as we can do in the corporate network so
yeah

280
00:17:29,820 --> 00:17:33,020
that she's our at least but rarely
applied

281
00:17:33,020 --> 00:17:36,090
if we talk about the let saddam
classical

282
00:17:36,090 --> 00:17:39,820
IT company not like a Windows yeah

283
00:17:39,820 --> 00:17:43,220
it's a Windows XP I'll win the seven the
workstation

284
00:17:43,220 --> 00:17:47,429
I since the ICS is not directly
connected to

285
00:17:47,429 --> 00:17:51,720
the corporate networking do not benefit
from the WSUS systems for example

286
00:17:51,720 --> 00:17:56,530
so yes I am even the Windows machine are
Muslim the best

287
00:17:56,530 --> 00:18:03,530
to Jo Christian no

288
00:18:05,970 --> 00:18:09,340
uchino I'm mostly talking about
factories and plants

289
00:18:09,340 --> 00:18:12,550
and that this might meet us but I'm sure
I am

290
00:18:12,550 --> 00:18:15,980
on the led to the security problems

291
00:18:15,980 --> 00:18:20,040
must be the same but I've never assessed
security and lets them

292
00:18:20,040 --> 00:18:23,620
smart meters so on I really don't know

293
00:18:23,620 --> 00:18:27,100
but there was a great talk yesterday
about that

294
00:18:27,100 --> 00:18:34,100
a president resting yet

295
00:18:37,139 --> 00:18:44,139
yep

296
00:18:45,120 --> 00:18:45,889
yes but

297
00:18:45,889 --> 00:18:50,600
then you have to be sure that the lets
it to update mechanism

298
00:18:50,600 --> 00:18:55,100
its secured because as the the people
who did the the talk yesterday mentioned

299
00:18:55,100 --> 00:18:59,570
the nation they were able to I'll let
you create some kind of 40

300
00:18:59,570 --> 00:19:03,850
worm that we'll the spread itself by
modifying the film where of its not me

301
00:19:03,850 --> 00:19:04,100
too

302
00:19:04,059 --> 00:19:07,470
okay

303
00:19:07,470 --> 00:19:11,179
so that's mostly a derm industrial
control systems you can find in plants

304
00:19:11,179 --> 00:19:11,789
and factories

305
00:19:11,789 --> 00:19:14,909
from yeah

306
00:19:14,909 --> 00:19:18,379
let's continue with the security
protocols so

307
00:19:18,379 --> 00:19:21,690
as we we'll see later with Modbus most
of the times

308
00:19:21,690 --> 00:19:24,889
the there was no security included into
the particles

309
00:19:24,889 --> 00:19:28,980
so that means an authentication
cleartext protocols

310
00:19:28,980 --> 00:19:33,440
so let's say once you have network
access you basically have

311
00:19:33,440 --> 00:19:36,740
I the the possibility of doing
everything that won't

312
00:19:36,740 --> 00:19:40,600
which combine to the fact that the
network segmentation

313
00:19:40,600 --> 00:19:45,679
its lose and that's going to a big deal
um

314
00:19:45,679 --> 00:19:48,899
just a quick word about the third party
management

315
00:19:48,899 --> 00:19:52,669
on in most of plants of factories that
I've been to

316
00:19:52,669 --> 00:19:56,649
there was a lot of I'll it's a specific
devices manage

317
00:19:56,649 --> 00:19:59,620
only by a third party so I

318
00:19:59,620 --> 00:20:03,710
the client had to led the third party
come connect these specific computers

319
00:20:03,710 --> 00:20:05,100
maybe his USB key

320
00:20:05,100 --> 00:20:08,760
or even a low a remote connection to
that specific device

321
00:20:08,760 --> 00:20:13,120
or two the world ICS I am 220

322
00:20:13,120 --> 00:20:17,270
remote a connection and debugging and if
you do not agree with that

323
00:20:17,270 --> 00:20:20,380
than you lose the supports and then a

324
00:20:20,380 --> 00:20:23,400
you cannot take that risk so that's also
a big deal

325
00:20:23,400 --> 00:20:26,809
and the next topic is security
supervision

326
00:20:26,809 --> 00:20:30,580
which is a hot topic in the corporate
network most of the time people tried

327
00:20:30,580 --> 00:20:32,390
not to focus on your own protection

328
00:20:32,390 --> 00:20:36,679
but also on the ability of detecting any
security breach

329
00:20:36,679 --> 00:20:40,630
and responding to its I funny thing is
that

330
00:20:40,630 --> 00:20:44,390
let's ACS in Stata is all about
monitoring but something

331
00:20:44,390 --> 00:20:48,760
a process and it's quite different from
money turned to security other process

332
00:20:48,760 --> 00:20:52,230
so the capabilities I love

333
00:20:52,230 --> 00:20:56,429
the PLC's and other device that you can
find in terms of logging

334
00:20:56,429 --> 00:21:01,910
I most of the time quite low and at the
moment I've never seen someone

335
00:21:01,910 --> 00:21:03,160
performing a real

336
00:21:03,160 --> 00:21:04,200
that's it

337
00:21:04,200 --> 00:21:07,250
syslog on ICS & Co relating the loves

338
00:21:07,250 --> 00:21:08,290
I

339
00:21:08,290 --> 00:21:11,890
on I think maybe in the future nephew
years you can't see that but at the

340
00:21:11,890 --> 00:21:12,540
moment I'm

341
00:21:12,540 --> 00:21:16,820
never seen it and a question

342
00:21:16,820 --> 00:21:23,820
yet

343
00:21:26,780 --> 00:21:29,780
yeah but also for let's have private

344
00:21:29,780 --> 00:21:33,410
pursuing pools you can find some us some
private

345
00:21:33,410 --> 00:21:38,140
swimming pool on the Internet yes on
know the truth

346
00:21:38,140 --> 00:21:41,440
I actually I should we take a look at
those

347
00:21:41,440 --> 00:21:44,680
devices addition I do one is using small
factories

348
00:21:44,680 --> 00:21:49,740
and the cement is the that I'm not sure
its use in factories but that's the kind

349
00:21:49,740 --> 00:21:53,330
of device that they wouldn't want to but
in my home because it's quite cheap

350
00:21:53,330 --> 00:21:56,390
and it's too easy to program it does I'm

351
00:21:56,390 --> 00:21:59,540
I really owe puts so yes

352
00:21:59,540 --> 00:22:03,090
the this talk also includes the device
that you can find the

353
00:22:03,090 --> 00:22:09,820
atone yes

354
00:22:09,820 --> 00:22:14,980
I recently yes one of my clients not on
the ACS part but a client

355
00:22:14,980 --> 00:22:18,380
recently told me that's in this building
I which is a

356
00:22:18,380 --> 00:22:22,080
up so that a shipbuilding the eating was
remotely

357
00:22:22,080 --> 00:22:25,200
controlled by by someone from the
internet so

358
00:22:25,200 --> 00:22:32,200
yea was pretty scared for for this
winter

359
00:22:33,460 --> 00:22:37,729
okay the next up just a quick word about
the ice he asserts

360
00:22:37,729 --> 00:22:40,970
so it's a computer emergency response
team the us

361
00:22:40,970 --> 00:22:41,510
no

362
00:22:41,510 --> 00:22:45,390
that is specific to ACS it's quite
interesting to

363
00:22:45,390 --> 00:22:48,700
to take a look at at least if you want
to go from some

364
00:22:48,700 --> 00:22:52,350
some assessment and ICS and you're
looking for vulnerability known

365
00:22:52,350 --> 00:22:54,440
vulnerabilities in specific components

366
00:22:54,440 --> 00:22:58,429
you have to go there and check the
vulnerability but since

367
00:22:58,429 --> 00:23:03,980
um and also I

368
00:23:03,980 --> 00:23:08,330
actually DACs Surtees for the US but

369
00:23:08,330 --> 00:23:12,320
the lets in most of the devices used on
the same so individual abilities are the

370
00:23:12,320 --> 00:23:12,700
same

371
00:23:12,700 --> 00:23:17,309
and yet just a quick word about the
study day published

372
00:23:17,309 --> 00:23:21,309
last year they listed over 200 attacks
on ICS

373
00:23:21,309 --> 00:23:24,480
and some love them around eight US
successful

374
00:23:24,480 --> 00:23:28,640
so we also have to acknowledge that

375
00:23:28,640 --> 00:23:32,679
I am yes there are vulnerabilities and
yes they are being exploited right now

376
00:23:32,679 --> 00:23:38,270
okay so no

377
00:23:38,270 --> 00:23:42,299
we will I focus beats on what he is a
PLC

378
00:23:42,299 --> 00:23:49,299
your question

379
00:23:51,789 --> 00:23:54,200
I think what they mean by two hundred
attacks

380
00:23:54,200 --> 00:23:58,049
it's that a group let's see some low

381
00:23:58,049 --> 00:24:02,019
and incident was detected it was not
before the incident happened

382
00:24:02,019 --> 00:24:05,039
it was after yeah

383
00:24:05,039 --> 00:24:08,809
um

384
00:24:08,809 --> 00:24:13,450
okay so watch years PLC so as I told you
before

385
00:24:13,450 --> 00:24:17,090
I its and made to manage inputs and
outputs

386
00:24:17,090 --> 00:24:21,409
it's some kind of real time computer I
am

387
00:24:21,409 --> 00:24:25,009
its was invented to replace electrical
relays

388
00:24:25,009 --> 00:24:28,830
the because arm that's a a few

389
00:24:28,830 --> 00:24:31,929
dozen years ago people who are using

390
00:24:31,929 --> 00:24:35,779
electrical relays to bear from the
automation in plans and

391
00:24:35,779 --> 00:24:39,279
and the factories but was really
expensive when

392
00:24:39,279 --> 00:24:42,460
we wanted to modify the process you have
to rewire everything

393
00:24:42,460 --> 00:24:45,659
so that was costly so that's why we
invent

394
00:24:45,659 --> 00:24:49,629
they invented PLC's and a

395
00:24:49,629 --> 00:24:53,190
also last thing you have to know these
devices are I read

396
00:24:53,190 --> 00:24:57,250
that means they work in a harsh
environments when there is dust when

397
00:24:57,250 --> 00:24:57,740
there is

398
00:24:57,740 --> 00:25:03,080
electrical now is a the temperature is
not 18 degrees as in the Big Data Center

399
00:25:03,080 --> 00:25:07,279
so it's quite different from a computer
but basically

400
00:25:07,279 --> 00:25:14,139
I it's a real time computer on the right
side of the slide you consider s7-200

401
00:25:14,139 --> 00:25:16,280
which is the the smallest I

402
00:25:16,280 --> 00:25:20,350
are can see that I have you can see the
inputs the outputs there is a

403
00:25:20,350 --> 00:25:23,490
network connection for if the nets and

404
00:25:23,490 --> 00:25:27,810
does the power I if we take a look at
the

405
00:25:27,810 --> 00:25:31,000
at the same device but we try to look
what's inside

406
00:25:31,000 --> 00:25:34,360
now we see that there's a hardware went
above its

407
00:25:34,360 --> 00:25:39,050
does a few my own operating system for
example on the Snyder

408
00:25:39,050 --> 00:25:43,270
the operating system is the ex-works so
it's a real time operating system

409
00:25:43,270 --> 00:25:46,980
then you have some habitation

410
00:25:46,980 --> 00:25:50,830
on most of the time you have a web
server sometimes an FTP server

411
00:25:50,830 --> 00:25:54,190
a snmp-server and on the other side

412
00:25:54,190 --> 00:25:57,260
you have let saddam the

413
00:25:57,260 --> 00:26:00,810
the logic that you programming to your
plc and that is run

414
00:26:00,810 --> 00:26:04,710
through I'm either where I'll so in the
past I know that

415
00:26:04,710 --> 00:26:07,430
some people have discovered
vulnerabilities into those me there

416
00:26:07,430 --> 00:26:07,920
where

417
00:26:07,920 --> 00:26:11,900
and that allowed them to compromise
several PLC because they

418
00:26:11,900 --> 00:26:14,920
or real some of them rely on the same
I'm either way

419
00:26:14,920 --> 00:26:21,920
okay so

420
00:26:22,190 --> 00:26:27,200
to understand now appears he works it's
also interesting to know how you program

421
00:26:27,200 --> 00:26:28,050
a PLC

422
00:26:28,050 --> 00:26:32,700
so the the first a programming language
that was used and that these

423
00:26:32,700 --> 00:26:37,020
still used today is what we called a
ladder logic arm

424
00:26:37,020 --> 00:26:40,140
it was cool like that because it me
makes the look

425
00:26:40,140 --> 00:26:44,040
of I less and electrical wiring diagram

426
00:26:44,040 --> 00:26:46,269
you can see an example on the

427
00:26:46,269 --> 00:26:49,559
on the bottom left down

428
00:26:49,559 --> 00:26:53,669
but since then there was a standard
published that defines

429
00:26:53,669 --> 00:26:56,999
five main programming I languages

430
00:26:56,999 --> 00:27:00,230
I'm not getting a detailed them I'm just
gonna

431
00:27:00,230 --> 00:27:03,580
show you the examples on the left the
led a diagram

432
00:27:03,580 --> 00:27:07,450
which a mixed dune lead to real devices

433
00:27:07,450 --> 00:27:10,480
then in the middle you have did the
structured

434
00:27:10,480 --> 00:27:13,869
text example so it's like programming a

435
00:27:13,869 --> 00:27:17,090
you know classical programming language
and on the right you have the

436
00:27:17,090 --> 00:27:18,239
instruction least

437
00:27:18,239 --> 00:27:21,749
example so as you can see it looks like
you are as somebody

438
00:27:21,749 --> 00:27:26,149
are so maybe now I'm trying

439
00:27:26,149 --> 00:27:31,100
to show you are how is program the
snatch night appealed CC other

440
00:27:31,100 --> 00:27:38,100
a real example on

441
00:27:39,899 --> 00:27:46,899
yeah I'm just gonna set up my screen

442
00:28:04,310 --> 00:28:07,310
can you see at least somehow are some

443
00:28:07,310 --> 00:28:10,620
now I'm connected to the

444
00:28:10,620 --> 00:28:14,040
mmm to the PLC the Snyder won so that's
the one on top

445
00:28:14,040 --> 00:28:17,140
and transfer the program from the kids
did to my computer

446
00:28:17,140 --> 00:28:24,140
it should work I'm sorry

447
00:28:25,350 --> 00:28:32,350
everything is written in French

448
00:28:38,830 --> 00:28:40,929
on when you're using that kind of
software

449
00:28:40,929 --> 00:28:44,129
I you have to have a big screen because
there are some the two windows

450
00:28:44,129 --> 00:28:44,759
everywhere

451
00:28:44,759 --> 00:28:48,269
that's by the way that's Unity Pro
that's the programming

452
00:28:48,269 --> 00:28:52,429
a software that you have to use for all
it said most of the

453
00:28:52,429 --> 00:28:56,429
snyder's PLC so let's take a look

454
00:28:56,429 --> 00:29:02,139
at the code three basic

455
00:29:02,139 --> 00:29:05,850
just to to show you an example um

456
00:29:05,850 --> 00:29:09,450
so as you can see I there are

457
00:29:09,450 --> 00:29:12,580
are some lines that are green the other
1i read

458
00:29:12,580 --> 00:29:17,009
basically green means electricity is
flowing and red means that's nuts

459
00:29:17,009 --> 00:29:20,080
so for example here a

460
00:29:20,080 --> 00:29:23,749
one the light is lead because I just but

461
00:29:23,749 --> 00:29:26,820
this output two on um

462
00:29:26,820 --> 00:29:30,399
and the two other on are switched off

463
00:29:30,399 --> 00:29:33,639
because are lights 0 and light one

464
00:29:33,639 --> 00:29:36,889
are set to zero at the moment um

465
00:29:36,889 --> 00:29:41,080
so basically fate just the latest one

466
00:29:41,080 --> 00:29:46,539
so that's ladder logic

467
00:29:46,539 --> 00:29:52,760
as a I was a explain before

468
00:29:52,760 --> 00:29:56,060
and now I can transfer it to the

469
00:29:56,060 --> 00:30:03,060
to the PNC schools

470
00:30:04,960 --> 00:30:07,360
yes but mostly we will cover that

471
00:30:07,360 --> 00:30:11,700
in the second part of the workshop
because the weights done by the software

472
00:30:11,700 --> 00:30:18,700
is quite funky I am but yes

473
00:30:21,090 --> 00:30:25,220
and it's absolutely not working is it
out maybe it's and stuff

474
00:30:25,220 --> 00:30:28,980
yes so no its

475
00:30:28,980 --> 00:30:32,440
I it's it on because the electricity is
flowing

476
00:30:32,440 --> 00:30:36,050
some just gonna go back to

477
00:30:36,050 --> 00:30:43,050
could have done previously they can K

478
00:31:02,110 --> 00:31:05,630
okay so basically that was just to give
you an idea of how it works

479
00:31:05,630 --> 00:31:09,950
I which is programmed down let's see the
people that they met

480
00:31:09,950 --> 00:31:13,320
mostly use the ladder logic but I'm sure

481
00:31:13,320 --> 00:31:16,880
depends on the company and the the
specific policy about that

482
00:31:16,880 --> 00:31:20,510
I gay so

483
00:31:20,510 --> 00:31:27,510
let's go back to the slides

484
00:31:38,210 --> 00:31:39,210
okay

485
00:31:39,210 --> 00:31:43,790
so next topic I mentioned the the luck
on the usual lack of making

486
00:31:43,790 --> 00:31:47,180
network segmentation and I just wanted
to give you some

487
00:31:47,180 --> 00:31:50,710
example of what the real lack of
segmentation looks like that means

488
00:31:50,710 --> 00:31:54,550
can we find Skoda on the Internet are
you

489
00:31:54,550 --> 00:31:59,210
me know that the answer is yes um to do
that I will demonstrate

490
00:31:59,210 --> 00:32:03,040
the using showdown a I'm sure you've
heard of it

491
00:32:03,040 --> 00:32:06,500
I should and he's basically a on a
search engine

492
00:32:06,500 --> 00:32:09,540
and that scans the wall ipv4 the

493
00:32:09,540 --> 00:32:13,660
addresses all the time and allows you to
list let's is search

494
00:32:13,660 --> 00:32:19,020
some specific a some some specific
devices are some specific

495
00:32:19,020 --> 00:32:22,150
versions of software so

496
00:32:22,150 --> 00:32:26,710
I it's mostly free how well you have to
paid to export all the results

497
00:32:26,710 --> 00:32:32,180
I'll what else can I say oh yes in my
personal experience if I

498
00:32:32,180 --> 00:32:35,590
just by view to machine on Amazon Cloud

499
00:32:35,590 --> 00:32:39,030
and they startin apache server within
two hours it has been

500
00:32:39,030 --> 00:32:42,510
for you take a look at the lots within
two hours it has been scanned by should

501
00:32:42,510 --> 00:32:42,780
I am

502
00:32:42,780 --> 00:32:48,420
so that's quite efficient I of course
you can find some funny things you can

503
00:32:48,420 --> 00:32:51,180
find PLC's like the Snyder in the
seaman's

504
00:32:51,180 --> 00:32:56,340
can find some webcams you can find some
printers I are some freaks maybe

505
00:32:56,340 --> 00:32:59,980
I am they also have quite good report on
ICS

506
00:32:59,980 --> 00:33:00,980
so I

507
00:33:00,980 --> 00:33:05,100
they try to control the date that you
find how many ICS

508
00:33:05,100 --> 00:33:09,280
can be reach from the internet however

509
00:33:09,280 --> 00:33:12,350
you have to know that sure that works a
in an out out

510
00:33:12,350 --> 00:33:17,100
mode that means a issue on ISP and you
do not want you IP addresses to be

511
00:33:17,100 --> 00:33:18,020
scanned they should N

512
00:33:18,020 --> 00:33:21,669
you can ask so basically what you can
find sure that he's not

513
00:33:21,669 --> 00:33:24,929
the it to the world perimeter it's only

514
00:33:24,929 --> 00:33:29,080
what they are allowed to scan so if you
want to do it yourself

515
00:33:29,080 --> 00:33:32,919
da quite some tools as the map my scan

516
00:33:32,919 --> 00:33:38,350
and does also French tool called I eat
and I'm sure you can find some

517
00:33:38,350 --> 00:33:42,620
other online services that is the same
that's one

518
00:33:42,620 --> 00:33:45,690
example I E once so on Twitter

519
00:33:45,690 --> 00:33:48,980
so there was someone scanning the
internet and finding dis

520
00:33:48,980 --> 00:33:53,679
schedule system which is actually a
crematorium so that was pre accessible

521
00:33:53,679 --> 00:33:58,030
and you can start the fire and
everything so that that's

522
00:33:58,030 --> 00:34:01,360
lets it the most for example have but
I'm gonna

523
00:34:01,360 --> 00:34:06,210
when trying to connect to ship them to
show you I if you can find some devices

524
00:34:06,210 --> 00:34:09,330
as the Snyder or maybe

525
00:34:09,330 --> 00:34:12,470
as the Siemens just

526
00:34:12,470 --> 00:34:19,470
looking for my phone because I heard
that the wifi is not working that well

527
00:34:40,690 --> 00:34:44,819
kid it works yes

528
00:34:44,819 --> 00:34:48,450
so basically that's the new version of
showdown you have on you

529
00:34:48,450 --> 00:34:52,460
user interface it's quite funny the so
let me put em third

530
00:34:52,460 --> 00:34:56,369
3 forty which is the the mother love to
Snyder PLC

531
00:34:56,369 --> 00:35:02,309
so yes they found some

532
00:35:02,309 --> 00:35:05,529
I am gonna few to buy that the country's
I'm gonna

533
00:35:05,529 --> 00:35:09,640
check out the the ones in France so

534
00:35:09,640 --> 00:35:15,789
there are not a lot while a even for TPS
is connected to the Internet is great

535
00:35:15,789 --> 00:35:20,490
a strange as you can see

536
00:35:20,490 --> 00:35:24,359
now some youth some interesting
information can be found

537
00:35:24,359 --> 00:35:28,500
the using show than so you have the name
of the project

538
00:35:28,500 --> 00:35:33,670
and other things I'll let sleeping
detail me on this one

539
00:35:33,670 --> 00:35:40,569
it's a friend on my I do not know this

540
00:35:40,569 --> 00:35:45,130
this one okay so the port that was gone
worse

541
00:35:45,130 --> 00:35:48,740
the SNMP 1 so some information where

542
00:35:48,740 --> 00:35:51,890
send back that's not really interesting
fountain

543
00:35:51,890 --> 00:35:56,089
you can find some that have not be seen
the bold so I'm sure issue

544
00:35:56,089 --> 00:36:02,260
we should find some yes this one for
example

545
00:36:02,260 --> 00:36:06,329
everything is open great so you have the
FTP ports

546
00:36:06,329 --> 00:36:09,869
so you do you have the list of available
commands you have

547
00:36:09,869 --> 00:36:12,930
the web interface within the take a look
at that later

548
00:36:12,930 --> 00:36:17,770
S&P of course and Modbus I which allows
you to have

549
00:36:17,770 --> 00:36:21,250
precise version of the CPU I

550
00:36:21,250 --> 00:36:25,370
as well as the version of the projects
and

551
00:36:25,370 --> 00:36:32,370
that's all so let me just see if it
works

552
00:36:38,849 --> 00:36:45,849
seems to work

553
00:36:48,380 --> 00:36:53,600
when train other one did not prepare
that

554
00:36:53,600 --> 00:36:56,630
but I was sure to to find some down

555
00:36:56,630 --> 00:37:03,630
sorry

556
00:37:03,790 --> 00:37:10,790
work

557
00:37:13,970 --> 00:37:15,030
this one

558
00:37:15,030 --> 00:37:17,970
and the okay so this one as evened it on
the court

559
00:37:17,970 --> 00:37:23,020
which is great as you can see it speaks
works as I told you on

560
00:37:23,020 --> 00:37:26,450
actually I do not mean know how it's
possible to have 10 that

561
00:37:26,450 --> 00:37:29,960
enabled they succeeded

562
00:37:29,960 --> 00:37:33,900
apparently so yes the so that's the real
web interface of

563
00:37:33,900 --> 00:37:38,849
on one PLC somewhere in France I'm not
gonna try to looking with the default

564
00:37:38,849 --> 00:37:39,619
credential

565
00:37:39,619 --> 00:37:43,359
I'm sure that would be pretty illegal I
am

566
00:37:43,359 --> 00:37:46,990
and I'm gonna do the same with the other
kind of PLT that they have

567
00:37:46,990 --> 00:37:51,970
which is the same and Siemens s7 1200 I
am so

568
00:37:51,970 --> 00:37:55,359
yes knots lots but we can find some

569
00:37:55,359 --> 00:38:00,430
with

570
00:38:00,430 --> 00:38:04,200
a lot of open ports as well in France so
you have FTP

571
00:38:04,200 --> 00:38:08,720
you have HDPE that is strange

572
00:38:08,720 --> 00:38:13,650
a they must have some kind of port
forwarding there because that's not that

573
00:38:13,650 --> 00:38:15,020
the web interface of the

574
00:38:15,020 --> 00:38:19,030
the Siemens but there is the specific
proprietary protocol

575
00:38:19,030 --> 00:38:22,230
a seven on part one hundred and to so

576
00:38:22,230 --> 00:38:26,099
that's also quite dangerous and just to
finish

577
00:38:26,099 --> 00:38:29,970
this new version of sure that is quite
greats because of course you can see the

578
00:38:29,970 --> 00:38:31,050
results on the map

579
00:38:31,050 --> 00:38:35,349
if you pay for it I think but you also
have and exploit that which allows you

580
00:38:35,349 --> 00:38:35,810
to

581
00:38:35,810 --> 00:38:40,080
the have the least of explode state may
or may not work for those kind of

582
00:38:40,080 --> 00:38:44,099
a specific devices so yeah it's really a

583
00:38:44,099 --> 00:38:51,099
all-inclusive

584
00:38:59,220 --> 00:39:04,730
and let's go back

585
00:39:04,730 --> 00:39:06,750
okay so that was all for the first but
which is

586
00:39:06,750 --> 00:39:11,270
we trust introduction and you have any
question if no we gonna switch to the

587
00:39:11,270 --> 00:39:12,230
second part which is

588
00:39:12,230 --> 00:39:15,580
a it's a description of the Modbus
protocol to understand how it works

589
00:39:15,580 --> 00:39:19,050
down

590
00:39:19,050 --> 00:39:22,410
yeah that's I do not have the text me
computes the

591
00:39:22,410 --> 00:39:25,460
Mike this is a serial communication
protocol was

592
00:39:25,460 --> 00:39:29,220
invented a long time ago I think it was
nineteen since nine

593
00:39:29,220 --> 00:39:32,300
by Schneider electric I am

594
00:39:32,300 --> 00:39:36,090
its was made specifically for industrial

595
00:39:36,090 --> 00:39:39,190
occasions and it was royalty-free

596
00:39:39,190 --> 00:39:42,150
that means I if you were developing some
I

597
00:39:42,150 --> 00:39:46,880
PLC's are the kind of ACS component it
was free to implement my biz particle

598
00:39:46,880 --> 00:39:50,549
that's why no at least in you up and is
in France

599
00:39:50,549 --> 00:39:54,240
it's one of the the most widespread
industry protocol

600
00:39:54,240 --> 00:39:57,569
it works I in the master-slave

601
00:39:57,569 --> 00:40:00,710
mode that means and the master has two

602
00:40:00,710 --> 00:40:04,150
polled information from the slave at our
regular lot time

603
00:40:04,150 --> 00:40:07,160
from on you can

604
00:40:07,160 --> 00:40:10,650
only have a around 250 slaves

605
00:40:10,650 --> 00:40:15,779
they are on modest muster and also you
have to know that

606
00:40:15,779 --> 00:40:19,059
on data that you get is without any

607
00:40:19,059 --> 00:40:22,900
kind of context so you have to know if
you are craving

608
00:40:22,900 --> 00:40:27,450
a sign in to go our own and sign in to
your because it just get the value not

609
00:40:27,450 --> 00:40:32,589
any kind of object or description of the
data security anyone

610
00:40:32,589 --> 00:40:36,539
and no not really as I told you before
for sick and it's the

611
00:40:36,539 --> 00:40:39,829
and the case for most of industry
protocol so it's clear text

612
00:40:39,829 --> 00:40:43,400
there is dunno kinda authentication so

613
00:40:43,400 --> 00:40:46,859
I let's see if I have cable that is
played to a network

614
00:40:46,859 --> 00:40:49,880
on which there is a must be seen able
device

615
00:40:49,880 --> 00:40:54,589
I can freely a ask for some data and
also said data

616
00:40:54,589 --> 00:40:58,430
I yes so

617
00:40:58,430 --> 00:41:03,440
from mostly I am my biz was invented
Ontario

618
00:41:03,440 --> 00:41:06,869
the put the it was a serial
communication portable

619
00:41:06,869 --> 00:41:10,089
but now since people tend to use

620
00:41:10,089 --> 00:41:13,109
the classical Ethernet networks in the
plants

621
00:41:13,109 --> 00:41:16,270
there is a my biz TCP version of the
protocol

622
00:41:16,270 --> 00:41:19,490
on that actually implements

623
00:41:19,490 --> 00:41:23,190
are all the same security features I

624
00:41:23,190 --> 00:41:26,210
so yeah it's basically the same portable
over TCP

625
00:41:26,210 --> 00:41:30,569
I if you take a look at the whether my
biz TCP frame looks like

626
00:41:30,569 --> 00:41:34,329
there is a transaction identifiers on
that helps

627
00:41:34,329 --> 00:41:38,119
making sure that when you get to a
response

628
00:41:38,119 --> 00:41:42,319
from the device response to which
request I

629
00:41:42,319 --> 00:41:45,480
then you have the critical identify your
which is not really interesting because

630
00:41:45,480 --> 00:41:45,849
it's

631
00:41:45,849 --> 00:41:49,299
0 all the time you have a

632
00:41:49,299 --> 00:41:52,059
field for the length up the remaining
the

633
00:41:52,059 --> 00:41:56,200
the remaining length of the packets you
have the address above the slave

634
00:41:56,200 --> 00:41:59,480
so as we're talking at TCP

635
00:41:59,480 --> 00:42:03,160
there is already the IP address that is
used to know

636
00:42:03,160 --> 00:42:07,260
the to who you talking to so actually
most of the time its

637
00:42:07,260 --> 00:42:10,380
01 are 255 that is used

638
00:42:10,380 --> 00:42:15,670
one and dealing with my biz TC keep and
then you have the function code

639
00:42:15,670 --> 00:42:21,069
and the data on

640
00:42:21,069 --> 00:42:24,630
well well Katie on Nowitzki which

641
00:42:24,630 --> 00:42:27,940
are the most basic function that you can
find in my biz TCP

642
00:42:27,940 --> 00:42:31,170
some so there is to

643
00:42:31,170 --> 00:42:35,799
be kind of the to you have a call you
that means as you all one

644
00:42:35,799 --> 00:42:38,869
and you also have what they call a room
a register

645
00:42:38,869 --> 00:42:42,190
that stores some kind of world the that

646
00:42:42,190 --> 00:42:45,319
are a bit long so I

647
00:42:45,319 --> 00:42:49,109
yet the most basic function allowed to
read and write to Collins

648
00:42:49,109 --> 00:42:54,160
and registers II to the stable from
Wikipedia so if you want more

649
00:42:54,160 --> 00:42:57,539
information about what kind of function
you can find on my biz

650
00:42:57,539 --> 00:43:00,750
go to Wikipedia at it's not on the
reason rights

651
00:43:00,750 --> 00:43:04,339
there is also some kind of diagnostic
functions the

652
00:43:04,339 --> 00:43:08,210
you can in some cases depending on the
implementation you can also read some

653
00:43:08,210 --> 00:43:09,049
files from the

654
00:43:09,049 --> 00:43:12,569
device and of course some of the a

655
00:43:12,569 --> 00:43:16,460
function codes are not documented and
are used by some

656
00:43:16,460 --> 00:43:22,299
manufacturer to from some things okay

657
00:43:22,299 --> 00:43:25,329
so know what we can do is try to

658
00:43:25,329 --> 00:43:29,099
a on understand home but this works by
taking look at

659
00:43:29,099 --> 00:43:32,109
a network capture so did

660
00:43:32,109 --> 00:43:33,860
anyone a

661
00:43:33,860 --> 00:43:36,830
succeed in getting the USB key and a
virtual machine

662
00:43:36,830 --> 00:43:42,150
take that for a yes I

663
00:43:42,150 --> 00:43:49,150
K

664
00:43:54,650 --> 00:43:59,400
so if you do not know if the the account
name is in route and the

665
00:43:59,400 --> 00:44:03,500
password is route reversed so that means
tooo

666
00:44:03,500 --> 00:44:10,500
our I okay

667
00:44:22,150 --> 00:44:27,200
are signed files directory you should be
able to find minus one that P cap

668
00:44:27,200 --> 00:44:33,180
of course you up to

669
00:44:33,180 --> 00:44:36,759
classical warnings becomes you are
running whale shark as root

670
00:44:36,759 --> 00:44:41,819
which is re not such a good idea um

671
00:44:41,819 --> 00:44:45,779
so the the first thing we can do is I
let it ride to

672
00:44:45,779 --> 00:44:49,009
theater arts a only the

673
00:44:49,009 --> 00:44:52,190
Modbus the communication so we can

674
00:44:52,190 --> 00:44:56,819
future by TCP ports so the TCP port used
by my biz

675
00:44:56,819 --> 00:45:02,829
is 502 are so that was pretty useless
since in the disc precise capture I give

676
00:45:02,829 --> 00:45:05,099
you only modest iron

677
00:45:05,099 --> 00:45:08,160
communications but anywhere you can see
that we have

678
00:45:08,160 --> 00:45:11,160
three-way discipline JH and then

679
00:45:11,160 --> 00:45:17,240
we have the the first modest request so

680
00:45:17,240 --> 00:45:20,549
we can see that on it complies

681
00:45:20,549 --> 00:45:24,339
with the description a mid-career you
have one transaction

682
00:45:24,339 --> 00:45:28,009
identify your provide an affair 0

683
00:45:28,009 --> 00:45:31,450
six remaining diets and the unit
identifiers one

684
00:45:31,450 --> 00:45:35,839
if we now take a look at the mob is
payload

685
00:45:35,839 --> 00:45:38,940
we can see that the function code is 3

686
00:45:38,940 --> 00:45:42,759
with means which means reading a
registers

687
00:45:42,759 --> 00:45:46,079
we france number means the address of
the data

688
00:45:46,079 --> 00:45:49,269
and here it is 0 so it's the

689
00:45:49,269 --> 00:45:56,269
first data and we want to read for
sixteen years

690
00:45:58,050 --> 00:46:01,400
token if you take a look at the answer
from the device

691
00:46:01,400 --> 00:46:05,210
you see that the transaction identifiers
is exactly the same

692
00:46:05,210 --> 00:46:08,530
that's the right answer it's actually
quite longer

693
00:46:08,530 --> 00:46:11,869
which is a good sign because we ask for
16 words

694
00:46:11,869 --> 00:46:15,849
function code is the same and then you
have

695
00:46:15,849 --> 00:46:22,849
several values that careful

696
00:46:23,190 --> 00:46:30,190
01 sounds so if they go back two months
later I think I you

697
00:46:31,200 --> 00:46:34,810
I was asking a question about and the
value

698
00:46:34,810 --> 00:46:38,349
a specific value yes so in the capture
you can see that there are some other

699
00:46:38,349 --> 00:46:39,140
requests

700
00:46:39,140 --> 00:46:43,339
and I would like to know the if you're
able to tell me what's the value of the

701
00:46:43,339 --> 00:46:44,710
register number one

702
00:46:44,710 --> 00:46:48,200
23 at the end see if you can take a look
at the fine capture

703
00:46:48,200 --> 00:46:51,410
is quite easy you can just as quantity
and

704
00:46:51,410 --> 00:46:58,410
and it's quite scan over blessed like it
I think

705
00:47:15,360 --> 00:47:19,660
so as you can see now where shock
actually has a pretty good day sector

706
00:47:19,660 --> 00:47:20,670
from this particle

707
00:47:20,670 --> 00:47:26,860
so it's really easy to understand how it
works so you have several chris'

708
00:47:26,860 --> 00:47:33,860
answers

709
00:47:39,750 --> 00:47:44,540
did somebody find the answer

710
00:47:44,540 --> 00:47:47,220
k I'm just going to tell you then arm

711
00:47:47,220 --> 00:47:51,550
let's

712
00:47:51,550 --> 00:47:55,609
the ok okay so here we are

713
00:47:55,609 --> 00:47:58,790
on asking to read I am

714
00:47:58,790 --> 00:48:04,609
to read some value and I think that's
too good porn

715
00:48:04,609 --> 00:48:07,990
yet

716
00:48:07,990 --> 00:48:12,190
that sector this one and I'm gonna
explain to you why if we take a look at

717
00:48:12,190 --> 00:48:12,820
the query

718
00:48:12,820 --> 00:48:18,650
we asked to read

719
00:48:18,650 --> 00:48:22,930
some reducers and the reference number
was 120

720
00:48:22,930 --> 00:48:26,330
so we wanted to read one hundred and 20
21 22

721
00:48:26,330 --> 00:48:30,580
and 23 and if you take a look at the
answer

722
00:48:30,580 --> 00:48:33,750
which bears the same on

723
00:48:33,750 --> 00:48:37,349
transaction identifiers the

724
00:48:37,349 --> 00:48:39,860
we can see that the value is the

725
00:48:39,860 --> 00:48:43,120
57,000 five which means should take a
look

726
00:48:43,120 --> 00:48:46,450
on the bottom of the screen a T exile

727
00:48:46,450 --> 00:48:50,060
X value its actually that so that

728
00:48:50,060 --> 00:48:53,440
was the answer you have to know that
depending on the importance of software

729
00:48:53,440 --> 00:48:54,240
implementation

730
00:48:54,240 --> 00:48:59,190
sometimes the than register address
starts at zero sometimes at one

731
00:48:59,190 --> 00:49:02,420
so that's also some something you can
take into account

732
00:49:02,420 --> 00:49:06,630
okay

733
00:49:06,630 --> 00:49:10,180
I am I think there will be a break in
about 10 minutes

734
00:49:10,180 --> 00:49:14,280
I am if I'm not wrong so

735
00:49:14,280 --> 00:49:17,830
what we can do is the do another
exercise

736
00:49:17,830 --> 00:49:21,240
on the on my BIS this time using a

737
00:49:21,240 --> 00:49:28,240
miss you later I its yeah

738
00:49:28,740 --> 00:49:32,270
so included in the future machine you
have not be spell

739
00:49:32,270 --> 00:49:35,460
that is a Jr might be simulator it does
you too

740
00:49:35,460 --> 00:49:38,880
this issue developing some specific
tools are you trying to understand how

741
00:49:38,880 --> 00:49:41,770
much this works it's quite interesting
to other two later because you do not

742
00:49:41,770 --> 00:49:43,130
have a PLC all the time

743
00:49:43,130 --> 00:49:47,110
the just around so to lunch it's quite
easy

744
00:49:47,110 --> 00:49:50,910
you just the going to do right the
directory which is

745
00:49:50,910 --> 00:49:55,050
a tools and then you into Jayda a-minus
jar

746
00:49:55,050 --> 00:49:56,789
and the name of

747
00:49:56,789 --> 00:50:00,200
the program which is not dispel and

748
00:50:00,200 --> 00:50:07,200
I'm gonna work few walk you through it

749
00:50:11,680 --> 00:50:13,580
okay so we go to the tools and

750
00:50:13,580 --> 00:50:17,890
directory and then we start the
simulator

751
00:50:17,890 --> 00:50:23,420
which actually has a nice greed yes here
it is

752
00:50:23,420 --> 00:50:28,910
on next the first thing to do is to try
to add some slaves

753
00:50:28,910 --> 00:50:32,260
because as I mentioned before the each

754
00:50:32,260 --> 00:50:36,630
on that it's a master/slave protocol so
I'm just gonna add one slave

755
00:50:36,630 --> 00:50:40,360
you but then if any name that she wants

756
00:50:40,360 --> 00:50:43,960
okay so you can add

757
00:50:43,960 --> 00:50:50,960
no 71 she want doesn't matter okay so

758
00:50:51,830 --> 00:50:55,410
let's see if I want to I modify the
values of this

759
00:50:55,410 --> 00:51:01,180
first slave when they take on the big
guy and then you see us ever thought

760
00:51:01,180 --> 00:51:04,410
tabs one from the code so gonna kick on
add

761
00:51:04,410 --> 00:51:08,640
and then just Next Next Next add so you
see no I have

762
00:51:08,640 --> 00:51:12,260
a.m. we can modify the value of all the
codes

763
00:51:12,260 --> 00:51:15,890
so I'm gonna do its

764
00:51:15,890 --> 00:51:19,500
are the teeth 8 writing part 5 actually
inputs long

765
00:51:19,500 --> 00:51:22,930
since as I told you to values this year
all 14 Coriell

766
00:51:22,930 --> 00:51:26,250
and for register into the San you add

767
00:51:26,250 --> 00:51:31,500
and then try to modify some value
depending at that address that you want

768
00:51:31,500 --> 00:51:35,140
once it's done you just

769
00:51:35,140 --> 00:51:39,520
close the windows click on run and then

770
00:51:39,520 --> 00:51:40,059
I

771
00:51:40,059 --> 00:51:43,279
are you have in my biz device listening
on localhost so that's

772
00:51:43,279 --> 00:51:49,209
n/a convenient doubt

773
00:51:49,209 --> 00:51:52,319
to tools that we're going to use not
clear from the square is

774
00:51:52,319 --> 00:51:55,920
I but maybe yeah let's just one before
the

775
00:51:55,920 --> 00:51:59,630
that the break its on patrol to

776
00:51:59,630 --> 00:52:05,859
that's cool Mb to get so if you want to
take a look at the source code you can

777
00:52:05,859 --> 00:52:10,539
so it's a common lane to

778
00:52:10,539 --> 00:52:14,189
slate easy to to understand it's also
and it was the

779
00:52:14,189 --> 00:52:18,019
directory she want to die from some
requests used

780
00:52:18,019 --> 00:52:20,220
r1 switch I

781
00:52:20,220 --> 00:52:24,010
on for the cause and there are three
switch for the words

782
00:52:24,010 --> 00:52:27,040
then you have to pass the the address

783
00:52:27,040 --> 00:52:30,250
of course the number of words

784
00:52:30,250 --> 00:52:33,740
I'll call you that you want to read it
so that stance which and then the IP

785
00:52:33,740 --> 00:52:40,740
address

786
00:52:45,630 --> 00:52:48,369
okay let's see so on

787
00:52:48,369 --> 00:52:55,369
pin-up you to so that see

788
00:52:56,410 --> 00:53:00,650
on we used to are one switch to read the
value of some girl

789
00:53:00,650 --> 00:53:04,349
aren't starting at

790
00:53:04,349 --> 00:53:07,349
address 0 an I want to read 8

791
00:53:07,349 --> 00:53:10,960
it and then just input night I should
truants

792
00:53:10,960 --> 00:53:15,690
and you see that the values are 111 and
then on the zeros

793
00:53:15,690 --> 00:53:19,390
I'm gonna do a double check by looking
for the gooey

794
00:53:19,390 --> 00:53:23,160
cool

795
00:53:23,160 --> 00:53:26,220
occurs and you can see that they have
one 11

796
00:53:26,220 --> 00:53:33,220
and then on the zeros so I'm just gonna
money for it

797
00:53:38,099 --> 00:53:41,080
and if a pair from the same request the
first value should be zero

798
00:53:41,080 --> 00:53:48,080
and it is does that work for all those
%uh view all

799
00:53:48,820 --> 00:53:55,820
while performing the the test sorry

800
00:54:00,890 --> 00:54:05,430
which one then let me spell okay I
because it runs on port

801
00:54:05,430 --> 00:54:11,529
the 502 yep sure iron

802
00:54:11,529 --> 00:54:14,440
that's why we do not have this kind of
problem then Kelly since you're running

803
00:54:14,440 --> 00:54:15,150
everything

804
00:54:15,150 --> 00:54:18,359
new routes which is a very bad idea of
course from a security point of view

805
00:54:18,359 --> 00:54:24,380
arm okay

806
00:54:24,380 --> 00:54:27,680
so let's do the same kind of requests on
registers

807
00:54:27,680 --> 00:54:34,219
reached stores a lets a longer values so
you can see that have 1,2,3,4,5

808
00:54:34,219 --> 00:54:38,259
and that should be the same if they take
a look at here

809
00:54:38,259 --> 00:54:43,349
yes that's the same doesn't

810
00:54:43,349 --> 00:54:50,349
changed her 25 26

811
00:54:53,550 --> 00:54:56,360
and it works

812
00:54:56,360 --> 00:54:59,030
of course if I want to I can also modify

813
00:54:59,030 --> 00:55:02,230
the value by

814
00:55:02,230 --> 00:55:05,860
using the switch W six and in putting a

815
00:55:05,860 --> 00:55:12,760
and the address that's it address 1: so
it's a worldwide

816
00:55:12,760 --> 00:55:18,940
okay and fate take a look in agree I
have to adjust address number two

817
00:55:18,940 --> 00:55:22,070
where was I ask for address 1: which is
a different

818
00:55:22,070 --> 00:55:25,920
because there is an offsetting the
that's it as I told you some software

819
00:55:25,920 --> 00:55:27,790
you zero as the first tell you some
other

820
00:55:27,790 --> 00:55:34,790
use one as the first value so is it
working for you

821
00:55:37,300 --> 00:55:40,330
everyone Jovani a enough question

822
00:55:40,330 --> 00:55:47,250
nope okay

823
00:55:47,250 --> 00:55:50,440
I'm just continuing tried to modify the
accorded

824
00:55:50,440 --> 00:55:53,540
because thats and the possibility

825
00:55:53,540 --> 00:55:57,310
I do not hey

826
00:55:57,310 --> 00:56:01,070
do not remember exact command

827
00:56:01,070 --> 00:56:08,070
someone to cook Italian so if you want
to wear two bits w5

828
00:56:21,910 --> 00:56:25,670
kiss that should have worked Swan

829
00:56:25,670 --> 00:56:32,670
if they do the same with the value 0 NCR

830
00:56:38,740 --> 00:56:42,320
okay rate I think if you do not have any
other question we

831
00:56:42,320 --> 00:56:45,590
can take our break what I we gonna do
after the break

832
00:56:45,590 --> 00:56:49,330
we're gonna do the the same kind of
request using Metasploit

833
00:56:49,330 --> 00:56:53,640
because there is an integrated
miscreants a senior in with you

834
00:56:53,640 --> 00:56:57,000
and I then

835
00:56:57,000 --> 00:57:00,250
after I'm going to try to set up a WiFi
network is so

836
00:57:00,250 --> 00:57:04,010
the those %uh view which are interested
can bear from the same this doesn't me

837
00:57:04,010 --> 00:57:05,400
on the real devices

838
00:57:05,400 --> 00:57:08,890
and by those test I mean performing some
kind of Oregon using

839
00:57:08,890 --> 00:57:13,350
and not popular to scan then we are
going to use the same to me. to get on

840
00:57:13,350 --> 00:57:14,060
with this plate

841
00:57:14,060 --> 00:57:17,830
to death from mcdyess request to the
Schneider PLC

842
00:57:17,830 --> 00:57:23,230
and then I'm gonna try to show you a
let's say 10 to the new ability in the

843
00:57:23,230 --> 00:57:23,900
Snyder

844
00:57:23,900 --> 00:57:29,310
PLC I am thats a low enough indicated
stop and start on maybe

845
00:57:29,310 --> 00:57:33,010
go and try to i retrieve the program
without being

846
00:57:33,010 --> 00:57:39,520
authenticated on

