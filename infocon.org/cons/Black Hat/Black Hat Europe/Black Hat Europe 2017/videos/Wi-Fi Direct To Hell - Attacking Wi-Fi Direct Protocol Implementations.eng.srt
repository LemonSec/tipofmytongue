1
00:00:00,000 --> 00:00:04,620
hey hello everyone<font color="#E5E5E5"> I'm really happy to</font>

2
00:00:01,949 --> 00:00:08,300
<font color="#E5E5E5">be here this</font><font color="#CCCCCC"> is my</font><font color="#E5E5E5"> presentation that I'm</font>

3
00:00:04,620 --> 00:00:10,950
going to talk<font color="#CCCCCC"> about Wi-Fi</font><font color="#E5E5E5"> direct first</font><font color="#CCCCCC"> a</font>

4
00:00:08,300 --> 00:00:14,120
<font color="#E5E5E5">brief introduction</font><font color="#CCCCCC"> of myself my name is</font>

5
00:00:10,950 --> 00:00:18,000
<font color="#CCCCCC">Andres Blanco I</font><font color="#E5E5E5"> usually like to reverse</font>

6
00:00:14,120 --> 00:00:21,990
perform<font color="#CCCCCC"> network research and privacy and</font>

7
00:00:18,000 --> 00:00:24,779
I<font color="#CCCCCC"> usually enjoy</font><font color="#E5E5E5"> doing Wi-Fi research and</font>

8
00:00:21,990 --> 00:00:28,049
I'm not a<font color="#E5E5E5"> native speaker</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> someone has</font>

9
00:00:24,779 --> 00:00:31,948
a problem listening<font color="#E5E5E5"> please question at</font>

10
00:00:28,050 --> 00:00:34,350
the<font color="#CCCCCC"> end of the presentation so what we</font>

11
00:00:31,949 --> 00:00:36,719
were<font color="#E5E5E5"> going to talk about here so what if</font>

12
00:00:34,350 --> 00:00:41,550
I detect a Wi-Fi peer-to-peer<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> not a</font>

13
00:00:36,719 --> 00:00:43,800
<font color="#CCCCCC">specification that defines an facilitate</font>

14
00:00:41,550 --> 00:00:47,839
the device to device connectivity<font color="#CCCCCC"> based</font>

15
00:00:43,800 --> 00:00:51,300
it on a<font color="#CCCCCC"> toe 2.11</font><font color="#E5E5E5"> infrastructure mode</font>

16
00:00:47,840 --> 00:00:55,980
this<font color="#E5E5E5"> this specification will release on</font>

17
00:00:51,300 --> 00:00:58,949
<font color="#CCCCCC">april 2010 and at that moment there were</font>

18
00:00:55,980 --> 00:01:02,129
no so<font color="#E5E5E5"> many devices</font><font color="#CCCCCC"> are</font><font color="#E5E5E5"> supported</font><font color="#CCCCCC"> so it</font>

19
00:00:58,949 --> 00:01:05,548
it's not<font color="#E5E5E5"> really known by most people but</font>

20
00:01:02,129 --> 00:01:07,649
nowadays<font color="#E5E5E5"> Wi-Fi Alliance that I'm going</font>

21
00:01:05,549 --> 00:01:09,600
<font color="#CCCCCC">to talk about</font><font color="#E5E5E5"> later has thirteen</font>

22
00:01:07,650 --> 00:01:12,000
thousand two hundred and eighty devices

23
00:01:09,600 --> 00:01:15,089
certified with this protocol<font color="#E5E5E5"> so a lot of</font>

24
00:01:12,000 --> 00:01:18,360
<font color="#CCCCCC">devices have support</font><font color="#E5E5E5"> for this and I'm</font>

25
00:01:15,090 --> 00:01:19,799
sure<font color="#CCCCCC"> that we</font><font color="#E5E5E5"> can find someone nearby and</font>

26
00:01:18,360 --> 00:01:21,210
who is the waffle irons

27
00:01:19,799 --> 00:01:24,479
well the Wi-Fi Alliance is an

28
00:01:21,210 --> 00:01:27,658
<font color="#E5E5E5">organization that create different Wi-Fi</font>

29
00:01:24,479 --> 00:01:30,810
protocols<font color="#E5E5E5"> and they also promote</font><font color="#CCCCCC"> the</font>

30
00:01:27,659 --> 00:01:33,619
usage<font color="#E5E5E5"> of Wi-Fi and as you may have be</font>

31
00:01:30,810 --> 00:01:35,729
similar see here we have<font color="#CCCCCC"> four different</font>

32
00:01:33,619 --> 00:01:39,540
specification that Wi-Fi<font color="#E5E5E5"> Alliance</font>

33
00:01:35,729 --> 00:01:42,150
release it<font color="#E5E5E5"> a couple</font><font color="#CCCCCC"> of years ago WPS</font>

34
00:01:39,540 --> 00:01:43,920
<font color="#E5E5E5">that most of us here on a security</font>

35
00:01:42,150 --> 00:01:48,060
conference<font color="#E5E5E5"> know that was a really bad</font>

36
00:01:43,920 --> 00:01:49,950
<font color="#CCCCCC">decision</font><font color="#E5E5E5"> and Wi-Fi display hotspot 2.0</font>

37
00:01:48,060 --> 00:01:51,720
that this is a new one that<font color="#E5E5E5"> many devices</font>

38
00:01:49,950 --> 00:01:54,810
<font color="#CCCCCC">nowadays support for</font><font color="#E5E5E5"> example Apple</font>

39
00:01:51,720 --> 00:01:57,658
devices<font color="#E5E5E5"> and then Wi-Fi direct</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> is</font>

40
00:01:54,810 --> 00:02:00,290
the one we are<font color="#E5E5E5"> going to talk today so</font>

41
00:01:57,659 --> 00:02:03,450
why why I decided<font color="#E5E5E5"> to do this research</font>

42
00:02:00,290 --> 00:02:06,710
<font color="#E5E5E5">well I usually don't need too many</font>

43
00:02:03,450 --> 00:02:10,410
<font color="#E5E5E5">reasons to look into 802 2.11</font>

44
00:02:06,710 --> 00:02:11,269
<font color="#E5E5E5">technologies because I like Wi-Fi and I</font>

45
00:02:10,410 --> 00:02:13,220
like the<font color="#E5E5E5"> idea</font>

46
00:02:11,270 --> 00:02:15,140
of<font color="#E5E5E5"> anyone being able</font><font color="#CCCCCC"> to connect to</font><font color="#E5E5E5"> a</font>

47
00:02:13,220 --> 00:02:18,620
device<font color="#E5E5E5"> or try</font><font color="#CCCCCC"> to do</font><font color="#E5E5E5"> something</font><font color="#CCCCCC"> with the</font>

48
00:02:15,140 --> 00:02:20,329
device<font color="#E5E5E5"> we'd</font><font color="#CCCCCC"> only</font><font color="#E5E5E5"> been near to the</font><font color="#CCCCCC"> device</font>

49
00:02:18,620 --> 00:02:22,730
okay we don't<font color="#E5E5E5"> need any privilege we</font>

50
00:02:20,330 --> 00:02:24,380
don't need to be<font color="#E5E5E5"> plug into a cable we</font>

51
00:02:22,730 --> 00:02:26,750
shall send some<font color="#CCCCCC"> Frenchy to the air and</font>

52
00:02:24,380 --> 00:02:30,140
someone they<font color="#CCCCCC"> are</font><font color="#E5E5E5"> going to process it but</font>

53
00:02:26,750 --> 00:02:32,480
here I put three reasons<font color="#CCCCCC"> that motivate</font>

54
00:02:30,140 --> 00:02:35,750
<font color="#E5E5E5">me to do this to do this research and is</font>

55
00:02:32,480 --> 00:02:37,850
that this protocol<font color="#E5E5E5"> extends the 802 the</font>

56
00:02:35,750 --> 00:02:39,860
tellurian<font color="#E5E5E5"> attack surface and what this</font>

57
00:02:37,850 --> 00:02:43,190
means<font color="#E5E5E5"> is</font><font color="#CCCCCC"> that if your device support</font>

58
00:02:39,860 --> 00:02:45,320
this<font color="#E5E5E5"> this protocol</font><font color="#CCCCCC"> is going to have some</font>

59
00:02:43,190 --> 00:02:47,810
support<font color="#E5E5E5"> on the finger on the kernel and</font>

60
00:02:45,320 --> 00:02:49,730
<font color="#CCCCCC">new zealand</font><font color="#E5E5E5"> applications so these</font>

61
00:02:47,810 --> 00:02:53,200
extended opportunities for attackers to

62
00:02:49,730 --> 00:02:56,329
perform some type<font color="#E5E5E5"> of attack on a device</font>

63
00:02:53,200 --> 00:02:59,959
there<font color="#CCCCCC"> are a lot of out</font><font color="#E5E5E5"> of scope</font><font color="#CCCCCC"> @ly</font>

64
00:02:56,330 --> 00:03:02,720
notes on the specification<font color="#E5E5E5"> that forces</font>

65
00:02:59,960 --> 00:03:04,430
the the<font color="#CCCCCC"> vendors</font><font color="#E5E5E5"> to implement some type</font>

66
00:03:02,720 --> 00:03:08,420
<font color="#CCCCCC">of solution that they have to implement</font>

67
00:03:04,430 --> 00:03:10,430
it as they like or as<font color="#E5E5E5"> they or the way</font>

68
00:03:08,420 --> 00:03:13,070
they find to solve to make a<font color="#E5E5E5"> solution</font>

69
00:03:10,430 --> 00:03:15,340
for<font color="#CCCCCC"> this</font><font color="#E5E5E5"> because for</font><font color="#CCCCCC"> example I want to</font>

70
00:03:13,070 --> 00:03:20,750
mention I'm gonna mention some of<font color="#E5E5E5"> them</font>

71
00:03:15,340 --> 00:03:23,810
in next<font color="#E5E5E5"> slides and then the last reason</font>

72
00:03:20,750 --> 00:03:25,430
<font color="#E5E5E5">is that we have</font><font color="#CCCCCC"> 13,000</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> 280 devices</font>

73
00:03:23,810 --> 00:03:28,730
<font color="#E5E5E5">so there are a lot</font><font color="#CCCCCC"> of devices around</font>

74
00:03:25,430 --> 00:03:31,580
<font color="#E5E5E5">that support this protocol and I'm</font>

75
00:03:28,730 --> 00:03:33,380
probably sure<font color="#E5E5E5"> that not many people know</font>

76
00:03:31,580 --> 00:03:36,050
about<font color="#E5E5E5"> this protocol and</font><font color="#CCCCCC"> in fact there a</font>

77
00:03:33,380 --> 00:03:38,329
lot of devices<font color="#CCCCCC"> that</font><font color="#E5E5E5"> have</font><font color="#CCCCCC"> build-in</font><font color="#E5E5E5"> sorry</font>

78
00:03:36,050 --> 00:03:42,290
default support for this and maybe<font color="#E5E5E5"> they</font>

79
00:03:38,330 --> 00:03:44,060
<font color="#CCCCCC">are not</font><font color="#E5E5E5"> about it so the specification</font>

80
00:03:42,290 --> 00:03:46,910
can<font color="#CCCCCC"> be divided</font><font color="#E5E5E5"> into four to four</font>

81
00:03:44,060 --> 00:03:48,890
sorry<font color="#CCCCCC"> four</font><font color="#E5E5E5"> parts we</font><font color="#CCCCCC"> have the appeal to</font>

82
00:03:46,910 --> 00:03:51,590
peer discovery the peer to peer group

83
00:03:48,890 --> 00:03:54,890
operations<font color="#E5E5E5"> power</font><font color="#CCCCCC"> management</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> managed</font>

84
00:03:51,590 --> 00:03:56,840
at peer to peer device operations I'm

85
00:03:54,890 --> 00:04:00,920
gonna specifically specifically talk

86
00:03:56,840 --> 00:04:03,260
<font color="#CCCCCC">about this first</font><font color="#E5E5E5"> -</font><font color="#CCCCCC"> the the third one is</font>

87
00:04:00,920 --> 00:04:05,179
what<font color="#E5E5E5"> not or my interest because I</font>

88
00:04:03,260 --> 00:04:07,070
thought<font color="#E5E5E5"> that</font><font color="#CCCCCC"> nothing about security can</font>

89
00:04:05,180 --> 00:04:08,930
be<font color="#E5E5E5"> related to power management I know</font>

90
00:04:07,070 --> 00:04:11,030
there are some type of attacks but<font color="#E5E5E5"> it</font>

91
00:04:08,930 --> 00:04:12,709
<font color="#CCCCCC">was not my interest and the third one</font>

92
00:04:11,030 --> 00:04:15,230
<font color="#E5E5E5">and the fourth one is really interested</font>

93
00:04:12,709 --> 00:04:18,350
<font color="#E5E5E5">but</font><font color="#CCCCCC"> I was not</font><font color="#E5E5E5"> able</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> get a device that</font>

94
00:04:15,230 --> 00:04:21,500
support this<font color="#CCCCCC"> four</font><font color="#E5E5E5"> part so I was not</font><font color="#CCCCCC"> able</font>

95
00:04:18,350 --> 00:04:25,100
<font color="#CCCCCC">to do practical attacks or</font><font color="#E5E5E5"> tests so I</font>

96
00:04:21,500 --> 00:04:26,420
didn't saw that so we're going<font color="#E5E5E5"> to</font>

97
00:04:25,100 --> 00:04:32,000
start talking about<font color="#E5E5E5"> what is</font>

98
00:04:26,420 --> 00:04:34,250
infrastructure mode so infertile mode is

99
00:04:32,000 --> 00:04:36,350
what we<font color="#CCCCCC"> usually use Wi-Fi or how we use</font>

100
00:04:34,250 --> 00:04:38,180
it<font color="#E5E5E5"> okay here in this conference we have</font>

101
00:04:36,350 --> 00:04:41,810
access<font color="#CCCCCC"> points</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> provide us access</font><font color="#E5E5E5"> to</font>

102
00:04:38,180 --> 00:04:43,640
<font color="#CCCCCC">our network and us with different</font>

103
00:04:41,810 --> 00:04:45,800
<font color="#CCCCCC">stations connect and associate to the</font>

104
00:04:43,640 --> 00:04:47,750
<font color="#E5E5E5">network and use the network that the</font>

105
00:04:45,800 --> 00:04:50,180
access<font color="#E5E5E5"> point is providing to</font><font color="#CCCCCC"> us is the</font>

106
00:04:47,750 --> 00:04:52,340
<font color="#CCCCCC">most common mode usually</font><font color="#E5E5E5"> we use this</font>

107
00:04:50,180 --> 00:04:55,100
<font color="#E5E5E5">model and we don't play with our small</font>

108
00:04:52,340 --> 00:04:57,440
but we have a<font color="#CCCCCC"> dock for</font><font color="#E5E5E5"> example a</font>

109
00:04:55,100 --> 00:04:59,780
<font color="#CCCCCC">vocational mode that let devices connect</font>

110
00:04:57,440 --> 00:05:03,380
<font color="#E5E5E5">each other</font><font color="#CCCCCC"> okay these</font><font color="#E5E5E5"> two modes are</font>

111
00:04:59,780 --> 00:05:05,840
defined on<font color="#E5E5E5"> a</font><font color="#CCCCCC"> tow 2.11 standard and this</font>

112
00:05:03,380 --> 00:05:08,300
one is<font color="#CCCCCC"> really not common to see on</font>

113
00:05:05,840 --> 00:05:10,789
<font color="#CCCCCC">devices we don't see</font><font color="#E5E5E5"> the two this this</font>

114
00:05:08,300 --> 00:05:15,050
type<font color="#CCCCCC"> of mode using</font><font color="#E5E5E5"> usage by devices</font><font color="#CCCCCC"> on</font>

115
00:05:10,790 --> 00:05:17,630
in the wild<font color="#CCCCCC"> okay so this was a good idea</font>

116
00:05:15,050 --> 00:05:21,350
<font color="#E5E5E5">to implement two devices to connect each</font>

117
00:05:17,630 --> 00:05:23,570
other but it didn't it didn't work<font color="#CCCCCC"> a</font>

118
00:05:21,350 --> 00:05:26,390
band or didn't implement it<font color="#E5E5E5"> and it's not</font>

119
00:05:23,570 --> 00:05:30,440
being<font color="#E5E5E5"> used</font><font color="#CCCCCC"> and that's where Wi-Fi direct</font>

120
00:05:26,390 --> 00:05:32,719
come into play<font color="#E5E5E5"> so</font><font color="#CCCCCC"> Wi-Fi Alliance</font><font color="#E5E5E5"> they</font>

121
00:05:30,440 --> 00:05:35,060
<font color="#E5E5E5">decided to make something similar to a</font>

122
00:05:32,720 --> 00:05:37,370
<font color="#CCCCCC">dock</font><font color="#E5E5E5"> but without an HEC and hence in a</font>

123
00:05:35,060 --> 00:05:39,770
<font color="#E5E5E5">dog but using the infrastructure mode</font>

124
00:05:37,370 --> 00:05:42,200
<font color="#E5E5E5">that I talked in the at the beginning so</font>

125
00:05:39,770 --> 00:05:44,210
how does this work is as you can<font color="#CCCCCC"> see</font>

126
00:05:42,200 --> 00:05:46,700
here this is<font color="#E5E5E5"> really similar to the first</font>

127
00:05:44,210 --> 00:05:49,039
graphic<font color="#E5E5E5"> I showed</font><font color="#CCCCCC"> that we have an access</font>

128
00:05:46,700 --> 00:05:51,200
point in this case<font color="#E5E5E5"> is</font><font color="#CCCCCC"> called peer to</font>

129
00:05:49,040 --> 00:05:53,120
peer group owner<font color="#E5E5E5"> then we have the</font>

130
00:05:51,200 --> 00:05:55,670
stations<font color="#E5E5E5"> that in this case they are</font>

131
00:05:53,120 --> 00:05:57,830
<font color="#E5E5E5">called</font><font color="#CCCCCC"> peer-to-peer clients and finally</font>

132
00:05:55,670 --> 00:06:01,460
we have a peer to peer group<font color="#CCCCCC"> that is</font><font color="#E5E5E5"> the</font>

133
00:05:57,830 --> 00:06:02,960
<font color="#E5E5E5">network itself so this is its basis as I</font>

134
00:06:01,460 --> 00:06:05,150
mentioned before this protocol<font color="#E5E5E5"> is based</font>

135
00:06:02,960 --> 00:06:07,370
on infrastructure<font color="#E5E5E5"> mode the difference</font><font color="#CCCCCC"> is</font>

136
00:06:05,150 --> 00:06:11,299
<font color="#E5E5E5">that in this case I put a printer there</font>

137
00:06:07,370 --> 00:06:14,390
but any<font color="#E5E5E5"> of the peer-to-peer clients can</font>

138
00:06:11,300 --> 00:06:17,600
take the peer to peer group old owner

139
00:06:14,390 --> 00:06:20,510
<font color="#E5E5E5">drawl</font><font color="#CCCCCC"> okay this peer to peer group owner</font>

140
00:06:17,600 --> 00:06:23,210
is sucked in like<font color="#E5E5E5"> an access point but</font>

141
00:06:20,510 --> 00:06:25,280
who is gonna be<font color="#CCCCCC"> the access point or the</font>

142
00:06:23,210 --> 00:06:28,760
peer to peer group owner is decided at

143
00:06:25,280 --> 00:06:29,750
some<font color="#E5E5E5"> moment of the negotiation of this</font>

144
00:06:28,760 --> 00:06:31,820
protocol<font color="#CCCCCC"> okay</font>

145
00:06:29,750 --> 00:06:36,140
so any<font color="#E5E5E5"> of these can</font><font color="#CCCCCC"> take an access</font>

146
00:06:31,820 --> 00:06:37,860
<font color="#E5E5E5">control so there are two key components</font>

147
00:06:36,140 --> 00:06:41,280
<font color="#CCCCCC">in this</font>

148
00:06:37,860 --> 00:06:44,120
in this<font color="#CCCCCC"> episode</font><font color="#E5E5E5"> that I think is really</font>

149
00:06:41,280 --> 00:06:47,489
important and concerns security<font color="#E5E5E5"> is that</font>

150
00:06:44,120 --> 00:06:50,190
the first one<font color="#CCCCCC"> is called</font><font color="#E5E5E5"> peer-to-peer a</font>

151
00:06:47,490 --> 00:06:52,500
concurrent device<font color="#CCCCCC"> appear</font><font color="#E5E5E5"> to be a</font>

152
00:06:50,190 --> 00:06:56,010
concurrent device can be<font color="#CCCCCC"> connected as</font><font color="#E5E5E5"> an</font>

153
00:06:52,500 --> 00:06:58,410
<font color="#CCCCCC">ax</font><font color="#E5E5E5"> station to a wireless</font><font color="#CCCCCC"> network and at</font>

154
00:06:56,010 --> 00:07:00,240
the<font color="#E5E5E5"> same time</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> PI</font><font color="#E5E5E5"> appear</font><font color="#CCCCCC"> to be a</font>

155
00:06:58,410 --> 00:07:03,150
group owner for other peer-to-peer

156
00:07:00,240 --> 00:07:05,550
devices to connect to him<font color="#E5E5E5"> so in this</font>

157
00:07:03,150 --> 00:07:08,700
case my printer<font color="#E5E5E5"> is connected wirelessly</font>

158
00:07:05,550 --> 00:07:10,320
<font color="#CCCCCC">to my network and at the same</font><font color="#E5E5E5"> time has</font>

159
00:07:08,700 --> 00:07:12,900
another computer that<font color="#CCCCCC"> is connected</font>

160
00:07:10,320 --> 00:07:15,240
directly to<font color="#E5E5E5"> the</font><font color="#CCCCCC"> printer and the other</font>

161
00:07:12,900 --> 00:07:18,090
component that<font color="#CCCCCC"> is</font><font color="#E5E5E5"> really important is no</font>

162
00:07:15,240 --> 00:07:20,400
known as cross connection<font color="#E5E5E5"> and what is</font>

163
00:07:18,090 --> 00:07:22,950
<font color="#E5E5E5">close connection is if you're a peer to</font>

164
00:07:20,400 --> 00:07:25,289
peer group owner<font color="#E5E5E5"> have support for cross</font>

165
00:07:22,950 --> 00:07:27,870
connection it can<font color="#CCCCCC"> let peer to peer</font>

166
00:07:25,290 --> 00:07:30,540
<font color="#CCCCCC">clients to talk and communicate directly</font>

167
00:07:27,870 --> 00:07:33,390
<font color="#CCCCCC">to peer to peer to stations and I am the</font>

168
00:07:30,540 --> 00:07:35,700
access point itself so you<font color="#E5E5E5"> can use the</font>

169
00:07:33,390 --> 00:07:38,340
printer as a bridge<font color="#E5E5E5"> to connect to the</font>

170
00:07:35,700 --> 00:07:40,979
<font color="#E5E5E5">devices the to the printer</font><font color="#CCCCCC"> - sorry - a</font>

171
00:07:38,340 --> 00:07:42,869
network<font color="#CCCCCC"> the printer is using so these</font>

172
00:07:40,980 --> 00:07:45,690
two components<font color="#CCCCCC"> are really</font><font color="#E5E5E5"> important to</font>

173
00:07:42,870 --> 00:07:47,790
<font color="#E5E5E5">take note</font><font color="#CCCCCC"> because we are going to talk</font>

174
00:07:45,690 --> 00:07:50,550
later<font color="#CCCCCC"> there are some</font><font color="#E5E5E5"> devices</font><font color="#CCCCCC"> they don't</font>

175
00:07:47,790 --> 00:07:53,580
have a<font color="#E5E5E5"> really good implementation and</font>

176
00:07:50,550 --> 00:07:56,640
then because in the specification again

177
00:07:53,580 --> 00:07:58,919
they say that cross how cross connection

178
00:07:56,640 --> 00:08:01,409
is implemented<font color="#CCCCCC"> is out of the</font><font color="#E5E5E5"> scope of</font>

179
00:07:58,920 --> 00:08:04,190
<font color="#E5E5E5">the specification</font><font color="#CCCCCC"> this type of things</font>

180
00:08:01,410 --> 00:08:07,770
can<font color="#E5E5E5"> happen if the</font><font color="#CCCCCC"> vendor doesn't</font><font color="#E5E5E5"> take a</font>

181
00:08:04,190 --> 00:08:10,650
really good<font color="#CCCCCC"> choice</font><font color="#E5E5E5"> or a really good</font>

182
00:08:07,770 --> 00:08:13,200
approach<font color="#E5E5E5"> to make a solution for this the</font>

183
00:08:10,650 --> 00:08:15,419
printers nowadays a qualify wire they

184
00:08:13,200 --> 00:08:17,219
<font color="#E5E5E5">have lot of supports</font><font color="#CCCCCC"> in this case a</font>

185
00:08:15,420 --> 00:08:19,050
printer can be connected<font color="#CCCCCC"> through a wire</font>

186
00:08:17,220 --> 00:08:22,020
and you can say<font color="#E5E5E5"> that if you're not</font><font color="#CCCCCC"> using</font>

187
00:08:19,050 --> 00:08:23,820
<font color="#E5E5E5">Wi-Fi</font><font color="#CCCCCC"> you don't care because your your</font>

188
00:08:22,020 --> 00:08:27,359
network is<font color="#CCCCCC"> wire</font><font color="#E5E5E5"> so you are not in</font><font color="#CCCCCC"> danger</font>

189
00:08:23,820 --> 00:08:29,130
<font color="#E5E5E5">but</font><font color="#CCCCCC"> maybe if your printer supports peer</font>

190
00:08:27,360 --> 00:08:30,960
<font color="#CCCCCC">to peer</font><font color="#E5E5E5"> and someone is</font><font color="#CCCCCC"> able</font><font color="#E5E5E5"> to connect</font>

191
00:08:29,130 --> 00:08:31,560
to<font color="#E5E5E5"> your printer and support cross</font>

192
00:08:30,960 --> 00:08:35,159
connection

193
00:08:31,560 --> 00:08:37,260
you couldn't end up being able by<font color="#E5E5E5"> the</font>

194
00:08:35,159 --> 00:08:40,140
attacker could be able<font color="#CCCCCC"> to connect</font><font color="#E5E5E5"> and</font>

195
00:08:37,260 --> 00:08:44,069
use your wire network<font color="#E5E5E5"> so</font><font color="#CCCCCC"> this these</font><font color="#E5E5E5"> two</font>

196
00:08:40,140 --> 00:08:45,390
components are really<font color="#E5E5E5"> important so now</font>

197
00:08:44,070 --> 00:08:48,920
I'm going<font color="#E5E5E5"> to start</font><font color="#CCCCCC"> talking</font><font color="#E5E5E5"> about the</font>

198
00:08:45,390 --> 00:08:48,920
discovery<font color="#CCCCCC"> okay</font>

199
00:08:49,180 --> 00:08:53,829
the discovery process to<font color="#E5E5E5"> start talking</font>

200
00:08:52,060 --> 00:08:55,510
<font color="#E5E5E5">about</font><font color="#CCCCCC"> peer-to-peer</font><font color="#E5E5E5"> discovery first I</font>

201
00:08:53,830 --> 00:08:59,589
have<font color="#E5E5E5"> to explain a little bit about how</font>

202
00:08:55,510 --> 00:09:03,040
802<font color="#E5E5E5"> 11 discovery works this is quite</font>

203
00:08:59,589 --> 00:09:04,270
easy<font color="#CCCCCC"> many people maybe know this but I</font>

204
00:09:03,040 --> 00:09:06,400
have<font color="#CCCCCC"> to</font><font color="#E5E5E5"> splain it to understand the</font>

205
00:09:04,270 --> 00:09:08,560
<font color="#CCCCCC">following but you have an access point</font>

206
00:09:06,400 --> 00:09:10,750
<font color="#E5E5E5">and the exit point is sending beacon</font>

207
00:09:08,560 --> 00:09:13,119
frames transmitting<font color="#E5E5E5"> beacon frames to</font><font color="#CCCCCC"> the</font>

208
00:09:10,750 --> 00:09:15,460
air and<font color="#E5E5E5"> the</font><font color="#CCCCCC"> stations can process</font><font color="#E5E5E5"> this</font>

209
00:09:13,120 --> 00:09:19,089
<font color="#E5E5E5">beacon frames and identify and found</font>

210
00:09:15,460 --> 00:09:21,460
<font color="#E5E5E5">final</font><font color="#CCCCCC"> network</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> is the</font><font color="#E5E5E5"> main method</font>

211
00:09:19,089 --> 00:09:23,589
call<font color="#CCCCCC"> a passive scanning okay</font>

212
00:09:21,460 --> 00:09:26,250
without<font color="#E5E5E5"> the station being a</font><font color="#CCCCCC"> transmute in</font>

213
00:09:23,589 --> 00:09:28,360
any frame<font color="#CCCCCC"> the station can detect</font>

214
00:09:26,250 --> 00:09:30,250
<font color="#CCCCCC">different beacon frames from</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> river</font>

215
00:09:28,360 --> 00:09:32,560
<font color="#E5E5E5">different access point that are here for</font>

216
00:09:30,250 --> 00:09:35,820
example<font color="#CCCCCC"> and identify all the options</font>

217
00:09:32,560 --> 00:09:35,819
<font color="#CCCCCC">that they have to connect or network</font>

218
00:09:35,910 --> 00:09:41,319
then we have the active scanning<font color="#E5E5E5"> okay</font>

219
00:09:38,860 --> 00:09:44,320
<font color="#CCCCCC">that beam scanning</font><font color="#E5E5E5"> the station sent</font>

220
00:09:41,320 --> 00:09:46,029
<font color="#CCCCCC">proof</font><font color="#E5E5E5"> request frames to axon and</font><font color="#CCCCCC"> a</font>

221
00:09:44,320 --> 00:09:48,070
specific<font color="#E5E5E5"> access point or they can send</font>

222
00:09:46,029 --> 00:09:51,460
<font color="#E5E5E5">broadcast access probe request frames</font>

223
00:09:48,070 --> 00:09:53,500
and then<font color="#E5E5E5"> the excess fondant respond this</font>

224
00:09:51,460 --> 00:09:55,330
<font color="#E5E5E5">frame or once they process the prayer</font>

225
00:09:53,500 --> 00:09:57,490
request they will<font color="#CCCCCC"> send up respond frame</font>

226
00:09:55,330 --> 00:10:00,010
to a station with<font color="#E5E5E5"> all the information</font><font color="#CCCCCC"> of</font>

227
00:09:57,490 --> 00:10:01,420
<font color="#E5E5E5">the network</font><font color="#CCCCCC"> so the</font><font color="#E5E5E5"> client can decide if</font>

228
00:10:00,010 --> 00:10:04,420
they<font color="#CCCCCC"> want to connect or not to</font><font color="#E5E5E5"> add</font>

229
00:10:01,420 --> 00:10:06,279
<font color="#E5E5E5">network in both cases the network</font>

230
00:10:04,420 --> 00:10:08,529
interface is sweeping<font color="#E5E5E5"> through all the</font>

231
00:10:06,279 --> 00:10:14,310
channels<font color="#CCCCCC"> the card support to find all</font>

232
00:10:08,529 --> 00:10:17,020
the access points<font color="#CCCCCC"> they can connect to a</font>

233
00:10:14,310 --> 00:10:19,779
Wi-Fi sorry

234
00:10:17,020 --> 00:10:22,000
Wi-Fi direct specification and the peer

235
00:10:19,779 --> 00:10:23,800
to peer group owner<font color="#E5E5E5"> remember I mentioned</font>

236
00:10:22,000 --> 00:10:25,570
that<font color="#E5E5E5"> appear</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> be a group owner is</font>

237
00:10:23,800 --> 00:10:28,569
almost as the same as an access point

238
00:10:25,570 --> 00:10:30,820
well the access point<font color="#CCCCCC"> usually use the</font>

239
00:10:28,570 --> 00:10:33,850
beacon frame<font color="#E5E5E5"> to announce a network</font><font color="#CCCCCC"> well</font>

240
00:10:30,820 --> 00:10:36,640
<font color="#CCCCCC">the appeal to</font><font color="#E5E5E5"> group owner is gonna</font><font color="#CCCCCC"> also</font>

241
00:10:33,850 --> 00:10:40,060
use the beacon frame<font color="#E5E5E5"> to to announce the</font>

242
00:10:36,640 --> 00:10:42,069
network so this<font color="#E5E5E5"> is station</font><font color="#CCCCCC"> that here it</font>

243
00:10:40,060 --> 00:10:44,109
<font color="#E5E5E5">doesn't say a peer-to-peer device with a</font>

244
00:10:42,070 --> 00:10:46,690
normal station<font color="#CCCCCC"> just like any machine you</font>

245
00:10:44,110 --> 00:10:48,940
can have here is<font color="#CCCCCC"> gonna be able</font><font color="#E5E5E5"> to find</font>

246
00:10:46,690 --> 00:10:51,790
<font color="#E5E5E5">the peer to peer group owner because</font>

247
00:10:48,940 --> 00:10:54,310
it's the same<font color="#E5E5E5"> as</font><font color="#CCCCCC"> an access point so if</font>

248
00:10:51,790 --> 00:10:57,579
you sometimes<font color="#E5E5E5"> so a network does it says</font>

249
00:10:54,310 --> 00:10:59,560
direct - something that is<font color="#E5E5E5"> appear to be</font>

250
00:10:57,579 --> 00:11:01,839
a group owner<font color="#E5E5E5"> so if you have ever seen</font>

251
00:10:59,560 --> 00:11:03,069
<font color="#CCCCCC">that you already have a some contact</font>

252
00:11:01,839 --> 00:11:06,850
with<font color="#CCCCCC"> peer-to-peer</font><font color="#E5E5E5"> device</font>

253
00:11:03,070 --> 00:11:08,529
and the Wi-Fi<font color="#CCCCCC"> direct</font><font color="#E5E5E5"> specification but</font>

254
00:11:06,850 --> 00:11:10,630
there are<font color="#CCCCCC"> devices that</font><font color="#E5E5E5"> they are not</font>

255
00:11:08,529 --> 00:11:12,160
being<font color="#CCCCCC"> a peer to peer group owner</font>

256
00:11:10,630 --> 00:11:15,160
remember that peer to peer group owners

257
00:11:12,160 --> 00:11:18,459
<font color="#E5E5E5">is the access point of Wi-Fi direct well</font>

258
00:11:15,160 --> 00:11:20,079
are they some devices<font color="#E5E5E5"> they don't have to</font>

259
00:11:18,459 --> 00:11:22,149
be on a<font color="#E5E5E5"> peer-to-peer</font><font color="#CCCCCC"> group owner they</font>

260
00:11:20,079 --> 00:11:26,439
want to negotiate<font color="#E5E5E5"> who is gonna be the</font>

261
00:11:22,149 --> 00:11:29,019
the<font color="#CCCCCC"> group owner so there are devices</font>

262
00:11:26,440 --> 00:11:32,649
<font color="#E5E5E5">that they are on different states we</font>

263
00:11:29,019 --> 00:11:34,720
have<font color="#E5E5E5"> listened state and search</font><font color="#CCCCCC"> state so</font>

264
00:11:32,649 --> 00:11:37,149
here<font color="#CCCCCC"> you have</font><font color="#E5E5E5"> two peer-to-peer devices</font>

265
00:11:34,720 --> 00:11:39,399
and one peer-to-peer device will send<font color="#CCCCCC"> a</font>

266
00:11:37,149 --> 00:11:40,779
probe request frame the<font color="#CCCCCC"> bill to</font><font color="#E5E5E5"> be</font>

267
00:11:39,399 --> 00:11:44,250
otherwise is going to process the frame

268
00:11:40,779 --> 00:11:47,380
that<font color="#E5E5E5"> has to have certain specific</font>

269
00:11:44,250 --> 00:11:52,029
<font color="#E5E5E5">characteristics to work and then if this</font>

270
00:11:47,380 --> 00:11:55,029
frame is a piece<font color="#CCCCCC"> off I</font><font color="#E5E5E5"> did</font><font color="#CCCCCC"> add a Wi-Fi</font>

271
00:11:52,029 --> 00:11:56,620
direct search<font color="#E5E5E5"> or scan then the</font>

272
00:11:55,029 --> 00:12:00,100
peer-to-peer device is<font color="#CCCCCC"> going to send a</font>

273
00:11:56,620 --> 00:12:02,170
<font color="#E5E5E5">report response frame the only thing</font>

274
00:12:00,100 --> 00:12:04,209
here<font color="#CCCCCC"> that is a little difficult to</font>

275
00:12:02,170 --> 00:12:06,370
understand is that both devices are

276
00:12:04,209 --> 00:12:09,010
sweeping<font color="#E5E5E5"> the channels at</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> same time</font>

277
00:12:06,370 --> 00:12:12,850
so sometimes<font color="#E5E5E5"> it</font><font color="#CCCCCC"> take a little more</font><font color="#E5E5E5"> time</font>

278
00:12:09,010 --> 00:12:14,829
<font color="#CCCCCC">to discover a device because</font><font color="#E5E5E5"> usually a</font>

279
00:12:12,850 --> 00:12:17,500
access points they are<font color="#CCCCCC"> fix it on a</font>

280
00:12:14,829 --> 00:12:18,939
channel<font color="#CCCCCC"> they don't</font><font color="#E5E5E5"> sweep so in this case</font>

281
00:12:17,500 --> 00:12:22,839
they are<font color="#CCCCCC"> gonna have shipping channels</font>

282
00:12:18,940 --> 00:12:24,970
and they try to find<font color="#E5E5E5"> each other so at</font>

283
00:12:22,839 --> 00:12:26,440
one moment<font color="#CCCCCC"> one device is on a listen</font>

284
00:12:24,970 --> 00:12:29,199
state<font color="#E5E5E5"> and</font><font color="#CCCCCC"> it's waiting</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> proof</font>

285
00:12:26,440 --> 00:12:31,690
<font color="#CCCCCC">requests</font><font color="#E5E5E5"> and then it switches</font><font color="#CCCCCC"> to an</font>

286
00:12:29,199 --> 00:12:34,269
active<font color="#E5E5E5"> a state to a search state and it</font>

287
00:12:31,690 --> 00:12:36,040
will send probe request frames so he can

288
00:12:34,269 --> 00:12:38,980
announce he is there<font color="#CCCCCC"> to</font><font color="#E5E5E5"> other</font>

289
00:12:36,040 --> 00:12:40,839
peer-to-peer devices so it's important

290
00:12:38,980 --> 00:12:43,240
to understand that to do this we have<font color="#CCCCCC"> to</font>

291
00:12:40,839 --> 00:12:45,250
do active<font color="#E5E5E5"> scanning so passive scanning</font>

292
00:12:43,240 --> 00:12:49,510
tools are not going to work for for many

293
00:12:45,250 --> 00:12:51,639
peer-to-peer devices so here is a<font color="#E5E5E5"> probe</font>

294
00:12:49,510 --> 00:12:53,410
request frame<font color="#E5E5E5"> we can see here that</font><font color="#CCCCCC"> it's</font>

295
00:12:51,639 --> 00:12:56,079
<font color="#CCCCCC">a broadcast it does it cast a</font>

296
00:12:53,410 --> 00:12:59,920
destination<font color="#E5E5E5"> address broadcast an SSID</font>

297
00:12:56,079 --> 00:13:01,930
broadcast<font color="#E5E5E5"> and we have here the SSID</font><font color="#CCCCCC"> that</font>

298
00:12:59,920 --> 00:13:05,459
casts a white card<font color="#CCCCCC"> this worker is the</font>

299
00:13:01,930 --> 00:13:07,989
Wi-Fi<font color="#CCCCCC"> direct worker and here we come</font>

300
00:13:05,459 --> 00:13:09,880
weps<font color="#E5E5E5"> and peer-to-peer information</font>

301
00:13:07,990 --> 00:13:12,069
elements information elements<font color="#CCCCCC"> are</font>

302
00:13:09,880 --> 00:13:16,420
containers<font color="#CCCCCC"> that go inside</font><font color="#E5E5E5"> management</font>

303
00:13:12,069 --> 00:13:18,760
frames on<font color="#E5E5E5"> 802 dot 11 frames and</font>

304
00:13:16,420 --> 00:13:21,819
the information in this<font color="#E5E5E5"> case these two</font>

305
00:13:18,760 --> 00:13:23,950
<font color="#CCCCCC">information elements and the SSID</font><font color="#E5E5E5"> are</font>

306
00:13:21,820 --> 00:13:26,680
the characteristics peer-to-peer the

307
00:13:23,950 --> 00:13:31,360
devices require to be able<font color="#CCCCCC"> to find each</font>

308
00:13:26,680 --> 00:13:33,790
<font color="#E5E5E5">other once the device that is</font><font color="#CCCCCC"> listening</font>

309
00:13:31,360 --> 00:13:36,550
receive this<font color="#CCCCCC"> beacon</font><font color="#E5E5E5"> for a request frame</font>

310
00:13:33,790 --> 00:13:38,980
it will it will send this prove response

311
00:13:36,550 --> 00:13:41,500
frame this<font color="#E5E5E5"> proposed frame is directed</font>

312
00:13:38,980 --> 00:13:44,500
only<font color="#E5E5E5"> to the they want the the appeal</font>

313
00:13:41,500 --> 00:13:47,500
device that is searching and it will

314
00:13:44,500 --> 00:13:49,990
<font color="#CCCCCC">cover the SSID</font><font color="#E5E5E5"> the discussed the</font>

315
00:13:47,500 --> 00:13:52,269
peer-to-peer<font color="#CCCCCC"> Weicker the WPS and</font>

316
00:13:49,990 --> 00:13:54,670
peer-to-peer<font color="#E5E5E5"> information element and I</font>

317
00:13:52,269 --> 00:13:58,000
was only putting<font color="#E5E5E5"> this here just to</font><font color="#CCCCCC"> show</font>

318
00:13:54,670 --> 00:13:59,529
that<font color="#E5E5E5"> one of the it costs a lot of</font>

319
00:13:58,000 --> 00:14:02,199
different information inside information

320
00:13:59,529 --> 00:14:04,510
element but<font color="#CCCCCC"> the peer-to-peer at one part</font>

321
00:14:02,199 --> 00:14:07,180
the<font color="#CCCCCC"> casa device name this is</font><font color="#E5E5E5"> the device</font>

322
00:14:04,510 --> 00:14:09,760
name that will indentify<font color="#CCCCCC"> this this</font>

323
00:14:07,180 --> 00:14:12,279
device<font color="#E5E5E5"> there is also a note in the</font>

324
00:14:09,760 --> 00:14:14,199
specification<font color="#CCCCCC"> if someone else</font><font color="#E5E5E5"> is someone</font>

325
00:14:12,279 --> 00:14:16,420
after the talk<font color="#E5E5E5"> wants to talk about the</font>

326
00:14:14,199 --> 00:14:18,310
specification I have a copy<font color="#CCCCCC"> here my</font><font color="#E5E5E5"> mug</font>

327
00:14:16,420 --> 00:14:20,410
so<font color="#E5E5E5"> we I can show you there are lot of</font>

328
00:14:18,310 --> 00:14:23,319
<font color="#E5E5E5">things</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> they are out of the</font><font color="#CCCCCC"> coppa</font>

329
00:14:20,410 --> 00:14:27,130
specification for example<font color="#CCCCCC"> appear to be a</font>

330
00:14:23,320 --> 00:14:29,050
device<font color="#E5E5E5"> name are not unique</font><font color="#CCCCCC"> so if you</font>

331
00:14:27,130 --> 00:14:30,699
come<font color="#E5E5E5"> to TVs that</font><font color="#CCCCCC"> have the</font><font color="#E5E5E5"> same name</font>

332
00:14:29,050 --> 00:14:33,339
you are not<font color="#CCCCCC"> going to</font><font color="#E5E5E5"> be able to</font><font color="#CCCCCC"> identify</font>

333
00:14:30,699 --> 00:14:35,019
<font color="#CCCCCC">what TV you you you want</font><font color="#E5E5E5"> to connect so</font>

334
00:14:33,339 --> 00:14:36,910
in the specification it says that<font color="#E5E5E5"> maybe</font>

335
00:14:35,019 --> 00:14:38,699
you should try several<font color="#E5E5E5"> times to connect</font>

336
00:14:36,910 --> 00:14:41,110
<font color="#E5E5E5">to device until you find what you want</font>

337
00:14:38,699 --> 00:14:43,719
this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> a specification of a protocol</font>

338
00:14:41,110 --> 00:14:48,670
<font color="#E5E5E5">not not someone trying to cook something</font>

339
00:14:43,720 --> 00:14:53,620
<font color="#E5E5E5">and</font><font color="#CCCCCC"> then we have the service discovery</font>

340
00:14:48,670 --> 00:14:56,319
<font color="#CCCCCC">okay that</font><font color="#E5E5E5"> is another</font><font color="#CCCCCC"> functionality that</font>

341
00:14:53,620 --> 00:14:58,870
peer-to-peer device has that is<font color="#CCCCCC"> able to</font>

342
00:14:56,320 --> 00:15:00,069
discover<font color="#E5E5E5"> for a specific service let's</font>

343
00:14:58,870 --> 00:15:01,839
say I want to<font color="#E5E5E5"> find out a peer-to-peer</font>

344
00:15:00,069 --> 00:15:04,029
device that has printing functionality

345
00:15:01,839 --> 00:15:07,209
<font color="#E5E5E5">because</font><font color="#CCCCCC"> I want to</font><font color="#E5E5E5"> put in something so</font>

346
00:15:04,029 --> 00:15:09,490
you<font color="#E5E5E5"> can send some in</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> case they are</font>

347
00:15:07,209 --> 00:15:11,890
<font color="#CCCCCC">action frames</font><font color="#E5E5E5"> they are</font><font color="#CCCCCC"> also management</font>

348
00:15:09,490 --> 00:15:14,889
<font color="#E5E5E5">frames you can</font><font color="#CCCCCC"> say</font><font color="#E5E5E5"> as send a service</font>

349
00:15:11,890 --> 00:15:17,110
discovery query frame to a specific p2p

350
00:15:14,889 --> 00:15:19,959
device and<font color="#CCCCCC"> his</font><font color="#E5E5E5"> gonna reply with a</font>

351
00:15:17,110 --> 00:15:22,269
service discovery response frame<font color="#E5E5E5"> the</font>

352
00:15:19,959 --> 00:15:24,550
<font color="#CCCCCC">interesting</font><font color="#E5E5E5"> thing here is these frames</font>

353
00:15:22,269 --> 00:15:26,649
<font color="#CCCCCC">are not</font><font color="#E5E5E5"> encrypted</font><font color="#CCCCCC"> because they are</font>

354
00:15:24,550 --> 00:15:28,689
<font color="#E5E5E5">management frames</font><font color="#CCCCCC"> and we are not even</font>

355
00:15:26,649 --> 00:15:29,830
<font color="#CCCCCC">associated or authenticated to</font><font color="#E5E5E5"> the</font>

356
00:15:28,690 --> 00:15:32,560
device because we are

357
00:15:29,830 --> 00:15:35,769
talking about<font color="#E5E5E5"> discovery discovery part</font>

358
00:15:32,560 --> 00:15:38,109
<font color="#CCCCCC">okay so</font><font color="#E5E5E5"> all this is unencrypted and</font>

359
00:15:35,769 --> 00:15:42,610
cannot be encrypted<font color="#CCCCCC"> and</font><font color="#E5E5E5"> the funny</font><font color="#CCCCCC"> thing</font>

360
00:15:38,110 --> 00:15:45,550
here is that<font color="#E5E5E5"> the</font><font color="#CCCCCC"> content of this of the</font>

361
00:15:42,610 --> 00:15:47,680
suction<font color="#E5E5E5"> frames is usually a part of</font>

362
00:15:45,550 --> 00:15:50,430
<font color="#E5E5E5">another protocol so these</font><font color="#CCCCCC"> suction</font><font color="#E5E5E5"> frames</font>

363
00:15:47,680 --> 00:15:53,949
use<font color="#E5E5E5"> OPM P whenever</font><font color="#CCCCCC"> some plug-and-play</font>

364
00:15:50,430 --> 00:15:57,550
<font color="#CCCCCC">Bonjour printer</font><font color="#E5E5E5"> services and different</font>

365
00:15:53,950 --> 00:16:00,279
<font color="#E5E5E5">protocols die they have content inside</font>

366
00:15:57,550 --> 00:16:03,160
<font color="#E5E5E5">these frames so we can know what type of</font>

367
00:16:00,279 --> 00:16:05,829
service someone is looking<font color="#E5E5E5"> okay now if</font>

368
00:16:03,160 --> 00:16:08,140
we know that<font color="#E5E5E5"> we can also say okay hi I'm</font>

369
00:16:05,829 --> 00:16:10,930
a printer connect to me so you can try

370
00:16:08,140 --> 00:16:14,439
to impersonate<font color="#E5E5E5"> otherwise but not not</font>

371
00:16:10,930 --> 00:16:16,870
<font color="#CCCCCC">also that these these depending on the</font>

372
00:16:14,440 --> 00:16:20,529
implementation<font color="#E5E5E5"> of these of</font><font color="#CCCCCC"> these service</font>

373
00:16:16,870 --> 00:16:22,329
discovery these frames can<font color="#CCCCCC"> be grabbed</font>

374
00:16:20,529 --> 00:16:25,689
from here<font color="#E5E5E5"> like this portion of the frame</font>

375
00:16:22,329 --> 00:16:28,689
can<font color="#CCCCCC"> be taken and the device is gonna</font>

376
00:16:25,690 --> 00:16:31,329
<font color="#E5E5E5">insert an ipv6 frame inside the device</font>

377
00:16:28,690 --> 00:16:33,850
<font color="#E5E5E5">okay inside like if someone is connected</font>

378
00:16:31,329 --> 00:16:36,370
<font color="#CCCCCC">to him and it</font><font color="#E5E5E5"> will insert the the</font>

379
00:16:33,850 --> 00:16:38,829
<font color="#CCCCCC">protocol that</font><font color="#E5E5E5"> he identified</font><font color="#CCCCCC"> there so</font>

380
00:16:36,370 --> 00:16:40,750
<font color="#CCCCCC">depending</font><font color="#E5E5E5"> on implementation this could</font>

381
00:16:38,829 --> 00:16:43,029
be<font color="#E5E5E5"> quite dangerous</font><font color="#CCCCCC"> because</font><font color="#E5E5E5"> we are a cop</font>

382
00:16:40,750 --> 00:16:45,220
sound like permeability between the

383
00:16:43,029 --> 00:16:46,959
network that is authenticated<font color="#E5E5E5"> and</font>

384
00:16:45,220 --> 00:16:50,200
otherwise<font color="#CCCCCC"> that is not</font><font color="#E5E5E5"> that indicated</font>

385
00:16:46,959 --> 00:16:54,430
<font color="#E5E5E5">that could be even able to inject some</font>

386
00:16:50,200 --> 00:16:57,070
type of frames inside the network so<font color="#E5E5E5"> I</font>

387
00:16:54,430 --> 00:17:00,310
like<font color="#E5E5E5"> to talk</font><font color="#CCCCCC"> about theory but it's fun</font>

388
00:16:57,070 --> 00:17:03,970
<font color="#E5E5E5">oh it's better to talk about practical</font>

389
00:17:00,310 --> 00:17:06,399
<font color="#CCCCCC">things</font><font color="#E5E5E5"> or yes practic so I'm going to</font>

390
00:17:03,970 --> 00:17:09,669
<font color="#E5E5E5">talk about how you can do all</font><font color="#CCCCCC"> the things</font>

391
00:17:06,400 --> 00:17:11,980
that<font color="#CCCCCC"> they are quite easy the first thing</font>

392
00:17:09,669 --> 00:17:13,809
is if you know about<font color="#CCCCCC"> a</font><font color="#E5E5E5"> network cards</font>

393
00:17:11,980 --> 00:17:15,730
<font color="#E5E5E5">wireless</font><font color="#CCCCCC"> network card</font><font color="#E5E5E5"> you should</font><font color="#CCCCCC"> know</font>

394
00:17:13,809 --> 00:17:18,550
this card is<font color="#E5E5E5"> really cheap and it works</font>

395
00:17:15,730 --> 00:17:20,020
really really<font color="#E5E5E5"> good and it could be used</font>

396
00:17:18,550 --> 00:17:24,819
to<font color="#E5E5E5"> play around with Wi-Fi direct</font>

397
00:17:20,020 --> 00:17:27,040
<font color="#E5E5E5">protocol so if you don't have that car</font>

398
00:17:24,819 --> 00:17:28,329
<font color="#E5E5E5">and you want to know if you can again do</font>

399
00:17:27,040 --> 00:17:30,190
things with Wi-Fi direct

400
00:17:28,329 --> 00:17:31,899
you should run this<font color="#E5E5E5"> common on a Linux</font>

401
00:17:30,190 --> 00:17:34,990
<font color="#CCCCCC">machine</font><font color="#E5E5E5"> and I will show a lot</font><font color="#CCCCCC"> of</font>

402
00:17:31,900 --> 00:17:37,210
information<font color="#CCCCCC"> of your interface</font><font color="#E5E5E5"> and if the</font>

403
00:17:34,990 --> 00:17:38,860
supporting interface mode has

404
00:17:37,210 --> 00:17:41,440
peer-to-peer client and peer to<font color="#CCCCCC"> peer</font>

405
00:17:38,860 --> 00:17:45,090
<font color="#E5E5E5">group owner you're going to be able to</font>

406
00:17:41,440 --> 00:17:45,090
<font color="#E5E5E5">do Wi-Fi direct</font>

407
00:17:45,240 --> 00:17:50,920
let's but how how you can interact with

408
00:17:48,310 --> 00:17:53,169
<font color="#E5E5E5">this protocol well in Linux machines</font><font color="#CCCCCC"> you</font>

409
00:17:50,920 --> 00:17:56,400
should use you<font color="#E5E5E5"> should use WEP a</font>

410
00:17:53,170 --> 00:17:59,080
supplicant<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> it more distribution</font>

411
00:17:56,400 --> 00:18:01,780
<font color="#E5E5E5">this has no building a peer-to-peer</font>

412
00:17:59,080 --> 00:18:03,399
support or Wi-Fi direct support they

413
00:18:01,780 --> 00:18:04,990
don't have it building<font color="#CCCCCC"> so you should</font>

414
00:18:03,400 --> 00:18:07,030
download<font color="#E5E5E5"> the source code</font><font color="#CCCCCC"> and build it</font>

415
00:18:04,990 --> 00:18:09,430
yourself<font color="#CCCCCC"> it's quite</font><font color="#E5E5E5"> easy</font><font color="#CCCCCC"> you should read</font>

416
00:18:07,030 --> 00:18:11,710
the documentation<font color="#E5E5E5"> it's really easy you</font>

417
00:18:09,430 --> 00:18:13,360
<font color="#CCCCCC">don't</font><font color="#E5E5E5"> need too much stuff</font><font color="#CCCCCC"> to do it once</font>

418
00:18:11,710 --> 00:18:15,970
<font color="#E5E5E5">you do that you have</font><font color="#CCCCCC"> to build a</font>

419
00:18:13,360 --> 00:18:18,219
peer-to-peer configuration<font color="#E5E5E5"> that is again</font>

420
00:18:15,970 --> 00:18:20,260
really quick and<font color="#E5E5E5"> really</font><font color="#CCCCCC"> easy I</font><font color="#E5E5E5"> will show</font>

421
00:18:18,220 --> 00:18:22,240
the end of the conference<font color="#CCCCCC"> I'm releasing</font>

422
00:18:20,260 --> 00:18:25,750
<font color="#E5E5E5">some tools and some examples you can</font>

423
00:18:22,240 --> 00:18:28,450
look<font color="#CCCCCC"> on in there and here I'm running</font><font color="#E5E5E5"> on</font>

424
00:18:25,750 --> 00:18:30,460
<font color="#E5E5E5">peer and repeat client that is a client</font>

425
00:18:28,450 --> 00:18:33,040
<font color="#CCCCCC">that connect to</font><font color="#E5E5E5"> a supplicant I'm running</font>

426
00:18:30,460 --> 00:18:35,140
<font color="#CCCCCC">peer-to-peer</font><font color="#E5E5E5"> find that will perform the</font>

427
00:18:33,040 --> 00:18:37,840
discovery I mentioned before<font color="#E5E5E5"> and I give</font>

428
00:18:35,140 --> 00:18:40,300
up five seconds timeout<font color="#E5E5E5"> as you can see</font>

429
00:18:37,840 --> 00:18:43,810
here I found<font color="#E5E5E5"> at least I find three</font>

430
00:18:40,300 --> 00:18:46,990
<font color="#E5E5E5">devices</font><font color="#CCCCCC"> two printers and one one Samsung</font>

431
00:18:43,810 --> 00:18:49,270
<font color="#E5E5E5">Smart TV you can use also Android</font>

432
00:18:46,990 --> 00:18:53,050
Android<font color="#E5E5E5"> cast Wi-Fi direct support from</font>

433
00:18:49,270 --> 00:18:54,970
Android<font color="#CCCCCC"> 4 so you can go to your Wi-Fi</font>

434
00:18:53,050 --> 00:18:57,129
advanced configuration and you<font color="#E5E5E5"> can use</font>

435
00:18:54,970 --> 00:18:59,080
<font color="#E5E5E5">Wi-Fi direct from there it's quite easy</font>

436
00:18:57,130 --> 00:19:01,140
<font color="#E5E5E5">and you can connect to a printer with</font>

437
00:18:59,080 --> 00:19:03,610
your phone<font color="#E5E5E5"> and use all the printers</font>

438
00:19:01,140 --> 00:19:05,950
services it's it's<font color="#E5E5E5"> really easy</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> use</font>

439
00:19:03,610 --> 00:19:07,899
<font color="#E5E5E5">but</font><font color="#CCCCCC"> you have a lot</font><font color="#E5E5E5"> of limitations unless</font>

440
00:19:05,950 --> 00:19:09,840
you start playing<font color="#CCCCCC"> with the Android UI P</font>

441
00:19:07,900 --> 00:19:13,300
so<font color="#E5E5E5"> you can you can do something about</font>

442
00:19:09,840 --> 00:19:15,370
<font color="#E5E5E5">and then the last thing I want to</font>

443
00:19:13,300 --> 00:19:18,460
<font color="#CCCCCC">mention is</font><font color="#E5E5E5"> if you use tools</font><font color="#CCCCCC"> like kismet</font>

444
00:19:15,370 --> 00:19:20,770
<font color="#E5E5E5">or use tools as</font><font color="#CCCCCC"> error dump you're going</font>

445
00:19:18,460 --> 00:19:22,390
to be able<font color="#CCCCCC"> to see these devices as I</font>

446
00:19:20,770 --> 00:19:24,760
mentioned<font color="#CCCCCC"> before these are peer to peer</font>

447
00:19:22,390 --> 00:19:26,290
group owners so peer to peer group

448
00:19:24,760 --> 00:19:28,600
owners<font color="#E5E5E5"> you are gonna be</font><font color="#CCCCCC"> able to find</font>

449
00:19:26,290 --> 00:19:30,670
them and<font color="#E5E5E5"> also connect them because they</font>

450
00:19:28,600 --> 00:19:32,980
support legacy<font color="#CCCCCC"> devices so you can</font>

451
00:19:30,670 --> 00:19:35,260
<font color="#E5E5E5">connect the peer to peer group owners</font>

452
00:19:32,980 --> 00:19:37,540
one<font color="#E5E5E5"> day appear to be grow group has been</font>

453
00:19:35,260 --> 00:19:39,970
<font color="#CCCCCC">built if there's no peer to peer group</font>

454
00:19:37,540 --> 00:19:44,409
build only<font color="#E5E5E5"> peer to peer devices can</font>

455
00:19:39,970 --> 00:19:47,410
connect each other and this<font color="#E5E5E5"> is a tool</font>

456
00:19:44,410 --> 00:19:50,140
that<font color="#E5E5E5"> again I'm gonna put</font><font color="#CCCCCC"> at the</font><font color="#E5E5E5"> end of</font>

457
00:19:47,410 --> 00:19:53,110
the slides is a tool<font color="#E5E5E5"> I I called it in</font>

458
00:19:50,140 --> 00:19:55,840
<font color="#CCCCCC">Python</font><font color="#E5E5E5"> that is able to execute the</font>

459
00:19:53,110 --> 00:19:57,189
peer-to-peer discovery<font color="#E5E5E5"> without requiring</font>

460
00:19:55,840 --> 00:19:58,959
a specific<font color="#E5E5E5"> card if</font>

461
00:19:57,190 --> 00:20:00,549
<font color="#E5E5E5">car support injection and monitor mode</font>

462
00:19:58,960 --> 00:20:03,220
you're<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> be able to use</font><font color="#CCCCCC"> these and</font>

463
00:20:00,549 --> 00:20:05,200
<font color="#E5E5E5">you will get a lot more information not</font>

464
00:20:03,220 --> 00:20:07,029
<font color="#CCCCCC">only the capabilities and</font><font color="#E5E5E5"> another</font>

465
00:20:05,200 --> 00:20:09,639
information<font color="#CCCCCC"> we are</font><font color="#E5E5E5"> here in the</font>

466
00:20:07,029 --> 00:20:11,499
information<font color="#CCCCCC"> element but also the WPS</font>

467
00:20:09,639 --> 00:20:13,330
information and you will get serial

468
00:20:11,499 --> 00:20:17,590
<font color="#E5E5E5">numbers</font><font color="#CCCCCC"> or manufacturer on different</font>

469
00:20:13,330 --> 00:20:20,978
things so let's talk about<font color="#E5E5E5"> group</font>

470
00:20:17,590 --> 00:20:23,109
formation<font color="#E5E5E5"> as I mentioned unless one</font>

471
00:20:20,979 --> 00:20:26,049
device is<font color="#E5E5E5"> already in a</font><font color="#CCCCCC"> peer-to-peer a</font>

472
00:20:23,109 --> 00:20:27,849
group owner role devices will try to

473
00:20:26,049 --> 00:20:29,979
find each<font color="#E5E5E5"> other and then they are gonna</font>

474
00:20:27,849 --> 00:20:32,049
form a peer to peer group to form<font color="#E5E5E5"> this</font>

475
00:20:29,979 --> 00:20:34,960
group we<font color="#CCCCCC"> need to negotiate who is gonna</font>

476
00:20:32,049 --> 00:20:37,599
<font color="#E5E5E5">be the access point</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> we have a</font>

477
00:20:34,960 --> 00:20:39,369
three-way<font color="#E5E5E5"> handshake here we send the</font>

478
00:20:37,599 --> 00:20:41,590
negotiation<font color="#E5E5E5"> request frame then we say</font>

479
00:20:39,369 --> 00:20:43,749
the<font color="#CCCCCC"> negotiation</font><font color="#E5E5E5"> respond frame and</font>

480
00:20:41,590 --> 00:20:46,840
finally the confirm frame<font color="#E5E5E5"> in this frame</font>

481
00:20:43,749 --> 00:20:48,940
it's important to know<font color="#CCCCCC"> that there are</font>

482
00:20:46,840 --> 00:20:51,070
<font color="#E5E5E5">two important things</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> they are</font>

483
00:20:48,940 --> 00:20:55,109
<font color="#E5E5E5">defined here</font><font color="#CCCCCC"> who is</font><font color="#E5E5E5"> gonna</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> the access</font>

484
00:20:51,070 --> 00:20:57,879
point<font color="#E5E5E5"> that</font><font color="#CCCCCC"> the device is send a specific</font>

485
00:20:55,109 --> 00:21:00,039
specific value on the frames<font color="#CCCCCC"> that is the</font>

486
00:20:57,879 --> 00:21:03,248
desire for<font color="#E5E5E5"> them to be the access point</font>

487
00:21:00,039 --> 00:21:06,309
so<font color="#CCCCCC"> they discussed</font><font color="#E5E5E5"> that and then they</font>

488
00:21:03,249 --> 00:21:07,960
define what<font color="#E5E5E5"> channel they are gonna use</font>

489
00:21:06,309 --> 00:21:11,019
what channel they<font color="#CCCCCC"> are gonna</font><font color="#E5E5E5"> be listening</font>

490
00:21:07,960 --> 00:21:13,179
<font color="#CCCCCC">so once they decided this they say okay</font>

491
00:21:11,019 --> 00:21:14,979
I'm gonna be on<font color="#CCCCCC"> channel 9</font><font color="#E5E5E5"> and then they</font>

492
00:21:13,179 --> 00:21:17,440
<font color="#E5E5E5">appear</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> be a group owner is gonna be</font>

493
00:21:14,979 --> 00:21:19,210
it's<font color="#E5E5E5"> gonna set his Chris Network in the</font>

494
00:21:17,440 --> 00:21:23,109
fridge<font color="#CCCCCC"> from channel 9 and it's gonna</font>

495
00:21:19,210 --> 00:21:25,179
turn him into an access point once this

496
00:21:23,109 --> 00:21:27,580
the peer to peer group group owners has

497
00:21:25,179 --> 00:21:30,609
been define it will start sending<font color="#E5E5E5"> beacon</font>

498
00:21:27,580 --> 00:21:34,269
frames and then any client<font color="#E5E5E5"> any station</font>

499
00:21:30,609 --> 00:21:36,549
that<font color="#E5E5E5"> has support for Wi-Fi 802 dot 11mm</font>

500
00:21:34,269 --> 00:21:39,369
infrastructure mode is<font color="#E5E5E5"> gonna</font><font color="#CCCCCC"> be able</font><font color="#E5E5E5"> to</font>

501
00:21:36,549 --> 00:21:41,529
use this<font color="#E5E5E5"> device the important here is</font>

502
00:21:39,369 --> 00:21:43,720
the<font color="#E5E5E5"> provisioning is how these</font><font color="#CCCCCC"> devices</font>

503
00:21:41,529 --> 00:21:46,389
share the credentials<font color="#E5E5E5"> how they</font>

504
00:21:43,720 --> 00:21:49,419
authenticate each other<font color="#CCCCCC"> well in that</font>

505
00:21:46,389 --> 00:21:51,008
case<font color="#E5E5E5"> they are going</font><font color="#CCCCCC"> to use WPS the</font>

506
00:21:49,419 --> 00:21:53,320
protocol<font color="#CCCCCC"> I mentioned before</font><font color="#E5E5E5"> that was</font>

507
00:21:51,009 --> 00:21:56,049
<font color="#CCCCCC">design</font><font color="#E5E5E5"> by Wi-Fi Alliance the protocol</font>

508
00:21:53,320 --> 00:21:59,950
has<font color="#E5E5E5"> several issues</font><font color="#CCCCCC"> if you look</font><font color="#E5E5E5"> in the</font>

509
00:21:56,049 --> 00:22:02,049
internet<font color="#E5E5E5"> there's I think two</font><font color="#CCCCCC"> of two or</font>

510
00:21:59,950 --> 00:22:04,809
three<font color="#CCCCCC"> years ago</font><font color="#E5E5E5"> there was some</font><font color="#CCCCCC"> guy that</font>

511
00:22:02,049 --> 00:22:08,408
discovered<font color="#E5E5E5"> how to do perform a pin</font>

512
00:22:04,809 --> 00:22:10,870
brute-force attack and it broke<font color="#E5E5E5"> most of</font>

513
00:22:08,409 --> 00:22:14,890
the<font color="#E5E5E5"> YC most of access point I'll cut</font>

514
00:22:10,870 --> 00:22:15,219
<font color="#E5E5E5">WPA support so using the</font><font color="#CCCCCC"> EPS could be an</font>

515
00:22:14,890 --> 00:22:19,210
issue

516
00:22:15,220 --> 00:22:22,410
in this case also how we can<font color="#E5E5E5"> monitor</font>

517
00:22:19,210 --> 00:22:25,120
Wi-Fi direct<font color="#CCCCCC"> as I mentioned</font><font color="#E5E5E5"> before</font>

518
00:22:22,410 --> 00:22:27,310
<font color="#E5E5E5">devices are sweeping channel from</font>

519
00:22:25,120 --> 00:22:28,989
<font color="#E5E5E5">channel and if you want</font><font color="#CCCCCC"> to get all the</font>

520
00:22:27,310 --> 00:22:31,090
<font color="#CCCCCC">traffic from</font><font color="#E5E5E5"> this peer-to-peer devices</font>

521
00:22:28,990 --> 00:22:32,860
<font color="#E5E5E5">even</font><font color="#CCCCCC"> in the negotiation phase</font><font color="#E5E5E5"> you're</font>

522
00:22:31,090 --> 00:22:34,629
<font color="#E5E5E5">going to be a you you need to support</font>

523
00:22:32,860 --> 00:22:36,760
<font color="#E5E5E5">monitoring several channels at the same</font>

524
00:22:34,630 --> 00:22:40,210
<font color="#CCCCCC">time I'm</font><font color="#E5E5E5"> not going to talk too</font><font color="#CCCCCC"> much</font>

525
00:22:36,760 --> 00:22:43,540
about how<font color="#E5E5E5"> to do that but it's important</font>

526
00:22:40,210 --> 00:22:46,900
<font color="#E5E5E5">to know that may sometimes put in like</font>

527
00:22:43,540 --> 00:22:48,909
twelve or fifteen<font color="#E5E5E5"> or twenty USB</font><font color="#CCCCCC"> card it</font>

528
00:22:46,900 --> 00:22:51,400
is not going<font color="#E5E5E5"> to work</font><font color="#CCCCCC"> so you should look</font>

529
00:22:48,910 --> 00:22:52,990
for other solutions but monitoring

530
00:22:51,400 --> 00:22:54,820
several<font color="#CCCCCC"> channels at the same time is an</font>

531
00:22:52,990 --> 00:22:58,450
important thing here when we<font color="#CCCCCC"> are</font><font color="#E5E5E5"> talking</font>

532
00:22:54,820 --> 00:23:02,050
<font color="#E5E5E5">about peer to peer to peer to peer</font>

533
00:22:58,450 --> 00:23:05,500
devices monitoring so I'm not going<font color="#E5E5E5"> to</font>

534
00:23:02,050 --> 00:23:11,500
talk talk about<font color="#E5E5E5"> some attacks that I have</font>

535
00:23:05,500 --> 00:23:15,700
here first I'm going to talk<font color="#CCCCCC"> about</font><font color="#E5E5E5"> HP</font>

536
00:23:11,500 --> 00:23:18,010
<font color="#E5E5E5">printers so HP printers that had support</font>

537
00:23:15,700 --> 00:23:20,260
<font color="#E5E5E5">for Wi-Fi direct that if you go to the</font>

538
00:23:18,010 --> 00:23:23,650
<font color="#E5E5E5">web page</font><font color="#CCCCCC"> of HP there are a lot of new</font>

539
00:23:20,260 --> 00:23:26,820
<font color="#CCCCCC">models</font><font color="#E5E5E5"> I think two</font><font color="#CCCCCC"> years from now</font><font color="#E5E5E5"> you</font>

540
00:23:23,650 --> 00:23:31,630
<font color="#E5E5E5">know</font><font color="#CCCCCC"> Twitter announced or</font><font color="#E5E5E5"> two years back</font>

541
00:23:26,820 --> 00:23:33,429
there<font color="#CCCCCC"> there are starts they</font><font color="#E5E5E5"> start</font>

542
00:23:31,630 --> 00:23:36,610
releasing new models<font color="#E5E5E5"> and these</font><font color="#CCCCCC"> models</font>

543
00:23:33,430 --> 00:23:38,950
<font color="#E5E5E5">have Wi-Fi direct support by default so</font>

544
00:23:36,610 --> 00:23:42,100
what's the issue of kind<font color="#E5E5E5"> Wi-Fi direct</font><font color="#CCCCCC"> by</font>

545
00:23:38,950 --> 00:23:46,660
by default is not<font color="#E5E5E5"> an issue in itself the</font>

546
00:23:42,100 --> 00:23:48,120
<font color="#E5E5E5">problem</font><font color="#CCCCCC"> is how they implement it so this</font>

547
00:23:46,660 --> 00:23:51,420
<font color="#E5E5E5">is the configuration of the printer</font>

548
00:23:48,120 --> 00:23:54,939
Wi-Fi direct is enabled by default<font color="#E5E5E5"> and</font>

549
00:23:51,420 --> 00:23:58,270
<font color="#CCCCCC">the issue here is this</font><font color="#E5E5E5"> one they have</font><font color="#CCCCCC"> the</font>

550
00:23:54,940 --> 00:24:01,060
printer<font color="#E5E5E5"> by default it starts a peer to</font>

551
00:23:58,270 --> 00:24:04,120
peer group you<font color="#E5E5E5"> don't need to look for</font>

552
00:24:01,060 --> 00:24:06,310
for for<font color="#CCCCCC"> a peer-to-peer device and</font><font color="#E5E5E5"> start</font>

553
00:24:04,120 --> 00:24:08,800
the negotiation<font color="#CCCCCC"> and say ok printer</font>

554
00:24:06,310 --> 00:24:10,899
<font color="#CCCCCC">you're gonna be the group owner the</font>

555
00:24:08,800 --> 00:24:12,700
printer by default is gonna set<font color="#CCCCCC"> appear</font>

556
00:24:10,900 --> 00:24:14,590
to be a group and it's gonna be the

557
00:24:12,700 --> 00:24:18,280
group owner<font color="#E5E5E5"> without any peer-to-peer</font>

558
00:24:14,590 --> 00:24:20,129
<font color="#E5E5E5">client needed to do that</font><font color="#CCCCCC"> and then you</font>

559
00:24:18,280 --> 00:24:23,110
<font color="#E5E5E5">have the connection method to automatic</font>

560
00:24:20,130 --> 00:24:24,460
the issue here is that when<font color="#CCCCCC"> you have</font>

561
00:24:23,110 --> 00:24:26,678
this in automatic you

562
00:24:24,460 --> 00:24:29,080
two<font color="#E5E5E5"> issues the first one is that the</font>

563
00:24:26,679 --> 00:24:31,059
Wi-Fi<font color="#CCCCCC"> direct passphrase</font><font color="#E5E5E5"> that is the</font>

564
00:24:29,080 --> 00:24:34,269
passphrase<font color="#E5E5E5"> of the access point that the</font>

565
00:24:31,059 --> 00:24:36,490
printer is providing is one two<font color="#CCCCCC"> three</font>

566
00:24:34,269 --> 00:24:39,730
four five six seven<font color="#E5E5E5"> eight</font>

567
00:24:36,490 --> 00:24:42,789
that is<font color="#E5E5E5"> a password so anyone nearby can</font>

568
00:24:39,730 --> 00:24:44,950
connect to a printer with any device

569
00:24:42,789 --> 00:24:47,320
<font color="#CCCCCC">because as I</font><font color="#E5E5E5"> mentioned</font><font color="#CCCCCC"> before</font><font color="#E5E5E5"> this is</font>

570
00:24:44,950 --> 00:24:50,559
<font color="#E5E5E5">already a peer to peer group formation</font>

571
00:24:47,320 --> 00:24:53,200
sorry<font color="#E5E5E5"> appear</font><font color="#CCCCCC"> to be</font><font color="#E5E5E5"> a group already</font><font color="#CCCCCC"> form</font>

572
00:24:50,559 --> 00:24:55,330
by the printer so any device<font color="#CCCCCC"> you don't</font>

573
00:24:53,200 --> 00:24:58,240
need<font color="#E5E5E5"> even to use a peer-to-peer device</font>

574
00:24:55,330 --> 00:24:59,949
that to connect to the printer once you

575
00:24:58,240 --> 00:25:02,590
<font color="#E5E5E5">are connected to a printer you cob</font><font color="#CCCCCC"> you</font>

576
00:24:59,950 --> 00:25:04,419
can print you can scan you<font color="#CCCCCC"> can use in</font>

577
00:25:02,590 --> 00:25:06,699
<font color="#E5E5E5">fact the web server that has no</font>

578
00:25:04,419 --> 00:25:10,659
authentication<font color="#CCCCCC"> and you can disable</font>

579
00:25:06,700 --> 00:25:14,110
<font color="#CCCCCC">femural</font><font color="#E5E5E5"> updates set a proxy server</font><font color="#CCCCCC"> for</font>

580
00:25:10,659 --> 00:25:17,889
the printer or even try<font color="#E5E5E5"> to attack that</font>

581
00:25:14,110 --> 00:25:19,539
nice attacks<font color="#CCCCCC"> the</font><font color="#E5E5E5"> world</font><font color="#CCCCCC"> lease I think the</font>

582
00:25:17,889 --> 00:25:23,199
first part of<font color="#E5E5E5"> the year of the</font><font color="#CCCCCC"> last</font><font color="#E5E5E5"> year</font>

583
00:25:19,539 --> 00:25:26,169
last<font color="#E5E5E5"> year that you</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> attack the Shedd</font>

584
00:25:23,200 --> 00:25:28,450
printer port<font color="#CCCCCC"> I think nine nine thousand</font>

585
00:25:26,169 --> 00:25:30,249
one<font color="#CCCCCC"> hundred</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> you can try to read the</font>

586
00:25:28,450 --> 00:25:32,289
<font color="#E5E5E5">memory of the printer to</font><font color="#CCCCCC"> see what were</font>

587
00:25:30,249 --> 00:25:34,720
they printer before before we<font color="#E5E5E5"> get</font><font color="#CCCCCC"> access</font>

588
00:25:32,289 --> 00:25:36,999
to the printer<font color="#E5E5E5"> that is</font><font color="#CCCCCC"> the first problem</font>

589
00:25:34,720 --> 00:25:39,340
<font color="#E5E5E5">the second</font><font color="#CCCCCC"> problem is that also appeared</font>

590
00:25:36,999 --> 00:25:42,309
<font color="#CCCCCC">to be</font><font color="#E5E5E5"> our device when when the automatic</font>

591
00:25:39,340 --> 00:25:44,590
mode is is<font color="#E5E5E5"> the enable any peer-to-peer</font>

592
00:25:42,309 --> 00:25:47,320
device can connect directly<font color="#CCCCCC"> with no</font>

593
00:25:44,590 --> 00:25:49,990
<font color="#CCCCCC">authentication and no notification and</font>

594
00:25:47,320 --> 00:25:51,549
<font color="#E5E5E5">no at all for the user so maybe you</font><font color="#CCCCCC"> have</font>

595
00:25:49,990 --> 00:25:55,960
<font color="#E5E5E5">your printer there and someone is you</font>

596
00:25:51,549 --> 00:25:57,519
city and you<font color="#E5E5E5"> will never know this let's</font>

597
00:25:55,960 --> 00:25:59,080
say you<font color="#E5E5E5"> change the connection</font><font color="#CCCCCC"> metal</font>

598
00:25:57,519 --> 00:26:01,360
because<font color="#E5E5E5"> you say</font><font color="#CCCCCC"> okay connection met on</font>

599
00:25:59,080 --> 00:26:03,519
automatic is really a bad hot choice

600
00:26:01,360 --> 00:26:05,709
let's change it to<font color="#CCCCCC"> manual and</font><font color="#E5E5E5"> use the</font>

601
00:26:03,519 --> 00:26:08,409
generate button here to<font color="#CCCCCC"> generate me a</font>

602
00:26:05,710 --> 00:26:11,350
new well here apparently<font color="#CCCCCC"> the</font>

603
00:26:08,409 --> 00:26:14,379
implementation confuse the Wi-Fi pass

604
00:26:11,350 --> 00:26:18,340
phrase that is used on<font color="#E5E5E5"> one dual EPA and</font>

605
00:26:14,379 --> 00:26:20,498
<font color="#E5E5E5">the VA to within</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> pin of</font><font color="#CCCCCC"> duly PS</font><font color="#E5E5E5"> the</font>

606
00:26:18,340 --> 00:26:23,860
pin of<font color="#E5E5E5"> the</font><font color="#CCCCCC"> rupiah's is limited to</font><font color="#E5E5E5"> eight</font>

607
00:26:20,499 --> 00:26:26,110
chars<font color="#E5E5E5"> and only digits the</font><font color="#CCCCCC"> passphrase is</font>

608
00:26:23,860 --> 00:26:28,090
not limited to<font color="#CCCCCC"> that is limited</font><font color="#E5E5E5"> to 64</font>

609
00:26:26,110 --> 00:26:30,820
characters<font color="#E5E5E5"> so every time you</font><font color="#CCCCCC"> push</font>

610
00:26:28,090 --> 00:26:33,759
generate or you change to manual<font color="#E5E5E5"> it will</font>

611
00:26:30,820 --> 00:26:35,619
generate really<font color="#CCCCCC"> see to crack passphrase</font>

612
00:26:33,759 --> 00:26:38,150
for the network<font color="#E5E5E5"> so if you</font><font color="#CCCCCC"> grab the</font>

613
00:26:35,619 --> 00:26:39,980
contract between<font color="#CCCCCC"> a</font><font color="#E5E5E5"> printer and a</font><font color="#CCCCCC"> value</font>

614
00:26:38,150 --> 00:26:42,620
legitimate device<font color="#E5E5E5"> you're going to be</font>

615
00:26:39,980 --> 00:26:45,500
<font color="#CCCCCC">able to crack these in two or three</font>

616
00:26:42,620 --> 00:26:50,540
minutes<font color="#E5E5E5"> with any computer so it's really</font>

617
00:26:45,500 --> 00:26:53,570
<font color="#E5E5E5">bad</font><font color="#CCCCCC"> so Sam Soon decided to something</font>

618
00:26:50,540 --> 00:26:55,970
<font color="#CCCCCC">similar</font><font color="#E5E5E5"> and some some printer</font><font color="#CCCCCC"> costs</font><font color="#E5E5E5"> and</font>

619
00:26:53,570 --> 00:26:58,189
again<font color="#CCCCCC"> used by default a network II that</font>

620
00:26:55,970 --> 00:27:01,100
<font color="#E5E5E5">is limited</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> H characters and only</font>

621
00:26:58,190 --> 00:27:03,440
digits so again if you grab the

622
00:27:01,100 --> 00:27:06,139
handshake<font color="#E5E5E5"> it's gonna be really</font><font color="#CCCCCC"> really</font>

623
00:27:03,440 --> 00:27:08,240
easy<font color="#CCCCCC"> to crack the the car the the</font>

624
00:27:06,140 --> 00:27:10,250
<font color="#E5E5E5">handshake</font><font color="#CCCCCC"> and get access</font><font color="#E5E5E5"> to the printer</font>

625
00:27:08,240 --> 00:27:12,049
<font color="#E5E5E5">remember that this printer is providing</font>

626
00:27:10,250 --> 00:27:14,059
the<font color="#CCCCCC"> access point so you will</font><font color="#E5E5E5"> never</font>

627
00:27:12,049 --> 00:27:16,400
notice something<font color="#E5E5E5"> we're inside your</font>

628
00:27:14,059 --> 00:27:18,168
<font color="#CCCCCC">network because</font><font color="#E5E5E5"> no one is connecting to</font>

629
00:27:16,400 --> 00:27:20,390
<font color="#E5E5E5">your network is someone connected</font><font color="#CCCCCC"> to</font>

630
00:27:18,169 --> 00:27:23,630
your printer directly not going<font color="#E5E5E5"> through</font>

631
00:27:20,390 --> 00:27:25,820
your network<font color="#CCCCCC"> so any IDs IPS or anything</font>

632
00:27:23,630 --> 00:27:27,410
else you have<font color="#CCCCCC"> it is not</font><font color="#E5E5E5"> gonna be able to</font>

633
00:27:25,820 --> 00:27:29,360
<font color="#E5E5E5">detect this because this is another</font>

634
00:27:27,410 --> 00:27:31,880
access point<font color="#E5E5E5"> this is similar to</font><font color="#CCCCCC"> a rogue</font>

635
00:27:29,360 --> 00:27:34,879
access point on<font color="#E5E5E5"> a network that</font><font color="#CCCCCC"> is Wi-Fi</font>

636
00:27:31,880 --> 00:27:37,549
direct more or less and there's<font color="#E5E5E5"> another</font>

637
00:27:34,880 --> 00:27:41,210
good<font color="#E5E5E5"> demonstration that I will show you</font>

638
00:27:37,549 --> 00:27:43,220
now<font color="#CCCCCC"> that I put fishing for a printer</font>

639
00:27:41,210 --> 00:27:47,150
because<font color="#CCCCCC"> it's more or less like an</font>

640
00:27:43,220 --> 00:27:50,660
efficient attack because we know that

641
00:27:47,150 --> 00:27:53,179
<font color="#CCCCCC">usually people</font><font color="#E5E5E5"> when they work near</font>

642
00:27:50,660 --> 00:27:54,740
printers or when they work<font color="#E5E5E5"> if you go to</font>

643
00:27:53,179 --> 00:27:56,480
print something on<font color="#E5E5E5"> your on</font><font color="#CCCCCC"> your office</font>

644
00:27:54,740 --> 00:27:59,030
<font color="#E5E5E5">and you go</font><font color="#CCCCCC"> they are</font><font color="#E5E5E5"> the printer is</font>

645
00:27:56,480 --> 00:28:01,250
having<font color="#E5E5E5"> LEDs everywhere I'm flashing and</font>

646
00:27:59,030 --> 00:28:03,320
what is my sheet of paper I<font color="#E5E5E5"> don't find</font>

647
00:28:01,250 --> 00:28:05,299
my print shop work<font color="#E5E5E5"> and</font><font color="#CCCCCC"> you stop written</font>

648
00:28:03,320 --> 00:28:07,309
all the only<font color="#CCCCCC"> all the bouton sudden</font>

649
00:28:05,299 --> 00:28:15,530
<font color="#E5E5E5">something happens so</font><font color="#CCCCCC"> that is how printer</font>

650
00:28:07,309 --> 00:28:24,530
works in this case<font color="#CCCCCC"> oh sorry I will show</font>

651
00:28:15,530 --> 00:28:26,540
you here I have the<font color="#CCCCCC"> Lippe supplicant</font>

652
00:28:24,530 --> 00:28:28,940
running here with my network interface

653
00:28:26,540 --> 00:28:31,460
appear to be a configuration file the

654
00:28:28,940 --> 00:28:35,870
driver<font color="#E5E5E5"> here have a client this is a</font>

655
00:28:31,460 --> 00:28:38,270
three<font color="#E5E5E5"> different terminals wait</font><font color="#CCCCCC"> and here</font>

656
00:28:35,870 --> 00:28:41,689
I have a root terminal<font color="#E5E5E5"> so I</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> show you</font>

657
00:28:38,270 --> 00:28:44,059
then what what is going<font color="#CCCCCC"> on</font><font color="#E5E5E5"> so I will run</font>

658
00:28:41,690 --> 00:28:47,120
the peer-to-peer find to look<font color="#E5E5E5"> for</font>

659
00:28:44,059 --> 00:28:50,050
<font color="#E5E5E5">peer-to-peer devices and we put four</font>

660
00:28:47,120 --> 00:28:50,050
seconds<font color="#E5E5E5"> timeout</font>

661
00:28:53,409 --> 00:29:01,089
I'm never<font color="#E5E5E5"> able to find</font><font color="#CCCCCC"> it the printer</font>

662
00:28:55,969 --> 00:29:03,589
there so this<font color="#E5E5E5"> is a samsung printer</font><font color="#CCCCCC"> I</font>

663
00:29:01,089 --> 00:29:08,208
will copy the peer-to-peer device

664
00:29:03,589 --> 00:29:10,309
<font color="#E5E5E5">address that just</font><font color="#CCCCCC"> justice'</font><font color="#E5E5E5"> as a note the</font>

665
00:29:08,209 --> 00:29:12,559
peer-to-peer device address<font color="#E5E5E5"> is not the</font>

666
00:29:10,309 --> 00:29:15,019
same as the<font color="#E5E5E5"> peer remember when I</font><font color="#CCCCCC"> talk</font>

667
00:29:12,559 --> 00:29:16,399
<font color="#CCCCCC">about</font><font color="#E5E5E5"> concurrent operations that the</font>

668
00:29:15,019 --> 00:29:18,739
printer can<font color="#E5E5E5"> be connected</font><font color="#CCCCCC"> into your</font>

669
00:29:16,399 --> 00:29:20,748
wireless network<font color="#E5E5E5"> and also provide appear</font>

670
00:29:18,739 --> 00:29:23,059
to be a group owner<font color="#E5E5E5"> the MAC address</font><font color="#CCCCCC"> is</font>

671
00:29:20,749 --> 00:29:25,039
different<font color="#CCCCCC"> so again if you are</font><font color="#E5E5E5"> looking</font>

672
00:29:23,059 --> 00:29:28,129
<font color="#CCCCCC">for some sometimes when we are looking</font>

673
00:29:25,039 --> 00:29:29,809
for soft a piece or<font color="#E5E5E5"> roll-up s we are</font>

674
00:29:28,129 --> 00:29:31,609
gonna we are<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> look for the same</font>

675
00:29:29,809 --> 00:29:33,649
<font color="#CCCCCC">mcalary's of the device we have</font>

676
00:29:31,609 --> 00:29:34,039
<font color="#E5E5E5">connected to our network</font><font color="#CCCCCC"> or</font><font color="#E5E5E5"> something</font>

677
00:29:33,649 --> 00:29:36,678
similar

678
00:29:34,039 --> 00:29:40,639
well this is<font color="#E5E5E5"> different so sometimes it's</font>

679
00:29:36,679 --> 00:29:43,669
<font color="#E5E5E5">hard to detect so I'm going to</font><font color="#CCCCCC"> execute</font>

680
00:29:40,639 --> 00:29:47,089
the peer-to-peer<font color="#E5E5E5"> connect command with a</font>

681
00:29:43,669 --> 00:29:51,679
peer-to-peer device address<font color="#E5E5E5"> finally I</font>

682
00:29:47,089 --> 00:29:53,719
will set these to use the push button

683
00:29:51,679 --> 00:29:56,299
configuration they do it is one<font color="#CCCCCC"> of the</font>

684
00:29:53,719 --> 00:29:58,009
<font color="#E5E5E5">methods that WPS provides to</font>

685
00:29:56,299 --> 00:30:00,079
authenticate to a device you can use

686
00:29:58,009 --> 00:30:02,569
push photon configuration you can use

687
00:30:00,079 --> 00:30:06,229
NFC if you are near a device that has an

688
00:30:02,569 --> 00:30:08,389
F an NFC<font color="#CCCCCC"> tag and you can</font><font color="#E5E5E5"> use a a pin</font>

689
00:30:06,229 --> 00:30:11,329
number<font color="#CCCCCC"> in</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> case I'm going to use the</font>

690
00:30:08,389 --> 00:30:14,658
push photon configuration and finally I

691
00:30:11,329 --> 00:30:16,969
gonna set this value<font color="#CCCCCC"> to join and that is</font>

692
00:30:14,659 --> 00:30:19,399
because as I mentioned before<font color="#E5E5E5"> the</font>

693
00:30:16,969 --> 00:30:22,489
printer<font color="#E5E5E5"> already have a peer to peer</font>

694
00:30:19,399 --> 00:30:24,319
group owner is<font color="#CCCCCC"> appeared to be a group</font>

695
00:30:22,489 --> 00:30:26,209
owner<font color="#E5E5E5"> so</font><font color="#CCCCCC"> they appear to be a group is</font>

696
00:30:24,319 --> 00:30:31,418
<font color="#E5E5E5">already built so I have to join this</font>

697
00:30:26,209 --> 00:30:31,419
peer to peer group<font color="#E5E5E5"> so I will run</font><font color="#CCCCCC"> this</font>

698
00:30:31,989 --> 00:30:38,869
and then we start seeing what is going

699
00:30:36,769 --> 00:30:41,959
<font color="#CCCCCC">on</font><font color="#E5E5E5"> in the printer so this is my printer</font>

700
00:30:38,869 --> 00:30:45,738
<font color="#E5E5E5">I'm near by the</font><font color="#CCCCCC"> Pioneer the printer and</font>

701
00:30:41,959 --> 00:30:48,049
the printer is<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> do this you're</font>

702
00:30:45,739 --> 00:30:52,489
gonna start blinking<font color="#E5E5E5"> this led this led</font>

703
00:30:48,049 --> 00:30:54,529
here and it's hard to<font color="#E5E5E5"> see here but</font><font color="#CCCCCC"> if</font>

704
00:30:52,489 --> 00:30:56,659
you see here the printer<font color="#CCCCCC"> is gonna</font><font color="#E5E5E5"> start</font>

705
00:30:54,529 --> 00:31:02,929
<font color="#E5E5E5">the motors and has got to start</font><font color="#CCCCCC"> making</font>

706
00:30:56,659 --> 00:31:04,169
noise<font color="#E5E5E5"> so</font><font color="#CCCCCC"> once I see the motor here</font><font color="#E5E5E5"> and</font>

707
00:31:02,929 --> 00:31:06,269
blinking<font color="#CCCCCC"> on</font><font color="#E5E5E5"> the LEDs I</font>

708
00:31:04,169 --> 00:31:08,759
say what is<font color="#CCCCCC"> going on with my printer or</font>

709
00:31:06,269 --> 00:31:11,220
or<font color="#E5E5E5"> I don't</font><font color="#CCCCCC"> know</font><font color="#E5E5E5"> what is going on but</font>

710
00:31:08,759 --> 00:31:13,320
this button that says WPS<font color="#CCCCCC"> I don't know</font>

711
00:31:11,220 --> 00:31:16,109
what this<font color="#E5E5E5"> means but it's flashing so I</font>

712
00:31:13,320 --> 00:31:20,489
had to push<font color="#CCCCCC"> it because is then easy</font>

713
00:31:16,109 --> 00:31:25,408
thing I<font color="#E5E5E5"> have to do so I go there and</font>

714
00:31:20,489 --> 00:31:28,379
push<font color="#CCCCCC"> the button</font><font color="#E5E5E5"> okay it is</font><font color="#CCCCCC"> stopped</font><font color="#E5E5E5"> doing</font>

715
00:31:25,409 --> 00:31:31,679
noise<font color="#CCCCCC"> so this is good</font><font color="#E5E5E5"> I can still use my</font>

716
00:31:28,379 --> 00:31:33,748
printer<font color="#CCCCCC"> and now I I gave access to</font>

717
00:31:31,679 --> 00:31:35,970
someone<font color="#E5E5E5"> okay someone</font><font color="#CCCCCC"> cause connecting</font>

718
00:31:33,749 --> 00:31:38,549
now directly to<font color="#E5E5E5"> my printer</font><font color="#CCCCCC"> I gonna show</font>

719
00:31:35,970 --> 00:31:43,619
you here<font color="#CCCCCC"> that I can not</font><font color="#E5E5E5"> only ping the</font>

720
00:31:38,549 --> 00:31:47,489
printer but I can also<font color="#E5E5E5"> use the services</font>

721
00:31:43,619 --> 00:31:49,139
<font color="#CCCCCC">provided by the printer usually all the</font>

722
00:31:47,489 --> 00:31:50,940
<font color="#E5E5E5">information all the implementations I</font>

723
00:31:49,139 --> 00:31:52,830
saw the same<font color="#E5E5E5"> services</font><font color="#CCCCCC"> that they</font><font color="#E5E5E5"> are</font>

724
00:31:50,940 --> 00:31:54,779
provided when<font color="#E5E5E5"> the device</font><font color="#CCCCCC"> is connected to</font>

725
00:31:52,830 --> 00:31:56,309
<font color="#E5E5E5">a network are the same services that</font>

726
00:31:54,779 --> 00:32:00,090
<font color="#CCCCCC">they are</font><font color="#E5E5E5"> provided to the peer-to-peer</font>

727
00:31:56,309 --> 00:32:02,460
device interface<font color="#E5E5E5"> so I'm</font><font color="#CCCCCC"> gonna to execute</font>

728
00:32:00,090 --> 00:32:05,639
an<font color="#CCCCCC"> nmap</font><font color="#E5E5E5"> just to see what I have or what</font>

729
00:32:02,460 --> 00:32:10,409
options I have<font color="#CCCCCC"> I can</font><font color="#E5E5E5"> see here I have</font><font color="#CCCCCC"> J</font>

730
00:32:05,639 --> 00:32:15,330
direct and different<font color="#E5E5E5"> services</font><font color="#CCCCCC"> and I have</font>

731
00:32:10,409 --> 00:32:20,690
a TCP server<font color="#E5E5E5"> sorry web server so I'm</font>

732
00:32:15,330 --> 00:32:20,689
going to connect<font color="#E5E5E5"> to the web server so</font>

733
00:32:25,650 --> 00:32:29,580
that's all I can<font color="#E5E5E5"> connect to a</font><font color="#CCCCCC"> printer</font>

734
00:32:27,390 --> 00:32:31,740
and<font color="#E5E5E5"> use whatever I want I can print with</font>

735
00:32:29,580 --> 00:32:33,210
<font color="#E5E5E5">the printer</font><font color="#CCCCCC"> I can connect I try to</font>

736
00:32:31,740 --> 00:32:37,559
configure the printer I can do anything

737
00:32:33,210 --> 00:32:40,800
<font color="#E5E5E5">so the interesting</font><font color="#CCCCCC"> thing here is if you</font>

738
00:32:37,559 --> 00:32:43,500
if you<font color="#E5E5E5"> think of yourself what would you</font>

739
00:32:40,800 --> 00:32:48,139
do if you have a printer that<font color="#CCCCCC"> is doing</font>

740
00:32:43,500 --> 00:32:48,140
this crazy thing noise and everything

741
00:32:49,370 --> 00:32:56,879
like<font color="#E5E5E5"> five</font><font color="#CCCCCC"> times in a row okay</font><font color="#E5E5E5"> five</font>

742
00:32:53,190 --> 00:32:58,950
minutes<font color="#CCCCCC"> the printer is doing is letting</font>

743
00:32:56,880 --> 00:33:00,270
<font color="#E5E5E5">lets all you want to say what is</font><font color="#CCCCCC"> going</font>

744
00:32:58,950 --> 00:33:01,860
<font color="#CCCCCC">on with this printer you're</font><font color="#E5E5E5"> gonna go</font>

745
00:33:00,270 --> 00:33:04,889
there and<font color="#E5E5E5"> press a button</font><font color="#CCCCCC"> so this</font><font color="#E5E5E5"> is</font>

746
00:33:01,860 --> 00:33:06,600
fishing<font color="#CCCCCC"> with a printer okay</font><font color="#E5E5E5"> so you</font>

747
00:33:04,890 --> 00:33:07,770
<font color="#E5E5E5">started sending sending fragment in</font>

748
00:33:06,600 --> 00:33:10,080
<font color="#CCCCCC">someone near the printer is gonna say</font>

749
00:33:07,770 --> 00:33:13,200
what is going<font color="#CCCCCC"> on with</font><font color="#E5E5E5"> this I press this</font>

750
00:33:10,080 --> 00:33:16,379
<font color="#E5E5E5">button</font><font color="#CCCCCC"> all stops great</font><font color="#E5E5E5"> I'll go back to</font>

751
00:33:13,200 --> 00:33:19,230
my to<font color="#E5E5E5"> my place and that's all</font>

752
00:33:16,380 --> 00:33:21,059
<font color="#E5E5E5">so that is our fishing for a printer the</font>

753
00:33:19,230 --> 00:33:23,670
issue here to understand what is going

754
00:33:21,059 --> 00:33:27,170
<font color="#CCCCCC">on is that when you</font><font color="#E5E5E5"> use PA push</font><font color="#CCCCCC"> photon</font>

755
00:33:23,670 --> 00:33:30,450
<font color="#E5E5E5">configuration the WPS a specification</font>

756
00:33:27,170 --> 00:33:32,550
<font color="#E5E5E5">mentions that are both on</font><font color="#CCCCCC"> that can</font><font color="#E5E5E5"> be</font>

757
00:33:30,450 --> 00:33:34,260
physical button or a<font color="#CCCCCC"> butyl button</font><font color="#E5E5E5"> is</font>

758
00:33:32,550 --> 00:33:36,960
going<font color="#E5E5E5"> to be</font><font color="#CCCCCC"> displayed on</font><font color="#E5E5E5"> both devices</font>

759
00:33:34,260 --> 00:33:38,700
<font color="#E5E5E5">and you have to click both devices to</font>

760
00:33:36,960 --> 00:33:41,309
authenticate that<font color="#E5E5E5"> the devices want to</font>

761
00:33:38,700 --> 00:33:42,770
connect each other<font color="#E5E5E5"> in this case you're</font>

762
00:33:41,309 --> 00:33:45,389
going<font color="#CCCCCC"> to brute</font><font color="#E5E5E5"> force and send unlimited</font>

763
00:33:42,770 --> 00:33:47,429
<font color="#E5E5E5">push</font><font color="#CCCCCC"> required push button request to the</font>

764
00:33:45,390 --> 00:33:49,770
printer until<font color="#E5E5E5"> someone pushes the button</font>

765
00:33:47,429 --> 00:33:51,690
and<font color="#E5E5E5"> you get access to the printer once</font>

766
00:33:49,770 --> 00:33:54,660
you had<font color="#E5E5E5"> access to the printer you</font><font color="#CCCCCC"> have</font>

767
00:33:51,690 --> 00:33:56,429
<font color="#E5E5E5">to chain another attack</font><font color="#CCCCCC"> explained the</font>

768
00:33:54,660 --> 00:33:57,929
printer to try to get access<font color="#E5E5E5"> to a</font>

769
00:33:56,429 --> 00:34:00,600
<font color="#CCCCCC">network or the network the printer is</font>

770
00:33:57,929 --> 00:34:06,330
connected to if not you are<font color="#E5E5E5"> gonna try to</font>

771
00:34:00,600 --> 00:34:07,879
attack<font color="#CCCCCC"> the printer</font><font color="#E5E5E5"> itself so let's talk</font>

772
00:34:06,330 --> 00:34:13,259
<font color="#E5E5E5">a little bit</font><font color="#CCCCCC"> about Smart TVs</font>

773
00:34:07,879 --> 00:34:14,668
this is<font color="#CCCCCC"> Samsung Smart</font><font color="#E5E5E5"> TVs</font><font color="#CCCCCC"> I know that I</font>

774
00:34:13,260 --> 00:34:17,550
have some discussion with<font color="#E5E5E5"> some guys</font>

775
00:34:14,668 --> 00:34:19,918
<font color="#E5E5E5">because they told me most Smart TVs do</font>

776
00:34:17,550 --> 00:34:22,200
the same implementation of Samsung but<font color="#E5E5E5"> I</font>

777
00:34:19,918 --> 00:34:24,960
only get<font color="#CCCCCC"> access to some go</font><font color="#E5E5E5"> to Samsung</font>

778
00:34:22,199 --> 00:34:28,020
TVs and a sanity onion panel researcher

779
00:34:24,960 --> 00:34:30,179
I'm not able<font color="#CCCCCC"> to buy 10 different TVs so</font>

780
00:34:28,020 --> 00:34:33,739
this is a TV<font color="#CCCCCC"> I have am at home I</font>

781
00:34:30,179 --> 00:34:36,929
<font color="#CCCCCC">attacked my</font><font color="#E5E5E5"> own TV that's all I can do</font>

782
00:34:33,739 --> 00:34:39,469
but apparently the same issue is

783
00:34:36,929 --> 00:34:43,320
presented<font color="#CCCCCC"> on a lot of</font><font color="#E5E5E5"> different</font><font color="#CCCCCC"> devices</font>

784
00:34:39,469 --> 00:34:45,629
so some of them are to<font color="#CCCCCC"> be has</font><font color="#E5E5E5"> Wi-Fi</font>

785
00:34:43,320 --> 00:34:48,360
direct support again<font color="#CCCCCC"> but</font><font color="#E5E5E5"> default they</font>

786
00:34:45,630 --> 00:34:51,480
are different with HP printers and some

787
00:34:48,360 --> 00:34:53,010
some printers is that here<font color="#E5E5E5"> the TV is not</font>

788
00:34:51,480 --> 00:34:54,659
a peer to peer group

789
00:34:53,010 --> 00:34:56,190
it doesn't have<font color="#CCCCCC"> a it doesn't build</font>

790
00:34:54,659 --> 00:34:58,560
appear to be a<font color="#CCCCCC"> good for default by</font>

791
00:34:56,190 --> 00:35:01,500
default<font color="#E5E5E5"> so if you go around with</font><font color="#CCCCCC"> your</font>

792
00:34:58,560 --> 00:35:04,410
computer using kismet<font color="#E5E5E5"> or any other</font>

793
00:35:01,500 --> 00:35:06,660
monitoring tools such as<font color="#E5E5E5"> airdrop airdrop</font>

794
00:35:04,410 --> 00:35:10,109
sorry<font color="#CCCCCC"> there are</font><font color="#E5E5E5"> the IRA lamp or any</font>

795
00:35:06,660 --> 00:35:12,149
other tool<font color="#E5E5E5"> your we you're not</font><font color="#CCCCCC"> going to</font>

796
00:35:10,110 --> 00:35:14,730
be<font color="#CCCCCC"> able to find this TVs</font><font color="#E5E5E5"> this TV is</font>

797
00:35:12,150 --> 00:35:17,280
<font color="#E5E5E5">gonna be like in is as I</font><font color="#CCCCCC"> mentioned</font>

798
00:35:14,730 --> 00:35:19,160
before in the<font color="#E5E5E5"> listen state the TV is</font>

799
00:35:17,280 --> 00:35:21,720
waiting for approval<font color="#CCCCCC"> request</font>

800
00:35:19,160 --> 00:35:25,020
specifically for a peer-to-peer device

801
00:35:21,720 --> 00:35:27,000
that is looking<font color="#E5E5E5"> for</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> TV so the TV is</font>

802
00:35:25,020 --> 00:35:30,170
gonna<font color="#E5E5E5"> be silently there waiting</font><font color="#CCCCCC"> for</font>

803
00:35:27,000 --> 00:35:35,910
someone to find it once you<font color="#E5E5E5"> find the TV</font>

804
00:35:30,170 --> 00:35:39,810
the TV has a again<font color="#E5E5E5"> another issue I</font>

805
00:35:35,910 --> 00:35:41,910
mentioned on the<font color="#CCCCCC"> first slide is the</font>

806
00:35:39,810 --> 00:35:45,570
<font color="#CCCCCC">peer-to-peer</font><font color="#E5E5E5"> specification</font><font color="#CCCCCC"> isn't define</font>

807
00:35:41,910 --> 00:35:47,629
how how we<font color="#E5E5E5"> can connect several time to</font>

808
00:35:45,570 --> 00:35:49,560
the same peer-to-peer device without

809
00:35:47,630 --> 00:35:52,200
authenticating every time we want to

810
00:35:49,560 --> 00:35:54,299
<font color="#E5E5E5">connect to</font><font color="#CCCCCC"> device so because that is out</font>

811
00:35:52,200 --> 00:35:58,649
of the scope of<font color="#E5E5E5"> the</font><font color="#CCCCCC"> pacification samsung</font>

812
00:35:54,300 --> 00:36:01,260
decided to use a whitelist<font color="#E5E5E5"> blacklist</font>

813
00:35:58,650 --> 00:36:03,510
scheme so they have a multimedia<font color="#E5E5E5"> device</font>

814
00:36:01,260 --> 00:36:06,270
<font color="#CCCCCC">monitor on your</font><font color="#E5E5E5"> TV that usually nobody</font>

815
00:36:03,510 --> 00:36:10,620
finds because it's like in the<font color="#CCCCCC"> manual</font>

816
00:36:06,270 --> 00:36:12,000
really hide and once you have for

817
00:36:10,620 --> 00:36:14,580
example a tablet<font color="#E5E5E5"> that was already</font>

818
00:36:12,000 --> 00:36:16,200
connected to<font color="#CCCCCC"> a TV once it will say okay</font>

819
00:36:14,580 --> 00:36:19,590
<font color="#CCCCCC">I will allow this tablet to connect</font>

820
00:36:16,200 --> 00:36:21,390
<font color="#E5E5E5">several more times because I come</font><font color="#CCCCCC"> i I</font>

821
00:36:19,590 --> 00:36:24,000
the target<font color="#E5E5E5"> was authenticated the first</font>

822
00:36:21,390 --> 00:36:28,770
time<font color="#CCCCCC"> I've now</font><font color="#E5E5E5"> trust the tablet II is a</font>

823
00:36:24,000 --> 00:36:30,630
good person<font color="#CCCCCC"> okay so I will</font><font color="#E5E5E5"> explain</font>

824
00:36:28,770 --> 00:36:32,670
<font color="#E5E5E5">everything and then finally I will</font>

825
00:36:30,630 --> 00:36:34,470
<font color="#CCCCCC">explain what</font><font color="#E5E5E5"> is issue the first time you</font>

826
00:36:32,670 --> 00:36:36,630
try<font color="#E5E5E5"> to connect with your device you will</font>

827
00:36:34,470 --> 00:36:38,459
have<font color="#E5E5E5"> something like this</font><font color="#CCCCCC"> this appear on</font>

828
00:36:36,630 --> 00:36:41,100
your<font color="#E5E5E5"> screen it will say fake</font>

829
00:36:38,460 --> 00:36:43,530
peer-to-peer<font color="#E5E5E5"> device name is attempting</font>

830
00:36:41,100 --> 00:36:45,960
<font color="#CCCCCC">to connect here is the real peer-to-peer</font>

831
00:36:43,530 --> 00:36:48,810
device is attempting to<font color="#E5E5E5"> connect or</font><font color="#CCCCCC"> TV</font>

832
00:36:45,960 --> 00:36:51,900
and with your remote control<font color="#E5E5E5"> that is a</font>

833
00:36:48,810 --> 00:36:53,070
really secure component that cannot be

834
00:36:51,900 --> 00:36:58,290
impersonated

835
00:36:53,070 --> 00:37:00,510
ever<font color="#E5E5E5"> the TV is gonna be the user of the</font>

836
00:36:58,290 --> 00:37:04,100
TV<font color="#E5E5E5"> or owner is</font><font color="#CCCCCC"> gonna select allow or</font>

837
00:37:00,510 --> 00:37:06,840
deny to<font color="#CCCCCC"> have access to this device</font>

838
00:37:04,100 --> 00:37:08,880
<font color="#E5E5E5">finally when you already are in there in</font>

839
00:37:06,840 --> 00:37:10,620
the<font color="#CCCCCC"> whitelist</font><font color="#E5E5E5"> your device is gonna be</font>

840
00:37:08,880 --> 00:37:12,750
every<font color="#E5E5E5"> time you connect to a device it's</font>

841
00:37:10,620 --> 00:37:17,100
only gonna show<font color="#E5E5E5"> this connecting to and</font>

842
00:37:12,750 --> 00:37:20,880
the device name<font color="#E5E5E5"> okay so what the issue</font>

843
00:37:17,100 --> 00:37:23,520
here is that they use<font color="#CCCCCC"> mud</font><font color="#E5E5E5"> filtering okay</font>

844
00:37:20,880 --> 00:37:27,300
<font color="#E5E5E5">the way to authenticate</font><font color="#CCCCCC"> the device</font><font color="#E5E5E5"> that</font>

845
00:37:23,520 --> 00:37:29,970
<font color="#E5E5E5">was once validated that is a real device</font>

846
00:37:27,300 --> 00:37:32,190
<font color="#CCCCCC">and you trust on the device you are</font>

847
00:37:29,970 --> 00:37:35,520
using the MAC address<font color="#CCCCCC"> of the device</font><font color="#E5E5E5"> that</font>

848
00:37:32,190 --> 00:37:38,730
<font color="#CCCCCC">is really</font><font color="#E5E5E5"> really easy to</font><font color="#CCCCCC"> modify your</font>

849
00:37:35,520 --> 00:37:41,130
network to your MAC address<font color="#CCCCCC"> for um for</font>

850
00:37:38,730 --> 00:37:43,440
<font color="#E5E5E5">example my mom my computer here I can</font>

851
00:37:41,130 --> 00:37:46,380
change the<font color="#E5E5E5"> MAC address</font><font color="#CCCCCC"> wait so the</font>

852
00:37:43,440 --> 00:37:48,750
device connect to the TV<font color="#E5E5E5"> I grab a frame</font>

853
00:37:46,380 --> 00:37:51,210
<font color="#CCCCCC">I say okay this</font><font color="#E5E5E5"> is a frame of a valid</font>

854
00:37:48,750 --> 00:37:53,880
client I<font color="#E5E5E5"> will with set that to my</font>

855
00:37:51,210 --> 00:37:56,160
computer<font color="#E5E5E5"> I disconnect there the legit</font>

856
00:37:53,880 --> 00:37:59,280
device<font color="#E5E5E5"> and then I connect to the device</font>

857
00:37:56,160 --> 00:38:02,609
<font color="#E5E5E5">and let's say we come back here let's</font>

858
00:37:59,280 --> 00:38:05,360
say I change my device name okay because

859
00:38:02,610 --> 00:38:07,770
<font color="#E5E5E5">maybe the guy if he seen something like</font>

860
00:38:05,360 --> 00:38:10,770
connecting to tablet<font color="#E5E5E5"> and he wouldn't say</font>

861
00:38:07,770 --> 00:38:12,960
<font color="#CCCCCC">ok</font><font color="#E5E5E5"> but my tablet is there it's off how</font>

862
00:38:10,770 --> 00:38:16,320
kids can<font color="#E5E5E5"> be connected maybe he turns</font>

863
00:38:12,960 --> 00:38:18,600
like something weirds going<font color="#CCCCCC"> on ok so in</font>

864
00:38:16,320 --> 00:38:20,400
this<font color="#E5E5E5"> case you can change the device name</font>

865
00:38:18,600 --> 00:38:22,740
because it's not used on there and<font color="#E5E5E5"> the</font>

866
00:38:20,400 --> 00:38:25,020
<font color="#CCCCCC">whitelist ok</font><font color="#E5E5E5"> so you can</font><font color="#CCCCCC"> put</font><font color="#E5E5E5"> something</font>

867
00:38:22,740 --> 00:38:27,839
like connecting to and you replace the

868
00:38:25,020 --> 00:38:29,280
device<font color="#E5E5E5"> name for the internet so your</font>

869
00:38:27,840 --> 00:38:32,730
<font color="#E5E5E5">TV's gonna show a message here that is</font>

870
00:38:29,280 --> 00:38:34,740
connecting<font color="#CCCCCC"> to the internet so that is a</font>

871
00:38:32,730 --> 00:38:36,600
<font color="#E5E5E5">really common why I I will not get too</font>

872
00:38:34,740 --> 00:38:38,069
paranoid<font color="#E5E5E5"> if my TV saying</font><font color="#CCCCCC"> ok</font><font color="#E5E5E5"> and</font>

873
00:38:36,600 --> 00:38:40,200
connecting<font color="#CCCCCC"> to the internet maybe</font>

874
00:38:38,070 --> 00:38:43,020
something went wrong I don't<font color="#E5E5E5"> know if he</font>

875
00:38:40,200 --> 00:38:45,480
connected so all this is really

876
00:38:43,020 --> 00:38:47,910
<font color="#E5E5E5">confusing</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> the client and if the guy</font>

877
00:38:45,480 --> 00:38:50,490
doesn't<font color="#E5E5E5"> know what is going</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> this will</font>

878
00:38:47,910 --> 00:38:56,629
go by and<font color="#E5E5E5"> he never noticed that</font><font color="#CCCCCC"> someone</font>

879
00:38:50,490 --> 00:39:00,149
is using the<font color="#E5E5E5"> TV hey sorry this</font><font color="#CCCCCC"> worried</font>

880
00:38:56,630 --> 00:39:02,460
finally I'm<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> talk about the value</font>

881
00:39:00,150 --> 00:39:07,490
TV was traditional<font color="#CCCCCC"> TV like</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> is the</font>

882
00:39:02,460 --> 00:39:07,490
worst<font color="#E5E5E5"> implementation I I saw so far</font>

883
00:39:07,500 --> 00:39:12,000
but it's important to<font color="#E5E5E5"> mention before I</font>

884
00:39:09,750 --> 00:39:14,220
finish this<font color="#CCCCCC"> Martinique has a lot of</font>

885
00:39:12,000 --> 00:39:15,780
<font color="#E5E5E5">services okay</font><font color="#CCCCCC"> so you can use a lot of</font>

886
00:39:14,220 --> 00:39:18,120
<font color="#E5E5E5">services with the TV once you are</font>

887
00:39:15,780 --> 00:39:21,240
connected through peer-to-peer<font color="#E5E5E5"> this is</font>

888
00:39:18,120 --> 00:39:23,790
the worst<font color="#E5E5E5"> but it affected me a</font><font color="#CCCCCC"> lot</font>

889
00:39:21,240 --> 00:39:26,819
<font color="#E5E5E5">because</font><font color="#CCCCCC"> I bought this device</font><font color="#E5E5E5"> a lot of</font>

890
00:39:23,790 --> 00:39:29,670
years<font color="#CCCCCC"> ago</font><font color="#E5E5E5"> and I use it in my house a lot</font>

891
00:39:26,820 --> 00:39:32,460
like one year<font color="#E5E5E5"> and</font><font color="#CCCCCC"> I never</font><font color="#E5E5E5"> noticed that</font>

892
00:39:29,670 --> 00:39:34,140
<font color="#CCCCCC">there was a perfect bridge to someone to</font>

893
00:39:32,460 --> 00:39:38,130
connect to my network<font color="#E5E5E5"> and I will never</font>

894
00:39:34,140 --> 00:39:41,190
notice this device<font color="#E5E5E5"> no it's in the trash</font>

895
00:39:38,130 --> 00:39:44,400
<font color="#CCCCCC">I throw in a way</font><font color="#E5E5E5"> but it's important to</font>

896
00:39:41,190 --> 00:39:47,940
to to understand that the implementation

897
00:39:44,400 --> 00:39:50,490
<font color="#E5E5E5">here is really bad and it changed with</font>

898
00:39:47,940 --> 00:39:52,440
another attack<font color="#E5E5E5"> okay again every time</font><font color="#CCCCCC"> we</font>

899
00:39:50,490 --> 00:39:54,779
<font color="#CCCCCC">talk about Wi-Fi</font><font color="#E5E5E5"> direct</font><font color="#CCCCCC"> I only talk in</font>

900
00:39:52,440 --> 00:39:57,000
abusing<font color="#E5E5E5"> of the protocol to get access to</font>

901
00:39:54,780 --> 00:39:59,160
the device<font color="#E5E5E5"> how you exploit them to get</font>

902
00:39:57,000 --> 00:40:03,180
<font color="#E5E5E5">access to their network</font><font color="#CCCCCC"> it depends on</font>

903
00:39:59,160 --> 00:40:06,690
the configuration<font color="#E5E5E5"> so once you connect to</font>

904
00:40:03,180 --> 00:40:08,850
the<font color="#E5E5E5"> WB Western Digital TV live you have</font>

905
00:40:06,690 --> 00:40:10,980
<font color="#CCCCCC">a lot of services you have someone</font><font color="#E5E5E5"> for</font>

906
00:40:08,850 --> 00:40:13,529
<font color="#CCCCCC">example</font><font color="#E5E5E5"> someone</font><font color="#CCCCCC"> will let you interact</font>

907
00:40:10,980 --> 00:40:15,000
<font color="#E5E5E5">with the device and all the mass storage</font>

908
00:40:13,530 --> 00:40:18,450
devices that are plugged<font color="#E5E5E5"> to the device</font>

909
00:40:15,000 --> 00:40:20,580
with read and write permission so anyone

910
00:40:18,450 --> 00:40:23,669
can write anything on any device

911
00:40:20,580 --> 00:40:25,740
connected<font color="#CCCCCC"> to the</font><font color="#E5E5E5"> the media center it's</font>

912
00:40:23,670 --> 00:40:28,290
also<font color="#E5E5E5"> Casa this port that</font><font color="#CCCCCC"> has a</font>

913
00:40:25,740 --> 00:40:30,330
proprietary protocol<font color="#E5E5E5"> to use</font><font color="#CCCCCC"> as remote</font>

914
00:40:28,290 --> 00:40:32,970
control so you can remote control the

915
00:40:30,330 --> 00:40:35,069
device<font color="#E5E5E5"> and for example make him to</font>

916
00:40:32,970 --> 00:40:37,230
<font color="#E5E5E5">navigate</font><font color="#CCCCCC"> a specific website or</font><font color="#E5E5E5"> do</font>

917
00:40:35,070 --> 00:40:39,480
something<font color="#E5E5E5"> like</font><font color="#CCCCCC"> that and also Casa web</font>

918
00:40:37,230 --> 00:40:42,090
server<font color="#E5E5E5"> the issue with the web server is</font>

919
00:40:39,480 --> 00:40:43,890
that<font color="#E5E5E5"> at least it has at least one or two</font>

920
00:40:42,090 --> 00:40:47,790
remote code execution<font color="#E5E5E5"> without</font>

921
00:40:43,890 --> 00:40:51,150
authentication<font color="#E5E5E5"> so the chain attack here</font>

922
00:40:47,790 --> 00:40:52,980
is I have<font color="#CCCCCC"> the</font><font color="#E5E5E5"> Western Digital TV plug on</font>

923
00:40:51,150 --> 00:40:57,990
my computer<font color="#E5E5E5"> someone is going to connect</font>

924
00:40:52,980 --> 00:40:59,910
and then we we<font color="#CCCCCC"> is gonna talk the web</font>

925
00:40:57,990 --> 00:41:02,459
server<font color="#E5E5E5"> of the Samba server and he's</font>

926
00:40:59,910 --> 00:41:04,529
gonna write me some<font color="#E5E5E5"> malware on my</font><font color="#CCCCCC"> uma</font>

927
00:41:02,460 --> 00:41:05,820
media on my mass storage device<font color="#E5E5E5"> and I</font>

928
00:41:04,530 --> 00:41:07,680
will then<font color="#E5E5E5"> grab it and put it on my</font>

929
00:41:05,820 --> 00:41:11,640
<font color="#CCCCCC">computer or he's</font><font color="#E5E5E5"> gonna lose something</font>

930
00:41:07,680 --> 00:41:13,649
<font color="#E5E5E5">and he end up</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> in my network</font><font color="#CCCCCC"> so this</font>

931
00:41:11,640 --> 00:41:15,779
was a really really<font color="#E5E5E5"> bad</font><font color="#CCCCCC"> implementation</font>

932
00:41:13,650 --> 00:41:19,590
of Wi-Fi direct<font color="#E5E5E5"> in everybody fault</font><font color="#CCCCCC"> and</font>

933
00:41:15,780 --> 00:41:20,410
no authentication<font color="#E5E5E5"> and no notification so</font>

934
00:41:19,590 --> 00:41:22,540
I can be<font color="#E5E5E5"> looking</font>

935
00:41:20,410 --> 00:41:24,549
movie<font color="#E5E5E5"> and I will never notice something</font>

936
00:41:22,540 --> 00:41:27,730
is using<font color="#E5E5E5"> my device to people and connect</font>

937
00:41:24,550 --> 00:41:29,910
<font color="#CCCCCC">to</font><font color="#E5E5E5"> my network</font><font color="#CCCCCC"> finally I want to</font><font color="#E5E5E5"> talk a</font>

938
00:41:27,730 --> 00:41:34,560
<font color="#CCCCCC">little</font><font color="#E5E5E5"> bit about Android really quickly</font>

939
00:41:29,910 --> 00:41:37,450
<font color="#E5E5E5">this implementation now is working fine</font>

940
00:41:34,560 --> 00:41:39,670
<font color="#CCCCCC">104 that was the first implementation</font>

941
00:41:37,450 --> 00:41:41,740
<font color="#CCCCCC">it cuts</font><font color="#E5E5E5"> on issues but</font><font color="#CCCCCC"> this is a good</font>

942
00:41:39,670 --> 00:41:44,200
<font color="#E5E5E5">example of how complex is the</font>

943
00:41:41,740 --> 00:41:46,750
<font color="#E5E5E5">implementation of a stack of a protocol</font>

944
00:41:44,200 --> 00:41:51,520
when you're talking<font color="#E5E5E5"> about a totally</font>

945
00:41:46,750 --> 00:41:54,610
sorry<font color="#E5E5E5"> 802 hate</font><font color="#CCCCCC"> o 2.11 you're talking</font>

946
00:41:51,520 --> 00:41:57,030
about<font color="#E5E5E5"> code on the film were running on</font>

947
00:41:54,610 --> 00:42:00,190
your network<font color="#CCCCCC"> arm</font><font color="#E5E5E5"> you have a</font><font color="#CCCCCC"> kernel</font><font color="#E5E5E5"> a</font>

948
00:41:57,030 --> 00:42:01,870
driver or kernel module or<font color="#E5E5E5"> kernel</font>

949
00:42:00,190 --> 00:42:03,580
extension depending on your<font color="#E5E5E5"> operation</font>

950
00:42:01,870 --> 00:42:05,650
system and then you have user space

951
00:42:03,580 --> 00:42:09,130
application that they<font color="#E5E5E5"> also</font><font color="#CCCCCC"> are</font>

952
00:42:05,650 --> 00:42:10,780
<font color="#CCCCCC">interacting</font><font color="#E5E5E5"> with the wireless frames in</font>

953
00:42:09,130 --> 00:42:12,550
<font color="#CCCCCC">this case we are</font><font color="#E5E5E5"> going</font><font color="#CCCCCC"> to go ended up</font>

954
00:42:10,780 --> 00:42:15,130
going<font color="#E5E5E5"> to talk about the</font><font color="#CCCCCC"> Alypius</font>

955
00:42:12,550 --> 00:42:18,010
supplicant<font color="#E5E5E5"> and how a frame that</font><font color="#CCCCCC"> goes</font>

956
00:42:15,130 --> 00:42:20,560
through<font color="#E5E5E5"> all these layers</font><font color="#CCCCCC"> end up male</font>

957
00:42:18,010 --> 00:42:23,860
sending an invalid frame<font color="#E5E5E5"> disembodied</font>

958
00:42:20,560 --> 00:42:26,830
frame ends up sending an invalid<font color="#E5E5E5"> he bent</font>

959
00:42:23,860 --> 00:42:30,370
to<font color="#CCCCCC"> the under framework and</font><font color="#E5E5E5"> it will crush</font>

960
00:42:26,830 --> 00:42:33,250
the device so here we have the<font color="#E5E5E5"> Android</font>

961
00:42:30,370 --> 00:42:35,080
implementation on 104<font color="#E5E5E5"> this is quite</font><font color="#CCCCCC"> old</font>

962
00:42:33,250 --> 00:42:37,840
<font color="#E5E5E5">but again it's a really good example to</font>

963
00:42:35,080 --> 00:42:41,799
<font color="#CCCCCC">show the complexity</font><font color="#E5E5E5"> of a protocol and</font>

964
00:42:37,840 --> 00:42:43,990
<font color="#CCCCCC">how you know</font><font color="#E5E5E5"> not only can attack bad</font>

965
00:42:41,800 --> 00:42:48,010
implementations at a logic level but

966
00:42:43,990 --> 00:42:51,759
also exploiting something below so here

967
00:42:48,010 --> 00:42:54,450
if we<font color="#E5E5E5"> receive an event from</font><font color="#CCCCCC"> the</font>

968
00:42:51,760 --> 00:42:59,590
supplicant<font color="#CCCCCC"> and is malformed it will</font>

969
00:42:54,450 --> 00:43:01,330
throw<font color="#E5E5E5"> this exception to the to the to</font>

970
00:42:59,590 --> 00:43:04,120
the Wi-Fi monitor this<font color="#E5E5E5"> is that this in</font>

971
00:43:01,330 --> 00:43:06,460
an<font color="#CCCCCC"> hour class but nobody handle</font><font color="#E5E5E5"> this</font>

972
00:43:04,120 --> 00:43:09,970
<font color="#E5E5E5">this event</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> know when the candle is</font>

973
00:43:06,460 --> 00:43:12,310
this deception<font color="#E5E5E5"> so on a handle exception</font>

974
00:43:09,970 --> 00:43:14,560
on<font color="#CCCCCC"> Android that ends up sending to the</font>

975
00:43:12,310 --> 00:43:18,250
<font color="#CCCCCC">dalvik it will end up like</font>

976
00:43:14,560 --> 00:43:20,410
restarting the dalvik machine so I only

977
00:43:18,250 --> 00:43:22,840
<font color="#E5E5E5">want sending one frame to to an Android</font>

978
00:43:20,410 --> 00:43:25,240
<font color="#E5E5E5">device</font><font color="#CCCCCC"> a Wi-Fi direct frame</font>

979
00:43:22,840 --> 00:43:32,230
<font color="#CCCCCC">crashes the device</font><font color="#E5E5E5"> okay I will try to</font>

980
00:43:25,240 --> 00:43:34,509
show a<font color="#E5E5E5"> demo so this is really quick</font>

981
00:43:32,230 --> 00:43:36,910
I got three different<font color="#E5E5E5"> devices three</font>

982
00:43:34,510 --> 00:43:40,329
<font color="#E5E5E5">different network cards three different</font>

983
00:43:36,910 --> 00:43:42,759
kernels but what happened I<font color="#E5E5E5"> sent</font>

984
00:43:40,329 --> 00:43:44,950
malformed frame the Motorola was<font color="#E5E5E5"> the</font>

985
00:43:42,760 --> 00:43:47,380
first one to<font color="#E5E5E5"> crash then it's going to</font>

986
00:43:44,950 --> 00:43:51,040
<font color="#E5E5E5">crush the solution again it remembers</font>

987
00:43:47,380 --> 00:43:54,730
<font color="#CCCCCC">it's only starting</font><font color="#E5E5E5"> the dalvik VM and</font>

988
00:43:51,040 --> 00:43:58,540
finally the<font color="#E5E5E5"> the</font><font color="#CCCCCC"> Samsung</font><font color="#E5E5E5"> tablet is gonna</font>

989
00:43:54,730 --> 00:44:00,579
be restarted the important here as you

990
00:43:58,540 --> 00:44:03,130
can<font color="#CCCCCC"> see</font><font color="#E5E5E5"> is we are</font><font color="#CCCCCC"> talking the last layer</font>

991
00:44:00,579 --> 00:44:09,130
of<font color="#E5E5E5"> the implementation</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the protocol</font>

992
00:44:03,130 --> 00:44:17,550
implementation were able<font color="#CCCCCC"> to bypass</font><font color="#E5E5E5"> fewer</font>

993
00:44:09,130 --> 00:44:17,550
and kernel implementations so

994
00:44:18,720 --> 00:44:26,049
conclusions our<font color="#E5E5E5"> ability so Wi-Fi direct</font>

995
00:44:22,869 --> 00:44:28,900
is there anyone can find it anyone can

996
00:44:26,050 --> 00:44:31,300
<font color="#E5E5E5">use it as you can see here main vendors</font>

997
00:44:28,900 --> 00:44:33,820
<font color="#E5E5E5">they have bad implementations some of</font>

998
00:44:31,300 --> 00:44:37,150
them<font color="#E5E5E5"> refuse to fix them they</font><font color="#CCCCCC"> say that</font>

999
00:44:33,820 --> 00:44:39,130
there is no dangerous because Wi-Fi you

1000
00:44:37,150 --> 00:44:43,510
have<font color="#CCCCCC"> to</font><font color="#E5E5E5"> be near to attack Wi-Fi so I</font>

1001
00:44:39,130 --> 00:44:47,200
mean it doesn't<font color="#E5E5E5"> matter for me it's a</font>

1002
00:44:43,510 --> 00:44:49,540
problem then<font color="#E5E5E5"> confusion we saw on the</font>

1003
00:44:47,200 --> 00:44:52,089
printer<font color="#CCCCCC"> and</font><font color="#E5E5E5"> another implementation smart</font>

1004
00:44:49,540 --> 00:44:54,190
<font color="#E5E5E5">TV user maybe he doesn't know what is</font>

1005
00:44:52,089 --> 00:44:57,310
<font color="#CCCCCC">going on the printer get crazy a</font><font color="#E5E5E5"> start</font>

1006
00:44:54,190 --> 00:44:59,410
making<font color="#E5E5E5"> noises</font><font color="#CCCCCC"> I go I press a button</font><font color="#E5E5E5"> stop</font>

1007
00:44:57,310 --> 00:45:01,240
making noises<font color="#E5E5E5"> I'm</font><font color="#CCCCCC"> ok</font><font color="#E5E5E5"> but maybe you</font>

1008
00:44:59,410 --> 00:45:03,339
<font color="#E5E5E5">should give access to someone to your</font><font color="#CCCCCC"> to</font>

1009
00:45:01,240 --> 00:45:04,720
printer<font color="#E5E5E5"> or maybe you just someone is</font>

1010
00:45:03,339 --> 00:45:07,029
connecting a new<font color="#CCCCCC"> scenario Smart TV</font>

1011
00:45:04,720 --> 00:45:09,509
<font color="#E5E5E5">because it's not clear how this is</font>

1012
00:45:07,030 --> 00:45:13,119
<font color="#CCCCCC">working on how</font><font color="#E5E5E5"> to use it</font>

1013
00:45:09,510 --> 00:45:15,430
weakest link<font color="#E5E5E5"> if I send a printer</font>

1014
00:45:13,119 --> 00:45:16,930
brute-force attack I know someone is

1015
00:45:15,430 --> 00:45:19,390
<font color="#CCCCCC">getting tired of the printer making</font>

1016
00:45:16,930 --> 00:45:22,169
noises<font color="#CCCCCC"> so he's gonna pack it out of the</font>

1017
00:45:19,390 --> 00:45:25,060
<font color="#E5E5E5">network or plug it out of</font><font color="#CCCCCC"> the net</font><font color="#E5E5E5"> of the</font>

1018
00:45:22,170 --> 00:45:27,069
<font color="#E5E5E5">current or keys he's gonna press the</font>

1019
00:45:25,060 --> 00:45:29,020
button something is going to happen but

1020
00:45:27,069 --> 00:45:32,680
the printing<font color="#E5E5E5"> is not going to be making</font>

1021
00:45:29,020 --> 00:45:35,349
noises<font color="#E5E5E5"> and flashing LEDs for hours and</font>

1022
00:45:32,680 --> 00:45:37,270
<font color="#CCCCCC">finally these devices can be a bridge to</font>

1023
00:45:35,349 --> 00:45:41,200
<font color="#CCCCCC">a secure network so you can have the</font>

1024
00:45:37,270 --> 00:45:44,290
best<font color="#E5E5E5"> IPS the best ideas you can be have</font>

1025
00:45:41,200 --> 00:45:45,390
a really hard<font color="#E5E5E5"> pass phrase you can be</font>

1026
00:45:44,290 --> 00:45:47,340
really really

1027
00:45:45,390 --> 00:45:49,529
<font color="#E5E5E5">read about your while and</font><font color="#CCCCCC"> network</font><font color="#E5E5E5"> but</font>

1028
00:45:47,340 --> 00:45:54,000
then someone put a new printer on the

1029
00:45:49,530 --> 00:45:58,580
<font color="#CCCCCC">office and you are in trouble okay that</font>

1030
00:45:54,000 --> 00:46:02,280
was the<font color="#CCCCCC"> WTB for me one year</font><font color="#E5E5E5"> expose it</font>

1031
00:45:58,580 --> 00:46:04,830
attack surface attack<font color="#CCCCCC"> surfaces again</font>

1032
00:46:02,280 --> 00:46:07,950
<font color="#E5E5E5">every time and the specification is</font>

1033
00:46:04,830 --> 00:46:11,220
applied to a new<font color="#E5E5E5"> device so I might like</font>

1034
00:46:07,950 --> 00:46:13,560
us<font color="#E5E5E5"> something new this</font><font color="#CCCCCC"> is a risk every</font>

1035
00:46:11,220 --> 00:46:15,480
<font color="#CCCCCC">time</font><font color="#E5E5E5"> something some new feature is added</font>

1036
00:46:13,560 --> 00:46:19,259
<font color="#CCCCCC">to your device</font><font color="#E5E5E5"> it has to be implemented</font>

1037
00:46:15,480 --> 00:46:20,790
at a filmer level at a<font color="#CCCCCC"> waist level</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> a</font>

1038
00:46:19,260 --> 00:46:23,190
<font color="#CCCCCC">userland</font><font color="#E5E5E5"> level so you have a lot of</font>

1039
00:46:20,790 --> 00:46:25,110
layer<font color="#E5E5E5"> two attacks</font><font color="#CCCCCC"> to attack and in</font><font color="#E5E5E5"> fact</font>

1040
00:46:23,190 --> 00:46:27,210
if<font color="#E5E5E5"> you see</font><font color="#CCCCCC"> this year there were a lot of</font>

1041
00:46:25,110 --> 00:46:29,940
<font color="#CCCCCC">Broadcom vulnerabilities find by project</font>

1042
00:46:27,210 --> 00:46:31,980
<font color="#CCCCCC">zero and and Nitai that presented</font><font color="#E5E5E5"> a</font>

1043
00:46:29,940 --> 00:46:34,440
<font color="#CCCCCC">black hat USA all these warranties</font><font color="#E5E5E5"> were</font>

1044
00:46:31,980 --> 00:46:37,440
<font color="#E5E5E5">as protein</font><font color="#CCCCCC"> Broadcom fewer</font><font color="#E5E5E5"> broken femur</font>

1045
00:46:34,440 --> 00:46:40,530
cross implemented<font color="#E5E5E5"> Wi-Fi peer-to-peer so</font>

1046
00:46:37,440 --> 00:46:42,750
again these<font color="#CCCCCC"> are extent attack and give</font>

1047
00:46:40,530 --> 00:46:46,740
more<font color="#E5E5E5"> opportunity to attackers to abuse</font>

1048
00:46:42,750 --> 00:46:49,410
or implementation and finally I start

1049
00:46:46,740 --> 00:46:52,439
doing new research on on Wi-Fi<font color="#CCCCCC"> direct</font>

1050
00:46:49,410 --> 00:46:54,270
<font color="#E5E5E5">and I start seeing different components</font>

1051
00:46:52,440 --> 00:46:57,900
<font color="#E5E5E5">that they are</font><font color="#CCCCCC"> putting inside</font><font color="#E5E5E5"> and Bailey</font>

1052
00:46:54,270 --> 00:46:59,940
devices or IOT<font color="#E5E5E5"> devices that cast Wi-Fi</font>

1053
00:46:57,900 --> 00:47:02,090
<font color="#E5E5E5">direct support so I think that</font><font color="#CCCCCC"> this is</font>

1054
00:46:59,940 --> 00:47:08,070
<font color="#E5E5E5">going to get bigger</font><font color="#CCCCCC"> he's not gonna</font><font color="#E5E5E5"> get</font>

1055
00:47:02,090 --> 00:47:10,020
smaller<font color="#E5E5E5"> so</font><font color="#CCCCCC"> thank you thank everyone for</font>

1056
00:47:08,070 --> 00:47:15,630
listening to my<font color="#CCCCCC"> presentation</font>

1057
00:47:10,020 --> 00:47:18,300
I hope you<font color="#CCCCCC"> liked it and here is a big</font>

1058
00:47:15,630 --> 00:47:21,600
hub repository where I<font color="#E5E5E5"> said some tools</font>

1059
00:47:18,300 --> 00:47:23,670
and I have more<font color="#E5E5E5"> information</font><font color="#CCCCCC"> but if</font>

1060
00:47:21,600 --> 00:47:25,980
someone wants to see a live demo<font color="#E5E5E5"> I know</font>

1061
00:47:23,670 --> 00:47:27,630
that this here in this in<font color="#E5E5E5"> this place</font>

1062
00:47:25,980 --> 00:47:30,810
there<font color="#E5E5E5"> are a couple of Wi-Fi direct</font>

1063
00:47:27,630 --> 00:47:33,060
devices<font color="#E5E5E5"> so I can show you a live demo or</font>

1064
00:47:30,810 --> 00:47:35,340
anything<font color="#E5E5E5"> after</font><font color="#CCCCCC"> the presentation of you</font>

1065
00:47:33,060 --> 00:47:37,700
have any questions<font color="#E5E5E5"> I will be happy to</font>

1066
00:47:35,340 --> 00:47:37,700
answer<font color="#CCCCCC"> it</font>

1067
00:47:38,390 --> 00:47:48,580
[Applause]

1068
00:47:50,280 --> 00:47:55,890
no question<font color="#E5E5E5"> too confusing too quick</font><font color="#CCCCCC"> so</font>

1069
00:47:58,710 --> 00:48:08,740
<font color="#CCCCCC">what is worst Wi-Fi direct</font><font color="#E5E5E5"> or Bluetooth</font>

1070
00:48:04,420 --> 00:48:11,350
or<font color="#CCCCCC"> Bluetooth</font><font color="#E5E5E5"> Bluetooth was a</font><font color="#CCCCCC"> mock</font><font color="#E5E5E5"> on</font>

1071
00:48:08,740 --> 00:48:13,779
<font color="#E5E5E5">occasion so I will</font><font color="#CCCCCC"> first turn bluetooth</font>

1072
00:48:11,350 --> 00:48:25,089
<font color="#E5E5E5">out</font><font color="#CCCCCC"> and then I will turn off</font><font color="#E5E5E5"> Wi-Fi</font>

1073
00:48:13,780 --> 00:48:27,070
<font color="#E5E5E5">direct on how many devices could you</font>

1074
00:48:25,090 --> 00:48:28,930
actually<font color="#CCCCCC"> or how many</font><font color="#E5E5E5"> devices could you</font>

1075
00:48:27,070 --> 00:48:30,760
actually<font color="#E5E5E5"> use as a bridge from Wi-Fi</font>

1076
00:48:28,930 --> 00:48:34,020
direct into the internal network without

1077
00:48:30,760 --> 00:48:36,580
<font color="#CCCCCC">having to exploit</font><font color="#E5E5E5"> anything further you</font>

1078
00:48:34,020 --> 00:48:39,670
<font color="#CCCCCC">should find you should search for</font><font color="#E5E5E5"> the</font>

1079
00:48:36,580 --> 00:48:41,759
cross cross connection that is a

1080
00:48:39,670 --> 00:48:45,430
capability<font color="#CCCCCC"> of the peer to peer group I</font>

1081
00:48:41,760 --> 00:48:47,980
saw that there<font color="#E5E5E5"> are some Sony TVs that</font>

1082
00:48:45,430 --> 00:48:51,160
<font color="#CCCCCC">cause this enable so when you build</font>

1083
00:48:47,980 --> 00:48:52,990
appear to be a group<font color="#E5E5E5"> you could use to</font>

1084
00:48:51,160 --> 00:48:56,140
connect<font color="#E5E5E5"> without abusing or exploiting</font>

1085
00:48:52,990 --> 00:48:57,850
the TV in itself<font color="#E5E5E5"> but I only have a</font>

1086
00:48:56,140 --> 00:49:00,609
<font color="#E5E5E5">Samsung TV and the devices I have</font>

1087
00:48:57,850 --> 00:49:03,339
<font color="#E5E5E5">doesn't have cross connection enable so</font>

1088
00:49:00,610 --> 00:49:05,020
to turn<font color="#E5E5E5"> that on</font><font color="#CCCCCC"> I have to route the</font>

1089
00:49:03,340 --> 00:49:10,540
<font color="#CCCCCC">device or modify the implementation</font>

1090
00:49:05,020 --> 00:49:14,470
myself<font color="#E5E5E5"> like maybe I didn't express</font>

1091
00:49:10,540 --> 00:49:17,520
<font color="#CCCCCC">myself clearly on how many</font><font color="#E5E5E5"> devices were</font>

1092
00:49:14,470 --> 00:49:22,660
you able<font color="#CCCCCC"> to enter the network where the</font>

1093
00:49:17,520 --> 00:49:25,500
<font color="#E5E5E5">TV for</font><font color="#CCCCCC"> example</font><font color="#E5E5E5"> is connected by wire over</font>

1094
00:49:22,660 --> 00:49:28,839
Wi-Fi direct<font color="#E5E5E5"> was this possible at all I</font>

1095
00:49:25,500 --> 00:49:31,690
didn't have any device<font color="#CCCCCC"> to try that</font><font color="#E5E5E5"> but</font>

1096
00:49:28,840 --> 00:49:35,170
again<font color="#CCCCCC"> it is not specified on there on</font>

1097
00:49:31,690 --> 00:49:38,590
the on the specification<font color="#E5E5E5"> how to who to</font>

1098
00:49:35,170 --> 00:49:40,900
do that<font color="#E5E5E5"> so it's out of the scope so as</font>

1099
00:49:38,590 --> 00:49:42,340
you saw<font color="#CCCCCC"> on the Samsung Smart TV</font><font color="#E5E5E5"> they</font>

1100
00:49:40,900 --> 00:49:44,410
don't have a solution<font color="#CCCCCC"> for the problem</font>

1101
00:49:42,340 --> 00:49:47,170
they have and implementing<font color="#E5E5E5"> themself</font>

1102
00:49:44,410 --> 00:49:50,140
<font color="#E5E5E5">something it depends on</font><font color="#CCCCCC"> implementation I</font>

1103
00:49:47,170 --> 00:49:53,530
haven't found a device that I could test

1104
00:49:50,140 --> 00:49:56,009
on because I<font color="#E5E5E5"> don't own it</font><font color="#CCCCCC"> but it depends</font>

1105
00:49:53,530 --> 00:49:58,830
on<font color="#E5E5E5"> the moment ation I'm not I can</font>

1106
00:49:56,010 --> 00:50:01,790
at this time<font color="#E5E5E5"> zero devices because I was</font>

1107
00:49:58,830 --> 00:50:01,790
unable<font color="#CCCCCC"> to test it</font>

1108
00:50:08,960 --> 00:50:14,690
<font color="#CCCCCC">oh thank you</font><font color="#E5E5E5"> for your talk</font>

1109
00:50:12,710 --> 00:50:16,760
are we merely talking<font color="#E5E5E5"> about</font>

1110
00:50:14,690 --> 00:50:18,230
implementation flaws or is there

1111
00:50:16,760 --> 00:50:18,460
something<font color="#E5E5E5"> wrong with the protocol as</font>

1112
00:50:18,230 --> 00:50:23,270
well

1113
00:50:18,460 --> 00:50:26,569
no I<font color="#E5E5E5"> only saw implementation issues</font><font color="#CCCCCC"> I</font>

1114
00:50:23,270 --> 00:50:28,819
didn't see any<font color="#E5E5E5"> flaw on the on the</font>

1115
00:50:26,569 --> 00:50:31,430
specification itself<font color="#CCCCCC"> I think that</font><font color="#E5E5E5"> they</font>

1116
00:50:28,819 --> 00:50:33,980
flow in the specification is leaving<font color="#CCCCCC"> a</font>

1117
00:50:31,430 --> 00:50:36,618
<font color="#CCCCCC">lot of</font><font color="#E5E5E5"> things out of scope so the vendor</font>

1118
00:50:33,980 --> 00:50:40,250
have to make their<font color="#E5E5E5"> own solutions and</font>

1119
00:50:36,619 --> 00:50:42,290
sometimes they<font color="#E5E5E5"> are really reusing other</font>

1120
00:50:40,250 --> 00:50:44,569
things for<font color="#E5E5E5"> example the dual EPS</font>

1121
00:50:42,290 --> 00:50:45,950
generation<font color="#E5E5E5"> button that generates pins</font>

1122
00:50:44,569 --> 00:50:47,869
instead<font color="#E5E5E5"> of passphrase</font>

1123
00:50:45,950 --> 00:50:49,669
I think this because they already have

1124
00:50:47,869 --> 00:50:52,569
<font color="#CCCCCC">that Phinney functionality</font><font color="#E5E5E5"> and they</font>

1125
00:50:49,670 --> 00:50:54,920
reuse it<font color="#E5E5E5"> so I</font><font color="#CCCCCC"> think</font><font color="#E5E5E5"> that it's more</font>

1126
00:50:52,569 --> 00:50:57,140
<font color="#E5E5E5">leaving so much things out of the scope</font>

1127
00:50:54,920 --> 00:51:00,910
<font color="#CCCCCC">that is this the issue with</font><font color="#E5E5E5"> the</font>

1128
00:50:57,140 --> 00:51:00,910
specification itself thank you

1129
00:51:06,930 --> 00:51:14,250
<font color="#E5E5E5">Oh so after</font><font color="#CCCCCC"> connecting to the Wi-Fi</font>

1130
00:51:11,579 --> 00:51:16,260
direct connection to<font color="#E5E5E5"> the TV using Wi-Fi</font>

1131
00:51:14,250 --> 00:51:19,650
direct<font color="#E5E5E5"> what could you do</font><font color="#CCCCCC"> like you just</font>

1132
00:51:16,260 --> 00:51:22,559
could first an easy thing you<font color="#E5E5E5"> can</font><font color="#CCCCCC"> do is</font>

1133
00:51:19,650 --> 00:51:25,020
is put<font color="#CCCCCC"> something</font><font color="#E5E5E5"> in the screen because</font>

1134
00:51:22,559 --> 00:51:26,849
you can mirror the screen so you can<font color="#E5E5E5"> use</font>

1135
00:51:25,020 --> 00:51:28,259
<font color="#E5E5E5">your device and mirror or</font><font color="#CCCCCC"> something on</font>

1136
00:51:26,849 --> 00:51:29,819
the screen<font color="#E5E5E5"> so you can take control of</font>

1137
00:51:28,260 --> 00:51:31,500
<font color="#E5E5E5">what is it's</font><font color="#CCCCCC"> playing on the screen</font>

1138
00:51:29,819 --> 00:51:34,200
but<font color="#E5E5E5"> that is not</font><font color="#CCCCCC"> a really interesting</font>

1139
00:51:31,500 --> 00:51:38,220
attack<font color="#E5E5E5"> for me so you should they start</font>

1140
00:51:34,200 --> 00:51:40,859
looking<font color="#E5E5E5"> and</font><font color="#CCCCCC"> two other attacks</font><font color="#E5E5E5"> again this</font>

1141
00:51:38,220 --> 00:51:42,808
is only<font color="#E5E5E5"> like a wolf at directing I'm not</font>

1142
00:51:40,859 --> 00:51:46,200
talking about<font color="#CCCCCC"> plugging the whole device</font>

1143
00:51:42,809 --> 00:51:48,869
and a chain attack but again there was

1144
00:51:46,200 --> 00:51:50,910
<font color="#E5E5E5">some talk I think this year about</font><font color="#CCCCCC"> a guy</font>

1145
00:51:48,869 --> 00:51:54,240
talking<font color="#E5E5E5"> about some some Smart TVs that</font>

1146
00:51:50,910 --> 00:51:55,770
he found several exploits on the on the

1147
00:51:54,240 --> 00:51:58,558
TV once you are<font color="#E5E5E5"> able to connect directly</font>

1148
00:51:55,770 --> 00:52:01,259
on the same network<font color="#CCCCCC"> so if you change</font>

1149
00:51:58,559 --> 00:52:03,210
that with this<font color="#E5E5E5"> you are</font><font color="#CCCCCC"> able to attack it</font>

1150
00:52:01,260 --> 00:52:04,859
remotely<font color="#CCCCCC"> you didn't have to be insane</font>

1151
00:52:03,210 --> 00:52:06,839
the same<font color="#E5E5E5"> network once you have connected</font>

1152
00:52:04,859 --> 00:52:07,920
what for Wi-Fi direct<font color="#CCCCCC"> you're going to be</font>

1153
00:52:06,839 --> 00:52:14,279
able<font color="#E5E5E5"> to exploit this this</font>

1154
00:52:07,920 --> 00:52:17,970
vulnerabilities<font color="#E5E5E5"> hey just a quick</font>

1155
00:52:14,279 --> 00:52:21,720
question from<font color="#E5E5E5"> the from the attacks</font><font color="#CCCCCC"> that</font>

1156
00:52:17,970 --> 00:52:24,660
<font color="#CCCCCC">you exposed the one that it's forcing</font>

1157
00:52:21,720 --> 00:52:26,520
<font color="#E5E5E5">the user</font><font color="#CCCCCC"> or</font><font color="#E5E5E5"> tricking the user to press</font>

1158
00:52:24,660 --> 00:52:29,160
the the VPS button and so on

1159
00:52:26,520 --> 00:52:33,180
and the<font color="#E5E5E5"> other one</font><font color="#CCCCCC"> that you said that you</font>

1160
00:52:29,160 --> 00:52:35,578
<font color="#E5E5E5">were</font><font color="#CCCCCC"> able to</font><font color="#E5E5E5"> clone to</font><font color="#CCCCCC"> the to the</font><font color="#E5E5E5"> map to</font>

1161
00:52:33,180 --> 00:52:37,558
capture the handshake and<font color="#E5E5E5"> see the MAC</font>

1162
00:52:35,579 --> 00:52:41,430
address<font color="#CCCCCC"> and</font><font color="#E5E5E5"> cloning</font><font color="#CCCCCC"> have you been able</font>

1163
00:52:37,559 --> 00:52:45,029
<font color="#E5E5E5">to reproduce this yourself</font><font color="#CCCCCC"> I do it I do</font>

1164
00:52:41,430 --> 00:52:47,788
it on my<font color="#CCCCCC"> own TV with my own phone yes</font>

1165
00:52:45,029 --> 00:52:50,819
<font color="#E5E5E5">you can do it but you need a device</font><font color="#CCCCCC"> to</font>

1166
00:52:47,789 --> 00:52:52,470
connect to the TV<font color="#E5E5E5"> so if in that case</font><font color="#CCCCCC"> if</font>

1167
00:52:50,819 --> 00:52:54,480
nobody is using<font color="#CCCCCC"> the Wi-Fi direct</font>

1168
00:52:52,470 --> 00:52:56,250
functionality<font color="#E5E5E5"> you're not going to be</font>

1169
00:52:54,480 --> 00:52:59,819
able<font color="#E5E5E5"> to exploit it because you need a</font>

1170
00:52:56,250 --> 00:53:02,549
legit it device in the whitelist<font color="#E5E5E5"> okay so</font>

1171
00:52:59,819 --> 00:53:04,049
in the in<font color="#CCCCCC"> that case</font><font color="#E5E5E5"> you're not going to</font>

1172
00:53:02,549 --> 00:53:07,109
be able<font color="#CCCCCC"> to</font><font color="#E5E5E5"> plug it is no one is using</font>

1173
00:53:04,049 --> 00:53:09,599
<font color="#E5E5E5">the service it's like the same as it</font>

1174
00:53:07,109 --> 00:53:12,180
happens with Wi-Fi Mac filtering<font color="#CCCCCC"> I don't</font>

1175
00:53:09,599 --> 00:53:13,950
know<font color="#CCCCCC"> in the 90s with people say</font><font color="#E5E5E5"> okay I</font>

1176
00:53:12,180 --> 00:53:16,379
only<font color="#E5E5E5"> said my MAC address on my network</font>

1177
00:53:13,950 --> 00:53:18,029
<font color="#CCCCCC">until you see the</font><font color="#E5E5E5"> valid net the device</font>

1178
00:53:16,380 --> 00:53:20,700
connecting to a network<font color="#CCCCCC"> you're not gonna</font>

1179
00:53:18,029 --> 00:53:27,119
be able<font color="#E5E5E5"> to connect to the</font><font color="#CCCCCC"> device</font>

1180
00:53:20,700 --> 00:53:31,020
<font color="#E5E5E5">but basic hello okay so basically you're</font>

1181
00:53:27,119 --> 00:53:34,170
just<font color="#E5E5E5"> hoping at the best for someone to</font>

1182
00:53:31,020 --> 00:53:36,089
actually<font color="#E5E5E5"> grant you itself actually oh</font>

1183
00:53:34,170 --> 00:53:38,670
you're on<font color="#E5E5E5"> the team</font><font color="#CCCCCC"> you're waiting for</font>

1184
00:53:36,089 --> 00:53:41,190
someone to connect<font color="#E5E5E5"> yes and even for the</font>

1185
00:53:38,670 --> 00:53:42,930
VPS you're still trying to work waiting

1186
00:53:41,190 --> 00:53:45,150
<font color="#E5E5E5">for someone to push the button hey I'm</font>

1187
00:53:42,930 --> 00:53:47,460
allowing you on a tux I just tried to

1188
00:53:45,150 --> 00:53:51,710
like<font color="#E5E5E5"> brute force the VPS or something</font>

1189
00:53:47,460 --> 00:53:53,970
like<font color="#E5E5E5"> that no I haven't but this is</font>

1190
00:53:51,710 --> 00:53:56,579
something you could<font color="#E5E5E5"> try because it</font>

1191
00:53:53,970 --> 00:53:58,649
depends on implementation again<font color="#E5E5E5"> the UPS</font>

1192
00:53:56,579 --> 00:54:01,040
implementation on on<font color="#CCCCCC"> access</font><font color="#E5E5E5"> point</font><font color="#CCCCCC"> has</font>

1193
00:53:58,650 --> 00:54:04,440
evolved a lot and nowadays<font color="#E5E5E5"> is</font><font color="#CCCCCC"> card -</font>

1194
00:54:01,040 --> 00:54:06,480
bloop -<font color="#CCCCCC"> Lu up in brute-force attack it's</font>

1195
00:54:04,440 --> 00:54:09,990
supposed to<font color="#CCCCCC"> be that in the specification</font>

1196
00:54:06,480 --> 00:54:12,680
<font color="#E5E5E5">it says that you cannot connect to other</font>

1197
00:54:09,990 --> 00:54:15,328
a Wi-Fi detect device you seen a pin

1198
00:54:12,680 --> 00:54:18,328
this is really clarified on the under

1199
00:54:15,329 --> 00:54:20,640
specification one of the things I wanted

1200
00:54:18,329 --> 00:54:23,190
to<font color="#E5E5E5"> test it and I didn't have time is to</font>

1201
00:54:20,640 --> 00:54:25,529
try<font color="#CCCCCC"> to use a pin that</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> on my printer</font>

1202
00:54:23,190 --> 00:54:27,839
<font color="#E5E5E5">and try to use that pin to connect using</font>

1203
00:54:25,530 --> 00:54:31,349
<font color="#E5E5E5">Wi-Fi direct if that is possible</font>

1204
00:54:27,839 --> 00:54:34,828
<font color="#E5E5E5">you have another issue because some some</font>

1205
00:54:31,349 --> 00:54:35,310
printers<font color="#E5E5E5"> also has an NFC tag on the</font>

1206
00:54:34,829 --> 00:54:39,839
printer

1207
00:54:35,310 --> 00:54:42,089
the<font color="#CCCCCC"> gossipin in the in the NFC tag</font><font color="#E5E5E5"> so if</font>

1208
00:54:39,839 --> 00:54:44,520
you are<font color="#CCCCCC"> able to</font><font color="#E5E5E5"> the call house that is</font>

1209
00:54:42,089 --> 00:54:48,089
generated or the WPS implementation is

1210
00:54:44,520 --> 00:54:49,920
not not<font color="#CCCCCC"> not really good and that</font><font color="#E5E5E5"> doesn't</font>

1211
00:54:48,089 --> 00:54:51,450
prevent brute-force attack you're gonna

1212
00:54:49,920 --> 00:54:54,300
be able<font color="#CCCCCC"> to</font><font color="#E5E5E5"> do up in both</font><font color="#CCCCCC"> floors</font><font color="#E5E5E5"> attack</font>

1213
00:54:51,450 --> 00:54:56,700
on a printer or<font color="#CCCCCC"> a</font><font color="#E5E5E5"> TV or anything but it</font>

1214
00:54:54,300 --> 00:55:01,020
depends on how<font color="#E5E5E5"> they implemented WPS</font><font color="#CCCCCC"> I</font>

1215
00:54:56,700 --> 00:55:05,419
haven't tested that<font color="#E5E5E5"> I hope it's good as</font>

1216
00:55:01,020 --> 00:55:05,420
the last access point implementations

1217
00:55:06,500 --> 00:55:09,500
here

1218
00:55:17,480 --> 00:55:24,400
<font color="#E5E5E5">mean</font>

1219
00:55:20,460 --> 00:55:26,710
did you try and so<font color="#CCCCCC"> fasiq fussing yeah I</font>

1220
00:55:24,400 --> 00:55:29,800
play a little<font color="#E5E5E5"> bit not</font><font color="#CCCCCC"> too much</font>

1221
00:55:26,710 --> 00:55:33,540
I the last<font color="#E5E5E5"> thing</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> was starting to do is</font>

1222
00:55:29,800 --> 00:55:36,550
<font color="#E5E5E5">passing the the service discovery</font>

1223
00:55:33,540 --> 00:55:39,610
<font color="#E5E5E5">because I was interested on seeing</font><font color="#CCCCCC"> what</font>

1224
00:55:36,550 --> 00:55:42,100
goes on when<font color="#CCCCCC"> I start standing</font><font color="#E5E5E5"> like we're</font>

1225
00:55:39,610 --> 00:55:43,930
frames<font color="#E5E5E5"> and if it's ended it to an</font>

1226
00:55:42,100 --> 00:55:46,799
internal<font color="#CCCCCC"> service of the printer</font>

1227
00:55:43,930 --> 00:55:49,750
some process<font color="#E5E5E5"> running inside the printer</font>

1228
00:55:46,800 --> 00:55:51,790
<font color="#E5E5E5">but</font><font color="#CCCCCC"> I didn't have too much time to do</font>

1229
00:55:49,750 --> 00:55:56,010
that<font color="#E5E5E5"> but this is something I really</font><font color="#CCCCCC"> want</font>

1230
00:55:51,790 --> 00:55:56,009
<font color="#E5E5E5">to do start</font><font color="#CCCCCC"> passing</font><font color="#E5E5E5"> the implementations</font>

1231
00:56:01,590 --> 00:56:08,090
<font color="#E5E5E5">that's all thank you</font><font color="#CCCCCC"> very much</font>

1232
00:56:04,200 --> 00:56:08,089
[Applause]

