1
00:00:00,030 --> 00:00:04,710
mucho<font color="#E5E5E5"> my name is Eddie Boston and today</font>

2
00:00:02,879 --> 00:00:06,359
with<font color="#CCCCCC"> the</font><font color="#E5E5E5"> help of</font><font color="#CCCCCC"> jean michel</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> jaime</font>

3
00:00:04,710 --> 00:00:10,700
we're going to tell you<font color="#CCCCCC"> about how we</font>

4
00:00:06,359 --> 00:00:13,830
went about attacking encrypted USB keys

5
00:00:10,700 --> 00:00:16,830
so we<font color="#E5E5E5"> simply remain a survey and ask</font>

6
00:00:13,830 --> 00:00:17,699
<font color="#CCCCCC">people who have a</font><font color="#E5E5E5"> USB key</font><font color="#CCCCCC"> wear this to a</font>

7
00:00:16,830 --> 00:00:19,889
corporate data

8
00:00:17,699 --> 00:00:21,240
did you<font color="#CCCCCC"> ever lost one of them odd is one</font>

9
00:00:19,890 --> 00:00:23,130
of them were<font color="#E5E5E5"> stolen and then we had</font>

10
00:00:21,240 --> 00:00:25,380
<font color="#CCCCCC">thirteen percent of the survey</font>

11
00:00:23,130 --> 00:00:28,369
<font color="#CCCCCC">respondents</font><font color="#E5E5E5"> said yes i lost one</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> those</font>

12
00:00:25,380 --> 00:00:32,129
<font color="#E5E5E5">so that means that one way or another</font>

13
00:00:28,369 --> 00:00:34,680
<font color="#CCCCCC">someone will</font><font color="#E5E5E5"> get the hand of your data</font>

14
00:00:32,130 --> 00:00:37,170
<font color="#CCCCCC">suanne</font><font color="#E5E5E5"> encrypted USB key so that</font><font color="#CCCCCC"> begs a</font>

15
00:00:34,680 --> 00:00:39,450
question if<font color="#CCCCCC"> i'm using an encrypted key</font>

16
00:00:37,170 --> 00:00:41,309
is my data<font color="#E5E5E5"> safe am i can i sleep at</font>

17
00:00:39,450 --> 00:00:45,210
<font color="#E5E5E5">night or do</font><font color="#CCCCCC"> i have a leak on my hand</font>

18
00:00:41,309 --> 00:00:49,289
<font color="#E5E5E5">well to</font><font color="#CCCCCC"> answer this question we need to</font>

19
00:00:45,210 --> 00:00:51,719
<font color="#E5E5E5">know ours</font><font color="#CCCCCC"> is encrypted</font><font color="#E5E5E5"> USB key truly</font>

20
00:00:49,289 --> 00:00:53,430
secure and the best way to do that<font color="#CCCCCC"> hey</font>

21
00:00:51,719 --> 00:00:55,530
we<font color="#E5E5E5"> are</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> security conferences to</font>

22
00:00:53,430 --> 00:00:58,440
<font color="#E5E5E5">attend ourself because</font><font color="#CCCCCC"> we couldn't</font><font color="#E5E5E5"> find</font>

23
00:00:55,530 --> 00:01:00,149
<font color="#CCCCCC">online anywho any good methodology</font><font color="#E5E5E5"> or</font>

24
00:00:58,440 --> 00:01:03,059
correct<font color="#CCCCCC"> evaluation of the security of</font>

25
00:01:00,149 --> 00:01:04,739
<font color="#E5E5E5">those so today in the real spirit of</font>

26
00:01:03,059 --> 00:01:07,500
<font color="#E5E5E5">blackhat we're going to show you we</font>

27
00:01:04,739 --> 00:01:09,030
<font color="#E5E5E5">attack against real key is</font><font color="#CCCCCC"> that we found</font>

28
00:01:07,500 --> 00:01:10,830
<font color="#CCCCCC">during</font><font color="#E5E5E5"> our audit and we want to share</font>

29
00:01:09,030 --> 00:01:13,170
with you the journey where<font color="#CCCCCC"> we did it the</font>

30
00:01:10,830 --> 00:01:14,369
key for<font color="#CCCCCC"> our</font><font color="#E5E5E5"> own purposes because</font><font color="#CCCCCC"> we feel</font>

31
00:01:13,170 --> 00:01:16,920
it's<font color="#E5E5E5"> useful</font><font color="#CCCCCC"> for the community as a whole</font>

32
00:01:14,369 --> 00:01:19,229
<font color="#E5E5E5">we also would like your help</font><font color="#CCCCCC"> into making</font>

33
00:01:16,920 --> 00:01:21,360
<font color="#E5E5E5">some</font><font color="#CCCCCC"> of the attack working because some</font>

34
00:01:19,229 --> 00:01:25,020
of<font color="#E5E5E5"> them who are going very</font><font color="#CCCCCC"> very deep</font>

35
00:01:21,360 --> 00:01:26,189
into the hardware required love work<font color="#E5E5E5"> and</font>

36
00:01:25,020 --> 00:01:27,929
<font color="#CCCCCC">the love understanding that we don't</font>

37
00:01:26,189 --> 00:01:30,298
<font color="#CCCCCC">necessarily</font><font color="#E5E5E5"> have and we would</font><font color="#CCCCCC"> love to</font>

38
00:01:27,930 --> 00:01:32,520
get more people<font color="#E5E5E5"> who know the stuff to</font>

39
00:01:30,299 --> 00:01:34,049
<font color="#E5E5E5">help us out so</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> can all have a very</font>

40
00:01:32,520 --> 00:01:35,548
nice methodology so we<font color="#E5E5E5"> shall use the</font>

41
00:01:34,049 --> 00:01:37,079
attack we<font color="#CCCCCC"> have will show you what we are</font>

42
00:01:35,549 --> 00:01:38,880
and<font color="#E5E5E5"> hopefully at the end you will</font><font color="#CCCCCC"> be</font>

43
00:01:37,079 --> 00:01:41,220
inspired<font color="#E5E5E5"> to work with us and all of</font><font color="#CCCCCC"> us</font>

44
00:01:38,880 --> 00:01:42,689
can have a better stronger methodology

45
00:01:41,220 --> 00:01:44,820
for those encrypted<font color="#E5E5E5"> key that we give to</font>

46
00:01:42,689 --> 00:01:49,350
<font color="#CCCCCC">all our user to protect our copyright</font>

47
00:01:44,820 --> 00:01:51,449
data<font color="#E5E5E5"> sounds good yes thank you okay so</font>

48
00:01:49,350 --> 00:01:53,339
to be<font color="#E5E5E5"> to be clear we have the key here</font>

49
00:01:51,450 --> 00:01:55,439
<font color="#CCCCCC">I've</font><font color="#E5E5E5"> started to calm and you can show</font>

50
00:01:53,340 --> 00:01:57,570
you how many<font color="#E5E5E5"> of them we broke we revoke</font>

51
00:01:55,439 --> 00:01:59,520
the selection of those<font color="#CCCCCC"> we'll</font><font color="#E5E5E5"> show you a</font>

52
00:01:57,570 --> 00:02:02,729
few demo as<font color="#CCCCCC"> well we are</font><font color="#E5E5E5"> even live</font>

53
00:01:59,520 --> 00:02:05,429
attacks of<font color="#E5E5E5"> free as iam</font><font color="#CCCCCC"> so let's</font><font color="#E5E5E5"> get</font>

54
00:02:02,729 --> 00:02:09,050
started<font color="#E5E5E5"> by quickly recapping you should</font>

55
00:02:05,430 --> 00:02:11,220
we should<font color="#CCCCCC"> guys's sorry</font>

56
00:02:09,050 --> 00:02:13,980
<font color="#CCCCCC">all right we're going to</font><font color="#E5E5E5"> start with</font>

57
00:02:11,220 --> 00:02:17,400
<font color="#E5E5E5">talking to you about how a encrypted USB</font>

58
00:02:13,980 --> 00:02:20,820
key looks like from inside<font color="#CCCCCC"> ok so this</font><font color="#E5E5E5"> is</font>

59
00:02:17,400 --> 00:02:23,250
the<font color="#E5E5E5"> diagram</font><font color="#CCCCCC"> of it so you have obviously</font>

60
00:02:20,820 --> 00:02:25,560
<font color="#E5E5E5">a USB plug</font><font color="#CCCCCC"> and a PCB where your</font>

61
00:02:23,250 --> 00:02:26,850
electronic<font color="#CCCCCC"> components are then you</font><font color="#E5E5E5"> have</font>

62
00:02:25,560 --> 00:02:29,340
something<font color="#CCCCCC"> which we call</font><font color="#E5E5E5"> the controller</font>

63
00:02:26,850 --> 00:02:30,359
which is<font color="#CCCCCC"> usually a microprocessor which</font>

64
00:02:29,340 --> 00:02:32,760
is also<font color="#E5E5E5"> in</font><font color="#CCCCCC"> charge</font><font color="#E5E5E5"> of doing the</font>

65
00:02:30,360 --> 00:02:35,220
<font color="#E5E5E5">cryptographic operation and ensuring</font>

66
00:02:32,760 --> 00:02:38,220
that your key stays secure and of course

67
00:02:35,220 --> 00:02:40,859
you have the storage<font color="#CCCCCC"> we're used to all</font>

68
00:02:38,220 --> 00:02:42,540
your data<font color="#E5E5E5"> what the extra price that come</font>

69
00:02:40,860 --> 00:02:46,170
from those<font color="#E5E5E5"> keys is obviously the</font>

70
00:02:42,540 --> 00:02:47,760
controller which contains the crypto<font color="#E5E5E5"> and</font>

71
00:02:46,170 --> 00:02:49,890
stuff off<font color="#E5E5E5"> right and then you have some</font>

72
00:02:47,760 --> 00:02:51,420
<font color="#CCCCCC">sort of input mechanism who the</font>

73
00:02:49,890 --> 00:02:53,010
controller<font color="#E5E5E5"> takes input from to know that</font>

74
00:02:51,420 --> 00:02:55,350
you have the right password<font color="#E5E5E5"> maybe a</font>

75
00:02:53,010 --> 00:02:57,929
fingerprint might be a pin code might be

76
00:02:55,350 --> 00:02:59,220
a software might be<font color="#CCCCCC"> rfid tag</font><font color="#E5E5E5"> either way</font>

77
00:02:57,930 --> 00:03:02,670
<font color="#E5E5E5">the controller is the one who is a</font>

78
00:02:59,220 --> 00:03:04,890
gatekeeper of<font color="#E5E5E5"> the data so</font><font color="#CCCCCC"> here's a real</font>

79
00:03:02,670 --> 00:03:06,510
one<font color="#CCCCCC"> same thing right you have the</font>

80
00:03:04,890 --> 00:03:08,489
controller in the middle and then you

81
00:03:06,510 --> 00:03:11,190
<font color="#E5E5E5">have the storage on the right side</font>

82
00:03:08,490 --> 00:03:14,640
exactly<font color="#CCCCCC"> what I described to you</font><font color="#E5E5E5"> we also</font>

83
00:03:11,190 --> 00:03:16,920
see some keys which are more compact<font color="#E5E5E5"> and</font>

84
00:03:14,640 --> 00:03:19,440
where they<font color="#E5E5E5"> actually</font><font color="#CCCCCC"> baked the controller</font>

85
00:03:16,920 --> 00:03:21,329
and<font color="#CCCCCC"> the storage into the same systems</font><font color="#E5E5E5"> so</font>

86
00:03:19,440 --> 00:03:22,800
<font color="#E5E5E5">it's silicon sorry so it's harder to</font>

87
00:03:21,330 --> 00:03:24,990
<font color="#CCCCCC">first to</font><font color="#E5E5E5"> analyze because we can't</font>

88
00:03:22,800 --> 00:03:27,180
<font color="#CCCCCC">obviously get out the chips out to the</font>

89
00:03:24,990 --> 00:03:29,730
<font color="#E5E5E5">hollow-cheeked</font><font color="#CCCCCC"> the thing on the</font><font color="#E5E5E5"> right</font>

90
00:03:27,180 --> 00:03:31,620
<font color="#CCCCCC">side is the</font><font color="#E5E5E5"> fingerprint reader where you</font>

91
00:03:29,730 --> 00:03:35,190
can put your<font color="#E5E5E5"> thumb and</font><font color="#CCCCCC"> then unlock your</font>

92
00:03:31,620 --> 00:03:37,370
key<font color="#E5E5E5"> all</font><font color="#CCCCCC"> right so the first question to</font>

93
00:03:35,190 --> 00:03:39,870
<font color="#CCCCCC">answer is why the hell are we doing a</font>

94
00:03:37,370 --> 00:03:41,790
audit methodology<font color="#E5E5E5"> for security key we</font>

95
00:03:39,870 --> 00:03:46,440
have<font color="#CCCCCC"> the knees right</font><font color="#E5E5E5"> and this health</font>

96
00:03:41,790 --> 00:03:47,850
certification for USB<font color="#CCCCCC"> key so why</font><font color="#E5E5E5"> we</font>

97
00:03:46,440 --> 00:03:49,920
doing<font color="#E5E5E5"> something</font><font color="#CCCCCC"> which already exists and</font>

98
00:03:47,850 --> 00:03:52,230
<font color="#E5E5E5">is working well let me tell you about</font>

99
00:03:49,920 --> 00:03:53,420
the<font color="#CCCCCC"> NIST</font><font color="#E5E5E5"> methodology so you can</font><font color="#CCCCCC"> sit for</font>

100
00:03:52,230 --> 00:03:56,040
<font color="#CCCCCC">yourself</font>

101
00:03:53,420 --> 00:04:00,059
there<font color="#E5E5E5"> is</font><font color="#CCCCCC"> two</font><font color="#E5E5E5"> certification the first one</font>

102
00:03:56,040 --> 00:04:02,340
is<font color="#E5E5E5"> v 140 which is supposed to verify how</font>

103
00:04:00,060 --> 00:04:04,290
cryptographic<font color="#CCCCCC"> operations</font><font color="#E5E5E5"> are done</font>

104
00:04:02,340 --> 00:04:06,000
it's a disclosure process<font color="#E5E5E5"> by every</font>

105
00:04:04,290 --> 00:04:07,500
vendor which is certified<font color="#E5E5E5"> and it's going</font>

106
00:04:06,000 --> 00:04:11,670
<font color="#E5E5E5">to be validated by NIST</font>

107
00:04:07,500 --> 00:04:14,280
there's another one which is<font color="#E5E5E5"> v 197 but</font>

108
00:04:11,670 --> 00:04:15,929
basically<font color="#E5E5E5"> to say I'm using</font><font color="#CCCCCC"> AES so we're</font>

109
00:04:14,280 --> 00:04:19,829
not<font color="#E5E5E5"> going to talk about this one</font>

110
00:04:15,930 --> 00:04:21,450
so<font color="#CCCCCC"> 540</font><font color="#E5E5E5"> well the twittering why we want</font>

111
00:04:19,829 --> 00:04:22,048
<font color="#E5E5E5">something better or actually more</font>

112
00:04:21,450 --> 00:04:24,389
comprehensive

113
00:04:22,048 --> 00:04:26,878
be clear<font color="#E5E5E5"> is</font><font color="#CCCCCC"> because the only interested</font>

114
00:04:24,389 --> 00:04:29,099
<font color="#E5E5E5">into the cryptographic operation that</font>

115
00:04:26,879 --> 00:04:31,830
the key is doing<font color="#E5E5E5"> everything from</font>

116
00:04:29,099 --> 00:04:33,930
manufacturing<font color="#E5E5E5"> to security of the pin</font>

117
00:04:31,830 --> 00:04:35,430
input or everything<font color="#E5E5E5"> like that is not</font>

118
00:04:33,930 --> 00:04:37,349
covered<font color="#CCCCCC"> by certification so there is a</font>

119
00:04:35,430 --> 00:04:38,580
lot of<font color="#E5E5E5"> room and we will see for attack</font>

120
00:04:37,349 --> 00:04:40,199
which are not covered<font color="#CCCCCC"> by the</font>

121
00:04:38,580 --> 00:04:42,719
<font color="#E5E5E5">certifications that's what we would like</font>

122
00:04:40,199 --> 00:04:47,310
<font color="#E5E5E5">and advocating for</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> certification which</font>

123
00:04:42,720 --> 00:04:50,310
<font color="#CCCCCC">is more comprehensive we have another</font>

124
00:04:47,310 --> 00:04:52,889
<font color="#E5E5E5">way to explain</font><font color="#CCCCCC"> that sorry before that</font>

125
00:04:50,310 --> 00:04:55,590
and we<font color="#CCCCCC"> also found we did</font><font color="#E5E5E5"> review those</font>

126
00:04:52,889 --> 00:04:57,449
documents<font color="#CCCCCC"> orally we spend tons of time</font>

127
00:04:55,590 --> 00:04:59,400
looking<font color="#CCCCCC"> into every certification and you</font>

128
00:04:57,449 --> 00:05:03,270
<font color="#CCCCCC">can see</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> here's an example of the</font>

129
00:04:59,400 --> 00:05:05,068
<font color="#E5E5E5">certifications for the iron key and what</font>

130
00:05:03,270 --> 00:05:06,990
<font color="#CCCCCC">it's a</font><font color="#E5E5E5"> little bit concerning for</font><font color="#CCCCCC"> us is</font>

131
00:05:05,069 --> 00:05:08,909
as you can<font color="#CCCCCC"> see is</font><font color="#E5E5E5"> for the iron key</font>

132
00:05:06,990 --> 00:05:11,610
<font color="#E5E5E5">except the documents they were it was</font>

133
00:05:08,909 --> 00:05:14,069
the data<font color="#CCCCCC"> traveler D 4000 so somehow</font>

134
00:05:11,610 --> 00:05:15,930
<font color="#CCCCCC">somewhere</font><font color="#E5E5E5"> is a NIST validation process</font>

135
00:05:14,069 --> 00:05:17,729
failed here and they actually<font color="#CCCCCC"> have a</font>

136
00:05:15,930 --> 00:05:19,710
<font color="#CCCCCC">document which</font><font color="#E5E5E5"> a lot of copy</font><font color="#CCCCCC"> passed</font><font color="#E5E5E5"> and</font>

137
00:05:17,729 --> 00:05:22,080
so we not even<font color="#E5E5E5"> sure the document is</font>

138
00:05:19,710 --> 00:05:23,310
correct<font color="#E5E5E5"> and again this is very hard</font><font color="#CCCCCC"> to</font>

139
00:05:22,080 --> 00:05:24,750
verify<font color="#CCCCCC"> because</font><font color="#E5E5E5"> it's back into</font><font color="#CCCCCC"> the</font>

140
00:05:23,310 --> 00:05:27,389
<font color="#E5E5E5">silicon so we would like</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> have a</font>

141
00:05:24,750 --> 00:05:30,690
little<font color="#CCCCCC"> bit more</font><font color="#E5E5E5"> sort</font><font color="#CCCCCC"> of verification</font>

142
00:05:27,389 --> 00:05:32,219
<font color="#CCCCCC">when document is submitted another way</font>

143
00:05:30,690 --> 00:05:35,419
for<font color="#CCCCCC"> us to summarize</font><font color="#E5E5E5"> what it needs is for</font>

144
00:05:32,219 --> 00:05:37,380
<font color="#E5E5E5">us when we looked at it is this</font>

145
00:05:35,419 --> 00:05:39,840
basically if you trust your<font color="#CCCCCC"> security</font>

146
00:05:37,380 --> 00:05:43,080
<font color="#CCCCCC">needs you are missing a lot of</font><font color="#E5E5E5"> things</font>

147
00:05:39,840 --> 00:05:44,758
who would like to<font color="#E5E5E5"> cover them today</font><font color="#CCCCCC"> so we</font>

148
00:05:43,080 --> 00:05:46,020
come<font color="#CCCCCC"> up</font><font color="#E5E5E5"> with a new methodology</font><font color="#CCCCCC"> and we're</font>

149
00:05:44,759 --> 00:05:47,639
going<font color="#E5E5E5"> to walk</font><font color="#CCCCCC"> through</font><font color="#E5E5E5"> the basic and then</font>

150
00:05:46,020 --> 00:05:49,710
what<font color="#E5E5E5"> goes to a few attacks ways</font><font color="#CCCCCC"> to</font>

151
00:05:47,639 --> 00:05:51,629
illustrate our point<font color="#E5E5E5"> so what was the</font>

152
00:05:49,710 --> 00:05:54,479
<font color="#E5E5E5">first thing we did is we separated the</font>

153
00:05:51,629 --> 00:05:56,250
attackers into<font color="#CCCCCC"> three categories so first</font>

154
00:05:54,479 --> 00:05:58,949
one we call<font color="#CCCCCC"> certainly be tooth attacker</font>

155
00:05:56,250 --> 00:06:00,690
is the opportunistic attacker which has

156
00:05:58,949 --> 00:06:02,490
many<font color="#E5E5E5"> more resources as someone who</font><font color="#CCCCCC"> would</font>

157
00:06:00,690 --> 00:06:04,979
find<font color="#E5E5E5"> a key on the ground or someone who</font>

158
00:06:02,490 --> 00:06:06,389
will grab a key from a desk<font color="#E5E5E5"> and have no</font>

159
00:06:04,979 --> 00:06:08,250
prior knowledge or<font color="#E5E5E5"> it's not very</font>

160
00:06:06,389 --> 00:06:09,990
resourceful and<font color="#CCCCCC"> will try</font><font color="#E5E5E5"> to plug it and</font>

161
00:06:08,250 --> 00:06:11,909
try<font color="#E5E5E5"> to do something</font><font color="#CCCCCC"> probably the most</font>

162
00:06:09,990 --> 00:06:14,460
<font color="#E5E5E5">common</font><font color="#CCCCCC"> type of attacker</font><font color="#E5E5E5"> the second type</font>

163
00:06:11,909 --> 00:06:16,560
of attacker<font color="#CCCCCC"> our professional is a for</font>

164
00:06:14,460 --> 00:06:18,299
hire<font color="#CCCCCC"> or</font><font color="#E5E5E5"> for business</font><font color="#CCCCCC"> the company</font><font color="#E5E5E5"> who</font>

165
00:06:16,560 --> 00:06:20,159
tries to<font color="#E5E5E5"> go and have in-depth knowledge</font>

166
00:06:18,300 --> 00:06:22,169
<font color="#CCCCCC">of how encrypted key works and if there</font>

167
00:06:20,159 --> 00:06:24,629
is an attack they will know how<font color="#E5E5E5"> to carry</font>

168
00:06:22,169 --> 00:06:26,430
it last but<font color="#E5E5E5"> not least we have what we</font>

169
00:06:24,629 --> 00:06:28,469
call<font color="#CCCCCC"> statement or attacker which is a</font>

170
00:06:26,430 --> 00:06:31,050
fancy word<font color="#CCCCCC"> to say someone who</font><font color="#E5E5E5"> really is</font>

171
00:06:28,469 --> 00:06:32,460
<font color="#CCCCCC">after specific data which might</font><font color="#E5E5E5"> be on</font>

172
00:06:31,050 --> 00:06:33,350
the encrypted key whether<font color="#E5E5E5"> a strike a</font>

173
00:06:32,460 --> 00:06:35,659
specific

174
00:06:33,350 --> 00:06:39,200
<font color="#E5E5E5">the cryptographic key or a specific</font>

175
00:06:35,660 --> 00:06:41,330
<font color="#CCCCCC">document or</font><font color="#E5E5E5"> backup data and they will</font>

176
00:06:39,200 --> 00:06:42,830
make a large investment to break a

177
00:06:41,330 --> 00:06:44,719
single<font color="#E5E5E5"> key and the difference between</font>

178
00:06:42,830 --> 00:06:46,159
<font color="#CCCCCC">the professional and</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> state sponsor</font>

179
00:06:44,720 --> 00:06:48,140
is<font color="#CCCCCC"> a</font><font color="#E5E5E5"> size</font><font color="#CCCCCC"> control</font><font color="#E5E5E5"> is more interested</font><font color="#CCCCCC"> in</font>

180
00:06:46,160 --> 00:06:49,580
<font color="#CCCCCC">to</font><font color="#E5E5E5"> breaking one specific key whereas a</font>

181
00:06:48,140 --> 00:06:51,080
professional would be more interested in

182
00:06:49,580 --> 00:06:54,979
<font color="#E5E5E5">breaking as many key as possible</font><font color="#CCCCCC"> right</font>

183
00:06:51,080 --> 00:06:55,969
<font color="#E5E5E5">so two different mindset</font><font color="#CCCCCC"> we also have</font>

184
00:06:54,980 --> 00:06:57,890
three type<font color="#E5E5E5"> of impact</font>

185
00:06:55,970 --> 00:06:59,600
the first one is weakening the security

186
00:06:57,890 --> 00:07:01,130
which<font color="#CCCCCC"> is basically it's</font><font color="#E5E5E5"> not a flow by</font>

187
00:06:59,600 --> 00:07:03,980
itself<font color="#CCCCCC"> but</font><font color="#E5E5E5"> it actually makes our job</font>

188
00:07:01,130 --> 00:07:05,930
easier<font color="#E5E5E5"> as an attacker the second one is</font>

189
00:07:03,980 --> 00:07:07,340
a single<font color="#CCCCCC"> drive break so basically the</font>

190
00:07:05,930 --> 00:07:09,020
attacker you to break one key and

191
00:07:07,340 --> 00:07:11,090
recover some<font color="#CCCCCC"> of the data which is in one</font>

192
00:07:09,020 --> 00:07:12,289
specific<font color="#E5E5E5"> key and the last one is what we</font>

193
00:07:11,090 --> 00:07:15,890
call a full break which<font color="#CCCCCC"> is like the</font>

194
00:07:12,290 --> 00:07:17,690
<font color="#E5E5E5">logical flow inside</font><font color="#CCCCCC"> the key and</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> can</font>

195
00:07:15,890 --> 00:07:19,909
recover<font color="#E5E5E5"> the data from every key which</font>

196
00:07:17,690 --> 00:07:25,160
have the<font color="#CCCCCC"> same model and to</font><font color="#E5E5E5"> the same</font>

197
00:07:19,910 --> 00:07:26,780
making<font color="#E5E5E5"> so what do we want to cover doing</font>

198
00:07:25,160 --> 00:07:28,100
and<font color="#CCCCCC"> see</font><font color="#E5E5E5"> audit there is five categories</font>

199
00:07:26,780 --> 00:07:30,229
that we would like<font color="#CCCCCC"> to cover because we</font>

200
00:07:28,100 --> 00:07:32,210
believe<font color="#CCCCCC"> those five encompasses most</font><font color="#E5E5E5"> of</font>

201
00:07:30,230 --> 00:07:34,370
<font color="#E5E5E5">the attack you</font><font color="#CCCCCC"> can carry out those five</font>

202
00:07:32,210 --> 00:07:36,739
our manufacturing<font color="#E5E5E5"> sector manufacturing</font>

203
00:07:34,370 --> 00:07:38,470
<font color="#CCCCCC">how you manufacture</font><font color="#E5E5E5"> your key such that</font>

204
00:07:36,740 --> 00:07:41,630
it's actually more resilient<font color="#E5E5E5"> to attack</font>

205
00:07:38,470 --> 00:07:43,640
<font color="#E5E5E5">second is input security how do you make</font>

206
00:07:41,630 --> 00:07:46,010
<font color="#CCCCCC">sure that the input part</font><font color="#E5E5E5"> of the key is</font>

207
00:07:43,640 --> 00:07:47,479
<font color="#CCCCCC">actually safe</font><font color="#E5E5E5"> third is a</font><font color="#CCCCCC"> controller</font>

208
00:07:46,010 --> 00:07:49,219
security because obviously you don't

209
00:07:47,480 --> 00:07:52,250
want<font color="#E5E5E5"> the controller to</font><font color="#CCCCCC"> spill your secret</font>

210
00:07:49,220 --> 00:07:55,220
and properly destroy the key third is as

211
00:07:52,250 --> 00:07:56,870
<font color="#CCCCCC">NIST</font><font color="#E5E5E5"> force way as</font><font color="#CCCCCC"> in is a cryptographic</font>

212
00:07:55,220 --> 00:07:58,820
operation make sure that you use correct

213
00:07:56,870 --> 00:08:02,000
crypto<font color="#E5E5E5"> and last but not least you want</font>

214
00:07:58,820 --> 00:08:03,440
<font color="#E5E5E5">to verify storage where you want to make</font>

215
00:08:02,000 --> 00:08:05,990
sure<font color="#E5E5E5"> that</font><font color="#CCCCCC"> the data</font><font color="#E5E5E5"> is really important</font>

216
00:08:03,440 --> 00:08:09,290
on the storage device<font color="#E5E5E5"> all the chips</font>

217
00:08:05,990 --> 00:08:11,060
itself<font color="#E5E5E5"> all right so we're going now to</font>

218
00:08:09,290 --> 00:08:12,050
go<font color="#E5E5E5"> to each of those five in turn and</font>

219
00:08:11,060 --> 00:08:13,790
show you a<font color="#E5E5E5"> bunch of attacks and</font>

220
00:08:12,050 --> 00:08:18,640
<font color="#CCCCCC">johnnesha</font><font color="#E5E5E5"> we'll start with talking about</font>

221
00:08:13,790 --> 00:08:21,320
<font color="#E5E5E5">defensive manufacturing thanks Eddie</font>

222
00:08:18,640 --> 00:08:24,200
so for the manufacturing<font color="#CCCCCC"> the goals we</font>

223
00:08:21,320 --> 00:08:26,780
had in mind during the investigation and

224
00:08:24,200 --> 00:08:29,360
the audit was that it's the first<font color="#E5E5E5"> layer</font>

225
00:08:26,780 --> 00:08:32,478
of protection<font color="#E5E5E5"> you will get because it</font>

226
00:08:29,360 --> 00:08:34,370
will mitigate<font color="#E5E5E5"> other attacks</font><font color="#CCCCCC"> it will slow</font>

227
00:08:32,479 --> 00:08:37,190
down the analysis by hiding the

228
00:08:34,370 --> 00:08:40,130
components and preventing<font color="#CCCCCC"> people from</font>

229
00:08:37,190 --> 00:08:41,990
tampering with the key but it's also the

230
00:08:40,130 --> 00:08:44,540
last layer of protection because<font color="#E5E5E5"> that's</font>

231
00:08:41,990 --> 00:08:46,300
also<font color="#E5E5E5"> what will protect your key</font>

232
00:08:44,540 --> 00:08:48,560
very advanced attacks such as

233
00:08:46,300 --> 00:08:52,339
<font color="#E5E5E5">electromagnetic radiation measurements</font>

234
00:08:48,560 --> 00:08:54,920
with tempest<font color="#CCCCCC"> like attacks during</font><font color="#E5E5E5"> the</font>

235
00:08:52,340 --> 00:08:57,490
audit<font color="#E5E5E5"> we discovered some keys which were</font>

236
00:08:54,920 --> 00:09:00,290
providing some copper shielding and this

237
00:08:57,490 --> 00:09:01,940
<font color="#CCCCCC">copper foil was actually connected to</font>

238
00:09:00,290 --> 00:09:05,660
<font color="#E5E5E5">the ground of</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> USB</font><font color="#CCCCCC"> stick making</font>

239
00:09:01,940 --> 00:09:08,780
making<font color="#E5E5E5"> the protection effective some</font>

240
00:09:05,660 --> 00:09:12,410
other keys were also using some epoxy

241
00:09:08,780 --> 00:09:13,910
<font color="#CCCCCC">like this one which</font><font color="#E5E5E5"> basically prevents</font>

242
00:09:12,410 --> 00:09:16,610
you from reading<font color="#CCCCCC"> what components they</font>

243
00:09:13,910 --> 00:09:20,329
<font color="#CCCCCC">are using and it's quite tedious to</font>

244
00:09:16,610 --> 00:09:24,200
remove that layer of<font color="#E5E5E5"> epoxy</font><font color="#CCCCCC"> we also saw</font>

245
00:09:20,330 --> 00:09:24,800
some<font color="#CCCCCC"> other keys during the audit</font><font color="#E5E5E5"> like</font>

246
00:09:24,200 --> 00:09:28,070
this one

247
00:09:24,800 --> 00:09:30,859
and the coating<font color="#E5E5E5"> didn't look like real</font>

248
00:09:28,070 --> 00:09:33,550
epoxy so I started<font color="#E5E5E5"> using a piece of rag</font>

249
00:09:30,860 --> 00:09:36,440
<font color="#E5E5E5">with some acetone rubbing into it and</font>

250
00:09:33,550 --> 00:09:38,719
the piece<font color="#E5E5E5"> of rag was turning into black</font>

251
00:09:36,440 --> 00:09:41,210
<font color="#E5E5E5">so it seems to</font><font color="#CCCCCC"> be efficient</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> I was</font>

252
00:09:38,720 --> 00:09:44,090
keeping<font color="#CCCCCC"> the key</font><font color="#E5E5E5"> into a bath of acetone</font>

253
00:09:41,210 --> 00:09:49,490
over the night and I ended up<font color="#E5E5E5"> having a</font>

254
00:09:44,090 --> 00:09:53,090
<font color="#CCCCCC">very clean USB stick</font><font color="#E5E5E5"> at the end so be</font>

255
00:09:49,490 --> 00:09:56,660
<font color="#E5E5E5">careful to</font><font color="#CCCCCC"> use real epoxy and on this</font>

256
00:09:53,090 --> 00:09:58,760
one this key was actually certified by

257
00:09:56,660 --> 00:10:00,560
the nest<font color="#CCCCCC"> and on the documentation</font><font color="#E5E5E5"> they</font>

258
00:09:58,760 --> 00:10:02,630
were actually stated that it was coated

259
00:10:00,560 --> 00:10:05,810
in<font color="#E5E5E5"> epoxy which means that the</font><font color="#CCCCCC"> NIST</font>

260
00:10:02,630 --> 00:10:08,540
valued validation process<font color="#E5E5E5"> was</font><font color="#CCCCCC"> failing at</font>

261
00:10:05,810 --> 00:10:11,380
seeing it was not real<font color="#E5E5E5"> epoxy or</font>

262
00:10:08,540 --> 00:10:14,120
validating<font color="#CCCCCC"> that it was real epoxy</font>

263
00:10:11,380 --> 00:10:16,520
another layer of<font color="#E5E5E5"> protection is a</font><font color="#CCCCCC"> leather</font>

264
00:10:14,120 --> 00:10:18,320
etching the references of<font color="#E5E5E5"> the component</font>

265
00:10:16,520 --> 00:10:20,780
<font color="#E5E5E5">even if it means security through</font>

266
00:10:18,320 --> 00:10:22,730
obscurity<font color="#CCCCCC"> it's really hard to</font><font color="#E5E5E5"> find the</font>

267
00:10:20,780 --> 00:10:24,949
data sheets of the USB controller that

268
00:10:22,730 --> 00:10:26,630
are used there<font color="#E5E5E5"> except when they leak so</font>

269
00:10:24,950 --> 00:10:28,790
if you don't have the<font color="#CCCCCC"> reference it will</font>

270
00:10:26,630 --> 00:10:31,460
be very hard to<font color="#E5E5E5"> identify which component</font>

271
00:10:28,790 --> 00:10:33,050
they are actually<font color="#E5E5E5"> using it's hard to see</font>

272
00:10:31,460 --> 00:10:35,510
on<font color="#E5E5E5"> the picture but it's not just a black</font>

273
00:10:33,050 --> 00:10:38,030
marker it's really milled<font color="#CCCCCC"> so the</font>

274
00:10:35,510 --> 00:10:39,140
reference is not there anymore<font color="#E5E5E5"> but</font>

275
00:10:38,030 --> 00:10:43,040
<font color="#E5E5E5">that's an extra cost at the</font>

276
00:10:39,140 --> 00:10:44,930
manufacturing line<font color="#E5E5E5"> type line so you have</font>

277
00:10:43,040 --> 00:10:46,969
to be sure that<font color="#CCCCCC"> you</font><font color="#E5E5E5"> use the</font><font color="#CCCCCC"> right</font>

278
00:10:44,930 --> 00:10:49,550
service because here they pay the extra

279
00:10:46,970 --> 00:10:52,600
for nothing because<font color="#CCCCCC"> we can still see</font><font color="#E5E5E5"> the</font>

280
00:10:49,550 --> 00:10:52,599
<font color="#E5E5E5">references of the continent</font>

281
00:10:53,360 --> 00:10:56,440
another thing that

282
00:10:55,420 --> 00:10:59,170
you have to pay<font color="#E5E5E5"> attention that</font>

283
00:10:56,440 --> 00:11:00,820
manufacturing<font color="#E5E5E5"> is about the debug</font><font color="#CCCCCC"> posts</font>

284
00:10:59,170 --> 00:11:02,410
<font color="#E5E5E5">that</font><font color="#CCCCCC"> I used to test</font><font color="#E5E5E5"> the USB key at the</font>

285
00:11:00,820 --> 00:11:04,690
<font color="#E5E5E5">manufacturing level or during the</font>

286
00:11:02,410 --> 00:11:07,360
development<font color="#CCCCCC"> process</font><font color="#E5E5E5"> and on this one on</font>

287
00:11:04,690 --> 00:11:09,970
the far right<font color="#CCCCCC"> side you can see some pins</font>

288
00:11:07,360 --> 00:11:13,330
some small<font color="#E5E5E5"> solder pads that</font><font color="#CCCCCC"> are there</font>

289
00:11:09,970 --> 00:11:16,330
and labeled<font color="#E5E5E5"> which are actually</font><font color="#CCCCCC"> used as a</font>

290
00:11:13,330 --> 00:11:21,940
debug port and you will see later<font color="#CCCCCC"> on an</font>

291
00:11:16,330 --> 00:11:24,090
attack<font color="#E5E5E5"> leveraging those and so this is</font>

292
00:11:21,940 --> 00:11:26,380
how we<font color="#E5E5E5"> summarize for each category the</font>

293
00:11:24,090 --> 00:11:29,680
different control points that<font color="#CCCCCC"> we have</font>

294
00:11:26,380 --> 00:11:32,770
they are<font color="#E5E5E5"> ordered by the level required</font>

295
00:11:29,680 --> 00:11:39,219
<font color="#E5E5E5">for the attacker and then also by the</font>

296
00:11:32,770 --> 00:11:41,050
impact that it means and now I will let

297
00:11:39,220 --> 00:11:46,600
let<font color="#E5E5E5"> me talk to you about the input</font>

298
00:11:41,050 --> 00:11:48,250
mechanism<font color="#E5E5E5"> thanks Michelle my name is</font>

299
00:11:46,600 --> 00:11:50,440
Remy I'm a software engineer<font color="#E5E5E5"> at Google</font>

300
00:11:48,250 --> 00:11:52,930
<font color="#E5E5E5">and I'll tell you about the security</font><font color="#CCCCCC"> of</font>

301
00:11:50,440 --> 00:11:54,910
the input<font color="#CCCCCC"> mechanism of the keys we</font>

302
00:11:52,930 --> 00:11:57,910
identified<font color="#E5E5E5"> two main</font><font color="#CCCCCC"> components the first</font>

303
00:11:54,910 --> 00:11:59,980
one is<font color="#CCCCCC"> that only</font><font color="#E5E5E5"> all valid users are</font>

304
00:11:57,910 --> 00:12:02,530
able<font color="#E5E5E5"> to unlock the key and I've access</font>

305
00:11:59,980 --> 00:12:04,870
to the data<font color="#E5E5E5"> the second one is that</font><font color="#CCCCCC"> we</font>

306
00:12:02,530 --> 00:12:10,000
should<font color="#CCCCCC"> not be</font><font color="#E5E5E5"> able to add a new user</font><font color="#CCCCCC"> to</font>

307
00:12:04,870 --> 00:12:12,910
<font color="#CCCCCC">the key during</font><font color="#E5E5E5"> the audit we had multiple</font>

308
00:12:10,000 --> 00:12:14,590
kind of input mechanism<font color="#E5E5E5"> on the key</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> we</font>

309
00:12:12,910 --> 00:12:16,810
selected first<font color="#E5E5E5"> one is the PIN pad</font><font color="#CCCCCC"> when</font>

310
00:12:14,590 --> 00:12:18,730
you enter a number<font color="#CCCCCC"> and</font><font color="#E5E5E5"> then you want the</font>

311
00:12:16,810 --> 00:12:20,979
key you get access to the data the

312
00:12:18,730 --> 00:12:23,970
second is using<font color="#E5E5E5"> a badge</font><font color="#CCCCCC"> you swipe the</font>

313
00:12:20,980 --> 00:12:26,080
badge<font color="#CCCCCC"> and it unlocks the</font><font color="#E5E5E5"> dastar</font><font color="#CCCCCC"> drive</font>

314
00:12:23,970 --> 00:12:28,150
then we have the fingerprint reader

315
00:12:26,080 --> 00:12:30,970
<font color="#E5E5E5">something</font><font color="#CCCCCC"> you put your finger on</font><font color="#E5E5E5"> the</font>

316
00:12:28,150 --> 00:12:34,660
fingerprint sensor<font color="#CCCCCC"> it unlocks</font><font color="#E5E5E5"> the drive</font>

317
00:12:30,970 --> 00:12:37,150
and last is a<font color="#CCCCCC"> software-based</font><font color="#E5E5E5"> so you plug</font>

318
00:12:34,660 --> 00:12:39,310
the key and<font color="#E5E5E5"> you have a first partition</font>

319
00:12:37,150 --> 00:12:41,350
that pops out that gives you a<font color="#E5E5E5"> software</font>

320
00:12:39,310 --> 00:12:44,829
in which you can enter<font color="#CCCCCC"> a password</font><font color="#E5E5E5"> and</font>

321
00:12:41,350 --> 00:12:46,300
when you when you type enter it will

322
00:12:44,830 --> 00:12:50,560
<font color="#E5E5E5">unlock the</font><font color="#CCCCCC"> key if you gave the right</font>

323
00:12:46,300 --> 00:12:52,870
password<font color="#E5E5E5"> let me tell you about the first</font>

324
00:12:50,560 --> 00:12:55,569
attack we found during<font color="#E5E5E5"> the</font><font color="#CCCCCC"> audit</font><font color="#E5E5E5"> it</font>

325
00:12:52,870 --> 00:12:59,470
<font color="#E5E5E5">targets a fingerprint based key</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> which</font>

326
00:12:55,570 --> 00:13:01,120
we can<font color="#E5E5E5"> replay an</font><font color="#CCCCCC"> analog command the</font>

327
00:12:59,470 --> 00:13:03,160
impact of<font color="#E5E5E5"> this attack is a fulbright</font>

328
00:13:01,120 --> 00:13:06,550
meaning we can<font color="#E5E5E5"> actually recover the data</font>

329
00:13:03,160 --> 00:13:08,279
of<font color="#E5E5E5"> all the key of this model and we</font><font color="#CCCCCC"> rate</font>

330
00:13:06,550 --> 00:13:10,949
this<font color="#CCCCCC"> attackers</font>

331
00:13:08,279 --> 00:13:15,149
by the professional as required<font color="#CCCCCC"> a few</font>

332
00:13:10,949 --> 00:13:17,519
<font color="#E5E5E5">tools this kind of attack is not new</font><font color="#CCCCCC"> and</font>

333
00:13:15,149 --> 00:13:20,100
actually<font color="#CCCCCC"> in 2010</font><font color="#E5E5E5"> another model of</font><font color="#CCCCCC"> key</font>

334
00:13:17,519 --> 00:13:22,800
was fun venerable where you could

335
00:13:20,100 --> 00:13:26,850
recover the data<font color="#CCCCCC"> without knowing the</font>

336
00:13:22,800 --> 00:13:28,800
<font color="#CCCCCC">password here is the new model to</font>

337
00:13:26,850 --> 00:13:30,839
fingerprint-based<font color="#E5E5E5"> is what the finger you</font>

338
00:13:28,800 --> 00:13:34,410
and all the key when you open the shell

339
00:13:30,839 --> 00:13:36,689
<font color="#CCCCCC">you get this</font><font color="#E5E5E5"> PCB on</font><font color="#CCCCCC"> the left you have</font>

340
00:13:34,410 --> 00:13:38,999
<font color="#E5E5E5">the USB controller then on the right</font><font color="#CCCCCC"> you</font>

341
00:13:36,689 --> 00:13:41,399
<font color="#CCCCCC">got the fingerprint sensor and then</font><font color="#E5E5E5"> the</font>

342
00:13:38,999 --> 00:13:45,029
file right<font color="#E5E5E5"> you see see the screen and</font>

343
00:13:41,399 --> 00:13:48,509
pins with the<font color="#E5E5E5"> label of a debug</font><font color="#CCCCCC"> port</font><font color="#E5E5E5"> so</font>

344
00:13:45,029 --> 00:13:52,499
you've got USB if<font color="#E5E5E5"> that</font><font color="#CCCCCC"> clock</font><font color="#E5E5E5"> and you</font>

345
00:13:48,509 --> 00:13:55,769
also got Rx and TX D which are a serial

346
00:13:52,499 --> 00:13:58,980
line so<font color="#E5E5E5"> we mapped the PCB</font><font color="#CCCCCC"> and here is</font>

347
00:13:55,769 --> 00:14:01,050
<font color="#E5E5E5">the logic diagram of the key the sensor</font>

348
00:13:58,980 --> 00:14:03,209
is connected to a fingerprint<font color="#E5E5E5"> monitor</font>

349
00:14:01,050 --> 00:14:06,769
the finger<font color="#E5E5E5"> prick</font><font color="#CCCCCC"> metal reads</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> thing</font>

350
00:14:03,209 --> 00:14:09,569
<font color="#CCCCCC">and</font><font color="#E5E5E5"> played this fingerprint reader is</font>

351
00:14:06,769 --> 00:14:11,459
controlled by the USB<font color="#E5E5E5"> controller over</font>

352
00:14:09,569 --> 00:14:12,930
the serial line and<font color="#E5E5E5"> is the USB</font>

353
00:14:11,459 --> 00:14:16,550
controller<font color="#E5E5E5"> that's responsible for</font>

354
00:14:12,930 --> 00:14:20,699
<font color="#E5E5E5">unlocking the storage and decrypting it</font>

355
00:14:16,550 --> 00:14:21,959
can see we<font color="#CCCCCC"> found a serial</font><font color="#E5E5E5"> design</font><font color="#CCCCCC"> flaw in</font>

356
00:14:20,699 --> 00:14:24,300
the serial line because it was not

357
00:14:21,959 --> 00:14:28,500
protected<font color="#CCCCCC"> and</font><font color="#E5E5E5"> we were able to with what</font>

358
00:14:24,300 --> 00:14:30,420
was sent up as a serial line here is a

359
00:14:28,500 --> 00:14:32,449
<font color="#E5E5E5">picture of the attack we started we by</font>

360
00:14:30,420 --> 00:14:35,370
playing the key on our<font color="#E5E5E5"> computer</font>

361
00:14:32,449 --> 00:14:38,699
soldering some<font color="#CCCCCC"> paint</font><font color="#E5E5E5"> some wire on the</font>

362
00:14:35,370 --> 00:14:42,209
debug pins and then<font color="#CCCCCC"> worried that</font><font color="#E5E5E5"> to a</font>

363
00:14:38,699 --> 00:14:43,889
serial port here disparate and we

364
00:14:42,209 --> 00:14:46,018
<font color="#CCCCCC">conducted the attack by simply using the</font>

365
00:14:43,889 --> 00:14:48,720
<font color="#E5E5E5">key normally and using the post pirate</font>

366
00:14:46,019 --> 00:14:52,079
<font color="#E5E5E5">we read what was going on on the</font><font color="#CCCCCC"> still</font>

367
00:14:48,720 --> 00:14:55,550
line when<font color="#E5E5E5"> we swiped our involved finger</font>

368
00:14:52,079 --> 00:14:58,199
<font color="#E5E5E5">and what we saw was a static command</font>

369
00:14:55,550 --> 00:15:01,639
saying which was the number<font color="#CCCCCC"> we</font><font color="#E5E5E5"> swiped</font>

370
00:14:58,199 --> 00:15:04,139
just<font color="#CCCCCC"> a number</font><font color="#E5E5E5"> non finger number</font><font color="#CCCCCC"> zero</font>

371
00:15:01,639 --> 00:15:06,779
then we<font color="#CCCCCC"> unplugged the key put</font><font color="#E5E5E5"> it back</font>

372
00:15:04,139 --> 00:15:08,639
again<font color="#E5E5E5"> and using the best pirate to write</font>

373
00:15:06,779 --> 00:15:11,610
the exact same command we saw the first

374
00:15:08,639 --> 00:15:14,870
<font color="#E5E5E5">time and it would</font><font color="#CCCCCC"> unlock the key</font><font color="#E5E5E5"> let me</font>

375
00:15:11,610 --> 00:15:14,870
show you a small video<font color="#E5E5E5"> of the attack</font>

376
00:15:16,640 --> 00:15:22,069
so on<font color="#CCCCCC"> the laptop on</font><font color="#E5E5E5"> the left you see the</font>

377
00:15:19,070 --> 00:15:25,910
<font color="#E5E5E5">actual command</font><font color="#CCCCCC"> that you have to send</font>

378
00:15:22,070 --> 00:15:30,800
over<font color="#E5E5E5"> UART playing the key</font><font color="#CCCCCC"> blue light</font>

379
00:15:25,910 --> 00:15:34,850
<font color="#E5E5E5">wiring the best pirate on the right you</font>

380
00:15:30,800 --> 00:15:38,660
got the windows top<font color="#CCCCCC"> I sang</font><font color="#E5E5E5"> the command</font>

381
00:15:34,850 --> 00:15:41,300
<font color="#E5E5E5">and you see the partition got</font><font color="#CCCCCC"> opened</font><font color="#E5E5E5"> on</font>

382
00:15:38,660 --> 00:15:49,910
<font color="#E5E5E5">the windows with access</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> all the data</font>

383
00:15:41,300 --> 00:15:52,760
<font color="#CCCCCC">without using</font><font color="#E5E5E5"> the fingerprints during</font>

384
00:15:49,910 --> 00:15:56,630
the audit<font color="#E5E5E5"> we found another attack which</font>

385
00:15:52,760 --> 00:15:59,089
<font color="#E5E5E5">was that the input tag of the USB hard</font>

386
00:15:56,630 --> 00:16:02,209
<font color="#E5E5E5">drive could be cloned and the impact of</font>

387
00:15:59,089 --> 00:16:04,910
this attack is only a<font color="#E5E5E5"> single dry because</font>

388
00:16:02,209 --> 00:16:07,579
you<font color="#E5E5E5"> cloned the tag of the drive</font><font color="#CCCCCC"> you want</font>

389
00:16:04,910 --> 00:16:09,500
<font color="#CCCCCC">to</font><font color="#E5E5E5"> attack and as it also requires some</font>

390
00:16:07,579 --> 00:16:12,859
tool<font color="#E5E5E5"> we rate the attacker as</font>

391
00:16:09,500 --> 00:16:14,810
professional here is the venerable model

392
00:16:12,860 --> 00:16:18,560
along with<font color="#CCCCCC"> the tag</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> you have to</font>

393
00:16:14,810 --> 00:16:20,959
swipe<font color="#CCCCCC"> to unlock the drive when you open</font>

394
00:16:18,560 --> 00:16:22,579
the drive you<font color="#E5E5E5"> have this PCB with the</font>

395
00:16:20,959 --> 00:16:24,310
SATA port<font color="#E5E5E5"> that's used to connect to the</font>

396
00:16:22,579 --> 00:16:28,399
actual hardware that will<font color="#E5E5E5"> be encrypted</font>

397
00:16:24,310 --> 00:16:30,949
the RFID call used to read the tag with

398
00:16:28,399 --> 00:16:34,430
its<font color="#E5E5E5"> little controller and the</font>

399
00:16:30,949 --> 00:16:37,430
<font color="#CCCCCC">configuration and to</font><font color="#E5E5E5"> conduct the attack</font>

400
00:16:34,430 --> 00:16:40,459
you need an RFID research tool here it's

401
00:16:37,430 --> 00:16:44,750
a proxmark<font color="#E5E5E5"> and</font><font color="#CCCCCC"> reprogrammable rfid tag</font>

402
00:16:40,459 --> 00:16:47,319
<font color="#E5E5E5">it will be used to</font><font color="#CCCCCC"> clone the tag here's</font>

403
00:16:44,750 --> 00:16:47,320
a<font color="#CCCCCC"> video</font><font color="#E5E5E5"> of the attack</font>

404
00:16:51,200 --> 00:16:56,880
here is the oven USB<font color="#CCCCCC"> Drive</font><font color="#E5E5E5"> red light</font>

405
00:16:54,600 --> 00:17:00,770
<font color="#E5E5E5">means it's locked and we will use the</font>

406
00:16:56,880 --> 00:17:00,770
real tag<font color="#E5E5E5"> green light it's unlocked</font>

407
00:17:01,820 --> 00:17:07,589
using the RFID research tool<font color="#E5E5E5"> we read the</font>

408
00:17:05,579 --> 00:17:16,349
content of the tag and write the content

409
00:17:07,589 --> 00:17:21,119
back into the reprogrammable tag as you

410
00:17:16,349 --> 00:17:25,230
can see<font color="#E5E5E5"> it's</font><font color="#CCCCCC"> pretty fast and then using</font>

411
00:17:21,119 --> 00:17:28,229
<font color="#E5E5E5">our custom tag we swipe it just like the</font>

412
00:17:25,230 --> 00:17:29,730
real one and you see green light<font color="#E5E5E5"> the</font>

413
00:17:28,230 --> 00:17:35,010
drive is unlocked<font color="#E5E5E5"> we've got access</font><font color="#CCCCCC"> to</font>

414
00:17:29,730 --> 00:17:40,590
<font color="#CCCCCC">all the data summing up for the input</font>

415
00:17:35,010 --> 00:17:42,660
<font color="#CCCCCC">I detect</font><font color="#E5E5E5"> area we found the one in bold</font>

416
00:17:40,590 --> 00:17:45,678
are the one we<font color="#CCCCCC"> actually found attacks</font>

417
00:17:42,660 --> 00:17:47,820
against and we models are vulnerable

418
00:17:45,679 --> 00:17:50,010
which are the unlock<font color="#CCCCCC"> command can be</font>

419
00:17:47,820 --> 00:17:54,000
<font color="#E5E5E5">replayed and we found an attack where</font>

420
00:17:50,010 --> 00:17:56,460
the<font color="#E5E5E5"> input could be cloned</font><font color="#CCCCCC"> summing up</font>

421
00:17:54,000 --> 00:18:00,809
with the impact and the<font color="#CCCCCC"> kind</font><font color="#E5E5E5"> of attacker</font>

422
00:17:56,460 --> 00:18:03,210
that can<font color="#E5E5E5"> connect</font><font color="#CCCCCC"> D the attack</font><font color="#E5E5E5"> moving on</font>

423
00:18:00,809 --> 00:18:06,920
<font color="#CCCCCC">I'll let Elliot</font><font color="#E5E5E5"> talk to you about the</font>

424
00:18:03,210 --> 00:18:11,730
security<font color="#CCCCCC"> of the controller in USB keys</font>

425
00:18:06,920 --> 00:18:13,170
Thank You Jaime<font color="#E5E5E5"> so the third part we</font>

426
00:18:11,730 --> 00:18:14,970
want to cover a<font color="#CCCCCC"> thermoset is a</font>

427
00:18:13,170 --> 00:18:18,390
controller which<font color="#CCCCCC"> is kind of a</font><font color="#E5E5E5"> brain</font><font color="#CCCCCC"> of</font>

428
00:18:14,970 --> 00:18:21,150
the key and here we have many<font color="#E5E5E5"> goals</font>

429
00:18:18,390 --> 00:18:24,059
<font color="#E5E5E5">because that's the place where most of</font>

430
00:18:21,150 --> 00:18:26,130
<font color="#E5E5E5">the security happen the first one is and</font>

431
00:18:24,059 --> 00:18:28,620
it seems<font color="#E5E5E5"> obvious but you'll see we have</font>

432
00:18:26,130 --> 00:18:30,120
some attack against it is<font color="#E5E5E5"> the controller</font>

433
00:18:28,620 --> 00:18:31,830
is is<font color="#E5E5E5"> supposed</font><font color="#CCCCCC"> to protect your</font><font color="#E5E5E5"> secret</font>

434
00:18:30,120 --> 00:18:35,370
<font color="#CCCCCC">which means the controller should never</font>

435
00:18:31,830 --> 00:18:37,290
<font color="#E5E5E5">leak your password or</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> AES key that</font>

436
00:18:35,370 --> 00:18:40,500
seems<font color="#CCCCCC"> obvious but somehow some people</font>

437
00:18:37,290 --> 00:18:42,120
fail at it the second<font color="#E5E5E5"> thing is you</font>

438
00:18:40,500 --> 00:18:43,710
<font color="#E5E5E5">expect the controller to</font><font color="#CCCCCC"> lock the drive</font>

439
00:18:42,120 --> 00:18:45,510
when it's needed<font color="#E5E5E5"> meaning if you unplug</font>

440
00:18:43,710 --> 00:18:47,580
<font color="#E5E5E5">the drive</font><font color="#CCCCCC"> well the drive should</font><font color="#E5E5E5"> be</font>

441
00:18:45,510 --> 00:18:50,910
locked<font color="#E5E5E5"> and if you have a</font><font color="#CCCCCC"> glitch on the</font>

442
00:18:47,580 --> 00:18:52,860
USB<font color="#E5E5E5"> port it should lock itself and so</font>

443
00:18:50,910 --> 00:18:56,790
forth<font color="#E5E5E5"> and</font><font color="#CCCCCC"> so forth so we</font><font color="#E5E5E5"> expect it to do</font>

444
00:18:52,860 --> 00:19:00,178
that<font color="#E5E5E5"> we also expect the drive to destroy</font>

445
00:18:56,790 --> 00:19:02,040
secrets<font color="#E5E5E5"> at least your zero out the AES</font>

446
00:19:00,179 --> 00:19:03,190
key so<font color="#CCCCCC"> that</font><font color="#E5E5E5"> the drive become unusable</font>

447
00:19:02,040 --> 00:19:06,190
when it's under

448
00:19:03,190 --> 00:19:08,440
after a few<font color="#CCCCCC"> statistics and successful</font>

449
00:19:06,190 --> 00:19:11,800
attempt you<font color="#CCCCCC"> will imagine</font><font color="#E5E5E5"> again that is</font>

450
00:19:08,440 --> 00:19:14,980
something<font color="#CCCCCC"> that is granted turns</font><font color="#E5E5E5"> out it's</font>

451
00:19:11,800 --> 00:19:17,260
not and last but not least<font color="#E5E5E5"> and this</font><font color="#CCCCCC"> is</font>

452
00:19:14,980 --> 00:19:19,750
more<font color="#E5E5E5"> like wishful thinking</font><font color="#CCCCCC"> we would</font><font color="#E5E5E5"> like</font>

453
00:19:17,260 --> 00:19:22,420
to<font color="#E5E5E5"> have a few more attestation meaning</font>

454
00:19:19,750 --> 00:19:24,370
today<font color="#E5E5E5"> there is no guarantees that there</font>

455
00:19:22,420 --> 00:19:25,840
<font color="#E5E5E5">is not a way to have</font><font color="#CCCCCC"> a backdoor</font>

456
00:19:24,370 --> 00:19:28,330
framework we<font color="#E5E5E5"> have no way to attest that</font>

457
00:19:25,840 --> 00:19:30,520
the theme we're<font color="#E5E5E5"> running to those key is</font>

458
00:19:28,330 --> 00:19:32,560
really<font color="#E5E5E5"> the one we can</font><font color="#CCCCCC"> owed it because we</font>

459
00:19:30,520 --> 00:19:35,020
have<font color="#E5E5E5"> no way</font><font color="#CCCCCC"> to have similar stations we</font>

460
00:19:32,560 --> 00:19:37,330
would like in the<font color="#E5E5E5"> future to have key who</font>

461
00:19:35,020 --> 00:19:39,790
are fully attested<font color="#CCCCCC"> semi</font><font color="#E5E5E5"> very very</font>

462
00:19:37,330 --> 00:19:42,520
similar<font color="#E5E5E5"> to the secure Enclave that</font><font color="#CCCCCC"> we</font>

463
00:19:39,790 --> 00:19:43,570
start to deploy<font color="#E5E5E5"> into India right we</font>

464
00:19:42,520 --> 00:19:45,970
would actually<font color="#CCCCCC"> something for the key</font>

465
00:19:43,570 --> 00:19:48,010
<font color="#E5E5E5">because</font><font color="#CCCCCC"> we can't trust that</font><font color="#E5E5E5"> the key is</font>

466
00:19:45,970 --> 00:19:49,510
really<font color="#E5E5E5"> operating the</font><font color="#CCCCCC"> same oh we have so</font>

467
00:19:48,010 --> 00:19:53,170
hopefully<font color="#E5E5E5"> that's going to be the next</font>

468
00:19:49,510 --> 00:19:56,230
generations so the way we we do some of

469
00:19:53,170 --> 00:19:58,060
the analysis<font color="#CCCCCC"> and a</font><font color="#E5E5E5"> little bit of the</font>

470
00:19:56,230 --> 00:20:00,190
<font color="#CCCCCC">behind the scenes</font><font color="#E5E5E5"> stuff is we we do a</font>

471
00:19:58,060 --> 00:20:02,200
lot<font color="#CCCCCC"> of interceptions</font><font color="#E5E5E5"> we'll talk about</font>

472
00:20:00,190 --> 00:20:04,870
how<font color="#E5E5E5"> we do an intersection between</font><font color="#CCCCCC"> the</font>

473
00:20:02,200 --> 00:20:06,460
<font color="#CCCCCC">memory and the contrary little</font><font color="#E5E5E5"> later on</font>

474
00:20:04,870 --> 00:20:08,919
<font color="#CCCCCC">so</font><font color="#E5E5E5"> Michel will told you about that but</font>

475
00:20:06,460 --> 00:20:11,080
we also do intersection between the key

476
00:20:08,920 --> 00:20:12,430
and<font color="#E5E5E5"> the computer and</font><font color="#CCCCCC"> which monitor what</font>

477
00:20:11,080 --> 00:20:14,080
<font color="#CCCCCC">happened the</font><font color="#E5E5E5"> reason why we do it at the</font>

478
00:20:12,430 --> 00:20:15,640
<font color="#E5E5E5">hardware level is because we really</font><font color="#CCCCCC"> want</font>

479
00:20:14,080 --> 00:20:17,530
to make<font color="#CCCCCC"> sure</font><font color="#E5E5E5"> we see everything happening</font>

480
00:20:15,640 --> 00:20:19,630
<font color="#E5E5E5">on the USB bus to make sure we don't</font>

481
00:20:17,530 --> 00:20:21,340
miss anything<font color="#CCCCCC"> it seems a little</font><font color="#E5E5E5"> bit of a</font>

482
00:20:19,630 --> 00:20:22,840
<font color="#E5E5E5">cure but turns out we found a very cool</font>

483
00:20:21,340 --> 00:20:23,800
attack that I'm going to<font color="#E5E5E5"> demonstrate</font><font color="#CCCCCC"> to</font>

484
00:20:22,840 --> 00:20:26,459
you in a second

485
00:20:23,800 --> 00:20:29,350
by doing<font color="#CCCCCC"> this kind</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> interception and</font>

486
00:20:26,460 --> 00:20:31,210
maybe this to show<font color="#E5E5E5"> you what happened in</font>

487
00:20:29,350 --> 00:20:33,909
practice<font color="#CCCCCC"> this is what it looked like so</font>

488
00:20:31,210 --> 00:20:37,090
<font color="#CCCCCC">we have in this blue box is actually a</font>

489
00:20:33,910 --> 00:20:39,240
crystal is a dedicated hardware which<font color="#CCCCCC"> or</font>

490
00:20:37,090 --> 00:20:41,949
you to do interception<font color="#E5E5E5"> of USB traffic</font>

491
00:20:39,240 --> 00:20:43,540
full-speed event<font color="#E5E5E5"> for USB</font><font color="#CCCCCC"> 3 which is very</font>

492
00:20:41,950 --> 00:20:45,940
difficult<font color="#CCCCCC"> you</font><font color="#E5E5E5"> choose the timing and the</font>

493
00:20:43,540 --> 00:20:48,040
<font color="#CCCCCC">speed and it basically</font><font color="#E5E5E5"> has three ports</font>

494
00:20:45,940 --> 00:20:49,780
one you connect your keep so that's one

495
00:20:48,040 --> 00:20:52,120
of<font color="#CCCCCC"> the</font><font color="#E5E5E5"> key we connected to it and then</font>

496
00:20:49,780 --> 00:20:54,610
the second cable<font color="#E5E5E5"> and the phone goes to</font>

497
00:20:52,120 --> 00:20:55,989
the target laptop or take a desktop we

498
00:20:54,610 --> 00:20:58,240
use a laptop<font color="#E5E5E5"> because it's easier to put</font>

499
00:20:55,990 --> 00:21:01,000
<font color="#E5E5E5">on the desk next</font><font color="#CCCCCC"> for desktop sessions</font>

500
00:20:58,240 --> 00:21:02,350
and<font color="#E5E5E5"> then the cable at the back go to our</font>

501
00:21:01,000 --> 00:21:04,060
<font color="#E5E5E5">desktop station</font><font color="#CCCCCC"> where we do the</font>

502
00:21:02,350 --> 00:21:06,879
<font color="#E5E5E5">recording and we do the analysis and we</font>

503
00:21:04,060 --> 00:21:08,500
use custom software for that so that's

504
00:21:06,880 --> 00:21:10,630
what our interception platform look like

505
00:21:08,500 --> 00:21:12,220
and we've been<font color="#CCCCCC"> running it on every key</font>

506
00:21:10,630 --> 00:21:13,200
we have<font color="#E5E5E5"> all the</font><font color="#CCCCCC"> debt to make</font><font color="#E5E5E5"> sure that</font>

507
00:21:12,220 --> 00:21:15,149
<font color="#E5E5E5">we understand exactly</font>

508
00:21:13,200 --> 00:21:17,010
how the<font color="#E5E5E5"> communication between the</font><font color="#CCCCCC"> pages</font>

509
00:21:15,149 --> 00:21:18,989
the computer and the key<font color="#CCCCCC"> are happening</font>

510
00:21:17,010 --> 00:21:22,158
and making<font color="#E5E5E5"> sure everything is square and</font>

511
00:21:18,990 --> 00:21:24,720
<font color="#E5E5E5">fair turned out it's not and it gave me</font>

512
00:21:22,159 --> 00:21:26,429
what is my<font color="#CCCCCC"> favorite attack of the talk</font>

513
00:21:24,720 --> 00:21:29,039
<font color="#E5E5E5">because I think this is the most</font>

514
00:21:26,429 --> 00:21:31,139
mind-boggling one<font color="#CCCCCC"> this is also the one</font>

515
00:21:29,039 --> 00:21:32,879
we do feature and we<font color="#CCCCCC"> share on</font><font color="#E5E5E5"> social</font>

516
00:21:31,139 --> 00:21:34,469
<font color="#E5E5E5">media because we really feel it</font>

517
00:21:32,880 --> 00:21:38,490
so I guess how dangerous this thing can

518
00:21:34,470 --> 00:21:40,559
be we so again so<font color="#CCCCCC"> finger print key this</font>

519
00:21:38,490 --> 00:21:42,029
is one<font color="#CCCCCC"> of those and we were</font><font color="#E5E5E5"> actually</font>

520
00:21:40,559 --> 00:21:43,860
wondering how<font color="#CCCCCC"> many</font><font color="#E5E5E5"> of those</font><font color="#CCCCCC"> were</font><font color="#E5E5E5"> having</font>

521
00:21:42,029 --> 00:21:45,840
<font color="#E5E5E5">this program</font><font color="#CCCCCC"> so we bought a few other</font>

522
00:21:43,860 --> 00:21:47,610
brand which we were<font color="#E5E5E5"> be living having the</font>

523
00:21:45,840 --> 00:21:49,949
same chipset internet<font color="#CCCCCC"> which are</font><font color="#E5E5E5"> all</font>

524
00:21:47,610 --> 00:21:51,120
<font color="#E5E5E5">vulnerable we have this one and we have</font>

525
00:21:49,950 --> 00:21:52,799
<font color="#CCCCCC">a bunch</font><font color="#E5E5E5"> of others</font>

526
00:21:51,120 --> 00:21:55,229
we're here<font color="#E5E5E5"> actually</font><font color="#CCCCCC"> if you would like to</font>

527
00:21:52,799 --> 00:21:57,240
see<font color="#E5E5E5"> the demo live after the talk please</font>

528
00:21:55,230 --> 00:22:00,570
come<font color="#E5E5E5"> on here or on</font><font color="#CCCCCC"> the web</font><font color="#E5E5E5"> forum and</font>

529
00:21:57,240 --> 00:22:02,039
we'll<font color="#E5E5E5"> show you lies the attack show you</font>

530
00:22:00,570 --> 00:22:03,990
<font color="#E5E5E5">how easy it is</font>

531
00:22:02,039 --> 00:22:07,620
so it's<font color="#E5E5E5"> attacking the fingerprint keys</font>

532
00:22:03,990 --> 00:22:09,059
we do meet a food break and even a

533
00:22:07,620 --> 00:22:10,860
certain<font color="#E5E5E5"> bitches attackers know how to do</font>

534
00:22:09,059 --> 00:22:13,110
it when you<font color="#CCCCCC"> know what</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> look for</font><font color="#E5E5E5"> and</font>

535
00:22:10,860 --> 00:22:15,209
this<font color="#E5E5E5"> is as</font><font color="#CCCCCC"> insane</font><font color="#E5E5E5"> as</font><font color="#CCCCCC"> you can recover</font><font color="#E5E5E5"> the</font>

536
00:22:13,110 --> 00:22:16,918
master password<font color="#CCCCCC"> so do you want to</font><font color="#E5E5E5"> say it</font>

537
00:22:15,210 --> 00:22:21,720
in life<font color="#E5E5E5"> yes</font>

538
00:22:16,919 --> 00:22:24,899
okay<font color="#E5E5E5"> so the key unplug</font><font color="#CCCCCC"> it that took</font><font color="#E5E5E5"> like</font>

539
00:22:21,720 --> 00:22:27,179
this<font color="#E5E5E5"> nothing to see except the</font>

540
00:22:24,899 --> 00:22:28,709
fingerprint reader<font color="#E5E5E5"> nothing to see right</font>

541
00:22:27,179 --> 00:22:32,700
<font color="#E5E5E5">you're looking between</font><font color="#CCCCCC"> the controller so</font>

542
00:22:28,710 --> 00:22:34,710
<font color="#CCCCCC">here's how it goes we</font><font color="#E5E5E5"> made this one very</font>

543
00:22:32,700 --> 00:22:38,039
nice because<font color="#E5E5E5"> our demos</font><font color="#CCCCCC"> real so you have</font>

544
00:22:34,710 --> 00:22:41,039
someone<font color="#E5E5E5"> on</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> coffee shop which is</font>

545
00:22:38,039 --> 00:22:43,049
<font color="#CCCCCC">living and the attacker is spotting a</font>

546
00:22:41,039 --> 00:22:45,210
key so it's going<font color="#E5E5E5"> to steal the key right</font>

547
00:22:43,049 --> 00:22:48,000
and the key has a fingerprint<font color="#E5E5E5"> reader on</font>

548
00:22:45,210 --> 00:22:50,010
it and so later when he's back to<font color="#E5E5E5"> his</font>

549
00:22:48,000 --> 00:22:53,610
lair<font color="#E5E5E5"> he's going to try to look</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> the</font>

550
00:22:50,010 --> 00:22:55,379
key and obviously you can't<font color="#CCCCCC"> right</font>

551
00:22:53,610 --> 00:22:57,449
<font color="#E5E5E5">because the fingerprint reader do work</font>

552
00:22:55,380 --> 00:22:59,580
as intended so you got and then<font color="#CCCCCC"> you</font>

553
00:22:57,450 --> 00:23:01,380
<font color="#E5E5E5">really sell but turns out there is a</font>

554
00:22:59,580 --> 00:23:03,480
secret USB common which<font color="#CCCCCC"> were you to</font>

555
00:23:01,380 --> 00:23:06,690
<font color="#E5E5E5">recover the master password and that's</font>

556
00:23:03,480 --> 00:23:08,549
how fast it<font color="#CCCCCC"> is so what all you have to</font>

557
00:23:06,690 --> 00:23:10,590
do<font color="#E5E5E5"> really is you say oh I'm an admin</font>

558
00:23:08,549 --> 00:23:13,320
here<font color="#E5E5E5"> is my master</font><font color="#CCCCCC"> password</font><font color="#E5E5E5"> please do</font>

559
00:23:10,590 --> 00:23:15,000
<font color="#CCCCCC">unroll my</font><font color="#E5E5E5"> fingerprint and then you add a</font>

560
00:23:13,320 --> 00:23:19,320
new user let's call it well I<font color="#E5E5E5"> don't know</font>

561
00:23:15,000 --> 00:23:21,980
a VM user and then you click<font color="#E5E5E5"> on next</font><font color="#CCCCCC"> and</font>

562
00:23:19,320 --> 00:23:24,210
you start to tap in<font color="#CCCCCC"> your finger and</font><font color="#E5E5E5"> a</font>

563
00:23:21,980 --> 00:23:26,400
moment later

564
00:23:24,210 --> 00:23:29,210
you will have<font color="#CCCCCC"> a your</font><font color="#E5E5E5"> fingerprint on</font>

565
00:23:26,400 --> 00:23:32,880
<font color="#CCCCCC">growlithe illegitimate</font><font color="#E5E5E5"> user</font><font color="#CCCCCC"> into the key</font>

566
00:23:29,210 --> 00:23:35,310
that's how bad it is<font color="#CCCCCC"> so any</font><font color="#E5E5E5"> of those key</font>

567
00:23:32,880 --> 00:23:38,120
are definitively broken because<font color="#E5E5E5"> you can</font>

568
00:23:35,310 --> 00:23:40,200
extract<font color="#CCCCCC"> the password from the controller</font>

569
00:23:38,120 --> 00:23:42,209
<font color="#E5E5E5">yeah I still have people</font><font color="#CCCCCC"> chickens ahead</font>

570
00:23:40,200 --> 00:23:44,070
yep that sucks<font color="#CCCCCC"> I don't I</font><font color="#E5E5E5"> can't imagine</font>

571
00:23:42,210 --> 00:23:46,050
<font color="#E5E5E5">how someone designed secret project</font>

572
00:23:44,070 --> 00:23:47,580
could do that but<font color="#E5E5E5"> actually they do which</font>

573
00:23:46,050 --> 00:23:51,060
<font color="#E5E5E5">is why we need</font><font color="#CCCCCC"> to edit all of them and</font>

574
00:23:47,580 --> 00:23:52,770
make<font color="#CCCCCC"> sure we verify clearly the spec</font>

575
00:23:51,060 --> 00:23:54,210
<font color="#E5E5E5">even if you think it's obvious actually</font>

576
00:23:52,770 --> 00:23:56,310
<font color="#E5E5E5">turns out some</font><font color="#CCCCCC"> people may still make</font>

577
00:23:54,210 --> 00:24:01,380
<font color="#CCCCCC">mistakes and we're here to protect</font><font color="#E5E5E5"> our</font>

578
00:23:56,310 --> 00:24:03,240
users<font color="#CCCCCC"> so another one you would assume a</font>

579
00:24:01,380 --> 00:24:05,580
controller will not will<font color="#CCCCCC"> you know lock</font>

580
00:24:03,240 --> 00:24:07,890
after<font color="#E5E5E5"> like</font><font color="#CCCCCC"> five or six attempt that</font>

581
00:24:05,580 --> 00:24:10,169
seems obvious<font color="#CCCCCC"> righty</font><font color="#E5E5E5"> you should not keep</font>

582
00:24:07,890 --> 00:24:14,730
<font color="#CCCCCC">doing it it turned out that</font><font color="#E5E5E5"> one why do</font>

583
00:24:10,170 --> 00:24:18,390
we did our audit of a encrypted hard

584
00:24:14,730 --> 00:24:20,190
drive<font color="#E5E5E5"> who use RFID badge</font><font color="#CCCCCC"> we found out</font>

585
00:24:18,390 --> 00:24:22,080
<font color="#E5E5E5">that's not the</font><font color="#CCCCCC"> case so we</font><font color="#E5E5E5"> limit again</font><font color="#CCCCCC"> a</font>

586
00:24:20,190 --> 00:24:24,480
full<font color="#E5E5E5"> break and also</font><font color="#CCCCCC"> only produced</font>

587
00:24:22,080 --> 00:24:27,480
attacker can do it<font color="#E5E5E5"> because</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> is again</font>

588
00:24:24,480 --> 00:24:30,750
very<font color="#CCCCCC"> easy</font><font color="#E5E5E5"> to do so</font><font color="#CCCCCC"> here's a badge so you</font>

589
00:24:27,480 --> 00:24:32,760
can use them or use like a proxmark to

590
00:24:30,750 --> 00:24:35,220
start to do the brute<font color="#CCCCCC"> force</font><font color="#E5E5E5"> it turns out</font>

591
00:24:32,760 --> 00:24:37,470
they do<font color="#CCCCCC"> lock the hard drive after</font><font color="#E5E5E5"> six</font>

592
00:24:35,220 --> 00:24:40,260
attempt the only problem is<font color="#E5E5E5"> when you</font>

593
00:24:37,470 --> 00:24:44,700
power off and on contract goes back to

594
00:24:40,260 --> 00:24:47,010
zero so you know with a simple

595
00:24:44,700 --> 00:24:49,050
electronic manipulation which<font color="#E5E5E5"> are not</font>

596
00:24:47,010 --> 00:24:51,810
the voltage<font color="#CCCCCC"> will turn</font><font color="#E5E5E5"> on to disk put</font>

597
00:24:49,050 --> 00:24:53,550
forth enough you can put force it as

598
00:24:51,810 --> 00:25:00,510
much as you<font color="#E5E5E5"> want and so basically is</font>

599
00:24:53,550 --> 00:25:04,050
completely useless<font color="#E5E5E5"> anyway so</font><font color="#CCCCCC"> we try to</font>

600
00:25:00,510 --> 00:25:06,690
<font color="#CCCCCC">sum up</font><font color="#E5E5E5"> well the</font><font color="#CCCCCC"> Weisse should burn</font><font color="#E5E5E5"> after</font>

601
00:25:04,050 --> 00:25:09,440
<font color="#CCCCCC">unsuccessful attempt and you should</font><font color="#E5E5E5"> not</font>

602
00:25:06,690 --> 00:25:12,540
<font color="#E5E5E5">be</font><font color="#CCCCCC"> able</font><font color="#E5E5E5"> to reset the counter obtuse but</font>

603
00:25:09,440 --> 00:25:14,070
important and the password in<font color="#E5E5E5"> ASCII</font>

604
00:25:12,540 --> 00:25:16,020
should not be<font color="#E5E5E5"> able requested from the</font>

605
00:25:14,070 --> 00:25:19,020
<font color="#E5E5E5">Singh we also have a bunch of stuff</font><font color="#CCCCCC"> like</font>

606
00:25:16,020 --> 00:25:20,340
the<font color="#CCCCCC"> SPS</font><font color="#E5E5E5"> kid needs to be regenerated and</font>

607
00:25:19,020 --> 00:25:23,280
so forth<font color="#E5E5E5"> and those are more technical</font>

608
00:25:20,340 --> 00:25:25,020
<font color="#CCCCCC">things they will</font><font color="#E5E5E5"> be</font><font color="#CCCCCC"> into slide and later</font>

609
00:25:23,280 --> 00:25:26,399
on<font color="#CCCCCC"> we'll publish the four methodology on</font>

610
00:25:25,020 --> 00:25:30,810
github so<font color="#CCCCCC"> you</font><font color="#E5E5E5"> can actually download it</font>

611
00:25:26,400 --> 00:25:32,880
<font color="#E5E5E5">and help us to make it</font><font color="#CCCCCC"> even better so</font>

612
00:25:30,810 --> 00:25:34,379
<font color="#E5E5E5">moving on to</font><font color="#CCCCCC"> the fourth</font><font color="#E5E5E5"> part which is</font>

613
00:25:32,880 --> 00:25:37,789
cryptography we don't have much to<font color="#E5E5E5"> say</font>

614
00:25:34,380 --> 00:25:39,289
because of<font color="#CCCCCC"> course we</font><font color="#E5E5E5"> know</font>

615
00:25:37,789 --> 00:25:41,929
we want<font color="#E5E5E5"> one they had to</font><font color="#CCCCCC"> be properly</font>

616
00:25:39,289 --> 00:25:43,070
<font color="#E5E5E5">encrypted and we want the encryption key</font>

617
00:25:41,929 --> 00:25:44,960
to be truly<font color="#E5E5E5"> one done which mean</font><font color="#CCCCCC"> you</font>

618
00:25:43,070 --> 00:25:47,479
should not use the same key over many

619
00:25:44,960 --> 00:25:49,489
many device and you want<font color="#CCCCCC"> to kid to be</font>

620
00:25:47,479 --> 00:25:51,830
truly<font color="#E5E5E5"> random meaning we can't guess what</font>

621
00:25:49,489 --> 00:25:54,019
the key is for a<font color="#CCCCCC"> given device</font><font color="#E5E5E5"> we did see</font>

622
00:25:51,830 --> 00:25:55,879
<font color="#CCCCCC">that for example</font><font color="#E5E5E5"> in Wi-Fi routers a</font>

623
00:25:54,019 --> 00:25:57,320
while back where they were deriving the

624
00:25:55,879 --> 00:26:00,799
key from the<font color="#E5E5E5"> MAC</font><font color="#CCCCCC"> address</font>

625
00:25:57,320 --> 00:26:03,408
hopefully don't<font color="#CCCCCC"> do that for USB key</font><font color="#E5E5E5"> so</font>

626
00:26:00,799 --> 00:26:05,269
problem is the<font color="#E5E5E5"> the cryptography is</font>

627
00:26:03,409 --> 00:26:07,519
literally backed into the silicon which

628
00:26:05,269 --> 00:26:09,350
makes you<font color="#CCCCCC"> audit by very very difficult</font>

629
00:26:07,519 --> 00:26:13,549
and<font color="#E5E5E5"> almost</font><font color="#CCCCCC"> impossible if you don't</font><font color="#E5E5E5"> have</font>

630
00:26:09,350 --> 00:26:15,738
the correct<font color="#E5E5E5"> back so we feel that the</font>

631
00:26:13,549 --> 00:26:18,109
tests<font color="#E5E5E5"> are too expensive</font><font color="#CCCCCC"> for us to do so</font>

632
00:26:15,739 --> 00:26:21,830
we can skip<font color="#E5E5E5"> all of them and we hope to</font>

633
00:26:18,109 --> 00:26:24,139
<font color="#CCCCCC">show that</font><font color="#E5E5E5"> not by going our selves in the</font>

634
00:26:21,830 --> 00:26:25,999
yard where audit but instead<font color="#E5E5E5"> having a</font>

635
00:26:24,139 --> 00:26:27,439
better certification process<font color="#CCCCCC"> and having</font>

636
00:26:25,999 --> 00:26:31,849
<font color="#CCCCCC">manufacturers disclose more information</font>

637
00:26:27,440 --> 00:26:33,649
<font color="#E5E5E5">so that being said we did find a few</font>

638
00:26:31,849 --> 00:26:37,789
oddities and when you<font color="#E5E5E5"> see just mention a</font>

639
00:26:33,649 --> 00:26:41,119
few<font color="#E5E5E5"> of those people use outdated crypto</font>

640
00:26:37,789 --> 00:26:46,039
in certain keys we found<font color="#E5E5E5"> one key who use</font>

641
00:26:41,119 --> 00:26:48,529
<font color="#CCCCCC">our RSA 512</font><font color="#E5E5E5"> don't do that because you</font>

642
00:26:46,039 --> 00:26:50,720
<font color="#E5E5E5">have been</font><font color="#CCCCCC"> able to factoring attack and</font>

643
00:26:48,529 --> 00:26:52,129
we also found some key who are doing

644
00:26:50,720 --> 00:26:55,070
<font color="#E5E5E5">file by file encryption who are using</font>

645
00:26:52,129 --> 00:26:56,809
<font color="#CCCCCC">elsif or of course fc4</font><font color="#E5E5E5"> is considered</font>

646
00:26:55,070 --> 00:26:59,539
broken<font color="#CCCCCC"> ciphers so they should use I</font>

647
00:26:56,809 --> 00:27:00,590
don't know<font color="#CCCCCC"> yes and they don't also you</font>

648
00:26:59,539 --> 00:27:02,989
can use any stream cipher that

649
00:27:00,590 --> 00:27:04,908
churchill2020 or something like<font color="#E5E5E5"> that but</font>

650
00:27:02,989 --> 00:27:07,159
it<font color="#CCCCCC"> still</font><font color="#E5E5E5"> use very outdated crypto so we</font>

651
00:27:04,909 --> 00:27:09,649
come across<font color="#E5E5E5"> a few</font><font color="#CCCCCC"> scenes where even by</font>

652
00:27:07,159 --> 00:27:11,720
<font color="#CCCCCC">just doing</font><font color="#E5E5E5"> the audit normal did we found</font>

653
00:27:09,649 --> 00:27:13,908
<font color="#CCCCCC">some oddities but for the very hardcore</font>

654
00:27:11,720 --> 00:27:15,259
<font color="#E5E5E5">and in-depth analysis of a crypto we</font>

655
00:27:13,909 --> 00:27:17,149
believe it should<font color="#CCCCCC"> be done at the</font>

656
00:27:15,259 --> 00:27:19,059
<font color="#CCCCCC">certification level so here's a</font><font color="#E5E5E5"> bunch of</font>

657
00:27:17,149 --> 00:27:21,349
<font color="#E5E5E5">recap</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> what we think should happen</font>

658
00:27:19,059 --> 00:27:22,489
<font color="#CCCCCC">encryption key should</font><font color="#E5E5E5"> be unique there is</font>

659
00:27:21,349 --> 00:27:24,559
no recovery master key

660
00:27:22,489 --> 00:27:25,909
so no backdoor<font color="#E5E5E5"> and they</font><font color="#CCCCCC"> died is</font>

661
00:27:24,559 --> 00:27:27,080
encrypted using<font color="#E5E5E5"> errors and you</font><font color="#CCCCCC"> worst</font>

662
00:27:25,909 --> 00:27:29,139
<font color="#CCCCCC">under that</font><font color="#E5E5E5"> would be so three main things</font>

663
00:27:27,080 --> 00:27:31,639
<font color="#E5E5E5">and then we have a bunch</font><font color="#CCCCCC"> of technical</font>

664
00:27:29,139 --> 00:27:34,248
requirement that we think are useful to

665
00:27:31,639 --> 00:27:36,199
improve<font color="#E5E5E5"> the security of the key all</font>

666
00:27:34,249 --> 00:27:37,639
<font color="#CCCCCC">right</font><font color="#E5E5E5"> for the last part and which is the</font>

667
00:27:36,200 --> 00:27:40,549
most<font color="#CCCCCC"> experimental</font><font color="#E5E5E5"> part of the talk and</font>

668
00:27:37,639 --> 00:27:42,408
you have no<font color="#E5E5E5"> video there would</font><font color="#CCCCCC"> be how we</font>

669
00:27:40,549 --> 00:27:47,539
attack storage so<font color="#CCCCCC"> Misha</font><font color="#E5E5E5"> will</font><font color="#CCCCCC"> walk</font><font color="#E5E5E5"> use to</font>

670
00:27:42,409 --> 00:27:50,179
that<font color="#E5E5E5"> thanks so the goal we had in mind</font>

671
00:27:47,539 --> 00:27:51,160
for<font color="#E5E5E5"> the</font><font color="#CCCCCC"> storage audit was obviously what</font>

672
00:27:50,179 --> 00:27:53,650
you expect<font color="#E5E5E5"> from</font><font color="#CCCCCC"> me</font>

673
00:27:51,160 --> 00:27:56,740
encrypted USB key<font color="#E5E5E5"> which means doing a</font>

674
00:27:53,650 --> 00:27:58,870
full disk encryption<font color="#CCCCCC"> but</font><font color="#E5E5E5"> also providing</font>

675
00:27:56,740 --> 00:28:01,020
<font color="#CCCCCC">you with some integrated</font><font color="#E5E5E5"> check so that</font>

676
00:27:58,870 --> 00:28:05,010
if someone<font color="#CCCCCC"> tries to tamper with</font><font color="#E5E5E5"> the data</font>

677
00:28:01,020 --> 00:28:07,389
<font color="#CCCCCC">it</font><font color="#E5E5E5"> will be detected</font><font color="#CCCCCC"> and prevented</font>

678
00:28:05,010 --> 00:28:11,680
extracting the content of the storage

679
00:28:07,390 --> 00:28:13,270
chip appears to be not easy at all

680
00:28:11,680 --> 00:28:15,910
first you have to<font color="#E5E5E5"> do the chip removal</font>

681
00:28:13,270 --> 00:28:18,490
<font color="#E5E5E5">which means potentially go through the</font>

682
00:28:15,910 --> 00:28:20,440
layer of epoxy<font color="#E5E5E5"> and here you get</font><font color="#CCCCCC"> access</font>

683
00:28:18,490 --> 00:28:23,890
<font color="#CCCCCC">to the component</font><font color="#E5E5E5"> then remove the</font>

684
00:28:20,440 --> 00:28:27,700
component from<font color="#CCCCCC"> the PCB then you have to</font>

685
00:28:23,890 --> 00:28:29,590
dump the content of the memory<font color="#E5E5E5"> because</font>

686
00:28:27,700 --> 00:28:31,210
of the<font color="#CCCCCC"> nen</font><font color="#E5E5E5"> the way</font><font color="#CCCCCC"> the technique the</font>

687
00:28:29,590 --> 00:28:33,550
memory technology the<font color="#CCCCCC"> flash</font><font color="#E5E5E5"> technology</font>

688
00:28:31,210 --> 00:28:36,190
works<font color="#E5E5E5"> you also have some algorithm to</font>

689
00:28:33,550 --> 00:28:37,810
compensate for the error<font color="#E5E5E5"> the</font><font color="#CCCCCC"> reels that</font>

690
00:28:36,190 --> 00:28:40,180
<font color="#CCCCCC">you will have and you have to understand</font>

691
00:28:37,810 --> 00:28:45,070
<font color="#CCCCCC">that algorithm</font><font color="#E5E5E5"> to recover to emulate it</font>

692
00:28:40,180 --> 00:28:47,200
<font color="#CCCCCC">and recover the real</font><font color="#E5E5E5"> data</font><font color="#CCCCCC"> then you have</font>

693
00:28:45,070 --> 00:28:49,960
to exhaust<font color="#CCCCCC"> rambling algorithm that is</font>

694
00:28:47,200 --> 00:28:52,510
more mainly used<font color="#CCCCCC"> by people by</font>

695
00:28:49,960 --> 00:28:55,450
manufacturer<font color="#CCCCCC"> this</font><font color="#E5E5E5"> is not a security</font>

696
00:28:52,510 --> 00:28:59,290
feature is just<font color="#CCCCCC"> to</font><font color="#E5E5E5"> optimize the lifespan</font>

697
00:28:55,450 --> 00:29:01,450
of<font color="#E5E5E5"> the flash memory</font><font color="#CCCCCC"> same thing</font><font color="#E5E5E5"> for the</font>

698
00:28:59,290 --> 00:29:04,780
next<font color="#E5E5E5"> step you</font><font color="#CCCCCC"> have to interleave blocks</font>

699
00:29:01,450 --> 00:29:08,620
the right way it's<font color="#E5E5E5"> just for the life</font>

700
00:29:04,780 --> 00:29:10,240
span<font color="#E5E5E5"> of the the chip then you have to</font>

701
00:29:08,620 --> 00:29:12,189
undo the file translation layer if

702
00:29:10,240 --> 00:29:15,010
you're familiar with<font color="#E5E5E5"> familiar</font><font color="#CCCCCC"> with the</font>

703
00:29:12,190 --> 00:29:17,200
x86<font color="#CCCCCC"> architecture it's like the mapping</font>

704
00:29:15,010 --> 00:29:19,660
<font color="#CCCCCC">between the physical memory pages and</font>

705
00:29:17,200 --> 00:29:22,930
the virtual<font color="#E5E5E5"> memory pages so you have</font>

706
00:29:19,660 --> 00:29:25,330
some area some storing some metadata<font color="#E5E5E5"> on</font>

707
00:29:22,930 --> 00:29:27,730
the flash<font color="#E5E5E5"> and it will explain</font><font color="#CCCCCC"> to you or</font>

708
00:29:25,330 --> 00:29:29,290
to<font color="#E5E5E5"> reorder the page the memory pages in</font>

709
00:29:27,730 --> 00:29:31,690
the right order to get the<font color="#E5E5E5"> file system</font>

710
00:29:29,290 --> 00:29:33,399
back once this is<font color="#E5E5E5"> done you</font><font color="#CCCCCC"> have to</font>

711
00:29:31,690 --> 00:29:35,740
<font color="#E5E5E5">straightaway the metadata you just used</font>

712
00:29:33,400 --> 00:29:39,130
<font color="#E5E5E5">and finally you have to decrypt the file</font>

713
00:29:35,740 --> 00:29:42,190
system<font color="#E5E5E5"> don't worry we'll go through the</font>

714
00:29:39,130 --> 00:29:44,890
<font color="#E5E5E5">steps with something more visual soon we</font>

715
00:29:42,190 --> 00:29:47,890
discovered<font color="#CCCCCC"> during</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> audit</font><font color="#E5E5E5"> some</font><font color="#CCCCCC"> bun</font>

716
00:29:44,890 --> 00:29:50,440
some<font color="#CCCCCC"> families of keys which were using</font>

717
00:29:47,890 --> 00:29:52,290
<font color="#CCCCCC">the serum partition to store the tools</font>

718
00:29:50,440 --> 00:29:55,740
to unlock the key for those who are

719
00:29:52,290 --> 00:29:58,389
providing a password<font color="#CCCCCC"> protected USB key</font>

720
00:29:55,740 --> 00:30:00,580
it's used for convenience<font color="#E5E5E5"> at least it's</font>

721
00:29:58,390 --> 00:30:02,390
a read-only partition<font color="#E5E5E5"> from the operating</font>

722
00:30:00,580 --> 00:30:04,309
<font color="#CCCCCC">system point</font><font color="#E5E5E5"> of view</font>

723
00:30:02,390 --> 00:30:06,590
and it also provides you with the

724
00:30:04,309 --> 00:30:08,029
autorun feature which will prompt you

725
00:30:06,590 --> 00:30:12,439
for the<font color="#CCCCCC"> password as soon as you plug the</font>

726
00:30:08,029 --> 00:30:14,510
USB key<font color="#E5E5E5"> so this is the key one of the</font>

727
00:30:12,440 --> 00:30:16,909
key that was vulnerable<font color="#CCCCCC"> to this kind of</font>

728
00:30:14,510 --> 00:30:21,140
attack<font color="#CCCCCC"> we already saw that this is not</font>

729
00:30:16,909 --> 00:30:23,539
epoxy then you remove<font color="#E5E5E5"> the chip you put</font>

730
00:30:21,140 --> 00:30:26,510
the chip in an end<font color="#E5E5E5"> reader to be</font><font color="#CCCCCC"> able to</font>

731
00:30:23,539 --> 00:30:28,940
extract<font color="#E5E5E5"> the content and that's basically</font>

732
00:30:26,510 --> 00:30:30,769
what you<font color="#CCCCCC"> have so if you</font><font color="#E5E5E5"> look at that you</font>

733
00:30:28,940 --> 00:30:33,740
may think<font color="#E5E5E5"> it's properly encrypted</font>

734
00:30:30,769 --> 00:30:37,190
<font color="#E5E5E5">nothing appears in clear</font><font color="#CCCCCC"> that's just the</font>

735
00:30:33,740 --> 00:30:39,080
effect of the exhaust primer so if you

736
00:30:37,190 --> 00:30:43,220
look at the data

737
00:30:39,080 --> 00:30:45,799
turning the bits<font color="#CCCCCC"> into pixels</font><font color="#E5E5E5"> you start</font>

738
00:30:43,220 --> 00:30:48,019
seeing some<font color="#E5E5E5"> patterns appearing you see</font>

739
00:30:45,799 --> 00:30:49,879
some scrambled data<font color="#E5E5E5"> and you</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> see the</font>

740
00:30:48,019 --> 00:30:52,639
artifact<font color="#E5E5E5"> of the</font><font color="#CCCCCC"> solid</font><font color="#E5E5E5"> exhaust</font><font color="#CCCCCC"> trembler</font>

741
00:30:49,880 --> 00:30:55,480
with the sort of<font color="#E5E5E5"> diagonal stripes</font><font color="#CCCCCC"> that</font>

742
00:30:52,639 --> 00:30:58,370
<font color="#E5E5E5">appears on those blocks then you have</font>

743
00:30:55,480 --> 00:31:00,470
some<font color="#E5E5E5"> metadata because they don't change</font>

744
00:30:58,370 --> 00:31:03,939
a lot and<font color="#E5E5E5"> that's what will tell you how</font>

745
00:31:00,470 --> 00:31:07,669
to reorder the lines<font color="#E5E5E5"> on those pixels</font>

746
00:31:03,940 --> 00:31:09,769
<font color="#E5E5E5">then a bunch of</font><font color="#CCCCCC"> bar of bits that are</font>

747
00:31:07,669 --> 00:31:13,760
looking like noise<font color="#E5E5E5"> and that's the ECC</font>

748
00:31:09,769 --> 00:31:17,389
correction<font color="#E5E5E5"> and then you go again</font><font color="#CCCCCC"> on the</font>

749
00:31:13,760 --> 00:31:19,730
<font color="#E5E5E5">scramble data and over and over if you</font>

750
00:31:17,389 --> 00:31:21,080
undo<font color="#CCCCCC"> the</font><font color="#E5E5E5"> exhaust rambling</font><font color="#CCCCCC"> that's what</font>

751
00:31:19,730 --> 00:31:24,019
the patterns will look<font color="#E5E5E5"> like at the end</font>

752
00:31:21,080 --> 00:31:26,960
<font color="#CCCCCC">and if you look at the eggs dump</font><font color="#E5E5E5"> it's</font>

753
00:31:24,019 --> 00:31:28,399
even<font color="#CCCCCC"> clearer that's you and you haven't</font>

754
00:31:26,960 --> 00:31:30,860
<font color="#CCCCCC">done successfully</font><font color="#E5E5E5"> the exhaust</font><font color="#CCCCCC"> Rambler</font>

755
00:31:28,399 --> 00:31:33,979
<font color="#E5E5E5">because you can see some clear text this</font>

756
00:31:30,860 --> 00:31:36,110
is the<font color="#E5E5E5"> parameter</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the USB</font><font color="#CCCCCC"> stick</font><font color="#E5E5E5"> which</font>

757
00:31:33,980 --> 00:31:38,510
contains some<font color="#E5E5E5"> parameter like some</font>

758
00:31:36,110 --> 00:31:41,809
strings<font color="#E5E5E5"> and</font><font color="#CCCCCC"> vendo ID for the</font><font color="#E5E5E5"> USB</font><font color="#CCCCCC"> and</font>

759
00:31:38,510 --> 00:31:44,809
stuff like that if you go a bit later

760
00:31:41,809 --> 00:31:46,850
<font color="#E5E5E5">once you under the once you've undone</font>

761
00:31:44,809 --> 00:31:50,750
properly the file translation layer you

762
00:31:46,850 --> 00:31:53,240
will see the serum partition<font color="#E5E5E5"> and if you</font>

763
00:31:50,750 --> 00:31:55,490
continue a bit down on the memory you

764
00:31:53,240 --> 00:31:56,870
will see the<font color="#E5E5E5"> P file that allows you</font><font color="#CCCCCC"> to</font>

765
00:31:55,490 --> 00:31:58,850
<font color="#E5E5E5">enter the password</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> lock the key</font>

766
00:31:56,870 --> 00:32:02,750
which<font color="#E5E5E5"> means the serum partition was not</font>

767
00:31:58,850 --> 00:32:05,269
encrypted<font color="#E5E5E5"> at all but how do you begged</font>

768
00:32:02,750 --> 00:32:07,190
all that thing well remember the graph

769
00:32:05,269 --> 00:32:10,010
you<font color="#E5E5E5"> have to go</font><font color="#CCCCCC"> the other way around so</font>

770
00:32:07,190 --> 00:32:11,899
<font color="#CCCCCC">you</font><font color="#E5E5E5"> patch the IG's if</font><font color="#CCCCCC"> i'll with the</font>

771
00:32:10,010 --> 00:32:14,450
savetti can leak the password<font color="#CCCCCC"> of the</font>

772
00:32:11,899 --> 00:32:16,129
user when<font color="#CCCCCC"> you will</font><font color="#E5E5E5"> enter it</font>

773
00:32:14,450 --> 00:32:18,320
then you have to reapply<font color="#E5E5E5"> the exhaust</font>

774
00:32:16,130 --> 00:32:21,430
<font color="#E5E5E5">scrambler before computing again the</font>

775
00:32:18,320 --> 00:32:24,129
error<font color="#E5E5E5"> correction code and update it and</font>

776
00:32:21,430 --> 00:32:27,140
then you have to rewrite<font color="#CCCCCC"> the memory chip</font>

777
00:32:24,130 --> 00:32:31,970
solder it back<font color="#E5E5E5"> and</font><font color="#CCCCCC"> reverb</font><font color="#E5E5E5"> the key so</font>

778
00:32:27,140 --> 00:32:34,070
<font color="#CCCCCC">that it looks stealthy sometimes the</font>

779
00:32:31,970 --> 00:32:36,920
manufacturer will help you because no

780
00:32:34,070 --> 00:32:38,720
solder ring skills needed<font color="#CCCCCC"> it's just</font><font color="#E5E5E5"> a</font>

781
00:32:36,920 --> 00:32:40,340
<font color="#CCCCCC">microSD card on the</font><font color="#E5E5E5"> rears you just have</font>

782
00:32:38,720 --> 00:32:44,270
to<font color="#E5E5E5"> press it and</font><font color="#CCCCCC"> extract the SD card and</font>

783
00:32:40,340 --> 00:32:46,459
<font color="#E5E5E5">read it with</font><font color="#CCCCCC"> a card reader</font><font color="#E5E5E5"> but the thing</font>

784
00:32:44,270 --> 00:32:49,070
<font color="#CCCCCC">is where all the secrets told it's an</font>

785
00:32:46,460 --> 00:32:51,680
encrypted USB key most of the USB<font color="#E5E5E5"> key</font>

786
00:32:49,070 --> 00:32:55,730
will use AES<font color="#CCCCCC"> and they need this key to</font>

787
00:32:51,680 --> 00:32:58,520
<font color="#E5E5E5">be there</font><font color="#CCCCCC"> it turns</font><font color="#E5E5E5"> out that we had to</font>

788
00:32:55,730 --> 00:33:01,550
build a platform<font color="#E5E5E5"> to be able</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> look</font>

789
00:32:58,520 --> 00:33:03,860
where the is key could<font color="#E5E5E5"> be</font><font color="#CCCCCC"> stored</font><font color="#E5E5E5"> and it</font>

790
00:33:01,550 --> 00:33:06,740
was a quite difficult task<font color="#CCCCCC"> so this is</font>

791
00:33:03,860 --> 00:33:10,010
the overview<font color="#E5E5E5"> of the platform we</font><font color="#CCCCCC"> have so</font>

792
00:33:06,740 --> 00:33:12,800
after<font color="#E5E5E5"> this all</font><font color="#CCCCCC"> during the the chip we</font>

793
00:33:10,010 --> 00:33:15,650
connected<font color="#E5E5E5"> to with individual wires the</font>

794
00:33:12,800 --> 00:33:18,590
USB key with<font color="#E5E5E5"> an FPGA the FPGA will</font>

795
00:33:15,650 --> 00:33:23,300
emulate<font color="#E5E5E5"> the memory and will basically</font>

796
00:33:18,590 --> 00:33:25,790
<font color="#E5E5E5">act as</font><font color="#CCCCCC"> a proxy</font><font color="#E5E5E5"> between the researchers</font>

797
00:33:23,300 --> 00:33:27,560
workstation<font color="#E5E5E5"> which contains the</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> data</font>

798
00:33:25,790 --> 00:33:29,149
and we<font color="#E5E5E5"> will see the comment through we</font>

799
00:33:27,560 --> 00:33:31,610
can<font color="#E5E5E5"> tamper with the data and see what</font>

800
00:33:29,150 --> 00:33:34,130
<font color="#E5E5E5">happens and in parallel we connect also</font>

801
00:33:31,610 --> 00:33:35,990
<font color="#E5E5E5">a logic analyzer which will just analyze</font>

802
00:33:34,130 --> 00:33:38,290
<font color="#E5E5E5">what's happening on the wire to ensure</font>

803
00:33:35,990 --> 00:33:41,960
that<font color="#E5E5E5"> our emulator</font><font color="#CCCCCC"> is working properly</font>

804
00:33:38,290 --> 00:33:45,200
<font color="#E5E5E5">this is a simplified view of the</font>

805
00:33:41,960 --> 00:33:48,050
platform and physically<font color="#CCCCCC"> that looks</font><font color="#E5E5E5"> like</font>

806
00:33:45,200 --> 00:33:50,030
that<font color="#E5E5E5"> so here you have the key with the</font>

807
00:33:48,050 --> 00:33:53,060
memory chip being removed connected to

808
00:33:50,030 --> 00:33:54,620
custom PCBs that<font color="#E5E5E5"> we design and the FPGA</font>

809
00:33:53,060 --> 00:33:57,470
<font color="#E5E5E5">sitting in the middle to emulate the</font>

810
00:33:54,620 --> 00:34:00,489
memory chip<font color="#E5E5E5"> and on the top you</font><font color="#CCCCCC"> have</font><font color="#E5E5E5"> the</font>

811
00:33:57,470 --> 00:34:03,950
logic analyzer<font color="#E5E5E5"> that will give you the</font>

812
00:34:00,490 --> 00:34:06,680
view of the lines zooming a bit on the

813
00:34:03,950 --> 00:34:09,530
on<font color="#CCCCCC"> the way we</font><font color="#E5E5E5"> you have to wire the USB</font>

814
00:34:06,680 --> 00:34:11,630
key to the to the custom PCB<font color="#E5E5E5"> this is</font>

815
00:34:09,530 --> 00:34:13,400
again the USB key the custom PCB which

816
00:34:11,630 --> 00:34:17,450
is a breakout board and those<font color="#E5E5E5"> are</font>

817
00:34:13,400 --> 00:34:19,520
individual very thin wires<font color="#E5E5E5"> and if you</font>

818
00:34:17,449 --> 00:34:21,710
look on<font color="#E5E5E5"> the USB key</font><font color="#CCCCCC"> this is what it</font>

819
00:34:19,520 --> 00:34:24,770
looks<font color="#E5E5E5"> like and we had to use some duct</font>

820
00:34:21,710 --> 00:34:26,179
<font color="#CCCCCC">tape to release the strength does the</font>

821
00:34:24,770 --> 00:34:30,589
stress from<font color="#E5E5E5"> the wires because it</font>

822
00:34:26,179 --> 00:34:33,280
so<font color="#E5E5E5"> learn on very thin pads and we broke</font>

823
00:34:30,589 --> 00:34:35,389
some keys<font color="#CCCCCC"> during the audit</font>

824
00:34:33,280 --> 00:34:37,280
<font color="#CCCCCC">here you</font><font color="#E5E5E5"> have the view of the logic</font>

825
00:34:35,389 --> 00:34:39,829
analyzer<font color="#E5E5E5"> which will give you the</font><font color="#CCCCCC"> digital</font>

826
00:34:37,280 --> 00:34:41,750
channels<font color="#E5E5E5"> in</font><font color="#CCCCCC"> gray</font><font color="#E5E5E5"> in blue you will have</font>

827
00:34:39,829 --> 00:34:43,429
the<font color="#E5E5E5"> analog view of the channels which</font>

828
00:34:41,750 --> 00:34:45,619
happens to be<font color="#CCCCCC"> very useful because</font>

829
00:34:43,429 --> 00:34:48,349
<font color="#CCCCCC">sometime you have</font><font color="#E5E5E5"> some glitch</font><font color="#CCCCCC"> artifact</font>

830
00:34:45,619 --> 00:34:50,450
on the line that will switch on the

831
00:34:48,349 --> 00:34:53,929
digital view is 0 to 1<font color="#CCCCCC"> and</font><font color="#E5E5E5"> you don't</font>

832
00:34:50,449 --> 00:34:55,189
understand why as an overlay you can

833
00:34:53,929 --> 00:34:56,990
<font color="#CCCCCC">have also</font><font color="#E5E5E5"> your protocol being</font>

834
00:34:55,190 --> 00:34:57,859
automatically decoded by the<font color="#E5E5E5"> software</font>

835
00:34:56,989 --> 00:35:02,328
<font color="#CCCCCC">and on the right you have</font><font color="#E5E5E5"> the</font>

836
00:34:57,859 --> 00:35:04,848
<font color="#E5E5E5">measurement panel why were you</font><font color="#CCCCCC"> were we</font>

837
00:35:02,329 --> 00:35:07,069
<font color="#E5E5E5">using the FPGA for that is because the</font>

838
00:35:04,849 --> 00:35:09,740
MMC protocol appears<font color="#E5E5E5"> to be a</font><font color="#CCCCCC"> high-speed</font>

839
00:35:07,069 --> 00:35:11,470
protocol<font color="#E5E5E5"> with very strict timings and</font>

840
00:35:09,740 --> 00:35:14,629
emulating it in software was not

841
00:35:11,470 --> 00:35:16,399
<font color="#E5E5E5">possible because just the</font><font color="#CCCCCC"> runtime trip</font>

842
00:35:14,630 --> 00:35:20,410
<font color="#E5E5E5">between</font><font color="#CCCCCC"> the software</font><font color="#E5E5E5"> emulator</font>

843
00:35:16,400 --> 00:35:23,270
<font color="#CCCCCC">and the USB</font><font color="#E5E5E5"> key was</font><font color="#CCCCCC"> going a way of the</font>

844
00:35:20,410 --> 00:35:27,200
<font color="#E5E5E5">tolerance of the timings so</font><font color="#CCCCCC"> we had to</font>

845
00:35:23,270 --> 00:35:28,970
build it<font color="#E5E5E5"> with the FPGA and this is the</font>

846
00:35:27,200 --> 00:35:30,799
output we have<font color="#CCCCCC"> on the system you can</font><font color="#E5E5E5"> see</font>

847
00:35:28,970 --> 00:35:32,180
all the command<font color="#E5E5E5"> the fact</font><font color="#CCCCCC"> that the</font>

848
00:35:30,799 --> 00:35:34,309
comments are<font color="#CCCCCC"> going from</font><font color="#E5E5E5"> the host to the</font>

849
00:35:32,180 --> 00:35:36,399
device if the<font color="#E5E5E5"> CRC is correct the</font>

850
00:35:34,309 --> 00:35:39,680
arguments and stuff<font color="#E5E5E5"> like that</font>

851
00:35:36,400 --> 00:35:41,299
<font color="#E5E5E5">so</font><font color="#CCCCCC"> can das CD recovered well that's</font>

852
00:35:39,680 --> 00:35:43,520
basically<font color="#CCCCCC"> the part that is still working</font>

853
00:35:41,299 --> 00:35:45,410
<font color="#CCCCCC">a work in progress it's very complicated</font>

854
00:35:43,520 --> 00:35:48,770
<font color="#E5E5E5">and we</font><font color="#CCCCCC"> are looking forward</font><font color="#E5E5E5"> to</font>

855
00:35:45,410 --> 00:35:53,420
collaborate<font color="#CCCCCC"> on that to get some more</font>

856
00:35:48,770 --> 00:35:56,990
<font color="#E5E5E5">resources on that</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is the summary of</font>

857
00:35:53,420 --> 00:35:59,569
the<font color="#E5E5E5"> storage</font><font color="#CCCCCC"> audit criteria the most</font>

858
00:35:56,990 --> 00:36:01,700
important thing is as we said<font color="#CCCCCC"> ensure</font>

859
00:35:59,569 --> 00:36:03,950
that<font color="#E5E5E5"> the data is actually encrypted and</font>

860
00:36:01,700 --> 00:36:07,250
all the data including<font color="#E5E5E5"> the</font><font color="#CCCCCC"> 0 and</font>

861
00:36:03,950 --> 00:36:08,779
polishin<font color="#E5E5E5"> and obviously that some secrets</font>

862
00:36:07,250 --> 00:36:13,130
should not be<font color="#E5E5E5"> stored in clear in the</font>

863
00:36:08,780 --> 00:36:15,380
memory chip<font color="#E5E5E5"> the takeaways from the talk</font>

864
00:36:13,130 --> 00:36:17,750
<font color="#E5E5E5">is that</font><font color="#CCCCCC"> the certification is very</font>

865
00:36:15,380 --> 00:36:20,450
important because that's<font color="#E5E5E5"> the only way we</font>

866
00:36:17,750 --> 00:36:22,099
can audit<font color="#CCCCCC"> some the</font><font color="#E5E5E5"> the cryptographic the</font>

867
00:36:20,450 --> 00:36:25,490
way<font color="#CCCCCC"> the</font><font color="#E5E5E5"> cryptography is implemented on</font>

868
00:36:22,099 --> 00:36:27,619
the USB<font color="#E5E5E5"> key but on</font><font color="#CCCCCC"> another hand</font><font color="#E5E5E5"> it's not</font>

869
00:36:25,490 --> 00:36:29,250
enough because<font color="#E5E5E5"> it only</font><font color="#CCCCCC"> focuses on the</font>

870
00:36:27,619 --> 00:36:31,740
cryptography and it

871
00:36:29,250 --> 00:36:35,460
it<font color="#E5E5E5"> misses</font><font color="#CCCCCC"> four other points that we</font>

872
00:36:31,740 --> 00:36:38,279
covered<font color="#CCCCCC"> during our methodology another</font>

873
00:36:35,460 --> 00:36:40,320
point we discovered<font color="#E5E5E5"> is that not all the</font>

874
00:36:38,280 --> 00:36:42,359
manufacturers<font color="#CCCCCC"> and more important not all</font>

875
00:36:40,320 --> 00:36:42,960
the models<font color="#E5E5E5"> from a given manufacturer are</font>

876
00:36:42,359 --> 00:36:44,490
equal

877
00:36:42,960 --> 00:36:46,680
regarding the of the<font color="#E5E5E5"> security</font>

878
00:36:44,490 --> 00:36:48,569
implementation which means that you

879
00:36:46,680 --> 00:36:50,160
cannot trust<font color="#E5E5E5"> the reputation of a</font>

880
00:36:48,570 --> 00:36:51,810
manufacturer<font color="#E5E5E5"> and just look at the</font>

881
00:36:50,160 --> 00:36:53,730
package and pick your key you<font color="#E5E5E5"> have</font><font color="#CCCCCC"> to</font>

882
00:36:51,810 --> 00:36:57,930
actually<font color="#E5E5E5"> audit the key you're going</font><font color="#CCCCCC"> to</font>

883
00:36:53,730 --> 00:37:00,420
pick<font color="#CCCCCC"> for your company as the next step</font>

884
00:36:57,930 --> 00:37:02,879
we encourage you<font color="#CCCCCC"> to</font><font color="#E5E5E5"> use</font><font color="#CCCCCC"> secure</font><font color="#E5E5E5"> encrypted</font>

885
00:37:00,420 --> 00:37:04,950
<font color="#E5E5E5">USB key because at some</font><font color="#CCCCCC"> point as we saw</font>

886
00:37:02,880 --> 00:37:07,650
<font color="#E5E5E5">on the survey at the beginning an</font>

887
00:37:04,950 --> 00:37:12,419
employee is going<font color="#E5E5E5"> to lose a key</font>

888
00:37:07,650 --> 00:37:14,580
containing company data on it<font color="#CCCCCC"> we also</font>

889
00:37:12,420 --> 00:37:16,980
have to ask for more<font color="#E5E5E5"> transparency from</font>

890
00:37:14,580 --> 00:37:21,240
<font color="#E5E5E5">the manufacturers so that it's not that</font>

891
00:37:16,980 --> 00:37:23,280
<font color="#CCCCCC">hard</font><font color="#E5E5E5"> to audit those USB keys and because</font>

892
00:37:21,240 --> 00:37:25,740
the such audit is very time consuming

893
00:37:23,280 --> 00:37:28,410
<font color="#E5E5E5">and requires a lot of effort we believe</font>

894
00:37:25,740 --> 00:37:31,589
that<font color="#CCCCCC"> crowdsourcing the</font><font color="#E5E5E5"> effort and make</font>

895
00:37:28,410 --> 00:37:35,609
it a<font color="#E5E5E5"> community effort will be will be</font>

896
00:37:31,590 --> 00:37:37,950
<font color="#E5E5E5">the best for the</font><font color="#CCCCCC"> community one and I</font>

897
00:37:35,609 --> 00:37:41,279
<font color="#E5E5E5">think we have time for a couple of</font>

898
00:37:37,950 --> 00:37:43,399
<font color="#E5E5E5">questions so please use the mic thank</font>

899
00:37:41,280 --> 00:37:43,400
you

