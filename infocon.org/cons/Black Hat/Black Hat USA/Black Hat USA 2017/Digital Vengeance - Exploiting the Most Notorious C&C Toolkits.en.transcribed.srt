1
00:00:00,000 --> 00:00:03,240
first off thank<font color="#CCCCCC"> you guys for sticking</font>

2
00:00:01,560 --> 00:00:05,430
around to one of the<font color="#E5E5E5"> last sessions here</font>

3
00:00:03,240 --> 00:00:06,870
at<font color="#E5E5E5"> blackhat</font><font color="#CCCCCC"> I was half way</font><font color="#E5E5E5"> concerned</font>

4
00:00:05,430 --> 00:00:08,189
there'd be like<font color="#CCCCCC"> three of</font><font color="#E5E5E5"> us here and</font>

5
00:00:06,870 --> 00:00:10,889
maybe<font color="#E5E5E5"> we would just kind of sit</font><font color="#CCCCCC"> around</font><font color="#E5E5E5"> a</font>

6
00:00:08,189 --> 00:00:14,190
table and chat<font color="#E5E5E5"> so thank you for not</font>

7
00:00:10,889 --> 00:00:16,490
booking<font color="#E5E5E5"> those flights early</font><font color="#CCCCCC"> as he said</font>

8
00:00:14,190 --> 00:00:20,160
and<font color="#E5E5E5"> that's the title success</font><font color="#CCCCCC"> SiC</font>

9
00:00:16,490 --> 00:00:23,909
suggests we are<font color="#E5E5E5"> gonna be popping some</font>

10
00:00:20,160 --> 00:00:28,140
shells today particularly<font color="#E5E5E5"> in CNC</font><font color="#CCCCCC"> tool</font>

11
00:00:23,910 --> 00:00:29,640
<font color="#CCCCCC">kits</font><font color="#E5E5E5"> that are</font><font color="#CCCCCC"> very</font><font color="#E5E5E5"> very popular</font><font color="#CCCCCC"> before</font>

12
00:00:28,140 --> 00:00:31,230
we get there<font color="#CCCCCC"> though I do want to kind of</font>

13
00:00:29,640 --> 00:00:33,180
<font color="#E5E5E5">talk about a little</font><font color="#CCCCCC"> bit</font><font color="#E5E5E5"> of background a</font>

14
00:00:31,230 --> 00:00:34,530
<font color="#CCCCCC">little bit of issues surrounding this so</font>

15
00:00:33,180 --> 00:00:35,489
hang with<font color="#CCCCCC"> me we'll</font><font color="#E5E5E5"> get through the</font>

16
00:00:34,530 --> 00:00:38,309
boring<font color="#E5E5E5"> stuff and then we'll get to</font><font color="#CCCCCC"> the</font>

17
00:00:35,489 --> 00:00:41,309
fun stuff<font color="#E5E5E5"> at the end</font><font color="#CCCCCC"> quick background on</font>

18
00:00:38,309 --> 00:00:43,800
myself<font color="#CCCCCC"> I go by the handle alias</font>

19
00:00:41,309 --> 00:00:45,328
<font color="#E5E5E5">professor plum</font><font color="#CCCCCC"> I've been in</font><font color="#E5E5E5"> this</font>

20
00:00:43,800 --> 00:00:47,640
security<font color="#E5E5E5"> community for</font><font color="#CCCCCC"> over 10 years</font><font color="#E5E5E5"> now</font>

21
00:00:45,329 --> 00:00:49,649
<font color="#CCCCCC">I currently work</font><font color="#E5E5E5"> with Symantec as a</font>

22
00:00:47,640 --> 00:00:51,660
<font color="#E5E5E5">threat researcher before that I worked</font>

23
00:00:49,649 --> 00:00:54,090
for<font color="#E5E5E5"> the</font><font color="#CCCCCC"> Department of fence during</font><font color="#E5E5E5"> CNO</font>

24
00:00:51,660 --> 00:00:56,309
<font color="#E5E5E5">and before that</font><font color="#CCCCCC"> I've had my</font><font color="#E5E5E5"> time in the</font>

25
00:00:54,090 --> 00:00:58,890
trenches<font color="#CCCCCC"> as an IT manager</font><font color="#E5E5E5"> so I know what</font>

26
00:00:56,309 --> 00:01:00,300
it's like<font color="#E5E5E5"> to fight those fights I feel</font>

27
00:00:58,890 --> 00:01:02,309
like I have a good<font color="#CCCCCC"> roundabout</font>

28
00:01:00,300 --> 00:01:04,979
understanding of this from multiple

29
00:01:02,309 --> 00:01:07,890
<font color="#E5E5E5">perspectives</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> with my background</font>

30
00:01:04,979 --> 00:01:09,750
<font color="#CCCCCC">being discussed that shouldn't</font><font color="#E5E5E5"> come as a</font>

31
00:01:07,890 --> 00:01:12,590
surprise<font color="#CCCCCC"> that</font><font color="#E5E5E5"> I need to make some clear</font>

32
00:01:09,750 --> 00:01:14,909
disclaimers first off I do not<font color="#CCCCCC"> represent</font>

33
00:01:12,590 --> 00:01:17,670
<font color="#CCCCCC">adhere do</font><font color="#E5E5E5"> not necessarily represent</font>

34
00:01:14,909 --> 00:01:20,850
those<font color="#CCCCCC"> of my current or former employers</font>

35
00:01:17,670 --> 00:01:23,130
<font color="#CCCCCC">I had to make sure I state that second</font>

36
00:01:20,850 --> 00:01:25,939
is that what I'm<font color="#E5E5E5"> gonna discuss here is</font>

37
00:01:23,130 --> 00:01:28,259
probably<font color="#E5E5E5"> illegal from where almost</font>

38
00:01:25,939 --> 00:01:30,449
<font color="#E5E5E5">worldwide some places maybe not I</font>

39
00:01:28,259 --> 00:01:32,430
couldn't<font color="#E5E5E5"> speak for</font><font color="#CCCCCC"> everywhere but don't</font>

40
00:01:30,450 --> 00:01:33,990
hold me accountable if you decide to<font color="#E5E5E5"> use</font>

41
00:01:32,430 --> 00:01:36,390
<font color="#CCCCCC">some of this knowledge to do</font><font color="#E5E5E5"> something</font>

42
00:01:33,990 --> 00:01:37,649
that you<font color="#CCCCCC"> probably shouldn't I might want</font>

43
00:01:36,390 --> 00:01:39,570
<font color="#CCCCCC">to hear about it</font><font color="#E5E5E5"> but don't hold me</font>

44
00:01:37,650 --> 00:01:42,899
accountable for<font color="#CCCCCC"> anything that's</font><font color="#E5E5E5"> done</font>

45
00:01:39,570 --> 00:01:44,758
with this data<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> that out of the way</font>

46
00:01:42,899 --> 00:01:48,000
kind of wanted to talk<font color="#E5E5E5"> about what really</font>

47
00:01:44,759 --> 00:01:50,700
drove me<font color="#CCCCCC"> into this field and what would</font>

48
00:01:48,000 --> 00:01:53,549
<font color="#CCCCCC">started this talk and that is I really</font>

49
00:01:50,700 --> 00:01:56,090
really despise the defeatist attitude<font color="#CCCCCC"> in</font>

50
00:01:53,549 --> 00:01:58,439
the security community<font color="#CCCCCC"> the attitude that</font>

51
00:01:56,090 --> 00:02:00,990
there's<font color="#E5E5E5"> nothing</font><font color="#CCCCCC"> we could</font><font color="#E5E5E5"> do to block</font>

52
00:01:58,439 --> 00:02:03,539
ourselves<font color="#E5E5E5"> against the sky</font><font color="#CCCCCC"> right I hear</font>

53
00:02:00,990 --> 00:02:05,729
<font color="#E5E5E5">that the sophisticated actor term thrown</font>

54
00:02:03,540 --> 00:02:08,340
out there<font color="#E5E5E5"> a little bit and I it's used</font>

55
00:02:05,729 --> 00:02:09,899
as like an excuse oh they were

56
00:02:08,340 --> 00:02:12,239
sophisticated<font color="#E5E5E5"> we couldn't block him oh</font>

57
00:02:09,899 --> 00:02:13,220
it was<font color="#CCCCCC"> sophisticated they they got past</font>

58
00:02:12,239 --> 00:02:15,350
us

59
00:02:13,220 --> 00:02:17,750
and it just makes me<font color="#E5E5E5"> wonder a little</font><font color="#CCCCCC"> bit</font>

60
00:02:15,350 --> 00:02:19,370
like how does<font color="#CCCCCC"> that conversation go with</font>

61
00:02:17,750 --> 00:02:21,860
the sea levels when you have to explain

62
00:02:19,370 --> 00:02:24,410
<font color="#CCCCCC">you've been hacked it's like sir we've</font>

63
00:02:21,860 --> 00:02:26,600
we've been compromised<font color="#CCCCCC"> what how how</font>

64
00:02:24,410 --> 00:02:28,040
how'd that happen<font color="#CCCCCC"> oh</font><font color="#E5E5E5"> the actor was</font>

65
00:02:26,600 --> 00:02:28,370
sophisticated<font color="#CCCCCC"> there was nothing</font><font color="#E5E5E5"> we</font><font color="#CCCCCC"> could</font>

66
00:02:28,040 --> 00:02:32,030
do

67
00:02:28,370 --> 00:02:33,560
what do you mean sophisticated well<font color="#E5E5E5"> we</font>

68
00:02:32,030 --> 00:02:37,070
<font color="#CCCCCC">believe he was wearing a</font><font color="#E5E5E5"> monocle</font><font color="#CCCCCC"> so he's</font>

69
00:02:33,560 --> 00:02:40,430
clearly clearly sophisticated it doesn't

70
00:02:37,070 --> 00:02:42,650
to me<font color="#E5E5E5"> the sophisticated miss is not an</font>

71
00:02:40,430 --> 00:02:44,480
excuse in any sort<font color="#E5E5E5"> of way</font><font color="#CCCCCC"> and so</font><font color="#E5E5E5"> that's</font>

72
00:02:42,650 --> 00:02:46,430
really<font color="#E5E5E5"> what drove this talk</font><font color="#CCCCCC"> I decided to</font>

73
00:02:44,480 --> 00:02:50,660
look<font color="#E5E5E5"> at the tools used</font><font color="#CCCCCC"> by these</font>

74
00:02:46,430 --> 00:02:52,970
sophisticated actors and show that these

75
00:02:50,660 --> 00:02:54,709
attackers<font color="#E5E5E5"> are not impenetrable</font><font color="#CCCCCC"> that</font>

76
00:02:52,970 --> 00:02:56,240
they're not above the<font color="#CCCCCC"> law</font><font color="#E5E5E5"> and really</font>

77
00:02:54,709 --> 00:03:00,370
that they play<font color="#CCCCCC"> in the same playing field</font>

78
00:02:56,240 --> 00:03:01,970
<font color="#CCCCCC">we do and they make mistakes</font><font color="#E5E5E5"> so</font>

79
00:03:00,370 --> 00:03:03,980
basically we're going to<font color="#E5E5E5"> talk about</font>

80
00:03:01,970 --> 00:03:06,350
<font color="#E5E5E5">hacking back and this has been a very</font>

81
00:03:03,980 --> 00:03:09,369
<font color="#E5E5E5">hot</font><font color="#CCCCCC"> topic</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> a number of</font><font color="#E5E5E5"> years five</font>

82
00:03:06,350 --> 00:03:11,810
<font color="#E5E5E5">years ago at this conference</font><font color="#CCCCCC"> there was a</font>

83
00:03:09,370 --> 00:03:13,520
anonymous survey done where they asked

84
00:03:11,810 --> 00:03:15,800
attendees if they hadn't<font color="#CCCCCC"> participated in</font>

85
00:03:13,520 --> 00:03:19,100
hacking back and over<font color="#E5E5E5"> one third of the</font>

86
00:03:15,800 --> 00:03:22,730
<font color="#CCCCCC">attendee servants the little surveyed</font>

87
00:03:19,100 --> 00:03:25,489
<font color="#E5E5E5">excuse me</font><font color="#CCCCCC"> said they</font><font color="#E5E5E5"> had so what happens</font>

88
00:03:22,730 --> 00:03:28,340
<font color="#E5E5E5">it goes on right a lot</font><font color="#CCCCCC"> of the</font><font color="#E5E5E5"> people</font>

89
00:03:25,489 --> 00:03:31,040
feel they need<font color="#CCCCCC"> to strike back</font><font color="#E5E5E5"> in some</font>

90
00:03:28,340 --> 00:03:32,450
sort of form<font color="#E5E5E5"> but first option would be</font>

91
00:03:31,040 --> 00:03:35,980
<font color="#E5E5E5">to sue somebody but there's nobody to</font>

92
00:03:32,450 --> 00:03:38,238
sue<font color="#E5E5E5"> so Leo law enforcement is often left</font>

93
00:03:35,980 --> 00:03:40,910
<font color="#E5E5E5">weaponless or can't do</font><font color="#CCCCCC"> anything or or</font>

94
00:03:38,239 --> 00:03:42,290
spread too thin and a lot<font color="#E5E5E5"> of times these</font>

95
00:03:40,910 --> 00:03:46,519
<font color="#E5E5E5">corporations take matters into their own</font>

96
00:03:42,290 --> 00:03:49,100
hands<font color="#E5E5E5"> add to this a recent bill proposed</font>

97
00:03:46,519 --> 00:03:52,370
or not<font color="#E5E5E5"> proposed yet but drafted by</font>

98
00:03:49,100 --> 00:03:55,130
Senator<font color="#CCCCCC"> Tom graves</font><font color="#E5E5E5"> that is called the</font>

99
00:03:52,370 --> 00:03:58,640
app active cyber defense certainty actor

100
00:03:55,130 --> 00:04:02,090
or<font color="#CCCCCC"> ac/dc act</font><font color="#E5E5E5"> this bill would leave</font>

101
00:03:58,640 --> 00:04:03,950
victims exempt from the law to hack<font color="#CCCCCC"> back</font>

102
00:04:02,090 --> 00:04:07,760
against their assailants<font color="#E5E5E5"> if this was to</font>

103
00:04:03,950 --> 00:04:09,980
<font color="#CCCCCC">be passed</font><font color="#E5E5E5"> now</font><font color="#CCCCCC"> at first thought that that</font>

104
00:04:07,760 --> 00:04:11,590
bill that generally<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is considered</font><font color="#E5E5E5"> a</font>

105
00:04:09,980 --> 00:04:15,590
bad<font color="#CCCCCC"> idea</font><font color="#E5E5E5"> it's a</font><font color="#CCCCCC"> lose-lose situation</font>

106
00:04:11,590 --> 00:04:20,238
<font color="#CCCCCC">right</font><font color="#E5E5E5"> you can't hack back and get your</font>

107
00:04:15,590 --> 00:04:22,010
<font color="#CCCCCC">documents back any media star or any</font>

108
00:04:20,238 --> 00:04:23,989
<font color="#CCCCCC">Hollywood star who's have their photos</font>

109
00:04:22,010 --> 00:04:25,460
leaked online<font color="#E5E5E5"> knows you just</font><font color="#CCCCCC"> can't get</font>

110
00:04:23,990 --> 00:04:26,010
files back once they've left<font color="#E5E5E5"> your</font>

111
00:04:25,460 --> 00:04:29,849
parameter

112
00:04:26,010 --> 00:04:32,550
and we should know that<font color="#E5E5E5"> too furthermore</font>

113
00:04:29,850 --> 00:04:35,070
if you<font color="#E5E5E5"> do hack back there's very little</font>

114
00:04:32,550 --> 00:04:37,080
<font color="#E5E5E5">for the corporation to gain right you're</font>

115
00:04:35,070 --> 00:04:38,670
spending<font color="#E5E5E5"> your precious resources that</font>

116
00:04:37,080 --> 00:04:41,310
you could<font color="#E5E5E5"> be using to rebuild or to</font>

117
00:04:38,670 --> 00:04:44,190
<font color="#E5E5E5">block your things to instead go attack</font>

118
00:04:41,310 --> 00:04:45,750
somebody to just prove a point<font color="#E5E5E5"> to get</font>

119
00:04:44,190 --> 00:04:48,360
<font color="#E5E5E5">your revenge to make yourself</font><font color="#CCCCCC"> feel</font>

120
00:04:45,750 --> 00:04:51,870
better in some sort of way maybe none of

121
00:04:48,360 --> 00:04:53,700
<font color="#CCCCCC">that</font><font color="#E5E5E5"> really provides much in the terms</font>

122
00:04:51,870 --> 00:04:55,560
of<font color="#E5E5E5"> the corporation</font><font color="#CCCCCC"> not to mention the</font>

123
00:04:53,700 --> 00:04:57,360
risk<font color="#E5E5E5"> you're taking on attacking a server</font>

124
00:04:55,560 --> 00:04:59,910
<font color="#CCCCCC">that you're not</font><font color="#E5E5E5"> exactly sure where is or</font>

125
00:04:57,360 --> 00:05:02,010
who controls and what's to say<font color="#E5E5E5"> that they</font>

126
00:04:59,910 --> 00:05:03,840
don't<font color="#E5E5E5"> decide to attack back since you're</font>

127
00:05:02,010 --> 00:05:05,820
<font color="#E5E5E5">attacking them back and where does</font><font color="#CCCCCC"> it</font>

128
00:05:03,840 --> 00:05:07,679
end<font color="#CCCCCC"> what if a third party gets involved</font>

129
00:05:05,820 --> 00:05:09,780
<font color="#CCCCCC">and they decide to hack back it can lead</font>

130
00:05:07,680 --> 00:05:11,310
<font color="#CCCCCC">to a very</font><font color="#E5E5E5"> very messy situation</font><font color="#CCCCCC"> and</font>

131
00:05:09,780 --> 00:05:13,849
generally<font color="#E5E5E5"> I would recommend it's</font>

132
00:05:11,310 --> 00:05:16,530
probably<font color="#E5E5E5"> not the best use of this but</font>

133
00:05:13,850 --> 00:05:17,910
there<font color="#E5E5E5"> are some areas where</font><font color="#CCCCCC"> I think think</font>

134
00:05:16,530 --> 00:05:20,580
that<font color="#E5E5E5"> this kind of</font><font color="#CCCCCC"> technology or this</font>

135
00:05:17,910 --> 00:05:24,330
technique may be<font color="#CCCCCC"> useful and that's more</font>

136
00:05:20,580 --> 00:05:26,039
<font color="#E5E5E5">around attribution and tracking if one</font>

137
00:05:24,330 --> 00:05:27,510
is<font color="#E5E5E5"> to hack</font><font color="#CCCCCC"> back into another</font><font color="#E5E5E5"> group and</font>

138
00:05:26,040 --> 00:05:29,730
<font color="#E5E5E5">then does just sit quietly and listen</font>

139
00:05:27,510 --> 00:05:31,560
<font color="#CCCCCC">they can observe many things about</font><font color="#E5E5E5"> their</font>

140
00:05:29,730 --> 00:05:33,660
assailant<font color="#CCCCCC"> they can</font><font color="#E5E5E5"> observe maybe who</font>

141
00:05:31,560 --> 00:05:35,070
else they're targeting maybe what files

142
00:05:33,660 --> 00:05:38,100
they're interested in what did they pull

143
00:05:35,070 --> 00:05:40,320
from<font color="#CCCCCC"> you</font><font color="#E5E5E5"> or how they work and all of</font>

144
00:05:38,100 --> 00:05:42,930
that kind of<font color="#CCCCCC"> information I as a</font><font color="#E5E5E5"> security</font>

145
00:05:40,320 --> 00:05:44,520
<font color="#E5E5E5">researcher would love to have because it</font>

146
00:05:42,930 --> 00:05:46,080
helps do attribution a whole lot better

147
00:05:44,520 --> 00:05:48,210
than<font color="#CCCCCC"> just</font><font color="#E5E5E5"> looking at the artifacts that</font>

148
00:05:46,080 --> 00:05:50,370
<font color="#CCCCCC">they leave on discs by obsidian</font><font color="#E5E5E5"> I'm</font>

149
00:05:48,210 --> 00:05:52,049
deserving<font color="#CCCCCC"> the attacker that's that's a</font>

150
00:05:50,370 --> 00:05:54,510
one<font color="#E5E5E5"> information when it comes to</font>

151
00:05:52,050 --> 00:05:57,330
attribution and to be honest and to<font color="#CCCCCC"> be</font>

152
00:05:54,510 --> 00:06:00,330
fair the ac/dc<font color="#CCCCCC"> act</font><font color="#E5E5E5"> that's actually what</font>

153
00:05:57,330 --> 00:06:02,490
it<font color="#E5E5E5"> tries to do in fact the ac/dc Act</font>

154
00:06:00,330 --> 00:06:04,320
does not allow hacking back for the

155
00:06:02,490 --> 00:06:08,640
purpose of<font color="#CCCCCC"> causing destruction</font><font color="#E5E5E5"> damage or</font>

156
00:06:04,320 --> 00:06:12,240
physical industry or physical injury<font color="#E5E5E5"> but</font>

157
00:06:08,640 --> 00:06:14,550
instead<font color="#E5E5E5"> it allows hacking back for the</font>

158
00:06:12,240 --> 00:06:16,440
establishment of attribution<font color="#E5E5E5"> of the</font>

159
00:06:14,550 --> 00:06:18,990
criminal activity<font color="#E5E5E5"> and to monitor the</font>

160
00:06:16,440 --> 00:06:21,210
behavior<font color="#E5E5E5"> of the attacker so to be</font><font color="#CCCCCC"> fair</font>

161
00:06:18,990 --> 00:06:22,890
that the Act does sound like they're

162
00:06:21,210 --> 00:06:25,080
<font color="#E5E5E5">trying to do the right</font><font color="#CCCCCC"> thing right</font><font color="#E5E5E5"> it's</font>

163
00:06:22,890 --> 00:06:27,690
still<font color="#E5E5E5"> opening the can of worms but</font><font color="#CCCCCC"> I</font>

164
00:06:25,080 --> 00:06:30,659
think it<font color="#CCCCCC"> gets more</font><font color="#E5E5E5"> than</font><font color="#CCCCCC"> a bad rap</font><font color="#E5E5E5"> than</font>

165
00:06:27,690 --> 00:06:32,820
it should probably now I know you didn't

166
00:06:30,660 --> 00:06:35,130
hear me<font color="#CCCCCC"> come here to hear</font><font color="#E5E5E5"> me ramble on</font>

167
00:06:32,820 --> 00:06:37,530
about my emotions or<font color="#CCCCCC"> feelings about</font><font color="#E5E5E5"> the</font>

168
00:06:35,130 --> 00:06:38,670
issue<font color="#E5E5E5"> so I'm gonna cut the rant short</font>

169
00:06:37,530 --> 00:06:40,049
here<font color="#CCCCCC"> I'd love to have</font>

170
00:06:38,670 --> 00:06:43,140
this conversation<font color="#CCCCCC"> over a</font><font color="#E5E5E5"> drink with</font>

171
00:06:40,050 --> 00:06:45,690
somebody after<font color="#CCCCCC"> the fact but let's get</font><font color="#E5E5E5"> on</font>

172
00:06:43,140 --> 00:06:48,270
<font color="#E5E5E5">move on with things</font>

173
00:06:45,690 --> 00:06:52,260
<font color="#CCCCCC">gotta kind of do some of</font><font color="#E5E5E5"> the groundwork</font>

174
00:06:48,270 --> 00:06:54,270
<font color="#E5E5E5">terminology here</font><font color="#CCCCCC"> unfortunately</font><font color="#E5E5E5"> even c2</font>

175
00:06:52,260 --> 00:06:56,070
communication terminology is kind<font color="#CCCCCC"> of</font>

176
00:06:54,270 --> 00:06:58,469
<font color="#E5E5E5">confusing I've heard that</font><font color="#CCCCCC"> royal server</font>

177
00:06:56,070 --> 00:07:00,570
and client used interchangeably for<font color="#CCCCCC"> the</font>

178
00:06:58,470 --> 00:07:02,550
different pieces<font color="#CCCCCC"> so I'm gonna outline</font>

179
00:07:00,570 --> 00:07:05,880
<font color="#CCCCCC">here the terminology I'm gonna use</font><font color="#E5E5E5"> for</font>

180
00:07:02,550 --> 00:07:07,320
<font color="#E5E5E5">this the client</font><font color="#CCCCCC"> piece</font><font color="#E5E5E5"> is the malware</font>

181
00:07:05,880 --> 00:07:09,780
piece that<font color="#E5E5E5"> runs on the machine</font><font color="#CCCCCC"> and the</font>

182
00:07:07,320 --> 00:07:11,520
server<font color="#CCCCCC"> is the</font><font color="#E5E5E5"> c2 server</font><font color="#CCCCCC"> all right that's</font>

183
00:07:09,780 --> 00:07:13,590
how I'm gonna<font color="#E5E5E5"> use those terms</font><font color="#CCCCCC"> I'm gonna</font>

184
00:07:11,520 --> 00:07:15,570
try<font color="#E5E5E5"> to avoid using attacker and victim</font>

185
00:07:13,590 --> 00:07:17,310
because in our scenarios the attacker

186
00:07:15,570 --> 00:07:20,219
becomes the victim<font color="#CCCCCC"> and that will cause</font>

187
00:07:17,310 --> 00:07:22,850
<font color="#E5E5E5">confusion as well</font><font color="#CCCCCC"> so the</font><font color="#E5E5E5"> original victim</font>

188
00:07:20,220 --> 00:07:25,380
<font color="#CCCCCC">I will try to call</font><font color="#E5E5E5"> the target the</font>

189
00:07:22,850 --> 00:07:27,390
original<font color="#E5E5E5"> c2 owner I will call the</font>

190
00:07:25,380 --> 00:07:28,860
adversary<font color="#E5E5E5"> and then the one who was</font>

191
00:07:27,390 --> 00:07:30,840
<font color="#CCCCCC">hacking back</font><font color="#E5E5E5"> I would call the retaliate</font>

192
00:07:28,860 --> 00:07:33,810
<font color="#CCCCCC">er I like that term the dictionary</font>

193
00:07:30,840 --> 00:07:36,150
definition if definition of it is one

194
00:07:33,810 --> 00:07:38,610
who returns<font color="#CCCCCC"> assaulting kind</font><font color="#E5E5E5"> so I felt</font>

195
00:07:36,150 --> 00:07:41,549
<font color="#CCCCCC">that</font><font color="#E5E5E5"> was</font><font color="#CCCCCC"> very appropriate for this role</font>

196
00:07:38,610 --> 00:07:44,310
this<font color="#E5E5E5"> set up here</font><font color="#CCCCCC"> and how I went</font><font color="#E5E5E5"> about my</font>

197
00:07:41,550 --> 00:07:47,100
<font color="#E5E5E5">procedure for doing this</font><font color="#CCCCCC"> a colleague of</font>

198
00:07:44,310 --> 00:07:48,180
mine had taken all<font color="#CCCCCC"> of the apt reports</font>

199
00:07:47,100 --> 00:07:50,850
that have been<font color="#E5E5E5"> released over the last</font>

200
00:07:48,180 --> 00:07:53,250
<font color="#E5E5E5">few years and kind</font><font color="#CCCCCC"> of summarized in a</font>

201
00:07:50,850 --> 00:07:54,930
popularity hit of what malware trolls

202
00:07:53,250 --> 00:07:57,660
were most commonly cited<font color="#E5E5E5"> in these</font>

203
00:07:54,930 --> 00:07:59,820
reports<font color="#CCCCCC"> and I thought this would make a</font>

204
00:07:57,660 --> 00:08:01,860
great shopping<font color="#E5E5E5"> list</font><font color="#CCCCCC"> I'll just start at</font>

205
00:07:59,820 --> 00:08:03,510
<font color="#CCCCCC">the</font><font color="#E5E5E5"> top of the list get a hold of the</font>

206
00:08:01,860 --> 00:08:06,420
tool<font color="#E5E5E5"> and see what vulnerabilities I can</font>

207
00:08:03,510 --> 00:08:08,670
find in it and so as you<font color="#E5E5E5"> see at the top</font>

208
00:08:06,420 --> 00:08:13,230
<font color="#E5E5E5">of this list is poison ivy and some of</font>

209
00:08:08,670 --> 00:08:14,490
you may be<font color="#E5E5E5"> aware that poison ivy has</font>

210
00:08:13,230 --> 00:08:16,440
already been exploited<font color="#CCCCCC"> it's not</font>

211
00:08:14,490 --> 00:08:18,450
something I was<font color="#E5E5E5"> going to hit it actually</font>

212
00:08:16,440 --> 00:08:20,040
was exploited by these individuals at

213
00:08:18,450 --> 00:08:22,050
the bottom<font color="#E5E5E5"> I will</font><font color="#CCCCCC"> not try to say their</font>

214
00:08:20,040 --> 00:08:23,340
names because<font color="#E5E5E5"> I would horribly do I</font>

215
00:08:22,050 --> 00:08:25,280
wouldn't<font color="#CCCCCC"> do it justice and I just sound</font>

216
00:08:23,340 --> 00:08:27,659
like<font color="#E5E5E5"> a fool but these guys found a</font>

217
00:08:25,280 --> 00:08:30,479
buffer overflow which allowed remote

218
00:08:27,660 --> 00:08:35,030
code execution<font color="#E5E5E5"> in the</font><font color="#CCCCCC"> poison ivy</font><font color="#E5E5E5"> c2</font>

219
00:08:30,480 --> 00:08:40,890
server<font color="#CCCCCC"> even more interesting is that</font>

220
00:08:35,030 --> 00:08:43,228
after<font color="#E5E5E5"> now after whoops yes</font>

221
00:08:40,890 --> 00:08:46,410
after mandiant released their<font color="#E5E5E5"> apt one</font>

222
00:08:43,229 --> 00:08:49,170
report the<font color="#CCCCCC"> the group the guys at malware</font>

223
00:08:46,410 --> 00:08:51,430
<font color="#E5E5E5">L you notice that in that report it</font>

224
00:08:49,170 --> 00:08:54,490
mentioned that the<font color="#CCCCCC"> ABT one group you</font>

225
00:08:51,430 --> 00:08:57,160
poison ivy so the apt so the malware<font color="#CCCCCC"> Lu</font>

226
00:08:54,490 --> 00:08:59,830
guys exploited the poison ivy<font color="#E5E5E5"> servers</font>

227
00:08:57,160 --> 00:09:01,750
<font color="#E5E5E5">landed on them and then</font><font color="#CCCCCC"> just listened</font>

228
00:08:59,830 --> 00:09:03,100
and observed and enumerated the

229
00:09:01,750 --> 00:09:04,899
attackers<font color="#CCCCCC"> Network</font>

230
00:09:03,100 --> 00:09:06,339
they then documented all this and

231
00:09:04,899 --> 00:09:08,020
provided it publicly<font color="#E5E5E5"> it's one of the</font>

232
00:09:06,339 --> 00:09:09,970
rare<font color="#CCCCCC"> cases</font><font color="#E5E5E5"> where we have this kind</font><font color="#CCCCCC"> of</font>

233
00:09:08,020 --> 00:09:12,670
information<font color="#CCCCCC"> from a</font><font color="#E5E5E5"> hack back attempt and</font>

234
00:09:09,970 --> 00:09:15,040
the information<font color="#E5E5E5"> is golden they outline</font>

235
00:09:12,670 --> 00:09:16,630
<font color="#E5E5E5">they were able to outline their</font>

236
00:09:15,040 --> 00:09:18,069
infrastructure that's an image stolen

237
00:09:16,630 --> 00:09:20,020
from their document describing<font color="#E5E5E5"> how they</font>

238
00:09:18,070 --> 00:09:22,390
have their attacker infrastructure built

239
00:09:20,020 --> 00:09:24,100
they<font color="#CCCCCC"> outlined they found additional</font>

240
00:09:22,390 --> 00:09:26,380
tools used by<font color="#CCCCCC"> this group and exposed</font>

241
00:09:24,100 --> 00:09:28,029
them and they were able<font color="#E5E5E5"> to give TTP's of</font>

242
00:09:26,380 --> 00:09:29,620
how this<font color="#E5E5E5"> group acts so defenders could</font>

243
00:09:28,029 --> 00:09:31,720
know better what<font color="#CCCCCC"> to watch for and</font><font color="#E5E5E5"> what</font>

244
00:09:29,620 --> 00:09:33,520
<font color="#E5E5E5">to look for it was very insightful and</font><font color="#CCCCCC"> I</font>

245
00:09:31,720 --> 00:09:37,810
think it shows<font color="#CCCCCC"> just the potential</font><font color="#E5E5E5"> behind</font>

246
00:09:33,520 --> 00:09:39,610
<font color="#E5E5E5">this kind</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> attacking back also</font><font color="#CCCCCC"> on that</font>

247
00:09:37,810 --> 00:09:41,739
<font color="#CCCCCC">list</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> already was exploited was</font><font color="#E5E5E5"> dark</font>

248
00:09:39,610 --> 00:09:43,899
<font color="#E5E5E5">comment it was down there are ways but I</font>

249
00:09:41,740 --> 00:09:45,490
still<font color="#E5E5E5"> felt it's</font><font color="#CCCCCC"> worth mentioning dark</font>

250
00:09:43,899 --> 00:09:48,370
comment was<font color="#E5E5E5"> exploited by these guys and</font>

251
00:09:45,490 --> 00:09:50,260
their exploit was<font color="#E5E5E5"> remote file retrieval</font>

252
00:09:48,370 --> 00:09:53,350
<font color="#E5E5E5">so you could blindly copy a file off</font>

253
00:09:50,260 --> 00:09:54,610
that server<font color="#E5E5E5"> but I have no evidence or I</font>

254
00:09:53,350 --> 00:09:59,830
have no<font color="#E5E5E5"> documentation of where it's been</font>

255
00:09:54,610 --> 00:10:01,180
used<font color="#E5E5E5"> shoot</font><font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> rolling but that's</font><font color="#CCCCCC"> okay I</font>

256
00:09:59,830 --> 00:10:04,480
can just<font color="#CCCCCC"> spend</font><font color="#E5E5E5"> more time on the exploits</font>

257
00:10:01,180 --> 00:10:06,939
<font color="#E5E5E5">let's play with the new stuff now I'm</font>

258
00:10:04,480 --> 00:10:09,130
gonna<font color="#E5E5E5"> work</font><font color="#CCCCCC"> my way from least interesting</font>

259
00:10:06,940 --> 00:10:11,260
up bottom up on that list<font color="#CCCCCC"> I just took</font>

260
00:10:09,130 --> 00:10:13,839
the top<font color="#E5E5E5"> three</font><font color="#CCCCCC"> euro blow poison ivy and</font>

261
00:10:11,260 --> 00:10:15,939
so the third one<font color="#E5E5E5"> I looked at the least</font>

262
00:10:13,839 --> 00:10:19,150
interesting in my opinion<font color="#E5E5E5"> was extreme</font>

263
00:10:15,940 --> 00:10:20,529
rat<font color="#CCCCCC"> extreme rat has been</font><font color="#E5E5E5"> around for a</font>

264
00:10:19,150 --> 00:10:22,600
little<font color="#CCCCCC"> while it was originally developed</font>

265
00:10:20,529 --> 00:10:25,240
<font color="#E5E5E5">as a commercial tool</font><font color="#CCCCCC"> this is a</font>

266
00:10:22,600 --> 00:10:26,800
<font color="#E5E5E5">screenshot of the tool itself</font><font color="#CCCCCC"> I have one</font>

267
00:10:25,240 --> 00:10:29,080
<font color="#CCCCCC">victim</font><font color="#E5E5E5"> and I right clicked on the victim</font>

268
00:10:26,800 --> 00:10:30,880
<font color="#CCCCCC">and</font><font color="#E5E5E5"> you can see there</font><font color="#CCCCCC"> that drop down the</font>

269
00:10:29,080 --> 00:10:32,709
capabilities the tool offers<font color="#E5E5E5"> the</font>

270
00:10:30,880 --> 00:10:35,170
attacker<font color="#E5E5E5"> to do against their victim they</font>

271
00:10:32,709 --> 00:10:37,930
can spawn shells<font color="#E5E5E5"> drop grab files</font>

272
00:10:35,170 --> 00:10:39,969
you know pings<font color="#E5E5E5"> you just drop a</font><font color="#CCCCCC"> keylogger</font>

273
00:10:37,930 --> 00:10:42,550
<font color="#E5E5E5">there's a lot of a lot of capabilities</font>

274
00:10:39,970 --> 00:10:44,410
built in this tool<font color="#E5E5E5"> the tool also has</font>

275
00:10:42,550 --> 00:10:46,420
<font color="#E5E5E5">additional capabilities that they kind</font>

276
00:10:44,410 --> 00:10:48,100
of make me laugh it's got a game built

277
00:10:46,420 --> 00:10:50,469
<font color="#E5E5E5">in it that you can kind of play</font><font color="#CCCCCC"> I guess</font>

278
00:10:48,100 --> 00:10:52,959
while you're waiting for your malware to

279
00:10:50,470 --> 00:10:56,620
land or your guys to click on the email

280
00:10:52,959 --> 00:10:58,089
<font color="#CCCCCC">it was it looks to me to be a targeting</font>

281
00:10:56,620 --> 00:11:00,130
to the script<font color="#E5E5E5"> kitty there's a lot of</font>

282
00:10:58,089 --> 00:11:03,130
very easy point-and-click type features

283
00:11:00,130 --> 00:11:05,810
here<font color="#CCCCCC"> that being said</font>

284
00:11:03,130 --> 00:11:07,610
it has<font color="#CCCCCC"> also still been used by a lot of</font>

285
00:11:05,810 --> 00:11:09,260
suppose<font color="#E5E5E5"> admission state actor groups</font>

286
00:11:07,610 --> 00:11:11,360
<font color="#CCCCCC">these are a number</font><font color="#E5E5E5"> of news articles</font>

287
00:11:09,260 --> 00:11:14,360
where extreme rat was cited as the<font color="#E5E5E5"> tool</font>

288
00:11:11,360 --> 00:11:16,190
of choice<font color="#E5E5E5"> for the particular actor it's</font>

289
00:11:14,360 --> 00:11:18,190
been seen in target and<font color="#E5E5E5"> attacks against</font>

290
00:11:16,190 --> 00:11:22,480
<font color="#CCCCCC">the Israeli government against the</font>

291
00:11:18,190 --> 00:11:25,520
conflicts in<font color="#CCCCCC"> Syria and the Gaza Strip</font>

292
00:11:22,480 --> 00:11:27,890
extreme<font color="#CCCCCC"> rat</font><font color="#E5E5E5"> is most easily identifiable</font>

293
00:11:25,520 --> 00:11:31,010
in my mind<font color="#E5E5E5"> based on its a</font><font color="#CCCCCC"> c2</font>

294
00:11:27,890 --> 00:11:32,449
communication protocol<font color="#E5E5E5"> typically there's</font>

295
00:11:31,010 --> 00:11:34,640
a number of<font color="#E5E5E5"> ways</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> can talk home and</font>

296
00:11:32,450 --> 00:11:38,420
communicate home but typically we see it

297
00:11:34,640 --> 00:11:42,530
used either TCP<font color="#E5E5E5"> raw TCP or a pseudo a</font>

298
00:11:38,420 --> 00:11:45,079
fake HTTP request the TCP connection the

299
00:11:42,530 --> 00:11:47,089
<font color="#E5E5E5">Vic target component always responds</font>

300
00:11:45,080 --> 00:11:49,130
home with a packet that<font color="#CCCCCC"> says</font><font color="#E5E5E5"> my version</font>

301
00:11:47,090 --> 00:11:51,710
pipe and then a number which<font color="#E5E5E5"> is the</font>

302
00:11:49,130 --> 00:11:55,070
<font color="#CCCCCC">number of the extreme</font><font color="#E5E5E5"> rat usually</font><font color="#CCCCCC"> 3.6</font><font color="#E5E5E5"> or</font>

303
00:11:51,710 --> 00:11:57,110
<font color="#CCCCCC">3.7 or so then the server responds with</font>

304
00:11:55,070 --> 00:11:59,840
the<font color="#E5E5E5"> X character</font><font color="#CCCCCC"> followed by a line feed</font>

305
00:11:57,110 --> 00:12:01,940
carriage return<font color="#CCCCCC"> that's very</font><font color="#E5E5E5"> easy to</font>

306
00:11:59,840 --> 00:12:03,500
<font color="#E5E5E5">signature there's already snort</font>

307
00:12:01,940 --> 00:12:04,970
signatures and such out there for it<font color="#E5E5E5"> but</font>

308
00:12:03,500 --> 00:12:06,850
it's easy to<font color="#CCCCCC"> identify this</font><font color="#E5E5E5"> if you see</font>

309
00:12:04,970 --> 00:12:09,350
this<font color="#E5E5E5"> traffic pattern it's extreme rat</font>

310
00:12:06,850 --> 00:12:11,990
<font color="#E5E5E5">I'll turn the deadly it</font><font color="#CCCCCC"> can try to mask</font>

311
00:12:09,350 --> 00:12:14,630
its initial call home by making<font color="#CCCCCC"> a HTTP</font>

312
00:12:11,990 --> 00:12:16,130
request<font color="#E5E5E5"> but that HTTP request is also</font>

313
00:12:14,630 --> 00:12:19,010
<font color="#E5E5E5">easy to signature it always takes the</font>

314
00:12:16,130 --> 00:12:22,280
form<font color="#CCCCCC"> of a get request</font><font color="#E5E5E5"> for some number</font>

315
00:12:19,010 --> 00:12:25,400
dot functions<font color="#E5E5E5"> and that some number is a</font>

316
00:12:22,280 --> 00:12:27,709
<font color="#E5E5E5">password put in by the attacker and that</font>

317
00:12:25,400 --> 00:12:29,329
password is limited to all numbers and

318
00:12:27,710 --> 00:12:31,070
it can only be<font color="#E5E5E5"> 10 characters long</font>

319
00:12:29,330 --> 00:12:32,930
<font color="#E5E5E5">so it's easy enough to make</font><font color="#CCCCCC"> a regex</font>

320
00:12:31,070 --> 00:12:34,670
pattern to look<font color="#E5E5E5"> for a series of numbers</font>

321
00:12:32,930 --> 00:12:37,849
dot functions if you see that<font color="#E5E5E5"> URL</font>

322
00:12:34,670 --> 00:12:40,849
request<font color="#E5E5E5"> that's a extreme rat</font><font color="#CCCCCC"> trying to</font>

323
00:12:37,850 --> 00:12:42,830
<font color="#CCCCCC">beacon home and once it makes</font><font color="#E5E5E5"> that HTTP</font>

324
00:12:40,850 --> 00:12:44,390
request<font color="#E5E5E5"> it just turns into a raw socket</font>

325
00:12:42,830 --> 00:12:47,360
doesn't actually make an official HTTP

326
00:12:44,390 --> 00:12:49,250
<font color="#E5E5E5">it doesn't follow the protocol at all so</font>

327
00:12:47,360 --> 00:12:50,480
I started with<font color="#CCCCCC"> look</font><font color="#E5E5E5"> looking into this</font>

328
00:12:49,250 --> 00:12:52,430
guy for exploits looking for

329
00:12:50,480 --> 00:12:54,620
vulnerabilities<font color="#E5E5E5"> and I just kind of</font>

330
00:12:52,430 --> 00:12:56,180
observed how it did<font color="#E5E5E5"> its communications</font>

331
00:12:54,620 --> 00:13:02,360
and one of the things that<font color="#E5E5E5"> quickly stood</font>

332
00:12:56,180 --> 00:13:05,750
out to me was well I'll show<font color="#CCCCCC"> you so when</font>

333
00:13:02,360 --> 00:13:08,660
the c2 server<font color="#CCCCCC"> wants to</font><font color="#E5E5E5"> deliver a piece</font>

334
00:13:05,750 --> 00:13:10,460
of<font color="#E5E5E5"> an additional tool to its victim then</font>

335
00:13:08,660 --> 00:13:12,650
<font color="#E5E5E5">it'll send a message to the target</font>

336
00:13:10,460 --> 00:13:14,720
component and it says hey get ready<font color="#E5E5E5"> to</font>

337
00:13:12,650 --> 00:13:15,840
<font color="#CCCCCC">receive this file</font><font color="#E5E5E5"> that I have is called</font>

338
00:13:14,720 --> 00:13:18,090
tooled up bad and<font color="#CCCCCC"> I</font>

339
00:13:15,840 --> 00:13:20,190
want you to<font color="#E5E5E5"> save</font><font color="#CCCCCC"> it to</font><font color="#E5E5E5"> C Drive you know</font>

340
00:13:18,090 --> 00:13:23,910
tamp<font color="#E5E5E5"> whatever wherever he wants to try</font>

341
00:13:20,190 --> 00:13:25,950
to<font color="#E5E5E5"> hide the file then</font><font color="#CCCCCC"> the victim in this</font>

342
00:13:23,910 --> 00:13:28,170
<font color="#E5E5E5">case</font><font color="#CCCCCC"> the the target will respond and say</font>

343
00:13:25,950 --> 00:13:32,400
okay I'm ready<font color="#E5E5E5"> to receive your file</font>

344
00:13:28,170 --> 00:13:34,349
named tool<font color="#E5E5E5"> slash</font><font color="#CCCCCC"> VAD</font><font color="#E5E5E5"> exe and then the</font>

345
00:13:32,400 --> 00:13:36,480
extreme rat<font color="#E5E5E5"> situ server will respond</font>

346
00:13:34,350 --> 00:13:39,270
with the<font color="#E5E5E5"> actual data for that now when I</font>

347
00:13:36,480 --> 00:13:42,540
find interesting in<font color="#E5E5E5"> this exchange here</font>

348
00:13:39,270 --> 00:13:45,210
is that the<font color="#CCCCCC"> c2 server tells the target</font>

349
00:13:42,540 --> 00:13:47,040
<font color="#E5E5E5">computer the local path to the file that</font>

350
00:13:45,210 --> 00:13:48,270
it has it doesn't<font color="#E5E5E5"> need to tell the</font>

351
00:13:47,040 --> 00:13:50,550
victim where it's storing the file

352
00:13:48,270 --> 00:13:52,380
<font color="#CCCCCC">locally but</font><font color="#E5E5E5"> it does for some reason and</font>

353
00:13:50,550 --> 00:13:54,270
it made me<font color="#E5E5E5"> think why</font><font color="#CCCCCC"> would it do that</font>

354
00:13:52,380 --> 00:13:55,680
<font color="#E5E5E5">well maybe it does that because it</font>

355
00:13:54,270 --> 00:13:57,540
<font color="#E5E5E5">doesn't want to have to keep any state</font>

356
00:13:55,680 --> 00:13:59,280
it<font color="#E5E5E5"> doesn't have to remember the fact</font>

357
00:13:57,540 --> 00:14:01,199
<font color="#CCCCCC">that I sent a request</font><font color="#E5E5E5"> to that guy</font><font color="#CCCCCC"> and</font>

358
00:13:59,280 --> 00:14:03,030
when he responds ready<font color="#E5E5E5"> that I have to go</font>

359
00:14:01,200 --> 00:14:04,500
look<font color="#E5E5E5"> up what the file name is he already</font>

360
00:14:03,030 --> 00:14:06,689
<font color="#E5E5E5">tells me the file name he reminds me of</font>

361
00:14:04,500 --> 00:14:08,190
<font color="#CCCCCC">the</font><font color="#E5E5E5"> file name and so because of</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> I</font>

362
00:14:06,690 --> 00:14:11,520
<font color="#E5E5E5">thought well if he's not keeping any</font>

363
00:14:08,190 --> 00:14:13,640
state then he won't notice if the top

364
00:14:11,520 --> 00:14:15,870
packet never happens<font color="#E5E5E5"> right if I just</font>

365
00:14:13,640 --> 00:14:18,330
<font color="#E5E5E5">solicit the fact that I'm ready to</font>

366
00:14:15,870 --> 00:14:20,550
<font color="#CCCCCC">receive your file tool that bad sure</font>

367
00:14:18,330 --> 00:14:22,800
enough<font color="#E5E5E5"> the extreme</font><font color="#CCCCCC"> rat server will</font>

368
00:14:20,550 --> 00:14:25,229
respond by giving<font color="#CCCCCC"> me the contents</font><font color="#E5E5E5"> of</font>

369
00:14:22,800 --> 00:14:28,349
file tool not bad<font color="#E5E5E5"> so I can blindly</font>

370
00:14:25,230 --> 00:14:30,090
retrieve any file from<font color="#CCCCCC"> that c2 server if</font>

371
00:14:28,350 --> 00:14:31,470
I know what if I know it exists

372
00:14:30,090 --> 00:14:33,180
<font color="#CCCCCC">you know I can</font><font color="#E5E5E5"> kind</font><font color="#CCCCCC"> of brute force this</font>

373
00:14:31,470 --> 00:14:35,820
I could try every file but that's<font color="#E5E5E5"> that</font>

374
00:14:33,180 --> 00:14:37,890
<font color="#E5E5E5">sounds extreme so just maybe a few</font><font color="#CCCCCC"> ideas</font>

375
00:14:35,820 --> 00:14:39,690
<font color="#CCCCCC">of things</font><font color="#E5E5E5"> you would want</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> pull and</font>

376
00:14:37,890 --> 00:14:41,970
these are all<font color="#E5E5E5"> taken</font><font color="#CCCCCC"> from</font><font color="#E5E5E5"> the URL</font><font color="#CCCCCC"> at the</font>

377
00:14:39,690 --> 00:14:43,740
<font color="#CCCCCC">bottom here maybe</font><font color="#E5E5E5"> you'd want to pull</font>

378
00:14:41,970 --> 00:14:45,420
<font color="#CCCCCC">wind ini it's just kind of a sanity</font>

379
00:14:43,740 --> 00:14:47,130
check<font color="#CCCCCC"> that file should</font><font color="#E5E5E5"> exist on all</font>

380
00:14:45,420 --> 00:14:49,110
<font color="#E5E5E5">Windows</font><font color="#CCCCCC"> versions</font><font color="#E5E5E5"> if you pull that back</font>

381
00:14:47,130 --> 00:14:51,960
then we have a<font color="#E5E5E5"> good</font><font color="#CCCCCC"> ok we're</font><font color="#E5E5E5"> working as</font>

382
00:14:49,110 --> 00:14:53,520
we expect<font color="#CCCCCC"> you might be able to glean the</font>

383
00:14:51,960 --> 00:14:55,620
type of<font color="#E5E5E5"> Windows that the target is</font>

384
00:14:53,520 --> 00:14:57,240
<font color="#CCCCCC">running beyond that fight via that file</font>

385
00:14:55,620 --> 00:14:59,370
and<font color="#E5E5E5"> if you know that then you know where</font>

386
00:14:57,240 --> 00:15:00,810
the event logs are stored<font color="#CCCCCC"> so we can</font>

387
00:14:59,370 --> 00:15:03,660
maybe pull back the event logs from the

388
00:15:00,810 --> 00:15:05,250
<font color="#E5E5E5">host:it event logs can sometimes have</font>

389
00:15:03,660 --> 00:15:08,280
<font color="#E5E5E5">some great</font><font color="#CCCCCC"> information you might be</font><font color="#E5E5E5"> able</font>

390
00:15:05,250 --> 00:15:10,410
<font color="#E5E5E5">to determine the user user ID</font><font color="#CCCCCC"> of the</font>

391
00:15:08,280 --> 00:15:12,000
computer or the user running on the

392
00:15:10,410 --> 00:15:13,680
computer<font color="#CCCCCC"> and if you know the user ID</font>

393
00:15:12,000 --> 00:15:15,660
<font color="#E5E5E5">then you can look in their home</font>

394
00:15:13,680 --> 00:15:17,370
directory<font color="#CCCCCC"> for</font><font color="#E5E5E5"> the desktop dot ini file</font>

395
00:15:15,660 --> 00:15:20,189
because the<font color="#E5E5E5"> desktop that I and I file</font>

396
00:15:17,370 --> 00:15:21,960
may reveal<font color="#CCCCCC"> the names of folders on that</font>

397
00:15:20,190 --> 00:15:23,280
<font color="#CCCCCC">user's desktop and if we know</font><font color="#E5E5E5"> the name</font>

398
00:15:21,960 --> 00:15:24,480
<font color="#E5E5E5">of folders none that users desktop we</font>

399
00:15:23,280 --> 00:15:26,970
may have an<font color="#CCCCCC"> idea of</font><font color="#E5E5E5"> what kind of things</font>

400
00:15:24,480 --> 00:15:28,440
we want<font color="#CCCCCC"> to grab or alternatively</font><font color="#E5E5E5"> if</font>

401
00:15:26,970 --> 00:15:29,200
they're<font color="#CCCCCC"> running this admin we can always</font>

402
00:15:28,440 --> 00:15:31,780
grab the

403
00:15:29,200 --> 00:15:33,160
the Sam database<font color="#E5E5E5"> and then</font><font color="#CCCCCC"> it's cracked</font>

404
00:15:31,780 --> 00:15:35,439
their passwords we find out the users

405
00:15:33,160 --> 00:15:37,930
and maybe we<font color="#E5E5E5"> can try to log</font><font color="#CCCCCC"> into</font><font color="#E5E5E5"> the</font>

406
00:15:35,440 --> 00:15:39,550
<font color="#CCCCCC">Mocs</font><font color="#E5E5E5"> directly or just grab</font><font color="#CCCCCC"> a backup at</font>

407
00:15:37,930 --> 00:15:41,020
<font color="#CCCCCC">the registry</font><font color="#E5E5E5"> there's plenty of great</font>

408
00:15:39,550 --> 00:15:43,449
information<font color="#E5E5E5"> in there including file</font>

409
00:15:41,020 --> 00:15:46,569
paths<font color="#E5E5E5"> to particular items that we may</font>

410
00:15:43,450 --> 00:15:47,800
want to then download ourselves so

411
00:15:46,570 --> 00:15:49,420
that's that was it for extreme<font color="#CCCCCC"> rap</font>

412
00:15:47,800 --> 00:15:51,219
really<font color="#E5E5E5"> wasn't the most</font><font color="#CCCCCC"> exciting exploit</font>

413
00:15:49,420 --> 00:15:52,540
I found but it<font color="#CCCCCC"> was</font><font color="#E5E5E5"> something and really</font>

414
00:15:51,220 --> 00:15:53,920
I just<font color="#E5E5E5"> looked at it just</font><font color="#CCCCCC"> to see if I</font>

415
00:15:52,540 --> 00:15:55,449
could<font color="#CCCCCC"> find something</font><font color="#E5E5E5"> it didn't take me</font>

416
00:15:53,920 --> 00:15:57,670
more than a<font color="#CCCCCC"> day to discover this it</font>

417
00:15:55,450 --> 00:16:00,070
<font color="#E5E5E5">wasn't like it's difficult and that was</font>

418
00:15:57,670 --> 00:16:01,300
<font color="#E5E5E5">this</font><font color="#CCCCCC"> I forgot</font><font color="#E5E5E5"> to mention this other but</font>

419
00:16:00,070 --> 00:16:03,460
<font color="#E5E5E5">that's really kind</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the point of this</font>

420
00:16:01,300 --> 00:16:04,630
talk is<font color="#CCCCCC"> that</font><font color="#E5E5E5"> I don't</font><font color="#CCCCCC"> I don't</font><font color="#E5E5E5"> mean</font><font color="#CCCCCC"> to</font>

421
00:16:03,460 --> 00:16:06,370
<font color="#E5E5E5">think that these the exploits I'm gonna</font>

422
00:16:04,630 --> 00:16:07,600
show here are amazing<font color="#CCCCCC"> or anything I</font>

423
00:16:06,370 --> 00:16:09,700
think<font color="#CCCCCC"> I mean I think</font><font color="#E5E5E5"> they're kind of fun</font>

424
00:16:07,600 --> 00:16:12,670
<font color="#E5E5E5">but the point is that these tools have</font>

425
00:16:09,700 --> 00:16:14,440
these<font color="#CCCCCC"> underlying problems all</font><font color="#E5E5E5"> like all</font>

426
00:16:12,670 --> 00:16:16,300
of them is<font color="#CCCCCC"> very rich in this fact if</font>

427
00:16:14,440 --> 00:16:18,700
you're a vulnerability<font color="#E5E5E5"> researcher this</font>

428
00:16:16,300 --> 00:16:19,719
field is ripe for<font color="#CCCCCC"> the picking simply</font>

429
00:16:18,700 --> 00:16:20,670
<font color="#CCCCCC">just need to get a hold of the c2</font>

430
00:16:19,720 --> 00:16:22,780
servers

431
00:16:20,670 --> 00:16:27,209
anyways let's<font color="#CCCCCC"> give them</font><font color="#E5E5E5"> more some fun</font>

432
00:16:22,780 --> 00:16:30,430
<font color="#E5E5E5">ones</font><font color="#CCCCCC"> plug</font><font color="#E5E5E5"> X core plug or des store is</font>

433
00:16:27,210 --> 00:16:33,060
more common<font color="#E5E5E5"> rather than as Linux that</font>

434
00:16:30,430 --> 00:16:35,140
has been described in numerous

435
00:16:33,060 --> 00:16:38,170
nation-state or sophisticated actor

436
00:16:35,140 --> 00:16:41,050
<font color="#E5E5E5">attacks</font><font color="#CCCCCC"> here is a</font><font color="#E5E5E5"> screenshot of the tool</font>

437
00:16:38,170 --> 00:16:43,120
and the<font color="#CCCCCC"> the second pocket pop-up window</font>

438
00:16:41,050 --> 00:16:45,699
<font color="#E5E5E5">shows</font><font color="#CCCCCC"> you the options you can do to your</font>

439
00:16:43,120 --> 00:16:48,100
target<font color="#CCCCCC"> some</font><font color="#E5E5E5"> of them around there</font><font color="#CCCCCC"> that</font>

440
00:16:45,700 --> 00:16:49,810
are notably interesting to me<font color="#CCCCCC"> are one</font>

441
00:16:48,100 --> 00:16:52,660
you can edit the registry on the target

442
00:16:49,810 --> 00:16:54,939
<font color="#E5E5E5">you can start capturing packets you can</font>

443
00:16:52,660 --> 00:16:57,430
<font color="#CCCCCC">connect</font><font color="#E5E5E5"> to a different telnet server</font>

444
00:16:54,940 --> 00:16:59,860
through your target<font color="#CCCCCC"> and it also</font><font color="#E5E5E5"> contains</font>

445
00:16:57,430 --> 00:17:03,579
functions for even<font color="#E5E5E5"> talking to SQL</font>

446
00:16:59,860 --> 00:17:06,730
servers like<font color="#E5E5E5"> I said like I mentioned it</font>

447
00:17:03,580 --> 00:17:09,240
<font color="#E5E5E5">has been indicated and the numerous</font>

448
00:17:06,730 --> 00:17:11,349
attacks<font color="#CCCCCC"> Office of</font><font color="#E5E5E5"> Personnel Management</font>

449
00:17:09,240 --> 00:17:13,300
<font color="#CCCCCC">was one of the attacks in which they</font>

450
00:17:11,349 --> 00:17:18,010
found<font color="#E5E5E5"> the plug X variant of the</font><font color="#CCCCCC"> malware</font>

451
00:17:13,300 --> 00:17:20,198
in use<font color="#E5E5E5"> and it's been around for quite</font>

452
00:17:18,010 --> 00:17:23,470
<font color="#E5E5E5">some time at least 2008 so that's almost</font>

453
00:17:20,199 --> 00:17:25,540
<font color="#CCCCCC">10 year run</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> ten year</font><font color="#E5E5E5"> reign and it's</font>

454
00:17:23,470 --> 00:17:27,730
been used<font color="#E5E5E5"> even even up to this day I</font>

455
00:17:25,540 --> 00:17:29,500
<font color="#CCCCCC">think there's an article there oops they</font>

456
00:17:27,730 --> 00:17:33,460
did it again from February of this year

457
00:17:29,500 --> 00:17:34,870
<font color="#E5E5E5">or again plug X was found the black had</font>

458
00:17:33,460 --> 00:17:36,610
aged to talk I know you want to unplug

459
00:17:34,870 --> 00:17:38,139
me<font color="#E5E5E5"> was very</font><font color="#CCCCCC"> useful</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> my talk but</font><font color="#E5E5E5"> they</font>

460
00:17:36,610 --> 00:17:40,030
did a lot<font color="#CCCCCC"> of</font><font color="#E5E5E5"> research into</font><font color="#CCCCCC"> the tool</font><font color="#E5E5E5"> and</font>

461
00:17:38,140 --> 00:17:41,470
the different variants<font color="#E5E5E5"> and provided</font><font color="#CCCCCC"> some</font>

462
00:17:40,030 --> 00:17:41,780
great<font color="#E5E5E5"> info for me so I didn't have to do</font>

463
00:17:41,470 --> 00:17:45,590
a lot

464
00:17:41,780 --> 00:17:49,520
additional<font color="#E5E5E5"> re</font><font color="#CCCCCC"> and so</font><font color="#E5E5E5"> I was</font><font color="#CCCCCC"> able to I'll</font>

465
00:17:45,590 --> 00:17:51,169
get there<font color="#E5E5E5"> in a second</font><font color="#CCCCCC"> I am I didn't have</font>

466
00:17:49,520 --> 00:17:52,220
source code for this one<font color="#CCCCCC"> I didn't</font><font color="#E5E5E5"> and so</font>

467
00:17:51,170 --> 00:17:54,290
I<font color="#CCCCCC"> just started to do a little</font><font color="#E5E5E5"> bit of</font>

468
00:17:52,220 --> 00:17:55,910
fuzz run to to see what<font color="#E5E5E5"> exploits I could</font>

469
00:17:54,290 --> 00:17:59,090
find<font color="#CCCCCC"> her vulnerability so I can find</font>

470
00:17:55,910 --> 00:18:01,220
excuse me but my fuzz<font color="#CCCCCC"> Brun was kind of</font>

471
00:17:59,090 --> 00:18:05,360
overwhelming to<font color="#E5E5E5"> tell the truth the the</font>

472
00:18:01,220 --> 00:18:07,910
coding in this is so horrible in my<font color="#E5E5E5"> mind</font>

473
00:18:05,360 --> 00:18:11,030
<font color="#E5E5E5">and deplorable in my mind it would cause</font>

474
00:18:07,910 --> 00:18:13,040
so many exceptions<font color="#E5E5E5"> to be flagged when I</font>

475
00:18:11,030 --> 00:18:15,050
run<font color="#CCCCCC"> my husband that I really didn't get</font>

476
00:18:13,040 --> 00:18:17,210
an edge up as where<font color="#CCCCCC"> to start I had so</font>

477
00:18:15,050 --> 00:18:19,460
many exceptions<font color="#CCCCCC"> being thrown and they</font>

478
00:18:17,210 --> 00:18:21,590
were all the exceptions that could show

479
00:18:19,460 --> 00:18:23,200
<font color="#E5E5E5">potential to be exploitable that I'll</font>

480
00:18:21,590 --> 00:18:25,159
say<font color="#E5E5E5"> okay well which one do I start with</font>

481
00:18:23,200 --> 00:18:26,840
and in<font color="#E5E5E5"> the end I just kind of started</font>

482
00:18:25,160 --> 00:18:28,250
<font color="#CCCCCC">with one</font><font color="#E5E5E5"> something that looked</font>

483
00:18:26,840 --> 00:18:29,959
interesting<font color="#CCCCCC"> to me when I when I</font><font color="#E5E5E5"> just</font>

484
00:18:28,250 --> 00:18:31,400
started when I<font color="#E5E5E5"> started I was trying to</font>

485
00:18:29,960 --> 00:18:33,170
<font color="#E5E5E5">make my fuzzer very unique to the</font>

486
00:18:31,400 --> 00:18:34,430
protocol and I noticed<font color="#CCCCCC"> something</font>

487
00:18:33,170 --> 00:18:35,900
interesting<font color="#E5E5E5"> in the protocol and I made a</font>

488
00:18:34,430 --> 00:18:37,070
note<font color="#E5E5E5"> on the side saying</font><font color="#CCCCCC"> yeah I might</font>

489
00:18:35,900 --> 00:18:38,810
want to come back<font color="#E5E5E5"> to this and</font><font color="#CCCCCC"> in the end</font>

490
00:18:37,070 --> 00:18:41,689
<font color="#CCCCCC">that's</font><font color="#E5E5E5"> where I started because the fuzz</font>

491
00:18:38,810 --> 00:18:45,139
<font color="#CCCCCC">run results were overwhelming</font><font color="#E5E5E5"> and where</font>

492
00:18:41,690 --> 00:18:47,950
that was was in the set of code that<font color="#CCCCCC"> has</font>

493
00:18:45,140 --> 00:18:50,930
to deal with decoding<font color="#E5E5E5"> a packet as</font>

494
00:18:47,950 --> 00:18:54,530
<font color="#CCCCCC">plugins calls it or a message</font><font color="#E5E5E5"> more as we</font>

495
00:18:50,930 --> 00:18:58,160
<font color="#CCCCCC">should think of it this is my obligate</font>

496
00:18:54,530 --> 00:19:00,710
<font color="#E5E5E5">Ida Pro screenshot and this this</font>

497
00:18:58,160 --> 00:19:03,410
function<font color="#E5E5E5"> here is the handling of a</font>

498
00:19:00,710 --> 00:19:05,420
message as received from a victim or a

499
00:19:03,410 --> 00:19:07,850
target and what it does every message

500
00:19:05,420 --> 00:19:10,220
has a header that's<font color="#CCCCCC"> XOR encoded with</font>

501
00:19:07,850 --> 00:19:13,639
some<font color="#E5E5E5"> made-up</font><font color="#CCCCCC"> x</font><font color="#E5E5E5"> or rolling</font><font color="#CCCCCC"> X or key</font>

502
00:19:10,220 --> 00:19:14,750
<font color="#E5E5E5">that's I don't know they must have made</font>

503
00:19:13,640 --> 00:19:15,950
up<font color="#E5E5E5"> their I've</font><font color="#CCCCCC"> never seen it used</font>

504
00:19:14,750 --> 00:19:16,730
anywhere<font color="#CCCCCC"> else they just</font><font color="#E5E5E5"> kind of made</font>

505
00:19:15,950 --> 00:19:19,070
their<font color="#CCCCCC"> own thing up</font>

506
00:19:16,730 --> 00:19:21,950
but anyways<font color="#E5E5E5"> once that</font><font color="#CCCCCC"> xor</font><font color="#E5E5E5"> key is decoded</font>

507
00:19:19,070 --> 00:19:24,020
then it validates<font color="#E5E5E5"> that the message size</font>

508
00:19:21,950 --> 00:19:28,070
is small enough<font color="#E5E5E5"> to</font><font color="#CCCCCC"> fit</font><font color="#E5E5E5"> it on the stack</font>

509
00:19:24,020 --> 00:19:29,690
and<font color="#CCCCCC"> that</font><font color="#E5E5E5"> 61k it must fit on the stack</font>

510
00:19:28,070 --> 00:19:31,220
and<font color="#CCCCCC"> if it's</font><font color="#E5E5E5"> not large enough if it's not</font>

511
00:19:29,690 --> 00:19:33,290
<font color="#E5E5E5">smaller to fit on the stack then it</font>

512
00:19:31,220 --> 00:19:36,040
shows this error message<font color="#E5E5E5"> that's very</font>

513
00:19:33,290 --> 00:19:39,920
descriptive<font color="#E5E5E5"> about what the problem is</font>

514
00:19:36,040 --> 00:19:42,770
however this code to decode the header

515
00:19:39,920 --> 00:19:44,630
and make sure it fits<font color="#CCCCCC"> on the stack comes</font>

516
00:19:42,770 --> 00:19:47,750
<font color="#E5E5E5">down here in this decode packet function</font>

517
00:19:44,630 --> 00:19:50,120
which is after the packet is kept copied

518
00:19:47,750 --> 00:19:52,550
<font color="#CCCCCC">onto</font><font color="#E5E5E5"> the stack</font><font color="#CCCCCC"> so it does you very</font>

519
00:19:50,120 --> 00:19:54,260
<font color="#E5E5E5">little good to check if your message</font>

520
00:19:52,550 --> 00:19:54,879
fits on the stack after<font color="#CCCCCC"> you've copied</font>

521
00:19:54,260 --> 00:19:59,140
your mess

522
00:19:54,880 --> 00:20:00,790
<font color="#CCCCCC">onto</font><font color="#E5E5E5"> the static in this case it does</font>

523
00:19:59,140 --> 00:20:03,250
provide a<font color="#CCCCCC"> little of a hindrance</font><font color="#E5E5E5"> to me</font>

524
00:20:00,790 --> 00:20:06,040
but I thought it was<font color="#E5E5E5"> thought it was</font>

525
00:20:03,250 --> 00:20:09,640
really<font color="#CCCCCC"> a fun bug so I decided</font><font color="#E5E5E5"> to use it</font>

526
00:20:06,040 --> 00:20:10,930
in this presentation<font color="#CCCCCC"> so here</font><font color="#E5E5E5"> we can</font>

527
00:20:09,640 --> 00:20:13,090
throw<font color="#E5E5E5"> it a message</font><font color="#CCCCCC"> that's bigger than</font>

528
00:20:10,930 --> 00:20:14,950
the<font color="#CCCCCC"> the stack buffer and then we think</font>

529
00:20:13,090 --> 00:20:17,050
<font color="#E5E5E5">we would gain execution as soon as this</font>

530
00:20:14,950 --> 00:20:18,670
<font color="#E5E5E5">function returns but the function is not</font>

531
00:20:17,050 --> 00:20:21,909
going to return<font color="#CCCCCC"> until it checks the</font>

532
00:20:18,670 --> 00:20:23,860
stack size<font color="#E5E5E5"> so thus the attacker when we</font>

533
00:20:21,910 --> 00:20:25,960
exploit this is going to see this<font color="#E5E5E5"> pop up</font>

534
00:20:23,860 --> 00:20:27,939
message on their machine that very

535
00:20:25,960 --> 00:20:30,160
clearly to them describes the problem

536
00:20:27,940 --> 00:20:32,280
<font color="#CCCCCC">that they're about</font><font color="#E5E5E5"> to face right this</font>

537
00:20:30,160 --> 00:20:34,900
error message<font color="#CCCCCC"> PE</font>

538
00:20:32,280 --> 00:20:36,460
decode packet<font color="#E5E5E5"> clearly lets them know</font>

539
00:20:34,900 --> 00:20:37,630
<font color="#E5E5E5">you've just been exploited and</font>

540
00:20:36,460 --> 00:20:40,780
somebody's<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> greenshell on your</font>

541
00:20:37,630 --> 00:20:43,090
box<font color="#E5E5E5"> furthermore this error message isn't</font>

542
00:20:40,780 --> 00:20:45,399
<font color="#CCCCCC">just unique to this code path if you</font>

543
00:20:43,090 --> 00:20:47,439
<font color="#CCCCCC">just</font><font color="#E5E5E5"> end map</font><font color="#CCCCCC"> scanned some</font><font color="#E5E5E5"> of the plug X</font>

544
00:20:45,400 --> 00:20:49,240
variants<font color="#E5E5E5"> they show this exact message</font>

545
00:20:47,440 --> 00:20:51,040
<font color="#E5E5E5">it's kind of like I assume it's kind of</font>

546
00:20:49,240 --> 00:20:53,740
like the default<font color="#CCCCCC"> I don't know what went</font>

547
00:20:51,040 --> 00:20:56,020
<font color="#CCCCCC">wrong here message and so this guy pops</font>

548
00:20:53,740 --> 00:20:57,580
up<font color="#E5E5E5"> on the attackers machine and it</font>

549
00:20:56,020 --> 00:20:59,530
doesn't matter how they acknowledge it

550
00:20:57,580 --> 00:21:01,750
<font color="#E5E5E5">if they click the X or they click</font><font color="#CCCCCC"> ok as</font>

551
00:20:59,530 --> 00:21:05,639
<font color="#CCCCCC">soon as this message</font><font color="#E5E5E5"> box is acknowledged</font>

552
00:21:01,750 --> 00:21:13,200
<font color="#E5E5E5">then code flow falls into our hands</font>

553
00:21:05,640 --> 00:21:16,840
so I have here a demo video of<font color="#E5E5E5"> this on</font>

554
00:21:13,200 --> 00:21:19,870
the right spot

555
00:21:16,840 --> 00:21:22,629
<font color="#E5E5E5">on the right hand</font><font color="#CCCCCC"> side of the screen I'm</font>

556
00:21:19,870 --> 00:21:24,429
representing the adversaries machine and

557
00:21:22,630 --> 00:21:27,550
on the left<font color="#E5E5E5"> hand side of the scene</font><font color="#CCCCCC"> I</font>

558
00:21:24,430 --> 00:21:32,320
screen<font color="#CCCCCC"> I am representing the retaliate</font>

559
00:21:27,550 --> 00:21:35,230
<font color="#CCCCCC">err so I'm gonna</font><font color="#E5E5E5"> start up the plug X rat</font>

560
00:21:32,320 --> 00:21:36,610
variant here and it's running<font color="#E5E5E5"> and on the</font>

561
00:21:35,230 --> 00:21:38,770
other<font color="#CCCCCC"> side I have a Metasploit module</font>

562
00:21:36,610 --> 00:21:42,810
for this<font color="#E5E5E5"> I'm starting up that Metasploit</font>

563
00:21:38,770 --> 00:21:46,960
module to exploit this plug X bug I

564
00:21:42,810 --> 00:21:50,020
think all<font color="#E5E5E5"> right I'm gonna set the target</font>

565
00:21:46,960 --> 00:21:53,020
address<font color="#E5E5E5"> which I've already I know right</font>

566
00:21:50,020 --> 00:21:55,420
<font color="#CCCCCC">it's just my VM in this case and then</font>

567
00:21:53,020 --> 00:21:56,750
I'm going<font color="#CCCCCC"> to show some info here I want</font>

568
00:21:55,420 --> 00:22:00,950
to pause this

569
00:21:56,750 --> 00:22:04,420
right there so here in my<font color="#E5E5E5"> module that</font>

570
00:22:00,950 --> 00:22:07,220
you see here at<font color="#E5E5E5"> the top it says type</font>

571
00:22:04,420 --> 00:22:08,540
<font color="#CCCCCC">from that Asia</font><font color="#E5E5E5"> from a talk I know you</font>

572
00:22:07,220 --> 00:22:10,370
want<font color="#CCCCCC"> to unplug me from blackhat Asia</font>

573
00:22:08,540 --> 00:22:12,440
<font color="#CCCCCC">they describe plug experience there's</font>

574
00:22:10,370 --> 00:22:14,209
like three main types as they put it<font color="#CCCCCC"> and</font>

575
00:22:12,440 --> 00:22:17,870
they kind<font color="#E5E5E5"> of broke them up based on</font>

576
00:22:14,210 --> 00:22:19,430
their<font color="#CCCCCC"> XOR decoding function we have to</font>

577
00:22:17,870 --> 00:22:21,110
be able<font color="#E5E5E5"> to make a packet</font><font color="#CCCCCC"> that decodes</font>

578
00:22:19,430 --> 00:22:22,790
right so there's basically<font color="#E5E5E5"> I need you</font>

579
00:22:21,110 --> 00:22:25,340
need<font color="#E5E5E5"> to know what variant your target is</font>

580
00:22:22,790 --> 00:22:27,260
the<font color="#CCCCCC"> good site is is you can</font><font color="#E5E5E5"> just try it</font>

581
00:22:25,340 --> 00:22:28,820
<font color="#CCCCCC">with a</font><font color="#E5E5E5"> message and</font><font color="#CCCCCC"> if it doesn't work</font>

582
00:22:27,260 --> 00:22:30,560
then you<font color="#E5E5E5"> can try another one and</font><font color="#CCCCCC"> just so</font>

583
00:22:28,820 --> 00:22:31,820
basically you can<font color="#CCCCCC"> just try all</font><font color="#E5E5E5"> three and</font>

584
00:22:30,560 --> 00:22:35,480
until you find the<font color="#CCCCCC"> one that works</font><font color="#E5E5E5"> and</font>

585
00:22:31,820 --> 00:22:37,970
that's what I'll do in this do<font color="#CCCCCC"> next is</font>

586
00:22:35,480 --> 00:22:39,710
I'll run a<font color="#CCCCCC"> check command</font><font color="#E5E5E5"> and sure enough</font>

587
00:22:37,970 --> 00:22:41,450
<font color="#E5E5E5">that one says yeah you the type you've</font>

588
00:22:39,710 --> 00:22:42,020
selected is<font color="#E5E5E5"> right the message that looks</font>

589
00:22:41,450 --> 00:22:44,600
<font color="#CCCCCC">wonderful</font>

590
00:22:42,020 --> 00:22:46,940
and<font color="#E5E5E5"> so we'll throw our exploit you see</font>

591
00:22:44,600 --> 00:22:48,980
here the<font color="#E5E5E5"> pop up message</font><font color="#CCCCCC"> as soon as the</font>

592
00:22:46,940 --> 00:22:50,570
attacker acknowledges that<font color="#E5E5E5"> some way we</font>

593
00:22:48,980 --> 00:22:53,180
are<font color="#E5E5E5"> spawning the meterpreter session</font>

594
00:22:50,570 --> 00:22:55,280
<font color="#E5E5E5">there on the</font><font color="#CCCCCC"> left</font><font color="#E5E5E5"> comes up and</font><font color="#CCCCCC"> i'm gonna</font>

595
00:22:53,180 --> 00:22:58,400
run a<font color="#E5E5E5"> sin foe</font><font color="#CCCCCC"> you get a little info on</font>

596
00:22:55,280 --> 00:23:01,120
<font color="#CCCCCC">my target spawn a shell and</font><font color="#E5E5E5"> will pop up</font>

597
00:22:58,400 --> 00:23:07,370
<font color="#E5E5E5">a notepad just</font><font color="#CCCCCC"> as proof</font><font color="#E5E5E5"> and boom</font>

598
00:23:01,120 --> 00:23:09,889
<font color="#E5E5E5">execution on the</font><font color="#CCCCCC"> c2 server all right</font>

599
00:23:07,370 --> 00:23:11,840
next up last one<font color="#E5E5E5"> on</font><font color="#CCCCCC"> my</font><font color="#E5E5E5"> list</font>

600
00:23:09,890 --> 00:23:15,080
let's go<font color="#CCCCCC"> strat</font><font color="#E5E5E5"> I saved this one for last</font>

601
00:23:11,840 --> 00:23:16,639
<font color="#E5E5E5">because this one I've seen everywhere</font>

602
00:23:15,080 --> 00:23:18,740
I think<font color="#CCCCCC"> Mini incident responders know</font>

603
00:23:16,640 --> 00:23:20,630
this guy by heart<font color="#E5E5E5"> ghost</font><font color="#CCCCCC"> rats been around</font>

604
00:23:18,740 --> 00:23:24,410
for<font color="#CCCCCC"> ten years</font><font color="#E5E5E5"> it was originally written</font>

605
00:23:20,630 --> 00:23:28,550
by<font color="#E5E5E5"> a team that called themselves</font><font color="#CCCCCC"> C Rufus</font>

606
00:23:24,410 --> 00:23:30,710
aka<font color="#E5E5E5"> red wolf security team</font><font color="#CCCCCC"> been</font>

607
00:23:28,550 --> 00:23:32,690
attributed to a lot of<font color="#E5E5E5"> nation-state</font>

608
00:23:30,710 --> 00:23:37,280
attacks based out<font color="#CCCCCC"> of the</font><font color="#E5E5E5"> asia-pacific</font>

609
00:23:32,690 --> 00:23:39,050
<font color="#E5E5E5">region</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> very well</font><font color="#CCCCCC"> known the source</font>

610
00:23:37,280 --> 00:23:40,760
code has<font color="#CCCCCC"> been leaked online</font><font color="#E5E5E5"> to this tool</font>

611
00:23:39,050 --> 00:23:43,909
which means it's also<font color="#E5E5E5"> now being used by</font>

612
00:23:40,760 --> 00:23:47,480
<font color="#E5E5E5">script kiddies and sophisticated actors</font>

613
00:23:43,910 --> 00:23:48,860
alike<font color="#E5E5E5"> here's just a handful of news</font>

614
00:23:47,480 --> 00:23:53,210
<font color="#CCCCCC">media reports where this guy's been</font>

615
00:23:48,860 --> 00:23:55,939
served<font color="#E5E5E5"> in the wild</font><font color="#CCCCCC"> we've seen it against</font>

616
00:23:53,210 --> 00:23:58,010
NATO Associated Press<font color="#CCCCCC"> office of the</font>

617
00:23:55,940 --> 00:24:00,980
Dalai Lama<font color="#CCCCCC"> the US government private</font>

618
00:23:58,010 --> 00:24:03,320
businesses<font color="#CCCCCC"> I mean I could go on an old</font>

619
00:24:00,980 --> 00:24:06,740
notably operation night dragon<font color="#E5E5E5"> pity</font>

620
00:24:03,320 --> 00:24:09,470
<font color="#CCCCCC">Tiger</font><font color="#E5E5E5"> apt</font><font color="#CCCCCC"> 18 dynamite</font><font color="#E5E5E5"> Panda they've all</font>

621
00:24:06,740 --> 00:24:10,140
been cited to<font color="#E5E5E5"> use this guy very very</font><font color="#CCCCCC"> Tom</font>

622
00:24:09,470 --> 00:24:13,440
<font color="#E5E5E5">and cool</font>

623
00:24:10,140 --> 00:24:17,130
toolkit and again easily signature<font color="#CCCCCC"> Bowl</font>

624
00:24:13,440 --> 00:24:18,600
<font color="#E5E5E5">based on its</font><font color="#CCCCCC"> situ traffic the path the</font>

625
00:24:17,130 --> 00:24:20,220
traffic always<font color="#E5E5E5"> starts out with a five</font>

626
00:24:18,600 --> 00:24:23,939
<font color="#CCCCCC">byte marker which</font><font color="#E5E5E5"> is usually ghost</font>

627
00:24:20,220 --> 00:24:28,130
<font color="#CCCCCC">spelled with a zero followed</font><font color="#E5E5E5"> by two int</font>

628
00:24:23,940 --> 00:24:32,760
variables and then a gzip or<font color="#E5E5E5"> not gzip</font>

629
00:24:28,130 --> 00:24:34,530
<font color="#CCCCCC">and lzma compressed buffer</font><font color="#E5E5E5"> since the</font>

630
00:24:32,760 --> 00:24:36,360
source code has<font color="#E5E5E5"> been leaked online we've</font>

631
00:24:34,530 --> 00:24:37,770
seen variants come up where they try<font color="#E5E5E5"> to</font>

632
00:24:36,360 --> 00:24:39,600
change that marker to hide who they are

633
00:24:37,770 --> 00:24:41,580
<font color="#E5E5E5">but they usually just change it to</font><font color="#CCCCCC"> a</font>

634
00:24:39,600 --> 00:24:44,610
different<font color="#CCCCCC"> 5 by</font><font color="#E5E5E5"> variable so it's still</font>

635
00:24:41,580 --> 00:24:46,530
very signature<font color="#E5E5E5"> able the the list here of</font>

636
00:24:44,610 --> 00:24:48,928
<font color="#E5E5E5">different</font><font color="#CCCCCC"> 5-bike markers that we have</font>

637
00:24:46,530 --> 00:24:52,530
observed or have been observed<font color="#E5E5E5"> are from</font>

638
00:24:48,929 --> 00:24:56,490
a colleague paper<font color="#CCCCCC"> Norah observed all</font>

639
00:24:52,530 --> 00:24:58,918
these and I<font color="#E5E5E5"> just stole</font><font color="#CCCCCC"> that from him but</font>

640
00:24:56,490 --> 00:25:00,299
this guy<font color="#E5E5E5"> was also very vulnerable</font><font color="#CCCCCC"> it had</font>

641
00:24:58,919 --> 00:25:01,950
a vulnerability very similar to the

642
00:25:00,299 --> 00:25:04,500
extreme rat but this time the<font color="#E5E5E5"> other way</font>

643
00:25:01,950 --> 00:25:07,049
this<font color="#E5E5E5"> when the attacker wants to pull a</font>

644
00:25:04,500 --> 00:25:08,490
file<font color="#E5E5E5"> from his target</font><font color="#CCCCCC"> the attacker sends</font>

645
00:25:07,049 --> 00:25:10,799
a message that<font color="#CCCCCC"> looks something like this</font>

646
00:25:08,490 --> 00:25:13,710
<font color="#E5E5E5">it'll say give me your</font><font color="#CCCCCC"> file C Drive</font>

647
00:25:10,799 --> 00:25:17,190
documents user<font color="#E5E5E5"> you know file that doc so</font>

648
00:25:13,710 --> 00:25:20,549
I can save it<font color="#CCCCCC"> to folder X file dot</font>

649
00:25:17,190 --> 00:25:22,410
something<font color="#E5E5E5"> another target</font><font color="#CCCCCC"> response ok</font>

650
00:25:20,549 --> 00:25:25,049
<font color="#E5E5E5">here's the</font><font color="#CCCCCC"> data</font><font color="#E5E5E5"> so you can</font><font color="#CCCCCC"> save it to</font>

651
00:25:22,410 --> 00:25:27,780
<font color="#E5E5E5">this</font><font color="#CCCCCC"> location and like the other case</font>

652
00:25:25,049 --> 00:25:29,940
the<font color="#CCCCCC"> first packets</font><font color="#E5E5E5"> not necessary so we</font>

653
00:25:27,780 --> 00:25:32,370
can arbitrarily<font color="#E5E5E5"> start telling the ghost</font>

654
00:25:29,940 --> 00:25:34,650
server<font color="#E5E5E5"> hey here's the file you requested</font>

655
00:25:32,370 --> 00:25:36,809
<font color="#CCCCCC">please save this to your startup folder</font>

656
00:25:34,650 --> 00:25:39,030
for me<font color="#E5E5E5"> if we know we're at startup</font>

657
00:25:36,809 --> 00:25:41,160
folder is granted the start folder moves

658
00:25:39,030 --> 00:25:43,260
around a<font color="#CCCCCC"> lot in Windows so this might</font>

659
00:25:41,160 --> 00:25:44,640
not be<font color="#CCCCCC"> the best way to do this so I was</font>

660
00:25:43,260 --> 00:25:48,090
<font color="#E5E5E5">thinking what what's the best use of</font>

661
00:25:44,640 --> 00:25:50,549
this arbitrary file upload but it turns

662
00:25:48,090 --> 00:25:52,918
out deal go strap provided a great use

663
00:25:50,549 --> 00:25:56,610
for<font color="#E5E5E5"> this and that is ghost rat has a</font>

664
00:25:52,919 --> 00:25:59,220
side load vulnerability if we drop a<font color="#CCCCCC"> dll</font>

665
00:25:56,610 --> 00:26:03,120
file in the relative directory called

666
00:25:59,220 --> 00:26:04,860
<font color="#E5E5E5">oily</font><font color="#CCCCCC"> dlg</font><font color="#E5E5E5"> then the next time ghost starts</font>

667
00:26:03,120 --> 00:26:07,110
up it'll load that library looking for

668
00:26:04,860 --> 00:26:10,350
just one function<font color="#CCCCCC"> that one function is</font>

669
00:26:07,110 --> 00:26:13,379
Ola<font color="#CCCCCC"> UI I busy and all that does is ask</font>

670
00:26:10,350 --> 00:26:15,240
if the UI is busy<font color="#E5E5E5"> so we can quick we</font><font color="#CCCCCC"> can</font>

671
00:26:13,380 --> 00:26:16,830
make a<font color="#CCCCCC"> dll on malicious DLL</font><font color="#E5E5E5"> that does</font>

672
00:26:15,240 --> 00:26:18,480
<font color="#E5E5E5">whatever we want and as</font><font color="#CCCCCC"> long as</font><font color="#E5E5E5"> it</font>

673
00:26:16,830 --> 00:26:20,129
exports this one<font color="#E5E5E5"> function and always</font>

674
00:26:18,480 --> 00:26:23,430
returns yes I'm busy

675
00:26:20,130 --> 00:26:26,330
then<font color="#E5E5E5"> ghost it will be none the</font><font color="#CCCCCC"> wiser</font><font color="#E5E5E5"> and</font>

676
00:26:23,430 --> 00:26:28,530
we have our<font color="#E5E5E5"> backdoor into the ghost trap</font>

677
00:26:26,330 --> 00:26:30,419
unfortunately this requires ghosts to be

678
00:26:28,530 --> 00:26:32,670
<font color="#E5E5E5">restarted and requires dropping</font><font color="#CCCCCC"> the file</font>

679
00:26:30,420 --> 00:26:33,060
to disk<font color="#CCCCCC"> and I wanted something better</font>

680
00:26:32,670 --> 00:26:36,570
than that

681
00:26:33,060 --> 00:26:38,220
<font color="#E5E5E5">so I</font><font color="#CCCCCC"> continued looking and didn't take</font>

682
00:26:36,570 --> 00:26:40,590
long looking<font color="#E5E5E5"> at the source code made it</font>

683
00:26:38,220 --> 00:26:44,010
a whole lot<font color="#CCCCCC"> easier but I have this</font><font color="#E5E5E5"> one</font>

684
00:26:40,590 --> 00:26:46,830
<font color="#CCCCCC">here this</font><font color="#E5E5E5"> is in the parsing code of the</font>

685
00:26:44,010 --> 00:26:50,820
drive list given<font color="#E5E5E5"> from a victim back to</font>

686
00:26:46,830 --> 00:26:53,699
the adversary<font color="#CCCCCC"> and here you can see that</font>

687
00:26:50,820 --> 00:26:56,100
it<font color="#E5E5E5"> copies the</font><font color="#CCCCCC"> list of drives buff</font><font color="#E5E5E5"> the</font>

688
00:26:53,700 --> 00:26:58,470
buffer of<font color="#E5E5E5"> the list of drives and it uses</font>

689
00:26:56,100 --> 00:26:59,879
<font color="#E5E5E5">the size of the list of</font><font color="#CCCCCC"> drive get as</font>

690
00:26:58,470 --> 00:27:01,340
given<font color="#E5E5E5"> from the target</font><font color="#CCCCCC"> rather than the</font>

691
00:26:59,880 --> 00:27:04,200
size of<font color="#E5E5E5"> the</font><font color="#CCCCCC"> buffer on</font><font color="#E5E5E5"> the server</font>

692
00:27:01,340 --> 00:27:05,730
<font color="#E5E5E5">trusting that the list of drives on a</font>

693
00:27:04,200 --> 00:27:07,110
victim will never be longer<font color="#E5E5E5"> than a</font>

694
00:27:05,730 --> 00:27:09,360
thousand characters because obviously

695
00:27:07,110 --> 00:27:13,500
<font color="#E5E5E5">there's only gonna be 26 character 26</font>

696
00:27:09,360 --> 00:27:15,990
<font color="#E5E5E5">drives on a</font><font color="#CCCCCC"> machine</font><font color="#E5E5E5"> right that buffer</font>

697
00:27:13,500 --> 00:27:19,170
exists within this particular<font color="#CCCCCC"> C class</font>

698
00:27:15,990 --> 00:27:21,840
and so we can overwrite anything<font color="#E5E5E5"> that</font>

699
00:27:19,170 --> 00:27:24,210
<font color="#E5E5E5">falls below below the you see the remote</font>

700
00:27:21,840 --> 00:27:26,070
<font color="#E5E5E5">drive list that 1k buffer there that's</font>

701
00:27:24,210 --> 00:27:28,050
the one who overflow<font color="#E5E5E5"> so we can overflow</font>

702
00:27:26,070 --> 00:27:30,659
any we<font color="#CCCCCC"> can overwrite</font><font color="#E5E5E5"> anything below that</font>

703
00:27:28,050 --> 00:27:33,090
<font color="#E5E5E5">there's a number of class pointers below</font>

704
00:27:30,660 --> 00:27:34,890
there which means<font color="#CCCCCC"> anytime any function</font>

705
00:27:33,090 --> 00:27:37,590
inside one of<font color="#E5E5E5"> those classes below that</font>

706
00:27:34,890 --> 00:27:41,010
gets called<font color="#CCCCCC"> we control the pointer to</font>

707
00:27:37,590 --> 00:27:42,659
that<font color="#E5E5E5"> function pointer so if to get</font>

708
00:27:41,010 --> 00:27:45,780
execution we just have to have a pointer

709
00:27:42,660 --> 00:27:47,970
to<font color="#CCCCCC"> a pointer</font><font color="#E5E5E5"> to our shellcode now to get</font>

710
00:27:45,780 --> 00:27:48,840
that it would be great if I had<font color="#E5E5E5"> an</font>

711
00:27:47,970 --> 00:27:51,300
<font color="#E5E5E5">information to</font><font color="#CCCCCC"> schools your</font>

712
00:27:48,840 --> 00:27:54,389
vulnerability unfortunately I'm lazy and

713
00:27:51,300 --> 00:27:56,310
I didn't go find one I don't I suspect

714
00:27:54,390 --> 00:27:58,470
somebody<font color="#E5E5E5"> could find one rather easily if</font>

715
00:27:56,310 --> 00:28:00,000
they<font color="#E5E5E5"> wanted</font><font color="#CCCCCC"> to but I'm lazy so I just</font>

716
00:27:58,470 --> 00:28:02,340
did the<font color="#E5E5E5"> heap spray approach where I</font>

717
00:28:00,000 --> 00:28:03,600
spray the heap<font color="#E5E5E5"> and then assume</font><font color="#CCCCCC"> that I I</font>

718
00:28:02,340 --> 00:28:07,199
know where I'm gonna<font color="#E5E5E5"> land</font>

719
00:28:03,600 --> 00:28:09,300
I also worried about depth<font color="#CCCCCC"> but it turned</font>

720
00:28:07,200 --> 00:28:11,880
<font color="#E5E5E5">out</font><font color="#CCCCCC"> that on any machine</font><font color="#E5E5E5"> that forced</font>

721
00:28:09,300 --> 00:28:13,560
<font color="#CCCCCC">depth to be enabled ghosts</font><font color="#E5E5E5"> rats the co2</font>

722
00:28:11,880 --> 00:28:16,110
server component would not run at all

723
00:28:13,560 --> 00:28:18,120
<font color="#CCCCCC">depth</font><font color="#E5E5E5"> seemed to break the server so in</font>

724
00:28:16,110 --> 00:28:20,580
all<font color="#CCCCCC"> cases where I've seen ghost rat</font>

725
00:28:18,120 --> 00:28:24,149
running<font color="#E5E5E5"> I</font><font color="#CCCCCC"> don't assume depth is working</font>

726
00:28:20,580 --> 00:28:25,139
I also have a demo for<font color="#E5E5E5"> this one before I</font>

727
00:28:24,150 --> 00:28:27,330
<font color="#E5E5E5">get there I wanted to talk</font><font color="#CCCCCC"> about</font>

728
00:28:25,140 --> 00:28:29,610
something<font color="#E5E5E5"> else cool and that is some</font>

729
00:28:27,330 --> 00:28:31,860
work by<font color="#E5E5E5"> Kevin the hermit he has written</font>

730
00:28:29,610 --> 00:28:34,020
a series<font color="#CCCCCC"> of decoders for these malware</font>

731
00:28:31,860 --> 00:28:36,000
components so if you have the malware

732
00:28:34,020 --> 00:28:39,030
piece<font color="#E5E5E5"> from any one of these that go</font>

733
00:28:36,000 --> 00:28:41,070
<font color="#CCCCCC">two extreme rat or poison ivy then he</font>

734
00:28:39,030 --> 00:28:42,750
can extract you run this<font color="#E5E5E5"> code against it</font>

735
00:28:41,070 --> 00:28:45,210
and<font color="#CCCCCC"> it'll extract</font><font color="#E5E5E5"> the configuration file</font>

736
00:28:42,750 --> 00:28:47,820
<font color="#E5E5E5">giving you the</font><font color="#CCCCCC"> address of</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> c2</font><font color="#E5E5E5"> server</font>

737
00:28:45,210 --> 00:28:49,650
<font color="#E5E5E5">so if you've been attacked and you have</font>

738
00:28:47,820 --> 00:28:51,030
a sample<font color="#CCCCCC"> we can</font><font color="#E5E5E5"> extract the c2 server</font>

739
00:28:49,650 --> 00:28:52,890
and then you<font color="#E5E5E5"> can go attack the CG server</font>

740
00:28:51,030 --> 00:28:54,330
or if you don't<font color="#CCCCCC"> want to wait until</font>

741
00:28:52,890 --> 00:28:54,990
<font color="#E5E5E5">you're attacked you can go hunt</font>

742
00:28:54,330 --> 00:28:58,169
virustotal

743
00:28:54,990 --> 00:28:59,970
pull the information<font color="#E5E5E5"> there or we can</font>

744
00:28:58,170 --> 00:29:02,910
<font color="#E5E5E5">just ask</font><font color="#CCCCCC"> shodhan right shodhan just</font>

745
00:28:59,970 --> 00:29:05,100
recently<font color="#E5E5E5"> announced a malware hunter</font>

746
00:29:02,910 --> 00:29:07,440
capability<font color="#CCCCCC"> where one of those types</font><font color="#E5E5E5"> of</font>

747
00:29:05,100 --> 00:29:09,300
servers<font color="#CCCCCC"> that</font><font color="#E5E5E5"> they hunt for our ghost c2</font>

748
00:29:07,440 --> 00:29:11,910
servers so<font color="#E5E5E5"> you can quickly do a search</font>

749
00:29:09,300 --> 00:29:13,590
on<font color="#CCCCCC"> go c2 and may are shown in</font><font color="#E5E5E5"> looking</font>

750
00:29:11,910 --> 00:29:17,310
for a ghost c2 servers and find yourself

751
00:29:13,590 --> 00:29:20,159
a lovely list of targets there all<font color="#CCCCCC"> right</font>

752
00:29:17,310 --> 00:29:21,810
<font color="#CCCCCC">I have the demo</font><font color="#E5E5E5"> now with that out of the</font>

753
00:29:20,160 --> 00:29:24,360
way<font color="#E5E5E5"> this time I'm going to do it a</font>

754
00:29:21,810 --> 00:29:26,909
little differently<font color="#E5E5E5"> I'm going to actually</font>

755
00:29:24,360 --> 00:29:31,010
make<font color="#CCCCCC"> a malware capice out with the ghost</font>

756
00:29:26,910 --> 00:29:33,720
c2 server<font color="#E5E5E5"> and I will deliver</font><font color="#CCCCCC"> that to my</font>

757
00:29:31,010 --> 00:29:36,690
victim or<font color="#CCCCCC"> whatnot</font><font color="#E5E5E5"> usually that's</font>

758
00:29:33,720 --> 00:29:39,960
delivered via phishing email or whatever

759
00:29:36,690 --> 00:29:42,600
<font color="#E5E5E5">trick you want but since this</font><font color="#CCCCCC"> is a</font><font color="#E5E5E5"> VM</font><font color="#CCCCCC"> I</font>

760
00:29:39,960 --> 00:29:47,670
just kind<font color="#CCCCCC"> of drag it over outside</font><font color="#E5E5E5"> the</font>

761
00:29:42,600 --> 00:29:50,399
space<font color="#E5E5E5"> I made</font><font color="#CCCCCC"> a mistake there I closed my</font>

762
00:29:47,670 --> 00:29:51,860
c2 server so I realized mistake in a

763
00:29:50,400 --> 00:29:55,020
second here<font color="#CCCCCC"> and I'll start</font><font color="#E5E5E5"> it back up</font>

764
00:29:51,860 --> 00:29:57,240
<font color="#E5E5E5">but might retaliate err we're gonna run</font>

765
00:29:55,020 --> 00:29:59,040
that decoder command against my piece of

766
00:29:57,240 --> 00:30:00,960
malware<font color="#E5E5E5"> and there you see the C to</font>

767
00:29:59,040 --> 00:30:03,480
address which we<font color="#CCCCCC"> already knew but proof</font>

768
00:30:00,960 --> 00:30:05,910
of concept there<font color="#CCCCCC"> I realized my mistake</font>

769
00:30:03,480 --> 00:30:07,290
<font color="#CCCCCC">started</font><font color="#E5E5E5"> the c2 server back</font><font color="#CCCCCC"> up on the</font>

770
00:30:05,910 --> 00:30:08,910
<font color="#E5E5E5">retaliate</font><font color="#CCCCCC"> err side I'm now</font><font color="#E5E5E5"> starting</font>

771
00:30:07,290 --> 00:30:12,500
meterpreter<font color="#E5E5E5"> we're gonna ready this</font>

772
00:30:08,910 --> 00:30:18,150
module all we need to do<font color="#E5E5E5"> to ready it is</font>

773
00:30:12,500 --> 00:30:20,040
to first decide to use<font color="#CCCCCC"> it</font><font color="#E5E5E5"> we're gonna</font>

774
00:30:18,150 --> 00:30:23,880
set<font color="#E5E5E5"> our remote host to the one we</font>

775
00:30:20,040 --> 00:30:25,020
extracted<font color="#E5E5E5"> from the malware itself</font><font color="#CCCCCC"> just</font>

776
00:30:23,880 --> 00:30:26,430
show some info on<font color="#CCCCCC"> it make sure</font>

777
00:30:25,020 --> 00:30:28,290
<font color="#E5E5E5">everything</font><font color="#CCCCCC"> looks</font><font color="#E5E5E5"> good if they're using</font>

778
00:30:26,430 --> 00:30:31,170
<font color="#E5E5E5">the magic</font><font color="#CCCCCC"> of oven</font><font color="#E5E5E5"> ghost we can change it</font>

779
00:30:28,290 --> 00:30:33,720
to<font color="#E5E5E5"> match their magic</font><font color="#CCCCCC"> if you do a check</font>

780
00:30:31,170 --> 00:30:35,160
and it's not<font color="#E5E5E5"> ghost</font><font color="#CCCCCC"> it will tell you hey</font>

781
00:30:33,720 --> 00:30:37,110
I think<font color="#E5E5E5"> this is the magic you should</font>

782
00:30:35,160 --> 00:30:40,290
change it<font color="#CCCCCC"> and then we run</font><font color="#E5E5E5"> the exploit</font>

783
00:30:37,110 --> 00:30:41,280
<font color="#E5E5E5">now because I decided to do a heap spray</font>

784
00:30:40,290 --> 00:30:43,200
it's gonna take a little while to

785
00:30:41,280 --> 00:30:47,610
completely fill out the heat<font color="#CCCCCC"> before we</font>

786
00:30:43,200 --> 00:30:49,240
get execution but there it<font color="#CCCCCC"> is</font><font color="#E5E5E5"> we start</font>

787
00:30:47,610 --> 00:30:55,719
<font color="#E5E5E5">sending our meterpreter</font>

788
00:30:49,240 --> 00:30:59,230
<font color="#CCCCCC">a stager back</font><font color="#E5E5E5"> and once I</font><font color="#CCCCCC"> get my console</font>

789
00:30:55,720 --> 00:31:02,560
I believe I do<font color="#CCCCCC"> assists info and we're</font>

790
00:30:59,230 --> 00:31:06,610
gonna pop<font color="#CCCCCC"> calc just as more visual proof</font>

791
00:31:02,560 --> 00:31:10,860
<font color="#E5E5E5">that we have execution on the target so</font>

792
00:31:06,610 --> 00:31:14,169
the question now is what what to do now

793
00:31:10,860 --> 00:31:15,159
and to be honest I'm not<font color="#E5E5E5"> quite</font><font color="#CCCCCC"> sure this</font>

794
00:31:14,170 --> 00:31:17,350
is<font color="#E5E5E5"> not really an area</font><font color="#CCCCCC"> that's</font><font color="#E5E5E5"> been</font>

795
00:31:15,160 --> 00:31:19,540
<font color="#E5E5E5">documented at least publicly what to do</font>

796
00:31:17,350 --> 00:31:21,370
when you're on<font color="#E5E5E5"> an attackers machine but</font>

797
00:31:19,540 --> 00:31:22,360
these are some<font color="#E5E5E5"> things I would think or</font>

798
00:31:21,370 --> 00:31:24,550
suggest<font color="#E5E5E5"> that would probably be</font>

799
00:31:22,360 --> 00:31:26,530
interesting one<font color="#E5E5E5"> of the first I would</font>

800
00:31:24,550 --> 00:31:28,120
suggest is<font color="#CCCCCC"> to run net stat</font><font color="#E5E5E5"> because</font><font color="#CCCCCC"> that</font>

801
00:31:26,530 --> 00:31:30,160
<font color="#CCCCCC">would show you any outbound connections</font>

802
00:31:28,120 --> 00:31:31,959
<font color="#E5E5E5">from that host so if there</font><font color="#CCCCCC"> is any other</font>

803
00:31:30,160 --> 00:31:34,270
<font color="#E5E5E5">victims</font><font color="#CCCCCC"> that they are</font><font color="#E5E5E5"> remote-controlling</font>

804
00:31:31,960 --> 00:31:36,100
via their ghost implant or their plug<font color="#E5E5E5"> X</font>

805
00:31:34,270 --> 00:31:37,660
implant or whatever<font color="#E5E5E5"> you would see who</font>

806
00:31:36,100 --> 00:31:40,360
else<font color="#E5E5E5"> is a victim there at</font><font color="#CCCCCC"> least their IP</font>

807
00:31:37,660 --> 00:31:42,520
address<font color="#CCCCCC"> every one of these tools has a</font>

808
00:31:40,360 --> 00:31:44,530
folder<font color="#E5E5E5"> where they store files downloaded</font>

809
00:31:42,520 --> 00:31:46,810
from<font color="#E5E5E5"> their victims and I would suggest</font>

810
00:31:44,530 --> 00:31:48,129
maybe searching that<font color="#E5E5E5"> to see what type</font><font color="#CCCCCC"> of</font>

811
00:31:46,810 --> 00:31:49,870
<font color="#CCCCCC">event files are they interested to what</font>

812
00:31:48,130 --> 00:31:51,550
have they been gathering<font color="#E5E5E5"> if you know</font>

813
00:31:49,870 --> 00:31:53,260
what they have<font color="#E5E5E5"> been gathering and who</font>

814
00:31:51,550 --> 00:31:55,629
they're<font color="#CCCCCC"> targeting</font><font color="#E5E5E5"> that's very</font><font color="#CCCCCC"> useful</font>

815
00:31:53,260 --> 00:31:56,710
information<font color="#CCCCCC"> maybe</font><font color="#E5E5E5"> you want to stall</font>

816
00:31:55,630 --> 00:31:57,940
persistence maybe you want<font color="#E5E5E5"> to hang</font>

817
00:31:56,710 --> 00:31:59,890
<font color="#CCCCCC">around for</font><font color="#E5E5E5"> quite some</font><font color="#CCCCCC"> time and watch</font>

818
00:31:57,940 --> 00:32:01,360
these<font color="#E5E5E5"> guys and maybe install a key</font>

819
00:31:59,890 --> 00:32:03,100
<font color="#E5E5E5">logger</font><font color="#CCCCCC"> you might find</font><font color="#E5E5E5"> out what else</font>

820
00:32:01,360 --> 00:32:04,659
they're interested in<font color="#E5E5E5"> or maybe</font><font color="#CCCCCC"> their</font>

821
00:32:03,100 --> 00:32:06,580
<font color="#CCCCCC">Facebook profile if they decide to</font><font color="#E5E5E5"> log</font>

822
00:32:04,660 --> 00:32:08,020
<font color="#E5E5E5">in while they wait maybe still their</font>

823
00:32:06,580 --> 00:32:09,909
credentials to start<font color="#E5E5E5"> a numerator</font><font color="#CCCCCC"> Network</font>

824
00:32:08,020 --> 00:32:11,530
<font color="#E5E5E5">I'm not really sure which of these are</font>

825
00:32:09,910 --> 00:32:13,810
good<font color="#E5E5E5"> ideas and maybe they're all bad</font>

826
00:32:11,530 --> 00:32:15,220
ideas like I said is a discussion that

827
00:32:13,810 --> 00:32:17,679
<font color="#E5E5E5">probably still needs to be had because</font>

828
00:32:15,220 --> 00:32:20,350
<font color="#CCCCCC">it's</font><font color="#E5E5E5"> very heavily undocumented at least</font>

829
00:32:17,680 --> 00:32:23,980
publicly undocumented area but<font color="#E5E5E5"> whatever</font>

830
00:32:20,350 --> 00:32:27,219
you do I definitely suggest<font color="#E5E5E5"> you lie low</font>

831
00:32:23,980 --> 00:32:30,810
and<font color="#E5E5E5"> watch not try</font><font color="#CCCCCC"> to draw us</font><font color="#E5E5E5"> damage not</font>

832
00:32:27,220 --> 00:32:33,370
try to<font color="#E5E5E5"> get revenge but observe that's</font>

833
00:32:30,810 --> 00:32:35,379
<font color="#CCCCCC">really hard to see but</font><font color="#E5E5E5"> if</font><font color="#CCCCCC"> you squint and</font>

834
00:32:33,370 --> 00:32:39,340
pretend<font color="#E5E5E5"> that's supposed to be ASCII art</font>

835
00:32:35,380 --> 00:32:41,050
of<font color="#CCCCCC"> Sun zu up there with</font><font color="#E5E5E5"> that I just kind</font>

836
00:32:39,340 --> 00:32:43,750
<font color="#CCCCCC">of</font><font color="#E5E5E5"> close</font><font color="#CCCCCC"> up I want</font><font color="#E5E5E5"> to give thanks to</font>

837
00:32:41,050 --> 00:32:46,450
Bryce<font color="#E5E5E5"> Coons who he presented last</font>

838
00:32:43,750 --> 00:32:48,310
<font color="#CCCCCC">yesterday but he's been</font><font color="#E5E5E5"> doing this kind</font>

839
00:32:46,450 --> 00:32:49,900
of development stuff he likes<font color="#E5E5E5"> to try to</font>

840
00:32:48,310 --> 00:32:50,980
find exploits against<font color="#E5E5E5"> these and he's</font>

841
00:32:49,900 --> 00:32:56,170
been<font color="#E5E5E5"> doing it for much longer than</font><font color="#CCCCCC"> I</font>

842
00:32:50,980 --> 00:32:58,600
have<font color="#E5E5E5"> but with that thank you</font><font color="#CCCCCC"> very</font><font color="#E5E5E5"> much</font><font color="#CCCCCC"> I</font>

843
00:32:56,170 --> 00:33:00,970
have time for<font color="#E5E5E5"> questions if you enjoyed</font>

844
00:32:58,600 --> 00:33:02,409
this please fill out<font color="#E5E5E5"> the survey</font><font color="#CCCCCC"> and</font>

845
00:33:00,970 --> 00:33:03,670
<font color="#E5E5E5">while you're filling that</font><font color="#CCCCCC"> out</font>

846
00:33:02,410 --> 00:33:06,600
take some questions<font color="#E5E5E5"> if</font><font color="#CCCCCC"> anybody wants</font>

847
00:33:03,670 --> 00:33:06,600
thank you

848
00:33:09,690 --> 00:33:12,739
[Applause]

