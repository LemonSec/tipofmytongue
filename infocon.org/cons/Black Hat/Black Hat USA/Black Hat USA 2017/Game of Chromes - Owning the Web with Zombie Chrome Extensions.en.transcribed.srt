1
00:00:00,030 --> 00:00:07,290
hi everyone<font color="#E5E5E5"> welcome I am Thomas</font><font color="#CCCCCC"> Cohen</font>

2
00:00:03,240 --> 00:00:09,750
<font color="#CCCCCC">and I mean I'm walking at wix.com</font>

3
00:00:07,290 --> 00:00:12,870
currently leading the<font color="#E5E5E5"> iron D security</font>

4
00:00:09,750 --> 00:00:15,559
team<font color="#E5E5E5"> me and</font><font color="#CCCCCC"> my</font><font color="#E5E5E5"> team are responsible for</font>

5
00:00:12,870 --> 00:00:18,509
all<font color="#CCCCCC"> physical</font><font color="#E5E5E5"> security aspects of all</font>

6
00:00:15,560 --> 00:00:20,820
<font color="#E5E5E5">productions operations including</font><font color="#CCCCCC"> the</font>

7
00:00:18,510 --> 00:00:23,519
<font color="#CCCCCC">application the infrastructure instant</font>

8
00:00:20,820 --> 00:00:26,910
response and everything<font color="#CCCCCC"> um</font>

9
00:00:23,519 --> 00:00:30,179
and I'm here to talk<font color="#E5E5E5"> about hi about how</font>

10
00:00:26,910 --> 00:00:34,020
to create<font color="#CCCCCC"> a botnet by abusing</font><font color="#E5E5E5"> Chrome</font>

11
00:00:30,179 --> 00:00:36,839
extensions<font color="#E5E5E5"> um</font><font color="#CCCCCC"> and I</font><font color="#E5E5E5"> won't start</font><font color="#CCCCCC"> with my</font>

12
00:00:34,020 --> 00:00:38,399
personal<font color="#E5E5E5"> and my personal experience so</font>

13
00:00:36,840 --> 00:00:42,980
the first big challenge me and<font color="#E5E5E5"> my team</font>

14
00:00:38,399 --> 00:00:45,690
had<font color="#CCCCCC"> to</font><font color="#E5E5E5"> add with the bots was on April 2</font>

15
00:00:42,980 --> 00:00:49,559
2016 it was a<font color="#CCCCCC"> regular there in the</font>

16
00:00:45,690 --> 00:00:52,968
office<font color="#E5E5E5"> and suddenly a dramatic</font><font color="#CCCCCC"> increase</font>

17
00:00:49,559 --> 00:00:56,550
<font color="#CCCCCC">in the</font><font color="#E5E5E5"> new user signup event rate</font>

18
00:00:52,969 --> 00:00:58,920
happened<font color="#E5E5E5"> so that this basically means</font>

19
00:00:56,550 --> 00:01:04,199
<font color="#CCCCCC">that a lot of</font><font color="#E5E5E5"> users</font><font color="#CCCCCC"> are sign up a lot</font>

20
00:00:58,920 --> 00:01:06,390
more<font color="#E5E5E5"> than in planned unusual and and we</font>

21
00:01:04,199 --> 00:01:08,670
started checking things and we saw<font color="#CCCCCC"> that</font>

22
00:01:06,390 --> 00:01:12,240
all these requests are<font color="#CCCCCC"> not originated in</font>

23
00:01:08,670 --> 00:01:14,220
the same<font color="#E5E5E5"> ip or even country so we</font>

24
00:01:12,240 --> 00:01:18,408
<font color="#CCCCCC">started to understand</font><font color="#E5E5E5"> that we are coping</font>

25
00:01:14,220 --> 00:01:21,240
<font color="#E5E5E5">with what we generally call a bot attack</font>

26
00:01:18,409 --> 00:01:23,939
now<font color="#E5E5E5"> before we dive into their instant</font>

27
00:01:21,240 --> 00:01:24,929
interesting part of<font color="#E5E5E5"> this attack few</font>

28
00:01:23,939 --> 00:01:32,158
words about<font color="#CCCCCC"> BOTS</font>

29
00:01:24,930 --> 00:01:33,960
so um<font color="#E5E5E5"> according</font><font color="#CCCCCC"> to a</font><font color="#E5E5E5"> Imperva the</font>

30
00:01:32,159 --> 00:01:37,560
majority<font color="#CCCCCC"> of the traffic</font><font color="#E5E5E5"> in the Internet</font>

31
00:01:33,960 --> 00:01:40,280
today<font color="#E5E5E5"> is done by</font><font color="#CCCCCC"> BOTS most boats are bad</font>

32
00:01:37,560 --> 00:01:44,009
BOTS<font color="#E5E5E5"> and most of the</font><font color="#CCCCCC"> bad boards</font>

33
00:01:40,280 --> 00:01:49,530
impersonators impersonators out bots

34
00:01:44,009 --> 00:01:52,500
that<font color="#E5E5E5"> that fake user human behavior in</font>

35
00:01:49,530 --> 00:01:54,990
websites and they<font color="#E5E5E5"> cause big headaches</font><font color="#CCCCCC"> to</font>

36
00:01:52,500 --> 00:01:57,689
<font color="#CCCCCC">internet companies because they they</font>

37
00:01:54,990 --> 00:02:00,719
blend<font color="#E5E5E5"> into the</font><font color="#CCCCCC"> websites a</font><font color="#E5E5E5"> regular</font>

38
00:01:57,689 --> 00:02:02,579
traffic<font color="#E5E5E5"> and make it very</font><font color="#CCCCCC"> hard</font><font color="#E5E5E5"> and do</font>

39
00:02:00,719 --> 00:02:06,479
malicious<font color="#CCCCCC"> stuff and make</font><font color="#E5E5E5"> it very very</font>

40
00:02:02,579 --> 00:02:09,090
<font color="#E5E5E5">hard for for for the for the website to</font>

41
00:02:06,479 --> 00:02:12,920
<font color="#E5E5E5">distinguish distinguish between the</font>

42
00:02:09,090 --> 00:02:12,920
legit<font color="#CCCCCC"> request and the bottle quest</font>

43
00:02:13,620 --> 00:02:20,530
so back in<font color="#CCCCCC"> our vector attack</font>

44
00:02:16,180 --> 00:02:22,630
we started<font color="#E5E5E5"> investigated deeper what what</font>

45
00:02:20,530 --> 00:02:29,050
is the original origin of this request

46
00:02:22,630 --> 00:02:32,650
and we<font color="#E5E5E5"> found few patterns so and this</font><font color="#CCCCCC"> is</font>

47
00:02:29,050 --> 00:02:34,210
what we knew<font color="#E5E5E5"> during the</font><font color="#CCCCCC"> investigation of</font>

48
00:02:32,650 --> 00:02:39,820
<font color="#E5E5E5">this attack the first thing that we</font>

49
00:02:34,210 --> 00:02:43,450
noticed is<font color="#CCCCCC"> that most of</font><font color="#E5E5E5"> the increase in</font>

50
00:02:39,820 --> 00:02:46,900
<font color="#E5E5E5">the</font><font color="#CCCCCC"> sign up event is is originated in</font>

51
00:02:43,450 --> 00:02:48,940
Latin America<font color="#CCCCCC"> countries</font><font color="#E5E5E5"> and it was this</font>

52
00:02:46,900 --> 00:02:52,560
was<font color="#CCCCCC"> where very will</font><font color="#E5E5E5"> because it was in</font>

53
00:02:48,940 --> 00:02:56,770
high numbers<font color="#E5E5E5"> and as well as most of the</font>

54
00:02:52,560 --> 00:02:59,070
even almost<font color="#CCCCCC"> all of the clients were</font>

55
00:02:56,770 --> 00:03:02,920
coming with<font color="#E5E5E5"> chrome with Google Chrome</font>

56
00:02:59,070 --> 00:03:04,720
<font color="#E5E5E5">second things we've noticed that for</font>

57
00:03:02,920 --> 00:03:09,040
some reason<font color="#E5E5E5"> I mean we did not know the</font>

58
00:03:04,720 --> 00:03:14,170
reason at the<font color="#CCCCCC"> time</font><font color="#E5E5E5"> the signup form used</font>

59
00:03:09,040 --> 00:03:18,160
to say to send the<font color="#E5E5E5"> signup</font><font color="#CCCCCC"> request to</font><font color="#E5E5E5"> to</font>

60
00:03:14,170 --> 00:03:21,040
to our servers was inside<font color="#E5E5E5"> it was in a</font>

61
00:03:18,160 --> 00:03:23,020
frame inside<font color="#E5E5E5"> a facebook</font><font color="#CCCCCC"> tab there was a</font>

62
00:03:21,040 --> 00:03:24,489
facebook tab<font color="#E5E5E5"> and we saw</font><font color="#CCCCCC"> that the</font>

63
00:03:23,020 --> 00:03:27,250
requests are<font color="#CCCCCC"> coming from a frame that</font>

64
00:03:24,490 --> 00:03:28,870
<font color="#E5E5E5">within is within the Facebook</font><font color="#CCCCCC"> tab</font><font color="#E5E5E5"> we</font>

65
00:03:27,250 --> 00:03:31,630
didn't understand like I said what it

66
00:03:28,870 --> 00:03:34,570
means<font color="#E5E5E5"> or it meant but we'll see in a</font>

67
00:03:31,630 --> 00:03:37,870
second why it was like this third<font color="#CCCCCC"> thing</font>

68
00:03:34,570 --> 00:03:40,450
that<font color="#CCCCCC"> we saw so little into about weeks</font>

69
00:03:37,870 --> 00:03:43,209
weeks is a website creation platform

70
00:03:40,450 --> 00:03:46,030
<font color="#CCCCCC">anyone the</font><font color="#E5E5E5"> Internet can come a sign</font><font color="#CCCCCC"> and</font>

71
00:03:43,209 --> 00:03:50,020
<font color="#E5E5E5">sign up and create his</font><font color="#CCCCCC"> own</font><font color="#E5E5E5"> website</font><font color="#CCCCCC"> for</font>

72
00:03:46,030 --> 00:03:54,820
<font color="#E5E5E5">free</font><font color="#CCCCCC"> and so what we've noticed is</font><font color="#E5E5E5"> that a</font>

73
00:03:50,020 --> 00:03:57,700
<font color="#CCCCCC">lot of users that sign up</font><font color="#E5E5E5"> to a new</font>

74
00:03:54,820 --> 00:04:00,280
account and<font color="#E5E5E5"> win weeks</font><font color="#CCCCCC"> and only a 10</font>

75
00:03:57,700 --> 00:04:02,470
<font color="#E5E5E5">seconds after</font><font color="#CCCCCC"> the signup event</font><font color="#E5E5E5"> we see</font>

76
00:04:00,280 --> 00:04:07,060
that the user publishes a new<font color="#E5E5E5"> week's</font>

77
00:04:02,470 --> 00:04:09,190
<font color="#CCCCCC">website</font><font color="#E5E5E5"> now this is real because and</font><font color="#CCCCCC"> ten</font>

78
00:04:07,060 --> 00:04:12,160
seconds is<font color="#E5E5E5"> obviously not enough to edit</font>

79
00:04:09,190 --> 00:04:14,260
your website<font color="#E5E5E5"> and then publish it</font><font color="#CCCCCC"> so we</font>

80
00:04:12,160 --> 00:04:16,690
this is the<font color="#CCCCCC"> this is the point</font><font color="#E5E5E5"> when when</font>

81
00:04:14,260 --> 00:04:19,420
we got a good pattern<font color="#CCCCCC"> and we started to</font>

82
00:04:16,690 --> 00:04:21,640
to distinguish distinguish<font color="#E5E5E5"> between the</font>

83
00:04:19,420 --> 00:04:25,970
legit<font color="#E5E5E5"> requests of users and</font><font color="#CCCCCC"> this bot</font>

84
00:04:21,640 --> 00:04:29,780
<font color="#E5E5E5">requests and so we went</font>

85
00:04:25,970 --> 00:04:32,870
<font color="#CCCCCC">I went and and looked what were these</font>

86
00:04:29,780 --> 00:04:36,409
websites<font color="#E5E5E5"> abou about and this is</font><font color="#CCCCCC"> what we</font>

87
00:04:32,870 --> 00:04:38,210
found<font color="#E5E5E5"> all the</font><font color="#CCCCCC"> websites that were</font><font color="#E5E5E5"> create</font>

88
00:04:36,410 --> 00:04:42,320
<font color="#E5E5E5">in this way in</font><font color="#CCCCCC"> that tent</font><font color="#E5E5E5"> the second</font>

89
00:04:38,210 --> 00:04:46,700
pattern<font color="#E5E5E5"> led to an attack page when this</font>

90
00:04:42,320 --> 00:04:50,780
is in<font color="#E5E5E5"> English and what we see in here is</font>

91
00:04:46,700 --> 00:04:53,390
<font color="#CCCCCC">there is a common scam attack page it</font>

92
00:04:50,780 --> 00:04:56,119
says that if<font color="#E5E5E5"> you</font><font color="#CCCCCC"> want</font><font color="#E5E5E5"> to see who looked</font>

93
00:04:53,390 --> 00:05:00,289
at your profile at Facebook<font color="#CCCCCC"> you can</font>

94
00:04:56,120 --> 00:05:03,560
install a Chrome extension<font color="#CCCCCC"> and and see</font>

95
00:05:00,290 --> 00:05:05,750
who who view your profile as a bonus by

96
00:05:03,560 --> 00:05:08,080
the way you can also always<font color="#E5E5E5"> see what is</font>

97
00:05:05,750 --> 00:05:11,240
the meaning<font color="#E5E5E5"> of your name if</font><font color="#CCCCCC"> you want but</font>

98
00:05:08,080 --> 00:05:13,810
let's let's<font color="#CCCCCC"> go anyway let's click on</font>

99
00:05:11,240 --> 00:05:18,680
start and see what we get

100
00:05:13,810 --> 00:05:21,830
<font color="#E5E5E5">so we click on start and we do get to</font>

101
00:05:18,680 --> 00:05:23,720
the<font color="#E5E5E5"> real Google Chrome Web Store</font><font color="#CCCCCC"> okay</font>

102
00:05:21,830 --> 00:05:24,140
this is the original<font color="#CCCCCC"> Google Chrome Web</font>

103
00:05:23,720 --> 00:05:28,100
Store

104
00:05:24,140 --> 00:05:31,280
it has an extension<font color="#E5E5E5"> called Viad</font><font color="#CCCCCC"> 30</font>

105
00:05:28,100 --> 00:05:34,100
<font color="#CCCCCC">something we didn't recognize this</font>

106
00:05:31,280 --> 00:05:36,349
<font color="#CCCCCC">extension</font><font color="#E5E5E5"> and but we needs to</font><font color="#CCCCCC"> edit stone</font>

107
00:05:34,100 --> 00:05:39,830
that this attack has to do with this

108
00:05:36,350 --> 00:05:43,880
<font color="#E5E5E5">extension</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> we started investigating</font>

109
00:05:39,830 --> 00:05:47,690
<font color="#E5E5E5">the extension and following the code the</font>

110
00:05:43,880 --> 00:05:50,960
code<font color="#E5E5E5"> was highly</font><font color="#CCCCCC"> appreciated and we we</font>

111
00:05:47,690 --> 00:05:52,820
had help from some guy from a lot<font color="#E5E5E5"> of</font>

112
00:05:50,960 --> 00:05:55,640
guys including parameter X which is a

113
00:05:52,820 --> 00:05:59,979
<font color="#E5E5E5">company and that</font><font color="#CCCCCC"> fights bots</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> we use</font>

114
00:05:55,640 --> 00:05:59,979
and this<font color="#CCCCCC"> is what we found</font>

115
00:06:00,580 --> 00:06:06,620
once the extension is installed the

116
00:06:03,890 --> 00:06:09,860
first<font color="#E5E5E5"> thing it does is inject code into</font>

117
00:06:06,620 --> 00:06:11,900
<font color="#E5E5E5">Facebook tab and now Chrome extensions</font>

118
00:06:09,860 --> 00:06:15,380
are with the with proper permissions

119
00:06:11,900 --> 00:06:20,120
like this one has have the ability to

120
00:06:15,380 --> 00:06:21,680
<font color="#E5E5E5">inject JavaScript code into tabs so the</font>

121
00:06:20,120 --> 00:06:23,450
first thing that this<font color="#E5E5E5"> extension does is</font>

122
00:06:21,680 --> 00:06:25,910
inject code into<font color="#E5E5E5"> Facebook why Facebook</font>

123
00:06:23,450 --> 00:06:28,900
<font color="#CCCCCC">I guess because</font><font color="#E5E5E5"> everyone is on Facebook</font>

124
00:06:25,910 --> 00:06:32,390
all<font color="#CCCCCC"> the time and other reasons we'll see</font>

125
00:06:28,900 --> 00:06:34,130
in a minute next<font color="#E5E5E5"> thing it does the code</font>

126
00:06:32,390 --> 00:06:37,849
that is<font color="#E5E5E5"> injected into the Facebook tab</font>

127
00:06:34,130 --> 00:06:39,200
opens<font color="#E5E5E5"> a week's iframe this is what we</font>

128
00:06:37,849 --> 00:06:42,560
saw before

129
00:06:39,200 --> 00:06:44,870
and this<font color="#CCCCCC"> iframe is transparent</font><font color="#E5E5E5"> the</font>

130
00:06:42,560 --> 00:06:47,960
victim user does not<font color="#E5E5E5"> see anything is</font>

131
00:06:44,870 --> 00:06:51,860
<font color="#E5E5E5">that you cannot notice</font><font color="#CCCCCC"> anything but the</font>

132
00:06:47,960 --> 00:06:52,370
frame is<font color="#E5E5E5"> is reading two weeks signup</font>

133
00:06:51,860 --> 00:06:57,110
form

134
00:06:52,370 --> 00:07:00,770
then from within the frame and<font color="#CCCCCC"> attacks</font>

135
00:06:57,110 --> 00:07:05,720
request is is fired<font color="#CCCCCC"> to our two weeks</font>

136
00:07:00,770 --> 00:07:08,090
<font color="#CCCCCC">sign up a</font><font color="#E5E5E5"> serval now one quick question</font>

137
00:07:05,720 --> 00:07:10,280
why would<font color="#CCCCCC"> the attacker even</font><font color="#E5E5E5"> need to open</font>

138
00:07:08,090 --> 00:07:12,229
a<font color="#CCCCCC"> weeks iframe</font><font color="#E5E5E5"> I mean he has the ability</font>

139
00:07:10,280 --> 00:07:14,809
<font color="#CCCCCC">of an extension he can inject just</font>

140
00:07:12,230 --> 00:07:16,490
inject code into Facebook<font color="#E5E5E5"> and then send</font>

141
00:07:14,810 --> 00:07:19,400
<font color="#CCCCCC">request</font><font color="#E5E5E5"> the signup request two weeks</font>

142
00:07:16,490 --> 00:07:22,880
from<font color="#CCCCCC"> Facebook tab to week</font><font color="#E5E5E5"> server this</font><font color="#CCCCCC"> is</font>

143
00:07:19,400 --> 00:07:24,169
<font color="#CCCCCC">the extension</font><font color="#E5E5E5"> is able to do that to do</font>

144
00:07:22,880 --> 00:07:26,890
it<font color="#E5E5E5"> because it does not have the</font>

145
00:07:24,170 --> 00:07:31,970
limitation of course origin request<font color="#E5E5E5"> of</font>

146
00:07:26,890 --> 00:07:37,370
<font color="#E5E5E5">same origin sorry now the answer here is</font>

147
00:07:31,970 --> 00:07:40,280
that because of<font color="#E5E5E5"> this we</font><font color="#CCCCCC"> have basic or</font>

148
00:07:37,370 --> 00:07:43,580
even more than basic<font color="#E5E5E5"> bot detection</font>

149
00:07:40,280 --> 00:07:46,580
system<font color="#E5E5E5"> and if you if the attacker</font><font color="#CCCCCC"> just</font>

150
00:07:43,580 --> 00:07:48,020
send a design<font color="#CCCCCC"> up request</font><font color="#E5E5E5"> just from any</font>

151
00:07:46,580 --> 00:07:51,260
tab on the<font color="#E5E5E5"> Internet</font>

152
00:07:48,020 --> 00:07:54,320
it fails<font color="#CCCCCC"> because this request does not</font>

153
00:07:51,260 --> 00:07:57,289
have the right the proper cookies and

154
00:07:54,320 --> 00:07:59,930
headers and access tokens and and things

155
00:07:57,290 --> 00:08:03,830
<font color="#CCCCCC">that we do in the signup form before the</font>

156
00:07:59,930 --> 00:08:13,010
user comes<font color="#E5E5E5"> to the</font><font color="#CCCCCC"> signup</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> endpoint so</font>

157
00:08:03,830 --> 00:08:15,800
this is this fails however and if okay

158
00:08:13,010 --> 00:08:18,050
so<font color="#CCCCCC"> once somewhat small thing</font><font color="#E5E5E5"> the</font>

159
00:08:15,800 --> 00:08:20,270
attacker wants to send the request<font color="#E5E5E5"> to</font>

160
00:08:18,050 --> 00:08:22,550
<font color="#E5E5E5">sign up</font><font color="#CCCCCC"> to the - - - the sign observable</font>

161
00:08:20,270 --> 00:08:27,349
from<font color="#E5E5E5"> the page that runs the signup form</font>

162
00:08:22,550 --> 00:08:29,420
but extension but he but you<font color="#CCCCCC"> don't want</font>

163
00:08:27,350 --> 00:08:32,260
to open<font color="#CCCCCC"> a new tab to the victim because</font>

164
00:08:29,420 --> 00:08:35,210
the this will<font color="#E5E5E5"> be visible to the user and</font>

165
00:08:32,260 --> 00:08:37,549
there are no invisible tabs in chrome<font color="#CCCCCC"> so</font>

166
00:08:35,210 --> 00:08:40,160
if you want to open<font color="#CCCCCC"> new tab the user</font><font color="#E5E5E5"> has</font>

167
00:08:37,549 --> 00:08:41,750
to see it<font color="#E5E5E5"> so instead of that the</font>

168
00:08:40,159 --> 00:08:44,810
attacker<font color="#E5E5E5"> just injected code into</font>

169
00:08:41,750 --> 00:08:49,420
<font color="#E5E5E5">Facebook that creates an iframe of which</font>

170
00:08:44,810 --> 00:08:51,900
signup form<font color="#CCCCCC"> in the Facebook page and</font>

171
00:08:49,420 --> 00:08:55,160
when the request is sent for

172
00:08:51,900 --> 00:08:56,400
<font color="#CCCCCC">with in this with this I framed</font><font color="#E5E5E5"> the</font>

173
00:08:55,160 --> 00:08:59,730
<font color="#CCCCCC">succeeds</font>

174
00:08:56,400 --> 00:09:02,310
now I remind<font color="#CCCCCC"> you that this iframe was it</font>

175
00:08:59,730 --> 00:09:05,190
was<font color="#E5E5E5"> entirely transparent so</font><font color="#CCCCCC"> the user did</font>

176
00:09:02,310 --> 00:09:06,239
not notice anything but his browser his

177
00:09:05,190 --> 00:09:08,850
<font color="#CCCCCC">Facebook tab</font>

178
00:09:06,240 --> 00:09:12,300
sent a<font color="#CCCCCC"> sign-up request</font><font color="#E5E5E5"> two weeks and it</font>

179
00:09:08,850 --> 00:09:14,280
<font color="#E5E5E5">worked</font><font color="#CCCCCC"> okay let's go back to the</font>

180
00:09:12,300 --> 00:09:17,729
extension course<font color="#E5E5E5"> of action go on with</font>

181
00:09:14,280 --> 00:09:19,470
that<font color="#CCCCCC"> so we saw that that it was inject</font>

182
00:09:17,730 --> 00:09:21,720
<font color="#E5E5E5">code into Facebook then open a week's</font>

183
00:09:19,470 --> 00:09:25,620
iframe then<font color="#E5E5E5"> send the signup request from</font>

184
00:09:21,720 --> 00:09:28,620
within the frame<font color="#E5E5E5"> and the next thing he</font>

185
00:09:25,620 --> 00:09:31,080
<font color="#CCCCCC">does</font><font color="#E5E5E5"> is after signing up a new a new</font>

186
00:09:28,620 --> 00:09:34,350
<font color="#CCCCCC">week's user</font><font color="#E5E5E5"> it publishes</font><font color="#CCCCCC"> a new website</font>

187
00:09:31,080 --> 00:09:36,890
<font color="#E5E5E5">now all the</font><font color="#CCCCCC"> websites lead to one page</font>

188
00:09:34,350 --> 00:09:40,950
<font color="#E5E5E5">that we saw before</font>

189
00:09:36,890 --> 00:09:45,080
this<font color="#E5E5E5"> website has a newly</font><font color="#CCCCCC"> created URL and</font>

190
00:09:40,950 --> 00:09:48,480
the extension then takes this URL and

191
00:09:45,080 --> 00:09:50,550
distribute the link the<font color="#CCCCCC"> you</font><font color="#E5E5E5"> this URL the</font>

192
00:09:48,480 --> 00:09:53,870
attack page URL of the week's<font color="#E5E5E5"> web site</font>

193
00:09:50,550 --> 00:09:58,890
among all<font color="#CCCCCC"> Facebook friends of the victim</font>

194
00:09:53,870 --> 00:10:00,660
using<font color="#E5E5E5"> Facebook messaging the last thing</font>

195
00:09:58,890 --> 00:10:04,319
that<font color="#E5E5E5"> this extension does after this</font>

196
00:10:00,660 --> 00:10:07,199
<font color="#CCCCCC">distribution phase</font><font color="#E5E5E5"> is submitting is</font>

197
00:10:04,320 --> 00:10:09,750
using the<font color="#E5E5E5"> users the victims Google</font>

198
00:10:07,200 --> 00:10:12,270
Google<font color="#CCCCCC"> authorization token</font><font color="#E5E5E5"> it submits a</font>

199
00:10:09,750 --> 00:10:18,780
review of<font color="#E5E5E5"> five stars in Google</font><font color="#CCCCCC"> Web Store</font>

200
00:10:12,270 --> 00:10:21,560
<font color="#E5E5E5">of the malicious extension</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> cool so</font>

201
00:10:18,780 --> 00:10:26,400
<font color="#E5E5E5">this is what extended did extension did</font>

202
00:10:21,560 --> 00:10:30,300
<font color="#E5E5E5">but my question here is why would</font><font color="#CCCCCC"> the</font>

203
00:10:26,400 --> 00:10:32,550
attacker<font color="#E5E5E5"> even need weeks in this in this</font>

204
00:10:30,300 --> 00:10:34,439
campaign<font color="#E5E5E5"> I mean can't he just inject</font>

205
00:10:32,550 --> 00:10:37,439
code to Facebook and<font color="#E5E5E5"> then distribute his</font>

206
00:10:34,440 --> 00:10:39,870
link<font color="#E5E5E5"> to that</font><font color="#CCCCCC"> did his attack page to to</font>

207
00:10:37,440 --> 00:10:43,320
the<font color="#CCCCCC"> friends of</font><font color="#E5E5E5"> the victims why would he</font>

208
00:10:39,870 --> 00:10:47,760
need weeks<font color="#E5E5E5"> on the way so the answer here</font>

209
00:10:43,320 --> 00:10:52,560
<font color="#CCCCCC">is the</font><font color="#E5E5E5"> tweaks was used to distribute a</font>

210
00:10:47,760 --> 00:10:54,750
malware<font color="#E5E5E5"> and the whole part of the whole</font>

211
00:10:52,560 --> 00:10:58,170
<font color="#CCCCCC">role of weeks in his campaign was just</font>

212
00:10:54,750 --> 00:10:59,940
was to supply disposable<font color="#E5E5E5"> URLs okay the</font>

213
00:10:58,170 --> 00:11:03,930
attacker did not want to<font color="#E5E5E5"> send all the</font>

214
00:10:59,940 --> 00:11:06,360
victims the same<font color="#E5E5E5"> URL that</font><font color="#CCCCCC"> off his server</font>

215
00:11:03,930 --> 00:11:08,219
his<font color="#E5E5E5"> attack serval because it's easier</font>

216
00:11:06,360 --> 00:11:10,500
this<font color="#E5E5E5"> this way it's easier</font><font color="#CCCCCC"> for Facebook</font>

217
00:11:08,220 --> 00:11:13,320
to detect<font color="#CCCCCC"> adblock this attack every</font>

218
00:11:10,500 --> 00:11:16,020
victim<font color="#E5E5E5"> opened a new accountant in weeks</font>

219
00:11:13,320 --> 00:11:19,380
<font color="#CCCCCC">and created a new website</font><font color="#E5E5E5"> and sent the</font>

220
00:11:16,020 --> 00:11:24,449
new URL<font color="#E5E5E5"> to</font><font color="#CCCCCC"> his friends and then the</font>

221
00:11:19,380 --> 00:11:26,910
attack was fully distributed<font color="#E5E5E5"> okay so</font>

222
00:11:24,450 --> 00:11:28,860
what<font color="#E5E5E5"> will</font><font color="#CCCCCC"> be described so far is</font>

223
00:11:26,910 --> 00:11:32,880
<font color="#E5E5E5">obviously only the infection phase of</font>

224
00:11:28,860 --> 00:11:35,360
this attack<font color="#E5E5E5"> obviously after after the</font>

225
00:11:32,880 --> 00:11:38,430
<font color="#E5E5E5">infection</font><font color="#CCCCCC"> these bots</font><font color="#E5E5E5"> are used to gang</font>

226
00:11:35,360 --> 00:11:43,080
<font color="#E5E5E5">one thing and you guessed right</font>

227
00:11:38,430 --> 00:11:45,000
it's money<font color="#E5E5E5"> and so both masters do with</font>

228
00:11:43,080 --> 00:11:46,740
<font color="#E5E5E5">this with with their botnets a lot of</font>

229
00:11:45,000 --> 00:11:49,410
things<font color="#E5E5E5"> you're</font><font color="#CCCCCC"> familiar with</font><font color="#E5E5E5"> I guess and</font>

230
00:11:46,740 --> 00:11:52,110
they send spam<font color="#E5E5E5"> for me</font><font color="#CCCCCC"> they're on DDoS</font>

231
00:11:49,410 --> 00:11:54,510
<font color="#CCCCCC">attacks</font><font color="#E5E5E5"> scrape website run click frauds</font>

232
00:11:52,110 --> 00:11:59,310
<font color="#E5E5E5">and they make money after we</font><font color="#CCCCCC"> have to fit</font>

233
00:11:54,510 --> 00:12:03,029
as<font color="#E5E5E5"> many as the more boss that they have</font>

234
00:11:59,310 --> 00:12:07,319
they make more<font color="#E5E5E5"> money of course they can</font>

235
00:12:03,029 --> 00:12:09,300
<font color="#CCCCCC">also put this</font><font color="#E5E5E5"> bot for rent and get money</font>

236
00:12:07,320 --> 00:12:12,500
for doing<font color="#E5E5E5"> these operations for other</font>

237
00:12:09,300 --> 00:12:15,029
people<font color="#E5E5E5"> or on top of that you</font><font color="#CCCCCC"> can always</font>

238
00:12:12,500 --> 00:12:17,520
still steal personal information or

239
00:12:15,029 --> 00:12:20,000
sense the information from the victims

240
00:12:17,520 --> 00:12:23,130
and lateral move through their networks

241
00:12:20,000 --> 00:12:25,380
so this is what they do after after the

242
00:12:23,130 --> 00:12:27,000
<font color="#E5E5E5">the infection phase after</font><font color="#CCCCCC"> the campaign</font>

243
00:12:25,380 --> 00:12:30,029
<font color="#E5E5E5">of</font><font color="#CCCCCC"> the infection</font><font color="#E5E5E5"> and I'm here to talk</font>

244
00:12:27,000 --> 00:12:31,920
about the infection phase and and I want

245
00:12:30,029 --> 00:12:36,930
to show you another<font color="#E5E5E5"> example</font><font color="#CCCCCC"> that</font>

246
00:12:31,920 --> 00:12:41,040
happened<font color="#CCCCCC"> just two months</font><font color="#E5E5E5"> later</font><font color="#CCCCCC"> at</font><font color="#E5E5E5"> June</font>

247
00:12:36,930 --> 00:12:45,660
to think 2016<font color="#E5E5E5"> so in April we struggled</font>

248
00:12:41,040 --> 00:12:48,240
with this this<font color="#E5E5E5"> which</font><font color="#CCCCCC"> this attack attack</font>

249
00:12:45,660 --> 00:12:51,600
actors for<font color="#CCCCCC"> a while and in</font><font color="#E5E5E5"> the end we</font>

250
00:12:48,240 --> 00:12:56,100
<font color="#E5E5E5">blocked them but two months later and a</font>

251
00:12:51,600 --> 00:13:01,589
new attack came to our knowledge<font color="#E5E5E5"> it was</font>

252
00:12:56,100 --> 00:13:03,300
in the news and it says it said that<font color="#CCCCCC"> a</font>

253
00:13:01,589 --> 00:13:05,399
Facebook comment tagging malware is

254
00:13:03,300 --> 00:13:06,899
spreading via<font color="#E5E5E5"> Google Chrome</font><font color="#CCCCCC"> and the</font>

255
00:13:05,399 --> 00:13:08,640
warning is if you receive a facebook

256
00:13:06,899 --> 00:13:10,589
notification<font color="#CCCCCC"> regarding a friend tagging</font>

257
00:13:08,640 --> 00:13:14,819
you in a comment be very careful because

258
00:13:10,589 --> 00:13:19,949
it<font color="#E5E5E5"> can be a malware</font><font color="#CCCCCC"> now this attack</font><font color="#E5E5E5"> what</font>

259
00:13:14,819 --> 00:13:22,228
named<font color="#CCCCCC"> tag me if you can buy</font><font color="#E5E5E5"> you don't</font>

260
00:13:19,949 --> 00:13:25,139
know is<font color="#E5E5E5"> researcher in Kaspersky Labs and</font>

261
00:13:22,229 --> 00:13:27,779
he published<font color="#E5E5E5"> a very</font><font color="#CCCCCC"> detailed report</font>

262
00:13:25,139 --> 00:13:31,769
<font color="#E5E5E5">about this attack and the thing is that</font>

263
00:13:27,779 --> 00:13:34,559
when I saw there it was a report on<font color="#E5E5E5"> this</font>

264
00:13:31,769 --> 00:13:36,359
attack<font color="#E5E5E5"> and you this was the same</font>

265
00:13:34,559 --> 00:13:39,118
attackers that attacked us<font color="#E5E5E5"> two months</font>

266
00:13:36,359 --> 00:13:41,309
<font color="#CCCCCC">before</font><font color="#E5E5E5"> how did I know it you'll see in a</font>

267
00:13:39,119 --> 00:13:44,579
second<font color="#CCCCCC"> let's</font><font color="#E5E5E5"> see how this attacked</font>

268
00:13:41,309 --> 00:13:47,429
walked so the first thing<font color="#CCCCCC"> that the</font>

269
00:13:44,579 --> 00:13:50,579
victim see is a<font color="#E5E5E5"> notification on Facebook</font>

270
00:13:47,429 --> 00:13:55,139
that a friend<font color="#E5E5E5"> of his has tagged him in a</font>

271
00:13:50,579 --> 00:13:57,388
comment upon clicking<font color="#E5E5E5"> this comment after</font>

272
00:13:55,139 --> 00:14:01,079
short<font color="#CCCCCC"> facebook warning that you are</font>

273
00:13:57,389 --> 00:14:03,959
<font color="#CCCCCC">getting out of</font><font color="#E5E5E5"> Facebook jay-z file is</font>

274
00:14:01,079 --> 00:14:08,429
immediately downloaded to the<font color="#E5E5E5"> victims</font>

275
00:14:03,959 --> 00:14:10,888
browser<font color="#E5E5E5"> now a jay-z file is a is access</font>

276
00:14:08,429 --> 00:14:15,179
<font color="#CCCCCC">and</font><font color="#E5E5E5"> executable on all Windows machines</font>

277
00:14:10,889 --> 00:14:18,299
and and if I'm going to<font color="#E5E5E5"> the next step</font>

278
00:14:15,179 --> 00:14:20,999
<font color="#CCCCCC">and I'm clicking this Jessie file and if</font>

279
00:14:18,299 --> 00:14:26,419
you will in the malware<font color="#E5E5E5"> is run runs on</font>

280
00:14:20,999 --> 00:14:30,179
my machine<font color="#E5E5E5"> so what it does this malware</font>

281
00:14:26,419 --> 00:14:33,629
<font color="#E5E5E5">it's firstly it cause it causes</font><font color="#CCCCCC"> Chrome</font>

282
00:14:30,179 --> 00:14:34,350
to crash then it creates a copy of

283
00:14:33,629 --> 00:14:37,350
<font color="#E5E5E5">Chrome</font>

284
00:14:34,350 --> 00:14:40,679
<font color="#E5E5E5">Exe file just with</font><font color="#CCCCCC"> a little addition a</font>

285
00:14:37,350 --> 00:14:44,309
malicious extension installed on the new

286
00:14:40,679 --> 00:14:48,689
chrome process then when the egg when

287
00:14:44,309 --> 00:14:53,039
chrome is reopened<font color="#E5E5E5"> the extension runs</font>

288
00:14:48,689 --> 00:14:56,939
and does two simple things<font color="#E5E5E5"> the first it</font>

289
00:14:53,039 --> 00:14:59,459
uploads a new<font color="#E5E5E5"> jay-z file to the victims</font>

290
00:14:56,939 --> 00:15:02,099
Google Drive using<font color="#CCCCCC"> the Google or Google</font>

291
00:14:59,459 --> 00:15:07,349
authorization token<font color="#E5E5E5"> the next thing it</font>

292
00:15:02,100 --> 00:15:07,859
does it takes the URL<font color="#CCCCCC"> one</font><font color="#E5E5E5"> little more</font>

293
00:15:07,350 --> 00:15:11,600
thing

294
00:15:07,859 --> 00:15:14,729
it makes this file public to<font color="#E5E5E5"> everyone so</font>

295
00:15:11,600 --> 00:15:18,689
other victims could get<font color="#E5E5E5"> this URL of the</font>

296
00:15:14,729 --> 00:15:20,759
<font color="#E5E5E5">jay-z file and access it so</font><font color="#CCCCCC"> after that</font>

297
00:15:18,689 --> 00:15:23,029
<font color="#CCCCCC">it</font><font color="#E5E5E5"> takes the URL of the</font><font color="#CCCCCC"> jay-z file</font>

298
00:15:20,759 --> 00:15:26,459
upload it to<font color="#E5E5E5"> a</font><font color="#CCCCCC"> Google Drive</font><font color="#E5E5E5"> and</font>

299
00:15:23,029 --> 00:15:27,570
distribute it and using Facebook

300
00:15:26,459 --> 00:15:31,739
commenting<font color="#CCCCCC"> plugin</font>

301
00:15:27,570 --> 00:15:35,430
and as we saw before<font color="#CCCCCC"> what it does it</font>

302
00:15:31,740 --> 00:15:38,070
creates<font color="#E5E5E5"> a comment with a tag of all</font>

303
00:15:35,430 --> 00:15:40,500
these<font color="#E5E5E5"> friends</font><font color="#CCCCCC"> that lead</font><font color="#E5E5E5"> to the newly</font>

304
00:15:38,070 --> 00:15:47,930
<font color="#E5E5E5">created</font><font color="#CCCCCC"> JC file</font><font color="#E5E5E5"> in the victims Google</font>

305
00:15:40,500 --> 00:15:51,690
<font color="#E5E5E5">Drive is that clear so one of the</font>

306
00:15:47,930 --> 00:15:54,180
victims friends on<font color="#E5E5E5"> Facebook opens a</font>

307
00:15:51,690 --> 00:15:57,000
clicks on<font color="#E5E5E5"> this notification and the</font>

308
00:15:54,180 --> 00:16:00,329
whole thing runs over and over again and

309
00:15:57,000 --> 00:16:09,450
we got an exponential growth<font color="#E5E5E5"> infection</font>

310
00:16:00,330 --> 00:16:12,450
process<font color="#CCCCCC"> you must be</font><font color="#E5E5E5"> asking yourselves</font>

311
00:16:09,450 --> 00:16:15,030
<font color="#E5E5E5">how did these attackers and create a</font>

312
00:16:12,450 --> 00:16:19,200
notification<font color="#E5E5E5"> that lead</font><font color="#CCCCCC"> to a download of</font>

313
00:16:15,030 --> 00:16:21,660
a<font color="#CCCCCC"> JC file so this is very</font><font color="#E5E5E5"> interesting</font>

314
00:16:19,200 --> 00:16:23,490
<font color="#CCCCCC">but</font><font color="#E5E5E5"> it's too long</font><font color="#CCCCCC"> for this talk</font><font color="#E5E5E5"> you can</font>

315
00:16:21,660 --> 00:16:26,040
find more<font color="#E5E5E5"> more details in the white</font>

316
00:16:23,490 --> 00:16:29,670
paper<font color="#CCCCCC"> of this</font><font color="#E5E5E5"> dis</font><font color="#CCCCCC"> presentation or in</font>

317
00:16:26,040 --> 00:16:31,530
<font color="#CCCCCC">Donna's report</font><font color="#E5E5E5"> in more details about</font>

318
00:16:29,670 --> 00:16:36,020
this attack<font color="#CCCCCC"> tag me if you can</font>

319
00:16:31,530 --> 00:16:38,579
very interesting so we saw two attacks<font color="#CCCCCC"> I</font>

320
00:16:36,020 --> 00:16:41,760
<font color="#CCCCCC">promise to tell</font><font color="#E5E5E5"> you how I knew that it</font>

321
00:16:38,580 --> 00:16:43,710
were the same attackers so the

322
00:16:41,760 --> 00:16:47,120
extensions that<font color="#CCCCCC"> were used in both the</font>

323
00:16:43,710 --> 00:16:50,040
<font color="#E5E5E5">text were very similar and they use</font>

324
00:16:47,120 --> 00:16:53,580
mutual code snippets called code parts

325
00:16:50,040 --> 00:16:56,490
and also used in some in<font color="#CCCCCC"> some cases the</font>

326
00:16:53,580 --> 00:16:58,170
same domains<font color="#E5E5E5"> belonging to that these</font>

327
00:16:56,490 --> 00:17:01,920
attackers<font color="#CCCCCC"> this is how we knew for sure</font>

328
00:16:58,170 --> 00:17:04,859
that<font color="#E5E5E5"> it's the same attackers and now in</font>

329
00:17:01,920 --> 00:17:06,720
<font color="#CCCCCC">these</font><font color="#E5E5E5"> two attacks that we saw there's a</font>

330
00:17:04,859 --> 00:17:09,419
<font color="#E5E5E5">pattern okay this is this is how it goes</font>

331
00:17:06,720 --> 00:17:11,850
<font color="#E5E5E5">this is also how are you</font><font color="#CCCCCC"> recognize that</font>

332
00:17:09,420 --> 00:17:15,570
<font color="#E5E5E5">it was the same attackers it all starts</font>

333
00:17:11,849 --> 00:17:17,819
with a user clicking in the first attack

334
00:17:15,569 --> 00:17:19,800
it was user<font color="#E5E5E5"> clicking on a Facebook</font><font color="#CCCCCC"> and</font>

335
00:17:17,819 --> 00:17:23,339
<font color="#E5E5E5">message on a second attack it was a</font>

336
00:17:19,800 --> 00:17:25,889
<font color="#CCCCCC">notification then somehow</font><font color="#E5E5E5"> an extension</font><font color="#CCCCCC"> a</font>

337
00:17:23,339 --> 00:17:29,639
malicious<font color="#CCCCCC"> chrome extension is</font><font color="#E5E5E5"> installed</font>

338
00:17:25,890 --> 00:17:32,610
on his browser<font color="#E5E5E5"> and in the first attack</font>

339
00:17:29,640 --> 00:17:34,350
it was<font color="#CCCCCC"> a the user had to</font><font color="#E5E5E5"> install it from</font>

340
00:17:32,610 --> 00:17:36,840
<font color="#CCCCCC">the web</font><font color="#E5E5E5"> store in a second attack and</font>

341
00:17:34,350 --> 00:17:39,600
executable the JC file created the<font color="#E5E5E5"> sixth</font>

342
00:17:36,840 --> 00:17:41,070
<font color="#CCCCCC">install this extension next thing the</font>

343
00:17:39,600 --> 00:17:43,949
extension<font color="#E5E5E5"> runs and</font>

344
00:17:41,070 --> 00:17:46,860
create a new malicious payload instance

345
00:17:43,950 --> 00:17:50,220
in the weeks attack it was a new<font color="#E5E5E5"> Wix</font>

346
00:17:46,860 --> 00:17:52,290
website<font color="#E5E5E5"> that that that offers you to</font>

347
00:17:50,220 --> 00:17:55,410
install<font color="#E5E5E5"> the</font><font color="#CCCCCC"> extension</font><font color="#E5E5E5"> in a second attack</font>

348
00:17:52,290 --> 00:17:58,230
it was a<font color="#E5E5E5"> JC file upload to it uploaded</font>

349
00:17:55,410 --> 00:18:00,660
<font color="#E5E5E5">to the users Google Drive then</font><font color="#CCCCCC"> it always</font>

350
00:17:58,230 --> 00:18:03,030
takes<font color="#CCCCCC"> the URL</font><font color="#E5E5E5"> of the newly of the newly</font>

351
00:18:00,660 --> 00:18:06,690
created<font color="#CCCCCC"> payload instance and send it</font>

352
00:18:03,030 --> 00:18:08,820
somehow<font color="#E5E5E5"> among to all Facebook friends of</font>

353
00:18:06,690 --> 00:18:12,000
the victim can be<font color="#E5E5E5"> with messages or</font>

354
00:18:08,820 --> 00:18:15,300
notifications<font color="#E5E5E5"> one as we saw before one</font>

355
00:18:12,000 --> 00:18:19,250
of<font color="#E5E5E5"> the fu</font><font color="#CCCCCC"> victims friends click and then</font>

356
00:18:15,300 --> 00:18:22,620
the whole thing<font color="#CCCCCC"> runs over</font><font color="#E5E5E5"> and over again</font>

357
00:18:19,250 --> 00:18:26,850
<font color="#E5E5E5">now the</font><font color="#CCCCCC"> company's abused in these two</font>

358
00:18:22,620 --> 00:18:28,850
campaigns<font color="#E5E5E5"> and we reviewed are not mine</font>

359
00:18:26,850 --> 00:18:32,159
of companies right<font color="#CCCCCC"> we</font><font color="#E5E5E5"> are talking</font><font color="#CCCCCC"> about</font>

360
00:18:28,850 --> 00:18:34,889
<font color="#E5E5E5">Facebook Google</font><font color="#CCCCCC"> and vidcom and the three</font>

361
00:18:32,160 --> 00:18:38,400
of them<font color="#E5E5E5"> the this magical bot somehow</font>

362
00:18:34,890 --> 00:18:40,980
comes and defeats<font color="#E5E5E5"> their body detection</font>

363
00:18:38,400 --> 00:18:43,620
systems of all these<font color="#E5E5E5"> companies all day</font>

364
00:18:40,980 --> 00:18:45,680
all the company all the<font color="#CCCCCC"> em the services</font>

365
00:18:43,620 --> 00:18:49,889
that we were discussing discussing

366
00:18:45,680 --> 00:18:51,630
<font color="#E5E5E5">upload a file</font><font color="#CCCCCC"> to Google Drive send</font><font color="#E5E5E5"> fed</font>

367
00:18:49,890 --> 00:18:54,510
with<font color="#E5E5E5"> Facebook messages it all have</font>

368
00:18:51,630 --> 00:18:58,590
bought protection mechanisms on them so

369
00:18:54,510 --> 00:19:01,080
how why why do common<font color="#E5E5E5"> bot common BOTS</font>

370
00:18:58,590 --> 00:19:05,280
<font color="#E5E5E5">fail to bypass this protection and these</font>

371
00:19:01,080 --> 00:19:10,020
<font color="#E5E5E5">BOTS succeeds so</font><font color="#CCCCCC"> let's have a second to</font>

372
00:19:05,280 --> 00:19:13,680
<font color="#E5E5E5">analyze what makes a good bot so the</font>

373
00:19:10,020 --> 00:19:18,900
goal of<font color="#CCCCCC"> good bot is to look as human as</font>

374
00:19:13,680 --> 00:19:21,600
he can<font color="#CCCCCC"> right</font><font color="#E5E5E5"> it has</font><font color="#CCCCCC"> to the good but will</font>

375
00:19:18,900 --> 00:19:23,370
want website to think that<font color="#E5E5E5"> he is</font><font color="#CCCCCC"> a human</font>

376
00:19:21,600 --> 00:19:25,500
<font color="#CCCCCC">that is sitting</font><font color="#E5E5E5"> on</font><font color="#CCCCCC"> his computer and</font>

377
00:19:23,370 --> 00:19:34,020
surfing at<font color="#CCCCCC"> the Internet using his</font>

378
00:19:25,500 --> 00:19:36,300
browser right so um and how do popular

379
00:19:34,020 --> 00:19:38,160
bot protection techniques walk<font color="#E5E5E5"> okay the</font>

380
00:19:36,300 --> 00:19:42,240
first thing<font color="#CCCCCC"> that what protection</font>

381
00:19:38,160 --> 00:19:46,050
mechanism a challenge<font color="#CCCCCC"> BOTS</font><font color="#E5E5E5"> to what BOTS</font>

382
00:19:42,240 --> 00:19:49,860
with is JavaScript<font color="#E5E5E5"> most boss today run</font>

383
00:19:46,050 --> 00:19:53,159
JavaScript but you can<font color="#CCCCCC"> always create a</font>

384
00:19:49,860 --> 00:19:54,240
tailor-made<font color="#E5E5E5"> JavaScript calculation to a</font>

385
00:19:53,160 --> 00:19:56,700
client

386
00:19:54,240 --> 00:19:59,490
ending on his version<font color="#E5E5E5"> of the version</font>

387
00:19:56,700 --> 00:20:02,340
that<font color="#E5E5E5"> he claims he is for example if I if</font>

388
00:19:59,490 --> 00:20:04,860
<font color="#E5E5E5">I'm claiming that I'm running a chrome</font>

389
00:20:02,340 --> 00:20:08,159
in some version there<font color="#E5E5E5"> are specific</font>

390
00:20:04,860 --> 00:20:11,729
JavaScript<font color="#E5E5E5"> challenges that can be that</font>

391
00:20:08,160 --> 00:20:14,280
<font color="#CCCCCC">can be</font><font color="#E5E5E5"> given to</font><font color="#CCCCCC"> the twist client and and</font>

392
00:20:11,730 --> 00:20:17,820
if<font color="#E5E5E5"> it's a if if it's if it's not a real</font>

393
00:20:14,280 --> 00:20:20,940
home<font color="#CCCCCC"> chrome</font><font color="#E5E5E5"> browser it the odds are that</font>

394
00:20:17,820 --> 00:20:22,889
he will<font color="#E5E5E5"> not succeed</font><font color="#CCCCCC"> now this problem is</font>

395
00:20:20,940 --> 00:20:26,330
solved he solved in our case right

396
00:20:22,890 --> 00:20:29,550
because<font color="#CCCCCC"> Dex our extension is running as</font>

397
00:20:26,330 --> 00:20:32,939
sorry<font color="#E5E5E5"> our bot is running as a Chrome</font>

398
00:20:29,550 --> 00:20:36,059
extension which<font color="#CCCCCC"> runs inside chrome</font><font color="#E5E5E5"> so</font>

399
00:20:32,940 --> 00:20:38,520
you can give us you can give this bot

400
00:20:36,059 --> 00:20:38,879
whatever<font color="#CCCCCC"> JavaScript</font><font color="#E5E5E5"> challenges that you</font>

401
00:20:38,520 --> 00:20:40,760
want

402
00:20:38,880 --> 00:20:45,330
he will we will cope with it

403
00:20:40,760 --> 00:20:48,150
successfully the second thing is what I

404
00:20:45,330 --> 00:20:52,139
like<font color="#E5E5E5"> to call human context so this</font>

405
00:20:48,150 --> 00:20:54,780
<font color="#CCCCCC">includes a lot</font><font color="#E5E5E5"> of stuff for exam for</font>

406
00:20:52,140 --> 00:20:58,230
example<font color="#E5E5E5"> a mouse movement and keystrokes</font>

407
00:20:54,780 --> 00:21:01,050
<font color="#CCCCCC">and all the human behavior</font><font color="#E5E5E5"> that that</font>

408
00:20:58,230 --> 00:21:07,320
involves when you surf the<font color="#E5E5E5"> Internet</font>

409
00:21:01,050 --> 00:21:09,330
in addition it also<font color="#E5E5E5"> um the</font><font color="#CCCCCC"> user context</font>

410
00:21:07,320 --> 00:21:13,189
here is very important as we saw in

411
00:21:09,330 --> 00:21:15,840
weeks<font color="#E5E5E5"> if you just there's a flow of of</font>

412
00:21:13,190 --> 00:21:20,520
events that<font color="#E5E5E5"> should happen when a user</font>

413
00:21:15,840 --> 00:21:22,889
for instance<font color="#E5E5E5"> signing up to two to two</font>

414
00:21:20,520 --> 00:21:25,020
apps to a way to<font color="#E5E5E5"> story to</font><font color="#CCCCCC"> a website</font>

415
00:21:22,890 --> 00:21:27,240
<font color="#E5E5E5">first it has</font><font color="#CCCCCC"> to go through</font><font color="#E5E5E5"> the signup</font>

416
00:21:25,020 --> 00:21:34,050
form<font color="#CCCCCC"> and only</font><font color="#E5E5E5"> then he</font><font color="#CCCCCC"> can send a signup</font>

417
00:21:27,240 --> 00:21:38,700
request<font color="#CCCCCC"> um</font><font color="#E5E5E5"> so this</font><font color="#CCCCCC"> bot need to somehow</font>

418
00:21:34,050 --> 00:21:40,950
get<font color="#E5E5E5"> into context of a real user now the</font>

419
00:21:38,700 --> 00:21:43,950
best way to get into a context of<font color="#E5E5E5"> a user</font>

420
00:21:40,950 --> 00:21:47,280
is to inject JavaScript code into the

421
00:21:43,950 --> 00:21:50,910
users active tabs<font color="#E5E5E5"> right if i if I'm able</font>

422
00:21:47,280 --> 00:21:52,860
<font color="#E5E5E5">to put</font><font color="#CCCCCC"> my code into the</font><font color="#E5E5E5"> users real</font>

423
00:21:50,910 --> 00:21:57,059
active tabs that you<font color="#E5E5E5"> walk with for</font>

424
00:21:52,860 --> 00:22:02,428
example<font color="#CCCCCC"> Facebook I can get his context</font>

425
00:21:57,059 --> 00:22:06,000
<font color="#E5E5E5">and with the site</font><font color="#CCCCCC"> um and this</font><font color="#E5E5E5"> is</font>

426
00:22:02,429 --> 00:22:07,140
actually what browser extensions are all

427
00:22:06,000 --> 00:22:08,670
about

428
00:22:07,140 --> 00:22:11,300
getting the context of the user

429
00:22:08,670 --> 00:22:15,090
<font color="#E5E5E5">injecting JavaScript into active tabs</font>

430
00:22:11,300 --> 00:22:19,470
<font color="#E5E5E5">now if you ask yourselves how didn't how</font>

431
00:22:15,090 --> 00:22:22,740
did Facebook and Google and<font color="#E5E5E5"> not block</font>

432
00:22:19,470 --> 00:22:26,220
this attack or block extensions<font color="#E5E5E5"> from</font>

433
00:22:22,740 --> 00:22:30,210
doing<font color="#E5E5E5"> this these operations</font><font color="#CCCCCC"> the answer</font>

434
00:22:26,220 --> 00:22:33,060
is that it's<font color="#E5E5E5"> not a bug it's a feature if</font>

435
00:22:30,210 --> 00:22:36,000
you think about<font color="#E5E5E5"> it</font><font color="#CCCCCC"> extensions should</font><font color="#E5E5E5"> be</font>

436
00:22:33,060 --> 00:22:39,179
<font color="#CCCCCC">able</font><font color="#E5E5E5"> to do all</font><font color="#CCCCCC"> these kind of stuff to</font>

437
00:22:36,000 --> 00:22:41,670
send<font color="#CCCCCC"> send Facebook messages and</font><font color="#E5E5E5"> upload a</font>

438
00:22:39,180 --> 00:22:43,920
<font color="#E5E5E5">a and upload</font><font color="#CCCCCC"> a file to</font><font color="#E5E5E5"> Google Drive and</font>

439
00:22:41,670 --> 00:22:46,740
and actually<font color="#E5E5E5"> anything else that people</font>

440
00:22:43,920 --> 00:22:54,390
wants to<font color="#E5E5E5"> have a on the</font><font color="#CCCCCC"> Internet in with</font>

441
00:22:46,740 --> 00:22:58,470
<font color="#CCCCCC">Chrome with extensions so this and this</font>

442
00:22:54,390 --> 00:23:01,160
makes BOTS<font color="#CCCCCC"> that ran on on browser</font>

443
00:22:58,470 --> 00:23:05,100
extensions<font color="#E5E5E5"> very power</font><font color="#CCCCCC"> very powerful</font><font color="#E5E5E5"> tool</font>

444
00:23:01,160 --> 00:23:07,620
let's have a second to see the to

445
00:23:05,100 --> 00:23:09,330
understand the full capabilities of<font color="#CCCCCC"> an</font>

446
00:23:07,620 --> 00:23:13,439
extension<font color="#E5E5E5"> let's have a second to see</font>

447
00:23:09,330 --> 00:23:15,240
there to review the manifest file<font color="#E5E5E5"> of the</font>

448
00:23:13,440 --> 00:23:21,540
extension that we saw before attacking

449
00:23:15,240 --> 00:23:23,300
weeks<font color="#E5E5E5"> so in the red and the</font><font color="#CCCCCC"> word frame</font>

450
00:23:21,540 --> 00:23:26,879
you can<font color="#CCCCCC"> see the name of the extension</font>

451
00:23:23,300 --> 00:23:30,450
viadon<font color="#CCCCCC"> Locker and they that</font><font color="#E5E5E5"> these</font>

452
00:23:26,880 --> 00:23:33,870
attackers used a name of an already

453
00:23:30,450 --> 00:23:37,140
<font color="#CCCCCC">existing extension that</font><font color="#E5E5E5"> was already in</font>

454
00:23:33,870 --> 00:23:38,939
<font color="#CCCCCC">the</font><font color="#E5E5E5"> in the store I guess they</font><font color="#CCCCCC"> as they</font>

455
00:23:37,140 --> 00:23:42,000
figured out<font color="#CCCCCC"> that it's easier that</font><font color="#E5E5E5"> way</font><font color="#CCCCCC"> to</font>

456
00:23:38,940 --> 00:23:44,760
pass<font color="#E5E5E5"> Google's screening process in the</font>

457
00:23:42,000 --> 00:23:47,280
<font color="#CCCCCC">webstore so what we see here and this is</font>

458
00:23:44,760 --> 00:23:51,060
the most important part of the manifest

459
00:23:47,280 --> 00:23:53,639
<font color="#E5E5E5">it has a permission to to fire</font>

460
00:23:51,060 --> 00:23:57,240
<font color="#E5E5E5">cross-origin requests to any destination</font>

461
00:23:53,640 --> 00:23:59,460
he wants on the<font color="#CCCCCC"> internet and this also</font>

462
00:23:57,240 --> 00:24:03,390
allows<font color="#CCCCCC"> this extension</font><font color="#E5E5E5"> to inject</font>

463
00:23:59,460 --> 00:24:07,170
JavaScript code into any tab of the<font color="#CCCCCC"> URL</font>

464
00:24:03,390 --> 00:24:09,840
<font color="#CCCCCC">that the user is using what else we have</font>

465
00:24:07,170 --> 00:24:13,080
<font color="#E5E5E5">access</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> all user cookies in all tabs</font>

466
00:24:09,840 --> 00:24:17,490
<font color="#E5E5E5">that</font><font color="#CCCCCC"> by the way includes also HTTP only</font>

467
00:24:13,080 --> 00:24:19,159
cookies next thing we see<font color="#E5E5E5"> is that the</font>

468
00:24:17,490 --> 00:24:23,180
extension had has

469
00:24:19,160 --> 00:24:25,100
<font color="#CCCCCC">a back on</font><font color="#E5E5E5"> script back on script runs in</font>

470
00:24:23,180 --> 00:24:26,930
the background once the extension is

471
00:24:25,100 --> 00:24:33,290
installed<font color="#CCCCCC"> and</font><font color="#E5E5E5"> let's have a look at this</font>

472
00:24:26,930 --> 00:24:35,390
<font color="#E5E5E5">get that script what we see here so this</font>

473
00:24:33,290 --> 00:24:37,430
<font color="#E5E5E5">background script is</font><font color="#CCCCCC"> actually the</font>

474
00:24:35,390 --> 00:24:37,970
command and<font color="#CCCCCC"> control system</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> the</font>

475
00:24:37,430 --> 00:24:40,190
attacker

476
00:24:37,970 --> 00:24:42,830
I'll explain<font color="#E5E5E5"> let's see what it does so</font>

477
00:24:40,190 --> 00:24:44,750
first<font color="#E5E5E5"> every time</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> adds it</font><font color="#CCCCCC"> adds a</font>

478
00:24:42,830 --> 00:24:50,689
<font color="#E5E5E5">listener that is triggered every time a</font>

479
00:24:44,750 --> 00:24:53,960
tab tab is<font color="#E5E5E5"> is updated any energy on</font><font color="#CCCCCC"> any</font>

480
00:24:50,690 --> 00:24:56,210
change<font color="#E5E5E5"> on a tab and then it goes</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> a</font>

481
00:24:53,960 --> 00:24:58,940
server belonging to that Tucker<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is</font>

482
00:24:56,210 --> 00:25:02,120
<font color="#CCCCCC">what what you see</font><font color="#E5E5E5"> here and</font><font color="#CCCCCC"> gets a</font><font color="#E5E5E5"> file</font>

483
00:24:58,940 --> 00:25:05,210
<font color="#E5E5E5">called data dot GS which is the commands</font>

484
00:25:02,120 --> 00:25:09,850
file to this<font color="#CCCCCC"> bot</font><font color="#E5E5E5"> from the attacker</font>

485
00:25:05,210 --> 00:25:12,080
server<font color="#E5E5E5"> then it takes this data</font><font color="#CCCCCC"> j as</font><font color="#E5E5E5"> a</font>

486
00:25:09,850 --> 00:25:15,550
script<font color="#E5E5E5"> from the attacker service and</font>

487
00:25:12,080 --> 00:25:18,949
<font color="#E5E5E5">eggs and using the chrome API tabs a</font>

488
00:25:15,550 --> 00:25:25,780
<font color="#CCCCCC">copy</font><font color="#E5E5E5"> I tabs dot execute script it runs</font>

489
00:25:18,950 --> 00:25:30,650
it on the active tab so this<font color="#E5E5E5"> actually</font>

490
00:25:25,780 --> 00:25:33,800
make this bot not static<font color="#E5E5E5"> I mean the</font>

491
00:25:30,650 --> 00:25:36,800
attacker is able<font color="#CCCCCC"> to</font><font color="#E5E5E5"> adjust his attack</font>

492
00:25:33,800 --> 00:25:41,780
<font color="#CCCCCC">all the time he can</font><font color="#E5E5E5"> always change the a</font>

493
00:25:36,800 --> 00:25:44,659
commands file that is that is served<font color="#CCCCCC"> to</font>

494
00:25:41,780 --> 00:25:47,480
his boss<font color="#CCCCCC"> he can also create a</font><font color="#E5E5E5"> commands</font>

495
00:25:44,660 --> 00:25:50,180
file specifically for every domain that

496
00:25:47,480 --> 00:25:52,910
is updated<font color="#E5E5E5"> for example I want to send a</font>

497
00:25:50,180 --> 00:25:55,730
send messages on facebook and<font color="#CCCCCC"> I want to</font>

498
00:25:52,910 --> 00:26:00,380
upload<font color="#CCCCCC"> if I'm on Google</font><font color="#E5E5E5"> I want to upload</font>

499
00:25:55,730 --> 00:26:02,600
the file or whatever<font color="#E5E5E5"> and this makes this</font>

500
00:26:00,380 --> 00:26:06,410
is a very powerful thing<font color="#CCCCCC"> because it</font>

501
00:26:02,600 --> 00:26:10,490
<font color="#CCCCCC">allows the attacker</font><font color="#E5E5E5"> to change his attack</font>

502
00:26:06,410 --> 00:26:13,550
<font color="#E5E5E5">according to to what happens for</font><font color="#CCCCCC"> example</font>

503
00:26:10,490 --> 00:26:16,910
I<font color="#E5E5E5"> told you before that we had we saw</font>

504
00:26:13,550 --> 00:26:19,700
that users that only<font color="#CCCCCC"> ten seconds</font><font color="#E5E5E5"> after</font>

505
00:26:16,910 --> 00:26:21,980
<font color="#E5E5E5">the sign up they publish the site so we</font>

506
00:26:19,700 --> 00:26:25,430
set out to<font color="#E5E5E5"> ourselves</font><font color="#CCCCCC"> okay that's</font><font color="#E5E5E5"> easy</font>

507
00:26:21,980 --> 00:26:30,080
<font color="#E5E5E5">let's just unpublish a web sites that</font>

508
00:26:25,430 --> 00:26:31,820
<font color="#E5E5E5">are published only less than 20 seconds</font>

509
00:26:30,080 --> 00:26:32,960
after<font color="#CCCCCC"> the sign up event and we started</font>

510
00:26:31,820 --> 00:26:35,049
<font color="#E5E5E5">I'll publish this we</font>

511
00:26:32,960 --> 00:26:38,750
this website<font color="#CCCCCC"> and</font><font color="#E5E5E5"> the attacked stopped</font>

512
00:26:35,049 --> 00:26:40,970
for<font color="#CCCCCC"> about half an hour and then the</font>

513
00:26:38,750 --> 00:26:45,320
attacker<font color="#CCCCCC"> just changed the commands file</font>

514
00:26:40,970 --> 00:26:48,200
to run to<font color="#E5E5E5"> like have a randomized timeout</font>

515
00:26:45,320 --> 00:26:53,928
between the sign up<font color="#E5E5E5"> link event and and</font>

516
00:26:48,200 --> 00:26:56,929
and the published website event all

517
00:26:53,929 --> 00:27:00,559
these makes browser extension the

518
00:26:56,929 --> 00:27:02,870
perfect but it can struggle<font color="#E5E5E5"> it can cope</font>

519
00:27:00,559 --> 00:27:06,559
<font color="#E5E5E5">with any JavaScript challenge it can run</font>

520
00:27:02,870 --> 00:27:15,678
it can inject code in the context of<font color="#E5E5E5"> the</font>

521
00:27:06,559 --> 00:27:21,070
user<font color="#E5E5E5"> the thing is that it's just too</font>

522
00:27:15,679 --> 00:27:24,649
<font color="#CCCCCC">much</font><font color="#E5E5E5"> work right I mean this campaigns a</font>

523
00:27:21,070 --> 00:27:28,700
required much effort from these

524
00:27:24,649 --> 00:27:30,529
attackers<font color="#E5E5E5"> to run and if they had to if</font>

525
00:27:28,700 --> 00:27:33,620
<font color="#E5E5E5">you want to</font><font color="#CCCCCC"> distribute your</font><font color="#E5E5E5"> own</font>

526
00:27:30,529 --> 00:27:36,950
malicious extension you have to somehow

527
00:27:33,620 --> 00:27:39,408
<font color="#E5E5E5">pass the screening process of Google Web</font>

528
00:27:36,950 --> 00:27:43,309
Store and and smuggle your malicious

529
00:27:39,409 --> 00:27:46,659
extension into the store<font color="#E5E5E5"> after</font><font color="#CCCCCC"> that you</font>

530
00:27:43,309 --> 00:27:49,760
have<font color="#E5E5E5"> to somehow persuade and convince</font>

531
00:27:46,659 --> 00:27:52,159
<font color="#E5E5E5">victim users to install this extension</font>

532
00:27:49,760 --> 00:27:54,529
<font color="#CCCCCC">or in the other hand</font><font color="#E5E5E5"> which</font><font color="#CCCCCC"> is</font>

533
00:27:52,159 --> 00:27:59,720
complicated<font color="#E5E5E5"> as well somehow one</font>

534
00:27:54,529 --> 00:28:02,450
executable on on<font color="#E5E5E5"> these victims also once</font>

535
00:27:59,720 --> 00:28:04,580
<font color="#E5E5E5">if your malicious extension is in the</font>

536
00:28:02,450 --> 00:28:07,149
Google Web Store<font color="#E5E5E5"> once you have your</font>

537
00:28:04,580 --> 00:28:11,480
extension is revealed<font color="#E5E5E5"> as malicious</font>

538
00:28:07,149 --> 00:28:14,178
<font color="#CCCCCC">Google remotely and</font><font color="#E5E5E5"> installs your</font>

539
00:28:11,480 --> 00:28:16,909
<font color="#E5E5E5">extension from all connected devices so</font>

540
00:28:14,179 --> 00:28:25,159
<font color="#E5E5E5">you lose all the</font><font color="#CCCCCC"> bots that</font><font color="#E5E5E5"> you collected</font>

541
00:28:16,909 --> 00:28:27,529
so<font color="#CCCCCC"> how can we</font><font color="#E5E5E5"> make</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> easier the thing</font>

542
00:28:25,159 --> 00:28:29,740
is<font color="#E5E5E5"> that to get the abilities of</font><font color="#CCCCCC"> an</font>

543
00:28:27,529 --> 00:28:32,899
extension we don't necessarily<font color="#CCCCCC"> have to</font>

544
00:28:29,740 --> 00:28:36,970
<font color="#E5E5E5">create and distribute our own malicious</font>

545
00:28:32,899 --> 00:28:40,879
extension<font color="#E5E5E5"> if we just had an ability to</font>

546
00:28:36,970 --> 00:28:44,020
run<font color="#CCCCCC"> JavaScript</font><font color="#E5E5E5"> in the context of Chrome</font>

547
00:28:40,880 --> 00:28:46,610
extensions that will<font color="#E5E5E5"> be enough right</font>

548
00:28:44,020 --> 00:28:48,590
<font color="#CCCCCC">okay running</font>

549
00:28:46,610 --> 00:28:54,530
<font color="#E5E5E5">javascript in the context of web</font>

550
00:28:48,590 --> 00:28:55,520
application I know XSS so instead of

551
00:28:54,530 --> 00:28:58,370
<font color="#CCCCCC">explaining the difference between</font>

552
00:28:55,520 --> 00:29:00,500
<font color="#CCCCCC">exercising webpages and extensions let's</font>

553
00:28:58,370 --> 00:29:03,830
just have a look at some recent<font color="#E5E5E5"> examples</font>

554
00:29:00,500 --> 00:29:06,740
<font color="#CCCCCC">and the first</font><font color="#E5E5E5"> example I</font><font color="#CCCCCC"> want show here</font>

555
00:29:03,830 --> 00:29:10,580
is<font color="#E5E5E5"> the Adobe Acrobat extension exercise</font>

556
00:29:06,740 --> 00:29:12,799
now this extension<font color="#E5E5E5"> aims to allow</font><font color="#CCCCCC"> users</font>

557
00:29:10,580 --> 00:29:18,230
to turn to convert any<font color="#E5E5E5"> web page</font><font color="#CCCCCC"> into a</font>

558
00:29:12,799 --> 00:29:21,410
PDF<font color="#E5E5E5"> file and on January 16 while it had</font>

559
00:29:18,230 --> 00:29:25,400
30 million installations<font color="#E5E5E5"> by the way the</font>

560
00:29:21,410 --> 00:29:27,980
Adobe installed it automatically<font color="#E5E5E5"> without</font>

561
00:29:25,400 --> 00:29:31,400
users awareness on on all devices<font color="#E5E5E5"> that</font>

562
00:29:27,980 --> 00:29:33,919
had Ted Adobe Acrobat Reader on<font color="#E5E5E5"> it</font>

563
00:29:31,400 --> 00:29:37,549
<font color="#E5E5E5">that's why it got so many users 30</font>

564
00:29:33,919 --> 00:29:42,610
million users<font color="#E5E5E5"> just fought for</font>

565
00:29:37,549 --> 00:29:46,070
proportions and<font color="#E5E5E5"> the</font><font color="#CCCCCC"> mere ibotta tech</font>

566
00:29:42,610 --> 00:29:49,129
that was the largest<font color="#E5E5E5"> attack</font><font color="#CCCCCC"> the bullet</font>

567
00:29:46,070 --> 00:29:51,530
about<font color="#CCCCCC"> a tech</font><font color="#E5E5E5"> that was not was noticed is</font>

568
00:29:49,130 --> 00:29:56,059
estimated to<font color="#E5E5E5"> be tens of millions of</font>

569
00:29:51,530 --> 00:30:00,290
devices so it's the the same numbers

570
00:29:56,059 --> 00:30:03,320
more<font color="#E5E5E5"> or less and so on</font><font color="#CCCCCC"> general 16 well</font>

571
00:30:00,290 --> 00:30:06,280
it had 30 million installations and a

572
00:30:03,320 --> 00:30:11,689
researcher from<font color="#E5E5E5"> Google project zero</font>

573
00:30:06,280 --> 00:30:14,500
<font color="#CCCCCC">Tabby's Oh Mandi</font><font color="#E5E5E5"> and reported this</font>

574
00:30:11,690 --> 00:30:20,210
extension is vulnerable to dom-based xss

575
00:30:14,500 --> 00:30:22,010
<font color="#E5E5E5">now this is a services report I can I</font>

576
00:30:20,210 --> 00:30:26,210
know<font color="#CCCCCC"> that you</font><font color="#E5E5E5"> don't see a lot</font><font color="#CCCCCC"> of a lot</font>

577
00:30:22,010 --> 00:30:29,660
of<font color="#E5E5E5"> it but it included a POC code we can</font>

578
00:30:26,210 --> 00:30:34,340
<font color="#CCCCCC">see</font><font color="#E5E5E5"> that the directive or ability lies</font>

579
00:30:29,660 --> 00:30:37,640
in an extension<font color="#E5E5E5"> page called frame dot</font>

580
00:30:34,340 --> 00:30:40,699
HTML and our payload<font color="#E5E5E5"> is here inside a</font>

581
00:30:37,640 --> 00:30:45,919
parameter<font color="#E5E5E5"> called message and if we put</font>

582
00:30:40,700 --> 00:30:50,510
HTML<font color="#E5E5E5"> here at this the this runs on the X</font>

583
00:30:45,919 --> 00:30:54,919
extension page<font color="#E5E5E5"> now it's one</font><font color="#CCCCCC"> ability</font>

584
00:30:50,510 --> 00:30:56,179
almost<font color="#CCCCCC"> allowed</font><font color="#E5E5E5"> Universal XSS and but it</font>

585
00:30:54,919 --> 00:31:00,080
didn't<font color="#CCCCCC"> before</font>

586
00:30:56,179 --> 00:31:03,380
at least from<font color="#E5E5E5"> what I tried</font>

587
00:31:00,080 --> 00:31:06,110
why<font color="#E5E5E5"> so let's see where the vulnerability</font>

588
00:31:03,380 --> 00:31:08,450
is it's pretty straightforward<font color="#CCCCCC"> here's</font>

589
00:31:06,110 --> 00:31:11,360
how our our payload in a requested

590
00:31:08,450 --> 00:31:15,050
message it gets into STR status<font color="#E5E5E5"> and then</font>

591
00:31:11,360 --> 00:31:18,169
<font color="#E5E5E5">STR statuses get gets into the raw HTML</font>

592
00:31:15,050 --> 00:31:23,629
of<font color="#CCCCCC"> the title of this page</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> that's</font>

593
00:31:18,170 --> 00:31:27,140
really a common easy<font color="#E5E5E5"> truth trivial case</font>

594
00:31:23,630 --> 00:31:30,550
of XSS<font color="#E5E5E5"> it's so trivial that actually</font>

595
00:31:27,140 --> 00:31:33,830
<font color="#E5E5E5">Google CSP content security policy</font>

596
00:31:30,550 --> 00:31:35,000
<font color="#E5E5E5">blocks</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> JavaScript execution</font><font color="#CCCCCC"> in this</font>

597
00:31:33,830 --> 00:31:37,490
case now

598
00:31:35,000 --> 00:31:39,740
<font color="#E5E5E5">Tabitha</font><font color="#CCCCCC"> mandi in his Linds the report</font>

599
00:31:37,490 --> 00:31:42,320
mentioned that there's a way to to pivot

600
00:31:39,740 --> 00:31:44,600
<font color="#E5E5E5">that to confucian but I didn't invest</font>

601
00:31:42,320 --> 00:31:48,139
too much<font color="#CCCCCC"> effort on</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> I'll show you</font>

602
00:31:44,600 --> 00:31:49,969
other<font color="#CCCCCC"> examples the thing is that there's</font>

603
00:31:48,140 --> 00:31:52,040
nothing<font color="#E5E5E5"> new</font><font color="#CCCCCC"> here okay</font><font color="#E5E5E5"> what I'm showing</font>

604
00:31:49,970 --> 00:31:55,790
the exercise some extensions<font color="#E5E5E5"> it's</font>

605
00:31:52,040 --> 00:31:59,330
something<font color="#CCCCCC"> that mr.</font><font color="#E5E5E5"> Kotter with an oz oz</font>

606
00:31:55,790 --> 00:32:03,980
born<font color="#E5E5E5"> already shown here in black</font><font color="#CCCCCC"> hat</font><font color="#E5E5E5"> on</font>

607
00:31:59,330 --> 00:32:07,159
2012 so I wanted to say that that<font color="#E5E5E5"> that</font>

608
00:32:03,980 --> 00:32:10,760
<font color="#E5E5E5">might the topic here is not XSS on</font>

609
00:32:07,160 --> 00:32:16,670
extensions<font color="#CCCCCC"> it's how to create a botnet</font>

610
00:32:10,760 --> 00:32:19,220
abusing these extensions and one

611
00:32:16,670 --> 00:32:21,980
<font color="#E5E5E5">addition is that the is there is</font>

612
00:32:19,220 --> 00:32:24,380
something<font color="#CCCCCC"> that was changed since 2012</font>

613
00:32:21,980 --> 00:32:30,760
<font color="#E5E5E5">and this is</font><font color="#CCCCCC"> the content security policy</font>

614
00:32:24,380 --> 00:32:34,700
<font color="#E5E5E5">of Chrome extensions since 2014 Google</font>

615
00:32:30,760 --> 00:32:37,670
enforced<font color="#E5E5E5"> a default CSP context security</font>

616
00:32:34,700 --> 00:32:41,330
policy on<font color="#CCCCCC"> all the extensions this</font>

617
00:32:37,670 --> 00:32:46,580
prevents a lot<font color="#CCCCCC"> of trivial</font><font color="#E5E5E5"> common and</font>

618
00:32:41,330 --> 00:32:48,530
Java code injections including this case

619
00:32:46,580 --> 00:32:50,510
of Adobe it

620
00:32:48,530 --> 00:32:56,960
for example prevents inline scripts and

621
00:32:50,510 --> 00:32:58,400
<font color="#E5E5E5">it prevents eval functions and yeah so</font>

622
00:32:56,960 --> 00:33:01,580
it wouldn't comment<font color="#E5E5E5"> Java JavaScript</font>

623
00:32:58,400 --> 00:33:03,710
injections<font color="#CCCCCC"> that this was in my opinion a</font>

624
00:33:01,580 --> 00:33:06,500
very important move from Google side

625
00:33:03,710 --> 00:33:10,010
because before<font color="#CCCCCC"> that there were a lot of</font>

626
00:33:06,500 --> 00:33:13,190
cross-site scripting vulnerabilities in

627
00:33:10,010 --> 00:33:13,850
a lot of<font color="#E5E5E5"> extensions and this while it</font>

628
00:33:13,190 --> 00:33:16,250
made a

629
00:33:13,850 --> 00:33:18,709
a lot of<font color="#CCCCCC"> walk for extension developers</font>

630
00:33:16,250 --> 00:33:23,020
because<font color="#E5E5E5"> they have to take all the their</font>

631
00:33:18,710 --> 00:33:28,520
<font color="#E5E5E5">their buggy inline scripts into into the</font>

632
00:33:23,020 --> 00:33:31,460
extension<font color="#CCCCCC"> its</font><font color="#E5E5E5"> I</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> think it saved saved</font>

633
00:33:28,520 --> 00:33:35,809
us from an XSS extent extension exercise

634
00:33:31,460 --> 00:33:39,440
horror scenario<font color="#CCCCCC"> um and I wanted</font><font color="#E5E5E5"> to show</font>

635
00:33:35,809 --> 00:33:43,399
you<font color="#CCCCCC"> that because the thing is that this</font>

636
00:33:39,440 --> 00:33:46,070
<font color="#E5E5E5">P is not enough it's a generic policy</font>

637
00:33:43,400 --> 00:33:47,840
the default CSP and thinking that a

638
00:33:46,070 --> 00:33:51,678
generic policy will cover all<font color="#E5E5E5"> the cases</font>

639
00:33:47,840 --> 00:33:54,500
<font color="#E5E5E5">is is wrong and let's see an example</font>

640
00:33:51,679 --> 00:34:00,110
<font color="#E5E5E5">let's move to the next</font><font color="#CCCCCC"> example which is</font>

641
00:33:54,500 --> 00:34:04,220
<font color="#CCCCCC">the avg web tune-up extension this</font>

642
00:34:00,110 --> 00:34:08,199
extension aims to protect<font color="#E5E5E5"> users browser</font>

643
00:34:04,220 --> 00:34:11,149
and but on<font color="#CCCCCC"> December 2015</font>

644
00:34:08,199 --> 00:34:14,060
well it had 9<font color="#E5E5E5"> million installations the</font>

645
00:34:11,149 --> 00:34:17,569
same guys<font color="#E5E5E5"> the same guy at mr. Treviso</font>

646
00:34:14,060 --> 00:34:20,719
<font color="#CCCCCC">Mandi found this extension</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> be</font>

647
00:34:17,570 --> 00:34:25,940
vulnerable to to have several critical

648
00:34:20,719 --> 00:34:28,009
vulnerabilities including<font color="#E5E5E5"> XSS and in</font>

649
00:34:25,940 --> 00:34:32,659
this case CSP did not<font color="#CCCCCC"> walk and</font><font color="#E5E5E5"> I will</font>

650
00:34:28,010 --> 00:34:35,899
show how short we shall show why and

651
00:34:32,659 --> 00:34:38,300
this is Travis<font color="#CCCCCC"> and a report</font><font color="#E5E5E5"> the</font>

652
00:34:35,899 --> 00:34:41,509
<font color="#E5E5E5">hilarious</font><font color="#CCCCCC"> thing here is that</font><font color="#E5E5E5"> his his is</font>

653
00:34:38,300 --> 00:34:43,790
the signature disappointed Travis the

654
00:34:41,510 --> 00:34:47,060
obvious if<font color="#CCCCCC"> you're here you're my hero</font>

655
00:34:43,790 --> 00:34:51,379
I mean this is an<font color="#CCCCCC"> extension</font><font color="#E5E5E5"> that aims to</font>

656
00:34:47,060 --> 00:34:54,730
protect users<font color="#E5E5E5"> and it actually made all</font>

657
00:34:51,379 --> 00:35:02,480
day all<font color="#E5E5E5"> these browser</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> these users</font>

658
00:34:54,730 --> 00:35:05,000
<font color="#E5E5E5">hackable</font><font color="#CCCCCC"> in several ways so I'm gonna</font>

659
00:35:02,480 --> 00:35:07,790
<font color="#E5E5E5">I'm going to run a little demo of this</font>

660
00:35:05,000 --> 00:35:09,920
<font color="#E5E5E5">XSS that allowed it's it's</font><font color="#CCCCCC"> an it's a</font>

661
00:35:07,790 --> 00:35:13,640
universal exercise meaning that you can

662
00:35:09,920 --> 00:35:16,150
inject code a on on victims<font color="#E5E5E5"> that runs</font>

663
00:35:13,640 --> 00:35:20,650
this<font color="#CCCCCC"> extension</font><font color="#E5E5E5"> to any time to any domain</font>

664
00:35:16,150 --> 00:35:20,650
<font color="#E5E5E5">let's have a quick</font><font color="#CCCCCC"> look</font>

665
00:35:23,099 --> 00:35:30,869
so what we see here<font color="#CCCCCC"> is the exploitation</font>

666
00:35:25,920 --> 00:35:34,170
POC<font color="#E5E5E5"> a code it's it's a little it's it's</font>

667
00:35:30,869 --> 00:35:37,440
<font color="#E5E5E5">basically the the POC code by it by</font><font color="#CCCCCC"> mr.</font>

668
00:35:34,170 --> 00:35:38,369
<font color="#CCCCCC">Normandy with some</font><font color="#E5E5E5"> adjustments that</font><font color="#CCCCCC"> I</font>

669
00:35:37,440 --> 00:35:40,770
added

670
00:35:38,369 --> 00:35:43,760
actually it's let's look on<font color="#E5E5E5"> this farm</font>

671
00:35:40,770 --> 00:35:49,140
<font color="#E5E5E5">which is similar what we see here is</font>

672
00:35:43,760 --> 00:35:55,020
<font color="#E5E5E5">that there's a loop that sends a wind</font>

673
00:35:49,140 --> 00:35:59,310
<font color="#CCCCCC">that post window messages with</font><font color="#E5E5E5"> the</font>

674
00:35:55,020 --> 00:36:01,230
message now if you if you pay close

675
00:35:59,310 --> 00:36:04,560
closer attention you can see that the

676
00:36:01,230 --> 00:36:07,140
payment the message is sent to the

677
00:36:04,560 --> 00:36:09,089
window of of the attack page itself it

678
00:36:07,140 --> 00:36:11,549
is<font color="#E5E5E5"> that the attack page okay this is the</font>

679
00:36:09,089 --> 00:36:14,160
page<font color="#CCCCCC"> that I'm going to send victims</font><font color="#E5E5E5"> in</font>

680
00:36:11,550 --> 00:36:16,770
order<font color="#E5E5E5"> to attack them now</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> the attack</font>

681
00:36:14,160 --> 00:36:20,670
page sent a post message to the same

682
00:36:16,770 --> 00:36:22,680
window<font color="#E5E5E5"> it runs on okay so this is weird</font>

683
00:36:20,670 --> 00:36:26,220
because we are sending<font color="#E5E5E5"> a message short</font>

684
00:36:22,680 --> 00:36:30,509
<font color="#E5E5E5">to our own window the thing is that the</font>

685
00:36:26,220 --> 00:36:33,720
extension also<font color="#E5E5E5"> inject content script</font>

686
00:36:30,510 --> 00:36:36,150
into our attack page<font color="#E5E5E5"> because it</font><font color="#CCCCCC"> inject</font>

687
00:36:33,720 --> 00:36:41,580
<font color="#CCCCCC">it eject the script to any just any page</font>

688
00:36:36,150 --> 00:36:45,390
and for some reason it also<font color="#E5E5E5"> listens to</font>

689
00:36:41,580 --> 00:36:47,069
<font color="#CCCCCC">this messages</font><font color="#E5E5E5"> okay we see it in a second</font>

690
00:36:45,390 --> 00:36:49,830
in<font color="#E5E5E5"> the in the extension cord but what I</font>

691
00:36:47,070 --> 00:36:51,630
wanted to<font color="#CCCCCC"> show here</font><font color="#E5E5E5"> is that in this</font>

692
00:36:49,830 --> 00:36:54,869
inside<font color="#E5E5E5"> this</font><font color="#CCCCCC"> mesh missed message I</font>

693
00:36:51,630 --> 00:36:58,530
indicate an action that I call navigate

694
00:36:54,869 --> 00:37:01,830
and I give also<font color="#E5E5E5"> date data in the data I</font>

695
00:36:58,530 --> 00:37:06,690
give you<font color="#CCCCCC"> our L</font><font color="#E5E5E5"> the URL is a JavaScript</font>

696
00:37:01,830 --> 00:37:12,720
<font color="#CCCCCC">column URL that</font><font color="#E5E5E5"> runs this script on the</font>

697
00:37:06,690 --> 00:37:15,900
on the on the active tab now just for

698
00:37:12,720 --> 00:37:19,859
<font color="#CCCCCC">explain it</font><font color="#E5E5E5"> the navigate the navigate</font>

699
00:37:15,900 --> 00:37:23,490
action causes<font color="#E5E5E5"> the extension to to update</font>

700
00:37:19,859 --> 00:37:25,770
a tab<font color="#CCCCCC"> an</font><font color="#E5E5E5"> open tab with our URL to</font>

701
00:37:23,490 --> 00:37:28,830
navigate to<font color="#CCCCCC"> our URL and our</font><font color="#E5E5E5"> you already</font>

702
00:37:25,770 --> 00:37:32,160
the JavaScript code<font color="#CCCCCC"> you can see that</font>

703
00:37:28,830 --> 00:37:34,589
<font color="#CCCCCC">there is a for loop that you can</font><font color="#E5E5E5"> notice</font>

704
00:37:32,160 --> 00:37:36,509
that there<font color="#CCCCCC"> is a table ID</font><font color="#E5E5E5"> year here and</font>

705
00:37:34,589 --> 00:37:41,160
and I'm going<font color="#E5E5E5"> to</font>

706
00:37:36,510 --> 00:37:44,130
and<font color="#CCCCCC"> three thousand</font><font color="#E5E5E5"> a messages like this</font>

707
00:37:41,160 --> 00:37:46,350
with all the<font color="#CCCCCC"> cob IDs of</font><font color="#E5E5E5"> all I all my</font>

708
00:37:44,130 --> 00:37:49,800
<font color="#E5E5E5">tabs and in these tabs</font><font color="#CCCCCC"> I'm going to</font>

709
00:37:46,350 --> 00:37:51,750
check if it runs on black<font color="#E5E5E5"> a.com if it</font>

710
00:37:49,800 --> 00:37:54,510
runs on black a.com if it's a black<font color="#CCCCCC"> dot</font>

711
00:37:51,750 --> 00:37:58,410
<font color="#CCCCCC">com</font><font color="#E5E5E5"> tab I'm going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> inject the beef</font>

712
00:37:54,510 --> 00:38:03,270
framework<font color="#E5E5E5"> a code in order to gain</font>

713
00:37:58,410 --> 00:38:08,040
control<font color="#E5E5E5"> over this tab and just a quick</font>

714
00:38:03,270 --> 00:38:11,460
look at the<font color="#E5E5E5"> epicord</font><font color="#CCCCCC"> of the extension so</font>

715
00:38:08,040 --> 00:38:12,930
what we see here<font color="#CCCCCC"> is this is the</font>

716
00:38:11,460 --> 00:38:15,000
background<font color="#E5E5E5"> script on the of the X</font>

717
00:38:12,930 --> 00:38:18,180
<font color="#E5E5E5">extension you can see that there's a</font>

718
00:38:15,000 --> 00:38:21,630
function<font color="#CCCCCC"> called navigate and it takes</font>

719
00:38:18,180 --> 00:38:23,279
our message here here is our message<font color="#E5E5E5"> the</font>

720
00:38:21,630 --> 00:38:25,530
data of the message and run this

721
00:38:23,280 --> 00:38:29,850
function navigate and this<font color="#E5E5E5"> function in</font>

722
00:38:25,530 --> 00:38:34,920
turn you can<font color="#CCCCCC"> see it here uses qualm api</font>

723
00:38:29,850 --> 00:38:37,860
and<font color="#CCCCCC"> traps update in</font><font color="#E5E5E5"> order to update the</font>

724
00:38:34,920 --> 00:38:45,980
table ID that we chose to<font color="#CCCCCC"> the</font><font color="#E5E5E5"> URL that</font>

725
00:38:37,860 --> 00:38:48,510
we<font color="#E5E5E5"> chose here this is the URL so why</font>

726
00:38:45,980 --> 00:38:51,770
let's let's run it<font color="#E5E5E5"> and then you explain</font>

727
00:38:48,510 --> 00:38:58,590
why CSP is not effective here

728
00:38:51,770 --> 00:39:00,210
okay so I have a<font color="#CCCCCC"> Blackett page and I am</font>

729
00:38:58,590 --> 00:39:06,450
going to<font color="#E5E5E5"> refresh it to show you that</font>

730
00:39:00,210 --> 00:39:09,030
<font color="#E5E5E5">everything is normal and let's turn on</font>

731
00:39:06,450 --> 00:39:11,040
the<font color="#E5E5E5"> avg web tune-up the vulnerable</font>

732
00:39:09,030 --> 00:39:15,360
version of this<font color="#CCCCCC"> extension now is on and</font>

733
00:39:11,040 --> 00:39:18,360
I'm also going<font color="#CCCCCC"> to delete this this is</font>

734
00:39:15,360 --> 00:39:22,740
<font color="#CCCCCC">Biff I'm going to delete this is aam be</font>

735
00:39:18,360 --> 00:39:25,530
M<font color="#CCCCCC"> by the way this is</font><font color="#E5E5E5"> our attack page</font>

736
00:39:22,740 --> 00:39:28,229
<font color="#E5E5E5">okay that you just saw this is the code</font>

737
00:39:25,530 --> 00:39:30,720
that you<font color="#CCCCCC"> just saw and you can see that</font>

738
00:39:28,230 --> 00:39:33,240
after<font color="#E5E5E5"> injecting the beef and the beef</font>

739
00:39:30,720 --> 00:39:36,959
<font color="#CCCCCC">page of the beef script it also alerts</font>

740
00:39:33,240 --> 00:39:39,169
that<font color="#E5E5E5"> we have a hook so we've got the</font>

741
00:39:36,960 --> 00:39:42,060
blackheads<font color="#CCCCCC"> the blackheads</font><font color="#E5E5E5"> window here</font>

742
00:39:39,170 --> 00:39:45,030
<font color="#E5E5E5">you see there are no online browser and</font>

743
00:39:42,060 --> 00:39:51,620
beef<font color="#CCCCCC"> and now I'm going to</font><font color="#E5E5E5"> refresh this</font>

744
00:39:45,030 --> 00:39:51,620
page as you see we've got another

745
00:39:53,140 --> 00:40:00,129
I injected code to blackhat without any

746
00:39:56,740 --> 00:40:03,759
any vulnerability on<font color="#CCCCCC"> blackett</font><font color="#E5E5E5"> okay just</font>

747
00:40:00,130 --> 00:40:08,560
by abusing this extension<font color="#CCCCCC"> you can</font><font color="#E5E5E5"> also</font>

748
00:40:03,760 --> 00:40:10,930
see<font color="#E5E5E5"> that now the beef the beef double</font>

749
00:40:08,560 --> 00:40:13,240
<font color="#CCCCCC">javascript</font><font color="#E5E5E5"> is injected into the page</font><font color="#CCCCCC"> and</font>

750
00:40:10,930 --> 00:40:17,109
<font color="#E5E5E5">the best beef requests are starting to</font>

751
00:40:13,240 --> 00:40:21,700
<font color="#E5E5E5">run and we can see that in beef we have</font>

752
00:40:17,110 --> 00:40:27,240
a new a<font color="#CCCCCC"> new hook</font><font color="#E5E5E5"> browser in a hoop tab</font>

753
00:40:21,700 --> 00:40:33,189
<font color="#E5E5E5">and now the thing is that attackers can</font>

754
00:40:27,240 --> 00:40:36,359
can use these vulnerable extensions in

755
00:40:33,190 --> 00:40:40,660
order<font color="#E5E5E5"> to run scenario 1 campaigns</font><font color="#CCCCCC"> just</font>

756
00:40:36,360 --> 00:40:42,850
<font color="#CCCCCC">like the ones that</font><font color="#E5E5E5"> we saw earlier if I</font>

757
00:40:40,660 --> 00:40:45,100
get control<font color="#E5E5E5"> gain control over Gmail and</font>

758
00:40:42,850 --> 00:40:49,630
Facebook<font color="#CCCCCC"> which I will I will show in a</font>

759
00:40:45,100 --> 00:40:51,700
second<font color="#E5E5E5"> and I can send my</font><font color="#CCCCCC"> payload</font><font color="#E5E5E5"> my</font>

760
00:40:49,630 --> 00:40:55,720
attack page which is the<font color="#CCCCCC"> data credit we</font>

761
00:40:51,700 --> 00:40:57,580
saw two other victims<font color="#CCCCCC"> using</font><font color="#E5E5E5"> Facebook and</font>

762
00:40:55,720 --> 00:40:59,740
distribute my payload<font color="#E5E5E5"> effectively</font>

763
00:40:57,580 --> 00:41:03,069
through social networks in<font color="#E5E5E5"> order to</font>

764
00:40:59,740 --> 00:41:07,089
<font color="#E5E5E5">create by my botnet my chrome extensions</font>

765
00:41:03,070 --> 00:41:11,050
botnet<font color="#E5E5E5"> and not again just a quick</font>

766
00:41:07,090 --> 00:41:14,110
example<font color="#CCCCCC"> from beef</font><font color="#E5E5E5"> you can</font><font color="#CCCCCC"> do something</font>

767
00:41:11,050 --> 00:41:21,820
like<font color="#CCCCCC"> this a fake notification bar on the</font>

768
00:41:14,110 --> 00:41:26,700
page<font color="#E5E5E5"> and</font><font color="#CCCCCC"> just one second and what the</font>

769
00:41:21,820 --> 00:41:30,430
victim will see is<font color="#E5E5E5"> something</font><font color="#CCCCCC"> like that</font>

770
00:41:26,700 --> 00:41:33,640
additional plugins<font color="#E5E5E5"> required to display</font>

771
00:41:30,430 --> 00:41:36,700
this this page and<font color="#E5E5E5"> if you click</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> a JC</font>

772
00:41:33,640 --> 00:41:39,190
file is downloaded<font color="#E5E5E5"> and then this in this</font>

773
00:41:36,700 --> 00:41:41,200
<font color="#E5E5E5">example</font><font color="#CCCCCC"> it's a JC file that can act like</font>

774
00:41:39,190 --> 00:41:44,190
<font color="#CCCCCC">the</font><font color="#E5E5E5"> J's file that we saw in the tag me</font>

775
00:41:41,200 --> 00:41:44,189
if you can<font color="#E5E5E5"> attack</font>

776
00:41:45,090 --> 00:41:54,900
thank you and the last thing I want<font color="#E5E5E5"> to</font>

777
00:41:52,410 --> 00:41:57,450
show here<font color="#CCCCCC"> is how I inject code also to</font>

778
00:41:54,900 --> 00:42:00,600
Facebook and<font color="#E5E5E5"> Google</font><font color="#CCCCCC"> and in</font><font color="#E5E5E5"> this case</font>

779
00:41:57,450 --> 00:42:03,689
Google<font color="#E5E5E5"> Drive this is another file very</font>

780
00:42:00,600 --> 00:42:06,120
similar<font color="#E5E5E5"> what it does</font><font color="#CCCCCC"> it checks if I'm on</font>

781
00:42:03,690 --> 00:42:07,860
<font color="#CCCCCC">Facebook on Google and then just right</font>

782
00:42:06,120 --> 00:42:12,930
that we have<font color="#CCCCCC"> a success on the</font><font color="#E5E5E5"> domain</font>

783
00:42:07,860 --> 00:42:17,030
<font color="#E5E5E5">let's run it</font><font color="#CCCCCC"> and you can see that we've</font>

784
00:42:12,930 --> 00:42:17,029
got<font color="#E5E5E5"> XSS on Facebook and Google Drive</font>

785
00:42:17,870 --> 00:42:20,870
<font color="#CCCCCC">okay</font>

786
00:42:29,410 --> 00:42:38,799
getting back<font color="#E5E5E5"> to</font><font color="#CCCCCC"> the presentation</font><font color="#E5E5E5"> great</font>

787
00:42:33,000 --> 00:42:42,160
so why is CSP not blocking<font color="#E5E5E5"> this kind of</font>

788
00:42:38,800 --> 00:42:46,000
<font color="#E5E5E5">exercise the reason here is that there</font>

789
00:42:42,160 --> 00:42:48,310
<font color="#E5E5E5">is no generic JavaScript injection here</font>

790
00:42:46,000 --> 00:42:49,540
there's no inline script<font color="#E5E5E5"> there is no</font>

791
00:42:48,310 --> 00:42:52,540
eval<font color="#CCCCCC"> okay</font>

792
00:42:49,540 --> 00:42:55,630
all<font color="#E5E5E5"> we all all we do is sending a post</font>

793
00:42:52,540 --> 00:42:58,690
message to our<font color="#CCCCCC"> own</font><font color="#E5E5E5"> window and the</font>

794
00:42:55,630 --> 00:43:00,910
extension listens<font color="#E5E5E5"> in in the in the code</font>

795
00:42:58,690 --> 00:43:03,100
<font color="#CCCCCC">that it injects</font><font color="#E5E5E5"> to our window to</font><font color="#CCCCCC"> these</font>

796
00:43:00,910 --> 00:43:05,649
messages<font color="#CCCCCC"> and then pass it</font><font color="#E5E5E5"> to the</font>

797
00:43:03,100 --> 00:43:08,110
background<font color="#E5E5E5"> script of the extension now</font>

798
00:43:05,650 --> 00:43:11,770
the background<font color="#CCCCCC"> script</font><font color="#E5E5E5"> has the ability to</font>

799
00:43:08,110 --> 00:43:14,620
<font color="#E5E5E5">update tabs and adjust update that you</font>

800
00:43:11,770 --> 00:43:20,050
are URL of the tab<font color="#E5E5E5"> so I'm not I'm</font><font color="#CCCCCC"> not</font>

801
00:43:14,620 --> 00:43:22,359
even injecting<font color="#E5E5E5"> it's it's not the the</font>

802
00:43:20,050 --> 00:43:24,610
<font color="#CCCCCC">application that injects the code is</font><font color="#E5E5E5"> not</font>

803
00:43:22,360 --> 00:43:25,990
the page itself is the<font color="#CCCCCC"> background script</font>

804
00:43:24,610 --> 00:43:27,790
of the extension that he's able to

805
00:43:25,990 --> 00:43:36,040
<font color="#E5E5E5">control</font><font color="#CCCCCC"> the tabs because it has</font>

806
00:43:27,790 --> 00:43:39,400
permissions and one small example<font color="#E5E5E5"> I want</font>

807
00:43:36,040 --> 00:43:40,960
show a also show is JSON view how many

808
00:43:39,400 --> 00:43:44,260
in the room<font color="#CCCCCC"> have this extension</font>

809
00:43:40,960 --> 00:43:45,030
installed or had it in the past<font color="#CCCCCC"> okay</font>

810
00:43:44,260 --> 00:43:47,470
great

811
00:43:45,030 --> 00:43:50,560
there are a lot of<font color="#E5E5E5"> people with this</font>

812
00:43:47,470 --> 00:43:53,259
extension<font color="#E5E5E5"> and it was for a year</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> a</font>

813
00:43:50,560 --> 00:43:54,100
half since that it<font color="#E5E5E5"> was since February</font>

814
00:43:53,260 --> 00:43:56,950
2015

815
00:43:54,100 --> 00:44:03,120
<font color="#E5E5E5">till November 2016</font><font color="#CCCCCC"> it was vulnerable</font><font color="#E5E5E5"> to</font>

816
00:43:56,950 --> 00:44:03,120
XSS and no one<font color="#E5E5E5"> there were reports</font>

817
00:44:03,720 --> 00:44:11,290
<font color="#CCCCCC">bye-bye mr. Joe veneks on this XSS and</font>

818
00:44:07,690 --> 00:44:21,520
<font color="#CCCCCC">no one repaired it a quick quick</font><font color="#E5E5E5"> demo</font>

819
00:44:11,290 --> 00:44:26,560
<font color="#CCCCCC">second</font><font color="#E5E5E5"> demonstration is this so let's</font>

820
00:44:21,520 --> 00:44:29,470
let's open the enable the<font color="#E5E5E5"> JSON view</font>

821
00:44:26,560 --> 00:44:32,860
extension you can<font color="#CCCCCC"> see here</font><font color="#E5E5E5"> that there's</font>

822
00:44:29,470 --> 00:44:36,700
a page on wix.com<font color="#E5E5E5"> which has a category</font>

823
00:44:32,860 --> 00:44:39,960
that<font color="#CCCCCC"> I I put</font><font color="#E5E5E5"> input here and this is the</font>

824
00:44:36,700 --> 00:44:39,960
input you<font color="#CCCCCC"> can see</font>

825
00:44:40,850 --> 00:44:49,430
this is the input<font color="#E5E5E5"> and the thing here is</font>

826
00:44:46,190 --> 00:44:53,750
<font color="#E5E5E5">that a lot</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> websites including weeks</font>

827
00:44:49,430 --> 00:44:57,919
take input and make and generate a JSON

828
00:44:53,750 --> 00:45:00,740
file out<font color="#E5E5E5"> of it so this</font><font color="#CCCCCC"> is this</font><font color="#E5E5E5"> is the</font>

829
00:44:57,920 --> 00:45:03,260
JSON file that<font color="#CCCCCC"> it contains my input and</font>

830
00:45:00,740 --> 00:45:07,759
if I run<font color="#E5E5E5"> it I can see that I have an</font>

831
00:45:03,260 --> 00:45:10,640
exercise and this this example<font color="#CCCCCC"> is very</font>

832
00:45:07,760 --> 00:45:13,370
<font color="#CCCCCC">different from the from the other</font><font color="#E5E5E5"> from</font>

833
00:45:10,640 --> 00:45:20,629
<font color="#CCCCCC">the first</font><font color="#E5E5E5"> one that I</font><font color="#CCCCCC"> showed</font><font color="#E5E5E5"> you and CSP</font>

834
00:45:13,370 --> 00:45:28,100
does not<font color="#E5E5E5"> block it as well great</font>

835
00:45:20,630 --> 00:45:30,310
and one second<font color="#CCCCCC"> okay I think I'm finished</font>

836
00:45:28,100 --> 00:45:40,400
<font color="#E5E5E5">it's time for questions</font>

837
00:45:30,310 --> 00:45:40,400
[Applause]

