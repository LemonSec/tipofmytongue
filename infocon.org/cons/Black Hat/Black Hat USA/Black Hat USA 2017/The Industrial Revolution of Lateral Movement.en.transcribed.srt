1
00:00:00,000 --> 00:00:03,240
hello and welcome<font color="#E5E5E5"> to our talk the</font>

2
00:00:01,920 --> 00:00:05,370
<font color="#E5E5E5">Industrial Revolution of lateral</font>

3
00:00:03,240 --> 00:00:07,950
movement<font color="#E5E5E5"> my name is Tom</font><font color="#CCCCCC"> berry and my</font>

4
00:00:05,370 --> 00:00:10,050
co-speaker<font color="#CCCCCC"> Tom or the other the motel</font>

5
00:00:07,950 --> 00:00:12,389
attempt<font color="#CCCCCC"> tile for Microsoft advanced</font>

6
00:00:10,050 --> 00:00:15,049
threat analytics team<font color="#E5E5E5"> and what are we</font>

7
00:00:12,389 --> 00:00:17,580
going<font color="#E5E5E5"> to discuss today</font><font color="#CCCCCC"> so we'll start a</font>

8
00:00:15,049 --> 00:00:19,529
<font color="#CCCCCC">by giving some introduction to our</font>

9
00:00:17,580 --> 00:00:23,070
<font color="#CCCCCC">attackers model the financially</font>

10
00:00:19,529 --> 00:00:25,259
motivated<font color="#CCCCCC"> a hacker</font><font color="#E5E5E5"> and we'll see how</font>

11
00:00:23,070 --> 00:00:28,730
they constantly<font color="#E5E5E5"> try to improve their</font>

12
00:00:25,260 --> 00:00:32,040
<font color="#CCCCCC">business process through innovation then</font>

13
00:00:28,730 --> 00:00:35,850
Tom all will get very technical<font color="#E5E5E5"> on</font>

14
00:00:32,040 --> 00:00:39,390
specific improvements and of the

15
00:00:35,850 --> 00:00:41,219
business<font color="#E5E5E5"> process in the go fetch a tool</font>

16
00:00:39,390 --> 00:00:44,190
<font color="#E5E5E5">that automates the lateral movement</font>

17
00:00:41,219 --> 00:00:47,399
phase and<font color="#E5E5E5"> also including very cool demo</font>

18
00:00:44,190 --> 00:00:49,890
then we will discuss what are the

19
00:00:47,399 --> 00:00:52,129
<font color="#CCCCCC">implication of the</font><font color="#E5E5E5"> automation of lateral</font>

20
00:00:49,890 --> 00:00:55,350
movement<font color="#CCCCCC"> what it means for attackers</font>

21
00:00:52,129 --> 00:00:57,629
<font color="#E5E5E5">reduced cost and increased</font><font color="#CCCCCC"> velocity and</font>

22
00:00:55,350 --> 00:00:59,219
what are the implications<font color="#E5E5E5"> on defenders</font>

23
00:00:57,629 --> 00:01:02,039
what if defenders should do and how

24
00:00:59,219 --> 00:01:04,500
<font color="#E5E5E5">should they make lateral movement hard</font>

25
00:01:02,039 --> 00:01:07,170
again<font color="#CCCCCC"> and hopefully</font><font color="#E5E5E5"> we'll conclude</font><font color="#CCCCCC"> with</font>

26
00:01:04,500 --> 00:01:11,130
some<font color="#E5E5E5"> practical recommendations so just</font>

27
00:01:07,170 --> 00:01:13,710
<font color="#E5E5E5">something</font><font color="#CCCCCC"> to take</font><font color="#E5E5E5"> home with you</font><font color="#CCCCCC"> ok let's</font>

28
00:01:11,130 --> 00:01:16,170
<font color="#E5E5E5">start with</font><font color="#CCCCCC"> the beginnings</font><font color="#E5E5E5"> and hacking</font>

29
00:01:13,710 --> 00:01:17,939
has many faces different hackers have

30
00:01:16,170 --> 00:01:20,850
different motivations<font color="#CCCCCC"> some hack for</font>

31
00:01:17,939 --> 00:01:24,000
political causes<font color="#E5E5E5"> some wear uniforms and</font>

32
00:01:20,850 --> 00:01:26,610
hack for the country and some wear suit

33
00:01:24,000 --> 00:01:30,030
<font color="#CCCCCC">and tie and hack for their financial gal</font>

34
00:01:26,610 --> 00:01:32,250
for their bank account and the hacker<font color="#CCCCCC"> as</font>

35
00:01:30,030 --> 00:01:35,970
a CEO<font color="#E5E5E5"> because if financially motivated</font>

36
00:01:32,250 --> 00:01:39,530
he sees himself as a CEO<font color="#E5E5E5"> get inspiration</font>

37
00:01:35,970 --> 00:01:44,789
<font color="#E5E5E5">not</font><font color="#CCCCCC"> only from Sun Tzu but also from</font>

38
00:01:39,530 --> 00:01:46,799
business literature and in such business

39
00:01:44,790 --> 00:01:50,520
<font color="#E5E5E5">literature he may found</font><font color="#CCCCCC"> quotes like that</font>

40
00:01:46,799 --> 00:01:52,290
from<font color="#E5E5E5"> the current IBM CEO and she said</font>

41
00:01:50,520 --> 00:01:54,810
that for CEO today it's all about

42
00:01:52,290 --> 00:01:56,939
<font color="#E5E5E5">achieving growth and efficiency</font><font color="#CCCCCC"> through</font>

43
00:01:54,810 --> 00:01:59,060
innovation it's not<font color="#E5E5E5"> about product</font>

44
00:01:56,939 --> 00:02:01,770
innovation so much anymore<font color="#CCCCCC"> as about</font>

45
00:01:59,060 --> 00:02:04,409
innovating the business models<font color="#E5E5E5"> process</font>

46
00:02:01,770 --> 00:02:07,220
culture and management<font color="#CCCCCC"> so the hacker</font><font color="#E5E5E5"> is</font>

47
00:02:04,409 --> 00:02:09,780
a CEO<font color="#CCCCCC"> reads that and said okay I need to</font>

48
00:02:07,220 --> 00:02:11,670
<font color="#E5E5E5">optimize and innovate</font><font color="#CCCCCC"> in my business</font>

49
00:02:09,780 --> 00:02:14,190
process so what is the

50
00:02:11,670 --> 00:02:15,899
<font color="#E5E5E5">tackle the</font><font color="#CCCCCC"> attackers business process</font>

51
00:02:14,190 --> 00:02:18,450
<font color="#E5E5E5">what the process at all</font>

52
00:02:15,900 --> 00:02:21,360
so usually we<font color="#CCCCCC"> model the attacker process</font>

53
00:02:18,450 --> 00:02:23,819
using the<font color="#E5E5E5"> cyber kill chain model</font>

54
00:02:21,360 --> 00:02:25,440
suggested by Lockheed Martin<font color="#CCCCCC"> and we feel</font>

55
00:02:23,819 --> 00:02:28,470
for<font color="#CCCCCC"> that for financially motivated</font>

56
00:02:25,440 --> 00:02:30,540
<font color="#E5E5E5">attacker a more suitable term would be</font>

57
00:02:28,470 --> 00:02:32,630
<font color="#CCCCCC">the cyber value chain value chain is</font>

58
00:02:30,540 --> 00:02:35,069
determine economics<font color="#E5E5E5"> to describe the</font>

59
00:02:32,630 --> 00:02:37,709
process in<font color="#CCCCCC"> which raw</font><font color="#E5E5E5"> material are</font>

60
00:02:35,069 --> 00:02:40,440
processed<font color="#CCCCCC"> and become product and value</font>

61
00:02:37,709 --> 00:02:42,569
is added<font color="#E5E5E5"> along the way so in the cyber</font>

62
00:02:40,440 --> 00:02:45,660
case the raw materials are the target

63
00:02:42,569 --> 00:02:47,790
details they processed with the<font color="#E5E5E5"> attacker</font>

64
00:02:45,660 --> 00:02:50,700
so called<font color="#E5E5E5"> the assembly line and in the</font>

65
00:02:47,790 --> 00:02:54,690
<font color="#E5E5E5">end the product is the stolen data from</font>

66
00:02:50,700 --> 00:02:57,238
in the target so this is the attackers

67
00:02:54,690 --> 00:02:59,220
process now they want<font color="#E5E5E5"> to optimize it so</font>

68
00:02:57,239 --> 00:03:02,519
<font color="#CCCCCC">what they do</font><font color="#E5E5E5"> the first</font><font color="#CCCCCC"> thing</font><font color="#E5E5E5"> they do</font>

69
00:02:59,220 --> 00:03:05,760
<font color="#CCCCCC">they</font><font color="#E5E5E5"> break</font><font color="#CCCCCC"> the this big</font><font color="#E5E5E5"> monolithic</font><font color="#CCCCCC"> cyber</font>

70
00:03:02,519 --> 00:03:08,549
<font color="#E5E5E5">a kill chain</font><font color="#CCCCCC"> of value chain into</font>

71
00:03:05,760 --> 00:03:10,709
<font color="#E5E5E5">different separate value chain which</font>

72
00:03:08,549 --> 00:03:12,540
allows them<font color="#CCCCCC"> to get better</font><font color="#E5E5E5"> at each one</font>

73
00:03:10,709 --> 00:03:16,049
individually it's easier to optimize

74
00:03:12,540 --> 00:03:18,179
<font color="#E5E5E5">smaller problem so they create three</font>

75
00:03:16,049 --> 00:03:19,980
different value chain the<font color="#CCCCCC"> first one is</font>

76
00:03:18,180 --> 00:03:22,200
the<font color="#CCCCCC"> penetration value chain in which the</font>

77
00:03:19,980 --> 00:03:25,858
raw materials are just the target

78
00:03:22,200 --> 00:03:29,339
<font color="#E5E5E5">details and the product is a single</font>

79
00:03:25,859 --> 00:03:31,350
affected computer then the second<font color="#E5E5E5"> value</font>

80
00:03:29,340 --> 00:03:33,000
chain is the domination value chain<font color="#E5E5E5"> the</font>

81
00:03:31,350 --> 00:03:36,120
raw material is a single affected

82
00:03:33,000 --> 00:03:39,060
computer<font color="#CCCCCC"> it processed to be</font><font color="#E5E5E5"> full access</font>

83
00:03:36,120 --> 00:03:41,910
<font color="#E5E5E5">to the network and finally actions on</font>

84
00:03:39,060 --> 00:03:45,239
data in which the raw material is the

85
00:03:41,910 --> 00:03:48,660
full access<font color="#CCCCCC"> to network</font><font color="#E5E5E5"> and the product</font>

86
00:03:45,239 --> 00:03:51,030
is the stolen<font color="#CCCCCC"> data</font><font color="#E5E5E5"> and now that they</font>

87
00:03:48,660 --> 00:03:53,519
break<font color="#CCCCCC"> down this monolithic value chain</font>

88
00:03:51,030 --> 00:03:55,620
<font color="#E5E5E5">they are going</font><font color="#CCCCCC"> to attackers are</font>

89
00:03:53,519 --> 00:03:58,530
optimizing<font color="#E5E5E5"> each and every one of</font><font color="#CCCCCC"> these</font>

90
00:03:55,620 --> 00:04:00,900
smaller value chains<font color="#CCCCCC"> so the first one</font>

91
00:03:58,530 --> 00:04:03,299
the most<font color="#E5E5E5"> trivial to automate is the</font>

92
00:04:00,900 --> 00:04:05,160
<font color="#E5E5E5">penetration value chain it's already</font>

93
00:04:03,299 --> 00:04:08,430
happened we all<font color="#CCCCCC"> know that we</font><font color="#E5E5E5"> should</font>

94
00:04:05,160 --> 00:04:11,190
assume breached<font color="#CCCCCC"> and because it's</font><font color="#E5E5E5"> very</font>

95
00:04:08,430 --> 00:04:13,230
easy<font color="#E5E5E5"> to penetrate</font><font color="#CCCCCC"> to a single computer</font>

96
00:04:11,190 --> 00:04:15,150
within<font color="#E5E5E5"> the victim's organization for</font>

97
00:04:13,230 --> 00:04:19,200
<font color="#CCCCCC">example by using web application</font>

98
00:04:15,150 --> 00:04:22,830
vulnerability<font color="#CCCCCC"> an attacker takes the name</font>

99
00:04:19,200 --> 00:04:25,349
<font color="#E5E5E5">of the victim look up in Google the</font>

100
00:04:22,830 --> 00:04:28,320
array website scan it with<font color="#CCCCCC"> the web</font>

101
00:04:25,349 --> 00:04:30,930
vulnerability scanner<font color="#E5E5E5"> supposedly they</font>

102
00:04:28,320 --> 00:04:33,950
found<font color="#E5E5E5"> a sequel injection</font><font color="#CCCCCC"> a vulnerability</font>

103
00:04:30,930 --> 00:04:37,860
<font color="#CCCCCC">abused</font><font color="#E5E5E5"> with</font><font color="#CCCCCC"> secure map and</font><font color="#E5E5E5"> upload a</font>

104
00:04:33,950 --> 00:04:40,440
generic web show very<font color="#E5E5E5"> easy very easy to</font>

105
00:04:37,860 --> 00:04:45,000
automate<font color="#E5E5E5"> and because it's</font><font color="#CCCCCC"> very</font><font color="#E5E5E5"> easy</font>

106
00:04:40,440 --> 00:04:48,030
the attackers get more servers<font color="#E5E5E5"> infected</font>

107
00:04:45,000 --> 00:04:50,580
servers<font color="#E5E5E5"> then they K could use and this</font>

108
00:04:48,030 --> 00:04:53,190
<font color="#E5E5E5">which means a surplus and</font><font color="#CCCCCC"> that surplus</font>

109
00:04:50,580 --> 00:04:55,229
creates<font color="#E5E5E5"> marketplaces and we see</font>

110
00:04:53,190 --> 00:04:56,969
headlines like the one below<font color="#CCCCCC"> a black</font>

111
00:04:55,229 --> 00:05:01,289
market is selling<font color="#E5E5E5"> access to hack</font>

112
00:04:56,970 --> 00:05:03,900
government servers then attackers wanted

113
00:05:01,289 --> 00:05:06,180
to optimize<font color="#E5E5E5"> the final value chain and</font>

114
00:05:03,900 --> 00:05:08,219
the final value chain is all about

115
00:05:06,180 --> 00:05:11,039
taking full access<font color="#CCCCCC"> to the network</font><font color="#E5E5E5"> and</font>

116
00:05:08,220 --> 00:05:15,030
transform it to stolen data<font color="#E5E5E5"> and this is</font>

117
00:05:11,039 --> 00:05:16,800
really<font color="#CCCCCC"> a hard</font><font color="#E5E5E5"> problem and hard it it</font>

118
00:05:15,030 --> 00:05:19,349
<font color="#CCCCCC">interface with the attacker model</font>

119
00:05:16,800 --> 00:05:20,909
because<font color="#E5E5E5"> hard hard means costly for</font>

120
00:05:19,349 --> 00:05:22,530
financially motivated attacker<font color="#E5E5E5"> because</font>

121
00:05:20,909 --> 00:05:25,110
it's hard<font color="#E5E5E5"> to understand what's</font>

122
00:05:22,530 --> 00:05:27,119
<font color="#CCCCCC">interesting and it's hard</font><font color="#E5E5E5"> to find buyers</font>

123
00:05:25,110 --> 00:05:28,770
to this data so let's assume the

124
00:05:27,120 --> 00:05:31,050
attacker<font color="#E5E5E5"> attacks some pharmaceutical</font>

125
00:05:28,770 --> 00:05:33,150
company they need to be<font color="#CCCCCC"> chemists to</font>

126
00:05:31,050 --> 00:05:35,190
understand<font color="#E5E5E5"> all the formulas there and</font>

127
00:05:33,150 --> 00:05:36,840
once they stole the<font color="#CCCCCC"> secret formula</font><font color="#E5E5E5"> they</font>

128
00:05:35,190 --> 00:05:38,700
need to find<font color="#CCCCCC"> a</font><font color="#E5E5E5"> buyer that understand</font>

129
00:05:36,840 --> 00:05:41,400
<font color="#E5E5E5">that formula in</font><font color="#CCCCCC"> order to sell it</font><font color="#E5E5E5"> to it</font>

130
00:05:38,700 --> 00:05:44,880
so it's really hard<font color="#CCCCCC"> a</font><font color="#E5E5E5"> lengthy process</font>

131
00:05:41,400 --> 00:05:47,429
and which incurs additional<font color="#E5E5E5"> cost</font>

132
00:05:44,880 --> 00:05:49,440
<font color="#E5E5E5">so attacker innovate in the business</font>

133
00:05:47,430 --> 00:05:52,080
<font color="#E5E5E5">model of it and</font><font color="#CCCCCC"> introduce the ransomware</font>

134
00:05:49,440 --> 00:05:53,849
<font color="#E5E5E5">business model so in the runs form of</font>

135
00:05:52,080 --> 00:05:56,130
<font color="#E5E5E5">business model the attacker doesn't need</font>

136
00:05:53,849 --> 00:05:58,890
to find a buyer<font color="#CCCCCC"> because the victim is</font>

137
00:05:56,130 --> 00:06:01,229
<font color="#E5E5E5">the buyer very easy and the attacker</font>

138
00:05:58,890 --> 00:06:03,479
doesn't<font color="#E5E5E5"> need to</font><font color="#CCCCCC"> know which data</font><font color="#E5E5E5"> is</font>

139
00:06:01,229 --> 00:06:05,280
interesting<font color="#E5E5E5"> and which is not he leaves</font>

140
00:06:03,479 --> 00:06:09,180
it to<font color="#CCCCCC"> the</font><font color="#E5E5E5"> victim to find out</font><font color="#CCCCCC"> and decrypt</font>

141
00:06:05,280 --> 00:06:11,250
<font color="#CCCCCC">and whatever</font><font color="#E5E5E5"> they want so</font><font color="#CCCCCC"> the so this</font>

142
00:06:09,180 --> 00:06:15,270
innovation in the business<font color="#E5E5E5"> model made</font>

143
00:06:11,250 --> 00:06:20,400
this<font color="#E5E5E5"> value chain</font><font color="#CCCCCC"> fast ubiquitous and</font>

144
00:06:15,270 --> 00:06:23,549
automatic<font color="#E5E5E5"> so we have on on one side so</font>

145
00:06:20,400 --> 00:06:26,969
penetration<font color="#E5E5E5"> in the</font><font color="#CCCCCC"> one hand is very</font><font color="#E5E5E5"> easy</font>

146
00:06:23,550 --> 00:06:28,739
to<font color="#CCCCCC"> automate and to get</font><font color="#E5E5E5"> single</font>

147
00:06:26,969 --> 00:06:31,649
in fact the machine in the network and

148
00:06:28,739 --> 00:06:34,558
on the end when the attacker<font color="#CCCCCC"> gets full</font>

149
00:06:31,649 --> 00:06:37,709
access to<font color="#E5E5E5"> the network</font><font color="#CCCCCC"> they are able to</font>

150
00:06:34,559 --> 00:06:39,479
easily monetize it through ransomware

151
00:06:37,709 --> 00:06:43,259
so what happens in the middle in the

152
00:06:39,479 --> 00:06:45,419
<font color="#E5E5E5">domination value chain so let's take a</font>

153
00:06:43,259 --> 00:06:49,499
look<font color="#E5E5E5"> into the technical steps of the</font>

154
00:06:45,419 --> 00:06:51,448
lateral<font color="#CCCCCC"> movement</font><font color="#E5E5E5"> and the key to be</font>

155
00:06:49,499 --> 00:06:53,999
successful in performing from one

156
00:06:51,449 --> 00:06:56,009
computer<font color="#E5E5E5"> to the</font><font color="#CCCCCC"> whole</font><font color="#E5E5E5"> network is getting</font>

157
00:06:53,999 --> 00:06:59,099
to the domain admin<font color="#E5E5E5"> the most privileged</font>

158
00:06:56,009 --> 00:07:01,139
user in the end<font color="#E5E5E5"> so it's all about</font>

159
00:06:59,099 --> 00:07:04,279
<font color="#CCCCCC">getting to</font><font color="#E5E5E5"> that domain admin so</font>

160
00:07:01,139 --> 00:07:07,349
<font color="#CCCCCC">hijackers get to demand</font><font color="#E5E5E5"> me</font><font color="#CCCCCC"> in first date</font>

161
00:07:04,279 --> 00:07:09,689
from<font color="#E5E5E5"> that single arbitrary infected</font>

162
00:07:07,349 --> 00:07:11,938
machine they first need to<font color="#E5E5E5"> escalate the</font>

163
00:07:09,689 --> 00:07:14,689
privileges locally become admin which

164
00:07:11,939 --> 00:07:19,049
enables them to harvest credentials form

165
00:07:14,689 --> 00:07:21,419
this<font color="#E5E5E5"> machine memory then they need</font><font color="#CCCCCC"> to</font>

166
00:07:19,049 --> 00:07:24,628
guess where to<font color="#E5E5E5"> go next in order to</font>

167
00:07:21,419 --> 00:07:28,369
advance<font color="#CCCCCC"> in some way towards that</font><font color="#E5E5E5"> desired</font>

168
00:07:24,629 --> 00:07:31,319
domain admin credential and once they

169
00:07:28,369 --> 00:07:32,599
<font color="#CCCCCC">decided where to</font><font color="#E5E5E5"> go they actually go</font>

170
00:07:31,319 --> 00:07:36,360
there using remote code execution

171
00:07:32,599 --> 00:07:38,369
ability<font color="#E5E5E5"> and they do it</font><font color="#CCCCCC"> over and</font><font color="#E5E5E5"> over</font>

172
00:07:36,360 --> 00:07:40,259
<font color="#E5E5E5">again until they reach the desired</font>

173
00:07:38,369 --> 00:07:42,539
domain<font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> in credential and then they</font>

174
00:07:40,259 --> 00:07:46,379
are able<font color="#CCCCCC"> to take over</font><font color="#E5E5E5"> the whole</font><font color="#CCCCCC"> network</font>

175
00:07:42,539 --> 00:07:49,949
and<font color="#E5E5E5"> all</font><font color="#CCCCCC"> lay a credentials and for most</font>

176
00:07:46,379 --> 00:07:53,999
<font color="#E5E5E5">of these stages they're already a tool</font>

177
00:07:49,949 --> 00:07:55,709
doing that so it to<font color="#CCCCCC"> locally to escalate</font>

178
00:07:53,999 --> 00:07:58,529
your<font color="#E5E5E5"> privilege locally you can</font><font color="#CCCCCC"> use some</font>

179
00:07:55,709 --> 00:08:01,079
<font color="#CCCCCC">Metasploit modules to</font><font color="#E5E5E5"> harvest credential</font>

180
00:07:58,529 --> 00:08:03,299
probably use<font color="#CCCCCC"> mimicked cards for remote</font>

181
00:08:01,079 --> 00:08:05,999
code execution you may use the WMI

182
00:08:03,299 --> 00:08:08,609
interface and once you get domain admin

183
00:08:05,999 --> 00:08:10,409
to get all other kids<font color="#E5E5E5"> you probably would</font>

184
00:08:08,610 --> 00:08:11,369
use<font color="#E5E5E5"> some other mimic as models such as</font>

185
00:08:10,409 --> 00:08:14,579
the<font color="#E5E5E5"> DCC</font>

186
00:08:11,369 --> 00:08:18,419
so what's<font color="#E5E5E5"> left is only that win</font>

187
00:08:14,579 --> 00:08:21,749
reconnaissance<font color="#CCCCCC"> in</font><font color="#E5E5E5"> faith and because it's</font>

188
00:08:18,419 --> 00:08:24,299
hard we said the attacker need to guess

189
00:08:21,749 --> 00:08:26,459
where to<font color="#E5E5E5"> go and guess</font><font color="#CCCCCC"> and having a sixth</font>

190
00:08:24,299 --> 00:08:28,769
sense<font color="#E5E5E5"> it's not something that it is easy</font>

191
00:08:26,459 --> 00:08:31,409
to<font color="#CCCCCC"> automate</font><font color="#E5E5E5"> right it's something</font><font color="#CCCCCC"> that</font>

192
00:08:28,769 --> 00:08:33,839
yeah you<font color="#CCCCCC"> know maybe</font><font color="#E5E5E5"> a seasoned</font><font color="#CCCCCC"> dead</font>

193
00:08:31,409 --> 00:08:35,818
attacker<font color="#E5E5E5"> a veteran attacker who</font><font color="#CCCCCC"> know I</font>

194
00:08:33,839 --> 00:08:37,180
have a feeling<font color="#CCCCCC"> I should go towards there</font>

195
00:08:35,818 --> 00:08:39,429
because this<font color="#CCCCCC"> is an interest</font>

196
00:08:37,179 --> 00:08:41,890
name<font color="#CCCCCC"> of a machine</font><font color="#E5E5E5"> and I</font><font color="#CCCCCC"> think this is</font>

197
00:08:39,429 --> 00:08:46,839
the way to go<font color="#E5E5E5"> but you</font><font color="#CCCCCC"> cannot automate</font>

198
00:08:41,890 --> 00:08:49,240
guesses and this is really the<font color="#E5E5E5"> last the</font>

199
00:08:46,839 --> 00:08:52,480
last<font color="#CCCCCC"> obstacle of</font><font color="#E5E5E5"> the attacker before</font>

200
00:08:49,240 --> 00:08:54,760
fully owning the whole network<font color="#E5E5E5"> and</font>

201
00:08:52,480 --> 00:08:56,529
automating<font color="#E5E5E5"> their</font><font color="#CCCCCC"> arm</font><font color="#E5E5E5"> movement and as we</font>

202
00:08:54,760 --> 00:08:58,180
saw they all other chains already

203
00:08:56,529 --> 00:09:01,330
<font color="#E5E5E5">automated so the only thing between</font>

204
00:08:58,180 --> 00:09:04,449
<font color="#E5E5E5">attacker and a fully automated fully</font>

205
00:09:01,330 --> 00:09:07,140
owned a<font color="#E5E5E5"> network fully automatic to</font>

206
00:09:04,450 --> 00:09:11,110
ransomware to<font color="#E5E5E5"> get money is only that</font>

207
00:09:07,140 --> 00:09:13,240
admin reconnaissance<font color="#E5E5E5"> a part and this</font><font color="#CCCCCC"> is</font>

208
00:09:11,110 --> 00:09:15,850
<font color="#E5E5E5">the missing link to automation</font><font color="#CCCCCC"> and now I</font>

209
00:09:13,240 --> 00:09:23,440
<font color="#CCCCCC">will</font><font color="#E5E5E5"> show you how attackers get around</font>

210
00:09:15,850 --> 00:09:25,570
it<font color="#E5E5E5"> things</font><font color="#CCCCCC"> down so</font><font color="#E5E5E5"> the missing link in</font>

211
00:09:23,440 --> 00:09:27,990
<font color="#CCCCCC">the lot of</font><font color="#E5E5E5"> movement evolution is the</font>

212
00:09:25,570 --> 00:09:30,779
<font color="#E5E5E5">motivation of data gathering</font><font color="#CCCCCC"> and</font>

213
00:09:27,990 --> 00:09:32,920
extracting knowledge out of<font color="#E5E5E5"> it</font>

214
00:09:30,779 --> 00:09:36,570
<font color="#E5E5E5">bloodhound that was published last</font>

215
00:09:32,920 --> 00:09:40,270
<font color="#E5E5E5">summer</font><font color="#CCCCCC"> is a good example for</font><font color="#E5E5E5"> a tool that</font>

216
00:09:36,570 --> 00:09:43,870
automate the data collecting and<font color="#E5E5E5"> making</font>

217
00:09:40,270 --> 00:09:48,520
a graph<font color="#CCCCCC"> that helps</font><font color="#E5E5E5"> to find the</font><font color="#CCCCCC"> shortest</font>

218
00:09:43,870 --> 00:09:51,520
attack<font color="#E5E5E5"> path as Tom mentioned so how bla</font>

219
00:09:48,520 --> 00:09:55,029
<font color="#CCCCCC">Dona actually works assume we have the</font>

220
00:09:51,520 --> 00:09:58,240
<font color="#E5E5E5">compromised domain user Bob and the</font>

221
00:09:55,029 --> 00:09:59,770
attackers once you use this user in

222
00:09:58,240 --> 00:10:02,110
order to get<font color="#E5E5E5"> to the main admin but they</font>

223
00:09:59,770 --> 00:10:05,980
don't know<font color="#E5E5E5"> what's the way so we collect</font>

224
00:10:02,110 --> 00:10:08,230
data<font color="#E5E5E5"> on users computers and groups in</font>

225
00:10:05,980 --> 00:10:10,750
the domain which will be<font color="#E5E5E5"> presented as</font>

226
00:10:08,230 --> 00:10:12,640
the edge as the nodes<font color="#E5E5E5"> and more</font>

227
00:10:10,750 --> 00:10:15,160
importantly the relation between them

228
00:10:12,640 --> 00:10:17,920
<font color="#E5E5E5">for example</font><font color="#CCCCCC"> if a user is</font><font color="#E5E5E5"> a member</font><font color="#CCCCCC"> of a</font>

229
00:10:15,160 --> 00:10:21,719
group<font color="#E5E5E5"> or has admin rights on a server</font>

230
00:10:17,920 --> 00:10:24,969
<font color="#E5E5E5">and these will be presented as the edges</font>

231
00:10:21,720 --> 00:10:28,690
so in this example<font color="#E5E5E5"> Bob is a member of</font>

232
00:10:24,970 --> 00:10:31,150
the IT admin group<font color="#E5E5E5"> and this group has</font>

233
00:10:28,690 --> 00:10:34,930
admin rights on<font color="#E5E5E5"> server and server name</font>

234
00:10:31,150 --> 00:10:39,069
server one on that server mary has a

235
00:10:34,930 --> 00:10:42,880
logins<font color="#E5E5E5"> session</font><font color="#CCCCCC"> it means both</font><font color="#E5E5E5"> Bob can</font>

236
00:10:39,070 --> 00:10:46,209
<font color="#CCCCCC">login</font><font color="#E5E5E5"> to server one find the session of</font>

237
00:10:42,880 --> 00:10:48,610
<font color="#CCCCCC">Mary harvest her credentials and the</font>

238
00:10:46,209 --> 00:10:50,949
person I'd marry because Mary<font color="#E5E5E5"> is a</font>

239
00:10:48,610 --> 00:10:51,220
member<font color="#CCCCCC"> of the domain admin now Bob can</font>

240
00:10:50,950 --> 00:10:54,370
be

241
00:10:51,220 --> 00:10:57,460
a domain<font color="#CCCCCC"> a lien by himself thanks for</font>

242
00:10:54,370 --> 00:11:00,250
the Bloodhound Gang<font color="#CCCCCC"> 4 for the slide and</font>

243
00:10:57,460 --> 00:11:02,230
the research on that<font color="#E5E5E5"> and if you haven't</font>

244
00:11:00,250 --> 00:11:06,700
<font color="#E5E5E5">been to their talk yesterday be sure to</font>

245
00:11:02,230 --> 00:11:09,070
catch them in<font color="#E5E5E5"> in Def Con so at this</font>

246
00:11:06,700 --> 00:11:12,510
point we have automation<font color="#E5E5E5"> for each step</font>

247
00:11:09,070 --> 00:11:15,700
in a lot of<font color="#CCCCCC"> movement</font><font color="#E5E5E5"> and the value chain</font>

248
00:11:12,510 --> 00:11:17,800
<font color="#E5E5E5">and the old thing left is actually to</font>

249
00:11:15,700 --> 00:11:23,380
teach someone to<font color="#E5E5E5"> go and fetch the main</font>

250
00:11:17,800 --> 00:11:27,069
dominance<font color="#E5E5E5"> using these tools</font><font color="#CCCCCC"> so for that</font>

251
00:11:23,380 --> 00:11:29,590
we<font color="#CCCCCC"> have invoke go fetch</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> Orchestra</font>

252
00:11:27,070 --> 00:11:33,310
the lot of movement automation using

253
00:11:29,590 --> 00:11:39,930
<font color="#E5E5E5">mini cats</font><font color="#CCCCCC"> Bloodhound WMI</font><font color="#E5E5E5"> or PS eggs</font><font color="#CCCCCC"> egg</font>

254
00:11:33,310 --> 00:11:43,209
and what actually<font color="#E5E5E5"> invoke go fetch is</font>

255
00:11:39,930 --> 00:11:47,949
it's a<font color="#E5E5E5"> open</font><font color="#CCCCCC"> source coded but</font><font color="#E5E5E5"> power</font>

256
00:11:43,210 --> 00:11:51,670
<font color="#CCCCCC">shakotan</font><font color="#E5E5E5"> it gets the attack path like we</font>

257
00:11:47,950 --> 00:11:53,920
saw of<font color="#E5E5E5"> bloodhound</font><font color="#CCCCCC"> an additional payload</font>

258
00:11:51,670 --> 00:11:57,880
to run on each machine<font color="#CCCCCC"> and it returns</font>

259
00:11:53,920 --> 00:11:59,920
the credentials along the path for the

260
00:11:57,880 --> 00:12:02,439
remote code execution method it uses

261
00:11:59,920 --> 00:12:05,319
<font color="#E5E5E5">invoked PS eggs egg and to harvest the</font>

262
00:12:02,440 --> 00:12:07,870
credential<font color="#E5E5E5"> that uses invoke mimikatz</font><font color="#CCCCCC"> you</font>

263
00:12:05,320 --> 00:12:11,290
can configure your<font color="#E5E5E5"> own payload</font><font color="#CCCCCC"> like</font>

264
00:12:07,870 --> 00:12:14,470
<font color="#CCCCCC">Empire</font><font color="#E5E5E5"> agents as we are going to see in</font>

265
00:12:11,290 --> 00:12:19,530
a demo<font color="#CCCCCC"> or</font><font color="#E5E5E5"> just harvest the credentials</font>

266
00:12:14,470 --> 00:12:24,100
or configure additional or other

267
00:12:19,530 --> 00:12:26,530
executables so the first version<font color="#E5E5E5"> of go</font>

268
00:12:24,100 --> 00:12:30,160
fetch was presented just<font color="#E5E5E5"> after of the</font>

269
00:12:26,530 --> 00:12:32,319
first bloodhound this first the alpha

270
00:12:30,160 --> 00:12:35,530
version<font color="#CCCCCC"> of go fetch worked from one</font>

271
00:12:32,320 --> 00:12:39,820
computer<font color="#E5E5E5"> and attacked each machine in in</font>

272
00:12:35,530 --> 00:12:42,610
the<font color="#E5E5E5"> path from that computer</font><font color="#CCCCCC"> we also saw</font>

273
00:12:39,820 --> 00:12:45,130
this year<font color="#CCCCCC"> Bladon one three that extends</font>

274
00:12:42,610 --> 00:12:47,380
the<font color="#E5E5E5"> attack surface to active directory</font>

275
00:12:45,130 --> 00:12:51,060
<font color="#E5E5E5">object permissions but we won't get into</font>

276
00:12:47,380 --> 00:12:55,480
<font color="#CCCCCC">it today a great tool of Marcel</font>

277
00:12:51,060 --> 00:12:58,060
<font color="#CCCCCC">Deathstar</font><font color="#E5E5E5"> also is doing automation of</font>

278
00:12:55,480 --> 00:13:00,970
lateral movement and is not using the

279
00:12:58,060 --> 00:13:03,069
<font color="#CCCCCC">predetermined path of blood am but it's</font>

280
00:13:00,970 --> 00:13:05,339
doing the<font color="#E5E5E5"> recon and the expansion on the</font>

281
00:13:03,070 --> 00:13:05,339
<font color="#E5E5E5">fly</font>

282
00:13:05,890 --> 00:13:11,860
after death star we<font color="#E5E5E5"> published</font><font color="#CCCCCC"> invoke PSF</font>

283
00:13:08,810 --> 00:13:15,260
by invoking<font color="#E5E5E5"> go fetch as an open source</font>

284
00:13:11,860 --> 00:13:17,840
<font color="#E5E5E5">and this version</font><font color="#CCCCCC"> of go fetch replicates</font>

285
00:13:15,260 --> 00:13:21,590
itself according to<font color="#CCCCCC"> the</font><font color="#E5E5E5"> past and execute</font>

286
00:13:17,840 --> 00:13:23,960
both the payload and itself to go from

287
00:13:21,590 --> 00:13:25,960
one machine to<font color="#E5E5E5"> another lately we see</font>

288
00:13:23,960 --> 00:13:29,240
more<font color="#E5E5E5"> and</font><font color="#CCCCCC"> more integration between</font>

289
00:13:25,960 --> 00:13:33,590
<font color="#E5E5E5">bloodhound and other back-end servers</font>

290
00:13:29,240 --> 00:13:37,280
like<font color="#CCCCCC"> Empire in order to show the pwned</font>

291
00:13:33,590 --> 00:13:41,800
machines<font color="#E5E5E5"> on degree so</font><font color="#CCCCCC"> things from for</font>

292
00:13:37,280 --> 00:13:45,350
Tom Porter<font color="#E5E5E5"> working with me on that demo</font>

293
00:13:41,800 --> 00:13:48,199
so before the demo<font color="#CCCCCC"> let's understand the</font>

294
00:13:45,350 --> 00:13:51,100
<font color="#E5E5E5">setup of the of the environment we'll</font>

295
00:13:48,200 --> 00:13:55,310
start with user<font color="#E5E5E5"> 1 which already</font>

296
00:13:51,100 --> 00:13:58,190
compromised<font color="#E5E5E5"> and from there we'll we'll</font>

297
00:13:55,310 --> 00:14:00,859
use<font color="#E5E5E5"> golf bloodhound</font><font color="#CCCCCC"> in order to find</font>

298
00:13:58,190 --> 00:14:04,730
that<font color="#E5E5E5"> path</font><font color="#CCCCCC"> and we'll see that user one</font>

299
00:14:00,860 --> 00:14:07,790
has admin rights on on client<font color="#E5E5E5"> to and on</font>

300
00:14:04,730 --> 00:14:11,540
that machine<font color="#E5E5E5"> user</font><font color="#CCCCCC"> tools is logged in and</font>

301
00:14:07,790 --> 00:14:14,180
we<font color="#CCCCCC"> can use that user</font><font color="#E5E5E5"> to know in order to</font>

302
00:14:11,540 --> 00:14:17,780
get<font color="#CCCCCC"> to climb</font><font color="#E5E5E5"> to and so on and so on</font>

303
00:14:14,180 --> 00:14:25,130
<font color="#CCCCCC">until we</font><font color="#E5E5E5"> get to the DC and there we find</font>

304
00:14:17,780 --> 00:14:32,060
<font color="#E5E5E5">the administrator so for the demo we</font>

305
00:14:25,130 --> 00:14:40,939
<font color="#CCCCCC">have that</font><font color="#E5E5E5"> agent on client</font><font color="#CCCCCC"> 1</font><font color="#E5E5E5"> just to</font>

306
00:14:32,060 --> 00:14:42,650
verify<font color="#CCCCCC"> quick Who am I and</font><font color="#E5E5E5"> hostname so</font>

307
00:14:40,940 --> 00:14:45,580
once we have the username<font color="#E5E5E5"> and the</font>

308
00:14:42,650 --> 00:14:49,340
<font color="#CCCCCC">hostname</font><font color="#E5E5E5"> we can go to bloodhound and</font>

309
00:14:45,580 --> 00:14:52,390
look for that<font color="#E5E5E5"> for the path and we find</font>

310
00:14:49,340 --> 00:14:57,380
the<font color="#E5E5E5"> same path as we saw in the setup and</font>

311
00:14:52,390 --> 00:14:59,630
we can use<font color="#E5E5E5"> it</font><font color="#CCCCCC"> in order to to use go</font>

312
00:14:57,380 --> 00:15:04,970
fetch and we use the path<font color="#E5E5E5"> this</font><font color="#CCCCCC"> path is</font>

313
00:14:59,630 --> 00:15:09,710
an input<font color="#CCCCCC"> for golf</font><font color="#E5E5E5"> edge so now we launch</font>

314
00:15:04,970 --> 00:15:14,410
the model of<font color="#CCCCCC"> Empire</font><font color="#E5E5E5"> invoke mimicking go</font>

315
00:15:09,710 --> 00:15:16,760
fetch and execute it on<font color="#CCCCCC"> the first oil</font>

316
00:15:14,410 --> 00:15:20,360
<font color="#E5E5E5">machine client</font><font color="#CCCCCC"> 1</font>

317
00:15:16,760 --> 00:15:22,519
so this is go fetch on<font color="#E5E5E5"> client</font><font color="#CCCCCC"> 1 and from</font>

318
00:15:20,360 --> 00:15:27,500
there it tries<font color="#CCCCCC"> to connect the client to</font>

319
00:15:22,519 --> 00:15:31,160
and start the path so we<font color="#CCCCCC"> see</font><font color="#E5E5E5"> that it go</font>

320
00:15:27,500 --> 00:15:34,010
fetch already<font color="#E5E5E5"> ran on client 1</font><font color="#CCCCCC"> I'm</font>

321
00:15:31,160 --> 00:15:37,279
confined to in the Empire<font color="#E5E5E5"> we see the IP</font>

322
00:15:34,010 --> 00:15:41,899
of<font color="#E5E5E5"> the agent and in bloodhound GUI we</font>

323
00:15:37,279 --> 00:15:44,990
see the<font color="#E5E5E5"> pony machine now go fetch is on</font>

324
00:15:41,899 --> 00:15:49,370
client 3<font color="#E5E5E5"> already and in a minute it will</font>

325
00:15:44,990 --> 00:15:52,639
<font color="#E5E5E5">be on the DC there it will find the</font>

326
00:15:49,370 --> 00:15:59,600
administrator and<font color="#CCCCCC"> will do the way back</font>

327
00:15:52,639 --> 00:16:02,449
<font color="#E5E5E5">home so the DC is over also pwned for</font>

328
00:15:59,600 --> 00:16:04,899
now and go fetch is starting the way

329
00:16:02,449 --> 00:16:04,899
back home

330
00:16:13,980 --> 00:16:21,690
and with that we get<font color="#CCCCCC"> to</font><font color="#E5E5E5"> presents we have</font>

331
00:16:18,660 --> 00:16:24,480
the agents on each machine<font color="#E5E5E5"> as well as</font>

332
00:16:21,690 --> 00:16:29,220
the compromised<font color="#E5E5E5"> user we found on the</font>

333
00:16:24,480 --> 00:16:31,950
path<font color="#E5E5E5"> so what's so special with invoke go</font>

334
00:16:29,220 --> 00:16:35,820
fetch<font color="#CCCCCC"> because it's targeted expansion</font>

335
00:16:31,950 --> 00:16:38,520
and it knows the path<font color="#E5E5E5"> in advance</font><font color="#CCCCCC"> it</font>

336
00:16:35,820 --> 00:16:40,530
means it<font color="#CCCCCC"> doesn't catch</font><font color="#E5E5E5"> additional</font>

337
00:16:38,520 --> 00:16:42,210
machines<font color="#E5E5E5"> and in the network and because</font>

338
00:16:40,530 --> 00:16:43,980
of<font color="#CCCCCC"> that it stealthier and faster</font>

339
00:16:42,210 --> 00:16:46,950
it doesn't<font color="#E5E5E5"> need to</font><font color="#CCCCCC"> communicate with a</font>

340
00:16:43,980 --> 00:16:50,430
back-end<font color="#E5E5E5"> server in order to get the</font>

341
00:16:46,950 --> 00:16:52,830
commands<font color="#E5E5E5"> but it has the as it has the</font>

342
00:16:50,430 --> 00:16:56,310
<font color="#E5E5E5">knowledge in the edges</font><font color="#CCCCCC"> and it knows</font>

343
00:16:52,830 --> 00:16:58,770
where to<font color="#E5E5E5"> go next</font><font color="#CCCCCC"> and also</font><font color="#E5E5E5"> less</font>

344
00:16:56,310 --> 00:17:00,479
communication stealthier for future

345
00:16:58,770 --> 00:17:04,170
workers<font color="#E5E5E5"> will</font><font color="#CCCCCC"> be it will be great to</font><font color="#E5E5E5"> see</font>

346
00:17:00,480 --> 00:17:08,370
<font color="#CCCCCC">more code execution methods like Weiner</font>

347
00:17:04,170 --> 00:17:10,800
<font color="#CCCCCC">M or 80</font><font color="#E5E5E5"> exec more compromising methods</font>

348
00:17:08,369 --> 00:17:14,520
like impersonation<font color="#CCCCCC"> it would be great to</font>

349
00:17:10,800 --> 00:17:18,000
<font color="#CCCCCC">see</font><font color="#E5E5E5"> go fetch</font><font color="#CCCCCC"> works file s and support</font>

350
00:17:14,520 --> 00:17:19,949
ASL<font color="#E5E5E5"> with bloodhound</font><font color="#CCCCCC"> one three don't look</font>

351
00:17:18,000 --> 00:17:25,380
at me it's an<font color="#CCCCCC"> open source</font><font color="#E5E5E5"> so please</font>

352
00:17:19,949 --> 00:17:28,110
contribute<font color="#E5E5E5"> thank you so</font><font color="#CCCCCC"> cinq</font><font color="#E5E5E5"> Utah for</font>

353
00:17:25,380 --> 00:17:30,930
<font color="#E5E5E5">the great demo so what are the</font>

354
00:17:28,109 --> 00:17:33,810
implication of<font color="#E5E5E5"> that so we saw that</font><font color="#CCCCCC"> the</font>

355
00:17:30,930 --> 00:17:35,670
<font color="#CCCCCC">last obstacle for the attackers was that</font>

356
00:17:33,810 --> 00:17:38,940
admin reconnaissance and once it's

357
00:17:35,670 --> 00:17:41,450
removed with<font color="#E5E5E5"> Platt hound</font><font color="#CCCCCC"> it can a</font>

358
00:17:38,940 --> 00:17:44,670
lateral<font color="#E5E5E5"> movement</font><font color="#CCCCCC"> phase the domination</font>

359
00:17:41,450 --> 00:17:47,160
value chain can be<font color="#CCCCCC"> easily automated and</font>

360
00:17:44,670 --> 00:17:49,440
that means<font color="#E5E5E5"> creates Industrial Revolution</font>

361
00:17:47,160 --> 00:17:51,330
and<font color="#E5E5E5"> natural evolution brings mass</font>

362
00:17:49,440 --> 00:17:53,610
production<font color="#E5E5E5"> and what is the product</font><font color="#CCCCCC"> of</font>

363
00:17:51,330 --> 00:17:55,679
this mass production this<font color="#CCCCCC"> is the main</font>

364
00:17:53,610 --> 00:17:58,560
domination<font color="#CCCCCC"> its</font><font color="#E5E5E5"> food now it's fully</font>

365
00:17:55,680 --> 00:18:00,960
automated<font color="#E5E5E5"> no manual labor just use go</font>

366
00:17:58,560 --> 00:18:03,090
fetch or other tools and<font color="#E5E5E5"> what's the</font>

367
00:18:00,960 --> 00:18:04,950
implication for<font color="#CCCCCC"> the</font><font color="#E5E5E5"> attacker is cheaper</font>

368
00:18:03,090 --> 00:18:07,379
causes negligent just click a<font color="#E5E5E5"> button</font>

369
00:18:04,950 --> 00:18:09,690
<font color="#E5E5E5">it's faster domain dominance within</font>

370
00:18:07,380 --> 00:18:12,150
minutes<font color="#E5E5E5"> and as a result there are many</font>

371
00:18:09,690 --> 00:18:14,610
more<font color="#E5E5E5"> potential victims now because some</font>

372
00:18:12,150 --> 00:18:18,000
<font color="#E5E5E5">organization were pleasantly safe</font>

373
00:18:14,610 --> 00:18:20,790
because the data they had didn't justify

374
00:18:18,000 --> 00:18:23,910
any manual operation order to get it but

375
00:18:20,790 --> 00:18:25,830
when you<font color="#E5E5E5"> are when</font><font color="#CCCCCC"> the all</font><font color="#E5E5E5"> of this</font>

376
00:18:23,910 --> 00:18:27,250
operation<font color="#E5E5E5"> is fully automated</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> cost</font>

377
00:18:25,830 --> 00:18:30,550
<font color="#CCCCCC">nothing so it</font>

378
00:18:27,250 --> 00:18:33,160
lowers the bar<font color="#E5E5E5"> and many more targets</font>

379
00:18:30,550 --> 00:18:35,800
<font color="#E5E5E5">many more organization now become a</font>

380
00:18:33,160 --> 00:18:39,160
viable target<font color="#CCCCCC"> and as it happened with</font>

381
00:18:35,800 --> 00:18:42,790
<font color="#CCCCCC">the penetration</font><font color="#E5E5E5"> value chain there will</font>

382
00:18:39,160 --> 00:18:45,280
be many networks that can<font color="#E5E5E5"> be found and</font>

383
00:18:42,790 --> 00:18:46,870
fully owned and the surplus<font color="#E5E5E5"> will create</font>

384
00:18:45,280 --> 00:18:49,920
<font color="#E5E5E5">marketplace so instead of</font><font color="#CCCCCC"> seeing</font>

385
00:18:46,870 --> 00:18:52,810
headlines<font color="#E5E5E5"> like black market for selling</font>

386
00:18:49,920 --> 00:18:56,800
access<font color="#E5E5E5"> to hack government server</font><font color="#CCCCCC"> you'll</font>

387
00:18:52,810 --> 00:19:00,850
see access to full network is sold on

388
00:18:56,800 --> 00:19:03,790
black markets what your defenders do as

389
00:19:00,850 --> 00:19:06,879
always<font color="#E5E5E5"> with the stressful situation</font>

390
00:19:03,790 --> 00:19:10,060
there<font color="#CCCCCC"> are three possible reaction flight</font>

391
00:19:06,880 --> 00:19:12,580
fight or freeze so what<font color="#CCCCCC"> did</font><font color="#E5E5E5"> doesn't mean</font>

392
00:19:10,060 --> 00:19:15,159
to freeze<font color="#CCCCCC"> its</font><font color="#E5E5E5"> defender saying</font><font color="#CCCCCC"> oh</font><font color="#E5E5E5"> we just</font>

393
00:19:12,580 --> 00:19:17,530
<font color="#E5E5E5">continue to do what we always did we</font>

394
00:19:15,160 --> 00:19:19,570
<font color="#CCCCCC">will hunt manually have manual incident</font>

395
00:19:17,530 --> 00:19:22,960
response<font color="#E5E5E5"> and so on and so forth so I</font>

396
00:19:19,570 --> 00:19:26,260
think this classic<font color="#CCCCCC"> indiana jones</font><font color="#E5E5E5"> scene</font>

397
00:19:22,960 --> 00:19:30,990
<font color="#E5E5E5">really you know I see jiggles in the</font>

398
00:19:26,260 --> 00:19:33,940
crowd so all guys like<font color="#CCCCCC"> me remember that</font>

399
00:19:30,990 --> 00:19:36,310
so the lesson<font color="#E5E5E5"> is very obvious you</font><font color="#CCCCCC"> can be</font>

400
00:19:33,940 --> 00:19:38,920
<font color="#E5E5E5">master with the sword but when it comes</font>

401
00:19:36,310 --> 00:19:41,500
to fighting guns<font color="#CCCCCC"> it's irrelevant don't</font>

402
00:19:38,920 --> 00:19:43,950
bring a knife<font color="#E5E5E5"> to a gunfight</font><font color="#CCCCCC"> you cannot</font>

403
00:19:41,500 --> 00:19:46,870
fight automatic attacks with manual

404
00:19:43,950 --> 00:19:50,650
processes even<font color="#E5E5E5"> from the sheer</font><font color="#CCCCCC"> economic</font>

405
00:19:46,870 --> 00:19:52,929
<font color="#E5E5E5">perspective and so in another possible</font>

406
00:19:50,650 --> 00:19:54,970
reaction is<font color="#CCCCCC"> to flight say okay</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> thus</font>

407
00:19:52,930 --> 00:19:56,920
<font color="#CCCCCC">to lateral movement</font><font color="#E5E5E5"> but is</font><font color="#CCCCCC"> lost I can't</font>

408
00:19:54,970 --> 00:19:59,530
do anything<font color="#E5E5E5"> it's automated</font><font color="#CCCCCC"> let's</font>

409
00:19:56,920 --> 00:20:01,270
<font color="#E5E5E5">concentrate on defending the last part</font>

410
00:19:59,530 --> 00:20:03,790
<font color="#E5E5E5">of the attack the</font><font color="#CCCCCC"> action Sundara</font>

411
00:20:01,270 --> 00:20:05,860
and let's protect our data using

412
00:20:03,790 --> 00:20:07,990
encryption that<font color="#CCCCCC"> access monitoring</font>

413
00:20:05,860 --> 00:20:10,959
exfiltration protection<font color="#CCCCCC"> that allocate</font>

414
00:20:07,990 --> 00:20:13,630
provision prevention<font color="#CCCCCC"> is so on but we</font>

415
00:20:10,960 --> 00:20:16,450
have to remember<font color="#E5E5E5"> that there are some</font>

416
00:20:13,630 --> 00:20:18,130
attacks<font color="#E5E5E5"> on data available availability</font>

417
00:20:16,450 --> 00:20:20,260
<font color="#E5E5E5">cells right somewhere and wipers in</font>

418
00:20:18,130 --> 00:20:23,170
which the action<font color="#E5E5E5"> on data</font><font color="#CCCCCC"> faith</font><font color="#E5E5E5"> is really</font>

419
00:20:20,260 --> 00:20:25,210
<font color="#CCCCCC">trivial</font><font color="#E5E5E5"> it is</font><font color="#CCCCCC"> in very</font><font color="#E5E5E5"> fast so it's very</font>

420
00:20:23,170 --> 00:20:27,730
very hard<font color="#E5E5E5"> to concentrate on in this</font>

421
00:20:25,210 --> 00:20:31,900
<font color="#CCCCCC">phase so some investment is you</font><font color="#E5E5E5"> there</font>

422
00:20:27,730 --> 00:20:36,040
but<font color="#E5E5E5"> you cannot live on all your defenses</font>

423
00:20:31,900 --> 00:20:38,429
in that stage<font color="#E5E5E5"> so the only reaction left</font>

424
00:20:36,040 --> 00:20:40,499
is<font color="#E5E5E5"> unfortunately we have to fight a lot</font>

425
00:20:38,429 --> 00:20:42,960
<font color="#CCCCCC">movement automation so how can</font><font color="#E5E5E5"> we do</font>

426
00:20:40,499 --> 00:20:45,360
that since the attackers are financially

427
00:20:42,960 --> 00:20:49,200
motivated we have to hurt them<font color="#CCCCCC"> in their</font>

428
00:20:45,360 --> 00:20:51,360
pocket because<font color="#E5E5E5"> that's the</font><font color="#CCCCCC"> only</font><font color="#E5E5E5"> thing we</font>

429
00:20:49,200 --> 00:20:54,480
can do<font color="#CCCCCC"> to deter them</font><font color="#E5E5E5"> and we need to do</font>

430
00:20:51,360 --> 00:20:57,570
so by making<font color="#E5E5E5"> a lateral movement hard in</font>

431
00:20:54,480 --> 00:21:00,269
the sense make it expensive<font color="#CCCCCC"> again</font><font color="#E5E5E5"> and</font>

432
00:20:57,570 --> 00:21:02,428
how should<font color="#E5E5E5"> we do that as defenders we</font>

433
00:21:00,269 --> 00:21:03,899
should reduce our tax<font color="#E5E5E5"> surface make</font>

434
00:21:02,429 --> 00:21:05,759
reconnaissance the attack<font color="#CCCCCC"> graph</font>

435
00:21:03,899 --> 00:21:07,830
<font color="#E5E5E5">generation process employed by</font>

436
00:21:05,759 --> 00:21:10,590
bloodhound<font color="#CCCCCC"> hard again by hardening</font>

437
00:21:07,830 --> 00:21:13,408
<font color="#E5E5E5">information gathering API such</font><font color="#CCCCCC"> as by</font>

438
00:21:10,590 --> 00:21:15,029
<font color="#CCCCCC">using a publicly available</font><font color="#E5E5E5"> tools so</font><font color="#CCCCCC"> that</font>

439
00:21:13,409 --> 00:21:16,679
the one they created by<font color="#E5E5E5"> Microsoft</font><font color="#CCCCCC"> eighty</font>

440
00:21:15,029 --> 00:21:19,470
<font color="#CCCCCC">a researcher eat a Grady</font><font color="#E5E5E5"> you can</font>

441
00:21:16,679 --> 00:21:21,029
download them<font color="#E5E5E5"> make finding the path to</font>

442
00:21:19,470 --> 00:21:23,399
the main admin<font color="#CCCCCC"> Hartigan reduce the</font>

443
00:21:21,029 --> 00:21:26,399
number<font color="#CCCCCC"> of domain admins</font><font color="#E5E5E5"> less targets</font>

444
00:21:23,399 --> 00:21:28,979
<font color="#E5E5E5">means longer</font><font color="#CCCCCC"> process</font><font color="#E5E5E5"> reduce the crafts</font>

445
00:21:26,399 --> 00:21:32,340
<font color="#CCCCCC">connectivity degree to break</font><font color="#E5E5E5"> passage</font>

446
00:21:28,980 --> 00:21:34,169
<font color="#E5E5E5">remove edges</font><font color="#CCCCCC"> by applying</font><font color="#E5E5E5"> network</font>

447
00:21:32,340 --> 00:21:37,889
segmentation and multi-factor

448
00:21:34,169 --> 00:21:40,919
authentication<font color="#CCCCCC"> now the defender had</font>

449
00:21:37,889 --> 00:21:43,979
reduced their the attack surface and

450
00:21:40,919 --> 00:21:46,019
they need to detect automation and this

451
00:21:43,980 --> 00:21:48,240
can be<font color="#E5E5E5"> done by automatically monitoring</font>

452
00:21:46,019 --> 00:21:51,389
access<font color="#E5E5E5"> pattern arts pattern is who</font>

453
00:21:48,240 --> 00:21:53,340
connects to what and when<font color="#E5E5E5"> and detect the</font>

454
00:21:51,389 --> 00:21:55,709
abnormal<font color="#E5E5E5"> automatically detect the</font>

455
00:21:53,340 --> 00:21:58,080
<font color="#E5E5E5">abnormal rabbit path traversal</font><font color="#CCCCCC"> it's</font><font color="#E5E5E5"> very</font>

456
00:21:55,710 --> 00:22:01,259
different from what<font color="#E5E5E5"> normal users are</font>

457
00:21:58,080 --> 00:22:04,049
<font color="#E5E5E5">doing and also creating advanced some</font>

458
00:22:01,259 --> 00:22:09,090
deception<font color="#CCCCCC"> fake shortest path using honey</font>

459
00:22:04,049 --> 00:22:13,259
pots<font color="#E5E5E5"> fake servers and client and honey</font>

460
00:22:09,090 --> 00:22:16,199
token fake credentials<font color="#E5E5E5"> to deceive the</font>

461
00:22:13,259 --> 00:22:19,590
attacker<font color="#CCCCCC"> and once</font><font color="#E5E5E5"> the you detect</font>

462
00:22:16,200 --> 00:22:23,119
automation<font color="#E5E5E5"> using the this method you</font>

463
00:22:19,590 --> 00:22:26,899
<font color="#E5E5E5">should apply automation mitigation and</font>

464
00:22:23,119 --> 00:22:30,799
how do you mitigate this detector data

465
00:22:26,899 --> 00:22:34,590
<font color="#CCCCCC">you</font><font color="#E5E5E5"> should put traps and</font><font color="#CCCCCC"> bats add</font>

466
00:22:30,799 --> 00:22:37,950
dynamic<font color="#E5E5E5"> deception along the path</font>

467
00:22:34,590 --> 00:22:40,139
<font color="#E5E5E5">traversal and offering a shortcut for</font>

468
00:22:37,950 --> 00:22:42,419
the attacker<font color="#E5E5E5"> and</font><font color="#CCCCCC"> the attacker elude the</font>

469
00:22:40,139 --> 00:22:45,928
attacker to<font color="#CCCCCC"> take this bait and be</font>

470
00:22:42,419 --> 00:22:48,179
confined<font color="#E5E5E5"> in some a honeypot or use</font>

471
00:22:45,929 --> 00:22:50,429
adaptive authentication<font color="#CCCCCC"> just in time</font>

472
00:22:48,179 --> 00:22:51,710
stepped up the authentication along<font color="#E5E5E5"> the</font>

473
00:22:50,429 --> 00:22:53,720
<font color="#E5E5E5">rabbit past</font><font color="#CCCCCC"> it</font>

474
00:22:51,710 --> 00:22:56,059
<font color="#E5E5E5">versus so instead of making your user</font>

475
00:22:53,720 --> 00:22:57,919
input their second factor all<font color="#CCCCCC"> the time</font>

476
00:22:56,059 --> 00:23:00,830
<font color="#CCCCCC">do</font><font color="#E5E5E5"> it just in time when you suspect that</font>

477
00:22:57,919 --> 00:23:03,440
some automation<font color="#E5E5E5"> is going</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> so if it's</font>

478
00:23:00,830 --> 00:23:05,870
real the attacker is defeated<font color="#E5E5E5"> but if</font>

479
00:23:03,440 --> 00:23:09,559
it's a false alarm<font color="#E5E5E5"> then the user just</font>

480
00:23:05,870 --> 00:23:12,590
input their second factor and they can

481
00:23:09,559 --> 00:23:14,480
continue<font color="#E5E5E5"> so our last slide let's</font>

482
00:23:12,590 --> 00:23:16,340
conclude what we've seen today so

483
00:23:14,480 --> 00:23:18,860
<font color="#E5E5E5">attacker is some attackers are</font><font color="#CCCCCC"> financial</font>

484
00:23:16,340 --> 00:23:21,860
<font color="#E5E5E5">motivated before they strive for</font>

485
00:23:18,860 --> 00:23:23,330
efficiency<font color="#E5E5E5"> and one of the way they do it</font>

486
00:23:21,860 --> 00:23:25,219
is by automating the lateral movement

487
00:23:23,330 --> 00:23:28,220
<font color="#CCCCCC">with tools</font><font color="#E5E5E5"> such as go fetch</font>

488
00:23:25,220 --> 00:23:31,250
and as a result manual defense procedure

489
00:23:28,220 --> 00:23:33,830
will become<font color="#CCCCCC"> obsolete</font><font color="#E5E5E5"> and you need to</font>

490
00:23:31,250 --> 00:23:37,279
fight lateral movement industrialization

491
00:23:33,830 --> 00:23:39,559
by reducing attack surface detecting

492
00:23:37,279 --> 00:23:41,480
automation and mitigating it with

493
00:23:39,559 --> 00:23:45,230
deception multi-factor authentication

494
00:23:41,480 --> 00:23:47,659
<font color="#E5E5E5">and use the fact that a rather</font><font color="#CCCCCC"> movement</font>

495
00:23:45,230 --> 00:23:50,149
is so cheap for<font color="#E5E5E5"> attackers is also very</font>

496
00:23:47,659 --> 00:23:52,669
cheap<font color="#E5E5E5"> for defenders use go fetch all</font><font color="#CCCCCC"> the</font>

497
00:23:50,149 --> 00:23:54,289
time with your red team and blue<font color="#CCCCCC"> team</font><font color="#E5E5E5"> in</font>

498
00:23:52,669 --> 00:23:57,140
order<font color="#CCCCCC"> to</font><font color="#E5E5E5"> understand your</font><font color="#CCCCCC"> security</font>

499
00:23:54,289 --> 00:23:59,450
position and amend your defenses

500
00:23:57,140 --> 00:24:01,100
accordingly<font color="#E5E5E5"> so with that we conclude</font><font color="#CCCCCC"> do</font>

501
00:23:59,450 --> 00:24:02,870
we have time for questions<font color="#CCCCCC"> we don't have</font>

502
00:24:01,100 --> 00:24:05,629
time<font color="#E5E5E5"> to questions so you can come to us</font>

503
00:24:02,870 --> 00:24:07,219
after<font color="#E5E5E5"> the talk of finals in Twitter so</font>

504
00:24:05,630 --> 00:24:09,279
thank you very<font color="#CCCCCC"> much for coming here</font>

505
00:24:07,220 --> 00:24:09,279
[Applause]

