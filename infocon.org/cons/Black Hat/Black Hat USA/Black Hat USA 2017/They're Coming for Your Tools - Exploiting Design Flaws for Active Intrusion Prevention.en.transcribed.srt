1
00:00:00,030 --> 00:00:03,510
so<font color="#E5E5E5"> welcome to they're coming for your</font>

2
00:00:01,439 --> 00:00:05,580
<font color="#E5E5E5">tools exploiting design flaws for active</font>

3
00:00:03,510 --> 00:00:07,798
intrusion prevention<font color="#E5E5E5"> I am John Ventura</font>

4
00:00:05,580 --> 00:00:10,500
<font color="#E5E5E5">and I am part of opt-ins research</font>

5
00:00:07,799 --> 00:00:13,139
practice<font color="#CCCCCC"> I was</font><font color="#E5E5E5"> also a member of Isis</font>

6
00:00:10,500 --> 00:00:14,790
x-force back in the day and along the

7
00:00:13,139 --> 00:00:15,838
way I've done some malware research and

8
00:00:14,790 --> 00:00:18,150
I<font color="#CCCCCC"> think that's informed a certain</font>

9
00:00:15,839 --> 00:00:21,029
perspective<font color="#CCCCCC"> that you'll see on display</font>

10
00:00:18,150 --> 00:00:23,189
<font color="#E5E5E5">here so we are</font><font color="#CCCCCC"> targeting design flaws in</font>

11
00:00:21,029 --> 00:00:25,170
popular attack tools and<font color="#CCCCCC"> method</font><font color="#E5E5E5"> and</font>

12
00:00:23,189 --> 00:00:27,720
<font color="#CCCCCC">methodologies we're doing this as a</font>

13
00:00:25,170 --> 00:00:29,760
<font color="#E5E5E5">means of intrusion prevention sometimes</font>

14
00:00:27,720 --> 00:00:31,380
people break<font color="#CCCCCC"> into computers attackers</font>

15
00:00:29,760 --> 00:00:36,270
pen testers people I can't even<font color="#E5E5E5"> imagine</font>

16
00:00:31,380 --> 00:00:37,890
<font color="#E5E5E5">and this set of</font><font color="#CCCCCC"> people</font><font color="#E5E5E5"> they face common</font>

17
00:00:36,270 --> 00:00:39,989
problems and<font color="#CCCCCC"> sometimes people solve</font>

18
00:00:37,890 --> 00:00:41,579
those problems by<font color="#CCCCCC"> creating software and</font>

19
00:00:39,989 --> 00:00:44,459
when they do that<font color="#CCCCCC"> well when those</font>

20
00:00:41,579 --> 00:00:46,950
solutions are effective those software

21
00:00:44,460 --> 00:00:48,539
<font color="#CCCCCC">packages often become popular</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> just</font>

22
00:00:46,950 --> 00:00:49,829
like any other software<font color="#CCCCCC"> out there those</font>

23
00:00:48,539 --> 00:00:52,199
software<font color="#CCCCCC"> packages exhibit</font>

24
00:00:49,829 --> 00:00:53,550
vulnerabilities<font color="#CCCCCC"> and</font><font color="#E5E5E5"> it's the</font>

25
00:00:52,199 --> 00:00:57,300
exploitation of those<font color="#E5E5E5"> vulnerabilities</font>

26
00:00:53,550 --> 00:00:59,849
<font color="#E5E5E5">which is a path towards improved</font>

27
00:00:57,300 --> 00:01:02,489
intrusion prevention<font color="#E5E5E5"> and you can do this</font>

28
00:00:59,850 --> 00:01:04,769
with little<font color="#E5E5E5"> cost so this is a talk for</font>

29
00:01:02,489 --> 00:01:06,210
both blue<font color="#CCCCCC"> teens</font><font color="#E5E5E5"> and red</font><font color="#CCCCCC"> team's</font><font color="#E5E5E5"> so if</font>

30
00:01:04,769 --> 00:01:07,860
you're part of a blue team and it's your

31
00:01:06,210 --> 00:01:10,408
job<font color="#CCCCCC"> to defend networks to defend</font>

32
00:01:07,860 --> 00:01:11,850
computers<font color="#E5E5E5"> I'm talking to you you</font><font color="#CCCCCC"> need</font><font color="#E5E5E5"> to</font>

33
00:01:10,409 --> 00:01:13,140
<font color="#E5E5E5">know that</font><font color="#CCCCCC"> you can exploit these design</font>

34
00:01:11,850 --> 00:01:15,298
flaws as a means of intrusion prevention

35
00:01:13,140 --> 00:01:17,640
<font color="#CCCCCC">you can turn the tables on</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> bad guys</font>

36
00:01:15,299 --> 00:01:19,350
<font color="#CCCCCC">you can exploit vulnerabilities in their</font>

37
00:01:17,640 --> 00:01:20,759
<font color="#E5E5E5">software for a change you</font><font color="#CCCCCC"> can do</font>

38
00:01:19,350 --> 00:01:23,009
proactive responses and<font color="#E5E5E5"> we'll show you</font>

39
00:01:20,759 --> 00:01:25,049
<font color="#CCCCCC">how</font><font color="#E5E5E5"> to do that here</font><font color="#CCCCCC"> if you're a red</font>

40
00:01:23,009 --> 00:01:27,299
teamer like these guys<font color="#E5E5E5"> and</font><font color="#CCCCCC"> you break</font>

41
00:01:25,049 --> 00:01:29,159
into<font color="#CCCCCC"> computers for whatever reason you</font>

42
00:01:27,299 --> 00:01:30,420
have<font color="#CCCCCC"> to</font><font color="#E5E5E5"> know that just like any other</font>

43
00:01:29,159 --> 00:01:32,310
piece<font color="#CCCCCC"> of software that</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> introduce</font>

44
00:01:30,420 --> 00:01:33,780
into a<font color="#CCCCCC"> network</font><font color="#E5E5E5"> environment</font><font color="#CCCCCC"> your tools</font>

45
00:01:32,310 --> 00:01:36,060
bring with them a<font color="#E5E5E5"> certain set of</font>

46
00:01:33,780 --> 00:01:39,930
vulnerabilities<font color="#CCCCCC"> you cannot treat your</font>

47
00:01:36,060 --> 00:01:41,130
tools as a magic black box<font color="#CCCCCC"> you really</font>

48
00:01:39,930 --> 00:01:43,020
need<font color="#E5E5E5"> to be careful</font><font color="#CCCCCC"> with how you do these</font>

49
00:01:41,130 --> 00:01:44,789
things<font color="#E5E5E5"> especially if you're a pen tester</font>

50
00:01:43,020 --> 00:01:46,560
if you are not<font color="#E5E5E5"> careful</font><font color="#CCCCCC"> you could</font>

51
00:01:44,790 --> 00:01:49,829
potentially<font color="#E5E5E5"> get your clients compromised</font>

52
00:01:46,560 --> 00:01:51,570
due to<font color="#CCCCCC"> euro actions this is a some</font>

53
00:01:49,829 --> 00:01:54,149
pretty serious<font color="#CCCCCC"> stuff and</font><font color="#E5E5E5"> on the other</font>

54
00:01:51,570 --> 00:01:56,309
<font color="#E5E5E5">side</font><font color="#CCCCCC"> of that coin</font><font color="#E5E5E5"> if if you're so</font>

55
00:01:54,149 --> 00:01:58,229
<font color="#E5E5E5">inclined you can target other attackers</font>

56
00:01:56,310 --> 00:02:01,049
you can steal<font color="#E5E5E5"> their shells make them do</font>

57
00:01:58,229 --> 00:02:04,079
do<font color="#E5E5E5"> your hacking for you and I think</font>

58
00:02:01,049 --> 00:02:04,969
there's some walls there so we're<font color="#CCCCCC"> gonna</font>

59
00:02:04,079 --> 00:02:07,500
<font color="#CCCCCC">be</font><font color="#E5E5E5"> talking about two different</font>

60
00:02:04,969 --> 00:02:08,628
<font color="#CCCCCC">strategies for this today</font><font color="#E5E5E5"> the first of</font>

61
00:02:07,500 --> 00:02:10,739
which<font color="#CCCCCC"> is going</font><font color="#E5E5E5"> to be man-in-the-middle</font>

62
00:02:08,628 --> 00:02:12,250
counter-attacks against<font color="#E5E5E5"> insecure command</font>

63
00:02:10,739 --> 00:02:13,810
and control channels

64
00:02:12,250 --> 00:02:16,030
specifically we'll be touching on

65
00:02:13,810 --> 00:02:18,100
meterpreter and<font color="#E5E5E5"> partial</font><font color="#CCCCCC"> Empire and we'll</font>

66
00:02:16,030 --> 00:02:20,050
talk about<font color="#E5E5E5"> a few others</font><font color="#CCCCCC"> and after</font><font color="#E5E5E5"> that</font>

67
00:02:18,100 --> 00:02:22,510
we will discuss<font color="#E5E5E5"> some countermeasures</font>

68
00:02:20,050 --> 00:02:24,670
<font color="#E5E5E5">against brute force</font><font color="#CCCCCC"> password recovery</font><font color="#E5E5E5"> so</font>

69
00:02:22,510 --> 00:02:26,590
if you are<font color="#CCCCCC"> using in DNS</font><font color="#E5E5E5"> or LM in our</font>

70
00:02:24,670 --> 00:02:28,420
spoofing<font color="#CCCCCC"> to steal people's</font><font color="#E5E5E5"> hashes we're</font>

71
00:02:26,590 --> 00:02:29,590
gonna make that harder and if you are

72
00:02:28,420 --> 00:02:31,989
trying to<font color="#E5E5E5"> steal somebody's pre shared</font>

73
00:02:29,590 --> 00:02:35,709
key on a wireless<font color="#CCCCCC"> network we're gonna</font>

74
00:02:31,990 --> 00:02:37,930
<font color="#E5E5E5">make that harder</font><font color="#CCCCCC"> to so this</font><font color="#E5E5E5"> isn't just</font>

75
00:02:35,709 --> 00:02:39,550
<font color="#E5E5E5">theory</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> are releasing proof of concept</font>

76
00:02:37,930 --> 00:02:41,610
tools to demonstrate these techniques

77
00:02:39,550 --> 00:02:44,080
you<font color="#E5E5E5"> can download them use them at home</font>

78
00:02:41,610 --> 00:02:45,970
<font color="#CCCCCC">we wrote these in</font><font color="#E5E5E5"> C we wrote these to be</font>

79
00:02:44,080 --> 00:02:48,280
<font color="#E5E5E5">really compact and</font><font color="#CCCCCC"> small and if you ran</font>

80
00:02:45,970 --> 00:02:49,989
them all together at once<font color="#E5E5E5"> even the ones</font>

81
00:02:48,280 --> 00:02:53,620
<font color="#E5E5E5">that we aren't showing here they would</font>

82
00:02:49,989 --> 00:02:54,820
take up less<font color="#CCCCCC"> than 200 K of memory so if</font>

83
00:02:53,620 --> 00:02:57,040
for<font color="#E5E5E5"> some reason you're still</font><font color="#CCCCCC"> using a</font>

84
00:02:54,820 --> 00:02:59,440
Commodore 64<font color="#CCCCCC"> it might be time to</font><font color="#E5E5E5"> upgrade</font>

85
00:02:57,040 --> 00:03:00,609
or consider maybe running them one at a

86
00:02:59,440 --> 00:03:02,560
<font color="#E5E5E5">time</font>

87
00:03:00,610 --> 00:03:05,620
that was upgrades<font color="#E5E5E5"> they don't</font><font color="#CCCCCC"> necessarily</font>

88
00:03:02,560 --> 00:03:07,060
<font color="#CCCCCC">have to</font><font color="#E5E5E5"> be expensive</font><font color="#CCCCCC"> the whole point</font>

89
00:03:05,620 --> 00:03:09,670
there being you can use so<font color="#CCCCCC"> called</font>

90
00:03:07,060 --> 00:03:11,080
next-gen security solutions<font color="#E5E5E5"> you can do</font>

91
00:03:09,670 --> 00:03:12,730
that on the cheap it<font color="#CCCCCC"> doesn't necessarily</font>

92
00:03:11,080 --> 00:03:15,040
have<font color="#CCCCCC"> to come in a multi-thousand</font><font color="#E5E5E5"> dollar</font>

93
00:03:12,730 --> 00:03:16,869
a magic box

94
00:03:15,040 --> 00:03:18,160
you can do this cheaply but don't don't

95
00:03:16,870 --> 00:03:20,730
tell the guys in<font color="#CCCCCC"> the vendor</font><font color="#E5E5E5"> hall I just</font>

96
00:03:18,160 --> 00:03:22,810
said that because because they're great

97
00:03:20,730 --> 00:03:25,390
so let's talk about<font color="#E5E5E5"> those command and</font>

98
00:03:22,810 --> 00:03:26,950
<font color="#E5E5E5">control channels if you want</font><font color="#CCCCCC"> two</font>

99
00:03:25,390 --> 00:03:28,839
computers to<font color="#E5E5E5"> talk to</font><font color="#CCCCCC"> each other</font><font color="#E5E5E5"> in a</font>

100
00:03:26,950 --> 00:03:30,910
secure way<font color="#CCCCCC"> and they've never talked</font><font color="#E5E5E5"> to</font>

101
00:03:28,840 --> 00:03:32,739
<font color="#E5E5E5">each other before</font><font color="#CCCCCC"> this is a surprisingly</font>

102
00:03:30,910 --> 00:03:34,450
difficult<font color="#E5E5E5"> challenge and if you want to</font>

103
00:03:32,739 --> 00:03:38,049
get an<font color="#E5E5E5"> idea of what I mean consider</font>

104
00:03:34,450 --> 00:03:40,030
tls/ssl<font color="#CCCCCC"> or open ssl in particular some</font>

105
00:03:38,049 --> 00:03:41,950
<font color="#E5E5E5">really smart people</font><font color="#CCCCCC"> have been working</font><font color="#E5E5E5"> on</font>

106
00:03:40,030 --> 00:03:45,700
that<font color="#CCCCCC"> I'm working</font><font color="#E5E5E5"> on those efforts now</font>

107
00:03:41,950 --> 00:03:47,320
<font color="#E5E5E5">for decades and occasionally significant</font>

108
00:03:45,700 --> 00:03:49,959
vulnerabilities still show<font color="#CCCCCC"> up and a lot</font>

109
00:03:47,320 --> 00:03:52,090
of<font color="#E5E5E5"> them even have catchy names so if you</font>

110
00:03:49,959 --> 00:03:53,860
consider you know<font color="#E5E5E5"> the the scope and</font>

111
00:03:52,090 --> 00:03:55,720
breadth of that community<font color="#E5E5E5"> and all the</font>

112
00:03:53,860 --> 00:03:57,070
effort<font color="#E5E5E5"> that's gone in into that that is</font>

113
00:03:55,720 --> 00:03:59,109
a tremendous head start on any

114
00:03:57,070 --> 00:04:01,269
communication channel you<font color="#E5E5E5"> are likely to</font>

115
00:03:59,110 --> 00:04:03,970
develop<font color="#CCCCCC"> yourself so if you still want to</font>

116
00:04:01,269 --> 00:04:05,590
<font color="#E5E5E5">take that on</font><font color="#CCCCCC"> best</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> luck to you</font><font color="#E5E5E5"> but in</font>

117
00:04:03,970 --> 00:04:07,120
the real world<font color="#CCCCCC"> there are almost always</font>

118
00:04:05,590 --> 00:04:09,340
<font color="#E5E5E5">men in the middle</font><font color="#CCCCCC"> attacks</font><font color="#E5E5E5"> and let's talk</font>

119
00:04:07,120 --> 00:04:11,470
<font color="#E5E5E5">about some of those right</font><font color="#CCCCCC"> now the first</font>

120
00:04:09,340 --> 00:04:13,840
<font color="#E5E5E5">of these software packages</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> we</font>

121
00:04:11,470 --> 00:04:15,640
looked<font color="#E5E5E5"> at was meterpreter which is part</font>

122
00:04:13,840 --> 00:04:17,260
of the Metasploit framework<font color="#CCCCCC"> and this</font>

123
00:04:15,640 --> 00:04:21,039
diagram<font color="#CCCCCC"> that you see in front of you is</font>

124
00:04:17,260 --> 00:04:23,260
a representation of the<font color="#E5E5E5"> typical staging</font>

125
00:04:21,039 --> 00:04:26,199
scenario for meterpreter<font color="#CCCCCC"> I say typical</font>

126
00:04:23,260 --> 00:04:28,719
<font color="#E5E5E5">because there is a so called paranoid</font>

127
00:04:26,199 --> 00:04:31,540
that uses tls/ssl and certificate

128
00:04:28,720 --> 00:04:33,130
pinning<font color="#E5E5E5"> and it is not necessarily the</font>

129
00:04:31,540 --> 00:04:35,260
<font color="#CCCCCC">easiest</font><font color="#E5E5E5"> thing in</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> world</font><font color="#CCCCCC"> it takes</font>

130
00:04:33,130 --> 00:04:37,570
<font color="#E5E5E5">extra configuration steps you need to</font>

131
00:04:35,260 --> 00:04:39,639
<font color="#CCCCCC">use</font><font color="#E5E5E5"> third-party binaries the</font><font color="#CCCCCC"> OpenSSL</font>

132
00:04:37,570 --> 00:04:41,139
<font color="#E5E5E5">command line in particular</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> is not</font>

133
00:04:39,639 --> 00:04:42,820
necessarily<font color="#E5E5E5"> intuitive for a lot of</font>

134
00:04:41,139 --> 00:04:44,560
people<font color="#E5E5E5"> and you won't even see it</font>

135
00:04:42,820 --> 00:04:46,840
documented<font color="#E5E5E5"> in a lot of</font><font color="#CCCCCC"> how-to or getting</font>

136
00:04:44,560 --> 00:04:48,850
<font color="#CCCCCC">started guides and I'm not even sure it</font>

137
00:04:46,840 --> 00:04:49,780
works in some<font color="#CCCCCC"> real-world situations</font><font color="#E5E5E5"> like</font>

138
00:04:48,850 --> 00:04:52,240
<font color="#E5E5E5">if you're gonna go through someone</font>

139
00:04:49,780 --> 00:04:53,948
else's proxy or if you're gonna embed

140
00:04:52,240 --> 00:04:55,690
meterpreter within an exploit like<font color="#CCCCCC"> MSO</font>

141
00:04:53,949 --> 00:04:58,120
<font color="#CCCCCC">eight oh six seven</font><font color="#E5E5E5"> it's not the easiest</font>

142
00:04:55,690 --> 00:05:01,780
<font color="#CCCCCC">thing to do so most</font><font color="#E5E5E5"> people</font><font color="#CCCCCC"> are gonna opt</font>

143
00:04:58,120 --> 00:05:03,669
for this<font color="#CCCCCC"> what you see here and in this</font>

144
00:05:01,780 --> 00:05:05,830
<font color="#E5E5E5">diagram meterpreter or</font><font color="#CCCCCC"> Metasploit is</font>

145
00:05:03,669 --> 00:05:07,539
represented by the Metasploit logo and

146
00:05:05,830 --> 00:05:10,840
the<font color="#CCCCCC"> machine being compromised today is</font>

147
00:05:07,539 --> 00:05:13,090
the Hal 9000 these arrows in between

148
00:05:10,840 --> 00:05:14,948
them are a TCP<font color="#CCCCCC"> connection and the first</font>

149
00:05:13,090 --> 00:05:17,619
thing that<font color="#E5E5E5"> gets transmitted across</font><font color="#CCCCCC"> that</font>

150
00:05:14,949 --> 00:05:20,639
TCP connection<font color="#E5E5E5"> is a TCP segment that has</font>

151
00:05:17,620 --> 00:05:22,690
<font color="#CCCCCC">a 32 bit or 4 byte payload length field</font>

152
00:05:20,639 --> 00:05:25,360
<font color="#E5E5E5">following</font><font color="#CCCCCC"> that there's a slight</font><font color="#E5E5E5"> pause</font>

153
00:05:22,690 --> 00:05:26,620
and then<font color="#CCCCCC"> the actual payload itself gets</font>

154
00:05:25,360 --> 00:05:28,780
transmitted<font color="#CCCCCC"> and that payload is the</font>

155
00:05:26,620 --> 00:05:31,419
meterpreter client<font color="#E5E5E5"> when Hal gets that</font>

156
00:05:28,780 --> 00:05:33,580
<font color="#E5E5E5">payload length field he allocates a</font>

157
00:05:31,419 --> 00:05:34,960
certain chunk of<font color="#E5E5E5"> memory that is going to</font>

158
00:05:33,580 --> 00:05:36,250
be equal to<font color="#E5E5E5"> or greater than that payload</font>

159
00:05:34,960 --> 00:05:38,590
<font color="#E5E5E5">length and then he waits for that</font>

160
00:05:36,250 --> 00:05:40,479
<font color="#E5E5E5">payload to come across when he gets the</font>

161
00:05:38,590 --> 00:05:42,340
payload<font color="#E5E5E5"> he copies it into that chunk of</font>

162
00:05:40,479 --> 00:05:44,050
<font color="#E5E5E5">memory that</font><font color="#CCCCCC"> he just allocated and then</font>

163
00:05:42,340 --> 00:05:45,969
<font color="#CCCCCC">switches execution there</font><font color="#E5E5E5"> there by</font>

164
00:05:44,050 --> 00:05:47,110
running the meterpreter client and the

165
00:05:45,970 --> 00:05:48,970
meterpreter control channel gets

166
00:05:47,110 --> 00:05:52,120
<font color="#CCCCCC">established and that</font><font color="#E5E5E5"> bottom arrow exists</font>

167
00:05:48,970 --> 00:05:54,520
<font color="#E5E5E5">and this is what we can do</font><font color="#CCCCCC"> about it in</font>

168
00:05:52,120 --> 00:05:56,380
this diagram<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is our response and</font>

169
00:05:54,520 --> 00:05:58,750
you get to be<font color="#CCCCCC"> dave bowman</font><font color="#E5E5E5"> the star child</font>

170
00:05:56,380 --> 00:06:00,130
himself<font color="#CCCCCC"> and dave is running a</font>

171
00:05:58,750 --> 00:06:01,870
proof-of-concept sniffer<font color="#E5E5E5"> that we</font>

172
00:06:00,130 --> 00:06:03,310
developed<font color="#CCCCCC"> to demonstrate this</font>

173
00:06:01,870 --> 00:06:05,380
<font color="#CCCCCC">man-in-the-middle</font><font color="#E5E5E5"> counter attack and</font>

174
00:06:03,310 --> 00:06:07,810
that<font color="#E5E5E5"> proof-of-concept sniffer looks at</font>

175
00:06:05,380 --> 00:06:09,340
all the TCP segments it can and it looks

176
00:06:07,810 --> 00:06:10,990
<font color="#E5E5E5">for payload</font><font color="#CCCCCC"> links segments that</font><font color="#E5E5E5"> it</font>

177
00:06:09,340 --> 00:06:12,669
recognizes and what's nice about those

178
00:06:10,990 --> 00:06:16,570
payload link segments<font color="#E5E5E5"> is that they are</font>

179
00:06:12,669 --> 00:06:18,580
relatively static<font color="#E5E5E5"> so if you are staging</font>

180
00:06:16,570 --> 00:06:21,219
with<font color="#E5E5E5"> a Microsoft Windows</font><font color="#CCCCCC"> 64 bit machine</font>

181
00:06:18,580 --> 00:06:24,370
<font color="#E5E5E5">for example that payload linked field is</font>

182
00:06:21,220 --> 00:06:26,500
likely<font color="#E5E5E5"> to be a certain value and the</font>

183
00:06:24,370 --> 00:06:29,229
sniffer knows about<font color="#E5E5E5"> many of those values</font>

184
00:06:26,500 --> 00:06:31,210
and when it sees a payload links TCP

185
00:06:29,229 --> 00:06:33,250
<font color="#E5E5E5">segment that</font><font color="#CCCCCC"> it recognizes it takes</font>

186
00:06:31,210 --> 00:06:35,590
these sequence numbers<font color="#CCCCCC"> from that</font>

187
00:06:33,250 --> 00:06:37,180
from that segment<font color="#CCCCCC"> and it anticipates</font>

188
00:06:35,590 --> 00:06:40,419
<font color="#E5E5E5">what the sequence numbers will be for</font>

189
00:06:37,180 --> 00:06:42,930
the payload<font color="#E5E5E5"> and then it</font><font color="#CCCCCC"> uses packet</font>

190
00:06:40,420 --> 00:06:46,030
spoofing to inject a custom payload with

191
00:06:42,930 --> 00:06:49,030
friendlier software<font color="#E5E5E5"> so because there is</font>

192
00:06:46,030 --> 00:06:49,869
<font color="#E5E5E5">that nice pause between the transmission</font>

193
00:06:49,030 --> 00:06:52,090
of the payload length<font color="#E5E5E5"> and the</font>

194
00:06:49,870 --> 00:06:53,620
transmission<font color="#E5E5E5"> of the payload Dave</font>

195
00:06:52,090 --> 00:06:55,960
Bowman's packets<font color="#E5E5E5"> are</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> get there</font>

196
00:06:53,620 --> 00:06:57,430
first<font color="#CCCCCC"> and Hal 9000 looks at</font><font color="#E5E5E5"> those</font>

197
00:06:55,960 --> 00:06:59,979
packets see the sequence numbers are<font color="#CCCCCC"> in</font>

198
00:06:57,430 --> 00:07:00,610
<font color="#CCCCCC">order</font><font color="#E5E5E5"> this source and destination data</font>

199
00:06:59,980 --> 00:07:02,740
is in order

200
00:07:00,610 --> 00:07:05,610
<font color="#CCCCCC">Hal just assumes that's</font><font color="#E5E5E5"> probably part of</font>

201
00:07:02,740 --> 00:07:07,870
<font color="#E5E5E5">the TCP connection and when those actual</font>

202
00:07:05,610 --> 00:07:10,590
meterpreter payload packets come across

203
00:07:07,870 --> 00:07:12,610
well those sequence numbers appear<font color="#CCCCCC"> to be</font>

204
00:07:10,590 --> 00:07:14,679
retransmissions and that that<font color="#E5E5E5"> software</font>

205
00:07:12,610 --> 00:07:17,080
gets ignored<font color="#E5E5E5"> so when it comes time to</font>

206
00:07:14,680 --> 00:07:19,480
<font color="#E5E5E5">copy that data from the line over to</font><font color="#CCCCCC"> the</font>

207
00:07:17,080 --> 00:07:21,490
<font color="#CCCCCC">chunk</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> memory for future execution its</font>

208
00:07:19,480 --> 00:07:24,550
<font color="#E5E5E5">dave software that gets run and not</font>

209
00:07:21,490 --> 00:07:26,470
meterpreter<font color="#CCCCCC"> and by default the software</font>

210
00:07:24,550 --> 00:07:29,290
<font color="#E5E5E5">that we include is a simple reverse</font>

211
00:07:26,470 --> 00:07:31,450
shell so when it comes time<font color="#CCCCCC"> to</font><font color="#E5E5E5"> run that</font>

212
00:07:29,290 --> 00:07:33,130
client<font color="#E5E5E5"> dave bowman gets a reverse</font><font color="#CCCCCC"> shell</font>

213
00:07:31,450 --> 00:07:35,080
<font color="#E5E5E5">to further</font><font color="#CCCCCC"> illustrate what we mean</font>

214
00:07:33,130 --> 00:07:37,240
<font color="#E5E5E5">here's a snippet of</font><font color="#CCCCCC"> the configuration</font>

215
00:07:35,080 --> 00:07:39,550
file that<font color="#E5E5E5"> we</font><font color="#CCCCCC"> distribute by default</font><font color="#E5E5E5"> and</font>

216
00:07:37,240 --> 00:07:40,990
<font color="#CCCCCC">you</font><font color="#E5E5E5"> can see these trigger tags those</font>

217
00:07:39,550 --> 00:07:42,880
define the contents of<font color="#CCCCCC"> that payload</font>

218
00:07:40,990 --> 00:07:44,410
<font color="#E5E5E5">length field the first four bytes are</font>

219
00:07:42,880 --> 00:07:46,719
the payload length<font color="#CCCCCC"> now you might note</font>

220
00:07:44,410 --> 00:07:50,400
<font color="#E5E5E5">two trailing null bytes there those</font>

221
00:07:46,720 --> 00:07:52,510
exist because<font color="#CCCCCC"> Windows sometimes does</font>

222
00:07:50,400 --> 00:07:55,060
padding because alignment is important

223
00:07:52,510 --> 00:07:56,530
and we account for<font color="#E5E5E5"> that here and the</font>

224
00:07:55,060 --> 00:07:58,870
response that's the data<font color="#E5E5E5"> that we're</font>

225
00:07:56,530 --> 00:08:00,520
<font color="#CCCCCC">injecting into</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> tcp stream</font><font color="#E5E5E5"> this is</font>

226
00:07:58,870 --> 00:08:04,180
<font color="#CCCCCC">shellcode its position independent code</font>

227
00:08:00,520 --> 00:08:07,419
it is a simple run-of-the-mill<font color="#E5E5E5"> connect</font>

228
00:08:04,180 --> 00:08:08,770
back shell<font color="#E5E5E5"> and the next slide is going</font>

229
00:08:07,419 --> 00:08:11,590
to<font color="#CCCCCC"> show us</font><font color="#E5E5E5"> what</font><font color="#CCCCCC"> Dave Bowman is gonna see</font>

230
00:08:08,770 --> 00:08:13,120
and<font color="#E5E5E5"> we crept out the console</font><font color="#CCCCCC"> tags</font><font color="#E5E5E5"> from</font>

231
00:08:11,590 --> 00:08:15,070
that configuration file that's Dave's IP

232
00:08:13,120 --> 00:08:16,450
that's where that command and<font color="#E5E5E5"> control</font>

233
00:08:15,070 --> 00:08:17,890
channel is going to<font color="#E5E5E5"> be redirected and</font>

234
00:08:16,450 --> 00:08:20,140
<font color="#CCCCCC">Dave</font><font color="#E5E5E5"> is running the sniffer in the</font>

235
00:08:17,890 --> 00:08:22,270
background and that<font color="#CCCCCC"> netcat listener is</font>

236
00:08:20,140 --> 00:08:23,830
waiting for staging to occur<font color="#CCCCCC"> Dave is</font>

237
00:08:22,270 --> 00:08:27,340
<font color="#E5E5E5">gonna get a shell as soon as staging</font>

238
00:08:23,830 --> 00:08:29,500
occurs and there it is Dave Bowman has a

239
00:08:27,340 --> 00:08:33,939
shell<font color="#CCCCCC"> on the Hal 9000</font><font color="#E5E5E5"> and the</font>

240
00:08:29,500 --> 00:08:34,960
meterpreter user has nothing and here is

241
00:08:33,940 --> 00:08:39,450
what it<font color="#CCCCCC"> looks</font><font color="#E5E5E5"> like from the meterpreter</font>

242
00:08:34,960 --> 00:08:42,370
users point of<font color="#E5E5E5"> view this is a</font><font color="#CCCCCC"> Metasploit</font>

243
00:08:39,450 --> 00:08:44,770
console<font color="#E5E5E5"> and just a simple</font><font color="#CCCCCC"> Handler and</font>

244
00:08:42,370 --> 00:08:47,920
<font color="#E5E5E5">I'm gonna redirect your attention to the</font>

245
00:08:44,770 --> 00:08:49,810
<font color="#E5E5E5">last two lines of this of this terminal</font>

246
00:08:47,920 --> 00:08:52,060
<font color="#E5E5E5">and the second to last</font><font color="#CCCCCC"> line is what the</font>

247
00:08:49,810 --> 00:08:54,130
user sees<font color="#E5E5E5"> what the meterpreter user sees</font>

248
00:08:52,060 --> 00:08:55,420
<font color="#E5E5E5">when that payload length segment gets</font>

249
00:08:54,130 --> 00:08:57,280
transmitted and you can see the payload

250
00:08:55,420 --> 00:08:59,410
length<font color="#E5E5E5"> segment up there it's in base 10</font>

251
00:08:57,280 --> 00:09:01,720
<font color="#E5E5E5">and right after that you</font><font color="#CCCCCC"> should note an</font>

252
00:08:59,410 --> 00:09:02,949
error message<font color="#E5E5E5"> when</font><font color="#CCCCCC"> we did our</font><font color="#E5E5E5"> magic with</font>

253
00:09:01,720 --> 00:09:05,620
the packet spoofing in the sequence

254
00:09:02,950 --> 00:09:07,990
numbers we kind of messed<font color="#E5E5E5"> up</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> TCP</font>

255
00:09:05,620 --> 00:09:09,400
<font color="#CCCCCC">connection between the two nodes I</font><font color="#E5E5E5"> like</font>

256
00:09:07,990 --> 00:09:11,709
<font color="#E5E5E5">that we could have written in Samaras</font>

257
00:09:09,400 --> 00:09:13,000
<font color="#CCCCCC">teaster we set</font><font color="#E5E5E5"> that we set that TCP</font>

258
00:09:11,709 --> 00:09:16,030
connection but<font color="#E5E5E5"> you know what I would</font>

259
00:09:13,000 --> 00:09:17,440
rather have our<font color="#E5E5E5"> adversary here have an</font>

260
00:09:16,030 --> 00:09:19,510
error message have a broken TCP

261
00:09:17,440 --> 00:09:23,530
connection instead of the meterpreter

262
00:09:19,510 --> 00:09:26,530
<font color="#E5E5E5">prompt that presumably he wants but we</font>

263
00:09:23,530 --> 00:09:28,360
didn't stop<font color="#CCCCCC"> there when you tell people</font>

264
00:09:26,530 --> 00:09:29,530
<font color="#CCCCCC">that</font><font color="#E5E5E5"> you are targeting meterpreter for</font>

265
00:09:28,360 --> 00:09:30,790
<font color="#E5E5E5">men in the middle attacks a lot of</font>

266
00:09:29,530 --> 00:09:33,069
people will tell<font color="#CCCCCC"> you</font><font color="#E5E5E5"> that they have</font>

267
00:09:30,790 --> 00:09:38,050
<font color="#E5E5E5">moved on to</font><font color="#CCCCCC"> PowerShell Empire</font><font color="#E5E5E5"> PowerShell</font>

268
00:09:33,070 --> 00:09:39,970
Empire is really well designed<font color="#E5E5E5"> it's it's</font>

269
00:09:38,050 --> 00:09:42,099
earned<font color="#E5E5E5"> its fan base this is this is some</font>

270
00:09:39,970 --> 00:09:44,050
feature-rich software<font color="#E5E5E5"> and there are two</font>

271
00:09:42,100 --> 00:09:45,790
currently supported branches of

272
00:09:44,050 --> 00:09:47,109
PowerShell Empire there's version 1.6

273
00:09:45,790 --> 00:09:48,760
<font color="#E5E5E5">and there was a version 2.0</font>

274
00:09:47,110 --> 00:09:50,950
they both do payload encryption or

275
00:09:48,760 --> 00:09:54,339
obfuscation<font color="#E5E5E5"> somewhat differently</font><font color="#CCCCCC"> and</font>

276
00:09:50,950 --> 00:09:56,080
they're both<font color="#E5E5E5"> vulnerable</font><font color="#CCCCCC"> so when we did</font>

277
00:09:54,339 --> 00:09:57,970
the<font color="#CCCCCC"> man-in-the-middle</font><font color="#E5E5E5"> counter attack we</font>

278
00:09:56,080 --> 00:09:59,320
<font color="#E5E5E5">targeted the initial portions of staging</font>

279
00:09:57,970 --> 00:10:01,690
and you can see that<font color="#E5E5E5"> here in this</font>

280
00:09:59,320 --> 00:10:04,000
<font color="#CCCCCC">graphic that</font><font color="#E5E5E5"> we borrowed</font><font color="#CCCCCC"> from</font><font color="#E5E5E5"> PowerShell</font>

281
00:10:01,690 --> 00:10:05,500
<font color="#E5E5E5">empires website later on you can see</font>

282
00:10:04,000 --> 00:10:07,000
some really<font color="#E5E5E5"> nice cryptographic features</font>

283
00:10:05,500 --> 00:10:10,270
there's public keys and private keys

284
00:10:07,000 --> 00:10:11,890
there's diffie-hellman and AES and some

285
00:10:10,270 --> 00:10:13,720
some really<font color="#CCCCCC"> good stuff but we don't mess</font>

286
00:10:11,890 --> 00:10:15,939
with<font color="#E5E5E5"> any of that we just hit him right</font>

287
00:10:13,720 --> 00:10:18,600
at the beginning<font color="#E5E5E5"> and we broke down</font><font color="#CCCCCC"> this</font>

288
00:10:15,940 --> 00:10:21,040
man<font color="#E5E5E5"> in the middle counter attack into</font><font color="#CCCCCC"> a</font>

289
00:10:18,600 --> 00:10:24,370
<font color="#CCCCCC">three step</font><font color="#E5E5E5"> process</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> that first step</font>

290
00:10:21,040 --> 00:10:27,339
<font color="#CCCCCC">cross that first step</font><font color="#E5E5E5"> happens right when</font>

291
00:10:24,370 --> 00:10:28,959
the Empire user tries to<font color="#CCCCCC"> introduce the</font>

292
00:10:27,339 --> 00:10:30,700
PowerShell Empire software into a

293
00:10:28,959 --> 00:10:32,739
compromised machine and if you've<font color="#CCCCCC"> done</font>

294
00:10:30,700 --> 00:10:34,600
this in the real world you<font color="#CCCCCC"> know that you</font>

295
00:10:32,740 --> 00:10:36,640
have to submit<font color="#E5E5E5"> a command line that</font>

296
00:10:34,600 --> 00:10:40,720
<font color="#E5E5E5">starts with</font><font color="#CCCCCC"> Power Cell that Xen includes</font>

297
00:10:36,640 --> 00:10:42,850
<font color="#E5E5E5">this crazy base64 blob of PowerShell</font>

298
00:10:40,720 --> 00:10:45,580
code and that code<font color="#E5E5E5"> gets executed and</font>

299
00:10:42,850 --> 00:10:47,500
what that<font color="#E5E5E5"> that script is one job what it</font>

300
00:10:45,580 --> 00:10:49,990
does is it goes out to<font color="#CCCCCC"> the</font><font color="#E5E5E5"> staging</font>

301
00:10:47,500 --> 00:10:52,480
server via via HTTP

302
00:10:49,990 --> 00:10:55,180
downloads<font color="#CCCCCC"> and</font><font color="#E5E5E5"> encrypted or obfuscated</font>

303
00:10:52,480 --> 00:10:58,030
payload<font color="#E5E5E5"> then decrypted or D</font><font color="#CCCCCC"> off escapes</font>

304
00:10:55,180 --> 00:11:01,870
<font color="#E5E5E5">it using a shared secret using a</font>

305
00:10:58,030 --> 00:11:04,030
symmetric key and if<font color="#E5E5E5"> is</font><font color="#CCCCCC"> little</font><font color="#E5E5E5"> and then</font>

306
00:11:01,870 --> 00:11:06,820
<font color="#CCCCCC">executes</font><font color="#E5E5E5"> whatever it gets back there are</font>

307
00:11:04,030 --> 00:11:08,589
no<font color="#E5E5E5"> check sums there's no integrity</font>

308
00:11:06,820 --> 00:11:11,350
<font color="#E5E5E5">checks no signatures and</font><font color="#CCCCCC"> we take</font>

309
00:11:08,590 --> 00:11:14,260
<font color="#CCCCCC">advantage of</font><font color="#E5E5E5"> that in step</font><font color="#CCCCCC"> two so because</font>

310
00:11:11,350 --> 00:11:15,340
<font color="#E5E5E5">what 1.6 and 2.0 both handle their</font>

311
00:11:14,260 --> 00:11:17,500
payloads a little bit differently

312
00:11:15,340 --> 00:11:19,510
we had to handle the payloads a little

313
00:11:17,500 --> 00:11:21,760
bit differently<font color="#CCCCCC"> in both cases</font><font color="#E5E5E5"> we take a</font>

314
00:11:19,510 --> 00:11:23,260
live payload from the staging server and

315
00:11:21,760 --> 00:11:26,470
then repackage it<font color="#E5E5E5"> with our own software</font>

316
00:11:23,260 --> 00:11:31,000
<font color="#E5E5E5">for</font><font color="#CCCCCC"> version 1.6 that payload is</font>

317
00:11:26,470 --> 00:11:32,320
obfuscated with<font color="#CCCCCC"> zoar and the key is an</font>

318
00:11:31,000 --> 00:11:34,330
ASCII representation of a large

319
00:11:32,320 --> 00:11:35,890
hexadecimal number and<font color="#E5E5E5"> because the text</font>

320
00:11:34,330 --> 00:11:37,900
for any given offset<font color="#E5E5E5"> within that key</font>

321
00:11:35,890 --> 00:11:39,819
there's only 16 possibilities<font color="#CCCCCC"> there 0</font>

322
00:11:37,900 --> 00:11:43,540
through<font color="#E5E5E5"> 9 and</font><font color="#CCCCCC"> there's a through</font><font color="#E5E5E5"> F kind</font>

323
00:11:39,820 --> 00:11:47,050
of limited and the payload<font color="#CCCCCC"> itself is a</font>

324
00:11:43,540 --> 00:11:48,310
little<font color="#E5E5E5"> predictable</font><font color="#CCCCCC"> and by that I mean</font><font color="#E5E5E5"> we</font>

325
00:11:47,050 --> 00:11:49,540
know<font color="#CCCCCC"> it's a</font><font color="#E5E5E5"> PowerShell script and with a</font>

326
00:11:48,310 --> 00:11:51,250
<font color="#E5E5E5">little bit of analysis we know what</font>

327
00:11:49,540 --> 00:11:52,750
characters<font color="#E5E5E5"> are going to occur and we</font>

328
00:11:51,250 --> 00:11:54,760
know round about what the frequencies of

329
00:11:52,750 --> 00:11:56,680
<font color="#E5E5E5">occurrence of those characters are so we</font>

330
00:11:54,760 --> 00:11:57,970
take that<font color="#CCCCCC"> knowledge the the frequencies</font>

331
00:11:56,680 --> 00:12:00,579
<font color="#CCCCCC">of the characters and the limited key</font>

332
00:11:57,970 --> 00:12:02,080
space<font color="#E5E5E5"> for the for the key and we do a</font>

333
00:12:00,580 --> 00:12:04,600
little bit<font color="#E5E5E5"> of statistical analysis and</font>

334
00:12:02,080 --> 00:12:06,130
<font color="#E5E5E5">we extract the key from that obfuscated</font>

335
00:12:04,600 --> 00:12:08,140
payload<font color="#CCCCCC"> a little bit counterintuitive</font>

336
00:12:06,130 --> 00:12:10,030
but<font color="#E5E5E5"> it works really well</font><font color="#CCCCCC"> once</font><font color="#E5E5E5"> we have</font>

337
00:12:08,140 --> 00:12:12,340
<font color="#CCCCCC">that key we repackage</font><font color="#E5E5E5"> it with our own</font>

338
00:12:10,030 --> 00:12:14,530
payload for version 2.0 the<font color="#CCCCCC"> story's</font><font color="#E5E5E5"> a</font>

339
00:12:12,340 --> 00:12:17,530
little<font color="#CCCCCC"> bit more complicated</font><font color="#E5E5E5"> because 2.0</font>

340
00:12:14,530 --> 00:12:19,180
uses rc4 for<font color="#E5E5E5"> encryption and the nice</font>

341
00:12:17,530 --> 00:12:20,470
<font color="#CCCCCC">thing about RC 4 or the horrible</font><font color="#E5E5E5"> thing</font>

342
00:12:19,180 --> 00:12:22,780
about RC 4<font color="#E5E5E5"> depending on your perspective</font>

343
00:12:20,470 --> 00:12:25,150
<font color="#E5E5E5">is that it is vulnerable</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> man in the</font>

344
00:12:22,780 --> 00:12:27,550
middle<font color="#E5E5E5"> attacks specifically if you know</font>

345
00:12:25,150 --> 00:12:29,230
the contents of that plaintext you can

346
00:12:27,550 --> 00:12:32,349
make that encrypted message say anything

347
00:12:29,230 --> 00:12:33,310
you want it<font color="#CCCCCC"> to say you can see and the</font>

348
00:12:32,350 --> 00:12:36,010
bullet points you<font color="#E5E5E5"> can see how that</font>

349
00:12:33,310 --> 00:12:37,119
attack works this is a classic<font color="#E5E5E5"> crypto</font>

350
00:12:36,010 --> 00:12:38,380
attack I wish I was the guy that

351
00:12:37,120 --> 00:12:39,790
<font color="#CCCCCC">discovered it</font><font color="#E5E5E5"> i wish i was showing you</font>

352
00:12:38,380 --> 00:12:42,670
something<font color="#E5E5E5"> new but this classic attack</font>

353
00:12:39,790 --> 00:12:44,110
still works<font color="#E5E5E5"> and that's a known that</font>

354
00:12:42,670 --> 00:12:45,699
plaintext is a known payload because

355
00:12:44,110 --> 00:12:47,320
<font color="#E5E5E5">powershell</font><font color="#CCCCCC"> Empire is</font><font color="#E5E5E5"> open source</font>

356
00:12:45,700 --> 00:12:50,740
<font color="#E5E5E5">everybody has the source that's source</font>

357
00:12:47,320 --> 00:12:52,540
code in there<font color="#E5E5E5"> we all have it and for for</font>

358
00:12:50,740 --> 00:12:54,280
either version<font color="#CCCCCC"> weari package that we</font>

359
00:12:52,540 --> 00:12:57,040
repackage the software that<font color="#E5E5E5"> the user</font>

360
00:12:54,280 --> 00:12:58,449
<font color="#E5E5E5">wants stage 2 to be and we repackage it</font>

361
00:12:57,040 --> 00:12:59,980
as our own<font color="#CCCCCC"> and then</font><font color="#E5E5E5"> we use a</font>

362
00:12:58,450 --> 00:13:01,450
<font color="#CCCCCC">man-in-the-middle</font>

363
00:12:59,980 --> 00:13:02,830
<font color="#CCCCCC">Paquette spoofing attack like what you</font>

364
00:13:01,450 --> 00:13:05,260
saw<font color="#E5E5E5"> earlier with Dave</font><font color="#CCCCCC"> Bowen and the Hal</font>

365
00:13:02,830 --> 00:13:08,050
9000 to overwrite<font color="#E5E5E5"> their responses from</font>

366
00:13:05,260 --> 00:13:09,490
the server so when that<font color="#E5E5E5"> basic ste</font><font color="#CCCCCC"> four</font>

367
00:13:08,050 --> 00:13:11,949
encoded script reaches out to the

368
00:13:09,490 --> 00:13:14,170
staging server<font color="#E5E5E5"> to try to get the next</font>

369
00:13:11,950 --> 00:13:15,730
<font color="#E5E5E5">stage script it will</font><font color="#CCCCCC"> end up getting</font><font color="#E5E5E5"> our</font>

370
00:13:14,170 --> 00:13:18,790
software because we override<font color="#E5E5E5"> it on the</font>

371
00:13:15,730 --> 00:13:21,160
line<font color="#E5E5E5"> and this is what it looks like from</font>

372
00:13:18,790 --> 00:13:23,199
<font color="#E5E5E5">our point of view</font><font color="#CCCCCC"> the software is</font>

373
00:13:21,160 --> 00:13:24,640
somewhat flexible<font color="#E5E5E5"> and it lets you define</font>

374
00:13:23,200 --> 00:13:27,100
what<font color="#E5E5E5"> software</font><font color="#CCCCCC"> you want</font><font color="#E5E5E5"> to run on</font><font color="#CCCCCC"> the</font>

375
00:13:24,640 --> 00:13:28,810
compromised<font color="#CCCCCC"> machine</font><font color="#E5E5E5"> today because it's a</font>

376
00:13:27,100 --> 00:13:30,070
<font color="#E5E5E5">proof of concept we're gonna launch Cal</font>

377
00:13:28,810 --> 00:13:34,119
that<font color="#E5E5E5"> XE because that's what proof of</font>

378
00:13:30,070 --> 00:13:35,980
concepts do<font color="#CCCCCC"> by default the</font><font color="#E5E5E5"> software that</font>

379
00:13:34,120 --> 00:13:38,350
that it stems along is a reverse<font color="#CCCCCC"> shell</font>

380
00:13:35,980 --> 00:13:40,990
but you know<font color="#CCCCCC"> calc that actually it's a</font>

381
00:13:38,350 --> 00:13:42,490
proof of<font color="#E5E5E5"> concept</font><font color="#CCCCCC"> so in the</font><font color="#E5E5E5"> command line</font>

382
00:13:40,990 --> 00:13:45,880
<font color="#E5E5E5">here</font><font color="#CCCCCC"> you see that we are reaching</font><font color="#E5E5E5"> out</font><font color="#CCCCCC"> to</font>

383
00:13:42,490 --> 00:13:46,870
the staging server via HTTP<font color="#E5E5E5"> there's</font>

384
00:13:45,880 --> 00:13:48,490
other ways<font color="#CCCCCC"> you could do</font><font color="#E5E5E5"> this you could</font>

385
00:13:46,870 --> 00:13:50,080
sniff that payload<font color="#E5E5E5"> you could get it</font>

386
00:13:48,490 --> 00:13:52,990
<font color="#CCCCCC">through</font><font color="#E5E5E5"> your proxy logs we chose HTTP</font>

387
00:13:50,080 --> 00:13:54,520
there's other ways<font color="#E5E5E5"> to</font><font color="#CCCCCC"> do it and here's</font>

388
00:13:52,990 --> 00:13:57,040
what<font color="#E5E5E5"> it looks like from the attackers</font>

389
00:13:54,520 --> 00:13:58,390
point<font color="#E5E5E5"> of view this attacker sends the</font>

390
00:13:57,040 --> 00:14:00,730
PowerShell staging command and

391
00:13:58,390 --> 00:14:02,830
PowerShell does not<font color="#E5E5E5"> staged this this</font>

392
00:14:00,730 --> 00:14:04,960
user gets<font color="#CCCCCC"> cal</font><font color="#E5E5E5"> that XE we should note at</font>

393
00:14:02,830 --> 00:14:07,830
this point<font color="#E5E5E5"> that it is</font><font color="#CCCCCC"> a little</font><font color="#E5E5E5"> bit</font>

394
00:14:04,960 --> 00:14:10,450
<font color="#CCCCCC">abnormal in practice to launch</font><font color="#E5E5E5"> a</font>

395
00:14:07,830 --> 00:14:12,430
<font color="#E5E5E5">PowerShell Empire from</font><font color="#CCCCCC"> a GUI you don't</font>

396
00:14:10,450 --> 00:14:13,780
<font color="#CCCCCC">normally get</font><font color="#E5E5E5"> to do that but you know</font>

397
00:14:12,430 --> 00:14:17,109
<font color="#E5E5E5">what I wanted to show you guys</font><font color="#CCCCCC"> calcloud</font>

398
00:14:13,780 --> 00:14:18,610
<font color="#E5E5E5">XE we didn't stop there though</font><font color="#CCCCCC"> there</font>

399
00:14:17,110 --> 00:14:19,810
were a couple other software<font color="#CCCCCC"> packages</font>

400
00:14:18,610 --> 00:14:23,320
that<font color="#CCCCCC"> I think deserve a mention in</font>

401
00:14:19,810 --> 00:14:25,719
<font color="#E5E5E5">particular of fuzz bunch which is which</font>

402
00:14:23,320 --> 00:14:27,430
includes the double<font color="#CCCCCC"> pulsar module this</font>

403
00:14:25,720 --> 00:14:30,460
<font color="#CCCCCC">is part of the shadow brokers dump</font><font color="#E5E5E5"> the</font>

404
00:14:27,430 --> 00:14:32,260
shadow brokers leaked<font color="#E5E5E5"> some software that</font>

405
00:14:30,460 --> 00:14:33,580
<font color="#CCCCCC">was developed to buy and/or for one of</font>

406
00:14:32,260 --> 00:14:36,910
these three government<font color="#CCCCCC"> agencies and I'm</font>

407
00:14:33,580 --> 00:14:38,140
not going to speculate which one and the

408
00:14:36,910 --> 00:14:40,360
people<font color="#CCCCCC"> covers up to really some really</font>

409
00:14:38,140 --> 00:14:42,819
<font color="#E5E5E5">in-depth analysis of that software and</font>

410
00:14:40,360 --> 00:14:46,200
<font color="#CCCCCC">as it turns out double pulsar is very</font>

411
00:14:42,820 --> 00:14:49,210
easy<font color="#E5E5E5"> to detect on the line there are</font>

412
00:14:46,200 --> 00:14:51,520
<font color="#CCCCCC">snort</font><font color="#E5E5E5"> rules that can detect it it uses</font>

413
00:14:49,210 --> 00:14:54,490
<font color="#E5E5E5">or for encryption exposes the key in</font>

414
00:14:51,520 --> 00:14:55,960
<font color="#CCCCCC">plaintext and to make</font><font color="#E5E5E5"> matters</font><font color="#CCCCCC"> worse</font>

415
00:14:54,490 --> 00:14:57,420
double<font color="#E5E5E5"> parse that pulsar does not really</font>

416
00:14:55,960 --> 00:14:59,530
have adequate authentication once you've

417
00:14:57,420 --> 00:15:01,360
introduced it<font color="#CCCCCC"> on to somebody's</font><font color="#E5E5E5"> computer</font>

418
00:14:59,530 --> 00:15:03,880
so if you<font color="#E5E5E5"> ever detect double pulsar</font>

419
00:15:01,360 --> 00:15:05,410
running feel free to pull fire up your

420
00:15:03,880 --> 00:15:06,520
<font color="#CCCCCC">own double pulse our client and follow</font>

421
00:15:05,410 --> 00:15:08,650
that guy in because there's nothing

422
00:15:06,520 --> 00:15:10,790
<font color="#E5E5E5">gonna stop you even if you don't have</font>

423
00:15:08,650 --> 00:15:13,370
the<font color="#CCCCCC"> exploit</font>

424
00:15:10,790 --> 00:15:15,589
this is not safe<font color="#CCCCCC"> don't</font><font color="#E5E5E5"> use it</font><font color="#CCCCCC"> especially</font>

425
00:15:13,370 --> 00:15:17,330
if<font color="#E5E5E5"> you're a pen tester</font><font color="#CCCCCC"> just say no on</font>

426
00:15:15,590 --> 00:15:19,220
the other<font color="#E5E5E5"> under other end of that</font>

427
00:15:17,330 --> 00:15:21,200
<font color="#E5E5E5">spectrum is cobalt strike which has</font>

428
00:15:19,220 --> 00:15:23,690
several staging and even some stages

429
00:15:21,200 --> 00:15:25,700
options there are<font color="#E5E5E5"> data integrity checks</font>

430
00:15:23,690 --> 00:15:27,710
and<font color="#E5E5E5"> to their credit</font><font color="#CCCCCC"> Rafael much put out</font>

431
00:15:25,700 --> 00:15:30,140
a blog post that<font color="#E5E5E5"> talks about these</font>

432
00:15:27,710 --> 00:15:31,580
issues in depth and we<font color="#CCCCCC"> don't have time</font>

433
00:15:30,140 --> 00:15:33,790
<font color="#E5E5E5">to go into it today but if you're cold</font>

434
00:15:31,580 --> 00:15:36,680
strike user I strongly recommend you

435
00:15:33,790 --> 00:15:38,319
<font color="#E5E5E5">RTFM in the meantime let's talk about</font>

436
00:15:36,680 --> 00:15:40,160
<font color="#E5E5E5">the switch gears and let's talk about</font>

437
00:15:38,320 --> 00:15:42,290
password cracking and what you can do

438
00:15:40,160 --> 00:15:44,000
about<font color="#CCCCCC"> it</font><font color="#E5E5E5"> so password cracking is</font>

439
00:15:42,290 --> 00:15:46,160
computationally intensive and you<font color="#CCCCCC"> can</font>

440
00:15:44,000 --> 00:15:48,770
see a really nice password cracking

441
00:15:46,160 --> 00:15:50,510
array that this<font color="#E5E5E5"> picture was donated by</font>

442
00:15:48,770 --> 00:15:52,520
my colleague<font color="#E5E5E5"> Matt</font><font color="#CCCCCC"> wagon Connect</font><font color="#E5E5E5"> and Matt</font>

443
00:15:50,510 --> 00:15:55,610
wants<font color="#E5E5E5"> to crack passwords</font><font color="#CCCCCC"> he throws his</font>

444
00:15:52,520 --> 00:15:58,130
password hashes into this array of<font color="#CCCCCC"> high</font>

445
00:15:55,610 --> 00:15:59,390
end GPU enabled graphics cars and they

446
00:15:58,130 --> 00:16:01,220
crunch on these passwords this is

447
00:15:59,390 --> 00:16:02,210
computationally intensive<font color="#CCCCCC"> even the power</font>

448
00:16:01,220 --> 00:16:03,890
consumption if you're<font color="#E5E5E5"> doing this</font>

449
00:16:02,210 --> 00:16:06,350
seriously<font color="#E5E5E5"> is noteworthy and we're gonna</font>

450
00:16:03,890 --> 00:16:08,090
make<font color="#E5E5E5"> it harder today so we took on</font>

451
00:16:06,350 --> 00:16:10,160
element<font color="#CCCCCC"> RNN being a spoofing attacks</font>

452
00:16:08,090 --> 00:16:12,140
<font color="#E5E5E5">these attacks are really effective and</font>

453
00:16:10,160 --> 00:16:13,459
<font color="#CCCCCC">really popular this is what pen testers</font>

454
00:16:12,140 --> 00:16:17,270
typically do<font color="#E5E5E5"> on a Monday</font><font color="#CCCCCC"> morning</font><font color="#E5E5E5"> when</font>

455
00:16:13,460 --> 00:16:19,430
they show<font color="#CCCCCC"> up on site these</font><font color="#E5E5E5"> attacks are</font>

456
00:16:17,270 --> 00:16:20,600
really<font color="#E5E5E5"> effective with a little bit of</font>

457
00:16:19,430 --> 00:16:22,370
luck<font color="#CCCCCC"> not even that much luck the pen</font>

458
00:16:20,600 --> 00:16:24,290
tester might even have domain admin by

459
00:16:22,370 --> 00:16:27,020
lunchtime<font color="#CCCCCC"> lurid caffee's responder</font>

460
00:16:24,290 --> 00:16:29,689
script made<font color="#E5E5E5"> this attack popular we can</font>

461
00:16:27,020 --> 00:16:32,449
detect it we can disrupt it<font color="#CCCCCC"> responder</font><font color="#E5E5E5"> is</font>

462
00:16:29,690 --> 00:16:33,710
<font color="#E5E5E5">a great piece of software</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> here we go</font>

463
00:16:32,450 --> 00:16:35,330
in order to understand what we're doing

464
00:16:33,710 --> 00:16:37,700
<font color="#CCCCCC">here is a</font><font color="#E5E5E5"> diagram that explains how the</font>

465
00:16:35,330 --> 00:16:39,230
<font color="#E5E5E5">attack works this sad machine here in</font>

466
00:16:37,700 --> 00:16:40,700
<font color="#E5E5E5">the in the center</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> all these blue</font>

467
00:16:39,230 --> 00:16:43,130
<font color="#E5E5E5">arrows is a typically misconfigured</font>

468
00:16:40,700 --> 00:16:44,360
Microsoft Windows machine<font color="#E5E5E5"> and when it</font>

469
00:16:43,130 --> 00:16:47,060
<font color="#CCCCCC">wants</font><font color="#E5E5E5"> to do name resolution</font><font color="#CCCCCC"> the first</font>

470
00:16:44,360 --> 00:16:49,040
thing it<font color="#E5E5E5"> does is DNS and if DNS fails</font><font color="#CCCCCC"> it</font>

471
00:16:47,060 --> 00:16:51,439
sends<font color="#E5E5E5"> out these broadcast UDP packets</font>

472
00:16:49,040 --> 00:16:52,819
via NBN<font color="#E5E5E5"> s</font><font color="#CCCCCC"> and an element</font><font color="#E5E5E5"> R and it asks</font>

473
00:16:51,440 --> 00:16:56,660
everyone<font color="#E5E5E5"> on and on the network hey are</font>

474
00:16:52,820 --> 00:17:00,080
you this<font color="#E5E5E5"> machine and the evil guy here</font>

475
00:16:56,660 --> 00:17:03,050
when he gets<font color="#CCCCCC"> these queries he responds</font>

476
00:17:00,080 --> 00:17:05,210
back universally<font color="#E5E5E5"> and says yes I am that</font>

477
00:17:03,050 --> 00:17:06,649
user<font color="#E5E5E5"> and the bad guy is hoping the</font><font color="#CCCCCC"> other</font>

478
00:17:05,210 --> 00:17:08,240
side of this<font color="#E5E5E5"> diagram happens the bad guy</font>

479
00:17:06,650 --> 00:17:11,660
hopes that the<font color="#E5E5E5"> misconfigured</font><font color="#CCCCCC"> Microsoft</font>

480
00:17:08,240 --> 00:17:13,819
<font color="#E5E5E5">Windows machine will connect to it on</font>

481
00:17:11,660 --> 00:17:15,140
some supported protocol and with a

482
00:17:13,819 --> 00:17:17,510
little<font color="#CCCCCC"> bit of luck exposed a plaintext</font>

483
00:17:15,140 --> 00:17:20,030
password with slightly less luck the bad

484
00:17:17,510 --> 00:17:22,390
<font color="#E5E5E5">guy is hoping to</font><font color="#CCCCCC"> use the ntlm to induce</font>

485
00:17:20,030 --> 00:17:25,240
that misconfigured machine to send

486
00:17:22,390 --> 00:17:29,679
password hash<font color="#E5E5E5"> and this is our response</font>

487
00:17:25,240 --> 00:17:30,820
so just with<font color="#CCCCCC"> just as with the the</font>

488
00:17:29,679 --> 00:17:32,620
<font color="#E5E5E5">typically</font><font color="#CCCCCC"> misconfigured</font><font color="#E5E5E5"> Microsoft</font>

489
00:17:30,820 --> 00:17:34,240
<font color="#E5E5E5">Windows machine we also send out and DNS</font>

490
00:17:32,620 --> 00:17:35,559
in the<font color="#E5E5E5"> element our queries the</font>

491
00:17:34,240 --> 00:17:37,660
difference being we're not actually

492
00:17:35,559 --> 00:17:39,070
<font color="#E5E5E5">looking for another</font><font color="#CCCCCC"> machine</font><font color="#E5E5E5"> our queries</font>

493
00:17:37,660 --> 00:17:40,600
are<font color="#E5E5E5"> from machine names that are</font><font color="#CCCCCC"> sixteen</font>

494
00:17:39,070 --> 00:17:42,639
to<font color="#CCCCCC"> twenty</font><font color="#E5E5E5"> bytes in length of random</font>

495
00:17:40,600 --> 00:17:44,949
characters<font color="#CCCCCC"> and</font><font color="#E5E5E5"> anybody responds to that</font>

496
00:17:42,640 --> 00:17:46,660
and says yes that<font color="#CCCCCC"> pile of garbage is in</font>

497
00:17:44,950 --> 00:17:48,760
fact my machine name we consider that<font color="#E5E5E5"> we</font>

498
00:17:46,660 --> 00:17:50,920
<font color="#CCCCCC">consider</font><font color="#E5E5E5"> that entity to</font><font color="#CCCCCC"> be hostile</font><font color="#E5E5E5"> and</font>

499
00:17:48,760 --> 00:17:53,379
<font color="#E5E5E5">because that entity is looking for</font>

500
00:17:50,920 --> 00:17:55,480
password hashes we<font color="#E5E5E5"> sent password hashes</font>

501
00:17:53,380 --> 00:17:56,710
we also<font color="#E5E5E5"> log the alert so we go beyond</font>

502
00:17:55,480 --> 00:17:59,110
logging we actually do something about

503
00:17:56,710 --> 00:18:01,390
the attack and here's what it looks like

504
00:17:59,110 --> 00:18:04,870
from<font color="#CCCCCC"> the defenders point of view this</font>

505
00:18:01,390 --> 00:18:06,429
command line it takes<font color="#E5E5E5"> users</font><font color="#CCCCCC"> usernames</font>

506
00:18:04,870 --> 00:18:08,409
and passwords<font color="#E5E5E5"> from that</font><font color="#CCCCCC"> username</font><font color="#E5E5E5"> text</font>

507
00:18:06,429 --> 00:18:10,720
file presumably these are fake<font color="#E5E5E5"> usernames</font>

508
00:18:08,410 --> 00:18:12,520
and passwords however<font color="#E5E5E5"> people talk to</font><font color="#CCCCCC"> me</font>

509
00:18:10,720 --> 00:18:14,080
<font color="#E5E5E5">about</font><font color="#CCCCCC"> canary accounts and using that as</font>

510
00:18:12,520 --> 00:18:17,309
a means<font color="#E5E5E5"> of detecting relay attacks if</font>

511
00:18:14,080 --> 00:18:19,809
you're worried about that<font color="#CCCCCC"> and we send</font>

512
00:18:17,309 --> 00:18:22,059
credentials<font color="#CCCCCC"> hashed credentials from</font><font color="#E5E5E5"> that</font>

513
00:18:19,809 --> 00:18:24,010
from<font color="#CCCCCC"> that list and we</font><font color="#E5E5E5"> logged the alert</font>

514
00:18:22,059 --> 00:18:25,809
<font color="#E5E5E5">and we look for these bad guys every ten</font>

515
00:18:24,010 --> 00:18:27,760
seconds and it's a little<font color="#CCCCCC"> bit</font><font color="#E5E5E5"> more</font>

516
00:18:25,809 --> 00:18:32,649
exciting from the responder users point

517
00:18:27,760 --> 00:18:34,540
of view here's responder and there we go

518
00:18:32,650 --> 00:18:36,190
the bad guy just<font color="#E5E5E5"> got a password</font><font color="#CCCCCC"> hash</font>

519
00:18:34,540 --> 00:18:37,870
from<font color="#E5E5E5"> Dennis Ritchie earlier the bad guy</font>

520
00:18:36,190 --> 00:18:39,580
<font color="#CCCCCC">get a password hash from Grace Hopper if</font>

521
00:18:37,870 --> 00:18:41,340
we wait<font color="#CCCCCC"> long enough</font><font color="#E5E5E5"> we'll see a network</font>

522
00:18:39,580 --> 00:18:43,570
guy perhaps that's<font color="#E5E5E5"> Jon Postel</font>

523
00:18:41,340 --> 00:18:46,330
sadly everybody<font color="#CCCCCC"> have this name checked</font>

524
00:18:43,570 --> 00:18:47,559
right<font color="#E5E5E5"> there is</font><font color="#CCCCCC"> passed has passed away</font><font color="#E5E5E5"> so</font>

525
00:18:46,330 --> 00:18:49,840
it is<font color="#E5E5E5"> unlikely</font><font color="#CCCCCC"> that any of</font><font color="#E5E5E5"> them are</font>

526
00:18:47,559 --> 00:18:51,639
<font color="#CCCCCC">going to</font><font color="#E5E5E5"> be using ntlm or any network</font>

527
00:18:49,840 --> 00:18:53,500
based services at all<font color="#E5E5E5"> again these are</font>

528
00:18:51,640 --> 00:18:56,340
these<font color="#CCCCCC"> are fake accounts and we are</font>

529
00:18:53,500 --> 00:18:57,880
hoping that the attacker jumps on to the

530
00:18:56,340 --> 00:19:00,580
hamster wheel that<font color="#E5E5E5"> we've just</font>

531
00:18:57,880 --> 00:19:02,470
<font color="#E5E5E5">constructed and</font><font color="#CCCCCC"> again the</font><font color="#E5E5E5"> software is</font>

532
00:19:00,580 --> 00:19:03,549
designed<font color="#E5E5E5"> to work around</font><font color="#CCCCCC"> your</font><font color="#E5E5E5"> strategies</font>

533
00:19:02,470 --> 00:19:06,130
<font color="#E5E5E5">so if you want to be a little bit more</font>

534
00:19:03,549 --> 00:19:08,440
aggressive<font color="#E5E5E5"> we include a resource</font>

535
00:19:06,130 --> 00:19:10,000
exhaustion attack<font color="#E5E5E5"> so this bad guy want</font>

536
00:19:08,440 --> 00:19:11,679
some hashes let's send<font color="#E5E5E5"> them some hashes</font>

537
00:19:10,000 --> 00:19:15,610
if the bad guy walks away from<font color="#E5E5E5"> the</font>

538
00:19:11,679 --> 00:19:17,290
console yeah<font color="#CCCCCC"> the bad guy walks away from</font>

539
00:19:15,610 --> 00:19:20,350
the console the bad guy comes<font color="#E5E5E5"> back that</font>

540
00:19:17,290 --> 00:19:22,570
hard drives filled up that database<font color="#E5E5E5"> of</font>

541
00:19:20,350 --> 00:19:26,549
hashes is somewhat corrupt<font color="#E5E5E5"> it's a bad</font>

542
00:19:22,570 --> 00:19:29,110
day for<font color="#E5E5E5"> the bad guy</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> we also took on</font>

543
00:19:26,549 --> 00:19:30,668
wpa2 attacks designed to steal that

544
00:19:29,110 --> 00:19:32,860
<font color="#E5E5E5">appreciated key that where this password</font>

545
00:19:30,669 --> 00:19:34,690
<font color="#CCCCCC">and in order</font><font color="#E5E5E5"> to understand how that</font>

546
00:19:32,860 --> 00:19:38,020
attack works we need a little<font color="#CCCCCC"> bit of it</font>

547
00:19:34,690 --> 00:19:39,220
of the handshaking process that happens

548
00:19:38,020 --> 00:19:42,070
when you want to<font color="#E5E5E5"> join a wireless network</font>

549
00:19:39,220 --> 00:19:43,330
<font color="#CCCCCC">the STA in this</font><font color="#E5E5E5"> diagram is the node</font><font color="#CCCCCC"> that</font>

550
00:19:42,070 --> 00:19:48,070
wants to<font color="#E5E5E5"> join the network so if you</font>

551
00:19:43,330 --> 00:19:50,050
imagine a cell<font color="#E5E5E5"> phone or a laptop</font><font color="#CCCCCC"> that</font>

552
00:19:48,070 --> 00:19:51,220
<font color="#CCCCCC">wants to join the network the AP is the</font>

553
00:19:50,050 --> 00:19:52,270
access point where this router or

554
00:19:51,220 --> 00:19:54,190
whatever controls that wireless network

555
00:19:52,270 --> 00:19:56,500
<font color="#CCCCCC">and you</font><font color="#E5E5E5"> can see in between</font><font color="#CCCCCC"> them there is</font>

556
00:19:54,190 --> 00:19:58,090
<font color="#E5E5E5">a four-way handshake that happens and</font>

557
00:19:56,500 --> 00:20:00,340
that<font color="#CCCCCC"> four Way handshake involves both</font>

558
00:19:58,090 --> 00:20:01,750
ends generating a nonce<font color="#E5E5E5"> and those nonces</font>

559
00:20:00,340 --> 00:20:03,790
are used together with<font color="#E5E5E5"> the actual</font>

560
00:20:01,750 --> 00:20:05,650
<font color="#CCCCCC">pre-shared key to construct a message</font>

561
00:20:03,790 --> 00:20:07,420
identification code or<font color="#E5E5E5"> Mik which is</font>

562
00:20:05,650 --> 00:20:10,480
ostensibly a hash of<font color="#CCCCCC"> that pre shared key</font>

563
00:20:07,420 --> 00:20:12,460
and<font color="#E5E5E5"> the attacker software real world</font>

564
00:20:10,480 --> 00:20:14,440
when they're<font color="#E5E5E5"> doing this the attacker is</font>

565
00:20:12,460 --> 00:20:15,220
going<font color="#E5E5E5"> to sniff packets from a lot of</font>

566
00:20:14,440 --> 00:20:17,650
<font color="#E5E5E5">different networks</font><font color="#CCCCCC"> and they're all</font>

567
00:20:15,220 --> 00:20:20,050
differentiated by looking at the bssid

568
00:20:17,650 --> 00:20:22,450
or MAC address<font color="#E5E5E5"> of those APs</font><font color="#CCCCCC"> so what we</font>

569
00:20:20,050 --> 00:20:25,629
do is we mimic this authentication

570
00:20:22,450 --> 00:20:28,540
process we do packet spoofing to<font color="#CCCCCC"> send</font>

571
00:20:25,630 --> 00:20:31,720
<font color="#CCCCCC">out fake handshakes</font><font color="#E5E5E5"> with the same</font><font color="#CCCCCC"> MAC</font>

572
00:20:28,540 --> 00:20:33,820
<font color="#E5E5E5">address of</font><font color="#CCCCCC"> that ap and fake passwords</font><font color="#E5E5E5"> so</font>

573
00:20:31,720 --> 00:20:37,120
we frustrated password cracking from

574
00:20:33,820 --> 00:20:38,470
that perspective<font color="#E5E5E5"> and</font><font color="#CCCCCC"> I know a lot of</font>

575
00:20:37,120 --> 00:20:40,000
people test out where<font color="#E5E5E5"> else security</font>

576
00:20:38,470 --> 00:20:43,090
<font color="#E5E5E5">tools on their on their neighbors</font>

577
00:20:40,000 --> 00:20:45,490
networks and I'm not naming<font color="#CCCCCC"> names</font><font color="#E5E5E5"> but</font>

578
00:20:43,090 --> 00:20:47,110
today we are<font color="#E5E5E5"> going I do this at home and</font>

579
00:20:45,490 --> 00:20:49,420
<font color="#E5E5E5">we're going</font><font color="#CCCCCC"> to defend my neighbors</font>

580
00:20:47,110 --> 00:20:50,889
<font color="#CCCCCC">network I don't know mr. Garcia</font><font color="#E5E5E5"> if you</font>

581
00:20:49,420 --> 00:20:54,330
ever see this mr. Garcia thank you for

582
00:20:50,890 --> 00:20:56,530
allowing<font color="#E5E5E5"> me to defend your network and</font>

583
00:20:54,330 --> 00:20:58,330
<font color="#E5E5E5">this defense is</font><font color="#CCCCCC"> actually really really</font>

584
00:20:56,530 --> 00:21:00,310
passive so mr. Garcia can go ahead and

585
00:20:58,330 --> 00:21:02,320
watch<font color="#E5E5E5"> this videos on on YouTube he never</font>

586
00:21:00,310 --> 00:21:03,550
knew<font color="#CCCCCC"> where this happened</font><font color="#E5E5E5"> and I</font><font color="#CCCCCC"> don't</font>

587
00:21:02,320 --> 00:21:04,720
know<font color="#E5E5E5"> mr. Garcia's password so we're</font>

588
00:21:03,550 --> 00:21:06,820
<font color="#CCCCCC">gonna use a fake password a fake</font>

589
00:21:04,720 --> 00:21:08,620
password and this bad guy is going<font color="#E5E5E5"> to</font>

590
00:21:06,820 --> 00:21:11,020
use<font color="#E5E5E5"> arrow dump a pretty common tool for</font>

591
00:21:08,620 --> 00:21:13,899
<font color="#E5E5E5">this and he's gonna</font><font color="#CCCCCC"> topic it mr.</font><font color="#E5E5E5"> Garcia</font>

592
00:21:11,020 --> 00:21:14,950
and anybody<font color="#E5E5E5"> who's done this attack real</font>

593
00:21:13,900 --> 00:21:16,630
world knows<font color="#CCCCCC"> that there's a lot</font><font color="#E5E5E5"> of</font>

594
00:21:14,950 --> 00:21:18,700
waiting<font color="#E5E5E5"> there are deaaath attacks if</font>

595
00:21:16,630 --> 00:21:21,340
these handshakes don't happen on your on

596
00:21:18,700 --> 00:21:23,440
<font color="#E5E5E5">your schedule but</font><font color="#CCCCCC"> uh</font><font color="#E5E5E5"> even then those</font><font color="#CCCCCC"> do</font>

597
00:21:21,340 --> 00:21:27,520
auth attacks aren't necessarily easy<font color="#CCCCCC"> now</font>

598
00:21:23,440 --> 00:21:28,630
we<font color="#E5E5E5"> just got a we got</font><font color="#CCCCCC"> a handshake and the</font>

599
00:21:27,520 --> 00:21:32,620
bad guys<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> try to crack that</font>

600
00:21:28,630 --> 00:21:34,180
password<font color="#E5E5E5"> you see there we go</font><font color="#CCCCCC"> the bad guy</font>

601
00:21:32,620 --> 00:21:36,310
<font color="#E5E5E5">got the fake password a fake password</font>

602
00:21:34,180 --> 00:21:38,080
<font color="#E5E5E5">whatever mr. Garcia's real password is</font>

603
00:21:36,310 --> 00:21:41,379
<font color="#E5E5E5">the bad guy's gonna</font><font color="#CCCCCC"> have to go back to</font>

604
00:21:38,080 --> 00:21:42,340
<font color="#E5E5E5">square one</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> try to get it again the</font>

605
00:21:41,380 --> 00:21:44,260
bad guy<font color="#CCCCCC"> just have to do a lot more</font>

606
00:21:42,340 --> 00:21:46,689
waiting and if you imagine you put<font color="#E5E5E5"> in</font>

607
00:21:44,260 --> 00:21:48,850
for fake handshakes<font color="#E5E5E5"> and the bad guy gets</font>

608
00:21:46,690 --> 00:21:50,440
lucky<font color="#E5E5E5"> gets one real handshake</font>

609
00:21:48,850 --> 00:21:51,730
the<font color="#CCCCCC"> bad guy either has to</font><font color="#E5E5E5"> figure</font><font color="#CCCCCC"> out</font><font color="#E5E5E5"> how</font>

610
00:21:50,440 --> 00:21:54,610
to tell the difference<font color="#CCCCCC"> between the</font>

611
00:21:51,730 --> 00:21:56,050
handshakes or crack them all and if<font color="#E5E5E5"> the</font>

612
00:21:54,610 --> 00:21:57,540
bad<font color="#E5E5E5"> guys uses to correct them all you've</font>

613
00:21:56,050 --> 00:22:00,850
just degraded<font color="#CCCCCC"> their cracking</font>

614
00:21:57,540 --> 00:22:02,379
capabilities by about<font color="#CCCCCC"> 80% and as you</font><font color="#E5E5E5"> can</font>

615
00:22:00,850 --> 00:22:04,929
<font color="#CCCCCC">see</font><font color="#E5E5E5"> I was only able to crack about ass</font>

616
00:22:02,380 --> 00:22:06,250
out<font color="#CCCCCC"> I was only</font><font color="#E5E5E5"> able to crack</font><font color="#CCCCCC"> it about a</font>

617
00:22:04,930 --> 00:22:08,440
thousand guesses per second<font color="#E5E5E5"> that</font><font color="#CCCCCC"> is</font>

618
00:22:06,250 --> 00:22:10,780
really slow<font color="#CCCCCC"> so we've made</font><font color="#E5E5E5"> it harder to</font>

619
00:22:08,440 --> 00:22:13,570
<font color="#E5E5E5">steal Wi-Fi passwords and we did it on</font>

620
00:22:10,780 --> 00:22:15,550
the<font color="#E5E5E5"> cheap without really disturbing</font><font color="#CCCCCC"> mr.</font>

621
00:22:13,570 --> 00:22:17,740
<font color="#E5E5E5">Garcia so we intend</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> continue this</font>

622
00:22:15,550 --> 00:22:20,440
project<font color="#E5E5E5"> into the future</font><font color="#CCCCCC"> there's areas</font><font color="#E5E5E5"> we</font>

623
00:22:17,740 --> 00:22:23,110
can we can keep<font color="#CCCCCC"> going we can integrate</font>

624
00:22:20,440 --> 00:22:25,320
the wireless defenses<font color="#E5E5E5"> with open wrt or</font>

625
00:22:23,110 --> 00:22:27,159
other available<font color="#E5E5E5"> access point software</font>

626
00:22:25,320 --> 00:22:28,840
existing security technologies

627
00:22:27,160 --> 00:22:31,450
especially IDs<font color="#CCCCCC"> as an IPS as you can</font>

628
00:22:28,840 --> 00:22:33,159
definitely put this in there it was

629
00:22:31,450 --> 00:22:35,500
designed<font color="#E5E5E5"> for</font><font color="#CCCCCC"> that proxies if you have a</font>

630
00:22:33,160 --> 00:22:37,660
smart proxy we can make it smarter<font color="#CCCCCC"> in</font>

631
00:22:35,500 --> 00:22:39,400
the<font color="#E5E5E5"> future of the future tools we want</font>

632
00:22:37,660 --> 00:22:41,050
<font color="#CCCCCC">to target whatever the cool new tool is</font>

633
00:22:39,400 --> 00:22:43,000
the people<font color="#E5E5E5"> are using to break into into</font>

634
00:22:41,050 --> 00:22:46,270
computers<font color="#E5E5E5"> that's what we want to go</font>

635
00:22:43,000 --> 00:22:47,890
after so if you want these tools at home

636
00:22:46,270 --> 00:22:49,389
<font color="#E5E5E5">if you want to try this at home</font><font color="#CCCCCC"> there's</font>

637
00:22:47,890 --> 00:22:51,430
a there's the<font color="#CCCCCC"> github for the shallot</font>

638
00:22:49,390 --> 00:22:52,840
project so<font color="#E5E5E5"> this is the</font><font color="#CCCCCC"> C</font><font color="#E5E5E5"> cloak</font><font color="#CCCCCC"> 8 destroy</font>

639
00:22:51,430 --> 00:22:54,970
<font color="#CCCCCC">tool kit otherwise known as</font><font color="#E5E5E5"> the salad</font>

640
00:22:52,840 --> 00:22:57,220
project<font color="#CCCCCC"> if you want to reach</font><font color="#E5E5E5"> out to me</font>

641
00:22:54,970 --> 00:22:59,260
if<font color="#CCCCCC"> you're curious</font><font color="#E5E5E5"> or if you don't want</font>

642
00:22:57,220 --> 00:23:01,720
<font color="#CCCCCC">to see how this</font><font color="#E5E5E5"> is going here's my</font>

643
00:22:59,260 --> 00:23:04,290
<font color="#E5E5E5">Twitter handle Johnny Ventura and thank</font>

644
00:23:01,720 --> 00:23:04,290
you<font color="#E5E5E5"> for your time today</font>

