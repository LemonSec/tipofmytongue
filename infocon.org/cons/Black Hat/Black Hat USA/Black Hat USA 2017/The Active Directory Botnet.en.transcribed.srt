1
00:00:00,000 --> 00:00:05,040
thanks everyone for coming<font color="#E5E5E5"> welcome to</font>

2
00:00:01,829 --> 00:00:07,020
the<font color="#E5E5E5"> active directory but</font><font color="#CCCCCC"> net</font>

3
00:00:05,040 --> 00:00:09,450
<font color="#CCCCCC">so my name's ty</font><font color="#E5E5E5"> Miller I'm the managing</font>

4
00:00:07,020 --> 00:00:12,149
<font color="#CCCCCC">director of a security company in Sydney</font>

5
00:00:09,450 --> 00:00:15,268
called threat intelligence<font color="#CCCCCC"> done a lot of</font>

6
00:00:12,150 --> 00:00:17,609
<font color="#E5E5E5">stuff with blackhat we run the shell</font>

7
00:00:15,269 --> 00:00:19,410
code lab training<font color="#E5E5E5"> as well as practical</font>

8
00:00:17,609 --> 00:00:22,050
threat intelligence<font color="#E5E5E5"> and a number</font><font color="#CCCCCC"> of</font>

9
00:00:19,410 --> 00:00:25,619
presentations at blackhat in different

10
00:00:22,050 --> 00:00:27,330
<font color="#E5E5E5">conferences over the years</font><font color="#CCCCCC"> Paul helps</font>

11
00:00:25,619 --> 00:00:30,390
out with<font color="#E5E5E5"> the practical threat</font>

12
00:00:27,330 --> 00:00:32,250
intelligence training<font color="#E5E5E5"> as well and is</font>

13
00:00:30,390 --> 00:00:35,550
<font color="#CCCCCC">obviously presenting today for the</font>

14
00:00:32,250 --> 00:00:37,800
<font color="#CCCCCC">active directory botnet</font><font color="#E5E5E5"> so what are we</font>

15
00:00:35,550 --> 00:00:41,190
going to<font color="#E5E5E5"> talk about so we're going to</font>

16
00:00:37,800 --> 00:00:43,589
demonstrate<font color="#CCCCCC"> how to exploit</font><font color="#E5E5E5"> a fundamental</font>

17
00:00:41,190 --> 00:00:45,899
flaw in the way that you know nearly

18
00:00:43,590 --> 00:00:48,960
every<font color="#E5E5E5"> organization implements their</font>

19
00:00:45,899 --> 00:00:52,050
<font color="#E5E5E5">Active Directory</font><font color="#CCCCCC"> which</font><font color="#E5E5E5"> is pretty</font><font color="#CCCCCC"> much I</font>

20
00:00:48,960 --> 00:00:54,660
mean<font color="#CCCCCC"> a</font><font color="#E5E5E5"> lot</font><font color="#CCCCCC"> of the time</font><font color="#E5E5E5"> you know one big</font>

21
00:00:52,050 --> 00:00:57,800
domain<font color="#E5E5E5"> with you know a lot of the</font>

22
00:00:54,660 --> 00:01:01,410
systems or authenticating to it<font color="#CCCCCC"> and</font>

23
00:00:57,800 --> 00:01:07,289
<font color="#E5E5E5">basically that introduces a gaping hole</font>

24
00:01:01,410 --> 00:01:10,619
<font color="#E5E5E5">in our security that allows</font><font color="#CCCCCC"> us</font><font color="#E5E5E5"> to you</font>

25
00:01:07,290 --> 00:01:13,400
<font color="#CCCCCC">know or minimizes the the</font><font color="#E5E5E5"> ability</font><font color="#CCCCCC"> for us</font>

26
00:01:10,619 --> 00:01:16,590
to<font color="#E5E5E5"> effectively contain security breaches</font>

27
00:01:13,400 --> 00:01:18,509
<font color="#CCCCCC">so this is achieved by turning your</font>

28
00:01:16,590 --> 00:01:22,020
<font color="#E5E5E5">Active Directory</font><font color="#CCCCCC"> as the name suggests</font>

29
00:01:18,509 --> 00:01:26,549
<font color="#E5E5E5">into an internal botnet</font><font color="#CCCCCC"> and we're going</font>

30
00:01:22,020 --> 00:01:29,369
<font color="#E5E5E5">to demonstrate live</font><font color="#CCCCCC"> a number of</font><font color="#E5E5E5"> features</font>

31
00:01:26,549 --> 00:01:33,450
of<font color="#E5E5E5"> this</font><font color="#CCCCCC"> age a botnet including getting</font>

32
00:01:29,369 --> 00:01:35,340
<font color="#E5E5E5">some remote control over</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> so I just</font>

33
00:01:33,450 --> 00:01:37,439
wanted<font color="#E5E5E5"> to sort of introduce his talk</font>

34
00:01:35,340 --> 00:01:42,600
with sort<font color="#CCCCCC"> of the</font><font color="#E5E5E5"> current state</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> play</font>

35
00:01:37,439 --> 00:01:45,148
so the<font color="#E5E5E5"> Verizon 2017 data breach</font>

36
00:01:42,600 --> 00:01:47,158
investigations report<font color="#CCCCCC"> you know shows</font>

37
00:01:45,149 --> 00:01:51,240
that it's<font color="#E5E5E5"> not going to be a surprise</font><font color="#CCCCCC"> to</font>

38
00:01:47,159 --> 00:01:55,950
everyone<font color="#E5E5E5"> here that attacks and breaches</font>

39
00:01:51,240 --> 00:01:57,509
are going<font color="#E5E5E5"> crazy these days</font><font color="#CCCCCC"> and when you</font>

40
00:01:55,950 --> 00:01:59,250
start having<font color="#E5E5E5"> a look at some</font><font color="#CCCCCC"> of the</font>

41
00:01:57,509 --> 00:02:01,979
statistics<font color="#CCCCCC"> that</font><font color="#E5E5E5"> they pull out in this</font>

42
00:01:59,250 --> 00:02:03,450
<font color="#E5E5E5">and they they categorize it</font><font color="#CCCCCC"> you know</font>

43
00:02:01,979 --> 00:02:06,179
there's there's obviously a<font color="#E5E5E5"> lot of</font>

44
00:02:03,450 --> 00:02:08,610
<font color="#E5E5E5">stolen credit so we're seeing through</font>

45
00:02:06,180 --> 00:02:11,790
dumps coming out pretty much every<font color="#E5E5E5"> day a</font>

46
00:02:08,610 --> 00:02:14,250
week<font color="#CCCCCC"> but the</font><font color="#E5E5E5"> interesting ones</font>

47
00:02:11,790 --> 00:02:16,170
or for<font color="#E5E5E5"> us anyway for this talk is the</font>

48
00:02:14,250 --> 00:02:18,060
use of<font color="#CCCCCC"> backdoors / command-and-control</font>

49
00:02:16,170 --> 00:02:22,649
<font color="#E5E5E5">and you can see on the</font><font color="#CCCCCC"> right-hand side</font>

50
00:02:18,060 --> 00:02:26,939
down to<font color="#CCCCCC"> the fin column there's 557 so</font>

51
00:02:22,650 --> 00:02:30,959
the red ones<font color="#E5E5E5"> they're really the high</font>

52
00:02:26,939 --> 00:02:33,510
numbers<font color="#CCCCCC"> and that's typically related</font><font color="#E5E5E5"> to</font>

53
00:02:30,959 --> 00:02:35,819
you know<font color="#E5E5E5"> things like your malware and</font>

54
00:02:33,510 --> 00:02:38,129
also down the bottom there you can see

55
00:02:35,819 --> 00:02:41,129
with phishing<font color="#E5E5E5"> so we're combining a way</font>

56
00:02:38,129 --> 00:02:46,200
of you know<font color="#CCCCCC"> your</font><font color="#E5E5E5"> client side attacks and</font>

57
00:02:41,129 --> 00:02:47,879
<font color="#CCCCCC">your commanding control so this</font><font color="#E5E5E5"> is just</font>

58
00:02:46,200 --> 00:02:51,540
<font color="#E5E5E5">to give you an</font><font color="#CCCCCC"> idea of</font><font color="#E5E5E5"> some of the</font>

59
00:02:47,879 --> 00:02:56,638
ransomware revenue that<font color="#E5E5E5"> has been seen</font>

60
00:02:51,540 --> 00:03:01,019
over<font color="#E5E5E5"> the last few</font><font color="#CCCCCC"> years with a lot of</font>

61
00:02:56,639 --> 00:03:05,250
them netting over<font color="#CCCCCC"> a hundred million we</font>

62
00:03:01,019 --> 00:03:08,239
and the<font color="#E5E5E5"> expected or estimated amount in</font>

63
00:03:05,250 --> 00:03:11,099
this year was almost<font color="#E5E5E5"> a billion dollars</font>

64
00:03:08,239 --> 00:03:13,590
<font color="#CCCCCC">so if there's huge amount of motivation</font>

65
00:03:11,099 --> 00:03:16,078
for these<font color="#E5E5E5"> attackers to be you know</font>

66
00:03:13,590 --> 00:03:18,379
compromising your internal network<font color="#CCCCCC"> get</font>

67
00:03:16,079 --> 00:03:23,220
it and setting up a commanding control

68
00:03:18,379 --> 00:03:26,370
<font color="#E5E5E5">environment so some</font><font color="#CCCCCC"> of the primary</font>

69
00:03:23,220 --> 00:03:27,690
<font color="#E5E5E5">attack techniques as I was saying is you</font>

70
00:03:26,370 --> 00:03:32,430
can see on the right hand<font color="#CCCCCC"> side is the</font>

71
00:03:27,690 --> 00:03:34,978
phishing so it's through the social

72
00:03:32,430 --> 00:03:39,419
<font color="#E5E5E5">engineering or</font><font color="#CCCCCC"> phishing with client side</font>

73
00:03:34,979 --> 00:03:43,680
exploitation<font color="#E5E5E5"> drive-by downloads or just</font>

74
00:03:39,419 --> 00:03:49,019
you know you're lucky HR lady<font color="#E5E5E5"> clicking</font>

75
00:03:43,680 --> 00:03:50,579
on the attachments<font color="#E5E5E5"> so then you can see</font>

76
00:03:49,019 --> 00:03:52,829
that<font color="#CCCCCC"> in this second bullet point</font>

77
00:03:50,579 --> 00:03:54,989
phishing remains a favorite technique of

78
00:03:52,829 --> 00:03:56,909
attackers<font color="#E5E5E5"> with payloads commonly</font>

79
00:03:54,989 --> 00:03:59,669
delivered via email<font color="#CCCCCC"> seventy-three</font>

80
00:03:56,909 --> 00:04:02,728
<font color="#E5E5E5">percent</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> drive by downloads</font><font color="#CCCCCC"> thirteen</font>

81
00:03:59,669 --> 00:04:05,370
percent<font color="#CCCCCC"> for that</font><font color="#E5E5E5"> particular category</font><font color="#CCCCCC"> and</font>

82
00:04:02,729 --> 00:04:07,319
if the attachment<font color="#E5E5E5"> so in terms of the</font>

83
00:04:05,370 --> 00:04:10,019
functionality<font color="#CCCCCC"> of what actually happens</font>

84
00:04:07,319 --> 00:04:13,228
then if the attachments then opened

85
00:04:10,019 --> 00:04:16,649
it'll drop a<font color="#E5E5E5"> command-and-control</font><font color="#CCCCCC"> malware</font>

86
00:04:13,229 --> 00:04:19,130
and then obviously<font color="#CCCCCC"> set</font><font color="#E5E5E5"> up that backdoor</font>

87
00:04:16,649 --> 00:04:22,519
communication channel back out to the

88
00:04:19,130 --> 00:04:22,519
<font color="#E5E5E5">CNC server</font>

89
00:04:22,960 --> 00:04:30,919
so currently attackers<font color="#E5E5E5"> still being</font>

90
00:04:27,440 --> 00:04:32,950
trying to<font color="#E5E5E5"> be pretty stealthy right</font><font color="#CCCCCC"> you</font>

91
00:04:30,920 --> 00:04:38,990
know a lot of this<font color="#E5E5E5"> malware tries to hide</font>

92
00:04:32,950 --> 00:04:42,110
<font color="#CCCCCC">I tend to</font><font color="#E5E5E5"> suspect</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> you know with a</font>

93
00:04:38,990 --> 00:04:44,450
lot<font color="#CCCCCC"> of push towards automation</font><font color="#E5E5E5"> like in</font>

94
00:04:42,110 --> 00:04:47,120
security as we see this big push towards

95
00:04:44,450 --> 00:04:48,979
<font color="#E5E5E5">you know automation and machine learning</font>

96
00:04:47,120 --> 00:04:51,770
<font color="#CCCCCC">and those sort of things and certainly</font><font color="#E5E5E5"> a</font>

97
00:04:48,980 --> 00:04:54,410
matter<font color="#E5E5E5"> of time before the attack is sort</font>

98
00:04:51,770 --> 00:04:57,169
of catch on<font color="#CCCCCC"> to that and start</font><font color="#E5E5E5"> automating</font>

99
00:04:54,410 --> 00:05:00,470
a lot of these<font color="#E5E5E5"> attacks for you know we</font>

100
00:04:57,170 --> 00:05:02,870
sort<font color="#CCCCCC"> of or people outside</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> this room</font>

101
00:05:00,470 --> 00:05:06,320
<font color="#CCCCCC">probably got surprised at you know</font>

102
00:05:02,870 --> 00:05:10,970
things<font color="#E5E5E5"> like the the big malware</font><font color="#CCCCCC"> hits</font>

103
00:05:06,320 --> 00:05:13,670
we've been seeing recently<font color="#CCCCCC"> but if we</font>

104
00:05:10,970 --> 00:05:17,120
start sort of<font color="#E5E5E5"> if the attackers</font><font color="#CCCCCC"> decide</font><font color="#E5E5E5"> to</font>

105
00:05:13,670 --> 00:05:20,750
start removing that stealthy part of it

106
00:05:17,120 --> 00:05:23,720
and<font color="#CCCCCC"> just going nuts you know we're</font><font color="#E5E5E5"> in</font>

107
00:05:20,750 --> 00:05:25,040
big trouble<font color="#CCCCCC"> so you know it's you is</font>

108
00:05:23,720 --> 00:05:28,450
you're starts the<font color="#E5E5E5"> open source</font>

109
00:05:25,040 --> 00:05:32,480
technologies evolving you know<font color="#E5E5E5"> the</font>

110
00:05:28,450 --> 00:05:34,520
software<font color="#E5E5E5"> and the attack capabilities are</font>

111
00:05:32,480 --> 00:05:36,680
just going<font color="#E5E5E5"> to become huge especially as</font>

112
00:05:34,520 --> 00:05:42,200
you know the machine<font color="#E5E5E5"> learning side of</font>

113
00:05:36,680 --> 00:05:44,360
things<font color="#E5E5E5"> really matures</font><font color="#CCCCCC"> so the other thing</font>

114
00:05:42,200 --> 00:05:45,979
<font color="#E5E5E5">is</font><font color="#CCCCCC"> that I really find surprising is</font><font color="#E5E5E5"> I</font>

115
00:05:44,360 --> 00:05:47,540
mean not surprising that<font color="#CCCCCC"> people are</font>

116
00:05:45,980 --> 00:05:50,540
<font color="#E5E5E5">moving</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> cloud that's obviously a</font>

117
00:05:47,540 --> 00:05:53,240
<font color="#CCCCCC">norm</font><font color="#E5E5E5"> this days but</font><font color="#CCCCCC"> just you</font><font color="#E5E5E5"> know we're</font>

118
00:05:50,540 --> 00:05:55,669
really<font color="#E5E5E5"> extending the our internal</font>

119
00:05:53,240 --> 00:05:57,530
networks<font color="#E5E5E5"> out of the cloud</font><font color="#CCCCCC"> and we tried</font>

120
00:05:55,669 --> 00:06:00,740
<font color="#CCCCCC">to take advantage of</font><font color="#E5E5E5"> that within this</font>

121
00:05:57,530 --> 00:06:02,659
<font color="#CCCCCC">presentation to leverage the</font><font color="#E5E5E5"> fact that</font>

122
00:06:00,740 --> 00:06:05,720
you know we've we've traditionally built

123
00:06:02,660 --> 00:06:08,180
up this hard shell<font color="#CCCCCC"> of a traditional</font>

124
00:06:05,720 --> 00:06:09,740
security architecture but then cloud has

125
00:06:08,180 --> 00:06:11,419
<font color="#CCCCCC">suddenly just ripped that</font><font color="#E5E5E5"> apart and</font>

126
00:06:09,740 --> 00:06:13,130
started throwing it<font color="#E5E5E5"> out on the net right</font>

127
00:06:11,419 --> 00:06:17,330
which<font color="#E5E5E5"> I think a lot of people in this</font>

128
00:06:13,130 --> 00:06:20,120
<font color="#CCCCCC">room tend to struggle a bit with so</font>

129
00:06:17,330 --> 00:06:21,909
there's huge potential for<font color="#E5E5E5"> attacks</font><font color="#CCCCCC"> to</font>

130
00:06:20,120 --> 00:06:25,460
you know break out of<font color="#CCCCCC"> your organization</font>

131
00:06:21,910 --> 00:06:28,430
<font color="#CCCCCC">go noisy and really</font><font color="#E5E5E5"> perform some fast</font>

132
00:06:25,460 --> 00:06:32,900
get fast escalation<font color="#E5E5E5"> and large impact</font>

133
00:06:28,430 --> 00:06:35,570
attacks so<font color="#E5E5E5"> basically</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> to summarize</font>

134
00:06:32,900 --> 00:06:35,960
<font color="#CCCCCC">that we're looking at highly motivated</font>

135
00:06:35,570 --> 00:06:38,690
<font color="#E5E5E5">threat</font>

136
00:06:35,960 --> 00:06:40,489
<font color="#CCCCCC">actors utilizing endpoint exploitation</font>

137
00:06:38,690 --> 00:06:42,710
techniques that connect to command and

138
00:06:40,490 --> 00:06:45,979
<font color="#E5E5E5">control servers to launch fast and</font>

139
00:06:42,710 --> 00:06:48,349
effective internal attacks<font color="#CCCCCC"> so the main</font>

140
00:06:45,979 --> 00:06:51,229
<font color="#CCCCCC">challenge is</font><font color="#E5E5E5"> to really for these attacks</font>

141
00:06:48,349 --> 00:06:58,009
<font color="#E5E5E5">is</font><font color="#CCCCCC"> to reliably</font><font color="#E5E5E5"> connect out to these</font>

142
00:06:51,229 --> 00:07:00,289
command and control servers<font color="#E5E5E5"> and so what</font>

143
00:06:58,009 --> 00:07:02,419
we're trying<font color="#CCCCCC"> to do is sort</font><font color="#E5E5E5"> of make</font>

144
00:07:00,289 --> 00:07:05,360
people<font color="#E5E5E5"> realize you know what</font><font color="#CCCCCC"> the next</font>

145
00:07:02,419 --> 00:07:08,389
<font color="#CCCCCC">generation of attacks might look like</font><font color="#E5E5E5"> so</font>

146
00:07:05,360 --> 00:07:10,490
start<font color="#E5E5E5"> thinking about things like what if</font>

147
00:07:08,389 --> 00:07:12,770
it command and control server exists

148
00:07:10,490 --> 00:07:15,500
<font color="#CCCCCC">inside your internal network what if the</font>

149
00:07:12,770 --> 00:07:17,599
<font color="#CCCCCC">seats</font><font color="#E5E5E5"> reserved exists as a part of your</font>

150
00:07:15,500 --> 00:07:20,780
<font color="#E5E5E5">critical infrastructure you know how are</font>

151
00:07:17,599 --> 00:07:22,639
you going<font color="#E5E5E5"> to deal</font><font color="#CCCCCC"> with that what if the</font>

152
00:07:20,780 --> 00:07:25,008
command and control servers start using

153
00:07:22,639 --> 00:07:27,380
<font color="#CCCCCC">production services via</font><font color="#E5E5E5"> key for their</font>

154
00:07:25,009 --> 00:07:30,349
communications rather than trying<font color="#E5E5E5"> to</font>

155
00:07:27,380 --> 00:07:32,449
<font color="#E5E5E5">tunnel out by their</font><font color="#CCCCCC"> own connections and</font>

156
00:07:30,349 --> 00:07:34,340
what happens when<font color="#E5E5E5"> your command and</font>

157
00:07:32,449 --> 00:07:36,949
<font color="#CCCCCC">control servers inside your internal</font>

158
00:07:34,340 --> 00:07:39,409
network<font color="#E5E5E5"> can bypass all</font><font color="#CCCCCC"> of your firewalls</font>

159
00:07:36,949 --> 00:07:43,159
and all your network<font color="#E5E5E5"> access controls by</font>

160
00:07:39,409 --> 00:07:44,780
using<font color="#E5E5E5"> your production services</font><font color="#CCCCCC"> and the</font>

161
00:07:43,159 --> 00:07:47,060
other is as I<font color="#E5E5E5"> was saying with</font><font color="#CCCCCC"> the cloud</font>

162
00:07:44,780 --> 00:07:49,250
comments<font color="#E5E5E5"> what if your command external</font>

163
00:07:47,060 --> 00:07:51,229
servers start tunneling<font color="#E5E5E5"> out by your</font>

164
00:07:49,250 --> 00:07:53,900
cloud connections which you know we've

165
00:07:51,229 --> 00:07:57,590
<font color="#CCCCCC">just opened</font><font color="#E5E5E5"> up to to allow functionality</font>

166
00:07:53,900 --> 00:07:59,780
and flexibility so introducing<font color="#E5E5E5"> the</font>

167
00:07:57,590 --> 00:08:03,770
Active<font color="#CCCCCC"> Directory botnet</font><font color="#E5E5E5"> we're trying to</font>

168
00:07:59,780 --> 00:08:06,138
achieve<font color="#E5E5E5"> those things</font><font color="#CCCCCC"> so first of all I</font>

169
00:08:03,770 --> 00:08:08,560
just<font color="#E5E5E5"> wanted to start off with having</font><font color="#CCCCCC"> a</font>

170
00:08:06,139 --> 00:08:13,490
look at a common<font color="#CCCCCC"> Active Directory</font>

171
00:08:08,560 --> 00:08:16,759
<font color="#E5E5E5">architecture so this is sort of a</font>

172
00:08:13,490 --> 00:08:18,469
picture<font color="#E5E5E5"> of a common organization you</font>

173
00:08:16,759 --> 00:08:20,349
know you might have a DMZ<font color="#CCCCCC"> you may or may</font>

174
00:08:18,469 --> 00:08:23,120
<font color="#CCCCCC">not have a</font><font color="#E5E5E5"> domain controller</font><font color="#CCCCCC"> in there</font>

175
00:08:20,349 --> 00:08:26,659
you've got<font color="#E5E5E5"> your</font><font color="#CCCCCC"> clout DC on the right</font>

176
00:08:23,120 --> 00:08:28,729
there that may have<font color="#CCCCCC"> a cloud</font><font color="#E5E5E5"> domain</font>

177
00:08:26,659 --> 00:08:31,909
controller in<font color="#E5E5E5"> there and then you've got</font>

178
00:08:28,729 --> 00:08:34,819
<font color="#E5E5E5">your various different security zones</font>

179
00:08:31,909 --> 00:08:36,919
which<font color="#CCCCCC"> may be your</font><font color="#E5E5E5"> lands or your various</font>

180
00:08:34,820 --> 00:08:38,719
network segments and then that they may

181
00:08:36,919 --> 00:08:41,270
<font color="#E5E5E5">have their own domain controllers in</font>

182
00:08:38,719 --> 00:08:43,339
<font color="#E5E5E5">there as well</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> and you can see each</font>

183
00:08:41,270 --> 00:08:45,680
of<font color="#CCCCCC"> the domain controllers can talk to</font>

184
00:08:43,339 --> 00:08:49,540
<font color="#CCCCCC">each other as</font><font color="#E5E5E5"> well as out to the cloud</font>

185
00:08:45,680 --> 00:08:49,540
and each of these systems

186
00:08:49,550 --> 00:08:54,439
in each<font color="#E5E5E5"> of the</font><font color="#CCCCCC"> different security</font><font color="#E5E5E5"> zones</font>

187
00:08:51,890 --> 00:08:56,930
can talk to the domain controllers<font color="#E5E5E5"> but</font>

188
00:08:54,440 --> 00:08:58,640
<font color="#E5E5E5">not talk to each other but the domain</font>

189
00:08:56,930 --> 00:09:03,650
controllers can talk to each<font color="#CCCCCC"> other</font><font color="#E5E5E5"> right</font>

190
00:08:58,640 --> 00:09:07,670
<font color="#CCCCCC">so let's have a look at</font><font color="#E5E5E5"> a common botnet</font>

191
00:09:03,650 --> 00:09:11,510
architecture<font color="#E5E5E5"> wait a minute</font><font color="#CCCCCC"> that looks</font>

192
00:09:07,670 --> 00:09:14,569
<font color="#E5E5E5">very familiar Active Directory</font><font color="#CCCCCC"> but net</font>

193
00:09:11,510 --> 00:09:17,689
architecture Active Directory<font color="#E5E5E5"> what data</font>

194
00:09:14,570 --> 00:09:20,870
architecture<font color="#E5E5E5"> so you've got in this case</font>

195
00:09:17,690 --> 00:09:23,780
you've got<font color="#E5E5E5"> different organizations</font><font color="#CCCCCC"> as</font>

196
00:09:20,870 --> 00:09:25,460
represented by the circles and I mean

197
00:09:23,780 --> 00:09:26,780
you don't<font color="#E5E5E5"> necessarily need</font><font color="#CCCCCC"> the command</font>

198
00:09:25,460 --> 00:09:29,840
external servers inside the

199
00:09:26,780 --> 00:09:32,240
<font color="#CCCCCC">organization's that you know there's</font>

200
00:09:29,840 --> 00:09:34,880
command external systems on the<font color="#CCCCCC"> internet</font>

201
00:09:32,240 --> 00:09:38,830
and within these<font color="#CCCCCC"> different security</font>

202
00:09:34,880 --> 00:09:40,580
zones or organizations<font color="#E5E5E5"> these</font><font color="#CCCCCC"> BOTS or</font>

203
00:09:38,830 --> 00:09:43,760
<font color="#E5E5E5">communicate</font><font color="#CCCCCC"> with the command and</font><font color="#E5E5E5"> control</font>

204
00:09:40,580 --> 00:09:46,220
systems including you know<font color="#CCCCCC"> bots sitting</font>

205
00:09:43,760 --> 00:09:49,220
in the cloud<font color="#E5E5E5"> right so what we're doing</font>

206
00:09:46,220 --> 00:09:51,650
is combining the<font color="#E5E5E5"> two similar concepts</font>

207
00:09:49,220 --> 00:09:54,620
for<font color="#CCCCCC"> a bot architecture and an AJ</font>

208
00:09:51,650 --> 00:09:57,350
architecture and creating the Active

209
00:09:54,620 --> 00:09:59,930
<font color="#CCCCCC">Directory botnet architecture which</font><font color="#E5E5E5"> is</font>

210
00:09:57,350 --> 00:10:03,080
pretty<font color="#CCCCCC"> much</font><font color="#E5E5E5"> the same as both right so</font>

211
00:09:59,930 --> 00:10:05,810
you've got<font color="#E5E5E5"> your domain</font><font color="#CCCCCC"> controllers in</font>

212
00:10:03,080 --> 00:10:08,000
<font color="#CCCCCC">the middle you've got</font><font color="#E5E5E5"> different systems</font>

213
00:10:05,810 --> 00:10:10,550
<font color="#E5E5E5">within your environment</font><font color="#CCCCCC"> that have been</font>

214
00:10:08,000 --> 00:10:14,780
<font color="#E5E5E5">infected by</font><font color="#CCCCCC"> bots</font><font color="#E5E5E5"> and as we just</font><font color="#CCCCCC"> went</font>

215
00:10:10,550 --> 00:10:16,939
<font color="#E5E5E5">through through the state of</font><font color="#CCCCCC"> play</font><font color="#E5E5E5"> you</font>

216
00:10:14,780 --> 00:10:19,010
know a lot of<font color="#E5E5E5"> these</font><font color="#CCCCCC"> assists we're seeing</font>

217
00:10:16,940 --> 00:10:21,110
a lot of<font color="#E5E5E5"> security breaches and a lot of</font>

218
00:10:19,010 --> 00:10:23,120
<font color="#CCCCCC">these breaches are coming through</font><font color="#E5E5E5"> you</font>

219
00:10:21,110 --> 00:10:25,190
know your client<font color="#CCCCCC"> side attacks</font><font color="#E5E5E5"> and</font>

220
00:10:23,120 --> 00:10:27,890
<font color="#E5E5E5">therefore you it's quite likely</font><font color="#CCCCCC"> that</font>

221
00:10:25,190 --> 00:10:30,500
you'll actually get<font color="#CCCCCC"> systems spread</font>

222
00:10:27,890 --> 00:10:32,140
across multiple<font color="#E5E5E5"> security zones getting</font>

223
00:10:30,500 --> 00:10:34,880
breached<font color="#E5E5E5"> but they can't necessarily</font>

224
00:10:32,140 --> 00:10:36,860
communicate with each<font color="#E5E5E5"> other so what the</font>

225
00:10:34,880 --> 00:10:38,990
botnet<font color="#E5E5E5"> Active Directory botnet</font>

226
00:10:36,860 --> 00:10:41,480
architecture does is<font color="#CCCCCC"> actually allows all</font>

227
00:10:38,990 --> 00:10:44,770
<font color="#CCCCCC">of those BOTS to talk to each other no</font>

228
00:10:41,480 --> 00:10:44,770
matter<font color="#E5E5E5"> what</font><font color="#CCCCCC"> security zone they're in</font>

229
00:10:45,250 --> 00:10:51,170
<font color="#E5E5E5">okay so suitability</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> Active Directory</font>

230
00:10:48,320 --> 00:10:53,390
<font color="#E5E5E5">is a command and control channel we've</font>

231
00:10:51,170 --> 00:10:55,790
got it's a central authentication and

232
00:10:53,390 --> 00:10:58,460
access control point for<font color="#CCCCCC"> organization so</font>

233
00:10:55,790 --> 00:11:00,890
you<font color="#CCCCCC"> know a lot of organizations will use</font>

234
00:10:58,460 --> 00:11:01,250
<font color="#E5E5E5">ad as the central authentication and</font>

235
00:11:00,890 --> 00:11:03,290
<font color="#E5E5E5">there</font>

236
00:11:01,250 --> 00:11:05,569
or you know if system administrators

237
00:11:03,290 --> 00:11:07,490
want<font color="#E5E5E5"> to log into you know a server in</font>

238
00:11:05,569 --> 00:11:09,589
<font color="#E5E5E5">the DMZ</font><font color="#CCCCCC"> then it has to</font><font color="#E5E5E5"> be able to</font>

239
00:11:07,490 --> 00:11:11,480
connect<font color="#E5E5E5"> to their Active Directory</font><font color="#CCCCCC"> if</font>

240
00:11:09,589 --> 00:11:13,579
they want<font color="#E5E5E5"> to connect to a system that's</font>

241
00:11:11,480 --> 00:11:15,350
in their corporate<font color="#E5E5E5"> VLAN</font>

242
00:11:13,579 --> 00:11:17,750
it has to connect<font color="#CCCCCC"> to Active Directory</font>

243
00:11:15,350 --> 00:11:19,189
<font color="#E5E5E5">right or if they want to connect to</font>

244
00:11:17,750 --> 00:11:21,079
<font color="#CCCCCC">another system in a different security</font>

245
00:11:19,189 --> 00:11:24,529
zone has to connect to Active Directory

246
00:11:21,079 --> 00:11:27,229
for authentication<font color="#CCCCCC"> so all the end-user</font>

247
00:11:24,529 --> 00:11:31,069
devices<font color="#CCCCCC"> and a lot of the servers will</font>

248
00:11:27,230 --> 00:11:33,529
<font color="#E5E5E5">connect to ad which means that we can</font>

249
00:11:31,069 --> 00:11:36,500
<font color="#CCCCCC">utilize that</font><font color="#E5E5E5"> connection</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> bypass all of</font>

250
00:11:33,529 --> 00:11:38,870
<font color="#E5E5E5">your network</font><font color="#CCCCCC"> access controls and all</font>

251
00:11:36,500 --> 00:11:40,699
your firewall rules<font color="#CCCCCC"> because that's got</font>

252
00:11:38,870 --> 00:11:44,319
<font color="#E5E5E5">that gaping hole</font><font color="#CCCCCC"> where everything can</font>

253
00:11:40,699 --> 00:11:44,319
communicate with this one central place

254
00:11:44,769 --> 00:11:52,220
<font color="#CCCCCC">so the other thing with Active Directory</font>

255
00:11:47,870 --> 00:11:56,269
<font color="#E5E5E5">is that any standard user account can</font>

256
00:11:52,220 --> 00:11:57,889
write to their own<font color="#E5E5E5"> attributes right so</font>

257
00:11:56,269 --> 00:11:59,689
<font color="#E5E5E5">for when we're talking about Active</font>

258
00:11:57,889 --> 00:12:01,699
Directory and<font color="#CCCCCC"> its suitability as a</font>

259
00:11:59,689 --> 00:12:04,339
<font color="#CCCCCC">command-and-control Channel we need to</font>

260
00:12:01,699 --> 00:12:05,959
be able to send and<font color="#CCCCCC"> receive data</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> that</font>

261
00:12:04,339 --> 00:12:08,720
<font color="#E5E5E5">we can get a two-way</font><font color="#CCCCCC"> communication</font>

262
00:12:05,959 --> 00:12:11,300
channel so users can write to their own

263
00:12:08,720 --> 00:12:14,750
attributes<font color="#CCCCCC"> and they can read other users</font>

264
00:12:11,300 --> 00:12:17,209
attributes<font color="#CCCCCC"> which means that we can write</font>

265
00:12:14,750 --> 00:12:21,500
<font color="#E5E5E5">data and we can also read data</font><font color="#CCCCCC"> from</font>

266
00:12:17,209 --> 00:12:23,508
other<font color="#E5E5E5"> BOTS right so that allows</font><font color="#CCCCCC"> a</font>

267
00:12:21,500 --> 00:12:25,100
<font color="#E5E5E5">two-way communication channel through</font>

268
00:12:23,509 --> 00:12:26,779
your domain<font color="#CCCCCC"> controllers to be</font><font color="#E5E5E5"> able to</font>

269
00:12:25,100 --> 00:12:29,689
talk<font color="#CCCCCC"> to any other system</font><font color="#E5E5E5"> within</font><font color="#CCCCCC"> your</font>

270
00:12:26,779 --> 00:12:33,920
<font color="#E5E5E5">network as well as when you start</font>

271
00:12:29,689 --> 00:12:37,610
looking<font color="#CCCCCC"> at you know cloud systems you</font>

272
00:12:33,920 --> 00:12:40,430
can communicate out by<font color="#CCCCCC"> your through ADT</font>

273
00:12:37,610 --> 00:12:44,209
cloud systems<font color="#E5E5E5"> and we're also going</font><font color="#CCCCCC"> to</font>

274
00:12:40,430 --> 00:12:46,160
show you how to<font color="#E5E5E5"> utilize your cloud</font>

275
00:12:44,209 --> 00:12:50,089
domain controllers to actually<font color="#CCCCCC"> export</font>

276
00:12:46,160 --> 00:12:52,879
<font color="#CCCCCC">rate data</font><font color="#E5E5E5"> out</font><font color="#CCCCCC"> of your</font><font color="#E5E5E5"> organization</font><font color="#CCCCCC"> so</font>

277
00:12:50,089 --> 00:12:55,069
I'll hand over to<font color="#E5E5E5"> Paul</font><font color="#CCCCCC"> he's going to</font>

278
00:12:52,879 --> 00:12:57,889
step you through<font color="#E5E5E5"> the gruesome details</font><font color="#CCCCCC"> I</font>

279
00:12:55,069 --> 00:13:00,800
just<font color="#CCCCCC"> like to give credit to Paul he</font><font color="#E5E5E5"> has</font>

280
00:12:57,889 --> 00:13:03,220
been working<font color="#E5E5E5"> hard for a long time now</font>

281
00:13:00,800 --> 00:13:08,029
he's done about<font color="#E5E5E5"> 90% of the code in this</font>

282
00:13:03,220 --> 00:13:09,450
<font color="#E5E5E5">so good work</font><font color="#CCCCCC"> rate all</font><font color="#E5E5E5"> right thanks all</font>

283
00:13:08,029 --> 00:13:12,660
<font color="#E5E5E5">right</font><font color="#CCCCCC"> so</font>

284
00:13:09,450 --> 00:13:15,840
<font color="#CCCCCC">as Ty's</font><font color="#E5E5E5"> been saying like one of the</font>

285
00:13:12,660 --> 00:13:17,880
interesting things about<font color="#E5E5E5"> using Active</font>

286
00:13:15,840 --> 00:13:21,420
Directory for the command and<font color="#CCCCCC"> control is</font>

287
00:13:17,880 --> 00:13:24,330
that<font color="#E5E5E5"> it basically turns whatever network</font>

288
00:13:21,420 --> 00:13:27,030
you've got no matter what segmentation

289
00:13:24,330 --> 00:13:29,250
or what network controls you've got in

290
00:13:27,030 --> 00:13:31,339
place it turns it from<font color="#E5E5E5"> you know a</font>

291
00:13:29,250 --> 00:13:34,260
segmented<font color="#CCCCCC"> network into more like a</font>

292
00:13:31,340 --> 00:13:35,400
<font color="#CCCCCC">starbase</font><font color="#E5E5E5"> network where you know at the</font>

293
00:13:34,260 --> 00:13:37,350
center<font color="#CCCCCC"> of the star</font>

294
00:13:35,400 --> 00:13:40,890
you've got the<font color="#CCCCCC"> domain controller so</font>

295
00:13:37,350 --> 00:13:44,490
<font color="#E5E5E5">basically every every little node</font>

296
00:13:40,890 --> 00:13:47,640
connected to it is able<font color="#CCCCCC"> to access</font><font color="#E5E5E5"> and</font>

297
00:13:44,490 --> 00:13:50,790
read<font color="#E5E5E5"> data</font><font color="#CCCCCC"> from the domain controller</font><font color="#E5E5E5"> and</font>

298
00:13:47,640 --> 00:13:54,240
you know in<font color="#E5E5E5"> that manner</font><font color="#CCCCCC"> establish a</font>

299
00:13:50,790 --> 00:13:57,329
two-way connection now<font color="#E5E5E5"> another</font>

300
00:13:54,240 --> 00:14:00,480
<font color="#E5E5E5">interesting</font><font color="#CCCCCC"> thing about it is that</font><font color="#E5E5E5"> the</font>

301
00:13:57,330 --> 00:14:04,380
the<font color="#CCCCCC"> kind of traffic that</font><font color="#E5E5E5"> you'll see when</font>

302
00:14:00,480 --> 00:14:06,720
you actually run traffic over<font color="#E5E5E5"> it there's</font>

303
00:14:04,380 --> 00:14:10,230
really<font color="#CCCCCC"> only you've got obviously</font>

304
00:14:06,720 --> 00:14:14,430
Kerberos authentication<font color="#E5E5E5"> then all updates</font>

305
00:14:10,230 --> 00:14:17,250
<font color="#E5E5E5">to attributes go over the aw8 EWS which</font>

306
00:14:14,430 --> 00:14:19,109
is like you<font color="#E5E5E5"> know the Active Directory</font>

307
00:14:17,250 --> 00:14:22,080
web service which is<font color="#E5E5E5"> encrypted</font>

308
00:14:19,110 --> 00:14:26,160
you know SSL<font color="#E5E5E5"> and so you know it's not</font>

309
00:14:22,080 --> 00:14:28,730
something<font color="#CCCCCC"> that's easily viewable over</font>

310
00:14:26,160 --> 00:14:30,990
you know like if you've got like a

311
00:14:28,730 --> 00:14:32,880
<font color="#E5E5E5">intrusion detection system or something</font>

312
00:14:30,990 --> 00:14:35,460
<font color="#E5E5E5">like</font><font color="#CCCCCC"> that on your internal</font><font color="#E5E5E5"> network</font><font color="#CCCCCC"> it's</font>

313
00:14:32,880 --> 00:14:39,770
not<font color="#E5E5E5"> something</font><font color="#CCCCCC"> that's going</font><font color="#E5E5E5"> to be easily</font>

314
00:14:35,460 --> 00:14:43,740
<font color="#E5E5E5">visible on any of your network detection</font>

315
00:14:39,770 --> 00:14:49,110
mechanisms the other the other<font color="#CCCCCC"> thing is</font>

316
00:14:43,740 --> 00:14:51,570
that<font color="#E5E5E5"> the normal default logging</font><font color="#CCCCCC"> windows</font>

317
00:14:49,110 --> 00:14:54,690
in Active Directory<font color="#CCCCCC"> typically is not</font>

318
00:14:51,570 --> 00:14:57,170
<font color="#E5E5E5">going to detect it either that the kind</font>

319
00:14:54,690 --> 00:15:00,600
of logs which will be<font color="#E5E5E5"> generated</font>

320
00:14:57,170 --> 00:15:04,770
<font color="#E5E5E5">typically the type of things like active</font>

321
00:15:00,600 --> 00:15:07,380
directory object updates and most people

322
00:15:04,770 --> 00:15:09,870
even<font color="#E5E5E5"> if it is turned off on initially</font>

323
00:15:07,380 --> 00:15:13,830
will turn turn it off because it's quite

324
00:15:09,870 --> 00:15:16,500
a noisy<font color="#E5E5E5"> sort of event to be looking at</font>

325
00:15:13,830 --> 00:15:18,690
because<font color="#E5E5E5"> like there's so many updates to</font>

326
00:15:16,500 --> 00:15:19,890
Active Directory objects<font color="#E5E5E5"> so there's just</font>

327
00:15:18,690 --> 00:15:21,899
a<font color="#E5E5E5"> couple</font><font color="#CCCCCC"> of you know</font>

328
00:15:19,890 --> 00:15:24,390
things<font color="#CCCCCC"> just to set the</font><font color="#E5E5E5"> scene about what</font>

329
00:15:21,899 --> 00:15:26,430
makes this kind of command<font color="#E5E5E5"> and control</font>

330
00:15:24,390 --> 00:15:32,459
<font color="#CCCCCC">Network interesting from an attackers</font>

331
00:15:26,430 --> 00:15:36,029
<font color="#CCCCCC">perspective so like there's a lot of</font>

332
00:15:32,459 --> 00:15:40,430
standard user attributes<font color="#CCCCCC"> not all</font><font color="#E5E5E5"> of</font>

333
00:15:36,029 --> 00:15:44,670
these are a<font color="#E5E5E5"> rideable to the average user</font>

334
00:15:40,430 --> 00:15:49,410
<font color="#E5E5E5">but like a subset of these are usable</font>

335
00:15:44,670 --> 00:15:52,410
<font color="#E5E5E5">and so like they range in size</font><font color="#CCCCCC"> from</font>

336
00:15:49,410 --> 00:15:56,370
about a megabyte<font color="#E5E5E5"> and down to about you</font>

337
00:15:52,410 --> 00:15:58,290
<font color="#CCCCCC">know</font><font color="#E5E5E5"> 64 64 bytes or something like that</font>

338
00:15:56,370 --> 00:16:01,410
<font color="#CCCCCC">I</font><font color="#E5E5E5"> can't remember the lowest one</font><font color="#CCCCCC"> but you</font>

339
00:15:58,290 --> 00:16:04,019
<font color="#E5E5E5">know like the largest the largest</font>

340
00:16:01,410 --> 00:16:08,279
attributes about<font color="#E5E5E5"> a megabyte from memory</font>

341
00:16:04,019 --> 00:16:10,470
<font color="#CCCCCC">so basically you know</font><font color="#E5E5E5"> you can use any of</font>

342
00:16:08,279 --> 00:16:11,880
<font color="#E5E5E5">these</font><font color="#CCCCCC"> attributes for establishing you</font>

343
00:16:10,470 --> 00:16:15,750
know the<font color="#E5E5E5"> communication within the</font>

344
00:16:11,880 --> 00:16:18,450
network<font color="#CCCCCC"> oh here we go</font>

345
00:16:15,750 --> 00:16:21,089
here's<font color="#CCCCCC"> some of the</font><font color="#E5E5E5"> sizes so the largest</font>

346
00:16:18,450 --> 00:16:22,680
one is<font color="#CCCCCC"> the like</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> M smq</font><font color="#E5E5E5"> signed</font>

347
00:16:21,089 --> 00:16:25,560
certificates<font color="#E5E5E5"> it's around a bit of</font>

348
00:16:22,680 --> 00:16:27,959
megabyte and<font color="#E5E5E5"> you've got thumbnail photo</font>

349
00:16:25,560 --> 00:16:30,630
and a few other<font color="#E5E5E5"> ones</font><font color="#CCCCCC"> so basically</font>

350
00:16:27,959 --> 00:16:32,609
<font color="#CCCCCC">they're they're divided into like binary</font>

351
00:16:30,630 --> 00:16:41,880
<font color="#CCCCCC">attributes and string attributes</font><font color="#E5E5E5"> in</font>

352
00:16:32,610 --> 00:16:46,079
terms of their type<font color="#E5E5E5"> so so in terms of</font>

353
00:16:41,880 --> 00:16:48,899
establishing<font color="#E5E5E5"> our botnet and</font><font color="#CCCCCC"> the way</font><font color="#E5E5E5"> we</font>

354
00:16:46,079 --> 00:16:51,569
sort of did<font color="#CCCCCC"> it is when like a node or</font><font color="#E5E5E5"> a</font>

355
00:16:48,899 --> 00:16:55,010
bot registers<font color="#E5E5E5"> one of the first things it</font>

356
00:16:51,570 --> 00:16:58,769
does is<font color="#E5E5E5"> that each botnets got like a</font>

357
00:16:55,010 --> 00:17:01,730
unique gooood<font color="#CCCCCC"> and so what it would do is</font>

358
00:16:58,769 --> 00:17:07,020
is as part of its initialization routine

359
00:17:01,730 --> 00:17:10,919
<font color="#CCCCCC">would would be</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> update the IP Phone</font>

360
00:17:07,020 --> 00:17:15,119
attribute with this<font color="#E5E5E5"> good and so what</font>

361
00:17:10,919 --> 00:17:18,150
that<font color="#E5E5E5"> means</font><font color="#CCCCCC"> is that like when we look</font><font color="#E5E5E5"> at</font>

362
00:17:15,119 --> 00:17:20,790
<font color="#E5E5E5">the botnet we can scan the entire Active</font>

363
00:17:18,150 --> 00:17:23,459
Directory<font color="#CCCCCC"> for that go</font><font color="#E5E5E5"> ahead and look at</font>

364
00:17:20,790 --> 00:17:25,649
<font color="#CCCCCC">it</font><font color="#E5E5E5"> look at only those systems in which</font>

365
00:17:23,459 --> 00:17:27,720
that gooood matches the botnet<font color="#CCCCCC"> good and</font>

366
00:17:25,650 --> 00:17:29,940
then we can actually<font color="#E5E5E5"> track the nodes</font>

367
00:17:27,720 --> 00:17:30,340
that we have actually<font color="#CCCCCC"> got</font><font color="#E5E5E5"> infected on</font>

368
00:17:29,940 --> 00:17:34,779
the

369
00:17:30,340 --> 00:17:36,760
on the domain and so then we know which

370
00:17:34,779 --> 00:17:39,429
ones we<font color="#CCCCCC"> can you know establish</font><font color="#E5E5E5"> commands</font>

371
00:17:36,760 --> 00:17:43,210
and send and send<font color="#E5E5E5"> data to receive data</font>

372
00:17:39,429 --> 00:17:47,529
from<font color="#E5E5E5"> start</font><font color="#CCCCCC"> reverse</font><font color="#E5E5E5"> shells buying shells</font>

373
00:17:43,210 --> 00:17:49,809
<font color="#CCCCCC">all that sort of stuff the info</font>

374
00:17:47,529 --> 00:17:52,659
attribute is one we chose for a control

375
00:17:49,809 --> 00:17:58,870
channel so we sort<font color="#E5E5E5"> of established quite</font>

376
00:17:52,659 --> 00:18:01,419
<font color="#E5E5E5">a simple protocol and basically when</font>

377
00:17:58,870 --> 00:18:05,408
we're looking<font color="#E5E5E5"> at differentiating</font><font color="#CCCCCC"> between</font>

378
00:18:01,419 --> 00:18:07,419
nodes<font color="#E5E5E5"> within this network the main thing</font>

379
00:18:05,409 --> 00:18:11,070
we're<font color="#CCCCCC"> looking</font><font color="#E5E5E5"> at really is the user</font>

380
00:18:07,419 --> 00:18:14,140
account that<font color="#CCCCCC"> has been compromised and</font>

381
00:18:11,070 --> 00:18:16,299
also the<font color="#E5E5E5"> the</font><font color="#CCCCCC"> hostname</font><font color="#E5E5E5"> that it's running</font>

382
00:18:14,140 --> 00:18:19,450
on<font color="#E5E5E5"> oh one other</font><font color="#CCCCCC"> thing that</font><font color="#E5E5E5"> I forgot</font><font color="#CCCCCC"> to</font>

383
00:18:16,299 --> 00:18:23,559
<font color="#E5E5E5">mention</font><font color="#CCCCCC"> before was that</font><font color="#E5E5E5"> before when</font>

384
00:18:19,450 --> 00:18:24,940
we're talking<font color="#CCCCCC"> about the in terms of why</font>

385
00:18:23,559 --> 00:18:27,010
it's a good channel<font color="#E5E5E5"> is because we're not</font>

386
00:18:24,940 --> 00:18:30,000
actually established any<font color="#E5E5E5"> logging events</font>

387
00:18:27,010 --> 00:18:33,158
when<font color="#E5E5E5"> we're running when a user runs this</font>

388
00:18:30,000 --> 00:18:34,600
this bot<font color="#E5E5E5"> basically it sort of tags</font><font color="#CCCCCC"> onto</font>

389
00:18:33,159 --> 00:18:35,950
<font color="#CCCCCC">their own</font><font color="#E5E5E5"> credentials so you don't get</font>

390
00:18:34,600 --> 00:18:41,110
<font color="#CCCCCC">log on events so that's just another</font>

391
00:18:35,950 --> 00:18:43,600
<font color="#CCCCCC">thing that's interesting now so the info</font>

392
00:18:41,110 --> 00:18:46,389
attribute is what we use<font color="#E5E5E5"> to send can</font>

393
00:18:43,600 --> 00:18:49,379
command and control and then other

394
00:18:46,390 --> 00:18:54,730
attributes we use as data channels so

395
00:18:49,380 --> 00:18:59,890
for sending<font color="#CCCCCC"> data and such oh here we go</font>

396
00:18:54,730 --> 00:19:03,820
bot registration so as I said before<font color="#E5E5E5"> you</font>

397
00:18:59,890 --> 00:19:06,190
<font color="#E5E5E5">know the you</font><font color="#CCCCCC"> know the Goodes with</font><font color="#E5E5E5"> the IP</font>

398
00:19:03,820 --> 00:19:12,570
<font color="#CCCCCC">Phone and the command outputs</font><font color="#E5E5E5"> through</font>

399
00:19:06,190 --> 00:19:12,570
other variables okay

400
00:19:15,419 --> 00:19:20,339
so there's a graphical and sort<font color="#E5E5E5"> of</font>

401
00:19:18,149 --> 00:19:23,458
representation<font color="#CCCCCC"> of the</font><font color="#E5E5E5"> registration</font>

402
00:19:20,339 --> 00:19:25,979
<font color="#E5E5E5">process so you've got the the gooood and</font>

403
00:19:23,459 --> 00:19:30,719
the info attribute and it sort of sets

404
00:19:25,979 --> 00:19:32,969
itself<font color="#E5E5E5"> into like like</font><font color="#CCCCCC"> a waiting State so</font>

405
00:19:30,719 --> 00:19:36,570
basically we've tried<font color="#CCCCCC"> to make</font><font color="#E5E5E5"> it quite</font>

406
00:19:32,969 --> 00:19:38,849
stateful so when when it<font color="#E5E5E5"> initially sets</font>

407
00:19:36,570 --> 00:19:42,658
itself up<font color="#E5E5E5"> it gets into like</font><font color="#CCCCCC"> a wait state</font>

408
00:19:38,849 --> 00:19:45,208
waiting for instructions<font color="#CCCCCC"> and other nodes</font>

409
00:19:42,659 --> 00:19:47,969
can communicate<font color="#CCCCCC"> with it</font><font color="#E5E5E5"> when it's in</font>

410
00:19:45,209 --> 00:19:49,919
<font color="#CCCCCC">that state but when it's actually</font>

411
00:19:47,969 --> 00:19:53,969
operating on an instruction it goes into

412
00:19:49,919 --> 00:19:55,409
<font color="#CCCCCC">another</font><font color="#E5E5E5"> state and then the other nodes</font>

413
00:19:53,969 --> 00:20:02,299
have to wait<font color="#E5E5E5"> until it gets out of that</font>

414
00:19:55,409 --> 00:20:02,299
<font color="#E5E5E5">state before it can communicate</font><font color="#CCCCCC"> okay</font>

415
00:20:05,149 --> 00:20:11,428
<font color="#E5E5E5">okay you want to do a demo or no yeah</font>

416
00:20:09,059 --> 00:20:14,269
<font color="#E5E5E5">okay</font><font color="#CCCCCC"> just keeps going through</font><font color="#E5E5E5"> all</font><font color="#CCCCCC"> right</font>

417
00:20:11,429 --> 00:20:18,659
so some of<font color="#E5E5E5"> the functionality we've got</font>

418
00:20:14,269 --> 00:20:21,599
within<font color="#E5E5E5"> the application is like obviously</font>

419
00:20:18,659 --> 00:20:24,269
<font color="#E5E5E5">we want to know which nodes we've got</font>

420
00:20:21,599 --> 00:20:26,279
<font color="#E5E5E5">infected in the network</font><font color="#CCCCCC"> so like we've</font>

421
00:20:24,269 --> 00:20:28,829
got like a controller which we can set

422
00:20:26,279 --> 00:20:35,429
up<font color="#E5E5E5"> which can actually deliver commands</font>

423
00:20:28,829 --> 00:20:37,499
throughout the network<font color="#E5E5E5"> and so we one</font><font color="#CCCCCC"> of</font>

424
00:20:35,429 --> 00:20:40,409
<font color="#CCCCCC">the</font><font color="#E5E5E5"> things we can do is</font><font color="#CCCCCC"> actually list</font>

425
00:20:37,499 --> 00:20:43,529
all the nodes in the network who are

426
00:20:40,409 --> 00:20:50,940
actually<font color="#CCCCCC"> infected</font><font color="#E5E5E5"> so that we can then</font>

427
00:20:43,529 --> 00:20:53,399
direct commands to them so we can yeah

428
00:20:50,940 --> 00:20:56,149
we can display the the username and the

429
00:20:53,399 --> 00:21:02,099
<font color="#E5E5E5">the host name and stuff of the</font><font color="#CCCCCC"> of the</font>

430
00:20:56,149 --> 00:21:04,320
systems which are infected so basically

431
00:21:02,099 --> 00:21:06,599
this<font color="#CCCCCC"> is really what what happens you</font>

432
00:21:04,320 --> 00:21:08,249
know<font color="#E5E5E5"> like we've got numbers of different</font>

433
00:21:06,599 --> 00:21:09,928
hosts on the network<font color="#E5E5E5"> which might be</font>

434
00:21:08,249 --> 00:21:14,009
infected<font color="#E5E5E5"> and</font><font color="#CCCCCC"> there might be</font><font color="#E5E5E5"> all in</font>

435
00:21:09,929 --> 00:21:17,340
different security zones and<font color="#E5E5E5"> we can see</font>

436
00:21:14,009 --> 00:21:20,290
from<font color="#E5E5E5"> our perspective of the</font>

437
00:21:17,340 --> 00:21:22,240
the control<font color="#E5E5E5"> panel we get a listing of</font>

438
00:21:20,290 --> 00:21:25,360
each of the nodes<font color="#E5E5E5"> the user accounts</font>

439
00:21:22,240 --> 00:21:27,640
which are you know<font color="#E5E5E5"> affected and also the</font>

440
00:21:25,360 --> 00:21:29,199
<font color="#E5E5E5">the host name of the box that they're</font>

441
00:21:27,640 --> 00:21:31,690
<font color="#E5E5E5">running at we really we've got that</font>

442
00:21:29,200 --> 00:21:33,549
there<font color="#E5E5E5"> because obviously</font><font color="#CCCCCC"> with multi-user</font>

443
00:21:31,690 --> 00:21:37,770
systems you could have<font color="#CCCCCC"> multiple users</font><font color="#E5E5E5"> on</font>

444
00:21:33,549 --> 00:21:37,770
<font color="#E5E5E5">the same box which are infected as well</font>

445
00:21:40,020 --> 00:21:45,670
so<font color="#E5E5E5"> I guess the</font><font color="#CCCCCC"> initial the initial</font><font color="#E5E5E5"> stage</font>

446
00:21:43,990 --> 00:21:48,220
is when we started<font color="#CCCCCC"> testing</font><font color="#E5E5E5"> this the</font>

447
00:21:45,670 --> 00:21:51,059
first thing<font color="#CCCCCC"> we obviously did was to</font><font color="#E5E5E5"> set</font>

448
00:21:48,220 --> 00:21:57,010
<font color="#E5E5E5">up functionality to send commands</font><font color="#CCCCCC"> to the</font>

449
00:21:51,059 --> 00:21:59,020
to the bots so from the controller we

450
00:21:57,010 --> 00:22:05,679
can<font color="#E5E5E5"> we can actually control</font><font color="#CCCCCC"> that and</font>

451
00:21:59,020 --> 00:22:07,660
send<font color="#E5E5E5"> numbers of commands I mean the way</font>

452
00:22:05,679 --> 00:22:10,179
<font color="#E5E5E5">that it kind of works is we've got like</font>

453
00:22:07,660 --> 00:22:13,000
the protocol we've got like the the

454
00:22:10,179 --> 00:22:15,040
<font color="#CCCCCC">username host name</font><font color="#E5E5E5"> we've got then the</font>

455
00:22:13,000 --> 00:22:17,710
type of command that<font color="#CCCCCC"> what needs to be</font>

456
00:22:15,040 --> 00:22:21,040
run<font color="#E5E5E5"> and then we've got the</font><font color="#CCCCCC"> the</font>

457
00:22:17,710 --> 00:22:23,110
destination user and host<font color="#E5E5E5"> that the</font>

458
00:22:21,040 --> 00:22:29,520
<font color="#E5E5E5">system is going</font><font color="#CCCCCC"> to be run on</font><font color="#E5E5E5"> so what</font>

459
00:22:23,110 --> 00:22:31,689
happens is that<font color="#E5E5E5"> each each you like node</font>

460
00:22:29,520 --> 00:22:34,600
<font color="#CCCCCC">can only really write to its own</font>

461
00:22:31,690 --> 00:22:36,880
properties but what it does<font color="#E5E5E5"> it writes to</font>

462
00:22:34,600 --> 00:22:39,250
<font color="#E5E5E5">its own command can control attribute</font>

463
00:22:36,880 --> 00:22:41,890
which<font color="#CCCCCC"> is the info attribute and it says</font>

464
00:22:39,250 --> 00:22:43,870
you<font color="#E5E5E5"> know this is like</font><font color="#CCCCCC"> the destination</font>

465
00:22:41,890 --> 00:22:46,840
host<font color="#E5E5E5"> that I want to run the command on</font>

466
00:22:43,870 --> 00:22:50,678
each<font color="#CCCCCC"> of the other</font><font color="#E5E5E5"> nodes will be</font><font color="#CCCCCC"> polling</font>

467
00:22:46,840 --> 00:22:52,990
ad looking for<font color="#CCCCCC"> commands which</font><font color="#E5E5E5"> are being</font>

468
00:22:50,679 --> 00:22:55,870
directed towards them and if it sees

469
00:22:52,990 --> 00:22:57,730
within somebody<font color="#E5E5E5"> else's info attribute</font>

470
00:22:55,870 --> 00:23:02,379
that it's saying<font color="#E5E5E5"> look I want</font><font color="#CCCCCC"> you to run</font>

471
00:22:57,730 --> 00:23:05,470
a command<font color="#E5E5E5"> and on you then it will grab</font>

472
00:23:02,380 --> 00:23:08,200
the command from that other attribute<font color="#CCCCCC"> it</font>

473
00:23:05,470 --> 00:23:10,510
<font color="#E5E5E5">will run it and then send the command</font>

474
00:23:08,200 --> 00:23:13,240
attribute or<font color="#CCCCCC"> the command output sorry to</font>

475
00:23:10,510 --> 00:23:15,600
that node<font color="#E5E5E5"> so that's basically what</font>

476
00:23:13,240 --> 00:23:15,600
happens

477
00:23:21,060 --> 00:23:27,070
so yeah basically<font color="#E5E5E5"> you know all</font><font color="#CCCCCC"> of the</font>

478
00:23:24,220 --> 00:23:31,990
output<font color="#CCCCCC"> and commands are all encoded in</font>

479
00:23:27,070 --> 00:23:36,010
base64<font color="#E5E5E5"> just to make it safer and you</font>

480
00:23:31,990 --> 00:23:42,790
know<font color="#CCCCCC"> prevent you</font><font color="#E5E5E5"> know issues in the</font>

481
00:23:36,010 --> 00:23:45,640
delivery of the the data<font color="#E5E5E5"> yeah so then</font>

482
00:23:42,790 --> 00:23:48,460
basically<font color="#E5E5E5"> we've</font><font color="#CCCCCC"> got the initial the</font>

483
00:23:45,640 --> 00:23:50,830
<font color="#CCCCCC">initial sort of commands are just like</font>

484
00:23:48,460 --> 00:23:52,480
<font color="#E5E5E5">running a single command</font><font color="#CCCCCC"> we've got like</font>

485
00:23:50,830 --> 00:23:54,129
a<font color="#E5E5E5"> simulated shell which is</font><font color="#CCCCCC"> just</font>

486
00:23:52,480 --> 00:23:56,320
<font color="#CCCCCC">basically just the same command with</font>

487
00:23:54,130 --> 00:23:59,440
that loops<font color="#E5E5E5"> around and just allows you to</font>

488
00:23:56,320 --> 00:24:13,210
<font color="#E5E5E5">simulate</font><font color="#CCCCCC"> you know a shell on the remote</font>

489
00:23:59,440 --> 00:24:14,890
system this just steps you through<font color="#E5E5E5"> it</font>

490
00:24:13,210 --> 00:24:17,230
<font color="#CCCCCC">just graphically</font><font color="#E5E5E5"> each of the different</font>

491
00:24:14,890 --> 00:24:19,390
<font color="#CCCCCC">steps</font><font color="#E5E5E5"> and the type of data that is being</font>

492
00:24:17,230 --> 00:24:23,700
<font color="#CCCCCC">passed through</font><font color="#E5E5E5"> the attributes for the</font>

493
00:24:19,390 --> 00:24:23,700
commands<font color="#E5E5E5"> to be run yep</font>

494
00:24:26,340 --> 00:24:32,530
so then the next<font color="#E5E5E5"> the</font><font color="#CCCCCC"> next sort of</font>

495
00:24:29,380 --> 00:24:34,390
commands we sort<font color="#E5E5E5"> of looked at because we</font>

496
00:24:32,530 --> 00:24:36,730
we thought you know you know<font color="#E5E5E5"> people put</font>

497
00:24:34,390 --> 00:24:39,390
security boundaries in<font color="#CCCCCC"> place to</font><font color="#E5E5E5"> stop you</font>

498
00:24:36,730 --> 00:24:41,830
know files being<font color="#CCCCCC"> uploaded and downloaded</font>

499
00:24:39,390 --> 00:24:44,140
from systems within<font color="#CCCCCC"> the network you know</font>

500
00:24:41,830 --> 00:24:45,879
<font color="#E5E5E5">because you might have highly sensitive</font>

501
00:24:44,140 --> 00:24:48,160
information<font color="#CCCCCC"> you know you know</font><font color="#E5E5E5"> highly</font>

502
00:24:45,880 --> 00:24:51,700
segmented<font color="#CCCCCC"> network so what we then did</font>

503
00:24:48,160 --> 00:24:54,370
was<font color="#CCCCCC"> we set up</font><font color="#E5E5E5"> a functionality</font><font color="#CCCCCC"> so that we</font>

504
00:24:51,700 --> 00:24:58,300
could do file transfers using<font color="#CCCCCC"> the</font>

505
00:24:54,370 --> 00:25:01,780
attributes so basically<font color="#E5E5E5"> it's just</font>

506
00:24:58,300 --> 00:25:04,810
basically another<font color="#E5E5E5"> type of command within</font>

507
00:25:01,780 --> 00:25:08,830
the control<font color="#CCCCCC"> commander</font><font color="#E5E5E5"> control channel</font>

508
00:25:04,810 --> 00:25:11,470
and it just uses different attributes

509
00:25:08,830 --> 00:25:14,220
<font color="#E5E5E5">normally large wrapped tributes</font><font color="#CCCCCC"> the the</font>

510
00:25:11,470 --> 00:25:17,309
ones that are you know

511
00:25:14,220 --> 00:25:19,639
the larger in size like<font color="#E5E5E5"> the</font><font color="#CCCCCC"> M sqm</font>

512
00:25:17,309 --> 00:25:23,070
science certificates<font color="#E5E5E5"> is a good one</font><font color="#CCCCCC"> for</font>

513
00:25:19,639 --> 00:25:26,100
delivering<font color="#E5E5E5"> files and stuff because it's</font>

514
00:25:23,070 --> 00:25:29,100
you<font color="#CCCCCC"> know one megabyte in size</font><font color="#E5E5E5"> and so</font>

515
00:25:26,100 --> 00:25:34,918
basically it<font color="#CCCCCC"> just works by in the same</font>

516
00:25:29,100 --> 00:25:36,990
way<font color="#CCCCCC"> just by cutting the file</font><font color="#E5E5E5"> into the</font>

517
00:25:34,919 --> 00:25:40,169
chunks which are the you know<font color="#E5E5E5"> the size</font>

518
00:25:36,990 --> 00:25:44,120
of<font color="#CCCCCC"> the</font><font color="#E5E5E5"> attribute and sending them</font>

519
00:25:40,169 --> 00:25:46,649
<font color="#CCCCCC">through the node</font><font color="#E5E5E5"> on the other side will</font>

520
00:25:44,120 --> 00:25:51,239
receive a packet then it'll knowledge

521
00:25:46,649 --> 00:25:53,459
the packet the<font color="#E5E5E5"> like the note on</font><font color="#CCCCCC"> the</font>

522
00:25:51,240 --> 00:25:54,990
<font color="#E5E5E5">other side will not send the next packet</font>

523
00:25:53,460 --> 00:25:56,909
until it<font color="#CCCCCC"> receives an acknowledgment</font><font color="#E5E5E5"> and</font>

524
00:25:54,990 --> 00:26:02,879
then it goes<font color="#E5E5E5"> like that until basically</font>

525
00:25:56,909 --> 00:26:07,039
<font color="#E5E5E5">the</font><font color="#CCCCCC"> entire files being sent through</font><font color="#E5E5E5"> all</font>

526
00:26:02,879 --> 00:26:07,039
<font color="#E5E5E5">right okay so we'll do a bit of a demo</font>

527
00:26:20,820 --> 00:26:40,490
so so this one he is<font color="#E5E5E5"> like the</font>

528
00:26:27,630 --> 00:26:40,490
command-and-control<font color="#E5E5E5"> okay</font>

529
00:26:41,420 --> 00:26:49,340
<font color="#CCCCCC">how because they</font><font color="#E5E5E5"> don't put on so</font>

530
00:26:46,670 --> 00:26:52,880
<font color="#E5E5E5">basically what we can do we can as I</font>

531
00:26:49,340 --> 00:26:57,050
<font color="#CCCCCC">said</font><font color="#E5E5E5"> before we can list the members of</font>

532
00:26:52,880 --> 00:27:00,800
<font color="#E5E5E5">the the</font><font color="#CCCCCC"> botnet</font><font color="#E5E5E5"> so you can sort of see</font>

533
00:26:57,050 --> 00:27:04,129
there that<font color="#CCCCCC"> we've got like like a few</font>

534
00:27:00,800 --> 00:27:06,290
users<font color="#CCCCCC"> there staff one on</font><font color="#E5E5E5"> win whatever</font>

535
00:27:04,130 --> 00:27:12,260
<font color="#E5E5E5">that is we've got staff</font><font color="#CCCCCC"> two and staff</font>

536
00:27:06,290 --> 00:27:16,270
three and start<font color="#CCCCCC"> four so each of</font><font color="#E5E5E5"> those</font>

537
00:27:12,260 --> 00:27:20,030
you<font color="#CCCCCC"> know systems has got you</font><font color="#E5E5E5"> know I</font>

538
00:27:16,270 --> 00:27:22,040
bought running on it so now that we<font color="#CCCCCC"> know</font>

539
00:27:20,030 --> 00:27:24,470
which ones<font color="#E5E5E5"> are effective we can</font><font color="#CCCCCC"> actually</font>

540
00:27:22,040 --> 00:27:27,020
send a command through to one of the

541
00:27:24,470 --> 00:27:28,790
nodes<font color="#CCCCCC"> so these</font><font color="#E5E5E5"> systems are actually</font><font color="#CCCCCC"> on</font>

542
00:27:27,020 --> 00:27:30,350
<font color="#E5E5E5">different in different security zones</font>

543
00:27:28,790 --> 00:27:33,470
and they can't communicate with each

544
00:27:30,350 --> 00:27:39,159
other directly<font color="#CCCCCC"> so they have to go via ad</font>

545
00:27:33,470 --> 00:27:42,050
<font color="#E5E5E5">yep so then what we can do I can select</font>

546
00:27:39,160 --> 00:27:44,750
one of the exact bots to be sending

547
00:27:42,050 --> 00:27:48,649
commands to<font color="#E5E5E5"> so we'll select the second</font>

548
00:27:44,750 --> 00:27:50,960
one<font color="#E5E5E5"> and</font><font color="#CCCCCC"> we'll enter the commands</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> we</font>

549
00:27:48,650 --> 00:27:53,900
can see<font color="#E5E5E5"> that the the users called staff</font>

550
00:27:50,960 --> 00:27:55,730
<font color="#CCCCCC">too so what we can do we can enter a</font>

551
00:27:53,900 --> 00:28:00,530
<font color="#E5E5E5">command we can say look I want</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> get a</font>

552
00:27:55,730 --> 00:28:02,770
listing of this users<font color="#E5E5E5"> downloads</font>

553
00:28:00,530 --> 00:28:02,770
directory

554
00:28:10,910 --> 00:28:15,290
and you can see this is the sort of

555
00:28:13,410 --> 00:28:19,410
<font color="#E5E5E5">commands that are sort of going</font><font color="#CCCCCC"> through</font>

556
00:28:15,290 --> 00:28:21,870
<font color="#E5E5E5">in the protocol we sort of printed them</font>

557
00:28:19,410 --> 00:28:23,429
out so<font color="#CCCCCC"> you</font><font color="#E5E5E5"> could see it and although</font>

558
00:28:21,870 --> 00:28:25,889
<font color="#E5E5E5">it's hard to see and all that sort of</font>

559
00:28:23,429 --> 00:28:27,840
command<font color="#CCCCCC"> output there you can see that in</font>

560
00:28:25,890 --> 00:28:29,970
the in<font color="#E5E5E5"> the users directory just here</font>

561
00:28:27,840 --> 00:28:33,809
there's a couple<font color="#E5E5E5"> of files ones like</font>

562
00:28:29,970 --> 00:28:37,920
credit card<font color="#E5E5E5"> text</font><font color="#CCCCCC"> and so what we</font><font color="#E5E5E5"> can do</font>

563
00:28:33,809 --> 00:28:42,210
now I'll download that into<font color="#E5E5E5"> my download</font>

564
00:28:37,920 --> 00:28:48,530
directories on this machine using<font color="#E5E5E5"> the</font>

565
00:28:42,210 --> 00:28:53,929
functionality<font color="#E5E5E5"> within the within the bot</font>

566
00:28:48,530 --> 00:28:53,928
so we want to grab it<font color="#CCCCCC"> from staff too</font>

567
00:29:12,660 --> 00:29:16,850
and<font color="#E5E5E5"> we'll</font><font color="#CCCCCC"> just stick it in</font><font color="#E5E5E5"> our downloads</font>

568
00:29:14,610 --> 00:29:16,850
directory

569
00:29:31,600 --> 00:29:36,908
so basically<font color="#CCCCCC"> that</font><font color="#E5E5E5"> will go away and</font>

570
00:29:33,809 --> 00:29:41,190
upload the file<font color="#CCCCCC"> that</font><font color="#E5E5E5"> should pop up in</font>

571
00:29:36,909 --> 00:29:41,190
<font color="#E5E5E5">this directory hopefully</font>

572
00:29:48,600 --> 00:29:54,300
there we go so you can see you know

573
00:29:51,600 --> 00:29:56,070
through the network boundaries we can

574
00:29:54,300 --> 00:29:59,510
you know upload upload and download

575
00:29:56,070 --> 00:30:04,139
<font color="#E5E5E5">files and and do all</font><font color="#CCCCCC"> that sort</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> stuff</font>

576
00:29:59,510 --> 00:30:06,350
<font color="#CCCCCC">through that</font><font color="#E5E5E5"> yeah</font><font color="#CCCCCC"> choke on to the next</font>

577
00:30:04,140 --> 00:30:06,350
part

578
00:30:17,900 --> 00:30:24,570
<font color="#CCCCCC">alright thanks mate so now you can see</font>

579
00:30:22,200 --> 00:30:27,840
that we<font color="#CCCCCC"> can bypass all the</font><font color="#E5E5E5"> network</font>

580
00:30:24,570 --> 00:30:29,730
<font color="#E5E5E5">access controls any firewall rules just</font>

581
00:30:27,840 --> 00:30:32,429
<font color="#E5E5E5">by tunneling everything through ad</font>

582
00:30:29,730 --> 00:30:36,840
attributes and be<font color="#CCCCCC"> able</font><font color="#E5E5E5"> to even transfer</font>

583
00:30:32,430 --> 00:30:40,980
files around<font color="#E5E5E5"> the network</font><font color="#CCCCCC"> we also looked</font>

584
00:30:36,840 --> 00:30:47,010
at trying<font color="#E5E5E5"> to see what options we have</font>

585
00:30:40,980 --> 00:30:51,780
with<font color="#E5E5E5"> Azua ad which</font><font color="#CCCCCC"> microsoft provide and</font>

586
00:30:47,010 --> 00:30:55,800
<font color="#CCCCCC">ZOA cloud-hosted api into your active</font>

587
00:30:51,780 --> 00:30:59,310
directory which is<font color="#CCCCCC"> known as graph api so</font>

588
00:30:55,800 --> 00:31:02,879
this basically<font color="#E5E5E5"> lets you</font><font color="#CCCCCC"> interact</font><font color="#E5E5E5"> from</font>

589
00:30:59,310 --> 00:31:05,940
the<font color="#CCCCCC"> internet through an API directly to</font>

590
00:31:02,880 --> 00:31:08,930
your<font color="#E5E5E5"> active directory so that</font><font color="#CCCCCC"> basically</font>

591
00:31:05,940 --> 00:31:12,660
exposes your<font color="#E5E5E5"> ad to</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> Internet and you</font>

592
00:31:08,930 --> 00:31:15,600
<font color="#CCCCCC">can</font><font color="#E5E5E5"> access that as any standard user</font>

593
00:31:12,660 --> 00:31:18,630
within<font color="#E5E5E5"> your</font><font color="#CCCCCC"> organization</font><font color="#E5E5E5"> which means</font>

594
00:31:15,600 --> 00:31:20,850
that we were obviously<font color="#E5E5E5"> looking</font><font color="#CCCCCC"> at</font><font color="#E5E5E5"> a</font>

595
00:31:18,630 --> 00:31:23,390
trying to get a two-way<font color="#CCCCCC"> communication</font>

596
00:31:20,850 --> 00:31:25,469
channel from<font color="#CCCCCC"> the Internet via</font><font color="#E5E5E5"> this</font>

597
00:31:23,390 --> 00:31:28,170
<font color="#E5E5E5">unfortunately a couple of years ago they</font>

598
00:31:25,470 --> 00:31:30,390
disabled<font color="#E5E5E5"> the user attributes sinking</font>

599
00:31:28,170 --> 00:31:32,940
from<font color="#CCCCCC"> Azur back to your on-premise</font>

600
00:31:30,390 --> 00:31:34,470
environment so that<font color="#E5E5E5"> unfortunately</font>

601
00:31:32,940 --> 00:31:36,120
stopped us from<font color="#E5E5E5"> getting the two-way</font>

602
00:31:34,470 --> 00:31:38,700
communication channel through that

603
00:31:36,120 --> 00:31:41,699
however it does<font color="#CCCCCC"> obviously allow</font>

604
00:31:38,700 --> 00:31:45,030
on-premise ad attributes to be synced to

605
00:31:41,700 --> 00:31:48,780
<font color="#CCCCCC">the Azua</font><font color="#E5E5E5"> ad and then accessed through</font>

606
00:31:45,030 --> 00:31:52,440
<font color="#E5E5E5">the graph</font><font color="#CCCCCC"> api</font><font color="#E5E5E5"> which means that if you</font>

607
00:31:48,780 --> 00:31:55,170
get<font color="#E5E5E5"> your internal ad botnet you can then</font>

608
00:31:52,440 --> 00:31:58,230
have your<font color="#E5E5E5"> botnets start grabbing data</font>

609
00:31:55,170 --> 00:32:01,050
<font color="#E5E5E5">such</font><font color="#CCCCCC"> as these files pushing them into</font>

610
00:31:58,230 --> 00:32:02,260
particular<font color="#CCCCCC"> what we call exfiltration</font>

611
00:32:01,050 --> 00:32:05,409
attributes

612
00:32:02,260 --> 00:32:07,990
they get synced up to<font color="#CCCCCC"> Azur ad and then</font>

613
00:32:05,410 --> 00:32:09,940
we can as a standard user account<font color="#E5E5E5"> just</font>

614
00:32:07,990 --> 00:32:15,280
start<font color="#CCCCCC"> extracting those directly</font><font color="#E5E5E5"> from the</font>

615
00:32:09,940 --> 00:32:19,750
internet<font color="#CCCCCC"> via graph API so we've got a</font>

616
00:32:15,280 --> 00:32:21,670
feature called<font color="#CCCCCC"> XML trade data so as I</font>

617
00:32:19,750 --> 00:32:23,220
said the button air pushes data into an

618
00:32:21,670 --> 00:32:25,840
<font color="#CCCCCC">attribute</font><font color="#E5E5E5"> sinks into ad your</font>

619
00:32:23,220 --> 00:32:29,740
<font color="#CCCCCC">authenticators</font><font color="#E5E5E5"> a standard user to graph</font>

620
00:32:25,840 --> 00:32:32,199
<font color="#CCCCCC">API you list out the</font><font color="#E5E5E5"> user attributes</font><font color="#CCCCCC"> and</font>

621
00:32:29,740 --> 00:32:35,050
then you can grab<font color="#CCCCCC"> the values from</font><font color="#E5E5E5"> those</font>

622
00:32:32,200 --> 00:32:39,040
to basically<font color="#E5E5E5"> keep pulling all</font><font color="#CCCCCC"> your data</font>

623
00:32:35,050 --> 00:32:43,300
out so you can<font color="#E5E5E5"> see the export rate data</font>

624
00:32:39,040 --> 00:32:45,580
option<font color="#E5E5E5"> there so</font><font color="#CCCCCC"> this is just</font><font color="#E5E5E5"> a graphical</font>

625
00:32:43,300 --> 00:32:48,100
representation of that so you can see

626
00:32:45,580 --> 00:32:49,899
<font color="#E5E5E5">that the bots can obviously communicate</font>

627
00:32:48,100 --> 00:32:53,040
with the<font color="#E5E5E5"> domain controller and</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> sends</font>

628
00:32:49,900 --> 00:32:55,210
<font color="#E5E5E5">it out via razaw and then the attacker</font>

629
00:32:53,040 --> 00:32:58,750
<font color="#CCCCCC">pretty guy in the top left-hand</font><font color="#E5E5E5"> corner</font>

630
00:32:55,210 --> 00:33:05,020
<font color="#E5E5E5">there can obviously connect to graph</font><font color="#CCCCCC"> api</font>

631
00:32:58,750 --> 00:33:07,420
and<font color="#E5E5E5"> then and then pull that out so since</font>

632
00:33:05,020 --> 00:33:11,950
our two-way communication channel<font color="#E5E5E5"> god</font>

633
00:33:07,420 --> 00:33:14,920
shut down<font color="#E5E5E5"> through</font><font color="#CCCCCC"> Azur ad we then wanted</font>

634
00:33:11,950 --> 00:33:19,210
to have other command and control

635
00:33:14,920 --> 00:33:22,480
options so<font color="#E5E5E5"> we implemented an ad</font><font color="#CCCCCC"> bot net</font>

636
00:33:19,210 --> 00:33:28,780
<font color="#E5E5E5">reverse</font><font color="#CCCCCC"> tcp Handler</font><font color="#E5E5E5"> and basically what</font>

637
00:33:22,480 --> 00:33:32,410
this does is it<font color="#E5E5E5"> allows</font><font color="#CCCCCC"> you to have we go</font>

638
00:33:28,780 --> 00:33:36,149
back to I guess this<font color="#E5E5E5"> you could have for</font>

639
00:33:32,410 --> 00:33:39,600
example<font color="#E5E5E5"> your bot on the</font><font color="#CCCCCC"> left hand</font><font color="#E5E5E5"> side</font>

640
00:33:36,150 --> 00:33:43,120
<font color="#CCCCCC">issue the command that he wants to</font>

641
00:33:39,600 --> 00:33:45,490
establish a connection back to<font color="#E5E5E5"> our</font>

642
00:33:43,120 --> 00:33:49,510
attacker out<font color="#E5E5E5"> on the</font><font color="#CCCCCC"> internet</font><font color="#E5E5E5"> by a TCP</font>

643
00:33:45,490 --> 00:33:50,800
<font color="#CCCCCC">channel at that</font><font color="#E5E5E5"> point on the on the bot</font>

644
00:33:49,510 --> 00:33:54,340
on the<font color="#CCCCCC"> left</font><font color="#E5E5E5"> hand side</font>

645
00:33:50,800 --> 00:33:59,290
he<font color="#CCCCCC"> basically sets up</font><font color="#E5E5E5"> a socket and he can</font>

646
00:33:54,340 --> 00:34:03,250
say I want<font color="#CCCCCC"> to port forward this socket</font>

647
00:33:59,290 --> 00:34:06,220
<font color="#E5E5E5">through Active Directory to the bot on</font>

648
00:34:03,250 --> 00:34:09,489
the right<font color="#E5E5E5"> hand side as if it's just</font><font color="#CCCCCC"> a</font>

649
00:34:06,220 --> 00:34:11,830
TCP connection<font color="#CCCCCC"> and then can issue that</font>

650
00:34:09,489 --> 00:34:14,029
but on<font color="#E5E5E5"> the right</font><font color="#CCCCCC"> hand side to</font><font color="#E5E5E5"> start</font>

651
00:34:11,830 --> 00:34:18,049
connecting to any other system<font color="#E5E5E5"> in</font>

652
00:34:14,030 --> 00:34:20,270
<font color="#E5E5E5">network so basically bypasses not just</font>

653
00:34:18,050 --> 00:34:23,260
your<font color="#E5E5E5"> internal</font><font color="#CCCCCC"> access network access</font>

654
00:34:20,270 --> 00:34:26,360
controls but basically exposes a socket

655
00:34:23,260 --> 00:34:29,570
<font color="#E5E5E5">from the guy out on the</font><font color="#CCCCCC"> Internet</font>

656
00:34:26,360 --> 00:34:31,669
<font color="#E5E5E5">through to a socket on your internal</font>

657
00:34:29,570 --> 00:34:37,460
network<font color="#E5E5E5"> through different machines and</font>

658
00:34:31,668 --> 00:34:41,359
<font color="#E5E5E5">through your Active Directory</font><font color="#CCCCCC"> the other</font>

659
00:34:37,460 --> 00:34:43,879
one is the<font color="#CCCCCC"> reverse</font><font color="#E5E5E5"> so you've got</font><font color="#CCCCCC"> your</font>

660
00:34:41,360 --> 00:34:46,610
<font color="#CCCCCC">buy-in tcp handler so they connect back</font>

661
00:34:43,879 --> 00:34:48,199
<font color="#CCCCCC">obviously connects to the internet</font><font color="#E5E5E5"> if</font>

662
00:34:46,610 --> 00:34:50,960
you've got out down firewall rules

663
00:34:48,199 --> 00:34:53,299
preventing that<font color="#CCCCCC"> from connecting out but</font>

664
00:34:50,960 --> 00:34:56,060
you might have for example<font color="#E5E5E5"> a bot within</font>

665
00:34:53,300 --> 00:34:58,040
your<font color="#CCCCCC"> dmz that's compromised and you have</font>

666
00:34:56,060 --> 00:35:00,320
a not open port through your firewall

667
00:34:58,040 --> 00:35:02,210
which is quite<font color="#E5E5E5"> common you</font><font color="#CCCCCC"> know if you're</font>

668
00:35:00,320 --> 00:35:04,490
under<font color="#E5E5E5"> their</font><font color="#CCCCCC"> maps can</font><font color="#E5E5E5"> you get a closed</font>

669
00:35:02,210 --> 00:35:07,970
port then obviously the<font color="#CCCCCC"> bots can set up</font>

670
00:35:04,490 --> 00:35:11,330
a bind<font color="#CCCCCC"> port</font><font color="#E5E5E5"> on there so that you can</font>

671
00:35:07,970 --> 00:35:13,819
<font color="#CCCCCC">establish a TCP connection from the</font>

672
00:35:11,330 --> 00:35:16,549
<font color="#E5E5E5">internet to your bite and again that</font>

673
00:35:13,820 --> 00:35:20,080
<font color="#E5E5E5">basically just</font><font color="#CCCCCC"> pour</font><font color="#E5E5E5"> forwards that socket</font>

674
00:35:16,550 --> 00:35:27,020
to any system<font color="#CCCCCC"> on your</font><font color="#E5E5E5"> internal network</font>

675
00:35:20,080 --> 00:35:34,400
<font color="#E5E5E5">so let's try and do that live</font><font color="#CCCCCC"> alright</font><font color="#E5E5E5"> so</font>

676
00:35:27,020 --> 00:35:36,950
we've got our<font color="#E5E5E5"> bot here and sorry</font><font color="#CCCCCC"> about</font>

677
00:35:34,400 --> 00:35:38,960
<font color="#CCCCCC">the size I won't</font><font color="#E5E5E5"> mess with it right</font><font color="#CCCCCC"> now</font>

678
00:35:36,950 --> 00:35:41,450
it's<font color="#E5E5E5"> not it's not overly important but</font>

679
00:35:38,960 --> 00:35:45,080
<font color="#E5E5E5">there's basically two</font><font color="#CCCCCC"> options there one</font>

680
00:35:41,450 --> 00:35:46,910
is the that we're<font color="#CCCCCC"> talking</font><font color="#E5E5E5"> about one is</font>

681
00:35:45,080 --> 00:35:50,330
<font color="#E5E5E5">the bind handler and one is the reverse</font>

682
00:35:46,910 --> 00:35:53,600
<font color="#CCCCCC">TCP handler</font><font color="#E5E5E5"> so we're going</font><font color="#CCCCCC"> to start with</font>

683
00:35:50,330 --> 00:35:56,150
the reverse<font color="#E5E5E5"> TCP handler which is number</font>

684
00:35:53,600 --> 00:35:58,759
seven here it again lists out<font color="#E5E5E5"> the bots</font>

685
00:35:56,150 --> 00:36:02,030
<font color="#E5E5E5">and says which</font><font color="#CCCCCC"> bots do you want me to</font>

686
00:35:58,760 --> 00:36:05,330
<font color="#E5E5E5">forward this TCP channel through</font><font color="#CCCCCC"> ad to</font>

687
00:36:02,030 --> 00:36:12,760
so it lists<font color="#E5E5E5"> out your</font><font color="#CCCCCC"> bots</font><font color="#E5E5E5"> and I'm going</font>

688
00:36:05,330 --> 00:36:16,970
to<font color="#E5E5E5"> say I think it was number one</font>

689
00:36:12,760 --> 00:36:19,580
remember<font color="#E5E5E5"> we</font><font color="#CCCCCC"> were logged in er yeah let's</font>

690
00:36:16,970 --> 00:36:22,430
go<font color="#E5E5E5"> with</font><font color="#CCCCCC"> number one all right so then we</font>

691
00:36:19,580 --> 00:36:26,049
<font color="#CCCCCC">want it asks</font><font color="#E5E5E5"> us for our</font><font color="#CCCCCC"> controller</font><font color="#E5E5E5"> IP so</font>

692
00:36:22,430 --> 00:36:26,049
where do you want<font color="#E5E5E5"> to connect back to</font>

693
00:36:26,550 --> 00:36:31,810
and it's called<font color="#E5E5E5"> control it well port do</font>

694
00:36:30,730 --> 00:36:33,849
you want to connect back<font color="#CCCCCC"> to on the</font>

695
00:36:31,810 --> 00:36:39,790
<font color="#E5E5E5">controller so in this case we're going</font>

696
00:36:33,849 --> 00:36:42,400
to do<font color="#CCCCCC"> 4 4 4 4 so the target</font><font color="#E5E5E5"> IP is so</font>

697
00:36:39,790 --> 00:36:46,420
we've already said that<font color="#E5E5E5"> we want to open</font>

698
00:36:42,400 --> 00:36:49,000
up<font color="#CCCCCC"> port forward this socket through</font><font color="#E5E5E5"> ad</font><font color="#CCCCCC"> 2</font>

699
00:36:46,420 --> 00:36:51,940
this bot number 1<font color="#E5E5E5"> which is in a</font>

700
00:36:49,000 --> 00:36:56,220
<font color="#E5E5E5">completely different security zone</font><font color="#CCCCCC"> right</font>

701
00:36:51,940 --> 00:37:01,630
so our target IP<font color="#E5E5E5"> can either be a</font>

702
00:36:56,220 --> 00:37:03,640
listener on that machine<font color="#CCCCCC"> or it can</font><font color="#E5E5E5"> be in</font>

703
00:37:01,630 --> 00:37:05,619
<font color="#CCCCCC">another IP address</font><font color="#E5E5E5"> within that</font><font color="#CCCCCC"> network</font>

704
00:37:03,640 --> 00:37:10,299
so<font color="#CCCCCC"> we're just</font><font color="#E5E5E5"> going to do on that</font>

705
00:37:05,619 --> 00:37:14,130
<font color="#CCCCCC">machine itself</font><font color="#E5E5E5"> so we'll do</font><font color="#CCCCCC"> 1 27001 which</font>

706
00:37:10,300 --> 00:37:17,920
is the<font color="#E5E5E5"> local host of the remote bot and</font>

707
00:37:14,130 --> 00:37:22,869
the port that it's going<font color="#E5E5E5"> to be on which</font>

708
00:37:17,920 --> 00:37:24,940
is 4 4 4 4 before<font color="#CCCCCC"> we kick this off we</font>

709
00:37:22,869 --> 00:37:26,609
want<font color="#E5E5E5"> to obviously on our controller on</font>

710
00:37:24,940 --> 00:37:29,650
<font color="#CCCCCC">the internet</font><font color="#E5E5E5"> we want</font><font color="#CCCCCC"> to set up a</font>

711
00:37:26,609 --> 00:37:33,180
listener<font color="#E5E5E5"> so we're gonna use</font><font color="#CCCCCC"> Metasploit</font>

712
00:37:29,650 --> 00:37:36,400
for that<font color="#CCCCCC"> oops</font>

713
00:37:33,180 --> 00:37:39,250
options there we go so we're going to

714
00:37:36,400 --> 00:37:46,180
<font color="#E5E5E5">set up use the Metasploit multi handler</font>

715
00:37:39,250 --> 00:37:48,040
to<font color="#E5E5E5"> set up a 64-bit reverse</font><font color="#CCCCCC"> TCP handle</font>

716
00:37:46,180 --> 00:37:51,460
and that's basically just<font color="#E5E5E5"> going to</font>

717
00:37:48,040 --> 00:37:58,509
accept our TCP connection drop us to a

718
00:37:51,460 --> 00:38:06,210
<font color="#CCCCCC">Metasploit session so we've started up</font>

719
00:37:58,510 --> 00:38:11,339
<font color="#CCCCCC">Metasploit listener we then it's</font><font color="#E5E5E5"> okay</font>

720
00:38:06,210 --> 00:38:14,609
<font color="#E5E5E5">we've now established a connection to</font><font color="#CCCCCC"> a</font>

721
00:38:11,339 --> 00:38:18,549
<font color="#E5E5E5">remote attacker from our internal botnet</font>

722
00:38:14,609 --> 00:38:20,410
if we then<font color="#E5E5E5"> type a command you'll see</font>

723
00:38:18,550 --> 00:38:22,900
<font color="#E5E5E5">same sort of thing as Paul was</font>

724
00:38:20,410 --> 00:38:29,828
demonstrating all the different pieces

725
00:38:22,900 --> 00:38:32,380
<font color="#E5E5E5">of communication going past and there's</font>

726
00:38:29,829 --> 00:38:35,069
our shell<font color="#E5E5E5"> right so you can basically</font>

727
00:38:32,380 --> 00:38:39,119
that's a full shell that<font color="#CCCCCC"> you can just</font>

728
00:38:35,069 --> 00:38:44,050
keep<font color="#E5E5E5"> interacting with over the</font><font color="#CCCCCC"> internet</font>

729
00:38:39,119 --> 00:38:48,369
<font color="#E5E5E5">via an internal bot via</font><font color="#CCCCCC"> ad to any system</font>

730
00:38:44,050 --> 00:38:50,230
<font color="#CCCCCC">on</font><font color="#E5E5E5"> your internal</font><font color="#CCCCCC"> network and again</font>

731
00:38:48,369 --> 00:38:54,270
that'll just be throwing the data back

732
00:38:50,230 --> 00:38:54,270
and<font color="#E5E5E5"> forth and there we go</font>

733
00:38:54,569 --> 00:39:03,520
<font color="#E5E5E5">so we kill that connection</font><font color="#CCCCCC"> now</font><font color="#E5E5E5"> our block</font>

734
00:39:00,400 --> 00:39:06,099
controller then drops back<font color="#CCCCCC"> to you know</font>

735
00:39:03,520 --> 00:39:08,319
wanting to ask what we want to do so in

736
00:39:06,099 --> 00:39:10,780
this<font color="#E5E5E5"> case we're going to now set up a</font>

737
00:39:08,319 --> 00:39:14,650
bind<font color="#CCCCCC"> Handler and this is to demonstrate</font>

738
00:39:10,780 --> 00:39:18,040
the<font color="#E5E5E5"> DN Baron connection so if we type</font>

739
00:39:14,650 --> 00:39:20,740
number<font color="#E5E5E5"> six which is launch ID botnet by</font>

740
00:39:18,040 --> 00:39:25,329
<font color="#CCCCCC">an handler again we're</font><font color="#E5E5E5"> going to select</font>

741
00:39:20,740 --> 00:39:26,770
bot<font color="#E5E5E5"> 1</font><font color="#CCCCCC"> we're going to bind to</font><font color="#E5E5E5"> I mean this</font>

742
00:39:25,329 --> 00:39:28,540
would<font color="#CCCCCC"> be the port that</font><font color="#E5E5E5"> you know if</font>

743
00:39:26,770 --> 00:39:31,480
you've<font color="#CCCCCC"> done a port scan against your</font>

744
00:39:28,540 --> 00:39:35,140
external<font color="#CCCCCC"> IP address and you find a</font>

745
00:39:31,480 --> 00:39:38,440
closed port<font color="#E5E5E5"> on one of your</font><font color="#CCCCCC"> BOTS then you</font>

746
00:39:35,140 --> 00:39:40,540
can get<font color="#E5E5E5"> it to set</font><font color="#CCCCCC"> up a bot active</font>

747
00:39:38,440 --> 00:39:44,680
directory botnet<font color="#CCCCCC"> by and handle on that</font>

748
00:39:40,540 --> 00:39:46,930
port and<font color="#E5E5E5"> then we can basically as</font><font color="#CCCCCC"> I'm</font>

749
00:39:44,680 --> 00:39:50,470
<font color="#E5E5E5">saying that basically opens up your</font>

750
00:39:46,930 --> 00:39:52,660
internal network to any of your hosts so

751
00:39:50,470 --> 00:39:54,430
again we're<font color="#CCCCCC"> going to do 4 4 4 4</font>

752
00:39:52,660 --> 00:39:59,410
hopefully you guys don't open<font color="#E5E5E5"> your</font>

753
00:39:54,430 --> 00:40:02,279
firewalls up on the 4 4 4 4<font color="#E5E5E5"> again we're</font>

754
00:39:59,410 --> 00:40:07,540
going<font color="#E5E5E5"> to use the same host and the same</font>

755
00:40:02,280 --> 00:40:10,150
listener so we set the target IP<font color="#E5E5E5"> which</font>

756
00:40:07,540 --> 00:40:12,339
is the remote<font color="#E5E5E5"> bot internal to the</font>

757
00:40:10,150 --> 00:40:14,520
organization somewhere

758
00:40:12,339 --> 00:40:19,089
set up the listener on<font color="#CCCCCC"> its its own</font>

759
00:40:14,520 --> 00:40:21,599
network<font color="#CCCCCC"> and it's now</font><font color="#E5E5E5"> sitting there</font>

760
00:40:19,089 --> 00:40:26,380
saying accepting connections<font color="#E5E5E5"> from the</font>

761
00:40:21,599 --> 00:40:36,579
<font color="#CCCCCC">internet</font><font color="#E5E5E5"> basically so if we go back and</font>

762
00:40:26,380 --> 00:40:38,330
we<font color="#E5E5E5"> set the payload</font><font color="#CCCCCC"> to be a bind</font><font color="#E5E5E5"> TCP and</font>

763
00:40:36,579 --> 00:40:42,000
type again

764
00:40:38,330 --> 00:40:44,790
there we go<font color="#E5E5E5"> so we're going to connect</font>

765
00:40:42,000 --> 00:40:46,770
from<font color="#CCCCCC"> the Internet</font><font color="#E5E5E5"> to our Active</font>

766
00:40:44,790 --> 00:40:49,080
Directory botnet on the port that we've

767
00:40:46,770 --> 00:40:53,390
specified<font color="#E5E5E5"> so</font><font color="#CCCCCC"> it's</font><font color="#E5E5E5"> just going to</font>

768
00:40:49,080 --> 00:40:57,360
<font color="#CCCCCC">establish a TCP connection to it</font>

769
00:40:53,390 --> 00:40:59,480
immediately<font color="#E5E5E5"> drops us to a prompt what</font>

770
00:40:57,360 --> 00:41:01,380
every attacker does they type dir

771
00:40:59,480 --> 00:41:04,050
<font color="#E5E5E5">because they want to see the listing</font>

772
00:41:01,380 --> 00:41:07,710
<font color="#E5E5E5">right that's the most valuable thing</font>

773
00:41:04,050 --> 00:41:09,330
inside our<font color="#CCCCCC"> organizations so you can see</font>

774
00:41:07,710 --> 00:41:13,050
that again<font color="#CCCCCC"> it's made that connection</font>

775
00:41:09,330 --> 00:41:14,940
<font color="#E5E5E5">that's</font><font color="#CCCCCC"> going through ad</font><font color="#E5E5E5"> to the X the</font>

776
00:41:13,050 --> 00:41:16,470
internal<font color="#E5E5E5"> bots somewhere we don't</font><font color="#CCCCCC"> even</font>

777
00:41:14,940 --> 00:41:18,630
know where it is<font color="#E5E5E5"> from the from the</font>

778
00:41:16,470 --> 00:41:22,109
internal attackers<font color="#CCCCCC"> are from many BOTS</font>

779
00:41:18,630 --> 00:41:25,080
controllers perspective and you can see

780
00:41:22,110 --> 00:41:28,290
the big dump of data up there<font color="#CCCCCC"> and again</font>

781
00:41:25,080 --> 00:41:30,330
we've got<font color="#CCCCCC"> a remote shell through ad 2</font>

782
00:41:28,290 --> 00:41:32,100
somewhere<font color="#E5E5E5"> on our internal</font><font color="#CCCCCC"> network no</font>

783
00:41:30,330 --> 00:41:40,920
matter what your network<font color="#CCCCCC"> access controls</font>

784
00:41:32,100 --> 00:41:43,830
are<font color="#CCCCCC"> ok so how do</font><font color="#E5E5E5"> we actually go about</font>

785
00:41:40,920 --> 00:41:46,710
mitigating the Active<font color="#CCCCCC"> Directory</font><font color="#E5E5E5"> botnet</font>

786
00:41:43,830 --> 00:41:48,840
so as<font color="#E5E5E5"> Paul was mentioning before in</font>

787
00:41:46,710 --> 00:41:52,020
terms of logging there's there's

788
00:41:48,840 --> 00:41:55,140
<font color="#E5E5E5">basically zero</font><font color="#CCCCCC"> you know by default it</font>

789
00:41:52,020 --> 00:41:56,910
doesn't log updating at you know your

790
00:41:55,140 --> 00:42:00,960
standard<font color="#E5E5E5"> user</font><font color="#CCCCCC"> attributes because there's</font>

791
00:41:56,910 --> 00:42:04,020
bet there'd be a lot<font color="#CCCCCC"> of</font><font color="#E5E5E5"> logs right so I</font>

792
00:42:00,960 --> 00:42:07,110
mean setting those that sort of logging

793
00:42:04,020 --> 00:42:09,300
is obviously an option<font color="#CCCCCC"> separating your</font>

794
00:42:07,110 --> 00:42:11,210
domains into different security zones

795
00:42:09,300 --> 00:42:13,920
which I know that<font color="#CCCCCC"> you know a lot of</font>

796
00:42:11,210 --> 00:42:16,380
organizations especially<font color="#CCCCCC"> with</font><font color="#E5E5E5"> critical</font>

797
00:42:13,920 --> 00:42:19,050
infrastructure have multiple<font color="#CCCCCC"> domains for</font>

798
00:42:16,380 --> 00:42:21,240
the different critical security<font color="#E5E5E5"> zones</font>

799
00:42:19,050 --> 00:42:22,500
but I've even<font color="#CCCCCC"> spoken to some of them</font>

800
00:42:21,240 --> 00:42:24,629
recently and<font color="#E5E5E5"> they're looking at</font>

801
00:42:22,500 --> 00:42:26,820
collapsing it just for management

802
00:42:24,630 --> 00:42:30,060
reasons so hopefully to stop them from

803
00:42:26,820 --> 00:42:32,420
<font color="#E5E5E5">doing that</font><font color="#CCCCCC"> and obviously</font><font color="#E5E5E5"> noticing odd</font>

804
00:42:30,060 --> 00:42:35,490
values that are being pushed<font color="#E5E5E5"> into your</font>

805
00:42:32,420 --> 00:42:38,880
standard user<font color="#CCCCCC"> attributes so</font><font color="#E5E5E5"> you know you</font>

806
00:42:35,490 --> 00:42:41,850
start seeing your IP<font color="#E5E5E5"> Phone with goods in</font>

807
00:42:38,880 --> 00:42:44,880
it or your notes which<font color="#CCCCCC"> is the info</font>

808
00:42:41,850 --> 00:42:48,830
attribute<font color="#E5E5E5"> you know with these</font><font color="#CCCCCC"> command</font>

809
00:42:44,880 --> 00:42:52,970
<font color="#CCCCCC">and</font><font color="#E5E5E5"> control data then that's obviously</font><font color="#CCCCCC"> a</font>

810
00:42:48,830 --> 00:42:57,290
sign<font color="#CCCCCC"> the other</font><font color="#E5E5E5"> is that</font><font color="#CCCCCC"> you can actually</font>

811
00:42:52,970 --> 00:42:59,959
lock down<font color="#CCCCCC"> your permissions for standard</font>

812
00:42:57,290 --> 00:43:02,570
users to actually<font color="#CCCCCC"> update their</font><font color="#E5E5E5"> own</font>

813
00:42:59,960 --> 00:43:04,520
attributes<font color="#CCCCCC"> whether</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> actually want to</font>

814
00:43:02,570 --> 00:43:10,550
do<font color="#E5E5E5"> that or</font><font color="#CCCCCC"> not</font><font color="#E5E5E5"> that I don't often go and</font>

815
00:43:04,520 --> 00:43:12,560
change my<font color="#CCCCCC"> name in AD so thank you very</font>

816
00:43:10,550 --> 00:43:15,260
much for<font color="#E5E5E5"> coming</font><font color="#CCCCCC"> if you have any</font>

817
00:43:12,560 --> 00:43:16,759
questions<font color="#E5E5E5"> we're we're keen</font><font color="#CCCCCC"> to hear your</font>

818
00:43:15,260 --> 00:43:25,309
thoughts<font color="#CCCCCC"> thank</font><font color="#E5E5E5"> you</font>

819
00:43:16,760 --> 00:43:25,309
[Applause]

