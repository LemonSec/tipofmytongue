1
00:00:00,000 --> 00:00:02,669
today we're going<font color="#E5E5E5"> to be talking</font><font color="#CCCCCC"> about</font>

2
00:00:01,110 --> 00:00:04,529
developing<font color="#E5E5E5"> trust and getting betrayed</font>

3
00:00:02,669 --> 00:00:06,060
<font color="#CCCCCC">and Trust is a</font><font color="#E5E5E5"> very important thing</font>

4
00:00:04,529 --> 00:00:09,019
whether it's between people in

5
00:00:06,060 --> 00:00:13,170
relationships<font color="#CCCCCC"> companies processes or</font>

6
00:00:09,019 --> 00:00:15,980
<font color="#CCCCCC">giraffes and when that wind</font><font color="#E5E5E5"> trust is</font>

7
00:00:13,170 --> 00:00:18,210
betrayed<font color="#E5E5E5"> the result can be devastating</font><font color="#CCCCCC"> a</font>

8
00:00:15,980 --> 00:00:20,070
little bit about us<font color="#E5E5E5"> before we get too</font>

9
00:00:18,210 --> 00:00:22,949
deep<font color="#E5E5E5"> into it</font><font color="#CCCCCC"> my name is</font><font color="#E5E5E5"> Clint Gibbler</font>

10
00:00:20,070 --> 00:00:25,529
I'm a<font color="#CCCCCC"> Midwesterner</font><font color="#E5E5E5"> living in SF which is</font>

11
00:00:22,949 --> 00:00:27,630
the land of goat<font color="#CCCCCC"> yoga and kombucha on</font>

12
00:00:25,529 --> 00:00:29,640
tap I'm a<font color="#E5E5E5"> security researcher at NCC</font>

13
00:00:27,630 --> 00:00:32,640
group and I was<font color="#E5E5E5"> once filmed monologuing</font>

14
00:00:29,640 --> 00:00:35,070
<font color="#E5E5E5">to a live EMU</font><font color="#CCCCCC"> with me</font><font color="#E5E5E5"> is Noah</font><font color="#CCCCCC"> bad omen</font>

15
00:00:32,640 --> 00:00:37,170
thanks Clint<font color="#E5E5E5"> my name is Noah</font><font color="#CCCCCC"> bedont I'm</font>

16
00:00:35,070 --> 00:00:38,550
a lover of fine<font color="#E5E5E5"> root beer</font><font color="#CCCCCC"> a security</font>

17
00:00:37,170 --> 00:00:39,750
searcher who pretends<font color="#E5E5E5"> to</font><font color="#CCCCCC"> be a director</font>

18
00:00:38,550 --> 00:00:44,940
<font color="#CCCCCC">of infrastructure security during</font><font color="#E5E5E5"> the</font>

19
00:00:39,750 --> 00:00:46,500
day and<font color="#CCCCCC"> for marine</font><font color="#E5E5E5"> rot</font><font color="#CCCCCC"> alright so a</font>

20
00:00:44,940 --> 00:00:48,419
<font color="#E5E5E5">little bit about the agenda first we're</font>

21
00:00:46,500 --> 00:00:50,070
<font color="#E5E5E5">gonna give some overview and motivation</font>

22
00:00:48,420 --> 00:00:52,649
for the work<font color="#E5E5E5"> then we're going</font><font color="#CCCCCC"> to talk</font>

23
00:00:50,070 --> 00:00:54,360
<font color="#E5E5E5">about trust as it pertains to a company</font>

24
00:00:52,649 --> 00:00:56,100
and<font color="#CCCCCC"> organization</font><font color="#E5E5E5"> then we're</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> talk</font>

25
00:00:54,360 --> 00:00:57,449
<font color="#E5E5E5">in more detail about development focused</font>

26
00:00:56,100 --> 00:00:59,340
environments which<font color="#E5E5E5"> are the target of</font>

27
00:00:57,449 --> 00:01:00,870
<font color="#E5E5E5">this talk we're going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> discuss the</font>

28
00:00:59,340 --> 00:01:02,910
architecture of get<font color="#E5E5E5"> pone which is a tool</font>

29
00:01:00,870 --> 00:01:04,679
we're going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> demo and release today</font>

30
00:01:02,910 --> 00:01:06,689
<font color="#E5E5E5">then talk about some mitigations for</font>

31
00:01:04,680 --> 00:01:08,250
some of<font color="#E5E5E5"> these attacks</font><font color="#CCCCCC"> and finally take</font>

32
00:01:06,689 --> 00:01:09,750
questions at the<font color="#CCCCCC"> end so if you wouldn't</font>

33
00:01:08,250 --> 00:01:10,710
mind holding questions to the end<font color="#CCCCCC"> just</font>

34
00:01:09,750 --> 00:01:12,689
to<font color="#E5E5E5"> make</font><font color="#CCCCCC"> sure we can get</font><font color="#E5E5E5"> through things</font>

35
00:01:10,710 --> 00:01:16,080
we're happy<font color="#E5E5E5"> to answer a few immediately</font>

36
00:01:12,689 --> 00:01:18,000
and then in a room nearby<font color="#E5E5E5"> after so all</font>

37
00:01:16,080 --> 00:01:19,170
<font color="#E5E5E5">right so the background is no and I were</font>

38
00:01:18,000 --> 00:01:20,790
performing a<font color="#CCCCCC"> number of network</font>

39
00:01:19,170 --> 00:01:22,320
penetration tests over<font color="#E5E5E5"> the past few</font>

40
00:01:20,790 --> 00:01:24,450
years largely<font color="#E5E5E5"> of development focused</font>

41
00:01:22,320 --> 00:01:26,369
organizations<font color="#E5E5E5"> and a key point of failure</font>

42
00:01:24,450 --> 00:01:28,290
<font color="#E5E5E5">we found was this bridging of trust zone</font>

43
00:01:26,369 --> 00:01:30,750
say between<font color="#E5E5E5"> the development and</font>

44
00:01:28,290 --> 00:01:32,909
production environment<font color="#CCCCCC"> oftentimes this</font>

45
00:01:30,750 --> 00:01:34,200
happened because<font color="#E5E5E5"> of implicit trust and a</font>

46
00:01:32,909 --> 00:01:35,970
lack<font color="#CCCCCC"> of guidance around developer and</font>

47
00:01:34,200 --> 00:01:38,340
DevOps<font color="#E5E5E5"> so the goal</font><font color="#CCCCCC"> of this</font><font color="#E5E5E5"> talk is</font>

48
00:01:35,970 --> 00:01:40,470
<font color="#E5E5E5">twofold first we want to discuss how</font>

49
00:01:38,340 --> 00:01:42,479
trust relationships<font color="#CCCCCC"> being between</font><font color="#E5E5E5"> people</font>

50
00:01:40,470 --> 00:01:44,399
and<font color="#E5E5E5"> infrastructure can</font><font color="#CCCCCC"> be exploited and</font>

51
00:01:42,479 --> 00:01:46,320
then second present a tool<font color="#E5E5E5"> a get</font><font color="#CCCCCC"> pone</font>

52
00:01:44,399 --> 00:01:48,180
<font color="#E5E5E5">that puts these ideas into a practice so</font>

53
00:01:46,320 --> 00:01:50,189
this<font color="#E5E5E5"> tool can be used by internal</font>

54
00:01:48,180 --> 00:01:51,899
security teams or consultants to help

55
00:01:50,189 --> 00:01:54,479
<font color="#E5E5E5">attack and assess development focused</font>

56
00:01:51,899 --> 00:01:56,670
organizations or be used as a concrete

57
00:01:54,479 --> 00:01:59,899
<font color="#E5E5E5">example to show here's the impact of</font>

58
00:01:56,670 --> 00:02:02,250
these types<font color="#E5E5E5"> of common issues in practice</font>

59
00:01:59,899 --> 00:02:04,759
<font color="#E5E5E5">so I will pass</font><font color="#CCCCCC"> it off to know what to</font>

60
00:02:02,250 --> 00:02:04,759
discuss<font color="#CCCCCC"> trust</font>

61
00:02:06,110 --> 00:02:11,760
right I think<font color="#E5E5E5"> it's</font><font color="#CCCCCC"> Clinton so throw out</font>

62
00:02:10,350 --> 00:02:13,410
the talk we're gonna talk<font color="#CCCCCC"> about you know</font>

63
00:02:11,760 --> 00:02:15,299
several<font color="#E5E5E5"> key things</font><font color="#CCCCCC"> and the</font><font color="#E5E5E5"> first is</font>

64
00:02:13,410 --> 00:02:17,940
going<font color="#E5E5E5"> to be the role that trust and</font>

65
00:02:15,300 --> 00:02:19,980
<font color="#CCCCCC">Trust relationships play in the attack</font>

66
00:02:17,940 --> 00:02:21,959
and exploitation<font color="#E5E5E5"> certain scenarios that</font>

67
00:02:19,980 --> 00:02:24,420
get pwned is meant to highlight<font color="#E5E5E5"> so</font>

68
00:02:21,959 --> 00:02:26,040
before we get into<font color="#CCCCCC"> that really</font><font color="#E5E5E5"> want to</font>

69
00:02:24,420 --> 00:02:27,869
<font color="#E5E5E5">talk about what trust relationships are</font>

70
00:02:26,040 --> 00:02:31,799
right<font color="#E5E5E5"> so trust relationships are</font>

71
00:02:27,870 --> 00:02:34,580
essentially the amount<font color="#E5E5E5"> of impact</font><font color="#CCCCCC"> two or</font>

72
00:02:31,800 --> 00:02:37,470
<font color="#E5E5E5">more entities can have on each other</font>

73
00:02:34,580 --> 00:02:39,120
<font color="#CCCCCC">because of the amount</font><font color="#E5E5E5"> of trust and</font>

74
00:02:37,470 --> 00:02:40,500
allowance for communication or

75
00:02:39,120 --> 00:02:43,320
connection they<font color="#E5E5E5"> may have this can be</font>

76
00:02:40,500 --> 00:02:46,500
between<font color="#E5E5E5"> people networks systems</font><font color="#CCCCCC"> etc</font>

77
00:02:43,320 --> 00:02:48,030
right so<font color="#E5E5E5"> truss rod</font><font color="#CCCCCC"> relationships are</font>

78
00:02:46,500 --> 00:02:50,700
<font color="#CCCCCC">established on the</font><font color="#E5E5E5"> actual amount of</font>

79
00:02:48,030 --> 00:02:52,800
controls protections privacy and

80
00:02:50,700 --> 00:02:55,829
security in place<font color="#E5E5E5"> not</font><font color="#CCCCCC"> necessarily the</font>

81
00:02:52,800 --> 00:02:57,269
intended amount of trust right so you

82
00:02:55,830 --> 00:02:59,250
usually see<font color="#E5E5E5"> this in fact that we might</font>

83
00:02:57,269 --> 00:03:01,050
say<font color="#E5E5E5"> these two</font><font color="#CCCCCC"> environments aren't</font>

84
00:02:59,250 --> 00:03:02,670
allowed<font color="#CCCCCC"> to talk to each</font><font color="#E5E5E5"> other but</font>

85
00:03:01,050 --> 00:03:04,830
<font color="#CCCCCC">actually we punched a bunch</font><font color="#E5E5E5"> of holes at</font>

86
00:03:02,670 --> 00:03:05,880
some point and they can<font color="#CCCCCC"> write</font><font color="#E5E5E5"> so when we</font>

87
00:03:04,830 --> 00:03:07,500
talk about<font color="#E5E5E5"> trust relationships we're</font>

88
00:03:05,880 --> 00:03:10,470
talking about<font color="#E5E5E5"> the actual</font><font color="#CCCCCC"> amount of</font><font color="#E5E5E5"> trust</font>

89
00:03:07,500 --> 00:03:12,870
there and not the implied amount the

90
00:03:10,470 --> 00:03:15,090
next is<font color="#E5E5E5"> that trust relationships usually</font>

91
00:03:12,870 --> 00:03:17,130
<font color="#CCCCCC">exist between trust zones so trust zone</font>

92
00:03:15,090 --> 00:03:18,510
could<font color="#E5E5E5"> be really any areas that</font><font color="#CCCCCC"> might</font>

93
00:03:17,130 --> 00:03:22,430
have a different<font color="#CCCCCC"> level</font><font color="#E5E5E5"> of secrecy</font>

94
00:03:18,510 --> 00:03:24,420
security privacy<font color="#E5E5E5"> associated with them so</font>

95
00:03:22,430 --> 00:03:26,250
<font color="#E5E5E5">example might be difference between</font>

96
00:03:24,420 --> 00:03:28,018
public living space in your<font color="#CCCCCC"> private</font>

97
00:03:26,250 --> 00:03:32,040
bedroom<font color="#E5E5E5"> between a production environment</font>

98
00:03:28,019 --> 00:03:33,959
and a staging<font color="#E5E5E5"> environment</font><font color="#CCCCCC"> etc so one</font>

99
00:03:32,040 --> 00:03:35,370
thing<font color="#CCCCCC"> to keep in mind is that when we're</font>

100
00:03:33,959 --> 00:03:38,280
talking<font color="#CCCCCC"> about</font><font color="#E5E5E5"> trust relationships and</font>

101
00:03:35,370 --> 00:03:40,079
<font color="#CCCCCC">trust sounds very often security and</font>

102
00:03:38,280 --> 00:03:42,989
these<font color="#E5E5E5"> restrictions we put between our</font>

103
00:03:40,079 --> 00:03:44,700
<font color="#E5E5E5">different trust zones happen to impede</font>

104
00:03:42,989 --> 00:03:47,489
some level of function<font color="#E5E5E5"> and instead of</font>

105
00:03:44,700 --> 00:03:50,070
<font color="#E5E5E5">maybe designing better processes to</font>

106
00:03:47,489 --> 00:03:52,110
utilize that<font color="#E5E5E5"> we tend to invalidate these</font>

107
00:03:50,070 --> 00:03:54,060
trust relationships and punch holes<font color="#CCCCCC"> and</font>

108
00:03:52,110 --> 00:03:55,980
<font color="#E5E5E5">the barriers to</font><font color="#CCCCCC"> get the job</font><font color="#E5E5E5"> done which</font>

109
00:03:54,060 --> 00:03:59,250
can usually<font color="#E5E5E5"> result in some significant</font>

110
00:03:55,980 --> 00:04:02,100
problems<font color="#E5E5E5"> down the road so this is the</font>

111
00:03:59,250 --> 00:04:04,260
list of people<font color="#E5E5E5"> and things I trust and</font>

112
00:04:02,100 --> 00:04:05,579
the example here is<font color="#CCCCCC"> that</font><font color="#E5E5E5"> whenever we're</font>

113
00:04:04,260 --> 00:04:07,980
<font color="#CCCCCC">establishing trust zones and</font><font color="#E5E5E5"> trust</font>

114
00:04:05,579 --> 00:04:09,209
relationships we want to<font color="#CCCCCC"> limit the</font>

115
00:04:07,980 --> 00:04:11,340
<font color="#CCCCCC">amount of trust</font><font color="#E5E5E5"> to what's really</font>

116
00:04:09,209 --> 00:04:13,859
<font color="#CCCCCC">actually required for the relationship</font>

117
00:04:11,340 --> 00:04:14,970
<font color="#CCCCCC">to work properly right because when</font>

118
00:04:13,859 --> 00:04:16,859
we're<font color="#E5E5E5"> talking about</font><font color="#CCCCCC"> trust relationships</font>

119
00:04:14,970 --> 00:04:17,488
<font color="#E5E5E5">they can exist in a variety of forms and</font>

120
00:04:16,858 --> 00:04:19,289
<font color="#E5E5E5">types right</font>

121
00:04:17,488 --> 00:04:21,799
can be employer to employee<font color="#E5E5E5"> can be</font>

122
00:04:19,289 --> 00:04:24,060
organization organization they can<font color="#E5E5E5"> be</font>

123
00:04:21,800 --> 00:04:26,099
<font color="#E5E5E5">project to collaborator network to</font>

124
00:04:24,060 --> 00:04:28,110
network system to system<font color="#CCCCCC"> right</font><font color="#E5E5E5"> so some</font>

125
00:04:26,099 --> 00:04:30,180
examples of this<font color="#E5E5E5"> might be as an employer</font>

126
00:04:28,110 --> 00:04:32,370
<font color="#E5E5E5">I trust my</font><font color="#CCCCCC"> employees to come into work</font>

127
00:04:30,180 --> 00:04:35,220
<font color="#E5E5E5">use assets have access to the building</font>

128
00:04:32,370 --> 00:04:37,590
<font color="#CCCCCC">etc</font><font color="#E5E5E5"> and I trust</font><font color="#CCCCCC"> that they</font><font color="#E5E5E5"> are going</font><font color="#CCCCCC"> to</font>

129
00:04:35,220 --> 00:04:39,630
<font color="#E5E5E5">operate in the fashion that we've agreed</font>

130
00:04:37,590 --> 00:04:42,299
upon<font color="#E5E5E5"> another example would be network to</font>

131
00:04:39,630 --> 00:04:44,909
network<font color="#CCCCCC"> so I might say that the normal</font>

132
00:04:42,300 --> 00:04:48,300
<font color="#E5E5E5">corporate network cannot talk to the</font>

133
00:04:44,910 --> 00:04:50,789
production<font color="#E5E5E5"> network on any port at all</font><font color="#CCCCCC"> or</font>

134
00:04:48,300 --> 00:04:52,470
I might<font color="#CCCCCC"> say that</font><font color="#E5E5E5"> staging can talk to the</font>

135
00:04:50,789 --> 00:04:55,800
<font color="#E5E5E5">production network across</font><font color="#CCCCCC"> a couple</font>

136
00:04:52,470 --> 00:04:58,289
control ports from specific source<font color="#CCCCCC"> ApS</font>

137
00:04:55,800 --> 00:05:02,210
right<font color="#E5E5E5"> these are</font><font color="#CCCCCC"> kind of the examples</font><font color="#E5E5E5"> of</font>

138
00:04:58,289 --> 00:05:04,650
<font color="#E5E5E5">these trust relationships</font><font color="#CCCCCC"> in practice so</font>

139
00:05:02,210 --> 00:05:06,359
<font color="#E5E5E5">okay well this is all well good we have</font>

140
00:05:04,650 --> 00:05:08,099
<font color="#E5E5E5">trust relationships and</font><font color="#CCCCCC"> trust</font><font color="#E5E5E5"> zones and</font>

141
00:05:06,360 --> 00:05:10,050
<font color="#E5E5E5">we know that we sometimes mess them up</font>

142
00:05:08,099 --> 00:05:13,199
to get<font color="#E5E5E5"> the job done but what does this</font>

143
00:05:10,050 --> 00:05:15,449
<font color="#E5E5E5">really mean so the thing</font><font color="#CCCCCC"> that tends to</font>

144
00:05:13,199 --> 00:05:18,300
get missed that<font color="#E5E5E5"> Trust is transitive</font>

145
00:05:15,449 --> 00:05:21,449
inherited and implicit<font color="#E5E5E5"> so essentially</font>

146
00:05:18,300 --> 00:05:23,009
what this<font color="#CCCCCC"> means</font><font color="#E5E5E5"> is that if I trust you</font>

147
00:05:21,449 --> 00:05:25,409
and you trust<font color="#E5E5E5"> something else</font>

148
00:05:23,009 --> 00:05:27,389
functionally in some ways I trust that

149
00:05:25,409 --> 00:05:31,590
<font color="#CCCCCC">third-party so</font><font color="#E5E5E5"> you see this in</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> form</font>

150
00:05:27,389 --> 00:05:33,719
of in a<font color="#CCCCCC"> person example if I trust you</font>

151
00:05:31,590 --> 00:05:35,369
and I believe<font color="#E5E5E5"> anything you tell me and</font>

152
00:05:33,719 --> 00:05:38,310
you believe anything<font color="#E5E5E5"> Jenny tells you and</font>

153
00:05:35,370 --> 00:05:40,830
Jenny is a liar<font color="#E5E5E5"> right</font><font color="#CCCCCC"> I functionally</font>

154
00:05:38,310 --> 00:05:42,599
believe anything Jenny says right we see

155
00:05:40,830 --> 00:05:44,729
this in actual<font color="#E5E5E5"> network implementations</font>

156
00:05:42,599 --> 00:05:46,889
and production environments<font color="#CCCCCC"> when we see</font>

157
00:05:44,729 --> 00:05:49,710
things like production<font color="#E5E5E5"> trust staging and</font>

158
00:05:46,889 --> 00:05:51,300
staging<font color="#CCCCCC"> trusts a small group</font><font color="#E5E5E5"> of release</font>

159
00:05:49,710 --> 00:05:53,039
devs who all use a bunch of in-house

160
00:05:51,300 --> 00:05:54,780
developed<font color="#E5E5E5"> tools that are dependent on a</font>

161
00:05:53,039 --> 00:05:56,669
bunch of third party like open<font color="#E5E5E5"> source</font>

162
00:05:54,780 --> 00:05:58,948
libraries<font color="#E5E5E5"> right that are developed by a</font>

163
00:05:56,669 --> 00:06:03,270
bunch of in-house devs<font color="#E5E5E5"> so functionally</font>

164
00:05:58,949 --> 00:06:07,460
prod trusts those in-house devs<font color="#E5E5E5"> and open</font>

165
00:06:03,270 --> 00:06:09,990
<font color="#E5E5E5">source tools to be safe and</font><font color="#CCCCCC"> secure</font><font color="#E5E5E5"> and</font>

166
00:06:07,460 --> 00:06:11,930
<font color="#E5E5E5">that creates a clear path of potential</font>

167
00:06:09,990 --> 00:06:14,219
<font color="#CCCCCC">compromise between let's say</font><font color="#E5E5E5"> and</font>

168
00:06:11,930 --> 00:06:15,300
irresponsible<font color="#CCCCCC"> third-party devs or</font>

169
00:06:14,219 --> 00:06:17,310
<font color="#E5E5E5">in-house to have a</font><font color="#CCCCCC"> third-party</font><font color="#E5E5E5"> library</font>

170
00:06:15,300 --> 00:06:21,300
<font color="#CCCCCC">and potentially the production</font>

171
00:06:17,310 --> 00:06:22,849
environment<font color="#E5E5E5"> so the root of what we're</font>

172
00:06:21,300 --> 00:06:25,830
talking<font color="#CCCCCC"> about is</font><font color="#E5E5E5"> that because</font><font color="#CCCCCC"> of how</font>

173
00:06:22,849 --> 00:06:27,599
trust relationships can<font color="#CCCCCC"> be chained</font><font color="#E5E5E5"> they</font>

174
00:06:25,830 --> 00:06:28,949
allow some significant significant

175
00:06:27,599 --> 00:06:31,449
potential for<font color="#CCCCCC"> lateral movement and</font>

176
00:06:28,949 --> 00:06:32,770
<font color="#E5E5E5">exploitation and escalation of</font>

177
00:06:31,449 --> 00:06:35,080
and<font color="#CCCCCC"> smoothly</font><font color="#E5E5E5"> for the most part we're</font>

178
00:06:32,770 --> 00:06:36,940
talking<font color="#CCCCCC"> about</font><font color="#E5E5E5"> in agile development</font>

179
00:06:35,080 --> 00:06:38,830
environments very<font color="#E5E5E5"> much like you</font><font color="#CCCCCC"> see and</font>

180
00:06:36,940 --> 00:06:40,150
kind<font color="#CCCCCC"> of startups and popular web</font>

181
00:06:38,830 --> 00:06:42,130
properties and<font color="#E5E5E5"> those kind of things</font><font color="#CCCCCC"> so</font>

182
00:06:40,150 --> 00:06:45,549
<font color="#CCCCCC">let's take a real quick look at what</font>

183
00:06:42,130 --> 00:06:49,840
these environments look like so

184
00:06:45,550 --> 00:06:51,729
networking<font color="#E5E5E5"> is hard</font><font color="#CCCCCC"> all right so these</font>

185
00:06:49,840 --> 00:06:54,130
environments<font color="#E5E5E5"> look a lot like any other</font>

186
00:06:51,729 --> 00:06:55,630
environment<font color="#E5E5E5"> when we start out so they</font>

187
00:06:54,130 --> 00:06:57,669
have<font color="#E5E5E5"> workstations like anyone else they</font>

188
00:06:55,630 --> 00:06:59,409
have general user access they have admin

189
00:06:57,669 --> 00:07:02,460
backbones<font color="#CCCCCC"> they have a</font><font color="#E5E5E5"> couple unique</font>

190
00:06:59,410 --> 00:07:04,389
things right<font color="#CCCCCC"> so they have things like</font>

191
00:07:02,460 --> 00:07:06,880
<font color="#E5E5E5">local and remote development</font>

192
00:07:04,389 --> 00:07:09,099
environments we have<font color="#CCCCCC"> CI CD pipelines we</font>

193
00:07:06,880 --> 00:07:14,620
have<font color="#CCCCCC"> multi-tiered environments like</font>

194
00:07:09,099 --> 00:07:16,090
staging prod<font color="#E5E5E5"> remote dev</font><font color="#CCCCCC"> and we also have</font>

195
00:07:14,620 --> 00:07:18,729
the entire<font color="#E5E5E5"> burden that will say the dev</font>

196
00:07:16,090 --> 00:07:20,679
<font color="#E5E5E5">ops tool chain to maintain and manage</font>

197
00:07:18,729 --> 00:07:22,930
the development infrastructure<font color="#E5E5E5"> that</font>

198
00:07:20,680 --> 00:07:24,909
supports these developers right<font color="#E5E5E5"> so when</font>

199
00:07:22,930 --> 00:07:28,690
we look at<font color="#E5E5E5"> this like broke down you can</font>

200
00:07:24,909 --> 00:07:31,419
see that we have say our average agile

201
00:07:28,690 --> 00:07:33,039
development startup we have user laptop

202
00:07:31,419 --> 00:07:34,870
it may have a local dev environment with

203
00:07:33,039 --> 00:07:37,599
<font color="#E5E5E5">some VMs and five mountain file systems</font>

204
00:07:34,870 --> 00:07:38,979
<font color="#E5E5E5">they've got a wireless router that</font><font color="#CCCCCC"> they</font>

205
00:07:37,599 --> 00:07:40,570
connect to and can get<font color="#E5E5E5"> on the internet</font>

206
00:07:38,979 --> 00:07:42,580
<font color="#E5E5E5">and</font><font color="#CCCCCC"> they connect out</font><font color="#E5E5E5"> to some</font><font color="#CCCCCC"> third-party</font>

207
00:07:40,570 --> 00:07:45,070
<font color="#E5E5E5">applications in a cloud environment</font><font color="#CCCCCC"> so</font>

208
00:07:42,580 --> 00:07:46,539
<font color="#CCCCCC">we've got some get variety probably</font>

209
00:07:45,070 --> 00:07:51,340
<font color="#CCCCCC">third-party SAS applications maybe some</font>

210
00:07:46,539 --> 00:07:53,650
<font color="#CCCCCC">G suite some HR applications etc</font><font color="#E5E5E5"> and</font>

211
00:07:51,340 --> 00:07:55,690
then something like AWS<font color="#CCCCCC"> azor</font><font color="#E5E5E5"> Google</font>

212
00:07:53,650 --> 00:07:57,400
compute<font color="#E5E5E5"> and</font><font color="#CCCCCC"> then behind that</font><font color="#E5E5E5"> an</font>

213
00:07:55,690 --> 00:07:59,169
infrastructure<font color="#E5E5E5"> and</font><font color="#CCCCCC"> that's</font><font color="#E5E5E5"> probably</font>

214
00:07:57,400 --> 00:08:01,060
multi-tiered<font color="#E5E5E5"> right so development and</font>

215
00:07:59,169 --> 00:08:02,258
staging production so<font color="#E5E5E5"> develop</font><font color="#CCCCCC"> into</font>

216
00:08:01,060 --> 00:08:03,789
staging being where<font color="#E5E5E5"> we integrate the</font>

217
00:08:02,259 --> 00:08:05,080
code and where we work on the code and

218
00:08:03,789 --> 00:08:06,669
then that we're gonna have<font color="#E5E5E5"> a variety of</font>

219
00:08:05,080 --> 00:08:08,830
<font color="#E5E5E5">things right we're gonna have</font><font color="#CCCCCC"> Jenkins</font>

220
00:08:06,669 --> 00:08:11,159
<font color="#E5E5E5">and other continuous integration like</font>

221
00:08:08,830 --> 00:08:13,000
Travis we're gonna have chef or puppet

222
00:08:11,159 --> 00:08:14,919
<font color="#CCCCCC">we have a variety</font><font color="#E5E5E5"> of different servers</font>

223
00:08:13,000 --> 00:08:17,020
<font color="#CCCCCC">of</font><font color="#E5E5E5"> surgical purposes we're gonna have</font>

224
00:08:14,919 --> 00:08:18,909
some integration and deployment pipeline

225
00:08:17,020 --> 00:08:20,889
into<font color="#CCCCCC"> production this should have</font><font color="#E5E5E5"> the</font>

226
00:08:18,909 --> 00:08:22,360
minimum<font color="#CCCCCC"> number of assets required</font><font color="#E5E5E5"> you</font>

227
00:08:20,889 --> 00:08:23,740
should all be heavily<font color="#CCCCCC"> protected</font><font color="#E5E5E5"> systems</font>

228
00:08:22,360 --> 00:08:26,409
that are serving the primary business

229
00:08:23,740 --> 00:08:29,259
<font color="#E5E5E5">line systems for the</font><font color="#CCCCCC"> organization's so</font>

230
00:08:26,409 --> 00:08:30,759
things like primary web servers<font color="#E5E5E5"> the</font>

231
00:08:29,259 --> 00:08:36,820
primary application<font color="#E5E5E5"> servers the</font>

232
00:08:30,759 --> 00:08:38,260
production databases etc<font color="#E5E5E5"> so whose boils</font>

233
00:08:36,820 --> 00:08:39,490
down to is attacking<font color="#E5E5E5"> these environments</font>

234
00:08:38,260 --> 00:08:41,069
why is this<font color="#E5E5E5"> novel why is this different</font>

235
00:08:39,490 --> 00:08:42,849
<font color="#CCCCCC">right</font>

236
00:08:41,070 --> 00:08:43,719
traditionally attacking a standard

237
00:08:42,849 --> 00:08:45,670
Windows environment

238
00:08:43,719 --> 00:08:47,620
it's compromising an individual system

239
00:08:45,670 --> 00:08:49,509
<font color="#CCCCCC">replaying credentials getting a hold of</font>

240
00:08:47,620 --> 00:08:50,769
the compromise<font color="#E5E5E5"> of the central</font>

241
00:08:49,509 --> 00:08:52,569
authentication mechanism and then

242
00:08:50,769 --> 00:08:53,889
spreading<font color="#E5E5E5"> through everything right these</font>

243
00:08:52,569 --> 00:08:55,120
are<font color="#CCCCCC"> a little different there is some</font>

244
00:08:53,889 --> 00:08:57,759
exploitation of<font color="#CCCCCC"> central authentication</font>

245
00:08:55,120 --> 00:09:00,459
on occasion<font color="#E5E5E5"> but it doesn't</font><font color="#CCCCCC"> necessarily</font>

246
00:08:57,759 --> 00:09:01,360
always<font color="#E5E5E5"> yield the windfall exploitation</font>

247
00:09:00,459 --> 00:09:02,439
that<font color="#E5E5E5"> it would in like Windows</font>

248
00:09:01,360 --> 00:09:04,810
environment so what are we<font color="#E5E5E5"> looking at</font>

249
00:09:02,439 --> 00:09:06,399
looking<font color="#E5E5E5"> at exploitation of individual</font>

250
00:09:04,810 --> 00:09:09,219
developers this tends<font color="#E5E5E5"> to be massive</font>

251
00:09:06,399 --> 00:09:11,290
<font color="#E5E5E5">right so</font><font color="#CCCCCC"> very often</font><font color="#E5E5E5"> it'll vary from dev</font>

252
00:09:09,220 --> 00:09:12,970
- dev one dev may have nothing<font color="#CCCCCC"> no that</font>

253
00:09:11,290 --> 00:09:15,099
may have access<font color="#E5E5E5"> to everything and deploy</font>

254
00:09:12,970 --> 00:09:18,370
<font color="#E5E5E5">rights right so it's very individual</font>

255
00:09:15,100 --> 00:09:20,350
user role focused<font color="#CCCCCC"> compromise</font><font color="#E5E5E5"> the CICE</font>

256
00:09:18,370 --> 00:09:22,600
tends to be game<font color="#CCCCCC"> over in many</font><font color="#E5E5E5"> cases</font>

257
00:09:20,350 --> 00:09:24,459
because<font color="#E5E5E5"> very often automated users like</font>

258
00:09:22,600 --> 00:09:26,829
Jenkins etc have the ability to do

259
00:09:24,459 --> 00:09:29,649
deploys<font color="#E5E5E5"> to critical systems and you can</font>

260
00:09:26,829 --> 00:09:32,019
<font color="#CCCCCC">modify</font><font color="#E5E5E5"> code as it's being processed by</font>

261
00:09:29,649 --> 00:09:34,689
the CI<font color="#CCCCCC"> server and so you can actually</font>

262
00:09:32,019 --> 00:09:38,230
inject<font color="#CCCCCC"> kind</font><font color="#E5E5E5"> of some unexpected artifacts</font>

263
00:09:34,689 --> 00:09:41,230
<font color="#E5E5E5">and stuff into</font><font color="#CCCCCC"> these code also</font><font color="#E5E5E5"> it tends</font>

264
00:09:38,230 --> 00:09:42,879
to<font color="#E5E5E5"> be a hotbed</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> secrets and access it</font>

265
00:09:41,230 --> 00:09:44,370
also tends<font color="#CCCCCC"> to have a bunch</font><font color="#E5E5E5"> of extra</font><font color="#CCCCCC"> open</font>

266
00:09:42,879 --> 00:09:46,449
<font color="#E5E5E5">ports and those kind of things</font><font color="#CCCCCC"> so</font>

267
00:09:44,370 --> 00:09:49,509
<font color="#CCCCCC">pivoting</font><font color="#E5E5E5"> and lateral movement tends to</font>

268
00:09:46,449 --> 00:09:51,040
be more reliant<font color="#E5E5E5"> on individual user</font>

269
00:09:49,509 --> 00:09:52,750
function like how we're<font color="#E5E5E5"> gonna move for</font>

270
00:09:51,040 --> 00:09:55,389
the environment<font color="#E5E5E5"> and it tends to be a lot</font>

271
00:09:52,750 --> 00:09:56,769
<font color="#CCCCCC">easier when you can compromise code that</font>

272
00:09:55,389 --> 00:09:59,290
is<font color="#E5E5E5"> used through environment</font><font color="#CCCCCC"> rather</font><font color="#E5E5E5"> than</font>

273
00:09:56,769 --> 00:10:01,120
an individual workstation<font color="#E5E5E5"> or system and</font>

274
00:09:59,290 --> 00:10:02,740
then local local versus remote

275
00:10:01,120 --> 00:10:04,959
development right so a remote

276
00:10:02,740 --> 00:10:05,649
development environment tends to be the

277
00:10:04,959 --> 00:10:07,239
Wild West

278
00:10:05,649 --> 00:10:08,620
<font color="#CCCCCC">it's very exploitable but doesn't</font><font color="#E5E5E5"> always</font>

279
00:10:07,240 --> 00:10:10,540
<font color="#E5E5E5">have that wealth of secrets and</font>

280
00:10:08,620 --> 00:10:12,730
<font color="#CCCCCC">information you</font><font color="#E5E5E5"> want unless they're</font>

281
00:10:10,540 --> 00:10:14,380
shared with other environments<font color="#E5E5E5"> well a</font>

282
00:10:12,730 --> 00:10:16,029
local<font color="#E5E5E5"> development environment</font><font color="#CCCCCC"> well they</font>

283
00:10:14,380 --> 00:10:18,730
tend<font color="#E5E5E5"> to be more</font><font color="#CCCCCC"> lockdown and usually</font>

284
00:10:16,029 --> 00:10:20,589
they then remote<font color="#CCCCCC"> devout dev environment</font>

285
00:10:18,730 --> 00:10:22,930
<font color="#CCCCCC">they</font><font color="#E5E5E5"> have the opportunity of being</font>

286
00:10:20,589 --> 00:10:24,220
<font color="#E5E5E5">significantly worse because if the</font>

287
00:10:22,930 --> 00:10:26,109
configures aren't correct<font color="#E5E5E5"> it can expose</font>

288
00:10:24,220 --> 00:10:28,240
a bunch of<font color="#E5E5E5"> unnecessary ports excludable</font>

289
00:10:26,110 --> 00:10:29,559
services and then sometimes some there's

290
00:10:28,240 --> 00:10:33,970
<font color="#E5E5E5">some ways to bridge connectivity or</font>

291
00:10:29,559 --> 00:10:36,219
pivot into the host operating<font color="#CCCCCC"> system</font><font color="#E5E5E5"> all</font>

292
00:10:33,970 --> 00:10:37,660
right<font color="#E5E5E5"> so we talked</font><font color="#CCCCCC"> about this in theory</font>

293
00:10:36,220 --> 00:10:40,240
<font color="#E5E5E5">so I'm gonna talk</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> some kind of</font>

294
00:10:37,660 --> 00:10:43,029
realistic examples right so the<font color="#E5E5E5"> first is</font>

295
00:10:40,240 --> 00:10:45,939
we're an attacker<font color="#E5E5E5"> and we compromised</font><font color="#CCCCCC"> a</font>

296
00:10:43,029 --> 00:10:47,470
<font color="#CCCCCC">developer's laptop</font><font color="#E5E5E5"> so we get on this</font>

297
00:10:45,939 --> 00:10:50,649
developers laptop and through them we're

298
00:10:47,470 --> 00:10:52,779
able to compromise<font color="#CCCCCC"> get and Jenkins we</font>

299
00:10:50,649 --> 00:10:54,910
use that we backdoor some test cases<font color="#CCCCCC"> and</font>

300
00:10:52,779 --> 00:10:55,850
<font color="#CCCCCC">we compromise</font><font color="#E5E5E5"> the Jenkins CI server</font>

301
00:10:54,910 --> 00:10:58,699
itself

302
00:10:55,850 --> 00:11:02,360
<font color="#E5E5E5">it can push code to a variety</font><font color="#CCCCCC"> places</font><font color="#E5E5E5"> and</font>

303
00:10:58,699 --> 00:11:04,849
it has executors<font color="#CCCCCC"> slaves so executors do</font>

304
00:11:02,360 --> 00:11:07,430
builds for<font color="#CCCCCC"> this for the</font><font color="#E5E5E5"> Jenkins server</font>

305
00:11:04,850 --> 00:11:08,930
<font color="#E5E5E5">and they tend to be other systems that</font>

306
00:11:07,430 --> 00:11:10,489
could be dedicated<font color="#CCCCCC"> servers</font><font color="#E5E5E5"> over they</font>

307
00:11:08,930 --> 00:11:12,109
could just be<font color="#CCCCCC"> multi-use systems that</font>

308
00:11:10,490 --> 00:11:14,690
<font color="#E5E5E5">tend to have additional available</font>

309
00:11:12,110 --> 00:11:16,490
<font color="#E5E5E5">resources because we</font><font color="#CCCCCC"> have</font><font color="#E5E5E5"> control</font>

310
00:11:14,690 --> 00:11:18,649
<font color="#E5E5E5">Jenkins we can push our</font><font color="#CCCCCC"> betrayer code to</font>

311
00:11:16,490 --> 00:11:20,300
all these executors<font color="#CCCCCC"> so now we have c2 of</font>

312
00:11:18,649 --> 00:11:22,069
<font color="#CCCCCC">all the executors that are paired</font><font color="#E5E5E5"> and</font>

313
00:11:20,300 --> 00:11:24,829
anything that's pair that<font color="#E5E5E5"> is pulling</font>

314
00:11:22,069 --> 00:11:26,750
code from the CI pipeline<font color="#CCCCCC"> so from there</font>

315
00:11:24,829 --> 00:11:28,819
<font color="#CCCCCC">we</font><font color="#E5E5E5"> can inject whatever we want and we do</font>

316
00:11:26,750 --> 00:11:30,259
we<font color="#E5E5E5"> compromise some executors we</font>

317
00:11:28,819 --> 00:11:34,339
<font color="#CCCCCC">eventually get on a system</font><font color="#E5E5E5"> that allows</font>

318
00:11:30,259 --> 00:11:36,980
<font color="#CCCCCC">us to write directly</font><font color="#E5E5E5"> to the chef repo we</font>

319
00:11:34,339 --> 00:11:39,620
modify the chef repo and<font color="#E5E5E5"> add some data</font>

320
00:11:36,980 --> 00:11:42,290
bags<font color="#E5E5E5"> and cookbooks and in one of those</font>

321
00:11:39,620 --> 00:11:44,269
cookbooks<font color="#CCCCCC"> is a reverse shell recipe it</font>

322
00:11:42,290 --> 00:11:46,459
turns out this is<font color="#CCCCCC"> that</font><font color="#E5E5E5"> invalidation of</font>

323
00:11:44,269 --> 00:11:47,899
trust is that that production

324
00:11:46,459 --> 00:11:49,279
<font color="#E5E5E5">environment was actually</font><font color="#CCCCCC"> getting its</font>

325
00:11:47,899 --> 00:11:51,079
<font color="#E5E5E5">chef</font><font color="#CCCCCC"> configuration</font><font color="#E5E5E5"> from the chef and</font>

326
00:11:49,279 --> 00:11:55,160
staging<font color="#E5E5E5"> so because of</font><font color="#CCCCCC"> that we were able</font>

327
00:11:51,079 --> 00:11:56,540
<font color="#CCCCCC">to push reverse shell recipes to each of</font>

328
00:11:55,160 --> 00:11:59,120
the production systems when<font color="#E5E5E5"> they checked</font>

329
00:11:56,540 --> 00:12:00,829
in and get<font color="#CCCCCC"> reverse shells out of prod to</font>

330
00:11:59,120 --> 00:12:02,959
us and have<font color="#CCCCCC"> bridged</font><font color="#E5E5E5"> that relationship</font>

331
00:12:00,829 --> 00:12:04,729
between staging that was supposed to be

332
00:12:02,959 --> 00:12:06,050
relatively restricted<font color="#CCCCCC"> into the</font>

333
00:12:04,730 --> 00:12:09,709
production<font color="#E5E5E5"> environment</font><font color="#CCCCCC"> take</font><font color="#E5E5E5"> control of</font>

334
00:12:06,050 --> 00:12:13,729
the<font color="#E5E5E5"> entire production environment so</font>

335
00:12:09,709 --> 00:12:15,649
another<font color="#CCCCCC"> example so</font><font color="#E5E5E5"> compromise dev laptop</font>

336
00:12:13,730 --> 00:12:17,779
<font color="#E5E5E5">Conroy's Jenkins and get again through</font>

337
00:12:15,649 --> 00:12:19,730
being able<font color="#CCCCCC"> to push some test</font><font color="#E5E5E5"> cases and</font>

338
00:12:17,779 --> 00:12:21,319
<font color="#E5E5E5">those kind of things</font><font color="#CCCCCC"> so we find that</font>

339
00:12:19,730 --> 00:12:23,240
<font color="#E5E5E5">what's happening is these builds are</font>

340
00:12:21,319 --> 00:12:25,250
happening they're<font color="#E5E5E5"> being pushed to kind</font>

341
00:12:23,240 --> 00:12:26,720
<font color="#E5E5E5">of an enclave that's supposed to be like</font>

342
00:12:25,250 --> 00:12:29,029
a clean source area where things<font color="#CCCCCC"> are</font>

343
00:12:26,720 --> 00:12:30,380
<font color="#CCCCCC">gonna be</font><font color="#E5E5E5"> checked through them</font><font color="#CCCCCC"> they're</font>

344
00:12:29,029 --> 00:12:32,779
gonna be manual code analysis and these

345
00:12:30,380 --> 00:12:34,189
kind of things<font color="#E5E5E5"> but there are a couple</font>

346
00:12:32,779 --> 00:12:36,800
that don't<font color="#E5E5E5"> go through as rigorous</font>

347
00:12:34,189 --> 00:12:38,089
detection<font color="#E5E5E5"> and they get pushed into this</font>

348
00:12:36,800 --> 00:12:40,519
secure Enclave that<font color="#E5E5E5"> then gets reproduced</font>

349
00:12:38,089 --> 00:12:42,110
into prod and some more secure staging

350
00:12:40,519 --> 00:12:44,209
environments<font color="#E5E5E5"> so even though we couldn't</font>

351
00:12:42,110 --> 00:12:46,509
route traffic<font color="#E5E5E5"> directly we were able</font><font color="#CCCCCC"> to</font>

352
00:12:44,209 --> 00:12:49,670
backdoor some of these code repos<font color="#CCCCCC"> and</font>

353
00:12:46,509 --> 00:12:52,069
tests<font color="#E5E5E5"> and then when the the builds were</font>

354
00:12:49,670 --> 00:12:53,689
ran<font color="#E5E5E5"> actually pushed our code and</font>

355
00:12:52,069 --> 00:12:54,769
deployed it into the<font color="#E5E5E5"> environment</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> we</font>

356
00:12:53,689 --> 00:12:56,389
were able<font color="#CCCCCC"> to</font><font color="#E5E5E5"> then affect those</font>

357
00:12:54,769 --> 00:13:01,459
production systems<font color="#E5E5E5"> without ever routing</font>

358
00:12:56,389 --> 00:13:03,860
a packet<font color="#CCCCCC"> to them and most</font><font color="#E5E5E5"> of this was</font>

359
00:13:01,459 --> 00:13:05,000
<font color="#CCCCCC">through like unit tests right</font><font color="#E5E5E5"> but for</font>

360
00:13:03,860 --> 00:13:06,139
<font color="#CCCCCC">the</font><font color="#E5E5E5"> most part mini developers won't</font>

361
00:13:05,000 --> 00:13:07,459
<font color="#E5E5E5">really have a problem</font><font color="#CCCCCC"> with</font><font color="#E5E5E5"> if the tests</font>

362
00:13:06,139 --> 00:13:09,440
pass<font color="#E5E5E5"> everything looks good and there's</font>

363
00:13:07,459 --> 00:13:13,638
no errors hey great<font color="#E5E5E5"> let's move</font><font color="#CCCCCC"> on</font>

364
00:13:09,440 --> 00:13:15,649
right<font color="#E5E5E5"> so with that the point with all</font>

365
00:13:13,639 --> 00:13:18,290
this is<font color="#E5E5E5"> that we did this a lot manually</font>

366
00:13:15,649 --> 00:13:19,370
<font color="#E5E5E5">and it's pretty frustrating and</font><font color="#CCCCCC"> you have</font>

367
00:13:18,290 --> 00:13:22,370
to tailor everything to everything

368
00:13:19,370 --> 00:13:26,329
<font color="#CCCCCC">you're doing</font><font color="#E5E5E5"> so Clint happens to be a</font>

369
00:13:22,370 --> 00:13:27,500
very skilled developer<font color="#CCCCCC"> and well you can</font>

370
00:13:26,329 --> 00:13:30,500
write<font color="#E5E5E5"> better code than I can for</font><font color="#CCCCCC"> sure</font>

371
00:13:27,500 --> 00:13:31,819
and so we put our heads<font color="#CCCCCC"> together and he</font>

372
00:13:30,500 --> 00:13:33,439
wrote a tool called get<font color="#E5E5E5"> pwned</font>

373
00:13:31,819 --> 00:13:36,920
and what<font color="#CCCCCC"> pass-off</font><font color="#E5E5E5"> him to talk about it</font>

374
00:13:33,439 --> 00:13:40,610
all right<font color="#CCCCCC"> Thank You</font><font color="#E5E5E5"> Noah</font><font color="#CCCCCC"> I told him not</font>

375
00:13:36,920 --> 00:13:42,349
<font color="#CCCCCC">to say</font><font color="#E5E5E5"> that but he did all right so yes</font>

376
00:13:40,610 --> 00:13:44,389
so we found ourselves in<font color="#E5E5E5"> the interesting</font>

377
00:13:42,350 --> 00:13:46,279
<font color="#E5E5E5">places a number of times on tests where</font>

378
00:13:44,389 --> 00:13:47,449
we manually back<font color="#E5E5E5"> toward some things and</font>

379
00:13:46,279 --> 00:13:49,310
we<font color="#E5E5E5"> thought it would be nice to automate</font>

380
00:13:47,449 --> 00:13:51,199
this<font color="#E5E5E5"> a bit both to make our pen test</font>

381
00:13:49,310 --> 00:13:53,180
more effective as well as sort<font color="#CCCCCC"> of to</font>

382
00:13:51,199 --> 00:13:54,620
share<font color="#E5E5E5"> with the community</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> before I</font>

383
00:13:53,180 --> 00:13:56,870
get<font color="#E5E5E5"> into</font><font color="#CCCCCC"> the specific</font><font color="#E5E5E5"> architectural</font>

384
00:13:54,620 --> 00:13:58,790
decisions we made let's take a step<font color="#E5E5E5"> back</font>

385
00:13:56,870 --> 00:14:01,850
and just<font color="#E5E5E5"> very simplistically look at</font>

386
00:13:58,790 --> 00:14:03,050
command and control<font color="#E5E5E5"> or</font><font color="#CCCCCC"> c2 in general so</font>

387
00:14:01,850 --> 00:14:05,540
in the very<font color="#E5E5E5"> simplest case you have a</font>

388
00:14:03,050 --> 00:14:06,589
server which is sending<font color="#E5E5E5"> commands to one</font>

389
00:14:05,540 --> 00:14:08,509
or more machines you've compromised

390
00:14:06,589 --> 00:14:10,310
which then runs<font color="#E5E5E5"> those commands and then</font>

391
00:14:08,509 --> 00:14:13,160
sends the results back fundamentally

392
00:14:10,310 --> 00:14:15,500
this is<font color="#E5E5E5"> the core of what command and</font>

393
00:14:13,160 --> 00:14:16,699
control is so maybe if you<font color="#E5E5E5"> want to be a</font>

394
00:14:15,500 --> 00:14:19,670
<font color="#E5E5E5">little bit tricky maybe instead of using</font>

395
00:14:16,699 --> 00:14:22,008
<font color="#E5E5E5">HTTP use IRC DNS or try to</font><font color="#CCCCCC"> office gate</font>

396
00:14:19,670 --> 00:14:24,769
in some other way so traditionally

397
00:14:22,009 --> 00:14:27,560
defenses have focused on either<font color="#E5E5E5"> things</font>

398
00:14:24,769 --> 00:14:30,709
on say<font color="#E5E5E5"> host machines or on network</font><font color="#CCCCCC"> so on</font>

399
00:14:27,560 --> 00:14:32,599
the host machines sometimes<font color="#E5E5E5"> defenses</font>

400
00:14:30,709 --> 00:14:34,189
will look for agent like processes so is

401
00:14:32,600 --> 00:14:36,589
there some process that's<font color="#CCCCCC"> spinning up</font>

402
00:14:34,189 --> 00:14:38,209
every 60 seconds<font color="#E5E5E5"> or five minutes and</font>

403
00:14:36,589 --> 00:14:39,889
doing a set of<font color="#E5E5E5"> actions and then stopping</font>

404
00:14:38,209 --> 00:14:42,349
regardless of what user activity is

405
00:14:39,889 --> 00:14:44,300
<font color="#CCCCCC">happening on the system</font><font color="#E5E5E5"> or perhaps</font>

406
00:14:42,350 --> 00:14:47,000
<font color="#E5E5E5">they're looking for unusual behavior so</font>

407
00:14:44,300 --> 00:14:48,410
is this<font color="#E5E5E5"> accountant laptop suddenly</font>

408
00:14:47,000 --> 00:14:50,810
trying<font color="#E5E5E5"> to SSH into</font><font color="#CCCCCC"> a bunch of machines</font>

409
00:14:48,410 --> 00:14:52,250
<font color="#E5E5E5">or</font><font color="#CCCCCC"> port scan or maybe it's accessing</font>

410
00:14:50,810 --> 00:14:54,739
sensitive<font color="#E5E5E5"> information that normally it</font>

411
00:14:52,250 --> 00:14:56,689
shouldn't need access<font color="#E5E5E5"> to or on the</font>

412
00:14:54,740 --> 00:14:58,850
network side is a machine talking with

413
00:14:56,689 --> 00:15:00,829
unknown hosts or<font color="#CCCCCC"> IPS</font><font color="#E5E5E5"> that it shouldn't</font>

414
00:14:58,850 --> 00:15:03,189
<font color="#E5E5E5">be or perhaps looking at traffic</font>

415
00:15:00,829 --> 00:15:05,180
contents itself for malicious activity

416
00:15:03,189 --> 00:15:07,339
so we knew when we<font color="#E5E5E5"> were designing the</font>

417
00:15:05,180 --> 00:15:10,758
system we<font color="#E5E5E5"> want to communicate with</font>

418
00:15:07,339 --> 00:15:12,649
trusted<font color="#E5E5E5"> network parties some network</font>

419
00:15:10,759 --> 00:15:14,569
endpoints that<font color="#E5E5E5"> the machines should be</font>

420
00:15:12,649 --> 00:15:16,160
talking with or it's not unexpected<font color="#CCCCCC"> and</font>

421
00:15:14,569 --> 00:15:17,930
we also want to<font color="#E5E5E5"> mimic user behavior so</font>

422
00:15:16,160 --> 00:15:20,449
<font color="#CCCCCC">that we don't appear like an agent that</font>

423
00:15:17,930 --> 00:15:21,680
just is running unconnected to user

424
00:15:20,449 --> 00:15:24,329
behavior

425
00:15:21,680 --> 00:15:26,719
okay so just<font color="#E5E5E5"> explicitly talking about</font>

426
00:15:24,330 --> 00:15:29,100
<font color="#E5E5E5">some</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> our hashtag goals</font>

427
00:15:26,720 --> 00:15:30,600
just typical<font color="#E5E5E5"> command control we</font><font color="#CCCCCC"> need</font><font color="#E5E5E5"> to</font>

428
00:15:29,100 --> 00:15:32,640
be able<font color="#E5E5E5"> to send commands and get the</font>

429
00:15:30,600 --> 00:15:34,800
results we need to communicate<font color="#CCCCCC"> via</font>

430
00:15:32,640 --> 00:15:37,470
trusted party<font color="#CCCCCC"> we want to mimic user</font>

431
00:15:34,800 --> 00:15:40,290
behavior<font color="#CCCCCC"> and as some</font><font color="#E5E5E5"> sort of sub goals</font>

432
00:15:37,470 --> 00:15:41,370
we want<font color="#E5E5E5"> to limit forensics so if someone</font>

433
00:15:40,290 --> 00:15:42,510
notices<font color="#E5E5E5"> something is</font><font color="#CCCCCC"> sort of</font><font color="#E5E5E5"> fish we</font>

434
00:15:41,370 --> 00:15:44,100
<font color="#E5E5E5">want to make it hard</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> them to figure</font>

435
00:15:42,510 --> 00:15:46,620
<font color="#E5E5E5">out exactly what we've done</font><font color="#CCCCCC"> and how</font>

436
00:15:44,100 --> 00:15:47,820
we're<font color="#CCCCCC"> operating and as a practical</font><font color="#E5E5E5"> note</font>

437
00:15:46,620 --> 00:15:50,250
we<font color="#CCCCCC"> also want to limit</font><font color="#E5E5E5"> the blast radius</font>

438
00:15:47,820 --> 00:15:52,080
<font color="#E5E5E5">right so if we're doing a pen test for a</font>

439
00:15:50,250 --> 00:15:53,850
<font color="#CCCCCC">specific company we don't want to</font>

440
00:15:52,080 --> 00:15:58,640
compromise<font color="#CCCCCC"> someone</font><font color="#E5E5E5"> from another company</font>

441
00:15:53,850 --> 00:16:00,900
<font color="#E5E5E5">because that'd be bad news all right</font><font color="#CCCCCC"> so</font>

442
00:15:58,640 --> 00:16:03,930
simplistically<font color="#CCCCCC"> let's say we have an</font>

443
00:16:00,900 --> 00:16:06,390
initial foothold<font color="#E5E5E5"> on a machine</font><font color="#CCCCCC"> say Jo dev</font>

444
00:16:03,930 --> 00:16:08,250
how we get<font color="#E5E5E5"> this initial foothold is sort</font>

445
00:16:06,390 --> 00:16:09,780
<font color="#E5E5E5">of out of scope for this work maybe we</font>

446
00:16:08,250 --> 00:16:12,390
did<font color="#E5E5E5"> spearfishing maybe we got them to</font>

447
00:16:09,780 --> 00:16:13,920
run some code<font color="#CCCCCC"> we backdoored however so</font>

448
00:16:12,390 --> 00:16:16,350
simplistically we might say<font color="#E5E5E5"> okay we have</font>

449
00:16:13,920 --> 00:16:19,050
a server you know let's<font color="#CCCCCC"> just send</font>

450
00:16:16,350 --> 00:16:22,500
commands and<font color="#E5E5E5"> get</font><font color="#CCCCCC"> results via that but</font>

451
00:16:19,050 --> 00:16:24,660
again<font color="#E5E5E5"> it's unlikely that these machines</font>

452
00:16:22,500 --> 00:16:26,190
will<font color="#CCCCCC"> have a prior relationship</font><font color="#E5E5E5"> to</font>

453
00:16:24,660 --> 00:16:28,620
talking<font color="#E5E5E5"> with us so if we do that it's</font>

454
00:16:26,190 --> 00:16:30,540
<font color="#CCCCCC">it's like hey why why are these</font><font color="#E5E5E5"> machines</font>

455
00:16:28,620 --> 00:16:33,240
<font color="#E5E5E5">talking</font><font color="#CCCCCC"> at this</font><font color="#E5E5E5"> external machine that we</font>

456
00:16:30,540 --> 00:16:35,250
don't trust<font color="#E5E5E5"> so we can't do that</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> if</font>

457
00:16:33,240 --> 00:16:37,700
we step<font color="#CCCCCC"> back and</font><font color="#E5E5E5"> think</font><font color="#CCCCCC"> okay so developer</font>

458
00:16:35,250 --> 00:16:40,470
what developers normally do<font color="#E5E5E5"> oftentimes</font>

459
00:16:37,700 --> 00:16:42,810
<font color="#E5E5E5">developers are</font><font color="#CCCCCC"> using open-source</font>

460
00:16:40,470 --> 00:16:45,000
<font color="#CCCCCC">libraries</font><font color="#E5E5E5"> that's hosted on github</font><font color="#CCCCCC"> or</font>

461
00:16:42,810 --> 00:16:46,410
<font color="#CCCCCC">perhaps they their company's code is</font>

462
00:16:45,000 --> 00:16:47,610
<font color="#CCCCCC">hosted on github or maybe they</font><font color="#E5E5E5"> just have</font>

463
00:16:46,410 --> 00:16:49,860
personal repos that<font color="#E5E5E5"> they're working on</font>

464
00:16:47,610 --> 00:16:51,930
so<font color="#CCCCCC"> many developer machines</font><font color="#E5E5E5"> it would be</font>

465
00:16:49,860 --> 00:16:54,120
not surprising<font color="#E5E5E5"> to see them communicating</font>

466
00:16:51,930 --> 00:16:56,209
<font color="#CCCCCC">with</font><font color="#E5E5E5"> github</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> so if somehow we can</font>

467
00:16:54,120 --> 00:16:58,290
use<font color="#CCCCCC"> github as a command control platform</font>

468
00:16:56,210 --> 00:17:00,510
<font color="#E5E5E5">this would fulfill the goal of</font>

469
00:16:58,290 --> 00:17:03,240
communicating<font color="#E5E5E5"> with a trusted party okay</font>

470
00:17:00,510 --> 00:17:05,040
so how are<font color="#E5E5E5"> we gonna do</font><font color="#CCCCCC"> that so</font><font color="#E5E5E5"> again we</font>

471
00:17:03,240 --> 00:17:08,069
need<font color="#E5E5E5"> to be</font><font color="#CCCCCC"> able to send commands and get</font>

472
00:17:05,040 --> 00:17:10,199
results<font color="#E5E5E5"> back so what are the types</font><font color="#CCCCCC"> of</font>

473
00:17:08,069 --> 00:17:12,689
<font color="#E5E5E5">things that github will allow us</font><font color="#CCCCCC"> to host</font>

474
00:17:10,199 --> 00:17:14,010
so<font color="#E5E5E5"> okay so we can make gist or we can</font>

475
00:17:12,690 --> 00:17:15,209
have get repos<font color="#E5E5E5"> and there's probably a</font>

476
00:17:14,010 --> 00:17:17,490
handful<font color="#E5E5E5"> of others but these are the main</font>

477
00:17:15,209 --> 00:17:19,589
ones<font color="#E5E5E5"> so we could have our attacker</font>

478
00:17:17,490 --> 00:17:21,870
server created just with<font color="#E5E5E5"> commands which</font>

479
00:17:19,589 --> 00:17:23,458
then is pulled down by the compromised

480
00:17:21,869 --> 00:17:28,079
machines and then they create just as

481
00:17:23,459 --> 00:17:31,320
<font color="#E5E5E5">sort of a result of those however in</font>

482
00:17:28,079 --> 00:17:33,090
terms<font color="#E5E5E5"> of sending commands</font><font color="#CCCCCC"> to a specific</font>

483
00:17:31,320 --> 00:17:34,879
machine<font color="#E5E5E5"> or being able to easily collect</font>

484
00:17:33,090 --> 00:17:36,320
all of the gist with

485
00:17:34,880 --> 00:17:40,070
but and<font color="#E5E5E5"> that might be a little bit</font>

486
00:17:36,320 --> 00:17:42,919
difficult<font color="#E5E5E5"> and also it's not common to be</font>

487
00:17:40,070 --> 00:17:44,960
creating many<font color="#E5E5E5"> gifs and reading from them</font>

488
00:17:42,920 --> 00:17:47,810
so behavior wise this<font color="#E5E5E5"> might look a</font>

489
00:17:44,960 --> 00:17:49,550
little<font color="#E5E5E5"> bit anomalous so</font><font color="#CCCCCC"> look let's</font><font color="#E5E5E5"> not</font>

490
00:17:47,810 --> 00:17:52,340
do that<font color="#CCCCCC"> for the main command and control</font>

491
00:17:49,550 --> 00:17:54,470
mechanism let's instead use git repos so

492
00:17:52,340 --> 00:17:56,750
if you think<font color="#CCCCCC"> about</font><font color="#E5E5E5"> it we could commit</font>

493
00:17:54,470 --> 00:17:59,360
commands<font color="#CCCCCC"> into the repo</font><font color="#E5E5E5"> which I then get</font>

494
00:17:56,750 --> 00:18:01,070
pulled<font color="#CCCCCC"> down by the compromise machines</font>

495
00:17:59,360 --> 00:18:02,990
<font color="#CCCCCC">then they run the commands</font><font color="#E5E5E5"> and then</font>

496
00:18:01,070 --> 00:18:06,740
commit them back<font color="#E5E5E5"> into the code and then</font>

497
00:18:02,990 --> 00:18:08,270
push them to our repo<font color="#E5E5E5"> so what we end up</font>

498
00:18:06,740 --> 00:18:10,130
<font color="#E5E5E5">doing is having a malicious command and</font>

499
00:18:08,270 --> 00:18:14,090
control repo hosted on github<font color="#E5E5E5"> and we'll</font>

500
00:18:10,130 --> 00:18:16,190
talk<font color="#E5E5E5"> more about this shortly</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> so</font>

501
00:18:14,090 --> 00:18:19,459
that's how we can<font color="#CCCCCC"> do command control</font>

502
00:18:16,190 --> 00:18:20,900
but again<font color="#E5E5E5"> so the fourth</font><font color="#CCCCCC"> goal how do we</font>

503
00:18:19,460 --> 00:18:23,690
limit forensics how do we limit blast

504
00:18:20,900 --> 00:18:25,370
radius<font color="#CCCCCC"> we can do a reasonable job at</font>

505
00:18:23,690 --> 00:18:27,200
<font color="#E5E5E5">this by just</font><font color="#CCCCCC"> making it a private</font><font color="#E5E5E5"> repo so</font>

506
00:18:25,370 --> 00:18:29,300
now only people who we give permission

507
00:18:27,200 --> 00:18:34,070
<font color="#E5E5E5">to read or write this repo only they</font>

508
00:18:29,300 --> 00:18:36,950
<font color="#E5E5E5">will have access</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> okay so that does</font>

509
00:18:34,070 --> 00:18:39,010
<font color="#E5E5E5">that and</font><font color="#CCCCCC"> ok</font><font color="#E5E5E5"> so we still need to mimic</font>

510
00:18:36,950 --> 00:18:43,280
user behavior<font color="#CCCCCC"> so if you're</font><font color="#E5E5E5"> not familiar</font>

511
00:18:39,010 --> 00:18:45,770
there's a number<font color="#E5E5E5"> of in every git repo</font>

512
00:18:43,280 --> 00:18:47,210
there's a dot<font color="#E5E5E5"> git folder and it has a</font>

513
00:18:45,770 --> 00:18:49,610
bunch<font color="#E5E5E5"> of files in it so for example a</font>

514
00:18:47,210 --> 00:18:51,980
config file which has branch information

515
00:18:49,610 --> 00:18:53,629
origin information user settings<font color="#E5E5E5"> things</font>

516
00:18:51,980 --> 00:18:55,790
like that<font color="#E5E5E5"> there's also a directory</font>

517
00:18:53,630 --> 00:18:57,920
called a<font color="#E5E5E5"> hooks directory and so what a</font>

518
00:18:55,790 --> 00:18:59,750
git hook is is it's basically<font color="#E5E5E5"> an</font>

519
00:18:57,920 --> 00:19:01,430
arbitrary piece of code that<font color="#E5E5E5"> runs</font>

520
00:18:59,750 --> 00:19:03,890
whenever a<font color="#E5E5E5"> user is doing a state</font>

521
00:19:01,430 --> 00:19:07,550
changing get action so for<font color="#E5E5E5"> example</font><font color="#CCCCCC"> the</font>

522
00:19:03,890 --> 00:19:08,840
pre-commit hook<font color="#E5E5E5"> if you run a git</font><font color="#CCCCCC"> commit</font>

523
00:19:07,550 --> 00:19:10,419
and then<font color="#E5E5E5"> right before it finishes</font>

524
00:19:08,840 --> 00:19:13,429
committing it'll run this arbitrary

525
00:19:10,420 --> 00:19:16,430
pre-commit hook<font color="#CCCCCC"> which can say oh yeah</font>

526
00:19:13,430 --> 00:19:17,630
<font color="#CCCCCC">make sure to specify a descriptive</font>

527
00:19:16,430 --> 00:19:20,300
message or make<font color="#CCCCCC"> sure</font><font color="#E5E5E5"> that your code</font>

528
00:19:17,630 --> 00:19:22,550
<font color="#E5E5E5">fulfills various coding standards things</font>

529
00:19:20,300 --> 00:19:23,930
like that<font color="#CCCCCC"> so the important part about</font>

530
00:19:22,550 --> 00:19:25,070
git hooks is<font color="#E5E5E5"> it has two important</font>

531
00:19:23,930 --> 00:19:27,410
<font color="#CCCCCC">properties for us</font>

532
00:19:25,070 --> 00:19:29,300
<font color="#E5E5E5">one is that git hooks are not in version</font>

533
00:19:27,410 --> 00:19:32,510
control so we<font color="#E5E5E5"> can arbitrarily modify</font>

534
00:19:29,300 --> 00:19:33,110
them and if the user says get status or

535
00:19:32,510 --> 00:19:34,790
<font color="#E5E5E5">something like that</font>

536
00:19:33,110 --> 00:19:36,919
<font color="#E5E5E5">unless they're specifically looking</font><font color="#CCCCCC"> in</font>

537
00:19:34,790 --> 00:19:39,139
the github folder they won't see any

538
00:19:36,920 --> 00:19:40,940
change right and then the second

539
00:19:39,140 --> 00:19:42,760
property<font color="#E5E5E5"> is because each kid hook</font>

540
00:19:40,940 --> 00:19:45,140
happens as a result<font color="#CCCCCC"> of</font><font color="#E5E5E5"> user behavior</font>

541
00:19:42,760 --> 00:19:47,090
<font color="#E5E5E5">basically by modifying them inputting</font>

542
00:19:45,140 --> 00:19:48,450
malicious behavior<font color="#CCCCCC"> and a get hook when a</font>

543
00:19:47,090 --> 00:19:50,220
<font color="#E5E5E5">developer goes about their norm</font>

544
00:19:48,450 --> 00:19:52,350
development tasks<font color="#E5E5E5"> using just standard</font>

545
00:19:50,220 --> 00:19:53,850
git commands<font color="#CCCCCC"> we're</font><font color="#E5E5E5"> basically taking on</font>

546
00:19:52,350 --> 00:19:56,610
<font color="#CCCCCC">additional functionality that happens</font>

547
00:19:53,850 --> 00:19:58,169
<font color="#E5E5E5">after it so that to a certain monitoring</font>

548
00:19:56,610 --> 00:20:00,300
system<font color="#E5E5E5"> that</font><font color="#CCCCCC"> looks like</font><font color="#E5E5E5"> okay</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> they're</font>

549
00:19:58,170 --> 00:20:01,290
just<font color="#E5E5E5"> do we normal get workflow and then</font>

550
00:20:00,300 --> 00:20:06,240
just a<font color="#E5E5E5"> couple of other things</font><font color="#CCCCCC"> are</font>

551
00:20:01,290 --> 00:20:07,620
<font color="#E5E5E5">happening as well so that fulfills our</font>

552
00:20:06,240 --> 00:20:09,390
<font color="#E5E5E5">goal of mimicking user behavior so</font>

553
00:20:07,620 --> 00:20:11,280
rather than running every 60 seconds or

554
00:20:09,390 --> 00:20:13,080
<font color="#CCCCCC">something that's very agent like we're</font>

555
00:20:11,280 --> 00:20:16,800
instead sort of tacking on<font color="#CCCCCC"> to standard</font>

556
00:20:13,080 --> 00:20:19,770
user behavior<font color="#CCCCCC"> so just a quick</font><font color="#E5E5E5"> summary</font>

557
00:20:16,800 --> 00:20:22,230
<font color="#E5E5E5">we're using github to host the command</font>

558
00:20:19,770 --> 00:20:24,420
and control<font color="#CCCCCC"> a private git repo as the</font>

559
00:20:22,230 --> 00:20:28,050
transport layer<font color="#CCCCCC"> and we're using git</font>

560
00:20:24,420 --> 00:20:29,640
hooks<font color="#CCCCCC"> to mimic user behavior okay so</font>

561
00:20:28,050 --> 00:20:31,020
that's a lot<font color="#CCCCCC"> of text we're gonna</font><font color="#E5E5E5"> do a</font>

562
00:20:29,640 --> 00:20:34,110
<font color="#E5E5E5">bunch of diagrams that walk through it</font>

563
00:20:31,020 --> 00:20:36,510
so there's four primary<font color="#E5E5E5"> steps so first</font>

564
00:20:34,110 --> 00:20:37,860
<font color="#E5E5E5">some initial reconnaissance then setting</font>

565
00:20:36,510 --> 00:20:39,660
everything up<font color="#E5E5E5"> then we're going to</font>

566
00:20:37,860 --> 00:20:42,149
<font color="#E5E5E5">establish persistence on initial machine</font>

567
00:20:39,660 --> 00:20:43,830
which has<font color="#E5E5E5"> an initial bootstrapping and</font>

568
00:20:42,150 --> 00:20:47,270
then running the agent<font color="#E5E5E5"> and then we can</font>

569
00:20:43,830 --> 00:20:48,510
<font color="#E5E5E5">spread across machines and environments</font>

570
00:20:47,270 --> 00:20:50,040
<font color="#E5E5E5">okay</font>

571
00:20:48,510 --> 00:20:52,320
so let's say<font color="#E5E5E5"> again we have this initial</font>

572
00:20:50,040 --> 00:20:53,639
foothold on<font color="#CCCCCC"> Jo dev and we're wanting to</font>

573
00:20:52,320 --> 00:20:54,870
<font color="#E5E5E5">figure out you know what does this</font>

574
00:20:53,640 --> 00:20:56,430
company's development environment like

575
00:20:54,870 --> 00:20:57,719
what languages do they use what

576
00:20:56,430 --> 00:21:00,990
frameworks do they use what would make

577
00:20:57,720 --> 00:21:02,730
sense<font color="#E5E5E5"> to be on</font><font color="#CCCCCC"> a machine</font><font color="#E5E5E5"> for the</font>

578
00:21:00,990 --> 00:21:04,800
specific company<font color="#CCCCCC"> so maybe you look at</font>

579
00:21:02,730 --> 00:21:06,150
their<font color="#E5E5E5"> github if they have a company</font>

580
00:21:04,800 --> 00:21:08,340
<font color="#E5E5E5">github you're like oh what is all their</font>

581
00:21:06,150 --> 00:21:10,530
code written<font color="#E5E5E5"> and or in this case we can</font>

582
00:21:08,340 --> 00:21:11,639
<font color="#E5E5E5">also look at one of their developers so</font>

583
00:21:10,530 --> 00:21:14,310
let's say we're<font color="#CCCCCC"> looking in their code</font>

584
00:21:11,640 --> 00:21:15,900
repo<font color="#E5E5E5"> and we see</font><font color="#CCCCCC"> disruptor which we just</font>

585
00:21:14,310 --> 00:21:18,179
happen<font color="#CCCCCC"> to know is</font><font color="#E5E5E5"> there a primary web</font>

586
00:21:15,900 --> 00:21:19,830
app<font color="#E5E5E5"> because this company is based out of</font>

587
00:21:18,180 --> 00:21:21,480
San<font color="#E5E5E5"> Francisco and they think that</font><font color="#CCCCCC"> a</font>

588
00:21:19,830 --> 00:21:23,490
disrupting is too slow<font color="#E5E5E5"> and they want to</font>

589
00:21:21,480 --> 00:21:26,100
disrupt disruption and<font color="#E5E5E5"> make it even more</font>

590
00:21:23,490 --> 00:21:30,000
disruptive<font color="#CCCCCC"> so that's the company we're</font>

591
00:21:26,100 --> 00:21:31,830
targeting<font color="#E5E5E5"> and yeah so we were we look</font>

592
00:21:30,000 --> 00:21:33,930
inside<font color="#E5E5E5"> it and we see a managed up</font><font color="#CCCCCC"> high</font>

593
00:21:31,830 --> 00:21:35,730
<font color="#CCCCCC">URL</font><font color="#E5E5E5"> stop hi and requirements</font><font color="#CCCCCC"> we look at</font>

594
00:21:33,930 --> 00:21:37,380
the requirements<font color="#CCCCCC"> and we see Gengo so we</font>

595
00:21:35,730 --> 00:21:39,360
<font color="#E5E5E5">think oh great</font>

596
00:21:37,380 --> 00:21:40,800
the primary web<font color="#E5E5E5"> app for this company is</font>

597
00:21:39,360 --> 00:21:42,899
<font color="#CCCCCC">django so they're probably a Python shop</font>

598
00:21:40,800 --> 00:21:44,960
and they<font color="#CCCCCC"> probably use Django</font><font color="#E5E5E5"> so the</font>

599
00:21:42,900 --> 00:21:47,520
second<font color="#E5E5E5"> step is</font><font color="#CCCCCC"> we want to choose a</font>

600
00:21:44,960 --> 00:21:50,880
popular open<font color="#CCCCCC"> source repo that fits into</font>

601
00:21:47,520 --> 00:21:53,190
<font color="#E5E5E5">this framework into this environment</font><font color="#CCCCCC"> so</font>

602
00:21:50,880 --> 00:21:56,850
when<font color="#CCCCCC"> python</font><font color="#E5E5E5"> example would be I P VB</font>

603
00:21:53,190 --> 00:21:59,400
which<font color="#E5E5E5"> is a popular debugging library</font><font color="#CCCCCC"> so</font>

604
00:21:56,850 --> 00:22:01,409
now we know three important things<font color="#E5E5E5"> one</font>

605
00:21:59,400 --> 00:22:04,170
we know<font color="#E5E5E5"> the language and framework of</font>

606
00:22:01,410 --> 00:22:06,120
company two we have an open source

607
00:22:04,170 --> 00:22:08,880
<font color="#E5E5E5">library that</font><font color="#CCCCCC"> makes sense in the context</font>

608
00:22:06,120 --> 00:22:10,949
of<font color="#E5E5E5"> their company</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> three if this</font>

609
00:22:08,880 --> 00:22:15,720
company<font color="#CCCCCC"> is</font><font color="#E5E5E5"> based in San</font><font color="#CCCCCC"> Francisco their</font>

610
00:22:10,950 --> 00:22:17,930
developer<font color="#E5E5E5"> probably looks like this</font><font color="#CCCCCC"> okay</font>

611
00:22:15,720 --> 00:22:20,670
so let's talk about<font color="#CCCCCC"> the</font><font color="#E5E5E5"> setup process</font><font color="#CCCCCC"> so</font>

612
00:22:17,930 --> 00:22:22,350
first we're<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> create personal access</font>

613
00:22:20,670 --> 00:22:24,750
tokens for two different github accounts

614
00:22:22,350 --> 00:22:26,459
<font color="#CCCCCC">a primary and a secondary one</font><font color="#E5E5E5"> and we're</font>

615
00:22:24,750 --> 00:22:28,170
gonna<font color="#E5E5E5"> talk in a second about why</font><font color="#CCCCCC"> two and</font>

616
00:22:26,460 --> 00:22:30,000
<font color="#E5E5E5">not just one and then we're going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> run</font>

617
00:22:28,170 --> 00:22:33,300
this<font color="#E5E5E5"> setup script</font><font color="#CCCCCC"> so what does the setup</font>

618
00:22:30,000 --> 00:22:35,520
script<font color="#E5E5E5"> - so first it's going to clone</font>

619
00:22:33,300 --> 00:22:37,830
<font color="#E5E5E5">this popular repo that you specified</font>

620
00:22:35,520 --> 00:22:40,889
<font color="#CCCCCC">onto</font><font color="#E5E5E5"> your server and then it's going to</font>

621
00:22:37,830 --> 00:22:43,110
<font color="#E5E5E5">basically copy or it's gonna clone that</font>

622
00:22:40,890 --> 00:22:46,140
and push it into<font color="#E5E5E5"> a private repo that we</font>

623
00:22:43,110 --> 00:22:49,169
control<font color="#E5E5E5"> using the primary account so the</font>

624
00:22:46,140 --> 00:22:51,000
primary attacker user is the owner of<font color="#CCCCCC"> it</font>

625
00:22:49,170 --> 00:22:53,130
as well as<font color="#CCCCCC"> a bootstrap gist which has</font>

626
00:22:51,000 --> 00:22:59,880
commands which sort of<font color="#CCCCCC"> we'll set up a</font>

627
00:22:53,130 --> 00:23:01,980
<font color="#CCCCCC">compromised machine</font><font color="#E5E5E5"> and so we need</font><font color="#CCCCCC"> to</font>

628
00:22:59,880 --> 00:23:03,600
give an unknown number<font color="#E5E5E5"> of parties both</font>

629
00:23:01,980 --> 00:23:04,890
read<font color="#CCCCCC"> and write access to this repo and</font>

630
00:23:03,600 --> 00:23:06,360
<font color="#E5E5E5">we don't necessarily know who they're</font>

631
00:23:04,890 --> 00:23:08,490
<font color="#E5E5E5">going to be ahead of time so how do you</font>

632
00:23:06,360 --> 00:23:10,199
give access to<font color="#CCCCCC"> people to a private repo</font>

633
00:23:08,490 --> 00:23:11,820
without necessarily knowing who ahead of

634
00:23:10,200 --> 00:23:14,220
time<font color="#CCCCCC"> so that's where the secondary</font>

635
00:23:11,820 --> 00:23:16,409
personal access<font color="#E5E5E5"> token comes in so in the</font>

636
00:23:14,220 --> 00:23:18,750
<font color="#E5E5E5">bootstrap script what we do is</font>

637
00:23:16,410 --> 00:23:21,560
essentially include that in the

638
00:23:18,750 --> 00:23:24,330
bootstrapping file<font color="#CCCCCC"> so</font><font color="#E5E5E5"> that anyone who</font><font color="#CCCCCC"> is</font>

639
00:23:21,560 --> 00:23:26,970
<font color="#E5E5E5">pulling down the bootstrap file using</font>

640
00:23:24,330 --> 00:23:28,320
<font color="#E5E5E5">this personal access token they can</font>

641
00:23:26,970 --> 00:23:31,140
basically<font color="#E5E5E5"> show it to github and</font><font color="#CCCCCC"> say hey</font>

642
00:23:28,320 --> 00:23:33,860
I have<font color="#CCCCCC"> permission as this user attacks</font>

643
00:23:31,140 --> 00:23:37,200
as this repo<font color="#CCCCCC"> so that's how we're able</font><font color="#E5E5E5"> to</font>

644
00:23:33,860 --> 00:23:38,189
have a compromise machines have access

645
00:23:37,200 --> 00:23:41,940
to the commands we're trying to give

646
00:23:38,190 --> 00:23:46,680
them as well as get<font color="#CCCCCC"> the payload content</font>

647
00:23:41,940 --> 00:23:48,870
back and if we<font color="#CCCCCC"> just use one account then</font>

648
00:23:46,680 --> 00:23:51,180
if say someone's doing forensics and

649
00:23:48,870 --> 00:23:53,100
then they<font color="#E5E5E5"> get this primary token then</font>

650
00:23:51,180 --> 00:23:55,140
<font color="#E5E5E5">they could potentially delete our repo</font>

651
00:23:53,100 --> 00:23:56,520
or do<font color="#E5E5E5"> anything we can do so it's sort of</font>

652
00:23:55,140 --> 00:23:59,970
a principle of<font color="#E5E5E5"> least privilege thing</font><font color="#CCCCCC"> as</font>

653
00:23:56,520 --> 00:24:02,250
why we're using two accounts<font color="#E5E5E5"> okay so</font>

654
00:23:59,970 --> 00:24:04,080
let's<font color="#E5E5E5"> quickly check in where are we</font><font color="#CCCCCC"> so</font>

655
00:24:02,250 --> 00:24:05,940
we know the targets primary language and

656
00:24:04,080 --> 00:24:07,530
<font color="#CCCCCC">framework so they're</font><font color="#E5E5E5"> using Django we've</font>

657
00:24:05,940 --> 00:24:10,800
<font color="#E5E5E5">chosen a popular library that fits into</font>

658
00:24:07,530 --> 00:24:12,990
<font color="#CCCCCC">there</font><font color="#E5E5E5"> such as IP</font><font color="#CCCCCC"> dB we've mirrored that</font>

659
00:24:10,800 --> 00:24:15,000
popular library in a private github repo

660
00:24:12,990 --> 00:24:15,240
and we've created a private<font color="#CCCCCC"> Geist</font><font color="#E5E5E5"> which</font>

661
00:24:15,000 --> 00:24:17,670
is

662
00:24:15,240 --> 00:24:19,679
<font color="#E5E5E5">bootstrap the process and so let's talk</font>

663
00:24:17,670 --> 00:24:23,730
<font color="#E5E5E5">about establishing persistence on a</font>

664
00:24:19,679 --> 00:24:26,970
compromised machine<font color="#E5E5E5"> okay</font>

665
00:24:23,730 --> 00:24:30,510
so<font color="#CCCCCC"> Jo dev has this internal web app</font><font color="#E5E5E5"> such</font>

666
00:24:26,970 --> 00:24:33,300
a disrupter that is belongs<font color="#E5E5E5"> to the</font>

667
00:24:30,510 --> 00:24:35,490
<font color="#E5E5E5">company so what we're going to do is we</font>

668
00:24:33,300 --> 00:24:38,129
want<font color="#CCCCCC"> to assert sort of a one-line</font>

669
00:24:35,490 --> 00:24:39,690
<font color="#E5E5E5">backdoor script such that whenever or</font>

670
00:24:38,130 --> 00:24:41,370
someone runs it then we back to other

671
00:24:39,690 --> 00:24:43,640
<font color="#CCCCCC">merge their machine and set up command</font>

672
00:24:41,370 --> 00:24:46,040
<font color="#E5E5E5">and control on it so we'll just</font>

673
00:24:43,640 --> 00:24:48,510
represent<font color="#E5E5E5"> that</font><font color="#CCCCCC"> by this little</font><font color="#E5E5E5"> red line</font>

674
00:24:46,040 --> 00:24:51,450
<font color="#E5E5E5">so we want to put this backdoor</font>

675
00:24:48,510 --> 00:24:53,790
one-liner<font color="#E5E5E5"> somewhere</font><font color="#CCCCCC"> that's run often but</font>

676
00:24:51,450 --> 00:24:56,070
it's perhaps not as<font color="#E5E5E5"> well vetted as other</font>

677
00:24:53,790 --> 00:24:58,230
<font color="#E5E5E5">places so maybe somewhere</font><font color="#CCCCCC"> in a test</font>

678
00:24:56,070 --> 00:25:02,010
suite<font color="#E5E5E5"> or in a build or a configuration</font>

679
00:24:58,230 --> 00:25:04,380
file something like that so specifically

680
00:25:02,010 --> 00:25:07,440
let's say in this disruptor<font color="#E5E5E5"> there's like</font>

681
00:25:04,380 --> 00:25:08,820
a test folder and we put this<font color="#CCCCCC"> one-liner</font>

682
00:25:07,440 --> 00:25:10,200
in there<font color="#E5E5E5"> which is going to set up the</font>

683
00:25:08,820 --> 00:25:12,960
bootstrapping<font color="#CCCCCC"> process which is</font>

684
00:25:10,200 --> 00:25:14,610
essentially<font color="#CCCCCC"> just curling the gist we set</font>

685
00:25:12,960 --> 00:25:17,790
up<font color="#E5E5E5"> and then piping it into Python so</font>

686
00:25:14,610 --> 00:25:19,800
it's<font color="#CCCCCC"> just a Python script</font><font color="#E5E5E5"> so when the</font>

687
00:25:17,790 --> 00:25:21,720
<font color="#CCCCCC">tech suite is run either</font><font color="#E5E5E5"> by us or</font><font color="#CCCCCC"> by Joe</font>

688
00:25:19,800 --> 00:25:25,169
dev<font color="#E5E5E5"> it's then going to curl this just</font>

689
00:25:21,720 --> 00:25:26,610
and then run it<font color="#E5E5E5"> so this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> this is the</font>

690
00:25:25,170 --> 00:25:29,100
same process<font color="#E5E5E5"> or the bootstrapping</font>

691
00:25:26,610 --> 00:25:30,270
process<font color="#CCCCCC"> so first we're going to</font><font color="#E5E5E5"> find</font>

692
00:25:29,100 --> 00:25:32,850
<font color="#E5E5E5">where are we going to clone this</font>

693
00:25:30,270 --> 00:25:36,389
<font color="#CCCCCC">command-and-control</font><font color="#E5E5E5"> repo down so we want</font>

694
00:25:32,850 --> 00:25:39,059
to put<font color="#E5E5E5"> it someplace that's normal it's</font>

695
00:25:36,390 --> 00:25:41,970
not<font color="#CCCCCC"> unexpected for it to be there so we</font>

696
00:25:39,059 --> 00:25:43,530
look at the<font color="#E5E5E5"> default user Python library</font>

697
00:25:41,970 --> 00:25:45,000
install<font color="#CCCCCC"> folder so all of their other</font>

698
00:25:43,530 --> 00:25:48,240
<font color="#CCCCCC">Python libraries are there and we</font><font color="#E5E5E5"> just</font>

699
00:25:45,000 --> 00:25:49,950
add another one<font color="#E5E5E5"> and again remain common</font>

700
00:25:48,240 --> 00:25:53,010
<font color="#CCCCCC">one so it's not unexpected</font><font color="#E5E5E5"> for it to be</font>

701
00:25:49,950 --> 00:25:57,630
there so after we find where we're<font color="#E5E5E5"> gonna</font>

702
00:25:53,010 --> 00:25:59,670
put it we then clone the repo down and

703
00:25:57,630 --> 00:26:02,130
put it<font color="#E5E5E5"> into</font><font color="#CCCCCC"> site packages so our</font>

704
00:25:59,670 --> 00:26:04,650
malicious IP<font color="#E5E5E5"> DB and this repo also has</font>

705
00:26:02,130 --> 00:26:06,570
an agent file<font color="#CCCCCC"> so the agent file is</font>

706
00:26:04,650 --> 00:26:09,090
responsible for<font color="#CCCCCC"> every time it runs</font><font color="#E5E5E5"> it's</font>

707
00:26:06,570 --> 00:26:11,010
pulling down<font color="#CCCCCC"> the</font><font color="#E5E5E5"> latest commands running</font>

708
00:26:09,090 --> 00:26:12,659
them committing it to<font color="#E5E5E5"> the repo and then</font>

709
00:26:11,010 --> 00:26:14,640
pushing it back<font color="#CCCCCC"> so it's</font><font color="#E5E5E5"> sort</font><font color="#CCCCCC"> of doing</font>

710
00:26:12,660 --> 00:26:17,340
<font color="#E5E5E5">the main agent processes so we take this</font>

711
00:26:14,640 --> 00:26:19,559
agent file and copy it into<font color="#E5E5E5"> a get hook</font>

712
00:26:17,340 --> 00:26:20,669
<font color="#E5E5E5">in this</font><font color="#CCCCCC"> command-and-control</font><font color="#E5E5E5"> repo so</font>

713
00:26:19,559 --> 00:26:22,320
again

714
00:26:20,670 --> 00:26:25,140
if someone goes<font color="#CCCCCC"> there and</font><font color="#E5E5E5"> runs get</font>

715
00:26:22,320 --> 00:26:27,720
status<font color="#CCCCCC"> nothing will be different</font><font color="#E5E5E5"> than</font>

716
00:26:25,140 --> 00:26:31,380
<font color="#E5E5E5">the default benign repo that we're</font>

717
00:26:27,720 --> 00:26:32,730
mirroring<font color="#E5E5E5"> so after that we so we've</font>

718
00:26:31,380 --> 00:26:34,260
installed<font color="#E5E5E5"> the agent file but we need it</font>

719
00:26:32,730 --> 00:26:36,630
<font color="#E5E5E5">to run periodically so how do we make it</font>

720
00:26:34,260 --> 00:26:39,390
<font color="#E5E5E5">run as mentioned previously</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> create a</font>

721
00:26:36,630 --> 00:26:42,600
series of<font color="#CCCCCC"> git hooks</font><font color="#E5E5E5"> in this disruptor</font>

722
00:26:39,390 --> 00:26:44,940
repo so as the developer is just

723
00:26:42,600 --> 00:26:47,010
committing code running<font color="#CCCCCC"> get pull or</font>

724
00:26:44,940 --> 00:26:48,540
pushing<font color="#E5E5E5"> things like that our agent will</font>

725
00:26:47,010 --> 00:26:53,750
be<font color="#E5E5E5"> running in addition to the standard</font>

726
00:26:48,540 --> 00:26:56,370
<font color="#CCCCCC">get functionality that</font><font color="#E5E5E5"> they expect and</font>

727
00:26:53,750 --> 00:26:58,110
again<font color="#E5E5E5"> after we're done</font><font color="#CCCCCC"> we basically</font>

728
00:26:56,370 --> 00:26:59,820
changed the<font color="#E5E5E5"> remote from pointing to our</font>

729
00:26:58,110 --> 00:27:01,350
malicious command control repo to the

730
00:26:59,820 --> 00:27:02,939
benign one so now if someone<font color="#CCCCCC"> were to</font>

731
00:27:01,350 --> 00:27:04,049
<font color="#E5E5E5">look at this at a point in time where</font>

732
00:27:02,940 --> 00:27:05,790
we're not actively doing something

733
00:27:04,049 --> 00:27:08,370
malicious<font color="#E5E5E5"> it's</font><font color="#CCCCCC"> going to look totally</font>

734
00:27:05,790 --> 00:27:10,830
benign<font color="#E5E5E5"> and then finally we're gonna run</font>

735
00:27:08,370 --> 00:27:13,620
the agent<font color="#E5E5E5"> itself so let's just quickly</font>

736
00:27:10,830 --> 00:27:15,720
<font color="#E5E5E5">walk through that</font><font color="#CCCCCC"> so this</font><font color="#E5E5E5"> is one</font><font color="#CCCCCC"> of the</font>

737
00:27:13,620 --> 00:27:18,389
state of the world<font color="#E5E5E5"> so the first step of</font>

738
00:27:15,720 --> 00:27:20,790
the agent is going to switch<font color="#CCCCCC"> to pointing</font>

739
00:27:18,390 --> 00:27:23,280
<font color="#E5E5E5">at our malicious remote which is then</font>

740
00:27:20,790 --> 00:27:25,830
going to pull<font color="#CCCCCC"> down any additional</font>

741
00:27:23,280 --> 00:27:27,418
<font color="#E5E5E5">commands so commands are basically</font><font color="#CCCCCC"> just</font>

742
00:27:25,830 --> 00:27:29,370
defined and currently in this payload

743
00:27:27,419 --> 00:27:31,500
file which is just<font color="#CCCCCC"> arbitrary</font><font color="#E5E5E5"> Python so</font>

744
00:27:29,370 --> 00:27:33,330
maybe you're<font color="#E5E5E5"> okay grab the the</font><font color="#CCCCCC"> current</font>

745
00:27:31,500 --> 00:27:35,220
users<font color="#E5E5E5"> username or MAC address or get all</font>

746
00:27:33,330 --> 00:27:36,899
the environment variables<font color="#E5E5E5"> basically</font>

747
00:27:35,220 --> 00:27:38,900
anything you<font color="#E5E5E5"> want the machine to</font><font color="#CCCCCC"> run</font><font color="#E5E5E5"> you</font>

748
00:27:36,900 --> 00:27:42,450
just<font color="#E5E5E5"> put in this</font><font color="#CCCCCC"> arbitrary</font><font color="#E5E5E5"> Python file</font>

749
00:27:38,900 --> 00:27:45,150
so the compromised<font color="#CCCCCC"> machine is going</font><font color="#E5E5E5"> to</font>

750
00:27:42,450 --> 00:27:47,730
run all<font color="#E5E5E5"> these things and then commit</font>

751
00:27:45,150 --> 00:27:50,669
them and then it's going<font color="#E5E5E5"> to push the</font>

752
00:27:47,730 --> 00:27:54,090
<font color="#CCCCCC">results</font><font color="#E5E5E5"> back to our server</font><font color="#CCCCCC"> and it's</font>

753
00:27:50,669 --> 00:27:56,040
<font color="#CCCCCC">going</font><font color="#E5E5E5"> to generate a node unique ID</font><font color="#CCCCCC"> and</font>

754
00:27:54,090 --> 00:27:59,220
<font color="#CCCCCC">it's going</font><font color="#E5E5E5"> to push</font><font color="#CCCCCC"> into that branch</font><font color="#E5E5E5"> to</font>

755
00:27:56,040 --> 00:28:02,460
<font color="#CCCCCC">basically so the reports</font><font color="#E5E5E5"> from</font><font color="#CCCCCC"> different</font>

756
00:27:59,220 --> 00:28:03,929
machines<font color="#E5E5E5"> don't collide and then we set</font>

757
00:28:02,460 --> 00:28:05,880
up a github hook so<font color="#E5E5E5"> that whenever</font>

758
00:28:03,929 --> 00:28:07,650
there's a push we automatically hear

759
00:28:05,880 --> 00:28:10,020
about it on<font color="#CCCCCC"> our attacker server and we</font>

760
00:28:07,650 --> 00:28:12,750
know that<font color="#E5E5E5"> we can run pull and extract</font>

761
00:28:10,020 --> 00:28:14,400
the information<font color="#E5E5E5"> that's been sent and</font>

762
00:28:12,750 --> 00:28:16,740
<font color="#E5E5E5">then finally after we've got them to run</font>

763
00:28:14,400 --> 00:28:20,610
our malicious code and extracted it

764
00:28:16,740 --> 00:28:22,350
we then again<font color="#E5E5E5"> make every reference to</font>

765
00:28:20,610 --> 00:28:24,809
<font color="#CCCCCC">our malicious</font><font color="#E5E5E5"> commit and cultural repo</font>

766
00:28:22,350 --> 00:28:26,969
disappear and point back<font color="#CCCCCC"> to the benign</font>

767
00:28:24,809 --> 00:28:31,410
one<font color="#E5E5E5"> so again if you look on disk</font>

768
00:28:26,970 --> 00:28:33,899
<font color="#E5E5E5">everything looks great</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> so just</font>

769
00:28:31,410 --> 00:28:35,909
<font color="#CCCCCC">quickly spreading</font><font color="#E5E5E5"> so</font>

770
00:28:33,899 --> 00:28:37,620
<font color="#E5E5E5">it depends on the company everyone has a</font>

771
00:28:35,909 --> 00:28:40,169
different<font color="#CCCCCC"> sdlc but often there is a</font>

772
00:28:37,620 --> 00:28:42,090
<font color="#E5E5E5">developed branch that is not very well</font>

773
00:28:40,169 --> 00:28:44,490
<font color="#E5E5E5">vetted there's sort of a constant flux</font>

774
00:28:42,090 --> 00:28:46,049
<font color="#CCCCCC">where</font><font color="#E5E5E5"> people are developing</font><font color="#CCCCCC"> future</font>

775
00:28:44,490 --> 00:28:47,700
branches and then merging them in or

776
00:28:46,049 --> 00:28:51,240
taking develop emerging into<font color="#E5E5E5"> their</font>

777
00:28:47,700 --> 00:28:52,860
future branch so that it's not<font color="#CCCCCC"> a huge</font>

778
00:28:51,240 --> 00:28:55,559
merge conflict when they try<font color="#E5E5E5"> to merge it</font>

779
00:28:52,860 --> 00:28:58,740
into say a QA version or something<font color="#CCCCCC"> like</font>

780
00:28:55,559 --> 00:29:01,710
<font color="#E5E5E5">that so the first</font><font color="#CCCCCC"> step is to find a</font>

781
00:28:58,740 --> 00:29:04,559
branch that's less well vetted<font color="#E5E5E5"> and to</font>

782
00:29:01,710 --> 00:29:06,179
push<font color="#CCCCCC"> into internal</font><font color="#E5E5E5"> code hosting or some</font>

783
00:29:04,559 --> 00:29:10,139
sort<font color="#CCCCCC"> of continuous integration</font><font color="#E5E5E5"> tool like</font>

784
00:29:06,179 --> 00:29:12,179
Jenkins<font color="#E5E5E5"> so now our malicious one-liner</font>

785
00:29:10,139 --> 00:29:14,428
backdoor is now there so let's say

786
00:29:12,179 --> 00:29:17,190
there's another developer<font color="#E5E5E5"> Atlas dev no</font>

787
00:29:14,429 --> 00:29:19,200
relation<font color="#CCCCCC"> to</font><font color="#E5E5E5"> Joe</font><font color="#CCCCCC"> he may have access to</font>

788
00:29:17,190 --> 00:29:21,029
repos that<font color="#E5E5E5"> Joe dozen or access to other</font>

789
00:29:19,200 --> 00:29:22,619
internal<font color="#E5E5E5"> systems so when she is</font>

790
00:29:21,029 --> 00:29:23,730
<font color="#E5E5E5">developing and she runs get pull and</font>

791
00:29:22,619 --> 00:29:25,740
she's like<font color="#E5E5E5"> okay I'm working</font><font color="#CCCCCC"> on this</font>

792
00:29:23,730 --> 00:29:27,659
feature let me merge and develop and

793
00:29:25,740 --> 00:29:29,009
then runs<font color="#E5E5E5"> the test suite</font><font color="#CCCCCC"> she gets</font>

794
00:29:27,659 --> 00:29:31,169
compromised and then we can<font color="#E5E5E5"> send her</font>

795
00:29:29,009 --> 00:29:33,960
commands as<font color="#CCCCCC"> well and then perhaps</font><font color="#E5E5E5"> there</font>

796
00:29:31,169 --> 00:29:35,610
is a DevOps person named Bob who<font color="#CCCCCC"> can SSH</font>

797
00:29:33,960 --> 00:29:37,950
to prod for troubleshooting<font color="#CCCCCC"> create</font>

798
00:29:35,610 --> 00:29:40,949
release builds write access<font color="#E5E5E5"> to puppet</font>

799
00:29:37,950 --> 00:29:42,450
<font color="#E5E5E5">chef things like that so similarly when</font>

800
00:29:40,950 --> 00:29:42,809
he pulls<font color="#CCCCCC"> down that repo and runs the</font>

801
00:29:42,450 --> 00:29:45,179
test<font color="#CCCCCC"> suite</font>

802
00:29:42,809 --> 00:29:46,710
<font color="#CCCCCC">he is</font><font color="#E5E5E5"> also compromised</font><font color="#CCCCCC"> so if our</font><font color="#E5E5E5"> goal</font><font color="#CCCCCC"> is</font>

803
00:29:45,179 --> 00:29:48,509
to<font color="#E5E5E5"> get into production and we compromise</font>

804
00:29:46,710 --> 00:29:51,929
someone who can get<font color="#E5E5E5"> into production</font>

805
00:29:48,509 --> 00:29:53,249
then we've achieved our goal<font color="#CCCCCC"> so here</font>

806
00:29:51,929 --> 00:29:55,320
we're exploiting<font color="#E5E5E5"> as no one was talking</font>

807
00:29:53,249 --> 00:29:58,440
<font color="#CCCCCC">about</font><font color="#E5E5E5"> before</font><font color="#CCCCCC"> trust relationships between</font>

808
00:29:55,320 --> 00:30:00,570
developers between employees<font color="#E5E5E5"> but we can</font>

809
00:29:58,440 --> 00:30:03,119
also attack trust relationships between

810
00:30:00,570 --> 00:30:05,369
developers<font color="#CCCCCC"> and say continuous</font>

811
00:30:03,119 --> 00:30:07,619
integration so if the Jenkins<font color="#E5E5E5"> server</font>

812
00:30:05,369 --> 00:30:09,480
automatically runs test<font color="#E5E5E5"> Suites</font><font color="#CCCCCC"> we might</font>

813
00:30:07,619 --> 00:30:12,059
actually backdoor that in the<font color="#E5E5E5"> process of</font>

814
00:30:09,480 --> 00:30:14,700
doing this<font color="#E5E5E5"> and then if Jenkins had</font>

815
00:30:12,059 --> 00:30:17,460
permission<font color="#E5E5E5"> via some deployment process</font>

816
00:30:14,700 --> 00:30:19,529
or get pull<font color="#E5E5E5"> to send to staging or</font>

817
00:30:17,460 --> 00:30:20,789
production<font color="#E5E5E5"> then we can then compromise</font>

818
00:30:19,529 --> 00:30:21,899
production that way as well

819
00:30:20,789 --> 00:30:26,639
<font color="#E5E5E5">so there's a couple of different avenues</font>

820
00:30:21,899 --> 00:30:28,049
<font color="#E5E5E5">there so there's a number of useful</font>

821
00:30:26,639 --> 00:30:29,189
<font color="#CCCCCC">features but there's a</font><font color="#E5E5E5"> bunch that</font><font color="#CCCCCC"> we</font>

822
00:30:28,049 --> 00:30:32,340
would like<font color="#CCCCCC"> to have that are</font><font color="#E5E5E5"> not there</font>

823
00:30:29,190 --> 00:30:34,049
yet<font color="#E5E5E5"> and so we currently the exfiltrated</font>

824
00:30:32,340 --> 00:30:36,418
information is encrypted<font color="#E5E5E5"> in transit in</font>

825
00:30:34,049 --> 00:30:38,908
that it's going<font color="#CCCCCC"> over get</font><font color="#E5E5E5"> however</font><font color="#CCCCCC"> would</font>

826
00:30:36,419 --> 00:30:39,980
<font color="#CCCCCC">be</font><font color="#E5E5E5"> nice to encrypt things client-side to</font>

827
00:30:38,909 --> 00:30:42,389
make friends<font color="#E5E5E5"> it's a little bit difficult</font>

828
00:30:39,980 --> 00:30:43,529
<font color="#E5E5E5">more</font><font color="#CCCCCC"> difficult we would like to</font>

829
00:30:42,389 --> 00:30:45,240
<font color="#E5E5E5">integrate with other version control</font>

830
00:30:43,529 --> 00:30:47,320
<font color="#CCCCCC">systems</font><font color="#E5E5E5"> like perforce and mercurial</font>

831
00:30:45,240 --> 00:30:48,580
<font color="#E5E5E5">currently only get</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> support</font>

832
00:30:47,320 --> 00:30:51,070
and it would be nice<font color="#CCCCCC"> to have some</font>

833
00:30:48,580 --> 00:30:52,060
<font color="#E5E5E5">specific target modules for continuous</font>

834
00:30:51,070 --> 00:30:55,090
integration continuous<font color="#E5E5E5"> deployment</font>

835
00:30:52,060 --> 00:30:56,919
platforms like<font color="#E5E5E5"> Jenkins or Travis and</font>

836
00:30:55,090 --> 00:30:58,389
also<font color="#E5E5E5"> just more modules for common</font>

837
00:30:56,920 --> 00:31:02,680
reconnaissance or exploitation tasks

838
00:30:58,390 --> 00:31:04,900
would be nice okay so in summary<font color="#CCCCCC"> get</font>

839
00:31:02,680 --> 00:31:07,390
pone is a tool for<font color="#E5E5E5"> penetration test that</font>

840
00:31:04,900 --> 00:31:10,420
lets you do command control using a

841
00:31:07,390 --> 00:31:12,790
private<font color="#E5E5E5"> repo on github</font><font color="#CCCCCC"> it's</font><font color="#E5E5E5"> flexible so</font>

842
00:31:10,420 --> 00:31:14,800
commands can be arbitrary<font color="#E5E5E5"> Python we</font>

843
00:31:12,790 --> 00:31:16,090
mimic an arbitrary public<font color="#CCCCCC"> git repo that</font>

844
00:31:14,800 --> 00:31:17,950
fits<font color="#E5E5E5"> into the</font><font color="#CCCCCC"> environment so it's</font>

845
00:31:16,090 --> 00:31:20,620
stealthy in that respect<font color="#CCCCCC"> and</font><font color="#E5E5E5"> it's also</font>

846
00:31:17,950 --> 00:31:22,690
very<font color="#E5E5E5"> easy</font><font color="#CCCCCC"> to set up the bootstrapping</font>

847
00:31:20,620 --> 00:31:25,080
<font color="#CCCCCC">process so that it's tailored to the</font>

848
00:31:22,690 --> 00:31:27,280
target environment<font color="#E5E5E5"> one thing we found on</font>

849
00:31:25,080 --> 00:31:29,409
real penetration tests is every

850
00:31:27,280 --> 00:31:30,700
environments very<font color="#E5E5E5"> different how the</font><font color="#CCCCCC"> SDLC</font>

851
00:31:29,410 --> 00:31:33,270
works is<font color="#CCCCCC"> very different and</font><font color="#E5E5E5"> having a</font>

852
00:31:30,700 --> 00:31:35,920
tool that always works in a<font color="#E5E5E5"> certain way</font>

853
00:31:33,270 --> 00:31:38,590
<font color="#CCCCCC">to</font><font color="#E5E5E5"> make it less useful so we tried to</font>

854
00:31:35,920 --> 00:31:39,990
<font color="#E5E5E5">make it as</font><font color="#CCCCCC"> flexible as possible and so</font>

855
00:31:38,590 --> 00:31:42,220
it can be tailored<font color="#CCCCCC"> to a</font><font color="#E5E5E5"> given project</font>

856
00:31:39,990 --> 00:31:43,750
<font color="#CCCCCC">again</font><font color="#E5E5E5"> this is targeted primarily at</font>

857
00:31:42,220 --> 00:31:45,100
agile development shops<font color="#E5E5E5"> and it was</font>

858
00:31:43,750 --> 00:31:46,990
written to<font color="#E5E5E5"> highlight the potential risks</font>

859
00:31:45,100 --> 00:31:52,719
of mismanaging trust relationships in an

860
00:31:46,990 --> 00:31:56,730
enterprise<font color="#CCCCCC"> ok so there's many moving</font>

861
00:31:52,720 --> 00:32:03,120
parts<font color="#CCCCCC"> so we ended up</font><font color="#E5E5E5"> recording the demo</font>

862
00:31:56,730 --> 00:32:05,730
so first let's look<font color="#CCCCCC"> at</font><font color="#E5E5E5"> the setup process</font>

863
00:32:03,120 --> 00:32:08,199
<font color="#CCCCCC">ok so we're in</font><font color="#E5E5E5"> the get pwned repo and</font>

864
00:32:05,730 --> 00:32:09,850
there's a config file<font color="#E5E5E5"> which basically</font>

865
00:32:08,200 --> 00:32:11,680
says<font color="#E5E5E5"> here's the repo I want</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> copy</font>

866
00:32:09,850 --> 00:32:14,320
<font color="#CCCCCC">here's a couple</font><font color="#E5E5E5"> of personal access</font>

867
00:32:11,680 --> 00:32:16,510
tokens and and then here's<font color="#E5E5E5"> the attacker</font>

868
00:32:14,320 --> 00:32:19,060
server that I want<font color="#CCCCCC"> to get hook to point</font>

869
00:32:16,510 --> 00:32:21,370
to and so basically once you have that

870
00:32:19,060 --> 00:32:22,540
<font color="#E5E5E5">information all you do is run the setup</font>

871
00:32:21,370 --> 00:32:24,250
file<font color="#E5E5E5"> and you pass in the config</font>

872
00:32:22,540 --> 00:32:26,800
information and then it does a bunch<font color="#E5E5E5"> of</font>

873
00:32:24,250 --> 00:32:28,870
things<font color="#E5E5E5"> so first</font><font color="#CCCCCC"> its cloning down the</font>

874
00:32:26,800 --> 00:32:31,659
popular repo<font color="#E5E5E5"> and then pushing it</font><font color="#CCCCCC"> into a</font>

875
00:32:28,870 --> 00:32:33,580
private<font color="#CCCCCC"> repo and then it's setting up</font><font color="#E5E5E5"> a</font>

876
00:32:31,660 --> 00:32:36,430
web hook<font color="#E5E5E5"> it's adding the secondary user</font>

877
00:32:33,580 --> 00:32:39,389
as a collaborator<font color="#CCCCCC"> to the first one don't</font>

878
00:32:36,430 --> 00:32:42,250
try<font color="#E5E5E5"> to read all</font><font color="#CCCCCC"> of this there's too much</font>

879
00:32:39,390 --> 00:32:43,990
but I'll show you<font color="#E5E5E5"> in a second</font><font color="#CCCCCC"> all the</font>

880
00:32:42,250 --> 00:32:46,020
things that<font color="#CCCCCC"> it</font><font color="#E5E5E5"> did but one important</font>

881
00:32:43,990 --> 00:32:50,350
<font color="#E5E5E5">takeaway from at the end of it is</font>

882
00:32:46,020 --> 00:32:51,940
<font color="#E5E5E5">basically it will output</font><font color="#CCCCCC"> this basically</font>

883
00:32:50,350 --> 00:32:55,419
one-liners which then you<font color="#E5E5E5"> can use to</font>

884
00:32:51,940 --> 00:32:58,780
backdoor<font color="#E5E5E5"> a target repo so if we look at</font>

885
00:32:55,420 --> 00:32:59,890
what<font color="#CCCCCC"> exactly this gist content is it's</font>

886
00:32:58,780 --> 00:33:00,850
<font color="#E5E5E5">basically</font>

887
00:32:59,890 --> 00:33:03,040
<font color="#CCCCCC">a Python script that does</font><font color="#E5E5E5"> the</font>

888
00:33:00,850 --> 00:33:05,320
bootstrapping<font color="#E5E5E5"> that we explained in the</font>

889
00:33:03,040 --> 00:33:09,580
architecture diagram<font color="#CCCCCC"> just a</font><font color="#E5E5E5"> minute ago</font>

890
00:33:05,320 --> 00:33:12,490
<font color="#CCCCCC">so</font><font color="#E5E5E5"> let's see so this is on the right</font>

891
00:33:09,580 --> 00:33:13,510
<font color="#E5E5E5">that was the official</font><font color="#CCCCCC"> IP</font><font color="#E5E5E5"> DB and this is</font>

892
00:33:12,490 --> 00:33:16,630
our private one that we<font color="#CCCCCC"> just generated</font>

893
00:33:13,510 --> 00:33:18,310
<font color="#E5E5E5">from the setup script as you can see so</font>

894
00:33:16,630 --> 00:33:20,080
there's like a<font color="#E5E5E5"> similar number</font><font color="#CCCCCC"> of commits</font>

895
00:33:18,310 --> 00:33:21,460
<font color="#E5E5E5">a lot of the history looks the same</font>

896
00:33:20,080 --> 00:33:23,320
there's a bunch of collaborators and it

897
00:33:21,460 --> 00:33:24,880
looks pretty<font color="#CCCCCC"> much</font><font color="#E5E5E5"> identical</font><font color="#CCCCCC"> we can see</font>

898
00:33:23,320 --> 00:33:26,649
that the secondary<font color="#E5E5E5"> user has been</font><font color="#CCCCCC"> added</font>

899
00:33:24,880 --> 00:33:28,210
<font color="#CCCCCC">as a collaborator so they can write and</font>

900
00:33:26,650 --> 00:33:30,430
there's a web hook that points to our

901
00:33:28,210 --> 00:33:33,780
<font color="#E5E5E5">attacker server so that</font><font color="#CCCCCC"> every</font><font color="#E5E5E5"> time</font>

902
00:33:30,430 --> 00:33:35,140
<font color="#E5E5E5">compromised machine pushes we see it</font>

903
00:33:33,780 --> 00:33:37,389
<font color="#E5E5E5">okay cool</font>

904
00:33:35,140 --> 00:33:42,160
<font color="#E5E5E5">so that's the</font><font color="#CCCCCC"> setup</font><font color="#E5E5E5"> so how does this</font>

905
00:33:37,390 --> 00:33:45,280
work on<font color="#E5E5E5"> compromising a machine</font><font color="#CCCCCC"> ok</font><font color="#E5E5E5"> so</font>

906
00:33:42,160 --> 00:33:49,150
again<font color="#CCCCCC"> we're on</font><font color="#E5E5E5"> Joe devs machine we have</font>

907
00:33:45,280 --> 00:33:51,670
<font color="#E5E5E5">inserted the backdoor towards the bottom</font>

908
00:33:49,150 --> 00:33:53,140
there<font color="#CCCCCC"> so now if we</font><font color="#E5E5E5"> run the test suite</font>

909
00:33:51,670 --> 00:33:54,370
<font color="#CCCCCC">it's basically going</font><font color="#E5E5E5"> to pull in the</font>

910
00:33:53,140 --> 00:33:56,200
<font color="#CCCCCC">private gist which is doing all the</font>

911
00:33:54,370 --> 00:34:00,489
bootstrapping<font color="#CCCCCC"> and</font><font color="#E5E5E5"> just to</font><font color="#CCCCCC"> make</font><font color="#E5E5E5"> things</font>

912
00:33:56,200 --> 00:34:02,470
clear I had<font color="#E5E5E5"> it output debug info so we</font>

913
00:34:00,490 --> 00:34:04,570
can see we added<font color="#CCCCCC"> up</font><font color="#E5E5E5"> a bunch of</font><font color="#CCCCCC"> git hooks</font>

914
00:34:02,470 --> 00:34:07,210
<font color="#E5E5E5">a pre commit pre</font><font color="#CCCCCC"> push and things like</font>

915
00:34:04,570 --> 00:34:10,418
<font color="#E5E5E5">that</font><font color="#CCCCCC"> and so each of those hooks we added</font>

916
00:34:07,210 --> 00:34:11,918
are<font color="#E5E5E5"> basically calling what looks</font><font color="#CCCCCC"> like a</font>

917
00:34:10,418 --> 00:34:13,359
simple<font color="#E5E5E5"> get hook in the</font>

918
00:34:11,918 --> 00:34:19,029
<font color="#CCCCCC">command-and-control repo but again it's</font>

919
00:34:13,360 --> 00:34:20,890
actually<font color="#CCCCCC"> our agent code so where is this</font>

920
00:34:19,030 --> 00:34:22,240
<font color="#E5E5E5">command and control repo so if we go</font>

921
00:34:20,889 --> 00:34:24,699
there<font color="#E5E5E5"> and then look in the directory</font>

922
00:34:22,239 --> 00:34:27,850
<font color="#CCCCCC">above it this is where all</font><font color="#E5E5E5"> the default</font>

923
00:34:24,699 --> 00:34:29,589
<font color="#E5E5E5">Python libraries are so look there's a</font>

924
00:34:27,850 --> 00:34:32,710
bunch of them and we're just<font color="#E5E5E5"> one of</font>

925
00:34:29,590 --> 00:34:35,409
those<font color="#E5E5E5"> hiding in plain sight and then so</font>

926
00:34:32,710 --> 00:34:38,860
let's<font color="#E5E5E5"> look at get log this is just what</font>

927
00:34:35,409 --> 00:34:40,600
the default<font color="#CCCCCC"> benign repo</font><font color="#E5E5E5"> has if we run</font>

928
00:34:38,860 --> 00:34:42,790
git status<font color="#CCCCCC"> we're just our master</font>

929
00:34:40,600 --> 00:34:44,230
everything's great if we look at all<font color="#E5E5E5"> the</font>

930
00:34:42,790 --> 00:34:47,980
remotes we're just pointing to where we

931
00:34:44,230 --> 00:34:49,540
<font color="#CCCCCC">should</font><font color="#E5E5E5"> be</font><font color="#CCCCCC"> we look in the github</font>

932
00:34:47,980 --> 00:34:50,710
directory like<font color="#E5E5E5"> oh maybe something bad</font>

933
00:34:49,540 --> 00:34:53,918
happened there but it's<font color="#CCCCCC"> just a bunch of</font>

934
00:34:50,710 --> 00:34:58,080
sample files and however<font color="#E5E5E5"> one of those</font>

935
00:34:53,918 --> 00:35:04,569
again has been rewritten<font color="#E5E5E5"> to have our</font>

936
00:34:58,080 --> 00:35:06,640
agent code there so that's that<font color="#CCCCCC"> oh and</font>

937
00:35:04,570 --> 00:35:08,500
then if we look<font color="#E5E5E5"> on</font><font color="#CCCCCC"> tacker server</font><font color="#E5E5E5"> we</font>

938
00:35:06,640 --> 00:35:11,080
<font color="#CCCCCC">automatically got the web hook</font><font color="#E5E5E5"> and</font>

939
00:35:08,500 --> 00:35:12,620
extracted<font color="#E5E5E5"> the information so</font><font color="#CCCCCC"> now this is</font>

940
00:35:11,080 --> 00:35:17,000
<font color="#E5E5E5">the result of</font><font color="#CCCCCC"> running our</font>

941
00:35:12,620 --> 00:35:19,640
<font color="#CCCCCC">hurry payload on Joe</font><font color="#E5E5E5"> Deb's machine</font><font color="#CCCCCC"> so we</font>

942
00:35:17,000 --> 00:35:23,240
ran I have config<font color="#E5E5E5"> we got their username</font>

943
00:35:19,640 --> 00:35:25,730
we ran the processes running and things

944
00:35:23,240 --> 00:35:26,930
<font color="#E5E5E5">like</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> so they're currently there's</font>

945
00:35:25,730 --> 00:35:28,820
just like a<font color="#E5E5E5"> couple of example payloads</font>

946
00:35:26,930 --> 00:35:35,529
but really<font color="#E5E5E5"> anything</font><font color="#CCCCCC"> you want to write</font>

947
00:35:28,820 --> 00:35:38,980
would<font color="#E5E5E5"> be fine here</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> so finally um</font>

948
00:35:35,530 --> 00:35:38,980
let's see

949
00:35:40,520 --> 00:35:43,520
so again so we've<font color="#E5E5E5"> backdoored the team</font>

950
00:35:43,130 --> 00:35:45,110
<font color="#CCCCCC">suite</font>

951
00:35:43,520 --> 00:35:48,070
maybe we're using develop or some branch

952
00:35:45,110 --> 00:35:51,680
that is<font color="#CCCCCC"> constant in the state of</font><font color="#E5E5E5"> flux</font>

953
00:35:48,070 --> 00:35:53,540
<font color="#CCCCCC">we're going to commit this to the repo</font>

954
00:35:51,680 --> 00:35:55,190
<font color="#CCCCCC">and then push it into</font><font color="#E5E5E5"> the internal code</font>

955
00:35:53,540 --> 00:35:58,850
hosting which in this example is<font color="#CCCCCC"> a</font>

956
00:35:55,190 --> 00:36:01,310
<font color="#E5E5E5">separate</font><font color="#CCCCCC"> get lab instance in the AWS dev</font>

957
00:35:58,850 --> 00:36:04,069
environment for<font color="#E5E5E5"> this example company so</font>

958
00:36:01,310 --> 00:36:06,920
if we go to get lab<font color="#CCCCCC"> we refresh we can</font>

959
00:36:04,070 --> 00:36:09,650
see the<font color="#E5E5E5"> commit that</font><font color="#CCCCCC"> we just</font><font color="#E5E5E5"> sent and</font>

960
00:36:06,920 --> 00:36:11,570
based on<font color="#E5E5E5"> this company's</font><font color="#CCCCCC"> sdlc basically</font>

961
00:36:09,650 --> 00:36:13,490
they every<font color="#CCCCCC"> time there's a push</font><font color="#E5E5E5"> to get</font>

962
00:36:11,570 --> 00:36:16,070
lab they<font color="#E5E5E5"> automatically run the test</font>

963
00:36:13,490 --> 00:36:19,450
suite<font color="#E5E5E5"> using Jenkins</font><font color="#CCCCCC"> so if we look at the</font>

964
00:36:16,070 --> 00:36:21,980
console<font color="#E5E5E5"> output for</font><font color="#CCCCCC"> Jenkins we can see</font>

965
00:36:19,450 --> 00:36:23,450
there's the test suite running that we

966
00:36:21,980 --> 00:36:26,540
<font color="#CCCCCC">back doored</font><font color="#E5E5E5"> and then we can see this</font>

967
00:36:23,450 --> 00:36:29,180
additional text which is cloning down

968
00:36:26,540 --> 00:36:30,770
the command<font color="#CCCCCC"> control repo running the</font>

969
00:36:29,180 --> 00:36:33,470
agent<font color="#E5E5E5"> and things like that</font><font color="#CCCCCC"> so again if</font>

970
00:36:30,770 --> 00:36:35,270
we<font color="#E5E5E5"> look</font><font color="#CCCCCC"> at nodes now we can see that we</font>

971
00:36:33,470 --> 00:36:37,310
did run arbitrary<font color="#E5E5E5"> code on Jenkins the</font>

972
00:36:35,270 --> 00:36:38,270
continuous integration server<font color="#E5E5E5"> and here's</font>

973
00:36:37,310 --> 00:36:40,820
a bunch of the environment information

974
00:36:38,270 --> 00:36:43,100
<font color="#E5E5E5">and things like that</font><font color="#CCCCCC"> so if in this</font>

975
00:36:40,820 --> 00:36:45,470
company<font color="#CCCCCC"> Jenkins</font><font color="#E5E5E5"> has permission to push</font>

976
00:36:43,100 --> 00:36:48,080
to prod<font color="#E5E5E5"> we can then send it arbitrary</font>

977
00:36:45,470 --> 00:36:54,589
commands which then push to production

978
00:36:48,080 --> 00:36:56,090
as well so<font color="#E5E5E5"> again this is a sort</font><font color="#CCCCCC"> of a</font>

979
00:36:54,590 --> 00:36:58,970
very<font color="#E5E5E5"> quick minimal example because</font><font color="#CCCCCC"> of</font>

980
00:36:56,090 --> 00:37:01,430
time constraints<font color="#CCCCCC"> but in both on both Jo</font>

981
00:36:58,970 --> 00:37:02,839
developer as<font color="#CCCCCC"> well as</font><font color="#E5E5E5"> git lab we were</font>

982
00:37:01,430 --> 00:37:07,279
running arbitrary<font color="#CCCCCC"> codes so your</font>

983
00:37:02,840 --> 00:37:11,540
imagination is the limit here<font color="#E5E5E5"> all right</font>

984
00:37:07,280 --> 00:37:12,950
so let's go back<font color="#CCCCCC"> and to talk</font><font color="#E5E5E5"> about</font>

985
00:37:11,540 --> 00:37:15,640
<font color="#E5E5E5">mitigation for some of these</font><font color="#CCCCCC"> attacks and</font>

986
00:37:12,950 --> 00:37:19,669
<font color="#CCCCCC">gonna pass it back to Noah Thanks good</font>

987
00:37:15,640 --> 00:37:21,500
all right<font color="#CCCCCC"> so we</font><font color="#E5E5E5"> just talked about some</font>

988
00:37:19,670 --> 00:37:23,960
<font color="#E5E5E5">potential issues</font><font color="#CCCCCC"> and problems and showed</font>

989
00:37:21,500 --> 00:37:25,550
a tool that<font color="#E5E5E5"> takes advantage of some of</font>

990
00:37:23,960 --> 00:37:27,230
<font color="#E5E5E5">these potential issues and highlights</font>

991
00:37:25,550 --> 00:37:28,820
risks so let's talk about<font color="#E5E5E5"> ways we</font><font color="#CCCCCC"> can</font>

992
00:37:27,230 --> 00:37:30,380
<font color="#CCCCCC">potentially</font><font color="#E5E5E5"> fix it so</font><font color="#CCCCCC"> anytime we're</font>

993
00:37:28,820 --> 00:37:32,180
<font color="#E5E5E5">looking at potentially mitigating a</font>

994
00:37:30,380 --> 00:37:35,780
problem we<font color="#E5E5E5"> need to understand what the</font>

995
00:37:32,180 --> 00:37:37,009
root causes are here first<font color="#CCCCCC"> right so when</font>

996
00:37:35,780 --> 00:37:38,990
the<font color="#CCCCCC"> mainland's</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> that development</font>

997
00:37:37,010 --> 00:37:41,870
<font color="#CCCCCC">security</font><font color="#E5E5E5"> just not has not kept up with</font>

998
00:37:38,990 --> 00:37:45,410
the speed at<font color="#CCCCCC"> which these very skilled</font>

999
00:37:41,870 --> 00:37:48,770
<font color="#E5E5E5">very rapid moving development shops have</font>

1000
00:37:45,410 --> 00:37:50,390
grown we have startups that go<font color="#E5E5E5"> from the</font>

1001
00:37:48,770 --> 00:37:52,610
first<font color="#CCCCCC"> line of code they're writing to</font>

1002
00:37:50,390 --> 00:37:55,069
like<font color="#CCCCCC"> GA releases in under a year</font>

1003
00:37:52,610 --> 00:37:57,290
sometimes<font color="#CCCCCC"> and that's</font><font color="#E5E5E5"> just a massive</font>

1004
00:37:55,070 --> 00:37:58,970
<font color="#E5E5E5">amount</font><font color="#CCCCCC"> of change right and at the moment</font>

1005
00:37:57,290 --> 00:38:00,259
development security<font color="#E5E5E5"> processes</font>

1006
00:37:58,970 --> 00:38:02,089
procedures<font color="#E5E5E5"> and even some technical</font>

1007
00:38:00,260 --> 00:38:03,710
trolls<font color="#CCCCCC"> just have not been given</font><font color="#E5E5E5"> the</font>

1008
00:38:02,090 --> 00:38:05,530
focus<font color="#E5E5E5"> to keep up with this right</font>

1009
00:38:03,710 --> 00:38:07,670
<font color="#CCCCCC">so something hasn't</font><font color="#E5E5E5"> gotten any attention</font>

1010
00:38:05,530 --> 00:38:09,620
<font color="#E5E5E5">security</font><font color="#CCCCCC"> and development tend to be</font>

1011
00:38:07,670 --> 00:38:11,300
separate silos so that means there's an

1012
00:38:09,620 --> 00:38:13,190
absence of collaboration very often

1013
00:38:11,300 --> 00:38:14,630
there's absence of a visibility<font color="#E5E5E5"> into</font>

1014
00:38:13,190 --> 00:38:16,220
what's actually going on and<font color="#CCCCCC"> very often</font>

1015
00:38:14,630 --> 00:38:18,530
leads<font color="#E5E5E5"> to some misconceptions about what</font>

1016
00:38:16,220 --> 00:38:20,740
<font color="#E5E5E5">actually what levels of security</font>

1017
00:38:18,530 --> 00:38:23,120
protections are actually in<font color="#E5E5E5"> place</font><font color="#CCCCCC"> okay</font>

1018
00:38:20,740 --> 00:38:24,919
<font color="#CCCCCC">and the last</font><font color="#E5E5E5"> is incomplete technical</font>

1019
00:38:23,120 --> 00:38:26,120
controls I know this is a big one<font color="#CCCCCC"> I mean</font>

1020
00:38:24,920 --> 00:38:27,610
a lot of<font color="#E5E5E5"> the security problems we deal</font>

1021
00:38:26,120 --> 00:38:29,390
with<font color="#E5E5E5"> the</font><font color="#CCCCCC"> security research</font><font color="#E5E5E5"> on database</font>

1022
00:38:27,610 --> 00:38:33,380
<font color="#E5E5E5">databases are because of incomplete</font>

1023
00:38:29,390 --> 00:38:36,650
technical controls right<font color="#CCCCCC"> but nonetheless</font>

1024
00:38:33,380 --> 00:38:38,600
<font color="#E5E5E5">it persists so examples would</font><font color="#CCCCCC"> be maybe</font>

1025
00:38:36,650 --> 00:38:43,520
we punched a couple extra holes<font color="#CCCCCC"> in a</font>

1026
00:38:38,600 --> 00:38:45,680
firewall<font color="#CCCCCC"> or we</font><font color="#E5E5E5"> scoped some secrets</font><font color="#CCCCCC"> to a</font>

1027
00:38:43,520 --> 00:38:49,270
much lower level user than was necessary

1028
00:38:45,680 --> 00:38:51,020
<font color="#CCCCCC">to make things easier things like that</font>

1029
00:38:49,270 --> 00:38:52,550
so there's a<font color="#E5E5E5"> couple different ways</font>

1030
00:38:51,020 --> 00:38:53,960
<font color="#E5E5E5">there's processes and procedures and</font>

1031
00:38:52,550 --> 00:38:55,130
<font color="#E5E5E5">then there's technical controls let's</font>

1032
00:38:53,960 --> 00:39:01,550
talk<font color="#CCCCCC"> about processes</font><font color="#E5E5E5"> and procedures</font>

1033
00:38:55,130 --> 00:39:04,190
first so first<font color="#E5E5E5"> is that as far</font><font color="#CCCCCC"> as the</font>

1034
00:39:01,550 --> 00:39:06,110
process<font color="#CCCCCC"> goes doing code review doing</font><font color="#E5E5E5"> you</font>

1035
00:39:04,190 --> 00:39:08,330
know code collaboration and reviewing

1036
00:39:06,110 --> 00:39:12,050
<font color="#E5E5E5">commits is necessary like obviously</font>

1037
00:39:08,330 --> 00:39:14,569
there's obviously there's<font color="#CCCCCC"> a limit</font>

1038
00:39:12,050 --> 00:39:15,890
because<font color="#CCCCCC"> of scale of having automated</font>

1039
00:39:14,570 --> 00:39:17,540
processes in place<font color="#E5E5E5"> to</font><font color="#CCCCCC"> help with</font><font color="#E5E5E5"> some of</font>

1040
00:39:15,890 --> 00:39:20,000
this<font color="#CCCCCC"> we'll even</font><font color="#E5E5E5"> though it won't solve</font>

1041
00:39:17,540 --> 00:39:22,310
these problems<font color="#CCCCCC"> that</font><font color="#E5E5E5"> can help</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> right</font>

1042
00:39:20,000 --> 00:39:23,570
<font color="#E5E5E5">now there is defining a real development</font>

1043
00:39:22,310 --> 00:39:25,190
process<font color="#E5E5E5"> and I don't just mean telling</font>

1044
00:39:23,570 --> 00:39:26,750
your devs<font color="#E5E5E5"> how to do the development I</font>

1045
00:39:25,190 --> 00:39:28,280
mean working with<font color="#E5E5E5"> them find out what</font>

1046
00:39:26,750 --> 00:39:30,080
<font color="#E5E5E5">their</font><font color="#CCCCCC"> constraints are the requirements</font>

1047
00:39:28,280 --> 00:39:32,060
<font color="#E5E5E5">the technologies</font><font color="#CCCCCC"> and all</font><font color="#E5E5E5"> the things</font><font color="#CCCCCC"> that</font>

1048
00:39:30,080 --> 00:39:32,960
they work with<font color="#E5E5E5"> on a day to day basis</font>

1049
00:39:32,060 --> 00:39:35,049
because this is where they live

1050
00:39:32,960 --> 00:39:38,599
essentially<font color="#E5E5E5"> and helping them create</font>

1051
00:39:35,050 --> 00:39:40,940
secure reasonable constraints<font color="#E5E5E5"> saying</font>

1052
00:39:38,599 --> 00:39:42,619
ways of<font color="#E5E5E5"> developing that meet their needs</font>

1053
00:39:40,940 --> 00:39:45,170
<font color="#E5E5E5">and don't impede their ability to do</font>

1054
00:39:42,619 --> 00:39:46,910
their work<font color="#E5E5E5"> right</font><font color="#CCCCCC"> and even though that</font>

1055
00:39:45,170 --> 00:39:52,160
sounds<font color="#CCCCCC"> like a magical unicorn it's</font>

1056
00:39:46,910 --> 00:39:53,660
totally<font color="#E5E5E5"> possible</font><font color="#CCCCCC"> so reviewing</font>

1057
00:39:52,160 --> 00:39:55,970
development of staging security controls

1058
00:39:53,660 --> 00:39:57,049
<font color="#CCCCCC">and their environments</font><font color="#E5E5E5"> on a regular</font>

1059
00:39:55,970 --> 00:39:59,598
basis is also<font color="#E5E5E5"> important because these</font>

1060
00:39:57,049 --> 00:40:01,609
<font color="#E5E5E5">are areas that are in really large</font>

1061
00:39:59,599 --> 00:40:03,140
states of flux right as we add<font color="#CCCCCC"> new</font>

1062
00:40:01,609 --> 00:40:04,819
controls<font color="#E5E5E5"> as we patches we update as we</font>

1063
00:40:03,140 --> 00:40:06,769
change<font color="#E5E5E5"> and we do change management</font>

1064
00:40:04,819 --> 00:40:08,420
already so<font color="#E5E5E5"> keeping a good eye on this</font>

1065
00:40:06,769 --> 00:40:10,129
from<font color="#E5E5E5"> the get-go</font><font color="#CCCCCC"> gives us a lot of</font>

1066
00:40:08,420 --> 00:40:11,390
insight<font color="#CCCCCC"> into what</font><font color="#E5E5E5"> we need to be planning</font>

1067
00:40:10,130 --> 00:40:13,009
for<font color="#E5E5E5"> them and the types of risks of</font>

1068
00:40:11,390 --> 00:40:16,009
<font color="#E5E5E5">things we need to be mitigating what we</font>

1069
00:40:13,009 --> 00:40:17,269
might be exposed to<font color="#CCCCCC"> okay so we talked</font>

1070
00:40:16,009 --> 00:40:19,039
about processes and procedures let's

1071
00:40:17,269 --> 00:40:20,959
talk about<font color="#E5E5E5"> real technical controls so</font>

1072
00:40:19,039 --> 00:40:23,089
first like<font color="#CCCCCC"> sdlc right</font>

1073
00:40:20,960 --> 00:40:26,509
having your<font color="#CCCCCC"> STL see clearly defined set</font>

1074
00:40:23,089 --> 00:40:28,430
up and designed in a way that<font color="#CCCCCC"> is strong</font>

1075
00:40:26,509 --> 00:40:30,410
<font color="#E5E5E5">and doesn't expose you to a bunch of</font>

1076
00:40:28,430 --> 00:40:31,489
undue risk is really<font color="#E5E5E5"> hard to do but it's</font>

1077
00:40:30,410 --> 00:40:33,529
possible

1078
00:40:31,489 --> 00:40:35,720
so<font color="#CCCCCC"> sandboxing CI processes right</font>

1079
00:40:33,529 --> 00:40:37,099
<font color="#CCCCCC">creating those pre-existing kind of</font>

1080
00:40:35,720 --> 00:40:40,279
development<font color="#CCCCCC"> environments</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> sandboxing</font>

1081
00:40:37,099 --> 00:40:43,009
<font color="#E5E5E5">CI processes helps prevent things like</font>

1082
00:40:40,279 --> 00:40:45,349
shelling<font color="#CCCCCC"> jenkins via test suites</font><font color="#E5E5E5"> right</font><font color="#CCCCCC"> I</font>

1083
00:40:43,009 --> 00:40:46,910
can<font color="#E5E5E5"> count the</font><font color="#CCCCCC"> number of environments</font>

1084
00:40:45,349 --> 00:40:49,339
I've seen that<font color="#E5E5E5"> actually sandbox all</font>

1085
00:40:46,910 --> 00:40:52,210
their CI builds probably on one<font color="#E5E5E5"> hand in</font>

1086
00:40:49,339 --> 00:40:55,460
<font color="#E5E5E5">my last two years of pen testing right</font>

1087
00:40:52,210 --> 00:40:58,249
<font color="#E5E5E5">so examine not just your</font><font color="#CCCCCC"> gate hooks but</font>

1088
00:40:55,460 --> 00:41:01,789
all of the code is<font color="#E5E5E5"> infrastructure things</font>

1089
00:40:58,249 --> 00:41:03,680
that require and control<font color="#E5E5E5"> and set up your</font>

1090
00:41:01,789 --> 00:41:05,210
<font color="#E5E5E5">development</font><font color="#CCCCCC"> situations and then also</font>

1091
00:41:03,680 --> 00:41:07,069
doing<font color="#E5E5E5"> some type</font><font color="#CCCCCC"> of configuration</font>

1092
00:41:05,210 --> 00:41:08,569
enforcement on that<font color="#CCCCCC"> I'll</font><font color="#E5E5E5"> make</font><font color="#CCCCCC"> a big</font>

1093
00:41:07,069 --> 00:41:10,160
<font color="#CCCCCC">reinforcement were like</font><font color="#E5E5E5"> puppet</font><font color="#CCCCCC"> chef</font>

1094
00:41:08,569 --> 00:41:12,349
these kind<font color="#E5E5E5"> of things really goes a long</font>

1095
00:41:10,160 --> 00:41:13,749
way host<font color="#E5E5E5"> based monitoring along</font><font color="#CCCCCC"> any</font>

1096
00:41:12,349 --> 00:41:16,819
alerting<font color="#E5E5E5"> and looking specifically for</font>

1097
00:41:13,749 --> 00:41:18,618
malicious development and exploitation

1098
00:41:16,819 --> 00:41:20,479
<font color="#E5E5E5">of developers goes a long way</font>

1099
00:41:18,619 --> 00:41:22,279
<font color="#E5E5E5">specifically in an environment like an</font>

1100
00:41:20,479 --> 00:41:24,140
agile dev shop where developers are

1101
00:41:22,279 --> 00:41:25,759
really<font color="#E5E5E5"> your highest potential point of</font>

1102
00:41:24,140 --> 00:41:28,038
failure<font color="#E5E5E5"> and they're the group that is</font>

1103
00:41:25,759 --> 00:41:29,509
technically making<font color="#E5E5E5"> the most money right</font>

1104
00:41:28,039 --> 00:41:31,910
<font color="#CCCCCC">because they're generating the product</font>

1105
00:41:29,509 --> 00:41:32,900
that your business staked on so not<font color="#E5E5E5"> only</font>

1106
00:41:31,910 --> 00:41:33,979
<font color="#E5E5E5">should they get the most</font><font color="#CCCCCC"> attention from</font>

1107
00:41:32,900 --> 00:41:35,989
<font color="#E5E5E5">the point of view</font><font color="#CCCCCC"> of protecting</font>

1108
00:41:33,979 --> 00:41:37,098
protecting<font color="#E5E5E5"> that asset they should get</font>

1109
00:41:35,989 --> 00:41:38,930
<font color="#E5E5E5">the most attention because they're going</font>

1110
00:41:37,099 --> 00:41:41,479
<font color="#E5E5E5">to need help to</font><font color="#CCCCCC"> be able</font><font color="#E5E5E5"> to do their job</font>

1111
00:41:38,930 --> 00:41:43,578
securely<font color="#E5E5E5"> and in a way that helps the</font>

1112
00:41:41,479 --> 00:41:44,779
<font color="#CCCCCC">entire company</font><font color="#E5E5E5"> be successful right and</font>

1113
00:41:43,579 --> 00:41:47,289
then<font color="#E5E5E5"> network segmentation this is</font>

1114
00:41:44,779 --> 00:41:49,400
<font color="#E5E5E5">old-school</font><font color="#CCCCCC"> tried-and-true</font><font color="#E5E5E5"> right</font>

1115
00:41:47,289 --> 00:41:51,230
reviewing and enforcing<font color="#CCCCCC"> Network</font>

1116
00:41:49,400 --> 00:41:55,820
segmentation not just on a point of<font color="#E5E5E5"> view</font>

1117
00:41:51,230 --> 00:41:58,430
of<font color="#E5E5E5"> port and IP but also on system and</font>

1118
00:41:55,820 --> 00:42:00,980
code<font color="#E5E5E5"> tenancy so where do my systems live</font>

1119
00:41:58,430 --> 00:42:03,799
<font color="#E5E5E5">where are my bridge points which systems</font>

1120
00:42:00,980 --> 00:42:07,000
are multihomed<font color="#E5E5E5"> what code transit trust</font>

1121
00:42:03,800 --> 00:42:10,070
stones<font color="#E5E5E5"> and am</font><font color="#CCCCCC"> I using something like</font>

1122
00:42:07,000 --> 00:42:12,050
<font color="#E5E5E5">clear clean source so clean source is a</font>

1123
00:42:10,070 --> 00:42:14,720
concept that<font color="#E5E5E5"> any code going into an</font>

1124
00:42:12,050 --> 00:42:17,330
environment<font color="#CCCCCC"> is as secure and safe as the</font>

1125
00:42:14,720 --> 00:42:19,310
environment<font color="#CCCCCC"> it's going</font><font color="#E5E5E5"> into</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> really</font>

1126
00:42:17,330 --> 00:42:20,540
<font color="#CCCCCC">really hard to do but these are</font><font color="#E5E5E5"> kind of</font>

1127
00:42:19,310 --> 00:42:21,500
<font color="#E5E5E5">the things</font><font color="#CCCCCC"> we need to</font><font color="#E5E5E5"> think about when</font>

1128
00:42:20,540 --> 00:42:26,090
we're<font color="#CCCCCC"> talking about these type of</font>

1129
00:42:21,500 --> 00:42:27,290
exploitation scenarios<font color="#E5E5E5"> all right so at</font>

1130
00:42:26,090 --> 00:42:28,730
this point<font color="#CCCCCC"> we're opened</font><font color="#E5E5E5"> up for questions</font>

1131
00:42:27,290 --> 00:42:30,650
<font color="#CCCCCC">I think we have a couple minutes for</font>

1132
00:42:28,730 --> 00:42:32,320
that while we're<font color="#CCCCCC"> doing</font><font color="#E5E5E5"> questions</font><font color="#CCCCCC"> we</font>

1133
00:42:30,650 --> 00:42:34,670
leave<font color="#CCCCCC"> our</font><font color="#E5E5E5"> contact info up and if you</font>

1134
00:42:32,320 --> 00:42:36,170
don't get time to<font color="#E5E5E5"> ask us question and</font>

1135
00:42:34,670 --> 00:42:37,760
we'll go to the<font color="#CCCCCC"> rap room</font><font color="#E5E5E5"> afterwards and</font>

1136
00:42:36,170 --> 00:42:40,160
we'll<font color="#E5E5E5"> have a little</font><font color="#CCCCCC"> more time if you</font>

1137
00:42:37,760 --> 00:42:40,730
<font color="#E5E5E5">need to thank you</font><font color="#CCCCCC"> thank</font><font color="#E5E5E5"> you for your</font>

1138
00:42:40,160 --> 00:42:49,609
time

1139
00:42:40,730 --> 00:42:58,680
[Applause]

1140
00:42:49,610 --> 00:43:01,380
yes<font color="#E5E5E5"> okay so the</font><font color="#CCCCCC"> question</font><font color="#E5E5E5"> was the example</font>

1141
00:42:58,680 --> 00:43:03,629
<font color="#CCCCCC">was Django</font><font color="#E5E5E5"> and what language</font><font color="#CCCCCC"> and</font>

1142
00:43:01,380 --> 00:43:07,130
<font color="#E5E5E5">platforms does it support so currently</font>

1143
00:43:03,630 --> 00:43:11,190
the backdooring<font color="#E5E5E5"> and agent code is</font>

1144
00:43:07,130 --> 00:43:14,460
written<font color="#E5E5E5"> in Python but that just means</font>

1145
00:43:11,190 --> 00:43:17,490
<font color="#E5E5E5">the machine that it's running on needs</font>

1146
00:43:14,460 --> 00:43:19,620
to also<font color="#E5E5E5"> have Python</font><font color="#CCCCCC"> because</font><font color="#E5E5E5"> just to like</font>

1147
00:43:17,490 --> 00:43:21,209
<font color="#E5E5E5">get</font><font color="#CCCCCC"> the bootstrap process running</font><font color="#E5E5E5"> but</font>

1148
00:43:19,620 --> 00:43:23,520
<font color="#E5E5E5">you can also say it's a Ruby on Rails</font>

1149
00:43:21,210 --> 00:43:26,760
project or really any language<font color="#CCCCCC"> you could</font>

1150
00:43:23,520 --> 00:43:29,130
<font color="#E5E5E5">just do a shell exec pipe in the</font>

1151
00:43:26,760 --> 00:43:31,440
bootstrapping<font color="#E5E5E5"> just into bash or</font>

1152
00:43:29,130 --> 00:43:33,210
something like<font color="#E5E5E5"> that basically</font><font color="#CCCCCC"> as long</font><font color="#E5E5E5"> as</font>

1153
00:43:31,440 --> 00:43:35,190
pythons installed on the<font color="#E5E5E5"> system you</font><font color="#CCCCCC"> can</font>

1154
00:43:33,210 --> 00:43:38,010
shell out to it in any<font color="#CCCCCC"> language in</font>

1155
00:43:35,190 --> 00:43:41,900
<font color="#E5E5E5">framework so I would say it's agnostic</font>

1156
00:43:38,010 --> 00:43:45,860
in that respect<font color="#CCCCCC"> Thank You Mac agnostic</font>

1157
00:43:41,900 --> 00:43:45,860
yeah any other questions

1158
00:43:51,680 --> 00:43:56,330
<font color="#E5E5E5">huh yes</font>

1159
00:44:05,040 --> 00:44:09,000
your<font color="#E5E5E5"> voice is actually getting minutes</font>

1160
00:44:06,780 --> 00:44:11,330
but<font color="#E5E5E5"> executing the commands how does that</font>

1161
00:44:09,000 --> 00:44:11,330
<font color="#E5E5E5">feedback</font>

1162
00:44:11,970 --> 00:44:16,299
yeah so<font color="#E5E5E5"> that's a great</font><font color="#CCCCCC"> question</font>

1163
00:44:14,140 --> 00:44:17,710
the question the question<font color="#CCCCCC"> was</font><font color="#E5E5E5"> we've</font>

1164
00:44:16,300 --> 00:44:18,760
<font color="#E5E5E5">taken a lot</font><font color="#CCCCCC"> of steps</font><font color="#E5E5E5"> to try to avoid</font>

1165
00:44:17,710 --> 00:44:20,230
detection

1166
00:44:18,760 --> 00:44:22,330
in terms of<font color="#E5E5E5"> light being recognized on</font>

1167
00:44:20,230 --> 00:44:26,530
<font color="#CCCCCC">disk how do</font><font color="#E5E5E5"> we prevent being recognized</font>

1168
00:44:22,330 --> 00:44:28,150
<font color="#E5E5E5">the actions themselves</font><font color="#CCCCCC"> so if say you</font>

1169
00:44:26,530 --> 00:44:30,460
have some sort<font color="#CCCCCC"> of host monitoring system</font>

1170
00:44:28,150 --> 00:44:31,870
that's looking for attempts<font color="#E5E5E5"> to dump the</font>

1171
00:44:30,460 --> 00:44:35,140
keychain<font color="#E5E5E5"> or do something</font><font color="#CCCCCC"> that might be</font>

1172
00:44:31,870 --> 00:44:37,240
bad<font color="#CCCCCC"> just</font><font color="#E5E5E5"> because we're running the</font>

1173
00:44:35,140 --> 00:44:38,799
commands in<font color="#E5E5E5"> a</font><font color="#CCCCCC"> stealthy way doesn't mean</font>

1174
00:44:37,240 --> 00:44:41,470
that someone<font color="#E5E5E5"> looking</font><font color="#CCCCCC"> for that</font><font color="#E5E5E5"> isn't</font>

1175
00:44:38,800 --> 00:44:43,030
<font color="#E5E5E5">going to see it so</font><font color="#CCCCCC"> if a command that you</font>

1176
00:44:41,470 --> 00:44:45,399
would run would get detected normally

1177
00:44:43,030 --> 00:44:48,520
this doesn't make that part better

1178
00:44:45,400 --> 00:44:50,200
that's sort<font color="#E5E5E5"> of the fundamental</font>

1179
00:44:48,520 --> 00:44:55,120
limitation of<font color="#E5E5E5"> what they're looking for</font>

1180
00:44:50,200 --> 00:44:56,890
<font color="#E5E5E5">on the host yeah so to caveat that so</font>

1181
00:44:55,120 --> 00:44:58,540
ultimately<font color="#E5E5E5"> any like advanced monitoring</font>

1182
00:44:56,890 --> 00:44:59,259
<font color="#E5E5E5">logging learning is</font><font color="#CCCCCC"> gonna catch plenty</font><font color="#E5E5E5"> X</font>

1183
00:44:58,540 --> 00:45:02,850
<font color="#E5E5E5">commands we were talking about</font>

1184
00:44:59,260 --> 00:45:05,290
<font color="#CCCCCC">potentially adding</font><font color="#E5E5E5"> some encryption to</font>

1185
00:45:02,850 --> 00:45:06,460
kind of<font color="#E5E5E5"> additionally protect things</font>

1186
00:45:05,290 --> 00:45:09,460
<font color="#E5E5E5">being passed but ultimately it's</font><font color="#CCCCCC"> gonna</font>

1187
00:45:06,460 --> 00:45:11,470
<font color="#E5E5E5">be in clear text at some point this</font><font color="#CCCCCC"> is a</font>

1188
00:45:09,460 --> 00:45:13,180
cool tool for showing these expectations

1189
00:45:11,470 --> 00:45:14,620
<font color="#E5E5E5">and doing the expectations and automate</font>

1190
00:45:13,180 --> 00:45:17,890
<font color="#CCCCCC">some stuff but</font><font color="#E5E5E5"> what doesn't</font><font color="#CCCCCC"> ultimately</font>

1191
00:45:14,620 --> 00:45:19,359
do is replace<font color="#E5E5E5"> the</font><font color="#CCCCCC"> skill of</font><font color="#E5E5E5"> an attacker</font>

1192
00:45:17,890 --> 00:45:20,859
<font color="#E5E5E5">right and ultimately when you're</font>

1193
00:45:19,360 --> 00:45:23,200
attacking a dev and something that<font color="#E5E5E5"> I've</font>

1194
00:45:20,860 --> 00:45:24,610
had<font color="#CCCCCC"> to learn</font><font color="#E5E5E5"> through a lot of stuff is</font>

1195
00:45:23,200 --> 00:45:27,759
<font color="#CCCCCC">that when you're attacking a developer</font>

1196
00:45:24,610 --> 00:45:30,550
<font color="#E5E5E5">you have</font><font color="#CCCCCC"> a lot of leeway to be within</font>

1197
00:45:27,760 --> 00:45:32,710
<font color="#E5E5E5">the context of user behavior</font><font color="#CCCCCC"> and still</font>

1198
00:45:30,550 --> 00:45:34,180
<font color="#E5E5E5">do a lot of really powerful things very</font>

1199
00:45:32,710 --> 00:45:36,700
<font color="#E5E5E5">often you don't need to dump the</font>

1200
00:45:34,180 --> 00:45:39,339
<font color="#CCCCCC">keychain</font><font color="#E5E5E5"> right you can do very simple</font>

1201
00:45:36,700 --> 00:45:41,890
behaviors built on how<font color="#E5E5E5"> their current</font>

1202
00:45:39,340 --> 00:45:43,870
workflows are for<font color="#CCCCCC"> instance very few devs</font>

1203
00:45:41,890 --> 00:45:46,930
actually<font color="#CCCCCC"> password protect or passphrase</font>

1204
00:45:43,870 --> 00:45:48,549
protect their SSH keys that are<font color="#E5E5E5"> used</font><font color="#CCCCCC"> for</font>

1205
00:45:46,930 --> 00:45:50,169
<font color="#E5E5E5">say committing to code repos and</font><font color="#CCCCCC"> those</font>

1206
00:45:48,550 --> 00:45:53,590
kind of things<font color="#CCCCCC"> and a commit looks</font>

1207
00:45:50,170 --> 00:45:54,430
relatively<font color="#E5E5E5"> mundane right so we can do a</font>

1208
00:45:53,590 --> 00:45:55,720
lot of<font color="#E5E5E5"> things spread through</font>

1209
00:45:54,430 --> 00:45:57,160
environments and<font color="#E5E5E5"> get to those critical</font>

1210
00:45:55,720 --> 00:45:58,270
<font color="#CCCCCC">points without necessarily</font><font color="#E5E5E5"> doing things</font>

1211
00:45:57,160 --> 00:45:59,920
like dumping<font color="#CCCCCC"> key chains or things that</font>

1212
00:45:58,270 --> 00:46:02,500
<font color="#E5E5E5">are going to get</font><font color="#CCCCCC"> us caught</font><font color="#E5E5E5"> so but</font>

1213
00:45:59,920 --> 00:46:04,870
understanding the<font color="#E5E5E5"> type of environment</font>

1214
00:46:02,500 --> 00:46:06,220
<font color="#CCCCCC">and the person you're looking</font><font color="#E5E5E5"> at who</font>

1215
00:46:04,870 --> 00:46:07,240
you're compromising really important so

1216
00:46:06,220 --> 00:46:09,669
one of<font color="#E5E5E5"> your first things you should do</font>

1217
00:46:07,240 --> 00:46:13,180
once you get on is take some time and

1218
00:46:09,670 --> 00:46:14,770
log outputs and then review the

1219
00:46:13,180 --> 00:46:16,240
behaviors that<font color="#E5E5E5"> are taking place looking</font>

1220
00:46:14,770 --> 00:46:17,830
at their bash histories and<font color="#E5E5E5"> these kind</font>

1221
00:46:16,240 --> 00:46:19,419
of<font color="#E5E5E5"> things</font><font color="#CCCCCC"> looking at their get histories</font>

1222
00:46:17,830 --> 00:46:22,299
you<font color="#CCCCCC"> can take that</font><font color="#E5E5E5"> and then create your</font>

1223
00:46:19,420 --> 00:46:23,270
exploitation method and what chain you

1224
00:46:22,300 --> 00:46:26,119
actually need to<font color="#E5E5E5"> follow</font>

1225
00:46:23,270 --> 00:46:28,130
and by creating<font color="#E5E5E5"> kind of a tolerance of</font>

1226
00:46:26,119 --> 00:46:29,300
how likely is<font color="#E5E5E5"> they're gonna catch on</font>

1227
00:46:28,130 --> 00:46:30,980
these<font color="#E5E5E5"> different things you can decide</font>

1228
00:46:29,300 --> 00:46:33,619
what's worth it to try<font color="#CCCCCC"> to actually do</font>

1229
00:46:30,980 --> 00:46:35,450
right<font color="#E5E5E5"> so I look long way just saying</font>

1230
00:46:33,619 --> 00:46:37,280
that<font color="#E5E5E5"> the tool does not replace</font><font color="#CCCCCC"> the</font>

1231
00:46:35,450 --> 00:46:38,450
<font color="#CCCCCC">skillset but the skills that</font><font color="#E5E5E5"> can really</font>

1232
00:46:37,280 --> 00:46:44,630
enable<font color="#E5E5E5"> this tool to do really cool</font>

1233
00:46:38,450 --> 00:46:48,310
<font color="#E5E5E5">things answer your question</font><font color="#CCCCCC"> Annie any</font>

1234
00:46:44,630 --> 00:46:48,310
more questions<font color="#E5E5E5"> yes sir</font>

1235
00:46:54,410 --> 00:47:00,170
sure so the<font color="#CCCCCC"> question was if a company</font>

1236
00:46:58,580 --> 00:47:02,029
uses a private get repo<font color="#E5E5E5"> and by that do</font>

1237
00:47:00,170 --> 00:47:04,070
you mean like they host their own<font color="#E5E5E5"> get</font>

1238
00:47:02,030 --> 00:47:07,010
server<font color="#CCCCCC"> alright so the case of they're</font>

1239
00:47:04,070 --> 00:47:08,480
hosting<font color="#CCCCCC"> their own git server inevitably</font>

1240
00:47:07,010 --> 00:47:10,010
<font color="#E5E5E5">you have to know that</font><font color="#CCCCCC"> it exists somehow</font>

1241
00:47:08,480 --> 00:47:12,320
whether that can<font color="#E5E5E5"> be via social</font>

1242
00:47:10,010 --> 00:47:14,600
engineering or reconnaissance or

1243
00:47:12,320 --> 00:47:16,100
anything like<font color="#CCCCCC"> that once you find out and</font>

1244
00:47:14,600 --> 00:47:17,089
get an initial foothold<font color="#E5E5E5"> on a system as</font>

1245
00:47:16,100 --> 00:47:18,980
<font color="#CCCCCC">long as they can talk about the public</font>

1246
00:47:17,090 --> 00:47:20,540
<font color="#CCCCCC">it</font><font color="#E5E5E5"> you can get that initial command</font><font color="#CCCCCC"> and</font>

1247
00:47:18,980 --> 00:47:22,100
<font color="#CCCCCC">control</font><font color="#E5E5E5"> find out the location and</font>

1248
00:47:20,540 --> 00:47:24,170
targets that<font color="#E5E5E5"> they're</font><font color="#CCCCCC"> using and then</font>

1249
00:47:22,100 --> 00:47:26,509
modify<font color="#CCCCCC"> the configs</font><font color="#E5E5E5"> and in order to then</font>

1250
00:47:24,170 --> 00:47:29,300
use that<font color="#CCCCCC"> git repo or that private get</font>

1251
00:47:26,510 --> 00:47:30,980
server as any component<font color="#E5E5E5"> of the</font>

1252
00:47:29,300 --> 00:47:33,260
<font color="#CCCCCC">exploitation chain that we're</font><font color="#E5E5E5"> talking</font>

1253
00:47:30,980 --> 00:47:34,190
about<font color="#E5E5E5"> including if you get a significant</font>

1254
00:47:33,260 --> 00:47:36,650
privileges you<font color="#CCCCCC"> can actually</font><font color="#E5E5E5"> turn that</font>

1255
00:47:34,190 --> 00:47:39,950
<font color="#E5E5E5">into your</font><font color="#CCCCCC"> C</font><font color="#E5E5E5"> to look into your actual</font><font color="#CCCCCC"> CG</font>

1256
00:47:36,650 --> 00:47:41,870
server yeah so github is used as<font color="#E5E5E5"> the</font>

1257
00:47:39,950 --> 00:47:44,149
command and control mechanism but<font color="#CCCCCC"> there</font>

1258
00:47:41,870 --> 00:47:46,339
get internal git repos can be<font color="#E5E5E5"> hosted</font>

1259
00:47:44,150 --> 00:47:48,230
anywhere so it could<font color="#E5E5E5"> be private github</font>

1260
00:47:46,340 --> 00:47:50,510
in our play enterprise private<font color="#E5E5E5"> get lab</font>

1261
00:47:48,230 --> 00:47:52,400
<font color="#E5E5E5">and get a light it doesn't matter it's</font>

1262
00:47:50,510 --> 00:47:54,200
<font color="#E5E5E5">just one of the mechanism of propagating</font>

1263
00:47:52,400 --> 00:47:57,290
<font color="#E5E5E5">the initial backdoor which as long as</font>

1264
00:47:54,200 --> 00:47:58,640
they use<font color="#E5E5E5"> get it works the same yeah</font>

1265
00:47:57,290 --> 00:47:59,690
great question<font color="#CCCCCC"> I</font><font color="#E5E5E5"> think</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> with that</font>

1266
00:47:58,640 --> 00:48:01,220
we're<font color="#E5E5E5"> out of time but</font><font color="#CCCCCC"> if</font><font color="#E5E5E5"> you guys have</font>

1267
00:47:59,690 --> 00:48:03,370
<font color="#E5E5E5">additional questions we'll move over to</font>

1268
00:48:01,220 --> 00:48:06,759
<font color="#E5E5E5">the wrap room</font><font color="#CCCCCC"> Thanks yeah</font><font color="#E5E5E5"> thanks</font><font color="#CCCCCC"> again</font>

1269
00:48:03,370 --> 00:48:06,759
[Applause]

