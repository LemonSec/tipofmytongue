1
00:00:00,000 --> 00:00:07,410
hey guys<font color="#CCCCCC"> how's</font><font color="#E5E5E5"> everybody doing good well</font>

2
00:00:05,100 --> 00:00:10,260
I just got<font color="#CCCCCC"> four</font><font color="#E5E5E5"> fidgets spinners all at</font>

3
00:00:07,410 --> 00:00:11,550
the<font color="#E5E5E5"> same</font><font color="#CCCCCC"> time and now I'm</font><font color="#E5E5E5"> comparing him</font>

4
00:00:10,260 --> 00:00:13,280
I<font color="#E5E5E5"> don't know does anybody have this one</font>

5
00:00:11,550 --> 00:00:17,220
<font color="#CCCCCC">check this out</font>

6
00:00:13,280 --> 00:00:19,289
it's like mystical it's totally<font color="#E5E5E5"> amazing</font>

7
00:00:17,220 --> 00:00:21,720
<font color="#E5E5E5">all right sorry this is not fidget</font>

8
00:00:19,289 --> 00:00:24,539
spinner reviews this is exploit<font color="#E5E5E5"> kick</font>

9
00:00:21,720 --> 00:00:26,310
cornucopia<font color="#E5E5E5"> although it may change into</font>

10
00:00:24,539 --> 00:00:30,750
<font color="#E5E5E5">it all right so my</font><font color="#CCCCCC"> name is</font><font color="#E5E5E5"> Brad Anton oh</font>

11
00:00:26,310 --> 00:00:33,899
it's I work for Cisco<font color="#E5E5E5"> umbrella and I do</font>

12
00:00:30,750 --> 00:00:35,850
security research<font color="#E5E5E5"> there we do you know</font>

13
00:00:33,899 --> 00:00:38,250
<font color="#CCCCCC">our goal at Cisco umbrella</font><font color="#E5E5E5"> and our group</font>

14
00:00:35,850 --> 00:00:39,329
is to<font color="#E5E5E5"> find stuff to block and so that's</font>

15
00:00:38,250 --> 00:00:44,340
<font color="#E5E5E5">kind of what we're gonna be</font><font color="#CCCCCC"> talking</font>

16
00:00:39,329 --> 00:00:47,250
about<font color="#CCCCCC"> today</font><font color="#E5E5E5"> hi guys I'm a</font><font color="#CCCCCC"> Brad's coffee</font>

17
00:00:44,340 --> 00:00:49,530
trainer or a coffee fetcher and<font color="#E5E5E5"> Frankie</font>

18
00:00:47,250 --> 00:00:52,320
now I'm Matt Foley I'm an intern at

19
00:00:49,530 --> 00:00:55,170
Cisco umbrella<font color="#E5E5E5"> and I'm also a student at</font>

20
00:00:52,320 --> 00:00:59,100
<font color="#E5E5E5">NYU stand in School</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> Engineering this</font>

21
00:00:55,170 --> 00:01:00,120
is basically all<font color="#CCCCCC"> of</font><font color="#E5E5E5"> Matt's work so so</font>

22
00:00:59,100 --> 00:01:02,879
just<font color="#CCCCCC"> keep that in mind as we go through</font>

23
00:01:00,120 --> 00:01:04,860
<font color="#CCCCCC">otherwise</font><font color="#E5E5E5"> all right so today what we're</font>

24
00:01:02,879 --> 00:01:07,229
<font color="#E5E5E5">gonna do like I mentioned in our group</font>

25
00:01:04,860 --> 00:01:09,539
we do a<font color="#E5E5E5"> lot</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> research and we spend a</font>

26
00:01:07,229 --> 00:01:12,750
lot<font color="#CCCCCC"> of time detecting</font><font color="#E5E5E5"> things all over</font>

27
00:01:09,540 --> 00:01:15,360
the<font color="#E5E5E5"> sort of the spectrum and we decided</font>

28
00:01:12,750 --> 00:01:17,220
you<font color="#E5E5E5"> know we sort of were doing all of</font>

29
00:01:15,360 --> 00:01:19,520
this exploit<font color="#E5E5E5"> kit research and we found</font>

30
00:01:17,220 --> 00:01:22,740
<font color="#E5E5E5">some really great ways to</font><font color="#CCCCCC"> identify</font>

31
00:01:19,520 --> 00:01:25,979
exploit kits<font color="#E5E5E5"> and block them and</font><font color="#CCCCCC"> we also</font>

32
00:01:22,740 --> 00:01:29,669
found<font color="#E5E5E5"> all</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> these kind of other</font><font color="#CCCCCC"> things</font>

33
00:01:25,979 --> 00:01:32,250
that<font color="#E5E5E5"> by themselves weren't amazing talks</font>

34
00:01:29,670 --> 00:01:35,729
<font color="#E5E5E5">all like they they were too short of</font>

35
00:01:32,250 --> 00:01:36,869
items to go over in a single talk<font color="#E5E5E5"> so</font>

36
00:01:35,729 --> 00:01:39,179
what we<font color="#E5E5E5"> did was we were like you know</font>

37
00:01:36,869 --> 00:01:41,040
<font color="#E5E5E5">what we're just gonna combine them and</font>

38
00:01:39,180 --> 00:01:44,460
you guys are gonna get<font color="#E5E5E5"> basically for</font>

39
00:01:41,040 --> 00:01:46,470
<font color="#E5E5E5">talks in one session</font><font color="#CCCCCC"> so you're gonna see</font>

40
00:01:44,460 --> 00:01:48,329
four<font color="#CCCCCC"> different ways to detect exploit</font>

41
00:01:46,470 --> 00:01:49,798
kits and all types of<font color="#E5E5E5"> different things</font>

42
00:01:48,329 --> 00:01:51,898
<font color="#E5E5E5">that we've</font><font color="#CCCCCC"> put</font><font color="#E5E5E5"> together so basically</font>

43
00:01:49,799 --> 00:01:55,560
this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> the best bang for your buck</font>

44
00:01:51,899 --> 00:02:00,060
you're gonna get at blackhat<font color="#E5E5E5"> so we're</font>

45
00:01:55,560 --> 00:02:00,960
<font color="#E5E5E5">going</font><font color="#CCCCCC"> to talk all about our a little</font><font color="#E5E5E5"> bit</font>

46
00:02:00,060 --> 00:02:02,070
of background<font color="#E5E5E5"> we're gonna start off with</font>

47
00:02:00,960 --> 00:02:03,600
<font color="#CCCCCC">some background so if you don't know a</font>

48
00:02:02,070 --> 00:02:05,008
<font color="#E5E5E5">ton about exploit kits will bring up</font><font color="#CCCCCC"> to</font>

49
00:02:03,600 --> 00:02:08,459
<font color="#E5E5E5">speed really quick</font>

50
00:02:05,009 --> 00:02:10,470
and then we're gonna give of some detail

51
00:02:08,459 --> 00:02:12,599
into<font color="#E5E5E5"> our crawler</font><font color="#CCCCCC"> we'll talk to you to</font>

52
00:02:10,470 --> 00:02:13,920
tell about ways that<font color="#E5E5E5"> you can amplify</font>

53
00:02:12,599 --> 00:02:15,959
<font color="#E5E5E5">conviction so once you</font>

54
00:02:13,920 --> 00:02:18,030
one thing to block once you find one

55
00:02:15,960 --> 00:02:21,450
part of<font color="#E5E5E5"> an exploit kit how you can sort</font>

56
00:02:18,030 --> 00:02:23,220
<font color="#CCCCCC">of amplify that</font><font color="#E5E5E5"> and find a lot more and</font>

57
00:02:21,450 --> 00:02:24,839
then we're gonna look at this<font color="#E5E5E5"> kind of</font>

58
00:02:23,220 --> 00:02:27,930
interesting thing that<font color="#E5E5E5"> we found</font><font color="#CCCCCC"> we found</font>

59
00:02:24,840 --> 00:02:30,750
<font color="#E5E5E5">a</font><font color="#CCCCCC"> vulnerability actually in</font><font color="#E5E5E5"> in some of</font>

60
00:02:27,930 --> 00:02:33,930
this exploit kit stuff<font color="#CCCCCC"> and so we'll show</font>

61
00:02:30,750 --> 00:02:35,850
you that<font color="#E5E5E5"> vulnerability and and talk</font>

62
00:02:33,930 --> 00:02:37,440
<font color="#E5E5E5">about it and then the last part is we're</font>

63
00:02:35,850 --> 00:02:40,320
gonna bring it<font color="#E5E5E5"> all together with talking</font>

64
00:02:37,440 --> 00:02:43,680
<font color="#E5E5E5">about</font><font color="#CCCCCC"> a way that you can</font><font color="#E5E5E5"> look at and</font>

65
00:02:40,320 --> 00:02:47,400
easily obtain the<font color="#E5E5E5"> malware that's often</font>

66
00:02:43,680 --> 00:02:49,020
<font color="#E5E5E5">distributed via exploit kits and and</font>

67
00:02:47,400 --> 00:02:52,500
just general like sort of phishing

68
00:02:49,020 --> 00:02:55,110
campaigns<font color="#CCCCCC"> alright so first and foremost</font>

69
00:02:52,500 --> 00:02:58,980
<font color="#CCCCCC">I want</font><font color="#E5E5E5"> to you know</font><font color="#CCCCCC"> talk about</font><font color="#E5E5E5"> the</font>

70
00:02:55,110 --> 00:03:02,820
<font color="#E5E5E5">background</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is my favorite exploit</font>

71
00:02:58,980 --> 00:03:06,000
kit site<font color="#E5E5E5"> ever I'm from New Jersey right</font>

72
00:03:02,820 --> 00:03:08,340
outside of<font color="#CCCCCC"> of New</font><font color="#E5E5E5"> York and this is a</font>

73
00:03:06,000 --> 00:03:11,459
<font color="#E5E5E5">legitimate</font><font color="#CCCCCC"> website this is NYC running</font>

74
00:03:08,340 --> 00:03:13,440
mama calm the<font color="#E5E5E5"> person who runs it is this</font>

75
00:03:11,459 --> 00:03:15,239
woman named Michelle<font color="#E5E5E5"> she lives in New</font>

76
00:03:13,440 --> 00:03:18,209
<font color="#CCCCCC">York it's like I feel like I could run</font>

77
00:03:15,239 --> 00:03:22,799
into<font color="#E5E5E5"> her on the subway at any particular</font>

78
00:03:18,209 --> 00:03:24,750
day<font color="#CCCCCC"> or time</font><font color="#E5E5E5"> she she loves you know she</font>

79
00:03:22,799 --> 00:03:26,519
really<font color="#E5E5E5"> likes</font><font color="#CCCCCC"> to run</font><font color="#E5E5E5"> so she goes out</font><font color="#CCCCCC"> and</font>

80
00:03:24,750 --> 00:03:28,650
<font color="#CCCCCC">she does</font><font color="#E5E5E5"> all this running she loves her</font>

81
00:03:26,519 --> 00:03:30,810
<font color="#E5E5E5">kids she seems like a good mom she takes</font>

82
00:03:28,650 --> 00:03:33,090
<font color="#E5E5E5">pictures</font><font color="#CCCCCC"> posts them all up on</font><font color="#E5E5E5"> her</font>

83
00:03:30,810 --> 00:03:35,459
<font color="#E5E5E5">WordPress site and</font><font color="#CCCCCC"> kind</font><font color="#E5E5E5"> of shows them</font>

84
00:03:33,090 --> 00:03:38,340
all shows them off and<font color="#E5E5E5"> people go to it</font>

85
00:03:35,459 --> 00:03:40,829
like<font color="#CCCCCC"> Michelle has</font><font color="#E5E5E5"> I think</font><font color="#CCCCCC"> like 16,000</font>

86
00:03:38,340 --> 00:03:42,269
<font color="#E5E5E5">followers like she's kind of a big deal</font>

87
00:03:40,829 --> 00:03:45,120
<font color="#E5E5E5">I mean at</font><font color="#CCCCCC"> least compared to</font><font color="#E5E5E5"> me I like</font>

88
00:03:42,269 --> 00:03:48,420
<font color="#CCCCCC">five right so she's she's definitely</font>

89
00:03:45,120 --> 00:03:49,920
some<font color="#E5E5E5"> you know pretty</font><font color="#CCCCCC"> pretty awesome</font>

90
00:03:48,420 --> 00:03:51,809
the thing about Michelle is<font color="#CCCCCC"> that she's</font>

91
00:03:49,920 --> 00:03:54,179
<font color="#E5E5E5">not like</font><font color="#CCCCCC"> a wordpress admin she doesn't</font>

92
00:03:51,810 --> 00:03:54,959
know about<font color="#E5E5E5"> computers</font><font color="#CCCCCC"> and like hacking</font>

93
00:03:54,180 --> 00:03:57,329
<font color="#E5E5E5">and all that stuff</font><font color="#CCCCCC"> she knows about</font>

94
00:03:54,959 --> 00:03:59,880
running and<font color="#E5E5E5"> being a good mom</font><font color="#CCCCCC"> right and</font>

95
00:03:57,329 --> 00:04:04,049
so something sort of unfortunate happens

96
00:03:59,880 --> 00:04:06,630
<font color="#E5E5E5">when when you go to Michelle's</font><font color="#CCCCCC"> website</font>

97
00:04:04,049 --> 00:04:09,870
<font color="#E5E5E5">depending on what</font><font color="#CCCCCC"> browser you so you get</font>

98
00:04:06,630 --> 00:04:13,109
<font color="#E5E5E5">two different</font><font color="#CCCCCC"> experiences</font><font color="#E5E5E5"> on the on the</font>

99
00:04:09,870 --> 00:04:16,289
<font color="#E5E5E5">left</font><font color="#CCCCCC"> hand side when you</font><font color="#E5E5E5"> go to Michelle's</font>

100
00:04:13,109 --> 00:04:17,940
<font color="#E5E5E5">website using</font><font color="#CCCCCC"> Chrome you render</font>

101
00:04:16,289 --> 00:04:20,219
everything fine<font color="#E5E5E5"> but on the right hand</font>

102
00:04:17,940 --> 00:04:21,329
<font color="#CCCCCC">side something</font><font color="#E5E5E5"> different happens right</font>

103
00:04:20,220 --> 00:04:23,910
there's<font color="#E5E5E5"> something a little</font><font color="#CCCCCC"> sort of</font>

104
00:04:21,329 --> 00:04:26,849
strange<font color="#E5E5E5"> that's happening there and</font>

105
00:04:23,910 --> 00:04:28,250
that's oh is that I guess left hand left

106
00:04:26,849 --> 00:04:34,920
<font color="#E5E5E5">hand side</font>

107
00:04:28,250 --> 00:04:37,080
you know what which one<font color="#CCCCCC"> is wrong</font><font color="#E5E5E5"> so the</font>

108
00:04:34,920 --> 00:04:39,030
<font color="#CCCCCC">wood</font><font color="#E5E5E5"> the one that's wrong</font><font color="#CCCCCC"> is the one</font>

109
00:04:37,080 --> 00:04:40,590
<font color="#E5E5E5">that has this pop-up that happens now</font>

110
00:04:39,030 --> 00:04:43,260
the the<font color="#CCCCCC"> messed-up thing</font><font color="#E5E5E5"> about this</font>

111
00:04:40,590 --> 00:04:45,390
<font color="#CCCCCC">pop-up is this is no</font><font color="#E5E5E5"> JavaScript pop-up</font>

112
00:04:43,260 --> 00:04:46,289
this is not just some like alert or

113
00:04:45,390 --> 00:04:48,810
something like<font color="#E5E5E5"> that</font>

114
00:04:46,290 --> 00:04:51,590
this is opera this pop-up<font color="#E5E5E5"> is occurring</font>

115
00:04:48,810 --> 00:04:54,090
outside<font color="#CCCCCC"> of the context of the</font><font color="#E5E5E5"> browser</font>

116
00:04:51,590 --> 00:04:57,659
<font color="#E5E5E5">when you visit Michele's website</font>

117
00:04:54,090 --> 00:04:59,520
something<font color="#CCCCCC"> happens where executable is</font>

118
00:04:57,660 --> 00:05:01,290
running<font color="#E5E5E5"> locally</font><font color="#CCCCCC"> on your system</font><font color="#E5E5E5"> and</font>

119
00:04:59,520 --> 00:05:04,169
crashes right

120
00:05:01,290 --> 00:05:06,750
this is not what NYC running<font color="#CCCCCC"> mama is</font>

121
00:05:04,170 --> 00:05:09,510
about<font color="#CCCCCC"> so it's sort of strange so if you</font>

122
00:05:06,750 --> 00:05:12,210
look a level deeper<font color="#CCCCCC"> you see a sort</font><font color="#E5E5E5"> of a</font>

123
00:05:09,510 --> 00:05:13,860
something more into that story<font color="#CCCCCC"> so if you</font>

124
00:05:12,210 --> 00:05:15,359
look at the<font color="#E5E5E5"> Internet Explorer side</font>

125
00:05:13,860 --> 00:05:18,480
<font color="#E5E5E5">you'll</font><font color="#CCCCCC"> see that there's a couple</font><font color="#E5E5E5"> of</font>

126
00:05:15,360 --> 00:05:21,930
extra<font color="#E5E5E5"> added lines in there and those</font>

127
00:05:18,480 --> 00:05:24,300
lines<font color="#E5E5E5"> aren't</font><font color="#CCCCCC"> also present in in</font><font color="#E5E5E5"> chrome</font>

128
00:05:21,930 --> 00:05:27,120
and if you look at those specific lines

129
00:05:24,300 --> 00:05:29,730
<font color="#E5E5E5">they actually match a very specific and</font>

130
00:05:27,120 --> 00:05:32,490
distinct pattern in the<font color="#E5E5E5"> exploit</font><font color="#CCCCCC"> kick</font>

131
00:05:29,730 --> 00:05:34,980
community it matches the<font color="#E5E5E5"> pseudo dark</font>

132
00:05:32,490 --> 00:05:37,980
<font color="#E5E5E5">leach campaign using the rig exploit kit</font>

133
00:05:34,980 --> 00:05:40,320
and the way that we know<font color="#E5E5E5"> that is by the</font>

134
00:05:37,980 --> 00:05:42,720
actual<font color="#E5E5E5"> sort of characters</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> are there</font>

135
00:05:40,320 --> 00:05:45,690
<font color="#E5E5E5">the length of those</font><font color="#CCCCCC"> either sort</font><font color="#E5E5E5"> of six</font>

136
00:05:42,720 --> 00:05:47,070
lines<font color="#E5E5E5"> the there's some random characters</font>

137
00:05:45,690 --> 00:05:49,530
<font color="#CCCCCC">there's an iframe some more random</font>

138
00:05:47,070 --> 00:05:51,630
characters<font color="#E5E5E5"> that whole pattern is a way</font>

139
00:05:49,530 --> 00:05:54,510
that<font color="#CCCCCC"> we</font><font color="#E5E5E5"> can identify pseudo dark</font><font color="#CCCCCC"> leech</font>

140
00:05:51,630 --> 00:05:58,920
and we can also<font color="#E5E5E5"> identify</font><font color="#CCCCCC"> rig</font><font color="#E5E5E5"> through the</font>

141
00:05:54,510 --> 00:06:01,320
URI in the iframe source<font color="#E5E5E5"> based on that</font>

142
00:05:58,920 --> 00:06:04,920
and so we can really<font color="#E5E5E5"> quickly identify</font>

143
00:06:01,320 --> 00:06:07,610
that and so<font color="#E5E5E5"> so to help you understand</font><font color="#CCCCCC"> a</font>

144
00:06:04,920 --> 00:06:09,810
<font color="#CCCCCC">Michels website is actually now</font>

145
00:06:07,610 --> 00:06:12,090
participating in exploit<font color="#E5E5E5"> kit she doesn't</font>

146
00:06:09,810 --> 00:06:14,580
even<font color="#E5E5E5"> know this is happening</font><font color="#CCCCCC"> right but</font><font color="#E5E5E5"> to</font>

147
00:06:12,090 --> 00:06:19,229
<font color="#E5E5E5">her WordPress site got compromised and</font>

148
00:06:14,580 --> 00:06:21,719
now<font color="#E5E5E5"> she's now serving up an exploit kit</font>

149
00:06:19,230 --> 00:06:23,730
so exploit<font color="#CCCCCC"> kits over the years</font><font color="#E5E5E5"> there's</font>

150
00:06:21,720 --> 00:06:24,960
<font color="#E5E5E5">nothing like</font><font color="#CCCCCC"> brand new they've sort of</font>

151
00:06:23,730 --> 00:06:26,040
evolved over<font color="#E5E5E5"> there some of them really</font>

152
00:06:24,960 --> 00:06:28,109
<font color="#E5E5E5">great I don't</font><font color="#CCCCCC"> know if you saw the one</font>

153
00:06:26,040 --> 00:06:30,900
<font color="#CCCCCC">with the gun and</font><font color="#E5E5E5"> the weird white powder</font>

154
00:06:28,110 --> 00:06:32,550
substance<font color="#E5E5E5"> you log into</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> cellphone like</font>

155
00:06:30,900 --> 00:06:36,690
<font color="#E5E5E5">they're really embracing the whole</font>

156
00:06:32,550 --> 00:06:38,850
<font color="#E5E5E5">criminal ecosystem at that point and so</font>

157
00:06:36,690 --> 00:06:41,340
so with<font color="#E5E5E5"> these exploit gates what they do</font>

158
00:06:38,850 --> 00:06:45,780
is they essentially are selling

159
00:06:41,340 --> 00:06:48,989
the ability to<font color="#E5E5E5"> execute code on your</font>

160
00:06:45,780 --> 00:06:51,539
victim system right<font color="#E5E5E5"> there are a website</font>

161
00:06:48,990 --> 00:06:54,660
that when someone visits<font color="#E5E5E5"> that website</font>

162
00:06:51,540 --> 00:06:57,270
<font color="#CCCCCC">they get they get sort of targeted with</font>

163
00:06:54,660 --> 00:07:00,210
an exploit<font color="#E5E5E5"> and that exploit then</font>

164
00:06:57,270 --> 00:07:03,539
delivers some payload that<font color="#E5E5E5"> the criminal</font>

165
00:07:00,210 --> 00:07:06,989
has purchased<font color="#E5E5E5"> and is paying for as part</font>

166
00:07:03,540 --> 00:07:10,020
<font color="#E5E5E5">of this whole</font><font color="#CCCCCC"> ecosystem and the payload</font>

167
00:07:06,990 --> 00:07:12,600
is usually you know as as far as the

168
00:07:10,020 --> 00:07:14,789
exploit goes the exploits goal is to

169
00:07:12,600 --> 00:07:16,140
have<font color="#E5E5E5"> execute a one-liner so this is kind</font>

170
00:07:14,790 --> 00:07:17,790
of<font color="#E5E5E5"> what the one-liner would look like</font>

171
00:07:16,140 --> 00:07:20,820
<font color="#E5E5E5">what it's basically doing is it's</font>

172
00:07:17,790 --> 00:07:23,400
writing<font color="#E5E5E5"> out on to disk of vbscript</font>

173
00:07:20,820 --> 00:07:26,370
<font color="#E5E5E5">and it's then executing that VB script</font>

174
00:07:23,400 --> 00:07:29,280
the VB script<font color="#E5E5E5"> fetches a</font><font color="#CCCCCC"> dll from the</font>

175
00:07:26,370 --> 00:07:31,440
<font color="#CCCCCC">internet and then executes the DLL so</font>

176
00:07:29,280 --> 00:07:33,809
super simple<font color="#CCCCCC"> but at the end</font><font color="#E5E5E5"> of the day</font>

177
00:07:31,440 --> 00:07:35,460
<font color="#E5E5E5">it's really effective because it's</font>

178
00:07:33,810 --> 00:07:39,690
taking advantage<font color="#CCCCCC"> of</font><font color="#E5E5E5"> a vulnerability in</font>

179
00:07:35,460 --> 00:07:40,560
that browser<font color="#CCCCCC"> usually</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> is because</font>

180
00:07:39,690 --> 00:07:43,820
it's part<font color="#E5E5E5"> of this whole criminal</font>

181
00:07:40,560 --> 00:07:47,040
ecosystem usually it's meant to

182
00:07:43,820 --> 00:07:48,750
distribute<font color="#E5E5E5"> of like ransomware or banking</font>

183
00:07:47,040 --> 00:07:50,040
Trojan something like that so<font color="#CCCCCC"> that a</font>

184
00:07:48,750 --> 00:07:52,260
criminal<font color="#CCCCCC"> could make money off of it</font>

185
00:07:50,040 --> 00:07:54,720
<font color="#E5E5E5">right now</font>

186
00:07:52,260 --> 00:07:57,240
<font color="#CCCCCC">Michels web site in the exploit</font><font color="#E5E5E5"> kid</font>

187
00:07:54,720 --> 00:07:59,940
world is called in a compromised<font color="#E5E5E5"> site</font>

188
00:07:57,240 --> 00:08:02,460
right<font color="#E5E5E5"> hers</font><font color="#CCCCCC"> website</font><font color="#E5E5E5"> got compromised and</font>

189
00:07:59,940 --> 00:08:06,330
now it's redirecting<font color="#E5E5E5"> the compromised</font>

190
00:08:02,460 --> 00:08:09,539
site<font color="#CCCCCC"> acts</font><font color="#E5E5E5"> as as a proxy between the</font>

191
00:08:06,330 --> 00:08:12,510
victim and<font color="#E5E5E5"> this back-end</font><font color="#CCCCCC"> exploit kit</font>

192
00:08:09,539 --> 00:08:14,789
ecosystem<font color="#E5E5E5"> there's a</font><font color="#CCCCCC"> exploit</font><font color="#E5E5E5"> server that</font>

193
00:08:12,510 --> 00:08:17,550
that's there and this the compromised

194
00:08:14,789 --> 00:08:20,419
site actually<font color="#CCCCCC"> makes requests to the</font>

195
00:08:17,550 --> 00:08:22,770
server<font color="#E5E5E5"> to pull in that iframe content</font>

196
00:08:20,419 --> 00:08:24,630
<font color="#E5E5E5">now there's another way that's really</font>

197
00:08:22,770 --> 00:08:26,400
<font color="#CCCCCC">popular for</font><font color="#E5E5E5"> exploit kid authors to use</font>

198
00:08:24,630 --> 00:08:28,620
and that's called malvert<font color="#CCCCCC"> izing that's</font>

199
00:08:26,400 --> 00:08:32,640
the bottom part of the the slide here

200
00:08:28,620 --> 00:08:34,740
this sort of second way works with ad

201
00:08:32,640 --> 00:08:37,229
<font color="#CCCCCC">networks so ad network subscribers</font>

202
00:08:34,740 --> 00:08:39,299
<font color="#CCCCCC">people who sign up to make</font><font color="#E5E5E5"> money off of</font>

203
00:08:37,229 --> 00:08:42,270
<font color="#E5E5E5">having you know selling the space of</font>

204
00:08:39,299 --> 00:08:44,609
<font color="#E5E5E5">their</font><font color="#CCCCCC"> web site will opt in to an ad</font>

205
00:08:42,270 --> 00:08:46,500
network<font color="#E5E5E5"> and what the attackers will do</font>

206
00:08:44,610 --> 00:08:48,780
the<font color="#CCCCCC"> exploited kid authors will do is</font>

207
00:08:46,500 --> 00:08:52,380
they'll sign up as a publisher<font color="#CCCCCC"> to this</font>

208
00:08:48,780 --> 00:08:55,470
network<font color="#E5E5E5"> and so they sign up they</font>

209
00:08:52,380 --> 00:08:57,510
have another<font color="#E5E5E5"> system that will be the ad</font>

210
00:08:55,470 --> 00:09:00,540
but<font color="#E5E5E5"> is basically just the the iframe</font>

211
00:08:57,510 --> 00:09:02,730
itself<font color="#CCCCCC"> and whoever is a subscriber</font><font color="#E5E5E5"> to</font>

212
00:09:00,540 --> 00:09:04,680
that ad network<font color="#E5E5E5"> then</font><font color="#CCCCCC"> will be</font><font color="#E5E5E5"> publishing</font>

213
00:09:02,730 --> 00:09:06,720
out this exploit kit and the same thing

214
00:09:04,680 --> 00:09:08,790
happens<font color="#E5E5E5"> in this case the attackers</font>

215
00:09:06,720 --> 00:09:11,340
machine operates as that proxy<font color="#CCCCCC"> between</font>

216
00:09:08,790 --> 00:09:13,199
the the<font color="#CCCCCC"> back-end server and the victim</font>

217
00:09:11,340 --> 00:09:15,630
and they infect the victim with whatever

218
00:09:13,200 --> 00:09:18,840
<font color="#E5E5E5">they're going to infect now there's</font><font color="#CCCCCC"> a</font>

219
00:09:15,630 --> 00:09:22,080
<font color="#CCCCCC">other sort of area</font><font color="#E5E5E5"> about this</font><font color="#CCCCCC"> too</font>

220
00:09:18,840 --> 00:09:25,380
once you get that<font color="#E5E5E5"> iframe and actually</font>

221
00:09:22,080 --> 00:09:28,590
sort of render it<font color="#CCCCCC"> your you're also gonna</font>

222
00:09:25,380 --> 00:09:31,620
get an exploit<font color="#E5E5E5"> but before that what</font>

223
00:09:28,590 --> 00:09:33,420
needs<font color="#E5E5E5"> to happen is that there's a whole</font>

224
00:09:31,620 --> 00:09:35,220
<font color="#E5E5E5">bunch of filtering that happens so</font>

225
00:09:33,420 --> 00:09:39,180
<font color="#E5E5E5">imagine you're an exploit kit author and</font>

226
00:09:35,220 --> 00:09:40,890
you're trying to<font color="#E5E5E5"> you</font><font color="#CCCCCC"> know sort</font><font color="#E5E5E5"> of attack</font>

227
00:09:39,180 --> 00:09:42,870
someone<font color="#E5E5E5"> but you're also trying to</font>

228
00:09:40,890 --> 00:09:45,090
<font color="#E5E5E5">protect</font><font color="#CCCCCC"> yourself</font><font color="#E5E5E5"> against researchers and</font>

229
00:09:42,870 --> 00:09:47,520
things like<font color="#E5E5E5"> that</font><font color="#CCCCCC"> well what you do</font><font color="#E5E5E5"> is you</font>

230
00:09:45,090 --> 00:09:50,400
filter heavily the people who are coming

231
00:09:47,520 --> 00:09:52,800
<font color="#CCCCCC">to</font><font color="#E5E5E5"> your system right you don't want to</font>

232
00:09:50,400 --> 00:09:54,990
send an exploit<font color="#E5E5E5"> to a researcher</font><font color="#CCCCCC"> you also</font>

233
00:09:52,800 --> 00:09:57,030
<font color="#CCCCCC">don't want to send the wrong exploit to</font>

234
00:09:54,990 --> 00:09:58,740
the wrong browser or version<font color="#E5E5E5"> because</font>

235
00:09:57,030 --> 00:10:01,500
it's not gonna land it's<font color="#E5E5E5"> not gonna be</font>

236
00:09:58,740 --> 00:10:04,020
successful<font color="#CCCCCC"> so there's a big thing that</font>

237
00:10:01,500 --> 00:10:07,230
happens in all of this is that<font color="#E5E5E5"> exploit</font>

238
00:10:04,020 --> 00:10:09,780
authors<font color="#E5E5E5"> use a heavy level of filtering</font>

239
00:10:07,230 --> 00:10:11,610
<font color="#E5E5E5">to figure out who they're actually going</font>

240
00:10:09,780 --> 00:10:13,500
to target<font color="#CCCCCC"> at this stage when someone</font>

241
00:10:11,610 --> 00:10:14,670
lands<font color="#E5E5E5"> on one of these ads are these</font>

242
00:10:13,500 --> 00:10:15,900
compromised sites they're trying to

243
00:10:14,670 --> 00:10:18,959
<font color="#E5E5E5">figure</font><font color="#CCCCCC"> out who they're</font><font color="#E5E5E5"> going to</font><font color="#CCCCCC"> target</font>

244
00:10:15,900 --> 00:10:21,420
<font color="#E5E5E5">so this is</font><font color="#CCCCCC"> Kotaro it's a TDS or</font><font color="#E5E5E5"> a</font>

245
00:10:18,960 --> 00:10:24,240
traffic<font color="#CCCCCC"> distribution system</font><font color="#E5E5E5"> and it's</font>

246
00:10:21,420 --> 00:10:27,329
commonly used<font color="#E5E5E5"> in ad networks and</font>

247
00:10:24,240 --> 00:10:28,950
advertising<font color="#E5E5E5"> and what we're seeing is is</font>

248
00:10:27,330 --> 00:10:32,880
that some<font color="#E5E5E5"> exploit authors are actually</font>

249
00:10:28,950 --> 00:10:35,070
<font color="#CCCCCC">using this</font><font color="#E5E5E5"> itself as far part of that</font>

250
00:10:32,880 --> 00:10:36,960
<font color="#E5E5E5">filtering function so if you start to</font>

251
00:10:35,070 --> 00:10:38,970
see you'll notice that<font color="#CCCCCC"> there's just a</font>

252
00:10:36,960 --> 00:10:41,700
<font color="#E5E5E5">crazy level of filtering that you can do</font>

253
00:10:38,970 --> 00:10:44,640
with this<font color="#E5E5E5"> you can pick your users based</font>

254
00:10:41,700 --> 00:10:47,040
on geographic region you can<font color="#CCCCCC"> base do you</font>

255
00:10:44,640 --> 00:10:49,110
want a mobile<font color="#E5E5E5"> or non mobile device what</font>

256
00:10:47,040 --> 00:10:51,120
<font color="#E5E5E5">operating system down</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> the version and</font>

257
00:10:49,110 --> 00:10:53,370
browser down to the version<font color="#CCCCCC"> you can pick</font>

258
00:10:51,120 --> 00:10:56,760
certain plugins<font color="#E5E5E5"> and extensions you can</font>

259
00:10:53,370 --> 00:10:59,040
<font color="#CCCCCC">literally drag and drop what detail you</font>

260
00:10:56,760 --> 00:11:01,260
want<font color="#E5E5E5"> to target</font><font color="#CCCCCC"> and when you do that you</font>

261
00:10:59,040 --> 00:11:03,930
set<font color="#CCCCCC"> up what's called the flow and these</font>

262
00:11:01,260 --> 00:11:06,150
flows say you know this user that

263
00:11:03,930 --> 00:11:08,790
matches this level of<font color="#E5E5E5"> filtering get</font>

264
00:11:06,150 --> 00:11:11,910
served up<font color="#E5E5E5"> this exploit this user who</font>

265
00:11:08,790 --> 00:11:13,980
<font color="#CCCCCC">who's maybe</font><font color="#E5E5E5"> a mobile user doesn't</font><font color="#CCCCCC"> get</font>

266
00:11:11,910 --> 00:11:15,900
served any exploit because<font color="#CCCCCC"> we don't</font><font color="#E5E5E5"> have</font>

267
00:11:13,980 --> 00:11:17,820
a mobile exploit and so they<font color="#E5E5E5"> used this</font>

268
00:11:15,900 --> 00:11:20,189
<font color="#E5E5E5">really heavy level of filtering through</font>

269
00:11:17,820 --> 00:11:21,480
all of<font color="#E5E5E5"> this and one of the things that</font>

270
00:11:20,190 --> 00:11:23,340
we were able<font color="#CCCCCC"> to do which</font><font color="#E5E5E5"> was were kind</font>

271
00:11:21,480 --> 00:11:25,770
of fun was we<font color="#CCCCCC"> were</font><font color="#E5E5E5"> actually able to get</font>

272
00:11:23,340 --> 00:11:27,810
access<font color="#CCCCCC"> to the web routes of a lot</font><font color="#E5E5E5"> of</font>

273
00:11:25,770 --> 00:11:29,310
these compromised<font color="#CCCCCC"> websites</font><font color="#E5E5E5"> and we</font>

274
00:11:27,810 --> 00:11:30,900
actually<font color="#E5E5E5"> started to look at them and see</font>

275
00:11:29,310 --> 00:11:33,180
<font color="#E5E5E5">all right</font><font color="#CCCCCC"> you know looking at</font><font color="#E5E5E5"> these web</font>

276
00:11:30,900 --> 00:11:35,010
routes what information<font color="#E5E5E5"> can we get and</font>

277
00:11:33,180 --> 00:11:36,900
so what you're<font color="#E5E5E5"> seeing</font><font color="#CCCCCC"> on the screen we</font>

278
00:11:35,010 --> 00:11:40,560
started out with<font color="#E5E5E5"> using something called</font>

279
00:11:36,900 --> 00:11:43,199
<font color="#CCCCCC">a</font><font color="#E5E5E5"> hashed which is just a free known good</font>

280
00:11:40,560 --> 00:11:45,119
service<font color="#CCCCCC"> you can give it a</font><font color="#E5E5E5"> list of</font>

281
00:11:43,200 --> 00:11:46,950
<font color="#CCCCCC">directories and it'll tell you our list</font>

282
00:11:45,120 --> 00:11:49,370
<font color="#E5E5E5">of files it'll tell you which files</font><font color="#CCCCCC"> are</font>

283
00:11:46,950 --> 00:11:52,020
known<font color="#E5E5E5"> goods so this is a wordpress</font>

284
00:11:49,370 --> 00:11:53,930
<font color="#E5E5E5">installation so</font><font color="#CCCCCC"> i'm just gonna quickly</font>

285
00:11:52,020 --> 00:11:57,180
remove out all of<font color="#E5E5E5"> the known good</font>

286
00:11:53,930 --> 00:12:00,300
<font color="#E5E5E5">wordpress sites and i'm left with a core</font>

287
00:11:57,180 --> 00:12:04,439
file<font color="#E5E5E5"> as part of</font><font color="#CCCCCC"> wordpress which is the</font>

288
00:12:00,300 --> 00:12:06,689
nav menu dot PHP<font color="#E5E5E5"> now</font><font color="#CCCCCC"> sudo Darkly is also</font>

289
00:12:04,440 --> 00:12:11,690
<font color="#CCCCCC">notorious for using this nav menu dot</font>

290
00:12:06,690 --> 00:12:14,310
PHP file to store their back-end<font color="#E5E5E5"> code</font>

291
00:12:11,690 --> 00:12:16,830
<font color="#CCCCCC">okay</font><font color="#E5E5E5"> so what they do is they</font><font color="#CCCCCC"> compromised</font>

292
00:12:14,310 --> 00:12:20,640
the<font color="#CCCCCC"> website they manually modify nav</font>

293
00:12:16,830 --> 00:12:22,620
menu<font color="#E5E5E5"> PHP to include their code this code</font>

294
00:12:20,640 --> 00:12:24,750
is the<font color="#CCCCCC"> code that fetches</font><font color="#E5E5E5"> that iframe</font>

295
00:12:22,620 --> 00:12:27,330
information and renders it<font color="#CCCCCC"> in</font><font color="#E5E5E5"> the</font>

296
00:12:24,750 --> 00:12:28,230
compromised website<font color="#E5E5E5"> but it does a bunch</font>

297
00:12:27,330 --> 00:12:30,180
of other things<font color="#CCCCCC"> so it's kind of</font>

298
00:12:28,230 --> 00:12:33,990
<font color="#CCCCCC">interesting to see</font><font color="#E5E5E5"> so first they don't</font>

299
00:12:30,180 --> 00:12:36,209
serve the iframe to every<font color="#E5E5E5"> single page</font>

300
00:12:33,990 --> 00:12:38,610
they<font color="#E5E5E5"> read they don't want to embed the</font>

301
00:12:36,210 --> 00:12:41,790
iframe<font color="#E5E5E5"> into images right they don't want</font>

302
00:12:38,610 --> 00:12:44,220
to embed the iframe into into just<font color="#E5E5E5"> any</font>

303
00:12:41,790 --> 00:12:46,530
page that<font color="#E5E5E5"> that</font><font color="#CCCCCC"> gets rendered they picked</font>

304
00:12:44,220 --> 00:12:48,480
<font color="#CCCCCC">only the</font><font color="#E5E5E5"> specific ones the other thing</font>

305
00:12:46,530 --> 00:12:52,680
is is<font color="#E5E5E5"> that built into</font><font color="#CCCCCC"> this injected code</font>

306
00:12:48,480 --> 00:12:55,800
is filters for Google's<font color="#E5E5E5"> IP addresses</font><font color="#CCCCCC"> so</font>

307
00:12:52,680 --> 00:12:58,589
<font color="#CCCCCC">they're actually</font><font color="#E5E5E5"> put in place whitelist</font>

308
00:12:55,800 --> 00:13:02,280
so that if it's if it's a<font color="#CCCCCC"> Google certain</font>

309
00:12:58,590 --> 00:13:04,740
<font color="#CCCCCC">google search engine like crawlers IP</font>

310
00:13:02,280 --> 00:13:07,230
addresses they'll won't serve the

311
00:13:04,740 --> 00:13:09,870
exploit<font color="#CCCCCC"> khador won't fetch that out</font><font color="#E5E5E5"> and</font>

312
00:13:07,230 --> 00:13:10,920
they then they<font color="#CCCCCC"> also the other weird</font>

313
00:13:09,870 --> 00:13:12,300
<font color="#E5E5E5">thing about this I don't know if you</font>

314
00:13:10,920 --> 00:13:15,060
guys<font color="#CCCCCC"> has</font><font color="#E5E5E5"> noticed this but there's</font>

315
00:13:12,300 --> 00:13:18,089
<font color="#CCCCCC">comments in this code which is kind of</font>

316
00:13:15,060 --> 00:13:19,739
weird<font color="#E5E5E5"> right because you think like you</font>

317
00:13:18,090 --> 00:13:22,740
know commented code<font color="#E5E5E5"> suggests</font>

318
00:13:19,740 --> 00:13:24,690
<font color="#E5E5E5">like you know something under</font>

319
00:13:22,740 --> 00:13:27,120
development<font color="#CCCCCC"> right this is this code is</font>

320
00:13:24,690 --> 00:13:28,830
found on<font color="#E5E5E5"> a compromised site so that</font>

321
00:13:27,120 --> 00:13:31,140
<font color="#E5E5E5">means that maybe they're either</font>

322
00:13:28,830 --> 00:13:33,240
deploying this commented<font color="#E5E5E5"> out code to all</font>

323
00:13:31,140 --> 00:13:35,250
of their<font color="#E5E5E5"> systems or they're manually</font>

324
00:13:33,240 --> 00:13:38,940
going<font color="#E5E5E5"> into this compromised website and</font>

325
00:13:35,250 --> 00:13:40,260
testing it live in production<font color="#E5E5E5"> testing</font>

326
00:13:38,940 --> 00:13:43,500
this<font color="#CCCCCC"> backdoored codes which is kind of</font>

327
00:13:40,260 --> 00:13:45,689
interesting<font color="#CCCCCC"> so the other thing that</font><font color="#E5E5E5"> they</font>

328
00:13:43,500 --> 00:13:47,580
do is you'll see in in that<font color="#E5E5E5"> and we'll</font>

329
00:13:45,690 --> 00:13:51,180
dive into<font color="#CCCCCC"> that in a little bit</font><font color="#E5E5E5"> is that</font>

330
00:13:47,580 --> 00:13:54,690
<font color="#CCCCCC">there also have a string a</font><font color="#E5E5E5"> base64</font>

331
00:13:51,180 --> 00:13:56,339
encoded string<font color="#E5E5E5"> that is actually what</font>

332
00:13:54,690 --> 00:13:58,400
<font color="#CCCCCC">that call is to the rig server and we'll</font>

333
00:13:56,340 --> 00:14:01,200
look at<font color="#E5E5E5"> that in just a minute</font>

334
00:13:58,400 --> 00:14:03,480
<font color="#CCCCCC">alright so the the other part</font><font color="#E5E5E5"> now is</font>

335
00:14:01,200 --> 00:14:05,400
<font color="#E5E5E5">actually getting the</font><font color="#CCCCCC"> exploit so they put</font>

336
00:14:03,480 --> 00:14:07,920
first they get the iframe content<font color="#E5E5E5"> and</font>

337
00:14:05,400 --> 00:14:09,810
now when<font color="#CCCCCC"> you render</font><font color="#E5E5E5"> that iframe the</font>

338
00:14:07,920 --> 00:14:11,910
victim renders that<font color="#E5E5E5"> iframe now they need</font>

339
00:14:09,810 --> 00:14:14,099
<font color="#E5E5E5">to actually be hit with they exploit so</font>

340
00:14:11,910 --> 00:14:17,250
this is sort of hard<font color="#CCCCCC"> for us</font><font color="#E5E5E5"> to see</font>

341
00:14:14,100 --> 00:14:18,990
<font color="#E5E5E5">because this is happening</font><font color="#CCCCCC"> you know</font><font color="#E5E5E5"> on</font>

342
00:14:17,250 --> 00:14:22,080
systems<font color="#E5E5E5"> that we don't control and we</font>

343
00:14:18,990 --> 00:14:24,240
don't have<font color="#E5E5E5"> good visibility into but from</font>

344
00:14:22,080 --> 00:14:26,490
what we<font color="#E5E5E5"> can tell it looks</font><font color="#CCCCCC"> like there's</font>

345
00:14:24,240 --> 00:14:28,710
another<font color="#CCCCCC"> system</font><font color="#E5E5E5"> called a VDS or a virtual</font>

346
00:14:26,490 --> 00:14:33,120
dedicated<font color="#E5E5E5"> server that actually holds</font><font color="#CCCCCC"> the</font>

347
00:14:28,710 --> 00:14:36,360
exploits<font color="#E5E5E5"> and that that domain that</font>

348
00:14:33,120 --> 00:14:39,510
actually include that that was in the

349
00:14:36,360 --> 00:14:41,280
iframe fetches back to from<font color="#E5E5E5"> this</font><font color="#CCCCCC"> virtual</font>

350
00:14:39,510 --> 00:14:45,390
dedicated<font color="#E5E5E5"> server to pull the exploit and</font>

351
00:14:41,280 --> 00:14:47,910
then render<font color="#CCCCCC"> it when you actually</font><font color="#E5E5E5"> get the</font>

352
00:14:45,390 --> 00:14:49,890
exploit<font color="#E5E5E5"> the exploit is is a really</font><font color="#CCCCCC"> an</font>

353
00:14:47,910 --> 00:14:52,560
exploit bundle<font color="#E5E5E5"> you get three different</font>

354
00:14:49,890 --> 00:14:54,689
<font color="#E5E5E5">heavily obfuscated exploits it loads off</font>

355
00:14:52,560 --> 00:14:56,880
all three<font color="#CCCCCC"> of them at least</font><font color="#E5E5E5"> for this this</font>

356
00:14:54,690 --> 00:14:58,350
<font color="#CCCCCC">particular case it'll launch all three</font>

357
00:14:56,880 --> 00:15:00,750
exploits against your browser<font color="#CCCCCC"> in your</font>

358
00:14:58,350 --> 00:15:03,870
plugins<font color="#E5E5E5"> and the exploits themselves</font>

359
00:15:00,750 --> 00:15:06,180
<font color="#E5E5E5">aren't anything amazing so you know a</font>

360
00:15:03,870 --> 00:15:08,400
<font color="#E5E5E5">few years back</font><font color="#CCCCCC"> angler exploit kit was</font>

361
00:15:06,180 --> 00:15:10,530
the<font color="#E5E5E5"> most popular those guys really</font>

362
00:15:08,400 --> 00:15:12,360
<font color="#E5E5E5">innovative well they were doing lots of</font>

363
00:15:10,530 --> 00:15:14,880
really<font color="#E5E5E5"> cool</font><font color="#CCCCCC"> interesting things</font><font color="#E5E5E5"> ever</font>

364
00:15:12,360 --> 00:15:16,620
since<font color="#CCCCCC"> then</font><font color="#E5E5E5"> we haven't seen a lot of</font>

365
00:15:14,880 --> 00:15:18,630
<font color="#E5E5E5">really strong innovation and the exploit</font>

366
00:15:16,620 --> 00:15:20,640
kits<font color="#E5E5E5"> what they do and one</font><font color="#CCCCCC"> of my</font>

367
00:15:18,630 --> 00:15:24,090
innovation<font color="#CCCCCC"> what I mean is is writing</font>

368
00:15:20,640 --> 00:15:26,160
their own exploits or coming<font color="#E5E5E5"> up</font><font color="#CCCCCC"> with you</font>

369
00:15:24,090 --> 00:15:28,710
<font color="#E5E5E5">know unpublished exploits or</font><font color="#CCCCCC"> anything</font>

370
00:15:26,160 --> 00:15:31,020
<font color="#E5E5E5">like that so what they do is they're</font>

371
00:15:28,710 --> 00:15:33,150
<font color="#E5E5E5">using old you know security</font><font color="#CCCCCC"> researcher</font>

372
00:15:31,020 --> 00:15:33,449
finds<font color="#E5E5E5"> an exploit they write up a proof</font>

373
00:15:33,150 --> 00:15:35,519
of

374
00:15:33,449 --> 00:15:37,889
<font color="#CCCCCC">except publish it to a blog and then</font>

375
00:15:35,519 --> 00:15:40,290
within<font color="#E5E5E5"> a week</font><font color="#CCCCCC"> an exploited author takes</font>

376
00:15:37,889 --> 00:15:42,299
that sort of<font color="#E5E5E5"> weaponize it and loads it</font>

377
00:15:40,290 --> 00:15:44,998
into exploit kit and and serves<font color="#E5E5E5"> whoever</font>

378
00:15:42,299 --> 00:15:46,319
there's<font color="#CCCCCC"> thereby the funny thing is is</font>

379
00:15:44,999 --> 00:15:48,989
that you can<font color="#E5E5E5"> sort of see some of the</font>

380
00:15:46,319 --> 00:15:50,429
lack of<font color="#CCCCCC"> innovation in a way by the</font><font color="#E5E5E5"> way</font>

381
00:15:48,989 --> 00:15:52,889
that they're dealing with<font color="#E5E5E5"> these exploits</font>

382
00:15:50,429 --> 00:15:55,230
so sometimes when they<font color="#E5E5E5"> have a browser</font>

383
00:15:52,889 --> 00:15:57,809
<font color="#CCCCCC">that they can't actually exploit they'll</font>

384
00:15:55,230 --> 00:16:00,829
do sort of lame things in the exploit

385
00:15:57,809 --> 00:16:04,529
world right they show<font color="#E5E5E5"> these sort of fake</font>

386
00:16:00,829 --> 00:16:05,699
<font color="#E5E5E5">font pop-ups which which try to convince</font>

387
00:16:04,529 --> 00:16:08,939
you to click a link<font color="#CCCCCC"> and download</font>

388
00:16:05,699 --> 00:16:11,459
something like to me<font color="#CCCCCC"> this is super lame</font>

389
00:16:08,939 --> 00:16:12,779
<font color="#E5E5E5">like these guys are exploited authors</font>

390
00:16:11,459 --> 00:16:14,878
<font color="#E5E5E5">right like they should be dealing with</font>

391
00:16:12,779 --> 00:16:17,399
<font color="#E5E5E5">memory corruption vulnerabilities right</font>

392
00:16:14,879 --> 00:16:19,949
<font color="#E5E5E5">bypassing exploit mitigations doing some</font>

393
00:16:17,399 --> 00:16:22,529
hardcore stuff<font color="#E5E5E5"> and the resulting to this</font>

394
00:16:19,949 --> 00:16:24,868
fake font download<font color="#E5E5E5"> this is this just to</font>

395
00:16:22,529 --> 00:16:27,059
me like is an<font color="#CCCCCC"> uppercut mortal combat</font>

396
00:16:24,869 --> 00:16:30,480
finisher like they're really<font color="#E5E5E5"> not</font><font color="#CCCCCC"> doing</font>

397
00:16:27,059 --> 00:16:32,219
amazing so there's obviously a ton of

398
00:16:30,480 --> 00:16:33,629
stuff<font color="#CCCCCC"> going on in with exploit kits but</font>

399
00:16:32,220 --> 00:16:35,279
<font color="#E5E5E5">the weird thing about all of this</font>

400
00:16:33,629 --> 00:16:38,519
there's so much<font color="#E5E5E5"> activity happening with</font>

401
00:16:35,279 --> 00:16:40,619
exploit kits<font color="#CCCCCC"> that I thought it was weird</font>

402
00:16:38,519 --> 00:16:43,079
<font color="#E5E5E5">that there wasn't like a website</font><font color="#CCCCCC"> to</font>

403
00:16:40,619 --> 00:16:44,549
track all<font color="#CCCCCC"> of these so</font><font color="#E5E5E5"> what I did was I</font>

404
00:16:43,079 --> 00:16:46,949
reached<font color="#E5E5E5"> out to some of the popular</font>

405
00:16:44,549 --> 00:16:48,329
exploit kit researchers and talked<font color="#E5E5E5"> to</font>

406
00:16:46,949 --> 00:16:51,118
them a bit<font color="#CCCCCC"> and</font><font color="#E5E5E5"> asked them if</font><font color="#CCCCCC"> they would</font>

407
00:16:48,329 --> 00:16:54,449
contribute and built a<font color="#CCCCCC"> website called ek</font>

408
00:16:51,119 --> 00:16:57,480
tracker<font color="#CCCCCC"> com and so now you</font><font color="#E5E5E5"> all can go to</font>

409
00:16:54,449 --> 00:16:59,368
ek tracker<font color="#CCCCCC"> comm and for free have</font><font color="#E5E5E5"> a list</font>

410
00:16:57,480 --> 00:17:00,539
of brand new exploit kits that<font color="#E5E5E5"> are</font>

411
00:16:59,369 --> 00:17:03,239
detected

412
00:17:00,539 --> 00:17:05,579
you know minute by minute<font color="#CCCCCC"> by exploit kit</font>

413
00:17:03,239 --> 00:17:08,100
researchers the other cool thing<font color="#CCCCCC"> about</font>

414
00:17:05,579 --> 00:17:10,529
<font color="#CCCCCC">that is now we</font><font color="#E5E5E5"> have a public data set of</font>

415
00:17:08,099 --> 00:17:12,750
exploit kit stuff<font color="#E5E5E5"> that we can play with</font>

416
00:17:10,529 --> 00:17:14,849
<font color="#E5E5E5">and look at so</font><font color="#CCCCCC"> this is a visualization I</font>

417
00:17:12,750 --> 00:17:17,490
did with the data off of<font color="#E5E5E5"> exploit ek</font>

418
00:17:14,849 --> 00:17:20,339
tracker<font color="#CCCCCC"> comm and</font><font color="#E5E5E5"> we did a really simple</font>

419
00:17:17,490 --> 00:17:25,169
<font color="#CCCCCC">visualization</font><font color="#E5E5E5"> we looked at the</font>

420
00:17:20,339 --> 00:17:27,119
relationships for IPS to<font color="#CCCCCC"> asns so which</font>

421
00:17:25,169 --> 00:17:29,370
<font color="#E5E5E5">you know from all of these different IPS</font>

422
00:17:27,119 --> 00:17:31,918
<font color="#CCCCCC">that were known exploit kits you know</font>

423
00:17:29,370 --> 00:17:33,989
what<font color="#CCCCCC"> a SNS do they map to</font><font color="#E5E5E5"> and you can</font>

424
00:17:31,919 --> 00:17:36,120
see one really<font color="#E5E5E5"> I mean look at that</font>

425
00:17:33,990 --> 00:17:38,490
<font color="#CCCCCC">that's a crazy mapping all those IPS to</font>

426
00:17:36,120 --> 00:17:39,570
just that single<font color="#CCCCCC"> ASN so that was really</font>

427
00:17:38,490 --> 00:17:41,279
sort<font color="#E5E5E5"> of an interesting piece of</font>

428
00:17:39,570 --> 00:17:43,049
<font color="#E5E5E5">information and we did the same</font><font color="#CCCCCC"> thing</font>

429
00:17:41,279 --> 00:17:45,629
<font color="#CCCCCC">two domains</font><font color="#E5E5E5"> and registrants so we were</font>

430
00:17:43,049 --> 00:17:46,520
able<font color="#E5E5E5"> to see you know how many domains</font>

431
00:17:45,629 --> 00:17:48,169
<font color="#E5E5E5">and were there</font>

432
00:17:46,520 --> 00:17:49,550
offending registrants<font color="#E5E5E5"> and you can see at</font>

433
00:17:48,170 --> 00:17:52,370
the<font color="#E5E5E5"> center there we have a single</font>

434
00:17:49,550 --> 00:17:53,840
registrant associated with a whole huge

435
00:17:52,370 --> 00:17:55,550
cluster of different<font color="#CCCCCC"> domains that are</font>

436
00:17:53,840 --> 00:17:58,280
<font color="#E5E5E5">associated so that's a really good</font><font color="#CCCCCC"> use</font>

437
00:17:55,550 --> 00:17:59,990
case for<font color="#CCCCCC"> ek tracker just</font><font color="#E5E5E5"> getting it all</font>

438
00:17:58,280 --> 00:18:04,100
out<font color="#E5E5E5"> there so I hopefully you guys will</font>

439
00:17:59,990 --> 00:18:07,880
<font color="#E5E5E5">use it and and find value in it</font><font color="#CCCCCC"> alright</font>

440
00:18:04,100 --> 00:18:10,760
<font color="#CCCCCC">your mat your it alright</font><font color="#E5E5E5"> so how do we</font>

441
00:18:07,880 --> 00:18:12,350
detect exploit kits<font color="#CCCCCC"> the first</font><font color="#E5E5E5"> method</font>

442
00:18:10,760 --> 00:18:13,670
will look at is probably<font color="#CCCCCC"> the</font><font color="#E5E5E5"> most common</font>

443
00:18:12,350 --> 00:18:16,909
approach and it's the approach<font color="#CCCCCC"> that we</font>

444
00:18:13,670 --> 00:18:19,040
took first and<font color="#E5E5E5"> that's to build a scraper</font>

445
00:18:16,910 --> 00:18:21,020
<font color="#CCCCCC">we focused on identifying</font><font color="#E5E5E5"> the exploit</font>

446
00:18:19,040 --> 00:18:23,710
<font color="#CCCCCC">Kate Landers because we</font><font color="#E5E5E5"> already had a</font>

447
00:18:21,020 --> 00:18:26,840
good corpus of known<font color="#CCCCCC"> compromise sites</font>

448
00:18:23,710 --> 00:18:28,670
<font color="#CCCCCC">sort</font><font color="#E5E5E5"> of compiled and we actually had two</font>

449
00:18:26,840 --> 00:18:30,199
<font color="#E5E5E5">versions of our scraper and with those</font>

450
00:18:28,670 --> 00:18:34,160
<font color="#CCCCCC">two separate proxy networks so we'll</font>

451
00:18:30,200 --> 00:18:36,710
break each of those down<font color="#CCCCCC"> individually so</font>

452
00:18:34,160 --> 00:18:40,670
the first<font color="#E5E5E5"> version of our scraper was</font>

453
00:18:36,710 --> 00:18:42,590
built using<font color="#CCCCCC"> VirtualBox and vagrant was</font>

454
00:18:40,670 --> 00:18:44,900
used for sort of starting and<font color="#CCCCCC"> stopping</font>

455
00:18:42,590 --> 00:18:47,510
the virtual machines as well<font color="#E5E5E5"> as snapshot</font>

456
00:18:44,900 --> 00:18:49,130
management<font color="#E5E5E5"> the host OS was also</font>

457
00:18:47,510 --> 00:18:52,970
responsible for hosting the multi

458
00:18:49,130 --> 00:18:57,410
<font color="#E5E5E5">processing queue that</font><font color="#CCCCCC"> the workers fed</font>

459
00:18:52,970 --> 00:19:02,000
from so here's<font color="#E5E5E5"> just a</font><font color="#CCCCCC"> brief look at one</font>

460
00:18:57,410 --> 00:19:03,620
<font color="#CCCCCC">of the worker processes</font><font color="#E5E5E5"> so you'll notice</font>

461
00:19:02,000 --> 00:19:06,290
<font color="#CCCCCC">that we're making</font><font color="#E5E5E5"> two requests for a</font>

462
00:19:03,620 --> 00:19:07,909
<font color="#E5E5E5">compromise site one with</font><font color="#CCCCCC"> Internet</font>

463
00:19:06,290 --> 00:19:10,490
<font color="#CCCCCC">Explorer through selenium and one with</font>

464
00:19:07,910 --> 00:19:14,780
<font color="#CCCCCC">Python</font><font color="#E5E5E5"> request and this lets us take a</font>

465
00:19:10,490 --> 00:19:16,880
diff of the<font color="#CCCCCC"> rendered Dom versus the page</font>

466
00:19:14,780 --> 00:19:19,280
<font color="#E5E5E5">source that was given to us so</font><font color="#CCCCCC"> this</font>

467
00:19:16,880 --> 00:19:21,140
allows<font color="#CCCCCC"> us to</font><font color="#E5E5E5"> identify any iframes and</font>

468
00:19:19,280 --> 00:19:27,040
<font color="#E5E5E5">beds params or other includes that</font>

469
00:19:21,140 --> 00:19:29,570
occurred<font color="#E5E5E5"> post JavaScript execution and</font>

470
00:19:27,040 --> 00:19:30,740
this diff gives us a candidate list but

471
00:19:29,570 --> 00:19:32,929
we still need<font color="#CCCCCC"> to weed out some false</font>

472
00:19:30,740 --> 00:19:34,910
<font color="#CCCCCC">positives so</font><font color="#E5E5E5"> we run it</font><font color="#CCCCCC"> through a couple</font>

473
00:19:32,930 --> 00:19:37,040
<font color="#E5E5E5">of filters</font><font color="#CCCCCC"> we're really lucky in the</font>

474
00:19:34,910 --> 00:19:39,920
sense<font color="#CCCCCC"> that we have</font><font color="#E5E5E5"> access</font><font color="#CCCCCC"> to a</font>

475
00:19:37,040 --> 00:19:42,020
popularity<font color="#E5E5E5"> score in our product so it</font>

476
00:19:39,920 --> 00:19:44,570
works<font color="#E5E5E5"> pretty similar to Google's popular</font>

477
00:19:42,020 --> 00:19:45,830
PageRank algorithm<font color="#CCCCCC"> another one</font><font color="#E5E5E5"> of the</font>

478
00:19:44,570 --> 00:19:48,409
interesting things that<font color="#E5E5E5"> we can look at</font>

479
00:19:45,830 --> 00:19:51,169
for<font color="#CCCCCC"> filtering</font><font color="#E5E5E5"> is the DNS query</font><font color="#CCCCCC"> volume</font>

480
00:19:48,410 --> 00:19:53,360
that these domains receive so for

481
00:19:51,170 --> 00:19:55,220
something<font color="#CCCCCC"> like google.com you'll see a</font>

482
00:19:53,360 --> 00:19:57,830
<font color="#E5E5E5">huge amount of volume over a large</font>

483
00:19:55,220 --> 00:19:59,740
period of time and it's<font color="#CCCCCC"> very periodic</font><font color="#E5E5E5"> in</font>

484
00:19:57,830 --> 00:20:02,050
its graph<font color="#E5E5E5"> with some</font>

485
00:19:59,740 --> 00:20:04,720
like an exploit<font color="#CCCCCC"> Kate</font><font color="#E5E5E5"> Lander you'll see a</font>

486
00:20:02,050 --> 00:20:10,389
dramatic<font color="#CCCCCC"> spike preceded typically by</font>

487
00:20:04,720 --> 00:20:12,100
either<font color="#E5E5E5"> 0</font><font color="#CCCCCC"> or no queries</font><font color="#E5E5E5"> before</font><font color="#CCCCCC"> it so</font>

488
00:20:10,390 --> 00:20:14,410
that's how the<font color="#E5E5E5"> first version of the</font>

489
00:20:12,100 --> 00:20:16,419
scraper worked<font color="#E5E5E5"> but we're still missing a</font>

490
00:20:14,410 --> 00:20:18,790
key detail<font color="#E5E5E5"> which</font><font color="#CCCCCC"> is how we actually got</font>

491
00:20:16,420 --> 00:20:20,800
around the IP filtering<font color="#E5E5E5"> that they do</font>

492
00:20:18,790 --> 00:20:23,230
<font color="#E5E5E5">typically they have some filter in</font><font color="#CCCCCC"> place</font>

493
00:20:20,800 --> 00:20:27,340
to make<font color="#CCCCCC"> sure</font><font color="#E5E5E5"> that you're coming from</font><font color="#CCCCCC"> a</font>

494
00:20:23,230 --> 00:20:29,380
non corporate<font color="#E5E5E5"> IP or to make sure</font><font color="#CCCCCC"> they</font>

495
00:20:27,340 --> 00:20:30,490
haven't served you and exploit within

496
00:20:29,380 --> 00:20:32,770
the last 24<font color="#CCCCCC"> hours</font>

497
00:20:30,490 --> 00:20:35,080
and to do this we build out a proxy

498
00:20:32,770 --> 00:20:36,730
<font color="#E5E5E5">network the first first version of the</font>

499
00:20:35,080 --> 00:20:40,480
proxy<font color="#CCCCCC"> network looked a little something</font>

500
00:20:36,730 --> 00:20:43,090
<font color="#CCCCCC">like</font><font color="#E5E5E5"> this yeah there you go</font><font color="#CCCCCC"> we just</font>

501
00:20:40,480 --> 00:20:44,320
<font color="#CCCCCC">scraped a bunch of public proxy lists</font>

502
00:20:43,090 --> 00:20:48,040
<font color="#E5E5E5">and this actually worked surprisingly</font>

503
00:20:44,320 --> 00:20:49,689
well<font color="#E5E5E5"> for</font><font color="#CCCCCC"> a couple months at least</font><font color="#E5E5E5"> until</font>

504
00:20:48,040 --> 00:20:53,260
every<font color="#CCCCCC"> single one of the</font><font color="#E5E5E5"> proxy lists that</font>

505
00:20:49,690 --> 00:20:55,809
we were using got blacklisted<font color="#CCCCCC"> so we</font>

506
00:20:53,260 --> 00:20:57,879
started<font color="#E5E5E5"> working on version</font><font color="#CCCCCC"> to you</font><font color="#E5E5E5"> and by</font>

507
00:20:55,809 --> 00:21:00,700
this point the<font color="#E5E5E5"> most advanced exploit</font><font color="#CCCCCC"> kit</font>

508
00:20:57,880 --> 00:21:02,350
angler had shut down<font color="#E5E5E5"> and the ones that</font>

509
00:21:00,700 --> 00:21:04,540
had taken<font color="#CCCCCC"> his place</font><font color="#E5E5E5"> really weren't</font><font color="#CCCCCC"> doing</font>

510
00:21:02,350 --> 00:21:07,059
the same level of browser<font color="#CCCCCC"> scrutinize</font>

511
00:21:04,540 --> 00:21:08,139
ation that angler had been doing<font color="#CCCCCC"> so this</font>

512
00:21:07,059 --> 00:21:09,910
allowed us<font color="#E5E5E5"> to make a much lighter</font>

513
00:21:08,140 --> 00:21:11,710
version<font color="#E5E5E5"> of our scraper</font><font color="#CCCCCC"> so we didn't have</font>

514
00:21:09,910 --> 00:21:14,350
<font color="#E5E5E5">to use virtual machines anymore and no</font>

515
00:21:11,710 --> 00:21:16,809
pie<font color="#E5E5E5"> shark for saving the samples and no</font>

516
00:21:14,350 --> 00:21:20,159
dipping so now we<font color="#CCCCCC"> just</font><font color="#E5E5E5"> have a browser</font>

517
00:21:16,809 --> 00:21:23,530
component made entirely using Python

518
00:21:20,160 --> 00:21:25,809
requests and we fetch<font color="#E5E5E5"> the page</font><font color="#CCCCCC"> passed</font>

519
00:21:23,530 --> 00:21:28,570
<font color="#E5E5E5">the response to a detector</font><font color="#CCCCCC"> which just</font>

520
00:21:25,809 --> 00:21:30,250
does some very<font color="#E5E5E5"> basic signature matching</font>

521
00:21:28,570 --> 00:21:32,230
over the response to identify any

522
00:21:30,250 --> 00:21:34,450
exploit<font color="#E5E5E5"> Landers</font><font color="#CCCCCC"> and take a guess at its</font>

523
00:21:32,230 --> 00:21:37,000
campaign and then these<font color="#CCCCCC"> Lander</font>

524
00:21:34,450 --> 00:21:40,720
candidates are then queried and passed

525
00:21:37,000 --> 00:21:42,490
to a decoder module so the decoder

526
00:21:40,720 --> 00:21:44,800
module just<font color="#E5E5E5"> takes the response from</font>

527
00:21:42,490 --> 00:21:47,170
<font color="#E5E5E5">these exploit</font><font color="#CCCCCC"> gate Landers</font><font color="#E5E5E5"> and does its</font>

528
00:21:44,800 --> 00:21:49,120
best to sort of it runs it through a

529
00:21:47,170 --> 00:21:50,410
JavaScript parser first and then does

530
00:21:49,120 --> 00:21:52,090
its best to<font color="#E5E5E5"> take a guess</font><font color="#CCCCCC"> that the</font>

531
00:21:50,410 --> 00:21:57,880
exploit kit that it's looking at and

532
00:21:52,090 --> 00:21:59,709
from<font color="#E5E5E5"> there</font><font color="#CCCCCC"> it'll</font><font color="#E5E5E5"> try to extract any for</font>

533
00:21:57,880 --> 00:22:03,640
example<font color="#CCCCCC"> flash exploits executables or</font>

534
00:21:59,710 --> 00:22:04,960
anything<font color="#E5E5E5"> any other artifacts the second</font>

535
00:22:03,640 --> 00:22:06,460
version of approximate work we actually

536
00:22:04,960 --> 00:22:09,309
<font color="#CCCCCC">built out ourselves</font>

537
00:22:06,460 --> 00:22:12,340
we hosted<font color="#CCCCCC"> it</font><font color="#E5E5E5"> across a bunch of</font><font color="#CCCCCC"> hourly</font>

538
00:22:09,309 --> 00:22:14,590
<font color="#E5E5E5">VPS providers using squid proxy</font>

539
00:22:12,340 --> 00:22:17,470
and this gives us<font color="#E5E5E5"> a lot</font><font color="#CCCCCC"> of flexibility</font>

540
00:22:14,590 --> 00:22:20,439
in<font color="#CCCCCC"> the choice of region for</font><font color="#E5E5E5"> our exit IP</font>

541
00:22:17,470 --> 00:22:22,480
<font color="#CCCCCC">so if certain exploits exploit kits are</font>

542
00:22:20,440 --> 00:22:23,770
only<font color="#E5E5E5"> targeting certain regions we can</font>

543
00:22:22,480 --> 00:22:25,870
choose to be coming<font color="#E5E5E5"> from there</font><font color="#CCCCCC"> and it</font>

544
00:22:23,770 --> 00:22:30,250
also gives us rotating<font color="#E5E5E5"> IPS every hour or</font>

545
00:22:25,870 --> 00:22:33,039
two hours<font color="#E5E5E5"> and so naturally the</font><font color="#CCCCCC"> question</font>

546
00:22:30,250 --> 00:22:35,260
becomes well<font color="#CCCCCC"> what do you scrape so some</font>

547
00:22:33,039 --> 00:22:38,500
<font color="#E5E5E5">great resources are on the left</font><font color="#CCCCCC"> hand</font>

548
00:22:35,260 --> 00:22:41,289
<font color="#E5E5E5">side those are</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> researcher blogs and</font>

549
00:22:38,500 --> 00:22:44,770
<font color="#CCCCCC">ek tracker calm</font><font color="#E5E5E5"> Twitter is also a great</font>

550
00:22:41,289 --> 00:22:47,890
<font color="#CCCCCC">resource for intelligence sharing</font><font color="#E5E5E5"> so for</font>

551
00:22:44,770 --> 00:22:49,809
example if you were to<font color="#E5E5E5"> sit on the rig</font><font color="#CCCCCC"> EK</font>

552
00:22:47,890 --> 00:22:51,610
hashtag<font color="#E5E5E5"> there's just a ton of</font>

553
00:22:49,809 --> 00:22:52,899
information<font color="#CCCCCC"> that you can that you can</font>

554
00:22:51,610 --> 00:22:54,820
harvest<font color="#E5E5E5"> from there from other</font>

555
00:22:52,899 --> 00:22:57,610
researchers public open source

556
00:22:54,820 --> 00:23:00,658
<font color="#E5E5E5">intelligence and the last idea actually</font>

557
00:22:57,610 --> 00:23:03,699
<font color="#E5E5E5">comes from a Twitter researcher now</font><font color="#CCCCCC"> SEC</font>

558
00:23:00,659 --> 00:23:05,289
typically when we<font color="#CCCCCC"> think</font><font color="#E5E5E5"> of the Alexa</font>

559
00:23:03,700 --> 00:23:08,049
<font color="#CCCCCC">one-million we think of the these sites</font>

560
00:23:05,289 --> 00:23:10,658
as sort of<font color="#E5E5E5"> reputable or sites that</font><font color="#CCCCCC"> we</font>

561
00:23:08,049 --> 00:23:12,668
<font color="#E5E5E5">can trust but he actually</font><font color="#CCCCCC"> found that a</font>

562
00:23:10,659 --> 00:23:15,490
lot<font color="#CCCCCC"> of a lot of the sites in</font><font color="#E5E5E5"> the Alexa</font>

563
00:23:12,669 --> 00:23:17,140
<font color="#CCCCCC">one-million are compromised and we're</font>

564
00:23:15,490 --> 00:23:19,059
<font color="#CCCCCC">serving</font><font color="#E5E5E5"> exploit gates at one point so</font>

565
00:23:17,140 --> 00:23:24,340
the Alexa<font color="#CCCCCC"> one-million or we also have</font>

566
00:23:19,059 --> 00:23:26,980
the<font color="#E5E5E5"> Cisco umbrella</font><font color="#CCCCCC"> one-million alright</font>

567
00:23:24,340 --> 00:23:29,470
great<font color="#CCCCCC"> so we now</font><font color="#E5E5E5"> have a bunch of exploit</font>

568
00:23:26,980 --> 00:23:31,720
<font color="#CCCCCC">lenders but</font><font color="#E5E5E5"> Brad and I wanted to</font><font color="#CCCCCC"> do more</font>

569
00:23:29,470 --> 00:23:32,890
with<font color="#E5E5E5"> this we wanted</font><font color="#CCCCCC"> to amplify the</font>

570
00:23:31,720 --> 00:23:34,390
convictions that<font color="#E5E5E5"> we were getting with</font>

571
00:23:32,890 --> 00:23:39,070
our scrapers so we built out<font color="#E5E5E5"> this system</font>

572
00:23:34,390 --> 00:23:41,830
<font color="#E5E5E5">called</font><font color="#CCCCCC"> hitless</font><font color="#E5E5E5"> to do that and so when a</font>

573
00:23:39,070 --> 00:23:44,139
<font color="#CCCCCC">customer using our product visits a site</font>

574
00:23:41,830 --> 00:23:45,908
<font color="#CCCCCC">that's blocked instead of</font><font color="#E5E5E5"> returning the</font>

575
00:23:44,140 --> 00:23:48,870
IP<font color="#E5E5E5"> for that site we actually return</font><font color="#CCCCCC"> the</font>

576
00:23:45,909 --> 00:23:54,370
IP for one of our<font color="#CCCCCC"> blocked page Landers</font>

577
00:23:48,870 --> 00:23:57,219
<font color="#E5E5E5">and so every time someone hits one</font><font color="#CCCCCC"> of</font>

578
00:23:54,370 --> 00:23:59,039
the<font color="#E5E5E5"> block page lenders we tried to store</font>

579
00:23:57,220 --> 00:24:01,809
the session<font color="#CCCCCC"> information in our logs and</font>

580
00:23:59,039 --> 00:24:03,600
that way when someone<font color="#CCCCCC"> visits one of the</font>

581
00:24:01,809 --> 00:24:05,950
exploit<font color="#E5E5E5"> lenders</font><font color="#CCCCCC"> that we've identified</font>

582
00:24:03,600 --> 00:24:09,610
<font color="#CCCCCC">we're able</font><font color="#E5E5E5"> to look at the refer</font>

583
00:24:05,950 --> 00:24:15,279
information which could<font color="#E5E5E5"> potentially be a</font>

584
00:24:09,610 --> 00:24:18,309
compromised site<font color="#CCCCCC"> all right so the block</font>

585
00:24:15,279 --> 00:24:20,440
page<font color="#E5E5E5"> logs are started in in s3 buckets</font>

586
00:24:18,309 --> 00:24:22,480
<font color="#E5E5E5">and currently we have hit list running</font>

587
00:24:20,440 --> 00:24:23,860
using<font color="#E5E5E5"> a custom stream processing</font>

588
00:24:22,480 --> 00:24:26,260
<font color="#E5E5E5">framework that we've created</font><font color="#CCCCCC"> called</font>

589
00:24:23,860 --> 00:24:28,080
<font color="#CCCCCC">avalanche but we also</font><font color="#E5E5E5"> feel</font><font color="#CCCCCC"> that</font>

590
00:24:26,260 --> 00:24:31,000
could be the perfect<font color="#CCCCCC"> use case for a</font>

591
00:24:28,080 --> 00:24:34,600
<font color="#CCCCCC">serverless architect architecture so</font>

592
00:24:31,000 --> 00:24:36,880
something like AWS is<font color="#CCCCCC"> lando lambda</font><font color="#E5E5E5"> so we</font>

593
00:24:34,600 --> 00:24:39,459
could push the results from the scraper

594
00:24:36,880 --> 00:24:41,230
into another s3 bucket<font color="#E5E5E5"> and feed these</font>

595
00:24:39,460 --> 00:24:43,600
along<font color="#CCCCCC"> with</font><font color="#E5E5E5"> the block page logs into</font><font color="#CCCCCC"> a</font>

596
00:24:41,230 --> 00:24:46,750
lambda function<font color="#CCCCCC"> to produce compromise</font>

597
00:24:43,600 --> 00:24:48,370
<font color="#CCCCCC">sight candidates these lambda</font><font color="#E5E5E5"> the lambda</font>

598
00:24:46,750 --> 00:24:51,460
function could<font color="#CCCCCC"> be something super simple</font>

599
00:24:48,370 --> 00:24:55,419
<font color="#E5E5E5">and we could just check to see</font><font color="#CCCCCC"> if</font><font color="#E5E5E5"> the</font>

600
00:24:51,460 --> 00:24:57,340
host is<font color="#CCCCCC"> in our</font><font color="#E5E5E5"> ek</font><font color="#CCCCCC"> Lander list</font><font color="#E5E5E5"> this</font>

601
00:24:55,420 --> 00:25:00,130
creates this really<font color="#CCCCCC"> nice ecosystem where</font>

602
00:24:57,340 --> 00:25:03,129
<font color="#CCCCCC">hit-list finds</font><font color="#E5E5E5"> new compromise sites</font><font color="#CCCCCC"> and</font>

603
00:25:00,130 --> 00:25:05,260
the scraper can confirm the hitless

604
00:25:03,130 --> 00:25:08,140
detections<font color="#CCCCCC"> as well as provide new</font>

605
00:25:05,260 --> 00:25:12,430
exploit<font color="#E5E5E5"> Landers for hit list</font><font color="#CCCCCC"> to work</font>

606
00:25:08,140 --> 00:25:15,280
with and so<font color="#CCCCCC"> it's 2017 we have to justify</font>

607
00:25:12,430 --> 00:25:18,640
<font color="#CCCCCC">our work through data visualization</font><font color="#E5E5E5"> so</font>

608
00:25:15,280 --> 00:25:22,360
we built this graph<font color="#CCCCCC"> over the first less</font>

609
00:25:18,640 --> 00:25:24,190
than a month of of hit list data so you

610
00:25:22,360 --> 00:25:28,090
<font color="#E5E5E5">can really see the</font><font color="#CCCCCC"> amplification that we</font>

611
00:25:24,190 --> 00:25:29,890
that we<font color="#E5E5E5"> get in this graph the you'll see</font>

612
00:25:28,090 --> 00:25:31,720
a bunch of clusters<font color="#E5E5E5"> and at the center of</font>

613
00:25:29,890 --> 00:25:33,460
<font color="#E5E5E5">these clusters</font><font color="#CCCCCC"> are the</font><font color="#E5E5E5"> exploit Kate</font>

614
00:25:31,720 --> 00:25:36,700
Landers and<font color="#E5E5E5"> all of the nodes connecting</font>

615
00:25:33,460 --> 00:25:39,760
to the to the<font color="#CCCCCC"> center</font><font color="#E5E5E5"> are other or are</font>

616
00:25:36,700 --> 00:25:42,010
<font color="#E5E5E5">compromised sites that hit list found so</font>

617
00:25:39,760 --> 00:25:44,500
in some<font color="#CCCCCC"> cases you'll even see like there</font>

618
00:25:42,010 --> 00:25:46,950
are<font color="#CCCCCC"> 20-plus compromised sites connecting</font>

619
00:25:44,500 --> 00:25:49,090
to a single exploit<font color="#CCCCCC"> Kate Lander and</font>

620
00:25:46,950 --> 00:25:52,270
these exploit<font color="#E5E5E5"> kick campaigns are</font>

621
00:25:49,090 --> 00:25:53,709
operating at a scale of thousands or

622
00:25:52,270 --> 00:25:55,960
tens<font color="#E5E5E5"> of thousands of compromised sites</font>

623
00:25:53,710 --> 00:26:01,270
as you<font color="#CCCCCC"> can see just</font><font color="#E5E5E5"> from</font><font color="#CCCCCC"> how large the</font>

624
00:25:55,960 --> 00:26:02,580
graph is over just one month of<font color="#E5E5E5"> data all</font>

625
00:26:01,270 --> 00:26:09,940
<font color="#E5E5E5">right cool</font>

626
00:26:02,580 --> 00:26:11,439
back in tagged<font color="#CCCCCC"> okay so so the</font><font color="#E5E5E5"> next</font>

627
00:26:09,940 --> 00:26:13,360
sister the next sort of thing that<font color="#E5E5E5"> we</font>

628
00:26:11,440 --> 00:26:15,160
<font color="#E5E5E5">wanted to talk about was something</font>

629
00:26:13,360 --> 00:26:18,340
<font color="#E5E5E5">that's kind</font><font color="#CCCCCC"> of interesting it's it's the</font>

630
00:26:15,160 --> 00:26:20,710
actual<font color="#E5E5E5"> back door or the actual code that</font>

631
00:26:18,340 --> 00:26:22,689
<font color="#E5E5E5">they inject so again back on Michelle's</font>

632
00:26:20,710 --> 00:26:25,840
<font color="#CCCCCC">website when</font><font color="#E5E5E5"> we were looking at that nav</font>

633
00:26:22,690 --> 00:26:28,390
menu dot PHP<font color="#E5E5E5"> there was that code that's</font>

634
00:26:25,840 --> 00:26:32,020
that's there and in<font color="#E5E5E5"> that code it did</font>

635
00:26:28,390 --> 00:26:34,150
fetch the exploit kit that iframe<font color="#E5E5E5"> and</font>

636
00:26:32,020 --> 00:26:36,700
render<font color="#CCCCCC"> it to</font><font color="#E5E5E5"> the victim but it</font><font color="#CCCCCC"> actually</font>

637
00:26:34,150 --> 00:26:39,670
did a little<font color="#E5E5E5"> bit</font><font color="#CCCCCC"> of other things as well</font>

638
00:26:36,700 --> 00:26:40,090
so what's kind<font color="#E5E5E5"> of interesting about</font><font color="#CCCCCC"> it</font>

639
00:26:39,670 --> 00:26:41,440
is

640
00:26:40,090 --> 00:26:42,970
if you start to think<font color="#CCCCCC"> about</font><font color="#E5E5E5"> you know</font>

641
00:26:41,440 --> 00:26:45,340
Matt just said that there's you know

642
00:26:42,970 --> 00:26:48,159
potentially tens of thousands of domains

643
00:26:45,340 --> 00:26:49,899
<font color="#E5E5E5">that these campaigns</font><font color="#CCCCCC"> are managing like</font>

644
00:26:48,159 --> 00:26:51,070
when you start to<font color="#CCCCCC"> think about how they</font>

645
00:26:49,900 --> 00:26:53,919
have to<font color="#CCCCCC"> deal with that</font><font color="#E5E5E5"> they're facing</font>

646
00:26:51,070 --> 00:26:56,020
like an orchestration problem<font color="#E5E5E5"> right like</font>

647
00:26:53,919 --> 00:26:57,400
they have so many compromised sites that

648
00:26:56,020 --> 00:26:59,889
it's actually they have to figure<font color="#E5E5E5"> out</font>

649
00:26:57,400 --> 00:27:01,929
how<font color="#E5E5E5"> to orchestrate all these at once and</font>

650
00:26:59,890 --> 00:27:03,880
so what they do is they actually<font color="#CCCCCC"> have a</font>

651
00:27:01,929 --> 00:27:06,580
back door<font color="#CCCCCC"> in place they actually have a</font>

652
00:27:03,880 --> 00:27:09,460
piece<font color="#CCCCCC"> of code in that snip that</font><font color="#E5E5E5"> I showed</font>

653
00:27:06,580 --> 00:27:12,610
<font color="#CCCCCC">you up front that</font><font color="#E5E5E5"> allows them</font><font color="#CCCCCC"> to access</font>

654
00:27:09,460 --> 00:27:14,799
these compromised sites<font color="#E5E5E5"> using</font><font color="#CCCCCC"> a specific</font>

655
00:27:12,610 --> 00:27:17,168
<font color="#E5E5E5">method so this is a pretty</font><font color="#CCCCCC"> well-known</font>

656
00:27:14,799 --> 00:27:21,190
<font color="#CCCCCC">though the</font><font color="#E5E5E5"> back door itself is pretty</font>

657
00:27:17,169 --> 00:27:22,510
<font color="#E5E5E5">well known</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> uses a peer</font><font color="#CCCCCC"> aggregate</font>

658
00:27:21,190 --> 00:27:27,490
replace function<font color="#CCCCCC"> this is a function</font>

659
00:27:22,510 --> 00:27:30,429
<font color="#CCCCCC">that's available</font><font color="#E5E5E5"> within PHP and all it</font>

660
00:27:27,490 --> 00:27:32,409
is is<font color="#CCCCCC"> a simple sort</font><font color="#E5E5E5"> of line substitution</font>

661
00:27:30,429 --> 00:27:34,390
<font color="#E5E5E5">so you give it</font><font color="#CCCCCC"> a string you determine</font>

662
00:27:32,409 --> 00:27:35,710
you have a<font color="#E5E5E5"> reg X and</font><font color="#CCCCCC"> it'll find</font><font color="#E5E5E5"> that</font>

663
00:27:34,390 --> 00:27:38,799
string<font color="#CCCCCC"> and replace it with</font><font color="#E5E5E5"> something</font>

664
00:27:35,710 --> 00:27:42,039
else<font color="#E5E5E5"> but</font><font color="#CCCCCC"> because we're talking about</font><font color="#E5E5E5"> PHP</font>

665
00:27:38,799 --> 00:27:45,610
and PHP is I<font color="#E5E5E5"> don't know bonkers</font>

666
00:27:42,039 --> 00:27:49,090
sometimes<font color="#E5E5E5"> they also have this great</font>

667
00:27:45,610 --> 00:27:52,209
<font color="#E5E5E5">thing that you could add on to</font><font color="#CCCCCC"> your</font><font color="#E5E5E5"> to</font>

668
00:27:49,090 --> 00:27:54,549
<font color="#E5E5E5">to your reg X and it's of trailing</font><font color="#CCCCCC"> E and</font>

669
00:27:52,210 --> 00:27:57,760
what that trailing II does means<font color="#E5E5E5"> is that</font>

670
00:27:54,549 --> 00:28:02,940
it will<font color="#E5E5E5"> treat the resulting string after</font>

671
00:27:57,760 --> 00:28:06,789
<font color="#CCCCCC">that</font><font color="#E5E5E5"> match as and pass it through eval</font>

672
00:28:02,940 --> 00:28:10,390
so if you pass<font color="#CCCCCC"> it</font><font color="#E5E5E5"> PHP code it will</font>

673
00:28:06,789 --> 00:28:12,340
execute<font color="#E5E5E5"> that PHP</font><font color="#CCCCCC"> code if you repeated a</font>

674
00:28:10,390 --> 00:28:15,520
string of PHP code it<font color="#CCCCCC"> will execute that</font>

675
00:28:12,340 --> 00:28:18,158
<font color="#E5E5E5">string as it wore PHP so this is a</font>

676
00:28:15,520 --> 00:28:20,710
really<font color="#CCCCCC"> common backdoor that people use</font>

677
00:28:18,159 --> 00:28:25,690
in sort of<font color="#E5E5E5"> the PHP world</font><font color="#CCCCCC"> and they</font>

678
00:28:20,710 --> 00:28:28,960
usually do it<font color="#E5E5E5"> by by setting cookies</font>

679
00:28:25,690 --> 00:28:30,880
so normally you set<font color="#CCCCCC"> 3 cookies and what</font>

680
00:28:28,960 --> 00:28:33,820
they'll do<font color="#E5E5E5"> is they'll embed this this</font>

681
00:28:30,880 --> 00:28:36,760
backdoor<font color="#E5E5E5"> somewhere in the site and then</font>

682
00:28:33,820 --> 00:28:40,029
if you have the right cookie set up to

683
00:28:36,760 --> 00:28:42,129
sort<font color="#CCCCCC"> of recreate this p reg replace</font>

684
00:28:40,029 --> 00:28:44,140
<font color="#E5E5E5">backdoor you'll be able to get code</font>

685
00:28:42,130 --> 00:28:46,330
execution on that<font color="#CCCCCC"> compromised site if</font>

686
00:28:44,140 --> 00:28:48,549
you<font color="#E5E5E5"> have the right cookie</font><font color="#CCCCCC"> setup</font><font color="#E5E5E5"> now the</font>

687
00:28:46,330 --> 00:28:50,649
one of the critical flaws<font color="#CCCCCC"> that the</font>

688
00:28:48,549 --> 00:28:53,080
pseudo dark<font color="#CCCCCC"> leach campaign made when</font>

689
00:28:50,649 --> 00:28:56,580
they're<font color="#E5E5E5"> doing this is that they</font>

690
00:28:53,080 --> 00:28:59,649
<font color="#E5E5E5">didn't use cookies they used post data</font>

691
00:28:56,580 --> 00:29:01,449
so<font color="#CCCCCC"> that might not be obvious why that's</font>

692
00:28:59,650 --> 00:29:03,040
a problem<font color="#CCCCCC"> but hopefully I'll explain it</font>

693
00:29:01,450 --> 00:29:05,710
in<font color="#CCCCCC"> just a second</font>

694
00:29:03,040 --> 00:29:09,040
<font color="#CCCCCC">um</font><font color="#E5E5E5"> so what they</font><font color="#CCCCCC"> did to secure all of</font>

695
00:29:05,710 --> 00:29:11,830
this is is<font color="#CCCCCC"> that they actually set</font><font color="#E5E5E5"> this</font>

696
00:29:09,040 --> 00:29:13,330
really long string it's a password you

697
00:29:11,830 --> 00:29:15,909
see it in the bottom<font color="#E5E5E5"> highlighted in</font>

698
00:29:13,330 --> 00:29:18,909
yellow<font color="#E5E5E5"> and</font><font color="#CCCCCC"> that really long string</font><font color="#E5E5E5"> is</font>

699
00:29:15,910 --> 00:29:20,980
the security for this<font color="#CCCCCC"> backdoor right</font>

700
00:29:18,910 --> 00:29:26,590
<font color="#E5E5E5">anybody</font><font color="#CCCCCC"> take a guess of what that string</font>

701
00:29:20,980 --> 00:29:28,660
is it's<font color="#CCCCCC"> nothin oh I wish it is the pay</font>

702
00:29:26,590 --> 00:29:31,570
it is a<font color="#E5E5E5"> password it's not the word</font>

703
00:29:28,660 --> 00:29:32,860
<font color="#E5E5E5">password</font><font color="#CCCCCC"> but I</font><font color="#E5E5E5"> think what</font><font color="#CCCCCC"> you're</font>

704
00:29:31,570 --> 00:29:34,840
implying<font color="#E5E5E5"> there is that this is a hash</font>

705
00:29:32,860 --> 00:29:36,159
and it is right<font color="#CCCCCC"> it's the sure hash we</font>

706
00:29:34,840 --> 00:29:38,110
don't know for sure it's a hash but it's

707
00:29:36,160 --> 00:29:39,910
obviously so we started to look<font color="#CCCCCC"> up so</font>

708
00:29:38,110 --> 00:29:41,500
god what the heck is this<font color="#E5E5E5"> hash</font><font color="#CCCCCC"> like what</font>

709
00:29:39,910 --> 00:29:43,900
is this<font color="#CCCCCC"> thing man like what is it is it</font>

710
00:29:41,500 --> 00:29:45,370
<font color="#E5E5E5">password what it'll be so I googled it</font>

711
00:29:43,900 --> 00:29:47,860
like I mean you know how else do you

712
00:29:45,370 --> 00:29:49,750
figure<font color="#E5E5E5"> things out</font><font color="#CCCCCC"> and so I googled</font><font color="#E5E5E5"> it I</font>

713
00:29:47,860 --> 00:29:52,570
started<font color="#E5E5E5"> to see all these results for</font>

714
00:29:49,750 --> 00:29:54,910
this<font color="#E5E5E5"> integer value this 102</font><font color="#CCCCCC"> I think it</font>

715
00:29:52,570 --> 00:29:56,919
won't<font color="#E5E5E5"> look like 102</font><font color="#CCCCCC"> one one seven</font><font color="#E5E5E5"> got a</font>

716
00:29:54,910 --> 00:29:59,890
look at<font color="#CCCCCC"> slide</font><font color="#E5E5E5"> and I started to realize</font>

717
00:29:56,920 --> 00:30:02,890
like wait wait<font color="#E5E5E5"> this is this is a hash</font>

718
00:29:59,890 --> 00:30:04,780
<font color="#CCCCCC">value of</font><font color="#E5E5E5"> the string of an integer it's a</font>

719
00:30:02,890 --> 00:30:07,000
<font color="#E5E5E5">this number it's a hash number like this</font>

720
00:30:04,780 --> 00:30:08,800
<font color="#E5E5E5">is weird what's going on here and so I</font>

721
00:30:07,000 --> 00:30:10,540
started to look at<font color="#CCCCCC"> it</font><font color="#E5E5E5"> and confirm it</font><font color="#CCCCCC"> and</font>

722
00:30:08,800 --> 00:30:12,220
in fact it was and so I started<font color="#E5E5E5"> to look</font>

723
00:30:10,540 --> 00:30:15,550
<font color="#E5E5E5">at</font><font color="#CCCCCC"> it even more and say word what is</font>

724
00:30:12,220 --> 00:30:17,800
<font color="#E5E5E5">this</font><font color="#CCCCCC"> value and so when you</font><font color="#E5E5E5"> start to dig</font>

725
00:30:15,550 --> 00:30:21,790
into these<font color="#CCCCCC"> exploits</font><font color="#E5E5E5"> you'll find this</font>

726
00:30:17,800 --> 00:30:23,169
interesting function<font color="#CCCCCC"> and oh I mentioned</font>

727
00:30:21,790 --> 00:30:26,710
that at<font color="#E5E5E5"> the start that there was this</font>

728
00:30:23,170 --> 00:30:30,250
long string embedded in the bat in<font color="#CCCCCC"> that</font>

729
00:30:26,710 --> 00:30:33,130
code of PHP now that string is base64

730
00:30:30,250 --> 00:30:34,990
encoded<font color="#E5E5E5"> and it's they do some other sort</font>

731
00:30:33,130 --> 00:30:37,120
of<font color="#E5E5E5"> like they move around the numbers of</font>

732
00:30:34,990 --> 00:30:39,940
IP addresses<font color="#CCCCCC"> to</font><font color="#E5E5E5"> make it difficult I</font>

733
00:30:37,120 --> 00:30:42,340
<font color="#E5E5E5">don't know it's all you see the code so</font>

734
00:30:39,940 --> 00:30:44,650
<font color="#CCCCCC">you just know how to fix it</font><font color="#E5E5E5"> you know but</font>

735
00:30:42,340 --> 00:30:46,000
so so they do<font color="#E5E5E5"> all</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> they change all</font>

736
00:30:44,650 --> 00:30:49,720
this stuff<font color="#E5E5E5"> around</font><font color="#CCCCCC"> but when you</font>

737
00:30:46,000 --> 00:30:52,510
unencrypted<font color="#E5E5E5"> quotes this this base 64</font>

738
00:30:49,720 --> 00:30:55,360
encoded string what you see is<font color="#E5E5E5"> that same</font>

739
00:30:52,510 --> 00:31:01,000
number<font color="#CCCCCC"> that same you know one whatever</font>

740
00:30:55,360 --> 00:31:03,310
<font color="#E5E5E5">it is 1 2 1 2 0 1 1 7 102</font><font color="#CCCCCC"> one of the two</font>

741
00:31:01,000 --> 00:31:05,650
<font color="#E5E5E5">so</font><font color="#CCCCCC"> you see that same number pop up in</font>

742
00:31:03,310 --> 00:31:06,950
that URL<font color="#CCCCCC"> and so because we had access</font><font color="#E5E5E5"> to</font>

743
00:31:05,650 --> 00:31:09,440
<font color="#E5E5E5">a bunch of these differ</font>

744
00:31:06,950 --> 00:31:11,450
web<font color="#E5E5E5"> roots of compromised servers we</font>

745
00:31:09,440 --> 00:31:14,750
started to look<font color="#E5E5E5"> at the other URLs</font><font color="#CCCCCC"> and</font>

746
00:31:11,450 --> 00:31:17,360
sure enough embedded in that decrypted

747
00:31:14,750 --> 00:31:19,610
URL<font color="#E5E5E5"> for all of those compromised</font>

748
00:31:17,360 --> 00:31:21,889
<font color="#E5E5E5">websites they had this same sort of</font>

749
00:31:19,610 --> 00:31:23,330
number that<font color="#E5E5E5"> was there and what we think</font>

750
00:31:21,889 --> 00:31:25,610
it<font color="#CCCCCC"> is based on just sort</font><font color="#E5E5E5"> of</font>

751
00:31:23,330 --> 00:31:27,620
understanding<font color="#CCCCCC"> rig and sort</font><font color="#E5E5E5"> of public</font>

752
00:31:25,610 --> 00:31:31,549
information<font color="#CCCCCC"> we</font><font color="#E5E5E5"> think that that's the</font>

753
00:31:27,620 --> 00:31:34,399
<font color="#E5E5E5">user ID of the user subscribed to rig</font>

754
00:31:31,549 --> 00:31:37,149
exploit<font color="#E5E5E5"> kit so you</font><font color="#CCCCCC"> know you purchase</font>

755
00:31:34,399 --> 00:31:40,340
subscription<font color="#CCCCCC"> access to rig rig you</font>

756
00:31:37,149 --> 00:31:43,309
<font color="#E5E5E5">probably gives you a user ID</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> and</font>

757
00:31:40,340 --> 00:31:46,610
and so<font color="#CCCCCC"> that's what the</font><font color="#E5E5E5"> that's what you</font>

758
00:31:43,309 --> 00:31:48,230
you use in URL to get that iframe<font color="#E5E5E5"> or</font><font color="#CCCCCC"> get</font>

759
00:31:46,610 --> 00:31:50,928
that content<font color="#E5E5E5"> back so we started to get</font>

760
00:31:48,230 --> 00:31:56,149
<font color="#E5E5E5">all of these different user IDs</font><font color="#CCCCCC"> and it</font>

761
00:31:50,929 --> 00:31:59,840
turned out<font color="#E5E5E5"> that these user IDs were</font>

762
00:31:56,149 --> 00:32:02,870
really really<font color="#E5E5E5"> sort of easy to</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> use and</font>

763
00:31:59,840 --> 00:32:04,340
to turn into<font color="#E5E5E5"> full backdoor access</font><font color="#CCCCCC"> onto</font>

764
00:32:02,870 --> 00:32:06,320
these<font color="#E5E5E5"> systems once you knew the user ID</font>

765
00:32:04,340 --> 00:32:09,080
<font color="#E5E5E5">you essentially knew the password</font><font color="#CCCCCC"> just</font>

766
00:32:06,320 --> 00:32:11,450
by<font color="#CCCCCC"> M defying</font><font color="#E5E5E5"> right so if you want to</font>

767
00:32:09,080 --> 00:32:14,090
<font color="#E5E5E5">access the backdoor this is your you</font>

768
00:32:11,450 --> 00:32:17,240
<font color="#E5E5E5">know this is your remote command</font><font color="#CCCCCC"> right</font>

769
00:32:14,090 --> 00:32:20,600
<font color="#E5E5E5">you just set up the variables correctly</font>

770
00:32:17,240 --> 00:32:25,210
<font color="#CCCCCC">and you just sort of set one of the keys</font>

771
00:32:20,600 --> 00:32:28,129
<font color="#CCCCCC">to be this md5 value</font><font color="#E5E5E5"> and you're good</font><font color="#CCCCCC"> now</font>

772
00:32:25,210 --> 00:32:30,320
<font color="#CCCCCC">this still requires you to know this</font>

773
00:32:28,130 --> 00:32:32,419
user ID<font color="#E5E5E5"> and</font><font color="#CCCCCC"> that kind of sucks like</font>

774
00:32:30,320 --> 00:32:34,129
who's gonna know that<font color="#E5E5E5"> user ID but</font>

775
00:32:32,419 --> 00:32:37,399
there's something really<font color="#E5E5E5"> great</font><font color="#CCCCCC"> about</font>

776
00:32:34,130 --> 00:32:39,679
this user ID<font color="#E5E5E5"> it's an integer value</font><font color="#CCCCCC"> like</font>

777
00:32:37,399 --> 00:32:42,320
it's you know<font color="#E5E5E5"> what</font><font color="#CCCCCC"> ifs</font><font color="#E5E5E5"> eight digit</font>

778
00:32:39,679 --> 00:32:44,210
integer<font color="#CCCCCC"> like come on</font><font color="#E5E5E5"> man</font><font color="#CCCCCC"> and there's</font>

779
00:32:42,320 --> 00:32:46,730
also something else<font color="#E5E5E5"> right because</font>

780
00:32:44,210 --> 00:32:49,909
remember at front I said<font color="#E5E5E5"> normally they</font>

781
00:32:46,730 --> 00:32:51,860
would<font color="#CCCCCC"> be using these two using these in</font>

782
00:32:49,909 --> 00:32:54,049
cookies<font color="#E5E5E5"> right at first they would be</font>

783
00:32:51,860 --> 00:32:56,449
using these values<font color="#CCCCCC"> in cookie cookie</font>

784
00:32:54,049 --> 00:32:58,519
values but<font color="#E5E5E5"> here</font><font color="#CCCCCC"> they're post data values</font>

785
00:32:56,450 --> 00:33:00,350
<font color="#CCCCCC">and there's one</font><font color="#E5E5E5"> really important</font>

786
00:32:58,519 --> 00:33:03,169
attribute<font color="#CCCCCC"> about post data</font><font color="#E5E5E5"> is that you</font>

787
00:33:00,350 --> 00:33:05,029
can support<font color="#CCCCCC"> lots of it</font><font color="#E5E5E5"> you can send a</font>

788
00:33:03,169 --> 00:33:07,070
lot of post data to a server you want<font color="#E5E5E5"> to</font>

789
00:33:05,029 --> 00:33:08,750
<font color="#E5E5E5">upload a file you've sent it as post</font>

790
00:33:07,070 --> 00:33:10,580
data<font color="#E5E5E5"> right you want to do anything else</font>

791
00:33:08,750 --> 00:33:11,929
<font color="#E5E5E5">you just sort of send that post data so</font>

792
00:33:10,580 --> 00:33:16,158
<font color="#E5E5E5">hopefully you can see where I'm going</font>

793
00:33:11,929 --> 00:33:17,960
with<font color="#CCCCCC"> this</font><font color="#E5E5E5"> so a lot</font><font color="#CCCCCC"> of times these these</font>

794
00:33:16,159 --> 00:33:20,130
<font color="#E5E5E5">compromised sites they are running</font>

795
00:33:17,960 --> 00:33:23,910
<font color="#E5E5E5">either nginx or Apache and</font>

796
00:33:20,130 --> 00:33:25,920
default post data size<font color="#CCCCCC"> is 1 Meg which is</font>

797
00:33:23,910 --> 00:33:28,770
a heck of a<font color="#E5E5E5"> lot</font><font color="#CCCCCC"> of post data</font><font color="#E5E5E5"> if you</font>

798
00:33:25,920 --> 00:33:30,600
think about<font color="#CCCCCC"> it and</font><font color="#E5E5E5"> Apache is just out of</font>

799
00:33:28,770 --> 00:33:33,090
<font color="#E5E5E5">control they're just like you know</font>

800
00:33:30,600 --> 00:33:35,969
Yolo whatever you want to send<font color="#E5E5E5"> which</font><font color="#CCCCCC"> is</font>

801
00:33:33,090 --> 00:33:37,500
wonderful<font color="#CCCCCC"> so to actually so what</font><font color="#E5E5E5"> you</font>

802
00:33:35,970 --> 00:33:39,900
could do here is you could<font color="#E5E5E5"> brute force</font>

803
00:33:37,500 --> 00:33:41,760
this value<font color="#E5E5E5"> right like a brute</font><font color="#CCCCCC"> force err</font>

804
00:33:39,900 --> 00:33:43,920
is simple<font color="#E5E5E5"> at this point all you have to</font>

805
00:33:41,760 --> 00:33:45,360
do is just you know<font color="#CCCCCC"> the since</font><font color="#E5E5E5"> we had a</font>

806
00:33:43,920 --> 00:33:48,930
<font color="#E5E5E5">bunch of</font><font color="#CCCCCC"> compromise sites we know</font>

807
00:33:45,360 --> 00:33:51,149
roughly<font color="#E5E5E5"> the range of integer values that</font>

808
00:33:48,930 --> 00:33:52,590
this<font color="#E5E5E5"> is all</font><font color="#CCCCCC"> gonna be and so to write a</font>

809
00:33:51,150 --> 00:33:55,350
brute<font color="#CCCCCC"> force</font><font color="#E5E5E5"> she's just basically writing</font>

810
00:33:52,590 --> 00:33:57,090
a for<font color="#E5E5E5"> loop in Python right and you're</font>

811
00:33:55,350 --> 00:33:59,939
just<font color="#CCCCCC"> m</font><font color="#E5E5E5"> defying that value over</font><font color="#CCCCCC"> and over</font>

812
00:33:57,090 --> 00:34:01,709
again so<font color="#E5E5E5"> the initial</font><font color="#CCCCCC"> back door</font><font color="#E5E5E5"> access</font>

813
00:33:59,940 --> 00:34:04,440
would<font color="#E5E5E5"> be sort</font><font color="#CCCCCC"> of something</font><font color="#E5E5E5"> like this</font>

814
00:34:01,710 --> 00:34:08,699
where you just<font color="#E5E5E5"> send that single</font><font color="#CCCCCC"> password</font>

815
00:34:04,440 --> 00:34:09,960
as the value but once we actually<font color="#E5E5E5"> want</font>

816
00:34:08,699 --> 00:34:12,330
<font color="#E5E5E5">to</font><font color="#CCCCCC"> brute-force that we just send</font><font color="#E5E5E5"> it a</font>

817
00:34:09,960 --> 00:34:13,190
larger amount<font color="#CCCCCC"> of post data and we just</font>

818
00:34:12,330 --> 00:34:17,100
brute force

819
00:34:13,190 --> 00:34:20,250
hundreds of passwords at once<font color="#E5E5E5"> and if any</font>

820
00:34:17,100 --> 00:34:22,409
<font color="#E5E5E5">one of those hundred passwords actually</font>

821
00:34:20,250 --> 00:34:24,600
lands<font color="#E5E5E5"> is actually correct then our code</font>

822
00:34:22,409 --> 00:34:26,580
gets executed<font color="#E5E5E5"> and we could bash this</font>

823
00:34:24,600 --> 00:34:28,918
<font color="#CCCCCC">into sizes that are appropriate to</font><font color="#E5E5E5"> the</font>

824
00:34:26,580 --> 00:34:30,679
the<font color="#CCCCCC"> webserver so that we can</font><font color="#E5E5E5"> prove force</font>

825
00:34:28,918 --> 00:34:34,560
it really efficiently<font color="#E5E5E5"> and really quickly</font>

826
00:34:30,679 --> 00:34:38,610
and so<font color="#CCCCCC"> you could totally do that</font>

827
00:34:34,560 --> 00:34:40,710
and if you do that<font color="#E5E5E5"> what do you get so</font>

828
00:34:38,610 --> 00:34:44,190
it's kind of fun<font color="#CCCCCC"> about this is that now</font>

829
00:34:40,710 --> 00:34:46,649
you have<font color="#CCCCCC"> the ability to act as the proxy</font>

830
00:34:44,190 --> 00:34:48,120
to these networks<font color="#E5E5E5"> right so</font><font color="#CCCCCC"> your so</font>

831
00:34:46,649 --> 00:34:50,310
normally<font color="#E5E5E5"> what would happen is you'd</font><font color="#CCCCCC"> go</font>

832
00:34:48,120 --> 00:34:52,529
to<font color="#E5E5E5"> Michelle's website</font><font color="#CCCCCC"> Michelle's</font><font color="#E5E5E5"> website</font>

833
00:34:50,310 --> 00:34:55,440
would pull your user agent<font color="#E5E5E5"> pull your IP</font>

834
00:34:52,530 --> 00:34:57,450
address<font color="#E5E5E5"> and then pass it on to the rig</font>

835
00:34:55,440 --> 00:34:59,190
<font color="#E5E5E5">back-end server which would then do a</font>

836
00:34:57,450 --> 00:35:02,220
<font color="#E5E5E5">bunch of filtering to say you know this</font>

837
00:34:59,190 --> 00:35:04,680
<font color="#E5E5E5">I this IP address has hit me a bunch of</font>

838
00:35:02,220 --> 00:35:07,109
times let<font color="#CCCCCC"> me not serve they exploit but</font>

839
00:35:04,680 --> 00:35:09,060
here<font color="#E5E5E5"> now we can spoof everything because</font>

840
00:35:07,110 --> 00:35:10,650
now we're Michelle's site were that

841
00:35:09,060 --> 00:35:13,590
compromised<font color="#CCCCCC"> website and we're</font>

842
00:35:10,650 --> 00:35:16,290
controlling<font color="#E5E5E5"> what data</font><font color="#CCCCCC"> rig sees so we can</font>

843
00:35:13,590 --> 00:35:17,820
only use<font color="#E5E5E5"> user agents that we know are</font>

844
00:35:16,290 --> 00:35:19,950
really<font color="#E5E5E5"> good or we can test lots of</font>

845
00:35:17,820 --> 00:35:22,080
different user<font color="#CCCCCC"> agents</font><font color="#E5E5E5"> we can set any IP</font>

846
00:35:19,950 --> 00:35:24,600
address<font color="#CCCCCC"> that we want right because it's</font>

847
00:35:22,080 --> 00:35:26,880
we're controlling<font color="#E5E5E5"> it and we can just</font>

848
00:35:24,600 --> 00:35:29,700
regularly<font color="#CCCCCC"> setup</font><font color="#E5E5E5"> that we're constantly</font>

849
00:35:26,880 --> 00:35:32,490
requesting over and over again<font color="#CCCCCC"> new gates</font>

850
00:35:29,700 --> 00:35:33,299
because<font color="#E5E5E5"> these gates are</font><font color="#CCCCCC"> revolving the</font>

851
00:35:32,490 --> 00:35:35,160
road

852
00:35:33,300 --> 00:35:37,410
on a regular<font color="#CCCCCC"> basis so</font><font color="#E5E5E5"> now we can just</font>

853
00:35:35,160 --> 00:35:39,779
sort<font color="#E5E5E5"> of use this as a proxy and just</font>

854
00:35:37,410 --> 00:35:42,569
request more and more gates<font color="#E5E5E5"> and find</font>

855
00:35:39,780 --> 00:35:43,800
more things<font color="#E5E5E5"> to you know more bad of this</font>

856
00:35:42,569 --> 00:35:46,980
networking<font color="#E5E5E5"> undercover more of that</font>

857
00:35:43,800 --> 00:35:49,560
infrastructure so<font color="#CCCCCC"> we did we</font><font color="#E5E5E5"> found out</font>

858
00:35:46,980 --> 00:35:51,810
that the<font color="#CCCCCC"> backend server that's hosting</font>

859
00:35:49,560 --> 00:35:54,060
<font color="#CCCCCC">this is almost always</font><font color="#E5E5E5"> in our key in the</font>

860
00:35:51,810 --> 00:35:56,549
cases that we saw were on<font color="#CCCCCC"> Hetzler</font><font color="#E5E5E5"> now if</font>

861
00:35:54,060 --> 00:35:59,270
you've done a lot of<font color="#E5E5E5"> this research has</font>

862
00:35:56,550 --> 00:36:01,770
<font color="#CCCCCC">there's a</font><font color="#E5E5E5"> good you know generally a good</font>

863
00:35:59,270 --> 00:36:03,300
service<font color="#CCCCCC"> they do</font><font color="#E5E5E5"> really really good stuff</font>

864
00:36:01,770 --> 00:36:05,849
but it seems like for whatever reason

865
00:36:03,300 --> 00:36:08,339
these actors love<font color="#E5E5E5"> hats they're more than</font>

866
00:36:05,849 --> 00:36:10,230
anything<font color="#E5E5E5"> and so every case where the rig</font>

867
00:36:08,339 --> 00:36:12,569
server<font color="#E5E5E5"> because we're also uncovering the</font>

868
00:36:10,230 --> 00:36:14,400
<font color="#E5E5E5">rig server IP in this whole</font><font color="#CCCCCC"> process</font><font color="#E5E5E5"> so</font>

869
00:36:12,569 --> 00:36:16,589
we actually know where that server is

870
00:36:14,400 --> 00:36:17,940
<font color="#E5E5E5">that's controlled</font><font color="#CCCCCC"> by the the not the</font>

871
00:36:16,589 --> 00:36:20,250
criminal the actual attacker<font color="#E5E5E5"> who's</font>

872
00:36:17,940 --> 00:36:21,690
<font color="#CCCCCC">offering the exploit kit</font><font color="#E5E5E5"> and so we know</font>

873
00:36:20,250 --> 00:36:23,010
it's<font color="#E5E5E5"> almost always on</font><font color="#CCCCCC"> Hessler so that's</font>

874
00:36:21,690 --> 00:36:25,710
amazing that was a good piece<font color="#CCCCCC"> of</font>

875
00:36:23,010 --> 00:36:27,630
<font color="#CCCCCC">information</font><font color="#E5E5E5"> and we were able to get</font><font color="#CCCCCC"> a</font>

876
00:36:25,710 --> 00:36:29,730
lot<font color="#CCCCCC"> more</font><font color="#E5E5E5"> of these gates so that's sort</font>

877
00:36:27,630 --> 00:36:31,950
<font color="#E5E5E5">of an interesting</font><font color="#CCCCCC"> little fun</font><font color="#E5E5E5"> little</font>

878
00:36:29,730 --> 00:36:33,960
backdoor<font color="#E5E5E5"> that that that exists in those</font>

879
00:36:31,950 --> 00:36:36,419
<font color="#E5E5E5">systems and that's still there as of you</font>

880
00:36:33,960 --> 00:36:40,079
know<font color="#E5E5E5"> today yeah</font><font color="#CCCCCC"> I don't know who to</font>

881
00:36:36,420 --> 00:36:43,079
<font color="#CCCCCC">report the bug - is there a responsible</font>

882
00:36:40,079 --> 00:36:45,240
disclosure I don't know<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> so the</font>

883
00:36:43,079 --> 00:36:47,700
other thing<font color="#E5E5E5"> is we are also thinking</font>

884
00:36:45,240 --> 00:36:49,020
<font color="#CCCCCC">about ways like we're</font><font color="#E5E5E5"> like all right</font>

885
00:36:47,700 --> 00:36:51,029
<font color="#CCCCCC">we've looking at all those</font><font color="#E5E5E5"> exploit</font><font color="#CCCCCC"> good</font>

886
00:36:49,020 --> 00:36:52,410
stuff<font color="#CCCCCC"> but what's really</font><font color="#E5E5E5"> exploit you like</font>

887
00:36:51,030 --> 00:36:53,940
what are<font color="#E5E5E5"> they really</font><font color="#CCCCCC"> doing</font><font color="#E5E5E5"> they're</font>

888
00:36:52,410 --> 00:36:55,649
sending you ransomware or they're

889
00:36:53,940 --> 00:36:59,579
sending you banking Trojans<font color="#CCCCCC"> that sort of</font>

890
00:36:55,650 --> 00:37:01,589
stuff<font color="#E5E5E5"> so</font><font color="#CCCCCC"> you know what</font><font color="#E5E5E5"> let's</font><font color="#CCCCCC"> try</font><font color="#E5E5E5"> to</font>

891
00:36:59,579 --> 00:37:03,150
<font color="#CCCCCC">focus on that endgame of these exploit</font>

892
00:37:01,589 --> 00:37:05,130
kits as<font color="#CCCCCC"> well and try to understand these</font>

893
00:37:03,150 --> 00:37:06,210
samples<font color="#E5E5E5"> and pull them together so we're</font>

894
00:37:05,130 --> 00:37:07,589
<font color="#E5E5E5">thinking about it we're like are well</font>

895
00:37:06,210 --> 00:37:10,200
how are we<font color="#E5E5E5"> gonna get lots and lots of</font>

896
00:37:07,589 --> 00:37:12,150
samples<font color="#CCCCCC"> and we were like</font><font color="#E5E5E5"> well one of the</font>

897
00:37:10,200 --> 00:37:14,910
<font color="#E5E5E5">things that we could do is we can set</font><font color="#CCCCCC"> up</font>

898
00:37:12,150 --> 00:37:16,079
sort of email<font color="#E5E5E5"> honey pots</font><font color="#CCCCCC"> so we started</font>

899
00:37:14,910 --> 00:37:18,299
to go down this route<font color="#E5E5E5"> I'm sure many of</font>

900
00:37:16,079 --> 00:37:19,800
you<font color="#E5E5E5"> have gone down this route before you</font>

901
00:37:18,300 --> 00:37:21,930
want to<font color="#CCCCCC"> sign up you know you maybe</font>

902
00:37:19,800 --> 00:37:24,210
register a gmail account<font color="#E5E5E5"> and sign up</font><font color="#CCCCCC"> for</font>

903
00:37:21,930 --> 00:37:28,319
lots of crap but it turns out like<font color="#E5E5E5"> Gmail</font>

904
00:37:24,210 --> 00:37:30,450
is a good service<font color="#CCCCCC"> so they are looking at</font>

905
00:37:28,319 --> 00:37:32,310
your attachments they're looking at

906
00:37:30,450 --> 00:37:33,689
looking for phishing campaigns and

907
00:37:32,310 --> 00:37:35,460
<font color="#E5E5E5">they're actively blocking them or</font>

908
00:37:33,690 --> 00:37:37,230
<font color="#E5E5E5">publishing to your spam folder and we</font>

909
00:37:35,460 --> 00:37:38,609
don't want that<font color="#E5E5E5"> we want the crap right</font>

910
00:37:37,230 --> 00:37:40,200
<font color="#E5E5E5">like we want the bad stuff in them today</font>

911
00:37:38,609 --> 00:37:42,270
<font color="#CCCCCC">so I started to think about</font><font color="#E5E5E5"> it like</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> oh</font>

912
00:37:40,200 --> 00:37:43,470
<font color="#CCCCCC">I could</font><font color="#E5E5E5"> set up</font><font color="#CCCCCC"> my own mail server but</font>

913
00:37:42,270 --> 00:37:45,300
that sinus sucks<font color="#E5E5E5"> like I</font><font color="#CCCCCC"> don't want to</font>

914
00:37:43,470 --> 00:37:46,319
<font color="#E5E5E5">set up</font><font color="#CCCCCC"> my own mail server like I mean</font>

915
00:37:45,300 --> 00:37:47,759
it's not hard<font color="#CCCCCC"> but it's just</font>

916
00:37:46,319 --> 00:37:50,430
like I<font color="#E5E5E5"> don't I don't</font><font color="#CCCCCC"> feel like it's</font>

917
00:37:47,759 --> 00:37:51,569
gonna last forever it's<font color="#CCCCCC"> not great and</font>

918
00:37:50,430 --> 00:37:53,399
then I still<font color="#CCCCCC"> have to</font><font color="#E5E5E5"> sign</font><font color="#CCCCCC"> up for all</font>

919
00:37:51,569 --> 00:37:56,069
<font color="#E5E5E5">this crap like I got to go and sign up</font>

920
00:37:53,400 --> 00:37:57,359
<font color="#CCCCCC">for all this you know</font><font color="#E5E5E5"> threat reports and</font>

921
00:37:56,069 --> 00:38:00,569
you know all the other<font color="#E5E5E5"> stuff</font><font color="#CCCCCC"> that gets</font>

922
00:37:57,359 --> 00:38:01,529
<font color="#E5E5E5">you the nasty nasty information</font><font color="#CCCCCC"> and so</font>

923
00:38:00,569 --> 00:38:03,630
what I<font color="#E5E5E5"> started thinking is like well</font>

924
00:38:01,529 --> 00:38:05,969
wait a second I always<font color="#E5E5E5"> use when I want</font>

925
00:38:03,630 --> 00:38:07,469
<font color="#CCCCCC">to sign up for nasty stuff what I use</font><font color="#E5E5E5"> is</font>

926
00:38:05,969 --> 00:38:10,019
a disposable<font color="#CCCCCC"> mailbox I go to mail at</font>

927
00:38:07,469 --> 00:38:11,309
malonate<font color="#E5E5E5"> err calm and when I want to you</font>

928
00:38:10,019 --> 00:38:14,339
<font color="#E5E5E5">know sign up for some that's probably</font>

929
00:38:11,309 --> 00:38:16,199
suspicious and may result in<font color="#E5E5E5"> compromised</font>

930
00:38:14,339 --> 00:38:18,058
<font color="#E5E5E5">I'll just use mail inators the</font>

931
00:38:16,199 --> 00:38:20,369
disposable<font color="#E5E5E5"> mailbox a single one use</font>

932
00:38:18,059 --> 00:38:22,140
<font color="#CCCCCC">mailbox</font><font color="#E5E5E5"> the the trick about it is is</font>

933
00:38:20,369 --> 00:38:23,699
<font color="#CCCCCC">that</font><font color="#E5E5E5"> anybody could read your mail</font><font color="#CCCCCC"> but</font>

934
00:38:22,140 --> 00:38:27,118
who cares<font color="#CCCCCC"> because it's just this one</font>

935
00:38:23,699 --> 00:38:28,799
used mailbox<font color="#CCCCCC"> and so so I</font><font color="#E5E5E5"> was like all</font>

936
00:38:27,119 --> 00:38:29,789
right<font color="#E5E5E5"> well let me see what if I used</font>

937
00:38:28,799 --> 00:38:34,440
<font color="#CCCCCC">melon ater</font>

938
00:38:29,789 --> 00:38:37,109
for my as my<font color="#E5E5E5"> email honeypot right will</font>

939
00:38:34,440 --> 00:38:38,609
it work<font color="#E5E5E5"> so I tried</font><font color="#CCCCCC"> it out</font><font color="#E5E5E5"> I was</font><font color="#CCCCCC"> a girl</font>

940
00:38:37,109 --> 00:38:40,348
right cool<font color="#CCCCCC"> let's build a quick system we</font>

941
00:38:38,609 --> 00:38:42,359
sort<font color="#E5E5E5"> of prototype</font><font color="#CCCCCC"> to quick system we</font>

942
00:38:40,349 --> 00:38:44,609
called it<font color="#E5E5E5"> mail runner it basically pulls</font>

943
00:38:42,359 --> 00:38:46,799
data from<font color="#CCCCCC"> mail inator</font><font color="#E5E5E5"> feeds it into</font>

944
00:38:44,609 --> 00:38:49,859
thread grid or Cisco<font color="#E5E5E5"> we get the record</font>

945
00:38:46,799 --> 00:38:53,130
for free<font color="#E5E5E5"> and we pass it through</font><font color="#CCCCCC"> a</font>

946
00:38:49,859 --> 00:38:54,808
classification engine for stuff<font color="#CCCCCC"> and if I</font>

947
00:38:53,130 --> 00:38:56,609
mean if<font color="#CCCCCC"> you think about</font><font color="#E5E5E5"> it if an email</font>

948
00:38:54,809 --> 00:38:58,349
it has an attachment<font color="#E5E5E5"> and that attachment</font>

949
00:38:56,609 --> 00:39:01,469
is reaching out<font color="#CCCCCC"> to the</font><font color="#E5E5E5"> Internet that's</font>

950
00:38:58,349 --> 00:39:03,029
<font color="#E5E5E5">probably bad</font><font color="#CCCCCC"> like most likely bad so we</font>

951
00:39:01,469 --> 00:39:05,160
do some basic filtering<font color="#E5E5E5"> on the results</font>

952
00:39:03,029 --> 00:39:07,709
of<font color="#E5E5E5"> the threat results and sure enough we</font>

953
00:39:05,160 --> 00:39:10,979
were happy to see<font color="#E5E5E5"> that we</font><font color="#CCCCCC"> actually found</font>

954
00:39:07,709 --> 00:39:13,140
stuff there was actually one<font color="#CCCCCC"> day around</font>

955
00:39:10,979 --> 00:39:15,718
<font color="#CCCCCC">this</font><font color="#E5E5E5"> time</font><font color="#CCCCCC"> last year were one third of</font>

956
00:39:13,140 --> 00:39:20,038
all<font color="#E5E5E5"> of the email</font><font color="#CCCCCC"> that we saw in these</font>

957
00:39:15,719 --> 00:39:22,559
mailboxes<font color="#CCCCCC"> was</font><font color="#E5E5E5"> actually lucky</font><font color="#CCCCCC"> it was</font>

958
00:39:20,039 --> 00:39:24,420
crazy we found<font color="#CCCCCC"> odin we found all this</font>

959
00:39:22,559 --> 00:39:26,069
other stuff<font color="#E5E5E5"> so we were</font><font color="#CCCCCC"> like great this</font>

960
00:39:24,420 --> 00:39:28,619
is awesome we're finding like good now

961
00:39:26,069 --> 00:39:29,940
is like a source of it<font color="#E5E5E5"> but the problem</font>

962
00:39:28,619 --> 00:39:31,949
<font color="#CCCCCC">is we're using</font><font color="#E5E5E5"> mail inator and</font><font color="#CCCCCC"> mail</font>

963
00:39:29,940 --> 00:39:33,630
<font color="#CCCCCC">inator cost money</font><font color="#E5E5E5"> like and that's like a</font>

964
00:39:31,949 --> 00:39:35,670
you<font color="#CCCCCC"> know</font><font color="#E5E5E5"> like we've actually paid for</font>

965
00:39:33,630 --> 00:39:37,619
<font color="#E5E5E5">the API</font><font color="#CCCCCC"> you know just make it</font><font color="#E5E5E5"> life</font>

966
00:39:35,670 --> 00:39:40,349
easier<font color="#CCCCCC"> so we said you know</font><font color="#E5E5E5"> what</font><font color="#CCCCCC"> forget</font>

967
00:39:37,619 --> 00:39:43,229
<font color="#CCCCCC">it man I'm just gonna</font><font color="#E5E5E5"> roll my own</font><font color="#CCCCCC"> so we</font>

968
00:39:40,349 --> 00:39:45,809
created laced mail<font color="#CCCCCC"> comm and the whole</font>

969
00:39:43,229 --> 00:39:48,749
purpose<font color="#E5E5E5"> of this is for you guys to</font><font color="#CCCCCC"> do</font>

970
00:39:45,809 --> 00:39:50,369
the<font color="#CCCCCC"> same thing so I'm basically don't</font>

971
00:39:48,749 --> 00:39:52,828
want to sign<font color="#CCCCCC"> up for things</font><font color="#E5E5E5"> so I'm hoping</font>

972
00:39:50,369 --> 00:39:55,680
you<font color="#CCCCCC"> guys</font><font color="#E5E5E5"> will so sign up</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> anything</font>

973
00:39:52,829 --> 00:39:57,630
<font color="#E5E5E5">anything</font><font color="#CCCCCC"> that hits this server</font><font color="#E5E5E5"> goes here</font>

974
00:39:55,680 --> 00:39:59,819
<font color="#E5E5E5">and it can be queried via an API so</font><font color="#CCCCCC"> you</font>

975
00:39:57,630 --> 00:40:04,760
<font color="#CCCCCC">can download all the samples you</font><font color="#E5E5E5"> want</font>

976
00:39:59,820 --> 00:40:07,890
from it<font color="#E5E5E5"> just via the API</font><font color="#CCCCCC"> super-easy and</font>

977
00:40:04,760 --> 00:40:10,290
and you<font color="#CCCCCC"> you know if you set up</font><font color="#E5E5E5"> your MX</font>

978
00:40:07,890 --> 00:40:13,200
record<font color="#CCCCCC"> 2.2</font><font color="#E5E5E5"> lace</font><font color="#CCCCCC"> male comm it will take</font>

979
00:40:10,290 --> 00:40:15,630
the message<font color="#CCCCCC"> what was</font><font color="#E5E5E5"> really fun was some</font>

980
00:40:13,200 --> 00:40:19,319
spammer I think was looking for open

981
00:40:15,630 --> 00:40:21,600
relays<font color="#E5E5E5"> SMB SMTP open relays and they</font>

982
00:40:19,320 --> 00:40:23,580
came<font color="#CCCCCC"> across this and they started to use</font>

983
00:40:21,600 --> 00:40:25,860
it<font color="#CCCCCC"> to send out their spam</font><font color="#E5E5E5"> but we're not</font>

984
00:40:23,580 --> 00:40:28,140
sending email we're just taking email so

985
00:40:25,860 --> 00:40:29,730
we<font color="#CCCCCC"> actually got</font><font color="#E5E5E5"> their entire spam list</font>

986
00:40:28,140 --> 00:40:31,319
it<font color="#E5E5E5"> was crazy they</font><font color="#CCCCCC"> set all of</font><font color="#E5E5E5"> their</font>

987
00:40:29,730 --> 00:40:33,090
different<font color="#E5E5E5"> emails that they sent out it</font>

988
00:40:31,320 --> 00:40:34,710
was wonderful<font color="#E5E5E5"> so I encourage you guys to</font>

989
00:40:33,090 --> 00:40:36,900
use<font color="#E5E5E5"> laced mail</font><font color="#CCCCCC"> comm you</font><font color="#E5E5E5"> know totally</font>

990
00:40:34,710 --> 00:40:39,780
free it's for us<font color="#E5E5E5"> you know</font><font color="#CCCCCC"> to do this</font>

991
00:40:36,900 --> 00:40:42,060
kind of stuff<font color="#CCCCCC"> alright</font><font color="#E5E5E5"> so we only have a</font>

992
00:40:39,780 --> 00:40:43,680
couple<font color="#E5E5E5"> minutes left</font><font color="#CCCCCC"> but there was a</font>

993
00:40:42,060 --> 00:40:45,720
couple of<font color="#E5E5E5"> other things</font><font color="#CCCCCC"> about exploit</font>

994
00:40:43,680 --> 00:40:47,549
kits<font color="#E5E5E5"> that</font><font color="#CCCCCC"> has been like</font><font color="#E5E5E5"> just sort of</font>

995
00:40:45,720 --> 00:40:49,799
like lingering<font color="#E5E5E5"> in the back of my mind</font>

996
00:40:47,550 --> 00:40:52,110
<font color="#CCCCCC">two</font><font color="#E5E5E5"> really quick things and I thought</font>

997
00:40:49,800 --> 00:40:55,020
why<font color="#CCCCCC"> not let</font><font color="#E5E5E5"> me tell you guys about them</font>

998
00:40:52,110 --> 00:40:57,930
so let's do<font color="#E5E5E5"> it so the first thing is</font>

999
00:40:55,020 --> 00:41:00,000
this<font color="#CCCCCC"> I've spent a lot</font><font color="#E5E5E5"> of time</font><font color="#CCCCCC"> looking</font><font color="#E5E5E5"> at</font>

1000
00:40:57,930 --> 00:41:03,330
the exploits that<font color="#E5E5E5"> are delivered</font><font color="#CCCCCC"> by</font>

1001
00:41:00,000 --> 00:41:05,070
exploit kits right I used<font color="#CCCCCC"> to care about</font>

1002
00:41:03,330 --> 00:41:06,529
this stuff a lot<font color="#E5E5E5"> they're heavily obvious</font>

1003
00:41:05,070 --> 00:41:09,000
gated so anybody<font color="#E5E5E5"> who's done this is</font>

1004
00:41:06,530 --> 00:41:11,460
appreciated this quite a<font color="#CCCCCC"> bit</font><font color="#E5E5E5"> but I spent</font>

1005
00:41:09,000 --> 00:41:13,370
time<font color="#E5E5E5"> div skating all of this</font><font color="#CCCCCC"> JavaScript</font>

1006
00:41:11,460 --> 00:41:16,020
and looking at it and actually

1007
00:41:13,370 --> 00:41:17,310
reconstructing the entire exploits that

1008
00:41:16,020 --> 00:41:19,259
<font color="#E5E5E5">they're using because</font><font color="#CCCCCC"> I want</font><font color="#E5E5E5"> to look at</font>

1009
00:41:17,310 --> 00:41:21,480
how<font color="#E5E5E5"> they're you</font><font color="#CCCCCC"> know what is</font><font color="#E5E5E5"> their</font><font color="#CCCCCC"> rap</font>

1010
00:41:19,260 --> 00:41:24,090
chain look like what does you know how

1011
00:41:21,480 --> 00:41:25,800
are they arranging the heap when they're

1012
00:41:24,090 --> 00:41:27,690
actually exploiting the browser what are

1013
00:41:25,800 --> 00:41:30,120
they doing<font color="#E5E5E5"> and so one really interesting</font>

1014
00:41:27,690 --> 00:41:32,910
thing<font color="#CCCCCC"> that I found was this</font>

1015
00:41:30,120 --> 00:41:34,859
this is the magic<font color="#CCCCCC"> address so if you know</font>

1016
00:41:32,910 --> 00:41:36,899
about<font color="#E5E5E5"> exploitation</font><font color="#CCCCCC"> you know in some</font>

1017
00:41:34,860 --> 00:41:39,570
cases<font color="#E5E5E5"> if you can do a heap spray or some</font>

1018
00:41:36,900 --> 00:41:42,300
sort of spray of data<font color="#E5E5E5"> there's a magic</font>

1019
00:41:39,570 --> 00:41:45,450
address that once you spray enough data

1020
00:41:42,300 --> 00:41:47,220
you can know that<font color="#E5E5E5"> reliably whatever</font>

1021
00:41:45,450 --> 00:41:49,080
object<font color="#E5E5E5"> that you're trying to place in</font>

1022
00:41:47,220 --> 00:41:51,480
<font color="#E5E5E5">memory it will be at this address in</font>

1023
00:41:49,080 --> 00:41:52,920
<font color="#E5E5E5">memory somewhere right so it's called</font>

1024
00:41:51,480 --> 00:41:54,840
<font color="#E5E5E5">the magic address it's just like people</font>

1025
00:41:52,920 --> 00:41:56,340
<font color="#CCCCCC">like run in a hundred</font><font color="#E5E5E5"> times and then</font>

1026
00:41:54,840 --> 00:41:58,530
whatever<font color="#E5E5E5"> address always has it they use</font>

1027
00:41:56,340 --> 00:41:59,970
it so there are published magic

1028
00:41:58,530 --> 00:42:01,320
addresses like everybody<font color="#E5E5E5"> knows people</font>

1029
00:41:59,970 --> 00:42:03,359
<font color="#CCCCCC">who write exploits know what</font><font color="#E5E5E5"> these</font>

1030
00:42:01,320 --> 00:42:06,600
addresses are there's articles talks

1031
00:42:03,360 --> 00:42:09,510
<font color="#E5E5E5">they outline it usually everybody uses</font>

1032
00:42:06,600 --> 00:42:11,580
the<font color="#CCCCCC"> same magic address well the one</font>

1033
00:42:09,510 --> 00:42:13,590
thing<font color="#E5E5E5"> that</font><font color="#CCCCCC"> I noticed that was sort of</font>

1034
00:42:11,580 --> 00:42:16,500
<font color="#E5E5E5">weird was that there was</font>

1035
00:42:13,590 --> 00:42:18,870
one or two exploits<font color="#CCCCCC"> that used this magic</font>

1036
00:42:16,500 --> 00:42:21,330
address<font color="#E5E5E5"> I've never seen this magic</font>

1037
00:42:18,870 --> 00:42:23,640
address used ever before and any exploit

1038
00:42:21,330 --> 00:42:25,770
<font color="#CCCCCC">that I've ever seen maybe you have but I</font>

1039
00:42:23,640 --> 00:42:28,020
have not<font color="#E5E5E5"> so I started to</font><font color="#CCCCCC"> think like</font><font color="#E5E5E5"> this</font>

1040
00:42:25,770 --> 00:42:29,880
could be<font color="#E5E5E5"> a really you know this could be</font>

1041
00:42:28,020 --> 00:42:32,820
<font color="#CCCCCC">sort of</font><font color="#E5E5E5"> an</font><font color="#CCCCCC"> interesting</font><font color="#E5E5E5"> way to track</font>

1042
00:42:29,880 --> 00:42:34,680
<font color="#E5E5E5">different actors right because I can</font>

1043
00:42:32,820 --> 00:42:36,170
know pretty reliably<font color="#CCCCCC"> that probably</font><font color="#E5E5E5"> the</font>

1044
00:42:34,680 --> 00:42:38,339
person<font color="#E5E5E5"> who wrote the first exploit is</font>

1045
00:42:36,170 --> 00:42:40,920
<font color="#E5E5E5">maybe this person</font><font color="#CCCCCC"> who wrote the second</font>

1046
00:42:38,340 --> 00:42:42,300
one and more at least know each other

1047
00:42:40,920 --> 00:42:44,370
because this is a very<font color="#E5E5E5"> unique value that</font>

1048
00:42:42,300 --> 00:42:46,650
<font color="#E5E5E5">no one else has picked so one little</font>

1049
00:42:44,370 --> 00:42:48,720
piece of tidbit information so if you

1050
00:42:46,650 --> 00:42:50,070
ever decide to<font color="#E5E5E5"> look into this note the</font>

1051
00:42:48,720 --> 00:42:53,790
magic address and see if maybe you<font color="#E5E5E5"> can</font>

1052
00:42:50,070 --> 00:42:56,580
tackle it and the last piece is this

1053
00:42:53,790 --> 00:42:59,850
piece<font color="#CCCCCC"> so after you do one of these big</font>

1054
00:42:56,580 --> 00:43:01,350
sprays and you<font color="#E5E5E5"> overwrite a lot of times</font>

1055
00:42:59,850 --> 00:43:03,480
what<font color="#E5E5E5"> you're trying to do is overwrite an</font>

1056
00:43:01,350 --> 00:43:13,200
array object in memory<font color="#E5E5E5"> and when you</font>

1057
00:43:03,480 --> 00:43:15,270
overload it is that the array objects

1058
00:43:13,200 --> 00:43:16,740
length<font color="#E5E5E5"> field is different and then what</font>

1059
00:43:15,270 --> 00:43:18,570
you said so you overwrite the length

1060
00:43:16,740 --> 00:43:21,479
field<font color="#E5E5E5"> and then you find it somewhere in</font>

1061
00:43:18,570 --> 00:43:24,780
memory<font color="#E5E5E5"> so once you find the array object</font>

1062
00:43:21,480 --> 00:43:26,370
you sort of<font color="#E5E5E5"> know it's you know</font><font color="#CCCCCC"> you sort</font>

1063
00:43:24,780 --> 00:43:28,110
<font color="#E5E5E5">of know that you found the right one</font>

1064
00:43:26,370 --> 00:43:30,270
<font color="#E5E5E5">because it's the only</font><font color="#CCCCCC"> one</font><font color="#E5E5E5"> with a</font>

1065
00:43:28,110 --> 00:43:33,180
<font color="#E5E5E5">different length field right for</font>

1066
00:43:30,270 --> 00:43:35,640
whatever reason this author decided<font color="#E5E5E5"> to</font>

1067
00:43:33,180 --> 00:43:38,819
include<font color="#E5E5E5"> this</font><font color="#CCCCCC"> additional check within</font>

1068
00:43:35,640 --> 00:43:42,870
<font color="#E5E5E5">their exploits where they actually</font><font color="#CCCCCC"> write</font>

1069
00:43:38,820 --> 00:43:44,970
decode the hex of decode into memory and

1070
00:43:42,870 --> 00:43:46,799
<font color="#E5E5E5">then</font><font color="#CCCCCC"> read it</font><font color="#E5E5E5"> back to confirm</font><font color="#CCCCCC"> that</font>

1071
00:43:44,970 --> 00:43:49,259
<font color="#E5E5E5">they're at the right array object it's</font>

1072
00:43:46,800 --> 00:43:51,090
totally unnecessary<font color="#CCCCCC"> but for some reason</font>

1073
00:43:49,260 --> 00:43:53,700
<font color="#E5E5E5">these</font><font color="#CCCCCC"> guys decided to do it so another</font>

1074
00:43:51,090 --> 00:43:56,910
<font color="#E5E5E5">interesting tidbit</font><font color="#CCCCCC"> to follow up</font><font color="#E5E5E5"> all</font>

1075
00:43:53,700 --> 00:43:59,370
right so<font color="#CCCCCC"> just to</font><font color="#E5E5E5"> recap wait</font><font color="#CCCCCC"> I'm on</font><font color="#E5E5E5"> the</font>

1076
00:43:56,910 --> 00:44:01,680
right<font color="#E5E5E5"> side see Homer</font><font color="#CCCCCC"> alright good</font><font color="#E5E5E5"> so</font>

1077
00:43:59,370 --> 00:44:04,920
just as a quick<font color="#CCCCCC"> final</font><font color="#E5E5E5"> recap I hope you</font>

1078
00:44:01,680 --> 00:44:08,490
guys enjoyed all<font color="#CCCCCC"> of Matt's work he is an</font>

1079
00:44:04,920 --> 00:44:12,330
intern<font color="#CCCCCC"> and hopefully will</font><font color="#E5E5E5"> work for us</font>

1080
00:44:08,490 --> 00:44:13,529
<font color="#E5E5E5">one day</font><font color="#CCCCCC"> you can a couple of</font><font color="#E5E5E5"> things one</font><font color="#CCCCCC"> I</font>

1081
00:44:12,330 --> 00:44:15,660
<font color="#CCCCCC">we encourage you guys to</font><font color="#E5E5E5"> roll your own</font>

1082
00:44:13,530 --> 00:44:16,950
scraper<font color="#CCCCCC"> a proxy totally doable there's</font>

1083
00:44:15,660 --> 00:44:19,440
lots of good way easy ways to<font color="#E5E5E5"> do</font><font color="#CCCCCC"> it</font>

1084
00:44:16,950 --> 00:44:21,359
learn<font color="#E5E5E5"> from our experiences and</font><font color="#CCCCCC"> hopefully</font>

1085
00:44:19,440 --> 00:44:23,730
you'll be<font color="#CCCCCC"> able to do some</font><font color="#E5E5E5"> good stuff</font><font color="#CCCCCC"> if</font>

1086
00:44:21,360 --> 00:44:26,220
you are<font color="#E5E5E5"> finding bad</font><font color="#CCCCCC"> exploit kit stuff</font>

1087
00:44:23,730 --> 00:44:27,030
make<font color="#E5E5E5"> sure you think</font><font color="#CCCCCC"> about how</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> amplify</font>

1088
00:44:26,220 --> 00:44:28,560
that<font color="#E5E5E5"> how do</font>

1089
00:44:27,030 --> 00:44:30,780
you pivot<font color="#E5E5E5"> off of</font><font color="#CCCCCC"> a piece of information</font>

1090
00:44:28,560 --> 00:44:33,029
and use it<font color="#CCCCCC"> to find</font><font color="#E5E5E5"> more information</font>

1091
00:44:30,780 --> 00:44:35,040
<font color="#E5E5E5">because these exploit kits are really</font>

1092
00:44:33,030 --> 00:44:36,180
integrated that's a network<font color="#E5E5E5"> right</font>

1093
00:44:35,040 --> 00:44:37,650
there's a whole network<font color="#E5E5E5"> that's</font>

1094
00:44:36,180 --> 00:44:39,180
associated with this thing<font color="#E5E5E5"> and if you</font>

1095
00:44:37,650 --> 00:44:40,800
<font color="#E5E5E5">find one piece you can find a lot</font><font color="#CCCCCC"> more</font>

1096
00:44:39,180 --> 00:44:42,720
so make sure you<font color="#E5E5E5"> think about that when</font>

1097
00:44:40,800 --> 00:44:45,180
you're<font color="#E5E5E5"> dealing with your exploit stuff</font>

1098
00:44:42,720 --> 00:44:48,839
and<font color="#E5E5E5"> doing your research</font><font color="#CCCCCC"> bad guys make</font>

1099
00:44:45,180 --> 00:44:51,600
<font color="#CCCCCC">mistakes too</font><font color="#E5E5E5"> maybe you could benefit off</font>

1100
00:44:48,840 --> 00:44:54,930
<font color="#CCCCCC">of that</font><font color="#E5E5E5"> so I'm saying</font><font color="#CCCCCC"> and the last thing</font>

1101
00:44:51,600 --> 00:44:56,279
is is disposable<font color="#E5E5E5"> mailboxes can actually</font>

1102
00:44:54,930 --> 00:44:59,040
be<font color="#E5E5E5"> used for research and</font><font color="#CCCCCC"> they</font><font color="#E5E5E5"> could be a</font>

1103
00:44:56,280 --> 00:45:01,770
<font color="#E5E5E5">good nice fun way</font><font color="#CCCCCC"> to find new</font><font color="#E5E5E5"> samples</font>

1104
00:44:59,040 --> 00:45:03,360
<font color="#E5E5E5">all right that's everything if you have</font>

1105
00:45:01,770 --> 00:45:10,280
any questions please go up to the mics

1106
00:45:03,360 --> 00:45:10,280
[Applause]

