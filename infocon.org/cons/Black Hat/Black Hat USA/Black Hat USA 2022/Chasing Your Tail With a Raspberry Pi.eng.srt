1
00:00:01,700 --> 00:00:04,810
[Music]

2
00:00:07,220 --> 00:00:09,599
it's Thursday afternoon I thought

3
00:00:09,599 --> 00:00:12,540
there'd be like 30 of you

4
00:00:12,540 --> 00:00:14,519
but they mic'd me up because if I had to

5
00:00:14,519 --> 00:00:15,960
stand there for half an hour straight I

6
00:00:15,960 --> 00:00:18,720
would explode I uh

7
00:00:18,720 --> 00:00:20,340
I've given a lot of different conference

8
00:00:20,340 --> 00:00:22,080
talks and I've never started off with

9
00:00:22,080 --> 00:00:24,240
the whole hey here's my motivation for

10
00:00:24,240 --> 00:00:25,800
doing it why I made this talk I'm always

11
00:00:25,800 --> 00:00:27,480
like who cares right here's the talk

12
00:00:27,480 --> 00:00:29,640
here's what I want to talk about

13
00:00:29,640 --> 00:00:32,279
so indulge me for one second while I

14
00:00:32,279 --> 00:00:34,320
actually do that this time

15
00:00:34,320 --> 00:00:36,239
and the reason is is because this time

16
00:00:36,239 --> 00:00:38,820
it actually matters and what happened is

17
00:00:38,820 --> 00:00:41,100
a buddy of mine reached out last year

18
00:00:41,100 --> 00:00:44,399
late last year and he said he needed to

19
00:00:44,399 --> 00:00:45,780
get together and talk with me about a

20
00:00:45,780 --> 00:00:47,399
Wi-Fi question he works with a

21
00:00:47,399 --> 00:00:49,260
government agency that I won't name I

22
00:00:49,260 --> 00:00:50,820
had a good idea of what he wanted to ask

23
00:00:50,820 --> 00:00:52,920
and he turns out I was horribly wrong as

24
00:00:52,920 --> 00:00:55,199
usual

25
00:00:55,199 --> 00:00:56,820
and what he wanted to talk about was

26
00:00:56,820 --> 00:01:00,239
this he had a confidential informant and

27
00:01:00,239 --> 00:01:03,000
This Confidential informant had ties to

28
00:01:03,000 --> 00:01:05,159
a like nation-state terrorist group

29
00:01:05,159 --> 00:01:07,439
right I won't name the group but a very

30
00:01:07,439 --> 00:01:10,979
very serious group and my friend he

31
00:01:10,979 --> 00:01:12,420
wasn't worried for his own physical

32
00:01:12,420 --> 00:01:14,159
safety or anything figures he can take

33
00:01:14,159 --> 00:01:16,500
care of himself he was worried about the

34
00:01:16,500 --> 00:01:18,180
safety of his informant and what he was

35
00:01:18,180 --> 00:01:20,520
worried about was if I'm meeting with

36
00:01:20,520 --> 00:01:22,200
this individual

37
00:01:22,200 --> 00:01:24,420
and someone follows me as I'm driving

38
00:01:24,420 --> 00:01:25,380
away

39
00:01:25,380 --> 00:01:27,119
and they keep following me and they

40
00:01:27,119 --> 00:01:29,460
figure out where I work

41
00:01:29,460 --> 00:01:31,020
they're going to go back and harm this

42
00:01:31,020 --> 00:01:32,520
individual right it won't be good for

43
00:01:32,520 --> 00:01:33,960
them so they weren't concerned with

44
00:01:33,960 --> 00:01:35,759
their own physical safety they were

45
00:01:35,759 --> 00:01:37,020
concerned with the physical safety of

46
00:01:37,020 --> 00:01:38,939
this person who was providing the

47
00:01:38,939 --> 00:01:41,040
information

48
00:01:41,040 --> 00:01:43,500
and so I'm like wow and what it was was

49
00:01:43,500 --> 00:01:45,119
a couple years earlier they had heard me

50
00:01:45,119 --> 00:01:46,619
talk about the possibility of maybe

51
00:01:46,619 --> 00:01:48,420
using Wireless to tell if you were being

52
00:01:48,420 --> 00:01:50,579
followed in a methodology that I'll talk

53
00:01:50,579 --> 00:01:52,799
about in just a second and so they said

54
00:01:52,799 --> 00:01:54,479
that they went to their tech people they

55
00:01:54,479 --> 00:01:55,920
didn't have anything

56
00:01:55,920 --> 00:01:59,460
so he came to me and I kind of uh didn't

57
00:01:59,460 --> 00:02:00,899
want to reinvent the wheel I told him

58
00:02:00,899 --> 00:02:02,220
yeah you know what let me take a look

59
00:02:02,220 --> 00:02:03,720
and if not maybe I can make you

60
00:02:03,720 --> 00:02:04,680
something

61
00:02:04,680 --> 00:02:06,719
and I started doing research trying to

62
00:02:06,719 --> 00:02:08,340
find out if there was anything like this

63
00:02:08,340 --> 00:02:10,280
and I just really couldn't find anything

64
00:02:10,280 --> 00:02:13,080
and that really kind of was depressing

65
00:02:13,080 --> 00:02:14,459
to me because

66
00:02:14,459 --> 00:02:17,580
there's so much technology out there to

67
00:02:17,580 --> 00:02:20,160
stock on people and invade their privacy

68
00:02:20,160 --> 00:02:22,140
and there's so little to try to help

69
00:02:22,140 --> 00:02:24,239
people that are in that situation right

70
00:02:24,239 --> 00:02:26,040
it's really kind of depressing and

71
00:02:26,040 --> 00:02:27,840
someone very close to me has dealt with

72
00:02:27,840 --> 00:02:29,760
the stocking issue and it's just

73
00:02:29,760 --> 00:02:31,379
devastating right you just never get

74
00:02:31,379 --> 00:02:32,879
that mental piece it's a very very

75
00:02:32,879 --> 00:02:35,340
difficult situation so I kind of thought

76
00:02:35,340 --> 00:02:36,660
about it for a little bit and thought

77
00:02:36,660 --> 00:02:38,879
well I don't really see a way this can

78
00:02:38,879 --> 00:02:40,739
be abused right it's really only

79
00:02:40,739 --> 00:02:42,300
designed to try to tell if you're being

80
00:02:42,300 --> 00:02:44,040
followed not to help follow someone else

81
00:02:44,040 --> 00:02:46,440
so let's give it a go right and that's

82
00:02:46,440 --> 00:02:48,780
kind of the background for this

83
00:02:48,780 --> 00:02:50,940
this is a room full of technical people

84
00:02:50,940 --> 00:02:53,940
if I say SDR most of us kind of think

85
00:02:53,940 --> 00:02:56,459
right software-defined radio hack RF

86
00:02:56,459 --> 00:02:59,640
something like that but the original SDR

87
00:02:59,640 --> 00:03:01,500
right surveillance detection route

88
00:03:01,500 --> 00:03:02,940
things that a lot of them are fairly

89
00:03:02,940 --> 00:03:06,120
Common Sense changing lanes right seeing

90
00:03:06,120 --> 00:03:08,340
who changes Lanes behind you getting off

91
00:03:08,340 --> 00:03:10,500
the freeway getting right back on seeing

92
00:03:10,500 --> 00:03:12,060
who exited off who's getting right back

93
00:03:12,060 --> 00:03:13,739
on behind you certain things like that

94
00:03:13,739 --> 00:03:15,900
anyone who's ever played in that space

95
00:03:15,900 --> 00:03:18,540
and lived in Washington DC the reason I

96
00:03:18,540 --> 00:03:20,400
chose this map it's really obvious that

97
00:03:20,400 --> 00:03:22,620
the Beltway is designed to be one giant

98
00:03:22,620 --> 00:03:24,420
surveillance detection around right

99
00:03:24,420 --> 00:03:26,580
that's kind of why one of the reasons I

100
00:03:26,580 --> 00:03:28,140
think it's laid out the way that it is

101
00:03:28,140 --> 00:03:31,739
and he was using this tradecraft he just

102
00:03:31,739 --> 00:03:33,420
wanted a little technical assistance

103
00:03:33,420 --> 00:03:35,159
with it

104
00:03:35,159 --> 00:03:37,379
and the methodology he'd heard me speak

105
00:03:37,379 --> 00:03:40,500
about years earlier was listen

106
00:03:40,500 --> 00:03:44,340
I understand that tradecraft as well but

107
00:03:44,340 --> 00:03:45,840
if you really want to tell if you're

108
00:03:45,840 --> 00:03:48,120
being followed maybe also think of

109
00:03:48,120 --> 00:03:49,500
something like this

110
00:03:49,500 --> 00:03:52,620
go to Starbucks to grab a drink

111
00:03:52,620 --> 00:03:54,959
then go somewhere else

112
00:03:54,959 --> 00:03:57,659
and then go somewhere else

113
00:03:57,659 --> 00:04:02,159
and now sits there and see did I see any

114
00:04:02,159 --> 00:04:04,799
devices at all three locations right

115
00:04:04,799 --> 00:04:06,780
because think about it

116
00:04:06,780 --> 00:04:09,480
even a nation-state quality surveillance

117
00:04:09,480 --> 00:04:12,060
team with a very very good trade craft

118
00:04:12,060 --> 00:04:14,459
very very good equipment

119
00:04:14,459 --> 00:04:17,579
who knows what they're doing

120
00:04:17,579 --> 00:04:19,139
isn't there still a really good chance

121
00:04:19,139 --> 00:04:21,600
that they have a phone in their pocket

122
00:04:21,600 --> 00:04:23,639
right or one in the car

123
00:04:23,639 --> 00:04:25,440
you know maybe the airpods a Bluetooth

124
00:04:25,440 --> 00:04:28,259
headset right something synced up to the

125
00:04:28,259 --> 00:04:30,780
car right and if you're connected to a

126
00:04:30,780 --> 00:04:34,139
network great I can see the MAC address

127
00:04:34,139 --> 00:04:35,759
and if you're not connected to the

128
00:04:35,759 --> 00:04:37,560
network even better

129
00:04:37,560 --> 00:04:39,840
because the odds are right most people

130
00:04:39,840 --> 00:04:41,580
don't shut off their Wi-Fi unless you're

131
00:04:41,580 --> 00:04:43,500
coming to a hacking conference in which

132
00:04:43,500 --> 00:04:45,840
case it should absolutely be shut off

133
00:04:45,840 --> 00:04:47,220
right you know you're coming to black

134
00:04:47,220 --> 00:04:49,199
hat Defcon yet shut off it stays off

135
00:04:49,199 --> 00:04:51,060
pretty much the entire week

136
00:04:51,060 --> 00:04:52,560
but when most people are just kind of

137
00:04:52,560 --> 00:04:54,900
living their daily lives that's on right

138
00:04:54,900 --> 00:04:56,820
and what are our phones doing they're

139
00:04:56,820 --> 00:04:58,020
sitting there looking for wireless

140
00:04:58,020 --> 00:04:59,580
networks where we've connected to

141
00:04:59,580 --> 00:05:01,860
historically and that in and of itself

142
00:05:01,860 --> 00:05:04,740
can become a signature right am I seeing

143
00:05:04,740 --> 00:05:07,380
something right now

144
00:05:07,380 --> 00:05:09,780
but I also saw five to ten minutes ago

145
00:05:09,780 --> 00:05:11,880
10 to 15 minutes ago all the way down

146
00:05:11,880 --> 00:05:13,740
the line and that's the methodology that

147
00:05:13,740 --> 00:05:15,540
we were going for here

148
00:05:15,540 --> 00:05:18,060
and so to do this we wanted to keep it

149
00:05:18,060 --> 00:05:20,220
completely passive right we're just

150
00:05:20,220 --> 00:05:22,440
passively trying to detect Wi-Fi and

151
00:05:22,440 --> 00:05:24,539
Bluetooth devices that we observe around

152
00:05:24,539 --> 00:05:26,520
us and it really doesn't matter if

153
00:05:26,520 --> 00:05:28,259
they're part of an active connection or

154
00:05:28,259 --> 00:05:30,060
not it'll work either way there's a

155
00:05:30,060 --> 00:05:31,020
little bit of a difference in the

156
00:05:31,020 --> 00:05:33,900
methodology we'll talk about that

157
00:05:33,900 --> 00:05:36,300
for Hardware I didn't want to go buy

158
00:05:36,300 --> 00:05:37,860
anything I ended up buying like a little

159
00:05:37,860 --> 00:05:40,320
bit this is very very cheap it's things

160
00:05:40,320 --> 00:05:42,240
like seriously how many of us have

161
00:05:42,240 --> 00:05:44,759
multiple raspberry pies sitting in the

162
00:05:44,759 --> 00:05:47,580
closet doing absolutely nothing right

163
00:05:47,580 --> 00:05:50,280
absolutely nothing yeah I used a

164
00:05:50,280 --> 00:05:52,800
Raspberry Pi B for this not a 3B like

165
00:05:52,800 --> 00:05:54,600
not that there was any reason to I just

166
00:05:54,600 --> 00:05:56,520
have like three of them in my closet for

167
00:05:56,520 --> 00:05:58,440
some weird reason

168
00:05:58,440 --> 00:06:00,180
and so a lot of these are things that a

169
00:06:00,180 --> 00:06:02,160
lot of us probably have laying around or

170
00:06:02,160 --> 00:06:04,199
can get very very cheap first off

171
00:06:04,199 --> 00:06:06,539
Raspberry Pi there are multiple versions

172
00:06:06,539 --> 00:06:08,220
of these I could have used normally

173
00:06:08,220 --> 00:06:10,440
these are about 35 dollars but right now

174
00:06:10,440 --> 00:06:12,780
there's a really really lame shortage

175
00:06:12,780 --> 00:06:14,759
they're going for like 120 quite a bit

176
00:06:14,759 --> 00:06:16,740
more but like I said I think a lot of us

177
00:06:16,740 --> 00:06:18,720
have this or something very very similar

178
00:06:18,720 --> 00:06:21,240
laying around

179
00:06:21,240 --> 00:06:23,340
for a wireless card I had a bunch of

180
00:06:23,340 --> 00:06:25,740
alpha cards but I went to the akismet

181
00:06:25,740 --> 00:06:27,840
Discord and asked the community there

182
00:06:27,840 --> 00:06:29,699
what the general consensus was the

183
00:06:29,699 --> 00:06:32,280
current uh kind of the best wireless

184
00:06:32,280 --> 00:06:34,199
card that a lot of people were using and

185
00:06:34,199 --> 00:06:36,240
this was the alpha card that a lot of

186
00:06:36,240 --> 00:06:38,220
people recommended the slides will be

187
00:06:38,220 --> 00:06:39,960
available online they might be today

188
00:06:39,960 --> 00:06:41,699
already so they'll be out there on the

189
00:06:41,699 --> 00:06:43,800
black hat site so if you want to see any

190
00:06:43,800 --> 00:06:46,940
of these specific items

191
00:06:47,880 --> 00:06:50,100
for a battery pack once again I had

192
00:06:50,100 --> 00:06:51,360
several of them just kind of laying

193
00:06:51,360 --> 00:06:52,500
around in my closet that had been

194
00:06:52,500 --> 00:06:54,900
giveaways from other places or anchors

195
00:06:54,900 --> 00:06:56,759
that I had gotten very very cheap on

196
00:06:56,759 --> 00:06:59,900
Amazon over the years

197
00:07:00,259 --> 00:07:03,539
needed a display because in a few slides

198
00:07:03,539 --> 00:07:05,220
you're going to see literally the worst

199
00:07:05,220 --> 00:07:07,860
user interface you have ever seen right

200
00:07:07,860 --> 00:07:10,319
I mean it's you're like ah it's not that

201
00:07:10,319 --> 00:07:13,500
bad oh yeah wait for it but wait for it

202
00:07:13,500 --> 00:07:14,699
it's probably the highlight of the talk

203
00:07:14,699 --> 00:07:17,039
if I'm being honest

204
00:07:17,039 --> 00:07:19,020
but if you think about it right you have

205
00:07:19,020 --> 00:07:20,699
this little device you're going to be

206
00:07:20,699 --> 00:07:22,259
like driving down the road in this

207
00:07:22,259 --> 00:07:23,819
situation right you need some type of

208
00:07:23,819 --> 00:07:25,440
feedback and so a little screen on a

209
00:07:25,440 --> 00:07:28,919
Raspberry Pi that was I think like 25 on

210
00:07:28,919 --> 00:07:30,479
Amazon I didn't have one of those laying

211
00:07:30,479 --> 00:07:32,639
around so that was the one thing that I

212
00:07:32,639 --> 00:07:35,539
actually had to buy

213
00:07:36,720 --> 00:07:38,759
and for a software for the base for

214
00:07:38,759 --> 00:07:40,620
actually handling the wireless signals

215
00:07:40,620 --> 00:07:42,599
the Bluetooth signals and whatever else

216
00:07:42,599 --> 00:07:44,220
we want to expand it on into the future

217
00:07:44,220 --> 00:07:46,380
we actually use Kismet right and if

218
00:07:46,380 --> 00:07:48,000
you've never played with Kismet Kismet

219
00:07:48,000 --> 00:07:51,060
is amazing it is a free tool it

220
00:07:51,060 --> 00:07:52,740
basically just sniffs all the wireless

221
00:07:52,740 --> 00:07:54,539
that you can find right the reason why

222
00:07:54,539 --> 00:07:56,639
you want to use an external wireless

223
00:07:56,639 --> 00:07:58,740
card is so you can put it into a monitor

224
00:07:58,740 --> 00:08:00,840
mode you can basically just tell it like

225
00:08:00,840 --> 00:08:01,680
listen

226
00:08:01,680 --> 00:08:04,139
don't try to connect to anything you've

227
00:08:04,139 --> 00:08:06,419
been working really really hard lately

228
00:08:06,419 --> 00:08:09,960
just take a few minutes relax sit back

229
00:08:09,960 --> 00:08:11,340
and just kind of see what's floating

230
00:08:11,340 --> 00:08:12,960
through the air right you basically turn

231
00:08:12,960 --> 00:08:18,318
your wireless card into a pothead and so

232
00:08:18,660 --> 00:08:20,639
Kismet very very good at putting the

233
00:08:20,639 --> 00:08:23,460
Wi-Fi card into that mode it supports

234
00:08:23,460 --> 00:08:25,919
Wi-Fi Bluetooth a lot of different types

235
00:08:25,919 --> 00:08:27,479
of signals like I said there's a lot of

236
00:08:27,479 --> 00:08:29,639
capability to expand this in the Future

237
00:08:29,639 --> 00:08:30,960
No Doubt

238
00:08:30,960 --> 00:08:33,419
and one really really nice thing is it

239
00:08:33,419 --> 00:08:35,339
writes all that data to a sqlite

240
00:08:35,339 --> 00:08:36,719
database that's what we're going to

241
00:08:36,719 --> 00:08:38,159
actually use and try to pull the live

242
00:08:38,159 --> 00:08:40,500
real-time data from it's got separate

243
00:08:40,500 --> 00:08:43,200
options like uh generating a pcap other

244
00:08:43,200 --> 00:08:45,480
formats but there's really no need to

245
00:08:45,480 --> 00:08:47,040
because you can generate those from the

246
00:08:47,040 --> 00:08:48,540
database so you don't want to generate

247
00:08:48,540 --> 00:08:50,399
those live because all you're doing is

248
00:08:50,399 --> 00:08:52,500
wasting computational effort for no

249
00:08:52,500 --> 00:08:54,680
reason

250
00:08:55,100 --> 00:08:57,959
everything else is shoddy python code

251
00:08:57,959 --> 00:09:00,000
right it's a couple of tiny batch

252
00:09:00,000 --> 00:09:02,700
scripts and just very very ugly python

253
00:09:02,700 --> 00:09:04,800
code if you ever want to feel better

254
00:09:04,800 --> 00:09:07,260
about your coding capability just go to

255
00:09:07,260 --> 00:09:10,680
my GitHub I promise like two of my

256
00:09:10,680 --> 00:09:12,720
projects somehow made it into the Arctic

257
00:09:12,720 --> 00:09:14,700
code Vault so it's nice to know that

258
00:09:14,700 --> 00:09:16,440
like thousands of years after I'm dead

259
00:09:16,440 --> 00:09:20,540
my shoddy code will live on somewhere

260
00:09:20,880 --> 00:09:22,560
but seriously right when you're going to

261
00:09:22,560 --> 00:09:25,019
start to release a project like this and

262
00:09:25,019 --> 00:09:26,820
you start to think about

263
00:09:26,820 --> 00:09:29,600
putting it up a black hat

264
00:09:29,600 --> 00:09:32,160
imposter syndrome is real

265
00:09:32,160 --> 00:09:36,600
it it absolutely is it is very very real

266
00:09:36,600 --> 00:09:38,339
and so you just kind of tell yourself

267
00:09:38,339 --> 00:09:40,860
and remind yourself right that

268
00:09:40,860 --> 00:09:42,779
you know don't let perfect be the enemy

269
00:09:42,779 --> 00:09:44,220
of good right just because something

270
00:09:44,220 --> 00:09:46,140
isn't perfect just because something has

271
00:09:46,140 --> 00:09:48,480
doesn't have faults

272
00:09:48,480 --> 00:09:50,160
doesn't mean that it's not worth doing

273
00:09:50,160 --> 00:09:52,140
and I think that's really one of the uh

274
00:09:52,140 --> 00:09:54,060
kind of the core things to remember with

275
00:09:54,060 --> 00:09:55,860
pretty much anything in security or

276
00:09:55,860 --> 00:09:57,300
pretty much anything in life if I'm

277
00:09:57,300 --> 00:09:59,399
being perfectly honest that gentleman

278
00:09:59,399 --> 00:10:03,000
the Robert Watson Watt he was the uh he

279
00:10:03,000 --> 00:10:04,380
was one of the people who made a lot of

280
00:10:04,380 --> 00:10:06,899
advancements in radar he was just kind

281
00:10:06,899 --> 00:10:09,360
of a tasked with defending uh London

282
00:10:09,360 --> 00:10:12,060
during World War II from the German Air

283
00:10:12,060 --> 00:10:14,040
Raids and you know give him the third

284
00:10:14,040 --> 00:10:15,959
best to go with the second best comes

285
00:10:15,959 --> 00:10:18,540
too late and the best never comes and so

286
00:10:18,540 --> 00:10:19,980
yeah if anything right if you take

287
00:10:19,980 --> 00:10:22,440
anything from this talk

288
00:10:22,440 --> 00:10:24,660
you know don't be self-conscious like I

289
00:10:24,660 --> 00:10:27,300
push my shoddy python code out there on

290
00:10:27,300 --> 00:10:30,839
a regular basis and I would never insult

291
00:10:30,839 --> 00:10:33,240
a real programmer by calling myself a

292
00:10:33,240 --> 00:10:35,160
programmer but I can write ugly

293
00:10:35,160 --> 00:10:37,019
functional code that helps me and helps

294
00:10:37,019 --> 00:10:40,580
my teammates and I'm cool with that

295
00:10:41,279 --> 00:10:44,399
by default right I have Kismet set up to

296
00:10:44,399 --> 00:10:45,300
start

297
00:10:45,300 --> 00:10:47,700
when the Raspberry Pi Powers up I just

298
00:10:47,700 --> 00:10:49,380
give it like a little 30 second delay to

299
00:10:49,380 --> 00:10:51,600
let everything else get into place but

300
00:10:51,600 --> 00:10:53,640
then by default once you start Kismet up

301
00:10:53,640 --> 00:10:56,579
it automatically starts sniffing and

302
00:10:56,579 --> 00:10:58,019
seeing everything that you've set it up

303
00:10:58,019 --> 00:10:59,880
to keep an eye out for and putting it

304
00:10:59,880 --> 00:11:02,519
into a sqlite database it names the

305
00:11:02,519 --> 00:11:05,160
database the name of a file with a DOT

306
00:11:05,160 --> 00:11:08,760
Kismet extension but it's sqlite and so

307
00:11:08,760 --> 00:11:11,220
what you can do is you can just have the

308
00:11:11,220 --> 00:11:12,600
date

309
00:11:12,600 --> 00:11:15,480
the current date and time be the file

310
00:11:15,480 --> 00:11:17,040
name of that file

311
00:11:17,040 --> 00:11:18,660
and you just have it constantly go to

312
00:11:18,660 --> 00:11:20,880
the same directory and then the python

313
00:11:20,880 --> 00:11:23,880
code once the python code runs all it

314
00:11:23,880 --> 00:11:25,500
does is go look in that directory and

315
00:11:25,500 --> 00:11:27,240
grab the newest file and so that way

316
00:11:27,240 --> 00:11:29,519
you're always getting the live data and

317
00:11:29,519 --> 00:11:31,019
you just pull the power out doesn't

318
00:11:31,019 --> 00:11:33,779
matter goes away you plug it in power it

319
00:11:33,779 --> 00:11:36,240
up it's automatically within a minute up

320
00:11:36,240 --> 00:11:38,040
and sniffing and monitoring and doing

321
00:11:38,040 --> 00:11:40,579
its thing

322
00:11:41,760 --> 00:11:43,860
I did need to slightly change my

323
00:11:43,860 --> 00:11:46,200
methodology the original way when he had

324
00:11:46,200 --> 00:11:47,940
heard me speak about it years ago but

325
00:11:47,940 --> 00:11:50,519
not actually implement it was thinking

326
00:11:50,519 --> 00:11:52,680
about well we go to location one then we

327
00:11:52,680 --> 00:11:54,959
go to location two then we go to

328
00:11:54,959 --> 00:11:56,459
location three

329
00:11:56,459 --> 00:12:00,120
that doesn't really work very well

330
00:12:00,120 --> 00:12:02,100
when you're driving for long periods of

331
00:12:02,100 --> 00:12:04,019
time right you're going to be driving

332
00:12:04,019 --> 00:12:05,940
down the highway for half an hour or an

333
00:12:05,940 --> 00:12:08,399
hour or more that methodology really

334
00:12:08,399 --> 00:12:10,680
doesn't type of fit and so what we ended

335
00:12:10,680 --> 00:12:13,140
up doing was just going with a temporal

336
00:12:13,140 --> 00:12:15,899
based right just going off time do I see

337
00:12:15,899 --> 00:12:18,180
any devices right now that I also saw

338
00:12:18,180 --> 00:12:21,540
five ten minutes ago 10 to 15 minutes

339
00:12:21,540 --> 00:12:26,459
ago or 15 to 20 minutes ago if so

340
00:12:26,459 --> 00:12:29,100
let me know the device type it was was

341
00:12:29,100 --> 00:12:31,260
it Bluetooth is it a Wi-Fi client Wi-Fi

342
00:12:31,260 --> 00:12:32,940
access point right

343
00:12:32,940 --> 00:12:35,459
let me know the MAC address and let me

344
00:12:35,459 --> 00:12:37,320
know what time frame that I previously

345
00:12:37,320 --> 00:12:38,459
saw it in

346
00:12:38,459 --> 00:12:39,959
and if you're thinking well this is easy

347
00:12:39,959 --> 00:12:41,940
right that's just a SQL query what did I

348
00:12:41,940 --> 00:12:44,760
see in the past minute that I also saw

349
00:12:44,760 --> 00:12:47,040
during these previous times it's

350
00:12:47,040 --> 00:12:48,779
actually right the first snag and there

351
00:12:48,779 --> 00:12:50,880
was a solution but the snag is this in

352
00:12:50,880 --> 00:12:53,279
that Kismet database all the data you

353
00:12:53,279 --> 00:12:56,040
could want is contained but most of it

354
00:12:56,040 --> 00:12:58,380
is in these like Json blobs and you

355
00:12:58,380 --> 00:13:00,420
can't parse them but that starts to get

356
00:13:00,420 --> 00:13:02,639
very very heavy on a very low powered

357
00:13:02,639 --> 00:13:04,740
device right and you're already pulling

358
00:13:04,740 --> 00:13:06,480
data from a sqlite database that's

359
00:13:06,480 --> 00:13:09,000
actively having data being written to it

360
00:13:09,000 --> 00:13:10,740
and it works I've never had any issues

361
00:13:10,740 --> 00:13:12,899
but I realized that is also a recipe for

362
00:13:12,899 --> 00:13:15,660
hijinks and you want to kind of be as uh

363
00:13:15,660 --> 00:13:18,899
as gentle on that database as possible

364
00:13:18,899 --> 00:13:21,000
and in the database itself in the fields

365
00:13:21,000 --> 00:13:22,620
that are parsed and normalized it has

366
00:13:22,620 --> 00:13:24,180
the first time that it has seen a device

367
00:13:24,180 --> 00:13:26,220
and it has the last time that it's seen

368
00:13:26,220 --> 00:13:28,440
a device but it doesn't have any times

369
00:13:28,440 --> 00:13:30,180
in between those right and so trying to

370
00:13:30,180 --> 00:13:32,040
figure out well what do we see five to

371
00:13:32,040 --> 00:13:34,740
ten minutes ago 10 to 15 Etc

372
00:13:34,740 --> 00:13:36,420
doesn't really fit with what we have in

373
00:13:36,420 --> 00:13:38,820
the database and so the solution and I'm

374
00:13:38,820 --> 00:13:40,620
not saying there's not other ways to do

375
00:13:40,620 --> 00:13:43,980
this but what I did is I create lists

376
00:13:43,980 --> 00:13:46,019
right when this starts up automatically

377
00:13:46,019 --> 00:13:48,899
it it makes a list of devices that it

378
00:13:48,899 --> 00:13:51,540
saw five to ten minutes ago 10 to 15 15

379
00:13:51,540 --> 00:13:52,980
to 20.

380
00:13:52,980 --> 00:13:55,560
and then it starts constantly looking at

381
00:13:55,560 --> 00:13:58,880
devices that it's seeing

382
00:13:59,579 --> 00:14:01,680
every minute it'll take a list of

383
00:14:01,680 --> 00:14:02,940
devices that it's seen in the past

384
00:14:02,940 --> 00:14:04,500
minute check to see if they're getting

385
00:14:04,500 --> 00:14:06,420
onto the list fire an alert if there are

386
00:14:06,420 --> 00:14:08,399
and every five minutes it'll start to

387
00:14:08,399 --> 00:14:10,740
rotate the lists what was the five to

388
00:14:10,740 --> 00:14:13,019
ten becomes the 10 to 15 all the way

389
00:14:13,019 --> 00:14:15,120
down the line and everything that it's

390
00:14:15,120 --> 00:14:18,240
seeing for the past five minutes it's

391
00:14:18,240 --> 00:14:20,040
storing in a list which then becomes the

392
00:14:20,040 --> 00:14:21,540
new five to ten and it just kind of

393
00:14:21,540 --> 00:14:23,760
rotates down the line so I'm not saying

394
00:14:23,760 --> 00:14:25,200
it's the only way to solve the problem

395
00:14:25,200 --> 00:14:27,060
it was just the solution that I thought

396
00:14:27,060 --> 00:14:31,219
of and implemented and it works

397
00:14:31,320 --> 00:14:35,579
so kind of talked about that methodology

398
00:14:35,579 --> 00:14:37,320
another thing right a tiny bit of

399
00:14:37,320 --> 00:14:39,959
tradecraft here we don't want to alert

400
00:14:39,959 --> 00:14:42,240
on ourselves right I don't want to fire

401
00:14:42,240 --> 00:14:45,420
this up go for a drive and then be like

402
00:14:45,420 --> 00:14:48,120
ah there's an iPhone following me

403
00:14:48,120 --> 00:14:50,040
yeah it's the one in my pocket all right

404
00:14:50,040 --> 00:14:52,680
and so how you actually do this when

405
00:14:52,680 --> 00:14:54,480
you're doing singles intelligence style

406
00:14:54,480 --> 00:14:55,980
of work is

407
00:14:55,980 --> 00:14:57,600
you know I've done some of this work in

408
00:14:57,600 --> 00:14:59,579
a previous life you get together in a

409
00:14:59,579 --> 00:15:01,920
room you sit down you see a list of all

410
00:15:01,920 --> 00:15:04,320
the devices that we're seeing right so I

411
00:15:04,320 --> 00:15:06,300
would fire something up right now I

412
00:15:06,300 --> 00:15:07,800
would let it run for a few minutes at

413
00:15:07,800 --> 00:15:09,540
seeing all of our phones everyone that

414
00:15:09,540 --> 00:15:10,800
you know doesn't have their Wireless or

415
00:15:10,800 --> 00:15:12,540
Bluetooth turned off

416
00:15:12,540 --> 00:15:14,579
and then you basically create an ignore

417
00:15:14,579 --> 00:15:15,420
list

418
00:15:15,420 --> 00:15:17,399
right and now we can see if someone else

419
00:15:17,399 --> 00:15:19,260
new enters the room because that device

420
00:15:19,260 --> 00:15:21,180
is not on our ignore list and so now we

421
00:15:21,180 --> 00:15:22,560
get the alert and that's the

422
00:15:22,560 --> 00:15:24,480
functionality that we need

423
00:15:24,480 --> 00:15:26,579
and so anytime we can create an ignore

424
00:15:26,579 --> 00:15:28,860
list of every Mac address that it's seen

425
00:15:28,860 --> 00:15:31,500
in the latest Kismet database so what I

426
00:15:31,500 --> 00:15:32,940
would do is

427
00:15:32,940 --> 00:15:35,339
turn it on

428
00:15:35,339 --> 00:15:37,920
let it run for a few minutes soak in

429
00:15:37,920 --> 00:15:39,959
everything that it sees and then boom

430
00:15:39,959 --> 00:15:41,940
just tap the button which you'll see how

431
00:15:41,940 --> 00:15:44,639
ugly the buttons are in a second tap the

432
00:15:44,639 --> 00:15:46,860
button to create an ignore list and now

433
00:15:46,860 --> 00:15:49,019
I have a list of everything it's seen

434
00:15:49,019 --> 00:15:51,180
that I don't want it to alert on and

435
00:15:51,180 --> 00:15:52,860
it'll ignore those for the rest of the

436
00:15:52,860 --> 00:15:55,199
session I can delete or recreate the

437
00:15:55,199 --> 00:15:57,480
ignore list

438
00:15:57,480 --> 00:16:00,060
yeah don't laugh no seriously

439
00:16:00,060 --> 00:16:03,120
no seriously laugh

440
00:16:03,120 --> 00:16:05,279
this is a reminiscent of like some old

441
00:16:05,279 --> 00:16:07,920
Microsoft Access databases I made back

442
00:16:07,920 --> 00:16:10,199
in the day

443
00:16:10,199 --> 00:16:12,420
yeah

444
00:16:12,420 --> 00:16:14,100
seriously though if you're thinking

445
00:16:14,100 --> 00:16:16,260
about this it's not that I just like put

446
00:16:16,260 --> 00:16:18,839
five minutes on this and just gave up

447
00:16:18,839 --> 00:16:21,000
look at me I'm not a small dude I'm six

448
00:16:21,000 --> 00:16:23,519
foot four right I do not have delicate

449
00:16:23,519 --> 00:16:25,740
little fingers and so if you're driving

450
00:16:25,740 --> 00:16:28,500
down the road and these gorilla hands

451
00:16:28,500 --> 00:16:30,480
need to mash a button

452
00:16:30,480 --> 00:16:33,060
you don't want like this nice interface

453
00:16:33,060 --> 00:16:35,040
designed by Apple you want an interface

454
00:16:35,040 --> 00:16:38,040
designed by Fisher Price Right This is a

455
00:16:38,040 --> 00:16:40,019
GUI by Fisher Price that is what I

456
00:16:40,019 --> 00:16:42,300
needed I needed the speak and say so

457
00:16:42,300 --> 00:16:43,980
yeah that's why we have these big

458
00:16:43,980 --> 00:16:45,480
horribly

459
00:16:45,480 --> 00:16:47,160
ugly buttons that yes I probably could

460
00:16:47,160 --> 00:16:49,920
have made look slightly prettier but why

461
00:16:49,920 --> 00:16:53,240
I was busy doing other stuff

462
00:16:54,060 --> 00:16:56,399
so now that I had it was time to do a

463
00:16:56,399 --> 00:16:58,079
little bit of field testing right kind

464
00:16:58,079 --> 00:17:00,120
of a drive off into the middle of

465
00:17:00,120 --> 00:17:01,920
nowhere which is one really really big

466
00:17:01,920 --> 00:17:03,540
perk of living in the desert right when

467
00:17:03,540 --> 00:17:05,339
you live in Arizona you can go in the

468
00:17:05,339 --> 00:17:06,900
middle of nowhere it's really really

469
00:17:06,900 --> 00:17:08,339
easy to go where there's no other

470
00:17:08,339 --> 00:17:10,260
signals around you

471
00:17:10,260 --> 00:17:12,240
because I started doing some testing and

472
00:17:12,240 --> 00:17:13,619
things were working good it was like

473
00:17:13,619 --> 00:17:15,359
okay it's working let me go do a field

474
00:17:15,359 --> 00:17:16,859
test let me drive out in the middle of

475
00:17:16,859 --> 00:17:17,880
nowhere

476
00:17:17,880 --> 00:17:20,280
turn on two phones that I previously had

477
00:17:20,280 --> 00:17:21,119
off

478
00:17:21,119 --> 00:17:25,260
and I saw absolutely nothing

479
00:17:25,260 --> 00:17:26,939
interesting

480
00:17:26,939 --> 00:17:29,160
so took it back

481
00:17:29,160 --> 00:17:31,799
dumped the data that I did see into a

482
00:17:31,799 --> 00:17:34,860
pcap fired up Wireshark and now here's

483
00:17:34,860 --> 00:17:36,539
where you realize the fun right because

484
00:17:36,539 --> 00:17:39,120
there's something that I knew was taking

485
00:17:39,120 --> 00:17:42,179
place I just didn't realize how often it

486
00:17:42,179 --> 00:17:44,160
was taking place and that's Mac address

487
00:17:44,160 --> 00:17:46,260
randomization right in the name of

488
00:17:46,260 --> 00:17:49,140
privacy and security we have devices now

489
00:17:49,140 --> 00:17:51,120
that they're constantly looking for

490
00:17:51,120 --> 00:17:52,559
networks they've connected to in the

491
00:17:52,559 --> 00:17:53,640
past

492
00:17:53,640 --> 00:17:55,860
but they're spoofing a MAC address right

493
00:17:55,860 --> 00:17:57,480
to try to keep your privacy and security

494
00:17:57,480 --> 00:17:59,100
and I knew that that was a thing I knew

495
00:17:59,100 --> 00:18:01,200
Mac address spoofing existed

496
00:18:01,200 --> 00:18:02,700
I just didn't realize that it was

497
00:18:02,700 --> 00:18:05,220
basically constant this was a very very

498
00:18:05,220 --> 00:18:07,380
narrow field of time and if you look at

499
00:18:07,380 --> 00:18:09,240
the very far right I know it's a very

500
00:18:09,240 --> 00:18:12,360
small but this is all this is two

501
00:18:12,360 --> 00:18:15,120
devices looking for one network these

502
00:18:15,120 --> 00:18:16,620
are all just looking for one Wi-Fi

503
00:18:16,620 --> 00:18:18,240
network if you look at the first part of

504
00:18:18,240 --> 00:18:20,220
the uh redacted most of the Wi-Fi name

505
00:18:20,220 --> 00:18:21,539
but you can see the first part of it

506
00:18:21,539 --> 00:18:25,140
starts with a DF there

507
00:18:25,140 --> 00:18:27,000
and you only see the same Mac address

508
00:18:27,000 --> 00:18:29,880
twice and so basically every time these

509
00:18:29,880 --> 00:18:31,919
devices are probing

510
00:18:31,919 --> 00:18:33,900
they're spoofing a new Mac address right

511
00:18:33,900 --> 00:18:35,480
so like I said a new Mac address

512
00:18:35,480 --> 00:18:38,340
randomization was a thing I just

513
00:18:38,340 --> 00:18:40,380
personally honestly didn't realize that

514
00:18:40,380 --> 00:18:42,780
it was basically every request it was

515
00:18:42,780 --> 00:18:44,880
just constantly going on so it's like

516
00:18:44,880 --> 00:18:47,400
all right the MAC address methodology

517
00:18:47,400 --> 00:18:49,980
that we had before still needs to be in

518
00:18:49,980 --> 00:18:51,960
place because it still needs to detect

519
00:18:51,960 --> 00:18:53,160
things that are part of an active

520
00:18:53,160 --> 00:18:54,960
connection it still needs to detect

521
00:18:54,960 --> 00:18:57,000
things that don't randomize but for

522
00:18:57,000 --> 00:18:58,740
things that randomize right is this a

523
00:18:58,740 --> 00:19:01,320
deal breaker it's not because now what

524
00:19:01,320 --> 00:19:03,360
we're looking for is

525
00:19:03,360 --> 00:19:04,679
we're going to look for what it's

526
00:19:04,679 --> 00:19:06,720
looking for right the probe request the

527
00:19:06,720 --> 00:19:09,000
actual name of the Wi-Fi network

528
00:19:09,000 --> 00:19:11,700
and so my my buddy singe in the front

529
00:19:11,700 --> 00:19:15,240
row right here down in South Africa his

530
00:19:15,240 --> 00:19:17,520
Wi-Fi network is named sinja's Wi-Fi and

531
00:19:17,520 --> 00:19:19,620
his Wi-Fi is on right now

532
00:19:19,620 --> 00:19:21,299
his device should be looking for hey

533
00:19:21,299 --> 00:19:24,179
send his Wi-Fi are you there

534
00:19:24,179 --> 00:19:27,679
send just Wi-Fi are you there

535
00:19:28,140 --> 00:19:30,600
he can spoof his Mac all he wants that

536
00:19:30,600 --> 00:19:33,000
can be spoofing every request I still

537
00:19:33,000 --> 00:19:34,020
see

538
00:19:34,020 --> 00:19:36,299
Mac address is looking for a name that's

539
00:19:36,299 --> 00:19:38,280
fairly unique right and fairly unique

540
00:19:38,280 --> 00:19:39,960
this is where people get tripped up

541
00:19:39,960 --> 00:19:41,820
we'll end the slides here in a little

542
00:19:41,820 --> 00:19:44,700
bit talking about this right people want

543
00:19:44,700 --> 00:19:46,620
to name their Wi-Fi something funny

544
00:19:46,620 --> 00:19:49,020
something unique something clever to

545
00:19:49,020 --> 00:19:50,640
impress their friends and impress their

546
00:19:50,640 --> 00:19:52,440
neighbors but what's the key part of

547
00:19:52,440 --> 00:19:55,020
that sentence right unique

548
00:19:55,020 --> 00:19:56,580
right unique and this is what can start

549
00:19:56,580 --> 00:19:58,080
to give us away and maybe help us a

550
00:19:58,080 --> 00:20:00,179
little bit of attribution on who we're

551
00:20:00,179 --> 00:20:02,520
detecting as well and so what we do is

552
00:20:02,520 --> 00:20:04,620
now we actually to get the probe

553
00:20:04,620 --> 00:20:07,080
requests we have to dive down into those

554
00:20:07,080 --> 00:20:09,000
Json blobs right so there's just little

555
00:20:09,000 --> 00:20:11,520
snippet of the Python code for kind of

556
00:20:11,520 --> 00:20:15,120
parsing down and so now all of the

557
00:20:15,120 --> 00:20:16,320
methodology that we talked about

558
00:20:16,320 --> 00:20:19,140
previously for Mac addresses we have Pro

559
00:20:19,140 --> 00:20:21,179
I have the same methodology to probe

560
00:20:21,179 --> 00:20:23,340
requests so we're actually looking for

561
00:20:23,340 --> 00:20:25,320
wireless networks that things have

562
00:20:25,320 --> 00:20:27,840
looked for and we don't really care what

563
00:20:27,840 --> 00:20:29,460
the MAC address is we're going off the

564
00:20:29,460 --> 00:20:31,860
name of the network at this point

565
00:20:31,860 --> 00:20:34,020
and we have the same they're uh they're

566
00:20:34,020 --> 00:20:35,880
included in ignore lists and everything

567
00:20:35,880 --> 00:20:38,179
else

568
00:20:38,280 --> 00:20:40,919
the user display much prettier than the

569
00:20:40,919 --> 00:20:43,500
agui no no it's the same

570
00:20:43,500 --> 00:20:45,660
fire it up there and you start to see

571
00:20:45,660 --> 00:20:47,460
what it does is it instantly starts to

572
00:20:47,460 --> 00:20:51,179
identify things it has uh we added 308

573
00:20:51,179 --> 00:20:53,700
Mac addresses and 27 wireless network

574
00:20:53,700 --> 00:20:55,919
names that were being probed for into

575
00:20:55,919 --> 00:21:00,500
the ignore list and now it just fires up

576
00:21:01,440 --> 00:21:03,780
as it continues on you see what happened

577
00:21:03,780 --> 00:21:05,700
is this was uh was home when I actually

578
00:21:05,700 --> 00:21:07,980
did this that's why some of the the Mac

579
00:21:07,980 --> 00:21:10,860
addresses are kind of uh censored out

580
00:21:10,860 --> 00:21:12,720
but I left this running for a little bit

581
00:21:12,720 --> 00:21:14,460
and then all of a sudden

582
00:21:14,460 --> 00:21:16,320
maybe one of my neighbors turned on a

583
00:21:16,320 --> 00:21:18,720
device that was previously off

584
00:21:18,720 --> 00:21:20,580
maybe they had like someone come visit

585
00:21:20,580 --> 00:21:22,860
them but all of a sudden now there was a

586
00:21:22,860 --> 00:21:24,960
phone somewhere near my house or a

587
00:21:24,960 --> 00:21:27,179
device right a device that was looking

588
00:21:27,179 --> 00:21:30,179
for a network name Samsung smart and I

589
00:21:30,179 --> 00:21:32,280
started seeing these probe requests that

590
00:21:32,280 --> 00:21:35,580
I had also seen five to ten minutes ago

591
00:21:35,580 --> 00:21:38,460
and 10 to 15 minutes ago

592
00:21:38,460 --> 00:21:40,980
and 10 to 15 minutes ago all the way

593
00:21:40,980 --> 00:21:43,260
down the line and so once again I was

594
00:21:43,260 --> 00:21:44,940
trying to design this because the

595
00:21:44,940 --> 00:21:46,980
original person who needed it was going

596
00:21:46,980 --> 00:21:49,740
to be driving down the road right it's

597
00:21:49,740 --> 00:21:51,360
really really tough to kind of drive and

598
00:21:51,360 --> 00:21:52,679
pay attention to something else or

599
00:21:52,679 --> 00:21:54,720
really be too terribly interactive with

600
00:21:54,720 --> 00:21:57,000
it so like I said I made basically kind

601
00:21:57,000 --> 00:21:59,520
of Fisher Price user interfaces on

602
00:21:59,520 --> 00:22:01,320
purpose I personally think for a very

603
00:22:01,320 --> 00:22:03,980
very good reason

604
00:22:04,580 --> 00:22:07,919
the MVP version of my testing right I

605
00:22:07,919 --> 00:22:10,200
mean MVP here not as the most valuable

606
00:22:10,200 --> 00:22:12,419
player for any other sports fans out

607
00:22:12,419 --> 00:22:14,940
there the minimum viable product right

608
00:22:14,940 --> 00:22:17,159
before I bother drilling a holes in my

609
00:22:17,159 --> 00:22:18,720
Pelican case because those things ain't

610
00:22:18,720 --> 00:22:21,360
cheap let me make sure that this thing

611
00:22:21,360 --> 00:22:23,460
actually works and from going around

612
00:22:23,460 --> 00:22:25,140
testing and yeah the thing actually

613
00:22:25,140 --> 00:22:28,340
worked and so okay

614
00:22:28,679 --> 00:22:30,659
so then we have these slightly

615
00:22:30,659 --> 00:22:32,520
better-ish version right it's still

616
00:22:32,520 --> 00:22:33,900
nothing that I would actually want to

617
00:22:33,900 --> 00:22:36,059
sell or anything like that but at least

618
00:22:36,059 --> 00:22:38,460
looking a little bit easier some foam

619
00:22:38,460 --> 00:22:40,559
cut in the case the battery pack there

620
00:22:40,559 --> 00:22:42,539
it gets pretty good life even a very

621
00:22:42,539 --> 00:22:44,580
very cheap like anchor that was less

622
00:22:44,580 --> 00:22:47,280
than twenty dollars on Amazon will power

623
00:22:47,280 --> 00:22:49,440
this thing for over eight hours and I

624
00:22:49,440 --> 00:22:51,000
got a little bit more robust battery

625
00:22:51,000 --> 00:22:52,980
pack that one right there and it'll

626
00:22:52,980 --> 00:22:55,260
power for over 24 hours so it actually

627
00:22:55,260 --> 00:22:57,240
gets pretty good life right now you can

628
00:22:57,240 --> 00:22:58,679
always go to a cigarette lighter or

629
00:22:58,679 --> 00:23:00,539
something too I just wanted to keep this

630
00:23:00,539 --> 00:23:03,179
one as portable as possible but it uses

631
00:23:03,179 --> 00:23:05,940
very very little power

632
00:23:05,940 --> 00:23:07,980
foreign

633
00:23:07,980 --> 00:23:10,380
we said earlier that Kismet keeps great

634
00:23:10,380 --> 00:23:14,159
logs right and so this was uh I was

635
00:23:14,159 --> 00:23:16,020
speaking it was kind of cool the um I

636
00:23:16,020 --> 00:23:17,460
haven't even tweeted it out yet but this

637
00:23:17,460 --> 00:23:20,220
morning wired actually published a an

638
00:23:20,220 --> 00:23:22,080
article on me in this talk and that was

639
00:23:22,080 --> 00:23:24,720
kind of neat and as I was talking to the

640
00:23:24,720 --> 00:23:27,480
reporter about two weeks ago

641
00:23:27,480 --> 00:23:30,179
he he asked me he's like

642
00:23:30,179 --> 00:23:32,460
well could you maybe tell information

643
00:23:32,460 --> 00:23:34,559
about the people that were following you

644
00:23:34,559 --> 00:23:37,140
and I'm like yeah yeah we can right we

645
00:23:37,140 --> 00:23:38,700
kind of started to go down that Gap it

646
00:23:38,700 --> 00:23:41,159
and explain it right and potentially we

647
00:23:41,159 --> 00:23:42,600
could

648
00:23:42,600 --> 00:23:45,840
because of what I said just a couple of

649
00:23:45,840 --> 00:23:48,240
minutes ago right people have a very

650
00:23:48,240 --> 00:23:50,280
very bad habit of naming their Wi-Fi

651
00:23:50,280 --> 00:23:53,700
something unique and clever and funny to

652
00:23:53,700 --> 00:23:55,740
impress people and it's not just

653
00:23:55,740 --> 00:23:58,860
individuals organizations do it too

654
00:23:58,860 --> 00:24:02,159
right public private we we all kind of

655
00:24:02,159 --> 00:24:03,960
do it right I'm getting ready to show an

656
00:24:03,960 --> 00:24:05,520
example here in just a second and it's

657
00:24:05,520 --> 00:24:07,500
not trying to like shame anyone or shame

658
00:24:07,500 --> 00:24:11,940
any agency because everybody does it and

659
00:24:11,940 --> 00:24:14,400
so people don't think about that

660
00:24:14,400 --> 00:24:17,460
hey now your device potentially

661
00:24:17,460 --> 00:24:19,080
depending on what kind of device it is

662
00:24:19,080 --> 00:24:21,200
settings are and some other factors

663
00:24:21,200 --> 00:24:23,940
everywhere you go it's looking for this

664
00:24:23,940 --> 00:24:28,620
right so we fired up the old wiggle.net

665
00:24:28,620 --> 00:24:30,360
and I did the government agency the

666
00:24:30,360 --> 00:24:32,400
courtesy of blocking out the first part

667
00:24:32,400 --> 00:24:34,740
of that Wi-Fi name it was saying the

668
00:24:34,740 --> 00:24:37,080
name of a government agency

669
00:24:37,080 --> 00:24:38,940
and the strike force

670
00:24:38,940 --> 00:24:40,860
and this was outside of a building that

671
00:24:40,860 --> 00:24:42,419
is not publicly known to be government

672
00:24:42,419 --> 00:24:45,360
but absolutely has government in there

673
00:24:45,360 --> 00:24:47,520
and once again right I'm not doing this

674
00:24:47,520 --> 00:24:49,740
to kind of like name and shame or haha

675
00:24:49,740 --> 00:24:52,140
how can they be so stupid everyone does

676
00:24:52,140 --> 00:24:52,919
it

677
00:24:52,919 --> 00:24:55,140
said public sector private sector people

678
00:24:55,140 --> 00:24:57,240
but people have a horrible name a

679
00:24:57,240 --> 00:25:00,419
specialty right especially you work in a

680
00:25:00,419 --> 00:25:02,280
big organization

681
00:25:02,280 --> 00:25:03,659
but not you

682
00:25:03,659 --> 00:25:05,760
right you and 80 your friends you work

683
00:25:05,760 --> 00:25:09,000
in this really really cool little group

684
00:25:09,000 --> 00:25:11,280
right this little sub component

685
00:25:11,280 --> 00:25:13,200
heck yeah you're gonna name the little

686
00:25:13,200 --> 00:25:15,059
Wi-Fi at the office the name of that sub

687
00:25:15,059 --> 00:25:17,159
component and something else and this is

688
00:25:17,159 --> 00:25:18,900
given away right I've been in rooms

689
00:25:18,900 --> 00:25:21,240
where I was basically the only one there

690
00:25:21,240 --> 00:25:23,340
who wasn't like kind of an SF operator

691
00:25:23,340 --> 00:25:24,779
and you just start looking down like

692
00:25:24,779 --> 00:25:26,340
okay which one of you is stationed at

693
00:25:26,340 --> 00:25:27,419
10th Mountain

694
00:25:27,419 --> 00:25:29,580
okay which one of you is stationed here

695
00:25:29,580 --> 00:25:31,500
you know once again I'm not naming and

696
00:25:31,500 --> 00:25:33,240
shaming everyone does it right it's just

697
00:25:33,240 --> 00:25:35,520
something to think about and potentially

698
00:25:35,520 --> 00:25:37,200
even if it's not like a government

699
00:25:37,200 --> 00:25:39,000
organization or anything following you

700
00:25:39,000 --> 00:25:41,159
if it's just an individual still

701
00:25:41,159 --> 00:25:43,320
things tend to be unique

702
00:25:43,320 --> 00:25:45,360
right even like Verizon Wi-Fi's and

703
00:25:45,360 --> 00:25:46,740
certain things like that and if you

704
00:25:46,740 --> 00:25:48,419
start to see

705
00:25:48,419 --> 00:25:50,520
these probe requests and their unique

706
00:25:50,520 --> 00:25:51,960
probe requests that start to following

707
00:25:51,960 --> 00:25:54,179
you you may now be able to provide a

708
00:25:54,179 --> 00:25:55,919
little bit of attribution on the devices

709
00:25:55,919 --> 00:25:58,820
that you're seeing

710
00:25:59,480 --> 00:26:02,700
the path forward more Wi-Fi adapters

711
00:26:02,700 --> 00:26:04,620
potentially I think the biggest one is

712
00:26:04,620 --> 00:26:07,020
more Wireless protocols right I think

713
00:26:07,020 --> 00:26:10,020
the most logical step for expansion is

714
00:26:10,020 --> 00:26:12,240
probably a TPMS like the low pressure

715
00:26:12,240 --> 00:26:14,039
sensors and tires because those get a

716
00:26:14,039 --> 00:26:15,720
little more range than a lot of people

717
00:26:15,720 --> 00:26:18,600
realize adding in a GPS to start to go

718
00:26:18,600 --> 00:26:20,460
back after the fact and kind of generate

719
00:26:20,460 --> 00:26:21,900
a map of

720
00:26:21,900 --> 00:26:24,000
if you saw something following you where

721
00:26:24,000 --> 00:26:25,679
did you first see it and all the way

722
00:26:25,679 --> 00:26:27,419
down the line right you have the logs

723
00:26:27,419 --> 00:26:29,100
there the logs are there just a matter

724
00:26:29,100 --> 00:26:31,020
of writing strips to kind of generate

725
00:26:31,020 --> 00:26:33,240
some of this data

726
00:26:33,240 --> 00:26:35,220
special thanks to a few people uh Mike

727
00:26:35,220 --> 00:26:38,340
Kershaw the Disney Kismet Discord I had

728
00:26:38,340 --> 00:26:39,840
a few questions about doing some of the

729
00:26:39,840 --> 00:26:41,279
things that I was doing and I was asking

730
00:26:41,279 --> 00:26:43,980
him this man right there Dominic white

731
00:26:43,980 --> 00:26:46,140
sin she's one of the best Wi-Fi

732
00:26:46,140 --> 00:26:48,419
researchers that I know and I think two

733
00:26:48,419 --> 00:26:50,100
times when I was working on this I would

734
00:26:50,100 --> 00:26:51,779
kind of reach out and it's like Hey

735
00:26:51,779 --> 00:26:54,720
listen this is what I'm seeing this is

736
00:26:54,720 --> 00:26:57,059
what I think it is am I correct and he'd

737
00:26:57,059 --> 00:26:58,799
be like yeah I know or here it is and

738
00:26:58,799 --> 00:27:00,840
down the line so thank you very much my

739
00:27:00,840 --> 00:27:03,000
friend appreciate it so just for helping

740
00:27:03,000 --> 00:27:04,559
me and Josh Wright for kind of some of

741
00:27:04,559 --> 00:27:06,840
the things things same things bouncing

742
00:27:06,840 --> 00:27:09,419
some of these ideas off them

743
00:27:09,419 --> 00:27:11,760
so that said I've about used up all my

744
00:27:11,760 --> 00:27:13,260
time the um

745
00:27:13,260 --> 00:27:15,179
the code is all out there it's all on my

746
00:27:15,179 --> 00:27:17,220
GitHub AZ mat if you shoot me an email

747
00:27:17,220 --> 00:27:18,600
or hit me up on Twitter or whatever I'll

748
00:27:18,600 --> 00:27:19,980
throw the link to it right there but the

749
00:27:19,980 --> 00:27:22,020
code is all out there the parts list is

750
00:27:22,020 --> 00:27:23,640
all out there I'm probably going to do

751
00:27:23,640 --> 00:27:25,799
up a blog post on digital forensics tips

752
00:27:25,799 --> 00:27:27,840
in the next couple days as well but if

753
00:27:27,840 --> 00:27:29,100
you have any questions I think they're

754
00:27:29,100 --> 00:27:30,179
going to take me to a little speaker

755
00:27:30,179 --> 00:27:32,100
room after the fact and other than that

756
00:27:32,100 --> 00:27:34,140
you had a lot of choices for your

757
00:27:34,140 --> 00:27:36,600
Thursday afternoon thank you very much

758
00:27:36,600 --> 00:27:38,279
for spending with me I appreciate it

759
00:27:38,279 --> 00:27:40,700
thank you

760
00:27:41,050 --> 00:27:44,169
[Music]

761
00:27:46,580 --> 00:27:48,010
thank you

762
00:27:48,010 --> 00:27:51,109
[Music]

