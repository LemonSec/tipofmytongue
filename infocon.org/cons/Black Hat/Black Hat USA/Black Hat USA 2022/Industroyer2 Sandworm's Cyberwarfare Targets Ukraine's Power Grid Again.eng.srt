1
00:00:01,730 --> 00:00:03,720
[Music]

2
00:00:03,720 --> 00:00:06,720
foreign

3
00:00:09,840 --> 00:00:11,639
thank you

4
00:00:11,639 --> 00:00:15,540
so five years ago at black hat 2017 we

5
00:00:15,540 --> 00:00:18,660
talked about in Destroyer

6
00:00:18,660 --> 00:00:21,000
the first ever malware specifically

7
00:00:21,000 --> 00:00:24,180
designed to attack power grades and we

8
00:00:24,180 --> 00:00:27,240
labeled it the biggest threat to ICS

9
00:00:27,240 --> 00:00:31,140
since stuxnet and today we present the

10
00:00:31,140 --> 00:00:34,860
sequel in Destroyer 2.

11
00:00:34,860 --> 00:00:37,440
but before we get to that we'll put this

12
00:00:37,440 --> 00:00:40,079
latest attack into context and go over

13
00:00:40,079 --> 00:00:42,480
the selection of the attacks by the APT

14
00:00:42,480 --> 00:00:44,340
group behind it

15
00:00:44,340 --> 00:00:46,620
we'll do a recap of the original in

16
00:00:46,620 --> 00:00:49,320
Destroyer so we'll also be comparing

17
00:00:49,320 --> 00:00:52,020
those two versions we'll discuss the

18
00:00:52,020 --> 00:00:55,379
2022 incident how it unfolded and take a

19
00:00:55,379 --> 00:00:57,920
closer look at the industry to malware

20
00:00:57,920 --> 00:01:01,260
we also look at some other malware that

21
00:01:01,260 --> 00:01:03,420
was deployed alongside with it

22
00:01:03,420 --> 00:01:05,339
and then we will end the presentation

23
00:01:05,339 --> 00:01:09,840
with some defense and detection advice

24
00:01:09,840 --> 00:01:13,200
so I'm Robert lipovsky my co-speaker is

25
00:01:13,200 --> 00:01:15,780
Anton chedapanov and we're both threat

26
00:01:15,780 --> 00:01:18,060
researchers for ESET Anton's

27
00:01:18,060 --> 00:01:21,299
specialization is Advanced threats and

28
00:01:21,299 --> 00:01:24,119
apt attacks Research into these areas

29
00:01:24,119 --> 00:01:27,060
and I also look at apts mostly but not

30
00:01:27,060 --> 00:01:29,400
only those also crimeware a bit of

31
00:01:29,400 --> 00:01:31,500
vulnerability research for example at

32
00:01:31,500 --> 00:01:34,860
black hat 2020 I could co-presented our

33
00:01:34,860 --> 00:01:37,079
research on the crook Wi-Fi

34
00:01:37,079 --> 00:01:40,320
vulnerability but that was virtual so

35
00:01:40,320 --> 00:01:41,640
it's really good to be back in person

36
00:01:41,640 --> 00:01:43,619
this time

37
00:01:43,619 --> 00:01:46,020
ESET for any of you that are not

38
00:01:46,020 --> 00:01:48,540
familiar with the company so we've been

39
00:01:48,540 --> 00:01:50,880
on the market for over three decades and

40
00:01:50,880 --> 00:01:52,020
we're the largest endpoint security

41
00:01:52,020 --> 00:01:54,439
provider based in the European Union

42
00:01:54,439 --> 00:01:57,240
specifically in Slovakia which is right

43
00:01:57,240 --> 00:01:59,939
next to Ukraine by the way and what

44
00:01:59,939 --> 00:02:01,860
you'll hear today is our original

45
00:02:01,860 --> 00:02:05,520
research I mean we have a unique Vantage

46
00:02:05,520 --> 00:02:07,920
Point as the most widely used security

47
00:02:07,920 --> 00:02:11,220
vendor in Ukraine many private and

48
00:02:11,220 --> 00:02:13,440
public sector organizations use our

49
00:02:13,440 --> 00:02:15,900
software giving us direct Telemetry and

50
00:02:15,900 --> 00:02:18,420
we see that the attacks unraveling in

51
00:02:18,420 --> 00:02:19,920
real time

52
00:02:19,920 --> 00:02:22,260
but it's not as you notice it's not just

53
00:02:22,260 --> 00:02:24,480
us two because we have a very special

54
00:02:24,480 --> 00:02:28,020
guest today directly from Ukraine Mr

55
00:02:28,020 --> 00:02:30,780
Victor Zora who is the Deputy chairman

56
00:02:30,780 --> 00:02:32,580
of the state service of special

57
00:02:32,580 --> 00:02:35,239
Communications

58
00:02:42,420 --> 00:02:45,959
he's the chairman of SSS CIP in Ukraine

59
00:02:45,959 --> 00:02:48,360
and he's overseeing the incident

60
00:02:48,360 --> 00:02:52,260
response to the industry to attack so he

61
00:02:52,260 --> 00:02:54,120
is one of definitely one of the best

62
00:02:54,120 --> 00:02:57,720
people to share very valuable Insight on

63
00:02:57,720 --> 00:02:59,400
the incident so it's a pleasure to have

64
00:02:59,400 --> 00:03:02,120
him here with us

65
00:03:02,700 --> 00:03:06,900
so the Cyber war in Ukraine didn't start

66
00:03:06,900 --> 00:03:10,500
this February it started in 2014 or

67
00:03:10,500 --> 00:03:13,860
perhaps even towards the end of 2013.

68
00:03:13,860 --> 00:03:16,620
and here's a list of the most notable

69
00:03:16,620 --> 00:03:18,420
apt groups

70
00:03:18,420 --> 00:03:21,060
that have carried out targeted attacks

71
00:03:21,060 --> 00:03:23,459
against Ukraine over those years

72
00:03:23,459 --> 00:03:25,560
mind you this is not a comprehensive

73
00:03:25,560 --> 00:03:27,599
list either this is just the selection

74
00:03:27,599 --> 00:03:31,080
that we made and from this selection we

75
00:03:31,080 --> 00:03:33,120
will focus on in my opinion the most

76
00:03:33,120 --> 00:03:35,459
aggressive of these groups the one

77
00:03:35,459 --> 00:03:39,060
behind the power grid attacks sandworm

78
00:03:39,060 --> 00:03:41,099
Santa worm has been attributed to the

79
00:03:41,099 --> 00:03:42,659
Russian military intelligence service

80
00:03:42,659 --> 00:03:46,140
Gru and in October 2020 the FBI even

81
00:03:46,140 --> 00:03:50,280
released a public indictment of six Gru

82
00:03:50,280 --> 00:03:52,680
hackers for taking part in some of the

83
00:03:52,680 --> 00:03:54,540
campaigns and attacks we'll be

84
00:03:54,540 --> 00:03:56,879
discussing next

85
00:03:56,879 --> 00:03:58,920
by the way if anyone is wondering where

86
00:03:58,920 --> 00:04:01,500
the name sandworm comes from here's the

87
00:04:01,500 --> 00:04:02,340
answer

88
00:04:02,340 --> 00:04:05,340
in some of the early campaigns using the

89
00:04:05,340 --> 00:04:08,040
black energy malware we discovered these

90
00:04:08,040 --> 00:04:10,379
text strings in the command and control

91
00:04:10,379 --> 00:04:12,959
server addresses so apparently the

92
00:04:12,959 --> 00:04:15,000
operators were fans of Frank Herbert's

93
00:04:15,000 --> 00:04:16,260
classic

94
00:04:16,260 --> 00:04:19,560
and we first talked about these Dune

95
00:04:19,560 --> 00:04:21,418
references at the virus bulletin

96
00:04:21,418 --> 00:04:23,880
conference in 2014 but it was actually

97
00:04:23,880 --> 00:04:26,699
eyesight Partners now under mandiant

98
00:04:26,699 --> 00:04:30,120
that coined the sand worm name

99
00:04:30,120 --> 00:04:32,820
so we've been tracking them from the

100
00:04:32,820 --> 00:04:35,220
beginning since black energy actually

101
00:04:35,220 --> 00:04:38,400
evolved from a cyber criminal commodity

102
00:04:38,400 --> 00:04:40,740
piece of malware to a cyber weapon in

103
00:04:40,740 --> 00:04:42,479
the hands of sandworm

104
00:04:42,479 --> 00:04:45,060
and looking into our Telemetry the

105
00:04:45,060 --> 00:04:47,340
earliest sandworm traces we could find

106
00:04:47,340 --> 00:04:49,979
there dates to 2011

107
00:04:49,979 --> 00:04:52,500
and here is one decoy document that was

108
00:04:52,500 --> 00:04:54,660
being used at the time referencing a

109
00:04:54,660 --> 00:04:58,139
conference early the following year

110
00:04:58,139 --> 00:05:00,840
then as I indicated towards the end of

111
00:05:00,840 --> 00:05:03,060
2013

112
00:05:03,060 --> 00:05:05,400
we observed a notable increase in

113
00:05:05,400 --> 00:05:08,940
targeted apt activity against Ukrainian

114
00:05:08,940 --> 00:05:12,000
high-value targets so preceding the

115
00:05:12,000 --> 00:05:14,040
Russian occupation of Crimea in the

116
00:05:14,040 --> 00:05:17,040
beginning of the war in donbass

117
00:05:17,040 --> 00:05:19,020
San Juan targeted all types of

118
00:05:19,020 --> 00:05:21,259
organizations including government

119
00:05:21,259 --> 00:05:24,600
diplomatic media Transportation even the

120
00:05:24,600 --> 00:05:27,539
Ukrainian elections

121
00:05:27,539 --> 00:05:30,300
one of the main methods they use to

122
00:05:30,300 --> 00:05:32,160
infiltrate organizations was through

123
00:05:32,160 --> 00:05:34,800
carefully crafted highly really highly

124
00:05:34,800 --> 00:05:36,960
targeted spearfishing emails and here's

125
00:05:36,960 --> 00:05:39,720
one example that's even using the war in

126
00:05:39,720 --> 00:05:41,639
donbass as a lure

127
00:05:41,639 --> 00:05:44,280
the email says that the Ukrainian prime

128
00:05:44,280 --> 00:05:46,560
minister is instructing various State

129
00:05:46,560 --> 00:05:48,900
institutions to check every Parliament

130
00:05:48,900 --> 00:05:52,979
member for supporting the separatists in

131
00:05:52,979 --> 00:05:55,740
the East and that in the attached file

132
00:05:55,740 --> 00:05:58,020
there was a PowerPoint presentation with

133
00:05:58,020 --> 00:06:01,139
this list of alleged separatist

134
00:06:01,139 --> 00:06:03,539
supporters so as you can see this is

135
00:06:03,539 --> 00:06:05,340
some really good social engineering here

136
00:06:05,340 --> 00:06:07,860
this is not your common Nigerian prince

137
00:06:07,860 --> 00:06:09,060
camp

138
00:06:09,060 --> 00:06:11,460
and in the background

139
00:06:11,460 --> 00:06:14,039
um black energy would be downloaded and

140
00:06:14,039 --> 00:06:18,660
installed from a remote server also this

141
00:06:18,660 --> 00:06:20,759
exploited a zero day vulnerability in

142
00:06:20,759 --> 00:06:23,520
PowerPoint so even recipients could have

143
00:06:23,520 --> 00:06:25,020
been that could have been compromised

144
00:06:25,020 --> 00:06:26,819
even if they had fully patched versions

145
00:06:26,819 --> 00:06:29,639
of Windows in office

146
00:06:29,639 --> 00:06:32,880
so black energy was used in many

147
00:06:32,880 --> 00:06:35,340
campaigns against many organizations in

148
00:06:35,340 --> 00:06:37,919
Ukraine but for sure the most notable

149
00:06:37,919 --> 00:06:40,440
attack and the one that caught the

150
00:06:40,440 --> 00:06:41,819
attention of the global cyber security

151
00:06:41,819 --> 00:06:44,340
industry was the one against the

152
00:06:44,340 --> 00:06:46,860
Ukrainian power grid which culminated in

153
00:06:46,860 --> 00:06:49,500
December 2015 when it became the first

154
00:06:49,500 --> 00:06:53,819
ever blackout caused by a Cyber attack

155
00:06:53,819 --> 00:06:57,120
it was facilitated by the black energy

156
00:06:57,120 --> 00:07:00,840
malware and carried out against multiple

157
00:07:00,840 --> 00:07:02,759
electric distribution companies in

158
00:07:02,759 --> 00:07:04,500
various regions across the country

159
00:07:04,500 --> 00:07:07,080
so-called Obel energos

160
00:07:07,080 --> 00:07:10,740
and the attackers misused remote access

161
00:07:10,740 --> 00:07:13,680
software to manually switch off the flow

162
00:07:13,680 --> 00:07:16,440
of electricity and as a result the homes

163
00:07:16,440 --> 00:07:19,740
of over 200 000 ukrainians across the

164
00:07:19,740 --> 00:07:21,780
country different regions went dark for

165
00:07:21,780 --> 00:07:24,440
several hours

166
00:07:24,860 --> 00:07:27,360
here's an infamous

167
00:07:27,360 --> 00:07:29,580
leaked video taken by one of the

168
00:07:29,580 --> 00:07:32,099
operators at one of those targeted

169
00:07:32,099 --> 00:07:33,840
substations

170
00:07:33,840 --> 00:07:36,120
showing how the attackers are remotely

171
00:07:36,120 --> 00:07:38,039
connecting to this workstation and

172
00:07:38,039 --> 00:07:40,259
interacting with the scada software

173
00:07:40,259 --> 00:07:41,520
there

174
00:07:41,520 --> 00:07:44,099
manipulating circuit breakers

175
00:07:44,099 --> 00:07:46,979
and showing that look no one is touching

176
00:07:46,979 --> 00:07:50,359
the mouse or the keyboard

177
00:07:53,400 --> 00:07:55,199
almost exactly one year later in

178
00:07:55,199 --> 00:07:58,020
December 2016 there was another blackout

179
00:07:58,020 --> 00:08:00,780
again caused by a Cyber attack and this

180
00:08:00,780 --> 00:08:02,759
time the attackers really stepped up

181
00:08:02,759 --> 00:08:04,259
their game

182
00:08:04,259 --> 00:08:05,880
there were quite a number of notable

183
00:08:05,880 --> 00:08:08,160
differences for example only one

184
00:08:08,160 --> 00:08:10,860
substation was hit

185
00:08:10,860 --> 00:08:13,979
but the main difference is that the

186
00:08:13,979 --> 00:08:16,620
attackers had much bigger ambitions

187
00:08:16,620 --> 00:08:18,240
we discovered the malware that they

188
00:08:18,240 --> 00:08:21,060
deployed in Destroyer

189
00:08:21,060 --> 00:08:23,639
and unlike the previous years manual

190
00:08:23,639 --> 00:08:26,340
disruption through radmin industrial was

191
00:08:26,340 --> 00:08:28,080
the first ever malware to that was

192
00:08:28,080 --> 00:08:29,819
specifically designed to attack the

193
00:08:29,819 --> 00:08:31,979
power grids in an automated way that's

194
00:08:31,979 --> 00:08:33,719
the key word here and we'll come back to

195
00:08:33,719 --> 00:08:36,080
that later

196
00:08:36,179 --> 00:08:38,820
so in the following years after that

197
00:08:38,820 --> 00:08:41,399
there was a lot of evolution of the tool

198
00:08:41,399 --> 00:08:44,159
set used by sandworm and the group split

199
00:08:44,159 --> 00:08:46,800
its activities we were tracking the gray

200
00:08:46,800 --> 00:08:49,500
energy cluster which continued attacks

201
00:08:49,500 --> 00:08:52,500
against the energy sector and there was

202
00:08:52,500 --> 00:08:54,600
the telebots cluster which carried out

203
00:08:54,600 --> 00:08:56,279
attacks primarily against the financial

204
00:08:56,279 --> 00:08:57,959
sector in Ukraine

205
00:08:57,959 --> 00:09:00,480
and telebots was also the subgroup

206
00:09:00,480 --> 00:09:02,700
behind the infamous not petyard break in

207
00:09:02,700 --> 00:09:05,640
June 2017 which obviously needs no

208
00:09:05,640 --> 00:09:07,500
introduction and I won't go any any

209
00:09:07,500 --> 00:09:08,940
detail on what became the most

210
00:09:08,940 --> 00:09:11,220
devastating and costly Cyber attack in

211
00:09:11,220 --> 00:09:12,060
history

212
00:09:12,060 --> 00:09:13,860
I'll just mention and give credit to

213
00:09:13,860 --> 00:09:16,380
Anton who discovered the origin or or

214
00:09:16,380 --> 00:09:19,560
the patient zero of the outbreak and and

215
00:09:19,560 --> 00:09:20,820
uh

216
00:09:20,820 --> 00:09:23,100
found out that it originated from a

217
00:09:23,100 --> 00:09:26,160
supply chain compromise of Emmy Doc and

218
00:09:26,160 --> 00:09:28,440
therefore made the attribution link that

219
00:09:28,440 --> 00:09:31,260
now pekia was the work of sand worm as

220
00:09:31,260 --> 00:09:33,380
well

221
00:09:34,380 --> 00:09:39,000
in 2018 we discovered and a tell about

222
00:09:39,000 --> 00:09:42,540
backdoor called exermel

223
00:09:42,540 --> 00:09:44,880
and the significance of this is that

224
00:09:44,880 --> 00:09:47,940
after one and a half years this was the

225
00:09:47,940 --> 00:09:50,700
first hard evidence for attributing in

226
00:09:50,700 --> 00:09:54,300
Destroyer to sandworm based on code

227
00:09:54,300 --> 00:09:56,839
similarity so all of these conclusions

228
00:09:56,839 --> 00:09:59,279
that we're making all of these you know

229
00:09:59,279 --> 00:10:01,200
links putting together pieces of the

230
00:10:01,200 --> 00:10:03,240
puzzle we have to actually back them up

231
00:10:03,240 --> 00:10:05,700
with with Clues code similarities

232
00:10:05,700 --> 00:10:07,980
execution chains share Network

233
00:10:07,980 --> 00:10:11,360
infrastructure and so on

234
00:10:12,000 --> 00:10:14,279
then in the following years we saw

235
00:10:14,279 --> 00:10:17,519
sandworm attacks in Ukraine but also in

236
00:10:17,519 --> 00:10:19,860
other countries there was Olympic

237
00:10:19,860 --> 00:10:23,399
destroyer in Korea gray energy also in

238
00:10:23,399 --> 00:10:24,660
Poland

239
00:10:24,660 --> 00:10:28,040
um sand time uh in Georgia turkey

240
00:10:28,040 --> 00:10:30,779
experiment was also found in France

241
00:10:30,779 --> 00:10:34,560
so the gru attackers continue to be

242
00:10:34,560 --> 00:10:37,200
active but they get a much lower profile

243
00:10:37,200 --> 00:10:38,700
they were no longer you know in

244
00:10:38,700 --> 00:10:42,480
mainstream media like the years before

245
00:10:42,480 --> 00:10:45,380
until now

246
00:10:45,839 --> 00:10:48,300
on February 23rd

247
00:10:48,300 --> 00:10:49,740
this year

248
00:10:49,740 --> 00:10:53,459
just before 5 PM Ukrainian time

249
00:10:53,459 --> 00:10:56,579
which is just a few hours before the

250
00:10:56,579 --> 00:10:58,800
Russian military Invasion we detected

251
00:10:58,800 --> 00:11:02,040
attacks by malware called hermetic wiper

252
00:11:02,040 --> 00:11:04,620
in Ukraine

253
00:11:04,620 --> 00:11:06,720
and not expecting what would happen the

254
00:11:06,720 --> 00:11:08,760
next morning obviously but with the

255
00:11:08,760 --> 00:11:11,040
escalations and the Russian army

256
00:11:11,040 --> 00:11:13,200
stationed at the Ukrainian border we

257
00:11:13,200 --> 00:11:15,000
felt that this discovery was something

258
00:11:15,000 --> 00:11:17,040
that shouldn't be reserved for for our

259
00:11:17,040 --> 00:11:19,260
private threat Intel customers only but

260
00:11:19,260 --> 00:11:20,760
we wanted to share it with the community

261
00:11:20,760 --> 00:11:24,600
and we did that in this Twitter thread

262
00:11:24,600 --> 00:11:26,160
uh

263
00:11:26,160 --> 00:11:29,100
hermetic wiper was found on hundreds of

264
00:11:29,100 --> 00:11:31,560
systems in multiple organizations and it

265
00:11:31,560 --> 00:11:34,740
was a pure Act of cyber sabotage

266
00:11:34,740 --> 00:11:36,540
so he was trying to render the computers

267
00:11:36,540 --> 00:11:39,959
in these organizations on bootable and

268
00:11:39,959 --> 00:11:42,360
in effect any public-facing Services

269
00:11:42,360 --> 00:11:44,399
inaccessible

270
00:11:44,399 --> 00:11:46,440
and it was only the first in a series of

271
00:11:46,440 --> 00:11:48,660
wipers that we discovered in Ukraine

272
00:11:48,660 --> 00:11:50,660
since February

273
00:11:50,660 --> 00:11:54,060
and their their technical level varied

274
00:11:54,060 --> 00:11:56,040
and caddy wiper was one of the more

275
00:11:56,040 --> 00:11:57,839
advanced ones

276
00:11:57,839 --> 00:11:59,820
one notable feature that I'll mention is

277
00:11:59,820 --> 00:12:01,980
that it was abusing a driver of

278
00:12:01,980 --> 00:12:03,740
legitimate this partitioning software

279
00:12:03,740 --> 00:12:05,880
for its lower level file system

280
00:12:05,880 --> 00:12:08,540
operations

281
00:12:08,579 --> 00:12:11,700
the compilation timestamp suggests that

282
00:12:11,700 --> 00:12:13,560
the malware was prepared at least

283
00:12:13,560 --> 00:12:18,560
several months before it was deployed

284
00:12:18,660 --> 00:12:20,700
but hermetic wiper wasn't the only

285
00:12:20,700 --> 00:12:23,579
malware used in this campaign

286
00:12:23,579 --> 00:12:26,579
there was a worm that we call Our

287
00:12:26,579 --> 00:12:29,100
Calling hermetic wizard for spreading

288
00:12:29,100 --> 00:12:31,500
across the network there was hermetic

289
00:12:31,500 --> 00:12:32,820
Ransom

290
00:12:32,820 --> 00:12:36,839
Which is far ransomware like not petia

291
00:12:36,839 --> 00:12:38,820
by the way one of the components in

292
00:12:38,820 --> 00:12:42,060
hermetic wizard was named by the

293
00:12:42,060 --> 00:12:44,100
attacker's romance dll

294
00:12:44,100 --> 00:12:46,560
probably a reference to Eternal romance

295
00:12:46,560 --> 00:12:48,600
even though no exploits were actually

296
00:12:48,600 --> 00:12:51,620
used in this case

297
00:12:52,079 --> 00:12:54,060
and if you think about it

298
00:12:54,060 --> 00:12:58,139
it's kind of strange to employ a wiper

299
00:12:58,139 --> 00:13:01,620
and a decoy ransomware

300
00:13:01,620 --> 00:13:03,240
which are essentially doing the same

301
00:13:03,240 --> 00:13:06,000
thing right in one campaign

302
00:13:06,000 --> 00:13:08,760
moreover hermetic Ransom was poorly

303
00:13:08,760 --> 00:13:10,980
written in contrast to her medic

304
00:13:10,980 --> 00:13:13,500
hermetic Ransom poorly written compared

305
00:13:13,500 --> 00:13:15,779
to her medic wiper

306
00:13:15,779 --> 00:13:17,700
and one possible explanation for that is

307
00:13:17,700 --> 00:13:20,399
that the malware was being deployed

308
00:13:20,399 --> 00:13:22,860
through group policy so the machines

309
00:13:22,860 --> 00:13:26,160
would download it at different times as

310
00:13:26,160 --> 00:13:28,440
they were being turned on and the

311
00:13:28,440 --> 00:13:30,060
attackers probably tried to deploy her

312
00:13:30,060 --> 00:13:32,279
medic Ransom after they discovered that

313
00:13:32,279 --> 00:13:34,860
we were detecting and blocking hermetic

314
00:13:34,860 --> 00:13:37,220
wiper

315
00:13:37,320 --> 00:13:39,959
here's the ransom message displayed by

316
00:13:39,959 --> 00:13:41,420
hermetic Ransom

317
00:13:41,420 --> 00:13:45,060
and here are some Easter eggs found in

318
00:13:45,060 --> 00:13:47,359
the code

319
00:13:48,899 --> 00:13:52,440
then on March 14th

320
00:13:52,440 --> 00:13:55,740
we discovered another wiper caddy wiper

321
00:13:55,740 --> 00:13:58,500
and I won't go into the detail and I

322
00:13:58,500 --> 00:14:00,959
also won't be covering all of every

323
00:14:00,959 --> 00:14:03,120
wiper attack because we discovered quite

324
00:14:03,120 --> 00:14:04,800
a few since February

325
00:14:04,800 --> 00:14:07,200
but I encourage you to check out a

326
00:14:07,200 --> 00:14:09,000
broader presentation on the Ukrainian

327
00:14:09,000 --> 00:14:11,459
cyber War by Jax and Tom Hegel this

328
00:14:11,459 --> 00:14:13,579
afternoon

329
00:14:14,760 --> 00:14:16,440
but I'll stick with caddy wiper for just

330
00:14:16,440 --> 00:14:18,540
a second because it was notable because

331
00:14:18,540 --> 00:14:21,720
we later saw it again in the in

332
00:14:21,720 --> 00:14:23,639
Destroyer 2 incident

333
00:14:23,639 --> 00:14:26,519
so this March 14th attack was targeting

334
00:14:26,519 --> 00:14:29,040
organizations in the financial sector

335
00:14:29,040 --> 00:14:31,200
and from a technical point of view it's

336
00:14:31,200 --> 00:14:33,600
not too interesting

337
00:14:33,600 --> 00:14:35,639
um one notable thing I'll mention is

338
00:14:35,639 --> 00:14:37,860
that it was avoiding destroying data on

339
00:14:37,860 --> 00:14:39,839
domain controllers

340
00:14:39,839 --> 00:14:42,899
to regain retain access inside

341
00:14:42,899 --> 00:14:46,680
organizations while still disrupting uh

342
00:14:46,680 --> 00:14:49,219
operations

343
00:14:55,320 --> 00:14:57,560
okay

344
00:14:57,560 --> 00:15:01,680
now on to the events of April 8.

345
00:15:01,680 --> 00:15:04,740
so we were contacted by cert UA to help

346
00:15:04,740 --> 00:15:07,320
them respond to a cyber incident at an

347
00:15:07,320 --> 00:15:09,779
energy provider and to help them analyze

348
00:15:09,779 --> 00:15:11,880
as a suspicious piece of malware

349
00:15:11,880 --> 00:15:14,040
and our analysis found that the threat

350
00:15:14,040 --> 00:15:16,560
was bigger than expected it was a new

351
00:15:16,560 --> 00:15:18,420
version of in Destroyer

352
00:15:18,420 --> 00:15:20,579
something which we haven't seen for the

353
00:15:20,579 --> 00:15:22,440
past five years

354
00:15:22,440 --> 00:15:24,779
on a positive note

355
00:15:24,779 --> 00:15:26,880
while the first in Destroyer incident

356
00:15:26,880 --> 00:15:29,579
caused the blackout lasting around one

357
00:15:29,579 --> 00:15:30,480
hour

358
00:15:30,480 --> 00:15:33,300
this latest one didn't even accomplish

359
00:15:33,300 --> 00:15:34,920
that

360
00:15:34,920 --> 00:15:37,740
so the attack was thwarted thanks to a

361
00:15:37,740 --> 00:15:39,779
prompt response by The Defenders at the

362
00:15:39,779 --> 00:15:41,880
targeted interval company the work of

363
00:15:41,880 --> 00:15:44,699
cert UA and our assistance

364
00:15:44,699 --> 00:15:47,820
but although no blackout took place it

365
00:15:47,820 --> 00:15:49,500
was still a big deal

366
00:15:49,500 --> 00:15:51,240
because had it had the attack been

367
00:15:51,240 --> 00:15:52,620
successful

368
00:15:52,620 --> 00:15:55,079
theoretically more than 2 million people

369
00:15:55,079 --> 00:15:57,600
could have been left in the dark since

370
00:15:57,600 --> 00:16:00,720
the targeted the provider of electricity

371
00:16:00,720 --> 00:16:02,760
in a region with that many people

372
00:16:02,760 --> 00:16:05,220
so in our opinion this was the most

373
00:16:05,220 --> 00:16:07,139
significant Cyber attack even if

374
00:16:07,139 --> 00:16:11,100
unsuccessful during the war thus far

375
00:16:11,100 --> 00:16:13,740
and now I will pass over the microphone

376
00:16:13,740 --> 00:16:16,019
into Victor should you share his

377
00:16:16,019 --> 00:16:19,160
insights on the incident

378
00:16:20,279 --> 00:16:22,320
thank you Robert thank you Anton for

379
00:16:22,320 --> 00:16:24,540
calculating me join you in this

380
00:16:24,540 --> 00:16:26,940
presentation uh it's a privilege for me

381
00:16:26,940 --> 00:16:28,800
to be a black cat for the very first

382
00:16:28,800 --> 00:16:29,760
time

383
00:16:29,760 --> 00:16:32,459
and second I would like to express my

384
00:16:32,459 --> 00:16:35,040
gratitude to all Partners who continue

385
00:16:35,040 --> 00:16:38,759
to support us in this unprecedented war

386
00:16:38,759 --> 00:16:42,180
in our struggle for existence

387
00:16:42,180 --> 00:16:45,899
uh this uh this is perhaps the biggest

388
00:16:45,899 --> 00:16:48,899
challenge uh from World War II for the

389
00:16:48,899 --> 00:16:50,940
whole world and it continues to be

390
00:16:50,940 --> 00:16:53,820
completely new in cyberspace

391
00:16:53,820 --> 00:16:57,420
uh and uh a lot of our I would say this

392
00:16:57,420 --> 00:16:59,339
word cyber friends continue to support

393
00:16:59,339 --> 00:17:01,860
us and provide assistance with software

394
00:17:01,860 --> 00:17:03,720
Hardware

395
00:17:03,720 --> 00:17:05,599
clouds

396
00:17:05,599 --> 00:17:07,980
consultancy service and threat

397
00:17:07,980 --> 00:17:10,520
intelligence

398
00:17:10,740 --> 00:17:14,939
um and uh two of uh I would name these

399
00:17:14,939 --> 00:17:17,220
companies most of them are here but uh

400
00:17:17,220 --> 00:17:20,000
two of them is it in Microsoft

401
00:17:20,000 --> 00:17:22,500
historically uh

402
00:17:22,500 --> 00:17:25,439
uh I've gained the largest coverage on

403
00:17:25,439 --> 00:17:29,040
Ukrainian networks and endpoints and

404
00:17:29,040 --> 00:17:31,500
this allowed them to uh to continue

405
00:17:31,500 --> 00:17:36,299
being a two measure Telemetry providers

406
00:17:36,299 --> 00:17:38,640
in Ukraine

407
00:17:38,640 --> 00:17:42,360
and uh is it worked hardly for 20 years

408
00:17:42,360 --> 00:17:45,539
to gain this coverage and as Robert

409
00:17:45,539 --> 00:17:46,980
mentioned uh

410
00:17:46,980 --> 00:17:49,799
it is contributed to the first in

411
00:17:49,799 --> 00:17:54,418
Destroyer case in 2016.

412
00:17:54,480 --> 00:17:56,880
uh as most of the audience are familiar

413
00:17:56,880 --> 00:17:59,220
with uh the number of cyber incident

414
00:17:59,220 --> 00:18:02,400
report in the first time uh first months

415
00:18:02,400 --> 00:18:03,539
of War

416
00:18:03,539 --> 00:18:07,980
but uh however the community and experts

417
00:18:07,980 --> 00:18:09,840
and Ukrainian Sovereign Defenders were

418
00:18:09,840 --> 00:18:11,940
expecting for

419
00:18:11,940 --> 00:18:15,299
significantly more

420
00:18:15,299 --> 00:18:18,179
sophisticated uh incidents and cyber

421
00:18:18,179 --> 00:18:20,600
attacks

422
00:18:21,020 --> 00:18:23,840
there are a number of reasons

423
00:18:23,840 --> 00:18:26,100
why uh

424
00:18:26,100 --> 00:18:29,700
well I didn't cancel but uh in the end

425
00:18:29,700 --> 00:18:32,520
of March and in the beginning of April

426
00:18:32,520 --> 00:18:35,280
we face with a number of really huge

427
00:18:35,280 --> 00:18:38,039
incidents and one is in Destroyer two

428
00:18:38,039 --> 00:18:40,620
so but up to the moment since the

429
00:18:40,620 --> 00:18:44,220
beginning of year we registered 1000 and

430
00:18:44,220 --> 00:18:50,000
600 major cyber incident and uh

431
00:18:50,360 --> 00:18:54,419
1074 from February 24th

432
00:18:54,419 --> 00:18:56,880
so most of these attackers are focusing

433
00:18:56,880 --> 00:18:59,340
critical infrastructure and government

434
00:18:59,340 --> 00:19:01,679
agencies and based on experience we

435
00:19:01,679 --> 00:19:04,760
gained from the last eight years of

436
00:19:04,760 --> 00:19:07,620
cyber aggression against Ukraine we

437
00:19:07,620 --> 00:19:10,679
continue being very attentive to all

438
00:19:10,679 --> 00:19:14,280
tips we receive regarding the energy

439
00:19:14,280 --> 00:19:16,760
sector

440
00:19:18,179 --> 00:19:19,919
um and uh

441
00:19:19,919 --> 00:19:23,460
it's uh our privilege for third UA

442
00:19:23,460 --> 00:19:26,340
having a lot of communication a lot of

443
00:19:26,340 --> 00:19:29,880
cooperation with many uh

444
00:19:29,880 --> 00:19:32,039
um cyber intelligence providers and it's

445
00:19:32,039 --> 00:19:33,660
been a big privilege for me to have

446
00:19:33,660 --> 00:19:38,100
direct contacts with uh Kim makers in in

447
00:19:38,100 --> 00:19:40,740
cyber intelligence companies who can

448
00:19:40,740 --> 00:19:44,520
quickly send us tips uh if any anything

449
00:19:44,520 --> 00:19:46,799
serious is happening and that was the

450
00:19:46,799 --> 00:19:49,860
exact case when we received tips from

451
00:19:49,860 --> 00:19:54,860
Microsoft and for from uh ESET

452
00:19:56,220 --> 00:20:00,480
and we immediately reached the victim to

453
00:20:00,480 --> 00:20:03,120
check whether there are false positives

454
00:20:03,120 --> 00:20:05,220
or not

455
00:20:05,220 --> 00:20:07,980
and uh when we receive this confirmation

456
00:20:07,980 --> 00:20:10,200
from them that there are potential

457
00:20:10,200 --> 00:20:12,960
issues we gain access to the network and

458
00:20:12,960 --> 00:20:15,419
started providing incident response and

459
00:20:15,419 --> 00:20:19,320
we discovered lately that uh perhaps the

460
00:20:19,320 --> 00:20:21,200
initial compromise happened even before

461
00:20:21,200 --> 00:20:25,200
February 17th

462
00:20:28,679 --> 00:20:32,820
um I will say just few words uh

463
00:20:32,820 --> 00:20:35,880
explaining why this operation is so

464
00:20:35,880 --> 00:20:37,140
complex

465
00:20:37,140 --> 00:20:40,320
so it's not about in Destroyer 2 this

466
00:20:40,320 --> 00:20:43,080
malware specifically designed for the

467
00:20:43,080 --> 00:20:44,460
ICS

468
00:20:44,460 --> 00:20:48,179
it's a well planned and technically

469
00:20:48,179 --> 00:20:49,860
sophisticated operation with a lot of

470
00:20:49,860 --> 00:20:51,960
tools we later discovered for example

471
00:20:51,960 --> 00:20:55,080
load maze malware for Windows

472
00:20:55,080 --> 00:20:56,580
workstations

473
00:20:56,580 --> 00:20:58,799
uh with an algorithm which is waiting

474
00:20:58,799 --> 00:21:00,120
for letter z

475
00:21:00,120 --> 00:21:03,539
letter z uh has become a symbol of the

476
00:21:03,539 --> 00:21:05,039
invasion

477
00:21:05,039 --> 00:21:07,980
we also discovered um metal operator

478
00:21:07,980 --> 00:21:11,100
backdoor specifically designed for free

479
00:21:11,100 --> 00:21:13,559
business for Linux service

480
00:21:13,559 --> 00:21:17,160
and so we saw that attackers used a lot

481
00:21:17,160 --> 00:21:19,919
of wiper scripts like awful Shredder

482
00:21:19,919 --> 00:21:22,919
solo shred and they are orchestrator orc

483
00:21:22,919 --> 00:21:24,120
Shred

484
00:21:24,120 --> 00:21:27,059
to clean the logs of their presence and

485
00:21:27,059 --> 00:21:29,940
the same was done for uh for Windows

486
00:21:29,940 --> 00:21:32,820
workstations the overall idea was to

487
00:21:32,820 --> 00:21:34,559
provide this blackout

488
00:21:34,559 --> 00:21:37,380
in the end of Friday

489
00:21:37,380 --> 00:21:41,700
so the scheduler was pre-configured for

490
00:21:41,700 --> 00:21:45,600
uh five uh 58 pm

491
00:21:45,600 --> 00:21:49,220
expecting when most of

492
00:21:49,220 --> 00:21:51,059
administrative staff and all

493
00:21:51,059 --> 00:21:52,440
workstations

494
00:21:52,440 --> 00:21:55,559
all workstations are still on and this

495
00:21:55,559 --> 00:21:58,260
level speaking their things going home

496
00:21:58,260 --> 00:22:01,080
so this blackout would cause a serious

497
00:22:01,080 --> 00:22:03,059
impact on up to 2 million people which

498
00:22:03,059 --> 00:22:05,960
Robert just mentioned

499
00:22:06,059 --> 00:22:07,880
um and uh

500
00:22:07,880 --> 00:22:11,159
the overall impact we can just just

501
00:22:11,159 --> 00:22:14,400
imagine so there is Friday evening

502
00:22:14,400 --> 00:22:18,120
and uh we can't uh

503
00:22:18,120 --> 00:22:22,140
um uh it is coming soon and uh people

504
00:22:22,140 --> 00:22:24,840
watching TV watching news or this is

505
00:22:24,840 --> 00:22:27,960
exactly with the middle of uh of active

506
00:22:27,960 --> 00:22:30,480
phase of invasion

507
00:22:30,480 --> 00:22:34,140
so we consider this to be a kind of

508
00:22:34,140 --> 00:22:36,120
supportive operation to a lot of

509
00:22:36,120 --> 00:22:38,460
connection uh conventional operations

510
00:22:38,460 --> 00:22:41,820
that happen each day and this is a

511
00:22:41,820 --> 00:22:43,940
totally destructive faction

512
00:22:43,940 --> 00:22:46,620
focusing on completely civilian

513
00:22:46,620 --> 00:22:48,299
infrastructure

514
00:22:48,299 --> 00:22:50,159
to our point of view

515
00:22:50,159 --> 00:22:53,580
and uh Anton will later go through all

516
00:22:53,580 --> 00:22:55,919
these sophisticated tools that were used

517
00:22:55,919 --> 00:22:58,679
together with in Destroyer to focusing

518
00:22:58,679 --> 00:23:02,940
on RCS component but the idea was to to

519
00:23:02,940 --> 00:23:05,100
switch hand to wiper all the

520
00:23:05,100 --> 00:23:06,600
infrastructure

521
00:23:06,600 --> 00:23:08,340
but

522
00:23:08,340 --> 00:23:11,820
these attackers uh

523
00:23:11,820 --> 00:23:14,280
missed one very important thing that

524
00:23:14,280 --> 00:23:16,919
Friday is a short Working Day and most

525
00:23:16,919 --> 00:23:19,860
of most of people and their work in 5 PM

526
00:23:19,860 --> 00:23:25,080
or even 4 P.M so and 5 58 or

527
00:23:25,080 --> 00:23:28,740
95 of Works percent of workstations were

528
00:23:28,740 --> 00:23:32,280
Switched Off so they weren't wiped and

529
00:23:32,280 --> 00:23:35,280
this allowed to to get a full picture

530
00:23:35,280 --> 00:23:36,600
and uh

531
00:23:36,600 --> 00:23:38,820
after uh

532
00:23:38,820 --> 00:23:42,120
after getting an access to network it

533
00:23:42,120 --> 00:23:45,240
took less than 12 hours for us to come

534
00:23:45,240 --> 00:23:48,659
to initial conclusions and share iocs of

535
00:23:48,659 --> 00:23:52,200
industrial 2 with 5 selected partner

536
00:23:52,200 --> 00:23:53,480
companies

537
00:23:53,480 --> 00:23:57,659
just to add these ircs to their database

538
00:23:57,659 --> 00:23:59,880
and

539
00:23:59,880 --> 00:24:01,919
the interesting case and completely

540
00:24:01,919 --> 00:24:07,080
different story why why it uh what was

541
00:24:07,080 --> 00:24:09,419
published in the Press so it was fast to

542
00:24:09,419 --> 00:24:11,780
the press and even was posted on Twitter

543
00:24:11,780 --> 00:24:14,940
this TLP Amber document which we shared

544
00:24:14,940 --> 00:24:17,100
with our partners and that was one of

545
00:24:17,100 --> 00:24:20,640
the reasons we decided to uh to organize

546
00:24:20,640 --> 00:24:23,100
a presser and why the deputy minister of

547
00:24:23,100 --> 00:24:25,500
energy to this and share this story to

548
00:24:25,500 --> 00:24:27,539
world to our opinion this is important

549
00:24:27,539 --> 00:24:29,940
for community and this is an act of

550
00:24:29,940 --> 00:24:32,640
aggression against civilian

551
00:24:32,640 --> 00:24:34,980
infrastructure another one act of

552
00:24:34,980 --> 00:24:38,000
regression from Russia's side in this

553
00:24:38,000 --> 00:24:41,159
hybrid hybrid war and cyber aggression

554
00:24:41,159 --> 00:24:44,000
and that basically allowed a lot of

555
00:24:44,000 --> 00:24:47,419
companies making their brilliant reports

556
00:24:47,419 --> 00:24:53,240
on Industrial uh like ESET Cisco Dallas

557
00:24:53,240 --> 00:24:55,860
these two companies help us in incident

558
00:24:55,860 --> 00:24:58,440
response Mandy and Microsoft and many

559
00:24:58,440 --> 00:24:59,460
others

560
00:24:59,460 --> 00:25:02,100
so that's it

561
00:25:02,100 --> 00:25:05,220
Robert back over to you thank you thank

562
00:25:05,220 --> 00:25:09,140
you Victor that was very insightful

563
00:25:14,520 --> 00:25:17,039
so let's continue with a quick recap of

564
00:25:17,039 --> 00:25:18,480
the original first version of in

565
00:25:18,480 --> 00:25:21,360
destroyer and it was unique not only

566
00:25:21,360 --> 00:25:22,919
because it was the first malware

567
00:25:22,919 --> 00:25:24,539
specifically designed to attack power

568
00:25:24,539 --> 00:25:27,419
grids but also it was only the second

569
00:25:27,419 --> 00:25:29,580
ever malware deployed to cause physical

570
00:25:29,580 --> 00:25:32,279
damage to Industrial Hardware the first

571
00:25:32,279 --> 00:25:34,620
being stuxnet and then the third

572
00:25:34,620 --> 00:25:38,100
afterwards being Triton

573
00:25:38,100 --> 00:25:40,020
so its first goal was to de-energize

574
00:25:40,020 --> 00:25:42,539
power lines to open circuit breakers at

575
00:25:42,539 --> 00:25:45,179
a preset time using one of its payload

576
00:25:45,179 --> 00:25:47,220
modules and will show the architecture

577
00:25:47,220 --> 00:25:48,720
in just a second

578
00:25:48,720 --> 00:25:51,480
ly the attackers would wipe scada

579
00:25:51,480 --> 00:25:53,880
software so that operators couldn't see

580
00:25:53,880 --> 00:25:55,740
the status of the environment they

581
00:25:55,740 --> 00:25:58,500
couldn't control it that was being that

582
00:25:58,500 --> 00:26:00,360
was supposed to be done by the wiper

583
00:26:00,360 --> 00:26:02,940
component that you can see here so you

584
00:26:02,940 --> 00:26:04,799
can see that sandworm has a really long

585
00:26:04,799 --> 00:26:07,620
history of wiping malware

586
00:26:07,620 --> 00:26:09,840
and this module specifically wipes files

587
00:26:09,840 --> 00:26:12,000
belonging to scada software and then

588
00:26:12,000 --> 00:26:14,760
makes the control station unbootable by

589
00:26:14,760 --> 00:26:16,320
corrupting its critical files and

590
00:26:16,320 --> 00:26:18,600
crashing it and rebooting it and it

591
00:26:18,600 --> 00:26:20,760
wouldn't boot

592
00:26:20,760 --> 00:26:23,760
um third the industry would attempt to

593
00:26:23,760 --> 00:26:26,340
take out protection relays and these

594
00:26:26,340 --> 00:26:28,080
play a really important role because

595
00:26:28,080 --> 00:26:30,600
they are there to protect the power grid

596
00:26:30,600 --> 00:26:33,059
from harmful conditions and if disabled

597
00:26:33,059 --> 00:26:35,220
the grid could potentially become

598
00:26:35,220 --> 00:26:38,400
vulnerable and that was supposed to be

599
00:26:38,400 --> 00:26:41,279
done by the denial of service module it

600
00:26:41,279 --> 00:26:43,679
was trying to exploit a vulnerability in

601
00:26:43,679 --> 00:26:46,200
Siemens ciprotech devices by sending a

602
00:26:46,200 --> 00:26:48,840
specially crafted UDP packet to Port 50

603
00:26:48,840 --> 00:26:51,480
000 which would switch the protection

604
00:26:51,480 --> 00:26:53,940
relay into a firmware update mode where

605
00:26:53,940 --> 00:26:55,980
it would be stuck and effectively not

606
00:26:55,980 --> 00:26:58,380
doing its job

607
00:26:58,380 --> 00:27:01,440
then the utility operators would attempt

608
00:27:01,440 --> 00:27:03,299
to restore power we close the breakers

609
00:27:03,299 --> 00:27:05,820
manually and if the protective relays

610
00:27:05,820 --> 00:27:08,220
had been disabled the grid could become

611
00:27:08,220 --> 00:27:10,919
unstable and possibly lead to even

612
00:27:10,919 --> 00:27:13,919
physical damage of Hardware so had this

613
00:27:13,919 --> 00:27:16,080
been successful it wasn't but had it

614
00:27:16,080 --> 00:27:18,120
been the outage could have lasted much

615
00:27:18,120 --> 00:27:19,799
longer than it did

616
00:27:19,799 --> 00:27:22,919
so the Russians had higher Ambitions in

617
00:27:22,919 --> 00:27:25,620
the industry attack but failed in part

618
00:27:25,620 --> 00:27:27,600
because of better resilience of the

619
00:27:27,600 --> 00:27:29,940
Ukrainian Defenders based on experience

620
00:27:29,940 --> 00:27:32,880
from the year prior to this and in part

621
00:27:32,880 --> 00:27:34,919
because of coding mistakes that the

622
00:27:34,919 --> 00:27:36,840
attackers made

623
00:27:36,840 --> 00:27:38,700
here's a quick look at the architecture

624
00:27:38,700 --> 00:27:42,720
uh it's a modular framework there's a

625
00:27:42,720 --> 00:27:44,400
launcher component that's responsible

626
00:27:44,400 --> 00:27:46,919
for timing the attack and it has a

627
00:27:46,919 --> 00:27:49,380
hard-coded time when to launch those

628
00:27:49,380 --> 00:27:52,140
payload modules that implemented four

629
00:27:52,140 --> 00:27:53,700
different industrial communication

630
00:27:53,700 --> 00:27:56,100
protocols that you can see listed there

631
00:27:56,100 --> 00:27:59,520
most of these were dlls each with their

632
00:27:59,520 --> 00:28:01,860
own configuration files and I'll focus

633
00:28:01,860 --> 00:28:04,679
on IEC 104 as that's the one that's also

634
00:28:04,679 --> 00:28:08,100
used in industry 2. so the protocol

635
00:28:08,100 --> 00:28:11,279
itself is a network extension of ic101 a

636
00:28:11,279 --> 00:28:13,620
telecontrol protocol used in power grids

637
00:28:13,620 --> 00:28:16,080
and it's extensive I mean no need to go

638
00:28:16,080 --> 00:28:18,659
into details the important thing and the

639
00:28:18,659 --> 00:28:20,880
problem is that it was designed decades

640
00:28:20,880 --> 00:28:23,760
ago without focusing on security there

641
00:28:23,760 --> 00:28:25,559
is no Authentication

642
00:28:25,559 --> 00:28:28,200
it operates using a client server model

643
00:28:28,200 --> 00:28:31,020
so the control station is the client the

644
00:28:31,020 --> 00:28:32,940
remote station is the server

645
00:28:32,940 --> 00:28:36,059
and what the malware is doing is that

646
00:28:36,059 --> 00:28:38,100
it's creating and transmitting so-called

647
00:28:38,100 --> 00:28:41,039
asdu messages to change the state of the

648
00:28:41,039 --> 00:28:43,559
remote station iOS information object

649
00:28:43,559 --> 00:28:47,039
addresses to the state off

650
00:28:47,039 --> 00:28:50,039
now what those ioas map to exactly

651
00:28:50,039 --> 00:28:52,380
depends on the configuration file of the

652
00:28:52,380 --> 00:28:54,779
configuration uh in the substation

653
00:28:54,779 --> 00:28:56,279
environment

654
00:28:56,279 --> 00:28:59,220
and in Destroyer creates those telegrams

655
00:28:59,220 --> 00:29:01,380
based on its own configuration and

656
00:29:01,380 --> 00:29:03,419
here's a dummy example not one actually

657
00:29:03,419 --> 00:29:04,880
recovered

658
00:29:04,880 --> 00:29:08,400
there's a station IP and a port

659
00:29:08,400 --> 00:29:11,940
there's a process to kill so this is a

660
00:29:11,940 --> 00:29:13,559
process of the legitimate scada

661
00:29:13,559 --> 00:29:15,779
application running in the environment

662
00:29:15,779 --> 00:29:20,039
to avoid potential conflict

663
00:29:20,039 --> 00:29:22,559
um it supports console output also

664
00:29:22,559 --> 00:29:25,080
logging as you can see on the right and

665
00:29:25,080 --> 00:29:28,799
this illustrates how the operation can

666
00:29:28,799 --> 00:29:31,559
uh can work so for example is sending

667
00:29:31,559 --> 00:29:34,500
off commands to a range of iOS from 10

668
00:29:34,500 --> 00:29:36,179
to 15.

669
00:29:36,179 --> 00:29:39,360
and now let's analyze in Destroyer 2. so

670
00:29:39,360 --> 00:29:41,820
comparing it to the first version there

671
00:29:41,820 --> 00:29:43,500
was a lot of code similarity and we can

672
00:29:43,500 --> 00:29:45,419
say that if it evolved from the same

673
00:29:45,419 --> 00:29:47,760
source code the notable differences in

674
00:29:47,760 --> 00:29:50,700
architecture are that industry 2 was

675
00:29:50,700 --> 00:29:52,919
self-contained in a single executable

676
00:29:52,919 --> 00:29:55,260
whereas the original was a modular

677
00:29:55,260 --> 00:29:57,720
framework and it only implemented the

678
00:29:57,720 --> 00:30:00,240
ic104 protocol

679
00:30:00,240 --> 00:30:02,820
uh the configuration in this case was

680
00:30:02,820 --> 00:30:04,020
embedded

681
00:30:04,020 --> 00:30:06,179
so that means that for deployments with

682
00:30:06,179 --> 00:30:08,220
different configurations the attackers

683
00:30:08,220 --> 00:30:10,860
would have to recompile it each time

684
00:30:10,860 --> 00:30:13,620
we analyzed two samples with different

685
00:30:13,620 --> 00:30:16,320
configurations both of them appear to be

686
00:30:16,320 --> 00:30:19,559
compiled on March 23rd

687
00:30:19,559 --> 00:30:21,179
but that's just the compilation

688
00:30:21,179 --> 00:30:22,860
timestamp as Victor mentioned the

689
00:30:22,860 --> 00:30:25,399
attackers had been planning this attack

690
00:30:25,399 --> 00:30:27,240
months ahead

691
00:30:27,240 --> 00:30:29,520
and now I pass the words to Anton to

692
00:30:29,520 --> 00:30:31,140
walk you through the details of the

693
00:30:31,140 --> 00:30:32,220
config

694
00:30:32,220 --> 00:30:34,100
thank you

695
00:30:34,100 --> 00:30:37,500
so the new configuration format is

696
00:30:37,500 --> 00:30:40,440
stored as a hard-coded string so

697
00:30:40,440 --> 00:30:42,779
industrator 2 is able to communicate

698
00:30:42,779 --> 00:30:46,159
with multiple devices at once

699
00:30:46,159 --> 00:30:49,620
one sample it can that we analyze

700
00:30:49,620 --> 00:30:53,700
contains three such IP addresses and

701
00:30:53,700 --> 00:30:57,620
other sample contains eight

702
00:30:57,779 --> 00:31:00,899
so this is example of the configuration

703
00:31:00,899 --> 00:31:04,520
you see IP address port number

704
00:31:04,520 --> 00:31:07,620
range mode but it's not used in the

705
00:31:07,620 --> 00:31:10,580
samples

706
00:31:10,799 --> 00:31:13,860
name of legitimately process to

707
00:31:13,860 --> 00:31:17,100
terminate and then it renames the file

708
00:31:17,100 --> 00:31:20,480
in order to

709
00:31:20,539 --> 00:31:24,140
disable or

710
00:31:25,460 --> 00:31:28,100
disable the execution

711
00:31:28,100 --> 00:31:31,380
to prevent automatic execution of this

712
00:31:31,380 --> 00:31:36,860
software and then there are these iOS

713
00:31:36,860 --> 00:31:42,659
in one sample we found 110 iOS in order

714
00:31:42,659 --> 00:31:47,179
sample we found 68 iOS

715
00:31:47,700 --> 00:31:49,159
and

716
00:31:49,159 --> 00:31:52,559
the configuration it's really similar to

717
00:31:52,559 --> 00:31:55,679
previous one but it's just stored in a

718
00:31:55,679 --> 00:31:58,580
different format you have the same

719
00:31:58,580 --> 00:32:02,760
values there here and on the screen you

720
00:32:02,760 --> 00:32:05,580
can see packets sent by industrum

721
00:32:05,580 --> 00:32:06,840
malware

722
00:32:06,840 --> 00:32:10,880
and it's dissected by Wireshark

723
00:32:10,880 --> 00:32:14,039
the malware it generates this packet on

724
00:32:14,039 --> 00:32:17,600
the Fly and the most important

725
00:32:17,600 --> 00:32:22,080
values you can see it's a double command

726
00:32:22,080 --> 00:32:26,820
it sends ioa and the command is off

727
00:32:26,820 --> 00:32:29,880
and it's important to know that

728
00:32:29,880 --> 00:32:32,700
it does not exploit any vulnerability at

729
00:32:32,700 --> 00:32:35,399
all it just uses protocol in the way

730
00:32:35,399 --> 00:32:38,580
that it was designed to use

731
00:32:38,580 --> 00:32:41,700
and if we convert the code configuration

732
00:32:41,700 --> 00:32:45,779
in human readable format we can see that

733
00:32:45,779 --> 00:32:48,799
it sends execute off commands that is

734
00:32:48,799 --> 00:32:52,440
specific iOS

735
00:32:52,440 --> 00:32:56,640
so what this iOS do it's really hard to

736
00:32:56,640 --> 00:32:59,700
find out because you have hundreds of

737
00:32:59,700 --> 00:33:02,220
these iOS and

738
00:33:02,220 --> 00:33:06,480
uh iOS can be different from industrial

739
00:33:06,480 --> 00:33:08,760
side to Industrial side because it

740
00:33:08,760 --> 00:33:11,760
depends on equipment and on settings and

741
00:33:11,760 --> 00:33:15,120
so on however if you Google some

742
00:33:15,120 --> 00:33:19,019
specific iOS that are using industry you

743
00:33:19,019 --> 00:33:20,840
may stumble open

744
00:33:20,840 --> 00:33:24,960
documentation from ABB and

745
00:33:24,960 --> 00:33:27,659
in this documentation it says some of

746
00:33:27,659 --> 00:33:31,019
these iOS they belong to circuit breaker

747
00:33:31,019 --> 00:33:35,340
filter protection so it disables

748
00:33:35,340 --> 00:33:37,140
this protection

749
00:33:37,140 --> 00:33:41,460
when we compare code of old industrial

750
00:33:41,460 --> 00:33:44,120
to a new one you can see a lot of

751
00:33:44,120 --> 00:33:46,860
similar string constraints and similar

752
00:33:46,860 --> 00:33:48,740
code fragments

753
00:33:48,740 --> 00:33:53,880
when we compare output console output

754
00:33:53,880 --> 00:33:56,700
it's a bit changed too before it was

755
00:33:56,700 --> 00:34:01,080
more verbose it was clean and even

756
00:34:01,080 --> 00:34:04,380
colorful and now they are using some

757
00:34:04,380 --> 00:34:08,480
codes instead of text

758
00:34:08,580 --> 00:34:10,099
um

759
00:34:10,099 --> 00:34:15,418
similar to Industrial one industry 2 in

760
00:34:15,418 --> 00:34:19,099
attack in this attack they deployed

761
00:34:19,099 --> 00:34:24,240
wipers in order to make

762
00:34:24,659 --> 00:34:27,679
recovery more difficult

763
00:34:27,679 --> 00:34:32,040
so what model they use together with

764
00:34:32,040 --> 00:34:34,500
industrial they use KD Viper it's a

765
00:34:34,500 --> 00:34:39,480
Viper for Windows but uh

766
00:34:39,480 --> 00:34:44,599
um for Linux they use additional Vipers

767
00:34:45,300 --> 00:34:49,560
called Orchard solar thread awful thread

768
00:34:49,560 --> 00:34:52,500
and or set is a worm that tries to

769
00:34:52,500 --> 00:34:56,399
connect the multiple

770
00:34:56,520 --> 00:35:01,500
servers within Network and then

771
00:35:01,500 --> 00:35:04,220
it runs Viper

772
00:35:04,220 --> 00:35:07,640
this is timeline of incident

773
00:35:07,640 --> 00:35:11,040
the attackers use the scheduled task in

774
00:35:11,040 --> 00:35:14,040
order to execute malware and that's how

775
00:35:14,040 --> 00:35:17,960
we know exact time when

776
00:35:17,960 --> 00:35:22,440
operators wanted to perform this attack

777
00:35:22,440 --> 00:35:23,760
um

778
00:35:23,760 --> 00:35:26,280
at first they deployed the malware then

779
00:35:26,280 --> 00:35:31,140
they create Skidoo tasks and on on this

780
00:35:31,140 --> 00:35:33,480
time they wanted to execute in destroyer

781
00:35:33,480 --> 00:35:36,180
and 10 minutes later they wanted to

782
00:35:36,180 --> 00:35:39,780
execute the Viper

783
00:35:39,780 --> 00:35:42,540
uh

784
00:35:42,540 --> 00:35:46,380
in addition the schedule task we can see

785
00:35:46,380 --> 00:35:48,780
that the wireless wipers they're using

786
00:35:48,780 --> 00:35:53,960
Chrome and in this chrome they also

787
00:35:53,960 --> 00:35:57,540
set a specific time

788
00:35:57,540 --> 00:35:59,180
and

789
00:35:59,180 --> 00:36:03,420
these wipers they are executed based on

790
00:36:03,420 --> 00:36:04,619
the

791
00:36:04,619 --> 00:36:08,880
operation system used as a

792
00:36:08,880 --> 00:36:12,740
Solaris or Linux

793
00:36:12,920 --> 00:36:16,859
the Viper itself KD Viper is relatively

794
00:36:16,859 --> 00:36:19,380
simple it just overwrites files with

795
00:36:19,380 --> 00:36:21,260
zeros on

796
00:36:21,260 --> 00:36:25,560
disk C and other disk and then they it

797
00:36:25,560 --> 00:36:26,520
makes

798
00:36:26,520 --> 00:36:29,339
computer unbutable by corrupting

799
00:36:29,339 --> 00:36:32,839
partition table

800
00:36:33,660 --> 00:36:37,859
uh so let's talk about defense

801
00:36:37,859 --> 00:36:40,619
I'm going to evoke you through detection

802
00:36:40,619 --> 00:36:44,119
of your penises you can use

803
00:36:44,700 --> 00:36:47,480
first of all today we will release

804
00:36:47,480 --> 00:36:50,339
pickups that we captured

805
00:36:50,339 --> 00:36:51,660
um

806
00:36:51,660 --> 00:36:55,500
this pickups contained Network traffic

807
00:36:55,500 --> 00:36:59,099
produced by in destroyer and in the in

808
00:36:59,099 --> 00:37:02,780
addition we published as North Rule

809
00:37:02,780 --> 00:37:06,980
the idea behind this rule is so

810
00:37:06,980 --> 00:37:11,460
you have to identify iOS that are most

811
00:37:11,460 --> 00:37:13,440
important for your environment for

812
00:37:13,440 --> 00:37:17,599
example failure protection and and then

813
00:37:17,599 --> 00:37:20,460
you modify the rule and then you can use

814
00:37:20,460 --> 00:37:24,300
it and the fuel limitation

815
00:37:24,300 --> 00:37:27,240
of this approach first of all it's not

816
00:37:27,240 --> 00:37:30,200
always possible to

817
00:37:30,200 --> 00:37:32,940
monitor Network traffic in this kind of

818
00:37:32,940 --> 00:37:36,180
environments and also it's hard to

819
00:37:36,180 --> 00:37:39,500
identify this iOS

820
00:37:39,500 --> 00:37:42,560
and um

821
00:37:42,560 --> 00:37:46,920
other limitation is that when a rule is

822
00:37:46,920 --> 00:37:50,280
triggered it's probably too late

823
00:37:50,280 --> 00:37:52,400
and that's why

824
00:37:52,400 --> 00:37:55,680
we suggest you to

825
00:37:55,680 --> 00:37:59,579
monitor other events such as whether or

826
00:37:59,579 --> 00:38:02,579
movement via impact impact is open

827
00:38:02,579 --> 00:38:06,540
source framework the implementation of

828
00:38:06,540 --> 00:38:10,400
various Network protocols in Python and

829
00:38:10,400 --> 00:38:14,220
the tools implemented on on top of this

830
00:38:14,220 --> 00:38:16,740
protocol it's used they are used for

831
00:38:16,740 --> 00:38:19,440
remote execution so for lateral movement

832
00:38:19,440 --> 00:38:23,160
and it's heavily used by send warm

833
00:38:23,160 --> 00:38:26,760
especially the exact however we can

834
00:38:26,760 --> 00:38:30,599
detect it based on

835
00:38:30,599 --> 00:38:33,619
come online

836
00:38:33,780 --> 00:38:37,380
because the common line used by impact

837
00:38:37,380 --> 00:38:41,599
it can it contains the timestamp

838
00:38:41,599 --> 00:38:44,339
and Order

839
00:38:44,339 --> 00:38:47,560
elements and this elements are

840
00:38:47,560 --> 00:38:48,060
[Music]

841
00:38:48,060 --> 00:38:50,060
um

842
00:38:50,480 --> 00:38:57,140
always the same also you can

843
00:38:57,420 --> 00:39:00,540
try to detect metal Predator they're

844
00:39:00,540 --> 00:39:04,200
using Predator by volts reverse TCP

845
00:39:04,200 --> 00:39:06,920
reverse HTTP

846
00:39:06,920 --> 00:39:10,740
so-called load maze loader and for this

847
00:39:10,740 --> 00:39:12,900
you can use any modern endpoint

848
00:39:12,900 --> 00:39:16,980
protection and next one they're using a

849
00:39:16,980 --> 00:39:20,420
custom partial script in order to push

850
00:39:20,420 --> 00:39:24,420
schedule tasks via group policy and for

851
00:39:24,420 --> 00:39:27,599
that you can check out mid internet

852
00:39:27,599 --> 00:39:32,099
attack page when they suggest mentors on

853
00:39:32,099 --> 00:39:36,380
specific element IDs

854
00:39:37,020 --> 00:39:40,920
okay thank you Anton so let's wrap up

855
00:39:40,920 --> 00:39:42,660
um here's some further reading for you

856
00:39:42,660 --> 00:39:44,460
some really good write-ups and you'll

857
00:39:44,460 --> 00:39:46,680
find the links also in the in the slide

858
00:39:46,680 --> 00:39:49,859
deck that we shared online a couple of

859
00:39:49,859 --> 00:39:52,200
finishing sound bites so it's really

860
00:39:52,200 --> 00:39:53,880
good that both of the versions of

861
00:39:53,880 --> 00:39:55,680
Industry failed to achieve their goals

862
00:39:55,680 --> 00:39:57,720
but I'd be really careful in evaluating

863
00:39:57,720 --> 00:39:59,940
their success rate the threat shouldn't

864
00:39:59,940 --> 00:40:01,859
be hyped but also should not be

865
00:40:01,859 --> 00:40:04,500
downplayed or underestimated the threats

866
00:40:04,500 --> 00:40:06,540
are serious but they can be thwarted

867
00:40:06,540 --> 00:40:08,820
with proper security measures

868
00:40:08,820 --> 00:40:10,480
thank you

869
00:40:10,480 --> 00:40:13,020
[Applause]

870
00:40:13,020 --> 00:40:16,320
[Music]

871
00:40:20,160 --> 00:40:23,259
[Music]

