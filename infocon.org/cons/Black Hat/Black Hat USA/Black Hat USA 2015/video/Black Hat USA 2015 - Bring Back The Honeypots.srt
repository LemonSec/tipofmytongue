1
00:00:00,000 --> 00:00:05,440
good morning everyone thanks for coming
through so I'm gonna get right into it

2
00:00:05,440 --> 00:00:09,370
because we've got a lot of slides that
began at itab untrue and hopefully we'll

3
00:00:09,370 --> 00:00:13,620
get through all of them lots of slides
lots of demos so I'll be speaking

4
00:00:13,620 --> 00:00:20,590
quickly for the most part so really
quick introduction this is Marco from a

5
00:00:20,590 --> 00:00:25,070
small company called thinks there's not
much value in going into too much of

6
00:00:25,070 --> 00:00:29,810
detail except of course for the fact
that both Moscow and I have been doing

7
00:00:29,810 --> 00:00:36,129
pen testing and general offensive stuff
for very long time so most of the stuff

8
00:00:36,130 --> 00:00:41,260
that we're looking at today although
it's a defense of talk is largely to use

9
00:00:41,260 --> 00:00:47,019
the stolen phrase defense strongly
guided by a fence ok end and that's kind

10
00:00:47,020 --> 00:00:50,100
of what we going for really quickly

11
00:00:50,100 --> 00:00:54,000
a plan for what the talks going to be
about how we gonna do it we're going to

12
00:00:54,000 --> 00:00:59,309
spend a few seconds literally on history
because most of you have that but we're

13
00:00:59,309 --> 00:01:03,669
gonna try to talk about why honey pots
have failed like why we're not seeing as

14
00:01:03,670 --> 00:01:07,580
many of them as we believe we should and
then really talk about stuff that

15
00:01:07,580 --> 00:01:12,439
currently hinders adoption and at
reasonable points along the way we'll

16
00:01:12,439 --> 00:01:16,158
show you technology that we've both
technology that we are putting up for

17
00:01:16,159 --> 00:01:21,340
you guys to use so that hopefully you
don't have the stumbling blocks so

18
00:01:21,340 --> 00:01:26,100
really quickly some history if you gonna
do a talk like this the first thing that

19
00:01:26,100 --> 00:01:29,789
comes up is this clearly isn't new

20
00:01:29,790 --> 00:01:34,040
if you hit teleconference collect a site
you'll see we tracking on the hundred

21
00:01:34,040 --> 00:01:39,759
and fifty-five talks that have been
given just on honey pots so so clearly

22
00:01:39,759 --> 00:01:44,869
the stuff isn't new and if you talk
about deception in warfare deception in

23
00:01:44,869 --> 00:01:49,240
warfare has been alone for a really long
time like it probably goes all the way

24
00:01:49,240 --> 00:01:56,020
back to the garden and the military have
been using it for long enough the Joint

25
00:01:56,020 --> 00:02:02,740
Chiefs joint chief of staff have a
document out called JP 313 full which

26
00:02:02,740 --> 00:02:06,750
effectively talks about military
deception and its uses on the

27
00:02:06,750 --> 00:02:09,869
battlefield it's really interesting

28
00:02:09,869 --> 00:02:14,709
severely would reading and going through
but essentially what they categorize it

29
00:02:14,709 --> 00:02:15,920
as is

30
00:02:15,920 --> 00:02:20,690
those actions executed to deliberately
mislead you opponent giving you a better

31
00:02:20,690 --> 00:02:26,450
chance of success with your mission if
you want a bunch of really smart guys

32
00:02:26,450 --> 00:02:30,899
Tom cross good content whole bunch of
them recently did a talk on deception

33
00:02:30,900 --> 00:02:37,760
for the CyberDefender it's worth
checking out I thought you should check

34
00:02:37,760 --> 00:02:43,090
out the slides they really worth it for
all intents and purposes

35
00:02:43,090 --> 00:02:47,109
honeypot discussions really went in a
certain direction at all

36
00:02:47,109 --> 00:02:53,989
1989 1991 ok and the two big events that
happened at this point to the two big

37
00:02:53,989 --> 00:03:00,400
things would two papers while one was a
people and one was a book and the first

38
00:03:00,400 --> 00:03:05,170
1 I'm gonna probably mispronounce was
broaches rakes and evening with benefit

39
00:03:05,170 --> 00:03:12,030
in which a cracker is Lord and your Lord
and studied ok and it says Rick was

40
00:03:12,030 --> 00:03:14,569
working with a whole bunch of smart
people

41
00:03:14,569 --> 00:03:20,030
shimon mood of its a minimum effectively
spoke about tracking down an attacker

42
00:03:20,030 --> 00:03:24,340
who had broken into his network ok and
at the time it was a really simple he

43
00:03:24,340 --> 00:03:28,540
faked system scripts so that he could
see what the attacker was trying to do

44
00:03:28,540 --> 00:03:34,120
was one of the first well documented
cases of using a honeypot to understand

45
00:03:34,120 --> 00:03:39,919
you attacker what's really interesting
is that in his conclusion as rick asks

46
00:03:39,919 --> 00:03:44,989
he says I wonder how much effort this
was all what it was fun but what's the

47
00:03:44,989 --> 00:03:49,790
point of all of this and later on
actually gets to the point races it was

48
00:03:49,790 --> 00:03:54,519
educational and stuff but actually it
was too hard to get it right

49
00:03:54,519 --> 00:04:00,419
ok and already you start to see a doc
future for honey pots that way the

50
00:04:00,419 --> 00:04:05,629
Cuckoo's egg which came up next from
cathode stole children's home if you

51
00:04:05,629 --> 00:04:12,620
have read the Cuckoo's egg okay about
fifty 50 it's super interesting it was

52
00:04:12,620 --> 00:04:13,190
written

53
00:04:13,190 --> 00:04:16,920
way back in eighty nine but it's
actually dated itself

54
00:04:16,920 --> 00:04:21,310
well almost as an aside if you go
through it you'll find some really

55
00:04:21,310 --> 00:04:25,260
interesting teams like it starts off
with the disclosure debate like if you

56
00:04:25,260 --> 00:04:29,789
find a bug should you tell people about
it or should you keep it secret

57
00:04:29,790 --> 00:04:35,490
the next team that it hit on was
questions on the NSE and did they Rican

58
00:04:35,490 --> 00:04:41,170
crypto deliberately one of the other
teams that it had one and this one is

59
00:04:41,170 --> 00:04:45,580
useful for us something that says most
attackers don't succeed because of

60
00:04:45,580 --> 00:04:50,180
attackers sophistication they just poke
at the obvious places and get there

61
00:04:50,180 --> 00:04:54,860
through persistence not wizardly ok and
like I say it's held up surprisingly

62
00:04:54,860 --> 00:04:59,260
well one of the big teams to come
through

63
00:04:59,260 --> 00:05:03,680
was him complaining when he figured out
that actually modest adenosine knew

64
00:05:03,680 --> 00:05:07,610
about all of the bugs that were being
exploited with an essentially said well

65
00:05:07,610 --> 00:05:12,120
hold on the NSA knows about all these
bugs they letting us get attacked how

66
00:05:12,120 --> 00:05:13,150
does that work

67
00:05:13,150 --> 00:05:18,049
ok and it's a team that that's still
pretty prevalent today but for our

68
00:05:18,050 --> 00:05:21,660
interests that thing that was
interesting was actually clip installs

69
00:05:21,660 --> 00:05:27,230
partner who came up with the idea of
using a honeypot ok they had this

70
00:05:27,230 --> 00:05:31,150
attacker who occasionally breezed
through she said let's put out some

71
00:05:31,150 --> 00:05:36,020
trials let's create files that look like
valid files that he'd be interested in

72
00:05:36,020 --> 00:05:39,289
and let's see if the attacker actually
goes for it

73
00:05:39,290 --> 00:05:42,530
ok so it kind of gave us the stalked

74
00:05:42,530 --> 00:05:53,020
honey pots as we know it Anand 1997 said
Cohen released the deception toolkit and

75
00:05:53,020 --> 00:05:58,640
then in 2002 honey that project was
really kicked into gear ok lance sports

76
00:05:58,640 --> 00:06:05,200
and I did lots of good work and lots of
us who are working in the industry on

77
00:06:05,200 --> 00:06:08,870
then kind of got a really useful
information from the know your enemy

78
00:06:08,870 --> 00:06:12,520
serious ok in which the honey nets
stated objection

79
00:06:12,520 --> 00:06:17,200
objective was learning the back at
community understanding the tools

80
00:06:17,200 --> 00:06:21,020
tactics and then shooting all of the
lessons learnt

81
00:06:21,020 --> 00:06:23,568
93 talking history

82
00:06:23,569 --> 00:06:27,219
the book that says that's distant
history and that was all of the honey

83
00:06:27,219 --> 00:06:32,379
pot stuff wanna talk really super
quickly about more recent history

84
00:06:32,379 --> 00:06:37,860
ok and UTVs on almost all the
presentations at UC saw blitz through

85
00:06:37,860 --> 00:06:42,569
them you guys know the numbers target or
taken the attackers set on their network

86
00:06:42,569 --> 00:06:48,059
for months before they even knew they
will say what act didn't know about it

87
00:06:48,059 --> 00:06:53,099
till the account rules will go on the
guys over at Belgacom didn't know they

88
00:06:53,099 --> 00:06:57,349
were compromised told reporters showed
up to ask them how they felt about being

89
00:06:57,349 --> 00:07:02,229
compromised okay and and that sucks
pretty consistent if if you consider

90
00:07:02,229 --> 00:07:06,758
even the Tennessee didn't know about
Snowden's bleach told Snowden was well

91
00:07:06,759 --> 00:07:07,789
away

92
00:07:07,789 --> 00:07:14,378
same deal with the OPM it should give us
at this point a hold on these things

93
00:07:14,379 --> 00:07:18,930
don't make sense we saying that this
technology that help people find out

94
00:07:18,930 --> 00:07:23,129
when they will compromise yet today
people are being compromised for months

95
00:07:23,129 --> 00:07:25,860
or years and not knowing that it's
happening

96
00:07:25,860 --> 00:07:31,639
something's wrong here and the question
that has to come up there is if honey

97
00:07:31,639 --> 00:07:36,269
pots were visible on so why didn't they
stumble why didn't they make a better

98
00:07:36,269 --> 00:07:40,829
showing for it and we say they stumbled
I guess an honest question has to be

99
00:07:40,829 --> 00:07:47,319
asked to be stumble the creek using
there is the honey pots mailing list

100
00:07:47,319 --> 00:07:52,550
that graph shows activity on the mailing
list over time you'll notice it if it's

101
00:07:52,550 --> 00:07:59,999
high in 2003 hasn't been doing much
since then but what we want is to look

102
00:07:59,999 --> 00:08:04,849
at the reasons that honey pots have been
fading badly ok so we've got a bunch of

103
00:08:04,849 --> 00:08:07,459
them to really quickly

104
00:08:07,459 --> 00:08:13,339
the simple one is it just doesn't Demel
well I come to you I dropped on an idea

105
00:08:13,339 --> 00:08:17,559
so I put it on your network it's gonna
show you stuff immediately I put down an

106
00:08:17,559 --> 00:08:20,550
IPS I put it in front of your firewall
and it's going to show you stuff

107
00:08:20,550 --> 00:08:24,979
immediately part of the joy of the honey
pot is saying listen you shouldn't get a

108
00:08:24,979 --> 00:08:29,849
lot of looks it's only when it really
matters so you plug it in and then wait

109
00:08:29,849 --> 00:08:35,150
ok and somehow that's just not an
impressive sales technique ok

110
00:08:35,150 --> 00:08:39,250
the other thing is that the honey pot
isn't prevented if people thought really

111
00:08:39,250 --> 00:08:44,130
long time was still hooked up on
preventing all the things ok nowadays

112
00:08:44,130 --> 00:08:48,480
more people are starting to come onto
you just not going to you need to detect

113
00:08:48,480 --> 00:08:53,540
and contain the other thing is you
selling two defenders and by their

114
00:08:53,540 --> 00:08:57,030
nature defenders have thousands of high
is that they trying to put out at any

115
00:08:57,030 --> 00:09:05,400
given time the honeypot kind of easily
gets ignored through all this one is the

116
00:09:05,400 --> 00:09:10,550
one that I find particularly interesting
wonderful theories is that honey pots

117
00:09:10,550 --> 00:09:15,310
was sold badly and and I don't mean sold
in the money since I mean they will

118
00:09:15,310 --> 00:09:21,829
pitched bed if you look at academic
papers today you'll find that honey pots

119
00:09:21,830 --> 00:09:27,040
a heavily overrepresented anyone doing
their mazda's even guys up on his level

120
00:09:27,040 --> 00:09:31,319
want to know what to do either you put
up some wifi stuff for you put up highly

121
00:09:31,320 --> 00:09:37,440
potent and it's kind of interesting that
if you watch the early honey net papers

122
00:09:37,440 --> 00:09:44,330
all of them kind of unknowingly aimed at
the academic bent it was let's try to

123
00:09:44,330 --> 00:09:48,800
understand the slips to do research into
the tactics and the whole technology

124
00:09:48,800 --> 00:09:54,020
seems to have pigeon-holed itself into
people who are doing the research trying

125
00:09:54,020 --> 00:09:58,510
to study other people something we
should get from the cliff stoll example

126
00:09:58,510 --> 00:10:03,350
is that he and his really specific need
someone was coming into his network he

127
00:10:03,350 --> 00:10:07,690
wanted to know what this guy was doing
dead and so for him studying the attack

128
00:10:07,690 --> 00:10:13,050
them made since I'm guessing for most of
you is not what you need to worry about

129
00:10:13,050 --> 00:10:17,689
what you need to worry about is when is
really bad stuff happened on my network

130
00:10:17,690 --> 00:10:23,570
and so all of this kind of pushed it
into one direction and it kind of became

131
00:10:23,570 --> 00:10:25,310
the head step child

132
00:10:25,310 --> 00:10:29,390
intrinsic and in 2002

133
00:10:29,390 --> 00:10:37,540
talk okay some of you will this was
gobbles at giving a talk called the

134
00:10:37,540 --> 00:10:41,980
Wolves amongst us and it's kind of
interesting because he dedicated a

135
00:10:41,980 --> 00:10:46,250
dedicated a whole bunch of daytime
specifically to picking on the hon

136
00:10:46,250 --> 00:10:51,440
project they actually called people from
the onion at project up on stage to

137
00:10:51,440 --> 00:10:56,590
publicly embarrassed and part of what
they did was say well look well actually

138
00:10:56,590 --> 00:11:06,860
I suspect we can I jacks the kids

139
00:11:06,860 --> 00:11:13,990
unorthodox are doing

140
00:11:13,990 --> 00:11:16,730
views known

141
00:11:16,730 --> 00:11:19,430
discovered a single

142
00:11:19,430 --> 00:11:26,380
next

143
00:11:26,380 --> 00:11:31,660
so what's really interesting about that
video is even modest P who was up on

144
00:11:31,660 --> 00:11:37,180
stage there on the night goes to defend
the honey net project by saying look

145
00:11:37,180 --> 00:11:41,390
we're not trying to catch Sirius Black
Cats we just trying to catch the kids

146
00:11:41,390 --> 00:11:45,470
who don't know what they're doing and
this is just an exercise in in studying

147
00:11:45,470 --> 00:11:50,630
what undergone does and goebbels then
goes on to say but hold on let me don't

148
00:11:50,630 --> 00:11:54,760
care if there's kids doing kid stuff
stop talking like what you do actually

149
00:11:54,760 --> 00:12:01,850
Metis ok so quickly is that we
desperately need them to come back and

150
00:12:01,850 --> 00:12:06,690
probably the biggest reason for this is
because we can't keep going on with

151
00:12:06,690 --> 00:12:11,660
people only finding all day bleached
when Brian Krebs calls them ok

152
00:12:11,660 --> 00:12:18,850
the report gives a ridiculous statistic
back in 2012 ninety-two percent of the

153
00:12:18,850 --> 00:12:22,850
companies that were exploited or
compromise only found out about it when

154
00:12:22,850 --> 00:12:26,900
a third party told him that they will
compromise and if you think about it

155
00:12:26,900 --> 00:12:32,240
this is kind of predictable if you
consider the game that you playing as a

156
00:12:32,240 --> 00:12:34,530
defender as a game of chess

157
00:12:34,530 --> 00:12:39,230
currently the big problem that you have
is that you only see half of the board

158
00:12:39,230 --> 00:12:45,750
you don't have any visibility into what
the heck is doing and when we talk about

159
00:12:45,750 --> 00:12:49,600
bringing in the honey pots we're not
saying that you suddenly going to get a

160
00:12:49,600 --> 00:12:53,830
hundred percent visibility into what
they are doing we just saying let's make

161
00:12:53,830 --> 00:12:57,810
that broad look a little bit different
for them to ok let's introduce something

162
00:12:57,810 --> 00:13:01,839
on the board that makes them have to
work a little bit harder

163
00:13:01,840 --> 00:13:06,790
invariably what the introduction of
honey pots does is Mrs with the

164
00:13:06,790 --> 00:13:11,230
traditional asymmetry problem that
people talk about so for ever

165
00:13:11,230 --> 00:13:15,500
defendants have been saying the problem
is they have to defend all the time and

166
00:13:15,500 --> 00:13:20,550
attack is only have to win once ok with
honey pots what you trying to do is

167
00:13:20,550 --> 00:13:24,589
trying to capitalize on the fact that
one someone's broken into a network that

168
00:13:24,590 --> 00:13:29,270
asymmetry know tons and armed he's gonna
stay awake all the time he's gonna keep

169
00:13:29,270 --> 00:13:36,600
you just have to catch him once and you
then in a position to burn his TTP so

170
00:13:36,600 --> 00:13:39,170
given all of this why is it

171
00:13:39,170 --> 00:13:45,110
one of the things all other reasons we
come up with is mainly a list of

172
00:13:45,110 --> 00:13:51,660
arguments there's a list of sometimes
reasonable arguments on why people will

173
00:13:51,660 --> 00:13:55,910
or won't go down that route and we're
going to blitz through some of them and

174
00:13:55,910 --> 00:14:00,750
in answering them we'll show you some of
the texts that we've built the first one

175
00:14:00,750 --> 00:14:04,990
and almost everyone says the moment you
talk about building defensive take is

176
00:14:04,990 --> 00:14:09,050
isn't this just gonna be an arms race
you gonna stop in terms of this you

177
00:14:09,050 --> 00:14:17,149
gonna do honey pot an attack is going to
try to figure you out so much overused I

178
00:14:17,149 --> 00:14:22,889
just wanna make it clear this was the
definitive race ok this is the number of

179
00:14:22,889 --> 00:14:29,449
warheads between the USA and USSR and at
that point at the peak we're looking at

180
00:14:29,449 --> 00:14:33,740
about forty thousand warheads this is
the USA

181
00:14:33,740 --> 00:14:42,110
ok who currently have an estimated maybe
thirty warheads this is not an arms race

182
00:14:42,110 --> 00:14:48,199
ok what you're looking at is two people
having technology when you consider

183
00:14:48,199 --> 00:14:53,870
networks getting the texts today it's
not an arms race between defenders and

184
00:14:53,870 --> 00:14:58,570
attacked us win 8 p.m. manages to be
hacked for full year before anyone knows

185
00:14:58,570 --> 00:15:03,440
about it when technology companies like
Odyssey managed to lose ground rules

186
00:15:03,440 --> 00:15:08,630
it's not an arms race that's already
lost what you actually want is to at

187
00:15:08,630 --> 00:15:13,329
least make it an arms race where you at
least at the table making them work a

188
00:15:13,329 --> 00:15:18,260
little harder for them on the second
argument that constantly comes up is if

189
00:15:18,260 --> 00:15:22,329
I drop your honey pots in is it going to
now introduce new task to my

190
00:15:22,329 --> 00:15:27,010
organization ok and is a bunch of things
you can do about this for all of the

191
00:15:27,010 --> 00:15:33,589
technology that will show you today we
voted in Piketon so its memory safe we

192
00:15:33,589 --> 00:15:37,959
support only minimal protocols and one
of the simple technical things that we

193
00:15:37,959 --> 00:15:42,760
say is it doesn't matter if you honey
pot gets compromised as long as it

194
00:15:42,760 --> 00:15:48,319
manages to shoot off 10 looked okay
because if it gets off that one of you

195
00:15:48,319 --> 00:15:48,849
in a bit

196
00:15:48,850 --> 00:15:53,209
position than you were yesterday but
aside from the technical lunches and

197
00:15:53,209 --> 00:15:59,339
actually liked the slightly more metal
level which is when someone tells me

198
00:15:59,339 --> 00:16:08,940
introduce a disc into my organization
like let's be serious we all know that

199
00:16:08,940 --> 00:16:13,709
your organization actually has an old in
T four blocks that nobody's got on to

200
00:16:13,709 --> 00:16:19,050
patching you got a bunch off blocks are
still vulnerable to MS 08 all over the

201
00:16:19,050 --> 00:16:22,949
network but when you having this
conversation on should I use honey pots

202
00:16:22,949 --> 00:16:27,949
suddenly you the most pristine network
that content in a single box that will

203
00:16:27,949 --> 00:16:32,910
maybe get compromised kind of okay and
and the sexually points to a bigger

204
00:16:32,910 --> 00:16:37,839
problem it's a problem that hurts us
insecurity fairly recently I was trying

205
00:16:37,839 --> 00:16:41,170
to convince an organization that they
should be deploying emmitt

206
00:16:41,170 --> 00:16:47,170
Microsoft's all over and one of the guys
on the team is a very skilled Aversa and

207
00:16:47,170 --> 00:16:52,180
he came in and he told me I can bypass
I'm like sure you can but you guys have

208
00:16:52,180 --> 00:16:58,149
boxes that I sold you getting compromise
daily ok and we need to break out of

209
00:16:58,149 --> 00:17:04,849
this almost strange utopia versatility
split that happens when it comes to

210
00:17:04,849 --> 00:17:11,678
evaluating technology and we need to get
a little more realistic about it so the

211
00:17:11,679 --> 00:17:17,020
next argument that comes up is the stuff
is painful to deploy its gonna be a lot

212
00:17:17,020 --> 00:17:21,280
more work I'm already struggling to
manage all of the boxes on my network

213
00:17:21,280 --> 00:17:26,569
you know talking about giving me new
boxes and largely this is the problem

214
00:17:26,569 --> 00:17:31,570
that we set out technically to solve
things committee is a product that we

215
00:17:31,570 --> 00:17:37,210
sell so we won't talk a lot about it
deploys in three minutes if we talking

216
00:17:37,210 --> 00:17:37,590
about

217
00:17:37,590 --> 00:17:40,959
open canady today it's actually got even
more

218
00:17:40,960 --> 00:17:45,309
the technology that we use in
connecticut largely because we using it

219
00:17:45,309 --> 00:17:49,899
as the bleeding edge it will deploy and
be useful in minutes

220
00:17:49,900 --> 00:17:54,789
lots of the stuff that we're going to be
talking about should be absolutely super

221
00:17:54,789 --> 00:17:57,710
quick to pick up

222
00:17:57,710 --> 00:18:02,890
introduced now open canary to which is
one of the tools one of a few that we're

223
00:18:02,890 --> 00:18:06,640
releasing today in truth the temp in
Canary encompasses a number these

224
00:18:06,640 --> 00:18:11,330
projects but it also refers to the main
tool in the suite and to kind of defined

225
00:18:11,330 --> 00:18:18,049
it so we've defined it as a mixed
interaction honey pot and weasel words

226
00:18:18,049 --> 00:18:21,039
mixed interaction but the reason for
that is this but I later action

227
00:18:21,039 --> 00:18:24,760
components but there's also part of it
which doesn't fit neatly into either of

228
00:18:24,760 --> 00:18:29,929
those models so we have to name it it'll
be mixed but I'm gonna show you part of

229
00:18:29,929 --> 00:18:34,429
this with you wouldn't typically find in
either high or low interaction is

230
00:18:34,429 --> 00:18:37,870
mentioned it's something we've written
in Python so it reduces that risk

231
00:18:37,870 --> 00:18:42,820
component and the thing that is
particularly focused on the mend and

232
00:18:42,820 --> 00:18:47,629
touched on it is this idea of having one
alert that comes out of the system said

233
00:18:47,630 --> 00:18:52,990
to have high quality signals there's no
point in having a setup that is a given

234
00:18:52,990 --> 00:18:57,809
you like you coming in the morning and
you go to your canary alerts and the you

235
00:18:57,809 --> 00:19:01,539
know the ones which are false alarms
like that's not what we're aiming for

236
00:19:01,539 --> 00:19:07,480
women for those high quality alerts so
we want this thing to be extremely easy

237
00:19:07,480 --> 00:19:12,240
to deploy and we'll touch on this again
but when you get into those arms races

238
00:19:12,240 --> 00:19:16,620
if you can reduce that cycle between the
attack of figuring out what a hundred

239
00:19:16,620 --> 00:19:22,559
looks like and introducing fingerprints
for it if the defender has a cycle which

240
00:19:22,559 --> 00:19:27,460
managed just to catch the quicker than
the defender wins so easy update he

241
00:19:27,460 --> 00:19:32,890
deployed becomes a big part of this
project so we see these things as census

242
00:19:32,890 --> 00:19:36,850
in other words you have a bunch of these
things they're really easy to deploy

243
00:19:36,850 --> 00:19:41,709
deploy them 30 network they provide a
feed of events which get a coalesced

244
00:19:41,710 --> 00:19:47,429
into incidents and you can install this
stand alone so you can have an open

245
00:19:47,429 --> 00:19:53,080
canary install which brings on every
event but the ideal one includes call

246
00:19:53,080 --> 00:19:58,699
the car later and that will let you get
very high quality signals so I'm gonna

247
00:19:58,700 --> 00:20:02,310
show you a demonstration of the
installation

248
00:20:02,310 --> 00:20:16,120
and country and other basic mi sequel
honey Canaria Canary instance

249
00:20:16,120 --> 00:20:22,149
ok so we've got two terminals here and
there's attacker and read the defense or

250
00:20:22,150 --> 00:20:29,050
the sysadmin is her on the blue terminal
and so the attacker somehow comes across

251
00:20:29,050 --> 00:20:34,010
a machine on the network which happens
to be called canary runs scan there's no

252
00:20:34,010 --> 00:20:40,670
port open the defender once to install
at some point honey pot and so decides

253
00:20:40,670 --> 00:20:46,040
to go with open canary and so because we
using Python I want to highlight areas

254
00:20:46,040 --> 00:20:50,360
that we use of the standard funny ways
of doing things it's packaged as a pipe

255
00:20:50,360 --> 00:20:56,449
and pipe yard package so that means it's
installable gives you cannot that is

256
00:20:56,450 --> 00:21:01,390
sensitive handles package dependencies
and all of that sort of a distributed

257
00:21:01,390 --> 00:21:08,270
system for these packages so you can
simply cron job an update on so you can

258
00:21:08,270 --> 00:21:17,139
keep up to date with your open canary
pretty quickly as that's the install of

259
00:21:17,140 --> 00:21:34,300
open canary the configuration occurs
fire a Jason file so

260
00:21:34,300 --> 00:21:37,889
so we can simply unable to my single
module which is already enabled in this

261
00:21:37,890 --> 00:21:41,140
one but you will see from the two
quickly scan that you can alter ben is

262
00:21:41,140 --> 00:21:50,690
important what you would kind of expect
to find on most any parts software so we

263
00:21:50,690 --> 00:21:55,580
start our honey part a little bit of
hand waving at a manager at this point

264
00:21:55,580 --> 00:21:59,210
is there's a car later already running
in the background its configuration is

265
00:21:59,210 --> 00:22:00,310
also quite easy

266
00:22:00,310 --> 00:22:05,230
essentially that just gets an email
address to allow it to or mobile number

267
00:22:05,230 --> 00:22:10,750
and so we've got a set up to a letter
mobile and email them so what you're

268
00:22:10,750 --> 00:22:14,040
here during the presentation hope you're
the alert coming through on the mobile

269
00:22:14,040 --> 00:22:19,290
as well so we've got the hope and Canary
running now on the offenders host the

270
00:22:19,290 --> 00:22:24,530
attacker scans the host again at some
point we now see there's an open my

271
00:22:24,530 --> 00:22:28,129
sequel if the attacker sides to do

272
00:22:28,130 --> 00:22:32,950
versions can then again you would get
the banner that comes out to the snow

273
00:22:32,950 --> 00:22:38,310
starts to look like my single instance
at this point the attacker decides they

274
00:22:38,310 --> 00:22:43,020
want to log into this could be a menu
Logan this could also be a brute force

275
00:22:43,020 --> 00:22:49,379
of some kind

276
00:22:49,380 --> 00:22:58,410
tries to login and this point the canary
has picked up the logon attempt and what

277
00:22:58,410 --> 00:23:04,230
we should have is an alert that comes
through ok so I can we get the podium

278
00:23:04,230 --> 00:23:16,820
mic volume so the alleged country on the
on the phone right or get the other ones

279
00:23:16,820 --> 00:23:21,790
that come through but will also see the
mail that's come through the side so

280
00:23:21,790 --> 00:23:26,810
there's a bicycle login attempt that's
happened very quickly we can reduce that

281
00:23:26,810 --> 00:23:29,290
that's liable for deploying a canary

282
00:23:29,290 --> 00:23:37,149
and getting real incidents in her care
about to come thru quite quickly so

283
00:23:37,150 --> 00:23:47,520
that's my sequel

284
00:23:47,520 --> 00:23:51,420
one of the reasons that we've written in
Python and it's based on the twisted

285
00:23:51,420 --> 00:23:55,310
frameworks if you're familiar with but
it'll mean something to you is that it

286
00:23:55,310 --> 00:23:59,120
makes it really easy to write modules it
makes it really easy to extend it by way

287
00:23:59,120 --> 00:24:04,090
of example the sub model that we've got
to get it focuses on things that you

288
00:24:04,090 --> 00:24:08,439
care about and if someone has gotten
your network inside and tried to shoot

289
00:24:08,440 --> 00:24:12,150
some requests to random post that
something you want to be aware of the

290
00:24:12,150 --> 00:24:17,110
submodel doesn't have to employ a
doesn't have to try and understand the

291
00:24:17,110 --> 00:24:20,350
Pulsar protocol you want to know if
someone is trying to do some stuff

292
00:24:20,350 --> 00:24:25,439
inside your network the single tenure
and the modules 18 lines of Python and

293
00:24:25,440 --> 00:24:30,190
so it becomes really easy to extend it
really easy to new modules the kinds of

294
00:24:30,190 --> 00:24:34,850
models that we have there there listed
in most of those will be familiar to you

295
00:24:34,850 --> 00:24:39,560
I guess the one which we want to just
mentioned briefly is

296
00:24:39,560 --> 00:24:46,070
get so if you're a dead shop you might
have to get inside and you'll see

297
00:24:46,070 --> 00:24:52,320
something that you want to protect you
want to be aware of someone who is

298
00:24:52,320 --> 00:24:57,530
trying to find its organization that's
the activity which you would want to be

299
00:24:57,530 --> 00:25:02,050
aware of each of those modules has
different kinds of triggers that we

300
00:25:02,050 --> 00:25:07,860
considered to be high quality alerts
failed logins are are strong one other

301
00:25:07,860 --> 00:25:13,159
example so within the within NTP if
someone is issuing money list amongst UN

302
00:25:13,160 --> 00:25:17,760
to be so does that's often a technique
for recon inside organizations and we've

303
00:25:17,760 --> 00:25:22,780
spoken about seven and then the final
when there is no one will do a demo on

304
00:25:22,780 --> 00:25:27,920
but it's essentially somebody fired so
if someone is scanning your internal

305
00:25:27,920 --> 00:25:33,220
shares you can deploy to open Canaria
file share that has housed on it and if

306
00:25:33,220 --> 00:25:37,600
someone tries to be those files then you
get notified because of somebody means

307
00:25:37,600 --> 00:25:41,429
that you can tied into Active Directory
so the thinking even exist in a domain

308
00:25:41,430 --> 00:25:42,809
so someone's browsing

309
00:25:42,809 --> 00:25:52,678
Explorer through the network network
Raza then they'll come up to your canary

310
00:25:52,679 --> 00:25:58,950
appear that so I'm gonna demo then
showing you what Baltimore running all

311
00:25:58,950 --> 00:26:22,400
the modules looks like I'm gonna show
you three specific modules from this

312
00:26:22,400 --> 00:26:27,990
my run scripts wraps up starting summer
and a few other things and it also has a

313
00:26:27,990 --> 00:26:34,020
separate conflict file at this point the
open canary services running if the

314
00:26:34,020 --> 00:26:37,750
attacking all scans that same Canaria

315
00:26:37,750 --> 00:26:42,860
different configuration is not a bunch
more modules that are accessible to them

316
00:26:42,860 --> 00:26:56,129
and so the first one that will look at
is a small ship

317
00:26:56,130 --> 00:26:59,860
you have someone on a Windows machine
their bras in the network they come

318
00:26:59,860 --> 00:27:07,100
across the cell network it has two files
to open up one of the files they get to

319
00:27:07,100 --> 00:27:12,850
see the contents of the file but at the
same time we should get an alert that

320
00:27:12,850 --> 00:27:19,340
comes to your look that comes through as
soon as that file gets opened in the

321
00:27:19,340 --> 00:27:23,980
same way what we can do is we've
integrated project there's a separate

322
00:27:23,980 --> 00:27:33,080
project called Rd pipe which gets you an
RDP Remote Desktop and there's a lot of

323
00:27:33,080 --> 00:27:37,810
cool stuff that is possible in this one
to this for us is a proof of concept and

324
00:27:37,810 --> 00:27:42,389
it sort of on the on the leading edge of
where we're going but you can connect to

325
00:27:42,390 --> 00:27:48,080
the Canary it gives you an RDP and face
what it's actually showing at this point

326
00:27:48,080 --> 00:27:52,490
and this is from state from that project
rdy project so that's the attempted

327
00:27:52,490 --> 00:27:56,970
login that happens with a credential
sent with the initial connection to the

328
00:27:56,970 --> 00:28:02,420
RDB souther what it's actually showing a
video screen capture all of this

329
00:28:02,420 --> 00:28:06,830
previous RDP instance we're not
connected to a window so that we can

330
00:28:06,830 --> 00:28:13,230
text into twisted and it's essentially
looping the video of what an RDP session

331
00:28:13,230 --> 00:28:16,530
might look like and so we can capture
keystrokes at this point to determine if

332
00:28:16,530 --> 00:28:22,270
they're trying to force passports and so
on and then the final demand is gonna

333
00:28:22,270 --> 00:28:29,050
talk about but thats we can also visit
VNC module and so we can capture

334
00:28:29,050 --> 00:28:35,600
connections again failed logins against
the VNC instance

335
00:28:35,600 --> 00:28:42,459
to reintegrate those projects are deep I
suppose and somebody and give shots to

336
00:28:42,460 --> 00:28:47,830
all of those guys so this project is
open source of Canary is available at

337
00:28:47,830 --> 00:28:53,549
open and that code is there and with the
car later code still needs to go up but

338
00:28:53,549 --> 00:28:58,280
it'll go up in the next day or so that's
hopefully put to bed idea that they're

339
00:28:58,280 --> 00:29:02,220
hard to deploy the next argument is that
they get noisy so you've just got

340
00:29:02,220 --> 00:29:06,330
another device that splitting logs and
no one's going to look at those in one

341
00:29:06,330 --> 00:29:11,899
of those if you remember we refer to our
canary says senses and scents can get

342
00:29:11,900 --> 00:29:17,760
the car later is then that component
which accepts feeds from multiple

343
00:29:17,760 --> 00:29:22,610
canaries and coalescence so for example
if someone conducts a brutal attack

344
00:29:22,610 --> 00:29:26,629
against you my single instance the
Canaries gonna issue an event for every

345
00:29:26,630 --> 00:29:31,730
indication try but actually that's all
part of the same brute force attack and

346
00:29:31,730 --> 00:29:35,480
so we don't pull that log logic into the
open canary we keep the simplest

347
00:29:35,480 --> 00:29:40,110
possible but that logic is then pulled
into the car later and that allows you

348
00:29:40,110 --> 00:29:43,629
to do things like detective someone
scanning for a given a single point but

349
00:29:43,630 --> 00:29:47,500
across our entire network to play
multiple canaries through the network I

350
00:29:47,500 --> 00:29:50,580
mean you can with a field that's coming
back from them you can easily figure out

351
00:29:50,580 --> 00:29:52,770
if someone is coming across the network

352
00:29:52,770 --> 00:29:58,549
the next argument is then well as the
attack ever actually going to bump into

353
00:29:58,549 --> 00:30:02,520
it and we can't raise a bit differently
December Hakan you need an attacker to

354
00:30:02,520 --> 00:30:09,900
your money and so far to get into a
thing of discoverability how can you

355
00:30:09,900 --> 00:30:14,900
make hockey to be or how can you help
the Texas find your honey pots attackers

356
00:30:14,900 --> 00:30:18,590
in your network of a lot of targets
taken aim at but you want them to

357
00:30:18,590 --> 00:30:23,418
actually focus on your on your honey
pots and so this sort of two factors

358
00:30:23,419 --> 00:30:27,309
that contribute towards discoverability
the one as references and the other one

359
00:30:27,309 --> 00:30:31,309
is density density and

360
00:30:31,309 --> 00:30:35,658
why you want to focus on this is because
if an attack is only conducting passive

361
00:30:35,659 --> 00:30:41,009
recon and your your canary staying quiet
then there's a good chance they just

362
00:30:41,009 --> 00:30:46,340
never find it so when we say that these
two factors density and references what

363
00:30:46,340 --> 00:30:50,379
we mean by references are references any
ought effect that leads an attack a to

364
00:30:50,379 --> 00:30:56,240
your to your honey pot so it could be
contact file entry it could be acted on

365
00:30:56,240 --> 00:31:00,600
the network it could be an entry in one
of the directory services but all of

366
00:31:00,600 --> 00:31:03,860
those are references that points to a
honey pot and you can distribute

367
00:31:03,860 --> 00:31:09,399
references throughout your organization
the other option is you can also

368
00:31:09,399 --> 00:31:12,479
increase the density of a hundred bucks
you can have more honey buns and if

369
00:31:12,480 --> 00:31:18,830
they're easy to the blame is no trivial
as we've made open carry then you can

370
00:31:18,830 --> 00:31:23,820
really spread them up and so now an
attacker randomly probing the network is

371
00:31:23,820 --> 00:31:27,860
likely to come across one of your honey
pots that leads us to this completely

372
00:31:27,860 --> 00:31:33,080
made up but what really like what
retired the point that we're trying to

373
00:31:33,080 --> 00:31:37,879
get to that there's some kind of title
but these are not they're not going to

374
00:31:37,879 --> 00:31:38,428
each other

375
00:31:38,429 --> 00:31:43,389
executive offices so we've got to
preferences and density and there's some

376
00:31:43,389 --> 00:31:47,719
kind of optimal honeypot deployment that
you can aim for some kind of efficient

377
00:31:47,720 --> 00:31:51,690
deployment then and we have a suspicion
that looks something like that you can

378
00:31:51,690 --> 00:31:55,619
have lots of references with few number
of honey pots or lots of honey pots with

379
00:31:55,619 --> 00:31:59,039
a lot of references to them and of
course you can have lots of references

380
00:31:59,039 --> 00:32:02,990
and honey pots but then that's just
probably inefficient it's probably more

381
00:32:02,990 --> 00:32:07,409
expensive than you need to be so open
canary specifically we get to this issue

382
00:32:07,409 --> 00:32:14,369
of discover ability and out of the box
open canary supports discoverability

383
00:32:14,369 --> 00:32:18,149
options listed there but it's
essentially what you would normally find

384
00:32:18,149 --> 00:32:22,258
the kind of traffic you'd find on a
network and we think that it's possible

385
00:32:22,259 --> 00:32:28,860
to do more so for this particular topic
you think that your canary should be

386
00:32:28,860 --> 00:32:31,809
producing more than the services
necessary that the board running on that

387
00:32:31,809 --> 00:32:36,999
when we got a research tool that I guess
we'll also talk to this thing called a

388
00:32:36,999 --> 00:32:39,960
hot dog i dont think thats international
done but it's

389
00:32:39,960 --> 00:32:44,960
sacred Ibis is that good and South
Africa pull those things he does because

390
00:32:44,960 --> 00:32:50,570
of the noise they make it makes it just
is very loud bangs and saw this tool is

391
00:32:50,570 --> 00:32:55,250
an attempt at making a tool that
attracts attention to a given host and

392
00:32:55,250 --> 00:32:59,540
so it does how you would imagine it to
do it does what it does in the way that

393
00:32:59,540 --> 00:33:04,200
you probably imagine that it does it by
essentially emulating a bunch of network

394
00:33:04,200 --> 00:33:10,870
protocols and there is one other way
that we think that it can can work so if

395
00:33:10,870 --> 00:33:11,989
you stuck around them

396
00:33:11,990 --> 00:33:16,530
Ethernet network and a large
organization is mild congestion even you

397
00:33:16,530 --> 00:33:21,610
will see packets from host that I'm not
sure oh so you'll see TCP packets and

398
00:33:21,610 --> 00:33:24,760
was back at school they'll be in the
middle of someone else's stream in the

399
00:33:24,760 --> 00:33:27,980
switch for whatever reason decided you
need it at the stage and you will host

400
00:33:27,980 --> 00:33:31,180
ignores it was not addressed you have
someone step in the network based in

401
00:33:31,180 --> 00:33:35,820
those packets so what we'll do is
generate this fake packets and

402
00:33:35,820 --> 00:33:41,000
essentially what kind of interesting
bits of data so for example on shake

403
00:33:41,000 --> 00:33:47,120
telnet telnet port it can set something
that looks like a possible and then open

404
00:33:47,120 --> 00:33:50,739
canary if you see that possibly be used
well then that's a very curious thing

405
00:33:50,740 --> 00:33:56,020
someone sniffing the network and talked
a lot about content with some drawbacks

406
00:33:56,020 --> 00:34:00,540
to this essentially that can be
fingerprinted

407
00:34:00,540 --> 00:34:06,950
but at that point talking about that
asymmetry problem if you know that has

408
00:34:06,950 --> 00:34:11,170
been built into a tech tools you can
make your service and at that point

409
00:34:11,170 --> 00:34:14,889
knowledge attack it is again in this
position where they don't know is this

410
00:34:14,889 --> 00:34:19,359
something that I care about who is this
something that has been put in place to

411
00:34:19,360 --> 00:34:26,070
pick me up so that takes us on to the
idea of fingerprint team at which point

412
00:34:26,070 --> 00:34:31,640
it takes other one of the other
arguments that always come up here is

413
00:34:31,639 --> 00:34:36,480
and it kind of ties into my only event
which is I can fingerprint johnnie part

414
00:34:36,480 --> 00:34:39,500
sucks I can

415
00:34:39,500 --> 00:34:43,980
use this technique to figure it out
Beardsley did a really nice talk from it

416
00:34:43,980 --> 00:34:47,850
displayed on discovering people for
example I'm so now pulled into

417
00:34:47,850 --> 00:34:51,918
Metasploit is a way that you can
discover it and again there's two ways

418
00:34:51,918 --> 00:34:57,020
you can hit this one is for change we
can stop fighting that flight both ways

419
00:34:57,020 --> 00:35:01,600
because you can automatically update or
because you can pull updates will open

420
00:35:01,600 --> 00:35:06,580
you can now have a situation where you
actually can respond to those things you

421
00:35:06,580 --> 00:35:13,290
can match them technically but also the
argument itself is kind of flawed ok the

422
00:35:13,290 --> 00:35:17,420
stuff comes up pretty consistently
there's a talk happening at blackhat

423
00:35:17,420 --> 00:35:22,580
this year on fingerprinting discovering
a whole bunch of honey pots and I'll

424
00:35:22,580 --> 00:35:27,750
tell you why I think it's slightly
misguided way back when

425
00:35:27,750 --> 00:35:33,380
Civic was one of the popular honey pots
of this was in 2003 and what simply

426
00:35:33,380 --> 00:35:38,230
choose to do was allow you to set up
dishes Lee take your keystrokes from

427
00:35:38,230 --> 00:35:43,190
your honey pot of machine and send it to
another host for monitoring that was to

428
00:35:43,190 --> 00:35:50,530
Cape three in 2k 410 Sechrist a bunch of
very smart guys gave a talk on breaking

429
00:35:50,530 --> 00:35:56,050
honey pots ok and what the talk was they
had a whole bunch of ways that you could

430
00:35:56,050 --> 00:36:01,500
detect wind Civic was running on the
machine and again it's good research and

431
00:36:01,500 --> 00:36:05,800
its research that needs to happen the
way the guys were doing it was exactly

432
00:36:05,800 --> 00:36:11,220
like you'd predict like you look for
differences look for subtle changes was

433
00:36:11,220 --> 00:36:15,169
running as a kernel module so look for
ways that you can detect that there's a

434
00:36:15,170 --> 00:36:19,330
kernel module that's tried to hide
itself at the time they were using

435
00:36:19,330 --> 00:36:24,710
Joanna to discuss they'd pull ok sole
way to discover that the host was

436
00:36:24,710 --> 00:36:30,790
actually virtualized and in truth it's
kind of the point

437
00:36:30,790 --> 00:36:36,690
ok the guys who hit OPM one not running
Red Bull to first see if they wanna

438
00:36:36,690 --> 00:36:38,290
Trojans machine

439
00:36:38,290 --> 00:36:44,150
the guys who hit target date went in and
after the discovery you find out they

440
00:36:44,150 --> 00:36:49,180
kind of men like boobs in a china shop
ok and so again we need to draw the slam

441
00:36:49,180 --> 00:36:50,850
between yes

442
00:36:50,850 --> 00:36:55,930
I can defeat you in the lab and yes
you'll probably add value because you

443
00:36:55,930 --> 00:36:58,319
gonna pick this up on a network

444
00:36:58,320 --> 00:37:02,850
those things are not the same and we
keep confusing them almost as if they

445
00:37:02,850 --> 00:37:09,430
are so one of the other arguments that
always come up is look honey pot is a

446
00:37:09,430 --> 00:37:13,859
nice to have we think we'll get to it
someday but first we've got to do all

447
00:37:13,860 --> 00:37:15,170
these other things

448
00:37:15,170 --> 00:37:23,430
Tom cross the recently went on a little
Twitter Tweet storm about it essentially

449
00:37:23,430 --> 00:37:26,950
way he said look there's lots of other
stuff you should do first

450
00:37:26,950 --> 00:37:31,020
most people don't get deception what do
you about it later

451
00:37:31,020 --> 00:37:36,830
okay and you can go into the gist of it
but essentially he was saying everything

452
00:37:36,830 --> 00:37:42,140
else then what about you honey pot stuff
and I had a discussion with him and

453
00:37:42,140 --> 00:37:46,620
essentially one of the things that you
need to consider here is when you say

454
00:37:46,620 --> 00:37:52,330
it's a waste of time that only matters
if the time you talking about is a lot

455
00:37:52,330 --> 00:37:56,500
of time if we seeing you can get
committee up and running in three

456
00:37:56,500 --> 00:38:01,920
minutes from the unboxing open Canadian
up in five minutes then I'm gonna see

457
00:38:01,920 --> 00:38:04,480
you can't really say it's a waste of
time

458
00:38:04,480 --> 00:38:09,270
don't get coffee this afternoon and you
done OK as long as your committees don't

459
00:38:09,270 --> 00:38:14,400
add extra overhead to a day-to-day
activities if you can drop them and

460
00:38:14,400 --> 00:38:19,320
forget about them until they actually
warning you about the tax it's it's

461
00:38:19,320 --> 00:38:24,890
actually an argument so if we saying
committees installed in three minutes

462
00:38:24,890 --> 00:38:28,850
open Canadian schools in three minutes
we actually asking now if there's

463
00:38:28,850 --> 00:38:32,730
anything we can do that it's quicker
than this and what we gonna touch on

464
00:38:32,730 --> 00:38:33,160
here

465
00:38:33,160 --> 00:38:39,970
committee tokens again not a new idea
back in 2003 Land Speed snow was talking

466
00:38:39,970 --> 00:38:47,990
about honey tokens Eugene Spafford and
Kim were talking about it in ninety-four

467
00:38:47,990 --> 00:38:52,359
and actually it's a pretty ancient
concept so much of you guys know but way

468
00:38:52,360 --> 00:38:57,900
back when people made money selling maps
what they do is put in 50 cities on

469
00:38:57,900 --> 00:39:01,310
their maps and if you're fake city
showed up on someone else's

470
00:39:01,310 --> 00:39:07,210
map you didn't know that he copied your
map the city of Anglo there's kind of

471
00:39:07,210 --> 00:39:11,470
interesting 'cause guys actually took a
map went to where they thought they were

472
00:39:11,470 --> 00:39:17,160
on the city then named a shop shop off a
glow and a whole city actually pulled on

473
00:39:17,160 --> 00:39:21,319
the shop so fake city actually sprung up
the old city sprung up we'll fix it he

474
00:39:21,320 --> 00:39:26,980
was but essentially brings us to what we
gonna talk about in the form off

475
00:39:26,980 --> 00:39:32,940
committee tokens and so again the idea
is pretty simple we going to have a

476
00:39:32,940 --> 00:39:37,870
unique tag or unique piece of data and
going to bed that throughout already

477
00:39:37,870 --> 00:39:43,109
existing networks open canary has to say
is what we can do when we have a fake

478
00:39:43,110 --> 00:39:44,620
set of services

479
00:39:44,620 --> 00:39:51,640
tokens are the way that you can start to
deploy detection into ready live system

480
00:39:51,640 --> 00:39:54,990
I'm so we've got a number of channels
that these things can be triggered over

481
00:39:54,990 --> 00:39:59,720
and sort of world will talk about them
in a little bit more detail as we get

482
00:39:59,720 --> 00:40:04,160
them the alerts that comes through again
they gonna come through on the mobile

483
00:40:04,160 --> 00:40:09,210
safety that message received signal that
select coming through I'm not gonna be

484
00:40:09,210 --> 00:40:13,000
switching to I'm not gonna be shown you
the full alert we're a little bit short

485
00:40:13,000 --> 00:40:25,340
so really basically or really simply
secondary tokens is currently live so

486
00:40:25,340 --> 00:40:32,750
that's like his their canoe tokens that
we can

487
00:40:32,750 --> 00:40:37,020
we can create a token it's going to come
back

488
00:40:37,020 --> 00:40:40,900
generates a token in a bunch of
different formats one of them is sort of

489
00:40:40,900 --> 00:40:45,780
a standard web bug standard web I get
something that you would be a good

490
00:40:45,780 --> 00:40:49,410
experience with spam and those sort of
things it's a unique URL if someone hits

491
00:40:49,410 --> 00:40:59,440
the RO we will get will get that alert

492
00:40:59,440 --> 00:41:04,090
there's the alert that says that someone
had to your weblog right so that's what

493
00:41:04,090 --> 00:41:08,600
it looks like I'm not going to be coming
back to the alert for the next little

494
00:41:08,600 --> 00:41:16,870
bit the web is just one way that we can
detect these these tokens are we going

495
00:41:16,870 --> 00:41:19,859
to bed in a URL which might be
distributed but we could also for

496
00:41:19,860 --> 00:41:24,320
example embedded in a Tennis Channel
right so we good embedded in a DNS

497
00:41:24,320 --> 00:41:29,230
hosting its that host name ever gets
queried then that fires the alert and

498
00:41:29,230 --> 00:41:33,660
I'm going to skip this demo I think the
concept is pretty straightforward we

499
00:41:33,660 --> 00:41:37,910
have a token it's in a hostname hostname
ever gets queried comes back to our

500
00:41:37,910 --> 00:41:42,529
dennis conner tokens and we know that
someone has been looking at this

501
00:41:42,530 --> 00:41:46,410
hostname and why that's important is to
use it as a building block and a dude

502
00:41:46,410 --> 00:41:50,120
gets used as a building block on some of
the additional channels so these are the

503
00:41:50,120 --> 00:41:53,990
channel said he supports that are
currently available on the opposite side

504
00:41:53,990 --> 00:41:59,390
this email and SMS component input side
with DNS have spoken about SMTP for

505
00:41:59,390 --> 00:42:03,710
generating fake mailboxes and then
there's also image a LinkedIn and but

506
00:42:03,710 --> 00:42:08,050
quite just to sort of proteomics in the
butt and what we're trying to show there

507
00:42:08,050 --> 00:42:12,710
is the kind of thinking that we can have
when it comes to money tokens so

508
00:42:12,710 --> 00:42:17,520
immature in particular is an interesting
one if you look at that honey but if you

509
00:42:17,520 --> 00:42:23,710
look at the honey token webike that I
showed you the argument against it is

510
00:42:23,710 --> 00:42:30,120
that I just need to set your canary
tokens to uphold the main in my hosts

511
00:42:30,120 --> 00:42:35,270
file to 127 001 and then I'll never
trigger your money tokens so what we've

512
00:42:35,270 --> 00:42:38,730
introduced as a level of indirection we
say what we'll do is we'll monitor an

513
00:42:38,730 --> 00:42:44,830
image file or damage linked images image
hosting site and so we can monitor an

514
00:42:44,830 --> 00:42:49,350
image on that site and if the view
content changes let me know someone has

515
00:42:49,350 --> 00:42:53,080
tried to hit that link and so the Canary
token in this instance is actually an

516
00:42:53,080 --> 00:42:58,740
image file if you want to block images
like how you gonna look at your cats so

517
00:42:58,740 --> 00:43:02,200
like you need image of you not gonna
you're not going to block that what so

518
00:43:02,200 --> 00:43:04,629
we can we can start to use indirection

519
00:43:04,630 --> 00:43:08,660
canary tokens and that way I meet
someone says will block your demands

520
00:43:08,660 --> 00:43:13,310
like a go-ahead block the internet so
this will also release in this is

521
00:43:13,310 --> 00:43:17,440
another tool getting released today
we've got a live site at Canary tokens

522
00:43:17,440 --> 00:43:20,780
dog so you can generate you don't need
to install it if you don't want to but

523
00:43:20,780 --> 00:43:26,430
we strongly recommend is the code or in
fact make the deployment even easier

524
00:43:26,430 --> 00:43:30,609
we've released stock images so register
few domains and you can be up and

525
00:43:30,610 --> 00:43:31,720
running with your own

526
00:43:31,720 --> 00:43:36,569
tokens we can take these tokens on start
to find funny ways in which they can be

527
00:43:36,570 --> 00:43:41,780
applied and so part of it is well how
can we use them to spot to take us on a

528
00:43:41,780 --> 00:43:45,300
network if that's the building block
what are the actual nuts-and-bolts where

529
00:43:45,300 --> 00:43:49,180
we going to use these canary tokens and
we've got a list of places that we think

530
00:43:49,180 --> 00:43:53,200
they can be used and will start to walk
through them so the first one is we want

531
00:43:53,200 --> 00:43:56,350
to try and examine we want to be
notified if anyone tries to read a

532
00:43:56,350 --> 00:44:04,680
particular father sensitive so for
example if you happen to be a you happen

533
00:44:04,680 --> 00:44:14,180
to be the manufacture of that's a
security software and you've got a

534
00:44:14,180 --> 00:44:19,200
number of sorcery person they all look
so we've got a bunch of sorcery post

535
00:44:19,200 --> 00:44:24,618
here and you want to know if anyone ever
tried to read any of you or any of your

536
00:44:24,619 --> 00:44:30,300
source repose you can do this fire get
hooks or some other version control

537
00:44:30,300 --> 00:44:38,260
system looks but someone gains direct
access to the server then you're not

538
00:44:38,260 --> 00:44:43,970
going to get notified by that took so
what we do is we generate token token

539
00:44:43,970 --> 00:44:48,919
the defender

540
00:44:48,920 --> 00:44:54,390
defender and his little talk called
canary fire you can specify a process

541
00:44:54,390 --> 00:44:59,790
name to hide a different ones we based
in our token and we pointed the file

542
00:44:59,790 --> 00:45:07,180
that we want to be notified if anyone
ever tried to read that file so we're

543
00:45:07,180 --> 00:45:09,940
watching this particular readme file at
some point that serve against compromise

544
00:45:09,940 --> 00:45:14,840
has our attacker in red goes into that
particular directory they are exploring

545
00:45:14,840 --> 00:45:21,980
all the Reapers and they kept that read
me file they don't get any notification

546
00:45:21,980 --> 00:45:26,660
obviously they're still see the file but
what will find is that triggers the

547
00:45:26,660 --> 00:45:34,160
Canary token and as I can verify token
that gets sent it so you'll also see

548
00:45:34,160 --> 00:45:36,740
that loop is extremely fast right

549
00:45:36,740 --> 00:45:44,149
happens getting the alert within within
the time that we can't even switched it

550
00:45:44,150 --> 00:45:49,900
again so we can do the same thing in our
sex by a different mechanism we can do a

551
00:45:49,900 --> 00:45:55,240
dryer DTrace script again the idea is it
happens we trigger a token we can do

552
00:45:55,240 --> 00:46:01,450
that for process running again in our
sex as well so process gets run that

553
00:46:01,450 --> 00:46:04,129
might be a particular white listed price

554
00:46:04,130 --> 00:46:08,810
blacklisted process we get notified when
that process runs we can do the same

555
00:46:08,810 --> 00:46:13,920
thing in windows or directory browsing
so we want to find out if someone is

556
00:46:13,920 --> 00:46:17,580
snooping around the network we showed
you wait to open canary when you deploy

557
00:46:17,580 --> 00:46:22,930
a fake smile so this is interesting
because in this method you can take your

558
00:46:22,930 --> 00:46:26,850
legitimate 5:07 to play a file to the
survey and if anyone tries to read it

559
00:46:26,850 --> 00:46:30,339
you get notified in a way that we do
that is to be reused desktop that I am

560
00:46:30,340 --> 00:46:35,410
NOT so if anyone ever qualified unlike
Windows 3.1 you might be familiar with

561
00:46:35,410 --> 00:46:41,120
my life but essentially the some of it
is if someone goes into that into a

562
00:46:41,120 --> 00:46:45,609
folder that has a desktop that I night
it's going to try and load and icon from

563
00:46:45,610 --> 00:46:51,650
specify that part is a UNC path which is
a network paw paws can contain domain

564
00:46:51,650 --> 00:46:55,690
names and so we can get a pingback
someone simply brought into

565
00:46:55,690 --> 00:47:00,619
director has said that's what the
desktop that I am i looks like I'm gonna

566
00:47:00,619 --> 00:47:04,960
skip the that particular demo but the
idea there is that you get your browser

567
00:47:04,960 --> 00:47:12,140
into a folder and you get that means no
integration for no additional login

568
00:47:12,140 --> 00:47:16,000
additional ordered no additional agents
or anything but you can still be

569
00:47:16,000 --> 00:47:20,000
notified when people are looking around
that same technique works for the files

570
00:47:20,000 --> 00:47:21,890
as WinZip and WinRAR

571
00:47:21,890 --> 00:47:27,170
desktop that I now see you can in this
way the goddess someone is unzip in

572
00:47:27,170 --> 00:47:32,720
particular files in terms of databases
we can deploy a canary tokens into

573
00:47:32,720 --> 00:47:34,078
databases as well

574
00:47:34,079 --> 00:47:39,670
yet so for making the theoretical
impossible possible

575
00:47:39,670 --> 00:47:43,960
essentially show what we're saying is
we've got a way that we can detect if

576
00:47:43,960 --> 00:47:47,410
someone is carrying a table in a
sequence of a database that advice on

577
00:47:47,410 --> 00:47:51,490
something that you will hear in lots of
from lots of people like just a token

578
00:47:51,490 --> 00:47:55,689
into database and figure out if someone
is trying to it's a little tougher than

579
00:47:55,690 --> 00:48:01,250
you think it is and so we've got a
method where we can essentially trigger

580
00:48:01,250 --> 00:48:04,869
a stored procedure when someone looks at
a few that you might be something like

581
00:48:04,869 --> 00:48:09,119
user passwords so if anyone attackers
bosnian your database that trying to

582
00:48:09,119 --> 00:48:16,530
select from that view you get back your
token my signal is a different or

583
00:48:16,530 --> 00:48:21,520
additional complexity we won the problem
guess between attract failed logins and

584
00:48:21,520 --> 00:48:25,509
my signal any rights and information out
to text father doesn't give you any

585
00:48:25,510 --> 00:48:31,970
trick inside the database so it produces
order gives us an alternative way to to

586
00:48:31,970 --> 00:48:34,959
start to trigger canary tokens and
that's we've got another PC software

587
00:48:34,960 --> 00:48:38,800
we're releasing today called canary
token D and its generic the log file

588
00:48:38,800 --> 00:48:43,109
Taylor said I'll tell a log file and
plotlines that you care about my regex

589
00:48:43,109 --> 00:48:47,940
and then trigger a canary token from
that so the setup little step you

590
00:48:47,940 --> 00:48:54,240
through the setup the attacker tries to
log into the host and you get your

591
00:48:54,240 --> 00:48:59,089
token again we can start to use these
tokens in trials as well so you'll be

592
00:48:59,090 --> 00:49:03,800
familiar with the idea of Word files
back so I'm not going to spend too much

593
00:49:03,800 --> 00:49:07,950
time on that but canary took and sports
those we also did for PDF in and why

594
00:49:07,950 --> 00:49:13,480
like this particular example is that
Adobe Reader essentially a cheap trick

595
00:49:13,480 --> 00:49:17,770
that we can employ with Adobe Reader but
the some of it is we can get notified of

596
00:49:17,770 --> 00:49:21,910
someone opens a file a PDF file in Adobe
Reader regardless of whether or not they

597
00:49:21,910 --> 00:49:29,089
allow or disallow network the network
communication and that's how it handles

598
00:49:29,090 --> 00:49:34,800
DNS responses so the UN the user with
see a pop-up but by that time you very

599
00:49:34,800 --> 00:49:37,540
to be notified about the

600
00:49:37,540 --> 00:49:41,700
so we're about to get kicked off the
stage on me really quick once you've got

601
00:49:41,700 --> 00:49:46,500
the building blocks like me said you can
stop to do more and more creative team

602
00:49:46,500 --> 00:49:50,260
meetings with them I'm one of our
clients for example kept having their

603
00:49:50,260 --> 00:49:54,680
web pages copied for phishing attacks we
can now answer JavaScript onto their

604
00:49:54,680 --> 00:49:59,040
page that says check renewal ordered
check whether you're running on client

605
00:49:59,040 --> 00:50:04,830
two main if not fetch this canady token
so now anytime day pages copied the

606
00:50:04,830 --> 00:50:09,490
first person who suffers to it actually
notifies you that he's no longer your

607
00:50:09,490 --> 00:50:11,850
site is no longer running on your domain

608
00:50:11,850 --> 00:50:15,509
there's a whole bunch of things like
this it allows you to get a little bit

609
00:50:15,510 --> 00:50:20,540
silly like Marco says if we tracking
LinkedIn you can create a fake network

610
00:50:20,540 --> 00:50:24,759
admin use the Canadian token and didn't
get told when someone's looking at you

611
00:50:24,760 --> 00:50:29,740
all admins profile on the only rated get
to him is searching for network admins

612
00:50:29,740 --> 00:50:34,759
at your dog and the last one was kind of
cute and his work quickly mentioning

613
00:50:34,760 --> 00:50:41,590
here is using advertising networks as a
sort of committee so what we did here is

614
00:50:41,590 --> 00:50:47,240
created a quick cash we then go to being
advertised and I'll tell you why reused

615
00:50:47,240 --> 00:50:52,799
and we bought that ad would ok so we
said if this hashtable shows up in a

616
00:50:52,800 --> 00:50:58,220
such we want to add on it we being
actually allows us to go a little

617
00:50:58,220 --> 00:51:03,080
further and Taipei I'm willing to put
any money for this just put the money in

618
00:51:03,080 --> 00:51:05,840
mail me so they become OpenID

619
00:51:05,840 --> 00:51:10,860
for us and then you'll see when someone
searches for the hash you actually

620
00:51:10,860 --> 00:51:14,920
noticed that's alleged showing up there
that says okay you have problems are you

621
00:51:14,920 --> 00:51:19,330
have an extremely bad luck and
essentially we then get a view count

622
00:51:19,330 --> 00:51:25,080
increase in service and being is nice
enough to mail us to say listen we then

623
00:51:25,080 --> 00:51:29,240
your rule essentially means that your
canary was now picked up someone

624
00:51:29,240 --> 00:51:33,259
searched for it and the only reason they
searched for it was because bad stuff

625
00:51:33,260 --> 00:51:38,350
has happened so to wrap it up the last
two arguments almost meld together

626
00:51:38,350 --> 00:51:43,640
people say look funny parts of his cute
and it's fun for research but it's not

627
00:51:43,640 --> 00:51:45,240
enterprise-grade

628
00:51:45,240 --> 00:51:53,600
again really simply canady stuff resale
so it's running in on networks all

629
00:51:53,600 --> 00:51:58,220
around the world we've got happy
customers with it so clearly it's not

630
00:51:58,220 --> 00:52:03,879
just for fun and the last argument that
comes up is not another one ok because

631
00:52:03,880 --> 00:52:08,790
if you look there's actually a ton of
guys who pulled honey pot rules at some

632
00:52:08,790 --> 00:52:13,230
point of the other hand if you actually
look at this you'll find lots of them

633
00:52:13,230 --> 00:52:18,840
have diet kennedy was excellent and the
last time the code was touched was 2007

634
00:52:18,840 --> 00:52:24,580
on this project that haven't been
touched since 2003 and essentially what

635
00:52:24,580 --> 00:52:31,400
we see as strange as it sounds is making
money off all committee stuff so we are

636
00:52:31,400 --> 00:52:35,550
heavily incentivised to keep on
development so open Canadians not going

637
00:52:35,550 --> 00:52:37,290
to go away anytime soon

638
00:52:37,290 --> 00:52:42,910
we needed it's important to us we giving
it to you guys free you should use it so

639
00:52:42,910 --> 00:52:47,629
fucking thoughts canaries honey pots a
good idea that have largely been ignored

640
00:52:47,630 --> 00:52:53,820
for the last but detecting infiltrations
months or years after the compromise is

641
00:52:53,820 --> 00:52:58,370
increasingly inexcusable I think boards
will forgive you for saying we got owned

642
00:52:58,370 --> 00:53:02,839
people get owned but being able to see
we got owned two years ago and only

643
00:53:02,840 --> 00:53:06,490
found out about it now is getting hard
to defend

644
00:53:06,490 --> 00:53:11,930
Canadian Open canady canady tokens
literally your investment time Liars is

645
00:53:11,930 --> 00:53:16,430
minutes which means you really shouldn't
have an excuse for getting caught with

646
00:53:16,430 --> 00:53:18,529
your pants down two years later

647
00:53:18,530 --> 00:53:23,370
other than that all of the stuff all of
the URLs are up there for you guys to

648
00:53:23,370 --> 00:53:27,380
use the stock market I will still be
around I'm not sure if we have any time

649
00:53:27,380 --> 00:53:44,540
for questions thank you very much on the
twitters or grab us know thanks a lot

