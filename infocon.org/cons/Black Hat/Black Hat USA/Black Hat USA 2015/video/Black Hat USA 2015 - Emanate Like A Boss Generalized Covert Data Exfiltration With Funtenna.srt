1
00:00:00,000 --> 00:00:04,210
welcome to Black Hat 2015 got a couple
of quick announcements before we get

2
00:00:04,210 --> 00:00:09,110
started a reception tonight in the
business call at 5:30 p.m. that's

3
00:00:09,110 --> 00:00:15,290
located in Shoreline a confined on your
maps also that the tony awards are going

4
00:00:15,290 --> 00:00:21,710
to take place tonight mandell abcd at 6
p.m. if you haven't already please turn

5
00:00:21,710 --> 00:00:25,910
off your cell phone or really shut off
the the volume so that we all have to

6
00:00:25,910 --> 00:00:30,340
enjoy your ringtone and if you're not
quite sure where you are you're in

7
00:00:30,340 --> 00:00:34,800
Jasmine ballroom this session is emanate
like a boss

8
00:00:34,800 --> 00:00:40,430
generalized covert data exfiltration
with antenna with our speaker Dr Ong so

9
00:00:40,430 --> 00:00:44,140
great thank you so much

10
00:00:44,140 --> 00:00:48,059
a little bit about me for those who
don't know I spent the last seven years

11
00:00:48,059 --> 00:00:48,809
ago

12
00:00:48,809 --> 00:00:56,930
University I just graduated a few months
ago so my PC and and i also co-founded

13
00:00:56,930 --> 00:01:00,940
and I run a security company called
rebel insecurity what we focus on

14
00:01:00,940 --> 00:01:05,000
creating technology that secures
embedded devices against exploitation so

15
00:01:05,000 --> 00:01:08,460
I have three disclaimers ok so the
research presented in this talk is not

16
00:01:08,460 --> 00:01:14,149
funded by a new government organization
or university at all the second

17
00:01:14,150 --> 00:01:18,110
disclaimer is research presented here
has nothing to do with what we do it

18
00:01:18,110 --> 00:01:22,650
rivlin security this is really just for
my academic curiosity and a thoroughly

19
00:01:22,650 --> 00:01:25,790
which is the most important one as I
only pretending how electricity works

20
00:01:25,790 --> 00:01:31,299
and I i didnt know a lot to start with
but after this project I know less now

21
00:01:31,299 --> 00:01:34,220
than a new before so I don't know yet
why

22
00:01:34,220 --> 00:01:39,500
ok but you know I have a lot of humans
to thank you for this work but I have to

23
00:01:39,500 --> 00:01:44,200
think some of the hardware that I used
to get this thing off the ground these

24
00:01:44,200 --> 00:01:49,439
things are awesome because well first of
all I got this guy which is a Geo phone

25
00:01:49,439 --> 00:01:54,689
paranormal research tool right this is
something that you can buy on Amazon and

26
00:01:54,689 --> 00:02:01,610
I i have one that is designed to find
ghosts so when is that for science and

27
00:02:01,610 --> 00:02:06,340
there there's only a single question on
Amazon about the bias I think they'd be

28
00:02:06,340 --> 00:02:11,540
more but are are these things from human
voices from a life people or is it just

29
00:02:11,540 --> 00:02:14,590
like my neighbor your something that's
awesome but will go to answer this

30
00:02:14,590 --> 00:02:16,440
question may be on Amazon

31
00:02:16,440 --> 00:02:20,970
the second thing is we've created a
homemade dog whistle detector parade in

32
00:02:20,970 --> 00:02:25,350
a cup pointed at a printer and this will
make sense in about 20 minutes and the

33
00:02:25,350 --> 00:02:27,880
third line we wish we can get but it was
too expensive

34
00:02:27,880 --> 00:02:33,959
anti-radiation shielded maternity
panties medium of a protection but it's

35
00:02:33,959 --> 00:02:38,230
incredibly expensive so we didn't get
that ok so it took all of this hardware

36
00:02:38,230 --> 00:02:42,780
to do one of fun little thing called for
antenna so what it was intended for

37
00:02:42,780 --> 00:02:47,850
antenna is racially malware that
intentionally causes compromising any

38
00:02:47,850 --> 00:02:52,590
nation in the device that is executing
in a little bit more specific its offer

39
00:02:52,590 --> 00:02:59,720
payload that intentionally causes the
hose hardware it's who as an improviser

40
00:02:59,720 --> 00:03:04,050
of transmitter using hardware that is
not designed to cause any type of

41
00:03:04,050 --> 00:03:08,540
electromagnetic emanation whatsoever and
why would we want to do this you ask

42
00:03:08,540 --> 00:03:12,859
ok so suppose you had a thing right XYZ
doesn't matter maybe this is your laptop

43
00:03:12,860 --> 00:03:18,959
your server your phone or routers or
printers or TVs cars and even entire

44
00:03:18,959 --> 00:03:23,120
buildings ok this is what we want to do
we want to take a tiny little bit of

45
00:03:23,120 --> 00:03:27,620
software injected into the thing right
through all of the ordinary methods of

46
00:03:27,620 --> 00:03:32,820
getting caught execution into embedded
devices and computers right and this is

47
00:03:32,820 --> 00:03:36,739
what we want the software to do on the
device we want this thing to emanate us

48
00:03:36,739 --> 00:03:42,010
a signal right that the attacker can
receive in some distance away and we

49
00:03:42,010 --> 00:03:46,920
want to encode information which is
probably all your secret info right and

50
00:03:46,920 --> 00:03:50,910
that's what we want to do through
software and you asked to and receiver

51
00:03:50,910 --> 00:03:56,400
will also need some cool receiver do
that right superspy hardware but

52
00:03:56,400 --> 00:04:00,100
everything you know why are you doing
this when you know every thing on the

53
00:04:00,100 --> 00:04:03,480
planet now has all the different ways of
communicating with the rest of the world

54
00:04:03,480 --> 00:04:07,980
a Bluetooth wi-fi cellular internet ok
well here's the answer

55
00:04:07,980 --> 00:04:12,149
that's true you can send information
through all of these remission meetings

56
00:04:12,150 --> 00:04:16,060
but is a well-known and their monitor
right so if you want to export

57
00:04:16,060 --> 00:04:21,350
re-segregated through this there's about
billions of dollars of R&D and

58
00:04:21,350 --> 00:04:25,190
technology that stands between you and
getting that information out to think

59
00:04:25,190 --> 00:04:28,010
about the firewall anything a large
package anything that monitors traffic

60
00:04:28,010 --> 00:04:33,690
we want to avoid that entirely ok so
we're not going to you and brands of you

61
00:04:33,690 --> 00:04:38,210
can avoid it becomes a detector ok but
we don't wanna be happy attackers who

62
00:04:38,210 --> 00:04:40,888
are not going to use any of these
commissioners transmission mediums

63
00:04:40,889 --> 00:04:45,770
instead we're going to use a transmit
transmission medium of the attackers

64
00:04:45,770 --> 00:04:50,090
shooting and we need to do some things
that you the defender are not going to

65
00:04:50,090 --> 00:04:54,330
be able to monitor effectively and lucky
for us the attacker

66
00:04:54,330 --> 00:04:58,479
we have all of the inspections to play
with so we can start with you know

67
00:04:58,479 --> 00:05:01,250
something that's in the suburb who's the
grand jury this is where the ghost

68
00:05:01,250 --> 00:05:05,710
hunter will come in and we can go
slightly higher frequency and enter the

69
00:05:05,710 --> 00:05:09,349
acoustic range and if we're gonna be a
little bit antsy about it we can do

70
00:05:09,350 --> 00:05:14,740
ultrasonic okay and then after that we
can hopefully hop on to all of the earth

71
00:05:14,740 --> 00:05:19,550
bands right and emanate information
encoding modulated and get it out to the

72
00:05:19,550 --> 00:05:22,190
rest of the world where the attack
occurred in here

73
00:05:22,190 --> 00:05:26,080
ok so why would we want to do this why
do we want to go through all this

74
00:05:26,080 --> 00:05:30,419
trouble I suppose you had a super secret
for it just like this one

75
00:05:30,419 --> 00:05:35,650
ok this war is full of you know secret
things a secret people with all sorts of

76
00:05:35,650 --> 00:05:40,270
secret in it right and you the attacker
want to know all the secrets so the most

77
00:05:40,270 --> 00:05:44,430
obvious way to do this right is you know
get some hour in there and just have all

78
00:05:44,430 --> 00:05:48,200
the machines and all the things that
information directly out to the internet

79
00:05:48,200 --> 00:05:52,780
using their network cable or just
mention this is really obvious and you

80
00:05:52,780 --> 00:05:57,940
can write something hopefully at least a
small portion of the billions of dollars

81
00:05:57,940 --> 00:06:01,840
of R&D and technology products it's
meant to find you detect you will

82
00:06:01,840 --> 00:06:05,909
actually capture this attempt so you
don't want to do this and really if

83
00:06:05,910 --> 00:06:09,720
we're talking about an actual superseded
for right there's probably an air gap

84
00:06:09,720 --> 00:06:12,650
where the things not exactly connected
to the Internet

85
00:06:12,650 --> 00:06:18,419
anyway so what we need is and he's super
secret for technology

86
00:06:18,419 --> 00:06:23,570
okay and you know I'm sure everybody's
here senior last year we went through

87
00:06:23,570 --> 00:06:27,840
the end catalog and it's a great and I i
dont no incidents were so I'm just gonna

88
00:06:27,840 --> 00:06:33,820
take you look into that catalog and this
is what this is what they recommended

89
00:06:33,820 --> 00:06:35,500
here's a way to do it

90
00:06:35,500 --> 00:06:41,370
you first get an intern ok the interior
also will have a tiny little electronic

91
00:06:41,370 --> 00:06:44,409
component rate that's called the regular
reflector that's a very small very

92
00:06:44,409 --> 00:06:49,289
sneaky and in the last you gonna need is
something like the CTX 4,000 which is a

93
00:06:49,289 --> 00:06:54,300
suitcase sized radar generator thing bob
that does continue as aris illumination

94
00:06:54,300 --> 00:06:59,289
right and here's how you put all these
three things together they step 12 in

95
00:06:59,289 --> 00:07:04,849
turn into the secret or ok that's kind
of hard but you know let's let's go with

96
00:07:04,849 --> 00:07:09,080
it right you can do it then turned it
and stepped to the interest is icky

97
00:07:09,080 --> 00:07:14,690
leaves implant onto a machine or device
that we want who's okay and then of

98
00:07:14,690 --> 00:07:19,860
course hopefully things out without
being killed right and step three is the

99
00:07:19,860 --> 00:07:26,620
interns on the CTS 4,000 trade and
enables is continuous stream of of our

100
00:07:26,620 --> 00:07:31,229
of elimination which looks like this
it's basically a radar beam pointed at

101
00:07:31,229 --> 00:07:36,529
the thing that we want to hear ok and if
everything works as well and nobody I

102
00:07:36,529 --> 00:07:40,659
killed in what he found out that you
stuck in their input implanting what

103
00:07:40,659 --> 00:07:45,820
happens then is the retro reflector
modulated data using the energy from the

104
00:07:45,820 --> 00:07:50,159
the radar being and then you know trades
information which they in turn can now

105
00:07:50,159 --> 00:07:55,300
race so that's that sounds like a fun
idea you know maybe but this is only a

106
00:07:55,300 --> 00:07:59,550
good idea of what say you had infinite
interns right and and also you didn't

107
00:07:59,550 --> 00:08:03,500
worry about leaving physical evidence
behind right because you still have the

108
00:08:03,500 --> 00:08:06,820
physical implant stuck in the secret for
it and if somebody finds it is going to

109
00:08:06,820 --> 00:08:11,360
be pretty obvious greatly they're being
spied on but I guess number two is not a

110
00:08:11,360 --> 00:08:15,630
real problem because of number one you
know if you had secretly like you can

111
00:08:15,630 --> 00:08:16,409
get them to come in

112
00:08:16,409 --> 00:08:20,739
come out and that's not really a problem
but you know let's think about red

113
00:08:20,739 --> 00:08:25,679
reflector technology is very cool but we
have to put it into historical context

114
00:08:25,679 --> 00:08:30,149
right why was this thing I meant it why
was it invented in and how was it

115
00:08:30,149 --> 00:08:36,089
deployed in its in its heyday so the
earliest example of Russia reflector

116
00:08:36,089 --> 00:08:39,839
that I know of is the thing right so
this is a very cool piece of passive

117
00:08:39,839 --> 00:08:44,480
element that was hidden inside this
plaque that was given to the American

118
00:08:44,480 --> 00:08:49,199
Embassy in russia this is circa 1960 the
nice thing about this was completely

119
00:08:49,199 --> 00:08:52,670
passive know and know how to power
source you bounce rate are being offered

120
00:08:52,670 --> 00:08:56,449
this little guy and the the diaphragm
actually modulated the reflectance and

121
00:08:56,449 --> 00:09:01,089
you can hear audio data audio signal
from that room you know outside that

122
00:09:01,089 --> 00:09:07,079
building right but you have to shine and
radar being a limitation directly at the

123
00:09:07,079 --> 00:09:11,519
device for this thing to work so this is
very cool off her back in the day

124
00:09:11,519 --> 00:09:17,240
ok but this was a phone back in the day
right that was the phone that reflects

125
00:09:17,240 --> 00:09:21,980
it was really meant to implant is fine
but we don't have those anymore and we

126
00:09:21,980 --> 00:09:22,819
have this phone

127
00:09:22,819 --> 00:09:28,740
okay and and back in the day this was
you know an office we had your IBM

128
00:09:28,740 --> 00:09:32,209
Selectric typewriter and I don't really
know what this little guy is but I'm

129
00:09:32,209 --> 00:09:37,518
sure it's very cool yeah but today you
know we have this office we have

130
00:09:37,519 --> 00:09:41,709
computers network printers you know blah
blah blah all connected to the network

131
00:09:41,709 --> 00:09:46,349
right so let's ask the question you know
what's the difference between this phone

132
00:09:46,350 --> 00:09:52,810
and this phone ok well the difference is
this is about 500 million or so yes I

133
00:09:52,810 --> 00:09:57,810
million transistors or more on the phone
that we use today there's about at least

134
00:09:57,810 --> 00:10:01,979
a million lines of code and the big
difference is the phone today isn't

135
00:10:01,980 --> 00:10:06,300
really a phone and so is a general
purpose computing device right fit into

136
00:10:06,300 --> 00:10:09,359
a plastic cage or a case that makes you
think that this works as a

137
00:10:09,360 --> 00:10:15,059
special-purpose thing like a telephone
or a router or whatever it is so the

138
00:10:15,059 --> 00:10:19,350
next question is can we leverage this
difference to do better than our efforts

139
00:10:19,350 --> 00:10:22,220
reflectors right if we wanted to sneak
into Syria forward and get this

140
00:10:22,220 --> 00:10:25,610
information now so

141
00:10:25,610 --> 00:10:31,980
rate we want to imitate analogous like a
boss so here's what we want to do we

142
00:10:31,980 --> 00:10:36,420
want to export trade data from using
only software right we don't want to do

143
00:10:36,420 --> 00:10:40,349
our nation we don't want to do
implantation hey we want to just get the

144
00:10:40,350 --> 00:10:44,560
software in and get the data out and we
want the software to run on all the

145
00:10:44,560 --> 00:10:49,449
things right so it's you know it's
possible maybe to raid her pillow for

146
00:10:49,450 --> 00:10:53,410
specific type of device but it would
really be gravely and generalizes and

147
00:10:53,410 --> 00:10:57,279
come up with a technique that will work
I'm basically every embedded device out

148
00:10:57,279 --> 00:11:01,930
there and we also want to be able to
transmit the data an arbitrary

149
00:11:01,930 --> 00:11:05,300
frequencies using arbitrate data
modulation schemes and encoding schemes

150
00:11:05,300 --> 00:11:10,370
of potentially crypto right of the
attackers choosing and lastly we want

151
00:11:10,370 --> 00:11:14,209
this to all evaporate when we're done we
don't want to leave behind evidence that

152
00:11:14,209 --> 00:11:17,649
we don't want to leave physical evidence
behind this operation just you know it's

153
00:11:17,649 --> 00:11:21,670
operated when we're done with that
expectation ok so we can totally do this

154
00:11:21,670 --> 00:11:24,599
the first part is we're going to take
advantage what we know about

155
00:11:24,600 --> 00:11:29,320
compromising any nation and the second
part is we're going to do when you take

156
00:11:29,320 --> 00:11:32,890
advantage of you know some former
shenanigans which will talk about which

157
00:11:32,890 --> 00:11:37,769
is the bulk of the work so as far as
compromising emanations go there is a

158
00:11:37,769 --> 00:11:41,540
rich history of research done in this
area you know for example of a neck

159
00:11:41,540 --> 00:11:46,099
right you can actually reconstruct the
content of CRT monitors are very very

160
00:11:46,100 --> 00:11:51,089
far away by looking at the rflp test of
the monitor and Marcus consider this the

161
00:11:51,089 --> 00:11:56,180
next level by looking at things like
LCDs and other things and somewhere in

162
00:11:56,180 --> 00:12:01,640
the nineties yeah we discovered that you
can actually pick up on our F signal FM

163
00:12:01,640 --> 00:12:06,630
signal coming off of your transmission
lines of cars 232 console cables right

164
00:12:06,630 --> 00:12:11,370
and we're gonna visit both of those
things and you know more recently you

165
00:12:11,370 --> 00:12:18,380
know we talked about kids action by
basically listening to the Bahamas of of

166
00:12:18,380 --> 00:12:24,709
the capacitors of machines doing are as
a right to pick out the content of our

167
00:12:24,709 --> 00:12:29,029
secret as a key from something like four
metres away so that's that's very cool

168
00:12:29,029 --> 00:12:34,050
this is you know what this had a blog
leg but let's think about what all of

169
00:12:34,050 --> 00:12:35,670
these works have in common

170
00:12:35,670 --> 00:12:36,630
ok so

171
00:12:36,630 --> 00:12:40,150
the more journey of the history of
compromising emanations research goes

172
00:12:40,150 --> 00:12:44,740
something like this you take a very
faint accidentally leaked signal from

173
00:12:44,740 --> 00:12:51,170
some device right and you use a very big
powerful and tenant to try to capture

174
00:12:51,170 --> 00:12:54,800
that tiny little accidentally leaked
said no and you throw a lot of computing

175
00:12:54,800 --> 00:12:58,410
power at it to extract some
computational state of the victims

176
00:12:58,410 --> 00:13:00,839
device like an RSA key or a leg

177
00:13:00,840 --> 00:13:06,730
data being transmitted on the arse
two-thirds you like but what is we turn

178
00:13:06,730 --> 00:13:08,110
this on his head upside down

179
00:13:08,110 --> 00:13:12,850
ok so what if we take advantage or use
software to create very loud

180
00:13:12,850 --> 00:13:17,700
intentionally induced leakage of
information using a nation and we take

181
00:13:17,700 --> 00:13:21,460
this big powerful and had a you know
what can we do you can we do better than

182
00:13:21,460 --> 00:13:25,850
you know getting our CD from 40 metres
away right and so how much better can we

183
00:13:25,850 --> 00:13:30,670
do an order of magnitude better or even
more ok so I'm gonna show you the first

184
00:13:30,670 --> 00:13:35,640
demo the first demo is an acoustic lens
enemy nations will keep in mind race you

185
00:13:35,640 --> 00:13:38,330
think about the context of the the
shamir

186
00:13:38,330 --> 00:13:44,090
cute russian example of laptop are
saying you know corruption and tiny

187
00:13:44,090 --> 00:13:49,360
amount of audio data coming out of it
that's offer induce acoustic output so

188
00:13:49,360 --> 00:13:53,880
let me show you how much better we can
do when we do this intentionally ok so

189
00:13:53,880 --> 00:13:57,950
what we have here is a pending laser
printer which I'll talk about later it's

190
00:13:57,950 --> 00:14:02,700
that she was found on Amazon it's not
that great of a printer but it's really

191
00:14:02,700 --> 00:14:12,470
good for making something else sounds
and such so let's run this payload

192
00:14:12,470 --> 00:14:22,310
so this thing doesn't have a speaker
right it's not meant to make sound but

193
00:14:22,310 --> 00:14:26,949
it is so this is actually using montana
code to modulate down its own boot code

194
00:14:26,950 --> 00:14:32,630
down to the range and it's literally
singing at home before back to rate and

195
00:14:32,630 --> 00:14:36,570
their desk so instead of tiny amount of
sound right we can create a whole lot of

196
00:14:36,570 --> 00:14:40,560
it and that's the intuition for the rest
of this intentionally create this

197
00:14:40,560 --> 00:14:47,489
nomination we can do a lot better and
potentially see how information at

198
00:14:47,490 --> 00:14:59,620
longer distances and at higher data
rates ok and this is where the the ghost

199
00:14:59,620 --> 00:15:03,900
hunter to all came in right so not only
when do you agree that we can do

200
00:15:03,900 --> 00:15:09,290
something so this is the the Geo phone
hooked up to bottom line into my sound

201
00:15:09,290 --> 00:15:13,110
card and over here you see something
that we have signals in the sub one

202
00:15:13,110 --> 00:15:18,580
color range ok and the setup look like
this this is my messy desk this is the

203
00:15:18,580 --> 00:15:23,940
printer and over here is my code busters
thing and added it does probably fairly

204
00:15:23,940 --> 00:15:27,850
far but not far enough to get out the
building but it does work so that

205
00:15:27,850 --> 00:15:31,810
answers the question really you know is
it like humans and such now not really

206
00:15:31,810 --> 00:15:39,150
so I'm gonna put that answer on this
presentation and turns out really give

207
00:15:39,150 --> 00:15:43,240
you just treat the frequencies of a tiny
little bit and suitable for someone who

208
00:15:43,240 --> 00:15:48,010
sees you go straight into the ultrasonic
range right so you know this is

209
00:15:48,010 --> 00:15:52,250
obviously useful for sending signals
back and forth using computers with

210
00:15:52,250 --> 00:15:56,100
microphones and speakers you know
without using a speaker course but this

211
00:15:56,100 --> 00:15:57,140
probably also

212
00:15:57,140 --> 00:16:02,750
dogs this is probably a decent dog was
all right which you know I haven't yet

213
00:16:02,750 --> 00:16:06,890
tested because nobody would give me your
dog for experimentation but you do get

214
00:16:06,890 --> 00:16:11,960
two very distinct sandoz one about 7027
herdsmen about $42 hurts right human

215
00:16:11,960 --> 00:16:15,840
hearing stops at about seventeen
eighteen coloreds so we're definitely an

216
00:16:15,840 --> 00:16:20,200
ultrasonic territory and the principle
of the separation is exactly the same

217
00:16:20,200 --> 00:16:23,550
causing this thing to lipids GPIO pin

218
00:16:23,550 --> 00:16:28,149
that's kind of a small but fast enough
that the capacitors are actually humming

219
00:16:28,149 --> 00:16:32,029
and vibrating and causing this acoustic
out but just like you know what you're

220
00:16:32,029 --> 00:16:37,189
talking about and his paper but much
stronger now this is not at all in fact

221
00:16:37,190 --> 00:16:42,790
in 1998 Markus Kuhn wrote this amazing
paper call soft tempest it deals with

222
00:16:42,790 --> 00:16:47,990
exactly this using software to induce
compromising nation to extol trade data

223
00:16:47,990 --> 00:16:52,790
and he was mostly interested in ways of
mitigating that through different funds

224
00:16:52,790 --> 00:16:57,540
and whatnot but who is contained in VGA
output output to the monitor so for

225
00:16:57,540 --> 00:17:02,339
example if you put this line in your
config your screen will show up with

226
00:17:02,339 --> 00:17:07,559
this kind of pattern right and that
pattern with me about our signal at

227
00:17:07,559 --> 00:17:11,579
about 300 killer hurts right and in fact
if you you too I think something like

228
00:17:11,579 --> 00:17:15,839
modern realizes a people thing called an
entire songs and symphonies using this

229
00:17:15,839 --> 00:17:22,109
it's really fun to check out now when he
first presented as I was probably only

230
00:17:22,109 --> 00:17:26,919
seventeen or something I eventually read
the slides and the last line of the

231
00:17:26,920 --> 00:17:32,130
slide the last two hours of this rain
made me really think you know he said

232
00:17:32,130 --> 00:17:36,550
this is obviously good idea it's very
interesting but very much of it or very

233
00:17:36,550 --> 00:17:40,970
little it is discussed in open
literature ok so you can figure out what

234
00:17:40,970 --> 00:17:46,490
that means and then nothing happened for
about a decade so nobody followed up and

235
00:17:46,490 --> 00:17:50,970
that's where I cannot really and very
recently we had a a series of papers

236
00:17:50,970 --> 00:17:55,110
dealing with basically follow up so
using intentionally induced compromise

237
00:17:55,110 --> 00:17:59,520
compromising emanations who has data the
first one that I want to talk about his

238
00:17:59,520 --> 00:18:05,270
bid was eight and uses thereof or
variations to get anywhere between 128

239
00:18:05,270 --> 00:18:10,050
bits per hour right and it's effective
transmission distances about I think

240
00:18:10,050 --> 00:18:16,610
forty centimeters so it's probably good
academic paper but not very useful and a

241
00:18:16,610 --> 00:18:21,100
second one talks about acoustic coupling
bidirectional communication and there

242
00:18:21,100 --> 00:18:27,330
you can deliver better you can get about
an 18.7 meters right and about twenty 20

243
00:18:27,330 --> 00:18:32,220
bits per second which is much much
better than you know a power and they're

244
00:18:32,220 --> 00:18:35,460
one is kind of cute so the authors talk
about

245
00:18:35,460 --> 00:18:41,350
out monitor our examination and pick
that up using cell from FM receivers

246
00:18:41,350 --> 00:18:43,939
that's kinda cool rate and over there
they were able to get about seven metres

247
00:18:43,940 --> 00:18:49,940
and up to 60 bits per second so what is
the obvious next step in this line of

248
00:18:49,940 --> 00:18:55,380
research first we should generalize and
unify the methodology for transmission

249
00:18:55,380 --> 00:18:57,570
rates instead of just causing

250
00:18:57,570 --> 00:19:02,370
examination or automation and monitor we
want to generalize the principle of the

251
00:19:02,370 --> 00:19:06,389
song so we can run it on every single
device and we want to minimize the

252
00:19:06,390 --> 00:19:10,490
hardware requirements necessary so we
don't want to depend on a specific VGA

253
00:19:10,490 --> 00:19:14,700
card or specific sound card we want to
be able to do this I'm pretty much every

254
00:19:14,700 --> 00:19:19,539
embedded device to help their pay and
this is where Fontana comes in montana

255
00:19:19,539 --> 00:19:23,990
101 let's say you have your rate and
suppose somewhere on the stage we have a

256
00:19:23,990 --> 00:19:31,490
pen that is an output pin that puts out
a binary 10 so as they suffered person

257
00:19:31,490 --> 00:19:37,149
would you can do is set the logic but
was later his pen 2010 1:01 and what you

258
00:19:37,149 --> 00:19:42,399
would expect is a square wave right if
you put it in those Co 80233 whatever

259
00:19:42,399 --> 00:19:47,370
you're here voltages now this is where
you know me this other person says okay

260
00:19:47,370 --> 00:19:52,870
so all I have to do is Mrs magic right
and transmit translate that square wave

261
00:19:52,870 --> 00:19:58,289
into our signal then I'm done right and
we went and we get our estimation so

262
00:19:58,289 --> 00:20:04,590
this is what I did ok advanced as the
hour do some homework learn some math

263
00:20:04,590 --> 00:20:10,549
and that turned out to be super not
produced a great and then little bit

264
00:20:10,549 --> 00:20:14,139
less ambitious let's talk about how does
radio how to radios are you know what is

265
00:20:14,140 --> 00:20:15,059
what is that

266
00:20:15,059 --> 00:20:25,259
RAF way about that you know and then
lets rate electrons like what is that

267
00:20:25,259 --> 00:20:29,860
how does it worry you know but ok so we
can actually do something here I

268
00:20:29,860 --> 00:20:34,590
remember my high school physics math
equations these the top to basically

269
00:20:34,590 --> 00:20:40,129
will answer all of our questions they're
so take your thing take your pen right

270
00:20:40,129 --> 00:20:44,059
if you're running current through that
wire with electrons move through this

271
00:20:44,059 --> 00:20:51,019
wire right what happens is that it will
induce a magnetic field right remember

272
00:20:51,019 --> 00:20:57,389
the the the thumb rule and then what
happens after that is that magnetic

273
00:20:57,389 --> 00:21:01,498
field would induce an electric field and
so on and so forth right and this is

274
00:21:01,499 --> 00:21:07,220
what we call electromagnetic simulation
and we do this at the right speed we get

275
00:21:07,220 --> 00:21:10,429
the right signal and then we can receive
it using you know something I can ask

276
00:21:10,429 --> 00:21:15,759
the hour or an AM radio whatever it is
so here is a very great if we can change

277
00:21:15,759 --> 00:21:20,909
the frequency of of the business going
from zero to one and it's something we

278
00:21:20,909 --> 00:21:24,220
control then if we put this on the
frequency domain we should definitely

279
00:21:24,220 --> 00:21:31,210
see on our signal of a frequency rate of
some intensity and in an ideal world we

280
00:21:31,210 --> 00:21:36,570
should also see some very weak harmonics
every particular locations like weekly

281
00:21:36,570 --> 00:21:42,360
spaced apart now that's the theory part
two of those areas

282
00:21:42,360 --> 00:21:47,449
ok so if we can do this let's look at
some of the most ubiquitous mechanisms

283
00:21:47,450 --> 00:21:53,070
we find on system on chips embedded
devices first one we looked at was PWM

284
00:21:53,070 --> 00:21:58,639
pulse width modulation and also pins
that response for GPIO a general-purpose

285
00:21:58,639 --> 00:22:02,428
input-output self-control pins that
could either act as input tray for

286
00:22:02,429 --> 00:22:06,710
buttons and such and I'll put you know
lighting up le dicen things and the

287
00:22:06,710 --> 00:22:11,649
third when we looked at was the you are
basically the serial port you know maybe

288
00:22:11,649 --> 00:22:16,129
we can do something they're so here's
where we did a lot of Science ok so for

289
00:22:16,129 --> 00:22:19,379
each of these types of pens we wanted to
answer this question

290
00:22:19,379 --> 00:22:23,689
ok what our values that are possible for
the treatment of these things too busy

291
00:22:23,690 --> 00:22:27,190
to help asking me flip PWM GPIO and you
are ok

292
00:22:27,190 --> 00:22:31,330
and the second question is you know what
is the optimal value for flipping these

293
00:22:31,330 --> 00:22:36,199
cans right how fast should we put these
pins and of course there's also the

294
00:22:36,200 --> 00:22:40,890
third question of you know what type of
what length of radiator so the antenna

295
00:22:40,890 --> 00:22:43,760
right right here we're not gonna have an
antenna but you know we have tiny little

296
00:22:43,760 --> 00:22:49,430
wires and circuitry let's say what
length antenna is best or what length of

297
00:22:49,430 --> 00:22:53,540
antenna just straightforward and what is
his will will do the job to what degree

298
00:22:53,540 --> 00:22:59,040
so here's our experimental setup right
we made the terrible Faraday cage that

299
00:22:59,040 --> 00:23:02,300
didn't work very well but it was enough
for this experiment and this is where we

300
00:23:02,300 --> 00:23:07,879
couldn't afford you know the maternity
panties rate we had to get sheets of

301
00:23:07,880 --> 00:23:12,220
copper because otherwise we're in the
way too expensive and we use the bus

302
00:23:12,220 --> 00:23:18,140
pirate with the GPIO facility for the
bus to physically flip these pens at

303
00:23:18,140 --> 00:23:23,470
predictable raids and then we measured
the signal-to-noise ratio of each one of

304
00:23:23,470 --> 00:23:28,250
those experiments and we receive the
signal using the standard USB to with

305
00:23:28,250 --> 00:23:32,260
the basic our export and the nice thing
about the basic our export is it will

306
00:23:32,260 --> 00:23:37,110
receive friends at a very low range so I
think it goes anywhere between women

307
00:23:37,110 --> 00:23:41,770
hurts you about 250 neighborhoods ok so
here's you know one day two point that

308
00:23:41,770 --> 00:23:47,900
we gathered for example given a 30
centimetre radiator right when we

309
00:23:47,900 --> 00:23:53,950
flipped the pen at half a major her $500
hurts we observed a harmonic at about

310
00:23:53,950 --> 00:23:59,470
2.5 right that's expected and we're
getting something like what they look

311
00:23:59,470 --> 00:24:04,120
like 70 decibels of noise of
signal-to-noise right and we did this

312
00:24:04,120 --> 00:24:09,250
over and over again we've created this
graph ok so here are all of the the the

313
00:24:09,250 --> 00:24:13,460
the the antenna lance and the
frequencies of transmission and the

314
00:24:13,460 --> 00:24:17,260
signal strength that we are able to get
out of it if I have time I just want to

315
00:24:17,260 --> 00:24:21,670
come back to this graphic is you see
these laws I like these these low areas

316
00:24:21,670 --> 00:24:27,080
you wouldn't they fall directly on
lengths that you would expect to have

317
00:24:27,080 --> 00:24:30,699
its a small fraction of the perfect
antenna so we were talking about the

318
00:24:30,700 --> 00:24:35,480
ones that thousands of the perfect adopt
them all in handling and you would

319
00:24:35,480 --> 00:24:39,790
expect if you got it exactly right
there's going to be a very high but we

320
00:24:39,790 --> 00:24:43,360
found exactly the opposite so this is a
really strange phenomenon that I think I

321
00:24:43,360 --> 00:24:48,729
know I think I understand why that is
but what it says is gonna work and it's

322
00:24:48,730 --> 00:24:54,610
actually better to be to not have a
perfect and her radiator length of your

323
00:24:54,610 --> 00:24:59,020
imperfect about every little bit off
given the real realistic Rangers and

324
00:24:59,020 --> 00:25:03,440
working with which is in a sub inches
and 6 feet right you want to be slightly

325
00:25:03,440 --> 00:25:09,830
imperfect being perfect is actually back
so they did analysis what are the

326
00:25:09,830 --> 00:25:14,270
possible values of the frequency at
which we can put these pens and you know

327
00:25:14,270 --> 00:25:18,260
what are the optimal values and what is
the optimal length of the radiator the

328
00:25:18,260 --> 00:25:22,290
last one is really simple basically if
you don't have a radiator it won't work

329
00:25:22,290 --> 00:25:25,280
right so if you're talking about just
the pattern the circuit board it doesn't

330
00:25:25,280 --> 00:25:29,770
emanate at all right it's the signal is
very faint we weren't able to pick it up

331
00:25:29,770 --> 00:25:33,710
and really you know the longer the
better rate them in that that makes

332
00:25:33,710 --> 00:25:34,560
sense

333
00:25:34,560 --> 00:25:39,810
antenna so the next thing is possible
values for F

334
00:25:39,810 --> 00:25:45,070
the hard when will we work with those
pretty standard for your ILT or embedded

335
00:25:45,070 --> 00:25:49,919
device controller and the PWM we were
able to flip it anywhere between 10

336
00:25:49,920 --> 00:25:53,670
killers in four major hurts but on the
pending printer that we worked with the

337
00:25:53,670 --> 00:26:00,650
PLO 13 killers which is on the very low
end of this GPIO is very similar we were

338
00:26:00,650 --> 00:26:05,000
able to flip GPIO pins in about 10
killers to five megahertz although in

339
00:26:05,000 --> 00:26:11,000
some modern processors you probably go
up to 20 30 40 makers and you are you

340
00:26:11,000 --> 00:26:15,900
know if you really tried you can
probably get that explains a flip as for

341
00:26:15,900 --> 00:26:20,330
megahertz although it definitely wasn't
very reliable so effective range there

342
00:26:20,330 --> 00:26:27,689
is probably anywhere between you know
$100 her to just shy of a major hurt now

343
00:26:27,690 --> 00:26:34,340
optimal value for us that's the easy
answer because you have to transmit

344
00:26:34,340 --> 00:26:39,010
you want to transmit around 20 to 25
megahertz Saturday how did I get that

345
00:26:39,010 --> 00:26:43,060
value member this secret for it right
that I do before it turns out it

346
00:26:43,060 --> 00:26:44,350
actually does exist

347
00:26:44,350 --> 00:26:47,280
ok this is an Air Force Base rallies
that existed

348
00:26:47,280 --> 00:26:51,510
eighties and there was a really
fantastic paper therefore put out that

349
00:26:51,510 --> 00:26:54,760
that's what about our permeability of
you know steel reinforced concrete

350
00:26:54,760 --> 00:27:00,590
structures right very useful so let's
say you wanted to find out a way to foot

351
00:27:00,590 --> 00:27:05,879
thick still increased US steel
reinforced the bunker ok they're finding

352
00:27:05,880 --> 00:27:09,340
say exactly this radio want to be able
to transmit above a hundred megahertz

353
00:27:09,340 --> 00:27:16,939
because below that your induced magnetic
field will be reduced and above 200

354
00:27:16,940 --> 00:27:21,250
words your electric field right and
there's not gonna do very well so the

355
00:27:21,250 --> 00:27:25,060
sweet spot between one and two words
right that's exactly where you wanna go

356
00:27:25,060 --> 00:27:28,290
but you know obviously there's a problem
right because we can only hope these

357
00:27:28,290 --> 00:27:31,690
pens at five megahertz you know how we
really gonna be able to get to the two

358
00:27:31,690 --> 00:27:37,510
hundred and make her range which I will
show you later okay so all those things

359
00:27:37,510 --> 00:27:42,050
put together let's talk about generalize
this is what you want to do you take

360
00:27:42,050 --> 00:27:46,590
your thing you take your PIN ok and
would you want to do is put the spin

361
00:27:46,590 --> 00:27:51,659
turn it on and wait a specific amount of
time and then turn this off and then

362
00:27:51,660 --> 00:27:52,980
wait a specific amount of time

363
00:27:52,980 --> 00:27:59,050
rate and that's going to create this
square wave on the line and you want to

364
00:27:59,050 --> 00:28:02,700
do this at a predictable frequency right
and you wanna do this over and over

365
00:28:02,700 --> 00:28:06,740
again for a specific number of
iterations though you know I call symbol

366
00:28:06,740 --> 00:28:10,370
duration ok so the specific period of
time

367
00:28:10,370 --> 00:28:15,679
ok so if you do this then you create
something like this which you know given

368
00:28:15,680 --> 00:28:19,350
you know we talked about will emanate on
our signal which then you can use to

369
00:28:19,350 --> 00:28:23,090
receive them hopefully they modulate but
before you do that you have to choose a

370
00:28:23,090 --> 00:28:27,270
modulation scheme so we're going to try
to approximate some very common

371
00:28:27,270 --> 00:28:31,280
modulation schemes that's easy to work
with the first we'll look at is

372
00:28:31,280 --> 00:28:36,410
institutions he is gay the second one is
FSK in the third world frequency shift

373
00:28:36,410 --> 00:28:40,930
keying and the last one we work with his
on-and-off King and I say approximate

374
00:28:40,930 --> 00:28:44,980
because we're not really going to be
able to do chuletas K for example

375
00:28:44,980 --> 00:28:48,440
because the things we're working with
our discrete values were not have

376
00:28:48,440 --> 00:28:55,710
continuous signal so we tried to process
this as much as we can so amplitude

377
00:28:55,710 --> 00:29:00,380
shift keying very easy writes all you
have to do is flip your pins for a

378
00:29:00,380 --> 00:29:03,680
specific amount of time right that's
gonna generate an arts ago and then you

379
00:29:03,680 --> 00:29:07,850
don't look your plans for a specific
time so this is a binary SK on and off

380
00:29:07,850 --> 00:29:12,540
the problem here is timing has to be
exactly right because if you start

381
00:29:12,540 --> 00:29:16,649
shifting your sample that's a status
symbol right here and right here and

382
00:29:16,650 --> 00:29:20,790
these are shifting right you're gonna
start missing bits because you're you're

383
00:29:20,790 --> 00:29:25,050
going to be a line from win the one of
its stars in the one that ends in 0 bids

384
00:29:25,050 --> 00:29:30,389
0 comments but it does work so if you
want to transmit 1010 just flip wait a

385
00:29:30,390 --> 00:29:35,510
little bit flip wait a little bit ok the
next one we want to talk about is

386
00:29:35,510 --> 00:29:40,900
frequency shift keying so instead of
just for peter pan and then waiting and

387
00:29:40,900 --> 00:29:44,600
then put your PIN again at the exact
same treatment see what you wanna do is

388
00:29:44,600 --> 00:29:49,209
flip your Pinterest at one frequency
then flip your pen at another frequency

389
00:29:49,210 --> 00:29:53,230
right and that's not easy to do because
all you have to do the do this is to

390
00:29:53,230 --> 00:29:58,700
change the delay values between you know
on and off right and if you did this get

391
00:29:58,700 --> 00:30:01,990
one free Boosie emanating and then
another frequency emanating

392
00:30:01,990 --> 00:30:07,600
back and forth so this is sort of FSK
for the offenders in the room rate yes

393
00:30:07,600 --> 00:30:12,810
this is not exactly one percent of
escape but it does work so the third one

394
00:30:12,810 --> 00:30:17,490
that we tried is the one we like the
most is called just simple on-off keying

395
00:30:17,490 --> 00:30:21,360
so the demo that I'll show you later we
slow this thing down enough that you can

396
00:30:21,360 --> 00:30:25,600
actually see the thing on the stream and
if you took out a piece of paper you can

397
00:30:25,600 --> 00:30:31,070
actually decode the information in real
time just to show intuitively know what

398
00:30:31,070 --> 00:30:37,600
this all looks like so a win for example
is a long duration of loved ones have

399
00:30:37,600 --> 00:30:42,669
been sleeping rate in a zero is a short
duration and the nice thing about here

400
00:30:42,670 --> 00:30:47,580
is you don't really have to worry about
timing as much because you don't have to

401
00:30:47,580 --> 00:30:52,340
the period of silence doesn't really
matter you can start by detecting oh

402
00:30:52,340 --> 00:30:53,439
clock edge or

403
00:30:53,440 --> 00:30:58,850
energy high and then you just wait and
see how long that high signal last four

404
00:30:58,850 --> 00:31:03,509
then you can go quiet for an arbitrary
period of time and then you do again you

405
00:31:03,509 --> 00:31:10,759
basically just measuring how long the
signal is is there and Longmans 10 and

406
00:31:10,759 --> 00:31:16,409
this is repeated over and over again to
send out binary data ok that's the

407
00:31:16,409 --> 00:31:20,690
theory let's talk about some henna in
practice the one the hardware platform

408
00:31:20,690 --> 00:31:24,889
that we chose is the Bantam laser
printer it's the cheapest burger we can

409
00:31:24,889 --> 00:31:29,678
find it even comes with a working USB
cable right for $39 you can buy it on

410
00:31:29,679 --> 00:31:30,889
Amazon with Free Shipping

411
00:31:30,889 --> 00:31:35,209
we've been able to get this thing down
to like $29 at some point and this is a

412
00:31:35,210 --> 00:31:39,210
really great platform for
experimentation because it's cheap it is

413
00:31:39,210 --> 00:31:46,039
a very typical device created in the way
that we create embedded devices and IOT

414
00:31:46,039 --> 00:31:50,009
things today right as an arm software
the whole bunch of GPIO and a bunch of

415
00:31:50,009 --> 00:31:53,299
control circuitry that makes the printer
thing but really this is just a general

416
00:31:53,299 --> 00:31:58,710
purpose I'm computer with a bunch of
pins that gives it it does have a lot of

417
00:31:58,710 --> 00:32:02,870
eye opens as beautiful as you are and
has changed so the JTAG is going to

418
00:32:02,870 --> 00:32:08,469
allow us to upload our code usually
reliable contested without going through

419
00:32:08,470 --> 00:32:12,509
a remote exploit which we found one but
you know we're not even going to talk

420
00:32:12,509 --> 00:32:15,789
about it because the software security
deposit here is terrible

421
00:32:15,789 --> 00:32:20,500
shouldn't be surprised about that so
remote location is possible but that's

422
00:32:20,500 --> 00:32:22,879
not really what we're interested in here

423
00:32:22,879 --> 00:32:25,750
alright here's the board race so here's
the sock and if you see all of these

424
00:32:25,750 --> 00:32:29,500
pins their sovereign control input and
output right so we can change the

425
00:32:29,500 --> 00:32:32,860
behavior of a lot of these pens just by
changing software which is exactly what

426
00:32:32,860 --> 00:32:39,539
we want and the back of the board and
the sock right not a lot of information

427
00:32:39,539 --> 00:32:43,408
about this awkward if you look at the
part number this is the product we found

428
00:32:43,409 --> 00:32:47,379
it online and here's a very typical
structure since the architecture for

429
00:32:47,379 --> 00:32:52,600
these arm-based socks for four devices
are you have a processor you have a

430
00:32:52,600 --> 00:32:58,570
bunch of I owe you have i2c serial SPI
GPIO and what's cool about this one is

431
00:32:58,570 --> 00:33:02,259
apparently this is an integrated laser
printers suck me it's a very special

432
00:33:02,259 --> 00:33:03,910
purpose thing either

433
00:33:03,910 --> 00:33:10,520
scattered control user control circuit
built right into the sock itself and

434
00:33:10,520 --> 00:33:13,639
also has no wifi but we're not gonna
touch that because we touch that the

435
00:33:13,640 --> 00:33:17,370
beach eating right so we're going to
have like the wifi chip doesn't exist at

436
00:33:17,370 --> 00:33:18,560
all

437
00:33:18,560 --> 00:33:22,790
little bit harder triage this is
basically a no-brainer crazy look had

438
00:33:22,790 --> 00:33:30,300
the board here what is this guy is right
here like you are ok and this 1010

439
00:33:30,300 --> 00:33:35,060
pattern appears JTAG so it took about
half an hour for severe this out right

440
00:33:35,060 --> 00:33:40,750
now and here is the JTAG pinout and
actually I encourage you guys to get

441
00:33:40,750 --> 00:33:44,150
these things get this printer and work
with yourself going to upload all of the

442
00:33:44,150 --> 00:33:49,020
code instructions how to play with the
pentium printer online right after the

443
00:33:49,020 --> 00:33:54,150
stock and if you look at the console
output there are debug commands without

444
00:33:54,150 --> 00:33:58,630
authentication that allows you to set
the target user temperature or warm up

445
00:33:58,630 --> 00:34:02,410
and such so you can really say like you
know said your warm temperatures to 250

446
00:34:02,410 --> 00:34:07,160
degrees and it would happily say like
yes boss Don braid and you know I

447
00:34:07,160 --> 00:34:14,970
anchors to play with that it's a lot of
fun so the first thing which I went on

448
00:34:14,969 --> 00:34:19,719
in practice PWM rate so there are a
bunch of these PWM his that controls

449
00:34:19,719 --> 00:34:26,469
motor speed user temperature power
production etcetera etcetera but the sad

450
00:34:26,469 --> 00:34:30,928
news here is we got no love from and
this actually does line up with the data

451
00:34:30,929 --> 00:34:35,668
we collected 13 Gillard's you're not
gonna get a lot of our examination right

452
00:34:35,668 --> 00:34:40,879
but we were able to get some acoustic
domination by manipulating the actual

453
00:34:40,880 --> 00:34:44,740
hardware mechanisms that you know these
pens control so let's move on to

454
00:34:44,739 --> 00:34:48,399
something more interesting ok we have
GPIO and it's like this thing has a

455
00:34:48,400 --> 00:34:53,510
whole lot of GPIO therefore banks right
total of 221 pins

456
00:34:53,510 --> 00:34:58,600
that's a lot so their bank if you see
that has 32 pins each and Banque de has

457
00:34:58,600 --> 00:35:03,900
25 and what are these pins do so some of
it is connected to things like buttons

458
00:35:03,900 --> 00:35:08,610
are these are employees and as an input
this is really a try to force because

459
00:35:08,610 --> 00:35:12,120
what that is basically a wired
high-speed GPIO

460
00:35:12,120 --> 00:35:17,859
that runs about the length of know from
from this process here to rate which is

461
00:35:17,860 --> 00:35:21,840
a couple of inches at least 20 thing
that is either grounded or not grounded

462
00:35:21,840 --> 00:35:30,190
pending with your president not so if
it's not grounded so if it's not

463
00:35:30,190 --> 00:35:40,320
grounded Michael often you hear me now I
just talks super loud and it's going

464
00:35:40,320 --> 00:35:48,130
alright okay so the pens for employee
has long wire which is really good for

465
00:35:48,130 --> 00:35:50,770
transmission but the problem there is
generally would you find his addy

466
00:35:50,770 --> 00:35:54,630
bouncer circuit right at the end of
input pins which were really slow down

467
00:35:54,630 --> 00:35:57,270
the rate at which you can flip these
things because there's basically

468
00:35:57,270 --> 00:36:05,050
capacitor that attenuate the iPad's how
fast you know from high to low rate but

469
00:36:05,050 --> 00:36:08,870
there are all sorts of other pens the
output pins that controls LEDs engine

470
00:36:08,870 --> 00:36:13,450
control power control toner power
control user control and lots and lots

471
00:36:13,450 --> 00:36:13,930
more

472
00:36:13,930 --> 00:36:18,220
so we still have things to work with
here right so the big question is out of

473
00:36:18,220 --> 00:36:23,270
the hundred and twenty-one which can do
I flip rate do I go through one at a

474
00:36:23,270 --> 00:36:25,040
time and see what happens

475
00:36:25,040 --> 00:36:29,460
no because you know we want to emanate
like a boss how do you do that you just

476
00:36:29,460 --> 00:36:32,420
flipped everything up in all the same
time as fast as you can

477
00:36:32,420 --> 00:36:37,940
you see what happens okay and and you
know it either work or not work maybe

478
00:36:37,940 --> 00:37:03,010
they'll catch on fire it didn't you know
but let's just so you know it's just a

479
00:37:03,010 --> 00:37:11,390
memory map register right and if you
write 20 X 20 from the beginning of the

480
00:37:11,390 --> 00:37:16,970
GPIO region right everybody in their
turns the specific Penn off so this is a

481
00:37:16,970 --> 00:37:20,779
memory map bridges through area for bank
aid there are four of these things right

482
00:37:20,780 --> 00:37:28,020
and if you want to turn on you you
talked you said that specific pen to 124

483
00:37:28,020 --> 00:37:32,270
row 32 bits there depends just put the
Pens you want right as you remember your

484
00:37:32,270 --> 00:37:37,070
dress and they're done now 100 code and
practice this is always talk right first

485
00:37:37,070 --> 00:37:42,070
we set up with the addresses for GPIO
banks then we loaded up into our

486
00:37:42,070 --> 00:37:45,190
registers and we're just gonna forget
about function halls anything like that

487
00:37:45,190 --> 00:37:50,500
right we're not gonna buy by calling
convention is we don't have to a network

488
00:37:50,500 --> 00:37:54,900
install depends on right and then we are
all the pants off and then we're going

489
00:37:54,900 --> 00:37:56,030
to use over and over again

490
00:37:56,030 --> 00:38:00,510
ok I'm gonna do this at about five
megahertz ok so that's that's fast as we

491
00:38:00,510 --> 00:38:05,580
could do this and when we did this
things got really interesting so many

492
00:38:05,580 --> 00:38:10,240
shows some videos of what that actually
looks like instead of a single pen in a

493
00:38:10,240 --> 00:38:13,850
controlled environment we're talking
about hundreds of pins in Unknown PC

494
00:38:13,850 --> 00:38:17,980
board doing all sorts of things turning
all sorts of power on and off at about

495
00:38:17,980 --> 00:38:23,430
50 yards so you know what do they look
like for the first time to show you is

496
00:38:23,430 --> 00:38:30,460
all the GPIO pins going off at the same
time doing on and off King UK and let's

497
00:38:30,460 --> 00:38:35,240
see this video will play this

498
00:38:35,240 --> 00:38:40,500
noticed that were flipping out about
five megahertz but were receiving at

499
00:38:40,500 --> 00:38:46,340
about 9.8 meters ok and that's not even
the weird part this thing goes all the

500
00:38:46,340 --> 00:38:51,500
way up to 300 yards which is why you
know I'm question whether I know how it

501
00:38:51,500 --> 00:38:55,610
works but you can see it on you can see
it on the scope this is it right so this

502
00:38:55,610 --> 00:39:00,490
is on and off right and notice also that
the harmonic distribution of this guy

503
00:39:00,490 --> 00:39:04,990
not not periodic not predictable at all
i mean that it's predictable but it's

504
00:39:04,990 --> 00:39:09,709
not regular right and if you have time
to talk about why that is but you know

505
00:39:09,710 --> 00:39:14,369
how interesting right the singles
everywhere in the harmonics are are

506
00:39:14,369 --> 00:39:19,630
stronger as you get higher up in the
frequency range in some places and not

507
00:39:19,630 --> 00:39:25,110
in some others so that's what she looks
like I have no idea what the hardware

508
00:39:25,110 --> 00:39:29,180
did but I'm loving every single pen
every country every offensive output and

509
00:39:29,180 --> 00:39:30,540
I'm just flipping it

510
00:39:30,540 --> 00:39:36,490
herds and that's exactly what you see
here so this is my printer depends if I

511
00:39:36,490 --> 00:39:39,319
can do it on this printer without
knowing what hardware does I can do it

512
00:39:39,320 --> 00:39:43,760
on another thing that has GPIO that I
can turn on us right now and I'm not

513
00:39:43,760 --> 00:39:49,540
expect the exact same rflp or harmonic
decision but I do expect to see a signal

514
00:39:49,540 --> 00:39:52,970
emanating off of that device using
exactly the same code so that's what

515
00:39:52,970 --> 00:39:58,149
we're trying to do generalize these
mechanisms we can run on every device so

516
00:39:58,150 --> 00:40:01,880
the National really do wanna do
frequency shift keying so this is an

517
00:40:01,880 --> 00:40:05,810
implementation that I wrote for the
panel printer all the GPIO pins looking

518
00:40:05,810 --> 00:40:14,700
at the same time and let's see what that
looks like USA UK as you have one

519
00:40:14,700 --> 00:40:20,560
frequency another we're going back and
forth right and the separation between

520
00:40:20,560 --> 00:40:24,529
these two frequencies at the harmonics
also not all of regular so we have one

521
00:40:24,530 --> 00:40:27,830
here where they're very close together
and then we have one here where they're

522
00:40:27,830 --> 00:40:32,290
very far apart right and we have all
sorts of different separation between

523
00:40:32,290 --> 00:40:37,250
the two but that's just two signals
right transmitting in this device so

524
00:40:37,250 --> 00:40:42,099
that's why I K looks like

525
00:40:42,099 --> 00:40:46,329
now so that works you know but we
weren't able to get the range that we

526
00:40:46,329 --> 00:40:49,960
really want to because there was not a
lot of radiator look at the old not a

527
00:40:49,960 --> 00:40:54,529
lot of wire that we were able to take
advantage of so you know I think we we

528
00:40:54,529 --> 00:41:00,890
we haven't really done a full-on range
has the word how about 23 meter right

529
00:41:00,890 --> 00:41:04,900
you can get this information now inside
the room but this is probably not at

530
00:41:04,900 --> 00:41:09,410
least on this specific device gonna get
you out of secret for right or even your

531
00:41:09,410 --> 00:41:14,058
typical office space but the last thing
I want to show is that you are ok so

532
00:41:14,059 --> 00:41:16,869
that there is a you are on this printer
there is a you are on your motherboard

533
00:41:16,869 --> 00:41:20,930
on your server they are you are
everywhere and routers and all sorts of

534
00:41:20,930 --> 00:41:24,960
things and if you don't plug the cable
into the yard you like our data show

535
00:41:24,960 --> 00:41:28,470
that you're not gonna have any at all
races that's not very useful bit people

536
00:41:28,470 --> 00:41:32,249
put cereal boards on things for
management so let's pretend we actually

537
00:41:32,249 --> 00:41:37,450
connected to console cable to this you
are let's see what I can do right so if

538
00:41:37,450 --> 00:41:41,989
you flip actually the easy-to-use you
can do is just send the capital letters

539
00:41:41,989 --> 00:41:47,759
you right to the you are printed out and
that's going to translate 2010 1:01

540
00:41:47,759 --> 00:41:51,920
exactly so i'm happier Manchester
encoding is gonna make that a perfect

541
00:41:51,920 --> 00:41:56,299
square waves and you put it on the IOSCO
this is what you see right you have

542
00:41:56,299 --> 00:42:01,940
basically a square wave that works at
about twenty or thirty killer it's it's

543
00:42:01,940 --> 00:42:05,609
not as hot as I like it but this is a
very simple thing you can do at home

544
00:42:05,609 --> 00:42:06,619
right now right

545
00:42:06,619 --> 00:42:11,200
Gillard's you should be able to fix that
signal up with you know any modern as a

546
00:42:11,200 --> 00:42:16,169
result were defined radio with an
antenna like this but let's be a little

547
00:42:16,170 --> 00:42:21,539
bit more sneaky it's probably pretty
easy to use

548
00:42:21,539 --> 00:42:26,160
going through your your kernel down to
the serial port so let's see if we can

549
00:42:26,160 --> 00:42:30,089
do a little better than that ok so
looking at the debug messages on the

550
00:42:30,089 --> 00:42:31,430
printer

551
00:42:31,430 --> 00:42:37,540
we see it that the UART is actually a
DWI APB you are that seat so I know the

552
00:42:37,540 --> 00:42:40,779
source code and the version I also know
the person who wrote this thing that

553
00:42:40,780 --> 00:42:44,720
we're not talking about that is npr's
like three thousand times in the

554
00:42:44,720 --> 00:42:50,828
firmware so very simple Google search
term you eventually come up with the

555
00:42:50,829 --> 00:42:55,950
actual data manual right for this you
are it's not a piece of hardware right

556
00:42:55,950 --> 00:43:00,930
this is a simple sizable IP block you
know people license from design where

557
00:43:00,930 --> 00:43:04,808
that you can be taken into your own
embedded implementation is you know

558
00:43:04,809 --> 00:43:11,890
complying with two and it's complying
with your center console is a 6550 to

559
00:43:11,890 --> 00:43:18,480
respect ok and this is what the yard
looks like in the game here right we

560
00:43:18,480 --> 00:43:22,930
just want to flip the SL open that's the
TX button on the console you know as

561
00:43:22,930 --> 00:43:27,899
fast as we want as houses we like and we
were able to control the rate and the

562
00:43:27,900 --> 00:43:32,720
direction in which we flip this one
that's all we want to do so in a reading

563
00:43:32,720 --> 00:43:36,808
the manual this is what we do my sneaky
way of doing this first that you put

564
00:43:36,809 --> 00:43:42,339
that you are in to control its control
break mode right you basically said a

565
00:43:42,339 --> 00:43:46,279
specific bit in the line control
register that tells the you are to stay

566
00:43:46,280 --> 00:43:49,270
high until you encounter a break

567
00:43:49,270 --> 00:43:55,119
signal and then you go oh ok step two is
we put the you are into loopback mode

568
00:43:55,119 --> 00:44:02,609
that's another bit flip inside another
control register right which keeps the

569
00:44:02,609 --> 00:44:07,150
no I got it backwards break means stay
low until you hit a two-year break so

570
00:44:07,150 --> 00:44:11,299
you know coming from the receiver and
loopback means keep the texts and high

571
00:44:11,299 --> 00:44:17,440
okay and then we're just gonna send this
back 20 again and then 10 yeah and what

572
00:44:17,440 --> 00:44:20,920
happens here right this is all of the
Thunder coach where you are right here

573
00:44:20,920 --> 00:44:25,069
you load up the control register for the
UART and this actually work not just

574
00:44:25,069 --> 00:44:29,640
specifically for this one you are I
think this will work for all of the 6550

575
00:44:29,640 --> 00:44:35,670
to you know you are compliant yours out
there which is i think a lot of it

576
00:44:35,670 --> 00:44:41,220
basically you set up your edges are
exactly right one instruction rights who

577
00:44:41,220 --> 00:44:47,040
turned the yard into the backbone which
sets the text me high and another

578
00:44:47,040 --> 00:44:51,829
instruction right to set up a closed
down to get it how to vote so you're

579
00:44:51,829 --> 00:44:54,940
just doing this over and over again
takes about seven instructions that's

580
00:44:54,940 --> 00:45:00,000
all you need and it's very efficient
right you can do super fast and you can

581
00:45:00,000 --> 00:45:04,720
flip those pens that you spend about
$500 hurts without even overclocked in

582
00:45:04,720 --> 00:45:08,740
the yard which is also possible right so
you can double this quadruple if you

583
00:45:08,740 --> 00:45:13,149
just change the the reference your clock
which was also pretty easy to do

584
00:45:13,150 --> 00:45:19,839
ok so let's look at a demo right and
this is where we show a you are

585
00:45:19,839 --> 00:45:27,660
operating with a ten-foot roughly ten
foot about us- console cable or ten foot

586
00:45:27,660 --> 00:45:33,700
of console cable connected to the you
are ok so first you live demo and we

587
00:45:33,700 --> 00:45:37,240
need to the modulation of the signal but
I'm on stage there's a whole bunch of

588
00:45:37,240 --> 00:45:40,700
wireless though so I'm probably gonna
call back to the video of the

589
00:45:40,700 --> 00:45:47,240
demodulation but I am actually get at
least gonna show you what the output of

590
00:45:47,240 --> 00:45:53,520
the sky looks like alright so here we
have a little script that takes the

591
00:45:53,520 --> 00:45:58,069
assembly and then assembles located in
to the right property virtual memory

592
00:45:58,069 --> 00:46:02,308
address numbers it into these super
silly you know just write commands for

593
00:46:02,309 --> 00:46:06,500
open OCD great put in the open Oct eight
and then booted with the printer so what

594
00:46:06,500 --> 00:46:11,390
I'm doing is basically hijacking the
process running my payload right so just

595
00:46:11,390 --> 00:46:12,029
a test

596
00:46:12,030 --> 00:46:20,280
antenna payload and let's do that

597
00:46:20,280 --> 00:46:27,970
right so I'm resetting or reject hanging
open Oct wiping an area known about 20

598
00:46:27,970 --> 00:46:34,000
where the boot below code is gonna the
boot sequence is gonna call and then I'm

599
00:46:34,000 --> 00:46:42,800
going to upload my I guess forty little
instruction for UART code right and when

600
00:46:42,800 --> 00:46:47,730
we're done with that will resume the
printer and the printer will start its

601
00:46:47,730 --> 00:46:52,340
boot sequence jump to the front under
Code Red executor payload and we should

602
00:46:52,340 --> 00:47:00,290
see what we can see on on January so for
the day that we reported on our website

603
00:47:00,290 --> 00:47:04,800
we use the net as to what the basic
cards board which is what I recommend

604
00:47:04,800 --> 00:47:09,390
you guys use but for the purpose of the
demo on stage I'm using an ass beat you

605
00:47:09,390 --> 00:47:14,690
10 which can go anywhere between forty
makers up to think something like 60

606
00:47:14,690 --> 00:47:19,650
gigahertz what we're really interested
in the lower frequency range but I'm

607
00:47:19,650 --> 00:47:23,490
gonna show you what what this looks like
you had a higher frequency range so

608
00:47:23,490 --> 00:47:28,549
imagine before you see this what do you
think you should see honest go right I'm

609
00:47:28,550 --> 00:47:32,460
slipping this thing about 500 megahertz
is going on a single wire right

610
00:47:32,460 --> 00:47:36,220
think about what you want to see are you
would you would you expect to see on

611
00:47:36,220 --> 00:47:46,950
this guy and then we're going to see how
we actually see so I presume that

612
00:47:46,950 --> 00:47:53,870
instead of you know one strong signal
and a few Harmonix is we're getting this

613
00:47:53,870 --> 00:47:57,400
is a forty megahertz right i mean this
is all over the place and it's extremely

614
00:47:57,400 --> 00:48:03,780
strong right and I'm using the same
antenna and TV antenna that I saw her to

615
00:48:03,780 --> 00:48:09,140
receive the signal and let's see if we
can get the signal F 41 it's their

616
00:48:09,140 --> 00:48:13,980
decision is slightly different you can
see this banding here now

617
00:48:13,980 --> 00:48:18,810
you know let's go ten megahertz not
there right

618
00:48:18,810 --> 00:48:24,930
61 little bit weaker so let's go to our
sweet spot rate can we do this you know

619
00:48:24,930 --> 00:48:33,618
at Bunker penetrating frequency range
yeah right exactly where we want to be

620
00:48:33,619 --> 00:48:38,180
so too she's still in force country
right this is a way to get out exactly

621
00:48:38,180 --> 00:48:43,640
at the sweet spot and I'm only putting
the pen right ankle hurts

622
00:48:43,640 --> 00:48:50,279
well what you see here is a nation all
over the place in this case hundreds 31

623
00:48:50,280 --> 00:48:55,359
hurts and this goes even higher than
that right we have some theories of why

624
00:48:55,359 --> 00:49:00,680
that is and why this is so spread out on
the street but I definitely didn't

625
00:49:00,680 --> 00:49:01,960
expect to see this

626
00:49:01,960 --> 00:49:07,230
ok so that's where the transmission part
looks like any of you watch very closely

627
00:49:07,230 --> 00:49:13,730
right this is just going on and off King
so long duration means a 10 and now

628
00:49:13,730 --> 00:49:18,460
we're going to attempt to send an actual
message out of this thing so I'm gonna

629
00:49:18,460 --> 00:49:23,180
show you video right because I mean this
is pretty good but it is directional so

630
00:49:23,180 --> 00:49:26,109
it is a little bit does take a little
bit of treating before you can get the

631
00:49:26,109 --> 00:49:33,779
demodulation correct so let's look at
this video that we made yesterday rate

632
00:49:33,780 --> 00:49:43,460
so the setup here is what you saw in the
first light right we put it on a very

633
00:49:43,460 --> 00:49:44,470
large desk

634
00:49:44,470 --> 00:49:48,740
you know the transmission is about I
don't know 10 feet away or the

635
00:49:48,740 --> 00:49:55,450
transmitters away from the antennae and
this is the modulating piece of text in

636
00:49:55,450 --> 00:49:57,339
real time

637
00:49:57,340 --> 00:50:04,800
ok so we're resuming the payload right
it's starting to run and all of a sudden

638
00:50:04,800 --> 00:50:11,430
you see here right this is a nation
signal we put a preamble ok so we can

639
00:50:11,430 --> 00:50:12,600
resync

640
00:50:12,600 --> 00:50:16,450
I think after every 15 characters just
in case there is noise distortion

641
00:50:16,450 --> 00:50:20,160
etcetera right but this is a bit rate at
which

642
00:50:20,160 --> 00:50:25,710
and get the state out and I think we can
go more than 10 sheet and we can go much

643
00:50:25,710 --> 00:50:26,740
faster

644
00:50:26,740 --> 00:50:29,450
the reason why we kept it at this rate
is because I wanted you would actually

645
00:50:29,450 --> 00:50:34,118
see it into a lovely feel you know
what's going on here and also experiment

646
00:50:34,119 --> 00:50:38,170
with how much further we can push this
mechanism so that's why we put all of

647
00:50:38,170 --> 00:50:41,520
the code or we're going to put all of
this code on line with instructions on

648
00:50:41,520 --> 00:50:44,900
how to do exactly this reproduces
experiment on the banner printer at

649
00:50:44,900 --> 00:50:50,130
Super G you know I hope you guys buy
this thing run this code right and and

650
00:50:50,130 --> 00:50:58,119
start experimenting with this technique
anybody gets the last word you know

651
00:50:58,119 --> 00:51:05,590
where this is from the start out

652
00:51:05,590 --> 00:51:13,730
answer to the color digital channel 30
so that's that's out of the you are

653
00:51:13,730 --> 00:51:20,090
coming out of this this device and
that's pretty much my Todd oh we're

654
00:51:20,090 --> 00:51:24,190
gonna demonstrate this and no soul a lot
of our embedded defensive techniques

655
00:51:24,190 --> 00:51:30,430
that we've built for its routers at
DEFCON on saturday right so I definitely

656
00:51:30,430 --> 00:51:33,160
encourage you guys to come and play with
yourself we're going to have the

657
00:51:33,160 --> 00:51:37,230
hardware there for people to actually
play within oh so and you know her

658
00:51:37,230 --> 00:51:41,860
simple code 404 Cisco routers

659
00:51:41,860 --> 00:51:49,470
I i receive specific instructions to put
this light and you know we have to learn

660
00:51:49,470 --> 00:51:52,919
something from that from this experience
so what do we learn we learned that

661
00:51:52,920 --> 00:51:57,730
antenna works we learned that you can do
this type of situation without you know

662
00:51:57,730 --> 00:52:02,640
a radar gun and without internet without
physical implantation it's a good idea I

663
00:52:02,640 --> 00:52:07,870
think and will I didn't show you one
last thing by the way so which brings me

664
00:52:07,870 --> 00:52:11,259
to pointer to network intrusion
detection systems right you know that

665
00:52:11,260 --> 00:52:15,380
the billions of dollars of technology
that we have to prevent data association

666
00:52:15,380 --> 00:52:21,640
on known transmission memes it doesn't
work in this case it is not a substitute

667
00:52:21,640 --> 00:52:26,640
for a better defense I'm going to beat
every network intrusion out there was an

668
00:52:26,640 --> 00:52:31,150
AM radio ok so this is where we do our
internet and radio and we're going to

669
00:52:31,150 --> 00:52:45,310
describe the ban

670
00:52:45,310 --> 00:53:04,220
you want

671
00:53:04,220 --> 00:53:14,540
different regions all of which we looked
up into mines and using $2,000

672
00:53:14,540 --> 00:53:19,820
harder budget you need another another
site how do we protect this type of

673
00:53:19,820 --> 00:53:23,740
exploitation trade you can monitor every
known for every possible transmission

674
00:53:23,740 --> 00:53:28,899
medium for data right Mr the entire
spectrum if you wanted to be very

675
00:53:28,900 --> 00:53:32,369
expensive it probably may not work for
it because we also get to choose our

676
00:53:32,369 --> 00:53:37,130
encoding scheme and such or the better
way to do it is host base defense played

677
00:53:37,130 --> 00:53:40,320
right into embedded devices not just
specific for this guy before every

678
00:53:40,320 --> 00:53:45,430
embedded device out there because it is
you can really see what's going on

679
00:53:45,430 --> 00:53:49,160
outside but if you actually have
visibility on to the south of this guy

680
00:53:49,160 --> 00:53:53,730
is making her do all sorts of really
where things are as deadly not supposed

681
00:53:53,730 --> 00:54:00,730
to be dead simple if we had something
like single technology to detect this

682
00:54:00,730 --> 00:54:04,510
type of exploitation and all embedded
devices across the board to take this

683
00:54:04,510 --> 00:54:07,849
type of attack off the table so we
wouldn't have to worry about it we will

684
00:54:07,849 --> 00:54:13,790
have to use this ok and thanks to all
those who helped me make this happen

685
00:54:13,790 --> 00:54:20,240
Chris evidence on a horse Joey Vento in
the jungle right and I couldn't find

686
00:54:20,240 --> 00:54:26,149
billy's photo but you know billy was the
intern that cut open three dozen of

687
00:54:26,150 --> 00:54:30,820
these printers for ended Saturday typing
on it so that was very important and

688
00:54:30,820 --> 00:54:34,700
also right after the stocks you know
we're putting all all of the code for

689
00:54:34,700 --> 00:54:38,660
all of the demos have shown unfunded
oregon's gonna be on github I really

690
00:54:38,660 --> 00:54:42,190
encourage you guys to check out this
code play with the printer and and see

691
00:54:42,190 --> 00:54:46,580
if we can push this technique even
further and get your transmission faster

692
00:54:46,580 --> 00:54:48,880
data rate and things like that so that's
it

