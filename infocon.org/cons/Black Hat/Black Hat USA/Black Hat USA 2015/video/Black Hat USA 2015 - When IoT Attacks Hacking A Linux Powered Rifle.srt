1
00:00:00,000 --> 00:00:05,509
you were in lagoon K and you are here
whether you're in order not to hear the

2
00:00:05,509 --> 00:00:11,870
talk entitled when I ot attacks packing
a Linux powered rifle byron eccentric

3
00:00:11,870 --> 00:00:18,279
and Mike Walker and please turn your
phones on vibrate because there's no

4
00:00:18,279 --> 00:00:30,100
such thing as a nice ring to it

5
00:00:30,100 --> 00:00:40,020
my name is Michael auger and our
presentation is essentially the summary

6
00:00:40,020 --> 00:00:46,850
of a year's worth of research on a Linux
powered rifle the goal with the target

7
00:00:46,850 --> 00:00:50,800
is to focus a bit more about how we
actually did the research as opposed to

8
00:00:50,800 --> 00:00:51,980
what we found

9
00:00:51,980 --> 00:00:57,650
will be able to have a couple of demos
and a couple of interesting piece of

10
00:00:57,650 --> 00:01:03,190
information that the media has been
covered yet so breaking point has been

11
00:01:03,190 --> 00:01:07,908
widely covered in the media over the
past two years or so it's a Linux

12
00:01:07,909 --> 00:01:13,600
powered rifle it has wifi it can connect
your mobile phone or tablet it has used

13
00:01:13,600 --> 00:01:17,259
people words to software updates it's
it's it's a pretty interesting piece of

14
00:01:17,260 --> 00:01:25,670
firearm + technology we often get asked
why we decided to hack my rightful or

15
00:01:25,670 --> 00:01:31,670
firearm and I told CNN last week that
it's because cars are boring but then

16
00:01:31,670 --> 00:01:37,840
they chose not to not to include that in
the in the actual clip but really the

17
00:01:37,840 --> 00:01:41,380
reason was that it's it was just a
really fascinating piece of technology

18
00:01:41,380 --> 00:01:47,609
and we just wanted to take it apart hack
it and see what we can do with it

19
00:01:47,609 --> 00:01:56,199
keep track of 2750 the base rifle
Remington 700 308 alt action the

20
00:01:56,200 --> 00:01:59,420
hardware platform which is the scope
that tracking point actually built is

21
00:01:59,420 --> 00:02:02,619
called cascade they've got a smaller
platform for the shorter and rifles

22
00:02:02,619 --> 00:02:06,460
which I call Aires lot of the things we
found here we're fairly certain work on

23
00:02:06,460 --> 00:02:10,899
areas but we haven't got our hands on
one to actually test that just a Linux

24
00:02:10,899 --> 00:02:17,430
machine runs from Lenox very similar to
what you find on a big black nigger

25
00:02:17,430 --> 00:02:25,760
AM-six anime card processor 37 there's a
69 / that holds for Linux kernels on the

26
00:02:25,760 --> 00:02:32,090
file systems on a separate non flash for
getting the way the systems intended to

27
00:02:32,090 --> 00:02:38,450
work in their advanced mode you've got
what they called tag track exact I said

28
00:02:38,450 --> 00:02:40,130
tag you're looking through the scope

29
00:02:40,130 --> 00:02:43,390
you line up to the target do you want to
hit and you had a red button front of

30
00:02:43,390 --> 00:02:48,089
the trigger an attack the target the
second frame here is the crosshairs

31
00:02:48,090 --> 00:02:52,450
moving center once you take the target
the laser rangefinder on the scope it

32
00:02:52,450 --> 00:02:56,260
hits the target calculates the distance
the gun to the rifle then calculates the

33
00:02:56,260 --> 00:03:00,269
ballistics required to actually hit the
target they're taking into account

34
00:03:00,270 --> 00:03:06,620
variables like temperature distance all
these different things so then he pulled

35
00:03:06,620 --> 00:03:10,350
the trigger the crosshairs turn red you
that line back up to that target to that

36
00:03:10,350 --> 00:03:13,980
tag on the target and when you're lined
up the raffle fires so there's an

37
00:03:13,980 --> 00:03:18,010
interaction between the scope and
there's a link that goes to the trigger

38
00:03:18,010 --> 00:03:22,540
mechanism to hold the firing pin from
firing once you pull the trigger all

39
00:03:22,540 --> 00:03:25,590
this can also be recorded two videos he
can pull us down there later as well

40
00:03:25,590 --> 00:03:33,920
three things to keep in mind during this
presentation at about the research is

41
00:03:33,920 --> 00:03:39,670
the attack said we have required the
wireless network to be on so by default

42
00:03:39,670 --> 00:03:43,489
the wifi is when you take the rifle out
of the box but you can choose to

43
00:03:43,490 --> 00:03:55,590
actually use the WiFi p 12 and addition
the rightful cannot fire remotely so

44
00:03:55,590 --> 00:04:00,070
there's a lot of things that we can do I
can prevent the trigger from from

45
00:04:00,070 --> 00:04:04,420
working we can actually locked the owner
out of the rifle but we cannot fire

46
00:04:04,420 --> 00:04:10,290
remotely and lastly the teepee 750 is a
firearm even without the scope so it

47
00:04:10,290 --> 00:04:15,390
just means that if the school break if
it doesn't boot it still a firearm you

48
00:04:15,390 --> 00:04:20,769
can still fire you can still shoot you
just gonna have a really hard time and i

49
00:04:20,769 --> 00:04:27,530
never so when putting together this
presentation we wanted to focus on how

50
00:04:27,530 --> 00:04:32,059
we how we did the research how we
actually got the rifle and and where we

51
00:04:32,060 --> 00:04:36,340
started taking it apart and sort of
trying to figure out a way in so we

52
00:04:36,340 --> 00:04:43,950
divided up into sort of ran one ran 203
and so for round one mister start out

53
00:04:43,950 --> 00:04:47,820
with just what the school looks like
when he just take it out when you have

54
00:04:47,820 --> 00:04:51,599
in front of you and has a couple of
buttons for the wind

55
00:04:51,600 --> 00:04:57,250
focus it has a sensor for temperature
and has a microphone is it does it films

56
00:04:57,250 --> 00:05:01,710
when you're doing the shot and killed a
record deal and it has a couple of USB

57
00:05:01,710 --> 00:05:07,650
ports as well on the front of it so the
first thing that we did with their dad

58
00:05:07,650 --> 00:05:12,140
we be running ports can you do when you
have a rifle that's that has a wireless

59
00:05:12,140 --> 00:05:20,479
network we found that it runs a web
server and a GStreamer service and that

60
00:05:20,480 --> 00:05:23,900
was it wasn't really a lot more to look
at

61
00:05:23,900 --> 00:05:29,650
we tried a couple of other things like
giving ourselves a different IP address

62
00:05:29,650 --> 00:05:34,250
to see if anything else would pop up we
didn't really have any luck so at this

63
00:05:34,250 --> 00:05:40,740
point has received pretty pretty locked
down so in addition to their rightful

64
00:05:40,740 --> 00:05:45,910
tracking point created mobile apps to
interact with the rifles so there's an

65
00:05:45,910 --> 00:05:53,210
app this shot beer it looks like this
which allows you to see exactly what the

66
00:05:53,210 --> 00:05:58,570
shooter is seeing inside the school just
streams exactly the same team beat the

67
00:05:58,570 --> 00:06:04,710
shit that makes AB and sort of the
slightly more interesting one is called

68
00:06:04,710 --> 00:06:10,340
tracking point that's the app that
allows you to change things like when

69
00:06:10,340 --> 00:06:17,219
temperature you can select the type of
animal that your rifle is using you can

70
00:06:17,220 --> 00:06:21,940
download media off of the scope and you
can also do suffer updates from this

71
00:06:21,940 --> 00:06:26,230
mobile app

72
00:06:26,230 --> 00:06:33,220
so when we started digging through the
mobile ads looking at the communications

73
00:06:33,220 --> 00:06:37,000
between the absence of school but what
the school bus doing and what it was

74
00:06:37,000 --> 00:06:44,160
doing when he was doing the wireless
network has a key is a WPA two key

75
00:06:44,160 --> 00:06:49,300
decibel but it's there you need to know
that kid who actually connect to the

76
00:06:49,300 --> 00:06:53,590
wireless network in the first place we
found that the communications between

77
00:06:53,590 --> 00:07:02,590
the AB and the Absynthe school its HTTP
only but well as wk Chu and it's pretty

78
00:07:02,590 --> 00:07:07,409
locked down either way so there wasn't
wasn't a big deal we found that he uses

79
00:07:07,410 --> 00:07:12,170
it should appear only in when it's
pulling a software updates from cracking

80
00:07:12,170 --> 00:07:16,590
points websites from tracking point dot
com and an end to the scope it's using

81
00:07:16,590 --> 00:07:22,369
HTTP only discovered that all the
software updates are jpg decrypted and

82
00:07:22,370 --> 00:07:27,560
something with a passphrase and so
already at this point we didn't have a

83
00:07:27,560 --> 00:07:35,040
whole lot of exciting things but he
compiled the mobile ads we got this

84
00:07:35,040 --> 00:07:38,900
really the public API the options that
are available to you when you

85
00:07:38,900 --> 00:07:48,060
communicating with the scope a couple of
interesting bits and pieces here comes

86
00:07:48,060 --> 00:07:54,660
up the win you can set the temperature
you can set factory defaults and check

87
00:07:54,660 --> 00:07:59,810
the version you can update the scope but
again that's that's really what you're

88
00:07:59,810 --> 00:08:08,520
supposed to be able to do from within
the mobile app anyways we didn't have

89
00:08:08,520 --> 00:08:14,010
all that much exciting this year we're
hoping that it was it would be easier we

90
00:08:14,010 --> 00:08:17,560
sort of got into this project with the
idea that this is going to be a really

91
00:08:17,560 --> 00:08:21,230
fun experience it was going to be a
challenge we're going to learn something

92
00:08:21,230 --> 00:08:26,490
that was going to be super heard already
at this point for round one with them

93
00:08:26,490 --> 00:08:30,690
that yes you can do stuff with the
mobile app and anyone who can connect to

94
00:08:30,690 --> 00:08:36,539
the wifi can do stuff but that was about
it so we did what we usually do when you

95
00:08:36,539 --> 00:08:37,529
sort of get stuck

96
00:08:37,529 --> 00:08:42,599
you try a lot of different things like I
said we tried port scans we tried to

97
00:08:42,599 --> 00:08:46,519
push different but these sequences on
top of the school to see if like an

98
00:08:46,519 --> 00:08:51,699
admin mode popped up we didn't really
find anything they're quite literally

99
00:08:51,699 --> 00:08:52,859
tried the Konami

100
00:08:52,860 --> 00:09:04,980
did nothing after this round 10 findings
that we were left with was that the SSID

101
00:09:04,980 --> 00:09:09,459
of the wifi contains the serial number
of the firearm and you cannot change

102
00:09:09,459 --> 00:09:17,050
this pops up as teepee 750 underscore
the serial number and you cannot change

103
00:09:17,050 --> 00:09:26,109
the US the WPA two key is easy to guess
and you cannot change it either

104
00:09:26,110 --> 00:09:31,980
RTSP claim can actually stream disculpe
you just downloaded shot new app that

105
00:09:31,980 --> 00:09:41,110
allows you to see exactly what should we
found that epi is indicated so anyone

106
00:09:41,110 --> 00:09:46,470
who can connect to the wifi can actually
change when their temperature do any of

107
00:09:46,470 --> 00:09:52,019
the other things that you can do within
the app but it doesn't validate input CD

108
00:09:52,019 --> 00:09:57,040
go if you pull ups and you go to change
the temperature for example you're going

109
00:09:57,040 --> 00:10:01,490
to get a drop in the just has a very
very short list of values that you're

110
00:10:01,490 --> 00:10:05,639
allowed to put in a few trying to
actually send about you thats not in the

111
00:10:05,639 --> 00:10:13,180
list and outside of this range the app
is not going to accept it we found that

112
00:10:13,180 --> 00:10:18,079
there's no michael mentioned to do the
tag exact you need to be in what's

113
00:10:18,079 --> 00:10:23,579
called advanced mode now from within the
mobile app you can save a four digit PIN

114
00:10:23,579 --> 00:10:29,279
to walk advanced mode so anyone who gets
the rifle me to actually pull up either

115
00:10:29,279 --> 00:10:34,230
pull up the Apple than on the school or
on the gun itself and during this four

116
00:10:34,230 --> 00:10:39,470
digit tend to unlock its but it's what
did it it's pretty easy to brute force

117
00:10:39,470 --> 00:10:44,649
or you can just use the API call of such
factory default which will just reset

118
00:10:44,649 --> 00:10:45,980
the whole thing and there's no penalty

119
00:10:45,980 --> 00:10:52,020
noting that the pin is set to get to set
back your default when you load the app

120
00:10:52,020 --> 00:10:55,579
and there's a pin it possible the phones
I can enter your PIN to get anything

121
00:10:55,580 --> 00:11:02,310
with this app but because the kitchen
unicef factory defaults ok cool takes it

122
00:11:02,310 --> 00:11:07,469
just reset everything and other stuff
and then the last book last item there

123
00:11:07,470 --> 00:11:10,810
was something that you know we saw that
oh he's pulling its software updates

124
00:11:10,810 --> 00:11:14,839
over HTTP this is really exciting there
has to be something here but there are

125
00:11:14,840 --> 00:11:21,270
encrypted and sign with GPG with a press
release that we don't have so this point

126
00:11:21,270 --> 00:11:25,569
we decided to move on to Round at this
point

127
00:11:25,570 --> 00:11:30,350
been treating a black box Reds what can
we do that we spoke to some basic recon

128
00:11:30,350 --> 00:11:35,970
didn't really find much clearly now it's
time to get physical with its are trying

129
00:11:35,970 --> 00:11:39,620
things apart so started doing some recon
attracting points website see like what

130
00:11:39,620 --> 00:11:43,350
resources do I find but what can I find
out about this thing and what it looks

131
00:11:43,350 --> 00:11:46,380
like inside before I actually heard of
it

132
00:11:46,380 --> 00:11:51,350
subcontracted website they have this
lovely picture looks very similar to a

133
00:11:51,350 --> 00:11:56,100
diagram it's got screwed all these other
things looks like someone right thing

134
00:11:56,100 --> 00:12:00,510
for their final white paper kind of the
same thing on the flip side you can see

135
00:12:00,510 --> 00:12:05,990
the trigger mechanism you can see the
button underneath the scope there is

136
00:12:05,990 --> 00:12:11,410
what you said tagged with Jared open
looks exactly like that go figure they

137
00:12:11,410 --> 00:12:13,829
actually use the cat their guns in the
marketing stuff that is convenient

138
00:12:13,830 --> 00:12:19,160
figure out a little bit more when
they're YouTube videos they have the

139
00:12:19,160 --> 00:12:25,199
circuit boards some of the circuit board
anyway during that process laid out why

140
00:12:25,200 --> 00:12:27,590
this was a pain in the ass

141
00:12:27,590 --> 00:12:33,210
flat right here but in reality inside
the scope it's a three-dimensional

142
00:12:33,210 --> 00:12:37,260
layout so it's all this region flexi
design there's 9th circuit boards in

143
00:12:37,260 --> 00:12:40,480
this things so when you decide that
you're going to probe something it's no

144
00:12:40,480 --> 00:12:43,440
longer just a I'm gonna spend five
minutes and hook up to the same probe it

145
00:12:43,440 --> 00:12:47,360
it's I have to tear a hole bunch of
stuff off to get to what I even need to

146
00:12:47,360 --> 00:12:52,720
probe here's a close-up of that over on
the right side you can see there's some

147
00:12:52,720 --> 00:12:56,350
pins underneath that focus nom there's
like twenty something pins there there's

148
00:12:56,350 --> 00:12:57,980
another few pins right under

149
00:12:57,980 --> 00:13:03,090
under the kind of looking cable thing
there there's 40 pins on the right side

150
00:13:03,090 --> 00:13:08,820
so literally to get to the inside you
have to be sauter 60 pins minimum so

151
00:13:08,820 --> 00:13:11,180
it's no small task

152
00:13:11,180 --> 00:13:17,939
here's a close-up so what's taking into
this they were kind enough to document

153
00:13:17,940 --> 00:13:24,020
everything well with myself screening
policy Open finalist ESRX ok sounds

154
00:13:24,020 --> 00:13:28,860
familiar maybe that's you aren't we took
a bus fire had up to that turned on this

155
00:13:28,860 --> 00:13:33,660
go and there we go we had a blue screen
so this is extraordinarily exciting

156
00:13:33,660 --> 00:13:38,829
we're watching a few just right and i
got to this year the class after people

157
00:13:38,830 --> 00:13:43,050
can advise you that straight to a login
prompt we've all seen the projects where

158
00:13:43,050 --> 00:13:46,599
you look up to you aren't dumb straight
to hell that's kind of what we were

159
00:13:46,600 --> 00:13:48,320
hoping for

160
00:13:48,320 --> 00:13:52,750
not the case so we of course tried all
of the you know the password is the

161
00:13:52,750 --> 00:13:56,260
password password is it that many of the
top 10 all these things none of those

162
00:13:56,260 --> 00:14:00,700
tried stuff off the website right things
about her head against the wall this is

163
00:14:00,700 --> 00:14:06,180
going nowhere

164
00:14:06,180 --> 00:14:12,780
brand new findings console is password
protected the Colonels we discovered but

165
00:14:12,780 --> 00:14:17,000
we're doing this are on a separate file
system so it's part of the process had

166
00:14:17,000 --> 00:14:19,900
access to everything running u-boot

167
00:14:19,900 --> 00:14:23,740
headachey interrupted due process we've
got you but your commands there's a

168
00:14:23,740 --> 00:14:26,050
memory dump command inside of you

169
00:14:26,050 --> 00:14:29,670
cool some other systems you can actually
use that commands to dump the positive

170
00:14:29,670 --> 00:14:33,890
you get the whole thing out and it's not
quite a trek to mislead the script you

171
00:14:33,890 --> 00:14:37,100
dump small sections at a time so you
don't overflowing miss by its and all

172
00:14:37,100 --> 00:14:43,000
the other jazz talk about four and a
half hours to run things battery-powered

173
00:14:43,000 --> 00:14:48,980
so what is normally running these two
batteries one battery lasts about three

174
00:14:48,980 --> 00:14:51,900
hours and it takes over the second
battery that only works when the system

175
00:14:51,900 --> 00:14:56,920
running it can monitor the status quo
there's no status monitor so it's

176
00:14:56,920 --> 00:15:00,400
running it's raining it's raining it's
raining all the sudden it was off

177
00:15:00,400 --> 00:15:06,400
look at the file it's like 15.5 man that
was that was pretty disappointing but we

178
00:15:06,400 --> 00:15:10,250
did discover that in the 16 Meg don't
want we've got the whole thing running

179
00:15:10,250 --> 00:15:13,450
through been walk and strings on this
there's no possible just for Linux

180
00:15:13,450 --> 00:15:20,840
kernels so clearly this wasn't going to
work for us either around 30 poked at it

181
00:15:20,840 --> 00:15:25,520
without getting really destructive was
time to get destructive so this is what

182
00:15:25,520 --> 00:15:30,410
this looks like when you completely
turned out we went up met up with bob

183
00:15:30,410 --> 00:15:36,050
was kind enough to help us out with this
disorder depends forrest was tremendous

184
00:15:36,050 --> 00:15:40,469
amount of work part of when we went up
we've kind of lifted the circuits

185
00:15:40,470 --> 00:15:44,260
circuitry up and you can see some of the
chips on their and there is another chip

186
00:15:44,260 --> 00:15:47,980
on the bottom of this is another story
ship that must be the filesystem Ryan

187
00:15:47,980 --> 00:15:53,780
didn't really quite comprehend datasheet
and 500 12 megabits is not quite 512

188
00:15:53,780 --> 00:15:56,209
megabytes so we're very excited

189
00:15:56,210 --> 00:15:59,830
pull that shit but just dump it so if
you look at the top there there's a

190
00:15:59,830 --> 00:16:06,640
blank space text of the FPGA so we put a
chip off and 32 megabit and then

191
00:16:06,640 --> 00:16:10,569
probably realized way the ship is
sitting next to an FPGA which is to be

192
00:16:10,570 --> 00:16:14,830
programmed every time it boots on this
trip is doing is programming the FPGA so

193
00:16:14,830 --> 00:16:19,810
that was a very happy sad moment all at
once but for those that are any good

194
00:16:19,810 --> 00:16:23,800
with hardware can anybody find the file
system check on this diagram you can see

195
00:16:23,800 --> 00:16:26,709
it I'll give you a moment

196
00:16:26,710 --> 00:16:31,950
here's where it actually is hiding
underneath his big capacitor so we

197
00:16:31,950 --> 00:16:35,680
actually missed this multiple times i
holla part you're looking around looking

198
00:16:35,680 --> 00:16:39,189
for things are no more chips if you get
the right angle you can see this little

199
00:16:39,190 --> 00:16:43,040
chap you can see some of the silk
screening on that that shortcut there

200
00:16:43,040 --> 00:16:47,150
happened to be micron shortcut for the
BGA package and Mike Ross one of the few

201
00:16:47,150 --> 00:16:51,209
manufacturers that provides a conversion
tool so you throw in the short gonna

202
00:16:51,210 --> 00:16:54,340
give you the actual ship model number
you can look at the data sheets and

203
00:16:54,340 --> 00:17:00,700
there is a form a four gig non not so
there we go we found the file system but

204
00:17:00,700 --> 00:17:04,970
we didn't have any way to access it yet
I we tried quite a few things thinking

205
00:17:04,970 --> 00:17:08,540
maybe it's going through USB or other
things that was a string of other

206
00:17:08,540 --> 00:17:09,839
failures at this point

207
00:17:09,839 --> 00:17:16,708
so we ended up talking friends got some
really smart guys in CT Portland and

208
00:17:16,709 --> 00:17:20,689
we're like aid can you help us pull this
BGA chip off and dump it was at this

209
00:17:20,689 --> 00:17:24,370
point to say we just want the file
system we don't care when we're done

210
00:17:24,369 --> 00:17:29,620
get us the file system and they're like
we can do that but you know we don't

211
00:17:29,620 --> 00:17:33,739
care can you help her get absolutely so
packed everything up across the country

212
00:17:33,740 --> 00:17:37,450
to Portland and once we got there given
the they're really good with heartburn

213
00:17:37,450 --> 00:17:40,980
understood some of the stuff we didn't
look at the sole training and they

214
00:17:40,980 --> 00:17:49,820
recognized these labels so da 0 through
da 7 income and maps to UMMC so they're

215
00:17:49,820 --> 00:17:52,629
recognizes they made some phone calls
will there some other adventures trying

216
00:17:52,630 --> 00:17:56,010
to do it other various ways but they
made some phone calls I talked with

217
00:17:56,010 --> 00:18:00,450
their friends who happen to have this
device this is straight from alibaba

218
00:18:00,450 --> 00:18:07,100
hundred and eighteen dollars and EMC to
USB adapter works great that's it got

219
00:18:07,100 --> 00:18:11,709
the socket socket is probably worth
about $100 on its own but you can if you

220
00:18:11,710 --> 00:18:14,789
decided the chip you can drop it in the
socket plug into USB it's just an

221
00:18:14,789 --> 00:18:18,990
external USB Drive at that point but
also that row of pins between the sock

222
00:18:18,990 --> 00:18:23,450
and USB adapter so we just bridge those
plans to the pens on the circuit board

223
00:18:23,450 --> 00:18:28,000
with it all opened up plug it into a
computer and we had the filesystem it

224
00:18:28,000 --> 00:18:29,280
was a very good day

225
00:18:29,280 --> 00:18:36,590
first thing we did was we got the file
system after looking at the password

226
00:18:36,590 --> 00:18:42,100
file was looking at the root of the web
server and lo and behold there's a bunch

227
00:18:42,100 --> 00:18:46,570
of API calls the weed couldn't find
there's a few interesting things here

228
00:18:46,570 --> 00:18:51,270
and look at that last one SSH underscore
except that sounds kind of interesting

229
00:18:51,270 --> 00:18:55,470
so we've got to play with these and see
a little bit more about this thing

230
00:18:55,470 --> 00:19:06,120
actually works so we put together a
couple of demos and I figured I would

231
00:19:06,120 --> 00:19:11,090
just explain a bit about exactly why
they work or heavy work and then we'll

232
00:19:11,090 --> 00:19:15,740
show the demo after this first one if
you read the Wired article are seeing

233
00:19:15,740 --> 00:19:21,490
the video that was published online with
the article you you've seen some of this

234
00:19:21,490 --> 00:19:28,600
but what happened here was once we want
to be found the list of API calls we

235
00:19:28,600 --> 00:19:33,969
found it very specific all that just
opens another port in the firewall so

236
00:19:33,970 --> 00:19:38,590
again you're only requirement at this
point is that you need to be on the

237
00:19:38,590 --> 00:19:43,980
wireless and you need to know about this
API call that's it there's no other

238
00:19:43,980 --> 00:19:51,560
indication in the picture so using the
API call open support in the firewall

239
00:19:51,560 --> 00:19:57,960
you just connect to a standard socket
and while the mobile app will validate

240
00:19:57,960 --> 00:20:02,250
the input so I said you get they drop
down list for temperature for example

241
00:20:02,250 --> 00:20:09,140
and has just a set range that you can
select within the system back in the do

242
00:20:09,140 --> 00:20:15,500
connect to this way does not validate
any input at all so what we did with

243
00:20:15,500 --> 00:20:19,520
wired with a be connected directly to
the system back in and then we change

244
00:20:19,520 --> 00:20:25,300
the value for how much the blood race so
instead of the default value hundred and

245
00:20:25,300 --> 00:20:30,180
seventy-five we just changed it to
500,000 and the system happily accepted

246
00:20:30,180 --> 00:20:35,320
this new value by communicating directly
with the system back and we can make

247
00:20:35,320 --> 00:20:40,770
temporary changes so we have to be on
the wireless network as a shooter is

248
00:20:40,770 --> 00:20:41,860
sort of lining up to take

249
00:20:41,860 --> 00:20:47,290
shot or at least as she has the WiFi
network on which can only make temporary

250
00:20:47,290 --> 00:20:51,200
changes so if the owner of the rivalry
boots at that point

251
00:20:51,200 --> 00:20:56,780
changes will be lost change when and
temperature as you can it be up but we

252
00:20:56,780 --> 00:21:02,639
can set values that are outside of the
sort of predefined range that you have

253
00:21:02,640 --> 00:21:09,580
within the mobile app weekend said
different values that the scope will use

254
00:21:09,580 --> 00:21:14,570
for ballistics calculations so we can
you know the rightful to you just think

255
00:21:14,570 --> 00:21:19,720
that the bullet waste 500,000 instead of
a hundred and seventy-five we can lock

256
00:21:19,720 --> 00:21:28,580
to trigger so that you can never
actually fired the rifle in the back end

257
00:21:28,580 --> 00:21:32,240
so that through the API the AP every
limits how fast the command center this

258
00:21:32,240 --> 00:21:36,360
back and once your traffic that you just
throw stuff at it and it does not like

259
00:21:36,360 --> 00:21:43,479
it it will crash really quickly when you
do it I would also mean he can you can

260
00:21:43,480 --> 00:21:48,880
also make this cool believe that it is
attached to a different firearm you can

261
00:21:48,880 --> 00:21:52,130
you can make the school believe that
you're using a different type of animal

262
00:21:52,130 --> 00:21:57,240
that want you actually have this is the
back and has a lot of options that there

263
00:21:57,240 --> 00:22:01,650
there but they're not fully implemented
in so early in the future maybe we'll

264
00:22:01,650 --> 00:22:06,600
turn this on type of stuff it also has a
company and adjust its just fault like a

265
00:22:06,600 --> 00:22:11,379
single and you type in any way just
reboot the whole system and then your

266
00:22:11,380 --> 00:22:17,780
scope is back up and running so it was
it was this functionality that were then

267
00:22:17,780 --> 00:22:21,549
used for therefore the where demo that
we figured we would show you now which

268
00:22:21,549 --> 00:22:27,620
similar to one or two what you've
probably seen in wired but just shot

269
00:22:27,620 --> 00:22:35,360
from a different angle that so this is
what happens during normal operation so

270
00:22:35,360 --> 00:22:52,310
you line up for the shot the target

271
00:22:52,310 --> 00:22:55,800
shot

272
00:22:55,800 --> 00:22:59,610
set your tag pull the trigger

273
00:22:59,610 --> 00:23:04,899
once you land back up to that it fires
so it's Russell exactly where you time

274
00:23:04,900 --> 00:23:09,480
and grab the burly 46 yards because I
wanted to be closer for video but same

275
00:23:09,480 --> 00:23:13,340
functionality works on this scope out
about seven hundred yards works exactly

276
00:23:13,340 --> 00:23:19,899
the same and works really quite well so
once we connect to the back and we are

277
00:23:19,900 --> 00:23:26,640
just about you just the ball away from
175 to $500,000 little difference in

278
00:23:26,640 --> 00:23:30,570
their customers don't quite a bit so
you'll end up you're trying to hit that

279
00:23:30,570 --> 00:23:35,810
target it fires and there you see hit
the target on the left almost dead so

280
00:23:35,810 --> 00:23:43,010
here's a side by side of that first one
lines up they gonna letter for the

281
00:23:43,010 --> 00:23:46,910
target the second one a little bit
different with how we calculate the

282
00:23:46,910 --> 00:23:54,120
ballistics both fire want to let left it
centered second shot on the right it's

283
00:23:54,120 --> 00:23:58,820
the wrong target shooters concerned a
short of notice in the hay that jumped

284
00:23:58,820 --> 00:24:02,790
oddly fire from 50 yards away thus far
as they're concerned they're lined up to

285
00:24:02,790 --> 00:24:09,100
hit the other target I guess there's a
couple of a couple of other things to

286
00:24:09,100 --> 00:24:16,129
mention about about the HUD you should
be able to see like a wifi indicator on

287
00:24:16,130 --> 00:24:19,930
the right hand side there that has a
tiny number one hundred so if someone

288
00:24:19,930 --> 00:24:24,570
else does connect your rifle over the
wifi you will see that number change to

289
00:24:24,570 --> 00:24:31,939
two or three or however many devices are
connected but at least in my experience

290
00:24:31,940 --> 00:24:35,830
unless you're a very experienced shooter
you're going to be more focused on your

291
00:24:35,830 --> 00:24:39,679
target than actually the tiny values in
the hot weather thing with that as well

292
00:24:39,680 --> 00:24:43,850
with the eyepiece that drive protection
pieces there it puts you at a distance

293
00:24:43,850 --> 00:24:49,060
away from the view scream that
oftentimes will put the stuff on the

294
00:24:49,060 --> 00:24:52,800
periphery of this screen outside of your
field of you so much you're really close

295
00:24:52,800 --> 00:24:56,300
you don't actually get to see the things
are up in the edges like criticized your

296
00:24:56,300 --> 00:24:58,780
anyway

297
00:24:58,780 --> 00:25:06,730
so at this point we we had managed to
make the shooter missed a shot that when

298
00:25:06,730 --> 00:25:10,760
those sort of off the top of my list of
things they wanted to do and we managed

299
00:25:10,760 --> 00:25:14,140
to communicate with the system back in
but that was just the part of the system

300
00:25:14,140 --> 00:25:19,960
that does ballistics we wanted full on
root access to the Linux system that was

301
00:25:19,960 --> 00:25:26,660
running on the scope so what we did was
ending ever and to try and figure out

302
00:25:26,660 --> 00:25:32,190
exactly how this decipher update feature
works we found that there's an update

303
00:25:32,190 --> 00:25:37,770
script that when you upload your JPG
encrypted and signs software updates

304
00:25:37,770 --> 00:25:42,580
this script will then check this
signature if the signature verified it

305
00:25:42,580 --> 00:25:57,710
will move onto to actually unpack the
update and run it operates with two GB D

306
00:25:57,710 --> 00:26:03,500
keys so they have one of the company and
one that is on the scope now for anyone

307
00:26:03,500 --> 00:26:09,910
who's who's used GPG before when you try
to verify the signature of a jpg signed

308
00:26:09,910 --> 00:26:15,670
file if you do not know about the public
key that has signed this this file you

309
00:26:15,670 --> 00:26:20,140
but you've got to tell you that it can
verify the signature in this case

310
00:26:20,140 --> 00:26:27,050
tracking point does not check which of
the two keys actually signed the update

311
00:26:27,050 --> 00:26:35,139
so since there's a GPG key all the scope
and the password is in clear text on the

312
00:26:35,140 --> 00:26:39,950
school in the up this group I can use
that private key to actually a script

313
00:26:39,950 --> 00:26:44,220
and sign my own custom software updates
that and he tried to appoint firearm

314
00:26:44,220 --> 00:26:51,040
will happily accept is a demo of what
that looks like so first part of this

315
00:26:51,040 --> 00:26:59,220
bull Alexis a trainer to attempt a
cessation as hacker first part here is

316
00:26:59,220 --> 00:27:03,850
heading that sa to underscore except
maybe I called open up port 22 that call

317
00:27:03,850 --> 00:27:09,110
literally just passes to iptables open
for 22 thats pretty fast and they did it

318
00:27:09,110 --> 00:27:19,189
so we tried a sage permission denied
right now the package and execute that

319
00:27:19,190 --> 00:27:22,980
and this is what you see in the hood
when that's happening

320
00:27:22,980 --> 00:27:39,240
update in progress of this is a custom
update that happen

321
00:27:39,240 --> 00:27:45,470
comes back up once it's back up on the
wifi and we will reconnect to that

322
00:27:45,470 --> 00:27:48,050
crisis aging again

323
00:27:48,050 --> 00:27:53,220
process to hear in here when the gun is
building it does hit the trigger so you

324
00:27:53,220 --> 00:27:56,410
can just click mechanism is really
interesting when working on this we both

325
00:27:56,410 --> 00:28:02,929
be poking out also correctly did you do
that here we go again connected to wifi

326
00:28:02,929 --> 00:28:14,910
we now get that SSH except again opened
up for 22 now we SH as hacker password

327
00:28:14,910 --> 00:28:49,170
we're in and we are route so you can
open the firewall you could you just you

328
00:28:49,170 --> 00:28:57,890
know you can do whatever you want its
planes so sort of did summarize around

329
00:28:57,890 --> 00:29:02,780
three we found that the Edmond API was
also on it indicated you need to be on

330
00:29:02,780 --> 00:29:06,790
the wireless network and you need to
know about that admin call whether it

331
00:29:06,790 --> 00:29:11,170
it's necessary to underscore accept or
something else he just need to to know

332
00:29:11,170 --> 00:29:19,890
about it to use it is also indicated so
once you go that Porto bien you just

333
00:29:19,890 --> 00:29:24,820
need to connect with them then you will
just happily accept any any value you

334
00:29:24,820 --> 00:29:30,030
send two apps even 500,000 or suck balls

335
00:29:30,030 --> 00:29:34,770
DDT on the school can be used to encrypt
and sign updates that any tracking point

336
00:29:34,770 --> 00:29:40,210
harm will accept a note on the back and
not validating input if you were to pass

337
00:29:40,210 --> 00:29:46,250
a 348 is one of the variables that makes
it crash

338
00:29:46,250 --> 00:29:47,779
all this really cool

339
00:29:47,779 --> 00:29:52,849
be able to get through all of this of
this also required us to have previously

340
00:29:52,849 --> 00:29:57,570
accessed the system we've had to dump
this and get the GPG key out to be able

341
00:29:57,570 --> 00:30:06,468
to do this so one more thing couple of
late nights with Jesse in Portland I

342
00:30:06,469 --> 00:30:10,429
don't know if you've ever made a firearm
routable on the internet before but I

343
00:30:10,429 --> 00:30:15,929
have and it's kind of cool so they're
they're working in Portland receiving a

344
00:30:15,929 --> 00:30:20,359
PC working on it and we're going to get
a remote code execution so here's an

345
00:30:20,359 --> 00:30:29,428
example of that pretty much tracking
their scripts are connected to the wifi

346
00:30:29,429 --> 00:30:34,549
we run that it instructs you to go to
another terminal right next to listen on

347
00:30:34,549 --> 00:30:39,619
a specific port go back and hit any key
it will upload a package from the update

348
00:30:39,619 --> 00:30:45,010
scope and pass a root shell back to your
neck out listener

349
00:30:45,010 --> 00:30:49,780
the hostname or sitting on the scope who
am i where r you so this was a little

350
00:30:49,780 --> 00:30:54,310
more fun because now you don't have to
ever touch one of these things before if

351
00:30:54,310 --> 00:31:00,110
you can get on the wifi your route so
what is using in this case I keep going

352
00:31:00,110 --> 00:31:05,070
back to the mobile the API did you have
within the mobile apps validate input

353
00:31:05,070 --> 00:31:10,000
industry specific case you're you're
using the software update functionality

354
00:31:10,000 --> 00:31:14,040
and instead of operating an actual
package you're sending in command that

355
00:31:14,040 --> 00:31:22,250
for whatever reason the system is just
executing so it's not all that bad

356
00:31:22,250 --> 00:31:25,880
despite being able to make the shooter
missed a shot getting full root access

357
00:31:25,880 --> 00:31:28,620
creating custom software updates its not
all that bad

358
00:31:28,620 --> 00:31:34,699
striking point actually did a lot of
good work when when putting together

359
00:31:34,700 --> 00:31:41,160
this the system and and trying to secure
it better than what we've seen for other

360
00:31:41,160 --> 00:31:47,330
embedded devices the two USB ports that
you have on the scope are disabled

361
00:31:47,330 --> 00:31:53,679
during boot the marketing materials
listed for some future accessories of

362
00:31:53,680 --> 00:31:57,060
some kind but they are disabled during
boot so you can't really do anything

363
00:31:57,060 --> 00:32:02,889
with them when you're coming or target
or when you're taking a shot

364
00:32:02,890 --> 00:32:08,460
gauge school pool save a video that you
can download on your phone and put on

365
00:32:08,460 --> 00:32:11,690
Facebook according to tracking point
that was that was a part of the point

366
00:32:11,690 --> 00:32:18,680
representation but as soon as you
download the videos from the scope they

367
00:32:18,680 --> 00:32:22,430
are deleted so if you for whatever
reason have to send your school back to

368
00:32:22,430 --> 00:32:29,540
talking point the videos will no longer
be there W piecing use even if the key

369
00:32:29,540 --> 00:32:34,740
cannot be changed even though the keys
guess table at least five people in this

370
00:32:34,740 --> 00:32:42,450
room in may not necessarily be that easy
for four other ppl the EPI does validate

371
00:32:42,450 --> 00:32:49,360
user input so when you're using the
mobile app you cannot said any sort of

372
00:32:49,360 --> 00:32:51,469
crazy value from there

373
00:32:51,470 --> 00:32:55,500
and I don't think a lot of other people
will be pulling up to try and feed other

374
00:32:55,500 --> 00:33:03,039
stuff to their rightful console access
is password protected software updates

375
00:33:03,039 --> 00:33:07,470
are GPG encrypted and sign even though
ranking points implementation wasn't

376
00:33:07,470 --> 00:33:13,150
exactly what it should have been they
actually do take a lot of steps to to

377
00:33:13,150 --> 00:33:18,870
secure the platform will get better for
tracking point we reached out to them

378
00:33:18,870 --> 00:33:23,809
starting in April we sent three miles up
until the Wired article we have yet to

379
00:33:23,809 --> 00:33:27,139
hear back from them he was able to get
ahold of them talked to one of the

380
00:33:27,140 --> 00:33:32,159
founders soon as he got off the phone
call with Andy the boundary stopped us

381
00:33:32,159 --> 00:33:36,390
he talked to us he said we're doing
great we're glad we're working on is

382
00:33:36,390 --> 00:33:40,400
happy to work with us they are working
on a patch to pass these things not

383
00:33:40,400 --> 00:33:44,340
available yet but some point hopefully
they'll get that out but they as a

384
00:33:44,340 --> 00:33:47,020
vendor they've been phenomenal to work
with and I wish more vendors would take

385
00:33:47,020 --> 00:33:52,918
the approach they have so yesterday for
those of you that he didn't see the

386
00:33:52,919 --> 00:34:05,640
tweet tracking point put up just notice
on its website but it does it does say

387
00:34:05,640 --> 00:34:13,609
that we're working with the consultants
that would be don't be us we will

388
00:34:13,609 --> 00:34:16,980
provide you with a software update if
necessary I think it's safe to say that

389
00:34:16,980 --> 00:34:23,389
it is the gun can only be compromised if
the hacker is actually physically with

390
00:34:23,389 --> 00:34:27,349
you and the best part on your phone or
something else

391
00:34:27,349 --> 00:34:32,060
best part is you can continue to use
wifi if you're confident no hackers are

392
00:34:32,060 --> 00:34:34,259
within a hundred feet

393
00:34:34,260 --> 00:34:42,010
early on on trading points website I
thought it was pretty funny but so far

394
00:34:42,010 --> 00:34:46,380
they have been very very great to work
with they are definitely positive to me

395
00:34:46,380 --> 00:34:50,190
to the research that we have done very
interested in in actually fixing the

396
00:34:50,190 --> 00:34:57,080
issue is a wider no just as a whole
looking at this project has been said

397
00:34:57,080 --> 00:35:01,360
people over the years with the vendor
still need to level up the issues found

398
00:35:01,360 --> 00:35:03,080
here are not unique to this product

399
00:35:03,080 --> 00:35:06,610
other embedded systems have the same
problems and too many vendors ignore the

400
00:35:06,610 --> 00:35:08,410
low-hanging fruit so in this case

401
00:35:08,410 --> 00:35:12,810
building rifles that run Linux they knew
they were gonna get a lot of attention

402
00:35:12,810 --> 00:35:16,750
for it they took some precautions around
that so they did put the password on the

403
00:35:16,750 --> 00:35:19,970
shelf they did do these other things and
it seems that other vendors completely

404
00:35:19,970 --> 00:35:25,640
ignore we've done around trying to find
some resources to recommend for embedded

405
00:35:25,640 --> 00:35:30,730
systems specifically looking for a tight
end for embedded systems are more

406
00:35:30,730 --> 00:35:33,690
specifically what doesn't exist

407
00:35:33,690 --> 00:35:36,880
the two best things we could find were
built to securely which has a lot of

408
00:35:36,880 --> 00:35:39,520
good resources for the general security
things you should do when you're

409
00:35:39,520 --> 00:35:43,460
building a system then there's a wasp
I'll T top ten and a lot of the things

410
00:35:43,460 --> 00:35:46,490
in there would actually fixed some of
the issues we found with the ATF

411
00:35:46,490 --> 00:35:49,729
indication of things like that but up to
today

412
00:35:49,730 --> 00:35:56,400
short of individual researchers and
going out and giving presentation saying

413
00:35:56,400 --> 00:35:59,690
here stuff that people should be doing
to secure their products there is no

414
00:35:59,690 --> 00:36:03,800
kind of resource for people to reference
I guess just to just drive it home

415
00:36:03,800 --> 00:36:09,560
the issues that we found clearly aren't
unique to this project is not like these

416
00:36:09,560 --> 00:36:14,900
are issues that you will only ever find
on a firearm these are very low hanging

417
00:36:14,900 --> 00:36:18,890
fruit easy to fix and issues that you
probably do see and other embedded

418
00:36:18,890 --> 00:36:24,339
devices as well so destructively
would've been possible without the help

419
00:36:24,340 --> 00:36:28,140
from the community and people involved
in at great thanks to everyone on this

420
00:36:28,140 --> 00:36:32,490
definitely some things here would not
have happened without some assistance

421
00:36:32,490 --> 00:36:36,859
it's been it's been incredibly
fascinating to Jesse just people within

422
00:36:36,860 --> 00:36:41,180
this community that I have never met
before just drop everything and spend a

423
00:36:41,180 --> 00:36:44,259
week with us in Portland to actually
hack on it

424
00:36:44,260 --> 00:36:48,410
and and get the demo is working and get
the file system actually at one point

425
00:36:48,410 --> 00:36:51,560
when we're going up to Portland because
we really wanted to pull the chip with a

426
00:36:51,560 --> 00:36:56,290
filesystem I was emailing the guy that
was going to help us with it and as it

427
00:36:56,290 --> 00:37:01,050
turns out homie showed up in Portland I
never told him that he was a firearm I

428
00:37:01,050 --> 00:37:04,720
just know him and specifically told him
like we have this chip it has this

429
00:37:04,720 --> 00:37:09,220
number really want to get the contents
on other side of the chip and he's like

430
00:37:09,220 --> 00:37:13,220
cool this great he didn't ask any
questions I didn't see anything and so

431
00:37:13,220 --> 00:37:19,040
we show up in Portland he's like oh yeah
it's been it's been great working with

432
00:37:19,040 --> 00:37:24,050
all these people thank everybody for
coming out listening was happy to

433
00:37:24,050 --> 00:37:24,480
questions

