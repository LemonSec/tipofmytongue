1
00:00:00,000 --> 00:00:05,480
in a session is our universal Android
Android routine is back with our speaker

2
00:00:05,480 --> 00:00:20,720
when should I thanks for coming to my
talk online shoe from him today at our

3
00:00:20,720 --> 00:00:26,448
show is you the universal used to shun
of painting first of all I want to

4
00:00:26,449 --> 00:00:32,450
introduce myself I am a security
research intern at King team many I

5
00:00:32,450 --> 00:00:38,059
focused on angelo routing and software
exploitation and meanwhile

6
00:00:38,059 --> 00:00:45,010
undergraduate student at Shahjalal
University I'm a big fans of CTF games

7
00:00:45,010 --> 00:00:50,968
and I'm the vice captain of team looks
so we will participate

8
00:00:50,969 --> 00:00:55,469
DEFCON CTF I know tomorrow and good luck

9
00:00:55,469 --> 00:01:02,460
here's the road map of my talk so first
of all talk about the present situation

10
00:01:02,460 --> 00:01:11,590
of NJ routine dan our show the highlight
parts of our work included an awesome

11
00:01:11,590 --> 00:01:19,110
blog we exploited to achieve enjoy
routine Android devices and what part is

12
00:01:19,110 --> 00:01:25,900
about the exploitation techniques we use
and allows our talk about the future of

13
00:01:25,900 --> 00:01:32,190
the enjoy routine so let's start

14
00:01:32,190 --> 00:01:40,149
so the question before we do that and we
must make clear that what do we do with

15
00:01:40,150 --> 00:01:44,770
four so when it comes to link next to
routine maybe the goal is to get a root

16
00:01:44,770 --> 00:01:50,149
shell has the privilege of a root user
but it's somehow fitting meaningless

17
00:01:50,150 --> 00:01:55,890
when we are doing angel routine because
if we want a permanent root Android

18
00:01:55,890 --> 00:01:57,120
device dias

19
00:01:57,120 --> 00:02:04,040
maybe we should put the SU binary on the
system partition and then if you only

20
00:02:04,040 --> 00:02:11,210
have that one won't be enough in fact we
need a turnoff to read and write ability

21
00:02:11,210 --> 00:02:18,640
so you know currently many Android
devices are protected by many

22
00:02:18,640 --> 00:02:25,089
protections on medications from these
vendors such like assuming there are

23
00:02:25,090 --> 00:02:30,390
some protections that you are not wrong

24
00:02:30,390 --> 00:02:36,529
arbitrary binary files on the specific
folders are you cannot reminder system

25
00:02:36,530 --> 00:02:42,100
partition then you cannot put the issue
of binary under its so easy sorry or

26
00:02:42,100 --> 00:02:47,109
even if we have a clean up to read and
write ability then we can take all of

27
00:02:47,110 --> 00:02:54,630
them time and achieve our goal so the
second question is that what pages we

28
00:02:54,630 --> 00:03:02,700
need to do you tie Android devices so
here I list some vulnerabilities in

29
00:03:02,700 --> 00:03:10,149
drivers on and Joe devices all of them
are owned by King team members so we

30
00:03:10,150 --> 00:03:15,130
used to use these vulnerabilities yea
woe root 0 Toulouse Android devices but

31
00:03:15,130 --> 00:03:21,380
one problem is that these
vulnerabilities or in a linguist oh

32
00:03:21,380 --> 00:03:22,489
sorry

33
00:03:22,489 --> 00:03:31,940
drivers so maybe process or something
like that so these are not universal

34
00:03:31,940 --> 00:03:37,640
vulnerabilities in fact we need
universal applied bug then we can do a

35
00:03:37,640 --> 00:03:38,600
universal truth

36
00:03:38,600 --> 00:03:45,019
so we want to make a big deal so we want
two things one that we want to need a

37
00:03:45,020 --> 00:03:51,070
universal played bugging Linux kernel
source not in specific drivers something

38
00:03:51,070 --> 00:03:55,130
like that and the other things that we
want to use the Universal applied

39
00:03:55,130 --> 00:04:01,269
exploitation techniques which is which
can be applied for hundreds of thousands

40
00:04:01,270 --> 00:04:06,520
of Android devices and the we do not
need to too much hot cold we need to one

41
00:04:06,520 --> 00:04:13,380
generate root exploit for all of these
Android devices so last year members out

42
00:04:13,380 --> 00:04:20,790
there is a universal route to our
invented by Jill hostile this year is

43
00:04:20,790 --> 00:04:28,030
coming back from from King teams so
let's start and in fact our total talk

44
00:04:28,030 --> 00:04:37,840
about stories of my high developed right
and what difficulties I met during this

45
00:04:37,840 --> 00:04:43,619
process and the high exchange ideas with
my teammates and finally achieve this

46
00:04:43,620 --> 00:04:51,470
goal so let's start the first part is
about the bug hunting still once upon

47
00:04:51,470 --> 00:04:58,760
time so our team leader which she gave
me a fire and the including hundreds of

48
00:04:58,760 --> 00:05:06,460
you know cornel crashes in Linux kernel
so in fact he got this crash logs from

49
00:05:06,460 --> 00:05:13,049
non open source desk officer called a
trip Trinity's levering everyone could

50
00:05:13,050 --> 00:05:20,130
get his online end but it is based on
the desktop early next so I'll see you

51
00:05:20,130 --> 00:05:25,430
customize their heads and put it is to
their arm linux end just executed on

52
00:05:25,430 --> 00:05:33,210
android devices and the key is generated
hundreds of crash logs and he gave it

53
00:05:33,210 --> 00:05:38,260
gives them to me and my class is just to
end the letters and the last days to get

54
00:05:38,260 --> 00:05:42,880
to find something interesting so here we
are

55
00:05:42,880 --> 00:05:47,500
amongst least crash logs I found
interesting one

56
00:05:47,500 --> 00:05:53,450
the kernel has a critical page bought at
two hundred 200 so that's a weird and

57
00:05:53,450 --> 00:05:56,340
you can see that the PC is a function

58
00:05:56,340 --> 00:06:04,119
cash so let's have a deeper discover
discoveries though you can see that

59
00:06:04,120 --> 00:06:11,200
function / take off take SK as the
Baraboo and this argument is that type

60
00:06:11,200 --> 00:06:17,320
of structure sock so in fact it is the
socket object in colonel and you can see

61
00:06:17,320 --> 00:06:21,200
that it is possibly into the piano has
till it is up install kit objecting

62
00:06:21,200 --> 00:06:27,690
colonel and attackers can create such a
objecting he's use our program by

63
00:06:27,690 --> 00:06:35,450
calling sockets and a specifying you
know the ICMP protocol so if act as a

64
00:06:35,450 --> 00:06:41,060
colonel crashes in function called
naturalist and news tell which I marked

65
00:06:41,060 --> 00:06:47,720
it read on the line and because this
function in lines if you only take a

66
00:06:47,720 --> 00:06:54,170
look in the crash lawyer cannot know
that where the exact location the crash

67
00:06:54,170 --> 00:07:02,980
happens so let's goes into it and so my
first task is to final word this two

68
00:07:02,980 --> 00:07:07,820
hundred 200 comes those as we're so in
fact aware I have a look at this

69
00:07:07,820 --> 00:07:14,650
dysfunction and I know where the two
hundred 200 Council wrong so if at the

70
00:07:14,650 --> 00:07:19,380
value of these predefined constants in
kernel source the disappointment to it

71
00:07:19,380 --> 00:07:27,030
is just two hundred 200 and then you can
see that when we first recorded the

72
00:07:27,030 --> 00:07:33,020
first record the catalyst and news tell
them you can see the previous member of

73
00:07:33,020 --> 00:07:38,599
the snow the end will be statue they let
the poison to is just the two hundred

74
00:07:38,600 --> 00:07:45,880
200 n if we call this function again
then you can go into the going to that's

75
00:07:45,880 --> 00:07:51,930
a function of her and you can see that
I'm up to you can see that local

76
00:07:51,930 --> 00:07:53,249
valuable keep it is

77
00:07:53,249 --> 00:07:58,169
is lined by the previous member of the
snow the end which is two hundred 200

78
00:07:58,169 --> 00:08:03,489
and then immediately as a reference on
this on this local variable and then

79
00:08:03,489 --> 00:08:09,719
does that there are two hundred 200 and
if we not mad this value your face then

80
00:08:09,719 --> 00:08:16,709
the kernel crashes with critical page
shot myself here we got the root cause

81
00:08:16,709 --> 00:08:23,659
of this vulnerability and we should try
to find a proof of concept of this

82
00:08:23,659 --> 00:08:31,169
vulnerability so how could we make the
throws to this function though in fact

83
00:08:31,169 --> 00:08:35,659
it is interesting so you can see that
appeared dashed function is called in

84
00:08:35,659 --> 00:08:41,818
function UDP disconnected but the UD be
disconnected caught in an addy Graham

85
00:08:41,818 --> 00:08:47,339
conduct and the with special is they
family specify the cause

86
00:08:47,339 --> 00:08:53,559
ap us back you can see that the
disconnect in Craiglist cause as you

87
00:08:53,559 --> 00:09:00,290
connected you may use a program that's
interesting and here we are very clear

88
00:09:00,290 --> 00:09:08,769
about this is about this concept to
reproduce this girl page bod we just to

89
00:09:08,769 --> 00:09:13,720
create a socket by specifying the
protocol as ICMP enemy to a commission

90
00:09:13,720 --> 00:09:22,120
connections to it with classified as
they found family as a pianist back then

91
00:09:22,120 --> 00:09:30,899
we got our crash so I stuck at this
place for a long time because I want to

92
00:09:30,899 --> 00:09:37,740
so a local denial of service is not my
daughter I want to achieve the loose

93
00:09:37,740 --> 00:09:42,740
this is not enough so I stopped at the
displaced and I want to manipulate the

94
00:09:42,740 --> 00:09:47,779
actual list pointers to find something
interesting but I know that a lot too so

95
00:09:47,779 --> 00:09:53,019
i turn my interested to as a crash logs
that for about two or three weeks I

96
00:09:53,019 --> 00:10:02,019
found that this is so I just turned back
to it and I make some twice so in fact

97
00:10:02,019 --> 00:10:06,610
this time I'm map 200 200 userspace
damage

98
00:10:06,610 --> 00:10:13,610
connections then I want crash but you
know I have a good program habits I just

99
00:10:13,610 --> 00:10:20,910
closed all of these sockets before I
quit my program but interesting thing is

100
00:10:20,910 --> 00:10:26,779
that the kernel crash we're close the
socket object and I goes deep into the

101
00:10:26,779 --> 00:10:31,760
source you can see that we're close of 5
descriptor you the space in the kernel

102
00:10:31,760 --> 00:10:39,779
will call i net release and then there
is somehow like AV table socket object

103
00:10:39,779 --> 00:10:45,500
of it is just a este prodding his array
of the function pointers in a way I

104
00:10:45,500 --> 00:10:49,640
closed it well the phone call function
pointers called the PLO's will be

105
00:10:49,640 --> 00:10:56,459
invoked and then the kernel crash so I
realize that it is a typical use our

106
00:10:56,459 --> 00:11:03,180
free vulnerability may be there you know
because that escape route value has been

107
00:11:03,180 --> 00:11:12,630
corrupted and let's see what happened so
in fact where I have a second of you had

108
00:11:12,630 --> 00:11:17,899
a second interview into the source and
then I also had immediately of the issue

109
00:11:17,899 --> 00:11:24,890
list in newsday out there is a function
called which named as sockets socket so

110
00:11:24,890 --> 00:11:29,990
if you are familiar with Linux kernel
source you know that there are some

111
00:11:29,990 --> 00:11:34,600
function called blah-blah-blah put there
it's just decreased the reference count

112
00:11:34,600 --> 00:11:39,769
of this object it and if the reference
count of this object equals zero and

113
00:11:39,769 --> 00:11:44,600
then the carnival freak right so here we
are

114
00:11:44,600 --> 00:11:49,110
if we had the two hundred 200 you
they're spaced and avoid the kernel

115
00:11:49,110 --> 00:11:56,390
crash endemic to connections in the den
the kernel will free but we have a dying

116
00:11:56,390 --> 00:12:02,550
fire this script her associated with
this object in a criminal you know use a

117
00:12:02,550 --> 00:12:07,680
program under our control rise so this
is a typical use a free vulnerability in

118
00:12:07,680 --> 00:12:16,020
a colonel and it has the TV number
called RCV 2015 3636 so here we are we

119
00:12:16,020 --> 00:12:21,339
have you stopped 31 our ability and in
fact if we can control the content of

120
00:12:21,339 --> 00:12:26,319
the freedom honorable pin socket object
then we can control the PC register by

121
00:12:26,319 --> 00:12:34,860
calling close so next at-bat our talk
about the exploitation of this

122
00:12:34,860 --> 00:12:40,970
vulnerability so first of all when when
it comes to use our free exploiting a UF

123
00:12:40,970 --> 00:12:46,750
on their busy the most critical issue
and then the problem is the refueling so

124
00:12:46,750 --> 00:12:52,610
we must have the control of the freedom
honorable object that's critical so this

125
00:12:52,610 --> 00:12:57,990
time our top target is that this
structure stocks are kids object in

126
00:12:57,990 --> 00:13:02,110
colonel and disappointingly it is
allocated

127
00:13:02,110 --> 00:13:10,880
custom used cash named the pink so let's
review of slapdash so basically slept

128
00:13:10,880 --> 00:13:17,360
Ashes is the kind of storage unit in
kernel storing objects of specific type

129
00:13:17,360 --> 00:13:24,569
so in fact he provide their separation
between knopf objects so these

130
00:13:24,569 --> 00:13:31,479
difficulties I need to add developing
dis root exploit first the object is is

131
00:13:31,480 --> 00:13:36,120
allocated by a slap a locator so the
slab allocator provider separation

132
00:13:36,120 --> 00:13:41,769
between objects so it is not very easy
to use another type of popcorn objects

133
00:13:41,769 --> 00:13:47,140
to override the venerable object it is
somehow like the isolated heavy Internet

134
00:13:47,140 --> 00:13:53,620
Explorer so this agency is the candidate
objects so we must find they're

135
00:13:53,620 --> 00:13:59,449
controllable Canada object object to do
the override because we cannot directly

136
00:13:59,449 --> 00:14:05,439
allocating or the allocating the current
object to this and other issue and the

137
00:14:05,440 --> 00:14:10,519
third thing is that we must overcome the
multithreading support of the kernel

138
00:14:10,519 --> 00:14:17,550
because you know when you're attacked
program is executing the actives tasks

139
00:14:17,550 --> 00:14:25,630
running simultaneously schedule on the
corner so they will have impact on the

140
00:14:25,630 --> 00:14:29,439
layout of the kernel so that's another
problem

141
00:14:29,440 --> 00:14:33,950
and the final problem is that we must
control the content of the vulnerable

142
00:14:33,950 --> 00:14:40,060
freed object so but we do not have a
stream in a criminal right so that's

143
00:14:40,060 --> 00:14:48,709
four difficulty difficulties I can clue
so my plan is to use a clean out the

144
00:14:48,710 --> 00:14:50,940
barber so I think

145
00:14:50,940 --> 00:14:59,290
buffer is somehow the stream in Linux
kernel so he may offer is exist in

146
00:14:59,290 --> 00:15:05,860
hundreds of flows in Linux kernel and in
fact it has several choices are sizes do

147
00:15:05,860 --> 00:15:11,500
you cannot specify any kind of toys you
like most of them

148
00:15:11,500 --> 00:15:19,190
powers of two you have came out of 128
buffer you have came out of 256 buffer

149
00:15:19,190 --> 00:15:26,790
something like that and how to create is
so here I recommend a choice there is

150
00:15:26,790 --> 00:15:32,650
Kim alibi fur allocated e process of
sending message which is also used the

151
00:15:32,650 --> 00:15:40,860
towers so basically in towers enjoy hot
used this buffer to override the

152
00:15:40,860 --> 00:15:46,940
initialized that memory but if the size
is large enough then colonel want put

153
00:15:46,940 --> 00:15:52,860
the buffer on the stack but instead used
him a lot to allay allocating era and

154
00:15:52,860 --> 00:15:58,130
the point that I into a 10 if we use the
send message we can control the size

155
00:15:58,130 --> 00:16:02,320
because the status just the thought less
of the control message you want to

156
00:16:02,320 --> 00:16:03,300
transfer

157
00:16:03,300 --> 00:16:10,050
send a message and the content is also
controlled by us so

158
00:16:10,050 --> 00:16:17,130
my initial intuitive idea is to use
Gmail buffer to override the venerable

159
00:16:17,130 --> 00:16:21,950
object I just along to you know sprayed
of honor of artists and the free all of

160
00:16:21,950 --> 00:16:28,190
them and maybe the slavs stories this
manner of objects will be recycled by

161
00:16:28,190 --> 00:16:33,860
the kernel future a location and that
hope is that these carrawell be used it

162
00:16:33,860 --> 00:16:41,660
to storing the came out later where I
spraying the offer but this this plays

163
00:16:41,660 --> 00:16:48,579
out of control has really quite low
success rate so I want to improve this

164
00:16:48,579 --> 00:16:55,399
so basically I'm right I was writing my
first through the exploiters targeting a

165
00:16:55,399 --> 00:17:02,110
smaller ability are goldfish wishes the
Android emulator on this emulator the

166
00:17:02,110 --> 00:17:08,579
size of the vulnerable object P socket
object is 500 and tell which is a claim

167
00:17:08,579 --> 00:17:15,970
a lot size so here I wanna say that a
locator helps are so then you early

168
00:17:15,970 --> 00:17:21,280
adopters love allocators try to merge
different objects of the same size the

169
00:17:21,280 --> 00:17:28,339
into one cash instead of the same type
of so it's just give us an opportunity

170
00:17:28,339 --> 00:17:34,440
to use the key Malabar to override the
vulnerable objects so if the size of the

171
00:17:34,440 --> 00:17:40,730
object is that 512 that I can use send a
message to allocate came out of poppers

172
00:17:40,730 --> 00:17:44,309
to override did so I'm excited I finish
dates

173
00:17:44,309 --> 00:17:49,559
exploit on the emulator and I noticed a
result of my colleague leon 10 he told

174
00:17:49,559 --> 00:17:54,879
me that you should try to test your
exploits are some other Android devices

175
00:17:54,880 --> 00:17:58,720
and rear ended their ideas then
disappointed in the iPhones that the

176
00:17:58,720 --> 00:18:02,500
size of the penis target object a
hundred and that raised on different

177
00:18:02,500 --> 00:18:08,360
Android devices and maybe on this post
office and song the size of a pin socket

178
00:18:08,360 --> 00:18:14,250
object is five hundred and seventy-six
and I enjoy devices of Sony maybe the

179
00:18:14,250 --> 00:18:17,380
size of the piece nugget object is is
the

180
00:18:17,380 --> 00:18:26,950
over 600 so you cannot use the 510 told
barbour to over all of them and my goal

181
00:18:26,950 --> 00:18:31,510
is to achieve a universal generika
exploit for hundreds of Android devices

182
00:18:31,510 --> 00:18:40,450
so that's not the final plan we used so
here's our final play the first part of

183
00:18:40,450 --> 00:18:48,000
our universal solution is to control the
kernel memory so in fact I stuck at this

184
00:18:48,000 --> 00:18:52,690
place also for a long time and you know
i like reading of them it paper and

185
00:18:52,690 --> 00:18:59,610
paper called returned to dirt and he
used this man to bypass cannot

186
00:18:59,610 --> 00:19:10,080
protections that I as the MEP or FMAP
but mine in my dad's an idea appeared in

187
00:19:10,080 --> 00:19:19,350
my mind that I used this map to help
exploit vulnerabilities in Akron so

188
00:19:19,350 --> 00:19:24,290
let's take a look at the feast map so
this map also called directly mapped

189
00:19:24,290 --> 00:19:30,870
memory is just a magnesium which mad
that directly mapped the memory use the

190
00:19:30,870 --> 00:19:36,139
space into the kernel space for
promoting the efficacy of the kernel so

191
00:19:36,140 --> 00:19:40,190
you can take a look at his picture and
this map all of these pages are

192
00:19:40,190 --> 00:19:48,320
physically continuous so here's my dear
I want to use their fists map to do the

193
00:19:48,320 --> 00:19:54,570
overriding not noticed a diff this map
is not her current object so it has his

194
00:19:54,570 --> 00:20:03,389
own advantage so how to creator is
snapped and attacked her just it's a

195
00:20:03,390 --> 00:20:13,820
relatively call em and EM a matter of a
size of 256 megabytes and feeling prop

196
00:20:13,820 --> 00:20:20,360
up a load he want for the following you
exploit so the fifth map will with our

197
00:20:20,360 --> 00:20:27,919
pillows will arouse in a colonel while
occupying the freedom memory and we hope

198
00:20:27,920 --> 00:20:30,220
that the fifth Matt will use the

199
00:20:30,220 --> 00:20:37,380
the space once occupied by the
vulnerable pink sock sock objects for

200
00:20:37,380 --> 00:20:50,110
his expand its condition so here we are
so first thing is that we want to make

201
00:20:50,110 --> 00:20:54,949
sure that this man can Kuroda slap
cassius so we can take a look at the

202
00:20:54,950 --> 00:21:05,570
size of this this map and for example on
32 and the fifth map has a size of 716

203
00:21:05,570 --> 00:21:11,320
mirrors and it is large enough to cover
the slab cassius so here is the first

204
00:21:11,320 --> 00:21:23,049
thing and so my initial plane is to
allocate a location large amounts of

205
00:21:23,049 --> 00:21:29,440
vulnerable pin socket objects and the
den I free all of them and I used

206
00:21:29,440 --> 00:21:37,809
iteratively called MFN the hopes that
this will make some memories collisions

207
00:21:37,809 --> 00:21:45,260
with these read lab cassius which once
thought the vulnerable pin socket object

208
00:21:45,260 --> 00:21:54,350
but in fact if your child the success
rate is still not very high so let's

209
00:21:54,350 --> 00:22:02,270
move to their seconds that we want her
reliability so if you want to achieve a

210
00:22:02,270 --> 00:22:09,309
reliable memory coalition you must make
some changes in fact this time I want to

211
00:22:09,309 --> 00:22:12,610
spray the vulnerable pink sock it to
objects

212
00:22:12,610 --> 00:22:20,080
group so every five piece of objects and
with which I consider them as the normal

213
00:22:20,080 --> 00:22:26,908
ones I just a freedom by closing it then
I allocate 2011 durable peace orkut

214
00:22:26,909 --> 00:22:34,419
object you know so every every group 500
normal one-and-one vulnerable one so why

215
00:22:34,419 --> 00:22:39,600
I do this because I want to make sure
that the King socket object that

216
00:22:39,600 --> 00:22:42,129
vulnerable Psaki subjects of our

217
00:22:42,130 --> 00:22:48,770
our plays the everywhere in a kernel
space and then that sharply increase the

218
00:22:48,770 --> 00:22:53,460
probability that the fifth map and the
minor repairs target objects will meet

219
00:22:53,460 --> 00:22:58,140
together and after i right

220
00:22:58,140 --> 00:23:07,520
achieved exploit based on this idea that
this rate sharply increase but in fact I

221
00:23:07,520 --> 00:23:13,080
do not want to see guys I want to
definitely goes out there are vulnerable

222
00:23:13,080 --> 00:23:20,169
Psaki updates already covered by this
map so here's the steps that great

223
00:23:20,170 --> 00:23:26,900
information leakage so in fact we find
that info leaked we can cause I'll

224
00:23:26,900 --> 00:23:34,180
control arms that pin socket objecting
that use a program with the best

225
00:23:34,180 --> 00:23:43,060
fighting this this time stamps options
you know you can get a DWORD value from

226
00:23:43,060 --> 00:23:49,750
this pin socket object and then if ever
West we it's ready of MFN a few early

227
00:23:49,750 --> 00:23:55,780
hour of prop up a long we need a root
exploit her we also new to feel

228
00:23:55,780 --> 00:24:03,590
Youngstown match value I go down well as
well and do this breaking in each stage

229
00:24:03,590 --> 00:24:10,540
our cost objects and then I guess the
return value from this our country and

230
00:24:10,540 --> 00:24:17,129
if it's just me 'cause to their magic
value of correctly reflects the measured

231
00:24:17,130 --> 00:24:23,200
value once I filled in that means this
venerable object has already been

232
00:24:23,200 --> 00:24:30,330
covered by this map and I got it so this
information leakage also helps improve

233
00:24:30,330 --> 00:24:39,899
the reliability of our resolution so
let's let's make a summary so first we

234
00:24:39,900 --> 00:24:45,210
spray our pin socket objects in group
every 500 normal ones with one by

235
00:24:45,210 --> 00:24:50,040
honorable ones and we freed all of them
but for normalized we just closed its

236
00:24:50,040 --> 00:24:54,580
really easy normally but for the
vulnerable when we check our they used a

237
00:24:54,580 --> 00:24:55,270
three-run

238
00:24:55,270 --> 00:25:02,530
ability and the seat these objects will
be free the and make large freeze basis

239
00:25:02,530 --> 00:25:09,700
colonel and then we hope they'll be used
for the heroes of this map is our

240
00:25:09,700 --> 00:25:16,200
payload and the dam which iteratively
call a map we do the fishnets spray and

241
00:25:16,200 --> 00:25:23,390
feeling payload you know the address
this we need to wear for the following

242
00:25:23,390 --> 00:25:29,480
root exploit it also the magic values I
mentioned before and then at each stage

243
00:25:29,480 --> 00:25:35,240
week audio controls on the PC market
objects that five descriptor we on our

244
00:25:35,240 --> 00:25:41,050
program and then we check the return
value and one object is already being

245
00:25:41,050 --> 00:25:51,909
covered then the spring just thought so
in fact I've presented not a just a root

246
00:25:51,910 --> 00:26:00,490
exploit targeting our used this among
our ability but generate memory memory

247
00:26:00,490 --> 00:26:07,510
collision model targeting used a free
runner abilities in Linux kernel so this

248
00:26:07,510 --> 00:26:08,440
scheme dis

249
00:26:08,440 --> 00:26:15,220
overcomes the difficulties I mentioned
before and it is hard to mitigated

250
00:26:15,220 --> 00:26:21,240
because I used the inherent property of
Linux kernel because the fifth map is

251
00:26:21,240 --> 00:26:26,640
just the mechanism of them memory
management of Linux kernel and it always

252
00:26:26,640 --> 00:26:34,340
occupies the space in there colonel and
FDR is that the cook the memories three

253
00:26:34,340 --> 00:26:40,260
dares probabilities out this memory will
be for the growth of the fifth man who

254
00:26:40,260 --> 00:26:42,779
is that how you view this place

255
00:26:42,779 --> 00:26:49,539
rise so it is an excellent plan
targeting use the ultraviolet a bit easy

256
00:26:49,539 --> 00:26:57,140
next guest is the key point I want to
mention so here we are

257
00:26:57,140 --> 00:27:02,549
if we control the content of the freedom
vulnerable pin socket objects down Wii

258
00:27:02,549 --> 00:27:09,100
controller PC register rise so big
because the SP Prada virtual office tip

259
00:27:09,100 --> 00:27:15,699
rod this so-called I raised the function
pointers that is controlled by us then

260
00:27:15,700 --> 00:27:23,059
we can just control of Puget PC register
and then return to the show so what does

261
00:27:23,059 --> 00:27:31,620
shellcode do so she'll hard told us dist
again he's towers in fact the shell

262
00:27:31,620 --> 00:27:37,969
continues with 22 things first it should
lead the kernel stack address and when

263
00:27:37,970 --> 00:27:41,770
we've got the kernel stack address then
we've got the address of the thread info

264
00:27:41,770 --> 00:27:46,799
and if we've got the address of the
sarajevo then we patched over i diritti

265
00:27:46,799 --> 00:27:54,139
di limit of the current strike off our a
representing our attack program they've

266
00:27:54,140 --> 00:28:00,659
override this is indeed a limit 20 and
the week God union rights abilities

267
00:28:00,659 --> 00:28:09,380
through pipe so here we are so I
represented

268
00:28:09,380 --> 00:28:17,580
exploited for the 32 bit enjoyed the
ISIS already but back to a logo we want

269
00:28:17,580 --> 00:28:24,590
to achieve the universal solution and 64
bit Android devices on the market now so

270
00:28:24,590 --> 00:28:30,590
what about 64 bit enjoy devices does the
buck exist

271
00:28:30,590 --> 00:28:41,029
yes so does the list poison to also have
the value of two hundred 200 so this is

272
00:28:41,029 --> 00:28:47,669
a serious problem because when will our
team along to exploit the 64 bit devices

273
00:28:47,669 --> 00:28:55,409
hi I just proposed again maybe the
disappointment to want be cannot be

274
00:28:55,409 --> 00:29:02,179
mapped on 64 bit Android devices but
surprisingly this time not disappointed

275
00:29:02,179 --> 00:29:10,940
Lee the its value is also two hundred
200 and that can be mapped and achieve

276
00:29:10,940 --> 00:29:17,880
their memory coalition between the 5th
and vulnerable objects and the answer is

277
00:29:17,880 --> 00:29:27,049
yes after we doing some experiments in
practical so in fact also the 64 bit

278
00:29:27,049 --> 00:29:34,080
Android devices has a larger you know
virtual space but but the memory of the

279
00:29:34,080 --> 00:29:42,178
ramp then the size of the RAM is limited
and you know the Coalition will finally

280
00:29:42,179 --> 00:29:48,850
happen on earth city of Obasanjo devices
also and then the last issue is out

281
00:29:48,850 --> 00:29:57,070
could we just simply return to the to
the show called the lady you know for

282
00:29:57,070 --> 00:30:03,850
some stance on devices like the exxon
age you cannot do that because then it

283
00:30:03,850 --> 00:30:10,908
applies though we have to so the first
thing on my mind is the code I read just

284
00:30:10,909 --> 00:30:17,330
a bit into the fifth map you know we can
place our show based and change the

285
00:30:17,330 --> 00:30:22,370
property of the memory to executable and
Danielle view map the throw this mapping

286
00:30:22,370 --> 00:30:25,989
to their kernel space and then we can
just a return to the States but

287
00:30:25,990 --> 00:30:32,700
disappointed again the first map is not
executable

288
00:30:32,700 --> 00:30:38,070
arm devices are injured devices so we
had to do the ROP

289
00:30:38,070 --> 00:30:44,418
our piece of the current off he has have
Tuesday staged the first stage is to

290
00:30:44,419 --> 00:30:51,580
construct our change and the leader
Kronos packages and the second I'll be

291
00:30:51,580 --> 00:31:01,019
Chen is to just override addr limit 20
but a pity what a pity is that we have

292
00:31:01,019 --> 00:31:07,169
to do some hot cold here that's just
because if we haven't achieved colonel

293
00:31:07,169 --> 00:31:12,529
obviously read and write ability we
cannot touch the kernel memory and the

294
00:31:12,529 --> 00:31:20,340
final gadgets we want so we have to dump
the room and put it into either and find

295
00:31:20,340 --> 00:31:27,340
the gadgets and we have to hard code for
every types of rams so here's the scenes

296
00:31:27,340 --> 00:31:36,988
as 20 wishes not very universal
universal so in fact my my teammates

297
00:31:36,989 --> 00:31:44,669
after I finish that our future in a
compromising the stands at five and a

298
00:31:44,669 --> 00:31:47,700
denim Dan

299
00:31:47,700 --> 00:31:54,230
you know I turn 21 some other work and
my teammates QB he continues my walk and

300
00:31:54,230 --> 00:31:57,220
a writer writing more I'll be test for
the event

301
00:31:57,220 --> 00:32:04,090
Android devices 10 days says I
disappointed my kind of attack cannot

302
00:32:04,090 --> 00:32:11,879
work very well and have certain failure
rates are some devices so effective to

303
00:32:11,879 --> 00:32:21,869
view rewrite them IOP change you have
preferred jail P I'll keep the reason is

304
00:32:21,869 --> 00:32:27,749
that if we if we use our peeing colonel
down we we we couldn't avoid this that

305
00:32:27,749 --> 00:32:28,519
poverty

306
00:32:28,519 --> 00:32:36,839
but you know that will get you the
average hoskin if if the address is the

307
00:32:36,839 --> 00:32:41,249
stock value is the corrupted den the
kernel will be crash and embrace the

308
00:32:41,249 --> 00:32:49,179
expected results so we should be used to
jail jump jump jump jump in the finally

309
00:32:49,179 --> 00:32:58,259
achieve our goals we cannot so here's
some chips so basically you saw them

310
00:32:58,259 --> 00:33:04,029
make full use of their value of the
rejects her so where you invoking that

311
00:33:04,029 --> 00:33:10,039
funk prompted function pointers at the
beginning of Albi change and make use of

312
00:33:10,039 --> 00:33:16,529
these values of the current values of
the registers and another thing that you

313
00:33:16,529 --> 00:33:21,399
are exploiting 64 bit Android devices

314
00:33:21,399 --> 00:33:28,458
high 32 bit off of the of a virtual
address space remained the same so if

315
00:33:28,459 --> 00:33:36,969
you find their gadgets just a reader
writer Los 32 bit of the verge of a

316
00:33:36,969 --> 00:33:43,349
coalition that will be helpful and in
fact we focus on God gadgets

317
00:33:43,349 --> 00:33:51,570
some ROMs and there we only used one
gadget and we can achieve two steps we

318
00:33:51,570 --> 00:33:57,749
can combine the two step the leakage and
overwriting 21 and then maybe you left

319
00:33:57,749 --> 00:34:06,729
it to you guys to find it so here we are
with the help of the ways to help evolve

320
00:34:06,729 --> 00:34:14,339
my teammates James farmer and the Q bien
away their money or busy from who she

321
00:34:14,339 --> 00:34:20,349
finally we achieve universal rules
dilution

322
00:34:20,349 --> 00:34:27,599
and the weekend at Toulouse most popular
Android devices on the market

323
00:34:27,599 --> 00:34:36,029
oh by the way to be hired a four point
three and also we have the first to 64

324
00:34:36,029 --> 00:34:43,728
bit enjoy its case in the world as we
are aware and we just a release that our

325
00:34:43,728 --> 00:34:52,689
solution targeting Samsung Galaxy S six
and exit Essex age on XDA forums and I

326
00:34:52,690 --> 00:35:01,499
hope my colleagues are already over
300,000 people downloading it and root

327
00:35:01,499 --> 00:35:12,328
there do I enjoyed the ISIS and has a
piece of them so here is the Galaxy S

328
00:35:12,329 --> 00:35:19,369
sticks and you can see that we cricket
our loser loser and Israel first install

329
00:35:19,369 --> 00:35:29,670
the supersu and superseded installed ok

330
00:35:29,670 --> 00:35:35,569
the prompt that there is no SEO banner
on your system partitions that the

331
00:35:35,569 --> 00:35:43,220
allies have been rooted so we just the
rush hour root exploit packet in injury

332
00:35:43,220 --> 00:35:54,259
injury application and end our exploit
is finished and we reboot the device and

333
00:35:54,260 --> 00:36:23,269
we don't mean it you can see the logo
into the Galaxy S six

334
00:36:23,269 --> 00:36:35,859
and then the phone is booted and we just
to open and application of an

335
00:36:35,859 --> 00:36:42,409
application with superuser privileges
and you can see that does supersu prompt

336
00:36:42,409 --> 00:36:49,079
and do what you like to give the
privileges that application that means

337
00:36:49,079 --> 00:37:00,230
we achieve permanent root on this day
and there

338
00:37:00,230 --> 00:37:08,490
based on the research of James fun
actually we send some devices without

339
00:37:08,490 --> 00:37:14,169
corrupting the one quarantine business
so yeah

340
00:37:14,170 --> 00:37:19,910
by the details that are not included

341
00:37:19,910 --> 00:37:31,470
talk so so our talk about the future and
so i think sixty for Android devices

342
00:37:31,470 --> 00:37:34,399
could be more secure

343
00:37:34,400 --> 00:37:43,720
yes so the first thing is that you know
went well reported bugs to communities

344
00:37:43,720 --> 00:37:48,830
some of the day's complaining that is
why this disappointment to the battle

345
00:37:48,830 --> 00:37:58,490
going into our Android devices is that
as 200 204 64 Android devices that

346
00:37:58,490 --> 00:38:05,029
slotting intelligent choice I see
because on the desktop PC and I mean

347
00:38:05,030 --> 00:38:11,660
every disrepute distribution of Linux PC
desktop the value of mister pouring into

348
00:38:11,660 --> 00:38:20,270
is that add value and dad follow with
child oh so you know the 64 bit

349
00:38:20,270 --> 00:38:27,900
processors currently only use 48 for
addressing and just disagree mapped

350
00:38:27,900 --> 00:38:30,960
definitely and if I cannot map it

351
00:38:30,960 --> 00:38:38,460
baptists list point to get a car crash
and I cannot arrive at the stock pot

352
00:38:38,460 --> 00:38:44,500
that free location so unearthing that we
can prevent the memory collision with

353
00:38:44,500 --> 00:38:51,120
this map maybe we can make some
separation between this man because they

354
00:38:51,120 --> 00:38:57,720
are continuing the data from the user
space for promoting efficiency we can

355
00:38:57,720 --> 00:39:03,490
separate them from the death hyena
colonel I mean so that's a no choice and

356
00:39:03,490 --> 00:39:09,100
the state-owned steamed about the
employee the case is they always do not

357
00:39:09,100 --> 00:39:11,529
employ the currents Android devices

358
00:39:11,530 --> 00:39:13,349
yeah so

359
00:39:13,349 --> 00:39:20,900
so I think they become harder for school
finance but when the area's protections

360
00:39:20,900 --> 00:39:28,630
appear caring then we have we may try
harder and have some countermeasures and

361
00:39:28,630 --> 00:39:36,710
two attacks against them and the by
posture and then we came proved the

362
00:39:36,710 --> 00:39:44,999
community to make the Arab improve the
security of the likely in thanks to make

363
00:39:44,999 --> 00:39:55,259
it more secure and have a Morse job
security support at last I want to

364
00:39:55,259 --> 00:40:02,589
mention that you just talk soup only
nominations about who she for lifetime

365
00:40:02,589 --> 00:40:13,229
achievement and she and just gives a
dead stop giving the bugs 22 the other

366
00:40:13,229 --> 00:40:20,308
members of came to him and support him
go ahead and analyses that about our

367
00:40:20,309 --> 00:40:26,239
pimp owns the universal rooster regions
is selected as the news of privilege

368
00:40:26,239 --> 00:40:33,819
escalation and also use the basic result
in the important results from Britain

369
00:40:33,819 --> 00:40:41,700
Tudor wishes selected as the nominees of
most innovative research but

370
00:40:41,700 --> 00:40:49,180
disappointed all of these three failure
last last

371
00:40:49,180 --> 00:40:55,290
luck next year

372
00:40:55,290 --> 00:40:59,190
acknowledgment

373
00:40:59,190 --> 00:41:05,430
thanks to you she jams and a lil C was a
nice QBE for their contributions to our

374
00:41:05,430 --> 00:41:12,500
roots product yet and the sexual
undertone lipper end the bitter from him

375
00:41:12,500 --> 00:41:21,589
for the our explorations on me and the
pictures is comes from Google's thank

376
00:41:21,589 --> 00:41:23,930
you all and restaurants are welcome

