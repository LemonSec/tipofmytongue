1
00:00:00,000 --> 00:00:05,220
I want to introduce today's session
broadcasting your attack security

2
00:00:05,220 --> 00:00:14,419
testing da be radio in cars may present
the real and Davis like very much like a

3
00:00:14,420 --> 00:00:19,570
good afternoon everyone please all
digested your lunch this is a great slot

4
00:00:19,570 --> 00:00:24,180
and everyone falls asleep hopefully I'll
be able to keep you awake so yeah we'd

5
00:00:24,180 --> 00:00:33,300
be talking about da be radio button
agenda first to what about myself I'm

6
00:00:33,300 --> 00:00:39,610
interested in entebbe radio talk quite a
lot of DA be theory at the beginning

7
00:00:39,610 --> 00:00:43,530
because it's important to understand the
context of some of the potential

8
00:00:43,530 --> 00:00:51,039
vulnerabilities in the protocol a bit
about how we broadcast da be the attack

9
00:00:51,039 --> 00:01:00,250
surface then I went about creating the
security testing tool that they give you

10
00:01:00,250 --> 00:01:07,290
a live demo of broadcasting daily radio
program work for a number of examples

11
00:01:07,290 --> 00:01:12,260
vulnerabilities and then talk about what
the implications of these top of

12
00:01:12,260 --> 00:01:17,009
vulnerabilities in vehicles are now one
thing before we get started that's

13
00:01:17,009 --> 00:01:23,830
important to point out this talk is all
about the development of a security

14
00:01:23,830 --> 00:01:30,829
testing tool and the capability that it
provides to identify vulnerabilities in

15
00:01:30,829 --> 00:01:37,770
JB radios I'm not gonna be talking about
specific vendors specific bugs in

16
00:01:37,770 --> 00:01:43,789
specific vendors products so there are
screenshots throughout the talk of

17
00:01:43,790 --> 00:01:46,180
different head units from vehicles

18
00:01:46,180 --> 00:01:50,649
the fact that they are in those
screenshots is not implying that there

19
00:01:50,649 --> 00:01:55,110
are particular vulnerabilities in those
chicken head units just got a range of

20
00:01:55,110 --> 00:02:03,908
head units and those were used for the
photographs so Davis and research

21
00:02:03,909 --> 00:02:10,119
director NTC very privileged position to
be technical hands on

22
00:02:10,119 --> 00:02:15,610
research director so I get to play with
cool stuff like best NCC group if you

23
00:02:15,610 --> 00:02:22,590
haven't heard of us we're a global cyber
security assurance specialist my own

24
00:02:22,590 --> 00:02:29,810
personal interests that I perceive in my
research primarily wired and wireless

25
00:02:29,810 --> 00:02:34,920
interface security and more and more of
the last couple of years I've been

26
00:02:34,920 --> 00:02:40,069
looking to soften a fun radio and how
could be used in a security context you

27
00:02:40,069 --> 00:02:43,399
may have seen some of the previous
research are presented it

28
00:02:43,400 --> 00:02:49,989
blockhouse colon cancer including some
USB testing stuff

29
00:02:49,989 --> 00:02:57,010
HDMI VGA testing tools earlier this year
comes out west the RAF testing

30
00:02:57,010 --> 00:03:05,608
methodology for the using radio in
security testing and research so why am

31
00:03:05,609 --> 00:03:13,269
i interested in da baby well at NCC
group we've been involved in security

32
00:03:13,269 --> 00:03:20,209
testing vehicles for a couple of years
now and whenever we talk about security

33
00:03:20,209 --> 00:03:26,690
vulnerabilities and vehicle systems said
he turned to some of our customers we

34
00:03:26,690 --> 00:03:32,109
end here ones they always ask the same
question can you remotely attack

35
00:03:32,109 --> 00:03:36,790
vehicles based on the protocols that are
available in the modern connected car

36
00:03:36,790 --> 00:03:43,510
and when people look at there are the
kind of remote attack surface of a

37
00:03:43,510 --> 00:03:51,470
vehicle traditionally they focused on
the short-range wi-fi and Bluetooth and

38
00:03:51,470 --> 00:04:00,190
then over the long range the mobile
network connectivity via GSM no one to

39
00:04:00,190 --> 00:04:05,819
date seems to have focused on dat radio
which is interesting I may well be

40
00:04:05,819 --> 00:04:11,980
because da B is only prevalent in
certain areas of the world so he is in

41
00:04:11,980 --> 00:04:15,720
in the UK and in parts of Europe

42
00:04:15,720 --> 00:04:20,510
but as virtually all modern vehicles
that roll off the production line

43
00:04:20,510 --> 00:04:25,940
certainly that get shipped in the UK
factory fitted with Debbie radios it

44
00:04:25,940 --> 00:04:33,840
seemed an obvious area of research to
investigate and I are going through a

45
00:04:33,840 --> 00:04:38,080
lot more detail later on that took off
in the head units that contain the

46
00:04:38,080 --> 00:04:42,159
radios which also called entertainment
system as you may have heard that that

47
00:04:42,160 --> 00:04:46,170
Somali interchangeably cues that the
term head unit and entertainment system

48
00:04:46,170 --> 00:04:52,550
throughout the talk but often these are
also connected to their core networks

49
00:04:52,550 --> 00:05:01,490
like the CAN bus that I live protocols
data protocols to communicate with

50
00:05:01,490 --> 00:05:07,990
cyber-physical systems like braking and
steering that kind of thing mentioned it

51
00:05:07,990 --> 00:05:12,640
doesn't appear to have a trick attracted
very much attention from the security

52
00:05:12,640 --> 00:05:19,200
research community and also defined
radios which you can use to perform this

53
00:05:19,200 --> 00:05:22,950
type of testing getting cheaper and
cheaper you may well have seen a lot of

54
00:05:22,950 --> 00:05:27,760
the talks back at this year have some
kind of component with with software

55
00:05:27,760 --> 00:05:35,380
defined radio they're getting more and
more common as a research tool so but if

56
00:05:35,380 --> 00:05:44,469
an overview of DA be it was designed as
a digital radio technology says

57
00:05:44,470 --> 00:05:50,680
primarily for broadcasting audio and as
a replacement for FM that we're all used

58
00:05:50,680 --> 00:05:58,040
to using its originally called Eureka
1470 European projects many many years

59
00:05:58,040 --> 00:06:06,150
ago so it was actually launched in 1995
in Norway surprised to find out how long

60
00:06:06,150 --> 00:06:12,729
the technologies actually been around
because it's only really started being

61
00:06:12,729 --> 00:06:19,030
deployed in in vehicles you know it in
in all modern vehicles over the last few

62
00:06:19,030 --> 00:06:26,419
years there was an upgrade to the
original da be standard in 2007

63
00:06:26,420 --> 00:06:35,420
school da B-plus and the the benefits of
upgrading to be a B-plus was it allowed

64
00:06:35,420 --> 00:06:43,940
for greater checking within the Prosecco
and therefore allowed for better quality

65
00:06:43,940 --> 00:06:52,700
audio unfortunately they not
interoperable protocols although you can

66
00:06:52,700 --> 00:06:58,409
have a DA be in the DA B-plus station
running alongside each other in a group

67
00:06:58,410 --> 00:07:04,640
of stations which is known as an
ensemble that 27th minute so the primary

68
00:07:04,640 --> 00:07:13,000
benefits a better signal quality many
morse different services can be sent

69
00:07:13,000 --> 00:07:19,190
over FM one of those services is called
electronic program guide which is

70
00:07:19,190 --> 00:07:27,730
similar to what you see on your TV TV
systems you'll set-top box or satellite

71
00:07:27,730 --> 00:07:33,850
receiver where you can see the program's
up to a week ahead and set things to

72
00:07:33,850 --> 00:07:36,950
record that kind of stuff so that that's
all supported by the DEA be

73
00:07:36,950 --> 00:07:47,360
go so first of all we got a dive into
modulation and transmission if you still

74
00:07:47,360 --> 00:07:49,530
digesting lunch and follow it

75
00:07:49,530 --> 00:07:54,010
asleep during this bit don't worry too
much because when I talk through how it

76
00:07:54,010 --> 00:07:57,880
all works on explain why you don't need
to know this but I decided I was going

77
00:07:57,880 --> 00:08:01,850
to cover for complete risks and shows
but many people who want to know how da

78
00:08:01,850 --> 00:08:08,930
B is actually transmitted so the reason
that they decided to implement da be

79
00:08:08,930 --> 00:08:19,590
over FM is FM seven suffers from a
interference called multipath which is

80
00:08:19,590 --> 00:08:25,039
where you get reflections off buildings
and reflections off of other objects and

81
00:08:25,040 --> 00:08:31,220
you get interference because that the
same signal is received at different

82
00:08:31,220 --> 00:08:34,990
times as a result of banks in all these
objects

83
00:08:34,990 --> 00:08:44,570
and DA be in order to cope with this
interfere in its uses a technique known

84
00:08:44,570 --> 00:08:50,140
as orthogonal frequency division
multiplexing multiplexing OFDM so

85
00:08:50,140 --> 00:08:56,580
essentially what you do is you have a
whole range of carriers in fact just

86
00:08:56,580 --> 00:09:07,020
over 1,500 carriers which are all spaced
very closely within the bandwidth and

87
00:09:07,020 --> 00:09:14,449
each of those carriers sends a very
small data rate it's actually a bit more

88
00:09:14,450 --> 00:09:21,370
complicated than OFDM its coded OFDM
Morsi p.m. because it includes forward

89
00:09:21,370 --> 00:09:29,459
error correction to to ensure that
there's a better quality signal and the

90
00:09:29,459 --> 00:09:37,520
the modulation scheme that's used within
this multiplexing approach is key PSK

91
00:09:37,520 --> 00:09:43,029
which is quadrature phase-shift keying
and as you can see in that diagram we've

92
00:09:43,029 --> 00:09:52,730
got their allies for four different
symbols 00 01 10 11 12 be represented by

93
00:09:52,730 --> 00:10:05,750
four different phases in the way that
they the modulation scheme is set up

94
00:10:05,750 --> 00:10:16,410
so the audio signals that are produced
digitized because I was at its a digital

95
00:10:16,410 --> 00:10:23,030
broadcast mechanism and multiplex
together with various other data

96
00:10:23,030 --> 00:10:27,900
services so although it's primarily
sending audio there are lots of other

97
00:10:27,900 --> 00:10:32,540
day to services are you concerned over
da B which is what makes it interesting

98
00:10:32,540 --> 00:10:38,740
and will go into the details of the
other digital services agency later but

99
00:10:38,740 --> 00:10:43,670
essentially they're all multiplex
together this forward error protection

100
00:10:43,670 --> 00:10:55,560
is applied to it but I think some
redundant bits by bits are divided into

101
00:10:55,560 --> 00:11:02,040
those one thousand five hundred and
thirty six pairs which are encoded

102
00:11:02,040 --> 00:11:13,709
differentially so based on the previous
symbol and each of those differentially

103
00:11:13,710 --> 00:11:21,120
encoded pairs of bits are used to define
the phase of a QPSK character carrier so

104
00:11:21,120 --> 00:11:28,810
like I showed and that the phase diagram
those are the big as and you specify the

105
00:11:28,810 --> 00:11:38,030
different phase for each of those within
the modulation scheme so that all of

106
00:11:38,030 --> 00:11:39,000
that together

107
00:11:39,000 --> 00:11:49,990
forms 1536 carriers in a large wide
bandwidth and that process is repeated

108
00:11:49,990 --> 00:11:51,430
again and again

109
00:11:51,430 --> 00:11:56,099
symbol why symbol so

110
00:11:56,100 --> 00:12:01,750
just to explain as a result of that as a
result of having lots and lots of

111
00:12:01,750 --> 00:12:06,420
different carriers are all very low
bandwidth you end up with the total

112
00:12:06,420 --> 00:12:13,349
bandwidth of just over one megabit will
make the best second I talked about it

113
00:12:13,350 --> 00:12:18,579
multiplexing and the fact that you've
got these different audio and digital

114
00:12:18,579 --> 00:12:24,258
data services that need to be
multiplexed together they are

115
00:12:24,259 --> 00:12:28,860
multiplexed in something called the main
service channel and I would go see this

116
00:12:28,860 --> 00:12:32,949
you'll see that baby is horrible complex
protocol and there's lots and lots to it

117
00:12:32,949 --> 00:12:37,019
I'm just scraping the surface here with
some of this stuff you know I could

118
00:12:37,019 --> 00:12:40,769
spend all day talking about the the
particle spectra I'm not going to talk

119
00:12:40,769 --> 00:12:44,630
about the stuff is important so it is
important to go through these bits first

120
00:12:44,630 --> 00:12:54,139
to like this single to maintain the
shuttle which is 50 55 and roughly bets

121
00:12:54,139 --> 00:13:00,579
what are known as common in to leave
frames ok so each of those frames is

122
00:13:00,579 --> 00:13:03,400
divided into time slots

123
00:13:03,400 --> 00:13:09,860
and you have these things called
subchannels which are repetitive and the

124
00:13:09,860 --> 00:13:20,760
data each of these six is transmitted in
18 consecutive symbol blocks ok so the

125
00:13:20,760 --> 00:13:26,830
first of those you synchronization and
the remaining can contain useful

126
00:13:26,830 --> 00:13:32,100
information for the receiver so you got
the multiplex configuration information

127
00:13:32,100 --> 00:13:38,080
or the information about what's in that
that multiplexer the types of data the

128
00:13:38,080 --> 00:13:43,370
names of the ensemble which the
collection of channels and all kinds of

129
00:13:43,370 --> 00:13:48,710
configuration information and it also
contains this thing called the fast

130
00:13:48,710 --> 00:13:53,310
information channel is a bunch of other
channels that are used synchronization

131
00:13:53,310 --> 00:14:03,680
housekeeping so typically when you have
a DA be transmitter you have to separate

132
00:14:03,680 --> 00:14:09,699
components hardware components you'll
have the multiplexer and I'll be

133
00:14:09,700 --> 00:14:15,590
connected to the moderator and
transmitter the interface between those

134
00:14:15,590 --> 00:14:21,230
two is called the ensemble transport
interface and the reason that they're

135
00:14:21,230 --> 00:14:27,450
separated is quite often in a broadcast
scenario those two hardware components

136
00:14:27,450 --> 00:14:36,240
may actually be in different physical
locations so the ETI transport is

137
00:14:36,240 --> 00:14:44,330
actually sent over a anyone line 22
megabit synchronize data stream line and

138
00:14:44,330 --> 00:14:50,850
if any of you are aware of transmission
data transmission protocols it's a

139
00:14:50,850 --> 00:14:54,760
pretty standard protocol for
transmitting to make a bit synchronous

140
00:14:54,760 --> 00:15:03,010
data there's a standard associated with
hi this is all formed and there's

141
00:15:03,010 --> 00:15:10,189
there's an open source tool that allows
you to actually look at this stuff

142
00:15:10,190 --> 00:15:18,460
so within that fast information channel
which is the first kind of layer of

143
00:15:18,460 --> 00:15:25,140
multiplex data are going to drill down a
drill down and explained that we need to

144
00:15:25,140 --> 00:15:30,560
go through this to get to the bits that
are useful for security testing so the

145
00:15:30,560 --> 00:15:34,630
purpose of the fast information channel
is when you first turn on your da be

146
00:15:34,630 --> 00:15:40,110
radio it needs to know specific bits of
information to be able to choose in and

147
00:15:40,110 --> 00:15:47,740
be able to present you with the services
that are available so this channel is

148
00:15:47,740 --> 00:15:53,130
divided up into a tan is fast
information blocks each fast information

149
00:15:53,130 --> 00:16:01,020
block contains a number of fast
information groups so these screenshots

150
00:16:01,020 --> 00:16:07,300
and I've got taken from the standard the
standards are large and complex and

151
00:16:07,300 --> 00:16:14,000
that's important because when I come to
talking about potential vulnerabilities

152
00:16:14,000 --> 00:16:18,100
the complexities key

153
00:16:18,100 --> 00:16:28,040
so there are numbers associated with
these fast information groups which

154
00:16:28,040 --> 00:16:35,339
represent the the type of them so for
example some of the other labels labels

155
00:16:35,339 --> 00:16:41,230
are things like when you're tuned to a
channel on your DOB radio and tell her

156
00:16:41,230 --> 00:16:46,449
she the ensemble night so the the group
of channels so in the UK one of the

157
00:16:46,449 --> 00:16:53,209
ensemble's is national one which is
going to the BBC radio stations and

158
00:16:53,209 --> 00:17:00,979
there but that the label is the name of
the ensemble in the name of the name of

159
00:17:00,980 --> 00:17:06,789
each of those radio stations within the
ensemble so you'll have cigs represent

160
00:17:06,789 --> 00:17:18,060
those labels and other that represent
other configuration information

161
00:17:18,060 --> 00:17:25,790
and just to make it even more
complicated than a bit deeper each type

162
00:17:25,790 --> 00:17:33,760
has a whole bunch of extensions which
provide specific services service

163
00:17:33,760 --> 00:17:39,379
information so I so basically each of
these figure extensions is like a

164
00:17:39,380 --> 00:17:52,690
function of service function so the
service information features which

165
00:17:52,690 --> 00:17:58,020
signal using different types as a few of
them to just demonstrate the kinds of

166
00:17:58,020 --> 00:18:05,000
things that they used for service
linking information for example is a

167
00:18:05,000 --> 00:18:11,530
function and that is where if you're
driving in your car you're listening to

168
00:18:11,530 --> 00:18:19,030
a radio station and the audio associated
with that radio station as you move into

169
00:18:19,030 --> 00:18:24,920
a different geographic location is
provided on a different frequency your

170
00:18:24,920 --> 00:18:30,830
radio will have a database of
information associated with it will

171
00:18:30,830 --> 00:18:36,470
basically know that as you move out of
one region into another to seamlessly

172
00:18:36,470 --> 00:18:41,750
transfer over to the different
frequencies so that you're getting the

173
00:18:41,750 --> 00:18:45,360
correct audio stream and you have
noticed the fact that the signal drops

174
00:18:45,360 --> 00:18:54,149
and then picks up again that service
linking lots and lots of these providing

175
00:18:54,150 --> 00:19:00,440
lots of different functionality within
the underlying protocol and as we'll see

176
00:19:00,440 --> 00:19:04,980
as we go on some of them have the
potential for introducing security

177
00:19:04,980 --> 00:19:11,430
vulnerabilities and other one worth
mentioning there actually is

178
00:19:11,430 --> 00:19:15,720
transmitter identification information
databases the data base that gets

179
00:19:15,720 --> 00:19:22,180
downloaded to the to the receiver in
your car with physical geo location

180
00:19:22,180 --> 00:19:28,690
information of the transmitters so
another large globalData's getting sent

181
00:19:28,690 --> 00:19:30,850
to you receive it process

182
00:19:30,850 --> 00:19:37,260
us now

183
00:19:37,260 --> 00:19:44,960
user application information which is
one of these big extensions is where I

184
00:19:44,960 --> 00:19:48,660
started thinking on this is quite
interesting you know that this is

185
00:19:48,660 --> 00:19:52,190
something that you know I can see some
definite potential for security

186
00:19:52,190 --> 00:19:57,120
vulnerabilities here and that's the fact
that within da baby you're able to

187
00:19:57,120 --> 00:20:02,399
transmit whole bunch of different
protocols over the top of it can be the

188
00:20:02,400 --> 00:20:14,760
carrier for for example slideshow now is
multimedia object transfer transport

189
00:20:14,760 --> 00:20:19,480
which is yet another protocol for which
there is yet another complicated suspect

190
00:20:19,480 --> 00:20:26,440
that explains how its encoded but
essentially your data is fed into your

191
00:20:26,440 --> 00:20:34,020
multiplex along with the audio that
you're transmitting and slideshow allows

192
00:20:34,020 --> 00:20:45,620
you to send PNG and JPG X over da be and
that's typically used for album artwork

193
00:20:45,620 --> 00:20:50,790
for example in conjunction with the
songs being played or maybe a photograph

194
00:20:50,790 --> 00:20:59,080
of the current deejay this on-air so
that's pretty interesting thing you've

195
00:20:59,080 --> 00:21:06,070
got other things like not broadcast
website yet another that you can

196
00:21:06,070 --> 00:21:12,100
download and what what broadcast website
does by the way to Taipei's directly

197
00:21:12,100 --> 00:21:23,439
lifted from the back online broadcast
website what it does is your radio in

198
00:21:23,440 --> 00:21:28,350
your car your head unit is provided with
a collection of websites that I

199
00:21:28,350 --> 00:21:36,459
downloaded an econ then locally brian is
to those web pages on the head unit but

200
00:21:36,460 --> 00:21:41,400
it's all part of the DA b-spec what I
also forgot electron

201
00:21:41,400 --> 00:21:45,020
program guide yet another protocol job

202
00:21:45,020 --> 00:21:52,660
the ability to send job applications
over da be even video play video on this

203
00:21:52,660 --> 00:21:53,330
and why

204
00:21:53,330 --> 00:22:00,689
yeah so lots and lots of interesting
stuff that you can send over the top of

205
00:22:00,690 --> 00:22:10,820
the program associated data is something
that's within the main da b-spec and

206
00:22:10,820 --> 00:22:18,639
it's something that you're listening to
this you've used to dat radio it enables

207
00:22:18,640 --> 00:22:24,060
me to send data directly associated with
the current audio stream so for example

208
00:22:24,060 --> 00:22:30,570
you are regularly see the name of the
current track that's being played on the

209
00:22:30,570 --> 00:22:36,100
receiving end that sentence program
associated data cuz its synchronized to

210
00:22:36,100 --> 00:22:37,419
what you're listening to

211
00:22:37,420 --> 00:22:43,630
in fact that day be slideshow as well is
associated danger in the way that it's

212
00:22:43,630 --> 00:22:50,870
transmitted that the data that you that
you see is presented on the screen like

213
00:22:50,870 --> 00:22:56,989
the current track or maybe information
about the current station that you're

214
00:22:56,990 --> 00:23:05,970
listening to send him what's known as
DLS label segment and within DLS you can

215
00:23:05,970 --> 00:23:12,770
send any text you like and a whole bunch
of DIF international character sets and

216
00:23:12,770 --> 00:23:22,330
it gets rented by the head unit and
displayed to the user ok so you probably

217
00:23:22,330 --> 00:23:30,480
got the idea about da be hearing more
spec stuff too much detail anyway so a

218
00:23:30,480 --> 00:23:36,140
very simple DAV transmitter as I
mentioned you have this box the

219
00:23:36,140 --> 00:23:42,480
multiplexer which takes in the
information that they say and audio

220
00:23:42,480 --> 00:23:48,920
multiplexes it together to form this
ensemble template to face sentencing

221
00:23:48,920 --> 00:23:53,910
modulator and then transmitted in this
case it's gonna be transmitted using a

222
00:23:53,910 --> 00:23:54,900
software-defined

223
00:23:54,900 --> 00:24:03,720
so how do we go back broadcasting DMB
all of that stuff at the beginning

224
00:24:03,720 --> 00:24:09,080
Sunday pretty complicated and it is
pretty complicated and fortunately for

225
00:24:09,080 --> 00:24:15,889
us all the hard work already being done
because the guys open digital radio talk

226
00:24:15,890 --> 00:24:22,470
about actually implemented the hard
stuff and an open-source Bab transmitter

227
00:24:22,470 --> 00:24:32,480
so using ODR dab MUX we can multiplex up
the signals that we provide it and then

228
00:24:32,480 --> 00:24:40,220
connect into that mode which will
communicate with the the STR and

229
00:24:40,220 --> 00:24:49,100
actually transmitted da be radio there's
also an extra component FTK AC down plus

230
00:24:49,100 --> 00:24:56,360
what that allows you to do is leverage
the functionality of the a B-plus which

231
00:24:56,360 --> 00:25:05,060
will transmit in the higher quality
audio which is a see the audio protocol

232
00:25:05,060 --> 00:25:12,870
is used with with a B-plus with
traditional da be used to audio encoding

233
00:25:12,870 --> 00:25:24,469
the softphone radio wheezing is in its
b200 she's pretty flexible to lasting

234
00:25:24,470 --> 00:25:36,770
quality with black leather talks costs
around by CH 650 700 USD also think one

235
00:25:36,770 --> 00:25:40,420
thing is really worth mentioning this
point is legal considerations now

236
00:25:40,420 --> 00:25:48,510
obviously you don't want to be
broadcasting DMB radio to add especially

237
00:25:48,510 --> 00:25:56,650
if it's you know high power and you're
gonna in any way affect the legitimate

238
00:25:56,650 --> 00:26:03,000
debut radio signals it's against the law
and it's obviously very responsible so

239
00:26:03,000 --> 00:26:11,680
during the research i cant find myself
to transmitting the virus cable 22

240
00:26:11,680 --> 00:26:17,950
whatever received I was connected to
rather than actually transmitting to

241
00:26:17,950 --> 00:26:22,690
where there were a couple of situations
where I I did transmitted to air within

242
00:26:22,690 --> 00:26:28,980
a Faraday cage so we've got some small
fire their cages at work and but most of

243
00:26:28,980 --> 00:26:35,970
the time what I'm using is an attenuator
which I'm connected the transmit port on

244
00:26:35,970 --> 00:26:42,010
the CSTR and the attenuator reduces the
signal level to emulate the signal path

245
00:26:42,010 --> 00:26:46,220
through the air so I can physically
connect the transmitter to the receiver

246
00:26:46,220 --> 00:26:56,380
and not worry about actually
broadcasting anything illegally

247
00:26:56,380 --> 00:27:01,630
so the day be attack surface often
hinted at various bits and pieces along

248
00:27:01,630 --> 00:27:08,840
the way about where there may be
potential security vulnerabilities the

249
00:27:08,840 --> 00:27:17,270
fake data within the PRI because of its
sheer complexity needs to be passed and

250
00:27:17,270 --> 00:27:24,420
processed by the receiver so
manipulating that and crafting elements

251
00:27:24,420 --> 00:27:29,290
of that to try and generate memory
corruption vulnerability in the receiver

252
00:27:29,290 --> 00:27:32,300
in the policy is obvious place to start

253
00:27:32,300 --> 00:27:38,639
similarly with some of the other
protocols that work alongside the kind

254
00:27:38,640 --> 00:27:44,060
of underlying DAV protocol like moths
that multimedia object transfer being

255
00:27:44,060 --> 00:27:50,330
able to manipulate and specially crafted
elements of header data within a

256
00:27:50,330 --> 00:27:54,500
protocol could potentially trigger
security vulnerabilities through to

257
00:27:54,500 --> 00:28:06,390
memory corruption bugs looking at the
the DLS and DA be labels that I

258
00:28:06,390 --> 00:28:11,340
mentioned those get rendered by the head
unit and displayed now over these modern

259
00:28:11,340 --> 00:28:20,010
entertainment systems will render text
in different ways depending on what that

260
00:28:20,010 --> 00:28:23,870
text is being processed as I'm sure a
lot of you be aware of when you'll

261
00:28:23,870 --> 00:28:28,560
rendering and data stream as a whole
range of potential vulnerabilities there

262
00:28:28,560 --> 00:28:33,280
from things like

263
00:28:33,280 --> 00:28:41,610
injection bugs to string bugs all those
kind of things so that's obviously an

264
00:28:41,610 --> 00:28:46,189
interesting area and of course you've
got your audio stream your images

265
00:28:46,190 --> 00:28:54,310
potentially video streams apps Java apps
you can send rolled a torn IP data over

266
00:28:54,310 --> 00:28:58,990
there as well as lots and lots of things
that you could potentially send would

267
00:28:58,990 --> 00:29:04,350
need to get past and processed by the
receiver and could trigger security

268
00:29:04,350 --> 00:29:06,990
vulnerabilities

269
00:29:06,990 --> 00:29:12,830
so how do we create the security testing
tool so we did is we took these open

270
00:29:12,830 --> 00:29:19,800
source products and added kind of looks
into them that allowed us to manipulate

271
00:29:19,800 --> 00:29:24,780
the data along the way at all

272
00:29:24,780 --> 00:29:31,129
called not encoder which actually
understands and produces not encoded

273
00:29:31,130 --> 00:29:36,870
data that's provided to the multiplex
and what we can do is we can provide

274
00:29:36,870 --> 00:29:46,209
real estate and slideshow data to the
Martin coda program via 558 gets

275
00:29:46,210 --> 00:29:52,440
consumed by that and added into the
multiplex and then I'll I use the most

276
00:29:52,440 --> 00:30:00,429
data so that the Dallas and slideshow
information to be sent over da be so you

277
00:30:00,429 --> 00:30:06,650
manipulated or modified rather than
opting out at all so we're sending the

278
00:30:06,650 --> 00:30:14,090
data off IRA TCP socket to a separate
process in Python and it's basically a

279
00:30:14,090 --> 00:30:14,790
man in the middle

280
00:30:14,790 --> 00:30:22,580
today terror and manipulating the the
protocol on the fly before the data is

281
00:30:22,580 --> 00:30:32,428
then sent on to the multiplexer and the
ODR top marks open source product was

282
00:30:32,429 --> 00:30:38,540
modified in a similar way at the
appropriate point with within the the

283
00:30:38,540 --> 00:30:44,940
software they the data stream is
siphoned off a TCP sockets two separate

284
00:30:44,940 --> 00:30:53,630
manipulator that the modified that data
based on a whole bunch of first cases

285
00:30:53,630 --> 00:31:02,460
so they further which is called double
enables each Thursday less data so you

286
00:31:02,460 --> 00:31:09,470
know this kind of text based stuff this
is rendered by the head unit that allows

287
00:31:09,470 --> 00:31:15,560
you to fuzz JPEG and PNG these again
viral FIFO you can feel the democracy

288
00:31:15,560 --> 00:31:24,520
and the ensemble data as a result of the
hooks that we put into the open source

289
00:31:24,520 --> 00:31:31,460
product there's a bunch of planned
capabilities as well we want to add so

290
00:31:31,460 --> 00:31:37,450
with the open source only our top marks
it doesn't support all of the

291
00:31:37,450 --> 00:31:43,210
functionality of of DA be so there's a
whole bunch of extra elements of the

292
00:31:43,210 --> 00:31:50,030
protocol that we get out into their
support and also as well as the the

293
00:31:50,030 --> 00:31:52,280
protocols that could be sent over it

294
00:31:52,280 --> 00:31:57,950
the underlying Bab protocols some of
those on are currently supported so the

295
00:31:57,950 --> 00:32:09,000
intention is to add that capability as
well as a screenshot of the black box

296
00:32:09,000 --> 00:32:20,080
transmitting da be signal vaina y into
the back of the head unit and there's a

297
00:32:20,080 --> 00:32:26,000
high-level picture of the connectivity
between the different components so we

298
00:32:26,000 --> 00:32:30,750
think back to the original diagram of a
transmitter where we had a multiplexer

299
00:32:30,750 --> 00:32:40,040
and modulator now we've got the the
first sending the data streams for DLS

300
00:32:40,040 --> 00:32:51,270
sis is slideshow into the molten coda so
you can I just manipulate those

301
00:32:51,270 --> 00:32:59,010
those particular project goals so send
lots and lots and lots of specially

302
00:32:59,010 --> 00:33:06,480
crafted SLs sorry pls text data or you
can manipulate the actual underlying

303
00:33:06,480 --> 00:33:21,410
protocol that's being used to that end
to the multiplex so let's do a demo

304
00:33:21,410 --> 00:33:29,500
because watching running is like
watching paint dry but I'll just give

305
00:33:29,500 --> 00:33:36,030
you an example of me transmitting
something night because I've got an

306
00:33:36,030 --> 00:33:41,190
extended screen rather than a duplicated
screen hopefully i'm saying is what

307
00:33:41,190 --> 00:33:48,800
you're saying but you just to give you
an example of the way that the ODR top

308
00:33:48,800 --> 00:33:55,810
marks is setup and configured you can
see within this simple configuration

309
00:33:55,810 --> 00:34:02,220
file that he he set up an ensemble you
set up services within the ensemble

310
00:34:02,220 --> 00:34:08,889
channels and subchannels and you know I
mentioned labels within the protocol the

311
00:34:08,889 --> 00:34:13,230
way that the labels are encoded you can
see that you specify the labels

312
00:34:13,230 --> 00:34:32,080
associated with services ensembles
within this text file

313
00:34:32,080 --> 00:34:39,639
what we've got here is the laptop that
you're looking at the screen out is

314
00:34:39,639 --> 00:34:43,270
running adab received

315
00:34:43,270 --> 00:34:51,340
open-source prayed da be received its
using an RTL SDR dongle which is plugged

316
00:34:51,340 --> 00:34:59,830
in here and that's connected via a
physical cable to the transmit I put

317
00:34:59,830 --> 00:35:01,170
this STR

318
00:35:01,170 --> 00:35:07,630
got here so I'm a city gonna be
transmitting from the radio by the cable

319
00:35:07,630 --> 00:35:14,300
which is emulating the signal path of
the accident be transmitting to the

320
00:35:14,300 --> 00:35:43,360
receiver which you looking out on the
screen there so I started

321
00:35:43,360 --> 00:35:48,890
rights so you can see there there were
actually receiving a signal now says

322
00:35:48,890 --> 00:35:57,299
receiving a radio signal called security
testing with an ensemble called NCC for

323
00:35:57,300 --> 00:36:09,440
just the audio listen to what's playing

324
00:36:09,440 --> 00:36:27,300
now I mentioned da les informations at
12 cents and BLS data here in this box

325
00:36:27,300 --> 00:36:41,980
here black hat oK so it's now and here
comes an image of this is using the

326
00:36:41,980 --> 00:36:55,220
slideshow protocol to send image data

327
00:36:55,220 --> 00:37:02,589
ok so you can see there's a JPEG image I
sent via the Bab transmission over the

328
00:37:02,590 --> 00:37:10,859
air now obviously took a little while to
transmit that and if you gonna be

329
00:37:10,859 --> 00:37:17,460
furthering asking to take a long time
you can with the images that we've been

330
00:37:17,460 --> 00:37:22,430
using for authorizing they're actually
tiny tiny jpegs which takes split second

331
00:37:22,430 --> 00:37:26,848
to send over the air but it i mean it's
still quite slow idea if you are facing

332
00:37:26,849 --> 00:37:31,800
a real head unit what you'd want to do
is you'd want to identify what the image

333
00:37:31,800 --> 00:37:36,650
processing library was three reverse
engineering the firmware does it offline

334
00:37:36,650 --> 00:37:41,000
and then demo it's using a proof of
concept using this technique to send it

335
00:37:41,000 --> 00:37:44,830
over the air to demonstrate that the
attack with work

336
00:37:44,830 --> 00:37:53,730
vdab

337
00:37:53,730 --> 00:38:01,600
and as you can see with the BLS data in
this instance it's literally just

338
00:38:01,600 --> 00:38:10,210
printing the taxes not rendering it in
any particular way but on some of the

339
00:38:10,210 --> 00:38:14,710
head unit so we've looked at they are a
bit more creative about the way but

340
00:38:14,710 --> 00:38:20,520
they're rendering that and it's
generated or cons of unusual results

341
00:38:20,520 --> 00:38:32,380
with the way that Rick Astley makes a
parent gets everywhere so with DLS data

342
00:38:32,380 --> 00:38:36,119
you can send secret injection cross-site
scripting

343
00:38:36,119 --> 00:38:41,350
his head units are connected to the
Internet remember these days and it's

344
00:38:41,350 --> 00:38:53,509
generated interesting results right

345
00:38:53,509 --> 00:39:05,109
mentioned there MA slideshow JPEG PNG
need to be rendered by the receiver

346
00:39:05,109 --> 00:39:11,759
never been plenty of documented
vulnerabilities in image processing and

347
00:39:11,759 --> 00:39:18,019
passing libraries many of his head units
are running operating systems like UN X

348
00:39:18,019 --> 00:39:23,749
and Linux and using open source image
passing libraries to process the

349
00:39:23,749 --> 00:39:32,979
slideshow data when it gets rendered on
the screen I mentioned about the the

350
00:39:32,979 --> 00:39:40,158
ensemble label and Pat data buffer
overflows a pretty unlikely associated

351
00:39:40,159 --> 00:39:45,709
with devastated because there is a hard
limit limit within the protocol and you

352
00:39:45,709 --> 00:39:51,769
cannot physically transmit more than a
certain number of characters however

353
00:39:51,769 --> 00:39:58,299
there is a definite possibility of
things like format string bugs when data

354
00:39:58,299 --> 00:40:05,788
is being stored off or the way that it's
physically being printed to the screen

355
00:40:05,789 --> 00:40:22,729
using an insecure functions like a
sprinter light so there's the potential

356
00:40:22,729 --> 00:40:28,118
of secret injection in some scenarios
certainly if the head unit is touring

357
00:40:28,119 --> 00:40:35,369
the list of the radio stations the DA be
stations and ensemble names that you've

358
00:40:35,369 --> 00:40:41,919
June 20 thanking stored on a database
and you provide a label which contains

359
00:40:41,919 --> 00:40:47,509
sequel there's the possibility seek
rejection that way and I mentioned by

360
00:40:47,509 --> 00:40:51,569
the fact that some of the head unit
head-to-head anticipated the internet so

361
00:40:51,569 --> 00:40:58,339
there's the possibility of cross site
scripting databases of information I

362
00:40:58,339 --> 00:41:01,609
took my service linking at the beginning
and also transmitter identification

363
00:41:01,609 --> 00:41:04,740
information these are both databases

364
00:41:04,740 --> 00:41:10,430
information that get downloaded and
stored within memory regions on the head

365
00:41:10,430 --> 00:41:16,109
unit there is certainly the potential
for buffer overflows in this scenario

366
00:41:16,110 --> 00:41:23,890
where fixed size memory areas have been
allocated download these they are

367
00:41:23,890 --> 00:41:28,089
supposed to always be the same size but
of course if we put the ability to

368
00:41:28,090 --> 00:41:33,270
manipulate data the developers should
have made assumptions about the size of

369
00:41:33,270 --> 00:41:41,090
the data that much he gets supplied to
them now implications for other vehicle

370
00:41:41,090 --> 00:41:46,580
systems you know when I've been talking
to people about this research they would

371
00:41:46,580 --> 00:41:50,119
say yeah but you know ok you gain access
to entertainment system what can you

372
00:41:50,119 --> 00:41:54,140
then do shirley is not actually
connected to any other vehicle systems

373
00:41:54,140 --> 00:42:00,509
well it actually amazed us the number of
different architectures you see in

374
00:42:00,510 --> 00:42:06,869
vehicles and the different ways that he
is hedging its have been designed to

375
00:42:06,869 --> 00:42:10,950
integrate with in love with other
networks within the vehicle so we've

376
00:42:10,950 --> 00:42:14,790
seen situations where the campus is
directly connected to the head unit

377
00:42:14,790 --> 00:42:22,700
we've seen situations where you go via
the bus to connect to the network keep

378
00:42:22,700 --> 00:42:29,049
us on one particular example of a
vulnerability that we find on a head

379
00:42:29,050 --> 00:42:34,760
unit we we actually managed to gain
access to a viral wifi attack but the

380
00:42:34,760 --> 00:42:38,900
bus was bound to all the network
interfaces and therefore accessible via

381
00:42:38,900 --> 00:42:45,540
WiFi and because of the way that had
been designed they wanted to enable the

382
00:42:45,540 --> 00:42:51,560
user to be able to turn on and off the a
dysfunction ed arses advanced driver

383
00:42:51,560 --> 00:42:57,410
assistance systems says things like
advanced electronic braking sorry about

384
00:42:57,410 --> 00:43:01,980
the emergency braking adaptive cruise
control engg persist blind spot

385
00:43:01,980 --> 00:43:08,260
monitoring monitoring so if you if you
as a driver have enabled advanced

386
00:43:08,260 --> 00:43:13,030
emergency braking which essentially
looks to see where they are you know

387
00:43:13,030 --> 00:43:16,100
with a safe distance of an object in
front of you

388
00:43:16,100 --> 00:43:24,950
and somebody can connect via wireless
vulnerability like da be for example and

389
00:43:24,950 --> 00:43:31,850
they can then send a direct message from
that entertainment system to disable one

390
00:43:31,850 --> 00:43:36,170
of these ideas features that's pretty
serious and that's something that we've

391
00:43:36,170 --> 00:43:38,680
seen in the real world

392
00:43:38,680 --> 00:43:48,549
the fact that the ABC's broadcast of his
leaders that the prospect of attacking

393
00:43:48,550 --> 00:43:54,700
many vulnerable many vulnerable vehicle
simultaneously so you could have two

394
00:43:54,700 --> 00:43:59,649
different scenarios here one where there
is a very high power transmitted to

395
00:43:59,650 --> 00:44:03,300
overpower signal what's already there so
we know that everybody's changed into a

396
00:44:03,300 --> 00:44:09,360
popular radio station you can overpower
that with a very high patronage so that

397
00:44:09,360 --> 00:44:14,050
they get into you into range of your
transmission their radios gonna stop the

398
00:44:14,050 --> 00:44:19,510
camp you'll signals a stealthy and it
would get picked up very quickly by the

399
00:44:19,510 --> 00:44:24,240
authorities much healthier way of doing
it but he's a low power transmitter use

400
00:44:24,240 --> 00:44:31,750
a completely new radio station on a
frequency discovery and used and choose

401
00:44:31,750 --> 00:44:38,650
your radio station to entice your target
audience to tune in and most modern da

402
00:44:38,650 --> 00:44:43,650
be received as a constantly reaching to
look for new stations so spot yours and

403
00:44:43,650 --> 00:44:51,270
presented to the user to change so just
consumed conclusions da bees obvious

404
00:44:51,270 --> 00:44:55,610
remains intact reach into a vehicle that
hasn't been investigated prior to this

405
00:44:55,610 --> 00:45:00,690
research not publicly anyway using a
single attack you broadcast many targets

406
00:45:00,690 --> 00:45:06,320
there are lots of different protocols
that you sent over the top of DA be

407
00:45:06,320 --> 00:45:15,290
which and the Quartier be protocols can
also be attacked and as a final thought

408
00:45:15,290 --> 00:45:20,759
how many da be radio developers have
made the assumption that the broadcast

409
00:45:20,760 --> 00:45:25,460
later is to be trusted

410
00:45:25,460 --> 00:45:35,930
bedtime reading for you thank you very
much

411
00:45:35,930 --> 00:46:20,799
questions

412
00:46:20,800 --> 00:46:46,930
one of the services offered by the fold
I don't think as an individual user you

413
00:46:46,930 --> 00:46:54,029
could disable that feature within your
entertainment system i mean you could

414
00:46:54,030 --> 00:46:57,910
decide not to listen to the radio and
that would disable it

415
00:46:57,910 --> 00:47:04,120
well if you're not changed into a radio
station and none of these potential

416
00:47:04,120 --> 00:47:08,640
attacks could be formed you actually
need to be tuned in for it to actually

417
00:47:08,640 --> 00:47:13,980
be processing the data that's being
provided on that radio station has 20

418
00:47:13,980 --> 00:47:18,360
paranoid you can just keep your regular
daily radio turned off by Alice at my

419
00:47:18,360 --> 00:47:25,500
office I never listen to radio ok so ok
says actually built in all the new cars

420
00:47:25,500 --> 00:47:31,600
were you saying and if so you can be
used to use your car even da be disabled

421
00:47:31,600 --> 00:47:37,470
right yeah you don't drive in everything
absolutely braking system all that would

422
00:47:37,470 --> 00:47:46,629
still work in one of your four slides
you mentioned that could be used as a

423
00:47:46,630 --> 00:47:53,570
carrier for JAMA mentioned in their
receivers actually have a GBM so I can

424
00:47:53,570 --> 00:47:59,800
actually run the code I haven't actually
find an implementation of that yet

425
00:47:59,800 --> 00:48:07,920
that's in the actual specification so
one of the types of the multimedia

426
00:48:07,920 --> 00:48:11,800
object transfer data types of two
specified in the project on one of those

427
00:48:11,800 --> 00:48:16,490
types is Java but I've never seen it
actually used in the wild

428
00:48:16,490 --> 00:48:17,410
thank God for that

429
00:48:17,410 --> 00:48:24,170
the next question is ok see you could
send down some sort of websites that

430
00:48:24,170 --> 00:48:28,770
presumably would have the option of
running JavaScript or something

431
00:48:28,770 --> 00:48:35,420
could that be used as a way to contact
her connect to the server so as you as

432
00:48:35,420 --> 00:48:43,910
you mentioned is open to all interfaces
yeah we can see that changing like the

433
00:48:43,910 --> 00:48:50,290
Chrysler update fixes that yeah but if
you have code running on the head unit

434
00:48:50,290 --> 00:48:54,940
then it's gonna be able to talk back to
localhost yes so would that be attack

435
00:48:54,940 --> 00:49:01,230
vector then download web page that has a
link to localhost yep certainly i mean

436
00:49:01,230 --> 00:49:05,760
if if you've got code running on the
head unit itself then you gonna be able

437
00:49:05,760 --> 00:49:12,750
to talk to those the bus interfaces if
they're than talking on 22 can there are

438
00:49:12,750 --> 00:49:21,590
ways of authenticating the bus however
its user base and if you are running the

439
00:49:21,590 --> 00:49:25,170
user level that runs the whole
entertainment system it's probably gonna

440
00:49:25,170 --> 00:49:32,280
be rigged so it's gonna be game over
anyway so great thank you

441
00:49:32,280 --> 00:49:41,860
radio ok for the presentation very
interesting

442
00:49:41,860 --> 00:49:51,840
the 2000 resided in any crashing
protested or CODIS I have identified

443
00:49:51,840 --> 00:49:57,510
some vulnerabilities and those have been
communicated to the various vendors I

444
00:49:57,510 --> 00:50:06,130
haven't done a thorough investigation of
a gene it's different every am in the

445
00:50:06,130 --> 00:50:10,610
process of setting up an entertainment
test lab at NCC group so we're gonna

446
00:50:10,610 --> 00:50:16,970
have a lot more head units to test so
hopefully in the future I got provide a

447
00:50:16,970 --> 00:50:37,680
lot more information about how
widespread the abilities in da be ok

448
00:50:37,680 --> 00:50:43,540
higher plane how would you debug the
crash on a headunit bikers derogatory

449
00:50:43,540 --> 00:50:50,380
can conduct in their appt with i mean it
depends on the operating system is

450
00:50:50,380 --> 00:50:54,860
running on the head unit there's lots of
different ones are used for next to

451
00:50:54,860 --> 00:51:06,040
learn more proprietary operating systems
that are running what we tend to do to

452
00:51:06,040 --> 00:51:10,830
try and recalls the bugs as well use
kind of conventional hardware reverse

453
00:51:10,830 --> 00:51:15,840
engineering processes for JTAG interface
is it for you are anything that might

454
00:51:15,840 --> 00:51:20,840
provide us with debug information about
what's going on with crashes but yeah

455
00:51:20,840 --> 00:51:24,650
it's it's a case-by-case basis depending
on the OS and depending on the

456
00:51:24,650 --> 00:51:26,890
entertainment system in question

457
00:51:26,890 --> 00:51:31,680
ok one more question sorry we've made
you mentioned that you saw physical wire

458
00:51:31,680 --> 00:51:36,799
to do interactions sending it over the
air

459
00:51:36,800 --> 00:51:43,040
unexplainable the wire like or where we
can get that to play with it it's

460
00:51:43,040 --> 00:51:47,200
literally just a piece of coaxial cable
so it's like it's like the cable that

461
00:51:47,200 --> 00:51:56,450
connects to your to your antenna just
connecting an attenuated connected like

462
00:51:56,450 --> 00:52:02,129
60 GB attenuate it really reduces the
signal level and then connected to the

463
00:52:02,130 --> 00:52:07,290
cable which connects directly to the
receiver and it's literally emulating

464
00:52:07,290 --> 00:52:11,460
the signal path over RAF but we're not
breaking the law because we're not

465
00:52:11,460 --> 00:52:18,750
transmitting wirelessly thank you

466
00:52:18,750 --> 00:52:20,370
thanks very much

