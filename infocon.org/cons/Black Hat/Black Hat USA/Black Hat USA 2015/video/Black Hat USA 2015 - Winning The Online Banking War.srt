1
00:00:00,000 --> 00:00:14,700
lol I thanks a lot for coming by in a
joint session later shown pog and making

2
00:00:14,700 --> 00:00:26,080
war let me just briefly introduce myself
I work for one of the four banks in

3
00:00:26,080 --> 00:00:36,870
Australia as a consultant and
achievements are made in the bank was to

4
00:00:36,870 --> 00:00:47,410
create a detection system not installing
anything on the client's machine and I

5
00:00:47,410 --> 00:00:55,449
beast I talk is and it is an extension
of that long but at the same time I want

6
00:00:55,449 --> 00:01:02,329
to emphasize the fact that I just talk
has got nothing to do with any any

7
00:01:02,329 --> 00:01:12,890
specific banks or a vendor so please be
aware of that ice watchful eye on those

8
00:01:12,890 --> 00:01:32,970
trying to migrate the moment so in the
past and a battle between the bad guys

9
00:01:32,970 --> 00:01:44,130
and the good guys backing away from the
perspective of solutions but if you

10
00:01:44,130 --> 00:01:53,158
stalk the focus is is the battle between
the attackers and the banks and so we're

11
00:01:53,159 --> 00:02:08,080
going to have a look to the crux of the
battle for us and our family something

12
00:02:08,080 --> 00:02:08,840
called

13
00:02:08,840 --> 00:02:23,099
so that by the way I do have to
apologize for my voice I caught a bit of

14
00:02:23,099 --> 00:02:36,760
cold so I do apologize for their office
now too bad for you to listen that

15
00:02:36,760 --> 00:02:50,720
picture let's trades on the papers on
the articles by Sarah basically one

16
00:02:50,720 --> 00:03:09,310
campaign spam emails i droppers the
actual end C&C sides its revised the

17
00:03:09,310 --> 00:03:21,579
configuration of it usually contains a
list of the target banks the page you

18
00:03:21,579 --> 00:03:33,090
announce injection scripts and things
like that so in the past people used to

19
00:03:33,090 --> 00:03:45,510
think about battle as you know simply
you are writing speeches by refunds

20
00:03:45,510 --> 00:03:53,620
or simply plugging the URL else that
charge of the inspection or blocking IP

21
00:03:53,620 --> 00:03:56,379
address of the stem cells sera sera

22
00:03:56,379 --> 00:04:10,988
but I'm going to be talking about this
talk is is not that I let me go through

23
00:04:10,989 --> 00:04:20,108
a few of those screen shots I took these
are the ones that can you give you idea

24
00:04:20,108 --> 00:04:30,469
about what the you know what they're
doing a lot of you guys already aware of

25
00:04:30,470 --> 00:04:41,740
these sort of stuff I was skimmed
through one of those shots so I decided

26
00:04:41,740 --> 00:04:55,060
page so it's still a phone banking code
and end to do more fraud in other

27
00:04:55,060 --> 00:05:04,620
channels and also have a one-time pasa
talking embedded in your

28
00:05:04,620 --> 00:05:20,510
well and is temporarily unavailable so
we're definitely gives them a bit of

29
00:05:20,510 --> 00:05:32,060
time to buy the following a fraud and
sometimes you can see it sends a message

30
00:05:32,060 --> 00:05:38,490
saying his way and he just takes a long
time to complete what's happening the

31
00:05:38,490 --> 00:05:42,060
background is this

32
00:05:42,060 --> 00:05:56,180
green lines out of packets that actually
do some cases between the machine so

33
00:05:56,180 --> 00:06:11,750
russians in some cases when there is a
transition injection it will require a

34
00:06:11,750 --> 00:06:19,270
social engineering in there because I'm
sorry and is equipped with them it

35
00:06:19,270 --> 00:06:28,520
effective education methods such as
iPhones for example and a user is not

36
00:06:28,520 --> 00:06:38,479
expecting a message and if Abbas then
you know it's going to be a very unusual

37
00:06:38,479 --> 00:06:53,780
thing if we are to receive so that's the
reason why I know that are useful to the

38
00:06:53,780 --> 00:07:05,770
victim to enter the code is a few of
those stuff like that at any point here

39
00:07:05,770 --> 00:07:28,130
is that there are requires a web
application logic that should be

40
00:07:28,130 --> 00:07:37,750
embedded in our sessions so just a few
months ago I someone at the blanket Asia

41
00:07:37,750 --> 00:07:42,289
has already presented about how

42
00:07:42,289 --> 00:07:53,389
the banks can detect injects so I'm
gonna just talked about that briefly

43
00:07:53,389 --> 00:08:01,149
first and then I'm gonna move on to my
main topic so yeah

44
00:08:01,149 --> 00:08:06,669
injection is it is very simple thing so
he's simply a piece of JavaScript there

45
00:08:06,669 --> 00:08:20,688
will be embedded into the so this
example with

46
00:08:20,689 --> 00:08:35,069
then I grabbed the information stored in
the in the fields and and if it was

47
00:08:35,068 --> 00:08:43,419
embedded in the transition that is going
to be a tight race injection or

48
00:08:43,419 --> 00:08:55,189
commission so I'm going to detect that

49
00:08:55,190 --> 00:09:08,550
some people that buy be confused about
the detection here so we are not talking

50
00:09:08,550 --> 00:09:20,130
about the solutions we are talking about
when I'm making a son yeah I don't

51
00:09:20,130 --> 00:09:26,170
imagine users who is using PC right and
in the PC

52
00:09:26,170 --> 00:09:36,829
your your PC is infected with malware
and it's the PC that it's BC we want to

53
00:09:36,830 --> 00:09:49,850
do the do the additional so page what
will happen is the lines will do you

54
00:09:49,850 --> 00:09:59,280
actually get requests and in turn the on
imaging server will return a response

55
00:09:59,280 --> 00:10:11,709
which will contain the actual page and
while we can do in the bank is we can

56
00:10:11,710 --> 00:10:27,480
embed a special scripts which I call on
the left hand side and making page you

57
00:10:27,480 --> 00:10:36,080
are on the same page and on top of that
of course we've got the actual inject in

58
00:10:36,080 --> 00:10:44,460
there so we can do is scan the dome and
see goes out to inject is essentially a

59
00:10:44,460 --> 00:10:51,260
piece of JavaScript as well so we can do
is a simplistic and a dog and see if

60
00:10:51,260 --> 00:10:57,740
there's any other script that that is
not in the page so that that's a very

61
00:10:57,740 --> 00:11:10,110
simple a mechanism to detection and it
can be a very effective right I just

62
00:11:10,110 --> 00:11:14,880
sent out on the server side we have to
maintain the actual

63
00:11:14,880 --> 00:11:25,189
it's also possible that I third party
browser plugins index stuff page but

64
00:11:25,190 --> 00:11:42,490
it's also important to you intended to
be just got to detection and end the

65
00:11:42,490 --> 00:11:53,380
game is over I don't think that's really
all that we have this talk is a

66
00:11:53,380 --> 00:12:03,450
mechanism to hide the presence of
injected malicious script and how does

67
00:12:03,450 --> 00:12:08,700
it work it simply is very easy actually

68
00:12:08,700 --> 00:12:19,959
Mladic simply injected his self and
removes its own script nose end the

69
00:12:19,959 --> 00:12:27,849
injects a function that is a part of the
script will be activated when the

70
00:12:27,850 --> 00:12:35,290
function is called so for example if i
dont element is up housing event hello

71
00:12:35,290 --> 00:12:43,240
hello I thought it can be sealed the
function movies 2 invoked even after

72
00:12:43,240 --> 00:12:57,660
they moved it's because of the of the
way I got his correcto working

73
00:12:57,660 --> 00:13:02,930
as well as a reference to a moment

74
00:13:02,930 --> 00:13:21,189
activated and it's still remain in the
memory and their attackers can use to so

75
00:13:21,190 --> 00:13:44,540
if possible it simply is to end a button
and it will feel that existing

76
00:13:44,540 --> 00:13:56,530
actually still active because there is
reference i dont element to the script

77
00:13:56,530 --> 00:13:57,459
so that's good

78
00:13:57,460 --> 00:14:09,540
will be still in the memory and also to
reference is made to another reference

79
00:14:09,540 --> 00:14:24,819
to add to the body I don't elements and
it will still be active in them

80
00:14:24,820 --> 00:14:39,480
closures which is shown and function is
a function of the parameters which is

81
00:14:39,480 --> 00:14:49,200
only in the in the local press
conference so even after that out of

82
00:14:49,200 --> 00:15:01,850
function is is removed thing will be
still active because the past two years

83
00:15:01,850 --> 00:15:17,670
out of function will be associated with
the inside you know the exact remain in

84
00:15:17,670 --> 00:15:20,189
the memory

85
00:15:20,190 --> 00:15:31,779
detects all those hidden stuff a
forcible I think we have to have the

86
00:15:31,779 --> 00:15:39,329
capability to enumerate all the
obstacles in the memory and easiest way

87
00:15:39,329 --> 00:15:53,969
to Ashley detects the script for example
is to use a field of options out there

88
00:15:53,970 --> 00:16:12,240
are two scandia objects can use at an
event listener function to add an event

89
00:16:12,240 --> 00:16:29,060
using jQuery stuff to register any event
so it's one of those taking a list of

90
00:16:29,060 --> 00:16:34,209
all the functions so yeah

91
00:16:34,209 --> 00:16:49,699
much interesting so and once we have all
the functions that we have been so how

92
00:16:49,699 --> 00:17:01,878
can we actually I detect whether this is
one of the ways to do that to do that is

93
00:17:01,879 --> 00:17:15,720
a defect analysis so I just have a look
at it may occur when is too so it's part

94
00:17:15,720 --> 00:17:26,179
of my research I have discovered an
artifact when an object to it

95
00:17:26,179 --> 00:17:53,100
event is is removed the property is just
empty I think that you can use it said I

96
00:17:53,100 --> 00:18:05,908
think I'm pretty sure there will be some
other well however a more robust way to

97
00:18:05,909 --> 00:18:19,419
do the detection and entire I get all
the functions and do the comparison with

98
00:18:19,419 --> 00:18:27,990
the white least you get in you know so I
think that's best way to do it

99
00:18:27,990 --> 00:18:47,820
again and again I mean if you're tration
so in one single have got everything up

100
00:18:47,820 --> 00:18:48,399
and running

101
00:18:48,400 --> 00:19:14,720
inject script but the bad guys have the
privilege here cause they can inside

102
00:19:14,720 --> 00:19:31,770
code and they can I modify the code so I
said so it's something that we should be

103
00:19:31,770 --> 00:19:47,470
aware of and then because of his
possible so we ask and scripts scripts

104
00:19:47,470 --> 00:20:00,290
and I do the calculation of the ice alan
has she's one of the scripts and I send

105
00:20:00,290 --> 00:20:03,550
them back to the summer

106
00:20:03,550 --> 00:20:16,139
protection so in the in the normal cases
view our index in the packets there so

107
00:20:16,140 --> 00:20:28,780
it's time making techniques you see it
we always I sends out a D&C

108
00:20:28,780 --> 00:20:36,850
he's just like alan has SH of its Israel
the script is running

109
00:20:36,850 --> 00:20:46,980
the page A B and see all the time and
get something that will always happen

110
00:20:46,980 --> 00:20:55,510
and is it is embedding it's always
script in there and he sees it has one

111
00:20:55,510 --> 00:20:56,360
more stuff

112
00:20:56,360 --> 00:21:11,520
ABC Ind so I figured it out and so they
simply a bloody reason traffic and

113
00:21:11,520 --> 00:21:40,230
instead I replayed the package so so so
it can be used you know if they'd been

114
00:21:40,230 --> 00:21:49,080
ourselves against it

115
00:21:49,080 --> 00:22:02,070
it's going to take off my shirt

116
00:22:02,070 --> 00:22:17,179
the problem has been addressed a long
time ago ready to replace attacked some

117
00:22:17,180 --> 00:22:26,660
cold assaulting so does is essentially
it's so returns a random number which is

118
00:22:26,660 --> 00:22:41,780
what we call and we used to transform
the values so in this case the scripts

119
00:22:41,780 --> 00:22:57,139
will be transformed into something so
it's it's packaged each time it will

120
00:22:57,140 --> 00:23:09,340
continue sought so the attacker actually
see something like that its net asset

121
00:23:09,340 --> 00:23:18,179
value package you know I KY cue TX Sarah
so that way

122
00:23:18,180 --> 00:23:34,840
avoid the replay attack as I mentioned
before the home scott is open to attack

123
00:23:34,840 --> 00:23:49,929
and it's a kind of open source so I can
do is basically inside its own trading

124
00:23:49,930 --> 00:24:00,590
between has so yes I guess example does
is

125
00:24:00,590 --> 00:24:12,699
between hash function and and and sort
function it will actually receive a list

126
00:24:12,700 --> 00:24:19,960
of how she said the scripts and it will
look into the script it will look into

127
00:24:19,960 --> 00:24:30,330
the lists and removes the hash value
that belongs to the MLA inject a so that

128
00:24:30,330 --> 00:24:37,309
way you can simply are not being
detected

129
00:24:37,309 --> 00:24:51,389
their own piece of code in between in
between his code or reverse engineer the

130
00:24:51,390 --> 00:25:06,880
entire code and do the simulation called
if those functions as needed at this

131
00:25:06,880 --> 00:25:12,610
point of time let's have a look at what
detectors can do what I'm not gonna

132
00:25:12,610 --> 00:25:21,459
spend hours and hours or even days of
time you to do reverse aging of the

133
00:25:21,460 --> 00:25:29,390
Army's code what they do he initially
simply do the dynamic analysis so they

134
00:25:29,390 --> 00:25:39,929
break point here in there and evaluation
and I do a search on hit universe of

135
00:25:39,929 --> 00:25:40,570
those

136
00:25:40,570 --> 00:25:54,480
streams dead I might use so you know
they have not spent a lot of time he

137
00:25:54,480 --> 00:26:04,779
said it's more of a behavior analysis I
says it's important it's really

138
00:26:04,779 --> 00:26:11,159
important to understand what to take
this can cause otherwise we'll probably

139
00:26:11,159 --> 00:26:23,419
spend a lot of time protecting you
something so some people believe that

140
00:26:23,419 --> 00:26:34,860
using encryption which should help at
all because the information which is she

141
00:26:34,860 --> 00:26:55,289
not only 22 goes about also add to the
US as well that doesn't help at all

142
00:26:55,289 --> 00:27:06,639
it so I am in need apply only know why
you know they were there to protect your

143
00:27:06,639 --> 00:27:15,779
code it may nowhere because you have to
understand how much are protecting and

144
00:27:15,779 --> 00:27:21,180
then it can actually be applied

145
00:27:21,180 --> 00:27:35,110
a petition on top of it so what is it
that we actually want to do is to

146
00:27:35,110 --> 00:27:43,570
guarantee the according to make sure
that our execution of these code is not

147
00:27:43,570 --> 00:27:45,870
compromised

148
00:27:45,870 --> 00:27:59,600
one of the ways to do it is according to
check his example a couple of random

149
00:27:59,600 --> 00:28:15,129
numbers to transform the something

150
00:28:15,130 --> 00:28:33,860
idolized actually I guess the icrc off
the actual source code and combined with

151
00:28:33,860 --> 00:28:45,719
the random number so if you want to
evade the code check in that code have

152
00:28:45,720 --> 00:28:52,980
to insert something some piece of code
only have two years called into action

153
00:28:52,980 --> 00:29:07,180
in it in either case you know just what
you find a code so that you know I

154
00:29:07,180 --> 00:29:19,660
picked up changing the value of the of
the year integrity check value so it is

155
00:29:19,660 --> 00:29:30,850
one of the waste of weekend I just
checked in tailoring and

156
00:29:30,850 --> 00:29:36,240
under way to do it but the point here
the key point here is that it's

157
00:29:36,240 --> 00:29:41,980
important addition to our code in
temperature and that's gonna be the

158
00:29:41,980 --> 00:30:06,370
basis of a talk in the following slides
so it could be the MEDC could be there

159
00:30:06,370 --> 00:30:13,709
can be tempered with so its important
mission to provide security for one of

160
00:30:13,710 --> 00:30:24,060
those components

161
00:30:24,060 --> 00:30:44,940
you know why is there a way to actually
make it look like I miss code is not

162
00:30:44,940 --> 00:30:54,780
compromised but actually you know you
know actually it is compromised yes of

163
00:30:54,780 --> 00:31:07,820
course it is time to figure out how to
do that so I mean pointing said doesn't

164
00:31:07,820 --> 00:31:19,879
matter how smart you are you are you
know a broken it's not with so how can

165
00:31:19,880 --> 00:31:31,900
address this problem though what the
most promising solutions to this is to

166
00:31:31,900 --> 00:31:37,780
do a randomized version of the code base
not only one version of the army scold

167
00:31:37,780 --> 00:31:46,590
you have you just keep thousands of
those so that it is gonna be a

168
00:31:46,590 --> 00:31:48,800
computationally infeasible

169
00:31:48,800 --> 00:31:56,070
attackers to reverse engineer all the
code and I we arrived

170
00:31:56,070 --> 00:32:04,419
evasion code so I think that's the way
to go

171
00:32:04,420 --> 00:32:13,620
this is one of the important issues that
could possibly have essentially have the

172
00:32:13,620 --> 00:32:24,840
code will check all the basic blood on
the left hand side and you just get the

173
00:32:24,840 --> 00:32:31,820
combination of get obviously is
combination of those code and put those

174
00:32:31,820 --> 00:32:39,570
into fuel those steps which will you
know and give you a randomized

175
00:32:39,570 --> 00:32:50,250
code for example can i connect it's one
of those blocks through a a function

176
00:32:50,250 --> 00:33:06,290
call in line or even exactly code also
you can I generate the code avail or you

177
00:33:06,290 --> 00:33:21,210
can simply use a steady code again now
that we can supply all those techniques

178
00:33:21,210 --> 00:33:32,780
so that's one of the ways we can and
that's one of the

179
00:33:32,780 --> 00:33:48,830
you know in major motivation of my
research so it's a randomized it is open

180
00:33:48,830 --> 00:34:22,259
so it's impossible to guarantee and
predicates right now so that's a

181
00:34:22,260 --> 00:34:35,010
technique that allows objects in the
deck was to hide anything it does that

182
00:34:35,010 --> 00:34:52,929
simply by looking into a temporary the
data judy I just as well as an example

183
00:34:52,929 --> 00:35:11,460
and end the return value is cooked
through and if it detects a javascript

184
00:35:11,460 --> 00:35:19,710
which is a part of the inject it moved
so that way it were just avoiding

185
00:35:19,710 --> 00:35:24,980
detection

186
00:35:24,980 --> 00:35:44,720
I mean a defense you have to say all the
functions and also dependent functions

187
00:35:44,720 --> 00:35:53,629
as well and ensure that you are
compromised and just how am I going to

188
00:35:53,630 --> 00:36:00,490
do that well it was a few ways to do it
but I this is one of the waist and I

189
00:36:00,490 --> 00:36:27,359
have so much of an exception to a
potentially function so that function

190
00:36:27,359 --> 00:36:45,640
only a function object but if you are an
exception and on accession if you have

191
00:36:45,640 --> 00:37:00,319
the opportunity cost of that can you
know all the strength but in a recession

192
00:37:00,320 --> 00:37:10,070
that a rail line and there was indeed

193
00:37:10,070 --> 00:37:23,970
and this is something that you can do on
the south side so he said about online

194
00:37:23,970 --> 00:38:13,330
here is that we should be able to the US
to actually detects the presence of a

195
00:38:13,330 --> 00:38:57,999
software and each time so we can do

196
00:38:57,999 --> 00:39:42,968
so amazing that here is because it can
be a very useful in the design so what

197
00:39:42,969 --> 00:39:55,239
are you said I think the most important
feature of that I miss harding will be

198
00:39:55,239 --> 00:40:07,709
from the from the browser to the seller
and a lot of them you know I can be you

199
00:40:07,709 --> 00:40:33,118
know a further I secured by said Kay AP
so so let me go if possible transaction

200
00:40:33,119 --> 00:40:45,119
injection what we mean by then so i
activate that goes

201
00:40:45,119 --> 00:40:49,720
unless I

202
00:40:49,720 --> 00:41:19,549
money that's all I need to do that make
payment to my friend above and I'm

203
00:41:19,549 --> 00:41:36,788
paying $5,000 as a gift today now paid
and bob is supposed to receive something

204
00:41:36,789 --> 00:41:45,470
that he has received anything has
received so

205
00:41:45,470 --> 00:42:00,180
that's childish manipulation and I think
that's something you're talking about

206
00:42:00,180 --> 00:43:09,970
now I have to define intention is
activated and if I just end it just is

207
00:43:09,970 --> 00:43:31,470
I'm here to execute a page gets a
refresh the page and in the log fire

208
00:43:31,470 --> 00:44:51,439
attempt detected so see that changing
right now that's a soldier's version

209
00:44:51,440 --> 00:45:11,890
ok so I thought if I tried to attack us
can do is a forwarding data so you can

210
00:45:11,890 --> 00:45:24,660
get the code just briefly what you do is
simply a rewriting the activated yet no

211
00:45:24,660 --> 00:45:30,670
yes

212
00:45:30,670 --> 00:46:21,760
because at the time just make sure we've
got it and you feel that which is called

213
00:46:21,760 --> 00:46:30,450
that you just read there because it's
not the integrity value expecting that

214
00:46:30,450 --> 00:46:55,520
piece of code what's next and he would
get into and

215
00:46:55,520 --> 00:47:12,280
code again I think we have a loser
detection here now because the integrity

216
00:47:12,280 --> 00:47:20,849
looks ok

217
00:47:20,849 --> 00:47:44,299
sorry about that it's ok just activated
again and I will inject still dead code

218
00:47:44,299 --> 00:48:08,599
code and you see that you feel there was
actually the field where can you see the

219
00:48:08,599 --> 00:48:16,029
integrity of the dog is not is not ride
so it has been way too I smoked red

220
00:48:16,029 --> 00:48:23,989
almost out of time I've got one more
thing to show you

221
00:48:23,989 --> 00:48:56,700
script to just as your knowledge park
and activate the catalogue of his failed

222
00:48:56,700 --> 00:49:04,160
because it's that stuff

223
00:49:04,160 --> 00:49:13,848
ok just ahead of time right now so I
think I'll let you are listening and i

224
00:49:13,849 --> 00:49:14,519
really appreciate that

