1
00:00:00,000 --> 00:00:12,630
welcome leandro and<font color="#CCCCCC"> diego thank you so</font>

2
00:00:06,870 --> 00:00:15,540
we are the<font color="#CCCCCC"> under miners and the azure we</font>

3
00:00:12,630 --> 00:00:18,779
both<font color="#E5E5E5"> work at core security technologies</font>

4
00:00:15,540 --> 00:00:21,509
consulting services mainly we do

5
00:00:18,779 --> 00:00:26,519
pentesting source code everything there

6
00:00:21,510 --> 00:00:29,010
so basically based on that we with our

7
00:00:26,519 --> 00:00:33,269
research and<font color="#E5E5E5"> we are researching all the</font>

8
00:00:29,010 --> 00:00:40,469
time based on what we see out there so

9
00:00:33,270 --> 00:00:45,059
enjoy<font color="#CCCCCC"> the token let's</font><font color="#E5E5E5"> start so first of</font>

10
00:00:40,469 --> 00:00:46,980
all an agenda for this talk wherein we

11
00:00:45,059 --> 00:00:50,160
are going to reviewer to reintroduce

12
00:00:46,980 --> 00:00:53,819
some concept of some kind some of the

13
00:00:50,160 --> 00:00:56,519
concepts of web then we are going to

14
00:00:53,820 --> 00:01:00,300
introduce<font color="#E5E5E5"> wpa migration mode which is</font>

15
00:00:56,520 --> 00:01:02,280
<font color="#E5E5E5">the main topic of this talk then</font><font color="#CCCCCC"> we are</font>

16
00:01:00,300 --> 00:01:05,908
going<font color="#E5E5E5"> to talk about the attacks how to</font>

17
00:01:02,280 --> 00:01:08,340
attack the<font color="#CCCCCC"> wpa migration mode and some</font>

18
00:01:05,909 --> 00:01:12,630
mitigations and recommendations in order

19
00:01:08,340 --> 00:01:15,270
to avoid or to prevent these attacks to

20
00:01:12,630 --> 00:01:20,250
to happen so basically this<font color="#CCCCCC"> is the</font>

21
00:01:15,270 --> 00:01:22,949
agenda<font color="#CCCCCC"> for for the talk so web we all</font>

22
00:01:20,250 --> 00:01:25,860
know<font color="#E5E5E5"> probably yeah we all know that that</font>

23
00:01:22,950 --> 00:01:30,090
is broken at this<font color="#E5E5E5"> point we know that it</font>

24
00:01:25,860 --> 00:01:31,740
shouldn't be<font color="#E5E5E5"> used but what anyway we we</font>

25
00:01:30,090 --> 00:01:35,009
are going to review some of the key

26
00:01:31,740 --> 00:01:40,710
concepts that are the building blocks of

27
00:01:35,009 --> 00:01:43,170
our attack so work web was meant to

28
00:01:40,710 --> 00:01:48,030
provide confidentiality to provide

29
00:01:43,170 --> 00:01:52,170
access control and integrity over the

30
00:01:48,030 --> 00:01:55,500
the packets we transmit so web is based

31
00:01:52,170 --> 00:01:58,200
on our c4 which is a symmetric cipher

32
00:01:55,500 --> 00:02:01,409
meaning symmetric meaning that both

33
00:01:58,200 --> 00:02:04,200
endpoints know the key and the key is

34
00:02:01,409 --> 00:02:06,479
the same on<font color="#E5E5E5"> both endpoints and it is a</font>

35
00:02:04,200 --> 00:02:08,759
stream cipher which means that<font color="#E5E5E5"> the</font>

36
00:02:06,479 --> 00:02:10,949
encryptions happens one digit at the

37
00:02:08,758 --> 00:02:13,369
time so each digit is encrypted

38
00:02:10,949 --> 00:02:16,310
independently of the

39
00:02:13,370 --> 00:02:20,360
of the rest<font color="#E5E5E5"> of the stream or the packet</font>

40
00:02:16,310 --> 00:02:25,099
then it includes a something they call

41
00:02:20,360 --> 00:02:28,909
the<font color="#CCCCCC"> ICB which is a the crc32 of the</font>

42
00:02:25,099 --> 00:02:30,980
plain text message this is the integrity

43
00:02:28,909 --> 00:02:34,970
check<font color="#E5E5E5"> value which is transmitted in</font>

44
00:02:30,980 --> 00:02:37,909
order to ensure the the integrity of the

45
00:02:34,970 --> 00:02:41,659
packet and then for the key management

46
00:02:37,909 --> 00:02:44,840
<font color="#E5E5E5">802 that 11 does not provide any key</font>

47
00:02:41,659 --> 00:02:50,239
management service so web depends on the

48
00:02:44,840 --> 00:02:52,790
end user to distribute and to provide a

49
00:02:50,239 --> 00:02:55,489
secure way to distribute the key so

50
00:02:52,790 --> 00:02:59,840
general keys so generally<font color="#E5E5E5"> the keys are</font>

51
00:02:55,489 --> 00:03:04,609
statically set and configure somewhere

52
00:02:59,840 --> 00:03:06,590
in a file in a configuration web page

53
00:03:04,609 --> 00:03:10,340
whatever depending on the on the

54
00:03:06,590 --> 00:03:14,120
equipment so this is<font color="#CCCCCC"> the basic diagram</font>

55
00:03:10,340 --> 00:03:18,260
of the web encapsulation<font color="#E5E5E5"> we have the</font>

56
00:03:14,120 --> 00:03:21,230
plain text that goes<font color="#E5E5E5"> through</font><font color="#CCCCCC"> the crc32</font>

57
00:03:18,260 --> 00:03:23,690
calculation we concatenate the tube

58
00:03:21,230 --> 00:03:26,929
meaning the plain text and the crc32

59
00:03:23,690 --> 00:03:30,410
then we have the initialization vector

60
00:03:26,930 --> 00:03:34,280
and the web<font color="#CCCCCC"> T we concatenate the two and</font>

61
00:03:30,410 --> 00:03:37,819
this is called the<font color="#E5E5E5"> seed</font><font color="#CCCCCC"> that enters the</font>

62
00:03:34,280 --> 00:03:42,620
rc4 save the random<font color="#E5E5E5"> number generator</font>

63
00:03:37,819 --> 00:03:45,048
which is basically the rc4 generator of

64
00:03:42,620 --> 00:03:49,459
the key stream so the key stream is the

65
00:03:45,049 --> 00:03:53,629
encryption material that we are going<font color="#E5E5E5"> to</font>

66
00:03:49,459 --> 00:03:57,319
exert with the concatenation of the

67
00:03:53,629 --> 00:04:01,010
plain text and the ICB so from there we

68
00:03:57,319 --> 00:04:03,260
we got the ciphertext so basically we

69
00:04:01,010 --> 00:04:05,989
have<font color="#E5E5E5"> the key stream we have the plain</font>

70
00:04:03,260 --> 00:04:10,399
text message concatenated with the<font color="#CCCCCC"> icv</font>

71
00:04:05,989 --> 00:04:13,430
and we exclusive or those things to

72
00:04:10,400 --> 00:04:16,910
obtain the ciphertext then<font color="#E5E5E5"> we prepend</font>

73
00:04:13,430 --> 00:04:20,900
the initialization vector this is in

74
00:04:16,910 --> 00:04:23,539
order to the receiver to know the

75
00:04:20,899 --> 00:04:26,960
necessity initialization vector that<font color="#E5E5E5"> is</font>

76
00:04:23,539 --> 00:04:29,990
used to<font color="#E5E5E5"> decrypt the the packet</font>

77
00:04:26,960 --> 00:04:37,008
so this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> the basic diagram of the web</font>

78
00:04:29,990 --> 00:04:40,849
<font color="#E5E5E5">encapsulation so but in 2001 the one of</font>

79
00:04:37,009 --> 00:04:44,210
the first papers published about how to

80
00:04:40,849 --> 00:04:48,740
tamper a what message what does it<font color="#E5E5E5"> mean</font>

81
00:04:44,210 --> 00:04:52,489
so we can build a new message based on

82
00:04:48,740 --> 00:04:56,539
the old<font color="#E5E5E5"> cipher text that is still valid</font>

83
00:04:52,490 --> 00:05:00,440
so basically one<font color="#CCCCCC"> of the key elements for</font>

84
00:04:56,539 --> 00:05:03,860
this to happen is that crc32 is linear

85
00:05:00,440 --> 00:05:07,729
with respect of the of the<font color="#CCCCCC"> sort</font>

86
00:05:03,860 --> 00:05:10,520
<font color="#E5E5E5">operation this is the basic that we need</font>

87
00:05:07,729 --> 00:05:13,849
for this to happen so we claim<font color="#CCCCCC"> that it</font>

88
00:05:10,520 --> 00:05:17,210
<font color="#CCCCCC">is possible to build a new message a</font>

89
00:05:13,849 --> 00:05:21,289
<font color="#CCCCCC">cipher text sorry a new cipher sexy too</font>

90
00:05:17,210 --> 00:05:26,120
based on the first cipher text and a

91
00:05:21,289 --> 00:05:28,940
delta value that is<font color="#CCCCCC"> arbitrary</font><font color="#E5E5E5"> selected</font>

92
00:05:26,120 --> 00:05:30,979
by the attacker and we can control so

93
00:05:28,940 --> 00:05:35,479
basically knowing the cipher text and

94
00:05:30,979 --> 00:05:38,690
setting a delta value we can<font color="#E5E5E5"> build a new</font>

95
00:05:35,479 --> 00:05:43,940
cipher text which is<font color="#CCCCCC"> valid for web</font>

96
00:05:38,690 --> 00:05:46,699
encapsulation so in layman's terms we

97
00:05:43,940 --> 00:05:49,669
have to sort the data with the<font color="#E5E5E5"> mask</font>

98
00:05:46,699 --> 00:05:53,870
Delta<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is the arbitrary value the</font>

99
00:05:49,669 --> 00:05:58,280
attacker uses and select and sort the

100
00:05:53,870 --> 00:06:02,960
<font color="#CCCCCC">ICB meaning the crc32 of the original</font>

101
00:05:58,280 --> 00:06:06,679
message with the ICB of the mask meaning

102
00:06:02,960 --> 00:06:08,659
the icv of<font color="#E5E5E5"> delta right so having this in</font>

103
00:06:06,680 --> 00:06:15,169
mind we are going to show<font color="#E5E5E5"> an attack</font>

104
00:06:08,659 --> 00:06:18,620
based<font color="#E5E5E5"> on these properties so now a brief</font>

105
00:06:15,169 --> 00:06:28,310
introduction to wpa what is wpa

106
00:06:18,620 --> 00:06:31,460
basically cisco has in its 1 1200 AP

107
00:06:28,310 --> 00:06:36,050
series and this kind<font color="#E5E5E5"> of functionality</font>

108
00:06:31,460 --> 00:06:38,330
that allows clients using web and wpa to

109
00:06:36,050 --> 00:06:40,880
connect to the same service set

110
00:06:38,330 --> 00:06:45,320
identifier the SS I

111
00:06:40,880 --> 00:06:47,719
so<font color="#E5E5E5"> wpa clients capable of tkip and</font>

112
00:06:45,320 --> 00:06:52,849
authenticated key management can connect

113
00:06:47,720 --> 00:06:55,760
to this SS I d802 dot1x clients such as

114
00:06:52,850 --> 00:07:00,350
legacy lip clients and clients using<font color="#E5E5E5"> TLS</font>

115
00:06:55,760 --> 00:07:03,469
but but capable of authenticated key

116
00:07:00,350 --> 00:07:09,230
management but not tkip this is called

117
00:07:03,470 --> 00:07:12,650
<font color="#CCCCCC">the dynamic web client and finally web</font>

118
00:07:09,230 --> 00:07:14,480
client not capable of tkip or

119
00:07:12,650 --> 00:07:19,969
authenticated<font color="#E5E5E5"> key management this is</font><font color="#CCCCCC"> the</font>

120
00:07:14,480 --> 00:07:22,940
old web client staff which is<font color="#CCCCCC"> with the</font>

121
00:07:19,970 --> 00:07:27,080
key where the key is set manually so

122
00:07:22,940 --> 00:07:37,790
<font color="#E5E5E5">using the same SSID we can connect with</font>

123
00:07:27,080 --> 00:07:41,960
<font color="#E5E5E5">either a</font><font color="#CCCCCC"> WPA station or a web station so</font>

124
00:07:37,790 --> 00:07:46,010
this is<font color="#E5E5E5"> how</font><font color="#CCCCCC"> we can identify and</font><font color="#E5E5E5"> ap</font>

125
00:07:41,960 --> 00:07:50,359
working on this particular configuration

126
00:07:46,010 --> 00:07:53,210
so we had a multicast<font color="#E5E5E5"> cipher and we have</font>

127
00:07:50,360 --> 00:07:57,920
the unicast cipher we see<font color="#E5E5E5"> that for the</font>

128
00:07:53,210 --> 00:08:02,630
multicast cipher suite the Vikan shows

129
00:07:57,920 --> 00:08:05,390
that it is using the web 104 bit and for

130
00:08:02,630 --> 00:08:10,190
the unica cipher suite it is using tkip

131
00:08:05,390 --> 00:08:14,570
so both ciphers are used on the same<font color="#E5E5E5"> AP</font>

132
00:08:10,190 --> 00:08:18,710
and they are advertised in the<font color="#E5E5E5"> week on</font>

133
00:08:14,570 --> 00:08:22,219
so basically we have<font color="#E5E5E5"> both both ciphers</font>

134
00:08:18,710 --> 00:08:24,680
that we can use so for multicast and

135
00:08:22,220 --> 00:08:28,820
broadcast which is basically<font color="#E5E5E5"> that we are</font>

136
00:08:24,680 --> 00:08:34,969
going to show<font color="#E5E5E5"> and we we can use either</font>

137
00:08:28,820 --> 00:08:38,510
either web or<font color="#E5E5E5"> wpa so using web as a</font>

138
00:08:34,969 --> 00:08:41,000
musical<font color="#E5E5E5"> cipher allows web and wpa</font>

139
00:08:38,510 --> 00:08:46,819
stations to the Crypt multicast<font color="#E5E5E5"> traffic</font>

140
00:08:41,000 --> 00:08:51,110
so basically this<font color="#E5E5E5"> AP will use web for</font>

141
00:08:46,820 --> 00:08:54,470
multicast and for broadcast and for the

142
00:08:51,110 --> 00:08:57,710
stations<font color="#E5E5E5"> that are only web stations</font>

143
00:08:54,470 --> 00:09:01,460
and we'll use wpa for unicast traffic

144
00:08:57,710 --> 00:09:05,450
that<font color="#E5E5E5"> is for wpa or tkip in this case</font>

145
00:09:01,460 --> 00:09:09,020
stations right so the AP tracks which

146
00:09:05,450 --> 00:09:14,330
station is web and which station is wpa

147
00:09:09,020 --> 00:09:16,760
<font color="#E5E5E5">and forwards remember that 802 wireless</font>

148
00:09:14,330 --> 00:09:19,670
or Wi-Fi in general is a switched

149
00:09:16,760 --> 00:09:24,740
<font color="#E5E5E5">network so basically the AP forwards</font>

150
00:09:19,670 --> 00:09:27,260
each packet to each station taking<font color="#E5E5E5"> in</font>

151
00:09:24,740 --> 00:09:30,410
account the type of encryption the

152
00:09:27,260 --> 00:09:34,160
<font color="#E5E5E5">station is using so if the station is</font>

153
00:09:30,410 --> 00:09:38,329
using web the unicast parkas packet will

154
00:09:34,160 --> 00:09:42,530
go in web if the station is using wpa

155
00:09:38,330 --> 00:09:47,360
the unicast packet will go using tkip

156
00:09:42,530 --> 00:09:55,430
but for the multicast and abroad packet

157
00:09:47,360 --> 00:09:58,400
the IP will will always use web so this

158
00:09:55,430 --> 00:10:02,959
<font color="#CCCCCC">is</font><font color="#E5E5E5"> the basic configuration for foreign</font>

159
00:09:58,400 --> 00:10:07,370
AP working in this particular way<font color="#CCCCCC"> so wpa</font>

160
00:10:02,960 --> 00:10:10,580
de<font color="#E5E5E5"> cannes optional from the pool Cisco's</font>

161
00:10:07,370 --> 00:10:15,440
documentation a cipher suite containing

162
00:10:10,580 --> 00:10:18,380
<font color="#E5E5E5">tkip m4e for a bit or 128-bit web</font>

163
00:10:15,440 --> 00:10:21,260
configuration and a static web key in

164
00:10:18,380 --> 00:10:24,050
key slot<font color="#CCCCCC"> two or three</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> is one of</font><font color="#E5E5E5"> the</font>

165
00:10:21,260 --> 00:10:26,450
difference we find with the typical<font color="#E5E5E5"> web</font>

166
00:10:24,050 --> 00:10:30,050
configuration because this is a

167
00:10:26,450 --> 00:10:36,770
requirement to to put the key in slot

168
00:10:30,050 --> 00:10:41,750
two or three then we have the capture of

169
00:10:36,770 --> 00:10:44,329
the terminal where we configure the DA p

170
00:10:41,750 --> 00:10:48,230
so you see that<font color="#E5E5E5"> the encryption mode</font>

171
00:10:44,330 --> 00:10:52,190
ciphers are tkip and web one huntin a

172
00:10:48,230 --> 00:10:57,530
bit the encryption key is in slot 2 and

173
00:10:52,190 --> 00:10:59,990
the key is here the SSID and then you

174
00:10:57,530 --> 00:11:02,810
see the authentication key management as

175
00:10:59,990 --> 00:11:05,360
<font color="#E5E5E5">wpa optional because this is a</font>

176
00:11:02,810 --> 00:11:08,079
requirement for<font color="#CCCCCC"> the for the app for</font><font color="#E5E5E5"> the</font>

177
00:11:05,360 --> 00:11:08,080
AP to work

178
00:11:08,150 --> 00:11:18,590
so how how<font color="#E5E5E5"> to detect this</font><font color="#CCCCCC"> AP working so</font>

179
00:11:14,510 --> 00:11:22,490
basically working WP migration basically

180
00:11:18,590 --> 00:11:25,910
we<font color="#E5E5E5"> are going to to look for the beacon</font>

181
00:11:22,490 --> 00:11:28,970
frames so first of all try to try to

182
00:11:25,910 --> 00:11:33,560
filter the<font color="#CCCCCC"> wacom frames using the frame</font>

183
00:11:28,970 --> 00:11:39,380
control type subtype field then that the

184
00:11:33,560 --> 00:11:43,400
beacon must the WPA element must be

185
00:11:39,380 --> 00:11:46,400
present within the week on then<font color="#E5E5E5"> the</font>

186
00:11:43,400 --> 00:11:50,900
multicast<font color="#E5E5E5"> ciphers it which is inside the</font>

187
00:11:46,400 --> 00:11:54,650
tag<font color="#CCCCCC"> of the inside one tag of the WPA</font>

188
00:11:50,900 --> 00:11:59,030
element must be multicast<font color="#E5E5E5"> ciphers with</font>

189
00:11:54,650 --> 00:12:03,890
web for a bit or multicast cipher suite

190
00:11:59,030 --> 00:12:07,579
web<font color="#CCCCCC"> 100 for weeds and finally the unica</font>

191
00:12:03,890 --> 00:12:11,270
cipher suite is tkip so<font color="#CCCCCC"> unica cipher</font>

192
00:12:07,580 --> 00:12:13,220
suite tkip so this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> the basic element</font>

193
00:12:11,270 --> 00:12:19,880
we have to look for when we are<font color="#E5E5E5"> looking</font>

194
00:12:13,220 --> 00:12:23,660
for an AP working in migration mode so

195
00:12:19,880 --> 00:12:27,050
this<font color="#E5E5E5"> is all the filter elements</font>

196
00:12:23,660 --> 00:12:30,170
<font color="#E5E5E5">combining one visualization filter and a</font>

197
00:12:27,050 --> 00:12:39,079
wireshark capture of the become frames

198
00:12:30,170 --> 00:12:41,510
then we have a keysmith here the tool<font color="#CCCCCC"> or</font>

199
00:12:39,080 --> 00:12:44,600
<font color="#CCCCCC">Wireless information-gathering</font>

200
00:12:41,510 --> 00:12:47,750
<font color="#E5E5E5">pentesting</font><font color="#CCCCCC"> whatever you want that we</font>

201
00:12:44,600 --> 00:12:52,310
patch in order to detect these<font color="#E5E5E5"> APIs</font>

202
00:12:47,750 --> 00:12:56,870
working in migration mode as web a piece

203
00:12:52,310 --> 00:13:00,319
in<font color="#E5E5E5"> red if you see on top of the image</font>

204
00:12:56,870 --> 00:13:03,830
why because as the<font color="#E5E5E5"> top goes by we are</font>

205
00:13:00,320 --> 00:13:06,410
going to show<font color="#CCCCCC"> that having an AP working</font>

206
00:13:03,830 --> 00:13:10,520
in migration mode will post the same

207
00:13:06,410 --> 00:13:14,870
risk as an AP working in web so it<font color="#E5E5E5"> is</font>

208
00:13:10,520 --> 00:13:18,829
important to flag it as a web AP in fact

209
00:13:14,870 --> 00:13:22,010
this<font color="#CCCCCC"> is not a web</font><font color="#E5E5E5"> AP but we are going to</font>

210
00:13:18,830 --> 00:13:28,010
show<font color="#CCCCCC"> that the risk is the same so</font>

211
00:13:22,010 --> 00:13:31,850
we see<font color="#CCCCCC"> their the details of tkip cipher</font>

212
00:13:28,010 --> 00:13:34,490
website fur and we configure the IP in

213
00:13:31,850 --> 00:13:39,200
<font color="#CCCCCC">pressure key because it was easier for</font>

214
00:13:34,490 --> 00:13:42,410
us to taste this but you<font color="#CCCCCC"> can use a 802</font>

215
00:13:39,200 --> 00:13:48,470
dot1x or whatever and then the details

216
00:13:42,410 --> 00:13:52,670
of the AP<font color="#CCCCCC"> the bssid the ciphers and all</font>

217
00:13:48,470 --> 00:13:58,640
<font color="#CCCCCC">these information that is shown in the</font>

218
00:13:52,670 --> 00:14:01,459
<font color="#E5E5E5">capture so now</font><font color="#CCCCCC"> Leandro is going to talk</font>

219
00:13:58,640 --> 00:14:03,949
about how<font color="#E5E5E5"> to attack so we present the</font>

220
00:14:01,460 --> 00:14:07,460
migration mode<font color="#CCCCCC"> and landry is going to</font>

221
00:14:03,950 --> 00:14:12,410
talk about how<font color="#E5E5E5"> to attack the disciples</font>

222
00:14:07,460 --> 00:14:15,530
hi can everybody hear me<font color="#CCCCCC"> okay great okay</font>

223
00:14:12,410 --> 00:14:17,150
kicking off for Diego left off I'm going

224
00:14:15,530 --> 00:14:19,730
<font color="#E5E5E5">to start talking about how to attack and</font>

225
00:14:17,150 --> 00:14:22,520
IP configured in this manner so

226
00:14:19,730 --> 00:14:24,200
basically the first step is that when we

227
00:14:22,520 --> 00:14:26,720
bumped into this we bumped into this at

228
00:14:24,200 --> 00:14:28,910
the customer of<font color="#E5E5E5"> ours and something</font>

229
00:14:26,720 --> 00:14:31,130
smells fishy of having this hybrid

230
00:14:28,910 --> 00:14:33,020
configuration so we started to see what

231
00:14:31,130 --> 00:14:34,640
we could do with it so the first<font color="#CCCCCC"> thing</font>

232
00:14:33,020 --> 00:14:36,319
we did is we started looking and

233
00:14:34,640 --> 00:14:38,420
browsing through the documentation to

234
00:14:36,320 --> 00:14:41,450
see what we could find that<font color="#E5E5E5"> Cisco was</font>

235
00:14:38,420 --> 00:14:43,280
saying<font color="#E5E5E5"> about this wpa migration mode so</font>

236
00:14:41,450 --> 00:14:45,980
<font color="#E5E5E5">basically what we found is that Cisco</font>

237
00:14:43,280 --> 00:14:48,319
says that the security will operate at

238
00:14:45,980 --> 00:14:50,660
the least common at<font color="#E5E5E5"> the least secure</font>

239
00:14:48,320 --> 00:14:53,270
level common to all devices so this

240
00:14:50,660 --> 00:14:55,610
basically split the scenarios into two

241
00:14:53,270 --> 00:14:57,290
possibilities when you have web stations

242
00:14:55,610 --> 00:14:59,870
and when you<font color="#E5E5E5"> don't have web stations</font>

243
00:14:57,290 --> 00:15:01,880
which are going<font color="#E5E5E5"> to be the two cases that</font>

244
00:14:59,870 --> 00:15:03,530
we're going<font color="#E5E5E5"> to try to attack the AP</font>

245
00:15:01,880 --> 00:15:05,930
under these two<font color="#E5E5E5"> different scenarios</font>

246
00:15:03,530 --> 00:15:09,140
because they say<font color="#E5E5E5"> that basically it's</font>

247
00:15:05,930 --> 00:15:10,910
secure<font color="#CCCCCC"> SL least secure common to all</font>

248
00:15:09,140 --> 00:15:13,340
devices<font color="#E5E5E5"> okay if we don't have web</font>

249
00:15:10,910 --> 00:15:15,469
devices this should be<font color="#CCCCCC"> a secure SW PA</font>

250
00:15:13,340 --> 00:15:18,110
and we found<font color="#CCCCCC"> that it doesn't</font><font color="#E5E5E5"> matter</font><font color="#CCCCCC"> if</font>

251
00:15:15,470 --> 00:15:20,660
they're web devices or not this<font color="#CCCCCC"> is only</font>

252
00:15:18,110 --> 00:15:26,000
a<font color="#CCCCCC"> secure as web so it's completely</font>

253
00:15:20,660 --> 00:15:27,560
unnecessary and<font color="#CCCCCC"> no way and another</font><font color="#E5E5E5"> thing</font>

254
00:15:26,000 --> 00:15:29,690
that we<font color="#CCCCCC"> found is that cisco only</font>

255
00:15:27,560 --> 00:15:31,760
acknowledged the possibility of doing a

256
00:15:29,690 --> 00:15:33,830
passive web key attack what we're going

257
00:15:31,760 --> 00:15:35,750
to<font color="#CCCCCC"> show</font><font color="#E5E5E5"> that you can do another types of</font>

258
00:15:33,830 --> 00:15:39,740
attack which are much more interesting

259
00:15:35,750 --> 00:15:41,930
basically the<font color="#E5E5E5"> first scenario which is a</font>

260
00:15:39,740 --> 00:15:43,280
trivial case the<font color="#E5E5E5"> easy Kate is when</font>

261
00:15:41,930 --> 00:15:45,469
they're still web stations hanging

262
00:15:43,280 --> 00:15:48,920
around so in this case what we have to

263
00:15:45,470 --> 00:15:51,620
do in order to crack the web key is we

264
00:15:48,920 --> 00:15:54,349
can do a standard attack that aircrack

265
00:15:51,620 --> 00:15:56,870
implements and what we do in this case

266
00:15:54,350 --> 00:15:58,670
is instead of<font color="#E5E5E5"> attacking the AP we attack</font>

267
00:15:56,870 --> 00:16:01,190
a web station<font color="#CCCCCC"> as their web stations</font>

268
00:15:58,670 --> 00:16:03,290
using the network we can just target one

269
00:16:01,190 --> 00:16:06,410
<font color="#CCCCCC">of those stations and in this manner we</font>

270
00:16:03,290 --> 00:16:08,000
<font color="#E5E5E5">forget about how the AP is configured it</font>

271
00:16:06,410 --> 00:16:10,490
doesn't really matter for<font color="#CCCCCC"> us because as</font>

272
00:16:08,000 --> 00:16:12,260
we are attacking a station it's the

273
00:16:10,490 --> 00:16:14,480
attack is completely oblivious of how

274
00:16:12,260 --> 00:16:17,390
the AP is configured so basically what

275
00:16:14,480 --> 00:16:21,200
we do is we passively wait and sniffed

276
00:16:17,390 --> 00:16:22,850
to find a broadcast<font color="#E5E5E5"> AARP frame which we</font>

277
00:16:21,200 --> 00:16:24,860
can distinguish even though it's

278
00:16:22,850 --> 00:16:27,680
encrypted by its characteristic size and

279
00:16:24,860 --> 00:16:29,870
as<font color="#E5E5E5"> they dimension all broadcast traffic</font>

280
00:16:27,680 --> 00:16:32,900
is encrypted<font color="#E5E5E5"> with web which is what all</font>

281
00:16:29,870 --> 00:16:34,850
<font color="#CCCCCC">stations</font><font color="#E5E5E5"> would understand so basically</font>

282
00:16:32,900 --> 00:16:36,709
<font color="#CCCCCC">what we do is we wait to see that type</font>

283
00:16:34,850 --> 00:16:38,870
of frame and we wait to<font color="#CCCCCC"> see a frame that</font>

284
00:16:36,710 --> 00:16:41,600
is respond that is answered by a web

285
00:16:38,870 --> 00:16:43,010
station and we can see this by<font color="#CCCCCC"> doing a</font>

286
00:16:41,600 --> 00:16:45,320
little bit of traffic analysis and

287
00:16:43,010 --> 00:16:48,260
seeing when the station replies so what

288
00:16:45,320 --> 00:16:50,780
we do is we capture that frame and since

289
00:16:48,260 --> 00:16:52,790
web has no replay protection weary

290
00:16:50,780 --> 00:16:54,980
inject the same frame singing it

291
00:16:52,790 --> 00:16:57,140
directly to the station that's why<font color="#E5E5E5"> we</font>

292
00:16:54,980 --> 00:16:59,450
have to set<font color="#E5E5E5"> the from the s bit which</font>

293
00:16:57,140 --> 00:17:02,089
means that<font color="#E5E5E5"> the packet was coming from</font>

294
00:16:59,450 --> 00:17:04,310
the AP so the station would see the

295
00:17:02,089 --> 00:17:07,520
packet and say<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> somebody</font><font color="#E5E5E5"> sending me</font>

296
00:17:04,310 --> 00:17:09,770
a frame it would decrypt it and since

297
00:17:07,520 --> 00:17:11,750
<font color="#E5E5E5">it's a valid frame it would be a nut</font><font color="#CCCCCC"> ARP</font>

298
00:17:09,770 --> 00:17:13,670
frame that we<font color="#CCCCCC"> captured the</font><font color="#E5E5E5"> station is</font>

299
00:17:11,750 --> 00:17:16,730
going to reply and each time<font color="#CCCCCC"> the station</font>

300
00:17:13,670 --> 00:17:19,010
replies we capture that traffic and that

301
00:17:16,730 --> 00:17:21,050
traffic will be valid web traffic sent

302
00:17:19,010 --> 00:17:22,699
by the station<font color="#E5E5E5"> so if</font><font color="#CCCCCC"> we capture only</font>

303
00:17:21,050 --> 00:17:24,649
that traffic and we gather enough of

304
00:17:22,699 --> 00:17:27,199
that traffic we can crack the web key

305
00:17:24,650 --> 00:17:30,740
under this scenario this<font color="#E5E5E5"> is a standard a</font>

306
00:17:27,199 --> 00:17:32,660
standard tool every play uses the

307
00:17:30,740 --> 00:17:35,420
performs<font color="#E5E5E5"> this attack in its standard</font>

308
00:17:32,660 --> 00:17:37,580
configuration basically the attack is

309
00:17:35,420 --> 00:17:40,220
using the minus<font color="#CCCCCC"> two option of</font><font color="#E5E5E5"> aircrack</font>

310
00:17:37,580 --> 00:17:42,679
and below the<font color="#E5E5E5"> documentation on how to</font>

311
00:17:40,220 --> 00:17:45,679
carry this out so this basically is the

312
00:17:42,680 --> 00:17:48,140
trivial case now you're going<font color="#E5E5E5"> to go into</font>

313
00:17:45,679 --> 00:17:49,640
the more interesting case when we assume

314
00:17:48,140 --> 00:17:52,580
<font color="#CCCCCC">that</font><font color="#E5E5E5"> they're no longer</font><font color="#CCCCCC"> in your web</font>

315
00:17:49,640 --> 00:17:55,100
stations connecting<font color="#CCCCCC"> to the AP so we</font><font color="#E5E5E5"> only</font>

316
00:17:52,580 --> 00:17:56,810
have wpa stations and this was a

317
00:17:55,100 --> 00:17:58,250
scenario that we found<font color="#E5E5E5"> our customers</font>

318
00:17:56,810 --> 00:18:00,379
because they had finished their

319
00:17:58,250 --> 00:18:02,810
migration but they never turned off this

320
00:18:00,380 --> 00:18:04,850
feature everybody forgot about it and

321
00:18:02,810 --> 00:18:07,040
they just<font color="#E5E5E5"> left it on since they said</font>

322
00:18:04,850 --> 00:18:09,320
thought that they had out tkip stations

323
00:18:07,040 --> 00:18:12,230
they thought they<font color="#CCCCCC"> were secure so what we</font>

324
00:18:09,320 --> 00:18:15,470
found is that we can still crack the web

325
00:18:12,230 --> 00:18:17,570
<font color="#CCCCCC">t it takes just a little bit more it</font>

326
00:18:15,470 --> 00:18:20,420
<font color="#E5E5E5">just</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> few</font><font color="#CCCCCC"> more</font><font color="#E5E5E5"> steps but it's fairly</font>

327
00:18:17,570 --> 00:18:22,970
<font color="#E5E5E5">easy what we do is we first authenticate</font>

328
00:18:20,420 --> 00:18:25,970
with the access point as a web station

329
00:18:22,970 --> 00:18:29,540
this is<font color="#E5E5E5"> very easy to do we can use</font>

330
00:18:25,970 --> 00:18:31,580
aircrack for this first<font color="#E5E5E5"> step and since</font>

331
00:18:29,540 --> 00:18:32,990
we authenticate as a web station we

332
00:18:31,580 --> 00:18:35,090
don't have to prove knowledge of the key

333
00:18:32,990 --> 00:18:36,950
as the web is configured and open

334
00:18:35,090 --> 00:18:39,050
authentication and this is a requirement

335
00:18:36,950 --> 00:18:41,000
by<font color="#E5E5E5"> Cisco in order for</font><font color="#CCCCCC"> it to work in</font><font color="#E5E5E5"> this</font>

336
00:18:39,050 --> 00:18:44,149
mode so we don't<font color="#CCCCCC"> have to prove knowledge</font>

337
00:18:41,000 --> 00:18:46,640
of the key then we wait<font color="#E5E5E5"> and capture</font>

338
00:18:44,150 --> 00:18:49,760
broadcast<font color="#CCCCCC"> ARP frame which will be weapon</font>

339
00:18:46,640 --> 00:18:52,070
cryptid as it's a broadcast frame we

340
00:18:49,760 --> 00:18:54,350
flip it<font color="#E5E5E5"> using what Diego described</font>

341
00:18:52,070 --> 00:18:56,450
earlier about message tampering and we

342
00:18:54,350 --> 00:18:59,209
do<font color="#E5E5E5"> this in an intelligent way so that</font>

343
00:18:56,450 --> 00:19:01,610
<font color="#E5E5E5">the air p frames becomes an air</font><font color="#CCCCCC"> p frame</font>

344
00:18:59,210 --> 00:19:04,430
from our station because<font color="#E5E5E5"> we know</font><font color="#CCCCCC"> whose</font>

345
00:19:01,610 --> 00:19:06,379
<font color="#CCCCCC">scent of AARP frame and we know our mac</font>

346
00:19:04,430 --> 00:19:08,180
address and we know the source MAC

347
00:19:06,380 --> 00:19:10,070
address of the sender so we can

348
00:19:08,180 --> 00:19:11,900
<font color="#E5E5E5">calculate a mask that even though we</font>

349
00:19:10,070 --> 00:19:14,780
don't know the specific contents of the

350
00:19:11,900 --> 00:19:17,120
frame we can build a mask that<font color="#CCCCCC"> if we</font>

351
00:19:14,780 --> 00:19:19,310
apply it to the frame we can obtain a

352
00:19:17,120 --> 00:19:25,370
new frame which is also weapon cryptid

353
00:19:19,310 --> 00:19:27,590
and valid but that is it is an<font color="#CCCCCC"> ARP frame</font>

354
00:19:25,370 --> 00:19:29,750
that as if we had sent it from our mac

355
00:19:27,590 --> 00:19:32,300
address so what wiII happen is that when

356
00:19:29,750 --> 00:19:34,850
we send this frame we send it to the AP

357
00:19:32,300 --> 00:19:37,430
and since we have authenticated as a web

358
00:19:34,850 --> 00:19:39,949
station the AP does not have any trouble

359
00:19:37,430 --> 00:19:42,080
in getting that frame and forwarding it

360
00:19:39,950 --> 00:19:45,320
along<font color="#E5E5E5"> because we are a web station so we</font>

361
00:19:42,080 --> 00:19:47,659
<font color="#E5E5E5">are allowed to send web traffic so</font>

362
00:19:45,320 --> 00:19:50,060
basically<font color="#CCCCCC"> the AP sends it along this</font>

363
00:19:47,660 --> 00:19:52,700
frame that the AP sense is rhian cryptid

364
00:19:50,060 --> 00:19:55,639
is also encrypted with web so we can<font color="#CCCCCC"> use</font>

365
00:19:52,700 --> 00:19:57,770
<font color="#CCCCCC">this frame for crypt</font><font color="#E5E5E5"> analysis purposes</font>

366
00:19:55,640 --> 00:20:02,030
so we have to be<font color="#CCCCCC"> sure and</font><font color="#E5E5E5"> capture these</font>

367
00:19:57,770 --> 00:20:03,660
frames and also the station that the for

368
00:20:02,030 --> 00:20:05,760
which the<font color="#CCCCCC"> original</font>

369
00:20:03,660 --> 00:20:08,910
<font color="#CCCCCC">your scent will reply and once the</font>

370
00:20:05,760 --> 00:20:11,160
station replies the reply will<font color="#CCCCCC"> be sent</font>

371
00:20:08,910 --> 00:20:13,020
back to us by<font color="#E5E5E5"> the AP and it will be sent</font>

372
00:20:11,160 --> 00:20:15,060
as a web frame since<font color="#E5E5E5"> we are a web</font>

373
00:20:13,020 --> 00:20:18,120
station so therefore<font color="#CCCCCC"> we have two</font>

374
00:20:15,060 --> 00:20:20,129
different two for each frame we sent we

375
00:20:18,120 --> 00:20:21,389
have two frames that are weapon cryptid

376
00:20:20,130 --> 00:20:24,420
and that can<font color="#CCCCCC"> be used for cryptanalytic</font>

377
00:20:21,390 --> 00:20:26,910
purposes so then what we do is we run

378
00:20:24,420 --> 00:20:30,630
aircrack against it to<font color="#E5E5E5"> obtain the web</font>

379
00:20:26,910 --> 00:20:34,980
key basically at the full<font color="#E5E5E5"> the URL below</font>

380
00:20:30,630 --> 00:20:37,590
is our site<font color="#E5E5E5"> for research for core left</font>

381
00:20:34,980 --> 00:20:39,930
research and you're going to see what

382
00:20:37,590 --> 00:20:42,389
<font color="#E5E5E5">we're going to demo we made</font><font color="#CCCCCC"> some patches</font>

383
00:20:39,930 --> 00:20:45,870
<font color="#E5E5E5">to</font><font color="#CCCCCC"> aircraft so that we can carry</font><font color="#E5E5E5"> out</font>

384
00:20:42,390 --> 00:20:47,790
this attack using aircrack so<font color="#E5E5E5"> basically</font>

385
00:20:45,870 --> 00:20:49,620
<font color="#CCCCCC">I'm going to go over this with a diagram</font>

386
00:20:47,790 --> 00:20:52,350
because i'm pretty<font color="#E5E5E5"> sure nobody</font>

387
00:20:49,620 --> 00:20:54,149
understood before so<font color="#E5E5E5"> i'm trying to this</font>

388
00:20:52,350 --> 00:20:56,189
is the main focus of the talk so<font color="#E5E5E5"> i'm</font>

389
00:20:54,150 --> 00:20:57,870
gonna<font color="#E5E5E5"> go over again so</font><font color="#CCCCCC"> that when we</font><font color="#E5E5E5"> see</font>

390
00:20:56,190 --> 00:21:00,510
the demo everybody can follow it

391
00:20:57,870 --> 00:21:03,120
<font color="#E5E5E5">basically the scenarios this one we</font><font color="#CCCCCC"> have</font>

392
00:21:00,510 --> 00:21:06,930
a to<font color="#CCCCCC"> WPI stations and</font><font color="#E5E5E5"> we're the attacker</font>

393
00:21:03,120 --> 00:21:10,679
then the station a<font color="#E5E5E5"> sensor</font><font color="#CCCCCC"> arp frame</font>

394
00:21:06,930 --> 00:21:14,550
which is TK i keep p tkip encrypted

395
00:21:10,680 --> 00:21:17,610
because it's a you every time as that a

396
00:21:14,550 --> 00:21:20,040
wp8 asian stocks to the AP even if it's

397
00:21:17,610 --> 00:21:23,939
sending<font color="#CCCCCC"> broadcast traffic it encrypted</font>

398
00:21:20,040 --> 00:21:27,810
with tkip or<font color="#CCCCCC"> rice if it's using wpa two</font>

399
00:21:23,940 --> 00:21:29,910
because in wpa and wpa2 but since

400
00:21:27,810 --> 00:21:33,000
everything has to go through the IP

401
00:21:29,910 --> 00:21:35,250
stations never use the broadcast key to

402
00:21:33,000 --> 00:21:37,770
encrypt they only use the urine cache

403
00:21:35,250 --> 00:21:39,690
key to encrypt and then the AP uses a

404
00:21:37,770 --> 00:21:43,139
broadcast key if it has to forward it

405
00:21:39,690 --> 00:21:46,470
along so basically this is sent in the

406
00:21:43,140 --> 00:21:50,520
air as a unicast frame which the AP then

407
00:21:46,470 --> 00:21:53,310
re-encrypt as a web frame because the

408
00:21:50,520 --> 00:21:55,560
multicast cipher is web and it sent on

409
00:21:53,310 --> 00:21:57,659
the air so this frame we can capture

410
00:21:55,560 --> 00:22:00,960
<font color="#E5E5E5">because it's a web frame that we need</font>

411
00:21:57,660 --> 00:22:03,570
then the station a be<font color="#E5E5E5"> sorry</font><font color="#CCCCCC"> we'll see</font>

412
00:22:00,960 --> 00:22:05,820
that frame the RP frame i will say<font color="#CCCCCC"> okay</font>

413
00:22:03,570 --> 00:22:08,010
<font color="#E5E5E5">now i have to answer that it will send</font>

414
00:22:05,820 --> 00:22:11,580
an unique ass reply encrypted with tkip

415
00:22:08,010 --> 00:22:17,470
this reply will<font color="#CCCCCC"> be forwarded by the AP</font>

416
00:22:11,580 --> 00:22:20,168
<font color="#CCCCCC">onto station a and also TK key encrypted</font>

417
00:22:17,470 --> 00:22:23,530
using the key that<font color="#CCCCCC"> the AP and station a</font>

418
00:22:20,169 --> 00:22:25,450
share<font color="#CCCCCC"> and what we do as attackers is the</font>

419
00:22:23,530 --> 00:22:28,629
frame that we<font color="#CCCCCC"> had captured we will flip</font>

420
00:22:25,450 --> 00:22:30,940
it to turn it into a the same who has

421
00:22:28,630 --> 00:22:32,770
<font color="#CCCCCC">requests for station B but this time</font>

422
00:22:30,940 --> 00:22:35,679
coming from our source MAC address and

423
00:22:32,770 --> 00:22:37,750
then what will<font color="#CCCCCC"> happen is that the AP</font>

424
00:22:35,679 --> 00:22:39,520
will forward it that frame is a new

425
00:22:37,750 --> 00:22:42,280
weapon encrypted frame which we can use

426
00:22:39,520 --> 00:22:45,039
<font color="#CCCCCC">for crypt analysis and then station B</font>

427
00:22:42,280 --> 00:22:48,158
will reply also<font color="#CCCCCC"> in tkp because it's a</font>

428
00:22:45,039 --> 00:22:51,100
web the<font color="#CCCCCC"> wpa station but the AP will</font>

429
00:22:48,159 --> 00:22:52,960
<font color="#CCCCCC">forward it to web with web to us because</font>

430
00:22:51,100 --> 00:22:55,600
we are web station and we have

431
00:22:52,960 --> 00:22:57,100
authenticated as a web station so the AP

432
00:22:55,600 --> 00:23:00,250
tracks the encryption<font color="#CCCCCC"> everybody's</font><font color="#E5E5E5"> using</font>

433
00:22:57,100 --> 00:23:02,320
and he sends<font color="#E5E5E5"> it along in the proper</font>

434
00:23:00,250 --> 00:23:06,520
manner to us so that's another frame we

435
00:23:02,320 --> 00:23:07,780
can use free crypt<font color="#E5E5E5"> analysis so here what</font>

436
00:23:06,520 --> 00:23:10,179
I'm going to talk a little bit is that

437
00:23:07,780 --> 00:23:11,889
<font color="#E5E5E5">this a similar attack to this one can be</font>

438
00:23:10,179 --> 00:23:14,740
<font color="#E5E5E5">carried out without</font><font color="#CCCCCC"> having to patch</font>

439
00:23:11,890 --> 00:23:16,870
aircrack but it has a few Cavett's that

440
00:23:14,740 --> 00:23:20,230
must be taken care of the first few

441
00:23:16,870 --> 00:23:22,479
steps are the same<font color="#E5E5E5"> but what we do is we</font>

442
00:23:20,230 --> 00:23:26,020
instead<font color="#CCCCCC"> of be flipping the frame we just</font>

443
00:23:22,480 --> 00:23:27,820
rien ject the same frame and the problem

444
00:23:26,020 --> 00:23:30,190
that<font color="#CCCCCC"> it has is that we're only going to</font>

445
00:23:27,820 --> 00:23:31,600
have one frame sent per frame that we

446
00:23:30,190 --> 00:23:33,850
sent because it's going<font color="#E5E5E5"> to be</font><font color="#CCCCCC"> with the</font>

447
00:23:31,600 --> 00:23:36,250
AP forwards and the other problem is

448
00:23:33,850 --> 00:23:38,379
that aircrack either expects<font color="#E5E5E5"> the network</font>

449
00:23:36,250 --> 00:23:40,659
to be wpa or it affects the network to

450
00:23:38,380 --> 00:23:44,169
be web so when we<font color="#E5E5E5"> run the cryptanalytic</font>

451
00:23:40,659 --> 00:23:46,960
process on it if it detects the network

452
00:23:44,169 --> 00:23:48,909
has<font color="#E5E5E5"> wept and they're tkip packets in</font><font color="#CCCCCC"> the</font>

453
00:23:46,960 --> 00:23:50,980
capture what it will do is<font color="#CCCCCC"> it will throw</font>

454
00:23:48,909 --> 00:23:52,720
off the crypt analysis because aircraft

455
00:23:50,980 --> 00:23:56,860
assumes that the whole network is web

456
00:23:52,720 --> 00:23:58,240
which because when the guy from America

457
00:23:56,860 --> 00:23:59,320
programmed this they didn't<font color="#E5E5E5"> think that</font>

458
00:23:58,240 --> 00:24:02,500
there was going to be the<font color="#E5E5E5"> case where you</font>

459
00:23:59,320 --> 00:24:05,740
<font color="#E5E5E5">had a mixture of tkp and web traffic</font>

460
00:24:02,500 --> 00:24:08,080
<font color="#E5E5E5">user in the same AP so basically this</font>

461
00:24:05,740 --> 00:24:11,470
can be done with<font color="#E5E5E5"> their crack but you</font>

462
00:24:08,080 --> 00:24:14,020
have to do it with a interactive mode

463
00:24:11,470 --> 00:24:15,460
and looking at<font color="#CCCCCC"> what you're</font><font color="#E5E5E5"> doing so</font>

464
00:24:14,020 --> 00:24:17,590
basically what we did is we are

465
00:24:15,460 --> 00:24:19,179
automatized this and what we<font color="#CCCCCC"> also did</font>

466
00:24:17,590 --> 00:24:21,639
was patch aircrack so that when it

467
00:24:19,179 --> 00:24:23,530
<font color="#E5E5E5">detected that it could filter out web</font>

468
00:24:21,640 --> 00:24:25,330
traffic and dkp traffic so<font color="#CCCCCC"> that the</font>

469
00:24:23,530 --> 00:24:27,070
crypt analysis were not thrown off and

470
00:24:25,330 --> 00:24:29,559
that you don't have<font color="#CCCCCC"> to filter the</font>

471
00:24:27,070 --> 00:24:31,299
capture before running it in<font color="#E5E5E5"> the air</font>

472
00:24:29,559 --> 00:24:33,190
<font color="#E5E5E5">crack</font>

473
00:24:31,299 --> 00:24:37,239
so here's<font color="#E5E5E5"> I'm going to show a little</font>

474
00:24:33,190 --> 00:24:38,889
demo we have a video<font color="#CCCCCC"> of what</font><font color="#E5E5E5"> we did so</font>

475
00:24:37,239 --> 00:24:41,110
<font color="#E5E5E5">basically this first step is I'm</font>

476
00:24:38,889 --> 00:24:44,889
starting Wireshark and sniffer mode and

477
00:24:41,110 --> 00:24:46,988
here I'm going<font color="#E5E5E5"> to implement a filter</font>

478
00:24:44,889 --> 00:24:50,229
which basically captures beacon frames

479
00:24:46,989 --> 00:24:53,080
from our AP so that we don't have<font color="#CCCCCC"> that a</font>

480
00:24:50,230 --> 00:24:56,200
lot<font color="#E5E5E5"> of trash going around in the air</font>

481
00:24:53,080 --> 00:24:58,658
basically here<font color="#CCCCCC"> I'm going to show that we</font>

482
00:24:56,200 --> 00:25:00,249
have a beacon frame and I'm going<font color="#E5E5E5"> to</font>

483
00:24:58,659 --> 00:25:03,369
<font color="#E5E5E5">show what Diego is talking</font><font color="#CCCCCC"> about how to</font>

484
00:25:00,249 --> 00:25:05,320
detect it we see<font color="#CCCCCC"> that the SSID is my</font>

485
00:25:03,369 --> 00:25:09,129
great which is what we<font color="#E5E5E5"> set it to be and</font>

486
00:25:05,320 --> 00:25:11,230
that we<font color="#E5E5E5"> are using that</font><font color="#CCCCCC"> in the WPA</font>

487
00:25:09,129 --> 00:25:14,109
information element we have a cipher

488
00:25:11,230 --> 00:25:17,529
suite of web for the multicast cipher

489
00:25:14,109 --> 00:25:19,029
and a única cipher suite of tkip for

490
00:25:17,529 --> 00:25:21,309
unicast traffic and that we are<font color="#E5E5E5"> using</font>

491
00:25:19,029 --> 00:25:24,309
pre-shared key mode we could be using

492
00:25:21,309 --> 00:25:30,970
802 dot1x just what is easier to<font color="#E5E5E5"> set up</font>

493
00:25:24,309 --> 00:25:33,580
set it up in<font color="#E5E5E5"> this way so now what we do</font>

494
00:25:30,970 --> 00:25:35,590
is we show the same thing in our patched

495
00:25:33,580 --> 00:25:37,989
version of kismet as you can see we'll

496
00:25:35,590 --> 00:25:40,480
probably can't because that background

497
00:25:37,989 --> 00:25:44,139
screws everything up but<font color="#E5E5E5"> it's marked in</font>

498
00:25:40,480 --> 00:25:46,389
red and<font color="#CCCCCC"> it's detected as a WPA migration</font>

499
00:25:44,139 --> 00:25:49,479
mode AP which you can show here and

500
00:25:46,389 --> 00:25:51,699
basically we added this capability to

501
00:25:49,480 --> 00:25:53,739
aircraft<font color="#E5E5E5"> so that to kismet so that when</font>

502
00:25:51,700 --> 00:25:56,049
somebody bumps into this they say<font color="#CCCCCC"> okay</font>

503
00:25:53,739 --> 00:26:01,299
it's red it's vulnerable it's the same

504
00:25:56,049 --> 00:26:04,389
thing<font color="#E5E5E5"> as</font><font color="#CCCCCC"> a web AP now what we do is we</font>

505
00:26:01,299 --> 00:26:06,279
<font color="#CCCCCC">are</font><font color="#E5E5E5"> going to filter the traffic based on</font>

506
00:26:04,389 --> 00:26:09,609
a particular station that has<font color="#E5E5E5"> joined the</font>

507
00:26:06,279 --> 00:26:12,009
network as a tkp station at WPI station

508
00:26:09,609 --> 00:26:15,789
and if<font color="#E5E5E5"> we see the frames that it sends</font>

509
00:26:12,009 --> 00:26:18,279
if we look<font color="#E5E5E5"> at the data frames that it's</font>

510
00:26:15,789 --> 00:26:23,859
sending what we're going to see is that

511
00:26:18,279 --> 00:26:26,080
these frames that have the frame control

512
00:26:23,859 --> 00:26:29,710
is 41 which means that<font color="#E5E5E5"> this frame was</font>

513
00:26:26,080 --> 00:26:33,100
sent from the station<font color="#E5E5E5"> to</font><font color="#CCCCCC"> the AP these</font>

514
00:26:29,710 --> 00:26:35,590
are encrypted that's our bssid the

515
00:26:33,100 --> 00:26:38,049
source MAC address of that station and

516
00:26:35,590 --> 00:26:41,740
as you can see it's encrypted using tkip

517
00:26:38,049 --> 00:26:44,440
because that's a tkp station and this

518
00:26:41,740 --> 00:26:45,250
frame was forwarded by the AP and it was

519
00:26:44,440 --> 00:26:47,200
also forward

520
00:26:45,250 --> 00:26:49,570
using tkip because<font color="#CCCCCC"> I was talking to</font>

521
00:26:47,200 --> 00:26:52,660
another station that was also<font color="#CCCCCC"> wpa</font>

522
00:26:49,570 --> 00:26:56,500
station so here you see all<font color="#CCCCCC"> wpa traffic</font>

523
00:26:52,660 --> 00:27:00,370
until we go and we set another filter

524
00:26:56,500 --> 00:27:03,190
that we look<font color="#CCCCCC"> for web frames we do this</font>

525
00:27:00,370 --> 00:27:06,760
by using the by looking for frames that

526
00:27:03,190 --> 00:27:08,650
have an IV a web IV and in this way we

527
00:27:06,760 --> 00:27:11,320
will filter everything<font color="#E5E5E5"> for web frames</font>

528
00:27:08,650 --> 00:27:14,050
and if we look<font color="#E5E5E5"> at these web frames what</font>

529
00:27:11,320 --> 00:27:16,600
we're going to see is that the

530
00:27:14,050 --> 00:27:18,580
destination are always either multicast

531
00:27:16,600 --> 00:27:22,870
destinations or broadcast destinations

532
00:27:18,580 --> 00:27:25,270
and that the interesting<font color="#E5E5E5"> thing</font><font color="#CCCCCC"> is that</font>

533
00:27:22,870 --> 00:27:27,580
all the frames are sent from the AP as

534
00:27:25,270 --> 00:27:29,860
you can see they<font color="#E5E5E5"> have the from des bit</font>

535
00:27:27,580 --> 00:27:32,260
set so that<font color="#E5E5E5"> means that their frames that</font>

536
00:27:29,860 --> 00:27:33,939
are forwarded by the AP and since there

537
00:27:32,260 --> 00:27:37,120
were broadcast frames their weapon

538
00:27:33,940 --> 00:27:39,130
cryptid and in this<font color="#E5E5E5"> scenario wouldn't</font>

539
00:27:37,120 --> 00:27:46,479
have a web station running it was<font color="#E5E5E5"> just</font>

540
00:27:39,130 --> 00:27:52,420
the AP and these two<font color="#E5E5E5"> wpa stations so now</font>

541
00:27:46,480 --> 00:27:53,590
we're going<font color="#E5E5E5"> to go</font><font color="#CCCCCC"> on with the what we're</font>

542
00:27:52,420 --> 00:27:56,860
going to do is we're going to set the

543
00:27:53,590 --> 00:27:59,679
encryption key<font color="#E5E5E5"> Wireshark has a</font>

544
00:27:56,860 --> 00:28:02,110
<font color="#CCCCCC">possibility of decrypting wireless</font>

545
00:27:59,680 --> 00:28:05,830
traffic with you set the key so<font color="#E5E5E5"> we set</font>

546
00:28:02,110 --> 00:28:08,469
the key and we enable decryption and now

547
00:28:05,830 --> 00:28:11,199
we<font color="#CCCCCC"> apply this configuration change and</font>

548
00:28:08,470 --> 00:28:12,970
what we<font color="#E5E5E5"> see that it's there Cisco</font>

549
00:28:11,200 --> 00:28:15,220
discovery<font color="#E5E5E5"> protocol packets which are</font>

550
00:28:12,970 --> 00:28:18,790
multicast and they are pre frames which

551
00:28:15,220 --> 00:28:22,600
are broadcast so then what we do is we

552
00:28:18,790 --> 00:28:24,430
carry out the attack as we said first of

553
00:28:22,600 --> 00:28:26,860
<font color="#E5E5E5">all we have to do is start capturing</font>

554
00:28:24,430 --> 00:28:29,770
every single frame<font color="#E5E5E5"> that's on the air we</font>

555
00:28:26,860 --> 00:28:32,110
do this with arrow dump then we perform

556
00:28:29,770 --> 00:28:38,050
our fake authentication so that the AP

557
00:28:32,110 --> 00:28:41,620
believes that we are a web station this

558
00:28:38,050 --> 00:28:43,480
<font color="#CCCCCC">is executed successfully and as you see</font>

559
00:28:41,620 --> 00:28:45,219
we don't<font color="#E5E5E5"> have to have any knowledge of</font>

560
00:28:43,480 --> 00:28:49,420
the key<font color="#E5E5E5"> and order for that to work and</font>

561
00:28:45,220 --> 00:28:51,970
then we do our attack which is using the

562
00:28:49,420 --> 00:28:56,410
minus<font color="#E5E5E5"> W option that we</font><font color="#CCCCCC"> added to aircrack</font>

563
00:28:51,970 --> 00:28:58,750
and now aircrack is just<font color="#E5E5E5"> waiting to hear</font>

564
00:28:56,410 --> 00:29:01,270
an<font color="#CCCCCC"> arp frame once it does it will</font>

565
00:28:58,750 --> 00:29:06,430
start it will flip it as we showed

566
00:29:01,270 --> 00:29:08,710
before and start sending it out again so

567
00:29:06,430 --> 00:29:10,600
<font color="#CCCCCC">there it happens and as you see the</font>

568
00:29:08,710 --> 00:29:12,550
number of air p frames are<font color="#E5E5E5"> increasing in</font>

569
00:29:10,600 --> 00:29:16,360
the air because<font color="#E5E5E5"> they're aircrack is</font>

570
00:29:12,550 --> 00:29:18,909
injecting more air p traffic and if<font color="#E5E5E5"> we</font>

571
00:29:16,360 --> 00:29:20,860
look<font color="#E5E5E5"> in</font><font color="#CCCCCC"> the wireshark capture which is</font>

572
00:29:18,910 --> 00:29:23,380
decrypting everything because we set the

573
00:29:20,860 --> 00:29:25,719
key what we can do is we can look at the

574
00:29:23,380 --> 00:29:28,330
frames and that's a frame that<font color="#E5E5E5"> we sent</font>

575
00:29:25,720 --> 00:29:30,910
as you can see it<font color="#E5E5E5"> has the 2ds bit set</font>

576
00:29:28,330 --> 00:29:33,340
and if you<font color="#E5E5E5"> look on the right column the</font>

577
00:29:30,910 --> 00:29:35,410
IP addresses are all different that's

578
00:29:33,340 --> 00:29:37,600
why because when we apply the mask we

579
00:29:35,410 --> 00:29:39,940
don't<font color="#E5E5E5"> know what the AP the IP</font><font color="#CCCCCC"> address is</font>

580
00:29:37,600 --> 00:29:43,510
going to end up being we just change it

581
00:29:39,940 --> 00:29:47,260
to something different to try to avoid

582
00:29:43,510 --> 00:29:49,960
IP conflicts in the network and these

583
00:29:47,260 --> 00:29:51,520
<font color="#E5E5E5">are</font><font color="#CCCCCC"> on web frames that this is the</font>

584
00:29:49,960 --> 00:29:53,800
<font color="#E5E5E5">response that was sent to us by the</font>

585
00:29:51,520 --> 00:29:56,320
<font color="#E5E5E5">station and since the AP since we're web</font>

586
00:29:53,800 --> 00:29:59,530
station the AP scented<font color="#CCCCCC"> wipe encrypted</font>

587
00:29:56,320 --> 00:30:04,030
and now what we're going to do is we're

588
00:29:59,530 --> 00:30:06,550
going to run aircrack and force it<font color="#CCCCCC"> to</font>

589
00:30:04,030 --> 00:30:09,010
detect the network as a web network and

590
00:30:06,550 --> 00:30:10,870
what we did<font color="#E5E5E5"> is that we patched it so</font>

591
00:30:09,010 --> 00:30:14,770
when it did this it completely

592
00:30:10,870 --> 00:30:18,790
disregards any tea cake p frames so that

593
00:30:14,770 --> 00:30:20,680
the crypt analysis works<font color="#CCCCCC"> ok so that it's</font>

594
00:30:18,790 --> 00:30:24,790
going<font color="#E5E5E5"> to start cracking it's going to</font>

595
00:30:20,680 --> 00:30:27,850
fail because it hasn't still capture

596
00:30:24,790 --> 00:30:30,760
enough traffic and then we<font color="#E5E5E5"> run it again</font>

597
00:30:27,850 --> 00:30:34,030
and in the<font color="#E5E5E5"> meantime we capture enough</font>

598
00:30:30,760 --> 00:30:36,730
traffic to crack the web key so there

599
00:30:34,030 --> 00:30:38,440
<font color="#CCCCCC">you have the</font><font color="#E5E5E5"> web key so basically in the</font>

600
00:30:36,730 --> 00:30:40,690
hardest scenario possible where you

601
00:30:38,440 --> 00:30:44,680
don't<font color="#E5E5E5"> have</font><font color="#CCCCCC"> any web stations you can</font>

602
00:30:40,690 --> 00:30:47,350
still crack the web key now what we're

603
00:30:44,680 --> 00:30:49,750
going to do is since we looked at this

604
00:30:47,350 --> 00:30:51,699
and we said<font color="#CCCCCC"> ok now we see that an AP</font>

605
00:30:49,750 --> 00:30:53,650
running in this mode offers no

606
00:30:51,700 --> 00:30:56,860
additional security to an AP running

607
00:30:53,650 --> 00:30:58,630
only<font color="#E5E5E5"> web so what we started to do was to</font>

608
00:30:56,860 --> 00:31:01,330
see if<font color="#E5E5E5"> there was any other security</font>

609
00:30:58,630 --> 00:31:04,450
features at<font color="#CCCCCC"> Cisco offered in order to</font>

610
00:31:01,330 --> 00:31:06,909
<font color="#E5E5E5">improve the security of this WP</font>

611
00:31:04,450 --> 00:31:09,190
emigration mode and what we found is an

612
00:31:06,910 --> 00:31:12,700
option crawled broadcast key rotation

613
00:31:09,190 --> 00:31:15,460
which basically what they say

614
00:31:12,700 --> 00:31:17,440
is that in WP emigration mode this

615
00:31:15,460 --> 00:31:20,320
feature significantly improves the

616
00:31:17,440 --> 00:31:23,020
security when there are no static web

617
00:31:20,320 --> 00:31:26,230
clients meaning our scenario we only

618
00:31:23,020 --> 00:31:28,330
have<font color="#CCCCCC"> wpa stations so what we started to</font>

619
00:31:26,230 --> 00:31:32,350
do<font color="#CCCCCC"> was look</font><font color="#E5E5E5"> to see what this top bracket</font>

620
00:31:28,330 --> 00:31:34,210
key rotation did and it basically in the

621
00:31:32,350 --> 00:31:35,919
<font color="#E5E5E5">documentation it says that what it does</font>

622
00:31:34,210 --> 00:31:38,680
is that when there are no longer in the

623
00:31:35,920 --> 00:31:41,290
web stations using the static web

624
00:31:38,680 --> 00:31:43,480
stations using the network it generates

625
00:31:41,290 --> 00:31:46,510
a new broadcast key dynamically and

626
00:31:43,480 --> 00:31:48,760
sends it<font color="#E5E5E5"> out to all</font><font color="#CCCCCC"> the web stations so</font>

627
00:31:46,510 --> 00:31:50,680
to all the stations sorry so that

628
00:31:48,760 --> 00:31:52,840
instead<font color="#E5E5E5"> of using the statically</font>

629
00:31:50,680 --> 00:31:55,990
configured web key you're using a new

630
00:31:52,840 --> 00:31:58,149
random key and in order<font color="#E5E5E5"> to configure</font>

631
00:31:55,990 --> 00:32:01,060
this in a<font color="#CCCCCC"> Cisco IP</font><font color="#E5E5E5"> you have to use the</font>

632
00:31:58,150 --> 00:32:02,890
broadcast key change command you specify

633
00:32:01,060 --> 00:32:06,070
the number of seconds that the key

634
00:32:02,890 --> 00:32:08,350
change that the key rotates and you have

635
00:32:06,070 --> 00:32:11,800
to specify<font color="#E5E5E5"> this mode capability change</font>

636
00:32:08,350 --> 00:32:13,929
so basically<font color="#E5E5E5"> what happens when you're</font>

637
00:32:11,800 --> 00:32:16,480
using this is what we see in this

638
00:32:13,930 --> 00:32:19,480
diagram you have a<font color="#E5E5E5"> wpa station and</font>

639
00:32:16,480 --> 00:32:22,840
you're exchanging frames with the AP and

640
00:32:19,480 --> 00:32:25,750
everything is working<font color="#E5E5E5"> ok and then the AP</font>

641
00:32:22,840 --> 00:32:28,600
chooses a new broadcast key and informs

642
00:32:25,750 --> 00:32:31,570
the station of this fact by sending by

643
00:32:28,600 --> 00:32:35,290
performing an<font color="#CCCCCC"> ef-4 frame exchange and</font>

644
00:32:31,570 --> 00:32:37,210
now<font color="#E5E5E5"> all the</font><font color="#CCCCCC"> WPA stations have a new</font>

645
00:32:35,290 --> 00:32:39,850
broadcast key set which is the random

646
00:32:37,210 --> 00:32:42,190
and was picked by<font color="#E5E5E5"> the AP so then normal</font>

647
00:32:39,850 --> 00:32:44,709
communications keep on going and after<font color="#CCCCCC"> a</font>

648
00:32:42,190 --> 00:32:47,050
certain period of<font color="#CCCCCC"> time the key interval</font>

649
00:32:44,710 --> 00:32:50,050
dies out so you have to rotate the key

650
00:32:47,050 --> 00:32:52,930
and I new keys chosen<font color="#E5E5E5"> by the AP and sent</font>

651
00:32:50,050 --> 00:32:54,790
to all<font color="#E5E5E5"> WPA stations so that they can</font>

652
00:32:52,930 --> 00:32:57,250
decrypt the broadcast traffic using this

653
00:32:54,790 --> 00:33:01,600
new key and what happens when our web

654
00:32:57,250 --> 00:33:04,990
station joint is that it<font color="#CCCCCC"> triggers an ear</font>

655
00:33:01,600 --> 00:33:07,959
full frame exchange but going going back

656
00:33:04,990 --> 00:33:11,350
to<font color="#CCCCCC"> the</font><font color="#E5E5E5"> preview statically configured key</font>

657
00:33:07,960 --> 00:33:12,910
so that<font color="#E5E5E5"> everybody can use the same key</font>

658
00:33:11,350 --> 00:33:15,520
and decrypt the traffic as there's no

659
00:33:12,910 --> 00:33:19,030
way of having that state informing that

660
00:33:15,520 --> 00:33:22,420
station of the<font color="#E5E5E5"> random key it has to go</font>

661
00:33:19,030 --> 00:33:24,100
back<font color="#E5E5E5"> and use the statically config is</font>

662
00:33:22,420 --> 00:33:26,600
the only one that the web station knows

663
00:33:24,100 --> 00:33:28,789
then normal frame exchange of

664
00:33:26,600 --> 00:33:30,559
first and after a while when that

665
00:33:28,789 --> 00:33:33,379
station leaves when the web station

666
00:33:30,559 --> 00:33:35,418
leaves the IP is once against free to

667
00:33:33,380 --> 00:33:40,850
choose a random key and inform that to

668
00:33:35,419 --> 00:33:42,919
<font color="#CCCCCC">all the</font><font color="#E5E5E5"> WPA stations so basically in</font>

669
00:33:40,850 --> 00:33:45,559
order to bypass broadcast key rotation

670
00:33:42,919 --> 00:33:47,660
all we have<font color="#CCCCCC"> to do is</font><font color="#E5E5E5"> tell the AP</font><font color="#CCCCCC"> that we</font>

671
00:33:45,559 --> 00:33:51,379
have joined the<font color="#CCCCCC"> network as a web station</font>

672
00:33:47,660 --> 00:33:53,179
and that we can't do dynamic rotation so

673
00:33:51,380 --> 00:33:55,520
<font color="#E5E5E5">basically the AP falls back to</font><font color="#CCCCCC"> the</font>

674
00:33:53,179 --> 00:33:57,530
statically configured key and we have

675
00:33:55,520 --> 00:34:00,379
exactly the same scenario as before and

676
00:33:57,530 --> 00:34:02,210
if we<font color="#CCCCCC"> look at what we were doing this is</font>

677
00:34:00,380 --> 00:34:04,970
the first step of a scenario<font color="#E5E5E5"> of what we</font>

678
00:34:02,210 --> 00:34:06,890
of our attack mode so basically<font color="#E5E5E5"> this</font>

679
00:34:04,970 --> 00:34:09,440
feature does none it has the security at

680
00:34:06,890 --> 00:34:12,379
all it<font color="#E5E5E5"> doesn't change any of these facts</font>

681
00:34:09,440 --> 00:34:15,260
so in order to bypass this we do a<font color="#E5E5E5"> fake</font>

682
00:34:12,379 --> 00:34:19,639
<font color="#E5E5E5">atenton with aircraft here i'm going to</font>

683
00:34:15,260 --> 00:34:22,129
show a demo of this working the first

684
00:34:19,639 --> 00:34:26,899
thing<font color="#CCCCCC"> i'm going to do is</font><font color="#E5E5E5"> set the web key</font>

685
00:34:22,129 --> 00:34:28,759
in wireshark and also set the<font color="#E5E5E5"> wpa key so</font>

686
00:34:26,899 --> 00:34:36,350
that white shark can decrypt both WEP

687
00:34:28,760 --> 00:34:40,070
and wpa traffic on site once this is

688
00:34:36,350 --> 00:34:43,100
enabled i'm going<font color="#E5E5E5"> to start monitoring</font>

689
00:34:40,070 --> 00:34:45,200
the frames that are in the air and i'm

690
00:34:43,100 --> 00:34:49,310
going<font color="#E5E5E5"> to pick a filter looking for</font>

691
00:34:45,199 --> 00:34:51,888
frames from our AP that are either web

692
00:34:49,310 --> 00:34:54,590
or<font color="#CCCCCC"> EF 0 frame exchanges efo frame</font>

693
00:34:51,889 --> 00:34:57,350
exchanges are encrypted with tkip so

694
00:34:54,590 --> 00:34:59,330
that's why<font color="#CCCCCC"> i had to set the wpa key so</font>

695
00:34:57,350 --> 00:35:02,210
that we could find<font color="#CCCCCC"> the airport frames</font>

696
00:34:59,330 --> 00:35:03,980
and look at them decrypted and what I'm

697
00:35:02,210 --> 00:35:06,290
going<font color="#CCCCCC"> to see is that this is when the</font>

698
00:35:03,980 --> 00:35:08,960
station joins and an earful from

699
00:35:06,290 --> 00:35:12,859
exchange of<font color="#E5E5E5"> course this is a</font><font color="#CCCCCC"> WPA station</font>

700
00:35:08,960 --> 00:35:14,540
joining and if we look<font color="#E5E5E5"> at these these</font>

701
00:35:12,859 --> 00:35:17,090
are broadcast frames their weapon

702
00:35:14,540 --> 00:35:19,130
cryptid but although why shark knows the

703
00:35:17,090 --> 00:35:20,869
web key it<font color="#E5E5E5"> can decrypt the frames</font>

704
00:35:19,130 --> 00:35:24,920
because these frames are encrypted with

705
00:35:20,869 --> 00:35:27,050
<font color="#CCCCCC">that random key that da p chose so if we</font>

706
00:35:24,920 --> 00:35:28,670
try to crack this key what we're<font color="#E5E5E5"> going</font>

707
00:35:27,050 --> 00:35:32,270
to end up cracking is a key that's only

708
00:35:28,670 --> 00:35:34,490
valid for a short period of time so it's

709
00:35:32,270 --> 00:35:36,890
completely<font color="#E5E5E5"> useless to crack that web key</font>

710
00:35:34,490 --> 00:35:38,209
so basically now what we do is we

711
00:35:36,890 --> 00:35:40,490
authenticate using the fake

712
00:35:38,210 --> 00:35:43,130
authentication as you can see

713
00:35:40,490 --> 00:35:45,560
now we are able to<font color="#E5E5E5"> decrypt them with the</font>

714
00:35:43,130 --> 00:35:49,940
broadcast traffic now we see<font color="#E5E5E5"> that there</font>

715
00:35:45,560 --> 00:35:52,820
WL<font color="#CCCCCC"> CCP frames and igmp frames and that</font>

716
00:35:49,940 --> 00:35:55,100
Aniyah poem exchange had a<font color="#E5E5E5"> court before</font>

717
00:35:52,820 --> 00:35:57,650
in the<font color="#CCCCCC"> capture and that was telling the</font>

718
00:35:55,100 --> 00:36:01,190
<font color="#E5E5E5">WPA station that was in the network what</font>

719
00:35:57,650 --> 00:36:09,140
the new key was which was the statically

720
00:36:01,190 --> 00:36:13,610
configured key<font color="#E5E5E5"> just analyzing the</font><font color="#CCCCCC"> friend</font>

721
00:36:09,140 --> 00:36:17,900
so basically<font color="#E5E5E5"> what i'm going to do now is</font>

722
00:36:13,610 --> 00:36:20,510
<font color="#E5E5E5">the authenticate myself so now i have</font>

723
00:36:17,900 --> 00:36:23,720
<font color="#CCCCCC">the</font><font color="#E5E5E5"> authenticated and the AP will once</font>

724
00:36:20,510 --> 00:36:26,270
again perform an earful frame exchange

725
00:36:23,720 --> 00:36:29,450
with the access with the<font color="#CCCCCC"> wpa station and</font>

726
00:36:26,270 --> 00:36:31,009
once<font color="#E5E5E5"> again broadcast traffic we're not</font>

727
00:36:29,450 --> 00:36:33,410
able to<font color="#E5E5E5"> decrypt it even though it has</font>

728
00:36:31,010 --> 00:36:36,680
web because it shows a new diner I do

729
00:36:33,410 --> 00:36:38,569
like I'm a key but this is how it works

730
00:36:36,680 --> 00:36:42,379
but it's trivial to wipe ass because I

731
00:36:38,570 --> 00:36:47,840
can just fake being on web station and

732
00:36:42,380 --> 00:36:50,510
this feature gets magically disabled so

733
00:36:47,840 --> 00:36:52,520
we said okay let's see<font color="#E5E5E5"> if we can find</font>

734
00:36:50,510 --> 00:36:55,070
another scenario different ways<font color="#CCCCCC"> to</font>

735
00:36:52,520 --> 00:36:58,759
mitigate our attacks and one typical

736
00:36:55,070 --> 00:37:01,700
thing that people enable in web if they

737
00:36:58,760 --> 00:37:04,400
have to have<font color="#CCCCCC"> a web AP hanging around</font>

738
00:37:01,700 --> 00:37:07,040
because they have I don't know some

739
00:37:04,400 --> 00:37:10,369
hardware that's not able to use wpa is

740
00:37:07,040 --> 00:37:13,220
that the enable<font color="#E5E5E5"> PSP f what PSP f does is</font>

741
00:37:10,369 --> 00:37:15,800
that it is not allowed station to

742
00:37:13,220 --> 00:37:18,680
station traffic basically on<font color="#CCCCCC"> the diagram</font>

743
00:37:15,800 --> 00:37:20,900
on<font color="#E5E5E5"> the left you have two stations they</font>

744
00:37:18,680 --> 00:37:23,359
can talk to each other because no PSP f

745
00:37:20,900 --> 00:37:25,220
is enabled in<font color="#CCCCCC"> the second</font><font color="#E5E5E5"> case when you</font>

746
00:37:23,359 --> 00:37:28,310
<font color="#E5E5E5">try to say in a frame from one station</font>

747
00:37:25,220 --> 00:37:31,580
to the<font color="#E5E5E5"> other the AP drops at frame and</font>

748
00:37:28,310 --> 00:37:35,509
says this cannot be used this was this

749
00:37:31,580 --> 00:37:38,240
feature was introduced by Cisco mainly

750
00:37:35,510 --> 00:37:40,820
to be used in hot spots so that all the

751
00:37:38,240 --> 00:37:44,600
broadcast net buyers and all that stuff

752
00:37:40,820 --> 00:37:48,350
<font color="#CCCCCC">that everybody would be shooting around</font>

753
00:37:44,600 --> 00:37:51,410
went dead<font color="#E5E5E5"> and this has the advantage</font>

754
00:37:48,350 --> 00:37:53,390
that if you enable this in a web network

755
00:37:51,410 --> 00:37:53,839
there are certain attacks that you can't

756
00:37:53,390 --> 00:37:55,790
<font color="#E5E5E5">carry</font>

757
00:37:53,840 --> 00:37:58,430
out for example the<font color="#CCCCCC"> chop-chop</font><font color="#E5E5E5"> attack</font>

758
00:37:55,790 --> 00:38:00,560
doesn't<font color="#E5E5E5"> work because you need the AP to</font>

759
00:37:58,430 --> 00:38:03,859
forward frames to another station and

760
00:38:00,560 --> 00:38:05,450
you have to go through the AP so

761
00:38:03,860 --> 00:38:09,080
basically<font color="#E5E5E5"> what this does is that this</font>

762
00:38:05,450 --> 00:38:10,790
doesn't this forces you to use some

763
00:38:09,080 --> 00:38:12,860
other types of attacks against a web

764
00:38:10,790 --> 00:38:14,900
network if it's configured with<font color="#CCCCCC"> P SPF</font>

765
00:38:12,860 --> 00:38:17,210
and the only attack that you can carry

766
00:38:14,900 --> 00:38:19,370
<font color="#E5E5E5">out and this is and if you have PSP f</font>

767
00:38:17,210 --> 00:38:21,680
enabled on a web AP is to attack a

768
00:38:19,370 --> 00:38:24,319
station directly because if you try<font color="#E5E5E5"> to</font>

769
00:38:21,680 --> 00:38:26,660
go<font color="#E5E5E5"> through the AP it will never send the</font>

770
00:38:24,320 --> 00:38:28,820
traffic forward so basically<font color="#E5E5E5"> you have to</font>

771
00:38:26,660 --> 00:38:31,430
<font color="#E5E5E5">go through the attack directly a web</font>

772
00:38:28,820 --> 00:38:34,010
station so that it generates new and

773
00:38:31,430 --> 00:38:35,660
more broadcast traffic that the new web

774
00:38:34,010 --> 00:38:38,990
traffic<font color="#E5E5E5"> that you can use to decrypt the</font>

775
00:38:35,660 --> 00:38:40,730
key to crack the key so we<font color="#CCCCCC"> said okay we</font>

776
00:38:38,990 --> 00:38:42,319
don't<font color="#CCCCCC"> have any web stations to attack</font>

777
00:38:40,730 --> 00:38:44,000
because we're assuming that if we're in

778
00:38:42,320 --> 00:38:46,880
migration mode and there are no web

779
00:38:44,000 --> 00:38:50,000
stations inside so this might be<font color="#CCCCCC"> a</font>

780
00:38:46,880 --> 00:38:53,630
<font color="#E5E5E5">security feature that does enable us to</font>

781
00:38:50,000 --> 00:38:56,420
thwart our attacks in migration mode

782
00:38:53,630 --> 00:38:59,150
basically<font color="#E5E5E5"> what you see below is how to</font>

783
00:38:56,420 --> 00:39:04,310
configure this in a cisco IP you have to

784
00:38:59,150 --> 00:39:05,540
use the poor protected option so we

785
00:39:04,310 --> 00:39:08,600
started<font color="#E5E5E5"> thinking okay how are we going</font>

786
00:39:05,540 --> 00:39:10,310
to manage to<font color="#E5E5E5"> crack the web key under</font>

787
00:39:08,600 --> 00:39:12,140
this scenario where don't we don't have

788
00:39:10,310 --> 00:39:15,140
<font color="#CCCCCC">any repetition so we can't attack them</font>

789
00:39:12,140 --> 00:39:17,629
we have<font color="#E5E5E5"> PSP</font><font color="#CCCCCC"> f enables so the AP won't</font>

790
00:39:15,140 --> 00:39:19,850
forward our traffic so we started to

791
00:39:17,630 --> 00:39:23,030
look<font color="#E5E5E5"> what the station did once we join</font>

792
00:39:19,850 --> 00:39:25,069
the network what what happened and what

793
00:39:23,030 --> 00:39:27,260
we notice is that each time that station

794
00:39:25,070 --> 00:39:29,780
join the network in particular a web

795
00:39:27,260 --> 00:39:33,950
station but it have the same happen for

796
00:39:29,780 --> 00:39:36,080
wpa station<font color="#E5E5E5"> Cisco IP starts throwing</font>

797
00:39:33,950 --> 00:39:38,089
around a lot<font color="#CCCCCC"> of broadcast packets which</font>

798
00:39:36,080 --> 00:39:40,400
are weapon cryptid because they are

799
00:39:38,090 --> 00:39:43,100
broadcast and if<font color="#CCCCCC"> we decrypt them we see</font>

800
00:39:40,400 --> 00:39:48,200
that these these are igmp packets and

801
00:39:43,100 --> 00:39:50,960
and WL<font color="#E5E5E5"> ccp packets wccp packets our</font>

802
00:39:48,200 --> 00:39:55,160
Cisco's wireless LAN context control

803
00:39:50,960 --> 00:39:58,070
protocol which is a protocol that<font color="#E5E5E5"> cisco</font>

804
00:39:55,160 --> 00:40:01,220
uses to coordinate the<font color="#CCCCCC"> APS the access</font>

805
00:39:58,070 --> 00:40:04,820
point so each time the station connects

806
00:40:01,220 --> 00:40:06,529
either a web station<font color="#CCCCCC"> wpa station Cisco</font>

807
00:40:04,820 --> 00:40:07,640
start sending<font color="#E5E5E5"> out these frames by</font>

808
00:40:06,530 --> 00:40:11,030
default

809
00:40:07,640 --> 00:40:14,210
and the interesting<font color="#CCCCCC"> thing is that WL</font><font color="#E5E5E5"> CCP</font>

810
00:40:11,030 --> 00:40:18,380
frames have the<font color="#E5E5E5"> first have a lot of the</font>

811
00:40:14,210 --> 00:40:20,690
of the packet you know it beforehand as

812
00:40:18,380 --> 00:40:23,600
you<font color="#E5E5E5"> can see they're all fixed values and</font>

813
00:40:20,690 --> 00:40:27,350
the only thing that changes between them

814
00:40:23,600 --> 00:40:29,690
for<font color="#E5E5E5"> this type of wccp frames is this</font>

815
00:40:27,350 --> 00:40:31,520
destination and source MAC address that

816
00:40:29,690 --> 00:40:34,370
even though it's encrypted inside the

817
00:40:31,520 --> 00:40:37,430
frame we also<font color="#E5E5E5"> have</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> in the header the</font>

818
00:40:34,370 --> 00:40:39,890
arrow to<font color="#CCCCCC"> the</font><font color="#E5E5E5"> 11 header of</font><font color="#CCCCCC"> the packet</font>

819
00:40:37,430 --> 00:40:41,930
which is plain text so we can see it so

820
00:40:39,890 --> 00:40:45,830
<font color="#E5E5E5">basically we can know the plain text of</font>

821
00:40:41,930 --> 00:40:48,049
the packet without<font color="#E5E5E5"> having to decrypt it</font>

822
00:40:45,830 --> 00:40:53,270
so this gives us certain possibilities

823
00:40:48,050 --> 00:40:55,100
for crypt analysis so what we did was<font color="#CCCCCC"> we</font>

824
00:40:53,270 --> 00:40:57,410
came up with this attack that what we do

825
00:40:55,100 --> 00:40:59,150
is we authenticate as a web station

826
00:40:57,410 --> 00:41:01,430
without having to have any knowledge of

827
00:40:59,150 --> 00:41:04,550
the key and we continuously send

828
00:41:01,430 --> 00:41:06,560
reassociation requests to the cisco IP

829
00:41:04,550 --> 00:41:09,590
and what the cisco IP does is

830
00:41:06,560 --> 00:41:12,320
continuously send<font color="#CCCCCC"> wccp packets but back</font>

831
00:41:09,590 --> 00:41:14,660
to us which<font color="#E5E5E5"> our weapon cryptid so we</font>

832
00:41:12,320 --> 00:41:17,750
then capture these frames and using

833
00:41:14,660 --> 00:41:20,810
these friends we crack the web key the

834
00:41:17,750 --> 00:41:26,000
problem<font color="#E5E5E5"> that this has is</font><font color="#CCCCCC"> that aircrack</font>

835
00:41:20,810 --> 00:41:29,570
does not know how to do crypt analysis

836
00:41:26,000 --> 00:41:32,660
on wccp frames you only have to go back

837
00:41:29,570 --> 00:41:35,630
to<font color="#CCCCCC"> the FMS mode attack mode and the FMS</font>

838
00:41:32,660 --> 00:41:38,180
attack mode requires over half a million

839
00:41:35,630 --> 00:41:40,160
packets in<font color="#CCCCCC"> the best case and normally it</font>

840
00:41:38,180 --> 00:41:42,500
takes up to two million frames for it to

841
00:41:40,160 --> 00:41:44,960
succeed and the problem<font color="#CCCCCC"> was that this</font>

842
00:41:42,500 --> 00:41:48,800
attack<font color="#E5E5E5"> was very very slow so capturing</font>

843
00:41:44,960 --> 00:41:51,260
<font color="#CCCCCC">22 million frames would be impossible so</font>

844
00:41:48,800 --> 00:41:53,840
what we did is we patched aircraft so

845
00:41:51,260 --> 00:41:56,930
that the PTW attack which is the attack

846
00:41:53,840 --> 00:41:58,850
that<font color="#E5E5E5"> came out in 2007 which does a</font>

847
00:41:56,930 --> 00:42:01,790
different type of cryptanalysis on web

848
00:41:58,850 --> 00:42:05,990
and is able to crack the web key using<font color="#CCCCCC"> a</font>

849
00:42:01,790 --> 00:42:09,080
mole with with a good chance with 80,000

850
00:42:05,990 --> 00:42:12,049
packets which is a lot lower so we added

851
00:42:09,080 --> 00:42:15,560
<font color="#E5E5E5">two aircrack the logic to determine to</font>

852
00:42:12,050 --> 00:42:19,190
find wccp packets based on their size

853
00:42:15,560 --> 00:42:20,870
<font color="#E5E5E5">and because since their web encapsulated</font>

854
00:42:19,190 --> 00:42:21,349
the<font color="#E5E5E5"> only the</font><font color="#CCCCCC"> only one of</font><font color="#E5E5E5"> the few</font>

855
00:42:20,870 --> 00:42:26,058
<font color="#E5E5E5">parameters</font>

856
00:42:21,349 --> 00:42:28,279
we have other<font color="#CCCCCC"> sighs and we added to the</font>

857
00:42:26,059 --> 00:42:30,170
aircraft the possibility of doing the

858
00:42:28,279 --> 00:42:33,079
crypt analysis on these packets as I

859
00:42:30,170 --> 00:42:35,779
<font color="#CCCCCC">said the first bites are fixed of this</font>

860
00:42:33,079 --> 00:42:37,640
packet so we know them beforehand so<font color="#CCCCCC"> we</font>

861
00:42:35,779 --> 00:42:39,979
added this information to Eric so that

862
00:42:37,640 --> 00:42:42,680
<font color="#CCCCCC">the Crypt analytical succeed here and</font>

863
00:42:39,979 --> 00:42:44,989
the only thing that was unknown was that

864
00:42:42,680 --> 00:42:47,598
the we have certain<font color="#CCCCCC"> bytes inside the</font>

865
00:42:44,989 --> 00:42:49,640
frame that are the mac address of the

866
00:42:47,599 --> 00:42:52,670
sender but we can take<font color="#CCCCCC"> that information</font>

867
00:42:49,640 --> 00:42:54,589
from the header so we know it<font color="#E5E5E5"> even</font>

868
00:42:52,670 --> 00:42:56,569
though it's something different from

869
00:42:54,589 --> 00:43:00,380
frame to frame we know it because we

870
00:42:56,569 --> 00:43:02,808
have it in the 80 to the 11 header which

871
00:43:00,380 --> 00:43:04,489
is plaintiff so we added this to<font color="#E5E5E5"> air</font>

872
00:43:02,809 --> 00:43:08,210
<font color="#E5E5E5">cracked so that we could perform this</font>

873
00:43:04,489 --> 00:43:10,400
attack so here we're going<font color="#E5E5E5"> to run the</font>

874
00:43:08,210 --> 00:43:15,319
attack you're just capturing traffic

875
00:43:10,400 --> 00:43:18,410
from<font color="#CCCCCC"> the AP here we</font><font color="#E5E5E5"> have kismet once</font>

876
00:43:15,319 --> 00:43:23,599
more showing the AP nothing new Under

877
00:43:18,410 --> 00:43:27,200
the Sun yeah then we set the same filter

878
00:43:23,599 --> 00:43:31,369
as before to capture all<font color="#E5E5E5"> web traffic if</font>

879
00:43:27,200 --> 00:43:33,950
we apply this filter we're going to see

880
00:43:31,369 --> 00:43:38,749
is the same as we did before now we

881
00:43:33,950 --> 00:43:42,140
start capturing with air dump all the

882
00:43:38,749 --> 00:43:46,430
traffic for the<font color="#E5E5E5"> bssid and we perform</font>

883
00:43:42,140 --> 00:43:48,379
this fake authentication and this minus

884
00:43:46,430 --> 00:43:50,839
<font color="#CCCCCC">q option is something that we</font><font color="#E5E5E5"> added to</font>

885
00:43:48,380 --> 00:43:53,930
aircrack so that it would float the AP

886
00:43:50,839 --> 00:43:56,150
with reassociation requests and if<font color="#E5E5E5"> we go</font>

887
00:43:53,930 --> 00:43:59,479
back<font color="#CCCCCC"> to the capture you can see that</font><font color="#E5E5E5"> the</font>

888
00:43:56,150 --> 00:44:02,269
<font color="#CCCCCC">frame the AP sending frames all the time</font>

889
00:43:59,479 --> 00:44:04,279
which<font color="#CCCCCC"> our weapon cryptid they're being</font>

890
00:44:02,269 --> 00:44:07,669
sent<font color="#E5E5E5"> by the AP that's why has the from</font>

891
00:44:04,279 --> 00:44:10,369
DF bit set and they're the source

892
00:44:07,670 --> 00:44:14,809
address<font color="#E5E5E5"> is that of the wired side of the</font>

893
00:44:10,369 --> 00:44:18,200
AP wired mechanics of the AP and it's a

894
00:44:14,809 --> 00:44:20,839
web frame and if<font color="#CCCCCC"> we set as before the</font>

895
00:44:18,200 --> 00:44:25,609
web key but we're going<font color="#E5E5E5"> to see</font><font color="#CCCCCC"> that</font>

896
00:44:20,839 --> 00:44:31,999
they're<font color="#CCCCCC"> all wccp frames we have the web</font>

897
00:44:25,609 --> 00:44:34,700
key set we enable decryption and now you

898
00:44:31,999 --> 00:44:42,529
see<font color="#CCCCCC"> that they're all wccp friends</font>

899
00:44:34,700 --> 00:44:46,220
now what we're going to do is ok and as

900
00:44:42,530 --> 00:44:55,250
before there<font color="#E5E5E5"> are same frames now it's</font>

901
00:44:46,220 --> 00:44:57,049
<font color="#E5E5E5">just been decrypted and we're flooding</font>

902
00:44:55,250 --> 00:44:59,630
the AP with this we also added some

903
00:44:57,050 --> 00:45:02,089
capability of lowering this attack so

904
00:44:59,630 --> 00:45:04,670
that it doesn't flood it like that but

905
00:45:02,089 --> 00:45:07,549
we<font color="#E5E5E5"> just wanted to prac fast so</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> left</font>

906
00:45:04,670 --> 00:45:09,859
it flooding and if we try to correctly

907
00:45:07,550 --> 00:45:11,810
wait the web key as we can<font color="#CCCCCC"> see in all</font>

908
00:45:09,859 --> 00:45:15,710
this<font color="#E5E5E5"> time that was capturing it</font><font color="#CCCCCC"> captured</font>

909
00:45:11,810 --> 00:45:18,320
less than 900 IVs which is very very

910
00:45:15,710 --> 00:45:21,230
<font color="#E5E5E5">little we need at least 80,000 for this</font>

911
00:45:18,320 --> 00:45:23,900
to work and it's<font color="#E5E5E5"> going very slowly even</font>

912
00:45:21,230 --> 00:45:26,720
though we're flooding the AP because the

913
00:45:23,900 --> 00:45:29,300
attack by its nature slow so using the

914
00:45:26,720 --> 00:45:31,279
that's why we<font color="#CCCCCC"> had to catch the crypt</font>

915
00:45:29,300 --> 00:45:33,980
analysis because if we had done the FMS

916
00:45:31,280 --> 00:45:36,650
we'd have been there<font color="#E5E5E5"> for</font><font color="#CCCCCC"> ages so this</font>

917
00:45:33,980 --> 00:45:41,660
was about roughly 30 minutes 45 minutes

918
00:45:36,650 --> 00:45:44,210
later at that<font color="#E5E5E5"> point we had 60,000 IVs</font>

919
00:45:41,660 --> 00:45:46,848
and aircraft was able to crack the WEP

920
00:45:44,210 --> 00:45:49,190
key all these patches to aircrack that

921
00:45:46,849 --> 00:45:52,040
<font color="#CCCCCC">I'm</font><font color="#E5E5E5"> mentioning are going to be put up in</font>

922
00:45:49,190 --> 00:45:53,960
our site they can be applied to the

923
00:45:52,040 --> 00:45:58,099
latest<font color="#CCCCCC"> version of aircraft to add all</font>

924
00:45:53,960 --> 00:46:00,859
these new capabilities so basically as a

925
00:45:58,099 --> 00:46:04,609
recap this is the standard<font color="#E5E5E5"> web clacking</font>

926
00:46:00,859 --> 00:46:06,200
flowchart to attack a web<font color="#CCCCCC"> AP</font><font color="#E5E5E5"> the</font>

927
00:46:04,609 --> 00:46:09,109
interesting<font color="#CCCCCC"> thing is</font><font color="#E5E5E5"> that this new</font>

928
00:46:06,200 --> 00:46:13,040
attack mode can also be used against a

929
00:46:09,109 --> 00:46:17,270
cisco<font color="#E5E5E5"> AP if it's just running web so</font>

930
00:46:13,040 --> 00:46:21,800
basically we add that<font color="#E5E5E5"> new branch of a</font>

931
00:46:17,270 --> 00:46:24,950
new attack mode and this summarizes our

932
00:46:21,800 --> 00:46:26,750
<font color="#CCCCCC">WPA immigration mode attack the</font>

933
00:46:24,950 --> 00:46:29,810
<font color="#E5E5E5">flowchart this is what I've</font><font color="#CCCCCC"> been talking</font>

934
00:46:26,750 --> 00:46:31,970
about and<font color="#E5E5E5"> basically we always concluding</font>

935
00:46:29,810 --> 00:46:34,040
cracking the web key so no matter what

936
00:46:31,970 --> 00:46:36,950
types of protection we try to add to the

937
00:46:34,040 --> 00:46:38,990
AP we were also always successfully able

938
00:46:36,950 --> 00:46:42,078
to successfully crack the web key and

939
00:46:38,990 --> 00:46:45,560
once<font color="#E5E5E5"> we have the web key we can access</font>

940
00:46:42,079 --> 00:46:47,960
the network<font color="#E5E5E5"> there's only one tiny detail</font>

941
00:46:45,560 --> 00:46:48,560
to this that if you remember when<font color="#E5E5E5"> Diego</font>

942
00:46:47,960 --> 00:46:51,320
talked about

943
00:46:48,560 --> 00:46:52,730
how to configure WP emigration mode he

944
00:46:51,320 --> 00:46:55,490
said that you have<font color="#E5E5E5"> to put the key in</font>

945
00:46:52,730 --> 00:46:58,850
slot<font color="#CCCCCC"> two or three which is</font><font color="#E5E5E5"> what normally</font>

946
00:46:55,490 --> 00:47:00,560
everybody uses the first slot slot 0 so

947
00:46:58,850 --> 00:47:02,509
if you<font color="#E5E5E5"> look at the web frames that are</font>

948
00:47:00,560 --> 00:47:05,360
in the air you're going to see<font color="#CCCCCC"> that they</font>

949
00:47:02,510 --> 00:47:09,290
have<font color="#E5E5E5"> a key index or one</font><font color="#CCCCCC"> of one or two</font>

950
00:47:05,360 --> 00:47:11,390
and so if<font color="#CCCCCC"> you try to join the this AP</font>

951
00:47:09,290 --> 00:47:15,080
using web you're going to have to in

952
00:47:11,390 --> 00:47:19,730
Linux you specify the key ID<font color="#E5E5E5"> and</font><font color="#CCCCCC"> Dai</font><font color="#E5E5E5"> w</font>

953
00:47:15,080 --> 00:47:21,740
config command or in Windows you have to

954
00:47:19,730 --> 00:47:24,080
add the network and then manually by

955
00:47:21,740 --> 00:47:25,819
hand go to the Advanced Options to set

956
00:47:24,080 --> 00:47:27,560
the correct key index because if not

957
00:47:25,820 --> 00:47:29,630
you're even though you have the correct

958
00:47:27,560 --> 00:47:34,160
web key you're not going to be able to

959
00:47:29,630 --> 00:47:35,930
join the network so now Diego<font color="#E5E5E5"> will talk</font>

960
00:47:34,160 --> 00:47:39,859
about some<font color="#E5E5E5"> mitigations and</font>

961
00:47:35,930 --> 00:47:42,560
recommendations so now we know<font color="#CCCCCC"> that an</font>

962
00:47:39,860 --> 00:47:45,290
AP running migration mode can be

963
00:47:42,560 --> 00:47:51,410
attacked and the web key can be obtained

964
00:47:45,290 --> 00:47:54,440
from there so basically solutions so we

965
00:47:51,410 --> 00:47:59,750
know that web is completely broken so

966
00:47:54,440 --> 00:48:03,020
<font color="#E5E5E5">you should avoid it and do not use web</font>

967
00:47:59,750 --> 00:48:08,030
this is a basic solution for that and

968
00:48:03,020 --> 00:48:10,640
turn off WP WP a migration mode if

969
00:48:08,030 --> 00:48:14,150
<font color="#CCCCCC">you've if you are finished</font><font color="#E5E5E5"> with the</font>

970
00:48:10,640 --> 00:48:17,270
migration process if your web station

971
00:48:14,150 --> 00:48:22,070
are not there anymore turn off this

972
00:48:17,270 --> 00:48:24,860
option because us<font color="#CCCCCC"> ly under show the web</font>

973
00:48:22,070 --> 00:48:29,060
key can be cracked and an attacker can

974
00:48:24,860 --> 00:48:31,580
<font color="#E5E5E5">be able to connect to</font><font color="#CCCCCC"> the ap2 then</font>

975
00:48:29,060 --> 00:48:37,190
attack the pin the rest of these

976
00:48:31,580 --> 00:48:42,230
stations some mitigation strategies so

977
00:48:37,190 --> 00:48:46,490
enable<font color="#CCCCCC"> p SPF station as isolation as use</font>

978
00:48:42,230 --> 00:48:49,940
as you have seen it can be crack anyway

979
00:48:46,490 --> 00:48:54,259
but it is it is a mitigation strategy

980
00:48:49,940 --> 00:48:57,530
enable<font color="#CCCCCC"> Mac filtering</font><font color="#E5E5E5"> in order to try to</font>

981
00:48:54,260 --> 00:48:59,540
limit the attack surface we all know

982
00:48:57,530 --> 00:49:02,340
that cloning and mac address is

983
00:48:59,540 --> 00:49:05,370
something that is easy to do

984
00:49:02,340 --> 00:49:08,010
limit the<font color="#CCCCCC"> Simon strength in order</font><font color="#E5E5E5"> to</font>

985
00:49:05,370 --> 00:49:11,220
adjust to cover your operations area

986
00:49:08,010 --> 00:49:15,930
<font color="#CCCCCC">you're building whatever and implement</font>

987
00:49:11,220 --> 00:49:18,779
some time based filter in order to just

988
00:49:15,930 --> 00:49:24,930
put some access control to the whole

989
00:49:18,780 --> 00:49:27,390
infrastructure so under these conditions

990
00:49:24,930 --> 00:49:31,410
don't forget that<font color="#E5E5E5"> the attack is still</font>

991
00:49:27,390 --> 00:49:33,270
possible so these are mitigations but

992
00:49:31,410 --> 00:49:39,600
the attack can be carried out anyway

993
00:49:33,270 --> 00:49:44,580
some recommendations try to split your

994
00:49:39,600 --> 00:49:48,360
AP using<font color="#CCCCCC"> two service set two different</font>

995
00:49:44,580 --> 00:49:51,450
service identifiers one for wpa and the

996
00:49:48,360 --> 00:49:53,880
other one for<font color="#E5E5E5"> web so you can put all the</font>

997
00:49:51,450 --> 00:49:58,680
filtering and all the access control you

998
00:49:53,880 --> 00:50:02,550
need<font color="#E5E5E5"> between those villains this is much</font>

999
00:49:58,680 --> 00:50:08,730
more secure than the first option which

1000
00:50:02,550 --> 00:50:13,830
<font color="#CCCCCC">is the one SSID using both encryptions</font>

1001
00:50:08,730 --> 00:50:16,320
if you can use VPN over the web part of

1002
00:50:13,830 --> 00:50:17,730
your<font color="#E5E5E5"> network which is interesting which</font>

1003
00:50:16,320 --> 00:50:20,970
is<font color="#E5E5E5"> an interesting solution but it</font>

1004
00:50:17,730 --> 00:50:24,480
<font color="#E5E5E5">depends on the devices or</font><font color="#CCCCCC"> M points or</font>

1005
00:50:20,970 --> 00:50:27,060
computers you are using in the web part

1006
00:50:24,480 --> 00:50:28,980
of your network<font color="#E5E5E5"> and finally some</font>

1007
00:50:27,060 --> 00:50:30,660
recommended general recommendations

1008
00:50:28,980 --> 00:50:33,840
about how to secure a wireless network

1009
00:50:30,660 --> 00:50:36,480
can be<font color="#E5E5E5"> found</font><font color="#CCCCCC"> in the integrated</font>

1010
00:50:33,840 --> 00:50:39,450
deployment of cisco wireless LAN

1011
00:50:36,480 --> 00:50:46,950
security and then you have a google

1012
00:50:39,450 --> 00:50:49,290
books URL to look at this<font color="#E5E5E5"> ya book if you</font>

1013
00:50:46,950 --> 00:50:53,029
have some questions<font color="#E5E5E5"> please let us know</font>

1014
00:50:49,290 --> 00:50:53,029
we can try to answer

1015
00:50:57,400 --> 00:51:09,460
yeah I didn't hear your second question

1016
00:51:07,390 --> 00:51:11,319
the first question the answer to the

1017
00:51:09,460 --> 00:51:14,860
first question is<font color="#E5E5E5"> no you</font><font color="#CCCCCC"> have to</font>

1018
00:51:11,320 --> 00:51:24,910
explicitly set<font color="#CCCCCC"> WPA immigration mode and</font>

1019
00:51:14,860 --> 00:51:26,770
no was your second question yeah you

1020
00:51:24,910 --> 00:51:30,040
have to<font color="#E5E5E5"> manually set it if you're</font><font color="#CCCCCC"> going</font>

1021
00:51:26,770 --> 00:51:33,070
to<font color="#E5E5E5"> use wpa</font><font color="#CCCCCC"> immigration mode because the</font>

1022
00:51:30,040 --> 00:51:35,350
its migration mode supports static web

1023
00:51:33,070 --> 00:51:39,270
clients<font color="#E5E5E5"> and in order for the AP to have</font>

1024
00:51:35,350 --> 00:51:39,270
that key you<font color="#E5E5E5"> have to manually set it</font>

1025
00:51:51,200 --> 00:51:55,700
there are some types<font color="#E5E5E5"> of attacks like you</font>

1026
00:51:53,060 --> 00:51:58,400
could carry out we did not focus on<font color="#CCCCCC"> that</font>

1027
00:51:55,700 --> 00:52:00,649
there might be some possible ways but

1028
00:51:58,400 --> 00:52:02,180
the thing is that since you already have

1029
00:52:00,650 --> 00:52:04,910
<font color="#CCCCCC">the web key and you can connect to the</font>

1030
00:52:02,180 --> 00:52:06,649
network obtaining the wpa key is not

1031
00:52:04,910 --> 00:52:09,920
<font color="#E5E5E5">going to give you any additional</font>

1032
00:52:06,650 --> 00:52:21,140
information<font color="#E5E5E5"> so we didn't go down that</font>

1033
00:52:09,920 --> 00:52:22,910
road sorry yeah bout<font color="#E5E5E5"> no but once you</font>

1034
00:52:21,140 --> 00:52:24,920
know the web key and you connect<font color="#CCCCCC"> with</font>

1035
00:52:22,910 --> 00:52:27,230
that wiki you get your going to see

1036
00:52:24,920 --> 00:52:29,869
everything<font color="#E5E5E5"> you're not</font><font color="#CCCCCC"> going to see the</font>

1037
00:52:27,230 --> 00:52:31,970
tkip traffic because that's<font color="#E5E5E5"> wpa</font>

1038
00:52:29,869 --> 00:52:33,950
encrypted but it doesn't matter you<font color="#CCCCCC"> can</font>

1039
00:52:31,970 --> 00:52:38,390
still attack the stations and the

1040
00:52:33,950 --> 00:52:40,910
<font color="#E5E5E5">network from a layer</font><font color="#CCCCCC"> 3 perspective so it</font>

1041
00:52:38,390 --> 00:52:54,049
didn't it wasn't the focus of a research

1042
00:52:40,910 --> 00:52:56,618
<font color="#CCCCCC">okay okay</font><font color="#E5E5E5"> no more questions thank you</font>

1043
00:52:54,050 --> 00:52:56,619
<font color="#E5E5E5">thank you</font>

