1
00:00:00,030 --> 00:00:09,719
and now please<font color="#CCCCCC"> welcome you in beer hi</font>

2
00:00:07,919 --> 00:00:13,079
thanks<font color="#CCCCCC"> for</font><font color="#E5E5E5"> coming</font>

3
00:00:09,719 --> 00:00:15,149
this is my first time at<font color="#E5E5E5"> blackhat</font><font color="#CCCCCC"> and</font>

4
00:00:13,080 --> 00:00:16,949
I'm staying here<font color="#E5E5E5"> at Mandalay Bay so I</font>

5
00:00:15,150 --> 00:00:18,630
don't know if anyone else got<font color="#E5E5E5"> this on</font>

6
00:00:16,949 --> 00:00:21,270
their door<font color="#E5E5E5"> this</font><font color="#CCCCCC"> morning</font>

7
00:00:18,630 --> 00:00:23,130
like when I worked<font color="#E5E5E5"> up wake up very early</font>

8
00:00:21,270 --> 00:00:24,269
very<font color="#E5E5E5"> jet-lagged to like open my door</font>

9
00:00:23,130 --> 00:00:25,919
there was<font color="#E5E5E5"> this thing stuck on there</font>

10
00:00:24,269 --> 00:00:27,810
<font color="#E5E5E5">there's got nothing to do with Apple by</font>

11
00:00:25,920 --> 00:00:29,880
the way<font color="#E5E5E5"> this is just an observation</font>

12
00:00:27,810 --> 00:00:31,380
<font color="#CCCCCC">and so</font><font color="#E5E5E5"> anyway</font><font color="#CCCCCC"> like</font><font color="#E5E5E5"> open up this box it's</font>

13
00:00:29,880 --> 00:00:33,180
like arm a<font color="#E5E5E5"> bit some some lovely</font>

14
00:00:31,380 --> 00:00:35,760
chocolates that<font color="#CCCCCC"> I'm definitely not</font><font color="#E5E5E5"> going</font>

15
00:00:33,180 --> 00:00:38,850
<font color="#E5E5E5">to</font><font color="#CCCCCC"> eat what's</font><font color="#E5E5E5"> inside here oh it's like</font>

16
00:00:35,760 --> 00:00:42,510
some<font color="#CCCCCC"> say</font><font color="#E5E5E5"> on the front it's some like</font>

17
00:00:38,850 --> 00:00:43,440
cyber<font color="#E5E5E5"> startup thing if you work here if</font>

18
00:00:42,510 --> 00:00:45,120
you<font color="#E5E5E5"> worked</font><font color="#CCCCCC"> with</font><font color="#E5E5E5"> them and you're here</font>

19
00:00:43,440 --> 00:00:48,449
hello<font color="#CCCCCC"> I don't read it</font><font color="#E5E5E5"> what it does</font>

20
00:00:45,120 --> 00:00:50,910
something cyber<font color="#E5E5E5"> anyway you look at this</font>

21
00:00:48,450 --> 00:00:52,320
thing<font color="#E5E5E5"> morning recovery</font><font color="#CCCCCC"> and if you were</font>

22
00:00:50,910 --> 00:00:55,620
to read what's on the<font color="#E5E5E5"> back of this thing</font>

23
00:00:52,320 --> 00:00:57,180
I mean what's it saying that that the

24
00:00:55,620 --> 00:00:59,218
stereo thing is here to help<font color="#E5E5E5"> you feel</font>

25
00:00:57,180 --> 00:01:00,329
<font color="#CCCCCC">better</font><font color="#E5E5E5"> after a night of celebrating</font><font color="#CCCCCC"> and</font>

26
00:00:59,219 --> 00:01:01,379
by<font color="#E5E5E5"> the way</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> statement has not been</font>

27
00:01:00,329 --> 00:01:04,260
evaluated<font color="#CCCCCC"> by the Food and Drug</font>

28
00:01:01,379 --> 00:01:07,979
<font color="#CCCCCC">Administration</font><font color="#E5E5E5"> so it seems to me like a</font>

29
00:01:04,260 --> 00:01:11,159
<font color="#E5E5E5">very bold strategy to market your cyber</font>

30
00:01:07,979 --> 00:01:13,650
security company with<font color="#E5E5E5"> a product that the</font>

31
00:01:11,159 --> 00:01:15,810
FDA is<font color="#E5E5E5"> declaring snake oil yeah so I</font>

32
00:01:13,650 --> 00:01:18,689
mean anyway<font color="#CCCCCC"> I don't know who thought</font>

33
00:01:15,810 --> 00:01:21,570
that<font color="#E5E5E5"> was</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> good</font><font color="#CCCCCC"> idea</font><font color="#E5E5E5"> so anyway let's get</font>

34
00:01:18,689 --> 00:01:24,830
<font color="#E5E5E5">back to</font><font color="#CCCCCC"> realtalk</font><font color="#E5E5E5"> so my name is ian i</font>

35
00:01:21,570 --> 00:01:27,330
joined crime security in 2013 and then

36
00:01:24,830 --> 00:01:30,780
project zero when<font color="#CCCCCC"> chris evans started</font>

37
00:01:27,330 --> 00:01:33,060
this<font color="#E5E5E5"> team</font><font color="#CCCCCC"> so we have an expanded remit</font>

38
00:01:30,780 --> 00:01:35,850
<font color="#E5E5E5">to look at the security of the internet</font>

39
00:01:33,060 --> 00:01:38,430
and so my<font color="#E5E5E5"> personal focus has mostly been</font>

40
00:01:35,850 --> 00:01:41,720
on iOS and these days with a major focus

41
00:01:38,430 --> 00:01:43,979
<font color="#CCCCCC">on sandboxing and kernel exploitation</font>

42
00:01:41,720 --> 00:01:46,229
<font color="#CCCCCC">why should you listen to what I have to</font>

43
00:01:43,979 --> 00:01:49,140
<font color="#E5E5E5">say so</font><font color="#CCCCCC"> I think</font><font color="#E5E5E5"> I have a pretty</font><font color="#CCCCCC"> good idea</font>

44
00:01:46,229 --> 00:01:50,939
<font color="#E5E5E5">how I</font><font color="#CCCCCC"> Oh s actually</font><font color="#E5E5E5"> works and how to</font>

45
00:01:49,140 --> 00:01:54,299
exploit it yes my exploits<font color="#E5E5E5"> are not</font>

46
00:01:50,939 --> 00:01:55,439
perfect but nevertheless and<font color="#CCCCCC"> since Apple</font>

47
00:01:54,299 --> 00:01:57,630
launched<font color="#CCCCCC"> their bug bounty a couple of</font>

48
00:01:55,439 --> 00:02:00,029
<font color="#E5E5E5">years ago</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> spent a lot of my time</font>

49
00:01:57,630 --> 00:02:02,250
writing exploits for<font color="#E5E5E5"> iOS to make it</font>

50
00:02:00,030 --> 00:02:03,750
easier for<font color="#E5E5E5"> researchers like you to</font>

51
00:02:02,250 --> 00:02:06,240
<font color="#CCCCCC">actually</font><font color="#E5E5E5"> be able to participate in</font><font color="#CCCCCC"> that</font>

52
00:02:03,750 --> 00:02:07,469
bug bounty<font color="#E5E5E5"> if you've association</font><font color="#CCCCCC"> to an</font>

53
00:02:06,240 --> 00:02:09,329
<font color="#E5E5E5">iPhone in the last two</font><font color="#CCCCCC"> years</font>

54
00:02:07,469 --> 00:02:11,940
<font color="#CCCCCC">you were</font><font color="#E5E5E5"> probably either using your own</font>

55
00:02:09,330 --> 00:02:15,780
exploits or potentially<font color="#E5E5E5"> round one of</font>

56
00:02:11,940 --> 00:02:17,400
<font color="#CCCCCC">a kernel sandbox</font><font color="#E5E5E5"> exploits so actually</font>

57
00:02:15,780 --> 00:02:19,650
the main emphasis of this talk today<font color="#CCCCCC"> is</font>

58
00:02:17,400 --> 00:02:21,780
to talk<font color="#CCCCCC"> about why I think this</font><font color="#E5E5E5"> stuff is</font>

59
00:02:19,650 --> 00:02:23,670
important and why I<font color="#E5E5E5"> don't think vendors</font>

60
00:02:21,780 --> 00:02:26,310
or taking an exploitation seriously

61
00:02:23,670 --> 00:02:27,839
enough<font color="#CCCCCC"> I think this is something that</font><font color="#E5E5E5"> we</font>

62
00:02:26,310 --> 00:02:30,270
<font color="#E5E5E5">have projects</font><font color="#CCCCCC"> around maybe don't do such</font>

63
00:02:27,840 --> 00:02:32,850
a good<font color="#CCCCCC"> job of so we're gonna start with</font>

64
00:02:30,270 --> 00:02:34,890
<font color="#E5E5E5">a history lesson yes this is half my</font>

65
00:02:32,850 --> 00:02:36,299
lifetime ago but like I think it was

66
00:02:34,890 --> 00:02:37,980
formative stuff<font color="#E5E5E5"> and it was in the news</font>

67
00:02:36,300 --> 00:02:39,000
all<font color="#CCCCCC"> the time right</font><font color="#E5E5E5"> and what kind of</font>

68
00:02:37,980 --> 00:02:43,500
things were in the<font color="#E5E5E5"> news all the</font><font color="#CCCCCC"> time</font>

69
00:02:39,000 --> 00:02:45,810
this this is a diagram from I Triple E

70
00:02:43,500 --> 00:02:47,370
paper about slammer<font color="#E5E5E5"> and if you were a</font>

71
00:02:45,810 --> 00:02:50,370
<font color="#E5E5E5">black cat 15 years ago you could have</font>

72
00:02:47,370 --> 00:02:55,880
<font color="#E5E5E5">seen them put</font><font color="#CCCCCC"> on stage of the code</font><font color="#E5E5E5"> that</font>

73
00:02:50,370 --> 00:02:59,190
<font color="#E5E5E5">was this what achieve was this this is a</font>

74
00:02:55,880 --> 00:03:03,120
straight copy from the first<font color="#E5E5E5"> byte of UDP</font>

75
00:02:59,190 --> 00:03:06,540
packet<font color="#CCCCCC"> onto a 16 byte stack buffer right</font>

76
00:03:03,120 --> 00:03:09,330
so this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> some Microsoft sequel server</font>

77
00:03:06,540 --> 00:03:12,359
code and it's expecting that the UDP

78
00:03:09,330 --> 00:03:14,610
packet has<font color="#E5E5E5"> null-terminated database name</font>

79
00:03:12,360 --> 00:03:18,590
<font color="#E5E5E5">it's like right at the</font><font color="#CCCCCC"> beginning of</font><font color="#E5E5E5"> the</font>

80
00:03:14,610 --> 00:03:20,190
<font color="#E5E5E5">packet and the server is trusting this</font>

81
00:03:18,590 --> 00:03:23,300
why<font color="#E5E5E5"> am I saying this</font>

82
00:03:20,190 --> 00:03:26,550
so what do things look<font color="#CCCCCC"> like 15 years ago</font>

83
00:03:23,300 --> 00:03:28,709
<font color="#E5E5E5">poor security development practices used</font>

84
00:03:26,550 --> 00:03:30,720
to lead to clearly<font color="#E5E5E5"> visible harm and</font>

85
00:03:28,709 --> 00:03:32,730
people cared right

86
00:03:30,720 --> 00:03:34,410
specifically<font color="#CCCCCC"> Microsoft customers cared</font>

87
00:03:32,730 --> 00:03:38,910
and they were really worried about<font color="#E5E5E5"> the</font>

88
00:03:34,410 --> 00:03:40,680
future<font color="#CCCCCC"> and so sure you're also</font><font color="#E5E5E5"> all very</font>

89
00:03:38,910 --> 00:03:42,299
<font color="#CCCCCC">familiar with this this cause Bill Gates</font>

90
00:03:40,680 --> 00:03:44,220
<font color="#E5E5E5">to write this famous trustworthy</font>

91
00:03:42,300 --> 00:03:47,040
computing memo<font color="#E5E5E5"> and yes I'm going to read</font>

92
00:03:44,220 --> 00:03:49,170
it off<font color="#E5E5E5"> with the screen no all of it our</font>

93
00:03:47,040 --> 00:03:51,030
new<font color="#E5E5E5"> design approaches</font><font color="#CCCCCC"> we need to</font>

94
00:03:49,170 --> 00:03:53,160
dramatically reduce<font color="#CCCCCC"> the</font><font color="#E5E5E5"> number</font><font color="#CCCCCC"> of such</font>

95
00:03:51,030 --> 00:03:55,110
issues<font color="#CCCCCC"> that come up in the software the</font>

96
00:03:53,160 --> 00:03:58,440
<font color="#E5E5E5">Microsoft its partners</font><font color="#CCCCCC"> and its customers</font>

97
00:03:55,110 --> 00:03:59,880
create it goes on at the same<font color="#CCCCCC"> time</font><font color="#E5E5E5"> we're</font>

98
00:03:58,440 --> 00:04:01,769
in the process<font color="#E5E5E5"> of training all our</font>

99
00:03:59,880 --> 00:04:04,130
developers<font color="#CCCCCC"> and the latest secure coding</font>

100
00:04:01,769 --> 00:04:06,440
techniques now I've actually managed to

101
00:04:04,130 --> 00:04:09,150
grab hold of some<font color="#E5E5E5"> of those internal</font>

102
00:04:06,440 --> 00:04:12,630
training materials from Microsoft at the

103
00:04:09,150 --> 00:04:15,269
time this<font color="#E5E5E5"> is one of their motivational</font>

104
00:04:12,630 --> 00:04:17,640
posters explaining about<font color="#CCCCCC"> the dangers of</font>

105
00:04:15,269 --> 00:04:20,840
<font color="#E5E5E5">district copy thank you to natty</font>

106
00:04:17,640 --> 00:04:24,120
<font color="#E5E5E5">Schenker for getting all of this for</font><font color="#CCCCCC"> me</font>

107
00:04:20,839 --> 00:04:24,510
<font color="#E5E5E5">so one last quick and this is from Bill</font>

108
00:04:24,120 --> 00:04:25,889
Gates

109
00:04:24,510 --> 00:04:27,539
so now

110
00:04:25,889 --> 00:04:30,419
we face a choice between<font color="#E5E5E5"> adding features</font>

111
00:04:27,539 --> 00:04:33,090
<font color="#E5E5E5">and resolving security issues we need</font><font color="#CCCCCC"> to</font>

112
00:04:30,419 --> 00:04:35,159
choose security<font color="#E5E5E5"> right and this memo was</font>

113
00:04:33,090 --> 00:04:40,650
the foundation<font color="#E5E5E5"> of Microsoft's secure</font>

114
00:04:35,159 --> 00:04:43,110
development lifecycle<font color="#CCCCCC"> 15 years ago</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> 15</font>

115
00:04:40,650 --> 00:04:45,120
<font color="#CCCCCC">years later now</font><font color="#E5E5E5"> surely everyone now</font>

116
00:04:43,110 --> 00:04:46,499
<font color="#E5E5E5">develop secure systems uses safe</font>

117
00:04:45,120 --> 00:04:48,029
languages and you know if they<font color="#E5E5E5"> must</font>

118
00:04:46,499 --> 00:04:50,069
<font color="#E5E5E5">write low-level code they use</font>

119
00:04:48,029 --> 00:04:53,069
annotations and model checking<font color="#E5E5E5"> to help</font>

120
00:04:50,069 --> 00:04:54,770
<font color="#E5E5E5">those developers and in some products</font>

121
00:04:53,069 --> 00:04:58,020
Microsoft is on their way down<font color="#E5E5E5"> that path</font>

122
00:04:54,770 --> 00:05:00,180
but did everyone take that route<font color="#E5E5E5"> and</font>

123
00:04:58,020 --> 00:05:01,948
what does the world<font color="#E5E5E5"> look</font><font color="#CCCCCC"> like today</font><font color="#E5E5E5"> so</font>

124
00:05:00,180 --> 00:05:03,900
now in this mobile first world

125
00:05:01,949 --> 00:05:07,289
Microsoft is not<font color="#CCCCCC"> such a dominant</font><font color="#E5E5E5"> player</font>

126
00:05:03,900 --> 00:05:09,508
<font color="#E5E5E5">on there is mobile endpoints right it's</font>

127
00:05:07,289 --> 00:05:12,300
now Android and it's now iOS<font color="#E5E5E5"> and these</font>

128
00:05:09,509 --> 00:05:13,110
code bases in their<font color="#E5E5E5"> current forms they</font>

129
00:05:12,300 --> 00:05:16,650
didn't exist<font color="#E5E5E5"> then</font>

130
00:05:13,110 --> 00:05:18,719
yes<font color="#E5E5E5"> xnu did exist</font><font color="#CCCCCC"> 15 years ago</font><font color="#E5E5E5"> it did</font>

131
00:05:16,650 --> 00:05:20,429
exist almost<font color="#E5E5E5"> who not xnu but large</font><font color="#CCCCCC"> parts</font>

132
00:05:18,719 --> 00:05:23,129
<font color="#CCCCCC">of</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> codebase existed 30 years ago</font>

133
00:05:20,430 --> 00:05:25,080
<font color="#E5E5E5">but the security models of iOS</font><font color="#CCCCCC"> are</font>

134
00:05:23,129 --> 00:05:28,139
vastly different<font color="#CCCCCC"> from</font><font color="#E5E5E5"> the security</font>

135
00:05:25,080 --> 00:05:29,849
models of<font color="#CCCCCC"> xnu</font><font color="#E5E5E5"> and mark and these</font>

136
00:05:28,139 --> 00:05:32,430
purposes never went<font color="#E5E5E5"> through this sudden</font>

137
00:05:29,849 --> 00:05:34,110
moment<font color="#E5E5E5"> of clarity the code quality like</font>

138
00:05:32,430 --> 00:05:37,620
not struck copying to the stack is

139
00:05:34,110 --> 00:05:41,219
actually<font color="#E5E5E5"> super important</font><font color="#CCCCCC"> so what are the</font>

140
00:05:37,620 --> 00:05:43,020
<font color="#CCCCCC">consequences of</font><font color="#E5E5E5"> these code bases never</font>

141
00:05:41,219 --> 00:05:45,210
having gone<font color="#CCCCCC"> through such an event</font><font color="#E5E5E5"> well</font>

142
00:05:43,020 --> 00:05:48,000
it doesn't look<font color="#CCCCCC"> like a big map with</font>

143
00:05:45,210 --> 00:05:51,419
<font color="#CCCCCC">pinkie lights on it instead it looks</font>

144
00:05:48,000 --> 00:05:52,939
like these<font color="#E5E5E5"> two</font><font color="#CCCCCC"> 42-year acts</font><font color="#E5E5E5"> also with</font>

145
00:05:51,419 --> 00:05:56,039
pinkie lights on them

146
00:05:52,939 --> 00:05:58,740
so maybe some of<font color="#E5E5E5"> you are</font><font color="#CCCCCC"> familiar with</font>

147
00:05:56,039 --> 00:06:01,050
where this<font color="#CCCCCC"> rack diagram is taken from so</font>

148
00:05:58,740 --> 00:06:06,419
this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> a from the Pegasus product</font>

149
00:06:01,050 --> 00:06:09,750
description manual it was leaked<font color="#CCCCCC"> during</font>

150
00:06:06,419 --> 00:06:10,229
<font color="#CCCCCC">the hacking team attack and why am i</font>

151
00:06:09,750 --> 00:06:12,270
showing you this

152
00:06:10,229 --> 00:06:14,399
<font color="#E5E5E5">so it makes the discussion you read</font>

153
00:06:12,270 --> 00:06:15,930
<font color="#E5E5E5">about NSA and about Pegasus they</font>

154
00:06:14,399 --> 00:06:18,479
<font color="#E5E5E5">generally talk about numbers they talk</font>

155
00:06:15,930 --> 00:06:20,719
<font color="#E5E5E5">about numbers and exploits and you can</font>

156
00:06:18,479 --> 00:06:24,770
see that the talks about<font color="#CCCCCC"> Pegasus from</font>

157
00:06:20,719 --> 00:06:27,180
from the team look out who reversed<font color="#E5E5E5"> the</font>

158
00:06:24,770 --> 00:06:29,849
exploit like a super good super super

159
00:06:27,180 --> 00:06:31,469
axiom<font color="#CCCCCC"> write-up</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> sure you've all</font>

160
00:06:29,849 --> 00:06:33,330
seen<font color="#E5E5E5"> like the stories</font><font color="#CCCCCC"> that came out of</font>

161
00:06:31,469 --> 00:06:35,490
this in Wired like these<font color="#CCCCCC"> million-dollar</font>

162
00:06:33,330 --> 00:06:37,800
<font color="#E5E5E5">dissident story and that's what people</font>

163
00:06:35,490 --> 00:06:39,810
<font color="#E5E5E5">take away</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> think that you take these</font>

164
00:06:37,800 --> 00:06:42,150
big<font color="#CCCCCC"> numbers like 1 million</font><font color="#E5E5E5"> dollars</font>

165
00:06:39,810 --> 00:06:44,220
kind of<font color="#E5E5E5"> a comfort blanket</font><font color="#CCCCCC"> I am pretty</font>

166
00:06:42,150 --> 00:06:46,590
<font color="#CCCCCC">sure that like</font><font color="#E5E5E5"> Google directors do this</font>

167
00:06:44,220 --> 00:06:48,120
as well<font color="#CCCCCC"> I think the reasoning goes</font><font color="#E5E5E5"> we</font>

168
00:06:46,590 --> 00:06:51,388
know a million<font color="#E5E5E5"> dollars is a</font><font color="#CCCCCC"> lot</font><font color="#E5E5E5"> of money</font>

169
00:06:48,120 --> 00:06:52,740
right<font color="#CCCCCC"> tack</font><font color="#E5E5E5"> one person in</font><font color="#CCCCCC"> a SLR works and</font>

170
00:06:51,389 --> 00:06:55,470
makes us<font color="#E5E5E5"> ninety-nine point seven percent</font>

171
00:06:52,740 --> 00:06:57,540
secure and what I want to<font color="#E5E5E5"> try to paint</font>

172
00:06:55,470 --> 00:07:00,780
with<font color="#E5E5E5"> things like this is a different</font>

173
00:06:57,540 --> 00:07:03,840
<font color="#E5E5E5">picture so because this is</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> product</font>

174
00:07:00,780 --> 00:07:05,789
from NSA<font color="#CCCCCC"> that will not forget</font><font color="#E5E5E5"> that NSO</font>

175
00:07:03,840 --> 00:07:07,888
is a proud<font color="#E5E5E5"> American company yes</font><font color="#CCCCCC"> the</font>

176
00:07:05,790 --> 00:07:10,639
<font color="#CCCCCC">seventy percent</font><font color="#E5E5E5"> owned by San Francisco</font>

177
00:07:07,889 --> 00:07:13,260
private equity and<font color="#E5E5E5"> were they selling</font>

178
00:07:10,639 --> 00:07:15,570
<font color="#E5E5E5">they're not selling an exploit they're</font>

179
00:07:13,260 --> 00:07:18,060
selling complete computer<font color="#E5E5E5"> network</font>

180
00:07:15,570 --> 00:07:20,280
exploitation in a box<font color="#CCCCCC"> set ups</font><font color="#E5E5E5"> right</font><font color="#CCCCCC"> in</font>

181
00:07:18,060 --> 00:07:23,190
these two boxes<font color="#E5E5E5"> and in addition to this</font>

182
00:07:20,280 --> 00:07:27,200
<font color="#E5E5E5">you also get some like Windows boxes to</font>

183
00:07:23,190 --> 00:07:27,200
run their<font color="#E5E5E5"> front end like data</font><font color="#CCCCCC"> visualize</font>

184
00:07:27,620 --> 00:07:34,770
someone's just moving<font color="#E5E5E5"> there Pegasus</font>

185
00:07:30,090 --> 00:07:36,210
installation so there<font color="#E5E5E5"> are two major</font>

186
00:07:34,770 --> 00:07:42,180
<font color="#CCCCCC">vegetable points I want</font><font color="#E5E5E5"> to emphasize</font>

187
00:07:36,210 --> 00:07:44,669
here<font color="#E5E5E5"> firstly this this room massive</font><font color="#CCCCCC"> two</font>

188
00:07:42,180 --> 00:07:47,340
<font color="#CCCCCC">rack installations</font><font color="#E5E5E5"> is clearly targeted</font>

189
00:07:44,669 --> 00:07:48,590
at customers without see any experience

190
00:07:47,340 --> 00:07:51,479
<font color="#E5E5E5">without computer network exploitation</font>

191
00:07:48,590 --> 00:07:54,359
<font color="#E5E5E5">experience like the manual that this is</font>

192
00:07:51,479 --> 00:07:56,310
part of<font color="#E5E5E5"> this</font><font color="#CCCCCC"> miss</font><font color="#E5E5E5"> Utley states that so</font>

193
00:07:54,360 --> 00:07:58,320
<font color="#CCCCCC">they're</font><font color="#E5E5E5"> over-the-air installation method</font>

194
00:07:56,310 --> 00:08:00,570
the operator<font color="#CCCCCC"> only needs to put in a</font>

195
00:07:58,320 --> 00:08:03,900
phone number<font color="#E5E5E5"> and the agent is installed</font>

196
00:08:00,570 --> 00:08:05,520
<font color="#CCCCCC">right there's no</font><font color="#E5E5E5"> more details that's the</font>

197
00:08:03,900 --> 00:08:08,099
level of<font color="#E5E5E5"> sophistication</font><font color="#CCCCCC"> which</font><font color="#E5E5E5"> they are</font>

198
00:08:05,520 --> 00:08:10,620
expecting from their customer so my

199
00:08:08,100 --> 00:08:12,150
personal fear here is that exploitation

200
00:08:10,620 --> 00:08:14,820
<font color="#E5E5E5">these and things like this is an</font>

201
00:08:12,150 --> 00:08:21,150
extremely powerful<font color="#CCCCCC"> an Eastern</font><font color="#E5E5E5"> metric</font>

202
00:08:14,820 --> 00:08:22,590
tool<font color="#E5E5E5"> and you might use a maybe I and</font>

203
00:08:21,150 --> 00:08:24,750
<font color="#E5E5E5">probably I might feel</font><font color="#CCCCCC"> comfortable that</font>

204
00:08:22,590 --> 00:08:26,520
some government institutions in some

205
00:08:24,750 --> 00:08:29,400
governments in the world<font color="#CCCCCC"> are capable of</font>

206
00:08:26,520 --> 00:08:31,890
<font color="#E5E5E5">handling such tools but this product is</font>

207
00:08:29,400 --> 00:08:33,598
not targeted<font color="#CCCCCC"> to</font><font color="#E5E5E5"> them this is for this is</font>

208
00:08:31,890 --> 00:08:35,939
<font color="#CCCCCC">for organizations</font><font color="#E5E5E5"> in four countries</font>

209
00:08:33,599 --> 00:08:39,110
rather that don't have decades of

210
00:08:35,940 --> 00:08:41,159
<font color="#CCCCCC">experience in</font><font color="#E5E5E5"> the technical and policy</font>

211
00:08:39,110 --> 00:08:44,610
discussions that are required<font color="#CCCCCC"> to like</font>

212
00:08:41,159 --> 00:08:46,770
balance<font color="#CCCCCC"> the use of this power and in the</font>

213
00:08:44,610 --> 00:08:49,860
<font color="#E5E5E5">wrong hands this is</font><font color="#CCCCCC"> a very very powerful</font>

214
00:08:46,770 --> 00:08:52,020
<font color="#E5E5E5">weapon against things like</font><font color="#CCCCCC"> dissent</font><font color="#E5E5E5"> which</font>

215
00:08:49,860 --> 00:08:52,740
is how it's used<font color="#E5E5E5"> but it's not</font><font color="#CCCCCC"> only used</font>

216
00:08:52,020 --> 00:08:55,990
<font color="#E5E5E5">for</font>

217
00:08:52,740 --> 00:08:57,850
suppressing political dissent you know

218
00:08:55,990 --> 00:08:59,079
the slippery slope<font color="#E5E5E5"> of the use of tools</font>

219
00:08:57,850 --> 00:09:03,279
like<font color="#CCCCCC"> this is real</font>

220
00:08:59,079 --> 00:09:05,979
<font color="#E5E5E5">so one global problem which product like</font>

221
00:09:03,279 --> 00:09:08,350
this<font color="#E5E5E5"> contribute to is obesity right</font>

222
00:09:05,980 --> 00:09:10,779
<font color="#E5E5E5">especially in the US alone and all</font>

223
00:09:08,350 --> 00:09:13,540
across the world<font color="#E5E5E5"> so citizen lab this</font>

224
00:09:10,779 --> 00:09:15,880
group from Canada<font color="#E5E5E5"> have collected</font>

225
00:09:13,540 --> 00:09:18,099
evidence suggesting that exploits served

226
00:09:15,880 --> 00:09:21,579
by one of these installations<font color="#E5E5E5"> were sent</font>

227
00:09:18,100 --> 00:09:24,959
to<font color="#CCCCCC"> employees of a NGO in Mexico</font><font color="#E5E5E5"> the</font>

228
00:09:21,579 --> 00:09:28,060
campaign in favor of a Mexican soda tax

229
00:09:24,959 --> 00:09:32,290
right<font color="#E5E5E5"> is that really a justified use of</font>

230
00:09:28,060 --> 00:09:34,449
this<font color="#E5E5E5"> kind of power the second point</font><font color="#CCCCCC"> I</font>

231
00:09:32,290 --> 00:09:36,579
want to make<font color="#E5E5E5"> regarding this is that</font>

232
00:09:34,449 --> 00:09:38,649
these<font color="#CCCCCC"> prices which you</font><font color="#E5E5E5"> hear quoted</font>

233
00:09:36,579 --> 00:09:41,050
everywhere<font color="#CCCCCC"> I</font><font color="#E5E5E5"> think of</font><font color="#CCCCCC"> white you</font><font color="#E5E5E5"> must use</font>

234
00:09:38,649 --> 00:09:44,079
<font color="#E5E5E5">to paint an inaccurate</font><font color="#CCCCCC"> picture</font><font color="#E5E5E5"> of code</font>

235
00:09:41,050 --> 00:09:46,149
quality<font color="#CCCCCC"> discomfort blanket of like okay</font>

236
00:09:44,079 --> 00:09:47,888
and<font color="#E5E5E5"> maybe the code isn't perfect but</font>

237
00:09:46,149 --> 00:09:49,959
it's still like a million dollars to

238
00:09:47,889 --> 00:09:52,990
exploit someone<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> not real and</font>

239
00:09:49,959 --> 00:09:55,750
<font color="#CCCCCC">that's</font><font color="#E5E5E5"> really not helpful the system is</font>

240
00:09:52,990 --> 00:09:58,480
not<font color="#CCCCCC"> serving a unique single exploit</font>

241
00:09:55,750 --> 00:10:00,009
<font color="#E5E5E5">perfect target right the true discovery</font>

242
00:09:58,480 --> 00:10:02,740
<font color="#CCCCCC">and exploitation costs of the bugs</font>

243
00:10:00,009 --> 00:10:04,720
involved here<font color="#CCCCCC"> I think a far lower than</font>

244
00:10:02,740 --> 00:10:07,810
people<font color="#E5E5E5"> believe and this is the area that</font>

245
00:10:04,720 --> 00:10:09,310
predictor<font color="#CCCCCC"> are</font><font color="#E5E5E5"> focused on so you can</font>

246
00:10:07,810 --> 00:10:11,018
remember these posted these quoted

247
00:10:09,310 --> 00:10:12,689
prices are taking you from literally

248
00:10:11,019 --> 00:10:15,610
<font color="#CCCCCC">nothing to this kind of mid-level</font>

249
00:10:12,689 --> 00:10:18,040
<font color="#CCCCCC">Intelligence</font><font color="#E5E5E5"> Agency capability that</font>

250
00:10:15,610 --> 00:10:21,160
<font color="#CCCCCC">cause</font><font color="#E5E5E5"> money and most</font><font color="#CCCCCC"> of that</font><font color="#E5E5E5"> money is</font>

251
00:10:18,040 --> 00:10:22,149
not the cost<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the exploits so what</font>

252
00:10:21,160 --> 00:10:25,660
<font color="#E5E5E5">does the world look</font><font color="#CCCCCC"> like now</font>

253
00:10:22,149 --> 00:10:27,339
<font color="#E5E5E5">fifteen years later now poor software</font>

254
00:10:25,660 --> 00:10:30,519
development practices need<font color="#CCCCCC"> to hidden</font>

255
00:10:27,339 --> 00:10:33,250
<font color="#CCCCCC">harm</font><font color="#E5E5E5"> with some squiggly areas poor</font>

256
00:10:30,519 --> 00:10:36,250
<font color="#E5E5E5">software development practices in</font>

257
00:10:33,250 --> 00:10:38,980
Android and<font color="#CCCCCC"> iOS</font><font color="#E5E5E5"> lead to hidden but quite</font>

258
00:10:36,250 --> 00:10:43,449
widespread and damaging but easy<font color="#E5E5E5"> to</font>

259
00:10:38,980 --> 00:10:45,069
ignore you know these are different code

260
00:10:43,449 --> 00:10:48,130
bases<font color="#CCCCCC"> that are</font><font color="#E5E5E5"> under attack now and they</font>

261
00:10:45,069 --> 00:10:49,660
never had this slammer<font color="#E5E5E5"> moment that their</font>

262
00:10:48,130 --> 00:10:53,079
<font color="#CCCCCC">development practices were never forced</font>

263
00:10:49,660 --> 00:10:56,050
to mature and them in feature<font color="#E5E5E5"> versus</font>

264
00:10:53,079 --> 00:10:57,790
security<font color="#CCCCCC"> feature seems to always win</font><font color="#E5E5E5"> so</font>

265
00:10:56,050 --> 00:10:58,959
in the<font color="#E5E5E5"> rest of this talk I'm</font><font color="#CCCCCC"> going</font><font color="#E5E5E5"> to</font>

266
00:10:57,790 --> 00:11:02,260
try to convince you<font color="#E5E5E5"> of just how poor</font>

267
00:10:58,959 --> 00:11:03,609
<font color="#E5E5E5">those practices are and yes I know</font><font color="#CCCCCC"> more</font>

268
00:11:02,260 --> 00:11:05,830
stuff<font color="#E5E5E5"> about iOS than Android because</font>

269
00:11:03,610 --> 00:11:07,240
<font color="#E5E5E5">that's just happens to be what I work on</font>

270
00:11:05,830 --> 00:11:10,420
please go<font color="#CCCCCC"> read the particular</font><font color="#E5E5E5"> tracker</font>

271
00:11:07,240 --> 00:11:13,300
<font color="#E5E5E5">like read the report from the bug</font><font color="#CCCCCC"> Yan</font>

272
00:11:10,420 --> 00:11:14,939
<font color="#E5E5E5">released on Monday if you think Android</font>

273
00:11:13,300 --> 00:11:17,920
<font color="#E5E5E5">is any better than this</font>

274
00:11:14,940 --> 00:11:20,740
so<font color="#E5E5E5"> the stuff has changed</font><font color="#CCCCCC"> in the</font><font color="#E5E5E5"> last 15</font>

275
00:11:17,920 --> 00:11:24,370
years<font color="#CCCCCC"> right</font><font color="#E5E5E5"> it's unlikely I hope that</font>

276
00:11:20,740 --> 00:11:26,470
Pegasus like Pegasus payload<font color="#E5E5E5"> sends a</font>

277
00:11:24,370 --> 00:11:29,350
single UDP packet<font color="#E5E5E5"> unless it's</font><font color="#CCCCCC"> a</font>

278
00:11:26,470 --> 00:11:30,700
targeting like<font color="#E5E5E5"> insert of things or you</font>

279
00:11:29,350 --> 00:11:32,230
know any<font color="#CCCCCC"> embedded chip on your</font><font color="#E5E5E5"> phone</font>

280
00:11:30,700 --> 00:11:34,750
right<font color="#CCCCCC"> like</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> Broadcom white module</font>

281
00:11:32,230 --> 00:11:37,149
<font color="#E5E5E5">maybe they're attending one packet but</font>

282
00:11:34,750 --> 00:11:39,880
we have<font color="#E5E5E5"> things like sandboxing which</font>

283
00:11:37,149 --> 00:11:41,320
<font color="#CCCCCC">mean that you might need more</font><font color="#E5E5E5"> than that</font>

284
00:11:39,880 --> 00:11:42,910
one bug

285
00:11:41,320 --> 00:11:44,950
what's my provocative statement here

286
00:11:42,910 --> 00:11:46,870
security systems design is making

287
00:11:44,950 --> 00:11:48,610
<font color="#CCCCCC">promises which poor</font><font color="#E5E5E5"> software development</font>

288
00:11:46,870 --> 00:11:50,579
practices cannot keep and when<font color="#E5E5E5"> I'm</font>

289
00:11:48,610 --> 00:11:52,450
<font color="#E5E5E5">talking about things like the unboxing</font>

290
00:11:50,579 --> 00:11:55,899
what I'm<font color="#E5E5E5"> talking about are</font><font color="#CCCCCC"> the</font>

291
00:11:52,450 --> 00:11:58,600
implementation<font color="#CCCCCC"> details</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> sandboxing now</font>

292
00:11:55,899 --> 00:12:01,269
<font color="#E5E5E5">it's more likely nowadays that the thing</font>

293
00:11:58,600 --> 00:12:03,370
<font color="#CCCCCC">you're served by Pegasus is like a small</font>

294
00:12:01,269 --> 00:12:04,899
chain<font color="#CCCCCC"> of bugs but that doesn't</font>

295
00:12:03,370 --> 00:12:06,610
necessarily mean<font color="#E5E5E5"> that those bugs are</font><font color="#CCCCCC"> all</font>

296
00:12:04,899 --> 00:12:09,820
that hard to<font color="#E5E5E5"> find</font><font color="#CCCCCC"> or all that hard to</font>

297
00:12:06,610 --> 00:12:12,430
<font color="#CCCCCC">explore so I'm gonna</font><font color="#E5E5E5"> fit a bit more on</font>

298
00:12:09,820 --> 00:12:14,770
this like systems design stuff because I

299
00:12:12,430 --> 00:12:18,339
think<font color="#E5E5E5"> it's important to understand</font><font color="#CCCCCC"> how</font>

300
00:12:14,770 --> 00:12:21,040
these companies think about secure

301
00:12:18,339 --> 00:12:22,980
<font color="#CCCCCC">software development</font><font color="#E5E5E5"> so if you search</font>

302
00:12:21,040 --> 00:12:25,060
around hard enough on the Apple website

303
00:12:22,980 --> 00:12:26,260
<font color="#E5E5E5">you'll come across this diagram it</font>

304
00:12:25,060 --> 00:12:29,199
doesn't matter too<font color="#CCCCCC"> much what's on there</font>

305
00:12:26,260 --> 00:12:31,569
but<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is from</font><font color="#E5E5E5"> the iOS security white</font>

306
00:12:29,200 --> 00:12:34,810
paper<font color="#E5E5E5"> and it's got this like layered</font>

307
00:12:31,570 --> 00:12:37,570
diagram of like<font color="#E5E5E5"> data protection class</font>

308
00:12:34,810 --> 00:12:38,849
<font color="#E5E5E5">app sandbox</font><font color="#CCCCCC"> use a partition encrypted OS</font>

309
00:12:37,570 --> 00:12:42,640
partition

310
00:12:38,850 --> 00:12:45,100
so both iOS and Android current security

311
00:12:42,640 --> 00:12:47,290
leads come from like these security

312
00:12:45,100 --> 00:12:49,720
systems design backgrounds so on the

313
00:12:47,290 --> 00:12:51,040
<font color="#E5E5E5">Android</font><font color="#CCCCCC"> side it's now the</font><font color="#E5E5E5"> security lead</font>

314
00:12:49,720 --> 00:12:53,500
is Dave Klein damaja

315
00:12:51,040 --> 00:12:56,709
has a background in doing<font color="#E5E5E5"> small</font>

316
00:12:53,500 --> 00:12:58,180
<font color="#CCCCCC">real-time oasis in like avionics</font><font color="#E5E5E5"> so it's</font>

317
00:12:56,709 --> 00:13:00,609
possible<font color="#E5E5E5"> that the plane that you flew</font>

318
00:12:58,180 --> 00:13:03,310
<font color="#CCCCCC">here on had was running</font><font color="#E5E5E5"> like some</font><font color="#CCCCCC"> other</font>

319
00:13:00,610 --> 00:13:04,690
<font color="#E5E5E5">code the ran on his OS from 20</font><font color="#CCCCCC"> years ago</font>

320
00:13:03,310 --> 00:13:07,779
right

321
00:13:04,690 --> 00:13:10,600
<font color="#E5E5E5">even</font><font color="#CCCCCC"> Christic or the apple</font><font color="#E5E5E5"> size prior to</font>

322
00:13:07,779 --> 00:13:12,430
apples at<font color="#E5E5E5"> OLPC this one laptop per child</font>

323
00:13:10,600 --> 00:13:17,230
thing and<font color="#CCCCCC"> I found I bought one of</font><font color="#E5E5E5"> those</font>

324
00:13:12,430 --> 00:13:18,989
back in the<font color="#CCCCCC"> day and</font><font color="#E5E5E5"> so there he led</font>

325
00:13:17,230 --> 00:13:20,279
<font color="#E5E5E5">there like security architecture</font>

326
00:13:18,990 --> 00:13:24,360
it's called bit frost if you want to go

327
00:13:20,279 --> 00:13:26,220
see<font color="#E5E5E5"> and look it up so undeniably both</font>

328
00:13:24,360 --> 00:13:28,140
<font color="#E5E5E5">these security leaders have like really</font>

329
00:13:26,220 --> 00:13:30,360
strong security engineering skill sets

330
00:13:28,140 --> 00:13:32,779
<font color="#E5E5E5">but they don't come from</font><font color="#CCCCCC"> an exploitation</font>

331
00:13:30,360 --> 00:13:36,089
background so this academic

332
00:13:32,779 --> 00:13:38,010
understanding<font color="#E5E5E5"> of security perhaps tends</font>

333
00:13:36,089 --> 00:13:41,130
to kind of discount implementation<font color="#E5E5E5"> flaws</font>

334
00:13:38,010 --> 00:13:43,470
<font color="#E5E5E5">if a bugs found you fix it and then the</font>

335
00:13:41,130 --> 00:13:45,750
system<font color="#E5E5E5"> is perfect again</font><font color="#CCCCCC"> and the focus is</font>

336
00:13:43,470 --> 00:13:47,970
<font color="#E5E5E5">on like the design of the system and not</font>

337
00:13:45,750 --> 00:13:49,980
<font color="#CCCCCC">the implementation</font><font color="#E5E5E5"> you can go watch</font>

338
00:13:47,970 --> 00:13:53,820
events<font color="#E5E5E5"> talk from two years ago at</font>

339
00:13:49,980 --> 00:13:55,890
blackhat to see examples<font color="#CCCCCC"> of this so I</font>

340
00:13:53,820 --> 00:13:57,779
don't<font color="#CCCCCC"> come</font><font color="#E5E5E5"> from this</font><font color="#CCCCCC"> background</font><font color="#E5E5E5"> I come</font>

341
00:13:55,890 --> 00:14:00,300
<font color="#CCCCCC">from an exploitation background and I</font>

342
00:13:57,779 --> 00:14:03,060
see<font color="#E5E5E5"> things</font><font color="#CCCCCC"> like the other way up</font><font color="#E5E5E5"> so to</font>

343
00:14:00,300 --> 00:14:06,930
me code is nothing but a collection<font color="#E5E5E5"> of</font>

344
00:14:03,060 --> 00:14:09,000
bugs<font color="#E5E5E5"> in implementation details and so</font>

345
00:14:06,930 --> 00:14:11,010
what's my opinion of security systems

346
00:14:09,000 --> 00:14:12,899
design<font color="#E5E5E5"> yes again this is a other</font>

347
00:14:11,010 --> 00:14:14,880
deliberately provocative statement given

348
00:14:12,899 --> 00:14:21,000
sufficient bug density security design

349
00:14:14,880 --> 00:14:22,980
is irrelevant so everything<font color="#CCCCCC"> that I'm</font>

350
00:14:21,000 --> 00:14:25,500
saying<font color="#E5E5E5"> kind of goes against the little</font>

351
00:14:22,980 --> 00:14:29,880
<font color="#CCCCCC">which</font><font color="#E5E5E5"> Apple publicly say about bugs</font><font color="#CCCCCC"> in</font>

352
00:14:25,500 --> 00:14:31,620
iOS<font color="#E5E5E5"> so there is like very little you can</font>

353
00:14:29,880 --> 00:14:34,020
<font color="#E5E5E5">find out there so this is again from</font>

354
00:14:31,620 --> 00:14:36,029
Yvonne's talk<font color="#E5E5E5"> two years ago and let's</font>

355
00:14:34,020 --> 00:14:37,199
let's read the quote<font color="#E5E5E5"> from the screen so</font>

356
00:14:36,029 --> 00:14:39,089
<font color="#CCCCCC">a feedback that we've</font><font color="#E5E5E5"> heard pretty</font>

357
00:14:37,200 --> 00:14:41,010
consistently both from my<font color="#E5E5E5"> red team Apple</font>

358
00:14:39,089 --> 00:14:43,560
<font color="#CCCCCC">I hope some of</font><font color="#E5E5E5"> them</font><font color="#CCCCCC"> were</font><font color="#E5E5E5"> here today and</font>

359
00:14:41,010 --> 00:14:45,420
also<font color="#CCCCCC"> from</font><font color="#E5E5E5"> researchers directly</font><font color="#CCCCCC"> I don't</font>

360
00:14:43,560 --> 00:14:47,579
know what weird like actual<font color="#E5E5E5"> security</font>

361
00:14:45,420 --> 00:14:48,630
researchers hacking iOS<font color="#CCCCCC"> a-tellin even</font>

362
00:14:47,580 --> 00:14:52,380
that it's hard

363
00:14:48,630 --> 00:14:53,700
<font color="#E5E5E5">maybe you shouldn't trust them but these</font>

364
00:14:52,380 --> 00:14:58,140
<font color="#CCCCCC">people are telling us that</font><font color="#E5E5E5"> it's getting</font>

365
00:14:53,700 --> 00:14:59,970
<font color="#CCCCCC">increasingly more difficult to find some</font>

366
00:14:58,140 --> 00:15:01,529
of<font color="#CCCCCC"> them</font><font color="#E5E5E5"> type this</font><font color="#CCCCCC"> wrong</font><font color="#E5E5E5"> to find some of</font>

367
00:14:59,970 --> 00:15:04,410
those most critical types of security

368
00:15:01,529 --> 00:15:06,029
<font color="#CCCCCC">vulnerabilities</font><font color="#E5E5E5"> and so I'm putting it to</font>

369
00:15:04,410 --> 00:15:08,910
you<font color="#E5E5E5"> that everyone</font><font color="#CCCCCC"> is wearing</font><font color="#E5E5E5"> this</font>

370
00:15:06,029 --> 00:15:11,370
comfort blanket<font color="#CCCCCC"> if like thinking that</font>

371
00:15:08,910 --> 00:15:13,380
<font color="#E5E5E5">this</font><font color="#CCCCCC"> is hard and I'm</font><font color="#E5E5E5"> not trying to say</font>

372
00:15:11,370 --> 00:15:15,060
it's not<font color="#CCCCCC"> hard</font><font color="#E5E5E5"> what I'm more trying</font><font color="#CCCCCC"> to</font>

373
00:15:13,380 --> 00:15:16,649
emphasize<font color="#E5E5E5"> is</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> I don't think that</font>

374
00:15:15,060 --> 00:15:18,149
many<font color="#CCCCCC"> people</font><font color="#E5E5E5"> are actually looking and</font>

375
00:15:16,649 --> 00:15:20,730
it's as simple<font color="#CCCCCC"> as like if you don't look</font>

376
00:15:18,149 --> 00:15:23,130
you<font color="#E5E5E5"> definitely won't find anything</font><font color="#CCCCCC"> and</font>

377
00:15:20,730 --> 00:15:25,800
it seems<font color="#CCCCCC"> to me to be</font><font color="#E5E5E5"> much more a factor</font>

378
00:15:23,130 --> 00:15:27,560
<font color="#E5E5E5">of time you put in and I put a lot of</font>

379
00:15:25,800 --> 00:15:30,270
time in but this<font color="#E5E5E5"> is all I do</font>

380
00:15:27,560 --> 00:15:32,040
equals bugs out say all<font color="#E5E5E5"> right let's</font>

381
00:15:30,270 --> 00:15:34,110
actually like get to some bug

382
00:15:32,040 --> 00:15:35,880
yes<font color="#E5E5E5"> for those of you from Apple this</font><font color="#CCCCCC"> is</font>

383
00:15:34,110 --> 00:15:38,580
a very old<font color="#E5E5E5"> example but I will</font><font color="#CCCCCC"> get to</font>

384
00:15:35,880 --> 00:15:40,020
<font color="#E5E5E5">some much more relevant examples it's a</font>

385
00:15:38,580 --> 00:15:42,750
much<font color="#E5E5E5"> more recent examples but I think</font>

386
00:15:40,020 --> 00:15:44,220
nevertheless<font color="#E5E5E5"> that this is like the</font>

387
00:15:42,750 --> 00:15:46,800
lessons that<font color="#CCCCCC"> you can learn from this</font>

388
00:15:44,220 --> 00:15:50,490
example<font color="#E5E5E5"> do still apply right</font>

389
00:15:46,800 --> 00:15:51,959
so when he<font color="#E5E5E5"> found was making this this</font>

390
00:15:50,490 --> 00:15:53,880
point that it's getting<font color="#E5E5E5"> increasingly</font>

391
00:15:51,960 --> 00:15:55,200
<font color="#CCCCCC">difficult to</font><font color="#E5E5E5"> find more of these most</font>

392
00:15:53,880 --> 00:15:57,780
critical types of security

393
00:15:55,200 --> 00:16:01,110
<font color="#CCCCCC">vulnerabilities this code hit one of the</font>

394
00:15:57,780 --> 00:16:04,579
iOS<font color="#E5E5E5"> 10 betas and it shipped first in iOS</font>

395
00:16:01,110 --> 00:16:08,340
10 which was<font color="#E5E5E5"> the first iOS release which</font>

396
00:16:04,580 --> 00:16:10,710
qualified for the Apple bug bounty so if

397
00:16:08,340 --> 00:16:12,930
you're not<font color="#E5E5E5"> familiar with xnu kernel</font><font color="#CCCCCC"> this</font>

398
00:16:10,710 --> 00:16:15,750
<font color="#CCCCCC">is a</font><font color="#E5E5E5"> brand new</font><font color="#CCCCCC"> siskel reachable from any</font>

399
00:16:12,930 --> 00:16:18,449
sandbox context<font color="#E5E5E5"> like the sandbox is not</font>

400
00:16:15,750 --> 00:16:21,050
involved<font color="#E5E5E5"> at all here</font><font color="#CCCCCC"> so for</font><font color="#E5E5E5"> example you</font>

401
00:16:18,450 --> 00:16:23,940
can reach<font color="#E5E5E5"> this from the Safari renderer</font>

402
00:16:21,050 --> 00:16:26,160
<font color="#CCCCCC">so it's fun to like</font><font color="#E5E5E5"> play spot the bug</font>

403
00:16:23,940 --> 00:16:27,420
here<font color="#E5E5E5"> so if</font><font color="#CCCCCC"> your</font><font color="#E5E5E5"> so I'll just like tell</font>

404
00:16:26,160 --> 00:16:29,959
you a little<font color="#E5E5E5"> bit about the API</font><font color="#CCCCCC"> so in</font>

405
00:16:27,420 --> 00:16:32,640
case you're not familiar with them<font color="#E5E5E5"> so</font>

406
00:16:29,960 --> 00:16:35,160
copy in let's have a look

407
00:16:32,640 --> 00:16:38,699
copy in is like a copy from user or

408
00:16:35,160 --> 00:16:40,709
Linux<font color="#CCCCCC"> so the first argument is user</font>

409
00:16:38,700 --> 00:16:42,150
space pointer second argument is a

410
00:16:40,710 --> 00:16:46,800
kernel space pointer and the last

411
00:16:42,150 --> 00:16:50,480
argument is the size I just have some

412
00:16:46,800 --> 00:16:50,479
more<font color="#E5E5E5"> Pepsi</font><font color="#CCCCCC"> and you can</font><font color="#E5E5E5"> get a code</font>

413
00:16:52,700 --> 00:16:57,660
because this is an<font color="#CCCCCC"> example</font><font color="#E5E5E5"> of a bug</font><font color="#CCCCCC"> that</font>

414
00:16:55,430 --> 00:16:58,800
it's actually kind of fun it was<font color="#E5E5E5"> kind of</font>

415
00:16:57,660 --> 00:17:01,469
fun at the<font color="#E5E5E5"> time to show you people in</font>

416
00:16:58,800 --> 00:17:04,109
the office because<font color="#E5E5E5"> you it really makes</font>

417
00:17:01,470 --> 00:17:06,660
you do a<font color="#E5E5E5"> double-take of like is there</font>

418
00:17:04,109 --> 00:17:08,179
actually a bug<font color="#CCCCCC"> there</font><font color="#E5E5E5"> right let's look</font>

419
00:17:06,660 --> 00:17:11,190
through<font color="#E5E5E5"> the code okay what do we do</font>

420
00:17:08,180 --> 00:17:12,959
we're<font color="#CCCCCC"> gonna copy in so ARBs points to</font>

421
00:17:11,190 --> 00:17:14,490
stuff that<font color="#E5E5E5"> we control from user space</font><font color="#CCCCCC"> so</font>

422
00:17:12,959 --> 00:17:18,209
we're going<font color="#E5E5E5"> to copy in from recipe size</font>

423
00:17:14,490 --> 00:17:20,370
<font color="#CCCCCC">users base pointer to</font><font color="#E5E5E5"> SC this size the</font>

424
00:17:18,209 --> 00:17:22,620
size of size<font color="#E5E5E5"> all right so easy</font><font color="#CCCCCC"> so recipe</font>

425
00:17:20,369 --> 00:17:25,290
<font color="#E5E5E5">size points to a size and then we pass</font>

426
00:17:22,619 --> 00:17:27,208
that size to<font color="#CCCCCC"> kalach</font><font color="#E5E5E5"> which is like the</font>

427
00:17:25,290 --> 00:17:29,190
<font color="#CCCCCC">kernels base general purpose</font><font color="#E5E5E5"> keep</font>

428
00:17:27,209 --> 00:17:31,740
alligator<font color="#E5E5E5"> and then we get back</font><font color="#CCCCCC"> this</font>

429
00:17:29,190 --> 00:17:33,840
chunk<font color="#E5E5E5"> of memory</font><font color="#CCCCCC"> Kay recipe</font><font color="#E5E5E5"> and later on</font>

430
00:17:31,740 --> 00:17:36,810
down the<font color="#E5E5E5"> bottom we're gonna copy in from</font>

431
00:17:33,840 --> 00:17:37,919
<font color="#E5E5E5">args recipe pointing to some kind of</font>

432
00:17:36,810 --> 00:17:41,970
recipe structure it doesn't<font color="#E5E5E5"> really</font>

433
00:17:37,920 --> 00:17:43,350
<font color="#E5E5E5">matter what recipe is to</font><font color="#CCCCCC"> K recipe and</font>

434
00:17:41,970 --> 00:17:45,880
how much<font color="#CCCCCC"> we're gonna copy we're gonna</font>

435
00:17:43,350 --> 00:17:48,520
copy recipe<font color="#CCCCCC"> size</font><font color="#E5E5E5"> all that sounds</font>

436
00:17:45,880 --> 00:17:50,140
we're gonna copy the signs except<font color="#CCCCCC"> about</font>

437
00:17:48,520 --> 00:17:52,030
<font color="#E5E5E5">if you go back up to the top recipe</font>

438
00:17:50,140 --> 00:17:53,070
science was used<font color="#CCCCCC"> as a pointer</font><font color="#E5E5E5"> and now</font>

439
00:17:52,030 --> 00:18:00,670
it's used as a<font color="#E5E5E5"> limp</font>

440
00:17:53,070 --> 00:18:04,840
so like this code<font color="#E5E5E5"> shipped for six months</font>

441
00:18:00,670 --> 00:18:08,650
<font color="#CCCCCC">until I</font><font color="#E5E5E5"> got around to graphing the xnu</font>

442
00:18:04,840 --> 00:18:11,320
<font color="#CCCCCC">dips</font><font color="#E5E5E5"> for copy in because yes that's what</font>

443
00:18:08,650 --> 00:18:14,830
I do<font color="#E5E5E5"> every</font><font color="#CCCCCC"> time these these dips come</font>

444
00:18:11,320 --> 00:18:16,929
out<font color="#E5E5E5"> they're very sporadically so this is</font>

445
00:18:14,830 --> 00:18:18,639
the kind of issue<font color="#CCCCCC"> that I'm claiming</font><font color="#E5E5E5"> is</font>

446
00:18:16,930 --> 00:18:22,540
still on the same<font color="#E5E5E5"> order of</font><font color="#CCCCCC"> like</font>

447
00:18:18,640 --> 00:18:23,710
complexity as<font color="#CCCCCC"> davidich</font><font color="#E5E5E5"> fields</font><font color="#CCCCCC"> sequel</font>

448
00:18:22,540 --> 00:18:26,320
server but from<font color="#E5E5E5"> 15 years</font><font color="#CCCCCC"> ago</font>

449
00:18:23,710 --> 00:18:28,060
<font color="#CCCCCC">right for this kind of issue there's no</font>

450
00:18:26,320 --> 00:18:30,310
need to understand like complex<font color="#E5E5E5"> or</font>

451
00:18:28,060 --> 00:18:32,710
esoteric<font color="#E5E5E5"> stuff about the operating</font>

452
00:18:30,310 --> 00:18:34,659
<font color="#E5E5E5">system just</font><font color="#CCCCCC"> knowing</font><font color="#E5E5E5"> C should let you see</font>

453
00:18:32,710 --> 00:18:37,120
if this code is completely<font color="#E5E5E5"> wrong so</font>

454
00:18:34,660 --> 00:18:39,520
<font color="#CCCCCC">clearly there are</font><font color="#E5E5E5"> no annotations there's</font>

455
00:18:37,120 --> 00:18:43,209
nothing like Linux I'm just got

456
00:18:39,520 --> 00:18:45,970
underscore user<font color="#CCCCCC"> ID you pre get</font><font color="#E5E5E5"> some</font>

457
00:18:43,210 --> 00:18:47,770
compiler warnings but I don't know if

458
00:18:45,970 --> 00:18:49,780
<font color="#CCCCCC">you've ever tried</font><font color="#E5E5E5"> to compile xnu with</font>

459
00:18:47,770 --> 00:18:52,330
all warnings enabled<font color="#E5E5E5"> yeah good luck</font>

460
00:18:49,780 --> 00:18:53,860
<font color="#CCCCCC">reading through that and finding this so</font>

461
00:18:52,330 --> 00:18:56,169
<font color="#CCCCCC">what are my main points here</font><font color="#E5E5E5"> or what</font>

462
00:18:53,860 --> 00:18:57,969
about<font color="#E5E5E5"> code review I'm not blaming the</font>

463
00:18:56,170 --> 00:18:59,650
individual developer in fact if you look

464
00:18:57,970 --> 00:19:01,540
at<font color="#E5E5E5"> this case you can see why it ended up</font>

465
00:18:59,650 --> 00:19:02,890
like<font color="#CCCCCC"> this</font><font color="#E5E5E5"> this is just</font><font color="#CCCCCC"> copy and pasted</font>

466
00:19:01,540 --> 00:19:05,950
from some other code and they made a

467
00:19:02,890 --> 00:19:08,620
subtle change the API<font color="#E5E5E5"> writing C code is</font>

468
00:19:05,950 --> 00:19:10,360
hard<font color="#E5E5E5"> and this</font><font color="#CCCCCC"> is a new Siskel reachable</font>

469
00:19:08,620 --> 00:19:12,820
from everywhere on the system and it has

470
00:19:10,360 --> 00:19:14,199
clearly not been reviewed<font color="#E5E5E5"> by someone</font>

471
00:19:12,820 --> 00:19:16,540
with a<font color="#CCCCCC"> vulnerability research background</font>

472
00:19:14,200 --> 00:19:18,580
<font color="#E5E5E5">because they would spot this and yes</font>

473
00:19:16,540 --> 00:19:20,740
this example is from<font color="#E5E5E5"> iOS 10 this kind of</font>

474
00:19:18,580 --> 00:19:22,960
stuff is still<font color="#CCCCCC"> having today in iOS 11</font>

475
00:19:20,740 --> 00:19:24,730
and the motivating examples are so

476
00:19:22,960 --> 00:19:26,590
motivating in<font color="#CCCCCC"> recent that</font><font color="#E5E5E5"> I can't talk</font>

477
00:19:24,730 --> 00:19:29,020
<font color="#CCCCCC">about them because</font><font color="#E5E5E5"> they're still under</font>

478
00:19:26,590 --> 00:19:30,879
<font color="#E5E5E5">the 90-day deadline so right what about</font>

479
00:19:29,020 --> 00:19:33,220
testing<font color="#CCCCCC"> all right you might realize</font>

480
00:19:30,880 --> 00:19:35,830
exactly kind<font color="#CCCCCC"> of tricky to make</font><font color="#E5E5E5"> that code</font>

481
00:19:33,220 --> 00:19:36,940
run<font color="#CCCCCC"> the</font><font color="#E5E5E5"> kind of tricky</font><font color="#CCCCCC"> B even to exploit</font>

482
00:19:35,830 --> 00:19:39,370
this code<font color="#E5E5E5"> because it will just</font><font color="#CCCCCC"> come a</font>

483
00:19:36,940 --> 00:19:43,570
panic<font color="#E5E5E5"> so yeah there are no tests and</font>

484
00:19:39,370 --> 00:19:44,860
there's also<font color="#E5E5E5"> clearly no fuzzing</font><font color="#CCCCCC"> alright</font>

485
00:19:43,570 --> 00:19:47,710
so you<font color="#E5E5E5"> may</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> up things better now all</font>

486
00:19:44,860 --> 00:19:49,929
right<font color="#CCCCCC"> so</font><font color="#E5E5E5"> this is an example from the</font>

487
00:19:47,710 --> 00:19:50,820
<font color="#CCCCCC">exploit I released a</font><font color="#E5E5E5"> month ago</font><font color="#CCCCCC"> or so</font>

488
00:19:49,930 --> 00:19:54,670
called

489
00:19:50,820 --> 00:19:58,149
<font color="#E5E5E5">multipath and so we just</font><font color="#CCCCCC"> do one more</font>

490
00:19:54,670 --> 00:19:59,210
spot bug in some C code so this<font color="#E5E5E5"> picture</font>

491
00:19:58,150 --> 00:20:02,600
is<font color="#CCCCCC"> called multipath</font>

492
00:19:59,210 --> 00:20:05,270
<font color="#CCCCCC">TCP</font><font color="#E5E5E5"> it lets you</font><font color="#CCCCCC"> take TCP and like run it</font>

493
00:20:02,600 --> 00:20:09,500
<font color="#E5E5E5">over multiple physical multiple network</font>

494
00:20:05,270 --> 00:20:11,779
interfaces<font color="#CCCCCC"> so if you</font><font color="#E5E5E5"> wanna play spot the</font>

495
00:20:09,500 --> 00:20:13,730
bug<font color="#E5E5E5"> and</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> control what</font><font color="#CCCCCC"> desk points do</font>

496
00:20:11,779 --> 00:20:15,380
it points to one of these<font color="#CCCCCC"> so kind of</font>

497
00:20:13,730 --> 00:20:17,630
<font color="#E5E5E5">structures like</font><font color="#CCCCCC"> the positive side of</font>

498
00:20:15,380 --> 00:20:19,520
thing and<font color="#E5E5E5"> so if we just look through the</font>

499
00:20:17,630 --> 00:20:22,070
logic<font color="#E5E5E5"> of this code</font><font color="#CCCCCC"> coming</font><font color="#E5E5E5"> to down a bit</font>

500
00:20:19,520 --> 00:20:24,440
but the logic<font color="#CCCCCC"> is still the same</font><font color="#E5E5E5"> right</font><font color="#CCCCCC"> so</font>

501
00:20:22,070 --> 00:20:27,799
if this sock adder<font color="#E5E5E5"> is</font><font color="#CCCCCC"> a F I know</font>

502
00:20:24,440 --> 00:20:31,730
<font color="#CCCCCC">so ipv4 socket</font><font color="#E5E5E5"> and the length is not the</font>

503
00:20:27,799 --> 00:20:35,929
size of an ipv4 address then we bail<font color="#CCCCCC"> if</font>

504
00:20:31,730 --> 00:20:38,299
the family type is ipv6 address and the

505
00:20:35,929 --> 00:20:41,480
socket length is not the size of an ipv6

506
00:20:38,299 --> 00:20:43,490
address<font color="#E5E5E5"> then we bail otherwise I have</font>

507
00:20:41,480 --> 00:20:46,130
some<font color="#E5E5E5"> other if which is got nothing to do</font>

508
00:20:43,490 --> 00:20:48,500
<font color="#E5E5E5">with the length then</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> just like mem</font>

509
00:20:46,130 --> 00:20:50,330
copy straight<font color="#E5E5E5"> into here</font><font color="#CCCCCC"> so you control</font>

510
00:20:48,500 --> 00:20:53,179
<font color="#CCCCCC">sa Len it's a single byte so it's up to</font>

511
00:20:50,330 --> 00:20:55,760
255 bytes<font color="#E5E5E5"> and you can go read the</font><font color="#CCCCCC"> Keene</font>

512
00:20:53,179 --> 00:20:59,510
team<font color="#E5E5E5"> right up for my exploit for this</font>

513
00:20:55,760 --> 00:21:02,960
<font color="#E5E5E5">it's actually exploitable in kind of an</font>

514
00:20:59,510 --> 00:21:04,700
<font color="#E5E5E5">interesting way</font><font color="#CCCCCC"> because you can you can</font>

515
00:21:02,960 --> 00:21:06,169
overwrite interesting pointers inside

516
00:21:04,700 --> 00:21:08,539
<font color="#E5E5E5">this</font><font color="#CCCCCC"> structure</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> don't really need to</font>

517
00:21:06,169 --> 00:21:15,500
<font color="#CCCCCC">do any heat grooming</font><font color="#E5E5E5"> to get a use of a</font>

518
00:21:08,539 --> 00:21:17,120
control<font color="#E5E5E5"> point to here so yeah those two</font>

519
00:21:15,500 --> 00:21:19,730
points lie<font color="#E5E5E5"> firmly in this class of like</font>

520
00:21:17,120 --> 00:21:22,879
legacy bugs<font color="#CCCCCC"> I mean they're not legacy</font>

521
00:21:19,730 --> 00:21:24,980
bugs<font color="#CCCCCC"> they're not thirty year old mark</font>

522
00:21:22,880 --> 00:21:27,320
bugs they're very new bugs but they're

523
00:21:24,980 --> 00:21:29,330
this class of like legacy<font color="#CCCCCC"> C coding</font>

524
00:21:27,320 --> 00:21:29,779
problems right which maybe we shouldn't

525
00:21:29,330 --> 00:21:32,570
have<font color="#CCCCCC"> anymore</font>

526
00:21:29,779 --> 00:21:34,460
we definitely<font color="#CCCCCC"> do so again</font><font color="#E5E5E5"> please like</font>

527
00:21:32,570 --> 00:21:36,110
I'm not<font color="#E5E5E5"> trying to criticize criticize</font>

528
00:21:34,460 --> 00:21:38,450
the individual developers who wrote

529
00:21:36,110 --> 00:21:40,340
those two<font color="#CCCCCC"> particular</font><font color="#E5E5E5"> examples these are</font>

530
00:21:38,450 --> 00:21:42,320
<font color="#E5E5E5">failures of process</font><font color="#CCCCCC"> it shouldn't</font><font color="#E5E5E5"> be</font>

531
00:21:40,340 --> 00:21:43,908
possible to commit this<font color="#E5E5E5"> kind of pair</font>

532
00:21:42,320 --> 00:21:45,980
right<font color="#E5E5E5"> it should be prevented by</font>

533
00:21:43,909 --> 00:21:47,240
annotations<font color="#E5E5E5"> it should be prevented by</font>

534
00:21:45,980 --> 00:21:48,860
code review it should be<font color="#CCCCCC"> prevented by</font>

535
00:21:47,240 --> 00:21:50,510
manual testing<font color="#CCCCCC"> it should be prevented</font><font color="#E5E5E5"> by</font>

536
00:21:48,860 --> 00:21:52,100
fuzzing and this is the kind<font color="#CCCCCC"> of stuff</font>

537
00:21:50,510 --> 00:21:54,770
that Bill Gates was talking about<font color="#E5E5E5"> 15</font>

538
00:21:52,100 --> 00:21:57,379
<font color="#E5E5E5">years ago</font><font color="#CCCCCC"> right and this should not be</font>

539
00:21:54,770 --> 00:22:00,889
<font color="#CCCCCC">happening in quote/unquote secure code</font>

540
00:21:57,380 --> 00:22:03,649
bases now<font color="#E5E5E5"> any case you think I'm just</font>

541
00:22:00,890 --> 00:22:04,909
taking<font color="#CCCCCC"> -</font><font color="#E5E5E5"> two</font><font color="#CCCCCC"> -</font><font color="#E5E5E5"> two examples like please</font>

542
00:22:03,649 --> 00:22:07,039
go<font color="#CCCCCC"> look at the project zero bug tracker</font>

543
00:22:04,909 --> 00:22:08,990
<font color="#CCCCCC">and see</font><font color="#E5E5E5"> all of the similar issues right</font>

544
00:22:07,039 --> 00:22:10,060
my point<font color="#E5E5E5"> is</font><font color="#CCCCCC"> that this is</font><font color="#E5E5E5"> systemic</font>

545
00:22:08,990 --> 00:22:13,080
process failures and

546
00:22:10,060 --> 00:22:15,730
that's what Apple need to address<font color="#E5E5E5"> so</font>

547
00:22:13,080 --> 00:22:17,379
there<font color="#E5E5E5"> are other classes of issues which</font>

548
00:22:15,730 --> 00:22:19,570
<font color="#CCCCCC">perhaps more interesting than these</font><font color="#E5E5E5"> see</font>

549
00:22:17,380 --> 00:22:21,880
bugs which fall into<font color="#CCCCCC"> more like this</font>

550
00:22:19,570 --> 00:22:23,620
bucket<font color="#E5E5E5"> of more esoteric</font><font color="#CCCCCC"> issues so</font>

551
00:22:21,880 --> 00:22:25,330
they're<font color="#E5E5E5"> not</font><font color="#CCCCCC"> just simple C coding</font>

552
00:22:23,620 --> 00:22:27,159
problems like buffer overflows like

553
00:22:25,330 --> 00:22:29,139
<font color="#CCCCCC">these but they</font><font color="#E5E5E5"> require kind of more</font>

554
00:22:27,160 --> 00:22:31,480
understanding of the underlying<font color="#E5E5E5"> system</font>

555
00:22:29,140 --> 00:22:35,140
and<font color="#E5E5E5"> its paradigms so let's take a look</font>

556
00:22:31,480 --> 00:22:37,120
at two examples of esoteric bugs which

557
00:22:35,140 --> 00:22:40,330
also<font color="#E5E5E5"> say something</font><font color="#CCCCCC"> about apples security</font>

558
00:22:37,120 --> 00:22:43,540
culture<font color="#E5E5E5"> so if you've read this book this</font>

559
00:22:40,330 --> 00:22:48,939
<font color="#E5E5E5">is a book from 2012 by Jonathan Levin</font>

560
00:22:43,540 --> 00:22:52,930
<font color="#E5E5E5">and so iOS is based on this combination</font>

561
00:22:48,940 --> 00:22:55,570
of<font color="#CCCCCC"> bsd and ma</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> MA it's full of</font><font color="#E5E5E5"> like a</font>

562
00:22:52,930 --> 00:22:57,790
bunch of<font color="#E5E5E5"> really weird</font><font color="#CCCCCC"> API is and like</font>

563
00:22:55,570 --> 00:22:59,379
Apple are slowly<font color="#E5E5E5"> turning these</font><font color="#CCCCCC"> API eyes</font>

564
00:22:57,790 --> 00:23:01,540
off removing<font color="#E5E5E5"> them and</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is very good</font>

565
00:22:59,380 --> 00:23:03,070
<font color="#E5E5E5">thing but I definitely</font><font color="#CCCCCC"> get the feeling</font>

566
00:23:01,540 --> 00:23:05,920
that Apple lacks the<font color="#E5E5E5"> kind of</font>

567
00:23:03,070 --> 00:23:07,929
institutional memory to know why many<font color="#E5E5E5"> of</font>

568
00:23:05,920 --> 00:23:11,410
these<font color="#E5E5E5"> things are there or are still</font>

569
00:23:07,930 --> 00:23:13,840
there<font color="#E5E5E5"> so I think I</font><font color="#CCCCCC"> mentioned before</font><font color="#E5E5E5"> it</font>

570
00:23:11,410 --> 00:23:16,270
the iOS<font color="#E5E5E5"> has</font><font color="#CCCCCC"> a very confusing and</font>

571
00:23:13,840 --> 00:23:18,459
complicated<font color="#CCCCCC"> privileged model right</font><font color="#E5E5E5"> it's</font>

572
00:23:16,270 --> 00:23:22,060
way more complicated<font color="#CCCCCC"> than just</font><font color="#E5E5E5"> user</font>

573
00:23:18,460 --> 00:23:24,370
<font color="#CCCCCC">unroot</font><font color="#E5E5E5"> root is completely distinct</font><font color="#CCCCCC"> from</font>

574
00:23:22,060 --> 00:23:26,139
kernel code execution<font color="#E5E5E5"> on iOS and each</font>

575
00:23:24,370 --> 00:23:29,080
process has its own set of these things

576
00:23:26,140 --> 00:23:31,660
called<font color="#CCCCCC"> entitlements and checks for these</font>

577
00:23:29,080 --> 00:23:33,939
entitlements like dotted basically

578
00:23:31,660 --> 00:23:39,310
seemingly randomly across<font color="#E5E5E5"> user space on</font>

579
00:23:33,940 --> 00:23:43,990
the kernel<font color="#CCCCCC"> so what is this</font><font color="#E5E5E5"> bug</font><font color="#CCCCCC"> that's</font><font color="#E5E5E5"> in</font>

580
00:23:39,310 --> 00:23:46,600
this book<font color="#E5E5E5"> from 2012 so this is a some</font>

581
00:23:43,990 --> 00:23:48,910
old feature<font color="#E5E5E5"> from</font><font color="#CCCCCC"> ma that if</font><font color="#E5E5E5"> your root</font>

582
00:23:46,600 --> 00:23:50,500
gives you read/write access to all the

583
00:23:48,910 --> 00:23:52,240
user space processes on the system

584
00:23:50,500 --> 00:23:54,550
<font color="#CCCCCC">we'd more access to their memory</font><font color="#E5E5E5"> without</font>

585
00:23:52,240 --> 00:23:58,090
requiring<font color="#E5E5E5"> the entitlement that's meant</font>

586
00:23:54,550 --> 00:24:01,300
<font color="#CCCCCC">to stop you ever getting that right</font><font color="#E5E5E5"> so I</font>

587
00:23:58,090 --> 00:24:03,580
didn't find this bug<font color="#E5E5E5"> it's in this book</font>

588
00:24:01,300 --> 00:24:05,440
<font color="#CCCCCC">free 2012 right and also when I read</font>

589
00:24:03,580 --> 00:24:07,449
this I just<font color="#E5E5E5"> kind of assumed it</font><font color="#CCCCCC"> had been</font>

590
00:24:05,440 --> 00:24:10,570
<font color="#E5E5E5">fixed</font><font color="#CCCCCC"> because you know it's in this old</font>

591
00:24:07,450 --> 00:24:12,820
book<font color="#E5E5E5"> but you know I found myself in the</font>

592
00:24:10,570 --> 00:24:15,510
situation with a bug<font color="#CCCCCC"> or I was able to</font>

593
00:24:12,820 --> 00:24:18,580
test this right so if you<font color="#E5E5E5"> just go buy a</font>

594
00:24:15,510 --> 00:24:21,250
<font color="#E5E5E5">device from Apple and test this you</font>

595
00:24:18,580 --> 00:24:23,080
can't because you need to exploit<font color="#CCCCCC"> some</font>

596
00:24:21,250 --> 00:24:24,550
own<font color="#CCCCCC"> a that you found that's not patched</font>

597
00:24:23,080 --> 00:24:26,590
<font color="#E5E5E5">in order to get</font>

598
00:24:24,550 --> 00:24:28,330
in order to<font color="#CCCCCC"> copy-paste but you don't</font>

599
00:24:26,590 --> 00:24:30,370
even need to<font color="#CCCCCC"> type the</font><font color="#E5E5E5"> code in from here</font>

600
00:24:28,330 --> 00:24:32,860
because<font color="#E5E5E5"> Jonathan</font><font color="#CCCCCC"> Levin</font><font color="#E5E5E5"> even put it on</font>

601
00:24:30,370 --> 00:24:35,739
his<font color="#E5E5E5"> website with a big like banner</font>

602
00:24:32,860 --> 00:24:38,939
saying this is a bug<font color="#E5E5E5"> right</font><font color="#CCCCCC"> and it only</font>

603
00:24:35,740 --> 00:24:41,950
<font color="#E5E5E5">got fixed after</font><font color="#CCCCCC"> I used it in an exploit</font>

604
00:24:38,940 --> 00:24:43,300
so what's my point<font color="#E5E5E5"> here applique</font><font color="#CCCCCC"> Lee not</font>

605
00:24:41,950 --> 00:24:45,220
doing enough proactive<font color="#E5E5E5"> runner ability</font>

606
00:24:43,300 --> 00:24:48,720
research and they're not even fixing

607
00:24:45,220 --> 00:24:48,720
<font color="#E5E5E5">these bugs that are documented in books</font>

608
00:24:49,080 --> 00:24:55,720
right so I discuss<font color="#CCCCCC"> lack</font><font color="#E5E5E5"> of code review</font>

609
00:24:52,900 --> 00:24:57,910
<font color="#E5E5E5">lack of testing auditing and</font><font color="#CCCCCC"> practice</font>

610
00:24:55,720 --> 00:24:59,560
<font color="#CCCCCC">run durability research</font><font color="#E5E5E5"> I felt obliged</font>

611
00:24:57,910 --> 00:25:03,910
<font color="#E5E5E5">to have at least one slide with some</font>

612
00:24:59,560 --> 00:25:05,980
<font color="#CCCCCC">assembly on so what is</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> bug this</font><font color="#E5E5E5"> is</font>

613
00:25:03,910 --> 00:25:10,090
an example of a failure<font color="#CCCCCC"> of variant</font>

614
00:25:05,980 --> 00:25:11,710
analysis so in<font color="#E5E5E5"> 2016</font><font color="#CCCCCC"> I reported a bunch</font>

615
00:25:10,090 --> 00:25:13,780
of issues<font color="#E5E5E5"> found in these user space</font>

616
00:25:11,710 --> 00:25:16,690
services which<font color="#E5E5E5"> are written</font><font color="#CCCCCC"> using</font><font color="#E5E5E5"> this</font>

617
00:25:13,780 --> 00:25:20,920
ancient<font color="#E5E5E5"> tool called</font><font color="#CCCCCC"> MIG</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> I feel</font>

618
00:25:16,690 --> 00:25:22,690
obliged to show you some<font color="#E5E5E5"> MIG code</font><font color="#CCCCCC"> this</font>

619
00:25:20,920 --> 00:25:24,880
<font color="#E5E5E5">is the</font><font color="#CCCCCC"> mock interface generator</font>

620
00:25:22,690 --> 00:25:28,330
it's literally thousands upon thousands

621
00:25:24,880 --> 00:25:30,760
of lines of<font color="#E5E5E5"> C code F print effing more C</font>

622
00:25:28,330 --> 00:25:32,740
code to<font color="#CCCCCC"> generate these handlers right</font>

623
00:25:30,760 --> 00:25:34,629
and these<font color="#E5E5E5"> are used everywhere this gets</font>

624
00:25:32,740 --> 00:25:37,120
you from<font color="#E5E5E5"> the user to</font><font color="#CCCCCC"> colonel or between</font>

625
00:25:34,630 --> 00:25:39,610
all<font color="#CCCCCC"> of</font><font color="#E5E5E5"> these users</font><font color="#CCCCCC"> face processes</font><font color="#E5E5E5"> so</font>

626
00:25:37,120 --> 00:25:43,719
much<font color="#E5E5E5"> of it is built on this literally</font>

627
00:25:39,610 --> 00:25:45,699
impossible<font color="#E5E5E5"> to audit code base</font><font color="#CCCCCC"> but this</font>

628
00:25:43,720 --> 00:25:48,160
<font color="#E5E5E5">is not about bugs in that</font><font color="#CCCCCC"> code generator</font>

629
00:25:45,700 --> 00:25:50,560
it's about a much<font color="#E5E5E5"> simpler aspect of</font><font color="#CCCCCC"> meg</font>

630
00:25:48,160 --> 00:25:53,350
<font color="#E5E5E5">which is this simple rule for object</font>

631
00:25:50,560 --> 00:25:55,629
lifetime management so for the objects

632
00:25:53,350 --> 00:25:57,639
that<font color="#E5E5E5"> you pass across an RPC boundary</font>

633
00:25:55,630 --> 00:26:01,210
<font color="#E5E5E5">there's the simple there is a simple</font>

634
00:25:57,640 --> 00:26:03,340
rule if your handler returns<font color="#CCCCCC"> zero which</font>

635
00:26:01,210 --> 00:26:05,110
is a success value then your<font color="#CCCCCC"> handlers</font>

636
00:26:03,340 --> 00:26:08,020
responsible<font color="#CCCCCC"> for the lifetime of any</font>

637
00:26:05,110 --> 00:26:10,300
objects which will<font color="#E5E5E5"> pass to</font><font color="#CCCCCC"> it and if</font>

638
00:26:08,020 --> 00:26:11,560
your handler returns an error code you

639
00:26:10,300 --> 00:26:13,780
are not<font color="#CCCCCC"> responsible for the ownership</font>

640
00:26:11,560 --> 00:26:16,720
<font color="#E5E5E5">namely the system the RPC system is</font>

641
00:26:13,780 --> 00:26:18,220
responsible<font color="#CCCCCC"> for the ownership so this</font>

642
00:26:16,720 --> 00:26:21,450
leads to a very<font color="#CCCCCC"> common</font><font color="#E5E5E5"> class of bug</font>

643
00:26:18,220 --> 00:26:23,860
which is if you<font color="#E5E5E5"> have a handler which</font>

644
00:26:21,450 --> 00:26:27,400
takes ownership of a reference<font color="#E5E5E5"> in this</font>

645
00:26:23,860 --> 00:26:31,899
<font color="#E5E5E5">case it is dropping a reference on this</font>

646
00:26:27,400 --> 00:26:36,509
<font color="#CCCCCC">object</font><font color="#E5E5E5"> and then w22 ends up being the</font>

647
00:26:31,900 --> 00:26:38,909
<font color="#E5E5E5">return value index</font><font color="#CCCCCC"> zero for this method</font>

648
00:26:36,509 --> 00:26:42,179
what that means is that the actual<font color="#CCCCCC"> mig</font>

649
00:26:38,909 --> 00:26:44,969
system itself will<font color="#CCCCCC"> dis</font><font color="#E5E5E5"> or what the mixed</font>

650
00:26:42,179 --> 00:26:47,429
system itself will decide that<font color="#CCCCCC"> okay the</font>

651
00:26:44,969 --> 00:26:48,839
code didn't take ownership<font color="#E5E5E5"> of this</font>

652
00:26:47,429 --> 00:26:50,959
object<font color="#E5E5E5"> so</font><font color="#CCCCCC"> i'm gonna release</font><font color="#E5E5E5"> the</font>

653
00:26:48,839 --> 00:26:53,158
reference<font color="#E5E5E5"> and this leads to in this case</font>

654
00:26:50,959 --> 00:26:59,579
<font color="#CCCCCC">dropping a reference</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> was</font><font color="#E5E5E5"> only taken</font>

655
00:26:53,159 --> 00:27:02,820
once I'm dropping it twice<font color="#CCCCCC"> so I reported</font>

656
00:26:59,579 --> 00:27:04,649
the first<font color="#E5E5E5"> instance of this in 2016 you</font>

657
00:27:02,820 --> 00:27:06,899
can<font color="#E5E5E5"> go into the project</font><font color="#CCCCCC"> Co tracker and</font>

658
00:27:04,649 --> 00:27:09,059
see where I quite explicitly say there

659
00:27:06,899 --> 00:27:11,668
are more instances<font color="#CCCCCC"> of this bug and it's</font>

660
00:27:09,059 --> 00:27:13,259
<font color="#E5E5E5">really hard when you only have the</font>

661
00:27:11,669 --> 00:27:14,549
<font color="#CCCCCC">binary switch</font><font color="#E5E5E5"> it's what I have for</font>

662
00:27:13,259 --> 00:27:16,559
almost<font color="#E5E5E5"> all of this stuff on</font><font color="#CCCCCC"> this it's on</font>

663
00:27:14,549 --> 00:27:18,839
<font color="#E5E5E5">open source</font><font color="#CCCCCC"> tarball comm</font><font color="#E5E5E5"> it's really</font>

664
00:27:16,559 --> 00:27:21,479
hard to go find all instances of<font color="#E5E5E5"> this</font>

665
00:27:18,839 --> 00:27:24,359
<font color="#E5E5E5">but in the source my guess is that it</font>

666
00:27:21,479 --> 00:27:26,249
<font color="#E5E5E5">shouldn't be so hard</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> but I see</font>

667
00:27:24,359 --> 00:27:27,989
very<font color="#E5E5E5"> little evidence again very little</font>

668
00:27:26,249 --> 00:27:32,639
<font color="#CCCCCC">evidence</font><font color="#E5E5E5"> up until like bugs that I can't</font>

669
00:27:27,989 --> 00:27:35,159
say that not enough<font color="#CCCCCC"> ferret analysis of</font>

670
00:27:32,639 --> 00:27:36,779
things<font color="#E5E5E5"> like this are happening for</font>

671
00:27:35,159 --> 00:27:38,879
example<font color="#CCCCCC"> one of the Keene team bugs which</font>

672
00:27:36,779 --> 00:27:40,739
they are nominated<font color="#CCCCCC"> for a pony for is</font>

673
00:27:38,879 --> 00:27:43,678
this bug class which I pointed<font color="#CCCCCC"> out</font><font color="#E5E5E5"> two</font>

674
00:27:40,739 --> 00:27:45,359
<font color="#CCCCCC">years</font><font color="#E5E5E5"> ago so yeah what I'm trying to</font>

675
00:27:43,679 --> 00:27:55,409
<font color="#E5E5E5">tell you is</font><font color="#CCCCCC"> that this is like</font><font color="#E5E5E5"> systemic</font>

676
00:27:45,359 --> 00:27:57,119
<font color="#E5E5E5">these are avoidable and yes so I've</font>

677
00:27:55,409 --> 00:28:01,019
spoken a lot<font color="#CCCCCC"> about what I think Apple</font>

678
00:27:57,119 --> 00:28:03,269
are not doing what are they doing<font color="#CCCCCC"> so if</font>

679
00:28:01,019 --> 00:28:08,579
you<font color="#E5E5E5"> prefer</font><font color="#CCCCCC"> to try to engineer your way</font>

680
00:28:03,269 --> 00:28:10,169
out<font color="#CCCCCC"> of</font><font color="#E5E5E5"> things rather than investing in</font>

681
00:28:08,579 --> 00:28:12,389
proactive vulnerability research and

682
00:28:10,169 --> 00:28:14,249
develop a process changes then you've

683
00:28:12,389 --> 00:28:16,649
read mitigations<font color="#E5E5E5"> right and this is a</font>

684
00:28:14,249 --> 00:28:19,409
<font color="#E5E5E5">trend across the whole industry</font><font color="#CCCCCC"> Android</font>

685
00:28:16,649 --> 00:28:21,658
and iOS<font color="#E5E5E5"> are like especially invested in</font>

686
00:28:19,409 --> 00:28:23,219
<font color="#CCCCCC">this so you</font><font color="#E5E5E5"> can watch</font><font color="#CCCCCC"> dave krietor</font>

687
00:28:21,659 --> 00:28:26,489
<font color="#CCCCCC">maccas talk from the</font><font color="#E5E5E5"> Google cloud</font>

688
00:28:23,219 --> 00:28:28,259
conference a<font color="#CCCCCC"> few weeks ago</font><font color="#E5E5E5"> explicitly</font>

689
00:28:26,489 --> 00:28:29,699
saying this<font color="#E5E5E5"> they're Androids mitigations</font>

690
00:28:28,259 --> 00:28:31,619
<font color="#E5E5E5">are the things that make it more secure</font>

691
00:28:29,699 --> 00:28:34,019
<font color="#E5E5E5">and in my opinion this</font><font color="#CCCCCC"> is like</font>

692
00:28:31,619 --> 00:28:35,879
dangerously naive<font color="#E5E5E5"> but these people don't</font>

693
00:28:34,019 --> 00:28:38,569
come from<font color="#E5E5E5"> an exploitation background and</font>

694
00:28:35,879 --> 00:28:41,998
so it's hard<font color="#CCCCCC"> for</font><font color="#E5E5E5"> them to</font><font color="#CCCCCC"> weigh up</font><font color="#E5E5E5"> the</font>

695
00:28:38,569 --> 00:28:45,658
<font color="#CCCCCC">true impact or lack</font><font color="#E5E5E5"> thereof</font><font color="#CCCCCC"> in these</font>

696
00:28:41,999 --> 00:28:46,889
litigations<font color="#CCCCCC"> in fact I also I often get</font>

697
00:28:45,659 --> 00:28:48,779
<font color="#E5E5E5">the</font><font color="#CCCCCC"> feeling</font><font color="#E5E5E5"> that the people designing</font>

698
00:28:46,889 --> 00:28:50,270
<font color="#E5E5E5">and implementing these mitigations don't</font>

699
00:28:48,779 --> 00:28:52,970
<font color="#E5E5E5">necessarily have exploitation by</font>

700
00:28:50,270 --> 00:28:55,160
either<font color="#E5E5E5"> often it's more the case and</font>

701
00:28:52,970 --> 00:28:57,560
<font color="#E5E5E5">especially if it's</font><font color="#CCCCCC"> an iOS</font><font color="#E5E5E5"> of there was a</font>

702
00:28:55,160 --> 00:28:58,910
public proof-of-concept<font color="#E5E5E5"> exploit or an</font>

703
00:28:57,560 --> 00:29:00,500
exploit in a jailbreak<font color="#CCCCCC"> let's make a</font>

704
00:28:58,910 --> 00:29:03,920
small<font color="#CCCCCC"> change to how the heap allocated</font>

705
00:29:00,500 --> 00:29:09,680
works<font color="#E5E5E5"> and now the</font><font color="#CCCCCC"> POC doesn't work we're</font>

706
00:29:03,920 --> 00:29:10,910
<font color="#CCCCCC">done right</font><font color="#E5E5E5"> so how far</font><font color="#CCCCCC"> fake who works</font>

707
00:29:09,680 --> 00:29:13,730
with<font color="#E5E5E5"> us on</font><font color="#CCCCCC"> project there has been making</font>

708
00:29:10,910 --> 00:29:16,490
<font color="#E5E5E5">this</font><font color="#CCCCCC"> point</font><font color="#E5E5E5"> a bunch recently</font><font color="#CCCCCC"> you can go</font>

709
00:29:13,730 --> 00:29:17,750
watch his his talks about this<font color="#E5E5E5"> yes again</font>

710
00:29:16,490 --> 00:29:19,280
it's<font color="#CCCCCC"> like deliberately provocative I</font>

711
00:29:17,750 --> 00:29:21,110
don't<font color="#E5E5E5"> think we commit occasions at that</font>

712
00:29:19,280 --> 00:29:23,149
bad but<font color="#E5E5E5"> week mitigations can be</font>

713
00:29:21,110 --> 00:29:24,530
trivially defeated with more bugs<font color="#E5E5E5"> and if</font>

714
00:29:23,150 --> 00:29:27,850
you don't care about bugs<font color="#CCCCCC"> there's no</font>

715
00:29:24,530 --> 00:29:30,440
point in shipping these<font color="#E5E5E5"> week mitigations</font>

716
00:29:27,850 --> 00:29:32,480
<font color="#CCCCCC">so what is the canonical</font><font color="#E5E5E5"> week mitigation</font>

717
00:29:30,440 --> 00:29:35,210
that<font color="#E5E5E5"> everyone implements randomization</font>

718
00:29:32,480 --> 00:29:39,410
so<font color="#CCCCCC"> I mean you talk very very briefly</font>

719
00:29:35,210 --> 00:29:41,210
about randomization<font color="#CCCCCC"> go read all the</font>

720
00:29:39,410 --> 00:29:45,200
<font color="#E5E5E5">preset bonuses</font><font color="#CCCCCC"> talks</font><font color="#E5E5E5"> about iOS</font>

721
00:29:41,210 --> 00:29:47,810
exploitation and he covers like the

722
00:29:45,200 --> 00:29:49,700
whole history of iOS kernel<font color="#CCCCCC"> EEP</font>

723
00:29:47,810 --> 00:29:53,600
exploitation and how it's changed<font color="#E5E5E5"> over</font>

724
00:29:49,700 --> 00:29:57,260
the years<font color="#CCCCCC"> we'll</font><font color="#E5E5E5"> just look at like this</font>

725
00:29:53,600 --> 00:30:00,469
one tiny aspect<font color="#CCCCCC"> so this is the iOS</font>

726
00:29:57,260 --> 00:30:01,820
kernel heap it's one small part<font color="#E5E5E5"> I always</font>

727
00:30:00,470 --> 00:30:04,820
gonna<font color="#E5E5E5"> leave so</font><font color="#CCCCCC"> you have this thing</font>

728
00:30:01,820 --> 00:30:08,120
called<font color="#E5E5E5"> the zone map this is a</font><font color="#CCCCCC"> 384 mega</font>

729
00:30:04,820 --> 00:30:09,200
<font color="#CCCCCC">PI region or kernel versus your space</font>

730
00:30:08,120 --> 00:30:12,409
<font color="#E5E5E5">yes</font>

731
00:30:09,200 --> 00:30:15,530
regardless<font color="#E5E5E5"> of whether you pour $200 iPod</font>

732
00:30:12,410 --> 00:30:19,280
Touch or<font color="#E5E5E5"> 1000</font><font color="#CCCCCC"> wherever how much it costs</font>

733
00:30:15,530 --> 00:30:22,370
$1,800 iPhone X with<font color="#E5E5E5"> three gigs of RAM</font>

734
00:30:19,280 --> 00:30:25,310
<font color="#E5E5E5">you don't get a bigger kernel zone heap</font>

735
00:30:22,370 --> 00:30:28,429
<font color="#CCCCCC">sorry you only get three hundred</font><font color="#E5E5E5"> eighty</font>

736
00:30:25,310 --> 00:30:30,290
four megabytes<font color="#CCCCCC"> so this thing</font><font color="#E5E5E5"> is a pool</font>

737
00:30:28,430 --> 00:30:32,390
allocator and that's free<font color="#E5E5E5"> and really</font>

738
00:30:30,290 --> 00:30:38,030
four megabytes<font color="#CCCCCC"> gets split</font><font color="#E5E5E5"> up on demand</font>

739
00:30:32,390 --> 00:30:40,880
<font color="#E5E5E5">into smaller regions of like a few pages</font>

740
00:30:38,030 --> 00:30:42,620
<font color="#E5E5E5">and then the zone is like keeping</font><font color="#CCCCCC"> track</font>

741
00:30:40,880 --> 00:30:45,710
of individual allocations inside there

742
00:30:42,620 --> 00:30:48,409
and if the whole<font color="#E5E5E5"> region is free then</font>

743
00:30:45,710 --> 00:30:50,780
this smaller region is a candidate<font color="#E5E5E5"> for</font>

744
00:30:48,410 --> 00:30:55,130
<font color="#CCCCCC">getting given</font><font color="#E5E5E5"> back to the underlying</font>

745
00:30:50,780 --> 00:30:57,290
system if there's memory<font color="#E5E5E5"> pressure so we</font>

746
00:30:55,130 --> 00:31:00,230
saw the call to<font color="#CCCCCC"> Kalakh earlier so</font>

747
00:30:57,290 --> 00:31:01,879
<font color="#CCCCCC">cowlick</font><font color="#E5E5E5"> underneath is just has its own</font>

748
00:31:00,230 --> 00:31:05,660
bunch of zone

749
00:31:01,880 --> 00:31:07,190
<font color="#CCCCCC">four different</font><font color="#E5E5E5"> sizes</font><font color="#CCCCCC"> if your allocation</font>

750
00:31:05,660 --> 00:31:08,900
<font color="#E5E5E5">is bigger than a certain threshold</font><font color="#CCCCCC"> it</font>

751
00:31:07,190 --> 00:31:13,880
<font color="#CCCCCC">doesn't go to the</font><font color="#E5E5E5"> zone map it goes to</font>

752
00:31:08,900 --> 00:31:15,740
the kernel map so a recent mitigation

753
00:31:13,880 --> 00:31:20,240
<font color="#E5E5E5">not</font><font color="#CCCCCC"> too</font><font color="#E5E5E5"> sure when this is reduced maybe</font>

754
00:31:15,740 --> 00:31:22,220
<font color="#CCCCCC">sometime in I was 10 was to add some</font>

755
00:31:20,240 --> 00:31:24,260
randomness to<font color="#E5E5E5"> the initial state</font><font color="#CCCCCC"> of this</font>

756
00:31:22,220 --> 00:31:29,620
free list<font color="#E5E5E5"> so it used to be allocated</font>

757
00:31:24,260 --> 00:31:31,580
<font color="#E5E5E5">like this so this</font><font color="#CCCCCC"> is actually linear</font>

758
00:31:29,620 --> 00:31:33,590
<font color="#E5E5E5">actually this when I say used to be</font>

759
00:31:31,580 --> 00:31:35,240
allocated<font color="#E5E5E5"> like this this means that when</font>

760
00:31:33,590 --> 00:31:36,889
<font color="#E5E5E5">you actually make a calc and then the</font>

761
00:31:35,240 --> 00:31:38,810
next calc and<font color="#E5E5E5"> then the next catalog</font><font color="#CCCCCC"> it</font>

762
00:31:36,890 --> 00:31:40,930
comes backwards<font color="#CCCCCC"> so it's just II pushed</font>

763
00:31:38,810 --> 00:31:45,770
<font color="#CCCCCC">on</font><font color="#E5E5E5"> to the free list in the in the other</font>

764
00:31:40,930 --> 00:31:47,120
<font color="#E5E5E5">deal around</font><font color="#CCCCCC"> answer this recent</font>

765
00:31:45,770 --> 00:31:51,230
mitigation rather than making<font color="#E5E5E5"> occur like</font>

766
00:31:47,120 --> 00:31:54,739
<font color="#E5E5E5">that now it goes like this</font><font color="#CCCCCC"> so it</font>

767
00:31:51,230 --> 00:31:58,820
randomly goes from the inside to<font color="#CCCCCC"> the</font>

768
00:31:54,740 --> 00:32:00,910
<font color="#CCCCCC">outside so this</font><font color="#E5E5E5"> is the world's</font><font color="#CCCCCC"> most</font>

769
00:31:58,820 --> 00:32:03,889
useless bug<font color="#CCCCCC"> I only found this</font><font color="#E5E5E5"> because</font>

770
00:32:00,910 --> 00:32:06,500
there was a bug<font color="#CCCCCC"> in my heap room</font><font color="#E5E5E5"> and I</font>

771
00:32:03,890 --> 00:32:08,300
became convinced that<font color="#E5E5E5"> the</font><font color="#CCCCCC"> random number</font>

772
00:32:06,500 --> 00:32:10,190
generated they had must be like totally

773
00:32:08,300 --> 00:32:11,690
broken<font color="#E5E5E5"> because it didn't look random at</font>

774
00:32:10,190 --> 00:32:13,430
all<font color="#E5E5E5"> so I was like right let's look at</font>

775
00:32:11,690 --> 00:32:14,600
the random<font color="#E5E5E5"> number generator achieve this</font>

776
00:32:13,430 --> 00:32:16,310
<font color="#E5E5E5">random number generator is slightly</font>

777
00:32:14,600 --> 00:32:19,669
<font color="#CCCCCC">broken but it was</font><font color="#E5E5E5"> just a bug in my code</font>

778
00:32:16,310 --> 00:32:21,440
<font color="#CCCCCC">I think this has absolutely no security</font>

779
00:32:19,670 --> 00:32:23,240
impact<font color="#CCCCCC"> unless the people from</font><font color="#E5E5E5"> Apple tell</font>

780
00:32:21,440 --> 00:32:26,180
me that actually<font color="#E5E5E5"> they also use this</font><font color="#CCCCCC"> for</font>

781
00:32:23,240 --> 00:32:27,590
their like VPN<font color="#E5E5E5"> but probably not so</font>

782
00:32:26,180 --> 00:32:30,560
what's<font color="#CCCCCC"> this are you</font><font color="#E5E5E5"> trying to do but</font>

783
00:32:27,590 --> 00:32:32,389
<font color="#E5E5E5">this is just some trivia</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is taking</font>

784
00:32:30,560 --> 00:32:35,270
<font color="#CCCCCC">a natural random number generator</font><font color="#E5E5E5"> and</font>

785
00:32:32,390 --> 00:32:37,100
trying to generate<font color="#E5E5E5"> a random bit stream</font><font color="#CCCCCC"> I</font>

786
00:32:35,270 --> 00:32:38,270
think we probably do have<font color="#E5E5E5"> enough time to</font>

787
00:32:37,100 --> 00:32:40,820
just quickly<font color="#E5E5E5"> walk through this code</font>

788
00:32:38,270 --> 00:32:42,740
<font color="#E5E5E5">because it's kind of its kind of</font>

789
00:32:40,820 --> 00:32:45,350
interesting<font color="#E5E5E5"> and like I am no</font>

790
00:32:42,740 --> 00:32:47,720
cartographer but even I can spot that

791
00:32:45,350 --> 00:32:50,750
this thing is<font color="#E5E5E5"> kind</font><font color="#CCCCCC"> of biased</font><font color="#E5E5E5"> right so</font>

792
00:32:47,720 --> 00:32:53,690
what's the dirt as<font color="#CCCCCC"> we're comes in with</font>

793
00:32:50,750 --> 00:32:59,870
this buffer and count<font color="#E5E5E5"> so buffer points</font>

794
00:32:53,690 --> 00:33:03,050
to count number of<font color="#E5E5E5"> un petit a 32 by D</font>

795
00:32:59,870 --> 00:33:05,570
words right find a portion<font color="#E5E5E5"> of the buffer</font>

796
00:33:03,050 --> 00:33:07,100
<font color="#E5E5E5">that hasn't been emptied we might have</font>

797
00:33:05,570 --> 00:33:09,620
emptied our last index in the previous

798
00:33:07,100 --> 00:33:11,689
<font color="#CCCCCC">iteration so it's originally this index</font>

799
00:33:09,620 --> 00:33:14,570
value is<font color="#CCCCCC"> zero</font><font color="#E5E5E5"> and then it's walking</font>

800
00:33:11,690 --> 00:33:15,440
<font color="#E5E5E5">through each of the D words</font><font color="#CCCCCC"> try</font><font color="#E5E5E5"> to find</font>

801
00:33:14,570 --> 00:33:18,678
the<font color="#E5E5E5"> first one</font>

802
00:33:15,440 --> 00:33:21,500
which is nonzero<font color="#E5E5E5"> right</font><font color="#CCCCCC"> and if the</font><font color="#E5E5E5"> first</font>

803
00:33:18,679 --> 00:33:22,850
one that's<font color="#CCCCCC"> nonzero or if we didn't</font><font color="#E5E5E5"> find</font>

804
00:33:21,500 --> 00:33:28,009
<font color="#E5E5E5">one that was nonzero and we got to the</font>

805
00:33:22,850 --> 00:33:30,559
end then refill the buffer then collect

806
00:33:28,009 --> 00:33:32,360
a bit so what's that<font color="#E5E5E5"> doing you can</font>

807
00:33:30,559 --> 00:33:35,899
practice your bit twiddling<font color="#E5E5E5"> it's pulling</font>

808
00:33:32,360 --> 00:33:39,439
the least significant bit from the D

809
00:33:35,899 --> 00:33:41,750
<font color="#E5E5E5">word at offset index in buffer pulling</font>

810
00:33:39,440 --> 00:33:44,059
that<font color="#CCCCCC"> hour into bit its then shifting</font>

811
00:33:41,750 --> 00:33:46,220
that value in buffer down by one

812
00:33:44,059 --> 00:33:48,440
so it's shifting the bits<font color="#E5E5E5"> down and then</font>

813
00:33:46,220 --> 00:33:51,559
<font color="#CCCCCC">it's oaring that bit into</font><font color="#E5E5E5"> the result</font>

814
00:33:48,440 --> 00:33:53,809
bits<font color="#E5E5E5"> and it goes back</font><font color="#CCCCCC"> around again</font><font color="#E5E5E5"> and</font>

815
00:33:51,559 --> 00:33:58,269
this thing<font color="#E5E5E5"> is reentrant so in the sense</font>

816
00:33:53,809 --> 00:34:02,720
of<font color="#E5E5E5"> that same buffer will get used again</font>

817
00:33:58,269 --> 00:34:05,450
so what's wrong with<font color="#E5E5E5"> this if this was</font>

818
00:34:02,720 --> 00:34:08,000
<font color="#CCCCCC">actually</font><font color="#E5E5E5"> like cryptographic this like</font>

819
00:34:05,450 --> 00:34:10,010
weird way that<font color="#CCCCCC"> they are like checking if</font>

820
00:34:08,000 --> 00:34:12,409
the value<font color="#CCCCCC"> has totally been incomplete</font>

821
00:34:10,010 --> 00:34:15,109
<font color="#CCCCCC">the D</font><font color="#E5E5E5"> word has been consumed by seeing</font>

822
00:34:12,409 --> 00:34:18,740
if it's<font color="#CCCCCC"> equal to 0 so this misses out</font>

823
00:34:15,109 --> 00:34:20,569
leaving<font color="#CCCCCC"> 0 bits in those random D words</font>

824
00:34:18,739 --> 00:34:23,060
so<font color="#E5E5E5"> I'd see the bias you get from it is</font>

825
00:34:20,569 --> 00:34:23,960
like totally meaningless<font color="#CCCCCC"> for so sorry</font>

826
00:34:23,060 --> 00:34:27,259
for wasting your time it's<font color="#E5E5E5"> totally</font>

827
00:34:23,960 --> 00:34:30,829
meaningless for for heap randomization

828
00:34:27,260 --> 00:34:35,720
but<font color="#CCCCCC"> never less but the only</font><font color="#E5E5E5"> odor you get</font>

829
00:34:30,829 --> 00:34:37,819
in this talk sorry right but back<font color="#CCCCCC"> to you</font>

830
00:34:35,719 --> 00:34:40,339
think this ever so slightly biased<font color="#CCCCCC"> where</font>

831
00:34:37,819 --> 00:34:41,810
<font color="#CCCCCC">I'm</font><font color="#E5E5E5"> a generator for</font><font color="#CCCCCC"> kernel heap</font>

832
00:34:40,339 --> 00:34:43,549
allocation<font color="#E5E5E5"> like what effect does this</font>

833
00:34:41,810 --> 00:34:46,909
<font color="#CCCCCC">actually have so if you</font><font color="#E5E5E5"> look at it from</font>

834
00:34:43,550 --> 00:34:48,679
a exploiters perspective especially<font color="#E5E5E5"> from</font>

835
00:34:46,909 --> 00:34:50,750
an exploiters perspective who<font color="#E5E5E5"> knows that</font>

836
00:34:48,679 --> 00:34:53,960
bugs are dense<font color="#E5E5E5"> and</font><font color="#CCCCCC"> you have a choice of</font>

837
00:34:50,750 --> 00:34:57,020
bugs<font color="#E5E5E5"> well what's the</font><font color="#CCCCCC"> first observation</font>

838
00:34:53,960 --> 00:34:58,520
<font color="#E5E5E5">there's still a pattern right</font>

839
00:34:57,020 --> 00:34:59,960
the pattern<font color="#E5E5E5"> is no longer linear but</font>

840
00:34:58,520 --> 00:35:01,130
there is a problem still there and

841
00:34:59,960 --> 00:35:04,069
there's still<font color="#E5E5E5"> stuff we can do</font><font color="#CCCCCC"> with that</font>

842
00:35:01,130 --> 00:35:06,650
<font color="#E5E5E5">pattern</font><font color="#CCCCCC"> so one example of an operation</font>

843
00:35:04,069 --> 00:35:09,859
that<font color="#E5E5E5"> I've used with precisely this</font>

844
00:35:06,650 --> 00:35:12,170
pattern in the empty list<font color="#CCCCCC"> exploit you</font>

845
00:35:09,859 --> 00:35:14,509
can go read a<font color="#E5E5E5"> write-up</font><font color="#CCCCCC"> with this is to</font>

846
00:35:12,170 --> 00:35:16,130
reverse the<font color="#CCCCCC"> order</font><font color="#E5E5E5"> of this free list</font><font color="#CCCCCC"> so</font>

847
00:35:14,510 --> 00:35:19,099
rather<font color="#E5E5E5"> than your allocations going from</font>

848
00:35:16,130 --> 00:35:22,369
the inside<font color="#E5E5E5"> out</font><font color="#CCCCCC"> there from</font><font color="#E5E5E5"> outside in and</font>

849
00:35:19,099 --> 00:35:25,550
this<font color="#E5E5E5"> has some properties</font><font color="#CCCCCC"> in the case of</font>

850
00:35:22,369 --> 00:35:27,260
the empty<font color="#E5E5E5"> list exploit were useful this</font>

851
00:35:25,550 --> 00:35:28,820
doesn't<font color="#CCCCCC"> require like a new bug right</font>

852
00:35:27,260 --> 00:35:30,320
this<font color="#CCCCCC"> just means finding</font>

853
00:35:28,820 --> 00:35:31,730
<font color="#E5E5E5">right primitive and this case is very</font>

854
00:35:30,320 --> 00:35:33,590
easy right you just<font color="#E5E5E5"> allocate a bunch of</font>

855
00:35:31,730 --> 00:35:34,850
<font color="#E5E5E5">objects and</font><font color="#CCCCCC"> then find them and then free</font>

856
00:35:33,590 --> 00:35:39,200
them in the same<font color="#E5E5E5"> order</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> this is</font>

857
00:35:34,850 --> 00:35:42,200
what's the free list<font color="#E5E5E5"> around the second</font>

858
00:35:39,200 --> 00:35:45,140
observation<font color="#E5E5E5"> here larger</font><font color="#CCCCCC"> objects are less</font>

859
00:35:42,200 --> 00:35:46,730
randomized so the randomization only

860
00:35:45,140 --> 00:35:49,400
applies to<font color="#CCCCCC"> this initial free list</font>

861
00:35:46,730 --> 00:35:52,580
population and generally like<font color="#CCCCCC"> the bigger</font>

862
00:35:49,400 --> 00:35:55,850
your object<font color="#E5E5E5"> the shorter the initial free</font>

863
00:35:52,580 --> 00:35:58,009
list is and yes at the limit the initial

864
00:35:55,850 --> 00:35:59,480
free list is of size<font color="#CCCCCC"> 1</font><font color="#E5E5E5"> so it's still</font>

865
00:35:58,010 --> 00:36:01,430
cool<font color="#E5E5E5"> the random number generator but it</font>

866
00:35:59,480 --> 00:36:06,680
generates a single<font color="#E5E5E5"> random value of it</font>

867
00:36:01,430 --> 00:36:08,839
<font color="#CCCCCC">yeah</font><font color="#E5E5E5"> so I exploited both of these things</font>

868
00:36:06,680 --> 00:36:10,430
so I exploited<font color="#E5E5E5"> this part</font><font color="#CCCCCC"> one that they</font>

869
00:36:08,840 --> 00:36:13,520
were still apparent in<font color="#E5E5E5"> empty</font><font color="#CCCCCC"> lists</font><font color="#E5E5E5"> and</font>

870
00:36:10,430 --> 00:36:17,779
in extra recipe which<font color="#CCCCCC"> is my exploit for</font>

871
00:36:13,520 --> 00:36:21,200
that first chunk of code that<font color="#E5E5E5"> I</font><font color="#CCCCCC"> showed</font>

872
00:36:17,780 --> 00:36:23,690
you<font color="#CCCCCC"> I used this property if energy I was</font>

873
00:36:21,200 --> 00:36:25,430
<font color="#E5E5E5">able to control the size of the object</font>

874
00:36:23,690 --> 00:36:26,540
<font color="#CCCCCC">that was overflowing out of which means</font>

875
00:36:25,430 --> 00:36:30,520
<font color="#E5E5E5">I could just choose the size that</font>

876
00:36:26,540 --> 00:36:30,520
<font color="#E5E5E5">doesn't have this randomization property</font>

877
00:36:31,630 --> 00:36:37,310
<font color="#CCCCCC">that thing</font><font color="#E5E5E5"> can we just sort the free</font>

878
00:36:34,520 --> 00:36:38,930
list<font color="#E5E5E5"> right again this doesn't</font>

879
00:36:37,310 --> 00:36:40,910
<font color="#CCCCCC">necessarily need</font><font color="#E5E5E5"> a bug right you've just</font>

880
00:36:38,930 --> 00:36:45,799
got<font color="#CCCCCC"> to find some optimized kernel data</font>

881
00:36:40,910 --> 00:36:47,540
structure<font color="#E5E5E5"> like a hash table</font><font color="#CCCCCC"> that has</font>

882
00:36:45,800 --> 00:36:51,800
some primitive that it's gonna like sort

883
00:36:47,540 --> 00:36:52,970
on<font color="#CCCCCC"> the addresses of objects</font><font color="#E5E5E5"> I don't have</font>

884
00:36:51,800 --> 00:36:55,220
an<font color="#E5E5E5"> example of</font><font color="#CCCCCC"> this to</font><font color="#E5E5E5"> show you but just</font>

885
00:36:52,970 --> 00:36:59,209
just to like emphasize the point that

886
00:36:55,220 --> 00:37:01,189
<font color="#E5E5E5">it's</font><font color="#CCCCCC"> not so simple to</font><font color="#E5E5E5"> actually guarantee</font>

887
00:36:59,210 --> 00:37:07,010
<font color="#CCCCCC">that these mitigations have any</font><font color="#E5E5E5"> impact</font>

888
00:37:01,190 --> 00:37:09,320
at<font color="#E5E5E5"> all so yeah some more per</font><font color="#CCCCCC"> octave</font>

889
00:37:07,010 --> 00:37:13,310
<font color="#E5E5E5">statements please stop just stop fixing</font>

890
00:37:09,320 --> 00:37:16,490
bugs<font color="#E5E5E5"> learn from them and act on that so</font>

891
00:37:13,310 --> 00:37:18,740
this current fashion which we see all

892
00:37:16,490 --> 00:37:21,830
over<font color="#E5E5E5"> the</font><font color="#CCCCCC"> place</font><font color="#E5E5E5"> the mitigations will save</font>

893
00:37:18,740 --> 00:37:24,919
us mitigations will not save strong

894
00:37:21,830 --> 00:37:26,840
mitigations<font color="#E5E5E5"> which is like making real</font>

895
00:37:24,920 --> 00:37:29,300
<font color="#E5E5E5">meaningful reductions in reachable</font>

896
00:37:26,840 --> 00:37:32,030
attack surface<font color="#E5E5E5"> or relevant in</font>

897
00:37:29,300 --> 00:37:37,340
combination with caring about bugs right

898
00:37:32,030 --> 00:37:39,800
<font color="#E5E5E5">each bug needs to be a lesson if this is</font>

899
00:37:37,340 --> 00:37:41,480
<font color="#CCCCCC">truly</font><font color="#E5E5E5"> a secure</font><font color="#CCCCCC"> code base do</font><font color="#E5E5E5"> you need for</font>

900
00:37:39,800 --> 00:37:44,150
<font color="#CCCCCC">each issue to be like why</font>

901
00:37:41,480 --> 00:37:45,710
<font color="#E5E5E5">this here how is it introduced how could</font>

902
00:37:44,150 --> 00:37:47,180
we have caught this earlier which

903
00:37:45,710 --> 00:37:48,710
process problems do we<font color="#E5E5E5"> need to address</font>

904
00:37:47,180 --> 00:37:50,750
as Donna said<font color="#CCCCCC"> that</font><font color="#E5E5E5"> we could have caught</font>

905
00:37:48,710 --> 00:37:52,640
this earlier<font color="#E5E5E5"> who should have had access</font>

906
00:37:50,750 --> 00:37:54,290
<font color="#E5E5E5">to this code to review it but for</font>

907
00:37:52,640 --> 00:37:56,600
<font color="#CCCCCC">whatever internal</font><font color="#E5E5E5"> or political</font><font color="#CCCCCC"> reasons</font>

908
00:37:54,290 --> 00:37:58,190
<font color="#CCCCCC">didn't have</font><font color="#E5E5E5"> that access how do we find</font>

909
00:37:56,600 --> 00:38:00,319
every instance of<font color="#E5E5E5"> this bug and</font><font color="#CCCCCC"> fix</font><font color="#E5E5E5"> it</font>

910
00:37:58,190 --> 00:38:03,770
<font color="#E5E5E5">how do we</font><font color="#CCCCCC"> genuinely kill this class of</font>

911
00:38:00,320 --> 00:38:06,590
bugs so the attitude<font color="#E5E5E5"> that I would love</font>

912
00:38:03,770 --> 00:38:07,790
<font color="#CCCCCC">people</font><font color="#E5E5E5"> to view these bugs through or the</font>

913
00:38:06,590 --> 00:38:10,760
lens I would like them to<font color="#CCCCCC"> view these</font>

914
00:38:07,790 --> 00:38:13,310
bugs<font color="#E5E5E5"> is someone has already found this</font>

915
00:38:10,760 --> 00:38:15,680
issue and<font color="#E5E5E5"> like I can't talk on the stage</font>

916
00:38:13,310 --> 00:38:17,570
<font color="#CCCCCC">at blackhat about things like suspected</font>

917
00:38:15,680 --> 00:38:20,000
bug collisions<font color="#E5E5E5"> and who I think they</font>

918
00:38:17,570 --> 00:38:23,090
collided with but I think these<font color="#E5E5E5"> issues</font>

919
00:38:20,000 --> 00:38:24,470
<font color="#CCCCCC">collide with people I'm very certain</font><font color="#E5E5E5"> a</font>

920
00:38:23,090 --> 00:38:27,470
large proportion<font color="#CCCCCC"> of the issues which</font>

921
00:38:24,470 --> 00:38:29,689
<font color="#CCCCCC">I've reported in iOS</font><font color="#E5E5E5"> have at some point</font>

922
00:38:27,470 --> 00:38:31,970
<font color="#E5E5E5">been actively exploited in fact the</font>

923
00:38:29,690 --> 00:38:33,800
thing that worries<font color="#CCCCCC"> me more and over</font>

924
00:38:31,970 --> 00:38:35,750
which I<font color="#E5E5E5"> have</font><font color="#CCCCCC"> even</font><font color="#E5E5E5"> less control is the</font>

925
00:38:33,800 --> 00:38:37,609
trivial variants<font color="#E5E5E5"> of the things that I</font>

926
00:38:35,750 --> 00:38:42,530
have found<font color="#E5E5E5"> and reported are still being</font>

927
00:38:37,609 --> 00:38:45,770
exploited in<font color="#CCCCCC"> the</font><font color="#E5E5E5"> world and that's why I</font>

928
00:38:42,530 --> 00:38:52,070
want<font color="#CCCCCC"> to do this Apple</font><font color="#E5E5E5"> one more thing</font>

929
00:38:45,770 --> 00:38:54,350
<font color="#E5E5E5">thing so the reason I decided</font><font color="#CCCCCC"> to give</font>

930
00:38:52,070 --> 00:38:57,109
this talk is that

931
00:38:54,350 --> 00:38:59,150
I think I'm failing in my<font color="#CCCCCC"> goal to do you</font>

932
00:38:57,109 --> 00:39:02,180
know my small<font color="#E5E5E5"> part to move the world</font>

933
00:38:59,150 --> 00:39:05,119
towards<font color="#E5E5E5"> this vision of trustworthy</font>

934
00:39:02,180 --> 00:39:07,910
<font color="#E5E5E5">computing it's way too easy for vendors</font>

935
00:39:05,119 --> 00:39:11,270
like Google and Samsung and Apple<font color="#E5E5E5"> to</font>

936
00:39:07,910 --> 00:39:12,259
ignore exploitation one of the problems

937
00:39:11,270 --> 00:39:13,910
here<font color="#CCCCCC"> is that they like</font><font color="#E5E5E5"> to tout</font>

938
00:39:12,260 --> 00:39:16,040
themselves as being<font color="#E5E5E5"> data-driven right</font>

939
00:39:13,910 --> 00:39:18,710
making<font color="#E5E5E5"> decisions on evidence</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> big</font>

940
00:39:16,040 --> 00:39:21,290
data and this doesn't<font color="#E5E5E5"> work</font><font color="#CCCCCC"> for this</font><font color="#E5E5E5"> kind</font>

941
00:39:18,710 --> 00:39:23,180
<font color="#CCCCCC">of</font><font color="#E5E5E5"> security you know by definition good</font>

942
00:39:21,290 --> 00:39:27,050
attackers don't get caught you<font color="#CCCCCC"> didn't</font>

943
00:39:23,180 --> 00:39:28,490
<font color="#E5E5E5">collect your big data and I hope that I</font>

944
00:39:27,050 --> 00:39:30,740
have<font color="#E5E5E5"> kind of</font><font color="#CCCCCC"> raised</font><font color="#E5E5E5"> to convince you that</font>

945
00:39:28,490 --> 00:39:33,560
may<font color="#E5E5E5"> be targeted exploitation is actually</font>

946
00:39:30,740 --> 00:39:35,750
kind<font color="#E5E5E5"> of widespread and more importantly</font>

947
00:39:33,560 --> 00:39:38,450
<font color="#CCCCCC">it's too easily abused the key causes</font>

948
00:39:35,750 --> 00:39:41,030
<font color="#E5E5E5">which you probably don't</font><font color="#CCCCCC"> believe in like</font>

949
00:39:38,450 --> 00:39:42,980
stopping people thinking this you know

950
00:39:41,030 --> 00:39:45,800
it has a societal impact<font color="#E5E5E5"> and the</font>

951
00:39:42,980 --> 00:39:48,020
societal<font color="#CCCCCC"> impact is much wider than</font><font color="#E5E5E5"> the</font>

952
00:39:45,800 --> 00:39:51,710
<font color="#E5E5E5">single user who</font><font color="#CCCCCC"> is targeted by each</font>

953
00:39:48,020 --> 00:39:53,359
attack and I hope I've also kind<font color="#E5E5E5"> of</font>

954
00:39:51,710 --> 00:39:55,069
managed to convince you that the bar for

955
00:39:53,359 --> 00:39:56,808
iOS exploitation

956
00:39:55,069 --> 00:39:58,130
is kind<font color="#CCCCCC"> of lower than you probably think</font>

957
00:39:56,809 --> 00:40:00,589
<font color="#CCCCCC">you know there is no comfort blanket</font>

958
00:39:58,130 --> 00:40:02,180
that<font color="#CCCCCC"> you can wrap yourself</font><font color="#E5E5E5"> in to think</font>

959
00:40:00,589 --> 00:40:04,069
that just<font color="#E5E5E5"> because you're campaigning for</font>

960
00:40:02,180 --> 00:40:08,269
<font color="#CCCCCC">human</font><font color="#E5E5E5"> rights or gains childhood obesity</font>

961
00:40:04,069 --> 00:40:10,369
<font color="#CCCCCC">did you all not a target</font><font color="#E5E5E5"> yeah I've had</font>

962
00:40:08,269 --> 00:40:11,629
to leave<font color="#E5E5E5"> out a bunch of anecdotes which</font>

963
00:40:10,369 --> 00:40:14,539
would make these<font color="#E5E5E5"> points more clearly</font>

964
00:40:11,630 --> 00:40:17,809
<font color="#CCCCCC">because I am</font><font color="#E5E5E5"> for some of the anecdotes</font>

965
00:40:14,539 --> 00:40:19,969
<font color="#E5E5E5">like afraid of being targeted</font><font color="#CCCCCC"> and not by</font>

966
00:40:17,809 --> 00:40:21,859
governments but<font color="#CCCCCC"> by private</font><font color="#E5E5E5"> individuals</font>

967
00:40:19,969 --> 00:40:27,650
who also<font color="#CCCCCC"> were part of this</font><font color="#E5E5E5"> you're like I</font>

968
00:40:21,859 --> 00:40:30,019
rely on this device<font color="#CCCCCC"> oh yeah</font><font color="#E5E5E5"> nothing</font>

969
00:40:27,650 --> 00:40:32,180
<font color="#CCCCCC">really changes like Percy said in her</font>

970
00:40:30,019 --> 00:40:34,758
keynote this morning it's all spot fixes

971
00:40:32,180 --> 00:40:36,169
and not raising<font color="#CCCCCC"> the bar and without</font><font color="#E5E5E5"> this</font>

972
00:40:34,759 --> 00:40:39,619
<font color="#E5E5E5">kind of organizational change from the</font>

973
00:40:36,170 --> 00:40:41,989
top declaring that<font color="#CCCCCC"> all of these vendors</font>

974
00:40:39,619 --> 00:40:43,430
<font color="#E5E5E5">Apple included have a security</font><font color="#CCCCCC"> problem</font>

975
00:40:41,989 --> 00:40:48,349
<font color="#E5E5E5">nothing is going to get better</font>

976
00:40:43,430 --> 00:40:49,698
so<font color="#E5E5E5"> I've</font><font color="#CCCCCC"> reported over</font><font color="#E5E5E5"> 150 bugs similar</font>

977
00:40:48,349 --> 00:40:51,769
<font color="#CCCCCC">stat those</font><font color="#E5E5E5"> handfuls that I've shown you</font>

978
00:40:49,699 --> 00:40:54,380
<font color="#E5E5E5">today all with detailed technical</font>

979
00:40:51,769 --> 00:40:56,660
write-ups<font color="#CCCCCC"> and I'm still not seeing</font><font color="#E5E5E5"> any</font>

980
00:40:54,380 --> 00:40:59,479
<font color="#E5E5E5">momentum within</font><font color="#CCCCCC"> Apple but genuine</font>

981
00:40:56,660 --> 00:41:01,160
process change from the top so<font color="#E5E5E5"> let's end</font>

982
00:40:59,479 --> 00:41:04,069
with one more<font color="#CCCCCC"> example of why the stuff</font>

983
00:41:01,160 --> 00:41:06,049
still matters so this is a<font color="#E5E5E5"> report</font><font color="#CCCCCC"> from</font>

984
00:41:04,069 --> 00:41:08,359
last<font color="#E5E5E5"> week from Amnesty International</font>

985
00:41:06,049 --> 00:41:11,839
<font color="#E5E5E5">this global human</font><font color="#CCCCCC"> rights organization</font>

986
00:41:08,359 --> 00:41:14,119
<font color="#E5E5E5">and their employees in Saudi Arabia were</font>

987
00:41:11,839 --> 00:41:16,759
targeted<font color="#CCCCCC"> are</font><font color="#E5E5E5"> suspected of being targeted</font>

988
00:41:14,119 --> 00:41:18,949
by a user of one of these<font color="#E5E5E5"> Pegasus</font>

989
00:41:16,759 --> 00:41:22,849
installations and if you read this

990
00:41:18,949 --> 00:41:25,160
article<font color="#CCCCCC"> more closely</font><font color="#E5E5E5"> and you look at the</font>

991
00:41:22,849 --> 00:41:27,469
screenshots<font color="#CCCCCC"> well you'll</font><font color="#E5E5E5"> notice that</font>

992
00:41:25,160 --> 00:41:29,239
those<font color="#E5E5E5"> screenshots are from the iOS</font>

993
00:41:27,469 --> 00:41:32,599
messaging app right<font color="#CCCCCC"> they're using</font>

994
00:41:29,239 --> 00:41:35,449
iPhones this stuff is real<font color="#E5E5E5"> right this is</font>

995
00:41:32,599 --> 00:41:39,199
happening and it's way too<font color="#E5E5E5"> easy</font><font color="#CCCCCC"> to</font>

996
00:41:35,449 --> 00:41:41,299
ignore so yes we<font color="#CCCCCC"> have made some</font>

997
00:41:39,199 --> 00:41:43,910
<font color="#CCCCCC">paragraphs like parisa said so maybe now</font>

998
00:41:41,299 --> 00:41:46,339
Apple<font color="#E5E5E5"> don't take over</font><font color="#CCCCCC"> a year to fix most</font>

999
00:41:43,910 --> 00:41:48,519
externally reported bugs<font color="#E5E5E5"> but I want more</font>

1000
00:41:46,339 --> 00:41:48,519
than<font color="#E5E5E5"> that</font>

1001
00:41:48,999 --> 00:41:55,129
<font color="#E5E5E5">yep</font><font color="#CCCCCC"> so I want to</font><font color="#E5E5E5"> see real organizational</font>

1002
00:41:52,369 --> 00:41:57,499
and process changes<font color="#E5E5E5"> not just</font><font color="#CCCCCC"> for fixes</font>

1003
00:41:55,130 --> 00:41:58,969
anymore<font color="#CCCCCC"> and</font><font color="#E5E5E5"> just sending these hundreds</font>

1004
00:41:57,499 --> 00:42:01,549
of highly technical write-ups<font color="#E5E5E5"> and bugs</font>

1005
00:41:58,969 --> 00:42:02,739
has not<font color="#CCCCCC"> achieved that so I</font><font color="#E5E5E5"> am gonna try</font>

1006
00:42:01,549 --> 00:42:05,569
<font color="#E5E5E5">something else</font>

1007
00:42:02,739 --> 00:42:07,279
so two years<font color="#CCCCCC"> ago on this stage Apple</font>

1008
00:42:05,569 --> 00:42:08,190
announced<font color="#E5E5E5"> that they were starting</font><font color="#CCCCCC"> a bug</font>

1009
00:42:07,279 --> 00:42:09,660
bounty

1010
00:42:08,190 --> 00:42:13,260
and<font color="#E5E5E5"> here's some quotes</font><font color="#CCCCCC"> from Yvonne's</font>

1011
00:42:09,660 --> 00:42:15,810
talk it's<font color="#E5E5E5"> not meant to be any kind of</font>

1012
00:42:13,260 --> 00:42:17,609
<font color="#E5E5E5">exclusive club so if anyone who is not</font>

1013
00:42:15,810 --> 00:42:19,078
<font color="#CCCCCC">in the</font><font color="#E5E5E5"> program brings to us a</font>

1014
00:42:17,609 --> 00:42:21,450
vulnerability<font color="#E5E5E5"> that would be covered</font>

1015
00:42:19,079 --> 00:42:22,800
under<font color="#CCCCCC"> the program we</font><font color="#E5E5E5"> welcome that</font><font color="#CCCCCC"> we're</font>

1016
00:42:21,450 --> 00:42:25,319
going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> take</font><font color="#CCCCCC"> a look and</font><font color="#E5E5E5"> if the work</font>

1017
00:42:22,800 --> 00:42:26,609
<font color="#E5E5E5">merits it we'll invite them into</font><font color="#CCCCCC"> the</font>

1018
00:42:25,319 --> 00:42:29,759
<font color="#CCCCCC">program and real reward the</font>

1019
00:42:26,609 --> 00:42:31,109
vulnerability<font color="#E5E5E5"> that they found so</font><font color="#CCCCCC"> I don't</font>

1020
00:42:29,760 --> 00:42:33,690
think<font color="#E5E5E5"> that Apple ever intended this bug</font>

1021
00:42:31,109 --> 00:42:34,740
bounty program to be a PR tool<font color="#CCCCCC"> I mean</font>

1022
00:42:33,690 --> 00:42:37,140
obviously it's<font color="#CCCCCC"> given them</font><font color="#E5E5E5"> lots of good</font>

1023
00:42:34,740 --> 00:42:39,740
PR it's again got like these<font color="#E5E5E5"> numbers out</font>

1024
00:42:37,140 --> 00:42:42,210
<font color="#E5E5E5">that people uses these comfort blankets</font>

1025
00:42:39,740 --> 00:42:43,740
but I think that Apple<font color="#E5E5E5"> to do on some</font>

1026
00:42:42,210 --> 00:42:50,910
level genuinely care<font color="#CCCCCC"> about getting more</font>

1027
00:42:43,740 --> 00:42:52,140
security<font color="#E5E5E5"> bugs so there was one</font><font color="#CCCCCC"> other</font>

1028
00:42:50,910 --> 00:42:53,970
<font color="#CCCCCC">thing they said so in addition</font><font color="#E5E5E5"> to these</font>

1029
00:42:52,140 --> 00:42:55,650
exact amounts<font color="#E5E5E5"> we've all that researchers</font>

1030
00:42:53,970 --> 00:42:57,839
<font color="#E5E5E5">do need the reward to a charity of their</font>

1031
00:42:55,650 --> 00:42:59,550
choosing<font color="#CCCCCC"> we will</font><font color="#E5E5E5"> add our option match</font>

1032
00:42:57,839 --> 00:43:02,339
that one to one<font color="#E5E5E5"> doubling the donation</font>

1033
00:42:59,550 --> 00:43:05,010
and so it might<font color="#E5E5E5"> surprise you</font><font color="#CCCCCC"> to learn</font>

1034
00:43:02,339 --> 00:43:06,450
that I<font color="#E5E5E5"> and particular have never been</font>

1035
00:43:05,010 --> 00:43:08,430
invited<font color="#E5E5E5"> to</font><font color="#CCCCCC"> be part</font><font color="#E5E5E5"> of this even though</font>

1036
00:43:06,450 --> 00:43:12,540
<font color="#E5E5E5">we would absolutely love</font><font color="#CCCCCC"> for Apple to</font>

1037
00:43:08,430 --> 00:43:15,029
donate the bounties<font color="#CCCCCC"> that we find to</font>

1038
00:43:12,540 --> 00:43:17,970
charity<font color="#CCCCCC"> and so that is why I am asking</font>

1039
00:43:15,030 --> 00:43:19,570
<font color="#E5E5E5">Apple to do today so here's 30 bugs I</font>

1040
00:43:17,970 --> 00:43:25,450
found and<font color="#CCCCCC"> reported to Apple</font>

1041
00:43:19,570 --> 00:43:27,400
[Applause]

1042
00:43:25,450 --> 00:43:29,200
so I think every<font color="#E5E5E5"> one of these met the</font>

1043
00:43:27,400 --> 00:43:31,630
<font color="#E5E5E5">bar they all have detailed technical</font>

1044
00:43:29,200 --> 00:43:33,640
write-ups<font color="#CCCCCC"> repr cases an H</font><font color="#E5E5E5"> defeat a</font>

1045
00:43:31,630 --> 00:43:35,319
critical part of the iOS security model

1046
00:43:33,640 --> 00:43:37,270
<font color="#E5E5E5">so yet if you added up with the</font>

1047
00:43:35,319 --> 00:43:39,730
<font color="#E5E5E5">corporate donation matching</font><font color="#CCCCCC"> it's two</font>

1048
00:43:37,270 --> 00:43:42,430
point four five million dollars and so

1049
00:43:39,730 --> 00:43:43,630
yeah<font color="#E5E5E5"> Apple today I'm asking you to</font>

1050
00:43:42,430 --> 00:43:47,290
follow<font color="#E5E5E5"> through on that bug bounty</font><font color="#CCCCCC"> ago</font>

1051
00:43:43,630 --> 00:43:48,640
<font color="#CCCCCC">two years ago and I have one thing to</font>

1052
00:43:47,290 --> 00:43:51,819
say<font color="#E5E5E5"> directly</font><font color="#CCCCCC"> to Tim Cook where's the</font>

1053
00:43:48,640 --> 00:43:53,410
camera there so yeah I<font color="#CCCCCC"> really worried</font>

1054
00:43:51,819 --> 00:43:55,058
that<font color="#CCCCCC"> people</font><font color="#E5E5E5"> are getting hacked using</font>

1055
00:43:53,410 --> 00:43:59,859
<font color="#CCCCCC">Barents with the bugs</font><font color="#E5E5E5"> that I report and</font>

1056
00:43:55,059 --> 00:44:02,109
you do a poor job of fixing so some of

1057
00:43:59,859 --> 00:44:03,190
<font color="#E5E5E5">these</font><font color="#CCCCCC"> issues</font><font color="#E5E5E5"> are highlighted in</font><font color="#CCCCCC"> fact</font>

1058
00:44:02,109 --> 00:44:05,109
anything ones that aren't fixed<font color="#E5E5E5"> yeah</font>

1059
00:44:03,190 --> 00:44:07,660
<font color="#E5E5E5">please go look those up in your bug</font>

1060
00:44:05,109 --> 00:44:09,609
tracker<font color="#CCCCCC"> and find out why they happened</font>

1061
00:44:07,660 --> 00:44:11,140
<font color="#E5E5E5">why they won't call earlier on what</font>

1062
00:44:09,609 --> 00:44:13,660
processes<font color="#E5E5E5"> need to change to prevent them</font>

1063
00:44:11,140 --> 00:44:15,098
happening again and<font color="#E5E5E5"> I'm very happy to</font>

1064
00:44:13,660 --> 00:44:17,500
sit<font color="#CCCCCC"> down with you</font><font color="#E5E5E5"> with my laptop</font><font color="#CCCCCC"> and</font>

1065
00:44:15,099 --> 00:44:19,809
<font color="#CCCCCC">walk through these issues and together</font>

1066
00:44:17,500 --> 00:44:23,530
we can make<font color="#CCCCCC"> things</font><font color="#E5E5E5"> better</font><font color="#CCCCCC"> so just to</font>

1067
00:44:19,809 --> 00:44:25,930
<font color="#E5E5E5">make sure Tim finds</font><font color="#CCCCCC"> this out so I don't</font>

1068
00:44:23,530 --> 00:44:33,700
<font color="#CCCCCC">have to in Kurt's email</font><font color="#E5E5E5"> but what I do</font>

1069
00:44:25,930 --> 00:44:37,299
<font color="#E5E5E5">have is that's very</font><font color="#CCCCCC"> small that's wrong</font>

1070
00:44:33,700 --> 00:44:38,799
<font color="#E5E5E5">what I'll know in the trash well I do</font>

1071
00:44:37,299 --> 00:44:42,280
have an explicable number of Twitter

1072
00:44:38,799 --> 00:44:45,030
followers<font color="#E5E5E5"> so I'm just</font><font color="#CCCCCC"> going to tweet to</font>

1073
00:44:42,280 --> 00:44:48,339
<font color="#E5E5E5">Tim now just so he sees this</font>

1074
00:44:45,030 --> 00:44:50,559
there we go and<font color="#E5E5E5"> see all the interesting</font>

1075
00:44:48,339 --> 00:44:52,370
<font color="#CCCCCC">things are my Twitter feed so yeah</font><font color="#E5E5E5"> thank</font>

1076
00:44:50,559 --> 00:44:56,270
<font color="#E5E5E5">you</font><font color="#CCCCCC"> for listening</font><font color="#E5E5E5"> and</font>

1077
00:44:52,370 --> 00:44:56,270
[Applause]

