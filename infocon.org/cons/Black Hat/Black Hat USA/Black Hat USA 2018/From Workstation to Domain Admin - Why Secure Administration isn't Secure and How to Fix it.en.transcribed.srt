1
00:00:00,000 --> 00:00:03,780
hello thank you very much<font color="#CCCCCC"> I'm actually</font>

2
00:00:02,399 --> 00:00:06,540
<font color="#CCCCCC">going to</font><font color="#E5E5E5"> be</font><font color="#CCCCCC"> doing this talk</font><font color="#E5E5E5"> with my</font>

3
00:00:03,780 --> 00:00:08,160
friend<font color="#E5E5E5"> bunny my daughter asked me to</font>

4
00:00:06,540 --> 00:00:11,370
bring bunny with me so can everyone<font color="#CCCCCC"> just</font>

5
00:00:08,160 --> 00:00:13,290
say hi bunny thank you<font color="#CCCCCC"> very much</font>

6
00:00:11,370 --> 00:00:15,360
so I'm<font color="#CCCCCC"> Shawn Metcalfe this is from</font>

7
00:00:13,290 --> 00:00:16,919
<font color="#CCCCCC">workstation the domain admin</font><font color="#E5E5E5"> why secure</font>

8
00:00:15,360 --> 00:00:19,890
administration isn't<font color="#CCCCCC"> secure and how to</font>

9
00:00:16,920 --> 00:00:21,330
fix it<font color="#CCCCCC"> so I'm</font><font color="#E5E5E5"> Shawn I'm the founder of</font>

10
00:00:19,890 --> 00:00:22,800
<font color="#E5E5E5">Trimark a company that helps</font>

11
00:00:21,330 --> 00:00:24,000
<font color="#E5E5E5">organizations better secure their</font>

12
00:00:22,800 --> 00:00:25,890
<font color="#E5E5E5">Microsoft environment including the</font>

13
00:00:24,000 --> 00:00:27,330
Microsoft<font color="#E5E5E5"> cloud I'm a Microsoft</font>

14
00:00:25,890 --> 00:00:28,380
Certified Master<font color="#E5E5E5"> Mac</font><font color="#CCCCCC"> to directory</font>

15
00:00:27,330 --> 00:00:30,509
there's about a hundred<font color="#CCCCCC"> in the world</font>

16
00:00:28,380 --> 00:00:33,030
<font color="#E5E5E5">most of whom work for</font><font color="#CCCCCC"> Microsoft</font>

17
00:00:30,510 --> 00:00:35,010
<font color="#CCCCCC">I do not</font><font color="#E5E5E5"> I've spoken before at blackhat</font>

18
00:00:33,030 --> 00:00:37,739
<font color="#E5E5E5">I'm very excited to be here so</font><font color="#CCCCCC"> thank</font><font color="#E5E5E5"> you</font>

19
00:00:35,010 --> 00:00:39,360
<font color="#CCCCCC">very much for being here</font><font color="#E5E5E5"> with</font><font color="#CCCCCC"> me</font><font color="#E5E5E5"> I'm a</font>

20
00:00:37,739 --> 00:00:41,760
security<font color="#E5E5E5"> consultant and researcher and I</font>

21
00:00:39,360 --> 00:00:43,739
own and<font color="#E5E5E5"> operate 80 security org which</font>

22
00:00:41,760 --> 00:00:46,649
hopefully<font color="#E5E5E5"> many people have heard of are</font>

23
00:00:43,739 --> 00:00:47,519
used to help<font color="#E5E5E5"> secure your environment so</font>

24
00:00:46,649 --> 00:00:49,800
there's a number<font color="#E5E5E5"> of things I'm going to</font>

25
00:00:47,520 --> 00:00:51,449
<font color="#E5E5E5">talk</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> during this presentation I'm</font>

26
00:00:49,800 --> 00:00:53,430
going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> talk about where we've come</font>

27
00:00:51,449 --> 00:00:56,280
from<font color="#CCCCCC"> as far as administration</font><font color="#E5E5E5"> what it</font>

28
00:00:53,430 --> 00:00:58,559
looked like<font color="#E5E5E5"> as we've advanced what we've</font>

29
00:00:56,280 --> 00:01:00,059
<font color="#E5E5E5">done over the</font><font color="#CCCCCC"> years</font><font color="#E5E5E5"> and the weaknesses</font>

30
00:00:58,559 --> 00:01:02,578
<font color="#E5E5E5">that are still inherent in those</font>

31
00:01:00,059 --> 00:01:04,610
processes<font color="#CCCCCC"> as well as</font><font color="#E5E5E5"> the things that are</font>

32
00:01:02,579 --> 00:01:06,960
<font color="#E5E5E5">currently considered secure</font>

33
00:01:04,610 --> 00:01:08,880
administration and why they aren't<font color="#E5E5E5"> and</font>

34
00:01:06,960 --> 00:01:11,070
then I'm going to<font color="#E5E5E5"> close up</font><font color="#CCCCCC"> with how to</font>

35
00:01:08,880 --> 00:01:14,089
better secure your environment<font color="#E5E5E5"> and how</font>

36
00:01:11,070 --> 00:01:16,258
<font color="#E5E5E5">to better perform secure administration</font>

37
00:01:14,090 --> 00:01:19,140
so many organizations<font color="#CCCCCC"> have</font><font color="#E5E5E5"> upgraded</font>

38
00:01:16,259 --> 00:01:21,090
<font color="#E5E5E5">their security we've added better</font>

39
00:01:19,140 --> 00:01:24,360
<font color="#E5E5E5">visibility through security tooling</font>

40
00:01:21,090 --> 00:01:27,210
event logging<font color="#E5E5E5"> auditing ADR tools we have</font>

41
00:01:24,360 --> 00:01:28,950
blinky boxes we've flowed all these

42
00:01:27,210 --> 00:01:31,798
security events hopefully many<font color="#E5E5E5"> of them</font>

43
00:01:28,950 --> 00:01:33,930
into<font color="#CCCCCC"> our sim tool we're watching those</font>

44
00:01:31,799 --> 00:01:36,600
we're getting alerts<font color="#E5E5E5"> we've done all of</font>

45
00:01:33,930 --> 00:01:38,250
<font color="#E5E5E5">these other things</font><font color="#CCCCCC"> to lockdown secure</font>

46
00:01:36,600 --> 00:01:40,350
<font color="#CCCCCC">workstations</font><font color="#E5E5E5"> to have better control of</font><font color="#CCCCCC"> a</font>

47
00:01:38,250 --> 00:01:42,299
better<font color="#CCCCCC"> visibility in our environment but</font>

48
00:01:40,350 --> 00:01:44,850
<font color="#CCCCCC">rarely have we actually</font><font color="#E5E5E5"> done much to</font>

49
00:01:42,299 --> 00:01:48,720
secure or improve the way that<font color="#CCCCCC"> a quick</font>

50
00:01:44,850 --> 00:01:53,070
<font color="#CCCCCC">turi is administered we need to do</font>

51
00:01:48,720 --> 00:01:54,149
better<font color="#E5E5E5"> based on what I've seen so let's</font>

52
00:01:53,070 --> 00:01:56,758
start from<font color="#E5E5E5"> the</font><font color="#CCCCCC"> beginning</font>

53
00:01:54,149 --> 00:01:58,500
in the<font color="#E5E5E5"> beginning we had a</font><font color="#CCCCCC"> workstation</font>

54
00:01:56,759 --> 00:02:00,780
and we had a<font color="#E5E5E5"> happy user on their</font>

55
00:01:58,500 --> 00:02:04,380
workstation<font color="#E5E5E5"> and this user had problems</font>

56
00:02:00,780 --> 00:02:06,390
so we<font color="#CCCCCC"> added</font><font color="#E5E5E5"> desktop support and desktop</font>

57
00:02:04,380 --> 00:02:08,940
support met a bunch<font color="#E5E5E5"> of other</font>

58
00:02:06,390 --> 00:02:11,640
<font color="#E5E5E5">administrators with remote</font><font color="#CCCCCC"> access or</font>

59
00:02:08,940 --> 00:02:13,440
local admin<font color="#CCCCCC"> access on that system and</font>

60
00:02:11,640 --> 00:02:14,760
after desktop support we realized what

61
00:02:13,440 --> 00:02:17,520
<font color="#E5E5E5">we need to patch</font><font color="#CCCCCC"> the system there's</font>

62
00:02:14,760 --> 00:02:20,099
vulnerabilities we need to fix so we

63
00:02:17,520 --> 00:02:21,330
added<font color="#E5E5E5"> actually patching and agents</font>

64
00:02:20,099 --> 00:02:23,579
associated with<font color="#CCCCCC"> Paget</font>

65
00:02:21,330 --> 00:02:24,810
and then ultimately we<font color="#E5E5E5"> realized this was</font>

66
00:02:23,580 --> 00:02:26,640
too<font color="#CCCCCC"> much to</font><font color="#E5E5E5"> handle with all these</font>

67
00:02:24,810 --> 00:02:29,430
<font color="#E5E5E5">different systems we need to integrate</font>

68
00:02:26,640 --> 00:02:31,920
<font color="#E5E5E5">it better so we set up a mission control</font>

69
00:02:29,430 --> 00:02:34,290
types configuration and with our mission

70
00:02:31,920 --> 00:02:37,349
control<font color="#E5E5E5"> we had better central management</font>

71
00:02:34,290 --> 00:02:39,720
and<font color="#E5E5E5"> control of our environment but the</font>

72
00:02:37,349 --> 00:02:42,988
result of all of<font color="#CCCCCC"> this is that we have a</font>

73
00:02:39,720 --> 00:02:44,129
<font color="#CCCCCC">workstation that</font><font color="#E5E5E5"> has 30 accounts in the</font>

74
00:02:42,989 --> 00:02:48,090
local<font color="#E5E5E5"> administrators group</font>

75
00:02:44,129 --> 00:02:50,760
which could be a mix of<font color="#E5E5E5"> ad accounts and</font>

76
00:02:48,090 --> 00:02:52,590
local accounts we've got about 50

77
00:02:50,760 --> 00:02:55,410
accounts with local admin rights through

78
00:02:52,590 --> 00:02:57,000
this management<font color="#E5E5E5"> system we've got</font><font color="#CCCCCC"> 20</font>

79
00:02:55,410 --> 00:02:59,790
accounts with control<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> computer</font>

80
00:02:57,000 --> 00:03:01,260
through<font color="#E5E5E5"> security agents or tooling and</font>

81
00:02:59,790 --> 00:03:03,569
we end<font color="#E5E5E5"> up with about</font><font color="#CCCCCC"> a hundred</font><font color="#E5E5E5"> accounts</font>

82
00:03:01,260 --> 00:03:05,429
that have admin<font color="#E5E5E5"> rights</font><font color="#CCCCCC"> how these numbers</font>

83
00:03:03,569 --> 00:03:06,929
<font color="#E5E5E5">might</font><font color="#CCCCCC"> be off</font><font color="#E5E5E5"> for a lot of</font><font color="#CCCCCC"> organizations</font>

84
00:03:05,430 --> 00:03:08,280
but<font color="#E5E5E5"> I'm sure there's some people here</font>

85
00:03:06,930 --> 00:03:09,750
that are<font color="#E5E5E5"> trying to hide their head right</font>

86
00:03:08,280 --> 00:03:13,019
now because<font color="#E5E5E5"> that's a</font><font color="#CCCCCC"> very similar</font>

87
00:03:09,750 --> 00:03:15,780
<font color="#CCCCCC">scenario</font><font color="#E5E5E5"> because ultimately it comes</font>

88
00:03:13,019 --> 00:03:17,640
down<font color="#CCCCCC"> to</font><font color="#E5E5E5"> who has control of the</font>

89
00:03:15,780 --> 00:03:22,500
workstation who are the administrators

90
00:03:17,640 --> 00:03:26,129
<font color="#CCCCCC">who can control manage modify that</font>

91
00:03:22,500 --> 00:03:28,140
system and what if the administrator of

92
00:03:26,129 --> 00:03:30,899
<font color="#E5E5E5">Active Directory actually uses</font><font color="#CCCCCC"> that</font>

93
00:03:28,140 --> 00:03:32,250
system so let's take a<font color="#E5E5E5"> step</font><font color="#CCCCCC"> back and go</font>

94
00:03:30,900 --> 00:03:34,560
through<font color="#E5E5E5"> the evolution of administration</font>

95
00:03:32,250 --> 00:03:37,170
we went<font color="#E5E5E5"> from using something like VNC to</font>

96
00:03:34,560 --> 00:03:39,180
RDP we were using run<font color="#CCCCCC"> ads in order to</font>

97
00:03:37,170 --> 00:03:44,040
run our MMC<font color="#CCCCCC"> and a lot of other acronyms</font>

98
00:03:39,180 --> 00:03:47,610
<font color="#CCCCCC">but in the beginning there were admins</font>

99
00:03:44,040 --> 00:03:50,489
everywhere we had administrators we had

100
00:03:47,610 --> 00:03:52,110
domain admins<font color="#E5E5E5"> oftentimes user accounts</font>

101
00:03:50,489 --> 00:03:54,689
were actually domain admins<font color="#E5E5E5"> in some</font>

102
00:03:52,110 --> 00:03:56,849
situations every local administrator had

103
00:03:54,689 --> 00:03:59,730
the same name and password<font color="#E5E5E5"> across the</font>

104
00:03:56,849 --> 00:04:01,319
organization<font color="#CCCCCC"> and some environments</font>

105
00:03:59,730 --> 00:04:04,530
actually had as many domain admins as

106
00:04:01,319 --> 00:04:06,750
users which is<font color="#E5E5E5"> the ostriches here I</font>

107
00:04:04,530 --> 00:04:08,040
can't<font color="#E5E5E5"> tell if they're users or admins</font>

108
00:04:06,750 --> 00:04:11,879
but there's a lot<font color="#CCCCCC"> of them so that's</font><font color="#E5E5E5"> bad</font>

109
00:04:08,040 --> 00:04:14,280
right and<font color="#CCCCCC"> this resulted in a situation</font>

110
00:04:11,879 --> 00:04:15,359
where we have an environment<font color="#E5E5E5"> that's</font>

111
00:04:14,280 --> 00:04:17,100
<font color="#E5E5E5">target-rich</font>

112
00:04:15,360 --> 00:04:18,660
the attacker<font color="#E5E5E5"> gets into the environment</font>

113
00:04:17,100 --> 00:04:20,580
and they can<font color="#E5E5E5"> just kind of pick and</font>

114
00:04:18,660 --> 00:04:22,860
choose<font color="#E5E5E5"> what</font><font color="#CCCCCC"> they want to</font><font color="#E5E5E5"> use because</font>

115
00:04:20,579 --> 00:04:24,270
there's credentials everywhere because

116
00:04:22,860 --> 00:04:25,920
<font color="#CCCCCC">of the way we've been managing</font><font color="#E5E5E5"> our</font>

117
00:04:24,270 --> 00:04:27,870
systems the way that we still manage our

118
00:04:25,920 --> 00:04:29,700
systems most of the time we're using a

119
00:04:27,870 --> 00:04:32,040
user workstation standard regular user

120
00:04:29,700 --> 00:04:33,300
workstation we log on<font color="#CCCCCC"> with the user</font>

121
00:04:32,040 --> 00:04:35,490
account and<font color="#E5E5E5"> then we perform under</font>

122
00:04:33,300 --> 00:04:38,910
<font color="#E5E5E5">administration through RDP or some other</font>

123
00:04:35,490 --> 00:04:40,620
method<font color="#E5E5E5"> so when we talk</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> the way</font>

124
00:04:38,910 --> 00:04:42,660
<font color="#E5E5E5">where we were the</font><font color="#CCCCCC"> old-school</font><font color="#E5E5E5"> admin</font>

125
00:04:40,620 --> 00:04:44,460
methods<font color="#CCCCCC"> like I said</font><font color="#E5E5E5"> logging</font><font color="#CCCCCC"> on to</font><font color="#E5E5E5"> the</font>

126
00:04:42,660 --> 00:04:46,200
workstation as an admin we probably

127
00:04:44,460 --> 00:04:49,260
<font color="#E5E5E5">don't do that</font><font color="#CCCCCC"> anymore hopefully because</font>

128
00:04:46,200 --> 00:04:51,780
credentials were an else ass for that we

129
00:04:49,260 --> 00:04:53,490
don't<font color="#CCCCCC"> really use run as any more on our</font>

130
00:04:51,780 --> 00:04:56,969
<font color="#E5E5E5">workstations because again credentials</font>

131
00:04:53,490 --> 00:04:58,910
end up in else ass but we do often<font color="#CCCCCC"> RDP</font>

132
00:04:56,970 --> 00:05:02,490
to<font color="#CCCCCC"> the main controllers or admin servers</font>

133
00:04:58,910 --> 00:05:03,930
and<font color="#CCCCCC"> manage them</font><font color="#E5E5E5"> but that</font><font color="#CCCCCC"> means the</font>

134
00:05:02,490 --> 00:05:05,610
credentials are<font color="#E5E5E5"> in alsace on that system</font>

135
00:05:03,930 --> 00:05:07,140
<font color="#E5E5E5">so if we're connecting to an admin</font>

136
00:05:05,610 --> 00:05:09,180
server and that admin server isn't<font color="#E5E5E5"> well</font>

137
00:05:07,140 --> 00:05:10,740
protected<font color="#CCCCCC"> then an attacker could</font><font color="#E5E5E5"> use</font>

138
00:05:09,180 --> 00:05:15,540
something like mini<font color="#E5E5E5"> cats to extract</font>

139
00:05:10,740 --> 00:05:19,830
<font color="#E5E5E5">those credentials and reuse them like</font>

140
00:05:15,540 --> 00:05:22,460
this<font color="#E5E5E5"> so where we are</font><font color="#CCCCCC"> now we have newer</font>

141
00:05:19,830 --> 00:05:26,729
better secure admin methods right we

142
00:05:22,460 --> 00:05:29,039
said no more<font color="#CCCCCC"> to run as we said no</font><font color="#E5E5E5"> more</font>

143
00:05:26,730 --> 00:05:35,670
to local MMC's activities and

144
00:05:29,040 --> 00:05:37,890
administration when we use RDP we are

145
00:05:35,670 --> 00:05:39,720
going to use<font color="#E5E5E5"> an</font><font color="#CCCCCC"> LA Network</font><font color="#E5E5E5"> level</font>

146
00:05:37,890 --> 00:05:41,099
authentication<font color="#E5E5E5"> which prompts us for our</font>

147
00:05:39,720 --> 00:05:43,320
credentials<font color="#CCCCCC"> before we connect to</font><font color="#E5E5E5"> that</font>

148
00:05:41,100 --> 00:05:44,910
system<font color="#E5E5E5"> and sometimes we're gonna use MFA</font>

149
00:05:43,320 --> 00:05:46,260
in fact<font color="#E5E5E5"> I've noticed more and more</font>

150
00:05:44,910 --> 00:05:48,570
<font color="#CCCCCC">customers and organizations are using</font>

151
00:05:46,260 --> 00:05:50,370
<font color="#CCCCCC">MFA which is great</font><font color="#E5E5E5"> others are starting</font>

152
00:05:48,570 --> 00:05:52,140
<font color="#E5E5E5">to use password</font><font color="#CCCCCC"> vaults enterprise</font>

153
00:05:50,370 --> 00:05:56,070
password<font color="#CCCCCC"> volts like psychotic secret</font>

154
00:05:52,140 --> 00:05:57,450
server or<font color="#E5E5E5"> cyber-ark so let's talk</font><font color="#CCCCCC"> about</font>

155
00:05:56,070 --> 00:05:59,280
how we could exploit the typical

156
00:05:57,450 --> 00:06:02,310
administrator so here we have a regular

157
00:05:59,280 --> 00:06:05,219
<font color="#E5E5E5">workstation and just a regular</font><font color="#CCCCCC"> username</font>

158
00:06:02,310 --> 00:06:07,290
<font color="#CCCCCC">Sean is logged on to it</font><font color="#E5E5E5"> so he needs to</font>

159
00:06:05,220 --> 00:06:09,720
do some work so<font color="#CCCCCC"> he's gonna run MS cts</font>

160
00:06:07,290 --> 00:06:11,040
<font color="#E5E5E5">see it pops up that RDP window and he's</font>

161
00:06:09,720 --> 00:06:12,420
gonna type in his credentials and<font color="#CCCCCC"> do</font>

162
00:06:11,040 --> 00:06:16,820
what he normally does<font color="#CCCCCC"> as an</font>

163
00:06:12,420 --> 00:06:19,230
administrator<font color="#E5E5E5"> but behind the scenes</font>

164
00:06:16,820 --> 00:06:21,960
<font color="#E5E5E5">there's a file that</font><font color="#CCCCCC"> just gets dropped</font>

165
00:06:19,230 --> 00:06:26,180
<font color="#E5E5E5">into the C Drive it's very interesting</font>

166
00:06:21,960 --> 00:06:26,180
file this<font color="#E5E5E5"> temp file</font>

167
00:06:27,360 --> 00:06:33,930
what is<font color="#E5E5E5"> this temp file so the attacker</font>

168
00:06:31,500 --> 00:06:37,860
<font color="#CCCCCC">behind the scenes</font><font color="#E5E5E5"> completely in stealth</font>

169
00:06:33,930 --> 00:06:40,289
has<font color="#E5E5E5"> performed a</font><font color="#CCCCCC"> WMI implant method</font><font color="#E5E5E5"> to</font>

170
00:06:37,860 --> 00:06:42,990
drop us a task a<font color="#CCCCCC"> w my</font><font color="#E5E5E5"> task on this</font>

171
00:06:40,289 --> 00:06:45,688
<font color="#CCCCCC">system that whenever</font><font color="#E5E5E5"> M</font><font color="#CCCCCC"> STS C dot exe is</font>

172
00:06:42,990 --> 00:06:48,240
executed<font color="#CCCCCC"> a special</font><font color="#E5E5E5"> PowerShell script is</font>

173
00:06:45,689 --> 00:06:50,610
going<font color="#CCCCCC"> to be run that</font><font color="#E5E5E5"> I've decided to</font>

174
00:06:48,240 --> 00:06:50,960
<font color="#CCCCCC">call a</font><font color="#E5E5E5"> CCM health check sounds good to</font>

175
00:06:50,610 --> 00:06:53,729
me

176
00:06:50,960 --> 00:06:58,310
<font color="#CCCCCC">alright but what does SCCM health check</font>

177
00:06:53,729 --> 00:07:01,919
actually<font color="#E5E5E5"> do and</font><font color="#CCCCCC"> did microsoft</font><font color="#E5E5E5"> write this</font>

178
00:06:58,310 --> 00:07:03,330
so we go forward<font color="#E5E5E5"> and</font><font color="#CCCCCC"> look and see well</font>

179
00:07:01,919 --> 00:07:06,000
<font color="#CCCCCC">that</font><font color="#E5E5E5"> doesn't look like</font><font color="#CCCCCC"> a CCM health</font>

180
00:07:03,330 --> 00:07:11,068
check that looks like something<font color="#CCCCCC"> very</font>

181
00:07:06,000 --> 00:07:12,539
<font color="#E5E5E5">different so when we</font><font color="#CCCCCC"> are trying</font><font color="#E5E5E5"> to</font>

182
00:07:11,069 --> 00:07:14,460
<font color="#E5E5E5">figure out what's going on and we're</font>

183
00:07:12,539 --> 00:07:15,870
digging<font color="#CCCCCC"> through</font><font color="#E5E5E5"> this we're gonna see</font>

184
00:07:14,460 --> 00:07:18,900
<font color="#E5E5E5">that this is the gets keystrokes</font>

185
00:07:15,870 --> 00:07:21,569
<font color="#CCCCCC">powersploit</font><font color="#E5E5E5"> function and what keystrokes</font>

186
00:07:18,900 --> 00:07:23,128
does is a<font color="#CCCCCC"> PowerShell script or function</font>

187
00:07:21,569 --> 00:07:25,770
is actually<font color="#CCCCCC"> going to capture this</font>

188
00:07:23,129 --> 00:07:28,439
keystrokes<font color="#CCCCCC"> while it's running to us</font><font color="#E5E5E5"> to a</font>

189
00:07:25,770 --> 00:07:30,240
text file and<font color="#E5E5E5"> that</font><font color="#CCCCCC"> happens</font><font color="#E5E5E5"> to be that</font>

190
00:07:28,439 --> 00:07:31,919
<font color="#E5E5E5">temp file that dropped to the C Drive</font>

191
00:07:30,240 --> 00:07:34,110
<font color="#E5E5E5">now can go anywhere on the system it</font>

192
00:07:31,919 --> 00:07:35,639
wants but<font color="#E5E5E5"> it's going to</font><font color="#CCCCCC"> capture every</font>

193
00:07:34,110 --> 00:07:38,550
single<font color="#CCCCCC"> key press</font><font color="#E5E5E5"> that happens on that</font>

194
00:07:35,639 --> 00:07:41,129
<font color="#CCCCCC">system and it</font><font color="#E5E5E5"> can be quite extensive as</font>

195
00:07:38,550 --> 00:07:43,020
it captures this information the WMI

196
00:07:41,129 --> 00:07:44,580
task could also have that text cop file

197
00:07:43,020 --> 00:07:48,029
you copy it<font color="#E5E5E5"> off to another location or</font>

198
00:07:44,580 --> 00:07:49,758
uploaded to a<font color="#CCCCCC"> website and</font><font color="#E5E5E5"> using</font>

199
00:07:48,029 --> 00:07:52,589
<font color="#CCCCCC">PowerShell</font><font color="#E5E5E5"> I can go through and</font><font color="#CCCCCC"> quickly</font>

200
00:07:49,759 --> 00:07:55,589
extract<font color="#CCCCCC"> the information</font><font color="#E5E5E5"> from this text</font>

201
00:07:52,589 --> 00:07:58,229
file<font color="#E5E5E5"> and pull it together</font><font color="#CCCCCC"> and when I do</font>

202
00:07:55,589 --> 00:07:59,370
this I can<font color="#E5E5E5"> very easily identify assuming</font>

203
00:07:58,229 --> 00:08:01,318
that someone typed it in at this<font color="#CCCCCC"> moment</font>

204
00:07:59,370 --> 00:08:03,539
<font color="#E5E5E5">what the server name is what the user</font>

205
00:08:01,319 --> 00:08:06,569
name<font color="#E5E5E5"> is the admin and the actual</font>

206
00:08:03,539 --> 00:08:10,259
password so now I have the credentials

207
00:08:06,569 --> 00:08:12,779
<font color="#E5E5E5">and guess what happens if this is the</font>

208
00:08:10,259 --> 00:08:16,589
<font color="#E5E5E5">domain admin account yeah I can use</font>

209
00:08:12,779 --> 00:08:19,620
<font color="#E5E5E5">something called DC sync so this is very</font>

210
00:08:16,589 --> 00:08:20,460
dangerous<font color="#E5E5E5"> and even if I add MFA to</font><font color="#CCCCCC"> this</font>

211
00:08:19,620 --> 00:08:24,029
situation

212
00:08:20,460 --> 00:08:25,859
I don't need to use MFA when I'm running

213
00:08:24,029 --> 00:08:29,339
DC sync<font color="#E5E5E5"> because it's just an LDAP call</font>

214
00:08:25,860 --> 00:08:33,690
to the DC so let's talk<font color="#CCCCCC"> a little bit</font>

215
00:08:29,339 --> 00:08:36,568
<font color="#CCCCCC">more about this</font><font color="#E5E5E5"> what if we add MFA we</font>

216
00:08:33,690 --> 00:08:38,409
can MFA the RDP so the way you RDP<font color="#CCCCCC"> weave</font>

217
00:08:36,568 --> 00:08:44,049
<font color="#CCCCCC">its MFA and we got</font><font color="#E5E5E5"> everything covered</font>

218
00:08:38,409 --> 00:08:46,060
right well we<font color="#E5E5E5"> have our RDP connection we</font>

219
00:08:44,049 --> 00:08:47,529
get our duo prompt<font color="#E5E5E5"> I'm not picking on</font>

220
00:08:46,060 --> 00:08:50,699
duo but apparently<font color="#E5E5E5"> they were in the news</font>

221
00:08:47,529 --> 00:08:53,980
<font color="#E5E5E5">recently so I figured I'd use them and</font>

222
00:08:50,699 --> 00:08:57,160
<font color="#E5E5E5">so when we click on this push we get a</font>

223
00:08:53,980 --> 00:08:59,829
pop up on<font color="#E5E5E5"> our mobile device</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> we have</font>

224
00:08:57,160 --> 00:09:02,019
two<font color="#E5E5E5"> options</font><font color="#CCCCCC"> we approve or deny and</font>

225
00:08:59,829 --> 00:09:03,878
looking at it we decide yes this was me

226
00:09:02,019 --> 00:09:04,839
I'm going to<font color="#E5E5E5"> approve</font><font color="#CCCCCC"> that but what would</font>

227
00:09:03,879 --> 00:09:07,149
happen<font color="#E5E5E5"> if I got two of</font><font color="#CCCCCC"> these</font>

228
00:09:04,839 --> 00:09:08,589
<font color="#CCCCCC">back-to-back what if I click approve</font><font color="#E5E5E5"> on</font>

229
00:09:07,149 --> 00:09:10,930
the first one what do I do the second

230
00:09:08,589 --> 00:09:14,230
one<font color="#E5E5E5"> well the obvious answer</font><font color="#CCCCCC"> is I deny it</font>

231
00:09:10,930 --> 00:09:15,758
<font color="#CCCCCC">right but how do I know which one is</font>

232
00:09:14,230 --> 00:09:18,550
mine and<font color="#E5E5E5"> which one isn't</font><font color="#CCCCCC"> or is this a</font>

233
00:09:15,759 --> 00:09:22,110
hiccup and the same thing can<font color="#E5E5E5"> happen</font>

234
00:09:18,550 --> 00:09:24,758
<font color="#CCCCCC">with a DFS or on my mobile device itself</font>

235
00:09:22,110 --> 00:09:26,709
<font color="#E5E5E5">if I just look at the lock screen and it</font>

236
00:09:24,759 --> 00:09:27,220
pops up<font color="#E5E5E5"> I'm gonna go yeah prove I just</font>

237
00:09:26,709 --> 00:09:29,709
did that

238
00:09:27,220 --> 00:09:31,569
but what if<font color="#E5E5E5"> another one pops up is that</font>

239
00:09:29,709 --> 00:09:33,819
me or<font color="#E5E5E5"> did a hiccup or was there a</font>

240
00:09:31,569 --> 00:09:35,439
problem with<font color="#E5E5E5"> the operating</font><font color="#CCCCCC"> system on the</font>

241
00:09:33,819 --> 00:09:39,399
<font color="#E5E5E5">mobile device or the app what's</font><font color="#CCCCCC"> it what</font>

242
00:09:35,439 --> 00:09:42,279
if there's a third one will the user

243
00:09:39,399 --> 00:09:44,730
report this<font color="#CCCCCC"> we'll</font><font color="#E5E5E5"> use a report something</font>

244
00:09:42,279 --> 00:09:46,839
<font color="#CCCCCC">that's odd that's happening with</font><font color="#E5E5E5"> MFA</font>

245
00:09:44,730 --> 00:09:50,050
what if the attacker can initiate

246
00:09:46,839 --> 00:09:51,990
initiate<font color="#E5E5E5"> or initialize MFA request</font><font color="#CCCCCC"> at</font>

247
00:09:50,050 --> 00:09:54,699
around the same<font color="#CCCCCC"> time the admins using it</font>

248
00:09:51,990 --> 00:09:56,740
everyone's<font color="#E5E5E5"> very busy when we get prompts</font>

249
00:09:54,699 --> 00:09:59,889
like<font color="#E5E5E5"> this we our tendency is to click</font><font color="#CCCCCC"> on</font>

250
00:09:56,740 --> 00:10:02,350
it<font color="#E5E5E5"> just tap tap tap</font><font color="#CCCCCC"> oh do</font><font color="#E5E5E5"> the second</font><font color="#CCCCCC"> one</font>

251
00:09:59,889 --> 00:10:06,009
pop up<font color="#CCCCCC"> I don't really know that's</font><font color="#E5E5E5"> okay</font>

252
00:10:02,350 --> 00:10:07,660
it'll<font color="#E5E5E5"> be fine so what if there's a way</font>

253
00:10:06,009 --> 00:10:12,130
<font color="#CCCCCC">that</font><font color="#E5E5E5"> an attacker could actually subvert</font>

254
00:10:07,660 --> 00:10:13,930
the MFA system so here's a scenario<font color="#CCCCCC"> that</font>

255
00:10:12,130 --> 00:10:16,569
I'm<font color="#E5E5E5"> gonna put together we have this</font>

256
00:10:13,930 --> 00:10:18,790
fictional company<font color="#E5E5E5"> called acne and acne</font>

257
00:10:16,569 --> 00:10:20,620
has<font color="#E5E5E5"> a self-service portal where users</font>

258
00:10:18,790 --> 00:10:22,120
can go in and<font color="#E5E5E5"> manage their own</font>

259
00:10:20,620 --> 00:10:23,709
<font color="#CCCCCC">attributes</font><font color="#E5E5E5"> these are some standard</font>

260
00:10:22,120 --> 00:10:24,279
attributes like work phone number work

261
00:10:23,709 --> 00:10:26,500
address

262
00:10:24,279 --> 00:10:27,790
mobile number<font color="#CCCCCC"> etc so pretty standard a</font>

263
00:10:26,500 --> 00:10:31,209
lot of organizations<font color="#CCCCCC"> have this</font>

264
00:10:27,790 --> 00:10:33,519
configured attributes may vary so let's

265
00:10:31,209 --> 00:10:34,930
<font color="#CCCCCC">say that our admin Luke Skywalker has a</font>

266
00:10:33,519 --> 00:10:38,410
user account<font color="#E5E5E5"> and an admin account</font>

267
00:10:34,930 --> 00:10:41,559
<font color="#E5E5E5">because he's a smart guy</font><font color="#CCCCCC"> and so he has</font>

268
00:10:38,410 --> 00:10:44,769
his mobile number<font color="#E5E5E5"> set up in here on his</font>

269
00:10:41,559 --> 00:10:46,360
user account<font color="#E5E5E5"> well if the attacker can</font>

270
00:10:44,769 --> 00:10:49,420
leverage<font color="#CCCCCC"> the self-service portal they</font>

271
00:10:46,360 --> 00:10:51,519
can change it<font color="#E5E5E5"> to</font><font color="#CCCCCC"> 8 6 75 309 because</font>

272
00:10:49,420 --> 00:10:52,010
that's what any attacker is<font color="#CCCCCC"> gonna use as</font>

273
00:10:51,519 --> 00:10:58,400
a phone

274
00:10:52,010 --> 00:11:01,040
easy to<font color="#E5E5E5"> remember and once he has</font><font color="#CCCCCC"> that or</font>

275
00:10:58,400 --> 00:11:02,600
this attacker has access<font color="#CCCCCC"> and the ability</font>

276
00:11:01,040 --> 00:11:04,819
to change<font color="#E5E5E5"> that mobile number things get</font>

277
00:11:02,600 --> 00:11:05,870
<font color="#CCCCCC">pretty interesting because in</font><font color="#E5E5E5"> duo by</font>

278
00:11:04,820 --> 00:11:07,820
default or at least in the

279
00:11:05,870 --> 00:11:09,800
configurations I've seen as<font color="#E5E5E5"> well as</font>

280
00:11:07,820 --> 00:11:12,310
other MFA configurations<font color="#E5E5E5"> there's a</font>

281
00:11:09,800 --> 00:11:17,870
<font color="#E5E5E5">backup</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> the standard put app push</font>

282
00:11:12,310 --> 00:11:19,400
which is yes SMS or text<font color="#E5E5E5"> so oftentimes</font>

283
00:11:17,870 --> 00:11:21,080
it pulls this information from the

284
00:11:19,400 --> 00:11:22,430
Active Directory<font color="#E5E5E5"> user account for the</font>

285
00:11:21,080 --> 00:11:24,820
phone number it<font color="#CCCCCC"> should use for</font><font color="#E5E5E5"> that text</font>

286
00:11:22,430 --> 00:11:27,199
message so if the attacker has the

287
00:11:24,820 --> 00:11:30,500
<font color="#E5E5E5">credentials of that admin account and</font>

288
00:11:27,200 --> 00:11:33,290
they want<font color="#E5E5E5"> to leverage MFA one thing that</font>

289
00:11:30,500 --> 00:11:35,120
they<font color="#E5E5E5"> can do as an option is modify that</font>

290
00:11:33,290 --> 00:11:37,400
phone number<font color="#CCCCCC"> that mobile phone number</font>

291
00:11:35,120 --> 00:11:40,790
and have a text message<font color="#CCCCCC"> sent</font><font color="#E5E5E5"> to their</font>

292
00:11:37,400 --> 00:11:43,760
phone<font color="#CCCCCC"> and the actual user who owns that</font>

293
00:11:40,790 --> 00:11:45,410
account<font color="#E5E5E5"> and it counts doesn't see</font>

294
00:11:43,760 --> 00:11:48,950
anything<font color="#E5E5E5"> there's no message that goes to</font>

295
00:11:45,410 --> 00:11:51,319
them at all now there's similar

296
00:11:48,950 --> 00:11:55,850
situations with with other MFA systems

297
00:11:51,320 --> 00:11:58,370
and so just<font color="#E5E5E5"> a summary</font><font color="#CCCCCC"> of this if the</font>

298
00:11:55,850 --> 00:12:00,350
attacker can modify<font color="#E5E5E5"> that phone number</font>

299
00:11:58,370 --> 00:12:03,470
<font color="#E5E5E5">that mobile number for that user account</font>

300
00:12:00,350 --> 00:12:06,790
<font color="#CCCCCC">which is used by</font><font color="#E5E5E5"> the MFA and that backup</font>

301
00:12:03,470 --> 00:12:10,940
<font color="#CCCCCC">SMS text messaging system isn't</font><font color="#E5E5E5"> disabled</font>

302
00:12:06,790 --> 00:12:13,400
<font color="#E5E5E5">there's a backdoor</font><font color="#CCCCCC"> a way to use that</font>

303
00:12:10,940 --> 00:12:15,050
account<font color="#E5E5E5"> and if these are admin</font>

304
00:12:13,400 --> 00:12:18,050
credentials then it could potentially<font color="#E5E5E5"> be</font>

305
00:12:15,050 --> 00:12:20,750
<font color="#CCCCCC">game over and no one it's possible that</font>

306
00:12:18,050 --> 00:12:22,099
<font color="#E5E5E5">no one will notice now another</font>

307
00:12:20,750 --> 00:12:23,690
interesting<font color="#E5E5E5"> thing about duo again I</font>

308
00:12:22,100 --> 00:12:25,090
<font color="#CCCCCC">promise I'm not picking on do</font><font color="#E5E5E5"> they're</font>

309
00:12:23,690 --> 00:12:27,260
just<font color="#CCCCCC"> very popular</font><font color="#E5E5E5"> and like I said</font>

310
00:12:25,090 --> 00:12:29,840
<font color="#E5E5E5">there's a lot</font><font color="#CCCCCC"> of activity</font><font color="#E5E5E5"> about</font><font color="#CCCCCC"> duo</font>

311
00:12:27,260 --> 00:12:33,650
<font color="#E5E5E5">recently but there was an article</font>

312
00:12:29,840 --> 00:12:36,110
<font color="#E5E5E5">recently a blog post about duo and fail</font>

313
00:12:33,650 --> 00:12:41,329
<font color="#E5E5E5">open versus</font><font color="#CCCCCC"> fail closed</font><font color="#E5E5E5"> so by default</font>

314
00:12:36,110 --> 00:12:44,930
<font color="#E5E5E5">duo fails open and duo uses a request</font>

315
00:12:41,330 --> 00:12:48,350
via<font color="#CCCCCC"> the</font><font color="#E5E5E5"> DNS lookup and then</font><font color="#CCCCCC"> a connection</font>

316
00:12:44,930 --> 00:12:51,050
to its API<font color="#E5E5E5"> a record under deal with</font>

317
00:12:48,350 --> 00:12:55,310
security comm so if an attacker is<font color="#E5E5E5"> able</font>

318
00:12:51,050 --> 00:12:59,060
<font color="#E5E5E5">to actually block that connection what</font>

319
00:12:55,310 --> 00:13:00,800
happens is MFA doesn't work at all<font color="#E5E5E5"> so</font>

320
00:12:59,060 --> 00:13:02,750
you can change this<font color="#E5E5E5"> setting obviously</font>

321
00:13:00,800 --> 00:13:05,060
and there's another setting<font color="#E5E5E5"> that's</font>

322
00:13:02,750 --> 00:13:05,779
interesting here<font color="#E5E5E5"> and that is the ability</font>

323
00:13:05,060 --> 00:13:08,569
to

324
00:13:05,779 --> 00:13:11,509
remove<font color="#CCCCCC"> MFA requirement for local</font>

325
00:13:08,569 --> 00:13:13,040
accounts and so this way you can<font color="#CCCCCC"> do</font>

326
00:13:11,509 --> 00:13:14,629
whatever you want as a local<font color="#E5E5E5"> account but</font>

327
00:13:13,040 --> 00:13:21,199
everyone that connects in with an ad

328
00:13:14,629 --> 00:13:22,670
account<font color="#E5E5E5"> will be</font><font color="#CCCCCC"> required to MFA so</font>

329
00:13:21,199 --> 00:13:24,290
there's some recommendations around MFA

330
00:13:22,670 --> 00:13:26,599
first of all<font color="#E5E5E5"> don't rely on it</font><font color="#CCCCCC"> to protect</font>

331
00:13:24,290 --> 00:13:28,550
your admin accounts don't don't let it

332
00:13:26,600 --> 00:13:30,589
be<font color="#E5E5E5"> the only thing that is protecting</font>

333
00:13:28,550 --> 00:13:32,769
<font color="#E5E5E5">your admin accounts use</font><font color="#CCCCCC"> hardware</font><font color="#E5E5E5"> tokens</font>

334
00:13:30,589 --> 00:13:35,269
<font color="#E5E5E5">or the app disable SMS if possible</font>

335
00:13:32,769 --> 00:13:37,370
research failed<font color="#CCCCCC"> closed</font><font color="#E5E5E5"> for critical</font>

336
00:13:35,269 --> 00:13:39,230
servers<font color="#E5E5E5"> remember that once an attacker</font>

337
00:13:37,370 --> 00:13:41,180
<font color="#E5E5E5">has 80 admin credentials</font><font color="#CCCCCC"> it's game over</font>

338
00:13:39,230 --> 00:13:43,490
<font color="#E5E5E5">they don't necessarily need to</font><font color="#CCCCCC"> go</font>

339
00:13:41,180 --> 00:13:45,378
through the MFA system and definitely

340
00:13:43,490 --> 00:13:47,059
walk through the potential bypass

341
00:13:45,379 --> 00:13:47,600
methods and implement mitigations and

342
00:13:47,059 --> 00:13:49,610
detections

343
00:13:47,600 --> 00:13:51,079
<font color="#E5E5E5">because it's entirely possible that</font>

344
00:13:49,610 --> 00:13:53,029
someone could social engineer their way

345
00:13:51,079 --> 00:13:54,739
into switching<font color="#E5E5E5"> a phone number some other</font>

346
00:13:53,029 --> 00:13:58,610
method through the<font color="#CCCCCC"> help desk</font><font color="#E5E5E5"> or some</font>

347
00:13:54,740 --> 00:14:01,370
other way or<font color="#E5E5E5"> a different MFA app on</font>

348
00:13:58,610 --> 00:14:03,019
<font color="#CCCCCC">their</font><font color="#E5E5E5"> - on their device people lose</font>

349
00:14:01,370 --> 00:14:05,120
phones all the<font color="#CCCCCC"> time</font><font color="#E5E5E5"> people have</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> get a</font>

350
00:14:03,019 --> 00:14:08,779
new phone configured<font color="#E5E5E5"> sometimes they end</font>

351
00:14:05,120 --> 00:14:11,360
<font color="#E5E5E5">up changing numbers so does em if they</font>

352
00:14:08,779 --> 00:14:13,189
have value<font color="#E5E5E5"> absolutely please</font><font color="#CCCCCC"> please MFA</font>

353
00:14:11,360 --> 00:14:14,930
all the things<font color="#E5E5E5"> just understand</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> it's</font>

354
00:14:13,189 --> 00:14:16,969
not a silver<font color="#CCCCCC"> bullet</font><font color="#E5E5E5"> and that</font><font color="#CCCCCC"> there are</font>

355
00:14:14,930 --> 00:14:18,500
<font color="#E5E5E5">things that that can be used to bypass</font>

356
00:14:16,970 --> 00:14:23,930
<font color="#E5E5E5">it depending on the specific</font>

357
00:14:18,500 --> 00:14:25,790
configuration password<font color="#CCCCCC"> boss</font><font color="#E5E5E5"> so I see</font>

358
00:14:23,930 --> 00:14:27,888
password vault being deployed more and

359
00:14:25,790 --> 00:14:31,189
more as<font color="#CCCCCC"> Enterprise password vaults</font><font color="#E5E5E5"> and</font>

360
00:14:27,889 --> 00:14:32,930
as a way to provide more secure

361
00:14:31,189 --> 00:14:35,449
administration typically like I said

362
00:14:32,930 --> 00:14:36,620
cyber-ark<font color="#CCCCCC"> a</font><font color="#E5E5E5"> psychotic secret server and</font>

363
00:14:35,449 --> 00:14:39,410
they often<font color="#CCCCCC"> have what they call a</font>

364
00:14:36,620 --> 00:14:42,889
reconciliation account which is very

365
00:14:39,410 --> 00:14:44,360
often<font color="#E5E5E5"> a domain admin that has the</font>

366
00:14:42,889 --> 00:14:46,309
ability<font color="#CCCCCC"> to bring</font><font color="#E5E5E5"> these accounts back</font>

367
00:14:44,360 --> 00:14:47,930
into control<font color="#E5E5E5"> so if you have an account</font>

368
00:14:46,309 --> 00:14:49,879
that's stored<font color="#E5E5E5"> in that password vault</font>

369
00:14:47,930 --> 00:14:50,899
<font color="#E5E5E5">managed by that password vault what ends</font>

370
00:14:49,879 --> 00:14:52,309
up<font color="#CCCCCC"> happening is that reconciliation</font>

371
00:14:50,899 --> 00:14:55,069
account will check to<font color="#E5E5E5"> see</font><font color="#CCCCCC"> if the</font>

372
00:14:52,309 --> 00:14:57,439
<font color="#CCCCCC">password</font><font color="#E5E5E5"> is what it has for</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> account</font>

373
00:14:55,069 --> 00:14:58,849
<font color="#E5E5E5">in its vault and if it's different it</font>

374
00:14:57,439 --> 00:15:01,819
will reach out<font color="#E5E5E5"> and automatically change</font>

375
00:14:58,850 --> 00:15:04,160
that account password this means<font color="#E5E5E5"> that</font>

376
00:15:01,819 --> 00:15:06,319
very often<font color="#E5E5E5"> the password vault itself has</font>

377
00:15:04,160 --> 00:15:09,439
a<font color="#E5E5E5"> very highly privileged account in</font>

378
00:15:06,319 --> 00:15:11,959
Active Directory<font color="#CCCCCC"> and it maintains ad</font>

379
00:15:09,439 --> 00:15:14,929
admin accounts in addition to that<font color="#E5E5E5"> a lot</font>

380
00:15:11,959 --> 00:15:16,399
<font color="#CCCCCC">of the time and there might also be</font>

381
00:15:14,929 --> 00:15:17,809
<font color="#E5E5E5">additional components like</font><font color="#CCCCCC"> assessing</font>

382
00:15:16,399 --> 00:15:19,279
session manager which I'll talk about in

383
00:15:17,809 --> 00:15:20,779
<font color="#E5E5E5">a minute</font><font color="#CCCCCC"> but here</font>

384
00:15:19,279 --> 00:15:22,370
one of the options<font color="#CCCCCC"> for an enterprise</font>

385
00:15:20,779 --> 00:15:24,920
password vault that we see pretty

386
00:15:22,370 --> 00:15:26,300
commonly check out the<font color="#E5E5E5"> credential so we</font>

387
00:15:24,920 --> 00:15:27,349
have our workstation on<font color="#E5E5E5"> the left or</font>

388
00:15:26,300 --> 00:15:28,699
password vault in the middle<font color="#E5E5E5"> and our</font>

389
00:15:27,350 --> 00:15:32,660
admin server on the right that's<font color="#E5E5E5"> that</font>

390
00:15:28,699 --> 00:15:35,479
star<font color="#E5E5E5"> and so what we do is we connect to</font>

391
00:15:32,660 --> 00:15:37,219
<font color="#E5E5E5">the password vault and we via HTTP it's</font>

392
00:15:35,480 --> 00:15:41,050
just a website<font color="#E5E5E5"> and then we check out</font>

393
00:15:37,220 --> 00:15:43,519
<font color="#E5E5E5">that credential copy that password in</font>

394
00:15:41,050 --> 00:15:46,579
our clipboard<font color="#CCCCCC"> on our local</font><font color="#E5E5E5"> workstation</font>

395
00:15:43,519 --> 00:15:49,749
<font color="#E5E5E5">and then we paste it into our RDP login</font>

396
00:15:46,579 --> 00:15:53,410
window<font color="#CCCCCC"> and connect to</font><font color="#E5E5E5"> our admin server</font>

397
00:15:49,749 --> 00:15:56,300
it's fairly<font color="#E5E5E5"> common it happens a</font><font color="#CCCCCC"> lot so</font>

398
00:15:53,410 --> 00:15:57,769
<font color="#CCCCCC">what can be</font><font color="#E5E5E5"> done</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> this what can</font><font color="#CCCCCC"> I</font>

399
00:15:56,300 --> 00:16:01,040
do as an attacker<font color="#E5E5E5"> yeah and this</font><font color="#CCCCCC"> is a</font>

400
00:15:57,769 --> 00:16:02,990
regular<font color="#E5E5E5"> workstation so one</font><font color="#CCCCCC"> of the things</font>

401
00:16:01,040 --> 00:16:04,639
I<font color="#E5E5E5"> can do is I can set up</font><font color="#CCCCCC"> my sec</font><font color="#E5E5E5"> and</font>

402
00:16:02,990 --> 00:16:06,980
health check but this side<font color="#E5E5E5"> up time I'm</font>

403
00:16:04,639 --> 00:16:10,970
going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> use</font><font color="#E5E5E5"> something another function</font>

404
00:16:06,980 --> 00:16:17,420
from<font color="#CCCCCC"> powersploit called</font><font color="#E5E5E5"> get</font><font color="#CCCCCC"> x screenshot</font>

405
00:16:10,970 --> 00:16:19,279
or<font color="#CCCCCC"> actually meta myself get clipboard</font>

406
00:16:17,420 --> 00:16:21,019
contents so I'm going<font color="#E5E5E5"> to copy out</font><font color="#CCCCCC"> of the</font>

407
00:16:19,279 --> 00:16:23,480
clipboard<font color="#CCCCCC"> the contents that</font><font color="#E5E5E5"> are</font><font color="#CCCCCC"> there</font>

408
00:16:21,019 --> 00:16:25,279
and there's gonna<font color="#E5E5E5"> be another text file</font>

409
00:16:23,480 --> 00:16:27,050
<font color="#CCCCCC">that shows up on</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> computer and as you</font>

410
00:16:25,279 --> 00:16:28,939
can<font color="#E5E5E5"> see here every time</font><font color="#CCCCCC"> I copy something</font>

411
00:16:27,050 --> 00:16:30,859
<font color="#E5E5E5">into the clipboard that</font><font color="#CCCCCC"> PowerShell</font>

412
00:16:28,939 --> 00:16:32,410
function is just copying it from<font color="#CCCCCC"> the</font>

413
00:16:30,860 --> 00:16:34,610
clipboard directly to a text file

414
00:16:32,410 --> 00:16:37,699
<font color="#E5E5E5">constantly and over and over</font><font color="#CCCCCC"> again</font><font color="#E5E5E5"> and</font>

415
00:16:34,610 --> 00:16:38,959
through this method<font color="#E5E5E5"> the attacker ends up</font>

416
00:16:37,699 --> 00:16:39,529
<font color="#CCCCCC">getting that password</font><font color="#E5E5E5"> that's in the</font>

417
00:16:38,959 --> 00:16:40,878
<font color="#E5E5E5">password vault</font>

418
00:16:39,529 --> 00:16:42,199
<font color="#E5E5E5">now obviously the password well it's not</font>

419
00:16:40,879 --> 00:16:46,870
<font color="#E5E5E5">going to be creating</font><font color="#CCCCCC"> passwords like</font><font color="#E5E5E5"> this</font>

420
00:16:42,199 --> 00:16:49,550
but<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is blackhat it would be fun</font><font color="#E5E5E5"> and</font>

421
00:16:46,870 --> 00:16:51,379
<font color="#CCCCCC">then I could take that I</font><font color="#E5E5E5"> can look at</font><font color="#CCCCCC"> it</font>

422
00:16:49,550 --> 00:16:53,508
I can leverage<font color="#E5E5E5"> that account password but</font>

423
00:16:51,379 --> 00:16:55,610
how do I know what<font color="#E5E5E5"> the account name is</font>

424
00:16:53,509 --> 00:16:57,649
well<font color="#E5E5E5"> that's where that get time</font>

425
00:16:55,610 --> 00:16:59,990
screenshot function comes in<font color="#CCCCCC"> that</font><font color="#E5E5E5"> I was</font>

426
00:16:57,649 --> 00:17:01,730
mentioning<font color="#E5E5E5"> a little earlier because then</font>

427
00:16:59,990 --> 00:17:05,839
what I<font color="#E5E5E5"> can do is have screenshots of</font>

428
00:17:01,730 --> 00:17:08,149
<font color="#E5E5E5">what shows up and then correlate that</font>

429
00:17:05,839 --> 00:17:09,980
with what's in<font color="#E5E5E5"> the clipboard</font><font color="#CCCCCC"> and I can</font>

430
00:17:08,148 --> 00:17:12,198
use a<font color="#CCCCCC"> WMI implant to this</font>

431
00:17:09,980 --> 00:17:14,419
so there's malware out<font color="#E5E5E5"> there right now</font>

432
00:17:12,199 --> 00:17:16,939
<font color="#CCCCCC">that</font><font color="#E5E5E5"> is monitoring the webpage</font><font color="#CCCCCC"> that</font>

433
00:17:14,419 --> 00:17:19,939
people go to<font color="#CCCCCC"> by via the title</font><font color="#E5E5E5"> it looks</font>

434
00:17:16,939 --> 00:17:25,189
for financial website names it looks for

435
00:17:19,939 --> 00:17:26,510
certain<font color="#E5E5E5"> types of title keywords you do</font>

436
00:17:25,189 --> 00:17:28,280
something<font color="#E5E5E5"> very</font><font color="#CCCCCC"> similar I can look</font><font color="#E5E5E5"> for</font>

437
00:17:26,510 --> 00:17:30,289
cyber-ark or<font color="#E5E5E5"> psychotic or</font><font color="#CCCCCC"> something like</font>

438
00:17:28,280 --> 00:17:33,040
that<font color="#CCCCCC"> and when that happens through my</font>

439
00:17:30,289 --> 00:17:35,230
<font color="#CCCCCC">WMI implant I can kick off these power</font>

440
00:17:33,040 --> 00:17:37,149
<font color="#CCCCCC">so components or something that</font><font color="#E5E5E5"> I custom</font>

441
00:17:35,230 --> 00:17:40,270
write with in c-sharp<font color="#CCCCCC"> to do the same</font>

442
00:17:37,150 --> 00:17:41,740
thing and capture this<font color="#E5E5E5"> data</font><font color="#CCCCCC"> so we want</font>

443
00:17:40,270 --> 00:17:44,410
to be very<font color="#E5E5E5"> careful what systems we're</font>

444
00:17:41,740 --> 00:17:46,090
connecting to a<font color="#E5E5E5"> password vault from</font><font color="#CCCCCC"> ok</font>

445
00:17:44,410 --> 00:17:48,160
<font color="#E5E5E5">well there's a different</font><font color="#CCCCCC"> way</font><font color="#E5E5E5"> to do this</font>

446
00:17:46,090 --> 00:17:49,990
<font color="#CCCCCC">all right the RDP proxy approach</font><font color="#E5E5E5"> which</font>

447
00:17:48,160 --> 00:17:52,120
is where we<font color="#E5E5E5"> have the password vault</font>

448
00:17:49,990 --> 00:17:53,770
sitting in the middle we<font color="#CCCCCC"> have our</font>

449
00:17:52,120 --> 00:17:56,889
<font color="#E5E5E5">workstation we're connecting to the</font>

450
00:17:53,770 --> 00:17:58,210
password<font color="#CCCCCC"> wall via HTTPS we then connect</font>

451
00:17:56,890 --> 00:18:01,030
from the password vault to<font color="#E5E5E5"> the admin</font>

452
00:17:58,210 --> 00:18:03,790
<font color="#E5E5E5">server via RDP and the password involved</font>

453
00:18:01,030 --> 00:18:05,649
is providing that<font color="#E5E5E5"> proxy that RDP proxy</font>

454
00:18:03,790 --> 00:18:08,230
and<font color="#E5E5E5"> the</font><font color="#CCCCCC"> password vault has the</font>

455
00:18:05,650 --> 00:18:09,400
<font color="#E5E5E5">credentials the admin themselves don't</font>

456
00:18:08,230 --> 00:18:11,380
<font color="#E5E5E5">have the credentials don't know what the</font>

457
00:18:09,400 --> 00:18:12,640
credentials are<font color="#E5E5E5"> password vault is doing</font>

458
00:18:11,380 --> 00:18:14,560
that entirely so it's a complete

459
00:18:12,640 --> 00:18:16,180
password and a lot of the password

460
00:18:14,560 --> 00:18:19,179
<font color="#CCCCCC">Volt's now have the ability to do</font>

461
00:18:16,180 --> 00:18:21,160
<font color="#E5E5E5">session recording as</font><font color="#CCCCCC"> well although</font><font color="#E5E5E5"> I've</font>

462
00:18:19,180 --> 00:18:22,780
<font color="#CCCCCC">never actually heard</font><font color="#E5E5E5"> of someone having a</font>

463
00:18:21,160 --> 00:18:24,790
good plan<font color="#CCCCCC"> for like</font><font color="#E5E5E5"> going back</font><font color="#CCCCCC"> and</font>

464
00:18:22,780 --> 00:18:27,639
<font color="#CCCCCC">watching sessions</font><font color="#E5E5E5"> or randomly looking at</font>

465
00:18:24,790 --> 00:18:29,470
them but it's there but a couple

466
00:18:27,640 --> 00:18:32,260
<font color="#CCCCCC">questions with</font><font color="#E5E5E5"> this approach</font><font color="#CCCCCC"> first</font><font color="#E5E5E5"> of</font>

467
00:18:29,470 --> 00:18:34,000
<font color="#E5E5E5">all what account is</font><font color="#CCCCCC"> used to log</font><font color="#E5E5E5"> on to</font>

468
00:18:32,260 --> 00:18:36,370
that workstation<font color="#CCCCCC"> it's very often a user</font>

469
00:18:34,000 --> 00:18:37,630
<font color="#E5E5E5">and then what account is</font><font color="#CCCCCC"> used to log on</font>

470
00:18:36,370 --> 00:18:40,209
to this password<font color="#CCCCCC"> vault that then has</font>

471
00:18:37,630 --> 00:18:44,110
access<font color="#CCCCCC"> to</font><font color="#E5E5E5"> this highly privileged admin</font>

472
00:18:40,210 --> 00:18:46,620
account it's<font color="#E5E5E5"> often also a user and as</font>

473
00:18:44,110 --> 00:18:49,330
<font color="#CCCCCC">mfa used to protect that authentication</font>

474
00:18:46,620 --> 00:18:51,010
<font color="#E5E5E5">and what about the administration who's</font>

475
00:18:49,330 --> 00:18:53,080
administering<font color="#E5E5E5"> the server this</font><font color="#CCCCCC"> password</font>

476
00:18:51,010 --> 00:18:56,590
vault server that<font color="#CCCCCC"> contains all of these</font>

477
00:18:53,080 --> 00:18:58,000
very critical<font color="#E5E5E5"> credentials</font><font color="#CCCCCC"> and what about</font>

478
00:18:56,590 --> 00:18:59,970
the network communications<font color="#E5E5E5"> are we</font>

479
00:18:58,000 --> 00:19:02,620
limiting access to<font color="#E5E5E5"> this password vault</font>

480
00:18:59,970 --> 00:19:03,730
<font color="#E5E5E5">most of the time there's no limitations</font>

481
00:19:02,620 --> 00:19:07,199
on<font color="#E5E5E5"> the network to connect to the</font>

482
00:19:03,730 --> 00:19:10,000
<font color="#E5E5E5">password vault and a lot of</font><font color="#CCCCCC"> the times</font>

483
00:19:07,200 --> 00:19:12,000
<font color="#CCCCCC">people</font><font color="#E5E5E5"> are</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> accessing the password</font>

484
00:19:10,000 --> 00:19:14,710
vault<font color="#E5E5E5"> using their standard web</font><font color="#CCCCCC"> browser</font>

485
00:19:12,000 --> 00:19:16,900
which has all of<font color="#E5E5E5"> the other things</font><font color="#CCCCCC"> that</font>

486
00:19:14,710 --> 00:19:18,880
<font color="#E5E5E5">are usually in a web</font><font color="#CCCCCC"> browser so what are</font>

487
00:19:16,900 --> 00:19:21,490
the extensions what are the settings<font color="#E5E5E5"> how</font>

488
00:19:18,880 --> 00:19:23,140
is that web browser configured what if I

489
00:19:21,490 --> 00:19:24,640
<font color="#E5E5E5">compromised the web browser</font><font color="#CCCCCC"> how could</font>

490
00:19:23,140 --> 00:19:26,290
<font color="#E5E5E5">might be an interesting way</font><font color="#CCCCCC"> that I</font>

491
00:19:24,640 --> 00:19:28,330
compromised the pastor<font color="#CCCCCC"> vault connection</font>

492
00:19:26,290 --> 00:19:31,690
<font color="#E5E5E5">from that because it's all web at that</font>

493
00:19:28,330 --> 00:19:33,250
point one thing<font color="#E5E5E5"> to think about is should</font>

494
00:19:31,690 --> 00:19:34,540
we<font color="#E5E5E5"> be</font><font color="#CCCCCC"> using</font><font color="#E5E5E5"> a separate browser when</font>

495
00:19:33,250 --> 00:19:37,720
we're connecting to a<font color="#CCCCCC"> password vault</font>

496
00:19:34,540 --> 00:19:41,190
well maybe the other thing I see too

497
00:19:37,720 --> 00:19:43,930
often<font color="#CCCCCC"> is a situation where there's a</font>

498
00:19:41,190 --> 00:19:45,700
password vault<font color="#E5E5E5"> admins group in Active</font>

499
00:19:43,930 --> 00:19:46,260
Directory<font color="#CCCCCC"> and when I enumerate the</font>

500
00:19:45,700 --> 00:19:48,720
membership

501
00:19:46,260 --> 00:19:52,050
that every member<font color="#E5E5E5"> or most members are</font>

502
00:19:48,720 --> 00:19:53,670
regular users anyone see a problem<font color="#CCCCCC"> with</font>

503
00:19:52,050 --> 00:19:58,020
this<font color="#CCCCCC"> I</font><font color="#E5E5E5"> certainly do</font>

504
00:19:53,670 --> 00:20:00,150
these are the admins<font color="#E5E5E5"> for the vault the</font>

505
00:19:58,020 --> 00:20:02,340
other problem I've discovered is thanks

506
00:20:00,150 --> 00:20:04,770
to my friend<font color="#E5E5E5"> show Dan they were able to</font>

507
00:20:02,340 --> 00:20:07,830
tell me<font color="#CCCCCC"> that there's cyber-ark password</font>

508
00:20:04,770 --> 00:20:08,810
vaults on the<font color="#CCCCCC"> internet which could be</font>

509
00:20:07,830 --> 00:20:12,510
<font color="#E5E5E5">okay</font>

510
00:20:08,810 --> 00:20:13,889
probably not<font color="#E5E5E5"> it all depends on what sort</font>

511
00:20:12,510 --> 00:20:17,400
of data and credentials are<font color="#CCCCCC"> there being</font>

512
00:20:13,890 --> 00:20:19,410
stored in them<font color="#E5E5E5"> and I happen to find one</font>

513
00:20:17,400 --> 00:20:23,100
that's<font color="#E5E5E5"> a little bit older</font><font color="#CCCCCC"> which</font><font color="#E5E5E5"> is very</font>

514
00:20:19,410 --> 00:20:25,230
concerning<font color="#CCCCCC"> we'll</font><font color="#E5E5E5"> talk</font><font color="#CCCCCC"> about in a bit</font><font color="#E5E5E5"> so</font>

515
00:20:23,100 --> 00:20:26,820
when we talk<font color="#CCCCCC"> about the password vault</font><font color="#E5E5E5"> we</font>

516
00:20:25,230 --> 00:20:28,470
need to look at the potential weaknesses

517
00:20:26,820 --> 00:20:29,820
in the way that it's configured<font color="#E5E5E5"> so</font>

518
00:20:28,470 --> 00:20:32,850
authentication to the web servers

519
00:20:29,820 --> 00:20:36,210
<font color="#E5E5E5">typically a user account MFA or not</font>

520
00:20:32,850 --> 00:20:38,129
<font color="#CCCCCC">maybe these</font><font color="#E5E5E5"> are often administered</font><font color="#CCCCCC"> like</font>

521
00:20:36,210 --> 00:20:40,350
any other server so server admins has

522
00:20:38,130 --> 00:20:42,990
full admin rights on them and the

523
00:20:40,350 --> 00:20:45,030
sessions that<font color="#CCCCCC"> are created by</font><font color="#E5E5E5"> the admins</font>

524
00:20:42,990 --> 00:20:47,790
<font color="#CCCCCC">to connect</font><font color="#E5E5E5"> to the password</font><font color="#CCCCCC"> vault</font><font color="#E5E5E5"> are not</font>

525
00:20:45,030 --> 00:20:51,629
<font color="#E5E5E5">always limited to one they should be</font>

526
00:20:47,790 --> 00:20:53,909
limited and a vulnerability<font color="#CCCCCC"> and the</font>

527
00:20:51,630 --> 00:20:56,970
password vault<font color="#E5E5E5"> can compromise the</font>

528
00:20:53,910 --> 00:21:00,210
directory entirely so just a<font color="#E5E5E5"> few months</font>

529
00:20:56,970 --> 00:21:04,410
<font color="#E5E5E5">ago in April with</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> CVD at the top 20</font>

530
00:21:00,210 --> 00:21:06,510
<font color="#E5E5E5">18 9 8 4</font><font color="#CCCCCC"> 3</font><font color="#E5E5E5"> there was a serialized dotnet</font>

531
00:21:04,410 --> 00:21:09,630
object vulnerability and the<font color="#E5E5E5"> way that</font>

532
00:21:06,510 --> 00:21:12,180
<font color="#E5E5E5">cyber-ark was handling the</font><font color="#CCCCCC"> API on the</font>

533
00:21:09,630 --> 00:21:13,680
<font color="#E5E5E5">password web server so just for those</font>

534
00:21:12,180 --> 00:21:14,940
<font color="#CCCCCC">who have</font><font color="#E5E5E5"> cyber-ark if you haven't</font>

535
00:21:13,680 --> 00:21:16,740
patched<font color="#E5E5E5"> it since April I highly</font>

536
00:21:14,940 --> 00:21:19,440
recommend you like message someone and

537
00:21:16,740 --> 00:21:22,680
do that today<font color="#E5E5E5"> because what this did</font><font color="#CCCCCC"> was</font>

538
00:21:19,440 --> 00:21:26,070
it enabled the<font color="#CCCCCC"> ability to run arbitrary</font>

539
00:21:22,680 --> 00:21:29,670
<font color="#E5E5E5">code on that vault and the proof of</font>

540
00:21:26,070 --> 00:21:30,629
concept is simply<font color="#CCCCCC"> just running ping</font><font color="#E5E5E5"> but</font>

541
00:21:29,670 --> 00:21:32,100
you can see that there's a very

542
00:21:30,630 --> 00:21:33,930
<font color="#E5E5E5">interesting escalation process</font><font color="#CCCCCC"> that</font>

543
00:21:32,100 --> 00:21:37,500
<font color="#E5E5E5">could be done here</font><font color="#CCCCCC"> because</font><font color="#E5E5E5"> the password</font>

544
00:21:33,930 --> 00:21:39,570
vault<font color="#CCCCCC"> web server</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> the one that proxies</font>

545
00:21:37,500 --> 00:21:42,480
<font color="#CCCCCC">our brokers that request</font><font color="#E5E5E5"> from the user</font>

546
00:21:39,570 --> 00:21:44,159
and identifies which password vaults

547
00:21:42,480 --> 00:21:46,740
they have access<font color="#E5E5E5"> to which credentials</font>

548
00:21:44,160 --> 00:21:49,230
<font color="#E5E5E5">that user has access to we can modify</font>

549
00:21:46,740 --> 00:21:52,040
that<font color="#CCCCCC"> if we can change</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> we can do a</font>

550
00:21:49,230 --> 00:21:52,040
lot of<font color="#E5E5E5"> really</font><font color="#CCCCCC"> interesting things</font>

551
00:21:52,150 --> 00:21:59,970
what<font color="#CCCCCC"> about the admin force so there's</font>

552
00:21:58,690 --> 00:22:02,560
been a lot of talk in<font color="#E5E5E5"> recent years about</font>

553
00:21:59,970 --> 00:22:04,540
the red forest<font color="#E5E5E5"> or the admin forest or</font>

554
00:22:02,560 --> 00:22:07,450
<font color="#CCCCCC">the</font><font color="#E5E5E5"> ESA</font><font color="#CCCCCC"> e et cetera et cetera et cetera</font>

555
00:22:04,540 --> 00:22:09,100
so<font color="#E5E5E5"> the</font><font color="#CCCCCC"> whole concept is that we're going</font>

556
00:22:07,450 --> 00:22:11,380
<font color="#E5E5E5">to take our production</font><font color="#CCCCCC"> eighty forest</font>

557
00:22:09,100 --> 00:22:13,060
<font color="#E5E5E5">we're going to take all of our</font><font color="#CCCCCC"> 80 admins</font>

558
00:22:11,380 --> 00:22:15,370
<font color="#E5E5E5">and we're going to move them into this</font>

559
00:22:13,060 --> 00:22:16,780
<font color="#E5E5E5">other 80 forest we're going to</font>

560
00:22:15,370 --> 00:22:19,090
completely lock down this<font color="#E5E5E5"> other 80</font>

561
00:22:16,780 --> 00:22:21,700
forest<font color="#CCCCCC"> we're going to make sure</font><font color="#E5E5E5"> that</font>

562
00:22:19,090 --> 00:22:23,139
only<font color="#E5E5E5"> our 80 admins are over in</font><font color="#CCCCCC"> this</font>

563
00:22:21,700 --> 00:22:26,530
forest<font color="#E5E5E5"> and they're well protected we're</font>

564
00:22:23,140 --> 00:22:28,210
going to have network configuration

565
00:22:26,530 --> 00:22:30,160
where nothing<font color="#E5E5E5"> else can connect to it</font>

566
00:22:28,210 --> 00:22:32,110
<font color="#E5E5E5">except the authorized systems we're</font>

567
00:22:30,160 --> 00:22:33,370
going to<font color="#E5E5E5"> ensure that it's encrypted</font><font color="#CCCCCC"> the</font>

568
00:22:32,110 --> 00:22:35,199
network<font color="#CCCCCC"> communication</font><font color="#E5E5E5"> is encrypted</font><font color="#CCCCCC"> were</font>

569
00:22:33,370 --> 00:22:37,419
gonna have a one-way<font color="#CCCCCC"> trust so that way</font>

570
00:22:35,200 --> 00:22:42,220
production<font color="#E5E5E5"> ad</font><font color="#CCCCCC"> environment trusts this</font>

571
00:22:37,420 --> 00:22:43,900
admin<font color="#CCCCCC"> forest we're gonna have a group in</font>

572
00:22:42,220 --> 00:22:45,790
<font color="#E5E5E5">this admin forest that is</font><font color="#CCCCCC"> a member of</font>

573
00:22:43,900 --> 00:22:48,310
the administrators<font color="#CCCCCC"> group and active</font>

574
00:22:45,790 --> 00:22:52,270
<font color="#CCCCCC">directory and</font><font color="#E5E5E5"> the production ad and only</font>

575
00:22:48,310 --> 00:22:54,760
these admin<font color="#E5E5E5"> forced accounts are members</font>

576
00:22:52,270 --> 00:22:56,410
of<font color="#E5E5E5"> that of that group and we're going to</font>

577
00:22:54,760 --> 00:22:58,210
<font color="#E5E5E5">make</font><font color="#CCCCCC"> sure that that</font><font color="#E5E5E5"> those accounts in</font>

578
00:22:56,410 --> 00:23:00,070
that group that<font color="#E5E5E5"> are in this admin force</font>

579
00:22:58,210 --> 00:23:01,930
<font color="#E5E5E5">don't have any admin rights of the admin</font>

580
00:23:00,070 --> 00:23:03,939
force and aren't even<font color="#CCCCCC"> in that group all</font>

581
00:23:01,930 --> 00:23:06,700
the time<font color="#E5E5E5"> so the only</font><font color="#CCCCCC"> way</font><font color="#E5E5E5"> to administer</font>

582
00:23:03,940 --> 00:23:09,550
<font color="#E5E5E5">this ad environment according to this is</font>

583
00:23:06,700 --> 00:23:11,890
through<font color="#E5E5E5"> this admin</font><font color="#CCCCCC"> forest account</font><font color="#E5E5E5"> which</font>

584
00:23:09,550 --> 00:23:15,760
<font color="#CCCCCC">oftentimes</font><font color="#E5E5E5"> is using PGI and separate</font>

585
00:23:11,890 --> 00:23:17,380
management<font color="#CCCCCC"> completely separate it</font><font color="#E5E5E5"> so I</font>

586
00:23:15,760 --> 00:23:19,420
have a<font color="#E5E5E5"> slide here which talks about what</font>

587
00:23:17,380 --> 00:23:21,820
I<font color="#CCCCCC"> just</font><font color="#E5E5E5"> said you can look at the slides</font>

588
00:23:19,420 --> 00:23:25,690
later<font color="#CCCCCC"> but beyond 80 security out org</font>

589
00:23:21,820 --> 00:23:28,929
after the talk but there's some pros and

590
00:23:25,690 --> 00:23:31,030
cons<font color="#E5E5E5"> with admin force the pros are that</font>

591
00:23:28,930 --> 00:23:33,130
<font color="#E5E5E5">we</font><font color="#CCCCCC"> are effectively isolating our</font><font color="#E5E5E5"> ad</font>

592
00:23:31,030 --> 00:23:34,270
admin credentials<font color="#E5E5E5"> into a separate force</font>

593
00:23:33,130 --> 00:23:37,870
where they're very<font color="#CCCCCC"> difficult to get</font><font color="#E5E5E5"> to</font>

594
00:23:34,270 --> 00:23:39,970
<font color="#E5E5E5">and when deployed properly it can be</font>

595
00:23:37,870 --> 00:23:43,060
effective in limiting access<font color="#E5E5E5"> to these</font><font color="#CCCCCC"> ad</font>

596
00:23:39,970 --> 00:23:45,490
privileged accounts sounds really<font color="#E5E5E5"> good</font>

597
00:23:43,060 --> 00:23:48,820
where do I sign<font color="#E5E5E5"> up well there's some</font>

598
00:23:45,490 --> 00:23:51,250
<font color="#CCCCCC">challenges with</font><font color="#E5E5E5"> this first one</font><font color="#CCCCCC"> is it's</font>

599
00:23:48,820 --> 00:23:53,770
<font color="#E5E5E5">expensive to deploy an admin force is</font>

600
00:23:51,250 --> 00:23:55,330
<font color="#E5E5E5">effectively increasing your management</font>

601
00:23:53,770 --> 00:23:57,700
<font color="#E5E5E5">overhead</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> cost because you are</font>

602
00:23:55,330 --> 00:23:59,530
duplicating your<font color="#E5E5E5"> infrastructure you're</font>

603
00:23:57,700 --> 00:24:01,140
setting up new DCs<font color="#E5E5E5"> technically they're</font>

604
00:23:59,530 --> 00:24:02,950
all<font color="#E5E5E5"> supposed to be physical by the way</font>

605
00:24:01,140 --> 00:24:05,230
they're supposed<font color="#CCCCCC"> to be</font><font color="#E5E5E5"> managed</font><font color="#CCCCCC"> by a</font>

606
00:24:02,950 --> 00:24:05,860
separate system any security tooling and

607
00:24:05,230 --> 00:24:07,450
management

608
00:24:05,860 --> 00:24:10,209
<font color="#E5E5E5">are supposed to be duplicated</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> that</font>

609
00:24:07,450 --> 00:24:11,830
environment<font color="#CCCCCC"> and anyone that logs into</font>

610
00:24:10,210 --> 00:24:14,679
<font color="#E5E5E5">that admin</font><font color="#CCCCCC"> force environment is supposed</font>

611
00:24:11,830 --> 00:24:16,928
<font color="#E5E5E5">to use</font><font color="#CCCCCC"> a PKI card which has a separate</font>

612
00:24:14,679 --> 00:24:18,880
<font color="#CCCCCC">PGI from your standard PCI configuration</font>

613
00:24:16,929 --> 00:24:21,039
<font color="#CCCCCC">but</font><font color="#E5E5E5"> ultimately it doesn't fix your</font>

614
00:24:18,880 --> 00:24:24,580
production<font color="#E5E5E5"> 80 issues if you have</font>

615
00:24:21,039 --> 00:24:26,200
security<font color="#E5E5E5"> issues misconfigurations if</font><font color="#CCCCCC"> you</font>

616
00:24:24,580 --> 00:24:27,789
delegation that<font color="#CCCCCC"> you set ten years ago</font>

617
00:24:26,200 --> 00:24:29,500
<font color="#E5E5E5">and everyone's forgotten about it and so</font>

618
00:24:27,789 --> 00:24:32,080
there's like four accounts in<font color="#CCCCCC"> your</font>

619
00:24:29,500 --> 00:24:34,960
environment<font color="#CCCCCC"> that</font><font color="#E5E5E5"> have like</font><font color="#CCCCCC"> the two steps</font>

620
00:24:32,080 --> 00:24:37,720
from<font color="#E5E5E5"> da but no one knows about it this</font>

621
00:24:34,960 --> 00:24:40,029
isn't<font color="#CCCCCC"> going</font><font color="#E5E5E5"> to solve</font><font color="#CCCCCC"> that in most</font>

622
00:24:37,720 --> 00:24:42,639
<font color="#E5E5E5">organizations we also have</font><font color="#CCCCCC"> workstation</font>

623
00:24:40,029 --> 00:24:44,799
admins and<font color="#E5E5E5"> server admins guess what</font>

624
00:24:42,639 --> 00:24:46,510
attackers don't need domain admin rights

625
00:24:44,799 --> 00:24:48,519
they don't need<font color="#E5E5E5"> act directory admin</font>

626
00:24:46,510 --> 00:24:50,710
rights<font color="#E5E5E5"> all they want is access to</font><font color="#CCCCCC"> data</font>

627
00:24:48,519 --> 00:24:52,360
access to<font color="#E5E5E5"> system so if they can</font>

628
00:24:50,710 --> 00:24:57,539
<font color="#E5E5E5">compromise a workstation admin or a</font>

629
00:24:52,360 --> 00:24:57,539
server admin or both they can get<font color="#CCCCCC"> that</font>

630
00:24:59,820 --> 00:25:04,980
the<font color="#E5E5E5"> other thing is what about your</font>

631
00:25:02,080 --> 00:25:07,360
production<font color="#E5E5E5"> ad</font><font color="#CCCCCC"> privileged serves counts</font>

632
00:25:04,980 --> 00:25:09,190
<font color="#E5E5E5">so technically as part of this whole</font>

633
00:25:07,360 --> 00:25:11,199
<font color="#E5E5E5">admin force we're supposed to take those</font>

634
00:25:09,190 --> 00:25:13,419
<font color="#CCCCCC">privileged service accounts and remove</font>

635
00:25:11,200 --> 00:25:15,250
them<font color="#E5E5E5"> just take them out</font><font color="#CCCCCC"> of domain admins</font>

636
00:25:13,419 --> 00:25:17,289
<font color="#E5E5E5">take them out of administrators just</font>

637
00:25:15,250 --> 00:25:19,929
<font color="#E5E5E5">make them regular users delegate the</font>

638
00:25:17,289 --> 00:25:22,299
rights out most<font color="#E5E5E5"> of the customers I</font>

639
00:25:19,929 --> 00:25:24,220
talked to can't just do that and so

640
00:25:22,299 --> 00:25:26,700
these service<font color="#E5E5E5"> accounts that are highly</font>

641
00:25:24,220 --> 00:25:28,809
privileged ended up sticking around<font color="#E5E5E5"> and</font>

642
00:25:26,700 --> 00:25:30,760
so it's part of the admin force

643
00:25:28,809 --> 00:25:32,529
implementation<font color="#E5E5E5"> you're supposed to assume</font>

644
00:25:30,760 --> 00:25:35,769
breach that's our mantra<font color="#CCCCCC"> assume breach</font>

645
00:25:32,529 --> 00:25:37,600
right we need to<font color="#E5E5E5"> check the environment</font>

646
00:25:35,769 --> 00:25:39,370
to ensure<font color="#E5E5E5"> it's configured correctly</font>

647
00:25:37,600 --> 00:25:41,678
there aren't any of these obvious miss

648
00:25:39,370 --> 00:25:42,580
configurations<font color="#E5E5E5"> but what if it's</font>

649
00:25:41,679 --> 00:25:44,260
compromised

650
00:25:42,580 --> 00:25:45,970
what is this admin force actually<font color="#E5E5E5"> going</font>

651
00:25:44,260 --> 00:25:47,230
to<font color="#CCCCCC"> by</font><font color="#E5E5E5"> us especially</font><font color="#CCCCCC"> when</font><font color="#E5E5E5"> we have to</font>

652
00:25:45,970 --> 00:25:50,919
assume<font color="#E5E5E5"> that there's an</font><font color="#CCCCCC"> active attacker</font>

653
00:25:47,230 --> 00:25:52,269
<font color="#E5E5E5">on the network well not much because all</font>

654
00:25:50,919 --> 00:25:54,519
we're doing<font color="#E5E5E5"> is shifting</font><font color="#CCCCCC"> the admin</font>

655
00:25:52,269 --> 00:25:57,639
accounts that are known<font color="#E5E5E5"> in to our admin</font>

656
00:25:54,519 --> 00:25:58,899
<font color="#CCCCCC">forest</font><font color="#E5E5E5"> and any of the sneaky persistent</font>

657
00:25:57,639 --> 00:26:02,080
methods that<font color="#E5E5E5"> happen to be in the</font>

658
00:25:58,899 --> 00:26:03,219
environment<font color="#CCCCCC"> maybe someone is pretending</font>

659
00:26:02,080 --> 00:26:05,289
<font color="#E5E5E5">to be a domain controller</font><font color="#CCCCCC"> in the</font>

660
00:26:03,220 --> 00:26:06,190
environment that<font color="#E5E5E5"> Vincent and and</font>

661
00:26:05,289 --> 00:26:08,279
Benjamin are going to talk about

662
00:26:06,190 --> 00:26:10,690
<font color="#CCCCCC">tomorrow in the DC</font><font color="#E5E5E5"> shadow talk</font>

663
00:26:08,279 --> 00:26:12,519
that's not admin force<font color="#E5E5E5"> isn't going to</font>

664
00:26:10,690 --> 00:26:14,350
<font color="#CCCCCC">help us</font><font color="#E5E5E5"> from that so what should be</font><font color="#CCCCCC"> done</font>

665
00:26:12,519 --> 00:26:16,090
<font color="#CCCCCC">first these are questions and concerns</font>

666
00:26:14,350 --> 00:26:17,289
when you're going<font color="#E5E5E5"> to spend a lot</font><font color="#CCCCCC"> of</font>

667
00:26:16,090 --> 00:26:18,850
<font color="#E5E5E5">money on an admin force because</font>

668
00:26:17,289 --> 00:26:20,010
ultimately it's been<font color="#CCCCCC"> billed</font><font color="#E5E5E5"> a lot of the</font>

669
00:26:18,850 --> 00:26:21,540
times as the solution

670
00:26:20,010 --> 00:26:23,730
<font color="#E5E5E5">- your act directory security problems</font>

671
00:26:21,540 --> 00:26:25,320
<font color="#CCCCCC">and attackers can figure out</font><font color="#E5E5E5"> if you</font><font color="#CCCCCC"> have</font>

672
00:26:23,730 --> 00:26:27,000
an admin force it's pretty<font color="#E5E5E5"> easy we</font><font color="#CCCCCC"> just</font>

673
00:26:25,320 --> 00:26:28,560
look at<font color="#E5E5E5"> the trust membership and we</font>

674
00:26:27,000 --> 00:26:30,180
<font color="#E5E5E5">might see something that</font><font color="#CCCCCC"> looks like this</font>

675
00:26:28,560 --> 00:26:32,909
and we're<font color="#E5E5E5"> definitely going to see</font>

676
00:26:30,180 --> 00:26:35,100
<font color="#CCCCCC">another forest group that's in our</font>

677
00:26:32,910 --> 00:26:39,360
admins group for our<font color="#E5E5E5"> Active Directory</font>

678
00:26:35,100 --> 00:26:43,290
forest<font color="#E5E5E5"> so it's gonna be pretty</font><font color="#CCCCCC"> obvious</font>

679
00:26:39,360 --> 00:26:44,689
when we<font color="#E5E5E5"> have that how effective is the</font>

680
00:26:43,290 --> 00:26:46,980
admin<font color="#CCCCCC"> forest</font>

681
00:26:44,690 --> 00:26:49,250
well the deployment often ignores the

682
00:26:46,980 --> 00:26:51,330
production ad environment issues

683
00:26:49,250 --> 00:26:52,980
<font color="#E5E5E5">organization is usually very quick to</font>

684
00:26:51,330 --> 00:26:55,290
deploy<font color="#E5E5E5"> an admin force and get it stood</font>

685
00:26:52,980 --> 00:26:57,390
up<font color="#E5E5E5"> and get these</font><font color="#CCCCCC"> ad admins moved over</font>

686
00:26:55,290 --> 00:27:00,420
and these other things<font color="#E5E5E5"> don't get fixed</font>

687
00:26:57,390 --> 00:27:01,740
they stick around<font color="#CCCCCC"> and of course their</font>

688
00:27:00,420 --> 00:27:04,050
service accounts that<font color="#E5E5E5"> are still there</font>

689
00:27:01,740 --> 00:27:06,270
there's agents on our domain<font color="#E5E5E5"> controllers</font>

690
00:27:04,050 --> 00:27:07,800
that still have privileged access and

691
00:27:06,270 --> 00:27:09,720
who has administrative<font color="#CCCCCC"> rights of those</font>

692
00:27:07,800 --> 00:27:12,870
<font color="#E5E5E5">who</font><font color="#CCCCCC"> has control of</font><font color="#E5E5E5"> those agents they're</font>

693
00:27:09,720 --> 00:27:15,000
not in the admin<font color="#E5E5E5"> forest and backup is</font>

694
00:27:12,870 --> 00:27:16,530
still a big<font color="#CCCCCC"> issue so I worked</font><font color="#E5E5E5"> with a red</font>

695
00:27:15,000 --> 00:27:18,510
team to help<font color="#E5E5E5"> them compromise an</font>

696
00:27:16,530 --> 00:27:21,570
environment<font color="#CCCCCC"> and AD force that had an</font>

697
00:27:18,510 --> 00:27:25,940
admin<font color="#CCCCCC"> forest we didn't touch any of the</font>

698
00:27:21,570 --> 00:27:28,260
ad admin accounts we didn't have to so

699
00:27:25,940 --> 00:27:30,810
there's definitely some benefits for<font color="#E5E5E5"> the</font>

700
00:27:28,260 --> 00:27:32,280
large organizations<font color="#CCCCCC"> that</font><font color="#E5E5E5"> have multiple</font>

701
00:27:30,810 --> 00:27:34,649
<font color="#E5E5E5">active directory</font><font color="#CCCCCC"> forest because if you</font>

702
00:27:32,280 --> 00:27:35,820
have several<font color="#E5E5E5"> ad forests</font><font color="#CCCCCC"> then you've got</font>

703
00:27:34,650 --> 00:27:37,650
<font color="#E5E5E5">to have</font><font color="#CCCCCC"> a way to</font><font color="#E5E5E5"> configure and manage</font>

704
00:27:35,820 --> 00:27:40,050
all of<font color="#E5E5E5"> them so an</font><font color="#CCCCCC"> enforce might make</font>

705
00:27:37,650 --> 00:27:41,640
sense in that<font color="#E5E5E5"> scenario but there's</font>

706
00:27:40,050 --> 00:27:42,810
another issue that<font color="#E5E5E5"> I've seen in a lot of</font>

707
00:27:41,640 --> 00:27:45,390
<font color="#CCCCCC">organizations and</font><font color="#E5E5E5"> that is the whole</font>

708
00:27:42,810 --> 00:27:47,129
<font color="#CCCCCC">concept of cross force administration we</font>

709
00:27:45,390 --> 00:27:49,110
have our<font color="#E5E5E5"> forced a because I'm very</font>

710
00:27:47,130 --> 00:27:51,210
creative<font color="#E5E5E5"> at naming</font><font color="#CCCCCC"> things we have a</font>

711
00:27:49,110 --> 00:27:52,110
force<font color="#E5E5E5"> B because I'm incredibly creative</font>

712
00:27:51,210 --> 00:27:54,660
at naming<font color="#CCCCCC"> things</font>

713
00:27:52,110 --> 00:27:58,560
so<font color="#E5E5E5"> for</font><font color="#CCCCCC"> stay is our production force B is</font>

714
00:27:54,660 --> 00:27:59,670
our DMZ environment<font color="#E5E5E5"> our dev</font><font color="#CCCCCC"> tests are</font>

715
00:27:58,560 --> 00:28:01,200
external

716
00:27:59,670 --> 00:28:03,390
<font color="#CCCCCC">it doesn't really</font><font color="#E5E5E5"> matter it's another</font>

717
00:28:01,200 --> 00:28:05,150
force<font color="#E5E5E5"> that's not as</font><font color="#CCCCCC"> highly trusted as</font>

718
00:28:03,390 --> 00:28:07,140
our production<font color="#CCCCCC"> are</font><font color="#E5E5E5"> at</font><font color="#CCCCCC"> force tape</font>

719
00:28:05,150 --> 00:28:09,930
<font color="#E5E5E5">environment we're gonna have a one-way</font>

720
00:28:07,140 --> 00:28:12,180
<font color="#E5E5E5">trust so in Microsoft parlance and arrow</font>

721
00:28:09,930 --> 00:28:16,230
pointing<font color="#E5E5E5"> from B to a means that a is</font>

722
00:28:12,180 --> 00:28:16,950
<font color="#E5E5E5">going</font><font color="#CCCCCC"> to a resource or a accounts yeah I</font>

723
00:28:16,230 --> 00:28:21,240
got confused

724
00:28:16,950 --> 00:28:23,400
hey accounts can access B resources so

725
00:28:21,240 --> 00:28:27,390
that<font color="#CCCCCC"> means our happy domain admin and</font>

726
00:28:23,400 --> 00:28:31,010
<font color="#E5E5E5">forest a can also be an admin and forest</font>

727
00:28:27,390 --> 00:28:33,530
B and so this<font color="#E5E5E5"> happens a lot</font><font color="#CCCCCC"> where we</font>

728
00:28:31,010 --> 00:28:36,770
have a domain admin forced<font color="#E5E5E5"> a that</font>

729
00:28:33,530 --> 00:28:38,780
manages<font color="#CCCCCC"> and administers force B and so</font>

730
00:28:36,770 --> 00:28:41,060
they connect<font color="#E5E5E5"> into</font><font color="#CCCCCC"> RDP and go ahead and</font>

731
00:28:38,780 --> 00:28:42,070
do what they<font color="#CCCCCC"> need to</font><font color="#E5E5E5"> do here's the</font>

732
00:28:41,060 --> 00:28:45,159
problem

733
00:28:42,070 --> 00:28:49,040
force B is not as trusted is forced a

734
00:28:45,160 --> 00:28:51,110
it's in the DMZ<font color="#E5E5E5"> step test</font><font color="#CCCCCC"> it might have</font>

735
00:28:49,040 --> 00:28:52,940
a hundred<font color="#E5E5E5"> domain admins that</font><font color="#CCCCCC"> are all the</font>

736
00:28:51,110 --> 00:28:54,770
developers<font color="#E5E5E5"> it could be an application</font>

737
00:28:52,940 --> 00:28:56,740
<font color="#E5E5E5">force that has some internet</font>

738
00:28:54,770 --> 00:28:58,700
connectivity is<font color="#CCCCCC"> not in the DMZ</font>

739
00:28:56,740 --> 00:29:01,130
so what do you think happens when<font color="#E5E5E5"> that</font>

740
00:28:58,700 --> 00:29:02,810
force gets compromised<font color="#E5E5E5"> well then our</font>

741
00:29:01,130 --> 00:29:10,700
happy admin gets compromised and

742
00:29:02,810 --> 00:29:12,800
ultimately<font color="#CCCCCC"> force</font><font color="#E5E5E5"> a gets compromised</font>

743
00:29:10,700 --> 00:29:18,410
<font color="#CCCCCC">right a little bit of</font><font color="#E5E5E5"> cliffhanger there</font>

744
00:29:12,800 --> 00:29:20,600
so simply from this<font color="#E5E5E5"> trust and the fact</font>

745
00:29:18,410 --> 00:29:22,790
that we're using a forest<font color="#CCCCCC"> a or</font>

746
00:29:20,600 --> 00:29:24,290
production<font color="#E5E5E5"> domain admin to administer</font>

747
00:29:22,790 --> 00:29:26,030
this<font color="#E5E5E5"> other forest with which makes sense</font>

748
00:29:24,290 --> 00:29:28,190
logically and a lot of Microsoft

749
00:29:26,030 --> 00:29:32,090
documentation points<font color="#E5E5E5"> this as the way to</font>

750
00:29:28,190 --> 00:29:35,120
do it is problematic<font color="#E5E5E5"> because</font><font color="#CCCCCC"> when we</font>

751
00:29:32,090 --> 00:29:37,030
connect using RDP from force data for<font color="#E5E5E5"> SB</font>

752
00:29:35,120 --> 00:29:41,510
we often are leaving credentials behind

753
00:29:37,030 --> 00:29:43,160
fact by default we are so I have a slide

754
00:29:41,510 --> 00:29:44,780
<font color="#CCCCCC">here that</font><font color="#E5E5E5"> has kind of a summary of what</font>

755
00:29:43,160 --> 00:29:46,520
I talked about<font color="#E5E5E5"> but at the bottom</font><font color="#CCCCCC"> is the</font>

756
00:29:44,780 --> 00:29:48,470
mitigation<font color="#E5E5E5"> so we want to make sure that</font>

757
00:29:46,520 --> 00:29:50,900
we manage<font color="#E5E5E5"> this other forest this forest</font>

758
00:29:48,470 --> 00:29:54,530
be with a<font color="#E5E5E5"> forest</font><font color="#CCCCCC"> be admin account</font><font color="#E5E5E5"> not a</font>

759
00:29:50,900 --> 00:29:56,270
forest<font color="#E5E5E5"> a account or you if you really</font>

760
00:29:54,530 --> 00:29:57,889
<font color="#CCCCCC">are set on using a forest</font><font color="#E5E5E5"> a account or a</font>

761
00:29:56,270 --> 00:29:59,990
<font color="#E5E5E5">production account make sure</font><font color="#CCCCCC"> you just</font>

762
00:29:57,890 --> 00:30:02,150
create a user account<font color="#CCCCCC"> or user accounts</font>

763
00:29:59,990 --> 00:30:04,040
that<font color="#E5E5E5"> have no privileges</font><font color="#CCCCCC"> enforce day that</font>

764
00:30:02,150 --> 00:30:06,170
then are the admins for<font color="#E5E5E5"> this other</font>

765
00:30:04,040 --> 00:30:10,580
forest<font color="#E5E5E5"> and then protect them at</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> good</font>

766
00:30:06,170 --> 00:30:13,220
level<font color="#E5E5E5"> all right so I've talked a lot</font>

767
00:30:10,580 --> 00:30:15,919
about the problems and the<font color="#CCCCCC"> issues let's</font>

768
00:30:13,220 --> 00:30:17,510
talk about building<font color="#E5E5E5"> the best defenses by</font>

769
00:30:15,920 --> 00:30:19,310
the way this is one of<font color="#E5E5E5"> my</font><font color="#CCCCCC"> favorite</font>

770
00:30:17,510 --> 00:30:20,690
castles in the<font color="#E5E5E5"> world this is</font><font color="#CCCCCC"> mount san</font>

771
00:30:19,310 --> 00:30:23,480
<font color="#CCCCCC">michele and which i'm pronouncing</font>

772
00:30:20,690 --> 00:30:25,130
<font color="#CCCCCC">horribly wrong</font><font color="#E5E5E5"> I'm sure</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> France and so</font>

773
00:30:23,480 --> 00:30:28,550
for a Lord<font color="#E5E5E5"> of the Rings fans this is</font>

774
00:30:25,130 --> 00:30:32,180
actually excuse me the the castle<font color="#E5E5E5"> that</font>

775
00:30:28,550 --> 00:30:34,000
was the inspiration<font color="#E5E5E5"> of the castle and</font>

776
00:30:32,180 --> 00:30:36,560
<font color="#E5E5E5">Lord of the</font><font color="#CCCCCC"> Rings</font>

777
00:30:34,000 --> 00:30:38,090
<font color="#E5E5E5">80 defensive pillars we're going to talk</font>

778
00:30:36,560 --> 00:30:40,970
<font color="#CCCCCC">about what we need to do in order to</font>

779
00:30:38,090 --> 00:30:44,780
secure Active Directory<font color="#E5E5E5"> so we need to</font>

780
00:30:40,970 --> 00:30:46,310
protect our credentials<font color="#E5E5E5"> our ad admin</font>

781
00:30:44,780 --> 00:30:48,860
we need to<font color="#CCCCCC"> isolate them and protect them</font>

782
00:30:46,310 --> 00:30:50,720
<font color="#E5E5E5">at the highest level we</font><font color="#CCCCCC"> need to harden</font>

783
00:30:48,860 --> 00:30:51,649
our admin methods<font color="#E5E5E5"> we want to make sure</font>

784
00:30:50,720 --> 00:30:54,200
<font color="#CCCCCC">that we're not using administrative</font>

785
00:30:51,650 --> 00:30:55,700
methods that could<font color="#E5E5E5"> be compromised</font><font color="#CCCCCC"> we</font>

786
00:30:54,200 --> 00:30:57,710
need to reduce and limit our service

787
00:30:55,700 --> 00:30:59,270
<font color="#CCCCCC">account rights and as part of this</font><font color="#E5E5E5"> pull</font>

788
00:30:57,710 --> 00:31:02,050
out any accounts that don't<font color="#E5E5E5"> need to</font><font color="#CCCCCC"> be</font>

789
00:30:59,270 --> 00:31:04,160
in domain admins<font color="#E5E5E5"> or administrators and</font>

790
00:31:02,050 --> 00:31:05,600
then there's<font color="#CCCCCC"> also effective monitoring</font>

791
00:31:04,160 --> 00:31:07,310
<font color="#E5E5E5">we need to make sure</font><font color="#CCCCCC"> that our domain</font>

792
00:31:05,600 --> 00:31:08,929
controllers are properly monitoring the

793
00:31:07,310 --> 00:31:10,810
correct events so that<font color="#E5E5E5"> way</font><font color="#CCCCCC"> when</font>

794
00:31:08,930 --> 00:31:12,410
something does happen we can see those

795
00:31:10,810 --> 00:31:13,909
unfortunately<font color="#E5E5E5"> that's out of scope for</font>

796
00:31:12,410 --> 00:31:15,980
<font color="#E5E5E5">this talk I</font><font color="#CCCCCC"> don't have enough time</font><font color="#E5E5E5"> but I</font>

797
00:31:13,910 --> 00:31:21,410
have bonus content<font color="#CCCCCC"> at the end of the</font>

798
00:31:15,980 --> 00:31:23,510
slides you can<font color="#E5E5E5"> look at later so the key</font>

799
00:31:21,410 --> 00:31:25,040
<font color="#E5E5E5">to this</font><font color="#CCCCCC"> is focusing on protection these</font>

800
00:31:23,510 --> 00:31:26,990
<font color="#E5E5E5">at protecting</font><font color="#CCCCCC"> these admin credentials</font>

801
00:31:25,040 --> 00:31:28,850
especially<font color="#CCCCCC"> our</font><font color="#E5E5E5"> ad 80 admin credentials</font>

802
00:31:26,990 --> 00:31:30,470
<font color="#E5E5E5">we need to have a separate ad admin</font>

803
00:31:28,850 --> 00:31:31,850
account<font color="#E5E5E5"> from our user accounts most</font>

804
00:31:30,470 --> 00:31:33,350
organizations<font color="#E5E5E5"> are doing this now</font>

805
00:31:31,850 --> 00:31:35,719
<font color="#CCCCCC">although the ones that have</font><font color="#E5E5E5"> transitioned</font>

806
00:31:33,350 --> 00:31:37,010
recently<font color="#E5E5E5"> often forget about some of</font>

807
00:31:35,720 --> 00:31:39,710
those user accounts<font color="#CCCCCC"> we'll</font><font color="#E5E5E5"> leave them</font><font color="#CCCCCC"> in</font>

808
00:31:37,010 --> 00:31:41,810
<font color="#CCCCCC">AD admin groups</font><font color="#E5E5E5"> making sure that these</font>

809
00:31:39,710 --> 00:31:42,980
ad admin accounts are different from

810
00:31:41,810 --> 00:31:44,840
<font color="#E5E5E5">other admin accounts they're not</font>

811
00:31:42,980 --> 00:31:48,890
administering<font color="#CCCCCC"> Exchange or SharePoint or</font>

812
00:31:44,840 --> 00:31:51,980
sequel and use distinct naming<font color="#E5E5E5"> I like</font><font color="#CCCCCC"> ad</font>

813
00:31:48,890 --> 00:31:53,360
<font color="#CCCCCC">a 480 admins sa 4 server admins and WAFF</font>

814
00:31:51,980 --> 00:31:55,700
workstation<font color="#CCCCCC"> atoms that use whatever</font>

815
00:31:53,360 --> 00:31:57,860
works<font color="#E5E5E5"> for you</font><font color="#CCCCCC"> I went into</font><font color="#E5E5E5"> a customer</font>

816
00:31:55,700 --> 00:31:59,330
site and they had all these<font color="#E5E5E5"> different</font>

817
00:31:57,860 --> 00:32:00,949
<font color="#E5E5E5">accounts actually it's been a few</font>

818
00:31:59,330 --> 00:32:02,060
customers like this<font color="#E5E5E5"> all these different</font>

819
00:32:00,950 --> 00:32:04,640
accounts<font color="#E5E5E5"> different names different</font>

820
00:32:02,060 --> 00:32:07,669
<font color="#E5E5E5">setups had no idea what kind of naming</font>

821
00:32:04,640 --> 00:32:09,080
<font color="#E5E5E5">standard there was and so I went in</font><font color="#CCCCCC"> and</font>

822
00:32:07,670 --> 00:32:10,790
talked to them about<font color="#E5E5E5"> this after I'd gone</font>

823
00:32:09,080 --> 00:32:12,500
<font color="#CCCCCC">through and done some assessing</font><font color="#E5E5E5"> of their</font>

824
00:32:10,790 --> 00:32:13,970
environment I said what's the deal with

825
00:32:12,500 --> 00:32:16,100
all<font color="#E5E5E5"> these accounts I can't tell like</font>

826
00:32:13,970 --> 00:32:18,650
this first<font color="#E5E5E5"> initial middle initial</font><font color="#CCCCCC"> last</font>

827
00:32:16,100 --> 00:32:21,199
name first<font color="#E5E5E5"> initial middle initial</font><font color="#CCCCCC"> last</font>

828
00:32:18,650 --> 00:32:22,250
initial<font color="#E5E5E5"> and then like Superman a couple</font>

829
00:32:21,200 --> 00:32:24,080
other<font color="#CCCCCC"> things I don't</font><font color="#E5E5E5"> know what this</font><font color="#CCCCCC"> is</font>

830
00:32:22,250 --> 00:32:26,660
<font color="#CCCCCC">like I don't like who our who's supposed</font>

831
00:32:24,080 --> 00:32:32,749
to<font color="#CCCCCC"> be</font><font color="#E5E5E5"> your ad admins</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> know</font><font color="#CCCCCC"> huh you</font>

832
00:32:26,660 --> 00:32:36,419
don't<font color="#CCCCCC"> know yeah you</font><font color="#E5E5E5"> don't know either</font>

833
00:32:32,749 --> 00:32:38,959
and they said yes<font color="#CCCCCC"> but the attacker won't</font>

834
00:32:36,419 --> 00:32:44,219
know which of<font color="#E5E5E5"> these is the human account</font>

835
00:32:38,959 --> 00:32:46,049
<font color="#CCCCCC">I said yeah that's</font><font color="#E5E5E5"> great</font><font color="#CCCCCC"> but I have this</font>

836
00:32:44,219 --> 00:32:48,479
<font color="#E5E5E5">report here that has a list of all of</font>

837
00:32:46,049 --> 00:32:50,009
the admins<font color="#CCCCCC"> that I've enumerated in your</font>

838
00:32:48,479 --> 00:32:51,330
<font color="#CCCCCC">environment from</font><font color="#E5E5E5"> all of the standard</font>

839
00:32:50,009 --> 00:32:53,389
groups and the permissions in<font color="#E5E5E5"> your</font>

840
00:32:51,330 --> 00:32:55,830
<font color="#CCCCCC">environment so I know who the admins are</font>

841
00:32:53,389 --> 00:32:57,269
the attackers know who the admins are

842
00:32:55,830 --> 00:32:59,580
the problem is that we cannot

843
00:32:57,269 --> 00:33:01,409
programmatically identify monitor and

844
00:32:59,580 --> 00:33:02,759
maintain<font color="#E5E5E5"> a configuration without a</font>

845
00:33:01,409 --> 00:33:05,940
standard naming convention for

846
00:33:02,759 --> 00:33:08,429
<font color="#E5E5E5">administration</font><font color="#CCCCCC"> I see</font><font color="#E5E5E5"> that there's five</font>

847
00:33:05,940 --> 00:33:10,200
accounts and domain admins<font color="#E5E5E5"> how do I know</font>

848
00:33:08,429 --> 00:33:12,029
<font color="#E5E5E5">that all of</font><font color="#CCCCCC"> those belong</font><font color="#E5E5E5"> who would I</font>

849
00:33:10,200 --> 00:33:13,349
<font color="#E5E5E5">have to talk</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> I'm going to talk to</font>

850
00:33:12,029 --> 00:33:14,700
like six<font color="#E5E5E5"> other people to figure out</font>

851
00:33:13,349 --> 00:33:17,579
which of<font color="#CCCCCC"> these</font><font color="#E5E5E5"> five accounts should be</font>

852
00:33:14,700 --> 00:33:19,229
there<font color="#CCCCCC"> right but if I can</font>

853
00:33:17,579 --> 00:33:20,940
programmatically<font color="#E5E5E5"> configure the</font>

854
00:33:19,229 --> 00:33:22,829
environment to monitor an alert on

855
00:33:20,940 --> 00:33:23,940
changes when it<font color="#CCCCCC"> doesn't see an</font><font color="#E5E5E5"> ad a and</font>

856
00:33:22,829 --> 00:33:26,879
domain admins<font color="#E5E5E5"> or something like that</font>

857
00:33:23,940 --> 00:33:27,389
<font color="#CCCCCC">I've elevated my environment to the next</font>

858
00:33:26,879 --> 00:33:29,309
level

859
00:33:27,389 --> 00:33:30,958
it could proactively manage maintain

860
00:33:29,309 --> 00:33:32,369
<font color="#E5E5E5">this and of course</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> need to make sure</font>

861
00:33:30,959 --> 00:33:35,969
<font color="#E5E5E5">there are 80 admin accounts are only</font>

862
00:33:32,369 --> 00:33:39,320
logging<font color="#CCCCCC"> into</font><font color="#E5E5E5"> 80 admin</font><font color="#CCCCCC"> workstations</font><font color="#E5E5E5"> and</font>

863
00:33:35,969 --> 00:33:41,579
<font color="#E5E5E5">80 admin servers and domain controllers</font>

864
00:33:39,320 --> 00:33:43,259
<font color="#E5E5E5">but</font><font color="#CCCCCC"> the biggest</font><font color="#E5E5E5"> question</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> why admin</font>

865
00:33:41,579 --> 00:33:44,759
workstations hopefully some<font color="#CCCCCC"> of these</font>

866
00:33:43,259 --> 00:33:47,820
slides<font color="#E5E5E5"> have helped you and will give you</font>

867
00:33:44,759 --> 00:33:50,009
some some evidence and some ammunition

868
00:33:47,820 --> 00:33:52,499
<font color="#E5E5E5">you</font><font color="#CCCCCC"> need to influence others to</font><font color="#E5E5E5"> get</font>

869
00:33:50,009 --> 00:33:54,149
admin workstations deployed because the

870
00:33:52,499 --> 00:33:55,829
issue is the battle is shifted from<font color="#CCCCCC"> the</font>

871
00:33:54,149 --> 00:33:57,689
parameter<font color="#E5E5E5"> on to these</font><font color="#CCCCCC"> workstations which</font>

872
00:33:55,829 --> 00:33:59,789
we know but we're still running

873
00:33:57,690 --> 00:34:01,709
administration from<font color="#E5E5E5"> them and the</font>

874
00:33:59,789 --> 00:34:03,719
management<font color="#E5E5E5"> these regular workstations</font><font color="#CCCCCC"> is</font>

875
00:34:01,709 --> 00:34:07,259
an<font color="#E5E5E5"> escalation</font><font color="#CCCCCC"> path there's lots of talks</font>

876
00:34:03,719 --> 00:34:10,339
about exploiting<font color="#CCCCCC"> SCCM</font><font color="#E5E5E5"> to then own the</font>

877
00:34:07,259 --> 00:34:13,289
environment or deploy malware right

878
00:34:10,339 --> 00:34:14,460
<font color="#CCCCCC">Altiris</font><font color="#E5E5E5"> SCCM</font><font color="#CCCCCC"> there's a bunch of</font>

879
00:34:13,289 --> 00:34:16,619
<font color="#E5E5E5">different systems that are used to do</font>

880
00:34:14,460 --> 00:34:18,149
this and then the credentials<font color="#E5E5E5"> that are</font>

881
00:34:16,619 --> 00:34:21,809
<font color="#E5E5E5">found on these systems</font><font color="#CCCCCC"> are</font><font color="#E5E5E5"> used to</font>

882
00:34:18,149 --> 00:34:25,379
escalate and move around<font color="#E5E5E5"> the environment</font>

883
00:34:21,809 --> 00:34:28,799
<font color="#CCCCCC">and they can be in alsace they could be</font>

884
00:34:25,379 --> 00:34:32,909
typed into<font color="#CCCCCC"> a</font><font color="#E5E5E5"> RDP window or into a web</font>

885
00:34:28,799 --> 00:34:34,409
form but this builds on<font color="#E5E5E5"> the whole</font>

886
00:34:32,909 --> 00:34:35,940
<font color="#E5E5E5">concept of</font><font color="#CCCCCC"> having a separate account</font>

887
00:34:34,409 --> 00:34:36,899
<font color="#CCCCCC">separate admin account from your user</font>

888
00:34:35,940 --> 00:34:38,369
account which we've<font color="#E5E5E5"> been</font><font color="#CCCCCC"> talking about</font>

889
00:34:36,899 --> 00:34:39,839
for<font color="#CCCCCC"> years right everyone knows we've</font>

890
00:34:38,369 --> 00:34:42,230
been since the beginning<font color="#CCCCCC"> we've been</font>

891
00:34:39,839 --> 00:34:42,230
hearing this

892
00:34:44,280 --> 00:34:49,679
we also have to<font color="#CCCCCC"> remember</font><font color="#E5E5E5"> that any agent</font>

893
00:34:47,159 --> 00:34:51,300
that<font color="#E5E5E5"> can install or run code is a</font>

894
00:34:49,679 --> 00:34:53,550
potential compromise method of that

895
00:34:51,300 --> 00:34:55,620
<font color="#E5E5E5">system so we need to expand out our</font>

896
00:34:53,550 --> 00:34:57,630
vision from just who has<font color="#E5E5E5"> local admin</font>

897
00:34:55,620 --> 00:34:58,950
rights to what are the agents<font color="#E5E5E5"> that</font><font color="#CCCCCC"> are</font>

898
00:34:57,630 --> 00:35:03,810
running<font color="#E5E5E5"> on these systems</font><font color="#CCCCCC"> and who has</font>

899
00:34:58,950 --> 00:35:05,399
ability to<font color="#E5E5E5"> influence them so when we're</font>

900
00:35:03,810 --> 00:35:07,710
talking<font color="#E5E5E5"> about our</font><font color="#CCCCCC"> 8e administration</font>

901
00:35:05,400 --> 00:35:09,270
systems we need<font color="#CCCCCC"> to isolate</font><font color="#E5E5E5"> and protect</font>

902
00:35:07,710 --> 00:35:11,250
<font color="#E5E5E5">these</font><font color="#CCCCCC"> privileged credentials we need to</font>

903
00:35:09,270 --> 00:35:13,100
provide secure environment for<font color="#E5E5E5"> the</font>

904
00:35:11,250 --> 00:35:15,330
admins to<font color="#E5E5E5"> do what they need to do</font>

905
00:35:13,100 --> 00:35:19,950
ultimately we need<font color="#E5E5E5"> to disrupt</font><font color="#CCCCCC"> the common</font>

906
00:35:15,330 --> 00:35:22,110
attack<font color="#E5E5E5"> playbook this means that we want</font>

907
00:35:19,950 --> 00:35:25,379
the attacker<font color="#E5E5E5"> to have to go from chapter</font>

908
00:35:22,110 --> 00:35:26,520
1 page<font color="#CCCCCC"> 1</font><font color="#E5E5E5"> a chapter 10 chapter 20 and</font><font color="#CCCCCC"> by</font>

909
00:35:25,380 --> 00:35:28,980
<font color="#CCCCCC">making</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> more difficult for the</font>

910
00:35:26,520 --> 00:35:30,450
attackers<font color="#E5E5E5"> we have better insight</font><font color="#CCCCCC"> and</font>

911
00:35:28,980 --> 00:35:32,910
visibility<font color="#E5E5E5"> because we want them</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> hit</font>

912
00:35:30,450 --> 00:35:34,500
those tripwires<font color="#CCCCCC"> we absolutely want</font><font color="#E5E5E5"> the</font>

913
00:35:32,910 --> 00:35:36,420
attackers<font color="#E5E5E5"> to hit something we want to</font>

914
00:35:34,500 --> 00:35:38,280
set up<font color="#E5E5E5"> a</font><font color="#CCCCCC"> pathway that they go</font><font color="#E5E5E5"> down</font>

915
00:35:36,420 --> 00:35:41,460
<font color="#CCCCCC">jessyca pain calls this building the</font>

916
00:35:38,280 --> 00:35:43,500
attackers playground<font color="#CCCCCC"> as</font><font color="#E5E5E5"> a defender we</font>

917
00:35:41,460 --> 00:35:45,810
have the ability to configure<font color="#CCCCCC"> the</font>

918
00:35:43,500 --> 00:35:49,980
environment to be our home court

919
00:35:45,810 --> 00:35:52,470
advantage<font color="#E5E5E5"> we set up the</font><font color="#CCCCCC"> trip wires</font><font color="#E5E5E5"> we</font>

920
00:35:49,980 --> 00:35:55,860
form and identify which way we<font color="#CCCCCC"> want</font><font color="#E5E5E5"> them</font>

921
00:35:52,470 --> 00:35:57,660
to<font color="#E5E5E5"> go and we</font><font color="#CCCCCC"> look at that and we go</font><font color="#E5E5E5"> all</font>

922
00:35:55,860 --> 00:35:58,980
<font color="#E5E5E5">right here's</font><font color="#CCCCCC"> how we do administration so</font>

923
00:35:57,660 --> 00:36:00,509
what are the trip wires we need to

924
00:35:58,980 --> 00:36:02,460
implement<font color="#CCCCCC"> what are the</font><font color="#E5E5E5"> events we need</font><font color="#CCCCCC"> to</font>

925
00:36:00,510 --> 00:36:05,040
be<font color="#E5E5E5"> looking at in this pathway</font><font color="#CCCCCC"> how do</font><font color="#E5E5E5"> we</font>

926
00:36:02,460 --> 00:36:06,480
<font color="#E5E5E5">ensure and know that only valid and</font>

927
00:36:05,040 --> 00:36:09,930
authorized people<font color="#E5E5E5"> and personnel are</font>

928
00:36:06,480 --> 00:36:11,580
<font color="#E5E5E5">using those</font><font color="#CCCCCC"> pathways so we need to</font>

929
00:36:09,930 --> 00:36:13,049
<font color="#CCCCCC">ensure</font><font color="#E5E5E5"> the consistent is configured</font>

930
00:36:11,580 --> 00:36:14,580
correctly<font color="#E5E5E5"> we</font><font color="#CCCCCC"> need to make sure only</font>

931
00:36:13,050 --> 00:36:16,950
these specific admins can<font color="#E5E5E5"> log on</font>

932
00:36:14,580 --> 00:36:18,569
separate administration<font color="#E5E5E5"> of the system of</font>

933
00:36:16,950 --> 00:36:20,879
this admin system separate management

934
00:36:18,570 --> 00:36:22,800
patching<font color="#CCCCCC"> auto patching in many Senate</font>

935
00:36:20,880 --> 00:36:25,080
situations<font color="#CCCCCC"> make sure</font><font color="#E5E5E5"> it's firewalled off</font>

936
00:36:22,800 --> 00:36:28,560
the standard<font color="#CCCCCC"> network</font><font color="#E5E5E5"> we want</font><font color="#CCCCCC"> to restrict</font>

937
00:36:25,080 --> 00:36:32,220
<font color="#E5E5E5">access to the management protocols like</font>

938
00:36:28,560 --> 00:36:33,930
<font color="#CCCCCC">RDP WMI etc and enforce</font><font color="#E5E5E5"> NLA so that way</font>

939
00:36:32,220 --> 00:36:37,950
<font color="#E5E5E5">someone has to off before they connect</font>

940
00:36:33,930 --> 00:36:40,500
to that<font color="#E5E5E5"> RTP server there's a great hack</font>

941
00:36:37,950 --> 00:36:43,500
or modification that<font color="#E5E5E5"> I call a movie</font>

942
00:36:40,500 --> 00:36:47,040
movie hacking on<font color="#CCCCCC"> Windows is just simply</font>

943
00:36:43,500 --> 00:36:48,840
replacing one file with cmd.exe so that

944
00:36:47,040 --> 00:36:50,790
way when you hit a key over and over

945
00:36:48,840 --> 00:36:52,890
again on that<font color="#E5E5E5"> logon screen it pops up a</font>

946
00:36:50,790 --> 00:36:55,230
<font color="#E5E5E5">command box running a system</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> that</font>

947
00:36:52,890 --> 00:36:56,310
right I'm sure everyone's seen<font color="#E5E5E5"> this call</font>

948
00:36:55,230 --> 00:36:57,760
<font color="#E5E5E5">a movie hacking</font><font color="#CCCCCC"> because you just</font><font color="#E5E5E5"> hit</font>

949
00:36:56,310 --> 00:36:59,770
<font color="#CCCCCC">shift 5 times in the</font>

950
00:36:57,760 --> 00:37:02,140
<font color="#CCCCCC">spatula</font><font color="#E5E5E5"> now you can do whatever you want</font>

951
00:36:59,770 --> 00:37:04,509
with<font color="#CCCCCC"> that system with nla you block the</font>

952
00:37:02,140 --> 00:37:06,279
attackers ability to have<font color="#CCCCCC"> implant at</font>

953
00:37:04,510 --> 00:37:10,030
<font color="#E5E5E5">that and then to reuse it if they got</font><font color="#CCCCCC"> on</font>

954
00:37:06,280 --> 00:37:11,230
<font color="#CCCCCC">that system previously so this is</font>

955
00:37:10,030 --> 00:37:13,240
probably one of<font color="#E5E5E5"> my favorite slides in</font>

956
00:37:11,230 --> 00:37:15,790
the whole deck<font color="#E5E5E5"> raise your hand if you've</font>

957
00:37:13,240 --> 00:37:16,930
seen this before<font color="#E5E5E5"> keep your hand up if</font>

958
00:37:15,790 --> 00:37:24,070
you<font color="#E5E5E5"> have been able to implement</font><font color="#CCCCCC"> this</font>

959
00:37:16,930 --> 00:37:25,089
fully<font color="#CCCCCC"> okay I think I saw one</font><font color="#E5E5E5"> person</font><font color="#CCCCCC"> to</font>

960
00:37:24,070 --> 00:37:26,800
<font color="#E5E5E5">two people</font>

961
00:37:25,090 --> 00:37:30,010
kudos so you see me after<font color="#CCCCCC"> I have</font>

962
00:37:26,800 --> 00:37:32,890
something for you<font color="#E5E5E5"> for everyone</font><font color="#CCCCCC"> else this</font>

963
00:37:30,010 --> 00:37:35,560
<font color="#CCCCCC">is</font><font color="#E5E5E5"> what I want you to focus on because</font>

964
00:37:32,890 --> 00:37:37,480
with the Microsoft tiered model tier<font color="#CCCCCC"> 0</font>

965
00:37:35,560 --> 00:37:39,490
means domain admins domain controllers

966
00:37:37,480 --> 00:37:40,870
and<font color="#E5E5E5"> all of the supporting systems are in</font>

967
00:37:39,490 --> 00:37:43,959
that tier and can't get into another

968
00:37:40,870 --> 00:37:46,810
tier and tier<font color="#CCCCCC"> one is</font><font color="#E5E5E5"> going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> be your</font>

969
00:37:43,960 --> 00:37:49,000
server admins your servers the

970
00:37:46,810 --> 00:37:50,380
management system<font color="#E5E5E5"> for servers tier</font><font color="#CCCCCC"> two</font>

971
00:37:49,000 --> 00:37:52,270
is going<font color="#E5E5E5"> to be your workstations</font>

972
00:37:50,380 --> 00:37:54,850
workstation admins workstation admin

973
00:37:52,270 --> 00:37:56,410
system<font color="#E5E5E5"> and the management system this</font>

974
00:37:54,850 --> 00:37:58,690
<font color="#E5E5E5">means</font><font color="#CCCCCC"> that you</font><font color="#E5E5E5"> have to have if you have</font>

975
00:37:56,410 --> 00:38:00,910
a CCM you've got<font color="#E5E5E5"> a deploy an</font><font color="#CCCCCC"> SCCM</font>

976
00:37:58,690 --> 00:38:02,830
instance in tier 2 1 and tier 1 and<font color="#CCCCCC"> 1</font>

977
00:38:00,910 --> 00:38:04,960
and tier 0<font color="#E5E5E5"> and you have</font><font color="#CCCCCC"> to have admin</font>

978
00:38:02,830 --> 00:38:09,100
accounts in each one separately<font color="#CCCCCC"> and none</font>

979
00:38:04,960 --> 00:38:11,080
of<font color="#E5E5E5"> them can talk to each other so now</font>

980
00:38:09,100 --> 00:38:12,339
that many of you have your eyes glazed

981
00:38:11,080 --> 00:38:14,620
over and<font color="#E5E5E5"> are thinking there's no</font><font color="#CCCCCC"> way</font>

982
00:38:12,340 --> 00:38:16,780
<font color="#E5E5E5">that I can</font><font color="#CCCCCC"> do that</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> is where I want</font>

983
00:38:14,620 --> 00:38:18,819
to come<font color="#CCCCCC"> back to let's focus on tier 0</font>

984
00:38:16,780 --> 00:38:20,950
<font color="#CCCCCC">let's focus on protecting</font><font color="#E5E5E5"> the most</font>

985
00:38:18,820 --> 00:38:22,720
important assets in<font color="#E5E5E5"> our Active Directory</font>

986
00:38:20,950 --> 00:38:25,629
environment<font color="#E5E5E5"> our</font><font color="#CCCCCC"> 80 admins or domain</font>

987
00:38:22,720 --> 00:38:27,279
controllers because<font color="#CCCCCC"> the</font><font color="#E5E5E5"> issue is with</font>

988
00:38:25,630 --> 00:38:29,770
the Microsoft tiered model is it's

989
00:38:27,280 --> 00:38:31,420
<font color="#CCCCCC">difficult to implement</font><font color="#E5E5E5"> it's costly to</font>

990
00:38:29,770 --> 00:38:33,520
implement<font color="#E5E5E5"> it requires duplicate</font>

991
00:38:31,420 --> 00:38:35,050
infrastructure and admin<font color="#E5E5E5"> accounts to do</font>

992
00:38:33,520 --> 00:38:37,540
it correctly<font color="#CCCCCC"> it's very hard</font><font color="#E5E5E5"> to do it</font>

993
00:38:35,050 --> 00:38:40,060
correctly<font color="#E5E5E5"> there's like three</font><font color="#CCCCCC"> people</font><font color="#E5E5E5"> in</font>

994
00:38:37,540 --> 00:38:43,240
this room of let's call<font color="#CCCCCC"> it 1500 that</font>

995
00:38:40,060 --> 00:38:44,650
<font color="#CCCCCC">have had</font><font color="#E5E5E5"> it implemented it's rarely</font>

996
00:38:43,240 --> 00:38:46,180
fully implemented there's lots of

997
00:38:44,650 --> 00:38:49,680
organizations that<font color="#E5E5E5"> have gotten it close</font>

998
00:38:46,180 --> 00:38:52,629
so<font color="#CCCCCC"> I want</font><font color="#E5E5E5"> everyone</font><font color="#CCCCCC"> to focus on tier</font><font color="#E5E5E5"> 0</font>

999
00:38:49,680 --> 00:38:54,910
<font color="#E5E5E5">making sure that those</font><font color="#CCCCCC"> are protected</font><font color="#E5E5E5"> so</font>

1000
00:38:52,630 --> 00:38:57,130
what is tier 0 domain admins<font color="#CCCCCC"> privilege</font>

1001
00:38:54,910 --> 00:38:59,049
80 admin accounts and systems or 80

1002
00:38:57,130 --> 00:39:01,210
admins or<font color="#CCCCCC"> serfs</font><font color="#E5E5E5"> council privilege 80</font>

1003
00:38:59,050 --> 00:39:06,630
rights are 80 admin workstations and

1004
00:39:01,210 --> 00:39:09,250
servers<font color="#CCCCCC"> are</font><font color="#E5E5E5"> ad FS</font><font color="#CCCCCC"> in Federation</font><font color="#E5E5E5"> servers</font>

1005
00:39:06,630 --> 00:39:10,500
if an attacker is able<font color="#E5E5E5"> to get admin</font>

1006
00:39:09,250 --> 00:39:12,330
rights to an<font color="#E5E5E5"> a</font>

1007
00:39:10,500 --> 00:39:13,680
best server<font color="#E5E5E5"> they can extract the</font>

1008
00:39:12,330 --> 00:39:17,310
certificate<font color="#E5E5E5"> that's used to sign the</font>

1009
00:39:13,680 --> 00:39:19,470
<font color="#E5E5E5">tokens and forge their own Federation</font>

1010
00:39:17,310 --> 00:39:20,960
tokens for<font color="#E5E5E5"> two years or more depending</font>

1011
00:39:19,470 --> 00:39:23,279
on<font color="#E5E5E5"> how long that certificates good for</font>

1012
00:39:20,960 --> 00:39:24,690
anywhere on the network so<font color="#E5E5E5"> you</font>

1013
00:39:23,280 --> 00:39:27,360
definitely<font color="#E5E5E5"> want to protect</font><font color="#CCCCCC"> your a DFS</font>

1014
00:39:24,690 --> 00:39:29,430
servers<font color="#CCCCCC"> Azure</font><font color="#E5E5E5"> ad</font><font color="#CCCCCC"> Connect servers a lot</font>

1015
00:39:27,360 --> 00:39:31,410
of organizations<font color="#E5E5E5"> have gone off 365 and</font>

1016
00:39:29,430 --> 00:39:34,379
Azure ad and are using Azure ad connect

1017
00:39:31,410 --> 00:39:36,990
to synchronize their user accounts on

1018
00:39:34,380 --> 00:39:39,150
their<font color="#E5E5E5"> 8</font><font color="#CCCCCC"> on Prem ad into Azure ad so they</font>

1019
00:39:36,990 --> 00:39:40,979
can use office<font color="#CCCCCC"> 365 and a lot of times</font>

1020
00:39:39,150 --> 00:39:42,870
they're synchronizing that<font color="#E5E5E5"> password hash</font>

1021
00:39:40,980 --> 00:39:45,840
data in Azure ad so the<font color="#E5E5E5"> users</font><font color="#CCCCCC"> can</font>

1022
00:39:42,870 --> 00:39:49,589
directly log on Azure ad<font color="#E5E5E5"> so you want to</font>

1023
00:39:45,840 --> 00:39:51,600
be aware that if you have as<font color="#CCCCCC"> you 8080</font>

1024
00:39:49,590 --> 00:39:52,830
connects servers configured they really

1025
00:39:51,600 --> 00:39:54,870
should be<font color="#E5E5E5"> in this tier especially if</font>

1026
00:39:52,830 --> 00:39:56,759
they're synchronized<font color="#E5E5E5"> map password hash</font>

1027
00:39:54,870 --> 00:39:58,710
data because about every<font color="#CCCCCC"> 2 minutes as</font>

1028
00:39:56,760 --> 00:39:59,730
your ad<font color="#E5E5E5"> Connect is going to ask the</font>

1029
00:39:58,710 --> 00:40:01,470
domain controllers in<font color="#E5E5E5"> each of the</font>

1030
00:39:59,730 --> 00:40:03,210
domains<font color="#E5E5E5"> that contain users that are</font>

1031
00:40:01,470 --> 00:40:05,939
synchronized<font color="#CCCCCC"> say send me</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> password</font>

1032
00:40:03,210 --> 00:40:07,590
hashes for<font color="#E5E5E5"> these users this means that</font>

1033
00:40:05,940 --> 00:40:10,740
as<font color="#CCCCCC"> rated you can ad</font><font color="#E5E5E5"> Connect is like a</font>

1034
00:40:07,590 --> 00:40:12,720
<font color="#E5E5E5">junior DC because</font><font color="#CCCCCC"> those credentials</font><font color="#E5E5E5"> are</font>

1035
00:40:10,740 --> 00:40:14,580
passing through<font color="#E5E5E5"> in memory on that</font><font color="#CCCCCC"> system</font>

1036
00:40:12,720 --> 00:40:17,700
on a regular<font color="#CCCCCC"> basis</font><font color="#E5E5E5"> and then of course</font>

1037
00:40:14,580 --> 00:40:19,680
<font color="#CCCCCC">PKI</font><font color="#E5E5E5"> password vault and the tier 0 our</font>

1038
00:40:17,700 --> 00:40:25,020
management<font color="#CCCCCC"> system should be in tier 0 as</font>

1039
00:40:19,680 --> 00:40:26,700
well so we want to convince our admins

1040
00:40:25,020 --> 00:40:28,530
this is the tough part<font color="#CCCCCC"> admins are two</font>

1041
00:40:26,700 --> 00:40:30,600
that<font color="#E5E5E5"> are typically mobile use a laptop</font>

1042
00:40:28,530 --> 00:40:33,570
will require<font color="#E5E5E5"> a second laptop</font><font color="#CCCCCC"> that's</font>

1043
00:40:30,600 --> 00:40:35,069
tough it's a tough<font color="#E5E5E5"> sell they're less</font>

1044
00:40:33,570 --> 00:40:36,120
<font color="#CCCCCC">than excited when they're told they have</font>

1045
00:40:35,070 --> 00:40:38,610
<font color="#CCCCCC">to use a separate</font><font color="#E5E5E5"> system</font><font color="#CCCCCC"> for</font>

1046
00:40:36,120 --> 00:40:40,109
administration<font color="#CCCCCC"> ego 80 admin here's your</font>

1047
00:40:38,610 --> 00:40:42,990
regular workstation here's your new

1048
00:40:40,110 --> 00:40:44,760
admin system<font color="#E5E5E5"> you can't use both you</font>

1049
00:40:42,990 --> 00:40:46,649
can't use this to do that<font color="#E5E5E5"> and the other</font>

1050
00:40:44,760 --> 00:40:48,450
way<font color="#E5E5E5"> around</font><font color="#CCCCCC"> and then the</font><font color="#E5E5E5"> biggest</font>

1051
00:40:46,650 --> 00:40:50,250
challenge with<font color="#CCCCCC"> this is</font><font color="#E5E5E5"> the people that</font>

1052
00:40:48,450 --> 00:40:51,569
are most<font color="#E5E5E5"> impacted are 80 admins are</font>

1053
00:40:50,250 --> 00:40:53,130
often the ones<font color="#CCCCCC"> that have to make</font><font color="#E5E5E5"> this</font>

1054
00:40:51,570 --> 00:40:55,790
change they have<font color="#CCCCCC"> to implement it so</font>

1055
00:40:53,130 --> 00:40:58,680
<font color="#CCCCCC">guess</font><font color="#E5E5E5"> what happens I'm gonna do what</font>

1056
00:40:55,790 --> 00:41:00,000
okay so I've got party<font color="#CCCCCC"> one two three</font>

1057
00:40:58,680 --> 00:41:02,690
<font color="#CCCCCC">four guess what it's gonna</font><font color="#E5E5E5"> be right here</font>

1058
00:41:00,000 --> 00:41:06,830
<font color="#CCCCCC">I think I have time</font><font color="#E5E5E5"> next</font><font color="#CCCCCC"> year</font>

1059
00:41:02,690 --> 00:41:08,880
<font color="#CCCCCC">how's July next year work for you</font>

1060
00:41:06,830 --> 00:41:11,400
but this is a<font color="#E5E5E5"> good opportunity to</font>

1061
00:41:08,880 --> 00:41:13,800
<font color="#E5E5E5">refresh hardware there's several options</font>

1062
00:41:11,400 --> 00:41:16,080
<font color="#E5E5E5">for small lightweight systems for these</font>

1063
00:41:13,800 --> 00:41:17,790
<font color="#E5E5E5">80 admin systems I like the Microsoft</font>

1064
00:41:16,080 --> 00:41:19,950
<font color="#E5E5E5">Surface Microsoft doesn't</font><font color="#CCCCCC"> pay me to say</font>

1065
00:41:17,790 --> 00:41:22,619
that but it works well and<font color="#CCCCCC"> now there's</font>

1066
00:41:19,950 --> 00:41:24,569
cheaper ones out but it's important to

1067
00:41:22,619 --> 00:41:26,700
<font color="#E5E5E5">explain the reasons the</font><font color="#CCCCCC"> how's the whys</font>

1068
00:41:24,570 --> 00:41:29,130
why it's important to separate these

1069
00:41:26,700 --> 00:41:30,868
systems out because without<font color="#CCCCCC"> that</font>

1070
00:41:29,130 --> 00:41:32,990
information<font color="#CCCCCC"> it will be the bottom of</font><font color="#E5E5E5"> the</font>

1071
00:41:30,869 --> 00:41:35,220
priority<font color="#CCCCCC"> list and</font><font color="#E5E5E5"> will never happen</font>

1072
00:41:32,990 --> 00:41:37,520
<font color="#E5E5E5">because these isolating these</font>

1073
00:41:35,220 --> 00:41:39,810
<font color="#E5E5E5">credentials are the most critical</font>

1074
00:41:37,520 --> 00:41:42,030
<font color="#CCCCCC">now convincing management is just as</font>

1075
00:41:39,810 --> 00:41:44,490
important if not more so<font color="#E5E5E5"> got to tell</font>

1076
00:41:42,030 --> 00:41:48,540
<font color="#E5E5E5">them why we've got to explain why this</font>

1077
00:41:44,490 --> 00:41:50,580
is<font color="#E5E5E5"> important why it's required yes these</font>

1078
00:41:48,540 --> 00:41:53,359
systems and process will slow the

1079
00:41:50,580 --> 00:41:56,279
resolution of issues<font color="#E5E5E5"> managers hate this</font>

1080
00:41:53,359 --> 00:41:58,410
executives hate<font color="#E5E5E5"> this because yes it</font>

1081
00:41:56,280 --> 00:42:02,490
<font color="#E5E5E5">might take</font><font color="#CCCCCC"> another day or two to resolve</font>

1082
00:41:58,410 --> 00:42:04,020
an issue that<font color="#E5E5E5"> you want done in hours but</font>

1083
00:42:02,490 --> 00:42:05,580
it will<font color="#CCCCCC"> also slow down</font><font color="#E5E5E5"> and stop</font>

1084
00:42:04,020 --> 00:42:08,490
attackers from having that<font color="#CCCCCC"> access in</font>

1085
00:42:05,580 --> 00:42:10,140
<font color="#CCCCCC">that capability and the cost of</font><font color="#E5E5E5"> this</font>

1086
00:42:08,490 --> 00:42:12,359
extra<font color="#E5E5E5"> hardware and the delays that it</font>

1087
00:42:10,140 --> 00:42:14,520
would take naturally to do things that

1088
00:42:12,359 --> 00:42:16,740
used to<font color="#CCCCCC"> be done a</font><font color="#E5E5E5"> lot more quickly far</font>

1089
00:42:14,520 --> 00:42:18,330
cheaper<font color="#E5E5E5"> than</font><font color="#CCCCCC"> an</font><font color="#E5E5E5"> IR far cheaper</font><font color="#CCCCCC"> than</font>

1090
00:42:16,740 --> 00:42:21,419
<font color="#CCCCCC">having Mandy</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> fireEye CrowdStrike</font>

1091
00:42:18,330 --> 00:42:23,069
come in and kick out the attackers far

1092
00:42:21,420 --> 00:42:25,050
<font color="#E5E5E5">cheaper</font><font color="#CCCCCC"> than the reputation</font><font color="#E5E5E5"> hid far</font>

1093
00:42:23,070 --> 00:42:27,030
cheaper<font color="#CCCCCC"> than the downtime</font><font color="#E5E5E5"> far cheaper</font>

1094
00:42:25,050 --> 00:42:29,280
<font color="#E5E5E5">than people working 100 hours</font><font color="#CCCCCC"> a week and</font>

1095
00:42:27,030 --> 00:42:30,869
<font color="#E5E5E5">20%</font><font color="#CCCCCC"> of your staff getting burnt out</font><font color="#E5E5E5"> and</font>

1096
00:42:29,280 --> 00:42:34,530
leaving<font color="#E5E5E5"> it's usually the best ones to</font>

1097
00:42:30,869 --> 00:42:36,300
<font color="#E5E5E5">you by the way start slow and build up</font>

1098
00:42:34,530 --> 00:42:39,030
with gradual changes we need<font color="#E5E5E5"> to partner</font>

1099
00:42:36,300 --> 00:42:40,890
<font color="#E5E5E5">and make this a collaborative</font><font color="#CCCCCC"> effort we</font>

1100
00:42:39,030 --> 00:42:43,109
<font color="#E5E5E5">need to start slow</font><font color="#CCCCCC"> and say here's</font><font color="#E5E5E5"> what</font>

1101
00:42:40,890 --> 00:42:45,210
we<font color="#E5E5E5"> want to do and here's why</font><font color="#CCCCCC"> let's talk</font>

1102
00:42:43,109 --> 00:42:47,540
about how we can do this smartly<font color="#E5E5E5"> how</font>

1103
00:42:45,210 --> 00:42:52,050
<font color="#E5E5E5">that we can do this together</font>

1104
00:42:47,540 --> 00:42:53,490
<font color="#E5E5E5">so it's a workable admin system ideally</font>

1105
00:42:52,050 --> 00:42:55,050
would be separate physical<font color="#E5E5E5"> devices but</font>

1106
00:42:53,490 --> 00:42:59,189
that's not<font color="#E5E5E5"> always feasible</font><font color="#CCCCCC"> but since</font><font color="#E5E5E5"> our</font>

1107
00:42:55,050 --> 00:43:00,930
<font color="#CCCCCC">goal is to isolate our credentials</font><font color="#E5E5E5"> let's</font>

1108
00:42:59,190 --> 00:43:02,520
talk about using<font color="#E5E5E5"> an admin workstation</font>

1109
00:43:00,930 --> 00:43:04,950
leverages virtualization<font color="#CCCCCC"> so that we can</font>

1110
00:43:02,520 --> 00:43:08,520
have a good blend of security<font color="#E5E5E5"> and</font>

1111
00:43:04,950 --> 00:43:10,919
operational capability so there's a lot

1112
00:43:08,520 --> 00:43:12,930
<font color="#E5E5E5">on this slide we're going to start with</font>

1113
00:43:10,920 --> 00:43:15,330
<font color="#CCCCCC">a</font><font color="#E5E5E5"> host OS</font><font color="#CCCCCC"> which is our admin environment</font>

1114
00:43:12,930 --> 00:43:17,279
<font color="#CCCCCC">virtualize</font><font color="#E5E5E5"> or user environment into a VM</font>

1115
00:43:15,330 --> 00:43:19,240
and we're going to<font color="#E5E5E5"> use that user</font>

1116
00:43:17,280 --> 00:43:21,070
environment for all of<font color="#CCCCCC"> our user</font><font color="#E5E5E5"> activity</font>

1117
00:43:19,240 --> 00:43:22,629
that<font color="#E5E5E5"> host OS is effectively</font><font color="#CCCCCC"> going to be</font>

1118
00:43:21,070 --> 00:43:24,550
our admin system<font color="#E5E5E5"> that we just</font><font color="#CCCCCC"> use as a</font>

1119
00:43:22,630 --> 00:43:28,240
jumping point<font color="#E5E5E5"> to our admin</font><font color="#CCCCCC"> system or a</font>

1120
00:43:24,550 --> 00:43:30,520
DC this is<font color="#E5E5E5"> the account that logs</font><font color="#CCCCCC"> onto</font>

1121
00:43:28,240 --> 00:43:31,779
<font color="#E5E5E5">this host OS is what I call a transition</font>

1122
00:43:30,520 --> 00:43:33,400
account it doesn't<font color="#CCCCCC"> have any rights it</font>

1123
00:43:31,780 --> 00:43:36,520
can't do anything<font color="#E5E5E5"> it just logs on to</font>

1124
00:43:33,400 --> 00:43:38,950
<font color="#E5E5E5">that system</font><font color="#CCCCCC"> and then once on that</font><font color="#E5E5E5"> system</font>

1125
00:43:36,520 --> 00:43:39,910
<font color="#E5E5E5">we can log on to in our DB server and</font>

1126
00:43:38,950 --> 00:43:41,410
have<font color="#E5E5E5"> been</font><font color="#CCCCCC"> serviced</font><font color="#E5E5E5"> so let's see what</font>

1127
00:43:39,910 --> 00:43:44,049
<font color="#E5E5E5">this looks like</font><font color="#CCCCCC"> so we are admin</font>

1128
00:43:41,410 --> 00:43:47,470
workstation with our user VM we<font color="#E5E5E5"> log in</font>

1129
00:43:44,050 --> 00:43:48,910
as a regular<font color="#CCCCCC"> user</font><font color="#E5E5E5"> onto that VM we use a</font>

1130
00:43:47,470 --> 00:43:51,879
transition account to log<font color="#CCCCCC"> onto</font><font color="#E5E5E5"> that</font>

1131
00:43:48,910 --> 00:43:53,920
workstation<font color="#CCCCCC"> and then we use that our</font><font color="#E5E5E5"> 80</font>

1132
00:43:51,880 --> 00:43:57,190
admin account via<font color="#CCCCCC"> RDP to our admin</font>

1133
00:43:53,920 --> 00:43:58,780
server so this way we can isolate those

1134
00:43:57,190 --> 00:44:00,580
<font color="#E5E5E5">credentials we can protect them and</font>

1135
00:43:58,780 --> 00:44:02,760
since it's our admin workstation it's

1136
00:44:00,580 --> 00:44:05,290
not going to have all<font color="#E5E5E5"> the standard</font>

1137
00:44:02,760 --> 00:44:07,050
<font color="#CCCCCC">capability of management controls and</font>

1138
00:44:05,290 --> 00:44:09,250
hundred people<font color="#CCCCCC"> that have admin rights</font>

1139
00:44:07,050 --> 00:44:11,350
<font color="#CCCCCC">okay</font><font color="#E5E5E5"> Sean but we have a password</font><font color="#CCCCCC"> wall</font>

1140
00:44:09,250 --> 00:44:11,920
how does<font color="#E5E5E5"> that fit in yeah you just plug</font>

1141
00:44:11,350 --> 00:44:14,770
<font color="#CCCCCC">it in right here</font>

1142
00:44:11,920 --> 00:44:16,300
same thing<font color="#CCCCCC"> Laguz user</font><font color="#E5E5E5"> use a transition</font>

1143
00:44:14,770 --> 00:44:18,700
account the transition account is what

1144
00:44:16,300 --> 00:44:20,740
<font color="#E5E5E5">also</font><font color="#CCCCCC"> asks that password</font><font color="#E5E5E5"> vault but now we</font>

1145
00:44:18,700 --> 00:44:22,930
know the admin workstation is protecting

1146
00:44:20,740 --> 00:44:26,830
those credentials<font color="#E5E5E5"> were using to connect</font>

1147
00:44:22,930 --> 00:44:29,310
into<font color="#E5E5E5"> it using MFA hopefully and then</font>

1148
00:44:26,830 --> 00:44:32,049
they pass with Vulcan proxy it through

1149
00:44:29,310 --> 00:44:33,850
I'm not<font color="#E5E5E5"> advocating password volts by the</font>

1150
00:44:32,050 --> 00:44:37,480
way we can have<font color="#CCCCCC"> conversations offline</font>

1151
00:44:33,850 --> 00:44:39,069
<font color="#E5E5E5">about the benefits</font><font color="#CCCCCC"> etc so</font><font color="#E5E5E5"> urban</font>

1152
00:44:37,480 --> 00:44:40,390
workstations definitely start with<font color="#E5E5E5"> our</font>

1153
00:44:39,070 --> 00:44:43,780
act directory admins look at virtual

1154
00:44:40,390 --> 00:44:47,080
<font color="#E5E5E5">infrastructure cloud admins don't forget</font>

1155
00:44:43,780 --> 00:44:48,369
about PGI mainframe so<font color="#E5E5E5"> Chad's putting on</font>

1156
00:44:47,080 --> 00:44:52,060
a great<font color="#E5E5E5"> talk tomorrow afternoon about</font>

1157
00:44:48,369 --> 00:44:54,040
mainframe hacking<font color="#E5E5E5"> from a regular</font>

1158
00:44:52,060 --> 00:44:55,150
workstation<font color="#CCCCCC"> a lot</font><font color="#E5E5E5"> of times mainframes</font>

1159
00:44:54,040 --> 00:44:58,480
are administered<font color="#E5E5E5"> that way</font>

1160
00:44:55,150 --> 00:45:00,000
just like<font color="#E5E5E5"> everything else is so with</font>

1161
00:44:58,480 --> 00:45:02,380
this new<font color="#E5E5E5"> standard this new configuration</font>

1162
00:45:00,000 --> 00:45:04,030
<font color="#CCCCCC">we want to make sure</font><font color="#E5E5E5"> that our ad admins</font>

1163
00:45:02,380 --> 00:45:06,010
only ever log on to the main controllers

1164
00:45:04,030 --> 00:45:07,720
<font color="#E5E5E5">or 80 admin workstation or 88 admin</font>

1165
00:45:06,010 --> 00:45:09,040
server we want<font color="#CCCCCC"> to make sure</font><font color="#E5E5E5"> that 80</font>

1166
00:45:07,720 --> 00:45:11,410
admin counts are separate<font color="#E5E5E5"> from other</font>

1167
00:45:09,040 --> 00:45:13,210
administration we want to prevent<font color="#E5E5E5"> them</font>

1168
00:45:11,410 --> 00:45:15,759
from<font color="#E5E5E5"> logging on other systems</font><font color="#CCCCCC"> we want to</font>

1169
00:45:13,210 --> 00:45:18,730
get all service counts<font color="#E5E5E5"> out of 80 admin</font>

1170
00:45:15,760 --> 00:45:19,810
groups as a general rule<font color="#E5E5E5"> I know that</font>

1171
00:45:18,730 --> 00:45:22,000
can't<font color="#E5E5E5"> happen right away</font>

1172
00:45:19,810 --> 00:45:23,920
<font color="#E5E5E5">but our new standard is no service</font>

1173
00:45:22,000 --> 00:45:26,350
counts<font color="#CCCCCC"> in</font><font color="#E5E5E5"> 80 admin groups not domain</font>

1174
00:45:23,920 --> 00:45:27,340
admins not administrators and then of

1175
00:45:26,350 --> 00:45:31,529
<font color="#CCCCCC">course we want to</font><font color="#E5E5E5"> make</font><font color="#CCCCCC"> sure our</font><font color="#E5E5E5"> local</font>

1176
00:45:27,340 --> 00:45:33,579
<font color="#E5E5E5">admin passwords actually get changed</font>

1177
00:45:31,529 --> 00:45:35,769
so we need to reduce and limit our

1178
00:45:33,579 --> 00:45:37,299
service count<font color="#E5E5E5"> rights then the vendor</font>

1179
00:45:35,769 --> 00:45:39,368
<font color="#CCCCCC">requirements also</font><font color="#E5E5E5"> push us in this</font>

1180
00:45:37,299 --> 00:45:41,140
direction<font color="#CCCCCC"> they say domain admins we say</font>

1181
00:45:39,369 --> 00:45:43,329
<font color="#CCCCCC">ok let's push back</font><font color="#E5E5E5"> what rights are</font>

1182
00:45:41,140 --> 00:45:45,308
actually required<font color="#CCCCCC"> to often</font><font color="#E5E5E5"> their domain</font>

1183
00:45:43,329 --> 00:45:46,720
admins administrators backup<font color="#CCCCCC"> operator</font>

1184
00:45:45,309 --> 00:45:49,660
server operators these<font color="#E5E5E5"> are highly</font>

1185
00:45:46,720 --> 00:45:52,180
privileged ad admin groups rarely<font color="#E5E5E5"> do</font>

1186
00:45:49,660 --> 00:45:54,220
they<font color="#CCCCCC"> actually require it so</font><font color="#E5E5E5"> I did a lot</font>

1187
00:45:52,180 --> 00:45:55,410
<font color="#CCCCCC">of work and effort</font><font color="#E5E5E5"> in my free time</font><font color="#CCCCCC"> I</font>

1188
00:45:54,220 --> 00:45:58,328
read through a lot of<font color="#E5E5E5"> different</font>

1189
00:45:55,410 --> 00:45:59,890
documentation<font color="#E5E5E5"> from vendors piled through</font>

1190
00:45:58,329 --> 00:46:01,329
<font color="#E5E5E5">this over hours and hours and I put</font>

1191
00:45:59,890 --> 00:46:03,788
<font color="#E5E5E5">together a list of the</font><font color="#CCCCCC"> most common</font>

1192
00:46:01,329 --> 00:46:05,950
<font color="#E5E5E5">things that vendors asked for and I a</font>

1193
00:46:03,789 --> 00:46:07,329
pattern emerged<font color="#CCCCCC"> we're in Vegas</font><font color="#E5E5E5"> so we're</font>

1194
00:46:05,950 --> 00:46:14,859
gonna<font color="#E5E5E5"> do a little Vegas magic let's see</font>

1195
00:46:07,329 --> 00:46:20,309
if the pattern<font color="#E5E5E5"> emerges for you - yes</font>

1196
00:46:14,859 --> 00:46:20,308
<font color="#E5E5E5">domain admins solves everything right</font>

1197
00:46:21,660 --> 00:46:26,950
oftentimes it's a vulnerability<font color="#CCCCCC"> scanning</font>

1198
00:46:23,799 --> 00:46:29,500
tool<font color="#CCCCCC"> backup VPN even sequel ends up in</font>

1199
00:46:26,950 --> 00:46:32,140
domain admins<font color="#E5E5E5"> we don't need them there</font>

1200
00:46:29,500 --> 00:46:33,609
<font color="#E5E5E5">we can pull those out they need less</font>

1201
00:46:32,140 --> 00:46:34,808
rights and what they say they require

1202
00:46:33,609 --> 00:46:36,848
vulnerability scanning is a little

1203
00:46:34,809 --> 00:46:38,529
little trickier<font color="#E5E5E5"> oftentimes the</font>

1204
00:46:36,849 --> 00:46:40,480
vulnerability scanning tool is<font color="#CCCCCC"> gonna use</font>

1205
00:46:38,529 --> 00:46:43,150
an<font color="#CCCCCC"> author</font><font color="#E5E5E5"> authorized or authenticated</font>

1206
00:46:40,480 --> 00:46:44,769
scan using<font color="#CCCCCC"> a demain</font><font color="#E5E5E5"> admin account but if</font>

1207
00:46:43,150 --> 00:46:46,960
that<font color="#CCCCCC"> hiccups and</font><font color="#E5E5E5"> leaves behind that</font>

1208
00:46:44,769 --> 00:46:49,258
<font color="#E5E5E5">credential of that serves count on a</font>

1209
00:46:46,960 --> 00:46:52,599
workstation<font color="#E5E5E5"> the environments don't</font>

1210
00:46:49,259 --> 00:46:53,920
forget about<font color="#E5E5E5"> the vulnerabilities if you</font>

1211
00:46:52,599 --> 00:46:55,480
have unconstrained delegation a

1212
00:46:53,920 --> 00:46:57,609
vulnerability scanning account scans

1213
00:46:55,480 --> 00:46:59,880
that system guess what the Kerberos TGT

1214
00:46:57,609 --> 00:47:02,380
the authentication ticket is left<font color="#E5E5E5"> behind</font>

1215
00:46:59,880 --> 00:47:05,740
<font color="#E5E5E5">an attacker compromised that system it's</font>

1216
00:47:02,380 --> 00:47:09,069
game over<font color="#E5E5E5"> we need to get better we need</font>

1217
00:47:05,740 --> 00:47:10,779
<font color="#E5E5E5">to get these accounts out backup unless</font>

1218
00:47:09,069 --> 00:47:12,009
<font color="#E5E5E5">it's Active Directory backup doesn't</font>

1219
00:47:10,779 --> 00:47:12,880
need to be in domain admins and even

1220
00:47:12,009 --> 00:47:15,849
then it just needs to<font color="#E5E5E5"> be in backup</font>

1221
00:47:12,880 --> 00:47:17,789
<font color="#E5E5E5">operators VPN and sequel shouldn't be</font>

1222
00:47:15,849 --> 00:47:20,680
there

1223
00:47:17,789 --> 00:47:22,809
the issue with the<font color="#CCCCCC"> pianos often the VPN</font>

1224
00:47:20,680 --> 00:47:24,940
<font color="#CCCCCC">a service account wants to be able</font><font color="#E5E5E5"> to</font>

1225
00:47:22,809 --> 00:47:26,529
reset the<font color="#CCCCCC"> user's password</font><font color="#E5E5E5"> users trying</font>

1226
00:47:24,940 --> 00:47:28,779
to VPN their password is inspired they

1227
00:47:26,529 --> 00:47:30,069
need to log<font color="#E5E5E5"> on okay well let's delegate</font>

1228
00:47:28,779 --> 00:47:34,029
those rights<font color="#E5E5E5"> for that service</font><font color="#CCCCCC"> account</font>

1229
00:47:30,069 --> 00:47:36,069
<font color="#CCCCCC">let's not give it da & Seek why'd I have</font>

1230
00:47:34,029 --> 00:47:37,359
<font color="#CCCCCC">nothing to</font><font color="#E5E5E5"> say about sequel I don't know</font>

1231
00:47:36,069 --> 00:47:42,339
why secret would ever be in domain

1232
00:47:37,359 --> 00:47:44,600
admins<font color="#CCCCCC"> usually that goes way far back a</font>

1233
00:47:42,339 --> 00:47:46,759
little<font color="#CCCCCC"> note on</font><font color="#E5E5E5"> sequel by the way</font>

1234
00:47:44,600 --> 00:47:48,920
a little bit of homework<font color="#CCCCCC"> for you when</font>

1235
00:47:46,760 --> 00:47:50,240
you get<font color="#CCCCCC"> back to your organization</font><font color="#E5E5E5"> your</font>

1236
00:47:48,920 --> 00:47:51,620
your act<font color="#CCCCCC"> directive environment take a</font>

1237
00:47:50,240 --> 00:47:53,509
look at your administrator account your

1238
00:47:51,620 --> 00:47:55,970
default<font color="#CCCCCC"> administrator account for</font><font color="#E5E5E5"> your</font>

1239
00:47:53,510 --> 00:47:57,170
domains<font color="#CCCCCC"> you read 500</font><font color="#E5E5E5"> count and check</font><font color="#CCCCCC"> to</font>

1240
00:47:55,970 --> 00:48:00,620
<font color="#CCCCCC">see</font><font color="#E5E5E5"> if there's a service</font><font color="#CCCCCC"> principal name</font>

1241
00:47:57,170 --> 00:48:02,330
associated<font color="#CCCCCC"> with a</font><font color="#E5E5E5"> case</font><font color="#CCCCCC"> pen</font><font color="#E5E5E5"> okay if it</font>

1242
00:48:00,620 --> 00:48:03,710
has a<font color="#CCCCCC"> span it's a service</font><font color="#E5E5E5"> count it is</font>

1243
00:48:02,330 --> 00:48:06,049
being<font color="#E5E5E5"> used as a service count your</font>

1244
00:48:03,710 --> 00:48:07,490
environment<font color="#E5E5E5"> that is bad please remove</font>

1245
00:48:06,050 --> 00:48:08,500
<font color="#E5E5E5">that immediately because</font><font color="#CCCCCC"> that is not</font>

1246
00:48:07,490 --> 00:48:10,669
good at all

1247
00:48:08,500 --> 00:48:11,900
so in conclusion traditionally the

1248
00:48:10,670 --> 00:48:14,390
administration<font color="#E5E5E5"> must evolve with the</font>

1249
00:48:11,900 --> 00:48:16,040
<font color="#E5E5E5">threats to effectively protect</font><font color="#CCCCCC"> 80 most</font>

1250
00:48:14,390 --> 00:48:20,870
organizations<font color="#E5E5E5"> have done something but we</font>

1251
00:48:16,040 --> 00:48:22,580
still need to<font color="#CCCCCC"> get better party 1 remove</font>

1252
00:48:20,870 --> 00:48:24,920
all the accounts that<font color="#E5E5E5"> don't belong there</font>

1253
00:48:22,580 --> 00:48:26,720
<font color="#CCCCCC">and remove the service accounts that are</font>

1254
00:48:24,920 --> 00:48:32,020
in 80 admin groups priority to protect

1255
00:48:26,720 --> 00:48:34,339
<font color="#CCCCCC">and isolate your</font><font color="#E5E5E5"> at 80 admin credentials</font>

1256
00:48:32,020 --> 00:48:35,750
that's been my time thank<font color="#CCCCCC"> you</font><font color="#E5E5E5"> very much</font>

1257
00:48:34,340 --> 00:48:39,080
<font color="#E5E5E5">for yours if you like my talk please</font>

1258
00:48:35,750 --> 00:48:42,100
submit evaluation<font color="#E5E5E5"> also</font><font color="#CCCCCC"> there's a QA that</font>

1259
00:48:39,080 --> 00:48:42,100
I'll be in in this

1260
00:48:43,620 --> 00:48:46,770
[Applause]

