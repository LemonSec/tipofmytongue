1
00:00:00,030 --> 00:00:06,569
thank you hi everyone today<font color="#E5E5E5"> I'll tell</font>

2
00:00:02,909 --> 00:00:09,240
<font color="#E5E5E5">you</font><font color="#CCCCCC"> who the black box attacks and the</font>

3
00:00:06,569 --> 00:00:11,790
why it was dead<font color="#CCCCCC"> and why it's alive now I</font>

4
00:00:09,240 --> 00:00:14,160
don't<font color="#E5E5E5"> tell you</font><font color="#CCCCCC"> about an hour</font><font color="#E5E5E5"> in research</font>

5
00:00:11,790 --> 00:00:18,570
related to care dispenser<font color="#E5E5E5"> one of the</font>

6
00:00:14,160 --> 00:00:19,140
main<font color="#CCCCCC"> parts</font><font color="#E5E5E5"> of ATM also describe how it</font>

7
00:00:18,570 --> 00:00:21,180
works

8
00:00:19,140 --> 00:00:24,230
<font color="#CCCCCC">if Halbert</font><font color="#E5E5E5"> security how to get money</font>

9
00:00:21,180 --> 00:00:27,720
<font color="#E5E5E5">from an ATM and how to successful attack</font>

10
00:00:24,230 --> 00:00:30,359
can be<font color="#E5E5E5"> performed with</font><font color="#CCCCCC"> research we done</font>

11
00:00:27,720 --> 00:00:32,940
together<font color="#CCCCCC"> with my</font><font color="#E5E5E5"> colleague vladimir but</font>

12
00:00:30,359 --> 00:00:37,829
he couldn't come<font color="#E5E5E5"> so tell</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> about it</font>

13
00:00:32,940 --> 00:00:41,160
let's<font color="#CCCCCC"> begin so who we are</font><font color="#E5E5E5"> my colleague</font>

14
00:00:37,829 --> 00:00:42,120
<font color="#CCCCCC">redeemer he is open his hobbies</font><font color="#E5E5E5"> reverse</font>

15
00:00:41,160 --> 00:00:43,980
<font color="#E5E5E5">engineering</font>

16
00:00:42,120 --> 00:00:46,309
he works in<font color="#CCCCCC"> positive technologies</font>

17
00:00:43,980 --> 00:00:49,559
<font color="#E5E5E5">research team he started</font><font color="#CCCCCC"> reversal</font><font color="#E5E5E5"> in</font>

18
00:00:46,309 --> 00:00:53,250
2008 and there<font color="#CCCCCC"> was</font><font color="#E5E5E5"> different correctness</font>

19
00:00:49,559 --> 00:00:56,129
<font color="#CCCCCC">kikianus and so</font><font color="#E5E5E5"> also he is an active</font>

20
00:00:53,250 --> 00:00:56,730
<font color="#E5E5E5">sega megadrive remark and community</font>

21
00:00:56,129 --> 00:00:58,919
member

22
00:00:56,730 --> 00:01:02,129
he helps<font color="#CCCCCC"> others to</font><font color="#E5E5E5"> translate different</font>

23
00:00:58,920 --> 00:01:06,140
old-school TV games to their foreign

24
00:01:02,129 --> 00:01:09,420
<font color="#E5E5E5">languages and modifying them</font>

25
00:01:06,140 --> 00:01:11,700
my<font color="#E5E5E5"> name is</font><font color="#CCCCCC"> Alexey my previous job and my</font>

26
00:01:09,420 --> 00:01:14,970
hobby<font color="#CCCCCC"> was hardware engineering and</font>

27
00:01:11,700 --> 00:01:17,790
<font color="#CCCCCC">umbria</font><font color="#E5E5E5"> systems software development</font>

28
00:01:14,970 --> 00:01:20,369
including<font color="#E5E5E5"> industrial control systems I'm</font>

29
00:01:17,790 --> 00:01:24,119
most interested in hardware and<font color="#CCCCCC"> software</font>

30
00:01:20,369 --> 00:01:26,100
reverse engineering<font color="#E5E5E5"> now I work in</font><font color="#CCCCCC"> polti</font>

31
00:01:24,119 --> 00:01:29,130
technologies in industrial control

32
00:01:26,100 --> 00:01:34,110
systems<font color="#E5E5E5"> security research team and</font>

33
00:01:29,130 --> 00:01:37,079
execute some walk on ATM projects so

34
00:01:34,110 --> 00:01:39,780
what is the ATM area<font color="#CCCCCC"> actually it's very</font>

35
00:01:37,079 --> 00:01:42,860
<font color="#CCCCCC">closed area and</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> difficult</font><font color="#E5E5E5"> to get into</font>

36
00:01:39,780 --> 00:01:46,259
<font color="#E5E5E5">in it happens because the main</font><font color="#CCCCCC"> leads</font>

37
00:01:42,860 --> 00:01:47,549
when does main idea is to<font color="#CCCCCC"> make security</font>

38
00:01:46,259 --> 00:01:50,340
<font color="#E5E5E5">through obscurity</font>

39
00:01:47,549 --> 00:01:54,840
<font color="#E5E5E5">actually you can</font><font color="#CCCCCC"> find any software</font>

40
00:01:50,340 --> 00:01:57,810
development<font color="#CCCCCC"> kits software samples in</font>

41
00:01:54,840 --> 00:01:59,850
informal in public<font color="#E5E5E5"> but really theme is</font>

42
00:01:57,810 --> 00:02:00,710
almost the same as you<font color="#E5E5E5"> can see in the</font>

43
00:01:59,850 --> 00:02:04,079
picture

44
00:02:00,710 --> 00:02:08,068
it's also<font color="#E5E5E5"> hard</font><font color="#CCCCCC"> to take an ATM to</font>

45
00:02:04,079 --> 00:02:11,129
research what you can find<font color="#E5E5E5"> in sale</font>

46
00:02:08,068 --> 00:02:12,489
inside ATM<font color="#E5E5E5"> first of all is divided into</font>

47
00:02:11,129 --> 00:02:15,640
two main areas<font color="#E5E5E5"> up</font>

48
00:02:12,490 --> 00:02:17,650
cabinet and the safe<font color="#CCCCCC"> then</font><font color="#E5E5E5"> the cabinet is</font>

49
00:02:15,640 --> 00:02:20,260
opened you<font color="#E5E5E5"> will get into service area</font>

50
00:02:17,650 --> 00:02:24,190
<font color="#CCCCCC">the follow</font><font color="#E5E5E5"> in ATM park located in here</font>

51
00:02:20,260 --> 00:02:27,850
it's<font color="#E5E5E5"> PC</font><font color="#CCCCCC"> monitory pinpin</font><font color="#E5E5E5"> pad</font><font color="#CCCCCC"> where it is</font>

52
00:02:24,190 --> 00:02:31,359
<font color="#E5E5E5">I interrupt a poll power supply unit and</font>

53
00:02:27,850 --> 00:02:35,320
other devices all the<font color="#E5E5E5"> West connect to pc</font>

54
00:02:31,360 --> 00:02:37,210
like just like usual peripherals usual

55
00:02:35,320 --> 00:02:40,450
like logical attacks can<font color="#CCCCCC"> be done</font><font color="#E5E5E5"> through</font>

56
00:02:37,210 --> 00:02:44,020
this<font color="#CCCCCC"> zone</font><font color="#E5E5E5"> because most of works in</font>

57
00:02:40,450 --> 00:02:46,000
cabinet<font color="#CCCCCC"> a</font><font color="#E5E5E5"> primitive the most interesting</font>

58
00:02:44,020 --> 00:02:47,290
devices<font color="#E5E5E5"> the dispenser is purpose to</font>

59
00:02:46,000 --> 00:02:50,290
store and issue cash

60
00:02:47,290 --> 00:02:51,790
therefore it stays in the safe<font color="#E5E5E5"> there are</font>

61
00:02:50,290 --> 00:02:55,660
no accessible in service there are

62
00:02:51,790 --> 00:03:00,579
<font color="#E5E5E5">things of dispensaries power wires and</font>

63
00:02:55,660 --> 00:03:03,970
bus which connected to be seen<font color="#E5E5E5"> let's</font>

64
00:03:00,580 --> 00:03:06,400
look at<font color="#E5E5E5"> the data flow of 20 M it's not</font>

65
00:03:03,970 --> 00:03:08,290
complex<font color="#E5E5E5"> extract communication of ATM</font>

66
00:03:06,400 --> 00:03:10,450
with<font color="#CCCCCC"> a</font><font color="#E5E5E5"> communication with the processing</font>

67
00:03:08,290 --> 00:03:13,420
center<font color="#CCCCCC"> but</font><font color="#E5E5E5"> setting</font><font color="#CCCCCC"> Center communication</font>

68
00:03:10,450 --> 00:03:17,140
realized using VPN<font color="#CCCCCC"> tos and</font><font color="#E5E5E5"> other secure</font>

69
00:03:13,420 --> 00:03:19,230
things and insecure in most cases the

70
00:03:17,140 --> 00:03:21,700
next level is communication

71
00:03:19,230 --> 00:03:24,070
windows-based application if

72
00:03:21,700 --> 00:03:27,010
<font color="#E5E5E5">communicates with expired services layer</font>

73
00:03:24,070 --> 00:03:30,820
by an API<font color="#CCCCCC"> its middleware which</font>

74
00:03:27,010 --> 00:03:33,250
implements unified device access so this

75
00:03:30,820 --> 00:03:36,790
power<font color="#E5E5E5"> adder is bottom layer solution for</font>

76
00:03:33,250 --> 00:03:38,260
interaction<font color="#E5E5E5"> with devices the lowest</font>

77
00:03:36,790 --> 00:03:40,030
<font color="#E5E5E5">level</font><font color="#CCCCCC"> of communication is</font><font color="#E5E5E5"> a data</font>

78
00:03:38,260 --> 00:03:42,670
transmission<font color="#E5E5E5"> over hardware buses to</font>

79
00:03:40,030 --> 00:03:46,720
<font color="#CCCCCC">devices we understood exactly in this</font>

80
00:03:42,670 --> 00:03:49,570
<font color="#CCCCCC">issue</font><font color="#E5E5E5"> some people</font><font color="#CCCCCC"> want to</font><font color="#E5E5E5"> take money</font>

81
00:03:46,720 --> 00:03:52,570
from ATM because<font color="#E5E5E5"> it's a box of metal and</font>

82
00:03:49,570 --> 00:03:54,579
plastic<font color="#E5E5E5"> main ATM security fails</font><font color="#CCCCCC"> a</font>

83
00:03:52,570 --> 00:03:58,690
<font color="#CCCCCC">forward boot force attracts malware and</font>

84
00:03:54,580 --> 00:04:00,790
hardware attacks it<font color="#E5E5E5"> in crime actions can</font>

85
00:03:58,690 --> 00:04:03,340
<font color="#CCCCCC">be divided</font><font color="#E5E5E5"> according to the method of</font>

86
00:04:00,790 --> 00:04:07,150
access in the two main parts<font color="#E5E5E5"> physical</font>

87
00:04:03,340 --> 00:04:09,640
<font color="#E5E5E5">attacks and logical attacks let's look</font>

88
00:04:07,150 --> 00:04:14,260
at<font color="#E5E5E5"> each</font><font color="#CCCCCC"> of them</font><font color="#E5E5E5"> physical attacks can be</font>

89
00:04:09,640 --> 00:04:16,269
forward based on brute force as you<font color="#CCCCCC"> can</font>

90
00:04:14,260 --> 00:04:18,700
<font color="#E5E5E5">hear from news this kind of attack is</font>

91
00:04:16,269 --> 00:04:21,000
well they used more popular and happens

92
00:04:18,700 --> 00:04:23,460
everywhere in the world

93
00:04:21,000 --> 00:04:25,410
it<font color="#CCCCCC"> used to rule techniques like schemas</font>

94
00:04:23,460 --> 00:04:27,840
of different different<font color="#E5E5E5"> complexity</font>

95
00:04:25,410 --> 00:04:30,870
<font color="#E5E5E5">trappers that's called the card inside</font>

96
00:04:27,840 --> 00:04:37,799
ATM cameras and some<font color="#CCCCCC"> transaction</font><font color="#E5E5E5"> revolt</font>

97
00:04:30,870 --> 00:04:39,980
from<font color="#E5E5E5"> reversal techniques another type</font><font color="#CCCCCC"> of</font>

98
00:04:37,800 --> 00:04:42,690
physical<font color="#E5E5E5"> attacks is brute force attacks</font>

99
00:04:39,980 --> 00:04:45,090
for<font color="#E5E5E5"> example</font><font color="#CCCCCC"> until you can blow exclusive</font>

100
00:04:42,690 --> 00:04:47,580
<font color="#CCCCCC">get</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> the safe then little Nate</font><font color="#E5E5E5"> is so</font>

101
00:04:45,090 --> 00:04:50,070
that saved or will be turned<font color="#E5E5E5"> out and</font>

102
00:04:47,580 --> 00:04:50,940
<font color="#CCCCCC">stored</font><font color="#E5E5E5"> cash</font><font color="#CCCCCC"> will boost</font><font color="#E5E5E5"> will be scattered</font>

103
00:04:50,070 --> 00:04:54,599
on the<font color="#CCCCCC"> floor</font>

104
00:04:50,940 --> 00:04:57,780
another example is<font color="#E5E5E5"> resonant entire ATM</font>

105
00:04:54,600 --> 00:05:02,760
from<font color="#E5E5E5"> the wall by</font><font color="#CCCCCC"> attract results you</font><font color="#E5E5E5"> can</font>

106
00:04:57,780 --> 00:05:05,340
see<font color="#CCCCCC"> in the pictures now let's look at</font>

107
00:05:02,760 --> 00:05:08,460
logical attacks the most common type<font color="#E5E5E5"> is</font>

108
00:05:05,340 --> 00:05:12,239
more based attacks there are many 18

109
00:05:08,460 --> 00:05:14,010
targeted malware but they all use<font color="#CCCCCC"> Excel</font>

110
00:05:12,240 --> 00:05:17,400
<font color="#CCCCCC">face</font><font color="#E5E5E5"> layer to interact</font><font color="#CCCCCC"> with hardware</font>

111
00:05:14,010 --> 00:05:19,800
parts basically<font color="#E5E5E5"> with dispenser and</font><font color="#CCCCCC"> PIN</font>

112
00:05:17,400 --> 00:05:22,710
<font color="#CCCCCC">pad if you are interested in</font><font color="#E5E5E5"> ATM</font>

113
00:05:19,800 --> 00:05:25,110
<font color="#CCCCCC">security you may here doing</font><font color="#E5E5E5"> this press I</font>

114
00:05:22,710 --> 00:05:27,780
can't let make<font color="#E5E5E5"> plotters and have the</font>

115
00:05:25,110 --> 00:05:30,810
malware<font color="#CCCCCC"> there are few distribution ways</font>

116
00:05:27,780 --> 00:05:33,330
of such malware or remotely from

117
00:05:30,810 --> 00:05:37,290
protesting<font color="#CCCCCC"> center or locally</font><font color="#E5E5E5"> from USB</font>

118
00:05:33,330 --> 00:05:39,359
device for example<font color="#CCCCCC"> now let's look</font><font color="#E5E5E5"> at</font>

119
00:05:37,290 --> 00:05:42,150
<font color="#E5E5E5">another type</font><font color="#CCCCCC"> of logical attacks that</font>

120
00:05:39,360 --> 00:05:44,850
called<font color="#E5E5E5"> black box it one of the most</font>

121
00:05:42,150 --> 00:05:49,109
complex<font color="#CCCCCC"> and technically difficult attack</font>

122
00:05:44,850 --> 00:05:51,900
well<font color="#CCCCCC"> it has many peculiarities blade box</font>

123
00:05:49,110 --> 00:05:55,320
attacks attacks<font color="#E5E5E5"> with</font><font color="#CCCCCC"> usage of some extra</font>

124
00:05:51,900 --> 00:05:58,020
hardware devices connected to<font color="#E5E5E5"> hardware</font>

125
00:05:55,320 --> 00:06:00,450
<font color="#CCCCCC">bus the device</font><font color="#E5E5E5"> are called black boxes</font>

126
00:05:58,020 --> 00:06:02,909
you can see an example<font color="#E5E5E5"> of such device on</font>

127
00:06:00,450 --> 00:06:06,810
the photo to the casual<font color="#E5E5E5"> observer</font><font color="#CCCCCC"> it</font>

128
00:06:02,910 --> 00:06:08,850
<font color="#E5E5E5">looks like opening device open</font><font color="#CCCCCC"> service</font>

129
00:06:06,810 --> 00:06:11,130
error<font color="#E5E5E5"> connecting some device or laptop</font>

130
00:06:08,850 --> 00:06:13,919
to<font color="#E5E5E5"> dispense a bus and cash withdrawal</font>

131
00:06:11,130 --> 00:06:16,800
<font color="#E5E5E5">this this type of attack requires low</font>

132
00:06:13,919 --> 00:06:18,990
level protocols in power of ATM

133
00:06:16,800 --> 00:06:22,080
knowledge<font color="#E5E5E5"> ease such attacks do not</font>

134
00:06:18,990 --> 00:06:26,780
depend on processing center operation

135
00:06:22,080 --> 00:06:26,780
<font color="#E5E5E5">systems and other software</font>

136
00:06:29,300 --> 00:06:34,680
let's try to figure out<font color="#E5E5E5"> how to connect</font>

137
00:06:31,680 --> 00:06:37,650
the dispenser to<font color="#CCCCCC"> the</font><font color="#E5E5E5"> PC generally is</font>

138
00:06:34,680 --> 00:06:40,410
connected by rs-232 ADC or<font color="#CCCCCC"> you</font>

139
00:06:37,650 --> 00:06:43,859
interfaces<font color="#E5E5E5"> also</font><font color="#CCCCCC"> in some sources</font><font color="#E5E5E5"> were</font>

140
00:06:40,410 --> 00:06:47,190
references to<font color="#CCCCCC"> canvas usage</font><font color="#E5E5E5"> but we</font>

141
00:06:43,860 --> 00:06:51,360
haven't<font color="#E5E5E5"> seen a</font><font color="#CCCCCC"> wack project let's take a</font>

142
00:06:47,190 --> 00:06:54,300
more<font color="#E5E5E5"> detailed look at these devices the</font>

143
00:06:51,360 --> 00:06:58,020
<font color="#CCCCCC">first and the oldest device is a</font>

144
00:06:54,300 --> 00:07:00,150
<font color="#E5E5E5">rest-based RS</font><font color="#CCCCCC"> - her</font><font color="#E5E5E5"> - as well as the</font>

145
00:06:58,020 --> 00:07:04,890
<font color="#CCCCCC">comport</font><font color="#E5E5E5"> specifically of this connection</font>

146
00:07:00,150 --> 00:07:07,560
<font color="#E5E5E5">is the usage of</font><font color="#CCCCCC"> multiplexer</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> expand</font>

147
00:07:04,890 --> 00:07:11,460
the number<font color="#CCCCCC"> of</font><font color="#E5E5E5"> ports</font><font color="#CCCCCC"> they are usually</font><font color="#E5E5E5"> not</font>

148
00:07:07,560 --> 00:07:12,210
<font color="#E5E5E5">enough in</font><font color="#CCCCCC"> PC an example of multiple XA</font>

149
00:07:11,460 --> 00:07:14,940
is in the photo

150
00:07:12,210 --> 00:07:18,080
you only need a<font color="#CCCCCC"> laptop and cheap USB 2</font>

151
00:07:14,940 --> 00:07:20,990
<font color="#CCCCCC">port update to perform this attack</font>

152
00:07:18,080 --> 00:07:24,479
usually data transmitted in unprotected

153
00:07:20,990 --> 00:07:29,100
<font color="#CCCCCC">clear</font><font color="#E5E5E5"> way and</font><font color="#CCCCCC"> fervor Egyptian patches</font>

154
00:07:24,480 --> 00:07:32,130
are very limited<font color="#E5E5E5"> in their resources in a</font>

155
00:07:29,100 --> 00:07:35,970
number of cases<font color="#E5E5E5"> the comments are human</font>

156
00:07:32,130 --> 00:07:38,790
<font color="#CCCCCC">readable and it's enough to look into</font>

157
00:07:35,970 --> 00:07:42,360
<font color="#E5E5E5">the traffic in order</font><font color="#CCCCCC"> to understand</font><font color="#E5E5E5"> and</font>

158
00:07:38,790 --> 00:07:46,410
produce them<font color="#E5E5E5"> this is too primitive</font><font color="#CCCCCC"> so</font>

159
00:07:42,360 --> 00:07:49,860
let's move to<font color="#CCCCCC"> the next</font><font color="#E5E5E5"> interface this</font><font color="#CCCCCC"> is</font>

160
00:07:46,410 --> 00:07:55,710
the<font color="#CCCCCC"> SDC bus its proprietor for</font><font color="#E5E5E5"> NCR ATMs</font>

161
00:07:49,860 --> 00:07:58,650
<font color="#E5E5E5">in</font><font color="#CCCCCC"> fact this is</font><font color="#E5E5E5"> rs-485</font><font color="#CCCCCC"> is a multi drop</font>

162
00:07:55,710 --> 00:08:01,859
comport the winner is<font color="#E5E5E5"> this unusual</font>

163
00:07:58,650 --> 00:08:03,390
bitrate and<font color="#CCCCCC"> byte size here the</font>

164
00:08:01,860 --> 00:08:06,300
encryption is trivial logical<font color="#CCCCCC"> to</font>

165
00:08:03,390 --> 00:08:10,340
operation the direction is<font color="#CCCCCC"> mutant</font>

166
00:08:06,300 --> 00:08:10,340
principle of<font color="#CCCCCC"> matter</font><font color="#E5E5E5"> several slaves</font>

167
00:08:11,419 --> 00:08:16,740
devices are connected to the same<font color="#CCCCCC"> wires</font>

168
00:08:13,770 --> 00:08:20,400
of the<font color="#E5E5E5"> bus in parallel</font><font color="#CCCCCC"> well please</font>

169
00:08:16,740 --> 00:08:23,100
remember this fact<font color="#E5E5E5"> a popular track of</font>

170
00:08:20,400 --> 00:08:25,770
this bus called drill box and<font color="#E5E5E5"> I take a</font>

171
00:08:23,100 --> 00:08:28,440
card<font color="#E5E5E5"> hole in ATM</font><font color="#CCCCCC"> facie</font><font color="#E5E5E5"> next to the</font><font color="#CCCCCC"> pin</font>

172
00:08:25,770 --> 00:08:31,280
<font color="#E5E5E5">pad then attract attention</font><font color="#CCCCCC"> pink paper</font>

173
00:08:28,440 --> 00:08:35,030
<font color="#CCCCCC">turns on his device connects to a DC bus</font>

174
00:08:31,280 --> 00:08:37,669
<font color="#E5E5E5">which also goes to the safe for the</font>

175
00:08:35,030 --> 00:08:39,468
<font color="#CCCCCC">Prancer further y'all need to send data</font>

176
00:08:37,669 --> 00:08:42,409
protocol sequences for<font color="#CCCCCC"> cache section</font>

177
00:08:39,469 --> 00:08:47,200
<font color="#CCCCCC">issue</font><font color="#E5E5E5"> usually</font><font color="#CCCCCC"> a special interface card</font>

178
00:08:42,409 --> 00:08:49,939
installed to PC for communicating<font color="#E5E5E5"> or ADC</font>

179
00:08:47,200 --> 00:08:52,970
<font color="#CCCCCC">and finally the</font><font color="#E5E5E5"> most interesting and</font>

180
00:08:49,940 --> 00:08:55,970
most<font color="#E5E5E5"> common complex logical bus is USB</font>

181
00:08:52,970 --> 00:08:59,210
first of all you need<font color="#E5E5E5"> to understand what</font>

182
00:08:55,970 --> 00:09:01,610
<font color="#CCCCCC">terminology a lot of abstractions for</font>

183
00:08:59,210 --> 00:09:05,120
example<font color="#E5E5E5"> in point</font><font color="#CCCCCC"> descriptive</font>

184
00:09:01,610 --> 00:09:07,280
the interfaces<font color="#CCCCCC"> and their types that cool</font>

185
00:09:05,120 --> 00:09:10,460
<font color="#E5E5E5">dispensers identified as human interface</font>

186
00:09:07,280 --> 00:09:12,829
devices or composite devices<font color="#E5E5E5"> however to</font>

187
00:09:10,460 --> 00:09:13,910
see the data<font color="#E5E5E5"> at low level you need</font><font color="#CCCCCC"> a</font>

188
00:09:12,830 --> 00:09:17,150
<font color="#E5E5E5">hardware sniffer</font>

189
00:09:13,910 --> 00:09:18,230
<font color="#E5E5E5">there</font><font color="#CCCCCC"> are usually expensive alternatives</font>

190
00:09:17,150 --> 00:09:21,370
<font color="#E5E5E5">with dispensers</font>

191
00:09:18,230 --> 00:09:23,690
they're usually inherited<font color="#E5E5E5"> protocols from</font>

192
00:09:21,370 --> 00:09:26,480
<font color="#CCCCCC">comport devices with the same drawbacks</font>

193
00:09:23,690 --> 00:09:28,670
<font color="#CCCCCC">but we will not consider</font><font color="#E5E5E5"> them let's look</font>

194
00:09:26,480 --> 00:09:32,990
at examples of<font color="#E5E5E5"> real attacks</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> most of</font>

195
00:09:28,670 --> 00:09:35,030
history<font color="#CCCCCC"> ATP's be dispensers one of the</font>

196
00:09:32,990 --> 00:09:38,620
<font color="#E5E5E5">findings</font><font color="#CCCCCC"> of the politic knowledge is</font>

197
00:09:35,030 --> 00:09:43,100
research team in<font color="#CCCCCC"> devices of this type in</font>

198
00:09:38,620 --> 00:09:46,430
2014 was<font color="#CCCCCC"> incorrect in the celebration</font><font color="#E5E5E5"> of</font>

199
00:09:43,100 --> 00:09:48,950
<font color="#E5E5E5">random function so the initial key was</font>

200
00:09:46,430 --> 00:09:50,660
predictable<font color="#E5E5E5"> in this regard also</font>

201
00:09:48,950 --> 00:09:52,250
implemented<font color="#E5E5E5"> the decrypted protocol</font>

202
00:09:50,660 --> 00:09:54,680
appeared to be vulnerable

203
00:09:52,250 --> 00:09:56,930
this error allowed to iterate the

204
00:09:54,680 --> 00:09:59,829
session Liebchen<font color="#CCCCCC"> Keefe of anytime and</font>

205
00:09:56,930 --> 00:10:03,469
then<font color="#E5E5E5"> to central common to issue cache</font>

206
00:09:59,830 --> 00:10:07,550
this vulnerability<font color="#CCCCCC"> was</font><font color="#E5E5E5"> fixed by the</font>

207
00:10:03,470 --> 00:10:12,350
vendor the most recent attack<font color="#E5E5E5"> the beauty</font>

208
00:10:07,550 --> 00:10:15,560
attacks of<font color="#E5E5E5"> this type was made in 2017</font><font color="#CCCCCC"> in</font>

209
00:10:12,350 --> 00:10:18,200
addition together this laptop<font color="#E5E5E5"> with</font>

210
00:10:15,560 --> 00:10:20,319
engineering<font color="#E5E5E5"> software which dispenser was</font>

211
00:10:18,200 --> 00:10:23,570
connected and<font color="#E5E5E5"> in the scope was he with</font>

212
00:10:20,320 --> 00:10:25,940
<font color="#CCCCCC">so the call when the</font><font color="#E5E5E5"> shutter was broken</font>

213
00:10:23,570 --> 00:10:28,550
and<font color="#CCCCCC"> and the scope</font><font color="#E5E5E5"> was led down to the</font>

214
00:10:25,940 --> 00:10:31,390
safe<font color="#E5E5E5"> we switched the sensor by</font>

215
00:10:28,550 --> 00:10:34,459
simulating an authentication<font color="#E5E5E5"> of</font><font color="#CCCCCC"> the</font>

216
00:10:31,390 --> 00:10:37,850
engineer<font color="#CCCCCC"> during maintenance this</font>

217
00:10:34,460 --> 00:10:39,800
firmware<font color="#CCCCCC"> called this pencil fortune</font><font color="#E5E5E5"> cash</font>

218
00:10:37,850 --> 00:10:44,420
<font color="#E5E5E5">issued test was unlocked</font>

219
00:10:39,800 --> 00:10:47,120
which was used by<font color="#CCCCCC"> the attackers at this</font>

220
00:10:44,420 --> 00:10:48,810
point it would<font color="#CCCCCC"> have seemed</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> blackbox</font>

221
00:10:47,120 --> 00:10:51,150
attacker think of the

222
00:10:48,810 --> 00:10:53,910
poor diet is a class<font color="#E5E5E5"> since the last</font>

223
00:10:51,150 --> 00:10:56,970
<font color="#CCCCCC">attack refers</font><font color="#E5E5E5"> more to physical attacks</font>

224
00:10:53,910 --> 00:10:58,589
and manufacturers have implemented

225
00:10:56,970 --> 00:11:03,390
encryption everywhere

226
00:10:58,590 --> 00:11:05,340
however we proceed to<font color="#E5E5E5"> our case so to</font>

227
00:11:03,390 --> 00:11:07,319
research ATM<font color="#E5E5E5"> hardware we need to</font>

228
00:11:05,340 --> 00:11:09,840
determine<font color="#E5E5E5"> the</font><font color="#CCCCCC"> manufacturer and</font><font color="#E5E5E5"> hardware</font>

229
00:11:07,320 --> 00:11:12,810
in our case the choice was quite simple

230
00:11:09,840 --> 00:11:15,750
<font color="#E5E5E5">since the NCR is one of the legate's of</font>

231
00:11:12,810 --> 00:11:18,540
ATM vendors<font color="#CCCCCC"> and</font><font color="#E5E5E5"> software for them and</font>

232
00:11:15,750 --> 00:11:22,320
it's also<font color="#E5E5E5"> very prominent on our live</font>

233
00:11:18,540 --> 00:11:25,020
projects<font color="#CCCCCC"> new ATS I considered one of the</font>

234
00:11:22,320 --> 00:11:28,310
<font color="#E5E5E5">most secure in communication with the</font>

235
00:11:25,020 --> 00:11:34,040
dispenser encrypted so our choice is

236
00:11:28,310 --> 00:11:36,449
<font color="#E5E5E5">easily dispenser with NCR</font><font color="#CCCCCC"> s1 controller</font>

237
00:11:34,040 --> 00:11:38,880
<font color="#E5E5E5">usually care dispenser is very complex</font>

238
00:11:36,450 --> 00:11:40,590
<font color="#E5E5E5">device mechanics of dispenser performs a</font>

239
00:11:38,880 --> 00:11:43,230
store in peak<font color="#E5E5E5"> invalidation and</font>

240
00:11:40,590 --> 00:11:45,060
transportation every movement is

241
00:11:43,230 --> 00:11:47,670
performed<font color="#CCCCCC"> by drive unit cell controlled</font>

242
00:11:45,060 --> 00:11:50,520
by sensors<font color="#E5E5E5"> the brain of care dispenser</font>

243
00:11:47,670 --> 00:11:53,300
is in<font color="#E5E5E5"> control electronics they are</font>

244
00:11:50,520 --> 00:11:56,069
<font color="#CCCCCC">usually called this passing controller</font>

245
00:11:53,300 --> 00:11:58,680
all mechanical<font color="#E5E5E5"> parts of dispenser have</font>

246
00:11:56,070 --> 00:12:01,080
their specific names<font color="#E5E5E5"> the dispenser are</font>

247
00:11:58,680 --> 00:12:03,510
built with two or<font color="#CCCCCC"> three or four big</font>

248
00:12:01,080 --> 00:12:05,210
<font color="#E5E5E5">model placed below dispenser model</font>

249
00:12:03,510 --> 00:12:08,310
<font color="#E5E5E5">presenter model sir</font>

250
00:12:05,210 --> 00:12:10,020
bills are<font color="#E5E5E5"> stored to the cassettes also</font>

251
00:12:08,310 --> 00:12:13,040
the dispenser<font color="#E5E5E5"> has dedicated the reject</font>

252
00:12:10,020 --> 00:12:16,949
as a<font color="#CCCCCC"> presenter</font><font color="#E5E5E5"> on pin big banknotes</font>

253
00:12:13,040 --> 00:12:18,900
<font color="#E5E5E5">bills are stored reported from people</font>

254
00:12:16,950 --> 00:12:21,960
<font color="#E5E5E5">mckennon's the blue world date and the</font>

255
00:12:18,900 --> 00:12:24,480
enter presenter in case no error have

256
00:12:21,960 --> 00:12:29,400
<font color="#CCCCCC">accur banknotes are issued through the</font>

257
00:12:24,480 --> 00:12:31,590
shutter dispenser controller<font color="#E5E5E5"> is a</font>

258
00:12:29,400 --> 00:12:33,890
control board<font color="#CCCCCC"> that controls the</font>

259
00:12:31,590 --> 00:12:37,100
operation of currency dispenser

260
00:12:33,890 --> 00:12:39,830
<font color="#E5E5E5">it's called fire purchase</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> waste board</font>

261
00:12:37,100 --> 00:12:42,720
<font color="#E5E5E5">responsible for collecting all senses of</font>

262
00:12:39,830 --> 00:12:46,890
information and operating the mechanics

263
00:12:42,720 --> 00:12:50,970
<font color="#E5E5E5">and also communicating comments to the</font>

264
00:12:46,890 --> 00:12:53,160
<font color="#E5E5E5">PC</font><font color="#CCCCCC"> the control board is</font><font color="#E5E5E5"> released ecology</font>

265
00:12:50,970 --> 00:12:55,740
PCB employing<font color="#CCCCCC"> both toughies</font><font color="#E5E5E5"> more Maui</font>

266
00:12:53,160 --> 00:12:58,560
technologies and play through<font color="#E5E5E5"> the</font><font color="#CCCCCC"> whole</font>

267
00:12:55,740 --> 00:13:01,610
components<font color="#E5E5E5"> the function of control board</font>

268
00:12:58,560 --> 00:13:01,609
you can see<font color="#CCCCCC"> on the slide</font>

269
00:13:09,929 --> 00:13:15,040
so we want<font color="#CCCCCC"> protective future you want</font><font color="#E5E5E5"> to</font>

270
00:13:13,269 --> 00:13:18,819
find and report sample and abilities to

271
00:13:15,040 --> 00:13:22,988
NCR<font color="#E5E5E5"> but you don't have an</font><font color="#CCCCCC"> ATM and you</font>

272
00:13:18,819 --> 00:13:24,969
<font color="#CCCCCC">also don't have</font><font color="#E5E5E5"> fun binary what to do</font>

273
00:13:22,989 --> 00:13:28,920
well unfortunately<font color="#CCCCCC"> for</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> vendor</font>

274
00:13:24,970 --> 00:13:31,689
<font color="#E5E5E5">unfortunately for you is it is possible</font>

275
00:13:28,920 --> 00:13:36,309
<font color="#CCCCCC">for example</font><font color="#E5E5E5"> you can order the dispenser</font>

276
00:13:31,689 --> 00:13:39,790
controller<font color="#E5E5E5"> at eBay but now but how it is</font>

277
00:13:36,309 --> 00:13:41,529
possible<font color="#CCCCCC"> well when something</font><font color="#E5E5E5"> breaks and</font>

278
00:13:39,790 --> 00:13:44,139
<font color="#E5E5E5">the dispenser service center usually</font>

279
00:13:41,529 --> 00:13:46,410
<font color="#E5E5E5">replaces the wall device now somebody</font>

280
00:13:44,139 --> 00:13:48,879
can sell the broken dispenser by parts<font color="#CCCCCC"> I</font>

281
00:13:46,410 --> 00:13:51,879
think important dispenser control you

282
00:13:48,879 --> 00:13:54,339
need<font color="#E5E5E5"> to get its firmware</font><font color="#CCCCCC"> it's much more</font>

283
00:13:51,879 --> 00:14:00,220
harder<font color="#E5E5E5"> but if you help have a friend in</font>

284
00:13:54,339 --> 00:14:01,720
some service center<font color="#CCCCCC"> you can ask him</font><font color="#E5E5E5"> most</font>

285
00:14:00,220 --> 00:14:04,089
of our<font color="#CCCCCC"> tests we don't need food</font>

286
00:14:01,720 --> 00:14:06,610
dispenser assembly<font color="#E5E5E5"> when you want</font><font color="#CCCCCC"> to play</font>

287
00:14:04,089 --> 00:14:09,339
this protocol<font color="#E5E5E5"> and other basic logical</font>

288
00:14:06,610 --> 00:14:14,199
<font color="#CCCCCC">futures</font><font color="#E5E5E5"> or in this control a board power</font>

289
00:14:09,339 --> 00:14:17,980
supply laptop or PC and<font color="#CCCCCC"> USB connection</font>

290
00:14:14,199 --> 00:14:20,410
cable this<font color="#CCCCCC"> slideshow was brief</font>

291
00:14:17,980 --> 00:14:22,720
information about<font color="#E5E5E5"> the home where it's</font>

292
00:14:20,410 --> 00:14:24,939
work based<font color="#E5E5E5"> first of all it's not</font>

293
00:14:22,720 --> 00:14:26,579
encrypted<font color="#E5E5E5"> it will be would</font><font color="#CCCCCC"> be much more</font>

294
00:14:24,939 --> 00:14:29,799
<font color="#CCCCCC">difficult</font><font color="#E5E5E5"> to analyze</font><font color="#CCCCCC"> such file</font>

295
00:14:26,579 --> 00:14:32,589
<font color="#E5E5E5">especially</font><font color="#CCCCCC"> if you can get access to the</font>

296
00:14:29,799 --> 00:14:34,660
encryption<font color="#E5E5E5"> key from PC software part the</font>

297
00:14:32,589 --> 00:14:36,069
second thing is the dispenser<font color="#E5E5E5"> file</font>

298
00:14:34,660 --> 00:14:40,689
headers<font color="#CCCCCC"> rip symbols</font>

299
00:14:36,069 --> 00:14:43,329
it makes our<font color="#E5E5E5"> analysis less difficult to</font>

300
00:14:40,689 --> 00:14:46,629
start with<font color="#E5E5E5"> we must understand that in</font>

301
00:14:43,329 --> 00:14:48,279
<font color="#E5E5E5">our case we have USB device so the term</font>

302
00:14:46,629 --> 00:14:50,459
<font color="#CCCCCC">warm up</font><font color="#E5E5E5"> contains some port that is</font>

303
00:14:48,279 --> 00:14:53,829
<font color="#E5E5E5">responsible for sending and receiving</font>

304
00:14:50,459 --> 00:14:57,488
<font color="#E5E5E5">common packets to find the code we must</font>

305
00:14:53,829 --> 00:15:00,729
find the CPU name on<font color="#CCCCCC"> its cheap and final</font>

306
00:14:57,489 --> 00:15:03,570
data<font color="#CCCCCC"> she</font><font color="#E5E5E5"> document along the with the USB</font>

307
00:15:00,730 --> 00:15:08,040
control register and data register

308
00:15:03,570 --> 00:15:10,350
Constance<font color="#CCCCCC"> here's</font><font color="#E5E5E5"> our research results of</font>

309
00:15:08,040 --> 00:15:12,959
those<font color="#E5E5E5"> constants as you can see we have</font>

310
00:15:10,350 --> 00:15:19,589
found right<font color="#CCCCCC"> packet panel to read packet</font>

311
00:15:12,959 --> 00:15:21,630
factions<font color="#CCCCCC"> you may notice that function</font>

312
00:15:19,589 --> 00:15:23,880
names<font color="#CCCCCC"> mangle</font><font color="#E5E5E5"> adhere and</font><font color="#CCCCCC"> pushing we had</font>

313
00:15:21,630 --> 00:15:25,800
to provoke internal<font color="#CCCCCC"> mangle them I guess</font>

314
00:15:23,880 --> 00:15:29,699
<font color="#E5E5E5">it</font><font color="#CCCCCC"> did happen because of</font><font color="#E5E5E5"> which were</font>

315
00:15:25,800 --> 00:15:32,279
<font color="#E5E5E5">compared compiler peculiarities the</font>

316
00:15:29,699 --> 00:15:34,258
first thing that<font color="#CCCCCC"> we will face is going</font>

317
00:15:32,279 --> 00:15:34,980
<font color="#E5E5E5">to the net since the public metrology</font>

318
00:15:34,259 --> 00:15:38,490
compilers

319
00:15:34,980 --> 00:15:40,560
another thing will be<font color="#CCCCCC"> C++ which</font><font color="#E5E5E5"> all</font>

320
00:15:38,490 --> 00:15:47,040
function tables and virtual calls will

321
00:15:40,560 --> 00:15:48,930
be difficult to analyze in x86<font color="#CCCCCC"> two if</font>

322
00:15:47,040 --> 00:15:50,849
you divide the court in two main

323
00:15:48,930 --> 00:15:53,819
<font color="#CCCCCC">components you will get following scheme</font>

324
00:15:50,850 --> 00:15:55,920
<font color="#E5E5E5">the first level of threat is responsible</font>

325
00:15:53,819 --> 00:15:58,410
for<font color="#E5E5E5"> receiving</font><font color="#CCCCCC"> distributed be breakers</font>

326
00:15:55,920 --> 00:16:00,719
between services so<font color="#E5E5E5"> this is the</font>

327
00:15:58,410 --> 00:16:04,370
basically execution units<font color="#E5E5E5"> each of them</font>

328
00:16:00,720 --> 00:16:08,880
has its<font color="#CCCCCC"> own</font><font color="#E5E5E5"> role and it's all tasks</font>

329
00:16:04,370 --> 00:16:11,010
<font color="#E5E5E5">collectors here</font><font color="#CCCCCC"> paths that</font><font color="#E5E5E5"> executable by</font>

330
00:16:08,880 --> 00:16:15,540
different services used in such thing as

331
00:16:11,010 --> 00:16:17,100
control control its<font color="#E5E5E5"> geological things in</font>

332
00:16:15,540 --> 00:16:19,589
fact<font color="#E5E5E5"> we have workers who</font><font color="#CCCCCC"> perform</font>

333
00:16:17,100 --> 00:16:25,290
comments validation execution and answer

334
00:16:19,589 --> 00:16:27,750
<font color="#E5E5E5">form in duplicate the exact command you</font>

335
00:16:25,290 --> 00:16:31,439
must specify a class and<font color="#E5E5E5"> the logical</font>

336
00:16:27,750 --> 00:16:34,740
control indexes before that<font color="#CCCCCC"> comment will</font>

337
00:16:31,440 --> 00:16:36,269
be<font color="#E5E5E5"> executed the execute function it will</font>

338
00:16:34,740 --> 00:16:38,880
be checked<font color="#E5E5E5"> with</font><font color="#CCCCCC"> validate form and</font>

339
00:16:36,269 --> 00:16:40,889
function function her motor is pause

340
00:16:38,880 --> 00:16:46,560
function phone<font color="#E5E5E5"> server is post packet</font>

341
00:16:40,889 --> 00:16:48,600
music educational results<font color="#E5E5E5"> dispenser</font>

342
00:16:46,560 --> 00:16:51,329
transaction service is most interesting

343
00:16:48,600 --> 00:16:54,110
<font color="#CCCCCC">service for us it works with banknote</font>

344
00:16:51,329 --> 00:16:58,500
<font color="#CCCCCC">withdrawal command</font><font color="#E5E5E5"> in their encryption</font>

345
00:16:54,110 --> 00:17:01,230
this service<font color="#E5E5E5"> has three classes but only</font>

346
00:16:58,500 --> 00:17:03,779
two of<font color="#E5E5E5"> them are moved to interesting</font>

347
00:17:01,230 --> 00:17:05,819
place one works with the secure messages

348
00:17:03,779 --> 00:17:08,089
and second one works with encrypted

349
00:17:05,819 --> 00:17:10,280
<font color="#CCCCCC">secure messages</font>

350
00:17:08,089 --> 00:17:12,919
the only difference<font color="#E5E5E5"> between them is what</font>

351
00:17:10,280 --> 00:17:16,460
class was keep some more secure commands

352
00:17:12,920 --> 00:17:17,180
<font color="#E5E5E5">using or reject array with comment</font>

353
00:17:16,460 --> 00:17:21,620
indexes

354
00:17:17,180 --> 00:17:25,250
my<font color="#E5E5E5"> guess is previously what was only one</font>

355
00:17:21,619 --> 00:17:29,600
class<font color="#E5E5E5"> this</font><font color="#CCCCCC"> code looks more like a fast</font>

356
00:17:25,250 --> 00:17:31,700
fix rather than good approach on this

357
00:17:29,600 --> 00:17:34,219
<font color="#E5E5E5">slide</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> see the sequence of actions</font>

358
00:17:31,700 --> 00:17:40,580
<font color="#CCCCCC">that needs to be</font><font color="#E5E5E5"> taken to generate</font>

359
00:17:34,220 --> 00:17:42,350
initial key the first reaction is to

360
00:17:40,580 --> 00:17:44,210
<font color="#E5E5E5">select the encryption acceleration</font>

361
00:17:42,350 --> 00:17:46,310
command on service operations Korean

362
00:17:44,210 --> 00:17:48,260
then you need to toggle the<font color="#E5E5E5"> bottom</font>

363
00:17:46,310 --> 00:17:51,020
cassette in the same order before

364
00:17:48,260 --> 00:17:53,570
switching the special tumbler<font color="#E5E5E5"> on the</font>

365
00:17:51,020 --> 00:17:56,770
<font color="#CCCCCC">controller board</font><font color="#E5E5E5"> all within one</font><font color="#CCCCCC"> minute</font>

366
00:17:53,570 --> 00:18:01,550
after<font color="#E5E5E5"> the</font><font color="#CCCCCC"> atra dispenser will send you</font>

367
00:17:56,770 --> 00:18:05,389
initial key encryption keys cave<font color="#CCCCCC"> heroine</font>

368
00:18:01,550 --> 00:18:08,240
types it means that every key for<font color="#CCCCCC"> every</font>

369
00:18:05,390 --> 00:18:10,750
message<font color="#E5E5E5"> will</font><font color="#CCCCCC"> be different because of</font><font color="#E5E5E5"> the</font>

370
00:18:08,240 --> 00:18:13,660
role in component like<font color="#CCCCCC"> accession number</font>

371
00:18:10,750 --> 00:18:16,580
<font color="#CCCCCC">okay they</font><font color="#E5E5E5"> think that it's possible to</font>

372
00:18:13,660 --> 00:18:21,320
intercept<font color="#E5E5E5"> the packet with the initial</font>

373
00:18:16,580 --> 00:18:23,629
key and use<font color="#E5E5E5"> it</font><font color="#CCCCCC"> them know it's left in</font>

374
00:18:21,320 --> 00:18:27,649
the candle<font color="#CCCCCC"> initiate initiate</font><font color="#E5E5E5"> the</font>

375
00:18:23,630 --> 00:18:29,450
exchange<font color="#CCCCCC"> comment the PC also send</font><font color="#E5E5E5"> the</font>

376
00:18:27,650 --> 00:18:31,790
public key we shall be used to

377
00:18:29,450 --> 00:18:34,520
<font color="#E5E5E5">encrypting the initial key another part</font>

378
00:18:31,790 --> 00:18:37,820
of the comment is<font color="#E5E5E5"> the hardware ID which</font>

379
00:18:34,520 --> 00:18:42,610
must be<font color="#CCCCCC"> equal to real one that makes</font>

380
00:18:37,820 --> 00:18:42,610
<font color="#CCCCCC">brute forcing of this comment</font><font color="#E5E5E5"> impossible</font>

381
00:18:42,820 --> 00:18:48,260
unfortunately we have haven't<font color="#CCCCCC"> the</font>

382
00:18:45,740 --> 00:18:50,150
physical access<font color="#E5E5E5"> to the safe where the</font>

383
00:18:48,260 --> 00:18:51,710
dispenser controller is located so we

384
00:18:50,150 --> 00:18:54,410
cannot perform<font color="#E5E5E5"> the</font><font color="#CCCCCC"> initial</font><font color="#E5E5E5"> key</font>

385
00:18:51,710 --> 00:18:56,690
exchanging it's only possible<font color="#E5E5E5"> in the</font>

386
00:18:54,410 --> 00:18:59,240
protection<font color="#CCCCCC"> level parameter was set to</font>

387
00:18:56,690 --> 00:19:02,240
USB<font color="#E5E5E5"> or logical one</font><font color="#CCCCCC"> to done</font><font color="#E5E5E5"> grid</font>

388
00:18:59,240 --> 00:19:04,760
protection level<font color="#CCCCCC"> two from physical</font>

389
00:19:02,240 --> 00:19:08,950
while you also need to<font color="#CCCCCC"> have physical</font>

390
00:19:04,760 --> 00:19:11,660
<font color="#E5E5E5">access</font><font color="#CCCCCC"> to safe so what should we</font><font color="#E5E5E5"> do</font>

391
00:19:08,950 --> 00:19:14,200
<font color="#CCCCCC">surely there is a way how</font><font color="#E5E5E5"> to proceed a</font>

392
00:19:11,660 --> 00:19:15,830
<font color="#E5E5E5">lot the firmware binary in the dispenser</font>

393
00:19:14,200 --> 00:19:19,430
usually<font color="#CCCCCC"> settings</font>

394
00:19:15,830 --> 00:19:21,389
<font color="#E5E5E5">I called boot loaders and we must find</font>

395
00:19:19,430 --> 00:19:25,390
it

396
00:19:21,390 --> 00:19:27,250
<font color="#CCCCCC">sometime</font><font color="#E5E5E5"> later we found the service that</font>

397
00:19:25,390 --> 00:19:30,310
<font color="#E5E5E5">is</font><font color="#CCCCCC"> responsible for submission to</font><font color="#E5E5E5"> the</font>

398
00:19:27,250 --> 00:19:34,480
<font color="#E5E5E5">Claude and</font><font color="#CCCCCC"> its length see</font><font color="#E5E5E5"> you will</font><font color="#CCCCCC"> be</font>

399
00:19:30,310 --> 00:19:36,790
eased our<font color="#CCCCCC"> Lord servers the</font><font color="#E5E5E5"> only things</font>

400
00:19:34,480 --> 00:19:39,700
that<font color="#CCCCCC"> his</font><font color="#E5E5E5"> days are switching in turbid</font>

401
00:19:36,790 --> 00:19:41,680
water and<font color="#E5E5E5"> certainly is be the device</font>

402
00:19:39,700 --> 00:19:45,220
<font color="#CCCCCC">information like</font><font color="#E5E5E5"> a vendor ID</font>

403
00:19:41,680 --> 00:19:47,710
<font color="#E5E5E5">productivity and packet size to us the</font>

404
00:19:45,220 --> 00:19:49,750
most<font color="#E5E5E5"> interesting fact is that comments</font>

405
00:19:47,710 --> 00:19:54,220
of<font color="#CCCCCC"> this separation don't require to be</font>

406
00:19:49,750 --> 00:19:57,100
encrypted the boot water itself has been

407
00:19:54,220 --> 00:20:01,300
hiding<font color="#E5E5E5"> from us for long</font>

408
00:19:57,100 --> 00:20:04,120
it could have found by<font color="#E5E5E5"> three in search</font>

409
00:20:01,300 --> 00:20:07,629
of function<font color="#CCCCCC"> names search we have found</font>

410
00:20:04,120 --> 00:20:10,270
it in data section in the foremost that

411
00:20:07,630 --> 00:20:14,500
leads to him<font color="#E5E5E5"> actually</font><font color="#CCCCCC"> the secure</font><font color="#E5E5E5"> world</font>

412
00:20:10,270 --> 00:20:22,360
in his name is a fake<font color="#E5E5E5"> because</font><font color="#CCCCCC"> there is</font>

413
00:20:14,500 --> 00:20:24,700
no any security in it this part of

414
00:20:22,360 --> 00:20:27,370
research was most difficult we have

415
00:20:24,700 --> 00:20:31,240
<font color="#E5E5E5">pre-programmed</font><font color="#CCCCCC"> and we really preload</font>

416
00:20:27,370 --> 00:20:33,060
times so I still<font color="#CCCCCC"> decide to make sure</font>

417
00:20:31,240 --> 00:20:35,920
were download research you must

418
00:20:33,060 --> 00:20:39,429
understand that<font color="#E5E5E5"> without and we're on the</font>

419
00:20:35,920 --> 00:20:45,310
cap<font color="#CCCCCC"> you</font><font color="#E5E5E5"> have many changes to bring your</font>

420
00:20:39,430 --> 00:20:49,330
device so what we need to<font color="#E5E5E5"> do is to fix</font>

421
00:20:45,310 --> 00:20:52,270
<font color="#E5E5E5">your farmer</font><font color="#CCCCCC"> by our final</font><font color="#E5E5E5"> cover by now</font>

422
00:20:49,330 --> 00:20:53,189
according<font color="#CCCCCC"> to</font><font color="#E5E5E5"> you intense surely for</font>

423
00:20:52,270 --> 00:20:55,840
research

424
00:20:53,190 --> 00:20:59,260
the first action is to switch<font color="#E5E5E5"> into a</font>

425
00:20:55,840 --> 00:21:02,889
<font color="#E5E5E5">bootloader</font><font color="#CCCCCC"> at this step</font><font color="#E5E5E5"> the special</font>

426
00:20:59,260 --> 00:21:06,550
<font color="#CCCCCC">clock will be certainly NVRAM at will be</font>

427
00:21:02,890 --> 00:21:08,620
checked at<font color="#CCCCCC"> drummer</font><font color="#E5E5E5"> boot this flag what</font>

428
00:21:06,550 --> 00:21:11,830
the calls are mutable<font color="#E5E5E5"> firmware during</font>

429
00:21:08,620 --> 00:21:14,020
our<font color="#E5E5E5"> tents the second reaction is to</font>

430
00:21:11,830 --> 00:21:16,600
generate<font color="#E5E5E5"> a key player for sanity check</font>

431
00:21:14,020 --> 00:21:19,389
that<font color="#CCCCCC"> will be performed later</font><font color="#E5E5E5"> so timed</font>

432
00:21:16,600 --> 00:21:23,110
firmware is a popular phenomenon but is

433
00:21:19,390 --> 00:21:25,050
fully useless in our case<font color="#CCCCCC"> because it</font>

434
00:21:23,110 --> 00:21:29,800
won't help<font color="#E5E5E5"> you</font><font color="#CCCCCC"> to protect the firmware</font>

435
00:21:25,050 --> 00:21:31,960
<font color="#E5E5E5">if you are able to change public key you</font>

436
00:21:29,800 --> 00:21:32,559
may specify the controller serial number

437
00:21:31,960 --> 00:21:35,669
and

438
00:21:32,559 --> 00:21:38,830
<font color="#E5E5E5">the version of the</font><font color="#CCCCCC"> song where it third</font>

439
00:21:35,669 --> 00:21:41,289
step we need<font color="#E5E5E5"> to</font><font color="#CCCCCC"> send the reboot command</font>

440
00:21:38,830 --> 00:21:46,330
the dispenser<font color="#CCCCCC"> bootloader will be boot</font>

441
00:21:41,289 --> 00:21:50,110
again<font color="#E5E5E5"> the next</font><font color="#CCCCCC"> - action what we need to</font>

442
00:21:46,330 --> 00:21:53,340
perform<font color="#E5E5E5"> is</font><font color="#CCCCCC"> the same data in text</font><font color="#E5E5E5"> section</font>

443
00:21:50,110 --> 00:21:55,990
<font color="#CCCCCC">sequentially specifying physical</font>

444
00:21:53,340 --> 00:21:59,289
addresses<font color="#E5E5E5"> in size for every block in the</font>

445
00:21:55,990 --> 00:22:02,710
<font color="#E5E5E5">packet hidden here are</font><font color="#CCCCCC"> all the problems</font>

446
00:21:59,289 --> 00:22:05,499
<font color="#CCCCCC">were encountered you can adjust</font><font color="#E5E5E5"> write a</font>

447
00:22:02,710 --> 00:22:07,539
change<font color="#E5E5E5"> book you must write a wall from</font>

448
00:22:05,499 --> 00:22:10,690
<font color="#E5E5E5">where</font><font color="#CCCCCC"> experientially also you can</font>

449
00:22:07,539 --> 00:22:14,440
specify which<font color="#E5E5E5"> orders here if you have</font><font color="#CCCCCC"> to</font>

450
00:22:10,690 --> 00:22:17,169
despite the clinical ones at this<font color="#E5E5E5"> moment</font>

451
00:22:14,440 --> 00:22:19,869
we must already Kelly<font color="#E5E5E5"> Chuang calculate</font>

452
00:22:17,169 --> 00:22:23,019
cash for uploaded buyers<font color="#E5E5E5"> and equipment</font>

453
00:22:19,869 --> 00:22:26,428
with the private key<font color="#E5E5E5"> or the key pair</font>

454
00:22:23,019 --> 00:22:29,460
that we was generated at previous steps

455
00:22:26,429 --> 00:22:34,240
also<font color="#CCCCCC"> we need to</font><font color="#E5E5E5"> calculate the sum of</font>

456
00:22:29,460 --> 00:22:37,419
routine health wards<font color="#CCCCCC"> a</font><font color="#E5E5E5"> typical step we</font>

457
00:22:34,240 --> 00:22:40,929
must send the sign<font color="#E5E5E5"> cash so that</font><font color="#CCCCCC"> a</font>

458
00:22:37,419 --> 00:22:43,809
<font color="#E5E5E5">bootloader will check the data was</font><font color="#CCCCCC"> only</font>

459
00:22:40,929 --> 00:22:49,299
for his sensual<font color="#CCCCCC"> dashing</font><font color="#E5E5E5"> files they</font><font color="#CCCCCC"> will</font>

460
00:22:43,809 --> 00:22:51,460
<font color="#E5E5E5">give you will get brick again the</font><font color="#CCCCCC"> 6th</font>

461
00:22:49,299 --> 00:22:54,340
step requires<font color="#CCCCCC"> send in calculated checks</font>

462
00:22:51,460 --> 00:22:58,179
on the physical<font color="#CCCCCC"> description well by its</font>

463
00:22:54,340 --> 00:23:01,959
downloaded here there were few<font color="#E5E5E5"> problems</font>

464
00:22:58,179 --> 00:23:04,210
<font color="#CCCCCC">-</font><font color="#E5E5E5"> because I couldn't find a check for a</font>

465
00:23:01,960 --> 00:23:09,309
physical<font color="#E5E5E5"> address field and</font><font color="#CCCCCC"> it led to</font>

466
00:23:04,210 --> 00:23:10,710
<font color="#E5E5E5">brick device in many times and we have</font>

467
00:23:09,309 --> 00:23:13,269
another attempt

468
00:23:10,710 --> 00:23:16,830
<font color="#E5E5E5">and finally the</font><font color="#CCCCCC"> current firmware</font>

469
00:23:13,269 --> 00:23:20,529
successfully unloaded and we were happy

470
00:23:16,830 --> 00:23:24,220
<font color="#E5E5E5">but could we unload some old few words</font>

471
00:23:20,529 --> 00:23:27,759
with<font color="#E5E5E5"> the old one</font><font color="#CCCCCC"> er abilities and we</font>

472
00:23:24,220 --> 00:23:31,600
<font color="#E5E5E5">tried to do that and disappeared some</font>

473
00:23:27,759 --> 00:23:34,299
more problems<font color="#E5E5E5"> there was</font><font color="#CCCCCC"> checked with the</font>

474
00:23:31,600 --> 00:23:35,889
downloadable firmware had<font color="#CCCCCC"> some same or</font>

475
00:23:34,299 --> 00:23:41,590
greater version<font color="#CCCCCC"> Lambo</font>

476
00:23:35,890 --> 00:23:45,990
then in current firmware<font color="#E5E5E5"> this shape can</font>

477
00:23:41,590 --> 00:23:48,669
be<font color="#E5E5E5"> skipped if no physical access or set</font>

478
00:23:45,990 --> 00:23:51,700
but it's not<font color="#E5E5E5"> possible for us</font>

479
00:23:48,670 --> 00:23:56,020
but luckily when the right it will

480
00:23:51,700 --> 00:24:01,440
ability to<font color="#CCCCCC"> upload</font><font color="#E5E5E5"> any firmware binary if</font>

481
00:23:56,020 --> 00:24:03,879
it's worth<font color="#E5E5E5"> only called 404</font><font color="#CCCCCC"> F in hex</font>

482
00:24:01,440 --> 00:24:05,830
<font color="#E5E5E5">money withdrawal was still a problem</font>

483
00:24:03,880 --> 00:24:08,470
encryption<font color="#CCCCCC"> function was professionally</font>

484
00:24:05,830 --> 00:24:11,168
implemented so we decided<font color="#E5E5E5"> to fix secure</font>

485
00:24:08,470 --> 00:24:14,980
command function<font color="#E5E5E5"> so that</font><font color="#CCCCCC"> is good</font><font color="#E5E5E5"> well</font>

486
00:24:11,169 --> 00:24:17,350
secure a music<font color="#E5E5E5"> execute any secure</font>

487
00:24:14,980 --> 00:24:20,200
<font color="#E5E5E5">comment without any encryption to do</font>

488
00:24:17,350 --> 00:24:22,959
that<font color="#E5E5E5"> you just need to make move</font><font color="#CCCCCC"> zero to</font>

489
00:24:20,200 --> 00:24:26,830
<font color="#CCCCCC">the zero</font><font color="#E5E5E5"> in assembly language</font><font color="#CCCCCC"> and then</font>

490
00:24:22,960 --> 00:24:30,130
perform it on<font color="#E5E5E5"> pole to sum</font><font color="#CCCCCC"> up</font><font color="#E5E5E5"> we have an</font>

491
00:24:26,830 --> 00:24:33,399
ability to not use<font color="#E5E5E5"> a cassette or tumblr</font>

492
00:24:30,130 --> 00:24:37,030
<font color="#E5E5E5">switching we can patch every byte in the</font>

493
00:24:33,400 --> 00:24:39,610
car world and now<font color="#E5E5E5"> protections level is</font>

494
00:24:37,030 --> 00:24:41,860
not<font color="#CCCCCC"> a problem</font><font color="#E5E5E5"> on this</font><font color="#CCCCCC"> slide you can see</font>

495
00:24:39,610 --> 00:24:45,340
<font color="#CCCCCC">the</font><font color="#E5E5E5"> message change toggle switch</font><font color="#CCCCCC"> on</font>

496
00:24:41,860 --> 00:24:47,379
<font color="#E5E5E5">bottom cassette within one minute and</font>

497
00:24:45,340 --> 00:24:53,168
<font color="#E5E5E5">dispenser protection configuration is</font>

498
00:24:47,380 --> 00:24:56,380
physical so the farmer will download<font color="#CCCCCC"> it</font>

499
00:24:53,169 --> 00:24:59,530
but is not<font color="#CCCCCC"> interesting</font><font color="#E5E5E5"> for us as money</font>

500
00:24:56,380 --> 00:25:01,650
withdrawal<font color="#CCCCCC"> unfortunately</font><font color="#E5E5E5"> the world we'd</font>

501
00:24:59,530 --> 00:25:05,678
ruin the money is<font color="#E5E5E5"> also difficult task</font>

502
00:25:01,650 --> 00:25:07,330
just look at the graph<font color="#E5E5E5"> all function the</font>

503
00:25:05,679 --> 00:25:09,630
<font color="#E5E5E5">checks withdrawal packets validity</font>

504
00:25:07,330 --> 00:25:15,100
<font color="#E5E5E5">should revisit the complete it would be</font>

505
00:25:09,630 --> 00:25:17,559
easy<font color="#E5E5E5"> this</font><font color="#CCCCCC"> check control is is that part</font>

506
00:25:15,100 --> 00:25:20,590
<font color="#E5E5E5">of port which makes bundles of banknotes</font>

507
00:25:17,559 --> 00:25:21,730
<font color="#E5E5E5">check the hardware and many other</font>

508
00:25:20,590 --> 00:25:25,840
<font color="#CCCCCC">mechanisms</font>

509
00:25:21,730 --> 00:25:30,280
they'd get strike<font color="#E5E5E5"> it also checked</font>

510
00:25:25,840 --> 00:25:31,840
ATM was tempered it was difficult<font color="#E5E5E5"> to</font>

511
00:25:30,280 --> 00:25:34,450
analyze the state control<font color="#CCCCCC"> desiring</font>

512
00:25:31,840 --> 00:25:36,309
without any peripherals<font color="#E5E5E5"> in fact my</font>

513
00:25:34,450 --> 00:25:38,919
colleague didn't want to analyze they

514
00:25:36,309 --> 00:25:40,660
take controller at all well look at the

515
00:25:38,919 --> 00:25:41,560
<font color="#CCCCCC">world a pawn</font><font color="#E5E5E5"> function was allowed to</font>

516
00:25:40,660 --> 00:25:44,590
<font color="#E5E5E5">close it's cool</font>

517
00:25:41,560 --> 00:25:48,790
and never to return to it again but

518
00:25:44,590 --> 00:25:50,919
after<font color="#CCCCCC"> we know is it cold cold</font><font color="#E5E5E5"> we had to</font>

519
00:25:48,790 --> 00:25:54,250
turn<font color="#CCCCCC"> to</font><font color="#E5E5E5"> the State Controller function</font>

520
00:25:50,920 --> 00:25:56,440
<font color="#E5E5E5">the problem was not only in</font><font color="#CCCCCC"> sports ice</font>

521
00:25:54,250 --> 00:26:00,940
the<font color="#CCCCCC"> captured</font><font color="#E5E5E5"> traffic</font><font color="#CCCCCC"> they contain</font><font color="#E5E5E5"> at</font>

522
00:25:56,440 --> 00:26:03,880
this<font color="#CCCCCC"> moment</font><font color="#E5E5E5"> was encrypted</font><font color="#CCCCCC"> here I want to</font>

523
00:26:00,940 --> 00:26:06,250
say few<font color="#E5E5E5"> words about the controller</font>

524
00:26:03,880 --> 00:26:09,100
comment himself<font color="#CCCCCC"> the first thing we</font><font color="#E5E5E5"> must</font>

525
00:26:06,250 --> 00:26:11,860
specify<font color="#CCCCCC"> the cassette</font><font color="#E5E5E5"> Lamberson</font><font color="#CCCCCC"> dish</font>

526
00:26:09,100 --> 00:26:15,070
<font color="#CCCCCC">banknotes a storage case</font><font color="#E5E5E5"> it numbers are</font>

527
00:26:11,860 --> 00:26:17,620
virtual<font color="#E5E5E5"> ones and they can be reassigned</font>

528
00:26:15,070 --> 00:26:21,189
but in our case their numbers were equal

529
00:26:17,620 --> 00:26:23,860
to<font color="#CCCCCC"> real estate</font><font color="#E5E5E5"> location all its life to</font>

530
00:26:21,190 --> 00:26:27,460
see that we asked the first cassette to

531
00:26:23,860 --> 00:26:30,100
<font color="#CCCCCC">give</font><font color="#E5E5E5"> give us five</font><font color="#CCCCCC"> banknotes</font><font color="#E5E5E5"> if you</font>

532
00:26:27,460 --> 00:26:32,830
cassette<font color="#E5E5E5"> don't care the required amount</font>

533
00:26:30,100 --> 00:26:38,740
of<font color="#CCCCCC"> banknotes</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> dispenser so</font><font color="#E5E5E5"> you will</font>

534
00:26:32,830 --> 00:26:39,909
send you an error after<font color="#E5E5E5"> we worked out</font>

535
00:26:38,740 --> 00:26:42,550
the<font color="#CCCCCC"> state-controlled</font>

536
00:26:39,910 --> 00:26:45,190
<font color="#CCCCCC">words we decided to be formed the</font><font color="#E5E5E5"> first</font>

537
00:26:42,550 --> 00:26:48,010
real withdrawal<font color="#E5E5E5"> oedema assembly the from</font>

538
00:26:45,190 --> 00:26:50,380
<font color="#E5E5E5">well with with a fix it</font><font color="#CCCCCC"> secured</font><font color="#E5E5E5"> common</font>

539
00:26:48,010 --> 00:26:51,970
function which<font color="#E5E5E5"> I have mentioned</font><font color="#CCCCCC"> before</font>

540
00:26:50,380 --> 00:26:54,250
the load the<font color="#E5E5E5"> different were in the</font>

541
00:26:51,970 --> 00:26:57,460
dispenser and<font color="#CCCCCC"> same they take control s</font>

542
00:26:54,250 --> 00:26:59,460
withdrawal command in the response we

543
00:26:57,460 --> 00:27:03,490
received a<font color="#CCCCCC"> message about hardware error</font>

544
00:26:59,460 --> 00:27:04,470
there was many versions of why that that

545
00:27:03,490 --> 00:27:08,200
would happen

546
00:27:04,470 --> 00:27:10,690
<font color="#E5E5E5">ranging from malfunction of ATM hardware</font>

547
00:27:08,200 --> 00:27:15,040
to additional checks<font color="#E5E5E5"> we have not</font>

548
00:27:10,690 --> 00:27:15,760
performed<font color="#CCCCCC"> that</font><font color="#E5E5E5"> day we</font><font color="#CCCCCC"> did not didn't get</font>

549
00:27:15,040 --> 00:27:18,100
any money

550
00:27:15,760 --> 00:27:21,879
we were operated dispenser was

551
00:27:18,100 --> 00:27:24,399
completely broken<font color="#CCCCCC"> a little bit later we</font>

552
00:27:21,880 --> 00:27:26,470
<font color="#E5E5E5">found the</font><font color="#CCCCCC"> clean went up</font><font color="#E5E5E5"> at command and</font>

553
00:27:24,400 --> 00:27:29,680
we<font color="#E5E5E5"> decided</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> use it just because</font><font color="#CCCCCC"> it</font>

554
00:27:26,470 --> 00:27:32,560
name because<font color="#CCCCCC"> its name looks</font><font color="#E5E5E5"> interesting</font>

555
00:27:29,680 --> 00:27:33,700
this command is necessary for money

556
00:27:32,560 --> 00:27:36,070
withdrawal<font color="#E5E5E5"> patters</font>

557
00:27:33,700 --> 00:27:39,700
to clear and they need some related

558
00:27:36,070 --> 00:27:42,970
<font color="#E5E5E5">things unfortunately</font><font color="#CCCCCC"> the real packet was</font>

559
00:27:39,700 --> 00:27:48,400
captured<font color="#E5E5E5"> to</font><font color="#CCCCCC"> soul</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> Python</font><font color="#E5E5E5"> help dampen</font>

560
00:27:42,970 --> 00:27:50,620
the slide<font color="#E5E5E5"> was presented after the mid</font>

561
00:27:48,400 --> 00:27:54,200
second withdrawal<font color="#E5E5E5"> prior using clear</font>

562
00:27:50,620 --> 00:27:57,179
minecraft<font color="#E5E5E5"> for command</font><font color="#CCCCCC"> we good money</font>

563
00:27:54,200 --> 00:27:59,520
after a long painful search after<font color="#CCCCCC"> death</font>

564
00:27:57,180 --> 00:28:02,100
<font color="#E5E5E5">sometimes</font><font color="#CCCCCC"> break-in controllers we</font>

565
00:27:59,520 --> 00:28:05,190
managed<font color="#CCCCCC"> to</font><font color="#E5E5E5"> make</font><font color="#CCCCCC"> withdrawal</font><font color="#E5E5E5"> as a result</font>

566
00:28:02,100 --> 00:28:07,260
we have succeed to execute our<font color="#E5E5E5"> code by</font>

567
00:28:05,190 --> 00:28:10,020
passing the encryption worked out take

568
00:28:07,260 --> 00:28:14,220
control principles to understand how a

569
00:28:10,020 --> 00:28:16,410
team<font color="#E5E5E5"> cash withdrawal occurs and</font><font color="#CCCCCC"> how</font><font color="#E5E5E5"> also</font>

570
00:28:14,220 --> 00:28:19,350
learnt about<font color="#CCCCCC"> how</font><font color="#E5E5E5"> to ensure initialize</font>

571
00:28:16,410 --> 00:28:37,410
all<font color="#CCCCCC"> the mechanics correctly</font><font color="#E5E5E5"> let's see</font>

572
00:28:19,350 --> 00:28:41,990
the demo some preparation<font color="#E5E5E5"> at the as I</font>

573
00:28:37,410 --> 00:28:46,070
<font color="#CCCCCC">mention before we</font><font color="#E5E5E5"> need to exchange</font>

574
00:28:41,990 --> 00:28:55,910
initial keys with the<font color="#CCCCCC"> code TC control of</font>

575
00:28:46,070 --> 00:28:55,909
<font color="#E5E5E5">ATM you can see words I mentioned</font><font color="#CCCCCC"> before</font>

576
00:29:15,800 --> 00:29:26,270
and then it's out indicated and it's

577
00:29:20,150 --> 00:29:32,960
<font color="#E5E5E5">secure protection level is physical so</font>

578
00:29:26,270 --> 00:29:40,970
let's start we take<font color="#CCCCCC"> a</font><font color="#E5E5E5"> USB cable from PC</font>

579
00:29:32,960 --> 00:29:45,110
<font color="#CCCCCC">connected to our laptop</font><font color="#E5E5E5"> and started our</font>

580
00:29:40,970 --> 00:29:48,110
proof of concept<font color="#CCCCCC"> court we have</font><font color="#E5E5E5"> no</font>

581
00:29:45,110 --> 00:29:54,070
optimization<font color="#E5E5E5"> of this process because</font><font color="#CCCCCC"> as</font>

582
00:29:48,110 --> 00:29:54,070
proof of<font color="#E5E5E5"> concept</font><font color="#CCCCCC"> and not</font><font color="#E5E5E5"> a real attack</font>

583
00:29:55,330 --> 00:30:06,649
now you look at the<font color="#E5E5E5"> firmware applauding</font>

584
00:29:58,929 --> 00:30:19,340
it requires some time and this bit of

585
00:30:06,650 --> 00:30:23,480
video increased a little<font color="#CCCCCC"> bit also you</font>

586
00:30:19,340 --> 00:30:25,780
can see time<font color="#E5E5E5"> stamp on the bottom on</font><font color="#CCCCCC"> the</font>

587
00:30:23,480 --> 00:30:25,780
screen

588
00:30:44,539 --> 00:31:03,000
now we need to reboot<font color="#E5E5E5"> the new hover and</font>

589
00:30:48,450 --> 00:31:06,960
in it all mechanical Hardware then send

590
00:31:03,000 --> 00:31:13,400
clear mail transfer command to clear all

591
00:31:06,960 --> 00:31:20,370
the things<font color="#E5E5E5"> inside ATM and the test port</font>

592
00:31:13,400 --> 00:31:31,980
used to reject<font color="#CCCCCC"> cassette and then we</font><font color="#E5E5E5"> send</font>

593
00:31:20,370 --> 00:31:41,939
withdrawal command and we take money for

594
00:31:31,980 --> 00:31:43,799
<font color="#E5E5E5">four minutes with no</font><font color="#CCCCCC"> optimized</font><font color="#E5E5E5"> code so</font>

595
00:31:41,940 --> 00:31:49,500
this<font color="#E5E5E5"> is a demonstration video that</font>

596
00:31:43,799 --> 00:31:52,440
accuse our<font color="#CCCCCC"> track was successful after we</font>

597
00:31:49,500 --> 00:31:54,840
shoot ourselves<font color="#CCCCCC"> led vulnerability really</font>

598
00:31:52,440 --> 00:31:59,100
allows<font color="#E5E5E5"> them to keep a</font><font color="#CCCCCC"> bit</font><font color="#E5E5E5"> report and</font>

599
00:31:54,840 --> 00:32:01,678
issue the money<font color="#E5E5E5"> the</font><font color="#CCCCCC"> report</font><font color="#E5E5E5"> were</font><font color="#CCCCCC"> sent to</font>

600
00:31:59,100 --> 00:32:05,039
<font color="#E5E5E5">in cell and see our left this lab</font>

601
00:32:01,679 --> 00:32:09,659
<font color="#E5E5E5">December the research was done</font><font color="#CCCCCC"> on the</font>

602
00:32:05,039 --> 00:32:13,700
basis of s1<font color="#CCCCCC"> controller</font><font color="#E5E5E5"> but later it was</font>

603
00:32:09,659 --> 00:32:19,110
<font color="#E5E5E5">confirmed for</font><font color="#CCCCCC"> s2 the presence of</font>

604
00:32:13,700 --> 00:32:22,710
vulnerability was controlled<font color="#E5E5E5"> and fixed</font>

605
00:32:19,110 --> 00:32:25,020
<font color="#CCCCCC">using the</font><font color="#E5E5E5"> February security fix as you</font>

606
00:32:22,710 --> 00:32:28,110
can see there are 2<font color="#CCCCCC"> GB numbers for these</font>

607
00:32:25,020 --> 00:32:32,879
vulnerabilities they are related to s1

608
00:32:28,110 --> 00:32:35,129
and s2 controller also<font color="#CCCCCC"> in</font><font color="#E5E5E5"> CR issue</font>

609
00:32:32,880 --> 00:32:41,400
<font color="#E5E5E5">y pepper related to these</font>

610
00:32:35,130 --> 00:32:43,820
<font color="#E5E5E5">recommendations for updating thank you</font>

611
00:32:41,400 --> 00:32:47,549
for listening<font color="#CCCCCC"> and watching</font>

612
00:32:43,820 --> 00:32:49,570
and now ready to<font color="#E5E5E5"> answer questions</font><font color="#CCCCCC"> in</font>

613
00:32:47,549 --> 00:32:53,639
<font color="#CCCCCC">Rome</font>

614
00:32:49,570 --> 00:32:53,639
[Applause]

