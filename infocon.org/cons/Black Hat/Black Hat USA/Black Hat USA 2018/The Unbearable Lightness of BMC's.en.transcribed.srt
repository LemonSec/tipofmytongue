1
00:00:00,030 --> 00:00:04,830
do you guys<font color="#E5E5E5"> hear me yep I guess for the</font>

2
00:00:03,480 --> 00:00:06,359
fall<font color="#CCCCCC"> I</font><font color="#E5E5E5"> would like to thank you all</font><font color="#CCCCCC"> for</font>

3
00:00:04,830 --> 00:00:09,059
being here<font color="#CCCCCC"> I know it was a really</font><font color="#E5E5E5"> long</font>

4
00:00:06,359 --> 00:00:12,090
walk all the way to<font color="#CCCCCC"> this room in the end</font>

5
00:00:09,059 --> 00:00:16,289
of the<font color="#CCCCCC"> bed so thank you for</font><font color="#E5E5E5"> that</font>

6
00:00:12,090 --> 00:00:19,170
so<font color="#E5E5E5"> this</font><font color="#CCCCCC"> talk this is a</font><font color="#E5E5E5"> presentation has</font>

7
00:00:16,289 --> 00:00:22,020
multiple presentations inside there is

8
00:00:19,170 --> 00:00:26,189
like many layers<font color="#CCCCCC"> of things that you will</font>

9
00:00:22,020 --> 00:00:28,859
<font color="#E5E5E5">learn that you can do with</font><font color="#CCCCCC"> VMC's</font><font color="#E5E5E5"> and I</font>

10
00:00:26,189 --> 00:00:30,960
<font color="#E5E5E5">don't want you to get</font><font color="#CCCCCC"> out the</font><font color="#E5E5E5"> talk which</font>

11
00:00:28,859 --> 00:00:32,759
has the idea of of exploits exploits to

12
00:00:30,960 --> 00:00:36,480
<font color="#E5E5E5">be honest is</font><font color="#CCCCCC"> the less important thing on</font>

13
00:00:32,759 --> 00:00:38,040
this presentation<font color="#E5E5E5"> so if there's</font>

14
00:00:36,480 --> 00:00:40,309
something<font color="#CCCCCC"> that you know I want</font><font color="#E5E5E5"> to</font>

15
00:00:38,040 --> 00:00:43,440
<font color="#E5E5E5">transmit on this presentation is that</font><font color="#CCCCCC"> um</font>

16
00:00:40,309 --> 00:00:44,789
yeah don't don't don't<font color="#E5E5E5"> don't concentrate</font>

17
00:00:43,440 --> 00:00:46,739
<font color="#E5E5E5">on the</font><font color="#CCCCCC"> actual even though they're like</font>

18
00:00:44,789 --> 00:00:48,270
remote code execution<font color="#CCCCCC"> uneducated you</font>

19
00:00:46,739 --> 00:00:49,620
<font color="#E5E5E5">know all the cool</font><font color="#CCCCCC"> things</font><font color="#E5E5E5"> that's not</font>

20
00:00:48,270 --> 00:00:51,750
important of the presentation but rather

21
00:00:49,620 --> 00:00:56,250
the mobile things that you will be<font color="#CCCCCC"> able</font>

22
00:00:51,750 --> 00:00:58,379
<font color="#E5E5E5">to see and do with BMC anyways</font><font color="#CCCCCC"> I guess</font>

23
00:00:56,250 --> 00:01:02,010
<font color="#E5E5E5">everyone works computer here and if you</font>

24
00:00:58,379 --> 00:01:05,039
ever<font color="#E5E5E5"> want</font><font color="#CCCCCC"> a computer and you have an</font>

25
00:01:02,010 --> 00:01:08,070
elder<font color="#E5E5E5"> your family I'm</font><font color="#CCCCCC"> sure they will at</font>

26
00:01:05,040 --> 00:01:10,799
some point contact<font color="#E5E5E5"> you and ask you</font><font color="#CCCCCC"> for</font>

27
00:01:08,070 --> 00:01:13,080
help<font color="#CCCCCC"> for one of your problems</font><font color="#E5E5E5"> that they</font>

28
00:01:10,799 --> 00:01:15,150
have<font color="#CCCCCC"> in a computer</font><font color="#E5E5E5"> so I mean I want to</font>

29
00:01:13,080 --> 00:01:17,130
do this a little<font color="#E5E5E5"> bit interactive so what</font>

30
00:01:15,150 --> 00:01:18,840
<font color="#CCCCCC">would</font><font color="#E5E5E5"> be</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> one and only solution for</font>

31
00:01:17,130 --> 00:01:22,280
pretty<font color="#CCCCCC"> much all the problems</font><font color="#E5E5E5"> and</font>

32
00:01:18,840 --> 00:01:26,369
computers raise<font color="#E5E5E5"> your hand what you said</font>

33
00:01:22,280 --> 00:01:30,450
restart exactly<font color="#E5E5E5"> so obviously restart is</font>

34
00:01:26,369 --> 00:01:33,689
mainly made the resolution<font color="#E5E5E5"> to 99.99% of</font>

35
00:01:30,450 --> 00:01:36,140
all the problems on computers<font color="#CCCCCC"> so what</font>

36
00:01:33,689 --> 00:01:40,258
happened when<font color="#E5E5E5"> those problems happen on</font>

37
00:01:36,140 --> 00:01:42,420
data centers right<font color="#E5E5E5"> as you can see in the</font>

38
00:01:40,259 --> 00:01:44,070
screen<font color="#E5E5E5"> there's a lot of service there</font>

39
00:01:42,420 --> 00:01:46,740
some of them are screaming<font color="#E5E5E5"> to being</font>

40
00:01:44,070 --> 00:01:49,020
rebooted<font color="#E5E5E5"> and obviously someone has to go</font>

41
00:01:46,740 --> 00:01:51,360
and you know actually<font color="#CCCCCC"> press that</font><font color="#E5E5E5"> button</font>

42
00:01:49,020 --> 00:01:56,310
<font color="#CCCCCC">and</font><font color="#E5E5E5"> I</font><font color="#CCCCCC"> don't know if you have ever been</font>

43
00:01:51,360 --> 00:01:57,689
<font color="#E5E5E5">in a colocation</font><font color="#CCCCCC"> I have been</font><font color="#E5E5E5"> on each one</font>

44
00:01:56,310 --> 00:02:01,170
because I don't<font color="#CCCCCC"> know if you know but</font><font color="#E5E5E5"> um</font>

45
00:01:57,689 --> 00:02:03,869
<font color="#E5E5E5">we wasn't bought by a coalition company</font>

46
00:02:01,170 --> 00:02:05,460
so now we<font color="#E5E5E5"> really love collocations but</font>

47
00:02:03,869 --> 00:02:08,369
we don't love<font color="#E5E5E5"> to be there and I'm</font><font color="#CCCCCC"> sure</font>

48
00:02:05,460 --> 00:02:11,340
everyone<font color="#E5E5E5"> has had been here hate</font><font color="#CCCCCC"> to go to</font>

49
00:02:08,369 --> 00:02:13,440
Colossians and<font color="#E5E5E5"> I mean you love to have</font>

50
00:02:11,340 --> 00:02:15,000
<font color="#E5E5E5">your servers there but you hate to</font><font color="#CCCCCC"> go</font>

51
00:02:13,440 --> 00:02:17,850
personally there<font color="#E5E5E5"> and there are</font><font color="#CCCCCC"> many</font>

52
00:02:15,000 --> 00:02:19,710
<font color="#CCCCCC">reasons for that</font><font color="#E5E5E5"> and the main reason you</font>

53
00:02:17,850 --> 00:02:22,920
can see in this picture you<font color="#CCCCCC"> see a chair</font>

54
00:02:19,710 --> 00:02:24,210
there<font color="#E5E5E5"> I don't and that's</font><font color="#CCCCCC"> one of the</font>

55
00:02:22,920 --> 00:02:26,579
problems<font color="#E5E5E5"> collocation</font><font color="#CCCCCC"> you end up working</font>

56
00:02:24,210 --> 00:02:30,000
standing<font color="#E5E5E5"> probably</font><font color="#CCCCCC"> the only person that</font>

57
00:02:26,580 --> 00:02:32,610
can or not a<font color="#E5E5E5"> person but the animal that</font>

58
00:02:30,000 --> 00:02:34,110
can be sitting<font color="#E5E5E5"> down</font><font color="#CCCCCC"> would be a dog or</font>

59
00:02:32,610 --> 00:02:36,390
your animal<font color="#E5E5E5"> I don't know what kind of</font>

60
00:02:34,110 --> 00:02:39,930
<font color="#CCCCCC">colocation allow dogs in but I</font><font color="#E5E5E5"> would</font>

61
00:02:36,390 --> 00:02:42,929
<font color="#CCCCCC">really want you</font><font color="#E5E5E5"> know</font><font color="#CCCCCC"> definitely not ours</font>

62
00:02:39,930 --> 00:02:45,750
<font color="#CCCCCC">so the other problem with colocation is</font>

63
00:02:42,930 --> 00:02:50,490
a super call so everyone<font color="#E5E5E5"> really wouldn't</font>

64
00:02:45,750 --> 00:02:52,380
go<font color="#E5E5E5"> to</font><font color="#CCCCCC"> Caucasians like you know wearing</font>

65
00:02:50,490 --> 00:02:54,060
multiple layers<font color="#E5E5E5"> of clothes and</font>

66
00:02:52,380 --> 00:02:55,829
<font color="#E5E5E5">everyone's unhappy in</font><font color="#CCCCCC"> collocations</font>

67
00:02:54,060 --> 00:02:58,260
because you have to drive<font color="#CCCCCC"> like 45</font>

68
00:02:55,830 --> 00:02:59,760
minutes<font color="#E5E5E5"> to your next</font><font color="#CCCCCC"> collocation and</font>

69
00:02:58,260 --> 00:03:01,829
you'll be looking<font color="#CCCCCC"> at this picture and be</font>

70
00:02:59,760 --> 00:03:03,390
like well this little actually look

71
00:03:01,830 --> 00:03:05,430
happy<font color="#E5E5E5"> and the reason they look happy is</font>

72
00:03:03,390 --> 00:03:07,380
because<font color="#E5E5E5"> they already fix opponents and</font>

73
00:03:05,430 --> 00:03:09,060
they know<font color="#E5E5E5"> that</font><font color="#CCCCCC"> we're going</font><font color="#E5E5E5"> back home but</font>

74
00:03:07,380 --> 00:03:11,070
there's only one dude that<font color="#E5E5E5"> is not happy</font>

75
00:03:09,060 --> 00:03:13,200
and<font color="#CCCCCC"> you know</font><font color="#E5E5E5"> why he's</font><font color="#CCCCCC"> not</font><font color="#E5E5E5"> happy</font><font color="#CCCCCC"> he's not</font>

76
00:03:11,070 --> 00:03:15,000
<font color="#E5E5E5">happy because he's the one</font><font color="#CCCCCC"> that lives</font>

77
00:03:13,200 --> 00:03:16,560
closer to<font color="#CCCCCC"> the collocation so he knows</font>

78
00:03:15,000 --> 00:03:19,650
<font color="#E5E5E5">that as soon everyone returns it's gonna</font>

79
00:03:16,560 --> 00:03:21,420
be back and and then once I was<font color="#E5E5E5"> gonna</font>

80
00:03:19,650 --> 00:03:24,270
crash and he's gonna be the only one

81
00:03:21,420 --> 00:03:25,708
going back<font color="#E5E5E5"> to the collocation and and</font>

82
00:03:24,270 --> 00:03:27,780
<font color="#E5E5E5">this will have to go all</font><font color="#CCCCCC"> the way from my</font>

83
00:03:25,709 --> 00:03:29,100
wedding<font color="#E5E5E5"> to the collocation because</font>

84
00:03:27,780 --> 00:03:30,540
that's how it works when<font color="#E5E5E5"> you work in</font>

85
00:03:29,100 --> 00:03:33,090
Aichi and you're on alert

86
00:03:30,540 --> 00:03:35,250
<font color="#CCCCCC">anyways</font><font color="#E5E5E5"> most important slide of this</font>

87
00:03:33,090 --> 00:03:39,510
presentation who we are my name is Nico

88
00:03:35,250 --> 00:03:42,350
<font color="#E5E5E5">Wiseman I'm a</font><font color="#CCCCCC"> VP at</font><font color="#E5E5E5"> immunity also work</font>

89
00:03:39,510 --> 00:03:47,519
<font color="#E5E5E5">at immunity as a security researcher</font>

90
00:03:42,350 --> 00:03:49,530
<font color="#CCCCCC">bmc's I hope I</font><font color="#E5E5E5"> will be able to say</font>

91
00:03:47,520 --> 00:03:51,450
<font color="#E5E5E5">exactly what it means</font><font color="#CCCCCC"> it's base van</font>

92
00:03:49,530 --> 00:03:56,250
<font color="#E5E5E5">management control is that correct yep</font>

93
00:03:51,450 --> 00:03:59,190
may be<font color="#E5E5E5"> MCS</font><font color="#CCCCCC"> bmc's</font><font color="#E5E5E5"> are this interesting</font>

94
00:03:56,250 --> 00:04:01,500
device that works completely<font color="#E5E5E5"> independent</font>

95
00:03:59,190 --> 00:04:04,680
<font color="#CCCCCC">from</font><font color="#E5E5E5"> the US and you will find it in like</font>

96
00:04:01,500 --> 00:04:07,650
big servers and<font color="#E5E5E5"> they're interesting we</font>

97
00:04:04,680 --> 00:04:10,620
<font color="#E5E5E5">can allow you to remote control the</font>

98
00:04:07,650 --> 00:04:12,480
server<font color="#E5E5E5"> and</font><font color="#CCCCCC"> they're kind</font><font color="#E5E5E5"> of isolated</font><font color="#CCCCCC"> self</font>

99
00:04:10,620 --> 00:04:14,760
from<font color="#E5E5E5"> the server they can connect and do</font>

100
00:04:12,480 --> 00:04:16,890
many things<font color="#E5E5E5"> but there are completely</font>

101
00:04:14,760 --> 00:04:18,839
<font color="#CCCCCC">different device</font><font color="#E5E5E5"> from</font><font color="#CCCCCC"> the server itself</font>

102
00:04:16,890 --> 00:04:23,530
<font color="#E5E5E5">and it's super interesting</font><font color="#CCCCCC"> because</font>

103
00:04:18,839 --> 00:04:26,200
basically the VM sirs are the answer<font color="#E5E5E5"> to</font>

104
00:04:23,530 --> 00:04:28,000
<font color="#CCCCCC">I pee</font><font color="#E5E5E5"> people being like I don't want to</font>

105
00:04:26,200 --> 00:04:30,340
drive<font color="#CCCCCC"> to the collocation</font><font color="#E5E5E5"> so if they turn</font>

106
00:04:28,000 --> 00:04:32,980
<font color="#E5E5E5">up they come up with</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> idea to allow</font>

107
00:04:30,340 --> 00:04:35,320
them to monitor<font color="#E5E5E5"> the</font><font color="#CCCCCC"> temperature the</font><font color="#E5E5E5"> bolt</font>

108
00:04:32,980 --> 00:04:39,250
<font color="#E5E5E5">is the fans and as you can</font><font color="#CCCCCC"> see in this</font>

109
00:04:35,320 --> 00:04:42,610
graph<font color="#E5E5E5"> from one of the many</font><font color="#CCCCCC"> Bender's that</font>

110
00:04:39,250 --> 00:04:44,260
put together<font color="#CCCCCC"> be MCS you there's a lot of</font>

111
00:04:42,610 --> 00:04:46,570
really<font color="#CCCCCC"> interesting informations you</font><font color="#E5E5E5"> can</font>

112
00:04:44,260 --> 00:04:49,360
pinpoint exactly<font color="#E5E5E5"> the temperature</font><font color="#CCCCCC"> and</font>

113
00:04:46,570 --> 00:04:51,969
different<font color="#E5E5E5"> parts of the chasis of a</font>

114
00:04:49,360 --> 00:04:54,130
server so in reality<font color="#CCCCCC"> they are super</font>

115
00:04:51,970 --> 00:04:56,620
interesting<font color="#E5E5E5"> however as I explained</font>

116
00:04:54,130 --> 00:05:00,700
<font color="#CCCCCC">they're</font><font color="#E5E5E5"> basically a machine inside a</font>

117
00:04:56,620 --> 00:05:02,800
<font color="#CCCCCC">machine so you know it has a</font><font color="#E5E5E5"> lot of</font>

118
00:05:00,700 --> 00:05:05,860
<font color="#E5E5E5">different really cool features like has</font>

119
00:05:02,800 --> 00:05:09,220
a full network stack inside the<font color="#CCCCCC"> little</font>

120
00:05:05,860 --> 00:05:12,270
<font color="#CCCCCC">device it has KVM so</font><font color="#E5E5E5"> it's keyboard video</font>

121
00:05:09,220 --> 00:05:15,970
<font color="#E5E5E5">and mouse</font><font color="#CCCCCC"> it has a direct serial console</font>

122
00:05:12,270 --> 00:05:17,820
to<font color="#CCCCCC"> the server and obviously</font><font color="#E5E5E5"> you can do</font>

123
00:05:15,970 --> 00:05:20,260
<font color="#E5E5E5">power manners basically you can revert</font>

124
00:05:17,820 --> 00:05:21,580
<font color="#CCCCCC">but obviously you want that</font><font color="#E5E5E5"> because you</font>

125
00:05:20,260 --> 00:05:22,960
know you<font color="#E5E5E5"> don't want to be other</font>

126
00:05:21,580 --> 00:05:26,260
<font color="#E5E5E5">collocations you want to remotely</font>

127
00:05:22,960 --> 00:05:28,719
connect<font color="#CCCCCC"> to the BMC</font><font color="#E5E5E5"> and from that point</font>

128
00:05:26,260 --> 00:05:30,490
manage the server when the server crash

129
00:05:28,720 --> 00:05:32,680
and there is no way to remotely connect

130
00:05:30,490 --> 00:05:33,280
<font color="#CCCCCC">to your server</font><font color="#E5E5E5"> however if you</font><font color="#CCCCCC"> think</font>

131
00:05:32,680 --> 00:05:35,140
about<font color="#E5E5E5"> it</font>

132
00:05:33,280 --> 00:05:37,419
it's kind of like<font color="#E5E5E5"> the perfect backdoor</font>

133
00:05:35,140 --> 00:05:40,870
right<font color="#E5E5E5"> it's like you can remotely connect</font>

134
00:05:37,419 --> 00:05:43,299
to<font color="#CCCCCC"> the Machine you can reboot it</font><font color="#E5E5E5"> you can</font>

135
00:05:40,870 --> 00:05:45,550
you know manage the keyboard the<font color="#E5E5E5"> video</font>

136
00:05:43,300 --> 00:05:46,960
the mouse but there's always<font color="#CCCCCC"> always</font>

137
00:05:45,550 --> 00:05:49,810
someone the crowd<font color="#E5E5E5"> will be like this is</font>

138
00:05:46,960 --> 00:05:52,599
not<font color="#E5E5E5"> the perfect</font><font color="#CCCCCC"> backdoor</font><font color="#E5E5E5"> because if the</font>

139
00:05:49,810 --> 00:05:55,600
server is<font color="#CCCCCC"> down</font><font color="#E5E5E5"> the back there is down</font>

140
00:05:52,600 --> 00:05:58,210
however<font color="#E5E5E5"> let me tell you something the</font>

141
00:05:55,600 --> 00:06:00,880
<font color="#E5E5E5">interesting thing about</font><font color="#CCCCCC"> BMC's is that no</font>

142
00:05:58,210 --> 00:06:03,250
matter if there's<font color="#E5E5E5"> electricity go into</font>

143
00:06:00,880 --> 00:06:04,659
the server<font color="#CCCCCC"> the B and C will be</font><font color="#E5E5E5"> on which</font>

144
00:06:03,250 --> 00:06:07,630
makes<font color="#E5E5E5"> sense though but if the server is</font>

145
00:06:04,660 --> 00:06:09,910
<font color="#CCCCCC">down the</font><font color="#E5E5E5"> BMC can still be on and keep</font>

146
00:06:07,630 --> 00:06:11,680
<font color="#E5E5E5">that in mind because as we continue</font>

147
00:06:09,910 --> 00:06:13,780
talking about<font color="#E5E5E5"> the different</font><font color="#CCCCCC"> things you</font>

148
00:06:11,680 --> 00:06:15,970
will<font color="#CCCCCC"> be</font><font color="#E5E5E5"> able</font><font color="#CCCCCC"> to do with</font><font color="#E5E5E5"> BMC once you</font>

149
00:06:13,780 --> 00:06:18,210
compromise it<font color="#E5E5E5"> this feature is quite</font>

150
00:06:15,970 --> 00:06:21,160
interesting<font color="#CCCCCC"> so</font>

151
00:06:18,210 --> 00:06:23,799
<font color="#E5E5E5">IPMI stands for intelligent platform</font>

152
00:06:21,160 --> 00:06:25,150
management interface<font color="#CCCCCC"> for all but it</font><font color="#E5E5E5"> is</font>

153
00:06:23,800 --> 00:06:26,530
basically<font color="#CCCCCC"> a set of standards and</font>

154
00:06:25,150 --> 00:06:29,560
conventions that<font color="#E5E5E5"> were put together in</font>

155
00:06:26,530 --> 00:06:31,960
<font color="#E5E5E5">order to define how this with mode</font>

156
00:06:29,560 --> 00:06:33,700
management devices<font color="#E5E5E5"> should work and how</font>

157
00:06:31,960 --> 00:06:34,719
the different<font color="#CCCCCC"> components should work</font>

158
00:06:33,700 --> 00:06:37,539
together

159
00:06:34,719 --> 00:06:39,819
so the the<font color="#E5E5E5"> main component here is</font><font color="#CCCCCC"> the</font>

160
00:06:37,539 --> 00:06:42,009
BMC<font color="#E5E5E5"> the</font><font color="#CCCCCC"> Nico</font><font color="#E5E5E5"> was talking about</font><font color="#CCCCCC"> which</font><font color="#E5E5E5"> is</font>

161
00:06:39,819 --> 00:06:43,769
in the end just a small computer in

162
00:06:42,009 --> 00:06:46,629
there<font color="#CCCCCC"> has</font><font color="#E5E5E5"> some microprocessor memory</font>

163
00:06:43,769 --> 00:06:48,719
storage space and<font color="#E5E5E5"> it is actually running</font>

164
00:06:46,629 --> 00:06:52,179
an operative<font color="#CCCCCC"> ship thing in there</font>

165
00:06:48,719 --> 00:06:54,699
this device<font color="#E5E5E5"> has multiple connections to</font>

166
00:06:52,179 --> 00:06:56,859
different<font color="#E5E5E5"> ports and if I were to access</font>

167
00:06:54,699 --> 00:06:58,629
different<font color="#E5E5E5"> devices on the chassis some on</font>

168
00:06:56,860 --> 00:07:02,429
the server<font color="#CCCCCC"> so for</font><font color="#E5E5E5"> example it will have</font>

169
00:06:58,629 --> 00:07:06,939
<font color="#E5E5E5">access via port which</font><font color="#CCCCCC"> is called IP</font><font color="#E5E5E5"> mb i</font>

170
00:07:02,429 --> 00:07:09,489
pmed<font color="#CCCCCC"> sub-grant of</font><font color="#E5E5E5"> i square</font><font color="#CCCCCC"> c be at least</font>

171
00:07:06,939 --> 00:07:12,459
this port<font color="#CCCCCC"> you will</font><font color="#E5E5E5"> be able</font><font color="#CCCCCC"> to access the</font>

172
00:07:09,489 --> 00:07:14,109
Defense Fund sensors to get a speed and

173
00:07:12,459 --> 00:07:16,529
temperature sensors<font color="#CCCCCC"> and all</font><font color="#E5E5E5"> sorts of</font>

174
00:07:14,110 --> 00:07:19,239
<font color="#E5E5E5">stuff</font><font color="#CCCCCC"> to be able to monitor</font><font color="#E5E5E5"> the server</font>

175
00:07:16,529 --> 00:07:21,129
but these devices<font color="#CCCCCC"> also</font><font color="#E5E5E5"> have an Ethernet</font>

176
00:07:19,239 --> 00:07:23,109
card<font color="#E5E5E5"> usually they have a standalone</font>

177
00:07:21,129 --> 00:07:25,209
<font color="#CCCCCC">curve for this for</font><font color="#E5E5E5"> themselves so that</font>

178
00:07:23,110 --> 00:07:27,909
<font color="#E5E5E5">you can</font><font color="#CCCCCC"> actually access them or get to</font>

179
00:07:25,209 --> 00:07:31,689
the welkins<font color="#E5E5E5"> or whatever</font><font color="#CCCCCC"> some other times</font>

180
00:07:27,909 --> 00:07:34,179
instead of that what they have is we

181
00:07:31,689 --> 00:07:37,029
<font color="#CCCCCC">have what is</font><font color="#E5E5E5"> called side channel</font><font color="#CCCCCC"> access</font>

182
00:07:34,179 --> 00:07:40,508
to the main network interface from<font color="#E5E5E5"> the</font>

183
00:07:37,029 --> 00:07:43,479
<font color="#E5E5E5">host so they are able to tell</font><font color="#CCCCCC"> that that</font>

184
00:07:40,509 --> 00:07:45,279
interface<font color="#CCCCCC"> hey these packets</font><font color="#E5E5E5"> please send</font>

185
00:07:43,479 --> 00:07:47,318
<font color="#E5E5E5">them</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> me basically it come you can</font>

186
00:07:45,279 --> 00:07:49,029
configure a couple of filters<font color="#CCCCCC"> to see</font>

187
00:07:47,319 --> 00:07:52,809
what packages<font color="#E5E5E5"> go to the house and which</font>

188
00:07:49,029 --> 00:07:55,089
ones<font color="#CCCCCC"> go to the IBM see these devices</font><font color="#E5E5E5"> the</font>

189
00:07:52,809 --> 00:07:56,919
<font color="#E5E5E5">DBM see also have connections</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> the</font>

190
00:07:55,089 --> 00:07:58,839
power supply<font color="#E5E5E5"> unit on the server so it</font>

191
00:07:56,919 --> 00:08:00,989
can power on or off the server<font color="#E5E5E5"> or</font>

192
00:07:58,839 --> 00:08:03,669
monitored the the power consumption<font color="#E5E5E5"> and</font>

193
00:08:00,989 --> 00:08:06,099
most interesting is that they usually

194
00:08:03,669 --> 00:08:08,739
are connected to one of<font color="#CCCCCC"> the main buses</font>

195
00:08:06,099 --> 00:08:12,909
of the server such as PCI or<font color="#E5E5E5"> PCI Express</font>

196
00:08:08,739 --> 00:08:15,518
for example so each of the main vendors

197
00:08:12,909 --> 00:08:17,459
on the<font color="#E5E5E5"> market have they or their own</font>

198
00:08:15,519 --> 00:08:21,759
<font color="#CCCCCC">implementation of this their</font><font color="#E5E5E5"> own variant</font>

199
00:08:17,459 --> 00:08:24,639
<font color="#E5E5E5">they all offer similar features to</font><font color="#CCCCCC"> you</font>

200
00:08:21,759 --> 00:08:26,319
beyond these writers but<font color="#E5E5E5"> they have some</font>

201
00:08:24,639 --> 00:08:29,739
differences so for example you have

202
00:08:26,319 --> 00:08:30,789
<font color="#CCCCCC">Dell with</font><font color="#E5E5E5"> idrac HP has I know in</font>

203
00:08:29,739 --> 00:08:34,718
<font color="#E5E5E5">different</font><font color="#CCCCCC"> versions</font>

204
00:08:30,789 --> 00:08:36,879
<font color="#CCCCCC">two four and one</font><font color="#E5E5E5"> also and</font><font color="#CCCCCC"> lenovo has IMM</font>

205
00:08:34,719 --> 00:08:39,639
so let's see a<font color="#E5E5E5"> little bit the</font>

206
00:08:36,879 --> 00:08:44,439
differences between each<font color="#E5E5E5"> other when you</font>

207
00:08:39,639 --> 00:08:46,929
go to HP<font color="#CCCCCC"> ila - this is built around</font><font color="#E5E5E5"> a</font>

208
00:08:44,439 --> 00:08:48,640
microprocessor which is called<font color="#E5E5E5"> Nagbe 850</font>

209
00:08:46,929 --> 00:08:51,189
so this is a very

210
00:08:48,640 --> 00:08:54,280
processor<font color="#CCCCCC"> that</font><font color="#E5E5E5"> was originally used in</font>

211
00:08:51,190 --> 00:08:56,200
optical drives and hard disks<font color="#E5E5E5"> so you can</font>

212
00:08:54,280 --> 00:08:59,550
imagine<font color="#CCCCCC"> that having</font><font color="#E5E5E5"> that processor</font>

213
00:08:56,200 --> 00:09:03,130
<font color="#E5E5E5">running a real OS is kind of slow right</font>

214
00:08:59,550 --> 00:09:05,490
<font color="#E5E5E5">speaking</font><font color="#CCCCCC"> of the u.s. these things run an</font>

215
00:09:03,130 --> 00:09:08,380
operating<font color="#E5E5E5"> system called</font><font color="#CCCCCC"> thread</font><font color="#E5E5E5"> X</font>

216
00:09:05,490 --> 00:09:09,940
apparently this this OS was this<font color="#E5E5E5"> is a</font>

217
00:09:08,380 --> 00:09:12,370
real-time<font color="#E5E5E5"> OS and it was pretty well</font>

218
00:09:09,940 --> 00:09:15,010
known<font color="#E5E5E5"> on the MIDI device world back</font><font color="#CCCCCC"> back</font>

219
00:09:12,370 --> 00:09:16,840
in<font color="#E5E5E5"> the times but honestly the first time</font>

220
00:09:15,010 --> 00:09:20,890
<font color="#E5E5E5">I saw it so it was when we did this</font>

221
00:09:16,840 --> 00:09:22,990
<font color="#E5E5E5">research from the</font><font color="#CCCCCC"> Roberson's time point</font>

222
00:09:20,890 --> 00:09:25,990
of view<font color="#CCCCCC"> when you unpack the binary when</font>

223
00:09:22,990 --> 00:09:28,510
what you end up<font color="#E5E5E5"> with is just one huge</font>

224
00:09:25,990 --> 00:09:30,970
binary<font color="#E5E5E5"> one huge</font><font color="#CCCCCC"> thing that</font><font color="#E5E5E5"> you can load</font>

225
00:09:28,510 --> 00:09:32,560
into<font color="#E5E5E5"> IRA</font><font color="#CCCCCC"> whatever but in there you have</font>

226
00:09:30,970 --> 00:09:34,360
like all<font color="#E5E5E5"> the functions that handle</font>

227
00:09:32,560 --> 00:09:36,489
everything<font color="#E5E5E5"> like all the fault for</font><font color="#CCCCCC"> the</font>

228
00:09:34,360 --> 00:09:38,590
handle a big web server the<font color="#CCCCCC"> IP mi server</font>

229
00:09:36,490 --> 00:09:42,160
the<font color="#CCCCCC"> ssh server</font><font color="#E5E5E5"> like everything is one</font>

230
00:09:38,590 --> 00:09:44,980
big<font color="#E5E5E5"> thing on</font><font color="#CCCCCC"> the right side the the</font>

231
00:09:42,160 --> 00:09:46,569
assembly for<font color="#CCCCCC"> this processor is very nice</font>

232
00:09:44,980 --> 00:09:49,000
so after a couple<font color="#CCCCCC"> of</font><font color="#E5E5E5"> hours you are</font>

233
00:09:46,570 --> 00:09:51,010
<font color="#E5E5E5">working with it you get used to to the</font>

234
00:09:49,000 --> 00:09:53,980
syntax<font color="#E5E5E5"> and it's very</font><font color="#CCCCCC"> very easy</font><font color="#E5E5E5"> to</font>

235
00:09:51,010 --> 00:09:55,480
<font color="#E5E5E5">understand this is a 32-bit bit risk we</font>

236
00:09:53,980 --> 00:09:58,210
heard rumors that<font color="#CCCCCC"> there's some source</font>

237
00:09:55,480 --> 00:09:59,680
<font color="#CCCCCC">code in the internet but we were not</font>

238
00:09:58,210 --> 00:10:01,120
<font color="#E5E5E5">able to access it but we heard</font><font color="#CCCCCC"> that</font>

239
00:09:59,680 --> 00:10:05,410
there's some Chinese website at

240
00:10:01,120 --> 00:10:08,770
somewhere so yeah although a lot of

241
00:10:05,410 --> 00:10:10,750
<font color="#E5E5E5">these sources are closed source when we</font>

242
00:10:08,770 --> 00:10:12,640
move<font color="#CCCCCC"> to a</font><font color="#E5E5E5"> low</font><font color="#CCCCCC"> four so we were working a</font>

243
00:10:10,750 --> 00:10:15,160
<font color="#CCCCCC">couple of</font><font color="#E5E5E5"> weeks we file achieve and then</font>

244
00:10:12,640 --> 00:10:17,260
we<font color="#CCCCCC"> move to</font><font color="#E5E5E5"> idle for we have to do what</font>

245
00:10:15,160 --> 00:10:19,089
we were expecting to<font color="#CCCCCC"> be able</font><font color="#E5E5E5"> to reuse</font>

246
00:10:17,260 --> 00:10:20,770
like everything I have learned the

247
00:10:19,090 --> 00:10:23,230
previous<font color="#E5E5E5"> week's we're working with these</font>

248
00:10:20,770 --> 00:10:25,420
devices<font color="#E5E5E5"> but the truth is</font><font color="#CCCCCC"> that didn't</font>

249
00:10:23,230 --> 00:10:27,040
work very well<font color="#E5E5E5"> because HP decided to</font>

250
00:10:25,420 --> 00:10:30,189
redesign the whole thing when they move

251
00:10:27,040 --> 00:10:32,319
<font color="#CCCCCC">1204 so they are now now using arm which</font>

252
00:10:30,190 --> 00:10:34,000
<font color="#E5E5E5">is good because no arm is pretty cool</font>

253
00:10:32,320 --> 00:10:35,470
<font color="#CCCCCC">well-known processor</font><font color="#E5E5E5"> yeah there's a lot</font>

254
00:10:34,000 --> 00:10:38,110
of information examples in the internet

255
00:10:35,470 --> 00:10:40,630
<font color="#E5E5E5">or whatever tools everybody supports it</font>

256
00:10:38,110 --> 00:10:42,760
<font color="#CCCCCC">but it's arm like you have to read arm</font>

257
00:10:40,630 --> 00:10:44,400
assembly and that's like really really

258
00:10:42,760 --> 00:10:47,050
<font color="#CCCCCC">bad</font>

259
00:10:44,400 --> 00:10:49,000
<font color="#CCCCCC">during the</font><font color="#E5E5E5"> u.s. they are using one</font><font color="#CCCCCC"> that</font>

260
00:10:47,050 --> 00:10:51,370
is called<font color="#E5E5E5"> GHS integrity</font><font color="#CCCCCC"> source for</font>

261
00:10:49,000 --> 00:10:55,120
real-time<font color="#E5E5E5"> OS built by the same companies</font>

262
00:10:51,370 --> 00:10:57,310
before<font color="#E5E5E5"> so things that are similar</font>

263
00:10:55,120 --> 00:11:00,940
what's good<font color="#E5E5E5"> is that when we move to</font><font color="#CCCCCC"> I</font>

264
00:10:57,310 --> 00:11:02,380
<font color="#E5E5E5">drug from Dell in this case while they</font>

265
00:11:00,940 --> 00:11:03,130
are using<font color="#CCCCCC"> a processor it's called</font><font color="#E5E5E5"> super</font>

266
00:11:02,380 --> 00:11:06,280
<font color="#E5E5E5">8</font>

267
00:11:03,130 --> 00:11:10,439
if does it ring a bell for anybody<font color="#CCCCCC"> here</font>

268
00:11:06,280 --> 00:11:14,829
<font color="#E5E5E5">super</font><font color="#CCCCCC"> H yeah I bet you</font><font color="#E5E5E5"> are gamers right</font>

269
00:11:10,440 --> 00:11:16,480
no I was used in the console called<font color="#E5E5E5"> Sega</font>

270
00:11:14,830 --> 00:11:19,720
Saturn<font color="#CCCCCC"> the Sega Saturn console back in</font>

271
00:11:16,480 --> 00:11:21,610
the<font color="#CCCCCC"> nineties angry days</font><font color="#E5E5E5"> but the good</font>

272
00:11:19,720 --> 00:11:24,700
<font color="#CCCCCC">thing about</font><font color="#E5E5E5"> Iraq is</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> it's Linux</font><font color="#CCCCCC"> base</font>

273
00:11:21,610 --> 00:11:27,130
<font color="#E5E5E5">so for us trying</font><font color="#CCCCCC"> to understand how</font><font color="#E5E5E5"> this</font>

274
00:11:24,700 --> 00:11:28,900
thing<font color="#CCCCCC"> works it's</font><font color="#E5E5E5"> really good because you</font>

275
00:11:27,130 --> 00:11:31,960
<font color="#E5E5E5">end up analyzing unknown file system</font>

276
00:11:28,900 --> 00:11:34,959
known tools<font color="#E5E5E5"> known services</font><font color="#CCCCCC"> configuration</font>

277
00:11:31,960 --> 00:11:37,240
files<font color="#E5E5E5"> if</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> want to reverse or analyze</font>

278
00:11:34,960 --> 00:11:40,030
<font color="#E5E5E5">a specific service</font><font color="#CCCCCC"> you can grab that</font>

279
00:11:37,240 --> 00:11:41,260
<font color="#CCCCCC">binary by itself</font><font color="#E5E5E5"> and loaded into</font><font color="#CCCCCC"> iodine</font>

280
00:11:40,030 --> 00:11:44,140
you don't have to deal with<font color="#CCCCCC"> the whole</font>

281
00:11:41,260 --> 00:11:48,850
thing so<font color="#E5E5E5"> this one is much</font><font color="#CCCCCC"> more easier to</font>

282
00:11:44,140 --> 00:11:52,060
<font color="#E5E5E5">work with so</font><font color="#CCCCCC"> we did</font><font color="#E5E5E5"> Richard we were like</font>

283
00:11:48,850 --> 00:11:54,910
very limited scope<font color="#E5E5E5"> and we have a lot of</font>

284
00:11:52,060 --> 00:11:57,550
different things to<font color="#E5E5E5"> cover so what we</font>

285
00:11:54,910 --> 00:12:00,579
decide<font color="#CCCCCC"> to do is to concentrate</font><font color="#E5E5E5"> on the</font>

286
00:11:57,550 --> 00:12:02,349
most fruitful<font color="#E5E5E5"> vulnerabilities so we</font>

287
00:12:00,580 --> 00:12:03,820
decided<font color="#CCCCCC"> to go for</font><font color="#E5E5E5"> it's not release</font>

288
00:12:02,350 --> 00:12:06,760
attacks of course but you go for<font color="#E5E5E5"> like</font>

289
00:12:03,820 --> 00:12:09,640
pre authentication if possible remote

290
00:12:06,760 --> 00:12:11,560
code execution<font color="#CCCCCC"> kind of vulnerabilities</font>

291
00:12:09,640 --> 00:12:13,480
there are like<font color="#E5E5E5"> multiple things you can</font>

292
00:12:11,560 --> 00:12:16,180
do like<font color="#E5E5E5"> Matt in the middle post out</font>

293
00:12:13,480 --> 00:12:18,700
things which are it sounds<font color="#CCCCCC"> like it's not</font>

294
00:12:16,180 --> 00:12:21,579
<font color="#E5E5E5">but they are useful as we learn later</font><font color="#CCCCCC"> on</font>

295
00:12:18,700 --> 00:12:23,620
the research<font color="#E5E5E5"> however for</font><font color="#CCCCCC"> example most</font><font color="#E5E5E5"> of</font>

296
00:12:21,580 --> 00:12:26,140
<font color="#E5E5E5">these devices run on an out-of-band</font>

297
00:12:23,620 --> 00:12:29,200
<font color="#CCCCCC">network and you know my man</font><font color="#E5E5E5"> in the</font>

298
00:12:26,140 --> 00:12:31,150
<font color="#E5E5E5">middle might be helpful but not</font><font color="#CCCCCC"> really</font>

299
00:12:29,200 --> 00:12:34,900
<font color="#CCCCCC">to be honest</font><font color="#E5E5E5"> you have to already</font><font color="#CCCCCC"> being</font>

300
00:12:31,150 --> 00:12:38,050
<font color="#E5E5E5">that never and that's like a big step</font><font color="#CCCCCC"> so</font>

301
00:12:34,900 --> 00:12:40,870
we<font color="#CCCCCC"> decide to go three off</font><font color="#E5E5E5"> and and when</font>

302
00:12:38,050 --> 00:12:43,500
we start out eating this thing<font color="#CCCCCC"> one of</font>

303
00:12:40,870 --> 00:12:47,890
<font color="#E5E5E5">the things we</font><font color="#CCCCCC"> realize is</font><font color="#E5E5E5"> that it's very</font>

304
00:12:43,500 --> 00:12:49,360
<font color="#CCCCCC">exciting to do it I don't think</font><font color="#E5E5E5"> I don't</font>

305
00:12:47,890 --> 00:12:53,680
think<font color="#CCCCCC"> Zod we're</font><font color="#E5E5E5"> gonna work and I'm gonna</font>

306
00:12:49,360 --> 00:12:55,120
try no it sounds<font color="#E5E5E5"> like and that's like</font>

307
00:12:53,680 --> 00:12:57,430
<font color="#E5E5E5">four hours and hours because I don't</font>

308
00:12:55,120 --> 00:12:59,470
know if you ever out<font color="#E5E5E5"> in anything you</font>

309
00:12:57,430 --> 00:13:02,709
spend like<font color="#E5E5E5"> hours and</font><font color="#CCCCCC"> hours trying things</font>

310
00:12:59,470 --> 00:13:05,770
and and the<font color="#E5E5E5"> other thing is some of these</font>

311
00:13:02,710 --> 00:13:08,320
<font color="#CCCCCC">things are super all like</font><font color="#E5E5E5"> we start out</font>

312
00:13:05,770 --> 00:13:12,270
<font color="#CCCCCC">it in I love you you have to install</font>

313
00:13:08,320 --> 00:13:15,160
like very<font color="#CCCCCC"> old</font><font color="#E5E5E5"> Firefox just to be able to</font>

314
00:13:12,270 --> 00:13:17,650
<font color="#E5E5E5">deal with</font><font color="#CCCCCC"> the all certificate</font>

315
00:13:15,160 --> 00:13:19,209
yeah the<font color="#CCCCCC"> ssl was slowly</font><font color="#E5E5E5"> broken and you</font>

316
00:13:17,650 --> 00:13:21,490
couldn't use<font color="#CCCCCC"> anymore and</font><font color="#E5E5E5"> browsers to</font>

317
00:13:19,210 --> 00:13:24,820
<font color="#CCCCCC">access</font><font color="#E5E5E5"> like a</font><font color="#CCCCCC"> pain you Hudgins</font><font color="#E5E5E5"> a lobby</font>

318
00:13:21,490 --> 00:13:30,400
<font color="#E5E5E5">em just to able to</font><font color="#CCCCCC"> accident yeah so he's</font>

319
00:13:24,820 --> 00:13:32,230
like super<font color="#CCCCCC"> flow</font><font color="#E5E5E5"> it was horrible so the</font>

320
00:13:30,400 --> 00:13:34,720
attack surfing so as I say before<font color="#E5E5E5"> we</font>

321
00:13:32,230 --> 00:13:37,390
<font color="#CCCCCC">have</font><font color="#E5E5E5"> three or actually four different</font>

322
00:13:34,720 --> 00:13:39,970
targets<font color="#CCCCCC"> and we only have a certain</font>

323
00:13:37,390 --> 00:13:42,730
amount<font color="#E5E5E5"> of time so what we thought we</font>

324
00:13:39,970 --> 00:13:45,160
will do is try to decide which will be

325
00:13:42,730 --> 00:13:48,580
the better protocols that we<font color="#E5E5E5"> killed ears</font>

326
00:13:45,160 --> 00:13:52,630
<font color="#E5E5E5">and then translate</font><font color="#CCCCCC"> that into the</font>

327
00:13:48,580 --> 00:13:55,000
different the different devices that<font color="#CCCCCC"> we</font>

328
00:13:52,630 --> 00:13:58,000
can use so we thought you<font color="#E5E5E5"> know let's put</font>

329
00:13:55,000 --> 00:14:00,130
<font color="#E5E5E5">together at least and then you know and</font>

330
00:13:58,000 --> 00:14:01,480
<font color="#CCCCCC">right fasters</font><font color="#E5E5E5"> and out it and understand</font>

331
00:14:00,130 --> 00:14:03,010
the protocol so then we<font color="#E5E5E5"> will</font><font color="#CCCCCC"> move</font><font color="#E5E5E5"> from</font>

332
00:14:01,480 --> 00:14:05,320
<font color="#CCCCCC">one on the</font><font color="#E5E5E5"> other will be super</font><font color="#CCCCCC"> easy to</font>

333
00:14:03,010 --> 00:14:08,380
do<font color="#CCCCCC"> one</font><font color="#E5E5E5"> of the things you start learning</font>

334
00:14:05,320 --> 00:14:11,350
is that<font color="#E5E5E5"> even though it sounds</font><font color="#CCCCCC"> that they</font>

335
00:14:08,380 --> 00:14:13,240
share a lot<font color="#CCCCCC"> of</font><font color="#E5E5E5"> different protocols in</font>

336
00:14:11,350 --> 00:14:15,460
reality when<font color="#CCCCCC"> you start</font><font color="#E5E5E5"> looking at them</font>

337
00:14:13,240 --> 00:14:17,350
<font color="#E5E5E5">everyone that's what they want</font><font color="#CCCCCC"> like they</font>

338
00:14:15,460 --> 00:14:19,900
will they look like the other similar

339
00:14:17,350 --> 00:14:21,550
protocols but<font color="#E5E5E5"> will start like digging a</font>

340
00:14:19,900 --> 00:14:23,380
little<font color="#E5E5E5"> bit more like some of these stuff</font>

341
00:14:21,550 --> 00:14:25,300
<font color="#E5E5E5">are really really different</font><font color="#CCCCCC"> form on each</font>

342
00:14:23,380 --> 00:14:27,400
other<font color="#E5E5E5"> and</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> and it's kind of weird</font>

343
00:14:25,300 --> 00:14:29,859
<font color="#E5E5E5">because like this</font><font color="#CCCCCC"> is a thing that</font><font color="#E5E5E5"> you</font>

344
00:14:27,400 --> 00:14:31,480
eventually<font color="#E5E5E5"> want to automatize you want</font>

345
00:14:29,860 --> 00:14:33,100
to be able<font color="#E5E5E5"> to control multiple servers</font>

346
00:14:31,480 --> 00:14:35,110
at the<font color="#E5E5E5"> same time so if they're from</font>

347
00:14:33,100 --> 00:14:37,690
different<font color="#E5E5E5"> brands some of the protocol</font>

348
00:14:35,110 --> 00:14:40,300
will really<font color="#E5E5E5"> really make your life</font>

349
00:14:37,690 --> 00:14:44,110
miserable<font color="#CCCCCC"> so the first one we look at it</font>

350
00:14:40,300 --> 00:14:46,979
was the<font color="#E5E5E5"> smash which is basically a</font>

351
00:14:44,110 --> 00:14:49,390
common line<font color="#E5E5E5"> standarized but this</font>

352
00:14:46,980 --> 00:14:54,340
<font color="#E5E5E5">organization called</font><font color="#CCCCCC"> D</font><font color="#E5E5E5"> TMS which has</font>

353
00:14:49,390 --> 00:14:56,080
<font color="#E5E5E5">nothing to do with phones and and this</font>

354
00:14:54,340 --> 00:14:59,950
<font color="#E5E5E5">is basically a common line that runs</font>

355
00:14:56,080 --> 00:15:02,560
<font color="#E5E5E5">over SSH so we were thinking you</font><font color="#CCCCCC"> know if</font>

356
00:14:59,950 --> 00:15:04,750
you attack this the the main problem is

357
00:15:02,560 --> 00:15:05,829
<font color="#CCCCCC">that you</font><font color="#E5E5E5"> have to go sucess SH and we</font>

358
00:15:04,750 --> 00:15:07,720
know that<font color="#CCCCCC"> it</font><font color="#E5E5E5"> has a lot of</font>

359
00:15:05,830 --> 00:15:10,450
<font color="#CCCCCC">vulnerabilities however that was a long</font>

360
00:15:07,720 --> 00:15:12,340
time ago<font color="#CCCCCC"> and the problem</font><font color="#E5E5E5"> with</font><font color="#CCCCCC"> that is</font>

361
00:15:10,450 --> 00:15:14,350
that<font color="#E5E5E5"> do we want to spend that</font><font color="#CCCCCC"> amount of</font>

362
00:15:12,340 --> 00:15:18,370
time<font color="#E5E5E5"> finding new things or probably</font>

363
00:15:14,350 --> 00:15:21,580
auditing<font color="#CCCCCC"> open source library which is</font>

364
00:15:18,370 --> 00:15:23,740
what<font color="#E5E5E5"> most</font><font color="#CCCCCC"> people do and then so we</font>

365
00:15:21,580 --> 00:15:26,470
decided<font color="#E5E5E5"> a little bit against it however</font>

366
00:15:23,740 --> 00:15:29,020
later during<font color="#E5E5E5"> the</font><font color="#CCCCCC"> research we find</font><font color="#E5E5E5"> out</font>

367
00:15:26,470 --> 00:15:32,399
that smash<font color="#E5E5E5"> could be a really good</font>

368
00:15:29,020 --> 00:15:37,089
to start find like logic<font color="#CCCCCC"> common</font>

369
00:15:32,399 --> 00:15:40,450
<font color="#CCCCCC">injection marks to</font><font color="#E5E5E5"> obtain both</font><font color="#CCCCCC"> out</font>

370
00:15:37,089 --> 00:15:41,800
access<font color="#CCCCCC"> to the operating system so the</font>

371
00:15:40,450 --> 00:15:43,690
command<font color="#E5E5E5"> this is a common line that</font>

372
00:15:41,800 --> 00:15:45,670
doesn't<font color="#CCCCCC"> give you a shell</font><font color="#E5E5E5"> or allow</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> to</font>

373
00:15:43,690 --> 00:15:49,209
execute<font color="#E5E5E5"> anything at all it's just like</font>

374
00:15:45,670 --> 00:15:52,420
their own<font color="#E5E5E5"> implementation</font><font color="#CCCCCC"> of like</font>

375
00:15:49,209 --> 00:15:54,130
monitoring<font color="#E5E5E5"> through SSH</font><font color="#CCCCCC"> so if you're able</font>

376
00:15:52,420 --> 00:15:55,899
to access that and<font color="#CCCCCC"> get to the opposite</font>

377
00:15:54,130 --> 00:15:57,160
<font color="#E5E5E5">this operating</font><font color="#CCCCCC"> system then if</font><font color="#E5E5E5"> I will</font>

378
00:15:55,899 --> 00:15:59,020
allow you<font color="#E5E5E5"> to the back better</font>

379
00:15:57,160 --> 00:16:02,110
vulnerabilities<font color="#CCCCCC"> that I'm sure you will</font>

380
00:15:59,020 --> 00:16:03,819
<font color="#E5E5E5">find remotely so I mean it's a good type</font>

381
00:16:02,110 --> 00:16:05,080
<font color="#CCCCCC">of post out but pre out which is what</font>

382
00:16:03,820 --> 00:16:08,470
we're<font color="#CCCCCC"> looking for</font>

383
00:16:05,080 --> 00:16:10,839
<font color="#E5E5E5">it didn't work is the</font><font color="#CCCCCC"> interesting</font><font color="#E5E5E5"> thing</font>

384
00:16:08,470 --> 00:16:11,950
is<font color="#CCCCCC"> that as anything</font><font color="#E5E5E5"> and you will see</font><font color="#CCCCCC"> all</font>

385
00:16:10,839 --> 00:16:14,649
the<font color="#E5E5E5"> monitor and different monitors</font>

386
00:16:11,950 --> 00:16:18,130
protocol everything allows you to do a

387
00:16:14,649 --> 00:16:20,290
remote console serial as you can see<font color="#E5E5E5"> or</font>

388
00:16:18,130 --> 00:16:22,029
<font color="#E5E5E5">as a sage you can access the bias and</font><font color="#CCCCCC"> do</font>

389
00:16:20,290 --> 00:16:24,399
<font color="#E5E5E5">them like many things remotely so it's</font>

390
00:16:22,029 --> 00:16:28,810
kind of useful<font color="#CCCCCC"> once you gather count</font><font color="#E5E5E5"> and</font>

391
00:16:24,399 --> 00:16:31,089
the people<font color="#E5E5E5"> from rapid7 in a couple of</font>

392
00:16:28,810 --> 00:16:35,170
years<font color="#E5E5E5"> ago put together a list of</font>

393
00:16:31,089 --> 00:16:38,440
different default username and password

394
00:16:35,170 --> 00:16:40,930
<font color="#E5E5E5">and that</font><font color="#CCCCCC"> can be useful</font><font color="#E5E5E5"> especially</font>

395
00:16:38,440 --> 00:16:43,300
<font color="#E5E5E5">because if you are looking or an</font>

396
00:16:40,930 --> 00:16:45,399
internal network<font color="#E5E5E5"> external network like</font>

397
00:16:43,300 --> 00:16:48,250
the main two things that<font color="#E5E5E5"> will be open</font>

398
00:16:45,399 --> 00:16:52,000
will be<font color="#E5E5E5"> SSH and</font><font color="#CCCCCC"> AD on these on these</font>

399
00:16:48,250 --> 00:16:54,610
devices<font color="#CCCCCC"> so</font><font color="#E5E5E5"> you know and you will see a</font>

400
00:16:52,000 --> 00:16:56,890
lot of default username and password

401
00:16:54,610 --> 00:17:02,560
<font color="#CCCCCC">code people really don't</font><font color="#E5E5E5"> care about</font>

402
00:16:56,890 --> 00:17:05,530
<font color="#CCCCCC">BMC's then you have SNMP</font><font color="#E5E5E5"> I guess you</font>

403
00:17:02,560 --> 00:17:07,149
don't<font color="#E5E5E5"> need</font><font color="#CCCCCC"> too much interaction SNMP if</font>

404
00:17:05,530 --> 00:17:11,230
you scan you will find a lot of<font color="#E5E5E5"> devices</font>

405
00:17:07,150 --> 00:17:14,199
with default<font color="#CCCCCC"> public</font><font color="#E5E5E5"> community but that</font>

406
00:17:11,230 --> 00:17:16,809
not<font color="#E5E5E5"> really very important</font><font color="#CCCCCC"> well we found</font>

407
00:17:14,199 --> 00:17:18,550
that it's quite<font color="#E5E5E5"> interesting is that if</font>

408
00:17:16,809 --> 00:17:21,129
you unpack the<font color="#CCCCCC"> Fillmore you can get the</font>

409
00:17:18,550 --> 00:17:22,899
AMA<font color="#CCCCCC"> be files so then if you</font><font color="#E5E5E5"> use a tool</font>

410
00:17:21,130 --> 00:17:24,970
such<font color="#E5E5E5"> as</font><font color="#CCCCCC"> assembly walk or something like</font>

411
00:17:22,900 --> 00:17:27,459
<font color="#CCCCCC">that you can query</font><font color="#E5E5E5"> the devices for which</font>

412
00:17:24,970 --> 00:17:29,200
you<font color="#E5E5E5"> already know</font><font color="#CCCCCC"> some how the</font><font color="#E5E5E5"> community</font>

413
00:17:27,459 --> 00:17:31,809
string<font color="#E5E5E5"> even if the device</font><font color="#CCCCCC"> is yours</font><font color="#E5E5E5"> and</font>

414
00:17:29,200 --> 00:17:34,240
you<font color="#E5E5E5"> can gain a lot</font><font color="#CCCCCC"> of information and</font>

415
00:17:31,809 --> 00:17:36,220
some<font color="#E5E5E5"> of the information</font><font color="#CCCCCC"> in this case the</font>

416
00:17:34,240 --> 00:17:39,370
one on the<font color="#CCCCCC"> screen I think it's a it's a</font>

417
00:17:36,220 --> 00:17:41,290
<font color="#E5E5E5">Dell</font><font color="#CCCCCC"> and I track what you're seeing</font>

418
00:17:39,370 --> 00:17:42,949
there<font color="#E5E5E5"> is a process listing with all the</font>

419
00:17:41,290 --> 00:17:44,899
processes running<font color="#E5E5E5"> on the system</font><font color="#CCCCCC"> and</font>

420
00:17:42,950 --> 00:17:47,180
the arguments you might think<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is</font>

421
00:17:44,900 --> 00:17:49,250
<font color="#E5E5E5">not a big deal but actually even if you</font>

422
00:17:47,180 --> 00:17:51,140
own the device<font color="#CCCCCC"> even</font><font color="#E5E5E5"> if you have paid for</font>

423
00:17:49,250 --> 00:17:53,090
<font color="#CCCCCC">it</font><font color="#E5E5E5"> the vendors won't give you a shell in</font>

424
00:17:51,140 --> 00:17:56,030
<font color="#E5E5E5">there to be</font><font color="#CCCCCC"> able</font><font color="#E5E5E5"> to analyze or to do a</font>

425
00:17:53,090 --> 00:17:57,800
PS or something that so just for us at

426
00:17:56,030 --> 00:17:59,690
least to<font color="#E5E5E5"> be able</font><font color="#CCCCCC"> to analyze and see</font>

427
00:17:57,800 --> 00:18:03,770
what's going on<font color="#E5E5E5"> this is very very useful</font>

428
00:17:59,690 --> 00:18:06,080
<font color="#CCCCCC">and also</font><font color="#E5E5E5"> the last time</font><font color="#CCCCCC"> we checked on the</font>

429
00:18:03,770 --> 00:18:09,440
<font color="#E5E5E5">devices that we were analyzing</font><font color="#CCCCCC"> they were</font>

430
00:18:06,080 --> 00:18:11,990
all vulnerable to<font color="#E5E5E5"> CB from 2015 this is</font>

431
00:18:09,440 --> 00:18:13,280
<font color="#E5E5E5">an initialized pointer issue so it's not</font>

432
00:18:11,990 --> 00:18:15,170
easy<font color="#E5E5E5"> to explore you</font><font color="#CCCCCC"> will have to deal</font>

433
00:18:13,280 --> 00:18:17,780
<font color="#CCCCCC">with the eligibility with the heap and</font>

434
00:18:15,170 --> 00:18:20,390
play<font color="#E5E5E5"> but it's not impossible to exploit</font>

435
00:18:17,780 --> 00:18:23,570
<font color="#CCCCCC">it's just waiting there for somebody</font><font color="#E5E5E5"> to</font>

436
00:18:20,390 --> 00:18:29,030
just write it<font color="#E5E5E5"> but we want our own thing</font>

437
00:18:23,570 --> 00:18:32,480
yeah<font color="#E5E5E5"> so</font><font color="#CCCCCC"> e PMI</font><font color="#E5E5E5"> here allow</font><font color="#CCCCCC"> a PMI</font><font color="#E5E5E5"> aside</font>

438
00:18:29,030 --> 00:18:34,340
<font color="#E5E5E5">from</font><font color="#CCCCCC"> these</font><font color="#E5E5E5"> slide and Matias use so it's</font>

439
00:18:32,480 --> 00:18:37,160
it's really<font color="#CCCCCC"> confusing because</font><font color="#E5E5E5"> there is a</font>

440
00:18:34,340 --> 00:18:39,530
<font color="#CCCCCC">ipmi protocol but some people</font><font color="#E5E5E5"> call</font><font color="#CCCCCC"> BMC's</font>

441
00:18:37,160 --> 00:18:41,870
<font color="#CCCCCC">ipmi and and they're like many things</font>

442
00:18:39,530 --> 00:18:44,990
call<font color="#E5E5E5"> a PMI which was a mess</font><font color="#CCCCCC"> when we were</font>

443
00:18:41,870 --> 00:18:49,209
like researching<font color="#CCCCCC"> this but there's a</font>

444
00:18:44,990 --> 00:18:52,670
famous protocol that<font color="#E5E5E5"> all of the</font><font color="#CCCCCC"> BMC's</font>

445
00:18:49,210 --> 00:18:54,560
support<font color="#E5E5E5"> luckily not by default anymore</font>

446
00:18:52,670 --> 00:18:58,040
however<font color="#E5E5E5"> you still</font><font color="#CCCCCC"> see a lot of them</font>

447
00:18:54,560 --> 00:19:02,300
online and this protocol is UDP and

448
00:18:58,040 --> 00:19:03,889
ransom port<font color="#E5E5E5"> 623</font><font color="#CCCCCC"> it's basically used like</font>

449
00:19:02,300 --> 00:19:06,919
every other protocol<font color="#CCCCCC"> on BMC's allow you</font>

450
00:19:03,890 --> 00:19:08,780
to<font color="#CCCCCC"> manage the BMC</font><font color="#E5E5E5"> remotely over UDP so</font>

451
00:19:06,920 --> 00:19:13,040
you can get like a serial<font color="#E5E5E5"> saw or UDP</font>

452
00:19:08,780 --> 00:19:18,260
which<font color="#CCCCCC"> is useful somehow</font><font color="#E5E5E5"> the same with</font>

453
00:19:13,040 --> 00:19:19,760
UDP is that it was<font color="#CCCCCC"> call in</font><font color="#E5E5E5"> 213</font><font color="#CCCCCC"> one of</font>

454
00:19:18,260 --> 00:19:21,320
the most<font color="#CCCCCC"> danger posed</font><font color="#E5E5E5"> on</font><font color="#CCCCCC"> the war and</font>

455
00:19:19,760 --> 00:19:24,620
<font color="#E5E5E5">that's a bold statement because they're</font>

456
00:19:21,320 --> 00:19:26,149
like really<font color="#E5E5E5"> crappy protocols and I'm</font>

457
00:19:24,620 --> 00:19:27,500
sure you<font color="#E5E5E5"> guys experienced some of</font><font color="#CCCCCC"> those</font>

458
00:19:26,150 --> 00:19:29,630
crappy protocols which I'm not<font color="#E5E5E5"> gonna</font>

459
00:19:27,500 --> 00:19:35,300
<font color="#E5E5E5">mention but some of them were written by</font>

460
00:19:29,630 --> 00:19:37,220
Microsoft<font color="#E5E5E5"> so so there was a really</font>

461
00:19:35,300 --> 00:19:40,100
<font color="#E5E5E5">amazing research and if you can just</font>

462
00:19:37,220 --> 00:19:43,610
<font color="#CCCCCC">google</font><font color="#E5E5E5"> that it was done but damn former</font>

463
00:19:40,100 --> 00:19:45,409
on<font color="#E5E5E5"> a PMI and and again if you're doing a</font>

464
00:19:43,610 --> 00:19:47,060
pen test and you see that port<font color="#CCCCCC"> you know</font>

465
00:19:45,410 --> 00:19:48,890
<font color="#CCCCCC">you should be</font><font color="#E5E5E5"> really happy</font><font color="#CCCCCC"> of what's</font>

466
00:19:47,060 --> 00:19:51,620
gonna<font color="#CCCCCC"> happen to you</font><font color="#E5E5E5"> so the first thing</font>

467
00:19:48,890 --> 00:19:53,840
that<font color="#E5E5E5"> a</font><font color="#CCCCCC"> PMI did one of the earliest</font>

468
00:19:51,620 --> 00:19:56,449
versions is they came out<font color="#E5E5E5"> with</font><font color="#CCCCCC"> this</font>

469
00:19:53,840 --> 00:19:58,639
<font color="#E5E5E5">different</font><font color="#CCCCCC"> method to</font><font color="#E5E5E5"> authenticate</font>

470
00:19:56,450 --> 00:20:00,860
one of them was called<font color="#CCCCCC"> cypher zero so</font>

471
00:19:58,640 --> 00:20:03,590
when you see<font color="#CCCCCC"> that man you're like ah</font>

472
00:20:00,860 --> 00:20:06,469
something's wrong here<font color="#E5E5E5"> so basically if</font>

473
00:20:03,590 --> 00:20:09,260
the<font color="#CCCCCC"> API</font><font color="#E5E5E5"> allows I</font><font color="#CCCCCC"> pursue that means that</font>

474
00:20:06,470 --> 00:20:13,370
did require no user<font color="#E5E5E5"> me no password so</font>

475
00:20:09,260 --> 00:20:16,580
you know that pretty<font color="#E5E5E5"> much and the the</font>

476
00:20:13,370 --> 00:20:18,790
research however no<font color="#CCCCCC"> one supports</font><font color="#E5E5E5"> ciphers</font>

477
00:20:16,580 --> 00:20:21,860
here nowadays<font color="#CCCCCC"> thanks to Dan farmer</font>

478
00:20:18,790 --> 00:20:24,470
however Dan found a really<font color="#E5E5E5"> more very</font>

479
00:20:21,860 --> 00:20:26,810
<font color="#E5E5E5">interesting variety which</font><font color="#CCCCCC"> is the famous</font>

480
00:20:24,470 --> 00:20:29,030
rock P<font color="#CCCCCC"> alpha decay shoe</font><font color="#E5E5E5"> debacle</font><font color="#CCCCCC"> and</font>

481
00:20:26,810 --> 00:20:30,700
there's a lot to talk about<font color="#E5E5E5"> this but I'm</font>

482
00:20:29,030 --> 00:20:34,790
<font color="#E5E5E5">gonna try to be brief</font>

483
00:20:30,700 --> 00:20:37,340
basically what there was there<font color="#CCCCCC"> was a</font><font color="#E5E5E5"> 1.5</font>

484
00:20:34,790 --> 00:20:41,659
version of this<font color="#CCCCCC"> application mechanism</font>

485
00:20:37,340 --> 00:20:43,550
that was using md5<font color="#CCCCCC"> so I guess that</font>

486
00:20:41,660 --> 00:20:45,440
that's my own interpretation<font color="#CCCCCC"> of the</font>

487
00:20:43,550 --> 00:20:46,940
thing I guess they were like how many<font color="#CCCCCC"> 5s</font>

488
00:20:45,440 --> 00:20:48,980
<font color="#CCCCCC">warm oh</font><font color="#E5E5E5"> so let's move into something</font>

489
00:20:46,940 --> 00:20:52,730
<font color="#E5E5E5">like</font><font color="#CCCCCC"> H</font><font color="#E5E5E5"> mark like a more complex</font>

490
00:20:48,980 --> 00:20:56,900
<font color="#CCCCCC">krippchamp harsh sorry</font><font color="#E5E5E5"> and and so they</font>

491
00:20:52,730 --> 00:20:59,210
put together<font color="#E5E5E5"> the version 2.0 which does</font>

492
00:20:56,900 --> 00:21:02,870
the really interesting<font color="#E5E5E5"> handshake ever</font>

493
00:20:59,210 --> 00:21:05,030
heard about<font color="#E5E5E5"> this</font><font color="#CCCCCC"> pyramid team yeah so</font>

494
00:21:02,870 --> 00:21:08,479
basically what they did<font color="#E5E5E5"> is</font><font color="#CCCCCC"> like this</font>

495
00:21:05,030 --> 00:21:10,700
handshake<font color="#E5E5E5"> like sending autopsies I think</font>

496
00:21:08,480 --> 00:21:12,050
we have<font color="#E5E5E5"> to take</font><font color="#CCCCCC"> four</font><font color="#E5E5E5"> six a package to</font><font color="#CCCCCC"> do</font>

497
00:21:10,700 --> 00:21:14,780
the handshake between the server<font color="#E5E5E5"> and</font>

498
00:21:12,050 --> 00:21:17,180
client<font color="#CCCCCC"> if</font><font color="#E5E5E5"> you at some</font><font color="#CCCCCC"> point</font><font color="#E5E5E5"> you send the</font>

499
00:21:14,780 --> 00:21:19,700
username you<font color="#CCCCCC"> want</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> login and they</font>

500
00:21:17,180 --> 00:21:22,280
<font color="#CCCCCC">return the hash of the password</font><font color="#E5E5E5"> like the</font>

501
00:21:19,700 --> 00:21:24,080
server you<font color="#E5E5E5"> said like I want to log in as</font>

502
00:21:22,280 --> 00:21:26,990
an admin and<font color="#CCCCCC"> the server</font><font color="#E5E5E5"> is like this is</font>

503
00:21:24,080 --> 00:21:29,210
the hash of the password and<font color="#E5E5E5"> you're like</font>

504
00:21:26,990 --> 00:21:30,530
why<font color="#CCCCCC"> it will do</font><font color="#E5E5E5"> that and you know what</font>

505
00:21:29,210 --> 00:21:33,440
the more<font color="#E5E5E5"> interesting thing is that that</font>

506
00:21:30,530 --> 00:21:35,450
<font color="#CCCCCC">was part of the</font><font color="#E5E5E5"> design so</font><font color="#CCCCCC"> they're not</font>

507
00:21:33,440 --> 00:21:38,260
<font color="#E5E5E5">able to fix it because there is no fix</font>

508
00:21:35,450 --> 00:21:42,980
this is how the protocol work and so

509
00:21:38,260 --> 00:21:45,680
nowadays<font color="#CCCCCC"> if you see an</font><font color="#E5E5E5"> APM</font><font color="#CCCCCC"> I'm this is</font>

510
00:21:42,980 --> 00:21:47,840
the<font color="#E5E5E5"> last like modern application</font>

511
00:21:45,680 --> 00:21:50,420
mechanics on<font color="#E5E5E5"> rock P so you see an APM</font><font color="#CCCCCC"> I</font>

512
00:21:47,840 --> 00:21:51,740
online<font color="#CCCCCC"> or internal network that</font><font color="#E5E5E5"> means</font>

513
00:21:50,420 --> 00:21:53,900
that you were<font color="#CCCCCC"> able to obtain the hash of</font>

514
00:21:51,740 --> 00:21:55,430
<font color="#E5E5E5">any</font><font color="#CCCCCC"> username so</font><font color="#E5E5E5"> kind of like</font><font color="#CCCCCC"> the</font>

515
00:21:53,900 --> 00:21:57,200
<font color="#CCCCCC">username is a password you have</font><font color="#E5E5E5"> to put</font>

516
00:21:55,430 --> 00:22:02,030
like<font color="#CCCCCC"> a really complex password so like</font>

517
00:21:57,200 --> 00:22:04,700
<font color="#E5E5E5">people doesn't guess it I guess</font><font color="#CCCCCC"> anyways</font>

518
00:22:02,030 --> 00:22:06,410
<font color="#CCCCCC">then finally another bullet II</font><font color="#E5E5E5"> that the</font>

519
00:22:04,700 --> 00:22:10,220
<font color="#CCCCCC">guys from MWR</font>

520
00:22:06,410 --> 00:22:12,950
did was they find out that decision ID

521
00:22:10,220 --> 00:22:15,830
using our after authentication remember

522
00:22:12,950 --> 00:22:17,539
this is UDP<font color="#CCCCCC"> it was kind of predictable</font>

523
00:22:15,830 --> 00:22:20,240
there's like out of<font color="#CCCCCC"> the</font><font color="#E5E5E5"> four bytes or</font>

524
00:22:17,539 --> 00:22:22,280
<font color="#E5E5E5">choose our fix it and then the other</font>

525
00:22:20,240 --> 00:22:23,690
ones<font color="#CCCCCC"> easy to predict</font><font color="#E5E5E5"> so obviously you</font>

526
00:22:22,280 --> 00:22:25,610
can<font color="#CCCCCC"> inject packets in</font><font color="#E5E5E5"> the middle if</font>

527
00:22:23,690 --> 00:22:27,530
you're like in a position to inject

528
00:22:25,610 --> 00:22:29,658
packets it's easy to guess it so

529
00:22:27,530 --> 00:22:31,580
remember this is UDP<font color="#E5E5E5"> you can have a</font>

530
00:22:29,659 --> 00:22:35,240
serial console with EDP so it's kind<font color="#CCCCCC"> of</font>

531
00:22:31,580 --> 00:22:39,530
<font color="#E5E5E5">like bad we look at it I was</font><font color="#CCCCCC"> like this</font>

532
00:22:35,240 --> 00:22:42,049
is almost<font color="#E5E5E5"> done but you know we want to</font>

533
00:22:39,530 --> 00:22:45,230
<font color="#E5E5E5">look at it anyway and</font><font color="#CCCCCC"> enterin stupid</font>

534
00:22:42,049 --> 00:22:47,030
back so<font color="#CCCCCC"> this kind of like integer</font>

535
00:22:45,230 --> 00:22:49,130
<font color="#CCCCCC">underflow it's super easy</font><font color="#E5E5E5"> to see it</font>

536
00:22:47,030 --> 00:22:51,830
<font color="#CCCCCC">obviously this is Zelda code</font>

537
00:22:49,130 --> 00:22:56,600
so basically there was<font color="#CCCCCC"> maths Len on the</font>

538
00:22:51,830 --> 00:22:59,658
<font color="#CCCCCC">the main header of the a</font><font color="#E5E5E5"> PMI package</font><font color="#CCCCCC"> so</font>

539
00:22:56,600 --> 00:23:00,949
that's like the the one encapsulate<font color="#CCCCCC"> all</font>

540
00:22:59,659 --> 00:23:03,559
the other things so<font color="#E5E5E5"> there is no even</font>

541
00:23:00,950 --> 00:23:05,570
like<font color="#E5E5E5"> authentication on this point and if</font>

542
00:23:03,559 --> 00:23:09,320
you make it<font color="#CCCCCC"> less than</font><font color="#E5E5E5"> six bytes on the</font>

543
00:23:05,570 --> 00:23:12,439
allah - this<font color="#CCCCCC"> is gonna became a negative</font>

544
00:23:09,320 --> 00:23:14,870
number<font color="#CCCCCC"> so then when then there's gonna</font>

545
00:23:12,440 --> 00:23:18,710
<font color="#E5E5E5">be an overflow on the pool that's been</font>

546
00:23:14,870 --> 00:23:20,750
allocated<font color="#CCCCCC"> which is a fixed</font><font color="#E5E5E5"> set</font><font color="#CCCCCC"> side and</font>

547
00:23:18,710 --> 00:23:21,890
this<font color="#CCCCCC"> is the trigger you</font><font color="#E5E5E5"> want</font><font color="#CCCCCC"> to try it</font>

548
00:23:20,750 --> 00:23:25,850
<font color="#E5E5E5">at home</font>

549
00:23:21,890 --> 00:23:27,980
<font color="#E5E5E5">it's not easy to exploit but it's it's</font>

550
00:23:25,850 --> 00:23:34,969
doable<font color="#CCCCCC"> but again there's</font><font color="#E5E5E5"> gonna be better</font>

551
00:23:27,980 --> 00:23:37,400
things<font color="#E5E5E5"> so</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> of TDD targets that we</font>

552
00:23:34,970 --> 00:23:39,559
were looking<font color="#CCCCCC"> at or web servers right</font>

553
00:23:37,400 --> 00:23:43,159
because web servers are always really

554
00:23:39,559 --> 00:23:46,700
interesting<font color="#E5E5E5"> and in at</font><font color="#CCCCCC"> least</font><font color="#E5E5E5"> in the case</font>

555
00:23:43,159 --> 00:23:49,039
<font color="#E5E5E5">of</font><font color="#CCCCCC"> EMC is also interesting because</font><font color="#E5E5E5"> on</font>

556
00:23:46,700 --> 00:23:51,080
<font color="#E5E5E5">our experience every time we we were</font>

557
00:23:49,039 --> 00:23:53,870
working on like big<font color="#CCCCCC"> networks for clients</font>

558
00:23:51,080 --> 00:23:55,970
we always even if these<font color="#CCCCCC"> devices were</font>

559
00:23:53,870 --> 00:23:59,959
like in isolated<font color="#CCCCCC"> Network separately</font><font color="#E5E5E5"> from</font>

560
00:23:55,970 --> 00:24:01,370
the rest<font color="#E5E5E5"> port 443 or 22 for SSH was</font>

561
00:23:59,960 --> 00:24:03,590
always open<font color="#CCCCCC"> I don't know why maybe</font>

562
00:24:01,370 --> 00:24:06,350
<font color="#E5E5E5">because odd means to use this part to</font>

563
00:24:03,590 --> 00:24:08,570
get the<font color="#CCCCCC"> BMC's or whatever so that</font><font color="#E5E5E5"> makes</font>

564
00:24:06,350 --> 00:24:10,280
it actually are<font color="#E5E5E5"> more</font><font color="#CCCCCC"> realistic scenario</font>

565
00:24:08,570 --> 00:24:14,530
<font color="#E5E5E5">for an attacker to be able to reach that</font>

566
00:24:10,280 --> 00:24:16,639
port that<font color="#CCCCCC"> may be some other weird thing</font>

567
00:24:14,530 --> 00:24:19,190
<font color="#E5E5E5">most of the devices that we analyzed</font>

568
00:24:16,640 --> 00:24:21,770
<font color="#CCCCCC">were</font><font color="#E5E5E5"> using a web server which is called</font>

569
00:24:19,190 --> 00:24:24,169
a<font color="#E5E5E5"> PP well this is pretty popular on</font><font color="#CCCCCC"> the</font>

570
00:24:21,770 --> 00:24:27,649
embedded world and is

571
00:24:24,169 --> 00:24:30,859
<font color="#E5E5E5">very secure</font><font color="#CCCCCC"> without it is</font><font color="#E5E5E5"> very solid so</font>

572
00:24:27,649 --> 00:24:32,748
finding an abiding the<font color="#E5E5E5"> can be</font><font color="#CCCCCC"> done</font><font color="#E5E5E5"> but</font>

573
00:24:30,859 --> 00:24:34,699
it would<font color="#E5E5E5"> have been a challenge but the</font>

574
00:24:32,749 --> 00:24:38,690
thing<font color="#CCCCCC"> is</font><font color="#E5E5E5"> that sometimes</font><font color="#CCCCCC"> vendors decide</font>

575
00:24:34,700 --> 00:24:40,519
to not use the proven solution that they

576
00:24:38,690 --> 00:24:42,470
know that<font color="#E5E5E5"> works and it is secure and</font>

577
00:24:40,519 --> 00:24:43,970
everything because they can't<font color="#E5E5E5"> just</font><font color="#CCCCCC"> be</font>

578
00:24:42,470 --> 00:24:46,850
<font color="#E5E5E5">the wrong thing</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> know because why not</font>

579
00:24:43,970 --> 00:24:49,549
<font color="#CCCCCC">so some of them decide</font><font color="#E5E5E5"> to build their</font>

580
00:24:46,850 --> 00:24:51,199
own web servers<font color="#CCCCCC"> and that's when things</font>

581
00:24:49,549 --> 00:24:54,950
get really interesting

582
00:24:51,200 --> 00:24:57,230
but<font color="#CCCCCC"> also speaking out web servers</font><font color="#E5E5E5"> is not</font>

583
00:24:54,950 --> 00:24:59,389
only<font color="#E5E5E5"> about the web server themselves but</font>

584
00:24:57,230 --> 00:25:02,299
also about<font color="#E5E5E5"> what web</font><font color="#CCCCCC"> servers give you</font>

585
00:24:59,389 --> 00:25:05,809
access to<font color="#E5E5E5"> what kind of things are built</font>

586
00:25:02,299 --> 00:25:08,929
on top of web servers so what you see on

587
00:25:05,809 --> 00:25:13,009
the screen<font color="#E5E5E5"> for</font><font color="#CCCCCC"> example in the case</font><font color="#E5E5E5"> of HP</font>

588
00:25:08,929 --> 00:25:16,519
ILO - sorry<font color="#CCCCCC"> HP ILO in general we have an</font>

589
00:25:13,009 --> 00:25:18,529
endpoint that<font color="#E5E5E5"> is called XML data that is</font>

590
00:25:16,519 --> 00:25:21,379
<font color="#E5E5E5">reachable authenticated so if you just</font>

591
00:25:18,529 --> 00:25:23,869
<font color="#E5E5E5">point your browser there the device will</font>

592
00:25:21,379 --> 00:25:26,629
spit out at you<font color="#CCCCCC"> a lot of</font><font color="#E5E5E5"> information in</font>

593
00:25:23,869 --> 00:25:28,428
XML<font color="#CCCCCC"> I mean that information you will see</font>

594
00:25:26,629 --> 00:25:31,070
<font color="#E5E5E5">for example the IP addresses and MAC</font>

595
00:25:28,429 --> 00:25:33,919
addresses but<font color="#CCCCCC"> also you will find the</font>

596
00:25:31,070 --> 00:25:35,480
exact<font color="#CCCCCC"> fillmore version and if you have</font>

597
00:25:33,919 --> 00:25:38,480
ever been<font color="#E5E5E5"> working or trying to exploit</font>

598
00:25:35,480 --> 00:25:41,480
<font color="#CCCCCC">Vice or having to develop</font><font color="#E5E5E5"> an expert or</font>

599
00:25:38,480 --> 00:25:42,679
sampler<font color="#CCCCCC"> you know that knowing the</font><font color="#E5E5E5"> exact</font>

600
00:25:41,480 --> 00:25:44,869
version<font color="#E5E5E5"> of the system</font><font color="#CCCCCC"> that you're</font>

601
00:25:42,679 --> 00:25:47,600
<font color="#E5E5E5">targeting is very very</font><font color="#CCCCCC"> useful it's</font>

602
00:25:44,869 --> 00:25:49,100
actually invaluable<font color="#E5E5E5"> in</font><font color="#CCCCCC"> the case of Iraq</font>

603
00:25:47,600 --> 00:25:51,918
<font color="#CCCCCC">it has something similar just</font><font color="#E5E5E5"> with a</font>

604
00:25:49,100 --> 00:25:54,649
<font color="#E5E5E5">different name both of these features</font>

605
00:25:51,919 --> 00:25:56,570
can<font color="#CCCCCC"> be disabled</font><font color="#E5E5E5"> but at least again in</font>

606
00:25:54,649 --> 00:25:58,699
the in the cases that we have<font color="#CCCCCC"> seen</font><font color="#E5E5E5"> in</font>

607
00:25:56,570 --> 00:26:00,109
companies administrators don't<font color="#E5E5E5"> want to</font>

608
00:25:58,700 --> 00:26:02,960
disable this<font color="#E5E5E5"> because they actually use</font>

609
00:26:00,109 --> 00:26:04,489
it and there is no way to<font color="#E5E5E5"> enable</font>

610
00:26:02,960 --> 00:26:06,350
authentication<font color="#E5E5E5"> you either have it there</font>

611
00:26:04,489 --> 00:26:13,309
like accessible to everybody<font color="#CCCCCC"> or</font><font color="#E5E5E5"> you</font>

612
00:26:06,350 --> 00:26:15,678
don't you okay<font color="#CCCCCC"> so continuing</font><font color="#E5E5E5"> with web</font>

613
00:26:13,309 --> 00:26:18,529
servers there's a very<font color="#CCCCCC"> very</font><font color="#E5E5E5"> interesting</font>

614
00:26:15,679 --> 00:26:20,480
bug that<font color="#E5E5E5"> the French guys let me read</font>

615
00:26:18,529 --> 00:26:22,629
their names properly<font color="#CCCCCC"> five MP regard</font>

616
00:26:20,480 --> 00:26:25,850
Alexandre Cosette and<font color="#CCCCCC"> Jeffrey's</font><font color="#E5E5E5"> attorney</font>

617
00:26:22,629 --> 00:26:26,359
<font color="#CCCCCC">there's</font><font color="#E5E5E5"> a very very</font><font color="#CCCCCC"> amazing by what they</font>

618
00:26:25,850 --> 00:26:29,509
found

619
00:26:26,359 --> 00:26:33,499
<font color="#CCCCCC">it's actually</font><font color="#E5E5E5"> and so the idea for</font><font color="#CCCCCC"> web</font>

620
00:26:29,509 --> 00:26:34,660
server when it parses the an HTTP

621
00:26:33,499 --> 00:26:36,880
request

622
00:26:34,660 --> 00:26:39,460
it checks<font color="#CCCCCC"> for the different heaters and</font>

623
00:26:36,880 --> 00:26:41,740
when he<font color="#E5E5E5"> finds</font><font color="#CCCCCC"> the connection here he</font>

624
00:26:39,460 --> 00:26:44,200
will<font color="#E5E5E5"> use</font><font color="#CCCCCC"> SSKIN F without any</font><font color="#E5E5E5"> kind of</font>

625
00:26:41,740 --> 00:26:47,740
size validation at all<font color="#CCCCCC"> to read the</font>

626
00:26:44,200 --> 00:26:49,330
content of that<font color="#E5E5E5"> heater and the D value</font>

627
00:26:47,740 --> 00:26:51,190
is actually<font color="#E5E5E5"> stored on the stack on a</font>

628
00:26:49,330 --> 00:26:54,669
buffer<font color="#CCCCCC"> I do</font><font color="#E5E5E5"> was I have</font><font color="#CCCCCC"> 14 16 bytes</font>

629
00:26:51,190 --> 00:26:58,330
<font color="#E5E5E5">around those numbers small s so this is</font>

630
00:26:54,670 --> 00:27:00,910
just<font color="#E5E5E5"> a plain stack overflow you can just</font>

631
00:26:58,330 --> 00:27:03,610
like that with<font color="#CCCCCC"> we sending just</font><font color="#E5E5E5"> one</font>

632
00:27:00,910 --> 00:27:05,680
request you can<font color="#E5E5E5"> crush the server but it</font>

633
00:27:03,610 --> 00:27:07,959
was what is much<font color="#E5E5E5"> more interesting is the</font>

634
00:27:05,680 --> 00:27:10,660
the italic exploit<font color="#CCCCCC"> that they come</font><font color="#E5E5E5"> up</font>

635
00:27:07,960 --> 00:27:13,270
with what<font color="#E5E5E5"> is very very clever instead of</font>

636
00:27:10,660 --> 00:27:16,030
doing the classic<font color="#CCCCCC"> shackle thing and</font>

637
00:27:13,270 --> 00:27:18,190
trying to get God execution what they

638
00:27:16,030 --> 00:27:20,530
found was<font color="#E5E5E5"> that there was a variable in</font>

639
00:27:18,190 --> 00:27:22,750
<font color="#CCCCCC">this stack</font><font color="#E5E5E5"> a little</font><font color="#CCCCCC"> bit below</font><font color="#E5E5E5"> the one</font>

640
00:27:20,530 --> 00:27:24,760
that was<font color="#E5E5E5"> being overflowed and that</font>

641
00:27:22,750 --> 00:27:28,000
<font color="#E5E5E5">variable was actually a flag that</font>

642
00:27:24,760 --> 00:27:31,180
indicated<font color="#E5E5E5"> if the connection was remote</font>

643
00:27:28,000 --> 00:27:33,250
or local so local is from the same<font color="#CCCCCC"> web</font>

644
00:27:31,180 --> 00:27:35,350
from from the server<font color="#E5E5E5"> where the BMC is</font>

645
00:27:33,250 --> 00:27:37,570
attached to<font color="#CCCCCC"> a</font><font color="#E5E5E5"> remote is from the network</font>

646
00:27:35,350 --> 00:27:38,469
and whenever<font color="#E5E5E5"> a connection is remote</font><font color="#CCCCCC"> a</font>

647
00:27:37,570 --> 00:27:41,320
local sorry

648
00:27:38,470 --> 00:27:43,690
it doesn't need authentication<font color="#E5E5E5"> so in the</font>

649
00:27:41,320 --> 00:27:46,179
end what you can do is just<font color="#E5E5E5"> send a</font>

650
00:27:43,690 --> 00:27:49,330
<font color="#E5E5E5">request an HTTP POST for example with</font>

651
00:27:46,180 --> 00:27:52,180
<font color="#E5E5E5">this specific here with our size of 29</font>

652
00:27:49,330 --> 00:27:55,090
with whatever<font color="#E5E5E5"> value you want and that</font>

653
00:27:52,180 --> 00:27:56,290
will trick the web server into thinking

654
00:27:55,090 --> 00:27:58,419
that the connection is local so it

655
00:27:56,290 --> 00:28:01,090
doesn't need<font color="#E5E5E5"> salt indication so that</font>

656
00:27:58,420 --> 00:28:02,530
request will just go through<font color="#E5E5E5"> and what</font>

657
00:28:01,090 --> 00:28:04,780
<font color="#E5E5E5">you see on screen is the request that</font>

658
00:28:02,530 --> 00:28:10,110
you need to send<font color="#CCCCCC"> to create a new user on</font>

659
00:28:04,780 --> 00:28:14,139
the system when we<font color="#E5E5E5"> analyze</font><font color="#CCCCCC"> I drag eight</font>

660
00:28:10,110 --> 00:28:15,879
we also found an ability that reminders

661
00:28:14,140 --> 00:28:19,000
to the<font color="#E5E5E5"> 90s again because this is like</font>

662
00:28:15,880 --> 00:28:23,820
the<font color="#CCCCCC"> kind of thing that it doesn't should</font>

663
00:28:19,000 --> 00:28:27,880
happen<font color="#E5E5E5"> anymore</font><font color="#CCCCCC"> and in this case it was a</font>

664
00:28:23,820 --> 00:28:29,320
remote environment parallel injection so

665
00:28:27,880 --> 00:28:31,830
basically the<font color="#E5E5E5"> problem here is</font><font color="#CCCCCC"> that the</font>

666
00:28:29,320 --> 00:28:35,020
DI drug<font color="#CCCCCC"> eight web server what it does</font>

667
00:28:31,830 --> 00:28:38,530
<font color="#E5E5E5">when it gets a request that is directed</font>

668
00:28:35,020 --> 00:28:40,240
to the<font color="#E5E5E5"> slash</font><font color="#CCCCCC"> cgi-bin</font><font color="#E5E5E5"> path you will call</font>

669
00:28:38,530 --> 00:28:43,330
a handler and this can do<font color="#E5E5E5"> we do</font>

670
00:28:40,240 --> 00:28:45,910
basically<font color="#E5E5E5"> three steps first it will try</font>

671
00:28:43,330 --> 00:28:48,168
<font color="#CCCCCC">to</font><font color="#E5E5E5"> find the binary that needs to</font><font color="#CCCCCC"> be</font>

672
00:28:45,910 --> 00:28:51,409
executed<font color="#CCCCCC"> then as a second</font>

673
00:28:48,169 --> 00:28:53,899
<font color="#CCCCCC">trap it will pass the</font><font color="#E5E5E5"> URI and use all</font>

674
00:28:51,409 --> 00:28:55,970
<font color="#E5E5E5">all of that parameters in order to build</font>

675
00:28:53,899 --> 00:28:58,729
environment for that<font color="#E5E5E5"> binary and then it</font>

676
00:28:55,970 --> 00:29:00,259
will finally<font color="#CCCCCC"> execute it</font><font color="#E5E5E5"> and there are</font><font color="#CCCCCC"> a</font>

677
00:28:58,730 --> 00:29:01,730
couple<font color="#CCCCCC"> of binaries that</font><font color="#E5E5E5"> are available</font>

678
00:29:00,259 --> 00:29:03,320
<font color="#CCCCCC">unauthenticated</font><font color="#E5E5E5"> such as for example</font>

679
00:29:01,730 --> 00:29:05,659
logging that<font color="#E5E5E5"> needs to</font><font color="#CCCCCC"> be available and</font>

680
00:29:03,320 --> 00:29:08,720
<font color="#E5E5E5">indicated right so what you can do is</font>

681
00:29:05,659 --> 00:29:10,669
just send a request in there and for

682
00:29:08,720 --> 00:29:12,109
<font color="#E5E5E5">that binary that is being executed</font><font color="#CCCCCC"> you</font>

683
00:29:10,669 --> 00:29:15,049
can control all<font color="#CCCCCC"> of the</font><font color="#E5E5E5"> environment</font>

684
00:29:12,109 --> 00:29:16,699
variables<font color="#E5E5E5"> how will exploit that is there</font>

685
00:29:15,049 --> 00:29:18,019
anyone<font color="#CCCCCC"> from</font><font color="#E5E5E5"> the 90s that you just like</font>

686
00:29:16,700 --> 00:29:21,379
to see this kind<font color="#CCCCCC"> of</font><font color="#E5E5E5"> backs you remember</font>

687
00:29:18,019 --> 00:29:22,999
how you exploit that<font color="#E5E5E5"> so you can accept</font>

688
00:29:21,379 --> 00:29:24,199
<font color="#E5E5E5">tell conserve all the environment</font>

689
00:29:22,999 --> 00:29:25,759
variables for a binary that<font color="#E5E5E5"> you are</font>

690
00:29:24,200 --> 00:29:29,779
executing<font color="#CCCCCC"> no there's no one</font><font color="#E5E5E5"> trick that</font>

691
00:29:25,759 --> 00:29:31,960
<font color="#CCCCCC">we used to do</font><font color="#E5E5E5"> people long time ago yes</font>

692
00:29:29,779 --> 00:29:34,789
<font color="#CCCCCC">when you find this kind of wine</font>

693
00:29:31,960 --> 00:29:37,460
no no<font color="#CCCCCC"> Apple is always like for sure</font><font color="#E5E5E5"> but</font>

694
00:29:34,789 --> 00:29:44,059
<font color="#CCCCCC">I mean like how do</font><font color="#E5E5E5"> you like</font><font color="#CCCCCC"> which</font><font color="#E5E5E5"> DLL</font>

695
00:29:37,460 --> 00:29:46,519
will<font color="#CCCCCC"> used like load so basically if you</font>

696
00:29:44,059 --> 00:29:48,918
<font color="#E5E5E5">send any environment</font><font color="#CCCCCC"> wherever and</font><font color="#E5E5E5"> they</font>

697
00:29:46,519 --> 00:29:51,230
<font color="#CCCCCC">own the URI</font><font color="#E5E5E5"> and we will be sent to d2</font>

698
00:29:48,919 --> 00:29:52,850
diviner is executed<font color="#E5E5E5"> so if you send</font><font color="#CCCCCC"> LG</font>

699
00:29:51,230 --> 00:29:54,230
debug the web<font color="#E5E5E5"> server will throw at you</font>

700
00:29:52,850 --> 00:29:56,600
all the debug the linker will send you

701
00:29:54,230 --> 00:29:58,609
the all<font color="#E5E5E5"> the debug information for the</font>

702
00:29:56,600 --> 00:30:00,439
libraries loaded<font color="#E5E5E5"> if you send you can all</font>

703
00:29:58,609 --> 00:30:02,720
send LD preload as you<font color="#CCCCCC"> as you well sir</font>

704
00:30:00,440 --> 00:30:06,440
<font color="#CCCCCC">and that will instruct the linker to</font>

705
00:30:02,720 --> 00:30:08,720
load<font color="#E5E5E5"> binary but that binary that we can</font>

706
00:30:06,440 --> 00:30:10,759
somehow try to put something<font color="#E5E5E5"> up</font><font color="#CCCCCC"> that we</font>

707
00:30:08,720 --> 00:30:12,259
can control should<font color="#CCCCCC"> be on the same</font><font color="#E5E5E5"> device</font>

708
00:30:10,759 --> 00:30:13,759
where this<font color="#E5E5E5"> web server is running and</font>

709
00:30:12,259 --> 00:30:15,980
<font color="#CCCCCC">that's the</font><font color="#E5E5E5"> baby MC and we can't</font><font color="#CCCCCC"> read</font>

710
00:30:13,759 --> 00:30:18,619
<font color="#CCCCCC">white files</font><font color="#E5E5E5"> to the BMC at least not yet</font>

711
00:30:15,980 --> 00:30:20,480
so the the old trick that<font color="#E5E5E5"> was done</font>

712
00:30:18,619 --> 00:30:22,730
<font color="#E5E5E5">before and done like a million times</font>

713
00:30:20,480 --> 00:30:27,019
before<font color="#CCCCCC"> to exploit</font><font color="#E5E5E5"> these kind of things</font>

714
00:30:22,730 --> 00:30:29,809
was<font color="#CCCCCC"> to point LD preload to the standard</font>

715
00:30:27,019 --> 00:30:33,080
input file from for the for the self

716
00:30:29,809 --> 00:30:36,678
process so if you did<font color="#E5E5E5"> that you can send</font>

717
00:30:33,080 --> 00:30:38,749
the your payload your<font color="#CCCCCC"> share library with</font>

718
00:30:36,679 --> 00:30:40,629
your code on the same request that you

719
00:30:38,749 --> 00:30:42,619
were doing<font color="#CCCCCC"> - what - web server but</font>

720
00:30:40,629 --> 00:30:45,859
<font color="#CCCCCC">unfortunately this didn't work very</font><font color="#E5E5E5"> well</font>

721
00:30:42,619 --> 00:30:47,720
<font color="#CCCCCC">for us because somehow the</font><font color="#E5E5E5"> linker on</font>

722
00:30:45,859 --> 00:30:50,869
<font color="#E5E5E5">this device didn't like non regular</font>

723
00:30:47,720 --> 00:30:53,899
files<font color="#CCCCCC"> so this act leading work em map</font>

724
00:30:50,869 --> 00:30:57,109
was was<font color="#CCCCCC"> filing there</font><font color="#E5E5E5"> so we kept looking</font>

725
00:30:53,899 --> 00:30:59,449
<font color="#CCCCCC">-</font><font color="#E5E5E5"> trying to find different charity</font>

726
00:30:57,109 --> 00:31:02,029
<font color="#CCCCCC">freidy's and what was we</font><font color="#E5E5E5"> found was a</font>

727
00:30:59,450 --> 00:31:06,200
different primitive that's<font color="#CCCCCC"> also</font>

728
00:31:02,029 --> 00:31:08,210
<font color="#CCCCCC">Tullius</font><font color="#E5E5E5"> CGI that we</font><font color="#CCCCCC"> let you write to a</font>

729
00:31:06,200 --> 00:31:10,219
specific file<font color="#E5E5E5"> word that you don't</font>

730
00:31:08,210 --> 00:31:13,249
<font color="#E5E5E5">control the names that is fixed</font><font color="#CCCCCC"> /t</font>

731
00:31:10,219 --> 00:31:15,529
<font color="#CCCCCC">airspeed</font><font color="#E5E5E5"> TMP</font><font color="#CCCCCC"> /</font><font color="#E5E5E5"> something but you can</font>

732
00:31:13,249 --> 00:31:18,139
<font color="#E5E5E5">control the whole data in the file so</font>

733
00:31:15,529 --> 00:31:20,629
then it's<font color="#E5E5E5"> game over right because what</font>

734
00:31:18,139 --> 00:31:23,869
you<font color="#CCCCCC"> can do is</font><font color="#E5E5E5"> first use these primitive</font>

735
00:31:20,629 --> 00:31:28,759
to upload some contents to a file on<font color="#E5E5E5"> the</font>

736
00:31:23,869 --> 00:31:31,158
BMC where you will upload<font color="#CCCCCC"> your connect</font>

737
00:31:28,759 --> 00:31:33,679
<font color="#E5E5E5">back for example</font><font color="#CCCCCC"> as a</font><font color="#E5E5E5"> share library then</font>

738
00:31:31,159 --> 00:31:35,479
at the second<font color="#E5E5E5"> step you</font><font color="#CCCCCC"> will use the you</font>

739
00:31:33,679 --> 00:31:37,159
will do<font color="#E5E5E5"> at the trigger with the</font><font color="#CCCCCC"> LD</font>

740
00:31:35,479 --> 00:31:39,679
<font color="#CCCCCC">preload</font><font color="#E5E5E5"> thing and finally get your</font>

741
00:31:37,159 --> 00:31:42,619
connect<font color="#E5E5E5"> back so let's see a quick demo</font>

742
00:31:39,679 --> 00:31:45,139
of<font color="#E5E5E5"> this in action again this is remote</font>

743
00:31:42,619 --> 00:31:46,428
<font color="#E5E5E5">this</font><font color="#CCCCCC"> is a logic bag</font><font color="#E5E5E5"> this is</font><font color="#CCCCCC"> a</font>

744
00:31:45,139 --> 00:31:48,439
<font color="#CCCCCC">notification</font>

745
00:31:46,429 --> 00:31:51,469
<font color="#CCCCCC">mu times back from the nineties</font><font color="#E5E5E5"> like</font><font color="#CCCCCC"> who</font>

746
00:31:48,440 --> 00:32:04,609
does who use<font color="#CCCCCC"> GGI being and allows</font>

747
00:31:51,469 --> 00:32:07,690
environmental parables okay so can you

748
00:32:04,609 --> 00:32:07,689
<font color="#CCCCCC">sit there</font><font color="#E5E5E5"> yeah that's good</font>

749
00:32:08,679 --> 00:32:13,849
for this demo we are using<font color="#CCCCCC"> cameras that</font>

750
00:32:11,089 --> 00:32:16,549
is our exploitation framework for

751
00:32:13,849 --> 00:32:18,200
<font color="#E5E5E5">penetration testing the exploit actually</font>

752
00:32:16,549 --> 00:32:20,239
very easy<font color="#E5E5E5"> to use you</font><font color="#CCCCCC"> just need to know</font>

753
00:32:18,200 --> 00:32:23,179
the IP<font color="#E5E5E5"> address and the port where the</font>

754
00:32:20,239 --> 00:32:23,629
<font color="#E5E5E5">BMC web server is running</font><font color="#CCCCCC"> and just click</font>

755
00:32:23,179 --> 00:32:25,429
<font color="#CCCCCC">OK</font>

756
00:32:23,629 --> 00:32:27,678
so this<font color="#E5E5E5"> will</font><font color="#CCCCCC"> actually do this the two</font>

757
00:32:25,429 --> 00:32:30,409
steps<font color="#E5E5E5"> that we tell you before first we</font>

758
00:32:27,679 --> 00:32:33,049
will do this trigger to blow some

759
00:32:30,409 --> 00:32:35,149
content to<font color="#CCCCCC"> a</font><font color="#E5E5E5"> known file then as a second</font>

760
00:32:33,049 --> 00:32:37,489
step you<font color="#CCCCCC"> will actually do the trigger</font>

761
00:32:35,149 --> 00:32:40,189
with the<font color="#CCCCCC"> LDP</font><font color="#E5E5E5"> low to low to force the</font>

762
00:32:37,489 --> 00:32:42,259
linker<font color="#E5E5E5"> in to loading that code so in</font>

763
00:32:40,190 --> 00:32:44,239
canvas we have the concept<font color="#CCCCCC"> of nodes</font><font color="#E5E5E5"> so</font>

764
00:32:42,259 --> 00:32:46,639
each of those are circles that you<font color="#E5E5E5"> see</font>

765
00:32:44,239 --> 00:32:48,950
<font color="#CCCCCC">in there represent a host where we</font>

766
00:32:46,639 --> 00:32:50,928
control we can execute<font color="#CCCCCC"> commands</font>

767
00:32:48,950 --> 00:32:53,059
basically<font color="#E5E5E5"> the first one that was already</font>

768
00:32:50,929 --> 00:32:54,710
<font color="#E5E5E5">there</font><font color="#CCCCCC"> when we start the demo represents</font>

769
00:32:53,059 --> 00:32:56,960
<font color="#E5E5E5">the machine where</font><font color="#CCCCCC"> we are running the</font>

770
00:32:54,710 --> 00:32:59,629
software<font color="#E5E5E5"> and the second one and then</font>

771
00:32:56,960 --> 00:33:01,729
<font color="#CCCCCC">pop-up</font><font color="#E5E5E5"> that represents the the device</font>

772
00:32:59,629 --> 00:33:06,498
that we have just compromised<font color="#CCCCCC"> in this</font>

773
00:33:01,729 --> 00:33:08,539
<font color="#E5E5E5">case is the GI tract so that we know</font>

774
00:33:06,499 --> 00:33:10,460
that lets you interact with<font color="#E5E5E5"> a node so as</font>

775
00:33:08,539 --> 00:33:13,009
you can<font color="#CCCCCC"> see once</font><font color="#E5E5E5"> the actual works</font>

776
00:33:10,460 --> 00:33:15,320
basically what we end up<font color="#E5E5E5"> with</font><font color="#CCCCCC"> is with</font><font color="#E5E5E5"> a</font>

777
00:33:13,009 --> 00:33:16,100
shell in there<font color="#E5E5E5"> where you can execute</font>

778
00:33:15,320 --> 00:33:17,950
commands

779
00:33:16,100 --> 00:33:21,409
get like the<font color="#CCCCCC"> last time or whatever and</font>

780
00:33:17,950 --> 00:33:24,580
as expected<font color="#E5E5E5"> always guess with what</font>

781
00:33:21,410 --> 00:33:26,330
<font color="#CCCCCC">username the web server</font><font color="#E5E5E5"> is running</font>

782
00:33:24,580 --> 00:33:29,360
<font color="#E5E5E5">because why not right</font>

783
00:33:26,330 --> 00:33:32,090
<font color="#CCCCCC">okay so just in case you notice</font><font color="#E5E5E5"> we were</font>

784
00:33:29,360 --> 00:33:33,979
attacking localhost<font color="#E5E5E5"> that's not because</font>

785
00:33:32,090 --> 00:33:37,520
the BMC was in the<font color="#CCCCCC"> localhost but rather</font>

786
00:33:33,980 --> 00:33:40,100
we<font color="#E5E5E5"> have a tunnel to our labs which was</font>

787
00:33:37,520 --> 00:33:42,139
in a<font color="#E5E5E5"> different office so that's why we</font>

788
00:33:40,100 --> 00:33:43,639
were<font color="#E5E5E5"> talking localhost</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> I</font><font color="#CCCCCC"> don't know</font>

789
00:33:42,140 --> 00:33:49,720
why it went again to the<font color="#CCCCCC"> beginning</font>

790
00:33:43,640 --> 00:33:49,720
oh sorry<font color="#CCCCCC"> okay sure Bob will be happy</font>

791
00:33:52,120 --> 00:34:01,850
that's<font color="#E5E5E5"> you all right</font>

792
00:33:54,919 --> 00:34:11,450
so I<font color="#E5E5E5"> think I'm missing some slice so</font>

793
00:34:01,850 --> 00:34:14,270
here we go<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> double yes man</font><font color="#E5E5E5"> this is a</font>

794
00:34:11,449 --> 00:34:17,178
protocol<font color="#CCCCCC"> that</font><font color="#E5E5E5"> definitely we're missing</font>

795
00:34:14,270 --> 00:34:20,350
slice<font color="#CCCCCC"> yeah</font><font color="#E5E5E5"> it's weird yeah yeah that's</font>

796
00:34:17,179 --> 00:34:28,840
cuz that's you're in the wrong slice yes

797
00:34:20,350 --> 00:34:28,839
yes sorry<font color="#CCCCCC"> about that</font>

798
00:34:29,139 --> 00:34:37,460
<font color="#E5E5E5">there we go</font>

799
00:34:30,590 --> 00:34:39,889
<font color="#E5E5E5">yeah yes you're using</font><font color="#CCCCCC"> Google slice grace</font>

800
00:34:37,460 --> 00:34:41,510
right it<font color="#E5E5E5"> actually works really well</font>

801
00:34:39,889 --> 00:34:48,619
there we go

802
00:34:41,510 --> 00:34:50,480
so<font color="#CCCCCC"> ws man it's protocol called web</font>

803
00:34:48,619 --> 00:34:55,340
service management has nothing to do

804
00:34:50,480 --> 00:34:57,770
with<font color="#CCCCCC"> my last</font><font color="#E5E5E5"> name</font><font color="#CCCCCC"> and Microsoft support</font>

805
00:34:55,340 --> 00:34:59,780
these<font color="#E5E5E5"> Natalie through Weiner am so it's</font>

806
00:34:57,770 --> 00:35:04,970
kind of<font color="#CCCCCC"> you use it quite a lot</font><font color="#E5E5E5"> because</font>

807
00:34:59,780 --> 00:35:07,820
every<font color="#CCCCCC"> windows IT person can easily</font><font color="#E5E5E5"> use</font>

808
00:35:04,970 --> 00:35:11,390
it<font color="#E5E5E5"> it's supported by PowerShell so that</font>

809
00:35:07,820 --> 00:35:13,369
makes scripting super easy to do<font color="#E5E5E5"> and</font>

810
00:35:11,390 --> 00:35:20,470
it's kind<font color="#E5E5E5"> of a protocol that looks like</font>

811
00:35:13,369 --> 00:35:23,810
XML<font color="#CCCCCC"> kind of product syntax based on so</font>

812
00:35:20,470 --> 00:35:27,459
how do you access it in generally it's<font color="#CCCCCC"> a</font>

813
00:35:23,810 --> 00:35:31,440
<font color="#E5E5E5">it's another</font><font color="#CCCCCC"> endpoint on a</font><font color="#E5E5E5"> GPS</font>

814
00:35:27,460 --> 00:35:34,059
it goes on<font color="#E5E5E5"> the WS man /ws man</font><font color="#CCCCCC"> endpoint</font>

815
00:35:31,440 --> 00:35:38,049
<font color="#CCCCCC">but</font><font color="#E5E5E5"> also can be</font><font color="#CCCCCC"> found stand alone</font>

816
00:35:34,059 --> 00:35:40,720
running<font color="#E5E5E5"> on the port 5985</font><font color="#CCCCCC"> and in general</font>

817
00:35:38,049 --> 00:35:43,240
<font color="#E5E5E5">induce ossification basically she's out</font>

818
00:35:40,720 --> 00:35:48,250
<font color="#E5E5E5">whatever application you had on the web</font>

819
00:35:43,240 --> 00:35:50,470
server<font color="#CCCCCC"> however in this case qu access at</font>

820
00:35:48,250 --> 00:35:53,020
least the parser<font color="#E5E5E5"> there is no</font><font color="#CCCCCC"> education</font>

821
00:35:50,470 --> 00:35:55,058
<font color="#CCCCCC">at all and the</font><font color="#E5E5E5"> reason we put that</font>

822
00:35:53,020 --> 00:35:59,140
picture<font color="#E5E5E5"> even</font><font color="#CCCCCC"> though we already spoil the</font>

823
00:35:55,059 --> 00:36:00,910
<font color="#E5E5E5">backs through that slice error is that</font>

824
00:35:59,140 --> 00:36:02,348
when we start researching thing you kind

825
00:36:00,910 --> 00:36:04,029
<font color="#CCCCCC">of like feel like</font><font color="#E5E5E5"> using a fanny pack</font>

826
00:36:02,349 --> 00:36:05,799
<font color="#E5E5E5">because like everyone</font><font color="#CCCCCC"> Mathilde looks</font>

827
00:36:04,029 --> 00:36:10,990
like the 90s<font color="#CCCCCC"> so weird</font>

828
00:36:05,799 --> 00:36:15,270
so the first black we found was<font color="#E5E5E5"> bug will</font>

829
00:36:10,990 --> 00:36:19,359
parse him<font color="#E5E5E5"> the XML tag super easy to find</font>

830
00:36:15,270 --> 00:36:21,819
<font color="#E5E5E5">and and again it's really similar</font><font color="#CCCCCC"> to the</font>

831
00:36:19,359 --> 00:36:24,400
warranty<font color="#CCCCCC"> that the guys</font><font color="#E5E5E5"> the French guys</font>

832
00:36:21,819 --> 00:36:28,119
find on<font color="#E5E5E5"> a</font><font color="#CCCCCC"> love</font><font color="#E5E5E5"> for which is basically a</font>

833
00:36:24,400 --> 00:36:33,880
scanf<font color="#E5E5E5"> and</font><font color="#CCCCCC"> on a stock buffer</font><font color="#E5E5E5"> a fix</font>

834
00:36:28,119 --> 00:36:35,410
extract buffer<font color="#E5E5E5"> super easy</font><font color="#CCCCCC"> and again this</font>

835
00:36:33,880 --> 00:36:38,200
is remote<font color="#CCCCCC"> this sound</font>

836
00:36:35,410 --> 00:36:41,288
<font color="#E5E5E5">I know dedicated and it's there in order</font>

837
00:36:38,200 --> 00:36:42,819
<font color="#CCCCCC">to exploit</font><font color="#E5E5E5"> it it's super simple</font><font color="#CCCCCC"> we put</font>

838
00:36:41,289 --> 00:36:44,920
the power<font color="#CCCCCC"> in</font><font color="#E5E5E5"> case you want to test it</font>

839
00:36:42,819 --> 00:36:49,150
but again this<font color="#E5E5E5"> is sending some</font><font color="#CCCCCC"> beasts on</font>

840
00:36:44,920 --> 00:36:50,890
the XML<font color="#E5E5E5"> and you just crash it the other</font>

841
00:36:49,150 --> 00:36:54,460
one that<font color="#E5E5E5"> we found was kind of similar</font>

842
00:36:50,890 --> 00:36:57,129
but in a different<font color="#E5E5E5"> place</font><font color="#CCCCCC"> it's the what</font>

843
00:36:54,460 --> 00:36:59,559
is called<font color="#E5E5E5"> the name XML namespace and</font>

844
00:36:57,130 --> 00:37:06,130
again and the same kind of thing<font color="#E5E5E5"> as can</font>

845
00:36:59,559 --> 00:37:06,400
<font color="#CCCCCC">F</font><font color="#E5E5E5"> stackoverflow uneducated</font><font color="#CCCCCC"> yeah same</font>

846
00:37:06,130 --> 00:37:11,140
thing

847
00:37:06,400 --> 00:37:13,359
<font color="#CCCCCC">easy to exploit again so but so</font>

848
00:37:11,140 --> 00:37:15,670
everything so so far it's quite nice we

849
00:37:13,359 --> 00:37:18,640
have like I<font color="#E5E5E5"> don't five different ways</font>

850
00:37:15,670 --> 00:37:20,049
<font color="#E5E5E5">which</font><font color="#CCCCCC"> you can compromise a</font><font color="#E5E5E5"> BMC but when</font>

851
00:37:18,640 --> 00:37:23,140
you start<font color="#CCCCCC"> thinking about real-life</font>

852
00:37:20,049 --> 00:37:26,038
<font color="#E5E5E5">scenarios things are not so</font><font color="#CCCCCC"> easy right</font>

853
00:37:23,140 --> 00:37:29,288
because while sometimes BMC are

854
00:37:26,039 --> 00:37:31,089
advertised<font color="#CCCCCC"> as if you could just connect</font>

855
00:37:29,289 --> 00:37:32,859
<font color="#E5E5E5">them to the Internet and I will make</font>

856
00:37:31,089 --> 00:37:34,900
your<font color="#E5E5E5"> life super easy because you can't</font>

857
00:37:32,859 --> 00:37:35,319
<font color="#E5E5E5">just reboot the server for from wherever</font>

858
00:37:34,900 --> 00:37:38,950
you are

859
00:37:35,319 --> 00:37:40,630
<font color="#CCCCCC">the truth is that this is not what</font>

860
00:37:38,950 --> 00:37:43,000
<font color="#E5E5E5">happens actually on</font>

861
00:37:40,630 --> 00:37:45,580
at least some big companies many when

862
00:37:43,000 --> 00:37:47,830
you<font color="#CCCCCC"> go to some kind of big corporation</font>

863
00:37:45,580 --> 00:37:49,930
you won't find the BMC connected to the

864
00:37:47,830 --> 00:37:52,990
internet directly<font color="#E5E5E5"> in fact what you will</font>

865
00:37:49,930 --> 00:37:56,500
find is like<font color="#CCCCCC"> one</font><font color="#E5E5E5"> DM seat where they will</font>

866
00:37:52,990 --> 00:37:58,060
<font color="#CCCCCC">have the servers with exposed services</font>

867
00:37:56,500 --> 00:37:59,950
to the<font color="#CCCCCC"> internet or multiple DM seats</font>

868
00:37:58,060 --> 00:38:01,930
<font color="#E5E5E5">then you will see a lot</font><font color="#CCCCCC"> of different</font>

869
00:37:59,950 --> 00:38:05,080
<font color="#CCCCCC">networks</font><font color="#E5E5E5"> for internal services or</font>

870
00:38:01,930 --> 00:38:07,029
<font color="#E5E5E5">back-end services and most</font><font color="#CCCCCC"> of them will</font>

871
00:38:05,080 --> 00:38:09,400
be<font color="#E5E5E5"> totally isolated</font><font color="#CCCCCC"> with each other or</font>

872
00:38:07,030 --> 00:38:11,980
heavily restricted with what<font color="#E5E5E5"> connects</font>

873
00:38:09,400 --> 00:38:14,620
can be accessed from<font color="#CCCCCC"> the other and then</font>

874
00:38:11,980 --> 00:38:16,660
<font color="#CCCCCC">you will</font><font color="#E5E5E5"> very likely see</font><font color="#CCCCCC"> some kind</font><font color="#E5E5E5"> of</font>

875
00:38:14,620 --> 00:38:18,520
totally different network on a different

876
00:38:16,660 --> 00:38:19,899
level which is usually called the

877
00:38:18,520 --> 00:38:21,490
out-of-band<font color="#E5E5E5"> network or management</font>

878
00:38:19,900 --> 00:38:23,650
<font color="#CCCCCC">network</font><font color="#E5E5E5"> this is kind of the</font><font color="#CCCCCC"> perfect</font>

879
00:38:21,490 --> 00:38:26,169
scenario<font color="#E5E5E5"> however like in the last free</font>

880
00:38:23,650 --> 00:38:28,810
pen test that we did we<font color="#E5E5E5"> compromised I</font>

881
00:38:26,170 --> 00:38:32,980
choose domain controllers BMC being

882
00:38:28,810 --> 00:38:34,600
accessible<font color="#E5E5E5"> in this Israel I look like</font>

883
00:38:32,980 --> 00:38:37,060
<font color="#E5E5E5">supposed to look</font><font color="#CCCCCC"> like</font><font color="#E5E5E5"> but when you</font>

884
00:38:34,600 --> 00:38:39,310
<font color="#E5E5E5">actually go to real companies not really</font>

885
00:38:37,060 --> 00:38:41,380
like that<font color="#CCCCCC"> but in the best scenario like</font>

886
00:38:39,310 --> 00:38:45,190
what you should find in theory should be

887
00:38:41,380 --> 00:38:48,160
<font color="#E5E5E5">this</font><font color="#CCCCCC"> and the</font><font color="#E5E5E5"> problem is</font><font color="#CCCCCC"> that how do</font><font color="#E5E5E5"> you</font>

888
00:38:45,190 --> 00:38:50,650
use whatever you<font color="#CCCCCC"> have</font><font color="#E5E5E5"> been seeing so far</font>

889
00:38:48,160 --> 00:38:52,420
<font color="#E5E5E5">in that scenario right it's like you</font>

890
00:38:50,650 --> 00:38:55,740
can't reach the<font color="#CCCCCC"> BMC from there from</font>

891
00:38:52,420 --> 00:38:57,730
<font color="#CCCCCC">internet so then it's</font><font color="#E5E5E5"> not dangerous</font>

892
00:38:55,740 --> 00:38:59,229
<font color="#CCCCCC">we like to you</font>

893
00:38:57,730 --> 00:39:01,390
<font color="#CCCCCC">we immediately</font><font color="#E5E5E5"> like to talk about</font>

894
00:38:59,230 --> 00:39:03,280
dimensions<font color="#CCCCCC"> instead of networks</font><font color="#E5E5E5"> because</font>

895
00:39:01,390 --> 00:39:07,960
it's just<font color="#E5E5E5"> a little bit broader of a</font>

896
00:39:03,280 --> 00:39:09,850
concept<font color="#CCCCCC"> so think of a sub network as a</font>

897
00:39:07,960 --> 00:39:11,830
dimension<font color="#E5E5E5"> but</font><font color="#CCCCCC"> also a thumb drive</font><font color="#E5E5E5"> that is</font>

898
00:39:09,850 --> 00:39:15,730
moving data from<font color="#E5E5E5"> one computer to</font><font color="#CCCCCC"> the are</font>

899
00:39:11,830 --> 00:39:18,130
like us<font color="#CCCCCC"> snack stack</font><font color="#E5E5E5"> Stuxnet did that</font>

900
00:39:15,730 --> 00:39:21,160
could<font color="#E5E5E5"> be</font><font color="#CCCCCC"> also considered I mentioned so</font>

901
00:39:18,130 --> 00:39:23,280
what we will<font color="#E5E5E5"> see</font><font color="#CCCCCC"> next is how</font><font color="#E5E5E5"> to abuse</font>

902
00:39:21,160 --> 00:39:26,200
the things that we have already seen and

903
00:39:23,280 --> 00:39:28,720
the inner trust that exists between<font color="#E5E5E5"> the</font>

904
00:39:26,200 --> 00:39:31,299
BMC<font color="#E5E5E5"> and</font><font color="#CCCCCC"> B</font><font color="#E5E5E5"> host where this BMC is</font>

905
00:39:28,720 --> 00:39:33,730
attached you in order<font color="#E5E5E5"> to move between</font>

906
00:39:31,300 --> 00:39:36,820
different<font color="#E5E5E5"> dimensions</font><font color="#CCCCCC"> of corporate</font>

907
00:39:33,730 --> 00:39:39,610
networks so let's start<font color="#E5E5E5"> with what is</font>

908
00:39:36,820 --> 00:39:42,910
already very known let's say<font color="#E5E5E5"> that</font><font color="#CCCCCC"> we'd</font>

909
00:39:39,610 --> 00:39:44,740
somehow have access to the out<font color="#E5E5E5"> of our</font>

910
00:39:42,910 --> 00:39:47,049
network<font color="#CCCCCC"> but</font><font color="#E5E5E5"> we are already</font><font color="#CCCCCC"> there right</font>

911
00:39:44,740 --> 00:39:50,970
like on the hacker movies that they put

912
00:39:47,050 --> 00:39:53,500
a<font color="#E5E5E5"> Raspberry Pi whatever in that</font><font color="#CCCCCC"> scenario</font>

913
00:39:50,970 --> 00:39:54,189
<font color="#E5E5E5">we know that we can compromise the</font><font color="#CCCCCC"> BMC</font>

914
00:39:53,500 --> 00:39:56,020
and

915
00:39:54,190 --> 00:39:58,090
we found a<font color="#CCCCCC"> couple</font><font color="#E5E5E5"> of amenities</font><font color="#CCCCCC"> the front</font>

916
00:39:56,020 --> 00:40:00,160
guys found a bunch<font color="#E5E5E5"> of</font><font color="#CCCCCC"> own abilities and</font>

917
00:39:58,090 --> 00:40:02,350
<font color="#CCCCCC">I bet</font><font color="#E5E5E5"> that anyone who spends some time</font>

918
00:40:00,160 --> 00:40:05,740
in there will already<font color="#E5E5E5"> find a lot more</font>

919
00:40:02,350 --> 00:40:08,710
<font color="#CCCCCC">and from there we can easily</font><font color="#E5E5E5"> jump to</font>

920
00:40:05,740 --> 00:40:10,779
<font color="#CCCCCC">this server</font><font color="#E5E5E5"> that is already kind</font><font color="#CCCCCC"> of a</font>

921
00:40:08,710 --> 00:40:14,290
known fact<font color="#E5E5E5"> because if you think about it</font>

922
00:40:10,780 --> 00:40:16,780
<font color="#E5E5E5">once you</font><font color="#CCCCCC"> have compromised a PMC</font><font color="#E5E5E5"> it's</font>

923
00:40:14,290 --> 00:40:18,160
almost as being as having physical

924
00:40:16,780 --> 00:40:20,950
access<font color="#CCCCCC"> to a server because you can</font>

925
00:40:18,160 --> 00:40:23,170
<font color="#E5E5E5">control many things of the server you</font>

926
00:40:20,950 --> 00:40:26,049
can<font color="#E5E5E5"> access the serial console you can</font>

927
00:40:23,170 --> 00:40:27,730
try to mount<font color="#E5E5E5"> a remote device or remote</font>

928
00:40:26,050 --> 00:40:30,550
optical drive for example<font color="#CCCCCC"> you can</font><font color="#E5E5E5"> upload</font>

929
00:40:27,730 --> 00:40:33,220
an ISO to the BMC<font color="#E5E5E5"> and this will emulate</font>

930
00:40:30,550 --> 00:40:36,700
<font color="#CCCCCC">an optical drive to the server you have</font>

931
00:40:33,220 --> 00:40:38,020
also<font color="#CCCCCC"> KVM</font><font color="#E5E5E5"> so can manage the keyboard and</font>

932
00:40:36,700 --> 00:40:39,939
<font color="#E5E5E5">see what's going on the screen so you</font>

933
00:40:38,020 --> 00:40:42,610
<font color="#E5E5E5">can reboot to the BIOS for example and</font>

934
00:40:39,940 --> 00:40:46,750
there's also DMA<font color="#CCCCCC"> I recommend seeing the</font>

935
00:40:42,610 --> 00:40:49,240
talk for the franchise<font color="#CCCCCC"> from recon on</font>

936
00:40:46,750 --> 00:40:52,360
<font color="#CCCCCC">this topic so if it has DMA you can</font>

937
00:40:49,240 --> 00:40:54,790
basically<font color="#E5E5E5"> access the the main server</font>

938
00:40:52,360 --> 00:40:57,940
memory<font color="#CCCCCC"> directly from the BMC so let's</font>

939
00:40:54,790 --> 00:41:01,960
see a quick<font color="#E5E5E5"> demo of one of the simplest</font>

940
00:40:57,940 --> 00:41:04,780
ways<font color="#CCCCCC"> to do this we decided here to go to</font>

941
00:41:01,960 --> 00:41:09,700
<font color="#CCCCCC">the via the easy way just</font><font color="#E5E5E5"> to show you</font>

942
00:41:04,780 --> 00:41:10,960
<font color="#E5E5E5">that it's possible</font><font color="#CCCCCC"> so we start by</font><font color="#E5E5E5"> the</font>

943
00:41:09,700 --> 00:41:14,560
<font color="#E5E5E5">assumption that we already have access</font>

944
00:41:10,960 --> 00:41:19,030
<font color="#E5E5E5">to a BMC that actually there</font><font color="#CCCCCC"> is the the</font>

945
00:41:14,560 --> 00:41:21,670
web console for<font color="#E5E5E5"> an</font><font color="#CCCCCC"> eye track sorry</font><font color="#E5E5E5"> so</font>

946
00:41:19,030 --> 00:41:24,550
what<font color="#E5E5E5"> we just launched is the feature</font>

947
00:41:21,670 --> 00:41:27,040
that's called<font color="#E5E5E5"> remote console what runs</font>

948
00:41:24,550 --> 00:41:29,110
<font color="#CCCCCC">using java that gives you basically a</font>

949
00:41:27,040 --> 00:41:32,110
remote<font color="#CCCCCC"> KVM right with some</font><font color="#E5E5E5"> other</font>

950
00:41:29,110 --> 00:41:34,780
<font color="#E5E5E5">features so the one of the easiest ways</font>

951
00:41:32,110 --> 00:41:36,760
to<font color="#E5E5E5"> compromise this is I bet that you</font>

952
00:41:34,780 --> 00:41:38,830
have done this at<font color="#E5E5E5"> least a couple at</font>

953
00:41:36,760 --> 00:41:40,810
least two times in<font color="#E5E5E5"> your life whatever</font>

954
00:41:38,830 --> 00:41:43,470
you forgot the password for<font color="#E5E5E5"> your</font><font color="#CCCCCC"> Linens</font>

955
00:41:40,810 --> 00:41:46,000
what did you did how do you recover it

956
00:41:43,470 --> 00:41:47,560
you put your boot to<font color="#CCCCCC"> the bootloader</font>

957
00:41:46,000 --> 00:41:49,660
right if you don't<font color="#CCCCCC"> have this</font><font color="#E5E5E5"> encryption</font>

958
00:41:47,560 --> 00:41:52,060
you just boot to<font color="#E5E5E5"> the border</font><font color="#CCCCCC"> so the same</font>

959
00:41:49,660 --> 00:41:53,259
exact thing can be<font color="#CCCCCC"> done here you can</font>

960
00:41:52,060 --> 00:41:57,070
reboot<font color="#CCCCCC"> the bootloader</font>

961
00:41:53,260 --> 00:41:59,380
<font color="#E5E5E5">I use the init equals to your shell</font><font color="#CCCCCC"> and</font>

962
00:41:57,070 --> 00:42:01,720
<font color="#E5E5E5">you get root access to a server this is</font>

963
00:41:59,380 --> 00:42:04,390
a very<font color="#E5E5E5"> very naive example we know that</font>

964
00:42:01,720 --> 00:42:06,669
<font color="#E5E5E5">but it works unless there is some that</font>

965
00:42:04,390 --> 00:42:07,660
kind of disk encryption or bios<font color="#E5E5E5"> password</font>

966
00:42:06,670 --> 00:42:10,059
whatever

967
00:42:07,660 --> 00:42:12,038
but this is the easy way you can<font color="#CCCCCC"> always</font>

968
00:42:10,059 --> 00:42:17,079
use DMA to try to compromise the server

969
00:42:12,039 --> 00:42:20,140
and be much more resilient<font color="#E5E5E5"> and make less</font>

970
00:42:17,079 --> 00:42:21,940
noise because this will<font color="#E5E5E5"> likely throw a</font>

971
00:42:20,140 --> 00:42:24,089
lot of alerts<font color="#E5E5E5"> if this always being</font>

972
00:42:21,940 --> 00:42:24,089
monitored

973
00:42:24,539 --> 00:42:31,990
<font color="#E5E5E5">okay you could also try to mount for</font>

974
00:42:28,059 --> 00:42:34,180
example<font color="#CCCCCC"> a live CD image for any any</font>

975
00:42:31,990 --> 00:42:36,640
<font color="#CCCCCC">linux thing if</font><font color="#E5E5E5"> this was a Windows the</font>

976
00:42:34,180 --> 00:42:39,250
<font color="#E5E5E5">host and then you think that you can</font>

977
00:42:36,640 --> 00:42:41,200
reboot<font color="#E5E5E5"> to</font><font color="#CCCCCC"> add live CD and mom to</font><font color="#E5E5E5"> disks</font>

978
00:42:39,250 --> 00:42:46,210
so<font color="#CCCCCC"> if you saw at the end of the video we</font>

979
00:42:41,200 --> 00:42:48,700
actually<font color="#CCCCCC"> ended with root there yeah</font><font color="#E5E5E5"> okay</font>

980
00:42:46,210 --> 00:42:55,299
so but<font color="#CCCCCC"> that's that just</font><font color="#E5E5E5"> to prove the</font>

981
00:42:48,700 --> 00:42:58,210
<font color="#CCCCCC">point that this can be done okay</font><font color="#E5E5E5"> so but</font>

982
00:42:55,299 --> 00:43:00,640
the<font color="#CCCCCC"> thing is</font><font color="#E5E5E5"> that and this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> not very</font>

983
00:42:58,210 --> 00:43:03,430
<font color="#CCCCCC">well</font><font color="#E5E5E5"> known the problem is that the</font><font color="#CCCCCC"> other</font>

984
00:43:00,640 --> 00:43:05,558
way<font color="#E5E5E5"> around is also true let's say</font><font color="#CCCCCC"> that</font>

985
00:43:03,430 --> 00:43:07,450
you have a server on<font color="#E5E5E5"> a DM seat exposed</font>

986
00:43:05,559 --> 00:43:10,750
to the<font color="#E5E5E5"> Internet that's pretty usual and</font>

987
00:43:07,450 --> 00:43:13,390
<font color="#E5E5E5">that server gets compromised the</font>

988
00:43:10,750 --> 00:43:15,880
attacker<font color="#E5E5E5"> can from that</font><font color="#CCCCCC"> server</font><font color="#E5E5E5"> jump to</font>

989
00:43:13,390 --> 00:43:18,730
the VM<font color="#E5E5E5"> C and then we have a problem</font>

990
00:43:15,880 --> 00:43:21,900
<font color="#CCCCCC">right because as you have already</font>

991
00:43:18,730 --> 00:43:24,069
guessed or<font color="#CCCCCC"> hear the last half an hour</font>

992
00:43:21,900 --> 00:43:26,200
<font color="#E5E5E5">device is connected</font><font color="#CCCCCC"> to these networks</font>

993
00:43:24,069 --> 00:43:29,740
<font color="#E5E5E5">are very insecure</font><font color="#CCCCCC"> they are not built</font>

994
00:43:26,200 --> 00:43:31,839
with<font color="#E5E5E5"> the same security measures that any</font>

995
00:43:29,740 --> 00:43:33,700
kind<font color="#E5E5E5"> of thing</font><font color="#CCCCCC"> that is being thought to</font>

996
00:43:31,839 --> 00:43:36,038
be connected<font color="#CCCCCC"> to</font><font color="#E5E5E5"> the Internet in fact if</font>

997
00:43:33,700 --> 00:43:37,930
you read the<font color="#CCCCCC"> documentation</font><font color="#E5E5E5"> from all of</font>

998
00:43:36,039 --> 00:43:39,549
the main vendors<font color="#E5E5E5"> they tell you that you</font>

999
00:43:37,930 --> 00:43:41,859
can connect<font color="#E5E5E5"> this device is too risky</font>

1000
00:43:39,549 --> 00:43:44,410
<font color="#E5E5E5">networks you have</font><font color="#CCCCCC"> to have them in</font>

1001
00:43:41,859 --> 00:43:46,569
control environments<font color="#E5E5E5"> but if this is true</font>

1002
00:43:44,410 --> 00:43:50,020
<font color="#E5E5E5">if we can jump from the server</font><font color="#CCCCCC"> to the</font>

1003
00:43:46,569 --> 00:43:51,788
<font color="#E5E5E5">BMC then we have a problem here</font><font color="#CCCCCC"> because</font>

1004
00:43:50,020 --> 00:43:55,270
now I can access<font color="#E5E5E5"> the out of a network</font>

1005
00:43:51,789 --> 00:43:57,670
via company so<font color="#E5E5E5"> let's think how is this</font>

1006
00:43:55,270 --> 00:44:00,880
even<font color="#CCCCCC"> possible there are a</font><font color="#E5E5E5"> couple</font><font color="#CCCCCC"> of</font>

1007
00:43:57,670 --> 00:44:02,349
things<font color="#E5E5E5"> that make this</font><font color="#CCCCCC"> possible vendors</font>

1008
00:44:00,880 --> 00:44:04,180
provide administrators with a lot of

1009
00:44:02,349 --> 00:44:07,299
<font color="#E5E5E5">tools</font><font color="#CCCCCC"> to be able</font><font color="#E5E5E5"> to administer</font><font color="#CCCCCC"> this</font>

1010
00:44:04,180 --> 00:44:09,279
<font color="#CCCCCC">VMC's and many of these</font><font color="#E5E5E5"> tools can</font><font color="#CCCCCC"> be</font>

1011
00:44:07,299 --> 00:44:12,279
<font color="#CCCCCC">used either</font><font color="#E5E5E5"> remotely from</font><font color="#CCCCCC"> the network</font>

1012
00:44:09,279 --> 00:44:14,730
VIP<font color="#E5E5E5"> for example or locally from the same</font>

1013
00:44:12,279 --> 00:44:17,140
<font color="#E5E5E5">server where the</font><font color="#CCCCCC"> BMC s attached you</font><font color="#E5E5E5"> and</font>

1014
00:44:14,730 --> 00:44:20,049
some of the things<font color="#E5E5E5"> that you can do with</font>

1015
00:44:17,140 --> 00:44:21,670
those tools is for<font color="#E5E5E5"> example create new</font>

1016
00:44:20,049 --> 00:44:25,269
users<font color="#CCCCCC"> in the</font><font color="#E5E5E5"> system</font>

1017
00:44:21,670 --> 00:44:26,950
or<font color="#CCCCCC"> flush a new few more and some</font><font color="#E5E5E5"> others</font>

1018
00:44:25,269 --> 00:44:28,779
have for example features<font color="#E5E5E5"> to enable some</font>

1019
00:44:26,950 --> 00:44:31,049
kind of<font color="#E5E5E5"> networking between the BMC and</font>

1020
00:44:28,779 --> 00:44:34,450
<font color="#E5E5E5">the server</font>

1021
00:44:31,049 --> 00:44:36,880
no no<font color="#E5E5E5"> definitely my fault because I want</font>

1022
00:44:34,450 --> 00:44:39,700
<font color="#CCCCCC">to really show how important</font><font color="#E5E5E5"> this lies</font>

1023
00:44:36,880 --> 00:44:42,970
<font color="#CCCCCC">soap</font><font color="#E5E5E5"> like nothing shows importance</font>

1024
00:44:39,700 --> 00:44:44,019
<font color="#E5E5E5">I kept dancing banana but these are all</font>

1025
00:44:42,970 --> 00:44:48,098
<font color="#CCCCCC">really important because</font><font color="#E5E5E5"> this is a game</font>

1026
00:44:44,019 --> 00:44:50,410
<font color="#CCCCCC">changer this</font><font color="#E5E5E5"> is the by design</font><font color="#CCCCCC"> benders</font>

1027
00:44:48,099 --> 00:44:52,239
decide that the server<font color="#CCCCCC"> should be able to</font>

1028
00:44:50,410 --> 00:44:53,859
do whatever they<font color="#E5E5E5"> want on a BMC so</font>

1029
00:44:52,239 --> 00:44:56,109
<font color="#E5E5E5">whenever you use these commands these</font>

1030
00:44:53,859 --> 00:44:58,989
tools from<font color="#CCCCCC"> the</font><font color="#E5E5E5"> server there's no</font>

1031
00:44:56,109 --> 00:45:02,170
authentication<font color="#CCCCCC"> and this is what</font><font color="#E5E5E5"> this is</font>

1032
00:44:58,989 --> 00:45:04,180
a trick that<font color="#E5E5E5"> the French guys did on the</font>

1033
00:45:02,170 --> 00:45:05,710
ILO that<font color="#CCCCCC"> mighty has explained</font><font color="#E5E5E5"> the reason</font>

1034
00:45:04,180 --> 00:45:09,098
why there was a plan flag that mentioned

1035
00:45:05,710 --> 00:45:12,339
<font color="#E5E5E5">local or remote was that because</font><font color="#CCCCCC"> local</font>

1036
00:45:09,099 --> 00:45:14,019
for them is<font color="#CCCCCC"> like no access so they</font>

1037
00:45:12,339 --> 00:45:15,640
<font color="#E5E5E5">assumed</font><font color="#CCCCCC"> I'd by default that it do you</font>

1038
00:45:14,019 --> 00:45:17,709
have a<font color="#E5E5E5"> minute of</font><font color="#CCCCCC"> Rights from the server</font>

1039
00:45:15,640 --> 00:45:19,989
then you<font color="#CCCCCC"> should be able</font><font color="#E5E5E5"> to have a list</font>

1040
00:45:17,710 --> 00:45:21,009
<font color="#E5E5E5">of these rights on the BMC but no one</font>

1041
00:45:19,989 --> 00:45:25,239
thought about<font color="#E5E5E5"> the security implications</font>

1042
00:45:21,009 --> 00:45:28,539
that<font color="#E5E5E5"> is this hub so let's see a quick</font>

1043
00:45:25,239 --> 00:45:34,119
<font color="#E5E5E5">demo not so quick on how this works</font>

1044
00:45:28,539 --> 00:45:38,950
five minutes quick<font color="#CCCCCC"> ok so what we will do</font>

1045
00:45:34,119 --> 00:45:40,539
is let me<font color="#E5E5E5"> go to slides we will start</font>

1046
00:45:38,950 --> 00:45:43,089
under the<font color="#E5E5E5"> assumption that we have</font>

1047
00:45:40,539 --> 00:45:45,759
already compromised<font color="#CCCCCC"> a server on the DMC</font>

1048
00:45:43,089 --> 00:45:48,220
<font color="#E5E5E5">right we have compromised</font><font color="#CCCCCC"> at</font><font color="#E5E5E5"> PHP</font><font color="#CCCCCC"> oh</font>

1049
00:45:45,759 --> 00:45:49,900
<font color="#E5E5E5">right whatever</font><font color="#CCCCCC"> we go to code execution</font>

1050
00:45:48,220 --> 00:45:52,450
there and then we were<font color="#CCCCCC"> able to</font><font color="#E5E5E5"> elevate</font>

1051
00:45:49,900 --> 00:45:55,809
privileges to<font color="#CCCCCC"> root so that is in the</font>

1052
00:45:52,450 --> 00:45:57,129
initial<font color="#E5E5E5"> position where we are</font><font color="#CCCCCC"> let's say</font>

1053
00:45:55,809 --> 00:46:00,489
that we<font color="#CCCCCC"> are the attacker</font><font color="#E5E5E5"> one of the</font>

1054
00:45:57,130 --> 00:46:03,279
<font color="#E5E5E5">third first thing that you can do is try</font>

1055
00:46:00,489 --> 00:46:05,079
to see if that<font color="#E5E5E5"> server has a BNC attached</font>

1056
00:46:03,279 --> 00:46:07,900
to it and if you<font color="#E5E5E5"> remember from the</font><font color="#CCCCCC"> first</font>

1057
00:46:05,079 --> 00:46:10,539
<font color="#CCCCCC">light that</font><font color="#E5E5E5"> that ugly diagram from my VM</font>

1058
00:46:07,900 --> 00:46:12,489
<font color="#E5E5E5">I whatever we</font><font color="#CCCCCC"> talked about</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> bmc's</font>

1059
00:46:10,539 --> 00:46:14,319
usually have connection<font color="#CCCCCC"> to the one</font><font color="#E5E5E5"> of</font>

1060
00:46:12,489 --> 00:46:18,249
the main buses via PCI or PCI Express

1061
00:46:14,319 --> 00:46:21,609
when<font color="#E5E5E5"> well here's how can you detect if</font>

1062
00:46:18,249 --> 00:46:24,009
that server<font color="#E5E5E5"> has a BMC you</font><font color="#CCCCCC"> can also use</font>

1063
00:46:21,609 --> 00:46:26,140
for example<font color="#CCCCCC"> a LS mode because you</font><font color="#E5E5E5"> won't</font>

1064
00:46:24,009 --> 00:46:27,640
will detect the<font color="#CCCCCC"> despised and that they</font>

1065
00:46:26,140 --> 00:46:29,319
support the ugly by default<font color="#E5E5E5"> you don't</font>

1066
00:46:27,640 --> 00:46:31,480
need to install<font color="#E5E5E5"> anything</font><font color="#CCCCCC"> and you will</font>

1067
00:46:29,319 --> 00:46:34,569
see the<font color="#E5E5E5"> current modules for to be</font><font color="#CCCCCC"> able</font>

1068
00:46:31,480 --> 00:46:35,450
<font color="#E5E5E5">to use is to interact be</font><font color="#CCCCCC"> IPMI through</font>

1069
00:46:34,569 --> 00:46:39,380
the<font color="#CCCCCC"> PCI</font>

1070
00:46:35,450 --> 00:46:41,868
or PCI Express<font color="#CCCCCC"> port</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> Dana suhaka</font><font color="#E5E5E5"> what</font>

1071
00:46:39,380 --> 00:46:45,109
you can do is use these tools that<font color="#E5E5E5"> the</font>

1072
00:46:41,869 --> 00:46:48,260
<font color="#CCCCCC">bender gives us gives you to interact</font>

1073
00:46:45,109 --> 00:46:49,940
with the BMC one of the things that you

1074
00:46:48,260 --> 00:46:52,640
can do<font color="#CCCCCC"> just to show you that it works</font><font color="#E5E5E5"> is</font>

1075
00:46:49,940 --> 00:46:55,430
use this tool<font color="#E5E5E5"> to play the users on the</font>

1076
00:46:52,640 --> 00:46:57,950
BMC<font color="#E5E5E5"> and you consider</font><font color="#CCCCCC"> it's even giving</font><font color="#E5E5E5"> us</font>

1077
00:46:55,430 --> 00:47:00,680
the only hashes for the this user

1078
00:46:57,950 --> 00:47:02,058
password<font color="#E5E5E5"> in the same way we do this we</font>

1079
00:47:00,680 --> 00:47:04,009
could<font color="#E5E5E5"> have</font><font color="#CCCCCC"> created a new</font><font color="#E5E5E5"> user on the</font>

1080
00:47:02,059 --> 00:47:05,660
system and check that the in the common

1081
00:47:04,010 --> 00:47:07,309
line there's no<font color="#E5E5E5"> password no kind of</font><font color="#CCCCCC"> an</font>

1082
00:47:05,660 --> 00:47:08,960
authentication you are just using<font color="#E5E5E5"> the</font>

1083
00:47:07,309 --> 00:47:15,440
tool<font color="#CCCCCC"> the</font><font color="#E5E5E5"> only thing that you need</font><font color="#CCCCCC"> is</font>

1084
00:47:08,960 --> 00:47:19,130
access yep so the next thing that we<font color="#CCCCCC"> are</font>

1085
00:47:15,440 --> 00:47:21,619
going<font color="#CCCCCC"> to do here is use a feature</font><font color="#E5E5E5"> from</font>

1086
00:47:19,130 --> 00:47:23,599
the<font color="#CCCCCC"> I drug but it's called shared</font>

1087
00:47:21,619 --> 00:47:26,180
network or<font color="#E5E5E5"> something that</font><font color="#CCCCCC"> are big see</font>

1088
00:47:23,599 --> 00:47:29,210
basically<font color="#E5E5E5"> what it does is uses USB</font>

1089
00:47:26,180 --> 00:47:31,640
emulation to set up an<font color="#E5E5E5"> int an Ethernet</font>

1090
00:47:29,210 --> 00:47:34,430
card<font color="#E5E5E5"> emulated on the server so you will</font>

1091
00:47:31,640 --> 00:47:36,859
have IP communication between the server

1092
00:47:34,430 --> 00:47:42,319
and<font color="#CCCCCC"> ABMC we will just</font><font color="#E5E5E5"> keep this part of</font>

1093
00:47:36,859 --> 00:47:48,890
the demo quite fast yeah so basically

1094
00:47:42,319 --> 00:47:51,410
<font color="#CCCCCC">what I did there was using this feature</font>

1095
00:47:48,890 --> 00:47:53,598
using this tool called<font color="#CCCCCC"> rockin</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> Dell</font>

1096
00:47:51,410 --> 00:47:55,009
gives us<font color="#CCCCCC"> that tool there's nothing there</font>

1097
00:47:53,599 --> 00:47:58,130
<font color="#CCCCCC">very fancy</font>

1098
00:47:55,010 --> 00:48:00,200
and what we know was a network

1099
00:47:58,130 --> 00:48:02,299
connectivity between<font color="#CCCCCC"> ABMC under server</font>

1100
00:48:00,200 --> 00:48:03,980
<font color="#E5E5E5">so once we have network</font><font color="#CCCCCC"> connectivity we</font>

1101
00:48:02,299 --> 00:48:06,140
can<font color="#CCCCCC"> actually reuse</font><font color="#E5E5E5"> the same exploit</font><font color="#CCCCCC"> that</font>

1102
00:48:03,980 --> 00:48:08,750
we talked<font color="#CCCCCC"> about before the one day trip</font>

1103
00:48:06,140 --> 00:48:10,730
of the algebra load and what we did<font color="#E5E5E5"> here</font>

1104
00:48:08,750 --> 00:48:12,980
in the<font color="#E5E5E5"> video</font><font color="#CCCCCC"> that we just</font><font color="#E5E5E5"> skipped was</font>

1105
00:48:10,730 --> 00:48:16,490
user typed<font color="#CCCCCC"> code in order to gain a shell</font>

1106
00:48:12,980 --> 00:48:20,059
on that device<font color="#E5E5E5"> so right now what we</font><font color="#CCCCCC"> are</font>

1107
00:48:16,490 --> 00:48:22,609
is here<font color="#E5E5E5"> right we have we have from this</font>

1108
00:48:20,059 --> 00:48:24,799
server we have compromised<font color="#CCCCCC"> ABMC we were</font>

1109
00:48:22,609 --> 00:48:26,540
able<font color="#E5E5E5"> to jump there and at this point you</font>

1110
00:48:24,799 --> 00:48:28,730
might be<font color="#E5E5E5"> thinking</font><font color="#CCCCCC"> well I</font><font color="#E5E5E5"> don't care too</font>

1111
00:48:26,540 --> 00:48:31,700
<font color="#CCCCCC">much because</font><font color="#E5E5E5"> my company has everything</font>

1112
00:48:28,730 --> 00:48:33,440
patched so everything is up-to-date<font color="#E5E5E5"> but</font>

1113
00:48:31,700 --> 00:48:36,230
even if you have everything<font color="#CCCCCC"> up-to-date</font>

1114
00:48:33,440 --> 00:48:39,260
this affect you<font color="#E5E5E5"> because using the same</font>

1115
00:48:36,230 --> 00:48:41,720
tool you can<font color="#E5E5E5"> downgrade the</font><font color="#CCCCCC"> idrac to a</font>

1116
00:48:39,260 --> 00:48:43,339
boon L<font color="#E5E5E5"> version and once</font><font color="#CCCCCC"> you tank ready</font>

1117
00:48:41,720 --> 00:48:45,759
<font color="#CCCCCC">then you can use this at the exact same</font>

1118
00:48:43,339 --> 00:48:45,759
exploit

1119
00:48:47,400 --> 00:48:53,920
so what we did<font color="#E5E5E5"> next was we didn't wanted</font>

1120
00:48:51,430 --> 00:48:56,879
<font color="#E5E5E5">to stop there</font><font color="#CCCCCC"> so we had in our lab</font>

1121
00:48:53,920 --> 00:49:01,000
another server on an<font color="#CCCCCC"> isolated Network</font>

1122
00:48:56,880 --> 00:49:02,770
<font color="#CCCCCC">yeah he was an HP in this case and that</font>

1123
00:49:01,000 --> 00:49:04,900
server<font color="#CCCCCC"> the only thing that shared with</font>

1124
00:49:02,770 --> 00:49:07,390
this other Dell server<font color="#E5E5E5"> what they were</font>

1125
00:49:04,900 --> 00:49:10,869
both connected to the same management

1126
00:49:07,390 --> 00:49:14,049
<font color="#E5E5E5">network so what we did was</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> use we did</font>

1127
00:49:10,869 --> 00:49:15,910
an SSH tunnel<font color="#E5E5E5"> on the on the</font><font color="#CCCCCC"> I'd lock in</font>

1128
00:49:14,050 --> 00:49:19,030
<font color="#E5E5E5">order to be able to reach the other they</font>

1129
00:49:15,910 --> 00:49:22,058
are managed BMC<font color="#E5E5E5"> in this case was an I</font>

1130
00:49:19,030 --> 00:49:24,730
know so in the end what we<font color="#E5E5E5"> were able</font><font color="#CCCCCC"> to</font>

1131
00:49:22,059 --> 00:49:27,970
<font color="#E5E5E5">do was from the internet doing a series</font>

1132
00:49:24,730 --> 00:49:30,700
of SSH tunnels and using being having

1133
00:49:27,970 --> 00:49:33,040
compromised this I love this<font color="#CCCCCC"> I'd</font><font color="#E5E5E5"> work</font>

1134
00:49:30,700 --> 00:49:35,500
sorry<font color="#E5E5E5"> we were able</font><font color="#CCCCCC"> to reach this BMC</font>

1135
00:49:33,040 --> 00:49:38,619
that was in<font color="#E5E5E5"> a management</font><font color="#CCCCCC"> network</font><font color="#E5E5E5"> totally</font>

1136
00:49:35,500 --> 00:49:41,079
unreachable<font color="#E5E5E5"> otherwise all right sorry</font>

1137
00:49:38,619 --> 00:49:42,819
only<font color="#CCCCCC"> one minutes and we're almost done I</font>

1138
00:49:41,079 --> 00:49:44,410
want to say one a couple<font color="#CCCCCC"> things one</font><font color="#E5E5E5"> of</font>

1139
00:49:42,819 --> 00:49:46,960
them is persistence we were able<font color="#CCCCCC"> to</font>

1140
00:49:44,410 --> 00:49:48,848
persist this super easy<font color="#E5E5E5"> there was there</font>

1141
00:49:46,960 --> 00:49:53,140
was many ways we can<font color="#CCCCCC"> do that</font><font color="#E5E5E5"> one of them</font>

1142
00:49:48,849 --> 00:49:55,210
was to try<font color="#E5E5E5"> to mess with a</font><font color="#CCCCCC"> firmware but</font>

1143
00:49:53,140 --> 00:49:56,950
they<font color="#E5E5E5"> decide</font><font color="#CCCCCC"> to do</font><font color="#E5E5E5"> easy way</font><font color="#CCCCCC"> so we only</font>

1144
00:49:55,210 --> 00:49:59,410
have access<font color="#CCCCCC"> as Matthias show a shell on</font>

1145
00:49:56,950 --> 00:50:00,879
<font color="#CCCCCC">the idrac we figure out like what what</font>

1146
00:49:59,410 --> 00:50:03,368
things are mounted and<font color="#E5E5E5"> we</font><font color="#CCCCCC"> figure out</font>

1147
00:50:00,880 --> 00:50:06,010
<font color="#CCCCCC">that</font><font color="#E5E5E5"> the flash was mounted readable and</font>

1148
00:50:03,369 --> 00:50:07,540
<font color="#CCCCCC">writeable so and we start looking at</font>

1149
00:50:06,010 --> 00:50:09,819
<font color="#E5E5E5">well around the flash there was a cron</font>

1150
00:50:07,540 --> 00:50:12,339
folder so basically we just<font color="#E5E5E5"> create a</font>

1151
00:50:09,819 --> 00:50:14,380
<font color="#CCCCCC">Chrome file there and you were like</font>

1152
00:50:12,339 --> 00:50:16,509
every time like you say<font color="#E5E5E5"> that the cron</font>

1153
00:50:14,380 --> 00:50:18,369
can connect back to<font color="#E5E5E5"> you or upload a</font>

1154
00:50:16,510 --> 00:50:21,640
binary the interesting thing about that

1155
00:50:18,369 --> 00:50:26,230
<font color="#E5E5E5">is</font><font color="#CCCCCC"> that it allows you like no</font><font color="#E5E5E5"> matter if</font>

1156
00:50:21,640 --> 00:50:27,609
you flash<font color="#E5E5E5"> the machine the</font><font color="#CCCCCC"> the itraq</font><font color="#E5E5E5"> the</font>

1157
00:50:26,230 --> 00:50:29,170
cron will continue like<font color="#E5E5E5"> that because</font>

1158
00:50:27,609 --> 00:50:31,390
they<font color="#E5E5E5"> don't play in the flash</font><font color="#CCCCCC"> yeah</font><font color="#E5E5E5"> it</font>

1159
00:50:29,170 --> 00:50:33,970
survives<font color="#CCCCCC"> few more updates</font><font color="#E5E5E5"> basically so</font>

1160
00:50:31,390 --> 00:50:35,650
no matter<font color="#E5E5E5"> how</font><font color="#CCCCCC"> you fix it your</font><font color="#E5E5E5"> back that</font>

1161
00:50:33,970 --> 00:50:37,598
will be there so like it's<font color="#E5E5E5"> not it's only</font>

1162
00:50:35,650 --> 00:50:39,280
<font color="#E5E5E5">interesting from the point we're not</font>

1163
00:50:37,599 --> 00:50:41,589
<font color="#CCCCCC">gonna show the video there demo and</font><font color="#E5E5E5"> no</font>

1164
00:50:39,280 --> 00:50:44,920
to<font color="#E5E5E5"> do either so the point of this is</font>

1165
00:50:41,589 --> 00:50:46,990
<font color="#CCCCCC">that it's</font><font color="#E5E5E5"> a it's not</font><font color="#CCCCCC"> just like an attack</font>

1166
00:50:44,920 --> 00:50:49,690
remotely internally you<font color="#E5E5E5"> can move</font>

1167
00:50:46,990 --> 00:50:52,750
<font color="#E5E5E5">direction between the BMC and the on the</font>

1168
00:50:49,690 --> 00:50:55,059
server<font color="#E5E5E5"> but also you can just use</font><font color="#CCCCCC"> it as a</font>

1169
00:50:52,750 --> 00:50:56,500
great backdoor or a run somewhere like

1170
00:50:55,059 --> 00:50:58,809
the<font color="#E5E5E5"> possibilities</font><font color="#CCCCCC"> to do it as a run</font>

1171
00:50:56,500 --> 00:51:00,970
somewhere<font color="#E5E5E5"> compromise the iraq and creep</font>

1172
00:50:58,809 --> 00:51:01,240
the<font color="#E5E5E5"> disk and you just keep</font><font color="#CCCCCC"> there just</font>

1173
00:51:00,970 --> 00:51:03,129
change

1174
00:51:01,240 --> 00:51:05,799
the website and<font color="#CCCCCC"> like no matter</font><font color="#E5E5E5"> how</font><font color="#CCCCCC"> much</font>

1175
00:51:03,130 --> 00:51:08,440
<font color="#CCCCCC">you flash up in world you will not be</font>

1176
00:51:05,800 --> 00:51:10,000
<font color="#E5E5E5">able to get us out of</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> because</font><font color="#CCCCCC"> you</font>

1177
00:51:08,440 --> 00:51:12,310
don't<font color="#CCCCCC"> have access you have</font><font color="#E5E5E5"> shell access</font>

1178
00:51:10,000 --> 00:51:16,150
to<font color="#E5E5E5"> that not even like there have access</font>

1179
00:51:12,310 --> 00:51:19,770
to that anyways<font color="#E5E5E5"> that was</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> conclusion</font>

1180
00:51:16,150 --> 00:51:23,790
in like<font color="#E5E5E5"> zero seconds</font>

1181
00:51:19,770 --> 00:51:26,380
black<font color="#CCCCCC"> I probably hate us by now so</font>

1182
00:51:23,790 --> 00:51:27,460
there's no time<font color="#E5E5E5"> for questions</font><font color="#CCCCCC"> we know we</font>

1183
00:51:26,380 --> 00:51:29,050
<font color="#CCCCCC">will not I</font><font color="#E5E5E5"> mean no time for questions</font>

1184
00:51:27,460 --> 00:51:30,940
<font color="#CCCCCC">but it</font><font color="#E5E5E5"> might</font><font color="#CCCCCC"> be there in the other</font><font color="#E5E5E5"> room</font>

1185
00:51:29,050 --> 00:51:34,119
<font color="#CCCCCC">there's a room somewhere that</font><font color="#E5E5E5"> will be</font>

1186
00:51:30,940 --> 00:51:36,640
<font color="#E5E5E5">around if</font><font color="#CCCCCC"> you have</font><font color="#E5E5E5"> any questions and bad</font>

1187
00:51:34,119 --> 00:51:38,770
we just<font color="#E5E5E5"> want to thanks this was an</font>

1188
00:51:36,640 --> 00:51:40,810
effort<font color="#CCCCCC"> not just</font><font color="#E5E5E5"> by</font><font color="#CCCCCC"> us but by the team</font>

1189
00:51:38,770 --> 00:51:42,850
like<font color="#CCCCCC"> we were working together with</font>

1190
00:51:40,810 --> 00:51:44,920
multiple targets at<font color="#CCCCCC"> the same time so it</font>

1191
00:51:42,850 --> 00:51:48,480
was not<font color="#E5E5E5"> just</font><font color="#CCCCCC"> the two of us anyways</font>

1192
00:51:44,920 --> 00:51:51,050
<font color="#CCCCCC">thanks a lot for attending thank you</font>

1193
00:51:48,480 --> 00:51:51,050
[Applause]

