1
00:00:00,030 --> 00:00:05,879
so it seems rather<font color="#E5E5E5"> fitting to be talking</font>

2
00:00:02,490 --> 00:00:08,730
about<font color="#E5E5E5"> money in a city which is obsessed</font>

3
00:00:05,879 --> 00:00:11,309
with<font color="#E5E5E5"> it really and I think all of us are</font>

4
00:00:08,730 --> 00:00:13,410
<font color="#CCCCCC">someway obsessed about money but we're</font>

5
00:00:11,309 --> 00:00:15,239
more specifically interested in payment

6
00:00:13,410 --> 00:00:17,310
technologies which<font color="#E5E5E5"> is why we're here</font>

7
00:00:15,240 --> 00:00:22,948
talking<font color="#E5E5E5"> to you today</font><font color="#CCCCCC"> about mobile</font>

8
00:00:17,310 --> 00:00:25,019
<font color="#E5E5E5">point-of-sale terminals so mobile</font>

9
00:00:22,949 --> 00:00:27,150
<font color="#CCCCCC">point-of-sale terminals has seen a</font><font color="#E5E5E5"> huge</font>

10
00:00:25,019 --> 00:00:29,339
growth<font color="#E5E5E5"> over the last few</font><font color="#CCCCCC"> years we've</font>

11
00:00:27,150 --> 00:00:33,989
moved from a single vendor<font color="#E5E5E5"> dominating</font>

12
00:00:29,340 --> 00:00:36,120
<font color="#E5E5E5">the marketplace to multiple</font><font color="#CCCCCC"> vendors</font><font color="#E5E5E5"> you</font>

13
00:00:33,989 --> 00:00:37,349
<font color="#CCCCCC">can now get hold of a Capon accounts in</font>

14
00:00:36,120 --> 00:00:40,140
less than five minutes

15
00:00:37,350 --> 00:00:43,890
and readers typically cost less than<font color="#CCCCCC"> 50</font>

16
00:00:40,140 --> 00:00:45,239
<font color="#E5E5E5">dollars</font><font color="#CCCCCC"> to purchase it's for</font><font color="#E5E5E5"> these</font>

17
00:00:43,890 --> 00:00:48,270
<font color="#CCCCCC">reasons that we've seen in</font><font color="#E5E5E5"> their</font>

18
00:00:45,239 --> 00:00:50,280
exponential growth in this area<font color="#CCCCCC"> you can</font>

19
00:00:48,270 --> 00:00:53,699
<font color="#E5E5E5">find these</font><font color="#CCCCCC"> devices everywhere</font>

20
00:00:50,280 --> 00:00:57,180
so in taxis cafes and I've even<font color="#E5E5E5"> found</font>

21
00:00:53,699 --> 00:00:58,920
them in<font color="#CCCCCC"> my local</font><font color="#E5E5E5"> gym for this reason and</font>

22
00:00:57,180 --> 00:01:01,260
<font color="#CCCCCC">because they sit at the endpoint of</font>

23
00:00:58,920 --> 00:01:03,600
payment infrastructure<font color="#E5E5E5"> they're also very</font>

24
00:01:01,260 --> 00:01:05,670
attractive<font color="#CCCCCC"> to</font><font color="#E5E5E5"> criminals</font><font color="#CCCCCC"> both for the</font>

25
00:01:03,600 --> 00:01:08,909
testing<font color="#E5E5E5"> of cards and for the movement of</font>

26
00:01:05,670 --> 00:01:10,110
money but we weren't<font color="#E5E5E5"> the first</font><font color="#CCCCCC"> to</font>

27
00:01:08,909 --> 00:01:14,850
investigate mobile point-of-sale

28
00:01:10,110 --> 00:01:16,710
terminals<font color="#E5E5E5"> in 2014 MWR labs presented</font>

29
00:01:14,850 --> 00:01:19,169
their<font color="#CCCCCC"> findings on the</font><font color="#E5E5E5"> Miura shuttle</font>

30
00:01:16,710 --> 00:01:21,240
reader<font color="#E5E5E5"> which</font><font color="#CCCCCC"> ever time was</font><font color="#E5E5E5"> effectively</font>

31
00:01:19,170 --> 00:01:23,880
being white labeled by a number<font color="#E5E5E5"> of</font>

32
00:01:21,240 --> 00:01:27,030
<font color="#E5E5E5">vendors this kind of practice is still</font>

33
00:01:23,880 --> 00:01:28,500
commonplace<font color="#E5E5E5"> today in their presentation</font>

34
00:01:27,030 --> 00:01:31,110
they detailed a number of

35
00:01:28,500 --> 00:01:32,280
vulnerabilities<font color="#CCCCCC"> of which there is a lot</font>

36
00:01:31,110 --> 00:01:36,630
of<font color="#CCCCCC"> overlap with</font><font color="#E5E5E5"> traditional</font>

37
00:01:32,280 --> 00:01:39,000
point-of-sales terminals then in<font color="#E5E5E5"> 2015</font>

38
00:01:36,630 --> 00:01:41,220
<font color="#E5E5E5">three undergraduate students from the</font>

39
00:01:39,000 --> 00:01:42,990
University of<font color="#E5E5E5"> Boston presented their</font>

40
00:01:41,220 --> 00:01:45,750
findings<font color="#CCCCCC"> on the mag stripe reader by</font>

41
00:01:42,990 --> 00:01:47,399
<font color="#CCCCCC">square we felt that both</font><font color="#E5E5E5"> of these</font>

42
00:01:45,750 --> 00:01:49,649
projects were really significant

43
00:01:47,399 --> 00:01:51,299
contributions<font color="#E5E5E5"> in this area but they</font>

44
00:01:49,649 --> 00:01:53,220
don't really<font color="#E5E5E5"> deal</font><font color="#CCCCCC"> with the broader</font><font color="#E5E5E5"> more</font>

45
00:01:51,299 --> 00:01:56,310
<font color="#CCCCCC">contemporary issues associated</font><font color="#E5E5E5"> with this</font>

46
00:01:53,220 --> 00:01:58,229
<font color="#E5E5E5">marketplace</font><font color="#CCCCCC"> the sophistication of these</font>

47
00:01:56,310 --> 00:02:00,450
<font color="#E5E5E5">readers has increased incredibly over</font>

48
00:01:58,229 --> 00:02:05,009
the last few<font color="#CCCCCC"> years</font><font color="#E5E5E5"> as has the number of</font>

49
00:02:00,450 --> 00:02:07,680
<font color="#E5E5E5">vendors at the bidding unit beginning of</font>

50
00:02:05,009 --> 00:02:11,280
<font color="#E5E5E5">this project we started</font><font color="#CCCCCC"> with just two</font>

51
00:02:07,680 --> 00:02:13,440
terminals and two vendors<font color="#E5E5E5"> this quickly</font>

52
00:02:11,280 --> 00:02:17,340
grew into<font color="#CCCCCC"> a large project</font><font color="#E5E5E5"> income</font>

53
00:02:13,440 --> 00:02:20,940
<font color="#E5E5E5">seven card readers for vendors in</font><font color="#CCCCCC"> two</font>

54
00:02:17,340 --> 00:02:22,890
different<font color="#CCCCCC"> regions we chose to</font><font color="#E5E5E5"> carry out</font>

55
00:02:20,940 --> 00:02:27,359
a broad<font color="#E5E5E5"> assessment of the most popular</font>

56
00:02:22,890 --> 00:02:31,410
devices<font color="#CCCCCC"> in both Europe and</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> US we</font>

57
00:02:27,360 --> 00:02:35,880
<font color="#E5E5E5">chose to focus on PayPal</font><font color="#CCCCCC"> Square eyes at</font>

58
00:02:31,410 --> 00:02:38,730
all<font color="#CCCCCC"> and sum up some</font><font color="#E5E5E5"> of these vendors</font>

59
00:02:35,880 --> 00:02:40,680
exist in both geographic locations<font color="#E5E5E5"> so</font>

60
00:02:38,730 --> 00:02:43,350
where this was the<font color="#CCCCCC"> case we chose where</font>

61
00:02:40,680 --> 00:02:46,320
possible to obtain accounts and readers

62
00:02:43,350 --> 00:02:47,340
in both geographic locations<font color="#CCCCCC"> this</font><font color="#E5E5E5"> is</font>

63
00:02:46,320 --> 00:02:49,549
because there<font color="#CCCCCC"> are some fundamental</font>

64
00:02:47,340 --> 00:02:52,290
differences<font color="#CCCCCC"> between the processes</font>

65
00:02:49,550 --> 00:02:55,200
applications<font color="#E5E5E5"> and the readers depending</font>

66
00:02:52,290 --> 00:02:57,060
on the<font color="#CCCCCC"> region we had a basic</font>

67
00:02:55,200 --> 00:02:59,940
<font color="#CCCCCC">understanding</font><font color="#E5E5E5"> of the attack vectors that</font>

68
00:02:57,060 --> 00:03:01,830
these readers were affected by but we

69
00:02:59,940 --> 00:03:06,270
wanted<font color="#E5E5E5"> to see how practical these</font>

70
00:03:01,830 --> 00:03:09,030
attacks were in<font color="#E5E5E5"> practice still our key</font>

71
00:03:06,270 --> 00:03:11,070
question remained<font color="#CCCCCC"> how much security</font><font color="#E5E5E5"> can</font>

72
00:03:09,030 --> 00:03:15,060
really be embedded in a device that's

73
00:03:11,070 --> 00:03:19,019
available<font color="#E5E5E5"> for free we chose to assess</font>

74
00:03:15,060 --> 00:03:20,850
five areas<font color="#E5E5E5"> of the payment ecosystem the</font>

75
00:03:19,020 --> 00:03:24,270
first being between the phone<font color="#CCCCCC"> and the</font>

76
00:03:20,850 --> 00:03:28,200
payment server next between the terminal

77
00:03:24,270 --> 00:03:31,770
<font color="#E5E5E5">and the phone the mobile application and</font>

78
00:03:28,200 --> 00:03:33,690
<font color="#E5E5E5">the Associated mobile ecosystem the</font>

79
00:03:31,770 --> 00:03:35,430
physical<font color="#E5E5E5"> security mechanisms within the</font>

80
00:03:33,690 --> 00:03:38,220
<font color="#E5E5E5">hardware of</font><font color="#CCCCCC"> the card readers readers</font>

81
00:03:35,430 --> 00:03:40,140
themselves<font color="#CCCCCC"> and then secondary factors</font>

82
00:03:38,220 --> 00:03:42,810
which affect the<font color="#CCCCCC"> overall risk and</font>

83
00:03:40,140 --> 00:03:44,160
<font color="#E5E5E5">security of the payment ecosystem for</font>

84
00:03:42,810 --> 00:03:45,239
example the kind<font color="#E5E5E5"> of checks that are</font>

85
00:03:44,160 --> 00:03:49,290
<font color="#E5E5E5">carried out during the enrollment</font>

86
00:03:45,239 --> 00:03:50,760
<font color="#E5E5E5">process but before we progress any</font>

87
00:03:49,290 --> 00:03:53,310
<font color="#CCCCCC">further I'll just give you a bit of</font>

88
00:03:50,760 --> 00:03:54,840
background<font color="#CCCCCC"> information on how payments</font>

89
00:03:53,310 --> 00:03:57,270
<font color="#E5E5E5">typically work with</font><font color="#CCCCCC"> a traditional</font>

90
00:03:54,840 --> 00:03:58,920
<font color="#CCCCCC">point-of-sales terminal and how mobile</font>

91
00:03:57,270 --> 00:04:01,680
<font color="#E5E5E5">point-of-sale terminals fit into this</font>

92
00:03:58,920 --> 00:04:03,809
process<font color="#E5E5E5"> so normally when we go into a</font>

93
00:04:01,680 --> 00:04:05,459
<font color="#CCCCCC">business we pay</font><font color="#E5E5E5"> for some goods will</font>

94
00:04:03,810 --> 00:04:09,360
either<font color="#E5E5E5"> interact with the terminal</font>

95
00:04:05,459 --> 00:04:12,840
<font color="#CCCCCC">directly or we'll hand our card over to</font>

96
00:04:09,360 --> 00:04:15,150
the merchant once our card<font color="#CCCCCC"> information</font>

97
00:04:12,840 --> 00:04:17,880
has been<font color="#E5E5E5"> read this will be passed to the</font>

98
00:04:15,150 --> 00:04:19,320
<font color="#E5E5E5">acquiring</font><font color="#CCCCCC"> bank for the</font><font color="#E5E5E5"> merchant at this</font>

99
00:04:17,880 --> 00:04:21,630
point they don't actually know who our

100
00:04:19,320 --> 00:04:23,490
<font color="#E5E5E5">issuing</font><font color="#CCCCCC"> Bank is so they'll</font><font color="#E5E5E5"> ask the card</font>

101
00:04:21,630 --> 00:04:25,590
brands<font color="#E5E5E5"> such</font><font color="#CCCCCC"> as Visa MasterCard to</font>

102
00:04:23,490 --> 00:04:27,330
<font color="#E5E5E5">determine this information</font>

103
00:04:25,590 --> 00:04:28,979
once this has<font color="#CCCCCC"> been passed you're issuing</font>

104
00:04:27,330 --> 00:04:30,659
<font color="#CCCCCC">Bank the check that</font><font color="#E5E5E5"> you have</font><font color="#CCCCCC"> the</font>

105
00:04:28,980 --> 00:04:32,639
<font color="#CCCCCC">necessary funds</font><font color="#E5E5E5"> to complete the</font>

106
00:04:30,660 --> 00:04:34,650
transaction<font color="#CCCCCC"> and carry out some flawed</font>

107
00:04:32,639 --> 00:04:36,600
checks<font color="#CCCCCC"> if they're happy for you to go</font>

108
00:04:34,650 --> 00:04:38,940
<font color="#CCCCCC">ahead</font><font color="#E5E5E5"> they'll send the response back</font>

109
00:04:36,600 --> 00:04:42,480
along the chain and<font color="#E5E5E5"> you</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> complete the</font>

110
00:04:38,940 --> 00:04:43,830
<font color="#CCCCCC">payment if we take</font><font color="#E5E5E5"> a look at what this</font>

111
00:04:42,480 --> 00:04:46,260
looks<font color="#CCCCCC"> like for</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> mobile point-of-sale</font>

112
00:04:43,830 --> 00:04:48,180
terminal provider<font color="#E5E5E5"> we can see that the</font>

113
00:04:46,260 --> 00:04:50,639
key difference is that<font color="#CCCCCC"> merchant no</font>

114
00:04:48,180 --> 00:04:54,270
longer has a direct relationship<font color="#E5E5E5"> with</font>

115
00:04:50,639 --> 00:04:56,310
<font color="#E5E5E5">the acquirer instead the mobile</font><font color="#CCCCCC"> point of</font>

116
00:04:54,270 --> 00:04:59,310
<font color="#CCCCCC">sales terminal provider acts as a</font>

117
00:04:56,310 --> 00:05:01,919
payment aggregator<font color="#E5E5E5"> this means that they</font>

118
00:04:59,310 --> 00:05:04,200
<font color="#E5E5E5">will or won't assess risk</font><font color="#CCCCCC"> at the same</font>

119
00:05:01,919 --> 00:05:06,780
level as a traditional acquiring<font color="#CCCCCC"> bank</font>

120
00:05:04,200 --> 00:05:08,400
<font color="#CCCCCC">and they may</font><font color="#E5E5E5"> also choose</font><font color="#CCCCCC"> to mitigate</font>

121
00:05:06,780 --> 00:05:15,299
some<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the risk in other ways</font><font color="#CCCCCC"> for</font>

122
00:05:08,400 --> 00:05:17,849
example contractually when you go to

123
00:05:15,300 --> 00:05:19,590
make a transaction<font color="#E5E5E5"> there is a list</font><font color="#CCCCCC"> that</font>

124
00:05:17,850 --> 00:05:22,050
broadly describes the types<font color="#E5E5E5"> of</font>

125
00:05:19,590 --> 00:05:26,310
<font color="#E5E5E5">operations from highest priority low to</font>

126
00:05:22,050 --> 00:05:29,010
lowest priority this list differs

127
00:05:26,310 --> 00:05:32,280
depending on<font color="#CCCCCC"> the issuer the card brand</font>

128
00:05:29,010 --> 00:05:35,640
<font color="#E5E5E5">and potentially the geographic region as</font>

129
00:05:32,280 --> 00:05:37,349
well but generally generally<font color="#E5E5E5"> speaking we</font>

130
00:05:35,640 --> 00:05:39,330
<font color="#CCCCCC">can understand that</font><font color="#E5E5E5"> certain payment</font>

131
00:05:37,350 --> 00:05:42,539
types are more<font color="#E5E5E5"> risky</font><font color="#CCCCCC"> than others</font><font color="#E5E5E5"> for</font>

132
00:05:39,330 --> 00:05:44,280
<font color="#CCCCCC">example chip-and-pin</font><font color="#E5E5E5"> is considered most</font>

133
00:05:42,539 --> 00:05:45,810
secure<font color="#E5E5E5"> this is because there's a high</font>

134
00:05:44,280 --> 00:05:47,840
level<font color="#E5E5E5"> of assurance that the cardholder</font>

135
00:05:45,810 --> 00:05:50,130
<font color="#E5E5E5">was present during the transaction</font>

136
00:05:47,840 --> 00:05:51,690
<font color="#E5E5E5">whereas something such as magstripe</font>

137
00:05:50,130 --> 00:05:54,060
is considered low in its<font color="#E5E5E5"> level of</font>

138
00:05:51,690 --> 00:05:55,889
security<font color="#CCCCCC"> this is because the magnetic</font>

139
00:05:54,060 --> 00:05:58,320
<font color="#E5E5E5">stripe on the back of the card can be</font>

140
00:05:55,889 --> 00:06:00,090
<font color="#CCCCCC">cloned</font><font color="#E5E5E5"> a signature can obviously be</font>

141
00:05:58,320 --> 00:06:01,830
forged without much effort<font color="#CCCCCC"> and there's</font>

142
00:06:00,090 --> 00:06:05,179
no signing of the transaction there's no

143
00:06:01,830 --> 00:06:07,849
<font color="#E5E5E5">cryptogram like modern transactions</font>

144
00:06:05,180 --> 00:06:09,479
next we<font color="#E5E5E5"> need to understand that</font><font color="#CCCCCC"> well</font>

145
00:06:07,850 --> 00:06:12,240
generally speaking

146
00:06:09,479 --> 00:06:14,700
EMV has been adopted<font color="#CCCCCC"> very successfully</font>

147
00:06:12,240 --> 00:06:17,550
on a global<font color="#E5E5E5"> scale it's taken a bit</font>

148
00:06:14,700 --> 00:06:20,010
<font color="#CCCCCC">longer</font><font color="#E5E5E5"> in some places than</font><font color="#CCCCCC"> others so in</font>

149
00:06:17,550 --> 00:06:22,550
the<font color="#E5E5E5"> u.s. EMV adoption has taken a little</font>

150
00:06:20,010 --> 00:06:24,960
<font color="#CCCCCC">bit longer than places like Europe</font>

151
00:06:22,550 --> 00:06:26,700
what's interesting about this fact<font color="#E5E5E5"> is</font>

152
00:06:24,960 --> 00:06:28,680
<font color="#E5E5E5">that we can look to places like</font><font color="#CCCCCC"> Europe</font>

153
00:06:26,700 --> 00:06:30,419
and look at the kind of attack vectors

154
00:06:28,680 --> 00:06:32,430
that<font color="#E5E5E5"> are being utilized by criminals</font>

155
00:06:30,419 --> 00:06:37,440
there and use them as a good predictor

156
00:06:32,430 --> 00:06:39,480
about what may happen in<font color="#E5E5E5"> the US as you</font>

157
00:06:37,440 --> 00:06:43,800
can see<font color="#E5E5E5"> credit card adoption of</font>

158
00:06:39,480 --> 00:06:46,380
is actually<font color="#E5E5E5"> incredibly high at 96%</font><font color="#CCCCCC"> but</font>

159
00:06:43,800 --> 00:06:48,840
we but when we look at<font color="#E5E5E5"> how often</font><font color="#CCCCCC"> a chip</font>

160
00:06:46,380 --> 00:06:51,210
is used during a transaction<font color="#CCCCCC"> it's</font>

161
00:06:48,840 --> 00:06:55,859
actually less<font color="#CCCCCC"> than</font><font color="#E5E5E5"> 50% of transactions</font>

162
00:06:51,210 --> 00:06:57,989
in the<font color="#CCCCCC"> US</font><font color="#E5E5E5"> this picture is</font><font color="#CCCCCC"> even worse</font>

163
00:06:55,860 --> 00:07:00,570
when<font color="#CCCCCC"> we come to</font><font color="#E5E5E5"> talk about debit cards</font>

164
00:06:57,990 --> 00:07:06,060
<font color="#E5E5E5">less than a quarter of all transactions</font>

165
00:07:00,570 --> 00:07:07,560
are<font color="#CCCCCC"> made using a chip if we look at the</font>

166
00:07:06,060 --> 00:07:10,560
growth<font color="#CCCCCC"> of</font><font color="#E5E5E5"> mobile</font><font color="#CCCCCC"> Point of Sales</font>

167
00:07:07,560 --> 00:07:12,990
terminals<font color="#E5E5E5"> with only if with within only</font>

168
00:07:10,560 --> 00:07:13,950
<font color="#E5E5E5">a</font><font color="#CCCCCC"> couple of years it's</font><font color="#E5E5E5"> quite incredible</font>

169
00:07:12,990 --> 00:07:17,040
<font color="#CCCCCC">really</font>

170
00:07:13,950 --> 00:07:19,530
so by 2019<font color="#E5E5E5"> mobile point-of-sale</font>

171
00:07:17,040 --> 00:07:22,650
terminals are projected<font color="#CCCCCC"> to contribute to</font>

172
00:07:19,530 --> 00:07:28,409
almost<font color="#CCCCCC"> 50%</font><font color="#E5E5E5"> of all transactions made by</font><font color="#CCCCCC"> a</font>

173
00:07:22,650 --> 00:07:30,390
<font color="#E5E5E5">terminal so how do these devices work so</font>

174
00:07:28,410 --> 00:07:32,550
this schematic overview represents how

175
00:07:30,390 --> 00:07:35,490
each of<font color="#CCCCCC"> the components communicate with</font>

176
00:07:32,550 --> 00:07:37,290
each other<font color="#E5E5E5"> the terminal communicates to</font>

177
00:07:35,490 --> 00:07:39,990
the phone and<font color="#CCCCCC"> the mobile application via</font>

178
00:07:37,290 --> 00:07:41,850
<font color="#CCCCCC">Bluetooth which in turn communicates to</font>

179
00:07:39,990 --> 00:07:47,250
the payment server<font color="#E5E5E5"> over a network</font>

180
00:07:41,850 --> 00:07:49,080
connection<font color="#E5E5E5"> or over Wi-Fi so now that we</font>

181
00:07:47,250 --> 00:07:51,960
have<font color="#CCCCCC"> a broad understanding of how the</font>

182
00:07:49,080 --> 00:07:53,609
payment ecosystem works and how mobile

183
00:07:51,960 --> 00:07:56,039
point-of-sale terminals fit into<font color="#E5E5E5"> this</font>

184
00:07:53,610 --> 00:07:58,740
<font color="#E5E5E5">process we can</font><font color="#CCCCCC"> begin to discuss</font><font color="#E5E5E5"> our</font>

185
00:07:56,040 --> 00:08:01,440
findings<font color="#CCCCCC"> we'll be talking about the</font>

186
00:07:58,740 --> 00:08:03,270
sending of arbitrary commands which you

187
00:08:01,440 --> 00:08:05,760
can use<font color="#CCCCCC"> to socially engineer a</font>

188
00:08:03,270 --> 00:08:07,770
<font color="#CCCCCC">cardholder</font><font color="#E5E5E5"> for example we can send a</font>

189
00:08:05,760 --> 00:08:10,320
message<font color="#CCCCCC"> to a payment</font><font color="#E5E5E5"> display which says</font>

190
00:08:07,770 --> 00:08:13,320
<font color="#E5E5E5">payment declined and get a</font><font color="#CCCCCC"> cardholder</font><font color="#E5E5E5"> to</font>

191
00:08:10,320 --> 00:08:14,969
carry out<font color="#CCCCCC"> additional transactions then</font>

192
00:08:13,320 --> 00:08:17,430
we will talk<font color="#E5E5E5"> about how for certain</font>

193
00:08:14,970 --> 00:08:20,400
transaction types we<font color="#CCCCCC"> can actually</font><font color="#E5E5E5"> modify</font>

194
00:08:17,430 --> 00:08:22,850
the transaction<font color="#CCCCCC"> value thus displaying a</font>

195
00:08:20,400 --> 00:08:25,349
lower value on the terminal screen<font color="#CCCCCC"> and</font>

196
00:08:22,850 --> 00:08:28,620
forcing the<font color="#CCCCCC"> cardholders</font><font color="#E5E5E5"> carry out a much</font>

197
00:08:25,350 --> 00:08:30,120
higher value transaction we will talk

198
00:08:28,620 --> 00:08:31,950
<font color="#E5E5E5">about how we</font><font color="#CCCCCC"> obtain remote code</font>

199
00:08:30,120 --> 00:08:34,350
execution<font color="#E5E5E5"> and one of the readers</font><font color="#CCCCCC"> that we</font>

200
00:08:31,950 --> 00:08:37,080
looked at which provides full access<font color="#E5E5E5"> to</font>

201
00:08:34,350 --> 00:08:39,180
<font color="#E5E5E5">the file system</font><font color="#CCCCCC"> so with</font><font color="#E5E5E5"> this kind of</font>

202
00:08:37,080 --> 00:08:41,130
attack<font color="#E5E5E5"> vector you pretty much have</font>

203
00:08:39,179 --> 00:08:42,929
access to everything<font color="#E5E5E5"> so we can collect</font>

204
00:08:41,130 --> 00:08:46,050
<font color="#E5E5E5">track</font><font color="#CCCCCC"> to information before it's even</font>

205
00:08:42,929 --> 00:08:47,790
encrypted<font color="#E5E5E5"> then we will discuss</font><font color="#CCCCCC"> the</font>

206
00:08:46,050 --> 00:08:50,370
security<font color="#E5E5E5"> mechanisms within the hardware</font>

207
00:08:47,790 --> 00:08:53,930
<font color="#CCCCCC">of the terminals themselves and finally</font>

208
00:08:50,370 --> 00:08:53,930
we will discuss secondary<font color="#E5E5E5"> factors</font>

209
00:08:56,460 --> 00:09:00,760
<font color="#E5E5E5">Bluetooth is the main form of</font>

210
00:08:58,510 --> 00:09:02,410
communication<font color="#CCCCCC"> between the</font><font color="#E5E5E5"> phone</font><font color="#CCCCCC"> and the</font>

211
00:09:00,760 --> 00:09:04,480
reader and<font color="#E5E5E5"> the mobile application</font>

212
00:09:02,410 --> 00:09:05,980
therefore it's really important<font color="#E5E5E5"> for us</font>

213
00:09:04,480 --> 00:09:08,470
<font color="#CCCCCC">to have an understanding of</font><font color="#E5E5E5"> how the</font>

214
00:09:05,980 --> 00:09:11,680
protocol<font color="#CCCCCC"> works</font><font color="#E5E5E5"> so let's make a brief</font>

215
00:09:08,470 --> 00:09:13,870
<font color="#E5E5E5">overview of the protocol stack</font><font color="#CCCCCC"> bluetooth</font>

216
00:09:11,680 --> 00:09:15,430
can be roughly divided into two separate

217
00:09:13,870 --> 00:09:18,100
areas<font color="#E5E5E5"> so we have the host and the</font>

218
00:09:15,430 --> 00:09:20,229
controller layers the Bluetooth profiles

219
00:09:18,100 --> 00:09:22,960
and<font color="#CCCCCC"> Gatton</font><font color="#E5E5E5"> acts deal with the actual</font>

220
00:09:20,230 --> 00:09:24,820
transfer of<font color="#CCCCCC"> information then we</font><font color="#E5E5E5"> have</font><font color="#CCCCCC"> l2</font>

221
00:09:22,960 --> 00:09:27,550
cap which deals<font color="#CCCCCC"> with the segmentation</font>

222
00:09:24,820 --> 00:09:29,110
<font color="#CCCCCC">and reassembly of</font><font color="#E5E5E5"> packets then we have</font>

223
00:09:27,550 --> 00:09:32,349
the host<font color="#CCCCCC"> controller layer</font><font color="#E5E5E5"> host</font>

224
00:09:29,110 --> 00:09:34,030
controller interface or<font color="#E5E5E5"> HCI which is the</font>

225
00:09:32,350 --> 00:09:35,860
lowest level<font color="#CCCCCC"> that we can directly</font>

226
00:09:34,030 --> 00:09:38,500
interact<font color="#CCCCCC"> with without specialist</font>

227
00:09:35,860 --> 00:09:40,840
<font color="#CCCCCC">equipment</font><font color="#E5E5E5"> so this is commonly</font><font color="#CCCCCC"> used</font><font color="#E5E5E5"> for</font>

228
00:09:38,500 --> 00:09:42,850
debugging by developers<font color="#E5E5E5"> but if you're a</font>

229
00:09:40,840 --> 00:09:45,250
<font color="#E5E5E5">security researcher</font><font color="#CCCCCC"> it's</font><font color="#E5E5E5"> particularly</font>

230
00:09:42,850 --> 00:09:46,840
<font color="#E5E5E5">helpful to have access to</font><font color="#CCCCCC"> this because</font>

231
00:09:45,250 --> 00:09:50,140
<font color="#E5E5E5">you can start to understand some of the</font>

232
00:09:46,840 --> 00:09:51,820
functions of<font color="#E5E5E5"> the device then we have the</font>

233
00:09:50,140 --> 00:09:55,060
link manager protocol which deals with

234
00:09:51,820 --> 00:09:56,830
pairing negotiation and encryption we

235
00:09:55,060 --> 00:10:00,569
have baseband which is the<font color="#E5E5E5"> last layer of</font>

236
00:09:56,830 --> 00:10:03,160
framing before<font color="#E5E5E5"> Bluetooth radio itself</font>

237
00:10:00,570 --> 00:10:04,600
when<font color="#E5E5E5"> we talk about Bluetooth were</font>

238
00:10:03,160 --> 00:10:07,150
actually<font color="#CCCCCC"> talking about</font><font color="#E5E5E5"> two different</font>

239
00:10:04,600 --> 00:10:10,030
protocols Bluetooth classic<font color="#CCCCCC"> and</font>

240
00:10:07,150 --> 00:10:12,310
Bluetooth<font color="#CCCCCC"> low-energy</font><font color="#E5E5E5"> Bluetooth classic</font>

241
00:10:10,030 --> 00:10:14,829
uses Bluetooth profiles to communicate

242
00:10:12,310 --> 00:10:17,349
with all of the devices<font color="#CCCCCC"> that we looked</font>

243
00:10:14,830 --> 00:10:19,960
at<font color="#E5E5E5"> that use Bluetooth classic use RF</font>

244
00:10:17,350 --> 00:10:22,420
comm<font color="#E5E5E5"> so what this does is it simulates a</font>

245
00:10:19,960 --> 00:10:25,930
serial<font color="#E5E5E5"> point</font><font color="#CCCCCC"> or port</font><font color="#E5E5E5"> between the reader</font>

246
00:10:22,420 --> 00:10:27,370
<font color="#E5E5E5">and</font><font color="#CCCCCC"> the mobile application so</font><font color="#E5E5E5"> this means</font>

247
00:10:25,930 --> 00:10:30,189
we can<font color="#E5E5E5"> send large amounts of data</font>

248
00:10:27,370 --> 00:10:33,250
<font color="#E5E5E5">between the</font><font color="#CCCCCC"> two devices on the other on</font>

249
00:10:30,190 --> 00:10:35,220
the other<font color="#E5E5E5"> hand Bluetooth</font><font color="#CCCCCC"> low-energy only</font>

250
00:10:33,250 --> 00:10:38,080
allows for<font color="#CCCCCC"> the small sending of data</font>

251
00:10:35,220 --> 00:10:40,360
<font color="#E5E5E5">this is used as a hierarchical structure</font>

252
00:10:38,080 --> 00:10:44,020
under<font color="#E5E5E5"> which services and characteristics</font>

253
00:10:40,360 --> 00:10:46,240
are<font color="#CCCCCC"> defined each characteristic has a</font>

254
00:10:44,020 --> 00:10:50,710
unique value and properties such as<font color="#E5E5E5"> read</font>

255
00:10:46,240 --> 00:10:52,930
<font color="#E5E5E5">write and notify if you want to attack a</font>

256
00:10:50,710 --> 00:10:54,940
<font color="#E5E5E5">Bluetooth device or just communicate</font>

257
00:10:52,930 --> 00:10:57,579
with it<font color="#E5E5E5"> we obviously need</font><font color="#CCCCCC"> to know what</font>

258
00:10:54,940 --> 00:10:59,230
the address is made up of so the

259
00:10:57,580 --> 00:11:01,690
Bluetooth address is made up of three

260
00:10:59,230 --> 00:11:03,700
<font color="#CCCCCC">main parts we</font><font color="#E5E5E5"> have the non significant</font>

261
00:11:01,690 --> 00:11:07,030
address part which<font color="#CCCCCC"> isn't significant for</font>

262
00:11:03,700 --> 00:11:09,940
any functions the upper address part and

263
00:11:07,030 --> 00:11:11,860
lower address<font color="#E5E5E5"> par the lower address part</font>

264
00:11:09,940 --> 00:11:14,500
is present in every frame<font color="#E5E5E5"> and</font><font color="#CCCCCC"> its unique</font>

265
00:11:11,860 --> 00:11:16,780
<font color="#E5E5E5">to the specific device the non</font>

266
00:11:14,500 --> 00:11:18,720
significant address<font color="#E5E5E5"> part an upper</font><font color="#CCCCCC"> adjust</font>

267
00:11:16,780 --> 00:11:21,520
part is what<font color="#E5E5E5"> is known as the</font>

268
00:11:18,720 --> 00:11:23,590
organizationally unique ID<font color="#E5E5E5"> or you owe</font>

269
00:11:21,520 --> 00:11:25,900
you<font color="#E5E5E5"> I so if you know what this</font>

270
00:11:23,590 --> 00:11:28,120
<font color="#CCCCCC">information is so if you have a range of</font>

271
00:11:25,900 --> 00:11:30,790
these<font color="#E5E5E5"> four vendors it's possible to sit</font>

272
00:11:28,120 --> 00:11:34,260
in to sit in a public place<font color="#E5E5E5"> and identify</font>

273
00:11:30,790 --> 00:11:36,579
potentially vulnerable devices<font color="#E5E5E5"> a</font>

274
00:11:34,260 --> 00:11:39,430
Bluetooth<font color="#E5E5E5"> network is also</font><font color="#CCCCCC"> made up of</font><font color="#E5E5E5"> a</font>

275
00:11:36,580 --> 00:11:43,870
master and slave model so one master can

276
00:11:39,430 --> 00:11:46,000
have up<font color="#CCCCCC"> to seven slaves there are many</font>

277
00:11:43,870 --> 00:11:48,490
different<font color="#E5E5E5"> Bluetooth attack vectors but</font>

278
00:11:46,000 --> 00:11:50,290
we'll be focusing on<font color="#E5E5E5"> two so the first is</font>

279
00:11:48,490 --> 00:11:52,720
man in the middle<font color="#E5E5E5"> or eavesdropping and</font>

280
00:11:50,290 --> 00:11:55,780
the next is malicious device

281
00:11:52,720 --> 00:11:57,370
manipulation so with eavesdropping

282
00:11:55,780 --> 00:11:58,870
<font color="#CCCCCC">you're trying to intercept the</font>

283
00:11:57,370 --> 00:12:01,740
communication between the master<font color="#CCCCCC"> and the</font>

284
00:11:58,870 --> 00:12:05,530
slave and decrypt the communication<font color="#E5E5E5"> if</font>

285
00:12:01,740 --> 00:12:06,730
you want to if you<font color="#E5E5E5"> want to</font><font color="#CCCCCC"> manipulate</font>

286
00:12:05,530 --> 00:12:09,370
the device maliciously

287
00:12:06,730 --> 00:12:10,660
<font color="#E5E5E5">you can just connect</font><font color="#CCCCCC"> to the device but</font>

288
00:12:09,370 --> 00:12:12,220
in order<font color="#CCCCCC"> to carry out that kind of</font>

289
00:12:10,660 --> 00:12:16,300
attack<font color="#E5E5E5"> we need to carry out some</font>

290
00:12:12,220 --> 00:12:18,250
prerequisite work for<font color="#E5E5E5"> for</font>

291
00:12:16,300 --> 00:12:21,400
man-in-the-middle attacks<font color="#E5E5E5"> you require</font>

292
00:12:18,250 --> 00:12:23,200
special istic equipment so the equipment

293
00:12:21,400 --> 00:12:25,500
<font color="#CCCCCC">that</font><font color="#E5E5E5"> you require to carry out these kind</font>

294
00:12:23,200 --> 00:12:28,030
<font color="#CCCCCC">of attacks depends on the Bluetooth type</font>

295
00:12:25,500 --> 00:12:30,100
so for Bluetooth classic using an

296
00:12:28,030 --> 00:12:31,750
enhanced data rates<font color="#E5E5E5"> it's not very</font>

297
00:12:30,100 --> 00:12:33,370
affordable<font color="#E5E5E5"> for</font><font color="#CCCCCC"> most of us here</font><font color="#E5E5E5"> in the</font>

298
00:12:31,750 --> 00:12:35,590
<font color="#E5E5E5">room to carry out these kind of attacks</font>

299
00:12:33,370 --> 00:12:38,290
<font color="#CCCCCC">because</font><font color="#E5E5E5"> typically you need specialist</font>

300
00:12:35,590 --> 00:12:40,570
equipment<font color="#CCCCCC"> like the BPA</font><font color="#E5E5E5"> 600 which costs</font>

301
00:12:38,290 --> 00:12:42,599
<font color="#CCCCCC">twenty thousand dollars but</font><font color="#E5E5E5"> on the other</font>

302
00:12:40,570 --> 00:12:46,000
<font color="#E5E5E5">hand</font><font color="#CCCCCC"> if you</font><font color="#E5E5E5"> look at Bluetooth</font><font color="#CCCCCC"> Low Energy</font>

303
00:12:42,600 --> 00:12:49,020
<font color="#E5E5E5">you can use the Texas</font><font color="#CCCCCC"> Instruments CC</font><font color="#E5E5E5"> 25</font>

304
00:12:46,000 --> 00:12:52,120
<font color="#E5E5E5">40 development kit or an uber tooth one</font>

305
00:12:49,020 --> 00:12:54,340
<font color="#E5E5E5">but these kind of attack vectors aren't</font>

306
00:12:52,120 --> 00:12:57,430
<font color="#E5E5E5">really that viable they're quite complex</font>

307
00:12:54,340 --> 00:12:59,050
<font color="#E5E5E5">to do and we're talking about card</font>

308
00:12:57,430 --> 00:13:01,390
readers here which<font color="#E5E5E5"> means that all</font>

309
00:12:59,050 --> 00:13:03,579
<font color="#CCCCCC">pertinent</font><font color="#E5E5E5"> information between the card</font>

310
00:13:01,390 --> 00:13:06,100
reader<font color="#E5E5E5"> and the payment server is likely</font>

311
00:13:03,580 --> 00:13:09,820
to be encrypted<font color="#E5E5E5"> so for this reason</font><font color="#CCCCCC"> it's</font>

312
00:13:06,100 --> 00:13:11,590
<font color="#CCCCCC">not a viable attack method for us so</font>

313
00:13:09,820 --> 00:13:13,660
just<font color="#CCCCCC"> a</font><font color="#E5E5E5"> special note on enhanced data</font>

314
00:13:11,590 --> 00:13:16,120
rates<font color="#E5E5E5"> because there isn't too much</font>

315
00:13:13,660 --> 00:13:18,579
<font color="#CCCCCC">information online</font><font color="#E5E5E5"> about devices using</font>

316
00:13:16,120 --> 00:13:20,259
enhanced<font color="#E5E5E5"> data rates how do you know if</font>

317
00:13:18,580 --> 00:13:21,939
your device<font color="#CCCCCC"> supports this</font>

318
00:13:20,259 --> 00:13:24,129
and whether it's<font color="#CCCCCC"> outside of your reach</font>

319
00:13:21,939 --> 00:13:26,529
<font color="#CCCCCC">to</font><font color="#E5E5E5"> actually carry an attack on a device</font>

320
00:13:24,129 --> 00:13:28,419
like this<font color="#CCCCCC"> the first</font><font color="#E5E5E5"> thing you can do is</font>

321
00:13:26,529 --> 00:13:30,669
you can<font color="#E5E5E5"> run a reconnaissance scan and</font>

322
00:13:28,419 --> 00:13:33,879
you'll see that EDR is<font color="#E5E5E5"> listed as a</font>

323
00:13:30,669 --> 00:13:35,109
feature<font color="#CCCCCC"> under the response</font><font color="#E5E5E5"> the second</font>

324
00:13:33,879 --> 00:13:37,359
thing that you<font color="#E5E5E5"> need</font><font color="#CCCCCC"> to do just</font><font color="#E5E5E5"> to</font>

325
00:13:35,109 --> 00:13:39,279
confirm<font color="#E5E5E5"> that this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> the case is if you</font>

326
00:13:37,359 --> 00:13:41,199
capture<font color="#E5E5E5"> some of the packets using a tool</font>

327
00:13:39,279 --> 00:13:42,819
like<font color="#E5E5E5"> uber tooth you'll notice that</font>

328
00:13:41,199 --> 00:13:44,559
you're only seeing<font color="#E5E5E5"> the data pay</font><font color="#CCCCCC"> are the</font>

329
00:13:42,819 --> 00:13:46,839
data headers and none of<font color="#E5E5E5"> the data</font>

330
00:13:44,559 --> 00:13:50,459
payloads<font color="#CCCCCC"> so in this way</font><font color="#E5E5E5"> you can confirm</font>

331
00:13:46,839 --> 00:13:53,229
that it's not a realistic attack for you

332
00:13:50,459 --> 00:13:55,089
so this brings<font color="#E5E5E5"> us</font><font color="#CCCCCC"> onto</font><font color="#E5E5E5"> our first finding</font>

333
00:13:53,229 --> 00:13:57,879
which<font color="#CCCCCC"> is the sending of arbitrary</font>

334
00:13:55,089 --> 00:14:01,269
commands<font color="#E5E5E5"> so as I mentioned this allows</font>

335
00:13:57,879 --> 00:14:02,979
us<font color="#CCCCCC"> to socially engineer</font><font color="#E5E5E5"> a cardholder</font><font color="#CCCCCC"> so</font>

336
00:14:01,269 --> 00:14:05,529
we may get<font color="#E5E5E5"> them to carry out</font><font color="#CCCCCC"> a less</font>

337
00:14:02,979 --> 00:14:06,660
<font color="#E5E5E5">secure payment method or we could get</font>

338
00:14:05,529 --> 00:14:10,779
them to<font color="#E5E5E5"> carry out additional</font>

339
00:14:06,660 --> 00:14:14,259
<font color="#E5E5E5">transactions so if we connect directly</font>

340
00:14:10,779 --> 00:14:16,509
to<font color="#E5E5E5"> a device what could we do we can get</font>

341
00:14:14,259 --> 00:14:19,269
it to initiate a payment for example we

342
00:14:16,509 --> 00:14:21,399
could display some<font color="#CCCCCC"> text on</font><font color="#E5E5E5"> the device</font><font color="#CCCCCC"> we</font>

343
00:14:19,269 --> 00:14:23,139
can<font color="#E5E5E5"> turn it off and on but we</font><font color="#CCCCCC"> need to</font>

344
00:14:21,399 --> 00:14:26,499
<font color="#E5E5E5">consider that the pairing process might</font>

345
00:14:23,139 --> 00:14:29,100
introduce<font color="#E5E5E5"> some obstacles for us it's</font>

346
00:14:26,499 --> 00:14:31,239
worth noting for<font color="#E5E5E5"> developers</font><font color="#CCCCCC"> that user</font>

347
00:14:29,100 --> 00:14:33,279
user authentication and input

348
00:14:31,239 --> 00:14:34,989
sanitization doesn't actually happen<font color="#E5E5E5"> in</font>

349
00:14:33,279 --> 00:14:37,559
<font color="#CCCCCC">bluetooth itself so you have to</font>

350
00:14:34,989 --> 00:14:40,389
implement<font color="#CCCCCC"> this</font><font color="#E5E5E5"> at the application level</font>

351
00:14:37,559 --> 00:14:42,699
so in order<font color="#E5E5E5"> to carry out this</font><font color="#CCCCCC"> attack we</font>

352
00:14:40,389 --> 00:14:45,279
need<font color="#E5E5E5"> to carry out some prerequisite work</font>

353
00:14:42,699 --> 00:14:47,319
so that we<font color="#E5E5E5"> understand how the device</font>

354
00:14:45,279 --> 00:14:49,029
<font color="#E5E5E5">works and what each of the functions are</font>

355
00:14:47,319 --> 00:14:52,179
responsible for so a bit of reverse

356
00:14:49,029 --> 00:14:54,819
<font color="#E5E5E5">engineering all that we need to do that</font>

357
00:14:52,179 --> 00:14:57,699
is we need a mobile<font color="#E5E5E5"> phone or</font><font color="#CCCCCC"> a cell</font>

358
00:14:54,819 --> 00:15:00,128
<font color="#CCCCCC">phone which has the ability to enable</font><font color="#E5E5E5"> in</font>

359
00:14:57,699 --> 00:15:03,039
<font color="#CCCCCC">our</font><font color="#E5E5E5"> enhanced features developers</font><font color="#CCCCCC"> option</font>

360
00:15:00,129 --> 00:15:05,379
<font color="#E5E5E5">specifically then we need to enable HCI</font>

361
00:15:03,039 --> 00:15:07,629
logging on the phone you'll also need

362
00:15:05,379 --> 00:15:10,239
<font color="#CCCCCC">access to the mobile</font><font color="#E5E5E5"> application for the</font>

363
00:15:07,629 --> 00:15:13,359
card reader<font color="#CCCCCC"> and you'll need access to</font>

364
00:15:10,239 --> 00:15:15,369
<font color="#E5E5E5">the card reader itself so the next thing</font>

365
00:15:13,359 --> 00:15:18,220
that we need<font color="#CCCCCC"> to do is we need</font><font color="#E5E5E5"> to capture</font>

366
00:15:15,369 --> 00:15:20,499
<font color="#E5E5E5">a sample of operations so the easiest</font>

367
00:15:18,220 --> 00:15:23,379
<font color="#E5E5E5">way to do this is just to carry out some</font>

368
00:15:20,499 --> 00:15:25,720
transactions with<font color="#CCCCCC"> the reader</font><font color="#E5E5E5"> once we've</font>

369
00:15:23,379 --> 00:15:27,819
captured this information you can<font color="#E5E5E5"> import</font>

370
00:15:25,720 --> 00:15:30,189
it into tools such as Wireshark as you

371
00:15:27,819 --> 00:15:33,279
can see here and<font color="#CCCCCC"> you can analyze</font><font color="#E5E5E5"> the</font>

372
00:15:30,189 --> 00:15:34,069
<font color="#CCCCCC">output so</font><font color="#E5E5E5"> using this</font><font color="#CCCCCC"> information</font><font color="#E5E5E5"> and the</font>

373
00:15:33,279 --> 00:15:36,230
information<font color="#CCCCCC"> in the</font>

374
00:15:34,070 --> 00:15:38,210
mobile application<font color="#E5E5E5"> it's possible to</font>

375
00:15:36,230 --> 00:15:40,880
reverse many of the<font color="#E5E5E5"> functions of the</font>

376
00:15:38,210 --> 00:15:45,350
device<font color="#CCCCCC"> so here we can</font><font color="#E5E5E5"> see the sending of</font>

377
00:15:40,880 --> 00:15:46,730
insert or swipe card to the display so

378
00:15:45,350 --> 00:15:48,530
in this next<font color="#CCCCCC"> example</font>

379
00:15:46,730 --> 00:15:50,870
<font color="#E5E5E5">I've actually inserted my card</font>

380
00:15:48,530 --> 00:15:53,230
<font color="#E5E5E5">incorrectly into this reader and it's</font>

381
00:15:50,870 --> 00:15:55,490
<font color="#E5E5E5">presented the message please remove card</font>

382
00:15:53,230 --> 00:15:56,840
<font color="#E5E5E5">we can see that there's two</font><font color="#CCCCCC"> packets</font>

383
00:15:55,490 --> 00:15:59,360
responsible<font color="#E5E5E5"> for the sending of this</font>

384
00:15:56,840 --> 00:16:01,010
<font color="#CCCCCC">information that's because this terminal</font>

385
00:15:59,360 --> 00:16:03,680
<font color="#E5E5E5">is using Bluetooth Low</font><font color="#CCCCCC"> Energy and it has</font>

386
00:16:01,010 --> 00:16:06,260
quite<font color="#CCCCCC"> a low packet size and we</font><font color="#E5E5E5"> can also</font>

387
00:16:03,680 --> 00:16:08,569
see the corresponding<font color="#CCCCCC"> UUID for the value</font>

388
00:16:06,260 --> 00:16:11,500
sent so we need to know this information

389
00:16:08,570 --> 00:16:14,120
<font color="#E5E5E5">in order to</font><font color="#CCCCCC"> communicate with the device</font>

390
00:16:11,500 --> 00:16:16,760
so if we look at<font color="#CCCCCC"> this example in</font><font color="#E5E5E5"> greater</font>

391
00:16:14,120 --> 00:16:19,520
detail<font color="#E5E5E5"> you can see</font><font color="#CCCCCC"> it's actually</font><font color="#E5E5E5"> made up</font>

392
00:16:16,760 --> 00:16:22,370
of five parts<font color="#E5E5E5"> the</font><font color="#CCCCCC"> first</font><font color="#E5E5E5"> is a leading</font>

393
00:16:19,520 --> 00:16:25,040
value and this contains<font color="#E5E5E5"> a command ID a</font>

394
00:16:22,370 --> 00:16:27,800
counter value and the intended<font color="#E5E5E5"> payload</font>

395
00:16:25,040 --> 00:16:30,699
size then we<font color="#CCCCCC"> have the message which is</font>

396
00:16:27,800 --> 00:16:34,310
please remove card and this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> ASCII</font>

397
00:16:30,700 --> 00:16:36,950
then we have a<font color="#E5E5E5"> trailing part a checksum</font>

398
00:16:34,310 --> 00:16:39,709
which<font color="#E5E5E5"> is in Ex modem and then we have an</font>

399
00:16:36,950 --> 00:16:41,240
end value<font color="#E5E5E5"> so once you</font><font color="#CCCCCC"> know this</font>

400
00:16:39,710 --> 00:16:43,250
information<font color="#E5E5E5"> so for</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> particular</font>

401
00:16:41,240 --> 00:16:45,830
terminal<font color="#CCCCCC"> it's possible</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> us to</font>

402
00:16:43,250 --> 00:16:47,720
<font color="#CCCCCC">calculate any number of</font><font color="#E5E5E5"> values</font><font color="#CCCCCC"> to send</font>

403
00:16:45,830 --> 00:16:50,030
to the display<font color="#CCCCCC"> we don't have to send</font>

404
00:16:47,720 --> 00:16:53,350
please remove card or insert a swipe

405
00:16:50,030 --> 00:16:56,030
card we can just do anything<font color="#E5E5E5"> with it</font><font color="#CCCCCC"> so</font>

406
00:16:53,350 --> 00:16:58,250
<font color="#CCCCCC">we found that</font><font color="#E5E5E5"> three of the terminals</font>

407
00:16:56,030 --> 00:17:01,430
<font color="#E5E5E5">that we looked at were vulnerable to</font>

408
00:16:58,250 --> 00:17:03,380
<font color="#E5E5E5">this kind</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> attack with a display so as</font>

409
00:17:01,430 --> 00:17:05,419
I mentioned<font color="#CCCCCC"> we could use this to send a</font>

410
00:17:03,380 --> 00:17:07,670
message such as<font color="#E5E5E5"> please swipe your card</font>

411
00:17:05,420 --> 00:17:09,589
<font color="#E5E5E5">and therefore force a</font><font color="#CCCCCC"> cardholder</font><font color="#E5E5E5"> to</font>

412
00:17:07,670 --> 00:17:11,990
swipe their card instead<font color="#CCCCCC"> of using their</font>

413
00:17:09,589 --> 00:17:14,149
chip<font color="#E5E5E5"> we can also send a</font><font color="#CCCCCC"> message</font><font color="#E5E5E5"> that</font>

414
00:17:11,990 --> 00:17:16,280
such as<font color="#E5E5E5"> payment</font><font color="#CCCCCC"> cancelled</font><font color="#E5E5E5"> or payment</font>

415
00:17:14,150 --> 00:17:19,490
declined<font color="#E5E5E5"> and therefore make them carry</font>

416
00:17:16,280 --> 00:17:23,660
<font color="#CCCCCC">out an additional transaction so let's</font>

417
00:17:19,490 --> 00:17:26,780
see what this looks<font color="#CCCCCC"> like in</font><font color="#E5E5E5"> action so</font>

418
00:17:23,660 --> 00:17:29,150
here I'm going<font color="#CCCCCC"> to send a</font><font color="#E5E5E5"> message to</font><font color="#CCCCCC"> this</font>

419
00:17:26,780 --> 00:17:31,460
play<font color="#E5E5E5"> to tell the cardholder</font>

420
00:17:29,150 --> 00:17:33,200
that they in sent instead need to

421
00:17:31,460 --> 00:17:35,800
actually<font color="#E5E5E5"> swipe their card</font><font color="#CCCCCC"> to carry out</font>

422
00:17:33,200 --> 00:17:35,800
<font color="#E5E5E5">this transaction</font>

423
00:17:48,820 --> 00:17:53,689
so in this next<font color="#E5E5E5"> example we can see this</font>

424
00:17:51,860 --> 00:17:55,279
specific<font color="#CCCCCC"> terminals using</font><font color="#E5E5E5"> Bluetooth</font>

425
00:17:53,690 --> 00:17:57,470
<font color="#CCCCCC">classic which is</font><font color="#E5E5E5"> why it looks a little</font>

426
00:17:55,279 --> 00:17:59,419
bit<font color="#E5E5E5"> different from a previous example</font>

427
00:17:57,470 --> 00:18:03,409
and here you can see the message<font color="#CCCCCC"> which</font>

428
00:17:59,419 --> 00:18:05,779
is<font color="#E5E5E5"> insert or swipe card if we look at</font>

429
00:18:03,409 --> 00:18:07,549
what this consists of<font color="#E5E5E5"> it's similar</font><font color="#CCCCCC"> to</font>

430
00:18:05,779 --> 00:18:10,340
the previous example so<font color="#E5E5E5"> we</font><font color="#CCCCCC"> have a</font>

431
00:18:07,549 --> 00:18:13,039
command ID and a counter value and a

432
00:18:10,340 --> 00:18:15,260
payload<font color="#E5E5E5"> size in the leading part and</font>

433
00:18:13,039 --> 00:18:17,600
then we have the message which is<font color="#CCCCCC"> an</font>

434
00:18:15,260 --> 00:18:20,960
<font color="#CCCCCC">ASCII as well which says insert or swipe</font>

435
00:18:17,600 --> 00:18:24,740
card<font color="#E5E5E5"> and then we have a simple</font><font color="#CCCCCC"> xor value</font>

436
00:18:20,960 --> 00:18:26,600
for the checksum<font color="#E5E5E5"> so again what we can do</font>

437
00:18:24,740 --> 00:18:28,970
is now that<font color="#CCCCCC"> we know this information</font><font color="#E5E5E5"> for</font>

438
00:18:26,600 --> 00:18:32,539
this<font color="#E5E5E5"> terminal we can calculate any kind</font>

439
00:18:28,970 --> 00:18:34,610
of values that<font color="#CCCCCC"> we</font><font color="#E5E5E5"> want so in this</font>

440
00:18:32,539 --> 00:18:36,649
example<font color="#E5E5E5"> what you're going</font><font color="#CCCCCC"> to see is that</font>

441
00:18:34,610 --> 00:18:39,260
the<font color="#E5E5E5"> card holder</font><font color="#CCCCCC"> is going to try and make</font>

442
00:18:36,649 --> 00:18:40,850
<font color="#E5E5E5">a transaction using contactless</font>

443
00:18:39,260 --> 00:18:43,340
but we're going<font color="#CCCCCC"> to interrupt</font><font color="#E5E5E5"> the payment</font>

444
00:18:40,850 --> 00:18:47,559
process we're going<font color="#CCCCCC"> to tell them</font><font color="#E5E5E5"> that</font>

445
00:18:43,340 --> 00:18:47,559
the payment has<font color="#E5E5E5"> an in fact been declined</font>

446
00:18:53,350 --> 00:18:57,529
but<font color="#E5E5E5"> the payment has actually been</font>

447
00:18:55,580 --> 00:19:00,529
<font color="#E5E5E5">authorized which we will see in</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> moment</font>

448
00:18:57,529 --> 00:19:03,080
because<font color="#E5E5E5"> we're going to receive a text</font>

449
00:19:00,529 --> 00:19:08,480
<font color="#CCCCCC">message or</font><font color="#E5E5E5"> an SMS message on the display</font>

450
00:19:03,080 --> 00:19:10,039
of<font color="#CCCCCC"> the phone so you can see that</font><font color="#E5E5E5"> that</font>

451
00:19:08,480 --> 00:19:11,720
payment<font color="#E5E5E5"> did actually go through but</font>

452
00:19:10,039 --> 00:19:15,830
we're able<font color="#E5E5E5"> to interrupt the payment</font>

453
00:19:11,720 --> 00:19:18,409
process so this<font color="#E5E5E5"> brings us on</font><font color="#CCCCCC"> to our next</font>

454
00:19:15,830 --> 00:19:20,090
finding which is<font color="#CCCCCC"> a mount modification</font><font color="#E5E5E5"> so</font>

455
00:19:18,409 --> 00:19:21,919
we're going<font color="#E5E5E5"> to use the</font><font color="#CCCCCC"> information that</font>

456
00:19:20,090 --> 00:19:24,649
we've<font color="#CCCCCC"> learnt</font><font color="#E5E5E5"> about in the first section</font>

457
00:19:21,919 --> 00:19:26,899
<font color="#E5E5E5">around sending arbitrary commands to</font>

458
00:19:24,649 --> 00:19:30,789
work out how<font color="#CCCCCC"> to send how to</font><font color="#E5E5E5"> modify the</font>

459
00:19:26,899 --> 00:19:30,789
<font color="#CCCCCC">amount for certain transaction values</font>

460
00:19:31,120 --> 00:19:39,678
yeah<font color="#E5E5E5"> now let's try to affect payment</font>

461
00:19:36,049 --> 00:19:42,289
<font color="#E5E5E5">process and payment comments so actually</font>

462
00:19:39,679 --> 00:19:44,480
there are a lot of<font color="#E5E5E5"> ways to intercept</font>

463
00:19:42,289 --> 00:19:46,908
comments as well<font color="#E5E5E5"> as</font><font color="#CCCCCC"> temper them and just</font>

464
00:19:44,480 --> 00:19:48,679
reverse engineer them so first of all

465
00:19:46,909 --> 00:19:51,740
all comments are<font color="#E5E5E5"> going from a server</font>

466
00:19:48,679 --> 00:19:54,830
side<font color="#CCCCCC"> to the phone which means if you</font>

467
00:19:51,740 --> 00:19:56,780
will use<font color="#E5E5E5"> HTTP main in the middle</font><font color="#CCCCCC"> we'll</font>

468
00:19:54,830 --> 00:19:58,939
be able<font color="#E5E5E5"> to intercept them for this</font>

469
00:19:56,780 --> 00:20:00,990
purpose<font color="#CCCCCC"> you just need to bypass SSL</font>

470
00:19:58,940 --> 00:20:03,809
pinning in most of the cases

471
00:20:00,990 --> 00:20:05,850
and<font color="#CCCCCC"> there a</font><font color="#E5E5E5"> lot of ways to do</font><font color="#CCCCCC"> this next</font>

472
00:20:03,809 --> 00:20:08,850
<font color="#E5E5E5">method was already</font><font color="#CCCCCC"> mentioned is like the</font>

473
00:20:05,850 --> 00:20:10,949
<font color="#E5E5E5">easiest one to enable a shell login and</font>

474
00:20:08,850 --> 00:20:14,850
<font color="#CCCCCC">then get access to traffic</font><font color="#E5E5E5"> and read it</font>

475
00:20:10,950 --> 00:20:17,820
via Wireshark next you also can<font color="#CCCCCC"> rebuilt</font>

476
00:20:14,850 --> 00:20:19,800
an<font color="#E5E5E5"> apk in a mobile application enable</font>

477
00:20:17,820 --> 00:20:22,590
debugging messages and then get access

478
00:20:19,800 --> 00:20:24,240
<font color="#CCCCCC">to them via Android</font><font color="#E5E5E5"> debug bridge this</font>

479
00:20:22,590 --> 00:20:27,659
method is also very<font color="#E5E5E5"> useful for</font><font color="#CCCCCC"> example</font>

480
00:20:24,240 --> 00:20:30,300
<font color="#E5E5E5">to get information about commands some</font>

481
00:20:27,660 --> 00:20:33,480
<font color="#E5E5E5">information and source code so very good</font>

482
00:20:30,300 --> 00:20:35,639
<font color="#CCCCCC">and finally if you don't have if you</font>

483
00:20:33,480 --> 00:20:37,980
<font color="#CCCCCC">don't have any other options you</font><font color="#E5E5E5"> still</font>

484
00:20:35,640 --> 00:20:42,330
can use<font color="#E5E5E5"> external device which also was</font>

485
00:20:37,980 --> 00:20:44,850
mentioned<font color="#CCCCCC"> for example</font><font color="#E5E5E5"> uber tips so here</font>

486
00:20:42,330 --> 00:20:47,460
are two examples<font color="#E5E5E5"> of payment comments</font>

487
00:20:44,850 --> 00:20:50,219
from two different<font color="#CCCCCC"> traders for both</font>

488
00:20:47,460 --> 00:20:53,070
readers<font color="#E5E5E5"> we choose two channels of</font>

489
00:20:50,220 --> 00:20:55,830
<font color="#CCCCCC">information</font><font color="#E5E5E5"> so in first case we enabled</font>

490
00:20:53,070 --> 00:20:58,050
<font color="#CCCCCC">HT</font><font color="#E5E5E5"> login and rebuilt an application and</font>

491
00:20:55,830 --> 00:20:59,879
you<font color="#CCCCCC"> can</font><font color="#E5E5E5"> see that the value which is</font>

492
00:20:58,050 --> 00:21:02,879
responsible for amount which<font color="#E5E5E5"> will be</font>

493
00:20:59,880 --> 00:21:07,380
displayed<font color="#CCCCCC"> on</font><font color="#E5E5E5"> the reader is stored in a</font>

494
00:21:02,880 --> 00:21:10,260
hack so 0<font color="#E5E5E5"> 2</font><font color="#CCCCCC"> ee in second case we also</font>

495
00:21:07,380 --> 00:21:12,420
<font color="#E5E5E5">rebuilt an application and get access to</font>

496
00:21:10,260 --> 00:21:15,929
the traffic via<font color="#CCCCCC"> HTTPS main in</font><font color="#E5E5E5"> the middle</font>

497
00:21:12,420 --> 00:21:19,260
and in that case<font color="#E5E5E5"> information</font><font color="#CCCCCC"> was sent in</font>

498
00:21:15,929 --> 00:21:22,890
plain text<font color="#CCCCCC"> so amount was</font><font color="#E5E5E5"> sent 0 1 0 0</font>

499
00:21:19,260 --> 00:21:25,800
and as you<font color="#E5E5E5"> can</font><font color="#CCCCCC"> see just</font><font color="#E5E5E5"> all you need to</font>

500
00:21:22,890 --> 00:21:28,620
send<font color="#E5E5E5"> arbitrary amount you just</font><font color="#CCCCCC"> need to</font>

501
00:21:25,800 --> 00:21:32,399
change<font color="#E5E5E5"> these bytes and then recalc</font><font color="#CCCCCC"> a</font>

502
00:21:28,620 --> 00:21:36,030
<font color="#CCCCCC">checksum</font><font color="#E5E5E5"> so what actually will happen if</font>

503
00:21:32,400 --> 00:21:40,440
a fraudulent merchants will tamper an

504
00:21:36,030 --> 00:21:43,649
amount<font color="#E5E5E5"> between phone and the reader so</font>

505
00:21:40,440 --> 00:21:46,650
he shows lower amount to a customer and

506
00:21:43,650 --> 00:21:48,929
<font color="#CCCCCC">force customer to</font><font color="#E5E5E5"> make payment for</font><font color="#CCCCCC"> a</font>

507
00:21:46,650 --> 00:21:51,540
lower amount<font color="#E5E5E5"> but actually he will</font><font color="#CCCCCC"> sent a</font>

508
00:21:48,929 --> 00:21:55,500
higher value amount to a service

509
00:21:51,540 --> 00:21:58,620
provider<font color="#CCCCCC"> that's</font><font color="#E5E5E5"> exactly what we do so we</font>

510
00:21:55,500 --> 00:22:01,860
<font color="#CCCCCC">sent</font><font color="#E5E5E5"> one pound 23 pounds to</font><font color="#CCCCCC"> a server</font>

511
00:21:58,620 --> 00:22:04,800
<font color="#E5E5E5">site to a service provider</font><font color="#CCCCCC"> but customer</font>

512
00:22:01,860 --> 00:22:07,800
say<font color="#E5E5E5"> see and confirm</font><font color="#CCCCCC"> only</font><font color="#E5E5E5"> one pound</font>

513
00:22:04,800 --> 00:22:11,370
transaction<font color="#E5E5E5"> and you don't even need to</font>

514
00:22:07,800 --> 00:22:15,020
<font color="#E5E5E5">forge</font><font color="#CCCCCC"> signature because there</font><font color="#E5E5E5"> will be a</font>

515
00:22:11,370 --> 00:22:15,020
genuine signature<font color="#CCCCCC"> of a customer</font>

516
00:22:15,370 --> 00:22:21,010
so this fraudulent<font color="#E5E5E5"> attack and this</font>

517
00:22:18,820 --> 00:22:25,450
fraudulent payment<font color="#E5E5E5"> will pass at least</font>

518
00:22:21,010 --> 00:22:28,720
for a magstripe<font color="#E5E5E5"> why well</font><font color="#CCCCCC"> because in all</font>

519
00:22:25,450 --> 00:22:32,050
<font color="#E5E5E5">of these devices during max type</font>

520
00:22:28,720 --> 00:22:34,570
transaction<font color="#E5E5E5"> reader</font><font color="#CCCCCC"> sends only tracked</font>

521
00:22:32,050 --> 00:22:37,840
data<font color="#E5E5E5"> when for example</font><font color="#CCCCCC"> for in the</font>

522
00:22:34,570 --> 00:22:39,939
transactions actual amount currency and

523
00:22:37,840 --> 00:22:43,570
other information<font color="#E5E5E5"> will be stored</font><font color="#CCCCCC"> inside</font>

524
00:22:39,940 --> 00:22:45,340
of<font color="#E5E5E5"> a payment cryptogram for contactless</font>

525
00:22:43,570 --> 00:22:48,490
transactions there are also certain

526
00:22:45,340 --> 00:22:50,470
modes<font color="#E5E5E5"> legacy modes which</font><font color="#CCCCCC"> can be affected</font>

527
00:22:48,490 --> 00:22:52,690
<font color="#E5E5E5">because</font><font color="#CCCCCC"> they also don't send information</font>

528
00:22:50,470 --> 00:22:56,820
about amount inside<font color="#E5E5E5"> of payment</font>

529
00:22:52,690 --> 00:22:59,620
<font color="#E5E5E5">cryptogram and last problem is that</font>

530
00:22:56,820 --> 00:23:01,780
limits for all kind of payments<font color="#CCCCCC"> for</font>

531
00:22:59,620 --> 00:23:05,229
service providers<font color="#CCCCCC"> are just completely</font>

532
00:23:01,780 --> 00:23:07,450
insane<font color="#E5E5E5"> for like up to $50,000</font><font color="#CCCCCC"> Ciara's or</font>

533
00:23:05,230 --> 00:23:10,840
pounds depends on the region which means

534
00:23:07,450 --> 00:23:13,690
<font color="#E5E5E5">that service providers rely on an</font>

535
00:23:10,840 --> 00:23:16,000
acquiring<font color="#E5E5E5"> on issue or issue in bank in</font>

536
00:23:13,690 --> 00:23:19,900
terms of blocking<font color="#E5E5E5"> of suspicious</font>

537
00:23:16,000 --> 00:23:22,690
transactions<font color="#CCCCCC"> okay so let's imagine</font>

538
00:23:19,900 --> 00:23:25,990
ourselves<font color="#E5E5E5"> we can</font><font color="#CCCCCC"> open a merchant account</font>

539
00:23:22,690 --> 00:23:29,230
in less<font color="#E5E5E5"> than</font><font color="#CCCCCC"> 5</font><font color="#E5E5E5"> minutes then we are</font><font color="#CCCCCC"> going</font>

540
00:23:25,990 --> 00:23:31,240
<font color="#CCCCCC">to</font><font color="#E5E5E5"> forge customer to use less secure</font>

541
00:23:29,230 --> 00:23:33,340
form of<font color="#CCCCCC"> payment for example swipe</font>

542
00:23:31,240 --> 00:23:35,140
instead of<font color="#E5E5E5"> chip and pin then we are</font>

543
00:23:33,340 --> 00:23:37,360
<font color="#E5E5E5">going to show him completely arbitrary</font>

544
00:23:35,140 --> 00:23:39,700
amount on the screen of reader and

545
00:23:37,360 --> 00:23:42,399
mobile phone<font color="#CCCCCC"> like one dollar</font><font color="#E5E5E5"> for example</font>

546
00:23:39,700 --> 00:23:45,160
but in fact we<font color="#E5E5E5"> will</font><font color="#CCCCCC"> be going</font><font color="#E5E5E5"> to carry</font>

547
00:23:42,400 --> 00:23:49,030
out<font color="#CCCCCC"> a transaction for up to 50 thousand</font>

548
00:23:45,160 --> 00:23:52,090
<font color="#CCCCCC">to time and last problem</font><font color="#E5E5E5"> is that this</font>

549
00:23:49,030 --> 00:23:54,250
fraudulent<font color="#E5E5E5"> transaction can be made with</font>

550
00:23:52,090 --> 00:23:57,220
some significant delays for example we

551
00:23:54,250 --> 00:24:01,030
carried it out<font color="#CCCCCC"> with</font><font color="#E5E5E5"> 10 minutes</font><font color="#CCCCCC"> of delay</font>

552
00:23:57,220 --> 00:24:02,710
<font color="#CCCCCC">which means customer has already swiped</font>

553
00:24:01,030 --> 00:24:05,770
card and has already left the building

554
00:24:02,710 --> 00:24:10,510
<font color="#CCCCCC">and 10</font><font color="#E5E5E5"> minutes later</font><font color="#CCCCCC"> merchant</font><font color="#E5E5E5"> does the</font>

555
00:24:05,770 --> 00:24:13,240
transaction<font color="#CCCCCC"> what we'll recommend well</font>

556
00:24:10,510 --> 00:24:16,450
first of all<font color="#E5E5E5"> even</font><font color="#CCCCCC"> if you as a service</font>

557
00:24:13,240 --> 00:24:18,180
provider don't have access to<font color="#E5E5E5"> the</font>

558
00:24:16,450 --> 00:24:20,530
<font color="#CCCCCC">firmware and</font><font color="#E5E5E5"> you can modify the</font>

559
00:24:18,180 --> 00:24:21,790
specification of communication between

560
00:24:20,530 --> 00:24:24,330
reader and the phone

561
00:24:21,790 --> 00:24:27,359
it still can mitigate these risks

562
00:24:24,330 --> 00:24:29,369
for example control your mobile

563
00:24:27,359 --> 00:24:32,369
ecosystem<font color="#E5E5E5"> and should not allowed to use</font>

564
00:24:29,369 --> 00:24:34,228
rooted devices because as you saw<font color="#CCCCCC"> root</font>

565
00:24:32,369 --> 00:24:36,599
<font color="#E5E5E5">the device is just a direct way to</font>

566
00:24:34,229 --> 00:24:39,149
<font color="#E5E5E5">reverse engineer</font><font color="#CCCCCC"> all the protocol and</font>

567
00:24:36,599 --> 00:24:40,559
get access<font color="#CCCCCC"> to</font><font color="#E5E5E5"> the whole</font><font color="#CCCCCC"> traffic for</font>

568
00:24:39,149 --> 00:24:46,168
customers recommendations are much

569
00:24:40,559 --> 00:24:48,359
<font color="#CCCCCC">easier just do</font><font color="#E5E5E5"> not use</font><font color="#CCCCCC"> mac</font><font color="#E5E5E5"> stripe but we</font>

570
00:24:46,169 --> 00:24:51,570
also found that<font color="#E5E5E5"> sometimes it's much</font>

571
00:24:48,359 --> 00:24:53,609
easier to<font color="#E5E5E5"> get a full control over mobile</font>

572
00:24:51,570 --> 00:24:55,918
point-of-sale terminal than over

573
00:24:53,609 --> 00:24:57,539
traditional terminals<font color="#E5E5E5"> so for this</font>

574
00:24:55,919 --> 00:25:01,009
purpose all we need is just<font color="#CCCCCC"> to get</font><font color="#E5E5E5"> a</font>

575
00:24:57,539 --> 00:25:03,509
good reverse engineer and obtain to him

576
00:25:01,009 --> 00:25:06,570
<font color="#CCCCCC">encrypted firmware so he can</font><font color="#E5E5E5"> work on</font>

577
00:25:03,509 --> 00:25:08,849
<font color="#CCCCCC">something let's try to discuss how to</font>

578
00:25:06,570 --> 00:25:12,049
obtain<font color="#E5E5E5"> a film where and how and where</font>

579
00:25:08,849 --> 00:25:14,639
<font color="#E5E5E5">updating process works in the readers so</font>

580
00:25:12,049 --> 00:25:16,829
obviously film where is stored on<font color="#E5E5E5"> the</font>

581
00:25:14,639 --> 00:25:19,199
<font color="#CCCCCC">server</font><font color="#E5E5E5"> side which means it will be</font><font color="#CCCCCC"> going</font>

582
00:25:16,829 --> 00:25:21,299
<font color="#E5E5E5">to a mobile phone</font><font color="#CCCCCC"> by HTTP</font><font color="#E5E5E5"> and then by a</font>

583
00:25:19,200 --> 00:25:23,879
<font color="#CCCCCC">Bluetooth</font><font color="#E5E5E5"> the reader which means we are</font>

584
00:25:21,299 --> 00:25:26,609
<font color="#CCCCCC">going to get access to it exactly the</font>

585
00:25:23,879 --> 00:25:29,189
<font color="#CCCCCC">same</font><font color="#E5E5E5"> way as</font><font color="#CCCCCC"> to every</font><font color="#E5E5E5"> other comments for</font>

586
00:25:26,609 --> 00:25:30,468
<font color="#CCCCCC">example why HTTP main in</font><font color="#E5E5E5"> the middle in</font>

587
00:25:29,190 --> 00:25:33,329
some cases

588
00:25:30,469 --> 00:25:37,039
updating process<font color="#E5E5E5"> and configuration files</font>

589
00:25:33,329 --> 00:25:40,200
<font color="#E5E5E5">are sent as a set of encrypted comments</font>

590
00:25:37,039 --> 00:25:43,259
sometimes<font color="#CCCCCC"> they go into</font><font color="#E5E5E5"> reader as links</font>

591
00:25:40,200 --> 00:25:45,209
to encrypted<font color="#CCCCCC"> firmware as you see here</font>

592
00:25:43,259 --> 00:25:49,469
<font color="#E5E5E5">and in this case you can try to</font>

593
00:25:45,209 --> 00:25:51,539
enumerate versions of<font color="#CCCCCC"> humour on a server</font>

594
00:25:49,469 --> 00:25:53,190
side for example<font color="#CCCCCC"> to obtain some older</font>

595
00:25:51,539 --> 00:25:56,219
<font color="#CCCCCC">versions and vulnerable debugging</font>

596
00:25:53,190 --> 00:25:59,309
versions<font color="#E5E5E5"> but sometimes you don't</font><font color="#CCCCCC"> even</font>

597
00:25:56,219 --> 00:26:02,789
need this<font color="#E5E5E5"> so all you need is just</font><font color="#CCCCCC"> to use</font>

598
00:25:59,309 --> 00:26:06,329
<font color="#E5E5E5">Google and find</font><font color="#CCCCCC"> bit hyper posit or ease</font>

599
00:26:02,789 --> 00:26:08,609
which will be stored<font color="#CCCCCC"> of</font><font color="#E5E5E5"> an encrypted</font>

600
00:26:06,329 --> 00:26:09,950
firmware all the versions vulnerable

601
00:26:08,609 --> 00:26:13,559
versions forever

602
00:26:09,950 --> 00:26:15,989
so what film where and encrypted

603
00:26:13,559 --> 00:26:18,029
<font color="#E5E5E5">firmware will contain well first of all</font>

604
00:26:15,989 --> 00:26:20,729
it's a whole set<font color="#CCCCCC"> of configuration files</font>

605
00:26:18,029 --> 00:26:22,889
<font color="#E5E5E5">which says what messages are going to be</font>

606
00:26:20,729 --> 00:26:25,109
displayed what kind of operations are

607
00:26:22,889 --> 00:26:28,079
<font color="#CCCCCC">going to be done</font><font color="#E5E5E5"> that means that if you</font>

608
00:26:25,109 --> 00:26:29,728
change modify<font color="#CCCCCC"> the configuration file you</font>

609
00:26:28,079 --> 00:26:32,428
will be able<font color="#E5E5E5"> to disable</font><font color="#CCCCCC"> chip-and-pin for</font>

610
00:26:29,729 --> 00:26:35,129
example on the reader<font color="#E5E5E5"> and finally it is</font>

611
00:26:32,429 --> 00:26:37,280
a whole set of<font color="#CCCCCC"> binary files which can be</font>

612
00:26:35,129 --> 00:26:39,169
used to<font color="#E5E5E5"> reverse-engineer them</font>

613
00:26:37,280 --> 00:26:41,270
and find some vulnerabilities like

614
00:26:39,170 --> 00:26:44,600
remote code execution<font color="#CCCCCC"> but first a</font><font color="#E5E5E5"> core</font>

615
00:26:41,270 --> 00:26:47,800
flow<font color="#E5E5E5"> so exactly what</font><font color="#CCCCCC"> our Romans</font><font color="#E5E5E5"> engineer</font>

616
00:26:44,600 --> 00:26:50,409
did<font color="#E5E5E5"> so he found out of date</font><font color="#CCCCCC"> firmware and</font>

617
00:26:47,800 --> 00:26:56,240
found remote code execution there and

618
00:26:50,410 --> 00:26:59,570
were<font color="#E5E5E5"> able to exploit it via bluetooth</font><font color="#CCCCCC"> so</font>

619
00:26:56,240 --> 00:27:01,970
in the<font color="#E5E5E5"> end we got a root access to web</font>

620
00:26:59,570 --> 00:27:03,560
<font color="#CCCCCC">bluetooth on the reader which was pretty</font>

621
00:27:01,970 --> 00:27:07,910
<font color="#E5E5E5">good</font><font color="#CCCCCC"> because initially</font><font color="#E5E5E5"> we didn't expect</font>

622
00:27:03,560 --> 00:27:10,730
anything<font color="#E5E5E5"> like that</font><font color="#CCCCCC"> white is a</font><font color="#E5E5E5"> Holy Grail</font>

623
00:27:07,910 --> 00:27:13,580
<font color="#E5E5E5">to get a full control over</font><font color="#CCCCCC"> mobile</font>

624
00:27:10,730 --> 00:27:17,210
point-of-sale terminal<font color="#E5E5E5"> one of my</font>

625
00:27:13,580 --> 00:27:19,490
favorite case is when in 2014 it was

626
00:27:17,210 --> 00:27:22,580
very unusual<font color="#E5E5E5"> type of fraud in Brazil</font>

627
00:27:19,490 --> 00:27:24,800
when hackers used infected mobile

628
00:27:22,580 --> 00:27:28,720
point-of-sale<font color="#E5E5E5"> probably the in fact</font><font color="#CCCCCC"> they</font>

629
00:27:24,800 --> 00:27:31,760
pretty much<font color="#E5E5E5"> the same way as we did and</font>

630
00:27:28,720 --> 00:27:34,550
carried out fraudulent transactions with

631
00:27:31,760 --> 00:27:37,730
stolen<font color="#CCCCCC"> truck</font><font color="#E5E5E5"> to data but the problem was</font>

632
00:27:34,550 --> 00:27:40,580
that<font color="#E5E5E5"> even that they sent only track to</font>

633
00:27:37,730 --> 00:27:42,680
data inside of payment information

634
00:27:40,580 --> 00:27:45,230
they sent they said to<font color="#CCCCCC"> bank</font><font color="#E5E5E5"> that</font>

635
00:27:42,680 --> 00:27:47,690
operations were<font color="#CCCCCC"> Chip and PIN</font><font color="#E5E5E5"> and the</font>

636
00:27:45,230 --> 00:27:49,820
most curious part was that genuine cars

637
00:27:47,690 --> 00:27:51,920
<font color="#CCCCCC">didn't</font><font color="#E5E5E5"> even have Chip and PIN</font><font color="#CCCCCC"> onboard</font>

638
00:27:49,820 --> 00:27:54,560
chip on board<font color="#E5E5E5"> which means</font><font color="#CCCCCC"> that's how</font>

639
00:27:51,920 --> 00:27:56,830
<font color="#CCCCCC">basically</font><font color="#E5E5E5"> Bank figured out that it was</font>

640
00:27:54,560 --> 00:27:59,870
<font color="#CCCCCC">just a fraud</font>

641
00:27:56,830 --> 00:28:02,179
next of<font color="#CCCCCC"> course we can start to collect</font>

642
00:27:59,870 --> 00:28:05,330
<font color="#E5E5E5">track to data before to be</font><font color="#CCCCCC"> encrypted on</font>

643
00:28:02,180 --> 00:28:08,060
the reader as<font color="#E5E5E5"> well as tried to intercept</font>

644
00:28:05,330 --> 00:28:08,300
<font color="#CCCCCC">pin codes</font><font color="#E5E5E5"> and encrypted from</font><font color="#CCCCCC"> Chip and</font>

645
00:28:08,060 --> 00:28:13,040
<font color="#CCCCCC">PIN</font>

646
00:28:08,300 --> 00:28:14,810
<font color="#E5E5E5">so how to do this</font><font color="#CCCCCC"> if you well</font>

647
00:28:13,040 --> 00:28:17,300
mobile point-of-sale terminals work

648
00:28:14,810 --> 00:28:20,629
pretty<font color="#CCCCCC"> much</font><font color="#E5E5E5"> the same way as traditional</font>

649
00:28:17,300 --> 00:28:23,120
terminals or ATMs so<font color="#CCCCCC"> pin pad has two</font>

650
00:28:20,630 --> 00:28:26,570
<font color="#E5E5E5">modes</font><font color="#CCCCCC"> encrypted mode and plaintext mode</font>

651
00:28:23,120 --> 00:28:28,340
and if you get<font color="#E5E5E5"> control</font><font color="#CCCCCC"> over a binary</font>

652
00:28:26,570 --> 00:28:30,050
file which is responsible for switching

653
00:28:28,340 --> 00:28:31,580
<font color="#CCCCCC">between</font><font color="#E5E5E5"> these two modes it can</font>

654
00:28:30,050 --> 00:28:34,940
manipulate this information and

655
00:28:31,580 --> 00:28:39,470
<font color="#E5E5E5">basically force a customer to use to</font>

656
00:28:34,940 --> 00:28:42,230
send pin code unencrypted<font color="#CCCCCC"> and finally</font>

657
00:28:39,470 --> 00:28:44,600
this small device is<font color="#CCCCCC"> very useful to</font>

658
00:28:42,230 --> 00:28:47,480
understand how payment process works how

659
00:28:44,600 --> 00:28:49,370
payment researchers were working and to

660
00:28:47,480 --> 00:28:51,709
make your own payment research so

661
00:28:49,370 --> 00:28:53,998
basically<font color="#E5E5E5"> exactly what we</font>

662
00:28:51,709 --> 00:28:56,429
last problem<font color="#E5E5E5"> is that how to keep</font>

663
00:28:53,999 --> 00:28:58,739
persistence on a device<font color="#E5E5E5"> because</font><font color="#CCCCCC"> for</font>

664
00:28:56,429 --> 00:29:01,440
<font color="#CCCCCC">example in our case</font><font color="#E5E5E5"> device after</font>

665
00:28:58,739 --> 00:29:04,909
rebooting were checking their own

666
00:29:01,440 --> 00:29:07,979
integrity<font color="#E5E5E5"> and</font><font color="#CCCCCC"> we're</font><font color="#E5E5E5"> not allowed to</font><font color="#CCCCCC"> use</font>

667
00:29:04,909 --> 00:29:10,769
<font color="#E5E5E5">random files in a file system so we</font>

668
00:29:07,979 --> 00:29:12,809
bypass this<font color="#E5E5E5"> bypass this check and next</font>

669
00:29:10,769 --> 00:29:15,869
we found another<font color="#E5E5E5"> problem that mobile</font>

670
00:29:12,809 --> 00:29:18,449
application also<font color="#CCCCCC"> has to check out of</font>

671
00:29:15,869 --> 00:29:21,448
date firmware and should<font color="#E5E5E5"> not allow</font><font color="#CCCCCC"> the</font>

672
00:29:18,449 --> 00:29:24,139
use reader<font color="#E5E5E5"> without a date film we're in</font>

673
00:29:21,449 --> 00:29:26,849
the ecosystem of mobile point of cell

674
00:29:24,139 --> 00:29:30,508
but the problem was<font color="#CCCCCC"> that this check was</font>

675
00:29:26,849 --> 00:29:33,089
bypassed<font color="#E5E5E5"> in a very very silly way let's</font>

676
00:29:30,509 --> 00:29:36,479
say so all you had to do is<font color="#E5E5E5"> just to drop</font>

677
00:29:33,089 --> 00:29:38,698
<font color="#E5E5E5">a packet with request or response from a</font>

678
00:29:36,479 --> 00:29:42,539
mobile<font color="#E5E5E5"> phone to a server about version</font>

679
00:29:38,699 --> 00:29:44,789
<font color="#CCCCCC">of firmware</font><font color="#E5E5E5"> and mobile phone</font><font color="#CCCCCC"> like two to</font>

680
00:29:42,539 --> 00:29:46,379
<font color="#CCCCCC">three</font><font color="#E5E5E5"> seconds of timeout and like our</font>

681
00:29:44,789 --> 00:29:49,679
<font color="#CCCCCC">Kaden I don't know what film were</font>

682
00:29:46,379 --> 00:29:51,418
version<font color="#CCCCCC"> ISM</font><font color="#E5E5E5"> I'm ready to work which</font>

683
00:29:49,679 --> 00:29:54,149
<font color="#E5E5E5">means you can use this infected device</font>

684
00:29:51,419 --> 00:29:58,289
in the ecosystem<font color="#CCCCCC"> for a long long</font><font color="#E5E5E5"> time</font><font color="#CCCCCC"> so</font>

685
00:29:54,149 --> 00:30:00,809
what for<font color="#CCCCCC"> in this scenario</font><font color="#E5E5E5"> you can</font>

686
00:29:58,289 --> 00:30:03,209
imagine that fraudulent customer can

687
00:30:00,809 --> 00:30:05,219
come up<font color="#CCCCCC"> to merchant get a</font><font color="#E5E5E5"> physical</font>

688
00:30:03,209 --> 00:30:07,769
<font color="#E5E5E5">access to reader for a couple seconds</font>

689
00:30:05,219 --> 00:30:10,440
<font color="#E5E5E5">switch</font><font color="#CCCCCC"> on parent mode because in</font><font color="#E5E5E5"> this</font>

690
00:30:07,769 --> 00:30:12,749
<font color="#E5E5E5">case he had to</font><font color="#CCCCCC"> do he had to</font><font color="#E5E5E5"> enable</font><font color="#CCCCCC"> a</font>

691
00:30:10,440 --> 00:30:16,139
<font color="#CCCCCC">remote</font><font color="#E5E5E5"> connect his own malicious device</font>

692
00:30:12,749 --> 00:30:21,329
and downgrade the<font color="#CCCCCC"> finger and after that</font>

693
00:30:16,139 --> 00:30:24,599
he could send an exploit<font color="#E5E5E5"> to get to get</font>

694
00:30:21,329 --> 00:30:26,399
device infected<font color="#E5E5E5"> bypassed updating</font>

695
00:30:24,599 --> 00:30:28,349
<font color="#CCCCCC">process after rebooting</font><font color="#E5E5E5"> and start to</font>

696
00:30:26,399 --> 00:30:33,168
collect<font color="#E5E5E5"> track to data for example here</font>

697
00:30:28,349 --> 00:30:36,089
for a long<font color="#E5E5E5"> long</font><font color="#CCCCCC"> time</font><font color="#E5E5E5"> in merchants hands</font>

698
00:30:33,169 --> 00:30:39,029
<font color="#CCCCCC">well in this case what</font><font color="#E5E5E5"> we recommend</font><font color="#CCCCCC"> to</font>

699
00:30:36,089 --> 00:30:40,979
vendors is obviously first<font color="#E5E5E5"> of all it</font><font color="#CCCCCC"> is</font>

700
00:30:39,029 --> 00:30:42,869
very<font color="#E5E5E5"> important to</font><font color="#CCCCCC"> control that your</font>

701
00:30:40,979 --> 00:30:45,899
customers should not<font color="#E5E5E5"> use out-of-date</font>

702
00:30:42,869 --> 00:30:47,849
firmware<font color="#E5E5E5"> as well as to allow them to</font>

703
00:30:45,899 --> 00:30:50,908
downgrade<font color="#CCCCCC"> fin wear because it</font><font color="#E5E5E5"> sounds</font>

704
00:30:47,849 --> 00:30:52,979
completely<font color="#E5E5E5"> unnecessary</font><font color="#CCCCCC"> right what we</font>

705
00:30:50,909 --> 00:30:55,109
also found in the<font color="#E5E5E5"> market is</font><font color="#CCCCCC"> very unusual</font>

706
00:30:52,979 --> 00:30:57,779
case when one particular vendor

707
00:30:55,109 --> 00:31:00,629
<font color="#E5E5E5">checked potentially infected devices and</font>

708
00:30:57,779 --> 00:31:03,779
if devices<font color="#E5E5E5"> potentially infected devices</font>

709
00:31:00,629 --> 00:31:05,879
<font color="#E5E5E5">were</font><font color="#CCCCCC"> connected with each</font><font color="#E5E5E5"> other</font><font color="#CCCCCC"> even</font><font color="#E5E5E5"> once</font>

710
00:31:03,779 --> 00:31:09,200
like mobile phone with<font color="#CCCCCC"> a</font><font color="#E5E5E5"> reader or</font>

711
00:31:05,879 --> 00:31:12,090
<font color="#CCCCCC">reader with account</font><font color="#E5E5E5"> all these entities</font>

712
00:31:09,200 --> 00:31:14,969
<font color="#E5E5E5">appeared to be blocked and potentially</font>

713
00:31:12,090 --> 00:31:17,968
infected<font color="#E5E5E5"> so this is very good</font><font color="#CCCCCC"> practice</font>

714
00:31:14,969 --> 00:31:19,919
that<font color="#CCCCCC"> we found on</font><font color="#E5E5E5"> the market and of</font>

715
00:31:17,969 --> 00:31:21,869
course finally<font color="#E5E5E5"> as soon as we got a</font>

716
00:31:19,919 --> 00:31:24,179
remote<font color="#E5E5E5"> code execution on the reader</font><font color="#CCCCCC"> you</font>

717
00:31:21,869 --> 00:31:32,399
<font color="#CCCCCC">could</font><font color="#E5E5E5"> not</font><font color="#CCCCCC"> resist to put more cats on the</font>

718
00:31:24,179 --> 00:31:35,429
<font color="#E5E5E5">Internet and finally about hardware yeah</font>

719
00:31:32,399 --> 00:31:39,238
surprisingly<font color="#CCCCCC"> for these</font><font color="#E5E5E5"> devices which</font>

720
00:31:35,429 --> 00:31:41,460
cost like<font color="#CCCCCC"> fifty</font><font color="#E5E5E5"> pounds or less an actual</font>

721
00:31:39,239 --> 00:31:46,799
<font color="#E5E5E5">physical level of security</font><font color="#CCCCCC"> is pretty</font>

722
00:31:41,460 --> 00:31:49,320
good<font color="#CCCCCC"> because</font><font color="#E5E5E5"> most of them had some anti</font>

723
00:31:46,799 --> 00:31:52,649
tampering mechanisms<font color="#E5E5E5"> like anti tampering</font>

724
00:31:49,320 --> 00:31:55,918
circuit protection<font color="#E5E5E5"> against which will</font>

725
00:31:52,649 --> 00:31:58,498
control against protect system against

726
00:31:55,919 --> 00:32:02,159
<font color="#CCCCCC">real in opening sometimes even pressure</font>

727
00:31:58,499 --> 00:32:04,499
sensors<font color="#E5E5E5"> and the last problem is that</font>

728
00:32:02,159 --> 00:32:06,869
even<font color="#CCCCCC"> if</font><font color="#E5E5E5"> you will open the device without</font>

729
00:32:04,499 --> 00:32:09,330
<font color="#E5E5E5">alerting often to tampering mechanisms</font>

730
00:32:06,869 --> 00:32:12,029
all you'll<font color="#CCCCCC"> find is only</font><font color="#E5E5E5"> set of</font>

731
00:32:09,330 --> 00:32:14,609
<font color="#E5E5E5">proprietary protocols sometimes no</font><font color="#CCCCCC"> GTECH</font>

732
00:32:12,029 --> 00:32:16,499
which means that<font color="#E5E5E5"> without</font><font color="#CCCCCC"> developers</font>

733
00:32:14,609 --> 00:32:18,928
documentation without<font color="#E5E5E5"> developer</font>

734
00:32:16,499 --> 00:32:24,629
certificates<font color="#CCCCCC"> you hardly will get</font>

735
00:32:18,929 --> 00:32:29,219
<font color="#CCCCCC">anything so this</font><font color="#E5E5E5"> brings us</font><font color="#CCCCCC"> on to our</font>

736
00:32:24,629 --> 00:32:31,019
secondary factors as we mentioned in<font color="#E5E5E5"> the</font>

737
00:32:29,219 --> 00:32:34,049
past there are<font color="#E5E5E5"> significant differences</font>

738
00:32:31,019 --> 00:32:35,759
<font color="#E5E5E5">between the vendors that</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> looked at so</font>

739
00:32:34,049 --> 00:32:38,729
some of<font color="#E5E5E5"> the vendors place primary</font>

740
00:32:35,759 --> 00:32:41,129
emphasis on the onboarding checks others

741
00:32:38,729 --> 00:32:42,960
<font color="#E5E5E5">instead prefer to focus on transaction</font>

742
00:32:41,129 --> 00:32:46,799
monitoring such as the<font color="#CCCCCC"> correlation that</font>

743
00:32:42,960 --> 00:32:48,989
<font color="#CCCCCC">Tim mentioned there are also significant</font>

744
00:32:46,799 --> 00:32:49,908
differences<font color="#E5E5E5"> depending on the geographic</font>

745
00:32:48,989 --> 00:32:52,440
<font color="#CCCCCC">location</font>

746
00:32:49,909 --> 00:32:54,960
generally speaking we<font color="#CCCCCC"> noticed</font><font color="#E5E5E5"> that</font>

747
00:32:52,440 --> 00:32:58,969
readers and accounts in Europe<font color="#E5E5E5"> were far</font>

748
00:32:54,960 --> 00:33:01,739
<font color="#CCCCCC">more restrictive</font><font color="#E5E5E5"> than those in u.s.</font>

749
00:32:58,969 --> 00:33:03,869
<font color="#E5E5E5">lastly we've we were rarely disappointed</font>

750
00:33:01,739 --> 00:33:06,719
in fact to find that most<font color="#E5E5E5"> of the vendors</font>

751
00:33:03,869 --> 00:33:09,330
<font color="#CCCCCC">that</font><font color="#E5E5E5"> we looked at chose not to protect</font>

752
00:33:06,719 --> 00:33:11,429
<font color="#E5E5E5">the mobile ecosystem</font><font color="#CCCCCC"> one of the</font><font color="#E5E5E5"> vendors</font>

753
00:33:09,330 --> 00:33:13,379
that<font color="#E5E5E5"> we spoke to mentioned that they</font>

754
00:33:11,429 --> 00:33:14,839
chose<font color="#E5E5E5"> to chosen</font><font color="#CCCCCC"> to do this because they</font>

755
00:33:13,379 --> 00:33:16,860
considered this environment already

756
00:33:14,839 --> 00:33:18,510
<font color="#E5E5E5">compromised</font>

757
00:33:16,860 --> 00:33:21,419
problem with<font color="#E5E5E5"> this kind of approach</font><font color="#CCCCCC"> is</font>

758
00:33:18,510 --> 00:33:23,040
<font color="#CCCCCC">that by providing access</font><font color="#E5E5E5"> to some of</font>

759
00:33:21,420 --> 00:33:27,150
these<font color="#CCCCCC"> features in the mobile</font><font color="#E5E5E5"> ecosystem</font>

760
00:33:23,040 --> 00:33:30,049
<font color="#CCCCCC">it means that good guys like us and bad</font>

761
00:33:27,150 --> 00:33:34,370
guys can reverse the functions<font color="#CCCCCC"> of</font><font color="#E5E5E5"> your</font>

762
00:33:30,049 --> 00:33:36,929
application<font color="#CCCCCC"> and your reader much</font><font color="#E5E5E5"> easier</font>

763
00:33:34,370 --> 00:33:39,290
so this table<font color="#E5E5E5"> represents a broad</font>

764
00:33:36,929 --> 00:33:43,740
overview<font color="#E5E5E5"> of all the</font><font color="#CCCCCC"> different readers</font>

765
00:33:39,290 --> 00:33:46,409
manufacturers vendors and<font color="#E5E5E5"> the assessment</font>

766
00:33:43,740 --> 00:33:49,140
points that we look down obviously this

767
00:33:46,410 --> 00:33:52,470
marketplace places an emphasis on<font color="#E5E5E5"> ease</font>

768
00:33:49,140 --> 00:33:55,020
<font color="#E5E5E5">of enrollment but it doesn't take</font><font color="#CCCCCC"> into</font>

769
00:33:52,470 --> 00:33:58,020
account<font color="#E5E5E5"> that in fact security should be</font>

770
00:33:55,020 --> 00:34:01,500
incredibly<font color="#E5E5E5"> high in all areas in order to</font>

771
00:33:58,020 --> 00:34:03,030
<font color="#CCCCCC">counteract the incredibly</font><font color="#E5E5E5"> low card low</font>

772
00:34:01,500 --> 00:34:09,899
barriers for processing cardholder

773
00:34:03,030 --> 00:34:12,480
payments so a new unique opportunity

774
00:34:09,899 --> 00:34:14,600
presented itself<font color="#E5E5E5"> during this project we</font>

775
00:34:12,480 --> 00:34:17,940
noted<font color="#CCCCCC"> that these particular</font><font color="#E5E5E5"> devices</font>

776
00:34:14,600 --> 00:34:19,618
would allow us<font color="#CCCCCC"> to carry out the</font><font color="#E5E5E5"> kind of</font>

777
00:34:17,940 --> 00:34:21,659
activities we would normally carry out

778
00:34:19,619 --> 00:34:23,850
during red teaming but<font color="#E5E5E5"> outside of the</font>

779
00:34:21,659 --> 00:34:25,950
scope of<font color="#E5E5E5"> a normal customer engagements</font>

780
00:34:23,850 --> 00:34:28,500
<font color="#E5E5E5">so you don't have to work in a financial</font>

781
00:34:25,949 --> 00:34:30,239
organization<font color="#E5E5E5"> you can simply open</font><font color="#CCCCCC"> an</font>

782
00:34:28,500 --> 00:34:33,570
account<font color="#E5E5E5"> and get access to one</font><font color="#CCCCCC"> of these</font>

783
00:34:30,239 --> 00:34:35,699
<font color="#E5E5E5">readers this means that all</font><font color="#CCCCCC"> of us</font><font color="#E5E5E5"> in</font>

784
00:34:33,570 --> 00:34:38,040
this room here<font color="#E5E5E5"> can start to carry out</font>

785
00:34:35,699 --> 00:34:39,750
<font color="#CCCCCC">our own payment research we</font><font color="#E5E5E5"> can also</font>

786
00:34:38,040 --> 00:34:41,489
<font color="#E5E5E5">just confirm our understanding of</font>

787
00:34:39,750 --> 00:34:46,409
existing research or<font color="#CCCCCC"> just how a</font>

788
00:34:41,489 --> 00:34:48,330
transaction works in practice<font color="#E5E5E5"> so what</font>

789
00:34:46,409 --> 00:34:50,730
does this mean<font color="#CCCCCC"> for assessing risk for</font>

790
00:34:48,330 --> 00:34:52,619
someone's business<font color="#E5E5E5"> it means that if you</font>

791
00:34:50,730 --> 00:34:54,710
<font color="#E5E5E5">process cardholder payments you</font>

792
00:34:52,619 --> 00:34:56,730
shouldn't carry out swipe transactions

793
00:34:54,710 --> 00:34:59,160
beyond the vulnerability that<font color="#CCCCCC"> we</font>

794
00:34:56,730 --> 00:35:01,410
mentioned<font color="#E5E5E5"> that's present in many of</font>

795
00:34:59,160 --> 00:35:04,500
<font color="#E5E5E5">these readers this protocol is</font>

796
00:35:01,410 --> 00:35:07,020
deprecated<font color="#CCCCCC"> so this means again that the</font>

797
00:35:04,500 --> 00:35:08,609
<font color="#CCCCCC">magstripe</font><font color="#E5E5E5"> can be cloned a signature can</font>

798
00:35:07,020 --> 00:35:11,250
<font color="#CCCCCC">be forged</font><font color="#E5E5E5"> and of course there's no</font>

799
00:35:08,609 --> 00:35:14,940
signing<font color="#CCCCCC"> the transaction so as a merchant</font>

800
00:35:11,250 --> 00:35:16,980
<font color="#CCCCCC">every time you take a swipe transaction</font>

801
00:35:14,940 --> 00:35:20,130
<font color="#E5E5E5">you're actually accepting</font><font color="#CCCCCC"> liability for</font>

802
00:35:16,980 --> 00:35:21,869
the full value<font color="#CCCCCC"> of the transaction</font><font color="#E5E5E5"> but</font>

803
00:35:20,130 --> 00:35:23,609
<font color="#E5E5E5">more broadly speaking it</font><font color="#CCCCCC"> means for</font><font color="#E5E5E5"> other</font>

804
00:35:21,869 --> 00:35:25,740
industries<font color="#E5E5E5"> we've seen over the last few</font>

805
00:35:23,609 --> 00:35:27,600
<font color="#CCCCCC">years</font><font color="#E5E5E5"> that embedded systems or IOT</font>

806
00:35:25,740 --> 00:35:30,359
products have become<font color="#CCCCCC"> incredibly popular</font>

807
00:35:27,600 --> 00:35:33,420
with<font color="#E5E5E5"> both consumers</font><font color="#CCCCCC"> and businesses</font>

808
00:35:30,360 --> 00:35:35,790
<font color="#E5E5E5">but we need to understand that the level</font>

809
00:35:33,420 --> 00:35:37,500
of<font color="#E5E5E5"> security testing in the development</font>

810
00:35:35,790 --> 00:35:39,630
<font color="#E5E5E5">of these products is probably not going</font>

811
00:35:37,500 --> 00:35:40,980
<font color="#E5E5E5">to be that great especially</font><font color="#CCCCCC"> when most of</font>

812
00:35:39,630 --> 00:35:43,470
the companies<font color="#CCCCCC"> have only been</font><font color="#E5E5E5"> around</font><font color="#CCCCCC"> for</font>

813
00:35:40,980 --> 00:35:45,120
<font color="#CCCCCC">a couple of years</font><font color="#E5E5E5"> and many</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> these</font>

814
00:35:43,470 --> 00:35:48,810
products retail<font color="#E5E5E5"> for less than a couple</font>

815
00:35:45,120 --> 00:35:50,940
<font color="#E5E5E5">of</font><font color="#CCCCCC"> hundred dollars so at the</font><font color="#E5E5E5"> beginning</font>

816
00:35:48,810 --> 00:35:53,070
<font color="#E5E5E5">and beginning of this project we</font><font color="#CCCCCC"> started</font>

817
00:35:50,940 --> 00:35:54,780
with just<font color="#E5E5E5"> two card readers but this</font>

818
00:35:53,070 --> 00:35:57,390
quickly<font color="#E5E5E5"> grew into</font><font color="#CCCCCC"> a very large project</font>

819
00:35:54,780 --> 00:36:01,680
<font color="#E5E5E5">encompassing seven readers</font><font color="#CCCCCC"> four vendors</font>

820
00:35:57,390 --> 00:36:03,600
<font color="#E5E5E5">and two regions so what did we find</font><font color="#CCCCCC"> we</font>

821
00:36:01,680 --> 00:36:05,790
found<font color="#CCCCCC"> that</font><font color="#E5E5E5"> over half of all of the</font>

822
00:36:03,600 --> 00:36:08,400
readers<font color="#E5E5E5"> are affected by some attack</font>

823
00:36:05,790 --> 00:36:09,779
vector or some vulnerability and all of

824
00:36:08,400 --> 00:36:12,840
the<font color="#E5E5E5"> vendors that we looked at were</font>

825
00:36:09,780 --> 00:36:14,610
affected by our findings we found that

826
00:36:12,840 --> 00:36:17,910
for<font color="#CCCCCC"> some of the readers for</font><font color="#E5E5E5"> I settle for</font>

827
00:36:14,610 --> 00:36:20,700
<font color="#E5E5E5">some up and for the</font><font color="#CCCCCC"> mirror reader</font><font color="#E5E5E5"> that</font>

828
00:36:17,910 --> 00:36:23,700
we can send arbitrary<font color="#E5E5E5"> commands to the</font>

829
00:36:20,700 --> 00:36:25,109
<font color="#E5E5E5">display of these devices this means that</font>

830
00:36:23,700 --> 00:36:28,080
a fortunate merchant could easily

831
00:36:25,110 --> 00:36:30,480
socially engineer a<font color="#CCCCCC"> card holder to carry</font>

832
00:36:28,080 --> 00:36:35,460
out additional<font color="#E5E5E5"> payments</font><font color="#CCCCCC"> as</font><font color="#E5E5E5"> we mentioned</font>

833
00:36:30,480 --> 00:36:37,020
<font color="#E5E5E5">to carry out less secure payments we</font>

834
00:36:35,460 --> 00:36:39,540
<font color="#E5E5E5">also mentioned that for</font><font color="#CCCCCC"> certain</font>

835
00:36:37,020 --> 00:36:43,290
transaction types so for<font color="#E5E5E5"> magnetic stripe</font>

836
00:36:39,540 --> 00:36:45,300
for the sum up and and<font color="#E5E5E5"> Isetta reader it</font>

837
00:36:43,290 --> 00:36:47,580
was possible<font color="#CCCCCC"> for us to modify the</font><font color="#E5E5E5"> value</font>

838
00:36:45,300 --> 00:36:49,860
of the transaction<font color="#CCCCCC"> so this means we can</font>

839
00:36:47,580 --> 00:36:52,470
<font color="#E5E5E5">send a much lower value amount to the</font>

840
00:36:49,860 --> 00:36:54,240
screen<font color="#E5E5E5"> of the</font><font color="#CCCCCC"> reader</font><font color="#E5E5E5"> and in fact</font><font color="#CCCCCC"> force</font>

841
00:36:52,470 --> 00:36:59,009
the<font color="#E5E5E5"> cardholder to authorize a much</font>

842
00:36:54,240 --> 00:37:00,990
<font color="#E5E5E5">higher value we also found a remote code</font>

843
00:36:59,010 --> 00:37:03,180
execution vulnerability in<font color="#CCCCCC"> the mirror m0</font>

844
00:37:00,990 --> 00:37:06,270
<font color="#CCCCCC">ten reader</font><font color="#E5E5E5"> which was present with a</font>

845
00:37:03,180 --> 00:37:08,250
number<font color="#E5E5E5"> of the vendors we were surprised</font>

846
00:37:06,270 --> 00:37:10,259
<font color="#E5E5E5">to</font><font color="#CCCCCC"> find that the security mechanisms in</font>

847
00:37:08,250 --> 00:37:13,500
these products are relatively high given

848
00:37:10,260 --> 00:37:15,210
<font color="#CCCCCC">the value of these products</font><font color="#E5E5E5"> and a little</font>

849
00:37:13,500 --> 00:37:19,020
bit disappointed to<font color="#CCCCCC"> find</font><font color="#E5E5E5"> that the mobile</font>

850
00:37:15,210 --> 00:37:22,140
<font color="#CCCCCC">ecosystem wasn't</font><font color="#E5E5E5"> very well protected so</font>

851
00:37:19,020 --> 00:37:23,940
this brings<font color="#E5E5E5"> us onto our conclusions for</font>

852
00:37:22,140 --> 00:37:26,520
<font color="#E5E5E5">manufacturers we recommend that you</font>

853
00:37:23,940 --> 00:37:29,070
implement strong security practices in

854
00:37:26,520 --> 00:37:30,720
the<font color="#E5E5E5"> development</font><font color="#CCCCCC"> process we can see clear</font>

855
00:37:29,070 --> 00:37:33,000
evidence<font color="#CCCCCC"> of this in the physical</font>

856
00:37:30,720 --> 00:37:34,799
<font color="#E5E5E5">security mechanisms but we don't think</font>

857
00:37:33,000 --> 00:37:38,790
that<font color="#E5E5E5"> the</font><font color="#CCCCCC"> ecosystem is considered as a</font>

858
00:37:34,800 --> 00:37:40,560
<font color="#E5E5E5">whole for many of these vendors you</font>

859
00:37:38,790 --> 00:37:42,210
should use a bluetooth pairing mode that

860
00:37:40,560 --> 00:37:44,400
visually confirms that the correct

861
00:37:42,210 --> 00:37:48,450
device<font color="#E5E5E5"> and correct</font>

862
00:37:44,400 --> 00:37:51,120
correct phone have been<font color="#E5E5E5"> paired it's</font>

863
00:37:48,450 --> 00:37:53,730
<font color="#E5E5E5">really important to control the signing</font>

864
00:37:51,120 --> 00:37:57,060
of<font color="#CCCCCC"> firmware and to encrypt firmware so</font>

865
00:37:53,730 --> 00:38:00,060
you can prevent interception fire

866
00:37:57,060 --> 00:38:02,490
sniffing or prevent modification of the

867
00:38:00,060 --> 00:38:04,410
firmware itself and just an important

868
00:38:02,490 --> 00:38:06,689
note again about<font color="#E5E5E5"> Bluetooth</font><font color="#CCCCCC"> there's no</font>

869
00:38:04,410 --> 00:38:08,399
user authentication<font color="#E5E5E5"> or input</font>

870
00:38:06,690 --> 00:38:12,750
sanitization so you have to<font color="#E5E5E5"> consider</font>

871
00:38:08,400 --> 00:38:14,400
this at the application level<font color="#E5E5E5"> for</font>

872
00:38:12,750 --> 00:38:17,040
vendors that<font color="#E5E5E5"> we recommend that</font><font color="#CCCCCC"> you don't</font>

873
00:38:14,400 --> 00:38:19,890
<font color="#E5E5E5">use deprecated protocols sometimes this</font>

874
00:38:17,040 --> 00:38:21,540
<font color="#E5E5E5">is outside of the</font><font color="#CCCCCC"> scope</font><font color="#E5E5E5"> of a vendor in</font>

875
00:38:19,890 --> 00:38:23,790
which case you could speak to<font color="#CCCCCC"> the</font>

876
00:38:21,540 --> 00:38:25,920
manufacturer or at least ask them to

877
00:38:23,790 --> 00:38:27,930
provide<font color="#CCCCCC"> you with</font><font color="#E5E5E5"> features which help you</font>

878
00:38:25,920 --> 00:38:30,810
<font color="#CCCCCC">to protect</font><font color="#E5E5E5"> against some of the issues</font>

879
00:38:27,930 --> 00:38:32,460
<font color="#CCCCCC">that we've discussed today</font><font color="#E5E5E5"> you should</font>

880
00:38:30,810 --> 00:38:34,440
use<font color="#E5E5E5"> preventative monitoring as best</font>

881
00:38:32,460 --> 00:38:36,720
practice<font color="#E5E5E5"> so this means looking for</font>

882
00:38:34,440 --> 00:38:38,430
anomalies<font color="#E5E5E5"> in transactions and using</font>

883
00:38:36,720 --> 00:38:40,350
things like correlation which<font color="#CCCCCC"> is a</font>

884
00:38:38,430 --> 00:38:43,140
highly<font color="#CCCCCC"> effective way of identifying</font>

885
00:38:40,350 --> 00:38:45,450
fraudulent<font color="#E5E5E5"> merchants and of course</font>

886
00:38:43,140 --> 00:38:46,529
prohibit<font color="#E5E5E5"> downgrades because one</font><font color="#CCCCCC"> of the</font>

887
00:38:45,450 --> 00:38:49,770
vulnerabilities that<font color="#CCCCCC"> we've mentioned</font>

888
00:38:46,530 --> 00:38:53,160
<font color="#CCCCCC">today</font><font color="#E5E5E5"> is specifically around</font><font color="#CCCCCC"> downgrading</font>

889
00:38:49,770 --> 00:38:55,290
the firmware on<font color="#CCCCCC"> their reader place more</font>

890
00:38:53,160 --> 00:38:58,470
<font color="#CCCCCC">emphasis on</font><font color="#E5E5E5"> enrollment checks purely</font>

891
00:38:55,290 --> 00:39:04,050
this is the<font color="#E5E5E5"> gateway to</font><font color="#CCCCCC"> your environment</font>

892
00:38:58,470 --> 00:39:05,700
<font color="#E5E5E5">so it's very important to do this for</font>

893
00:39:04,050 --> 00:39:09,180
merchants we recommend that<font color="#E5E5E5"> you control</font>

894
00:39:05,700 --> 00:39:10,649
<font color="#CCCCCC">physical access to the devices</font><font color="#E5E5E5"> this is</font>

895
00:39:09,180 --> 00:39:12,960
because<font color="#E5E5E5"> many of the attacks and</font>

896
00:39:10,650 --> 00:39:14,850
vulnerabilities we've mentioned<font color="#E5E5E5"> involves</font>

897
00:39:12,960 --> 00:39:18,750
some<font color="#CCCCCC"> level of</font><font color="#E5E5E5"> proximity in order to</font>

898
00:39:14,850 --> 00:39:20,190
carry<font color="#CCCCCC"> out the attacks if</font><font color="#E5E5E5"> at all possible</font>

899
00:39:18,750 --> 00:39:22,560
<font color="#E5E5E5">we recommend that you don't</font><font color="#CCCCCC"> actually</font>

900
00:39:20,190 --> 00:39:24,830
take a swipe transactions<font color="#E5E5E5"> and instead</font>

901
00:39:22,560 --> 00:39:27,299
use chip and signature<font color="#E5E5E5"> or chip and pin</font>

902
00:39:24,830 --> 00:39:29,940
we've mentioned<font color="#E5E5E5"> many</font><font color="#CCCCCC"> of the reasons as</font>

903
00:39:27,300 --> 00:39:32,010
to why you should<font color="#E5E5E5"> do this because you</font>

904
00:39:29,940 --> 00:39:33,810
<font color="#E5E5E5">are accepting</font><font color="#CCCCCC"> liability for the value</font><font color="#E5E5E5"> of</font>

905
00:39:32,010 --> 00:39:36,870
<font color="#E5E5E5">the transaction every time you accept a</font>

906
00:39:33,810 --> 00:39:39,360
swipe transaction if<font color="#CCCCCC"> at</font><font color="#E5E5E5"> all</font><font color="#CCCCCC"> possible you</font>

907
00:39:36,870 --> 00:39:41,520
<font color="#CCCCCC">should try to assess the ecosystem</font><font color="#E5E5E5"> now</font>

908
00:39:39,360 --> 00:39:44,100
this<font color="#E5E5E5"> isn't very feasible for a company</font>

909
00:39:41,520 --> 00:39:46,290
which just has<font color="#CCCCCC"> one card reader</font><font color="#E5E5E5"> but there</font>

910
00:39:44,100 --> 00:39:49,529
are some<font color="#CCCCCC"> businesses which do have many</font>

911
00:39:46,290 --> 00:39:51,779
units<font color="#E5E5E5"> and you should place emphasis</font><font color="#CCCCCC"> on</font>

912
00:39:49,530 --> 00:39:54,750
choosing<font color="#E5E5E5"> a</font><font color="#CCCCCC"> vendor who protects as much</font>

913
00:39:51,780 --> 00:39:56,460
of the ecosystem as possible for card

914
00:39:54,750 --> 00:39:58,030
holders we recommend that you<font color="#CCCCCC"> don't</font>

915
00:39:56,460 --> 00:40:00,160
carry out swipe transaction

916
00:39:58,030 --> 00:40:02,320
and of course it's<font color="#CCCCCC"> just really good</font>

917
00:40:00,160 --> 00:40:07,450
practice to look at your<font color="#E5E5E5"> monthly</font>

918
00:40:02,320 --> 00:40:09,220
statement statements so we<font color="#CCCCCC"> just like to</font>

919
00:40:07,450 --> 00:40:11,169
thank<font color="#E5E5E5"> you</font><font color="#CCCCCC"> too</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> listening to the</font>

920
00:40:09,220 --> 00:40:13,089
presentation of our findings<font color="#E5E5E5"> and also</font>

921
00:40:11,170 --> 00:40:14,860
mention that<font color="#E5E5E5"> this work couldn't have</font>

922
00:40:13,090 --> 00:40:17,140
actually happened<font color="#E5E5E5"> without the help of</font>

923
00:40:14,860 --> 00:40:18,460
our colleagues<font color="#CCCCCC"> and friends</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> our team</font>

924
00:40:17,140 --> 00:40:20,100
carried out a huge<font color="#CCCCCC"> amount of work</font>

925
00:40:18,460 --> 00:40:22,510
<font color="#CCCCCC">identifying the remote code execution</font>

926
00:40:20,100 --> 00:40:25,509
vulnerability on the mirror<font color="#CCCCCC"> m0 ten</font>

927
00:40:22,510 --> 00:40:27,220
<font color="#E5E5E5">reader and our colleagues</font><font color="#CCCCCC"> alexey and</font>

928
00:40:25,510 --> 00:40:29,170
mark they helped us<font color="#E5E5E5"> to</font><font color="#CCCCCC"> look at the</font>

929
00:40:27,220 --> 00:40:31,959
internal<font color="#E5E5E5"> workings of these readers to</font>

930
00:40:29,170 --> 00:40:33,100
identify<font color="#CCCCCC"> the security mechanisms</font><font color="#E5E5E5"> so</font>

931
00:40:31,960 --> 00:40:35,660
thank you<font color="#CCCCCC"> very much if you have any</font>

932
00:40:33,100 --> 00:40:41,360
questions please<font color="#E5E5E5"> let us know</font>

933
00:40:35,660 --> 00:40:41,359
[Applause]

