1
00:00:00,030 --> 00:00:03,719
yeah hello and welcome to my<font color="#CCCCCC"> talk</font>

2
00:00:01,949 --> 00:00:06,330
breaking the industrial<font color="#CCCCCC"> Internet of</font>

3
00:00:03,720 --> 00:00:09,510
<font color="#CCCCCC">Things I'll</font><font color="#E5E5E5"> talk a bit about hacking</font>

4
00:00:06,330 --> 00:00:11,670
industrial control gateways<font color="#CCCCCC"> but first a</font>

5
00:00:09,510 --> 00:00:14,040
<font color="#CCCCCC">short introduction Who am I my name is</font>

6
00:00:11,670 --> 00:00:16,980
<font color="#E5E5E5">Thomas Roth I'm the founder of level</font>

7
00:00:14,040 --> 00:00:18,180
down<font color="#E5E5E5"> security small security consultancy</font>

8
00:00:16,980 --> 00:00:20,390
from Germany

9
00:00:18,180 --> 00:00:23,160
my main focus<font color="#E5E5E5"> is on embedded</font><font color="#CCCCCC"> devices</font>

10
00:00:20,390 --> 00:00:25,289
from<font color="#E5E5E5"> trust zone to boot loaders to</font>

11
00:00:23,160 --> 00:00:27,660
industrial systems<font color="#E5E5E5"> all kinds of stuff</font>

12
00:00:25,289 --> 00:00:29,760
<font color="#E5E5E5">and if you want to follow me on</font><font color="#CCCCCC"> Twitter</font>

13
00:00:27,660 --> 00:00:31,349
<font color="#E5E5E5">you</font><font color="#CCCCCC"> can find</font><font color="#E5E5E5"> me at stack smashing and if</font>

14
00:00:29,760 --> 00:00:35,570
you want to send<font color="#E5E5E5"> me an email feel free</font>

15
00:00:31,349 --> 00:00:38,910
to mail<font color="#E5E5E5"> to</font><font color="#CCCCCC"> Thomas</font><font color="#E5E5E5"> Roth at level down de</font>

16
00:00:35,570 --> 00:00:40,410
so before we start<font color="#E5E5E5"> all information in</font>

17
00:00:38,910 --> 00:00:42,180
this talk<font color="#E5E5E5"> is based on reverse</font>

18
00:00:40,410 --> 00:00:44,429
engineering so if there are small

19
00:00:42,180 --> 00:00:45,930
<font color="#E5E5E5">mistakes small misinterpretations I</font>

20
00:00:44,430 --> 00:00:47,850
apologize I did my best to get

21
00:00:45,930 --> 00:00:50,309
everything correct<font color="#CCCCCC"> but you know how</font><font color="#E5E5E5"> it</font>

22
00:00:47,850 --> 00:00:52,559
goes sometimes<font color="#CCCCCC"> I'm also not trying to</font>

23
00:00:50,309 --> 00:00:54,449
<font color="#E5E5E5">shame any single vendors so the vendor</font>

24
00:00:52,559 --> 00:00:57,239
selection of the devices we'll talk

25
00:00:54,449 --> 00:00:59,010
about<font color="#E5E5E5"> is completely</font><font color="#CCCCCC"> random and I think</font>

26
00:00:57,239 --> 00:01:01,858
the entire<font color="#CCCCCC"> industry has a problem</font><font color="#E5E5E5"> and</font>

27
00:00:59,010 --> 00:01:05,188
<font color="#E5E5E5">not a single</font><font color="#CCCCCC"> vendor</font><font color="#E5E5E5"> also all scripts</font>

28
00:01:01,859 --> 00:01:07,860
that were used in in the research are

29
00:01:05,188 --> 00:01:09,960
available on github<font color="#CCCCCC"> but the exploits are</font>

30
00:01:07,860 --> 00:01:11,580
currently not<font color="#E5E5E5"> kiss they're far too</font><font color="#CCCCCC"> many</font>

31
00:01:09,960 --> 00:01:15,780
devices<font color="#E5E5E5"> out there that</font><font color="#CCCCCC"> are unpatched</font>

32
00:01:11,580 --> 00:01:17,640
currently there are<font color="#E5E5E5"> some people who</font>

33
00:01:15,780 --> 00:01:19,830
talked about<font color="#E5E5E5"> the similar class of</font>

34
00:01:17,640 --> 00:01:21,030
<font color="#E5E5E5">devices previously for example mr.</font>

35
00:01:19,830 --> 00:01:23,490
<font color="#E5E5E5">Reiter white man</font>

36
00:01:21,030 --> 00:01:25,080
Patrick De Santis and maximum<font color="#CCCCCC"> rock</font><font color="#E5E5E5"> you</font>

37
00:01:23,490 --> 00:01:27,000
absolutely want<font color="#CCCCCC"> to check them out if</font>

38
00:01:25,080 --> 00:01:28,979
you're<font color="#CCCCCC"> interested in industrial security</font>

39
00:01:27,000 --> 00:01:30,420
and they have been<font color="#E5E5E5"> very helpful to me in</font>

40
00:01:28,979 --> 00:01:34,289
<font color="#CCCCCC">providing some feedback giving me</font>

41
00:01:30,420 --> 00:01:36,090
additional<font color="#E5E5E5"> information and so on so</font>

42
00:01:34,290 --> 00:01:40,799
let's talk about<font color="#E5E5E5"> the motivation for this</font>

43
00:01:36,090 --> 00:01:43,770
talk<font color="#E5E5E5"> I was doing a pen test of an</font>

44
00:01:40,799 --> 00:01:46,049
<font color="#E5E5E5">electricity provider and they showed me</font>

45
00:01:43,770 --> 00:01:47,939
<font color="#CCCCCC">all their SCADA systems they showed me</font>

46
00:01:46,049 --> 00:01:50,460
how they're<font color="#CCCCCC"> interconnected how other</font>

47
00:01:47,939 --> 00:01:53,720
substations<font color="#E5E5E5"> are connected to this big</font>

48
00:01:50,460 --> 00:01:57,000
<font color="#E5E5E5">control room and then they showed me</font>

49
00:01:53,720 --> 00:01:59,460
basically<font color="#CCCCCC"> a shelf full of tiny devices</font>

50
00:01:57,000 --> 00:02:02,009
<font color="#E5E5E5">which had a serial port on one side and</font>

51
00:01:59,460 --> 00:02:03,960
Ethernet<font color="#E5E5E5"> on the other and they were used</font>

52
00:02:02,009 --> 00:02:08,190
to<font color="#CCCCCC"> basically interconnect</font><font color="#E5E5E5"> a ton of</font>

53
00:02:03,960 --> 00:02:10,410
devices we RF<font color="#E5E5E5"> links via ethernet via GSM</font>

54
00:02:08,190 --> 00:02:12,329
and so on and they all came back<font color="#E5E5E5"> at that</font>

55
00:02:10,410 --> 00:02:13,590
single<font color="#E5E5E5"> point and I found them</font><font color="#CCCCCC"> very</font>

56
00:02:12,330 --> 00:02:15,180
interesting

57
00:02:13,590 --> 00:02:17,940
very interesting because they are<font color="#CCCCCC"> really</font>

58
00:02:15,180 --> 00:02:19,860
<font color="#CCCCCC">at</font><font color="#E5E5E5"> this place</font><font color="#CCCCCC"> between the native</font>

59
00:02:17,940 --> 00:02:23,849
protocols such<font color="#CCCCCC"> as cereal and so on and</font>

60
00:02:19,860 --> 00:02:26,099
the<font color="#CCCCCC"> internet also industrial systems are</font>

61
00:02:23,849 --> 00:02:28,319
used<font color="#E5E5E5"> as weapons nowadays so we really</font>

62
00:02:26,099 --> 00:02:31,319
need<font color="#E5E5E5"> to look at securing these devices</font>

63
00:02:28,319 --> 00:02:35,549
<font color="#E5E5E5">so we have attacks on steel plants in</font>

64
00:02:31,319 --> 00:02:37,380
Germany<font color="#CCCCCC"> we have a cyber attack on a</font>

65
00:02:35,550 --> 00:02:40,160
Saudi Arabian petrol plant which almost

66
00:02:37,380 --> 00:02:43,260
<font color="#E5E5E5">caused it to</font><font color="#CCCCCC"> explode</font><font color="#E5E5E5"> and was</font><font color="#CCCCCC"> actively</font>

67
00:02:40,160 --> 00:02:44,819
used to cause harm basically we were

68
00:02:43,260 --> 00:02:48,090
<font color="#CCCCCC">lucky that the exploit was not working</font>

69
00:02:44,819 --> 00:02:50,100
<font color="#CCCCCC">and we also have active attacks on the</font>

70
00:02:48,090 --> 00:02:52,830
<font color="#CCCCCC">par</font><font color="#E5E5E5"> grid so for example Ukraine</font><font color="#CCCCCC"> Power</font>

71
00:02:50,100 --> 00:02:55,650
<font color="#CCCCCC">Grid attack in December 2015 was</font>

72
00:02:52,830 --> 00:02:59,430
conducted<font color="#CCCCCC"> using one of the devices I'll</font>

73
00:02:55,650 --> 00:03:02,430
be talking<font color="#E5E5E5"> about today so what is</font>

74
00:02:59,430 --> 00:03:04,560
industrial<font color="#E5E5E5"> IOT</font><font color="#CCCCCC"> if we look at traditional</font>

75
00:03:02,430 --> 00:03:06,750
<font color="#E5E5E5">ICS networks</font><font color="#CCCCCC"> they're kind</font><font color="#E5E5E5"> of this</font>

76
00:03:04,560 --> 00:03:08,819
enclosed<font color="#CCCCCC"> system</font><font color="#E5E5E5"> we have for</font><font color="#CCCCCC"> example a</font>

77
00:03:06,750 --> 00:03:10,349
<font color="#CCCCCC">chemical plant you have a control room</font>

78
00:03:08,819 --> 00:03:12,780
you have<font color="#E5E5E5"> all your actors all your</font>

79
00:03:10,349 --> 00:03:15,359
sensors located<font color="#E5E5E5"> in a secure perimeter</font>

80
00:03:12,780 --> 00:03:19,200
<font color="#E5E5E5">with physical access control and so</font><font color="#CCCCCC"> on</font>

81
00:03:15,360 --> 00:03:21,329
but today<font color="#E5E5E5"> if we look at electric grids</font>

82
00:03:19,200 --> 00:03:23,399
if we look at large chemical<font color="#CCCCCC"> plants or</font>

83
00:03:21,329 --> 00:03:27,239
our large plants in general<font color="#CCCCCC"> suddenly</font>

84
00:03:23,400 --> 00:03:29,489
those kind<font color="#E5E5E5"> of segmented networks become</font>

85
00:03:27,239 --> 00:03:31,829
a very wide area<font color="#CCCCCC"> network so</font><font color="#E5E5E5"> you might</font>

86
00:03:29,489 --> 00:03:33,269
have in a case of an electricity<font color="#E5E5E5"> grid</font>

87
00:03:31,829 --> 00:03:36,150
you might have solar panels<font color="#CCCCCC"> that</font><font color="#E5E5E5"> are</font>

88
00:03:33,269 --> 00:03:38,459
<font color="#E5E5E5">remotely connected for data collection</font>

89
00:03:36,150 --> 00:03:40,470
or for control you might have some PLC's

90
00:03:38,459 --> 00:03:42,450
in your substations that<font color="#E5E5E5"> are connected</font>

91
00:03:40,470 --> 00:03:44,579
we are<font color="#E5E5E5"> some kind</font><font color="#CCCCCC"> of run to your central</font>

92
00:03:42,450 --> 00:03:46,850
control room<font color="#CCCCCC"> and there are all these</font>

93
00:03:44,579 --> 00:03:50,489
kinds of<font color="#E5E5E5"> things</font><font color="#CCCCCC"> so for example</font>

94
00:03:46,850 --> 00:03:52,950
substations<font color="#CCCCCC"> we have remote valves we</font>

95
00:03:50,489 --> 00:03:54,630
have water dams so for example<font color="#E5E5E5"> they</font>

96
00:03:52,950 --> 00:03:56,310
water them in<font color="#CCCCCC"> the city where I live</font><font color="#E5E5E5"> is</font>

97
00:03:54,630 --> 00:03:58,859
<font color="#E5E5E5">remotely controlled we have one of the</font>

98
00:03:56,310 --> 00:04:01,590
devices we're going to talk<font color="#E5E5E5"> about we</font>

99
00:03:58,859 --> 00:04:03,780
<font color="#E5E5E5">have traffic management systems we have</font>

100
00:04:01,590 --> 00:04:06,209
access<font color="#E5E5E5"> control so for example these</font>

101
00:04:03,780 --> 00:04:08,910
barriers are<font color="#E5E5E5"> often connected via such</font>

102
00:04:06,209 --> 00:04:10,530
devices and even tunnels which was kind

103
00:04:08,910 --> 00:04:12,299
of funny because I was<font color="#E5E5E5"> doing a pen test</font>

104
00:04:10,530 --> 00:04:14,549
and I asked hey I found this device<font color="#E5E5E5"> it's</font>

105
00:04:12,299 --> 00:04:17,340
vulnerable<font color="#CCCCCC"> what the hell</font><font color="#E5E5E5"> is it and they</font>

106
00:04:14,549 --> 00:04:19,739
<font color="#E5E5E5">told me it's a it's a tunnel and so it</font>

107
00:04:17,339 --> 00:04:22,048
turns out<font color="#E5E5E5"> that the ventilation system of</font>

108
00:04:19,738 --> 00:04:24,270
tunnels<font color="#E5E5E5"> is also remotely controlled and</font>

109
00:04:22,048 --> 00:04:26,330
so if you<font color="#E5E5E5"> manage</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> break</font><font color="#CCCCCC"> into this and</font>

110
00:04:24,270 --> 00:04:28,068
stop the ventilation system chances are

111
00:04:26,330 --> 00:04:33,530
that you might cause someone to

112
00:04:28,069 --> 00:04:36,110
suffocate or similar RIT so industrial

113
00:04:33,530 --> 00:04:39,198
control systems as I've mentioned before

114
00:04:36,110 --> 00:04:41,330
<font color="#E5E5E5">they used to connect different</font><font color="#CCCCCC"> protocols</font>

115
00:04:39,199 --> 00:04:43,430
to an IP network<font color="#E5E5E5"> so in the industrial</font>

116
00:04:41,330 --> 00:04:46,188
control world<font color="#E5E5E5"> you for example I have</font>

117
00:04:43,430 --> 00:04:49,250
Modbus you have rs-232 you have canvas

118
00:04:46,189 --> 00:04:51,199
as four<font color="#E5E5E5"> eight five whatever</font><font color="#CCCCCC"> and all</font>

119
00:04:49,250 --> 00:04:53,930
those<font color="#E5E5E5"> protocols somehow need to talk to</font>

120
00:04:51,199 --> 00:04:55,759
a computer<font color="#CCCCCC"> and for what</font><font color="#E5E5E5"> that use case</font>

121
00:04:53,930 --> 00:04:58,520
these industrial control gateways are

122
00:04:55,759 --> 00:05:01,340
used and<font color="#E5E5E5"> they connect via ethernet GSM</font>

123
00:04:58,520 --> 00:05:03,109
whatever and they you can basically find

124
00:05:01,340 --> 00:05:07,638
them in any larger industrial

125
00:05:03,110 --> 00:05:09,469
installation and the first<font color="#CCCCCC"> feedback I</font>

126
00:05:07,639 --> 00:05:12,080
get<font color="#E5E5E5"> when I'm going to talk to people</font>

127
00:05:09,469 --> 00:05:14,030
<font color="#CCCCCC">about the industry gateways is hey don't</font>

128
00:05:12,080 --> 00:05:16,370
<font color="#E5E5E5">worry these devices are</font><font color="#CCCCCC"> I kept a on the</font>

129
00:05:14,030 --> 00:05:19,029
secure<font color="#CCCCCC"> Network</font><font color="#E5E5E5"> whatever</font><font color="#CCCCCC"> I mean</font><font color="#E5E5E5"> how can I</font>

130
00:05:16,370 --> 00:05:22,580
device with an antenna<font color="#CCCCCC"> via get right I</font>

131
00:05:19,029 --> 00:05:25,460
mean<font color="#E5E5E5"> these devices today have Wi-Fi the</font>

132
00:05:22,580 --> 00:05:28,639
<font color="#CCCCCC">fgs and they're some proprietary radio</font>

133
00:05:25,460 --> 00:05:31,190
systems they use<font color="#E5E5E5"> Laura they basically</font>

134
00:05:28,639 --> 00:05:33,080
can do everything<font color="#E5E5E5"> and even the vendor</font>

135
00:05:31,190 --> 00:05:36,110
examples the same vendor<font color="#CCCCCC"> that</font><font color="#E5E5E5"> tells me</font>

136
00:05:33,080 --> 00:05:39,650
<font color="#E5E5E5">no these devices I adapt their examples</font>

137
00:05:36,110 --> 00:05:42,199
for example<font color="#E5E5E5"> use GPRS to remote control</font>

138
00:05:39,650 --> 00:05:44,448
valves to<font color="#E5E5E5"> remotely</font><font color="#CCCCCC"> monitor systems and</font>

139
00:05:42,199 --> 00:05:47,060
so<font color="#E5E5E5"> on so in this case from advantage and</font>

140
00:05:44,449 --> 00:05:49,279
moxa has the same examples of remote

141
00:05:47,060 --> 00:05:51,050
controlling pumps and whatever<font color="#CCCCCC"> and so</font>

142
00:05:49,279 --> 00:05:52,969
these<font color="#CCCCCC"> are not</font><font color="#E5E5E5"> only used together sensor</font>

143
00:05:51,050 --> 00:05:56,330
data<font color="#E5E5E5"> they actively used to control</font>

144
00:05:52,969 --> 00:06:02,330
<font color="#E5E5E5">things remotely</font><font color="#CCCCCC"> and so these devices are</font>

145
00:05:56,330 --> 00:06:04,068
absolutely<font color="#E5E5E5"> not</font><font color="#CCCCCC"> a gift and then if you go</font>

146
00:06:02,330 --> 00:06:06,229
on the internet<font color="#CCCCCC"> and start scanning</font><font color="#E5E5E5"> a bit</font>

147
00:06:04,069 --> 00:06:08,360
<font color="#E5E5E5">you find thousands of these devices open</font>

148
00:06:06,229 --> 00:06:10,729
on the<font color="#CCCCCC"> internet you</font><font color="#E5E5E5"> actually can find</font>

149
00:06:08,360 --> 00:06:12,229
entire network ranges almost exclusively

150
00:06:10,729 --> 00:06:15,469
filled with these<font color="#E5E5E5"> devices because they</font>

151
00:06:12,229 --> 00:06:17,930
<font color="#E5E5E5">come from industrial ISPs and most of</font>

152
00:06:15,469 --> 00:06:19,699
them are significantly outdated so for

153
00:06:17,930 --> 00:06:21,889
example on<font color="#E5E5E5"> children you can find</font><font color="#CCCCCC"> eight</font>

154
00:06:19,699 --> 00:06:25,000
<font color="#CCCCCC">thousand six hundred</font><font color="#E5E5E5"> devices</font><font color="#CCCCCC"> of just a</font>

155
00:06:21,889 --> 00:06:29,629
<font color="#E5E5E5">single type and even if they are</font><font color="#CCCCCC"> not</font>

156
00:06:25,000 --> 00:06:31,789
fully open<font color="#E5E5E5"> on the Internet the barrier</font>

157
00:06:29,629 --> 00:06:33,949
<font color="#CCCCCC">of access to them is mostly</font><font color="#E5E5E5"> very low so</font>

158
00:06:31,789 --> 00:06:35,959
you might have some cards<font color="#E5E5E5"> with public</font>

159
00:06:33,949 --> 00:06:37,550
<font color="#E5E5E5">IPS as that there there are some</font>

160
00:06:35,959 --> 00:06:39,080
<font color="#E5E5E5">providers that provide you with</font>

161
00:06:37,550 --> 00:06:40,100
industrial SIM cards and they give you a

162
00:06:39,080 --> 00:06:41,810
public<font color="#CCCCCC"> IP</font>

163
00:06:40,100 --> 00:06:44,180
and if you look at the<font color="#E5E5E5"> whole ripe range</font>

164
00:06:41,810 --> 00:06:46,270
<font color="#E5E5E5">you can just find hundreds of devices</font>

165
00:06:44,180 --> 00:06:49,040
<font color="#CCCCCC">over on the</font><font color="#E5E5E5"> Internet</font>

166
00:06:46,270 --> 00:06:51,560
often they use static<font color="#CCCCCC"> IPS without any</font>

167
00:06:49,040 --> 00:06:53,780
VPN protection<font color="#CCCCCC"> also</font><font color="#E5E5E5"> or they're connected</font>

168
00:06:51,560 --> 00:06:55,280
via Wi-Fi<font color="#E5E5E5"> and in one case</font><font color="#CCCCCC"> we found an</font>

169
00:06:53,780 --> 00:06:57,799
industrial Wi-Fi which was a

170
00:06:55,280 --> 00:07:00,229
point-to-point directional Wi-Fi with

171
00:06:57,800 --> 00:07:03,620
<font color="#E5E5E5">the IP with a password sent to one one</font>

172
00:07:00,230 --> 00:07:05,360
one one one<font color="#E5E5E5"> F then</font><font color="#CCCCCC"> you have the issue</font><font color="#E5E5E5"> of</font>

173
00:07:03,620 --> 00:07:07,280
physical<font color="#E5E5E5"> access for example</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> these</font>

174
00:07:05,360 --> 00:07:09,650
small boxes<font color="#E5E5E5"> it's trivial to break in</font>

175
00:07:07,280 --> 00:07:12,349
we've got<font color="#CCCCCC"> good</font><font color="#E5E5E5"> luck because here at</font>

176
00:07:09,650 --> 00:07:13,849
blackhat so this is not<font color="#E5E5E5"> protection and</font>

177
00:07:12,350 --> 00:07:16,460
we need to make sure<font color="#CCCCCC"> that these devices</font>

178
00:07:13,850 --> 00:07:20,110
are even secure at least<font color="#CCCCCC"> in some way</font>

179
00:07:16,460 --> 00:07:23,270
<font color="#CCCCCC">temper proof or</font><font color="#E5E5E5"> what we also see is that</font>

180
00:07:20,110 --> 00:07:26,540
<font color="#E5E5E5">these devices are connected</font><font color="#CCCCCC"> via GPRS</font>

181
00:07:23,270 --> 00:07:29,659
<font color="#E5E5E5">with</font><font color="#CCCCCC"> a custom APN</font><font color="#E5E5E5"> so they are basically</font>

182
00:07:26,540 --> 00:07:31,910
in a custom<font color="#E5E5E5"> network but they are not</font>

183
00:07:29,660 --> 00:07:33,950
really<font color="#CCCCCC"> segment segmented in any way so</font>

184
00:07:31,910 --> 00:07:35,720
if<font color="#CCCCCC"> you steal a</font><font color="#E5E5E5"> single SIM card of one</font>

185
00:07:33,950 --> 00:07:40,150
<font color="#E5E5E5">device</font><font color="#CCCCCC"> you can connect into the</font><font color="#E5E5E5"> entire</font>

186
00:07:35,720 --> 00:07:44,300
<font color="#E5E5E5">SCADA Network</font><font color="#CCCCCC"> ok</font><font color="#E5E5E5"> that being said let's</font>

187
00:07:40,150 --> 00:07:46,849
start hacking some gateways<font color="#E5E5E5"> so</font><font color="#CCCCCC"> all</font>

188
00:07:44,300 --> 00:07:49,370
equipment that was needed for everything

189
00:07:46,850 --> 00:07:51,860
you see in<font color="#E5E5E5"> this talk is</font><font color="#CCCCCC"> just this</font><font color="#E5E5E5"> just</font>

190
00:07:49,370 --> 00:07:54,770
as simple<font color="#E5E5E5"> oscilloscope</font><font color="#CCCCCC"> a cheap lodging</font>

191
00:07:51,860 --> 00:07:56,930
analyzer<font color="#CCCCCC"> a bus pirate and multimeter and</font>

192
00:07:54,770 --> 00:07:59,419
<font color="#E5E5E5">an a laptop and obviously a soldering</font>

193
00:07:56,930 --> 00:08:01,100
iron<font color="#CCCCCC"> I have this</font><font color="#E5E5E5"> slide in here because</font>

194
00:07:59,420 --> 00:08:04,880
<font color="#E5E5E5">with some of the vendor response was</font>

195
00:08:01,100 --> 00:08:06,800
these attacks<font color="#CCCCCC"> on like the resources you</font>

196
00:08:04,880 --> 00:08:10,070
<font color="#CCCCCC">need to</font><font color="#E5E5E5"> conduct an attack on industrial</font>

197
00:08:06,800 --> 00:08:14,870
<font color="#E5E5E5">network are so high nobody can do it so</font>

198
00:08:10,070 --> 00:08:17,390
this<font color="#E5E5E5"> is me</font><font color="#CCCCCC"> doing it at home so the first</font>

199
00:08:14,870 --> 00:08:20,450
step before I actually<font color="#E5E5E5"> got started was I</font>

200
00:08:17,390 --> 00:08:22,159
needed<font color="#E5E5E5"> to find potential targets my</font>

201
00:08:20,450 --> 00:08:23,539
personal process<font color="#E5E5E5"> is the first thing I</font>

202
00:08:22,160 --> 00:08:25,760
<font color="#E5E5E5">look for is can I get the firmware</font>

203
00:08:23,540 --> 00:08:26,990
<font color="#CCCCCC">before I even start so I checked</font><font color="#E5E5E5"> the</font>

204
00:08:25,760 --> 00:08:29,870
vendor site I<font color="#CCCCCC"> check whether</font><font color="#E5E5E5"> I can</font>

205
00:08:26,990 --> 00:08:31,760
<font color="#E5E5E5">download the firmware I check if the</font>

206
00:08:29,870 --> 00:08:34,820
firmware<font color="#E5E5E5"> is encrypted and then I check</font>

207
00:08:31,760 --> 00:08:36,770
the<font color="#E5E5E5"> availability so basically how</font>

208
00:08:34,820 --> 00:08:38,479
expensive is<font color="#CCCCCC"> this research going to be</font>

209
00:08:36,770 --> 00:08:41,689
and how expensive<font color="#E5E5E5"> is it going to be if I</font>

210
00:08:38,479 --> 00:08:43,099
break it and also<font color="#CCCCCC"> it should be a half</font>

211
00:08:41,690 --> 00:08:45,890
<font color="#E5E5E5">what current technology because</font>

212
00:08:43,099 --> 00:08:47,990
otherwise you just<font color="#E5E5E5"> hack junk all junk</font>

213
00:08:45,890 --> 00:08:49,400
<font color="#E5E5E5">and that's not really</font><font color="#CCCCCC"> interesting so if</font>

214
00:08:47,990 --> 00:08:51,230
you do this for<font color="#E5E5E5"> a couple of weeks you</font>

215
00:08:49,400 --> 00:08:52,930
<font color="#CCCCCC">eventually have a collection of</font><font color="#E5E5E5"> random</font>

216
00:08:51,230 --> 00:08:55,540
industrial hardware

217
00:08:52,930 --> 00:08:58,149
in<font color="#E5E5E5"> interconnected on a board and these</font>

218
00:08:55,540 --> 00:09:01,120
are the devices<font color="#E5E5E5"> plus some new ones</font><font color="#CCCCCC"> that</font>

219
00:08:58,149 --> 00:09:04,690
we are<font color="#CCCCCC"> going to look at the first device</font>

220
00:09:01,120 --> 00:09:07,899
<font color="#E5E5E5">I would like to talk about is the moxa</font>

221
00:09:04,690 --> 00:09:11,080
<font color="#E5E5E5">w2</font><font color="#CCCCCC"> one-five-zero</font><font color="#E5E5E5"> a it's a simple</font>

222
00:09:07,899 --> 00:09:15,430
<font color="#E5E5E5">Ethernet or an</font><font color="#CCCCCC"> internet to come and</font>

223
00:09:11,080 --> 00:09:17,260
Wi-Fi adapter<font color="#E5E5E5"> and you can get this very</font>

224
00:09:15,430 --> 00:09:20,170
easily it's used a lot<font color="#CCCCCC"> around</font><font color="#E5E5E5"> the world</font>

225
00:09:17,260 --> 00:09:22,810
and what's nice<font color="#E5E5E5"> about it is</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> can find</font>

226
00:09:20,170 --> 00:09:26,589
<font color="#E5E5E5">the firmware publicly it's decently</font>

227
00:09:22,810 --> 00:09:29,229
cheap on eBay<font color="#CCCCCC"> and it's</font><font color="#E5E5E5"> found a lot on in</font>

228
00:09:26,589 --> 00:09:31,209
the<font color="#E5E5E5"> world and so the first step was a</font>

229
00:09:29,230 --> 00:09:34,830
<font color="#CCCCCC">sacramentary</font><font color="#E5E5E5"> before let's get a firmware</font>

230
00:09:31,209 --> 00:09:37,719
<font color="#E5E5E5">of this device so what do you do if you</font>

231
00:09:34,830 --> 00:09:40,000
find<font color="#E5E5E5"> a random firmware the first thing</font>

232
00:09:37,720 --> 00:09:42,339
is you run strings on<font color="#CCCCCC"> it just to</font><font color="#E5E5E5"> see is</font>

233
00:09:40,000 --> 00:09:45,790
this<font color="#E5E5E5"> encrypted and unfortunately the</font>

234
00:09:42,339 --> 00:09:47,620
<font color="#E5E5E5">only thing that's readable is the model</font>

235
00:09:45,790 --> 00:09:51,819
<font color="#E5E5E5">number and that's it otherwise it's just</font>

236
00:09:47,620 --> 00:09:54,880
<font color="#E5E5E5">gibberish the next thing we do is we run</font>

237
00:09:51,820 --> 00:09:56,860
<font color="#E5E5E5">a tool called</font><font color="#CCCCCC"> bin walk in walk</font><font color="#E5E5E5"> tries</font><font color="#CCCCCC"> to</font>

238
00:09:54,880 --> 00:10:00,040
detect signatures of common compressions

239
00:09:56,860 --> 00:10:03,450
of common<font color="#E5E5E5"> firmware structures and so on</font>

240
00:10:00,040 --> 00:10:06,160
<font color="#E5E5E5">but in this case not a single hit so</font>

241
00:10:03,450 --> 00:10:09,070
maybe it's encrypted<font color="#CCCCCC"> that would</font><font color="#E5E5E5"> be kind</font>

242
00:10:06,160 --> 00:10:10,930
of bad<font color="#E5E5E5"> and if you're not sure</font><font color="#CCCCCC"> if a file</font>

243
00:10:09,070 --> 00:10:12,730
<font color="#CCCCCC">is encrypted</font><font color="#E5E5E5"> or compressed or something</font>

244
00:10:10,930 --> 00:10:14,800
what you can do is you run an entropy

245
00:10:12,730 --> 00:10:18,580
<font color="#E5E5E5">and</font><font color="#CCCCCC"> other sis on it</font><font color="#E5E5E5"> and an entropy</font>

246
00:10:14,800 --> 00:10:21,370
analysis will<font color="#CCCCCC"> tell you if the device has</font>

247
00:10:18,580 --> 00:10:23,350
a high entropy<font color="#E5E5E5"> so it's very</font><font color="#CCCCCC"> random</font><font color="#E5E5E5"> it</font>

248
00:10:21,370 --> 00:10:25,480
means that it's either<font color="#E5E5E5"> encrypted or</font>

249
00:10:23,350 --> 00:10:27,279
compressed and if it has low entropy

250
00:10:25,480 --> 00:10:29,350
it's very likely to want to be

251
00:10:27,279 --> 00:10:31,390
unencrypted just because a machine code

252
00:10:29,350 --> 00:10:33,490
is not dense<font color="#E5E5E5"> enough to really be random</font>

253
00:10:31,390 --> 00:10:35,680
<font color="#E5E5E5">so you will very</font><font color="#CCCCCC"> easily see the</font>

254
00:10:33,490 --> 00:10:38,320
<font color="#CCCCCC">difference between</font><font color="#E5E5E5"> an unencrypted and an</font>

255
00:10:35,680 --> 00:10:40,779
encrypted image<font color="#E5E5E5"> so as you can</font><font color="#CCCCCC"> see on the</font>

256
00:10:38,320 --> 00:10:42,940
graph<font color="#CCCCCC"> it looks like a straight</font><font color="#E5E5E5"> line with</font>

257
00:10:40,779 --> 00:10:45,250
high entropy<font color="#E5E5E5"> so not looking</font><font color="#CCCCCC"> good but</font>

258
00:10:42,940 --> 00:10:48,310
<font color="#CCCCCC">then I remembered that when I downloaded</font>

259
00:10:45,250 --> 00:10:51,480
the firmware<font color="#CCCCCC"> there was a small note on</font>

260
00:10:48,310 --> 00:10:55,719
the<font color="#E5E5E5"> bottom of the site which basically</font>

261
00:10:51,480 --> 00:10:58,149
which basically<font color="#E5E5E5"> said before upgrade to</font>

262
00:10:55,720 --> 00:11:00,130
firmware<font color="#E5E5E5"> version 2.0</font><font color="#CCCCCC"> please make sure</font>

263
00:10:58,149 --> 00:11:03,670
you have already<font color="#CCCCCC"> upgraded the</font><font color="#E5E5E5"> unit to</font>

264
00:11:00,130 --> 00:11:05,800
version<font color="#CCCCCC"> 1</font><font color="#E5E5E5"> point 11 and if we go to this</font>

265
00:11:03,670 --> 00:11:06,819
<font color="#CCCCCC">download link</font><font color="#E5E5E5"> you see that the change</font>

266
00:11:05,800 --> 00:11:09,130
look

267
00:11:06,820 --> 00:11:12,940
they<font color="#CCCCCC"> actually introduced the support for</font>

268
00:11:09,130 --> 00:11:16,450
encrypted firmware<font color="#E5E5E5"> and so I decided</font><font color="#CCCCCC"> to</font>

269
00:11:12,940 --> 00:11:18,430
download this older image and<font color="#CCCCCC"> suena</font><font color="#E5E5E5"> if</font>

270
00:11:16,450 --> 00:11:21,400
we run<font color="#E5E5E5"> the strings on it you can see</font>

271
00:11:18,430 --> 00:11:24,489
it's fully unencrypted and<font color="#E5E5E5"> we can use it</font>

272
00:11:21,400 --> 00:11:27,819
for<font color="#E5E5E5"> analysis and if we</font><font color="#CCCCCC"> just run</font><font color="#E5E5E5"> this</font>

273
00:11:24,490 --> 00:11:31,890
image into<font color="#E5E5E5"> a hex amp you can see that</font>

274
00:11:27,820 --> 00:11:34,660
almost<font color="#CCCCCC"> at</font><font color="#E5E5E5"> every fourth byte is an</font><font color="#CCCCCC"> e and</font>

275
00:11:31,890 --> 00:11:36,670
<font color="#E5E5E5">that immediately</font><font color="#CCCCCC"> tells you that you're</font>

276
00:11:34,660 --> 00:11:39,280
<font color="#E5E5E5">looking at an arm</font><font color="#CCCCCC"> firmware</font><font color="#E5E5E5"> why is that</font>

277
00:11:36,670 --> 00:11:42,130
because<font color="#CCCCCC"> the first four bits of any</font>

278
00:11:39,280 --> 00:11:43,780
encoded arm instructions are what's

279
00:11:42,130 --> 00:11:46,030
<font color="#E5E5E5">called the condition bits so basically</font>

280
00:11:43,780 --> 00:11:48,430
<font color="#CCCCCC">in arm every</font><font color="#E5E5E5"> instruction can</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> set to</font>

281
00:11:46,030 --> 00:11:50,350
<font color="#CCCCCC">only execute</font><font color="#E5E5E5"> if a certain condition is</font>

282
00:11:48,430 --> 00:11:53,189
met so for example if the carry flag<font color="#E5E5E5"> has</font>

283
00:11:50,350 --> 00:11:56,410
said<font color="#CCCCCC"> zero of like a set or so and</font>

284
00:11:53,190 --> 00:11:58,510
because mostly you<font color="#CCCCCC"> just always execute</font>

285
00:11:56,410 --> 00:11:59,770
every<font color="#E5E5E5"> fourth byte will be e and so we</font>

286
00:11:58,510 --> 00:12:03,280
know<font color="#CCCCCC"> that we have an unencrypted</font>

287
00:11:59,770 --> 00:12:05,860
firmware off with arm code and if we run

288
00:12:03,280 --> 00:12:09,010
<font color="#CCCCCC">been walking</font><font color="#E5E5E5"> our nice entropy analysis</font>

289
00:12:05,860 --> 00:12:11,620
on it we can see<font color="#E5E5E5"> that indeed pin walk</font>

290
00:12:09,010 --> 00:12:14,470
finds a lot of compressed data<font color="#E5E5E5"> it finds</font>

291
00:12:11,620 --> 00:12:16,630
a<font color="#CCCCCC"> squashy fast filesystem it finds</font><font color="#E5E5E5"> gzip</font>

292
00:12:14,470 --> 00:12:20,290
compressed data and so on and so

293
00:12:16,630 --> 00:12:22,480
wonderful<font color="#CCCCCC"> we can hopefully use</font><font color="#E5E5E5"> this to</font>

294
00:12:20,290 --> 00:12:24,490
find the<font color="#E5E5E5"> firmware upgrade code and see</font>

295
00:12:22,480 --> 00:12:29,290
<font color="#E5E5E5">how</font><font color="#CCCCCC"> does this encryption of</font><font color="#E5E5E5"> the firmware</font>

296
00:12:24,490 --> 00:12:31,660
upgrade<font color="#E5E5E5"> actually work and after browsing</font>

297
00:12:29,290 --> 00:12:34,870
<font color="#E5E5E5">a bit through this decrypted from where</font>

298
00:12:31,660 --> 00:12:36,910
<font color="#E5E5E5">I sure enough found</font><font color="#CCCCCC"> fun a</font><font color="#E5E5E5"> small file</font>

299
00:12:34,870 --> 00:12:41,650
called helpfully lip upgrade firmware

300
00:12:36,910 --> 00:12:43,500
and<font color="#CCCCCC"> matza was nice enough to not remove</font>

301
00:12:41,650 --> 00:12:46,000
any of the symbols so<font color="#E5E5E5"> we can actually</font>

302
00:12:43,500 --> 00:12:51,400
find<font color="#E5E5E5"> a very nice function called</font>

303
00:12:46,000 --> 00:12:55,720
firmware decrypt thank you

304
00:12:51,400 --> 00:12:58,150
and so I loaded the whole code into Ida

305
00:12:55,720 --> 00:13:02,020
probe to look at it and to disassemble

306
00:12:58,150 --> 00:13:04,870
it and what you<font color="#CCCCCC"> can see on the left</font><font color="#E5E5E5"> part</font>

307
00:13:02,020 --> 00:13:06,790
is<font color="#E5E5E5"> that there's a lot</font><font color="#CCCCCC"> of there are a lot</font>

308
00:13:04,870 --> 00:13:08,650
of<font color="#CCCCCC"> X</font><font color="#E5E5E5"> or instructions and if you see a</font>

309
00:13:06,790 --> 00:13:11,050
lot of<font color="#E5E5E5"> extra instructions in something</font>

310
00:13:08,650 --> 00:13:14,199
<font color="#CCCCCC">it already tells</font><font color="#E5E5E5"> you it's very highly</font>

311
00:13:11,050 --> 00:13:17,050
likely that<font color="#E5E5E5"> there's some kind of X or</font>

312
00:13:14,200 --> 00:13:19,300
decryption happening and so basically in

313
00:13:17,050 --> 00:13:23,079
this<font color="#CCCCCC"> case it loads a constant called</font>

314
00:13:19,300 --> 00:13:27,219
<font color="#E5E5E5">password and it goes into this kind of</font>

315
00:13:23,080 --> 00:13:30,910
loop runs a lot of X<font color="#E5E5E5"> or on this constant</font>

316
00:13:27,220 --> 00:13:35,200
<font color="#CCCCCC">and then eventually goes out of the loop</font>

317
00:13:30,910 --> 00:13:37,779
<font color="#CCCCCC">and calls a function called ECB</font><font color="#E5E5E5"> 128-bit</font>

318
00:13:35,200 --> 00:13:40,529
crypt<font color="#E5E5E5"> this sounds a lot like an</font><font color="#CCCCCC"> aes</font>

319
00:13:37,779 --> 00:13:42,820
decryption and there's no singer<font color="#CCCCCC"> a</font>

320
00:13:40,529 --> 00:13:45,939
<font color="#E5E5E5">symmetric crypto anything involved so</font>

321
00:13:42,820 --> 00:13:48,640
that<font color="#E5E5E5"> means if we can get this AES key</font>

322
00:13:45,940 --> 00:13:50,410
out we cannot only decipher the current

323
00:13:48,640 --> 00:13:52,300
firmware<font color="#CCCCCC"> but we can also create new</font>

324
00:13:50,410 --> 00:13:54,670
firmware because<font color="#E5E5E5"> there's no a symmetric</font>

325
00:13:52,300 --> 00:13:57,040
check of the firmware there's no hashing

326
00:13:54,670 --> 00:14:00,150
there's no nothing<font color="#CCCCCC"> to</font><font color="#E5E5E5"> really prove that</font>

327
00:13:57,040 --> 00:14:06,219
<font color="#E5E5E5">the firmware upgrade came from</font><font color="#CCCCCC"> Aqsa and</font>

328
00:14:00,150 --> 00:14:08,470
so I went ahead and<font color="#E5E5E5"> basically</font>

329
00:14:06,220 --> 00:14:11,350
implemented the whole the whole<font color="#CCCCCC"> thing</font>

330
00:14:08,470 --> 00:14:15,400
that<font color="#E5E5E5"> I saw in a simpler and</font><font color="#CCCCCC"> C</font><font color="#E5E5E5"> and ran it</font>

331
00:14:11,350 --> 00:14:19,630
and sure enough<font color="#E5E5E5"> we got the full password</font>

332
00:14:15,400 --> 00:14:22,300
which is<font color="#CCCCCC"> two</font><font color="#E5E5E5"> 887 con 7-5 6-4</font><font color="#CCCCCC"> and this</font>

333
00:14:19,630 --> 00:14:24,310
combined with<font color="#E5E5E5"> a script I called moxa</font>

334
00:14:22,300 --> 00:14:27,459
decrypt<font color="#E5E5E5"> allows us to decrypt the</font><font color="#CCCCCC"> full</font>

335
00:14:24,310 --> 00:14:29,819
firmware and we can run Ben walk on it

336
00:14:27,459 --> 00:14:31,779
and sure enough we<font color="#E5E5E5"> get the full</font>

337
00:14:29,820 --> 00:14:34,240
decrypted firmware including all

338
00:14:31,779 --> 00:14:38,770
<font color="#E5E5E5">compressed ranges or squash FS file</font>

339
00:14:34,240 --> 00:14:41,440
systems the kernel and so<font color="#E5E5E5"> on the scripts</font>

340
00:14:38,770 --> 00:14:45,040
for this can<font color="#E5E5E5"> be downloaded at and</font><font color="#CCCCCC"> might</font>

341
00:14:41,440 --> 00:14:47,500
<font color="#CCCCCC">be tapped by the</font><font color="#E5E5E5"> way and yeah so after</font><font color="#CCCCCC"> I</font>

342
00:14:45,040 --> 00:14:49,990
knew I<font color="#E5E5E5"> can decrypt the firmware it's a</font>

343
00:14:47,500 --> 00:14:52,240
device I<font color="#CCCCCC"> can buy everywhere on eBay it's</font>

344
00:14:49,990 --> 00:14:54,760
a device<font color="#CCCCCC"> that is cheap</font><font color="#E5E5E5"> enough</font><font color="#CCCCCC"> for me to</font>

345
00:14:52,240 --> 00:14:57,940
look<font color="#E5E5E5"> at and it's widely</font><font color="#CCCCCC"> used I decided</font>

346
00:14:54,760 --> 00:14:59,410
to buy<font color="#CCCCCC"> it and immediately open it up</font><font color="#E5E5E5"> so</font>

347
00:14:57,940 --> 00:15:01,780
inside this device<font color="#E5E5E5"> we will find a</font>

348
00:14:59,410 --> 00:15:03,630
<font color="#CCCCCC">freescale automotive processor which is</font>

349
00:15:01,780 --> 00:15:05,230
<font color="#E5E5E5">just your standard off-the-shelf</font>

350
00:15:03,630 --> 00:15:07,240
<font color="#E5E5E5">processor</font>

351
00:15:05,230 --> 00:15:09,700
we<font color="#CCCCCC"> use in the</font><font color="#E5E5E5"> automotive area or in the</font>

352
00:15:07,240 --> 00:15:13,540
<font color="#CCCCCC">industrial area</font><font color="#E5E5E5"> and inside</font><font color="#CCCCCC"> of the device</font>

353
00:15:09,700 --> 00:15:18,850
<font color="#CCCCCC">we also find a ton of test</font><font color="#E5E5E5"> points so for</font>

354
00:15:13,540 --> 00:15:20,589
<font color="#E5E5E5">example all</font><font color="#CCCCCC"> basically all exposed pets I</font>

355
00:15:18,850 --> 00:15:22,750
tested them<font color="#CCCCCC"> with my oscilloscope I</font>

356
00:15:20,590 --> 00:15:25,840
<font color="#E5E5E5">hooked up a logic analyzer to them and</font>

357
00:15:22,750 --> 00:15:28,660
try<font color="#CCCCCC"> to find a</font><font color="#E5E5E5"> serial console and sure</font>

358
00:15:25,840 --> 00:15:31,270
enough<font color="#E5E5E5"> if</font><font color="#CCCCCC"> we look at</font><font color="#E5E5E5"> those</font><font color="#CCCCCC"> port pins we</font>

359
00:15:28,660 --> 00:15:33,819
have<font color="#CCCCCC"> a full serial console</font><font color="#E5E5E5"> and if we</font>

360
00:15:31,270 --> 00:15:37,329
connect our serial<font color="#CCCCCC"> 2 years be adapted to</font>

361
00:15:33,820 --> 00:15:42,280
<font color="#E5E5E5">it we get a wonderful</font><font color="#CCCCCC"> root shell without</font>

362
00:15:37,330 --> 00:15:43,840
any authentication whatsoever<font color="#E5E5E5"> and so</font><font color="#CCCCCC"> at</font>

363
00:15:42,280 --> 00:15:45,430
<font color="#E5E5E5">this point where</font><font color="#CCCCCC"> we're in</font><font color="#E5E5E5"> this great</font>

364
00:15:43,840 --> 00:15:47,200
position that if we get<font color="#CCCCCC"> access to</font><font color="#E5E5E5"> the</font>

365
00:15:45,430 --> 00:15:50,229
<font color="#E5E5E5">hardware we have full</font><font color="#CCCCCC"> route</font><font color="#E5E5E5"> access and</font>

366
00:15:47,200 --> 00:15:52,090
if we let's say start to write<font color="#CCCCCC"> and</font>

367
00:15:50,230 --> 00:15:54,580
exploit<font color="#CCCCCC"> we can actually debug it</font>

368
00:15:52,090 --> 00:15:58,240
directly on<font color="#E5E5E5"> the device which</font><font color="#CCCCCC"> is a pretty</font>

369
00:15:54,580 --> 00:15:59,830
nice situation<font color="#CCCCCC"> to</font><font color="#E5E5E5"> be in and so</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is</font>

370
00:15:58,240 --> 00:16:01,870
<font color="#E5E5E5">not really a vulnerability this is a</font>

371
00:15:59,830 --> 00:16:04,210
design decision so<font color="#CCCCCC"> we need</font><font color="#E5E5E5"> to look at</font>

372
00:16:01,870 --> 00:16:06,370
all the<font color="#E5E5E5"> interfaces</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> are available</font>

373
00:16:04,210 --> 00:16:08,500
<font color="#E5E5E5">for potential remote vulnerabilities</font>

374
00:16:06,370 --> 00:16:13,120
because this is kind of<font color="#E5E5E5"> standard and</font>

375
00:16:08,500 --> 00:16:15,340
kind<font color="#E5E5E5"> of boring and so yeah</font><font color="#CCCCCC"> I looked at</font>

376
00:16:13,120 --> 00:16:17,020
all<font color="#E5E5E5"> the available services and if you</font>

377
00:16:15,340 --> 00:16:19,510
port scan<font color="#E5E5E5"> this device you will see that</font>

378
00:16:17,020 --> 00:16:22,870
there's a web interface there's telnet

379
00:16:19,510 --> 00:16:24,850
SNMP some serial driver protocol and

380
00:16:22,870 --> 00:16:28,720
<font color="#E5E5E5">also a proprietary configuration</font>

381
00:16:24,850 --> 00:16:30,310
protocol running<font color="#E5E5E5"> on port</font><font color="#CCCCCC"> 4900 and I</font>

382
00:16:28,720 --> 00:16:33,450
started with<font color="#E5E5E5"> looking at the web</font>

383
00:16:30,310 --> 00:16:35,920
interface<font color="#CCCCCC"> and it's really</font><font color="#E5E5E5"> really bad</font>

384
00:16:33,450 --> 00:16:37,870
so if we look at<font color="#E5E5E5"> the list of</font>

385
00:16:35,920 --> 00:16:39,910
<font color="#CCCCCC">vulnerabilities we go from cross-site</font>

386
00:16:37,870 --> 00:16:41,590
scripting in every field<font color="#E5E5E5"> to cross-site</font>

387
00:16:39,910 --> 00:16:44,140
request forgery to<font color="#E5E5E5"> unsecure</font>

388
00:16:41,590 --> 00:16:47,530
authentication to command injection<font color="#E5E5E5"> to</font>

389
00:16:44,140 --> 00:16:49,240
stack overflows over to<font color="#CCCCCC"> a zero-day for</font>

390
00:16:47,530 --> 00:16:56,650
the web server that's<font color="#E5E5E5"> publicly on there</font>

391
00:16:49,240 --> 00:16:58,900
on the<font color="#CCCCCC"> internet so demo time I had to</font>

392
00:16:56,650 --> 00:17:02,000
pre-record it because my SCADA hardware

393
00:16:58,900 --> 00:17:05,379
is stuck in<font color="#E5E5E5"> US Customs</font>

394
00:17:02,000 --> 00:17:08,000
[Laughter]

395
00:17:05,380 --> 00:17:12,020
<font color="#E5E5E5">okay so yeah this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> the web</font><font color="#CCCCCC"> interface</font>

396
00:17:08,000 --> 00:17:14,480
and<font color="#CCCCCC"> I'm just logging into the logging</font>

397
00:17:12,020 --> 00:17:16,359
<font color="#E5E5E5">into it with the credentials and when</font>

398
00:17:14,480 --> 00:17:19,309
when you<font color="#CCCCCC"> look in you just</font><font color="#E5E5E5"> see the</font>

399
00:17:16,359 --> 00:17:21,530
<font color="#E5E5E5">standard overview of the</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> system you</font>

400
00:17:19,309 --> 00:17:24,410
see the model name serial number and so

401
00:17:21,530 --> 00:17:27,109
<font color="#E5E5E5">on and if we go to the basic settings we</font>

402
00:17:24,410 --> 00:17:29,330
see<font color="#CCCCCC"> some some nice text fields and</font><font color="#E5E5E5"> what</font>

403
00:17:27,109 --> 00:17:32,780
do<font color="#E5E5E5"> we do as</font><font color="#CCCCCC"> pentesters when we see a</font>

404
00:17:29,330 --> 00:17:35,990
text<font color="#E5E5E5"> field we</font><font color="#CCCCCC"> pasted on some</font><font color="#E5E5E5"> JavaScript</font>

405
00:17:32,780 --> 00:17:39,590
in it<font color="#E5E5E5"> what else and so in this case</font><font color="#CCCCCC"> just</font>

406
00:17:35,990 --> 00:17:44,980
some alert<font color="#E5E5E5"> we press apply reload the</font>

407
00:17:39,590 --> 00:17:47,360
page and we get JavaScript execution<font color="#E5E5E5"> and</font>

408
00:17:44,980 --> 00:17:49,790
if there's a<font color="#E5E5E5"> single thing on the page</font>

409
00:17:47,360 --> 00:17:52,610
<font color="#CCCCCC">that helps you a lot about</font><font color="#E5E5E5"> this class of</font>

410
00:17:49,790 --> 00:17:57,379
devices<font color="#E5E5E5"> it's that it's best viewed with</font>

411
00:17:52,610 --> 00:17:59,750
<font color="#E5E5E5">Intel</font><font color="#CCCCCC"> Explorer five this is a</font><font color="#E5E5E5"> firmware</font>

412
00:17:57,380 --> 00:18:03,260
release in 2017<font color="#E5E5E5"> by the way so it's not</font>

413
00:17:59,750 --> 00:18:05,360
<font color="#E5E5E5">like old firmware this was like very</font>

414
00:18:03,260 --> 00:18:07,070
<font color="#E5E5E5">up-to-date malarkey these are</font>

415
00:18:05,360 --> 00:18:10,250
authenticated<font color="#CCCCCC"> bugs so</font><font color="#E5E5E5"> that's kind of</font>

416
00:18:07,070 --> 00:18:11,629
boring<font color="#CCCCCC"> right we if we want to have real</font>

417
00:18:10,250 --> 00:18:12,980
vulnerability<font color="#CCCCCC"> so we want something</font>

418
00:18:11,630 --> 00:18:16,760
remote and we want<font color="#E5E5E5"> something</font>

419
00:18:12,980 --> 00:18:19,070
unauthenticated<font color="#CCCCCC"> and so</font><font color="#E5E5E5"> I decided</font><font color="#CCCCCC"> to look</font>

420
00:18:16,760 --> 00:18:21,290
<font color="#E5E5E5">at this custom protocol that is used for</font>

421
00:18:19,070 --> 00:18:23,030
firmware upgrades<font color="#E5E5E5"> and my goal was to</font>

422
00:18:21,290 --> 00:18:25,700
<font color="#CCCCCC">reverse-engineer it</font><font color="#E5E5E5"> and build a phaser</font>

423
00:18:23,030 --> 00:18:29,450
<font color="#E5E5E5">the goal</font><font color="#CCCCCC"> of a father is to basically</font>

424
00:18:25,700 --> 00:18:31,760
<font color="#E5E5E5">take valid input data mutated in some</font>

425
00:18:29,450 --> 00:18:33,799
way<font color="#E5E5E5"> send it to the device and see if it</font>

426
00:18:31,760 --> 00:18:35,600
crashes<font color="#E5E5E5"> and because we already got code</font>

427
00:18:33,799 --> 00:18:42,668
execution on the<font color="#E5E5E5"> device via the serial</font>

428
00:18:35,600 --> 00:18:44,570
interface<font color="#E5E5E5"> we can</font><font color="#CCCCCC"> also basically start</font>

429
00:18:42,669 --> 00:18:46,850
handling all these precious and

430
00:18:44,570 --> 00:18:52,549
<font color="#E5E5E5">immediately get great intelligence of</font>

431
00:18:46,850 --> 00:18:55,189
the crashes but this turned out<font color="#E5E5E5"> to</font><font color="#CCCCCC"> not</font>

432
00:18:52,549 --> 00:18:57,559
be necessary<font color="#CCCCCC"> which is while developing</font>

433
00:18:55,190 --> 00:19:00,020
<font color="#E5E5E5">this father</font><font color="#CCCCCC"> I accidentally sent</font><font color="#E5E5E5"> too much</font>

434
00:18:57,559 --> 00:19:02,059
data<font color="#E5E5E5"> to the device I basically made a</font>

435
00:19:00,020 --> 00:19:04,820
small mistake<font color="#CCCCCC"> in my loop</font><font color="#E5E5E5"> my packet was</font>

436
00:19:02,059 --> 00:19:08,440
too long<font color="#E5E5E5"> and guess what happened when I</font>

437
00:19:04,820 --> 00:19:08,439
send a<font color="#CCCCCC"> lot of ace to</font><font color="#E5E5E5"> the device</font>

438
00:19:08,770 --> 00:19:15,650
obviously<font color="#CCCCCC"> stack overflow</font><font color="#E5E5E5"> or program</font>

439
00:19:11,990 --> 00:19:16,909
counter<font color="#CCCCCC"> is</font><font color="#E5E5E5"> set to</font><font color="#CCCCCC"> aaaa</font><font color="#E5E5E5"> and we basically</font>

440
00:19:15,650 --> 00:19:20,330
<font color="#E5E5E5">have a trivial tree</font>

441
00:19:16,909 --> 00:19:28,609
<font color="#CCCCCC">Boyd stackoverflow</font><font color="#E5E5E5"> in like a half a day</font>

442
00:19:20,330 --> 00:19:30,439
<font color="#CCCCCC">of exploit development</font><font color="#E5E5E5"> time demo type so</font>

443
00:19:28,609 --> 00:19:33,289
I packed<font color="#E5E5E5"> this whole thing into a small</font>

444
00:19:30,440 --> 00:19:38,599
Python script I can<font color="#CCCCCC"> just point at the IP</font>

445
00:19:33,289 --> 00:19:43,820
of<font color="#E5E5E5"> the device and if we run it it will</font>

446
00:19:38,599 --> 00:19:49,700
spawn<font color="#CCCCCC"> a shadow on the</font><font color="#E5E5E5"> server and</font><font color="#CCCCCC"> we can</font>

447
00:19:43,820 --> 00:19:51,710
<font color="#E5E5E5">just use netcat to connect to it paste</font>

448
00:19:49,700 --> 00:19:54,799
the command it outputs<font color="#E5E5E5"> and then you can</font>

449
00:19:51,710 --> 00:20:01,899
see you name a Linux kernel<font color="#CCCCCC"> to 6:31 and</font>

450
00:19:54,799 --> 00:20:04,700
we are in a true<font color="#CCCCCC"> s root very easy so</font>

451
00:20:01,899 --> 00:20:06,469
obviously these<font color="#E5E5E5"> bugs were reported by</font>

452
00:20:04,700 --> 00:20:08,739
the vendor<font color="#CCCCCC"> and some of these</font><font color="#E5E5E5"> bugs were</font>

453
00:20:06,470 --> 00:20:13,629
actually reported by different people

454
00:20:08,739 --> 00:20:16,759
before<font color="#E5E5E5"> on slightly different devices and</font>

455
00:20:13,629 --> 00:20:18,820
so what it turns out<font color="#CCCCCC"> is that if you</font>

456
00:20:16,759 --> 00:20:23,599
report<font color="#CCCCCC"> back to</font><font color="#E5E5E5"> some of these vendors</font>

457
00:20:18,820 --> 00:20:25,489
that if you find<font color="#E5E5E5"> a vulnerability</font><font color="#CCCCCC"> and you</font>

458
00:20:23,599 --> 00:20:29,479
send<font color="#E5E5E5"> it to them</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> vulnerability gets</font>

459
00:20:25,489 --> 00:20:31,970
fixed but then there<font color="#CCCCCC"> are like two five</font>

460
00:20:29,479 --> 00:20:34,039
ten different devices which<font color="#E5E5E5"> almost run</font>

461
00:20:31,970 --> 00:20:37,249
the same<font color="#CCCCCC"> throw where which stay</font>

462
00:20:34,039 --> 00:20:39,379
completely<font color="#E5E5E5"> untouched so they only you</font>

463
00:20:37,249 --> 00:20:41,359
can like for<font color="#CCCCCC"> example the cross-site</font>

464
00:20:39,379 --> 00:20:43,248
scripting bugs were reported<font color="#E5E5E5"> on</font><font color="#CCCCCC"> acting</font>

465
00:20:41,359 --> 00:20:46,039
five different devices<font color="#CCCCCC"> but they are</font>

466
00:20:43,249 --> 00:20:49,070
still on some of the new firmware<font color="#E5E5E5"> and so</font>

467
00:20:46,039 --> 00:20:51,799
this is a whole<font color="#CCCCCC"> security culture problem</font>

468
00:20:49,070 --> 00:20:53,539
<font color="#E5E5E5">from from my view and you</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> see this</font>

469
00:20:51,799 --> 00:20:57,109
the device on the<font color="#CCCCCC"> right is called the</font>

470
00:20:53,539 --> 00:20:59,989
secure<font color="#E5E5E5"> router or something from</font><font color="#CCCCCC"> Aqsa</font><font color="#E5E5E5"> and</font>

471
00:20:57,109 --> 00:21:02,449
<font color="#E5E5E5">it has the same</font><font color="#CCCCCC"> basic</font><font color="#E5E5E5"> box as the cheaper</font>

472
00:20:59,989 --> 00:21:05,269
ones which are not from<font color="#CCCCCC"> this</font><font color="#E5E5E5"> secure</font>

473
00:21:02,450 --> 00:21:07,099
<font color="#E5E5E5">edition so basically it is yeah you can</font>

474
00:21:05,269 --> 00:21:11,869
find<font color="#CCCCCC"> these bugs all across the</font><font color="#E5E5E5"> product</font>

475
00:21:07,099 --> 00:21:15,428
range<font color="#E5E5E5"> unfortunately so the next device I</font>

476
00:21:11,869 --> 00:21:18,109
looked at was the<font color="#E5E5E5"> advantage eki 15 to 2</font>

477
00:21:15,429 --> 00:21:21,379
which is kind of<font color="#E5E5E5"> a similar device it's</font>

478
00:21:18,109 --> 00:21:23,720
<font color="#E5E5E5">just a serial</font><font color="#CCCCCC"> to ethernet device you can</font>

479
00:21:21,379 --> 00:21:26,330
also get it with Wi-Fi<font color="#E5E5E5"> you can get it</font>

480
00:21:23,720 --> 00:21:28,879
with GSM I think or with more<font color="#E5E5E5"> Ethernet</font>

481
00:21:26,330 --> 00:21:30,210
<font color="#E5E5E5">ports whatever and it's really</font><font color="#CCCCCC"> just a</font>

482
00:21:28,879 --> 00:21:33,149
<font color="#E5E5E5">simple device and</font>

483
00:21:30,210 --> 00:21:36,560
<font color="#E5E5E5">as before the first thing I did was I</font>

484
00:21:33,150 --> 00:21:38,910
<font color="#E5E5E5">looked at the firmware of the device</font>

485
00:21:36,560 --> 00:21:41,250
<font color="#E5E5E5">running it through</font><font color="#CCCCCC"> bin walk and through</font>

486
00:21:38,910 --> 00:21:43,380
the entropy analysis we immediately see

487
00:21:41,250 --> 00:21:45,480
<font color="#E5E5E5">very low entropy some high entropy</font>

488
00:21:43,380 --> 00:21:48,150
regions so it's probably unencrypted and

489
00:21:45,480 --> 00:21:50,760
just compressed<font color="#E5E5E5"> and we can see that</font>

490
00:21:48,150 --> 00:21:54,240
<font color="#E5E5E5">didn't</font><font color="#CCCCCC"> work even immediately</font><font color="#E5E5E5"> detects the</font>

491
00:21:50,760 --> 00:21:56,190
<font color="#CCCCCC">linux image</font><font color="#E5E5E5"> and so on and so forth and</font>

492
00:21:54,240 --> 00:21:57,810
what's<font color="#E5E5E5"> kind of interesting of looking</font>

493
00:21:56,190 --> 00:22:00,840
through<font color="#CCCCCC"> the firmware is that it runs a</font>

494
00:21:57,810 --> 00:22:05,629
web server called<font color="#CCCCCC"> boa</font><font color="#E5E5E5"> whose last release</font>

495
00:22:00,840 --> 00:22:09,840
was in 2005 so it a device you buy in

496
00:22:05,630 --> 00:22:11,850
2018 runs<font color="#E5E5E5"> 13</font><font color="#CCCCCC"> year-old</font><font color="#E5E5E5"> web server and the</font>

497
00:22:09,840 --> 00:22:13,709
main binary<font color="#E5E5E5"> found on the device that</font>

498
00:22:11,850 --> 00:22:14,939
<font color="#CCCCCC">handles all the serial communication of</font>

499
00:22:13,710 --> 00:22:17,990
the web server and so on

500
00:22:14,940 --> 00:22:21,060
is called<font color="#E5E5E5"> edge server and edge server</font>

501
00:22:17,990 --> 00:22:23,040
<font color="#E5E5E5">when I look at</font><font color="#CCCCCC"> such a binary I look at</font>

502
00:22:21,060 --> 00:22:25,800
calls to do what I consider dangerous

503
00:22:23,040 --> 00:22:29,909
<font color="#E5E5E5">functions so for example string copies</font>

504
00:22:25,800 --> 00:22:32,220
printf and system<font color="#E5E5E5"> and because all this</font>

505
00:22:29,910 --> 00:22:34,230
whole system<font color="#E5E5E5"> either gives me remote code</font>

506
00:22:32,220 --> 00:22:35,910
execution and printf gives me buffer

507
00:22:34,230 --> 00:22:38,490
overflows and string copy gives me

508
00:22:35,910 --> 00:22:40,800
buffer overflows<font color="#E5E5E5"> so if I find lots of</font>

509
00:22:38,490 --> 00:22:42,390
<font color="#E5E5E5">these I'm already pretty confident</font><font color="#CCCCCC"> that</font>

510
00:22:40,800 --> 00:22:45,270
I'll find something<font color="#E5E5E5"> and this is again</font>

511
00:22:42,390 --> 00:22:47,310
<font color="#E5E5E5">before</font><font color="#CCCCCC"> I even bought the device I looked</font>

512
00:22:45,270 --> 00:22:49,920
at<font color="#E5E5E5"> it and sure enough I found</font><font color="#CCCCCC"> in the</font>

513
00:22:47,310 --> 00:22:52,740
firmware<font color="#E5E5E5"> a long string which looks a lot</font>

514
00:22:49,920 --> 00:22:54,030
like a<font color="#CCCCCC"> mail</font><font color="#E5E5E5"> command and you can see that</font>

515
00:22:52,740 --> 00:22:56,760
there are<font color="#E5E5E5"> a lot of parameters</font><font color="#CCCCCC"> that are</font>

516
00:22:54,030 --> 00:22:58,770
filled in so for example there's the

517
00:22:56,760 --> 00:23:01,550
<font color="#CCCCCC">person</font><font color="#E5E5E5"> s will insert a string of</font>

518
00:22:58,770 --> 00:23:03,900
arbitrary<font color="#E5E5E5"> length and so on and this is</font>

519
00:23:01,550 --> 00:23:06,030
from<font color="#E5E5E5"> from my interpretation at the time</font>

520
00:23:03,900 --> 00:23:07,560
this<font color="#E5E5E5"> was the alert mail system so if you</font>

521
00:23:06,030 --> 00:23:09,540
have a failed authentication this will

522
00:23:07,560 --> 00:23:12,899
send you an email<font color="#CCCCCC"> with the details and</font>

523
00:23:09,540 --> 00:23:16,379
if we look<font color="#E5E5E5"> at where this string is used</font>

524
00:23:12,900 --> 00:23:19,110
<font color="#E5E5E5">it's used as an</font><font color="#CCCCCC"> argument to</font><font color="#E5E5E5"> printf which</font>

525
00:23:16,380 --> 00:23:20,970
first<font color="#E5E5E5"> doesn't check buffer sizes so if</font>

526
00:23:19,110 --> 00:23:23,729
we<font color="#E5E5E5"> manage</font><font color="#CCCCCC"> to put in a very</font><font color="#E5E5E5"> long string</font>

527
00:23:20,970 --> 00:23:25,980
it<font color="#E5E5E5"> will</font><font color="#CCCCCC"> overflow the buffer and</font><font color="#E5E5E5"> then</font>

528
00:23:23,730 --> 00:23:28,680
after the call<font color="#CCCCCC"> to</font><font color="#E5E5E5"> printf</font>

529
00:23:25,980 --> 00:23:31,860
it actually will call system so if we

530
00:23:28,680 --> 00:23:33,960
<font color="#CCCCCC">managed to insert anything</font><font color="#E5E5E5"> into the male</font>

531
00:23:31,860 --> 00:23:36,840
subject for<font color="#E5E5E5"> example the username with</font>

532
00:23:33,960 --> 00:23:39,960
which we<font color="#E5E5E5"> fail the authentication we will</font>

533
00:23:36,840 --> 00:23:43,070
get remote code execution<font color="#E5E5E5"> very easily</font>

534
00:23:39,960 --> 00:23:47,250
<font color="#CCCCCC">before we even bought the device</font>

535
00:23:43,070 --> 00:23:49,080
so at<font color="#E5E5E5"> this point I again decided to go</font>

536
00:23:47,250 --> 00:23:51,390
on<font color="#E5E5E5"> eBay find the device buy it</font>

537
00:23:49,080 --> 00:23:54,000
and the fun part here was<font color="#CCCCCC"> that</font><font color="#E5E5E5"> I first</font>

538
00:23:51,390 --> 00:23:56,460
bought a device which<font color="#E5E5E5"> was slightly older</font>

539
00:23:54,000 --> 00:23:58,500
where this<font color="#CCCCCC"> mail functionality was broken</font>

540
00:23:56,460 --> 00:24:00,510
so<font color="#E5E5E5"> the back was there</font><font color="#CCCCCC"> that the mail</font>

541
00:23:58,500 --> 00:24:02,880
system<font color="#E5E5E5"> was broken</font><font color="#CCCCCC"> for whatever reason</font>

542
00:24:00,510 --> 00:24:05,549
and acknowledged<font color="#CCCCCC"> by advantage</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> is</font>

543
00:24:02,880 --> 00:24:07,290
<font color="#CCCCCC">was it was broken and</font><font color="#E5E5E5"> try to buy yet</font>

544
00:24:05,549 --> 00:24:10,860
<font color="#E5E5E5">another device on which the</font>

545
00:24:07,290 --> 00:24:12,870
functionality actually worked<font color="#E5E5E5"> so</font><font color="#CCCCCC"> okay so</font>

546
00:24:10,860 --> 00:24:15,659
I looked inside<font color="#E5E5E5"> I checked all the pets</font>

547
00:24:12,870 --> 00:24:17,909
<font color="#E5E5E5">and again for sure there was a serial</font>

548
00:24:15,660 --> 00:24:20,669
console<font color="#E5E5E5"> as root without any</font>

549
00:24:17,910 --> 00:24:22,950
authentication<font color="#E5E5E5"> and again they give you</font>

550
00:24:20,669 --> 00:24:25,070
the<font color="#E5E5E5"> filesystem</font><font color="#CCCCCC"> and so</font><font color="#E5E5E5"> on</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> these</font>

551
00:24:22,950 --> 00:24:27,480
<font color="#CCCCCC">devices are not read-only</font><font color="#E5E5E5"> like if you</font>

552
00:24:25,070 --> 00:24:29,700
change something<font color="#CCCCCC"> on</font><font color="#E5E5E5"> the file for</font><font color="#CCCCCC"> example</font>

553
00:24:27,480 --> 00:24:31,830
you can buy it on<font color="#CCCCCC"> only</font><font color="#E5E5E5"> from a</font>

554
00:24:29,700 --> 00:24:34,230
<font color="#CCCCCC">distributor you can modify the device</font>

555
00:24:31,830 --> 00:24:36,780
via<font color="#E5E5E5"> the serial console send it back they</font>

556
00:24:34,230 --> 00:24:38,669
<font color="#E5E5E5">will happily resell it we've tried that</font>

557
00:24:36,780 --> 00:24:41,720
with the allowance of a distributor that

558
00:24:38,669 --> 00:24:44,100
<font color="#E5E5E5">you we basically got a device from them</font>

559
00:24:41,720 --> 00:24:45,929
modified<font color="#CCCCCC"> it by creating a file sending</font>

560
00:24:44,100 --> 00:24:47,760
it<font color="#E5E5E5"> back and ordered it again and for</font>

561
00:24:45,929 --> 00:24:49,770
sure we got the same device<font color="#E5E5E5"> precisely</font>

562
00:24:47,760 --> 00:24:51,929
again with our modifications<font color="#CCCCCC"> so we</font>

563
00:24:49,770 --> 00:24:53,760
actually have supply chain issues

564
00:24:51,929 --> 00:24:55,370
because of<font color="#CCCCCC"> these serial consoles</font><font color="#E5E5E5"> and</font>

565
00:24:53,760 --> 00:24:57,330
because there's<font color="#E5E5E5"> no way to actually</font>

566
00:24:55,370 --> 00:25:00,260
authenticate the device and check

567
00:24:57,330 --> 00:25:03,389
whether it's<font color="#E5E5E5"> been</font><font color="#CCCCCC"> tampered with or not</font>

568
00:25:00,260 --> 00:25:06,120
so again how do we find vulnerabilities

569
00:25:03,390 --> 00:25:08,490
<font color="#E5E5E5">we have a web interface we have</font><font color="#CCCCCC"> a</font>

570
00:25:06,120 --> 00:25:11,219
proprietary<font color="#E5E5E5"> configuration protocol yet</font>

571
00:25:08,490 --> 00:25:13,470
again we have telnet we have SNMP<font color="#CCCCCC"> and</font>

572
00:25:11,220 --> 00:25:16,500
again a custom serial driver protocol

573
00:25:13,470 --> 00:25:20,580
<font color="#E5E5E5">and</font><font color="#CCCCCC"> again I started with a web interface</font>

574
00:25:16,500 --> 00:25:22,470
and<font color="#E5E5E5"> again we find cross-site scripting</font>

575
00:25:20,580 --> 00:25:24,330
cross-site request forgery command

576
00:25:22,470 --> 00:25:26,370
injection<font color="#E5E5E5"> everything and even broken</font>

577
00:25:24,330 --> 00:25:30,210
authentication<font color="#E5E5E5"> and this is kind of a fun</font>

578
00:25:26,370 --> 00:25:32,760
back because if<font color="#E5E5E5"> you unlock the admin</font>

579
00:25:30,210 --> 00:25:36,540
interface from one computer<font color="#CCCCCC"> it</font><font color="#E5E5E5"> somehow</font>

580
00:25:32,760 --> 00:25:38,490
unlocks it for<font color="#CCCCCC"> everyone so you login</font>

581
00:25:36,540 --> 00:25:40,620
<font color="#E5E5E5">from computer</font><font color="#CCCCCC"> a and</font><font color="#E5E5E5"> everyone else can</font>

582
00:25:38,490 --> 00:25:43,320
also log in<font color="#CCCCCC"> without any password or so I</font>

583
00:25:40,620 --> 00:25:45,360
don't know how how<font color="#CCCCCC"> that</font><font color="#E5E5E5"> can work</font><font color="#CCCCCC"> but</font>

584
00:25:43,320 --> 00:25:47,760
yeah<font color="#E5E5E5"> and then we also have a stack</font>

585
00:25:45,360 --> 00:25:49,530
overflow again in an other protocol

586
00:25:47,760 --> 00:25:51,390
which<font color="#CCCCCC"> we're</font><font color="#E5E5E5"> going</font><font color="#CCCCCC"> to look at in a second</font>

587
00:25:49,530 --> 00:25:54,230
but first<font color="#E5E5E5"> let's look at the web</font>

588
00:25:51,390 --> 00:25:54,230
interface<font color="#CCCCCC"> again</font>

589
00:25:55,850 --> 00:26:01,919
so we<font color="#CCCCCC"> lock into the web interface again</font>

590
00:26:00,180 --> 00:26:04,530
with default credentials<font color="#CCCCCC"> by the way if</font>

591
00:26:01,920 --> 00:26:06,360
you<font color="#CCCCCC"> ever do a</font><font color="#E5E5E5"> scatter pen test</font><font color="#CCCCCC"> 50% of</font>

592
00:26:04,530 --> 00:26:08,370
the time the default passwords will work

593
00:26:06,360 --> 00:26:11,639
I don't<font color="#CCCCCC"> know</font>

594
00:26:08,370 --> 00:26:13,110
and in this case we can go to the<font color="#E5E5E5"> system</font>

595
00:26:11,640 --> 00:26:14,850
<font color="#CCCCCC">configuration we have a nice device</font>

596
00:26:13,110 --> 00:26:17,639
<font color="#E5E5E5">description field we enter some</font>

597
00:26:14,850 --> 00:26:20,820
JavaScript in it<font color="#E5E5E5"> we save</font><font color="#CCCCCC"> it and we</font>

598
00:26:17,640 --> 00:26:23,640
<font color="#CCCCCC">reload the</font><font color="#E5E5E5"> page and again we get a</font>

599
00:26:20,820 --> 00:26:26,340
JavaScript alert so again trivial that

600
00:26:23,640 --> 00:26:32,150
vulnerabilities in a<font color="#CCCCCC"> an up-to-date</font>

601
00:26:26,340 --> 00:26:35,189
device yeah good

602
00:26:32,150 --> 00:26:37,440
but<font color="#CCCCCC"> that vulnerabilities are kind of</font>

603
00:26:35,190 --> 00:26:39,510
boring<font color="#CCCCCC"> so let's</font><font color="#E5E5E5"> write an exploit for</font><font color="#CCCCCC"> the</font>

604
00:26:37,440 --> 00:26:41,460
stack overflow<font color="#CCCCCC"> again</font><font color="#E5E5E5"> because we have gdb</font>

605
00:26:39,510 --> 00:26:43,740
we can we have serial console we can

606
00:26:41,460 --> 00:26:45,660
<font color="#E5E5E5">install gdb we can just divide</font><font color="#CCCCCC"> our</font>

607
00:26:43,740 --> 00:26:48,690
exploit it's very trivial to write once

608
00:26:45,660 --> 00:26:52,280
you have the stack overflow<font color="#CCCCCC"> and so for</font>

609
00:26:48,690 --> 00:26:52,280
sure I again through the Python tool

610
00:26:52,340 --> 00:26:58,320
which just<font color="#E5E5E5"> takes the IP sponsor shell on</font>

611
00:26:55,710 --> 00:27:00,300
the device and<font color="#CCCCCC"> you can just use netcat</font>

612
00:26:58,320 --> 00:27:04,439
to connect to it and<font color="#E5E5E5"> you see again it's</font>

613
00:27:00,300 --> 00:27:07,200
like<font color="#E5E5E5"> a an old</font><font color="#CCCCCC"> Linux - 631 built in</font><font color="#E5E5E5"> I</font>

614
00:27:04,440 --> 00:27:09,210
believe 2017<font color="#E5E5E5"> and we are</font><font color="#CCCCCC"> logged in as</font>

615
00:27:07,200 --> 00:27:10,920
<font color="#CCCCCC">root remotely</font><font color="#E5E5E5"> and this is because all</font>

616
00:27:09,210 --> 00:27:13,380
these services the edge server the<font color="#CCCCCC"> web</font>

617
00:27:10,920 --> 00:27:17,570
server everything runs on<font color="#E5E5E5"> s root on all</font>

618
00:27:13,380 --> 00:27:20,340
<font color="#E5E5E5">these devices</font><font color="#CCCCCC"> so there's really no no</font>

619
00:27:17,570 --> 00:27:22,980
permission<font color="#E5E5E5"> system or</font><font color="#CCCCCC"> anything everything</font>

620
00:27:20,340 --> 00:27:24,659
runs as root everything runs on<font color="#E5E5E5"> outdated</font>

621
00:27:22,980 --> 00:27:27,360
Linux kernels everything runs on

622
00:27:24,660 --> 00:27:32,330
outdated<font color="#E5E5E5"> web service and if any of those</font>

623
00:27:27,360 --> 00:27:32,330
components<font color="#CCCCCC"> fail your root on the machine</font>

624
00:27:32,780 --> 00:27:40,639
<font color="#E5E5E5">so let's look at lunch</font><font color="#CCCCCC"> 1x devices so</font>

625
00:27:37,080 --> 00:27:45,149
this device<font color="#E5E5E5"> is called and</font><font color="#CCCCCC"> tronic CGS</font>

626
00:27:40,640 --> 00:27:45,780
2100<font color="#E5E5E5"> and it's a simple serial device</font>

627
00:27:45,150 --> 00:27:48,720
server

628
00:27:45,780 --> 00:27:50,760
it has two Ethernet ports<font color="#CCCCCC"> and it as the</font>

629
00:27:48,720 --> 00:27:52,980
only<font color="#E5E5E5"> device in this talk it doesn't come</font>

630
00:27:50,760 --> 00:27:56,940
with Linux so I used something called

631
00:27:52,980 --> 00:27:59,090
<font color="#E5E5E5">evolution OS on it</font><font color="#CCCCCC"> I have no clue what</font>

632
00:27:56,940 --> 00:28:02,250
evolution<font color="#E5E5E5"> has actually consists of and</font>

633
00:27:59,090 --> 00:28:04,909
yeah I looked at the firmware<font color="#E5E5E5"> of it and</font>

634
00:28:02,250 --> 00:28:06,880
<font color="#E5E5E5">it's it was unencrypted</font><font color="#CCCCCC"> yeah again</font><font color="#E5E5E5"> and</font>

635
00:28:04,910 --> 00:28:08,860
using the cold fire

636
00:28:06,880 --> 00:28:10,570
protector<font color="#CCCCCC"> when</font><font color="#E5E5E5"> cold fire I've never</font>

637
00:28:08,860 --> 00:28:12,760
worked with it<font color="#E5E5E5"> it's pretty hard to find</font>

638
00:28:10,570 --> 00:28:14,919
a good disassembler for it so this was

639
00:28:12,760 --> 00:28:16,960
for sure<font color="#CCCCCC"> going to</font><font color="#E5E5E5"> be interesting</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> I</font>

640
00:28:14,920 --> 00:28:18,340
also<font color="#CCCCCC"> no obvious external</font><font color="#E5E5E5"> software</font>

641
00:28:16,960 --> 00:28:20,170
components like<font color="#E5E5E5"> if you look in the</font>

642
00:28:18,340 --> 00:28:22,870
firmware there's no open<font color="#E5E5E5"> SSL there's no</font>

643
00:28:20,170 --> 00:28:25,300
nothing you<font color="#CCCCCC"> really know or can research</font>

644
00:28:22,870 --> 00:28:28,000
it's pretty much all proprietary from

645
00:28:25,300 --> 00:28:30,340
what I could tell<font color="#CCCCCC"> or purchased in from</font>

646
00:28:28,000 --> 00:28:33,370
third parties<font color="#E5E5E5"> and so I decided to still</font>

647
00:28:30,340 --> 00:28:35,560
buy<font color="#CCCCCC"> it and give</font><font color="#E5E5E5"> it a spin</font><font color="#CCCCCC"> and bought the</font>

648
00:28:33,370 --> 00:28:37,659
device<font color="#CCCCCC"> and for</font><font color="#E5E5E5"> the first time</font><font color="#CCCCCC"> the I</font>

649
00:28:35,560 --> 00:28:39,310
couldn't<font color="#E5E5E5"> find the serial console</font><font color="#CCCCCC"> there's</font>

650
00:28:37,660 --> 00:28:41,860
something that<font color="#E5E5E5"> looks like a debug port</font>

651
00:28:39,310 --> 00:28:43,720
<font color="#E5E5E5">but I could not get it to to debug or</font>

652
00:28:41,860 --> 00:28:45,879
give me any serial console or anything

653
00:28:43,720 --> 00:28:48,190
<font color="#E5E5E5">at all</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> don't even know to be honest</font>

654
00:28:45,880 --> 00:28:50,080
whether evolution<font color="#CCCCCC"> West</font><font color="#E5E5E5"> even has a</font>

655
00:28:48,190 --> 00:28:53,950
command line<font color="#CCCCCC"> or anything</font><font color="#E5E5E5"> I have no clue</font>

656
00:28:50,080 --> 00:28:56,770
and so this made this device<font color="#E5E5E5"> much harder</font>

657
00:28:53,950 --> 00:28:58,390
to look at right because you have to

658
00:28:56,770 --> 00:29:01,660
still have that<font color="#E5E5E5"> interface you</font><font color="#CCCCCC"> have a</font>

659
00:28:58,390 --> 00:29:04,210
telnet which runs with custom<font color="#E5E5E5"> with with</font>

660
00:29:01,660 --> 00:29:07,810
a custom menu basically<font color="#CCCCCC"> and you have SSL</font>

661
00:29:04,210 --> 00:29:11,220
<font color="#E5E5E5">SSH FTP</font><font color="#CCCCCC"> TFTP and this device was the</font>

662
00:29:07,810 --> 00:29:13,330
<font color="#E5E5E5">first one to really have</font><font color="#CCCCCC"> strong security</font>

663
00:29:11,220 --> 00:29:15,070
configuration options at least there's a

664
00:29:13,330 --> 00:29:17,830
guide on<font color="#CCCCCC"> how to really configure it</font>

665
00:29:15,070 --> 00:29:20,200
securely<font color="#E5E5E5"> on what to do on what not to</font><font color="#CCCCCC"> do</font>

666
00:29:17,830 --> 00:29:24,340
and the web interface was also a bit

667
00:29:20,200 --> 00:29:26,170
more more stable and so I found just

668
00:29:24,340 --> 00:29:28,449
found cross-site request forgery<font color="#CCCCCC"> a</font>

669
00:29:26,170 --> 00:29:30,670
<font color="#E5E5E5">configuration injection and also an</font>

670
00:29:28,450 --> 00:29:32,920
authentication bypass no code execution

671
00:29:30,670 --> 00:29:36,640
or anything just<font color="#E5E5E5"> because it doesn't</font><font color="#CCCCCC"> look</font>

672
00:29:32,920 --> 00:29:37,900
like<font color="#CCCCCC"> the system actually is executing</font>

673
00:29:36,640 --> 00:29:42,100
commands or anything in the shell

674
00:29:37,900 --> 00:29:46,060
<font color="#E5E5E5">because it's custom so</font><font color="#CCCCCC"> demo time</font><font color="#E5E5E5"> I set a</font>

675
00:29:42,100 --> 00:29:47,580
device<font color="#E5E5E5"> authentication bypass in this</font>

676
00:29:46,060 --> 00:29:50,730
case if you look<font color="#E5E5E5"> at the device it</font>

677
00:29:47,580 --> 00:29:54,520
requires a password<font color="#CCCCCC"> we don't know it and</font>

678
00:29:50,730 --> 00:29:59,350
so I wrote<font color="#E5E5E5"> a small tool which is the</font>

679
00:29:54,520 --> 00:30:04,770
<font color="#E5E5E5">video running yes which I called LAN</font>

680
00:29:59,350 --> 00:30:04,770
<font color="#CCCCCC">Tronics form</font><font color="#E5E5E5"> and if we reload the</font><font color="#CCCCCC"> site</font>

681
00:30:05,310 --> 00:30:10,149
<font color="#E5E5E5">just press</font><font color="#CCCCCC"> console we're</font><font color="#E5E5E5"> in so we got</font><font color="#CCCCCC"> a</font>

682
00:30:08,170 --> 00:30:12,790
nice authentication bypass<font color="#E5E5E5"> because of a</font>

683
00:30:10,150 --> 00:30:18,040
<font color="#CCCCCC">back-end of app server so device three</font>

684
00:30:12,790 --> 00:30:20,770
broken basically the next one<font color="#CCCCCC"> I looked</font>

685
00:30:18,040 --> 00:30:23,950
at<font color="#E5E5E5"> actually was the</font><font color="#CCCCCC"> Schneider device</font>

686
00:30:20,770 --> 00:30:27,370
<font color="#CCCCCC">PAH logic egx</font><font color="#E5E5E5"> 100 which is an Ethernet</font>

687
00:30:23,950 --> 00:30:33,310
<font color="#CCCCCC">to Modbus gateway and Modbus is used a</font>

688
00:30:27,370 --> 00:30:35,770
lot in in ICS applications and again we

689
00:30:33,310 --> 00:30:37,330
had trivial<font color="#CCCCCC"> back vulnerabilities this</font>

690
00:30:35,770 --> 00:30:39,310
unfortunately<font color="#E5E5E5"> is</font><font color="#CCCCCC"> the last device</font><font color="#E5E5E5"> I</font>

691
00:30:37,330 --> 00:30:41,439
bought and so I'm not fully yet through

692
00:30:39,310 --> 00:30:44,679
the vulnerability disclosure process<font color="#E5E5E5"> so</font>

693
00:30:41,440 --> 00:30:46,390
I cannot<font color="#CCCCCC"> demoed this yet but I can tell</font>

694
00:30:44,680 --> 00:30:48,100
you that you will<font color="#E5E5E5"> find this device</font><font color="#CCCCCC"> a lot</font>

695
00:30:46,390 --> 00:30:51,520
in the wild and there are a<font color="#E5E5E5"> lot of very</font>

696
00:30:48,100 --> 00:30:57,550
<font color="#E5E5E5">very funny issues in it so</font><font color="#CCCCCC"> hopefully</font>

697
00:30:51,520 --> 00:30:59,920
soon then kind<font color="#E5E5E5"> of a different gateway at</font>

698
00:30:57,550 --> 00:31:01,690
the beginning<font color="#E5E5E5"> of the target my shoulder</font>

699
00:30:59,920 --> 00:31:04,210
all<font color="#CCCCCC"> the different rated protocols they</font>

700
00:31:01,690 --> 00:31:07,210
use in the wild in<font color="#E5E5E5"> the industrial IOT</font>

701
00:31:04,210 --> 00:31:10,030
field and at one penetration<font color="#CCCCCC"> test I</font>

702
00:31:07,210 --> 00:31:13,390
found<font color="#E5E5E5"> this</font><font color="#CCCCCC"> GE MVS system so this</font><font color="#E5E5E5"> is a</font>

703
00:31:10,030 --> 00:31:16,210
custom a proprietary radio solution for

704
00:31:13,390 --> 00:31:19,000
<font color="#E5E5E5">basically connecting serial devices or</font>

705
00:31:16,210 --> 00:31:21,940
<font color="#CCCCCC">even</font><font color="#E5E5E5"> a devices via RF so we had custom</font>

706
00:31:19,000 --> 00:31:24,730
<font color="#E5E5E5">radio you need</font><font color="#CCCCCC"> license spectrum to use</font>

707
00:31:21,940 --> 00:31:28,060
it so for example if you are an electric

708
00:31:24,730 --> 00:31:32,470
grid provider whatever then you need to

709
00:31:28,060 --> 00:31:35,520
go to the state<font color="#E5E5E5"> license the the radio</font>

710
00:31:32,470 --> 00:31:39,220
band and then you can use<font color="#E5E5E5"> it and you</font>

711
00:31:35,520 --> 00:31:40,750
it has optional encryption on the<font color="#CCCCCC"> old</font>

712
00:31:39,220 --> 00:31:43,990
devices<font color="#E5E5E5"> you actually have to buy a</font>

713
00:31:40,750 --> 00:31:45,910
special<font color="#CCCCCC"> box to enable encryption</font><font color="#E5E5E5"> and on</font>

714
00:31:43,990 --> 00:31:48,310
the new ones it's integrated and<font color="#E5E5E5"> it's</font>

715
00:31:45,910 --> 00:31:51,310
used a lot<font color="#CCCCCC"> on electric grids and also a</font>

716
00:31:48,310 --> 00:31:54,360
lot on<font color="#CCCCCC"> water damage systems so on remote</font>

717
00:31:51,310 --> 00:31:57,159
water dams they use this<font color="#E5E5E5"> kind of</font>

718
00:31:54,360 --> 00:31:59,979
proprietary radio<font color="#E5E5E5"> and if we look inside</font>

719
00:31:57,160 --> 00:32:02,680
of<font color="#E5E5E5"> this device</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> we can see that some</font>

720
00:31:59,980 --> 00:32:06,550
of<font color="#E5E5E5"> them contain</font><font color="#CCCCCC"> a compute module or they</font>

721
00:32:02,680 --> 00:32:08,680
contain or they contain a flash that you

722
00:32:06,550 --> 00:32:11,169
can read out and the flash is not

723
00:32:08,680 --> 00:32:12,850
<font color="#CCCCCC">encrypted so you can read out the</font>

724
00:32:11,170 --> 00:32:14,830
<font color="#E5E5E5">encryption key from the flash and</font>

725
00:32:12,850 --> 00:32:18,040
because the<font color="#E5E5E5"> whole system</font><font color="#CCCCCC"> is based on</font><font color="#E5E5E5"> a</font>

726
00:32:14,830 --> 00:32:20,409
<font color="#E5E5E5">pre-shared key if you only a single</font>

727
00:32:18,040 --> 00:32:22,389
<font color="#E5E5E5">device of these you actually own the</font>

728
00:32:20,410 --> 00:32:23,980
entire<font color="#E5E5E5"> network so</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> have a key</font>

729
00:32:22,390 --> 00:32:26,050
extraction attack which allows full

730
00:32:23,980 --> 00:32:29,320
decryption of the traffic with these

731
00:32:26,050 --> 00:32:31,030
<font color="#E5E5E5">devices and I've also got</font><font color="#CCCCCC"> a new radio</font>

732
00:32:29,320 --> 00:32:32,879
module coming<font color="#E5E5E5"> up soon hopefully</font>

733
00:32:31,030 --> 00:32:35,370
so I reversed<font color="#E5E5E5"> and</font>

734
00:32:32,880 --> 00:32:38,280
<font color="#E5E5E5">the whole radio protocol which is a</font>

735
00:32:35,370 --> 00:32:42,830
qualm based<font color="#E5E5E5"> protocol and so hopefully</font>

736
00:32:38,280 --> 00:32:46,740
<font color="#CCCCCC">soon</font><font color="#E5E5E5"> we'll have</font><font color="#CCCCCC"> that on github and yeah</font>

737
00:32:42,830 --> 00:32:49,860
broken<font color="#CCCCCC"> too unfortunately</font><font color="#E5E5E5"> so what's the</font>

738
00:32:46,740 --> 00:32:52,320
<font color="#CCCCCC">answer obviously let's use VPN but then</font>

739
00:32:49,860 --> 00:32:56,090
if<font color="#E5E5E5"> you look</font><font color="#CCCCCC"> at the VPN stacks of all</font>

740
00:32:52,320 --> 00:32:59,610
these<font color="#CCCCCC"> devices</font><font color="#E5E5E5"> you will want</font><font color="#CCCCCC"> to cry</font>

741
00:32:56,090 --> 00:33:02,340
you have<font color="#E5E5E5"> broken</font><font color="#CCCCCC"> Eike parses</font><font color="#E5E5E5"> you have bad</font>

742
00:32:59,610 --> 00:33:04,830
crypto support you have SSL issues and

743
00:33:02,340 --> 00:33:07,949
on one device<font color="#CCCCCC"> I enabled VPN for</font>

744
00:33:04,830 --> 00:33:10,649
everything and then the<font color="#CCCCCC"> configuration</font>

745
00:33:07,950 --> 00:33:13,910
part<font color="#E5E5E5"> was still exposed without VPN and I</font>

746
00:33:10,650 --> 00:33:16,800
sent the vendor an email said hey guys

747
00:33:13,910 --> 00:33:18,720
<font color="#CCCCCC">how the hell do I turn this</font><font color="#E5E5E5"> up and</font><font color="#CCCCCC"> the</font>

748
00:33:16,800 --> 00:33:28,620
answer's no no we need this<font color="#E5E5E5"> in case the</font>

749
00:33:18,720 --> 00:33:32,700
VPN fails thank you yeah<font color="#CCCCCC"> so before we</font>

750
00:33:28,620 --> 00:33:34,889
finish some other devices are even worse

751
00:33:32,700 --> 00:33:36,300
like I looked at some<font color="#E5E5E5"> vendors but I</font>

752
00:33:34,890 --> 00:33:38,640
don't want you to get the<font color="#E5E5E5"> impression</font>

753
00:33:36,300 --> 00:33:40,770
<font color="#E5E5E5">that the others are better necessarily</font>

754
00:33:38,640 --> 00:33:43,410
quite some devices<font color="#E5E5E5"> that</font><font color="#CCCCCC"> are out there</font>

755
00:33:40,770 --> 00:33:45,870
<font color="#E5E5E5">run</font><font color="#CCCCCC"> across which</font><font color="#E5E5E5"> is like a real-time</font>

756
00:33:43,410 --> 00:33:48,750
operating<font color="#E5E5E5"> system which had its last</font>

757
00:33:45,870 --> 00:33:50,520
<font color="#E5E5E5">release nine years ago no memory</font>

758
00:33:48,750 --> 00:33:53,910
protection whatsoever no<font color="#E5E5E5"> threat</font>

759
00:33:50,520 --> 00:33:57,300
separation nothing<font color="#E5E5E5"> some devices run</font>

760
00:33:53,910 --> 00:33:59,310
<font color="#CCCCCC">linux 2.4</font><font color="#E5E5E5"> that you can buy</font><font color="#CCCCCC"> today and</font>

761
00:33:57,300 --> 00:34:00,899
they still ship<font color="#E5E5E5"> software updates</font><font color="#CCCCCC"> I</font>

762
00:33:59,310 --> 00:34:02,760
imagine they have like a<font color="#E5E5E5"> very old</font>

763
00:34:00,900 --> 00:34:05,310
computer<font color="#E5E5E5"> somewhere in the closet where</font>

764
00:34:02,760 --> 00:34:07,680
they go<font color="#E5E5E5"> to build a new software release</font>

765
00:34:05,310 --> 00:34:09,719
for this<font color="#E5E5E5"> I don't know and some others</font>

766
00:34:07,680 --> 00:34:11,580
even<font color="#E5E5E5"> have unfixed public vulnerabilities</font>

767
00:34:09,719 --> 00:34:14,189
and for<font color="#E5E5E5"> example you can</font><font color="#CCCCCC"> find a lot of</font>

768
00:34:11,580 --> 00:34:16,469
<font color="#CCCCCC">cheaper</font><font color="#E5E5E5"> serial to Ethernet gateways on</font>

769
00:34:14,190 --> 00:34:18,060
ebay from<font color="#E5E5E5"> they all look the</font><font color="#CCCCCC"> same but</font>

770
00:34:16,469 --> 00:34:20,100
they all come from<font color="#CCCCCC"> different vendors</font><font color="#E5E5E5"> so</font>

771
00:34:18,060 --> 00:34:22,590
I guess it's just<font color="#E5E5E5"> some</font><font color="#CCCCCC"> ODM situation and</font>

772
00:34:20,100 --> 00:34:25,440
this thing even has backdoor ssh

773
00:34:22,590 --> 00:34:26,820
accounts if<font color="#E5E5E5"> you see a console it you can</font>

774
00:34:25,440 --> 00:34:31,470
see that<font color="#CCCCCC"> there are backdoor accounts</font>

775
00:34:26,820 --> 00:34:36,770
<font color="#E5E5E5">everywhere around</font><font color="#CCCCCC"> it so</font><font color="#E5E5E5"> we</font><font color="#CCCCCC"> really</font><font color="#E5E5E5"> have</font>

776
00:34:31,469 --> 00:34:36,770
an<font color="#E5E5E5"> issue so</font><font color="#CCCCCC"> to summarize shits on fire</font>

777
00:34:40,159 --> 00:34:46,290
we have no integrity protections on any

778
00:34:43,649 --> 00:34:48,659
of the devices<font color="#E5E5E5"> like we literally cannot</font>

779
00:34:46,290 --> 00:34:50,399
ensure that the device has not been

780
00:34:48,659 --> 00:34:52,440
tampered<font color="#CCCCCC"> with or supplies original</font>

781
00:34:50,399 --> 00:34:54,359
firmware<font color="#CCCCCC"> and for</font><font color="#E5E5E5"> example if you look</font><font color="#CCCCCC"> at</font>

782
00:34:52,440 --> 00:34:56,790
the<font color="#E5E5E5"> firmware download portals they are</font>

783
00:34:54,359 --> 00:34:58,980
crazy<font color="#CCCCCC"> insecure</font><font color="#E5E5E5"> two of them for</font><font color="#CCCCCC"> example</font>

784
00:34:56,790 --> 00:35:00,750
on<font color="#CCCCCC"> Schneider we had trivial cross-site</font>

785
00:34:58,980 --> 00:35:03,270
scripting which can be used<font color="#E5E5E5"> for phishing</font>

786
00:35:00,750 --> 00:35:04,890
attacks<font color="#E5E5E5"> so you can just send somebody an</font>

787
00:35:03,270 --> 00:35:07,130
official Schneider link and provide<font color="#CCCCCC"> your</font>

788
00:35:04,890 --> 00:35:10,140
own<font color="#E5E5E5"> firmware we have no agitation</font>

789
00:35:07,130 --> 00:35:11,730
functionality no security mitigation so

790
00:35:10,140 --> 00:35:13,980
if you look at<font color="#E5E5E5"> it there's no</font><font color="#CCCCCC"> a SLR</font>

791
00:35:11,730 --> 00:35:16,369
there's no<font color="#E5E5E5"> annex there's no it's like</font>

792
00:35:13,980 --> 00:35:18,859
exploiting in the 90s really<font color="#E5E5E5"> it's and</font>

793
00:35:16,369 --> 00:35:21,599
from my perspective there's<font color="#CCCCCC"> also</font>

794
00:35:18,859 --> 00:35:24,630
unfortunately<font color="#E5E5E5"> not really a security</font>

795
00:35:21,599 --> 00:35:26,550
culture<font color="#E5E5E5"> with a lot of these vendors not</font>

796
00:35:24,630 --> 00:35:28,740
<font color="#E5E5E5">all of them</font><font color="#CCCCCC"> I actually</font><font color="#E5E5E5"> after I first</font>

797
00:35:26,550 --> 00:35:31,140
talked about<font color="#CCCCCC"> these</font><font color="#E5E5E5"> devices a lot of</font>

798
00:35:28,740 --> 00:35:34,020
vendors including<font color="#CCCCCC"> moxa contacted me and</font>

799
00:35:31,140 --> 00:35:36,779
were very<font color="#E5E5E5"> nice and very engaging in the</font>

800
00:35:34,020 --> 00:35:39,750
whole process<font color="#E5E5E5"> but yeah I still think</font>

801
00:35:36,780 --> 00:35:41,369
<font color="#CCCCCC">these are big issues</font><font color="#E5E5E5"> so with that thank</font>

802
00:35:39,750 --> 00:35:42,590
you<font color="#CCCCCC"> very much for coming and</font><font color="#E5E5E5"> I hope</font><font color="#CCCCCC"> you</font>

803
00:35:41,369 --> 00:35:51,849
enjoyed this talk

804
00:35:42,590 --> 00:35:51,849
[Applause]

