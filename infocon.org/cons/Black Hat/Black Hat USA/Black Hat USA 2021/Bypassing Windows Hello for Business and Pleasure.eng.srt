1
00:00:01,130 --> 00:00:13,518
[Music]

2
00:00:13,519 --> 00:00:16,000
hello everybody and welcome to my talk

3
00:00:16,000 --> 00:00:18,240
bypassing windows hello for business and

4
00:00:18,240 --> 00:00:19,279
pleasure

5
00:00:19,279 --> 00:00:21,439
my name is ahmad salfati i'm a security

6
00:00:21,439 --> 00:00:24,400
researcher at cyber clubs

7
00:00:24,400 --> 00:00:27,279
i'm 24 years old and i'm for six years

8
00:00:27,279 --> 00:00:29,920
in the security industry

9
00:00:29,920 --> 00:00:31,840
and for those of you who play call of

10
00:00:31,840 --> 00:00:33,840
duty i'm a vehicle of duty fan so feel

11
00:00:33,840 --> 00:00:35,680
free to contact me and we'll play

12
00:00:35,680 --> 00:00:37,200
together

13
00:00:37,200 --> 00:00:39,360
so what will we have today

14
00:00:39,360 --> 00:00:40,399
we'll talk a little bit about

15
00:00:40,399 --> 00:00:42,960
passwordless what is passwordless why

16
00:00:42,960 --> 00:00:45,440
should we use passwordless uh instead of

17
00:00:45,440 --> 00:00:46,640
or

18
00:00:46,640 --> 00:00:49,039
of existing authentication methods

19
00:00:49,039 --> 00:00:51,280
now then we'll speak about windows hello

20
00:00:51,280 --> 00:00:54,719
which is a relatively new microsoft

21
00:00:54,719 --> 00:00:56,480
password resolution

22
00:00:56,480 --> 00:00:58,719
and then we will talk about the main

23
00:00:58,719 --> 00:01:01,199
part of this research that we did

24
00:01:01,199 --> 00:01:03,840
and on how we managed to bypass uh

25
00:01:03,840 --> 00:01:06,000
windows low fashion recognition at the

26
00:01:06,000 --> 00:01:08,159
end we'll talk about what could be done

27
00:01:08,159 --> 00:01:10,720
even further more in the research and

28
00:01:10,720 --> 00:01:12,560
for any of you that would like to

29
00:01:12,560 --> 00:01:14,880
continue this research is more than

30
00:01:14,880 --> 00:01:16,000
welcome to

31
00:01:16,000 --> 00:01:18,240
look at this part um

32
00:01:18,240 --> 00:01:19,680
very closely

33
00:01:19,680 --> 00:01:22,000
anyway by the end of this talk you will

34
00:01:22,000 --> 00:01:24,560
should know by 85 percent what windows

35
00:01:24,560 --> 00:01:28,000
low is and some of its features by 50

36
00:01:28,000 --> 00:01:31,600
about usb and ufc by 10 you should be a

37
00:01:31,600 --> 00:01:33,439
little bit confused and you should have

38
00:01:33,439 --> 00:01:35,119
a lot a lot of fun

39
00:01:35,119 --> 00:01:36,000
right

40
00:01:36,000 --> 00:01:38,560
let's go let's start uh let's talk about

41
00:01:38,560 --> 00:01:42,159
passwordless um so what is passwordless

42
00:01:42,159 --> 00:01:45,439
uh so passwordless it's kind of

43
00:01:45,439 --> 00:01:46,720
all right so before we're talking about

44
00:01:46,720 --> 00:01:48,320
passwordless let's talk why we should

45
00:01:48,320 --> 00:01:50,799
use passwordless uh i mean we have

46
00:01:50,799 --> 00:01:52,320
existing authentication methods we have

47
00:01:52,320 --> 00:01:54,799
passwords we're using those four years

48
00:01:54,799 --> 00:01:58,240
and we why we should replace them so

49
00:01:58,240 --> 00:02:00,079
underneath passwords there is a lot of

50
00:02:00,079 --> 00:02:03,119
problems inherent uh i mean we are human

51
00:02:03,119 --> 00:02:04,399
and we

52
00:02:04,399 --> 00:02:06,640
tend to use weak passwords because we

53
00:02:06,640 --> 00:02:09,440
want to to choose password that is

54
00:02:09,440 --> 00:02:11,038
really easy to remember

55
00:02:11,038 --> 00:02:15,200
um there is there are data breaches so

56
00:02:15,200 --> 00:02:17,440
once we are giving vendor or server or

57
00:02:17,440 --> 00:02:20,160
password it should save it somewhere in

58
00:02:20,160 --> 00:02:22,239
database or something like this in some

59
00:02:22,239 --> 00:02:26,879
cases it saves it's saved as a version

60
00:02:26,879 --> 00:02:29,440
of our password and in some other

61
00:02:29,440 --> 00:02:30,480
less good

62
00:02:30,480 --> 00:02:33,360
cases it saves as plain text and once

63
00:02:33,360 --> 00:02:35,200
accurate so attackers bridging in and

64
00:02:35,200 --> 00:02:39,120
and steal those passwords you might um

65
00:02:39,120 --> 00:02:40,720
they might get our password so it's

66
00:02:40,720 --> 00:02:42,959
really bad and the third thing it's

67
00:02:42,959 --> 00:02:45,920
phishing attacks so phishing attacks um

68
00:02:45,920 --> 00:02:48,000
it's a major problem because we are

69
00:02:48,000 --> 00:02:50,640
human and we tend to to fall to them we

70
00:02:50,640 --> 00:02:53,040
tend to give our passwords

71
00:02:53,040 --> 00:02:56,239
on our will to attackers and hackers and

72
00:02:56,239 --> 00:02:59,680
and so this is another big problem

73
00:02:59,680 --> 00:03:00,400
and

74
00:03:00,400 --> 00:03:02,319
as i mentioned before we are human and

75
00:03:02,319 --> 00:03:04,000
we we don't want to remember a lot of

76
00:03:04,000 --> 00:03:06,239
things so we will use passwords and

77
00:03:06,239 --> 00:03:08,480
actually do this so we reuse our

78
00:03:08,480 --> 00:03:10,640
passwords for many vendors and if one of

79
00:03:10,640 --> 00:03:12,800
them got bridged we

80
00:03:12,800 --> 00:03:15,040
actually lose all of our all of our

81
00:03:15,040 --> 00:03:16,159
accounts

82
00:03:16,159 --> 00:03:18,879
so now we understand that passwords are

83
00:03:18,879 --> 00:03:21,760
kind of not that good as we thought uh

84
00:03:21,760 --> 00:03:22,959
so

85
00:03:22,959 --> 00:03:25,440
let's use password less so what is

86
00:03:25,440 --> 00:03:27,840
passwordless uh so how you should do

87
00:03:27,840 --> 00:03:30,159
passwordless so passwordless is any

88
00:03:30,159 --> 00:03:32,879
authentication method that doesn't

89
00:03:32,879 --> 00:03:35,200
really

90
00:03:35,519 --> 00:03:37,200
require you to

91
00:03:37,200 --> 00:03:38,560
send a password

92
00:03:38,560 --> 00:03:40,720
so like fingerprint scanning or facial

93
00:03:40,720 --> 00:03:43,680
recognition security key or otp all of

94
00:03:43,680 --> 00:03:46,640
those are variants of passwordless

95
00:03:46,640 --> 00:03:48,159
solutions

96
00:03:48,159 --> 00:03:50,480
about otp so otp it's kind of one-time

97
00:03:50,480 --> 00:03:52,799
passwords and it might

98
00:03:52,799 --> 00:03:54,080
not be

99
00:03:54,080 --> 00:03:55,599
it might not sound as a possible

100
00:03:55,599 --> 00:03:58,159
resolution but because it's one-time

101
00:03:58,159 --> 00:04:00,159
password and you can only use it one

102
00:04:00,159 --> 00:04:02,000
time it's considered as possible the

103
00:04:02,000 --> 00:04:03,120
solution

104
00:04:03,120 --> 00:04:04,000
so

105
00:04:04,000 --> 00:04:05,840
now we we understand that passwords are

106
00:04:05,840 --> 00:04:08,400
bad and what is passwordless how

107
00:04:08,400 --> 00:04:12,080
passwordless solution implemented in in

108
00:04:12,080 --> 00:04:15,519
in different ways so let's talk about

109
00:04:15,519 --> 00:04:18,238
one of the uh most common implementation

110
00:04:18,238 --> 00:04:20,798
of passwordless which is windows hello

111
00:04:20,798 --> 00:04:22,880
uh as i mentioned before windows hello

112
00:04:22,880 --> 00:04:25,840
it's microsoft a

113
00:04:25,840 --> 00:04:28,479
relatively new password resolution

114
00:04:28,479 --> 00:04:31,360
so say hello to windows hello

115
00:04:31,360 --> 00:04:33,600
right so windows low and

116
00:04:33,600 --> 00:04:35,840
it's for everyone everyone can use it

117
00:04:35,840 --> 00:04:37,360
either if you're enterprise or home

118
00:04:37,360 --> 00:04:40,000
consumer the main difference between

119
00:04:40,000 --> 00:04:42,320
those those fit

120
00:04:42,320 --> 00:04:45,360
those implementation it's their main

121
00:04:45,360 --> 00:04:48,639
purpose so for enterprise solutions um

122
00:04:48,639 --> 00:04:51,360
it's it will give you the ability to um

123
00:04:51,360 --> 00:04:54,080
to authenticate uh via domain or azure

124
00:04:54,080 --> 00:04:56,240
assets and for home consumer it's

125
00:04:56,240 --> 00:04:57,280
actually

126
00:04:57,280 --> 00:04:58,639
kind of

127
00:04:58,639 --> 00:05:00,880
replacing your passwords it's it's not

128
00:05:00,880 --> 00:05:02,000
actually what happening in the

129
00:05:02,000 --> 00:05:04,960
background because your

130
00:05:04,960 --> 00:05:07,440
your password hash is still remain on

131
00:05:07,440 --> 00:05:09,759
your device but your pin code will let

132
00:05:09,759 --> 00:05:11,840
you access it the system will access it

133
00:05:11,840 --> 00:05:14,320
and then you can still use it

134
00:05:14,320 --> 00:05:16,800
right so let's talk about windows hello

135
00:05:16,800 --> 00:05:19,840
features so windows hello has three main

136
00:05:19,840 --> 00:05:21,199
features

137
00:05:21,199 --> 00:05:23,759
face recognition which relying on ir

138
00:05:23,759 --> 00:05:26,080
sensor and advanced analysis of the

139
00:05:26,080 --> 00:05:28,560
frames that coming from the io sensor

140
00:05:28,560 --> 00:05:31,600
pin code which is a kind of replacing

141
00:05:31,600 --> 00:05:34,240
your password with another password

142
00:05:34,240 --> 00:05:36,880
local password and fingerprint

143
00:05:36,880 --> 00:05:38,400
authentication

144
00:05:38,400 --> 00:05:41,360
which we all know for years

145
00:05:41,360 --> 00:05:42,479
right so

146
00:05:42,479 --> 00:05:43,600
we we

147
00:05:43,600 --> 00:05:45,600
wanted to do a research on windows allow

148
00:05:45,600 --> 00:05:48,720
because it's passwords it's cool and um

149
00:05:48,720 --> 00:05:51,520
we thought which which feature should we

150
00:05:51,520 --> 00:05:53,360
do research on

151
00:05:53,360 --> 00:05:54,800
so

152
00:05:54,800 --> 00:05:57,680
we we we did a little a little overview

153
00:05:57,680 --> 00:05:58,880
on all the

154
00:05:58,880 --> 00:06:01,759
uh all the solutions on all the

155
00:06:01,759 --> 00:06:03,600
different features

156
00:06:03,600 --> 00:06:05,840
and we try to consider what would be the

157
00:06:05,840 --> 00:06:08,160
best option to do a research on

158
00:06:08,160 --> 00:06:09,680
um

159
00:06:09,680 --> 00:06:12,240
fingerprint so the to collect the data

160
00:06:12,240 --> 00:06:13,440
the fingerprint

161
00:06:13,440 --> 00:06:15,840
scanning of images itself will be really

162
00:06:15,840 --> 00:06:18,479
hard besides that there is a lot of

163
00:06:18,479 --> 00:06:20,479
previous art on

164
00:06:20,479 --> 00:06:23,919
on this um area i mean i think there in

165
00:06:23,919 --> 00:06:26,240
2006 in blackhead there was a research

166
00:06:26,240 --> 00:06:28,160
on this there there there was a top on

167
00:06:28,160 --> 00:06:31,120
this and the protocol is kind of uh how

168
00:06:31,120 --> 00:06:33,280
to implement and there is not a lot of a

169
00:06:33,280 --> 00:06:35,759
public implementation for this

170
00:06:35,759 --> 00:06:37,440
pin code

171
00:06:37,440 --> 00:06:39,680
so pin code as anti-brute force

172
00:06:39,680 --> 00:06:42,160
mechanism so we couldn't really do a

173
00:06:42,160 --> 00:06:44,400
brute force on this and we we thought it

174
00:06:44,400 --> 00:06:46,160
will be the same challenge as trying to

175
00:06:46,160 --> 00:06:48,080
break your regular passwords for the

176
00:06:48,080 --> 00:06:49,120
computer

177
00:06:49,120 --> 00:06:51,840
so we we didn't want to

178
00:06:51,840 --> 00:06:54,080
choose this as well

179
00:06:54,080 --> 00:06:55,759
and then so

180
00:06:55,759 --> 00:06:58,000
the third feature that we did the

181
00:06:58,000 --> 00:06:59,919
overview on which is the last one is

182
00:06:59,919 --> 00:07:03,039
face face recognition so facial

183
00:07:03,039 --> 00:07:05,440
condition also has an anti-brutal

184
00:07:05,440 --> 00:07:06,960
mechanism

185
00:07:06,960 --> 00:07:10,240
it is more easy to to start doing a

186
00:07:10,240 --> 00:07:12,319
research on this because

187
00:07:12,319 --> 00:07:14,479
nxp which is a major vendor in the

188
00:07:14,479 --> 00:07:17,440
electronic industry implemented a basic

189
00:07:17,440 --> 00:07:19,759
usb device which you could use as a

190
00:07:19,759 --> 00:07:21,440
reference and

191
00:07:21,440 --> 00:07:23,120
your face at the end of the day it's

192
00:07:23,120 --> 00:07:25,840
kind of a public data i mean

193
00:07:25,840 --> 00:07:27,680
we can capture this

194
00:07:27,680 --> 00:07:30,400
relatively easily so

195
00:07:30,400 --> 00:07:33,680
we choose to do a research on this

196
00:07:33,680 --> 00:07:36,960
and and then we we try to figure out how

197
00:07:36,960 --> 00:07:39,039
we should do the research i mean we

198
00:07:39,039 --> 00:07:41,680
should first understand how um how

199
00:07:41,680 --> 00:07:43,840
parametric authentication in windows

200
00:07:43,840 --> 00:07:46,000
actually happens in the kind of an

201
00:07:46,000 --> 00:07:47,440
overview

202
00:07:47,440 --> 00:07:48,639
so

203
00:07:48,639 --> 00:07:51,599
we are starting from application or or

204
00:07:51,599 --> 00:07:53,759
credential provider that want to do

205
00:07:53,759 --> 00:07:55,440
authentication and

206
00:07:55,440 --> 00:07:58,080
biometric authentication then it uses

207
00:07:58,080 --> 00:08:01,199
win biodll that advertion will

208
00:08:01,199 --> 00:08:03,039
communicate with the windows biometric

209
00:08:03,039 --> 00:08:04,319
service

210
00:08:04,319 --> 00:08:07,360
to do this biometric authentication the

211
00:08:07,360 --> 00:08:10,720
magnetic authentication is divided into

212
00:08:10,720 --> 00:08:12,319
three parts i mean the facial

213
00:08:12,319 --> 00:08:13,520
recognition

214
00:08:13,520 --> 00:08:16,000
is divided into three parts the storage

215
00:08:16,000 --> 00:08:18,240
adapter engine adapter and sensor

216
00:08:18,240 --> 00:08:19,680
adapter

217
00:08:19,680 --> 00:08:21,440
the storage adapter

218
00:08:21,440 --> 00:08:23,039
will get the information that the

219
00:08:23,039 --> 00:08:25,440
biometric templates that are saved on

220
00:08:25,440 --> 00:08:28,639
your device from uh from the windows

221
00:08:28,639 --> 00:08:30,240
biometric database

222
00:08:30,240 --> 00:08:33,679
which is a folder in system 32 and

223
00:08:33,679 --> 00:08:36,159
which contains many different database

224
00:08:36,159 --> 00:08:38,320
for different and

225
00:08:38,320 --> 00:08:39,599
different

226
00:08:39,599 --> 00:08:42,159
authentications and face recognition as

227
00:08:42,159 --> 00:08:45,200
its own database there uh and

228
00:08:45,200 --> 00:08:47,360
there is another adapter sensor adapter

229
00:08:47,360 --> 00:08:50,720
that is actually responsible for

230
00:08:50,720 --> 00:08:53,040
communicating with the external uh

231
00:08:53,040 --> 00:08:56,160
camera io sensor and there is the engine

232
00:08:56,160 --> 00:08:59,360
adapter the engine adapter is

233
00:08:59,360 --> 00:09:00,640
is the one that

234
00:09:00,640 --> 00:09:04,320
responsible for um for deciding either

235
00:09:04,320 --> 00:09:07,120
to log you in or not

236
00:09:07,120 --> 00:09:09,600
uh right

237
00:09:09,600 --> 00:09:12,160
uh so after we created this graph we

238
00:09:12,160 --> 00:09:13,839
look at it and we thought what would be

239
00:09:13,839 --> 00:09:16,560
the best uh place to

240
00:09:16,560 --> 00:09:18,720
to to do a research on i mean we don't

241
00:09:18,720 --> 00:09:21,040
have any kind of

242
00:09:21,040 --> 00:09:24,160
um code execution on the device so most

243
00:09:24,160 --> 00:09:26,320
of the parts are not relevant and the

244
00:09:26,320 --> 00:09:28,560
only only part that we kind of can

245
00:09:28,560 --> 00:09:30,800
control is the sensor

246
00:09:30,800 --> 00:09:32,240
so

247
00:09:32,240 --> 00:09:34,640
we we consider the following things so

248
00:09:34,640 --> 00:09:36,320
at first we thought that it would be

249
00:09:36,320 --> 00:09:38,080
cool to run a

250
00:09:38,080 --> 00:09:41,120
code on the sensor itself but actually

251
00:09:41,120 --> 00:09:42,800
it will be a standalone research for

252
00:09:42,800 --> 00:09:45,360
itself and we didn't want to go there

253
00:09:45,360 --> 00:09:47,920
and the other way is to beat a sensor so

254
00:09:47,920 --> 00:09:52,399
we we implemented a kind of a inform

255
00:09:52,399 --> 00:09:56,720
ir camera uh out of nothing uh we we

256
00:09:56,720 --> 00:09:58,959
um we used an xp evaluation board for

257
00:09:58,959 --> 00:10:02,079
this and um we will talk later why we

258
00:10:02,079 --> 00:10:04,399
use this and one of the main reasons you

259
00:10:04,399 --> 00:10:06,079
actually use this is because as i

260
00:10:06,079 --> 00:10:07,839
mentioned before there is an example

261
00:10:07,839 --> 00:10:09,519
project which we could use as a

262
00:10:09,519 --> 00:10:11,040
reference

263
00:10:11,040 --> 00:10:13,040
so it will be much more convenient for

264
00:10:13,040 --> 00:10:14,160
us to

265
00:10:14,160 --> 00:10:16,399
to actually use nxp

266
00:10:16,399 --> 00:10:18,720
right so we talk about

267
00:10:18,720 --> 00:10:20,959
windows hello about password less about

268
00:10:20,959 --> 00:10:22,640
what we want to do in the research so

269
00:10:22,640 --> 00:10:24,640
let's talk about the research

270
00:10:24,640 --> 00:10:25,680
uh

271
00:10:25,680 --> 00:10:28,160
so part three exploiting show me the

272
00:10:28,160 --> 00:10:29,680
money

273
00:10:29,680 --> 00:10:31,920
so the research vector is divided into

274
00:10:31,920 --> 00:10:34,720
four parts the first one will be analyze

275
00:10:34,720 --> 00:10:37,440
and before we try to implement a usb

276
00:10:37,440 --> 00:10:40,079
device we first want to

277
00:10:40,079 --> 00:10:42,800
implement to understand what usb and usb

278
00:10:42,800 --> 00:10:44,800
and uvc is

279
00:10:44,800 --> 00:10:47,519
then after this we will mimic the usb

280
00:10:47,519 --> 00:10:50,560
device um which actually we will create

281
00:10:50,560 --> 00:10:52,720
kind of a low camera a

282
00:10:52,720 --> 00:10:53,600
usb

283
00:10:53,600 --> 00:10:55,440
video camera that

284
00:10:55,440 --> 00:10:58,399
is compatible with windows low and can

285
00:10:58,399 --> 00:11:00,800
function as a regular windows hello

286
00:11:00,800 --> 00:11:03,839
camera then we will capture the person

287
00:11:03,839 --> 00:11:06,160
that we uh put his target

288
00:11:06,160 --> 00:11:07,839
for us to log into his account and

289
00:11:07,839 --> 00:11:10,320
bypass windows authentication and we

290
00:11:10,320 --> 00:11:12,560
will bypass windows hello

291
00:11:12,560 --> 00:11:14,720
all right so let's talk about uh the

292
00:11:14,720 --> 00:11:19,440
first uh the first part the analyze so

293
00:11:19,440 --> 00:11:21,519
that that section is divided to two main

294
00:11:21,519 --> 00:11:23,519
parts at first we need to understand the

295
00:11:23,519 --> 00:11:26,399
usb specs and then we will need to

296
00:11:26,399 --> 00:11:29,279
capture the traffic and

297
00:11:29,279 --> 00:11:30,240
so

298
00:11:30,240 --> 00:11:32,800
capturing traffic will be used we will

299
00:11:32,800 --> 00:11:35,760
do it via wireshark uh with the plug-in

300
00:11:35,760 --> 00:11:38,720
a usb pickup and the usb specs

301
00:11:38,720 --> 00:11:41,680
the way that we chose to do the research

302
00:11:41,680 --> 00:11:43,839
to understand the usb spec is to read

303
00:11:43,839 --> 00:11:47,040
the usb spec and we read it we read we

304
00:11:47,040 --> 00:11:48,560
read we read a lot

305
00:11:48,560 --> 00:11:51,440
too much and we we we went to offsite i

306
00:11:51,440 --> 00:11:54,639
mean it's it's too many um

307
00:11:54,639 --> 00:11:55,360
and

308
00:11:55,360 --> 00:11:58,000
and i thought what would be the best way

309
00:11:58,000 --> 00:11:58,959
to

310
00:11:58,959 --> 00:12:01,600
to explain to you guys for those of you

311
00:12:01,600 --> 00:12:04,720
who are not familiar with usb and uvc uh

312
00:12:04,720 --> 00:12:06,399
the usb specs

313
00:12:06,399 --> 00:12:07,920
at least the the

314
00:12:07,920 --> 00:12:09,680
usb framework

315
00:12:09,680 --> 00:12:13,600
so we choose to do it in a kind of story

316
00:12:13,600 --> 00:12:14,399
so

317
00:12:14,399 --> 00:12:16,079
this is usb

318
00:12:16,079 --> 00:12:19,200
usb it's it's a nice guy

319
00:12:19,200 --> 00:12:20,720
and it's

320
00:12:20,720 --> 00:12:22,880
usb first day at school so you went to

321
00:12:22,880 --> 00:12:24,720
school and then

322
00:12:24,720 --> 00:12:25,760
he met

323
00:12:25,760 --> 00:12:27,040
austin

324
00:12:27,040 --> 00:12:29,040
and austin it's a bully

325
00:12:29,040 --> 00:12:32,000
and our usb is a nice guy

326
00:12:32,000 --> 00:12:33,200
and austin

327
00:12:33,200 --> 00:12:34,320
came to

328
00:12:34,320 --> 00:12:36,320
to usb and asked him who the hell are

329
00:12:36,320 --> 00:12:39,200
you and they used to be told them

330
00:12:39,200 --> 00:12:40,880
i would say everything everything that

331
00:12:40,880 --> 00:12:44,240
you want to know uh let me do it um

332
00:12:44,240 --> 00:12:46,160
in a great detail so

333
00:12:46,160 --> 00:12:47,920
because he was afraid of fasting that he

334
00:12:47,920 --> 00:12:50,320
will beat him up uh he won't consider

335
00:12:50,320 --> 00:12:51,920
what would be the best day to do this so

336
00:12:51,920 --> 00:12:54,399
the best day for him to do this was via

337
00:12:54,399 --> 00:12:55,839
descriptors

338
00:12:55,839 --> 00:12:58,000
so he started to describe himself at

339
00:12:58,000 --> 00:13:00,480
first he started with device scripto and

340
00:13:00,480 --> 00:13:02,160
where he's coming from

341
00:13:02,160 --> 00:13:03,600
everybody and

342
00:13:03,600 --> 00:13:06,160
every descriptor has a lot of fields and

343
00:13:06,160 --> 00:13:08,480
most of them are not really interesting

344
00:13:08,480 --> 00:13:11,519
but the most interesting um fields are

345
00:13:11,519 --> 00:13:14,240
the bcd usb which is the version of the

346
00:13:14,240 --> 00:13:17,519
usb device and those three

347
00:13:17,519 --> 00:13:18,720
those three

348
00:13:18,720 --> 00:13:20,800
fields which is i defend or id product

349
00:13:20,800 --> 00:13:22,880
and bcd device at the event though it's

350
00:13:22,880 --> 00:13:24,399
the id of the

351
00:13:24,399 --> 00:13:26,480
of the vendor id product the idea of the

352
00:13:26,480 --> 00:13:28,079
product and the bcd device is the

353
00:13:28,079 --> 00:13:29,200
version

354
00:13:29,200 --> 00:13:30,720
of the device

355
00:13:30,720 --> 00:13:32,000
right so

356
00:13:32,000 --> 00:13:33,600
besides that

357
00:13:33,600 --> 00:13:35,760
mr nice guy wants to tell about his

358
00:13:35,760 --> 00:13:37,600
abilities and features to ask him

359
00:13:37,600 --> 00:13:41,040
because again he's really terrified uh

360
00:13:41,040 --> 00:13:43,920
that uh austin will beat him up and he

361
00:13:43,920 --> 00:13:46,000
started to do it via configuration

362
00:13:46,000 --> 00:13:46,959
script

363
00:13:46,959 --> 00:13:50,160
so he sent a configuration descriptor to

364
00:13:50,160 --> 00:13:51,519
to austin

365
00:13:51,519 --> 00:13:52,720
and uh

366
00:13:52,720 --> 00:13:55,360
and austin because

367
00:13:55,360 --> 00:13:57,760
nothing needs to allocate enough memory

368
00:13:57,760 --> 00:14:01,519
for the descriptor and because every usb

369
00:14:01,519 --> 00:14:03,279
device is a bit different from one

370
00:14:03,279 --> 00:14:05,920
another um

371
00:14:05,920 --> 00:14:07,040
the the configuration the full

372
00:14:07,040 --> 00:14:09,440
configuration device which describes all

373
00:14:09,440 --> 00:14:11,040
the abilities and features of the usb

374
00:14:11,040 --> 00:14:13,680
device it's a bit different so therefore

375
00:14:13,680 --> 00:14:15,040
the length of the configuration

376
00:14:15,040 --> 00:14:17,279
descripto will be

377
00:14:17,279 --> 00:14:20,079
will be either longer or shorter

378
00:14:20,079 --> 00:14:21,199
um

379
00:14:21,199 --> 00:14:24,000
and the endos and austin should know um

380
00:14:24,000 --> 00:14:26,000
how much memory to allocate so at first

381
00:14:26,000 --> 00:14:28,639
we are sending an intro intro includes

382
00:14:28,639 --> 00:14:30,399
the the total length of the

383
00:14:30,399 --> 00:14:32,000
configuration

384
00:14:32,000 --> 00:14:34,800
and uh usb device sending to austin and

385
00:14:34,800 --> 00:14:37,360
austin now want to know

386
00:14:37,360 --> 00:14:39,360
what is the full abilities of the usb

387
00:14:39,360 --> 00:14:41,199
device usb device

388
00:14:41,199 --> 00:14:43,519
send it to austin

389
00:14:43,519 --> 00:14:46,959
right so i hope you understood

390
00:14:46,959 --> 00:14:48,560
what a configuration descriptor and

391
00:14:48,560 --> 00:14:50,959
devices

392
00:14:51,120 --> 00:14:52,320
and

393
00:14:52,320 --> 00:14:55,519
this is was our story about a usb

394
00:14:55,519 --> 00:14:57,440
mr nice guy

395
00:14:57,440 --> 00:14:59,199
and

396
00:14:59,199 --> 00:15:00,720
all right so

397
00:15:00,720 --> 00:15:03,600
after we we we captured all this

398
00:15:03,600 --> 00:15:06,320
information uh we saved it for later

399
00:15:06,320 --> 00:15:08,560
years because if because we want to

400
00:15:08,560 --> 00:15:11,040
mimic the usb device and we want to send

401
00:15:11,040 --> 00:15:13,199
all this metadata to this

402
00:15:13,199 --> 00:15:16,959
to the host as we were the uh original

403
00:15:16,959 --> 00:15:18,480
camera device

404
00:15:18,480 --> 00:15:20,959
all right so for any of you that want

405
00:15:20,959 --> 00:15:22,240
even to

406
00:15:22,240 --> 00:15:24,480
to learn more about usb the best the

407
00:15:24,480 --> 00:15:26,959
best way to do this is either by reading

408
00:15:26,959 --> 00:15:29,920
the usb specs uh which you can find

409
00:15:29,920 --> 00:15:32,959
those in the usb if uh

410
00:15:32,959 --> 00:15:34,240
website

411
00:15:34,240 --> 00:15:37,920
uh or either you uh read it in um

412
00:15:37,920 --> 00:15:40,320
and beyond in beyond logic website there

413
00:15:40,320 --> 00:15:42,880
is a good article called usb in a

414
00:15:42,880 --> 00:15:45,279
nutshell so you totally should take a

415
00:15:45,279 --> 00:15:47,279
look on this

416
00:15:47,279 --> 00:15:50,240
right so now we finish the first part

417
00:15:50,240 --> 00:15:53,360
which is analyze usb ubc and now let's

418
00:15:53,360 --> 00:15:56,079
go to the mimic part so also this part

419
00:15:56,079 --> 00:15:58,079
will be divided into two

420
00:15:58,079 --> 00:16:00,560
the first one will be uh implement

421
00:16:00,560 --> 00:16:03,279
implementing the usb camera

422
00:16:03,279 --> 00:16:05,199
with our um

423
00:16:05,199 --> 00:16:07,360
evaluation board device

424
00:16:07,360 --> 00:16:10,320
using the reference that nxp

425
00:16:10,320 --> 00:16:13,759
implemented and the second part will be

426
00:16:13,759 --> 00:16:16,240
make the usb device that we just created

427
00:16:16,240 --> 00:16:19,440
compatible with windows hello

428
00:16:19,440 --> 00:16:20,880
right so

429
00:16:20,880 --> 00:16:23,040
this process will look like this at

430
00:16:23,040 --> 00:16:26,720
first we'll download the nxp ide which

431
00:16:26,720 --> 00:16:30,160
called mcu expresso and then we'll

432
00:16:30,160 --> 00:16:32,480
import the sdk example

433
00:16:32,480 --> 00:16:34,639
which called their video

434
00:16:34,639 --> 00:16:36,880
virtual camera vm

435
00:16:36,880 --> 00:16:38,560
and then we'll need to

436
00:16:38,560 --> 00:16:41,600
uh configure it configure the

437
00:16:41,600 --> 00:16:44,399
the example project uh to match the

438
00:16:44,399 --> 00:16:46,720
descriptor that we extracted uh add

439
00:16:46,720 --> 00:16:48,880
another support for a second camera as

440
00:16:48,880 --> 00:16:52,000
the windows hello requires every

441
00:16:52,000 --> 00:16:55,120
compatible camera to have

442
00:16:55,120 --> 00:16:56,320
to have

443
00:16:56,320 --> 00:16:59,519
regular camera and infrared camera and

444
00:16:59,519 --> 00:17:00,639
um

445
00:17:00,639 --> 00:17:03,040
we did all of this so we actually should

446
00:17:03,040 --> 00:17:05,280
have should have

447
00:17:05,280 --> 00:17:07,760
should have a working and functional

448
00:17:07,760 --> 00:17:11,039
windows hello compatible camera but once

449
00:17:11,039 --> 00:17:13,199
we connected it to the computer we got

450
00:17:13,199 --> 00:17:15,119
this

451
00:17:15,119 --> 00:17:17,359
beautiful error message that says our

452
00:17:17,359 --> 00:17:21,119
usb device could not be recognized and

453
00:17:21,119 --> 00:17:24,640
you should go and figure it figure why

454
00:17:24,640 --> 00:17:26,160
because it's not

455
00:17:26,160 --> 00:17:28,319
that easy to understand as it's kind of

456
00:17:28,319 --> 00:17:30,480
a generic error message

457
00:17:30,480 --> 00:17:32,480
um

458
00:17:32,480 --> 00:17:35,039
so we we we were clueless at this point

459
00:17:35,039 --> 00:17:37,440
we we didn't know why why it happened

460
00:17:37,440 --> 00:17:39,280
because

461
00:17:39,280 --> 00:17:41,440
during the development of the of the

462
00:17:41,440 --> 00:17:43,440
video camera the

463
00:17:43,440 --> 00:17:45,840
the evaluation board the all the changes

464
00:17:45,840 --> 00:17:48,480
we do we did on the evaluation board we

465
00:17:48,480 --> 00:17:49,440
didn't

466
00:17:49,440 --> 00:17:52,480
have any kind of these error messages

467
00:17:52,480 --> 00:17:54,160
and

468
00:17:54,160 --> 00:17:56,799
this error message only came up when uh

469
00:17:56,799 --> 00:17:57,840
when

470
00:17:57,840 --> 00:18:01,039
we changed one thing one field

471
00:18:01,039 --> 00:18:02,320
which was the

472
00:18:02,320 --> 00:18:04,720
usb version we changed it from

473
00:18:04,720 --> 00:18:09,679
2.0 to 2.1 which for matching the usb

474
00:18:09,679 --> 00:18:12,840
version that their original camera the

475
00:18:12,840 --> 00:18:16,640
compatible windows hello camera is using

476
00:18:16,640 --> 00:18:19,200
and then we we didn't know why what does

477
00:18:19,200 --> 00:18:19,919
why

478
00:18:19,919 --> 00:18:21,200
does it happen

479
00:18:21,200 --> 00:18:24,160
and we we wanted to understand so after

480
00:18:24,160 --> 00:18:25,280
a lot of

481
00:18:25,280 --> 00:18:27,360
uh trial and error we

482
00:18:27,360 --> 00:18:28,960
find out that we are missing a

483
00:18:28,960 --> 00:18:30,400
descriptor

484
00:18:30,400 --> 00:18:32,240
so which descriptor

485
00:18:32,240 --> 00:18:33,520
are we missing

486
00:18:33,520 --> 00:18:35,760
the bos descriptor of course

487
00:18:35,760 --> 00:18:36,960
apparently

488
00:18:36,960 --> 00:18:40,000
every usb device that reports a bcd usb

489
00:18:40,000 --> 00:18:42,480
which is over 2.0 or

490
00:18:42,480 --> 00:18:46,320
0x 200 and we'll be required to provide

491
00:18:46,320 --> 00:18:49,120
a bos descripto

492
00:18:49,120 --> 00:18:50,240
so

493
00:18:50,240 --> 00:18:51,919
the operation system will ask for the

494
00:18:51,919 --> 00:18:54,640
bos descripto and if the request fails

495
00:18:54,640 --> 00:18:56,559
it means that we are not sending the bos

496
00:18:56,559 --> 00:18:59,200
descriptor there a driver stack will

497
00:18:59,200 --> 00:19:02,559
fail enumeration of our device and it's

498
00:19:02,559 --> 00:19:03,679
kind of bad

499
00:19:03,679 --> 00:19:04,480
so

500
00:19:04,480 --> 00:19:07,120
we went through the um the documentation

501
00:19:07,120 --> 00:19:10,320
of um of usb and we found out uh what

502
00:19:10,320 --> 00:19:12,720
are the field that the boss descriptor

503
00:19:12,720 --> 00:19:14,799
need to be there and we extracted the

504
00:19:14,799 --> 00:19:16,320
pos descripto

505
00:19:16,320 --> 00:19:17,120
that

506
00:19:17,120 --> 00:19:20,080
the original camera using uh is using

507
00:19:20,080 --> 00:19:22,240
and

508
00:19:22,240 --> 00:19:24,880
and we we still remain

509
00:19:24,880 --> 00:19:26,720
with the same question

510
00:19:26,720 --> 00:19:27,760
why

511
00:19:27,760 --> 00:19:29,440
did we not see

512
00:19:29,440 --> 00:19:30,160
the

513
00:19:30,160 --> 00:19:33,200
vos descripto in the washock traffic

514
00:19:33,200 --> 00:19:34,320
captured

515
00:19:34,320 --> 00:19:35,280
i mean

516
00:19:35,280 --> 00:19:36,320
we we

517
00:19:36,320 --> 00:19:38,720
we capture it should show all the

518
00:19:38,720 --> 00:19:41,200
information all the all the traffic but

519
00:19:41,200 --> 00:19:43,919
it missing the voice script though so we

520
00:19:43,919 --> 00:19:46,559
we thought white white is happening so

521
00:19:46,559 --> 00:19:48,480
the main reason for this is because we

522
00:19:48,480 --> 00:19:50,080
didn't use linux

523
00:19:50,080 --> 00:19:51,440
and

524
00:19:51,440 --> 00:19:53,840
we we didn't understand why why there is

525
00:19:53,840 --> 00:19:56,000
those differences between linux and and

526
00:19:56,000 --> 00:19:58,640
windows in capturing usb devices

527
00:19:58,640 --> 00:20:02,480
uh um because we didn't uh really

528
00:20:02,480 --> 00:20:04,720
do any kind of a research or a further

529
00:20:04,720 --> 00:20:06,400
investigation on this

530
00:20:06,400 --> 00:20:07,360
but

531
00:20:07,360 --> 00:20:08,720
we we

532
00:20:08,720 --> 00:20:10,720
it was really strange to find out that

533
00:20:10,720 --> 00:20:13,600
this is the main reason anyway uh after

534
00:20:13,600 --> 00:20:17,120
this uh we we had after we added the os

535
00:20:17,120 --> 00:20:19,039
descriptor to the

536
00:20:19,039 --> 00:20:21,679
usb device and we added implementation

537
00:20:21,679 --> 00:20:24,000
for this we connected the usb device and

538
00:20:24,000 --> 00:20:26,320
then we got this

539
00:20:26,320 --> 00:20:30,000
so now we have a fully working usb video

540
00:20:30,000 --> 00:20:32,799
camera that is compatible with windows

541
00:20:32,799 --> 00:20:35,440
hello and we can control all the

542
00:20:35,440 --> 00:20:38,640
information it's sending to the computer

543
00:20:38,640 --> 00:20:40,480
so what are we missing we're missing the

544
00:20:40,480 --> 00:20:42,159
information that we need to send so

545
00:20:42,159 --> 00:20:44,000
let's capture it um

546
00:20:44,000 --> 00:20:45,280
all right so

547
00:20:45,280 --> 00:20:47,440
as i mentioned before windows low

548
00:20:47,440 --> 00:20:49,520
require you to

549
00:20:49,520 --> 00:20:50,799
have a

550
00:20:50,799 --> 00:20:53,600
ir sensor which will transmit infrared

551
00:20:53,600 --> 00:20:56,640
frames and camera sense and the color

552
00:20:56,640 --> 00:20:59,679
camera sensor that will transmit regular

553
00:20:59,679 --> 00:21:03,039
camera a irregular a color phrase

554
00:21:03,039 --> 00:21:06,400
uh so we need to capture both of those

555
00:21:06,400 --> 00:21:09,520
and a funny style note about that uh a

556
00:21:09,520 --> 00:21:12,159
side note about that doesn't really

557
00:21:12,159 --> 00:21:14,000
pay attention to anything that you are

558
00:21:14,000 --> 00:21:17,039
sending in the color frames because

559
00:21:17,039 --> 00:21:20,640
the the analysis analysis mechanism it's

560
00:21:20,640 --> 00:21:23,440
only relying on the infrared frames

561
00:21:23,440 --> 00:21:24,960
so you actually can send whatever you

562
00:21:24,960 --> 00:21:26,080
want there

563
00:21:26,080 --> 00:21:28,400
we chose by the way to send a

564
00:21:28,400 --> 00:21:30,559
frame of spongebob and

565
00:21:30,559 --> 00:21:32,720
believe it or not it worked uh

566
00:21:32,720 --> 00:21:36,799
diaphragms were um real by the way

567
00:21:36,799 --> 00:21:39,919
uh so like if we want to capture the the

568
00:21:39,919 --> 00:21:42,400
data let's talk about how the the frames

569
00:21:42,400 --> 00:21:45,120
are transferred to the computer so

570
00:21:45,120 --> 00:21:47,919
we see now we see the the

571
00:21:47,919 --> 00:21:48,799
the

572
00:21:48,799 --> 00:21:52,799
the urb packets usb ulb packets which

573
00:21:52,799 --> 00:21:55,840
kind of reminding how udp works as it's

574
00:21:55,840 --> 00:21:58,240
sending chunks of data kind of streaming

575
00:21:58,240 --> 00:21:59,679
the video

576
00:21:59,679 --> 00:22:01,600
to the computer and the computer needs

577
00:22:01,600 --> 00:22:04,960
to extract the information from this

578
00:22:04,960 --> 00:22:06,159
um

579
00:22:06,159 --> 00:22:07,440
all right

580
00:22:07,440 --> 00:22:09,840
so how does the computer know

581
00:22:09,840 --> 00:22:11,520
what is the start of the frame what is

582
00:22:11,520 --> 00:22:13,440
the end of the frame

583
00:22:13,440 --> 00:22:15,919
what you should do with the frame so

584
00:22:15,919 --> 00:22:18,400
each frame starting with an adder

585
00:22:18,400 --> 00:22:19,919
with the header so

586
00:22:19,919 --> 00:22:22,960
this header is um has a lot of fields

587
00:22:22,960 --> 00:22:25,200
and we are not really

588
00:22:25,200 --> 00:22:28,000
want to go all over them but two fields

589
00:22:28,000 --> 00:22:30,159
are really important for us the frame

590
00:22:30,159 --> 00:22:32,400
identifier and the end of frame so the

591
00:22:32,400 --> 00:22:35,200
frame identifier um

592
00:22:35,200 --> 00:22:37,440
tells us when a frame

593
00:22:37,440 --> 00:22:40,400
is started and the end of frame

594
00:22:40,400 --> 00:22:41,919
as it sounds

595
00:22:41,919 --> 00:22:44,880
indicates us when a frame is ended so

596
00:22:44,880 --> 00:22:47,679
with this information we could go over a

597
00:22:47,679 --> 00:22:50,880
use a usb traffic of the video stream

598
00:22:50,880 --> 00:22:53,840
look for the urb packets

599
00:22:53,840 --> 00:22:56,320
and extract all the frames

600
00:22:56,320 --> 00:22:57,280
um

601
00:22:57,280 --> 00:22:59,200
but because we know where the frame

602
00:22:59,200 --> 00:23:02,159
started and when where it's ended

603
00:23:02,159 --> 00:23:05,280
but to validate it our frames are valid

604
00:23:05,280 --> 00:23:06,559
at the end of the day this is what we

605
00:23:06,559 --> 00:23:07,600
want to do

606
00:23:07,600 --> 00:23:10,000
we need to we need to know in which

607
00:23:10,000 --> 00:23:12,480
format they are being sent

608
00:23:12,480 --> 00:23:13,360
so

609
00:23:13,360 --> 00:23:15,039
we looked at the configuration skip

610
00:23:15,039 --> 00:23:15,919
though

611
00:23:15,919 --> 00:23:18,799
because it's mentioned there and we look

612
00:23:18,799 --> 00:23:21,280
at the color image and we we saw that

613
00:23:21,280 --> 00:23:22,960
this is kind of um

614
00:23:22,960 --> 00:23:27,679
m jpeg frames the stream of m jpegs and

615
00:23:27,679 --> 00:23:30,799
the left one which is the ir sensor is

616
00:23:30,799 --> 00:23:33,200
the strength grid

617
00:23:33,200 --> 00:23:35,679
so we didn't know what this trend could

618
00:23:35,679 --> 00:23:38,000
mean and so after a lot a lot of

619
00:23:38,000 --> 00:23:42,320
googling we found out that this is a ks

620
00:23:42,320 --> 00:23:46,880
data format subtype l8ir which is a

621
00:23:46,880 --> 00:23:49,120
which is a format that

622
00:23:49,120 --> 00:23:50,880
microsoft uses

623
00:23:50,880 --> 00:23:54,640
which is at the end of the day it's a

624
00:23:54,640 --> 00:23:57,840
luma 8-bit plane frames

625
00:23:57,840 --> 00:23:59,600
by the way we could

626
00:23:59,600 --> 00:24:02,000
save a lot of time

627
00:24:02,000 --> 00:24:04,640
of googling if you look just straight in

628
00:24:04,640 --> 00:24:07,039
the msdn documentation documentation

629
00:24:07,039 --> 00:24:09,360
because it's written they're

630
00:24:09,360 --> 00:24:11,600
pretty much straightforward

631
00:24:11,600 --> 00:24:13,760
so

632
00:24:14,240 --> 00:24:18,559
by now we we covered usb and usb specs

633
00:24:18,559 --> 00:24:21,120
we we know how to capture usb traffic we

634
00:24:21,120 --> 00:24:23,840
managed to implement a fully working

635
00:24:23,840 --> 00:24:25,120
video

636
00:24:25,120 --> 00:24:26,640
usb device

637
00:24:26,640 --> 00:24:28,480
and also

638
00:24:28,480 --> 00:24:29,840
we know how to

639
00:24:29,840 --> 00:24:31,760
extract the

640
00:24:31,760 --> 00:24:33,840
video frames then

641
00:24:33,840 --> 00:24:34,880
so

642
00:24:34,880 --> 00:24:36,880
we have all the information that we need

643
00:24:36,880 --> 00:24:39,039
with all the tools that we need to

644
00:24:39,039 --> 00:24:41,520
bypass the authentication

645
00:24:41,520 --> 00:24:43,279
right so

646
00:24:43,279 --> 00:24:44,799
so

647
00:24:44,799 --> 00:24:46,559
what i thought that

648
00:24:46,559 --> 00:24:48,640
it would be really great to go with pie

649
00:24:48,640 --> 00:24:49,600
shark

650
00:24:49,600 --> 00:24:53,360
uh which is a library in python for um

651
00:24:53,360 --> 00:24:55,039
manipulating and

652
00:24:55,039 --> 00:24:58,880
loading a washout traffic

653
00:24:58,880 --> 00:25:01,360
capture so

654
00:25:01,360 --> 00:25:03,760
go with bioshock on the capture

655
00:25:03,760 --> 00:25:05,760
save the relevant frames with the

656
00:25:05,760 --> 00:25:08,240
previous knowledge that we have and save

657
00:25:08,240 --> 00:25:10,640
it into the evaluation board send it to

658
00:25:10,640 --> 00:25:13,440
the computer pretending to be a real

659
00:25:13,440 --> 00:25:14,640
usb

660
00:25:14,640 --> 00:25:18,240
windows hello camera and bypass the

661
00:25:18,240 --> 00:25:19,520
login

662
00:25:19,520 --> 00:25:21,600
the facial recognition

663
00:25:21,600 --> 00:25:25,200
but it didn't work and we

664
00:25:25,200 --> 00:25:27,760
so the reason it didn't work it's quite

665
00:25:27,760 --> 00:25:30,000
interesting apparently

666
00:25:30,000 --> 00:25:30,880
the

667
00:25:30,880 --> 00:25:32,799
regular camera sending a lot of

668
00:25:32,799 --> 00:25:35,600
information and a lot of frames that are

669
00:25:35,600 --> 00:25:39,279
um not valid which was very strange but

670
00:25:39,279 --> 00:25:42,480
apparently microsoft knows how to uh to

671
00:25:42,480 --> 00:25:45,600
get rid of those frames and uh

672
00:25:45,600 --> 00:25:47,279
we didn't want to understand how to do

673
00:25:47,279 --> 00:25:49,440
this to do this as microsoft did it

674
00:25:49,440 --> 00:25:52,320
already so we used a microsoft media

675
00:25:52,320 --> 00:25:54,799
framework to capture the relevant

676
00:25:54,799 --> 00:25:58,159
infrared image frames of the uh our

677
00:25:58,159 --> 00:26:01,279
target person saved it into the um

678
00:26:01,279 --> 00:26:04,640
to the evaluation board and it worked

679
00:26:04,640 --> 00:26:07,120
this time there was a lot of yay in the

680
00:26:07,120 --> 00:26:09,279
in the crowd and it was really really

681
00:26:09,279 --> 00:26:12,640
fun right so we talked a lot let's see

682
00:26:12,640 --> 00:26:13,760
the demo

683
00:26:13,760 --> 00:26:14,720
um

684
00:26:14,720 --> 00:26:17,840
so it's demo time

685
00:26:23,120 --> 00:26:25,520
right so here we we see windows hello

686
00:26:25,520 --> 00:26:26,960
user

687
00:26:26,960 --> 00:26:28,240
this is the evaluation board that we

688
00:26:28,240 --> 00:26:30,240
used it's a custom usb camera that

689
00:26:30,240 --> 00:26:32,480
stores the recorded iframes of me of

690
00:26:32,480 --> 00:26:33,520
course

691
00:26:33,520 --> 00:26:35,360
we connected it to the

692
00:26:35,360 --> 00:26:38,400
to the computer

693
00:26:38,400 --> 00:26:40,799
of course

694
00:26:42,640 --> 00:26:44,559
and shortly windows will recognize the

695
00:26:44,559 --> 00:26:47,600
usb device and we'll use it as it was a

696
00:26:47,600 --> 00:26:49,279
regular video camera

697
00:26:49,279 --> 00:26:51,440
windows log compatible by the way

698
00:26:51,440 --> 00:26:53,200
so the custom usb camera sends the

699
00:26:53,200 --> 00:26:55,520
recorded frame to the target

700
00:26:55,520 --> 00:26:58,320
of the target to the computer

701
00:26:58,320 --> 00:27:00,000
so this actually tricks windows a lot to

702
00:27:00,000 --> 00:27:02,720
think the target person is in front of

703
00:27:02,720 --> 00:27:04,840
it of the computer

704
00:27:04,840 --> 00:27:07,520
and proof

705
00:27:07,520 --> 00:27:09,120
um

706
00:27:09,120 --> 00:27:10,159
all right

707
00:27:10,159 --> 00:27:13,200
so let's discuss what we just saw

708
00:27:13,200 --> 00:27:15,360
right so at first the attacker captures

709
00:27:15,360 --> 00:27:17,919
or create and infrared

710
00:27:17,919 --> 00:27:20,559
frames of the victim

711
00:27:20,559 --> 00:27:24,559
then it stores the they infrared then

712
00:27:24,559 --> 00:27:26,559
he needs to create a custom usb device

713
00:27:26,559 --> 00:27:29,200
that in person at a usb a video camera

714
00:27:29,200 --> 00:27:30,559
that is compatible of course with

715
00:27:30,559 --> 00:27:31,840
windows alert

716
00:27:31,840 --> 00:27:33,520
the attacker saves the relevant

717
00:27:33,520 --> 00:27:36,159
information it captured the first step

718
00:27:36,159 --> 00:27:38,159
to the

719
00:27:38,159 --> 00:27:41,039
to the usb device then connect the usb

720
00:27:41,039 --> 00:27:43,279
device to john's computer

721
00:27:43,279 --> 00:27:45,120
the usb device transmitted the capture

722
00:27:45,120 --> 00:27:46,880
infrared

723
00:27:46,880 --> 00:27:48,399
the paramedical system accept the

724
00:27:48,399 --> 00:27:50,799
environment the biomedical cardentile

725
00:27:50,799 --> 00:27:53,200
and logs the user in and attacker gets a

726
00:27:53,200 --> 00:27:55,840
lot of information and sensitive data

727
00:27:55,840 --> 00:27:58,399
that he shouldn't have access to

728
00:27:58,399 --> 00:27:59,440
right

729
00:27:59,440 --> 00:28:01,600
so

730
00:28:02,159 --> 00:28:04,000
all right here we come to the final part

731
00:28:04,000 --> 00:28:06,080
this is the four fourth part

732
00:28:06,080 --> 00:28:08,559
what's what we should uh

733
00:28:08,559 --> 00:28:09,520
what

734
00:28:09,520 --> 00:28:12,240
we should do in um richard in research

735
00:28:12,240 --> 00:28:13,679
even more

736
00:28:13,679 --> 00:28:15,279
um

737
00:28:15,279 --> 00:28:17,039
right

738
00:28:17,039 --> 00:28:19,760
so um

739
00:28:19,760 --> 00:28:21,919
we so what i recommend you to do if you

740
00:28:21,919 --> 00:28:23,919
want to continue this research is to

741
00:28:23,919 --> 00:28:26,720
find a way to convert color in for an

742
00:28:26,720 --> 00:28:28,399
image to infrared

743
00:28:28,399 --> 00:28:29,600
um

744
00:28:29,600 --> 00:28:31,840
so if you will do a google on this you

745
00:28:31,840 --> 00:28:34,399
you if you will find out a couple

746
00:28:34,399 --> 00:28:37,120
threads in some forms that will say it's

747
00:28:37,120 --> 00:28:38,480
impossible

748
00:28:38,480 --> 00:28:41,200
um but we actually did the sim

749
00:28:41,200 --> 00:28:44,399
uh quite briefly research on this and we

750
00:28:44,399 --> 00:28:45,520
found out

751
00:28:45,520 --> 00:28:48,320
that from our research it might be

752
00:28:48,320 --> 00:28:50,559
possible because we managed to

753
00:28:50,559 --> 00:28:53,760
convert one color image of

754
00:28:53,760 --> 00:28:57,279
of me to infrared one but it wasn't that

755
00:28:57,279 --> 00:28:59,279
extensive research and we we do

756
00:28:59,279 --> 00:29:01,760
recommend you to to do a better research

757
00:29:01,760 --> 00:29:03,840
on this another really interesting thing

758
00:29:03,840 --> 00:29:05,679
is to manipulate the biometric uh

759
00:29:05,679 --> 00:29:07,760
database in windows

760
00:29:07,760 --> 00:29:09,679
at the end of the day if an attack you

761
00:29:09,679 --> 00:29:12,640
want to create um

762
00:29:12,640 --> 00:29:15,520
really really smart backdoor that nobody

763
00:29:15,520 --> 00:29:17,760
will look after

764
00:29:17,760 --> 00:29:20,080
he should look at this i mean

765
00:29:20,080 --> 00:29:22,240
it is considered to be a place that you

766
00:29:22,240 --> 00:29:25,679
save a credential in and if somebody is

767
00:29:25,679 --> 00:29:27,919
able to manipulate this it will be great

768
00:29:27,919 --> 00:29:30,880
and it will kind of can create uh

769
00:29:30,880 --> 00:29:33,520
it can create a passwordless i mean a

770
00:29:33,520 --> 00:29:36,000
backdoor to the user account

771
00:29:36,000 --> 00:29:39,440
um the the database at least the one

772
00:29:39,440 --> 00:29:42,240
that windows law uses is

773
00:29:42,240 --> 00:29:44,480
it's protected by uh

774
00:29:44,480 --> 00:29:47,360
by the system passwords but it i think

775
00:29:47,360 --> 00:29:50,000
that if the user if the attacker has

776
00:29:50,000 --> 00:29:53,600
already um high privileges in the

777
00:29:53,600 --> 00:29:57,279
victim computer you can manipulate this

778
00:29:57,279 --> 00:30:00,000
another cool thing will be fuzzing so if

779
00:30:00,000 --> 00:30:02,880
an attacker could extract this database

780
00:30:02,880 --> 00:30:05,360
and decrypt this with a system password

781
00:30:05,360 --> 00:30:07,840
and take all the information there to a

782
00:30:07,840 --> 00:30:09,600
local machine

783
00:30:09,600 --> 00:30:13,440
and start to use the windows hello

784
00:30:13,440 --> 00:30:14,480
framework

785
00:30:14,480 --> 00:30:16,240
in order to

786
00:30:16,240 --> 00:30:17,600
kind of

787
00:30:17,600 --> 00:30:20,399
fuzz in the database to find out what

788
00:30:20,399 --> 00:30:22,799
will be the relevant information you

789
00:30:22,799 --> 00:30:25,279
will be able to send to

790
00:30:25,279 --> 00:30:28,480
to a real device to unlock

791
00:30:28,480 --> 00:30:30,399
the device target it will be really

792
00:30:30,399 --> 00:30:32,000
interesting

793
00:30:32,000 --> 00:30:35,039
we started also to do a small project on

794
00:30:35,039 --> 00:30:37,919
this and it's a walk-in progress so if

795
00:30:37,919 --> 00:30:39,360
anything will

796
00:30:39,360 --> 00:30:41,360
come out from this we'll let you know

797
00:30:41,360 --> 00:30:43,678
guys

798
00:30:43,760 --> 00:30:47,360
and that's for what is next um

799
00:30:47,360 --> 00:30:50,720
so let's cover what we saw today so at

800
00:30:50,720 --> 00:30:52,880
the first section we talked about

801
00:30:52,880 --> 00:30:53,919
usb

802
00:30:53,919 --> 00:30:56,000
then we went about password less and

803
00:30:56,000 --> 00:30:57,120
then

804
00:30:57,120 --> 00:30:58,640
what is password less why it's

805
00:30:58,640 --> 00:31:00,320
considered to be more secure than a

806
00:31:00,320 --> 00:31:02,240
password regular traditional

807
00:31:02,240 --> 00:31:03,440
authentication

808
00:31:03,440 --> 00:31:06,320
mechanism methods or in the other way

809
00:31:06,320 --> 00:31:08,559
other way to say passwords

810
00:31:08,559 --> 00:31:09,840
and

811
00:31:09,840 --> 00:31:11,600
so

812
00:31:11,600 --> 00:31:13,679
we talked about windows low

813
00:31:13,679 --> 00:31:15,519
and how we managed to bypass windows

814
00:31:15,519 --> 00:31:16,399
hello

815
00:31:16,399 --> 00:31:18,720
what considered to be the weak point the

816
00:31:18,720 --> 00:31:21,279
the weakest point in the windows law and

817
00:31:21,279 --> 00:31:25,039
mechanism um and the fourth thing that i

818
00:31:25,039 --> 00:31:28,799
hoped you had it's a lot a lot of fun

819
00:31:28,799 --> 00:31:32,799
so regarding recommendations um so this

820
00:31:32,799 --> 00:31:34,960
is that verto is not

821
00:31:34,960 --> 00:31:36,640
it's not even about windows or law

822
00:31:36,640 --> 00:31:39,039
specific it's about authentication

823
00:31:39,039 --> 00:31:42,240
mechanism that rely on public data

824
00:31:42,240 --> 00:31:44,720
public factor for authentication

825
00:31:44,720 --> 00:31:47,519
so please don't base your authentication

826
00:31:47,519 --> 00:31:49,519
on public factors

827
00:31:49,519 --> 00:31:50,960
um

828
00:31:50,960 --> 00:31:53,120
about mitigations um

829
00:31:53,120 --> 00:31:55,519
so we walked alongside microsoft to

830
00:31:55,519 --> 00:31:57,600
mitigate this attacking vector and we're

831
00:31:57,600 --> 00:32:00,000
still working with them on this and

832
00:32:00,000 --> 00:32:02,799
microsoft told us that they should uh

833
00:32:02,799 --> 00:32:03,919
publish

834
00:32:03,919 --> 00:32:07,279
uh publish um advisory to mitigate this

835
00:32:07,279 --> 00:32:09,919
attack vector so by the time you should

836
00:32:09,919 --> 00:32:11,440
you will see the by the time you're

837
00:32:11,440 --> 00:32:13,360
seeing this video

838
00:32:13,360 --> 00:32:14,640
this talk

839
00:32:14,640 --> 00:32:17,039
there should be advisory in the in the

840
00:32:17,039 --> 00:32:19,279
micros in the mslc website so go and

841
00:32:19,279 --> 00:32:20,399
check this

842
00:32:20,399 --> 00:32:21,760
and

843
00:32:21,760 --> 00:32:24,320
besides that we also by the time you're

844
00:32:24,320 --> 00:32:26,320
seeing this um this video we also

845
00:32:26,320 --> 00:32:30,399
published um two blog posts about this

846
00:32:30,399 --> 00:32:32,559
research and what we did in the research

847
00:32:32,559 --> 00:32:34,960
even more extensive than this talk so

848
00:32:34,960 --> 00:32:37,120
feel free to

849
00:32:37,120 --> 00:32:39,200
visit our website or threat research

850
00:32:39,200 --> 00:32:40,640
blog

851
00:32:40,640 --> 00:32:42,640
so thank you very much guys uh i'm

852
00:32:42,640 --> 00:32:45,039
mohamed sawfati i had a great time being

853
00:32:45,039 --> 00:32:47,120
here today uh and feel free to contact

854
00:32:47,120 --> 00:32:49,519
me via twitter if you have any questions

855
00:32:49,519 --> 00:32:51,519
uh besides i'm waiting for your question

856
00:32:51,519 --> 00:32:52,880
in the live q a

857
00:32:52,880 --> 00:32:56,600
thank you very much guys

