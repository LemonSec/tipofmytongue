1
00:00:01,130 --> 00:00:14,480
[Music]

2
00:00:14,480 --> 00:00:16,400
hello my name is richard emerson and

3
00:00:16,400 --> 00:00:17,840
today i'll be co-presenting with my

4
00:00:17,840 --> 00:00:20,320
colleague allison wyckoff our black cat

5
00:00:20,320 --> 00:00:22,640
2021 presentation the kitten that

6
00:00:22,640 --> 00:00:24,160
charmed me the nine lives of a

7
00:00:24,160 --> 00:00:26,080
nation-state attacker we are both

8
00:00:26,080 --> 00:00:28,080
researchers with ibm security x-force

9
00:00:28,080 --> 00:00:29,599
threat intelligence and we appreciate

10
00:00:29,599 --> 00:00:31,199
your time today as we talk about an

11
00:00:31,199 --> 00:00:33,200
iranian nation state threat actor we

12
00:00:33,200 --> 00:00:36,079
track as itg 18.

13
00:00:36,079 --> 00:00:37,840
before we get into the presentation just

14
00:00:37,840 --> 00:00:39,760
a little bit about our backgrounds i

15
00:00:39,760 --> 00:00:40,960
have a little over a decade of

16
00:00:40,960 --> 00:00:42,800
experience working in cyber security and

17
00:00:42,800 --> 00:00:44,800
intelligence analysis with the past

18
00:00:44,800 --> 00:00:46,480
three years spent with ibm security

19
00:00:46,480 --> 00:00:48,320
x-force largely tracking iranian

20
00:00:48,320 --> 00:00:50,640
nation-state threat actors before that i

21
00:00:50,640 --> 00:00:52,559
was working at mit lincoln laboratory

22
00:00:52,559 --> 00:00:54,079
helping protect their network on the

23
00:00:54,079 --> 00:00:56,079
threat assessment team and i also spent

24
00:00:56,079 --> 00:00:57,440
a few years working at the department of

25
00:00:57,440 --> 00:00:59,920
defense focused on cyber security issues

26
00:00:59,920 --> 00:01:03,280
and i'll let allison introduce herself

27
00:01:03,280 --> 00:01:05,438
hi i'm alison wyckoff i've been with

28
00:01:05,438 --> 00:01:07,360
x-force for about a year and a half but

29
00:01:07,360 --> 00:01:08,799
i've been in the field for 20 years

30
00:01:08,799 --> 00:01:11,360
working in research intelligence network

31
00:01:11,360 --> 00:01:13,520
defense and incident response i spent

32
00:01:13,520 --> 00:01:15,280
the latter half of my career researching

33
00:01:15,280 --> 00:01:17,040
nation state cyber threats with an

34
00:01:17,040 --> 00:01:19,520
emphasis on threats stemming from iran

35
00:01:19,520 --> 00:01:22,080
i've also been an incident responder

36
00:01:22,080 --> 00:01:23,439
and threat intelligence analyst for the

37
00:01:23,439 --> 00:01:25,439
federal reserve system and held various

38
00:01:25,439 --> 00:01:28,000
network defense positions at citigroup

39
00:01:28,000 --> 00:01:29,680
as well as mayo clinic

40
00:01:29,680 --> 00:01:31,840
and finally in my copious amounts of

41
00:01:31,840 --> 00:01:34,159
spare time i guess lecture at columbia

42
00:01:34,159 --> 00:01:35,600
university

43
00:01:35,600 --> 00:01:37,520
for our presentation today we'll be

44
00:01:37,520 --> 00:01:38,960
talking about the iranian threat actor

45
00:01:38,960 --> 00:01:42,159
we track as ibm threat group 18 aka

46
00:01:42,159 --> 00:01:44,799
itg-18 which overlaps heavily with the

47
00:01:44,799 --> 00:01:46,880
threat actor reported in open source as

48
00:01:46,880 --> 00:01:49,040
charming kitten and phosphorus

49
00:01:49,040 --> 00:01:50,640
we plan to discuss how this threat actor

50
00:01:50,640 --> 00:01:52,720
typically operates what tools we've

51
00:01:52,720 --> 00:01:54,640
observed including the android remote

52
00:01:54,640 --> 00:01:57,600
access tool that we dub little looter

53
00:01:57,600 --> 00:01:59,040
we will touch on some insights we've

54
00:01:59,040 --> 00:02:00,479
gleaned from the mistakes this group has

55
00:02:00,479 --> 00:02:02,719
made and then show two training videos

56
00:02:02,719 --> 00:02:05,439
one itg 18 operator produced like

57
00:02:05,439 --> 00:02:07,439
anybody else the operators that comprise

58
00:02:07,439 --> 00:02:10,160
itg-18 are not perfect and we can learn

59
00:02:10,160 --> 00:02:11,760
aspects of their operations from their

60
00:02:11,760 --> 00:02:13,920
mistakes that hint at their size as well

61
00:02:13,920 --> 00:02:15,520
as how they may be raising the next

62
00:02:15,520 --> 00:02:18,000
litter of operators you can find links

63
00:02:18,000 --> 00:02:19,599
to this research that provide additional

64
00:02:19,599 --> 00:02:22,640
detail at the bottom of the slide

65
00:02:22,640 --> 00:02:24,160
i want to state up front that this is

66
00:02:24,160 --> 00:02:26,480
not a talk focused on attribution we

67
00:02:26,480 --> 00:02:28,959
will define what we consider itg 18 with

68
00:02:28,959 --> 00:02:30,080
the understanding that other

69
00:02:30,080 --> 00:02:31,599
organizations with different vantage

70
00:02:31,599 --> 00:02:34,000
points and data may track the operators

71
00:02:34,000 --> 00:02:35,840
behind this activity differently and

72
00:02:35,840 --> 00:02:37,519
that's okay

73
00:02:37,519 --> 00:02:39,360
i also want to note that for victims

74
00:02:39,360 --> 00:02:41,519
that we were able to identify we did

75
00:02:41,519 --> 00:02:43,200
attempt responsible disclosure by

76
00:02:43,200 --> 00:02:45,040
contacting and sharing that information

77
00:02:45,040 --> 00:02:46,480
with the appropriate law enforcement

78
00:02:46,480 --> 00:02:47,680
agencies

79
00:02:47,680 --> 00:02:49,280
as well as masking identifying

80
00:02:49,280 --> 00:02:51,280
information within the presentation

81
00:02:51,280 --> 00:02:54,400
so with that let's get started

82
00:02:54,400 --> 00:02:56,800
so our story begins like those of many

83
00:02:56,800 --> 00:02:58,560
others in the cyber security industry

84
00:02:58,560 --> 00:03:00,480
with some routine pivoting to identify

85
00:03:00,480 --> 00:03:02,239
adversary infrastructure

86
00:03:02,239 --> 00:03:04,640
so for us it was may 2020

87
00:03:04,640 --> 00:03:06,239
and we were following news reports of

88
00:03:06,239 --> 00:03:08,879
our threat actor itg-18 targeting the

89
00:03:08,879 --> 00:03:10,959
u.s biopharmaceutical company gilead

90
00:03:10,959 --> 00:03:13,519
sciences at this time which seems like

91
00:03:13,519 --> 00:03:15,840
ages ago iran was in the throes of the

92
00:03:15,840 --> 00:03:17,760
copet-19 pandemic and so they were

93
00:03:17,760 --> 00:03:19,599
likely interested in gaining access to

94
00:03:19,599 --> 00:03:21,680
any information they could on potential

95
00:03:21,680 --> 00:03:24,640
covet 19 vaccines or treatments we also

96
00:03:24,640 --> 00:03:26,720
knew that for itg 18

97
00:03:26,720 --> 00:03:28,080
while this targeting may have seemed

98
00:03:28,080 --> 00:03:30,080
atypical that it was not uncommon for

99
00:03:30,080 --> 00:03:31,760
the threat actor to pivot to focus on

100
00:03:31,760 --> 00:03:34,640
short term higher priority objectives

101
00:03:34,640 --> 00:03:36,480
in anticipation of publishing in this

102
00:03:36,480 --> 00:03:38,560
activity we started to double check the

103
00:03:38,560 --> 00:03:40,319
infrastructure we had already associated

104
00:03:40,319 --> 00:03:41,599
with this group

105
00:03:41,599 --> 00:03:44,560
when we came across an open directory

106
00:03:44,560 --> 00:03:46,239
over the course of one week we saw

107
00:03:46,239 --> 00:03:48,000
several files uploaded to the server

108
00:03:48,000 --> 00:03:49,680
including exfiltrated information

109
00:03:49,680 --> 00:03:52,000
related to a greek navy member and a u.s

110
00:03:52,000 --> 00:03:54,000
navy member

111
00:03:54,000 --> 00:03:55,599
with that exfiltrated information were

112
00:03:55,599 --> 00:03:57,920
four plus hours of desktop recordings of

113
00:03:57,920 --> 00:04:00,879
an itg-18 operator manually validating

114
00:04:00,879 --> 00:04:02,959
victim credentials as well as several

115
00:04:02,959 --> 00:04:04,400
short of video files which we later

116
00:04:04,400 --> 00:04:07,439
determined were training videos

117
00:04:07,439 --> 00:04:09,040
now as we will see through our

118
00:04:09,040 --> 00:04:11,280
presentation it was not uncommon for

119
00:04:11,280 --> 00:04:12,720
this group to leave open directories on

120
00:04:12,720 --> 00:04:14,720
their servers particularly when it came

121
00:04:14,720 --> 00:04:16,639
to information exfiltrated from their

122
00:04:16,639 --> 00:04:17,680
victims

123
00:04:17,680 --> 00:04:20,000
but what we hadn't seen were recordings

124
00:04:20,000 --> 00:04:22,240
made by the threat actors themselves

125
00:04:22,240 --> 00:04:23,440
sifting through actual traded

126
00:04:23,440 --> 00:04:25,680
credentials and creating training videos

127
00:04:25,680 --> 00:04:27,600
ostensibly for others to follow to do

128
00:04:27,600 --> 00:04:29,840
similar work in the future so to say

129
00:04:29,840 --> 00:04:31,520
that allison and i were excited would be

130
00:04:31,520 --> 00:04:33,680
an understatement

131
00:04:33,680 --> 00:04:35,600
the video has certainly added details to

132
00:04:35,600 --> 00:04:37,120
our understanding

133
00:04:37,120 --> 00:04:38,240
of this group that we didn't have

134
00:04:38,240 --> 00:04:39,440
previously

135
00:04:39,440 --> 00:04:40,960
but we've been tracking their operations

136
00:04:40,960 --> 00:04:42,960
for some time and we already had a good

137
00:04:42,960 --> 00:04:45,120
sense of how we defined this group so

138
00:04:45,120 --> 00:04:47,199
for us a hallmark of their operations

139
00:04:47,199 --> 00:04:48,880
was fishing against personal social

140
00:04:48,880 --> 00:04:50,960
media and webmail accounts to support

141
00:04:50,960 --> 00:04:52,639
their espionage and surveillance

142
00:04:52,639 --> 00:04:55,040
objectives they likely target a user's

143
00:04:55,040 --> 00:04:56,639
professional accounts as well at times

144
00:04:56,639 --> 00:04:58,240
but between the subdomains we've

145
00:04:58,240 --> 00:05:00,240
observed on their phishing domains as

146
00:05:00,240 --> 00:05:01,840
well as the phishing landing pages there

147
00:05:01,840 --> 00:05:03,840
is a consistent focus on collecting

148
00:05:03,840 --> 00:05:06,320
credentials from services like gmail

149
00:05:06,320 --> 00:05:09,039
yahoo microsoft etc

150
00:05:09,039 --> 00:05:10,560
and while that is not completely out of

151
00:05:10,560 --> 00:05:12,479
the norm for a nation-state threat actor

152
00:05:12,479 --> 00:05:14,320
it is a more defining characteristic for

153
00:05:14,320 --> 00:05:15,840
this group than others that we are

154
00:05:15,840 --> 00:05:17,440
tracking

155
00:05:17,440 --> 00:05:19,039
something else that we took note of for

156
00:05:19,039 --> 00:05:20,720
this group even before the discovery of

157
00:05:20,720 --> 00:05:22,639
these videos were how far they would go

158
00:05:22,639 --> 00:05:24,080
to add a personal touch to their

159
00:05:24,080 --> 00:05:26,160
operations so reportedly they have

160
00:05:26,160 --> 00:05:28,000
texted and emailed with victims to build

161
00:05:28,000 --> 00:05:30,080
a rapport before attempting to get the

162
00:05:30,080 --> 00:05:31,919
victim to download malware or visit a

163
00:05:31,919 --> 00:05:34,080
phishing page and have even gone so far

164
00:05:34,080 --> 00:05:35,840
as to offer to call their victims as

165
00:05:35,840 --> 00:05:38,240
reported in open source

166
00:05:38,240 --> 00:05:39,919
what this hinted at was how much of a

167
00:05:39,919 --> 00:05:42,320
manual process some of these operations

168
00:05:42,320 --> 00:05:44,160
were which is something we will touch on

169
00:05:44,160 --> 00:05:46,240
later in the presentation

170
00:05:46,240 --> 00:05:48,000
finally this is a group that frequently

171
00:05:48,000 --> 00:05:50,000
leases their own servers registers their

172
00:05:50,000 --> 00:05:51,759
own domains and they've used pretty

173
00:05:51,759 --> 00:05:53,919
consistent patterns in doing so they've

174
00:05:53,919 --> 00:05:55,600
also continued to use some of the same

175
00:05:55,600 --> 00:05:57,199
providers for years

176
00:05:57,199 --> 00:05:59,840
like ovh and hetzner for hosting

177
00:05:59,840 --> 00:06:01,680
this isn't a group that is constantly

178
00:06:01,680 --> 00:06:03,039
innovating and trying to hide its

179
00:06:03,039 --> 00:06:05,120
activity from the security community

180
00:06:05,120 --> 00:06:06,720
they have some tried and true methods of

181
00:06:06,720 --> 00:06:08,400
doing things and regardless of public

182
00:06:08,400 --> 00:06:10,240
disclosure it's continued to work for

183
00:06:10,240 --> 00:06:11,759
them in terms of compromising and

184
00:06:11,759 --> 00:06:15,360
exfiltrating data from their targets

185
00:06:15,360 --> 00:06:17,039
and you can see this a lot in their

186
00:06:17,039 --> 00:06:18,880
phishing pages over the years where they

187
00:06:18,880 --> 00:06:21,120
may host some first stage content on a

188
00:06:21,120 --> 00:06:22,319
legitimate platform like

189
00:06:22,319 --> 00:06:24,080
sites.google.com

190
00:06:24,080 --> 00:06:25,840
leverage a url shortening link on that

191
00:06:25,840 --> 00:06:27,840
page to redirect the victim to the final

192
00:06:27,840 --> 00:06:29,680
credential harvesting link that will

193
00:06:29,680 --> 00:06:31,280
mirror what the legitimate provider is

194
00:06:31,280 --> 00:06:33,120
using and that's one of their standard

195
00:06:33,120 --> 00:06:35,360
playbooks not a lot of significant

196
00:06:35,360 --> 00:06:37,600
updates not a lot of changes

197
00:06:37,600 --> 00:06:39,520
and so you see very consistent phishing

198
00:06:39,520 --> 00:06:41,520
landing pages over the years as the

199
00:06:41,520 --> 00:06:43,280
operators continue to target the same

200
00:06:43,280 --> 00:06:47,199
kinds of accounts over and over again

201
00:06:47,199 --> 00:06:48,960
as i mentioned this group doesn't appear

202
00:06:48,960 --> 00:06:50,639
to change much even after public

203
00:06:50,639 --> 00:06:52,960
disclosure one of the best examples of

204
00:06:52,960 --> 00:06:54,960
this was the court case microsoft won in

205
00:06:54,960 --> 00:06:57,599
march 2019 where microsoft was able to

206
00:06:57,599 --> 00:07:00,000
take over 99 domains associated with the

207
00:07:00,000 --> 00:07:02,080
group they track as phosphorus aka

208
00:07:02,080 --> 00:07:04,160
itg-18

209
00:07:04,160 --> 00:07:05,599
one of the domains that microsoft

210
00:07:05,599 --> 00:07:07,440
sinkholed was identifier services

211
00:07:07,440 --> 00:07:08,960
sessions.info

212
00:07:08,960 --> 00:07:11,440
and what was it g18's response to this

213
00:07:11,440 --> 00:07:13,039
activity

214
00:07:13,039 --> 00:07:16,000
to register an almost identical domain

215
00:07:16,000 --> 00:07:18,240
three weeks later to continue the same

216
00:07:18,240 --> 00:07:19,759
phishing activity

217
00:07:19,759 --> 00:07:21,520
microsoft has continued to sinkhole

218
00:07:21,520 --> 00:07:24,639
itg-18 domains and itg-18 has continued

219
00:07:24,639 --> 00:07:26,400
to register new ones leveraging some of

220
00:07:26,400 --> 00:07:28,479
the same providers in an ongoing cat and

221
00:07:28,479 --> 00:07:31,360
mouse game this group does not seem to

222
00:07:31,360 --> 00:07:32,639
particularly care about public

223
00:07:32,639 --> 00:07:34,000
disclosure of their activities like

224
00:07:34,000 --> 00:07:36,560
other groups do and possibly be possibly

225
00:07:36,560 --> 00:07:38,560
because they continue to enjoy success

226
00:07:38,560 --> 00:07:40,720
with their tactics

227
00:07:40,720 --> 00:07:42,639
in terms of how this group is successful

228
00:07:42,639 --> 00:07:44,160
aside from stealing credentials there

229
00:07:44,160 --> 00:07:45,759
have also been a limited number of tools

230
00:07:45,759 --> 00:07:47,360
we've identified this group potentially

231
00:07:47,360 --> 00:07:48,479
using

232
00:07:48,479 --> 00:07:50,240
the first is a legitimate pen testing

233
00:07:50,240 --> 00:07:52,080
tool abused by a lot of thread actors

234
00:07:52,080 --> 00:07:53,280
medisploy

235
00:07:53,280 --> 00:07:54,800
which we've seen hosted on several of

236
00:07:54,800 --> 00:07:57,360
their servers since at least 2017.

237
00:07:57,360 --> 00:07:59,280
the second is a commercially available

238
00:07:59,280 --> 00:08:01,360
android remote access tool called spy

239
00:08:01,360 --> 00:08:03,199
note hosted on one of their servers in

240
00:08:03,199 --> 00:08:05,759
2020 a spy note builder was leaked

241
00:08:05,759 --> 00:08:07,280
previously and the version observed

242
00:08:07,280 --> 00:08:10,479
hosted on the itg-18 server version 7

243
00:08:10,479 --> 00:08:12,240
was allegedly available for download on

244
00:08:12,240 --> 00:08:14,160
several iranian sites potentially

245
00:08:14,160 --> 00:08:15,680
indicating where they may have gotten it

246
00:08:15,680 --> 00:08:16,720
from

247
00:08:16,720 --> 00:08:19,440
another android observed on the same i2g

248
00:08:19,440 --> 00:08:22,639
18 server was a version of android based

249
00:08:22,639 --> 00:08:25,680
on the github project noted in the slide

250
00:08:25,680 --> 00:08:27,840
and a custom windows executable back

251
00:08:27,840 --> 00:08:30,319
door named pdf reader which was the name

252
00:08:30,319 --> 00:08:32,159
of the file this is a tool that's

253
00:08:32,159 --> 00:08:33,919
believed to be only used by this thread

254
00:08:33,919 --> 00:08:36,080
actor you can see to the right several

255
00:08:36,080 --> 00:08:38,080
aptly named modules that the backdoor

256
00:08:38,080 --> 00:08:40,399
can download to extend its functionality

257
00:08:40,399 --> 00:08:42,000
the code for most of these modules are

258
00:08:42,000 --> 00:08:44,080
copied from open source projects and

259
00:08:44,080 --> 00:08:45,519
very little is done to obfuscate

260
00:08:45,519 --> 00:08:47,680
anything in the code the bacter also

261
00:08:47,680 --> 00:08:49,440
generates a lot of noise in terms of

262
00:08:49,440 --> 00:08:51,600
writing files to disk so this is not the

263
00:08:51,600 --> 00:08:54,560
most sophisticated tool

264
00:08:54,560 --> 00:08:56,399
and finally this brings us to another

265
00:08:56,399 --> 00:08:57,920
tool we discovered on one of their

266
00:08:57,920 --> 00:08:59,360
misconfigured servers which we're

267
00:08:59,360 --> 00:09:01,920
calling little looter this is a

268
00:09:01,920 --> 00:09:03,519
functionally rich backdoor that is

269
00:09:03,519 --> 00:09:05,680
capable of recording video sound phone

270
00:09:05,680 --> 00:09:07,839
calls enumerating and configuring

271
00:09:07,839 --> 00:09:09,920
network information for the device

272
00:09:09,920 --> 00:09:11,600
gathering information on call history

273
00:09:11,600 --> 00:09:14,080
and sms messages making phone calls or

274
00:09:14,080 --> 00:09:16,640
sending sms messages gathering location

275
00:09:16,640 --> 00:09:18,560
data and browser history as well as

276
00:09:18,560 --> 00:09:20,320
sending error information to the c2

277
00:09:20,320 --> 00:09:22,160
server

278
00:09:22,160 --> 00:09:23,600
the malware is also capable of

279
00:09:23,600 --> 00:09:25,440
downloading installing updates and the

280
00:09:25,440 --> 00:09:28,399
version we saw was version 5 as noted in

281
00:09:28,399 --> 00:09:29,519
the code

282
00:09:29,519 --> 00:09:31,360
since the c2 domain was registered in

283
00:09:31,360 --> 00:09:33,600
the summer of 2020 we've seen multiple

284
00:09:33,600 --> 00:09:35,279
uploads of victim information to the

285
00:09:35,279 --> 00:09:37,839
x-fil folder on the c2 domain and as of

286
00:09:37,839 --> 00:09:39,839
the recording of this presentation this

287
00:09:39,839 --> 00:09:41,839
c2 domain is still live

288
00:09:41,839 --> 00:09:43,519
this sample has since been uploaded to

289
00:09:43,519 --> 00:09:45,200
virustotal and is available for anyone

290
00:09:45,200 --> 00:09:47,279
to look at and additional details about

291
00:09:47,279 --> 00:09:48,959
the tool can be found in the blog post

292
00:09:48,959 --> 00:09:50,800
noted at the bottom of the slide

293
00:09:50,800 --> 00:09:52,480
but you can see how a back door with

294
00:09:52,480 --> 00:09:54,240
these capabilities would certainly aid

295
00:09:54,240 --> 00:09:57,760
itg-18's surveillance mission

296
00:09:57,760 --> 00:09:59,440
with these phishing pages and with these

297
00:09:59,440 --> 00:10:01,120
tools what we've come to know about this

298
00:10:01,120 --> 00:10:02,640
group over the years is that while

299
00:10:02,640 --> 00:10:04,720
they're not particularly sophisticated

300
00:10:04,720 --> 00:10:06,720
they are still successful

301
00:10:06,720 --> 00:10:08,320
by our estimates monitoring the

302
00:10:08,320 --> 00:10:10,160
directories they continue to leave open

303
00:10:10,160 --> 00:10:11,920
on some of their web servers and by

304
00:10:11,920 --> 00:10:13,200
downloading and reviewing the

305
00:10:13,200 --> 00:10:15,360
information this group has excel traded

306
00:10:15,360 --> 00:10:17,200
close to two terabytes of data from

307
00:10:17,200 --> 00:10:19,920
victims since the fall of 2018

308
00:10:19,920 --> 00:10:22,399
and that's just what we are able to see

309
00:10:22,399 --> 00:10:24,320
additionally not all this information

310
00:10:24,320 --> 00:10:26,240
was taken using the tools we previously

311
00:10:26,240 --> 00:10:27,440
discussed

312
00:10:27,440 --> 00:10:29,839
itg-18 is adept at using some of the

313
00:10:29,839 --> 00:10:31,600
built-in legitimate tools of the

314
00:10:31,600 --> 00:10:33,440
accounts they compromise including

315
00:10:33,440 --> 00:10:35,839
google takeout which allows users to

316
00:10:35,839 --> 00:10:37,519
export data related to all of their

317
00:10:37,519 --> 00:10:39,680
google accounts to include information

318
00:10:39,680 --> 00:10:42,000
from android devices into a downloadable

319
00:10:42,000 --> 00:10:43,440
archive file

320
00:10:43,440 --> 00:10:46,399
and this data is often very personal as

321
00:10:46,399 --> 00:10:48,079
an example for one compromised

322
00:10:48,079 --> 00:10:49,200
individual

323
00:10:49,200 --> 00:10:50,800
the google takeout data included

324
00:10:50,800 --> 00:10:53,120
location information so we were able to

325
00:10:53,120 --> 00:10:54,959
see this u.s person visiting u.s

326
00:10:54,959 --> 00:10:57,440
military bases as well as potentially

327
00:10:57,440 --> 00:10:59,519
taking a vacation such as when this

328
00:10:59,519 --> 00:11:02,000
person visited disney's epcot theme park

329
00:11:02,000 --> 00:11:03,680
spending time at the test track the

330
00:11:03,680 --> 00:11:05,760
imagination pavilion as well as the

331
00:11:05,760 --> 00:11:07,360
italian german chinese and mexican

332
00:11:07,360 --> 00:11:09,600
pavilions which you can see on the right

333
00:11:09,600 --> 00:11:11,839
of the slide

334
00:11:11,839 --> 00:11:14,079
also that data included that person's

335
00:11:14,079 --> 00:11:16,320
queries to the google voice assistant so

336
00:11:16,320 --> 00:11:19,040
we were actually able to hear snippets

337
00:11:19,040 --> 00:11:21,279
of this person's voice as well

338
00:11:21,279 --> 00:11:23,120
with all this personal information taken

339
00:11:23,120 --> 00:11:24,720
from targets of interest we can only

340
00:11:24,720 --> 00:11:26,160
guess at how it's been used by the

341
00:11:26,160 --> 00:11:28,000
iranian government to further their

342
00:11:28,000 --> 00:11:30,640
objectives

343
00:11:30,959 --> 00:11:32,240
now we've talked about some of the

344
00:11:32,240 --> 00:11:33,839
operational achievements for this group

345
00:11:33,839 --> 00:11:35,600
but where have they

346
00:11:35,600 --> 00:11:37,279
slipped up

347
00:11:37,279 --> 00:11:39,680
well we know about little looter and all

348
00:11:39,680 --> 00:11:41,200
this information they have exfiltrated

349
00:11:41,200 --> 00:11:42,560
because of persistent server

350
00:11:42,560 --> 00:11:44,079
misconfigurations

351
00:11:44,079 --> 00:11:46,800
it go team 18 routinely leaves open

352
00:11:46,800 --> 00:11:48,480
directories in some of their servers

353
00:11:48,480 --> 00:11:50,320
where they stage actual traded data and

354
00:11:50,320 --> 00:11:52,639
tools presumably before it's downloaded

355
00:11:52,639 --> 00:11:55,440
somewhere else over time after analyzing

356
00:11:55,440 --> 00:11:57,040
hundreds of their servers we've

357
00:11:57,040 --> 00:11:58,880
identified some other possible mistakes

358
00:11:58,880 --> 00:12:00,880
they've made in the past like possibly

359
00:12:00,880 --> 00:12:03,120
the one on the slide

360
00:12:03,120 --> 00:12:05,040
now if you have a specific target you're

361
00:12:05,040 --> 00:12:06,800
going after you usually want to keep

362
00:12:06,800 --> 00:12:09,519
that information secret so as not to tip

363
00:12:09,519 --> 00:12:11,519
off security researchers or the target

364
00:12:11,519 --> 00:12:12,959
itself

365
00:12:12,959 --> 00:12:15,920
but then on this itg 18 created web page

366
00:12:15,920 --> 00:12:18,320
on the slide the title was literally

367
00:12:18,320 --> 00:12:20,240
targets and the page included the

368
00:12:20,240 --> 00:12:22,160
target's phone number it's not

369
00:12:22,160 --> 00:12:24,079
broadcasting it on social media for sure

370
00:12:24,079 --> 00:12:27,760
but still maybe not best practice

371
00:12:27,760 --> 00:12:29,680
for this second example

372
00:12:29,680 --> 00:12:31,760
like any decent iranian fisher you might

373
00:12:31,760 --> 00:12:34,160
leverage the tool h-track for those of

374
00:12:34,160 --> 00:12:36,480
you who don't know h-track is a few free

375
00:12:36,480 --> 00:12:38,079
utility that allows you to download a

376
00:12:38,079 --> 00:12:40,079
website to a local directory by

377
00:12:40,079 --> 00:12:41,920
recursively grabbing all directories

378
00:12:41,920 --> 00:12:44,320
html files images to view the page

379
00:12:44,320 --> 00:12:45,920
offline

380
00:12:45,920 --> 00:12:47,600
you can see how this may be a useful

381
00:12:47,600 --> 00:12:49,920
tool for an avid fisher to use and how

382
00:12:49,920 --> 00:12:51,680
it could help create phishing pages that

383
00:12:51,680 --> 00:12:53,360
look legitimate

384
00:12:53,360 --> 00:12:55,279
but you generally don't want to run that

385
00:12:55,279 --> 00:12:57,839
tool against your c2 server

386
00:12:57,839 --> 00:12:59,760
and then leave the results of that scan

387
00:12:59,760 --> 00:13:01,519
on an open directory for anyone to

388
00:13:01,519 --> 00:13:04,000
download and analyze revealing details

389
00:13:04,000 --> 00:13:06,000
about the backdoor and additional c2

390
00:13:06,000 --> 00:13:08,160
servers which is what we see on this

391
00:13:08,160 --> 00:13:12,560
slide and is what itg-18 did

392
00:13:12,800 --> 00:13:15,200
and finally my personal favorite it

393
00:13:15,200 --> 00:13:17,120
might not seem like a priority for the

394
00:13:17,120 --> 00:13:18,639
server that you're using to host your

395
00:13:18,639 --> 00:13:20,880
phishing pages to keep that software up

396
00:13:20,880 --> 00:13:22,880
to date and to configure it that server

397
00:13:22,880 --> 00:13:25,120
to protect it from cyber threats

398
00:13:25,120 --> 00:13:26,959
but then you may also experience a

399
00:13:26,959 --> 00:13:28,880
suspected globe imposter ransomware

400
00:13:28,880 --> 00:13:31,680
incident like one itg 18 server did back

401
00:13:31,680 --> 00:13:33,040
in 2019

402
00:13:33,040 --> 00:13:34,800
ransomware is a big problem for a lot of

403
00:13:34,800 --> 00:13:38,480
organizations i2g 18 included

404
00:13:38,480 --> 00:13:39,839
these mistakes are interesting in

405
00:13:39,839 --> 00:13:41,440
reminders that the operators on the

406
00:13:41,440 --> 00:13:43,440
other side of the screen are only human

407
00:13:43,440 --> 00:13:44,880
just as prone to making errors and

408
00:13:44,880 --> 00:13:47,199
mistakes as we are but what set apart

409
00:13:47,199 --> 00:13:49,519
the videos the itg-18 operators

410
00:13:49,519 --> 00:13:51,279
accidentally left on one of their

411
00:13:51,279 --> 00:13:53,199
servers for one week in may from

412
00:13:53,199 --> 00:13:55,519
mistakes we previously observed was how

413
00:13:55,519 --> 00:13:57,360
much more detail we were able to glean

414
00:13:57,360 --> 00:14:00,399
about how itg-18 operates combined with

415
00:14:00,399 --> 00:14:02,320
continued server misconfigurations this

416
00:14:02,320 --> 00:14:03,920
group has continued to make since this

417
00:14:03,920 --> 00:14:06,160
initial discovery this has painted a

418
00:14:06,160 --> 00:14:07,440
more detailed picture of their

419
00:14:07,440 --> 00:14:09,120
operations that allison will cover

420
00:14:09,120 --> 00:14:12,079
during the rest of the presentation

421
00:14:12,079 --> 00:14:14,399
i just want everyone to marinate on that

422
00:14:14,399 --> 00:14:16,560
last point that richard made

423
00:14:16,560 --> 00:14:18,800
we saw a nation-state operator's

424
00:14:18,800 --> 00:14:21,440
infrastructure get ransomware due to

425
00:14:21,440 --> 00:14:23,360
poor security controls

426
00:14:23,360 --> 00:14:26,560
if that is not amusing um i don't know

427
00:14:26,560 --> 00:14:28,320
what is and god i love my job when

428
00:14:28,320 --> 00:14:30,320
things like this happen all right so

429
00:14:30,320 --> 00:14:32,320
back to the issue at hand richard and i

430
00:14:32,320 --> 00:14:34,160
have been working on the hypothesis that

431
00:14:34,160 --> 00:14:36,959
itg 18 is a pretty large operation for

432
00:14:36,959 --> 00:14:39,440
some time and the discoveries that we've

433
00:14:39,440 --> 00:14:41,760
had over the last year have really

434
00:14:41,760 --> 00:14:43,279
amplified that

435
00:14:43,279 --> 00:14:44,880
so i'm here to walk you through a couple

436
00:14:44,880 --> 00:14:47,279
of these factors in detail

437
00:14:47,279 --> 00:14:49,440
in terms of our recent findings we've

438
00:14:49,440 --> 00:14:51,519
repeatedly watched the four hours of

439
00:14:51,519 --> 00:14:53,440
videos they accidentally left on an open

440
00:14:53,440 --> 00:14:55,120
server which addition is some training

441
00:14:55,120 --> 00:14:56,720
videos that we're going to show at the

442
00:14:56,720 --> 00:14:58,399
end of the presentation

443
00:14:58,399 --> 00:15:00,399
also include the adversary excel trading

444
00:15:00,399 --> 00:15:03,040
information from accounts and validating

445
00:15:03,040 --> 00:15:04,399
all the credentials that they've been

446
00:15:04,399 --> 00:15:05,760
able to steal

447
00:15:05,760 --> 00:15:07,839
and we saw them log into these accounts

448
00:15:07,839 --> 00:15:10,079
manually and look for more details on

449
00:15:10,079 --> 00:15:11,920
the victim as well as downloading any

450
00:15:11,920 --> 00:15:13,760
additional metadata associated with the

451
00:15:13,760 --> 00:15:14,639
account

452
00:15:14,639 --> 00:15:16,560
and what was really interesting to us

453
00:15:16,560 --> 00:15:18,880
was that there was no account that was

454
00:15:18,880 --> 00:15:21,360
too trivial for them to test credentials

455
00:15:21,360 --> 00:15:23,440
for and we put a sample of those up on

456
00:15:23,440 --> 00:15:26,000
this slide but you know we saw diaper

457
00:15:26,000 --> 00:15:29,279
reward sites food delivery sites you

458
00:15:29,279 --> 00:15:31,839
name it if they had a credential for it

459
00:15:31,839 --> 00:15:35,519
they logged in and looked around

460
00:15:35,519 --> 00:15:37,600
and a little aside about the manual

461
00:15:37,600 --> 00:15:39,680
credential validation they also

462
00:15:39,680 --> 00:15:42,240
attempted captcha for accounts and

463
00:15:42,240 --> 00:15:43,920
and we all know how fun those are right

464
00:15:43,920 --> 00:15:46,399
and so to just humanize this adversary a

465
00:15:46,399 --> 00:15:48,720
little bit more they struggled like the

466
00:15:48,720 --> 00:15:51,120
rest of us with some of these so

467
00:15:51,120 --> 00:15:53,120
if we check out the traffic light on the

468
00:15:53,120 --> 00:15:56,160
left there's a tiny little piece of it

469
00:15:56,160 --> 00:15:58,240
in another quadrant

470
00:15:58,240 --> 00:16:00,399
uh and this hung them up for a bit i

471
00:16:00,399 --> 00:16:02,639
think uh richard and i clocked it about

472
00:16:02,639 --> 00:16:04,959
45 seconds it took them to figure out

473
00:16:04,959 --> 00:16:06,639
that that's the box they needed to click

474
00:16:06,639 --> 00:16:09,920
to get through so we had a nice chuckle

475
00:16:09,920 --> 00:16:11,839
at that but it's it's a great reminder

476
00:16:11,839 --> 00:16:15,600
that threat actors are humans too

477
00:16:16,480 --> 00:16:18,880
the other thing that richard and i uh

478
00:16:18,880 --> 00:16:21,360
have been hypothesizing is that the

479
00:16:21,360 --> 00:16:24,320
operators might be given their own vps

480
00:16:24,320 --> 00:16:26,560
or virtual private server to perform

481
00:16:26,560 --> 00:16:29,600
operations soup to nuts possibly even

482
00:16:29,600 --> 00:16:31,759
getting a set list of targets so

483
00:16:31,759 --> 00:16:33,920
specifically on some of the open servers

484
00:16:33,920 --> 00:16:37,360
we found we have seen a combination of

485
00:16:37,360 --> 00:16:40,240
victim exfiltrated information and tools

486
00:16:40,240 --> 00:16:42,399
on the same server

487
00:16:42,399 --> 00:16:44,320
so these two open servers on the screen

488
00:16:44,320 --> 00:16:46,240
that we're looking at are associated

489
00:16:46,240 --> 00:16:48,560
with itg-18 operations we found in the

490
00:16:48,560 --> 00:16:50,639
fall and the files circled in the

491
00:16:50,639 --> 00:16:53,600
pinkish purple magenta tint

492
00:16:53,600 --> 00:16:56,000
are exfiltrated data from some of their

493
00:16:56,000 --> 00:16:57,600
victims

494
00:16:57,600 --> 00:17:00,560
but then we're also seeing tools as well

495
00:17:00,560 --> 00:17:02,320
and so the image on the left we've got a

496
00:17:02,320 --> 00:17:04,959
valid copy of whatsapp installer and

497
00:17:04,959 --> 00:17:06,240
we're not sure

498
00:17:06,240 --> 00:17:07,760
if this was there

499
00:17:07,760 --> 00:17:09,039
to install

500
00:17:09,039 --> 00:17:11,679
so itg-18 operators could communicate

501
00:17:11,679 --> 00:17:14,480
with each other or if it was potentially

502
00:17:14,480 --> 00:17:16,839
used to identify and lower new

503
00:17:16,839 --> 00:17:19,199
targets now in the image on the right

504
00:17:19,199 --> 00:17:21,439
we've got more tools including a file

505
00:17:21,439 --> 00:17:23,439
called whatsapp.apk

506
00:17:23,439 --> 00:17:25,199
that is the little looter malware that

507
00:17:25,199 --> 00:17:27,359
richard covered earlier

508
00:17:27,359 --> 00:17:29,679
we're also seeing a winrar folder that

509
00:17:29,679 --> 00:17:32,000
contains valid copies of winrar

510
00:17:32,000 --> 00:17:34,240
potentially used to unzip the

511
00:17:34,240 --> 00:17:38,080
exfiltrated data from victims

512
00:17:38,640 --> 00:17:40,640
our theory that each operator may have

513
00:17:40,640 --> 00:17:42,400
their own box or target list was

514
00:17:42,400 --> 00:17:44,240
supported with the training videos that

515
00:17:44,240 --> 00:17:46,320
we're going to show you in a moment

516
00:17:46,320 --> 00:17:49,120
specifically we saw actors managing sets

517
00:17:49,120 --> 00:17:51,600
of compromised email accounts

518
00:17:51,600 --> 00:17:54,160
with sets of operator email accounts

519
00:17:54,160 --> 00:17:56,400
within the same tool and again we're

520
00:17:56,400 --> 00:17:57,760
going to cover what we're seeing in this

521
00:17:57,760 --> 00:17:59,440
image when in a little bit more detail

522
00:17:59,440 --> 00:18:02,960
when we watch the video shortly

523
00:18:05,039 --> 00:18:06,640
to put it bluntly

524
00:18:06,640 --> 00:18:10,080
we think this is a very large operation

525
00:18:10,080 --> 00:18:12,240
in terms of the humans behind it just

526
00:18:12,240 --> 00:18:13,840
the sheer amount of infrastructure that

527
00:18:13,840 --> 00:18:15,360
this group has created supports this

528
00:18:15,360 --> 00:18:18,320
theory on his own so for example we here

529
00:18:18,320 --> 00:18:20,960
at ibm have collected over 2 000

530
00:18:20,960 --> 00:18:24,000
indicators associated with itg 18

531
00:18:24,000 --> 00:18:27,440
since 2018 this includes certificates

532
00:18:27,440 --> 00:18:30,320
phishing server phishing domains c2

533
00:18:30,320 --> 00:18:31,520
servers

534
00:18:31,520 --> 00:18:34,080
we've also identified their intermediate

535
00:18:34,080 --> 00:18:36,160
vpn infrastructure which at any given

536
00:18:36,160 --> 00:18:40,320
time has 20 10 to 20 active vpn servers

537
00:18:40,320 --> 00:18:43,120
we've also identified over two terabytes

538
00:18:43,120 --> 00:18:46,160
of victimxville just since 2018 and

539
00:18:46,160 --> 00:18:49,360
again this is just our research

540
00:18:49,360 --> 00:18:51,840
another supporting factor is that we

541
00:18:51,840 --> 00:18:54,320
have consistently seen this group pivot

542
00:18:54,320 --> 00:18:56,720
to various objectives that serve both

543
00:18:56,720 --> 00:18:59,039
long and short-term

544
00:18:59,039 --> 00:19:01,360
collection objectives this pivoting

545
00:19:01,360 --> 00:19:03,280
would likely not be possible without a

546
00:19:03,280 --> 00:19:05,360
considerable amount of manpower behind

547
00:19:05,360 --> 00:19:06,640
it

548
00:19:06,640 --> 00:19:08,640
for example they've consistently

549
00:19:08,640 --> 00:19:10,640
targeted iranian journalists and

550
00:19:10,640 --> 00:19:12,880
researchers in country and abroad but

551
00:19:12,880 --> 00:19:14,720
they've also gone after foreign targets

552
00:19:14,720 --> 00:19:16,559
like covid researchers nuclear

553
00:19:16,559 --> 00:19:19,360
regulators u.s politicians and financial

554
00:19:19,360 --> 00:19:20,960
regulators all depending on what's

555
00:19:20,960 --> 00:19:23,039
happening in country

556
00:19:23,039 --> 00:19:24,960
we covered how the data and the

557
00:19:24,960 --> 00:19:26,960
credentials are stolen and manually

558
00:19:26,960 --> 00:19:30,240
validated which again is extremely time

559
00:19:30,240 --> 00:19:33,520
consuming there is no way that scales

560
00:19:33,520 --> 00:19:35,840
with the amount of expo this group has

561
00:19:35,840 --> 00:19:38,640
collected without a considerable amount

562
00:19:38,640 --> 00:19:41,200
of manpower behind them

563
00:19:41,200 --> 00:19:42,559
and finally

564
00:19:42,559 --> 00:19:44,559
we found what we are pretty sure are

565
00:19:44,559 --> 00:19:47,200
training videos for new operators so

566
00:19:47,200 --> 00:19:49,120
this would suggest that not only the

567
00:19:49,120 --> 00:19:51,280
group is large enough to need training

568
00:19:51,280 --> 00:19:52,480
videos

569
00:19:52,480 --> 00:19:54,080
but also that they might have some

570
00:19:54,080 --> 00:19:55,679
turnover

571
00:19:55,679 --> 00:19:57,919
so now it's time to get to the part of

572
00:19:57,919 --> 00:19:59,360
why i suspect

573
00:19:59,360 --> 00:20:01,360
many folks are here listening this talk

574
00:20:01,360 --> 00:20:04,918
the training videos

575
00:20:06,320 --> 00:20:07,760
before we jump into the videos though we

576
00:20:07,760 --> 00:20:09,760
wanted to give you a quick primer on on

577
00:20:09,760 --> 00:20:11,360
what they are and what we're about to

578
00:20:11,360 --> 00:20:14,480
see so these are desktop recordings made

579
00:20:14,480 --> 00:20:16,559
by the adversary with a tool called

580
00:20:16,559 --> 00:20:19,600
bandicam bandicam is legitimate software

581
00:20:19,600 --> 00:20:23,120
you can buy it in the case of the itg-18

582
00:20:23,120 --> 00:20:24,880
operator running it it doesn't look like

583
00:20:24,880 --> 00:20:27,000
they did

584
00:20:27,000 --> 00:20:30,880
itg-18 created persona accounts on aol

585
00:20:30,880 --> 00:20:33,600
yahoo gmail and hotmail they logged into

586
00:20:33,600 --> 00:20:36,480
these accounts from known itg 18 vpn

587
00:20:36,480 --> 00:20:39,280
infrastructure which we saw while

588
00:20:39,280 --> 00:20:40,799
we were watching the videos and an

589
00:20:40,799 --> 00:20:43,120
example of what this looked like is here

590
00:20:43,120 --> 00:20:44,960
on the slide

591
00:20:44,960 --> 00:20:47,840
all of these accounts were fakes

592
00:20:47,840 --> 00:20:49,760
confirmed fakes the personas all had

593
00:20:49,760 --> 00:20:51,679
western names but when viewable there

594
00:20:51,679 --> 00:20:53,679
were iranian phone numbers associated

595
00:20:53,679 --> 00:20:55,039
with the accounts again this is

596
00:20:55,039 --> 00:20:56,320
something we're going to see in the

597
00:20:56,320 --> 00:20:58,799
videos

598
00:20:59,039 --> 00:21:01,039
okay so the videos are going to show the

599
00:21:01,039 --> 00:21:03,120
operators demoing setup

600
00:21:03,120 --> 00:21:05,520
demoing setting up a compromised account

601
00:21:05,520 --> 00:21:07,360
for continuous monitoring using an email

602
00:21:07,360 --> 00:21:09,600
collaboration platform called zimbra

603
00:21:09,600 --> 00:21:12,400
zimbra is also a legitimate tool

604
00:21:12,400 --> 00:21:13,919
and finally the videos are going to show

605
00:21:13,919 --> 00:21:16,000
the operators demo demoing how to

606
00:21:16,000 --> 00:21:17,840
exfiltrate various types of information

607
00:21:17,840 --> 00:21:19,679
on their victims

608
00:21:19,679 --> 00:21:20,880
through

609
00:21:20,880 --> 00:21:22,000
the various

610
00:21:22,000 --> 00:21:24,080
web mail platforms

611
00:21:24,080 --> 00:21:25,600
last but not least

612
00:21:25,600 --> 00:21:28,720
in order for us to be here

613
00:21:28,720 --> 00:21:30,480
and talk about these videos and show

614
00:21:30,480 --> 00:21:33,520
them when we uh had one of our teams at

615
00:21:33,520 --> 00:21:36,240
ibm blur out the victim and persona

616
00:21:36,240 --> 00:21:38,559
information for um this presentation

617
00:21:38,559 --> 00:21:40,879
today

618
00:21:41,360 --> 00:21:43,679
all right so let's uh

619
00:21:43,679 --> 00:21:45,440
let's get started

620
00:21:45,440 --> 00:21:48,320
so what we're going to start with now is

621
00:21:48,320 --> 00:21:51,120
the gmail training video and so what

622
00:21:51,120 --> 00:21:53,679
everyone should be seeing now is a

623
00:21:53,679 --> 00:21:56,400
dark desktop with bandicam open and this

624
00:21:56,400 --> 00:21:58,640
is how all of these videos start with

625
00:21:58,640 --> 00:22:00,640
launching bandicam the desktop

626
00:22:00,640 --> 00:22:04,559
desktop recording software

627
00:22:04,880 --> 00:22:05,760
what they're going to do is they're

628
00:22:05,760 --> 00:22:06,880
going to open chrome and they're going

629
00:22:06,880 --> 00:22:11,720
to browse over to gmail

630
00:22:12,320 --> 00:22:14,159
and we saw this pretty frequently

631
00:22:14,159 --> 00:22:16,240
throughout the um

632
00:22:16,240 --> 00:22:17,520
the victim

633
00:22:17,520 --> 00:22:19,919
videos as well where the

634
00:22:19,919 --> 00:22:22,640
operator had a notepad file open with

635
00:22:22,640 --> 00:22:23,919
all of the credentials that had been

636
00:22:23,919 --> 00:22:26,000
taken in

637
00:22:26,000 --> 00:22:27,520
an easy format for them to copy and

638
00:22:27,520 --> 00:22:29,280
paste so what they're going to do here

639
00:22:29,280 --> 00:22:30,960
is they're going to copy and paste the

640
00:22:30,960 --> 00:22:33,120
credentials into gmail and we'll see

641
00:22:33,120 --> 00:22:34,480
them do the same thing with yahoo but

642
00:22:34,480 --> 00:22:36,480
this is just a list of the persona

643
00:22:36,480 --> 00:22:37,919
accounts that they created for the

644
00:22:37,919 --> 00:22:41,360
various training videos

645
00:22:41,360 --> 00:22:43,039
so right now

646
00:22:43,039 --> 00:22:46,400
they're going to copy the username

647
00:22:47,600 --> 00:22:50,158
paste it

648
00:22:50,559 --> 00:22:53,039
and they'll go back to the notepad file

649
00:22:53,039 --> 00:22:55,039
and copy the password

650
00:22:55,039 --> 00:22:58,640
again very manual process

651
00:23:04,080 --> 00:23:08,240
no mfa on these accounts

652
00:23:08,240 --> 00:23:11,919
all right so now we're in the mailbox um

653
00:23:11,919 --> 00:23:13,440
you're seeing that a lot of

654
00:23:13,440 --> 00:23:15,440
the emails are blurred out uh what we

655
00:23:15,440 --> 00:23:16,640
saw with

656
00:23:16,640 --> 00:23:18,720
uh the persona accounts was that a lot

657
00:23:18,720 --> 00:23:20,559
of them had signed up for mailing lists

658
00:23:20,559 --> 00:23:22,240
and richard and i couldn't see a rhyme

659
00:23:22,240 --> 00:23:24,480
or reason to the particular mailing list

660
00:23:24,480 --> 00:23:25,919
we think they did this to make the

661
00:23:25,919 --> 00:23:28,240
accounts appear active and more

662
00:23:28,240 --> 00:23:29,679
legitimate so they could fly under the

663
00:23:29,679 --> 00:23:33,919
radar of the various webmail providers

664
00:23:35,039 --> 00:23:36,640
so at this point they're going to browse

665
00:23:36,640 --> 00:23:38,880
over to settings of the gmail account

666
00:23:38,880 --> 00:23:40,640
and modify the account so they can

667
00:23:40,640 --> 00:23:43,440
incorporate the account into zimbra the

668
00:23:43,440 --> 00:23:45,600
email collaboration platform so what

669
00:23:45,600 --> 00:23:46,559
they're doing now is they're just

670
00:23:46,559 --> 00:23:48,480
scrolling down to the part of the

671
00:23:48,480 --> 00:23:50,320
account to change those particular

672
00:23:50,320 --> 00:23:52,799
settings

673
00:23:53,120 --> 00:23:55,360
which are literally less secure access

674
00:23:55,360 --> 00:23:57,440
is the name of the setting you flag that

675
00:23:57,440 --> 00:23:58,480
on

676
00:23:58,480 --> 00:24:01,440
which they're going to do

677
00:24:03,039 --> 00:24:05,120
all right that's been flagged on and now

678
00:24:05,120 --> 00:24:07,520
they're going to go back to the

679
00:24:07,520 --> 00:24:10,240
mailbox and archive the alert that this

680
00:24:10,240 --> 00:24:12,240
setting has been made i probably would

681
00:24:12,240 --> 00:24:13,520
delete it

682
00:24:13,520 --> 00:24:14,960
but that's just me

683
00:24:14,960 --> 00:24:16,159
and then they're going to get an alert

684
00:24:16,159 --> 00:24:18,080
did you make the setting change yes it

685
00:24:18,080 --> 00:24:20,320
was me

686
00:24:20,320 --> 00:24:22,960
so now we're all set up

687
00:24:22,960 --> 00:24:24,960
so at this point this is zimbra they are

688
00:24:24,960 --> 00:24:28,960
going to add the gmail account into um

689
00:24:28,960 --> 00:24:30,880
to zimbra

690
00:24:30,880 --> 00:24:32,559
and they're just going to copy and paste

691
00:24:32,559 --> 00:24:34,880
the email address as the account name

692
00:24:34,880 --> 00:24:37,120
full name etc

693
00:24:37,120 --> 00:24:39,039
much easier to manage that way and then

694
00:24:39,039 --> 00:24:41,520
they'll copy the password in

695
00:24:41,520 --> 00:24:42,640
and at this point they're going to

696
00:24:42,640 --> 00:24:44,960
change the syncing from

697
00:24:44,960 --> 00:24:46,640
every 15 minutes the default to every

698
00:24:46,640 --> 00:24:48,080
minute naturally you're going to want

699
00:24:48,080 --> 00:24:49,760
things in near real time

700
00:24:49,760 --> 00:24:51,120
so we're going to see an authentication

701
00:24:51,120 --> 00:24:52,400
error here

702
00:24:52,400 --> 00:24:54,640
part of what we did

703
00:24:54,640 --> 00:24:57,600
when we were doing notifications

704
00:24:57,600 --> 00:24:59,039
before we went public with the research

705
00:24:59,039 --> 00:25:00,960
was reach out to

706
00:25:00,960 --> 00:25:02,640
victims

707
00:25:02,640 --> 00:25:04,320
what we found out in this particular

708
00:25:04,320 --> 00:25:05,840
case is one of the victims had already

709
00:25:05,840 --> 00:25:07,360
been notified that their account had

710
00:25:07,360 --> 00:25:08,960
been compromised and they changed the

711
00:25:08,960 --> 00:25:11,600
password so the adversary was no longer

712
00:25:11,600 --> 00:25:13,679
able to authenticate into that account

713
00:25:13,679 --> 00:25:15,679
so we'll see that authentication error a

714
00:25:15,679 --> 00:25:16,880
couple times

715
00:25:16,880 --> 00:25:19,440
in this training video and again

716
00:25:19,440 --> 00:25:22,640
when we show the other

717
00:25:23,520 --> 00:25:24,960
so there it is

718
00:25:24,960 --> 00:25:26,320
i'm just going to dismiss that and move

719
00:25:26,320 --> 00:25:27,279
on

720
00:25:27,279 --> 00:25:30,480
and at this point we are going to

721
00:25:30,480 --> 00:25:33,679
make sure that all of the

722
00:25:33,679 --> 00:25:35,440
folders in that gmail account are

723
00:25:35,440 --> 00:25:37,840
syncing into zimbra

724
00:25:37,840 --> 00:25:39,279
even the junk folder you never know

725
00:25:39,279 --> 00:25:42,960
there might be something fun in there

726
00:25:42,960 --> 00:25:45,679
trash as well

727
00:25:46,559 --> 00:25:48,799
all right now that that's syncing the

728
00:25:48,799 --> 00:25:50,480
adversary is going to navigate to

729
00:25:50,480 --> 00:25:52,480
different aspects of the gmail account

730
00:25:52,480 --> 00:25:54,640
starting with google drive and download

731
00:25:54,640 --> 00:25:57,039
information associated with it so

732
00:25:57,039 --> 00:25:59,120
now if this was a valid account like

733
00:25:59,120 --> 00:26:01,520
yours or mine we'd probably have more

734
00:26:01,520 --> 00:26:02,960
files in here

735
00:26:02,960 --> 00:26:04,159
and the download would take a little

736
00:26:04,159 --> 00:26:05,440
longer but what you'll see is they

737
00:26:05,440 --> 00:26:07,679
select everything and download it and

738
00:26:07,679 --> 00:26:09,520
again those are just dummy files this is

739
00:26:09,520 --> 00:26:10,720
one of my favorite parts watch the

740
00:26:10,720 --> 00:26:11,919
address bar

741
00:26:11,919 --> 00:26:13,440
and pause it real quick

742
00:26:13,440 --> 00:26:16,880
they fat finger the email or the url for

743
00:26:16,880 --> 00:26:18,559
contacts.google.com

744
00:26:18,559 --> 00:26:21,279
again humans behind the keyboard they'll

745
00:26:21,279 --> 00:26:22,799
fix it

746
00:26:22,799 --> 00:26:24,960
it's frustrating isn't it

747
00:26:24,960 --> 00:26:27,520
context.google.com

748
00:26:27,520 --> 00:26:30,000
and again this was just uh you know test

749
00:26:30,000 --> 00:26:32,240
information added to the account for we

750
00:26:32,240 --> 00:26:34,400
think for demo purposes you and i would

751
00:26:34,400 --> 00:26:36,320
probably have more contacts associated

752
00:26:36,320 --> 00:26:38,480
and the downloads would take longer now

753
00:26:38,480 --> 00:26:40,000
we're going over to photos photos was

754
00:26:40,000 --> 00:26:42,400
interesting to us because we got

755
00:26:42,400 --> 00:26:44,240
a timeline of how long this account may

756
00:26:44,240 --> 00:26:46,559
have been active again

757
00:26:46,559 --> 00:26:48,320
nothing super exciting in here except

758
00:26:48,320 --> 00:26:50,559
the news that's followed and maybe their

759
00:26:50,559 --> 00:26:52,880
marvel comic preference but what we're

760
00:26:52,880 --> 00:26:54,799
going to see as they scroll down is this

761
00:26:54,799 --> 00:26:56,400
account has been active since february

762
00:26:56,400 --> 00:26:59,440
of 2019 and we found this in may of

763
00:26:59,440 --> 00:27:01,520
2020.

764
00:27:01,520 --> 00:27:02,799
so again they're going to select all the

765
00:27:02,799 --> 00:27:03,840
images

766
00:27:03,840 --> 00:27:06,880
download them

767
00:27:06,880 --> 00:27:08,480
slowly

768
00:27:08,480 --> 00:27:12,320
and again if this was a a victim account

769
00:27:12,320 --> 00:27:13,679
it's going to take a lot longer to

770
00:27:13,679 --> 00:27:15,600
download but you know as richard and i

771
00:27:15,600 --> 00:27:17,279
have watched these videos

772
00:27:17,279 --> 00:27:20,480
numerous times we still can't get over

773
00:27:20,480 --> 00:27:22,399
how quickly the adversary was able to

774
00:27:22,399 --> 00:27:23,440
navigate through these different

775
00:27:23,440 --> 00:27:24,960
accounts what they're doing at this

776
00:27:24,960 --> 00:27:27,679
point is they're checking all of the

777
00:27:27,679 --> 00:27:29,679
various aspects of the gmail account

778
00:27:29,679 --> 00:27:31,039
that they've downloaded to make sure

779
00:27:31,039 --> 00:27:33,279
that it was populated with information

780
00:27:33,279 --> 00:27:35,039
so they check contacts they just check

781
00:27:35,039 --> 00:27:37,760
drive and they'll check photos

782
00:27:37,760 --> 00:27:39,919
and then they will move over to bandicam

783
00:27:39,919 --> 00:27:41,679
and stop the recording because the demo

784
00:27:41,679 --> 00:27:44,000
is done

785
00:27:45,120 --> 00:27:46,880
so that was the gmail

786
00:27:46,880 --> 00:27:49,039
training video at this point we're going

787
00:27:49,039 --> 00:27:50,960
to go over to

788
00:27:50,960 --> 00:27:52,960
yahoo

789
00:27:52,960 --> 00:27:54,480
and again you'll notice that setting up

790
00:27:54,480 --> 00:27:55,440
the

791
00:27:55,440 --> 00:27:57,679
yahoo account for monitoring is a little

792
00:27:57,679 --> 00:27:59,919
bit different than gmail but one of the

793
00:27:59,919 --> 00:28:02,480
things i i know i've said it

794
00:28:02,480 --> 00:28:04,480
but it just still blows both of our

795
00:28:04,480 --> 00:28:07,279
minds is how quickly the adversary is

796
00:28:07,279 --> 00:28:09,279
able to get into these accounts and set

797
00:28:09,279 --> 00:28:11,600
them up for monitoring and exfiltration

798
00:28:11,600 --> 00:28:13,440
it just speaks to how long

799
00:28:13,440 --> 00:28:15,360
the actor's been doing this so again

800
00:28:15,360 --> 00:28:17,120
bandicam starts

801
00:28:17,120 --> 00:28:19,279
we launch chrome and then we browse over

802
00:28:19,279 --> 00:28:21,600
to yahoo they're going to go back to

803
00:28:21,600 --> 00:28:24,799
their notepad file copy and paste the

804
00:28:24,799 --> 00:28:27,120
credentials for their yahoo persona

805
00:28:27,120 --> 00:28:28,080
account

806
00:28:28,080 --> 00:28:31,559
and log in

807
00:28:34,640 --> 00:28:38,320
and go back and get the password

808
00:28:42,320 --> 00:28:44,480
there we go

809
00:28:44,480 --> 00:28:46,640
copy

810
00:28:46,640 --> 00:28:48,960
paste

811
00:28:52,559 --> 00:28:55,200
so again with the yahoo account and we

812
00:28:55,200 --> 00:28:57,279
saw this with the other accounts as well

813
00:28:57,279 --> 00:28:59,279
but there were some mailing lists that

814
00:28:59,279 --> 00:29:01,600
the adversaries subscribed to we think

815
00:29:01,600 --> 00:29:03,919
again to get um to make the accounts

816
00:29:03,919 --> 00:29:05,919
look more legitimate but the other thing

817
00:29:05,919 --> 00:29:08,000
that we saw in here that sort of speaks

818
00:29:08,000 --> 00:29:09,679
to what these accounts are also likely

819
00:29:09,679 --> 00:29:12,399
used for is bounce back messages so

820
00:29:12,399 --> 00:29:15,360
again we found these videos in may we're

821
00:29:15,360 --> 00:29:17,120
seeing some bounce-back messages from

822
00:29:17,120 --> 00:29:19,840
april uh that indicate that some

823
00:29:19,840 --> 00:29:21,600
messages had been sent to folks now

824
00:29:21,600 --> 00:29:24,000
we've obviously blurred these out

825
00:29:24,000 --> 00:29:26,240
but this is how richard and i determined

826
00:29:26,240 --> 00:29:28,559
that there were people from the u.s

827
00:29:28,559 --> 00:29:30,240
state department as well as an

828
00:29:30,240 --> 00:29:32,720
iranian-american philanthropist targeted

829
00:29:32,720 --> 00:29:35,679
in one of the cases the email

830
00:29:35,679 --> 00:29:37,279
address was fat-fingered and that's why

831
00:29:37,279 --> 00:29:39,200
it bounced back the others clearly

832
00:29:39,200 --> 00:29:40,960
weren't valid email addresses but

833
00:29:40,960 --> 00:29:44,159
attempts were clearly made

834
00:29:44,559 --> 00:29:46,880
all right so at this point

835
00:29:46,880 --> 00:29:49,440
they are going to modify the yahoo

836
00:29:49,440 --> 00:29:51,200
account to incorporate into zimbra and

837
00:29:51,200 --> 00:29:52,640
we're going to get to see

838
00:29:52,640 --> 00:29:54,960
a couple more interesting data points as

839
00:29:54,960 --> 00:29:56,320
they navigate through the account

840
00:29:56,320 --> 00:29:57,840
information

841
00:29:57,840 --> 00:30:00,080
i'm going to scroll down a little bit

842
00:30:00,080 --> 00:30:01,120
and

843
00:30:01,120 --> 00:30:03,919
and what we've got here is a plus nine

844
00:30:03,919 --> 00:30:06,720
eight phone number associated with this

845
00:30:06,720 --> 00:30:09,039
account that again had western names so

846
00:30:09,039 --> 00:30:11,200
plus nine eight for folks who don't know

847
00:30:11,200 --> 00:30:12,960
is the iran country code for phone

848
00:30:12,960 --> 00:30:14,960
numbers so this was a really great data

849
00:30:14,960 --> 00:30:18,240
point uh when we saw this and we did see

850
00:30:18,240 --> 00:30:20,720
this with some of the other accounts

851
00:30:20,720 --> 00:30:22,399
so here we are setting up

852
00:30:22,399 --> 00:30:24,480
access to zimbra it's a little bit

853
00:30:24,480 --> 00:30:25,520
different

854
00:30:25,520 --> 00:30:27,919
than it was for gmail so in yahoo you

855
00:30:27,919 --> 00:30:30,720
create a special application password

856
00:30:30,720 --> 00:30:31,919
what they're doing here is they're going

857
00:30:31,919 --> 00:30:33,760
to copy the username of the yahoo

858
00:30:33,760 --> 00:30:36,159
account so they can paste it into zimbra

859
00:30:36,159 --> 00:30:38,720
as they set up

860
00:30:38,720 --> 00:30:40,240
so we're going to add the new yahoo

861
00:30:40,240 --> 00:30:41,760
account

862
00:30:41,760 --> 00:30:43,760
paste this in they actually fat finger

863
00:30:43,760 --> 00:30:45,360
the email address here

864
00:30:45,360 --> 00:30:47,039
you'll see a little c hanging out from

865
00:30:47,039 --> 00:30:48,240
the blur

866
00:30:48,240 --> 00:30:50,720
backspace and then copy and paste

867
00:30:50,720 --> 00:30:53,440
and then go back to

868
00:30:53,440 --> 00:30:54,799
yahoo

869
00:30:54,799 --> 00:30:56,880
copy the password

870
00:30:56,880 --> 00:30:58,159
paste it in and then they're going to

871
00:30:58,159 --> 00:31:00,240
change the syncing from every 15 minutes

872
00:31:00,240 --> 00:31:01,919
to every minute again

873
00:31:01,919 --> 00:31:04,080
so you can get those emails sooner

874
00:31:04,080 --> 00:31:05,440
rather than later you'll see the

875
00:31:05,440 --> 00:31:07,039
authentication error we talked about

876
00:31:07,039 --> 00:31:09,519
earlier

877
00:31:10,640 --> 00:31:12,240
and similar to gmail they're going to

878
00:31:12,240 --> 00:31:14,640
sync all of the folders of interest in

879
00:31:14,640 --> 00:31:18,760
this account so inbox

880
00:31:18,880 --> 00:31:20,320
we'll see those bounce back messages

881
00:31:20,320 --> 00:31:21,360
there

882
00:31:21,360 --> 00:31:23,840
quickly

883
00:31:26,080 --> 00:31:27,519
and at this point they're going to go

884
00:31:27,519 --> 00:31:29,919
back to the yahoo account and

885
00:31:29,919 --> 00:31:31,440
export the

886
00:31:31,440 --> 00:31:33,200
contacts now in the case of the yahoo

887
00:31:33,200 --> 00:31:34,799
account they didn't add

888
00:31:34,799 --> 00:31:36,960
any test data to it so there's nothing

889
00:31:36,960 --> 00:31:37,760
in

890
00:31:37,760 --> 00:31:40,399
the file

891
00:31:42,080 --> 00:31:46,039
but we'll see them do it anyway

892
00:31:50,000 --> 00:31:51,440
and again double check but there's

893
00:31:51,440 --> 00:31:54,080
nothing in there

894
00:31:54,559 --> 00:31:57,919
and stop the video so um

895
00:31:57,919 --> 00:31:59,679
in and out in two to five minutes again

896
00:31:59,679 --> 00:32:03,679
it would be a lot quicker if it were uh

897
00:32:03,679 --> 00:32:06,559
or a lot longer if it were

898
00:32:06,559 --> 00:32:09,120
a legitimate account or victim account

899
00:32:09,120 --> 00:32:10,399
um

900
00:32:10,399 --> 00:32:12,159
i'm sort of closing this up so i hope

901
00:32:12,159 --> 00:32:14,080
it's clear that richard and i have

902
00:32:14,080 --> 00:32:16,159
really enjoyed this research but i

903
00:32:16,159 --> 00:32:17,919
wanted to wrap this up on a serious note

904
00:32:17,919 --> 00:32:20,960
because this is actually a very serious

905
00:32:20,960 --> 00:32:21,919
topic

906
00:32:21,919 --> 00:32:22,960
so

907
00:32:22,960 --> 00:32:24,399
we will say this until we're blue in the

908
00:32:24,399 --> 00:32:27,039
face and richard and i are not alone

909
00:32:27,039 --> 00:32:30,880
we as network defenders

910
00:32:30,880 --> 00:32:32,559
have got to normalize putting

911
00:32:32,559 --> 00:32:34,240
multi-factor authentication on

912
00:32:34,240 --> 00:32:36,480
everything until then threat actors are

913
00:32:36,480 --> 00:32:38,000
not going to improve their game this is

914
00:32:38,000 --> 00:32:41,200
not limited to itg-18 we see this across

915
00:32:41,200 --> 00:32:43,840
the board

916
00:32:44,000 --> 00:32:45,760
it really

917
00:32:45,760 --> 00:32:47,600
we can't drive this point home enough to

918
00:32:47,600 --> 00:32:49,679
put it lightly

919
00:32:49,679 --> 00:32:51,360
two although

920
00:32:51,360 --> 00:32:53,200
we took a light approach to some of this

921
00:32:53,200 --> 00:32:54,480
today

922
00:32:54,480 --> 00:32:57,360
itg-18 is actually a very serious and

923
00:32:57,360 --> 00:32:59,519
prolific successful threat group that

924
00:32:59,519 --> 00:33:02,159
runs both espionage and surveillance

925
00:33:02,159 --> 00:33:04,399
surveillance operations we've seen they

926
00:33:04,399 --> 00:33:06,159
have the ability to mass collect

927
00:33:06,159 --> 00:33:08,399
information not just off personal

928
00:33:08,399 --> 00:33:10,640
webmail accounts but also off of cell

929
00:33:10,640 --> 00:33:11,600
phones

930
00:33:11,600 --> 00:33:13,840
they have hardly changed their tactics

931
00:33:13,840 --> 00:33:16,159
in the last four years yet they continue

932
00:33:16,159 --> 00:33:18,399
to expand their targets and operations

933
00:33:18,399 --> 00:33:19,200
so

934
00:33:19,200 --> 00:33:21,679
this spring for example richard and i

935
00:33:21,679 --> 00:33:22,960
observed

936
00:33:22,960 --> 00:33:25,519
them targeting iranian citizens involved

937
00:33:25,519 --> 00:33:27,440
in the reformist movement

938
00:33:27,440 --> 00:33:30,640
that no doubt this was in line to to

939
00:33:30,640 --> 00:33:32,960
monitor this party's activity around the

940
00:33:32,960 --> 00:33:34,799
recent iranian presidential election

941
00:33:34,799 --> 00:33:38,080
that took place in june

942
00:33:38,080 --> 00:33:39,519
and finally

943
00:33:39,519 --> 00:33:41,200
as network defenders we need to think

944
00:33:41,200 --> 00:33:43,039
about how we train our employees to

945
00:33:43,039 --> 00:33:46,080
notice and re-support threats outside of

946
00:33:46,080 --> 00:33:49,039
our control so in the case of itg18 and

947
00:33:49,039 --> 00:33:50,880
many other threat groups personal

948
00:33:50,880 --> 00:33:53,840
resources are targeted and our employees

949
00:33:53,840 --> 00:33:55,760
personal computing habits

950
00:33:55,760 --> 00:33:59,120
can impact the organizational security

951
00:33:59,120 --> 00:34:02,399
of our company so if we think back to

952
00:34:02,399 --> 00:34:04,240
all the information that richard covered

953
00:34:04,240 --> 00:34:06,320
that was stolen from one of the victims

954
00:34:06,320 --> 00:34:08,320
where they were going on vacation voice

955
00:34:08,320 --> 00:34:10,639
recordings

956
00:34:10,639 --> 00:34:12,719
conversations with other people that

957
00:34:12,719 --> 00:34:15,359
type of information is ripe for future

958
00:34:15,359 --> 00:34:19,199
social engineering operations

959
00:34:19,520 --> 00:34:20,639
anyway

960
00:34:20,639 --> 00:34:23,280
on behalf of richard and i uh we thank

961
00:34:23,280 --> 00:34:25,520
you guys so much for your time today and

962
00:34:25,520 --> 00:34:29,119
hope you learned a couple things

