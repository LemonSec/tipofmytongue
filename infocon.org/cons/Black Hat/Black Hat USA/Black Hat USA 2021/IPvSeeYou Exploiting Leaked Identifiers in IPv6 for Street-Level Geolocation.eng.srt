1
00:00:01,130 --> 00:00:14,690
[Music]

2
00:00:16,160 --> 00:00:17,920
so hello thanks for joining our

3
00:00:17,920 --> 00:00:19,439
presentation today we're going to talk

4
00:00:19,439 --> 00:00:21,680
about ipvc u

5
00:00:21,680 --> 00:00:23,199
where we're actually going to exploit

6
00:00:23,199 --> 00:00:26,000
some leaked identifiers in ipv6 and use

7
00:00:26,000 --> 00:00:28,480
that for street level geolocation

8
00:00:28,480 --> 00:00:30,720
my name is rob beverly and with me is my

9
00:00:30,720 --> 00:00:33,360
co-author eric rye

10
00:00:33,360 --> 00:00:34,960
so in this talk

11
00:00:34,960 --> 00:00:36,800
i'd like to first start by giving an

12
00:00:36,800 --> 00:00:39,280
overview of our work and then

13
00:00:39,280 --> 00:00:41,120
move on to presenting some background

14
00:00:41,120 --> 00:00:43,360
make sure everyone has the right context

15
00:00:43,360 --> 00:00:45,600
for understanding all of the different

16
00:00:45,600 --> 00:00:47,600
techniques and tools that we actually

17
00:00:47,600 --> 00:00:48,559
used

18
00:00:48,559 --> 00:00:49,760
then eric is going to give a

19
00:00:49,760 --> 00:00:52,719
presentation on ipvc you he's going to

20
00:00:52,719 --> 00:00:55,120
talk about the tool itself give a demo

21
00:00:55,120 --> 00:00:56,879
of the tool then we'll talk about some

22
00:00:56,879 --> 00:00:59,520
conclusions and take any questions

23
00:00:59,520 --> 00:01:02,719
so let's move right into the overview

24
00:01:02,719 --> 00:01:06,159
ipvc you revolves around home routers

25
00:01:06,159 --> 00:01:08,159
and home routers are interesting for

26
00:01:08,159 --> 00:01:10,960
instance do you have ipv6 at home many

27
00:01:10,960 --> 00:01:12,960
people think they do but may not even

28
00:01:12,960 --> 00:01:13,840
know

29
00:01:13,840 --> 00:01:15,759
also many people don't know how their

30
00:01:15,759 --> 00:01:17,680
router is configured they may not have

31
00:01:17,680 --> 00:01:19,520
ever touched it in the entire time it's

32
00:01:19,520 --> 00:01:21,520
been installed we certainly didn't

33
00:01:21,520 --> 00:01:23,040
understand the exact way it was

34
00:01:23,040 --> 00:01:24,240
configured

35
00:01:24,240 --> 00:01:26,960
and last you might be surprised about

36
00:01:26,960 --> 00:01:29,040
what your router actually reveals about

37
00:01:29,040 --> 00:01:31,840
you through ipv6

38
00:01:31,840 --> 00:01:35,119
so as an overview what is ipvc you in a

39
00:01:35,119 --> 00:01:36,159
nutshell

40
00:01:36,159 --> 00:01:38,720
so it turns out that routers primarily

41
00:01:38,720 --> 00:01:42,079
residential low cost routers that are

42
00:01:42,079 --> 00:01:44,960
deployed in the wild use a form of

43
00:01:44,960 --> 00:01:47,600
legacy ipv6 addressing which i'll talk

44
00:01:47,600 --> 00:01:48,799
about later

45
00:01:48,799 --> 00:01:51,119
and it turns out that anyone meaning

46
00:01:51,119 --> 00:01:53,600
anyone who's able to send a ping six or

47
00:01:53,600 --> 00:01:56,079
a trace route six can actually find

48
00:01:56,079 --> 00:01:59,439
these routers geophysical geolocation

49
00:01:59,439 --> 00:02:02,399
and do so with street level precision so

50
00:02:02,399 --> 00:02:04,560
for instance a residential subscriber's

51
00:02:04,560 --> 00:02:07,280
home so on this map i've

52
00:02:07,280 --> 00:02:11,200
displayed a pin that has a 64 ipv6

53
00:02:11,200 --> 00:02:13,360
prefix that's been assigned to a

54
00:02:13,360 --> 00:02:15,520
particular residential customer and we

55
00:02:15,520 --> 00:02:17,520
can actually geolocate down to the

56
00:02:17,520 --> 00:02:20,160
street and even house where that actual

57
00:02:20,160 --> 00:02:23,360
prefix is located

58
00:02:23,360 --> 00:02:25,599
so our contributions what did we do in

59
00:02:25,599 --> 00:02:27,840
this work so the first thing that we did

60
00:02:27,840 --> 00:02:30,239
is we developed a technique to find

61
00:02:30,239 --> 00:02:32,480
residential routers this is really a

62
00:02:32,480 --> 00:02:34,560
needle and a haystack type of problem

63
00:02:34,560 --> 00:02:37,120
given the massive size of the ipv6

64
00:02:37,120 --> 00:02:39,920
address space so we developed a

65
00:02:39,920 --> 00:02:41,440
large-scale high-speed active

66
00:02:41,440 --> 00:02:43,920
measurement campaign to actually find

67
00:02:43,920 --> 00:02:46,560
more than 60 million residential routers

68
00:02:46,560 --> 00:02:48,560
in the wild and these 60 million

69
00:02:48,560 --> 00:02:50,879
residential routers actually reveal

70
00:02:50,879 --> 00:02:52,879
their hardware mac address in a way that

71
00:02:52,879 --> 00:02:55,599
i'll talk about in a bit

72
00:02:55,599 --> 00:02:56,560
next

73
00:02:56,560 --> 00:02:57,840
we gathered

74
00:02:57,840 --> 00:03:00,120
around 450 million

75
00:03:00,120 --> 00:03:02,080
bssid

76
00:03:02,080 --> 00:03:05,360
these are the mac addresses of the wi-fi

77
00:03:05,360 --> 00:03:09,040
bss ids that map to geolocations through

78
00:03:09,040 --> 00:03:11,599
various wi-fi geolocation databases such

79
00:03:11,599 --> 00:03:14,720
as war driving databases

80
00:03:14,720 --> 00:03:17,360
we then developed a technique to infer

81
00:03:17,360 --> 00:03:20,000
the mapping between a device's wan the

82
00:03:20,000 --> 00:03:22,800
wide area mac address and that same

83
00:03:22,800 --> 00:03:27,680
device's wi-fi bssid mac address

84
00:03:27,680 --> 00:03:29,599
and then we performed a large-scale data

85
00:03:29,599 --> 00:03:32,159
fusion to actually merge these two and

86
00:03:32,159 --> 00:03:37,519
geolocate ipv6 prefixes of home routers

87
00:03:37,920 --> 00:03:39,920
so let's get some background and a bit

88
00:03:39,920 --> 00:03:42,480
of an ipv6 primer

89
00:03:42,480 --> 00:03:44,879
so we all know that ipv6 addresses are

90
00:03:44,879 --> 00:03:47,440
big they're 128 bits and they're

91
00:03:47,440 --> 00:03:50,080
represented as hex as i've shown in this

92
00:03:50,080 --> 00:03:51,920
particular example

93
00:03:51,920 --> 00:03:53,599
there's some particular properties of

94
00:03:53,599 --> 00:03:55,519
ipv6 that are relevant

95
00:03:55,519 --> 00:03:57,439
for instance there's a huge address

96
00:03:57,439 --> 00:03:59,599
space and not only is the huge is the

97
00:03:59,599 --> 00:04:02,239
address space huge it's very sparse

98
00:04:02,239 --> 00:04:04,480
there's many portions of the ip address

99
00:04:04,480 --> 00:04:06,400
space there there's no host there

100
00:04:06,400 --> 00:04:08,720
there's no prefix assigned so what this

101
00:04:08,720 --> 00:04:10,720
implies is that there's no way to

102
00:04:10,720 --> 00:04:14,159
actively probe the entire ipv6 internet

103
00:04:14,159 --> 00:04:16,478
like we do sometimes with tools such as

104
00:04:16,478 --> 00:04:18,560
zmap

105
00:04:18,560 --> 00:04:19,519
further

106
00:04:19,519 --> 00:04:21,759
even residential customers like home

107
00:04:21,759 --> 00:04:24,240
customers are typically allocated a

108
00:04:24,240 --> 00:04:27,680
prefix of size 64. that's the smallest

109
00:04:27,680 --> 00:04:28,479
prefix

110
00:04:28,479 --> 00:04:30,639
so this is actually two to the 64

111
00:04:30,639 --> 00:04:33,440
addresses that's a lot of addresses and

112
00:04:33,440 --> 00:04:35,360
the implication here is that there's no

113
00:04:35,360 --> 00:04:37,120
nat there's no network address

114
00:04:37,120 --> 00:04:40,639
translation which is common in ipv4 and

115
00:04:40,639 --> 00:04:42,639
so the underlying implication of all

116
00:04:42,639 --> 00:04:44,000
this that you need to have in the back

117
00:04:44,000 --> 00:04:46,720
of your mind is that ipv6 is deployed

118
00:04:46,720 --> 00:04:48,639
somewhat fundamentally different than

119
00:04:48,639 --> 00:04:51,120
ipv4

120
00:04:51,120 --> 00:04:54,000
as an example if we consider the home

121
00:04:54,000 --> 00:04:56,000
router or what we often will call in

122
00:04:56,000 --> 00:04:58,720
this talk the cpe or customer premises

123
00:04:58,720 --> 00:05:01,120
router that router is actually a routed

124
00:05:01,120 --> 00:05:03,520
hop so in this picture you'll see the

125
00:05:03,520 --> 00:05:05,600
provider router has a connection to the

126
00:05:05,600 --> 00:05:08,160
cpe router for instance in the home and

127
00:05:08,160 --> 00:05:10,560
there's an actual point-to-point subnet

128
00:05:10,560 --> 00:05:13,120
between the provider router and that cpe

129
00:05:13,120 --> 00:05:14,000
router

130
00:05:14,000 --> 00:05:16,400
then there's a separate subnet on the

131
00:05:16,400 --> 00:05:18,960
other side of that cp router

132
00:05:18,960 --> 00:05:20,960
that's the customer subnet that all of

133
00:05:20,960 --> 00:05:23,759
the machines in the residential home for

134
00:05:23,759 --> 00:05:26,320
instance get addresses out of that

135
00:05:26,320 --> 00:05:28,800
particular subnet

136
00:05:28,800 --> 00:05:30,240
we call this

137
00:05:30,240 --> 00:05:31,360
this

138
00:05:31,360 --> 00:05:33,520
link between the provider router and the

139
00:05:33,520 --> 00:05:38,800
cpe router the ipv6 periphery

140
00:05:38,800 --> 00:05:41,120
as i mentioned the smallest allocation

141
00:05:41,120 --> 00:05:44,479
in ipv6 to eg to a residential customer

142
00:05:44,479 --> 00:05:47,360
is a slash 64. and you might say what's

143
00:05:47,360 --> 00:05:50,000
a home to do with two to the 64

144
00:05:50,000 --> 00:05:52,240
addresses that's a lot of addresses but

145
00:05:52,240 --> 00:05:54,720
there's also a fundamental problem every

146
00:05:54,720 --> 00:05:57,120
device needs to have a globally unique

147
00:05:57,120 --> 00:05:59,680
ipv6 address

148
00:05:59,680 --> 00:06:01,759
so how do devices choose an address

149
00:06:01,759 --> 00:06:04,800
within this 64. well there's a couple of

150
00:06:04,800 --> 00:06:07,120
ways that this is done but the ways that

151
00:06:07,120 --> 00:06:09,520
i want to present today involve two

152
00:06:09,520 --> 00:06:11,680
primary techniques the first is privacy

153
00:06:11,680 --> 00:06:14,800
extensions and the second is eui 64 or

154
00:06:14,800 --> 00:06:16,880
slack

155
00:06:16,880 --> 00:06:17,600
so

156
00:06:17,600 --> 00:06:20,240
today what typically happens are privacy

157
00:06:20,240 --> 00:06:22,960
extensions where the lower 64 bits are

158
00:06:22,960 --> 00:06:25,360
random and short-lived however there's a

159
00:06:25,360 --> 00:06:28,160
form of legacy addressing where the

160
00:06:28,160 --> 00:06:31,199
lower 64 bits take an encoding of the

161
00:06:31,199 --> 00:06:33,520
hardware mac address and i'll talk about

162
00:06:33,520 --> 00:06:36,080
that next

163
00:06:36,080 --> 00:06:38,880
so to understand eui 64 addresses and

164
00:06:38,880 --> 00:06:41,039
also all of our work you have to

165
00:06:41,039 --> 00:06:43,919
understand mac addresses or layer 2

166
00:06:43,919 --> 00:06:46,800
hardware ieee mac addresses and as we

167
00:06:46,800 --> 00:06:49,440
all remember mac addresses are six bytes

168
00:06:49,440 --> 00:06:51,840
and typically written in hex

169
00:06:51,840 --> 00:06:55,440
the upper three the high three um

170
00:06:55,440 --> 00:06:57,919
bytes of a mac address are something we

171
00:06:57,919 --> 00:07:00,240
call the oui or the organizational

172
00:07:00,240 --> 00:07:02,240
unique identifier and this is the

173
00:07:02,240 --> 00:07:04,479
hardware manufacturer that owns that

174
00:07:04,479 --> 00:07:06,960
block so this is the entity for instance

175
00:07:06,960 --> 00:07:09,599
that paid some money to the ieee to

176
00:07:09,599 --> 00:07:13,440
reserve a chunk of mac addresses

177
00:07:13,440 --> 00:07:15,199
so an ipv6

178
00:07:15,199 --> 00:07:19,280
64 address is formed as follows it takes

179
00:07:19,280 --> 00:07:21,919
this six byte mac address splits it in

180
00:07:21,919 --> 00:07:25,199
two and then in between it inserts

181
00:07:25,199 --> 00:07:28,240
two bytes and fffe

182
00:07:28,240 --> 00:07:30,000
it then inverts the seventh most

183
00:07:30,000 --> 00:07:33,199
significant bit so in this uh example

184
00:07:33,199 --> 00:07:35,360
mac address that i have above zero zero

185
00:07:35,360 --> 00:07:37,199
one one two two three three four four

186
00:07:37,199 --> 00:07:38,479
five five

187
00:07:38,479 --> 00:07:40,720
that would then if a host had that

188
00:07:40,720 --> 00:07:43,440
address and was forming a v6 address it

189
00:07:43,440 --> 00:07:46,560
would take its assigned ipv6 prefix and

190
00:07:46,560 --> 00:07:48,800
then for the lower 64 bits it would use

191
00:07:48,800 --> 00:07:51,759
this eui 64 scheme that turns out in

192
00:07:51,759 --> 00:07:54,479
this example to be zero two one one two

193
00:07:54,479 --> 00:07:55,960
two then the

194
00:07:55,960 --> 00:07:59,840
fffe33 so on and so forth

195
00:08:01,759 --> 00:08:02,720
so

196
00:08:02,720 --> 00:08:05,919
what are the advantages of eui 64

197
00:08:05,919 --> 00:08:07,840
addresses well they're simple to

198
00:08:07,840 --> 00:08:10,160
implement they guarantee at least in

199
00:08:10,160 --> 00:08:13,280
theory unique ipv6 addresses and there's

200
00:08:13,280 --> 00:08:15,360
no need for some of this other

201
00:08:15,360 --> 00:08:17,360
machinery such as duplicate address

202
00:08:17,360 --> 00:08:19,039
detection which can sometimes make

203
00:08:19,039 --> 00:08:21,360
things faster but there's some strong

204
00:08:21,360 --> 00:08:23,680
disadvantages for instance it exposes

205
00:08:23,680 --> 00:08:26,240
the layer 2 or the ethernet address up a

206
00:08:26,240 --> 00:08:29,120
layer into layer 3 which can reveal

207
00:08:29,120 --> 00:08:31,120
things about the device itself for

208
00:08:31,120 --> 00:08:33,919
instance the hardware the vendor etc

209
00:08:33,919 --> 00:08:36,880
also this is a static address it doesn't

210
00:08:36,880 --> 00:08:38,799
change because your mac address doesn't

211
00:08:38,799 --> 00:08:41,120
change so even if the device connects to

212
00:08:41,120 --> 00:08:43,519
a new network it's going to use the same

213
00:08:43,519 --> 00:08:47,440
eui 64 lower 64 bits and this globally

214
00:08:47,440 --> 00:08:48,640
uniqueness

215
00:08:48,640 --> 00:08:51,279
of the eui 64 is going to permit

216
00:08:51,279 --> 00:08:52,959
tracking

217
00:08:52,959 --> 00:08:54,959
so as a result of this

218
00:08:54,959 --> 00:08:57,519
uh well-recognized sort of weakness of

219
00:08:57,519 --> 00:09:02,160
eu i-64 rfc 3041 was first back in uh

220
00:09:02,160 --> 00:09:04,560
you know 20 years ago to define

221
00:09:04,560 --> 00:09:06,320
something called privacy extensions

222
00:09:06,320 --> 00:09:08,640
where it generates a short-lived random

223
00:09:08,640 --> 00:09:10,480
interface identifier

224
00:09:10,480 --> 00:09:12,240
it does perform duplicate address

225
00:09:12,240 --> 00:09:14,720
detection and it regenerates this

226
00:09:14,720 --> 00:09:17,519
address often so a single host may get

227
00:09:17,519 --> 00:09:18,399
many

228
00:09:18,399 --> 00:09:21,519
addresses over the course of a day

229
00:09:21,519 --> 00:09:25,600
for example here's uh this uh this upper

230
00:09:25,600 --> 00:09:28,399
64 prefix that if you look at the lower

231
00:09:28,399 --> 00:09:31,040
64 bits are seemingly random

232
00:09:31,040 --> 00:09:33,519
so the privacy implications of these eui

233
00:09:33,519 --> 00:09:36,160
64 addresses have been known for 20 plus

234
00:09:36,160 --> 00:09:38,399
years right this rfc has been around so

235
00:09:38,399 --> 00:09:40,399
you might say well of course all devices

236
00:09:40,399 --> 00:09:42,959
use privacy extensions right

237
00:09:42,959 --> 00:09:45,040
um and we're going to see exactly if

238
00:09:45,040 --> 00:09:48,000
that's true or not

239
00:09:48,000 --> 00:09:50,080
so that's some background now let me

240
00:09:50,080 --> 00:09:52,560
just uh give you a high level overview

241
00:09:52,560 --> 00:09:54,480
of the impact of this work or what

242
00:09:54,480 --> 00:09:55,839
you're going to see

243
00:09:55,839 --> 00:09:58,800
so in ipvc you what we did is we've

244
00:09:58,800 --> 00:10:01,200
developed a remote unprivileged attack

245
00:10:01,200 --> 00:10:03,920
on privacy and this attack works even

246
00:10:03,920 --> 00:10:07,519
when nhos utilize ietf's standardized

247
00:10:07,519 --> 00:10:10,399
ipv6 privacy extensions so i've been

248
00:10:10,399 --> 00:10:12,720
talking about how

249
00:10:12,720 --> 00:10:15,519
the ietf has adopted privacy extensions

250
00:10:15,519 --> 00:10:17,279
but the fact that the routers that these

251
00:10:17,279 --> 00:10:19,360
hosts are connected to actually

252
00:10:19,360 --> 00:10:21,600
compromises their privacy and their

253
00:10:21,600 --> 00:10:23,680
geolocation privacy

254
00:10:23,680 --> 00:10:26,480
we've developed a tool so ipvcu is also

255
00:10:26,480 --> 00:10:29,600
a tool that can map an ipv6 router

256
00:10:29,600 --> 00:10:31,440
address to a precise

257
00:10:31,440 --> 00:10:34,320
geolocation and we've done this at scale

258
00:10:34,320 --> 00:10:36,320
across the entire internet so we've done

259
00:10:36,320 --> 00:10:38,800
a precision geolocation and we were able

260
00:10:38,800 --> 00:10:41,360
to geolocate approximately 12 million

261
00:10:41,360 --> 00:10:43,920
residential ipv6 routers all around the

262
00:10:43,920 --> 00:10:47,440
world and the ipv6 prefixes that are

263
00:10:47,440 --> 00:10:50,480
allocated to those routers

264
00:10:50,480 --> 00:10:52,720
then we extended this idea to perform

265
00:10:52,720 --> 00:10:55,440
geolocation of the providers last hop

266
00:10:55,440 --> 00:10:57,760
infrastructure and the really cool thing

267
00:10:57,760 --> 00:11:01,600
about this is now we can geolocate ipv6

268
00:11:01,600 --> 00:11:04,640
routers that do use privacy extensions

269
00:11:04,640 --> 00:11:07,040
uh simply by associating those that

270
00:11:07,040 --> 00:11:09,200
don't do privacy extensions with those

271
00:11:09,200 --> 00:11:11,279
that do privacy extensions

272
00:11:11,279 --> 00:11:14,079
basically implying that if any single

273
00:11:14,079 --> 00:11:17,839
router on a provider's network is using

274
00:11:17,839 --> 00:11:20,480
these eui 64 addresses it compromises

275
00:11:20,480 --> 00:11:23,120
the geolocation privacy of all of the

276
00:11:23,120 --> 00:11:24,720
other routers

277
00:11:24,720 --> 00:11:26,160
and then finally we engaged in

278
00:11:26,160 --> 00:11:28,480
responsible disclosure and vendor

279
00:11:28,480 --> 00:11:30,560
remediation

280
00:11:30,560 --> 00:11:32,240
so with that i'm going to hand it over

281
00:11:32,240 --> 00:11:33,760
to my colleague eric who's going to

282
00:11:33,760 --> 00:11:36,880
describe ipvc you in more detail

283
00:11:36,880 --> 00:11:38,640
hi my name is eric rye i'm also with the

284
00:11:38,640 --> 00:11:40,000
c-man lab

285
00:11:40,000 --> 00:11:41,360
i'll be building on some of the

286
00:11:41,360 --> 00:11:43,600
background and ipv6 preliminaries that

287
00:11:43,600 --> 00:11:45,760
rob discussed during his section in

288
00:11:45,760 --> 00:11:47,279
order to talk about our project which we

289
00:11:47,279 --> 00:11:49,680
call ipvcu

290
00:11:49,680 --> 00:11:51,600
this is a high-level roadmap for what

291
00:11:51,600 --> 00:11:54,720
ipvcu is at its heart ipvc-u is a

292
00:11:54,720 --> 00:11:56,800
large-scale data fusion attack that

293
00:11:56,800 --> 00:12:00,399
combines uh eui 64 ipv6 addresses with

294
00:12:00,399 --> 00:12:02,320
wi-fi geolocation data

295
00:12:02,320 --> 00:12:04,079
via an algorithm that we developed in

296
00:12:04,079 --> 00:12:07,120
order to produce ipv6 street level

297
00:12:07,120 --> 00:12:09,519
geolocations for a particular subset of

298
00:12:09,519 --> 00:12:11,120
ipv6

299
00:12:11,120 --> 00:12:13,040
cpe or customer premises equipment

300
00:12:13,040 --> 00:12:14,880
routers

301
00:12:14,880 --> 00:12:16,560
i just want to touch briefly on ethical

302
00:12:16,560 --> 00:12:18,480
considerations because

303
00:12:18,480 --> 00:12:20,320
in this study we are attempting to

304
00:12:20,320 --> 00:12:21,760
geolocate with a high degree of

305
00:12:21,760 --> 00:12:24,880
precision some ipv6 addresses

306
00:12:24,880 --> 00:12:26,720
we felt it necessary to consult with an

307
00:12:26,720 --> 00:12:28,560
institutional review or irb before

308
00:12:28,560 --> 00:12:29,760
proceeding

309
00:12:29,760 --> 00:12:31,600
we agreed to follow all best practices

310
00:12:31,600 --> 00:12:33,839
as they pertain to minimizing any

311
00:12:33,839 --> 00:12:35,600
potential for harm to follow any

312
00:12:35,600 --> 00:12:37,600
individuals during this study

313
00:12:37,600 --> 00:12:40,079
for instance we we never attempt to

314
00:12:40,079 --> 00:12:43,040
identify any of individuals that uh

315
00:12:43,040 --> 00:12:45,200
that map to the mac addresses or or ip

316
00:12:45,200 --> 00:12:47,519
addresses that we discover uh we encrypt

317
00:12:47,519 --> 00:12:50,320
all of the data that we have at rest and

318
00:12:50,320 --> 00:12:52,480
we publish only the aggregate data

319
00:12:52,480 --> 00:12:54,240
analysis rather than the underlying data

320
00:12:54,240 --> 00:12:55,200
itself

321
00:12:55,200 --> 00:12:57,200
um and again it's it's worth remembering

322
00:12:57,200 --> 00:12:58,880
that our goal here is ultimately to

323
00:12:58,880 --> 00:13:00,480
improve privacy protections by

324
00:13:00,480 --> 00:13:02,480
highlighting this location and privacy

325
00:13:02,480 --> 00:13:04,839
vulnerability that ipvcu

326
00:13:04,839 --> 00:13:07,279
exposes okay so at this point we'll talk

327
00:13:07,279 --> 00:13:10,000
about on each component of ipvcu

328
00:13:10,000 --> 00:13:11,279
in turn and the first component we

329
00:13:11,279 --> 00:13:13,760
should talk about is uh our corpus of

330
00:13:13,760 --> 00:13:16,720
ey64 ipv6 addresses

331
00:13:16,720 --> 00:13:19,120
so it's worth recalling that an ipv6

332
00:13:19,120 --> 00:13:21,920
there's no nat as opposed to ipv4 um and

333
00:13:21,920 --> 00:13:25,440
inhomed your your lan uh prefix that's

334
00:13:25,440 --> 00:13:27,600
attached to your gateway router is a

335
00:13:27,600 --> 00:13:29,760
routable prefix it's globally uh

336
00:13:29,760 --> 00:13:31,279
globally addressed

337
00:13:31,279 --> 00:13:34,240
and so in ipv6 um as opposed to ipv4 we

338
00:13:34,240 --> 00:13:37,200
can do things like send trace routes to

339
00:13:37,200 --> 00:13:39,440
an address that exists inside of your

340
00:13:39,440 --> 00:13:41,519
home gateway from across the internet

341
00:13:41,519 --> 00:13:44,079
for instance because in ipv4 typically

342
00:13:44,079 --> 00:13:45,839
your home

343
00:13:45,839 --> 00:13:48,560
lan is a rfc 1918 network that's that's

344
00:13:48,560 --> 00:13:51,680
not possible in ipv4 but it is an ipv6

345
00:13:51,680 --> 00:13:53,920
another key observation in ipv6 base is

346
00:13:53,920 --> 00:13:54,800
that

347
00:13:54,800 --> 00:13:57,600
typically the smallest ipv6 subnet that

348
00:13:57,600 --> 00:13:59,120
you can be allocated by your provider is

349
00:13:59,120 --> 00:14:01,519
a slash 64. and the reason that that is

350
00:14:01,519 --> 00:14:04,000
is because in ipv6 there's no real

351
00:14:04,000 --> 00:14:06,639
reason to manage the ip space

352
00:14:06,639 --> 00:14:08,399
in the same way that there is an ipv4

353
00:14:08,399 --> 00:14:10,320
because it's so large

354
00:14:10,320 --> 00:14:11,920
and so typically devices are are

355
00:14:11,920 --> 00:14:13,199
permitted to

356
00:14:13,199 --> 00:14:15,839
generate their own ipv6 address

357
00:14:15,839 --> 00:14:17,360
through a process known as stateless

358
00:14:17,360 --> 00:14:19,600
address auto configuration or slack and

359
00:14:19,600 --> 00:14:21,519
slack requires that the lower 64 bits of

360
00:14:21,519 --> 00:14:23,600
the address be generated by the device

361
00:14:23,600 --> 00:14:25,199
and so it's not possible to address

362
00:14:25,199 --> 00:14:27,519
anything or to allocate anything smaller

363
00:14:27,519 --> 00:14:31,040
than a 64 from your provider

364
00:14:31,040 --> 00:14:32,399
and so combining these two um

365
00:14:32,399 --> 00:14:34,880
observations uh we are able to discover

366
00:14:34,880 --> 00:14:37,760
cpe routers by um trace routing to a

367
00:14:37,760 --> 00:14:40,399
random target address and uh each slash

368
00:14:40,399 --> 00:14:42,480
64 in a provider's network

369
00:14:42,480 --> 00:14:45,120
um and so while it's it's very unlikely

370
00:14:45,120 --> 00:14:47,040
that the target address will exist

371
00:14:47,040 --> 00:14:50,320
because we're uh because the uh network

372
00:14:50,320 --> 00:14:52,399
inside of a customer's home or business

373
00:14:52,399 --> 00:14:54,639
is at least a slash 64.

374
00:14:54,639 --> 00:14:57,680
um and we're randomly guessing the lower

375
00:14:57,680 --> 00:14:59,920
64 bits of that address

376
00:14:59,920 --> 00:15:01,920
we're not actually attempting to to hit

377
00:15:01,920 --> 00:15:03,680
a device that's inside of the customer

378
00:15:03,680 --> 00:15:05,519
subnet instead we're hoping that a trace

379
00:15:05,519 --> 00:15:07,279
route

380
00:15:07,279 --> 00:15:08,800
one of the packets from our trace route

381
00:15:08,800 --> 00:15:11,040
reaches the cpe router and its hop limit

382
00:15:11,040 --> 00:15:13,839
expires which will cause the cpe router

383
00:15:13,839 --> 00:15:16,639
to uh send an icmp v6 time exceeded

384
00:15:16,639 --> 00:15:18,480
message which is essentially the analog

385
00:15:18,480 --> 00:15:22,320
of an icmp ttl expired message in ipvb

386
00:15:22,320 --> 00:15:24,160
ipv4

387
00:15:24,160 --> 00:15:26,399
and hopefully in the best case for us

388
00:15:26,399 --> 00:15:28,800
uh that cpe router will be responding

389
00:15:28,800 --> 00:15:30,880
from a source address that's an eui 64

390
00:15:30,880 --> 00:15:32,320
address

391
00:15:32,320 --> 00:15:33,199
um

392
00:15:33,199 --> 00:15:35,519
while i i've talked through this example

393
00:15:35,519 --> 00:15:37,759
um using traceroute in practice we

394
00:15:37,759 --> 00:15:39,680
actually use yarp which is essentially a

395
00:15:39,680 --> 00:15:42,320
stateless trace route that rob developed

396
00:15:42,320 --> 00:15:44,160
several years ago

397
00:15:44,160 --> 00:15:45,839
and over the last two years as part of

398
00:15:45,839 --> 00:15:47,440
several different

399
00:15:47,440 --> 00:15:49,360
large-scale experiments we've discovered

400
00:15:49,360 --> 00:15:51,680
hundreds of millions of eui-64 ipv6

401
00:15:51,680 --> 00:15:54,399
addresses and from those ipv6 addresses

402
00:15:54,399 --> 00:15:56,800
uh we've derived more than 60 million

403
00:15:56,800 --> 00:15:58,800
distinct mac addresses that correspond

404
00:15:58,800 --> 00:16:01,040
to the wan interface of mostly cpe

405
00:16:01,040 --> 00:16:03,040
routers

406
00:16:03,040 --> 00:16:05,360
the other data source that we use in

407
00:16:05,360 --> 00:16:08,639
ipvcu is wi-fi geolocation

408
00:16:08,639 --> 00:16:10,720
databases data sources

409
00:16:10,720 --> 00:16:11,839
throughout this presentation i'll be

410
00:16:11,839 --> 00:16:14,399
using the the term bssid or bc which

411
00:16:14,399 --> 00:16:16,800
stands for basic service set identifier

412
00:16:16,800 --> 00:16:19,279
frequently all i mean by that is the the

413
00:16:19,279 --> 00:16:21,680
mac address of the wi-fi interface on a

414
00:16:21,680 --> 00:16:23,920
wi-fi access point

415
00:16:23,920 --> 00:16:27,040
so anyway for ipvc we amass a large

416
00:16:27,040 --> 00:16:30,560
corpus of bssid to geolocation pairs

417
00:16:30,560 --> 00:16:32,480
both by leveraging open source

418
00:16:32,480 --> 00:16:35,040
geolocation databases for instance open

419
00:16:35,040 --> 00:16:38,079
bmap and openwi-fi.su that are war

420
00:16:38,079 --> 00:16:39,680
driving databases that are provided to

421
00:16:39,680 --> 00:16:40,880
anyone on the internet who would like to

422
00:16:40,880 --> 00:16:42,079
download them

423
00:16:42,079 --> 00:16:44,880
and in addition we generate more bssid

424
00:16:44,880 --> 00:16:47,040
geolocation pairs by querying

425
00:16:47,040 --> 00:16:49,279
geolocation apis

426
00:16:49,279 --> 00:16:50,639
most of you are probably familiar with

427
00:16:50,639 --> 00:16:52,000
weigel.net

428
00:16:52,000 --> 00:16:55,360
apple also has a location services api

429
00:16:55,360 --> 00:16:57,759
for which you can you can query vss ids

430
00:16:57,759 --> 00:17:00,320
and if the geolo if the bss id is known

431
00:17:00,320 --> 00:17:01,680
to that api it will return the

432
00:17:01,680 --> 00:17:03,440
geolocation

433
00:17:03,440 --> 00:17:05,520
so through combining all of these

434
00:17:05,520 --> 00:17:07,760
sources of data we amass a corpus of of

435
00:17:07,760 --> 00:17:09,919
slightly less than half of a billion

436
00:17:09,919 --> 00:17:14,240
bssids geolocation pairs

437
00:17:14,240 --> 00:17:15,679
so on the one hand we have this large

438
00:17:15,679 --> 00:17:18,720
corpus of bssid geolocation data and on

439
00:17:18,720 --> 00:17:20,799
the other hand we have a

440
00:17:20,799 --> 00:17:22,640
large number of wan mac addresses that

441
00:17:22,640 --> 00:17:24,880
we've derived from active probing by

442
00:17:24,880 --> 00:17:28,240
discovering eui 64 ipv6 addresses and so

443
00:17:28,240 --> 00:17:30,000
the question then becomes

444
00:17:30,000 --> 00:17:32,799
you know how can we combine how can we

445
00:17:32,799 --> 00:17:36,080
resolve uh these two separate data

446
00:17:36,080 --> 00:17:38,320
sources to the same device in other

447
00:17:38,320 --> 00:17:40,480
words is it possible to match a wan mac

448
00:17:40,480 --> 00:17:42,960
address to a bssid because if we're able

449
00:17:42,960 --> 00:17:44,320
to do that

450
00:17:44,320 --> 00:17:46,720
then we're able to geolocate an ip the

451
00:17:46,720 --> 00:17:49,039
ip address that that wan mac address

452
00:17:49,039 --> 00:17:51,360
came from to the geolocation that's

453
00:17:51,360 --> 00:17:53,280
associated with that bssid and so that's

454
00:17:53,280 --> 00:17:54,720
the fundamental question that our

455
00:17:54,720 --> 00:17:58,240
algorithm is attempting to address

456
00:17:58,240 --> 00:17:59,760
so the mental model that we started out

457
00:17:59,760 --> 00:18:01,280
with and the one that you should have um

458
00:18:01,280 --> 00:18:04,480
in your head is is the following uh many

459
00:18:04,480 --> 00:18:06,960
particularly low-cost cpe devices that

460
00:18:06,960 --> 00:18:08,000
are

461
00:18:08,000 --> 00:18:10,160
provided by uh

462
00:18:10,160 --> 00:18:11,440
internet service providers to their

463
00:18:11,440 --> 00:18:13,440
customers that are either for free or at

464
00:18:13,440 --> 00:18:15,360
a low cost rental cost

465
00:18:15,360 --> 00:18:17,600
are all in one devices that is they're a

466
00:18:17,600 --> 00:18:19,280
cable modem they're a router they're a

467
00:18:19,280 --> 00:18:21,120
switch and they're a wireless access

468
00:18:21,120 --> 00:18:23,520
point all in the same physical box

469
00:18:23,520 --> 00:18:26,160
and many of these devices are systematic

470
00:18:26,160 --> 00:18:28,960
chip designs wherein all of the radios

471
00:18:28,960 --> 00:18:31,200
and interfaces are are designed by say

472
00:18:31,200 --> 00:18:32,799
the same company

473
00:18:32,799 --> 00:18:34,240
because each one of these interfaces

474
00:18:34,240 --> 00:18:36,160
gets its own mac address often times

475
00:18:36,160 --> 00:18:38,559
these mac addresses are related

476
00:18:38,559 --> 00:18:40,400
for example in this figure on the bottom

477
00:18:40,400 --> 00:18:42,559
right that's uh just an example but

478
00:18:42,559 --> 00:18:44,320
often represents reality for many of

479
00:18:44,320 --> 00:18:46,240
these cpe devices each one of these

480
00:18:46,240 --> 00:18:48,880
interfaces is sequentially addressed

481
00:18:48,880 --> 00:18:50,799
that is the two bssids are one apart

482
00:18:50,799 --> 00:18:53,039
from each other the wan mac address is

483
00:18:53,039 --> 00:18:55,200
one up from the five gigahertz bssid and

484
00:18:55,200 --> 00:18:57,200
the lan mac addresses is one up from the

485
00:18:57,200 --> 00:18:59,200
lan mac address um and so what we're

486
00:18:59,200 --> 00:19:01,280
interested in uh are having our

487
00:19:01,280 --> 00:19:03,840
algorithm do here is discover what the

488
00:19:03,840 --> 00:19:06,799
offset between the wan mac address and a

489
00:19:06,799 --> 00:19:10,320
bss id is for a particular device so in

490
00:19:10,320 --> 00:19:12,880
this case um the wan mac address or the

491
00:19:12,880 --> 00:19:15,360
bssid is negative one from the wan mac

492
00:19:15,360 --> 00:19:17,039
address that's the offset that we would

493
00:19:17,039 --> 00:19:18,960
we would produce for um if we had one of

494
00:19:18,960 --> 00:19:20,880
these model devices that's pictured here

495
00:19:20,880 --> 00:19:23,120
in the bottom right

496
00:19:23,120 --> 00:19:26,559
um this is not always as easy uh in in

497
00:19:26,559 --> 00:19:28,320
practice as it is in theory there are

498
00:19:28,320 --> 00:19:30,640
many complicating factors um including

499
00:19:30,640 --> 00:19:32,640
some devices have you know a varying

500
00:19:32,640 --> 00:19:35,039
number of interfaces it's by no means

501
00:19:35,039 --> 00:19:36,880
guaranteed that a wireless access point

502
00:19:36,880 --> 00:19:39,200
will support both 2.4 and 5 gigahertz

503
00:19:39,200 --> 00:19:40,960
bands for example

504
00:19:40,960 --> 00:19:43,440
some newer cpe devices have bluetooth

505
00:19:43,440 --> 00:19:45,520
interfaces for example and so there's

506
00:19:45,520 --> 00:19:47,120
not one single

507
00:19:47,120 --> 00:19:49,200
offset that's going to work for every

508
00:19:49,200 --> 00:19:51,280
device in other words different devices

509
00:19:51,280 --> 00:19:52,480
are going to have different offsets

510
00:19:52,480 --> 00:19:54,080
between their way and mac address and

511
00:19:54,080 --> 00:19:56,799
their bss ids but in the best case here

512
00:19:56,799 --> 00:19:59,360
we're able to identify we're able to

513
00:19:59,360 --> 00:20:01,919
discover a wan mac address via active

514
00:20:01,919 --> 00:20:02,960
probing

515
00:20:02,960 --> 00:20:06,480
in an ey 64 ipv6 address so for example

516
00:20:06,480 --> 00:20:08,880
in this ipv6 address we have here the

517
00:20:08,880 --> 00:20:11,039
wan mac address is embedded

518
00:20:11,039 --> 00:20:13,679
and one or both of the bssids is

519
00:20:13,679 --> 00:20:15,679
captured in some wi-fi geolocation

520
00:20:15,679 --> 00:20:17,120
database that's the best case scenario

521
00:20:17,120 --> 00:20:19,600
for us here

522
00:20:19,600 --> 00:20:21,440
um so to sort of visually represent what

523
00:20:21,440 --> 00:20:22,720
i've been talking about over the past

524
00:20:22,720 --> 00:20:24,400
couple of slides and also

525
00:20:24,400 --> 00:20:26,159
um illuminate why this can be

526
00:20:26,159 --> 00:20:28,400
challenging uh what i'm demonstrating in

527
00:20:28,400 --> 00:20:29,919
this figure is

528
00:20:29,919 --> 00:20:31,120
uh

529
00:20:31,120 --> 00:20:32,400
the first

530
00:20:32,400 --> 00:20:35,039
is some bss ids and wan mac addresses

531
00:20:35,039 --> 00:20:37,280
the first five bytes of the mac

532
00:20:37,280 --> 00:20:39,280
addresses um that are pictured here are

533
00:20:39,280 --> 00:20:40,799
all the same and so all i'm picturing

534
00:20:40,799 --> 00:20:42,320
here on this number line is the sixth

535
00:20:42,320 --> 00:20:44,640
byte of the mac address a b represents a

536
00:20:44,640 --> 00:20:47,840
bssid whereas a w represents a wan mac

537
00:20:47,840 --> 00:20:49,039
address

538
00:20:49,039 --> 00:20:50,159
um

539
00:20:50,159 --> 00:20:51,840
so our initial attempt at a matching

540
00:20:51,840 --> 00:20:53,840
algorithm was was what i'm just what i'm

541
00:20:53,840 --> 00:20:55,679
depicting here and namely that if

542
00:20:55,679 --> 00:20:57,760
there's a bssid and a wan mac address

543
00:20:57,760 --> 00:20:59,120
that are adjacent that is they're one

544
00:20:59,120 --> 00:21:00,960
off from each other just call them the

545
00:21:00,960 --> 00:21:03,200
same device just pair them say that that

546
00:21:03,200 --> 00:21:04,400
those those two

547
00:21:04,400 --> 00:21:05,440
uh

548
00:21:05,440 --> 00:21:06,799
those two mac addresses belong to the

549
00:21:06,799 --> 00:21:09,200
same device that's the naive matching

550
00:21:09,200 --> 00:21:11,440
algorithm um this can be complicated

551
00:21:11,440 --> 00:21:13,600
because some devices have have multiple

552
00:21:13,600 --> 00:21:16,880
bssids as we're depicting here

553
00:21:16,880 --> 00:21:19,120
but for this particular oui which is the

554
00:21:19,120 --> 00:21:20,799
first three bytes of a mac address it's

555
00:21:20,799 --> 00:21:21,840
a

556
00:21:21,840 --> 00:21:23,919
a block that's assigned by an ieee to a

557
00:21:23,919 --> 00:21:25,760
device manufacturer we actually had some

558
00:21:25,760 --> 00:21:27,840
ground truth and so what i'm displaying

559
00:21:27,840 --> 00:21:29,919
here is the actual

560
00:21:29,919 --> 00:21:31,760
ground truth as it applies to a device

561
00:21:31,760 --> 00:21:34,000
within this oui so each device from this

562
00:21:34,000 --> 00:21:36,799
oui was allocated a series a sequence of

563
00:21:36,799 --> 00:21:38,640
seven mac addresses

564
00:21:38,640 --> 00:21:42,240
and the wan mac address

565
00:21:42,240 --> 00:21:45,200
is six below the bssid in other words

566
00:21:45,200 --> 00:21:48,080
the offset the bss id is an offset of

567
00:21:48,080 --> 00:21:49,760
plus six from the wan mac address for

568
00:21:49,760 --> 00:21:51,360
this particular device

569
00:21:51,360 --> 00:21:54,480
and so later if i find a mac if i find a

570
00:21:54,480 --> 00:21:56,240
wan mac address for something in this

571
00:21:56,240 --> 00:21:58,720
oui if i want to predict what the bss id

572
00:21:58,720 --> 00:22:02,240
is i would simply add 6 to it

573
00:22:02,240 --> 00:22:04,080
the end result for our algorithm is we

574
00:22:04,080 --> 00:22:08,799
produce a list of wan to bssid offsets

575
00:22:08,799 --> 00:22:11,120
on a per oui basis and then we're going

576
00:22:11,120 --> 00:22:12,799
to use those later

577
00:22:12,799 --> 00:22:16,400
in order to geolocate devices

578
00:22:17,120 --> 00:22:18,320
okay

579
00:22:18,320 --> 00:22:20,240
this is this i want to be clear that

580
00:22:20,240 --> 00:22:22,240
this methodology and our algorithm does

581
00:22:22,240 --> 00:22:24,320
not always work in 100 of the cases

582
00:22:24,320 --> 00:22:26,559
there are many limiting factors that can

583
00:22:26,559 --> 00:22:29,039
cause things to go wrong so for example

584
00:22:29,039 --> 00:22:31,919
some cpe devices don't use eui 64

585
00:22:31,919 --> 00:22:33,520
addresses at all they don't embed the

586
00:22:33,520 --> 00:22:36,159
mac address in the ipv6 address and so

587
00:22:36,159 --> 00:22:38,080
we're just not able to to attempt to

588
00:22:38,080 --> 00:22:39,679
geolocate those devices because we don't

589
00:22:39,679 --> 00:22:41,120
have a mac address on the lan side to

590
00:22:41,120 --> 00:22:42,240
begin with

591
00:22:42,240 --> 00:22:43,760
some devices are non-responsive to

592
00:22:43,760 --> 00:22:45,360
probes and so we never get a response

593
00:22:45,360 --> 00:22:48,400
from them even if they do use eui-64

594
00:22:48,400 --> 00:22:50,400
addresses on their wan

595
00:22:50,400 --> 00:22:51,760
interface

596
00:22:51,760 --> 00:22:53,440
we have some limitations as it pertains

597
00:22:53,440 --> 00:22:56,080
to bssid collection too some devices are

598
00:22:56,080 --> 00:22:58,080
not all-in-one cpu devices they don't

599
00:22:58,080 --> 00:23:00,720
have a wi-fi built into the router or

600
00:23:00,720 --> 00:23:02,480
the cable modem

601
00:23:02,480 --> 00:23:05,360
some devices just exist in places where

602
00:23:05,360 --> 00:23:07,280
geolocation databases don't cover for

603
00:23:07,280 --> 00:23:08,640
example

604
00:23:08,640 --> 00:23:10,000
and then there's some limitations as it

605
00:23:10,000 --> 00:23:12,080
uh as they pertains to our correlation

606
00:23:12,080 --> 00:23:13,360
algorithm

607
00:23:13,360 --> 00:23:15,600
and some devices the the wired mac

608
00:23:15,600 --> 00:23:17,280
addresses and the wireless mac addresses

609
00:23:17,280 --> 00:23:18,640
are allocated out of two totally

610
00:23:18,640 --> 00:23:20,880
different oui and for those devices

611
00:23:20,880 --> 00:23:22,720
without having ground truth it's very

612
00:23:22,720 --> 00:23:24,720
difficult for us to to know you know

613
00:23:24,720 --> 00:23:26,480
what the offset between the wired and

614
00:23:26,480 --> 00:23:28,240
wireless interface is although we

615
00:23:28,240 --> 00:23:30,080
believe that given ground truth we're

616
00:23:30,080 --> 00:23:33,039
probably able to figure it out too

617
00:23:33,039 --> 00:23:34,960
um and and that those those those

618
00:23:34,960 --> 00:23:36,720
offsets are probably static even when

619
00:23:36,720 --> 00:23:39,840
they're within different oui

620
00:23:39,840 --> 00:23:41,760
um and finally uh even though our

621
00:23:41,760 --> 00:23:45,600
algorithm produces a a uh offset on a

622
00:23:45,600 --> 00:23:47,840
pro ui basis there's nothing stopping

623
00:23:47,840 --> 00:23:49,919
manufacturers from have having different

624
00:23:49,919 --> 00:23:52,080
offsets for different devices within the

625
00:23:52,080 --> 00:23:53,840
same oui

626
00:23:53,840 --> 00:23:55,679
however given all of those limitations

627
00:23:55,679 --> 00:23:57,440
we still have

628
00:23:57,440 --> 00:23:58,320
a

629
00:23:58,320 --> 00:24:00,080
great deal of success using our

630
00:24:00,080 --> 00:24:02,000
algorithm to geolocate

631
00:24:02,000 --> 00:24:05,440
ipv6 cpe devices so by combining our wan

632
00:24:05,440 --> 00:24:07,679
mac address and bssid data we're able to

633
00:24:07,679 --> 00:24:09,679
geolocate at least 12 million unique

634
00:24:09,679 --> 00:24:12,080
devices out of the total 60 million wan

635
00:24:12,080 --> 00:24:14,080
mac addresses that we started with in

636
00:24:14,080 --> 00:24:16,559
almost 150 unique countries

637
00:24:16,559 --> 00:24:18,720
and these uh mac addresses belong to

638
00:24:18,720 --> 00:24:21,760
over a thousand different unique ouis

639
00:24:21,760 --> 00:24:25,520
what this tells us is that eui 64 ipv6

640
00:24:25,520 --> 00:24:28,159
address use in the cpe space as opposed

641
00:24:28,159 --> 00:24:30,400
to the endpoint space

642
00:24:30,400 --> 00:24:33,360
is extremely common and widespread and

643
00:24:33,360 --> 00:24:35,840
uh because we're able to geolocate so

644
00:24:35,840 --> 00:24:38,559
many devices uh this is a serious uh

645
00:24:38,559 --> 00:24:40,640
location privacy concern for individuals

646
00:24:40,640 --> 00:24:42,320
particularly because these devices often

647
00:24:42,320 --> 00:24:44,240
exist in their homes or businesses the

648
00:24:44,240 --> 00:24:48,320
use of eui-64 ipv6 addresses uh is and

649
00:24:48,320 --> 00:24:50,480
should be considered harmful

650
00:24:50,480 --> 00:24:52,320
um in this presentation we're primarily

651
00:24:52,320 --> 00:24:53,919
going to look at results um in the

652
00:24:53,919 --> 00:24:56,080
aggregate and in the one case that i do

653
00:24:56,080 --> 00:24:58,240
depict a single locate geolocated device

654
00:24:58,240 --> 00:25:01,279
i introduce a massive amount of error

655
00:25:01,279 --> 00:25:03,039
so the first result that i'll i'll

656
00:25:03,039 --> 00:25:05,440
display here um

657
00:25:05,440 --> 00:25:07,360
talks about our validation of our

658
00:25:07,360 --> 00:25:08,799
algorithm we wanted to know does the

659
00:25:08,799 --> 00:25:11,039
algorithm that i described in the last

660
00:25:11,039 --> 00:25:12,880
several slides doesn't actually work and

661
00:25:12,880 --> 00:25:14,159
so what we did was we solicited

662
00:25:14,159 --> 00:25:18,159
volunteers that have cpe that uses ui 64

663
00:25:18,159 --> 00:25:20,159
uh addresses on their their wan

664
00:25:20,159 --> 00:25:21,600
interface they told us what their

665
00:25:21,600 --> 00:25:24,559
internal subnet was we uh then initiated

666
00:25:24,559 --> 00:25:26,400
a trace route to a random address inside

667
00:25:26,400 --> 00:25:28,480
of their their home gateway

668
00:25:28,480 --> 00:25:29,360
um

669
00:25:29,360 --> 00:25:31,440
when the tracer out reached their cpe we

670
00:25:31,440 --> 00:25:34,159
obtained their eoi 64 ipv6 address that

671
00:25:34,159 --> 00:25:36,080
that's on their wan interface then we

672
00:25:36,080 --> 00:25:38,400
used our tool and our methodology in

673
00:25:38,400 --> 00:25:40,400
order to infer the bssid and then

674
00:25:40,400 --> 00:25:42,400
geolocate their ip address

675
00:25:42,400 --> 00:25:44,720
in the best case so of the small number

676
00:25:44,720 --> 00:25:47,279
of volunteers that we were able to

677
00:25:47,279 --> 00:25:48,640
uh solicit

678
00:25:48,640 --> 00:25:51,039
uh four out of the five eighty percent

679
00:25:51,039 --> 00:25:53,840
we were able to geolocate um all of the

680
00:25:53,840 --> 00:25:56,000
accuracy accuracies were less than 50

681
00:25:56,000 --> 00:25:57,039
meters

682
00:25:57,039 --> 00:25:58,320
and uh

683
00:25:58,320 --> 00:26:00,720
often times this was the geolocated

684
00:26:00,720 --> 00:26:02,080
point was on the opposite side of the

685
00:26:02,080 --> 00:26:04,799
house from from the router itself um so

686
00:26:04,799 --> 00:26:05,679
so

687
00:26:05,679 --> 00:26:08,320
very very precise geolocation

688
00:26:08,320 --> 00:26:09,679
in the single instance at which we were

689
00:26:09,679 --> 00:26:12,080
not able to geo locate the the ipv6

690
00:26:12,080 --> 00:26:16,080
address um while the wan ip address was

691
00:26:16,080 --> 00:26:20,480
eui 64 the wan mac address and bss ids

692
00:26:20,480 --> 00:26:24,200
were not sequential

693
00:26:25,520 --> 00:26:27,840
um here's another set of results uh that

694
00:26:27,840 --> 00:26:29,440
describes what we can do when we look at

695
00:26:29,440 --> 00:26:31,919
a large number of geo-located uh

696
00:26:31,919 --> 00:26:33,840
mac addresses within the same oui and

697
00:26:33,840 --> 00:26:37,039
we're able to to make claims about uh

698
00:26:37,039 --> 00:26:38,880
what manufacturers do and how that

699
00:26:38,880 --> 00:26:40,799
affects the country level distribution

700
00:26:40,799 --> 00:26:42,640
of their devices

701
00:26:42,640 --> 00:26:44,480
so what i'm displaying here on on the

702
00:26:44,480 --> 00:26:46,159
right is a graphical

703
00:26:46,159 --> 00:26:48,480
depiction of a mitrastar oui the

704
00:26:48,480 --> 00:26:50,960
ccd4a1oui

705
00:26:50,960 --> 00:26:54,400
on the y-axis i'm uh depicting the

706
00:26:54,400 --> 00:26:56,720
fourth byte of a geolocated mac address

707
00:26:56,720 --> 00:26:58,480
and on the x-axis i'm depicting the

708
00:26:58,480 --> 00:27:01,279
fifth byte of a geo-located mac address

709
00:27:01,279 --> 00:27:03,120
points that are geo-located appear as a

710
00:27:03,120 --> 00:27:05,440
particular color and the teal

711
00:27:05,440 --> 00:27:07,360
our mac addresses that were geo-located

712
00:27:07,360 --> 00:27:09,679
to argentina and in the the sort of

713
00:27:09,679 --> 00:27:11,600
fuchsia color are mac addresses that

714
00:27:11,600 --> 00:27:13,840
were geo-located to peru

715
00:27:13,840 --> 00:27:15,360
so while it's been known for several

716
00:27:15,360 --> 00:27:17,279
years and suspected probably for far

717
00:27:17,279 --> 00:27:18,640
longer um

718
00:27:18,640 --> 00:27:21,360
companies not all uh you know companies

719
00:27:21,360 --> 00:27:23,360
divide their mac address space by by

720
00:27:23,360 --> 00:27:26,159
model but what ipvcu allows us to do is

721
00:27:26,159 --> 00:27:28,559
we can see country level divisions um

722
00:27:28,559 --> 00:27:30,480
and how those devices end up actually

723
00:27:30,480 --> 00:27:32,640
being distributed as well uh so we can

724
00:27:32,640 --> 00:27:35,039
see distinct bands that are allocated to

725
00:27:35,039 --> 00:27:36,880
to mac addresses that are geo-located

726
00:27:36,880 --> 00:27:38,399
argentina and distinct bands that are

727
00:27:38,399 --> 00:27:39,840
geo-located to mac addresses that are

728
00:27:39,840 --> 00:27:43,360
geo-located to um peru here

729
00:27:43,360 --> 00:27:45,840
um other ouis however don't show that

730
00:27:45,840 --> 00:27:48,000
kind of banding we see consistent geolo

731
00:27:48,000 --> 00:27:50,480
country level geolocations

732
00:27:50,480 --> 00:27:52,799
this particular graphic represents a

733
00:27:52,799 --> 00:27:56,279
once this oui this one cd4 is

734
00:27:56,279 --> 00:27:59,679
1c24cd oui which is an ascii corporation

735
00:27:59,679 --> 00:28:01,360
oui

736
00:28:01,360 --> 00:28:03,520
this shows us that you know almost all

737
00:28:03,520 --> 00:28:06,399
of these devices are geo-located to uh

738
00:28:06,399 --> 00:28:09,120
to switzerland 32 000

739
00:28:09,120 --> 00:28:10,640
approximately our geo located in

740
00:28:10,640 --> 00:28:12,399
switzerland with much smaller numbers

741
00:28:12,399 --> 00:28:15,039
delocated to surrounding countries and

742
00:28:15,039 --> 00:28:16,720
this fits what our intuition should be

743
00:28:16,720 --> 00:28:19,440
because swisscom which is a major swiss

744
00:28:19,440 --> 00:28:21,440
internet service provider provides ascii

745
00:28:21,440 --> 00:28:23,919
routers as its standard home wireless

746
00:28:23,919 --> 00:28:25,840
device and so we would expect these

747
00:28:25,840 --> 00:28:27,039
things to primarily show up in

748
00:28:27,039 --> 00:28:28,399
switzerland and when they don't they

749
00:28:28,399 --> 00:28:29,760
should be in countries that are that are

750
00:28:29,760 --> 00:28:33,039
somewhat close by

751
00:28:33,840 --> 00:28:35,360
another thing that we can do is we can

752
00:28:35,360 --> 00:28:37,440
compare our geo locations that we derive

753
00:28:37,440 --> 00:28:41,039
from ipvcu to the state-of-the-art ip

754
00:28:41,039 --> 00:28:43,919
geolocation databases such as max mine's

755
00:28:43,919 --> 00:28:45,679
geolight database

756
00:28:45,679 --> 00:28:47,039
so what we did here and what i'm

757
00:28:47,039 --> 00:28:48,559
depicting on the the graphic on the

758
00:28:48,559 --> 00:28:49,840
right is i've

759
00:28:49,840 --> 00:28:53,840
plotted all of the xfinity routers

760
00:28:53,840 --> 00:28:55,520
there's more than a million of them in

761
00:28:55,520 --> 00:28:57,360
blue

762
00:28:57,360 --> 00:28:59,760
their geolocation according to ipvc you

763
00:28:59,760 --> 00:29:01,919
and then i've plotted uh the ip

764
00:29:01,919 --> 00:29:04,559
addresses from which those uh xfinity

765
00:29:04,559 --> 00:29:07,360
routers mac addresses cam came from

766
00:29:07,360 --> 00:29:09,520
according to their geolight max mine's

767
00:29:09,520 --> 00:29:12,159
geolight database geolocation there in

768
00:29:12,159 --> 00:29:15,200
the the the orange

769
00:29:15,200 --> 00:29:18,480
all million of the xfinity mac addresses

770
00:29:18,480 --> 00:29:19,919
the ip addresses that they came from

771
00:29:19,919 --> 00:29:22,880
were geolocated by max mined to that

772
00:29:22,880 --> 00:29:25,600
to kansas uh that that orange dot there

773
00:29:25,600 --> 00:29:28,159
in the middle whereas all of the ipvc ug

774
00:29:28,159 --> 00:29:30,240
locations are displayed in blue and what

775
00:29:30,240 --> 00:29:32,880
we can see here is that uh i

776
00:29:32,880 --> 00:29:35,440
it appears that ipvc used geolocation is

777
00:29:35,440 --> 00:29:37,840
is much more accurate than than max

778
00:29:37,840 --> 00:29:39,360
mines because they're not all low geo

779
00:29:39,360 --> 00:29:41,279
located at the same place you might ask

780
00:29:41,279 --> 00:29:43,919
does this actually mirror what um what

781
00:29:43,919 --> 00:29:48,640
comcast's xfinity internet service uh

782
00:29:48,640 --> 00:29:50,399
coverage map looks like

783
00:29:50,399 --> 00:29:52,960
and so we went to the fcc and we got the

784
00:29:52,960 --> 00:29:54,880
comcast coverage map and you'll see that

785
00:29:54,880 --> 00:29:57,360
it is almost a mirror image of what we

786
00:29:57,360 --> 00:30:00,959
derive from ipvcu

787
00:30:01,279 --> 00:30:02,960
a final thing that we're able to do with

788
00:30:02,960 --> 00:30:05,760
ipvc is we're able to geolocate some isp

789
00:30:05,760 --> 00:30:07,679
infrastructure in addition to the cpe

790
00:30:07,679 --> 00:30:10,159
devices that we're able to geolocate

791
00:30:10,159 --> 00:30:11,919
so if we assume that there's some

792
00:30:11,919 --> 00:30:14,080
physical distance constraint between the

793
00:30:14,080 --> 00:30:17,279
cpe device and the last hop

794
00:30:17,279 --> 00:30:19,520
that exists within the provider's

795
00:30:19,520 --> 00:30:21,600
infrastructure

796
00:30:21,600 --> 00:30:23,200
what we can do is we can aggregate the

797
00:30:23,200 --> 00:30:26,159
geolocations of the cpe devices

798
00:30:26,159 --> 00:30:28,559
and we know that the the provider's

799
00:30:28,559 --> 00:30:32,080
infrastructure must be somewhere nearby

800
00:30:32,080 --> 00:30:34,559
as an example uh what we're showing here

801
00:30:34,559 --> 00:30:36,399
on on the right hand side is a trace

802
00:30:36,399 --> 00:30:39,760
route that ends with a eui 64 ipv6

803
00:30:39,760 --> 00:30:42,159
address that we can presumably geolocate

804
00:30:42,159 --> 00:30:43,600
but now we're interested in the

805
00:30:43,600 --> 00:30:46,320
penultimate hop the hop before

806
00:30:46,320 --> 00:30:48,880
that cpe device that is within the

807
00:30:48,880 --> 00:30:51,600
providers the isps infrastructure

808
00:30:51,600 --> 00:30:54,320
so what we can do now is we can start

809
00:30:54,320 --> 00:30:56,559
correlating all the geolocations of the

810
00:30:56,559 --> 00:30:59,360
cpe devices by penultimate hop that

811
00:30:59,360 --> 00:31:01,120
second to last hop that corresponds to

812
00:31:01,120 --> 00:31:02,080
something in the provider's

813
00:31:02,080 --> 00:31:03,760
infrastructure

814
00:31:03,760 --> 00:31:05,840
and so the intuition here is that we can

815
00:31:05,840 --> 00:31:08,080
geo-locate the provider's infrastructure

816
00:31:08,080 --> 00:31:10,880
by geolocating the cpe devices that are

817
00:31:10,880 --> 00:31:12,960
connected to it

818
00:31:12,960 --> 00:31:15,039
and so i've done that here uh we've done

819
00:31:15,039 --> 00:31:16,480
that here on the right-hand graphic

820
00:31:16,480 --> 00:31:19,360
which is uh depicts each color depicts a

821
00:31:19,360 --> 00:31:21,200
different penultimate hop that second

822
00:31:21,200 --> 00:31:24,320
that hop before the cpe device

823
00:31:24,320 --> 00:31:26,640
and so we can see that these cpe devices

824
00:31:26,640 --> 00:31:28,159
different colors are grouped into

825
00:31:28,159 --> 00:31:29,760
different regions and presumably the

826
00:31:29,760 --> 00:31:31,600
provider's infrastructure also exists

827
00:31:31,600 --> 00:31:33,440
within that same region particularly if

828
00:31:33,440 --> 00:31:35,120
it's something that's constrained by

829
00:31:35,120 --> 00:31:37,440
physical distance for example a a cable

830
00:31:37,440 --> 00:31:39,519
head end

831
00:31:39,519 --> 00:31:42,000
and so now just by geo locating the cpe

832
00:31:42,000 --> 00:31:43,840
devices that are connected to the isps

833
00:31:43,840 --> 00:31:45,519
infrastructure we're able to to

834
00:31:45,519 --> 00:31:47,840
geolocate that last mile infrastructure

835
00:31:47,840 --> 00:31:50,480
as well but it gets even worse assume

836
00:31:50,480 --> 00:31:53,919
that i have bought a high-end cpe device

837
00:31:53,919 --> 00:31:57,120
that doesn't use eui 64 addressing

838
00:31:57,120 --> 00:31:59,519
now if i'm able to geo-locate the

839
00:31:59,519 --> 00:32:01,679
provider's infrastructure even if i

840
00:32:01,679 --> 00:32:05,840
don't have an eui 64 cpe device just by

841
00:32:05,840 --> 00:32:08,240
being able to geolocate that penultimate

842
00:32:08,240 --> 00:32:09,679
hop

843
00:32:09,679 --> 00:32:12,559
we can geolocate at a coarser coarser

844
00:32:12,559 --> 00:32:14,200
grain my

845
00:32:14,200 --> 00:32:17,039
non-eui-64 device in other words simply

846
00:32:17,039 --> 00:32:18,960
living nearby

847
00:32:18,960 --> 00:32:22,240
people that own eui 64 devices

848
00:32:22,240 --> 00:32:24,399
is itself a location privacy

849
00:32:24,399 --> 00:32:27,439
vulnerability for me

850
00:32:27,600 --> 00:32:29,840
okay so that wraps up our discussion of

851
00:32:29,840 --> 00:32:33,519
uh what it is that ipvc is at this point

852
00:32:33,519 --> 00:32:36,159
um i'll demonstrate our discussion and

853
00:32:36,159 --> 00:32:37,519
then demonstrate a tool that we've

854
00:32:37,519 --> 00:32:39,279
developed that assists in the

855
00:32:39,279 --> 00:32:44,000
geolocation of ipv ui 64 ipv6 addresses

856
00:32:44,000 --> 00:32:46,880
so our ipvtc uh tool

857
00:32:46,880 --> 00:32:48,960
works in the following manner so assume

858
00:32:48,960 --> 00:32:51,519
that you have a wan mac a wan mac

859
00:32:51,519 --> 00:32:54,399
address or an eui 64 ipv6 address that

860
00:32:54,399 --> 00:32:56,399
you wanted you locate

861
00:32:56,399 --> 00:32:58,960
what our ipvc tool does is it calculates

862
00:32:58,960 --> 00:33:02,480
the predicted bssid value using the

863
00:33:02,480 --> 00:33:04,399
inferred offsets that our algorithm

864
00:33:04,399 --> 00:33:07,120
develops and then it queries one of

865
00:33:07,120 --> 00:33:10,960
three different location apis for a for

866
00:33:10,960 --> 00:33:13,840
that predicted bssid

867
00:33:13,840 --> 00:33:15,760
and then optionally it outputs kml for

868
00:33:15,760 --> 00:33:18,720
any geo-located bssids

869
00:33:18,720 --> 00:33:20,880
so at this point i will demonstrate the

870
00:33:20,880 --> 00:33:22,159
um both

871
00:33:22,159 --> 00:33:25,360
discovering eui 64 ipv6 addresses using

872
00:33:25,360 --> 00:33:28,559
traceroute and then using the ipvcu tool

873
00:33:28,559 --> 00:33:30,559
to geolocate those

874
00:33:30,559 --> 00:33:33,440
ip addresses

875
00:33:35,200 --> 00:33:36,640
so the first portion of this is just

876
00:33:36,640 --> 00:33:38,480
going to be how to use traceroute to

877
00:33:38,480 --> 00:33:42,080
discover eui 64 ipv6 addresses so i'm

878
00:33:42,080 --> 00:33:44,320
sending a trace route to a random

879
00:33:44,320 --> 00:33:49,039
address inside of this 64 network

880
00:33:49,039 --> 00:33:52,080
just choosing a random lower 64 bits and

881
00:33:52,080 --> 00:33:54,159
then sending the trace route

882
00:33:54,159 --> 00:33:55,919
again it's unlikely that anything inside

883
00:33:55,919 --> 00:33:57,760
of that slash 64 is going to have this

884
00:33:57,760 --> 00:33:59,760
address but i'm simply attempting to get

885
00:33:59,760 --> 00:34:01,120
the trace route

886
00:34:01,120 --> 00:34:03,600
to the cpe device so that i can find

887
00:34:03,600 --> 00:34:06,080
what it's uh i can i can determine the

888
00:34:06,080 --> 00:34:07,760
cpe device's

889
00:34:07,760 --> 00:34:10,159
address and hopefully it'll be an eui 64

890
00:34:10,159 --> 00:34:11,760
ipv6 address so i can attempt to

891
00:34:11,760 --> 00:34:14,560
geolocate it

892
00:34:16,960 --> 00:34:18,639
so finally at hop

893
00:34:18,639 --> 00:34:21,199
13 i get a response from a provider

894
00:34:21,199 --> 00:34:22,560
infrastructure

895
00:34:22,560 --> 00:34:24,239
router notice that there's no pointer

896
00:34:24,239 --> 00:34:26,719
record here to help us with geolocation

897
00:34:26,719 --> 00:34:29,280
as a reminder in ipv4 often pointer

898
00:34:29,280 --> 00:34:31,359
records and reverse dns help us to do

899
00:34:31,359 --> 00:34:33,520
some kind of course geolocation

900
00:34:33,520 --> 00:34:35,918
because the the the

901
00:34:35,918 --> 00:34:38,000
the pointer records contain some sort of

902
00:34:38,000 --> 00:34:40,719
hint that uh indicates uh where where

903
00:34:40,719 --> 00:34:42,800
those routers are and v6 this is often

904
00:34:42,800 --> 00:34:44,159
not the case

905
00:34:44,159 --> 00:34:45,839
at hop 14 there's still no point of

906
00:34:45,839 --> 00:34:47,440
records to help us out

907
00:34:47,440 --> 00:34:50,000
finally a hop 16 or a 15 rather notice

908
00:34:50,000 --> 00:34:52,800
that we we found an eui 64 cpe device

909
00:34:52,800 --> 00:34:54,719
but when we look it up in max mind it's

910
00:34:54,719 --> 00:34:56,879
geolocated to that cheney reservoir in

911
00:34:56,879 --> 00:34:59,359
kansas 2 which doesn't help us

912
00:34:59,359 --> 00:35:01,680
so now we want to take that ip address

913
00:35:01,680 --> 00:35:02,960
that we discovered

914
00:35:02,960 --> 00:35:05,599
and use the ipvcu tool in order to

915
00:35:05,599 --> 00:35:08,400
determine what where that that ipv6

916
00:35:08,400 --> 00:35:10,800
address is located so we simply use the

917
00:35:10,800 --> 00:35:12,880
ipvcu tool that you're able to get on

918
00:35:12,880 --> 00:35:16,720
our github we pass it the eui 64 address

919
00:35:16,720 --> 00:35:18,400
that we discovered using that trace

920
00:35:18,400 --> 00:35:19,920
route

921
00:35:19,920 --> 00:35:21,760
and what it does is it predicts the

922
00:35:21,760 --> 00:35:24,480
bssid value based on the oui

923
00:35:24,480 --> 00:35:28,880
that the wan mac address from the eui 64

924
00:35:28,880 --> 00:35:32,160
ipv6 address uh would produce using our

925
00:35:32,160 --> 00:35:34,480
algorithm and then ultimately uh it

926
00:35:34,480 --> 00:35:36,079
queries uh in this case the apple

927
00:35:36,079 --> 00:35:38,320
location services api which then returns

928
00:35:38,320 --> 00:35:40,560
this this latitude and longitude which

929
00:35:40,560 --> 00:35:42,880
is you know much more accurate than than

930
00:35:42,880 --> 00:35:45,839
what max mine produced

931
00:35:47,200 --> 00:35:50,160
so that completes our demo um before we

932
00:35:50,160 --> 00:35:53,200
we we conclude here i want to mention uh

933
00:35:53,200 --> 00:35:55,040
the responsible disclosure and

934
00:35:55,040 --> 00:35:57,200
remediation steps that we took uh during

935
00:35:57,200 --> 00:35:58,640
during the study

936
00:35:58,640 --> 00:35:59,520
so

937
00:35:59,520 --> 00:36:00,960
this

938
00:36:00,960 --> 00:36:03,920
vulnerability is is simple in theory to

939
00:36:03,920 --> 00:36:06,160
stop right the ideal remediation here is

940
00:36:06,160 --> 00:36:08,640
that cpe manufacturers must stop using

941
00:36:08,640 --> 00:36:11,920
eui 64 ipv6 addresses

942
00:36:11,920 --> 00:36:13,920
on their wan and interface

943
00:36:13,920 --> 00:36:16,640
uh these these addresses are are you

944
00:36:16,640 --> 00:36:18,560
know more or less deprecated in the uh

945
00:36:18,560 --> 00:36:20,000
endpoint space and they need to be

946
00:36:20,000 --> 00:36:22,880
deprecated in the cpe space as well

947
00:36:22,880 --> 00:36:25,040
we've disclosed this location privacy

948
00:36:25,040 --> 00:36:27,119
vulnerability to multiple vendors the

949
00:36:27,119 --> 00:36:28,720
vendors we disclose this to account for

950
00:36:28,720 --> 00:36:30,320
millions of the geolocated the 12

951
00:36:30,320 --> 00:36:33,280
million geolocated cpe that we found

952
00:36:33,280 --> 00:36:35,680
during the study we've got mixed results

953
00:36:35,680 --> 00:36:37,040
from the vendors that we disclosed this

954
00:36:37,040 --> 00:36:38,000
to

955
00:36:38,000 --> 00:36:42,560
on on the one hand we've had vendors

956
00:36:42,560 --> 00:36:44,079
tell us that they were going to cease

957
00:36:44,079 --> 00:36:47,040
using eui 64 addresses and and use

958
00:36:47,040 --> 00:36:49,359
privacy extension addresses on the wan

959
00:36:49,359 --> 00:36:52,000
interface on the other side we've had

960
00:36:52,000 --> 00:36:53,920
vendors that have disputed whether they

961
00:36:53,920 --> 00:36:58,480
they use eui 64 addressing at all

962
00:37:00,880 --> 00:37:03,760
so finally in conclusion ipvc-u again

963
00:37:03,760 --> 00:37:07,040
has a large-scale data fusion attack we

964
00:37:07,040 --> 00:37:11,040
combine uh ey 64 ipv6 addresses that

965
00:37:11,040 --> 00:37:12,800
we've discovered via active measurements

966
00:37:12,800 --> 00:37:15,520
with geolocated bssids uh that we derive

967
00:37:15,520 --> 00:37:17,920
from multiple sources of geolocated

968
00:37:17,920 --> 00:37:20,560
geolocation data um we are able to

969
00:37:20,560 --> 00:37:22,720
geolocate millions of cpe routers and

970
00:37:22,720 --> 00:37:24,640
even some provider in our infrastructure

971
00:37:24,640 --> 00:37:26,720
based on how those geolocated cpe

972
00:37:26,720 --> 00:37:27,680
routers

973
00:37:27,680 --> 00:37:29,440
fall out on a map

974
00:37:29,440 --> 00:37:31,119
and finally because we can geolocate

975
00:37:31,119 --> 00:37:32,960
some provider infrastructure we can also

976
00:37:32,960 --> 00:37:36,240
geolocate cpe devices at a coarser grain

977
00:37:36,240 --> 00:37:39,599
that don't use eui 64 addresses

978
00:37:39,599 --> 00:37:41,280
in theory this is easy to prevent you

979
00:37:41,280 --> 00:37:43,760
just don't use eui 64 addresses but of

980
00:37:43,760 --> 00:37:46,000
course some of these devices

981
00:37:46,000 --> 00:37:48,240
last are out there for quite a long time

982
00:37:48,240 --> 00:37:50,560
and these devices don't get updated and

983
00:37:50,560 --> 00:37:53,520
again even a single eui 64 router can

984
00:37:53,520 --> 00:37:55,720
compromise some of the privacy of

985
00:37:55,720 --> 00:37:59,520
non-eui-64 device owners by being able

986
00:37:59,520 --> 00:38:01,280
to geo-locate some provider

987
00:38:01,280 --> 00:38:04,280
infrastructure

988
00:38:06,000 --> 00:38:07,440
so at this point i'll take your

989
00:38:07,440 --> 00:38:08,960
questions but i want to first point out

990
00:38:08,960 --> 00:38:10,480
a couple of things we're still seeking

991
00:38:10,480 --> 00:38:12,720
volunteers to help validate um our tool

992
00:38:12,720 --> 00:38:14,880
and test our methodology so please

993
00:38:14,880 --> 00:38:17,280
contact us at the you are the sixth url

994
00:38:17,280 --> 00:38:19,280
there and if you're interested in using

995
00:38:19,280 --> 00:38:21,760
our tool it can be found at that github

996
00:38:21,760 --> 00:38:23,920
link provided there

997
00:38:23,920 --> 00:38:25,760
so thanks for listening and i'm excited

998
00:38:25,760 --> 00:38:29,720
to take your questions at this point

