1
00:00:00,030 --> 00:00:04,549
let's first start off make sure we're in

2
00:00:01,290 --> 00:00:07,980
the right place this is Lagoon GHI

3
00:00:04,549 --> 00:00:11,219
forearm Ida and cross-check reversing

4
00:00:07,980 --> 00:00:13,590
the Boeing 787s core network by Reuben

5
00:00:11,219 --> 00:00:16,020
Santa Marta before we begin though we

6
00:00:13,590 --> 00:00:17,850
have a few brief notes to cover please

7
00:00:16,020 --> 00:00:19,948
stop by the business hall located in

8
00:00:17,850 --> 00:00:22,470
Mandalay Bay Oceanside and shoreline

9
00:00:19,949 --> 00:00:25,289
ballrooms on level 2 during the day and

10
00:00:22,470 --> 00:00:28,019
for the Welcome Reception at 5:30 this

11
00:00:25,289 --> 00:00:30,810
evening the blackhat Arsenal is in the

12
00:00:28,019 --> 00:00:36,349
business hall on level 2 and join us for

13
00:00:30,810 --> 00:00:38,760
the pony Awards and lagoon JKL at 6:30

14
00:00:36,350 --> 00:00:40,530
please put your phones on silent and

15
00:00:38,760 --> 00:00:41,550
depending on the time of the talk

16
00:00:40,530 --> 00:00:44,610
questions will either be at the

17
00:00:41,550 --> 00:00:47,489
microphones or if not they'll go to the

18
00:00:44,610 --> 00:00:56,039
rap room at reef a down the hall so

19
00:00:47,489 --> 00:00:57,629
without further ado ribbon thank you

20
00:00:56,039 --> 00:01:00,600
thank you very much everyone for

21
00:00:57,629 --> 00:01:02,820
attending today it's also my third time

22
00:01:00,600 --> 00:01:05,580
in a row here so thank you for black hat

23
00:01:02,820 --> 00:01:08,549
for having me here I would like to

24
00:01:05,580 --> 00:01:12,390
introduce a little bit the context of

25
00:01:08,549 --> 00:01:15,840
this research I've been afraid of flying

26
00:01:12,390 --> 00:01:19,049
for many years so there are different

27
00:01:15,840 --> 00:01:21,060
ways to deal with this I decided that my

28
00:01:19,049 --> 00:01:25,710
way would be to learn as much as

29
00:01:21,060 --> 00:01:27,509
possible about aircraft not lead to this

30
00:01:25,710 --> 00:01:29,158
kind of research that I've been

31
00:01:27,509 --> 00:01:34,590
presenting for a couple of years or

32
00:01:29,159 --> 00:01:37,200
three let's back to the future because I

33
00:01:34,590 --> 00:01:40,680
think it's it's going to be interesting

34
00:01:37,200 --> 00:01:45,180
ten years ago Wired published an article

35
00:01:40,680 --> 00:01:48,570
a story on the 787 basically this was

36
00:01:45,180 --> 00:01:52,189
one of the most advanced aircraft ever

37
00:01:48,570 --> 00:01:55,679
presented and it contained a lot of new

38
00:01:52,189 --> 00:01:59,189
functionalities all those

39
00:01:55,680 --> 00:02:03,270
functionalities came at a cost that

40
00:01:59,189 --> 00:02:05,610
basically we were mixing or they were

41
00:02:03,270 --> 00:02:08,699
sharing a common network

42
00:02:05,610 --> 00:02:12,800
that other aircraft or other design

43
00:02:08,699 --> 00:02:15,600
designs they were physically isolated

44
00:02:12,800 --> 00:02:17,610
it's it's interesting to read this

45
00:02:15,600 --> 00:02:19,769
article because for example the

46
00:02:17,610 --> 00:02:23,580
spokesperson from Boeing in that article

47
00:02:19,770 --> 00:02:25,520
says that the network is physically

48
00:02:23,580 --> 00:02:29,250
isolated the different networks are

49
00:02:25,520 --> 00:02:31,470
physically isolated so we will see some

50
00:02:29,250 --> 00:02:34,260
things today that maybe that's not the

51
00:02:31,470 --> 00:02:41,190
right thing to to describe how it's

52
00:02:34,260 --> 00:02:46,890
designed then we can move to we can jump

53
00:02:41,190 --> 00:02:49,200
to 2015 well all this mess with chris

54
00:02:46,890 --> 00:02:54,660
Roberts habit and there was an article

55
00:02:49,200 --> 00:02:57,079
also a world was discussing what's the

56
00:02:54,660 --> 00:03:00,600
reality or what's the truth behind

57
00:02:57,080 --> 00:03:02,910
fucking an airplane Peter lemon which is

58
00:03:00,600 --> 00:03:06,630
forming Boeing in a former Boeing

59
00:03:02,910 --> 00:03:11,130
engineer I highly recommend his blood

60
00:03:06,630 --> 00:03:14,400
it's SATCOM dot guru explained this

61
00:03:11,130 --> 00:03:18,930
which is common sense if you have our

62
00:03:14,400 --> 00:03:21,269
network centric traffic design that

63
00:03:18,930 --> 00:03:24,209
should be something between the avionics

64
00:03:21,269 --> 00:03:26,160
and in-flight and determine system or

65
00:03:24,209 --> 00:03:29,209
other devices located in the

66
00:03:26,160 --> 00:03:32,549
non-critical domain in that should

67
00:03:29,209 --> 00:03:34,860
segregate or prevent that all the

68
00:03:32,549 --> 00:03:39,269
traffic can end up in the in the

69
00:03:34,860 --> 00:03:42,450
avionics network so today's talk it's

70
00:03:39,269 --> 00:03:46,080
about that box on top box in the 787 has

71
00:03:42,450 --> 00:03:47,850
a name is the core network a veneer but

72
00:03:46,080 --> 00:03:51,540
let's move to the beginning how

73
00:03:47,850 --> 00:03:55,380
everything started so in September 2018

74
00:03:51,540 --> 00:04:00,149
just a month after giving a talk here

75
00:03:55,380 --> 00:04:03,390
about some vulnerabilities I was trying

76
00:04:00,150 --> 00:04:07,079
my luck with some well-known Google

77
00:04:03,390 --> 00:04:10,828
queries and it turns out that I

78
00:04:07,079 --> 00:04:13,800
discovered a publicly exposed Boeing

79
00:04:10,829 --> 00:04:16,140
server that contained quite a few files

80
00:04:13,800 --> 00:04:19,019
and well they looked interesting

81
00:04:16,140 --> 00:04:22,650
definitely so I downloaded everything

82
00:04:19,019 --> 00:04:27,210
and later on I analyzed the files and

83
00:04:22,650 --> 00:04:31,198
well the result is not I had access to

84
00:04:27,210 --> 00:04:33,690
the 787 core networking it also part of

85
00:04:31,199 --> 00:04:36,509
the seven three seven fewer and also a

86
00:04:33,690 --> 00:04:41,430
filter machine the wine engineers used

87
00:04:36,509 --> 00:04:44,130
to DPN interspecific my network I like

88
00:04:41,430 --> 00:04:46,380
to clarify that the framework that I had

89
00:04:44,130 --> 00:04:49,560
access is block level it's production

90
00:04:46,380 --> 00:04:51,810
it's not any kind of testing it's blood

91
00:04:49,560 --> 00:04:56,789
level which is the terminology for

92
00:04:51,810 --> 00:04:59,759
production in in avionics and also it

93
00:04:56,789 --> 00:05:03,719
included the documents and everything

94
00:04:59,759 --> 00:05:05,250
and you can see the the those details in

95
00:05:03,720 --> 00:05:10,620
the white paper that will be published

96
00:05:05,250 --> 00:05:13,099
right of the dog so the methodology is

97
00:05:10,620 --> 00:05:16,349
like in the previous research basically

98
00:05:13,099 --> 00:05:20,190
we are very limited we don't have access

99
00:05:16,349 --> 00:05:25,889
to 787 unfortunately if someone wants to

100
00:05:20,190 --> 00:05:28,680
offer ok well we have quite a few

101
00:05:25,889 --> 00:05:32,009
sources we have documents with media

102
00:05:28,680 --> 00:05:36,750
material patents which in this case was

103
00:05:32,009 --> 00:05:38,460
very very important then we have reverse

104
00:05:36,750 --> 00:05:41,159
engineering because we have the binaries

105
00:05:38,460 --> 00:05:43,469
we have the framework so there is no

106
00:05:41,159 --> 00:05:49,710
auction order the reverse in the the

107
00:05:43,469 --> 00:05:51,810
binaries so well obviously the 787's any

108
00:05:49,710 --> 00:05:56,159
other aircraft is a very complex system

109
00:05:51,810 --> 00:06:00,710
but just put into context let's try to

110
00:05:56,159 --> 00:06:04,199
really explain at least a couple of

111
00:06:00,710 --> 00:06:08,580
questions or concepts about this

112
00:06:04,199 --> 00:06:13,710
aircraft or many others so basically we

113
00:06:08,580 --> 00:06:18,210
can say that the 787 we have a component

114
00:06:13,710 --> 00:06:21,388
of system that is the Avion it's the

115
00:06:18,210 --> 00:06:24,960
core of the of the aircraft that is

116
00:06:21,389 --> 00:06:27,599
certified it supports the common

117
00:06:24,960 --> 00:06:29,580
standards for Munich's and then we have

118
00:06:27,599 --> 00:06:29,878
the core network of innate but these

119
00:06:29,580 --> 00:06:34,139
know

120
00:06:29,879 --> 00:06:36,179
it's not certified it we will see later

121
00:06:34,139 --> 00:06:40,800
on so basically in the common core

122
00:06:36,179 --> 00:06:43,649
system which is the approach born used

123
00:06:40,800 --> 00:06:46,679
for the integrative integrated modular

124
00:06:43,649 --> 00:06:49,520
architecture we have the general

125
00:06:46,679 --> 00:06:53,089
processing modules which are basically

126
00:06:49,520 --> 00:06:56,339
all these modules have the same

127
00:06:53,089 --> 00:06:57,929
operating system but they are running

128
00:06:56,339 --> 00:07:00,179
different they are running different

129
00:06:57,929 --> 00:07:02,429
applications we have remote data

130
00:07:00,179 --> 00:07:04,580
concentrators and we have the avionics

131
00:07:02,429 --> 00:07:08,248
Network we were talking about which is

132
00:07:04,580 --> 00:07:12,029
based on internet but it's adequated

133
00:07:08,249 --> 00:07:14,249
it has been modified to support avionics

134
00:07:12,029 --> 00:07:18,808
operation so it's quite complex

135
00:07:14,249 --> 00:07:21,629
it contains different different

136
00:07:18,809 --> 00:07:26,309
functionalities not obviously the

137
00:07:21,629 --> 00:07:30,419
regular networks we are used to don't

138
00:07:26,309 --> 00:07:34,409
contain it's important to say that it's

139
00:07:30,419 --> 00:07:38,369
a brittle since system basically the

140
00:07:34,409 --> 00:07:41,159
they are using the X words C's 5 3 which

141
00:07:38,369 --> 00:07:44,699
is a type 1 hypervisor it's a bare-metal

142
00:07:41,159 --> 00:07:47,099
hypervisor are on top of that they are

143
00:07:44,699 --> 00:07:49,469
running different partitions with

144
00:07:47,099 --> 00:07:55,139
contain different applications with

145
00:07:49,469 --> 00:07:59,399
different criticality so that's the

146
00:07:55,139 --> 00:08:02,789
platform if we take all those elements

147
00:07:59,399 --> 00:08:05,699
and we all together in a cabinet we have

148
00:08:02,789 --> 00:08:10,889
the common computing resource cabinet in

149
00:08:05,699 --> 00:08:13,619
which contains these these modules will

150
00:08:10,889 --> 00:08:19,559
see later on but it's important to note

151
00:08:13,619 --> 00:08:23,279
that these are the the cabinets that are

152
00:08:19,559 --> 00:08:26,279
running the core functionality of the of

153
00:08:23,279 --> 00:08:28,860
the aircraft the Bionics part they're

154
00:08:26,279 --> 00:08:31,459
basically the functionality or the

155
00:08:28,860 --> 00:08:35,099
functions that keep the aircraft flying

156
00:08:31,459 --> 00:08:39,029
we have this is some some of the some of

157
00:08:35,099 --> 00:08:40,950
the hosted functions we also have remote

158
00:08:39,029 --> 00:08:45,480
data concentrators

159
00:08:40,950 --> 00:08:48,630
of on board aircraft they are they have

160
00:08:45,480 --> 00:08:53,730
steel some sensors some actuators that

161
00:08:48,630 --> 00:08:58,110
are not enabled to speak are in 60s for

162
00:08:53,730 --> 00:09:02,400
so they use all masses or they use

163
00:08:58,110 --> 00:09:06,210
compass so they have to the house of

164
00:09:02,400 --> 00:09:10,230
questions can talk to those devices to

165
00:09:06,210 --> 00:09:12,570
those sensors so we need a way to to

166
00:09:10,230 --> 00:09:16,040
talk to those sensors and this is the

167
00:09:12,570 --> 00:09:19,170
way they remote made the concentrator

168
00:09:16,040 --> 00:09:23,520
here you can see an overview of the

169
00:09:19,170 --> 00:09:26,130
Boeing 777 and the different network

170
00:09:23,520 --> 00:09:27,870
from a high level perspective so we have

171
00:09:26,130 --> 00:09:30,510
the common data network which is the

172
00:09:27,870 --> 00:09:33,540
avionics Network where everything

173
00:09:30,510 --> 00:09:37,439
important is connected to its a high

174
00:09:33,540 --> 00:09:39,839
integrity network the airplane systems

175
00:09:37,440 --> 00:09:43,500
are connected to this network then we

176
00:09:39,840 --> 00:09:45,630
have some remote network switches the

177
00:09:43,500 --> 00:09:49,440
remote data concentrators as I mentioned

178
00:09:45,630 --> 00:09:53,820
then we have a home set of sensors

179
00:09:49,440 --> 00:09:55,770
actuators effectors and then we have the

180
00:09:53,820 --> 00:09:59,810
core network coming it which is

181
00:09:55,770 --> 00:10:04,490
basically a window to the internal core

182
00:09:59,810 --> 00:10:07,530
system from the of the Boeing 787 if we

183
00:10:04,490 --> 00:10:11,730
oversimplify it's like a a way to

184
00:10:07,530 --> 00:10:15,150
interface with the outside world for the

185
00:10:11,730 --> 00:10:18,000
787 this is a picture of the actual core

186
00:10:15,150 --> 00:10:20,010
network coming it and it's as I mention

187
00:10:18,000 --> 00:10:22,710
it's the interface between the outside

188
00:10:20,010 --> 00:10:28,530
world and the non-critical domains and

189
00:10:22,710 --> 00:10:30,990
the and the common core system so there

190
00:10:28,530 --> 00:10:33,270
are different modules not all of them

191
00:10:30,990 --> 00:10:35,580
are in the scope of the of these

192
00:10:33,270 --> 00:10:39,290
research because basically we don't need

193
00:10:35,580 --> 00:10:43,170
all of them to compromise this this

194
00:10:39,290 --> 00:10:46,199
device and bypass the security

195
00:10:43,170 --> 00:10:48,300
boundaries we need to bypass in order to

196
00:10:46,200 --> 00:10:53,190
reach the common data network which is

197
00:10:48,300 --> 00:10:55,620
our role so

198
00:10:53,190 --> 00:10:58,500
the proven formation service the crew

199
00:10:55,620 --> 00:11:01,350
information system which is which is the

200
00:10:58,500 --> 00:11:04,950
the system that is implemented in the

201
00:11:01,350 --> 00:11:08,400
coordinate were coming at is comprised

202
00:11:04,950 --> 00:11:10,590
of three network or it's handling data

203
00:11:08,400 --> 00:11:13,319
from three different networks we have

204
00:11:10,590 --> 00:11:17,090
the open data network where all non

205
00:11:13,320 --> 00:11:18,810
critical aircraft domains aircraft

206
00:11:17,090 --> 00:11:20,580
devices are connected

207
00:11:18,810 --> 00:11:22,709
for example the in-flight and redundant

208
00:11:20,580 --> 00:11:26,940
system everything tell it's not secure

209
00:11:22,710 --> 00:11:28,830
or not it's potentially hostile it's

210
00:11:26,940 --> 00:11:31,080
going to be connected to the ODN and

211
00:11:28,830 --> 00:11:34,770
then we have the ID n which is the

212
00:11:31,080 --> 00:11:37,230
isolated later network which is where

213
00:11:34,770 --> 00:11:39,810
some devices that are considered secure

214
00:11:37,230 --> 00:11:41,690
are connected but they are not strictly

215
00:11:39,810 --> 00:11:44,819
related to the safety of the aircraft

216
00:11:41,690 --> 00:11:50,690
for example the black box after of the

217
00:11:44,820 --> 00:11:56,130
aircraft the walls and data recorder or

218
00:11:50,690 --> 00:11:58,050
the electronic fly back and then we have

219
00:11:56,130 --> 00:12:07,650
the common data network which is the

220
00:11:58,050 --> 00:12:11,880
high integrity network and the airplane

221
00:12:07,650 --> 00:12:16,920
systems are connected to and then the

222
00:12:11,880 --> 00:12:20,550
modules that comprise the true

223
00:12:16,920 --> 00:12:22,640
information system are the following we

224
00:12:20,550 --> 00:12:25,650
have the crew information system

225
00:12:22,640 --> 00:12:30,090
maintenance system file server module

226
00:12:25,650 --> 00:12:33,060
which is running a vxworks 6.2 and it's

227
00:12:30,090 --> 00:12:35,460
not certified vxworks it's a regular

228
00:12:33,060 --> 00:12:40,500
vxworks so it's not intended to be

229
00:12:35,460 --> 00:12:43,980
running on a certified avionics system

230
00:12:40,500 --> 00:12:47,720
it's a commercial of the wall commercial

231
00:12:43,980 --> 00:12:50,340
of the self board based on a Pentium M

232
00:12:47,720 --> 00:12:53,730
CPU the vxworks

233
00:12:50,340 --> 00:12:55,560
supports a real time processes so

234
00:12:53,730 --> 00:12:58,860
basically we have a user mode and kernel

235
00:12:55,560 --> 00:13:01,459
mode and on the user mode side we have

236
00:12:58,860 --> 00:13:04,800
these real time processes which are

237
00:13:01,460 --> 00:13:07,079
which are the functionalities that are

238
00:13:04,800 --> 00:13:10,498
in the in the pure information system

239
00:13:07,079 --> 00:13:13,939
then we have the ethernet gateway module

240
00:13:10,499 --> 00:13:20,360
which is a Linux embedded device

241
00:13:13,939 --> 00:13:22,439
basically you have any other particular

242
00:13:20,360 --> 00:13:25,410
characteristic and then we have the

243
00:13:22,439 --> 00:13:31,439
network interface module which is the

244
00:13:25,410 --> 00:13:33,988
end system for darling c64 so what's the

245
00:13:31,439 --> 00:13:36,959
attack surface of the core network

246
00:13:33,989 --> 00:13:42,089
coming yet okay so basically if we go to

247
00:13:36,959 --> 00:13:44,579
the US patent that one that patent

248
00:13:42,089 --> 00:13:46,470
basically covers the entire system we

249
00:13:44,579 --> 00:13:49,229
are talking about and it was really

250
00:13:46,470 --> 00:13:51,809
helpful to try to understand the whole

251
00:13:49,230 --> 00:13:55,110
picture of the system and as you can see

252
00:13:51,809 --> 00:13:57,449
here they insist these modules are

253
00:13:55,110 --> 00:14:00,029
providing the segregation between the

254
00:13:57,449 --> 00:14:05,189
network devices in the idea the isolated

255
00:14:00,029 --> 00:14:09,089
data network I'm the CDN so obviously if

256
00:14:05,189 --> 00:14:11,790
we can bypass the security boundaries of

257
00:14:09,089 --> 00:14:14,429
those devices of those modules we can

258
00:14:11,790 --> 00:14:17,269
reach the CDN so this is basically the

259
00:14:14,429 --> 00:14:21,509
security boundaries we're talking about

260
00:14:17,269 --> 00:14:22,920
we start on the all the end where for

261
00:14:21,509 --> 00:14:27,029
example in flight and the timing system

262
00:14:22,920 --> 00:14:29,998
is located so what what are the security

263
00:14:27,029 --> 00:14:32,970
boundaries starting at that point we

264
00:14:29,999 --> 00:14:36,379
have the idiom the Internet gateway

265
00:14:32,970 --> 00:14:39,480
module which is implemented a firewall

266
00:14:36,379 --> 00:14:41,970
with basically IP tables and a set of

267
00:14:39,480 --> 00:14:44,189
rules and then we have the crew

268
00:14:41,970 --> 00:14:47,669
information system maintenance system

269
00:14:44,189 --> 00:14:50,029
module which is running vxworks and it's

270
00:14:47,669 --> 00:14:54,540
implementing also a packet filter

271
00:14:50,029 --> 00:14:58,019
functionality and with the framework F

272
00:14:54,540 --> 00:15:01,160
now will you believe which is custom for

273
00:14:58,019 --> 00:15:03,720
for vxworks and then finally we have the

274
00:15:01,160 --> 00:15:08,279
network interface module which is the N

275
00:15:03,720 --> 00:15:13,049
system for the Erik 64 and this is the

276
00:15:08,279 --> 00:15:16,330
last security boundary so this is this

277
00:15:13,049 --> 00:15:19,480
is basically configured through

278
00:15:16,330 --> 00:15:24,790
this proprietary binary file which is

279
00:15:19,480 --> 00:15:27,330
generated we - that is certified as

280
00:15:24,790 --> 00:15:30,670
level a which is the highest

281
00:15:27,330 --> 00:15:37,150
certification for software assurance in

282
00:15:30,670 --> 00:15:39,760
avionics so the base of the common

283
00:15:37,150 --> 00:15:42,699
attack scenario for for for this

284
00:15:39,760 --> 00:15:49,090
architecture would be as follows we

285
00:15:42,700 --> 00:15:54,010
start only odn we potentially find a

286
00:15:49,090 --> 00:15:56,740
rule that it's allowing us into the crew

287
00:15:54,010 --> 00:15:59,500
information system then we have to

288
00:15:56,740 --> 00:16:02,500
exploit the crew information system to

289
00:15:59,500 --> 00:16:06,040
gain remote code execution and from

290
00:16:02,500 --> 00:16:08,740
there you can see we can jump to the

291
00:16:06,040 --> 00:16:13,240
network interface module I'm from there

292
00:16:08,740 --> 00:16:15,670
we are just one step from the from the

293
00:16:13,240 --> 00:16:20,410
CDN and that's transparent for the

294
00:16:15,670 --> 00:16:22,750
attacker so once we are going to talk

295
00:16:20,410 --> 00:16:24,760
about that later on but once we reach

296
00:16:22,750 --> 00:16:27,970
the network interface module which is

297
00:16:24,760 --> 00:16:32,260
the last device between the before the

298
00:16:27,970 --> 00:16:36,220
avionics network we have to find the

299
00:16:32,260 --> 00:16:38,080
rules that allow us into the CDN because

300
00:16:36,220 --> 00:16:43,030
it's not possible to reach all the

301
00:16:38,080 --> 00:16:45,760
avionics now that are connected so this

302
00:16:43,030 --> 00:16:49,420
is not external here we have the regular

303
00:16:45,760 --> 00:16:53,760
flow basically this is the way the

304
00:16:49,420 --> 00:16:58,390
system has been designed the some

305
00:16:53,760 --> 00:17:01,540
operations some devices require access

306
00:16:58,390 --> 00:17:06,339
to certain functionality in the common

307
00:17:01,540 --> 00:17:09,129
core system they go through the regular

308
00:17:06,339 --> 00:17:11,708
flow through the EDL going through the

309
00:17:09,130 --> 00:17:15,130
boundary router or the two information

310
00:17:11,709 --> 00:17:19,000
system and they're not in the

311
00:17:15,130 --> 00:17:23,770
CDN and the common core system okay so

312
00:17:19,000 --> 00:17:27,069
what are we doing we are taking an

313
00:17:23,770 --> 00:17:31,830
alternative approach we'll start on the

314
00:17:27,069 --> 00:17:34,690
ODN we go through the EDM by using

315
00:17:31,830 --> 00:17:38,799
firewall rule if we can find any and

316
00:17:34,690 --> 00:17:41,380
then we exploit any network service that

317
00:17:38,799 --> 00:17:43,330
is running on the information system and

318
00:17:41,380 --> 00:17:45,549
then we take control of the crew

319
00:17:43,330 --> 00:17:48,210
information systems from there we can go

320
00:17:45,549 --> 00:17:50,320
to the ID and switch from there we can

321
00:17:48,210 --> 00:17:53,919
according to their rules that are being

322
00:17:50,320 --> 00:17:57,189
implemented in the mean and system we

323
00:17:53,919 --> 00:18:00,370
can move to the CDN switch from there

324
00:17:57,190 --> 00:18:08,020
today to the to the common core system

325
00:18:00,370 --> 00:18:10,270
or other other other views so our task

326
00:18:08,020 --> 00:18:12,190
here is to find a way to exploit

327
00:18:10,270 --> 00:18:15,370
something in the true information system

328
00:18:12,190 --> 00:18:18,730
this is how the framework is organized

329
00:18:15,370 --> 00:18:22,659
so we have the vxworks kernel then we

330
00:18:18,730 --> 00:18:26,380
have the user mode where we have for up

331
00:18:22,660 --> 00:18:30,720
to 14 real time processes and those

332
00:18:26,380 --> 00:18:36,130
real-time processes are serving up to 15

333
00:18:30,720 --> 00:18:39,730
cert libraries including Lib C which I

334
00:18:36,130 --> 00:18:43,720
think it's not there but yeah they

335
00:18:39,730 --> 00:18:46,299
compiled a specifically C version for

336
00:18:43,720 --> 00:18:48,370
for vxworks this is important for a

337
00:18:46,299 --> 00:18:53,500
question and we are going to talk about

338
00:18:48,370 --> 00:18:58,059
later on so some vulnerabilities that I

339
00:18:53,500 --> 00:19:03,549
could find here hundreds of references

340
00:18:58,059 --> 00:19:06,418
to insecure functions in 2019 a sprint

341
00:19:03,549 --> 00:19:08,918
string Coffee string card on the set

342
00:19:06,419 --> 00:19:11,590
integral over flows buffer overflows and

343
00:19:08,919 --> 00:19:14,350
I love service memory corruption of the

344
00:19:11,590 --> 00:19:19,389
bound read and write everything it's

345
00:19:14,350 --> 00:19:21,850
it's there basically so I'm not talking

346
00:19:19,390 --> 00:19:24,880
about all the vulnerabilities here we

347
00:19:21,850 --> 00:19:26,169
are just going to document a minimal

348
00:19:24,880 --> 00:19:29,800
shed of

349
00:19:26,170 --> 00:19:32,740
this not allow the seeds to be

350
00:19:29,800 --> 00:19:36,460
compromised so in that way we know that

351
00:19:32,740 --> 00:19:39,640
we really use those vulnerabilities we

352
00:19:36,460 --> 00:19:42,820
can compromise the seeds and reach the

353
00:19:39,640 --> 00:19:45,520
part of the network we want basically we

354
00:19:42,820 --> 00:19:48,310
have we are going to explain remote code

355
00:19:45,520 --> 00:19:53,650
execution and privilege escalation to

356
00:19:48,310 --> 00:19:57,820
the kernel so the first one remember

357
00:19:53,650 --> 00:20:00,880
that we had to find a rule in the idiom

358
00:19:57,820 --> 00:20:04,149
that allowed us access to our network

359
00:20:00,880 --> 00:20:08,830
server or network services service

360
00:20:04,150 --> 00:20:12,190
exposed exposed by disease so there is

361
00:20:08,830 --> 00:20:14,889
one the FTS manager which is

362
00:20:12,190 --> 00:20:21,600
implementing some file transfer services

363
00:20:14,890 --> 00:20:26,190
an ftp TFTP server basically performs

364
00:20:21,600 --> 00:20:29,889
the following operation there is its

365
00:20:26,190 --> 00:20:33,730
exclusion info for the ftp connections

366
00:20:29,890 --> 00:20:41,130
on different ports one of them it's it's

367
00:20:33,730 --> 00:20:41,130
allowed from the p.m. the part is the

368
00:20:42,000 --> 00:20:51,190
16160 five basically they are receiving

369
00:20:47,260 --> 00:20:53,020
the request of 200 bytes and they are

370
00:20:51,190 --> 00:20:56,200
taking their first bytes which is the

371
00:20:53,020 --> 00:21:00,990
TFTP opcode operation and they are using

372
00:20:56,200 --> 00:21:04,390
that index into an array of of

373
00:21:00,990 --> 00:21:08,890
operations just to you can see to

374
00:21:04,390 --> 00:21:11,980
generate a logger so how we can exploit

375
00:21:08,890 --> 00:21:16,300
these there is there is a problem here

376
00:21:11,980 --> 00:21:19,060
because they the server is only

377
00:21:16,300 --> 00:21:24,370
receiving 200 bytes but on the other

378
00:21:19,060 --> 00:21:26,230
hand and they and the log buffer is 4400

379
00:21:24,370 --> 00:21:30,429
bytes so we don't have enough

380
00:21:26,230 --> 00:21:34,060
information of content to overflow the

381
00:21:30,430 --> 00:21:37,510
buffer so we have to wait we have to

382
00:21:34,060 --> 00:21:39,260
find a way to find a stream that is long

383
00:21:37,510 --> 00:21:42,890
enough

384
00:21:39,260 --> 00:21:46,610
we can use the opcode index to find that

385
00:21:42,890 --> 00:21:49,520
data stream basically as you can see

386
00:21:46,610 --> 00:21:54,379
here in this operation we can reference

387
00:21:49,520 --> 00:21:58,580
any stream in this in this range which

388
00:21:54,380 --> 00:22:02,240
covers part of the data section and part

389
00:21:58,580 --> 00:22:08,418
of the BSS and analysis of those

390
00:22:02,240 --> 00:22:11,570
sections it's several targets targets

391
00:22:08,419 --> 00:22:14,590
not can be used to obtain a large a

392
00:22:11,570 --> 00:22:18,439
large enough stream that can be used to

393
00:22:14,590 --> 00:22:26,389
overflow the buffer I'm going execute on

394
00:22:18,440 --> 00:22:29,240
getting remote code execution so you can

395
00:22:26,390 --> 00:22:32,059
see here part of the rule or the rule

396
00:22:29,240 --> 00:22:35,840
that allows this kind of traffic this

397
00:22:32,059 --> 00:22:40,309
comes from the file s turn for a DM

398
00:22:35,840 --> 00:22:43,639
config which is the official file and

399
00:22:40,309 --> 00:22:46,549
you can see how this traffic is allowed

400
00:22:43,640 --> 00:22:50,809
we have the inside and determine system

401
00:22:46,549 --> 00:22:52,850
router which is at the Audion the 40.2

402
00:22:50,809 --> 00:22:56,809
and then we have the two information

403
00:22:52,850 --> 00:23:01,820
system which is the system that we are

404
00:22:56,809 --> 00:23:07,820
exploiting at in the IDN and you can see

405
00:23:01,820 --> 00:23:10,189
how it's allowed so also in the in the

406
00:23:07,820 --> 00:23:15,350
network interface module boundary router

407
00:23:10,190 --> 00:23:18,770
we find the same rule so basically in

408
00:23:15,350 --> 00:23:20,090
the in the boundary router of the index

409
00:23:18,770 --> 00:23:25,190
or in the file

410
00:23:20,090 --> 00:23:30,168
yeah a config not accept mail boy or

411
00:23:25,190 --> 00:23:34,220
well Honeywell or the the the

412
00:23:30,169 --> 00:23:39,260
manufacturers of this system are sitting

413
00:23:34,220 --> 00:23:42,320
or are configuring the rules that allow

414
00:23:39,260 --> 00:23:45,770
two things the communication between the

415
00:23:42,320 --> 00:23:48,260
ADM and the boundary router and the

416
00:23:45,770 --> 00:23:50,620
communication between the name and the

417
00:23:48,260 --> 00:23:53,600
CDN

418
00:23:50,620 --> 00:23:56,629
so this is the duck scenario for this

419
00:23:53,600 --> 00:23:58,790
exploit basically so far we have for

420
00:23:56,630 --> 00:24:01,010
example the inside and the diamond

421
00:23:58,790 --> 00:24:04,129
system router which has been compromised

422
00:24:01,010 --> 00:24:07,430
in other talks we have seen how to do

423
00:24:04,130 --> 00:24:10,580
that in past years talk i presented how

424
00:24:07,430 --> 00:24:14,390
to access the inside and determine

425
00:24:10,580 --> 00:24:16,879
network from the ground through

426
00:24:14,390 --> 00:24:19,390
satellite the communication device so

427
00:24:16,880 --> 00:24:22,460
it's something not can be done obviously

428
00:24:19,390 --> 00:24:25,610
and we go through the EDM you see the

429
00:24:22,460 --> 00:24:28,130
rule that we have seen and we exploit

430
00:24:25,610 --> 00:24:31,419
the network service that is running and

431
00:24:28,130 --> 00:24:36,350
it's vulnerable then we compromise it

432
00:24:31,420 --> 00:24:39,110
system I reach the network interface

433
00:24:36,350 --> 00:24:45,320
module let's move to another

434
00:24:39,110 --> 00:24:50,629
vulnerability in this case it's not a an

435
00:24:45,320 --> 00:24:54,080
insecure function it's just another

436
00:24:50,630 --> 00:24:58,900
vulnerability pattern so this is located

437
00:24:54,080 --> 00:25:02,080
in these noodles but we can we can

438
00:24:58,900 --> 00:25:04,160
exercise the vulnerable function but for

439
00:25:02,080 --> 00:25:06,919
from the audience

440
00:25:04,160 --> 00:25:09,350
which is the board data loading function

441
00:25:06,920 --> 00:25:11,630
which is one of the functionalities the

442
00:25:09,350 --> 00:25:15,469
coordinate were coming it is reporting

443
00:25:11,630 --> 00:25:19,250
which is allowing the technicians or

444
00:25:15,470 --> 00:25:24,140
allowing the airlines or going to put

445
00:25:19,250 --> 00:25:29,120
chamber updates to the aircraft so you

446
00:25:24,140 --> 00:25:32,570
can see the in this case they lose a

447
00:25:29,120 --> 00:25:35,810
loose file is a part of the TFT be a

448
00:25:32,570 --> 00:25:38,689
part of the RM six one five protocol

449
00:25:35,810 --> 00:25:41,720
which is our standard better set which

450
00:25:38,690 --> 00:25:45,440
is based on TFTP and it's used or in

451
00:25:41,720 --> 00:25:50,180
avionics to upload anything were to to

452
00:25:45,440 --> 00:25:52,810
line we preserve all units so this the

453
00:25:50,180 --> 00:25:56,900
attacker is controlling this file and

454
00:25:52,810 --> 00:25:59,179
the library is trusting the contents of

455
00:25:56,900 --> 00:26:02,120
this file so we can

456
00:25:59,180 --> 00:26:07,100
control the number of the number of

457
00:26:02,120 --> 00:26:10,550
years and then there is a for loop where

458
00:26:07,100 --> 00:26:14,629
they are using the number of years as an

459
00:26:10,550 --> 00:26:18,350
index into a fixed array of structures

460
00:26:14,630 --> 00:26:22,580
that is located in the stack so again we

461
00:26:18,350 --> 00:26:26,770
can overflow the stock and overwrite the

462
00:26:22,580 --> 00:26:33,649
memory in a controlled way we can

463
00:26:26,770 --> 00:26:36,200
control the distribution and this can be

464
00:26:33,650 --> 00:26:41,090
exercised from remote you don't need to

465
00:26:36,200 --> 00:26:43,960
be authenticated as another one or it is

466
00:26:41,090 --> 00:26:47,750
similar to the previous one in a lower

467
00:26:43,960 --> 00:26:52,610
file that is part also of the are in six

468
00:26:47,750 --> 00:26:56,059
one five in this case is the FIA's FSM

469
00:26:52,610 --> 00:26:59,178
target load which is the functionality

470
00:26:56,059 --> 00:27:02,030
which is loading updating the firmware

471
00:26:59,179 --> 00:27:04,940
for the own file server module for the

472
00:27:02,030 --> 00:27:09,139
own crew information system file server

473
00:27:04,940 --> 00:27:11,870
module in this case the dependency here

474
00:27:09,140 --> 00:27:17,809
again the attacker is controlling the

475
00:27:11,870 --> 00:27:22,669
load the luh fine we can control the

476
00:27:17,809 --> 00:27:26,149
load part number length and then there

477
00:27:22,670 --> 00:27:29,120
is a loop where we can overwrite the

478
00:27:26,150 --> 00:27:34,190
stuck with control values and again we

479
00:27:29,120 --> 00:27:38,330
can control the execution of the of the

480
00:27:34,190 --> 00:27:42,679
code again it can be exploited model

481
00:27:38,330 --> 00:27:44,960
without being authenticated ok so we

482
00:27:42,679 --> 00:27:47,960
have three different vulnerabilities to

483
00:27:44,960 --> 00:27:50,690
gain remote code execution and then we

484
00:27:47,960 --> 00:27:54,620
have to find a way to stall a privilege

485
00:27:50,690 --> 00:27:56,530
to kernel without needing to reboot the

486
00:27:54,620 --> 00:28:01,399
device which is obviously obviously

487
00:27:56,530 --> 00:28:03,760
delay and the less the most interesting

488
00:28:01,400 --> 00:28:09,290
option is always to escalate privileges

489
00:28:03,760 --> 00:28:11,010
without rebooting the system so I was

490
00:28:09,290 --> 00:28:14,879
analyzing the kernel

491
00:28:11,010 --> 00:28:18,450
the Honeywell which is the the company

492
00:28:14,880 --> 00:28:22,380
that develops this framework created a

493
00:28:18,450 --> 00:28:26,910
new group of system calls for the shared

494
00:28:22,380 --> 00:28:30,300
libraries you can reach adult system

495
00:28:26,910 --> 00:28:33,570
codes you seen a Colgate so I was

496
00:28:30,300 --> 00:28:37,710
analyzing those three schools basically

497
00:28:33,570 --> 00:28:40,230
they are not validating anything so you

498
00:28:37,710 --> 00:28:44,300
can't read or write arbitrary memory

499
00:28:40,230 --> 00:28:46,530
they are also using insecure functions

500
00:28:44,300 --> 00:28:51,030
pretty much the same time in the other

501
00:28:46,530 --> 00:28:56,250
binaries there is an interesting Cisco

502
00:28:51,030 --> 00:29:01,649
which is used by the by the real time

503
00:28:56,250 --> 00:29:03,240
processes to dynamically to the firewall

504
00:29:01,650 --> 00:29:06,330
that is implemented in the true

505
00:29:03,240 --> 00:29:09,510
information system and this is used to

506
00:29:06,330 --> 00:29:13,620
unblock city and access during the

507
00:29:09,510 --> 00:29:17,060
exploitation phase so you can see the

508
00:29:13,620 --> 00:29:21,350
code here the first function is the

509
00:29:17,060 --> 00:29:25,980
system called handler do you see any

510
00:29:21,350 --> 00:29:27,899
verification of the memory no there is

511
00:29:25,980 --> 00:29:32,190
no verification of the memories that's

512
00:29:27,900 --> 00:29:36,840
that's the the thing so the next one is

513
00:29:32,190 --> 00:29:39,150
the actual the actual functionality and

514
00:29:36,840 --> 00:29:42,929
you can see that well they are using

515
00:29:39,150 --> 00:29:46,560
also explain everything so obviously

516
00:29:42,930 --> 00:29:49,170
there are many ways to to ascribe

517
00:29:46,560 --> 00:29:51,419
privileges using these system calls

518
00:29:49,170 --> 00:29:53,880
basically in any of the system calls

519
00:29:51,420 --> 00:29:58,140
they are performing validation so it's

520
00:29:53,880 --> 00:30:03,270
yes you just need to to choose the one

521
00:29:58,140 --> 00:30:07,200
you want so again back to the attack

522
00:30:03,270 --> 00:30:11,850
scenario we are going to update a little

523
00:30:07,200 --> 00:30:15,300
bit from odn to CDN we have again our

524
00:30:11,850 --> 00:30:17,189
analysis flow an attacker is starting

525
00:30:15,300 --> 00:30:19,960
from the in-flight entertainment system

526
00:30:17,190 --> 00:30:22,870
router which has been compromised then

527
00:30:19,960 --> 00:30:25,510
exploited the crew information system it

528
00:30:22,870 --> 00:30:31,120
has been compromised and then we reach

529
00:30:25,510 --> 00:30:33,970
the network interface model as I

530
00:30:31,120 --> 00:30:37,989
mentioned before we have the insistence

531
00:30:33,970 --> 00:30:40,930
that is controlling when how and who can

532
00:30:37,990 --> 00:30:46,480
send or receive information from the

533
00:30:40,930 --> 00:30:50,580
from from the RN successful Network the

534
00:30:46,480 --> 00:30:53,560
last part is to find a way to leverage

535
00:30:50,580 --> 00:30:56,830
our access to the avionics network

536
00:30:53,560 --> 00:30:58,690
because at this point even if we can

537
00:30:56,830 --> 00:31:01,419
access the avionics Network it doesn't

538
00:30:58,690 --> 00:31:04,360
mean we can't reach we can do anything

539
00:31:01,420 --> 00:31:07,240
it depends on the end system in the

540
00:31:04,360 --> 00:31:10,260
network interface module so this is a

541
00:31:07,240 --> 00:31:12,370
potential attack scenario for the

542
00:31:10,260 --> 00:31:14,860
in-flight entertainment system to the

543
00:31:12,370 --> 00:31:18,760
CDN basically what we have been

544
00:31:14,860 --> 00:31:21,729
describing second attack scenario it's

545
00:31:18,760 --> 00:31:27,490
from an arbitrary line replacement you

546
00:31:21,730 --> 00:31:29,620
need to CDN this is similar because we

547
00:31:27,490 --> 00:31:32,530
have to understand that the audio

548
00:31:29,620 --> 00:31:35,649
function functionality that allows to

549
00:31:32,530 --> 00:31:39,879
update the firmware to to these other

550
00:31:35,650 --> 00:31:43,900
views can be used to exploit the crew

551
00:31:39,880 --> 00:31:47,020
information system so imagine that we

552
00:31:43,900 --> 00:31:49,600
have compromised our view that this is

553
00:31:47,020 --> 00:31:54,070
going to receive new framework we can

554
00:31:49,600 --> 00:31:58,149
trigger the exploit against the updater

555
00:31:54,070 --> 00:32:01,060
in that way we can have access to the to

556
00:31:58,150 --> 00:32:05,440
the information system the idea and

557
00:32:01,060 --> 00:32:07,409
eventually the city the CDN there are

558
00:32:05,440 --> 00:32:10,840
other potential scenarios for example

559
00:32:07,410 --> 00:32:15,280
many of you probably know that there are

560
00:32:10,840 --> 00:32:17,889
emergency lighting systems in in the

561
00:32:15,280 --> 00:32:22,090
aircraft but maybe you don't know that

562
00:32:17,890 --> 00:32:25,210
these are running some protocol wireless

563
00:32:22,090 --> 00:32:29,530
protocols so that's also an option in

564
00:32:25,210 --> 00:32:31,270
this case this is one one oh this is a

565
00:32:29,530 --> 00:32:34,428
reduction area with

566
00:32:31,270 --> 00:32:36,980
elaborated we didn't elaborate we don't

567
00:32:34,429 --> 00:32:39,940
know if not a specific product contains

568
00:32:36,980 --> 00:32:44,809
vulnerabilities or not we are just

569
00:32:39,940 --> 00:32:47,270
potentially illustrating an example in

570
00:32:44,809 --> 00:32:48,649
this case the importat occur that is

571
00:32:47,270 --> 00:32:51,879
able to compromise the wireless

572
00:32:48,650 --> 00:32:55,760
controller unit of that specific product

573
00:32:51,880 --> 00:32:58,520
can wait until again the audio

574
00:32:55,760 --> 00:33:01,879
functionality will use a firmware update

575
00:32:58,520 --> 00:33:05,330
to the two that are you and then again

576
00:33:01,880 --> 00:33:11,240
we trigger the exploit against the audio

577
00:33:05,330 --> 00:33:13,549
less you can see again the rule that is

578
00:33:11,240 --> 00:33:16,640
allowing this kind of connection which

579
00:33:13,549 --> 00:33:20,059
is important to mention because of the

580
00:33:16,640 --> 00:33:23,049
things I have been reading in the in the

581
00:33:20,059 --> 00:33:23,049
press really

582
00:33:23,980 --> 00:33:30,890
another option is this negative three

583
00:33:26,360 --> 00:33:33,639
which is an external network to CDN this

584
00:33:30,890 --> 00:33:37,340
is probably another worst case scenario

585
00:33:33,640 --> 00:33:40,490
the the 77 supports different

586
00:33:37,340 --> 00:33:42,649
communication links SATCOM or cellular

587
00:33:40,490 --> 00:33:46,299
or what it's called

588
00:33:42,650 --> 00:33:49,580
gatling 8 2 2 which basically it's a

589
00:33:46,299 --> 00:33:54,440
wireless infrastructure not it's located

590
00:33:49,580 --> 00:33:59,990
on the airports every every airport

591
00:33:54,440 --> 00:34:02,780
almost so when the 787 runs and goes to

592
00:33:59,990 --> 00:34:05,030
the gate it connects through the

593
00:34:02,780 --> 00:34:09,020
wireless especially for a specific

594
00:34:05,030 --> 00:34:11,330
wireless the Gatling 8 to do wireless to

595
00:34:09,020 --> 00:34:14,480
a specific server that is configured in

596
00:34:11,330 --> 00:34:21,139
the IND aircraft through a specific file

597
00:34:14,480 --> 00:34:23,330
which is the L the i dot beam so the

598
00:34:21,139 --> 00:34:26,020
external server the Elector of connects

599
00:34:23,330 --> 00:34:29,629
to is what it's called airline L sub

600
00:34:26,020 --> 00:34:32,359
proxy which is basically a server where

601
00:34:29,629 --> 00:34:36,409
the airline the manufacturers or any

602
00:34:32,359 --> 00:34:40,000
other entity can whose finger updates or

603
00:34:36,409 --> 00:34:42,669
compass commands and when

604
00:34:40,000 --> 00:34:45,070
the aircraft connects to the server it

605
00:34:42,668 --> 00:34:50,348
will receive those commands it will

606
00:34:45,070 --> 00:34:54,070
receive those updates or it can send it

607
00:34:50,349 --> 00:34:57,220
can send data out to the remote server

608
00:34:54,070 --> 00:35:02,730
there is a bi-directional communication

609
00:34:57,220 --> 00:35:08,490
between those servers so we discovered

610
00:35:02,730 --> 00:35:12,940
at least two different internet facing

611
00:35:08,490 --> 00:35:16,180
vulnerable sub servers belonging to two

612
00:35:12,940 --> 00:35:19,359
different airlines we notified Boeing

613
00:35:16,180 --> 00:35:22,470
about this and at this point those

614
00:35:19,359 --> 00:35:25,930
servers are no longer available

615
00:35:22,470 --> 00:35:27,580
obviously once you compromise those

616
00:35:25,930 --> 00:35:33,220
servers because they were running

617
00:35:27,580 --> 00:35:36,750
multiple services you would find those

618
00:35:33,220 --> 00:35:39,459
servers using solo so it was pretty easy

619
00:35:36,750 --> 00:35:43,119
you have access to certain functional ID

620
00:35:39,460 --> 00:35:47,920
and you can use this fashion ID to

621
00:35:43,119 --> 00:35:49,990
potentially compromise certain certain

622
00:35:47,920 --> 00:35:52,810
functionalities within the crew

623
00:35:49,990 --> 00:35:56,250
information system also it's important

624
00:35:52,810 --> 00:35:59,020
to know that the gate link may post also

625
00:35:56,250 --> 00:36:02,740
an attack vector in the airport for

626
00:35:59,020 --> 00:36:07,720
example not all the airport's implement

627
00:36:02,740 --> 00:36:10,118
the same way but in the Madrid Airport

628
00:36:07,720 --> 00:36:13,560
you can in the terminal forest you can

629
00:36:10,119 --> 00:36:17,320
see the gaining a two to Wi-Fi

630
00:36:13,560 --> 00:36:21,009
broadcasting all the time you can

631
00:36:17,320 --> 00:36:22,839
obviously still you need certificates to

632
00:36:21,010 --> 00:36:26,470
connect but it's it was interesting

633
00:36:22,839 --> 00:36:28,750
another scenario is the TCU or any other

634
00:36:26,470 --> 00:36:33,189
communication link the Boeing 787

635
00:36:28,750 --> 00:36:37,869
support for example if the if the SATCOM

636
00:36:33,190 --> 00:36:40,749
like we saw Bosnia is espousing the

637
00:36:37,869 --> 00:36:42,849
the connection you can potentially use

638
00:36:40,749 --> 00:36:46,718
their rules that are allowing certain

639
00:36:42,849 --> 00:36:50,439
connection from the TCU to to liberate

640
00:36:46,719 --> 00:36:53,559
certain vulnerabilities like we can see

641
00:36:50,439 --> 00:36:58,839
but it was pretty much the same not the

642
00:36:53,559 --> 00:37:03,039
other scenarios so once we have reached

643
00:36:58,839 --> 00:37:06,369
the CDN the Beyond network what can we

644
00:37:03,039 --> 00:37:07,930
do after that okay so in this case the

645
00:37:06,369 --> 00:37:13,539
configuration files we have been

646
00:37:07,930 --> 00:37:17,769
analyzing basically the how the system

647
00:37:13,539 --> 00:37:21,609
has been has been designed because it's

648
00:37:17,769 --> 00:37:25,508
documented in the patents everywhere you

649
00:37:21,609 --> 00:37:27,459
can write or you can read that in the in

650
00:37:25,509 --> 00:37:30,489
the white paper and you can use this

651
00:37:27,459 --> 00:37:33,669
information to investigate further into

652
00:37:30,489 --> 00:37:37,180
these issues so there are mainly two

653
00:37:33,670 --> 00:37:40,089
options once you you are there you can

654
00:37:37,180 --> 00:37:44,558
initiate a potentially malicious finger

655
00:37:40,089 --> 00:37:47,288
update I can set it critical units this

656
00:37:44,559 --> 00:37:49,179
doesn't mean you can but there is an

657
00:37:47,289 --> 00:37:53,049
option because it's supported by the

658
00:37:49,179 --> 00:37:56,349
system and you also can abuse the

659
00:37:53,049 --> 00:38:00,219
maintenance functionality obviously this

660
00:37:56,349 --> 00:38:02,829
can be used to deceive some maintenance

661
00:38:00,219 --> 00:38:04,630
engineers receiving malicious

662
00:38:02,829 --> 00:38:05,259
information or thinking everything is

663
00:38:04,630 --> 00:38:07,869
correct

664
00:38:05,259 --> 00:38:10,599
maybe it's not there are different

665
00:38:07,869 --> 00:38:13,539
options but it's important do you say we

666
00:38:10,599 --> 00:38:14,140
are not exploiting anything on the

667
00:38:13,539 --> 00:38:17,079
errant

668
00:38:14,140 --> 00:38:20,429
60s for network we are just using the

669
00:38:17,079 --> 00:38:23,130
system in the way it was designed for

670
00:38:20,429 --> 00:38:27,219
this is important also because I'm

671
00:38:23,130 --> 00:38:30,459
reading some claims from Boeing in the

672
00:38:27,219 --> 00:38:35,619
network in the press that don't make

673
00:38:30,459 --> 00:38:38,649
sense to me so what what are those

674
00:38:35,619 --> 00:38:42,189
safety critical systems well there are

675
00:38:38,650 --> 00:38:45,160
21 remote data' concentrators and these

676
00:38:42,189 --> 00:38:48,308
are connecting to the following safety

677
00:38:45,160 --> 00:38:49,029
critical systems which basically some of

678
00:38:48,309 --> 00:38:51,520
them

679
00:38:49,030 --> 00:38:54,040
and most of them are you love the reason

680
00:38:51,520 --> 00:38:57,700
because they are safety-critical if

681
00:38:54,040 --> 00:39:05,200
something fails then the aircraft

682
00:38:57,700 --> 00:39:06,609
leasing in travels this rule to

683
00:39:05,200 --> 00:39:09,189
demonstrate that even suppose will

684
00:39:06,610 --> 00:39:13,390
initiate for example in this case

685
00:39:09,190 --> 00:39:15,250
against a potentially malicious trimmer

686
00:39:13,390 --> 00:39:19,870
an update against the electronic engine

687
00:39:15,250 --> 00:39:26,470
controller is about if you can you can

688
00:39:19,870 --> 00:39:29,980
see the rule that is allow is these this

689
00:39:26,470 --> 00:39:33,790
kind of connection the inci controller

690
00:39:29,980 --> 00:39:36,370
which is 90 from the CDN and then we

691
00:39:33,790 --> 00:39:38,380
have the IP from the idæan which is the

692
00:39:36,370 --> 00:39:41,230
crew formation system which is the

693
00:39:38,380 --> 00:39:45,010
system we can compromise using our

694
00:39:41,230 --> 00:39:49,590
exploits obviously the ftp board the

695
00:39:45,010 --> 00:39:52,750
firmware update is going to be initiated

696
00:39:49,590 --> 00:39:55,480
what about maintenance operations well

697
00:39:52,750 --> 00:39:58,030
there are three different parts of three

698
00:39:55,480 --> 00:40:00,490
different modes for maintenance the

699
00:39:58,030 --> 00:40:04,630
world basically if the maintenance

700
00:40:00,490 --> 00:40:08,529
engineer goes to the Cavender to the

701
00:40:04,630 --> 00:40:12,970
flag deck and connect the laptop to a

702
00:40:08,530 --> 00:40:15,640
ward connection it has to access or he

703
00:40:12,970 --> 00:40:18,879
has he or she has full access to the

704
00:40:15,640 --> 00:40:22,810
maintenance operations but you can also

705
00:40:18,880 --> 00:40:25,810
use the crew wireless LAN unit or the

706
00:40:22,810 --> 00:40:31,509
terminal wireless LAN unit to connect to

707
00:40:25,810 --> 00:40:33,340
the maintance network and through the

708
00:40:31,510 --> 00:40:35,920
wireless you don't have access to

709
00:40:33,340 --> 00:40:38,470
everything you need to an additional

710
00:40:35,920 --> 00:40:41,230
step you you have to enter a code that

711
00:40:38,470 --> 00:40:43,299
we generated in the crew information

712
00:40:41,230 --> 00:40:47,470
system the system now we have

713
00:40:43,300 --> 00:40:51,460
compromised in order to which the cities

714
00:40:47,470 --> 00:40:54,939
are to read all the functionality of the

715
00:40:51,460 --> 00:40:57,970
Mandans operations you can see how the

716
00:40:54,940 --> 00:41:01,150
not code is generated and the

717
00:40:57,970 --> 00:41:02,220
maintenance engineer has to enter this

718
00:41:01,150 --> 00:41:06,890
code three

719
00:41:02,220 --> 00:41:09,930
a coming Interphone which has to has

720
00:41:06,890 --> 00:41:14,069
important implication which is also that

721
00:41:09,930 --> 00:41:19,020
the cabin Interphone may pose a threat

722
00:41:14,070 --> 00:41:23,390
or may post an attack vector because of

723
00:41:19,020 --> 00:41:23,390
the well ever display of seeing

724
00:41:24,030 --> 00:41:30,110
well the maintenance operations the it's

725
00:41:27,690 --> 00:41:38,220
implemented in the common core

726
00:41:30,110 --> 00:41:40,740
resourcing resource carving it I think

727
00:41:38,220 --> 00:41:42,720
I'm a little bit tight in time so I

728
00:41:40,740 --> 00:41:45,720
wanted I really want you to talk about

729
00:41:42,720 --> 00:41:49,680
this about the responsible disclosure

730
00:41:45,720 --> 00:41:53,060
okay so we obviously contact contact

731
00:41:49,680 --> 00:41:55,740
point about this we provided information

732
00:41:53,060 --> 00:41:58,350
all the detailed information about the

733
00:41:55,740 --> 00:42:02,129
varieties boy in our Honeywell confirmed

734
00:41:58,350 --> 00:42:04,410
these vulnerabilities but they didn't

735
00:42:02,130 --> 00:42:07,380
confirm they are exploitable so

736
00:42:04,410 --> 00:42:09,870
basically they say these marriages are

737
00:42:07,380 --> 00:42:11,940
in the current code base of the seven

738
00:42:09,870 --> 00:42:16,589
eight seven core network of innate but

739
00:42:11,940 --> 00:42:19,110
we have done they have done their own

740
00:42:16,590 --> 00:42:23,760
testing and they couldn't reproduce the

741
00:42:19,110 --> 00:42:27,780
issues so they say that this is not

742
00:42:23,760 --> 00:42:30,330
exploitable they also mention that they

743
00:42:27,780 --> 00:42:33,150
have compiled level medications in place

744
00:42:30,330 --> 00:42:36,270
to prevent these vulnerabilities from

745
00:42:33,150 --> 00:42:41,190
being exploited but they didn't provide

746
00:42:36,270 --> 00:42:45,330
any details so what's happened during

747
00:42:41,190 --> 00:42:49,170
the disclosure process so they didn't

748
00:42:45,330 --> 00:42:54,930
cert versions so we the framework we

749
00:42:49,170 --> 00:42:57,810
have they did from 2016 we don't know

750
00:42:54,930 --> 00:43:00,629
the version of the system they have been

751
00:42:57,810 --> 00:43:02,099
testing they didn't serve this

752
00:43:00,630 --> 00:43:05,369
information

753
00:43:02,099 --> 00:43:07,319
and after we requested it several times

754
00:43:05,369 --> 00:43:11,099
because obviously it's an important

755
00:43:07,319 --> 00:43:13,890
thing to try to solve discrepancies if

756
00:43:11,099 --> 00:43:17,249
they say this is not exploitable we say

757
00:43:13,890 --> 00:43:20,808
yes at least we should we should reach

758
00:43:17,249 --> 00:43:23,988
an agreement on the vs they are testing

759
00:43:20,809 --> 00:43:27,299
we also didn't have any visibility over

760
00:43:23,989 --> 00:43:29,069
the testing plan we don't know what kind

761
00:43:27,299 --> 00:43:32,309
of techniques exploitation techniques

762
00:43:29,069 --> 00:43:36,079
the they use or what kind of test they

763
00:43:32,309 --> 00:43:40,589
use or you know anything about this

764
00:43:36,079 --> 00:43:42,720
first of all they asked us to sign an

765
00:43:40,589 --> 00:43:46,380
agreement in order to provide this

766
00:43:42,720 --> 00:43:57,118
information and this women will sign and

767
00:43:46,380 --> 00:44:01,339
they they said no so mitigations so

768
00:43:57,119 --> 00:44:04,109
basically on also according to certain

769
00:44:01,339 --> 00:44:08,609
trends I'm reading on the press right

770
00:44:04,109 --> 00:44:10,799
now Boeing claims not there are certain

771
00:44:08,609 --> 00:44:15,749
mitigation component level mitigations

772
00:44:10,799 --> 00:44:19,670
or network medications not prevent these

773
00:44:15,749 --> 00:44:21,299
bodies from being exploited well

774
00:44:19,670 --> 00:44:25,529
regarding the comparison level

775
00:44:21,299 --> 00:44:28,049
mitigations analyzed the binary so

776
00:44:25,529 --> 00:44:32,489
obviously to see there is any comparable

777
00:44:28,049 --> 00:44:33,960
level mitigation and there's no there is

778
00:44:32,489 --> 00:44:37,499
no comparable level mitigation in

779
00:44:33,960 --> 00:44:41,900
binaries so we ask that maybe those

780
00:44:37,499 --> 00:44:45,450
medications were added later

781
00:44:41,900 --> 00:44:47,789
why declined to answer even this

782
00:44:45,450 --> 00:44:53,399
question and Honeywell is checking this

783
00:44:47,789 --> 00:44:57,309
today so it's fine as well

784
00:44:53,400 --> 00:45:01,209
but there is an additional responsible

785
00:44:57,309 --> 00:45:03,579
which is basically they decided okay i

786
00:45:01,209 --> 00:45:06,519
acting reviewed only one part of the

787
00:45:03,579 --> 00:45:10,839
seventy-seven network using rudiment

788
00:45:06,519 --> 00:45:13,569
itunes so this is I'd approach all of

789
00:45:10,839 --> 00:45:16,599
you now it's pretty rudimentary it's

790
00:45:13,569 --> 00:45:22,259
like hitting the laptop with a rock and

791
00:45:16,599 --> 00:45:25,209
the polarities jump off and that's it

792
00:45:22,259 --> 00:45:28,529
and they also decided how the octave

793
00:45:25,209 --> 00:45:32,129
chose not to ignore our verified results

794
00:45:28,529 --> 00:45:35,170
that's not true what I didn't choose

795
00:45:32,130 --> 00:45:38,969
what to believe in medic

796
00:45:35,170 --> 00:45:43,180
so I'm reverse engineering the binaries

797
00:45:38,969 --> 00:45:46,180
running in the common of commercial of

798
00:45:43,180 --> 00:45:49,509
the cell of yourself CPU in a common

799
00:45:46,180 --> 00:45:51,368
device a method divide that happens to

800
00:45:49,509 --> 00:45:52,839
be connected to the onyx network I've

801
00:45:51,369 --> 00:45:58,119
been doing this for twenty years

802
00:45:52,839 --> 00:46:04,078
I do this every day my my regular job so

803
00:45:58,119 --> 00:46:07,059
I accept any technical details but well

804
00:46:04,079 --> 00:46:09,160
some of the claims they imagine is like

805
00:46:07,059 --> 00:46:12,999
okay either it's a rudimentary two

806
00:46:09,160 --> 00:46:15,308
spring can't be exploited or a rope

807
00:46:12,999 --> 00:46:18,009
chain can't be used in a real-time

808
00:46:15,309 --> 00:46:23,009
operating system because there is not

809
00:46:18,009 --> 00:46:23,009
enough functionality which is something

810
00:46:26,660 --> 00:46:30,029
[Applause]

811
00:46:32,380 --> 00:46:37,820
and also compiler level mitigation of

812
00:46:35,420 --> 00:46:42,080
scam word even if they are not added to

813
00:46:37,820 --> 00:46:44,750
the resulting binary which is pretty I

814
00:46:42,080 --> 00:46:49,310
mean it's a new planet in computer

815
00:46:44,750 --> 00:46:52,220
security so that's it but again I I

816
00:46:49,310 --> 00:46:55,910
won't I really want you to further

817
00:46:52,220 --> 00:46:58,700
investigate and provide the details to

818
00:46:55,910 --> 00:47:01,609
everyone so I decided to take the

819
00:46:58,700 --> 00:47:04,490
mitigations I don't know exactly what

820
00:47:01,610 --> 00:47:06,590
the model of the CPU they are using in

821
00:47:04,490 --> 00:47:08,899
the in the in the board in the

822
00:47:06,590 --> 00:47:11,240
commercial of the surfboard because

823
00:47:08,900 --> 00:47:14,030
there are different revisions but I can

824
00:47:11,240 --> 00:47:16,850
analyze the week's work and see if they

825
00:47:14,030 --> 00:47:21,980
are it's awful what I I know is that

826
00:47:16,850 --> 00:47:24,799
it's a 30 bit 32-bit CPU so if they are

827
00:47:21,980 --> 00:47:27,020
for example if they if they claim they

828
00:47:24,800 --> 00:47:29,090
have no execute which is not something

829
00:47:27,020 --> 00:47:32,870
they claimed but I was trying to

830
00:47:29,090 --> 00:47:37,850
investigate well the only option is if

831
00:47:32,870 --> 00:47:43,750
they are using the a bit which is not

832
00:47:37,850 --> 00:47:47,839
you can see how those two bits pay MPs

833
00:47:43,750 --> 00:47:51,830
are cleared and then are the seer for

834
00:47:47,840 --> 00:47:54,620
register is it so no option for not so

835
00:47:51,830 --> 00:47:58,100
cute so even in this case there is no

836
00:47:54,620 --> 00:48:02,600
need for our rob chain you just need to

837
00:47:58,100 --> 00:48:05,000
use expedition techniques from 20 years

838
00:48:02,600 --> 00:48:07,819
ago 20 years ago 15 years ago

839
00:48:05,000 --> 00:48:10,600
what about GCC started mitigations

840
00:48:07,820 --> 00:48:13,580
alright okay they mention that even

841
00:48:10,600 --> 00:48:16,009
integral functions couldn't be exploited

842
00:48:13,580 --> 00:48:18,910
okay let's see the implementation of a

843
00:48:16,010 --> 00:48:22,520
stream copy for example do you see any

844
00:48:18,910 --> 00:48:24,680
protection there because there is no

845
00:48:22,520 --> 00:48:28,970
protection there obviously the audience

846
00:48:24,680 --> 00:48:30,890
could be the stream to the buffer and

847
00:48:28,970 --> 00:48:34,220
that's it so it's exploitable

848
00:48:30,890 --> 00:48:37,839
let's move to another function to see if

849
00:48:34,220 --> 00:48:41,379
the stock products or has been added

850
00:48:37,839 --> 00:48:45,489
this is vulnerable function which is the

851
00:48:41,380 --> 00:48:48,579
from the FTEs manager has a significant

852
00:48:45,489 --> 00:48:51,430
stack frame which should be a trigger

853
00:48:48,579 --> 00:48:55,660
for this nut protector protector from

854
00:48:51,430 --> 00:48:57,999
the ADC see again no results

855
00:48:55,660 --> 00:49:04,779
there is no stock protection there is

856
00:48:57,999 --> 00:49:09,209
nothing so I mean they say this is not

857
00:49:04,779 --> 00:49:11,799
exploitable say they have additional I

858
00:49:09,209 --> 00:49:14,739
don't know magic or something like that

859
00:49:11,799 --> 00:49:17,349
that prevent prevent these

860
00:49:14,739 --> 00:49:19,829
vulnerabilities from being exploited but

861
00:49:17,349 --> 00:49:24,099
they are not going to serve any

862
00:49:19,829 --> 00:49:27,369
information about this to be honest it's

863
00:49:24,099 --> 00:49:31,299
hard to believe that they are having

864
00:49:27,369 --> 00:49:36,069
such a few running but then they have

865
00:49:31,299 --> 00:49:38,200
super secret system somewhere that is

866
00:49:36,069 --> 00:49:40,890
able to prevent this kind of

867
00:49:38,200 --> 00:49:45,879
exploitation on a commercial of the self

868
00:49:40,890 --> 00:49:49,118
world so I'm sharing all these details

869
00:49:45,880 --> 00:49:51,789
because this is a talk this is a Witcher

870
00:49:49,119 --> 00:49:55,420
as a research for the security community

871
00:49:51,789 --> 00:49:58,150
for the own potential companies affected

872
00:49:55,420 --> 00:50:01,900
for everyone who really wants to

873
00:49:58,150 --> 00:50:03,999
investigate further into his mother with

874
00:50:01,900 --> 00:50:10,209
their own conclusions because you don't

875
00:50:03,999 --> 00:50:11,890
have to believe me believe me but it's

876
00:50:10,209 --> 00:50:15,788
important to share the details because

877
00:50:11,890 --> 00:50:19,118
it can be used to to to motivate and it

878
00:50:15,789 --> 00:50:23,229
can be used to to to let the people who

879
00:50:19,119 --> 00:50:25,900
really have the access to those kind of

880
00:50:23,229 --> 00:50:32,848
systems investigate further into into

881
00:50:25,900 --> 00:50:32,849
this problem not so thank you very much

882
00:50:33,580 --> 00:50:36,759
[Applause]

