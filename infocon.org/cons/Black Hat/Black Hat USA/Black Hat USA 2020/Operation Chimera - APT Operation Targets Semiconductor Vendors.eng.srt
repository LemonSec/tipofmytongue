1
00:00:04,440 --> 00:00:17,520
[Music]

2
00:00:17,520 --> 00:00:19,039
hello everyone

3
00:00:19,039 --> 00:00:21,439
i'm jonghyun cheng i'm happy to come

4
00:00:21,439 --> 00:00:23,119
here to share our research

5
00:00:23,119 --> 00:00:25,920
operation camera apt operation targets

6
00:00:25,920 --> 00:00:28,640
semiconductor vendors

7
00:00:28,640 --> 00:00:32,238
my college in dilling chandeljung and i

8
00:00:32,238 --> 00:00:36,079
will show the apd group called kimera

9
00:00:36,079 --> 00:00:41,760
which is discovered in 2018 and 2019.

10
00:00:42,960 --> 00:00:45,520
now let's briefly introduce ourselves

11
00:00:45,520 --> 00:00:46,800
i'm ck chang

12
00:00:46,800 --> 00:00:50,480
i'm a senior researcher at cycraft

13
00:00:50,480 --> 00:00:53,039
west in university studied for my phd

14
00:00:53,039 --> 00:00:53,760
degree

15
00:00:53,760 --> 00:00:56,640
i play the ctf and founder city of team

16
00:00:56,640 --> 00:00:58,399
called bamboo fox

17
00:00:58,399 --> 00:01:01,840
and we joined the devcon finals

18
00:01:01,840 --> 00:01:04,879
it's 2016 and 2018

19
00:01:04,879 --> 00:01:08,240
and currently i just retired

20
00:01:08,240 --> 00:01:10,720
i'm also met the view board at the

21
00:01:10,720 --> 00:01:11,439
hitcom

22
00:01:11,439 --> 00:01:14,799
and hitp so

23
00:01:14,799 --> 00:01:18,159
i'm an active member in the security

24
00:01:18,159 --> 00:01:19,439
community

25
00:01:19,439 --> 00:01:21,520
in taiwan community i also joined the

26
00:01:21,520 --> 00:01:22,720
cia route

27
00:01:22,720 --> 00:01:26,720
which is the best hacker group in taiwan

28
00:01:26,720 --> 00:01:29,439
my partner shonda zhang who is a

29
00:01:29,439 --> 00:01:30,720
security researcher

30
00:01:30,720 --> 00:01:33,840
at cycraft and he also found a local

31
00:01:33,840 --> 00:01:37,119
hiker group called uccu hackers

32
00:01:37,119 --> 00:01:39,680
and indilin is also the security

33
00:01:39,680 --> 00:01:40,799
researcher

34
00:01:40,799 --> 00:01:43,840
at scicraft and he's a reverse engineer

35
00:01:43,840 --> 00:01:45,439
hobbyist

36
00:01:45,439 --> 00:01:47,520
and learning how to reverse from his

37
00:01:47,520 --> 00:01:48,560
high school

38
00:01:48,560 --> 00:01:52,240
and playing ctf he also presents

39
00:01:52,240 --> 00:01:57,119
a lot of research in hika and rukang

40
00:01:57,920 --> 00:02:01,360
our company cycraft is a star company in

41
00:02:01,360 --> 00:02:02,240
taiwan

42
00:02:02,240 --> 00:02:04,640
and now we have a branch in singapore

43
00:02:04,640 --> 00:02:06,479
and japan

44
00:02:06,479 --> 00:02:09,440
while focused on using ai to solve the

45
00:02:09,440 --> 00:02:11,360
security problem

46
00:02:11,360 --> 00:02:14,080
currently we have three products the

47
00:02:14,080 --> 00:02:15,520
sensor

48
00:02:15,520 --> 00:02:18,160
which is used for three hunting and the

49
00:02:18,160 --> 00:02:19,280
secaria

50
00:02:19,280 --> 00:02:22,480
or apt investigator always use this

51
00:02:22,480 --> 00:02:26,080
system to do an apt investigate

52
00:02:26,080 --> 00:02:28,000
and the cyber total australian

53
00:02:28,000 --> 00:02:30,879
intelligence platform

54
00:02:30,879 --> 00:02:34,640
so today's our research have a lot of

55
00:02:34,640 --> 00:02:35,360
help

56
00:02:35,360 --> 00:02:38,560
from these three products

57
00:02:39,200 --> 00:02:41,440
our company also joined the mitre ntt

58
00:02:41,440 --> 00:02:42,800
and ck evaluation

59
00:02:42,800 --> 00:02:46,400
in last year and compete with the top

60
00:02:46,400 --> 00:02:47,200
vendors

61
00:02:47,200 --> 00:02:50,640
in the world and get a nice result

62
00:02:50,640 --> 00:02:53,519
if you are interested about that you can

63
00:02:53,519 --> 00:02:56,480
come to see our blog

64
00:02:56,480 --> 00:02:59,518
in this url

65
00:03:00,959 --> 00:03:04,400
so let's start today's talk so this is

66
00:03:04,400 --> 00:03:05,360
today's online

67
00:03:05,360 --> 00:03:08,879
we will give the introduction uh first

68
00:03:08,879 --> 00:03:11,680
to give a overview about taiwan

69
00:03:11,680 --> 00:03:14,480
semiconductor ecosystem

70
00:03:14,480 --> 00:03:18,000
and to illustrate the three actor camila

71
00:03:18,000 --> 00:03:20,400
and then we will move to case study to

72
00:03:20,400 --> 00:03:22,400
understand the activities

73
00:03:22,400 --> 00:03:25,760
of the hacker next

74
00:03:25,760 --> 00:03:28,239
we will go deeper to three actors

75
00:03:28,239 --> 00:03:28,879
digital

76
00:03:28,879 --> 00:03:32,640
signal which shows how to reverse

77
00:03:32,640 --> 00:03:36,159
and the technical use by malware

78
00:03:36,159 --> 00:03:38,640
we will also show other incidents in

79
00:03:38,640 --> 00:03:39,599
taiwan

80
00:03:39,599 --> 00:03:42,640
which may relate it to kimela

81
00:03:42,640 --> 00:03:45,120
in the end we will make a brief

82
00:03:45,120 --> 00:03:46,319
conclusion

83
00:03:46,319 --> 00:03:50,319
to give a take away to the audience

84
00:03:50,319 --> 00:03:52,560
as taiwan has a special political

85
00:03:52,560 --> 00:03:53,519
position

86
00:03:53,519 --> 00:03:56,159
we encounter a lot of cyber attack every

87
00:03:56,159 --> 00:03:57,439
year

88
00:03:57,439 --> 00:04:01,760
in 2018 we have a tsmc ransomware

89
00:04:01,760 --> 00:04:04,720
the tsnc is one of the largest uh

90
00:04:04,720 --> 00:04:05,519
enterprise

91
00:04:05,519 --> 00:04:08,239
in semiconductor industry in taiwan or

92
00:04:08,239 --> 00:04:10,319
even in the world

93
00:04:10,319 --> 00:04:13,360
and he is being hit by one of cry and

94
00:04:13,360 --> 00:04:15,680
hold down their bottle line for two days

95
00:04:15,680 --> 00:04:20,399
and cost them 170 millions

96
00:04:20,399 --> 00:04:23,440
in last year kaspersky has discovered

97
00:04:23,440 --> 00:04:24,800
the shadowhammer

98
00:04:24,800 --> 00:04:29,280
which is a supply chain attack to asus

99
00:04:29,280 --> 00:04:34,080
and in this year in may we have a cpc

100
00:04:34,080 --> 00:04:37,440
attacked by a co-lock ransomware

101
00:04:37,440 --> 00:04:40,960
the cpc is an energy sector

102
00:04:40,960 --> 00:04:44,080
and has a lot of gas station so when

103
00:04:44,080 --> 00:04:45,600
this attack happen

104
00:04:45,600 --> 00:04:49,600
a lot of gas station is of service

105
00:04:49,600 --> 00:04:54,560
so it's a serious attack to the critical

106
00:04:54,840 --> 00:04:56,080
infrastructure

107
00:04:56,080 --> 00:04:58,320
amount of land the semiconductor is

108
00:04:58,320 --> 00:05:01,840
mostly catch our eyes

109
00:05:03,840 --> 00:05:06,800
even so taiwan is a very small country

110
00:05:06,800 --> 00:05:08,720
we have taken important role

111
00:05:08,720 --> 00:05:12,560
in the semiconductor landscape

112
00:05:12,560 --> 00:05:14,160
with our government paid a lot of

113
00:05:14,160 --> 00:05:16,320
resource to develop

114
00:05:16,320 --> 00:05:18,880
this industry we have established

115
00:05:18,880 --> 00:05:20,639
ourselves as a leading player

116
00:05:20,639 --> 00:05:23,759
in the semiconductor industry and we

117
00:05:23,759 --> 00:05:25,280
have some well-known leaders

118
00:05:25,280 --> 00:05:28,720
including tsmc and mmtk

119
00:05:28,720 --> 00:05:32,720
so in 2018 and 2019 forced the

120
00:05:32,720 --> 00:05:36,160
market sharing and the waffle capacity

121
00:05:36,160 --> 00:05:39,520
we are in the leading ship in the world

122
00:05:39,520 --> 00:05:42,240
and according to tawa news report we are

123
00:05:42,240 --> 00:05:43,039
the largest

124
00:05:43,039 --> 00:05:45,280
and fast-growing semiconductor equipment

125
00:05:45,280 --> 00:05:46,639
maker

126
00:05:46,639 --> 00:05:53,039
which make the revenue about 12 billions

127
00:05:53,039 --> 00:05:56,000
so what's attack to this vendor will

128
00:05:56,000 --> 00:05:58,880
have very serious impact

129
00:05:58,880 --> 00:06:01,919
first because this vendor take a lot of

130
00:06:01,919 --> 00:06:02,560
part

131
00:06:02,560 --> 00:06:06,240
to taiwan's economy so attack to

132
00:06:06,240 --> 00:06:08,880
list vendors like tsnc will make a

133
00:06:08,880 --> 00:06:10,160
serious impact

134
00:06:10,160 --> 00:06:13,120
to taiwan's economy and it will also

135
00:06:13,120 --> 00:06:16,880
affect the entire global supply chain

136
00:06:16,880 --> 00:06:20,160
in this report we mostly focused on i.t

137
00:06:20,160 --> 00:06:22,560
security

138
00:06:22,560 --> 00:06:25,280
compared to the ot security for example

139
00:06:25,280 --> 00:06:27,280
bankrupt production line hold up

140
00:06:27,280 --> 00:06:30,479
will immediately show the damage

141
00:06:30,479 --> 00:06:33,199
the attack to the i.t for example steal

142
00:06:33,199 --> 00:06:34,479
intelligent property

143
00:06:34,479 --> 00:06:37,360
will not show the damage immediately but

144
00:06:37,360 --> 00:06:38,080
however

145
00:06:38,080 --> 00:06:40,880
it will have a long term and serious

146
00:06:40,880 --> 00:06:43,039
impact to the enterprise

147
00:06:43,039 --> 00:06:45,360
so we should take care of both ot and

148
00:06:45,360 --> 00:06:49,840
i.t security

149
00:06:51,919 --> 00:06:54,960
because our company cycled

150
00:06:54,960 --> 00:06:57,759
is a taiwan local security company so we

151
00:06:57,759 --> 00:06:59,759
have a very high visibility

152
00:06:59,759 --> 00:07:03,680
in semi-conductor industry in taiwan

153
00:07:03,680 --> 00:07:06,720
and between 2018 and 2019 we have

154
00:07:06,720 --> 00:07:07,919
discovered

155
00:07:07,919 --> 00:07:11,199
several attacks to these vendors and the

156
00:07:11,199 --> 00:07:12,319
victims

157
00:07:12,319 --> 00:07:15,840
are mostly located at shinsu science

158
00:07:15,840 --> 00:07:17,440
park

159
00:07:17,440 --> 00:07:20,160
central science park is a century of

160
00:07:20,160 --> 00:07:22,080
taiwan high-tech industry

161
00:07:22,080 --> 00:07:24,800
and especially for semi-conductor

162
00:07:24,800 --> 00:07:27,280
vendors

163
00:07:28,160 --> 00:07:31,039
we have first published this report in

164
00:07:31,039 --> 00:07:32,400
this year

165
00:07:32,400 --> 00:07:35,360
about april and after we publish our

166
00:07:35,360 --> 00:07:36,080
report

167
00:07:36,080 --> 00:07:38,319
we receive a lot of feedback from other

168
00:07:38,319 --> 00:07:39,680
security researchers

169
00:07:39,680 --> 00:07:44,080
other vendors and our friends

170
00:07:44,080 --> 00:07:46,639
what you reveal a lot in factly there

171
00:07:46,639 --> 00:07:49,039
are more than seven vendors in taiwan

172
00:07:49,039 --> 00:07:51,599
and europe were also being attacked by

173
00:07:51,599 --> 00:07:52,960
the actor

174
00:07:52,960 --> 00:07:54,800
so we would say this attack is very

175
00:07:54,800 --> 00:07:57,440
intensive the tanker have ability

176
00:07:57,440 --> 00:08:00,160
to launch a large-scale attack to many

177
00:08:00,160 --> 00:08:00,720
vendors

178
00:08:00,720 --> 00:08:03,599
at the same time

179
00:08:05,759 --> 00:08:09,199
and the this fpga

180
00:08:09,199 --> 00:08:11,199
group is not choose their victim

181
00:08:11,199 --> 00:08:12,720
randomly

182
00:08:12,720 --> 00:08:16,400
and they choose their victim precisely

183
00:08:16,400 --> 00:08:19,759
and very well coordinated

184
00:08:19,759 --> 00:08:22,560
aside from the vendor themselves a lot

185
00:08:22,560 --> 00:08:25,520
takers also attack their subsidiaries

186
00:08:25,520 --> 00:08:29,759
and competitors so let's show the trend

187
00:08:29,759 --> 00:08:32,080
that from the old time the attacker only

188
00:08:32,080 --> 00:08:32,958
attacked

189
00:08:32,958 --> 00:08:35,519
the enterprise itself which is a single

190
00:08:35,519 --> 00:08:37,120
point attack

191
00:08:37,120 --> 00:08:39,039
and currently we move to the supply

192
00:08:39,039 --> 00:08:40,559
chain attack

193
00:08:40,559 --> 00:08:43,200
and for now in this case what we see is

194
00:08:43,200 --> 00:08:44,159
the attack

195
00:08:44,159 --> 00:08:48,319
on the entire industry survey

196
00:08:51,360 --> 00:08:55,760
and in all this texts uh the techniques

197
00:08:55,760 --> 00:08:58,720
the tactics were similar so we believe

198
00:08:58,720 --> 00:09:00,720
that this attack is conducted

199
00:09:00,720 --> 00:09:03,600
by the standard director and their

200
00:09:03,600 --> 00:09:05,440
targets of course the semiconductor

201
00:09:05,440 --> 00:09:07,440
vendors

202
00:09:07,440 --> 00:09:10,800
um the more they use is the merge

203
00:09:10,800 --> 00:09:12,959
by different open source tool and

204
00:09:12,959 --> 00:09:14,000
commercial tool

205
00:09:14,000 --> 00:09:17,200
like a dumper mimikos and cobb's truck

206
00:09:17,200 --> 00:09:20,320
so that's why we named this actor kimela

207
00:09:20,320 --> 00:09:22,080
just like camilla is merged from a

208
00:09:22,080 --> 00:09:24,399
different animal these attack

209
00:09:24,399 --> 00:09:27,200
mutual different more and insert their

210
00:09:27,200 --> 00:09:28,399
cosmic code

211
00:09:28,399 --> 00:09:31,600
to make their own mower

212
00:09:31,600 --> 00:09:34,640
in order to avoid attribution the

213
00:09:34,640 --> 00:09:37,760
tech uses c2 hosted in public cloud

214
00:09:37,760 --> 00:09:42,160
like a google app engine and azure

215
00:09:43,200 --> 00:09:44,880
the goal of the attacker is different

216
00:09:44,880 --> 00:09:46,959
from the other tech who want to steal

217
00:09:46,959 --> 00:09:47,360
the

218
00:09:47,360 --> 00:09:49,120
like the credit card information the

219
00:09:49,120 --> 00:09:50,480
user information

220
00:09:50,480 --> 00:09:53,760
in this attack the director focus on

221
00:09:53,760 --> 00:09:54,800
steel documents

222
00:09:54,800 --> 00:09:57,920
source code and sdk of chip related

223
00:09:57,920 --> 00:09:59,040
project

224
00:09:59,040 --> 00:10:02,240
so we can see the motivate

225
00:10:02,240 --> 00:10:05,279
the motivation of the taker is to steal

226
00:10:05,279 --> 00:10:08,560
the intelligent property

227
00:10:09,760 --> 00:10:12,399
so we start our investigation during the

228
00:10:12,399 --> 00:10:14,800
2018 and 2019

229
00:10:14,800 --> 00:10:17,279
and we take the investigation in more

230
00:10:17,279 --> 00:10:18,880
than three vendors

231
00:10:18,880 --> 00:10:21,519
and analyze more than 30 thousand

232
00:10:21,519 --> 00:10:24,079
endpoints

233
00:10:25,040 --> 00:10:28,959
today we will show three case studies

234
00:10:28,959 --> 00:10:31,440
from three vendors and we find these

235
00:10:31,440 --> 00:10:33,680
three vendors as cass dottie

236
00:10:33,680 --> 00:10:36,480
the first reason is because they are all

237
00:10:36,480 --> 00:10:38,399
take a living global position

238
00:10:38,399 --> 00:10:41,600
in their own market segment

239
00:10:41,600 --> 00:10:44,320
and the other reason is that because we

240
00:10:44,320 --> 00:10:45,760
get into investigation

241
00:10:45,760 --> 00:10:48,880
at a different high point so

242
00:10:48,880 --> 00:10:52,240
the analytical perspective of the

243
00:10:52,240 --> 00:10:55,760
tech campaign was different

244
00:10:56,480 --> 00:10:59,279
for a company who is our long-term

245
00:10:59,279 --> 00:11:00,480
partner

246
00:11:00,480 --> 00:11:03,600
so we regularly monitor their activities

247
00:11:03,600 --> 00:11:06,720
which allow us to have a more detail

248
00:11:06,720 --> 00:11:10,320
about a taker's activities

249
00:11:10,320 --> 00:11:12,839
and also we can treat him to a root

250
00:11:12,839 --> 00:11:14,000
cause

251
00:11:14,000 --> 00:11:16,079
so in this case study we want to show

252
00:11:16,079 --> 00:11:17,040
you

253
00:11:17,040 --> 00:11:20,320
the activities that taker do and

254
00:11:20,320 --> 00:11:23,600
how to track to the request

255
00:11:23,600 --> 00:11:27,680
for b company is a one-time ir service

256
00:11:27,680 --> 00:11:30,320
so when we get into investigation the

257
00:11:30,320 --> 00:11:32,240
tech is already beat down for a long

258
00:11:32,240 --> 00:11:33,839
time

259
00:11:33,839 --> 00:11:37,600
so we cannot recover anything back

260
00:11:37,600 --> 00:11:40,640
but however we can highlight the trade

261
00:11:40,640 --> 00:11:41,200
actors

262
00:11:41,200 --> 00:11:45,680
long long-term activities and

263
00:11:45,680 --> 00:11:48,160
discover what kind of data was leaked

264
00:11:48,160 --> 00:11:49,200
and stolen

265
00:11:49,200 --> 00:11:52,240
by the attacker which can help us to

266
00:11:52,240 --> 00:11:54,160
understand the taker's

267
00:11:54,160 --> 00:11:57,600
mission and motivation

268
00:11:57,600 --> 00:11:59,760
and the c company is also our long-term

269
00:11:59,760 --> 00:12:01,040
partner

270
00:12:01,040 --> 00:12:03,040
and at different points like our

271
00:12:03,040 --> 00:12:04,959
security team has very high security

272
00:12:04,959 --> 00:12:07,120
ability

273
00:12:07,120 --> 00:12:09,040
so they can help us to deeply

274
00:12:09,040 --> 00:12:10,240
investigate

275
00:12:10,240 --> 00:12:14,720
and get a lot of free feedback from them

276
00:12:15,279 --> 00:12:17,920
so please give us more information and

277
00:12:17,920 --> 00:12:18,639
help us

278
00:12:18,639 --> 00:12:22,399
to profile the story actors

279
00:12:22,560 --> 00:12:26,320
so next we will show the case study

280
00:12:26,320 --> 00:12:28,480
and turn to the junk to introduce and

281
00:12:28,480 --> 00:12:29,760
explain

282
00:12:29,760 --> 00:12:33,360
each of the three case studies thanks ck

283
00:12:33,360 --> 00:12:36,560
and john i will introduce a two case

284
00:12:36,560 --> 00:12:38,240
study in

285
00:12:38,240 --> 00:12:41,600
this session so let's start

286
00:12:41,600 --> 00:12:44,079
and uh before we start the custody i

287
00:12:44,079 --> 00:12:45,200
just want to mention

288
00:12:45,200 --> 00:12:48,160
all the every machine and username are

289
00:12:48,160 --> 00:12:49,440
the identified

290
00:12:49,440 --> 00:12:53,279
now original name so the first comment

291
00:12:53,279 --> 00:12:54,160
you want to use

292
00:12:54,160 --> 00:12:58,880
we call a combining a cast study

293
00:12:58,880 --> 00:13:02,560
and uh in the cast.a we

294
00:13:02,560 --> 00:13:05,440
is our long-term partner and we discover

295
00:13:05,440 --> 00:13:06,160
and

296
00:13:06,160 --> 00:13:09,279
stop the threat editor in a facial time

297
00:13:09,279 --> 00:13:12,079
and we found there's a 50 endpoint and a

298
00:13:12,079 --> 00:13:12,480
six

299
00:13:12,480 --> 00:13:15,680
user convert compromise and the right

300
00:13:15,680 --> 00:13:16,560
hand side

301
00:13:16,560 --> 00:13:19,360
is our investigation grave which is

302
00:13:19,360 --> 00:13:20,000
energy

303
00:13:20,000 --> 00:13:23,920
rate it tells us what endpoint has been

304
00:13:23,920 --> 00:13:24,800
compromised

305
00:13:24,800 --> 00:13:27,760
and the compromise endpoint when the

306
00:13:27,760 --> 00:13:28,320
thread

307
00:13:28,320 --> 00:13:34,240
later moves to this end point

308
00:13:34,240 --> 00:13:36,399
and then the first malware we found in

309
00:13:36,399 --> 00:13:37,920
this environment

310
00:13:37,920 --> 00:13:42,320
is a cobalt strike beacon and uh

311
00:13:42,320 --> 00:13:44,800
the corporate we can pertain as a google

312
00:13:44,800 --> 00:13:47,279
update

313
00:13:47,360 --> 00:13:50,000
and then we found this uh file in the

314
00:13:50,000 --> 00:13:51,040
tumor string

315
00:13:51,040 --> 00:13:53,600
but the they are same malware but they

316
00:13:53,600 --> 00:13:55,279
have a different hash

317
00:13:55,279 --> 00:13:59,040
so the australian has customized their

318
00:13:59,040 --> 00:14:02,800
vector for a different endpoint

319
00:14:02,800 --> 00:14:05,839
so we can find any file hash match in on

320
00:14:05,839 --> 00:14:09,120
the file files total

321
00:14:11,040 --> 00:14:13,680
just like previous mention the editor

322
00:14:13,680 --> 00:14:15,440
user

323
00:14:15,440 --> 00:14:18,079
user backdoor pertain as a google update

324
00:14:18,079 --> 00:14:19,839
so they also choose

325
00:14:19,839 --> 00:14:22,399
choose the google cloud player phone as

326
00:14:22,399 --> 00:14:23,360
a

327
00:14:23,360 --> 00:14:27,440
c2 comment as their c2 communication

328
00:14:27,440 --> 00:14:30,480
but that's an interesting point is

329
00:14:30,480 --> 00:14:32,800
the first day the first first couple

330
00:14:32,800 --> 00:14:33,839
shots began

331
00:14:33,839 --> 00:14:37,040
they use a google cloud player phone

332
00:14:37,040 --> 00:14:39,120
but the second day they get a new

333
00:14:39,120 --> 00:14:40,800
endpoint they deploy the

334
00:14:40,800 --> 00:14:44,000
new cobots vegan they change

335
00:14:44,000 --> 00:14:47,199
the whole hosting server

336
00:14:47,199 --> 00:14:49,600
they choose another one cloud service

337
00:14:49,600 --> 00:14:52,160
for the c2 communication

338
00:14:52,160 --> 00:14:55,360
but there is a sense related in our

339
00:14:55,360 --> 00:14:56,399
point of view

340
00:14:56,399 --> 00:14:59,839
is a solution is a multi a

341
00:14:59,839 --> 00:15:03,040
it's a group so there's a multiple

342
00:15:03,040 --> 00:15:06,800
attack in the group so everyone has

343
00:15:06,800 --> 00:15:10,560
their preferred cloud service so they

344
00:15:10,560 --> 00:15:14,399
change the cloud service

345
00:15:16,240 --> 00:15:20,480
and we found it a

346
00:15:20,480 --> 00:15:22,880
two remote execution tool in the

347
00:15:22,880 --> 00:15:24,079
environment

348
00:15:24,079 --> 00:15:28,480
which is a schedule desk under the wmic

349
00:15:28,480 --> 00:15:32,480
the slider uses a sale text tasker to

350
00:15:32,480 --> 00:15:35,920
use uh to copy a file and the

351
00:15:35,920 --> 00:15:40,000
execution the backdoor

352
00:15:40,000 --> 00:15:43,120
and then they use the wmic to

353
00:15:43,120 --> 00:15:45,120
check the target endpoint has an

354
00:15:45,120 --> 00:15:48,240
international connection

355
00:15:48,320 --> 00:15:50,800
so why they just why they just chose one

356
00:15:50,800 --> 00:15:51,680
of them to

357
00:15:51,680 --> 00:15:55,440
do the data movement

358
00:15:55,440 --> 00:15:58,959
because the diamond ic can get as stdl

359
00:15:58,959 --> 00:16:01,600
information so this can get output

360
00:16:01,600 --> 00:16:04,000
information to check the status

361
00:16:04,000 --> 00:16:06,720
and they can use a cache credential in

362
00:16:06,720 --> 00:16:07,199
the

363
00:16:07,199 --> 00:16:10,320
environment so they use the target

364
00:16:10,320 --> 00:16:13,120
analysis to do this kind of a

365
00:16:13,120 --> 00:16:15,440
goal

366
00:16:16,639 --> 00:16:18,800
and

367
00:16:20,000 --> 00:16:22,560
however we're finding there's a schedule

368
00:16:22,560 --> 00:16:23,040
desk

369
00:16:23,040 --> 00:16:27,120
and the wnic so we can draw a simple

370
00:16:27,120 --> 00:16:29,839
investigation graph like this so there's

371
00:16:29,839 --> 00:16:30,240
a

372
00:16:30,240 --> 00:16:33,120
one server called server lauren has user

373
00:16:33,120 --> 00:16:35,120
schedule tasker and the wnic data

374
00:16:35,120 --> 00:16:36,320
movement to

375
00:16:36,320 --> 00:16:39,360
these three endpoints and then this

376
00:16:39,360 --> 00:16:41,440
swimming one of them is a domain

377
00:16:41,440 --> 00:16:42,880
controller

378
00:16:42,880 --> 00:16:46,720
so we find there is a server lauren has

379
00:16:46,720 --> 00:16:48,880
a remote sq

380
00:16:48,880 --> 00:16:53,360
uh ir tool collecting the

381
00:16:53,360 --> 00:16:56,079
domain controller data so what they have

382
00:16:56,079 --> 00:16:57,519
they correct is the

383
00:16:57,519 --> 00:17:02,519
rigid tree and the system and the system

384
00:17:02,519 --> 00:17:05,839
ngts.dit file

385
00:17:06,240 --> 00:17:08,959
so why also i had to want to collect

386
00:17:08,959 --> 00:17:09,919
this two files

387
00:17:09,919 --> 00:17:14,160
is because a threader cluster file can

388
00:17:14,160 --> 00:17:17,720
get the windows 80 information the

389
00:17:17,720 --> 00:17:19,280
ntts.dit

390
00:17:19,280 --> 00:17:22,480
store the encrypted

391
00:17:22,480 --> 00:17:25,599
windows 80 username password in

392
00:17:25,599 --> 00:17:29,520
email.com something like this

393
00:17:29,520 --> 00:17:33,120
so they collect the file but the layers

394
00:17:33,120 --> 00:17:36,240
and still need a decoration key so

395
00:17:36,240 --> 00:17:40,160
the integration key is stored in the

396
00:17:40,160 --> 00:17:43,280
windows registry so that's why they the

397
00:17:43,280 --> 00:17:47,840
swear term need to connect two file

398
00:17:47,919 --> 00:17:50,160
and then they use the wing ir and the

399
00:17:50,160 --> 00:17:52,080
pretend as a

400
00:17:52,080 --> 00:17:54,799
name as a file name as a recording bit

401
00:17:54,799 --> 00:17:56,320
ims which is a

402
00:17:56,320 --> 00:18:00,640
digital file name

403
00:18:00,640 --> 00:18:04,080
so based on finding and

404
00:18:04,080 --> 00:18:07,200
our air explication tell us the

405
00:18:07,200 --> 00:18:10,640
there's an ambi clear user schedule test

406
00:18:10,640 --> 00:18:14,000
deploy google

407
00:18:14,000 --> 00:18:17,360
update to the server lower

408
00:18:17,360 --> 00:18:20,480
so we track back into ambika layer

409
00:18:20,480 --> 00:18:25,039
so ambiguous timeline tell us

410
00:18:25,039 --> 00:18:28,240
before the scheduled test execution six

411
00:18:28,240 --> 00:18:29,760
minutes ago

412
00:18:29,760 --> 00:18:34,320
then there's a

413
00:18:34,480 --> 00:18:39,280
rdp log on successfully from the ip1

414
00:18:39,280 --> 00:18:42,240
so we think it is a possible is a higher

415
00:18:42,240 --> 00:18:43,600
low cost about

416
00:18:43,600 --> 00:18:46,320
this attack and then we notice after the

417
00:18:46,320 --> 00:18:48,240
rdp logong

418
00:18:48,240 --> 00:18:50,960
they use this uh user account to do a

419
00:18:50,960 --> 00:18:52,720
system recognizance

420
00:18:52,720 --> 00:18:55,840
and do the schedule test code to deport

421
00:18:55,840 --> 00:18:58,320
remote deploy the malware

422
00:18:58,320 --> 00:19:00,480
so

423
00:19:01,520 --> 00:19:04,480
we notice the switch editor has a not

424
00:19:04,480 --> 00:19:06,240
has a data it's refrigeration

425
00:19:06,240 --> 00:19:09,679
for some file like the

426
00:19:09,679 --> 00:19:12,559
reconnaissance reconnaissance result and

427
00:19:12,559 --> 00:19:13,120
they

428
00:19:13,120 --> 00:19:16,080
use a one byte to modify ir file and the

429
00:19:16,080 --> 00:19:17,280
rename as a

430
00:19:17,280 --> 00:19:19,200
later file name like a recording with

431
00:19:19,200 --> 00:19:20,880
ims as

432
00:19:20,880 --> 00:19:24,320
ju check dioxy and we found

433
00:19:24,320 --> 00:19:29,840
this uh fairhead in multiple case study

434
00:19:30,160 --> 00:19:33,679
so we think it is a same sorry editor

435
00:19:33,679 --> 00:19:34,000
and

436
00:19:34,000 --> 00:19:37,120
the best on the previous

437
00:19:37,120 --> 00:19:41,360
technique and the file the ring irig

438
00:19:41,360 --> 00:19:42,880
file they store

439
00:19:42,880 --> 00:19:45,919
so we sing a signature technique of

440
00:19:45,919 --> 00:19:48,960
operation key mirror

441
00:19:50,400 --> 00:19:53,840
and then we transpected the rdp ip

442
00:19:53,840 --> 00:19:57,120
so we noticed this on scan hostel and

443
00:19:57,120 --> 00:20:00,320
which is a vpn server vpn server so

444
00:20:00,320 --> 00:20:02,640
vpn server also can be compromised your

445
00:20:02,640 --> 00:20:04,880
vpn account not

446
00:20:04,880 --> 00:20:09,919
cannot be the last line of your defense

447
00:20:10,960 --> 00:20:14,240
and the above are the first casualty

448
00:20:14,240 --> 00:20:17,600
and the second casting is becoming and

449
00:20:17,600 --> 00:20:20,400
just like previous mention becoming is a

450
00:20:20,400 --> 00:20:22,880
ir service covering

451
00:20:22,880 --> 00:20:26,159
we're doing ir service for this company

452
00:20:26,159 --> 00:20:29,600
so the just quick overview the status is

453
00:20:29,600 --> 00:20:30,159
a

454
00:20:30,159 --> 00:20:33,360
big company has been compromised very

455
00:20:33,360 --> 00:20:34,000
long time

456
00:20:34,000 --> 00:20:37,840
and due to the there we have a frenzy

457
00:20:37,840 --> 00:20:39,919
coming and the c comings

458
00:20:39,919 --> 00:20:42,159
has a business collaboration with big

459
00:20:42,159 --> 00:20:43,120
company

460
00:20:43,120 --> 00:20:44,960
so because due to the bitcoin

461
00:20:44,960 --> 00:20:46,320
corporation so

462
00:20:46,320 --> 00:20:49,360
they had some network interactive so

463
00:20:49,360 --> 00:20:52,159
communities carry the sound security

464
00:20:52,159 --> 00:20:53,200
anomaly

465
00:20:53,200 --> 00:20:56,080
activities from becoming so they

466
00:20:56,080 --> 00:20:57,120
introduced uh to

467
00:20:57,120 --> 00:21:00,400
do the investigation so

468
00:21:00,400 --> 00:21:04,080
when i do uh when we do a ir service

469
00:21:04,080 --> 00:21:08,320
we we summarize the time period starting

470
00:21:08,320 --> 00:21:10,480
uh

471
00:21:11,799 --> 00:21:17,840
2018 to 2019.

472
00:21:18,000 --> 00:21:22,400
and we found others in speaker study we

473
00:21:22,400 --> 00:21:23,840
found on the thread that used a

474
00:21:23,840 --> 00:21:26,240
powershell but still send the user

475
00:21:26,240 --> 00:21:27,840
posture is killed in the

476
00:21:27,840 --> 00:21:31,840
cobra strike b speaker and the migrated

477
00:21:31,840 --> 00:21:35,200
cobblestone back door to the svc holster

478
00:21:35,200 --> 00:21:38,080
but this most important thing is we find

479
00:21:38,080 --> 00:21:39,120
in the

480
00:21:39,120 --> 00:21:42,640
powershell cable strike begun

481
00:21:42,640 --> 00:21:46,000
in the tank end point but they have

482
00:21:46,000 --> 00:21:50,080
included two domain console is a very

483
00:21:50,080 --> 00:21:54,559
serious and

484
00:21:54,880 --> 00:21:58,320
just like the previous led attack

485
00:21:58,320 --> 00:22:01,360
the threat use the cloud service to

486
00:22:01,360 --> 00:22:05,200
do their to do the c2 communication

487
00:22:05,200 --> 00:22:07,919
so they use a google cloud platform in

488
00:22:07,919 --> 00:22:10,080
this time they also use the

489
00:22:10,080 --> 00:22:14,399
microsoft azure cloud service

490
00:22:16,720 --> 00:22:21,280
so based on the previous because

491
00:22:21,280 --> 00:22:24,799
becoming has a has been serious hacked

492
00:22:24,799 --> 00:22:27,200
so it's a very difficult to manually

493
00:22:27,200 --> 00:22:30,159
investigation so the following the

494
00:22:30,159 --> 00:22:34,159
screenshot is all ai generate

495
00:22:34,159 --> 00:22:37,919
cyber situation wave so it tells

496
00:22:37,919 --> 00:22:40,960
what endpoint the endpoint has been

497
00:22:40,960 --> 00:22:42,320
compromised and the

498
00:22:42,320 --> 00:22:45,039
this endpoint has connection to the

499
00:22:45,039 --> 00:22:46,480
something

500
00:22:46,480 --> 00:22:49,919
manager we which we didn't scan so it's

501
00:22:49,919 --> 00:22:52,000
tell our ir team can

502
00:22:52,000 --> 00:22:54,720
do some investigation on this endpoint

503
00:22:54,720 --> 00:22:55,120
to

504
00:22:55,120 --> 00:22:59,360
trigger the compromise scope

505
00:23:02,799 --> 00:23:06,720
so starting the 2018 november

506
00:23:06,720 --> 00:23:09,840
illustrator has getting the environment

507
00:23:09,840 --> 00:23:14,080
and the understanding they come back

508
00:23:14,080 --> 00:23:17,919
quarterly best to convey the new data

509
00:23:17,919 --> 00:23:20,480
they want

510
00:23:21,600 --> 00:23:23,679
so every coil they will come back to

511
00:23:23,679 --> 00:23:24,640
here to

512
00:23:24,640 --> 00:23:28,080
get some new file a little bit

513
00:23:28,080 --> 00:23:30,720
so probably they need to do some reports

514
00:23:30,720 --> 00:23:32,000
to their boss more

515
00:23:32,000 --> 00:23:36,080
or their buyer

516
00:23:36,080 --> 00:23:39,840
until 2019 november the australian

517
00:23:39,840 --> 00:23:43,679
deployed one new weapon before that

518
00:23:43,679 --> 00:23:45,360
the threat of the commonwealth score

519
00:23:45,360 --> 00:23:48,000
didn't get extended

520
00:23:48,000 --> 00:23:52,000
so until 2019 november

521
00:23:52,000 --> 00:23:56,080
they deploy a new malware and the 2019

522
00:23:56,080 --> 00:23:57,120
december

523
00:23:57,120 --> 00:24:00,080
they extended the compromise score so

524
00:24:00,080 --> 00:24:01,600
which means

525
00:24:01,600 --> 00:24:05,360
the previous pro in maui has a has a

526
00:24:05,360 --> 00:24:08,400
has some it's work

527
00:24:08,400 --> 00:24:10,799
for them

528
00:24:12,559 --> 00:24:16,559
so first of all our investigation

529
00:24:16,559 --> 00:24:19,039
we found we made an inventory about the

530
00:24:19,039 --> 00:24:20,320
big data

531
00:24:20,320 --> 00:24:23,440
so following uh the straight ato

532
00:24:23,440 --> 00:24:26,880
targeting is frequently the threat of

533
00:24:26,880 --> 00:24:30,000
collateral portal map the back of the

534
00:24:30,000 --> 00:24:31,520
workspace and attribute

535
00:24:31,520 --> 00:24:35,120
sdk information and just

536
00:24:35,120 --> 00:24:37,919
their target is about semiconductor

537
00:24:37,919 --> 00:24:40,320
intelligence property

538
00:24:40,320 --> 00:24:43,360
so we assume there's a business spy or

539
00:24:43,360 --> 00:24:45,279
state sponsor attack

540
00:24:45,279 --> 00:24:47,679
some country won't benefit a certain

541
00:24:47,679 --> 00:24:50,320
industry

542
00:24:51,840 --> 00:24:54,320
but which one we are not sure but we

543
00:24:54,320 --> 00:24:55,360
show is a

544
00:24:55,360 --> 00:24:58,840
attacker intense is stealing the interns

545
00:24:58,840 --> 00:25:00,080
property

546
00:25:00,080 --> 00:25:04,000
so i will move on to the we will turn to

547
00:25:04,000 --> 00:25:07,679
the our colleagues ck we'll introduce a

548
00:25:07,679 --> 00:25:09,360
test.c

549
00:25:09,360 --> 00:25:13,760
so ck okay thanks for john

550
00:25:13,760 --> 00:25:16,480
and next i will continue to our case

551
00:25:16,480 --> 00:25:19,520
study policy company

552
00:25:19,520 --> 00:25:23,120
and company c is our long-term partner

553
00:25:23,120 --> 00:25:27,440
and have a very high security skill

554
00:25:27,440 --> 00:25:29,520
and there is a principle in our company

555
00:25:29,520 --> 00:25:31,919
that when we conduct our investigation

556
00:25:31,919 --> 00:25:34,080
we will try to minimize the data and

557
00:25:34,080 --> 00:25:36,080
files that we needed

558
00:25:36,080 --> 00:25:39,760
from the victims environment this

559
00:25:39,760 --> 00:25:43,279
is for protection to victims privacy and

560
00:25:43,279 --> 00:25:45,919
confidential

561
00:25:46,159 --> 00:25:50,559
so if the blue team in logan victim

562
00:25:50,559 --> 00:25:52,559
organization has a very skillful

563
00:25:52,559 --> 00:25:56,080
that can help us to get deeper deeper

564
00:25:56,080 --> 00:26:00,080
so in this case when we finish our first

565
00:26:00,080 --> 00:26:03,200
investigation we tell the result to land

566
00:26:03,200 --> 00:26:05,840
and the protein helped us to find out

567
00:26:05,840 --> 00:26:06,640
more

568
00:26:06,640 --> 00:26:10,480
to profile the stray actors

569
00:26:10,480 --> 00:26:12,799
so from the experience of this cast

570
00:26:12,799 --> 00:26:14,240
there is a recommend a lot

571
00:26:14,240 --> 00:26:16,720
even though security service are also

572
00:26:16,720 --> 00:26:17,760
seen

573
00:26:17,760 --> 00:26:19,919
your blue team must have a very high

574
00:26:19,919 --> 00:26:20,880
skill

575
00:26:20,880 --> 00:26:23,520
so that you can interactive with the

576
00:26:23,520 --> 00:26:26,480
outsource vendors

577
00:26:26,960 --> 00:26:30,400
okay in this bed in this case we first

578
00:26:30,400 --> 00:26:31,919
find

579
00:26:31,919 --> 00:26:35,200
a more we call it three in one cloud

580
00:26:35,200 --> 00:26:36,159
storage tool

581
00:26:36,159 --> 00:26:40,080
i use a g drive uh dropbox and onedrive

582
00:26:40,080 --> 00:26:43,360
to upload the steel file

583
00:26:43,360 --> 00:26:46,559
and their hash is hit this here and

584
00:26:46,559 --> 00:26:49,520
when we discover it this one has no

585
00:26:49,520 --> 00:26:50,840
recording

586
00:26:50,840 --> 00:26:54,080
bt and because of this use

587
00:26:54,080 --> 00:26:57,520
this mower use the webs api to transfer

588
00:26:57,520 --> 00:26:58,240
file

589
00:26:58,240 --> 00:27:02,960
so it's able to bypass level 7 firewall

590
00:27:02,960 --> 00:27:05,520
we also have discovered the other cloud

591
00:27:05,520 --> 00:27:06,400
storage tool

592
00:27:06,400 --> 00:27:09,679
that uses open load

593
00:27:12,640 --> 00:27:14,880
and because we have monitored some

594
00:27:14,880 --> 00:27:16,159
command

595
00:27:16,159 --> 00:27:18,480
used by the hacker and in this command

596
00:27:18,480 --> 00:27:20,000
we can find the authentication

597
00:27:20,000 --> 00:27:23,200
token and upload the file pass

598
00:27:23,200 --> 00:27:25,840
so we can find some file upload by the

599
00:27:25,840 --> 00:27:27,679
hacker

600
00:27:27,679 --> 00:27:31,600
and also we find some files a lot

601
00:27:31,600 --> 00:27:34,720
in victim environment that is possible

602
00:27:34,720 --> 00:27:37,919
to be leave by a hacker and one of the

603
00:27:37,919 --> 00:27:40,480
files like that

604
00:27:40,480 --> 00:27:43,360
so this file is like a cheat sheet of

605
00:27:43,360 --> 00:27:44,720
the director

606
00:27:44,720 --> 00:27:47,440
and let me follow the trick step 3 to

607
00:27:47,440 --> 00:27:48,000
export

608
00:27:48,000 --> 00:27:51,840
the ntts so in fact we also monitor

609
00:27:51,840 --> 00:27:55,120
the similar activities and follow the

610
00:27:55,120 --> 00:27:55,840
link here

611
00:27:55,840 --> 00:27:59,200
we can find a very famous security

612
00:27:59,200 --> 00:28:00,159
foreign

613
00:28:00,159 --> 00:28:03,600
in china so this can give

614
00:28:03,600 --> 00:28:06,880
us some hint about the campaign so we

615
00:28:06,880 --> 00:28:07,520
can

616
00:28:07,520 --> 00:28:09,760
guess while the campaign has at least

617
00:28:09,760 --> 00:28:11,600
one member

618
00:28:11,600 --> 00:28:14,799
understanding chinese

619
00:28:15,360 --> 00:28:17,679
and we also make a profile about the

620
00:28:17,679 --> 00:28:19,840
active time of the actor

621
00:28:19,840 --> 00:28:23,360
so we find that they are most active

622
00:28:23,360 --> 00:28:27,120
in the segtender birth in 2019

623
00:28:27,120 --> 00:28:28,960
and their working hour is from the

624
00:28:28,960 --> 00:28:30,240
morning 8

625
00:28:30,240 --> 00:28:34,000
30 to night 8 30.

626
00:28:34,000 --> 00:28:38,159
from this time period we can guess

627
00:28:38,159 --> 00:28:41,200
the taker's time zone is located in utc

628
00:28:41,200 --> 00:28:43,120
plus 8.

629
00:28:43,120 --> 00:28:44,960
and their working day is monday to

630
00:28:44,960 --> 00:28:46,880
friday and most busy

631
00:28:46,880 --> 00:28:50,320
in wednesday and sometimes if some event

632
00:28:50,320 --> 00:28:53,039
or submission is needed they may also

633
00:28:53,039 --> 00:28:53,760
work

634
00:28:53,760 --> 00:28:56,799
as saturday so from this information we

635
00:28:56,799 --> 00:28:58,399
can guess the campaign

636
00:28:58,399 --> 00:29:02,799
is at the same time zone to taiwan

637
00:29:02,799 --> 00:29:06,159
okay so with the help

638
00:29:06,159 --> 00:29:09,279
of the blue team of our partner

639
00:29:09,279 --> 00:29:12,240
we have more information more profile

640
00:29:12,240 --> 00:29:15,279
about this campaign

641
00:29:15,600 --> 00:29:18,000
so next we will go deeper about three

642
00:29:18,000 --> 00:29:19,600
actors digital

643
00:29:19,600 --> 00:29:23,360
signal and indie will show you the mower

644
00:29:23,360 --> 00:29:27,200
and the technical use by this malware

645
00:29:27,200 --> 00:29:31,360
okay so that's your turn indeed

646
00:29:31,360 --> 00:29:34,960
hi i'm indy reverse engineer from from

647
00:29:34,960 --> 00:29:38,320
sci-craft now i'm going to introduce

648
00:29:38,320 --> 00:29:41,679
actress digital arsenal

649
00:29:41,679 --> 00:29:44,880
we have observed four main tools they

650
00:29:44,880 --> 00:29:46,399
used to carry out

651
00:29:46,399 --> 00:29:49,440
the attack the first

652
00:29:49,440 --> 00:29:51,520
we are going to talk about is cobalt

653
00:29:51,520 --> 00:29:52,720
strike beacon

654
00:29:52,720 --> 00:29:55,279
cable strike is a commercial red team

655
00:29:55,279 --> 00:29:58,399
operation framework

656
00:29:58,399 --> 00:30:01,200
they use global strike beacon as their

657
00:30:01,200 --> 00:30:02,080
primary

658
00:30:02,080 --> 00:30:04,960
backdoor in lease intrusions for the

659
00:30:04,960 --> 00:30:06,159
persistency

660
00:30:06,159 --> 00:30:08,159
they override google chrome update

661
00:30:08,159 --> 00:30:09,279
utility with

662
00:30:09,279 --> 00:30:12,880
their kobo strike beacon this

663
00:30:12,880 --> 00:30:15,919
there is no any new autorun entry was

664
00:30:15,919 --> 00:30:16,880
created

665
00:30:16,880 --> 00:30:20,399
so it will lower the chance to be caught

666
00:30:20,399 --> 00:30:23,200
we found this backdoor on several

667
00:30:23,200 --> 00:30:24,399
company

668
00:30:24,399 --> 00:30:26,559
so we linked the intrusion events

669
00:30:26,559 --> 00:30:28,720
together

670
00:30:28,720 --> 00:30:31,360
our project detected some suspicious

671
00:30:31,360 --> 00:30:32,960
memory block

672
00:30:32,960 --> 00:30:36,000
the interesting part is that it is

673
00:30:36,000 --> 00:30:41,120
a p file and also a show code

674
00:30:41,120 --> 00:30:43,840
cable strike beacon and metal spotted

675
00:30:43,840 --> 00:30:46,480
meter preacher both use this technique

676
00:30:46,480 --> 00:30:49,679
the hybrid payload this technique is to

677
00:30:49,679 --> 00:30:50,320
embed

678
00:30:50,320 --> 00:30:54,080
show code into the pe file header

679
00:30:54,080 --> 00:30:57,360
the pe magic header mz

680
00:30:57,360 --> 00:31:00,559
could be decoded as valid instructions

681
00:31:00,559 --> 00:31:03,120
and the list instructions will work fine

682
00:31:03,120 --> 00:31:05,200
in most of context

683
00:31:05,200 --> 00:31:08,640
so you can ignore this in instructions

684
00:31:08,640 --> 00:31:11,840
and append shortcut after it

685
00:31:11,840 --> 00:31:15,039
the show code will locate its address

686
00:31:15,039 --> 00:31:18,080
and execute the reflective loader

687
00:31:18,080 --> 00:31:22,960
to load pe image in memory in memory

688
00:31:23,279 --> 00:31:26,159
cable strike uses a special strategy to

689
00:31:26,159 --> 00:31:28,640
inject payload into other process

690
00:31:28,640 --> 00:31:31,279
first cable strike will spawn a new

691
00:31:31,279 --> 00:31:32,000
process

692
00:31:32,000 --> 00:31:35,440
or choose a target process then inject

693
00:31:35,440 --> 00:31:37,840
the show code into the target process

694
00:31:37,840 --> 00:31:41,679
we call it stager the real payload will

695
00:31:41,679 --> 00:31:43,200
be transferred through

696
00:31:43,200 --> 00:31:48,080
numpy and executed by stager

697
00:31:48,080 --> 00:31:51,519
the stage the list strategy

698
00:31:51,519 --> 00:31:54,640
will bypass some sandbox or emulation

699
00:31:54,640 --> 00:31:57,519
based scanning

700
00:31:57,600 --> 00:32:00,799
here is a wing rar it is a popular

701
00:32:00,799 --> 00:32:01,760
commercial

702
00:32:01,760 --> 00:32:05,200
conversion software it was used in this

703
00:32:05,200 --> 00:32:07,360
operation

704
00:32:07,360 --> 00:32:11,120
the actor used rar.exe to compress

705
00:32:11,120 --> 00:32:14,880
and encrypt the files they store

706
00:32:14,880 --> 00:32:18,640
they try to ambulate and be create

707
00:32:18,640 --> 00:32:23,360
the program with existing file path

708
00:32:23,440 --> 00:32:26,240
the reason why we mention this file is

709
00:32:26,240 --> 00:32:28,799
this file is different from the original

710
00:32:28,799 --> 00:32:29,679
one

711
00:32:29,679 --> 00:32:32,480
we grabbed this old version of weak rar

712
00:32:32,480 --> 00:32:34,320
and compare it with the

713
00:32:34,320 --> 00:32:37,600
one hacker used we found the difference

714
00:32:37,600 --> 00:32:39,039
part was located

715
00:32:39,039 --> 00:32:42,159
in code section and such patch may

716
00:32:42,159 --> 00:32:45,519
lead the program to crash we have two

717
00:32:45,519 --> 00:32:46,880
hypothesis

718
00:32:46,880 --> 00:32:50,399
first is the actor change the byte

719
00:32:50,399 --> 00:32:52,159
intentionally

720
00:32:52,159 --> 00:32:55,440
to make file hash different so

721
00:32:55,440 --> 00:32:57,840
hash based detection will not find this

722
00:32:57,840 --> 00:32:58,480
file is

723
00:32:58,480 --> 00:33:02,159
rar if your organization do not use

724
00:33:02,159 --> 00:33:06,080
wing rar the file may be detected

725
00:33:06,080 --> 00:33:09,360
and triggers on investigation

726
00:33:09,360 --> 00:33:13,039
second hyposit it is just a bit flip

727
00:33:13,039 --> 00:33:16,240
during copy charged by

728
00:33:16,240 --> 00:33:19,600
the age of file it is highly possible

729
00:33:19,600 --> 00:33:23,519
at that time we are going to talk about

730
00:33:23,519 --> 00:33:24,240
the most

731
00:33:24,240 --> 00:33:26,240
interesting malware used in this

732
00:33:26,240 --> 00:33:27,360
operation

733
00:33:27,360 --> 00:33:30,480
the skeleton key

734
00:33:30,480 --> 00:33:33,039
we found a unique malware that made with

735
00:33:33,039 --> 00:33:35,360
two open source hacking tools

736
00:33:35,360 --> 00:33:38,559
dumpert and i believe

737
00:33:38,559 --> 00:33:41,840
everyone here has heard about mimikaz

738
00:33:41,840 --> 00:33:44,320
it is a well-known hacking tool to dump

739
00:33:44,320 --> 00:33:46,320
credentials from memory

740
00:33:46,320 --> 00:33:49,840
but it has more capability like

741
00:33:49,840 --> 00:33:52,960
bypass group policy and spawn

742
00:33:52,960 --> 00:33:56,159
command-line prompt task manager

743
00:33:56,159 --> 00:33:59,360
or registry editor

744
00:33:59,360 --> 00:34:02,480
maybe you don't know dunkirk it was

745
00:34:02,480 --> 00:34:04,880
made by a security company called

746
00:34:04,880 --> 00:34:06,399
outflank

747
00:34:06,399 --> 00:34:09,760
it is a proof of concept program to use

748
00:34:09,760 --> 00:34:13,119
direct system call on windows unlike

749
00:34:13,119 --> 00:34:16,560
linux we can't directly use

750
00:34:16,560 --> 00:34:20,480
system call initial code because windows

751
00:34:20,480 --> 00:34:23,520
system call numbers changed from release

752
00:34:23,520 --> 00:34:25,040
to release

753
00:34:25,040 --> 00:34:28,159
the only stable interface is explore

754
00:34:28,159 --> 00:34:28,960
functions

755
00:34:28,960 --> 00:34:32,079
from the shared libraries that is why

756
00:34:32,079 --> 00:34:35,119
windows show code must rely on them

757
00:34:35,119 --> 00:34:37,199
and always begins with locating

758
00:34:37,199 --> 00:34:38,639
functions in memory

759
00:34:38,639 --> 00:34:42,480
by traverse peb loader data

760
00:34:42,480 --> 00:34:45,679
and pe structures

761
00:34:45,679 --> 00:34:49,839
so how do dunker doing doing it

762
00:34:49,839 --> 00:34:53,199
first it use rtl get version to

763
00:34:53,199 --> 00:34:53,839
determine

764
00:34:53,839 --> 00:34:56,639
which version of windows you are using

765
00:34:56,639 --> 00:34:57,280
and

766
00:34:57,280 --> 00:35:00,400
select different embedded system call

767
00:35:00,400 --> 00:35:02,640
function depend on it

768
00:35:02,640 --> 00:35:06,160
after that you can bypass any user's

769
00:35:06,160 --> 00:35:07,280
facebook

770
00:35:07,280 --> 00:35:09,440
and doing anything you want without

771
00:35:09,440 --> 00:35:10,320
trigger or

772
00:35:10,320 --> 00:35:14,079
alert or get blocked

773
00:35:15,200 --> 00:35:17,680
for the one who don't know what skeleton

774
00:35:17,680 --> 00:35:18,960
key is

775
00:35:18,960 --> 00:35:21,599
skill london key is an abd malware

776
00:35:21,599 --> 00:35:22,720
discovered by

777
00:35:22,720 --> 00:35:26,480
dell security works in 2015.

778
00:35:26,480 --> 00:35:29,040
it will implant a backdoor password to

779
00:35:29,040 --> 00:35:30,320
domain controller

780
00:35:30,320 --> 00:35:33,520
in an active directory directory

781
00:35:33,520 --> 00:35:35,440
environment

782
00:35:35,440 --> 00:35:38,240
then attacker can authenticate as any

783
00:35:38,240 --> 00:35:40,079
user as they want

784
00:35:40,079 --> 00:35:43,920
with the backdoor password but the user

785
00:35:43,920 --> 00:35:44,720
must be

786
00:35:44,720 --> 00:35:48,880
a existed valid user meanwhile

787
00:35:48,880 --> 00:35:52,000
original password was not affected

788
00:35:52,000 --> 00:35:54,480
any other round password still will be

789
00:35:54,480 --> 00:35:56,320
rejected

790
00:35:56,320 --> 00:36:00,560
so how does skeleton key do it

791
00:36:00,560 --> 00:36:03,520
it will it will alter the the

792
00:36:03,520 --> 00:36:05,119
authentication flow

793
00:36:05,119 --> 00:36:07,720
by hooking some crypto functions in

794
00:36:07,720 --> 00:36:09,599
lsas.exe

795
00:36:09,599 --> 00:36:12,480
although original skeleton key malware

796
00:36:12,480 --> 00:36:13,839
was never released

797
00:36:13,839 --> 00:36:17,280
publicly author of mimikat still made

798
00:36:17,280 --> 00:36:20,640
his own implementation

799
00:36:20,720 --> 00:36:23,440
skeleton key is a very powerful weapon

800
00:36:23,440 --> 00:36:24,079
against

801
00:36:24,079 --> 00:36:26,800
active directory because you don't need

802
00:36:26,800 --> 00:36:28,560
to dump admin credentials

803
00:36:28,560 --> 00:36:31,400
for a lateral movement if you use

804
00:36:31,400 --> 00:36:33,440
administrator credential to

805
00:36:33,440 --> 00:36:36,640
access endpoints in a domain you may

806
00:36:36,640 --> 00:36:38,880
trigger a lot of alerts

807
00:36:38,880 --> 00:36:41,119
but if you're logging but if you're

808
00:36:41,119 --> 00:36:43,280
logging with normal users

809
00:36:43,280 --> 00:36:46,720
the situation will be different it will

810
00:36:46,720 --> 00:36:47,359
leave

811
00:36:47,359 --> 00:36:51,520
only nearly no clue only bunches of

812
00:36:51,520 --> 00:36:53,359
logan success event

813
00:36:53,359 --> 00:36:57,119
and most administrator or investigator

814
00:36:57,119 --> 00:36:59,680
will ignore normal user logon events

815
00:36:59,680 --> 00:37:01,760
easily

816
00:37:01,760 --> 00:37:04,800
and skeleton key can not be

817
00:37:04,800 --> 00:37:07,760
removed without reboot it will be

818
00:37:07,760 --> 00:37:11,280
painful to reboot a domain controller

819
00:37:11,280 --> 00:37:13,839
because you may break your

820
00:37:13,839 --> 00:37:17,599
organization's daily routine

821
00:37:17,839 --> 00:37:21,200
we also observe some other apt attack

822
00:37:21,200 --> 00:37:23,839
that using modified version of mimikaz

823
00:37:23,839 --> 00:37:24,400
against

824
00:37:24,400 --> 00:37:28,000
taiwan government agencies

825
00:37:28,400 --> 00:37:31,280
next we are going to introdu introduce

826
00:37:31,280 --> 00:37:33,920
the new finding after the white paper

827
00:37:33,920 --> 00:37:35,280
published

828
00:37:35,280 --> 00:37:38,160
we found winter backdoor was used in

829
00:37:38,160 --> 00:37:40,960
this operation

830
00:37:40,960 --> 00:37:44,000
at the first time charged by

831
00:37:44,000 --> 00:37:47,119
command-line event log and the program

832
00:37:47,119 --> 00:37:48,000
usage

833
00:37:48,000 --> 00:37:50,800
we thought that was a network probing

834
00:37:50,800 --> 00:37:53,040
tool

835
00:37:53,040 --> 00:37:56,560
but after detailed analysis we found

836
00:37:56,560 --> 00:38:00,560
that it is actually a winter backdoor

837
00:38:00,560 --> 00:38:03,440
because of the magic number used by the

838
00:38:03,440 --> 00:38:06,960
wiki backdoors protocol

839
00:38:07,119 --> 00:38:10,400
so that was our finding about operation

840
00:38:10,400 --> 00:38:11,520
camera

841
00:38:11,520 --> 00:38:14,400
now i'm going to share some recent apt

842
00:38:14,400 --> 00:38:16,720
events in taiwan

843
00:38:16,720 --> 00:38:18,800
as we mentioned at the beginning

844
00:38:18,800 --> 00:38:21,119
taiwan's national gasoline company was

845
00:38:21,119 --> 00:38:22,720
hit by a new ransomware

846
00:38:22,720 --> 00:38:26,880
called codelock it was based on

847
00:38:26,880 --> 00:38:31,760
an open source ransomware called eda2

848
00:38:31,760 --> 00:38:34,800
investigation bureau found that cobalt

849
00:38:34,800 --> 00:38:35,839
strike

850
00:38:35,839 --> 00:38:40,000
and investigation bureau found the cable

851
00:38:40,000 --> 00:38:40,560
strike

852
00:38:40,560 --> 00:38:43,599
and some suspicious activity in their

853
00:38:43,599 --> 00:38:45,119
domain controller

854
00:38:45,119 --> 00:38:48,320
they say this event was related to rinky

855
00:38:48,320 --> 00:38:50,480
group

856
00:38:50,480 --> 00:38:54,000
also we had monitored several attacks

857
00:38:54,000 --> 00:38:56,800
against taiwan government agencies using

858
00:38:56,800 --> 00:38:58,320
skeleton key

859
00:38:58,320 --> 00:39:02,400
but with different backdoor password

860
00:39:02,400 --> 00:39:05,599
they use a modified version of mimikaz

861
00:39:05,599 --> 00:39:09,599
executed in memory only we think

862
00:39:09,599 --> 00:39:12,160
skeleton key might be a new trend in the

863
00:39:12,160 --> 00:39:14,160
near future

864
00:39:14,160 --> 00:39:17,839
now ck will make a conclusion for us

865
00:39:17,839 --> 00:39:21,280
about this talk in the end

866
00:39:21,280 --> 00:39:24,800
let me quickly to give some conclusion

867
00:39:24,800 --> 00:39:28,000
here is some takeaway in this

868
00:39:28,000 --> 00:39:30,880
talk we disclosure a large-scale aptly

869
00:39:30,880 --> 00:39:31,680
attack

870
00:39:31,680 --> 00:39:34,400
targeting semi-conductor vendors and

871
00:39:34,400 --> 00:39:35,280
there are more than

872
00:39:35,280 --> 00:39:38,240
seven vendors are compromised and these

873
00:39:38,240 --> 00:39:39,680
vendors are in taiwan

874
00:39:39,680 --> 00:39:43,200
and europe taker

875
00:39:43,200 --> 00:39:46,240
has a precisely a text they are not only

876
00:39:46,240 --> 00:39:47,040
targeting

877
00:39:47,040 --> 00:39:49,920
leading semiconductor vendors but also

878
00:39:49,920 --> 00:39:50,480
attack

879
00:39:50,480 --> 00:39:54,839
their subsidiaries partners and

880
00:39:54,839 --> 00:39:56,560
competitors

881
00:39:56,560 --> 00:39:59,040
different from other apt group their

882
00:39:59,040 --> 00:40:00,160
goal is to steal

883
00:40:00,160 --> 00:40:02,640
intelligent properties like the document

884
00:40:02,640 --> 00:40:03,440
source code

885
00:40:03,440 --> 00:40:06,960
and sdk which will make a long-term

886
00:40:06,960 --> 00:40:11,520
impact to the big victim enterprise

887
00:40:11,520 --> 00:40:14,240
from this motivate we may guess that

888
00:40:14,240 --> 00:40:15,920
taker

889
00:40:15,920 --> 00:40:18,319
is a business competitor or a stent

890
00:40:18,319 --> 00:40:19,520
sponsor

891
00:40:19,520 --> 00:40:24,000
to enhance their semiconductor industry

892
00:40:24,000 --> 00:40:27,680
we have find some ioc in the appendix

893
00:40:27,680 --> 00:40:30,480
so if you want to find some ioc you can

894
00:40:30,480 --> 00:40:31,119
reference

895
00:40:31,119 --> 00:40:35,359
to the appendix in this slide

896
00:40:36,880 --> 00:40:40,640
and from technical part the taker

897
00:40:40,640 --> 00:40:43,200
widely utilized some open source tool

898
00:40:43,200 --> 00:40:44,720
and general tools

899
00:40:44,720 --> 00:40:48,240
so it's hard to make the attribution

900
00:40:48,240 --> 00:40:50,319
and they also like to merge a different

901
00:40:50,319 --> 00:40:52,240
kind of of mower

902
00:40:52,240 --> 00:40:56,078
to make their own malware

903
00:40:56,240 --> 00:40:59,280
and english to sure case study

904
00:40:59,280 --> 00:41:02,960
their ad and vpn uncompromised

905
00:41:02,960 --> 00:41:06,160
so which julia the enterprise should

906
00:41:06,160 --> 00:41:07,760
consider the resilience

907
00:41:07,760 --> 00:41:10,880
of their i.t system and avoid to relying

908
00:41:10,880 --> 00:41:14,240
on a single security service

909
00:41:14,240 --> 00:41:16,720
we also discovered that attacker used a

910
00:41:16,720 --> 00:41:18,319
skeleton key

911
00:41:18,319 --> 00:41:20,480
which is rarely used but very powerful

912
00:41:20,480 --> 00:41:23,359
way for the taker

913
00:41:23,359 --> 00:41:26,079
and which makes adversaries looking like

914
00:41:26,079 --> 00:41:27,680
a normal user

915
00:41:27,680 --> 00:41:30,480
to achieve the persistent and defensive

916
00:41:30,480 --> 00:41:32,079
invasion

917
00:41:32,079 --> 00:41:35,119
so in the end uh i would like to say

918
00:41:35,119 --> 00:41:36,720
that no system is safe

919
00:41:36,720 --> 00:41:39,119
so we need to regularly to do the threat

920
00:41:39,119 --> 00:41:40,400
hunting

921
00:41:40,400 --> 00:41:43,520
and shorten the mean time to detect and

922
00:41:43,520 --> 00:41:46,560
mean title response

923
00:41:47,040 --> 00:41:48,960
and thank you for your listening and

924
00:41:48,960 --> 00:41:53,760
will come for your questions

