1
00:00:03,360 --> 00:00:13,158
[Music]

2
00:00:14,639 --> 00:00:16,320
before we begin i need to mention this

3
00:00:16,320 --> 00:00:17,760
forward-looking statement

4
00:00:17,760 --> 00:00:19,439
i'm not a lawyer i don't play one on tv

5
00:00:19,439 --> 00:00:21,439
or on the internet but this slide states

6
00:00:21,439 --> 00:00:22,960
the following presentation is not

7
00:00:22,960 --> 00:00:24,240
talking about any future

8
00:00:24,240 --> 00:00:26,160
products services strategies or

9
00:00:26,160 --> 00:00:27,760
commitments of salesforce

10
00:00:27,760 --> 00:00:29,439
do not try to use the following content

11
00:00:29,439 --> 00:00:31,760
for purchasing or trading decisions

12
00:00:31,760 --> 00:00:34,320
it probably won't go well thank you for

13
00:00:34,320 --> 00:00:35,520
tuning in to our talk

14
00:00:35,520 --> 00:00:37,600
i'm spencer curtin and with me is alan

15
00:00:37,600 --> 00:00:38,640
stegenovic

16
00:00:38,640 --> 00:00:40,480
we are on the abuse operations team at

17
00:00:40,480 --> 00:00:42,559
heroku where we keep users from doing

18
00:00:42,559 --> 00:00:45,360
bad things on to and from the platform

19
00:00:45,360 --> 00:00:47,039
this talk focuses on abuse

20
00:00:47,039 --> 00:00:50,480
and how we hunt for it on heroku

21
00:00:50,480 --> 00:00:52,640
heroku was purchased by salesforce about

22
00:00:52,640 --> 00:00:53,600
10 years ago

23
00:00:53,600 --> 00:00:55,760
it's a platform as a service that offers

24
00:00:55,760 --> 00:00:57,680
an easy interface to quickly go from

25
00:00:57,680 --> 00:00:58,559
idea to

26
00:00:58,559 --> 00:01:00,480
online application without having to

27
00:01:00,480 --> 00:01:02,160
manage and configure the underlying

28
00:01:02,160 --> 00:01:03,280
infrastructure

29
00:01:03,280 --> 00:01:05,760
so developers are free to focus on code

30
00:01:05,760 --> 00:01:07,200
and deploying it to the internet with

31
00:01:07,200 --> 00:01:08,560
very little effort

32
00:01:08,560 --> 00:01:10,320
it supports multiple languages and

33
00:01:10,320 --> 00:01:11,600
provides features like

34
00:01:11,600 --> 00:01:13,520
scalability backups continuous

35
00:01:13,520 --> 00:01:14,640
integration

36
00:01:14,640 --> 00:01:16,720
same default configurations and much

37
00:01:16,720 --> 00:01:17,759
much more

38
00:01:17,759 --> 00:01:19,520
and all you need is an email address to

39
00:01:19,520 --> 00:01:21,840
create an account

40
00:01:21,840 --> 00:01:23,360
to give you an idea about the size of

41
00:01:23,360 --> 00:01:25,520
the platform over nine million apps have

42
00:01:25,520 --> 00:01:26,240
been created

43
00:01:26,240 --> 00:01:28,400
over 2 million databases are managed and

44
00:01:28,400 --> 00:01:29,759
the infrastructure handles

45
00:01:29,759 --> 00:01:32,720
billions of requests a day and heroku

46
00:01:32,720 --> 00:01:35,680
runs on heroku

47
00:01:35,680 --> 00:01:38,479
all right so heroku is a platform as a

48
00:01:38,479 --> 00:01:41,119
service right we run anyone's code on

49
00:01:41,119 --> 00:01:42,960
the internet as directed from unknown

50
00:01:42,960 --> 00:01:43,920
sources

51
00:01:43,920 --> 00:01:47,280
millions of times a day

52
00:01:47,439 --> 00:01:51,040
okay we are rce as a service

53
00:01:51,040 --> 00:01:52,399
to be fair the part of the platform

54
00:01:52,399 --> 00:01:54,079
we're talking about is referred to

55
00:01:54,079 --> 00:01:56,880
as the free tier or the common run time

56
00:01:56,880 --> 00:01:58,560
heroku has other offerings that are not

57
00:01:58,560 --> 00:02:00,159
like this but we won't be talking about

58
00:02:00,159 --> 00:02:01,360
them today

59
00:02:01,360 --> 00:02:03,600
our focus will be on how we defend the

60
00:02:03,600 --> 00:02:04,799
common run time

61
00:02:04,799 --> 00:02:08,000
from abusive bad actors we

62
00:02:08,000 --> 00:02:10,000
define abuse as the unintended

63
00:02:10,000 --> 00:02:11,200
monetization of

64
00:02:11,200 --> 00:02:13,599
anything so if you have a free service a

65
00:02:13,599 --> 00:02:14,800
free trial

66
00:02:14,800 --> 00:02:16,720
or any offering that has an angle to

67
00:02:16,720 --> 00:02:18,080
extract value

68
00:02:18,080 --> 00:02:20,000
somebody is already trying to figure out

69
00:02:20,000 --> 00:02:22,239
a way to make money off of it

70
00:02:22,239 --> 00:02:24,239
it's a very fine line between a business

71
00:02:24,239 --> 00:02:25,840
trying to get off the ground

72
00:02:25,840 --> 00:02:27,680
and an abuser trying to take advantage

73
00:02:27,680 --> 00:02:29,040
of your services

74
00:02:29,040 --> 00:02:30,640
sometimes it's obvious like theft of

75
00:02:30,640 --> 00:02:33,680
resources other times it's not so clear

76
00:02:33,680 --> 00:02:35,519
for example think about a social media

77
00:02:35,519 --> 00:02:38,400
poll it's intended for honest input

78
00:02:38,400 --> 00:02:40,400
but it's gameable because it's not one

79
00:02:40,400 --> 00:02:42,080
person one vote

80
00:02:42,080 --> 00:02:44,800
it's one account one vote so the person

81
00:02:44,800 --> 00:02:46,800
in control of the most accounts

82
00:02:46,800 --> 00:02:50,239
wins the problem isn't new the scams

83
00:02:50,239 --> 00:02:51,519
aren't new

84
00:02:51,519 --> 00:02:53,519
but we see them leveraging more and more

85
00:02:53,519 --> 00:02:54,720
of the cloud

86
00:02:54,720 --> 00:02:56,480
now is there a single view that captures

87
00:02:56,480 --> 00:02:59,280
the full picture of the entire operation

88
00:02:59,280 --> 00:03:01,040
across the industry we may have that

89
00:03:01,040 --> 00:03:04,000
full picture but not today

90
00:03:04,000 --> 00:03:06,239
from our limited view we've identified a

91
00:03:06,239 --> 00:03:08,480
number of puzzle pieces that we feel

92
00:03:08,480 --> 00:03:11,920
have been under reported

93
00:03:12,080 --> 00:03:14,239
now on a more practical layer we see a

94
00:03:14,239 --> 00:03:16,480
portion of that picture realized through

95
00:03:16,480 --> 00:03:18,000
misused malice and crime

96
00:03:18,000 --> 00:03:20,159
on our platform legal documents like the

97
00:03:20,159 --> 00:03:22,480
acceptable use policy the aup

98
00:03:22,480 --> 00:03:24,640
provide a list of prohibited content and

99
00:03:24,640 --> 00:03:26,799
actions so it's like the list of don'ts

100
00:03:26,799 --> 00:03:28,080
for users to follow

101
00:03:28,080 --> 00:03:29,519
and it also serves as a set of

102
00:03:29,519 --> 00:03:31,760
guidelines for our team to uphold

103
00:03:31,760 --> 00:03:33,920
obviously this can't cover every type of

104
00:03:33,920 --> 00:03:35,280
abuse activity

105
00:03:35,280 --> 00:03:37,120
and even if it did it could act like a

106
00:03:37,120 --> 00:03:38,879
laundry list for an abuser to know what

107
00:03:38,879 --> 00:03:40,080
kind of badness

108
00:03:40,080 --> 00:03:43,040
could be performed from the platform so

109
00:03:43,040 --> 00:03:44,560
let's look at how we group

110
00:03:44,560 --> 00:03:48,080
violations of the aup

111
00:03:48,319 --> 00:03:51,200
there are unintentional violations and

112
00:03:51,200 --> 00:03:54,159
there are intentional violations

113
00:03:54,159 --> 00:03:55,840
to determine if intentional or

114
00:03:55,840 --> 00:03:58,080
unintentional or good or bad

115
00:03:58,080 --> 00:04:00,560
we establish intent and we do that by

116
00:04:00,560 --> 00:04:02,319
collecting and connecting as many

117
00:04:02,319 --> 00:04:03,840
indicators of abuse

118
00:04:03,840 --> 00:04:07,519
as necessary so unintentional could be

119
00:04:07,519 --> 00:04:09,439
a customer that deploys a poorly written

120
00:04:09,439 --> 00:04:11,360
app that consumes more than its share of

121
00:04:11,360 --> 00:04:12,480
resources

122
00:04:12,480 --> 00:04:14,799
and now they've become a noisy neighbor

123
00:04:14,799 --> 00:04:15,920
so not malicious

124
00:04:15,920 --> 00:04:17,519
but kind of like they were accidentally

125
00:04:17,519 --> 00:04:19,519
jerks totally unaware that there was an

126
00:04:19,519 --> 00:04:20,798
issue with their code

127
00:04:20,798 --> 00:04:22,479
until we suspend their app and open up a

128
00:04:22,479 --> 00:04:24,880
support ticket so they can fix it

129
00:04:24,880 --> 00:04:26,639
the intentional abusers are what make

130
00:04:26,639 --> 00:04:28,960
this job really interesting

131
00:04:28,960 --> 00:04:30,720
these users have skills that range from

132
00:04:30,720 --> 00:04:32,720
script kitty all the way to rogue

133
00:04:32,720 --> 00:04:34,479
advanced developer which we call our

134
00:04:34,479 --> 00:04:36,000
apex actors

135
00:04:36,000 --> 00:04:37,840
skids will be skids and deploy code

136
00:04:37,840 --> 00:04:39,680
found on github youtube

137
00:04:39,680 --> 00:04:42,160
or whatever their buddy gave them to run

138
00:04:42,160 --> 00:04:43,600
at times we'll get what feels like a

139
00:04:43,600 --> 00:04:45,040
swarm of abuse

140
00:04:45,040 --> 00:04:47,120
centered around a particular app like a

141
00:04:47,120 --> 00:04:49,680
proxy kit or a peer-to-peer app

142
00:04:49,680 --> 00:04:51,120
then there are the quick and loud

143
00:04:51,120 --> 00:04:53,280
abusers they could care less about being

144
00:04:53,280 --> 00:04:54,160
detected

145
00:04:54,160 --> 00:04:55,919
and will attempt to stand up at ddos

146
00:04:55,919 --> 00:04:58,000
farm and attack a target as quickly as

147
00:04:58,000 --> 00:04:59,440
possible

148
00:04:59,440 --> 00:05:01,199
the actors that are patient skilled and

149
00:05:01,199 --> 00:05:03,440
criminal are the more dangerous group

150
00:05:03,440 --> 00:05:05,680
these actors attempt to iterate past our

151
00:05:05,680 --> 00:05:06,880
detection capabilities

152
00:05:06,880 --> 00:05:08,720
they may try to social engineer support

153
00:05:08,720 --> 00:05:10,000
staff to gain insight

154
00:05:10,000 --> 00:05:11,919
into how they were detected after being

155
00:05:11,919 --> 00:05:13,120
suspended

156
00:05:13,120 --> 00:05:15,120
and will try anything to maximize their

157
00:05:15,120 --> 00:05:17,440
use of our platform

158
00:05:17,440 --> 00:05:19,039
now these users are not exploiting

159
00:05:19,039 --> 00:05:20,639
technical vulnerabilities within the

160
00:05:20,639 --> 00:05:22,080
platform itself

161
00:05:22,080 --> 00:05:24,479
they take advantage of gaps in business

162
00:05:24,479 --> 00:05:25,840
logic

163
00:05:25,840 --> 00:05:27,919
the majority are not too advanced but

164
00:05:27,919 --> 00:05:29,520
are very persistent

165
00:05:29,520 --> 00:05:32,000
so if you like to think about apt small

166
00:05:32,000 --> 00:05:32,880
lowercase a

167
00:05:32,880 --> 00:05:35,759
and a big capital p and again

168
00:05:35,759 --> 00:05:37,520
financially motivated

169
00:05:37,520 --> 00:05:40,000
now when we say persistent we mean that

170
00:05:40,000 --> 00:05:41,600
an account that after an account has

171
00:05:41,600 --> 00:05:42,880
been suspended

172
00:05:42,880 --> 00:05:44,320
the same actor will use a different

173
00:05:44,320 --> 00:05:46,479
email address or a sub inbox of the

174
00:05:46,479 --> 00:05:48,240
original email address to create a new

175
00:05:48,240 --> 00:05:49,440
account

176
00:05:49,440 --> 00:05:50,960
we'll cover a couple campaigns during

177
00:05:50,960 --> 00:05:54,400
the show and tell section of the talk

178
00:05:54,400 --> 00:05:56,720
so here's a fun one how do we define

179
00:05:56,720 --> 00:05:58,560
ourselves where do we fit within the

180
00:05:58,560 --> 00:05:59,520
company

181
00:05:59,520 --> 00:06:01,120
well maybe we can start by listing the

182
00:06:01,120 --> 00:06:02,960
things that we're not

183
00:06:02,960 --> 00:06:05,360
we're not red team but we learn a lot

184
00:06:05,360 --> 00:06:06,240
from them

185
00:06:06,240 --> 00:06:08,560
we're not blue team but we borrow from

186
00:06:08,560 --> 00:06:09,520
them

187
00:06:09,520 --> 00:06:11,680
we're not purple team but we talk to

188
00:06:11,680 --> 00:06:13,840
more groups across the organization

189
00:06:13,840 --> 00:06:16,000
we're not c-cert but we conduct

190
00:06:16,000 --> 00:06:17,520
investigations

191
00:06:17,520 --> 00:06:20,560
we're not security but we monitor for

192
00:06:20,560 --> 00:06:22,240
outbound attacks

193
00:06:22,240 --> 00:06:24,800
we're not grc but we write up risks

194
00:06:24,800 --> 00:06:26,639
around business rules

195
00:06:26,639 --> 00:06:28,560
we're not anti-fraud but we use the same

196
00:06:28,560 --> 00:06:29,680
data

197
00:06:29,680 --> 00:06:31,680
we're not service reliability but we

198
00:06:31,680 --> 00:06:33,360
help keep the platform stable

199
00:06:33,360 --> 00:06:35,039
we're not encompassed by any one of

200
00:06:35,039 --> 00:06:37,360
these groups but we overlap in so many

201
00:06:37,360 --> 00:06:38,400
ways

202
00:06:38,400 --> 00:06:41,280
we are abuse operations we exist because

203
00:06:41,280 --> 00:06:42,720
the business understands that there is

204
00:06:42,720 --> 00:06:43,600
risk of having

205
00:06:43,600 --> 00:06:46,160
unwanted activity given an environment

206
00:06:46,160 --> 00:06:49,120
that's rce as a service

207
00:06:49,120 --> 00:06:52,080
overall we define abuse operations as a

208
00:06:52,080 --> 00:06:53,440
specialized dfir

209
00:06:53,440 --> 00:06:55,360
team that requires a wide view across

210
00:06:55,360 --> 00:06:57,199
the business as shown

211
00:06:57,199 --> 00:06:58,880
our goal is to push bad actors from the

212
00:06:58,880 --> 00:07:01,199
platform and put a spotlight on abuse

213
00:07:01,199 --> 00:07:02,160
patterns

214
00:07:02,160 --> 00:07:04,560
so that engineering teams in the

215
00:07:04,560 --> 00:07:06,319
business can address them

216
00:07:06,319 --> 00:07:08,960
heroku is exceptionally collaborative

217
00:07:08,960 --> 00:07:11,199
teams openly share views and metrics

218
00:07:11,199 --> 00:07:12,720
and just ping us when things look odd on

219
00:07:12,720 --> 00:07:15,120
their end this enables us to move

220
00:07:15,120 --> 00:07:18,400
very fast now pack your bags because

221
00:07:18,400 --> 00:07:19,919
alan's going to walk you through

222
00:07:19,919 --> 00:07:23,440
how we hunt alan

223
00:07:23,440 --> 00:07:25,919
thank you spencer hi i'm alan

224
00:07:25,919 --> 00:07:27,039
strojanovic

225
00:07:27,039 --> 00:07:30,400
and we hunt we don't want to wait for

226
00:07:30,400 --> 00:07:32,160
the badness to have to hurt us

227
00:07:32,160 --> 00:07:33,280
we're looking for wolves in sheep's

228
00:07:33,280 --> 00:07:35,520
clothing after all most of our hunting

229
00:07:35,520 --> 00:07:36,479
starts with

230
00:07:36,479 --> 00:07:38,880
suspicious indicators suspicious

231
00:07:38,880 --> 00:07:40,560
indicators derive from a combination of

232
00:07:40,560 --> 00:07:42,080
internal user data and external

233
00:07:42,080 --> 00:07:42,960
information

234
00:07:42,960 --> 00:07:45,520
about that data for example an app with

235
00:07:45,520 --> 00:07:47,440
an abnormally high cpu would generate an

236
00:07:47,440 --> 00:07:49,039
event based alarm

237
00:07:49,039 --> 00:07:51,360
and on the slide is a short list of some

238
00:07:51,360 --> 00:07:53,360
of the sources of these indicators

239
00:07:53,360 --> 00:07:54,720
just understand that the indicators

240
00:07:54,720 --> 00:07:56,800
we're getting are considered low value

241
00:07:56,800 --> 00:07:58,160
by themselves they rarely have enough

242
00:07:58,160 --> 00:08:00,800
context to make a decision

243
00:08:00,800 --> 00:08:02,720
now given a starting suspicious

244
00:08:02,720 --> 00:08:03,919
indicator we

245
00:08:03,919 --> 00:08:06,319
form a hypothesis about the intent of

246
00:08:06,319 --> 00:08:07,039
the actor

247
00:08:07,039 --> 00:08:09,440
we start looking for related indicators

248
00:08:09,440 --> 00:08:11,199
to try and prove or disprove

249
00:08:11,199 --> 00:08:14,560
that hypothesis for instance it just so

250
00:08:14,560 --> 00:08:16,479
happens that given a high cpu

251
00:08:16,479 --> 00:08:19,039
with high network usage a match for a

252
00:08:19,039 --> 00:08:20,720
popular file download program and the

253
00:08:20,720 --> 00:08:22,000
substring torrents

254
00:08:22,000 --> 00:08:24,319
in the app name is probably a peer to

255
00:08:24,319 --> 00:08:25,440
peer app

256
00:08:25,440 --> 00:08:27,520
true story now each of these indicators

257
00:08:27,520 --> 00:08:29,120
is not proof of intent individually but

258
00:08:29,120 --> 00:08:30,720
you can see that collectively they make

259
00:08:30,720 --> 00:08:32,000
a really strong case

260
00:08:32,000 --> 00:08:33,760
a collection of low-value indicators

261
00:08:33,760 --> 00:08:35,599
does become a very good footprint of

262
00:08:35,599 --> 00:08:38,000
malicious activity

263
00:08:38,000 --> 00:08:40,479
to increase the confidence we keep

264
00:08:40,479 --> 00:08:41,760
asking the question

265
00:08:41,760 --> 00:08:44,720
what else you got and as more indicators

266
00:08:44,720 --> 00:08:46,160
are discovered we try and think about

267
00:08:46,160 --> 00:08:48,480
why they are the way that they are for

268
00:08:48,480 --> 00:08:49,440
instance a

269
00:08:49,440 --> 00:08:51,519
face rolled email address like shown is

270
00:08:51,519 --> 00:08:52,800
a pretty good indicator that

271
00:08:52,800 --> 00:08:54,320
the user doesn't really value the

272
00:08:54,320 --> 00:08:56,880
account it's likely a throwaway account

273
00:08:56,880 --> 00:08:58,640
but this is not necessarily by itself

274
00:08:58,640 --> 00:09:01,440
bad a face rolled app name similarly

275
00:09:01,440 --> 00:09:03,120
is not necessarily bad it could be

276
00:09:03,120 --> 00:09:04,720
something for a quick test something to

277
00:09:04,720 --> 00:09:06,080
be discarded

278
00:09:06,080 --> 00:09:08,959
however a face rolled email address with

279
00:09:08,959 --> 00:09:10,720
a collection of face rolled app names

280
00:09:10,720 --> 00:09:13,279
and multiple failed attempts to verify

281
00:09:13,279 --> 00:09:14,480
different credit cards

282
00:09:14,480 --> 00:09:15,920
and finally landing on a working credit

283
00:09:15,920 --> 00:09:17,440
card that has been previously used by a

284
00:09:17,440 --> 00:09:19,600
previously identified malicious actor

285
00:09:19,600 --> 00:09:21,360
is worthy of further scrutiny i'm sure

286
00:09:21,360 --> 00:09:23,200
you will agree

287
00:09:23,200 --> 00:09:24,880
by the way in case it's not clear the

288
00:09:24,880 --> 00:09:26,320
difference between a face world app

289
00:09:26,320 --> 00:09:28,320
a face world string and a random string

290
00:09:28,320 --> 00:09:30,080
is whether it's created by hand

291
00:09:30,080 --> 00:09:34,240
or by computer think keyboard mashing

292
00:09:34,240 --> 00:09:36,720
now establishing intent is as one would

293
00:09:36,720 --> 00:09:37,920
expect the art of figuring out what the

294
00:09:37,920 --> 00:09:39,200
actor's trying to do

295
00:09:39,200 --> 00:09:41,279
now our we have two goals here uh goal

296
00:09:41,279 --> 00:09:42,640
number one is determining what the actor

297
00:09:42,640 --> 00:09:43,360
is trying to do

298
00:09:43,360 --> 00:09:45,040
while goal number two is determining

299
00:09:45,040 --> 00:09:46,880
what the actors trying to do before they

300
00:09:46,880 --> 00:09:47,920
do it

301
00:09:47,920 --> 00:09:50,000
now we usually reserve goal number two

302
00:09:50,000 --> 00:09:51,600
for actors that we've seen before so

303
00:09:51,600 --> 00:09:53,120
that we can avoid that whole pre-crime

304
00:09:53,120 --> 00:09:53,839
scenario

305
00:09:53,839 --> 00:09:55,920
we really try and not really try hard

306
00:09:55,920 --> 00:09:57,600
not to kick someone off the platform

307
00:09:57,600 --> 00:09:59,600
before they've actually done anything

308
00:09:59,600 --> 00:10:01,440
bad

309
00:10:01,440 --> 00:10:02,959
making a decision and taking an action

310
00:10:02,959 --> 00:10:04,480
is of course the crux of the matter at

311
00:10:04,480 --> 00:10:05,920
this point we have collected a bunch of

312
00:10:05,920 --> 00:10:06,720
indicators and

313
00:10:06,720 --> 00:10:08,079
that should give us a reasonably good

314
00:10:08,079 --> 00:10:09,920
idea of the intent of the activity

315
00:10:09,920 --> 00:10:12,079
it's time to take action if the intent

316
00:10:12,079 --> 00:10:13,760
is bad then suspensions evidence

317
00:10:13,760 --> 00:10:15,120
collections deletions

318
00:10:15,120 --> 00:10:16,800
all that kind of stuff comes into play

319
00:10:16,800 --> 00:10:18,560
if the intent is not bad

320
00:10:18,560 --> 00:10:21,279
then watch lists or allow lists or

321
00:10:21,279 --> 00:10:23,200
adjustments for false positives or

322
00:10:23,200 --> 00:10:24,640
opening of support tickets are among

323
00:10:24,640 --> 00:10:26,160
some of the things we can do

324
00:10:26,160 --> 00:10:28,000
analyst discretion is kind of necessary

325
00:10:28,000 --> 00:10:29,279
here is it good

326
00:10:29,279 --> 00:10:32,079
or just not bad yet sometimes

327
00:10:32,079 --> 00:10:33,440
undetermined intent really just means

328
00:10:33,440 --> 00:10:34,240
there's not enough

329
00:10:34,240 --> 00:10:36,720
indicators to establish an intent to

330
00:10:36,720 --> 00:10:38,640
make an action

331
00:10:38,640 --> 00:10:41,040
in which case it goes back into the pool

332
00:10:41,040 --> 00:10:42,640
no other actions to be taken

333
00:10:42,640 --> 00:10:44,000
and it'll be reassessed when it

334
00:10:44,000 --> 00:10:45,600
percolates to the top again due to a new

335
00:10:45,600 --> 00:10:47,839
alert

336
00:10:48,240 --> 00:10:49,839
now we have a bunch of indicators we

337
00:10:49,839 --> 00:10:51,360
have enough to establish intent we've

338
00:10:51,360 --> 00:10:52,720
made our decision and we've taken the

339
00:10:52,720 --> 00:10:54,399
corresponding action

340
00:10:54,399 --> 00:10:56,480
now we look to see how widespread this

341
00:10:56,480 --> 00:10:58,320
activity is we gather all the accounts

342
00:10:58,320 --> 00:10:59,760
associated with the

343
00:10:59,760 --> 00:11:01,440
indicators we have and we look for other

344
00:11:01,440 --> 00:11:03,040
common indicators that we may have

345
00:11:03,040 --> 00:11:03,760
missed

346
00:11:03,760 --> 00:11:05,680
we then add those indicators to our

347
00:11:05,680 --> 00:11:08,079
collection and see if any accounts

348
00:11:08,079 --> 00:11:11,120
match that that we may also have missed

349
00:11:11,120 --> 00:11:12,560
this strengthens the footprint and makes

350
00:11:12,560 --> 00:11:14,160
it suitable for

351
00:11:14,160 --> 00:11:16,640
automation automation is how we reduce

352
00:11:16,640 --> 00:11:17,760
toil

353
00:11:17,760 --> 00:11:19,040
we never want to see the same abuse

354
00:11:19,040 --> 00:11:20,640
again so we automate the collection

355
00:11:20,640 --> 00:11:22,560
detection and actioning of the footprint

356
00:11:22,560 --> 00:11:25,519
the one we just actioned our automation

357
00:11:25,519 --> 00:11:26,720
can also be set up to run

358
00:11:26,720 --> 00:11:28,959
the new footprint retroactively so that

359
00:11:28,959 --> 00:11:30,480
older implementations of badness will

360
00:11:30,480 --> 00:11:31,680
also be detected and

361
00:11:31,680 --> 00:11:33,440
actioned as well this cleans up any

362
00:11:33,440 --> 00:11:34,959
stragglers

363
00:11:34,959 --> 00:11:36,640
we log the action that is taken so that

364
00:11:36,640 --> 00:11:38,240
we can use that information next time we

365
00:11:38,240 --> 00:11:39,519
run through the loop this is how we get

366
00:11:39,519 --> 00:11:39,920
that

367
00:11:39,920 --> 00:11:42,000
have we seen this before question

368
00:11:42,000 --> 00:11:44,640
answered there's of course trade-offs

369
00:11:44,640 --> 00:11:46,560
automation will result in some loss of

370
00:11:46,560 --> 00:11:48,800
visibility the investigation performed

371
00:11:48,800 --> 00:11:50,320
in the previous step

372
00:11:50,320 --> 00:11:52,000
helps build robustness so that there's

373
00:11:52,000 --> 00:11:53,680
longevity in the automation

374
00:11:53,680 --> 00:11:56,160
of this action counter-intuitively

375
00:11:56,160 --> 00:11:58,240
taking this extra step helps reduce toil

376
00:11:58,240 --> 00:12:01,839
in the long run why do we use the term

377
00:12:01,839 --> 00:12:02,720
footprint

378
00:12:02,720 --> 00:12:05,040
simply because fingerprint or profile

379
00:12:05,040 --> 00:12:06,800
implies something a little too unique

380
00:12:06,800 --> 00:12:08,079
a footprint as a collection of

381
00:12:08,079 --> 00:12:09,440
indicators helps us remember that an

382
00:12:09,440 --> 00:12:10,880
actor can be more than one person

383
00:12:10,880 --> 00:12:13,519
can be a bot can be multiple specialized

384
00:12:13,519 --> 00:12:14,320
actor groups

385
00:12:14,320 --> 00:12:17,360
or some combination thereof

386
00:12:17,360 --> 00:12:19,040
and then of course we do it all over

387
00:12:19,040 --> 00:12:21,120
again

388
00:12:21,120 --> 00:12:23,680
let's recap suspicious indicators come

389
00:12:23,680 --> 00:12:25,440
to us as high-water mark alarms abuse

390
00:12:25,440 --> 00:12:26,880
complaints or as the results of artifact

391
00:12:26,880 --> 00:12:27,920
exploration

392
00:12:27,920 --> 00:12:30,639
including previous historic events we

393
00:12:30,639 --> 00:12:31,839
add context

394
00:12:31,839 --> 00:12:33,760
and more indicators from both internal

395
00:12:33,760 --> 00:12:34,880
and external sources

396
00:12:34,880 --> 00:12:37,279
so that we can increase the confidence

397
00:12:37,279 --> 00:12:38,880
when we're trying to establish

398
00:12:38,880 --> 00:12:41,360
intent so that we can make a decision

399
00:12:41,360 --> 00:12:42,959
and take an action

400
00:12:42,959 --> 00:12:45,360
we then investigate often retroactively

401
00:12:45,360 --> 00:12:46,639
to find more indicators that

402
00:12:46,639 --> 00:12:47,760
collectively

403
00:12:47,760 --> 00:12:52,000
are suitable for automation and then we

404
00:12:52,000 --> 00:12:54,959
rinse and repeat let's talk about some

405
00:12:54,959 --> 00:12:56,079
tools

406
00:12:56,079 --> 00:12:57,600
we have an event collector that acts

407
00:12:57,600 --> 00:12:59,040
like a classic sam it handles our

408
00:12:59,040 --> 00:13:00,639
alerting and reporting and can send info

409
00:13:00,639 --> 00:13:03,120
to other tools as well as receive them

410
00:13:03,120 --> 00:13:04,880
we have database query tools that can

411
00:13:04,880 --> 00:13:06,639
run queries automatically

412
00:13:06,639 --> 00:13:08,079
and we also run them manually when we

413
00:13:08,079 --> 00:13:09,920
need to test hypotheses or

414
00:13:09,920 --> 00:13:12,079
you know check to confirm that the

415
00:13:12,079 --> 00:13:13,600
results of automatic suspensions is

416
00:13:13,600 --> 00:13:15,360
still working properly

417
00:13:15,360 --> 00:13:16,959
we have malware analysis tools that can

418
00:13:16,959 --> 00:13:18,800
scan apps statically or dynamically

419
00:13:18,800 --> 00:13:20,399
and they send the results to other tools

420
00:13:20,399 --> 00:13:22,959
as well we have a ticket system

421
00:13:22,959 --> 00:13:25,600
now most places don't consider ticket

422
00:13:25,600 --> 00:13:26,800
systems as part of the tooling

423
00:13:26,800 --> 00:13:28,720
but we do if for no other reason than it

424
00:13:28,720 --> 00:13:30,560
is

425
00:13:30,560 --> 00:13:32,240
we need to be able to reduce the toil

426
00:13:32,240 --> 00:13:34,160
there as well

427
00:13:34,160 --> 00:13:35,760
and we have our suspension tools that

428
00:13:35,760 --> 00:13:37,839
suspend users and apps

429
00:13:37,839 --> 00:13:40,720
this encompasses a complex rule set that

430
00:13:40,720 --> 00:13:42,399
is implemented as guardrails so we don't

431
00:13:42,399 --> 00:13:43,440
accidentally you know

432
00:13:43,440 --> 00:13:46,800
suspend the entire world

433
00:13:46,800 --> 00:13:48,639
we track two general types of activities

434
00:13:48,639 --> 00:13:51,040
campaigns and prohibited software

435
00:13:51,040 --> 00:13:54,320
campaigns track actors and victims and

436
00:13:54,320 --> 00:13:55,440
custom software that they may have

437
00:13:55,440 --> 00:13:57,760
written prohibited software on the other

438
00:13:57,760 --> 00:13:59,440
hand looks for known malware

439
00:13:59,440 --> 00:14:01,600
tracks c2 communications and similar

440
00:14:01,600 --> 00:14:02,720
artifacts

441
00:14:02,720 --> 00:14:05,279
and known abusive software that anyone

442
00:14:05,279 --> 00:14:06,480
can install including those

443
00:14:06,480 --> 00:14:09,680
with that deployed heroku button

444
00:14:09,680 --> 00:14:12,480
let's put that together any tool can

445
00:14:12,480 --> 00:14:13,120
talk to

446
00:14:13,120 --> 00:14:15,120
any other tool even if it is the machine

447
00:14:15,120 --> 00:14:16,720
equivalent of i see bad

448
00:14:16,720 --> 00:14:19,120
do you see bad any tool can tell the

449
00:14:19,120 --> 00:14:20,720
suspension tools that a user an app

450
00:14:20,720 --> 00:14:22,560
needs to be suspended

451
00:14:22,560 --> 00:14:24,320
suspension tools have their own allow

452
00:14:24,320 --> 00:14:25,920
and deny lists and internal business

453
00:14:25,920 --> 00:14:27,760
logic to help identify and stop mistakes

454
00:14:27,760 --> 00:14:30,480
before they become costly and everything

455
00:14:30,480 --> 00:14:31,600
that these tools do

456
00:14:31,600 --> 00:14:34,800
is recorded now this may sound complex

457
00:14:34,800 --> 00:14:36,480
but this is what gets us the flexibility

458
00:14:36,480 --> 00:14:38,160
we need without taxing

459
00:14:38,160 --> 00:14:41,440
any singular system now after the jump

460
00:14:41,440 --> 00:14:42,839
cut we're going to continue with section

461
00:14:42,839 --> 00:14:44,560
5.

462
00:14:44,560 --> 00:14:48,160
let's talk about responding and reacting

463
00:14:48,160 --> 00:14:50,240
we align with the business they have of

464
00:14:50,240 --> 00:14:51,760
course set the task in the priority but

465
00:14:51,760 --> 00:14:52,959
it's up to us to be able to interpret

466
00:14:52,959 --> 00:14:53,600
them

467
00:14:53,600 --> 00:14:55,600
the business wants us to remove abuse

468
00:14:55,600 --> 00:14:57,519
faster fair enough

469
00:14:57,519 --> 00:14:59,120
but this means that we need faster and

470
00:14:59,120 --> 00:15:01,360
more accurate detection logic

471
00:15:01,360 --> 00:15:03,440
the business also wants less abuse or at

472
00:15:03,440 --> 00:15:05,440
least less costly abuse

473
00:15:05,440 --> 00:15:07,519
fine but that requires us to study the

474
00:15:07,519 --> 00:15:09,279
actors and what they are doing and how

475
00:15:09,279 --> 00:15:10,399
they affect the platform and the

476
00:15:10,399 --> 00:15:11,360
business

477
00:15:11,360 --> 00:15:14,000
now what the business really wants is

478
00:15:14,000 --> 00:15:15,279
they want the problem to just

479
00:15:15,279 --> 00:15:18,320
go away now this does seem simplistic uh

480
00:15:18,320 --> 00:15:19,600
but after giving it some thought we

481
00:15:19,600 --> 00:15:21,040
realize that there actually is a path

482
00:15:21,040 --> 00:15:21,440
here

483
00:15:21,440 --> 00:15:23,600
uh it's via platform hardening and

484
00:15:23,600 --> 00:15:25,199
demotivating actors

485
00:15:25,199 --> 00:15:26,320
if we make the entire thing less

486
00:15:26,320 --> 00:15:28,720
hospitable to abuse maybe we can get

487
00:15:28,720 --> 00:15:29,519
close

488
00:15:29,519 --> 00:15:32,240
now we in abuse ops we're selfish we

489
00:15:32,240 --> 00:15:34,560
want all of this

490
00:15:34,560 --> 00:15:36,160
the first two items in the list on the

491
00:15:36,160 --> 00:15:37,519
that previous slide they kind of have

492
00:15:37,519 --> 00:15:38,800
competing requirements

493
00:15:38,800 --> 00:15:40,800
the first requires us to respond quicker

494
00:15:40,800 --> 00:15:42,480
and the second to study the actor in

495
00:15:42,480 --> 00:15:44,639
their actions and hence respond slower

496
00:15:44,639 --> 00:15:46,160
there are pros and cons to each of these

497
00:15:46,160 --> 00:15:47,519
strategies the big ones being that

498
00:15:47,519 --> 00:15:48,320
quicker

499
00:15:48,320 --> 00:15:50,000
is usually easier but prone to false

500
00:15:50,000 --> 00:15:51,360
positives while slower

501
00:15:51,360 --> 00:15:54,000
produces better situational awareness

502
00:15:54,000 --> 00:15:55,839
but since the actor may still be active

503
00:15:55,839 --> 00:15:57,440
it could be more damaging

504
00:15:57,440 --> 00:15:59,199
we have found that it's sometimes worth

505
00:15:59,199 --> 00:16:00,800
switching back and forth depending on

506
00:16:00,800 --> 00:16:02,160
what we're seeing at that moment in time

507
00:16:02,160 --> 00:16:03,759
and we've also found that going slow

508
00:16:03,759 --> 00:16:04,399
first

509
00:16:04,399 --> 00:16:07,519
does allow us to act quicker later with

510
00:16:07,519 --> 00:16:10,240
more accuracy

511
00:16:10,240 --> 00:16:11,519
now moving quicker requires some

512
00:16:11,519 --> 00:16:13,440
visibility situational awareness

513
00:16:13,440 --> 00:16:15,279
not only requires visibility but also

514
00:16:15,279 --> 00:16:16,560
requires studying the actors

515
00:16:16,560 --> 00:16:19,519
and hence going slower so overall we end

516
00:16:19,519 --> 00:16:19,759
up

517
00:16:19,759 --> 00:16:23,279
going slower to ultimately go

518
00:16:23,279 --> 00:16:26,880
faster but with accuracy

519
00:16:26,880 --> 00:16:28,399
but when we first started out we had to

520
00:16:28,399 --> 00:16:29,839
go fast just to get our heads above

521
00:16:29,839 --> 00:16:31,279
water

522
00:16:31,279 --> 00:16:33,360
so between visibility and situational

523
00:16:33,360 --> 00:16:34,959
awareness just understand that

524
00:16:34,959 --> 00:16:36,240
there's a little bit of hidden

525
00:16:36,240 --> 00:16:38,399
complexity here

526
00:16:38,399 --> 00:16:42,320
now tracking actors is hard

527
00:16:42,320 --> 00:16:45,320
tracking persistent returning actors is

528
00:16:45,320 --> 00:16:47,040
hard

529
00:16:47,040 --> 00:16:49,120
okay not quite but there does not seem

530
00:16:49,120 --> 00:16:50,720
to be a well-defined way to track actors

531
00:16:50,720 --> 00:16:51,040
by

532
00:16:51,040 --> 00:16:53,920
footprint as we defined it and that

533
00:16:53,920 --> 00:16:55,839
gives us the flexibility that we desire

534
00:16:55,839 --> 00:16:57,440
we want to know if an actor changes

535
00:16:57,440 --> 00:16:58,880
behavior we want to know in an automatic

536
00:16:58,880 --> 00:17:00,000
way

537
00:17:00,000 --> 00:17:02,480
and when they do we want to be able to

538
00:17:02,480 --> 00:17:03,920
add the new indicator to the footprint

539
00:17:03,920 --> 00:17:05,599
in as few steps as possible we want to

540
00:17:05,599 --> 00:17:07,039
be able to split and merge

541
00:17:07,039 --> 00:17:09,039
footprints as we track multiple actors

542
00:17:09,039 --> 00:17:10,240
and we want

543
00:17:10,240 --> 00:17:12,400
this to be a tool just like the rest

544
00:17:12,400 --> 00:17:13,839
remember the requirements back in the

545
00:17:13,839 --> 00:17:15,039
tool slides

546
00:17:15,039 --> 00:17:18,079
no we want a lot today we

547
00:17:18,079 --> 00:17:20,720
track actors mostly manually this is a

548
00:17:20,720 --> 00:17:22,319
lot of toil

549
00:17:22,319 --> 00:17:23,520
we are looking to build a system that

550
00:17:23,520 --> 00:17:25,679
enables us to spot returning actors that

551
00:17:25,679 --> 00:17:27,280
have changed a ttp

552
00:17:27,280 --> 00:17:29,919
pivot or spot when a footprint is

553
00:17:29,919 --> 00:17:31,280
covering multiple actors

554
00:17:31,280 --> 00:17:34,799
like a splash or fingers crossed spot an

555
00:17:34,799 --> 00:17:36,080
actor that returns and starts from

556
00:17:36,080 --> 00:17:36,960
scratch

557
00:17:36,960 --> 00:17:39,919
re-tools let's look at those definitions

558
00:17:39,919 --> 00:17:41,600
a pivot is what we call a change to a

559
00:17:41,600 --> 00:17:43,200
ttp of a returning actor

560
00:17:43,200 --> 00:17:45,360
different from a pentester pivot if a

561
00:17:45,360 --> 00:17:46,880
footprint is a collection of indicators

562
00:17:46,880 --> 00:17:48,000
then given enough of them

563
00:17:48,000 --> 00:17:50,240
a partial match usually indicates a

564
00:17:50,240 --> 00:17:51,120
change in behavior

565
00:17:51,120 --> 00:17:54,320
by the same actor actors are people too

566
00:17:54,320 --> 00:17:56,000
when they're suspended they will test

567
00:17:56,000 --> 00:17:57,600
how by isolating for variables and

568
00:17:57,600 --> 00:17:59,120
making small changes one at a time

569
00:17:59,120 --> 00:18:02,240
until they get it working again

570
00:18:02,240 --> 00:18:04,320
so a form of threshold detection like

571
00:18:04,320 --> 00:18:06,559
shown works really well as an accurate

572
00:18:06,559 --> 00:18:08,000
way to detect their return

573
00:18:08,000 --> 00:18:10,559
and still take some action then updating

574
00:18:10,559 --> 00:18:11,840
the footprint with the new indicators

575
00:18:11,840 --> 00:18:13,840
reflecting the change they just made

576
00:18:13,840 --> 00:18:15,440
keeps the footprint accurate

577
00:18:15,440 --> 00:18:16,720
this is designed to make it difficult

578
00:18:16,720 --> 00:18:18,720
for a persistent actor to regain a

579
00:18:18,720 --> 00:18:19,360
foothold

580
00:18:19,360 --> 00:18:21,440
on the platform and it frustrates the

581
00:18:21,440 --> 00:18:22,400
heck out of them

582
00:18:22,400 --> 00:18:24,799
especially if we cut them off at each

583
00:18:24,799 --> 00:18:25,600
pivot

584
00:18:25,600 --> 00:18:28,720
and before they make a profit

585
00:18:28,720 --> 00:18:30,080
sometimes instead of seeing a singular

586
00:18:30,080 --> 00:18:32,000
pivot we see multiple pivots

587
00:18:32,000 --> 00:18:34,160
but with different partial footprints we

588
00:18:34,160 --> 00:18:35,440
call this a splash

589
00:18:35,440 --> 00:18:38,400
every slap a mud puddle this seems to

590
00:18:38,400 --> 00:18:39,679
mean that there are multiple actors

591
00:18:39,679 --> 00:18:41,600
operating under the same set of ttps

592
00:18:41,600 --> 00:18:43,760
we have found great value in looking for

593
00:18:43,760 --> 00:18:46,240
how they are sharing their tactics

594
00:18:46,240 --> 00:18:48,320
um are they reading all the same forms

595
00:18:48,320 --> 00:18:49,360
or are they

596
00:18:49,360 --> 00:18:51,440
using the same youtube instructional

597
00:18:51,440 --> 00:18:52,720
videos

598
00:18:52,720 --> 00:18:55,039
we find that the source that we find

599
00:18:55,039 --> 00:18:56,400
that if we find the source

600
00:18:56,400 --> 00:18:58,480
that we can have even more fun imagine

601
00:18:58,480 --> 00:18:59,919
knowing what they're going to do before

602
00:18:59,919 --> 00:19:01,200
they've even implemented it especially

603
00:19:01,200 --> 00:19:02,240
if it's a code change

604
00:19:02,240 --> 00:19:04,080
and adding those as indicators to the

605
00:19:04,080 --> 00:19:05,840
footprint before the change is even

606
00:19:05,840 --> 00:19:06,960
deployed

607
00:19:06,960 --> 00:19:10,080
frustrates them as well now shout out to

608
00:19:10,080 --> 00:19:11,600
our fantastic threat and tell team

609
00:19:11,600 --> 00:19:15,120
they help us find this stuff out there

610
00:19:15,440 --> 00:19:17,919
when we have all the tooling in place

611
00:19:17,919 --> 00:19:19,440
when pivot detection is working as

612
00:19:19,440 --> 00:19:20,240
designed

613
00:19:20,240 --> 00:19:21,840
and when we manage to stop actors before

614
00:19:21,840 --> 00:19:24,640
they've even begun then they have only

615
00:19:24,640 --> 00:19:25,360
two choices

616
00:19:25,360 --> 00:19:28,240
go somewhere else or retool when they

617
00:19:28,240 --> 00:19:29,840
retool they change significant portions

618
00:19:29,840 --> 00:19:30,799
of their apps their code their

619
00:19:30,799 --> 00:19:32,480
infrastructure and their behaviors

620
00:19:32,480 --> 00:19:34,480
that makes them indistinguishable from a

621
00:19:34,480 --> 00:19:35,760
new actor

622
00:19:35,760 --> 00:19:37,280
this used to bother us quite a bit but

623
00:19:37,280 --> 00:19:38,960
then it occurred to us

624
00:19:38,960 --> 00:19:41,039
so what the only reason that we could

625
00:19:41,039 --> 00:19:42,160
think of that we needed to tie two

626
00:19:42,160 --> 00:19:43,840
actors together was for law enforcement

627
00:19:43,840 --> 00:19:45,200
purposes anyway

628
00:19:45,200 --> 00:19:47,760
so that we could collect more evidence

629
00:19:47,760 --> 00:19:49,360
but this doesn't apply to all the actors

630
00:19:49,360 --> 00:19:51,440
and is actually kind of rare

631
00:19:51,440 --> 00:19:53,360
so retooled actors end up being

632
00:19:53,360 --> 00:19:54,960
identified as new actors just by the

633
00:19:54,960 --> 00:19:57,280
nature of how our hunt works

634
00:19:57,280 --> 00:19:59,280
and because we're pretty thorough in our

635
00:19:59,280 --> 00:20:00,960
indicator collection

636
00:20:00,960 --> 00:20:02,320
sometimes we find evidence that the new

637
00:20:02,320 --> 00:20:04,000
actors in fact the returning actor

638
00:20:04,000 --> 00:20:06,799
retooled after all

639
00:20:06,799 --> 00:20:09,919
actor reactions are fun some actors

640
00:20:09,919 --> 00:20:12,720
outright call us names others open

641
00:20:12,720 --> 00:20:13,280
tickets

642
00:20:13,280 --> 00:20:14,880
and try to social engineer support to

643
00:20:14,880 --> 00:20:16,400
get their loot or their infrastructure

644
00:20:16,400 --> 00:20:17,200
back

645
00:20:17,200 --> 00:20:19,280
others may be seeing the writing on the

646
00:20:19,280 --> 00:20:21,039
wall realize they've squeezed out what

647
00:20:21,039 --> 00:20:21,840
they can

648
00:20:21,840 --> 00:20:23,200
and go about convincing others to run

649
00:20:23,200 --> 00:20:24,960
their kits sometimes for pay

650
00:20:24,960 --> 00:20:27,600
look what i did you can do it too it's

651
00:20:27,600 --> 00:20:28,159
like they've

652
00:20:28,159 --> 00:20:29,520
found their own replacement for that

653
00:20:29,520 --> 00:20:32,400
actor's footprint

654
00:20:32,559 --> 00:20:34,159
that last business category though

655
00:20:34,159 --> 00:20:36,080
wanting the problem to go away

656
00:20:36,080 --> 00:20:38,799
it can be achieved by devaluing loot if

657
00:20:38,799 --> 00:20:40,799
we devalue the actors loot by making it

658
00:20:40,799 --> 00:20:42,240
worthless after the fact like

659
00:20:42,240 --> 00:20:43,520
getting like reporting stolen

660
00:20:43,520 --> 00:20:45,520
credentials to get them reset or making

661
00:20:45,520 --> 00:20:45,919
it

662
00:20:45,919 --> 00:20:48,480
not worth the effort by like limiting

663
00:20:48,480 --> 00:20:50,080
cpu usage so that an actor can't

664
00:20:50,080 --> 00:20:52,080
cryptomine anything of value

665
00:20:52,080 --> 00:20:55,280
then it's more likely they won't return

666
00:20:55,280 --> 00:20:56,720
now we have done this but so far with

667
00:20:56,720 --> 00:20:59,360
mixed mixed success

668
00:20:59,360 --> 00:21:00,480
now this is where hardening platform

669
00:21:00,480 --> 00:21:01,919
comes into play since we're already

670
00:21:01,919 --> 00:21:03,440
studying how the actors act

671
00:21:03,440 --> 00:21:05,840
and how the platform reacts we recommend

672
00:21:05,840 --> 00:21:07,039
fixes to make the platform less

673
00:21:07,039 --> 00:21:08,720
hospitable to abuse we

674
00:21:08,720 --> 00:21:11,440
push left to use the classic find me

675
00:21:11,440 --> 00:21:12,000
later

676
00:21:12,000 --> 00:21:13,200
and i'll tell you a fun story from a

677
00:21:13,200 --> 00:21:14,960
previous job about devaluing a fischer's

678
00:21:14,960 --> 00:21:17,440
loot

679
00:21:17,440 --> 00:21:19,919
on top of devaluation of loot of killing

680
00:21:19,919 --> 00:21:20,799
off roi

681
00:21:20,799 --> 00:21:22,480
there's an even wider goal of

682
00:21:22,480 --> 00:21:23,840
demotivation

683
00:21:23,840 --> 00:21:25,760
if we really want to keep the actor away

684
00:21:25,760 --> 00:21:27,200
we should work towards making it so that

685
00:21:27,200 --> 00:21:29,440
they don't want to come back

686
00:21:29,440 --> 00:21:30,720
all of the things we've talked about

687
00:21:30,720 --> 00:21:33,200
adds friction to abusive actions the

688
00:21:33,200 --> 00:21:35,200
monetization of free

689
00:21:35,200 --> 00:21:37,200
and since our ultimate goals are to make

690
00:21:37,200 --> 00:21:38,720
abuse less valuable

691
00:21:38,720 --> 00:21:40,400
and less desirable without affecting

692
00:21:40,400 --> 00:21:42,320
legit customers we need to break the

693
00:21:42,320 --> 00:21:43,120
spirits of the

694
00:21:43,120 --> 00:21:47,918
bad actors break spirits not code

695
00:21:48,559 --> 00:21:50,240
now these last two sections they contain

696
00:21:50,240 --> 00:21:52,159
a lot of information um

697
00:21:52,159 --> 00:21:53,600
there's a lot of notes in the slides and

698
00:21:53,600 --> 00:21:54,960
when the slides become available feel

699
00:21:54,960 --> 00:21:56,400
free to download them and read them

700
00:21:56,400 --> 00:21:57,919
i hope that there's things in these two

701
00:21:57,919 --> 00:21:59,280
sections that resonate with you and

702
00:21:59,280 --> 00:22:00,880
maybe help you define what you

703
00:22:00,880 --> 00:22:03,600
want or need to do but enough of all

704
00:22:03,600 --> 00:22:04,880
this philosophy

705
00:22:04,880 --> 00:22:06,480
let's go back to spencer for a little

706
00:22:06,480 --> 00:22:08,960
bit of show and tell

707
00:22:08,960 --> 00:22:11,360
thanks alan let's look at a couple

708
00:22:11,360 --> 00:22:13,120
campaigns that have touched our hearts

709
00:22:13,120 --> 00:22:14,400
and well we'd like to think we've

710
00:22:14,400 --> 00:22:17,280
touched theirs too the first actor is a

711
00:22:17,280 --> 00:22:19,440
huge fan of decentralized currency

712
00:22:19,440 --> 00:22:21,679
loves blockchains and hates electric

713
00:22:21,679 --> 00:22:22,640
bills

714
00:22:22,640 --> 00:22:24,159
they first appeared on our radar by

715
00:22:24,159 --> 00:22:26,960
spinning up 100 apps per user account

716
00:22:26,960 --> 00:22:28,720
all from across multiple accounts all

717
00:22:28,720 --> 00:22:30,720
from free email providers

718
00:22:30,720 --> 00:22:32,640
so a user account is limited to running

719
00:22:32,640 --> 00:22:34,799
five apps until they verify their

720
00:22:34,799 --> 00:22:36,559
account by adding a payment method

721
00:22:36,559 --> 00:22:39,120
like a credit card after that 100 apps

722
00:22:39,120 --> 00:22:40,720
is the new max

723
00:22:40,720 --> 00:22:43,200
so new accounts immediately adding a

724
00:22:43,200 --> 00:22:44,080
payment method

725
00:22:44,080 --> 00:22:47,039
and spinning up 100 apps that's not

726
00:22:47,039 --> 00:22:48,559
normal

727
00:22:48,559 --> 00:22:50,320
i'm not exposing any detection logic

728
00:22:50,320 --> 00:22:51,760
here giving anything away

729
00:22:51,760 --> 00:22:54,240
normal users don't do that that activity

730
00:22:54,240 --> 00:22:56,720
gets on our radar really quickly

731
00:22:56,720 --> 00:22:58,320
and to top things off fraudulent credit

732
00:22:58,320 --> 00:23:01,120
cards were used to verify each account

733
00:23:01,120 --> 00:23:04,799
and all 100 apps were identical

734
00:23:04,799 --> 00:23:06,559
so we inspected one of the apps and saw

735
00:23:06,559 --> 00:23:07,919
that they were running a tor hidden

736
00:23:07,919 --> 00:23:08,400
service

737
00:23:08,400 --> 00:23:10,640
accessible through ssh here's a

738
00:23:10,640 --> 00:23:12,240
screenshot of the script that would run

739
00:23:12,240 --> 00:23:15,520
once their app was deployed

740
00:23:15,840 --> 00:23:18,080
we suspended the accounts and very soon

741
00:23:18,080 --> 00:23:20,000
the actor was back and the cat and mouse

742
00:23:20,000 --> 00:23:20,799
began

743
00:23:20,799 --> 00:23:22,880
now one clear sign that it's on with a

744
00:23:22,880 --> 00:23:23,840
bad actor

745
00:23:23,840 --> 00:23:25,039
is when they start getting cute with

746
00:23:25,039 --> 00:23:27,120
their app names

747
00:23:27,120 --> 00:23:29,360
obviously this is the g rated end of the

748
00:23:29,360 --> 00:23:31,280
spectrum

749
00:23:31,280 --> 00:23:33,039
after a short while the code changed and

750
00:23:33,039 --> 00:23:34,880
we saw what they were really after

751
00:23:34,880 --> 00:23:37,840
mining monero the apps were mining with

752
00:23:37,840 --> 00:23:39,919
lib xmr and sending all traffic through

753
00:23:39,919 --> 00:23:41,039
tor

754
00:23:41,039 --> 00:23:43,360
to maximize profit each app was pegging

755
00:23:43,360 --> 00:23:45,120
cpu resources

756
00:23:45,120 --> 00:23:47,760
fantastic now after seeing this we

757
00:23:47,760 --> 00:23:49,600
believe that the initial wave of apps

758
00:23:49,600 --> 00:23:52,000
was part of some capabilities testing

759
00:23:52,000 --> 00:23:52,640
some

760
00:23:52,640 --> 00:23:56,240
real live bad actor devops

761
00:23:56,240 --> 00:23:58,240
we suspended the accounts and the actor

762
00:23:58,240 --> 00:23:59,679
would pivot each tr

763
00:23:59,679 --> 00:24:01,200
each time trying to minimize their

764
00:24:01,200 --> 00:24:04,159
footprint to avoid detection right so

765
00:24:04,159 --> 00:24:04,960
the top image

766
00:24:04,960 --> 00:24:07,360
in this slide is from an app that packed

767
00:24:07,360 --> 00:24:09,200
the tor and the mining binaries

768
00:24:09,200 --> 00:24:10,960
in a zip file which would then be

769
00:24:10,960 --> 00:24:12,720
unzipped with a unique passphrase

770
00:24:12,720 --> 00:24:15,360
at the time of deployment the bottom

771
00:24:15,360 --> 00:24:15,840
image

772
00:24:15,840 --> 00:24:17,919
is from a later pivot this time using

773
00:24:17,919 --> 00:24:19,760
gpg encrypted payloads

774
00:24:19,760 --> 00:24:22,240
with unique names and unique passphrases

775
00:24:22,240 --> 00:24:23,120
so decrypt

776
00:24:23,120 --> 00:24:25,120
unpack and mine sending everything

777
00:24:25,120 --> 00:24:27,200
through tor

778
00:24:27,200 --> 00:24:29,600
this type of activity at this scale

779
00:24:29,600 --> 00:24:31,120
threaten the performance of some of the

780
00:24:31,120 --> 00:24:32,799
shared resources

781
00:24:32,799 --> 00:24:34,559
other customers were impacted due to

782
00:24:34,559 --> 00:24:36,640
these noisy neighbor situations

783
00:24:36,640 --> 00:24:38,640
we had to stay on top of this actor but

784
00:24:38,640 --> 00:24:40,159
they were automating

785
00:24:40,159 --> 00:24:42,159
their operations and getting faster

786
00:24:42,159 --> 00:24:44,400
mostly during our off hours

787
00:24:44,400 --> 00:24:46,159
so playing never-ending whack-a-mole

788
00:24:46,159 --> 00:24:47,919
like this was unsustainable and it was a

789
00:24:47,919 --> 00:24:50,640
path toward team burnout

790
00:24:50,640 --> 00:24:53,440
so we took a step back and we looked at

791
00:24:53,440 --> 00:24:55,039
all of the data provided

792
00:24:55,039 --> 00:24:57,919
by this by this actor as they use the

793
00:24:57,919 --> 00:24:59,360
platform

794
00:24:59,360 --> 00:25:01,360
we were able to identify five unique

795
00:25:01,360 --> 00:25:04,000
indicators to form a ttp footprint

796
00:25:04,000 --> 00:25:06,000
this included indicators observed before

797
00:25:06,000 --> 00:25:07,279
code was even deployed

798
00:25:07,279 --> 00:25:09,360
like at the point of signup they came

799
00:25:09,360 --> 00:25:11,520
from a tor exit node

800
00:25:11,520 --> 00:25:13,679
from a particular free email provider

801
00:25:13,679 --> 00:25:15,760
and used an email address that matched a

802
00:25:15,760 --> 00:25:16,960
naming pattern

803
00:25:16,960 --> 00:25:18,799
it's three right there and no code has

804
00:25:18,799 --> 00:25:20,320
even been deployed

805
00:25:20,320 --> 00:25:22,000
so a system was developed to gather

806
00:25:22,000 --> 00:25:24,159
these indicators as well as a few others

807
00:25:24,159 --> 00:25:26,799
and compare them against the overall ttp

808
00:25:26,799 --> 00:25:27,760
footprint

809
00:25:27,760 --> 00:25:29,520
if five out of five were present

810
00:25:29,520 --> 00:25:31,039
automatically suspend

811
00:25:31,039 --> 00:25:32,880
if three or four out of five it was

812
00:25:32,880 --> 00:25:34,640
likely a pivot and will be manually

813
00:25:34,640 --> 00:25:35,279
reviewed

814
00:25:35,279 --> 00:25:36,720
to see if the footprint needed to be

815
00:25:36,720 --> 00:25:39,919
updated this worked extremely well

816
00:25:39,919 --> 00:25:42,000
we were now able to detect the actor

817
00:25:42,000 --> 00:25:44,240
early in their campaign

818
00:25:44,240 --> 00:25:46,080
and soon after this we stopped seeing

819
00:25:46,080 --> 00:25:48,320
them for a while

820
00:25:48,320 --> 00:25:50,159
um they did return a few times with

821
00:25:50,159 --> 00:25:51,760
totally different kits but we were on

822
00:25:51,760 --> 00:25:53,279
top of them right away

823
00:25:53,279 --> 00:25:56,720
and impacted their success mining

824
00:25:56,720 --> 00:25:58,720
now an important note here from the more

825
00:25:58,720 --> 00:25:59,760
recent attempts

826
00:25:59,760 --> 00:26:01,360
the apps check to see what kind of an

827
00:26:01,360 --> 00:26:02,799
environment they were on

828
00:26:02,799 --> 00:26:04,720
specifically it looked to see if gpus

829
00:26:04,720 --> 00:26:06,320
were available for mining

830
00:26:06,320 --> 00:26:08,960
that's not our platform this kit

831
00:26:08,960 --> 00:26:10,080
appeared to be tooled for

832
00:26:10,080 --> 00:26:11,840
multiple platforms so they may be

833
00:26:11,840 --> 00:26:13,600
someone else's problem now

834
00:26:13,600 --> 00:26:16,880
something to consider let's look at

835
00:26:16,880 --> 00:26:18,400
another persistent actor

836
00:26:18,400 --> 00:26:19,600
hopefully it's clear that fighting

837
00:26:19,600 --> 00:26:21,440
fishing campaigns is a challenge on a

838
00:26:21,440 --> 00:26:23,760
platform like heroku

839
00:26:23,760 --> 00:26:25,279
infrastructure gets reported to us

840
00:26:25,279 --> 00:26:27,279
either directly by wonderful people on

841
00:26:27,279 --> 00:26:28,080
the internet

842
00:26:28,080 --> 00:26:29,600
or through third-party services we

843
00:26:29,600 --> 00:26:31,200
subscribe to

844
00:26:31,200 --> 00:26:33,679
the infrastructure may be landing pages

845
00:26:33,679 --> 00:26:35,440
or just back-end functionality

846
00:26:35,440 --> 00:26:37,520
or artifacts that point toward a full

847
00:26:37,520 --> 00:26:40,400
kit that includes message distribution

848
00:26:40,400 --> 00:26:41,919
most of the time we'll perform a quick

849
00:26:41,919 --> 00:26:43,760
investigation to confirm fishing

850
00:26:43,760 --> 00:26:45,760
suspend the user from the platform and

851
00:26:45,760 --> 00:26:47,440
get back to our queue

852
00:26:47,440 --> 00:26:50,000
however if the same fish gets identified

853
00:26:50,000 --> 00:26:50,880
again

854
00:26:50,880 --> 00:26:53,440
the actor will be tracked as a campaign

855
00:26:53,440 --> 00:26:56,159
like allen mentioned earlier

856
00:26:56,159 --> 00:26:58,000
so this particular actor was targeting

857
00:26:58,000 --> 00:27:00,320
customers of an insurance provider

858
00:27:00,320 --> 00:27:02,240
when inspecting the app we see the

859
00:27:02,240 --> 00:27:04,320
following directory structure within

860
00:27:04,320 --> 00:27:04,720
their

861
00:27:04,720 --> 00:27:06,960
code which contains message sending

862
00:27:06,960 --> 00:27:08,400
capabilities through third-party

863
00:27:08,400 --> 00:27:10,000
messaging add-ons

864
00:27:10,000 --> 00:27:11,760
now this may be for distribution or just

865
00:27:11,760 --> 00:27:14,080
for how they handled the loop

866
00:27:14,080 --> 00:27:15,840
we suspended the accounts and hunted for

867
00:27:15,840 --> 00:27:18,480
more and found an entirely different app

868
00:27:18,480 --> 00:27:21,200
used in the same campaign this time it

869
00:27:21,200 --> 00:27:22,799
was a javascript react app

870
00:27:22,799 --> 00:27:25,440
which had some added functionality like

871
00:27:25,440 --> 00:27:26,720
now they were after credit card

872
00:27:26,720 --> 00:27:27,360
information

873
00:27:27,360 --> 00:27:30,480
as well as credentials so this image

874
00:27:30,480 --> 00:27:32,000
shows the collection of credit card

875
00:27:32,000 --> 00:27:32,720
number

876
00:27:32,720 --> 00:27:37,440
expiration date and cvv in french

877
00:27:37,919 --> 00:27:39,919
we developed a ttp footprint for this

878
00:27:39,919 --> 00:27:41,679
actor and continued to update the rules

879
00:27:41,679 --> 00:27:43,360
to apply friction

880
00:27:43,360 --> 00:27:45,520
they were very persistent and continued

881
00:27:45,520 --> 00:27:47,760
to pivot this one pivot started using a

882
00:27:47,760 --> 00:27:49,039
search engine add-on

883
00:27:49,039 --> 00:27:50,799
to handle loot from their campaign as

884
00:27:50,799 --> 00:27:52,559
well as still having the option to mail

885
00:27:52,559 --> 00:27:53,840
it out

886
00:27:53,840 --> 00:27:55,520
here's a look at information that they

887
00:27:55,520 --> 00:27:58,158
were after

888
00:27:58,399 --> 00:28:00,000
we also noticed that they were

889
00:28:00,000 --> 00:28:01,679
distributing their efforts across a few

890
00:28:01,679 --> 00:28:04,320
other service providers

891
00:28:04,320 --> 00:28:06,480
the next big shift was another kit

892
00:28:06,480 --> 00:28:08,240
although it does not appear to have been

893
00:28:08,240 --> 00:28:09,919
created by this actor

894
00:28:09,919 --> 00:28:12,640
but used in the same campaign the root

895
00:28:12,640 --> 00:28:14,159
of that app looks like this

896
00:28:14,159 --> 00:28:16,080
with some very obvious indicators that

897
00:28:16,080 --> 00:28:18,480
stand out right drove in zero zero three

898
00:28:18,480 --> 00:28:22,000
antibots and in the index.js file

899
00:28:22,000 --> 00:28:23,440
they really didn't try to hide what they

900
00:28:23,440 --> 00:28:26,000
were what they were doing

901
00:28:26,000 --> 00:28:27,679
as the cat mouse continued we noticed

902
00:28:27,679 --> 00:28:29,440
that this actor was further spreading

903
00:28:29,440 --> 00:28:30,240
out across

904
00:28:30,240 --> 00:28:32,880
other service providers the front end

905
00:28:32,880 --> 00:28:33,840
would be on one

906
00:28:33,840 --> 00:28:35,600
the back end on ours and distribution

907
00:28:35,600 --> 00:28:38,080
would be on another

908
00:28:38,080 --> 00:28:40,399
we want to break this bad actors spirit

909
00:28:40,399 --> 00:28:41,760
not help them improve their coding

910
00:28:41,760 --> 00:28:44,000
skills as we go back and forth

911
00:28:44,000 --> 00:28:45,520
typically being in proximity to

912
00:28:45,520 --> 00:28:47,120
sensitive information like what this

913
00:28:47,120 --> 00:28:48,559
campaign was gathering

914
00:28:48,559 --> 00:28:50,320
is like playing hot potato with toxic

915
00:28:50,320 --> 00:28:53,279
waste unless you're the bad actor

916
00:28:53,279 --> 00:28:56,559
then it has value but it's only valuable

917
00:28:56,559 --> 00:28:59,200
if the information is valid so

918
00:28:59,200 --> 00:29:00,960
considering this we did our best to get

919
00:29:00,960 --> 00:29:02,080
that information

920
00:29:02,080 --> 00:29:03,840
into the appropriate hands so that

921
00:29:03,840 --> 00:29:05,600
passwords payment information

922
00:29:05,600 --> 00:29:08,159
can all be reset and nullified strip the

923
00:29:08,159 --> 00:29:10,159
value out of it

924
00:29:10,159 --> 00:29:11,919
also we found ways to notify the other

925
00:29:11,919 --> 00:29:13,440
service providers that were used in this

926
00:29:13,440 --> 00:29:14,240
campaign

927
00:29:14,240 --> 00:29:17,520
this put even more pressure on the actor

928
00:29:17,520 --> 00:29:19,200
these two things disrupted their

929
00:29:19,200 --> 00:29:21,120
operations enough that it appears to

930
00:29:21,120 --> 00:29:22,960
push them from our platform

931
00:29:22,960 --> 00:29:25,679
but now they're someone else's problem i

932
00:29:25,679 --> 00:29:27,039
wish we had time to share more but for

933
00:29:27,039 --> 00:29:27,600
now

934
00:29:27,600 --> 00:29:29,679
consider these cases as we go into the

935
00:29:29,679 --> 00:29:32,720
lessons learned section

936
00:29:32,880 --> 00:29:34,640
so during my time working on the abuse

937
00:29:34,640 --> 00:29:36,640
operations team we've gone from being

938
00:29:36,640 --> 00:29:39,120
underwater to treading to surfacing high

939
00:29:39,120 --> 00:29:41,120
enough to see land and set direction

940
00:29:41,120 --> 00:29:42,559
we'll still get hit by some big waves

941
00:29:42,559 --> 00:29:43,919
now and then but we've learned some

942
00:29:43,919 --> 00:29:46,960
lessons that have helped us stay afloat

943
00:29:46,960 --> 00:29:48,399
we've identified three guiding

944
00:29:48,399 --> 00:29:50,080
philosophies for our team

945
00:29:50,080 --> 00:29:52,720
the first relentless incrementalism

946
00:29:52,720 --> 00:29:54,960
break complex problems into manageable

947
00:29:54,960 --> 00:29:55,600
tasks

948
00:29:55,600 --> 00:29:58,000
so that each is a step toward the final

949
00:29:58,000 --> 00:29:59,039
solution

950
00:29:59,039 --> 00:30:01,440
move fast and fix things it's a think

951
00:30:01,440 --> 00:30:03,360
agile framework right

952
00:30:03,360 --> 00:30:05,360
the non-repetition we never want to see

953
00:30:05,360 --> 00:30:07,520
the same abuse pattern twice

954
00:30:07,520 --> 00:30:09,120
nobody wants to be a button pushing

955
00:30:09,120 --> 00:30:11,279
drone this keeps the job

956
00:30:11,279 --> 00:30:14,080
interesting although as you may imagine

957
00:30:14,080 --> 00:30:16,399
this is much easier said than done

958
00:30:16,399 --> 00:30:18,080
and this is the closest we get to

959
00:30:18,080 --> 00:30:19,600
prevention

960
00:30:19,600 --> 00:30:22,640
and third hyper automation every click

961
00:30:22,640 --> 00:30:25,600
counts toward toil having tools that

962
00:30:25,600 --> 00:30:27,360
talk to tools including the ticketing

963
00:30:27,360 --> 00:30:28,000
system

964
00:30:28,000 --> 00:30:30,399
enables hyper automation and reduces

965
00:30:30,399 --> 00:30:33,200
toil without losing accuracy

966
00:30:33,200 --> 00:30:35,039
automation can be quickly putting the

967
00:30:35,039 --> 00:30:37,840
right information in front of an analyst

968
00:30:37,840 --> 00:30:39,200
the idea is to create more than just

969
00:30:39,200 --> 00:30:41,440
detection rules but imagine entire

970
00:30:41,440 --> 00:30:44,559
detection chains

971
00:30:44,880 --> 00:30:46,720
know the business you are serving it's

972
00:30:46,720 --> 00:30:48,000
said a lot but we're not here for the

973
00:30:48,000 --> 00:30:49,360
sake of technology

974
00:30:49,360 --> 00:30:52,960
or security or playing whack-a-mole even

975
00:30:52,960 --> 00:30:54,159
though it's a lot of fun

976
00:30:54,159 --> 00:30:56,640
we are here to serve the business so

977
00:30:56,640 --> 00:30:57,840
learning about the different teams

978
00:30:57,840 --> 00:30:59,760
across the organization their data

979
00:30:59,760 --> 00:31:01,679
their language what kind of alerts they

980
00:31:01,679 --> 00:31:04,159
have enabled what keeps them up at night

981
00:31:04,159 --> 00:31:05,840
as we understand the priorities of other

982
00:31:05,840 --> 00:31:08,080
teams we can help remove some of their

983
00:31:08,080 --> 00:31:09,039
pain points

984
00:31:09,039 --> 00:31:11,679
caused by abuse it gives us increased

985
00:31:11,679 --> 00:31:12,960
situational awareness

986
00:31:12,960 --> 00:31:15,039
and that in turn allows us to spot abuse

987
00:31:15,039 --> 00:31:16,480
much earlier

988
00:31:16,480 --> 00:31:19,519
this helps all of us succeed

989
00:31:19,519 --> 00:31:21,440
most importantly though our

990
00:31:21,440 --> 00:31:23,279
collaboration provides a channel

991
00:31:23,279 --> 00:31:25,200
to let the right people know about the

992
00:31:25,200 --> 00:31:27,360
gaps in business logic

993
00:31:27,360 --> 00:31:29,679
this results in a platform that's too

994
00:31:29,679 --> 00:31:32,240
much trouble to abuse by the bad actors

995
00:31:32,240 --> 00:31:34,000
because now we can take that information

996
00:31:34,000 --> 00:31:36,159
and push left and harden the platform

997
00:31:36,159 --> 00:31:38,320
now this works for us but does that

998
00:31:38,320 --> 00:31:40,720
really solve abuse

999
00:31:40,720 --> 00:31:42,559
bad actors try to use heroku for a

1000
00:31:42,559 --> 00:31:44,559
variety of abuse scenarios

1001
00:31:44,559 --> 00:31:46,720
this is only one view of a much wider

1002
00:31:46,720 --> 00:31:48,720
problem

1003
00:31:48,720 --> 00:31:50,159
have you ever had a scam phone call

1004
00:31:50,159 --> 00:31:52,480
during dinner or have you purchased a

1005
00:31:52,480 --> 00:31:53,919
product based on what turned out to be

1006
00:31:53,919 --> 00:31:55,600
phony reviews

1007
00:31:55,600 --> 00:31:57,279
or were you unable to get a grocery

1008
00:31:57,279 --> 00:31:59,120
store pick-up time because somebody

1009
00:31:59,120 --> 00:32:02,320
reserved all of the slots to resell

1010
00:32:02,320 --> 00:32:03,919
we've listed what we don't allow in our

1011
00:32:03,919 --> 00:32:06,559
aup but that's a limited list especially

1012
00:32:06,559 --> 00:32:08,399
when you consider that abuse is

1013
00:32:08,399 --> 00:32:11,679
the unintended monetization of anything

1014
00:32:11,679 --> 00:32:13,840
now we are barely scratching the surface

1015
00:32:13,840 --> 00:32:15,760
and this definition is just an initial

1016
00:32:15,760 --> 00:32:16,559
attempt

1017
00:32:16,559 --> 00:32:18,159
maybe there's a more accurate definition

1018
00:32:18,159 --> 00:32:19,760
a more encompassing one a more

1019
00:32:19,760 --> 00:32:21,919
appropriate one

1020
00:32:21,919 --> 00:32:23,840
think about your free services or any

1021
00:32:23,840 --> 00:32:25,760
service that your company offers

1022
00:32:25,760 --> 00:32:28,159
how are those being abused how do they

1023
00:32:28,159 --> 00:32:30,799
fit in to the larger picture of abuse

1024
00:32:30,799 --> 00:32:34,080
and what are you doing about that

1025
00:32:34,320 --> 00:32:36,399
we want to take what we've discussed to

1026
00:32:36,399 --> 00:32:37,679
the greater internet

1027
00:32:37,679 --> 00:32:40,080
right now abuse feels like a zero-sum

1028
00:32:40,080 --> 00:32:40,720
game

1029
00:32:40,720 --> 00:32:43,039
we push bad actors from our platform

1030
00:32:43,039 --> 00:32:44,720
they take the path of least resistance

1031
00:32:44,720 --> 00:32:45,600
to the next

1032
00:32:45,600 --> 00:32:47,679
or distribute their workflow across

1033
00:32:47,679 --> 00:32:49,360
other service providers

1034
00:32:49,360 --> 00:32:51,760
abuse is a people problem removing the

1035
00:32:51,760 --> 00:32:53,360
actors motivation

1036
00:32:53,360 --> 00:32:54,880
will be much more effective than

1037
00:32:54,880 --> 00:32:56,399
continuously actioning what gets

1038
00:32:56,399 --> 00:32:57,360
reported

1039
00:32:57,360 --> 00:32:59,919
but it requires more there are some

1040
00:32:59,919 --> 00:33:01,519
challenging questions to work through

1041
00:33:01,519 --> 00:33:03,360
like these loaded questions

1042
00:33:03,360 --> 00:33:06,399
how do you define abuse what do you do

1043
00:33:06,399 --> 00:33:09,120
with malicious customers

1044
00:33:09,120 --> 00:33:11,039
how do you protect the good customers

1045
00:33:11,039 --> 00:33:13,360
while sanctioning the bad

1046
00:33:13,360 --> 00:33:15,679
how do you devalue loot when it's

1047
00:33:15,679 --> 00:33:19,360
treated as a customer's private data

1048
00:33:19,360 --> 00:33:22,559
is the internet worth saving

1049
00:33:22,559 --> 00:33:25,200
we are co-founding a cloud abuse ice act

1050
00:33:25,200 --> 00:33:26,799
with the cloud security alliance to have

1051
00:33:26,799 --> 00:33:28,480
these difficult conversations

1052
00:33:28,480 --> 00:33:30,720
more than just sharing ttps and stolen

1053
00:33:30,720 --> 00:33:31,760
credentials

1054
00:33:31,760 --> 00:33:33,360
if you're already a member you're

1055
00:33:33,360 --> 00:33:34,799
already invited

1056
00:33:34,799 --> 00:33:36,159
the sharing groups and backed channels

1057
00:33:36,159 --> 00:33:38,080
that exist today although excelling in

1058
00:33:38,080 --> 00:33:39,200
their own regard

1059
00:33:39,200 --> 00:33:41,919
are hobbled by politics procedures and

1060
00:33:41,919 --> 00:33:43,440
business policy

1061
00:33:43,440 --> 00:33:45,519
let's take a deeper look and see if we

1062
00:33:45,519 --> 00:33:47,600
can make this better

1063
00:33:47,600 --> 00:33:51,760
how can we help we should talk

1064
00:33:51,760 --> 00:33:53,679
thank you again for attending our talk

1065
00:33:53,679 --> 00:33:57,440
and thank you to black hat for having us

1066
00:33:59,840 --> 00:34:01,919
hi everyone thanks for uh tuning in to

1067
00:34:01,919 --> 00:34:03,600
our talk

1068
00:34:03,600 --> 00:34:04,799
thank you thank you for being here that

1069
00:34:04,799 --> 00:34:08,800
was this is an experience for sure

1070
00:34:08,800 --> 00:34:10,639
does anybody say one of the sorry the

1071
00:34:10,639 --> 00:34:12,480
quick things just to mention before q

1072
00:34:12,480 --> 00:34:14,480
a uh i think it might be worthwhile to

1073
00:34:14,480 --> 00:34:16,000
know that we do do a little bit more

1074
00:34:16,000 --> 00:34:17,599
coverage of some of the technical

1075
00:34:17,599 --> 00:34:18,560
aspects in

1076
00:34:18,560 --> 00:34:21,280
a blue team village talk on saturday if

1077
00:34:21,280 --> 00:34:22,079
you're uh

1078
00:34:22,079 --> 00:34:23,918
if you're there and interested and it'll

1079
00:34:23,918 --> 00:34:26,879
be on their twitch stream

1080
00:34:26,879 --> 00:34:28,399
and in that one we actually look at a

1081
00:34:28,399 --> 00:34:30,079
third uh

1082
00:34:30,079 --> 00:34:32,320
case for show and tell third campaign

1083
00:34:32,320 --> 00:34:35,839
that's a little bit different

1084
00:34:36,560 --> 00:34:38,320
oh actually hasn't quite stopped playing

1085
00:34:38,320 --> 00:34:40,050
it okay yes

1086
00:34:40,050 --> 00:34:47,440
[Music]

1087
00:34:47,440 --> 00:34:50,560
yes now

1088
00:34:50,560 --> 00:34:54,480
let's uh see if there's any uh questions

1089
00:35:00,160 --> 00:35:01,520
well we did have a question earlier

1090
00:35:01,520 --> 00:35:04,240
about um detection or response

1091
00:35:04,240 --> 00:35:05,920
tooling and just how we how we divide

1092
00:35:05,920 --> 00:35:07,440
that um

1093
00:35:07,440 --> 00:35:09,599
alan do you want to go into any any of

1094
00:35:09,599 --> 00:35:10,960
that as far as

1095
00:35:10,960 --> 00:35:13,760
um how we have our our tooling and our

1096
00:35:13,760 --> 00:35:14,720
development

1097
00:35:14,720 --> 00:35:16,400
or i guess engineering kind of separated

1098
00:35:16,400 --> 00:35:18,640
where we have ops tooling that we may be

1099
00:35:18,640 --> 00:35:19,920
responsible for that helps us in our

1100
00:35:19,920 --> 00:35:20,480
day-to-day

1101
00:35:20,480 --> 00:35:22,960
workflow and then we have uh stuff that

1102
00:35:22,960 --> 00:35:24,560
gets productionized which we have an

1103
00:35:24,560 --> 00:35:25,520
engineering team

1104
00:35:25,520 --> 00:35:26,880
but we can work together and set those

1105
00:35:26,880 --> 00:35:29,119
requirements we we do a lot of

1106
00:35:29,119 --> 00:35:30,800
abuse right alongs where we show them

1107
00:35:30,800 --> 00:35:32,400
what we're doing where those pain points

1108
00:35:32,400 --> 00:35:33,119
are

1109
00:35:33,119 --> 00:35:35,599
and they will be it's you know they

1110
00:35:35,599 --> 00:35:36,960
focus on getting something

1111
00:35:36,960 --> 00:35:38,800
uh productionized and ready for the

1112
00:35:38,800 --> 00:35:40,880
world

1113
00:35:40,880 --> 00:35:42,839
i think you just said it all quite

1114
00:35:42,839 --> 00:35:44,800
honestly

1115
00:35:44,800 --> 00:35:46,720
the the the turn around of that is kind

1116
00:35:46,720 --> 00:35:48,800
of the uh the the big piece there being

1117
00:35:48,800 --> 00:35:50,400
able to turn that loop around as fast as

1118
00:35:50,400 --> 00:35:52,400
possible in kind of that standard

1119
00:35:52,400 --> 00:35:53,920
agile environment especially if that's

1120
00:35:53,920 --> 00:35:55,119
what you're into or whatever other

1121
00:35:55,119 --> 00:35:56,000
development

1122
00:35:56,000 --> 00:35:59,839
uh system this you're using

1123
00:36:04,640 --> 00:36:06,560
you see jamie's question did you see

1124
00:36:06,560 --> 00:36:13,839
trace no um yeah

1125
00:36:17,040 --> 00:36:20,240
yeah i i guess uh

1126
00:36:22,079 --> 00:36:24,160
i would actually i think that that is a

1127
00:36:24,160 --> 00:36:25,280
the jamie's question

1128
00:36:25,280 --> 00:36:28,880
uh is fantastic for the seo stuff yeah

1129
00:36:28,880 --> 00:36:30,480
that took a little while to unravel i

1130
00:36:30,480 --> 00:36:32,400
was thinking about that we had um

1131
00:36:32,400 --> 00:36:35,520
uh dmca take down requests where it was

1132
00:36:35,520 --> 00:36:38,000
um the report was that there was a book

1133
00:36:38,000 --> 00:36:39,440
somebody's copyrighted material was

1134
00:36:39,440 --> 00:36:40,800
available for download

1135
00:36:40,800 --> 00:36:42,160
and when we looked at it it was just

1136
00:36:42,160 --> 00:36:43,760
kind of like the cover art and the book

1137
00:36:43,760 --> 00:36:44,560
title

1138
00:36:44,560 --> 00:36:46,560
um and inside were just links to go

1139
00:36:46,560 --> 00:36:47,920
download it elsewhere go sign up for

1140
00:36:47,920 --> 00:36:49,119
another account to go download it

1141
00:36:49,119 --> 00:36:50,320
somewhere else

1142
00:36:50,320 --> 00:36:52,480
and it really seemed like one of those

1143
00:36:52,480 --> 00:36:53,680
low value things you could just write

1144
00:36:53,680 --> 00:36:54,960
off you could action you could

1145
00:36:54,960 --> 00:36:57,200
and then go on but it would seem very

1146
00:36:57,200 --> 00:36:59,200
persistent it started to get

1147
00:36:59,200 --> 00:37:01,440
reported every so often and so when we

1148
00:37:01,440 --> 00:37:02,960
really looked and picked this this app

1149
00:37:02,960 --> 00:37:04,720
apart we found out that this was

1150
00:37:04,720 --> 00:37:08,160
spread out across thousands of accounts

1151
00:37:08,160 --> 00:37:12,480
and each app was uh was running um

1152
00:37:12,480 --> 00:37:15,760
oh hey

1153
00:37:16,320 --> 00:37:20,800
each app was running um uh black hat seo

1154
00:37:20,800 --> 00:37:22,880
black hat seo app where it would take

1155
00:37:22,880 --> 00:37:24,560
thousands of book titles like hundreds

1156
00:37:24,560 --> 00:37:25,839
of thousands of titles

1157
00:37:25,839 --> 00:37:28,480
break those into links flood the seos

1158
00:37:28,480 --> 00:37:29,680
the different search engines

1159
00:37:29,680 --> 00:37:32,400
all of them um and make it appear that

1160
00:37:32,400 --> 00:37:33,760
those books were available for download

1161
00:37:33,760 --> 00:37:35,359
and this was just one of those

1162
00:37:35,359 --> 00:37:38,400
uh low and slow operations where you

1163
00:37:38,400 --> 00:37:39,839
can't even imagine that they were making

1164
00:37:39,839 --> 00:37:41,359
money off of it but it had to have been

1165
00:37:41,359 --> 00:37:44,000
uh only profitable because they had

1166
00:37:44,000 --> 00:37:46,240
thousands of accounts all under control

1167
00:37:46,240 --> 00:37:47,920
and uh that was a lot of fun to turn

1168
00:37:47,920 --> 00:37:49,359
over a stone and actually figure out

1169
00:37:49,359 --> 00:37:51,440
that there are a lot of bugs under there

1170
00:37:51,440 --> 00:37:54,079
and i started putting rules in place

1171
00:37:54,079 --> 00:37:55,440
spinning those accounts and pushing them

1172
00:37:55,440 --> 00:37:56,960
from the platform

1173
00:37:56,960 --> 00:37:58,640
and making it much more difficult for

1174
00:37:58,640 --> 00:38:01,279
them to come back

1175
00:38:02,400 --> 00:38:04,800
dave asks do you use any data science

1176
00:38:04,800 --> 00:38:06,079
techniques or machine learning to

1177
00:38:06,079 --> 00:38:07,760
analyze your data and track

1178
00:38:07,760 --> 00:38:09,599
and tracking of bad actors over time uh

1179
00:38:09,599 --> 00:38:11,119
we've had a couple of brief forays into

1180
00:38:11,119 --> 00:38:12,640
that uh haven't done

1181
00:38:12,640 --> 00:38:15,440
the level uh that one would expect at

1182
00:38:15,440 --> 00:38:17,200
this time and it's mostly simply because

1183
00:38:17,200 --> 00:38:18,480
we're still trying to track

1184
00:38:18,480 --> 00:38:21,599
tackle kind of the simpler stuff uh it's

1185
00:38:21,599 --> 00:38:23,680
uh if we can do most of the stuff that

1186
00:38:23,680 --> 00:38:24,800
we need to do there

1187
00:38:24,800 --> 00:38:27,520
first and then turn on some of the more

1188
00:38:27,520 --> 00:38:28,960
scientific stuff for

1189
00:38:28,960 --> 00:38:31,440
uh what's left uh i think that we're

1190
00:38:31,440 --> 00:38:32,880
gonna ultimately have a better offering

1191
00:38:32,880 --> 00:38:34,560
in the long run

1192
00:38:34,560 --> 00:38:36,000
yeah that was one thing we were thinking

1193
00:38:36,000 --> 00:38:37,920
about sharing as well is how how far you

1194
00:38:37,920 --> 00:38:39,520
can get with just uh descriptive

1195
00:38:39,520 --> 00:38:40,240
analytics

1196
00:38:40,240 --> 00:38:42,400
or uh descriptive statistics where you

1197
00:38:42,400 --> 00:38:44,160
you know just using sort

1198
00:38:44,160 --> 00:38:46,240
in a command line and and some really

1199
00:38:46,240 --> 00:38:47,839
basic sql can show you some of these

1200
00:38:47,839 --> 00:38:49,599
patterns and you see how

1201
00:38:49,599 --> 00:38:51,839
um it really helps expose those

1202
00:38:51,839 --> 00:38:53,040
indicators that you can use

1203
00:38:53,040 --> 00:38:56,880
to form your footprint uh fernando asks

1204
00:38:56,880 --> 00:38:59,200
about uh homegrown versus open source

1205
00:38:59,200 --> 00:39:02,240
versus commercial uh so a lot of our

1206
00:39:02,240 --> 00:39:04,720
uh code is homegrown but most of that is

1207
00:39:04,720 --> 00:39:06,320
the integration code to make stuff talk

1208
00:39:06,320 --> 00:39:07,440
to each other

1209
00:39:07,440 --> 00:39:10,560
um on top of uh commercial offerings

1210
00:39:10,560 --> 00:39:14,160
um yeah and uh and

1211
00:39:14,160 --> 00:39:16,800
you can imagine that that does uh bring

1212
00:39:16,800 --> 00:39:18,240
about that complexity that we're talking

1213
00:39:18,240 --> 00:39:20,879
about briefly

1214
00:39:23,190 --> 00:39:26,240
[Music]

1215
00:39:26,240 --> 00:39:28,960
let's see uh got a question from jason

1216
00:39:28,960 --> 00:39:29,920
about how the

1217
00:39:29,920 --> 00:39:31,520
the organization was born and that's

1218
00:39:31,520 --> 00:39:33,680
that's funny because um it's

1219
00:39:33,680 --> 00:39:35,040
it's not really clear exactly how it was

1220
00:39:35,040 --> 00:39:36,480
born i think it was definitely more of a

1221
00:39:36,480 --> 00:39:36,960
uh

1222
00:39:36,960 --> 00:39:40,160
it was security that was tied to um

1223
00:39:40,160 --> 00:39:44,079
heroku itself and um as the company grew

1224
00:39:44,079 --> 00:39:45,680
and as salesforce grew and and

1225
00:39:45,680 --> 00:39:48,240
uh you know you'd have reorgs and shifts

1226
00:39:48,240 --> 00:39:49,599
of focus

1227
00:39:49,599 --> 00:39:51,280
it was funny to kind of try to find a

1228
00:39:51,280 --> 00:39:52,400
home for ourselves because we don't

1229
00:39:52,400 --> 00:39:52,960
really fit

1230
00:39:52,960 --> 00:39:54,960
it's like alan allen has said a lot is

1231
00:39:54,960 --> 00:39:57,359
uh abuse is kind of like the

1232
00:39:57,359 --> 00:39:58,720
in the twilight zone of information

1233
00:39:58,720 --> 00:40:00,720
security uh it doesn't really

1234
00:40:00,720 --> 00:40:02,560
fit in one's a particular place and you

1235
00:40:02,560 --> 00:40:03,920
look at other other companies and

1236
00:40:03,920 --> 00:40:04,800
they'll have

1237
00:40:04,800 --> 00:40:07,760
abuse as a function of fraud because if

1238
00:40:07,760 --> 00:40:08,640
you offer

1239
00:40:08,640 --> 00:40:09,920
you know a lot of times fraud will be an

1240
00:40:09,920 --> 00:40:12,240
enabler to uh to abuse

1241
00:40:12,240 --> 00:40:14,720
um and so we've kind of had to to work

1242
00:40:14,720 --> 00:40:17,200
with that and find our own place and

1243
00:40:17,200 --> 00:40:19,359
carve it out where we can which which

1244
00:40:19,359 --> 00:40:20,400
really does lead to a lot of

1245
00:40:20,400 --> 00:40:21,920
collaboration

1246
00:40:21,920 --> 00:40:24,480
actually uh before we run out oh darn

1247
00:40:24,480 --> 00:40:25,760
i'm gonna answer in chat

1248
00:40:25,760 --> 00:40:28,000
thomas thank you for your time thank you

1249
00:40:28,000 --> 00:40:32,160
for coming thanks everybody

