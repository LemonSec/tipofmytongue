1
00:00:04,640 --> 00:00:15,079
[Music]

2
00:00:15,120 --> 00:00:15,440
hi

3
00:00:15,440 --> 00:00:18,720
everyone thanks for joining we are

4
00:00:18,720 --> 00:00:20,640
already excited here

5
00:00:20,640 --> 00:00:23,119
and it's our first time speaking in the

6
00:00:23,119 --> 00:00:24,720
black hat

7
00:00:24,720 --> 00:00:28,240
after we showed the bradley to our boss

8
00:00:28,240 --> 00:00:32,079
he said maybe you can try the black hat

9
00:00:32,079 --> 00:00:35,760
no it's actually happened and it's a big

10
00:00:35,760 --> 00:00:37,200
honor to be here

11
00:00:37,200 --> 00:00:41,120
to sharing fine things with you

12
00:00:41,840 --> 00:00:45,440
for some instructions i am social shoe

13
00:00:45,440 --> 00:00:48,719
a iot security researcher from dbf

14
00:00:48,719 --> 00:00:52,079
security headlight i really love to

15
00:00:52,079 --> 00:00:53,199
contribute to

16
00:00:53,199 --> 00:00:57,120
open source projects like pyblz

17
00:00:57,120 --> 00:01:00,399
and the ty get and then also on the

18
00:01:00,399 --> 00:01:02,399
bluescan project

19
00:01:02,399 --> 00:01:04,720
a powerful bluetooth intelligence

20
00:01:04,720 --> 00:01:06,000
collector

21
00:01:06,000 --> 00:01:08,720
hope you guys will try it and i

22
00:01:08,720 --> 00:01:10,960
discovered the bradley

23
00:01:10,960 --> 00:01:15,039
here is my partner shinshin

24
00:01:22,400 --> 00:01:25,680
hello i am xinjin this name sounds a bit

25
00:01:25,680 --> 00:01:26,400
more full

26
00:01:26,400 --> 00:01:29,119
in english but it means confidence in

27
00:01:29,119 --> 00:01:30,400
chinese

28
00:01:30,400 --> 00:01:32,880
i work as a hardwired development

29
00:01:32,880 --> 00:01:34,720
engineer in this project

30
00:01:34,720 --> 00:01:37,759
and contribute part of my work mostly

31
00:01:37,759 --> 00:01:38,799
drivers

32
00:01:38,799 --> 00:01:42,000
to the open source community blu-ray is

33
00:01:42,000 --> 00:01:43,759
an amazing discovery

34
00:01:43,759 --> 00:01:45,840
my partner will explain the way to

35
00:01:45,840 --> 00:01:46,960
discover it

36
00:01:46,960 --> 00:01:55,839
and how it works

37
00:01:59,600 --> 00:02:03,600
so in fact stealthy accessing android

38
00:02:03,600 --> 00:02:04,240
phones

39
00:02:04,240 --> 00:02:07,439
may happen to us everything because

40
00:02:07,439 --> 00:02:10,639
it's difficult for us to figure out what

41
00:02:10,639 --> 00:02:11,360
the apps

42
00:02:11,360 --> 00:02:14,560
are doing behind for example

43
00:02:14,560 --> 00:02:17,599
in june this year cctv

44
00:02:17,599 --> 00:02:21,760
which is an authoritative chinese medium

45
00:02:21,760 --> 00:02:25,200
some short-term privacy chaos in android

46
00:02:25,200 --> 00:02:26,640
apps

47
00:02:26,640 --> 00:02:29,599
is that some well-known apps start

48
00:02:29,599 --> 00:02:30,480
frequently

49
00:02:30,480 --> 00:02:34,720
in short period then access user files

50
00:02:34,720 --> 00:02:38,400
and read the phone book obviously

51
00:02:38,400 --> 00:02:42,080
this is terrible as you can see

52
00:02:42,080 --> 00:02:45,280
these privacy versions like reading the

53
00:02:45,280 --> 00:02:46,239
phone book

54
00:02:46,239 --> 00:02:49,360
are all based on the installed apps

55
00:02:49,360 --> 00:02:53,360
so will it get worse

56
00:02:55,200 --> 00:02:58,959
such as if the app is not installed in

57
00:02:58,959 --> 00:03:00,239
advance

58
00:03:00,239 --> 00:03:02,640
and the attacker doesn't touch your

59
00:03:02,640 --> 00:03:04,239
phone at all

60
00:03:04,239 --> 00:03:07,519
can we also steal the phone book short

61
00:03:07,519 --> 00:03:11,680
messages and so on i try to start with

62
00:03:11,680 --> 00:03:12,159
the

63
00:03:12,159 --> 00:03:15,920
valid system of the android phone

64
00:03:15,920 --> 00:03:20,560
like wi-fi mobile network under nfc

65
00:03:20,560 --> 00:03:25,920
and finally bluetooth press two profiles

66
00:03:26,159 --> 00:03:30,480
pbap the phonebook access profile

67
00:03:30,480 --> 00:03:34,879
and eating the message access profile

68
00:03:34,879 --> 00:03:38,480
as their name see these two profiles

69
00:03:38,480 --> 00:03:41,200
prior services for remote bluetooth

70
00:03:41,200 --> 00:03:42,400
devices

71
00:03:42,400 --> 00:03:45,599
to access local phone book and short

72
00:03:45,599 --> 00:03:47,440
messages

73
00:03:47,440 --> 00:03:50,560
let's see if only these two profiles can

74
00:03:50,560 --> 00:03:51,040
achieve

75
00:03:51,040 --> 00:03:53,519
our goal

76
00:03:54,879 --> 00:03:57,280
let me talk about bluetooth profile

77
00:03:57,280 --> 00:03:58,879
briefly

78
00:03:58,879 --> 00:04:02,239
so what's a bluetooth profile

79
00:04:02,239 --> 00:04:04,799
there are many application scenarios of

80
00:04:04,799 --> 00:04:06,000
bluetooth

81
00:04:06,000 --> 00:04:09,120
and most of them are simple and small

82
00:04:09,120 --> 00:04:10,640
functions

83
00:04:10,640 --> 00:04:13,760
such as a phone book synchronization

84
00:04:13,760 --> 00:04:16,639
short message synchronization there are

85
00:04:16,639 --> 00:04:17,680
many ways to

86
00:04:17,680 --> 00:04:21,120
implement these functions but in order

87
00:04:21,120 --> 00:04:22,800
to allow devices

88
00:04:22,800 --> 00:04:25,360
from different manufacturers to work

89
00:04:25,360 --> 00:04:27,120
together

90
00:04:27,120 --> 00:04:30,320
in the same application scenario we need

91
00:04:30,320 --> 00:04:34,240
a specification and these specifications

92
00:04:34,240 --> 00:04:38,160
are called bluetooth profiles

93
00:04:38,479 --> 00:04:42,400
for example pbap for synchronizing phone

94
00:04:42,400 --> 00:04:43,360
book

95
00:04:43,360 --> 00:04:47,440
i'm ap for manipulating short messages

96
00:04:47,440 --> 00:04:50,720
and more detail pbap defends

97
00:04:50,720 --> 00:04:54,479
two rows pic and pce

98
00:04:54,479 --> 00:04:57,919
this device that provides the phone book

99
00:04:57,919 --> 00:05:01,360
is plc such as android phones

100
00:05:01,360 --> 00:05:03,759
and the device that requests the phone

101
00:05:03,759 --> 00:05:04,800
book

102
00:05:04,800 --> 00:05:08,960
is a pc like bluetooth headset

103
00:05:08,960 --> 00:05:13,520
smart wearable devices and car computers

104
00:05:13,520 --> 00:05:17,120
map also defends two rules mse

105
00:05:17,120 --> 00:05:20,160
and the mce which is similar to

106
00:05:20,160 --> 00:05:23,520
plc and pce but for short

107
00:05:23,520 --> 00:05:26,960
messages besides devices

108
00:05:26,960 --> 00:05:30,080
with strong functions such as android

109
00:05:30,080 --> 00:05:30,960
phones

110
00:05:30,960 --> 00:05:36,400
can simultaneously play as a server or a

111
00:05:36,840 --> 00:05:38,160
client

112
00:05:38,160 --> 00:05:40,560
is a previous research about the

113
00:05:40,560 --> 00:05:41,759
bluetooth profile

114
00:05:41,759 --> 00:05:46,400
implemented by android the bad bluetooth

115
00:05:46,400 --> 00:05:50,240
it was disclosed last year the idea is

116
00:05:50,240 --> 00:05:52,000
to be a malicious bluetooth

117
00:05:52,000 --> 00:05:55,600
device first connect the target phone

118
00:05:55,600 --> 00:05:58,560
with the incentive profile then when

119
00:05:58,560 --> 00:05:59,680
appropriate

120
00:05:59,680 --> 00:06:02,720
we switch to a high authority profile to

121
00:06:02,720 --> 00:06:03,120
take

122
00:06:03,120 --> 00:06:06,880
over the target form for example

123
00:06:06,880 --> 00:06:10,319
first disguised as a harmonies bluetooth

124
00:06:10,319 --> 00:06:11,840
headset

125
00:06:11,840 --> 00:06:14,639
connect to the target form using

126
00:06:14,639 --> 00:06:16,960
hands-free profile

127
00:06:16,960 --> 00:06:20,160
and then we convert into a bluetooth

128
00:06:20,160 --> 00:06:20,880
cable

129
00:06:20,880 --> 00:06:24,720
using the hid profile

130
00:06:24,720 --> 00:06:27,840
so control the target phone

131
00:06:27,840 --> 00:06:30,240
but the bad bluetooth attack model

132
00:06:30,240 --> 00:06:32,240
requires a pre-installed

133
00:06:32,240 --> 00:06:36,400
monitors app and because the current

134
00:06:36,400 --> 00:06:39,759
direction of ppap and map

135
00:06:39,759 --> 00:06:44,080
is opposite to the attack model

136
00:06:44,400 --> 00:06:48,160
it can't achieve the effect i want

137
00:06:48,160 --> 00:06:50,800
thus getting a phone book and short

138
00:06:50,800 --> 00:06:51,680
messages

139
00:06:51,680 --> 00:06:54,880
with no malicious app installed and

140
00:06:54,880 --> 00:06:57,039
make the target phone completely

141
00:06:57,039 --> 00:06:59,759
insensitive

142
00:07:00,479 --> 00:07:04,318
so what can prolapse do

143
00:07:05,280 --> 00:07:08,400
for almost all android's phone

144
00:07:08,400 --> 00:07:11,680
it can still contact call logs

145
00:07:11,680 --> 00:07:14,840
and short messages with only one

146
00:07:14,840 --> 00:07:16,639
interaction

147
00:07:16,639 --> 00:07:19,680
with the sweep team

148
00:07:19,919 --> 00:07:21,919
and the attacker can make this

149
00:07:21,919 --> 00:07:25,758
interaction very deceptive

150
00:07:26,240 --> 00:07:29,360
for well-known manufacturer maybe more

151
00:07:29,360 --> 00:07:30,560
than one

152
00:07:30,560 --> 00:07:33,520
it can achieve the same function but

153
00:07:33,520 --> 00:07:35,520
total disability

154
00:07:35,520 --> 00:07:38,240
it can also use a target phone to send

155
00:07:38,240 --> 00:07:38,720
fake

156
00:07:38,720 --> 00:07:42,240
messages to others ok

157
00:07:42,240 --> 00:07:45,840
let's dive into details

158
00:07:46,639 --> 00:07:50,879
for normal use when we access the ppap

159
00:07:50,879 --> 00:07:54,319
or map of a remote phone

160
00:07:54,319 --> 00:07:57,840
it'll be a pop-up of two dialog boxes

161
00:07:57,840 --> 00:07:58,479
the first

162
00:07:58,479 --> 00:08:01,840
dialog is a parent request after the

163
00:08:01,840 --> 00:08:03,840
user agrees to pair

164
00:08:03,840 --> 00:08:07,280
the android phone will pop up a ppap or

165
00:08:07,280 --> 00:08:10,960
map access request dialog

166
00:08:10,960 --> 00:08:13,199
when both requests are proved by the

167
00:08:13,199 --> 00:08:14,319
user

168
00:08:14,319 --> 00:08:18,479
we can access ppap and map

169
00:08:18,479 --> 00:08:21,520
therefore using pbap and

170
00:08:21,520 --> 00:08:24,720
map to steal the phone book

171
00:08:24,720 --> 00:08:28,639
and short messages is essentially to

172
00:08:28,639 --> 00:08:29,360
bypass

173
00:08:29,360 --> 00:08:32,799
these two dialog boxes let's talk about

174
00:08:32,799 --> 00:08:33,279
the

175
00:08:33,279 --> 00:08:36,559
parent request first

176
00:08:37,839 --> 00:08:40,719
where does the parent request pop up the

177
00:08:40,719 --> 00:08:41,200
first

178
00:08:41,200 --> 00:08:43,919
reason is that we don't have a valid

179
00:08:43,919 --> 00:08:45,680
linking

180
00:08:45,680 --> 00:08:49,120
after we connect to the form since there

181
00:08:49,120 --> 00:08:49,839
is no

182
00:08:49,839 --> 00:08:52,839
value linking the secure simple pairing

183
00:08:52,839 --> 00:08:54,320
ssp

184
00:08:54,320 --> 00:08:56,560
this should be performed according to

185
00:08:56,560 --> 00:08:59,200
the protocol specification

186
00:08:59,200 --> 00:09:02,800
once the ssp is complete the link key

187
00:09:02,800 --> 00:09:05,839
is shared between the two devices

188
00:09:05,839 --> 00:09:08,800
it will use for subsequent reconnection

189
00:09:08,800 --> 00:09:10,000
authentication

190
00:09:10,000 --> 00:09:13,680
and traffic encryption

191
00:09:14,640 --> 00:09:17,519
another reason is that the default io

192
00:09:17,519 --> 00:09:18,640
capability of

193
00:09:18,640 --> 00:09:23,040
android phones is displayed yes no

194
00:09:23,040 --> 00:09:26,000
also according to the bluetooth

195
00:09:26,000 --> 00:09:27,519
specification

196
00:09:27,519 --> 00:09:30,640
the devices at both end should use

197
00:09:30,640 --> 00:09:34,000
lameric comparison as a authentication

198
00:09:34,000 --> 00:09:35,440
method

199
00:09:35,440 --> 00:09:38,959
that is both devices should display

200
00:09:38,959 --> 00:09:41,920
the six digital number for user

201
00:09:41,920 --> 00:09:42,959
comparison

202
00:09:42,959 --> 00:09:46,320
and the verification so

203
00:09:46,320 --> 00:09:49,279
the parent request when the same digital

204
00:09:49,279 --> 00:09:52,240
number has appeared

205
00:09:52,240 --> 00:09:55,440
however the bluetooth specification

206
00:09:55,440 --> 00:09:57,440
also defines other authentication

207
00:09:57,440 --> 00:09:58,720
methods like

208
00:09:58,720 --> 00:10:03,120
pass key entering or just works

209
00:10:03,440 --> 00:10:07,279
what if we use just works

210
00:10:08,959 --> 00:10:12,000
in order to use just works we need to

211
00:10:12,000 --> 00:10:14,240
disguise our io capabilities

212
00:10:14,240 --> 00:10:17,680
as no input no output this

213
00:10:17,680 --> 00:10:21,040
can be achieved using bt agent

214
00:10:21,040 --> 00:10:23,760
on the traffic side the transition from

215
00:10:23,760 --> 00:10:25,040
these players

216
00:10:25,040 --> 00:10:28,399
to no input no output

217
00:10:28,399 --> 00:10:32,959
can be directed using rail shark

218
00:10:32,959 --> 00:10:35,439
like this

219
00:10:37,760 --> 00:10:40,160
then your friend the parent request

220
00:10:40,160 --> 00:10:40,800
dialog

221
00:10:40,800 --> 00:10:44,880
just disappears now only the profile

222
00:10:44,880 --> 00:10:46,240
access request

223
00:10:46,240 --> 00:10:49,680
left as you can see we can simply

224
00:10:49,680 --> 00:10:51,680
pretend to be the name of

225
00:10:51,680 --> 00:10:54,800
a well-known application so

226
00:10:54,800 --> 00:10:58,320
this dialog will become very deceptive

227
00:10:58,320 --> 00:11:01,279
like real chat wants to access your

228
00:11:01,279 --> 00:11:03,839
contacts

229
00:11:04,160 --> 00:11:06,959
skype wants to access your contacts or

230
00:11:06,959 --> 00:11:07,920
tiny grams

231
00:11:07,920 --> 00:11:12,000
want to access your messages

232
00:11:13,360 --> 00:11:15,839
before we talk about how to bypass the

233
00:11:15,839 --> 00:11:17,279
second dialogue

234
00:11:17,279 --> 00:11:19,920
there is a little mention it will be

235
00:11:19,920 --> 00:11:20,959
important

236
00:11:20,959 --> 00:11:24,959
later the no input no output

237
00:11:24,959 --> 00:11:28,720
cost just works and then just walks

238
00:11:28,720 --> 00:11:34,399
cause aosp to use the temporary bond

239
00:11:35,200 --> 00:11:37,920
so why does the profile access request

240
00:11:37,920 --> 00:11:39,519
pop up

241
00:11:39,519 --> 00:11:42,160
for normal use when we request for

242
00:11:42,160 --> 00:11:44,079
accessing the pvap

243
00:11:44,079 --> 00:11:47,920
or map of the remote phone it will use

244
00:11:47,920 --> 00:11:49,839
our bluetooth address

245
00:11:49,839 --> 00:11:52,639
in shared preference to check if we

246
00:11:52,639 --> 00:11:55,120
already have the permission

247
00:11:55,120 --> 00:11:58,560
if no corresponding record is found

248
00:11:58,560 --> 00:12:03,518
the aosp will pop up the dialog box

249
00:12:05,279 --> 00:12:08,880
if user clicks yes or address

250
00:12:08,880 --> 00:12:12,079
and the permissions will be recorded in

251
00:12:12,079 --> 00:12:14,320
shared preference

252
00:12:14,320 --> 00:12:17,200
therefore the next time we request

253
00:12:17,200 --> 00:12:18,079
permission

254
00:12:18,079 --> 00:12:24,399
the dialog will no longer pop up

255
00:12:24,399 --> 00:12:27,040
in simple terms the problem with this

256
00:12:27,040 --> 00:12:29,279
permission verification mechanism

257
00:12:29,279 --> 00:12:32,800
is obvious that we can forge bluetooth

258
00:12:32,800 --> 00:12:33,760
address

259
00:12:33,760 --> 00:12:39,839
just use spoof tooth to achieve this

260
00:12:40,160 --> 00:12:43,760
but there is a problem that's a

261
00:12:43,760 --> 00:12:47,760
sad side effect mentioned earlier

262
00:12:47,760 --> 00:12:51,600
we used no input no output to bypass the

263
00:12:51,600 --> 00:12:53,200
first dialogue

264
00:12:53,200 --> 00:12:56,560
these causes adjust works which in turn

265
00:12:56,560 --> 00:13:00,800
causes aosp to use a temporary bond

266
00:13:00,800 --> 00:13:04,320
then the temporary bond will pass bt

267
00:13:04,320 --> 00:13:07,839
bond state to the opera system bluetooth

268
00:13:07,839 --> 00:13:10,000
app

269
00:13:10,399 --> 00:13:13,839
after the system bluetooth app receives

270
00:13:13,839 --> 00:13:17,360
this state it clears the permission

271
00:13:17,360 --> 00:13:20,240
obtained by the bluetooth address in

272
00:13:20,240 --> 00:13:21,120
this case

273
00:13:21,120 --> 00:13:23,279
we won't be able to inhabit the

274
00:13:23,279 --> 00:13:25,839
permissions

275
00:13:27,760 --> 00:13:30,800
to prevent the system bluetooth app

276
00:13:30,800 --> 00:13:33,600
from clearing permission we can simply

277
00:13:33,600 --> 00:13:34,720
fix the class

278
00:13:34,720 --> 00:13:39,920
of device and the hid pointing device

279
00:13:40,720 --> 00:13:43,760
according to the conditional statement

280
00:13:43,760 --> 00:13:44,959
on the left

281
00:13:44,959 --> 00:13:48,160
the bt-bound state alarm won't be passed

282
00:13:48,160 --> 00:13:48,480
to

283
00:13:48,480 --> 00:13:52,079
certain bluetooth app so

284
00:13:52,079 --> 00:13:54,959
the permissions will not be cleaned and

285
00:13:54,959 --> 00:13:56,480
we can successfully

286
00:13:56,480 --> 00:14:00,480
inherit the permissions at this point

287
00:14:00,480 --> 00:14:04,399
we have bypassed the second dialogue

288
00:14:06,560 --> 00:14:09,199
the above measure does allow us to

289
00:14:09,199 --> 00:14:10,959
inherit permissions

290
00:14:10,959 --> 00:14:14,480
but there is another problem thus

291
00:14:14,480 --> 00:14:18,079
aosp will also change from the temporary

292
00:14:18,079 --> 00:14:18,720
bond

293
00:14:18,720 --> 00:14:21,519
to persistent bond and the persistent

294
00:14:21,519 --> 00:14:22,160
bond

295
00:14:22,160 --> 00:14:24,880
will not automatically accept pairing

296
00:14:24,880 --> 00:14:27,360
request

297
00:14:27,920 --> 00:14:31,680
so these two bypass methods are mutually

298
00:14:31,680 --> 00:14:32,800
exclusive

299
00:14:32,800 --> 00:14:35,839
in other words if we bypass a parent

300
00:14:35,839 --> 00:14:36,800
request

301
00:14:36,800 --> 00:14:39,600
we won't be able to bypass a profile

302
00:14:39,600 --> 00:14:41,360
access request

303
00:14:41,360 --> 00:14:45,279
or if we bypass a profile access request

304
00:14:45,279 --> 00:14:47,600
we won't be able to bypass a parent

305
00:14:47,600 --> 00:14:50,079
request

306
00:14:55,440 --> 00:14:59,839
this is very frustrating

307
00:15:00,000 --> 00:15:03,120
but things turned out to be good for

308
00:15:03,120 --> 00:15:05,279
well-known and just android phone

309
00:15:05,279 --> 00:15:06,560
manufacturer

310
00:15:06,560 --> 00:15:09,199
maybe more than one they have not

311
00:15:09,199 --> 00:15:11,279
successfully bypassed a bt

312
00:15:11,279 --> 00:15:14,959
bounced along to the system bluetooth f

313
00:15:14,959 --> 00:15:18,000
so the permissions we want to inherit

314
00:15:18,000 --> 00:15:20,720
will not be cleared this makes the

315
00:15:20,720 --> 00:15:21,279
target

316
00:15:21,279 --> 00:15:24,800
never feel the attack

317
00:15:25,279 --> 00:15:28,720
at the same time the media reported

318
00:15:28,720 --> 00:15:31,839
that the devices using the customers

319
00:15:31,839 --> 00:15:34,880
android system reached 100 million

320
00:15:34,880 --> 00:15:38,160
in march this year

321
00:15:38,880 --> 00:15:42,240
so this is a whole picture of

322
00:15:42,240 --> 00:15:45,199
the blue rabbit

323
00:15:46,959 --> 00:15:49,600
since blue rapidly is suitable for near

324
00:15:49,600 --> 00:15:51,040
fuel attacks

325
00:15:51,040 --> 00:15:54,000
it is better to have a portable hardware

326
00:15:54,000 --> 00:15:54,800
tour

327
00:15:54,800 --> 00:15:58,399
than the combined rental next i agree

328
00:15:58,399 --> 00:16:00,800
that i'll give the microphone to xinjing

329
00:16:00,800 --> 00:16:09,839
here we'll introduce a hardware tool

330
00:16:14,800 --> 00:16:17,279
yes the blue raptor is a wonderful

331
00:16:17,279 --> 00:16:18,560
discovery

332
00:16:18,560 --> 00:16:20,800
we believe it effect will be better on

333
00:16:20,800 --> 00:16:22,959
portable devices

334
00:16:22,959 --> 00:16:25,279
we try to run blue rapidly on portable

335
00:16:25,279 --> 00:16:26,079
devices

336
00:16:26,079 --> 00:16:30,000
to verify the actual combat capabilities

337
00:16:30,000 --> 00:16:32,800
generally we will use the raspberry pi

338
00:16:32,800 --> 00:16:33,440
to achieve

339
00:16:33,440 --> 00:16:36,720
this goal but in this project raspberry

340
00:16:36,720 --> 00:16:37,279
pi

341
00:16:37,279 --> 00:16:40,639
does have some shortcomings compared to

342
00:16:40,639 --> 00:16:41,759
designing

343
00:16:41,759 --> 00:16:44,720
based on raspberry pi i chose a more

344
00:16:44,720 --> 00:16:46,399
challenging solution

345
00:16:46,399 --> 00:16:49,199
designing a brand new hardware platform

346
00:16:49,199 --> 00:16:50,079
platform for

347
00:16:50,079 --> 00:16:53,360
it if we do this

348
00:16:53,360 --> 00:16:55,279
the device should have the following

349
00:16:55,279 --> 00:16:56,959
capabilities

350
00:16:56,959 --> 00:16:59,839
with enough rom and rom to run the linux

351
00:16:59,839 --> 00:17:00,480
kernel

352
00:17:00,480 --> 00:17:02,720
and passing interpreter with the

353
00:17:02,720 --> 00:17:05,119
hackable bluetooth radio baseband

354
00:17:05,119 --> 00:17:07,760
can be added to a battery powered

355
00:17:07,760 --> 00:17:08,480
operation

356
00:17:08,480 --> 00:17:12,559
environment has an easy to use hmi

357
00:17:12,559 --> 00:17:19,280
besides it shoots small enough

358
00:17:19,280 --> 00:17:22,319
based on these needs we need to choose a

359
00:17:22,319 --> 00:17:23,199
cpu

360
00:17:23,199 --> 00:17:25,679
a bluetooth spaceband and some necessary

361
00:17:25,679 --> 00:17:26,319
perhaps

362
00:17:26,319 --> 00:17:30,480
devices by chance i found a very amazing

363
00:17:30,480 --> 00:17:31,360
shape

364
00:17:31,360 --> 00:17:34,640
it is called a winner s3 which

365
00:17:34,640 --> 00:17:38,880
is a highly integrated save solution

366
00:17:38,880 --> 00:17:41,840
integrates a single core cortex is a

367
00:17:41,840 --> 00:17:43,280
base soc

368
00:17:43,280 --> 00:17:46,480
with a 108 megabyte ddr3 run

369
00:17:46,480 --> 00:17:50,240
in a small bga package

370
00:17:50,559 --> 00:17:52,960
this chip will simplify the credit card

371
00:17:52,960 --> 00:17:53,840
design

372
00:17:53,840 --> 00:17:57,280
and the carry creators of integrated ddr

373
00:17:57,280 --> 00:17:59,919
will also make the final product much

374
00:17:59,919 --> 00:18:01,440
smaller

375
00:18:01,440 --> 00:18:03,840
most importantly it has the ability to

376
00:18:03,840 --> 00:18:07,039
run the linux kernel

377
00:18:07,200 --> 00:18:09,799
the radio baseband uses separate

378
00:18:09,799 --> 00:18:11,520
bcm43438

379
00:18:11,520 --> 00:18:13,520
which is a wi-fi and bluetooth

380
00:18:13,520 --> 00:18:14,880
two-in-one chip

381
00:18:14,880 --> 00:18:17,679
supported by both nexmoon and internal

382
00:18:17,679 --> 00:18:20,080
blue

383
00:18:20,960 --> 00:18:23,120
this two amazing project gives the chip

384
00:18:23,120 --> 00:18:24,400
the ability to

385
00:18:24,400 --> 00:18:27,039
manipulate the physical layer data which

386
00:18:27,039 --> 00:18:27,440
means

387
00:18:27,440 --> 00:18:31,120
it is suitable for this project

388
00:18:31,120 --> 00:18:33,520
my design also equipped with a power

389
00:18:33,520 --> 00:18:34,799
management chip

390
00:18:34,799 --> 00:18:37,840
and an emmc memory chip for

391
00:18:37,840 --> 00:18:41,760
rely on battery and data storage

392
00:18:41,760 --> 00:18:45,840
but how can we combine them using this

393
00:18:45,840 --> 00:18:49,280
no no no no this can't work we need eda

394
00:18:49,280 --> 00:18:50,480
tools

395
00:18:50,480 --> 00:18:53,120
hardware debugging is more complex under

396
00:18:53,120 --> 00:18:54,880
time consuming

397
00:18:54,880 --> 00:18:57,440
each version of the design will take two

398
00:18:57,440 --> 00:18:58,080
weeks

399
00:18:58,080 --> 00:19:00,880
to obtain a sample from the pcb

400
00:19:00,880 --> 00:19:03,679
prototype factory

401
00:19:03,679 --> 00:19:06,320
and the worst thing is i release six

402
00:19:06,320 --> 00:19:08,080
versions of searchmatic

403
00:19:08,080 --> 00:19:11,120
and layout but in the end

404
00:19:11,120 --> 00:19:14,400
i managed to incorporate them in a 2.5

405
00:19:14,400 --> 00:19:15,360
by 5

406
00:19:15,360 --> 00:19:18,639
centimeter pcb

407
00:19:22,960 --> 00:19:25,919
having a working board is just the first

408
00:19:25,919 --> 00:19:26,960
step

409
00:19:26,960 --> 00:19:30,799
it has no saw so as a software

410
00:19:30,799 --> 00:19:32,880
for some reasons a winner has not

411
00:19:32,880 --> 00:19:35,520
publicly released a bsp package for

412
00:19:35,520 --> 00:19:36,799
their chip

413
00:19:36,799 --> 00:19:39,679
if we want to use it we need to sign

414
00:19:39,679 --> 00:19:41,280
some nda contracts

415
00:19:41,280 --> 00:19:45,200
which is annoying for me we are security

416
00:19:45,200 --> 00:19:46,160
researchers

417
00:19:46,160 --> 00:19:49,039
and we thinking in this way i download

418
00:19:49,039 --> 00:19:50,400
the kernel sources

419
00:19:50,400 --> 00:19:52,559
and some link the batteries and open the

420
00:19:52,559 --> 00:19:54,960
decon layer

421
00:19:54,960 --> 00:19:57,039
i showed some necessary drivers and

422
00:19:57,039 --> 00:19:58,080
fixed some bugs

423
00:19:58,080 --> 00:20:00,640
of the exciting open source drivers

424
00:20:00,640 --> 00:20:02,320
including the display driver

425
00:20:02,320 --> 00:20:05,679
lcd controller bluetooth non-muscular

426
00:20:05,679 --> 00:20:08,799
interactive controller

427
00:20:09,039 --> 00:20:12,879
finally i ported u-boot

428
00:20:13,080 --> 00:20:15,840
2020.04 and linux long-term

429
00:20:15,840 --> 00:20:20,159
5.3 to this chip

430
00:20:20,159 --> 00:20:23,039
so far we have an operation system that

431
00:20:23,039 --> 00:20:25,039
iris security researcher is very

432
00:20:25,039 --> 00:20:26,559
familiar with

433
00:20:26,559 --> 00:20:29,039
thanks to the open source community and

434
00:20:29,039 --> 00:20:30,880
all the drivers mentioned above were

435
00:20:30,880 --> 00:20:31,440
published

436
00:20:31,440 --> 00:20:35,039
on magic heart build root 2 chain

437
00:20:35,039 --> 00:20:37,919
simplifies the task of course comparing

438
00:20:37,919 --> 00:20:39,760
necessary packages

439
00:20:39,760 --> 00:20:42,480
soon a root field system compatible with

440
00:20:42,480 --> 00:20:43,440
the original

441
00:20:43,440 --> 00:20:49,840
poc running environment was generated

442
00:20:49,840 --> 00:20:53,120
it's time to focus on the poc itself

443
00:20:53,120 --> 00:20:56,960
we need a touchscreen based ui for it

444
00:20:56,960 --> 00:20:59,360
there's no way letter chip like this i

445
00:20:59,360 --> 00:21:00,640
mean s3

446
00:21:00,640 --> 00:21:03,440
to run a heavy xorg server and the

447
00:21:03,440 --> 00:21:06,799
traditional de 48

448
00:21:06,960 --> 00:21:10,080
qt embedded is a commercial license so

449
00:21:10,080 --> 00:21:13,200
it is not the best choice

450
00:21:13,200 --> 00:21:17,280
finally i met lvgl the demo of the lvgl

451
00:21:17,280 --> 00:21:18,480
is really cool

452
00:21:18,480 --> 00:21:20,960
you are the one i think but i didn't

453
00:21:20,960 --> 00:21:22,400
expect a nightmare

454
00:21:22,400 --> 00:21:26,080
to be unfortunately for a gui framework

455
00:21:26,080 --> 00:21:27,919
with the auto what you see

456
00:21:27,919 --> 00:21:30,720
is what you get editor the development

457
00:21:30,720 --> 00:21:31,520
process was

458
00:21:31,520 --> 00:21:34,640
full of panic here are some lines with

459
00:21:34,640 --> 00:21:36,799
code when using it

460
00:21:36,799 --> 00:21:39,200
but fortunately it becomes a real

461
00:21:39,200 --> 00:21:41,840
reality

462
00:21:42,720 --> 00:21:45,679
we made a turtle box for it it is not

463
00:21:45,679 --> 00:21:46,559
beautiful but

464
00:21:46,559 --> 00:21:50,080
it works our pla printer gets this job

465
00:21:50,080 --> 00:21:51,440
done

466
00:21:51,440 --> 00:21:54,240
here is what is root cache and the

467
00:21:54,240 --> 00:21:55,120
showcase

468
00:21:55,120 --> 00:21:59,840
with the screwdriver

469
00:22:00,240 --> 00:22:02,480
here is the video how blue rapidly with

470
00:22:02,480 --> 00:22:13,840
the portable devices works

471
00:25:06,720 --> 00:25:08,799
this video shows the effect of some

472
00:25:08,799 --> 00:25:10,799
bluetooth profile being

473
00:25:10,799 --> 00:25:13,919
male classically used next so

474
00:25:13,919 --> 00:25:16,640
cell will extract some other points that

475
00:25:16,640 --> 00:25:29,840
may be attacked

476
00:25:33,039 --> 00:25:36,400
so thanks to xinjing gave us a video

477
00:25:36,400 --> 00:25:37,840
demo

478
00:25:37,840 --> 00:25:41,279
okay let me do some summary

479
00:25:41,279 --> 00:25:44,720
in addition to ppap and imep

480
00:25:44,720 --> 00:25:47,760
as you can see sap has a same

481
00:25:47,760 --> 00:25:51,080
problem however exploring

482
00:25:51,080 --> 00:25:54,080
scp-ui requires the root

483
00:25:54,080 --> 00:25:57,279
of the android phone so this is

484
00:25:57,279 --> 00:26:00,159
more difficult

485
00:26:01,440 --> 00:26:04,559
and at the same time there are nearly 40

486
00:26:04,559 --> 00:26:05,200
kinds

487
00:26:05,200 --> 00:26:08,880
of bluetooth profiles so in the future

488
00:26:08,880 --> 00:26:11,600
we still have a lot of scenes to play

489
00:26:11,600 --> 00:26:12,960
thank you

490
00:26:12,960 --> 00:26:18,400
and questions hello hello everyone

491
00:26:19,360 --> 00:26:24,000
i am

492
00:26:24,000 --> 00:26:27,919
i'm here i'm very glad to

493
00:26:27,919 --> 00:26:31,120
join the black hat

494
00:26:32,080 --> 00:26:35,200
in here but there is some

495
00:26:35,200 --> 00:26:38,000
some also in my network connection so

496
00:26:38,000 --> 00:26:39,360
maybe you

497
00:26:39,360 --> 00:26:42,400
will see i'm lagging in in front of the

498
00:26:42,400 --> 00:26:43,679
camera

499
00:26:43,679 --> 00:26:46,720
i'm very sorry for that in this

500
00:26:46,720 --> 00:26:51,679
project i'm working for the hardware

501
00:26:51,679 --> 00:26:53,520
hardware and working for the hardware

502
00:26:53,520 --> 00:26:55,279
for hardware works

503
00:26:55,279 --> 00:26:58,720
and if you have any questions you can

504
00:26:58,720 --> 00:27:01,840
send it in the label discussion and i'm

505
00:27:01,840 --> 00:27:03,279
trying to

506
00:27:03,279 --> 00:27:07,919
answer it thank you

507
00:27:46,840 --> 00:27:48,080
um

508
00:27:48,080 --> 00:27:51,919
check the discussion tab hey so so

509
00:27:51,919 --> 00:28:03,840
you seem disconnected

510
00:28:04,320 --> 00:28:16,559
hey rosa can you hear me

511
00:28:16,559 --> 00:28:19,440
okay uh

512
00:28:21,360 --> 00:28:23,600
yes i am seeing the question type but

513
00:28:23,600 --> 00:28:26,080
the the rapper itself is

514
00:28:26,080 --> 00:28:29,919
is designed by social i think if he has

515
00:28:29,919 --> 00:28:31,279
some

516
00:28:31,279 --> 00:28:33,840
he has some connection problem because

517
00:28:33,840 --> 00:28:34,960
we are in here

518
00:28:34,960 --> 00:28:38,960
the network is not not

519
00:28:38,960 --> 00:28:44,640
not well for some reasons

520
00:28:44,640 --> 00:28:47,679
and i think i kind of i can't answer

521
00:28:47,679 --> 00:28:48,080
some

522
00:28:48,080 --> 00:28:51,919
of the questions about the exploration

523
00:28:51,919 --> 00:28:55,279
exploration itself

524
00:28:56,320 --> 00:29:12,559
should i phone him he is disconnected

525
00:29:12,559 --> 00:29:16,080
okay okay okay i will mention him

526
00:29:16,080 --> 00:29:27,840
in info i'll give him a phone call

527
00:30:41,360 --> 00:30:45,120
i i will give him a phone call but

528
00:30:45,120 --> 00:30:47,600
he didn't answer i gave him a phone call

529
00:30:47,600 --> 00:30:51,840
but he didn't answer

530
00:31:30,840 --> 00:31:33,840
uh

531
00:31:44,840 --> 00:31:47,840
oh

532
00:32:40,840 --> 00:32:43,840
this

533
00:32:54,840 --> 00:32:57,840
okay

534
00:33:08,840 --> 00:33:11,840
foreign

535
00:33:28,720 --> 00:33:34,000
okay i think let me see

536
00:33:34,880 --> 00:33:36,720
oh yeah oh i think you're sending

537
00:33:36,720 --> 00:33:39,679
attacks on iphone mad repeater

538
00:33:39,679 --> 00:33:42,240
oh well it says that it wouldn't be very

539
00:33:42,240 --> 00:33:44,720
interesting

540
00:33:46,480 --> 00:33:53,840
okay let me try to answer some questions

541
00:33:55,919 --> 00:34:00,480
uh can we just answer these questions

542
00:34:00,480 --> 00:34:04,840
before we after we close the

543
00:34:04,840 --> 00:34:07,840
line

544
00:34:10,639 --> 00:34:12,879
yes

545
00:34:29,280 --> 00:34:31,839
okay for the second question to

546
00:34:31,839 --> 00:34:33,839
manufacture do anything to protect

547
00:34:33,839 --> 00:34:35,918
against a deceptive-based attack

548
00:34:35,918 --> 00:34:38,320
to fix the deception-based attack is

549
00:34:38,320 --> 00:34:41,440
only depend on google

550
00:34:43,199 --> 00:34:47,119
is not a it's not a

551
00:34:47,119 --> 00:34:51,520
reasonability for the manufacturer uh it

552
00:34:51,520 --> 00:34:54,480
is based on google there is a defense

553
00:34:54,480 --> 00:34:55,679
for users

554
00:34:55,679 --> 00:34:58,320
uh is there a difference uh just turn

555
00:34:58,320 --> 00:35:01,119
off the bluetooth if you

556
00:35:01,119 --> 00:35:04,000
just to tell the bluetooth if you uh

557
00:35:04,000 --> 00:35:04,560
don't

558
00:35:04,560 --> 00:35:07,680
don't usually use it and uh

559
00:35:07,680 --> 00:35:10,720
is there a patch from the aosp project

560
00:35:10,720 --> 00:35:13,990
for directly uh

561
00:35:13,990 --> 00:35:17,370
[Music]

562
00:35:28,839 --> 00:35:30,720
um

563
00:35:30,720 --> 00:35:34,078
uh the patch

564
00:35:35,839 --> 00:35:39,440
and there is no i asked the

565
00:35:39,440 --> 00:35:42,480
affected manufacturer to

566
00:35:42,480 --> 00:35:45,760
to request the cpe uh but there's no

567
00:35:45,760 --> 00:35:49,040
more new information

568
00:35:51,760 --> 00:35:54,400
uh does legal work if we produce you all

569
00:35:54,400 --> 00:35:55,520
right uh

570
00:35:55,520 --> 00:35:58,720
yes uh i i think i think this is a

571
00:35:58,720 --> 00:36:00,720
i think this is a good question does

572
00:36:00,720 --> 00:36:02,640
this work if bluetooth is already

573
00:36:02,640 --> 00:36:03,760
connected to

574
00:36:03,760 --> 00:36:07,280
the other device uh yes it yes it worked

575
00:36:07,280 --> 00:36:13,839
yeah yes it worked

576
00:36:15,599 --> 00:36:18,400
uh for the uh can i ever have can ever

577
00:36:18,400 --> 00:36:20,800
hear me

578
00:36:23,200 --> 00:36:28,078
hi hi rosa can i hear me

579
00:36:29,599 --> 00:36:32,960
oh i can't hear you

580
00:36:32,960 --> 00:36:35,280
um

581
00:36:36,960 --> 00:36:41,280
they are

582
00:36:41,280 --> 00:36:43,920
for the vulnerability based attack when

583
00:36:43,920 --> 00:36:44,880
your device

584
00:36:44,880 --> 00:36:47,920
pretended to be an auditing all

585
00:36:47,920 --> 00:36:50,640
anticipated device

586
00:36:50,640 --> 00:36:53,599
as your device is known here uh yes we

587
00:36:53,599 --> 00:36:55,839
yes we don't need a linking

588
00:36:55,839 --> 00:36:59,119
yes we don't need a link because we pre

589
00:36:59,119 --> 00:37:00,480
uh we pretend

590
00:37:00,480 --> 00:37:04,560
uh we pretended our uh our capability

591
00:37:04,560 --> 00:37:08,079
uh to uh

592
00:37:08,079 --> 00:37:10,720
uh we're pregnant our capability as a no

593
00:37:10,720 --> 00:37:13,040
input no output so we don't don't need

594
00:37:13,040 --> 00:37:23,839
a link k we use the temporary bound

595
00:37:24,240 --> 00:37:27,280
uh their name uh for the hardware

596
00:37:27,280 --> 00:37:30,960
that you build for production

597
00:37:31,040 --> 00:37:34,079
yes or uh or hardware toy is named

598
00:37:34,079 --> 00:37:37,040
bradley plus and the blue rapidly plus

599
00:37:37,040 --> 00:37:39,280
will introduce will be introduced

600
00:37:39,280 --> 00:37:42,000
in the blackhead arsenal uh and and

601
00:37:42,000 --> 00:37:42,640
there

602
00:37:42,640 --> 00:37:46,240
and there and uh there is more demo

603
00:37:46,240 --> 00:37:51,839
in arsenal

604
00:38:02,839 --> 00:38:04,079
um

605
00:38:04,079 --> 00:38:08,079
uh some guy says uh you also tuck it on

606
00:38:08,079 --> 00:38:08,880
iphone

607
00:38:08,880 --> 00:38:12,400
the iphone is uh uh is only a phone

608
00:38:12,400 --> 00:38:15,440
uh that receives a short message

609
00:38:15,440 --> 00:38:19,760
uh he is not have any uh

610
00:38:19,760 --> 00:38:24,079
brew rapidly is not affected on iphone

611
00:38:24,480 --> 00:38:28,880
the iphone is only receive the fake

612
00:38:30,839 --> 00:38:33,839
message

613
00:38:48,560 --> 00:38:52,000
for whatever when you just um

614
00:38:52,000 --> 00:38:55,200
uh here uh here uh i see the chat room

615
00:38:55,200 --> 00:38:58,079
uh for the uh for the vulnerability

616
00:38:58,079 --> 00:38:58,880
based attack

617
00:38:58,880 --> 00:39:01,359
when your device pretends to be an all

618
00:39:01,359 --> 00:39:03,760
than tkd device

619
00:39:03,760 --> 00:39:06,720
and the attacker the uh the other

620
00:39:06,720 --> 00:39:09,279
attacker

621
00:39:09,440 --> 00:39:12,480
first a

622
00:39:13,040 --> 00:39:17,280
wait a minute uh the attacker

623
00:39:17,280 --> 00:39:19,680
first option two bluetooth device uh

624
00:39:19,680 --> 00:39:21,119
device address

625
00:39:21,119 --> 00:39:24,320
about kenny uh in the availability

626
00:39:24,320 --> 00:39:27,599
uh based uh tax uh uh situation

627
00:39:27,599 --> 00:39:30,320
the first is victim bluetooth address

628
00:39:30,320 --> 00:39:32,480
and the second is an address that has

629
00:39:32,480 --> 00:39:34,320
obtained the access permission of the

630
00:39:34,320 --> 00:39:35,280
team

631
00:39:35,280 --> 00:39:36,560
[Music]

632
00:39:36,560 --> 00:39:39,440
left using the bluetooth headset or

633
00:39:39,440 --> 00:39:41,200
other device belong to the

634
00:39:41,200 --> 00:39:43,839
victim

635
00:39:46,320 --> 00:39:49,440
okay okay

636
00:39:54,839 --> 00:39:57,839
oh

637
00:40:02,560 --> 00:40:06,800
uh uh you uh uh everyone can contact me

638
00:40:06,800 --> 00:40:07,280
about

639
00:40:07,280 --> 00:40:10,560
uh well my email or my email i'll type

640
00:40:10,560 --> 00:40:14,078
my email in the chat room

641
00:40:19,359 --> 00:40:24,480
okay okay thank you rosa

642
00:40:35,680 --> 00:40:39,839
okay thanks everyone

643
00:40:42,400 --> 00:40:46,960
goodbye everyone

