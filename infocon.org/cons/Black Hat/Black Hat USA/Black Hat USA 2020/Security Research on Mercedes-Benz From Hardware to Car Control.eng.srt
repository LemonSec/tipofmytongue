1
00:00:04,620 --> 00:00:14,439
[Music]

2
00:00:18,960 --> 00:00:19,520
hi

3
00:00:19,520 --> 00:00:21,279
and thank you very much for joining this

4
00:00:21,279 --> 00:00:23,680
session my name is guy harpak i'm head

5
00:00:23,680 --> 00:00:25,519
of product security in the mercedes-benz

6
00:00:25,519 --> 00:00:28,000
r d hub in tel aviv

7
00:00:28,000 --> 00:00:29,519
i'm very excited to be speaking here at

8
00:00:29,519 --> 00:00:31,599
blackcat and i hope that we'll be able

9
00:00:31,599 --> 00:00:33,360
to meet each other next time in a more

10
00:00:33,360 --> 00:00:35,360
normal or new normal format

11
00:00:35,360 --> 00:00:38,399
face to face in the next 40 minutes i'm

12
00:00:38,399 --> 00:00:39,760
going to present together with my

13
00:00:39,760 --> 00:00:41,600
partners from 360

14
00:00:41,600 --> 00:00:43,760
more information on the on the security

15
00:00:43,760 --> 00:00:46,000
research done from mercedes-benz that we

16
00:00:46,000 --> 00:00:47,680
presented together at rsa

17
00:00:47,680 --> 00:00:50,079
earlier this year but before we dive

18
00:00:50,079 --> 00:00:51,520
into the technical details of the

19
00:00:51,520 --> 00:00:52,480
research

20
00:00:52,480 --> 00:00:54,480
i want to talk about something big

21
00:00:54,480 --> 00:00:55,680
happening in the world

22
00:00:55,680 --> 00:00:58,879
today and as the cliche goes i'm not

23
00:00:58,879 --> 00:01:00,960
talking about covet 19.

24
00:01:00,960 --> 00:01:02,719
i'm talking about the transformation

25
00:01:02,719 --> 00:01:05,280
going in the automotive industry

26
00:01:05,280 --> 00:01:06,960
i'm sure most of you are aware of this

27
00:01:06,960 --> 00:01:08,479
transformation you probably

28
00:01:08,479 --> 00:01:11,439
even feel it in your day to day we in

29
00:01:11,439 --> 00:01:12,720
the industry like to look at this

30
00:01:12,720 --> 00:01:14,000
transformation

31
00:01:14,000 --> 00:01:17,280
by following four major trends

32
00:01:17,280 --> 00:01:20,560
first the connected car cars becoming

33
00:01:20,560 --> 00:01:22,400
more and more connected connected to the

34
00:01:22,400 --> 00:01:23,680
internet connected to other

35
00:01:23,680 --> 00:01:25,040
infrastructure

36
00:01:25,040 --> 00:01:28,240
seamless and intuitive mobility enabling

37
00:01:28,240 --> 00:01:29,119
features

38
00:01:29,119 --> 00:01:32,079
ranging from entertainment into more

39
00:01:32,079 --> 00:01:33,759
unique and special

40
00:01:33,759 --> 00:01:36,640
even safety features second trend we

41
00:01:36,640 --> 00:01:37,439
follow

42
00:01:37,439 --> 00:01:40,479
are the autonomous cars i'm not going to

43
00:01:40,479 --> 00:01:41,920
talk about it too much today

44
00:01:41,920 --> 00:01:44,159
we all know we talk about it we hear

45
00:01:44,159 --> 00:01:45,040
about it

46
00:01:45,040 --> 00:01:47,439
we read about it in the news daily i

47
00:01:47,439 --> 00:01:49,119
won't share more insights here

48
00:01:49,119 --> 00:01:51,119
but we all know that this is a major

49
00:01:51,119 --> 00:01:53,040
trend going through the industry

50
00:01:53,040 --> 00:01:56,320
third shared shared mobility services

51
00:01:56,320 --> 00:01:57,439
around cars

52
00:01:57,439 --> 00:02:00,240
share mobility allowing new usage models

53
00:02:00,240 --> 00:02:02,799
and services new digital services

54
00:02:02,799 --> 00:02:06,799
for us car car drivers car customers

55
00:02:06,799 --> 00:02:10,239
last but not least electric mobility

56
00:02:10,239 --> 00:02:12,720
locally free emission very exciting

57
00:02:12,720 --> 00:02:13,520
trend

58
00:02:13,520 --> 00:02:16,480
and again a shift for the entire

59
00:02:16,480 --> 00:02:17,920
industry

60
00:02:17,920 --> 00:02:20,239
but we are a cyber security conference

61
00:02:20,239 --> 00:02:22,640
so i will focus today on the connected

62
00:02:22,640 --> 00:02:23,680
cars

63
00:02:23,680 --> 00:02:25,520
and i'll focus on securing and connected

64
00:02:25,520 --> 00:02:26,800
cars

65
00:02:26,800 --> 00:02:29,040
securing a connected car is a challenge

66
00:02:29,040 --> 00:02:30,400
a car is a system

67
00:02:30,400 --> 00:02:32,720
of systems it has a lot of complexity in

68
00:02:32,720 --> 00:02:34,400
it and securing it

69
00:02:34,400 --> 00:02:37,440
is exciting but when you think about it

70
00:02:37,440 --> 00:02:40,879
securing a connected car is not enough

71
00:02:40,879 --> 00:02:43,599
because we think of how to secure each

72
00:02:43,599 --> 00:02:44,160
car

73
00:02:44,160 --> 00:02:47,519
and how to defend the entire fleet

74
00:02:47,519 --> 00:02:49,200
and in order to illustrate the challenge

75
00:02:49,200 --> 00:02:50,879
here i like to think

76
00:02:50,879 --> 00:02:53,519
of a patch of road the petrov highway

77
00:02:53,519 --> 00:02:54,800
imagine a highway

78
00:02:54,800 --> 00:02:58,400
in rush hour so just imagine

79
00:02:58,400 --> 00:03:00,640
how many cars do you see in this pitch

80
00:03:00,640 --> 00:03:02,239
of huawei of highway

81
00:03:02,239 --> 00:03:05,760
during rush hour how many types of cars

82
00:03:05,760 --> 00:03:08,879
how many different model years some of

83
00:03:08,879 --> 00:03:10,480
you probably know

84
00:03:10,480 --> 00:03:15,040
each car can have between 70 to 150

85
00:03:15,040 --> 00:03:17,519
electronic control units issues those

86
00:03:17,519 --> 00:03:19,040
are little computers

87
00:03:19,040 --> 00:03:20,239
with a microcontroller or

88
00:03:20,239 --> 00:03:22,800
microprocessors running code

89
00:03:22,800 --> 00:03:24,879
connecting to the net to the network

90
00:03:24,879 --> 00:03:26,319
they have interfaces

91
00:03:26,319 --> 00:03:28,400
and they could have vulnerabilities so

92
00:03:28,400 --> 00:03:29,920
if you multiply

93
00:03:29,920 --> 00:03:32,319
the amount of cars that you imagined by

94
00:03:32,319 --> 00:03:33,680
the amount of ecu's

95
00:03:33,680 --> 00:03:35,840
electronic control units you can get in

96
00:03:35,840 --> 00:03:37,120
a single patch of highway

97
00:03:37,120 --> 00:03:39,120
2 000 tens of thousands maybe even

98
00:03:39,120 --> 00:03:40,400
millions of cars

99
00:03:40,400 --> 00:03:42,799
think about it around the world this is

100
00:03:42,799 --> 00:03:44,959
one of the largest iot network around

101
00:03:44,959 --> 00:03:47,040
the world connected cars

102
00:03:47,040 --> 00:03:49,280
now i always say i have three little

103
00:03:49,280 --> 00:03:51,280
kids and have a dog back home

104
00:03:51,280 --> 00:03:54,159
this is very interesting daily challenge

105
00:03:54,159 --> 00:03:55,599
but professionally

106
00:03:55,599 --> 00:03:57,680
defending a flit is one of the biggest

107
00:03:57,680 --> 00:03:59,360
challenges i've seen

108
00:03:59,360 --> 00:04:01,840
and we are tackling this challenge in

109
00:04:01,840 --> 00:04:02,799
order to do that

110
00:04:02,799 --> 00:04:05,120
we have an approach we like to call it

111
00:04:05,120 --> 00:04:08,000
fleet secops fleet security operations

112
00:04:08,000 --> 00:04:10,640
defending if the fleet of cars on the

113
00:04:10,640 --> 00:04:12,159
road

114
00:04:12,159 --> 00:04:14,560
how would you do fleet secops how would

115
00:04:14,560 --> 00:04:15,200
you do

116
00:04:15,200 --> 00:04:18,478
fleet security operations pretty much

117
00:04:18,478 --> 00:04:19,918
like you would do for

118
00:04:19,918 --> 00:04:22,320
standard enterprise network standard iot

119
00:04:22,320 --> 00:04:23,199
devices

120
00:04:23,199 --> 00:04:26,080
all of the other um systems that we need

121
00:04:26,080 --> 00:04:26,400
to

122
00:04:26,400 --> 00:04:29,919
to defend first you assess where you

123
00:04:29,919 --> 00:04:31,520
stand

124
00:04:31,520 --> 00:04:32,960
you try to identify all of your

125
00:04:32,960 --> 00:04:35,120
vulnerabilities you try to know what are

126
00:04:35,120 --> 00:04:36,960
the threats what are the risks

127
00:04:36,960 --> 00:04:39,280
maybe you have a red team in place maybe

128
00:04:39,280 --> 00:04:41,199
you have a threat intelligence team in

129
00:04:41,199 --> 00:04:43,520
place building the threat landscape for

130
00:04:43,520 --> 00:04:44,000
you

131
00:04:44,000 --> 00:04:45,440
so you know where you stand you can

132
00:04:45,440 --> 00:04:47,600
assess second

133
00:04:47,600 --> 00:04:50,000
you have the technologies the processes

134
00:04:50,000 --> 00:04:51,280
the people in place

135
00:04:51,280 --> 00:04:53,919
to detect any attack so for example you

136
00:04:53,919 --> 00:04:55,520
use the head unit the

137
00:04:55,520 --> 00:04:57,360
little computer that you use to maybe

138
00:04:57,360 --> 00:04:58,960
hear music navigation

139
00:04:58,960 --> 00:05:00,800
maybe control the air conditioning and

140
00:05:00,800 --> 00:05:02,320
this little computer in the car is

141
00:05:02,320 --> 00:05:04,160
suddenly sending a breaking signal

142
00:05:04,160 --> 00:05:06,720
then something is probably wrong but

143
00:05:06,720 --> 00:05:08,160
take it to the higher level take it to

144
00:05:08,160 --> 00:05:09,360
the fleet level

145
00:05:09,360 --> 00:05:11,199
look at all the anonymous data you get

146
00:05:11,199 --> 00:05:12,400
from a fleet

147
00:05:12,400 --> 00:05:15,199
and try to see that does my fleet today

148
00:05:15,199 --> 00:05:17,120
behave the same as it did in the same

149
00:05:17,120 --> 00:05:18,800
geography yesterday

150
00:05:18,800 --> 00:05:20,560
if there's something different

151
00:05:20,560 --> 00:05:22,960
potentially i've detected an attack

152
00:05:22,960 --> 00:05:25,120
and then comes the third stage the

153
00:05:25,120 --> 00:05:27,280
ability to respond

154
00:05:27,280 --> 00:05:30,479
people processes again technologies in

155
00:05:30,479 --> 00:05:31,120
place

156
00:05:31,120 --> 00:05:34,320
to respond to any potential attack

157
00:05:34,320 --> 00:05:37,440
so you can investigate so you can

158
00:05:37,440 --> 00:05:38,960
do any changes fixing any

159
00:05:38,960 --> 00:05:40,800
vulnerabilities that are needed

160
00:05:40,800 --> 00:05:42,880
so you can do the forensics to

161
00:05:42,880 --> 00:05:44,320
understand the scope

162
00:05:44,320 --> 00:05:47,520
of any potential attack and then

163
00:05:47,520 --> 00:05:49,680
after you have the lessons learned the

164
00:05:49,680 --> 00:05:50,720
fourth stage

165
00:05:50,720 --> 00:05:52,400
last but really not least because it's

166
00:05:52,400 --> 00:05:53,759
all part of a

167
00:05:53,759 --> 00:05:55,680
of a round signal a circle that is

168
00:05:55,680 --> 00:05:57,199
happening all the time you need to

169
00:05:57,199 --> 00:05:59,840
protect further protect your fleet

170
00:05:59,840 --> 00:06:01,120
it can be the cars that we are

171
00:06:01,120 --> 00:06:03,039
developing today and it can be the cars

172
00:06:03,039 --> 00:06:04,560
that are already in the road

173
00:06:04,560 --> 00:06:07,120
so in essence between any event and

174
00:06:07,120 --> 00:06:07,840
event

175
00:06:07,840 --> 00:06:10,319
you have better security for the entire

176
00:06:10,319 --> 00:06:12,560
fleet

177
00:06:12,560 --> 00:06:14,400
if you learn want to learn more about

178
00:06:14,400 --> 00:06:15,600
fleet setups

179
00:06:15,600 --> 00:06:17,199
then you can look at the presentation we

180
00:06:17,199 --> 00:06:19,520
gave at rsa earlier this year where we

181
00:06:19,520 --> 00:06:21,360
talked about the key principles

182
00:06:21,360 --> 00:06:23,440
and how we tackle the key challenges in

183
00:06:23,440 --> 00:06:24,479
fleet cyclops

184
00:06:24,479 --> 00:06:26,240
but since this is blackhead i want to

185
00:06:26,240 --> 00:06:28,080
leave some time to the partnership 360

186
00:06:28,080 --> 00:06:28,479
to

187
00:06:28,479 --> 00:06:31,039
to detail more about the great research

188
00:06:31,039 --> 00:06:31,840
they've done

189
00:06:31,840 --> 00:06:34,000
and now it helped us improve the

190
00:06:34,000 --> 00:06:34,880
security

191
00:06:34,880 --> 00:06:37,759
of our fleet so thank you very much i

192
00:06:37,759 --> 00:06:39,680
invite to the virtual stage the partners

193
00:06:39,680 --> 00:06:40,800
from 360

194
00:06:40,800 --> 00:06:43,120
and i'll come back to the virtual stage

195
00:06:43,120 --> 00:06:44,720
afterwards to talk a little bit about

196
00:06:44,720 --> 00:06:45,759
what we did

197
00:06:45,759 --> 00:06:48,800
once this this those findings were

198
00:06:48,800 --> 00:06:52,160
responsibly disclosed thank you

199
00:06:52,160 --> 00:06:54,880
hi everyone i'm john holy today i'm glad

200
00:06:54,880 --> 00:06:56,960
to speak at black hats

201
00:06:56,960 --> 00:06:59,599
it's a dream come true for me fence

202
00:06:59,599 --> 00:07:00,880
black has a real world

203
00:07:00,880 --> 00:07:03,440
sense for schedule team's hard work and

204
00:07:03,440 --> 00:07:05,120
memory will start his talk

205
00:07:05,120 --> 00:07:08,160
please enjoy schedule team is a

206
00:07:08,160 --> 00:07:10,400
security research team established in

207
00:07:10,400 --> 00:07:12,080
2014

208
00:07:12,080 --> 00:07:14,840
we focus on connected car and industry

209
00:07:14,840 --> 00:07:17,800
security in china we have about

210
00:07:17,800 --> 00:07:21,039
75 percent market share on cyber

211
00:07:21,039 --> 00:07:23,440
security of connected car

212
00:07:23,440 --> 00:07:26,639
notable research about six years ago we

213
00:07:26,639 --> 00:07:26,960
do

214
00:07:26,960 --> 00:07:30,560
the first cyber security case

215
00:07:30,560 --> 00:07:33,840
on tesla and byd connectivity technology

216
00:07:33,840 --> 00:07:37,039
then we do the research on tesla's

217
00:07:37,039 --> 00:07:38,479
automatic system

218
00:07:38,479 --> 00:07:42,160
about three years ago we developed the

219
00:07:42,160 --> 00:07:45,919
can evaluation platform called chempic

220
00:07:45,919 --> 00:07:49,759
and in 2019 we developed

221
00:07:49,759 --> 00:07:53,360
a numerical active defense system

222
00:07:53,360 --> 00:07:56,960
for the campus the last one is we

223
00:07:56,960 --> 00:08:00,479
have done the best expense cases from

224
00:08:00,479 --> 00:08:01,840
the hardware to

225
00:08:01,840 --> 00:08:05,120
control this is the turnaround of our

226
00:08:05,120 --> 00:08:05,919
research

227
00:08:05,919 --> 00:08:09,360
on mr stands about

228
00:08:09,360 --> 00:08:12,160
two years ago we started research on mr

229
00:08:12,160 --> 00:08:13,199
spence

230
00:08:13,199 --> 00:08:16,639
then we spend about one year

231
00:08:16,639 --> 00:08:20,720
to fund the vulnerabilities to achieve

232
00:08:20,720 --> 00:08:23,759
car control then we report the finance

233
00:08:23,759 --> 00:08:24,479
to the

234
00:08:24,479 --> 00:08:26,960
gambler then they fixed their

235
00:08:26,960 --> 00:08:28,960
vulnerability very quickly

236
00:08:28,960 --> 00:08:33,039
and we decided to publish our research

237
00:08:33,039 --> 00:08:36,479
today this is the result of research

238
00:08:36,479 --> 00:08:40,240
the impact of our research our ability

239
00:08:40,240 --> 00:08:41,120
can impact our

240
00:08:41,120 --> 00:08:43,919
mr spence connected car in china in over

241
00:08:43,919 --> 00:08:45,360
two minutes

242
00:08:45,360 --> 00:08:47,920
and we can get access to invoke remote

243
00:08:47,920 --> 00:08:48,959
servers

244
00:08:48,959 --> 00:08:51,519
to control the car like controller doors

245
00:08:51,519 --> 00:08:52,080
light

246
00:08:52,080 --> 00:08:54,720
windows engine and we can do these

247
00:08:54,720 --> 00:08:55,760
things without

248
00:08:55,760 --> 00:08:59,040
physical access this is the agenda of

249
00:08:59,040 --> 00:09:00,480
our talk

250
00:09:00,480 --> 00:09:02,720
first of all we will talk about how to

251
00:09:02,720 --> 00:09:04,160
build test bench

252
00:09:04,160 --> 00:09:07,440
then we focus on hummers the last thing

253
00:09:07,440 --> 00:09:08,080
is

254
00:09:08,080 --> 00:09:10,000
the way to cut control this is the most

255
00:09:10,000 --> 00:09:11,120
important you care

256
00:09:11,120 --> 00:09:13,360
then we will give the summary from the

257
00:09:13,360 --> 00:09:14,320
schedule

258
00:09:14,320 --> 00:09:17,680
and that will introduce the instance

259
00:09:17,680 --> 00:09:19,279
response

260
00:09:19,279 --> 00:09:22,959
in their position and their summary

261
00:09:22,959 --> 00:09:25,680
about our research okay let's talk about

262
00:09:25,680 --> 00:09:27,519
build test bench

263
00:09:27,519 --> 00:09:30,880
in our research we have two very

264
00:09:30,880 --> 00:09:33,680
important components the first one is

265
00:09:33,680 --> 00:09:34,640
harvest

266
00:09:34,640 --> 00:09:38,080
as known as tcu telematics country unit

267
00:09:38,080 --> 00:09:40,720
the secondary head unit is known as the

268
00:09:40,720 --> 00:09:43,920
vehicle infotainment system

269
00:09:43,920 --> 00:09:47,760
hermes harvest is tco 30

270
00:09:47,760 --> 00:09:50,480
magnetic control unit this this device

271
00:09:50,480 --> 00:09:52,399
provides communication functionality for

272
00:09:52,399 --> 00:09:53,360
the web

273
00:09:53,360 --> 00:09:56,240
this device draws too much attention

274
00:09:56,240 --> 00:09:56,640
from

275
00:09:56,640 --> 00:09:59,680
security research since it helps helps

276
00:09:59,680 --> 00:10:01,120
users to remote

277
00:10:01,120 --> 00:10:03,760
monitor and control the car we find

278
00:10:03,760 --> 00:10:05,279
several version of the

279
00:10:05,279 --> 00:10:08,240
permus from the market this harvest has

280
00:10:08,240 --> 00:10:09,519
little differences

281
00:10:09,519 --> 00:10:13,839
between each other's own hardware design

282
00:10:14,480 --> 00:10:17,200
ideology is a computer that provides

283
00:10:17,200 --> 00:10:19,040
infotainment functionalities

284
00:10:19,040 --> 00:10:21,440
this device is also called inverting

285
00:10:21,440 --> 00:10:22,640
infotainment system

286
00:10:22,640 --> 00:10:25,680
it provides bluetooth wi-fi and

287
00:10:25,680 --> 00:10:29,600
usb servers users can interact with it

288
00:10:29,600 --> 00:10:31,519
to control the car and get more

289
00:10:31,519 --> 00:10:33,360
information about the car

290
00:10:33,360 --> 00:10:36,160
richer than the head unit and we learned

291
00:10:36,160 --> 00:10:37,040
that

292
00:10:37,040 --> 00:10:40,880
this head unit is much more complicated

293
00:10:40,880 --> 00:10:43,839
with the same device in other cars

294
00:10:43,839 --> 00:10:44,720
whenever

295
00:10:44,720 --> 00:10:48,320
in hardware and software we will talk

296
00:10:48,320 --> 00:10:52,399
more detail later the first step

297
00:10:52,399 --> 00:10:55,120
for us is to view the test bench it

298
00:10:55,120 --> 00:10:56,000
helps

299
00:10:56,000 --> 00:10:58,320
us easier to do the research on the

300
00:10:58,320 --> 00:10:59,360
table

301
00:10:59,360 --> 00:11:02,880
we draw this image you can see the left

302
00:11:02,880 --> 00:11:05,120
image according to the architecture of

303
00:11:05,120 --> 00:11:07,519
mrexpense connected column

304
00:11:07,519 --> 00:11:10,560
it helps us to make head unit and hermes

305
00:11:10,560 --> 00:11:14,000
works when we built

306
00:11:14,000 --> 00:11:17,200
test bench we can't third

307
00:11:17,200 --> 00:11:20,240
on anti-safe warning and staff of fumes

308
00:11:20,240 --> 00:11:21,920
expense was designed for

309
00:11:21,920 --> 00:11:25,519
ngg 2.5 since 1990.

310
00:11:25,519 --> 00:11:28,240
the united states has crossed much in

311
00:11:28,240 --> 00:11:29,440
convenience

312
00:11:29,440 --> 00:11:32,480
to our research since it's wasted

313
00:11:32,480 --> 00:11:35,760
our so much time after now we met

314
00:11:35,760 --> 00:11:39,200
three types of unsafe the first one is

315
00:11:39,200 --> 00:11:41,519
warning you to restart hype

316
00:11:41,519 --> 00:11:45,360
head unit that you are structured

317
00:11:45,360 --> 00:11:48,399
because you must ask your dealer or

318
00:11:48,399 --> 00:11:49,920
contact master's

319
00:11:49,920 --> 00:11:52,959
service center to deactivate this and

320
00:11:52,959 --> 00:11:54,880
safe

321
00:11:54,880 --> 00:11:56,880
with the help of dealer we solve this

322
00:11:56,880 --> 00:11:58,079
problem

323
00:11:58,079 --> 00:12:01,120
temporarily but it is easy to

324
00:12:01,120 --> 00:12:04,079
trigger such level and safe during your

325
00:12:04,079 --> 00:12:05,120
research

326
00:12:05,120 --> 00:12:08,480
when we encounter this problem we must

327
00:12:08,480 --> 00:12:11,839
spend much time and money to ask

328
00:12:11,839 --> 00:12:15,600
dealer's help it is too professional

329
00:12:15,600 --> 00:12:18,800
for more convenience we back up the

330
00:12:18,800 --> 00:12:22,000
sd card data to restore the head unit

331
00:12:22,000 --> 00:12:24,880
whatever we want then we use the canvas

332
00:12:24,880 --> 00:12:25,440
tool

333
00:12:25,440 --> 00:12:27,200
to find out the anti-safe trigger

334
00:12:27,200 --> 00:12:29,040
message we made

335
00:12:29,040 --> 00:12:31,760
can make the media tool which have

336
00:12:31,760 --> 00:12:32,639
two-way

337
00:12:32,639 --> 00:12:35,680
cancer receiver it can divide the

338
00:12:35,680 --> 00:12:38,639
ecu network into two parts therefore we

339
00:12:38,639 --> 00:12:39,120
can

340
00:12:39,120 --> 00:12:42,079
failure or modify the message on cameras

341
00:12:42,079 --> 00:12:44,320
we have analyzed the message on

342
00:12:44,320 --> 00:12:47,519
khmi and ka in this

343
00:12:47,519 --> 00:12:50,720
process we found that once the ic

344
00:12:50,720 --> 00:12:53,839
or the control panel disconnected

345
00:12:53,839 --> 00:12:56,959
the head unit will restart quickly if we

346
00:12:56,959 --> 00:12:59,040
send the abnormal care message

347
00:12:59,040 --> 00:13:02,160
to the head unit for instance we change

348
00:13:02,160 --> 00:13:05,040
the vm and it will check the high level

349
00:13:05,040 --> 00:13:06,000
additive

350
00:13:06,000 --> 00:13:08,160
this time we have only one way to do

351
00:13:08,160 --> 00:13:10,160
which is to restore the head unit

352
00:13:10,160 --> 00:13:13,120
we found out different heartbeats

353
00:13:13,120 --> 00:13:13,839
message

354
00:13:13,839 --> 00:13:17,040
for these two-way cameras for

355
00:13:17,040 --> 00:13:20,480
regular learning moreover we found out

356
00:13:20,480 --> 00:13:23,519
same idea to prevent

357
00:13:23,519 --> 00:13:26,639
high-level anti-safe finally we built

358
00:13:26,639 --> 00:13:27,120
the

359
00:13:27,120 --> 00:13:30,480
test bench successfully before talk

360
00:13:30,480 --> 00:13:32,320
about the vulnerability

361
00:13:32,320 --> 00:13:34,560
we should analyze the attack of vectors

362
00:13:34,560 --> 00:13:35,760
first

363
00:13:35,760 --> 00:13:38,160
the head unit is the first device that

364
00:13:38,160 --> 00:13:39,360
we researched

365
00:13:39,360 --> 00:13:42,639
the version is rtg 5.5 it's used

366
00:13:42,639 --> 00:13:45,920
windows ce automotive 7 operating system

367
00:13:45,920 --> 00:13:49,760
and it has spent uh so much time to

368
00:13:49,760 --> 00:13:50,639
analyze

369
00:13:50,639 --> 00:13:52,880
it because we must figure out how it

370
00:13:52,880 --> 00:13:55,519
boots and how it loads the kernel

371
00:13:55,519 --> 00:13:58,639
the faces and the kernel are together

372
00:13:58,639 --> 00:14:02,079
and you can see there are so many fails

373
00:14:02,079 --> 00:14:05,440
we decorated and extracted

374
00:14:05,440 --> 00:14:08,639
in this picture but it doesn't mean that

375
00:14:08,639 --> 00:14:11,519
we clear this game it's just the

376
00:14:11,519 --> 00:14:13,040
beginning

377
00:14:13,040 --> 00:14:16,160
it's very hard for us to do reverse

378
00:14:16,160 --> 00:14:17,199
engineering

379
00:14:17,199 --> 00:14:18,959
on these fields which have many

380
00:14:18,959 --> 00:14:20,480
structure and

381
00:14:20,480 --> 00:14:23,920
objects for inter process communication

382
00:14:23,920 --> 00:14:26,639
we can't guess what they are the most

383
00:14:26,639 --> 00:14:27,839
difficult

384
00:14:27,839 --> 00:14:31,360
is how to dynamic debug them we never

385
00:14:31,360 --> 00:14:32,880
study windows ce and

386
00:14:32,880 --> 00:14:35,920
we have no knowledge about it moreover

387
00:14:35,920 --> 00:14:39,120
it's true and discarded by

388
00:14:39,120 --> 00:14:42,880
ipos the shock of the head unit

389
00:14:42,880 --> 00:14:46,079
is releasers our car h2

390
00:14:46,079 --> 00:14:48,800
solution we don't have our car issue

391
00:14:48,800 --> 00:14:51,040
debug environment because we

392
00:14:51,040 --> 00:14:53,839
didn't buy it you know this is called

393
00:14:53,839 --> 00:14:54,639
our car

394
00:14:54,639 --> 00:14:58,240
h2 dbk even if we got the dpk we

395
00:14:58,240 --> 00:15:01,760
have no user manual and the gonna say

396
00:15:01,760 --> 00:15:03,920
automotive 7 is not an open source

397
00:15:03,920 --> 00:15:05,920
project we have no idea about that

398
00:15:05,920 --> 00:15:09,040
we got a fully born black

399
00:15:09,040 --> 00:15:11,920
and we started when i say is 7 and then

400
00:15:11,920 --> 00:15:12,240
we

401
00:15:12,240 --> 00:15:15,839
tried to run this executable first for a

402
00:15:15,839 --> 00:15:16,480
long time

403
00:15:16,480 --> 00:15:19,519
but it has too much issues so we gave up

404
00:15:19,519 --> 00:15:22,800
the research on rtg fiber into five

405
00:15:22,800 --> 00:15:26,320
the next attack vector is obd2 i think

406
00:15:26,320 --> 00:15:29,199
car hike can research because of idea

407
00:15:29,199 --> 00:15:31,440
because it usually doesn't have a pro

408
00:15:31,440 --> 00:15:34,160
caption the obd interface connects to

409
00:15:34,160 --> 00:15:35,680
the harvest and the eis

410
00:15:35,680 --> 00:15:39,040
the currency is the tidy communication

411
00:15:39,040 --> 00:15:43,600
contribute where the eis means

412
00:15:43,600 --> 00:15:46,720
electronic ignition system

413
00:15:46,720 --> 00:15:48,959
also the eis is the gateway in the

414
00:15:48,959 --> 00:15:50,320
welcome the obd

415
00:15:50,320 --> 00:15:54,160
attacking its physical access is limited

416
00:15:54,160 --> 00:15:58,079
and the severity is low for

417
00:15:58,079 --> 00:16:00,480
new mr spence car because we can't

418
00:16:00,480 --> 00:16:02,079
affect the power of

419
00:16:02,079 --> 00:16:05,600
human safety functionality such as

420
00:16:05,600 --> 00:16:08,959
airbag and the display from obd2

421
00:16:08,959 --> 00:16:10,480
interface

422
00:16:10,480 --> 00:16:12,959
and then you may ask why don't you play

423
00:16:12,959 --> 00:16:14,240
a new key

424
00:16:14,240 --> 00:16:17,040
from obd2 with exceeding if i told you

425
00:16:17,040 --> 00:16:18,160
we can't do that

426
00:16:18,160 --> 00:16:22,560
without fps for data because we don't

427
00:16:22,560 --> 00:16:26,399
have any authorized accounts from the

428
00:16:26,399 --> 00:16:28,560
daimler

429
00:16:28,560 --> 00:16:31,759
the last attack vector in the test bench

430
00:16:31,759 --> 00:16:32,880
is harvest

431
00:16:32,880 --> 00:16:36,160
the harvest can contain a 4g module

432
00:16:36,160 --> 00:16:38,079
that connects to the car with the

433
00:16:38,079 --> 00:16:40,399
internet currency is designed by harman

434
00:16:40,399 --> 00:16:41,120
kardon

435
00:16:41,120 --> 00:16:44,399
that's used in various links it will

436
00:16:44,399 --> 00:16:47,519
either there will say how do you

437
00:16:47,519 --> 00:16:50,480
access the internet through the hummus

438
00:16:50,480 --> 00:16:52,079
the chromos communicates

439
00:16:52,079 --> 00:16:55,120
with the head unit has many methods such

440
00:16:55,120 --> 00:16:57,360
as the bluetooth wi-fi

441
00:16:57,360 --> 00:17:00,880
usb the practical code wcc

442
00:17:00,880 --> 00:17:05,199
which is a daimler's own particle

443
00:17:05,199 --> 00:17:08,400
the traditional attack vector is useless

444
00:17:08,400 --> 00:17:10,880
for hormones but we've still found some

445
00:17:10,880 --> 00:17:15,119
useful attack vector in hardware aspect

446
00:17:15,119 --> 00:17:18,319
okay let's talk about hermes

447
00:17:18,319 --> 00:17:21,119
from us plays a very important role in

448
00:17:21,119 --> 00:17:23,280
communicating with the internet

449
00:17:23,280 --> 00:17:26,240
this is the critical contouring of our

450
00:17:26,240 --> 00:17:26,959
talk

451
00:17:26,959 --> 00:17:29,200
in the beginning when we got the hermas

452
00:17:29,200 --> 00:17:30,320
we

453
00:17:30,320 --> 00:17:33,039
have no idea about this because this

454
00:17:33,039 --> 00:17:33,520
this

455
00:17:33,520 --> 00:17:37,440
this device is a much more security

456
00:17:37,440 --> 00:17:39,760
much more secure than other devices we

457
00:17:39,760 --> 00:17:42,240
have seen

458
00:17:42,240 --> 00:17:46,000
hermes has multiplied is

459
00:17:46,000 --> 00:17:50,000
it it's rating from 3g to 4g the old

460
00:17:50,000 --> 00:17:53,760
mod use the qualcomm salary module

461
00:17:53,760 --> 00:17:57,840
the new one is his lincoln salary module

462
00:17:57,840 --> 00:18:00,720
for the pcb design aspect the usb

463
00:18:00,720 --> 00:18:03,600
interface was removed from the old one

464
00:18:03,600 --> 00:18:07,120
they intend vias with further

465
00:18:07,120 --> 00:18:10,400
masks in the pcb which made it

466
00:18:10,400 --> 00:18:13,280
more challenge to build the test bench

467
00:18:13,280 --> 00:18:15,280
in the latest hormones 2

468
00:18:15,280 --> 00:18:17,520
it doesn't have a new feature only the

469
00:18:17,520 --> 00:18:18,559
gps

470
00:18:18,559 --> 00:18:22,880
module and antenna has been optimized

471
00:18:22,880 --> 00:18:26,160
for older modes such as

472
00:18:26,160 --> 00:18:29,280
a-class e-class gre class the hermes

473
00:18:29,280 --> 00:18:30,640
connects to the

474
00:18:30,640 --> 00:18:34,160
head unit value sb

475
00:18:34,160 --> 00:18:37,440
and for the old high

476
00:18:37,440 --> 00:18:40,320
end mode firmwares connect to the head

477
00:18:40,320 --> 00:18:40,880
unit

478
00:18:40,880 --> 00:18:44,080
will bluetooth for the

479
00:18:44,080 --> 00:18:46,880
for the new models chromos version is

480
00:18:46,880 --> 00:18:48,240
1.5

481
00:18:48,240 --> 00:18:51,520
and 2.1 which connects to the head unit

482
00:18:51,520 --> 00:18:55,360
with double ln they they use the wcc

483
00:18:55,360 --> 00:18:56,320
protocol

484
00:18:56,320 --> 00:18:58,799
then joha tikkawa here talk more about

485
00:18:58,799 --> 00:19:01,360
the detail

486
00:19:01,360 --> 00:19:03,520
to find the demand process of the phd we

487
00:19:03,520 --> 00:19:04,480
should prepare

488
00:19:04,480 --> 00:19:07,520
4g module ps7 and

489
00:19:07,520 --> 00:19:10,559
fund appropriate p according to the

490
00:19:10,559 --> 00:19:13,280
pcb wiring finally you can connect this

491
00:19:13,280 --> 00:19:15,840
process with your tools

492
00:19:15,840 --> 00:19:18,000
there is a hard way to find the 4g

493
00:19:18,000 --> 00:19:20,000
modules

494
00:19:20,000 --> 00:19:23,039
use the pg rework station hit from the

495
00:19:23,039 --> 00:19:25,919
button at 400 celsius

496
00:19:25,919 --> 00:19:28,960
for one minute and you can remove time

497
00:19:28,960 --> 00:19:30,000
quickly

498
00:19:30,000 --> 00:19:31,919
then you can use the flashlight and

499
00:19:31,919 --> 00:19:33,600
watch features to find out

500
00:19:33,600 --> 00:19:37,520
where it's common that an iot device you

501
00:19:37,520 --> 00:19:38,880
see if you wanted backbone

502
00:19:38,880 --> 00:19:41,120
of course we found your debug for the

503
00:19:41,120 --> 00:19:42,559
recoveries

504
00:19:42,559 --> 00:19:45,440
we found some media names and user names

505
00:19:45,440 --> 00:19:48,160
for the network initialization log

506
00:19:48,160 --> 00:19:50,400
also we found it back in the urls for

507
00:19:50,400 --> 00:19:53,840
new search

508
00:19:54,480 --> 00:19:57,120
at the usb port we found finally

509
00:19:57,120 --> 00:19:58,480
modernity commands

510
00:19:58,480 --> 00:20:00,960
we open more debug ports with the set

511
00:20:00,960 --> 00:20:02,960
mode command

512
00:20:02,960 --> 00:20:06,080
at the 4g module dpk you can open a db

513
00:20:06,080 --> 00:20:08,240
series with set modes

514
00:20:08,240 --> 00:20:11,360
however for her means we didn't open the

515
00:20:11,360 --> 00:20:13,600
mv service in this way

516
00:20:13,600 --> 00:20:16,880
we found more in the devices

517
00:20:16,880 --> 00:20:21,840
after sending set mode comments

518
00:20:22,400 --> 00:20:24,320
we can send more into command to the

519
00:20:24,320 --> 00:20:26,320
application interface

520
00:20:26,320 --> 00:20:28,159
there's another way to obtain an

521
00:20:28,159 --> 00:20:30,240
application configuration

522
00:20:30,240 --> 00:20:32,720
that is change the usb mode and send

523
00:20:32,720 --> 00:20:35,039
this command to flash pde context

524
00:20:35,039 --> 00:20:36,880
configuration

525
00:20:36,880 --> 00:20:39,440
the api name is there for example use

526
00:20:39,440 --> 00:20:40,159
the atr

527
00:20:40,159 --> 00:20:43,360
grid to flash the system you should

528
00:20:43,360 --> 00:20:44,080
repackage

529
00:20:44,080 --> 00:20:46,559
an available firmware and bypass the

530
00:20:46,559 --> 00:20:49,120
signature check

531
00:20:49,120 --> 00:20:51,840
furthermore you must keep the watchdog

532
00:20:51,840 --> 00:20:53,200
sleeve

533
00:20:53,200 --> 00:20:55,120
otherwise when you upgrade the fudge

534
00:20:55,120 --> 00:20:56,240
module

535
00:20:56,240 --> 00:20:58,960
then you recess the power and you will

536
00:20:58,960 --> 00:21:00,240
get a break

537
00:21:00,240 --> 00:21:03,520
by the way we got many bricks well we

538
00:21:03,520 --> 00:21:05,039
don't have a detect

539
00:21:05,039 --> 00:21:08,240
tool for the msu but we found

540
00:21:08,240 --> 00:21:10,720
jet hack debug interface at the 4g

541
00:21:10,720 --> 00:21:11,919
module

542
00:21:11,919 --> 00:21:14,960
it enters the brake partner successfully

543
00:21:14,960 --> 00:21:17,039
we can read or write the photographer

544
00:21:17,039 --> 00:21:19,440
because it was loaded in memory

545
00:21:19,440 --> 00:21:21,760
as well you can modify the memory you

546
00:21:21,760 --> 00:21:23,840
can dampen under the firmware

547
00:21:23,840 --> 00:21:27,280
but we don't have another driver

548
00:21:27,280 --> 00:21:29,120
it's a little bit hard to read that

549
00:21:29,120 --> 00:21:31,280
flash from the jetpack because

550
00:21:31,280 --> 00:21:33,280
because you have to reverse engineer the

551
00:21:33,280 --> 00:21:36,320
kernel and find out the register for the

552
00:21:36,320 --> 00:21:39,360
land controller on the other side the

553
00:21:39,360 --> 00:21:41,840
brake points are unstable

554
00:21:41,840 --> 00:21:45,039
if you enter breakpoints

555
00:21:45,039 --> 00:21:47,679
or start restart your 4g module to

556
00:21:47,679 --> 00:21:50,080
prevent it from restarting

557
00:21:50,080 --> 00:21:52,159
you should connect the msc with your

558
00:21:52,159 --> 00:21:53,120
device and

559
00:21:53,120 --> 00:21:55,039
feed the watchdog while permission is

560
00:21:55,039 --> 00:21:56,159
running

561
00:21:56,159 --> 00:21:59,200
this way to travel 2000

562
00:21:59,200 --> 00:22:01,919
so we have to find another way to get

563
00:22:01,919 --> 00:22:03,919
the firmware

564
00:22:03,919 --> 00:22:07,039
let's see the storage memory

565
00:22:07,039 --> 00:22:09,440
open the shared of cellular module you

566
00:22:09,440 --> 00:22:11,360
can find any massive

567
00:22:11,360 --> 00:22:14,400
chief which is composed of nanoflash

568
00:22:14,400 --> 00:22:18,480
and ddr whether it is all the new

569
00:22:18,480 --> 00:22:21,200
4g module they both use the same memory

570
00:22:21,200 --> 00:22:21,679
size

571
00:22:21,679 --> 00:22:24,840
flash the difference is just the

572
00:22:24,840 --> 00:22:27,840
packaging

573
00:22:28,000 --> 00:22:31,360
we use the media workstation to heat the

574
00:22:31,360 --> 00:22:33,280
tear down

575
00:22:33,280 --> 00:22:35,679
left is the old nano flash and the right

576
00:22:35,679 --> 00:22:38,159
here the new nand flash

577
00:22:38,159 --> 00:22:41,760
for the bj1 37 and flash we don't have a

578
00:22:41,760 --> 00:22:43,600
property

579
00:22:43,600 --> 00:22:46,320
so we have to wire up into the pso for

580
00:22:46,320 --> 00:22:47,280
the npc

581
00:22:47,280 --> 00:22:50,799
adapter actually we just need one of

582
00:22:50,799 --> 00:22:54,159
16 magnets wires which includes

583
00:22:54,159 --> 00:22:57,360
six control pins and edited iops

584
00:22:57,360 --> 00:23:01,200
recipients are the recipe and the gnd

585
00:23:01,200 --> 00:23:04,080
this is not hard but with your time and

586
00:23:04,080 --> 00:23:04,960
your eyes

587
00:23:04,960 --> 00:23:08,159
of course we set up enhancements wiring

588
00:23:08,159 --> 00:23:08,640
up

589
00:23:08,640 --> 00:23:11,520
magnets wires

590
00:23:13,039 --> 00:23:16,159
so we made some pcb adapters and

591
00:23:16,159 --> 00:23:19,679
circuits and it can work out all the 48

592
00:23:19,679 --> 00:23:22,480
pins because we wanted to support 8-bit

593
00:23:22,480 --> 00:23:22,799
and

594
00:23:22,799 --> 00:23:25,919
16-bit non-flash by just changing the

595
00:23:25,919 --> 00:23:27,440
surface only

596
00:23:27,440 --> 00:23:30,720
so that we can reuse the circuits but

597
00:23:30,720 --> 00:23:33,600
for smaller size manufacture we just

598
00:23:33,600 --> 00:23:35,280
wear out the required piece

599
00:23:35,280 --> 00:23:37,840
because the dissonance of timbers are so

600
00:23:37,840 --> 00:23:39,039
small

601
00:23:39,039 --> 00:23:41,279
that the pcb section doesn't support the

602
00:23:41,279 --> 00:23:44,640
wheels as we found out

603
00:23:45,200 --> 00:23:47,520
the next is to dump data from the nano

604
00:23:47,520 --> 00:23:49,279
flash program

605
00:23:49,279 --> 00:23:53,440
hph has a 2014 advice data zone and the

606
00:23:53,440 --> 00:23:56,880
64 biases bay area we can use the

607
00:23:56,880 --> 00:23:57,440
correct

608
00:23:57,440 --> 00:24:00,559
parameters to reduce it from the cheap

609
00:24:00,559 --> 00:24:04,400
chip according to the user manual

610
00:24:04,400 --> 00:24:07,760
this bar area is called ob area

611
00:24:07,760 --> 00:24:11,120
at first we created another flash manual

612
00:24:11,120 --> 00:24:14,559
and we found some about a spare area

613
00:24:14,559 --> 00:24:18,000
the option suggests that the last

614
00:24:18,000 --> 00:24:21,279
34 bytes of each page

615
00:24:21,279 --> 00:24:24,080
but we found that the last 64 bytes have

616
00:24:24,080 --> 00:24:24,480
some

617
00:24:24,480 --> 00:24:28,159
system data it doesn't match the

618
00:24:28,159 --> 00:24:30,720
user manual because this area mapping

619
00:24:30,720 --> 00:24:31,919
depends on the nano

620
00:24:31,919 --> 00:24:34,240
controller in the 4g module rather than

621
00:24:34,240 --> 00:24:35,120
the

622
00:24:35,120 --> 00:24:39,200
non-flash chip comparing the nut dump

623
00:24:39,200 --> 00:24:41,120
between the qualcomm and the high city

624
00:24:41,120 --> 00:24:43,760
car you can find the mapping of the

625
00:24:43,760 --> 00:24:47,360
areas another say there are two ways to

626
00:24:47,360 --> 00:24:48,960
find the mappings of the

627
00:24:48,960 --> 00:24:51,520
spare area one is to check the source

628
00:24:51,520 --> 00:24:52,080
code

629
00:24:52,080 --> 00:24:54,799
also the nanoflash controller has the

630
00:24:54,799 --> 00:24:56,080
superior map

631
00:24:56,080 --> 00:25:00,000
and this is the qualcomm nano control

632
00:25:00,000 --> 00:25:01,120
driver

633
00:25:01,120 --> 00:25:04,080
is open source

634
00:25:04,240 --> 00:25:06,000
we can find details that are called

635
00:25:06,000 --> 00:25:08,720
comments also the

636
00:25:08,720 --> 00:25:10,880
automotive that flashes single level

637
00:25:10,880 --> 00:25:13,120
cell the qualcomm device

638
00:25:13,120 --> 00:25:16,320
page by 500 by the

639
00:25:16,320 --> 00:25:19,840
sub page each sub page has one spare

640
00:25:19,840 --> 00:25:20,480
area but

641
00:25:20,480 --> 00:25:23,200
not all the non-display area mappings

642
00:25:23,200 --> 00:25:26,400
are open to the public

643
00:25:27,120 --> 00:25:29,279
for the unknown mapping you can pick out

644
00:25:29,279 --> 00:25:32,400
two pages with the space area

645
00:25:32,400 --> 00:25:34,559
then compare them you can find something

646
00:25:34,559 --> 00:25:37,840
special at the same obsessed as a page

647
00:25:37,840 --> 00:25:41,840
such as the ff or the random

648
00:25:41,840 --> 00:25:44,080
this belongs to the spare area which

649
00:25:44,080 --> 00:25:46,400
includes bedrock flank and efficient

650
00:25:46,400 --> 00:25:48,400
data

651
00:25:48,400 --> 00:25:50,880
the next is to make sure to remove the

652
00:25:50,880 --> 00:25:52,400
spare area

653
00:25:52,400 --> 00:25:54,960
there are three different types of spare

654
00:25:54,960 --> 00:25:56,320
mappings

655
00:25:56,320 --> 00:25:59,919
including butlers systems and modems

656
00:25:59,919 --> 00:26:03,840
and weak care system partitions only

657
00:26:03,840 --> 00:26:06,000
in general the civil area does include

658
00:26:06,000 --> 00:26:07,360
data about the whole

659
00:26:07,360 --> 00:26:11,840
system however there's not

660
00:26:12,240 --> 00:26:15,760
qualcomm system partitioning used by ffs

661
00:26:15,760 --> 00:26:17,919
which is a fast system for an embedded

662
00:26:17,919 --> 00:26:18,960
device

663
00:26:18,960 --> 00:26:22,559
the yffs needs to use 16 bytes in

664
00:26:22,559 --> 00:26:26,799
this bay area after removing the spare

665
00:26:26,799 --> 00:26:27,840
area

666
00:26:27,840 --> 00:26:31,039
the firmware is still a single binary

667
00:26:31,039 --> 00:26:32,720
file

668
00:26:32,720 --> 00:26:35,520
there's no transported extra data from

669
00:26:35,520 --> 00:26:36,480
it

670
00:26:36,480 --> 00:26:39,120
so we need to find a partition table

671
00:26:39,120 --> 00:26:41,039
from the 4g module to

672
00:26:41,039 --> 00:26:44,480
separate each partition

673
00:26:45,279 --> 00:26:48,159
for the qualcomm 4g module you can find

674
00:26:48,159 --> 00:26:50,840
partition tables by searching these

675
00:26:50,840 --> 00:26:52,159
magics

676
00:26:52,159 --> 00:26:55,200
the start of inbox is the primary magic

677
00:26:55,200 --> 00:26:56,559
and the sub magic

678
00:26:56,559 --> 00:26:59,279
another way is to search for mi bib

679
00:26:59,279 --> 00:27:00,640
strings and you must

680
00:27:00,640 --> 00:27:03,279
find it because of the partition name of

681
00:27:03,279 --> 00:27:04,400
the table

682
00:27:04,400 --> 00:27:06,880
when you wrote the python script to pass

683
00:27:06,880 --> 00:27:09,360
the partition table and extract files

684
00:27:09,360 --> 00:27:10,720
from it

685
00:27:10,720 --> 00:27:13,279
we found that the throttle is an android

686
00:27:13,279 --> 00:27:15,039
image for march

687
00:27:15,039 --> 00:27:17,360
it used multi-line operators such as

688
00:27:17,360 --> 00:27:19,760
apps bl

689
00:27:19,760 --> 00:27:22,880
sbl2 obviously

690
00:27:22,880 --> 00:27:26,080
the 4g module has a secure boot you can

691
00:27:26,080 --> 00:27:28,159
find the system which for upgrading

692
00:27:28,159 --> 00:27:31,520
the redundance the high silicon 4g major

693
00:27:31,520 --> 00:27:35,200
modem processing similar to qualcomm

694
00:27:35,200 --> 00:27:37,440
the bootloader in our silicon

695
00:27:37,440 --> 00:27:38,320
development

696
00:27:38,320 --> 00:27:41,440
kit always prints the partition table

697
00:27:41,440 --> 00:27:42,799
when it's boots

698
00:27:42,799 --> 00:27:45,120
the partition table is the same as the

699
00:27:45,120 --> 00:27:46,320
hermes

700
00:27:46,320 --> 00:27:48,880
another way is to check the open source

701
00:27:48,880 --> 00:27:49,760
code of high

702
00:27:49,760 --> 00:27:53,279
silicon in the nut dots you can find a

703
00:27:53,279 --> 00:27:55,520
string called p table hat

704
00:27:55,520 --> 00:27:57,600
if you google it you will find it with

705
00:27:57,600 --> 00:27:59,679
another source codes

706
00:27:59,679 --> 00:28:01,520
we can find the partition table and

707
00:28:01,520 --> 00:28:02,880
extract partitions

708
00:28:02,880 --> 00:28:06,320
according to the source code

709
00:28:06,960 --> 00:28:09,679
finally we pass the partition table of

710
00:28:09,679 --> 00:28:10,960
heart silicon

711
00:28:10,960 --> 00:28:12,720
the name is balanced we send our

712
00:28:12,720 --> 00:28:15,360
children telematic

713
00:28:15,360 --> 00:28:18,159
it's the same as the 4g router which

714
00:28:18,159 --> 00:28:20,799
used the balloon 7 r2 you can

715
00:28:20,799 --> 00:28:25,360
find something just added for pdf4r

716
00:28:25,679 --> 00:28:30,240
what's more the file system is yffs2

717
00:28:30,240 --> 00:28:33,919
the yffs is designed for the non-flash

718
00:28:33,919 --> 00:28:37,760
to keep the flash works longer the wi-fi

719
00:28:37,760 --> 00:28:40,880
uses the well leveling so that block is

720
00:28:40,880 --> 00:28:44,240
non-sequential the block map inside in

721
00:28:44,240 --> 00:28:45,440
the space area

722
00:28:45,440 --> 00:28:48,399
we wrote the tool to operate the yffs

723
00:28:48,399 --> 00:28:49,279
standalone

724
00:28:49,279 --> 00:28:51,760
partition according to the linux web

725
00:28:51,760 --> 00:28:54,799
fast driver

726
00:28:55,679 --> 00:28:59,039
we got other system files and we found a

727
00:28:59,039 --> 00:29:00,240
lot of oem

728
00:29:00,240 --> 00:29:02,960
apps so the next step is to analyze

729
00:29:02,960 --> 00:29:04,720
these applications

730
00:29:04,720 --> 00:29:07,520
during our reverse engineering works we

731
00:29:07,520 --> 00:29:08,960
find that some of

732
00:29:08,960 --> 00:29:12,559
the references are missing or wrong

733
00:29:12,559 --> 00:29:15,520
and some executable files can't run in

734
00:29:15,520 --> 00:29:17,200
the emulator

735
00:29:17,200 --> 00:29:19,440
that makes me confused after comparing

736
00:29:19,440 --> 00:29:20,960
the firmware dumps from

737
00:29:20,960 --> 00:29:24,840
the same nand flash we found a midfield

738
00:29:24,840 --> 00:29:28,080
problem after triple shooting the bt

739
00:29:28,080 --> 00:29:30,880
ping is a phenomenon

740
00:29:30,880 --> 00:29:34,000
therefore another controller needs ecc

741
00:29:34,000 --> 00:29:36,000
the other qualcomm name flash has a bit

742
00:29:36,000 --> 00:29:37,919
flippy errors but

743
00:29:37,919 --> 00:29:40,640
at the nand flash of hermes 1.5 is

744
00:29:40,640 --> 00:29:42,159
perfect

745
00:29:42,159 --> 00:29:44,640
to fix the mid-flipping errors we have

746
00:29:44,640 --> 00:29:46,080
two ways

747
00:29:46,080 --> 00:29:48,799
one is to compare non-flash down

748
00:29:48,799 --> 00:29:50,399
repeatedly

749
00:29:50,399 --> 00:29:52,720
replace the change speed with speed

750
00:29:52,720 --> 00:29:53,840
which is the most

751
00:29:53,840 --> 00:29:57,360
frequent but that does not really solve

752
00:29:57,360 --> 00:29:59,919
the problem

753
00:29:59,919 --> 00:30:02,720
the other one is to check the source

754
00:30:02,720 --> 00:30:04,480
code about ecc

755
00:30:04,480 --> 00:30:06,480
but it just shows that if this is

756
00:30:06,480 --> 00:30:08,880
algorithm type

757
00:30:08,880 --> 00:30:10,880
the coding implementation and the

758
00:30:10,880 --> 00:30:14,159
polynomial is not the same

759
00:30:14,159 --> 00:30:17,840
this user is not open to the public

760
00:30:17,840 --> 00:30:20,320
the hermes ur reports only brings out

761
00:30:20,320 --> 00:30:21,039
the law

762
00:30:21,039 --> 00:30:23,679
doesn't have an interactive shell for

763
00:30:23,679 --> 00:30:26,399
dynamic debugging the permissive

764
00:30:26,399 --> 00:30:29,440
we need to modify the cmd line to

765
00:30:29,440 --> 00:30:32,080
augmented ui share redirected to the

766
00:30:32,080 --> 00:30:35,520
hermes ports oh we can disable the

767
00:30:35,520 --> 00:30:36,240
firewall

768
00:30:36,240 --> 00:30:39,840
and open adb service but we can't write

769
00:30:39,840 --> 00:30:43,279
the change to netflash directory

770
00:30:43,279 --> 00:30:45,840
because nanocontroller has hardware ac

771
00:30:45,840 --> 00:30:46,640
well that that

772
00:30:46,640 --> 00:30:49,919
program doesn't so we have to generate

773
00:30:49,919 --> 00:30:50,880
corrective

774
00:30:50,880 --> 00:30:54,720
emergent into the ob area the writing to

775
00:30:54,720 --> 00:30:56,320
the nand flash

776
00:30:56,320 --> 00:30:58,880
we got an ecc algorithm and generated

777
00:30:58,880 --> 00:31:00,159
the correct uses

778
00:31:00,159 --> 00:31:03,279
that is the same as the data from the

779
00:31:03,279 --> 00:31:04,640
net

780
00:31:04,640 --> 00:31:07,840
we connect the data area ecc area

781
00:31:07,840 --> 00:31:09,279
reverse area

782
00:31:09,279 --> 00:31:13,360
and bad block flag together on each page

783
00:31:13,360 --> 00:31:16,000
because the secure mode only checks the

784
00:31:16,000 --> 00:31:16,399
boot

785
00:31:16,399 --> 00:31:19,679
procedure we can change the system files

786
00:31:19,679 --> 00:31:22,720
freely then flash the new raw data

787
00:31:22,720 --> 00:31:25,840
to nand flash the last job is

788
00:31:25,840 --> 00:31:29,760
nano rebooting this optics bga rework

789
00:31:29,760 --> 00:31:30,640
station

790
00:31:30,640 --> 00:31:33,440
can help you align the boss we can

791
00:31:33,440 --> 00:31:35,440
modify the system to build the

792
00:31:35,440 --> 00:31:39,200
hermes uk after we've got the roadshow

793
00:31:39,200 --> 00:31:39,840
we find

794
00:31:39,840 --> 00:31:42,640
application card engineer modes which

795
00:31:42,640 --> 00:31:44,720
can manage the hermes services

796
00:31:44,720 --> 00:31:47,039
it has an account signal but it's not a

797
00:31:47,039 --> 00:31:47,760
real can

798
00:31:47,760 --> 00:31:52,000
signal it just constructs pdu

799
00:31:52,000 --> 00:31:56,399
and sends it to the sh-2a and cu

800
00:31:56,399 --> 00:31:59,039
then the answer is weather transmitted

801
00:31:59,039 --> 00:31:59,440
to

802
00:31:59,440 --> 00:32:02,080
campus

803
00:32:03,440 --> 00:32:06,000
if you need to get full access to canvas

804
00:32:06,000 --> 00:32:08,399
you need to modify the message to a

805
00:32:08,399 --> 00:32:09,679
firmware

806
00:32:09,679 --> 00:32:12,000
but i think it's a nightmare network for

807
00:32:12,000 --> 00:32:14,080
me because if should do it you need to

808
00:32:14,080 --> 00:32:14,559
learn

809
00:32:14,559 --> 00:32:17,760
the ssh qa instruction then got the

810
00:32:17,760 --> 00:32:20,559
message to a id and debugging tool

811
00:32:20,559 --> 00:32:23,200
and spend a lot of time to reverse and

812
00:32:23,200 --> 00:32:23,600
pass

813
00:32:23,600 --> 00:32:27,360
it so we give up the assets to a reverse

814
00:32:27,360 --> 00:32:29,360
engineering

815
00:32:29,360 --> 00:32:33,679
that's the research work for the hermes

816
00:32:33,679 --> 00:32:36,559
and we also found the vulnerabilities in

817
00:32:36,559 --> 00:32:39,919
the tsp's requirements

818
00:32:39,919 --> 00:32:42,159
now we will show the research about the

819
00:32:42,159 --> 00:32:43,519
backhand

820
00:32:43,519 --> 00:32:46,399
okay thank you how ever took over here

821
00:32:46,399 --> 00:32:46,880
to talk

822
00:32:46,880 --> 00:32:50,080
more about cloud control we got our

823
00:32:50,080 --> 00:32:53,279
interactive chair in hermes however we

824
00:32:53,279 --> 00:32:56,000
have no way to attack hermes directly

825
00:32:56,000 --> 00:32:58,640
now obtain iran and think that if we

826
00:32:58,640 --> 00:32:59,519
could

827
00:32:59,519 --> 00:33:02,640
control the back end can we control the

828
00:33:02,640 --> 00:33:05,360
hermes then can we eventually control

829
00:33:05,360 --> 00:33:06,960
the car

830
00:33:06,960 --> 00:33:09,519
at the very beginning we got a 4g looter

831
00:33:09,519 --> 00:33:10,159
then we

832
00:33:10,159 --> 00:33:13,600
wrote up the e-cip to a sim card

833
00:33:13,600 --> 00:33:16,559
adapter configurated the api information

834
00:33:16,559 --> 00:33:18,000
we found earlier

835
00:33:18,000 --> 00:33:21,039
but it doesn't work because the 4g

836
00:33:21,039 --> 00:33:24,159
router shield no servers

837
00:33:24,159 --> 00:33:27,039
after troubleshooting we found out that

838
00:33:27,039 --> 00:33:27,919
m2m

839
00:33:27,919 --> 00:33:31,360
backend could detect the mei and

840
00:33:31,360 --> 00:33:34,080
if the imei changed the account could be

841
00:33:34,080 --> 00:33:34,720
frozen

842
00:33:34,720 --> 00:33:38,000
immediately so before using esem we have

843
00:33:38,000 --> 00:33:41,200
to write the original device imei

844
00:33:41,200 --> 00:33:44,559
in our 4g device so we must

845
00:33:44,559 --> 00:33:47,600
find our 4g device that we can change

846
00:33:47,600 --> 00:33:51,200
mdei such as an unlocked

847
00:33:51,200 --> 00:33:54,880
4g module development both multiplied

848
00:33:54,880 --> 00:33:59,760
4g looter or mtk platform phone

849
00:33:59,760 --> 00:34:02,399
we got another available esteem which i

850
00:34:02,399 --> 00:34:04,080
took it off the board

851
00:34:04,080 --> 00:34:07,600
because if we connect it with jump wires

852
00:34:07,600 --> 00:34:11,040
which brokes easily finally

853
00:34:11,040 --> 00:34:14,000
manages to connect to the 4g carrier

854
00:34:14,000 --> 00:34:14,879
network

855
00:34:14,879 --> 00:34:17,040
on the root system you can see that it's

856
00:34:17,040 --> 00:34:18,879
got a ipv4

857
00:34:18,879 --> 00:34:21,440
address it belongs to the carrier's

858
00:34:21,440 --> 00:34:23,199
internet

859
00:34:23,199 --> 00:34:26,239
however the carrier internet has a

860
00:34:26,239 --> 00:34:27,520
security policy

861
00:34:27,520 --> 00:34:30,000
device isolated from each other

862
00:34:30,000 --> 00:34:32,159
therefore we are not going to scan

863
00:34:32,159 --> 00:34:35,119
for internet and app address because

864
00:34:35,119 --> 00:34:36,000
that is

865
00:34:36,000 --> 00:34:38,639
almost no help for us to discover

866
00:34:38,639 --> 00:34:39,918
backend server

867
00:34:39,918 --> 00:34:42,960
and it will lead the server to alarm we

868
00:34:42,960 --> 00:34:44,800
can use this esem to

869
00:34:44,800 --> 00:34:48,079
access the internet and

870
00:34:48,079 --> 00:34:51,839
as soon as we send a gdp request

871
00:34:51,839 --> 00:34:54,480
the browser returned a page from the

872
00:34:54,480 --> 00:34:55,760
china unicom's

873
00:34:55,760 --> 00:34:59,280
shop but it doesn't matter it just means

874
00:34:59,280 --> 00:35:02,640
the account is create credit

875
00:35:02,640 --> 00:35:04,880
but we can still request the backend

876
00:35:04,880 --> 00:35:07,440
servers in this situation

877
00:35:07,440 --> 00:35:09,680
there are so many fails we got from the

878
00:35:09,680 --> 00:35:10,480
system

879
00:35:10,480 --> 00:35:13,280
it is too heavy for us to do reverse

880
00:35:13,280 --> 00:35:14,720
engineering one by one

881
00:35:14,720 --> 00:35:18,320
therefore we use a firmware tool

882
00:35:18,320 --> 00:35:21,440
it is called yet another firmware

883
00:35:21,440 --> 00:35:24,640
analysis framework which can help us

884
00:35:24,640 --> 00:35:25,200
analyze

885
00:35:25,200 --> 00:35:27,680
all the phase relationships in the

886
00:35:27,680 --> 00:35:29,040
firmware

887
00:35:29,040 --> 00:35:32,400
first we use the domain of select

888
00:35:32,400 --> 00:35:36,160
ul that we found from the uart log

889
00:35:36,160 --> 00:35:39,280
before to find the files related to the

890
00:35:39,280 --> 00:35:40,400
domain

891
00:35:40,400 --> 00:35:42,720
in the left picture we can find some

892
00:35:42,720 --> 00:35:45,119
configuration phase with this domain

893
00:35:45,119 --> 00:35:47,920
in the red image we can get more url

894
00:35:47,920 --> 00:35:49,920
information that is helpful for

895
00:35:49,920 --> 00:35:52,960
further contrasting testing

896
00:35:52,960 --> 00:35:56,400
for the related affair we can do reverse

897
00:35:56,400 --> 00:35:58,960
engineering or authentication process

898
00:35:58,960 --> 00:35:59,680
and the

899
00:35:59,680 --> 00:36:02,480
head unit pairing process to further

900
00:36:02,480 --> 00:36:05,680
potential vulnerabilities

901
00:36:05,760 --> 00:36:08,240
we can't request this urls we found

902
00:36:08,240 --> 00:36:08,800
before

903
00:36:08,800 --> 00:36:12,079
since the uh tsp using

904
00:36:12,079 --> 00:36:15,119
mewtwo https

905
00:36:15,119 --> 00:36:18,079
so we need a client certificate the

906
00:36:18,079 --> 00:36:20,560
certificate management level reloads the

907
00:36:20,560 --> 00:36:21,760
certificates

908
00:36:21,760 --> 00:36:23,920
the infrastructure process application

909
00:36:23,920 --> 00:36:26,160
will request the backend

910
00:36:26,160 --> 00:36:28,720
we found some key pairs and loot

911
00:36:28,720 --> 00:36:29,839
certificates

912
00:36:29,839 --> 00:36:33,200
and we found some pfx fair which is

913
00:36:33,200 --> 00:36:34,160
encrypted

914
00:36:34,160 --> 00:36:36,640
we need password for the pfx for us to

915
00:36:36,640 --> 00:36:37,280
get

916
00:36:37,280 --> 00:36:40,640
clan certificates we'll analyze this

917
00:36:40,640 --> 00:36:43,040
library and we find the comments we'll

918
00:36:43,040 --> 00:36:44,240
load the f

919
00:36:44,240 --> 00:36:46,880
a p f x and the password field the array

920
00:36:46,880 --> 00:36:48,000
system booting

921
00:36:48,000 --> 00:36:51,119
the application load the certificate

922
00:36:51,119 --> 00:36:54,079
according to the market area within

923
00:36:54,079 --> 00:36:54,960
three types of

924
00:36:54,960 --> 00:36:59,040
certificates this library can decrypt

925
00:36:59,040 --> 00:37:03,040
the password field it's using the as256

926
00:37:03,040 --> 00:37:04,800
cbc algorithm

927
00:37:04,800 --> 00:37:08,079
the asiv and the key are coded

928
00:37:08,079 --> 00:37:12,240
in the effect so we decrypted

929
00:37:12,240 --> 00:37:15,520
it with open ssl and got a pfx

930
00:37:15,520 --> 00:37:18,320
password finally we loaded to the

931
00:37:18,320 --> 00:37:19,119
browser

932
00:37:19,119 --> 00:37:22,400
you can see that they are available

933
00:37:22,400 --> 00:37:26,240
the certificate 00601

934
00:37:26,240 --> 00:37:29,440
is for china market

935
00:37:29,440 --> 00:37:32,560
and we found a social media plugin from

936
00:37:32,560 --> 00:37:33,680
the head unit

937
00:37:33,680 --> 00:37:36,800
when you open it firsthand it shows

938
00:37:36,800 --> 00:37:40,880
a qr code and pull back and repeatedly

939
00:37:40,880 --> 00:37:42,640
then you can use your application to

940
00:37:42,640 --> 00:37:45,119
scan the sql code and the head unit will

941
00:37:45,119 --> 00:37:46,160
receive a token

942
00:37:46,160 --> 00:37:48,240
then it will request the social media

943
00:37:48,240 --> 00:37:51,040
application to get user data

944
00:37:51,040 --> 00:37:54,800
then send this user a waiter url to the

945
00:37:54,800 --> 00:37:55,760
backend

946
00:37:55,760 --> 00:37:57,839
because the backend doesn't know whether

947
00:37:57,839 --> 00:37:59,359
the winner

948
00:37:59,359 --> 00:38:02,880
url is credible so we can use this one

949
00:38:02,880 --> 00:38:05,200
ability to read

950
00:38:05,200 --> 00:38:08,160
servers local files or request the

951
00:38:08,160 --> 00:38:09,040
internet

952
00:38:09,040 --> 00:38:12,560
servers the tsp communicates

953
00:38:12,560 --> 00:38:14,560
with commerce by using the daimlers

954
00:38:14,560 --> 00:38:15,920
their own political

955
00:38:15,920 --> 00:38:18,640
this supports the safety channel also it

956
00:38:18,640 --> 00:38:20,800
supports the sms channel where the

957
00:38:20,800 --> 00:38:23,680
network is terrible when the car starts

958
00:38:23,680 --> 00:38:25,200
the hermes wakes up

959
00:38:25,200 --> 00:38:27,440
and it sends a request to the back end

960
00:38:27,440 --> 00:38:28,560
in an encrypted

961
00:38:28,560 --> 00:38:30,880
channel with local shared key the shared

962
00:38:30,880 --> 00:38:32,400
key are different among

963
00:38:32,400 --> 00:38:35,760
vehicle the shared key

964
00:38:35,760 --> 00:38:39,040
are dynamic and changed in time

965
00:38:39,040 --> 00:38:41,440
the harvest exchange and send a new key

966
00:38:41,440 --> 00:38:42,800
to the tsp

967
00:38:42,800 --> 00:38:45,359
securities channel where car owners in

968
00:38:45,359 --> 00:38:46,400
the unlocked

969
00:38:46,400 --> 00:38:48,640
command from the master cme application

970
00:38:48,640 --> 00:38:49,680
it requests

971
00:38:49,680 --> 00:38:52,720
it to request the back-end

972
00:38:52,720 --> 00:38:55,440
car control api if the harvest is used

973
00:38:55,440 --> 00:38:56,240
deep state

974
00:38:56,240 --> 00:39:00,079
the backhand sender sms for

975
00:39:00,079 --> 00:39:02,640
waking up then the backhand establish

976
00:39:02,640 --> 00:39:04,720
communication with hermes

977
00:39:04,720 --> 00:39:06,560
when harvest receives a car country

978
00:39:06,560 --> 00:39:08,560
command it checks the car state

979
00:39:08,560 --> 00:39:11,920
and decides whether to execute then it

980
00:39:11,920 --> 00:39:12,320
sends

981
00:39:12,320 --> 00:39:14,400
the results to backup that is the full

982
00:39:14,400 --> 00:39:17,359
process of the car control data stream

983
00:39:17,359 --> 00:39:19,520
for authentication and communication

984
00:39:19,520 --> 00:39:20,640
attacking 4g

985
00:39:20,640 --> 00:39:23,920
is not a good idea so we try to research

986
00:39:23,920 --> 00:39:25,040
the assembler channel

987
00:39:25,040 --> 00:39:28,640
we disable the hermas cellularly network

988
00:39:28,640 --> 00:39:31,359
then change the platform number to our

989
00:39:31,359 --> 00:39:31,760
own

990
00:39:31,760 --> 00:39:35,599
phone number we can communicate

991
00:39:35,599 --> 00:39:38,640
with hermes with our own phone

992
00:39:38,640 --> 00:39:42,000
there are basic 65

993
00:39:42,000 --> 00:39:46,480
or 64 or 64 encoded atp data

994
00:39:46,480 --> 00:39:49,280
the strategy is followed it is secured

995
00:39:49,280 --> 00:39:50,400
due to

996
00:39:50,400 --> 00:39:55,839
the sha-256 hmac and as256 encrypted

997
00:39:55,839 --> 00:39:56,880
every message

998
00:39:56,880 --> 00:39:59,920
user can't even if it doesn't use

999
00:39:59,920 --> 00:40:04,240
the encrypted data we were not able to

1000
00:40:04,240 --> 00:40:08,400
temper data only play it to commerce

1001
00:40:08,400 --> 00:40:10,400
it seems that the magnet is perfect but

1002
00:40:10,400 --> 00:40:12,560
we still found a point that we can

1003
00:40:12,560 --> 00:40:16,400
exploit the backhand intra internal

1004
00:40:16,400 --> 00:40:19,280
service has no authentication mechanism

1005
00:40:19,280 --> 00:40:19,680
they

1006
00:40:19,680 --> 00:40:21,839
they are fully trusting the servers in

1007
00:40:21,839 --> 00:40:23,200
the internet

1008
00:40:23,200 --> 00:40:25,920
if we can get access to the internet

1009
00:40:25,920 --> 00:40:27,119
behind the back end

1010
00:40:27,119 --> 00:40:29,440
we can invoke almost all the servers in

1011
00:40:29,440 --> 00:40:32,160
the backend

1012
00:40:32,800 --> 00:40:35,920
after long term analysis we discovered

1013
00:40:35,920 --> 00:40:38,079
the summary abilities in the back end

1014
00:40:38,079 --> 00:40:41,440
and we find the most important service

1015
00:40:41,440 --> 00:40:44,079
remote servers it can open the door

1016
00:40:44,079 --> 00:40:46,319
start engine of the roof

1017
00:40:46,319 --> 00:40:49,680
stored across the roof but

1018
00:40:49,680 --> 00:40:52,640
the engineering survey is limited

1019
00:40:52,640 --> 00:40:53,520
because it

1020
00:40:53,520 --> 00:40:56,880
is a value-added server that you

1021
00:40:56,880 --> 00:40:59,920
need to pay about 450

1022
00:40:59,920 --> 00:41:03,760
bucks every year besides it has sata

1023
00:41:03,760 --> 00:41:08,520
electric fields this service is based on

1024
00:41:08,520 --> 00:41:11,839
fbs4 when you want to start entering the

1025
00:41:11,839 --> 00:41:13,359
back-end send the request

1026
00:41:13,359 --> 00:41:16,880
ask hermes for challenging code

1027
00:41:16,880 --> 00:41:20,800
and and then the backhand asks her damn

1028
00:41:20,800 --> 00:41:24,560
internal service to calculate fbs

1029
00:41:24,560 --> 00:41:27,440
token the algorithm is installed behind

1030
00:41:27,440 --> 00:41:28,560
the bracket

1031
00:41:28,560 --> 00:41:31,839
we don't know the detail about algorithm

1032
00:41:31,839 --> 00:41:33,839
by the way not all the customers for

1033
00:41:33,839 --> 00:41:34,880
this server

1034
00:41:34,880 --> 00:41:37,280
and it depends on whether the demo

1035
00:41:37,280 --> 00:41:38,079
database

1036
00:41:38,079 --> 00:41:41,440
store with the fbs4 data of

1037
00:41:41,440 --> 00:41:45,119
your car currently we

1038
00:41:45,119 --> 00:41:47,920
only we can only start engine

1039
00:41:47,920 --> 00:41:49,680
successfully in class a

1040
00:41:49,680 --> 00:41:53,040
and class e okay

1041
00:41:53,040 --> 00:41:56,640
let's summary our research

1042
00:41:56,640 --> 00:41:58,720
we followed the responsible cloud

1043
00:41:58,720 --> 00:42:00,480
disclosure policy

1044
00:42:00,480 --> 00:42:03,359
and when we found this dos those

1045
00:42:03,359 --> 00:42:04,480
vulnerability and

1046
00:42:04,480 --> 00:42:08,160
we can achieve our control

1047
00:42:08,160 --> 00:42:10,880
target we reported our funding to the

1048
00:42:10,880 --> 00:42:13,119
mission expanded security team first

1049
00:42:13,119 --> 00:42:16,560
time in our research we found about 19

1050
00:42:16,560 --> 00:42:19,040
vulnerabilities invested expenses car

1051
00:42:19,040 --> 00:42:21,040
and compared them to our

1052
00:42:21,040 --> 00:42:23,920
tech chain to remotely control the car

1053
00:42:23,920 --> 00:42:24,560
the key

1054
00:42:24,560 --> 00:42:27,119
impact is that we can send the remote

1055
00:42:27,119 --> 00:42:28,319
service command

1056
00:42:28,319 --> 00:42:31,359
to the car but we didn't go too far

1057
00:42:31,359 --> 00:42:34,319
even will give him more access to more

1058
00:42:34,319 --> 00:42:36,079
important servers

1059
00:42:36,079 --> 00:42:38,160
and yes we did see many security

1060
00:42:38,160 --> 00:42:39,599
considerations

1061
00:42:39,599 --> 00:42:43,119
in the architecture of the vehicle we

1062
00:42:43,119 --> 00:42:46,160
spent so much time to bypass

1063
00:42:46,160 --> 00:42:48,880
this security mechanism regarding to the

1064
00:42:48,880 --> 00:42:50,400
vulnerabilities

1065
00:42:50,400 --> 00:42:53,359
all access vulnerabilities were fixed

1066
00:42:53,359 --> 00:42:54,480
together

1067
00:42:54,480 --> 00:42:56,560
the rest of the water bills are being

1068
00:42:56,560 --> 00:42:58,400
fixed by mr spence

1069
00:42:58,400 --> 00:43:02,079
security team and their vendors

1070
00:43:02,079 --> 00:43:05,599
okay the guy will take over from here to

1071
00:43:05,599 --> 00:43:07,280
introduce their instance

1072
00:43:07,280 --> 00:43:11,200
response thank you

1073
00:43:11,280 --> 00:43:13,760
thank you very much and thank me rui and

1074
00:43:13,760 --> 00:43:15,440
all of the amazing team

1075
00:43:15,440 --> 00:43:19,920
at 360 for providing us more details

1076
00:43:19,920 --> 00:43:22,079
now we were able to see fleet stack ops

1077
00:43:22,079 --> 00:43:23,040
in action

1078
00:43:23,040 --> 00:43:24,720
and why do i say it's fleet setups in

1079
00:43:24,720 --> 00:43:26,880
action because once we got from 360

1080
00:43:26,880 --> 00:43:27,200
group

1081
00:43:27,200 --> 00:43:28,960
the responsible disclosure through our

1082
00:43:28,960 --> 00:43:30,400
website for our email

1083
00:43:30,400 --> 00:43:33,280
our email box then we were able to kick

1084
00:43:33,280 --> 00:43:33,920
in

1085
00:43:33,920 --> 00:43:35,760
all of the incident response procedure

1086
00:43:35,760 --> 00:43:39,520
to treat this as an actual incident

1087
00:43:39,520 --> 00:43:42,079
following standard steps first we

1088
00:43:42,079 --> 00:43:42,800
initiate

1089
00:43:42,800 --> 00:43:45,440
the incident response teams so this is

1090
00:43:45,440 --> 00:43:47,040
mobilizing teams

1091
00:43:47,040 --> 00:43:49,520
professionals and operationals in order

1092
00:43:49,520 --> 00:43:50,319
to do

1093
00:43:50,319 --> 00:43:52,480
the investigation understand where we

1094
00:43:52,480 --> 00:43:54,960
stand engage in direct communication

1095
00:43:54,960 --> 00:43:56,079
with the researchers

1096
00:43:56,079 --> 00:43:59,599
from 360 analyze and prioritize what are

1097
00:43:59,599 --> 00:44:00,560
our steps

1098
00:44:00,560 --> 00:44:02,640
with the goal that within 48 hours we

1099
00:44:02,640 --> 00:44:04,400
are able to fix all the immediate

1100
00:44:04,400 --> 00:44:06,160
vulnerabilities just making sure

1101
00:44:06,160 --> 00:44:07,440
that there can't they can't be a

1102
00:44:07,440 --> 00:44:09,440
potential customer impact

1103
00:44:09,440 --> 00:44:12,400
with these vulnerabilities after

1104
00:44:12,400 --> 00:44:14,720
performing the investigation

1105
00:44:14,720 --> 00:44:17,599
we start working on selective blocking

1106
00:44:17,599 --> 00:44:17,920
of

1107
00:44:17,920 --> 00:44:21,119
servers ports maybe even services that

1108
00:44:21,119 --> 00:44:21,680
will

1109
00:44:21,680 --> 00:44:24,319
on one hand make sure that no hole

1110
00:44:24,319 --> 00:44:26,319
remains open it can be exploited

1111
00:44:26,319 --> 00:44:28,880
and on the second end we have minimal to

1112
00:44:28,880 --> 00:44:29,359
no

1113
00:44:29,359 --> 00:44:32,079
customer impact so we're able within 48

1114
00:44:32,079 --> 00:44:32,640
hours

1115
00:44:32,640 --> 00:44:34,319
to contain and make sure that those

1116
00:44:34,319 --> 00:44:36,400
vulnerabilities can be exploited

1117
00:44:36,400 --> 00:44:39,520
and start working on immediate fixes

1118
00:44:39,520 --> 00:44:40,960
so you can bring the services back

1119
00:44:40,960 --> 00:44:43,119
online then we have in parallel the

1120
00:44:43,119 --> 00:44:45,119
forensic teams forensics teams looking

1121
00:44:45,119 --> 00:44:48,079
at all the data of the recorded data

1122
00:44:48,079 --> 00:44:51,200
just to find that there's no evidence of

1123
00:44:51,200 --> 00:44:54,079
other attackers not the beyond the the

1124
00:44:54,079 --> 00:44:55,599
partners from 360

1125
00:44:55,599 --> 00:44:57,920
that were able to use and me and exploit

1126
00:44:57,920 --> 00:45:00,240
the same vulnerabilities in the past

1127
00:45:00,240 --> 00:45:02,480
so to make sure that we find no evidence

1128
00:45:02,480 --> 00:45:03,599
of a potential

1129
00:45:03,599 --> 00:45:06,640
real-life breach and develop the

1130
00:45:06,640 --> 00:45:08,560
long-term fixes

1131
00:45:08,560 --> 00:45:10,319
long-term fixes that can be fixed to the

1132
00:45:10,319 --> 00:45:12,480
car so within a few days we were able to

1133
00:45:12,480 --> 00:45:14,800
bring all the services back online while

1134
00:45:14,800 --> 00:45:15,520
we are

1135
00:45:15,520 --> 00:45:17,520
we remain completely confident that the

1136
00:45:17,520 --> 00:45:19,520
same vulnerabilities can be fixed

1137
00:45:19,520 --> 00:45:21,440
and thanks to the partners of 360 were

1138
00:45:21,440 --> 00:45:22,640
able to do that with direct

1139
00:45:22,640 --> 00:45:23,680
communication

1140
00:45:23,680 --> 00:45:26,640
with the researchers then we have like

1141
00:45:26,640 --> 00:45:28,000
any operational activity

1142
00:45:28,000 --> 00:45:29,839
the lessons learned phase what's

1143
00:45:29,839 --> 00:45:31,920
interesting here is that we're not only

1144
00:45:31,920 --> 00:45:33,119
talking about

1145
00:45:33,119 --> 00:45:35,200
technical lessons learned of the

1146
00:45:35,200 --> 00:45:37,599
vulnerabilities themselves

1147
00:45:37,599 --> 00:45:40,319
we look at all of the phases that allow

1148
00:45:40,319 --> 00:45:41,520
the researchers

1149
00:45:41,520 --> 00:45:43,920
to reach their goal to make sure that we

1150
00:45:43,920 --> 00:45:45,599
put hardenings hardening

1151
00:45:45,599 --> 00:45:48,000
measures in place so it will be even

1152
00:45:48,000 --> 00:45:48,640
harder

1153
00:45:48,640 --> 00:45:50,319
for a researcher or an attacker in the

1154
00:45:50,319 --> 00:45:52,400
future to try and walk

1155
00:45:52,400 --> 00:45:55,280
similar path even if not the same one of

1156
00:45:55,280 --> 00:45:56,640
course the vulnerability

1157
00:45:56,640 --> 00:45:59,920
themselves can't be fixed and like every

1158
00:45:59,920 --> 00:46:01,680
operational activity

1159
00:46:01,680 --> 00:46:03,839
we look at how we how we behaved we look

1160
00:46:03,839 --> 00:46:05,280
at how we responded

1161
00:46:05,280 --> 00:46:07,920
so we can provide better security next

1162
00:46:07,920 --> 00:46:08,400
time

1163
00:46:08,400 --> 00:46:10,880
something happens and we are proud to

1164
00:46:10,880 --> 00:46:11,599
say that

1165
00:46:11,599 --> 00:46:15,200
that we were managed we managed to

1166
00:46:15,200 --> 00:46:18,640
work with our kpis

1167
00:46:19,520 --> 00:46:22,560
i have two messages key messages with

1168
00:46:22,560 --> 00:46:24,240
giving this presentation here

1169
00:46:24,240 --> 00:46:27,920
to this great community of black hat

1170
00:46:27,920 --> 00:46:28,880
first message

1171
00:46:28,880 --> 00:46:30,720
is of course security operations or

1172
00:46:30,720 --> 00:46:32,560
fleet security operations

1173
00:46:32,560 --> 00:46:34,960
not only securing a car but securing the

1174
00:46:34,960 --> 00:46:37,119
fleet i guess it will be true for any

1175
00:46:37,119 --> 00:46:38,319
iot system

1176
00:46:38,319 --> 00:46:41,839
it's more true for cars

1177
00:46:41,839 --> 00:46:44,560
is the work with the community we have

1178
00:46:44,560 --> 00:46:46,560
here an example how a strong research

1179
00:46:46,560 --> 00:46:47,280
community

1180
00:46:47,280 --> 00:46:49,839
working with a strong industry can bring

1181
00:46:49,839 --> 00:46:51,359
better security

1182
00:46:51,359 --> 00:46:53,520
and this is a concrete example of our

1183
00:46:53,520 --> 00:46:55,040
strong security research

1184
00:46:55,040 --> 00:46:57,119
research group working with a car

1185
00:46:57,119 --> 00:46:58,960
company capable of responding and

1186
00:46:58,960 --> 00:47:00,560
engaging in communication

1187
00:47:00,560 --> 00:47:02,720
is providing better security for the

1188
00:47:02,720 --> 00:47:05,279
customers

1189
00:47:05,599 --> 00:47:07,359
thank you for coming to this session i

1190
00:47:07,359 --> 00:47:08,800
hope you enjoyed it

1191
00:47:08,800 --> 00:47:10,800
as i said in the beginning i hope that

1192
00:47:10,800 --> 00:47:12,480
we'll be able to meet face to face

1193
00:47:12,480 --> 00:47:15,760
in a more normal kind of black hats

1194
00:47:15,760 --> 00:47:17,920
maybe next year and please enjoy the

1195
00:47:17,920 --> 00:47:19,200
rest of your sessions

1196
00:47:19,200 --> 00:47:25,200
and keep healthy thank you very much

1197
00:47:25,200 --> 00:47:27,040
hello everyone thank you for taking the

1198
00:47:27,040 --> 00:47:28,400
time to join the session

1199
00:47:28,400 --> 00:47:31,520
we were very keen on sharing uh as much

1200
00:47:31,520 --> 00:47:33,119
information as possible

1201
00:47:33,119 --> 00:47:36,480
beyond what was shared on our stay

1202
00:47:36,480 --> 00:47:38,319
and i want to thank the partners from

1203
00:47:38,319 --> 00:47:40,240
360 for joining this

1204
00:47:40,240 --> 00:47:42,000
uh we don't have much time for this live

1205
00:47:42,000 --> 00:47:43,920
session so i will upload the

1206
00:47:43,920 --> 00:47:47,040
thanks to min roy to say thank you

1207
00:47:47,040 --> 00:47:50,400
goodbye thank you everyone thank you

1208
00:47:50,400 --> 00:47:53,440
for listening our talk

1209
00:47:53,440 --> 00:47:56,640
and the way my team is

1210
00:47:56,640 --> 00:47:59,599
doing the research on a connected car

1211
00:47:59,599 --> 00:48:00,480
server yes

1212
00:48:00,480 --> 00:48:04,400
and mr spence is a very

1213
00:48:04,400 --> 00:48:07,920
good company and they are very care

1214
00:48:07,920 --> 00:48:08,880
about

1215
00:48:08,880 --> 00:48:12,559
security and they are very friendly to

1216
00:48:12,559 --> 00:48:14,400
the security community

1217
00:48:14,400 --> 00:48:19,520
thank you everyone

