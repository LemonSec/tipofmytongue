1
00:00:03,720 --> 00:00:13,530
[Music]

2
00:00:17,760 --> 00:00:18,080
hi

3
00:00:18,080 --> 00:00:20,000
everyone and welcome to my talk about

4
00:00:20,000 --> 00:00:21,359
the impact attack

5
00:00:21,359 --> 00:00:24,320
before we start let me introduce myself

6
00:00:24,320 --> 00:00:26,560
i'm david ruprecht phd student at the

7
00:00:26,560 --> 00:00:28,640
wonderful rural university bowhom

8
00:00:28,640 --> 00:00:30,800
and my aim is it to secure mobile

9
00:00:30,800 --> 00:00:33,279
networks

10
00:00:33,280 --> 00:00:37,600
by finding flaws and fixing them

11
00:00:37,600 --> 00:00:39,680
before we start with the talk let me

12
00:00:39,680 --> 00:00:40,960
motivate this topic

13
00:00:40,960 --> 00:00:43,440
and i know everyone knows lte is

14
00:00:43,440 --> 00:00:44,399
everywhere

15
00:00:44,399 --> 00:00:47,760
so we use it to stream music even some

16
00:00:47,760 --> 00:00:50,800
serious and buy things on amazon

17
00:00:50,800 --> 00:00:53,520
but also our first responders use it in

18
00:00:53,520 --> 00:00:56,079
case of emergencies

19
00:00:56,079 --> 00:00:59,440
and there is a second a third use case

20
00:00:59,440 --> 00:01:01,840
the industrial use case where iot

21
00:01:01,840 --> 00:01:02,800
devices

22
00:01:02,800 --> 00:01:05,519
or factories are connected via lte to

23
00:01:05,519 --> 00:01:07,280
control units

24
00:01:07,280 --> 00:01:10,159
this and the fact that lte is the

25
00:01:10,159 --> 00:01:13,200
foundation for our future 5g networks

26
00:01:13,200 --> 00:01:15,439
makes it important to look into the

27
00:01:15,439 --> 00:01:16,799
security measures

28
00:01:16,799 --> 00:01:19,680
of 5g

29
00:01:20,799 --> 00:01:24,560
so i will talk today

30
00:01:24,560 --> 00:01:26,720
introduce you to the impact attack

31
00:01:26,720 --> 00:01:28,799
impact stands for impersonation

32
00:01:28,799 --> 00:01:31,840
attacks in 4g networks and when we talk

33
00:01:31,840 --> 00:01:32,320
about

34
00:01:32,320 --> 00:01:34,560
impersonation we need a common common

35
00:01:34,560 --> 00:01:35,600
definition of

36
00:01:35,600 --> 00:01:39,040
impersonation by impersonation i mean

37
00:01:39,040 --> 00:01:41,439
that an attacker is able to act as you

38
00:01:41,439 --> 00:01:42,880
towards the network

39
00:01:42,880 --> 00:01:45,840
he can send arbitrary ip messages or

40
00:01:45,840 --> 00:01:46,640
packets

41
00:01:46,640 --> 00:01:48,640
towards the network and even through the

42
00:01:48,640 --> 00:01:51,920
internet with your identity

43
00:01:51,920 --> 00:01:54,159
for the aim of this talk is to

44
00:01:54,159 --> 00:01:57,040
understand the impact attack

45
00:01:57,040 --> 00:01:59,439
the attack vectors that are exploited

46
00:01:59,439 --> 00:02:00,960
and what implications

47
00:02:00,960 --> 00:02:04,079
of this attacks exist

48
00:02:04,079 --> 00:02:06,560
before we get there we need to pass the

49
00:02:06,560 --> 00:02:07,759
basic agenda

50
00:02:07,759 --> 00:02:09,598
first of all i would like to introduce

51
00:02:09,598 --> 00:02:13,120
you to some lte background information

52
00:02:13,120 --> 00:02:16,000
then we would like to or i would like to

53
00:02:16,000 --> 00:02:17,920
show you the alter attack

54
00:02:17,920 --> 00:02:20,080
the ultra attack uses the same attack

55
00:02:20,080 --> 00:02:22,319
vector as the impact attack

56
00:02:22,319 --> 00:02:24,959
but is more easy to understand than

57
00:02:24,959 --> 00:02:27,120
defect attack

58
00:02:27,120 --> 00:02:30,080
third we will look into the impact

59
00:02:30,080 --> 00:02:31,280
attack

60
00:02:31,280 --> 00:02:33,440
we will dare understand what attack

61
00:02:33,440 --> 00:02:35,200
vectors are used

62
00:02:35,200 --> 00:02:38,800
and how the attack works

63
00:02:38,800 --> 00:02:40,959
we will further discuss the implications

64
00:02:40,959 --> 00:02:42,800
implications of these attacks

65
00:02:42,800 --> 00:02:46,000
and in particular see if 5g is secure

66
00:02:46,000 --> 00:02:46,560
against

67
00:02:46,560 --> 00:02:49,680
these attacks so we will start with the

68
00:02:49,680 --> 00:02:52,400
lte background information

69
00:02:52,400 --> 00:02:55,840
so as always we have a small lte

70
00:02:55,840 --> 00:02:58,879
network um architecture so we got the

71
00:02:58,879 --> 00:03:00,239
phone on the left side

72
00:03:00,239 --> 00:03:02,560
this phone is connected towards the

73
00:03:02,560 --> 00:03:05,200
closest space station

74
00:03:05,200 --> 00:03:07,519
and this phone is connected to what's

75
00:03:07,519 --> 00:03:09,280
the closest space station also called

76
00:03:09,280 --> 00:03:10,400
e-node b

77
00:03:10,400 --> 00:03:13,760
and the not-b or the lte network itself

78
00:03:13,760 --> 00:03:16,959
has many entities they are not important

79
00:03:16,959 --> 00:03:18,239
for us today

80
00:03:18,239 --> 00:03:21,040
it is important is that um the ip

81
00:03:21,040 --> 00:03:23,360
network provided towards the phone

82
00:03:23,360 --> 00:03:26,640
is separated via firewall to from the

83
00:03:26,640 --> 00:03:28,720
rest of the internet

84
00:03:28,720 --> 00:03:32,799
firewall or not so any incoming

85
00:03:32,799 --> 00:03:35,360
ip connection does not cannot pass

86
00:03:35,360 --> 00:03:35,920
through

87
00:03:35,920 --> 00:03:38,399
the phone

88
00:03:39,680 --> 00:03:42,640
so when we talk about lte or 4g security

89
00:03:42,640 --> 00:03:45,760
we definitely need to talk about

90
00:03:45,760 --> 00:03:48,879
about the security aims the first

91
00:03:48,879 --> 00:03:50,959
and very important security aim is

92
00:03:50,959 --> 00:03:52,640
mutual authentication

93
00:03:52,640 --> 00:03:55,280
mutual authentication ensures that you

94
00:03:55,280 --> 00:03:57,439
are talking to the correct provider

95
00:03:57,439 --> 00:03:59,599
and the provider knows that you're the

96
00:03:59,599 --> 00:04:01,360
correct person

97
00:04:01,360 --> 00:04:04,640
as some of you might know 2g does not

98
00:04:04,640 --> 00:04:07,120
provide any network authentication

99
00:04:07,120 --> 00:04:10,720
and this is why still so many

100
00:04:10,720 --> 00:04:14,560
two 2g attacks are possible and

101
00:04:14,560 --> 00:04:19,040
or mccarthy attacks the second

102
00:04:19,040 --> 00:04:20,720
important security aim is traffic

103
00:04:20,720 --> 00:04:22,560
confidentiality

104
00:04:22,560 --> 00:04:25,680
traffic confidentiality ensures that an

105
00:04:25,680 --> 00:04:27,759
passive attacker is not able

106
00:04:27,759 --> 00:04:30,560
to eavesdrop your phone calls but also

107
00:04:30,560 --> 00:04:32,160
even your internet connection

108
00:04:32,160 --> 00:04:36,080
here i'm not talking about https or tls

109
00:04:36,080 --> 00:04:38,160
i'm talking about the radio connection

110
00:04:38,160 --> 00:04:41,919
between your phone and the base station

111
00:04:41,919 --> 00:04:42,560
the third

112
00:04:42,560 --> 00:04:45,759
most or unique

113
00:04:45,759 --> 00:04:48,960
security aim for mobile networks

114
00:04:48,960 --> 00:04:52,080
is identity and location confidentiality

115
00:04:52,080 --> 00:04:54,800
an attacker should not be able to know

116
00:04:54,800 --> 00:04:55,520
who you are

117
00:04:55,520 --> 00:04:58,639
just being close to you and also the

118
00:04:58,639 --> 00:05:00,240
attacker should not know

119
00:05:00,240 --> 00:05:02,000
where you are when he only knows your

120
00:05:02,000 --> 00:05:04,160
phone number

121
00:05:04,160 --> 00:05:07,280
so today we are going

122
00:05:07,280 --> 00:05:09,600
mainly or we are going to break the

123
00:05:09,600 --> 00:05:11,360
mutual authentication aim

124
00:05:11,360 --> 00:05:16,160
on the user data because impersonation

125
00:05:16,160 --> 00:05:20,320
contradicts mutual authentication

126
00:05:20,800 --> 00:05:25,280
so how are the security aims

127
00:05:25,280 --> 00:05:27,360
basically fulfilled therefore lte has

128
00:05:27,360 --> 00:05:29,280
some security features

129
00:05:29,280 --> 00:05:32,080
and the main part of the security

130
00:05:32,080 --> 00:05:33,120
features

131
00:05:33,120 --> 00:05:36,240
are based on a shared secret in your sim

132
00:05:36,240 --> 00:05:36,800
card

133
00:05:36,800 --> 00:05:38,800
and in the provider's home network in a

134
00:05:38,800 --> 00:05:40,720
secure location

135
00:05:40,720 --> 00:05:43,199
based on this secret key and at the

136
00:05:43,199 --> 00:05:45,840
beginning of each connection

137
00:05:45,840 --> 00:05:49,199
handshake with or mutual authentication

138
00:05:49,199 --> 00:05:50,479
is established

139
00:05:50,479 --> 00:05:52,160
based on an authentication and key

140
00:05:52,160 --> 00:05:53,919
agreement protocol

141
00:05:53,919 --> 00:05:57,680
this key agreement protocol is secure

142
00:05:57,680 --> 00:06:00,960
with mathematics proofs and

143
00:06:00,960 --> 00:06:03,840
this aka also derives some keys which

144
00:06:03,840 --> 00:06:04,319
are

145
00:06:04,319 --> 00:06:07,520
used for secure the further connection

146
00:06:07,520 --> 00:06:10,479
for your internet traffic and even some

147
00:06:10,479 --> 00:06:12,560
control traffic

148
00:06:12,560 --> 00:06:14,400
today we are going to look into the

149
00:06:14,400 --> 00:06:16,000
security measures

150
00:06:16,000 --> 00:06:18,840
and which are taken during the

151
00:06:18,840 --> 00:06:20,160
connection

152
00:06:20,160 --> 00:06:23,280
and how they are protected

153
00:06:23,280 --> 00:06:25,280
before we do this we need to distinguish

154
00:06:25,280 --> 00:06:26,560
between two kind of

155
00:06:26,560 --> 00:06:29,600
traffics first of all we have control

156
00:06:29,600 --> 00:06:32,560
lte specific control traffic this

157
00:06:32,560 --> 00:06:34,479
control traffic is

158
00:06:34,479 --> 00:06:36,560
generated when you for example hand over

159
00:06:36,560 --> 00:06:39,840
from one cell to another cell

160
00:06:39,840 --> 00:06:42,240
this control traffic is encrypted with a

161
00:06:42,240 --> 00:06:43,120
stream cipher

162
00:06:43,120 --> 00:06:46,800
in and integrity protected further

163
00:06:46,800 --> 00:06:49,599
we have user plan traffic this user plan

164
00:06:49,599 --> 00:06:50,400
traffic

165
00:06:50,400 --> 00:06:53,599
is generated by your app or your your or

166
00:06:53,599 --> 00:06:55,039
your web browser when you visit a

167
00:06:55,039 --> 00:06:55,759
website

168
00:06:55,759 --> 00:06:58,800
it's only um ip

169
00:06:58,800 --> 00:07:01,840
traffic um and this ip traffic is

170
00:07:01,840 --> 00:07:02,960
encrypted

171
00:07:02,960 --> 00:07:05,919
using a stream cipher however this is

172
00:07:05,919 --> 00:07:07,680
not integrity protected

173
00:07:07,680 --> 00:07:10,800
like the control plane

174
00:07:10,960 --> 00:07:14,080
as i said earlier we use a stream cipher

175
00:07:14,080 --> 00:07:14,960
to encrypt

176
00:07:14,960 --> 00:07:18,799
packets and

177
00:07:20,080 --> 00:07:23,199
so how does a stream cipher work so we

178
00:07:23,199 --> 00:07:24,400
have a plain text

179
00:07:24,400 --> 00:07:26,880
which is only four bit long and these

180
00:07:26,880 --> 00:07:28,319
four bits

181
00:07:28,319 --> 00:07:31,120
are xor with the key stream for example

182
00:07:31,120 --> 00:07:33,759
a is in counter mode

183
00:07:33,759 --> 00:07:36,479
this xor results in a cipher text this

184
00:07:36,479 --> 00:07:37,840
cipher text is then

185
00:07:37,840 --> 00:07:40,000
sent over the air towards the base

186
00:07:40,000 --> 00:07:41,599
station

187
00:07:41,599 --> 00:07:43,919
the decryption is quite similar to the

188
00:07:43,919 --> 00:07:46,000
encryption so the base station receives

189
00:07:46,000 --> 00:07:47,440
the cipher text

190
00:07:47,440 --> 00:07:49,919
xor the key stream generated with the

191
00:07:49,919 --> 00:07:52,160
same input parameters for is encounter

192
00:07:52,160 --> 00:07:53,199
mode

193
00:07:53,199 --> 00:07:56,560
and this will result in the plain text

194
00:07:56,560 --> 00:08:00,000
so we already done we are already done

195
00:08:00,000 --> 00:08:02,160
with the lte background information

196
00:08:02,160 --> 00:08:05,199
let's start with the auto attack

197
00:08:05,199 --> 00:08:07,680
the aim of the alter attack is to steal

198
00:08:07,680 --> 00:08:08,879
credentials

199
00:08:08,879 --> 00:08:11,680
for example when you visit a website you

200
00:08:11,680 --> 00:08:13,120
get redirected

201
00:08:13,120 --> 00:08:16,319
towards a malicious web page where

202
00:08:16,319 --> 00:08:18,879
login prompt is shown and you enter your

203
00:08:18,879 --> 00:08:19,840
credentials

204
00:08:19,840 --> 00:08:21,680
and the attacker is able to gain the

205
00:08:21,680 --> 00:08:24,000
information of this

206
00:08:24,000 --> 00:08:27,520
login you are not exactly connected to

207
00:08:27,520 --> 00:08:28,000
re

208
00:08:28,000 --> 00:08:30,240
to the real network you are connected to

209
00:08:30,240 --> 00:08:32,000
something which we will call

210
00:08:32,000 --> 00:08:35,279
lte relay or man in the middle attacker

211
00:08:35,279 --> 00:08:38,320
so what kind of attack vector

212
00:08:38,320 --> 00:08:41,360
does the attacker exploit the attacker

213
00:08:41,360 --> 00:08:42,799
exploits the missing integrity

214
00:08:42,799 --> 00:08:43,440
protection

215
00:08:43,440 --> 00:08:46,160
of the user plane data which i have

216
00:08:46,160 --> 00:08:48,399
shown you in the background

217
00:08:48,399 --> 00:08:51,839
so missing integrity protection

218
00:08:51,839 --> 00:08:54,959
you with um in the combination with the

219
00:08:54,959 --> 00:08:56,320
stream cipher

220
00:08:56,320 --> 00:08:58,720
leads to malleable encryption and

221
00:08:58,720 --> 00:09:00,320
malleable encryption

222
00:09:00,320 --> 00:09:03,920
is always a bad thing

223
00:09:03,920 --> 00:09:05,920
just assume we have an active man in the

224
00:09:05,920 --> 00:09:08,959
middle attacker in the position

225
00:09:08,959 --> 00:09:11,600
between the phone and the base station

226
00:09:11,600 --> 00:09:13,279
this man in the middle

227
00:09:13,279 --> 00:09:16,720
attacker can actively change the cipher

228
00:09:16,720 --> 00:09:18,720
text by flipping the third bit in this

229
00:09:18,720 --> 00:09:20,800
example

230
00:09:20,800 --> 00:09:22,959
the base station has no means and no

231
00:09:22,959 --> 00:09:25,519
measures to detect such bit flips

232
00:09:25,519 --> 00:09:28,399
xor is the same key stream as generated

233
00:09:28,399 --> 00:09:29,120
before

234
00:09:29,120 --> 00:09:32,000
which result that the same bit flip is

235
00:09:32,000 --> 00:09:34,880
contained in the plain text

236
00:09:34,880 --> 00:09:36,880
the question is can this be done

237
00:09:36,880 --> 00:09:38,080
deterministically

238
00:09:38,080 --> 00:09:41,600
yes it can be done under the assumption

239
00:09:41,600 --> 00:09:45,519
the attacker knows the plaintext

240
00:09:45,519 --> 00:09:48,320
so in this way the attacker can

241
00:09:48,320 --> 00:09:50,640
calculate a mask by xoring

242
00:09:50,640 --> 00:09:52,880
the wanted plain text here on the right

243
00:09:52,880 --> 00:09:53,920
side

244
00:09:53,920 --> 00:09:57,279
with a known plain text and the mask can

245
00:09:57,279 --> 00:09:58,160
be applied

246
00:09:58,160 --> 00:10:00,240
to each packet where the plain text is

247
00:10:00,240 --> 00:10:01,760
known to change it

248
00:10:01,760 --> 00:10:05,200
to the wanted plain text the question is

249
00:10:05,200 --> 00:10:06,160
now

250
00:10:06,160 --> 00:10:08,480
where do we get the plain text in

251
00:10:08,480 --> 00:10:12,399
particular in the context of lte

252
00:10:13,839 --> 00:10:16,240
so the answer to this question is quite

253
00:10:16,240 --> 00:10:18,720
simple we will use the dns server

254
00:10:18,720 --> 00:10:21,200
which is set by default during the first

255
00:10:21,200 --> 00:10:22,959
attach

256
00:10:22,959 --> 00:10:26,720
so each provider has a set on default

257
00:10:26,720 --> 00:10:27,920
dns servers

258
00:10:27,920 --> 00:10:31,600
which are known to us or the attacker

259
00:10:31,600 --> 00:10:35,200
and we use this ip address

260
00:10:35,200 --> 00:10:38,720
to to perform a redirection attack

261
00:10:38,720 --> 00:10:40,880
further it's important to note that dns

262
00:10:40,880 --> 00:10:41,839
packets

263
00:10:41,839 --> 00:10:45,200
are particular or good identifiable

264
00:10:45,200 --> 00:10:48,079
based on the length of the packet so

265
00:10:48,079 --> 00:10:50,079
there are good distinguishable between

266
00:10:50,079 --> 00:10:54,959
normal tcp traffic and tns requests

267
00:10:54,959 --> 00:10:58,880
knowing the default dns

268
00:10:58,880 --> 00:11:02,399
we got the non-plane text and

269
00:11:02,399 --> 00:11:05,839
we can basically redirect any dns

270
00:11:05,839 --> 00:11:06,560
request

271
00:11:06,560 --> 00:11:10,000
towards the malicious dns server

272
00:11:10,000 --> 00:11:13,200
so the aim of the ultra attack now is to

273
00:11:13,200 --> 00:11:14,480
redirect

274
00:11:14,480 --> 00:11:18,480
the an outgoing dns request

275
00:11:18,480 --> 00:11:20,320
with an active attacker which is in the

276
00:11:20,320 --> 00:11:21,920
man in the middle position between your

277
00:11:21,920 --> 00:11:22,560
phone

278
00:11:22,560 --> 00:11:26,000
and the network and to redirect this dns

279
00:11:26,000 --> 00:11:26,800
request

280
00:11:26,800 --> 00:11:31,040
towards the malicious dns server

281
00:11:32,800 --> 00:11:36,399
so the phone will connect

282
00:11:36,399 --> 00:11:38,880
to our man in the middle relay because

283
00:11:38,880 --> 00:11:40,640
this attack is quite similar

284
00:11:40,640 --> 00:11:43,120
to mccashin attack so the relay sends

285
00:11:43,120 --> 00:11:44,160
out

286
00:11:44,160 --> 00:11:47,600
the identifiers of the network then

287
00:11:47,600 --> 00:11:50,000
the network the commercial network and

288
00:11:50,000 --> 00:11:52,560
the phone will perform the aka

289
00:11:52,560 --> 00:11:54,560
this will happen and the relay will

290
00:11:54,560 --> 00:11:57,600
relay all those messages

291
00:11:57,600 --> 00:12:01,040
without any modification in this way

292
00:12:01,040 --> 00:12:03,200
the phone thinks he is connected to the

293
00:12:03,200 --> 00:12:04,720
correct network

294
00:12:04,720 --> 00:12:07,200
and the network thinks he is connected

295
00:12:07,200 --> 00:12:10,399
to the right customer and the

296
00:12:10,399 --> 00:12:13,120
relay further forwards all messages

297
00:12:13,120 --> 00:12:14,800
until

298
00:12:14,800 --> 00:12:20,319
a dns request is received by the relay

299
00:12:20,480 --> 00:12:23,040
when he received the dns request he will

300
00:12:23,040 --> 00:12:25,440
detect it based on the shorter length

301
00:12:25,440 --> 00:12:29,600
and will xor the mask he has calculated

302
00:12:29,600 --> 00:12:32,399
and this mask can be easily applied due

303
00:12:32,399 --> 00:12:35,600
to the missing integrity protection

304
00:12:35,600 --> 00:12:38,000
he basically sets the destination ip

305
00:12:38,000 --> 00:12:40,480
towards the malicious dns server

306
00:12:40,480 --> 00:12:42,480
and forwards it to the network the

307
00:12:42,480 --> 00:12:44,160
network has no means

308
00:12:44,160 --> 00:12:46,880
to detect the manipulation decrypts the

309
00:12:46,880 --> 00:12:47,920
packet

310
00:12:47,920 --> 00:12:51,760
and routes it towards the internet

311
00:12:51,760 --> 00:12:54,000
and basically is received by the

312
00:12:54,000 --> 00:12:56,079
malicious dns server

313
00:12:56,079 --> 00:12:58,560
the malicious dns server and receives

314
00:12:58,560 --> 00:13:00,240
the dns request

315
00:13:00,240 --> 00:13:03,279
and responds with a spoof dns response

316
00:13:03,279 --> 00:13:05,680
and sends it back to the network

317
00:13:05,680 --> 00:13:07,360
everything is encrypted

318
00:13:07,360 --> 00:13:09,200
while the network for the over air

319
00:13:09,200 --> 00:13:10,800
transmission and

320
00:13:10,800 --> 00:13:14,160
um for water to the red radar to relay

321
00:13:14,160 --> 00:13:15,920
on the radio layer

322
00:13:15,920 --> 00:13:18,639
and the ue receives the packet on the

323
00:13:18,639 --> 00:13:19,760
radio layer

324
00:13:19,760 --> 00:13:22,320
and with the spoofed response it then

325
00:13:22,320 --> 00:13:23,120
uses the

326
00:13:23,120 --> 00:13:26,240
spoofed response for the

327
00:13:26,240 --> 00:13:30,079
outgoing http request so

328
00:13:30,079 --> 00:13:33,120
all the subsequent hdp connection is

329
00:13:33,120 --> 00:13:37,519
directed towards a malicious http server

330
00:13:38,560 --> 00:13:41,120
so we need something in the man in the

331
00:13:41,120 --> 00:13:42,320
middle position

332
00:13:42,320 --> 00:13:44,560
between your phone and the commercial

333
00:13:44,560 --> 00:13:45,519
network

334
00:13:45,519 --> 00:13:48,800
right and on the left side

335
00:13:48,800 --> 00:13:51,760
we already know that mz catcher or fake

336
00:13:51,760 --> 00:13:52,560
base station at

337
00:13:52,560 --> 00:13:55,680
exist attacks exist so

338
00:13:55,680 --> 00:13:58,560
towards the phone the relay must act as

339
00:13:58,560 --> 00:13:59,760
enough b

340
00:13:59,760 --> 00:14:01,760
um as commercial e not b by sending out

341
00:14:01,760 --> 00:14:03,519
the identifiers

342
00:14:03,519 --> 00:14:07,120
and x as normally not b

343
00:14:07,120 --> 00:14:09,760
however the relay also requires to act

344
00:14:09,760 --> 00:14:10,800
as ue

345
00:14:10,800 --> 00:14:14,240
towards the commercial e node b so

346
00:14:14,240 --> 00:14:17,600
on the radio layer um they look like

347
00:14:17,600 --> 00:14:21,839
it looks like it's a recon ue connecting

348
00:14:21,839 --> 00:14:24,880
in between everything um

349
00:14:24,880 --> 00:14:27,120
is forwarded all layer two frames are

350
00:14:27,120 --> 00:14:30,079
forwarded in both directions

351
00:14:30,079 --> 00:14:34,959
and only dns requests are altered

352
00:14:34,959 --> 00:14:37,360
so we built this relay based on the open

353
00:14:37,360 --> 00:14:38,880
source software stack

354
00:14:38,880 --> 00:14:42,240
and called sslte and i will show

355
00:14:42,240 --> 00:14:46,320
now show you my setup

356
00:14:50,720 --> 00:14:54,320
so sslte requires you

357
00:14:54,320 --> 00:14:56,880
to send us messages using software

358
00:14:56,880 --> 00:14:58,240
defined radius

359
00:14:58,240 --> 00:15:00,880
we got here one software defined radio

360
00:15:00,880 --> 00:15:03,040
and by address that costs about

361
00:15:03,040 --> 00:15:06,240
um you know 1000

362
00:15:06,240 --> 00:15:09,600
dollars and this simulates the

363
00:15:09,600 --> 00:15:13,040
ue towards a commercial network

364
00:15:13,040 --> 00:15:16,880
we got a second software d5 radio here

365
00:15:16,880 --> 00:15:18,720
connected wire cable towards the

366
00:15:18,720 --> 00:15:20,880
shielding box and within the shielding

367
00:15:20,880 --> 00:15:23,279
box we got the antennas

368
00:15:23,279 --> 00:15:26,800
here and they open up the cell

369
00:15:26,800 --> 00:15:29,920
and which our commercial phone um here

370
00:15:29,920 --> 00:15:31,199
nexus 5

371
00:15:31,199 --> 00:15:35,120
connects to the commercial phone

372
00:15:35,120 --> 00:15:37,600
contains a commercial sim card and

373
00:15:37,600 --> 00:15:39,440
without any modification

374
00:15:39,440 --> 00:15:42,880
except everything is controlled via adb

375
00:15:42,880 --> 00:15:45,519
and usb cable we close the shielding box

376
00:15:45,519 --> 00:15:46,000
to not

377
00:15:46,000 --> 00:15:49,279
interfere with the commercial network

378
00:15:49,279 --> 00:15:55,839
so that the providers can use a spectrum

379
00:15:59,920 --> 00:16:02,720
and so this was a setup and i will now

380
00:16:02,720 --> 00:16:03,279
show you

381
00:16:03,279 --> 00:16:09,839
the demo video of the ultra attack

382
00:16:12,000 --> 00:16:15,519
so we see the lte relay here and the dns

383
00:16:15,519 --> 00:16:18,480
server here and the http server here

384
00:16:18,480 --> 00:16:22,240
we have the victims phone here

385
00:16:22,240 --> 00:16:25,440
we initialize the relay we start both

386
00:16:25,440 --> 00:16:28,639
software defined radios

387
00:16:29,120 --> 00:16:33,040
and we are going to disable the airplane

388
00:16:34,839 --> 00:16:37,360
mode

389
00:16:37,360 --> 00:16:39,680
and at this point the aka is performed

390
00:16:39,680 --> 00:16:40,639
all control

391
00:16:40,639 --> 00:16:43,519
control traffic is relayed and the phone

392
00:16:43,519 --> 00:16:45,040
thinks it is connected to the real

393
00:16:45,040 --> 00:16:48,000
commercial network

394
00:16:49,680 --> 00:16:51,600
the victim might enter a web page or

395
00:16:51,600 --> 00:16:54,000
website like hotmail.com

396
00:16:54,000 --> 00:16:56,560
and here we already got the redirection

397
00:16:56,560 --> 00:16:58,000
so the relay reader

398
00:16:58,000 --> 00:16:59,920
detects the dns request based on the

399
00:16:59,920 --> 00:17:02,800
length xorsa mask

400
00:17:02,800 --> 00:17:05,119
and the ip packet gets redirected or

401
00:17:05,119 --> 00:17:06,880
routed to the malicious

402
00:17:06,880 --> 00:17:10,880
dns server seen here

403
00:17:10,880 --> 00:17:13,919
and the phone sends now the http request

404
00:17:13,919 --> 00:17:17,839
towards the malicious http server

405
00:17:17,839 --> 00:17:20,959
the http server delivers a fake website

406
00:17:20,959 --> 00:17:24,799
where the user might enter the

407
00:17:30,840 --> 00:17:33,840
credentials

408
00:17:33,919 --> 00:17:36,320
and here you can see that the user

409
00:17:36,320 --> 00:17:38,080
entered the credentials

410
00:17:38,080 --> 00:17:41,440
and everything is locked by the

411
00:17:41,440 --> 00:17:44,840
attacker and he can obtain the

412
00:17:44,840 --> 00:17:47,200
credentials so you now have seen that

413
00:17:47,200 --> 00:17:48,480
the alter tag

414
00:17:48,480 --> 00:17:50,640
can be performed in a commercial network

415
00:17:50,640 --> 00:17:53,760
for stealing credentials or redirecting

416
00:17:53,760 --> 00:17:57,039
people or victims to a malicious site

417
00:17:57,039 --> 00:17:59,840
and the question is can it be worse and

418
00:17:59,840 --> 00:18:00,240
yes

419
00:18:00,240 --> 00:18:03,840
it can be worse with impact

420
00:18:05,120 --> 00:18:07,520
so we will proceed now with the impact

421
00:18:07,520 --> 00:18:09,200
attack

422
00:18:09,200 --> 00:18:12,000
as i said impact stands for

423
00:18:12,000 --> 00:18:13,200
impersonation

424
00:18:13,200 --> 00:18:17,360
in 4g networks the question is

425
00:18:17,360 --> 00:18:20,240
or or there are two variants of the

426
00:18:20,240 --> 00:18:22,160
impact attack first of all we have the

427
00:18:22,160 --> 00:18:23,840
uplink variant

428
00:18:23,840 --> 00:18:26,320
in the uplink variant the user or the

429
00:18:26,320 --> 00:18:27,200
victim

430
00:18:27,200 --> 00:18:29,600
the attacker impersonates a victim

431
00:18:29,600 --> 00:18:32,480
towards the network on the user plan

432
00:18:32,480 --> 00:18:34,640
so this is the limitation we only focus

433
00:18:34,640 --> 00:18:35,600
on the

434
00:18:35,600 --> 00:18:39,280
user playing user ip traffic for example

435
00:18:39,280 --> 00:18:40,400
the attacker is

436
00:18:40,400 --> 00:18:43,520
capable or able to access a website with

437
00:18:43,520 --> 00:18:44,640
the identity

438
00:18:44,640 --> 00:18:48,880
or ip address of the victim

439
00:18:50,480 --> 00:18:52,720
the there is a downlink variant of this

440
00:18:52,720 --> 00:18:53,600
attack

441
00:18:53,600 --> 00:18:56,240
and the downlink variant enables an

442
00:18:56,240 --> 00:18:57,039
attacker

443
00:18:57,039 --> 00:18:59,520
to impersonate a network towards the

444
00:18:59,520 --> 00:19:01,919
user on the user plane

445
00:19:01,919 --> 00:19:03,840
thereby he can circumvent the provider's

446
00:19:03,840 --> 00:19:06,559
firewall directly accessing the phone

447
00:19:06,559 --> 00:19:10,240
wire network connection

448
00:19:10,240 --> 00:19:14,080
this both attacks break the aim of

449
00:19:14,080 --> 00:19:15,600
mutual authentication

450
00:19:15,600 --> 00:19:18,720
on the user plane in both directions

451
00:19:18,720 --> 00:19:22,240
because the provider does not receive

452
00:19:22,240 --> 00:19:25,600
messages from the wrong

453
00:19:25,600 --> 00:19:28,080
identity but assumes the identity of

454
00:19:28,080 --> 00:19:29,440
another

455
00:19:29,440 --> 00:19:33,200
and also the

456
00:19:33,200 --> 00:19:36,480
victim or the phone receives messages

457
00:19:36,480 --> 00:19:40,160
he should not or it should not receive

458
00:19:40,160 --> 00:19:43,600
what do we exploit for impact we exploit

459
00:19:43,600 --> 00:19:45,760
again the effect of missing integrity

460
00:19:45,760 --> 00:19:46,960
protection

461
00:19:46,960 --> 00:19:49,520
and we combine this attack vector now

462
00:19:49,520 --> 00:19:52,400
with something we call reflection

463
00:19:52,400 --> 00:19:56,160
so i think all of you know the icmp

464
00:19:56,160 --> 00:19:59,520
ping protocol and the icmp ping protocol

465
00:19:59,520 --> 00:20:02,799
works as follows when you send an ip

466
00:20:02,799 --> 00:20:05,600
packet and the icmp ping request

467
00:20:05,600 --> 00:20:08,320
and which contains some data the phone

468
00:20:08,320 --> 00:20:09,600
will respond

469
00:20:09,600 --> 00:20:12,799
with an icmp ping response

470
00:20:12,799 --> 00:20:16,240
and copying the data from the

471
00:20:16,240 --> 00:20:19,360
original packet thereby

472
00:20:19,360 --> 00:20:22,400
the phone um the data can be arbitrary

473
00:20:22,400 --> 00:20:22,880
long

474
00:20:22,880 --> 00:20:26,000
so it can be the full mtu size of the

475
00:20:26,000 --> 00:20:29,280
the packet and which is replied to the

476
00:20:29,280 --> 00:20:33,679
to the um requesting party

477
00:20:33,679 --> 00:20:36,960
so the basic principle um of missing or

478
00:20:36,960 --> 00:20:38,799
off the impact attack is that missing

479
00:20:38,799 --> 00:20:40,400
integrity protection

480
00:20:40,400 --> 00:20:42,640
and combined with the effect of the

481
00:20:42,640 --> 00:20:44,400
reflection mechanism

482
00:20:44,400 --> 00:20:46,320
allows us to build an encryption and

483
00:20:46,320 --> 00:20:48,240
decryption oracle

484
00:20:48,240 --> 00:20:51,200
and this is because we need to encrypt

485
00:20:51,200 --> 00:20:52,000
something

486
00:20:52,000 --> 00:20:54,720
towards the network and receive

487
00:20:54,720 --> 00:20:56,640
something from the network

488
00:20:56,640 --> 00:21:01,679
and both oracles allow an impersonation

489
00:21:01,679 --> 00:21:03,760
so we will start with the encryption

490
00:21:03,760 --> 00:21:06,000
oracle and basically introduce the idea

491
00:21:06,000 --> 00:21:07,600
of the encryption oracle

492
00:21:07,600 --> 00:21:10,960
and then we will i will show you um

493
00:21:10,960 --> 00:21:14,240
the decryption oracle

494
00:21:14,400 --> 00:21:17,600
so from the outer attack you know that

495
00:21:17,600 --> 00:21:20,240
um we are the attacker an active

496
00:21:20,240 --> 00:21:21,600
attacker and the man in the middle

497
00:21:21,600 --> 00:21:22,559
position

498
00:21:22,559 --> 00:21:26,000
is capable to flip some bits

499
00:21:26,000 --> 00:21:29,200
in the receive plaintext when he knows

500
00:21:29,200 --> 00:21:32,400
certain parts of the message so we have

501
00:21:32,400 --> 00:21:34,240
seen that we can flip one bit

502
00:21:34,240 --> 00:21:37,760
under the assumption we know this bit

503
00:21:37,760 --> 00:21:40,720
however knowing the whole plain text

504
00:21:40,720 --> 00:21:41,520
would allow

505
00:21:41,520 --> 00:21:45,200
us to change the whole plain text

506
00:21:45,200 --> 00:21:47,840
so the attacker when he knows the whole

507
00:21:47,840 --> 00:21:49,760
plain text the computer can compute a

508
00:21:49,760 --> 00:21:50,960
mask

509
00:21:50,960 --> 00:21:53,440
for all bits in the plain text in the

510
00:21:53,440 --> 00:21:54,320
packet

511
00:21:54,320 --> 00:21:58,400
and can change everything in other words

512
00:21:58,400 --> 00:22:01,520
if the attacker knows the whole plain

513
00:22:01,520 --> 00:22:02,320
text he can

514
00:22:02,320 --> 00:22:05,679
extract the key stream and reuse it

515
00:22:05,679 --> 00:22:08,720
to encrypt his own packet towards

516
00:22:08,720 --> 00:22:13,200
the network and this is something

517
00:22:13,200 --> 00:22:17,120
um their encryption oracle does

518
00:22:17,120 --> 00:22:20,400
so we got some entities for the

519
00:22:20,400 --> 00:22:22,799
encryption oracle again so we got the

520
00:22:22,799 --> 00:22:24,320
victim's phone here

521
00:22:24,320 --> 00:22:26,159
we got the relay in the man in the

522
00:22:26,159 --> 00:22:28,240
middle position between the network

523
00:22:28,240 --> 00:22:29,760
between the commercial network and the

524
00:22:29,760 --> 00:22:30,880
phone

525
00:22:30,880 --> 00:22:32,720
and we got the key stream generation

526
00:22:32,720 --> 00:22:34,000
server this is

527
00:22:34,000 --> 00:22:35,360
something under the control of the

528
00:22:35,360 --> 00:22:37,360
attacker which is basically a

529
00:22:37,360 --> 00:22:40,559
server on the internet and the target

530
00:22:40,559 --> 00:22:42,080
server

531
00:22:42,080 --> 00:22:45,120
aim of the attack is now to send a

532
00:22:45,120 --> 00:22:45,679
packet

533
00:22:45,679 --> 00:22:47,840
towards a target server with the

534
00:22:47,840 --> 00:22:48,880
identity

535
00:22:48,880 --> 00:22:52,240
of the victim so

536
00:22:52,240 --> 00:22:54,640
the key stream generation server will

537
00:22:54,640 --> 00:22:56,000
start with this attack

538
00:22:56,000 --> 00:22:58,640
it will send an ip packet containing the

539
00:22:58,640 --> 00:22:59,760
udp

540
00:22:59,760 --> 00:23:03,120
and a known known payload

541
00:23:03,120 --> 00:23:06,400
towards the network so this payload

542
00:23:06,400 --> 00:23:09,520
is particularly important and

543
00:23:09,520 --> 00:23:12,080
the attacker will basically know the

544
00:23:12,080 --> 00:23:14,000
plaintext the whole time of this attack

545
00:23:14,000 --> 00:23:15,679
because the keystream generation server

546
00:23:15,679 --> 00:23:18,640
is under his control

547
00:23:18,640 --> 00:23:21,280
sending this packet towards the network

548
00:23:21,280 --> 00:23:22,320
um

549
00:23:22,320 --> 00:23:26,159
would result usually in

550
00:23:26,159 --> 00:23:30,720
in the firewall to to to drop the packet

551
00:23:30,720 --> 00:23:32,880
so this is something we assume need to

552
00:23:32,880 --> 00:23:34,000
assume now

553
00:23:34,000 --> 00:23:36,799
um but um there is a firewall or nut

554
00:23:36,799 --> 00:23:37,760
tool already

555
00:23:37,760 --> 00:23:42,159
um open um for for this incoming packet

556
00:23:42,159 --> 00:23:45,520
so i did a shortcut here um to

557
00:23:45,520 --> 00:23:47,600
do do not bore you with with the

558
00:23:47,600 --> 00:23:49,200
preparation phase

559
00:23:49,200 --> 00:23:52,400
and so let's assume that this nut port

560
00:23:52,400 --> 00:23:53,440
is often

561
00:23:53,440 --> 00:23:57,760
open the network will route this packet

562
00:23:57,760 --> 00:24:00,960
on the logical level to the phone

563
00:24:00,960 --> 00:24:04,640
and he the network will encrypt this

564
00:24:04,640 --> 00:24:05,200
packet

565
00:24:05,200 --> 00:24:07,200
for the over air transmission but on the

566
00:24:07,200 --> 00:24:09,360
radio layer this packet is sent

567
00:24:09,360 --> 00:24:12,880
towards our relay the relay has

568
00:24:12,880 --> 00:24:16,240
can now manipulate and the whole content

569
00:24:16,240 --> 00:24:17,279
of the

570
00:24:17,279 --> 00:24:21,360
traffic but only focuses on the udp

571
00:24:21,360 --> 00:24:24,640
header and changes udp header to an

572
00:24:24,640 --> 00:24:28,559
icmp ping request with a known payload

573
00:24:28,559 --> 00:24:32,320
here everything is valid encrypted and

574
00:24:32,320 --> 00:24:36,080
sent towards the ue the ue

575
00:24:36,080 --> 00:24:37,840
will now trigger the reflection

576
00:24:37,840 --> 00:24:39,200
mechanism or

577
00:24:39,200 --> 00:24:42,559
because it's an incoming icmp request

578
00:24:42,559 --> 00:24:45,840
um from from an ip and will respond to

579
00:24:45,840 --> 00:24:46,720
this icmp

580
00:24:46,720 --> 00:24:50,960
ping request with an icmp ping recomply

581
00:24:50,960 --> 00:24:53,840
copying the original payload from the

582
00:24:53,840 --> 00:24:54,640
request

583
00:24:54,640 --> 00:24:57,200
which is generated actually by at the

584
00:24:57,200 --> 00:25:00,960
keystream generation server

585
00:25:00,960 --> 00:25:03,679
so the relay has now the chance um to

586
00:25:03,679 --> 00:25:05,520
compute the whole key stream because he

587
00:25:05,520 --> 00:25:07,799
knows the plain text he knows also the

588
00:25:07,799 --> 00:25:10,080
icmpingreply

589
00:25:10,080 --> 00:25:13,279
and reuse this keystream to encrypt his

590
00:25:13,279 --> 00:25:15,840
own new payload

591
00:25:15,840 --> 00:25:17,600
which he would like to send towards the

592
00:25:17,600 --> 00:25:19,200
target server

593
00:25:19,200 --> 00:25:22,640
he also sets the destination ip

594
00:25:22,640 --> 00:25:27,360
to the ip of the target server ip

595
00:25:27,360 --> 00:25:29,360
everything is valid and sent towards the

596
00:25:29,360 --> 00:25:31,200
net network encrypted

597
00:25:31,200 --> 00:25:33,440
and the network has no means to detect

598
00:25:33,440 --> 00:25:35,039
any manipulation

599
00:25:35,039 --> 00:25:37,520
and then decrypts the packet and

600
00:25:37,520 --> 00:25:38,480
forwards it

601
00:25:38,480 --> 00:25:41,600
to packet towards the target server

602
00:25:41,600 --> 00:25:43,840
so the target server has now received

603
00:25:43,840 --> 00:25:44,880
the packet

604
00:25:44,880 --> 00:25:47,200
and he will respond to it for example if

605
00:25:47,200 --> 00:25:48,720
you haven't

606
00:25:48,720 --> 00:25:50,960
tcp connection which should be built up

607
00:25:50,960 --> 00:25:52,320
you've got a tcp

608
00:25:52,320 --> 00:25:55,600
syn packet and the

609
00:25:55,600 --> 00:25:57,840
target server will respond with a tcp

610
00:25:57,840 --> 00:25:58,799
syn egg

611
00:25:58,799 --> 00:26:01,840
towards this packet so

612
00:26:01,840 --> 00:26:04,960
we need to receive the sun egg packet

613
00:26:04,960 --> 00:26:06,799
as an attacker to build up a fully

614
00:26:06,799 --> 00:26:08,080
functional

615
00:26:08,080 --> 00:26:12,320
connection so the idea of the

616
00:26:12,320 --> 00:26:14,320
decryption oracle so this is why we need

617
00:26:14,320 --> 00:26:16,159
the decryption oracle

618
00:26:16,159 --> 00:26:18,240
the idea of the decryption article is

619
00:26:18,240 --> 00:26:20,080
now that

620
00:26:20,080 --> 00:26:22,799
the response of the target server is

621
00:26:22,799 --> 00:26:24,799
manipulated in this way

622
00:26:24,799 --> 00:26:28,080
and that it also reflects the packet

623
00:26:28,080 --> 00:26:30,880
and the reflected packet is also again

624
00:26:30,880 --> 00:26:31,840
manipulated

625
00:26:31,840 --> 00:26:35,120
and redirected to an entity called key

626
00:26:35,120 --> 00:26:38,799
decryption server

627
00:26:38,799 --> 00:26:40,799
so how does it look like in the sequence

628
00:26:40,799 --> 00:26:42,240
diagram

629
00:26:42,240 --> 00:26:44,559
the target server will respond for

630
00:26:44,559 --> 00:26:45,919
example with a tcp

631
00:26:45,919 --> 00:26:49,520
synag with a unknown plaintext a payload

632
00:26:49,520 --> 00:26:50,400
with an unknown

633
00:26:50,400 --> 00:26:52,320
payload we would like to receive this

634
00:26:52,320 --> 00:26:54,000
payload because we would like to build a

635
00:26:54,000 --> 00:26:56,080
valid tcp connection

636
00:26:56,080 --> 00:26:59,600
towards the target server the network

637
00:26:59,600 --> 00:27:01,200
received this

638
00:27:01,200 --> 00:27:05,039
and it's actually directed on a logical

639
00:27:05,039 --> 00:27:06,960
level on an ip level

640
00:27:06,960 --> 00:27:10,320
towards the ue towards the phone

641
00:27:10,320 --> 00:27:13,679
and on but on the radio layer this

642
00:27:13,679 --> 00:27:16,559
packet is sent towards a relay the relay

643
00:27:16,559 --> 00:27:18,799
has again the chance to manipulate

644
00:27:18,799 --> 00:27:21,440
the plain text or the payload of this

645
00:27:21,440 --> 00:27:22,559
packet

646
00:27:22,559 --> 00:27:24,799
and now there is a also a second

647
00:27:24,799 --> 00:27:27,039
reflection mechanism not the icmp ping

648
00:27:27,039 --> 00:27:28,880
reflection

649
00:27:28,880 --> 00:27:30,640
this is something we call unreachable

650
00:27:30,640 --> 00:27:32,080
reflection

651
00:27:32,080 --> 00:27:35,600
in case of um changing the ip protocol

652
00:27:35,600 --> 00:27:36,480
header

653
00:27:36,480 --> 00:27:38,640
we can change it to an unsupported

654
00:27:38,640 --> 00:27:40,240
protocol and the ue

655
00:27:40,240 --> 00:27:43,279
will reflect the payload the the packet

656
00:27:43,279 --> 00:27:44,640
with the payload

657
00:27:44,640 --> 00:27:48,399
of the incoming packet so this is where

658
00:27:48,399 --> 00:27:48,720
the

659
00:27:48,720 --> 00:27:52,000
um payload is where the reflection

660
00:27:52,000 --> 00:27:54,240
measure nozzle is triggered

661
00:27:54,240 --> 00:27:58,159
and um this reflection contains the

662
00:27:58,159 --> 00:27:58,960
whole tcp

663
00:27:58,960 --> 00:28:01,360
packet original coming from the target

664
00:28:01,360 --> 00:28:02,559
server

665
00:28:02,559 --> 00:28:05,039
and now the relay changes the

666
00:28:05,039 --> 00:28:07,120
destination ip towards the decryption

667
00:28:07,120 --> 00:28:08,159
server

668
00:28:08,159 --> 00:28:10,720
and the network again receives the

669
00:28:10,720 --> 00:28:11,600
packet

670
00:28:11,600 --> 00:28:13,840
and decrypts it and forwards it or

671
00:28:13,840 --> 00:28:15,760
routes it towards the

672
00:28:15,760 --> 00:28:19,200
decryption server we can now access the

673
00:28:19,200 --> 00:28:22,720
original packet from the

674
00:28:22,720 --> 00:28:26,159
from the target server and

675
00:28:26,159 --> 00:28:28,840
are able to access the information we

676
00:28:28,840 --> 00:28:31,279
need

677
00:28:31,279 --> 00:28:31,700
so

678
00:28:31,700 --> 00:28:34,399
[Music]

679
00:28:34,399 --> 00:28:37,279
using the uplink and downlink an uplink

680
00:28:37,279 --> 00:28:39,520
encryption and downlink decryption

681
00:28:39,520 --> 00:28:42,640
allows us to fully impersonate a vector

682
00:28:42,640 --> 00:28:45,039
so we can start with the uplink

683
00:28:45,039 --> 00:28:46,159
encryption oracle

684
00:28:46,159 --> 00:28:49,600
to build a tcp packet

685
00:28:49,600 --> 00:28:53,200
receive the tcp synag and perform

686
00:28:53,200 --> 00:28:55,200
the uplink encryption again to send some

687
00:28:55,200 --> 00:28:56,960
data to the target server

688
00:28:56,960 --> 00:29:00,640
and the target server will respond

689
00:29:02,399 --> 00:29:04,960
so we have performed the experiments

690
00:29:04,960 --> 00:29:06,880
using the same

691
00:29:06,880 --> 00:29:09,120
setup as shown before with a commercial

692
00:29:09,120 --> 00:29:11,279
network with a commercial phone

693
00:29:11,279 --> 00:29:14,720
and all these attacks do not require

694
00:29:14,720 --> 00:29:18,159
any user interaction this is because

695
00:29:18,159 --> 00:29:21,440
we use um the initial check

696
00:29:21,440 --> 00:29:25,440
of android phones to be intercepted

697
00:29:25,440 --> 00:29:28,600
which is android connectivity and

698
00:29:28,600 --> 00:29:30,720
connectivitycheck.android.com

699
00:29:30,720 --> 00:29:32,720
and we perform for the uplink

700
00:29:32,720 --> 00:29:35,520
impersonation we perform two experiments

701
00:29:35,520 --> 00:29:38,840
so just to recap the aim of the uplink

702
00:29:38,840 --> 00:29:41,520
impersonation

703
00:29:41,520 --> 00:29:43,600
the attacker would like to access a

704
00:29:43,600 --> 00:29:44,720
website or

705
00:29:44,720 --> 00:29:49,039
a server with the identity of the victim

706
00:29:49,039 --> 00:29:52,399
and we performed an experiment

707
00:29:52,399 --> 00:29:54,399
where we visit a website which is only

708
00:29:54,399 --> 00:29:56,000
accessible by the victim

709
00:29:56,000 --> 00:29:58,880
and therefore i need to introduce you to

710
00:29:58,880 --> 00:30:00,880
server sites

711
00:30:00,880 --> 00:30:03,520
server sites are sites hosted by the

712
00:30:03,520 --> 00:30:05,360
providers that allow you to manage your

713
00:30:05,360 --> 00:30:06,799
account

714
00:30:06,799 --> 00:30:09,200
they allow you to book data plans or

715
00:30:09,200 --> 00:30:12,720
even sometimes to show your phone number

716
00:30:12,720 --> 00:30:16,000
the authentication is just based on the

717
00:30:16,000 --> 00:30:17,760
ip address

718
00:30:17,760 --> 00:30:19,679
so this is something called header

719
00:30:19,679 --> 00:30:22,000
enrichment and the provider

720
00:30:22,000 --> 00:30:24,960
at the gateway towards the server

721
00:30:24,960 --> 00:30:26,080
inserts

722
00:30:26,080 --> 00:30:29,120
insert a header and that says okay this

723
00:30:29,120 --> 00:30:30,480
is this customer

724
00:30:30,480 --> 00:30:34,320
he has his rights to be accessed

725
00:30:34,320 --> 00:30:37,360
and we performed this

726
00:30:37,360 --> 00:30:39,520
experiment and we're able to access the

727
00:30:39,520 --> 00:30:40,720
server side

728
00:30:40,720 --> 00:30:43,120
um without any interaction of this

729
00:30:43,120 --> 00:30:44,720
victim

730
00:30:44,720 --> 00:30:46,880
we further uploaded a 10 kilobyte file

731
00:30:46,880 --> 00:30:48,880
to a server with the ip address

732
00:30:48,880 --> 00:30:53,279
of the victim we will now see

733
00:30:53,279 --> 00:30:55,200
the demonstration of the uplink impact

734
00:30:55,200 --> 00:30:58,720
attack where we access the server side

735
00:30:58,720 --> 00:31:04,559
with the identity of the vector

736
00:31:04,559 --> 00:31:06,159
so we are again in the man in the middle

737
00:31:06,159 --> 00:31:07,679
position

738
00:31:07,679 --> 00:31:11,600
between the lte network and the phone

739
00:31:11,760 --> 00:31:13,279
and here we see all the internet

740
00:31:13,279 --> 00:31:15,039
entities

741
00:31:15,039 --> 00:31:16,840
but we focus on the man in the middle

742
00:31:16,840 --> 00:31:19,840
relay

743
00:31:23,039 --> 00:31:26,158
we see the victim here

744
00:31:28,000 --> 00:31:33,840
and we start the relay

745
00:31:34,000 --> 00:31:37,360
we lay started we will disable airplane

746
00:31:37,360 --> 00:31:38,750
mode now

747
00:31:38,750 --> 00:31:41,789
[Music]

748
00:31:43,440 --> 00:31:45,440
and start some management script that

749
00:31:45,440 --> 00:31:49,519
perform all things automatically

750
00:31:51,760 --> 00:31:53,679
and now the phone is connected again so

751
00:31:53,679 --> 00:31:56,000
the aka has happened and everything is

752
00:31:56,000 --> 00:31:57,039
fine

753
00:31:57,039 --> 00:31:59,200
and we download the website using an

754
00:31:59,200 --> 00:32:02,080
automatic call script

755
00:32:02,080 --> 00:32:06,080
and here we go we downloaded in total

756
00:32:06,080 --> 00:32:08,559
35 packets and the victim has still

757
00:32:08,559 --> 00:32:15,840
functional lte internet connection

758
00:32:19,440 --> 00:32:23,519
so we see the um basically the html

759
00:32:23,519 --> 00:32:26,000
source code and we see that we are able

760
00:32:26,000 --> 00:32:27,919
to access the information how many data

761
00:32:27,919 --> 00:32:30,159
volume was used during the last period

762
00:32:30,159 --> 00:32:31,679
of

763
00:32:31,679 --> 00:32:34,080
and we are able basically also to book a

764
00:32:34,080 --> 00:32:36,559
new data plan which is a day flat where

765
00:32:36,559 --> 00:32:38,720
you can have free access for one day for

766
00:32:38,720 --> 00:32:43,840
24 hours

767
00:32:43,840 --> 00:32:47,519
so we should we have seen that the

768
00:32:47,519 --> 00:32:50,880
uplink impersonation is um works in a

769
00:32:50,880 --> 00:32:52,880
commercial setting and we will also see

770
00:32:52,880 --> 00:32:54,320
that the downlink impersonation is

771
00:32:54,320 --> 00:32:55,519
possible

772
00:32:55,519 --> 00:32:57,440
so i didn't talk much about the downlink

773
00:32:57,440 --> 00:32:58,960
impersonation however

774
00:32:58,960 --> 00:33:00,399
it's quite similar to the uplink

775
00:33:00,399 --> 00:33:02,000
implementation so you got an

776
00:33:02,000 --> 00:33:05,039
encryption oracle and a downloading

777
00:33:05,039 --> 00:33:07,120
encryption oracle and a decryption

778
00:33:07,120 --> 00:33:09,600
oracle

779
00:33:09,679 --> 00:33:12,880
the aim is um the other way around

780
00:33:12,880 --> 00:33:16,320
so the attacker impersonates a network

781
00:33:16,320 --> 00:33:18,320
and is able to send any kind of ip

782
00:33:18,320 --> 00:33:20,720
traffic towards your phone

783
00:33:20,720 --> 00:33:22,559
and he can use this to circumvent the

784
00:33:22,559 --> 00:33:25,120
firewall for example if you have an app

785
00:33:25,120 --> 00:33:27,120
listening on a particular port

786
00:33:27,120 --> 00:33:29,919
or an iot device or something like that

787
00:33:29,919 --> 00:33:30,880
and which should be

788
00:33:30,880 --> 00:33:32,240
this should be protected by the

789
00:33:32,240 --> 00:33:34,240
provider's firewall and

790
00:33:34,240 --> 00:33:37,600
towards any incoming traffic right and

791
00:33:37,600 --> 00:33:40,080
the aim of the um downlink impersonation

792
00:33:40,080 --> 00:33:41,519
attack is now to circumvent this

793
00:33:41,519 --> 00:33:43,120
provider's firewall

794
00:33:43,120 --> 00:33:45,279
and send arbitrary ip messages towards

795
00:33:45,279 --> 00:33:47,760
your phone

796
00:33:50,399 --> 00:33:55,200
so we will see this um

797
00:33:55,200 --> 00:33:58,559
so the aim

798
00:34:00,159 --> 00:34:01,519
and we are again in the man in the

799
00:34:01,519 --> 00:34:03,519
middle position between the lte network

800
00:34:03,519 --> 00:34:07,039
and the victim

801
00:34:07,039 --> 00:34:10,480
and we focus again on the um man in the

802
00:34:10,480 --> 00:34:11,760
middle relay

803
00:34:11,760 --> 00:34:14,480
and here we got the app that it listens

804
00:34:14,480 --> 00:34:15,839
for incoming traffic

805
00:34:15,839 --> 00:34:18,079
this is basically netcat just listening

806
00:34:18,079 --> 00:34:21,839
for incoming traffic

807
00:34:22,079 --> 00:34:25,040
we start the relay

808
00:34:26,560 --> 00:34:29,280
the relay has found a cell and sends out

809
00:34:29,280 --> 00:34:30,239
the identifiers

810
00:34:30,239 --> 00:34:34,800
and we disable the airplane mode again

811
00:34:34,800 --> 00:34:38,000
and so we

812
00:34:38,000 --> 00:34:41,280
start some management scripts

813
00:34:42,480 --> 00:34:46,399
and disable the airplane mode so

814
00:34:46,399 --> 00:34:49,280
the aka is performed and the ue thinks

815
00:34:49,280 --> 00:34:50,719
okay it's connected to the

816
00:34:50,719 --> 00:34:52,719
network and already the attack has

817
00:34:52,719 --> 00:34:54,079
happened and

818
00:34:54,079 --> 00:34:56,639
here we see um hello downlink impact

819
00:34:56,639 --> 00:34:57,760
which is in string

820
00:34:57,760 --> 00:35:00,839
which is sent towards the towards the

821
00:35:00,839 --> 00:35:03,839
app

822
00:35:03,839 --> 00:35:06,960
so we now have seen that

823
00:35:06,960 --> 00:35:09,520
the uplink and downlink impersonation

824
00:35:09,520 --> 00:35:10,560
attack

825
00:35:10,560 --> 00:35:14,839
is is a real attack vector in commercial

826
00:35:14,839 --> 00:35:16,000
networks

827
00:35:16,000 --> 00:35:18,079
and it's very important to discuss the

828
00:35:18,079 --> 00:35:20,240
implementations

829
00:35:20,240 --> 00:35:23,280
so the first question i would like to

830
00:35:23,280 --> 00:35:24,560
answer

831
00:35:24,560 --> 00:35:27,760
and who is affected and i guess if you

832
00:35:27,760 --> 00:35:30,640
are not ordinary person and this is

833
00:35:30,640 --> 00:35:33,040
something that should not or will not

834
00:35:33,040 --> 00:35:33,839
happen to you

835
00:35:33,839 --> 00:35:36,800
and the attacker needs to have

836
00:35:36,800 --> 00:35:38,480
specialized hardware

837
00:35:38,480 --> 00:35:42,320
and customized lte stack and conducting

838
00:35:42,320 --> 00:35:45,280
and this attack outside our shielding

839
00:35:45,280 --> 00:35:46,160
box

840
00:35:46,160 --> 00:35:49,280
um is quite difficult however for

841
00:35:49,280 --> 00:35:52,160
single targets and very high value

842
00:35:52,160 --> 00:35:54,320
targets this might be an option

843
00:35:54,320 --> 00:35:56,720
so we know that um mz catchers and

844
00:35:56,720 --> 00:35:58,079
stingrays are out there

845
00:35:58,079 --> 00:36:01,599
and used by agencies for conducting

846
00:36:01,599 --> 00:36:02,960
attacks

847
00:36:02,960 --> 00:36:06,320
and i recently came about an article

848
00:36:06,320 --> 00:36:08,960
or report by amnesty international which

849
00:36:08,960 --> 00:36:09,760
describes

850
00:36:09,760 --> 00:36:12,880
an attack vector or an attack to a

851
00:36:12,880 --> 00:36:14,000
journalist

852
00:36:14,000 --> 00:36:16,480
um yeah where he got some spyware

853
00:36:16,480 --> 00:36:18,240
installed on the phone

854
00:36:18,240 --> 00:36:20,480
and basically i would like to read out

855
00:36:20,480 --> 00:36:22,320
some sentences

856
00:36:22,320 --> 00:36:25,599
and for the network injection the

857
00:36:25,599 --> 00:36:28,000
attacker requires um either physical

858
00:36:28,000 --> 00:36:29,760
location to the target

859
00:36:29,760 --> 00:36:32,960
or access digit and the first sentence

860
00:36:32,960 --> 00:36:33,359
of

861
00:36:33,359 --> 00:36:36,720
um the describes

862
00:36:36,720 --> 00:36:38,320
something similar to an mc catcher

863
00:36:38,320 --> 00:36:39,440
attack so you need physical

864
00:36:39,440 --> 00:36:41,760
approximation to the target

865
00:36:41,760 --> 00:36:44,160
and there's another sentence which is

866
00:36:44,160 --> 00:36:46,640
quite interesting to read

867
00:36:46,640 --> 00:36:48,800
the phone's web browser is then

868
00:36:48,800 --> 00:36:51,040
redirected to a malicious web page

869
00:36:51,040 --> 00:36:54,160
or website and this is exactly the

870
00:36:54,160 --> 00:36:54,960
author attack

871
00:36:54,960 --> 00:36:57,119
so you get redirected and then might be

872
00:36:57,119 --> 00:36:58,480
get infected by

873
00:36:58,480 --> 00:37:02,560
a spider so an ordinary person might not

874
00:37:02,560 --> 00:37:04,960
be affected by this but it might be

875
00:37:04,960 --> 00:37:08,000
exploitable now or even in future

876
00:37:08,000 --> 00:37:11,920
by some um agencies

877
00:37:12,560 --> 00:37:15,040
besides besides the estimation of the

878
00:37:15,040 --> 00:37:16,880
risk we would like need to talk about

879
00:37:16,880 --> 00:37:19,680
consequences and first of all for

880
00:37:19,680 --> 00:37:20,320
providers

881
00:37:20,320 --> 00:37:22,640
providers rely on mutual authentication

882
00:37:22,640 --> 00:37:24,480
for billing purposes

883
00:37:24,480 --> 00:37:27,200
so for example and they use this server

884
00:37:27,200 --> 00:37:30,400
side where you can book the data plans

885
00:37:30,400 --> 00:37:33,280
but also

886
00:37:33,440 --> 00:37:35,520
an attacker is able to generate a lot of

887
00:37:35,520 --> 00:37:37,440
data in your name

888
00:37:37,440 --> 00:37:40,079
and this would be built for your to your

889
00:37:40,079 --> 00:37:40,480
bill

890
00:37:40,480 --> 00:37:43,359
right and this would result in over

891
00:37:43,359 --> 00:37:45,200
billing and this is something providers

892
00:37:45,200 --> 00:37:46,079
should be currently

893
00:37:46,079 --> 00:37:49,599
concerned about i think there are some

894
00:37:49,599 --> 00:37:50,000
laws

895
00:37:50,000 --> 00:37:52,320
in some countries that allow not to

896
00:37:52,320 --> 00:37:55,520
overcharge you as customer

897
00:37:55,520 --> 00:37:58,640
and there are also also um the risk of

898
00:37:58,640 --> 00:38:01,839
authorization so um yeah accessing the

899
00:38:01,839 --> 00:38:04,800
server side for example consequently the

900
00:38:04,800 --> 00:38:05,839
impact attack is

901
00:38:05,839 --> 00:38:08,240
a risk for the business model of the

902
00:38:08,240 --> 00:38:10,799
providers

903
00:38:11,520 --> 00:38:14,800
and second law enforcement agencies

904
00:38:14,800 --> 00:38:16,960
rely on mutual authentication in case of

905
00:38:16,960 --> 00:38:18,640
an investigation

906
00:38:18,640 --> 00:38:21,280
for example when an attacker visits a

907
00:38:21,280 --> 00:38:22,240
website

908
00:38:22,240 --> 00:38:25,599
which is only or which visits the

909
00:38:25,599 --> 00:38:26,240
website's

910
00:38:26,240 --> 00:38:29,119
texas websites or upload illegal um

911
00:38:29,119 --> 00:38:31,200
content to this webpage

912
00:38:31,200 --> 00:38:34,000
and the police investigates in this case

913
00:38:34,000 --> 00:38:35,040
and asks the

914
00:38:35,040 --> 00:38:37,200
provider for the identity of a

915
00:38:37,200 --> 00:38:39,040
particular ip address

916
00:38:39,040 --> 00:38:42,160
and the wrong victim get gets blamed and

917
00:38:42,160 --> 00:38:44,880
this can be

918
00:38:44,880 --> 00:38:48,560
this is bad um for for for for

919
00:38:48,560 --> 00:38:51,599
the police investigation and so

920
00:38:51,599 --> 00:38:53,760
it's a kind of serious threat for

921
00:38:53,760 --> 00:38:55,200
current and future

922
00:38:55,200 --> 00:38:58,320
um investigations that are softly based

923
00:38:58,320 --> 00:39:03,599
on ip addresses um in mobile networks

924
00:39:03,599 --> 00:39:06,560
last but not least the consequences for

925
00:39:06,560 --> 00:39:07,920
users

926
00:39:07,920 --> 00:39:10,320
so what are the consequences for users

927
00:39:10,320 --> 00:39:12,960
obviously this is a privacy thread

928
00:39:12,960 --> 00:39:15,920
for example um when the server side

929
00:39:15,920 --> 00:39:17,520
displays your phone number this

930
00:39:17,520 --> 00:39:19,359
phone number can be directly linked to

931
00:39:19,359 --> 00:39:20,800
your mc

932
00:39:20,800 --> 00:39:22,800
and this can be used for further

933
00:39:22,800 --> 00:39:24,160
tracking attacks right

934
00:39:24,160 --> 00:39:27,040
and this is something you don't want but

935
00:39:27,040 --> 00:39:28,240
also for industrial

936
00:39:28,240 --> 00:39:30,800
users like having a factory connected

937
00:39:30,800 --> 00:39:31,760
via lte

938
00:39:31,760 --> 00:39:34,880
or iot devices ylte connected to your

939
00:39:34,880 --> 00:39:36,480
control unit

940
00:39:36,480 --> 00:39:39,520
would allow an attacker an attacker

941
00:39:39,520 --> 00:39:43,040
to circumvent the provider's firewall

942
00:39:43,040 --> 00:39:45,520
and thereby directly accessing the port

943
00:39:45,520 --> 00:39:46,880
of the iot device

944
00:39:46,880 --> 00:39:49,200
for example bad configured iot devices

945
00:39:49,200 --> 00:39:50,160
that have over

946
00:39:50,160 --> 00:39:52,640
telnet ports would be open to such an

947
00:39:52,640 --> 00:39:54,839
attack

948
00:39:54,839 --> 00:39:58,560
so um the question is how can we

949
00:39:58,560 --> 00:40:00,560
mitigate the problem and the only valid

950
00:40:00,560 --> 00:40:02,320
answer is

951
00:40:02,320 --> 00:40:04,560
perform mandatory integrity protection

952
00:40:04,560 --> 00:40:06,319
on the user plan

953
00:40:06,319 --> 00:40:09,040
and there are two questions first of all

954
00:40:09,040 --> 00:40:09,599
is

955
00:40:09,599 --> 00:40:13,119
lte um capable of performing this

956
00:40:13,119 --> 00:40:16,319
and what is about 5g so

957
00:40:16,319 --> 00:40:19,359
lte is already around for 10 years

958
00:40:19,359 --> 00:40:21,119
things are deployed and i guess there

959
00:40:21,119 --> 00:40:22,720
will be no mandatory integrity

960
00:40:22,720 --> 00:40:23,760
protection on

961
00:40:23,760 --> 00:40:27,680
the user plane on um on

962
00:40:27,680 --> 00:40:30,240
yeah for all devices because back

963
00:40:30,240 --> 00:40:33,440
porting would be very expensive

964
00:40:33,440 --> 00:40:36,560
however um 5g

965
00:40:36,560 --> 00:40:39,280
yeah and and the situation and fight 5g

966
00:40:39,280 --> 00:40:39,599
is

967
00:40:39,599 --> 00:40:42,720
um different so

968
00:40:42,720 --> 00:40:45,119
in 5g there is a standalone mode which

969
00:40:45,119 --> 00:40:46,240
will be deployed

970
00:40:46,240 --> 00:40:49,359
maybe we are 2022.

971
00:40:49,359 --> 00:40:53,839
and um this standalone mode

972
00:40:53,920 --> 00:40:55,920
in this standalone mode integrity

973
00:40:55,920 --> 00:40:58,960
protection of the user plane is optional

974
00:40:58,960 --> 00:41:01,440
but it's mandatory to support in full

975
00:41:01,440 --> 00:41:03,920
rate for all devices

976
00:41:03,920 --> 00:41:07,359
and this is something which is um only

977
00:41:07,359 --> 00:41:11,760
yeah one month old so um

978
00:41:11,760 --> 00:41:14,560
basically mandatory integral protection

979
00:41:14,560 --> 00:41:15,359
on full red

980
00:41:15,359 --> 00:41:19,359
level is um only supported since um

981
00:41:19,359 --> 00:41:21,520
at the beginning of july but it's still

982
00:41:21,520 --> 00:41:23,280
optional to use in 5g

983
00:41:23,280 --> 00:41:25,280
so we will monitor the providers if they

984
00:41:25,280 --> 00:41:26,720
will enable it

985
00:41:26,720 --> 00:41:28,640
and this is how i would like to end my

986
00:41:28,640 --> 00:41:30,160
talk um

987
00:41:30,160 --> 00:41:33,119
so thank you very much for listening to

988
00:41:33,119 --> 00:41:33,760
my talk

989
00:41:33,760 --> 00:41:36,480
still healthy and feel free to contact

990
00:41:36,480 --> 00:41:39,760
me if you have any questions

991
00:41:41,359 --> 00:41:43,760
hi everyone and so thank you for

992
00:41:43,760 --> 00:41:45,920
listening to my talk and and i hope you

993
00:41:45,920 --> 00:41:47,119
enjoyed it

994
00:41:47,119 --> 00:41:50,319
and so i don't know if i have much time

995
00:41:50,319 --> 00:41:53,680
for answering q a i guess every most

996
00:41:53,680 --> 00:41:56,240
yeah questions should be set by now at

997
00:41:56,240 --> 00:41:57,440
least in the chat so

998
00:41:57,440 --> 00:41:59,599
if you feel free to contact me if you

999
00:41:59,599 --> 00:42:01,280
have further questions

1000
00:42:01,280 --> 00:42:03,520
and so yeah thank you for listening

1001
00:42:03,520 --> 00:42:07,680
again hope you enjoyed it

