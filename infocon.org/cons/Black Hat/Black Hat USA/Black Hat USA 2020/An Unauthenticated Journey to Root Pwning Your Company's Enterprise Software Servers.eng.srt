1
00:00:04,380 --> 00:00:14,180
[Music]

2
00:00:15,920 --> 00:00:17,279
so thank you everybody for joining

3
00:00:17,279 --> 00:00:18,400
today's presentation

4
00:00:18,400 --> 00:00:20,960
welcome to our talk about how attackers

5
00:00:20,960 --> 00:00:21,680
may gain

6
00:00:21,680 --> 00:00:23,600
root access in your enterprise sofa

7
00:00:23,600 --> 00:00:25,920
service but first of all i would really

8
00:00:25,920 --> 00:00:27,760
like to introduce ourselves

9
00:00:27,760 --> 00:00:29,279
my name is pablo artus i'm from

10
00:00:29,279 --> 00:00:31,439
argentina i'm today with my teammate

11
00:00:31,439 --> 00:00:33,520
ivan genoa who is from france

12
00:00:33,520 --> 00:00:35,760
and we both work as security researchers

13
00:00:35,760 --> 00:00:38,559
at the annapolis security research labs

14
00:00:38,559 --> 00:00:40,879
we have been for those who are not aware

15
00:00:40,879 --> 00:00:42,000
about anapsys

16
00:00:42,000 --> 00:00:43,920
nas is a company which is focused on

17
00:00:43,920 --> 00:00:46,719
providing security for mission critical

18
00:00:46,719 --> 00:00:47,600
applications

19
00:00:47,600 --> 00:00:49,280
we have been in this field for the last

20
00:00:49,280 --> 00:00:51,120
10 years raising awareness

21
00:00:51,120 --> 00:00:54,160
doing research particularly for sap and

22
00:00:54,160 --> 00:00:55,840
oracle products

23
00:00:55,840 --> 00:00:57,600
this is our agenda for today first of

24
00:00:57,600 --> 00:00:58,719
all we're going to start with a brief

25
00:00:58,719 --> 00:00:59,520
introduction

26
00:00:59,520 --> 00:01:00,960
then afterwards we will have some few

27
00:01:00,960 --> 00:01:02,320
words about the main component of

28
00:01:02,320 --> 00:01:04,000
analysis of today which is the solution

29
00:01:04,000 --> 00:01:04,959
manager

30
00:01:04,959 --> 00:01:06,479
then we have three different chapters

31
00:01:06,479 --> 00:01:07,760
talking about our research and the

32
00:01:07,760 --> 00:01:09,040
vulnerabilities that we found

33
00:01:09,040 --> 00:01:10,840
and finally some conclusions and some

34
00:01:10,840 --> 00:01:12,080
recommendations

35
00:01:12,080 --> 00:01:14,320
so let's begin with our interaction

36
00:01:14,320 --> 00:01:15,600
what's sap

37
00:01:15,600 --> 00:01:17,759
so for sure if you have ever discussed

38
00:01:17,759 --> 00:01:19,759
or talked about enterprise software

39
00:01:19,759 --> 00:01:21,920
you for you already mentioned sap once

40
00:01:21,920 --> 00:01:23,200
in your life

41
00:01:23,200 --> 00:01:25,040
the reason to believe this is because

42
00:01:25,040 --> 00:01:27,439
sap is one of the vendor of the largest

43
00:01:27,439 --> 00:01:29,360
vendors is not the largest one

44
00:01:29,360 --> 00:01:32,640
in the world of enterprise software

45
00:01:32,640 --> 00:01:34,159
on the right on the left side of the

46
00:01:34,159 --> 00:01:36,000
slide you can see some of the products

47
00:01:36,000 --> 00:01:36,799
of sap

48
00:01:36,799 --> 00:01:39,119
and you may recognize some of them on

49
00:01:39,119 --> 00:01:40,479
the right side of the side

50
00:01:40,479 --> 00:01:42,159
there are some numbers about this

51
00:01:42,159 --> 00:01:44,159
company that i want you to know

52
00:01:44,159 --> 00:01:47,439
for example 77 of the whole transaction

53
00:01:47,439 --> 00:01:48,079
revenue

54
00:01:48,079 --> 00:01:52,079
in of the world go through an sap system

55
00:01:52,079 --> 00:01:55,200
all other number all fortune 500 olen

56
00:01:55,200 --> 00:01:56,159
gas companies

57
00:01:56,159 --> 00:01:58,719
are using sap for the daily business so

58
00:01:58,719 --> 00:02:00,320
i hope these numbers may

59
00:02:00,320 --> 00:02:03,280
uh may help you to measure how critical

60
00:02:03,280 --> 00:02:06,640
and how widely sap is being used

61
00:02:06,640 --> 00:02:09,520
in this slide we have a example of a

62
00:02:09,520 --> 00:02:11,280
setup that we are going to use

63
00:02:11,280 --> 00:02:14,480
all along the talk uh so for we can

64
00:02:14,480 --> 00:02:14,959
better

65
00:02:14,959 --> 00:02:17,599
explain what we are uh discussing in

66
00:02:17,599 --> 00:02:20,480
some in different topics

67
00:02:20,480 --> 00:02:21,920
so it's really important you understand

68
00:02:21,920 --> 00:02:23,520
how easy build is set up first of all

69
00:02:23,520 --> 00:02:24,640
we're going to have three different

70
00:02:24,640 --> 00:02:26,480
servers each of these servers is running

71
00:02:26,480 --> 00:02:28,400
a sap application as almost every

72
00:02:28,400 --> 00:02:29,280
application

73
00:02:29,280 --> 00:02:31,200
sap application they are running on top

74
00:02:31,200 --> 00:02:33,599
of a layer that is called sap netweaver

75
00:02:33,599 --> 00:02:35,040
and we have two different flavors of

76
00:02:35,040 --> 00:02:37,280
nature java or apop as you can see in

77
00:02:37,280 --> 00:02:37,920
the screen

78
00:02:37,920 --> 00:02:39,440
some of them are running java some of

79
00:02:39,440 --> 00:02:41,200
them are running naval just for your

80
00:02:41,200 --> 00:02:42,800
information s4hana is

81
00:02:42,800 --> 00:02:44,720
something that worry about and also as

82
00:02:44,720 --> 00:02:46,400
you can see there are some of them run

83
00:02:46,400 --> 00:02:48,000
linux and some of their are running

84
00:02:48,000 --> 00:02:50,319
windows why do we have such a diverse

85
00:02:50,319 --> 00:02:50,879
setup

86
00:02:50,879 --> 00:02:53,120
because basically we want to show you

87
00:02:53,120 --> 00:02:54,720
that the attack that i want to present

88
00:02:54,720 --> 00:02:55,280
today

89
00:02:55,280 --> 00:02:57,519
it worked it will work no matter

90
00:02:57,519 --> 00:02:59,280
operating system no marinet weaver

91
00:02:59,280 --> 00:03:00,959
flavor

92
00:03:00,959 --> 00:03:04,000
also in our custom setup as any other

93
00:03:04,000 --> 00:03:07,120
setup it will have a solution manager

94
00:03:07,120 --> 00:03:08,720
and now i will hand out the presentation

95
00:03:08,720 --> 00:03:10,400
to ivan who will explain a little bit

96
00:03:10,400 --> 00:03:12,400
more about this component

97
00:03:12,400 --> 00:03:15,440
thank you pato um hello everyone my name

98
00:03:15,440 --> 00:03:15,920
is

99
00:03:15,920 --> 00:03:18,000
ivan janmeer and i will continue to

100
00:03:18,000 --> 00:03:18,959
introduce

101
00:03:18,959 --> 00:03:21,120
how target was installed the sub source

102
00:03:21,120 --> 00:03:22,800
of manager

103
00:03:22,800 --> 00:03:24,640
the sub solution manager is what we call

104
00:03:24,640 --> 00:03:26,640
a technical sap system because

105
00:03:26,640 --> 00:03:29,440
there are no business data into it and

106
00:03:29,440 --> 00:03:31,120
this is kind of system used

107
00:03:31,120 --> 00:03:34,000
only by sap administrator to perform

108
00:03:34,000 --> 00:03:34,959
administration

109
00:03:34,959 --> 00:03:37,920
tasks on whole other sap system so this

110
00:03:37,920 --> 00:03:39,440
is a highly

111
00:03:39,440 --> 00:03:42,959
connected system on the landscape

112
00:03:42,959 --> 00:03:46,000
and the the big advantage of the the

113
00:03:46,000 --> 00:03:47,599
substitution manager that you can only

114
00:03:47,599 --> 00:03:49,440
use one system this one to

115
00:03:49,440 --> 00:03:52,000
uh to manage all of them and it's

116
00:03:52,000 --> 00:03:53,360
independent of the

117
00:03:53,360 --> 00:03:56,400
on the sap version os version os type

118
00:03:56,400 --> 00:03:57,760
etc etc

119
00:03:57,760 --> 00:03:59,920
so we can represent it like that in this

120
00:03:59,920 --> 00:04:00,879
picture

121
00:04:00,879 --> 00:04:03,519
and um to to fully understand the

122
00:04:03,519 --> 00:04:05,120
substitution manager you can compare it

123
00:04:05,120 --> 00:04:07,040
to a domain controller in microsoft word

124
00:04:07,040 --> 00:04:09,519
this is basically the the

125
00:04:09,519 --> 00:04:11,840
the sense things uh why would you

126
00:04:11,840 --> 00:04:13,920
electronic

127
00:04:13,920 --> 00:04:16,000
it's a bit obvious we took clock on it

128
00:04:16,000 --> 00:04:17,519
because we we think

129
00:04:17,519 --> 00:04:19,279
this is the technical hurt of the cycle

130
00:04:19,279 --> 00:04:20,959
landscape if we compromise a

131
00:04:20,959 --> 00:04:22,079
substitution manager

132
00:04:22,079 --> 00:04:25,120
you can jump on every other sap system

133
00:04:25,120 --> 00:04:28,639
very very easy to continue to introduce

134
00:04:28,639 --> 00:04:30,240
the substitution manager you nee we need

135
00:04:30,240 --> 00:04:31,440
to speak about the

136
00:04:31,440 --> 00:04:34,240
one of these agents it's called smd

137
00:04:34,240 --> 00:04:35,280
agents

138
00:04:35,280 --> 00:04:37,520
for sub solution manager diagnostic

139
00:04:37,520 --> 00:04:39,600
agent

140
00:04:39,600 --> 00:04:41,600
this agent it's a little component it's

141
00:04:41,600 --> 00:04:43,280
installed on every single

142
00:04:43,280 --> 00:04:46,080
sap host and the purpose of this agent

143
00:04:46,080 --> 00:04:47,120
is to

144
00:04:47,120 --> 00:04:49,520
to manage the communication between the

145
00:04:49,520 --> 00:04:50,160
the

146
00:04:50,160 --> 00:04:52,800
the sap system manager and the sub

147
00:04:52,800 --> 00:04:54,000
solution manager

148
00:04:54,000 --> 00:04:55,680
so you can represent it like that in the

149
00:04:55,680 --> 00:04:57,040
picture and

150
00:04:57,040 --> 00:04:58,880
uh it's very important for this talk

151
00:04:58,880 --> 00:05:01,280
because we we will talk about things for

152
00:05:01,280 --> 00:05:02,639
in the future

153
00:05:02,639 --> 00:05:05,759
uh the last thing uh um because the

154
00:05:05,759 --> 00:05:08,479
the substitution manager it's a it's a

155
00:05:08,479 --> 00:05:10,240
it's a sapnet river uh

156
00:05:10,240 --> 00:05:12,720
you can use the sub git the normal sap

157
00:05:12,720 --> 00:05:13,759
client to

158
00:05:13,759 --> 00:05:16,639
to to to connect into it but actually

159
00:05:16,639 --> 00:05:17,520
you can access

160
00:05:17,520 --> 00:05:20,400
uh directly using http request because

161
00:05:20,400 --> 00:05:22,240
they are basically a web server

162
00:05:22,240 --> 00:05:23,840
hosted in the in the substitution

163
00:05:23,840 --> 00:05:27,280
manager and this is where we start

164
00:05:27,280 --> 00:05:31,039
so the the the next part it's uh

165
00:05:31,039 --> 00:05:33,440
uh when we start looking on this kind of

166
00:05:33,440 --> 00:05:35,520
product this is a huge product with a

167
00:05:35,520 --> 00:05:36,160
lot of

168
00:05:36,160 --> 00:05:39,120
entry points we we the first question is

169
00:05:39,120 --> 00:05:40,880
where to start

170
00:05:40,880 --> 00:05:44,080
uh in this in this case uh we

171
00:05:44,080 --> 00:05:46,560
we were in testing about how the

172
00:05:46,560 --> 00:05:48,160
subsequent manager ended the

173
00:05:48,160 --> 00:05:50,160
communication with this agent how this

174
00:05:50,160 --> 00:05:52,080
communication work and how

175
00:05:52,080 --> 00:05:54,560
the the service manager manage it

176
00:05:54,560 --> 00:05:55,600
basically

177
00:05:55,600 --> 00:06:00,080
um so what we did is to to search on the

178
00:06:00,080 --> 00:06:01,840
whole application provided by the

179
00:06:01,840 --> 00:06:03,919
subsequent manager for a pattern like

180
00:06:03,919 --> 00:06:07,120
smd agent smd engine something like that

181
00:06:07,120 --> 00:06:10,560
we highlight around 60 application and

182
00:06:10,560 --> 00:06:11,199
in this

183
00:06:11,199 --> 00:06:15,199
60 application we found on around more

184
00:06:15,199 --> 00:06:17,759
a bit more than 20 it's reachable

185
00:06:17,759 --> 00:06:18,560
directly

186
00:06:18,560 --> 00:06:22,479
using http request so it could be soap

187
00:06:22,479 --> 00:06:26,880
post get etc and this is a sample of

188
00:06:26,880 --> 00:06:30,560
what we found as a as web services

189
00:06:30,560 --> 00:06:31,280
accessible

190
00:06:31,280 --> 00:06:33,840
remotely so we test all of them

191
00:06:33,840 --> 00:06:35,199
basically all of them are

192
00:06:35,199 --> 00:06:37,600
authenticated and some some some of them

193
00:06:37,600 --> 00:06:40,319
is not very interesting some yes etc

194
00:06:40,319 --> 00:06:43,120
uh eventually we found this one em

195
00:06:43,120 --> 00:06:44,639
service admin

196
00:06:44,639 --> 00:06:46,560
and the true story was something like i

197
00:06:46,560 --> 00:06:48,400
provide the url to part two and say hey

198
00:06:48,400 --> 00:06:49,680
look what i found it

199
00:06:49,680 --> 00:06:52,720
looked very very powerful uh web

200
00:06:52,720 --> 00:06:54,479
services but unfortunately this is

201
00:06:54,479 --> 00:06:55,680
authenticated

202
00:06:55,680 --> 00:06:57,680
and pato sent me quickly back sent me

203
00:06:57,680 --> 00:06:58,720
back something like uh

204
00:06:58,720 --> 00:07:01,360
no it's not and so we'll double check

205
00:07:01,360 --> 00:07:02,400
and uh

206
00:07:02,400 --> 00:07:04,880
yes uh it's not certificate is there no

207
00:07:04,880 --> 00:07:05,759
authentication

208
00:07:05,759 --> 00:07:08,000
need for for access to this web services

209
00:07:08,000 --> 00:07:09,280
so uh

210
00:07:09,280 --> 00:07:11,520
this is uh this is this this is how

211
00:07:11,520 --> 00:07:12,319
huntrey points

212
00:07:12,319 --> 00:07:14,800
in this uh in this talk so uh i'll let

213
00:07:14,800 --> 00:07:16,479
part to explain what we found exactly

214
00:07:16,479 --> 00:07:17,360
here

215
00:07:17,360 --> 00:07:19,360
so yes basically the application that i

216
00:07:19,360 --> 00:07:20,960
was was talking about is called

217
00:07:20,960 --> 00:07:23,680
eem which stands for end user enterprise

218
00:07:23,680 --> 00:07:24,479
monitoring

219
00:07:24,479 --> 00:07:27,360
sorry end user experience monitoring and

220
00:07:27,360 --> 00:07:28,080
what is this

221
00:07:28,080 --> 00:07:31,520
em about basically it allows them

222
00:07:31,520 --> 00:07:34,400
sap administrators to create scripts

223
00:07:34,400 --> 00:07:35,199
that will mimic

224
00:07:35,199 --> 00:07:38,319
user actions so once the script

225
00:07:38,319 --> 00:07:40,400
is uh created you can upload it to this

226
00:07:40,400 --> 00:07:42,400
so-called application eem

227
00:07:42,400 --> 00:07:44,560
and then this em will uh this crease

228
00:07:44,560 --> 00:07:45,919
will get deployed

229
00:07:45,919 --> 00:07:47,919
to a different component which is called

230
00:07:47,919 --> 00:07:49,520
eem robots

231
00:07:49,520 --> 00:07:51,759
that can be running in different servers

232
00:07:51,759 --> 00:07:53,680
and there are the ones that are gonna

233
00:07:53,680 --> 00:07:54,160
finally

234
00:07:54,160 --> 00:07:57,199
execute those scripts it turns out that

235
00:07:57,199 --> 00:08:00,639
smd asians are by default could act as

236
00:08:00,639 --> 00:08:01,360
eem

237
00:08:01,360 --> 00:08:03,599
robots so if you connect to the solution

238
00:08:03,599 --> 00:08:05,039
manager you upload a script then

239
00:08:05,039 --> 00:08:06,319
afterwards you can

240
00:08:06,319 --> 00:08:09,520
deploy to one of your smithiations

241
00:08:09,520 --> 00:08:11,680
but what is the final objective of this

242
00:08:11,680 --> 00:08:12,800
application

243
00:08:12,800 --> 00:08:15,599
basically it allows sap administrators

244
00:08:15,599 --> 00:08:16,720
to ensure

245
00:08:16,720 --> 00:08:19,440
that everything is working and avoid

246
00:08:19,440 --> 00:08:21,440
final users to experience some kind of

247
00:08:21,440 --> 00:08:22,240
error

248
00:08:22,240 --> 00:08:24,879
so let's explain it with a with a follow

249
00:08:24,879 --> 00:08:25,680
example

250
00:08:25,680 --> 00:08:27,759
let's suppose that your company users

251
00:08:27,759 --> 00:08:28,960
are really

252
00:08:28,960 --> 00:08:31,759
used to uh query some particular table

253
00:08:31,759 --> 00:08:33,120
of the database

254
00:08:33,120 --> 00:08:35,760
so what an sap administrator could do is

255
00:08:35,760 --> 00:08:36,880
develop a script

256
00:08:36,880 --> 00:08:39,760
that will basically query that table and

257
00:08:39,760 --> 00:08:42,080
deploy it to an s media agent

258
00:08:42,080 --> 00:08:45,200
once the once is deployed this

259
00:08:45,200 --> 00:08:46,560
indication will start executing the

260
00:08:46,560 --> 00:08:48,399
script in a chrome fashion

261
00:08:48,399 --> 00:08:51,120
and in case it gets an error it will be

262
00:08:51,120 --> 00:08:52,800
immediately notification

263
00:08:52,800 --> 00:08:56,640
the sap administrator so

264
00:08:56,640 --> 00:09:00,240
doing this action users will not

265
00:09:00,240 --> 00:09:02,080
potentially will not receive that error

266
00:09:02,080 --> 00:09:03,440
because the administrator will get

267
00:09:03,440 --> 00:09:06,720
noticed before happening

268
00:09:07,120 --> 00:09:09,200
but if you think for a little ivan told

269
00:09:09,200 --> 00:09:10,720
you that this authentic this um

270
00:09:10,720 --> 00:09:12,320
application wasn't required for

271
00:09:12,320 --> 00:09:14,399
authentication so

272
00:09:14,399 --> 00:09:16,480
this means that basically the an

273
00:09:16,480 --> 00:09:18,320
attacker could perform the same

274
00:09:18,320 --> 00:09:19,920
could create a script and load it and

275
00:09:19,920 --> 00:09:22,000
get the and then get deployed

276
00:09:22,000 --> 00:09:24,000
so that was our first question and in

277
00:09:24,000 --> 00:09:25,200
order to answer it

278
00:09:25,200 --> 00:09:27,760
and in order to have a poc of something

279
00:09:27,760 --> 00:09:29,680
that is actually working we need to be

280
00:09:29,680 --> 00:09:30,560
involved more

281
00:09:30,560 --> 00:09:31,760
in the application and how the

282
00:09:31,760 --> 00:09:33,680
application works so that's

283
00:09:33,680 --> 00:09:36,080
that's the topic about our next chapter

284
00:09:36,080 --> 00:09:38,080
which is basically

285
00:09:38,080 --> 00:09:41,200
a more in-depth technical analysis

286
00:09:41,200 --> 00:09:44,880
of the application first of all

287
00:09:44,880 --> 00:09:47,120
in order to analyze it we start with

288
00:09:47,120 --> 00:09:49,040
pointing to the end point it was a soap

289
00:09:49,040 --> 00:09:50,560
endpoint so as you can see in the left

290
00:09:50,560 --> 00:09:51,519
we have all the methods that were

291
00:09:51,519 --> 00:09:53,760
available to be executed

292
00:09:53,760 --> 00:09:55,839
one of them was called run script so

293
00:09:55,839 --> 00:09:57,360
what we decided is okay let's go for

294
00:09:57,360 --> 00:09:59,519
this one because it has a

295
00:09:59,519 --> 00:10:03,360
good name good run script will

296
00:10:03,360 --> 00:10:05,040
ask for two different parameters first

297
00:10:05,040 --> 00:10:06,959
of all the application is the

298
00:10:06,959 --> 00:10:09,760
host of the smd agent or the the agent

299
00:10:09,760 --> 00:10:10,480
or the

300
00:10:10,480 --> 00:10:13,120
em robot where you want to run the

301
00:10:13,120 --> 00:10:13,760
script

302
00:10:13,760 --> 00:10:16,640
and also the script name whenever when

303
00:10:16,640 --> 00:10:18,560
we first run this

304
00:10:18,560 --> 00:10:20,800
uh this test we receive an error that

305
00:10:20,800 --> 00:10:22,480
was not very happy because it say

306
00:10:22,480 --> 00:10:24,560
basically the em was disabled

307
00:10:24,560 --> 00:10:26,800
so we started looking how how we can

308
00:10:26,800 --> 00:10:27,600
circumvent

309
00:10:27,600 --> 00:10:30,240
this issue all along the different

310
00:10:30,240 --> 00:10:31,200
method we found

311
00:10:31,200 --> 00:10:33,839
one that was called get all agent info

312
00:10:33,839 --> 00:10:34,480
that was

313
00:10:34,480 --> 00:10:36,560
really helpful because it was a getter

314
00:10:36,560 --> 00:10:38,079
function this means that usually they

315
00:10:38,079 --> 00:10:39,600
don't ask for parameters

316
00:10:39,600 --> 00:10:42,240
and they provide a really good

317
00:10:42,240 --> 00:10:43,120
information

318
00:10:43,120 --> 00:10:45,680
and it was this case was was not the

319
00:10:45,680 --> 00:10:47,760
exception

320
00:10:47,760 --> 00:10:49,920
once we get the the answer of get all

321
00:10:49,920 --> 00:10:51,120
agent info

322
00:10:51,120 --> 00:10:53,600
we saw that there was one particular

323
00:10:53,600 --> 00:10:55,519
property that was called eem

324
00:10:55,519 --> 00:10:58,640
enable and was set to false so we start

325
00:10:58,640 --> 00:11:00,880
thinking maybe we can modify this and

326
00:11:00,880 --> 00:11:02,160
put it to true and

327
00:11:02,160 --> 00:11:04,000
maybe that works i don't know it's just

328
00:11:04,000 --> 00:11:05,360
an idea

329
00:11:05,360 --> 00:11:07,360
so we tried again looking for the

330
00:11:07,360 --> 00:11:09,279
different methods and we found one that

331
00:11:09,279 --> 00:11:11,440
was called set asia properties

332
00:11:11,440 --> 00:11:13,519
we went through that one and we tried to

333
00:11:13,519 --> 00:11:14,480
use it

334
00:11:14,480 --> 00:11:16,560
parameters were really easy to use

335
00:11:16,560 --> 00:11:17,839
because they were asking just the key

336
00:11:17,839 --> 00:11:18,560
and the value

337
00:11:18,560 --> 00:11:21,440
so ee enable and true and once we

338
00:11:21,440 --> 00:11:22,640
execute that

339
00:11:22,640 --> 00:11:25,200
we go back we went back and tried to

340
00:11:25,200 --> 00:11:27,440
execute again the ghetto election info

341
00:11:27,440 --> 00:11:29,600
and this time the property that was uh

342
00:11:29,600 --> 00:11:30,640
in in

343
00:11:30,640 --> 00:11:34,160
eem enable was set to true and also we

344
00:11:34,160 --> 00:11:34,800
retest

345
00:11:34,800 --> 00:11:37,600
the run script the first set we we we

346
00:11:37,600 --> 00:11:39,279
made

347
00:11:39,279 --> 00:11:41,200
and the error was totally different and

348
00:11:41,200 --> 00:11:42,640
right now made more

349
00:11:42,640 --> 00:11:44,800
much more sense the arrow was basically

350
00:11:44,800 --> 00:11:45,760
saying hey

351
00:11:45,760 --> 00:11:48,320
this this name that you provide i don't

352
00:11:48,320 --> 00:11:48,800
find it

353
00:11:48,800 --> 00:11:51,360
it's not a valid uh script which makes

354
00:11:51,360 --> 00:11:52,639
sense because we were

355
00:11:52,639 --> 00:11:55,200
using some random script so sorry some

356
00:11:55,200 --> 00:11:57,040
random name for the script

357
00:11:57,040 --> 00:11:59,279
and at this point we realized that uh

358
00:11:59,279 --> 00:12:01,920
okay we know how to run scripts now

359
00:12:01,920 --> 00:12:04,000
the point is that we should try to

360
00:12:04,000 --> 00:12:06,560
upload our custom script so how do you

361
00:12:06,560 --> 00:12:09,200
how do we do that we start going again

362
00:12:09,200 --> 00:12:10,399
through the methods and we found one

363
00:12:10,399 --> 00:12:12,079
that was called approach resource

364
00:12:12,079 --> 00:12:14,720
so a blog resource uh again asks for two

365
00:12:14,720 --> 00:12:16,560
parameters destiny hosts again

366
00:12:16,560 --> 00:12:19,519
and also the content of the script so

367
00:12:19,519 --> 00:12:20,639
this means basically

368
00:12:20,639 --> 00:12:22,639
that we have to upload what we want it

369
00:12:22,639 --> 00:12:25,200
to be executed the content was b64

370
00:12:25,200 --> 00:12:25,839
encoded

371
00:12:25,839 --> 00:12:28,560
that was not an issue so we just encoded

372
00:12:28,560 --> 00:12:29,680
some random string

373
00:12:29,680 --> 00:12:31,920
and the error was really really

374
00:12:31,920 --> 00:12:32,800
interesting

375
00:12:32,800 --> 00:12:34,800
it was basically an error a really

376
00:12:34,800 --> 00:12:36,639
common error for xml parsers

377
00:12:36,639 --> 00:12:38,639
so at this point we realized that maybe

378
00:12:38,639 --> 00:12:40,560
we are dealing with an xml pro

379
00:12:40,560 --> 00:12:43,760
protocol script so we tried to

380
00:12:43,760 --> 00:12:46,639
v64 to encode the v64 of the just the

381
00:12:46,639 --> 00:12:48,560
xml product and the answer was really

382
00:12:48,560 --> 00:12:50,560
good also that was basically that

383
00:12:50,560 --> 00:12:52,160
the xml parser was expecting for more

384
00:12:52,160 --> 00:12:53,760
information but the

385
00:12:53,760 --> 00:12:56,800
the it found uh the end of the file

386
00:12:56,800 --> 00:12:58,399
so at this point we realized that we

387
00:12:58,399 --> 00:13:00,639
were with again with some protocol some

388
00:13:00,639 --> 00:13:02,160
scripting protocol that was totally

389
00:13:02,160 --> 00:13:03,839
related with xml

390
00:13:03,839 --> 00:13:06,320
we start looking for more information

391
00:13:06,320 --> 00:13:08,160
about the context of the application

392
00:13:08,160 --> 00:13:10,240
in the web and we found in the world

393
00:13:10,240 --> 00:13:12,399
that there was one particular example

394
00:13:12,399 --> 00:13:15,120
provided by sap to perform an http

395
00:13:15,120 --> 00:13:18,480
script so we grab that script

396
00:13:18,480 --> 00:13:21,600
we try to modify and based on the errors

397
00:13:21,600 --> 00:13:23,360
that we were receiving from

398
00:13:23,360 --> 00:13:25,920
executing the upload resource method we

399
00:13:25,920 --> 00:13:27,680
were finally able to craft

400
00:13:27,680 --> 00:13:29,680
a particular script that was able to

401
00:13:29,680 --> 00:13:31,200
give us an

402
00:13:31,200 --> 00:13:34,160
uh a server server-side request for

403
00:13:34,160 --> 00:13:36,320
sharing

404
00:13:36,320 --> 00:13:37,760
so at this point we realized okay we

405
00:13:37,760 --> 00:13:39,360
have a nice puck for

406
00:13:39,360 --> 00:13:41,360
demonstrating that the annotation an

407
00:13:41,360 --> 00:13:42,880
authenticated attacker could perform

408
00:13:42,880 --> 00:13:43,440
some bad

409
00:13:43,440 --> 00:13:45,519
things but if you think for a while

410
00:13:45,519 --> 00:13:47,199
having an ssrf

411
00:13:47,199 --> 00:13:49,600
in a application that allows you to

412
00:13:49,600 --> 00:13:50,399
perform

413
00:13:50,399 --> 00:13:52,800
http scripts it's not something really i

414
00:13:52,800 --> 00:13:54,240
mean it's the nature of the application

415
00:13:54,240 --> 00:13:55,760
to do that

416
00:13:55,760 --> 00:13:57,440
so we wanted to go beyond that and to

417
00:13:57,440 --> 00:13:59,040
try to find if there was a remote code

418
00:13:59,040 --> 00:14:00,000
execution

419
00:14:00,000 --> 00:14:02,880
over there so it was a good time from

420
00:14:02,880 --> 00:14:04,880
our part of you to shift from blackbox

421
00:14:04,880 --> 00:14:06,639
testing to white box try to analyze the

422
00:14:06,639 --> 00:14:08,320
logo try to analyze more files about the

423
00:14:08,320 --> 00:14:10,240
application

424
00:14:10,240 --> 00:14:11,920
in these files of the application we

425
00:14:11,920 --> 00:14:13,600
found the grammar of the scripting

426
00:14:13,600 --> 00:14:15,440
language and it was really a game

427
00:14:15,440 --> 00:14:16,000
changer

428
00:14:16,000 --> 00:14:17,600
because we could understand more or less

429
00:14:17,600 --> 00:14:19,440
how was the scripting uh

430
00:14:19,440 --> 00:14:23,360
language uh composed each message i mean

431
00:14:23,360 --> 00:14:25,040
it was a message type based

432
00:14:25,040 --> 00:14:27,360
uh scripting language and each message

433
00:14:27,360 --> 00:14:28,959
had a different type

434
00:14:28,959 --> 00:14:30,639
there are four different types that can

435
00:14:30,639 --> 00:14:32,079
be used and one of those was

436
00:14:32,079 --> 00:14:34,800
command so with that name of course we

437
00:14:34,800 --> 00:14:36,560
go through there and we try to analyze

438
00:14:36,560 --> 00:14:37,839
why was a command there

439
00:14:37,839 --> 00:14:39,760
why do we can have a type which is

440
00:14:39,760 --> 00:14:41,519
called command

441
00:14:41,519 --> 00:14:43,440
so we start trying to understand which

442
00:14:43,440 --> 00:14:44,800
are the available commands

443
00:14:44,800 --> 00:14:47,519
for this uh for this scripting language

444
00:14:47,519 --> 00:14:49,600
and we found that we're at least six or

445
00:14:49,600 --> 00:14:50,079
seven

446
00:14:50,079 --> 00:14:51,760
at this point we asked for ourselves why

447
00:14:51,760 --> 00:14:53,360
do we have commands why this feature we

448
00:14:53,360 --> 00:14:54,480
have commands

449
00:14:54,480 --> 00:14:56,399
and if you think it totally makes sense

450
00:14:56,399 --> 00:14:58,480
and the reason behind that is because

451
00:14:58,480 --> 00:14:59,199
you can

452
00:14:59,199 --> 00:15:01,760
execute a request to some place and you

453
00:15:01,760 --> 00:15:02,800
want afterwards

454
00:15:02,800 --> 00:15:05,040
to store maybe the answer in some place

455
00:15:05,040 --> 00:15:07,360
for example persistently in the file

456
00:15:07,360 --> 00:15:09,279
so in that case you wish you will use or

457
00:15:09,279 --> 00:15:10,959
you could use under command like bride

458
00:15:10,959 --> 00:15:12,480
to file

459
00:15:12,480 --> 00:15:13,920
we start analyzing each of these

460
00:15:13,920 --> 00:15:15,360
commands in order to understand if we

461
00:15:15,360 --> 00:15:16,560
can abuse one of them

462
00:15:16,560 --> 00:15:18,639
on norman yeah in order to understand if

463
00:15:18,639 --> 00:15:20,560
we can abuse one of them

464
00:15:20,560 --> 00:15:22,639
and we finally got one that was

465
00:15:22,639 --> 00:15:25,199
vulnerable to a remote code execution

466
00:15:25,199 --> 00:15:27,519
this command was allowing you to enter

467
00:15:27,519 --> 00:15:29,920
to evaluate any javascript code that you

468
00:15:29,920 --> 00:15:31,360
want

469
00:15:31,360 --> 00:15:33,839
we believe that uh something like what

470
00:15:33,839 --> 00:15:35,279
is shown in the script in the sorry in

471
00:15:35,279 --> 00:15:36,240
the slide

472
00:15:36,240 --> 00:15:38,079
is happening beyond the application

473
00:15:38,079 --> 00:15:39,680
there is a really common mistake

474
00:15:39,680 --> 00:15:42,399
from java application sport importing a

475
00:15:42,399 --> 00:15:44,800
script engine from javascript and then

476
00:15:44,800 --> 00:15:48,000
uh passing all the the the

477
00:15:48,000 --> 00:15:50,000
the string let's say that we want to

478
00:15:50,000 --> 00:15:51,680
evaluate that is basically a javascript

479
00:15:51,680 --> 00:15:52,720
code

480
00:15:52,720 --> 00:15:55,680
with that uh with that vulnerability

481
00:15:55,680 --> 00:15:56,560
this means that

482
00:15:56,560 --> 00:15:59,360
an authentic and any person who is able

483
00:15:59,360 --> 00:16:01,199
to perform or to write their own custom

484
00:16:01,199 --> 00:16:01,839
script

485
00:16:01,839 --> 00:16:04,000
will basically be able to abuse this

486
00:16:04,000 --> 00:16:04,959
command

487
00:16:04,959 --> 00:16:08,399
and execute a remote code execution

488
00:16:08,399 --> 00:16:11,680
the sanitization of the script uh string

489
00:16:11,680 --> 00:16:13,839
that was finally into the

490
00:16:13,839 --> 00:16:16,160
the script engine of javascript was not

491
00:16:16,160 --> 00:16:17,920
there i mean there was not any kind of

492
00:16:17,920 --> 00:16:18,399
uh

493
00:16:18,399 --> 00:16:21,360
of sanitization so as a summary this

494
00:16:21,360 --> 00:16:22,880
means that any person

495
00:16:22,880 --> 00:16:25,680
who is able to perform to write scripts

496
00:16:25,680 --> 00:16:26,880
is able to perform

497
00:16:26,880 --> 00:16:29,519
remote code execution but let's split

498
00:16:29,519 --> 00:16:31,360
this in two parts

499
00:16:31,360 --> 00:16:32,959
every person who is able to perform

500
00:16:32,959 --> 00:16:35,199
scripts as we told you this application

501
00:16:35,199 --> 00:16:36,000
is not dedicated

502
00:16:36,000 --> 00:16:38,639
so it means any person and on the right

503
00:16:38,639 --> 00:16:39,040
side

504
00:16:39,040 --> 00:16:41,360
which means that you can execute remote

505
00:16:41,360 --> 00:16:42,480
core execution

506
00:16:42,480 --> 00:16:44,560
in the smd agents which are the final

507
00:16:44,560 --> 00:16:46,079
executable of the scripts

508
00:16:46,079 --> 00:16:49,120
this application is running at the ea

509
00:16:49,120 --> 00:16:52,720
daa which is a user for the simulations

510
00:16:52,720 --> 00:16:54,880
so as a summary basically this means

511
00:16:54,880 --> 00:16:57,120
that any unauthenticated user

512
00:16:57,120 --> 00:16:59,279
will be able to perform a record a

513
00:16:59,279 --> 00:17:00,560
remote code execution with the

514
00:17:00,560 --> 00:17:01,920
privileges of the ta

515
00:17:01,920 --> 00:17:05,199
adm so here we have quickly the four

516
00:17:05,199 --> 00:17:05,919
steps

517
00:17:05,919 --> 00:17:08,079
that the attacker may may perform in

518
00:17:08,079 --> 00:17:09,439
order to achieve this attack

519
00:17:09,439 --> 00:17:10,799
first of all you will gather all the

520
00:17:10,799 --> 00:17:12,720
information from the s mediations

521
00:17:12,720 --> 00:17:14,720
executing it all agent info then

522
00:17:14,720 --> 00:17:16,319
afterwards he will choose the target and

523
00:17:16,319 --> 00:17:18,079
we'll modify the em

524
00:17:18,079 --> 00:17:21,839
enable property from false to true

525
00:17:21,839 --> 00:17:24,720
basically turning off the eem feature

526
00:17:24,720 --> 00:17:26,160
then afterwards this attacker

527
00:17:26,160 --> 00:17:28,799
could upload a script which has a remote

528
00:17:28,799 --> 00:17:30,799
code execution embedded into it

529
00:17:30,799 --> 00:17:33,039
and finally the smdation will execute

530
00:17:33,039 --> 00:17:34,080
that

531
00:17:34,080 --> 00:17:36,880
code that was provided by the attacker

532
00:17:36,880 --> 00:17:38,080
here we have a

533
00:17:38,080 --> 00:17:41,120
quick demo of the attacker on the right

534
00:17:41,120 --> 00:17:41,679
screen

535
00:17:41,679 --> 00:17:43,440
you can see the screen of the attacker

536
00:17:43,440 --> 00:17:45,760
basically that is executing an exploit

537
00:17:45,760 --> 00:17:46,000
that

538
00:17:46,000 --> 00:17:48,960
was built by hirao back around and you

539
00:17:48,960 --> 00:17:50,320
can see he's pointing at the solution

540
00:17:50,320 --> 00:17:52,080
manager and you can see there justin

541
00:17:52,080 --> 00:17:53,760
right now that there are some asians

542
00:17:53,760 --> 00:17:55,120
over there

543
00:17:55,120 --> 00:17:57,280
there are four different agents so if

544
00:17:57,280 --> 00:17:59,360
you recall our

545
00:17:59,360 --> 00:18:01,600
setup that we use as an example in the

546
00:18:01,600 --> 00:18:03,039
whole presentation

547
00:18:03,039 --> 00:18:04,640
we have four different systems because

548
00:18:04,640 --> 00:18:06,080
we are trying to put

549
00:18:06,080 --> 00:18:08,000
the same thing as you can so what you

550
00:18:08,000 --> 00:18:09,760
can understand here we are dealing with

551
00:18:09,760 --> 00:18:10,880
the same setup

552
00:18:10,880 --> 00:18:12,640
on the left side you will see how the

553
00:18:12,640 --> 00:18:14,000
different shells are starting to

554
00:18:14,000 --> 00:18:16,240
popping up basically the attacker here

555
00:18:16,240 --> 00:18:17,120
is getting root

556
00:18:17,120 --> 00:18:20,240
uh node rules sorry taadm shells from

557
00:18:20,240 --> 00:18:21,760
each of these variations which are

558
00:18:21,760 --> 00:18:23,600
connected to the solution manager

559
00:18:23,600 --> 00:18:26,240
and even in the last one as you can see

560
00:18:26,240 --> 00:18:27,840
is a windows machine so no matter if

561
00:18:27,840 --> 00:18:29,679
it's running in linux windows

562
00:18:29,679 --> 00:18:32,640
the attacker is able to get uh a reverse

563
00:18:32,640 --> 00:18:33,039
shell

564
00:18:33,039 --> 00:18:35,280
from all the expediations that are

565
00:18:35,280 --> 00:18:36,160
connected

566
00:18:36,160 --> 00:18:39,919
to the sub solution manager so

567
00:18:39,919 --> 00:18:42,160
as a summary right now the attacker is

568
00:18:42,160 --> 00:18:43,760
able to

569
00:18:43,760 --> 00:18:45,440
compromise all excel mediations

570
00:18:45,440 --> 00:18:47,039
connected to a solution manager

571
00:18:47,039 --> 00:18:49,280
just having network access to a solution

572
00:18:49,280 --> 00:18:50,559
manager there is no need for

573
00:18:50,559 --> 00:18:52,000
authentication there is no need for

574
00:18:52,000 --> 00:18:53,120
authorization

575
00:18:53,120 --> 00:18:55,120
this is just a step one of our whole

576
00:18:55,120 --> 00:18:56,400
attack i will let

577
00:18:56,400 --> 00:18:59,919
ivan to continue with the second phase

578
00:18:59,919 --> 00:19:03,679
okay so to understand the next step how

579
00:19:03,679 --> 00:19:06,080
we would them all we need to introduce a

580
00:19:06,080 --> 00:19:07,280
new agent

581
00:19:07,280 --> 00:19:09,919
again this code is the the colossus

582
00:19:09,919 --> 00:19:11,840
agent is sap earth agents

583
00:19:11,840 --> 00:19:14,960
so again this is a kind of component uh

584
00:19:14,960 --> 00:19:18,160
installed on every single sap host and

585
00:19:18,160 --> 00:19:20,160
it's always independent and database

586
00:19:20,160 --> 00:19:21,120
independent

587
00:19:21,120 --> 00:19:23,760
uh the purpose of this agent this time

588
00:19:23,760 --> 00:19:26,240
is to provide some

589
00:19:26,240 --> 00:19:28,799
life sequel tasks to to administrators

590
00:19:28,799 --> 00:19:29,520
so like

591
00:19:29,520 --> 00:19:32,559
monitoring start instances prepare for

592
00:19:32,559 --> 00:19:35,039
sap upgrade or canon upgrade something

593
00:19:35,039 --> 00:19:35,919
like that

594
00:19:35,919 --> 00:19:39,200
so this is a very powerful agent

595
00:19:39,200 --> 00:19:42,799
uh why we took a look on it basically

596
00:19:42,799 --> 00:19:45,200
for three three reasons the first one is

597
00:19:45,200 --> 00:19:46,240
uh

598
00:19:46,240 --> 00:19:49,840
we we there are a couple of services

599
00:19:49,840 --> 00:19:52,080
of this agent known as root privilege

600
00:19:52,080 --> 00:19:53,440
with full privilege

601
00:19:53,440 --> 00:19:56,880
so of course this is always a good

602
00:19:56,880 --> 00:19:58,559
interesting thing to take a look at this

603
00:19:58,559 --> 00:20:00,000
kind of services

604
00:20:00,000 --> 00:20:03,120
the second one it's uh it's you can

605
00:20:03,120 --> 00:20:05,600
access to the services remotely use

606
00:20:05,600 --> 00:20:08,400
using the port one one two eight okay

607
00:20:08,400 --> 00:20:09,600
and the last one the

608
00:20:09,600 --> 00:20:12,240
most important one it's uh we found how

609
00:20:12,240 --> 00:20:12,640
the

610
00:20:12,640 --> 00:20:16,400
adm user uh is is list somewhere in the

611
00:20:16,400 --> 00:20:17,200
configuration

612
00:20:17,200 --> 00:20:20,480
file of the of the supposed agent so

613
00:20:20,480 --> 00:20:23,520
these three things convince us that we

614
00:20:23,520 --> 00:20:25,679
we need to go deeper on it so the next

615
00:20:25,679 --> 00:20:26,880
step is to

616
00:20:26,880 --> 00:20:29,840
uh to to try to understand how we can

617
00:20:29,840 --> 00:20:31,760
communicate with the supposed

618
00:20:31,760 --> 00:20:34,559
agent using how access the at the end

619
00:20:34,559 --> 00:20:36,559
user access

620
00:20:36,559 --> 00:20:39,760
okay now normally locally

621
00:20:39,760 --> 00:20:42,480
administrator can use the the binary

622
00:20:42,480 --> 00:20:44,000
suppose control to

623
00:20:44,000 --> 00:20:47,679
uh to call a server to call the function

624
00:20:47,679 --> 00:20:50,400
of the smd agents when we speak about

625
00:20:50,400 --> 00:20:51,600
function provided by

626
00:20:51,600 --> 00:20:54,640
the sm the the support agent sorry

627
00:20:54,640 --> 00:20:57,280
we speak about whole this function there

628
00:20:57,280 --> 00:20:59,600
are a lot of function a lot of

629
00:20:59,600 --> 00:21:03,840
administration function so

630
00:21:04,400 --> 00:21:07,440
next step is to uh we we focus

631
00:21:07,440 --> 00:21:09,440
on the configuration file where we find

632
00:21:09,440 --> 00:21:12,240
the air the m user for sure

633
00:21:12,240 --> 00:21:15,039
we find a couple of very interesting

634
00:21:15,039 --> 00:21:16,000
parameters the first

635
00:21:16,000 --> 00:21:19,360
one is this one uh

636
00:21:19,360 --> 00:21:22,480
this service admin user uh looking on

637
00:21:22,480 --> 00:21:23,679
the documentation we

638
00:21:23,679 --> 00:21:26,000
uh we understand that this is a list of

639
00:21:26,000 --> 00:21:27,039
users

640
00:21:27,039 --> 00:21:29,039
who able to communicate with the suppose

641
00:21:29,039 --> 00:21:31,280
agent so we are very happy because they

642
00:21:31,280 --> 00:21:31,840
are they

643
00:21:31,840 --> 00:21:34,799
are in in in the value of this parameter

644
00:21:34,799 --> 00:21:35,120
but

645
00:21:35,120 --> 00:21:37,120
unfortunately after a few tests we

646
00:21:37,120 --> 00:21:38,320
understand that

647
00:21:38,320 --> 00:21:41,919
even if we are logged as the adm user

648
00:21:41,919 --> 00:21:43,919
locally on the system we need to provide

649
00:21:43,919 --> 00:21:45,760
again the password when we call the

650
00:21:45,760 --> 00:21:46,640
supposed

651
00:21:46,640 --> 00:21:50,640
control so uh we are a bit disappointed

652
00:21:50,640 --> 00:21:51,360
because in

653
00:21:51,360 --> 00:21:53,840
our case uh because we use the

654
00:21:53,840 --> 00:21:56,080
substitution manager to execute the adm

655
00:21:56,080 --> 00:21:58,400
os command we haven't the the password

656
00:21:58,400 --> 00:21:59,200
of course

657
00:21:59,200 --> 00:22:01,440
so we can't communicate directly like

658
00:22:01,440 --> 00:22:02,799
that

659
00:22:02,799 --> 00:22:05,600
okay uh the next parameter interesting

660
00:22:05,600 --> 00:22:07,039
is the configuration file it's

661
00:22:07,039 --> 00:22:09,200
this one the service port type the

662
00:22:09,200 --> 00:22:11,360
documentation say this is a list of web

663
00:22:11,360 --> 00:22:12,000
services

664
00:22:12,000 --> 00:22:15,200
exposed by the the host agent so we take

665
00:22:15,200 --> 00:22:16,880
a look on the binary and yes

666
00:22:16,880 --> 00:22:19,760
there are a lot of uh web services uh

667
00:22:19,760 --> 00:22:20,960
available

668
00:22:20,960 --> 00:22:24,480
and we we look on the port one one two

669
00:22:24,480 --> 00:22:25,360
eight so the one one

670
00:22:25,360 --> 00:22:28,400
two eight in uh it's an http port uh

671
00:22:28,400 --> 00:22:31,200
where we can find a lot of uh all the

672
00:22:31,200 --> 00:22:33,120
the web services provided by the the

673
00:22:33,120 --> 00:22:34,640
support station and you you can

674
00:22:34,640 --> 00:22:37,840
call the suppost agent function directly

675
00:22:37,840 --> 00:22:40,559
uh using this web service size and of

676
00:22:40,559 --> 00:22:40,960
course

677
00:22:40,960 --> 00:22:44,159
everything is authenticated

678
00:22:44,159 --> 00:22:48,640
um one day we we decide to sniff

679
00:22:48,640 --> 00:22:51,600
the the local network interfaces during

680
00:22:51,600 --> 00:22:53,280
our test so we

681
00:22:53,280 --> 00:22:54,960
we perform some tests we use in the

682
00:22:54,960 --> 00:22:56,880
supposed control binary

683
00:22:56,880 --> 00:23:01,520
and we we understand that behind

684
00:23:01,520 --> 00:23:04,640
whole the whole the process it's only

685
00:23:04,640 --> 00:23:06,880
http a lot of http requests

686
00:23:06,880 --> 00:23:10,080
on localhost on the one two eight so

687
00:23:10,080 --> 00:23:11,760
we get all the content of the web

688
00:23:11,760 --> 00:23:14,400
services the soap request etc etc like

689
00:23:14,400 --> 00:23:15,280
that

690
00:23:15,280 --> 00:23:18,880
um the the next the the second thing we

691
00:23:18,880 --> 00:23:20,000
find during this uh

692
00:23:20,000 --> 00:23:22,880
this operation we uh we found this very

693
00:23:22,880 --> 00:23:24,159
curious credential

694
00:23:24,159 --> 00:23:27,919
uh the the the username the the

695
00:23:27,919 --> 00:23:30,240
the pattern between brackets it's always

696
00:23:30,240 --> 00:23:32,240
the same but the password the list of

697
00:23:32,240 --> 00:23:33,280
the number

698
00:23:33,280 --> 00:23:37,039
changed at every single request and

699
00:23:37,039 --> 00:23:38,559
we are very interesting about that

700
00:23:38,559 --> 00:23:40,080
because we don't know

701
00:23:40,080 --> 00:23:42,000
where where where this this password

702
00:23:42,000 --> 00:23:45,039
confirm and etc

703
00:23:45,039 --> 00:23:47,360
so what we did it's uh we decided to

704
00:23:47,360 --> 00:23:48,400
analysis the

705
00:23:48,400 --> 00:23:52,000
the sap host agent kernel and we

706
00:23:52,000 --> 00:23:54,559
uh we start with the as an entry point

707
00:23:54,559 --> 00:23:56,400
we start with the user name the ad code

708
00:23:56,400 --> 00:23:57,360
user name

709
00:23:57,360 --> 00:24:00,480
and very quickly we understand that

710
00:24:00,480 --> 00:24:03,520
they are a feature named a trusted

711
00:24:03,520 --> 00:24:04,000
internal

712
00:24:04,000 --> 00:24:06,159
connection so what we understand about

713
00:24:06,159 --> 00:24:08,400
this feature

714
00:24:08,400 --> 00:24:10,960
for whole user list in the service user

715
00:24:10,960 --> 00:24:11,760
admin

716
00:24:11,760 --> 00:24:14,960
for example the adm they can

717
00:24:14,960 --> 00:24:17,360
call for a logon file request a logon

718
00:24:17,360 --> 00:24:19,200
file to the suppose agent the supposed

719
00:24:19,200 --> 00:24:20,080
agent

720
00:24:20,080 --> 00:24:22,880
send back the path a local path to a

721
00:24:22,880 --> 00:24:25,200
file for example logon 42

722
00:24:25,200 --> 00:24:28,880
then the the drdm reads the content of

723
00:24:28,880 --> 00:24:29,760
this file

724
00:24:29,760 --> 00:24:32,640
and the content of this file it's the

725
00:24:32,640 --> 00:24:33,600
the password

726
00:24:33,600 --> 00:24:35,679
you the toppery password you can use to

727
00:24:35,679 --> 00:24:37,840
perform one request

728
00:24:37,840 --> 00:24:41,039
so it's meanwhile so

729
00:24:41,039 --> 00:24:43,200
this is very simple like that uh one

730
00:24:43,200 --> 00:24:44,400
request on localhost

731
00:24:44,400 --> 00:24:46,720
retrieve the path get the the content

732
00:24:46,720 --> 00:24:48,240
and the content in the temporary

733
00:24:48,240 --> 00:24:50,080
password you can use

734
00:24:50,080 --> 00:24:52,559
so it's been what it means uh at this

735
00:24:52,559 --> 00:24:53,679
time

736
00:24:53,679 --> 00:24:56,320
we never provided the ide and password

737
00:24:56,320 --> 00:24:57,840
so

738
00:24:57,840 --> 00:25:00,000
now if we take back the the global

739
00:25:00,000 --> 00:25:00,880
picture

740
00:25:00,880 --> 00:25:04,000
from uh the smd agent as they are

741
00:25:04,000 --> 00:25:05,840
at the end user you can call all the

742
00:25:05,840 --> 00:25:08,159
function uh provided by the supposed

743
00:25:08,159 --> 00:25:11,120
agent and remember when we speak about

744
00:25:11,120 --> 00:25:12,559
whole function we speak about

745
00:25:12,559 --> 00:25:15,600
whole this function so the next step

746
00:25:15,600 --> 00:25:18,480
was to find out how it's possible to

747
00:25:18,480 --> 00:25:21,120
execute root command directly

748
00:25:21,120 --> 00:25:24,880
using using one of this function and

749
00:25:24,880 --> 00:25:27,600
we we found a way using for example this

750
00:25:27,600 --> 00:25:28,000
function

751
00:25:28,000 --> 00:25:31,360
execute operation this function try to

752
00:25:31,360 --> 00:25:34,559
execute supposed exit binary but the

753
00:25:34,559 --> 00:25:37,279
the the path could be tweaked by

754
00:25:37,279 --> 00:25:38,960
attacker so

755
00:25:38,960 --> 00:25:41,760
attacker can execute command as what

756
00:25:41,760 --> 00:25:43,600
what they want as what is it we're using

757
00:25:43,600 --> 00:25:44,880
this function

758
00:25:44,880 --> 00:25:47,360
uh another example is uh this uh this

759
00:25:47,360 --> 00:25:49,120
function executable procedure

760
00:25:49,120 --> 00:25:52,880
uh it tried to um to to to execute

761
00:25:52,880 --> 00:25:55,360
several command as root and the last

762
00:25:55,360 --> 00:25:56,960
command they tried to execute

763
00:25:56,960 --> 00:26:00,000
the serpent binary but again the the

764
00:26:00,000 --> 00:26:01,919
path to the serpents could be tricked by

765
00:26:01,919 --> 00:26:03,840
an attacker so you can execute what you

766
00:26:03,840 --> 00:26:05,520
want again

767
00:26:05,520 --> 00:26:08,320
another one is this one this one is a

768
00:26:08,320 --> 00:26:08,880
little bit

769
00:26:08,880 --> 00:26:11,440
more tricky because he tried to uh mount

770
00:26:11,440 --> 00:26:13,200
the file system

771
00:26:13,200 --> 00:26:16,159
as root but uh we found a way to tweak

772
00:26:16,159 --> 00:26:18,240
the the path to the file system and uh

773
00:26:18,240 --> 00:26:20,400
we can provide a malicious file system

774
00:26:20,400 --> 00:26:20,799
with

775
00:26:20,799 --> 00:26:23,600
only one reverse chain to it and get a

776
00:26:23,600 --> 00:26:25,440
root river chair at the hand

777
00:26:25,440 --> 00:26:28,480
you get the point uh we find a

778
00:26:28,480 --> 00:26:31,600
several way to uh to several

779
00:26:31,600 --> 00:26:33,520
availability on the support station to

780
00:26:33,520 --> 00:26:36,640
to execute arbitrary os command as root

781
00:26:36,640 --> 00:26:36,960
for

782
00:26:36,960 --> 00:26:41,200
unix and linux or system for windows

783
00:26:41,200 --> 00:26:44,880
so let me show you this is basically the

784
00:26:44,880 --> 00:26:45,760
same

785
00:26:45,760 --> 00:26:48,320
demonstration than previously so we

786
00:26:48,320 --> 00:26:49,600
provide

787
00:26:49,600 --> 00:26:52,000
the substitution manager hostname the

788
00:26:52,000 --> 00:26:53,120
port and

789
00:26:53,120 --> 00:26:56,159
it's this whole uh the the sap has

790
00:26:56,159 --> 00:26:58,159
connected to the substitution manager

791
00:26:58,159 --> 00:27:00,559
and this time instead of only get the

792
00:27:00,559 --> 00:27:01,760
river shell from

793
00:27:01,760 --> 00:27:05,039
uh the idm user we try uh

794
00:27:05,039 --> 00:27:08,240
to to to exploit

795
00:27:08,240 --> 00:27:10,799
the vulnerability of the surplus agent

796
00:27:10,799 --> 00:27:12,799
to directly get a root chain

797
00:27:12,799 --> 00:27:14,880
and this is what's up here on the on the

798
00:27:14,880 --> 00:27:16,240
on the left

799
00:27:16,240 --> 00:27:17,760
the first pop-up it's a wheelchair of

800
00:27:17,760 --> 00:27:20,320
the first word system the second purpose

801
00:27:20,320 --> 00:27:22,080
it's a wheelchair again on the second

802
00:27:22,080 --> 00:27:24,000
system the third one is the root chain

803
00:27:24,000 --> 00:27:25,600
on the substitution manager itself

804
00:27:25,600 --> 00:27:27,440
because some solution manager have

805
00:27:27,440 --> 00:27:30,480
smd agent and supposed agent and the

806
00:27:30,480 --> 00:27:31,279
last one is

807
00:27:31,279 --> 00:27:34,880
the same from a windows system

808
00:27:34,880 --> 00:27:38,240
so as you can see this is a a very quick

809
00:27:38,240 --> 00:27:40,559
attack and very valuable because we

810
00:27:40,559 --> 00:27:41,679
basically we use

811
00:27:41,679 --> 00:27:45,760
uh all all we use the same vulnerability

812
00:27:45,760 --> 00:27:48,559
uh are the only distinctions the payload

813
00:27:48,559 --> 00:27:50,799
change but the velocity is the same

814
00:27:50,799 --> 00:27:53,840
um and now i will let parts will explain

815
00:27:53,840 --> 00:27:54,640
how you can

816
00:27:54,640 --> 00:27:57,600
protect about it so we have invested

817
00:27:57,600 --> 00:27:58,799
some time talking about the

818
00:27:58,799 --> 00:28:00,240
vulnerabilities and basically our

819
00:28:00,240 --> 00:28:00,799
research

820
00:28:00,799 --> 00:28:02,320
let's invest some time also in

821
00:28:02,320 --> 00:28:04,000
recommendations so we are going to

822
00:28:04,000 --> 00:28:05,279
divide this part in two

823
00:28:05,279 --> 00:28:06,559
first we are going to talk about

824
00:28:06,559 --> 00:28:08,559
prevention and then after and then we

825
00:28:08,559 --> 00:28:10,240
are going to go for detection

826
00:28:10,240 --> 00:28:12,640
so starting for prevention for the eem

827
00:28:12,640 --> 00:28:14,559
application there is some really step

828
00:28:14,559 --> 00:28:16,000
that you can do which is really

829
00:28:16,000 --> 00:28:18,159
manually you just go to the solution

830
00:28:18,159 --> 00:28:19,600
manager to the configuration of your

831
00:28:19,600 --> 00:28:20,399
application

832
00:28:20,399 --> 00:28:22,559
and you're able to add authentication to

833
00:28:22,559 --> 00:28:24,000
this application

834
00:28:24,000 --> 00:28:25,679
of course this is not the full patch

835
00:28:25,679 --> 00:28:27,440
this is just a half patch

836
00:28:27,440 --> 00:28:30,080
if you have i mean if you are able to

837
00:28:30,080 --> 00:28:31,200
and you should do it

838
00:28:31,200 --> 00:28:33,039
you should go for the full part that was

839
00:28:33,039 --> 00:28:36,159
released by sap on march

840
00:28:36,159 --> 00:28:38,000
for the whole station attack it's almost

841
00:28:38,000 --> 00:28:40,320
the same we don't have unluckily uh okay

842
00:28:40,320 --> 00:28:42,799
kind of safe of half patch we just have

843
00:28:42,799 --> 00:28:44,559
to go and install both patches that were

844
00:28:44,559 --> 00:28:45,279
released

845
00:28:45,279 --> 00:28:46,640
and once you install you will see that

846
00:28:46,640 --> 00:28:48,960
the davm user is no longer available to

847
00:28:48,960 --> 00:28:50,000
execute

848
00:28:50,000 --> 00:28:54,320
host control functions

849
00:28:54,320 --> 00:28:56,080
these previous recommendations were

850
00:28:56,080 --> 00:28:58,320
about application layer right but if we

851
00:28:58,320 --> 00:28:59,200
go to the network

852
00:28:59,200 --> 00:29:00,799
layer there are still things that we can

853
00:29:00,799 --> 00:29:03,120
do for example one of the first things

854
00:29:03,120 --> 00:29:03,679
we can do

855
00:29:03,679 --> 00:29:06,720
is to try to avoid every everyone to

856
00:29:06,720 --> 00:29:08,640
access the solution manager and just

857
00:29:08,640 --> 00:29:11,200
let your sap administrators to go

858
00:29:11,200 --> 00:29:12,559
through a network

859
00:29:12,559 --> 00:29:15,520
and only access the solution manager

860
00:29:15,520 --> 00:29:16,640
featuring this

861
00:29:16,640 --> 00:29:20,080
will will guarantee you two things

862
00:29:20,080 --> 00:29:23,120
first of all uh you will be reducing the

863
00:29:23,120 --> 00:29:24,159
attack surface

864
00:29:24,159 --> 00:29:26,000
which is really important and second of

865
00:29:26,000 --> 00:29:27,279
all uh

866
00:29:27,279 --> 00:29:28,880
you will you will be able to be

867
00:29:28,880 --> 00:29:30,960
protected against future vulnerabilities

868
00:29:30,960 --> 00:29:32,399
that will remain also in the solute

869
00:29:32,399 --> 00:29:33,279
manager

870
00:29:33,279 --> 00:29:35,279
as only your sap administrators will

871
00:29:35,279 --> 00:29:36,799
have access

872
00:29:36,799 --> 00:29:39,200
and remember the solution manager is the

873
00:29:39,200 --> 00:29:40,480
heart of the acp

874
00:29:40,480 --> 00:29:42,320
implementation so therefore keeping as

875
00:29:42,320 --> 00:29:43,840
updated as possible and

876
00:29:43,840 --> 00:29:45,840
as secure as possible is really a

877
00:29:45,840 --> 00:29:48,880
monetary thing to perform

878
00:29:48,880 --> 00:29:50,960
on this slide you have some versions i

879
00:29:50,960 --> 00:29:52,799
mean the safe versions of the affected

880
00:29:52,799 --> 00:29:54,559
components by the vulnerability that we

881
00:29:54,559 --> 00:29:55,679
present today

882
00:29:55,679 --> 00:29:57,760
so what you should do with this slide is

883
00:29:57,760 --> 00:30:00,320
grab these versions go to your company's

884
00:30:00,320 --> 00:30:02,880
sap systems and compare it if you are

885
00:30:02,880 --> 00:30:04,240
under these versions

886
00:30:04,240 --> 00:30:06,559
uh you are vulnerable if you are at

887
00:30:06,559 --> 00:30:08,240
least in these versions you are secured

888
00:30:08,240 --> 00:30:09,679
to the vulnerabilities that we

889
00:30:09,679 --> 00:30:12,159
that we uh discussed today and what i'm

890
00:30:12,159 --> 00:30:14,080
telling you at least in these versions

891
00:30:14,080 --> 00:30:15,760
because the vulnerabilities that we

892
00:30:15,760 --> 00:30:17,600
present today were not the only outcomes

893
00:30:17,600 --> 00:30:19,200
from the reset that we performed

894
00:30:19,200 --> 00:30:21,760
we have reported several uh evidence

895
00:30:21,760 --> 00:30:22,880
during this year

896
00:30:22,880 --> 00:30:25,600
and we have here a completely or

897
00:30:25,600 --> 00:30:26,640
semi-complete list of all the

898
00:30:26,640 --> 00:30:27,840
universities that we're affecting to the

899
00:30:27,840 --> 00:30:29,440
solution manager that we reported

900
00:30:29,440 --> 00:30:31,520
so you should also go through this list

901
00:30:31,520 --> 00:30:34,799
and try to install those patches

902
00:30:34,799 --> 00:30:37,120
in terms of detection what we can do

903
00:30:37,120 --> 00:30:38,880
well for the em application

904
00:30:38,880 --> 00:30:41,840
there is an easy way to go and turn on a

905
00:30:41,840 --> 00:30:42,240
log

906
00:30:42,240 --> 00:30:45,360
from from the web uh from the in fact

907
00:30:45,360 --> 00:30:46,880
from the solution manager

908
00:30:46,880 --> 00:30:49,520
well that will allow you to unlock all

909
00:30:49,520 --> 00:30:50,480
the actions

910
00:30:50,480 --> 00:30:52,480
that this vulnerable application is

911
00:30:52,480 --> 00:30:54,799
doing so afterwards you can go to that

912
00:30:54,799 --> 00:30:56,399
log you can monitor it you can

913
00:30:56,399 --> 00:30:58,559
read it and you can try to understand if

914
00:30:58,559 --> 00:30:59,600
something happened

915
00:30:59,600 --> 00:31:00,799
something happened or something is

916
00:31:00,799 --> 00:31:03,519
happening right now for the host agent

917
00:31:03,519 --> 00:31:04,000
we have

918
00:31:04,000 --> 00:31:06,640
almost the same thing uh and luckily

919
00:31:06,640 --> 00:31:07,760
it's a little more

920
00:31:07,760 --> 00:31:09,679
difficult to turn it on but anyways

921
00:31:09,679 --> 00:31:11,440
there is a guide of sap

922
00:31:11,440 --> 00:31:13,279
telling you step by step how to

923
00:31:13,279 --> 00:31:14,480
configure it so

924
00:31:14,480 --> 00:31:16,640
finally it's really easy and after

925
00:31:16,640 --> 00:31:17,840
configuring you will have two different

926
00:31:17,840 --> 00:31:18,320
logs

927
00:31:18,320 --> 00:31:20,480
that they were they are gonna have a lot

928
00:31:20,480 --> 00:31:21,360
of information

929
00:31:21,360 --> 00:31:24,559
very verbose it will be different

930
00:31:24,559 --> 00:31:26,000
a little bit difficult to parse it but

931
00:31:26,000 --> 00:31:27,360
at least you will have a source of

932
00:31:27,360 --> 00:31:28,799
information where you can get

933
00:31:28,799 --> 00:31:30,480
uh the actions that are happening on

934
00:31:30,480 --> 00:31:31,840
these hot

935
00:31:31,840 --> 00:31:33,519
and right now i will hand out again the

936
00:31:33,519 --> 00:31:35,360
presentation to ivan so he can close

937
00:31:35,360 --> 00:31:38,320
our presentation okay uh as a conclusion

938
00:31:38,320 --> 00:31:39,679
we like to share three

939
00:31:39,679 --> 00:31:42,320
uh three three things the first thing we

940
00:31:42,320 --> 00:31:43,919
would like to to to summarize

941
00:31:43,919 --> 00:31:45,840
the the attacks so remarkably an

942
00:31:45,840 --> 00:31:47,679
attacker can access to

943
00:31:47,679 --> 00:31:50,080
the subswisson manager but this is a

944
00:31:50,080 --> 00:31:52,159
just a little restricted access

945
00:31:52,159 --> 00:31:54,240
but using this access uh without

946
00:31:54,240 --> 00:31:55,279
authentication

947
00:31:55,279 --> 00:31:57,840
using success you can execute command as

948
00:31:57,840 --> 00:31:58,880
the aim on

949
00:31:58,880 --> 00:32:01,760
every single us on the sub landscape and

950
00:32:01,760 --> 00:32:02,240
uh

951
00:32:02,240 --> 00:32:05,279
with this um with this uh with this

952
00:32:05,279 --> 00:32:07,440
this uh this connection as the idea they

953
00:32:07,440 --> 00:32:09,279
can explore some vulnerability and the

954
00:32:09,279 --> 00:32:10,799
support control to execute

955
00:32:10,799 --> 00:32:12,840
a wood command or system command as a

956
00:32:12,840 --> 00:32:14,000
hand

957
00:32:14,000 --> 00:32:16,640
so okay this is very dangerous threat

958
00:32:16,640 --> 00:32:17,440
and

959
00:32:17,440 --> 00:32:19,039
the second thing we like to share it's

960
00:32:19,039 --> 00:32:21,279
uh about post exploitation

961
00:32:21,279 --> 00:32:23,279
this is a classical slide we provide

962
00:32:23,279 --> 00:32:25,120
about process protection on sap system

963
00:32:25,120 --> 00:32:26,399
because it covers

964
00:32:26,399 --> 00:32:28,960
the three big part espionage fraud and

965
00:32:28,960 --> 00:32:30,720
sabotage we would like also

966
00:32:30,720 --> 00:32:32,960
to show you directly what is possible to

967
00:32:32,960 --> 00:32:33,840
do so

968
00:32:33,840 --> 00:32:35,840
this demonstration starts at the end of

969
00:32:35,840 --> 00:32:37,440
the previous one

970
00:32:37,440 --> 00:32:39,840
so now an attacker has a full access of

971
00:32:39,840 --> 00:32:42,480
the system you can retrieve

972
00:32:42,480 --> 00:32:45,840
information of the sap system and he can

973
00:32:45,840 --> 00:32:46,559
try to

974
00:32:46,559 --> 00:32:48,880
log with a malicious user for example

975
00:32:48,880 --> 00:32:50,880
professor moyarti in this case

976
00:32:50,880 --> 00:32:53,120
it's not work but because he has a full

977
00:32:53,120 --> 00:32:54,640
access he can download the script

978
00:32:54,640 --> 00:32:56,080
execute the script and what the script

979
00:32:56,080 --> 00:32:58,720
do is to create the user on the database

980
00:32:58,720 --> 00:33:01,760
to create the sap user directly and of

981
00:33:01,760 --> 00:33:03,679
course this new user

982
00:33:03,679 --> 00:33:07,760
is equivalent of administrator user

983
00:33:07,760 --> 00:33:09,600
now it can do a lot of things for

984
00:33:09,600 --> 00:33:10,799
example um

985
00:33:10,799 --> 00:33:13,919
displays hr data of everyone

986
00:33:13,919 --> 00:33:17,200
in in the company uh so like

987
00:33:17,200 --> 00:33:20,240
yeah bank account salary etc etc

988
00:33:20,240 --> 00:33:22,159
so this is all about we we call

989
00:33:22,159 --> 00:33:23,919
espionage

990
00:33:23,919 --> 00:33:26,000
about fraud what is possible to do very

991
00:33:26,000 --> 00:33:27,519
quickly is to for example

992
00:33:27,519 --> 00:33:30,480
change an iban of of a company so that i

993
00:33:30,480 --> 00:33:31,440
could select

994
00:33:31,440 --> 00:33:33,840
the the the target company for example

995
00:33:33,840 --> 00:33:34,559
depot

996
00:33:34,559 --> 00:33:37,840
very well know french company and the

997
00:33:37,840 --> 00:33:39,200
there are an iban resistor

998
00:33:39,200 --> 00:33:42,159
in the in the system and again you can

999
00:33:42,159 --> 00:33:43,440
execute a script

1000
00:33:43,440 --> 00:33:45,440
to change the sideband very quickly and

1001
00:33:45,440 --> 00:33:47,279
now the iban is changed to uh

1002
00:33:47,279 --> 00:33:49,679
to the attacker one it's meanwhile this

1003
00:33:49,679 --> 00:33:50,720
means the next time

1004
00:33:50,720 --> 00:33:53,200
a monet transfer is done to the to this

1005
00:33:53,200 --> 00:33:54,960
company the money goes

1006
00:33:54,960 --> 00:33:57,360
on the wrong side so this is all about

1007
00:33:57,360 --> 00:33:58,799
fraud

1008
00:33:58,799 --> 00:34:01,120
the last it's a sabotage and of course

1009
00:34:01,120 --> 00:34:02,240
because

1010
00:34:02,240 --> 00:34:04,960
attacker full access to the system it

1011
00:34:04,960 --> 00:34:06,640
can stop the sap system

1012
00:34:06,640 --> 00:34:08,719
delete file delete backup delete

1013
00:34:08,719 --> 00:34:10,159
everything

1014
00:34:10,159 --> 00:34:12,960
so this is everything about post

1015
00:34:12,960 --> 00:34:13,760
exportation

1016
00:34:13,760 --> 00:34:17,359
uh why it's very dangerous

1017
00:34:17,359 --> 00:34:19,679
so the last one the last thing we like

1018
00:34:19,679 --> 00:34:20,639
to share the

1019
00:34:20,639 --> 00:34:23,119
most important thing it's the sub

1020
00:34:23,119 --> 00:34:24,399
solution manager is

1021
00:34:24,399 --> 00:34:27,040
a great product and a powerful product

1022
00:34:27,040 --> 00:34:28,399
but

1023
00:34:28,399 --> 00:34:30,560
it's very very very important to secure

1024
00:34:30,560 --> 00:34:32,960
it so take the sub solution manager

1025
00:34:32,960 --> 00:34:36,000
in your sap security process

1026
00:34:36,000 --> 00:34:38,719
etc etc there are no business data into

1027
00:34:38,719 --> 00:34:39,918
it but

1028
00:34:39,918 --> 00:34:42,800
the the the power of the social managers

1029
00:34:42,800 --> 00:34:43,359
could be

1030
00:34:43,359 --> 00:34:46,879
very dangerous so secure it patch it

1031
00:34:46,879 --> 00:34:50,320
do everything you want you can so also

1032
00:34:50,320 --> 00:34:52,800
we put all the references of the patch

1033
00:34:52,800 --> 00:34:55,119
uh related to whole vulnerability we

1034
00:34:55,119 --> 00:34:55,918
find

1035
00:34:55,918 --> 00:34:58,800
um also thanks for everyone involved in

1036
00:34:58,800 --> 00:34:59,280
this

1037
00:34:59,280 --> 00:35:02,079
in this talk to to perform this talk and

1038
00:35:02,079 --> 00:35:04,160
that's all for now and we wait for your

1039
00:35:04,160 --> 00:35:04,800
question

1040
00:35:04,800 --> 00:35:07,200
thank you

1041
00:35:09,359 --> 00:35:11,520
so thank you everybody for joining to

1042
00:35:11,520 --> 00:35:12,560
this presentation

1043
00:35:12,560 --> 00:35:16,000
i hope you enjoyed all our research

1044
00:35:16,000 --> 00:35:18,240
uh we have been reading only the

1045
00:35:18,240 --> 00:35:20,000
questions that you have asked we have

1046
00:35:20,000 --> 00:35:21,119
only two

1047
00:35:21,119 --> 00:35:23,119
uh so i will answer quickly the the

1048
00:35:23,119 --> 00:35:24,480
first from sofia that

1049
00:35:24,480 --> 00:35:27,119
she asked if we're gonna have the if

1050
00:35:27,119 --> 00:35:28,880
they wanna have the slides

1051
00:35:28,880 --> 00:35:31,359
uh available yes the answer is yes we'll

1052
00:35:31,359 --> 00:35:32,560
know when maybe

1053
00:35:32,560 --> 00:35:35,680
late today or during this week but we

1054
00:35:35,680 --> 00:35:37,280
are not very sure about that

1055
00:35:37,280 --> 00:35:38,640
and the other questions i will leave it

1056
00:35:38,640 --> 00:35:40,640
to again

1057
00:35:40,640 --> 00:35:44,000
yeah there are a question about the

1058
00:35:44,000 --> 00:35:46,400
uh since the variability are within the

1059
00:35:46,400 --> 00:35:47,359
agents

1060
00:35:47,359 --> 00:35:50,079
uh does this issue impact all asap

1061
00:35:50,079 --> 00:35:50,560
system

1062
00:35:50,560 --> 00:35:53,760
not just the salman i'm not sure why

1063
00:35:53,760 --> 00:35:56,000
we're calling this solomon's specific

1064
00:35:56,000 --> 00:35:56,880
vulnerability so

1065
00:35:56,880 --> 00:36:00,320
this is a question um yes it's unpacked

1066
00:36:00,320 --> 00:36:00,720
whole

1067
00:36:00,720 --> 00:36:04,320
sap system with the ssd agent instead

1068
00:36:04,320 --> 00:36:09,599
into it and we call it a salman

1069
00:36:09,599 --> 00:36:13,520
vulnerability because the smd agent

1070
00:36:13,520 --> 00:36:15,920
come with the search the sub solution

1071
00:36:15,920 --> 00:36:17,599
manager solution

1072
00:36:17,599 --> 00:36:20,320
uh so if you have a substitution manager

1073
00:36:20,320 --> 00:36:22,560
you have smd agent but if you are

1074
00:36:22,560 --> 00:36:24,160
if you haven't subscription measured

1075
00:36:24,160 --> 00:36:25,599
it's it's

1076
00:36:25,599 --> 00:36:29,119
very unlikely you haven't tested the

1077
00:36:29,119 --> 00:36:30,160
agent so

1078
00:36:30,160 --> 00:36:33,119
uh the answer is yes whole sap system

1079
00:36:33,119 --> 00:36:33,680
with

1080
00:36:33,680 --> 00:36:36,880
uh the smd agent is uh is impacted by

1081
00:36:36,880 --> 00:36:38,800
this vulnerability

1082
00:36:38,800 --> 00:36:42,079
i hope it answers the question

1083
00:36:42,079 --> 00:36:44,160
yes and sorry but uh we have one

1084
00:36:44,160 --> 00:36:45,200
question more

1085
00:36:45,200 --> 00:36:47,040
from patrick who said we asked will you

1086
00:36:47,040 --> 00:36:48,880
share your scripts too

1087
00:36:48,880 --> 00:36:50,960
uh unfortunately we are not gonna share

1088
00:36:50,960 --> 00:36:52,560
the scripts we don't

1089
00:36:52,560 --> 00:36:56,079
share any kind of exploitation scripts

1090
00:36:56,079 --> 00:36:58,240
so no the answer for that question will

1091
00:36:58,240 --> 00:37:00,800
be no sorry

1092
00:37:00,800 --> 00:37:04,640
uh we got also a question about uh

1093
00:37:04,640 --> 00:37:08,720
how long did this process take uh

1094
00:37:08,720 --> 00:37:10,560
we stopped looking on sub-soil so

1095
00:37:10,560 --> 00:37:13,280
manager in

1096
00:37:13,280 --> 00:37:16,640
december last december if i remember

1097
00:37:16,640 --> 00:37:20,000
we work on december january and february

1098
00:37:20,000 --> 00:37:20,640
on it

1099
00:37:20,640 --> 00:37:23,760
and so for uh

1100
00:37:23,760 --> 00:37:25,760
yeah this is like two two or three

1101
00:37:25,760 --> 00:37:27,520
months uh

1102
00:37:27,520 --> 00:37:30,720
uh two researchers doing uh two two

1103
00:37:30,720 --> 00:37:33,119
months maybe three months

1104
00:37:33,119 --> 00:37:36,160
but we we also find uh

1105
00:37:36,160 --> 00:37:38,000
not only this vulnerability we also find

1106
00:37:38,000 --> 00:37:41,280
uh uh a stock counting but we find like

1107
00:37:41,280 --> 00:37:44,480
uh uh 15 runability

1108
00:37:44,480 --> 00:37:46,320
uh or something like that on on

1109
00:37:46,320 --> 00:37:48,320
substitution manager then the supposed

1110
00:37:48,320 --> 00:37:51,839
control as well

1111
00:37:53,839 --> 00:37:56,000
yeah and we have one more question from

1112
00:37:56,000 --> 00:37:57,040
pedro asking

1113
00:37:57,040 --> 00:37:59,359
if are they similar vulnerabilities with

1114
00:37:59,359 --> 00:38:00,480
oracle

1115
00:38:00,480 --> 00:38:03,599
well i'm particularly myself

1116
00:38:03,599 --> 00:38:06,800
i'm not really into oracle world uh

1117
00:38:06,800 --> 00:38:09,520
but there are some critical

1118
00:38:09,520 --> 00:38:11,520
vulnerabilities that on the onopsis team

1119
00:38:11,520 --> 00:38:12,800
has reported

1120
00:38:12,800 --> 00:38:15,280
so the only thing that i can tell you is

1121
00:38:15,280 --> 00:38:16,960
maybe you can find those

1122
00:38:16,960 --> 00:38:19,280
those binaries and and i don't know and

1123
00:38:19,280 --> 00:38:20,960
try to read from them

1124
00:38:20,960 --> 00:38:23,839
but uh it's really difficult to make to

1125
00:38:23,839 --> 00:38:24,880
basically to

1126
00:38:24,880 --> 00:38:27,200
tell if there is some similarity like

1127
00:38:27,200 --> 00:38:28,720
this in oracle

1128
00:38:28,720 --> 00:38:32,160
so yeah maybe you can go and go out of

1129
00:38:32,160 --> 00:38:34,400
of the resources of anapsys and see one

1130
00:38:34,400 --> 00:38:36,079
with everything that is called big debit

1131
00:38:36,079 --> 00:38:39,280
maybe that will help you

1132
00:38:40,480 --> 00:38:46,560
and i think that's all

1133
00:38:46,560 --> 00:38:48,560
so we have a last question maybe i don't

1134
00:38:48,560 --> 00:38:50,480
know if we have the time so

1135
00:38:50,480 --> 00:38:53,119
what was your experiences with uh the

1136
00:38:53,119 --> 00:38:57,359
where sap response to your disclosure

1137
00:38:58,839 --> 00:39:00,480
uh

1138
00:39:00,480 --> 00:39:04,720
i i i don't think uh

1139
00:39:04,720 --> 00:39:06,079
i don't think i get the question about

1140
00:39:06,079 --> 00:39:07,650
disclosure uh

1141
00:39:07,650 --> 00:39:09,280
[Music]

1142
00:39:09,280 --> 00:39:12,320
basically we share how works with uh sap

1143
00:39:12,320 --> 00:39:15,520
response team and

1144
00:39:15,520 --> 00:39:18,960
so we we will never disclose

1145
00:39:18,960 --> 00:39:22,720
poc or or full or full exploit

1146
00:39:22,720 --> 00:39:25,839
and and

1147
00:39:25,839 --> 00:39:27,920
that's it i don't know if uh if you're

1148
00:39:27,920 --> 00:39:29,520
you're part of you are something to to

1149
00:39:29,520 --> 00:39:31,520
add to this question but

1150
00:39:31,520 --> 00:39:35,200
uh no i think it it's okay the answer

1151
00:39:35,200 --> 00:39:37,440
what i would add is like um

1152
00:39:37,440 --> 00:39:40,240
whenever we whenever we disclose or

1153
00:39:40,240 --> 00:39:42,079
whenever we report one vulnerability to

1154
00:39:42,079 --> 00:39:43,200
sap there are

1155
00:39:43,200 --> 00:39:45,760
uh they were really really quick in

1156
00:39:45,760 --> 00:39:46,480
patching

1157
00:39:46,480 --> 00:39:49,920
this so yeah so close to them

1158
00:39:49,920 --> 00:39:56,160
that they really do it really fast

1159
00:39:56,160 --> 00:39:57,680
and about the response thing i would

1160
00:39:57,680 --> 00:39:59,520
like to say that we

1161
00:39:59,520 --> 00:40:02,000
we we have a very good uh communication

1162
00:40:02,000 --> 00:40:03,119
with the response team

1163
00:40:03,119 --> 00:40:05,839
they they answer very quickly and we we

1164
00:40:05,839 --> 00:40:07,839
work together with teams

1165
00:40:07,839 --> 00:40:10,319
years now it's everything good so that's

1166
00:40:10,319 --> 00:40:11,040
it for

1167
00:40:11,040 --> 00:40:14,079
for us thank you everyone i hope you you

1168
00:40:14,079 --> 00:40:16,400
enjoyed the talk and uh if we have

1169
00:40:16,400 --> 00:40:18,880
a question or everything don't hesitate

1170
00:40:18,880 --> 00:40:19,680
to reach us

1171
00:40:19,680 --> 00:40:22,800
at uh using the platform or or on

1172
00:40:22,800 --> 00:40:24,240
twitter or

1173
00:40:24,240 --> 00:40:29,279
something like that

