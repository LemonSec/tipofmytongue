1
00:00:04,490 --> 00:00:17,840
[Music]

2
00:00:17,840 --> 00:00:18,160
hi

3
00:00:18,160 --> 00:00:19,840
thank you for coming to this black hat

4
00:00:19,840 --> 00:00:21,600
virtual event today i'm going to be

5
00:00:21,600 --> 00:00:23,840
talking to you about detecting 4g base

6
00:00:23,840 --> 00:00:26,080
stations in real time

7
00:00:26,080 --> 00:00:28,640
my name is cooper clinton i'm a senior

8
00:00:28,640 --> 00:00:30,720
security researcher with the eff threat

9
00:00:30,720 --> 00:00:31,439
lab

10
00:00:31,439 --> 00:00:33,440
i have a toddler which should explain

11
00:00:33,440 --> 00:00:34,719
the amount of dad jokes you'll hear in

12
00:00:34,719 --> 00:00:36,000
this presentation

13
00:00:36,000 --> 00:00:37,840
and i'm a former teenage phone freak i

14
00:00:37,840 --> 00:00:39,120
spent a lot of time making

15
00:00:39,120 --> 00:00:40,879
multi-colored boxes back in the day

16
00:00:40,879 --> 00:00:42,879
which might explain why i got into this

17
00:00:42,879 --> 00:00:44,879
work that i'm doing right now

18
00:00:44,879 --> 00:00:47,360
if you haven't heard of eff we are a

19
00:00:47,360 --> 00:00:49,120
member supported non-profit

20
00:00:49,120 --> 00:00:51,039
about half of our funding each year

21
00:00:51,039 --> 00:00:53,360
comes from individual donations from our

22
00:00:53,360 --> 00:00:54,239
members

23
00:00:54,239 --> 00:00:56,079
and we defend civil liberties as they

24
00:00:56,079 --> 00:00:57,600
intersect with technology so we think

25
00:00:57,600 --> 00:00:58,320
that things

26
00:00:58,320 --> 00:01:00,719
like your right to privacy and freedom

27
00:01:00,719 --> 00:01:01,520
of speech

28
00:01:01,520 --> 00:01:04,000
come with you online and exist in

29
00:01:04,000 --> 00:01:06,080
technology as well as in the real world

30
00:01:06,080 --> 00:01:07,680
and we've been doing this work for 30

31
00:01:07,680 --> 00:01:09,520
years ever since 1990

32
00:01:09,520 --> 00:01:10,960
so we have quite a lot of experience

33
00:01:10,960 --> 00:01:12,240
under our belts although of course i

34
00:01:12,240 --> 00:01:14,080
haven't been there that long

35
00:01:14,080 --> 00:01:15,759
i work in the eff threat lab which i'll

36
00:01:15,759 --> 00:01:17,680
get into in a moment but first i want to

37
00:01:17,680 --> 00:01:19,200
talk about my colleague yama and i want

38
00:01:19,200 --> 00:01:20,720
to thank her profusely none of this

39
00:01:20,720 --> 00:01:22,320
research would have been possible

40
00:01:22,320 --> 00:01:24,640
without her hard work and dedication

41
00:01:24,640 --> 00:01:26,000
this is as much her project

42
00:01:26,000 --> 00:01:27,520
as it is mine and unfortunately she

43
00:01:27,520 --> 00:01:29,360
couldn't be here on the stage with me

44
00:01:29,360 --> 00:01:30,000
today

45
00:01:30,000 --> 00:01:31,520
but if you see her in the virtual halls

46
00:01:31,520 --> 00:01:33,040
of virtual black hat please buy her a

47
00:01:33,040 --> 00:01:34,079
virtual beer

48
00:01:34,079 --> 00:01:36,479
or follow her on twitter at rival elf

49
00:01:36,479 --> 00:01:38,240
and this is an actual photo of her she

50
00:01:38,240 --> 00:01:41,920
is indeed a very excited sentient radish

51
00:01:41,920 --> 00:01:44,000
so what does threat lab do threat love

52
00:01:44,000 --> 00:01:45,200
looks at technology

53
00:01:45,200 --> 00:01:48,159
that targets at-risk people this is

54
00:01:48,159 --> 00:01:49,920
activists human rights defenders

55
00:01:49,920 --> 00:01:51,759
journalists domestic abuse victims

56
00:01:51,759 --> 00:01:54,240
immigrants sex workers minority groups

57
00:01:54,240 --> 00:01:57,280
basically anybody who is at risk

58
00:01:57,280 --> 00:02:00,320
of oppression just for simply being who

59
00:02:00,320 --> 00:02:01,759
they are

60
00:02:01,759 --> 00:02:05,040
or or having the beliefs that they have

61
00:02:05,040 --> 00:02:06,479
the goals of the technology that

62
00:02:06,479 --> 00:02:09,038
oppresses these people are typically to

63
00:02:09,038 --> 00:02:10,639
gather intelligence on them or spy on

64
00:02:10,639 --> 00:02:11,920
them especially if they've left the

65
00:02:11,920 --> 00:02:12,720
borders

66
00:02:12,720 --> 00:02:14,400
of the country making it harder to spy

67
00:02:14,400 --> 00:02:15,760
on them through traditional kinetic

68
00:02:15,760 --> 00:02:16,879
means

69
00:02:16,879 --> 00:02:19,840
locating extorting harassing basically

70
00:02:19,840 --> 00:02:21,760
stifling freedom of expression and human

71
00:02:21,760 --> 00:02:24,560
rights of people that you don't like

72
00:02:24,560 --> 00:02:27,680
and why do we do this work well

73
00:02:27,680 --> 00:02:30,400
cyber security and antivirus companies

74
00:02:30,400 --> 00:02:31,920
mostly care about the types of malware

75
00:02:31,920 --> 00:02:33,280
that affect our customers and this is

76
00:02:33,280 --> 00:02:35,040
usually enterprise customers

77
00:02:35,040 --> 00:02:38,400
things like ransomware or

78
00:02:38,400 --> 00:02:40,959
banking trojans financial attacks these

79
00:02:40,959 --> 00:02:41,920
are the sorts of things that affect

80
00:02:41,920 --> 00:02:43,360
their customers and while these things

81
00:02:43,360 --> 00:02:45,519
are important we get to care about the

82
00:02:45,519 --> 00:02:46,959
types of technology that infringe on

83
00:02:46,959 --> 00:02:48,560
civil liberties of human rights of

84
00:02:48,560 --> 00:02:50,640
at-risk people we like to think of

85
00:02:50,640 --> 00:02:52,879
ourselves as the security team for the

86
00:02:52,879 --> 00:02:54,879
people who need it the most and yet can

87
00:02:54,879 --> 00:02:56,400
afford it the least and we get to do

88
00:02:56,400 --> 00:02:56,879
this

89
00:02:56,879 --> 00:02:59,120
by virtue of working for a non-profit we

90
00:02:59,120 --> 00:03:00,640
don't have to worry about keeping and

91
00:03:00,640 --> 00:03:04,080
growing our paying customer base

92
00:03:04,080 --> 00:03:06,080
what are our goals well first and

93
00:03:06,080 --> 00:03:08,239
foremost we want to protect people

94
00:03:08,239 --> 00:03:09,920
we want to make sure that people are

95
00:03:09,920 --> 00:03:11,599
able to express themselves freely

96
00:03:11,599 --> 00:03:12,800
make sure that people are not having

97
00:03:12,800 --> 00:03:14,159
their human rights violated and make

98
00:03:14,159 --> 00:03:16,159
sure that people feel safe and secure

99
00:03:16,159 --> 00:03:17,440
in their computers and in their

100
00:03:17,440 --> 00:03:19,040
technological lives and in their real

101
00:03:19,040 --> 00:03:19,840
lives

102
00:03:19,840 --> 00:03:21,440
we want to broaden our communities

103
00:03:21,440 --> 00:03:22,879
understandings of the threats and

104
00:03:22,879 --> 00:03:24,000
defenses that the

105
00:03:24,000 --> 00:03:26,720
of the threats that they face we want to

106
00:03:26,720 --> 00:03:28,640
we want our communities to know

107
00:03:28,640 --> 00:03:30,879
what the capabilities are of the threat

108
00:03:30,879 --> 00:03:32,480
actors targeting them who those threat

109
00:03:32,480 --> 00:03:34,000
actors might be

110
00:03:34,000 --> 00:03:36,000
and what they can feasibly do to defend

111
00:03:36,000 --> 00:03:37,040
themselves

112
00:03:37,040 --> 00:03:39,040
we want to expose bad actors we want to

113
00:03:39,040 --> 00:03:40,799
make sure that the types of people

114
00:03:40,799 --> 00:03:42,879
that are using technology to violate

115
00:03:42,879 --> 00:03:44,159
human rights and freedom of expression

116
00:03:44,159 --> 00:03:45,280
get exposed

117
00:03:45,280 --> 00:03:47,680
whether they be cyber mercenaries or

118
00:03:47,680 --> 00:03:49,599
whether they be

119
00:03:49,599 --> 00:03:51,280
governments that are violating human

120
00:03:51,280 --> 00:03:52,720
rights we want to make sure that they're

121
00:03:52,720 --> 00:03:54,400
named and shamed and not allowed to do

122
00:03:54,400 --> 00:03:56,239
their work with impunity

123
00:03:56,239 --> 00:03:57,599
and of course because we're a legal

124
00:03:57,599 --> 00:03:59,360
nonprofit we want to make better laws

125
00:03:59,360 --> 00:04:01,120
and better norms in civil society so

126
00:04:01,120 --> 00:04:02,000
that this sort of thing

127
00:04:02,000 --> 00:04:06,239
doesn't keep happening in the past

128
00:04:06,239 --> 00:04:08,080
we've worked on a couple of projects

129
00:04:08,080 --> 00:04:09,280
previously

130
00:04:09,280 --> 00:04:12,720
one is by my colleague eva galperin

131
00:04:12,720 --> 00:04:14,000
and this is the coalition against

132
00:04:14,000 --> 00:04:15,680
stalker ware so stock aware or spouse

133
00:04:15,680 --> 00:04:17,358
wire is a type of malware

134
00:04:17,358 --> 00:04:20,000
that specifically is targeted against

135
00:04:20,000 --> 00:04:20,959
that you would install

136
00:04:20,959 --> 00:04:22,960
on a family member or a spouse or a

137
00:04:22,960 --> 00:04:24,639
significant other to spy on them to

138
00:04:24,639 --> 00:04:26,160
control them

139
00:04:26,160 --> 00:04:28,800
this type of malware wasn't previously

140
00:04:28,800 --> 00:04:30,720
classified as malicious by most

141
00:04:30,720 --> 00:04:31,680
antivirus

142
00:04:31,680 --> 00:04:33,680
vendors it was classified as a

143
00:04:33,680 --> 00:04:35,520
potentially unwanted program and we saw

144
00:04:35,520 --> 00:04:37,040
a problem with that because it's clearly

145
00:04:37,040 --> 00:04:38,160
malicious

146
00:04:38,160 --> 00:04:40,320
uh eva did a lot of lobbying along with

147
00:04:40,320 --> 00:04:42,000
the coalition against dockerware and got

148
00:04:42,000 --> 00:04:43,759
antivirus companies to start marking

149
00:04:43,759 --> 00:04:45,759
stalkerware as malicious

150
00:04:45,759 --> 00:04:48,800
as they should uh in

151
00:04:48,800 --> 00:04:52,080
2018 we spoke at black hat about dark

152
00:04:52,080 --> 00:04:53,040
caracal

153
00:04:53,040 --> 00:04:57,120
this is a this was a threat actor

154
00:04:57,120 --> 00:04:59,840
that was operating uh spying on

155
00:04:59,840 --> 00:05:01,759
civilians in lebanon and was also linked

156
00:05:01,759 --> 00:05:03,039
to a threat actor that was spying on

157
00:05:03,039 --> 00:05:04,080
civilians

158
00:05:04,080 --> 00:05:05,680
uh and human rights defenders and

159
00:05:05,680 --> 00:05:07,919
journalists in kazakhstan

160
00:05:07,919 --> 00:05:10,800
we were able to track this actor down to

161
00:05:10,800 --> 00:05:12,479
operating out of the headquarters of

162
00:05:12,479 --> 00:05:14,240
lebanon's general directorate of general

163
00:05:14,240 --> 00:05:15,039
security

164
00:05:15,039 --> 00:05:16,479
and we think that it was a freelancer

165
00:05:16,479 --> 00:05:18,400
moonlighting for lebanon kazakhstan as

166
00:05:18,400 --> 00:05:20,560
well as doing criminal work

167
00:05:20,560 --> 00:05:22,080
so there's a lot more detail about that

168
00:05:22,080 --> 00:05:23,280
in the report which you can find on the

169
00:05:23,280 --> 00:05:24,479
eff website

170
00:05:24,479 --> 00:05:25,759
but that's not what i'm here to talk

171
00:05:25,759 --> 00:05:27,680
about today

172
00:05:27,680 --> 00:05:29,120
today we're going to talk about cell

173
00:05:29,120 --> 00:05:31,520
site simulators also known as stingrays

174
00:05:31,520 --> 00:05:31,759
or

175
00:05:31,759 --> 00:05:33,840
mc catchers we're going to talk about

176
00:05:33,840 --> 00:05:34,960
how they work

177
00:05:34,960 --> 00:05:36,560
what the previous efforts have been to

178
00:05:36,560 --> 00:05:38,479
detect them we're going to talk about a

179
00:05:38,479 --> 00:05:40,479
new method that eff has come up with to

180
00:05:40,479 --> 00:05:41,520
detect them

181
00:05:41,520 --> 00:05:43,199
and we're going to talk finally about

182
00:05:43,199 --> 00:05:44,720
some ways that we think we can fix the

183
00:05:44,720 --> 00:05:45,780
problem once and for all

184
00:05:45,780 --> 00:05:47,680
[Music]

185
00:05:47,680 --> 00:05:49,120
before we get into it i want to give you

186
00:05:49,120 --> 00:05:51,120
a little bit of terminology

187
00:05:51,120 --> 00:05:53,680
first we have the ue which is just the

188
00:05:53,680 --> 00:05:55,360
phone stands for the user equipment but

189
00:05:55,360 --> 00:05:56,639
every time i say ue

190
00:05:56,639 --> 00:05:59,360
just know that i mean your phone the mc

191
00:05:59,360 --> 00:06:00,720
which is the international mobile

192
00:06:00,720 --> 00:06:02,080
subscriber id

193
00:06:02,080 --> 00:06:04,080
this is the id for the sim card it's

194
00:06:04,080 --> 00:06:05,199
burned into the sim card then it's

195
00:06:05,199 --> 00:06:06,800
unique to each sim card

196
00:06:06,800 --> 00:06:08,560
the imei which is the international

197
00:06:08,560 --> 00:06:10,319
mobile equipment id this is the id for

198
00:06:10,319 --> 00:06:12,000
the hardware the id for the phone

199
00:06:12,000 --> 00:06:14,560
that's again burned into the phone and

200
00:06:14,560 --> 00:06:15,360
doesn't change

201
00:06:15,360 --> 00:06:17,680
and it's unique to each phone the enode

202
00:06:17,680 --> 00:06:19,039
b or the base station

203
00:06:19,039 --> 00:06:20,639
this is what the ue is actually

204
00:06:20,639 --> 00:06:22,720
communicating with this is what's

205
00:06:22,720 --> 00:06:24,880
attached to the antennas uh this is

206
00:06:24,880 --> 00:06:27,039
what's this is the first line in the

207
00:06:27,039 --> 00:06:30,479
cell network the erpson or ear fcn

208
00:06:30,479 --> 00:06:32,800
is a frequency that the ue and the e

209
00:06:32,800 --> 00:06:34,000
node b are communicating

210
00:06:34,000 --> 00:06:36,319
on and the sector is a specific antenna

211
00:06:36,319 --> 00:06:38,000
attached to a base station and each base

212
00:06:38,000 --> 00:06:38,720
station

213
00:06:38,720 --> 00:06:40,470
can have multiple sectors

214
00:06:40,470 --> 00:06:42,560
[Music]

215
00:06:42,560 --> 00:06:44,800
the mib is the master information block

216
00:06:44,800 --> 00:06:47,039
it's broadcast by the enode b and tells

217
00:06:47,039 --> 00:06:48,000
the phone where to

218
00:06:48,000 --> 00:06:50,479
find the sib or system information block

219
00:06:50,479 --> 00:06:52,639
which contains details about the enode b

220
00:06:52,639 --> 00:06:56,000
such as the cell id the mcc the mnc and

221
00:06:56,000 --> 00:06:57,520
the tech which stand for the mobile

222
00:06:57,520 --> 00:06:59,440
country code the mobile network code

223
00:06:59,440 --> 00:07:02,240
and the tracking area code respectively

224
00:07:02,240 --> 00:07:03,919
um and then uh then these are

225
00:07:03,919 --> 00:07:05,840
identifiers that let the

226
00:07:05,840 --> 00:07:08,960
phone or the ue know what so what

227
00:07:08,960 --> 00:07:12,160
what uh what carrier owns this base

228
00:07:12,160 --> 00:07:12,880
station

229
00:07:12,880 --> 00:07:14,880
what country it's in what and what

230
00:07:14,880 --> 00:07:16,160
geographical location

231
00:07:16,160 --> 00:07:19,280
it's in um and then the pllmn is the

232
00:07:19,280 --> 00:07:20,880
public land mobile network this is just

233
00:07:20,880 --> 00:07:25,120
a concatenation of the mcc and the mnc

234
00:07:25,120 --> 00:07:27,280
um i'm also going to use the terms m c

235
00:07:27,280 --> 00:07:28,880
catcher stingray

236
00:07:28,880 --> 00:07:30,720
hailstorm fake base station and cell

237
00:07:30,720 --> 00:07:33,039
site simulator interchangeably

238
00:07:33,039 --> 00:07:34,880
these don't exactly mean the same thing

239
00:07:34,880 --> 00:07:36,800
stingray and hailstorm are

240
00:07:36,800 --> 00:07:39,680
brands of fake base station or cell site

241
00:07:39,680 --> 00:07:41,520
simulator

242
00:07:41,520 --> 00:07:44,479
and mc catcher is one of the things that

243
00:07:44,479 --> 00:07:45,759
a cell site simulator does

244
00:07:45,759 --> 00:07:48,160
but not all mc catchers are full on fake

245
00:07:48,160 --> 00:07:48,960
base stations

246
00:07:48,960 --> 00:07:50,639
some of them operate passively and don't

247
00:07:50,639 --> 00:07:52,000
ever transmit

248
00:07:52,000 --> 00:07:53,280
um but i'm gonna use these

249
00:07:53,280 --> 00:07:54,400
interchangeably and i think for the

250
00:07:54,400 --> 00:07:56,400
purposes of this talk that's fine

251
00:07:56,400 --> 00:07:58,560
also i apologize for this acronym soup

252
00:07:58,560 --> 00:08:00,080
that i've just thrown you into

253
00:08:00,080 --> 00:08:02,080
uh it was as painful for me to learn

254
00:08:02,080 --> 00:08:04,240
about as it uh may be for you to listen

255
00:08:04,240 --> 00:08:05,120
to this talk

256
00:08:05,120 --> 00:08:06,639
but i think you'll pick it up pretty

257
00:08:06,639 --> 00:08:09,039
quickly

258
00:08:09,039 --> 00:08:12,080
so this is a quick diagram of the

259
00:08:12,080 --> 00:08:15,680
lte network topography we have the user

260
00:08:15,680 --> 00:08:16,879
equipment or the phone

261
00:08:16,879 --> 00:08:20,080
which connects to the enode b using the

262
00:08:20,080 --> 00:08:21,360
lte protocol

263
00:08:21,360 --> 00:08:23,360
the enode bs exist in a part of the

264
00:08:23,360 --> 00:08:25,360
network called the eutran

265
00:08:25,360 --> 00:08:27,120
and then the enode b's talk to the back

266
00:08:27,120 --> 00:08:29,120
end which is the enhanced packet core or

267
00:08:29,120 --> 00:08:30,160
epc

268
00:08:30,160 --> 00:08:31,919
the enhanced packet core contains the

269
00:08:31,919 --> 00:08:33,519
mobility management engine which is

270
00:08:33,519 --> 00:08:36,159
responsible for the authentication

271
00:08:36,159 --> 00:08:39,519
and some of the protocol messages

272
00:08:39,519 --> 00:08:41,679
and the epc also contains things for

273
00:08:41,679 --> 00:08:43,679
billing authenticating the user

274
00:08:43,679 --> 00:08:45,839
routing back to the ip network or back

275
00:08:45,839 --> 00:08:47,600
to the phone network

276
00:08:47,600 --> 00:08:50,080
and the data gateways we're not going to

277
00:08:50,080 --> 00:08:52,320
talk about the epc at all in this talk

278
00:08:52,320 --> 00:08:54,160
really our focus in this talk is

279
00:08:54,160 --> 00:08:55,920
specifically about the communications

280
00:08:55,920 --> 00:08:57,760
between the user equipment and the enode

281
00:08:57,760 --> 00:08:58,080
b

282
00:08:58,080 --> 00:08:59,360
and that's really where we're going to

283
00:08:59,360 --> 00:09:02,240
focus so

284
00:09:02,240 --> 00:09:04,399
we started this project because we were

285
00:09:04,399 --> 00:09:05,680
curious

286
00:09:05,680 --> 00:09:08,959
about 4g mc catchers we had a pretty

287
00:09:08,959 --> 00:09:10,720
good idea about how the previous

288
00:09:10,720 --> 00:09:12,240
generation of mc catchers as

289
00:09:12,240 --> 00:09:13,279
characterized

290
00:09:13,279 --> 00:09:15,920
by the stingray worked they worked

291
00:09:15,920 --> 00:09:17,760
natively on 2g and they exploited some

292
00:09:17,760 --> 00:09:20,160
of the really well-known vulnerabilities

293
00:09:20,160 --> 00:09:23,040
in the 2g stack but there was this new

294
00:09:23,040 --> 00:09:24,720
generation of hail of

295
00:09:24,720 --> 00:09:27,040
stink of imps catchers coming up as

296
00:09:27,040 --> 00:09:28,560
characters by the hailstorm

297
00:09:28,560 --> 00:09:30,000
which claimed to be able to operate

298
00:09:30,000 --> 00:09:32,959
natively on 4g and we simply had no idea

299
00:09:32,959 --> 00:09:34,000
how they worked

300
00:09:34,000 --> 00:09:35,680
so i started researching and the first

301
00:09:35,680 --> 00:09:37,600
thing to look at is what actually

302
00:09:37,600 --> 00:09:40,399
changed between 2g and 4g

303
00:09:40,399 --> 00:09:42,560
well there are a few changes which are

304
00:09:42,560 --> 00:09:44,000
pretty significant

305
00:09:44,000 --> 00:09:47,040
one is that the enode b and the user

306
00:09:47,040 --> 00:09:47,760
equipment

307
00:09:47,760 --> 00:09:50,800
mutually authenticate whereas in 2g

308
00:09:50,800 --> 00:09:53,680
the ue authenticated itself to the base

309
00:09:53,680 --> 00:09:54,240
station

310
00:09:54,240 --> 00:09:57,120
which is what the e node b was in 2g but

311
00:09:57,120 --> 00:09:58,080
the base station

312
00:09:58,080 --> 00:09:59,760
never had to authenticate itself or

313
00:09:59,760 --> 00:10:03,040
prove itself to the user equipment

314
00:10:03,040 --> 00:10:05,200
now that's changed and the enode b has

315
00:10:05,200 --> 00:10:06,560
to authenticate itself

316
00:10:06,560 --> 00:10:09,040
as an authentic tower being owned by a

317
00:10:09,040 --> 00:10:10,399
phone company

318
00:10:10,399 --> 00:10:13,279
there's also better encryption in 4g the

319
00:10:13,279 --> 00:10:14,800
not only are the encryption ciphers

320
00:10:14,800 --> 00:10:17,040
better and less easily broken

321
00:10:17,040 --> 00:10:20,480
but in 4g as opposed to 2g the enode b

322
00:10:20,480 --> 00:10:22,399
and the ue must mutually agree on a

323
00:10:22,399 --> 00:10:24,240
cipher as opposed to in 2g

324
00:10:24,240 --> 00:10:26,959
where the u where the base station would

325
00:10:26,959 --> 00:10:29,040
tell the ue what cipher to use and could

326
00:10:29,040 --> 00:10:30,560
tell it to use a null cipher if it

327
00:10:30,560 --> 00:10:32,079
wished to

328
00:10:32,079 --> 00:10:34,800
also in 4g we no longer naively connect

329
00:10:34,800 --> 00:10:36,320
to the strongest tower

330
00:10:36,320 --> 00:10:39,600
instead we connect to a tower

331
00:10:39,600 --> 00:10:41,360
that is chosen through a set of

332
00:10:41,360 --> 00:10:43,360
parameters that we have

333
00:10:43,360 --> 00:10:47,440
so that being the case how do 4g cell

334
00:10:47,440 --> 00:10:49,040
site simulators work

335
00:10:49,040 --> 00:10:51,440
well we had no idea so yamna and i

336
00:10:51,440 --> 00:10:52,959
decided to turn to the

337
00:10:52,959 --> 00:10:55,440
literature and see what we could find

338
00:10:55,440 --> 00:10:56,880
after about a year and a half of

339
00:10:56,880 --> 00:10:58,480
studying all of the relevant academic

340
00:10:58,480 --> 00:10:59,040
literature

341
00:10:59,040 --> 00:11:01,279
yamna wrote a really amazing paper

342
00:11:01,279 --> 00:11:02,640
called gotta catch em all

343
00:11:02,640 --> 00:11:04,640
understanding how mc catchers exploit

344
00:11:04,640 --> 00:11:06,240
cell networks and she titled that

345
00:11:06,240 --> 00:11:06,720
because

346
00:11:06,720 --> 00:11:10,240
she's obsessed with pokemon um

347
00:11:10,240 --> 00:11:14,079
we learned we learned a lot about what

348
00:11:14,079 --> 00:11:16,240
vulnerabilities might be being targeted

349
00:11:16,240 --> 00:11:18,480
by next-gen css and what vulnerabilities

350
00:11:18,480 --> 00:11:20,320
they're taking advantage of

351
00:11:20,320 --> 00:11:23,440
and yamna did a really excellent job of

352
00:11:23,440 --> 00:11:25,279
summarizing all of these vulnerabilities

353
00:11:25,279 --> 00:11:26,880
in a really high level easy to read

354
00:11:26,880 --> 00:11:27,680
framework

355
00:11:27,680 --> 00:11:30,160
and really explained how four gmc

356
00:11:30,160 --> 00:11:32,320
cadgers most likely work

357
00:11:32,320 --> 00:11:33,839
i'm not going to get too in depth on

358
00:11:33,839 --> 00:11:35,760
this because yamna has already done the

359
00:11:35,760 --> 00:11:37,120
research and it's a really excellent

360
00:11:37,120 --> 00:11:37,600
paper

361
00:11:37,600 --> 00:11:39,360
and if this is exciting to you i suggest

362
00:11:39,360 --> 00:11:40,959
you read it

363
00:11:40,959 --> 00:11:43,920
but to talk at a high level we found

364
00:11:43,920 --> 00:11:44,560
that

365
00:11:44,560 --> 00:11:47,040
4g has a bit of a glass jaw and this

366
00:11:47,040 --> 00:11:48,000
glass jaw exists

367
00:11:48,000 --> 00:11:50,800
in pre-authentication vulnerabilities so

368
00:11:50,800 --> 00:11:52,160
even though the user equipment

369
00:11:52,160 --> 00:11:54,000
authenticates the tower

370
00:11:54,000 --> 00:11:56,399
there are still several messages that

371
00:11:56,399 --> 00:11:57,680
the

372
00:11:57,680 --> 00:11:59,920
uh that the ue and the enode send

373
00:11:59,920 --> 00:12:01,200
receive and trust

374
00:12:01,200 --> 00:12:03,360
before authentication ever happens or

375
00:12:03,360 --> 00:12:05,680
without authentication ever happening

376
00:12:05,680 --> 00:12:07,920
um this is the weak spot in which the

377
00:12:07,920 --> 00:12:10,880
vast majority of 4g attacks happen

378
00:12:10,880 --> 00:12:14,560
and this is also the spot in which

379
00:12:14,560 --> 00:12:16,079
your phone's connection can be

380
00:12:16,079 --> 00:12:18,720
downgraded from 4g to 2g

381
00:12:18,720 --> 00:12:20,720
allowing all sorts of other nefarious

382
00:12:20,720 --> 00:12:22,160
attacks to happen that we already well

383
00:12:22,160 --> 00:12:24,000
know about

384
00:12:24,000 --> 00:12:27,279
this is a brief just a brief diagram of

385
00:12:27,279 --> 00:12:31,040
the protocol by which the user equipment

386
00:12:31,040 --> 00:12:33,680
connects to the base station we have the

387
00:12:33,680 --> 00:12:35,200
base station is sending out the frame

388
00:12:35,200 --> 00:12:37,839
synchronization signals and the ue looks

389
00:12:37,839 --> 00:12:39,200
on every

390
00:12:39,200 --> 00:12:40,800
frequency that it knows about for the

391
00:12:40,800 --> 00:12:42,240
synchronization signals

392
00:12:42,240 --> 00:12:44,399
once it finds one it gets the master

393
00:12:44,399 --> 00:12:45,680
information block and the system

394
00:12:45,680 --> 00:12:46,720
information block

395
00:12:46,720 --> 00:12:48,480
and decodes those to see if this is a

396
00:12:48,480 --> 00:12:50,320
tower that belongs to its carrier and

397
00:12:50,320 --> 00:12:52,560
should it connect to it if it is

398
00:12:52,560 --> 00:12:54,720
the phone sends a radio resource control

399
00:12:54,720 --> 00:12:56,560
connection request or rrc connection

400
00:12:56,560 --> 00:12:57,600
request

401
00:12:57,600 --> 00:12:59,760
it gets some information back and then

402
00:12:59,760 --> 00:13:01,360
it sets up the attach request which is

403
00:13:01,360 --> 00:13:04,160
where the authentication finally starts

404
00:13:04,160 --> 00:13:05,680
the authentication finally starts in

405
00:13:05,680 --> 00:13:08,000
step seven but between steps one and six

406
00:13:08,000 --> 00:13:09,760
there's a lot going on

407
00:13:09,760 --> 00:13:12,160
and there are messages that the phone

408
00:13:12,160 --> 00:13:14,079
can send out which can contain its

409
00:13:14,079 --> 00:13:17,200
mz it's imsi or it's

410
00:13:17,200 --> 00:13:19,519
exact gps coordinates it can be

411
00:13:19,519 --> 00:13:21,760
convinced to downgrade to a 2g network

412
00:13:21,760 --> 00:13:23,600
or it can be convinced to hop off the

413
00:13:23,600 --> 00:13:25,200
cellular network entirely

414
00:13:25,200 --> 00:13:27,040
and this is where the dragons live this

415
00:13:27,040 --> 00:13:28,959
is where the entirety of

416
00:13:28,959 --> 00:13:30,880
the attacks that we found are and this

417
00:13:30,880 --> 00:13:32,560
is the part that we're going to concern

418
00:13:32,560 --> 00:13:35,040
ourselves with

419
00:13:35,040 --> 00:13:39,279
so now that we had a good idea about how

420
00:13:39,279 --> 00:13:41,680
4g mcc catchers might work we wanted to

421
00:13:41,680 --> 00:13:44,560
know how often they're being used

422
00:13:44,560 --> 00:13:47,760
and to do this we started looking at

423
00:13:47,760 --> 00:13:49,040
freedom of information

424
00:13:49,040 --> 00:13:50,959
requests these are requests that you can

425
00:13:50,959 --> 00:13:53,120
send to the us government to get

426
00:13:53,120 --> 00:13:54,480
documents from them and sometimes

427
00:13:54,480 --> 00:13:55,760
they're censored but sometimes you get

428
00:13:55,760 --> 00:13:57,600
really interesting things

429
00:13:57,600 --> 00:14:00,320
aclu early earlier this year published a

430
00:14:00,320 --> 00:14:02,079
batch of documents

431
00:14:02,079 --> 00:14:04,480
which just which showed that the us

432
00:14:04,480 --> 00:14:07,199
immigration customs enforcement or ice

433
00:14:07,199 --> 00:14:10,560
between 2017 and 2019 used their cell

434
00:14:10,560 --> 00:14:13,600
site simulator 466 times this is

435
00:14:13,600 --> 00:14:16,720
hundreds of times per year dhs

436
00:14:16,720 --> 00:14:18,079
not to be the department of homeland

437
00:14:18,079 --> 00:14:20,000
security not to be outdone

438
00:14:20,000 --> 00:14:23,519
used their cell site simulator 1885

439
00:14:23,519 --> 00:14:25,040
times between 2013

440
00:14:25,040 --> 00:14:28,320
and 2017. customs and border patrol we

441
00:14:28,320 --> 00:14:30,720
found owns 33 cell size simulators and

442
00:14:30,720 --> 00:14:32,320
we have no idea how many

443
00:14:32,320 --> 00:14:34,079
times they've used those but we can

444
00:14:34,079 --> 00:14:35,680
assume it's quite a lot at least

445
00:14:35,680 --> 00:14:39,279
comparable with dhs and ice

446
00:14:39,360 --> 00:14:41,600
on the other hand oakland the local

447
00:14:41,600 --> 00:14:42,800
police department for the city of

448
00:14:42,800 --> 00:14:43,440
oakland

449
00:14:43,440 --> 00:14:46,240
in 2017 used their cell site simulator

450
00:14:46,240 --> 00:14:47,440
only three times

451
00:14:47,440 --> 00:14:49,920
in 2018 it was used four times and in

452
00:14:49,920 --> 00:14:52,240
2019 it was used just once

453
00:14:52,240 --> 00:14:53,920
and this is according to public reports

454
00:14:53,920 --> 00:14:56,959
that oakland pd has to put out each year

455
00:14:56,959 --> 00:14:59,920
the santa barbara pd on the other hand

456
00:14:59,920 --> 00:15:01,760
according to foia documents that eff

457
00:15:01,760 --> 00:15:02,480
received

458
00:15:02,480 --> 00:15:05,839
used their cell site simulator 231 times

459
00:15:05,839 --> 00:15:07,360
in 2017 alone

460
00:15:07,360 --> 00:15:09,600
this is comparable to how many times ice

461
00:15:09,600 --> 00:15:12,720
uses their cell size simulator but

462
00:15:12,720 --> 00:15:14,639
not every eight not everybody that's

463
00:15:14,639 --> 00:15:16,480
using cell site simulators is subject to

464
00:15:16,480 --> 00:15:18,880
freedom of information requests

465
00:15:18,880 --> 00:15:21,519
we have good evidence that foreign spies

466
00:15:21,519 --> 00:15:22,320
are using

467
00:15:22,320 --> 00:15:25,360
mc catchers or cell site simulators dhs

468
00:15:25,360 --> 00:15:27,120
put out a report a couple of years ago

469
00:15:27,120 --> 00:15:28,639
that showed that they had found cell

470
00:15:28,639 --> 00:15:29,759
site simulators

471
00:15:29,759 --> 00:15:31,279
around the white house and around

472
00:15:31,279 --> 00:15:33,680
washington dc and it makes sense that

473
00:15:33,680 --> 00:15:35,120
foreign spies would want to use these

474
00:15:35,120 --> 00:15:35,920
there's a lot of

475
00:15:35,920 --> 00:15:37,279
information you can gather from a cell

476
00:15:37,279 --> 00:15:38,800
phone and we pretty much live our lives

477
00:15:38,800 --> 00:15:40,160
on cell phones so it's a

478
00:15:40,160 --> 00:15:42,240
it's a perfect spot for a ford spy to be

479
00:15:42,240 --> 00:15:43,199
in

480
00:15:43,199 --> 00:15:45,040
uh we also suspect that cyber

481
00:15:45,040 --> 00:15:46,560
mercenaries are using these

482
00:15:46,560 --> 00:15:49,360
these devices groups such as nso group

483
00:15:49,360 --> 00:15:50,000
have been

484
00:15:50,000 --> 00:15:52,160
uh have been accused of using these by

485
00:15:52,160 --> 00:15:53,759
amnesty international

486
00:15:53,759 --> 00:15:58,160
to spy on a moroccan journalist

487
00:15:58,160 --> 00:16:00,079
using a sell-side simulator to listen

488
00:16:00,079 --> 00:16:01,600
into his calls

489
00:16:01,600 --> 00:16:03,120
and it's even possible that criminals

490
00:16:03,120 --> 00:16:05,040
are using these there's several rumors

491
00:16:05,040 --> 00:16:09,360
that that drug cartels are using mc

492
00:16:09,360 --> 00:16:10,800
catchers to spy on

493
00:16:10,800 --> 00:16:12,959
federal police that are going after them

494
00:16:12,959 --> 00:16:13,920
um and

495
00:16:13,920 --> 00:16:15,600
again it makes sense sell side

496
00:16:15,600 --> 00:16:17,440
simulators at this point are

497
00:16:17,440 --> 00:16:19,600
pretty cheap and pretty easy to build

498
00:16:19,600 --> 00:16:21,360
and not too difficult to operate and

499
00:16:21,360 --> 00:16:22,079
they're certainly

500
00:16:22,079 --> 00:16:25,519
within the budget and capabilities

501
00:16:25,519 --> 00:16:28,160
of an organization like a cartel as well

502
00:16:28,160 --> 00:16:29,600
as an organization like a cyber

503
00:16:29,600 --> 00:16:32,639
mercenary such as nso group

504
00:16:32,639 --> 00:16:35,680
so since we can't foia these groups and

505
00:16:35,680 --> 00:16:37,519
since even freedom of information act

506
00:16:37,519 --> 00:16:39,040
freedom of information act has its

507
00:16:39,040 --> 00:16:40,320
limits and we're not always going to get

508
00:16:40,320 --> 00:16:41,519
the data we want

509
00:16:41,519 --> 00:16:43,680
we turn to detection and we think okay

510
00:16:43,680 --> 00:16:45,680
so can we detect cell site simulators

511
00:16:45,680 --> 00:16:48,880
being used in the wild

512
00:16:49,360 --> 00:16:51,600
so there's a couple of schools of

513
00:16:51,600 --> 00:16:52,880
thought about previous

514
00:16:52,880 --> 00:16:54,720
uh about ways to detect cell size

515
00:16:54,720 --> 00:16:56,880
simulators the first one i'll call app

516
00:16:56,880 --> 00:16:59,519
based and this is characterized by

517
00:16:59,519 --> 00:17:02,000
android m seed catcher detector or aim

518
00:17:02,000 --> 00:17:02,720
section

519
00:17:02,720 --> 00:17:04,720
uh snoop snitch or dar shark which was

520
00:17:04,720 --> 00:17:06,400
released on the black hat stage

521
00:17:06,400 --> 00:17:08,559
um the strengths of these apps so these

522
00:17:08,559 --> 00:17:09,439
are apps that run

523
00:17:09,439 --> 00:17:11,119
on your mobile phone usually an android

524
00:17:11,119 --> 00:17:12,720
phone the strengths of these

525
00:17:12,720 --> 00:17:14,799
are that they are cheap all you have to

526
00:17:14,799 --> 00:17:16,480
have is the app the app is free you got

527
00:17:16,480 --> 00:17:18,240
to have a phone that supports it

528
00:17:18,240 --> 00:17:19,839
but pretty much everyone has an android

529
00:17:19,839 --> 00:17:21,919
phone lying around somewhere

530
00:17:21,919 --> 00:17:24,319
they're easy to use once you get a phone

531
00:17:24,319 --> 00:17:25,520
that will support it

532
00:17:25,520 --> 00:17:27,679
you just start the app and it runs and

533
00:17:27,679 --> 00:17:29,520
it tells you what it finds

534
00:17:29,520 --> 00:17:31,280
the weaknesses of these are that they

535
00:17:31,280 --> 00:17:32,640
have limited data

536
00:17:32,640 --> 00:17:35,360
you with aim 60 you only get the mcc the

537
00:17:35,360 --> 00:17:36,559
mnc the tac

538
00:17:36,559 --> 00:17:37,840
the signal strength and a couple of

539
00:17:37,840 --> 00:17:40,480
other things which is not really enough

540
00:17:40,480 --> 00:17:42,480
to positively determine whether or not

541
00:17:42,480 --> 00:17:44,160
something is an mc catcher

542
00:17:44,160 --> 00:17:46,000
with snoop snitch and darshark you get a

543
00:17:46,000 --> 00:17:47,440
little bit more because they have access

544
00:17:47,440 --> 00:17:49,520
to baseband debugging capabilities

545
00:17:49,520 --> 00:17:51,039
but you still aren't getting all of the

546
00:17:51,039 --> 00:17:52,880
things you need for example you're only

547
00:17:52,880 --> 00:17:54,640
getting the information about the towers

548
00:17:54,640 --> 00:17:56,240
that your phone is connecting to

549
00:17:56,240 --> 00:17:58,080
and not all of the towers in an area and

550
00:17:58,080 --> 00:18:00,240
what if you aren't the target of the mc

551
00:18:00,240 --> 00:18:02,160
catcher

552
00:18:02,160 --> 00:18:05,039
so you also get lots of false positives

553
00:18:05,039 --> 00:18:05,919
the problem is

554
00:18:05,919 --> 00:18:07,760
that a lot of the things that mc

555
00:18:07,760 --> 00:18:10,000
catchers do a lot of the heuristics that

556
00:18:10,000 --> 00:18:11,280
we might look for

557
00:18:11,280 --> 00:18:13,600
are also things that happen naturally in

558
00:18:13,600 --> 00:18:15,280
the cell phone network because the

559
00:18:15,280 --> 00:18:16,240
network

560
00:18:16,240 --> 00:18:18,960
is for lack of a better term janky and

561
00:18:18,960 --> 00:18:20,720
prone to weird errors

562
00:18:20,720 --> 00:18:22,640
and there's no way to determine whether

563
00:18:22,640 --> 00:18:24,240
these are false positives

564
00:18:24,240 --> 00:18:26,320
and parts you know regular like regular

565
00:18:26,320 --> 00:18:27,760
features of the cell phone network

566
00:18:27,760 --> 00:18:29,440
or whether this is somebody actually

567
00:18:29,440 --> 00:18:31,440
acting maliciously and for the same

568
00:18:31,440 --> 00:18:32,640
reason we can't really figure out

569
00:18:32,640 --> 00:18:36,080
whether something is a false negative

570
00:18:36,240 --> 00:18:38,320
the other school of thought on detecting

571
00:18:38,320 --> 00:18:39,520
cell side simulators

572
00:18:39,520 --> 00:18:41,600
is sdr-based or radio-based

573
00:18:41,600 --> 00:18:43,760
software-defined radio

574
00:18:43,760 --> 00:18:45,679
this is characterized by projects like

575
00:18:45,679 --> 00:18:47,600
sea glass out of university of

576
00:18:47,600 --> 00:18:48,559
washington

577
00:18:48,559 --> 00:18:50,559
the sich project by ash wilson or

578
00:18:50,559 --> 00:18:52,480
overwatch which is a proprietary project

579
00:18:52,480 --> 00:18:54,320
being sold to the us government

580
00:18:54,320 --> 00:18:55,760
the strengths of these are that you can

581
00:18:55,760 --> 00:18:57,440
get better data first of all you can get

582
00:18:57,440 --> 00:18:58,160
data from

583
00:18:58,160 --> 00:18:59,760
all of the towers around you not just

584
00:18:59,760 --> 00:19:01,120
the towers that your phone is connecting

585
00:19:01,120 --> 00:19:01,760
to

586
00:19:01,760 --> 00:19:03,919
you can also get lower level information

587
00:19:03,919 --> 00:19:05,600
really the amount of information you can

588
00:19:05,600 --> 00:19:06,160
get

589
00:19:06,160 --> 00:19:08,320
is only limited by your programming

590
00:19:08,320 --> 00:19:10,480
ability and how much you can emulate

591
00:19:10,480 --> 00:19:14,000
the software stack of the user equipment

592
00:19:14,000 --> 00:19:15,760
the weaknesses of these are that they're

593
00:19:15,760 --> 00:19:17,440
harder to set up and use

594
00:19:17,440 --> 00:19:19,120
you have to have hardware you have to

595
00:19:19,120 --> 00:19:21,360
maybe have some programming skills

596
00:19:21,360 --> 00:19:23,360
and the data isn't interpreted for you

597
00:19:23,360 --> 00:19:25,120
usually the data goes into a database

598
00:19:25,120 --> 00:19:26,320
and you have to kind of interpret it

599
00:19:26,320 --> 00:19:27,360
yourself

600
00:19:27,360 --> 00:19:28,960
also you have to buy hardware and it

601
00:19:28,960 --> 00:19:30,960
costs money which you know as opposed to

602
00:19:30,960 --> 00:19:32,240
an app which is free

603
00:19:32,240 --> 00:19:33,840
you may have to spend a few bucks to get

604
00:19:33,840 --> 00:19:35,360
one of these running possibly up to a

605
00:19:35,360 --> 00:19:37,039
few hundred bucks

606
00:19:37,039 --> 00:19:39,600
and you can't transmit because the

607
00:19:39,600 --> 00:19:41,280
hardware used in these usually isn't

608
00:19:41,280 --> 00:19:42,880
licensed for transmitting over the cell

609
00:19:42,880 --> 00:19:44,400
network

610
00:19:44,400 --> 00:19:47,600
so we took a few of these methods

611
00:19:47,600 --> 00:19:51,120
and we started getting some information

612
00:19:51,120 --> 00:19:54,799
that uh from people who were at the

613
00:19:54,799 --> 00:19:56,720
dakota access pipeline protest in

614
00:19:56,720 --> 00:19:58,559
standing rock in north dakota

615
00:19:58,559 --> 00:20:00,240
uh and they were concerned that mc

616
00:20:00,240 --> 00:20:01,679
catchers were being used at their

617
00:20:01,679 --> 00:20:02,720
protests

618
00:20:02,720 --> 00:20:04,720
so we took what we knew about detecting

619
00:20:04,720 --> 00:20:06,240
mc catchers which at the time

620
00:20:06,240 --> 00:20:08,880
was let's install snoop snitch on a

621
00:20:08,880 --> 00:20:09,600
phone

622
00:20:09,600 --> 00:20:12,720
um let's bring out a rtl sdr which maybe

623
00:20:12,720 --> 00:20:14,320
i'll do some

624
00:20:14,320 --> 00:20:16,080
some frequency analysis with and let's

625
00:20:16,080 --> 00:20:18,240
go out there and

626
00:20:18,240 --> 00:20:21,760
we didn't really find anything and

627
00:20:21,760 --> 00:20:23,840
that's because there weren't actually

628
00:20:23,840 --> 00:20:25,200
any 2g towers

629
00:20:25,200 --> 00:20:27,600
legitimate or illegitimate anywhere in

630
00:20:27,600 --> 00:20:30,080
the area of the protests

631
00:20:30,080 --> 00:20:33,520
and i really didn't have any idea what i

632
00:20:33,520 --> 00:20:34,559
was doing with snoop

633
00:20:34,559 --> 00:20:36,080
i didn't have any idea what i was doing

634
00:20:36,080 --> 00:20:38,880
with the sdr but what we figured out

635
00:20:38,880 --> 00:20:40,960
was that if there were cell site

636
00:20:40,960 --> 00:20:43,520
simulators being used at standing rock

637
00:20:43,520 --> 00:20:45,760
they would have to be operating natively

638
00:20:45,760 --> 00:20:48,159
on 4g since there was no 2g

639
00:20:48,159 --> 00:20:52,240
presence whatsoever so this forced us to

640
00:20:52,240 --> 00:20:54,480
forced us to ask the question can we

641
00:20:54,480 --> 00:20:56,559
detect 4g mc catchers

642
00:20:56,559 --> 00:20:58,480
well none of the previous projects were

643
00:20:58,480 --> 00:21:00,840
set up to do this

644
00:21:00,840 --> 00:21:04,080
um sea glass which i find to be the best

645
00:21:04,080 --> 00:21:05,919
project

646
00:21:05,919 --> 00:21:08,159
is looking specifically for heuristics

647
00:21:08,159 --> 00:21:10,159
of two gmc catchers and only looking at

648
00:21:10,159 --> 00:21:11,520
the 2g spectrum

649
00:21:11,520 --> 00:21:13,760
similar with sich and of course the same

650
00:21:13,760 --> 00:21:15,520
with aim 60

651
00:21:15,520 --> 00:21:18,480
and snoop snitch so how can we improve

652
00:21:18,480 --> 00:21:20,080
on the previous attempts well

653
00:21:20,080 --> 00:21:23,200
we like the radio based method because

654
00:21:23,200 --> 00:21:24,880
it gets you lower level data

655
00:21:24,880 --> 00:21:26,400
you can see all the towers not just the

656
00:21:26,400 --> 00:21:28,240
ones that your phone is connecting to

657
00:21:28,240 --> 00:21:30,400
and you can compare that data over time

658
00:21:30,400 --> 00:21:32,000
so let's improve that by first

659
00:21:32,000 --> 00:21:34,159
looking at 4g antennas and looking for

660
00:21:34,159 --> 00:21:36,480
native mc catchers on 4g

661
00:21:36,480 --> 00:21:39,440
and let's also verify the results when

662
00:21:39,440 --> 00:21:39,760
we

663
00:21:39,760 --> 00:21:42,880
see a cell that's suspicious let's go

664
00:21:42,880 --> 00:21:44,880
physically track that down

665
00:21:44,880 --> 00:21:46,960
is it on a tower where it should be

666
00:21:46,960 --> 00:21:49,280
great it's just a cell acting weird

667
00:21:49,280 --> 00:21:51,120
is it on top of a building that's

668
00:21:51,120 --> 00:21:53,360
probably fine it's probably a small cell

669
00:21:53,360 --> 00:21:55,600
is that building an embassy well that's

670
00:21:55,600 --> 00:21:57,360
a little more suspicious

671
00:21:57,360 --> 00:21:59,200
is that not a building at all but in

672
00:21:59,200 --> 00:22:00,559
fact an unmarked van

673
00:22:00,559 --> 00:22:04,320
well that's extremely suspicious so

674
00:22:04,320 --> 00:22:06,320
without further ado i introduce to you

675
00:22:06,320 --> 00:22:08,480
crocodile hunter

676
00:22:08,480 --> 00:22:13,840
and i'll take a sip of water

677
00:22:15,039 --> 00:22:16,799
crocodile hunter is an open source

678
00:22:16,799 --> 00:22:18,080
project

679
00:22:18,080 --> 00:22:20,400
that eff has been working on with me and

680
00:22:20,400 --> 00:22:21,919
yamna have been working on

681
00:22:21,919 --> 00:22:24,400
for the past couple of years it's a

682
00:22:24,400 --> 00:22:26,159
software and a hardware stack

683
00:22:26,159 --> 00:22:28,720
the back end is based on srs lte which

684
00:22:28,720 --> 00:22:29,679
is an open source

685
00:22:29,679 --> 00:22:33,520
lte software stack it emulates

686
00:22:33,520 --> 00:22:36,880
not only the enode b and the user

687
00:22:36,880 --> 00:22:39,679
equipment but also the back end the me

688
00:22:39,679 --> 00:22:40,240
and

689
00:22:40,240 --> 00:22:43,120
some other parts of the back end it's

690
00:22:43,120 --> 00:22:43,760
written in c

691
00:22:43,760 --> 00:22:47,120
plus plus and we use it to scan

692
00:22:47,120 --> 00:22:48,799
all of the towers and communicate with

693
00:22:48,799 --> 00:22:51,280
our front end over a local socket

694
00:22:51,280 --> 00:22:53,360
the front end is written in python and

695
00:22:53,360 --> 00:22:55,600
we use it to get data from the socket

696
00:22:55,600 --> 00:22:57,120
save it to a database run some

697
00:22:57,120 --> 00:22:59,280
heuristics and display tower locations

698
00:22:59,280 --> 00:23:02,080
and of course present the user interface

699
00:23:02,080 --> 00:23:04,240
and we also have an api for sharing data

700
00:23:04,240 --> 00:23:05,520
if you have multiple devices in the

701
00:23:05,520 --> 00:23:07,120
field or multiple research that

702
00:23:07,120 --> 00:23:09,600
researchers that you want to gather data

703
00:23:09,600 --> 00:23:11,760
from

704
00:23:11,760 --> 00:23:13,360
this is a screenshot of the user

705
00:23:13,360 --> 00:23:15,600
interface for crocodile hunter

706
00:23:15,600 --> 00:23:17,600
this is from a scan that me and my

707
00:23:17,600 --> 00:23:19,440
colleague dave moss did in downtown san

708
00:23:19,440 --> 00:23:20,640
francisco

709
00:23:20,640 --> 00:23:22,960
each of these red points each of these

710
00:23:22,960 --> 00:23:25,120
red points and each of these skulls

711
00:23:25,120 --> 00:23:28,320
is the probable location for a cell that

712
00:23:28,320 --> 00:23:29,440
is transmitting

713
00:23:29,440 --> 00:23:32,640
in downtown san francisco now and each

714
00:23:32,640 --> 00:23:33,520
of the skulls

715
00:23:33,520 --> 00:23:35,760
is the probable location for a cell that

716
00:23:35,760 --> 00:23:37,600
we think is suspicious

717
00:23:37,600 --> 00:23:39,810
it's important that i point out that

718
00:23:39,810 --> 00:23:41,600
[Music]

719
00:23:41,600 --> 00:23:43,440
just because a cell is suspicious

720
00:23:43,440 --> 00:23:45,360
doesn't mean it's a cell site simulator

721
00:23:45,360 --> 00:23:46,799
and in fact we think

722
00:23:46,799 --> 00:23:48,799
the vast majorities are probably all of

723
00:23:48,799 --> 00:23:50,720
these most likely all of these

724
00:23:50,720 --> 00:23:52,960
are not cell site simulators but they

725
00:23:52,960 --> 00:23:54,240
are suspicious and they need

726
00:23:54,240 --> 00:23:57,200
further looking at but each one of these

727
00:23:57,200 --> 00:23:58,720
is a different cell

728
00:23:58,720 --> 00:24:00,480
attached to an e node b and many of

729
00:24:00,480 --> 00:24:02,000
these are probably attached to the same

730
00:24:02,000 --> 00:24:02,640
enough b

731
00:24:02,640 --> 00:24:06,080
just different sectors of that unit b

732
00:24:06,080 --> 00:24:07,679
for the hardware stack for crocodile

733
00:24:07,679 --> 00:24:10,080
hunter we use a laptop or a raspberry pi

734
00:24:10,080 --> 00:24:11,440
and a battery for the laptop or

735
00:24:11,440 --> 00:24:12,320
raspberry pi

736
00:24:12,320 --> 00:24:15,440
a usb gps dongle some lte antennas

737
00:24:15,440 --> 00:24:17,279
and a software defined radio compatible

738
00:24:17,279 --> 00:24:19,600
with srs lte

739
00:24:19,600 --> 00:24:21,679
this in this case means that it needs to

740
00:24:21,679 --> 00:24:22,880
be a software defined radio that's

741
00:24:22,880 --> 00:24:25,039
capable of full duplex communication

742
00:24:25,039 --> 00:24:27,120
transmitting and receiving and it needs

743
00:24:27,120 --> 00:24:28,880
to be able to

744
00:24:28,880 --> 00:24:31,840
access the entire bandwidth available to

745
00:24:31,840 --> 00:24:32,320
uh

746
00:24:32,320 --> 00:24:35,440
lte we've tested it on a blade rf and a

747
00:24:35,440 --> 00:24:37,520
edis b200 the blade rf which is the

748
00:24:37,520 --> 00:24:38,960
cheaper of these will set you back about

749
00:24:38,960 --> 00:24:39,840
500

750
00:24:39,840 --> 00:24:41,760
so unfortunately it's not a cheap

751
00:24:41,760 --> 00:24:43,200
hardware stack but if you already have

752
00:24:43,200 --> 00:24:44,559
the equipment or if you can afford to

753
00:24:44,559 --> 00:24:45,919
get it

754
00:24:45,919 --> 00:24:48,480
we it's as cheap as we could make it

755
00:24:48,480 --> 00:24:50,080
this is a picture of the hardware

756
00:24:50,080 --> 00:24:51,360
sitting on my kitchen counter with

757
00:24:51,360 --> 00:24:53,120
crocodile hunter running

758
00:24:53,120 --> 00:24:54,720
as you can see it's fairly compact i

759
00:24:54,720 --> 00:24:56,240
have it spread out here but it easily

760
00:24:56,240 --> 00:24:58,000
fits into a backpack

761
00:24:58,000 --> 00:25:00,000
or it easily fits into a car if you want

762
00:25:00,000 --> 00:25:01,360
to drive around your town and do some

763
00:25:01,360 --> 00:25:05,039
more driving for lte networks

764
00:25:05,520 --> 00:25:08,320
for the workflow we start by decoding

765
00:25:08,320 --> 00:25:08,720
the

766
00:25:08,720 --> 00:25:10,480
master information block and the system

767
00:25:10,480 --> 00:25:12,559
information block for all the cells that

768
00:25:12,559 --> 00:25:14,000
we can see and we get a list of

769
00:25:14,000 --> 00:25:16,159
frequencies to search for

770
00:25:16,159 --> 00:25:17,840
from wiggle from a database called

771
00:25:17,840 --> 00:25:19,360
wiggle and i'll talk more in detail

772
00:25:19,360 --> 00:25:21,039
about each of these in a minute

773
00:25:21,039 --> 00:25:22,880
we map the probabilication of cells we

774
00:25:22,880 --> 00:25:24,480
look for anomalies and then we locate

775
00:25:24,480 --> 00:25:27,600
suspicious cells and confirm our results

776
00:25:27,600 --> 00:25:30,720
so srslte starts by scanning a list of

777
00:25:30,720 --> 00:25:32,960
erf sins or frequencies and it gets this

778
00:25:32,960 --> 00:25:34,720
list of ersons from an open cell

779
00:25:34,720 --> 00:25:36,320
database called wiggle which is run by a

780
00:25:36,320 --> 00:25:37,840
couple of guys as a hobby project but

781
00:25:37,840 --> 00:25:39,039
it's a really great

782
00:25:39,039 --> 00:25:41,200
little war driving app that also

783
00:25:41,200 --> 00:25:43,360
collects cell tower information

784
00:25:43,360 --> 00:25:45,679
and we use the api to query a list of

785
00:25:45,679 --> 00:25:47,200
all the tower all the cells

786
00:25:47,200 --> 00:25:49,279
ever seen in the general geographic area

787
00:25:49,279 --> 00:25:50,400
that we're scanning in

788
00:25:50,400 --> 00:25:51,840
and we get the list of unique

789
00:25:51,840 --> 00:25:53,919
frequencies from that and we only scan

790
00:25:53,919 --> 00:25:55,120
those frequencies

791
00:25:55,120 --> 00:25:56,880
this is for two reasons one there are

792
00:25:56,880 --> 00:25:58,960
way too many frequencies in lte for us

793
00:25:58,960 --> 00:26:01,039
to scan all of them all the time

794
00:26:01,039 --> 00:26:02,960
and two we think that cell site

795
00:26:02,960 --> 00:26:05,200
simulators are going to be operating on

796
00:26:05,200 --> 00:26:06,799
the same frequencies as

797
00:26:06,799 --> 00:26:08,559
legitimate cell towers in the area to

798
00:26:08,559 --> 00:26:10,000
increase the likelihood

799
00:26:10,000 --> 00:26:11,520
that a phone will actually connect to

800
00:26:11,520 --> 00:26:14,640
them so we're scanning these erpsons and

801
00:26:14,640 --> 00:26:15,279
once we

802
00:26:15,279 --> 00:26:18,159
find a primary synchronization signal we

803
00:26:18,159 --> 00:26:19,520
connect to it we

804
00:26:19,520 --> 00:26:21,520
find the mib and we decode that we find

805
00:26:21,520 --> 00:26:23,120
the sieve we decode that

806
00:26:23,120 --> 00:26:24,799
and we send the bib and the sib

807
00:26:24,799 --> 00:26:27,440
information over a socket

808
00:26:27,440 --> 00:26:29,600
where the python front end picks it up

809
00:26:29,600 --> 00:26:32,000
and stores it in a database

810
00:26:32,000 --> 00:26:33,760
in the mysql database that we store it

811
00:26:33,760 --> 00:26:36,000
in we have the id

812
00:26:36,000 --> 00:26:38,960
the mcc the mnc the tac which is the

813
00:26:38,960 --> 00:26:40,640
tracking area code the cell id the

814
00:26:40,640 --> 00:26:42,640
physical id of the

815
00:26:42,640 --> 00:26:44,559
base station the ersin which is the

816
00:26:44,559 --> 00:26:46,720
frequency the latitude and longitude

817
00:26:46,720 --> 00:26:48,400
which we get from our gps of where we

818
00:26:48,400 --> 00:26:49,919
are at when we see the

819
00:26:49,919 --> 00:26:52,960
cell the time stamp when we see the cell

820
00:26:52,960 --> 00:26:53,919
the signal strength

821
00:26:53,919 --> 00:26:56,480
the enode bid the sector id and a bunch

822
00:26:56,480 --> 00:26:57,039
of other

823
00:26:57,039 --> 00:26:59,120
information and of course the raw sib

824
00:26:59,120 --> 00:27:02,399
one for later analysis

825
00:27:03,520 --> 00:27:06,960
we then use that data to map out the

826
00:27:06,960 --> 00:27:08,240
cells or the things that are

827
00:27:08,240 --> 00:27:10,080
transmitting in real time

828
00:27:10,080 --> 00:27:12,159
and we do this using trilateration which

829
00:27:12,159 --> 00:27:13,279
i'll explain in a minute

830
00:27:13,279 --> 00:27:15,679
and distance estimates that we get from

831
00:27:15,679 --> 00:27:17,440
the combination of the frequency that

832
00:27:17,440 --> 00:27:18,960
it's being transmitted on

833
00:27:18,960 --> 00:27:21,600
and the signal strength and using these

834
00:27:21,600 --> 00:27:23,919
we can figure out where the towers are

835
00:27:23,919 --> 00:27:25,520
or where the cells are and we compare

836
00:27:25,520 --> 00:27:27,120
this to a ground truth

837
00:27:27,120 --> 00:27:29,919
such as wiggle or open cell id or fcc

838
00:27:29,919 --> 00:27:30,799
database

839
00:27:30,799 --> 00:27:33,039
to see if this is an actual location for

840
00:27:33,039 --> 00:27:36,159
a known cell that other people have seen

841
00:27:36,159 --> 00:27:38,159
a brief side note about trilateration

842
00:27:38,159 --> 00:27:39,919
versus triangulation

843
00:27:39,919 --> 00:27:41,679
these are not the same thing so for

844
00:27:41,679 --> 00:27:43,760
trilateration

845
00:27:43,760 --> 00:27:46,240
we have three measurements where we know

846
00:27:46,240 --> 00:27:46,799
the

847
00:27:46,799 --> 00:27:48,799
distance of that measurement we know how

848
00:27:48,799 --> 00:27:50,720
far away the transmitter is

849
00:27:50,720 --> 00:27:52,640
but we don't know what direction it is

850
00:27:52,640 --> 00:27:54,080
so we have a radius

851
00:27:54,080 --> 00:27:55,840
and the transmitter has to be somewhere

852
00:27:55,840 --> 00:27:58,080
along the edge of that radius

853
00:27:58,080 --> 00:28:00,399
once we have three measurements we can

854
00:28:00,399 --> 00:28:02,000
plot those three radii

855
00:28:02,000 --> 00:28:04,320
on a map through circles essentially on

856
00:28:04,320 --> 00:28:05,039
a map

857
00:28:05,039 --> 00:28:06,799
and wherever those three circles

858
00:28:06,799 --> 00:28:09,679
intersect is the probable location

859
00:28:09,679 --> 00:28:13,760
for the transmitter the

860
00:28:13,760 --> 00:28:15,600
thing about trilateration that's nice is

861
00:28:15,600 --> 00:28:17,120
that you can do it with only one

862
00:28:17,120 --> 00:28:18,799
omnidirectional antenna

863
00:28:18,799 --> 00:28:20,559
and you can do it just from knowing the

864
00:28:20,559 --> 00:28:21,919
distance away from the thing which can

865
00:28:21,919 --> 00:28:24,000
be calculated with the frequency and the

866
00:28:24,000 --> 00:28:25,440
signal strength that you're receiving it

867
00:28:25,440 --> 00:28:26,720
at

868
00:28:26,720 --> 00:28:29,360
triangulation on the other hand uses two

869
00:28:29,360 --> 00:28:30,320
measurements

870
00:28:30,320 --> 00:28:32,720
and both of these measurements are of a

871
00:28:32,720 --> 00:28:33,919
bearing which is to say

872
00:28:33,919 --> 00:28:36,799
what direction is the signal coming from

873
00:28:36,799 --> 00:28:39,120
you can say the signal is coming from

874
00:28:39,120 --> 00:28:41,520
10 degrees to the northeast and in

875
00:28:41,520 --> 00:28:43,200
another reading the signal was coming

876
00:28:43,200 --> 00:28:43,760
from

877
00:28:43,760 --> 00:28:47,200
360 degrees to the 360 degrees to the

878
00:28:47,200 --> 00:28:48,320
northwest

879
00:28:48,320 --> 00:28:50,399
but we don't know how far away that

880
00:28:50,399 --> 00:28:51,679
reading is coming from only the

881
00:28:51,679 --> 00:28:52,720
direction

882
00:28:52,720 --> 00:28:54,960
but we can plot those lines on a map and

883
00:28:54,960 --> 00:28:56,399
using those two

884
00:28:56,399 --> 00:28:58,320
lines of bearing and the distance away

885
00:28:58,320 --> 00:28:59,840
from each other that the two readings

886
00:28:59,840 --> 00:29:00,399
are

887
00:29:00,399 --> 00:29:02,000
we can figure out where the two lines

888
00:29:02,000 --> 00:29:04,159
intersect and thus where the location

889
00:29:04,159 --> 00:29:07,200
of the transmitter is

890
00:29:07,200 --> 00:29:09,679
for triangulation though you either need

891
00:29:09,679 --> 00:29:10,240
a

892
00:29:10,240 --> 00:29:12,000
directional antenna that's constantly

893
00:29:12,000 --> 00:29:14,070
circling so that you can figure out

894
00:29:14,070 --> 00:29:15,760
[Music]

895
00:29:15,760 --> 00:29:17,919
what the bearing is based on the signal

896
00:29:17,919 --> 00:29:20,159
strength at a certain point

897
00:29:20,159 --> 00:29:22,720
or you need three antennas that are als

898
00:29:22,720 --> 00:29:24,159
that all have their clocks

899
00:29:24,159 --> 00:29:26,399
synced to each other so that you can do

900
00:29:26,399 --> 00:29:28,320
what's called time difference of arrival

901
00:29:28,320 --> 00:29:29,679
analysis and figure out

902
00:29:29,679 --> 00:29:33,279
what angle the signal is coming in from

903
00:29:33,279 --> 00:29:35,840
both of these are harder to achieve

904
00:29:35,840 --> 00:29:37,360
technically as far as the hardware is

905
00:29:37,360 --> 00:29:39,039
concerned it's much easier to just have

906
00:29:39,039 --> 00:29:41,200
one omnidirectional antenna

907
00:29:41,200 --> 00:29:43,200
and estimate the distance and that's why

908
00:29:43,200 --> 00:29:44,559
we chose trilateration instead of

909
00:29:44,559 --> 00:29:46,399
triangulation

910
00:29:46,399 --> 00:29:49,440
so once we've mapped out the cells

911
00:29:49,440 --> 00:29:52,320
we start by looking for anomalies and

912
00:29:52,320 --> 00:29:52,960
what do we

913
00:29:52,960 --> 00:29:54,320
what do i mean when i say we're looking

914
00:29:54,320 --> 00:29:56,399
for anomalies uh we're looking for

915
00:29:56,399 --> 00:29:57,039
things like

916
00:29:57,039 --> 00:29:59,039
cells that move uh usually a cell

917
00:29:59,039 --> 00:30:00,880
shouldn't be driving around town

918
00:30:00,880 --> 00:30:03,440
um cells that change signal strength or

919
00:30:03,440 --> 00:30:04,720
cells that aren't where they should be

920
00:30:04,720 --> 00:30:06,480
if there's a cell here and also that

921
00:30:06,480 --> 00:30:07,440
same cell

922
00:30:07,440 --> 00:30:09,120
is on the other side of town that's

923
00:30:09,120 --> 00:30:10,559
suspicious

924
00:30:10,559 --> 00:30:12,480
cells that change parameters over time

925
00:30:12,480 --> 00:30:14,559
or cells that are missing parameters

926
00:30:14,559 --> 00:30:16,559
or new cells that are popping up these

927
00:30:16,559 --> 00:30:18,159
are all suspicious cells

928
00:30:18,159 --> 00:30:20,240
and again i need to point out that an

929
00:30:20,240 --> 00:30:22,000
anomaly doesn't necessarily

930
00:30:22,000 --> 00:30:24,080
mean that we found a cell site simulator

931
00:30:24,080 --> 00:30:26,000
there are legitimate reasons why cells

932
00:30:26,000 --> 00:30:27,679
might be doing any of these things

933
00:30:27,679 --> 00:30:29,440
and that's why we really have to go

934
00:30:29,440 --> 00:30:32,799
track a cell down and verify it

935
00:30:32,799 --> 00:30:35,520
so there are a few ideas we came up with

936
00:30:35,520 --> 00:30:36,480
for anomalies

937
00:30:36,480 --> 00:30:38,240
that would require transmitting if we

938
00:30:38,240 --> 00:30:40,399
could only connect the cell tower

939
00:30:40,399 --> 00:30:42,799
we could do some things like connect to

940
00:30:42,799 --> 00:30:43,760
the cell tower

941
00:30:43,760 --> 00:30:45,840
request some of the more esoteric parts

942
00:30:45,840 --> 00:30:47,360
of lte and see if it

943
00:30:47,360 --> 00:30:50,480
responds correctly we could do a better

944
00:30:50,480 --> 00:30:52,080
fingerprint of the turrets

945
00:30:52,080 --> 00:30:55,520
of the cell itself we could

946
00:30:55,520 --> 00:30:57,760
see how many paging messages it's

947
00:30:57,760 --> 00:30:59,120
transmitting or see how many other

948
00:30:59,120 --> 00:31:00,880
people are connected to the cell

949
00:31:00,880 --> 00:31:03,279
but we don't do any of that and why

950
00:31:03,279 --> 00:31:04,880
don't we do any of that

951
00:31:04,880 --> 00:31:06,960
well because as the eff lawyers

952
00:31:06,960 --> 00:31:08,720
helpfully pointed out

953
00:31:08,720 --> 00:31:11,679
that would be illegal it turns out that

954
00:31:11,679 --> 00:31:13,120
the software-defined radio

955
00:31:13,120 --> 00:31:15,600
is not licensed to communicate on the

956
00:31:15,600 --> 00:31:17,679
frequencies used by lte

957
00:31:17,679 --> 00:31:19,200
whereas your cell phone and the

958
00:31:19,200 --> 00:31:20,799
specifically the modem in your cell

959
00:31:20,799 --> 00:31:21,519
phone

960
00:31:21,519 --> 00:31:23,039
is licensed to communicate on those

961
00:31:23,039 --> 00:31:25,279
frequencies since we're using an sdr

962
00:31:25,279 --> 00:31:26,399
which is only licensed

963
00:31:26,399 --> 00:31:28,159
test equipment we would need our own

964
00:31:28,159 --> 00:31:29,840
license to transmit on those frequencies

965
00:31:29,840 --> 00:31:31,039
and we think that those would be

966
00:31:31,039 --> 00:31:33,120
difficult for most researchers to get

967
00:31:33,120 --> 00:31:35,200
so we didn't include any of that in our

968
00:31:35,200 --> 00:31:37,120
in our code in the interest of not going

969
00:31:37,120 --> 00:31:38,000
to jail

970
00:31:38,000 --> 00:31:41,760
and not violating fcc regulations

971
00:31:41,760 --> 00:31:45,519
so what have we found so far well

972
00:31:45,519 --> 00:31:47,679
the first test me and my colleague as i

973
00:31:47,679 --> 00:31:48,720
mentioned before me and my colleague

974
00:31:48,720 --> 00:31:50,399
dave moss went out to the dream force

975
00:31:50,399 --> 00:31:52,559
conference in downtown san francisco

976
00:31:52,559 --> 00:31:55,600
in late 2019. uh this is a conference

977
00:31:55,600 --> 00:31:56,799
that takes place in downtown san

978
00:31:56,799 --> 00:31:58,080
francisco and it takes place in

979
00:31:58,080 --> 00:32:00,640
basically all of downtown san francisco

980
00:32:00,640 --> 00:32:01,679
um

981
00:32:01,679 --> 00:32:03,200
me and dave wandered around san

982
00:32:03,200 --> 00:32:04,720
francisco wandered around the park

983
00:32:04,720 --> 00:32:06,960
where dreamforce was taking place and

984
00:32:06,960 --> 00:32:08,559
noticed that there was a little cluster

985
00:32:08,559 --> 00:32:10,080
of suspicious cells

986
00:32:10,080 --> 00:32:11,840
down on the street third street next to

987
00:32:11,840 --> 00:32:13,120
the park

988
00:32:13,120 --> 00:32:14,880
we decided to go investigate it and see

989
00:32:14,880 --> 00:32:16,240
what we could find and we started

990
00:32:16,240 --> 00:32:17,440
walking down the street

991
00:32:17,440 --> 00:32:18,880
looking at our phones trying to figure

992
00:32:18,880 --> 00:32:20,559
out where the cells might be

993
00:32:20,559 --> 00:32:22,880
when suddenly we looked up and saw this

994
00:32:22,880 --> 00:32:23,760
big black

995
00:32:23,760 --> 00:32:26,399
truck parked on the street with a giant

996
00:32:26,399 --> 00:32:27,760
satellite on top of it

997
00:32:27,760 --> 00:32:29,200
pointing at a building about a block

998
00:32:29,200 --> 00:32:29,530
away

999
00:32:29,530 --> 00:32:31,200
[Music]

1000
00:32:31,200 --> 00:32:33,440
because the truck was so obvious and

1001
00:32:33,440 --> 00:32:35,600
also had a logo on the side

1002
00:32:35,600 --> 00:32:37,200
we figured that it was probably not a

1003
00:32:37,200 --> 00:32:38,880
cell site simulator but in fact

1004
00:32:38,880 --> 00:32:42,480
a cell on wheels or a cow this is a

1005
00:32:42,480 --> 00:32:44,559
type of cell that is mobile and is

1006
00:32:44,559 --> 00:32:45,600
brought out to

1007
00:32:45,600 --> 00:32:48,080
a event usually a larger event to

1008
00:32:48,080 --> 00:32:48,720
increase

1009
00:32:48,720 --> 00:32:50,880
the capacity of the cell network in the

1010
00:32:50,880 --> 00:32:52,880
area temporarily

1011
00:32:52,880 --> 00:32:54,640
we knocked on the door of the truck and

1012
00:32:54,640 --> 00:32:56,159
talked to the guys operating it for a

1013
00:32:56,159 --> 00:32:57,919
bit and confirmed that in fact it was a

1014
00:32:57,919 --> 00:32:59,279
cell on wheels

1015
00:32:59,279 --> 00:33:01,840
now you might say this isn't an mc

1016
00:33:01,840 --> 00:33:03,440
catcher cooper this is just a

1017
00:33:03,440 --> 00:33:05,279
stellar wheel this is a legit cell tower

1018
00:33:05,279 --> 00:33:06,799
and

1019
00:33:06,799 --> 00:33:08,640
that is true but we still consider this

1020
00:33:08,640 --> 00:33:11,200
a success because in my opinion a cell

1021
00:33:11,200 --> 00:33:12,159
on wheels is not

1022
00:33:12,159 --> 00:33:14,960
actually that much different from a css

1023
00:33:14,960 --> 00:33:16,320
as far as the heuristics that we're

1024
00:33:16,320 --> 00:33:17,440
looking for

1025
00:33:17,440 --> 00:33:18,960
it's a cell that shows up all of a

1026
00:33:18,960 --> 00:33:21,519
sudden is broadcasting new parameters or

1027
00:33:21,519 --> 00:33:24,559
echoing parameters of other cell towers

1028
00:33:24,559 --> 00:33:27,919
and it's a and it's a

1029
00:33:27,919 --> 00:33:30,159
small cell of lower maybe lower power

1030
00:33:30,159 --> 00:33:31,600
than a typical cell

1031
00:33:31,600 --> 00:33:34,640
um really the main difference between a

1032
00:33:34,640 --> 00:33:35,840
cell on wheels

1033
00:33:35,840 --> 00:33:38,880
and a cell site simulator is a whether

1034
00:33:38,880 --> 00:33:39,519
it's

1035
00:33:39,519 --> 00:33:41,279
exploiting the vulnerabilities of the

1036
00:33:41,279 --> 00:33:42,880
network and

1037
00:33:42,880 --> 00:33:47,440
b who's operating it and for what reason

1038
00:33:47,440 --> 00:33:50,080
so we considered this an excellent proof

1039
00:33:50,080 --> 00:33:50,799
of concept

1040
00:33:50,799 --> 00:33:54,320
we located a anomalous cell and we were

1041
00:33:54,320 --> 00:33:56,799
able to physically track it down

1042
00:33:56,799 --> 00:34:00,000
for our next test i brought

1043
00:34:00,000 --> 00:34:01,679
crocodile hunter to shmukon in

1044
00:34:01,679 --> 00:34:05,120
washington dc in january of 2020

1045
00:34:05,120 --> 00:34:08,719
right before everything went terribly

1046
00:34:08,719 --> 00:34:11,199
and in washington dc we found a couple

1047
00:34:11,199 --> 00:34:13,040
of interesting things

1048
00:34:13,040 --> 00:34:16,079
in two different cases we found enode

1049
00:34:16,079 --> 00:34:19,040
bees that were broadcasting the same id

1050
00:34:19,040 --> 00:34:21,520
but a completely different plmn that is

1051
00:34:21,520 --> 00:34:23,040
to say a completely different country

1052
00:34:23,040 --> 00:34:24,480
code and network code

1053
00:34:24,480 --> 00:34:27,520
even though they had the same id this is

1054
00:34:27,520 --> 00:34:30,159
highly unusual and hasn't happened

1055
00:34:30,159 --> 00:34:32,480
anywhere else that i've seen

1056
00:34:32,480 --> 00:34:37,119
until actually a couple of weeks ago

1057
00:34:37,119 --> 00:34:40,800
um for one of these

1058
00:34:40,800 --> 00:34:42,560
uh for one of these suspicious enough

1059
00:34:42,560 --> 00:34:44,719
bees well most of the time it was

1060
00:34:44,719 --> 00:34:45,520
broadcasting

1061
00:34:45,520 --> 00:34:48,239
mcc of 310 and an mnc of 410 which

1062
00:34:48,239 --> 00:34:50,079
belonged to the us and att

1063
00:34:50,079 --> 00:34:53,119
respectively at one point it broadcast

1064
00:34:53,119 --> 00:34:54,399
an mcc

1065
00:34:54,399 --> 00:34:56,960
mcc of 350 which belongs to the country

1066
00:34:56,960 --> 00:34:58,160
of bermuda

1067
00:34:58,160 --> 00:35:01,760
it broadcast an mnc of 490 which isn't

1068
00:35:01,760 --> 00:35:03,599
used by bermuda but which is in fact

1069
00:35:03,599 --> 00:35:05,920
used in the us by sprint or t-mobile

1070
00:35:05,920 --> 00:35:09,040
but never for a t we find this to be

1071
00:35:09,040 --> 00:35:10,320
highly suspicious

1072
00:35:10,320 --> 00:35:13,119
what's even more suspicious is that it

1073
00:35:13,119 --> 00:35:15,599
is broadcasting on the same e arson or

1074
00:35:15,599 --> 00:35:16,000
the same

1075
00:35:16,000 --> 00:35:19,119
frequency as the legitimate tower and

1076
00:35:19,119 --> 00:35:21,040
it's using the same physical id as the

1077
00:35:21,040 --> 00:35:22,640
legitimate tower

1078
00:35:22,640 --> 00:35:25,599
it also has a different sector id

1079
00:35:25,599 --> 00:35:27,680
meaning a different antenna id

1080
00:35:27,680 --> 00:35:29,920
that never shows up again and a

1081
00:35:29,920 --> 00:35:31,920
different tracking area code this is the

1082
00:35:31,920 --> 00:35:34,000
again the geographical location this

1083
00:35:34,000 --> 00:35:34,960
tracking area code

1084
00:35:34,960 --> 00:35:38,240
also never shows up again

1085
00:35:38,400 --> 00:35:40,320
well in dc we saw another suspicious

1086
00:35:40,320 --> 00:35:42,560
tower this one broadcasting

1087
00:35:42,560 --> 00:35:45,920
the mcc of saint pierre and michelan

1088
00:35:45,920 --> 00:35:47,680
which if you need a point of reference

1089
00:35:47,680 --> 00:35:49,200
this is a tiny island

1090
00:35:49,200 --> 00:35:50,960
off the coast of nova scotia and yeah i

1091
00:35:50,960 --> 00:35:52,480
had to look that up when i

1092
00:35:52,480 --> 00:35:54,160
when i wrote this talk because i had no

1093
00:35:54,160 --> 00:35:55,599
idea where it was

1094
00:35:55,599 --> 00:35:57,760
and it's broadcasting the mnc or network

1095
00:35:57,760 --> 00:36:00,240
code of 451 which isn't used by any

1096
00:36:00,240 --> 00:36:02,240
network anywhere ever

1097
00:36:02,240 --> 00:36:04,000
so we think that these two antennas are

1098
00:36:04,000 --> 00:36:06,560
highly suspicious unfortunately

1099
00:36:06,560 --> 00:36:09,440
i was running around a shmukon with

1100
00:36:09,440 --> 00:36:11,040
crocodile hunter running off a raspberry

1101
00:36:11,040 --> 00:36:12,240
pi in my backpack

1102
00:36:12,240 --> 00:36:13,760
and didn't actually get around to

1103
00:36:13,760 --> 00:36:15,520
looking at the data until after the fact

1104
00:36:15,520 --> 00:36:16,960
when it was already too late

1105
00:36:16,960 --> 00:36:19,599
to go track down the networks so

1106
00:36:19,599 --> 00:36:21,440
unfortunately i wasn't able to verify

1107
00:36:21,440 --> 00:36:22,960
these but we do think that this is

1108
00:36:22,960 --> 00:36:24,640
another great example of how

1109
00:36:24,640 --> 00:36:27,040
uh crocodile hunter can ferret out

1110
00:36:27,040 --> 00:36:30,000
suspicious cells

1111
00:36:30,079 --> 00:36:33,520
we do have ongoing tests we're working

1112
00:36:33,520 --> 00:36:33,839
with

1113
00:36:33,839 --> 00:36:35,680
a group of researchers called the fake

1114
00:36:35,680 --> 00:36:37,440
antenna detection project or fade

1115
00:36:37,440 --> 00:36:39,040
project in latin america

1116
00:36:39,040 --> 00:36:40,320
they've already done some really

1117
00:36:40,320 --> 00:36:42,880
excellent work using sea glass to detect

1118
00:36:42,880 --> 00:36:45,359
suspicious 2g cells in mexico city and

1119
00:36:45,359 --> 00:36:47,200
in other places around latin america

1120
00:36:47,200 --> 00:36:48,960
and we're also working with researchers

1121
00:36:48,960 --> 00:36:51,359
in washington dc in new york city

1122
00:36:51,359 --> 00:36:53,359
and we hope that you'll start deploying

1123
00:36:53,359 --> 00:36:54,880
crocodile hunter in your hometown

1124
00:36:54,880 --> 00:36:56,160
because it's open source

1125
00:36:56,160 --> 00:36:59,440
and we're happy to help in the future

1126
00:36:59,440 --> 00:37:02,079
we want to create better heuristics

1127
00:37:02,079 --> 00:37:03,040
right now i'm

1128
00:37:03,040 --> 00:37:05,440
the heuristics that we have are okay but

1129
00:37:05,440 --> 00:37:07,040
we think that they can be improved on as

1130
00:37:07,040 --> 00:37:08,320
we find more towers

1131
00:37:08,320 --> 00:37:09,760
and we can also improve on these

1132
00:37:09,760 --> 00:37:11,520
heuristics by getting more data

1133
00:37:11,520 --> 00:37:13,280
that we can feed into machine learning

1134
00:37:13,280 --> 00:37:15,599
models to better detect anomalies

1135
00:37:15,599 --> 00:37:17,359
automatically to maybe detect things

1136
00:37:17,359 --> 00:37:19,520
that we wouldn't think about

1137
00:37:19,520 --> 00:37:21,920
so that's a that's a future goal we also

1138
00:37:21,920 --> 00:37:23,760
want to have better location finding

1139
00:37:23,760 --> 00:37:25,920
right now my distance estimates are a

1140
00:37:25,920 --> 00:37:28,000
bit off and when i do find a tower it

1141
00:37:28,000 --> 00:37:29,119
does seem to be

1142
00:37:29,119 --> 00:37:32,320
about 50 meters off or so from the place

1143
00:37:32,320 --> 00:37:33,599
where i mapped it out

1144
00:37:33,599 --> 00:37:34,800
and we want to port it to cheaper

1145
00:37:34,800 --> 00:37:37,280
hardware like i said the blade rf is an

1146
00:37:37,280 --> 00:37:38,720
excellent piece of hardware

1147
00:37:38,720 --> 00:37:40,640
but it's not cheap it costs about 500

1148
00:37:40,640 --> 00:37:42,960
bucks

1149
00:37:43,040 --> 00:37:44,720
so i'd love to be able to run this on

1150
00:37:44,720 --> 00:37:46,720
something cheaper like an rtl sdr

1151
00:37:46,720 --> 00:37:48,880
but that's not going to work but that's

1152
00:37:48,880 --> 00:37:49,839
not gonna work

1153
00:37:49,839 --> 00:37:52,720
as long as uh we're using the software

1154
00:37:52,720 --> 00:37:53,760
stock we currently are

1155
00:37:53,760 --> 00:37:55,440
[Music]

1156
00:37:55,440 --> 00:37:58,560
and finally what's with the name well we

1157
00:37:58,560 --> 00:38:00,320
named it crocodile hunter because as you

1158
00:38:00,320 --> 00:38:01,040
may remember

1159
00:38:01,040 --> 00:38:02,800
the stingray is a brand name for a

1160
00:38:02,800 --> 00:38:04,720
particular cell site simulator

1161
00:38:04,720 --> 00:38:06,560
the stingray is also the animal that

1162
00:38:06,560 --> 00:38:08,560
killed steve irwin the crocodile hunter

1163
00:38:08,560 --> 00:38:10,800
and we simply wanted to pay our respects

1164
00:38:10,800 --> 00:38:12,880
to steve

1165
00:38:12,880 --> 00:38:14,960
finally how can we stop cell site

1166
00:38:14,960 --> 00:38:15,920
simulators

1167
00:38:15,920 --> 00:38:18,960
well we can end 2g support on ios and

1168
00:38:18,960 --> 00:38:21,839
android right now

1169
00:38:22,000 --> 00:38:24,240
2g is still used by some people in some

1170
00:38:24,240 --> 00:38:26,079
countries as their main communication

1171
00:38:26,079 --> 00:38:26,720
method

1172
00:38:26,720 --> 00:38:28,800
and we don't want to stop that but apple

1173
00:38:28,800 --> 00:38:30,880
google and samsung are in a position

1174
00:38:30,880 --> 00:38:32,720
where they could offer the ability to

1175
00:38:32,720 --> 00:38:34,880
toggle off the 2g modem

1176
00:38:34,880 --> 00:38:36,400
for their phones and anybody who's

1177
00:38:36,400 --> 00:38:37,920
concerned about a cell site simulator

1178
00:38:37,920 --> 00:38:39,839
could turn off 2g entirely

1179
00:38:39,839 --> 00:38:42,160
in the us this is a no-brainer as most

1180
00:38:42,160 --> 00:38:44,079
networks have ended their 2g support and

1181
00:38:44,079 --> 00:38:47,119
4g is pretty ubiquitous

1182
00:38:47,119 --> 00:38:50,000
we think that this could be done fairly

1183
00:38:50,000 --> 00:38:51,599
easily with a little bit of engineering

1184
00:38:51,599 --> 00:38:53,040
effort by these companies and we've

1185
00:38:53,040 --> 00:38:54,720
written a blog post encouraging them to

1186
00:38:54,720 --> 00:38:56,400
do so

1187
00:38:56,400 --> 00:38:58,560
this would stop the worst abuses such as

1188
00:38:58,560 --> 00:39:00,079
downgrading phones to 2g

1189
00:39:00,079 --> 00:39:03,280
to listen to content and force force

1190
00:39:03,280 --> 00:39:05,119
more in uh cell site simulators to

1191
00:39:05,119 --> 00:39:07,200
operate natively on 4g only being able

1192
00:39:07,200 --> 00:39:08,880
to get what they can get from there

1193
00:39:08,880 --> 00:39:11,440
which as far as we know is limited to

1194
00:39:11,440 --> 00:39:12,720
location tracking

1195
00:39:12,720 --> 00:39:17,760
and and presence verification

1196
00:39:17,760 --> 00:39:20,480
we also need to eliminate or secure the

1197
00:39:20,480 --> 00:39:22,000
pre-authentication messages

1198
00:39:22,000 --> 00:39:23,680
as i said the pre-authentication is

1199
00:39:23,680 --> 00:39:26,000
really where all of the attacks happen

1200
00:39:26,000 --> 00:39:30,480
and this is true for 4g as well as 5g um

1201
00:39:30,480 --> 00:39:33,920
one interesting proposal is that we have

1202
00:39:33,920 --> 00:39:37,119
tls for all of the messages coming from

1203
00:39:37,119 --> 00:39:39,040
a tower this would be the same as

1204
00:39:39,040 --> 00:39:42,800
the way that https communication happens

1205
00:39:42,800 --> 00:39:44,400
this is an interesting proposal it's

1206
00:39:44,400 --> 00:39:46,160
still only in its infancy

1207
00:39:46,160 --> 00:39:48,320
but there's a really interesting paper

1208
00:39:48,320 --> 00:39:49,520
about it that i've linked here in the

1209
00:39:49,520 --> 00:39:50,960
slides and it'll probably be in the

1210
00:39:50,960 --> 00:39:52,480
notes

1211
00:39:52,480 --> 00:39:54,640
there we need to also create more

1212
00:39:54,640 --> 00:39:56,560
incentives for standards organizations

1213
00:39:56,560 --> 00:39:58,400
like 3gpp

1214
00:39:58,400 --> 00:40:00,800
carriers manufacturers and oems to care

1215
00:40:00,800 --> 00:40:03,040
about user privacy because right now

1216
00:40:03,040 --> 00:40:05,599
user privacy seems to be just about the

1217
00:40:05,599 --> 00:40:06,880
last thing on their mind

1218
00:40:06,880 --> 00:40:10,000
after connectivity and after um

1219
00:40:10,000 --> 00:40:13,280
after accessibility

1220
00:40:13,280 --> 00:40:14,960
none of these are foolproof and none of

1221
00:40:14,960 --> 00:40:16,720
these will stop cell size simulators

1222
00:40:16,720 --> 00:40:17,599
entirely

1223
00:40:17,599 --> 00:40:19,040
but we aren't even doing the bare

1224
00:40:19,040 --> 00:40:20,480
minimum yet and i think we should at

1225
00:40:20,480 --> 00:40:23,040
least do that

1226
00:40:23,040 --> 00:40:24,720
the key takeaways here the things i want

1227
00:40:24,720 --> 00:40:26,480
you to go home with we have a pretty

1228
00:40:26,480 --> 00:40:27,599
good understanding of the

1229
00:40:27,599 --> 00:40:28,960
vulnerabilities in 4g

1230
00:40:28,960 --> 00:40:31,359
and the commercial cell site simulators

1231
00:40:31,359 --> 00:40:32,560
might be exploiting

1232
00:40:32,560 --> 00:40:34,960
thanks to yama's paper none of the

1233
00:40:34,960 --> 00:40:37,119
previous mc catcher detector apps really

1234
00:40:37,119 --> 00:40:38,160
do the job anymore

1235
00:40:38,160 --> 00:40:40,160
and even the ones that are good operate

1236
00:40:40,160 --> 00:40:41,760
only on 2g

1237
00:40:41,760 --> 00:40:43,599
we've come up with a method similar to

1238
00:40:43,599 --> 00:40:45,680
established methods but targeting 4g

1239
00:40:45,680 --> 00:40:47,200
towers natively

1240
00:40:47,200 --> 00:40:48,880
and we think that with a little bit of

1241
00:40:48,880 --> 00:40:50,319
elbow grease and a lot of political

1242
00:40:50,319 --> 00:40:51,920
effort the worst problems of cell site

1243
00:40:51,920 --> 00:40:54,240
simulator abuse can be solved

1244
00:40:54,240 --> 00:40:56,000
before i want to before i go i want to

1245
00:40:56,000 --> 00:40:57,440
say thanks to the following people of

1246
00:40:57,440 --> 00:40:59,599
course huge thanks to yamna again

1247
00:40:59,599 --> 00:41:00,720
none of this project could have been

1248
00:41:00,720 --> 00:41:03,040
done without her definitely check her

1249
00:41:03,040 --> 00:41:04,560
out on twitter she's one of the smartest

1250
00:41:04,560 --> 00:41:06,319
people about this stuff

1251
00:41:06,319 --> 00:41:09,359
that i know and she does great work

1252
00:41:09,359 --> 00:41:11,119
also huge thanks to the whole eff crew

1253
00:41:11,119 --> 00:41:12,480
and especially threat lab couldn't have

1254
00:41:12,480 --> 00:41:14,000
done this without them as well

1255
00:41:14,000 --> 00:41:15,680
and it's a great place to work i want to

1256
00:41:15,680 --> 00:41:17,680
thank andy and bob at wiggle for giving

1257
00:41:17,680 --> 00:41:19,760
me unfettered access to their api and a

1258
00:41:19,760 --> 00:41:21,280
lot of programming advice

1259
00:41:21,280 --> 00:41:23,440
uh thanks to roger pequeiros jover who

1260
00:41:23,440 --> 00:41:25,200
is again one of the smartest people that

1261
00:41:25,200 --> 00:41:25,839
i know

1262
00:41:25,839 --> 00:41:27,760
about cell site simulators and about the

1263
00:41:27,760 --> 00:41:29,119
cell network in general

1264
00:41:29,119 --> 00:41:31,599
i want to thank nima fatemi with kandu

1265
00:41:31,599 --> 00:41:33,040
and surya matu and

1266
00:41:33,040 --> 00:41:36,400
simon uh teetler with with

1267
00:41:36,400 --> 00:41:39,119
the markup who did a lot of testing for

1268
00:41:39,119 --> 00:41:39,520
me

1269
00:41:39,520 --> 00:41:40,960
i want to thank carlos and the fade

1270
00:41:40,960 --> 00:41:42,560
project of course for their ongoing

1271
00:41:42,560 --> 00:41:43,359
testing

1272
00:41:43,359 --> 00:41:44,960
i want to thank carl kosher and peter

1273
00:41:44,960 --> 00:41:46,240
nay and others at the university of

1274
00:41:46,240 --> 00:41:48,240
washington for sea glass i want to thank

1275
00:41:48,240 --> 00:41:50,400
ash wilson with sich and eric escobar

1276
00:41:50,400 --> 00:41:51,839
defcon justice beaver

1277
00:41:51,839 --> 00:41:53,280
and of course last but not least i want

1278
00:41:53,280 --> 00:41:54,800
to thank kristin padgett who has been a

1279
00:41:54,800 --> 00:41:55,839
huge inspiration

1280
00:41:55,839 --> 00:41:57,359
she did the first talks about social set

1281
00:41:57,359 --> 00:41:59,119
team leaders in the hacker community

1282
00:41:59,119 --> 00:42:00,880
and she has also given me a lot of

1283
00:42:00,880 --> 00:42:02,400
amazing advice

1284
00:42:02,400 --> 00:42:04,000
and thank you for listening to the talk

1285
00:42:04,000 --> 00:42:05,680
again my name is cooper clinton i'm a

1286
00:42:05,680 --> 00:42:07,520
senior security researcher with the eff

1287
00:42:07,520 --> 00:42:08,240
threat lab

1288
00:42:08,240 --> 00:42:10,720
you can find me on email cooperq eff.org

1289
00:42:10,720 --> 00:42:11,280
or twitter

1290
00:42:11,280 --> 00:42:13,520
cooper q and you can find the project at

1291
00:42:13,520 --> 00:42:14,800
github.com

1292
00:42:14,800 --> 00:42:18,800
effort effort crocodile hunter

1293
00:42:23,520 --> 00:42:25,839
hi everybody i hope you enjoyed the talk

1294
00:42:25,839 --> 00:42:27,359
uh thanks for all the great questions in

1295
00:42:27,359 --> 00:42:28,400
chat i can't

1296
00:42:28,400 --> 00:42:29,839
stick around too long here on the video

1297
00:42:29,839 --> 00:42:32,000
for any questions um but if you do have

1298
00:42:32,000 --> 00:42:32,880
questions please

1299
00:42:32,880 --> 00:42:35,280
message me uh on the platform or on

1300
00:42:35,280 --> 00:42:37,040
twitter i'm at cooper q

1301
00:42:37,040 --> 00:42:38,880
um and you can find the crocodile hunter

1302
00:42:38,880 --> 00:42:42,000
on eff's github which is uh github.org

1303
00:42:42,000 --> 00:42:43,200
effort

1304
00:42:43,200 --> 00:42:45,520
and you can find our website on eff.org

1305
00:42:45,520 --> 00:42:47,119
and if you like the work we do uh please

1306
00:42:47,119 --> 00:42:47,839
donate

1307
00:42:47,839 --> 00:42:50,160
because all of our most of our yearly

1308
00:42:50,160 --> 00:42:52,079
budget comes from uh individual members

1309
00:42:52,079 --> 00:42:53,119
like yourselves

1310
00:42:53,119 --> 00:42:55,200
so um thank you very much and i'll see

1311
00:42:55,200 --> 00:42:56,160
you around the halls of

1312
00:42:56,160 --> 00:42:59,839
virtual black hat

