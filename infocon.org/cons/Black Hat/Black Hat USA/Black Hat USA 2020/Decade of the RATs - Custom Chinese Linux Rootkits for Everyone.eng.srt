1
00:00:03,930 --> 00:00:14,369
[Music]

2
00:00:15,440 --> 00:00:16,800
thanks for joining me

3
00:00:16,800 --> 00:00:18,720
this is decade of the rats custom

4
00:00:18,720 --> 00:00:20,960
chinese linux rootkits for everyone

5
00:00:20,960 --> 00:00:22,880
i'm kevin levelli director of threat

6
00:00:22,880 --> 00:00:24,800
intelligence at blackberry

7
00:00:24,800 --> 00:00:26,880
now i realize i'm dressed like a lawyer

8
00:00:26,880 --> 00:00:28,640
today and i've been told i look like a

9
00:00:28,640 --> 00:00:29,519
lawyer

10
00:00:29,519 --> 00:00:31,519
but i'm not one so be sure to note the

11
00:00:31,519 --> 00:00:32,640
fine print here

12
00:00:32,640 --> 00:00:34,800
written by actual lawyers and understand

13
00:00:34,800 --> 00:00:36,559
that i'm speaking for myself today

14
00:00:36,559 --> 00:00:39,200
not my employer and before i go any

15
00:00:39,200 --> 00:00:39,840
further

16
00:00:39,840 --> 00:00:41,920
i do want to say a few words of thanks

17
00:00:41,920 --> 00:00:44,239
first to the black hat review board

18
00:00:44,239 --> 00:00:46,399
thanks for inviting me to speak to the

19
00:00:46,399 --> 00:00:48,000
current leadership at blackberry

20
00:00:48,000 --> 00:00:49,760
thank you for the continued opportunity

21
00:00:49,760 --> 00:00:51,520
to do research like this

22
00:00:51,520 --> 00:00:53,440
to anthony freed thanks for getting it

23
00:00:53,440 --> 00:00:55,039
out the door

24
00:00:55,039 --> 00:00:56,320
to the past leaders of the research

25
00:00:56,320 --> 00:00:58,320
department at silence where i started

26
00:00:58,320 --> 00:01:00,640
especially john miller ryan smith and

27
00:01:00,640 --> 00:01:02,160
tom wabashevitz

28
00:01:02,160 --> 00:01:03,840
and jeff tang and the current members of

29
00:01:03,840 --> 00:01:05,519
the applied research team

30
00:01:05,519 --> 00:01:07,119
thanks for your encouragement your

31
00:01:07,119 --> 00:01:09,600
guidance and your support

32
00:01:09,600 --> 00:01:11,280
finally to the person who conducted this

33
00:01:11,280 --> 00:01:12,960
research with me but who wishes to

34
00:01:12,960 --> 00:01:14,159
remain anonymous

35
00:01:14,159 --> 00:01:16,479
researcher x you deserve the largest

36
00:01:16,479 --> 00:01:17,600
measure of thanks

37
00:01:17,600 --> 00:01:19,680
you're one hell of a teammate and that's

38
00:01:19,680 --> 00:01:20,960
rather important given that threaten

39
00:01:20,960 --> 00:01:21,360
tell

40
00:01:21,360 --> 00:01:24,479
is a team effort thanks man

41
00:01:24,479 --> 00:01:26,240
you know that team approach to security

42
00:01:26,240 --> 00:01:27,600
research is worth dwelling on here for a

43
00:01:27,600 --> 00:01:28,479
minute

44
00:01:28,479 --> 00:01:29,920
because no matter where i've gone in my

45
00:01:29,920 --> 00:01:32,000
career i found that a group that's

46
00:01:32,000 --> 00:01:33,280
comprised of people who think

47
00:01:33,280 --> 00:01:34,079
differently

48
00:01:34,079 --> 00:01:35,920
conducts better investigations and gets

49
00:01:35,920 --> 00:01:37,920
better outcomes

50
00:01:37,920 --> 00:01:39,200
that was certainly true of my time in

51
00:01:39,200 --> 00:01:40,960
new york city where i supervised an

52
00:01:40,960 --> 00:01:42,000
investigative squad

53
00:01:42,000 --> 00:01:43,759
at the nation's largest independent and

54
00:01:43,759 --> 00:01:45,840
civilian police oversight agency

55
00:01:45,840 --> 00:01:48,159
a pursuit that seems rather timely these

56
00:01:48,159 --> 00:01:49,520
days

57
00:01:49,520 --> 00:01:51,200
and investigative journalism is also a

58
00:01:51,200 --> 00:01:52,560
team effort

59
00:01:52,560 --> 00:01:53,920
and prior to my time as director of

60
00:01:53,920 --> 00:01:55,680
threat intelligence at blackberry i

61
00:01:55,680 --> 00:01:58,399
filled that role at 60 minutes

62
00:01:58,399 --> 00:01:59,759
tip of the hat here to one of my former

63
00:01:59,759 --> 00:02:01,360
colleagues freelance director of

64
00:02:01,360 --> 00:02:02,640
photography chris albert

65
00:02:02,640 --> 00:02:04,399
who's shooting this right now thanks

66
00:02:04,399 --> 00:02:05,680
brother

67
00:02:05,680 --> 00:02:08,479
now don't worry this talk won't last 60

68
00:02:08,479 --> 00:02:09,119
minutes

69
00:02:09,119 --> 00:02:11,360
it'll only be half as long and before

70
00:02:11,360 --> 00:02:12,319
that time is up

71
00:02:12,319 --> 00:02:13,920
all of you watching at home should come

72
00:02:13,920 --> 00:02:16,640
away with an appreciation for why all my

73
00:02:16,640 --> 00:02:18,239
time in journalism was spent

74
00:02:18,239 --> 00:02:21,440
behind the camera okay chris back up man

75
00:02:21,440 --> 00:02:24,160
nobody wants to see that

76
00:02:24,160 --> 00:02:25,520
you know threat intelligence and

77
00:02:25,520 --> 00:02:27,280
investigative journalism have more in

78
00:02:27,280 --> 00:02:27,760
common

79
00:02:27,760 --> 00:02:30,239
than perhaps you realize and at the risk

80
00:02:30,239 --> 00:02:31,840
of falling into another talk track

81
00:02:31,840 --> 00:02:32,640
already

82
00:02:32,640 --> 00:02:34,239
i'll simply point out three important

83
00:02:34,239 --> 00:02:35,920
areas of overlap because i think it

84
00:02:35,920 --> 00:02:37,599
might help us today

85
00:02:37,599 --> 00:02:40,319
first both are focused on finding hidden

86
00:02:40,319 --> 00:02:41,280
truths

87
00:02:41,280 --> 00:02:44,800
emphasis unhidden second both only work

88
00:02:44,800 --> 00:02:46,800
when people pay attention to them

89
00:02:46,800 --> 00:02:48,840
that is when they result in interesting

90
00:02:48,840 --> 00:02:51,440
narratives ones that make sense of a web

91
00:02:51,440 --> 00:02:52,480
of complex

92
00:02:52,480 --> 00:02:55,760
and arcane and often boring detail

93
00:02:55,760 --> 00:02:58,159
and finally and most importantly both

94
00:02:58,159 --> 00:02:59,920
are motivated by the search for answers

95
00:02:59,920 --> 00:03:03,200
to critical questions so that's what i'm

96
00:03:03,200 --> 00:03:04,720
going to do now

97
00:03:04,720 --> 00:03:06,319
i'm going to pose some key questions

98
00:03:06,319 --> 00:03:07,840
that motivated us

99
00:03:07,840 --> 00:03:09,280
and bring you along on the journey we

100
00:03:09,280 --> 00:03:11,120
took to find the answers

101
00:03:11,120 --> 00:03:13,680
now spoiler alert not every question has

102
00:03:13,680 --> 00:03:15,040
an answer

103
00:03:15,040 --> 00:03:16,800
but instead of wasting your time

104
00:03:16,800 --> 00:03:18,959
explaining things you already know

105
00:03:18,959 --> 00:03:20,720
like how root kits and backdoors

106
00:03:20,720 --> 00:03:22,959
function which i kind of think of is

107
00:03:22,959 --> 00:03:23,519
merely

108
00:03:23,519 --> 00:03:26,000
lifting the hood to gawk at an engine

109
00:03:26,000 --> 00:03:27,360
i'm going to try to impart something i

110
00:03:27,360 --> 00:03:28,400
find more valuable

111
00:03:28,400 --> 00:03:30,959
and no it's not a list of iocs for your

112
00:03:30,959 --> 00:03:32,480
threat intel feed

113
00:03:32,480 --> 00:03:33,680
though i can help you with that if

114
00:03:33,680 --> 00:03:35,680
that's what you're here for

115
00:03:35,680 --> 00:03:37,360
instead i hope to leave you with some

116
00:03:37,360 --> 00:03:38,959
concrete examples of how

117
00:03:38,959 --> 00:03:40,959
to think more critically about how we do

118
00:03:40,959 --> 00:03:42,799
malware analysis

119
00:03:42,799 --> 00:03:44,080
and i'll try to show you how to spot

120
00:03:44,080 --> 00:03:46,000
your own cognitive bias while in the

121
00:03:46,000 --> 00:03:47,920
midst of your research

122
00:03:47,920 --> 00:03:50,159
briefly put i'll show you examples of

123
00:03:50,159 --> 00:03:51,920
how to question your own findings

124
00:03:51,920 --> 00:03:54,239
and how to question your own thinking

125
00:03:54,239 --> 00:03:55,920
now doing both of those things should

126
00:03:55,920 --> 00:03:57,439
help make the overall intelligence

127
00:03:57,439 --> 00:03:57,920
products

128
00:03:57,920 --> 00:03:59,840
that we all create better and more

129
00:03:59,840 --> 00:04:01,760
meaningful

130
00:04:01,760 --> 00:04:03,360
all right so let's begin with the first

131
00:04:03,360 --> 00:04:05,680
question the reason we're all here

132
00:04:05,680 --> 00:04:09,040
that is what exactly did we find

133
00:04:09,040 --> 00:04:10,799
well to begin with we've found a whole

134
00:04:10,799 --> 00:04:12,480
lot of linux malware that's been sitting

135
00:04:12,480 --> 00:04:15,599
unnoticed for a very long time we

136
00:04:15,599 --> 00:04:17,279
started by doing something that i feel

137
00:04:17,279 --> 00:04:18,959
doesn't always happen

138
00:04:18,959 --> 00:04:21,358
in today's infosec community that is too

139
00:04:21,358 --> 00:04:23,040
often focused solely on what's new and

140
00:04:23,040 --> 00:04:24,400
what's next

141
00:04:24,400 --> 00:04:27,600
that is we look behind us

142
00:04:27,600 --> 00:04:29,120
you're sitting down to check on some old

143
00:04:29,120 --> 00:04:30,639
apt activity

144
00:04:30,639 --> 00:04:31,919
and you turn up a new backdoor that

145
00:04:31,919 --> 00:04:33,759
nobody's seen before

146
00:04:33,759 --> 00:04:35,759
and then imagine pulling on that thread

147
00:04:35,759 --> 00:04:36,880
and finding a rootkit

148
00:04:36,880 --> 00:04:39,440
and then bam a whole stack of linux

149
00:04:39,440 --> 00:04:40,720
malware

150
00:04:40,720 --> 00:04:42,720
and it's compiled dynamically and it's

151
00:04:42,720 --> 00:04:44,720
customizable to targets

152
00:04:44,720 --> 00:04:46,639
and then later imagine finding that this

153
00:04:46,639 --> 00:04:49,280
malware is being shared among a splinter

154
00:04:49,280 --> 00:04:49,919
cell

155
00:04:49,919 --> 00:04:51,199
of five different groups that you've

156
00:04:51,199 --> 00:04:53,280
been tracking separately as distinct

157
00:04:53,280 --> 00:04:55,040
chinese apts

158
00:04:55,040 --> 00:04:57,360
but when you look deeper you find

159
00:04:57,360 --> 00:04:59,199
they're all really just derivatives of

160
00:04:59,199 --> 00:05:00,160
the original

161
00:05:00,160 --> 00:05:03,520
when nti group air quotes here

162
00:05:03,520 --> 00:05:06,160
included in these five are vestiges of

163
00:05:06,160 --> 00:05:06,960
the original

164
00:05:06,960 --> 00:05:09,919
kaspersky lab defined when nti group

165
00:05:09,919 --> 00:05:12,000
such as it is these days

166
00:05:12,000 --> 00:05:14,720
but also groups like bronze union better

167
00:05:14,720 --> 00:05:15,759
known to some of you as

168
00:05:15,759 --> 00:05:18,880
apt 27 or emissary panda

169
00:05:18,880 --> 00:05:22,240
a group called pascv a group microsoft

170
00:05:22,240 --> 00:05:25,360
calls lead and which we track as casper

171
00:05:25,360 --> 00:05:26,639
and an emerging group that we're

172
00:05:26,639 --> 00:05:29,199
tracking as win linux splinter

173
00:05:29,199 --> 00:05:30,800
now i'm going to return and untangle

174
00:05:30,800 --> 00:05:32,880
that messy air quoted when nti

175
00:05:32,880 --> 00:05:34,240
attribution statement

176
00:05:34,240 --> 00:05:36,400
a bit later but for now let's get back

177
00:05:36,400 --> 00:05:38,720
to what was in the linux toolset

178
00:05:38,720 --> 00:05:40,880
all right we essentially found six

179
00:05:40,880 --> 00:05:42,080
things

180
00:05:42,080 --> 00:05:44,960
number one there was an installer script

181
00:05:44,960 --> 00:05:46,800
it took a few parameters as arguments

182
00:05:46,800 --> 00:05:48,479
and it was nicely compressed inside of

183
00:05:48,479 --> 00:05:49,840
another script

184
00:05:49,840 --> 00:05:51,440
now this installer script interacted

185
00:05:51,440 --> 00:05:53,120
with a remote build server that was so

186
00:05:53,120 --> 00:05:54,400
easy to use

187
00:05:54,400 --> 00:05:55,759
my seven-year-old can install this

188
00:05:55,759 --> 00:05:57,759
malware in a matter of minutes

189
00:05:57,759 --> 00:05:59,600
just follow the prompts answer a few

190
00:05:59,600 --> 00:06:01,840
simple questions and voila

191
00:06:01,840 --> 00:06:05,520
custom chinese root kits for everyone

192
00:06:05,520 --> 00:06:07,360
the build server item number two on this

193
00:06:07,360 --> 00:06:08,880
list was

194
00:06:08,880 --> 00:06:11,840
to be more precise online only in some

195
00:06:11,840 --> 00:06:12,639
cases

196
00:06:12,639 --> 00:06:15,680
and others it was local to the target

197
00:06:15,680 --> 00:06:17,759
either way though the build server would

198
00:06:17,759 --> 00:06:19,440
custom compile the malware package for

199
00:06:19,440 --> 00:06:20,319
the target

200
00:06:20,319 --> 00:06:22,160
on the fly and then it would be

201
00:06:22,160 --> 00:06:23,600
downloaded to the victim

202
00:06:23,600 --> 00:06:24,960
it's as if attackers were showing off

203
00:06:24,960 --> 00:06:26,800
their best practices for ci

204
00:06:26,800 --> 00:06:28,960
cd you know continuous integration and

205
00:06:28,960 --> 00:06:31,199
continuous delivery

206
00:06:31,199 --> 00:06:33,600
the custom delivery package consisted of

207
00:06:33,600 --> 00:06:34,800
a root kit

208
00:06:34,800 --> 00:06:36,479
a back door complete with an

209
00:06:36,479 --> 00:06:37,919
installation script for the target we're

210
00:06:37,919 --> 00:06:39,120
going to call those items

211
00:06:39,120 --> 00:06:41,919
three and four then there was a bonus

212
00:06:41,919 --> 00:06:42,720
item

213
00:06:42,720 --> 00:06:44,960
number five on the list an attacker

214
00:06:44,960 --> 00:06:46,000
control panel

215
00:06:46,000 --> 00:06:47,919
capable of managing both windows and

216
00:06:47,919 --> 00:06:50,000
linux targets simultaneously

217
00:06:50,000 --> 00:06:51,520
which had its own graphical user

218
00:06:51,520 --> 00:06:53,520
interface another easy button for

219
00:06:53,520 --> 00:06:54,319
attackers

220
00:06:54,319 --> 00:06:57,039
you can see it here next to the list and

221
00:06:57,039 --> 00:06:59,120
finally there was item number six

222
00:06:59,120 --> 00:07:01,919
a botnet better known to the community

223
00:07:01,919 --> 00:07:02,639
as the linux

224
00:07:02,639 --> 00:07:05,919
xor ddos botnet of 2015 fame

225
00:07:05,919 --> 00:07:07,599
and yeah i'm really saying that we

226
00:07:07,599 --> 00:07:09,039
believe winning ti

227
00:07:09,039 --> 00:07:10,880
is responsible for the original linux

228
00:07:10,880 --> 00:07:13,199
xor ddos botnet

229
00:07:13,199 --> 00:07:17,120
more on that later now on the c2 side

230
00:07:17,120 --> 00:07:19,680
we saw a lot of the usual win nti

231
00:07:19,680 --> 00:07:20,479
behavior

232
00:07:20,479 --> 00:07:22,000
but with one or two distinctions worth

233
00:07:22,000 --> 00:07:23,759
mentioning

234
00:07:23,759 --> 00:07:25,599
first among the hard-coded network

235
00:07:25,599 --> 00:07:26,800
callback data

236
00:07:26,800 --> 00:07:30,400
we saw some 10 dot ips some

237
00:07:30,400 --> 00:07:33,440
not all this suggested that there was at

238
00:07:33,440 --> 00:07:34,800
least some command and control

239
00:07:34,800 --> 00:07:35,840
infrastructure

240
00:07:35,840 --> 00:07:37,840
inside the target organization now if

241
00:07:37,840 --> 00:07:39,199
you're a network defender and you wake

242
00:07:39,199 --> 00:07:40,240
up and see that

243
00:07:40,240 --> 00:07:42,000
it's not going to be a good day right

244
00:07:42,000 --> 00:07:44,400
not a welcome sign

245
00:07:44,400 --> 00:07:46,400
indeed it's highly likely that all the

246
00:07:46,400 --> 00:07:47,919
linux malware that we found

247
00:07:47,919 --> 00:07:50,639
was not first stage malware but rather a

248
00:07:50,639 --> 00:07:52,400
persistence tool

249
00:07:52,400 --> 00:07:54,800
a beachhead if you would and that the

250
00:07:54,800 --> 00:07:56,479
compromise of the targets

251
00:07:56,479 --> 00:07:58,639
ran much deeper and was much more well

252
00:07:58,639 --> 00:08:00,720
established

253
00:08:00,720 --> 00:08:02,319
what else did we find we also saw

254
00:08:02,319 --> 00:08:04,639
extensive abuse of legitimate cloud

255
00:08:04,639 --> 00:08:06,639
provider infrastructure

256
00:08:06,639 --> 00:08:08,160
this continues to be a really worrisome

257
00:08:08,160 --> 00:08:09,919
trend that we're tracking

258
00:08:09,919 --> 00:08:11,919
one which dramatically complicates

259
00:08:11,919 --> 00:08:13,919
historical analysis

260
00:08:13,919 --> 00:08:18,000
most of the time oh and by the way we

261
00:08:18,000 --> 00:08:20,160
didn't just find linux malware

262
00:08:20,160 --> 00:08:22,319
you know too often i feel that security

263
00:08:22,319 --> 00:08:24,400
research is focused too narrowly on one

264
00:08:24,400 --> 00:08:25,440
thing

265
00:08:25,440 --> 00:08:27,039
researchers tend to tell us only about

266
00:08:27,039 --> 00:08:28,800
the malware on one platform that they

267
00:08:28,800 --> 00:08:29,360
find

268
00:08:29,360 --> 00:08:32,000
or that they know exists and it's

269
00:08:32,000 --> 00:08:33,440
usually out of context

270
00:08:33,440 --> 00:08:35,440
i mean geopolitical context yeah but

271
00:08:35,440 --> 00:08:37,679
also technical context

272
00:08:37,679 --> 00:08:40,399
if they'd only widen the lens they'd see

273
00:08:40,399 --> 00:08:41,760
that state-backed attackers

274
00:08:41,760 --> 00:08:44,640
almost always target multiple platforms

275
00:08:44,640 --> 00:08:47,279
and that provides some key context

276
00:08:47,279 --> 00:08:49,360
this time we found some of the same

277
00:08:49,360 --> 00:08:50,399
group of attackers

278
00:08:50,399 --> 00:08:52,800
in command of some android malware and

279
00:08:52,800 --> 00:08:54,000
others wielding some windows

280
00:08:54,000 --> 00:08:57,279
malware i'll talk about both today

281
00:08:57,279 --> 00:08:58,640
though i won't say a ton about that

282
00:08:58,640 --> 00:09:01,120
malware here we did write a detailed

283
00:09:01,120 --> 00:09:02,320
white paper that i'll reference in the

284
00:09:02,320 --> 00:09:03,040
last slide

285
00:09:03,040 --> 00:09:04,320
that you can go read if you want to know

286
00:09:04,320 --> 00:09:06,080
more

287
00:09:06,080 --> 00:09:07,360
all right so back to the original

288
00:09:07,360 --> 00:09:09,360
question what did we find

289
00:09:09,360 --> 00:09:11,360
short answer we found an excellent

290
00:09:11,360 --> 00:09:14,399
vantage point on an entire malware suite

291
00:09:14,399 --> 00:09:16,320
and good evidence of a cross-platform

292
00:09:16,320 --> 00:09:19,680
approach to espionage

293
00:09:19,680 --> 00:09:22,720
okay now on to the second question

294
00:09:22,720 --> 00:09:24,800
why is it that now in the year of the

295
00:09:24,800 --> 00:09:27,920
rat we've only just uncovered these rats

296
00:09:27,920 --> 00:09:29,839
the linux versions of which have likely

297
00:09:29,839 --> 00:09:31,920
been out there for nearly a decade

298
00:09:31,920 --> 00:09:33,519
i mean it's not like we don't know this

299
00:09:33,519 --> 00:09:35,360
kind of malware exists

300
00:09:35,360 --> 00:09:36,480
linux malware in the hands of

301
00:09:36,480 --> 00:09:38,000
government-backed groups has been

302
00:09:38,000 --> 00:09:39,760
written about before

303
00:09:39,760 --> 00:09:42,000
kaspersky lab has documented its use by

304
00:09:42,000 --> 00:09:43,680
the russian terla and american equation

305
00:09:43,680 --> 00:09:44,560
group

306
00:09:44,560 --> 00:09:46,080
and among the chinese groups we've seen

307
00:09:46,080 --> 00:09:49,040
research on leviathan or abt40

308
00:09:49,040 --> 00:09:52,480
axiom deep panda and apt41

309
00:09:52,480 --> 00:09:54,880
now there's some more messy when nti

310
00:09:54,880 --> 00:09:56,800
related attribution questions in there

311
00:09:56,800 --> 00:09:58,880
in that laundry list and if you read and

312
00:09:58,880 --> 00:10:00,320
believe intrusion truth

313
00:10:00,320 --> 00:10:01,519
they've done some interesting work to

314
00:10:01,519 --> 00:10:03,680
try to detangle it but you know that's a

315
00:10:03,680 --> 00:10:06,800
tangent i don't want to digress

316
00:10:06,959 --> 00:10:08,880
you know i think as recently as may our

317
00:10:08,880 --> 00:10:10,240
colleagues at chronicle published some

318
00:10:10,240 --> 00:10:12,560
interesting research on ipt41

319
00:10:12,560 --> 00:10:13,839
that's another group we associate with

320
00:10:13,839 --> 00:10:16,480
one nti on their use of linux malware

321
00:10:16,480 --> 00:10:18,240
that even included info about an lcam

322
00:10:18,240 --> 00:10:19,200
rootkit

323
00:10:19,200 --> 00:10:21,760
and the write-ups are there not in great

324
00:10:21,760 --> 00:10:22,480
numbers

325
00:10:22,480 --> 00:10:25,040
but they exist the point here is that we

326
00:10:25,040 --> 00:10:26,240
should be watching for this kind of

327
00:10:26,240 --> 00:10:28,320
thing no

328
00:10:28,320 --> 00:10:29,839
and what about the explosion of av

329
00:10:29,839 --> 00:10:31,040
vendors that we've seen develop in the

330
00:10:31,040 --> 00:10:32,320
last 10 years

331
00:10:32,320 --> 00:10:34,160
if we were all in vegas right now we'd

332
00:10:34,160 --> 00:10:35,839
be steps away from the floor show

333
00:10:35,839 --> 00:10:38,000
where most of the companies in the epp

334
00:10:38,000 --> 00:10:39,120
or edr market

335
00:10:39,120 --> 00:10:41,440
would be carnival barking and luring you

336
00:10:41,440 --> 00:10:42,399
in with swag

337
00:10:42,399 --> 00:10:44,000
so they could show off the latest in

338
00:10:44,000 --> 00:10:46,880
their advanced fill in your buzzwords

339
00:10:46,880 --> 00:10:48,800
here technology

340
00:10:48,800 --> 00:10:50,399
no one can claim there haven't been many

341
00:10:50,399 --> 00:10:52,160
bites at the apple

342
00:10:52,160 --> 00:10:54,800
so what gives let's consider some

343
00:10:54,800 --> 00:10:55,839
possibilities

344
00:10:55,839 --> 00:10:57,519
which may in turn give us some insight

345
00:10:57,519 --> 00:10:59,440
into the attackers in their strategy

346
00:10:59,440 --> 00:11:01,040
now we use that word strategy here

347
00:11:01,040 --> 00:11:02,959
because our conclusion was that the

348
00:11:02,959 --> 00:11:04,480
targeting of these linux servers

349
00:11:04,480 --> 00:11:07,680
was strategic in nature now first

350
00:11:07,680 --> 00:11:09,440
i don't have to tell anybody in this

351
00:11:09,440 --> 00:11:11,519
audience why the always-on

352
00:11:11,519 --> 00:11:13,440
always-available nature of linux makes

353
00:11:13,440 --> 00:11:15,040
it a great beachhead

354
00:11:15,040 --> 00:11:16,800
i mean how often do you take off your

355
00:11:16,800 --> 00:11:18,800
web server or your database server how

356
00:11:18,800 --> 00:11:20,240
often do you take those down

357
00:11:20,240 --> 00:11:21,440
is it is it somewhere in the

358
00:11:21,440 --> 00:11:23,279
neighborhood of never

359
00:11:23,279 --> 00:11:25,760
i don't have to tell you that linuxrun

360
00:11:25,760 --> 00:11:27,040
servers constitute critical

361
00:11:27,040 --> 00:11:28,640
infrastructure within the government

362
00:11:28,640 --> 00:11:30,000
agencies and businesses

363
00:11:30,000 --> 00:11:32,800
that make up modern society linux runs

364
00:11:32,800 --> 00:11:34,320
not just web servers and database

365
00:11:34,320 --> 00:11:35,120
servers

366
00:11:35,120 --> 00:11:38,640
but also proxy servers file servers vpn

367
00:11:38,640 --> 00:11:39,600
servers

368
00:11:39,600 --> 00:11:42,160
help stock exchange servers it's

369
00:11:42,160 --> 00:11:43,920
embedded in iot

370
00:11:43,920 --> 00:11:46,160
it's embedded in network appliances it's

371
00:11:46,160 --> 00:11:48,959
embedded in cars

372
00:11:48,959 --> 00:11:50,480
and i don't have to point out to this

373
00:11:50,480 --> 00:11:52,320
audience that linux run

374
00:11:52,320 --> 00:11:54,079
web servers are perfect for hiding

375
00:11:54,079 --> 00:11:56,160
massive amounts of exfiltrated data

376
00:11:56,160 --> 00:11:58,320
or that attacking linux jump boxes

377
00:11:58,320 --> 00:12:00,399
erases a key layer of protection for an

378
00:12:00,399 --> 00:12:01,600
organization

379
00:12:01,600 --> 00:12:03,600
or that linux database servers offer

380
00:12:03,600 --> 00:12:04,880
attackers pretty much

381
00:12:04,880 --> 00:12:07,120
one-stop shopping for crown jewels

382
00:12:07,120 --> 00:12:08,880
material like passwords or

383
00:12:08,880 --> 00:12:10,800
trade secrets or other intellectual

384
00:12:10,800 --> 00:12:12,720
property

385
00:12:12,720 --> 00:12:14,160
but think for a minute about the people

386
00:12:14,160 --> 00:12:15,760
who've never seen the inside of a rack

387
00:12:15,760 --> 00:12:16,959
room

388
00:12:16,959 --> 00:12:18,480
what about the people who sign the

389
00:12:18,480 --> 00:12:21,040
paychecks or make the big decisions

390
00:12:21,040 --> 00:12:22,720
how often does the word linux enter

391
00:12:22,720 --> 00:12:25,360
their conversations

392
00:12:25,360 --> 00:12:27,040
second for those of us who've had the

393
00:12:27,040 --> 00:12:28,720
opportunity to work for vendors

394
00:12:28,720 --> 00:12:31,519
tell me how do your epp and edr

395
00:12:31,519 --> 00:12:32,800
offerings for linux

396
00:12:32,800 --> 00:12:34,160
compare to your offerings for mac and

397
00:12:34,160 --> 00:12:35,839
windows

398
00:12:35,839 --> 00:12:37,360
put it this way how many linux deals

399
00:12:37,360 --> 00:12:39,519
does your sales team close

400
00:12:39,519 --> 00:12:41,839
i'm willing to wager that in general

401
00:12:41,839 --> 00:12:43,600
security industry support

402
00:12:43,600 --> 00:12:45,440
of the myriad linux distro and kernel

403
00:12:45,440 --> 00:12:47,760
combinations pales in comparison to the

404
00:12:47,760 --> 00:12:49,120
support given to windows

405
00:12:49,120 --> 00:12:51,680
it's just economics you supply the

406
00:12:51,680 --> 00:12:52,480
engineering

407
00:12:52,480 --> 00:12:54,959
and marketing and sales effort behind

408
00:12:54,959 --> 00:12:56,240
the platform that creates the most

409
00:12:56,240 --> 00:12:57,760
demand

410
00:12:57,760 --> 00:12:59,519
but a consequence of that is that

411
00:12:59,519 --> 00:13:01,440
detection of linux malware

412
00:13:01,440 --> 00:13:03,200
particularly complicated malware like we

413
00:13:03,200 --> 00:13:07,279
found might turn out to be bad

414
00:13:07,279 --> 00:13:09,519
third for those linux enthusiasts out

415
00:13:09,519 --> 00:13:10,959
there and i know you're out there

416
00:13:10,959 --> 00:13:13,120
i think it's fair to say that linux is

417
00:13:13,120 --> 00:13:14,880
generally thought of or assumed to be

418
00:13:14,880 --> 00:13:17,360
more secure due in part to its open

419
00:13:17,360 --> 00:13:18,639
source nature

420
00:13:18,639 --> 00:13:22,000
fair enough but remember openssl

421
00:13:22,000 --> 00:13:24,480
heartbleed it was there too in front of

422
00:13:24,480 --> 00:13:27,040
millions of eyes and no one saw it

423
00:13:27,040 --> 00:13:28,399
in this case i can tell you that

424
00:13:28,399 --> 00:13:30,480
analysts who study chinese espionage

425
00:13:30,480 --> 00:13:31,760
more broadly

426
00:13:31,760 --> 00:13:34,079
say that chapter one of the playbook is

427
00:13:34,079 --> 00:13:36,160
the exceptional exploitation of

428
00:13:36,160 --> 00:13:39,360
open source material so it's not too

429
00:13:39,360 --> 00:13:40,240
hard to see

430
00:13:40,240 --> 00:13:41,839
how groups that we assessed to be

431
00:13:41,839 --> 00:13:43,839
engaged in espionage and the interests

432
00:13:43,839 --> 00:13:45,199
of the chinese government

433
00:13:45,199 --> 00:13:47,040
have taken full advantage of the fact

434
00:13:47,040 --> 00:13:48,560
that they can create malware for an

435
00:13:48,560 --> 00:13:49,519
operating system

436
00:13:49,519 --> 00:13:52,639
whose source code is an open book now

437
00:13:52,639 --> 00:13:54,160
even if these three possible

438
00:13:54,160 --> 00:13:56,000
explanations for the low detection rate

439
00:13:56,000 --> 00:13:58,399
fail or fall apart there remains one

440
00:13:58,399 --> 00:13:59,360
more explanation

441
00:13:59,360 --> 00:14:02,160
inherent to the malware itself that is

442
00:14:02,160 --> 00:14:04,160
the whole stack revolves around custom

443
00:14:04,160 --> 00:14:06,480
kernel-level rootkits and rootkits of

444
00:14:06,480 --> 00:14:09,680
course are designed to be hard to detect

445
00:14:09,680 --> 00:14:12,000
now i realize rootkits are old-school

446
00:14:12,000 --> 00:14:12,959
sort of a relic

447
00:14:12,959 --> 00:14:14,880
or a paradigm from an earlier age of

448
00:14:14,880 --> 00:14:16,240
infosec

449
00:14:16,240 --> 00:14:18,240
today most attackers tend to just live

450
00:14:18,240 --> 00:14:20,480
off the land right or hide in the noise

451
00:14:20,480 --> 00:14:22,240
and really effective tools are often

452
00:14:22,240 --> 00:14:25,040
just publicly available for apts to use

453
00:14:25,040 --> 00:14:26,480
and they do use them to devastating

454
00:14:26,480 --> 00:14:28,959
effect thanks pentesters

455
00:14:28,959 --> 00:14:30,720
while other custom tools tend to last a

456
00:14:30,720 --> 00:14:33,040
year or two before they're burned

457
00:14:33,040 --> 00:14:34,480
however here's where challenging your

458
00:14:34,480 --> 00:14:36,480
own way of thinking pays off

459
00:14:36,480 --> 00:14:38,560
if you think root kits are old news you

460
00:14:38,560 --> 00:14:40,800
won't build products to detect them

461
00:14:40,800 --> 00:14:43,040
and you won't expect to find them and

462
00:14:43,040 --> 00:14:44,320
that impacts the way you do your

463
00:14:44,320 --> 00:14:46,320
analysis

464
00:14:46,320 --> 00:14:47,360
keep in mind here what ought to be

465
00:14:47,360 --> 00:14:50,480
another maxim of infosec everything old

466
00:14:50,480 --> 00:14:53,040
eventually becomes new again any

467
00:14:53,040 --> 00:14:54,160
convincing

468
00:14:54,160 --> 00:14:56,399
think about macros just from reading

469
00:14:56,399 --> 00:14:58,480
public security research i can tell you

470
00:14:58,480 --> 00:14:59,920
that they used to be a big deal

471
00:14:59,920 --> 00:15:01,600
then they went away and now they're back

472
00:15:01,600 --> 00:15:03,920
again email attachments

473
00:15:03,920 --> 00:15:06,880
huge problem and not so much now it's a

474
00:15:06,880 --> 00:15:08,639
thorn in everyone's side again

475
00:15:08,639 --> 00:15:11,279
same with rootkits perhaps reading these

476
00:15:11,279 --> 00:15:12,639
research papers you thought they went

477
00:15:12,639 --> 00:15:13,920
out of style

478
00:15:13,920 --> 00:15:15,199
but when they're running on the kernel

479
00:15:15,199 --> 00:15:17,040
side of multiple linux distro kernel

480
00:15:17,040 --> 00:15:18,160
combinations

481
00:15:18,160 --> 00:15:19,920
they're going to work whether it's the

482
00:15:19,920 --> 00:15:22,480
year the rat or the year of the dragon

483
00:15:22,480 --> 00:15:24,480
okay they've got survival skills even

484
00:15:24,480 --> 00:15:27,120
bear grylls with envy

485
00:15:27,120 --> 00:15:28,720
all right so let's take a closer look at

486
00:15:28,720 --> 00:15:31,199
them we found two variants

487
00:15:31,199 --> 00:15:33,680
both of them lkm's designed to work with

488
00:15:33,680 --> 00:15:35,600
an associated backdoor

489
00:15:35,600 --> 00:15:37,360
we saw them tailored for kernel versions

490
00:15:37,360 --> 00:15:38,720
2 and 3

491
00:15:38,720 --> 00:15:40,560
but with up-to-date c2 so we knew they

492
00:15:40,560 --> 00:15:42,079
were still in use

493
00:15:42,079 --> 00:15:43,759
this older kernel version targeting by

494
00:15:43,759 --> 00:15:45,920
the way is likely a reflection of the

495
00:15:45,920 --> 00:15:46,320
fact

496
00:15:46,320 --> 00:15:48,320
that many linux sysadmins are just slow

497
00:15:48,320 --> 00:15:51,279
to update for various reasons

498
00:15:51,279 --> 00:15:52,639
we found examples of malware that

499
00:15:52,639 --> 00:15:54,639
targeted red hat enterprise

500
00:15:54,639 --> 00:15:58,240
sentos ubuntu and debian but it's a good

501
00:15:58,240 --> 00:15:58,560
bet

502
00:15:58,560 --> 00:16:00,399
given their custom nature and on-the-fly

503
00:16:00,399 --> 00:16:02,240
compilation that there are others out

504
00:16:02,240 --> 00:16:03,600
there

505
00:16:03,600 --> 00:16:04,880
who knows maybe some of you have found

506
00:16:04,880 --> 00:16:07,839
them or can help uncover some more

507
00:16:07,839 --> 00:16:09,680
vt scoring on them at the time of

508
00:16:09,680 --> 00:16:12,560
discovery was at or near zero

509
00:16:12,560 --> 00:16:14,720
the first one we found looked like it

510
00:16:14,720 --> 00:16:16,320
had code lifted right out of somebody's

511
00:16:16,320 --> 00:16:17,440
book

512
00:16:17,440 --> 00:16:20,160
namely ivan skylarov's programming linux

513
00:16:20,160 --> 00:16:20,959
hacker tools

514
00:16:20,959 --> 00:16:24,480
uncovered sorry ivan while the second

515
00:16:24,480 --> 00:16:25,360
rootkit we found

516
00:16:25,360 --> 00:16:26,800
looked like it was just a modified

517
00:16:26,800 --> 00:16:28,560
version of the open source sudorusu

518
00:16:28,560 --> 00:16:29,519
rootkit

519
00:16:29,519 --> 00:16:32,720
more plagiarism i mean open source

520
00:16:32,720 --> 00:16:35,759
exploitation now as i said earlier the

521
00:16:35,759 --> 00:16:36,959
rootkit was installed

522
00:16:36,959 --> 00:16:39,440
via a bash script we found it inside

523
00:16:39,440 --> 00:16:40,959
another shell script while looking at

524
00:16:40,959 --> 00:16:42,959
backdoor callback data

525
00:16:42,959 --> 00:16:44,480
the script communicated to one of two

526
00:16:44,480 --> 00:16:46,240
servers depending on whether the target

527
00:16:46,240 --> 00:16:49,040
had a 32-bit or a 64-bit cpu

528
00:16:49,040 --> 00:16:50,399
architecture

529
00:16:50,399 --> 00:16:52,320
the script prompted the attacker for a

530
00:16:52,320 --> 00:16:54,240
username a build

531
00:16:54,240 --> 00:16:57,440
and something called force mode option

532
00:16:57,440 --> 00:16:59,360
it checked to see if malware already

533
00:16:59,360 --> 00:17:01,040
existed for the target distro kernel

534
00:17:01,040 --> 00:17:02,160
version

535
00:17:02,160 --> 00:17:04,480
force mode would force the build server

536
00:17:04,480 --> 00:17:06,079
to ignore an existing build for a given

537
00:17:06,079 --> 00:17:06,559
kernel

538
00:17:06,559 --> 00:17:09,760
if one existed and rebuild the root kit

539
00:17:09,760 --> 00:17:11,520
you'll notice here that it calls itself

540
00:17:11,520 --> 00:17:13,359
lancer version two

541
00:17:13,359 --> 00:17:15,599
we never found version one or version

542
00:17:15,599 --> 00:17:18,240
three or anything later

543
00:17:18,240 --> 00:17:19,679
now here you're looking at the path

544
00:17:19,679 --> 00:17:21,280
names and the various build environments

545
00:17:21,280 --> 00:17:22,799
that we found

546
00:17:22,799 --> 00:17:24,319
the first three you see here were all

547
00:17:24,319 --> 00:17:26,480
reaching out to a remote server

548
00:17:26,480 --> 00:17:27,919
and they delivered the root kit not just

549
00:17:27,919 --> 00:17:31,280
by md5 hash but by username as well

550
00:17:31,280 --> 00:17:33,840
and hey check out those usernames i'd

551
00:17:33,840 --> 00:17:34,880
like to stop and

552
00:17:34,880 --> 00:17:37,200
give a shout out here to yang and mao

553
00:17:37,200 --> 00:17:38,080
mao

554
00:17:38,080 --> 00:17:41,600
and uh he he i'm sorry we interrupted

555
00:17:41,600 --> 00:17:42,400
your work

556
00:17:42,400 --> 00:17:44,240
though i'm sure we didn't set you back

557
00:17:44,240 --> 00:17:48,000
for too long you had a good run anyway

558
00:17:48,000 --> 00:17:50,080
each of these users had a customized

559
00:17:50,080 --> 00:17:51,200
environment configured

560
00:17:51,200 --> 00:17:53,919
that would use his or her predefined c2

561
00:17:53,919 --> 00:17:54,559
servers

562
00:17:54,559 --> 00:17:55,760
while compiling and delivering the

563
00:17:55,760 --> 00:17:57,679
backdoor package

564
00:17:57,679 --> 00:17:59,440
okay now these pathways you're looking

565
00:17:59,440 --> 00:18:00,880
at here

566
00:18:00,880 --> 00:18:02,640
all pertain to build environments that

567
00:18:02,640 --> 00:18:04,720
were local on the target already

568
00:18:04,720 --> 00:18:06,720
don't ask me how they got there i don't

569
00:18:06,720 --> 00:18:09,200
know but they delivered the same result

570
00:18:09,200 --> 00:18:11,280
custom root kit and back door for each

571
00:18:11,280 --> 00:18:13,039
target

572
00:18:13,039 --> 00:18:14,960
now you want to find even more of this

573
00:18:14,960 --> 00:18:16,400
splinter cells handiwork

574
00:18:16,400 --> 00:18:18,880
beyond what i'm presenting today here's

575
00:18:18,880 --> 00:18:19,919
something you won't read about on our

576
00:18:19,919 --> 00:18:21,280
white paper

577
00:18:21,280 --> 00:18:23,520
the build server provided another really

578
00:18:23,520 --> 00:18:24,960
interesting nugget

579
00:18:24,960 --> 00:18:26,880
while down on those weeds we realized

580
00:18:26,880 --> 00:18:28,000
that the domain names

581
00:18:28,000 --> 00:18:29,760
contained in the installation script

582
00:18:29,760 --> 00:18:32,320
both had the number 3389 in them

583
00:18:32,320 --> 00:18:35,600
as you see here and that rang a bell

584
00:18:35,600 --> 00:18:37,440
because it was very similar to another

585
00:18:37,440 --> 00:18:39,120
historic past cv domain

586
00:18:39,120 --> 00:18:41,799
with the same number in it namely

587
00:18:41,799 --> 00:18:43,840
3389.hk

588
00:18:43,840 --> 00:18:46,559
using that we were then able to identify

589
00:18:46,559 --> 00:18:48,880
new hosts using similar subdomains

590
00:18:48,880 --> 00:18:50,799
which resolved to these ip addresses

591
00:18:50,799 --> 00:18:52,160
here

592
00:18:52,160 --> 00:18:54,880
they both used a relatively unique http

593
00:18:54,880 --> 00:18:58,799
server bigos server 1.6.0

594
00:18:58,799 --> 00:19:00,080
now at the time we put all this together

595
00:19:00,080 --> 00:19:01,840
there are only like 20 servers on the

596
00:19:01,840 --> 00:19:02,400
internet

597
00:19:02,400 --> 00:19:05,200
running the same software okay happy

598
00:19:05,200 --> 00:19:07,600
hunting everybody

599
00:19:07,600 --> 00:19:10,240
now what all this demonstrates is that

600
00:19:10,240 --> 00:19:11,039
the attackers

601
00:19:11,039 --> 00:19:12,640
and remember there were multiple apt

602
00:19:12,640 --> 00:19:14,880
groups involved here the attackers took

603
00:19:14,880 --> 00:19:16,880
a lot of time to set this up

604
00:19:16,880 --> 00:19:18,960
establish a foothold on the target

605
00:19:18,960 --> 00:19:20,960
devise a way to quickly compile

606
00:19:20,960 --> 00:19:22,880
sophisticated malware for multiple

607
00:19:22,880 --> 00:19:25,039
combinations of linux distributions and

608
00:19:25,039 --> 00:19:26,160
kernel versions

609
00:19:26,160 --> 00:19:28,559
and then readily install them that's a

610
00:19:28,559 --> 00:19:29,760
lot of love

611
00:19:29,760 --> 00:19:33,679
and attention and development and time

612
00:19:33,679 --> 00:19:36,799
and testing and refinement and overall

613
00:19:36,799 --> 00:19:37,280
ref

614
00:19:37,280 --> 00:19:38,799
overall effort required to keep it all

615
00:19:38,799 --> 00:19:41,120
going you know and on top of that you

616
00:19:41,120 --> 00:19:42,720
know you got taking care of the kids and

617
00:19:42,720 --> 00:19:44,559
grocery shopping and walking the dog and

618
00:19:44,559 --> 00:19:44,960
you know

619
00:19:44,960 --> 00:19:48,320
covet 19 to deal with

620
00:19:48,640 --> 00:19:50,160
now earlier i mentioned something about

621
00:19:50,160 --> 00:19:52,080
a botnet and promise to answer what is

622
00:19:52,080 --> 00:19:54,480
now our third motivating question

623
00:19:54,480 --> 00:19:56,720
is win nti responsible for the creation

624
00:19:56,720 --> 00:19:59,760
of the largest known linux ddos botnet

625
00:19:59,760 --> 00:20:02,559
well the short answer is yes and by that

626
00:20:02,559 --> 00:20:02,960
i mean

627
00:20:02,960 --> 00:20:05,200
we judge that the original botnet was

628
00:20:05,200 --> 00:20:07,760
developed by when nti group

629
00:20:07,760 --> 00:20:09,200
now these are intelligence assessments

630
00:20:09,200 --> 00:20:12,159
okay not edicts carved in stone

631
00:20:12,159 --> 00:20:13,919
nevertheless our confidence level is

632
00:20:13,919 --> 00:20:15,200
high

633
00:20:15,200 --> 00:20:17,520
so how do we make that connection and

634
00:20:17,520 --> 00:20:19,679
what does it tell us

635
00:20:19,679 --> 00:20:22,559
again let's start by looking back as a

636
00:20:22,559 --> 00:20:23,440
reminder

637
00:20:23,440 --> 00:20:26,080
linux xor ddos was discovered i believe

638
00:20:26,080 --> 00:20:27,360
by malware mustai

639
00:20:27,360 --> 00:20:31,280
in 2014. akamai wrote a lot about it

640
00:20:31,280 --> 00:20:32,799
and told us about its high bandwidth

641
00:20:32,799 --> 00:20:35,600
attacks which ranged up to like 150 gigs

642
00:20:35,600 --> 00:20:37,280
per second

643
00:20:37,280 --> 00:20:39,440
notably they said that the botnet spread

644
00:20:39,440 --> 00:20:40,960
by using brute force

645
00:20:40,960 --> 00:20:43,039
shhh attacks to get creds for target

646
00:20:43,039 --> 00:20:44,159
servers

647
00:20:44,159 --> 00:20:46,640
yeah apparently that still works i guess

648
00:20:46,640 --> 00:20:48,559
nobody likes exponential back off or

649
00:20:48,559 --> 00:20:51,919
failed to ban or just changing port 22.

650
00:20:51,919 --> 00:20:53,600
anyway here's another example of

651
00:20:53,600 --> 00:20:56,240
something old becoming new again

652
00:20:56,240 --> 00:20:58,320
now akamai said that they saw about 20

653
00:20:58,320 --> 00:20:59,919
targets hit each day this is back in

654
00:20:59,919 --> 00:21:00,799
2015.

655
00:21:00,799 --> 00:21:02,640
20 targets hit each day with the

656
00:21:02,640 --> 00:21:04,640
overwhelming majority like more than 90

657
00:21:04,640 --> 00:21:05,360
percent

658
00:21:05,360 --> 00:21:07,919
in asia and at the top of the list we're

659
00:21:07,919 --> 00:21:09,919
video game companies

660
00:21:09,919 --> 00:21:12,480
now that sounds like win nti right there

661
00:21:12,480 --> 00:21:14,080
doesn't it

662
00:21:14,080 --> 00:21:16,320
if you remember the 2013 seminal

663
00:21:16,320 --> 00:21:18,880
kaspersky lab report on win nti group

664
00:21:18,880 --> 00:21:21,760
was called more than just a game because

665
00:21:21,760 --> 00:21:23,360
it drew a connection from the group's

666
00:21:23,360 --> 00:21:24,880
infamous criminal targeting

667
00:21:24,880 --> 00:21:26,640
of video game companies to their

668
00:21:26,640 --> 00:21:29,120
espionage activities and other verticals

669
00:21:29,120 --> 00:21:30,640
now the five apt groups that we were

670
00:21:30,640 --> 00:21:33,360
tracking also engaged in both historical

671
00:21:33,360 --> 00:21:34,960
and active targeting of video game

672
00:21:34,960 --> 00:21:36,799
companies

673
00:21:36,799 --> 00:21:39,200
but were there more concrete connections

674
00:21:39,200 --> 00:21:41,200
the answer again is yes

675
00:21:41,200 --> 00:21:43,440
when we discovered our first backdoor we

676
00:21:43,440 --> 00:21:45,120
noticed that it used a certain device

677
00:21:45,120 --> 00:21:47,120
for rootkit functionality

678
00:21:47,120 --> 00:21:49,520
the botnet used the exact same device

679
00:21:49,520 --> 00:21:51,679
with the exact same name

680
00:21:51,679 --> 00:21:53,679
next we noticed that early samples of

681
00:21:53,679 --> 00:21:54,960
the backdoor that we found

682
00:21:54,960 --> 00:21:57,520
used a particular string as an xor key

683
00:21:57,520 --> 00:21:59,679
to obscure network traffic

684
00:21:59,679 --> 00:22:01,520
the botnet used the exact same string

685
00:22:01,520 --> 00:22:03,760
for the exact same purpose

686
00:22:03,760 --> 00:22:05,520
then we noticed that both the root kit

687
00:22:05,520 --> 00:22:06,880
that came with the back door and the

688
00:22:06,880 --> 00:22:07,600
botnet

689
00:22:07,600 --> 00:22:09,039
were based on pretty much the same

690
00:22:09,039 --> 00:22:11,039
modifications of the open source

691
00:22:11,039 --> 00:22:13,200
sudarusi rootkit

692
00:22:13,200 --> 00:22:15,360
in a write-up by avast on the botnet's

693
00:22:15,360 --> 00:22:16,240
rootkit

694
00:22:16,240 --> 00:22:17,840
they pointed out that for the kernel

695
00:22:17,840 --> 00:22:20,480
modules to work its vermagic value

696
00:22:20,480 --> 00:22:21,840
needed to match the kernel version on

697
00:22:21,840 --> 00:22:24,000
the target in other words the malware

698
00:22:24,000 --> 00:22:24,880
would not work

699
00:22:24,880 --> 00:22:26,320
unless the kernel versions and the

700
00:22:26,320 --> 00:22:28,000
kernel modules matched

701
00:22:28,000 --> 00:22:29,520
just like we saw with the rootkits we

702
00:22:29,520 --> 00:22:32,000
found and when we looked at the way that

703
00:22:32,000 --> 00:22:32,720
the botnet

704
00:22:32,720 --> 00:22:35,600
interacted with its build server we saw

705
00:22:35,600 --> 00:22:37,760
very familiar interactive prompts

706
00:22:37,760 --> 00:22:40,240
username kernel version and so on as you

707
00:22:40,240 --> 00:22:42,080
can see here

708
00:22:42,080 --> 00:22:44,559
so given the age of the botnet the code

709
00:22:44,559 --> 00:22:45,280
reuse

710
00:22:45,280 --> 00:22:47,760
the xor key overlap the same

711
00:22:47,760 --> 00:22:49,600
customization and similar interaction

712
00:22:49,600 --> 00:22:51,039
with the build environment

713
00:22:51,039 --> 00:22:53,440
not to mention the same targeting all

714
00:22:53,440 --> 00:22:55,360
that led us to assess that the botnet

715
00:22:55,360 --> 00:22:58,400
was likely created by the same group

716
00:22:58,400 --> 00:23:00,799
but what did they do with it i mean how

717
00:23:00,799 --> 00:23:03,440
useful is that for espionage

718
00:23:03,440 --> 00:23:05,679
strangely what we didn't see when

719
00:23:05,679 --> 00:23:06,960
looking into all of this

720
00:23:06,960 --> 00:23:08,080
and combing through the flurry of

721
00:23:08,080 --> 00:23:09,760
coverage about this botnet was really

722
00:23:09,760 --> 00:23:11,200
much indication that anyone

723
00:23:11,200 --> 00:23:12,720
had actually been knocked offline or

724
00:23:12,720 --> 00:23:14,799
denied service now i mean i'm

725
00:23:14,799 --> 00:23:17,120
sure it happened but it wasn't grabbing

726
00:23:17,120 --> 00:23:18,159
headlines

727
00:23:18,159 --> 00:23:20,000
not at least as far as i could see and

728
00:23:20,000 --> 00:23:21,679
not in a way that you might expect given

729
00:23:21,679 --> 00:23:23,360
how much firepower this thing had at the

730
00:23:23,360 --> 00:23:24,880
time

731
00:23:24,880 --> 00:23:27,440
so that begs another question why build

732
00:23:27,440 --> 00:23:28,799
a ddos botnet

733
00:23:28,799 --> 00:23:32,000
if you don't use it to ddos

734
00:23:32,000 --> 00:23:33,280
well here's one of those places where

735
00:23:33,280 --> 00:23:34,640
the trail of evidence that we can point

736
00:23:34,640 --> 00:23:35,360
to

737
00:23:35,360 --> 00:23:39,120
goes cold and we can only speculate

738
00:23:39,120 --> 00:23:40,720
was our collective perception of the

739
00:23:40,720 --> 00:23:43,279
botnet as a denial of service tool

740
00:23:43,279 --> 00:23:46,240
reflective of reality was it there to

741
00:23:46,240 --> 00:23:47,760
disrupt video game companies for some

742
00:23:47,760 --> 00:23:48,799
reason

743
00:23:48,799 --> 00:23:51,200
or can botnets be used as a tool of

744
00:23:51,200 --> 00:23:52,159
espionage

745
00:23:52,159 --> 00:23:53,760
if only to deliberately misdirect

746
00:23:53,760 --> 00:23:56,480
forensic analysis and research

747
00:23:56,480 --> 00:23:58,880
was it perhaps just a means of quickly

748
00:23:58,880 --> 00:24:00,880
and efficiently gaining a foothold

749
00:24:00,880 --> 00:24:03,919
to collect code signing certificates or

750
00:24:03,919 --> 00:24:05,600
could it have been used to gain access

751
00:24:05,600 --> 00:24:07,840
to the primary espionage target servers

752
00:24:07,840 --> 00:24:10,799
and install the recruits we found

753
00:24:10,799 --> 00:24:11,919
perhaps the answer to all these

754
00:24:11,919 --> 00:24:14,720
questions is yes

755
00:24:14,720 --> 00:24:18,080
wouldn't that be something kind of makes

756
00:24:18,080 --> 00:24:19,760
you wonder what other aspects of malware

757
00:24:19,760 --> 00:24:20,320
analysis

758
00:24:20,320 --> 00:24:21,760
may be subject to the same narrow

759
00:24:21,760 --> 00:24:24,080
thinking take for example

760
00:24:24,080 --> 00:24:26,159
the use of mobile malware by state or

761
00:24:26,159 --> 00:24:28,559
state-backed groups more generally

762
00:24:28,559 --> 00:24:30,480
now in previous research we've shown

763
00:24:30,480 --> 00:24:31,919
that groups acting in the interest of

764
00:24:31,919 --> 00:24:32,960
governments

765
00:24:32,960 --> 00:24:34,559
have been integrating mobile malware

766
00:24:34,559 --> 00:24:36,400
into their espionage campaigns

767
00:24:36,400 --> 00:24:39,600
for a decade or more this is another

768
00:24:39,600 --> 00:24:40,159
area

769
00:24:40,159 --> 00:24:42,080
where attackers have enjoyed a huge jump

770
00:24:42,080 --> 00:24:43,919
on the security industry's response by

771
00:24:43,919 --> 00:24:44,799
the way

772
00:24:44,799 --> 00:24:47,360
given that epp and edr capabilities for

773
00:24:47,360 --> 00:24:48,240
mobile phones

774
00:24:48,240 --> 00:24:50,960
are still in their infancy and again

775
00:24:50,960 --> 00:24:52,640
while public-facing research about

776
00:24:52,640 --> 00:24:55,200
mobile malware is certainly there

777
00:24:55,200 --> 00:24:57,200
in my opinion it's been scattershot at

778
00:24:57,200 --> 00:24:59,440
best and maladroit at worst

779
00:24:59,440 --> 00:25:01,520
and what i mean by that is that it's

780
00:25:01,520 --> 00:25:03,120
almost never put in the context of

781
00:25:03,120 --> 00:25:03,919
campaigns that

782
00:25:03,919 --> 00:25:06,159
integrate other forms of malware on

783
00:25:06,159 --> 00:25:08,159
other platforms

784
00:25:08,159 --> 00:25:10,080
so as a result of our collective narrow

785
00:25:10,080 --> 00:25:12,559
focus and poor av coverage

786
00:25:12,559 --> 00:25:14,159
apt groups have been able to exploit the

787
00:25:14,159 --> 00:25:15,760
mobile space with

788
00:25:15,760 --> 00:25:17,760
pretty much near impunity for quite some

789
00:25:17,760 --> 00:25:19,200
time

790
00:25:19,200 --> 00:25:20,559
all right let's get back to it let me

791
00:25:20,559 --> 00:25:22,720
follow my own advice now and widen the

792
00:25:22,720 --> 00:25:23,760
lens

793
00:25:23,760 --> 00:25:25,360
the interesting questions that motivated

794
00:25:25,360 --> 00:25:27,440
us during our research didn't just arise

795
00:25:27,440 --> 00:25:29,440
in analyzing linux malware

796
00:25:29,440 --> 00:25:32,559
they came up elsewhere too and the most

797
00:25:32,559 --> 00:25:34,799
intriguing question to arise on our

798
00:25:34,799 --> 00:25:36,480
examination of the android malware

799
00:25:36,480 --> 00:25:39,279
was this one is a chinese apt group

800
00:25:39,279 --> 00:25:40,400
behind the development

801
00:25:40,400 --> 00:25:42,080
of one of the most widely used

802
00:25:42,080 --> 00:25:44,559
commercially available rats

803
00:25:44,559 --> 00:25:47,600
let's see if we can find out all right

804
00:25:47,600 --> 00:25:49,120
taking one of the linux splinter cell

805
00:25:49,120 --> 00:25:51,840
members a group blue coat first named

806
00:25:51,840 --> 00:25:53,600
pass cv and about which we've published

807
00:25:53,600 --> 00:25:55,279
some previous research

808
00:25:55,279 --> 00:25:57,600
we followed a c2 trail and found some

809
00:25:57,600 --> 00:26:00,400
domain crossover which led to our sample

810
00:26:00,400 --> 00:26:02,400
a file that had the the string wave

811
00:26:02,400 --> 00:26:03,840
dancer in it

812
00:26:03,840 --> 00:26:05,360
and as we took it apart it looked like

813
00:26:05,360 --> 00:26:07,600
it might just be a test the giveaway was

814
00:26:07,600 --> 00:26:09,120
it had strings in it that said

815
00:26:09,120 --> 00:26:11,840
test and it hadn't been touched in like

816
00:26:11,840 --> 00:26:13,200
five years

817
00:26:13,200 --> 00:26:16,159
now parsing some xml strings coughed up

818
00:26:16,159 --> 00:26:17,200
some c2

819
00:26:17,200 --> 00:26:19,039
which led to dual domain which led to a

820
00:26:19,039 --> 00:26:21,039
domain that was registered by the same

821
00:26:21,039 --> 00:26:22,080
email address

822
00:26:22,080 --> 00:26:23,760
as had been used in lots of other past

823
00:26:23,760 --> 00:26:25,360
cv work we've been following so

824
00:26:25,360 --> 00:26:27,200
we could tie the sample that we'd found

825
00:26:27,200 --> 00:26:29,840
with confidence to a win nti group

826
00:26:29,840 --> 00:26:31,600
but it was the guts of this malware that

827
00:26:31,600 --> 00:26:32,880
turned up something that we didn't

828
00:26:32,880 --> 00:26:35,120
expect

829
00:26:35,120 --> 00:26:36,480
after decompiling the code of the

830
00:26:36,480 --> 00:26:38,720
implant we saw structural

831
00:26:38,720 --> 00:26:40,880
structural layouts and huge swaths of

832
00:26:40,880 --> 00:26:42,880
code that appeared to match identically

833
00:26:42,880 --> 00:26:44,320
with the android version of a tool

834
00:26:44,320 --> 00:26:44,640
called

835
00:26:44,640 --> 00:26:47,840
netwire now systems administrators and

836
00:26:47,840 --> 00:26:49,600
pen testers will know netwire

837
00:26:49,600 --> 00:26:51,919
as a multi-platform commercial

838
00:26:51,919 --> 00:26:53,039
off-the-shelf rat

839
00:26:53,039 --> 00:26:54,799
you can license from a company called

840
00:26:54,799 --> 00:26:56,720
world wired labs

841
00:26:56,720 --> 00:26:59,360
for lots of purposes including quote

842
00:26:59,360 --> 00:27:01,600
even monitoring your children at home

843
00:27:01,600 --> 00:27:02,880
as they hopefully tell us on their

844
00:27:02,880 --> 00:27:05,200
website probably not a great selling

845
00:27:05,200 --> 00:27:06,960
point during the covet 19 lockdown

846
00:27:06,960 --> 00:27:08,080
though

847
00:27:08,080 --> 00:27:10,240
anyway many of you watching will also

848
00:27:10,240 --> 00:27:12,480
recognize netwire as yet another one of

849
00:27:12,480 --> 00:27:14,400
the publicly available remote support

850
00:27:14,400 --> 00:27:15,600
tools that have been

851
00:27:15,600 --> 00:27:17,520
picked up and co-opted by criminals and

852
00:27:17,520 --> 00:27:19,440
government-backed groups to steal and to

853
00:27:19,440 --> 00:27:21,440
spy now of course that is not

854
00:27:21,440 --> 00:27:24,080
worldwide lab's fault right tools don't

855
00:27:24,080 --> 00:27:25,600
hack targets people

856
00:27:25,600 --> 00:27:28,719
people hack targets

857
00:27:28,880 --> 00:27:30,320
given all that at first we thought hey

858
00:27:30,320 --> 00:27:32,559
what's the big deal you know apt groups

859
00:27:32,559 --> 00:27:33,520
use and abuse

860
00:27:33,520 --> 00:27:35,360
publicly available tools like this all

861
00:27:35,360 --> 00:27:36,960
the time right passive

862
00:27:36,960 --> 00:27:38,159
probably just picked it up and put it

863
00:27:38,159 --> 00:27:40,640
into rotation right

864
00:27:40,640 --> 00:27:42,159
well here's where things got a little

865
00:27:42,159 --> 00:27:44,559
strange look at this timeline

866
00:27:44,559 --> 00:27:46,320
the last modified date on the past cv

867
00:27:46,320 --> 00:27:48,240
implant was june 16

868
00:27:48,240 --> 00:27:51,120
2015 but the first public announcement

869
00:27:51,120 --> 00:27:52,720
by worldwide labs

870
00:27:52,720 --> 00:27:54,080
about forthcoming support for the

871
00:27:54,080 --> 00:27:56,960
android os was made on january

872
00:27:56,960 --> 00:28:00,559
2nd 2017 that's nearly 18 months

873
00:28:00,559 --> 00:28:04,080
after pascv's implant was last modified

874
00:28:04,080 --> 00:28:05,679
a second network announcement was made

875
00:28:05,679 --> 00:28:07,360
in march of that year indicating the

876
00:28:07,360 --> 00:28:09,279
android release was going to be delayed

877
00:28:09,279 --> 00:28:12,559
and finally netwire version 1.7 a

878
00:28:12,559 --> 00:28:16,080
was released on march 23rd of 2017

879
00:28:16,080 --> 00:28:17,840
marking the first public release of the

880
00:28:17,840 --> 00:28:19,600
android host that's nearly

881
00:28:19,600 --> 00:28:22,640
two years after the past cv malware was

882
00:28:22,640 --> 00:28:24,960
created

883
00:28:24,960 --> 00:28:27,600
so how do you explain that is a chinese

884
00:28:27,600 --> 00:28:28,640
espionage group

885
00:28:28,640 --> 00:28:31,679
behind the netwire tool well the truth

886
00:28:31,679 --> 00:28:32,240
is

887
00:28:32,240 --> 00:28:34,799
we just don't know i mean i can think of

888
00:28:34,799 --> 00:28:36,240
more than half a dozen

889
00:28:36,240 --> 00:28:38,559
possible explanations for this but i'm

890
00:28:38,559 --> 00:28:40,159
not going to subject you to that here

891
00:28:40,159 --> 00:28:43,279
okay now rest assured we did try to find

892
00:28:43,279 --> 00:28:45,120
similar samples to help clear it up we

893
00:28:45,120 --> 00:28:48,640
tried hard but we came up empty-handed

894
00:28:48,640 --> 00:28:51,039
why is that well maybe the past cv

895
00:28:51,039 --> 00:28:53,360
implant was highly targeted

896
00:28:53,360 --> 00:28:54,960
or maybe it was really just a test that

897
00:28:54,960 --> 00:28:57,760
leaked or maybe pascv abandoned the

898
00:28:57,760 --> 00:28:59,440
implants for some reason

899
00:28:59,440 --> 00:29:01,360
or maybe google did a bang-up job of

900
00:29:01,360 --> 00:29:03,279
keeping it out of the play store

901
00:29:03,279 --> 00:29:05,840
or maybe we just don't detect it or

902
00:29:05,840 --> 00:29:08,159
didn't anyway in 2015.

903
00:29:08,159 --> 00:29:09,600
if any of you have seen samples that fit

904
00:29:09,600 --> 00:29:11,600
the description i'd love to know please

905
00:29:11,600 --> 00:29:14,158
reach out

906
00:29:14,240 --> 00:29:16,480
now we could go on like this posing and

907
00:29:16,480 --> 00:29:18,000
answering questions about the last leg

908
00:29:18,000 --> 00:29:19,679
of our research the windows malware

909
00:29:19,679 --> 00:29:20,799
but there's going to be plenty of

910
00:29:20,799 --> 00:29:22,240
windows malware discussed in other

911
00:29:22,240 --> 00:29:23,440
sessions probably right

912
00:29:23,440 --> 00:29:25,039
and i want to use the rest of our time

913
00:29:25,039 --> 00:29:26,480
here wisely so

914
00:29:26,480 --> 00:29:29,279
let me just highlight one thing and that

915
00:29:29,279 --> 00:29:29,600
is

916
00:29:29,600 --> 00:29:31,840
we saw a notable shift from the typical

917
00:29:31,840 --> 00:29:33,840
winning tip behavior with these droppers

918
00:29:33,840 --> 00:29:35,279
that we found

919
00:29:35,279 --> 00:29:37,120
students of win nti know that one of

920
00:29:37,120 --> 00:29:38,799
their hallmarks is the use of code

921
00:29:38,799 --> 00:29:40,159
signing certificates

922
00:29:40,159 --> 00:29:43,200
stolen from video game companies here we

923
00:29:43,200 --> 00:29:45,120
saw that with all the groups we tracked

924
00:29:45,120 --> 00:29:48,159
but they now also included certs taken

925
00:29:48,159 --> 00:29:51,279
from adware companies why would they do

926
00:29:51,279 --> 00:29:52,159
that

927
00:29:52,159 --> 00:29:54,880
because adware is boring and alert

928
00:29:54,880 --> 00:29:56,000
fatigue

929
00:29:56,000 --> 00:29:59,520
is real when nti is betting

930
00:29:59,520 --> 00:30:01,600
correctly that network defenders and

931
00:30:01,600 --> 00:30:03,120
security researchers who find their

932
00:30:03,120 --> 00:30:04,000
adware

933
00:30:04,000 --> 00:30:05,360
will put it at the bottom of their list

934
00:30:05,360 --> 00:30:08,399
of priorities or ignore it all together

935
00:30:08,399 --> 00:30:10,640
i mean the fact that this small change

936
00:30:10,640 --> 00:30:12,080
okay there was a there was a new packer

937
00:30:12,080 --> 00:30:13,919
there too right but this small change

938
00:30:13,919 --> 00:30:14,799
helped put some

939
00:30:14,799 --> 00:30:16,880
20 year old rats that we should all know

940
00:30:16,880 --> 00:30:17,840
about and stop like

941
00:30:17,840 --> 00:30:20,960
ghost rat pass the majority of avs when

942
00:30:20,960 --> 00:30:22,480
we ran them i think

943
00:30:22,480 --> 00:30:25,279
the the the graphic here will show eight

944
00:30:25,279 --> 00:30:27,600
that tells you just how deeply ingrained

945
00:30:27,600 --> 00:30:31,120
that cognitive bias has become

946
00:30:31,120 --> 00:30:32,720
all right let's move on throughout this

947
00:30:32,720 --> 00:30:34,559
talk i've said that the activity that we

948
00:30:34,559 --> 00:30:36,559
tracked was the work of five separate

949
00:30:36,559 --> 00:30:37,120
groups

950
00:30:37,120 --> 00:30:39,360
that derived from the original win nti

951
00:30:39,360 --> 00:30:40,240
group and i put

952
00:30:40,240 --> 00:30:45,120
win nti in air quotes why did i do that

953
00:30:45,120 --> 00:30:47,120
and when you encounter win nti in the

954
00:30:47,120 --> 00:30:48,640
press or in research

955
00:30:48,640 --> 00:30:50,559
how should you understand it what does

956
00:30:50,559 --> 00:30:52,559
that name even mean

957
00:30:52,559 --> 00:30:53,919
and what does this research tell us

958
00:30:53,919 --> 00:30:56,240
about that threat actor

959
00:30:56,240 --> 00:30:58,240
my opinion is that when nti has come to

960
00:30:58,240 --> 00:31:00,399
represent more of an approach

961
00:31:00,399 --> 00:31:02,000
rather than a moniker for any single

962
00:31:02,000 --> 00:31:04,080
crew right it was a back door then it

963
00:31:04,080 --> 00:31:04,640
was a group

964
00:31:04,640 --> 00:31:06,399
then it was an umbrella now it's an

965
00:31:06,399 --> 00:31:08,159
approach my view

966
00:31:08,159 --> 00:31:09,679
is that it represents a way in which a

967
00:31:09,679 --> 00:31:11,279
group of what are probably civilian

968
00:31:11,279 --> 00:31:12,240
contractors

969
00:31:12,240 --> 00:31:14,880
is assembled tools are shared and

970
00:31:14,880 --> 00:31:16,480
targets are split up

971
00:31:16,480 --> 00:31:18,159
now the tools and infrastructure favored

972
00:31:18,159 --> 00:31:20,080
by each cell or group differs

973
00:31:20,080 --> 00:31:22,559
but sharing is happening to a greater or

974
00:31:22,559 --> 00:31:24,080
lesser extent

975
00:31:24,080 --> 00:31:26,080
so for example with the linux malware it

976
00:31:26,080 --> 00:31:27,600
was the tools that were shared

977
00:31:27,600 --> 00:31:29,440
but with the android malware it was the

978
00:31:29,440 --> 00:31:31,679
infrastructure that was shared

979
00:31:31,679 --> 00:31:34,240
in general all this sharing suggests

980
00:31:34,240 --> 00:31:36,080
either that the contractor community in

981
00:31:36,080 --> 00:31:37,760
china regards sharing favorably and

982
00:31:37,760 --> 00:31:39,279
tolerates it openly

983
00:31:39,279 --> 00:31:41,679
unlike elsewhere or that members travel

984
00:31:41,679 --> 00:31:43,279
between shops over time

985
00:31:43,279 --> 00:31:44,880
or groups of them break off to form new

986
00:31:44,880 --> 00:31:47,120
ones or both

987
00:31:47,120 --> 00:31:48,320
now it's also possible that the

988
00:31:48,320 --> 00:31:50,080
government which we assess to be their

989
00:31:50,080 --> 00:31:51,200
likely customer

990
00:31:51,200 --> 00:31:52,960
provides something in the way of support

991
00:31:52,960 --> 00:31:54,320
perhaps giving out tools

992
00:31:54,320 --> 00:31:57,120
in some formal fashion fireeye wrote

993
00:31:57,120 --> 00:31:58,320
about this concept and called it a

994
00:31:58,320 --> 00:31:59,519
digital quartermaster

995
00:31:59,519 --> 00:32:01,440
it's possible here but i think it's the

996
00:32:01,440 --> 00:32:04,480
least likely scenario

997
00:32:04,720 --> 00:32:06,480
the use of stolen code signing

998
00:32:06,480 --> 00:32:08,240
certificates typically from video game

999
00:32:08,240 --> 00:32:09,039
companies but

1000
00:32:09,039 --> 00:32:10,880
as we've just pointed out today also now

1001
00:32:10,880 --> 00:32:12,399
from adword companies

1002
00:32:12,399 --> 00:32:14,080
is probably the easiest common

1003
00:32:14,080 --> 00:32:15,840
denominator to identify across these

1004
00:32:15,840 --> 00:32:16,960
groups

1005
00:32:16,960 --> 00:32:18,799
but there's more to it than that

1006
00:32:18,799 --> 00:32:20,960
kaspersky researchers really did well

1007
00:32:20,960 --> 00:32:22,559
to illuminate the common criminal

1008
00:32:22,559 --> 00:32:24,559
ancestry of the original when nti group

1009
00:32:24,559 --> 00:32:26,640
for us in their seminal report

1010
00:32:26,640 --> 00:32:28,559
that financially driven criminal

1011
00:32:28,559 --> 00:32:30,480
approach is really worth pausing and

1012
00:32:30,480 --> 00:32:31,679
thinking about

1013
00:32:31,679 --> 00:32:33,279
because it tends to run counter to the

1014
00:32:33,279 --> 00:32:35,679
type of behavior we normally associate

1015
00:32:35,679 --> 00:32:37,600
with government-backed groups engaged in

1016
00:32:37,600 --> 00:32:39,279
traditional espionage with the north

1017
00:32:39,279 --> 00:32:40,159
korean groups

1018
00:32:40,159 --> 00:32:43,840
sort of a notable exception in this case

1019
00:32:43,840 --> 00:32:45,600
the criminal approach has colored the

1020
00:32:45,600 --> 00:32:47,039
original group's descendants

1021
00:32:47,039 --> 00:32:49,760
all these years later particularly in

1022
00:32:49,760 --> 00:32:52,240
their wide and voluminous targeting

1023
00:32:52,240 --> 00:32:55,760
from a distance it looks like spray and

1024
00:32:55,760 --> 00:32:57,760
but as i've demonstrated it's almost

1025
00:32:57,760 --> 00:32:59,679
always done with much more strategic

1026
00:32:59,679 --> 00:33:01,840
intent

1027
00:33:01,840 --> 00:33:03,360
now pretty much all the groups that i

1028
00:33:03,360 --> 00:33:05,360
mentioned today past cv

1029
00:33:05,360 --> 00:33:08,880
when nti group lead casper bronze union

1030
00:33:08,880 --> 00:33:10,640
they've all been discussed in other

1031
00:33:10,640 --> 00:33:13,039
public security research

1032
00:33:13,039 --> 00:33:14,559
whether these groups were actively

1033
00:33:14,559 --> 00:33:17,440
collaborating casually sharing

1034
00:33:17,440 --> 00:33:19,919
comprised of some of the same members or

1035
00:33:19,919 --> 00:33:21,200
in actuality were just

1036
00:33:21,200 --> 00:33:23,600
smaller parts of some larger group it's

1037
00:33:23,600 --> 00:33:25,519
beyond our means of analysis i'm

1038
00:33:25,519 --> 00:33:28,080
we're not a government but one thing is

1039
00:33:28,080 --> 00:33:28,720
clear

1040
00:33:28,720 --> 00:33:30,320
this isn't a single crew with a

1041
00:33:30,320 --> 00:33:31,840
one-trick pony

1042
00:33:31,840 --> 00:33:33,840
we are looking at a long-standing

1043
00:33:33,840 --> 00:33:35,120
well-thought-out

1044
00:33:35,120 --> 00:33:37,039
richly resourced intelligence collection

1045
00:33:37,039 --> 00:33:39,200
operation with a sizeable software

1046
00:33:39,200 --> 00:33:40,240
engineering team

1047
00:33:40,240 --> 00:33:42,960
to build and maintain all these tools

1048
00:33:42,960 --> 00:33:44,399
when nti then

1049
00:33:44,399 --> 00:33:46,559
is really a way to combine a team that

1050
00:33:46,559 --> 00:33:48,399
collects code signing certificates

1051
00:33:48,399 --> 00:33:49,840
and a team that puts malware on the

1052
00:33:49,840 --> 00:33:51,840
target and a team that creates and

1053
00:33:51,840 --> 00:33:53,760
manages the build environments

1054
00:33:53,760 --> 00:33:55,279
and a team that works up the mobile

1055
00:33:55,279 --> 00:33:56,880
malware and targeting

1056
00:33:56,880 --> 00:33:59,600
and a dev team for linux and a dev team

1057
00:33:59,600 --> 00:34:00,399
for windows

1058
00:34:00,399 --> 00:34:02,480
and another for android and you gotta

1059
00:34:02,480 --> 00:34:04,880
believe another for ios

1060
00:34:04,880 --> 00:34:07,200
all that is behind the air quoted when

1061
00:34:07,200 --> 00:34:10,320
nti threat actor

1062
00:34:10,399 --> 00:34:11,839
okay i'm afraid we've arrived at the end

1063
00:34:11,839 --> 00:34:13,520
of our time together

1064
00:34:13,520 --> 00:34:15,199
hopefully you've come away with some

1065
00:34:15,199 --> 00:34:17,199
understanding as to why the old story of

1066
00:34:17,199 --> 00:34:19,199
chinese espionage and ip theft

1067
00:34:19,199 --> 00:34:20,800
which everybody practically knows by

1068
00:34:20,800 --> 00:34:22,320
heart by now and is sick of hearing

1069
00:34:22,320 --> 00:34:23,119
about

1070
00:34:23,119 --> 00:34:25,520
is still surprising us with new chapters

1071
00:34:25,520 --> 00:34:27,839
hopefully you've learned that when nti

1072
00:34:27,839 --> 00:34:30,399
isn't more than just a game as kaspersky

1073
00:34:30,399 --> 00:34:32,159
lab taught us all those years ago

1074
00:34:32,159 --> 00:34:35,199
it's now more than just a name hopefully

1075
00:34:35,199 --> 00:34:36,719
you've seen that even from a handful of

1076
00:34:36,719 --> 00:34:38,399
l-files we can infer

1077
00:34:38,399 --> 00:34:41,119
a strategic approach hopefully i've

1078
00:34:41,119 --> 00:34:41,918
demonstrated

1079
00:34:41,918 --> 00:34:44,159
that rigid thinking inevitably leads to

1080
00:34:44,159 --> 00:34:45,679
rigid malware analysis

1081
00:34:45,679 --> 00:34:49,040
and inaccurate conclusions

1082
00:34:49,040 --> 00:34:51,199
you know in one story i worked on at 60

1083
00:34:51,199 --> 00:34:52,800
minutes near the end of my time there

1084
00:34:52,800 --> 00:34:54,960
i got to know a former treasury official

1085
00:34:54,960 --> 00:34:56,079
who taught me a lot

1086
00:34:56,079 --> 00:34:57,599
about the loopholes in our collective

1087
00:34:57,599 --> 00:34:59,119
financial transparency

1088
00:34:59,119 --> 00:35:02,079
and anti-money laundering efforts months

1089
00:35:02,079 --> 00:35:02,720
later

1090
00:35:02,720 --> 00:35:04,240
after some investigative reporting shed

1091
00:35:04,240 --> 00:35:05,839
light on some outrageous and surprising

1092
00:35:05,839 --> 00:35:06,720
behavior

1093
00:35:06,720 --> 00:35:08,720
he'd come back to me and say yeah kevin

1094
00:35:08,720 --> 00:35:09,839
but just think

1095
00:35:09,839 --> 00:35:12,000
if we could just turn on all the lights

1096
00:35:12,000 --> 00:35:13,280
just for a second

1097
00:35:13,280 --> 00:35:16,240
imagine what we'd see i think that's

1098
00:35:16,240 --> 00:35:17,839
really relevant here

1099
00:35:17,839 --> 00:35:19,440
we flick the lights on for a second with

1100
00:35:19,440 --> 00:35:21,200
this malware analysis

1101
00:35:21,200 --> 00:35:23,359
but it leaves us to consider perhaps the

1102
00:35:23,359 --> 00:35:24,960
most important and motivating question

1103
00:35:24,960 --> 00:35:26,079
of all

1104
00:35:26,079 --> 00:35:29,200
what are we not seeing thanks for your

1105
00:35:29,200 --> 00:35:30,880
time and your attention

1106
00:35:30,880 --> 00:35:36,720
i welcome your questions

