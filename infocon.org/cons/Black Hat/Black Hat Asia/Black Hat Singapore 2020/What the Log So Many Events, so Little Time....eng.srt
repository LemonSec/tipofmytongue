1
00:00:00,960 --> 00:00:03,840
welcome to blackhead asia 2020 to my

2
00:00:03,840 --> 00:00:05,120
presentation

3
00:00:05,120 --> 00:00:08,000
what the luck so many events so little

4
00:00:08,000 --> 00:00:09,519
time

5
00:00:09,519 --> 00:00:11,360
my name is miriam and currently i'm

6
00:00:11,360 --> 00:00:12,799
working as a program manager for

7
00:00:12,799 --> 00:00:15,040
microsoft defender atp and microsoft

8
00:00:15,040 --> 00:00:16,640
threat protection

9
00:00:16,640 --> 00:00:19,199
before i started in that role i worked

10
00:00:19,199 --> 00:00:21,199
as a prima field engineer

11
00:00:21,199 --> 00:00:24,320
also for microsoft and in that role

12
00:00:24,320 --> 00:00:28,400
i consulted organizations

13
00:00:28,400 --> 00:00:31,760
to improve their security posture

14
00:00:31,760 --> 00:00:34,239
and also to improve their monitoring and

15
00:00:34,239 --> 00:00:35,280
auditing

16
00:00:35,280 --> 00:00:38,719
and this is also where my story starts

17
00:00:38,719 --> 00:00:41,840
but before we start with that um if you

18
00:00:41,840 --> 00:00:42,239
have

19
00:00:42,239 --> 00:00:44,800
any feedback any feature requests any

20
00:00:44,800 --> 00:00:45,760
questions

21
00:00:45,760 --> 00:00:48,399
be sure to not contact microsoft because

22
00:00:48,399 --> 00:00:50,399
this is my personal work i'm a personal

23
00:00:50,399 --> 00:00:51,039
tool

24
00:00:51,039 --> 00:00:53,199
so just reach out to me and in the best

25
00:00:53,199 --> 00:00:56,960
case you can do this via twitter

26
00:00:57,680 --> 00:01:00,800
so when i worked with customers this is

27
00:01:00,800 --> 00:01:04,000
not an accurate image of how i looked

28
00:01:04,000 --> 00:01:06,320
like when working with customers

29
00:01:06,320 --> 00:01:09,439
this should demonstrate an attacker

30
00:01:09,439 --> 00:01:13,840
trying to get into an organization

31
00:01:13,840 --> 00:01:17,840
and normally if an attacker tries to

32
00:01:17,840 --> 00:01:19,040
attack

33
00:01:19,040 --> 00:01:22,720
uh 24 hours

34
00:01:22,720 --> 00:01:27,920
to 48 hours after the initial attack

35
00:01:27,920 --> 00:01:31,759
an attacker normally has gained full

36
00:01:31,759 --> 00:01:34,400
foothold and excess of the whole

37
00:01:34,400 --> 00:01:36,720
environment

38
00:01:36,720 --> 00:01:40,640
and if organizations detected it

39
00:01:40,640 --> 00:01:44,079
all normally it takes more than

40
00:01:44,079 --> 00:01:47,360
200 days that they

41
00:01:47,360 --> 00:01:50,560
detect that there was a breach

42
00:01:50,560 --> 00:01:53,200
and therefore to keep attackers out of

43
00:01:53,200 --> 00:01:54,640
the environment

44
00:01:54,640 --> 00:01:59,680
and to help organizations to detect them

45
00:01:59,680 --> 00:02:03,360
better and quicker microsoft

46
00:02:03,360 --> 00:02:05,840
has released the so-called microsoft

47
00:02:05,840 --> 00:02:08,080
security compliance toolkit

48
00:02:08,080 --> 00:02:10,399
and in this toolkit there are not only

49
00:02:10,399 --> 00:02:12,239
some very useful tools

50
00:02:12,239 --> 00:02:14,480
that helps you when you are working with

51
00:02:14,480 --> 00:02:15,360
baselines

52
00:02:15,360 --> 00:02:18,640
there are also security baselines

53
00:02:18,640 --> 00:02:21,360
that helps you to configure your

54
00:02:21,360 --> 00:02:22,640
environment

55
00:02:22,640 --> 00:02:24,959
those baselines are recommendations so

56
00:02:24,959 --> 00:02:26,000
there are

57
00:02:26,000 --> 00:02:29,760
hardening configuration options in there

58
00:02:29,760 --> 00:02:32,599
and there are also auditing

59
00:02:32,599 --> 00:02:33,920
recommendations

60
00:02:33,920 --> 00:02:36,560
and be sure if you want to apply such a

61
00:02:36,560 --> 00:02:37,280
baseline

62
00:02:37,280 --> 00:02:40,000
don't just apply it just test it and

63
00:02:40,000 --> 00:02:41,840
make sure that everything works

64
00:02:41,840 --> 00:02:43,519
because you're hardening your anyway

65
00:02:43,519 --> 00:02:46,319
when with it

66
00:02:47,200 --> 00:02:50,720
so coming back to those audit policies

67
00:02:50,720 --> 00:02:52,800
if you open such a baseline with a

68
00:02:52,800 --> 00:02:54,720
policy viewer which is also part of the

69
00:02:54,720 --> 00:02:56,160
security compliant

70
00:02:56,160 --> 00:02:59,680
compliance toolkit then you can also see

71
00:02:59,680 --> 00:03:03,360
those audit policies telling you

72
00:03:03,360 --> 00:03:06,640
which you should configure to see

73
00:03:06,640 --> 00:03:10,000
more in your environment and if you

74
00:03:10,000 --> 00:03:13,200
configure those audit policies there are

75
00:03:13,200 --> 00:03:16,840
additional events that are being

76
00:03:16,840 --> 00:03:18,959
generated and so i worked with a

77
00:03:18,959 --> 00:03:20,319
customer

78
00:03:20,319 --> 00:03:23,440
and i also recommended oh yeah dear

79
00:03:23,440 --> 00:03:24,000
customer

80
00:03:24,000 --> 00:03:26,319
you definitely should turn on those

81
00:03:26,319 --> 00:03:27,840
audit policies

82
00:03:27,840 --> 00:03:30,319
uh to see what is happening in your

83
00:03:30,319 --> 00:03:31,360
environment

84
00:03:31,360 --> 00:03:33,840
it is totally worth it and the customer

85
00:03:33,840 --> 00:03:35,760
asked me

86
00:03:35,760 --> 00:03:39,040
well if i turn on those policies there

87
00:03:39,040 --> 00:03:40,959
are new events that are being generated

88
00:03:40,959 --> 00:03:41,920
right

89
00:03:41,920 --> 00:03:45,440
i say yeah right are

90
00:03:45,440 --> 00:03:47,840
there maybe or is there maybe a

91
00:03:47,840 --> 00:03:49,280
documentation

92
00:03:49,280 --> 00:03:51,920
on what events are being generated if i

93
00:03:51,920 --> 00:03:54,000
apply a certain baseline

94
00:03:54,000 --> 00:03:56,799
and it looks like well there is this

95
00:03:56,799 --> 00:03:58,680
document that has

96
00:03:58,680 --> 00:04:02,560
754 pages but the customer was no no

97
00:04:02,560 --> 00:04:05,599
i meant really a simple page a one page

98
00:04:05,599 --> 00:04:06,560
or something

99
00:04:06,560 --> 00:04:08,799
that on which you can just see which

100
00:04:08,799 --> 00:04:09,920
event ids

101
00:04:09,920 --> 00:04:12,879
would be generated if i turn on this

102
00:04:12,879 --> 00:04:14,000
baseline

103
00:04:14,000 --> 00:04:17,199
and i was like unfortunately no

104
00:04:17,199 --> 00:04:20,320
sorry and so the customer

105
00:04:20,320 --> 00:04:23,680
asked me to write down all the events

106
00:04:23,680 --> 00:04:26,560
that would be generated when they would

107
00:04:26,560 --> 00:04:29,600
apply a certain baseline

108
00:04:29,600 --> 00:04:33,520
i was not very happy at all

109
00:04:33,520 --> 00:04:37,600
but i agreed and i started writing down

110
00:04:37,600 --> 00:04:38,880
all the event ids

111
00:04:38,880 --> 00:04:42,000
in an excel sheet and it was such a

112
00:04:42,000 --> 00:04:45,040
huge workload and

113
00:04:45,040 --> 00:04:47,840
while i was doing so the customer showed

114
00:04:47,840 --> 00:04:49,199
up at my desk

115
00:04:49,199 --> 00:04:51,280
and they asked me oh we also want to

116
00:04:51,280 --> 00:04:52,880
apply this baseline

117
00:04:52,880 --> 00:04:54,479
could you also write down the events

118
00:04:54,479 --> 00:04:56,880
that would be generated by this one

119
00:04:56,880 --> 00:04:59,280
and not only this also this baseline

120
00:04:59,280 --> 00:05:01,039
this baseline this baseline and this

121
00:05:01,039 --> 00:05:02,639
baseline too

122
00:05:02,639 --> 00:05:06,240
and i was like oh my god would you like

123
00:05:06,240 --> 00:05:08,240
me to write down all these events for

124
00:05:08,240 --> 00:05:10,400
the next 10 years

125
00:05:10,400 --> 00:05:14,320
and uh well that was what the customer

126
00:05:14,320 --> 00:05:15,759
required

127
00:05:15,759 --> 00:05:18,880
i was not happy at all because that was

128
00:05:18,880 --> 00:05:20,240
too much work

129
00:05:20,240 --> 00:05:22,960
and so i thought about a way to automate

130
00:05:22,960 --> 00:05:24,160
it

131
00:05:24,160 --> 00:05:26,400
and this was when i came up with the

132
00:05:26,400 --> 00:05:27,280
first version

133
00:05:27,280 --> 00:05:30,960
of event list and this is what it looked

134
00:05:30,960 --> 00:05:31,840
like

135
00:05:31,840 --> 00:05:35,199
it looked like i

136
00:05:35,199 --> 00:05:38,400
created an excel sheet and put a lot of

137
00:05:38,400 --> 00:05:39,520
macros behind

138
00:05:39,520 --> 00:05:42,479
and you have the option to import

139
00:05:42,479 --> 00:05:44,960
baselines

140
00:05:44,960 --> 00:05:48,639
if those baselines were imported you had

141
00:05:48,639 --> 00:05:50,880
the option to select the baseline from

142
00:05:50,880 --> 00:05:52,400
the drop down

143
00:05:52,400 --> 00:05:55,120
and generate an event list for a

144
00:05:55,120 --> 00:05:56,400
baseline

145
00:05:56,400 --> 00:05:59,680
and this is what it looked like so

146
00:05:59,680 --> 00:06:02,960
you had the event id you had a link

147
00:06:02,960 --> 00:06:04,880
to the documentation where you could

148
00:06:04,880 --> 00:06:07,680
find more information about the event

149
00:06:07,680 --> 00:06:09,600
and you also had the recommendation if

150
00:06:09,600 --> 00:06:12,000
you should monitor it for success

151
00:06:12,000 --> 00:06:15,039
for failure or for both

152
00:06:15,039 --> 00:06:18,319
so the customer was happy i moved on i

153
00:06:18,319 --> 00:06:19,680
went to the next customer

154
00:06:19,680 --> 00:06:22,720
also presented my tool uh

155
00:06:22,720 --> 00:06:25,840
and the customer asked me hm

156
00:06:25,840 --> 00:06:30,400
have you heard about mitre attack

157
00:06:30,400 --> 00:06:33,440
and actually i had heard about mitre

158
00:06:33,440 --> 00:06:34,479
attack

159
00:06:34,479 --> 00:06:38,240
and mitre attack is a framework to

160
00:06:38,240 --> 00:06:42,080
improve the security

161
00:06:42,080 --> 00:06:45,440
of organizations in a

162
00:06:45,440 --> 00:06:49,280
more strategic way you can see all those

163
00:06:49,280 --> 00:06:49,759
miter

164
00:06:49,759 --> 00:06:52,960
attack areas those are the categories

165
00:06:52,960 --> 00:06:55,919
under which the miter attack techniques

166
00:06:55,919 --> 00:06:56,639
fall

167
00:06:56,639 --> 00:06:58,400
and this is how it looks like on their

168
00:06:58,400 --> 00:06:59,680
web page so you see

169
00:06:59,680 --> 00:07:02,560
again all the areas as headlines and

170
00:07:02,560 --> 00:07:03,759
below the areas

171
00:07:03,759 --> 00:07:07,360
the according techniques if you open a

172
00:07:07,360 --> 00:07:08,080
technique

173
00:07:08,080 --> 00:07:10,960
you can see what the technique is about

174
00:07:10,960 --> 00:07:11,840
who

175
00:07:11,840 --> 00:07:14,880
is using this technique and how to

176
00:07:14,880 --> 00:07:18,639
audit and how to mitigate

177
00:07:19,360 --> 00:07:22,479
and so um yeah

178
00:07:22,479 --> 00:07:26,400
um i was hooked so i thought about

179
00:07:26,400 --> 00:07:29,840
how i can implement minor attack to

180
00:07:29,840 --> 00:07:31,039
event list

181
00:07:31,039 --> 00:07:34,080
and if you have a look at the miter

182
00:07:34,080 --> 00:07:37,599
sources um then you can see

183
00:07:37,599 --> 00:07:40,080
that we are only talking about event

184
00:07:40,080 --> 00:07:40,639
logs

185
00:07:40,639 --> 00:07:44,639
at this point so just a small area

186
00:07:44,639 --> 00:07:47,199
from the data sources that can fit to

187
00:07:47,199 --> 00:07:48,319
minor

188
00:07:48,319 --> 00:07:51,840
attack and this

189
00:07:51,840 --> 00:07:54,639
we're not the only customers that i was

190
00:07:54,639 --> 00:07:56,840
working with to help them building their

191
00:07:56,840 --> 00:07:59,599
sock and when i did so

192
00:07:59,599 --> 00:08:02,879
there were always three questions

193
00:08:02,879 --> 00:08:05,919
that were repeated over and over

194
00:08:05,919 --> 00:08:09,520
again so first question because i

195
00:08:09,520 --> 00:08:13,440
always recommended to use those security

196
00:08:13,440 --> 00:08:15,599
baselines recommended by microsoft

197
00:08:15,599 --> 00:08:18,720
so first question was well which events

198
00:08:18,720 --> 00:08:20,479
are being generated if i apply this

199
00:08:20,479 --> 00:08:22,240
baseline

200
00:08:22,240 --> 00:08:25,680
and second question well

201
00:08:25,680 --> 00:08:28,960
if i forward

202
00:08:28,960 --> 00:08:32,479
all the events and if i do

203
00:08:32,479 --> 00:08:35,519
have a limited storage space what should

204
00:08:35,519 --> 00:08:36,399
i do

205
00:08:36,399 --> 00:08:38,159
because i don't want to forward the

206
00:08:38,159 --> 00:08:40,000
events that are not

207
00:08:40,000 --> 00:08:43,039
worthwhile to monitor so

208
00:08:43,039 --> 00:08:46,560
i want to forward all the most

209
00:08:46,560 --> 00:08:50,720
important event ids how do i find

210
00:08:50,720 --> 00:08:54,959
out which events i should forward

211
00:08:54,959 --> 00:08:58,640
and last but not least if you have all

212
00:08:58,640 --> 00:09:02,160
your events in one space

213
00:09:02,160 --> 00:09:04,959
what do you do with that well some

214
00:09:04,959 --> 00:09:06,320
people say

215
00:09:06,320 --> 00:09:10,240
well we keep it for forensic purpose

216
00:09:10,240 --> 00:09:13,920
but well honestly if you have never

217
00:09:13,920 --> 00:09:15,440
looked into

218
00:09:15,440 --> 00:09:19,279
into the data then you will

219
00:09:19,279 --> 00:09:22,160
not be able to figure out what happened

220
00:09:22,160 --> 00:09:24,399
in case of a breach

221
00:09:24,399 --> 00:09:26,800
so therefore last but not least you want

222
00:09:26,800 --> 00:09:28,800
to create hunting queries you want to

223
00:09:28,800 --> 00:09:30,320
know what is going on in your

224
00:09:30,320 --> 00:09:32,880
environment

225
00:09:34,080 --> 00:09:37,440
and so the next version i converted

226
00:09:37,440 --> 00:09:38,720
everything i had

227
00:09:38,720 --> 00:09:42,480
to powershell and also created a gui

228
00:09:42,480 --> 00:09:45,680
and i presented this gui

229
00:09:45,680 --> 00:09:49,200
at some conferences also blackhead

230
00:09:49,200 --> 00:09:53,200
arsenal in the past and um

231
00:09:53,200 --> 00:09:55,200
i also presented it to other customers

232
00:09:55,200 --> 00:09:56,399
to friends

233
00:09:56,399 --> 00:09:59,279
and the next question that i got from

234
00:09:59,279 --> 00:10:01,760
all the people was

235
00:10:01,760 --> 00:10:05,120
well could you not only make it away

236
00:10:05,120 --> 00:10:05,680
look

237
00:10:05,680 --> 00:10:08,720
we are gooey can you also implement uh

238
00:10:08,720 --> 00:10:12,800
powershell cli excess and i was like

239
00:10:12,800 --> 00:10:16,839
hell yeah that sounds like an amazing

240
00:10:16,839 --> 00:10:18,240
idea

241
00:10:18,240 --> 00:10:21,440
and so the version that i'm talking

242
00:10:21,440 --> 00:10:23,440
today

243
00:10:23,440 --> 00:10:26,880
was born event list

244
00:10:26,880 --> 00:10:33,839
with powershell cli access

245
00:10:40,720 --> 00:10:43,920
so to open power event list you need to

246
00:10:43,920 --> 00:10:45,760
type in in a

247
00:10:45,760 --> 00:10:49,760
command line open event list gui

248
00:10:49,760 --> 00:10:52,959
and shortly after that the event list ui

249
00:10:52,959 --> 00:11:01,839
opens so you have uh

250
00:11:12,079 --> 00:11:15,120
so you have over there are all the miter

251
00:11:15,120 --> 00:11:15,600
attack

252
00:11:15,600 --> 00:11:18,959
areas and also bulking techniques

253
00:11:18,959 --> 00:11:22,160
uh on the left you have the option

254
00:11:22,160 --> 00:11:25,360
to select a baseline

255
00:11:25,360 --> 00:11:28,240
and if you select a certain baseline all

256
00:11:28,240 --> 00:11:29,680
the fields are getting

257
00:11:29,680 --> 00:11:32,800
populated so you can see what

258
00:11:32,800 --> 00:11:35,680
techniques what might the techniques are

259
00:11:35,680 --> 00:11:36,560
covered by

260
00:11:36,560 --> 00:11:39,519
this baseline you also have the option

261
00:11:39,519 --> 00:11:41,279
to import a baseline

262
00:11:41,279 --> 00:11:44,399
or to delete one so here you see all the

263
00:11:44,399 --> 00:11:46,640
pre-populated baselines that are already

264
00:11:46,640 --> 00:11:46,880
in

265
00:11:46,880 --> 00:11:50,079
in event list you see all the either

266
00:11:50,079 --> 00:11:50,720
attack

267
00:11:50,720 --> 00:11:55,200
techniques and areas are pre-populating

268
00:11:55,200 --> 00:11:57,760
so if you want to import a baseline

269
00:11:57,760 --> 00:12:00,160
there are two options you can either

270
00:12:00,160 --> 00:12:03,200
import a backed up gpo or a microsoft

271
00:12:03,200 --> 00:12:05,120
security baseline

272
00:12:05,120 --> 00:12:07,440
you need to specify the folder in which

273
00:12:07,440 --> 00:12:10,720
you find the gpo or baseline

274
00:12:10,720 --> 00:12:13,760
and if you click ok the baseline

275
00:12:13,760 --> 00:12:16,320
is getting imported and you can see here

276
00:12:16,320 --> 00:12:18,639
the blackhead 2020 baseline

277
00:12:18,639 --> 00:12:22,079
was imported into event list and you can

278
00:12:22,079 --> 00:12:22,639
use it

279
00:12:22,639 --> 00:12:25,839
now from that point on

280
00:12:25,839 --> 00:12:28,959
you can also import other microsoft

281
00:12:28,959 --> 00:12:31,200
security baselines

282
00:12:31,200 --> 00:12:34,639
so specifying the path

283
00:12:34,639 --> 00:12:38,000
and in here i have all

284
00:12:38,000 --> 00:12:40,240
the the bass lines that are available at

285
00:12:40,240 --> 00:12:41,279
this point

286
00:12:41,279 --> 00:12:43,839
and if i click okay all the bass lines

287
00:12:43,839 --> 00:12:45,200
are being imported

288
00:12:45,200 --> 00:12:47,839
and if there is already a bass line that

289
00:12:47,839 --> 00:12:49,440
already exists in

290
00:12:49,440 --> 00:12:52,639
event list you get this notification

291
00:12:52,639 --> 00:12:54,959
that this baseline was already imported

292
00:12:54,959 --> 00:12:56,240
and it will not be

293
00:12:56,240 --> 00:13:00,079
imported again and

294
00:13:00,079 --> 00:13:03,439
this takes some time

295
00:13:04,560 --> 00:13:08,160
and after some time everything is

296
00:13:08,160 --> 00:13:08,800
imported

297
00:13:08,800 --> 00:13:11,040
in event list and you can see all the

298
00:13:11,040 --> 00:13:14,480
new baselines in here

299
00:13:15,760 --> 00:13:18,959
and this you can

300
00:13:18,959 --> 00:13:22,639
not only import

301
00:13:22,639 --> 00:13:25,760
you can also delete a baseline so

302
00:13:25,760 --> 00:13:28,800
if you select a baseline

303
00:13:28,800 --> 00:13:32,560
in this case blackhead2020 and you

304
00:13:32,560 --> 00:13:35,680
click delete the selected baseline

305
00:13:35,680 --> 00:13:38,480
it's getting deleted and it's not you

306
00:13:38,480 --> 00:13:40,399
won't find it in there anymore

307
00:13:40,399 --> 00:13:42,720
you can also delete all baselines and

308
00:13:42,720 --> 00:13:44,480
import them again

309
00:13:44,480 --> 00:13:47,600
so here i just deleted all the baselines

310
00:13:47,600 --> 00:13:51,440
and for the powershell demonstration

311
00:13:51,440 --> 00:13:54,480
i reimported all the baselines again

312
00:13:54,480 --> 00:13:58,560
so that we can work with those baselines

313
00:14:00,079 --> 00:14:02,959
to see all the commands that are

314
00:14:02,959 --> 00:14:04,000
available

315
00:14:04,000 --> 00:14:07,279
you can just type in get command

316
00:14:07,279 --> 00:14:10,399
with a parameter module event list and

317
00:14:10,399 --> 00:14:13,120
here they are

318
00:14:13,279 --> 00:14:17,120
um to work with baselines

319
00:14:17,120 --> 00:14:20,480
you can get all the existing baselines

320
00:14:20,480 --> 00:14:22,959
from the database with getline get

321
00:14:22,959 --> 00:14:25,839
baseline name from db

322
00:14:25,839 --> 00:14:30,720
and you can use them to work with them

323
00:14:30,720 --> 00:14:33,519
so you can either delete them with a

324
00:14:33,519 --> 00:14:34,560
command

325
00:14:34,560 --> 00:14:37,199
remove all baselines so all the

326
00:14:37,199 --> 00:14:40,160
baselines are gone

327
00:14:40,160 --> 00:14:45,839
you can import them

328
00:14:47,279 --> 00:14:49,600
with the command import baseline from

329
00:14:49,600 --> 00:14:51,120
folder

330
00:14:51,120 --> 00:14:59,839
you need to specify a path

331
00:15:03,920 --> 00:15:08,000
and now here i imported the gpo

332
00:15:08,000 --> 00:15:10,639
again you can also import all the other

333
00:15:10,639 --> 00:15:12,000
baselines again

334
00:15:12,000 --> 00:15:14,880
as i showed you

335
00:15:21,600 --> 00:15:25,360
and i'm just forwarding a little bit

336
00:15:25,360 --> 00:15:27,040
and you see all the baselines are

337
00:15:27,040 --> 00:15:28,639
imported in here

338
00:15:28,639 --> 00:15:32,160
again so if you want to delete one

339
00:15:32,160 --> 00:15:33,759
single baseline

340
00:15:33,759 --> 00:15:41,040
you can use the command

341
00:15:41,040 --> 00:15:45,599
remove one baseline

342
00:15:46,959 --> 00:15:50,639
and you can pipe in the baseline name

343
00:15:50,639 --> 00:15:55,120
just to the command you can also use

344
00:15:55,120 --> 00:15:59,680
remove one baseline with a parameter

345
00:15:59,680 --> 00:16:02,479
identity

346
00:16:07,120 --> 00:16:10,160
no not identity but baseline name

347
00:16:10,160 --> 00:16:13,440
and just delete the baseline

348
00:16:13,440 --> 00:16:16,480
with the command remove one baseline

349
00:16:16,480 --> 00:16:23,680
and you see the baseline is gone

350
00:16:23,680 --> 00:16:27,839
and now to clarify the first question

351
00:16:27,839 --> 00:16:31,440
how can we generate an event list

352
00:16:31,440 --> 00:16:34,800
so we need a baseline or we need to

353
00:16:34,800 --> 00:16:38,000
check several minor attack techniques or

354
00:16:38,000 --> 00:16:40,880
areas so in this case i select a

355
00:16:40,880 --> 00:16:43,439
baseline

356
00:16:44,480 --> 00:16:46,720
and i click on generate event list and

357
00:16:46,720 --> 00:16:47,759
here we have two

358
00:16:47,759 --> 00:16:50,800
options we have baseline events only so

359
00:16:50,800 --> 00:16:51,680
this just

360
00:16:51,680 --> 00:16:54,560
creates all the events that would be

361
00:16:54,560 --> 00:16:58,000
generated if a baseline would be applied

362
00:16:58,000 --> 00:17:00,240
and you see it again here you have the

363
00:17:00,240 --> 00:17:02,320
event id a description

364
00:17:02,320 --> 00:17:04,720
an event link the recommendation what

365
00:17:04,720 --> 00:17:06,799
you should monitor success failure or

366
00:17:06,799 --> 00:17:07,520
both

367
00:17:07,520 --> 00:17:10,160
and you also have the recommendation if

368
00:17:10,160 --> 00:17:10,959
you should

369
00:17:10,959 --> 00:17:15,359
monitor it for security or not

370
00:17:15,359 --> 00:17:18,240
then we also have minor attack events

371
00:17:18,240 --> 00:17:19,439
this option

372
00:17:19,439 --> 00:17:21,520
you can select if you just want to

373
00:17:21,520 --> 00:17:22,559
select know

374
00:17:22,559 --> 00:17:25,599
what event ids are covered

375
00:17:25,599 --> 00:17:28,719
by this technique

376
00:17:30,240 --> 00:17:33,280
and here we are you see also a link

377
00:17:33,280 --> 00:17:36,400
you see an event name or a description

378
00:17:36,400 --> 00:17:38,880
recommendation and also the techniques

379
00:17:38,880 --> 00:17:41,120
and there's a lot more to do in here so

380
00:17:41,120 --> 00:17:43,200
if you want to contribute to event list

381
00:17:43,200 --> 00:17:45,120
please contact me i would be happy to

382
00:17:45,120 --> 00:17:46,480
have you on my team

383
00:17:46,480 --> 00:17:49,039
and we also have the option to export it

384
00:17:49,039 --> 00:17:51,760
as a csv

385
00:17:51,760 --> 00:17:54,559
we can do the same thing with a command

386
00:17:54,559 --> 00:17:55,200
line

387
00:17:55,200 --> 00:17:57,679
this could be useful if you want to

388
00:17:57,679 --> 00:17:59,280
automate things

389
00:17:59,280 --> 00:18:01,440
so again we use get baseline name from

390
00:18:01,440 --> 00:18:02,720
db

391
00:18:02,720 --> 00:18:06,720
to just pipe in the baseline

392
00:18:09,760 --> 00:18:14,960
and i was too fast

393
00:18:14,960 --> 00:18:17,840
the command here to generate the

394
00:18:17,840 --> 00:18:20,400
baseline event list

395
00:18:20,400 --> 00:18:24,160
is get baseline event list

396
00:18:24,160 --> 00:18:27,600
and if you submit it you get

397
00:18:27,600 --> 00:18:30,640
all those objects where you have

398
00:18:30,640 --> 00:18:32,400
all the information about the event

399
00:18:32,400 --> 00:18:34,880
event id and description also link

400
00:18:34,880 --> 00:18:37,760
and you can just process it without grid

401
00:18:37,760 --> 00:18:39,840
view you can open it

402
00:18:39,840 --> 00:18:42,559
again in the same view as it did in the

403
00:18:42,559 --> 00:18:44,799
ui

404
00:18:44,799 --> 00:18:48,160
so we have the same option not only for

405
00:18:48,160 --> 00:18:50,000
the event list

406
00:18:50,000 --> 00:18:53,840
we can also generate a mitre event list

407
00:18:53,840 --> 00:18:54,720
with get

408
00:18:54,720 --> 00:18:58,480
mitre event list and you see

409
00:18:58,480 --> 00:19:01,760
here are also the objects

410
00:19:01,760 --> 00:19:04,799
again with all the information that is

411
00:19:04,799 --> 00:19:06,559
available in the database behind

412
00:19:06,559 --> 00:19:11,840
event list and without grid view

413
00:19:13,280 --> 00:19:18,000
i can also see it in here in this

414
00:19:18,000 --> 00:19:21,760
view of course you can also export it as

415
00:19:21,760 --> 00:19:24,240
csv with the according powershell

416
00:19:24,240 --> 00:19:26,640
command

417
00:19:30,720 --> 00:19:34,240
you can use the baseline name

418
00:19:34,240 --> 00:19:37,760
you don't have to pipe it

419
00:19:37,760 --> 00:19:40,320
you can also use the baseline name or

420
00:19:40,320 --> 00:19:42,480
the gpo name

421
00:19:42,480 --> 00:19:46,160
and just pipe the name into it

422
00:19:46,160 --> 00:19:49,200
you also don't need to pipe it

423
00:19:49,200 --> 00:19:51,200
there's also a parameter that i will

424
00:19:51,200 --> 00:19:52,400
show you

425
00:19:52,400 --> 00:19:56,080
within the next command

426
00:20:01,919 --> 00:20:06,000
and there's also the option to just

427
00:20:06,000 --> 00:20:10,960
use the miter attack technique ids

428
00:20:10,960 --> 00:20:21,840
and pipe them into get miter event list

429
00:20:21,919 --> 00:20:24,640
here they are

430
00:20:33,679 --> 00:20:35,520
and last but not least this is the

431
00:20:35,520 --> 00:20:37,200
parameter that i meant

432
00:20:37,200 --> 00:20:40,240
uh is identity so you can either use get

433
00:20:40,240 --> 00:20:41,760
minor event list

434
00:20:41,760 --> 00:20:45,120
or the other command to create an

435
00:20:45,120 --> 00:20:48,240
event list with a parameter identity

436
00:20:48,240 --> 00:20:51,280
and you can either pipe techniques

437
00:20:51,280 --> 00:21:03,840
in there or a baseline name

438
00:21:19,120 --> 00:21:22,240
so first question which

439
00:21:22,240 --> 00:21:25,919
events will be generated covered

440
00:21:25,919 --> 00:21:29,360
next which event should be forwarded

441
00:21:29,360 --> 00:21:32,880
and for this use case i implemented

442
00:21:32,880 --> 00:21:35,520
a button that is called generate agent

443
00:21:35,520 --> 00:21:36,880
config

444
00:21:36,880 --> 00:21:39,360
so first of all you need to select

445
00:21:39,360 --> 00:21:40,720
several techniques

446
00:21:40,720 --> 00:21:43,840
or select a baseline and then click on

447
00:21:43,840 --> 00:21:45,600
generate agent config

448
00:21:45,600 --> 00:21:49,440
and yes i had to implement an easter egg

449
00:21:49,440 --> 00:21:52,000
so yeah there are no event ids needed

450
00:21:52,000 --> 00:21:53,840
for microsoft defender atp

451
00:21:53,840 --> 00:21:57,440
but yes there is an easter egg in there

452
00:21:57,440 --> 00:22:00,799
and if you for example select splunk

453
00:22:00,799 --> 00:22:03,919
you just get the snippet the

454
00:22:03,919 --> 00:22:05,200
configuration snippet

455
00:22:05,200 --> 00:22:08,240
that you can just copy and paste into

456
00:22:08,240 --> 00:22:09,760
your configuration

457
00:22:09,760 --> 00:22:13,679
and same thing with x based syntax

458
00:22:13,679 --> 00:22:16,320
so for example oxide or win or windows

459
00:22:16,320 --> 00:22:17,760
event for voting

460
00:22:17,760 --> 00:22:20,799
there's no need to just copy and paste

461
00:22:20,799 --> 00:22:23,919
all the event ids one by one and fill

462
00:22:23,919 --> 00:22:26,640
them out manually and you can do the

463
00:22:26,640 --> 00:22:27,360
same thing

464
00:22:27,360 --> 00:22:30,720
here with a command line

465
00:22:30,720 --> 00:22:35,600
and to see what agents are supported

466
00:22:35,600 --> 00:22:37,760
you can use get help with a full

467
00:22:37,760 --> 00:22:38,640
parameter

468
00:22:38,640 --> 00:22:41,039
and here you see splunk xpath and also

469
00:22:41,039 --> 00:22:43,679
mdatp

470
00:22:45,360 --> 00:22:48,400
to generate an agent config

471
00:22:48,400 --> 00:22:53,200
just type getagent config string

472
00:22:53,520 --> 00:22:56,880
and then select

473
00:22:56,880 --> 00:23:00,799
which techniques should be used

474
00:23:00,799 --> 00:23:04,240
to generate this agent config and also

475
00:23:04,240 --> 00:23:07,520
you could also generate you can also

476
00:23:07,520 --> 00:23:08,080
configure

477
00:23:08,080 --> 00:23:10,720
a baseline

478
00:23:12,720 --> 00:23:16,720
um let me

479
00:23:16,720 --> 00:23:19,520
make it quicker and here is the

480
00:23:19,520 --> 00:23:21,600
forwarder name

481
00:23:21,600 --> 00:23:24,159
in this case i specify splunk you can

482
00:23:24,159 --> 00:23:25,440
select from the

483
00:23:25,440 --> 00:23:28,559
four order names above and here is your

484
00:23:28,559 --> 00:23:30,880
very own configuration snippet that you

485
00:23:30,880 --> 00:23:33,520
can just reuse to forward

486
00:23:33,520 --> 00:23:38,640
your events similar with xpath

487
00:23:38,640 --> 00:23:41,039
and you can not only just copy and paste

488
00:23:41,039 --> 00:23:42,480
it with the cli

489
00:23:42,480 --> 00:23:51,840
you can also use it to automate it

490
00:23:56,000 --> 00:23:59,919
and as i said you can also pipe in

491
00:23:59,919 --> 00:24:05,200
a baseline

492
00:24:05,200 --> 00:24:07,360
so get baseline name from the b select

493
00:24:07,360 --> 00:24:08,480
one and

494
00:24:08,480 --> 00:24:12,240
pipe it to the get agent config string

495
00:24:12,240 --> 00:24:14,159
and with the forwarder name of your

496
00:24:14,159 --> 00:24:15,600
choice

497
00:24:15,600 --> 00:24:19,840
and here we are

498
00:24:23,600 --> 00:24:26,000
so which events should be forwarded

499
00:24:26,000 --> 00:24:27,440
covered

500
00:24:27,440 --> 00:24:29,360
now last but not least the hunting

501
00:24:29,360 --> 00:24:31,279
queries

502
00:24:31,279 --> 00:24:34,559
to generate hunting queries i rely

503
00:24:34,559 --> 00:24:39,840
on sigma sigma is an amazing framework

504
00:24:39,840 --> 00:24:43,600
that uses a generic description

505
00:24:43,600 --> 00:24:47,120
which is in the yaml format to pipe it

506
00:24:47,120 --> 00:24:48,720
through the sigma converter and the

507
00:24:48,720 --> 00:24:50,720
sigma converter

508
00:24:50,720 --> 00:24:54,480
just generates the seam

509
00:24:54,480 --> 00:24:58,400
query of your choice so if you want to

510
00:24:58,400 --> 00:25:00,400
create a query for microsoft defender

511
00:25:00,400 --> 00:25:01,760
adp for example

512
00:25:01,760 --> 00:25:03,360
you can just pipe it through sigma

513
00:25:03,360 --> 00:25:05,919
specify it if you want to

514
00:25:05,919 --> 00:25:08,880
generate a query for splunk you can also

515
00:25:08,880 --> 00:25:09,360
just

516
00:25:09,360 --> 00:25:12,480
change the parameter to convert it

517
00:25:12,480 --> 00:25:16,320
to splunk query language

518
00:25:16,400 --> 00:25:19,760
and to do so i have several

519
00:25:19,760 --> 00:25:21,919
options implemented in event list and

520
00:25:21,919 --> 00:25:24,000
i'm going to show you what is possible

521
00:25:24,000 --> 00:25:28,240
in this next demo

522
00:25:28,240 --> 00:25:30,720
so first of all again you need to select

523
00:25:30,720 --> 00:25:31,919
a baseline

524
00:25:31,919 --> 00:25:34,960
and or check my

525
00:25:34,960 --> 00:25:38,159
attack techniques and or areas

526
00:25:38,159 --> 00:25:40,960
use the button generate queries to

527
00:25:40,960 --> 00:25:41,520
select

528
00:25:41,520 --> 00:25:44,480
a seam solution and to generate the

529
00:25:44,480 --> 00:25:45,760
queries or

530
00:25:45,760 --> 00:25:48,320
you can also use the second option to

531
00:25:48,320 --> 00:25:49,120
just

532
00:25:49,120 --> 00:25:53,520
generate in plain yaml format

533
00:25:53,520 --> 00:25:56,559
so currently if nothing is configured

534
00:25:56,559 --> 00:26:00,159
and if you select the same system

535
00:26:00,159 --> 00:26:02,960
of your choice then you will just get

536
00:26:02,960 --> 00:26:04,640
the plain commands

537
00:26:04,640 --> 00:26:08,559
to generate the sigma queries

538
00:26:08,559 --> 00:26:12,720
on your sigma backend server

539
00:26:13,520 --> 00:26:16,559
i will show you how that looks like

540
00:26:16,559 --> 00:26:19,679
this is useful in case that you have no

541
00:26:19,679 --> 00:26:21,520
sigma installed on the computer on which

542
00:26:21,520 --> 00:26:22,000
you use

543
00:26:22,000 --> 00:26:25,120
event list and here we are you had to

544
00:26:25,120 --> 00:26:26,880
specify the output folder

545
00:26:26,880 --> 00:26:30,880
and now we have two files in here

546
00:26:30,880 --> 00:26:33,200
and a folder we have the event list

547
00:26:33,200 --> 00:26:34,720
queries md

548
00:26:34,720 --> 00:26:38,720
this is a markdown file so you have um

549
00:26:38,720 --> 00:26:41,360
not only the syntax in there that you

550
00:26:41,360 --> 00:26:42,400
need to use to

551
00:26:42,400 --> 00:26:44,720
convert the yaml file to the theme

552
00:26:44,720 --> 00:26:46,159
system of your choice

553
00:26:46,159 --> 00:26:49,200
but you also have um the title the

554
00:26:49,200 --> 00:26:50,159
author

555
00:26:50,159 --> 00:26:52,480
and all the the rest that belongs to the

556
00:26:52,480 --> 00:26:53,440
query

557
00:26:53,440 --> 00:26:56,000
uh in a markdown format so if you want

558
00:26:56,000 --> 00:26:57,120
to document

559
00:26:57,120 --> 00:26:59,840
what you did you can just copy and paste

560
00:26:59,840 --> 00:27:00,159
it

561
00:27:00,159 --> 00:27:02,240
into your documentation system that

562
00:27:02,240 --> 00:27:04,080
supports markdown

563
00:27:04,080 --> 00:27:06,799
we also have the event list queries txt

564
00:27:06,799 --> 00:27:09,679
and here you just have a plain queries

565
00:27:09,679 --> 00:27:12,880
and just without markdown and last but

566
00:27:12,880 --> 00:27:14,640
not least we have the yaml folder

567
00:27:14,640 --> 00:27:16,799
and here are the yaml files so if you

568
00:27:16,799 --> 00:27:17,919
want to

569
00:27:17,919 --> 00:27:21,200
generate the queries on another system

570
00:27:21,200 --> 00:27:25,840
you need the yaml folder and the queries

571
00:27:28,320 --> 00:27:31,360
so if i open it you see

572
00:27:31,360 --> 00:27:34,320
here again here is the the command that

573
00:27:34,320 --> 00:27:35,200
you need

574
00:27:35,200 --> 00:27:38,320
to convert it to uh

575
00:27:38,320 --> 00:27:41,360
the sim system language of your choice

576
00:27:41,360 --> 00:27:42,480
and all the other

577
00:27:42,480 --> 00:27:46,159
uh information in markdown

578
00:27:46,159 --> 00:27:51,279
and here are the just plain queries

579
00:27:52,320 --> 00:27:55,760
and you see that you need to specify the

580
00:27:55,760 --> 00:27:58,799
yaml file uh in the coverage to convert

581
00:27:58,799 --> 00:27:59,840
them and here they

582
00:27:59,840 --> 00:28:03,279
are in the yaml folder so

583
00:28:03,279 --> 00:28:06,480
i said there's another option you can

584
00:28:06,480 --> 00:28:06,880
just

585
00:28:06,880 --> 00:28:09,760
generate them in plain yama format

586
00:28:09,760 --> 00:28:10,480
specify

587
00:28:10,480 --> 00:28:13,760
the folder and select the option and

588
00:28:13,760 --> 00:28:18,399
now if we open uh everything

589
00:28:18,399 --> 00:28:20,480
then you just see the markdown file and

590
00:28:20,480 --> 00:28:22,000
the yaml file

591
00:28:22,000 --> 00:28:24,320
this is useful if you just want to use

592
00:28:24,320 --> 00:28:26,559
it for documentation and if you don't

593
00:28:26,559 --> 00:28:28,559
want to generate any queries

594
00:28:28,559 --> 00:28:31,279
so this is what you need to look for if

595
00:28:31,279 --> 00:28:32,320
you

596
00:28:32,320 --> 00:28:34,399
want to detect for this certain

597
00:28:34,399 --> 00:28:36,720
technique

598
00:28:36,720 --> 00:28:38,720
last but not least yes of course you

599
00:28:38,720 --> 00:28:40,640
also have the young folder

600
00:28:40,640 --> 00:28:42,320
and last but not least there is an

601
00:28:42,320 --> 00:28:44,880
option to directly

602
00:28:44,880 --> 00:28:50,000
generate sigma queries on your pc

603
00:28:50,000 --> 00:28:52,080
therefore you need to configure event

604
00:28:52,080 --> 00:28:54,399
list which you can do with a button

605
00:28:54,399 --> 00:28:57,360
configure event list there is a checkbox

606
00:28:57,360 --> 00:28:59,440
configure sigma path and when you

607
00:28:59,440 --> 00:29:02,159
check it then you need to select the

608
00:29:02,159 --> 00:29:03,120
folder

609
00:29:03,120 --> 00:29:07,200
where the sigma c file is located

610
00:29:07,200 --> 00:29:09,520
so if you clone the sigma repository

611
00:29:09,520 --> 00:29:13,039
this is normally in the tools folder

612
00:29:13,039 --> 00:29:15,679
i specify it click ok and here you can

613
00:29:15,679 --> 00:29:16,240
check

614
00:29:16,240 --> 00:29:18,799
it is configured if this path is set you

615
00:29:18,799 --> 00:29:21,279
will see it

616
00:29:21,279 --> 00:29:24,799
now if we generate queries you can just

617
00:29:24,799 --> 00:29:25,840
select the

618
00:29:25,840 --> 00:29:30,000
system of your choice and generate them

619
00:29:30,000 --> 00:29:32,960
and this takes some time you also need

620
00:29:32,960 --> 00:29:35,279
to select the folder where you want to

621
00:29:35,279 --> 00:29:38,880
store them this takes some time because

622
00:29:38,880 --> 00:29:42,159
uh well event list is powershell

623
00:29:42,159 --> 00:29:44,799
sigma is based on python so event list

624
00:29:44,799 --> 00:29:47,200
just called sigma for all the queries

625
00:29:47,200 --> 00:29:50,640
and therefore it takes some time and now

626
00:29:50,640 --> 00:29:53,919
i will show you the the folder and then

627
00:29:53,919 --> 00:29:56,240
we do some fast forwarding

628
00:29:56,240 --> 00:29:58,640
because yeah that takes some time you

629
00:29:58,640 --> 00:30:01,120
need to be patient

630
00:30:01,120 --> 00:30:03,919
when it is done you see three files one

631
00:30:03,919 --> 00:30:04,880
folder

632
00:30:04,880 --> 00:30:07,840
you know the eventless queries md you

633
00:30:07,840 --> 00:30:09,760
know that queries txt

634
00:30:09,760 --> 00:30:13,520
and you hear a new file sigma log txt

635
00:30:13,520 --> 00:30:16,720
in the markdown file instead of just

636
00:30:16,720 --> 00:30:18,559
having the command to convert those

637
00:30:18,559 --> 00:30:20,000
queries you just have the

638
00:30:20,000 --> 00:30:23,760
direct hunting query that you can just

639
00:30:23,760 --> 00:30:24,159
use

640
00:30:24,159 --> 00:30:26,640
to hunt

641
00:30:28,640 --> 00:30:30,960
then

642
00:30:32,000 --> 00:30:35,039
in the txt you also have all the hunting

643
00:30:35,039 --> 00:30:36,320
queries with all

644
00:30:36,320 --> 00:30:39,760
the additional information

645
00:30:44,799 --> 00:30:46,559
and last but not least there is a log

646
00:30:46,559 --> 00:30:49,200
file and in this log file you see which

647
00:30:49,200 --> 00:30:50,080
query was

648
00:30:50,080 --> 00:30:54,159
processed and if there was a problem

649
00:30:54,159 --> 00:30:55,600
with a certain query

650
00:30:55,600 --> 00:30:58,640
you can also see it here for example if

651
00:30:58,640 --> 00:30:59,600
a certain

652
00:30:59,600 --> 00:31:02,720
yaml file is not supported by sigma yet

653
00:31:02,720 --> 00:31:05,039
you can see it here that it's not

654
00:31:05,039 --> 00:31:07,200
supported and if you need support

655
00:31:07,200 --> 00:31:10,960
you can either create the code yourself

656
00:31:10,960 --> 00:31:12,159
or ask somebody

657
00:31:12,159 --> 00:31:14,720
who can help you and again you have all

658
00:31:14,720 --> 00:31:16,080
the yaml files

659
00:31:16,080 --> 00:31:18,799
also in this folder you can do the same

660
00:31:18,799 --> 00:31:19,360
thing

661
00:31:19,360 --> 00:31:22,960
with powershell if you want to know

662
00:31:22,960 --> 00:31:26,559
which sim systems are supported by sigma

663
00:31:26,559 --> 00:31:29,200
you can just type in get sigma supported

664
00:31:29,200 --> 00:31:33,200
theme from db

665
00:31:33,200 --> 00:31:36,559
and now we want to specify

666
00:31:36,559 --> 00:31:39,760
all the technique ids that we want to

667
00:31:39,760 --> 00:31:42,640
convert into queries

668
00:31:42,640 --> 00:31:48,000
you can do this also bass lines

669
00:31:48,720 --> 00:31:54,480
and let me quickly get us through here

670
00:31:56,480 --> 00:31:59,760
you can use the command get sigma

671
00:31:59,760 --> 00:32:01,120
queries

672
00:32:01,120 --> 00:32:04,799
you need to specify the path

673
00:32:04,799 --> 00:32:08,080
where you want to store those queries

674
00:32:08,080 --> 00:32:12,000
and you need to specify the same name

675
00:32:12,000 --> 00:32:15,440
and if the here their queries are being

676
00:32:15,440 --> 00:32:16,240
generated

677
00:32:16,240 --> 00:32:18,480
and you see also the markdown file and

678
00:32:18,480 --> 00:32:20,080
the txt file

679
00:32:20,080 --> 00:32:23,279
i unconfigured uh event list

680
00:32:23,279 --> 00:32:26,480
so i i i removed the sigma configuration

681
00:32:26,480 --> 00:32:28,320
for this demonstration

682
00:32:28,320 --> 00:32:30,720
because i also want to show you what you

683
00:32:30,720 --> 00:32:31,360
need to do

684
00:32:31,360 --> 00:32:35,678
later if you want to configure sigma

685
00:32:36,559 --> 00:32:39,360
so you can also pop and take the

686
00:32:39,360 --> 00:32:40,399
baseline

687
00:32:40,399 --> 00:32:43,760
to generate a

688
00:32:43,760 --> 00:32:47,120
sigma query or

689
00:32:48,399 --> 00:32:49,880
you can also use the name

690
00:32:49,880 --> 00:32:52,949
[Music]

691
00:32:54,640 --> 00:32:57,279
and you need to specify again the seam

692
00:32:57,279 --> 00:32:59,360
and the path where

693
00:32:59,360 --> 00:33:02,480
this output should be generated and here

694
00:33:02,480 --> 00:33:03,440
we are

695
00:33:03,440 --> 00:33:05,679
event list queries md and eventless

696
00:33:05,679 --> 00:33:11,840
curse txt

697
00:33:15,919 --> 00:33:18,159
and last but not least you can also just

698
00:33:18,159 --> 00:33:20,159
take the identity parameter

699
00:33:20,159 --> 00:33:23,840
and either generate either specify the

700
00:33:23,840 --> 00:33:25,919
baseline or a technique id

701
00:33:25,919 --> 00:33:29,200
or multiple technique ids and this

702
00:33:29,200 --> 00:33:32,000
works too

703
00:33:32,720 --> 00:33:38,240
and here we are

704
00:33:38,240 --> 00:33:43,279
our output is we used to know it

705
00:33:51,120 --> 00:33:53,840
again there are multiple options also

706
00:33:53,840 --> 00:33:55,279
the yaml option

707
00:33:55,279 --> 00:33:59,120
the yaml only option you can specify

708
00:33:59,120 --> 00:34:03,440
with a yaml only parameter

709
00:34:03,440 --> 00:34:05,919
and here we are if we specified yaml

710
00:34:05,919 --> 00:34:07,039
only

711
00:34:07,039 --> 00:34:11,119
then we only have the markdown file with

712
00:34:18,839 --> 00:34:21,599
yaml

713
00:34:21,599 --> 00:34:24,480
and now

714
00:34:25,599 --> 00:34:29,280
to configure event list

715
00:34:29,280 --> 00:34:32,560
so to configure the sigma path you can

716
00:34:32,560 --> 00:34:33,280
use

717
00:34:33,280 --> 00:34:35,760
add event list configuration and then

718
00:34:35,760 --> 00:34:37,520
the path

719
00:34:37,520 --> 00:34:41,119
if you execute the command get sigma

720
00:34:41,119 --> 00:34:41,679
path

721
00:34:41,679 --> 00:34:44,000
you see that the sigma path is

722
00:34:44,000 --> 00:34:45,040
configured

723
00:34:45,040 --> 00:34:47,918
and if the sigma path is configured then

724
00:34:47,918 --> 00:34:48,800
event list

725
00:34:48,800 --> 00:34:52,239
will use this path to directly

726
00:34:52,239 --> 00:34:56,639
convert all the techniques

727
00:34:56,639 --> 00:35:00,480
um into queries of your

728
00:35:00,480 --> 00:35:03,839
sim system

729
00:35:08,079 --> 00:35:11,599
and a new folder is created

730
00:35:11,680 --> 00:35:17,520
and this takes again some time

731
00:35:17,520 --> 00:35:21,200
so i'm fast forwarding it here

732
00:35:21,200 --> 00:35:23,920
and here they are our files marked on

733
00:35:23,920 --> 00:35:26,079
the txt and the log file

734
00:35:26,079 --> 00:35:29,359
as you are used it i used to see

735
00:35:29,359 --> 00:35:32,240
from the ui

736
00:35:37,359 --> 00:35:40,480
and last not least

737
00:35:41,200 --> 00:35:44,400
if there is a sigma path configured you

738
00:35:44,400 --> 00:35:44,960
also

739
00:35:44,960 --> 00:35:47,760
want to have an option to remove it and

740
00:35:47,760 --> 00:35:49,680
you can remove the sigma path with

741
00:35:49,680 --> 00:35:52,480
remove event list configuration and it

742
00:35:52,480 --> 00:35:52,960
is

743
00:35:52,960 --> 00:35:55,359
important that you specify the parameter

744
00:35:55,359 --> 00:35:56,320
sigma path

745
00:35:56,320 --> 00:35:59,040
so that the sigma path is being deleted

746
00:35:59,040 --> 00:36:00,000
and if you

747
00:36:00,000 --> 00:36:03,520
ask or if you query if there is a sigma

748
00:36:03,520 --> 00:36:04,800
path configured

749
00:36:04,800 --> 00:36:08,240
you get nothing as output so

750
00:36:08,240 --> 00:36:13,839
sigma path was successfully removed

751
00:36:14,160 --> 00:36:16,480
last but not least hunting quarries

752
00:36:16,480 --> 00:36:18,560
check

753
00:36:18,560 --> 00:36:21,839
so i also inserted some

754
00:36:21,839 --> 00:36:25,599
other options into event lists

755
00:36:25,599 --> 00:36:28,400
so first option we just talked about

756
00:36:28,400 --> 00:36:30,079
yaml files

757
00:36:30,079 --> 00:36:34,000
so there is an option to uh

758
00:36:34,000 --> 00:36:36,480
import yaml configuration or to remove

759
00:36:36,480 --> 00:36:38,720
existing configuration

760
00:36:38,720 --> 00:36:43,200
and there's also an option

761
00:36:44,079 --> 00:36:47,040
to generate gpos so you need to select

762
00:36:47,040 --> 00:36:49,680
again your techniques or your baseline

763
00:36:49,680 --> 00:36:52,400
well your techniques basically and

764
00:36:52,400 --> 00:36:54,480
specify an output

765
00:36:54,480 --> 00:36:57,920
and here it is your very own

766
00:36:57,920 --> 00:37:02,720
gpo that covers those techniques

767
00:37:04,480 --> 00:37:08,079
and you can also do the same thing with

768
00:37:08,079 --> 00:37:11,520
powershell so with you remove all yaml

769
00:37:11,520 --> 00:37:12,800
configurations

770
00:37:12,800 --> 00:37:14,400
you can just remove the yaml

771
00:37:14,400 --> 00:37:16,480
configurations and use

772
00:37:16,480 --> 00:37:19,760
import yaml configuration from folder

773
00:37:19,760 --> 00:37:23,920
to import your own you need to specify

774
00:37:23,920 --> 00:37:29,760
a path and again this takes some time

775
00:37:30,480 --> 00:37:34,079
so i implemented a fast forward

776
00:37:34,079 --> 00:37:37,200
in here and there they are

777
00:37:37,200 --> 00:37:39,919
imported

778
00:37:40,800 --> 00:37:44,320
so for the gpo path

779
00:37:45,040 --> 00:37:51,200
you can specify the techniques

780
00:37:51,200 --> 00:37:54,640
and i just fast forward a little bit by

781
00:37:54,640 --> 00:37:56,079
myself

782
00:37:56,079 --> 00:37:58,960
and you can just use the option get

783
00:37:58,960 --> 00:38:01,280
group policy from mitre techniques

784
00:38:01,280 --> 00:38:05,839
you need to specify an output path

785
00:38:07,440 --> 00:38:10,800
and here they are

786
00:38:10,800 --> 00:38:13,920
or here it is

787
00:38:14,079 --> 00:38:19,839
you're very new gpo

788
00:38:23,839 --> 00:38:26,000
you can also just use the parameter

789
00:38:26,000 --> 00:38:27,119
identity

790
00:38:27,119 --> 00:38:33,359
to specify one or more techniques

791
00:38:33,359 --> 00:38:37,279
also specify the output path

792
00:38:40,160 --> 00:38:42,960
and i

793
00:38:44,960 --> 00:38:48,480
and here it is your very new

794
00:38:48,480 --> 00:38:52,320
gpo the second

795
00:38:54,800 --> 00:38:58,240
so those are the options

796
00:38:58,240 --> 00:39:00,560
that you now have with the latest

797
00:39:00,560 --> 00:39:01,359
version of

798
00:39:01,359 --> 00:39:03,440
event list that i will release shortly

799
00:39:03,440 --> 00:39:05,160
after blackhead asia

800
00:39:05,160 --> 00:39:07,839
2020

801
00:39:07,839 --> 00:39:10,720
and if you are now interested in

802
00:39:10,720 --> 00:39:12,800
contributing to eventless

803
00:39:12,800 --> 00:39:15,760
i would love to have you on my team so

804
00:39:15,760 --> 00:39:18,240
if you have any ideas on how to pro

805
00:39:18,240 --> 00:39:21,520
improve it or on new features or if you

806
00:39:21,520 --> 00:39:22,880
want to support me

807
00:39:22,880 --> 00:39:25,839
by just um also improving the data

808
00:39:25,839 --> 00:39:27,200
behind event list

809
00:39:27,200 --> 00:39:30,000
i would love to have you on my team so

810
00:39:30,000 --> 00:39:30,800
let me know

811
00:39:30,800 --> 00:39:34,000
if you already have worked on event list

812
00:39:34,000 --> 00:39:35,680
just create a pull request make sure

813
00:39:35,680 --> 00:39:37,680
that all the tests are running that the

814
00:39:37,680 --> 00:39:38,079
code

815
00:39:38,079 --> 00:39:40,880
is valid and just create a pull request

816
00:39:40,880 --> 00:39:43,119
for the development branch

817
00:39:43,119 --> 00:39:45,839
if you have any ideas let me know on

818
00:39:45,839 --> 00:39:47,280
twitter i'm miami

819
00:39:47,280 --> 00:39:50,320
that is the best way to contact me

820
00:39:50,320 --> 00:39:53,680
and i'm really looking forward to your

821
00:39:53,680 --> 00:39:55,359
ideas

822
00:39:55,359 --> 00:39:58,800
so in total first security auditing

823
00:39:58,800 --> 00:40:01,680
is amazing and you should definitely do

824
00:40:01,680 --> 00:40:02,000
it

825
00:40:02,000 --> 00:40:05,119
more often in your environment

826
00:40:05,119 --> 00:40:07,520
event list can help you with that now

827
00:40:07,520 --> 00:40:09,119
you can also automate it

828
00:40:09,119 --> 00:40:13,520
with cli and last but not least

829
00:40:13,520 --> 00:40:16,560
i'm super thrilled to hear

830
00:40:16,560 --> 00:40:20,000
what your use case is with eventless

831
00:40:20,000 --> 00:40:22,319
so if you have an amazing use case to

832
00:40:22,319 --> 00:40:23,200
automate

833
00:40:23,200 --> 00:40:26,079
something with event list let me know

834
00:40:26,079 --> 00:40:27,280
tag me on twitter

835
00:40:27,280 --> 00:40:30,400
just make sure that i see what amazing

836
00:40:30,400 --> 00:40:31,680
work you are doing

837
00:40:31,680 --> 00:40:34,560
i'm super excited to see what you're

838
00:40:34,560 --> 00:40:35,920
coming up with

839
00:40:35,920 --> 00:40:39,280
and so far thank you very much for your

840
00:40:39,280 --> 00:40:40,560
attention

841
00:40:40,560 --> 00:40:43,359
i hope that event list is very helpful

842
00:40:43,359 --> 00:40:44,720
for you

843
00:40:44,720 --> 00:40:48,400
and uh i wish you a wonderful day

844
00:40:48,400 --> 00:40:52,880
and an amazing black hat 2020

845
00:40:52,880 --> 00:40:58,319
have a wonderful day bye bye

