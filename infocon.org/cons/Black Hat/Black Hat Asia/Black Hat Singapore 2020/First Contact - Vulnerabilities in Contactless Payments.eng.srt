1
00:00:02,560 --> 00:00:04,400
when we set out to do this

2
00:00:04,400 --> 00:00:07,200
research we had a few suspicions about

3
00:00:07,200 --> 00:00:07,600
the

4
00:00:07,600 --> 00:00:10,800
rapidly changing banking environment

5
00:00:10,800 --> 00:00:13,280
contactless has long been touted as a

6
00:00:13,280 --> 00:00:14,799
secure predecessor

7
00:00:14,799 --> 00:00:17,840
to chip inserted transactions but we

8
00:00:17,840 --> 00:00:19,359
wondered whether this was really the

9
00:00:19,359 --> 00:00:19,920
case

10
00:00:19,920 --> 00:00:22,560
or if it was more a case of the king's

11
00:00:22,560 --> 00:00:25,439
new clothes

12
00:00:26,240 --> 00:00:29,439
so why is every startup these days a

13
00:00:29,439 --> 00:00:30,800
bank

14
00:00:30,800 --> 00:00:33,280
you probably noticed that the banking

15
00:00:33,280 --> 00:00:35,440
environment has changed pretty rapidly

16
00:00:35,440 --> 00:00:37,360
over the last few years

17
00:00:37,360 --> 00:00:39,600
now it's possible to open a bank account

18
00:00:39,600 --> 00:00:40,719
without ever

19
00:00:40,719 --> 00:00:43,360
going into a branch or a physical

20
00:00:43,360 --> 00:00:44,079
building

21
00:00:44,079 --> 00:00:46,079
instead it's possible to open a bank

22
00:00:46,079 --> 00:00:47,760
account purely through

23
00:00:47,760 --> 00:00:50,559
a digital application using a mobile

24
00:00:50,559 --> 00:00:52,320
phone

25
00:00:52,320 --> 00:00:54,239
and whilst this has been happening we've

26
00:00:54,239 --> 00:00:56,480
also seen a huge increase in the kind of

27
00:00:56,480 --> 00:00:58,480
merchant services that have been offered

28
00:00:58,480 --> 00:00:59,280
as well

29
00:00:59,280 --> 00:01:02,239
so there's been a huge influx in

30
00:01:02,239 --> 00:01:03,280
merchant services

31
00:01:03,280 --> 00:01:04,879
or offerings for things like mobile

32
00:01:04,879 --> 00:01:08,320
point of sales terminals

33
00:01:09,520 --> 00:01:11,600
so with this rapidly changing

34
00:01:11,600 --> 00:01:13,600
environment in mind

35
00:01:13,600 --> 00:01:16,960
when we came to produce this research we

36
00:01:16,960 --> 00:01:19,200
came up with a set of questions that we

37
00:01:19,200 --> 00:01:21,280
wanted to explore around

38
00:01:21,280 --> 00:01:25,520
contactless and the banking environment

39
00:01:25,520 --> 00:01:28,880
and those are has contactless payments

40
00:01:28,880 --> 00:01:32,400
resulted in a fraud reduction

41
00:01:32,400 --> 00:01:36,320
is contactless a modern mode of payment

42
00:01:36,320 --> 00:01:40,079
are our payments standardized

43
00:01:40,079 --> 00:01:42,600
and what are the security measures

44
00:01:42,600 --> 00:01:46,560
inside of a contactless transaction

45
00:01:46,560 --> 00:01:49,040
so let's talk about the first question

46
00:01:49,040 --> 00:01:49,840
which is

47
00:01:49,840 --> 00:01:52,840
has contact list resulted in a fraud

48
00:01:52,840 --> 00:01:55,759
reduction

49
00:01:55,759 --> 00:01:57,920
if we look at official statistics

50
00:01:57,920 --> 00:01:59,360
provided by

51
00:01:59,360 --> 00:02:02,159
people like visa so the card brands

52
00:02:02,159 --> 00:02:03,759
you'll notice that they

53
00:02:03,759 --> 00:02:06,079
seem to suggest that contactless has in

54
00:02:06,079 --> 00:02:07,439
fact resulted in

55
00:02:07,439 --> 00:02:11,038
a reduction of fraud so they state that

56
00:02:11,038 --> 00:02:11,879
between

57
00:02:11,879 --> 00:02:14,879
2017 and 2018

58
00:02:14,879 --> 00:02:17,280
in europe there was a decline in fraud

59
00:02:17,280 --> 00:02:18,959
rates of 40 percent

60
00:02:18,959 --> 00:02:21,200
which indeed sounds pretty promising it

61
00:02:21,200 --> 00:02:22,000
sounds really

62
00:02:22,000 --> 00:02:26,000
fantastic in fact but if we compare

63
00:02:26,000 --> 00:02:29,360
these statistics to those provided by

64
00:02:29,360 --> 00:02:32,239
an organization called action fraud this

65
00:02:32,239 --> 00:02:33,680
is a body in the uk

66
00:02:33,680 --> 00:02:36,800
which is made up by the police and it's

67
00:02:36,800 --> 00:02:38,080
an independent body

68
00:02:38,080 --> 00:02:41,360
that consumers can report cases of fraud

69
00:02:41,360 --> 00:02:44,879
to so they actually indicate

70
00:02:44,879 --> 00:02:47,280
that fraud between the same period that

71
00:02:47,280 --> 00:02:48,319
visa europe

72
00:02:48,319 --> 00:02:53,120
talks about between 2017 and 2018

73
00:02:53,120 --> 00:02:56,319
saw an increase in cases almost

74
00:02:56,319 --> 00:02:59,519
double in fact and they state that on

75
00:02:59,519 --> 00:03:03,040
average the average loss associated

76
00:03:03,040 --> 00:03:06,519
with contactless ford in the uk was

77
00:03:06,519 --> 00:03:09,760
650 pounds and one particular case they

78
00:03:09,760 --> 00:03:12,000
investigated resulted in a loss

79
00:03:12,000 --> 00:03:16,480
of 400 000 pounds

80
00:03:17,200 --> 00:03:18,959
so the trouble with looking at any of

81
00:03:18,959 --> 00:03:20,239
these kind of

82
00:03:20,239 --> 00:03:23,040
statistics is it's a bit like looking at

83
00:03:23,040 --> 00:03:24,000
this animal

84
00:03:24,000 --> 00:03:26,239
animal so from the front it looks a bit

85
00:03:26,239 --> 00:03:27,680
like a shark

86
00:03:27,680 --> 00:03:29,519
and from the back it looks a bit like a

87
00:03:29,519 --> 00:03:32,080
tiger but in fact it's neither

88
00:03:32,080 --> 00:03:34,000
because we don't have access to the raw

89
00:03:34,000 --> 00:03:36,080
data points we can't really make any

90
00:03:36,080 --> 00:03:37,200
assumptions or

91
00:03:37,200 --> 00:03:40,480
conclusions about what's happening with

92
00:03:40,480 --> 00:03:42,640
contactless fraud so it's really

93
00:03:42,640 --> 00:03:44,000
difficult to say

94
00:03:44,000 --> 00:03:46,159
has contactless actually resulted in a

95
00:03:46,159 --> 00:03:49,040
fraud reduction

96
00:03:50,720 --> 00:03:52,879
so this leads us on to our next question

97
00:03:52,879 --> 00:03:53,920
which is

98
00:03:53,920 --> 00:03:57,040
is contactless a modern mode of payment

99
00:03:57,040 --> 00:03:59,439
so i think we all assume when a new

100
00:03:59,439 --> 00:04:00,400
technology

101
00:04:00,400 --> 00:04:02,799
comes about that in some way it's an

102
00:04:02,799 --> 00:04:03,680
iteration

103
00:04:03,680 --> 00:04:06,720
an improvement upon the previous form of

104
00:04:06,720 --> 00:04:07,760
technology

105
00:04:07,760 --> 00:04:10,799
so we wondered assuming that this is the

106
00:04:10,799 --> 00:04:12,400
case in what ways

107
00:04:12,400 --> 00:04:14,959
is contactless an improvement on chip

108
00:04:14,959 --> 00:04:16,880
inserted transactions

109
00:04:16,880 --> 00:04:20,720
how is it better if we look at the

110
00:04:20,720 --> 00:04:22,720
history of payments this will give us a

111
00:04:22,720 --> 00:04:25,759
better idea so in 1979

112
00:04:25,759 --> 00:04:28,320
we see the first implementation of

113
00:04:28,320 --> 00:04:29,440
electronic

114
00:04:29,440 --> 00:04:31,360
electronically transferred payment

115
00:04:31,360 --> 00:04:32,560
information

116
00:04:32,560 --> 00:04:36,479
so mag stripe was invented before 1979

117
00:04:36,479 --> 00:04:37,560
but it wasn't until

118
00:04:37,560 --> 00:04:40,400
1979 that the first point of sales

119
00:04:40,400 --> 00:04:41,199
terminal

120
00:04:41,199 --> 00:04:46,400
was implemented then we see a huge

121
00:04:46,400 --> 00:04:49,120
use of mag stripe in the beginning of

122
00:04:49,120 --> 00:04:50,800
the 80s

123
00:04:50,800 --> 00:04:54,080
and with that we also see that

124
00:04:54,080 --> 00:04:56,320
criminals start to understand the ways

125
00:04:56,320 --> 00:04:57,759
in which they can manipulate this

126
00:04:57,759 --> 00:04:58,880
technology

127
00:04:58,880 --> 00:05:00,479
and the ways in which they can carry out

128
00:05:00,479 --> 00:05:03,360
fraud so a real classic case of fraud

129
00:05:03,360 --> 00:05:06,320
associated with mag stripe is the

130
00:05:06,320 --> 00:05:07,680
restaurant scenario

131
00:05:07,680 --> 00:05:10,400
where you go into a restaurant you enjoy

132
00:05:10,400 --> 00:05:11,360
a lovely meal

133
00:05:11,360 --> 00:05:14,800
and at the end of the meal you

134
00:05:14,800 --> 00:05:18,000
ask for the bill or the check and

135
00:05:18,000 --> 00:05:21,199
you give your card and it's taken away

136
00:05:21,199 --> 00:05:24,880
with the waitress or waiter and they go

137
00:05:24,880 --> 00:05:26,400
and swipe your card

138
00:05:26,400 --> 00:05:28,800
but instead of simply swiping like your

139
00:05:28,800 --> 00:05:31,120
card they swipe it twice so there's this

140
00:05:31,120 --> 00:05:33,440
opportunity in time where they can

141
00:05:33,440 --> 00:05:34,400
actually

142
00:05:34,400 --> 00:05:36,639
take a second reading of your card and

143
00:05:36,639 --> 00:05:38,800
either make a second payment

144
00:05:38,800 --> 00:05:42,560
presumably to a fraudulent terminal or

145
00:05:42,560 --> 00:05:45,280
they can actually clone the card itself

146
00:05:45,280 --> 00:05:46,800
so one of the biggest problems with

147
00:05:46,800 --> 00:05:48,240
magstripe is that it's really

148
00:05:48,240 --> 00:05:50,720
susceptible to cloning

149
00:05:50,720 --> 00:05:52,960
so with all of this going on the card

150
00:05:52,960 --> 00:05:55,120
brands started to see that there was a

151
00:05:55,120 --> 00:05:56,800
significant problem

152
00:05:56,800 --> 00:05:58,880
and they started having some discussions

153
00:05:58,880 --> 00:06:00,800
in the early 90s

154
00:06:00,800 --> 00:06:02,800
trying to come up with a solution that

155
00:06:02,800 --> 00:06:04,160
may be suitable

156
00:06:04,160 --> 00:06:06,800
to solve some of the issues that we

157
00:06:06,800 --> 00:06:08,720
associate with magstripe

158
00:06:08,720 --> 00:06:10,639
and they eventually came up with a

159
00:06:10,639 --> 00:06:11,840
standard called the

160
00:06:11,840 --> 00:06:14,160
emv standard and they formed a

161
00:06:14,160 --> 00:06:15,120
consortium

162
00:06:15,120 --> 00:06:19,440
called emv co in 1996.

163
00:06:19,440 --> 00:06:22,639
so chip inserted transactions were meant

164
00:06:22,639 --> 00:06:26,160
to provide uh solutions to many of the

165
00:06:26,160 --> 00:06:27,840
issues associated

166
00:06:27,840 --> 00:06:30,720
with magstripe what chip did is it

167
00:06:30,720 --> 00:06:31,520
brought about

168
00:06:31,520 --> 00:06:33,199
a number of different technologies that

169
00:06:33,199 --> 00:06:34,960
we actually don't have

170
00:06:34,960 --> 00:06:38,000
with mag stripe so we first of all we

171
00:06:38,000 --> 00:06:38,880
actually have

172
00:06:38,880 --> 00:06:41,199
authentication of the card itself which

173
00:06:41,199 --> 00:06:42,880
we don't have with magstrone

174
00:06:42,880 --> 00:06:45,120
so this is done through asymmetric

175
00:06:45,120 --> 00:06:46,319
cryptography

176
00:06:46,319 --> 00:06:48,240
and we know that the key is stored on

177
00:06:48,240 --> 00:06:50,160
the chip itself

178
00:06:50,160 --> 00:06:51,919
we also have verification of the

179
00:06:51,919 --> 00:06:54,160
cardholder which normally takes place

180
00:06:54,160 --> 00:06:56,560
either through a pin code or through a

181
00:06:56,560 --> 00:06:57,440
signature

182
00:06:57,440 --> 00:06:59,199
depending on where you are carrying out

183
00:06:59,199 --> 00:07:01,520
the transaction and depending on where

184
00:07:01,520 --> 00:07:04,560
your card has been issued and then we

185
00:07:04,560 --> 00:07:06,240
have the signing of the

186
00:07:06,240 --> 00:07:08,560
transaction itself through a cryptogram

187
00:07:08,560 --> 00:07:09,759
so the whole

188
00:07:09,759 --> 00:07:12,400
transaction is packaged up and has a

189
00:07:12,400 --> 00:07:16,880
level of integrity associated with it

190
00:07:16,880 --> 00:07:20,319
so this all sounds great and it was

191
00:07:20,319 --> 00:07:21,680
great for a very long time

192
00:07:21,680 --> 00:07:24,479
and then in the beginning of the sort of

193
00:07:24,479 --> 00:07:27,759
the early 2000s we see that

194
00:07:27,759 --> 00:07:31,759
the card brands start thinking about

195
00:07:31,759 --> 00:07:34,639
newer forms of technology ways that they

196
00:07:34,639 --> 00:07:35,199
could get

197
00:07:35,199 --> 00:07:38,319
us to spend in a secure manner but in a

198
00:07:38,319 --> 00:07:39,840
faster manner

199
00:07:39,840 --> 00:07:42,960
so the solution for this was nfc

200
00:07:42,960 --> 00:07:46,080
or contactless and the first

201
00:07:46,080 --> 00:07:48,000
implementation of this was through

202
00:07:48,000 --> 00:07:49,840
mastercard and they had initial

203
00:07:49,840 --> 00:07:53,199
trial period in 2005

204
00:07:53,199 --> 00:07:56,639
and then later in 2007 visa came up with

205
00:07:56,639 --> 00:07:57,280
their own

206
00:07:57,280 --> 00:07:59,039
implementation of the technology called

207
00:07:59,039 --> 00:08:01,039
visa paywave

208
00:08:01,039 --> 00:08:03,759
and so as i said nfc is meant to have us

209
00:08:03,759 --> 00:08:05,280
spending more money

210
00:08:05,280 --> 00:08:08,479
quickly in a in at least as

211
00:08:08,479 --> 00:08:10,840
secure manner as chip inserted

212
00:08:10,840 --> 00:08:12,240
transactions

213
00:08:12,240 --> 00:08:15,199
but there's a sort of big caveat to that

214
00:08:15,199 --> 00:08:16,560
which is

215
00:08:16,560 --> 00:08:19,120
actually when we look at things when we

216
00:08:19,120 --> 00:08:20,080
think about

217
00:08:20,080 --> 00:08:23,840
is contactless truly an iteration from a

218
00:08:23,840 --> 00:08:27,039
securities perspective

219
00:08:27,039 --> 00:08:30,479
compared to chip and search transactions

220
00:08:30,479 --> 00:08:33,519
that's not necessarily the case so if

221
00:08:33,519 --> 00:08:35,279
you look at

222
00:08:35,279 --> 00:08:37,760
how contactless works you'll see that

223
00:08:37,760 --> 00:08:38,479
nfc

224
00:08:38,479 --> 00:08:40,479
actually includes a legacy mode so

225
00:08:40,479 --> 00:08:43,120
support for legacy forms of technology

226
00:08:43,120 --> 00:08:46,480
such as mag stripe equivalent that chip

227
00:08:46,480 --> 00:08:48,959
doesn't doesn't at this point and it

228
00:08:48,959 --> 00:08:51,600
also uses the same key and same areas of

229
00:08:51,600 --> 00:08:52,320
memory

230
00:08:52,320 --> 00:08:54,000
on the chip as a chip inserted

231
00:08:54,000 --> 00:08:56,240
transaction so the answer to the

232
00:08:56,240 --> 00:08:57,120
question

233
00:08:57,120 --> 00:08:59,600
is this a modern form of payment yes it

234
00:08:59,600 --> 00:09:01,600
is from a technology perspective

235
00:09:01,600 --> 00:09:03,440
but in many ways it isn't an in

236
00:09:03,440 --> 00:09:05,920
iteration or improvement from a security

237
00:09:05,920 --> 00:09:07,040
perspective

238
00:09:07,040 --> 00:09:11,040
at least from what we see so far

239
00:09:11,600 --> 00:09:14,240
so the next question we sought to answer

240
00:09:14,240 --> 00:09:14,720
is

241
00:09:14,720 --> 00:09:17,920
are payments standardized

242
00:09:17,920 --> 00:09:19,440
now unfortunately if you want to

243
00:09:19,440 --> 00:09:21,519
understand how payments work

244
00:09:21,519 --> 00:09:23,519
you will have to go through somewhere

245
00:09:23,519 --> 00:09:26,480
between 600 and 700 pages of

246
00:09:26,480 --> 00:09:27,440
documentation

247
00:09:27,440 --> 00:09:31,200
on the env co website

248
00:09:31,200 --> 00:09:33,200
but in addition to this what you'll find

249
00:09:33,200 --> 00:09:35,040
is that a lot of the documentation

250
00:09:35,040 --> 00:09:36,000
associated with

251
00:09:36,000 --> 00:09:38,959
payments is proprietary so that means it

252
00:09:38,959 --> 00:09:40,959
isn't publicly available

253
00:09:40,959 --> 00:09:43,680
which proves to be a big issue if you're

254
00:09:43,680 --> 00:09:47,440
trying to learn about payments

255
00:09:47,440 --> 00:09:50,720
so what we're going to do now is talk a

256
00:09:50,720 --> 00:09:51,360
little bit

257
00:09:51,360 --> 00:09:55,200
about the actual workflow um

258
00:09:55,200 --> 00:09:58,320
of contactless and how that works so

259
00:09:58,320 --> 00:10:00,880
interestingly in fact mastercard and

260
00:10:00,880 --> 00:10:03,200
visa although they're very similar

261
00:10:03,200 --> 00:10:06,560
at the point where they adopted nfc

262
00:10:06,560 --> 00:10:09,600
the way in which they carry out nfc or

263
00:10:09,600 --> 00:10:11,279
contactless transactions

264
00:10:11,279 --> 00:10:13,519
differs slightly and we'll get into that

265
00:10:13,519 --> 00:10:15,920
part as well

266
00:10:15,920 --> 00:10:18,640
so here's a short description of how emv

267
00:10:18,640 --> 00:10:19,600
works

268
00:10:19,600 --> 00:10:23,360
so first of all contactless uses nfc

269
00:10:23,360 --> 00:10:26,959
to transmit data and nfc uses inductive

270
00:10:26,959 --> 00:10:27,839
coupling

271
00:10:27,839 --> 00:10:29,600
so the first thing that happens when you

272
00:10:29,600 --> 00:10:31,760
go to a shop and you try to make a

273
00:10:31,760 --> 00:10:32,880
payment

274
00:10:32,880 --> 00:10:35,680
is that the terminal provides power to

275
00:10:35,680 --> 00:10:36,399
your card

276
00:10:36,399 --> 00:10:38,320
and initiates the transaction so it

277
00:10:38,320 --> 00:10:40,800
wakes up the card

278
00:10:40,800 --> 00:10:42,720
the next thing to know is that env

279
00:10:42,720 --> 00:10:45,200
provides or describes a subset of

280
00:10:45,200 --> 00:10:47,839
protocols that allow for the processing

281
00:10:47,839 --> 00:10:51,040
of payment information and

282
00:10:51,040 --> 00:10:54,240
within contactless or within any kind of

283
00:10:54,240 --> 00:10:55,360
emv

284
00:10:55,360 --> 00:10:58,560
protocols or we call this

285
00:10:58,560 --> 00:11:02,240
set of the subset of protocols kernels

286
00:11:02,240 --> 00:11:05,040
so the first kernel kernel one is

287
00:11:05,040 --> 00:11:06,079
responsible for

288
00:11:06,079 --> 00:11:08,720
some types of visa card then we have

289
00:11:08,720 --> 00:11:11,440
kernel two which is for mastercard

290
00:11:11,440 --> 00:11:13,920
and finally we have kernel 3 which is

291
00:11:13,920 --> 00:11:16,320
also for some types of visa card along

292
00:11:16,320 --> 00:11:19,279
with jcb

293
00:11:21,279 --> 00:11:25,200
so when we look at the individual

294
00:11:25,200 --> 00:11:28,000
chunks of data sent between the terminal

295
00:11:28,000 --> 00:11:29,279
and the card

296
00:11:29,279 --> 00:11:31,680
they take a form called application

297
00:11:31,680 --> 00:11:32,720
protocol

298
00:11:32,720 --> 00:11:36,480
data units or apdu and within

299
00:11:36,480 --> 00:11:39,680
each message that is sent the data takes

300
00:11:39,680 --> 00:11:41,360
the form of something called tag

301
00:11:41,360 --> 00:11:44,720
length value or tlv and this is a

302
00:11:44,720 --> 00:11:46,720
hierarchical structure

303
00:11:46,720 --> 00:11:49,440
so within each tag you can also have

304
00:11:49,440 --> 00:11:50,079
nested

305
00:11:50,079 --> 00:11:53,920
tags so if we look at this example of

306
00:11:53,920 --> 00:11:54,320
some

307
00:11:54,320 --> 00:11:56,399
data that's sent between the card and

308
00:11:56,399 --> 00:11:57,680
the terminal

309
00:11:57,680 --> 00:11:59,680
it looks a little bit complicated to

310
00:11:59,680 --> 00:12:01,360
understand

311
00:12:01,360 --> 00:12:03,279
but it's actually not too difficult so

312
00:12:03,279 --> 00:12:05,360
the first line if we read that we can

313
00:12:05,360 --> 00:12:06,240
see the six

314
00:12:06,240 --> 00:12:09,200
f which tells us that this is the file

315
00:12:09,200 --> 00:12:10,959
control

316
00:12:10,959 --> 00:12:13,519
information template and all this means

317
00:12:13,519 --> 00:12:15,279
is it's defining

318
00:12:15,279 --> 00:12:18,079
the data for contactless card

319
00:12:18,079 --> 00:12:20,240
communication

320
00:12:20,240 --> 00:12:23,040
and then we have two pieces of data

321
00:12:23,040 --> 00:12:24,160
which tell us how

322
00:12:24,160 --> 00:12:26,959
long the communication is going to be

323
00:12:26,959 --> 00:12:28,560
and then we have this value that starts

324
00:12:28,560 --> 00:12:29,440
with three

325
00:12:29,440 --> 00:12:32,800
two five zero four one five

326
00:12:32,800 --> 00:12:36,639
nine and this is the binary value

327
00:12:36,639 --> 00:12:42,320
for to pay dot sys.ddf01

328
00:12:42,320 --> 00:12:46,240
and so this is just telling us

329
00:12:46,240 --> 00:12:48,240
that this is the payment system

330
00:12:48,240 --> 00:12:51,600
environment for this particular card

331
00:12:51,600 --> 00:12:54,160
so again this is a little bit more

332
00:12:54,160 --> 00:12:56,000
complicated to understand but

333
00:12:56,000 --> 00:12:57,760
if we have a look at things at the

334
00:12:57,760 --> 00:12:59,680
logical level it's

335
00:12:59,680 --> 00:13:03,200
quite a lot easier to understand how

336
00:13:03,200 --> 00:13:05,200
this works so as i mentioned the first

337
00:13:05,200 --> 00:13:06,720
thing that happens

338
00:13:06,720 --> 00:13:09,120
is that the terminal is going to

339
00:13:09,120 --> 00:13:10,959
initiate the transaction is going to

340
00:13:10,959 --> 00:13:11,519
provide

341
00:13:11,519 --> 00:13:14,000
power to the card and it's going to wake

342
00:13:14,000 --> 00:13:15,519
up the card

343
00:13:15,519 --> 00:13:17,839
so the first thing that it does is it

344
00:13:17,839 --> 00:13:19,440
asks the card

345
00:13:19,440 --> 00:13:22,800
what payment proximity payment system

346
00:13:22,800 --> 00:13:24,399
environment do you work with

347
00:13:24,399 --> 00:13:26,880
so it says do you support visa do you

348
00:13:26,880 --> 00:13:28,480
support mastercard

349
00:13:28,480 --> 00:13:31,440
or do you support american express so

350
00:13:31,440 --> 00:13:32,880
this process is just

351
00:13:32,880 --> 00:13:35,440
the process of reading the proximity

352
00:13:35,440 --> 00:13:36,959
payment system environment

353
00:13:36,959 --> 00:13:40,160
or ppse for short

354
00:13:40,160 --> 00:13:42,880
the next thing that happens is the card

355
00:13:42,880 --> 00:13:44,720
responds to the terminal

356
00:13:44,720 --> 00:13:46,480
with something called its application

357
00:13:46,480 --> 00:13:49,279
identifier so this is where it tells it

358
00:13:49,279 --> 00:13:52,560
i support the following modes so i

359
00:13:52,560 --> 00:13:56,160
support for example visa i support visas

360
00:13:56,160 --> 00:13:57,040
smart card

361
00:13:57,040 --> 00:14:00,399
debit structure and perhaps something

362
00:14:00,399 --> 00:14:01,040
like

363
00:14:01,040 --> 00:14:03,839
mag stripe mode so it will respond with

364
00:14:03,839 --> 00:14:05,440
the modes that it supports

365
00:14:05,440 --> 00:14:08,720
and in the order of priority so again

366
00:14:08,720 --> 00:14:09,360
this is

367
00:14:09,360 --> 00:14:11,040
the card is responding with its

368
00:14:11,040 --> 00:14:14,079
application identifier

369
00:14:14,079 --> 00:14:17,040
the next step is that the terminal is

370
00:14:17,040 --> 00:14:18,160
going to select

371
00:14:18,160 --> 00:14:20,560
the application identifier that it wants

372
00:14:20,560 --> 00:14:21,920
to work with

373
00:14:21,920 --> 00:14:24,560
so in this example it's going to select

374
00:14:24,560 --> 00:14:27,119
visa

375
00:14:28,000 --> 00:14:29,600
the next thing that's going to happen is

376
00:14:29,600 --> 00:14:31,279
the card is going to send

377
00:14:31,279 --> 00:14:34,480
a list of information that it requires

378
00:14:34,480 --> 00:14:37,519
in order to complete the transaction

379
00:14:37,519 --> 00:14:40,480
so it's going to send things like the

380
00:14:40,480 --> 00:14:41,440
currency

381
00:14:41,440 --> 00:14:44,639
the amount the unique number

382
00:14:44,639 --> 00:14:46,880
and something called the terminal

383
00:14:46,880 --> 00:14:48,560
transaction qualifier so it's just

384
00:14:48,560 --> 00:14:50,240
sending a list of information

385
00:14:50,240 --> 00:14:52,800
that it requires from the terminal in

386
00:14:52,800 --> 00:14:54,959
order to carry out the transaction

387
00:14:54,959 --> 00:14:56,720
and this is called the processing

388
00:14:56,720 --> 00:14:58,160
options data object

389
00:14:58,160 --> 00:15:00,399
list

390
00:15:01,440 --> 00:15:03,680
the terminal is then going to send the

391
00:15:03,680 --> 00:15:05,279
requested data

392
00:15:05,279 --> 00:15:08,560
to the card so it's going to send the

393
00:15:08,560 --> 00:15:10,000
currency for

394
00:15:10,000 --> 00:15:11,920
the transaction is going to send the

395
00:15:11,920 --> 00:15:13,199
amount

396
00:15:13,199 --> 00:15:15,360
the unique number and its terminal

397
00:15:15,360 --> 00:15:16,720
transaction qualifiers

398
00:15:16,720 --> 00:15:18,720
and this is quite important so in the

399
00:15:18,720 --> 00:15:21,120
terminal transaction qualifiers

400
00:15:21,120 --> 00:15:23,600
the terminal specifies the kinds of

401
00:15:23,600 --> 00:15:25,680
modes that it actually supports the

402
00:15:25,680 --> 00:15:26,959
modes of operating

403
00:15:26,959 --> 00:15:28,800
so it's going to send all the requested

404
00:15:28,800 --> 00:15:30,160
information to the card

405
00:15:30,160 --> 00:15:32,639
and it's going to issue a command called

406
00:15:32,639 --> 00:15:33,440
generate

407
00:15:33,440 --> 00:15:35,759
the application cryptogram so it's going

408
00:15:35,759 --> 00:15:37,279
to ask the card to generate the

409
00:15:37,279 --> 00:15:39,199
application cryptogram

410
00:15:39,199 --> 00:15:42,479
using this information

411
00:15:42,959 --> 00:15:46,480
so the card is then going to respond

412
00:15:46,480 --> 00:15:49,680
with its with the cryptogram for

413
00:15:49,680 --> 00:15:52,480
the transaction and it's going to send

414
00:15:52,480 --> 00:15:52,880
back

415
00:15:52,880 --> 00:15:54,800
importantly something called the card

416
00:15:54,800 --> 00:15:56,399
transaction qualifiers

417
00:15:56,399 --> 00:16:00,079
so this is a list of the kind

418
00:16:00,079 --> 00:16:02,639
of modes of operating that the card

419
00:16:02,639 --> 00:16:04,560
supports so for example whether it

420
00:16:04,560 --> 00:16:05,360
supports

421
00:16:05,360 --> 00:16:08,240
online pin function whether it supports

422
00:16:08,240 --> 00:16:09,360
signature

423
00:16:09,360 --> 00:16:12,079
or whether it supports a mode called

424
00:16:12,079 --> 00:16:13,680
consumer device

425
00:16:13,680 --> 00:16:16,399
cardholder verification method and this

426
00:16:16,399 --> 00:16:17,279
in fact is

427
00:16:17,279 --> 00:16:20,399
something that if you use a phone or

428
00:16:20,399 --> 00:16:23,920
tablet that supports nfc or contactless

429
00:16:23,920 --> 00:16:24,959
modes

430
00:16:24,959 --> 00:16:29,040
then this will actually issue cd cvm

431
00:16:29,040 --> 00:16:31,120
so it's not typically associated with a

432
00:16:31,120 --> 00:16:32,240
physical card

433
00:16:32,240 --> 00:16:37,360
but is normally associated with a device

434
00:16:37,360 --> 00:16:40,079
then at this point the terminal once it

435
00:16:40,079 --> 00:16:42,079
has received that information

436
00:16:42,079 --> 00:16:46,000
it's going to carry out a risk analysis

437
00:16:46,000 --> 00:16:48,720
so before it can determine the next step

438
00:16:48,720 --> 00:16:50,320
it's going to look at

439
00:16:50,320 --> 00:16:53,440
a configuration file which contains a

440
00:16:53,440 --> 00:16:54,399
list of different

441
00:16:54,399 --> 00:16:57,440
limits depending on the transaction

442
00:16:57,440 --> 00:16:59,839
depending on the merchant and the region

443
00:16:59,839 --> 00:17:00,560
that you're

444
00:17:00,560 --> 00:17:03,680
in and this will define different

445
00:17:03,680 --> 00:17:05,199
spending limits for the types of

446
00:17:05,199 --> 00:17:06,480
transactions

447
00:17:06,480 --> 00:17:08,480
it's going to compare that information

448
00:17:08,480 --> 00:17:10,959
to the card transaction qualifiers

449
00:17:10,959 --> 00:17:13,359
and the terminal transaction qualifiers

450
00:17:13,359 --> 00:17:15,359
and this will determine the next step

451
00:17:15,359 --> 00:17:17,679
so at this point it is either going to

452
00:17:17,679 --> 00:17:20,799
be able to send the transaction

453
00:17:20,799 --> 00:17:24,319
to the card networks and eventually

454
00:17:24,319 --> 00:17:27,119
to the card issuer to determine whether

455
00:17:27,119 --> 00:17:29,280
this can take place

456
00:17:29,280 --> 00:17:31,919
or it's going to ask for cardholder

457
00:17:31,919 --> 00:17:32,880
verification

458
00:17:32,880 --> 00:17:34,720
so it's going to step up the transaction

459
00:17:34,720 --> 00:17:36,240
and ask for something like a pin

460
00:17:36,240 --> 00:17:39,280
or a signature

461
00:17:41,440 --> 00:17:43,760
and i'll now hand it over to tim who's

462
00:17:43,760 --> 00:17:44,640
going to

463
00:17:44,640 --> 00:17:48,080
talk about the next section

464
00:17:48,080 --> 00:17:51,120
thank you so

465
00:17:51,120 --> 00:17:53,919
this research mainly is about how to

466
00:17:53,919 --> 00:17:54,640
bypass

467
00:17:54,640 --> 00:17:57,760
a cardholder verification for example by

468
00:17:57,760 --> 00:17:58,480
avoiding

469
00:17:58,480 --> 00:18:01,600
presenting pin for visa cards but in

470
00:18:01,600 --> 00:18:02,000
fact

471
00:18:02,000 --> 00:18:05,120
in order to bypass it we need to bypass

472
00:18:05,120 --> 00:18:07,440
other features such as offline

473
00:18:07,440 --> 00:18:08,720
authentication

474
00:18:08,720 --> 00:18:12,240
and online authorization processes so

475
00:18:12,240 --> 00:18:15,840
let's speak about them deeper

476
00:18:15,840 --> 00:18:19,039
so oda or offline data authentication

477
00:18:19,039 --> 00:18:22,000
it uses rsa cryptography so terminal

478
00:18:22,000 --> 00:18:22,400
will

479
00:18:22,400 --> 00:18:25,840
ensure that the card was actually issued

480
00:18:25,840 --> 00:18:27,280
by the bank

481
00:18:27,280 --> 00:18:30,720
and there were two older versions of oda

482
00:18:30,720 --> 00:18:31,520
schemes

483
00:18:31,520 --> 00:18:34,640
first one was sda static and the second

484
00:18:34,640 --> 00:18:35,760
was dda

485
00:18:35,760 --> 00:18:39,280
dynamic but in fact neither of them

486
00:18:39,280 --> 00:18:42,960
ensure the terminal that all information

487
00:18:42,960 --> 00:18:44,960
passed by the cart is genuine and not

488
00:18:44,960 --> 00:18:45,600
tampered

489
00:18:45,600 --> 00:18:49,280
so unless cart uses the most modern

490
00:18:49,280 --> 00:18:52,320
uh oda scheme which is called cda it's

491
00:18:52,320 --> 00:18:54,080
very easy to change a cardholder

492
00:18:54,080 --> 00:18:56,480
verification and for example saying

493
00:18:56,480 --> 00:18:59,120
that instead of pin i want to use

494
00:18:59,120 --> 00:19:01,520
signature or i want to use no cvm

495
00:19:01,520 --> 00:19:03,520
and no cardhold verification will be

496
00:19:03,520 --> 00:19:06,960
required for this transaction

497
00:19:06,960 --> 00:19:09,120
so that was basically the main reason

498
00:19:09,120 --> 00:19:11,840
why visa and mastercard diverged

499
00:19:11,840 --> 00:19:15,039
when they were implementing nfc so

500
00:19:15,039 --> 00:19:17,120
visa decided that their customer

501
00:19:17,120 --> 00:19:18,240
experience and

502
00:19:18,240 --> 00:19:20,320
rapidness of the transaction is the most

503
00:19:20,320 --> 00:19:22,240
important and more important than some

504
00:19:22,240 --> 00:19:23,120
useless

505
00:19:23,120 --> 00:19:26,240
security features like oda so

506
00:19:26,240 --> 00:19:29,360
that what happened when uh nfc was

507
00:19:29,360 --> 00:19:30,240
implemented

508
00:19:30,240 --> 00:19:33,600
mastercard set cda as mandatory

509
00:19:33,600 --> 00:19:35,520
and now it supports for contactless

510
00:19:35,520 --> 00:19:38,240
transactions for most of their cards

511
00:19:38,240 --> 00:19:41,120
and if for some reason cta will be

512
00:19:41,120 --> 00:19:42,559
failed during the transaction

513
00:19:42,559 --> 00:19:44,480
transaction will not leave the terminal

514
00:19:44,480 --> 00:19:45,679
and terminal will

515
00:19:45,679 --> 00:19:48,799
will reject this transaction visa done

516
00:19:48,799 --> 00:19:49,840
the opposite

517
00:19:49,840 --> 00:19:52,960
uh they put cd is not mandatory just

518
00:19:52,960 --> 00:19:53,600
because

519
00:19:53,600 --> 00:19:57,200
cda increases the time when cardholder

520
00:19:57,200 --> 00:19:59,600
needs to keep the cart in front of the

521
00:19:59,600 --> 00:20:00,240
terminal

522
00:20:00,240 --> 00:20:02,320
and this is not very convenient and they

523
00:20:02,320 --> 00:20:04,159
decided that convenience is more

524
00:20:04,159 --> 00:20:06,720
important than security

525
00:20:06,720 --> 00:20:09,200
next both visa and mastercard have

526
00:20:09,200 --> 00:20:11,120
subsets of different versions of

527
00:20:11,120 --> 00:20:12,400
cryptograms

528
00:20:12,400 --> 00:20:14,799
and most of their cryptograms most of

529
00:20:14,799 --> 00:20:17,760
mastercard cryptograms for example use

530
00:20:17,760 --> 00:20:19,919
all essential fields which are required

531
00:20:19,919 --> 00:20:22,640
for cardholder verification decisions

532
00:20:22,640 --> 00:20:26,080
where for example mastercard uses cvm

533
00:20:26,080 --> 00:20:27,919
results fields or tbr

534
00:20:27,919 --> 00:20:31,120
aip to make decisions and what kind of

535
00:20:31,120 --> 00:20:33,360
decisions has been made to pass it along

536
00:20:33,360 --> 00:20:35,039
to the eastern bank

537
00:20:35,039 --> 00:20:37,200
visa on the other side decided to

538
00:20:37,200 --> 00:20:39,120
implement fields which are called

539
00:20:39,120 --> 00:20:42,400
ctq and ttq card holder

540
00:20:42,400 --> 00:20:45,360
card and terminal transaction qualifiers

541
00:20:45,360 --> 00:20:46,559
which

542
00:20:46,559 --> 00:20:49,120
are using for exactly the same purpose

543
00:20:49,120 --> 00:20:50,640
for making a decision

544
00:20:50,640 --> 00:20:53,520
for cardholder verification and other

545
00:20:53,520 --> 00:20:55,280
risk management

546
00:20:55,280 --> 00:20:58,320
surprisingly uh in none of

547
00:20:58,320 --> 00:21:02,000
these cryptogram versions ctq or ttq

548
00:21:02,000 --> 00:21:04,799
are not are presenting so there are

549
00:21:04,799 --> 00:21:05,360
three

550
00:21:05,360 --> 00:21:08,399
most popular

551
00:21:08,640 --> 00:21:12,559
uh cryptogram versions cvm10 cvn 17

552
00:21:12,559 --> 00:21:16,320
and cvm18 and actually cvn 17 is the

553
00:21:16,320 --> 00:21:17,280
most popular

554
00:21:17,280 --> 00:21:20,080
so we met it in more than half of the

555
00:21:20,080 --> 00:21:22,400
cards we were working with

556
00:21:22,400 --> 00:21:25,039
and there are only four fails amount and

557
00:21:25,039 --> 00:21:26,320
predictable number

558
00:21:26,320 --> 00:21:29,440
transaction counter and

559
00:21:29,440 --> 00:21:31,919
is your application data so imaginary

560
00:21:31,919 --> 00:21:32,799
situation

561
00:21:32,799 --> 00:21:36,000
hackers want to clone a transaction

562
00:21:36,000 --> 00:21:37,840
from from from your cart and use it in

563
00:21:37,840 --> 00:21:40,000
the future they definitely can

564
00:21:40,000 --> 00:21:42,320
pre-calculate the price let's assume

565
00:21:42,320 --> 00:21:43,440
that they are going

566
00:21:43,440 --> 00:21:44,960
to some big supermarket and they're

567
00:21:44,960 --> 00:21:46,720
going to buy the tv and they already

568
00:21:46,720 --> 00:21:49,120
know the price of this tv

569
00:21:49,120 --> 00:21:52,320
uh there there is no date in in this

570
00:21:52,320 --> 00:21:54,000
list of fields means they

571
00:21:54,000 --> 00:21:56,880
don't need to predict at which date this

572
00:21:56,880 --> 00:21:57,360
fraud

573
00:21:57,360 --> 00:22:00,720
will be carried out and the only one

574
00:22:00,720 --> 00:22:01,840
field is un

575
00:22:01,840 --> 00:22:04,320
as you can see and if for some reason

576
00:22:04,320 --> 00:22:06,240
terminal is malfunctioning

577
00:22:06,240 --> 00:22:09,120
or if for some other reasons hacker can

578
00:22:09,120 --> 00:22:09,760
force

579
00:22:09,760 --> 00:22:13,120
un to be a specific value

580
00:22:13,120 --> 00:22:15,200
that's it that's basically the only one

581
00:22:15,200 --> 00:22:17,200
protection mechanism against clone in

582
00:22:17,200 --> 00:22:18,640
the term against cloning the

583
00:22:18,640 --> 00:22:20,640
transactions and that means that more

584
00:22:20,640 --> 00:22:23,360
fraud can be carried out

585
00:22:23,360 --> 00:22:25,280
other versions of cryptograms like 10

586
00:22:25,280 --> 00:22:27,520
and 18 as you can see they have more

587
00:22:27,520 --> 00:22:29,039
fields however

588
00:22:29,039 --> 00:22:32,159
there are either no ctq no

589
00:22:32,159 --> 00:22:35,200
ttq means that this information

590
00:22:35,200 --> 00:22:38,159
doesn't go to the issuing bank how

591
00:22:38,159 --> 00:22:39,679
mastercard conducts the

592
00:22:39,679 --> 00:22:41,280
cardholder verification so at the

593
00:22:41,280 --> 00:22:42,960
beginning card provides

594
00:22:42,960 --> 00:22:46,240
cvm list to the card to the terminal

595
00:22:46,240 --> 00:22:48,559
saying what features it support does it

596
00:22:48,559 --> 00:22:49,440
support pin

597
00:22:49,440 --> 00:22:52,880
signature or no cvm then the terminal

598
00:22:52,880 --> 00:22:55,840
will respond in the generation of the

599
00:22:55,840 --> 00:22:57,120
cryptogram request

600
00:22:57,120 --> 00:22:59,600
saying that this is the cardholder

601
00:22:59,600 --> 00:23:00,320
verification

602
00:23:00,320 --> 00:23:02,640
results what exact card card

603
00:23:02,640 --> 00:23:04,960
verification method has been chosen

604
00:23:04,960 --> 00:23:08,159
to make this transaction and the card

605
00:23:08,159 --> 00:23:08,720
will

606
00:23:08,720 --> 00:23:11,120
take all this data and put it as an

607
00:23:11,120 --> 00:23:14,559
input for the cryptogram

608
00:23:14,559 --> 00:23:16,480
wrap it around offline data

609
00:23:16,480 --> 00:23:17,679
authentication

610
00:23:17,679 --> 00:23:20,960
scheme cda and pass it to the terminal

611
00:23:20,960 --> 00:23:23,440
terminal will decrypt it and if nothing

612
00:23:23,440 --> 00:23:25,520
is tempered if cardholding verification

613
00:23:25,520 --> 00:23:26,880
methods are not tempered

614
00:23:26,880 --> 00:23:28,320
everything will be all right the

615
00:23:28,320 --> 00:23:30,720
terminal will pass cryptogram to the

616
00:23:30,720 --> 00:23:32,799
acquiring initial bank

617
00:23:32,799 --> 00:23:34,640
and the issue bank once again will

618
00:23:34,640 --> 00:23:37,039
ensure that none of this data

619
00:23:37,039 --> 00:23:40,640
was tampered so visa will do things

620
00:23:40,640 --> 00:23:43,919
in the opposite way much more simplistic

621
00:23:43,919 --> 00:23:47,200
way so terminal will provide ctq

622
00:23:47,200 --> 00:23:49,760
terminal transaction qualifier when it

623
00:23:49,760 --> 00:23:50,480
simply

624
00:23:50,480 --> 00:23:53,600
indicates whether transaction requires a

625
00:23:53,600 --> 00:23:55,360
cardholder verification or not

626
00:23:55,360 --> 00:23:58,640
that's it then cart will provide ctq

627
00:23:58,640 --> 00:24:00,880
field where it will say

628
00:24:00,880 --> 00:24:02,400
what carthold verifications are

629
00:24:02,400 --> 00:24:04,720
supported pin no cvm

630
00:24:04,720 --> 00:24:07,840
or cdc vm so which are essentially for

631
00:24:07,840 --> 00:24:09,440
the mobile wallet

632
00:24:09,440 --> 00:24:11,840
we'll put information like amount in the

633
00:24:11,840 --> 00:24:12,640
cryptogram

634
00:24:12,640 --> 00:24:16,000
and give it to the terminal

635
00:24:16,000 --> 00:24:20,240
next visa for their

636
00:24:20,240 --> 00:24:23,440
terminals when they certify uh terminals

637
00:24:23,440 --> 00:24:25,520
for visa contactless transactions they

638
00:24:25,520 --> 00:24:27,600
do not require to pass ctq

639
00:24:27,600 --> 00:24:30,480
or ttp fails to the acquiring emission

640
00:24:30,480 --> 00:24:31,039
banks

641
00:24:31,039 --> 00:24:33,600
and that's why most of terminals will

642
00:24:33,600 --> 00:24:37,120
not send this information

643
00:24:37,120 --> 00:24:39,200
but so what each and bank will receive

644
00:24:39,200 --> 00:24:40,799
will receive amount

645
00:24:40,799 --> 00:24:43,440
the country of the terminal and maybe

646
00:24:43,440 --> 00:24:44,320
online pin

647
00:24:44,320 --> 00:24:47,520
if it was presented some terminals

648
00:24:47,520 --> 00:24:48,559
actually provide

649
00:24:48,559 --> 00:24:51,440
cvm results fields which was inherited

650
00:24:51,440 --> 00:24:52,320
from env

651
00:24:52,320 --> 00:24:55,760
or mastercard that probably just due to

652
00:24:55,760 --> 00:24:57,520
the fact that it looks a little bit

653
00:24:57,520 --> 00:24:58,559
insane

654
00:24:58,559 --> 00:25:01,200
if the issuing bank don't possess any

655
00:25:01,200 --> 00:25:04,000
information of what cardholderification

656
00:25:04,000 --> 00:25:07,760
has been made so that's exactly

657
00:25:07,760 --> 00:25:10,240
what we shown one year ago on our

658
00:25:10,240 --> 00:25:10,960
research

659
00:25:10,960 --> 00:25:14,240
we've shown how to con transactions

660
00:25:14,240 --> 00:25:16,240
how to make these transactions without

661
00:25:16,240 --> 00:25:17,360
entering pin

662
00:25:17,360 --> 00:25:19,840
how to bypass hard and soft limits in

663
00:25:19,840 --> 00:25:20,640
the uk

664
00:25:20,640 --> 00:25:24,400
and in europe this time

665
00:25:24,400 --> 00:25:26,240
we are going to talk a little bit more

666
00:25:26,240 --> 00:25:28,000
about how to protect

667
00:25:28,000 --> 00:25:29,840
how to spot the vulnerability what

668
00:25:29,840 --> 00:25:31,840
issuing banks can do

669
00:25:31,840 --> 00:25:34,640
so let's assume we are talking about

670
00:25:34,640 --> 00:25:35,919
contactless transaction

671
00:25:35,919 --> 00:25:39,120
for 46 pounds yeah uh

672
00:25:39,120 --> 00:25:42,320
so ctq and ttq fields are useless so

673
00:25:42,320 --> 00:25:44,240
they are not checked during the offline

674
00:25:44,240 --> 00:25:45,919
data authentication

675
00:25:45,919 --> 00:25:48,240
and terminal will not pass them to the

676
00:25:48,240 --> 00:25:50,320
asian bank so bank will not receive this

677
00:25:50,320 --> 00:25:52,000
information

678
00:25:52,000 --> 00:25:55,520
next our attack is about pretending to

679
00:25:55,520 --> 00:25:55,760
be

680
00:25:55,760 --> 00:25:58,240
a mobile wallet but in fact if the

681
00:25:58,240 --> 00:25:59,039
transaction

682
00:25:59,039 --> 00:26:01,760
has been made using the mobile wallet it

683
00:26:01,760 --> 00:26:03,520
will be absolutely different from

684
00:26:03,520 --> 00:26:05,600
a regular car transaction because

685
00:26:05,600 --> 00:26:07,039
regular car transaction

686
00:26:07,039 --> 00:26:10,320
has fields which are called which are

687
00:26:10,320 --> 00:26:12,159
collected in field 55

688
00:26:12,159 --> 00:26:15,520
they collect all information related to

689
00:26:15,520 --> 00:26:19,360
emv transactions or similar where

690
00:26:19,360 --> 00:26:22,159
if the payment was made using a mobile

691
00:26:22,159 --> 00:26:22,640
wallet

692
00:26:22,640 --> 00:26:24,720
the only one information that bank will

693
00:26:24,720 --> 00:26:25,679
receive is

694
00:26:25,679 --> 00:26:28,640
the token which was substituted with for

695
00:26:28,640 --> 00:26:30,480
the original card and

696
00:26:30,480 --> 00:26:32,640
some other original card information so

697
00:26:32,640 --> 00:26:34,799
it will be a distinctive difference

698
00:26:34,799 --> 00:26:38,400
between both of them if transaction

699
00:26:38,400 --> 00:26:40,880
has required pin and pin was entered

700
00:26:40,880 --> 00:26:42,480
this encrypted information

701
00:26:42,480 --> 00:26:45,840
also will go to the shin bank as i said

702
00:26:45,840 --> 00:26:48,240
cvm results are not mandatory for

703
00:26:48,240 --> 00:26:50,559
visa contactless transactions but some

704
00:26:50,559 --> 00:26:52,000
terminals actually give

705
00:26:52,000 --> 00:26:55,039
this information so this is very useful

706
00:26:55,039 --> 00:26:57,039
this is exactly the moment when you can

707
00:26:57,039 --> 00:26:58,320
spot the

708
00:26:58,320 --> 00:27:01,600
attack that someone pretends to be

709
00:27:01,600 --> 00:27:05,120
a mobile wallet for example because

710
00:27:05,120 --> 00:27:07,520
if transaction is made using the mobile

711
00:27:07,520 --> 00:27:10,000
wallet cbm result fields will

712
00:27:10,000 --> 00:27:13,200
put to offline pin which is the

713
00:27:13,200 --> 00:27:13,919
equivalent

714
00:27:13,919 --> 00:27:17,200
for cdcvm and we all probably

715
00:27:17,200 --> 00:27:20,080
know that offline pin is not the way how

716
00:27:20,080 --> 00:27:22,159
contactless transactions can be checked

717
00:27:22,159 --> 00:27:22,720
because

718
00:27:22,720 --> 00:27:24,640
for checking offline pin you need to tap

719
00:27:24,640 --> 00:27:25,919
your card twice and

720
00:27:25,919 --> 00:27:29,200
this is not very helpful

721
00:27:29,200 --> 00:27:32,720
so let's try playing game and spot a

722
00:27:32,720 --> 00:27:35,279
fraudulent contactless transactions

723
00:27:35,279 --> 00:27:38,240
so first one one thousand pounds online

724
00:27:38,240 --> 00:27:39,679
pin was presented

725
00:27:39,679 --> 00:27:43,039
seems legit next 1000 pounds

726
00:27:43,039 --> 00:27:46,799
no field 55 talking instead also good

727
00:27:46,799 --> 00:27:48,880
that means that transaction was made

728
00:27:48,880 --> 00:27:50,000
using gpa

729
00:27:50,000 --> 00:27:53,200
or apple pay third one one thousand

730
00:27:53,200 --> 00:27:53,919
pounds

731
00:27:53,919 --> 00:27:57,600
offline pin that's a clear indicator of

732
00:27:57,600 --> 00:28:00,799
fraudulent transaction where

733
00:28:00,799 --> 00:28:03,760
cdc attack was made how we described it

734
00:28:03,760 --> 00:28:05,520
one year ago

735
00:28:05,520 --> 00:28:08,559
next one 1000 pounds no land pin

736
00:28:08,559 --> 00:28:11,200
no offline pin bad or at least

737
00:28:11,200 --> 00:28:14,320
suspicious because of very high price

738
00:28:14,320 --> 00:28:16,240
but it still might be terminal which

739
00:28:16,240 --> 00:28:18,880
accepts only signatures

740
00:28:18,880 --> 00:28:22,799
and last one 100 pounds no online pin

741
00:28:22,799 --> 00:28:24,799
even we don't know because it might be a

742
00:28:24,799 --> 00:28:26,559
genuine transaction which required

743
00:28:26,559 --> 00:28:27,360
signature

744
00:28:27,360 --> 00:28:29,360
or it might be some type of fraudulent

745
00:28:29,360 --> 00:28:30,480
attack

746
00:28:30,480 --> 00:28:32,399
and the problem is that all of these

747
00:28:32,399 --> 00:28:33,840
five transactions

748
00:28:33,840 --> 00:28:36,480
will be and probably should be accepted

749
00:28:36,480 --> 00:28:38,000
by the issuing bank

750
00:28:38,000 --> 00:28:40,720
the thing is that visa says that card

751
00:28:40,720 --> 00:28:43,520
issuers are ultimately responsible for

752
00:28:43,520 --> 00:28:45,279
all type of fraud and validating the

753
00:28:45,279 --> 00:28:47,520
transactions the problem is that

754
00:28:47,520 --> 00:28:50,559
they don't have sometimes enough

755
00:28:50,559 --> 00:28:52,320
information to understand

756
00:28:52,320 --> 00:28:54,559
is the fraudulent transaction or not as

757
00:28:54,559 --> 00:28:56,159
we can see

758
00:28:56,159 --> 00:28:59,840
at the moment

759
00:29:06,159 --> 00:29:09,120
so now let's talk about the transaction

760
00:29:09,120 --> 00:29:09,600
amount

761
00:29:09,600 --> 00:29:12,399
as we saw before 1000 pounds is clearly

762
00:29:12,399 --> 00:29:13,039
too much

763
00:29:13,039 --> 00:29:16,480
where 100 is pretty much okay

764
00:29:16,480 --> 00:29:19,760
yeah so that's exactly what psd2 states

765
00:29:19,760 --> 00:29:23,120
so psd2 is a modern payment

766
00:29:23,120 --> 00:29:25,039
service directive which regulates

767
00:29:25,039 --> 00:29:26,399
payments in europe

768
00:29:26,399 --> 00:29:28,799
and one of their features is strong

769
00:29:28,799 --> 00:29:31,600
customer authentication which says that

770
00:29:31,600 --> 00:29:35,760
if customer spends totally more than 250

771
00:29:35,760 --> 00:29:39,200
euros or do more than five transactions

772
00:29:39,200 --> 00:29:43,200
is required to use pin and use chip

773
00:29:43,200 --> 00:29:45,279
until that contactless transactions will

774
00:29:45,279 --> 00:29:46,640
be disabled

775
00:29:46,640 --> 00:29:50,399
and this is a reasonable idea

776
00:29:50,399 --> 00:29:53,360
that good examples of reasonable limits

777
00:29:53,360 --> 00:29:55,360
where a certain amount still can be

778
00:29:55,360 --> 00:29:57,520
spent using contactless without cardhold

779
00:29:57,520 --> 00:29:59,600
verification using tap and go

780
00:29:59,600 --> 00:30:02,159
but at some point you still need to to

781
00:30:02,159 --> 00:30:03,360
enter pin

782
00:30:03,360 --> 00:30:06,559
the problem is that psd2 still has

783
00:30:06,559 --> 00:30:10,080
a few issues first of all even in europe

784
00:30:10,080 --> 00:30:12,399
it's still not across the board

785
00:30:12,399 --> 00:30:15,520
and that means that not all cars and

786
00:30:15,520 --> 00:30:17,440
asian banks support it

787
00:30:17,440 --> 00:30:20,240
next we already found a few issues

788
00:30:20,240 --> 00:30:23,360
related to cumulative limits and we

789
00:30:23,360 --> 00:30:25,279
published a white paper showing how

790
00:30:25,279 --> 00:30:29,279
these restrictions can be bypassed

791
00:30:30,720 --> 00:30:34,000
so we were trying to say that all visa

792
00:30:34,000 --> 00:30:35,679
cards all around the globe are

793
00:30:35,679 --> 00:30:37,039
vulnerable

794
00:30:37,039 --> 00:30:39,440
if we'll talk about european or asian

795
00:30:39,440 --> 00:30:41,440
cards which mostly will require

796
00:30:41,440 --> 00:30:44,960
online pin our attack can be applied

797
00:30:44,960 --> 00:30:47,279
and we need to change ctq to signature

798
00:30:47,279 --> 00:30:50,000
or we'll need to change ctq to no cvm

799
00:30:50,000 --> 00:30:53,120
and transaction will be made without pin

800
00:30:53,120 --> 00:30:55,440
if you'll be talking about us cars which

801
00:30:55,440 --> 00:30:57,840
by design support fixed signatures most

802
00:30:57,840 --> 00:30:58,880
of the time

803
00:30:58,880 --> 00:31:01,760
the attack is about changing ctq only to

804
00:31:01,760 --> 00:31:02,640
no cvm

805
00:31:02,640 --> 00:31:05,039
so customer doesn't need to leave a

806
00:31:05,039 --> 00:31:06,880
signature on the receipt

807
00:31:06,880 --> 00:31:11,279
if you are talking about uk cards the

808
00:31:11,279 --> 00:31:13,120
they will not allow to use online pin

809
00:31:13,120 --> 00:31:15,120
they will require to use chip and stat

810
00:31:15,120 --> 00:31:18,240
and the attack is about changing ctq to

811
00:31:18,240 --> 00:31:21,200
mobile wallet cdcvm and also this attack

812
00:31:21,200 --> 00:31:23,120
requires to change in

813
00:31:23,120 --> 00:31:26,158
stdq fields

814
00:31:26,480 --> 00:31:29,120
we sat the year ago why this attack

815
00:31:29,120 --> 00:31:31,039
can't be simply replicated for

816
00:31:31,039 --> 00:31:33,679
mastercard and the answer was that most

817
00:31:33,679 --> 00:31:34,080
of

818
00:31:34,080 --> 00:31:37,039
all mastercard cards contain cdcvm bit

819
00:31:37,039 --> 00:31:37,440
in

820
00:31:37,440 --> 00:31:40,559
aip field which is the part of every

821
00:31:40,559 --> 00:31:41,919
cryptogram

822
00:31:41,919 --> 00:31:44,080
but if you'll go deeper over the last

823
00:31:44,080 --> 00:31:45,679
three years we checked

824
00:31:45,679 --> 00:31:48,399
something around 60 different cards in

825
00:31:48,399 --> 00:31:49,039
asia

826
00:31:49,039 --> 00:31:52,480
europe america pizza mastercard and we

827
00:31:52,480 --> 00:31:55,360
found actually a few ways to bypass pin

828
00:31:55,360 --> 00:31:58,159
for mastercard cards as well

829
00:31:58,159 --> 00:32:00,559
if you listen broadly and look at this

830
00:32:00,559 --> 00:32:02,640
spreadsheet you can see that

831
00:32:02,640 --> 00:32:05,279
mastercard contactless transactions cd

832
00:32:05,279 --> 00:32:06,320
is mandatory

833
00:32:06,320 --> 00:32:08,640
when for cheap transactions it was not

834
00:32:08,640 --> 00:32:10,640
mandatory and it's still mandatory for

835
00:32:10,640 --> 00:32:11,120
visa

836
00:32:11,120 --> 00:32:13,120
it's the other way around so contact

837
00:32:13,120 --> 00:32:14,159
less transactions

838
00:32:14,159 --> 00:32:18,159
don't require cda at all where in the

839
00:32:18,159 --> 00:32:21,519
uh cheap visa cards still you might find

840
00:32:21,519 --> 00:32:24,640
cases and we found one of them where cda

841
00:32:24,640 --> 00:32:28,000
was required and the whole concepts of

842
00:32:28,000 --> 00:32:29,600
attack against offline data

843
00:32:29,600 --> 00:32:32,960
authentication is that for mastercard

844
00:32:32,960 --> 00:32:36,240
we try to present

845
00:32:36,240 --> 00:32:38,960
data using chip for visa it's the

846
00:32:38,960 --> 00:32:41,200
opposite we try to present data using

847
00:32:41,200 --> 00:32:42,720
contactless

848
00:32:42,720 --> 00:32:45,919
so for mastercard attacks we are reading

849
00:32:45,919 --> 00:32:47,120
data using

850
00:32:47,120 --> 00:32:50,159
mobile phone with nfc enabled features

851
00:32:50,159 --> 00:32:51,600
and send it to data

852
00:32:51,600 --> 00:32:55,200
and put it as as cheap using some sort

853
00:32:55,200 --> 00:32:55,679
of

854
00:32:55,679 --> 00:32:58,880
emv card simulator how like you can see

855
00:32:58,880 --> 00:33:00,799
on the screen which was made by omar

856
00:33:00,799 --> 00:33:02,720
chudari

857
00:33:02,720 --> 00:33:04,960
for visa cards is the opposite we read

858
00:33:04,960 --> 00:33:06,559
data from the cart

859
00:33:06,559 --> 00:33:09,120
using cheap readers and send this

860
00:33:09,120 --> 00:33:10,080
information

861
00:33:10,080 --> 00:33:14,240
using the mobile phone with nfc

862
00:33:14,240 --> 00:33:16,000
so one of attacks that we found for

863
00:33:16,000 --> 00:33:18,000
mastercard card reminds me of the

864
00:33:18,000 --> 00:33:19,120
original attack

865
00:33:19,120 --> 00:33:22,000
which we carried out against visa google

866
00:33:22,000 --> 00:33:22,720
pay

867
00:33:22,720 --> 00:33:26,399
so just to remind you uh cdc vm

868
00:33:26,399 --> 00:33:29,200
on google pay always is set to one and

869
00:33:29,200 --> 00:33:31,519
the only one thing attacker needs to do

870
00:33:31,519 --> 00:33:33,919
is to convince the phone that cardholder

871
00:33:33,919 --> 00:33:35,919
verification is not required

872
00:33:35,919 --> 00:33:39,039
by changing field from ttq

873
00:33:39,039 --> 00:33:42,000
that cvm is not required and in this

874
00:33:42,000 --> 00:33:42,399
case

875
00:33:42,399 --> 00:33:45,360
payment will be done without unlocking

876
00:33:45,360 --> 00:33:47,039
the phone

877
00:33:47,039 --> 00:33:50,399
the same is going on with mastercard uh

878
00:33:50,399 --> 00:33:53,600
what we need to do is we need to change

879
00:33:53,600 --> 00:33:56,240
cvm results fields saying that cvm is

880
00:33:56,240 --> 00:33:58,399
not required the problem is that in most

881
00:33:58,399 --> 00:34:00,960
of cards as i said cvm results is the

882
00:34:00,960 --> 00:34:03,120
part of the payment cryptogram and this

883
00:34:03,120 --> 00:34:04,799
attack will be spotted and transaction

884
00:34:04,799 --> 00:34:06,000
will be declined

885
00:34:06,000 --> 00:34:08,800
however the last year we found one card

886
00:34:08,800 --> 00:34:10,879
which allowed us to carry out this type

887
00:34:10,879 --> 00:34:13,040
of attack

888
00:34:13,040 --> 00:34:15,440
another interesting scenario that we

889
00:34:15,440 --> 00:34:17,839
found related to cart which actually

890
00:34:17,839 --> 00:34:18,399
allowed

891
00:34:18,399 --> 00:34:21,520
dynamically to change cbm methods and

892
00:34:21,520 --> 00:34:24,560
these brought to the construction

893
00:34:24,560 --> 00:34:28,960
when cvm list was

894
00:34:29,040 --> 00:34:33,119
stored in a place which was not used for

895
00:34:33,119 --> 00:34:35,760
checksum controlling ovcda that means

896
00:34:35,760 --> 00:34:36,239
that

897
00:34:36,239 --> 00:34:38,800
we were able to change cbm list saying

898
00:34:38,800 --> 00:34:40,399
that no cvm should be

899
00:34:40,399 --> 00:34:43,359
chosen and transaction still would not

900
00:34:43,359 --> 00:34:47,040
be cancelled on the terminal

901
00:34:47,520 --> 00:34:49,440
second attack that we discussed one year

902
00:34:49,440 --> 00:34:51,199
ago was about

903
00:34:51,199 --> 00:34:54,399
replay cryptogram replay so the idea is

904
00:34:54,399 --> 00:34:56,960
that as long as malfunctioning terminal

905
00:34:56,960 --> 00:34:58,960
presents the same um

906
00:34:58,960 --> 00:35:01,359
card can present the same cryptogram and

907
00:35:01,359 --> 00:35:02,079
atc

908
00:35:02,079 --> 00:35:04,240
and highly likely this transaction will

909
00:35:04,240 --> 00:35:07,359
be accepted on the eastern bank

910
00:35:07,359 --> 00:35:10,640
over the last year we've found around 30

911
00:35:10,640 --> 00:35:12,000
vulnerable banks

912
00:35:12,000 --> 00:35:14,800
and we communicated about found issues

913
00:35:14,800 --> 00:35:15,599
to

914
00:35:15,599 --> 00:35:18,960
all of them and most of them took some

915
00:35:18,960 --> 00:35:20,560
steps and fixed

916
00:35:20,560 --> 00:35:23,280
vulnerabilities at least one they were

917
00:35:23,280 --> 00:35:25,520
able to fix which is really good

918
00:35:25,520 --> 00:35:28,079
but some banks are still affected by

919
00:35:28,079 --> 00:35:31,440
replay attacks

920
00:35:31,440 --> 00:35:35,200
in conclusion we checked

921
00:35:35,200 --> 00:35:38,400
now around 57 cards

922
00:35:38,400 --> 00:35:40,960
visa mastercard all around the globe

923
00:35:40,960 --> 00:35:42,720
europe usa

924
00:35:42,720 --> 00:35:46,400
the uk asian countries specifically

925
00:35:46,400 --> 00:35:49,680
for black hat asia we checked indian

926
00:35:49,680 --> 00:35:52,160
and kazakh visa cards and mastercard

927
00:35:52,160 --> 00:35:54,160
cards and we can confirm that this

928
00:35:54,160 --> 00:35:54,800
attack

929
00:35:54,800 --> 00:35:58,480
can be applied for asian cards that

930
00:35:58,480 --> 00:35:59,760
means that transaction

931
00:35:59,760 --> 00:36:02,160
can't be made without knowing pin

932
00:36:02,160 --> 00:36:03,920
without presenting pin

933
00:36:03,920 --> 00:36:06,800
or signature

934
00:36:06,960 --> 00:36:09,119
the good part is that customer

935
00:36:09,119 --> 00:36:10,880
essentially is not responsible

936
00:36:10,880 --> 00:36:13,760
for all type of contactless fraud unless

937
00:36:13,760 --> 00:36:16,880
they disclose their pin code somehow

938
00:36:16,880 --> 00:36:19,920
and the responsibility lies on merchant

939
00:36:19,920 --> 00:36:23,440
or asian or acquiring bank and we

940
00:36:23,440 --> 00:36:26,400
you can see potential problem here yeah

941
00:36:26,400 --> 00:36:27,760
so ishii and bank

942
00:36:27,760 --> 00:36:29,760
don't have enough evidence enough

943
00:36:29,760 --> 00:36:31,440
information

944
00:36:31,440 --> 00:36:35,040
to say what fault whose fault was that

945
00:36:35,040 --> 00:36:37,040
and what actually happened whether it

946
00:36:37,040 --> 00:36:39,280
was fraud and or it was a genuine

947
00:36:39,280 --> 00:36:40,079
transaction

948
00:36:40,079 --> 00:36:43,119
and customer tries to apply

949
00:36:43,119 --> 00:36:45,200
for for a fraudulent transaction

950
00:36:45,200 --> 00:36:46,240
acquiring bank

951
00:36:46,240 --> 00:36:49,680
is not responsible for settings

952
00:36:49,680 --> 00:36:53,200
on cards or sometimes even on terminals

953
00:36:53,200 --> 00:36:54,079
and as you can see

954
00:36:54,079 --> 00:36:56,720
all this comes to this game of blaming

955
00:36:56,720 --> 00:36:57,680
each other

956
00:36:57,680 --> 00:37:01,760
such like a hot potato where issuer will

957
00:37:01,760 --> 00:37:05,440
uh try to blame aguirre and vice versa

958
00:37:05,440 --> 00:37:08,000
as i said the good part is that at least

959
00:37:08,000 --> 00:37:11,839
customer stays far away from that

960
00:37:11,839 --> 00:37:14,640
you can read more on our websites we

961
00:37:14,640 --> 00:37:15,680
present most

962
00:37:15,680 --> 00:37:18,000
more researchers around contact class

963
00:37:18,000 --> 00:37:19,359
and contact payments

964
00:37:19,359 --> 00:37:23,839
uh thank you for this session

