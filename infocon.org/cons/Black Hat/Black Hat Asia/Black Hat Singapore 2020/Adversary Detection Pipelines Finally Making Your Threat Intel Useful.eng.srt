1
00:00:03,840 --> 00:00:06,240
thank you for having me here today

2
00:00:06,240 --> 00:00:09,679
welcome to adversary detection pipelines

3
00:00:09,679 --> 00:00:12,960
finally making your threat intel useful

4
00:00:12,960 --> 00:00:15,920
today i'm going to talk about how to get

5
00:00:15,920 --> 00:00:16,480
more

6
00:00:16,480 --> 00:00:20,000
out of your threat intel

7
00:00:20,240 --> 00:00:23,359
i'm xena olson also known as cheerio on

8
00:00:23,359 --> 00:00:24,240
twitter

9
00:00:24,240 --> 00:00:26,560
i'm a blue team village senior lead a

10
00:00:26,560 --> 00:00:27,920
doctoral student in

11
00:00:27,920 --> 00:00:31,039
cyber security at marymount university a

12
00:00:31,039 --> 00:00:33,200
cyber threat intelligence or cti

13
00:00:33,200 --> 00:00:36,000
analyst cnn's women's academy graduate i

14
00:00:36,000 --> 00:00:38,239
have an mba and it management

15
00:00:38,239 --> 00:00:41,920
seven gx certs and i'm a huge disney fan

16
00:00:41,920 --> 00:00:44,320
also i'll be sharing a lot of really

17
00:00:44,320 --> 00:00:45,440
good resources

18
00:00:45,440 --> 00:00:48,160
in this talk so i created a repo for you

19
00:00:48,160 --> 00:00:49,840
at the bitly link

20
00:00:49,840 --> 00:00:51,840
but before we get started i have a quick

21
00:00:51,840 --> 00:00:53,920
note from the lawyers

22
00:00:53,920 --> 00:00:55,600
i'm not speaking on behalf of my

23
00:00:55,600 --> 00:00:57,680
employers the opinions i express are

24
00:00:57,680 --> 00:00:58,000
mine

25
00:00:58,000 --> 00:01:00,640
alone i'm here in my own individual

26
00:01:00,640 --> 00:01:02,800
capacity and the use of size purple team

27
00:01:02,800 --> 00:01:04,000
exercise framework

28
00:01:04,000 --> 00:01:05,840
later in this talk does not endorse them

29
00:01:05,840 --> 00:01:07,360
as a vendor

30
00:01:07,360 --> 00:01:09,920
so let's get started to set the theme of

31
00:01:09,920 --> 00:01:12,240
this talk i'll be using the lyrics from

32
00:01:12,240 --> 00:01:14,640
songs of an international pop star

33
00:01:14,640 --> 00:01:15,920
taylor swift

34
00:01:15,920 --> 00:01:18,400
i made a custom spotify playlist with

35
00:01:18,400 --> 00:01:19,600
all the songs

36
00:01:19,600 --> 00:01:22,000
i used in this presentation along with a

37
00:01:22,000 --> 00:01:23,280
few extras

38
00:01:23,280 --> 00:01:26,240
so you can find the link to the playlist

39
00:01:26,240 --> 00:01:27,520
on the github repo

40
00:01:27,520 --> 00:01:31,680
in the bitly link so when taylor swift

41
00:01:31,680 --> 00:01:33,200
sings that you'll never

42
00:01:33,200 --> 00:01:35,920
find another one like her that

43
00:01:35,920 --> 00:01:37,360
translates to how

44
00:01:37,360 --> 00:01:40,000
there isn't a one size fits all for a

45
00:01:40,000 --> 00:01:41,840
company's threat landscape

46
00:01:41,840 --> 00:01:44,560
because every org is different and

47
00:01:44,560 --> 00:01:46,000
unique

48
00:01:46,000 --> 00:01:50,079
in this talk i will not

49
00:01:50,079 --> 00:01:53,200
focus on the microsofts the targets the

50
00:01:53,200 --> 00:01:54,000
walmarts the

51
00:01:54,000 --> 00:01:56,960
googles of the world meaning the more

52
00:01:56,960 --> 00:01:57,920
mature

53
00:01:57,920 --> 00:02:00,799
cti or cyber threat intelligence teams

54
00:02:00,799 --> 00:02:01,439
nor

55
00:02:01,439 --> 00:02:04,079
will i focus on government entities or

56
00:02:04,079 --> 00:02:05,680
critical infrastructure

57
00:02:05,680 --> 00:02:08,959
instead i'll be focusing on pretty much

58
00:02:08,959 --> 00:02:10,160
everyone else

59
00:02:10,160 --> 00:02:13,120
so first i'm going to discuss some pain

60
00:02:13,120 --> 00:02:15,200
points that are specific

61
00:02:15,200 --> 00:02:18,720
to cti if you ask around

62
00:02:18,720 --> 00:02:21,520
there are security professionals that

63
00:02:21,520 --> 00:02:22,080
are

64
00:02:22,080 --> 00:02:25,040
not happy with cti i've heard of people

65
00:02:25,040 --> 00:02:25,440
getting

66
00:02:25,440 --> 00:02:28,800
outdated intelligence copy paste reports

67
00:02:28,800 --> 00:02:31,680
not timely intel intel that isn't

68
00:02:31,680 --> 00:02:33,280
relevant to your org

69
00:02:33,280 --> 00:02:36,480
or you're only getting iocs indicator of

70
00:02:36,480 --> 00:02:37,440
compromise or

71
00:02:37,440 --> 00:02:40,640
iox instead of looking at what is

72
00:02:40,640 --> 00:02:42,560
actually going on on their networks and

73
00:02:42,560 --> 00:02:43,680
threat landscape

74
00:02:43,680 --> 00:02:47,120
i've heard some cti analysts solely

75
00:02:47,120 --> 00:02:47,920
focusing

76
00:02:47,920 --> 00:02:51,040
on public threat actor reporting

77
00:02:51,040 --> 00:02:54,319
and going for the sexy apts which is

78
00:02:54,319 --> 00:02:56,080
advanced persistent threats

79
00:02:56,080 --> 00:02:58,239
such as fancy bear which is a

80
00:02:58,239 --> 00:02:59,920
russian-based threat actor

81
00:02:59,920 --> 00:03:02,720
publicly linked to intrusions into the

82
00:03:02,720 --> 00:03:03,599
german

83
00:03:03,599 --> 00:03:07,040
bundestag and france's tv5

84
00:03:07,040 --> 00:03:11,840
maldives station in april 2015.

85
00:03:12,159 --> 00:03:15,120
so another issue facing cti is that the

86
00:03:15,120 --> 00:03:15,920
teams

87
00:03:15,920 --> 00:03:18,239
are all in silos and they aren't talking

88
00:03:18,239 --> 00:03:20,080
or sharing projects or what they're

89
00:03:20,080 --> 00:03:21,200
working on

90
00:03:21,200 --> 00:03:24,080
and in some orgs red teams kind of do

91
00:03:24,080 --> 00:03:25,360
their own thing

92
00:03:25,360 --> 00:03:27,760
and decide operations based on the

93
00:03:27,760 --> 00:03:28,400
latest

94
00:03:28,400 --> 00:03:31,519
shiny hack that's out there thank mr

95
00:03:31,519 --> 00:03:35,280
robot so you know instead of looking at

96
00:03:35,280 --> 00:03:36,319
org specific

97
00:03:36,319 --> 00:03:40,720
adversaries and ttps

98
00:03:40,799 --> 00:03:44,319
in some organizations cti is fighting an

99
00:03:44,319 --> 00:03:46,000
uphill battle

100
00:03:46,000 --> 00:03:48,879
some intel vendors might have ulterior

101
00:03:48,879 --> 00:03:49,680
motives

102
00:03:49,680 --> 00:03:51,360
and trying to get you to buy their

103
00:03:51,360 --> 00:03:53,120
product when it doesn't necessarily

104
00:03:53,120 --> 00:03:56,480
suit your threat model and i've heard

105
00:03:56,480 --> 00:03:57,519
some managers

106
00:03:57,519 --> 00:03:59,439
just don't understand the importance of

107
00:03:59,439 --> 00:04:00,879
blocked attacks

108
00:04:00,879 --> 00:04:03,439
or the collection of forensic artifacts

109
00:04:03,439 --> 00:04:04,400
for the cti

110
00:04:04,400 --> 00:04:07,280
team and i don't know if you know this

111
00:04:07,280 --> 00:04:09,200
but threat intel managers

112
00:04:09,200 --> 00:04:12,000
they're a very very special kind of

113
00:04:12,000 --> 00:04:13,680
manager because

114
00:04:13,680 --> 00:04:16,320
they need to be aware of their use of

115
00:04:16,320 --> 00:04:19,279
logical fallacies and cognitive bias

116
00:04:19,279 --> 00:04:22,000
otherwise it could kinda under mean

117
00:04:22,000 --> 00:04:22,720
undermine

118
00:04:22,720 --> 00:04:25,600
the threat intel team's efforts so

119
00:04:25,600 --> 00:04:26,560
finally

120
00:04:26,560 --> 00:04:29,440
office politics and i don't need to

121
00:04:29,440 --> 00:04:33,040
elaborate or get into that one

122
00:04:33,199 --> 00:04:36,000
so how can cti provide more value to the

123
00:04:36,000 --> 00:04:37,040
organization

124
00:04:37,040 --> 00:04:39,280
while overcoming some of the obstacles i

125
00:04:39,280 --> 00:04:40,320
mentioned

126
00:04:40,320 --> 00:04:43,120
how can cti help teams get out of their

127
00:04:43,120 --> 00:04:45,040
silos and work together

128
00:04:45,040 --> 00:04:47,360
you know i started asking myself these

129
00:04:47,360 --> 00:04:49,600
questions and a few more

130
00:04:49,600 --> 00:04:52,639
and it ended up leading me down a rabbit

131
00:04:52,639 --> 00:04:53,280
hole

132
00:04:53,280 --> 00:04:56,400
to discover if it is possible to come up

133
00:04:56,400 --> 00:04:58,880
with a reasonable solution that almost

134
00:04:58,880 --> 00:05:02,080
any cti analyst can use to create a

135
00:05:02,080 --> 00:05:05,280
baseline of their org threat landscape

136
00:05:05,280 --> 00:05:08,240
so the goal is to produce meaningful

137
00:05:08,240 --> 00:05:08,800
threat

138
00:05:08,800 --> 00:05:12,720
intelligence products so this talk

139
00:05:12,720 --> 00:05:15,039
will hopefully shed some light on what

140
00:05:15,039 --> 00:05:17,199
i've found over the course of over two

141
00:05:17,199 --> 00:05:18,000
years

142
00:05:18,000 --> 00:05:20,160
and give you some ideas to incorporate

143
00:05:20,160 --> 00:05:23,039
at your org

144
00:05:23,039 --> 00:05:25,280
so first we'll explore attribution then

145
00:05:25,280 --> 00:05:27,680
we'll move on to ttps or tactics

146
00:05:27,680 --> 00:05:29,440
techniques and procedures

147
00:05:29,440 --> 00:05:31,440
we'll discuss some ideas for filtering

148
00:05:31,440 --> 00:05:33,120
threats and finally

149
00:05:33,120 --> 00:05:36,400
adversary detection pipelines

150
00:05:36,400 --> 00:05:39,120
so attribution is hard for the purposes

151
00:05:39,120 --> 00:05:40,080
of this talk

152
00:05:40,080 --> 00:05:43,440
i will solely focus on private companies

153
00:05:43,440 --> 00:05:46,240
where attribution may not be as

154
00:05:46,240 --> 00:05:48,400
important as it might be for governments

155
00:05:48,400 --> 00:05:51,120
or critical infrastructure in this

156
00:05:51,120 --> 00:05:52,160
section also

157
00:05:52,160 --> 00:05:54,880
when i refer to attribution i mean true

158
00:05:54,880 --> 00:05:56,000
attribution

159
00:05:56,000 --> 00:05:59,199
where you find out who actually did it

160
00:05:59,199 --> 00:06:02,080
so even if you get all of the forensic

161
00:06:02,080 --> 00:06:04,479
information such as keyboard used

162
00:06:04,479 --> 00:06:07,280
libraries languages use compiler use

163
00:06:07,280 --> 00:06:09,759
compile time metadata code styles

164
00:06:09,759 --> 00:06:12,240
resource language c2 check-in mutex

165
00:06:12,240 --> 00:06:14,080
names chronicle tags and more

166
00:06:14,080 --> 00:06:16,560
you would still need other evidence or

167
00:06:16,560 --> 00:06:17,919
possibly to include

168
00:06:17,919 --> 00:06:20,400
other parties such as law enforcement

169
00:06:20,400 --> 00:06:21,600
government agencies

170
00:06:21,600 --> 00:06:24,479
or outside consulting firms for true

171
00:06:24,479 --> 00:06:26,960
attribution

172
00:06:26,960 --> 00:06:29,199
in tim mowers cyber mercenaries the

173
00:06:29,199 --> 00:06:30,880
state hackers in power

174
00:06:30,880 --> 00:06:32,880
he discusses the use of independent

175
00:06:32,880 --> 00:06:35,120
hackers to act as a proxy for

176
00:06:35,120 --> 00:06:36,800
nation-state actors

177
00:06:36,800 --> 00:06:39,360
so how would you tell the difference

178
00:06:39,360 --> 00:06:40,720
between a proxy

179
00:06:40,720 --> 00:06:43,120
and the actual source of the attack i

180
00:06:43,120 --> 00:06:45,280
know i couldn't

181
00:06:45,280 --> 00:06:47,919
another issue with attempting to do true

182
00:06:47,919 --> 00:06:50,240
attribution is false flag operations

183
00:06:50,240 --> 00:06:52,479
where the attackers purposefully create

184
00:06:52,479 --> 00:06:54,240
misleading artifacts to throw

185
00:06:54,240 --> 00:06:55,039
researchers

186
00:06:55,039 --> 00:06:57,199
off their trail a really great example

187
00:06:57,199 --> 00:06:58,160
of this is

188
00:06:58,160 --> 00:07:00,960
the olympic destroyer operation it was

189
00:07:00,960 --> 00:07:03,039
originally thought to be north korea

190
00:07:03,039 --> 00:07:05,599
then russia with some things that look

191
00:07:05,599 --> 00:07:06,960
like a chinese apt

192
00:07:06,960 --> 00:07:09,680
but still no solid attribution so you

193
00:07:09,680 --> 00:07:10,000
know

194
00:07:10,000 --> 00:07:12,000
for more in-depth discussion of false

195
00:07:12,000 --> 00:07:13,440
flag operations

196
00:07:13,440 --> 00:07:15,840
check out jake williams talk at black

197
00:07:15,840 --> 00:07:17,440
cat europe 2019

198
00:07:17,440 --> 00:07:20,400
called conducting a successful false

199
00:07:20,400 --> 00:07:23,440
flag operation

200
00:07:24,319 --> 00:07:27,199
so in summary about attribution most

201
00:07:27,199 --> 00:07:29,039
orgs do not need it

202
00:07:29,039 --> 00:07:31,840
nor is it worth the time effort and

203
00:07:31,840 --> 00:07:33,120
expense

204
00:07:33,120 --> 00:07:35,520
true attribution is not going to be

205
00:07:35,520 --> 00:07:37,599
considered in the adversary detection

206
00:07:37,599 --> 00:07:38,319
model

207
00:07:38,319 --> 00:07:40,560
instead we're going to use the diamond

208
00:07:40,560 --> 00:07:43,120
model along with ttps to form

209
00:07:43,120 --> 00:07:46,000
activity groups based upon internal

210
00:07:46,000 --> 00:07:48,319
attack data that we then name

211
00:07:48,319 --> 00:07:52,160
for the ease of explaining data

212
00:07:52,879 --> 00:07:55,120
so let's talk about behaviors tactics

213
00:07:55,120 --> 00:07:56,840
techniques and procedures for the

214
00:07:56,840 --> 00:07:58,879
adversary i'm interested

215
00:07:58,879 --> 00:08:01,120
in looking at stuff that does something

216
00:08:01,120 --> 00:08:01,919
bad

217
00:08:01,919 --> 00:08:04,400
instead of focusing on a few adversaries

218
00:08:04,400 --> 00:08:06,319
that may or may not actually be

219
00:08:06,319 --> 00:08:08,160
attacking my org

220
00:08:08,160 --> 00:08:10,800
so mitre attack offers a great free

221
00:08:10,800 --> 00:08:12,319
training resource on

222
00:08:12,319 --> 00:08:14,639
how to make ttps by katie nichols and

223
00:08:14,639 --> 00:08:15,840
adam pennington

224
00:08:15,840 --> 00:08:19,039
and i recommend checking that out

225
00:08:19,039 --> 00:08:21,440
so we want to create a solution to

226
00:08:21,440 --> 00:08:24,000
support other teams

227
00:08:24,000 --> 00:08:27,360
the pyramid of pain by david j bianca

228
00:08:27,360 --> 00:08:29,759
provides a perfect illustration of

229
00:08:29,759 --> 00:08:32,399
increasing the effort of attackers

230
00:08:32,399 --> 00:08:35,839
through the use of ttps it is trivial

231
00:08:35,839 --> 00:08:39,039
to generate a new hash but

232
00:08:39,039 --> 00:08:41,679
far more difficult to change how an

233
00:08:41,679 --> 00:08:43,279
attacker compromises an

234
00:08:43,279 --> 00:08:46,000
organization we want to increase the

235
00:08:46,000 --> 00:08:46,880
difficulty

236
00:08:46,880 --> 00:08:49,680
and the time the adversary has to invest

237
00:08:49,680 --> 00:08:52,399
to pone us

238
00:08:52,399 --> 00:08:56,399
ttps to me means that i am interested

239
00:08:56,399 --> 00:08:59,200
in how an attacker does something versus

240
00:08:59,200 --> 00:09:00,399
why they did it

241
00:09:00,399 --> 00:09:04,240
or who is doing it

242
00:09:04,560 --> 00:09:07,360
an adversary detection pipeline is about

243
00:09:07,360 --> 00:09:08,000
sharing

244
00:09:08,000 --> 00:09:10,560
the behaviors of attacks impacting your

245
00:09:10,560 --> 00:09:11,200
org

246
00:09:11,200 --> 00:09:14,399
and setting up other teams for success

247
00:09:14,399 --> 00:09:17,120
bryson bort ceo and founder of scythe

248
00:09:17,120 --> 00:09:18,000
points out

249
00:09:18,000 --> 00:09:20,480
that ttps allow you to look at the

250
00:09:20,480 --> 00:09:21,519
controls

251
00:09:21,519 --> 00:09:24,399
detection and response across all the

252
00:09:24,399 --> 00:09:25,360
stages

253
00:09:25,360 --> 00:09:28,560
of the attack path for your org

254
00:09:28,560 --> 00:09:31,519
that's why ttps are critical to building

255
00:09:31,519 --> 00:09:35,600
out the adversary detection pipeline

256
00:09:35,600 --> 00:09:38,560
so focusing on ttps can help other teams

257
00:09:38,560 --> 00:09:38,880
too

258
00:09:38,880 --> 00:09:41,839
for instance if i give domains and ips

259
00:09:41,839 --> 00:09:43,120
to red team

260
00:09:43,120 --> 00:09:45,200
that won't be as helpful as sharing

261
00:09:45,200 --> 00:09:46,800
actual behaviors or

262
00:09:46,800 --> 00:09:49,920
ttps so that red can build out their

263
00:09:49,920 --> 00:09:51,519
adversary emulation

264
00:09:51,519 --> 00:09:55,200
operation adam pennington at defcon 28

265
00:09:55,200 --> 00:09:56,880
red team village

266
00:09:56,880 --> 00:09:59,279
a talk called emulating an adversary

267
00:09:59,279 --> 00:10:01,360
with imperfect intelligence

268
00:10:01,360 --> 00:10:03,440
he talks about dependencies for

269
00:10:03,440 --> 00:10:05,200
techniques and other helpful

270
00:10:05,200 --> 00:10:07,519
tips in building out an adversary

271
00:10:07,519 --> 00:10:08,240
detection

272
00:10:08,240 --> 00:10:10,880
or adversary emulation plan based on

273
00:10:10,880 --> 00:10:14,320
open source reporting

274
00:10:14,480 --> 00:10:17,519
so focusing on ttps might seem simple

275
00:10:17,519 --> 00:10:19,680
but as john the senior director of

276
00:10:19,680 --> 00:10:22,320
mandiant threat intelligence points out

277
00:10:22,320 --> 00:10:25,279
attackers will use what works even if

278
00:10:25,279 --> 00:10:26,480
it's simple

279
00:10:26,480 --> 00:10:29,200
one of the main goals of adversary

280
00:10:29,200 --> 00:10:30,640
detection pipelines

281
00:10:30,640 --> 00:10:33,760
is to get really good at understanding

282
00:10:33,760 --> 00:10:34,800
simple attacks

283
00:10:34,800 --> 00:10:38,000
specific to your org's infrastructure

284
00:10:38,000 --> 00:10:41,120
controls and detection

285
00:10:41,120 --> 00:10:43,680
joe a seasoned threat intelligence

286
00:10:43,680 --> 00:10:44,480
professional

287
00:10:44,480 --> 00:10:47,120
points out many attackers will take the

288
00:10:47,120 --> 00:10:49,519
path of least resistance to get the job

289
00:10:49,519 --> 00:10:50,640
done

290
00:10:50,640 --> 00:10:53,279
even verizon's data breach investigation

291
00:10:53,279 --> 00:10:54,000
report

292
00:10:54,000 --> 00:10:56,480
in 2020 showed that attackers are

293
00:10:56,480 --> 00:10:59,519
favoring stolen credentials for breaches

294
00:10:59,519 --> 00:11:03,360
so why develop a zero day or a complex

295
00:11:03,360 --> 00:11:07,519
attack when you can just steal creds

296
00:11:08,320 --> 00:11:11,120
former fbi director robert mueller says

297
00:11:11,120 --> 00:11:12,079
there are only

298
00:11:12,079 --> 00:11:15,360
two types of companies those that have

299
00:11:15,360 --> 00:11:16,079
been hacked

300
00:11:16,079 --> 00:11:18,959
and those that will be hacked so the

301
00:11:18,959 --> 00:11:21,120
adversary detection pipeline model works

302
00:11:21,120 --> 00:11:23,680
from a place of assumed breach

303
00:11:23,680 --> 00:11:26,640
if this malware or whatever attack it is

304
00:11:26,640 --> 00:11:28,640
bypasses our controls

305
00:11:28,640 --> 00:11:31,200
what will it do how will it operate in

306
00:11:31,200 --> 00:11:32,160
your environment

307
00:11:32,160 --> 00:11:35,120
what are the ttps from there you can

308
00:11:35,120 --> 00:11:36,959
work with other teams to better

309
00:11:36,959 --> 00:11:39,360
understand your visibility detection

310
00:11:39,360 --> 00:11:42,800
and response

311
00:11:42,800 --> 00:11:45,600
the purpose of threat intelligence is to

312
00:11:45,600 --> 00:11:46,079
be

313
00:11:46,079 --> 00:11:49,040
actionable so here's an example of how

314
00:11:49,040 --> 00:11:49,760
you can use

315
00:11:49,760 --> 00:11:52,800
ttps so these are

316
00:11:52,800 --> 00:11:54,480
some of the behaviors of the attack

317
00:11:54,480 --> 00:11:56,079
coming at the org

318
00:11:56,079 --> 00:11:59,120
of the attacks coming at the orc we have

319
00:11:59,120 --> 00:12:02,240
x percent coverage with our controls

320
00:12:02,240 --> 00:12:05,360
detection for x percent and

321
00:12:05,360 --> 00:12:08,880
are in the process of addressing x gaps

322
00:12:08,880 --> 00:12:12,560
through actions x y and z

323
00:12:12,560 --> 00:12:14,959
this provides meaningful and

324
00:12:14,959 --> 00:12:17,440
organization specific metrics

325
00:12:17,440 --> 00:12:19,360
and shows due diligence to your

326
00:12:19,360 --> 00:12:21,760
shareholders your investors management

327
00:12:21,760 --> 00:12:22,959
senior management

328
00:12:22,959 --> 00:12:25,360
as well as a justification for any

329
00:12:25,360 --> 00:12:28,000
security products you have

330
00:12:28,000 --> 00:12:30,399
so now that i've shared why ttps are

331
00:12:30,399 --> 00:12:31,120
favored

332
00:12:31,120 --> 00:12:33,760
versus true attribution let's look at

333
00:12:33,760 --> 00:12:35,360
how ttps could help

334
00:12:35,360 --> 00:12:39,839
other teams

335
00:12:40,079 --> 00:12:42,800
so now we're going to use initiatives to

336
00:12:42,800 --> 00:12:43,839
basically filter

337
00:12:43,839 --> 00:12:47,040
the entire internet

338
00:12:47,440 --> 00:12:49,760
it's going to take time and it's going

339
00:12:49,760 --> 00:12:51,040
to take some work

340
00:12:51,040 --> 00:12:54,480
but it's worth it

341
00:12:54,480 --> 00:12:56,320
so for the business initiatives i

342
00:12:56,320 --> 00:12:57,760
usually recommend looking at the

343
00:12:57,760 --> 00:12:59,839
management discussion for the 10k

344
00:12:59,839 --> 00:13:02,880
10q or the annual report or whatever

345
00:13:02,880 --> 00:13:04,480
goals report you have for your

346
00:13:04,480 --> 00:13:05,760
organization

347
00:13:05,760 --> 00:13:08,480
for the department and security team i

348
00:13:08,480 --> 00:13:10,639
really recommend having conversations

349
00:13:10,639 --> 00:13:12,320
with the various teams at your org

350
00:13:12,320 --> 00:13:14,000
whether it's red or purple

351
00:13:14,000 --> 00:13:17,040
or blue or hunt and then also too

352
00:13:17,040 --> 00:13:20,320
generally these security teams will have

353
00:13:20,320 --> 00:13:22,560
goals or initiatives they have to meet

354
00:13:22,560 --> 00:13:23,600
each quarter

355
00:13:23,600 --> 00:13:26,079
or each year and what you could do is

356
00:13:26,079 --> 00:13:27,279
find those out

357
00:13:27,279 --> 00:13:29,360
and then figure out how to help them

358
00:13:29,360 --> 00:13:31,440
with whatever it is they're trying to

359
00:13:31,440 --> 00:13:34,639
do and then of course the cti team

360
00:13:34,639 --> 00:13:37,279
can basically create the baseline for a

361
00:13:37,279 --> 00:13:39,040
lot of these deliverables

362
00:13:39,040 --> 00:13:43,040
so that you can track stuff over time

363
00:13:43,440 --> 00:13:46,480
scott j roberts and cti squad goal

364
00:13:46,480 --> 00:13:48,000
setting requirements

365
00:13:48,000 --> 00:13:50,720
and brian p heim in threat intel

366
00:13:50,720 --> 00:13:52,399
planning they offer some good

367
00:13:52,399 --> 00:13:55,440
suggestions on some basic ideas around

368
00:13:55,440 --> 00:13:58,000
the operation that the operational

369
00:13:58,000 --> 00:13:59,600
environment of your org

370
00:13:59,600 --> 00:14:02,399
so one of them is reviewing industry

371
00:14:02,399 --> 00:14:03,440
verticals

372
00:14:03,440 --> 00:14:05,279
reviewing the threat actors that

373
00:14:05,279 --> 00:14:07,360
historically attacked your verticals

374
00:14:07,360 --> 00:14:09,519
and then looking at the threats and

375
00:14:09,519 --> 00:14:12,000
threat actors that attacked your org

376
00:14:12,000 --> 00:14:14,399
and then also to assessing the internal

377
00:14:14,399 --> 00:14:16,240
and external exposure

378
00:14:16,240 --> 00:14:18,959
so you want to run attack scenarios and

379
00:14:18,959 --> 00:14:21,120
understand the attack progression

380
00:14:21,120 --> 00:14:23,920
so you go from external to internal and

381
00:14:23,920 --> 00:14:24,399
then

382
00:14:24,399 --> 00:14:27,199
internal to external so that you get a

383
00:14:27,199 --> 00:14:30,079
good idea

384
00:14:30,079 --> 00:14:31,920
you are going to need to make sure

385
00:14:31,920 --> 00:14:33,839
you're collecting some data

386
00:14:33,839 --> 00:14:37,440
so in a 2019 cti survey rebecca brown

387
00:14:37,440 --> 00:14:39,600
and robert emily share some suggested

388
00:14:39,600 --> 00:14:41,440
data collection sources

389
00:14:41,440 --> 00:14:44,560
so internally you can look at your

390
00:14:44,560 --> 00:14:46,639
internal tickets your waff email

391
00:14:46,639 --> 00:14:48,000
analysis endpoint

392
00:14:48,000 --> 00:14:51,839
ids on and on uh open source reporting

393
00:14:51,839 --> 00:14:53,600
you can look at white papers threat

394
00:14:53,600 --> 00:14:54,480
reports

395
00:14:54,480 --> 00:14:58,000
researchers news doj indictments

396
00:14:58,000 --> 00:14:59,839
and then there's sharing groups so you

397
00:14:59,839 --> 00:15:01,920
have the isacs the certs

398
00:15:01,920 --> 00:15:05,519
the tlp amber and bread private intel

399
00:15:05,519 --> 00:15:07,199
groups and then finally

400
00:15:07,199 --> 00:15:11,519
threat feeds and intel vendors

401
00:15:11,519 --> 00:15:14,160
you also need to prioritize your threats

402
00:15:14,160 --> 00:15:15,920
so you look at the intent

403
00:15:15,920 --> 00:15:18,720
opportunity and capability of the

404
00:15:18,720 --> 00:15:20,079
attackers

405
00:15:20,079 --> 00:15:22,959
with respect to threats to your org

406
00:15:22,959 --> 00:15:25,199
david jay bianco and cat self in their

407
00:15:25,199 --> 00:15:26,000
talk at

408
00:15:26,000 --> 00:15:28,639
sands threat hunting and ir europe

409
00:15:28,639 --> 00:15:30,160
summit 2020

410
00:15:30,160 --> 00:15:33,360
shared a method of prioritizing hunting

411
00:15:33,360 --> 00:15:36,639
using polar geometry you can adapt this

412
00:15:36,639 --> 00:15:41,759
to cti when prioritizing threats too

413
00:15:41,759 --> 00:15:44,000
the diamond model can help you structure

414
00:15:44,000 --> 00:15:45,199
your pivoting

415
00:15:45,199 --> 00:15:47,839
it can also be used to make activity

416
00:15:47,839 --> 00:15:48,880
groups

417
00:15:48,880 --> 00:15:50,800
so you've got to get kind of creative

418
00:15:50,800 --> 00:15:52,880
and use the diamond model in a way that

419
00:15:52,880 --> 00:15:55,040
works for your org

420
00:15:55,040 --> 00:15:57,920
here's a suggestion start with your

421
00:15:57,920 --> 00:15:58,880
email data

422
00:15:58,880 --> 00:16:01,040
both blocked and delivered to get a

423
00:16:01,040 --> 00:16:02,160
baseline

424
00:16:02,160 --> 00:16:05,199
on your org specific threat landscape if

425
00:16:05,199 --> 00:16:05,519
you

426
00:16:05,519 --> 00:16:08,639
see the repetitive use of infrastructure

427
00:16:08,639 --> 00:16:11,440
and capability vertices of the diamond

428
00:16:11,440 --> 00:16:11,920
model

429
00:16:11,920 --> 00:16:14,639
in your attack data you can group those

430
00:16:14,639 --> 00:16:15,440
attacks

431
00:16:15,440 --> 00:16:18,079
as a thread activity group and name it

432
00:16:18,079 --> 00:16:20,399
as an easier way to convey data

433
00:16:20,399 --> 00:16:25,360
such as zero cool or fuzzy snuggly duck

434
00:16:25,360 --> 00:16:28,000
next you can focus on other internal

435
00:16:28,000 --> 00:16:29,040
sources such as

436
00:16:29,040 --> 00:16:32,639
sock or d for tickets

437
00:16:33,040 --> 00:16:34,880
so we just laid the foundation for

438
00:16:34,880 --> 00:16:37,199
adversary detection pipelines

439
00:16:37,199 --> 00:16:41,279
next we'll explore it further

440
00:16:42,480 --> 00:16:46,639
so the analysis of organization specific

441
00:16:46,639 --> 00:16:47,839
threats

442
00:16:47,839 --> 00:16:50,959
via structured and unstructured formats

443
00:16:50,959 --> 00:16:51,440
for an

444
00:16:51,440 --> 00:16:54,959
adversary detection pipeline focused

445
00:16:54,959 --> 00:16:58,160
on business departmental and cti

446
00:16:58,160 --> 00:17:00,880
initiatives

447
00:17:01,519 --> 00:17:04,480
what does that mean basically i'm going

448
00:17:04,480 --> 00:17:06,480
to use the initiatives with the focus on

449
00:17:06,480 --> 00:17:08,559
ttps and behaviors

450
00:17:08,559 --> 00:17:11,039
pulling from email attack data internal

451
00:17:11,039 --> 00:17:13,439
sources and publicly available available

452
00:17:13,439 --> 00:17:14,240
data

453
00:17:14,240 --> 00:17:17,280
to filter out threats that do not impact

454
00:17:17,280 --> 00:17:19,839
my org

455
00:17:20,720 --> 00:17:23,359
so imagine these are all the possible

456
00:17:23,359 --> 00:17:25,039
threats on the internet

457
00:17:25,039 --> 00:17:29,760
how do we make this more manageable

458
00:17:30,559 --> 00:17:32,720
you can narrow your focus based upon the

459
00:17:32,720 --> 00:17:34,400
initiatives that are specific

460
00:17:34,400 --> 00:17:37,600
to your org the purpose

461
00:17:37,600 --> 00:17:41,039
of the cti team initiative is to

462
00:17:41,039 --> 00:17:43,200
create a threat landscape specific to

463
00:17:43,200 --> 00:17:44,080
the org

464
00:17:44,080 --> 00:17:47,039
that you track over time so you can spot

465
00:17:47,039 --> 00:17:48,480
anomalies

466
00:17:48,480 --> 00:17:51,200
it's also to prioritize organization

467
00:17:51,200 --> 00:17:52,320
specific threats

468
00:17:52,320 --> 00:17:55,679
and to build out deliverables for other

469
00:17:55,679 --> 00:17:58,080
teams

470
00:17:58,240 --> 00:18:00,880
so using email attack data you have a

471
00:18:00,880 --> 00:18:02,880
source of data that can give you info

472
00:18:02,880 --> 00:18:05,679
on the various ransomware variants sent

473
00:18:05,679 --> 00:18:07,039
to your org

474
00:18:07,039 --> 00:18:09,520
malware phishing campaigns business

475
00:18:09,520 --> 00:18:10,799
email compromise

476
00:18:10,799 --> 00:18:14,559
and any other attacks so through looking

477
00:18:14,559 --> 00:18:16,000
at all of the email data

478
00:18:16,000 --> 00:18:18,240
including the blocked you can gain a

479
00:18:18,240 --> 00:18:21,440
better understanding of the type of ttps

480
00:18:21,440 --> 00:18:23,679
that are being used against your org

481
00:18:23,679 --> 00:18:24,559
prior

482
00:18:24,559 --> 00:18:29,840
to the post-exploitation phase

483
00:18:29,919 --> 00:18:32,240
when you incorporate the assumed breach

484
00:18:32,240 --> 00:18:34,480
model in conjunction with looking at the

485
00:18:34,480 --> 00:18:35,360
ttps

486
00:18:35,360 --> 00:18:37,679
of the email attack data you can get

487
00:18:37,679 --> 00:18:38,480
involved

488
00:18:38,480 --> 00:18:41,679
in proactive security practices through

489
00:18:41,679 --> 00:18:42,320
ensuring

490
00:18:42,320 --> 00:18:45,520
you have visibility detection and

491
00:18:45,520 --> 00:18:49,679
security controls this table

492
00:18:49,679 --> 00:18:52,080
shows you the blocked delivered and

493
00:18:52,080 --> 00:18:54,000
clicked malicious emails

494
00:18:54,000 --> 00:18:57,039
so this can be used to prioritize work

495
00:18:57,039 --> 00:18:59,840
to give to other teams such as looking

496
00:18:59,840 --> 00:19:02,559
at the ttps associated with the clicked

497
00:19:02,559 --> 00:19:05,039
or delivered campaigns first you can

498
00:19:05,039 --> 00:19:06,160
take it a step

499
00:19:06,160 --> 00:19:09,120
further and prioritize looking at actors

500
00:19:09,120 --> 00:19:11,120
that show a high click rate of delivered

501
00:19:11,120 --> 00:19:12,480
messages

502
00:19:12,480 --> 00:19:15,600
what sets that particular activity group

503
00:19:15,600 --> 00:19:19,039
apart from the others

504
00:19:19,840 --> 00:19:22,880
so this heat map is just a fancy way of

505
00:19:22,880 --> 00:19:24,000
grouping attacks

506
00:19:24,000 --> 00:19:26,640
based on the diamond model then instead

507
00:19:26,640 --> 00:19:28,640
of listing out the infrastructure and

508
00:19:28,640 --> 00:19:30,240
capabilities of the attack

509
00:19:30,240 --> 00:19:33,360
in a really really long sentence

510
00:19:33,360 --> 00:19:36,000
you give it a name so the names can

511
00:19:36,000 --> 00:19:36,640
represent

512
00:19:36,640 --> 00:19:38,880
various activity groups specific to your

513
00:19:38,880 --> 00:19:39,760
org

514
00:19:39,760 --> 00:19:42,240
you can use this to prioritize

515
00:19:42,240 --> 00:19:43,520
intelligence products

516
00:19:43,520 --> 00:19:47,440
you create for other teams

517
00:19:48,559 --> 00:19:50,880
then you can get the ttps for the

518
00:19:50,880 --> 00:19:52,000
various threat activity

519
00:19:52,000 --> 00:19:54,559
groups and throw them into mitre attacks

520
00:19:54,559 --> 00:19:55,600
navigator

521
00:19:55,600 --> 00:19:58,880
to see what overlaps then from here

522
00:19:58,880 --> 00:20:01,200
you can prioritize those techniques for

523
00:20:01,200 --> 00:20:02,960
purple exercises

524
00:20:02,960 --> 00:20:05,600
hunt activities adversary emulation and

525
00:20:05,600 --> 00:20:07,440
more

526
00:20:07,440 --> 00:20:09,919
you can also use other internal sources

527
00:20:09,919 --> 00:20:11,840
for the adversary detection pipelines

528
00:20:11,840 --> 00:20:12,400
such as

529
00:20:12,400 --> 00:20:16,320
incident data internal monitoring

530
00:20:16,320 --> 00:20:19,760
intel vendors and sharing groups

531
00:20:19,760 --> 00:20:22,240
oceant and publicly available threat

532
00:20:22,240 --> 00:20:23,200
reports

533
00:20:23,200 --> 00:20:25,120
white papers and pretty much anything

534
00:20:25,120 --> 00:20:26,720
else in the public domain

535
00:20:26,720 --> 00:20:29,600
can also be used to supplement and build

536
00:20:29,600 --> 00:20:32,000
out adversary detection pipelines

537
00:20:32,000 --> 00:20:35,679
so here's an example if you know an apt

538
00:20:35,679 --> 00:20:38,159
is targeting other companies in your

539
00:20:38,159 --> 00:20:38,799
vertical

540
00:20:38,799 --> 00:20:41,360
through private intel sharing groups you

541
00:20:41,360 --> 00:20:42,000
can then

542
00:20:42,000 --> 00:20:44,320
look at public reporting to offset any

543
00:20:44,320 --> 00:20:48,400
gaps in your knowledge

544
00:20:48,400 --> 00:20:51,600
so i break down the data into structured

545
00:20:51,600 --> 00:20:53,760
and unstructured formats based upon

546
00:20:53,760 --> 00:20:55,360
joshua stephen's

547
00:20:55,360 --> 00:20:58,960
2015 rsec talk called hunting for the

548
00:20:58,960 --> 00:21:02,000
undefined threat advanced analytics

549
00:21:02,000 --> 00:21:05,039
and visualization where basically the

550
00:21:05,039 --> 00:21:07,120
unstructured format equals the

551
00:21:07,120 --> 00:21:10,880
undefined threat and new ttps and the

552
00:21:10,880 --> 00:21:12,960
structured format equals searching known

553
00:21:12,960 --> 00:21:15,120
threats such as iocs

554
00:21:15,120 --> 00:21:19,120
ttps and real-time analysis

555
00:21:19,120 --> 00:21:21,679
so there was already structured data in

556
00:21:21,679 --> 00:21:24,000
the form of email attack data iocs in

557
00:21:24,000 --> 00:21:26,400
public reports known ttps

558
00:21:26,400 --> 00:21:29,520
but i hadn't addressed the unstructured

559
00:21:29,520 --> 00:21:30,080
nature

560
00:21:30,080 --> 00:21:33,280
of hypothesis-driven threat hunting

561
00:21:33,280 --> 00:21:36,158
until

562
00:21:36,320 --> 00:21:38,960
i came across matt bromley's sans

563
00:21:38,960 --> 00:21:40,400
analyst paper

564
00:21:40,400 --> 00:21:43,360
on thinking like a hunter implementing a

565
00:21:43,360 --> 00:21:44,080
threat hunting

566
00:21:44,080 --> 00:21:48,240
program and he gave me the idea to

567
00:21:48,240 --> 00:21:51,440
reverse engineer hunt to determine what

568
00:21:51,440 --> 00:21:52,240
they would need

569
00:21:52,240 --> 00:21:55,679
for their ct from their cti team so what

570
00:21:55,679 --> 00:21:56,240
you see

571
00:21:56,240 --> 00:21:58,880
is the result of my interpretation of

572
00:21:58,880 --> 00:22:01,600
that paper from a cti perspective

573
00:22:01,600 --> 00:22:04,480
so you take a specific time frame with

574
00:22:04,480 --> 00:22:05,120
known

575
00:22:05,120 --> 00:22:07,520
badness for a particular area of the

576
00:22:07,520 --> 00:22:10,480
network so hunt can form hypotheses

577
00:22:10,480 --> 00:22:12,400
so you can do this by grouping for

578
00:22:12,400 --> 00:22:14,480
example email attack data

579
00:22:14,480 --> 00:22:17,120
or providing high level behaviors for

580
00:22:17,120 --> 00:22:18,720
threat actors that were scanning your

581
00:22:18,720 --> 00:22:19,520
network

582
00:22:19,520 --> 00:22:22,640
for a specified quarter or even group

583
00:22:22,640 --> 00:22:24,000
the threats other fi

584
00:22:24,000 --> 00:22:26,640
share for a specified time frame with

585
00:22:26,640 --> 00:22:27,600
the behaviors

586
00:22:27,600 --> 00:22:31,918
so hunt can hunt

587
00:22:34,080 --> 00:22:35,600
you can also create thread actor

588
00:22:35,600 --> 00:22:38,080
dossiers based upon email attack data

589
00:22:38,080 --> 00:22:40,000
and incident tickets

590
00:22:40,000 --> 00:22:42,799
these are helpful for sock to know who

591
00:22:42,799 --> 00:22:44,480
is targeting you

592
00:22:44,480 --> 00:22:46,799
helpful for red team emulation helpful

593
00:22:46,799 --> 00:22:48,559
for purple team exercises

594
00:22:48,559 --> 00:22:53,360
and maybe even hunt to form hypotheses

595
00:22:53,360 --> 00:22:55,760
you can measure and track what is going

596
00:22:55,760 --> 00:22:58,080
on in different areas of your org

597
00:22:58,080 --> 00:23:00,320
departments and people that are being

598
00:23:00,320 --> 00:23:01,200
attacked

599
00:23:01,200 --> 00:23:03,280
you can track the various deliverables

600
00:23:03,280 --> 00:23:04,240
and projects

601
00:23:04,240 --> 00:23:06,640
using a gantt chart or whatever other

602
00:23:06,640 --> 00:23:08,559
tracking means you have

603
00:23:08,559 --> 00:23:11,039
for all the initiatives and intelligence

604
00:23:11,039 --> 00:23:12,880
requirements you have

605
00:23:12,880 --> 00:23:15,120
so to oversimplify the adversary

606
00:23:15,120 --> 00:23:16,799
detection pipelines

607
00:23:16,799 --> 00:23:19,679
they provide a prioritized workflow

608
00:23:19,679 --> 00:23:21,200
based upon the attacks

609
00:23:21,200 --> 00:23:24,400
directed at the org through analysis

610
00:23:24,400 --> 00:23:27,520
performed by the cti analyst

611
00:23:27,520 --> 00:23:30,159
it is the focused creation of

612
00:23:30,159 --> 00:23:31,120
intelligence

613
00:23:31,120 --> 00:23:34,159
based upon specific intelligence

614
00:23:34,159 --> 00:23:36,799
requirements for the sole purpose of

615
00:23:36,799 --> 00:23:37,679
enriching

616
00:23:37,679 --> 00:23:40,240
other teams and improving the security

617
00:23:40,240 --> 00:23:40,960
posture

618
00:23:40,960 --> 00:23:44,320
of the organization

619
00:23:44,559 --> 00:23:47,440
you can also do reports and metrics you

620
00:23:47,440 --> 00:23:48,159
can trap

621
00:23:48,159 --> 00:23:51,679
purple team ops track hunt track gaps

622
00:23:51,679 --> 00:23:53,760
and i recommend also documenting

623
00:23:53,760 --> 00:23:54,720
communication

624
00:23:54,720 --> 00:23:57,520
and procedural shifts as a result of

625
00:23:57,520 --> 00:23:58,559
implementing the

626
00:23:58,559 --> 00:24:02,559
adversary detection pipelines

627
00:24:03,200 --> 00:24:06,000
so the use of business departmental and

628
00:24:06,000 --> 00:24:06,880
security team

629
00:24:06,880 --> 00:24:10,000
and cti initiatives to filter the

630
00:24:10,000 --> 00:24:12,880
entire internet and look at three things

631
00:24:12,880 --> 00:24:15,520
so the email attack data

632
00:24:15,520 --> 00:24:18,080
internal sources such as defer sock

633
00:24:18,080 --> 00:24:19,200
tickets

634
00:24:19,200 --> 00:24:21,840
monitoring private intel sharing groups

635
00:24:21,840 --> 00:24:23,200
industry vertical

636
00:24:23,200 --> 00:24:27,200
private sharing groups intel vendors

637
00:24:27,200 --> 00:24:29,840
and third open source reporting to

638
00:24:29,840 --> 00:24:30,880
produce

639
00:24:30,880 --> 00:24:33,919
actionable intelligence and create

640
00:24:33,919 --> 00:24:36,159
an adversary detection pipeline for the

641
00:24:36,159 --> 00:24:37,039
blue

642
00:24:37,039 --> 00:24:40,159
red and purple teams to use to search

643
00:24:40,159 --> 00:24:40,559
for

644
00:24:40,559 --> 00:24:43,600
badness to emulate the badness

645
00:24:43,600 --> 00:24:46,720
and better understand the org's controls

646
00:24:46,720 --> 00:24:51,440
detection and response capabilities

647
00:24:51,919 --> 00:24:56,159
oh and one more thing

648
00:24:56,480 --> 00:24:58,480
i'm going to show you how to tie

649
00:24:58,480 --> 00:25:00,320
everything together with a practical

650
00:25:00,320 --> 00:25:01,360
example

651
00:25:01,360 --> 00:25:04,080
incorporating the cti departmental and

652
00:25:04,080 --> 00:25:05,520
business initiatives

653
00:25:05,520 --> 00:25:08,720
for the adversary detection pipeline so

654
00:25:08,720 --> 00:25:11,200
let's say in the businesses annual

655
00:25:11,200 --> 00:25:12,240
report

656
00:25:12,240 --> 00:25:15,200
x team is leading a program to form

657
00:25:15,200 --> 00:25:17,520
partnerships for a new incentives

658
00:25:17,520 --> 00:25:18,480
program

659
00:25:18,480 --> 00:25:21,679
that is revenue generating for the org

660
00:25:21,679 --> 00:25:24,640
so keeping an eye on the department you

661
00:25:24,640 --> 00:25:26,000
notice a campaign

662
00:25:26,000 --> 00:25:28,559
that is being sent specifically to those

663
00:25:28,559 --> 00:25:31,279
people associated with the project

664
00:25:31,279 --> 00:25:34,400
purple just happens to have an exercise

665
00:25:34,400 --> 00:25:35,440
coming up

666
00:25:35,440 --> 00:25:38,400
and you know how important it is to the

667
00:25:38,400 --> 00:25:38,880
org

668
00:25:38,880 --> 00:25:40,640
to support the revenue generating

669
00:25:40,640 --> 00:25:43,039
incentives programs so

670
00:25:43,039 --> 00:25:46,159
why not create a purple exercise out of

671
00:25:46,159 --> 00:25:47,360
it

672
00:25:47,360 --> 00:25:49,440
so this is where psi's purple team

673
00:25:49,440 --> 00:25:51,760
exercise framework comes in and we'll

674
00:25:51,760 --> 00:25:52,720
start at the

675
00:25:52,720 --> 00:25:56,320
cyber threat intelligence arrow

676
00:25:56,320 --> 00:25:58,720
we're also going to incorporate a threat

677
00:25:58,720 --> 00:26:00,559
intelligence process for the purple

678
00:26:00,559 --> 00:26:01,440
teaming

679
00:26:01,440 --> 00:26:04,880
using eric van burgen out's threat intel

680
00:26:04,880 --> 00:26:06,320
process

681
00:26:06,320 --> 00:26:08,480
so understanding the org adversary

682
00:26:08,480 --> 00:26:10,000
detection pipelines can help

683
00:26:10,000 --> 00:26:13,760
you understand your org identify the

684
00:26:13,760 --> 00:26:14,880
adversary

685
00:26:14,880 --> 00:26:17,200
of course adversary detection pipelines

686
00:26:17,200 --> 00:26:17,919
can help you

687
00:26:17,919 --> 00:26:20,880
identify and prioritize threats

688
00:26:20,880 --> 00:26:24,480
impacting your organization

689
00:26:24,480 --> 00:26:26,880
so you noticed the targeted attacks to

690
00:26:26,880 --> 00:26:28,240
the people involved

691
00:26:28,240 --> 00:26:30,400
in the new revenue generating business

692
00:26:30,400 --> 00:26:31,440
initiative

693
00:26:31,440 --> 00:26:33,520
through looking at the blocked email

694
00:26:33,520 --> 00:26:34,559
data that you

695
00:26:34,559 --> 00:26:36,799
are tracking as part of the adversary

696
00:26:36,799 --> 00:26:38,960
detection pipeline

697
00:26:38,960 --> 00:26:41,520
oh and as a reminder for purple team

698
00:26:41,520 --> 00:26:42,720
exercises

699
00:26:42,720 --> 00:26:45,200
you can use the threat actor heat maps

700
00:26:45,200 --> 00:26:46,880
to see the activity

701
00:26:46,880 --> 00:26:49,360
and prioritize purple team operations

702
00:26:49,360 --> 00:26:50,480
based on

703
00:26:50,480 --> 00:26:53,120
delivery or even clicked messages and

704
00:26:53,120 --> 00:26:56,719
the associated ttps

705
00:26:57,039 --> 00:26:59,039
you can also use the miter attack

706
00:26:59,039 --> 00:27:01,600
navigator to view all the ttps for your

707
00:27:01,600 --> 00:27:03,279
thread activity groups to help you

708
00:27:03,279 --> 00:27:04,640
prioritize

709
00:27:04,640 --> 00:27:07,919
your purple team exercises also

710
00:27:07,919 --> 00:27:11,360
purple team exercises do not have to be

711
00:27:11,360 --> 00:27:13,760
only about emulating behaviors of

712
00:27:13,760 --> 00:27:16,320
attacks in a specific sequence

713
00:27:16,320 --> 00:27:19,279
you can run exercises based upon

714
00:27:19,279 --> 00:27:20,880
whatever works your org

715
00:27:20,880 --> 00:27:24,720
and your resources available

716
00:27:25,120 --> 00:27:27,600
so you can supplement the email attack

717
00:27:27,600 --> 00:27:28,159
data

718
00:27:28,159 --> 00:27:30,960
with any incident data sharing group

719
00:27:30,960 --> 00:27:31,840
intel

720
00:27:31,840 --> 00:27:34,320
or publicly available threat reports and

721
00:27:34,320 --> 00:27:34,880
of course

722
00:27:34,880 --> 00:27:38,080
open source reporting

723
00:27:38,480 --> 00:27:41,679
so remember we are extracting the ttps

724
00:27:41,679 --> 00:27:42,399
to provide

725
00:27:42,399 --> 00:27:44,960
value to the org so that your security

726
00:27:44,960 --> 00:27:46,960
team can look at the controls

727
00:27:46,960 --> 00:27:49,440
detection and response for all the

728
00:27:49,440 --> 00:27:51,039
stages of the attack path

729
00:27:51,039 --> 00:27:54,640
for your organization so as you get

730
00:27:54,640 --> 00:27:57,679
further into this and

731
00:27:57,679 --> 00:27:59,440
you you might want to get better at

732
00:27:59,440 --> 00:28:01,520
malware analysis and understanding what

733
00:28:01,520 --> 00:28:03,279
it is that you're looking at

734
00:28:03,279 --> 00:28:06,320
coleman kane a phd candidate and

735
00:28:06,320 --> 00:28:08,000
senior cyber threat intelligence

736
00:28:08,000 --> 00:28:09,440
research analyst

737
00:28:09,440 --> 00:28:11,600
has some great malware analysis

738
00:28:11,600 --> 00:28:13,120
materials

739
00:28:13,120 --> 00:28:16,720
also monapa ka

740
00:28:16,720 --> 00:28:18,640
he's an information security

741
00:28:18,640 --> 00:28:20,320
investigator at cisco

742
00:28:20,320 --> 00:28:22,399
he has a great book called learning

743
00:28:22,399 --> 00:28:23,679
malware analysis

744
00:28:23,679 --> 00:28:26,720
and in it he goes through and uses

745
00:28:26,720 --> 00:28:28,799
memory forensic techniques

746
00:28:28,799 --> 00:28:30,880
to analyze malware to extract the

747
00:28:30,880 --> 00:28:31,919
behaviors

748
00:28:31,919 --> 00:28:36,000
it's a really good book i recommend it

749
00:28:36,000 --> 00:28:38,080
so we're going to use mitre attacks

750
00:28:38,080 --> 00:28:40,159
tactics to guide the research

751
00:28:40,159 --> 00:28:43,200
and extraction of the ttps

752
00:28:43,200 --> 00:28:45,360
and the process i used throughout this

753
00:28:45,360 --> 00:28:46,240
is i

754
00:28:46,240 --> 00:28:48,399
i looked at joe's sandbox and the miter

755
00:28:48,399 --> 00:28:49,679
attack section

756
00:28:49,679 --> 00:28:52,080
then i looked at the joe sandbox

757
00:28:52,080 --> 00:28:52,880
specific

758
00:28:52,880 --> 00:28:56,159
entry in the report then i pivoted to

759
00:28:56,159 --> 00:28:59,039
atomic red team for the technique then i

760
00:28:59,039 --> 00:29:00,880
looked at the yaml contents

761
00:29:00,880 --> 00:29:03,200
and whatever wasn't there i googled the

762
00:29:03,200 --> 00:29:04,080
rest

763
00:29:04,080 --> 00:29:07,520
so also too for the purposes of this

764
00:29:07,520 --> 00:29:08,320
talk

765
00:29:08,320 --> 00:29:10,480
i'm going to provide highlights of

766
00:29:10,480 --> 00:29:13,840
extracting ttps

767
00:29:14,720 --> 00:29:17,520
so it's an email with an xe attachment

768
00:29:17,520 --> 00:29:17,919
and

769
00:29:17,919 --> 00:29:20,559
whether or not an org blocks exe

770
00:29:20,559 --> 00:29:21,679
attachments

771
00:29:21,679 --> 00:29:23,919
what i'm interested in are the behaviors

772
00:29:23,919 --> 00:29:25,440
of these campaigns since they are

773
00:29:25,440 --> 00:29:26,080
targeting

774
00:29:26,080 --> 00:29:29,200
people involved in a new revenue

775
00:29:29,200 --> 00:29:31,360
generating business initiative

776
00:29:31,360 --> 00:29:33,760
so that is why we are taking an assumed

777
00:29:33,760 --> 00:29:36,559
breach approach

778
00:29:36,559 --> 00:29:39,039
execution so when you look at the

779
00:29:39,039 --> 00:29:40,240
specific section

780
00:29:40,240 --> 00:29:43,039
of the malware report do your best to

781
00:29:43,039 --> 00:29:45,039
get the specific campaigns

782
00:29:45,039 --> 00:29:47,679
that so that it can help adversary

783
00:29:47,679 --> 00:29:49,919
emulation

784
00:29:49,919 --> 00:29:53,440
so for t1047 i couldn't find the atomic

785
00:29:53,440 --> 00:29:54,640
red team

786
00:29:54,640 --> 00:29:57,679
test that fit my use case initially

787
00:29:57,679 --> 00:29:59,440
so then i had to do a bunch of googling

788
00:29:59,440 --> 00:30:01,600
and i found what i needed on stack

789
00:30:01,600 --> 00:30:02,640
overflow

790
00:30:02,640 --> 00:30:04,720
and it wasn't until later in this

791
00:30:04,720 --> 00:30:05,919
exercise

792
00:30:05,919 --> 00:30:08,240
of extracting the ttps that i found an

793
00:30:08,240 --> 00:30:09,120
atomic test

794
00:30:09,120 --> 00:30:12,159
under a different technique name that

795
00:30:12,159 --> 00:30:13,919
worked for my use case

796
00:30:13,919 --> 00:30:15,919
so keep in mind when you're building

797
00:30:15,919 --> 00:30:17,200
this out

798
00:30:17,200 --> 00:30:22,080
to look at other techniques just in case

799
00:30:22,080 --> 00:30:24,320
privilege escalation so getting the

800
00:30:24,320 --> 00:30:27,120
command line arguments are important

801
00:30:27,120 --> 00:30:30,080
i pivoted from joe sandbox to malware

802
00:30:30,080 --> 00:30:32,240
bazaar found the sample and i looked it

803
00:30:32,240 --> 00:30:32,799
up

804
00:30:32,799 --> 00:30:35,360
to find any associated yara rules with

805
00:30:35,360 --> 00:30:36,080
it and what i

806
00:30:36,080 --> 00:30:39,200
found was a yara rule from 2015

807
00:30:39,200 --> 00:30:40,960
and it was still catching samples off

808
00:30:40,960 --> 00:30:42,559
the command line argument

809
00:30:42,559 --> 00:30:44,720
so what this tells me is that i need to

810
00:30:44,720 --> 00:30:45,919
include this in the

811
00:30:45,919 --> 00:30:48,559
end report that i give to the other team

812
00:30:48,559 --> 00:30:51,760
since it remained the same since 2015.

813
00:30:51,760 --> 00:30:54,559
it might change tomorrow but for now it

814
00:30:54,559 --> 00:30:56,640
hasn't

815
00:30:56,640 --> 00:30:58,399
so there was a lot of defense evasion

816
00:30:58,399 --> 00:30:59,679
with this sample

817
00:30:59,679 --> 00:31:01,679
and you want to try to include things in

818
00:31:01,679 --> 00:31:04,159
the ttp extraction that could be useful

819
00:31:04,159 --> 00:31:07,120
for defenders too

820
00:31:07,120 --> 00:31:09,200
credentialed access they were trying to

821
00:31:09,200 --> 00:31:10,880
get the passwords from

822
00:31:10,880 --> 00:31:14,480
browsers collection they were trying to

823
00:31:14,480 --> 00:31:15,279
get

824
00:31:15,279 --> 00:31:19,440
the mail client info command and control

825
00:31:19,440 --> 00:31:21,760
a really helpful tip is using the c2

826
00:31:21,760 --> 00:31:22,640
matrix

827
00:31:22,640 --> 00:31:25,120
you can look at the specific ttps of the

828
00:31:25,120 --> 00:31:26,960
sample that you're extracting

829
00:31:26,960 --> 00:31:29,200
and find the specifics and then look on

830
00:31:29,200 --> 00:31:31,279
the c2 matrix for

831
00:31:31,279 --> 00:31:33,600
something that will work for the address

832
00:31:33,600 --> 00:31:36,480
for the purple team exercise

833
00:31:36,480 --> 00:31:39,039
so exfiltration this is a really good

834
00:31:39,039 --> 00:31:40,159
place to consider

835
00:31:40,159 --> 00:31:43,279
how your org handles encrypted

836
00:31:43,279 --> 00:31:46,240
x fill as well as to understand how your

837
00:31:46,240 --> 00:31:47,120
org handles

838
00:31:47,120 --> 00:31:50,080
x film in general well whether it's

839
00:31:50,080 --> 00:31:51,039
encrypted or not

840
00:31:51,039 --> 00:31:54,399
so sometimes uh you get lucky

841
00:31:54,399 --> 00:31:56,799
and companies will share how the exfil

842
00:31:56,799 --> 00:31:59,039
happened during their data breach

843
00:31:59,039 --> 00:32:01,600
so knowing what you do at your org can

844
00:32:01,600 --> 00:32:02,640
help you gauge

845
00:32:02,640 --> 00:32:06,159
where you're at also as a little side

846
00:32:06,159 --> 00:32:08,000
note i do not recommend using

847
00:32:08,000 --> 00:32:11,279
real pii or credit card data for x

848
00:32:11,279 --> 00:32:13,279
filling

849
00:32:13,279 --> 00:32:16,000
and testing and exercises i don't

850
00:32:16,000 --> 00:32:18,480
recommend it

851
00:32:18,480 --> 00:32:20,720
so impact with this particular sample

852
00:32:20,720 --> 00:32:22,320
there doesn't seem to be destruction

853
00:32:22,320 --> 00:32:24,399
involved it's not ransomware

854
00:32:24,399 --> 00:32:26,840
um it just seems like they're stealing

855
00:32:26,840 --> 00:32:28,159
credentials

856
00:32:28,159 --> 00:32:30,399
so once you extract the ttps you need to

857
00:32:30,399 --> 00:32:32,159
analyze and organize

858
00:32:32,159 --> 00:32:34,480
the information and part of the purple

859
00:32:34,480 --> 00:32:36,640
team exercise framework provides a

860
00:32:36,640 --> 00:32:37,519
template

861
00:32:37,519 --> 00:32:40,640
to collect all the ttp information it

862
00:32:40,640 --> 00:32:42,640
also provides suggestions on working

863
00:32:42,640 --> 00:32:45,279
with other teams to decide which ttps to

864
00:32:45,279 --> 00:32:46,559
actually test

865
00:32:46,559 --> 00:32:50,000
in the purple team exercise so once the

866
00:32:50,000 --> 00:32:50,960
ttps

867
00:32:50,960 --> 00:32:53,679
are decided upon teams can work together

868
00:32:53,679 --> 00:32:56,799
to create a plan

869
00:32:56,799 --> 00:32:59,279
and emulate the adversary this is where

870
00:32:59,279 --> 00:33:00,480
the cti team

871
00:33:00,480 --> 00:33:02,320
waits for the rest of the phases of the

872
00:33:02,320 --> 00:33:05,600
purple team exercise to complete

873
00:33:05,600 --> 00:33:08,159
so now you go back to the purple team

874
00:33:08,159 --> 00:33:10,320
exercise framework from the threat intel

875
00:33:10,320 --> 00:33:11,279
process

876
00:33:11,279 --> 00:33:13,440
where the other team members finish up

877
00:33:13,440 --> 00:33:15,120
the preparation for the purple team

878
00:33:15,120 --> 00:33:16,320
exercise

879
00:33:16,320 --> 00:33:19,760
and actually complete the exercise and

880
00:33:19,760 --> 00:33:22,559
just so you know the cti analyst can

881
00:33:22,559 --> 00:33:24,880
attend the exercise as a spectator if

882
00:33:24,880 --> 00:33:27,200
they want

883
00:33:27,200 --> 00:33:30,080
so the lessons learned phase of purple

884
00:33:30,080 --> 00:33:31,840
of the purple team exercise

885
00:33:31,840 --> 00:33:34,480
is where cti analysts can learn even

886
00:33:34,480 --> 00:33:36,559
more about the organization

887
00:33:36,559 --> 00:33:38,640
and take these insights back to the

888
00:33:38,640 --> 00:33:40,320
products they create for

889
00:33:40,320 --> 00:33:44,320
other teams so through this exercise you

890
00:33:44,320 --> 00:33:46,240
saw a practical example

891
00:33:46,240 --> 00:33:49,279
of adversary detection pipelines

892
00:33:49,279 --> 00:33:51,760
you were able to determine that the

893
00:33:51,760 --> 00:33:52,559
attacker

894
00:33:52,559 --> 00:33:54,559
is looking for browser and email

895
00:33:54,559 --> 00:33:56,640
passwords for these key people

896
00:33:56,640 --> 00:33:58,320
in your org that are involved with the

897
00:33:58,320 --> 00:34:00,640
new revenue generating business

898
00:34:00,640 --> 00:34:03,279
initiative so through the purple team

899
00:34:03,279 --> 00:34:05,360
exercise you can find out

900
00:34:05,360 --> 00:34:07,840
how easy it could be to get passwords

901
00:34:07,840 --> 00:34:10,079
from those particular users

902
00:34:10,079 --> 00:34:12,560
and the purple team exercise can also

903
00:34:12,560 --> 00:34:15,199
help you look at your org's visibility

904
00:34:15,199 --> 00:34:18,639
controls detection and response

905
00:34:18,639 --> 00:34:21,119
also consider if there is a site

906
00:34:21,119 --> 00:34:23,040
associated with the initiative that you

907
00:34:23,040 --> 00:34:25,040
can access off network

908
00:34:25,040 --> 00:34:28,239
if so is 2fa enabled

909
00:34:28,239 --> 00:34:30,879
so you were able to support the business

910
00:34:30,879 --> 00:34:32,639
initiatives and security team

911
00:34:32,639 --> 00:34:33,599
initiatives

912
00:34:33,599 --> 00:34:35,839
through understanding your internal

913
00:34:35,839 --> 00:34:37,119
attack landscape

914
00:34:37,119 --> 00:34:41,040
with the cti initiatives the attackers

915
00:34:41,040 --> 00:34:43,679
basically don't need to get to full post

916
00:34:43,679 --> 00:34:45,520
exploitation activities

917
00:34:45,520 --> 00:34:48,239
for cti analysts to get value out of the

918
00:34:48,239 --> 00:34:51,030
ttps that the attackers share

919
00:34:51,030 --> 00:34:52,719
[Music]

920
00:34:52,719 --> 00:34:55,359
you also want to track your progress and

921
00:34:55,359 --> 00:34:56,960
the exercises so

922
00:34:56,960 --> 00:35:00,000
roberto rodriguez the principal threat

923
00:35:00,000 --> 00:35:02,720
researcher at microsoft also known as

924
00:35:02,720 --> 00:35:04,560
cyberwardog on twitter

925
00:35:04,560 --> 00:35:07,280
he has a great resource using excel for

926
00:35:07,280 --> 00:35:08,960
the miter attack navigator

927
00:35:08,960 --> 00:35:11,520
and it's a heat map basically a tracking

928
00:35:11,520 --> 00:35:13,920
hunt activities hunting activities

929
00:35:13,920 --> 00:35:16,160
so you can apply the same techniques he

930
00:35:16,160 --> 00:35:17,040
shared

931
00:35:17,040 --> 00:35:20,480
to your purple and adversary emulation

932
00:35:20,480 --> 00:35:25,680
exercises so beyond lessons learned

933
00:35:25,680 --> 00:35:27,839
commit to intelligence driven purple

934
00:35:27,839 --> 00:35:29,359
team exercises

935
00:35:29,359 --> 00:35:32,160
use models frameworks processes to make

936
00:35:32,160 --> 00:35:33,359
your life easier

937
00:35:33,359 --> 00:35:36,160
like miter attack diamond models c2

938
00:35:36,160 --> 00:35:38,079
matrix pyramida pane

939
00:35:38,079 --> 00:35:40,240
purple team exercise framework yara

940
00:35:40,240 --> 00:35:41,119
rules

941
00:35:41,119 --> 00:35:43,200
eric fan boogin outs threat intel

942
00:35:43,200 --> 00:35:44,480
process and

943
00:35:44,480 --> 00:35:48,320
of course adversary detection pipelines

944
00:35:48,320 --> 00:35:50,880
talk with your cti team and tell them

945
00:35:50,880 --> 00:35:52,320
what you need

946
00:35:52,320 --> 00:35:54,640
of course pick up a copy of the purple

947
00:35:54,640 --> 00:35:56,560
team exercise framework

948
00:35:56,560 --> 00:36:00,000
and jorge archules the cto of scythe

949
00:36:00,000 --> 00:36:02,960
put together a free workshop on purple

950
00:36:02,960 --> 00:36:04,800
team exercises

951
00:36:04,800 --> 00:36:08,000
so check that out

952
00:36:09,280 --> 00:36:12,800
basically use all of your org's specific

953
00:36:12,800 --> 00:36:15,760
attack data including the block data to

954
00:36:15,760 --> 00:36:16,480
analyze

955
00:36:16,480 --> 00:36:19,599
and create intelligence specific to

956
00:36:19,599 --> 00:36:22,960
your organization

957
00:36:23,040 --> 00:36:26,240
so in this talk we filtered

958
00:36:26,240 --> 00:36:28,960
the entire internet through the business

959
00:36:28,960 --> 00:36:30,079
department

960
00:36:30,079 --> 00:36:34,320
and security team and cti initiatives

961
00:36:34,320 --> 00:36:36,640
we used email attack data internal

962
00:36:36,640 --> 00:36:37,440
sources

963
00:36:37,440 --> 00:36:39,920
and open source reporting to create

964
00:36:39,920 --> 00:36:42,960
deliverables based on these initiatives

965
00:36:42,960 --> 00:36:45,920
i showed you a practical example of how

966
00:36:45,920 --> 00:36:48,160
adversary detection pipelines

967
00:36:48,160 --> 00:36:51,119
would fit into a purple team exercise

968
00:36:51,119 --> 00:36:52,960
using the purple team exercise

969
00:36:52,960 --> 00:36:56,079
framework so i hope the ideas

970
00:36:56,079 --> 00:36:58,960
shared with you today help you get more

971
00:36:58,960 --> 00:37:00,400
out of your threat intel

972
00:37:00,400 --> 00:37:03,839
and finally make your threat intel

973
00:37:03,839 --> 00:37:08,960
useful to close some taylor swift wisdom

974
00:37:08,960 --> 00:37:12,560
cti analysts can show you incredible

975
00:37:12,560 --> 00:37:14,960
things

976
00:37:14,960 --> 00:37:18,160
thank you for your time

977
00:37:19,839 --> 00:37:22,320
this is my twitter linkedin and also the

978
00:37:22,320 --> 00:37:24,160
bitly link again in case you didn't

979
00:37:24,160 --> 00:37:26,240
catch it

980
00:37:26,240 --> 00:37:30,160
and a special thanks to these people

981
00:37:30,400 --> 00:37:35,599
thank you

