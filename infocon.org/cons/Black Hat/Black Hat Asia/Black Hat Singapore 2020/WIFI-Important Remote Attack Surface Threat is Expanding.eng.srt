1
00:00:02,800 --> 00:00:03,760
hello everyone

2
00:00:03,760 --> 00:00:05,920
thank you for attending our talk it's a

3
00:00:05,920 --> 00:00:07,919
pleasure to share our research on wifi

4
00:00:07,919 --> 00:00:09,120
security with you

5
00:00:09,120 --> 00:00:11,440
today we'll be talking about wifi attack

6
00:00:11,440 --> 00:00:12,799
service and how to

7
00:00:12,799 --> 00:00:15,360
find high risk when repeated in wifi

8
00:00:15,360 --> 00:00:16,480
driver

9
00:00:16,480 --> 00:00:18,480
first of all i'll allow me to introduce

10
00:00:18,480 --> 00:00:19,520
my partner

11
00:00:19,520 --> 00:00:22,160
and myself my name is shayhakko i'm a

12
00:00:22,160 --> 00:00:23,920
security researcher from

13
00:00:23,920 --> 00:00:27,119
our singularity security lab and my main

14
00:00:27,119 --> 00:00:30,160
research field is software vulnerability

15
00:00:30,160 --> 00:00:32,079
while you and johnny are security

16
00:00:32,079 --> 00:00:33,280
researchers or

17
00:00:33,280 --> 00:00:35,680
vital security lab they are criticized

18
00:00:35,680 --> 00:00:38,079
funding and hiking lte devices

19
00:00:38,079 --> 00:00:40,399
next warning and i will show you this

20
00:00:40,399 --> 00:00:42,800
topic

21
00:00:42,800 --> 00:00:45,200
let's start our topic this is an

22
00:00:45,200 --> 00:00:47,360
overview of today's presentation

23
00:00:47,360 --> 00:00:49,920
we'll start with introducing some

24
00:00:49,920 --> 00:00:52,320
mainstream wi-fi chip manufacturer

25
00:00:52,320 --> 00:00:54,160
in the world and the wi-fi one

26
00:00:54,160 --> 00:00:55,840
repetitive in recent years

27
00:00:55,840 --> 00:00:58,239
so that you can have a general idea of

28
00:00:58,239 --> 00:00:59,440
the wi-fi devices

29
00:00:59,440 --> 00:01:03,840
we use and their current security status

30
00:01:03,840 --> 00:01:06,640
then we'll move on to some key attack

31
00:01:06,640 --> 00:01:08,159
services or wi-fi

32
00:01:08,159 --> 00:01:10,640
in the end i will explain our

33
00:01:10,640 --> 00:01:12,159
vulnerability discovery

34
00:01:12,159 --> 00:01:15,200
measures and share two vulnerability

35
00:01:15,200 --> 00:01:17,600
cases

36
00:01:18,240 --> 00:01:20,960
without further ado let's begin with the

37
00:01:20,960 --> 00:01:23,360
background

38
00:01:23,360 --> 00:01:25,360
wi-fi technology has been around for

39
00:01:25,360 --> 00:01:26,720
more than 20 years

40
00:01:26,720 --> 00:01:28,960
most of the wi-fi chip used by smart

41
00:01:28,960 --> 00:01:30,159
devices today

42
00:01:30,159 --> 00:01:33,600
are produced by broadcam pro cam realtek

43
00:01:33,600 --> 00:01:36,720
meteor tech malware intel famous

44
00:01:36,720 --> 00:01:37,280
products

45
00:01:37,280 --> 00:01:41,360
that use broadcast a ipo computer iphone

46
00:01:41,360 --> 00:01:44,720
and samsung mobile phone qualcomm

47
00:01:44,720 --> 00:01:46,880
snapdragon mobile

48
00:01:46,880 --> 00:01:49,680
platform is widely used instead android

49
00:01:49,680 --> 00:01:50,320
phones

50
00:01:50,320 --> 00:01:53,680
intel wi-fi chip are mainly using laptop

51
00:01:53,680 --> 00:01:54,960
computer

52
00:01:54,960 --> 00:01:58,560
in which lenovo and dell laptop are used

53
00:01:58,560 --> 00:02:01,439
intel wireless network adapter meteor

54
00:02:01,439 --> 00:02:02,240
tech

55
00:02:02,240 --> 00:02:05,119
wifi chips are used in neutral network

56
00:02:05,119 --> 00:02:05,840
adapter

57
00:02:05,840 --> 00:02:08,959
and android phones real-time wi-fi

58
00:02:08,959 --> 00:02:11,680
chips are mainly used in bluetooth and

59
00:02:11,680 --> 00:02:13,280
usb network adapter

60
00:02:13,280 --> 00:02:16,239
the most popular usb wear wireless

61
00:02:16,239 --> 00:02:17,360
network adapter

62
00:02:17,360 --> 00:02:20,000
in china use real-time web achieves

63
00:02:20,000 --> 00:02:20,959
malware

64
00:02:20,959 --> 00:02:24,400
microsoft surface pro you use malware

65
00:02:24,400 --> 00:02:27,040
wifi chip

66
00:02:27,520 --> 00:02:30,160
now technology is bone perfect history

67
00:02:30,160 --> 00:02:30,879
shows that

68
00:02:30,879 --> 00:02:33,760
wi-fi also has many vulnerabilities you

69
00:02:33,760 --> 00:02:36,720
after more than 20 years of development

70
00:02:36,720 --> 00:02:40,160
its security remains to be a big person

71
00:02:40,160 --> 00:02:43,840
in 2017 the remote remotely exposable

72
00:02:43,840 --> 00:02:46,400
vulnerability of broadcast chip exposed

73
00:02:46,400 --> 00:02:46,800
by

74
00:02:46,800 --> 00:02:51,120
google project their multi

75
00:02:51,120 --> 00:02:54,319
android and ls as long as the table

76
00:02:54,319 --> 00:02:57,040
and the target device are in the same

77
00:02:57,040 --> 00:02:58,000
wi-fi network

78
00:02:58,000 --> 00:03:00,400
they can launch the user insensitive

79
00:03:00,400 --> 00:03:01,440
attack

80
00:03:01,440 --> 00:03:05,200
in 2018 denis introduced a remote

81
00:03:05,200 --> 00:03:07,680
vulnerability exploitation of malware

82
00:03:07,680 --> 00:03:08,599
weaponship

83
00:03:08,599 --> 00:03:11,599
accelerates converse which is also an

84
00:03:11,599 --> 00:03:12,480
attack that

85
00:03:12,480 --> 00:03:16,800
can be launched without authentication

86
00:03:16,800 --> 00:03:20,239
in 2019 us search released a number of

87
00:03:20,239 --> 00:03:21,599
security alerts

88
00:03:21,599 --> 00:03:24,400
for broadcast wi-fi chip drivers which

89
00:03:24,400 --> 00:03:25,120
affected

90
00:03:25,120 --> 00:03:28,560
android linux retails and other devices

91
00:03:28,560 --> 00:03:31,440
i also already attacked can launch

92
00:03:31,440 --> 00:03:32,159
attacks

93
00:03:32,159 --> 00:03:35,840
so managers wi-fi packages these attacks

94
00:03:35,840 --> 00:03:39,280
can be launched without authentication

95
00:03:39,280 --> 00:03:41,920
no user interaction is required and no

96
00:03:41,920 --> 00:03:44,400
physical contact is repaired

97
00:03:44,400 --> 00:03:46,959
ordinary users this candle attack is

98
00:03:46,959 --> 00:03:49,120
very difficult to province

99
00:03:49,120 --> 00:03:52,400
as the reality really supports all

100
00:03:52,400 --> 00:03:55,200
at least just individual cases to get to

101
00:03:55,200 --> 00:03:56,400
the bottom of this

102
00:03:56,400 --> 00:03:59,920
we took a closer look on wi-fi security

103
00:03:59,920 --> 00:04:00,400
and from

104
00:04:00,400 --> 00:04:03,120
that this is actually a big attack

105
00:04:03,120 --> 00:04:05,599
service

106
00:04:05,760 --> 00:04:08,959
next we will will focus on key

107
00:04:08,959 --> 00:04:12,560
attack service on wifi wi-fi chip

108
00:04:12,560 --> 00:04:15,439
is used using intelligent devices it's

109
00:04:15,439 --> 00:04:16,639
it not only

110
00:04:16,639 --> 00:04:20,000
sends and receives communication package

111
00:04:20,000 --> 00:04:23,600
from datalink layer but also interacts

112
00:04:23,600 --> 00:04:26,000
with system and software the

113
00:04:26,000 --> 00:04:27,520
communication interface

114
00:04:27,520 --> 00:04:30,720
and the operating logic of data a link

115
00:04:30,720 --> 00:04:31,199
layer

116
00:04:31,199 --> 00:04:33,680
high on remote attack surface the finger

117
00:04:33,680 --> 00:04:34,800
on the left

118
00:04:34,800 --> 00:04:37,680
release several remote attack surfaces

119
00:04:37,680 --> 00:04:39,199
with great influence

120
00:04:39,199 --> 00:04:41,840
the finger on the right shows a local

121
00:04:41,840 --> 00:04:44,160
attack surface

122
00:04:44,160 --> 00:04:47,360
of wi-fi a software can communicate with

123
00:04:47,360 --> 00:04:49,199
wi-fi driver through our control

124
00:04:49,199 --> 00:04:50,960
interface or wifi driver

125
00:04:50,960 --> 00:04:53,440
and because the code is in the kernel

126
00:04:53,440 --> 00:04:54,080
driver

127
00:04:54,080 --> 00:04:56,639
the code running authority is very high

128
00:04:56,639 --> 00:04:58,479
if there is a vulnerability

129
00:04:58,479 --> 00:05:02,160
it can cause local employability

130
00:05:02,160 --> 00:05:04,880
escalation

131
00:05:06,560 --> 00:05:08,639
well we mainly focus on the remote

132
00:05:08,639 --> 00:05:09,600
attack service

133
00:05:09,600 --> 00:05:12,240
first let's talk about the association

134
00:05:12,240 --> 00:05:13,280
stage

135
00:05:13,280 --> 00:05:16,240
the three interaction of station

136
00:05:16,240 --> 00:05:17,120
associating

137
00:05:17,120 --> 00:05:19,520
access point this is the most surprising

138
00:05:19,520 --> 00:05:20,479
and widely

139
00:05:20,479 --> 00:05:24,240
used function of wi-fi access point

140
00:05:24,240 --> 00:05:26,400
refer to wireless router and other

141
00:05:26,400 --> 00:05:29,120
devices that generate wi-fi hospital

142
00:05:29,120 --> 00:05:32,240
a station refer to mobile phones or

143
00:05:32,240 --> 00:05:35,120
computers and other devices connect to

144
00:05:35,120 --> 00:05:36,080
wi-fi

145
00:05:36,080 --> 00:05:38,320
how does the mobile device access the

146
00:05:38,320 --> 00:05:39,680
wireless network

147
00:05:39,680 --> 00:05:42,639
the connection of weld network is very

148
00:05:42,639 --> 00:05:44,560
simple as long as the network

149
00:05:44,560 --> 00:05:48,000
cable of the device is inserted into the

150
00:05:48,000 --> 00:05:51,360
network port network system is connected

151
00:05:51,360 --> 00:05:53,039
to the wireless network

152
00:05:53,039 --> 00:05:55,840
need to complete this part of work

153
00:05:55,840 --> 00:05:56,639
through

154
00:05:56,639 --> 00:06:00,160
the management frame the mobile device

155
00:06:00,160 --> 00:06:02,560
search the network system the network

156
00:06:02,560 --> 00:06:05,440
system verify the mobile device

157
00:06:05,440 --> 00:06:08,080
finally the mobile device is associated

158
00:06:08,080 --> 00:06:08,639
with the

159
00:06:08,639 --> 00:06:11,680
network sector the the where learners

160
00:06:11,680 --> 00:06:12,319
network

161
00:06:12,319 --> 00:06:15,600
system is connected

162
00:06:17,039 --> 00:06:19,840
the bio function is mainly implemented

163
00:06:19,840 --> 00:06:21,360
by measurement frames

164
00:06:21,360 --> 00:06:24,080
such as bitcoin frame prop 3

165
00:06:24,080 --> 00:06:25,360
authentication frame

166
00:06:25,360 --> 00:06:28,720
association frame etc this page takes

167
00:06:28,720 --> 00:06:31,120
the structure of association requests

168
00:06:31,120 --> 00:06:34,400
frame as an example to introduce a

169
00:06:34,400 --> 00:06:35,039
structure

170
00:06:35,039 --> 00:06:38,000
of measurement free the management frame

171
00:06:38,000 --> 00:06:40,400
is composed of frame handle and free

172
00:06:40,400 --> 00:06:41,039
body

173
00:06:41,039 --> 00:06:43,039
the frame handler contains the mac

174
00:06:43,039 --> 00:06:45,280
address of target device and

175
00:06:45,280 --> 00:06:48,160
source device the frame board is many

176
00:06:48,160 --> 00:06:52,000
composed of information elements

177
00:06:52,000 --> 00:06:54,080
the structure of information elements is

178
00:06:54,080 --> 00:06:55,919
a typical tlv structure

179
00:06:55,919 --> 00:06:58,800
tag loss value but it usually contains a

180
00:06:58,800 --> 00:07:00,639
batch element id field or

181
00:07:00,639 --> 00:07:04,080
as long field underwear or long

182
00:07:04,080 --> 00:07:06,319
value field some information elements

183
00:07:06,319 --> 00:07:07,199
also have an

184
00:07:07,199 --> 00:07:10,759
extended element id field more

185
00:07:10,759 --> 00:07:12,560
complication

186
00:07:12,560 --> 00:07:16,240
in the more dangerous however in the

187
00:07:16,240 --> 00:07:18,479
process of station oxidizing access

188
00:07:18,479 --> 00:07:19,120
points

189
00:07:19,120 --> 00:07:22,560
only sweet message interchange and water

190
00:07:22,560 --> 00:07:23,199
is a

191
00:07:23,199 --> 00:07:26,000
complexity of such a simple process the

192
00:07:26,000 --> 00:07:28,840
complexity lies in the information

193
00:07:28,840 --> 00:07:30,240
element

194
00:07:30,240 --> 00:07:32,400
first a variable loan structure

195
00:07:32,400 --> 00:07:34,479
generally there is a central

196
00:07:34,479 --> 00:07:36,880
range for the loss or information

197
00:07:36,880 --> 00:07:37,520
element

198
00:07:37,520 --> 00:07:40,639
such as ssid information element which

199
00:07:40,639 --> 00:07:41,520
is usually

200
00:07:41,520 --> 00:07:45,680
0 to 32 bets but the actual value of

201
00:07:45,680 --> 00:07:46,639
this structure

202
00:07:46,639 --> 00:07:50,560
can reach 255 bets

203
00:07:50,560 --> 00:07:53,039
if the launch is not very fast in the

204
00:07:53,039 --> 00:07:54,560
power it's easy to

205
00:07:54,560 --> 00:07:56,879
cause buffer overflow this scandal

206
00:07:56,879 --> 00:07:58,639
vulnerability is easy to find

207
00:07:58,639 --> 00:08:01,039
but even if it were found more than 10

208
00:08:01,039 --> 00:08:02,000
years ago

209
00:08:02,000 --> 00:08:04,560
that doesn't mean then you won't make

210
00:08:04,560 --> 00:08:06,800
the same mistake

211
00:08:06,800 --> 00:08:09,840
second there are more than 200 kinds of

212
00:08:09,840 --> 00:08:11,360
information elements

213
00:08:11,360 --> 00:08:13,520
information element carries a candle

214
00:08:13,520 --> 00:08:14,400
information

215
00:08:14,400 --> 00:08:18,479
it must be a lot of effort for coder to

216
00:08:18,479 --> 00:08:20,960
implement these functions it's because

217
00:08:20,960 --> 00:08:21,599
of the

218
00:08:21,599 --> 00:08:24,639
abundant information elements that

219
00:08:24,639 --> 00:08:26,800
refine post such rich feature and

220
00:08:26,800 --> 00:08:27,840
functions which

221
00:08:27,840 --> 00:08:31,280
also expand its attack surface third

222
00:08:31,280 --> 00:08:33,839
the extensible interface for the future

223
00:08:33,839 --> 00:08:36,399
is reserved in the information element

224
00:08:36,399 --> 00:08:38,559
and the operation of the extended

225
00:08:38,559 --> 00:08:39,519
information

226
00:08:39,519 --> 00:08:41,839
also increases the complexity of the

227
00:08:41,839 --> 00:08:44,080
program which also increases the

228
00:08:44,080 --> 00:08:47,040
security risk in the vulnerability this

229
00:08:47,040 --> 00:08:49,519
is later we will give an example to

230
00:08:49,519 --> 00:08:52,839
illustrate the risk brought by this

231
00:08:52,839 --> 00:08:54,399
operation

232
00:08:54,399 --> 00:08:57,519
first progress customer mass information

233
00:08:57,519 --> 00:08:58,160
element

234
00:08:58,160 --> 00:09:00,320
vendor specific information elements can

235
00:09:00,320 --> 00:09:01,760
not only contain the

236
00:09:01,760 --> 00:09:04,640
content of defined by each manufacturer

237
00:09:04,640 --> 00:09:04,959
but

238
00:09:04,959 --> 00:09:08,240
also include wi-fi protection

239
00:09:08,240 --> 00:09:11,600
sense and other functions it carries

240
00:09:11,600 --> 00:09:13,920
so many functions in an information

241
00:09:13,920 --> 00:09:16,480
element which requires a higher level

242
00:09:16,480 --> 00:09:19,519
of information element passing fifth

243
00:09:19,519 --> 00:09:21,839
structural content structure taking as

244
00:09:21,839 --> 00:09:22,959
an information

245
00:09:22,959 --> 00:09:26,240
element as an example as a represents

246
00:09:26,240 --> 00:09:28,399
robust security network the information

247
00:09:28,399 --> 00:09:31,200
element enable station and the access

248
00:09:31,200 --> 00:09:33,680
point to exchange security information

249
00:09:33,680 --> 00:09:35,600
it contains encryption suite

250
00:09:35,600 --> 00:09:37,839
supported by devices the encryption

251
00:09:37,839 --> 00:09:39,519
series has a count field

252
00:09:39,519 --> 00:09:42,560
and the corresponding suits at least it

253
00:09:42,560 --> 00:09:43,360
may cause

254
00:09:43,360 --> 00:09:45,440
conflicts between the loans or

255
00:09:45,440 --> 00:09:46,480
information elements

256
00:09:46,480 --> 00:09:49,040
and the counterfeit which can easily

257
00:09:49,040 --> 00:09:50,240
cause problems

258
00:09:50,240 --> 00:09:53,440
all these can all these are

259
00:09:53,440 --> 00:09:56,080
challenging for coders not to machine

260
00:09:56,080 --> 00:09:56,640
some

261
00:09:56,640 --> 00:10:01,279
undefended parts in the 802.11

262
00:10:01,279 --> 00:10:04,079
specification they even create infinity

263
00:10:04,079 --> 00:10:06,880
possibilities

264
00:10:08,240 --> 00:10:11,120
wi-fi authentication stage this doesn't

265
00:10:11,120 --> 00:10:11,760
refer

266
00:10:11,760 --> 00:10:14,000
to the part of the interaction or

267
00:10:14,000 --> 00:10:15,279
authentication free

268
00:10:15,279 --> 00:10:17,920
but the actual verification of the

269
00:10:17,920 --> 00:10:19,360
password information

270
00:10:19,360 --> 00:10:22,720
of station us other

271
00:10:22,720 --> 00:10:26,160
authentication methods such as wp wp2 is

272
00:10:26,160 --> 00:10:28,040
a four-way handshake or

273
00:10:28,040 --> 00:10:31,519
eapoll package the more complex one

274
00:10:31,519 --> 00:10:35,360
is with handshake certification or wps

275
00:10:35,360 --> 00:10:37,839
and the more complex is the

276
00:10:37,839 --> 00:10:39,040
authentication of

277
00:10:39,040 --> 00:10:42,320
enterprise wpa this stage

278
00:10:42,320 --> 00:10:44,839
involves more computation of

279
00:10:44,839 --> 00:10:46,320
cryptography

280
00:10:46,320 --> 00:10:49,519
aggressor and attacks based on

281
00:10:49,519 --> 00:10:51,839
every ceramic vulnerability usually

282
00:10:51,839 --> 00:10:53,279
occur at this stage

283
00:10:53,279 --> 00:10:56,399
for example krbc vulnerability

284
00:10:56,399 --> 00:10:59,040
of course there is also the possibility

285
00:10:59,040 --> 00:11:00,640
of memory corruption

286
00:11:00,640 --> 00:11:03,680
and vulnerability

287
00:11:04,160 --> 00:11:07,279
wifi also has many other functions and

288
00:11:07,279 --> 00:11:10,399
features such as spectrum management

289
00:11:10,399 --> 00:11:13,519
tdls radio measurement fast bss

290
00:11:13,519 --> 00:11:14,240
transition

291
00:11:14,240 --> 00:11:18,079
so on which can be well researched

292
00:11:18,079 --> 00:11:21,120
next i'm going to introduce our owner

293
00:11:21,120 --> 00:11:23,839
ability discovery method a blackbox

294
00:11:23,839 --> 00:11:24,640
protocol

295
00:11:24,640 --> 00:11:28,480
value is based on a hundred 800 2.1

296
00:11:28,480 --> 00:11:31,120
specifications so we can use it to find

297
00:11:31,120 --> 00:11:31,760
wi-fi

298
00:11:31,760 --> 00:11:34,000
model of different manufacturers on

299
00:11:34,000 --> 00:11:35,279
different operating

300
00:11:35,279 --> 00:11:38,560
system this is our first

301
00:11:38,560 --> 00:11:41,279
process in fast mode patch with our

302
00:11:41,279 --> 00:11:42,320
frozen target

303
00:11:42,320 --> 00:11:45,680
such as excel port station p2p then the

304
00:11:45,680 --> 00:11:46,640
fuzzer will

305
00:11:46,640 --> 00:11:50,240
permutate frames with specific special

306
00:11:50,240 --> 00:11:53,440
mutation strategy and send frames to

307
00:11:53,440 --> 00:11:54,560
targeted devices

308
00:11:54,560 --> 00:11:57,839
if tax is a crash we will

309
00:11:57,839 --> 00:12:01,120
try to generate richer plc and analyze

310
00:12:01,120 --> 00:12:03,600
vulnerability

311
00:12:03,600 --> 00:12:06,160
we designed three and five moves

312
00:12:06,160 --> 00:12:06,959
including

313
00:12:06,959 --> 00:12:09,680
access point mode station mode and p2p

314
00:12:09,680 --> 00:12:10,320
mode

315
00:12:10,320 --> 00:12:13,920
in exactly point mode our father is a

316
00:12:13,920 --> 00:12:15,360
thick access point

317
00:12:15,360 --> 00:12:18,639
which interacts with real station device

318
00:12:18,639 --> 00:12:21,839
in station mode our father is a thick

319
00:12:21,839 --> 00:12:25,279
station which interacts with real access

320
00:12:25,279 --> 00:12:26,079
port

321
00:12:26,079 --> 00:12:29,120
in p2p mode our photo is a fake p2p

322
00:12:29,120 --> 00:12:30,959
device which interacts

323
00:12:30,959 --> 00:12:34,399
with real device all these three

324
00:12:34,399 --> 00:12:37,440
modes power pre-machined remote attack

325
00:12:37,440 --> 00:12:39,920
surface

326
00:12:40,079 --> 00:12:43,200
in our opinion the efficiency of fat

327
00:12:43,200 --> 00:12:46,320
is significantly affected by the

328
00:12:46,320 --> 00:12:48,720
quantity of mutation strategy

329
00:12:48,720 --> 00:12:52,079
strategy our mutation strategy is the

330
00:12:52,079 --> 00:12:55,279
primary reason that we can find out

331
00:12:55,279 --> 00:12:58,959
some vulnerabilities to start we tested

332
00:12:58,959 --> 00:13:02,560
a target device just through a laptop

333
00:13:02,560 --> 00:13:04,959
and a wireless network adapter many

334
00:13:04,959 --> 00:13:06,639
vulnerabilities were found

335
00:13:06,639 --> 00:13:08,880
within 10 minutes and the remaining

336
00:13:08,880 --> 00:13:10,880
paths were found within

337
00:13:10,880 --> 00:13:14,079
several hours the

338
00:13:14,079 --> 00:13:17,279
dynamic mutation degree in the left

339
00:13:17,279 --> 00:13:20,560
graph acts three types of mutation

340
00:13:20,560 --> 00:13:21,600
strategies

341
00:13:21,600 --> 00:13:25,120
in the red graph which make our mutation

342
00:13:25,120 --> 00:13:25,839
strategy

343
00:13:25,839 --> 00:13:28,880
more flexible and can be tested both

344
00:13:28,880 --> 00:13:32,000
widely and deeply the same mental

345
00:13:32,000 --> 00:13:34,240
frame mutation we mean measurement

346
00:13:34,240 --> 00:13:35,360
frames absent

347
00:13:35,360 --> 00:13:38,399
in an output or an ordered manner

348
00:13:38,399 --> 00:13:40,880
by saying information element mutation

349
00:13:40,880 --> 00:13:42,160
we mean we will

350
00:13:42,160 --> 00:13:44,480
combine various information elements in

351
00:13:44,480 --> 00:13:45,839
an orderly or

352
00:13:45,839 --> 00:13:48,560
disorderly way to create a malformed

353
00:13:48,560 --> 00:13:49,760
management frame

354
00:13:49,760 --> 00:13:51,600
by saying mutation of information

355
00:13:51,600 --> 00:13:53,040
elemental content

356
00:13:53,040 --> 00:13:55,440
we mean some views or information

357
00:13:55,440 --> 00:13:56,320
elements

358
00:13:56,320 --> 00:13:59,680
are muted and malformed information

359
00:13:59,680 --> 00:14:00,240
element

360
00:14:00,240 --> 00:14:03,760
is generated

361
00:14:03,760 --> 00:14:05,920
now i would like to show you how to

362
00:14:05,920 --> 00:14:07,680
mutate a mutated

363
00:14:07,680 --> 00:14:10,399
management frames during the interaction

364
00:14:10,399 --> 00:14:11,600
with an example

365
00:14:11,600 --> 00:14:13,360
the first method is to send the

366
00:14:13,360 --> 00:14:14,720
measurement frames

367
00:14:14,720 --> 00:14:17,680
according to the normal logic of wifi as

368
00:14:17,680 --> 00:14:18,959
shown in the finger

369
00:14:18,959 --> 00:14:21,760
we can mutate the problem passed on

370
00:14:21,760 --> 00:14:22,399
mutated

371
00:14:22,399 --> 00:14:25,519
probably pass and association factor

372
00:14:25,519 --> 00:14:27,760
in this way following the staging

373
00:14:27,760 --> 00:14:29,279
machine within

374
00:14:29,279 --> 00:14:32,800
the deeper logic can be tested

375
00:14:32,800 --> 00:14:34,959
the second method is to send the

376
00:14:34,959 --> 00:14:36,240
measurement frame

377
00:14:36,240 --> 00:14:38,399
control frame and the data frame

378
00:14:38,399 --> 00:14:39,760
randomly different

379
00:14:39,760 --> 00:14:42,560
combination of management frame and

380
00:14:42,560 --> 00:14:43,360
control

381
00:14:43,360 --> 00:14:48,480
frame may trigger new code pass

382
00:14:48,480 --> 00:14:50,480
next we will talk about information

383
00:14:50,480 --> 00:14:51,600
element mutation

384
00:14:51,600 --> 00:14:54,639
take association requests as an example

385
00:14:54,639 --> 00:14:57,680
as we know frame body is mainly composed

386
00:14:57,680 --> 00:14:59,760
our information elements so we can

387
00:14:59,760 --> 00:15:01,199
mutate the frame

388
00:15:01,199 --> 00:15:03,839
by adding information elements changing

389
00:15:03,839 --> 00:15:05,440
information elements or deleting

390
00:15:05,440 --> 00:15:08,320
information elements

391
00:15:09,279 --> 00:15:12,560
lastly we'll talk about mutation or

392
00:15:12,560 --> 00:15:13,680
information element

393
00:15:13,680 --> 00:15:16,000
content take the as an information

394
00:15:16,000 --> 00:15:17,199
element as an

395
00:15:17,199 --> 00:15:19,360
example we can see that information

396
00:15:19,360 --> 00:15:20,480
element is

397
00:15:20,480 --> 00:15:23,680
composed of our various fields recent

398
00:15:23,680 --> 00:15:27,040
researcher a group cipher or ui

399
00:15:27,040 --> 00:15:29,279
with a random value and don't give

400
00:15:29,279 --> 00:15:30,079
paralyzed

401
00:15:30,079 --> 00:15:33,120
cipher suit tab or random value so this

402
00:15:33,120 --> 00:15:34,240
information element

403
00:15:34,240 --> 00:15:37,600
becomes abnormal now

404
00:15:37,600 --> 00:15:39,519
i will hand it over to my beautiful

405
00:15:39,519 --> 00:15:40,639
partner when

406
00:15:40,639 --> 00:15:42,959
she will go on to introduce and

407
00:15:42,959 --> 00:15:46,560
introduce a following slides

408
00:15:46,639 --> 00:15:49,440
after the free mutation we need to send

409
00:15:49,440 --> 00:15:50,959
them to a target

410
00:15:50,959 --> 00:15:54,720
the ao2.11 particle is at the data link

411
00:15:54,720 --> 00:15:55,440
ledger

412
00:15:55,440 --> 00:15:57,600
we can use the monitor mode of the

413
00:15:57,600 --> 00:16:00,079
awareness network adapter to send the

414
00:16:00,079 --> 00:16:01,519
communication package

415
00:16:01,519 --> 00:16:04,639
at the data link layer the command

416
00:16:04,639 --> 00:16:07,600
on the right graph is to set the network

417
00:16:07,600 --> 00:16:08,480
card to be

418
00:16:08,480 --> 00:16:11,600
monitor mode and the cellular channel we

419
00:16:11,600 --> 00:16:13,759
have tried these three schemes

420
00:16:13,759 --> 00:16:16,480
to send frames each with its own

421
00:16:16,480 --> 00:16:19,199
advantages and disadvantages

422
00:16:19,199 --> 00:16:21,920
the rail link has the advantages of the

423
00:16:21,920 --> 00:16:22,240
no

424
00:16:22,240 --> 00:16:25,199
crisis and the stable performance the

425
00:16:25,199 --> 00:16:26,160
disadvantage

426
00:16:26,160 --> 00:16:29,120
is that the stem stem field can't be set

427
00:16:29,120 --> 00:16:31,440
but it doesn't seem to affect cindy

428
00:16:31,440 --> 00:16:32,399
frames

429
00:16:32,399 --> 00:16:36,399
the ar9271 network

430
00:16:36,399 --> 00:16:39,360
card can ensure the content of the

431
00:16:39,360 --> 00:16:41,199
package is completely

432
00:16:41,199 --> 00:16:44,399
controllable but the monitor mode is not

433
00:16:44,399 --> 00:16:45,360
stable and

434
00:16:45,360 --> 00:16:48,480
it often be stuck the advantage

435
00:16:48,480 --> 00:16:51,680
of sdr is that the sending frame is

436
00:16:51,680 --> 00:16:54,720
fast and the content is controllable and

437
00:16:54,720 --> 00:16:55,759
disadvantage

438
00:16:55,759 --> 00:16:59,759
is that the cost is too high

439
00:17:00,399 --> 00:17:03,279
regardless of the varieties of wi-fi

440
00:17:03,279 --> 00:17:04,000
devices

441
00:17:04,000 --> 00:17:06,160
from different manufacturers and

442
00:17:06,160 --> 00:17:07,119
platform

443
00:17:07,119 --> 00:17:09,439
we can send frames through network

444
00:17:09,439 --> 00:17:10,319
adapter and

445
00:17:10,319 --> 00:17:13,119
files however things goes easier in

446
00:17:13,119 --> 00:17:14,000
linux

447
00:17:14,000 --> 00:17:16,480
we can communicate with wi-fi module

448
00:17:16,480 --> 00:17:17,280
without an

449
00:17:17,280 --> 00:17:19,919
awareness network card by modifying

450
00:17:19,919 --> 00:17:21,039
source code

451
00:17:21,039 --> 00:17:24,319
as shown in the figure firstly we create

452
00:17:24,319 --> 00:17:24,880
a queue

453
00:17:24,880 --> 00:17:28,000
in the kernel then a program in the user

454
00:17:28,000 --> 00:17:28,960
name your keeps

455
00:17:28,960 --> 00:17:32,880
input the mod frames into the queue

456
00:17:32,880 --> 00:17:35,600
whenever the kernel nature receives an

457
00:17:35,600 --> 00:17:37,120
external frames

458
00:17:37,120 --> 00:17:41,600
and will take out a multi-mouth

459
00:17:41,600 --> 00:17:44,720
mouthful frames from the queue

460
00:17:44,720 --> 00:17:47,919
to replace the external frame so the

461
00:17:47,919 --> 00:17:50,400
wi-fi module in kernel will person

462
00:17:50,400 --> 00:17:51,280
multitask

463
00:17:51,280 --> 00:17:54,400
frames like the picture on the right the

464
00:17:54,400 --> 00:17:55,919
advantage of this way

465
00:17:55,919 --> 00:17:58,880
is that it can improve the efficiency of

466
00:17:58,880 --> 00:17:59,679
fasting

467
00:17:59,679 --> 00:18:01,840
and ignore the influence of the

468
00:18:01,840 --> 00:18:05,678
awareness network adapter

469
00:18:06,400 --> 00:18:09,520
if we find a crash and then poc

470
00:18:09,520 --> 00:18:11,440
streaming is completed

471
00:18:11,440 --> 00:18:14,400
it is necessary to analyze the cost of

472
00:18:14,400 --> 00:18:15,840
the vulnerability

473
00:18:15,840 --> 00:18:18,880
through reversing binary file in most

474
00:18:18,880 --> 00:18:19,520
cases

475
00:18:19,520 --> 00:18:22,240
we don't have the driver source code and

476
00:18:22,240 --> 00:18:24,799
can only analyze vulnerability by

477
00:18:24,799 --> 00:18:26,799
reversing binary file

478
00:18:26,799 --> 00:18:29,840
generally speaking the latest drive does

479
00:18:29,840 --> 00:18:30,480
not have

480
00:18:30,480 --> 00:18:33,360
simple information we can only search

481
00:18:33,360 --> 00:18:35,520
for the symbol information of the old

482
00:18:35,520 --> 00:18:37,280
version on internet

483
00:18:37,280 --> 00:18:40,720
which is also very helpful to us also we

484
00:18:40,720 --> 00:18:43,280
can use our idea script to restore the

485
00:18:43,280 --> 00:18:45,360
function names in the branches

486
00:18:45,360 --> 00:18:47,840
because some streams contain function

487
00:18:47,840 --> 00:18:50,640
names or related information finally we

488
00:18:50,640 --> 00:18:51,520
are able to

489
00:18:51,520 --> 00:18:54,400
analyze vulnerabilities by binary symbol

490
00:18:54,400 --> 00:18:55,360
information

491
00:18:55,360 --> 00:18:58,080
and the function stock after system

492
00:18:58,080 --> 00:18:59,840
crash

493
00:18:59,840 --> 00:19:03,120
in half a year we discovered 18 wi-fi

494
00:19:03,120 --> 00:19:05,600
zero-day vulnerabilities like the

495
00:19:05,600 --> 00:19:08,240
pictures

496
00:19:09,120 --> 00:19:11,960
now let's move on to the next session

497
00:19:11,960 --> 00:19:13,360
vulnerabilities

498
00:19:13,360 --> 00:19:15,679
since most of the vulnerabilities we

499
00:19:15,679 --> 00:19:18,320
have discovered are still being fixed

500
00:19:18,320 --> 00:19:21,440
by the manufacturers we can't disclose

501
00:19:21,440 --> 00:19:22,960
details of those

502
00:19:22,960 --> 00:19:25,840
so what i'm going to introduce are the

503
00:19:25,840 --> 00:19:28,640
public known ones

504
00:19:28,640 --> 00:19:31,520
now i will introduce two vulnerabilities

505
00:19:31,520 --> 00:19:32,480
we found

506
00:19:32,480 --> 00:19:35,360
this one is the stock buffer overflow in

507
00:19:35,360 --> 00:19:37,360
the wi-fi driver of usb

508
00:19:37,360 --> 00:19:40,799
awareness network adapter on windows

509
00:19:40,799 --> 00:19:41,840
platform

510
00:19:41,840 --> 00:19:44,480
this vulnerability can be triggered in

511
00:19:44,480 --> 00:19:44,880
ap

512
00:19:44,880 --> 00:19:47,440
and station mode when the windows

513
00:19:47,440 --> 00:19:48,160
platform

514
00:19:48,160 --> 00:19:50,960
opens the mobile hotspots through this

515
00:19:50,960 --> 00:19:52,400
network adapter

516
00:19:52,400 --> 00:19:55,520
or connecting with a fake hotspot

517
00:19:55,520 --> 00:19:59,440
will trigger this vulnerability

518
00:19:59,440 --> 00:20:02,480
these two is are the main causes of the

519
00:20:02,480 --> 00:20:03,840
vulnerability

520
00:20:03,840 --> 00:20:06,320
they present the data rate and the

521
00:20:06,320 --> 00:20:08,000
extended data rate

522
00:20:08,000 --> 00:20:10,960
which is supported by the device the

523
00:20:10,960 --> 00:20:13,280
workshop screenshot

524
00:20:13,280 --> 00:20:16,559
is normal i.e as you can see

525
00:20:16,559 --> 00:20:19,600
it is usually 8 bytes in length and

526
00:20:19,600 --> 00:20:22,400
vulnerability exists in the association

527
00:20:22,400 --> 00:20:23,360
part

528
00:20:23,360 --> 00:20:26,960
regardless of whether it is a request or

529
00:20:26,960 --> 00:20:30,320
response as long as the two malicious

530
00:20:30,320 --> 00:20:32,640
construct ias are carried

531
00:20:32,640 --> 00:20:36,640
the vulnerability can be triggered

532
00:20:38,720 --> 00:20:41,360
pseudo code is used here to show the

533
00:20:41,360 --> 00:20:42,000
logic

534
00:20:42,000 --> 00:20:45,120
of this vulnerability this function is

535
00:20:45,120 --> 00:20:48,320
two pers supported resign in an extended

536
00:20:48,320 --> 00:20:49,919
supported rates ie

537
00:20:49,919 --> 00:20:52,559
and then copy all supported risk to the

538
00:20:52,559 --> 00:20:54,080
global variable

539
00:20:54,080 --> 00:20:56,400
we can see the lens chair can be

540
00:20:56,400 --> 00:20:57,440
bypassed

541
00:20:57,440 --> 00:21:00,000
the first if statement is to determine

542
00:21:00,000 --> 00:21:02,000
whether the length of the supported

543
00:21:02,000 --> 00:21:05,039
rings ie exists 36

544
00:21:05,039 --> 00:21:08,159
if we set it to be 36 it come

545
00:21:08,159 --> 00:21:10,720
bypass the first one and the second one

546
00:21:10,720 --> 00:21:12,080
if conversion

547
00:21:12,080 --> 00:21:15,360
and then we can set extended supported

548
00:21:15,360 --> 00:21:17,840
rings beyond the normal range which

549
00:21:17,840 --> 00:21:21,679
would trigger buffer overflow later

550
00:21:21,679 --> 00:21:31,840
this is the poc demo

551
00:21:54,640 --> 00:21:57,360
the vulnerability exists in the intel

552
00:21:57,360 --> 00:21:59,039
windows wi-fi driver

553
00:21:59,039 --> 00:22:01,600
it is a memory out of band's writer

554
00:22:01,600 --> 00:22:02,960
vulnerability

555
00:22:02,960 --> 00:22:05,679
when the windows system shared a mobile

556
00:22:05,679 --> 00:22:08,640
hotspot through this network adapter

557
00:22:08,640 --> 00:22:10,400
the attacker can trigger the

558
00:22:10,400 --> 00:22:12,080
vulnerability as long as

559
00:22:12,080 --> 00:22:14,960
contacting with it causing the system to

560
00:22:14,960 --> 00:22:17,280
be blue screen

561
00:22:17,280 --> 00:22:19,679
we first discovered this vulnerability

562
00:22:19,679 --> 00:22:21,240
in the thinkpad

563
00:22:21,240 --> 00:22:24,080
x240 loadbook this

564
00:22:24,080 --> 00:22:28,320
notebook uses a wi-fi like 260

565
00:22:28,320 --> 00:22:31,840
awareness network adapter currently

566
00:22:31,840 --> 00:22:34,360
the wi-fi network adapter has been

567
00:22:34,360 --> 00:22:35,679
discontinued

568
00:22:35,679 --> 00:22:40,720
and the thinkpad x240 is also a very old

569
00:22:40,720 --> 00:22:41,679
notebook

570
00:22:41,679 --> 00:22:45,240
so this vulnerability exists at least in

571
00:22:45,240 --> 00:22:46,720
2014.

572
00:22:46,720 --> 00:22:49,679
after testing it was found that this

573
00:22:49,679 --> 00:22:50,240
problem

574
00:22:50,240 --> 00:22:52,960
exists in the corresponding windows

575
00:22:52,960 --> 00:22:55,840
drivers of the above national awareness

576
00:22:55,840 --> 00:22:57,840
network adapter of intel

577
00:22:57,840 --> 00:23:01,159
floating the latest ax

578
00:23:01,159 --> 00:23:04,720
200 chip

579
00:23:05,360 --> 00:23:07,840
the core of this vulnerability as a

580
00:23:07,840 --> 00:23:10,240
supported operational classes

581
00:23:10,240 --> 00:23:13,440
ia this is to declare the

582
00:23:13,440 --> 00:23:16,640
operation class is supported by station

583
00:23:16,640 --> 00:23:21,200
the structure is not complicated

584
00:23:21,200 --> 00:23:24,240
one byte in the information re

585
00:23:24,240 --> 00:23:27,679
represent a clause use code to identify

586
00:23:27,679 --> 00:23:29,600
this vulnerability logic

587
00:23:29,600 --> 00:23:31,919
from the name of the function we can

588
00:23:31,919 --> 00:23:34,480
know that the function is to process the

589
00:23:34,480 --> 00:23:36,080
challenged supported

590
00:23:36,080 --> 00:23:38,880
by the association frames in this

591
00:23:38,880 --> 00:23:39,679
function

592
00:23:39,679 --> 00:23:42,960
the function of uto regulate

593
00:23:42,960 --> 00:23:46,159
clause 2 channel list is called the

594
00:23:46,159 --> 00:23:51,679
circle the function writes 500

595
00:23:51,679 --> 00:23:54,720
bytes to the blocks of memory

596
00:23:54,720 --> 00:23:57,840
each time and accumulated the memory

597
00:23:57,840 --> 00:23:58,720
address

598
00:23:58,720 --> 00:24:01,440
when the number of a course is too many

599
00:24:01,440 --> 00:24:02,159
it would

600
00:24:02,159 --> 00:24:05,360
cause the memory to write out bands

601
00:24:05,360 --> 00:24:07,520
the number of times of this loop is

602
00:24:07,520 --> 00:24:09,760
determined by the lens field of the

603
00:24:09,760 --> 00:24:10,640
supported

604
00:24:10,640 --> 00:24:13,600
operation classes information element

605
00:24:13,600 --> 00:24:14,400
that is

606
00:24:14,400 --> 00:24:18,159
they can be up to 255 times

607
00:24:18,159 --> 00:24:20,799
this is obviously low check on the lens

608
00:24:20,799 --> 00:24:21,279
field

609
00:24:21,279 --> 00:24:27,039
pass in front user this is the poc

610
00:24:30,840 --> 00:24:33,840
demo

611
00:25:24,159 --> 00:25:27,760
now to conclude our presentation

612
00:25:27,760 --> 00:25:30,640
user above mentioned vulnerability will

613
00:25:30,640 --> 00:25:31,760
attack

614
00:25:31,760 --> 00:25:34,480
pretend to be a mobile phone or a

615
00:25:34,480 --> 00:25:35,200
computer

616
00:25:35,200 --> 00:25:38,640
and initiates a con connection request

617
00:25:38,640 --> 00:25:42,080
to a hotspot the panels sent will cause

618
00:25:42,080 --> 00:25:44,320
the security

619
00:25:44,320 --> 00:25:48,480
damage to the kernel resulting the

620
00:25:48,480 --> 00:25:51,520
delight of survive of the pc operating

621
00:25:51,520 --> 00:25:52,400
system

622
00:25:52,400 --> 00:25:55,279
nowadays personal computer mobile phone

623
00:25:55,279 --> 00:25:55,600
and

624
00:25:55,600 --> 00:25:58,559
more and more iot devices supported

625
00:25:58,559 --> 00:25:59,279
awareness

626
00:25:59,279 --> 00:26:02,320
network communication and the security

627
00:26:02,320 --> 00:26:04,559
of their underlying communication

628
00:26:04,559 --> 00:26:05,600
practical is

629
00:26:05,600 --> 00:26:08,640
extremely important and the security

630
00:26:08,640 --> 00:26:11,039
research on this practical has

631
00:26:11,039 --> 00:26:14,880
important venue most of vulnerability we

632
00:26:14,880 --> 00:26:15,279
found

633
00:26:15,279 --> 00:26:18,720
were in the network assess stage in fact

634
00:26:18,720 --> 00:26:21,120
there is still a lot of research

635
00:26:21,120 --> 00:26:24,559
filled in the authorization stage

636
00:26:24,559 --> 00:26:28,320
and other functions okay thanks again

637
00:26:28,320 --> 00:26:29,240
for

638
00:26:29,240 --> 00:26:32,480
participating i hope our sharing today

639
00:26:32,480 --> 00:26:36,799
is helpful to you guys

