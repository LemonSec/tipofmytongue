1
00:00:00,099 --> 00:00:04,360
welcome everyone thanks for being your
um I hope

2
00:00:04,360 --> 00:00:07,950
I hope I can take you to a nicer into a
nice to were

3
00:00:07,950 --> 00:00:12,099
today for this talk around her scanning
the internet and can def doing

4
00:00:12,099 --> 00:00:15,240
like large-scale wide-scale into a wider

5
00:00:15,240 --> 00:00:18,779
projects research and collecting data
and hopefully

6
00:00:18,779 --> 00:00:23,410
we can engage in some some discussions
and and see like what your thoughts on

7
00:00:23,410 --> 00:00:24,410
this are and maybe

8
00:00:24,410 --> 00:00:28,160
are discussed this you know and and and
lots of different ways maybe you have

9
00:00:28,160 --> 00:00:29,529
ideas that we didn't have

10
00:00:29,529 --> 00:00:33,430
and yeah it I R and hope it will be
challenging and

11
00:00:33,430 --> 00:00:37,570
maybe some %uh viewer can take away I
don't know the next research project

12
00:00:37,570 --> 00:00:38,040
from this

13
00:00:38,040 --> 00:00:42,469
so quickly on I mean this in turn its a
scan all the things the presentations

14
00:00:42,469 --> 00:00:43,860
about a project that we're doing

15
00:00:43,860 --> 00:00:47,539
as rapid seven officially what's called
projects on our going to go into that

16
00:00:47,539 --> 00:00:48,219
later on

17
00:00:48,219 --> 00:00:51,870
but its M yeah it's the whole the whole
theme is

18
00:00:51,870 --> 00:00:56,149
on doing internet scanning and not only
like for a pen to scan your local

19
00:00:56,149 --> 00:00:57,730
network but doing it in turn white

20
00:00:57,730 --> 00:01:00,859
so quickly before we start on so my
name's mark

21
00:01:00,859 --> 00:01:05,260
are you can find me on Twitter and so on
and I do our security researcher at

22
00:01:05,260 --> 00:01:07,340
rapid7 laps now lapses a

23
00:01:07,340 --> 00:01:11,310
small team actually where three people
right now and them

24
00:01:11,310 --> 00:01:14,470
yeah %uh it's it's headed by HT more

25
00:01:14,470 --> 00:01:19,070
%uh the founder of Metasploit and we're
doing lots of different research topics

26
00:01:19,070 --> 00:01:20,720
and free tools for our

27
00:01:20,720 --> 00:01:23,740
web sites in another amongst other
things

28
00:01:23,740 --> 00:01:28,759
on some other aspects you might maybe
know me from or or maybe a

29
00:01:28,759 --> 00:01:32,560
you heard of this them I'm also a member
of nineteen a project which is doing

30
00:01:32,560 --> 00:01:34,250
lots of research and Jim

31
00:01:34,250 --> 00:01:38,100
you know in towards malware and botnet
send trying to educate people on

32
00:01:38,100 --> 00:01:43,280
in those a subject's on maybe some of
you have used Google Sandbox before

33
00:01:43,280 --> 00:01:47,600
or maybe you have even been last year at
the black at US said our workshop

34
00:01:47,600 --> 00:01:50,820
on which is a open source malware
analysis up

35
00:01:50,820 --> 00:01:54,820
to land framework and that's also am
what I am Boston so if

36
00:01:54,820 --> 00:01:58,100
if anyone is interested in those topics
which are related to the talk here

37
00:01:58,100 --> 00:02:01,649
arm yet hit me up afterwards and we can
we can have some awesome discussions

38
00:02:01,649 --> 00:02:02,570
about that stuff as well

39
00:02:02,570 --> 00:02:06,070
um in the past I've and like researching
a little bit

40
00:02:06,070 --> 00:02:09,709
into botnets a malware and trying to
like figure out how

41
00:02:09,709 --> 00:02:12,770
the bigger but not families work to peer
to peer But Nets maybe

42
00:02:12,770 --> 00:02:17,330
you know do something again said um how
can we may be essentially fix something

43
00:02:17,330 --> 00:02:22,150
you know off of this an in for two
prevent this whole malware flood that we

44
00:02:22,150 --> 00:02:25,069
typically look at I'm some other side
projects

45
00:02:25,069 --> 00:02:28,060
doesn't matter too much but you know if
your interest in any of that make sure

46
00:02:28,060 --> 00:02:28,620
to

47
00:02:28,620 --> 00:02:32,620
to hit me up so I'm going to take you a
little bit

48
00:02:32,620 --> 00:02:35,900
on a small tour of what the history of
of this

49
00:02:35,900 --> 00:02:39,459
internet scanning looks like and what
people have done in the past

50
00:02:39,459 --> 00:02:42,610
I mean we're not the only ones of course
doing this nowadays there are lots of

51
00:02:42,610 --> 00:02:43,970
people doing this kind of stuff

52
00:02:43,970 --> 00:02:48,110
on but I think we have a a little bit of
a unique approach

53
00:02:48,110 --> 00:02:51,390
arm and so yeah I think it's important

54
00:02:51,390 --> 00:02:54,599
I'm to cover some of the basics of the
messages that I want to you

55
00:02:54,599 --> 00:02:58,620
I want to put out today I will introduce
you to the project that we're doing

56
00:02:58,620 --> 00:03:03,550
arm little bit going to the challenge us
that you can face with this kind of work

57
00:03:03,550 --> 00:03:07,170
and hopefully we can come to some
awesome conclusions and afterwards

58
00:03:07,170 --> 00:03:08,120
everyone %uh view

59
00:03:08,120 --> 00:03:11,629
all join me for beers later on or
something and and ask

60
00:03:11,629 --> 00:03:15,069
you know and and we can work on the next
project together alright so we're

61
00:03:15,069 --> 00:03:17,250
talking about large-scale scanning
internet wide

62
00:03:17,250 --> 00:03:20,860
a resurgent NY data gathering so hitting

63
00:03:20,860 --> 00:03:24,360
every IP address out there hitting the
complete the

64
00:03:24,360 --> 00:03:28,269
you know every public IP address and to
getting some date out of it

65
00:03:28,269 --> 00:03:32,080
now arm Justin a little bit history
about that

66
00:03:32,080 --> 00:03:35,080
so people have done this arm very early

67
00:03:35,080 --> 00:03:38,140
actually I'm I think one of the first
projects

68
00:03:38,140 --> 00:03:42,290
on 898 at Bell Labs said they started
this internet mapping project

69
00:03:42,290 --> 00:03:47,200
they essentially did up im ICMP echo
request to all a piece on the Internet

70
00:03:47,200 --> 00:03:50,340
and just that that's continuously like I
don't know even like

71
00:03:50,340 --> 00:03:54,629
probably every month or so maybe it may
be more often to just see how the user

72
00:03:54,629 --> 00:03:55,010
each

73
00:03:55,010 --> 00:03:58,700
of ipv4 addresses continues over time
and how it goes

74
00:03:58,700 --> 00:04:03,489
now that's of course very limited in
scope and there are other projects some

75
00:04:03,489 --> 00:04:06,950
the ipv4 census did a similar thing I
simply a causal

76
00:04:06,950 --> 00:04:12,650
a again than one of the maybe first like
actual data collection projects internet

77
00:04:12,650 --> 00:04:13,150
wired

78
00:04:13,150 --> 00:04:16,780
on maybe not one of the first time in
this is a non extensive list i mean

79
00:04:16,780 --> 00:04:18,540
there are probably some that I miss

80
00:04:18,540 --> 00:04:22,019
don't be mad at me these are I think
them the major ones that I

81
00:04:22,019 --> 00:04:25,330
you note the present some milestones in
this kind of stuff so the

82
00:04:25,330 --> 00:04:29,330
if ever loved as a celeb serve a Tory
and try to go out and grab

83
00:04:29,330 --> 00:04:32,370
every certificate out there on the HD

84
00:04:32,370 --> 00:04:36,270
HTTPS arm so secure web and servers

85
00:04:36,270 --> 00:04:39,960
and look into how this looks like like
what is the landscape what typically

86
00:04:39,960 --> 00:04:42,990
what CA's to be /c sign those
certificates

87
00:04:42,990 --> 00:04:46,490
what do people use in key sizes you know
what what what does it look like

88
00:04:46,490 --> 00:04:49,600
like what happened what things can be
fine can we find some issues and they

89
00:04:49,600 --> 00:04:51,430
published information about

90
00:04:51,430 --> 00:04:55,190
you know several different foster were
kinda scary or kinda interesting at the

91
00:04:55,190 --> 00:04:56,169
time I mean

92
00:04:56,169 --> 00:05:00,229
there are hundreds of certificate
authorities in our browsers nowadays

93
00:05:00,229 --> 00:05:03,509
that never it you know signed a single
certificate that we saw on the public

94
00:05:03,509 --> 00:05:04,750
Internet so

95
00:05:04,750 --> 00:05:08,470
there was already a discussion like what
are the CA's doing that what are they

96
00:05:08,470 --> 00:05:11,240
therefore and why do we have to have
them in our browsers

97
00:05:11,240 --> 00:05:15,850
on there were of course likes to weeki
sizes we keys in general

98
00:05:15,850 --> 00:05:19,500
I'm you know the Debian bug probably you
remember where you had week

99
00:05:19,500 --> 00:05:23,120
generators lots of certificates are
still out there on the internet use for

100
00:05:23,120 --> 00:05:26,560
web service which have weak keys that
you can easily factor

101
00:05:26,560 --> 00:05:29,500
they have been embedded devices that
have we keys I mean there's lots of

102
00:05:29,500 --> 00:05:30,270
different things

103
00:05:30,270 --> 00:05:33,470
and that came out of this project and it
it was

104
00:05:33,470 --> 00:05:36,699
at the time I think it was regarded by
most researchers as

105
00:05:36,699 --> 00:05:40,030
hugely valuable because it provides
insight into something

106
00:05:40,030 --> 00:05:43,820
for the community on where you where we
just need to be aware that their issues

107
00:05:43,820 --> 00:05:46,009
out there miss miss configurations out
there

108
00:05:46,009 --> 00:05:49,030
that we need to address and be careful
about when we deploy new systems at

109
00:05:49,030 --> 00:05:51,889
least because you probably won't be able
to fix the old systems

110
00:05:51,889 --> 00:05:56,580
all rights are continuing one of the
more recent in 2012

111
00:05:56,580 --> 00:06:00,139
on more recent I think actually the time
is run

112
00:06:00,139 --> 00:06:04,360
I'll the SS sorry the FF observatory was
in 2010

113
00:06:04,360 --> 00:06:07,960
and not in 14 sorry the sides from here
on

114
00:06:07,960 --> 00:06:11,400
so in in 2012 an interesting thing
happened to so

115
00:06:11,400 --> 00:06:14,620
typically like classically people deem
this internet whites

116
00:06:14,620 --> 00:06:17,870
data gathering as somewhat infeasible
because its

117
00:06:17,870 --> 00:06:21,449
a high cost you know if you wanna do
especially if you wanna do large

118
00:06:21,449 --> 00:06:24,960
amount of data collection so you wanna
do maybe more than SSL Certificates you

119
00:06:24,960 --> 00:06:25,889
wanna hit

120
00:06:25,889 --> 00:06:29,220
more ports grab more data and so on they
deemed it to be

121
00:06:29,220 --> 00:06:33,620
unfeasible because too high cost for an
individual project you know maybe some

122
00:06:33,620 --> 00:06:35,810
huge corporation can do it but none

123
00:06:35,810 --> 00:06:38,850
you know none none of the individual
researchers could do the stuff

124
00:06:38,850 --> 00:06:42,229
so some anonymous individuals some you
know one arm

125
00:06:42,229 --> 00:06:45,690
or or several they conducted an Internet
whites

126
00:06:45,690 --> 00:06:49,539
Kenneth study and the scandal of ports
and they collected

127
00:06:49,539 --> 00:06:53,699
lots and lots of data and by using
essentially a botnet

128
00:06:53,699 --> 00:06:56,960
on of infected mostly embedded devices

129
00:06:56,960 --> 00:07:00,949
so they I think the number was around
400,000 devices

130
00:07:00,949 --> 00:07:04,569
that they managed to log into with some
kind of default password or

131
00:07:04,569 --> 00:07:08,099
our guest password so they said she did
like a dictionary attack averted

132
00:07:08,099 --> 00:07:13,470
very limited one they manage to infected
take over 400,000 devices across the

133
00:07:13,470 --> 00:07:13,960
internet

134
00:07:13,960 --> 00:07:17,229
and the use those on in a very that's a

135
00:07:17,229 --> 00:07:20,370
careful almost academic approach

136
00:07:20,370 --> 00:07:24,110
to conduct this internet senses of the
of the internet and they made sure that

137
00:07:24,110 --> 00:07:26,729
the devices weren't overloaded and they
were really careful

138
00:07:26,729 --> 00:07:29,400
but of course this is like highly
illegal right i mean this is not

139
00:07:29,400 --> 00:07:30,330
something that

140
00:07:30,330 --> 00:07:33,389
anyone should do or I mean it's it's a

141
00:07:33,389 --> 00:07:36,530
it's a very controversial topic because
in the end they published all the

142
00:07:36,530 --> 00:07:37,960
results the whole dataset

143
00:07:37,960 --> 00:07:42,000
uncompressed 9 terabytes of data they
publish that as a torrent and everybody

144
00:07:42,000 --> 00:07:42,669
could download it

145
00:07:42,669 --> 00:07:46,240
and lots of people dead and the worse
there's a crazy amount like

146
00:07:46,240 --> 00:07:49,550
of of research projects and findings up
this Anna

147
00:07:49,550 --> 00:07:53,120
has proven to be somewhat valuable to
the to the community into the security

148
00:07:53,120 --> 00:07:54,050
industry

149
00:07:54,050 --> 00:07:57,310
and still it's of course they're like
the collection is illegal in the way

150
00:07:57,310 --> 00:07:58,379
that they conducted

151
00:07:58,379 --> 00:08:01,430
now love you also know showdown probably

152
00:08:01,430 --> 00:08:04,539
and showed and does internet scanning
for quite a while now and they

153
00:08:04,539 --> 00:08:08,660
index actually %uh the data that they
get so you can search it you can just

154
00:08:08,660 --> 00:08:11,180
search for certain device and you will
find like all the

155
00:08:11,180 --> 00:08:14,789
devices that are out there now this is
is very

156
00:08:14,789 --> 00:08:18,210
good as well because it's continuously
done so they

157
00:08:18,210 --> 00:08:21,319
the those guys they do it I don't know
actually what the what the

158
00:08:21,319 --> 00:08:25,050
kinda interpol this but they do is
continuously and they make it public

159
00:08:25,050 --> 00:08:27,979
I mean to a certain extent like if you
want to do a lot of queries you need to

160
00:08:27,979 --> 00:08:29,660
be a customer something but

161
00:08:29,660 --> 00:08:32,909
essentially you can you can go to the
website and use it so

162
00:08:32,909 --> 00:08:37,469
um yet we've seen we've seen several
uses and probably love you have used

163
00:08:37,469 --> 00:08:39,599
showdown in the past like for your

164
00:08:39,599 --> 00:08:43,080
job surfer some research on their
different

165
00:08:43,080 --> 00:08:46,580
their different kind of projects that
are not necessarily gathering data but

166
00:08:46,580 --> 00:08:48,820
at their use for measurements there's
the right

167
00:08:48,820 --> 00:08:53,830
Atlas which has over 6,000 knows spread
around the world which people just host

168
00:08:53,830 --> 00:08:54,170
so

169
00:08:54,170 --> 00:08:57,399
essentially right goes out gives the
small devices to people and they just

170
00:08:57,399 --> 00:08:59,330
plug it in at home and then it's used
for

171
00:08:59,330 --> 00:09:02,370
are distributed mastering of of you know

172
00:09:02,370 --> 00:09:06,480
round trip times and so on so critical I
O now which is essentially where

173
00:09:06,480 --> 00:09:10,149
now the interesting stuff starts I'm for
me because this was done by my boss

174
00:09:10,149 --> 00:09:14,940
so HD Moore and he did this in 2012 and
2013

175
00:09:14,940 --> 00:09:18,930
more but more as a proof of concept so
he sensually you wanted to do

176
00:09:18,930 --> 00:09:23,350
something are similar what the internet
census guy state those those but not

177
00:09:23,350 --> 00:09:24,140
using guys

178
00:09:24,140 --> 00:09:27,430
he wanted to do a project on the with
the legal

179
00:09:27,430 --> 00:09:31,420
you know the collection method so easy
he got a bunch of servers himself he

180
00:09:31,420 --> 00:09:32,339
paid for it

181
00:09:32,339 --> 00:09:36,260
and he added internet white scanning on
several different protocols

182
00:09:36,260 --> 00:09:40,980
and he did it using and map so on she
just wanted to see like what is the cost

183
00:09:40,980 --> 00:09:41,589
involved

184
00:09:41,589 --> 00:09:44,600
how fast can you do this and what stuff
do you find

185
00:09:44,600 --> 00:09:48,019
and just do it right and and sent the
data that's important

186
00:09:48,019 --> 00:09:51,550
send it out to researchers so he
actually distributed anyone who asked

187
00:09:51,550 --> 00:09:52,990
you know you could just get the data

188
00:09:52,990 --> 00:09:56,790
and then make to some research on it
maybe you find some stuff now

189
00:09:56,790 --> 00:09:59,850
this was really a great outcome like
both for him and also

190
00:09:59,850 --> 00:10:03,980
all also indirectly for rapid seven
because we out of this dataset

191
00:10:03,980 --> 00:10:07,149
we found so many interesting things and
we

192
00:10:07,149 --> 00:10:11,260
did some yep publications on top of that
so there was a UPnP white paper

193
00:10:11,260 --> 00:10:14,589
which probably a lot of you have heard
of on last year I believe

194
00:10:14,589 --> 00:10:17,880
for beginning of 2013 I'm came out sware

195
00:10:17,880 --> 00:10:20,810
we discussed widespread phone but is
actually I'm covering this and next

196
00:10:20,810 --> 00:10:21,680
slide

197
00:10:21,680 --> 00:10:25,130
and several other ones which I'm going
to cover so yeah

198
00:10:25,130 --> 00:10:28,890
a quick excursion in the most into the
most popular service on the Internet

199
00:10:28,890 --> 00:10:32,490
so who would assume probably similar to
what we had

200
00:10:32,490 --> 00:10:35,860
thought on that this is HD pizza
webservice

201
00:10:35,860 --> 00:10:38,899
or web servers in a web sites on

202
00:10:38,899 --> 00:10:42,040
probably a lot of lot of people would
think that is most popular thing

203
00:10:42,040 --> 00:10:47,010
turns out that the most widespread
protocol and service you find on the

204
00:10:47,010 --> 00:10:48,899
internet is actually UPnP

205
00:10:48,899 --> 00:10:52,240
which is your Universal Plug & Play on

206
00:10:52,240 --> 00:10:56,149
so it's a set of network protocols their
use by devices to discover each other

207
00:10:56,149 --> 00:10:59,870
and configured other in a certain sense
so you would find printers or

208
00:10:59,870 --> 00:11:03,880
other devices automatically on your on
networks is mostly used by consumer

209
00:11:03,880 --> 00:11:07,140
devices but it can also found be found
in Lake servers or

210
00:11:07,140 --> 00:11:11,410
switches and so on now as we found so
many devices

211
00:11:11,410 --> 00:11:16,310
arm he so HD and a bunch of others they
started investigating those devices

212
00:11:16,310 --> 00:11:20,750
and when you look at différents types
of devices and what kinda software

213
00:11:20,750 --> 00:11:21,800
stacks the use

214
00:11:21,800 --> 00:11:25,440
it turns out that pretty much the
majority of those

215
00:11:25,440 --> 00:11:29,630
on UPnP sir server or implementations
protocol so to speak

216
00:11:29,630 --> 00:11:33,899
are done or I the they are gotten from
three

217
00:11:33,899 --> 00:11:37,820
different major software stacks so all
those devices doesn't matter whether its

218
00:11:37,820 --> 00:11:40,990
links is heard this router Netgear
whatever day license

219
00:11:40,990 --> 00:11:44,279
on one of three major suffer stacks

220
00:11:44,279 --> 00:11:49,399
and those are Broadcom many UPnP and
into lulled into a portable STK

221
00:11:49,399 --> 00:11:53,760
so um and yeah I mean what can you
expect them you you take this protocol

222
00:11:53,760 --> 00:11:57,459
on Nov not a lot of people probably look
at this and you find in every single one

223
00:11:57,459 --> 00:12:00,339
of them you find remotely exploitable
bucks

224
00:12:00,339 --> 00:12:04,300
remotely exploitable vulnerabilities so
on this means essentially out of

225
00:12:04,300 --> 00:12:07,670
millions and millions like 20 million or
so devices on the internet that have

226
00:12:07,670 --> 00:12:10,040
this open probably more even I think
they were

227
00:12:10,040 --> 00:12:13,300
and a No I don't know how many there
were probably 100 million or so devices

228
00:12:13,300 --> 00:12:14,300
across internet

229
00:12:14,300 --> 00:12:18,410
you can just exploits millions of
devices using Metasploit

230
00:12:18,410 --> 00:12:22,300
on you know using an open open public
published exploit

231
00:12:22,300 --> 00:12:25,310
so this is this was really a kind of a
major

232
00:12:25,310 --> 00:12:29,310
flaw that people found in and its still
widespread I mean is still out there

233
00:12:29,310 --> 00:12:32,649
still on on the internet so

234
00:12:32,649 --> 00:12:36,180
this was really for us the the time
where we thought okay this is this is

235
00:12:36,180 --> 00:12:39,100
really important like we we found this

236
00:12:39,100 --> 00:12:42,910
protocol we looked at it apparently lot
of people didn't look at it before

237
00:12:42,910 --> 00:12:45,970
and we find lots and lots of fun
abilities most of them pretty easy to

238
00:12:45,970 --> 00:12:46,540
discover

239
00:12:46,540 --> 00:12:50,320
so it's very critical because these
devices are interconnected you could

240
00:12:50,320 --> 00:12:54,029
like immediately take them over at so we
needed to

241
00:12:54,029 --> 00:12:57,700
raise awareness so we published a white
paper we you know hit some news sites

242
00:12:57,700 --> 00:13:01,790
on try to spread the word and lots of
people knew now okay there's something

243
00:13:01,790 --> 00:13:02,579
weird going on

244
00:13:02,579 --> 00:13:06,120
with my router and I either some ice
peace try to make the situation better

245
00:13:06,120 --> 00:13:09,279
and Exchange devices of course that's
very costly

246
00:13:09,279 --> 00:13:13,170
some people they updated the firmware
and so on so we try to i mean you know

247
00:13:13,170 --> 00:13:16,570
people try to make the situation better
so on

248
00:13:16,570 --> 00:13:20,959
yeah hopefully this reduces the tax
office now now gets interesting because

249
00:13:20,959 --> 00:13:24,350
at thats time we thought okay what else
what else can we find out what

250
00:13:24,350 --> 00:13:28,450
I know if weird devices or
misconfiguration sewer problems can be

251
00:13:28,450 --> 00:13:31,920
fine on the internet if you look at this
kind of data set an internet y dataset

252
00:13:31,920 --> 00:13:35,380
which brings me to this picture so this
picture on

253
00:13:35,380 --> 00:13:38,649
was selected by colleague of mine by
Claudio and I think it's

254
00:13:38,649 --> 00:13:43,459
really accurately represents the year
landscape of devices and things that you

255
00:13:43,459 --> 00:13:44,079
find out there

256
00:13:44,079 --> 00:13:48,589
because the Internet is a plea is a
weird place right you find so many

257
00:13:48,589 --> 00:13:51,769
weird things both and videos and means
and pictures

258
00:13:51,769 --> 00:13:54,880
as you find in devices and
configurations

259
00:13:54,880 --> 00:14:00,490
so on yeah I mean of course you can look
at web servers switches probably boring

260
00:14:00,490 --> 00:14:04,350
are compared to the picture I mean the
picture you know speaks of weird

261
00:14:04,350 --> 00:14:06,110
configurations it's a few web service

262
00:14:06,110 --> 00:14:10,560
not really weird so but I mean out of
internet white studies you can you can

263
00:14:10,560 --> 00:14:13,399
get some interesting get out of this as
well right this is this a somewhat

264
00:14:13,399 --> 00:14:15,199
boring but I'm just gonna cover it

265
00:14:15,199 --> 00:14:19,880
so if you look at for example unlike the
distribution of web servers across the

266
00:14:19,880 --> 00:14:21,550
internet you find that a lot of

267
00:14:21,550 --> 00:14:25,320
or actually most of I asses and apaches
and so on

268
00:14:25,320 --> 00:14:28,910
they don't run the latest version on
somewhat expected I guess but

269
00:14:28,910 --> 00:14:32,410
I'm still if you think about it probably

270
00:14:32,410 --> 00:14:36,110
most of them don't run the latest
version but then again also

271
00:14:36,110 --> 00:14:39,190
a lot of them will have not the latest
security patches

272
00:14:39,190 --> 00:14:43,589
sigh mean you can you can just look at
the Internet and CE

273
00:14:43,589 --> 00:14:46,790
what typically people do with their web
service do they care about security

274
00:14:46,790 --> 00:14:47,570
updates on

275
00:14:47,570 --> 00:14:50,839
they care and and so on so I mean this
is just

276
00:14:50,839 --> 00:14:53,740
this is what you typically look at when
you look into the state sets right you

277
00:14:53,740 --> 00:14:54,940
can you can

278
00:14:54,940 --> 00:14:58,230
aggregates two counts of different
versions and so on

279
00:14:58,230 --> 00:15:01,470
now becomes more interesting when you
look at other protocol types and I think

280
00:15:01,470 --> 00:15:02,720
as an MP's probe the

281
00:15:02,720 --> 00:15:05,870
something you guys have are use before
or

282
00:15:05,870 --> 00:15:09,529
you know heard it before so the simple
network management protocol

283
00:15:09,529 --> 00:15:13,199
its Houston a home routers but also
printers modems which is and love and a

284
00:15:13,199 --> 00:15:13,740
price

285
00:15:13,740 --> 00:15:17,350
a devices like appliances and so on and
its use for

286
00:15:17,350 --> 00:15:20,630
both getting information about the
device and discovering it but also for

287
00:15:20,630 --> 00:15:22,820
managing it and in most cases so

288
00:15:22,820 --> 00:15:25,560
you can see like the routes and
addresses and listening ports on the

289
00:15:25,560 --> 00:15:27,290
device may be some

290
00:15:27,290 --> 00:15:30,620
in a running process is it always
depends on the actual device and the

291
00:15:30,620 --> 00:15:32,220
actual saw first accused

292
00:15:32,220 --> 00:15:36,639
but it goes as far as that you can see
patches that are applied to the device

293
00:15:36,639 --> 00:15:39,300
you can see accounts in group names and
so on

294
00:15:39,300 --> 00:15:42,660
aunt the problem like the problem with
this iz up sorry

295
00:15:42,660 --> 00:15:45,779
are I thought I had another site here so
the problem with this is

296
00:15:45,779 --> 00:15:50,750
as an MP on they have by default they
have configurations where you have in

297
00:15:50,750 --> 00:15:51,380
most cases

298
00:15:51,380 --> 00:15:55,279
a public read only kinda arm login or

299
00:15:55,279 --> 00:15:58,540
Mohanty call it like a credential and
then there's a read/write

300
00:15:58,540 --> 00:16:01,910
a private credential and in lot of cases

301
00:16:01,910 --> 00:16:05,820
either the pup so that our devices that
both with the

302
00:16:05,820 --> 00:16:09,910
so-called public credential allow you to
write or configure device

303
00:16:09,910 --> 00:16:13,490
and also there are private ones which
have you know the standard default

304
00:16:13,490 --> 00:16:14,350
setting and your

305
00:16:14,350 --> 00:16:18,220
so it's it's it's essentially like a
default password so what can you find on

306
00:16:18,220 --> 00:16:19,040
this if you look at

307
00:16:19,040 --> 00:16:22,079
actually some devices and you do just a
list processors

308
00:16:22,079 --> 00:16:25,630
arm you know you this the processes on
this as an MP service

309
00:16:25,630 --> 00:16:29,339
and you can find actually the arguments
that are given to processes running on

310
00:16:29,339 --> 00:16:29,810
that

311
00:16:29,810 --> 00:16:33,079
you know particular device which the
issue then

312
00:16:33,079 --> 00:16:36,350
immediately without any exploitation any

313
00:16:36,350 --> 00:16:40,500
you know hacking whatsoever it justly to
directly to credentials so sometimes you

314
00:16:40,500 --> 00:16:41,320
will find you know

315
00:16:41,320 --> 00:16:45,259
user names passwords will find your else
ID's I mean

316
00:16:45,259 --> 00:16:49,860
it just is there's up the Thor a hearty
college a

317
00:16:49,860 --> 00:16:53,029
so great variety of these devices out
there am

318
00:16:53,029 --> 00:16:56,290
you don't even know where to start
looking in into it and you don't even

319
00:16:56,290 --> 00:16:57,089
know

320
00:16:57,089 --> 00:17:01,740
okay maybe may be here the password
master key 2011 maybe now I can use this

321
00:17:01,740 --> 00:17:03,050
to authenticate to the Vice

322
00:17:03,050 --> 00:17:08,039
but maybe it's also just the adenauer
some internal configuration string and

323
00:17:08,039 --> 00:17:08,579
it's not

324
00:17:08,579 --> 00:17:11,870
remotely accessible so it's not a
security vulnerability right I mean so

325
00:17:11,870 --> 00:17:15,400
the the point is you see this it
typically think oh my god there's

326
00:17:15,400 --> 00:17:16,699
something weird going on

327
00:17:16,699 --> 00:17:19,959
but in each individual case you would
have to look at the device the

328
00:17:19,959 --> 00:17:21,059
sufferance onto

329
00:17:21,059 --> 00:17:24,760
to determine whether it's actually a
problem now this continues as a

330
00:17:24,760 --> 00:17:27,280
as we go through the slides because
there's like story behind everything

331
00:17:27,280 --> 00:17:28,020
here

332
00:17:28,020 --> 00:17:31,919
on as I mentioned the author get an
authentication the earlier

333
00:17:31,919 --> 00:17:35,520
S&P version switcher I think very widely
deployed still

334
00:17:35,520 --> 00:17:39,669
are based on this community string so
you have the public read-only and

335
00:17:39,669 --> 00:17:42,780
private read write string on a lot of
devices now these can be reconfigured

336
00:17:42,780 --> 00:17:43,780
and actually

337
00:17:43,780 --> 00:17:47,750
a recommended to reconfigure does but
just i mean as it is with Rogers

338
00:17:47,750 --> 00:17:51,340
an not many people changed it default
settings right

339
00:17:51,340 --> 00:17:54,340
so I'm some people a some devices
actually allow rights

340
00:17:54,340 --> 00:17:58,360
access with the public identification so
what about

341
00:17:58,360 --> 00:18:01,910
reconfiguring functionality across
eleven million devices across the

342
00:18:01,910 --> 00:18:05,910
internet just reconfigure routes are
reconfigured the passwords or whatever

343
00:18:05,910 --> 00:18:09,770
right and thousands of Rodgers threw
this can be instantly compromise I mean

344
00:18:09,770 --> 00:18:11,490
it's similar to UPnP it's just

345
00:18:11,490 --> 00:18:14,590
it's just everything out there on

346
00:18:14,590 --> 00:18:18,640
like work with in everything out there
there are thousands and thousands of

347
00:18:18,640 --> 00:18:19,470
devices which are

348
00:18:19,470 --> 00:18:22,570
immediately vulnerable to something so
it's not even

349
00:18:22,570 --> 00:18:26,289
it's not sometimes it's not even about
really hacking or like

350
00:18:26,289 --> 00:18:29,580
I dunno analyzing a device it's in most
cases just logging in

351
00:18:29,580 --> 00:18:33,270
or just connecting to it actually right
on want one more

352
00:18:33,270 --> 00:18:36,210
lakes mall comment I need to be a little
bit quick cash if too many slides into

353
00:18:36,210 --> 00:18:36,510
me

354
00:18:36,510 --> 00:18:40,900
too much content but essentially on
you've probably recently seen there was

355
00:18:40,900 --> 00:18:41,370
a

356
00:18:41,370 --> 00:18:46,340
NTP denial of service on attack which
use NTP for traffic amplification

357
00:18:46,340 --> 00:18:49,780
now this is actually also really bad an
SNMP there are some

358
00:18:49,780 --> 00:18:53,190
on commands and some partners
particularly like weary types which you

359
00:18:53,190 --> 00:18:53,960
can use for

360
00:18:53,960 --> 00:18:57,160
immense traffic implication S&P and I
think

361
00:18:57,160 --> 00:19:01,370
you know once we know get are NTP
servers fix maybe the next thing that

362
00:19:01,370 --> 00:19:01,620
the

363
00:19:01,590 --> 00:19:05,740
the bad guys uses SNMP and I will come
back to this later because the sisters

364
00:19:05,740 --> 00:19:08,410
is really important to think about like
right now before it's too late before

365
00:19:08,410 --> 00:19:09,760
they do it

366
00:19:09,760 --> 00:19:12,830
on okay not by us other protocols to sue

367
00:19:12,830 --> 00:19:16,830
just to go through this like each you
looking at those major protocols we can

368
00:19:16,830 --> 00:19:18,510
probably skip this because

369
00:19:18,510 --> 00:19:22,929
every one of you remembers the glory
days of Windows Remote phone abilities

370
00:19:22,929 --> 00:19:25,929
and you know SMB and CIFS some whatever
like the

371
00:19:25,929 --> 00:19:30,160
you know the windows server stack in was
a call to DC

372
00:19:30,160 --> 00:19:34,240
RPC and so I mean there were so many
different on abilities and that stuff

373
00:19:34,240 --> 00:19:37,990
on let's that's not like re revisit
those

374
00:19:37,990 --> 00:19:43,840
so interesting to me is arm if you look
at the next services telnet FTP SSH

375
00:19:43,840 --> 00:19:47,049
of course I mean SSH on is a

376
00:19:47,049 --> 00:19:50,559
somewhat consider to be secure service
I'm so

377
00:19:50,559 --> 00:19:53,610
maybe that's not the not the one where
we find most

378
00:19:53,610 --> 00:19:57,220
weirdness so looking at telnet I think

379
00:19:57,220 --> 00:20:02,159
is by far the most or weird thing that
we found when you look at the internet

380
00:20:02,159 --> 00:20:03,030
because

381
00:20:03,030 --> 00:20:06,640
arm if you

382
00:20:06,640 --> 00:20:09,860
telnet into a lot of routers they don't
even bother

383
00:20:09,860 --> 00:20:13,419
with trying to authenticate you I mean
it's not even you're presented with the

384
00:20:13,419 --> 00:20:16,110
login and password you're just presented
with a shell

385
00:20:16,110 --> 00:20:20,860
so you just you telnet IP address on the
Internet and you're logged in you can do

386
00:20:20,860 --> 00:20:22,240
something on the device

387
00:20:22,240 --> 00:20:25,960
maybe sometimes you don't have fruit
maybe you don't maybe a half

388
00:20:25,960 --> 00:20:29,010
and this this goes across the board like
if you look just

389
00:20:29,010 --> 00:20:32,669
I mean this is really believe me this is
just scanning the internet

390
00:20:32,669 --> 00:20:35,940
looking at what people like what the
town at prom gives you

391
00:20:35,940 --> 00:20:39,450
I'm just what it looks like we didn't
send any login or anything

392
00:20:39,450 --> 00:20:43,360
so you find Windows CE devices that just
present you a CMD

393
00:20:43,360 --> 00:20:47,039
shell so this is just just connecting
right

394
00:20:47,039 --> 00:20:51,289
on yeah the next shells so these you
you've seen the numbers in the top of

395
00:20:51,289 --> 00:20:51,929
the slide

396
00:20:51,929 --> 00:20:55,070
this is like in the thousands again
rights are thousands and thousands of

397
00:20:55,070 --> 00:20:56,470
devices have shells

398
00:20:56,470 --> 00:21:00,789
just open it's not even authentication
so lot of them drop to root

399
00:21:00,789 --> 00:21:04,250
I mean again as I mentioned

400
00:21:04,250 --> 00:21:08,130
you some of you might think okay maybe
you know maybe this is a honeypot system

401
00:21:08,130 --> 00:21:08,690
or something

402
00:21:08,690 --> 00:21:11,940
yes true probably some of them are like
some of them are probably not

403
00:21:11,940 --> 00:21:15,280
a security flaw but I I would argue most
of them

404
00:21:15,280 --> 00:21:19,809
will be a security problem and its up to
every one of us to collectively decide

405
00:21:19,809 --> 00:21:21,600
what is a problem him what is not I mean

406
00:21:21,600 --> 00:21:25,610
some of the things on next lights you
know might not be that severe

407
00:21:25,610 --> 00:21:29,059
but ultimately it comes down to the
picture I mean if you think about the

408
00:21:29,059 --> 00:21:33,010
weirdness and variety of things out
there there will be equally is

409
00:21:33,010 --> 00:21:36,080
as many miss configurations as phone
abilities and to

410
00:21:36,080 --> 00:21:40,280
you know we just have to look at this
and maybe fix it before it's too late

411
00:21:40,280 --> 00:21:42,510
before people exploit that stuff

412
00:21:42,510 --> 00:21:47,720
on youthful find license plate readers
some for example in the US

413
00:21:47,720 --> 00:21:51,360
where you have a camera on the side of
the road and it looks at license plates

414
00:21:51,360 --> 00:21:51,700
and

415
00:21:51,700 --> 00:21:54,919
par system or recognizes them through
image processing

416
00:21:54,919 --> 00:21:58,799
and you connect to attend a device on
the internet and it streams you

417
00:21:58,799 --> 00:22:04,510
cars that are driving by I mean maybe
maybe this is not a concern maybe it's

418
00:22:04,510 --> 00:22:07,890
I mean someone else who stands next to
the road also sees every car driving by

419
00:22:07,890 --> 00:22:08,590
right so

420
00:22:08,590 --> 00:22:11,760
this on the internet so maybe you know
maybe some people consider this

421
00:22:11,760 --> 00:22:15,610
bat Anna on goes further GPS tracking

422
00:22:15,610 --> 00:22:18,890
probably some of you have been in the
the talk earlier today

423
00:22:18,890 --> 00:22:22,270
about the as- search ships trap the arm

424
00:22:22,270 --> 00:22:25,360
tracking by Marco his summer here at

425
00:22:25,360 --> 00:22:30,890
on so I mean with the AIS stuff for
example some people might argue well

426
00:22:30,890 --> 00:22:34,230
okay it's publicly broadcast said so
it's not so bad that it's out there and

427
00:22:34,230 --> 00:22:34,770
you know

428
00:22:34,770 --> 00:22:37,990
tracking chips it should be done on but
again

429
00:22:37,990 --> 00:22:41,900
maybe someone who targets a specific
ship or who targets a specific of

430
00:22:41,900 --> 00:22:46,370
like company or our corporation maybe
for them it's useful that is public and

431
00:22:46,370 --> 00:22:47,440
in the same Amin

432
00:22:47,440 --> 00:22:51,900
if you can follow a certain lorry driver
around to how he travels to Turkey

433
00:22:51,900 --> 00:22:55,720
because he has some kind of device
connected to the internet with the 3G or

434
00:22:55,720 --> 00:22:57,100
whatever SIM card

435
00:22:57,100 --> 00:23:00,240
maybe it's not such a good idea I don't
know I mean maybe someone else wants to

436
00:23:00,240 --> 00:23:03,890
hijacked the the the traffic away ever

437
00:23:03,890 --> 00:23:08,539
on okay so this this this is like a a
very kind of condensed

438
00:23:08,539 --> 00:23:11,830
look into an end is a selection of what
is out there I'd

439
00:23:11,830 --> 00:23:15,049
so on this port this connector here

440
00:23:15,049 --> 00:23:18,090
I love you will recognize it's a serial
port

441
00:23:18,090 --> 00:23:21,330
and the serial port is an interesting
case because

442
00:23:21,330 --> 00:23:25,000
OMSI reports are still a very widespread

443
00:23:25,000 --> 00:23:29,640
to manage devices on can have a physical
level so these will be present on

444
00:23:29,640 --> 00:23:31,120
routers switches

445
00:23:31,120 --> 00:23:35,110
you know some enterprise devices
embedded devices and typically

446
00:23:35,110 --> 00:23:38,299
you associate this with some form of
authentication already

447
00:23:38,299 --> 00:23:41,350
I mean some of those devices where you
where you have the sport you connect to

448
00:23:41,350 --> 00:23:42,740
it through through a cable

449
00:23:42,740 --> 00:23:45,919
and sometimes you need to authenticate I
mean maybe you know they have some

450
00:23:45,919 --> 00:23:47,270
security future there

451
00:23:47,270 --> 00:23:50,840
but in a lot of cases you don't because
they assume okay you are in the server

452
00:23:50,840 --> 00:23:53,960
room already so you have access to the
device so you know

453
00:23:53,960 --> 00:23:57,600
at this point maybe you are like the
admin anyway

454
00:23:57,600 --> 00:24:01,270
so the problem is someone or two
companies mainly

455
00:24:01,270 --> 00:24:04,669
on decided that it's a good idea to
bring those

456
00:24:04,669 --> 00:24:09,860
a physical kinda access on port the sea
reports to the network because I mean

457
00:24:09,860 --> 00:24:13,640
administrators are lazy some of them
sorry no offense

458
00:24:13,640 --> 00:24:17,549
on some administrators might be lazy and
might want to sit in their chair

459
00:24:17,549 --> 00:24:21,289
while administering a certain switch
certain server and so they want to you

460
00:24:21,289 --> 00:24:23,460
know do this from there may be home
office

461
00:24:23,460 --> 00:24:26,730
so they get these devices stay connected
to the switch and

462
00:24:26,730 --> 00:24:30,200
on the other and it either has wifi or
3G

463
00:24:30,200 --> 00:24:34,559
so you would have you know a 3G SIM card
in there and you can manage your mom

464
00:24:34,559 --> 00:24:39,309
thing from home so while to me this
doesn't sound like a good idea but

465
00:24:39,309 --> 00:24:42,799
the companies behind this they actually
I mean they they thought about this a

466
00:24:42,799 --> 00:24:44,169
little bit right so

467
00:24:44,169 --> 00:24:48,610
this on these devices they allow you to
interact with the sports with this

468
00:24:48,610 --> 00:24:50,740
report's through town that SH

469
00:24:50,740 --> 00:24:53,840
I'm sometimes even a web server us on
there with the webcam dove

470
00:24:53,840 --> 00:24:57,590
web console on you know they're
different modes to connect like

471
00:24:57,590 --> 00:25:01,549
proprietary or direct like a TCP kind of
proxy mode

472
00:25:01,549 --> 00:25:06,520
on and they actually have interesting
functionality sometimes where the

473
00:25:06,520 --> 00:25:10,760
offer some automated interaction so you
can say if you see this on the sea

474
00:25:10,760 --> 00:25:14,320
report then do this and this is actually
used to mask and other

475
00:25:14,320 --> 00:25:19,270
expect style a programming thing worry
you instruct the server to interact with

476
00:25:19,270 --> 00:25:20,390
the device and I think

477
00:25:20,390 --> 00:25:25,650
so if you look at the public information
about these devices you can find like

478
00:25:25,650 --> 00:25:30,400
a use case of oil and gas monitoring so
if this device on where and when

479
00:25:30,400 --> 00:25:34,700
certain temperature grows to higher than
it sends a command to large temperature

480
00:25:34,700 --> 00:25:35,669
something like

481
00:25:35,669 --> 00:25:38,720
I don't know I mean I don't know if this
makes sense but this is apparently what

482
00:25:38,720 --> 00:25:39,080
its

483
00:25:39,080 --> 00:25:42,500
but its use for in some cases brewry
tank monitoring

484
00:25:42,500 --> 00:25:46,679
on even medical device monitoring and
there are these different pictures that

485
00:25:46,679 --> 00:25:47,610
you can find

486
00:25:47,610 --> 00:25:51,200
on where the where they talk about use
cases for this device is

487
00:25:51,200 --> 00:25:54,900
but the the pointers if you look now at
the internet again

488
00:25:54,900 --> 00:26:00,090
and we we looked at SNMP public system
description so there's like a system

489
00:26:00,090 --> 00:26:04,230
descriptor description field and it
seems that there are

490
00:26:04,230 --> 00:26:09,210
or at the time there were over a 100 K
DG and Lantronix devices

491
00:26:09,210 --> 00:26:13,419
on that half S&P running and those
devices are those serious service right

492
00:26:13,419 --> 00:26:18,760
so we identified those devices and I
think yet so over 95,000 at the time

493
00:26:18,760 --> 00:26:21,440
were connected via some kind of mobile
connectivity

494
00:26:21,440 --> 00:26:24,770
so some kind of SIM card and and
inserted on

495
00:26:24,770 --> 00:26:28,270
now the authentication methods

496
00:26:28,270 --> 00:26:33,289
that those devices provide are
authenticated encrypt a TCP

497
00:26:33,289 --> 00:26:36,809
on authenticating the crypt as assayed
so its third place for of different

498
00:26:36,809 --> 00:26:38,270
communication methods

499
00:26:38,270 --> 00:26:42,840
and some yeah I means you can be
authentic a commune of indicated so in

500
00:26:42,840 --> 00:26:43,320
theory

501
00:26:43,320 --> 00:26:47,470
you would argue okay those tight devices
are secure everybody can use them right

502
00:26:47,470 --> 00:26:51,809
but as is the problem they are default
configuration stare art like

503
00:26:51,809 --> 00:26:55,590
human factors and what do you guess what
is the most common one across the

504
00:26:55,590 --> 00:26:57,059
internet

505
00:26:57,059 --> 00:27:01,210
so these these two of course so the
unauthenticated TCP path through an

506
00:27:01,210 --> 00:27:02,529
unauthenticated

507
00:27:02,529 --> 00:27:06,909
a multiplex those are the most common
modes to interact with those devices

508
00:27:06,909 --> 00:27:11,220
now that means that if you connect to it
you have essentially a direct line to

509
00:27:11,220 --> 00:27:12,909
the sea report of this device right

510
00:27:12,909 --> 00:27:16,490
and that might not be maybe maybe
sometimes it's okay sometimes it's not

511
00:27:16,490 --> 00:27:21,419
so you find for example traffic signal
monitoring devices

512
00:27:21,419 --> 00:27:24,450
now those on give you an informational
what the traffic lights

513
00:27:24,450 --> 00:27:27,740
you know if it's yellow or red or
whatever you so you can monitor those

514
00:27:27,740 --> 00:27:32,100
and in most cases the issues actually
yardage development kits

515
00:27:32,100 --> 00:27:35,480
and and they have like a day spas a
certain protocol aunt

516
00:27:35,480 --> 00:27:39,240
there is a a default password to this so
it's Tbps in this case

517
00:27:39,240 --> 00:27:42,500
but you will find for example if you
look in T internet census data are you

518
00:27:42,500 --> 00:27:43,370
look into

519
00:27:43,370 --> 00:27:48,080
the SN you know the critical eye over
data their 40 or so and that data set

520
00:27:48,080 --> 00:27:50,649
and a a different amount in other dates
now

521
00:27:50,649 --> 00:27:54,750
the point its you connect to this device
you're connected to the sea report if it

522
00:27:54,750 --> 00:27:58,169
and now the question is is this a
problem or not like can I see maybe the

523
00:27:58,169 --> 00:28:00,549
traffic night can i maybe change it to

524
00:28:00,549 --> 00:28:03,840
you know have a different state I mean
it always from device to device it

525
00:28:03,840 --> 00:28:05,220
depends and this is

526
00:28:05,220 --> 00:28:08,520
the again this is not something where
say this is Mona Boyd this is like the

527
00:28:08,520 --> 00:28:11,200
next big thing and people will you know
change all traffic lights

528
00:28:11,200 --> 00:28:13,940
but I'm saying this is out there and
people connected to the Internet and you

529
00:28:13,940 --> 00:28:14,820
know we just need to

530
00:28:14,820 --> 00:28:17,880
for all of these devices probably think
about what this means and if it's a bad

531
00:28:17,880 --> 00:28:18,520
thing

532
00:28:18,520 --> 00:28:22,799
so if we look at other devices there are
fuel control system such fuel pumps were

533
00:28:22,799 --> 00:28:23,510
you charge

534
00:28:23,510 --> 00:28:27,159
where you you know load up fuel up your
car on their connected

535
00:28:27,159 --> 00:28:31,140
to champ 3G by at the sea report server
and you will

536
00:28:31,140 --> 00:28:35,429
you know you connect to attend at Port
and you're essentially given this menu

537
00:28:35,429 --> 00:28:38,799
and it tells you like system setup
transactions reports

538
00:28:38,799 --> 00:28:42,240
and the question is now what happens if
I go into System Settings

539
00:28:42,240 --> 00:28:46,240
will let's give me a login or do any to
authenticate in some form or is it

540
00:28:46,240 --> 00:28:46,970
directly

541
00:28:46,970 --> 00:28:50,110
configurable can I maybe drive up to it

542
00:28:50,110 --> 00:28:54,669
login to its a yeah now you know
activate fuel pump or whatever and just

543
00:28:54,669 --> 00:28:55,649
fill up for free

544
00:28:55,649 --> 00:28:58,929
maybe Anna on

545
00:28:58,929 --> 00:29:02,750
their difference i mean i i just visit a
couple of these to give your feeling

546
00:29:02,750 --> 00:29:06,250
I A that the cat pictures accurate so
okay so

547
00:29:06,250 --> 00:29:10,140
IPTV headend systems these are systems
that connect like lots of IP cameras

548
00:29:10,140 --> 00:29:11,490
together I think

549
00:29:11,490 --> 00:29:15,419
aunt the problem with those is they
actually have up

550
00:29:15,419 --> 00:29:19,159
like on the sea report its similar to
like a singleton enter

551
00:29:19,159 --> 00:29:23,330
login so essentially when you log in
you're locked in and there no multiple

552
00:29:23,330 --> 00:29:26,090
sessions or anything there's one session
on the CEO port

553
00:29:26,090 --> 00:29:30,409
so the problem is it has authentication
so would be safe you connected to the

554
00:29:30,409 --> 00:29:31,860
Internet it's safe right because

555
00:29:31,860 --> 00:29:35,610
it's only accessible when you're logged
in the problem is if you just disconnect

556
00:29:35,610 --> 00:29:36,710
from the session

557
00:29:36,710 --> 00:29:39,890
the soup or toward won't notice it
because the sea reports connected to

558
00:29:39,890 --> 00:29:41,039
this port server

559
00:29:41,039 --> 00:29:44,330
and that is connected to 3G now if the
3G connection breaks

560
00:29:44,330 --> 00:29:47,929
then it's still logged in and someone
asked next said he doesn't authenticate

561
00:29:47,929 --> 00:29:50,000
again it still locked in

562
00:29:50,000 --> 00:29:53,480
so this is sometimes the the kind of
disconnect between different

563
00:29:53,480 --> 00:29:54,909
technologies where you think

564
00:29:54,909 --> 00:29:57,940
okay the admin thinks all there's a user
login

565
00:29:57,940 --> 00:30:01,460
you know here so I don't need to protect
it in the support service I just switch

566
00:30:01,460 --> 00:30:04,140
to see report server to being offered
unauthenticated

567
00:30:04,140 --> 00:30:08,340
now that's fine as long as he doesn't
disconnect mid-session right

568
00:30:08,340 --> 00:30:11,740
and if you remembers to lock out every
time so sometimes this kind of

569
00:30:11,740 --> 00:30:14,710
disconnect can bring us new
vulnerabilities if we combine these

570
00:30:14,710 --> 00:30:19,679
no technologies on yeah national dry
cleaners and you have somewhere

571
00:30:19,679 --> 00:30:23,350
on you can see someone had to yet get
some leather cleaned

572
00:30:23,350 --> 00:30:26,380
una I mean maybe you can maybe you can

573
00:30:26,380 --> 00:30:29,220
find the customer information that
system as well but this is essentially

574
00:30:29,220 --> 00:30:30,720
just presented to you

575
00:30:30,720 --> 00:30:34,370
on the Internet through a town that
protocol I'd which is

576
00:30:34,370 --> 00:30:37,590
again in in other cases I would argue
it's not so

577
00:30:37,590 --> 00:30:41,380
not so clever and that should should be
should be happening

578
00:30:41,380 --> 00:30:44,700
alright so we can take this anymore this
is really a crazy so

579
00:30:44,700 --> 00:30:47,850
let's get to a little bit more on like
the recent

580
00:30:47,850 --> 00:30:52,250
changes in Internet scanning and yaar
weird now doing a project and why it's

581
00:30:52,250 --> 00:30:53,860
actually very very

582
00:30:53,860 --> 00:30:57,970
different to the have historic
approaches to Internet scanning so

583
00:30:57,970 --> 00:30:59,220
recently

584
00:30:59,220 --> 00:31:02,289
now less research out of the University
of Michigan and the

585
00:31:02,289 --> 00:31:05,649
both a did some research but they also
published a tool and that was called see

586
00:31:05,649 --> 00:31:06,279
map &

587
00:31:06,279 --> 00:31:09,460
or that map probably love you have
effort if this

588
00:31:09,460 --> 00:31:13,269
on and on get made some news because
it's very

589
00:31:13,269 --> 00:31:16,649
very fast and allows you to scan the
internet very fast and

590
00:31:16,649 --> 00:31:19,700
the other published a paper so this is a
purpose-built

591
00:31:19,700 --> 00:31:23,380
internet scanning tool okay it's only
basically done four

592
00:31:23,380 --> 00:31:27,179
internet white studies so it's not done
for scanning your local network

593
00:31:27,179 --> 00:31:30,580
actually there is no option to give it
up subnet to scan

594
00:31:30,580 --> 00:31:34,360
you can just exclude subnets so you know
if you do

595
00:31:34,360 --> 00:31:38,159
see map minus p80 able to an Internet
lights can afford 80

596
00:31:38,159 --> 00:31:42,190
so there's no take no scan this network
is just not planned

597
00:31:42,190 --> 00:31:47,529
and thus of so you're so it if it
saturates your Gigabit Ethernet link

598
00:31:47,529 --> 00:31:50,640
on it will take 45 minutes to visit
every AP

599
00:31:50,640 --> 00:31:53,720
in ipv4 which I think with you know

600
00:31:53,720 --> 00:31:57,470
that's that means one connection one
system one computer right it's only one

601
00:31:57,470 --> 00:32:00,990
one thing I could see your laptop
connected to a Gigabit ports summer

602
00:32:00,990 --> 00:32:05,320
so I think this this really is a drastic
reduction of what we had before

603
00:32:05,320 --> 00:32:08,899
HD when he did the critical a oh i think
is scanning times were still around

604
00:32:08,899 --> 00:32:12,260
I mean days or a week or so for one
particular port

605
00:32:12,260 --> 00:32:15,850
and get that use Tom you know it doesn't
machines are so

606
00:32:15,850 --> 00:32:20,380
aren't so and and deff assaults over to
re actually took three months or they

607
00:32:20,380 --> 00:32:22,110
ran it in three months and collected

608
00:32:22,110 --> 00:32:25,649
although certificates within three
months so this is really up

609
00:32:25,649 --> 00:32:29,370
a magnet order of magnitude lower right
and with this is really important

610
00:32:29,370 --> 00:32:31,460
because it as is not only a cost

611
00:32:31,460 --> 00:32:35,110
on change but is also an accuracy change
now they did

612
00:32:35,110 --> 00:32:38,809
similar research to the FF as a self
serve a Tory so they found

613
00:32:38,809 --> 00:32:42,549
on their factor a bull and arce keys so
it's

614
00:32:42,549 --> 00:32:45,960
it seems like there are a lot of
embedded devices modems and routers

615
00:32:45,960 --> 00:32:49,779
which have up week key generation or
what that's a week random number

616
00:32:49,779 --> 00:32:50,529
generator

617
00:32:50,529 --> 00:32:54,210
so it turns out that if you connect all
those devices you know across

618
00:32:54,210 --> 00:32:57,309
Germany or something turns out that a
lot of them will share are some prime

619
00:32:57,309 --> 00:32:58,409
numbers and their keys

620
00:32:58,409 --> 00:33:01,570
so their factor uble and

621
00:33:01,570 --> 00:33:04,909
if you do this continuously so you scan
for this arm

622
00:33:04,909 --> 00:33:08,480
lots of lots of times new collective
certificates over you know several weeks

623
00:33:08,480 --> 00:33:09,440
or months

624
00:33:09,440 --> 00:33:13,940
you see a 20 percent decrease from 2013
of rubble from

625
00:33:13,940 --> 00:33:17,519
2011 compared to 2013 Arjun

626
00:33:17,519 --> 00:33:20,929
now that is something that is really
important here and I hope I hope you

627
00:33:20,929 --> 00:33:22,850
understand what this means is means

628
00:33:22,850 --> 00:33:26,860
essentially even if they're published on
abilities published

629
00:33:26,860 --> 00:33:30,010
week key is generation on routers

630
00:33:30,010 --> 00:33:34,440
published Debbie in week keys you know
the Debian key generator problem

631
00:33:34,440 --> 00:33:38,500
on this is published research and pretty
much everyone in security knows about it

632
00:33:38,500 --> 00:33:43,080
and still the improvement over years
like two years or so

633
00:33:43,080 --> 00:33:46,240
is in the twenty thirty percent
depending on maybe

634
00:33:46,240 --> 00:33:50,210
on others things it's is less than that
right so even for UPnP I think the

635
00:33:50,210 --> 00:33:51,429
improvement rates

636
00:33:51,429 --> 00:33:54,440
are in the like 10 to 20 percent curve

637
00:33:54,440 --> 00:33:58,380
order so it's really even though it hits
the media

638
00:33:58,380 --> 00:34:02,320
you know end users read about this on
their newspaper or something UPnP all

639
00:34:02,320 --> 00:34:04,169
your routers are vulnerable

640
00:34:04,169 --> 00:34:07,309
the actual improvement in terms of
security in your patch and firmware

641
00:34:07,309 --> 00:34:08,609
upgrades that are happening

642
00:34:08,609 --> 00:34:12,790
it's really really low I mean we're not
really even though it reaches pretty

643
00:34:12,790 --> 00:34:13,440
much everyone

644
00:34:13,440 --> 00:34:16,440
we're not really doing a good job I mean
you know

645
00:34:16,440 --> 00:34:19,710
even though everyone knows about its
like oh yeah I'll

646
00:34:19,710 --> 00:34:22,820
upgrade that next weekend and you know
they forget about that probably

647
00:34:22,820 --> 00:34:25,609
and I don't know what the actual
reasoning behind it is and something

648
00:34:25,609 --> 00:34:28,250
that we together probably need to figure
out

649
00:34:28,250 --> 00:34:31,700
alright so yes so this leads to
interesting times right because

650
00:34:31,700 --> 00:34:35,780
on be because of those guys and they
actually this is not the only tool

651
00:34:35,780 --> 00:34:40,099
%uh for the sake of completeness there
are other tools like mask and who can

652
00:34:40,099 --> 00:34:41,810
actually be even faster

653
00:34:41,810 --> 00:34:45,619
but some the the point is that this is
this means now

654
00:34:45,619 --> 00:34:48,659
that we can do far more are
cost-effective

655
00:34:48,659 --> 00:34:52,829
you know on hand like low-budget
internet scanning and we can do it

656
00:34:52,829 --> 00:34:56,960
continuously and you know every day and
so on compared to having you know

657
00:34:56,960 --> 00:35:01,630
huge costs and weeks of runtimes and
it's also far more accurate

658
00:35:01,630 --> 00:35:05,290
so on I think maybe I have this

659
00:35:05,290 --> 00:35:09,310
have this year on a not so the the point
is

660
00:35:09,310 --> 00:35:12,470
it's now it's now possible to do not
only

661
00:35:12,470 --> 00:35:16,300
a project for three months and stop it
we can now continuously do this right

662
00:35:16,300 --> 00:35:17,109
and forever

663
00:35:17,109 --> 00:35:20,390
like starting from now we can scan like
for SSL Certificates

664
00:35:20,390 --> 00:35:23,640
and give you real-time updates of when

665
00:35:23,640 --> 00:35:27,490
your company's domain name is used in a
certificate across the world somewhere

666
00:35:27,490 --> 00:35:28,500
where it shouldn't be long

667
00:35:28,500 --> 00:35:32,000
right i mean this is now possible to do
on a kind of a day-to-day basis

668
00:35:32,000 --> 00:35:35,960
so this is really it is really one of
the main reasons why we also wanted to

669
00:35:35,960 --> 00:35:36,730
invest some

670
00:35:36,730 --> 00:35:40,650
resources into into this kind of
research in this kind of data gathering

671
00:35:40,650 --> 00:35:44,890
so a big problem on this is the
traditional view on what scanning means

672
00:35:44,890 --> 00:35:46,869
and I recently had a nice discussion
with this

673
00:35:46,869 --> 00:35:50,780
with some on this with some cert met a

674
00:35:50,780 --> 00:35:54,560
yeah workers so people that work and
incident response

675
00:35:54,560 --> 00:35:58,790
across the world and government button
you know private sector doesn't matter

676
00:35:58,790 --> 00:36:02,950
they see internet scanning as this next
scary thing because everybody will not

677
00:36:02,950 --> 00:36:05,940
scan the engine and they will find all
my devices and they will find all my

678
00:36:05,940 --> 00:36:07,170
vulnerabilities

679
00:36:07,170 --> 00:36:12,010
but I mean the point is now that it's
may be more feasible for a lot more

680
00:36:12,010 --> 00:36:13,240
people to do

681
00:36:13,240 --> 00:36:16,579
doesn't that mean that it's now time for
you to finally

682
00:36:16,579 --> 00:36:20,290
alleged fixer devices are may be
disconnected from the Internet compared

683
00:36:20,290 --> 00:36:21,450
to as compared to

684
00:36:21,450 --> 00:36:24,619
we need to stop people from Internet
scanning right so and

685
00:36:24,619 --> 00:36:28,390
anyway am I will come to back to that
later but the point is lots of people

686
00:36:28,390 --> 00:36:29,960
will see this as an attack

687
00:36:29,960 --> 00:36:34,240
and traditional the on if they monitor
them for suction they see someone

688
00:36:34,240 --> 00:36:35,339
scanning them

689
00:36:35,339 --> 00:36:38,980
they will send for example an abuse
report to the source network of this

690
00:36:38,980 --> 00:36:43,230
at so on yet this is like a discussion
of

691
00:36:43,230 --> 00:36:47,839
is the is the is on the Internet like if
they shared document somewhere and has

692
00:36:47,839 --> 00:36:49,520
publicly accessible

693
00:36:49,520 --> 00:36:53,640
is this now I mean this is not public
information or is this a bad thing if

694
00:36:53,640 --> 00:36:54,070
someone

695
00:36:54,070 --> 00:36:57,820
axis it can I sue him because he
accessed my pup my my public document

696
00:36:57,820 --> 00:37:00,060
which I don't think he should download
like

697
00:37:00,060 --> 00:37:03,070
its it gets into all kinds of
discussions with them which i'm happy to

698
00:37:03,070 --> 00:37:04,280
engage with you about

699
00:37:04,280 --> 00:37:07,300
and I want to like you know start some
thoughts on this

700
00:37:07,300 --> 00:37:11,200
so this is typically what you get to get
like %uh police investigate the incident

701
00:37:11,200 --> 00:37:12,130
described in the for

702
00:37:12,130 --> 00:37:16,579
following partial Aug or on I don't know
this email is found Utah State

703
00:37:16,579 --> 00:37:17,339
University

704
00:37:17,339 --> 00:37:20,650
no suspicious and malicious activity
that appears to be sourced from your

705
00:37:20,650 --> 00:37:22,869
network so this is kind of the stuff
that you get

706
00:37:22,869 --> 00:37:26,390
when you do internet white scanning will
run in all sorts of on

707
00:37:26,390 --> 00:37:29,869
monitoring devices dike nets and so on
and they will send mails to your

708
00:37:29,869 --> 00:37:31,130
provider or your

709
00:37:31,130 --> 00:37:34,690
you know abuse are I email address and

710
00:37:34,690 --> 00:37:38,859
they say Happy blocked your IP address
reblogged your whole network range

711
00:37:38,859 --> 00:37:43,329
and typically of course this is because
this is considered to be

712
00:37:43,329 --> 00:37:47,900
previous stage to an attacker to a maybe
you know they wanna do a port scan and

713
00:37:47,900 --> 00:37:48,650
then

714
00:37:48,650 --> 00:37:52,410
in fact some device or exploit some
devices but in this case

715
00:37:52,410 --> 00:37:55,869
it's meant for for different purposes
right minutes

716
00:37:55,869 --> 00:37:58,710
it's meant for different things and I'm
I'm getting back to that later but this

717
00:37:58,710 --> 00:38:00,900
is typically what you get and you have
to

718
00:38:00,900 --> 00:38:04,079
deal with it because we want to play
nice with people and we want to

719
00:38:04,079 --> 00:38:07,280
explain P to people what we're doing so
you're so

720
00:38:07,280 --> 00:38:11,220
now we're coming to this so ish if we're
doing internet scanning

721
00:38:11,220 --> 00:38:14,230
and we want to ev we want this to be

722
00:38:14,230 --> 00:38:17,270
a sustainable think he wants that
everybody thinks about this

723
00:38:17,270 --> 00:38:21,260
as we need to know about what is out
there we need to know about our problems

724
00:38:21,260 --> 00:38:24,550
and we don't need to ignore them because
the bad guys they will do this stuff

725
00:38:24,550 --> 00:38:25,210
anyway

726
00:38:25,210 --> 00:38:28,530
I mean you know doesn't matter like if
we if we say

727
00:38:28,530 --> 00:38:32,410
okay now internet scanning is banned now
nobody is allowed to do it

728
00:38:32,410 --> 00:38:35,430
that's fine I can't do it anymore but
the bad guys on here and I mean they

729
00:38:35,430 --> 00:38:36,300
will do it anyway

730
00:38:36,300 --> 00:38:40,290
so the point is we want to on uses for
good purposes

731
00:38:40,290 --> 00:38:43,450
now if we do this on you need to

732
00:38:43,450 --> 00:38:46,690
either if you if you want to do in
Tuscany you need to either have your own

733
00:38:46,690 --> 00:38:48,869
IP space and then deal with abuse
reports

734
00:38:48,869 --> 00:38:52,240
or you have a good host you have to have
a good Hosur because in most posters

735
00:38:52,240 --> 00:38:53,230
where you rent

736
00:38:53,230 --> 00:38:57,710
PPS or a dedicated server %uh it will
kick you out in most cases if you do

737
00:38:57,710 --> 00:38:58,460
internet scanning

738
00:38:58,460 --> 00:39:02,619
because they see this as not wanted
behavior or you know they don't

739
00:39:02,619 --> 00:39:04,359
understand what you're doing so

740
00:39:04,359 --> 00:39:07,589
on you really have to engage with the
security folks of that particular

741
00:39:07,589 --> 00:39:10,700
company to say hey we're doing this
project are you fine with us doing this

742
00:39:10,700 --> 00:39:13,060
project and what a kind of the
thresholds and the

743
00:39:13,060 --> 00:39:16,780
the you know framework of this so on
yeah

744
00:39:16,780 --> 00:39:20,369
one thing about speed I just mentioned
that there's another tool called mass

745
00:39:20,369 --> 00:39:21,020
can

746
00:39:21,020 --> 00:39:24,760
which allows it to even you know be
faster than 45 minutes I think those

747
00:39:24,760 --> 00:39:26,470
guys they demonstrated to scan

748
00:39:26,470 --> 00:39:29,680
entire ipv4 in three minutes which is

749
00:39:29,680 --> 00:39:32,869
impressive from a technical point of
view I think this is quite awesome but

750
00:39:32,869 --> 00:39:36,300
on the other hand if you are talking
about sustainable

751
00:39:36,300 --> 00:39:40,060
you know continues internet scanning is
action not something you want to do

752
00:39:40,060 --> 00:39:42,940
because you don't wanna overload
networks you don't wanna get people

753
00:39:42,940 --> 00:39:43,960
angry at you

754
00:39:43,960 --> 00:39:47,790
you don't want to scare people you want
to be nice right i mean we want to be

755
00:39:47,790 --> 00:39:49,450
nice we want to do this now

756
00:39:49,450 --> 00:39:52,970
and we think it's super valuable we got
previously research at this is

757
00:39:52,970 --> 00:39:56,290
really valuable to us and also the
community I think so

758
00:39:56,290 --> 00:39:59,540
we want to be. as slow as possible for

759
00:39:59,540 --> 00:40:02,790
while still maintaining accuracy so on

760
00:40:02,790 --> 00:40:06,750
I think we're you know if you look at
forty-five minutes can that means 1.4

761
00:40:06,750 --> 00:40:10,160
million packets per second so for civil
your routers and you're like upstream

762
00:40:10,160 --> 00:40:11,339
needs to handle this

763
00:40:11,339 --> 00:40:15,119
but also remote networks that you hit
get a certain portion of that

764
00:40:15,119 --> 00:40:18,520
package rate of course in you know you
do just I think my

765
00:40:18,520 --> 00:40:22,369
my view on this in our view on this
together is we need to play nice and you

766
00:40:22,369 --> 00:40:22,730
know

767
00:40:22,730 --> 00:40:25,930
reduce the speed to something manageable
actually I think we're running in three

768
00:40:25,930 --> 00:40:27,510
hours or so

769
00:40:27,510 --> 00:40:32,069
in a which is staking about 200 make a
better so of bandwith on our side

770
00:40:32,069 --> 00:40:35,760
gone of course the props artery sorry
but this

771
00:40:35,760 --> 00:40:39,420
the props following the scant so the
certificate collection for example we do

772
00:40:39,420 --> 00:40:43,300
on this needs to be of course tested
because if you end up like

773
00:40:43,300 --> 00:40:47,579
sending some random checks to random
devices on the internet maybe you crash

774
00:40:47,579 --> 00:40:50,430
something so you need to be careful
about what you do n

775
00:40:50,430 --> 00:40:53,829
really make sure that it you know dat
works as intended

776
00:40:53,829 --> 00:40:57,740
on so I think I think this is very
important for anyone who does this there

777
00:40:57,740 --> 00:40:58,160
are

778
00:40:58,160 --> 00:41:01,880
this is not I'm going not going to cover
this but just mention it the c-met guys

779
00:41:01,880 --> 00:41:03,470
so University of Michigan

780
00:41:03,470 --> 00:41:07,119
they actually publish these best
practices I euros on slides if the

781
00:41:07,119 --> 00:41:07,890
slights

782
00:41:07,890 --> 00:41:11,849
anyway so and they have a list of things
that you should do like

783
00:41:11,849 --> 00:41:16,109
you know be transparent a coordinate
closely with network administrators

784
00:41:16,109 --> 00:41:19,319
verify that you don't overwhelmed the
local or remote network

785
00:41:19,319 --> 00:41:23,250
and so on and so on so this is really
like transparency and

786
00:41:23,250 --> 00:41:26,839
communicated with to be communicative
about what you do and what the purpose

787
00:41:26,839 --> 00:41:28,089
of the project is

788
00:41:28,089 --> 00:41:31,380
is to my mind really important and those
get we shared the have the best

789
00:41:31,380 --> 00:41:33,089
practices but those guys

790
00:41:33,089 --> 00:41:36,339
alright so the mission from our side as
we want to

791
00:41:36,339 --> 00:41:40,710
gain like insight into into what is out
there so for a particular customer for

792
00:41:40,710 --> 00:41:41,589
example

793
00:41:41,589 --> 00:41:45,030
on we would like to be able to give them
hate this is what you're cussed

794
00:41:45,030 --> 00:41:47,710
like what your landscape looks from the
outside like this if you look at the

795
00:41:47,710 --> 00:41:49,089
internet scanning data

796
00:41:49,089 --> 00:41:52,839
this is what people can find about you
know below your domain or something

797
00:41:52,839 --> 00:41:55,880
on we want to you know what kind of
security

798
00:41:55,880 --> 00:41:58,900
arm is may be associated with that with
the particle a device like

799
00:41:58,900 --> 00:42:02,680
does have some misconfiguration what is
what is the state of something

800
00:42:02,680 --> 00:42:06,010
and yet maybe we also want to prioritize
say this is more

801
00:42:06,010 --> 00:42:09,310
this is far more on problematic than
this other thing

802
00:42:09,310 --> 00:42:12,410
so of course you guys know I'm rapid
seven does

803
00:42:12,410 --> 00:42:15,550
arm you know kinda maintain our backed
the

804
00:42:15,550 --> 00:42:19,670
Metasploit on toward Metasploit
Framework and also the pro version

805
00:42:19,670 --> 00:42:23,210
so of course we also want to extend that
I mean we want to have more coverage

806
00:42:23,210 --> 00:42:27,099
about things and Metasploit support so
you guys contest your network since on

807
00:42:27,099 --> 00:42:28,010
so we want to

808
00:42:28,010 --> 00:42:31,720
for all those devices out there on the
internet we want to have fingerprinting

809
00:42:31,720 --> 00:42:34,819
we probably want to find out if their
vulnerabilities me want of course

810
00:42:34,819 --> 00:42:37,950
and improve products and that's that's
normal so

811
00:42:37,950 --> 00:42:41,109
yeah the the plan was internally okay

812
00:42:41,109 --> 00:42:44,300
so we start this project we do this
internet scanning

813
00:42:44,300 --> 00:42:49,109
continuously we do it you know weekly or
biweekly or something

814
00:42:49,109 --> 00:42:54,810
and we want to find new issues and also
monitor existing issues and have how

815
00:42:54,810 --> 00:42:55,750
they improve

816
00:42:55,750 --> 00:42:59,310
and we want to raise awareness about
them and also of course

817
00:42:59,310 --> 00:43:02,490
on very important thing as share our
data and

818
00:43:02,490 --> 00:43:05,880
our findings with the community so this
was announced by HD

819
00:43:05,880 --> 00:43:09,530
on last year at Derby Conn and it's
called projects on a

820
00:43:09,530 --> 00:43:13,410
so essentially as I mentioned you want
to see what's kept the state of the

821
00:43:13,410 --> 00:43:14,500
internet

822
00:43:14,500 --> 00:43:18,510
you want to scan and gather data we want
to have some statistics and trends out

823
00:43:18,510 --> 00:43:20,200
of this and share it again

824
00:43:20,200 --> 00:43:24,089
on a at the last points here it's real
important so we want to make this data

825
00:43:24,089 --> 00:43:25,300
available to the community

826
00:43:25,300 --> 00:43:28,839
right so every one of you shouldn't say
now locate school that you do this and

827
00:43:28,839 --> 00:43:30,380
your grass are nice

828
00:43:30,380 --> 00:43:33,520
but I want to do this particular
research and you know this this is

829
00:43:33,520 --> 00:43:34,630
important to me

830
00:43:34,630 --> 00:43:37,839
then we want to you to be able to do
this and essentially

831
00:43:37,839 --> 00:43:40,819
you probably would all agree that if
everyone in the room starts Internet

832
00:43:40,819 --> 00:43:42,220
scanning now on

833
00:43:42,220 --> 00:43:45,750
maybe that's I mean thats duplicate work
right so we want to share kind of the

834
00:43:45,750 --> 00:43:46,710
workload

835
00:43:46,710 --> 00:43:49,970
and we also don't want to invest too
much money so we want to keep like our

836
00:43:49,970 --> 00:43:51,230
side of things small

837
00:43:51,230 --> 00:43:54,630
so we want to share the whole day to on
a because

838
00:43:54,630 --> 00:43:59,270
we we won't find everything some you
know two pair of eyes and saw

839
00:43:59,270 --> 00:44:02,300
I'm so what would we do I'm so far is

840
00:44:02,300 --> 00:44:06,760
we scan on 443 TCP which is the HTTPS
port

841
00:44:06,760 --> 00:44:10,369
and we collect the SSL certificates from
it so we gather

842
00:44:10,369 --> 00:44:13,599
although you know server certificate CA
certificates that are offered from those

843
00:44:13,599 --> 00:44:14,510
web servers

844
00:44:14,510 --> 00:44:17,630
we do this on a weekly up basis then

845
00:44:17,630 --> 00:44:21,500
on additionally we do on ATT CP and we
do and our

846
00:44:21,500 --> 00:44:24,770
a GET request not so we get the index
page to get the

847
00:44:24,770 --> 00:44:28,900
HTML from the next page on from every
web server out there

848
00:44:28,900 --> 00:44:33,290
do this I think biweekly I'm reverse DNS
was an interesting experiment so we

849
00:44:33,290 --> 00:44:34,530
thought hey on

850
00:44:34,530 --> 00:44:38,260
it could be interesting to gather all
reverse DNS records so pointer

851
00:44:38,260 --> 00:44:41,400
PTR records um for every IP out there

852
00:44:41,400 --> 00:44:44,500
and we also do this by weekly which was
a bit of a challenge

853
00:44:44,500 --> 00:44:49,079
because sir that's three-point 8 billion
lookups you need to do

854
00:44:49,079 --> 00:44:52,430
and of course a curacy so you want to do
this probably in less than

855
00:44:52,430 --> 00:44:56,450
like 24 hours so a this was quite the
challenge from an engineering point

856
00:44:56,450 --> 00:44:57,950
point of you and also

857
00:44:57,950 --> 00:45:01,190
on I'm you know DNS server point a few
on

858
00:45:01,190 --> 00:45:04,560
yeah we're currently testing some other
things like me want to also instead of

859
00:45:04,560 --> 00:45:08,560
doing only I P HTTP request me on so
want to do

860
00:45:08,560 --> 00:45:12,450
name request the problem is that
generates a huge amount of data

861
00:45:12,450 --> 00:45:15,950
um I think it's on the next slide on

862
00:45:15,950 --> 00:45:19,560
on OK want one more in between before we
come to the data sizes

863
00:45:19,560 --> 00:45:22,569
so of course this is more than just an
Internet scan

864
00:45:22,569 --> 00:45:27,050
in terms of port scan right we need to
have like a port scan so that is done by

865
00:45:27,050 --> 00:45:31,060
a see map or mask and and then the stage
to happen so the actual

866
00:45:31,060 --> 00:45:35,450
I SSL certificate collection or they
should be download and so on

867
00:45:35,450 --> 00:45:39,700
so we use a dedicated server for the on
for cement the mass can support a port

868
00:45:39,700 --> 00:45:40,220
scanning

869
00:45:40,220 --> 00:45:44,680
I think mascarenes written only with 2s
so in next mistake on the slide sorry

870
00:45:44,680 --> 00:45:49,300
on and we use cloud instances and some
cloud provider for doing the second

871
00:45:49,300 --> 00:45:50,510
stage right so

872
00:45:50,510 --> 00:45:53,800
once we find open ports we then give
this to some

873
00:45:53,800 --> 00:45:57,609
you know I range of systems and some
some kind of cloud infrastructure

874
00:45:57,609 --> 00:46:01,680
and then we get the certificates through
that and yet so we have a tool called

875
00:46:01,680 --> 00:46:03,490
internal called also sonar

876
00:46:03,490 --> 00:46:06,890
and that manages this so essentially by
now there's

877
00:46:06,890 --> 00:46:10,170
I like a crime job somewhere running and
says SSL scan

878
00:46:10,170 --> 00:46:13,250
and then it does this automatically
right at it ramps up some instances in

879
00:46:13,250 --> 00:46:14,130
the cloud

880
00:46:14,130 --> 00:46:18,270
I install some prepares dance arts desk
and you know it does all the stuff

881
00:46:18,270 --> 00:46:19,960
collect data as upset up and then

882
00:46:19,960 --> 00:46:23,730
uploaded to a public website for you to
download

883
00:46:23,730 --> 00:46:27,900
yeah and so it needs to be like fast
everything that's on

884
00:46:27,900 --> 00:46:32,690
so on yeah as I mentioned reverse DNS
was was quite the challenge so

885
00:46:32,690 --> 00:46:37,579
on if you looking at you wanna do like
all you wanna hit all I peace within 24

886
00:46:37,579 --> 00:46:38,160
hours

887
00:46:38,160 --> 00:46:41,910
means that you need to do forty four
thousand lookups per second

888
00:46:41,910 --> 00:46:45,040
and that is probably some kinda if

889
00:46:45,040 --> 00:46:48,859
like how to say like a load on a DNS
server and it's also quite heavy to do

890
00:46:48,859 --> 00:46:50,660
this on a single server so

891
00:46:50,660 --> 00:46:54,160
we're using yeah we built this DNS blast
at sea on

892
00:46:54,160 --> 00:46:58,609
which means which meant so we built this
oh yeah I worst super efficient but then

893
00:46:58,609 --> 00:46:59,290
we break

894
00:46:59,290 --> 00:47:02,349
you know the DNS infrastructure of the
car provider with using

895
00:47:02,349 --> 00:47:06,720
and then will not break now but slowdown
and kinda impact i mean they see spikes

896
00:47:06,720 --> 00:47:07,819
in their graphs and

897
00:47:07,819 --> 00:47:11,619
systems are slow so they call us and say
hey guys said you need to stop

898
00:47:11,619 --> 00:47:14,700
am yeah and then we essentially

899
00:47:14,700 --> 00:47:19,119
because of that um this also meant that
we were essentially de da same

900
00:47:19,119 --> 00:47:23,280
big name servers of the guys peace so if
they have a name server that

901
00:47:23,280 --> 00:47:26,690
maintains all the records for you know a
big splash eight or something then they

902
00:47:26,690 --> 00:47:27,609
would see a lot of

903
00:47:27,609 --> 00:47:30,859
on traffic from us so yeah the

904
00:47:30,859 --> 00:47:35,490
the end thing was we needed to apologize
to a lot of people and to

905
00:47:35,490 --> 00:47:39,240
yeah and talk to them and defined the
thresholds defined the speeds that are

906
00:47:39,240 --> 00:47:40,640
acceptable and mean

907
00:47:40,640 --> 00:47:43,690
we we actually had a very positive
communication with a lot of these folks

908
00:47:43,690 --> 00:47:45,619
like the cloud infrastructure but also
the

909
00:47:45,619 --> 00:47:49,910
providers and they said okay im the
sounds interesting the project but

910
00:47:49,910 --> 00:47:52,619
you know in the way that you did you
can't do this like this is too much

911
00:47:52,619 --> 00:47:53,260
right

912
00:47:53,260 --> 00:47:56,550
so we define together we defined the
thresholds

913
00:47:56,550 --> 00:47:59,720
aunt yet now it's running and it's all
working in

914
00:47:59,720 --> 00:48:02,930
I don't know everybody's happy
apparently on

915
00:48:02,930 --> 00:48:06,349
okay so this is what I call dealing with
big enough data

916
00:48:06,349 --> 00:48:09,650
so I'm not in the Big Data business
probably some of you are

917
00:48:09,650 --> 00:48:14,010
big data business means you have lots of
servers and lots of light clusters of

918
00:48:14,010 --> 00:48:17,109
databases whatever I don't really have
that so I have like

919
00:48:17,109 --> 00:48:21,540
to now 3 server somewhere in Germany
your one server in the US so it's really

920
00:48:21,540 --> 00:48:22,690
like limited

921
00:48:22,690 --> 00:48:26,630
so the problem is again i gather a lot
of data but it's hard to

922
00:48:26,630 --> 00:48:30,510
all make it searchable I mean I i'm not
a showdown right side on half

923
00:48:30,510 --> 00:48:33,550
this kind of background so we're looking
at

924
00:48:33,550 --> 00:48:38,150
on weekly SSL certificates so you're
looking at forty million open ports for

925
00:48:38,150 --> 00:48:38,930
443

926
00:48:38,930 --> 00:48:44,390
across the internet I'm we got about 25
million SSL certs and total from those

927
00:48:44,390 --> 00:48:48,760
some I think that's because a a lot of
them are duplicates so I mean if you

928
00:48:48,760 --> 00:48:51,780
look at Google for example they will
probably have thousands and thousands of

929
00:48:51,780 --> 00:48:53,670
service with the same certificate

930
00:48:53,670 --> 00:48:57,470
then again we probably some of them are
misconfigured I they're actually not

931
00:48:57,470 --> 00:48:58,010
running

932
00:48:58,010 --> 00:49:02,609
as a cell so we see a lot of normal HDPE
web service on port 443

933
00:49:02,609 --> 00:49:07,630
for whatever reason so you're so this
generates around 55 to 60 gigabytes of

934
00:49:07,630 --> 00:49:08,079
data

935
00:49:08,079 --> 00:49:11,470
within around four hours now um

936
00:49:11,470 --> 00:49:15,140
the ATT CP so HDP get I'm
seventy-million

937
00:49:15,140 --> 00:49:18,220
open ports around 3.5 two bites

938
00:49:18,220 --> 00:49:24,660
an average on data but so that means on
this is like twent 220 to 240 depends

939
00:49:24,660 --> 00:49:27,980
I gigabytes within 10 hours that this
generates at

940
00:49:27,980 --> 00:49:31,220
and then we somehow want to do something
with it and we also want to upload it to

941
00:49:31,220 --> 00:49:32,880
make it available to you guys

942
00:49:32,880 --> 00:49:36,050
so it's so you know it's somewhat of a
challenge if you're dealing with just a

943
00:49:36,050 --> 00:49:38,210
couple of servers that you have
somewhere

944
00:49:38,210 --> 00:49:41,980
on yet reversing us the same thing its
1.1 billion records

945
00:49:41,980 --> 00:49:46,280
a pro approximately and that means
around 50 gigabytes plain text you know

946
00:49:46,280 --> 00:49:47,000
in an

947
00:49:47,000 --> 00:49:50,309
record pairs essentially on so there'd

948
00:49:50,309 --> 00:49:53,619
I i mentioned this so the name a ATP get
so if

949
00:49:53,619 --> 00:49:57,079
let's say we have no facebook.com/goal
dot com all those names

950
00:49:57,079 --> 00:50:01,170
and we do it's you P get on every one of
those that will be a lot more data than

951
00:50:01,170 --> 00:50:02,569
just the IP based

952
00:50:02,569 --> 00:50:07,770
a vhost so this generated we tried this
for around $200 million names may be 250

953
00:50:07,770 --> 00:50:09,440
I can't remember for sure but

954
00:50:09,440 --> 00:50:12,500
this generated 1.5 terabytes of data now

955
00:50:12,500 --> 00:50:16,490
this is again lot harder to share with
you guys because we need to have the

956
00:50:16,490 --> 00:50:18,480
bandwidth and storage and so on

957
00:50:18,480 --> 00:50:21,619
and is also for us we can't do that by
weekly at least up with the budget that

958
00:50:21,619 --> 00:50:23,190
are currently half like I can

959
00:50:23,190 --> 00:50:26,990
I can sustain this so the question is
like how do you

960
00:50:26,990 --> 00:50:30,180
how do you do this and this is running
sensor roughly November

961
00:50:30,180 --> 00:50:33,190
2013 so this is really

962
00:50:33,190 --> 00:50:36,910
a little bit my personal big enough data
problem that I deal with them

963
00:50:36,910 --> 00:50:40,270
because I'm not coming from any big data
background Sony to

964
00:50:40,270 --> 00:50:43,460
somehow deal with the stuff on okay so

965
00:50:43,460 --> 00:50:47,790
yeah as I mentioned so you have fun if
you have like millions of records

966
00:50:47,790 --> 00:50:51,670
on it tends to blow up some of the even
like high-performance

967
00:50:51,670 --> 00:50:55,569
low-level key-value store some whatever
you have few if you get these tools from

968
00:50:55,569 --> 00:50:56,910
the internet and you say yet

969
00:50:56,910 --> 00:51:00,109
awesome efficient database and then you
start to insert

970
00:51:00,109 --> 00:51:03,520
hundreds of millions of records stable
breaking a lot of cases

971
00:51:03,520 --> 00:51:07,470
actually to be fast Marty but over time
here on

972
00:51:07,470 --> 00:51:11,290
so yet so this is likely want to build
databases of this but it's very hard to

973
00:51:11,290 --> 00:51:11,900
do

974
00:51:11,900 --> 00:51:15,450
on with the kind of project that I'm
dealing with

975
00:51:15,450 --> 00:51:19,240
alright so I'll skip this a little bit
I'm so we're building lookup tables some

976
00:51:19,240 --> 00:51:22,890
and this looks like it's very it's not
really very enterprise some sorry for

977
00:51:22,890 --> 00:51:23,440
this but

978
00:51:23,440 --> 00:51:26,950
you know it typically looks like a big
shell pipeline of tools that are

979
00:51:26,950 --> 00:51:30,190
cat into each other in you know it's all
kinda the

980
00:51:30,190 --> 00:51:34,369
little bit feels a little bit dirty
hacky but I mean this is the way that we

981
00:51:34,369 --> 00:51:36,680
deal with that in some way to fish and I
think it's somewhat

982
00:51:36,680 --> 00:51:40,079
you know high-performance if you can
talk about that when it with a single

983
00:51:40,079 --> 00:51:41,119
system

984
00:51:41,119 --> 00:51:44,579
I'm here we use something called level
dB we I have some storage

985
00:51:44,579 --> 00:51:48,030
and %ah PostgreSQL and to yeah it's a

986
00:51:48,030 --> 00:51:51,589
its different data stores that are each
used for the specific purpose where

987
00:51:51,589 --> 00:51:52,040
they've

988
00:51:52,040 --> 00:51:55,309
fits you know where the technology fits
the purpose so it's it's a little bit of

989
00:51:55,309 --> 00:51:55,700
a

990
00:51:55,700 --> 00:51:59,140
cover had to read heater a generous
environment

991
00:51:59,140 --> 00:52:02,220
rights on oh yeah on

992
00:52:02,220 --> 00:52:05,730
yeah the problem is on this with this
was a problem

993
00:52:05,730 --> 00:52:09,250
were essentially you read this
individual tools and you need to scale

994
00:52:09,250 --> 00:52:10,530
them up you need to make them

995
00:52:10,530 --> 00:52:14,270
you know faster you need a paralyzed M
and I don't have to the time

996
00:52:14,270 --> 00:52:18,069
to actually leave right paralyze coats
we end up doing stuff like in the bottom

997
00:52:18,069 --> 00:52:18,510
there

998
00:52:18,510 --> 00:52:21,569
where were you sir canoe parallel which
is it will have never heard of before

999
00:52:21,569 --> 00:52:22,450
but when I

1000
00:52:22,450 --> 00:52:25,550
did this work was really a valuable
because it essentially

1001
00:52:25,550 --> 00:52:29,809
spawns like know a lot of processes from
the same like type and just

1002
00:52:29,809 --> 00:52:33,640
splits up the input into different of
those and super helpful

1003
00:52:33,640 --> 00:52:38,190
on but it's all kinda earth it's all
individual command line stuff and it's

1004
00:52:38,190 --> 00:52:39,059
not really

1005
00:52:39,059 --> 00:52:42,869
you know it Hadoop cluster that I'm
dealing with right alright so I'm will

1006
00:52:42,869 --> 00:52:43,890
be billed as

1007
00:52:43,890 --> 00:52:46,809
out of the data that we got be but some
interesting look up in Texas and I'm

1008
00:52:46,809 --> 00:52:48,550
I'll show you a quick demo in a minute
here

1009
00:52:48,550 --> 00:52:51,780
before we r almost done on

1010
00:52:51,780 --> 00:52:55,790
so for example you can do searches for
certain domain names and find

1011
00:52:55,790 --> 00:52:59,520
you know all certificates that have
something rapid7 a calmer something your

1012
00:52:59,520 --> 00:53:00,319
domain name in them

1013
00:53:00,319 --> 00:53:03,970
right and you build lookup tables for
this for investigative purposes

1014
00:53:03,970 --> 00:53:07,059
and I will show you up yeah we'll show
you this

1015
00:53:07,059 --> 00:53:10,240
a demo quickly so I wanted to cover um

1016
00:53:10,240 --> 00:53:13,339
still some things that we can do with
this and I am skipping through this now

1017
00:53:13,339 --> 00:53:14,400
because I'm over time

1018
00:53:14,400 --> 00:53:18,319
me was slower than a expected but
essentially their lot of different

1019
00:53:18,319 --> 00:53:21,720
angles to this and I hope that you have
some ideas as well and our ideas where

1020
00:53:21,720 --> 00:53:25,390
we want to do this continuous SSL
Observatory so we want to look up you

1021
00:53:25,390 --> 00:53:28,630
know what kind of changes in our SSL
landscape and we want to do this on a

1022
00:53:28,630 --> 00:53:29,430
continuous

1023
00:53:29,430 --> 00:53:32,900
on no freedom regular way on

1024
00:53:32,900 --> 00:53:36,760
we're how how do they improve and so on
I want to prioritize

1025
00:53:36,760 --> 00:53:40,780
on ability research so we want to see if
the device is popular we probably want

1026
00:53:40,780 --> 00:53:44,710
to look at it first compare to a device
that is seen only use for 10 devices

1027
00:53:44,710 --> 00:53:46,000
across the internet

1028
00:53:46,000 --> 00:53:49,880
on exposure upon abilities done so for
example you

1029
00:53:49,880 --> 00:53:53,190
I'm not sure if you remember the SIR
compact or recently we found

1030
00:53:53,190 --> 00:53:56,660
7,000 routers across internet at this
running

1031
00:53:56,660 --> 00:54:01,319
there was recently in your module in in
Metasploit for some Yokogawa bass gotta

1032
00:54:01,319 --> 00:54:04,390
equipment where we found phone abilities
and to have them where

1033
00:54:04,390 --> 00:54:08,079
available on the internet as well which
is kinda scary I think

1034
00:54:08,079 --> 00:54:11,089
and you can if you just find Canova
grabbed rap

1035
00:54:11,089 --> 00:54:14,660
a grasp of what is what is out there and
what you're dealing with

1036
00:54:14,660 --> 00:54:18,730
on yet you can do stuff like continues
defacement statistics we can do like a

1037
00:54:18,730 --> 00:54:20,359
public school board of the

1038
00:54:20,359 --> 00:54:25,130
bestie face urs out there or something
where you just look for the HTML and you

1039
00:54:25,130 --> 00:54:25,910
see you know

1040
00:54:25,910 --> 00:54:30,200
hacked by exercise thing or hacked by
the Circa as shit Syrian electronic army

1041
00:54:30,200 --> 00:54:31,329
or something

1042
00:54:31,329 --> 00:54:34,450
and you will just you just just need to
look into the date and look for hacked

1043
00:54:34,450 --> 00:54:34,960
by

1044
00:54:34,960 --> 00:54:38,230
and you can makes it a six out of this
gonna fun

1045
00:54:38,230 --> 00:54:43,210
on find parser box right so internet
data stressful for love parsers because

1046
00:54:43,210 --> 00:54:46,359
they don't expect what is out there and
and weirdness so we found a

1047
00:54:46,359 --> 00:54:49,400
bug in Ruby armpits parsing certificates
in the wrong way

1048
00:54:49,400 --> 00:54:53,010
there's a bug upstream I'm so you find
all these different things and the state

1049
00:54:53,010 --> 00:54:56,520
is useful for I think so many different
angles that I can possibly cover all of

1050
00:54:56,520 --> 00:54:57,299
them here

1051
00:54:57,299 --> 00:55:01,020
so what's next so we want to extent
obvious this this project we want to

1052
00:55:01,020 --> 00:55:03,670
gather more certificates we want to have
more day then there

1053
00:55:03,670 --> 00:55:07,569
on ants so we want to build reporting
out of this one together

1054
00:55:07,569 --> 00:55:11,020
generate all this weather mention p1
generate stats and statistics and graphs

1055
00:55:11,020 --> 00:55:13,930
and so on and allow for easier
collaboration

1056
00:55:13,930 --> 00:55:17,780
now somehow got and to be really faster
I'm probably have like three minutes

1057
00:55:17,780 --> 00:55:18,770
left

1058
00:55:18,770 --> 00:55:21,950
um a skip this year from outside
collaborations highly important so the

1059
00:55:21,950 --> 00:55:24,280
scan data is published at scan style

1060
00:55:24,280 --> 00:55:27,280
which is hosted by the University of
Michigan I think I have it on next page

1061
00:55:27,280 --> 00:55:28,390
second probably

1062
00:55:28,390 --> 00:55:32,190
show this to you but its essentially its
website at University of Michigan

1063
00:55:32,190 --> 00:55:35,569
and all the data sets are up there and
there continues the up-to-date so the

1064
00:55:35,569 --> 00:55:37,490
SSL certificates if you look at this

1065
00:55:37,490 --> 00:55:41,170
every Monday I think you will find new
data from us right and you can just

1066
00:55:41,170 --> 00:55:44,410
download the raw data that we get from
our from our scans

1067
00:55:44,410 --> 00:55:48,049
and you can look into it yourself you
can find dino devices out there

1068
00:55:48,049 --> 00:55:51,540
up above the radius he did a talk about
the

1069
00:55:51,540 --> 00:55:54,859
no building management just earlier in
another room and you can find those

1070
00:55:54,859 --> 00:55:57,849
devices in a in the dataset right you
can just use it you don't need to scan

1071
00:55:57,849 --> 00:56:00,010
the internet you can just use this data
set

1072
00:56:00,010 --> 00:56:04,410
and then you can play around all rights
are wrapping up here Internet's broken

1073
00:56:04,410 --> 00:56:09,099
um and we're not really improving the
overall state I think of security where

1074
00:56:09,099 --> 00:56:11,150
doing individual good jobs you know this

1075
00:56:11,150 --> 00:56:14,849
this thing this bike is fixed and this
bug is updated now and now it's

1076
00:56:14,849 --> 00:56:18,490
it's all good but its overall they're
just many more bucks

1077
00:56:18,490 --> 00:56:22,569
and many more devices piling up and we
can possibly cover them all and people

1078
00:56:22,569 --> 00:56:26,900
no miss Conficker them and so on on
moving forward we want to

1079
00:56:26,900 --> 00:56:30,880
generate like more awareness and
visibility ants and just take the or

1080
00:56:30,880 --> 00:56:34,890
orange stuff for now because we need to
me move fast collaboration is essential

1081
00:56:34,890 --> 00:56:38,520
for the stuff because we want to collect
this allies this and we can't do this on

1082
00:56:38,520 --> 00:56:40,849
our own with the three guys that we have

1083
00:56:40,849 --> 00:56:43,910
on into skin helps on that script skip
this

1084
00:56:43,910 --> 00:56:47,260
we r check out other stuff people that
presentations on this before

1085
00:56:47,260 --> 00:56:50,510
professor how demand from the University
of Michigan he did a presentation that

1086
00:56:50,510 --> 00:56:54,430
online on on YouTube I think HD more ski
know it's getting dark these online on

1087
00:56:54,430 --> 00:56:55,170
YouTube

1088
00:56:55,170 --> 00:56:59,410
you can find those on as well you have
my sights on the CD I think so you can

1089
00:56:59,410 --> 00:57:00,950
just check this out

1090
00:57:00,950 --> 00:57:04,930
on death so that census broken it in
scanning saves lives

1091
00:57:04,930 --> 00:57:08,880
I hope you agree with me and sharing is
caring obviously so we want to share our

1092
00:57:08,880 --> 00:57:11,079
data and hopefully you share results
with me

1093
00:57:11,079 --> 00:57:14,160
and please come to me afterwards because
they're are some

1094
00:57:14,160 --> 00:57:17,619
some things we can discuss about even
though we're out of time here

1095
00:57:17,619 --> 00:57:24,619
all right sir thanks and

1096
00:57:26,280 --> 00:57:29,670
yet where probably we had don't have a
lot of time in between what one question

1097
00:57:29,670 --> 00:57:31,049
but probably it's over I'm

1098
00:57:31,049 --> 00:57:34,630
I'm happy to talk with you all night and
after the the prod

1099
00:57:34,630 --> 00:57:38,089
after the talk but if you guys need to
head out or get to the next to

1100
00:57:38,089 --> 00:57:41,660
presentation I don't know what we have a
break now maybe

1101
00:57:41,660 --> 00:57:47,740
yeah go ahead

1102
00:57:47,740 --> 00:57:52,220
right so ipv6 obviously as most of you
know ipv6 you can't really easily

1103
00:57:52,220 --> 00:57:53,319
enumerate as

1104
00:57:53,319 --> 00:57:57,930
ipv4 but there are some ways to be good
still do some scanning ipv6 a for

1105
00:57:57,930 --> 00:57:58,839
example

1106
00:57:58,839 --> 00:58:02,809
you can um for all the domain names are
full for all like the

1107
00:58:02,809 --> 00:58:06,079
you know names to be finding all the
data sets we can do

1108
00:58:06,079 --> 00:58:09,829
just lookups and look up if they have an
ipv6 address

1109
00:58:09,829 --> 00:58:13,220
and then scanned the appropriate ipv6
address for services

1110
00:58:13,220 --> 00:58:16,869
so we could see we could do something I
think we have currently

1111
00:58:16,869 --> 00:58:20,970
a list of forty million fifty million
ipv6 addresses that are associated with

1112
00:58:20,970 --> 00:58:24,140
some kind of name so that with that we
have DNS records for

1113
00:58:24,140 --> 00:58:27,400
so we could scan those for example and
then they're different other approaches

1114
00:58:27,400 --> 00:58:28,309
but yes

1115
00:58:28,309 --> 00:58:31,520
enumerating and scanning everything of
course not feasible

1116
00:58:31,520 --> 00:58:37,690
but we will find probably a good subset
of available devices and ipv6

1117
00:58:37,690 --> 00:58:42,089
yeah on I have some demos if anyone
wants to see a demo of the lookup tables

1118
00:58:42,089 --> 00:58:46,849
and we can look at some data up feel
free to come to me afterwards

1119
00:58:46,849 --> 00:58:49,910
anyone else right thank you up

1120
00:58:49,910 --> 00:58:56,910
one more yeah

1121
00:59:01,660 --> 00:59:05,140
while so this is sending one packet

1122
00:59:05,140 --> 00:59:09,710
to every IP right so it means like if
you have a large network layer you have

1123
00:59:09,710 --> 00:59:13,380
a slash 16 of public IP addresses which
is probably consider a large network

1124
00:59:13,380 --> 00:59:14,279
nowadays

1125
00:59:14,279 --> 00:59:18,700
on we would essentially send 65,000
packets over the course of three hours

1126
00:59:18,700 --> 00:59:19,160
to the

1127
00:59:19,160 --> 00:59:23,630
to the network now I would argue that
this is compared to the general noise

1128
00:59:23,630 --> 00:59:25,270
you get on a network like this

1129
00:59:25,270 --> 00:59:30,089
is probably super small like this issue
no a fraction of what you get in typical

1130
00:59:30,089 --> 00:59:34,020
noise from all over the world so I think
I don't a person that's my personal

1131
00:59:34,020 --> 00:59:37,010
opinion there's no scientific background
or data to this but

1132
00:59:37,010 --> 00:59:40,710
I think that the amount of traffic you
see

1133
00:59:40,710 --> 00:59:43,940
from for example is the maps can with
one propriétaire p

1134
00:59:43,940 --> 00:59:47,039
is very low compared to the normal
Kenneth

1135
00:59:47,039 --> 00:59:50,410
stuff that arrives at you so of course
if people start

1136
00:59:50,410 --> 00:59:53,450
like more and more people start doing
this and Jeff Lowe as I mentioned the

1137
00:59:53,450 --> 00:59:55,510
whole room start scanning for port
eighty

1138
00:59:55,510 --> 00:59:58,799
and of course this like this trip this
this a your

1139
00:59:58,799 --> 01:00:02,450
others piled up and lots more people
lots more packets more bands with

1140
01:00:02,450 --> 01:00:06,950
but honestly like if you look at stuff
like Tarentum whatever and if you look

1141
01:00:06,950 --> 01:00:09,089
at other protocols there's so much more

1142
01:00:09,089 --> 01:00:12,900
data and band with us used every day I
think from a band with

1143
01:00:12,900 --> 01:00:16,880
and endpoint point of view this is not
such a big deal

1144
01:00:16,880 --> 01:00:21,369
a it would become a big deal if everyone
on the planet would do it but not

1145
01:00:21,369 --> 01:00:24,819
you know if even a thousand people would
do this every day you probably won't

1146
01:00:24,819 --> 01:00:25,559
even notice

1147
01:00:25,559 --> 01:00:29,380
I think you know it's it's very I think
it's very low impact in terms banned

1148
01:00:29,380 --> 01:00:32,200
within packets per second and sonnets
it's okay I mean

1149
01:00:32,200 --> 01:00:35,460
of course this is why we share sharing
data right I mean

1150
01:00:35,460 --> 01:00:38,890
if you can grab our data maybe you don't
need to do it yourself depends

1151
01:00:38,890 --> 01:00:42,940
and if you want it more often than maybe
ask us to do it more often cut rather

1152
01:00:42,940 --> 01:00:43,970
than just doing it yourself

1153
01:00:43,970 --> 01:00:46,660
sites you know this is why we want to
share in this is why we want to

1154
01:00:46,660 --> 01:00:47,210
collaborate

1155
01:00:47,210 --> 01:00:51,640
I guess on for those if you are still
sitting

1156
01:00:51,640 --> 01:00:55,329
I can do a quick are we don't have a
slight anymore don't have my device and

1157
01:00:55,329 --> 01:00:55,660
mr.

1158
01:00:55,660 --> 01:00:59,960
can you looking to switch on screen
again for just a minute

1159
01:00:59,960 --> 01:01:03,740
can you switch on the screen again for
just a minute

1160
01:01:03,740 --> 01:01:08,140
so um

1161
01:01:08,140 --> 01:01:12,029
I'll just do a quick look up against
some Singapore in

1162
01:01:12,029 --> 01:01:16,039
Tom you know web server and see what we
find our data for anyone who wants to

1163
01:01:16,039 --> 01:01:16,440
build

1164
01:01:16,440 --> 01:01:23,440
still waiting for getting coffee

1165
01:01:24,510 --> 01:01:28,819
is working on our perfect I'm ship
alright so let's move this

1166
01:01:28,819 --> 01:01:32,280
over here from most this bigger

1167
01:01:32,280 --> 01:01:36,690
so we can for example so II for that
this is a public

1168
01:01:36,690 --> 01:01:40,869
I'm in a website that is somewhat
popular and Singapore so we could send

1169
01:01:40,869 --> 01:01:45,270
we could check the data um and see what
we find for

1170
01:01:45,270 --> 01:01:48,500
part where zone com St right so

1171
01:01:48,500 --> 01:01:54,569
we would find let's do it again so we
would find for example the data because

1172
01:01:54,569 --> 01:01:57,599
this is this internet scanning that is
active data right you could but you can

1173
01:01:57,599 --> 01:02:00,020
both databases are to fit that you can
look up stuff

1174
01:02:00,020 --> 01:02:03,140
against so would find okay we find these
all these records

1175
01:02:03,140 --> 01:02:06,329
on that are pointing to several IP
addresses below hardware zone

1176
01:02:06,329 --> 01:02:10,339
dot com that SG now this is all good and
fine to know you what we have

1177
01:02:10,339 --> 01:02:13,819
like public facing devices from this
particular vendor at

1178
01:02:13,819 --> 01:02:17,010
but maybe it would be interesting to see
what other websites or

1179
01:02:17,010 --> 01:02:20,890
names to the also use for this
particular website how do they get you

1180
01:02:20,890 --> 01:02:23,560
may be also to the website so we take
one of the AP's

1181
01:02:23,560 --> 01:02:27,270
take maybe this one here this on the
bottom

1182
01:02:27,270 --> 01:02:30,950
and now we do a lookup I against that IP
address

1183
01:02:30,950 --> 01:02:35,550
and see what names point to it at so we
see

1184
01:02:35,550 --> 01:02:38,859
they also use game axis dot com more

1185
01:02:38,859 --> 01:02:42,720
I had no won a Pulitzer Center heart
wears on that as G and you know

1186
01:02:42,720 --> 01:02:44,349
different domain names now in this case

1187
01:02:44,349 --> 01:02:48,390
this probably pretty boring but for
other for other applications for maybe

1188
01:02:48,390 --> 01:02:51,579
you know more malicious sites or share
toasters are something you will find

1189
01:02:51,579 --> 01:02:54,060
lots of weird to me names pointing to
the same IP address

1190
01:02:54,060 --> 01:02:57,119
I think for rapid seven its also quite
funny

1191
01:02:57,119 --> 01:03:01,250
on and see it Rep its seven the

1192
01:03:01,250 --> 01:03:06,579
com so if we take one of the IP address
is here

1193
01:03:06,579 --> 01:03:09,859
think this one might be a

1194
01:03:09,859 --> 01:03:13,859
and we do the same thing I

1195
01:03:13,859 --> 01:03:17,720
your friends like lots of two main aims
that

1196
01:03:17,720 --> 01:03:21,510
rapid7 likes to a register that

1197
01:03:21,510 --> 01:03:25,079
unified vulnerability management thought
or something

1198
01:03:25,079 --> 01:03:27,700
I never knew that we had these domain
names right and sometimes just

1199
01:03:27,700 --> 01:03:28,950
interesting what your

1200
01:03:28,950 --> 01:03:32,230
have what your IP addresses that you
have in your organization I also use for

1201
01:03:32,230 --> 01:03:33,680
what kind of names to point to them

1202
01:03:33,680 --> 01:03:37,660
sometimes not even your own address this
we've seen stuff we're just people point

1203
01:03:37,660 --> 01:03:39,490
their DNS records to our servers

1204
01:03:39,490 --> 01:03:43,020
for whatever reason some truly useful
but they do it anyway so

1205
01:03:43,020 --> 01:03:47,609
I mean there are some day there are
dozens of use cases for this kind of

1206
01:03:47,609 --> 01:03:48,180
data set

1207
01:03:48,180 --> 01:03:52,410
I hope if anyone wants to see more not
just come to me afterwards but I'll

1208
01:03:52,410 --> 01:03:53,240
32 states now

