1
00:00:00,370 --> 00:00:03,530
so I'm Andy Davis research stretcher NCC
group

2
00:00:03,530 --> 00:00:06,940
and we're gonna be talking today about
its USB

3
00:00:06,940 --> 00:00:09,960
and more specifically had to extend

4
00:00:09,960 --> 00:00:13,650
USB attacks which traditionally have
been local

5
00:00:13,650 --> 00:00:17,010
physical access attacks over network

6
00:00:17,010 --> 00:00:20,830
I'm as you might see a quite an array
have

7
00:00:20,830 --> 00:00:25,480
equipment here and some hope its timber
live demos eye-popping come over stretch

8
00:00:25,480 --> 00:00:26,330
myself air

9
00:00:26,330 --> 00:00:30,490
aka taken videos are the demos but hey
that any cheating so

10
00:00:30,490 --> 00:00:33,760
hopefully fingers crossed all the time
is going to work

11
00:00:33,760 --> 00:00:37,840
I'm but it involves gonna like moving
cameras around and me putting microphone

12
00:00:37,840 --> 00:00:40,030
and I'm so well we'll see how it goes
but

13
00:00:40,030 --> 00:00:44,280
stick with it will work okay

14
00:00:44,280 --> 00:00:48,250
so am festival we gonna talk about what
the

15
00:00:48,250 --> 00:00:52,000
well the main problem with us. the boxes
and was a problem this is Conniff

16
00:00:52,000 --> 00:00:57,520
the the main reaction I get from people
when I demonstrate USB bucks

17
00:00:57,520 --> 00:01:02,399
then move on to talk about how I go
about identifying USB bucks

18
00:01:02,399 --> 00:01:05,400
a been looking at them for a number of
years come up with a range of different

19
00:01:05,400 --> 00:01:07,210
approaches for finding bugs

20
00:01:07,210 --> 00:01:11,270
saw go through some of those talk about
to my experiences many things that I

21
00:01:11,270 --> 00:01:11,810
find

22
00:01:11,810 --> 00:01:15,320
than demo an r7

23
00:01:15,320 --> 00:01:18,850
bug that was patched in the Patras
Greece the other day

24
00:01:18,850 --> 00:01:22,939
well then talk about gonna the first

25
00:01:22,939 --> 00:01:26,860
stay each of me trying to move away from
physical access with

26
00:01:26,860 --> 00:01:31,159
their with USB I came up with this kinda
concepts using Bluetooth

27
00:01:31,159 --> 00:01:35,040
is a bit of a contrived example what
you're gonna see why why when in that

28
00:01:35,040 --> 00:01:35,670
direction

29
00:01:35,670 --> 00:01:39,200
and we'll do another demo and then
finally

30
00:01:39,200 --> 00:01:42,649
will talk about the yeah kinda fell on
promoting

31
00:01:42,649 --> 00:01:47,049
of USB attacks hopefully do a demo that
works perfectly

32
00:01:47,049 --> 00:01:50,210
I'll talk about what the implications
are and then

33
00:01:50,210 --> 00:01:53,680
we can do to prevent people 19 these gun
attacks

34
00:01:53,680 --> 00:01:57,710
so the problem with USB bucks

35
00:01:57,710 --> 00:02:03,009
'em obviously tradition the physical
access is required

36
00:02:03,009 --> 00:02:06,899
I find in reported many many USB bucks
over the years

37
00:02:06,899 --> 00:02:11,430
and the normal response that you get
from vendors is your air while you know

38
00:02:11,430 --> 00:02:13,239
you need physical access

39
00:02:13,239 --> 00:02:17,629
you need to get to get to the box unplug
something in big deal it's gonna have

40
00:02:17,629 --> 00:02:21,629
code execution implications but you know
she got physical access the boxing do

41
00:02:21,629 --> 00:02:22,489
you like right

42
00:02:22,489 --> 00:02:25,550
um so vendors I

43
00:02:25,550 --> 00:02:29,099
similar mom really interested at all
others kinda understand what you tryin

44
00:02:29,099 --> 00:02:29,860
guess at

45
00:02:29,860 --> 00:02:33,370
and local bike certainly have their
place and

46
00:02:33,370 --> 00:02:37,129
the I think the thing that people don't
tend to realize

47
00:02:37,129 --> 00:02:40,940
is how to yes you need physical access
but hi who

48
00:02:40,940 --> 00:02:45,950
little time he needs to actually perform
something malicious using a USB device

49
00:02:45,950 --> 00:02:50,690
so the majority of the bugs that I find

50
00:02:50,690 --> 00:02:54,160
am have been associated with the
enumeration face

51
00:02:54,160 --> 00:02:57,659
so any plugin any USB device the

52
00:02:57,659 --> 00:03:01,480
the host the you're connected to doesn't
know anything about device now has to go

53
00:03:01,480 --> 00:03:03,310
through this phase clean numeration

54
00:03:03,310 --> 00:03:06,989
where it second a question and answer
session between the host

55
00:03:06,989 --> 00:03:11,180
and the device to try and finite what
type of device class it is you know is

56
00:03:11,180 --> 00:03:11,540
it is

57
00:03:11,540 --> 00:03:15,239
a mass storage device is it a printer is
the camera my kind of thing

58
00:03:15,239 --> 00:03:18,980
then you know what what speed doesn't
want to run outs

59
00:03:18,980 --> 00:03:22,090
and what kinda capabilities does it have

60
00:03:22,090 --> 00:03:26,360
and some and also working approach coles
is they want to talk

61
00:03:26,360 --> 00:03:30,209
once the that that the driver has been
noted by by the host OS

62
00:03:30,209 --> 00:03:33,709
and during the whole phase a
communication as I have a lot of data

63
00:03:33,709 --> 00:03:35,440
that's exchange between host

64
00:03:35,440 --> 00:03:38,890
and the device and the device and host
and therefore

65
00:03:38,890 --> 00:03:42,459
um it's quite easy to what would you
have

66
00:03:42,459 --> 00:03:46,739
develops the become a fundamental
capability of providing USB

67
00:03:46,739 --> 00:03:49,890
data from a row device

68
00:03:49,890 --> 00:03:54,230
back to host there's lots of areas where
you can provide malformed eight er

69
00:03:54,230 --> 00:03:57,409
that triggers crushes suffer flaws

70
00:03:57,409 --> 00:04:00,769
many of which are exploitable I'm

71
00:04:00,769 --> 00:04:04,180
so that as I'm sure you're aware having

72
00:04:04,180 --> 00:04:07,840
used USB devices the numeration faces a
matter of seconds

73
00:04:07,840 --> 00:04:11,879
from the point to put plugging in the
device up to when is working

74
00:04:11,879 --> 00:04:15,610
is a is only a few seconds and is during
that period of time

75
00:04:15,610 --> 00:04:21,449
that if you I'm triggered a and
Southwest or in the passing about data

76
00:04:21,449 --> 00:04:24,460
and which was exploitable to execute
arbitrary code

77
00:04:24,460 --> 00:04:27,690
you could then execute code purely by
inserting the device

78
00:04:27,690 --> 00:04:31,000
so that's the kind of story that I tells
the vendors someone get it some them

79
00:04:31,000 --> 00:04:32,180
don't

80
00:04:32,180 --> 00:04:37,120
but it's been a a a long battle

81
00:04:37,120 --> 00:04:42,180
so here are a few of the examples the
bugs that are fined over the last few

82
00:04:42,180 --> 00:04:43,479
years

83
00:04:43,479 --> 00:04:48,400
I'm going matter 2011 when in nurse
ansel Rs

84
00:04:48,400 --> 00:04:51,750
all these by the way resulted would
result

85
00:04:51,750 --> 00:04:55,860
in potential code execution by the
attack a

86
00:04:55,860 --> 00:04:59,310
I'm a point either I'm

87
00:04:59,310 --> 00:05:03,810
might my kinda fail expertise is finding
bucks not much you biting the exploits

88
00:05:03,810 --> 00:05:05,190
to exploit these bugs

89
00:05:05,190 --> 00:05:08,229
so you know i'd a spend my time writing
fathers

90
00:05:08,229 --> 00:05:11,830
generating crash test cases for people
to end of untriaged

91
00:05:11,830 --> 00:05:15,419
and that right exploit coats on know
kinda for certainly

92
00:05:15,419 --> 00:05:18,610
when it comes to colonel level stuff I'm
Unohana not know

93
00:05:18,610 --> 00:05:21,740
ready and explode exploit writer I'm

94
00:05:21,740 --> 00:05:25,580
having said that if I provides these
crush them details from my father to you

95
00:05:25,580 --> 00:05:26,729
via

96
00:05:26,729 --> 00:05:30,199
p.m. the vendor in the vendor comes back
and says yep Curtis

97
00:05:30,199 --> 00:05:34,570
execution was possible than that
somebody could potentially write code

98
00:05:34,570 --> 00:05:39,650
malicious code in a and USB device to to
exploit so these conditions

99
00:05:39,650 --> 00:05:42,970
so is you can say you know they're
they're all pretty modern operating

100
00:05:42,970 --> 00:05:44,800
system that sends rs1 was

101
00:05:44,800 --> 00:05:49,389
sounds are solarz 11 when

102
00:05:49,389 --> 00:05:52,430
so one

103
00:05:52,430 --> 00:05:56,680
I think the reason that we're still
finding USB bucks is it sir

104
00:05:56,680 --> 00:06:01,419
a relatively new failed am as you'll see
in the next couple slides is not

105
00:06:01,419 --> 00:06:05,080
something the candy purely with software
you need a hardware component in order

106
00:06:05,080 --> 00:06:07,190
to test the USB host

107
00:06:07,190 --> 00:06:10,840
it's very different if you're testing a
USB device like a 50 min or rum

108
00:06:10,840 --> 00:06:14,740
camera printer that kind of thing I'm
you can do that purely from software

109
00:06:14,740 --> 00:06:18,789
but in order to pretend to be a USB
device

110
00:06:18,789 --> 00:06:23,360
and plug into a host like a I'm a server
laptop that kind of thing

111
00:06:23,360 --> 00:06:28,770
I'm you need a hardware component

112
00:06:28,770 --> 00:06:33,410
so I him back in 2011

113
00:06:33,410 --> 00:06:37,539
and I have my first attempt at

114
00:06:37,539 --> 00:06:40,780
creating some hard to estimate USB
devices

115
00:06:40,780 --> 00:06:44,410
and used an Arduino microcontroller

116
00:06:44,410 --> 00:06:47,979
so the father that i right was a basic

117
00:06:47,979 --> 00:06:51,569
in CPS bus controlling his mark
controller I'm

118
00:06:51,569 --> 00:06:57,770
because the mark controller wasn't
particularly powerful automatically fast

119
00:06:57,770 --> 00:07:03,110
on I was only able to emulate USB
low-speed devices like hit devices

120
00:07:03,110 --> 00:07:06,460
so them human interface devices things
like

121
00:07:06,460 --> 00:07:10,099
mice keyboards kinda thing

122
00:07:10,099 --> 00:07:13,849
and NIDA NIH for kind of semi-automated
fizzing

123
00:07:13,849 --> 00:07:17,740
am having said that it did find some
pretty high-profile bugs

124
00:07:17,740 --> 00:07:20,830
and it kinda justified to May and

125
00:07:20,830 --> 00:07:23,910
to my management that provided me with
the funds

126
00:07:23,910 --> 00:07:28,530
but I could continue doing some research
in this area by some more equipment

127
00:07:28,530 --> 00:07:32,139
and so I needed to move on from from
this and buy something a bit more

128
00:07:32,139 --> 00:07:33,039
powerful

129
00:07:33,039 --> 00:07:38,990
to allow me to the fuzz faster devices

130
00:07:38,990 --> 00:07:42,419
so in 2012 I identified a

131
00:07:42,419 --> 00:07:47,020
this a test equipment which ahead does
not much it looks like it's basic at the

132
00:07:47,020 --> 00:07:48,650
bar from Radio Shack but

133
00:07:48,650 --> 00:07:51,720
it's actually pretty powerful box and is
produced by

134
00:07:51,720 --> 00:07:55,520
a company in the UK and Tom

135
00:07:55,520 --> 00:08:00,110
what is essentially allows you to do is
capture

136
00:08:00,110 --> 00:08:03,599
in a kind of a proxy tight fashion am

137
00:08:03,599 --> 00:08:09,190
USB device between a that USB data
between a device and a host

138
00:08:09,190 --> 00:08:13,509
so it's kinda like Wireshark four USB in
a hardware device

139
00:08:13,509 --> 00:08:16,750
but the beauty of its was when chief
captured all these

140
00:08:16,750 --> 00:08:20,940
packets associated with the interaction
have a USB device and host

141
00:08:20,940 --> 00:08:24,220
its cuz I'm built-in scripting language
that would allow you to

142
00:08:24,220 --> 00:08:28,180
replicates and replay that session that
you just captured

143
00:08:28,180 --> 00:08:31,900
which is great for opposing perspectives
because I was then able to

144
00:08:31,900 --> 00:08:38,390
modify that data and right right to fuzz
a base trying this particular test kit

145
00:08:38,390 --> 00:08:42,339
um unfortunately the scripting language
itself wasn't powerful enough to write

146
00:08:42,339 --> 00:08:42,909
the father

147
00:08:42,909 --> 00:08:47,010
in and unfortunately there was no
software API

148
00:08:47,010 --> 00:08:51,110
to control the other test equipment or I
ended up having to do

149
00:08:51,110 --> 00:08:54,470
was inject Windows events into

150
00:08:54,470 --> 00:08:59,930
the M did that to give the software
Windows GUI software that came with it

151
00:08:59,930 --> 00:09:04,350
am using Python wrapping Python I and in
spawning in modifying the

152
00:09:04,350 --> 00:09:07,740
there um the and

153
00:09:07,740 --> 00:09:11,970
generate a file script every time in
getting in to reply it has been an OK

154
00:09:11,970 --> 00:09:12,800
hack but it

155
00:09:12,800 --> 00:09:16,760
it certainly worked at find a huge
amount of fat %uh the USB bucks now I

156
00:09:16,760 --> 00:09:18,540
have the capability to fuzz

157
00:09:18,540 --> 00:09:24,959
faster hosts at all emulates faster
devices rather

158
00:09:24,959 --> 00:09:29,540
but a course one other well along with
those limitations that are taught to buy

159
00:09:29,540 --> 00:09:31,200
another limitation most

160
00:09:31,200 --> 00:09:34,540
you actually had taught an example of a
teacher the devices

161
00:09:34,540 --> 00:09:38,050
that you wanted to I'm to play it's
literally a

162
00:09:38,050 --> 00:09:41,130
a mutation based father saying a

163
00:09:41,130 --> 00:09:44,170
you have the device you plug it in you
record

164
00:09:44,170 --> 00:09:48,140
a session and then you can't meet a tip
based on them how you want what you want

165
00:09:48,140 --> 00:09:51,160
to fuss

166
00:09:51,160 --> 00:09:54,660
so the latest iteration of buzzing is

167
00:09:54,660 --> 00:09:58,940
using a border faced an support as has
developed by Travis Goodspeed

168
00:09:58,940 --> 00:10:04,050
in the US and Tom essentially what a lie
she's do

169
00:10:04,050 --> 00:10:08,510
is emulates USB devices in Python

170
00:10:08,510 --> 00:10:12,399
so I as long as you understand

171
00:10:12,399 --> 00:10:16,339
and the details of the different
protocols associated with a different

172
00:10:16,339 --> 00:10:18,550
device classes

173
00:10:18,550 --> 00:10:22,089
you think using Python code you can
virtualize

174
00:10:22,089 --> 00:10:25,510
any different USB device class and

175
00:10:25,510 --> 00:10:29,420
send data associated with it so no
longer t need to do their

176
00:10:29,420 --> 00:10:33,529
kinda mutation based buzzing having
captured from a real device you can just

177
00:10:33,529 --> 00:10:34,680
spawn up

178
00:10:34,680 --> 00:10:37,980
a.m. I'm virtualized

179
00:10:37,980 --> 00:10:42,029
USB device if your choice and me take
the data

180
00:10:42,029 --> 00:10:46,310
I'm as you like during the animation
phase or chewing the

181
00:10:46,310 --> 00:10:49,560
class specific phase after enumeration
in the house

182
00:10:49,560 --> 00:10:54,560
understands what that the devices and
understand what language it can talk to

183
00:10:54,560 --> 00:10:55,730
that device

184
00:10:55,730 --> 00:10:59,300
so then you're talking about class
specific communication and

185
00:10:59,300 --> 00:11:03,320
to find bugs and not as well so it's a
pretty powerful way of doing it

186
00:11:03,320 --> 00:11:07,120
and the the toll that all rights you map
which controls faced answer

187
00:11:07,120 --> 00:11:11,310
as available on get help I released it

188
00:11:11,310 --> 00:11:15,019
black hat USA last year and some

189
00:11:15,019 --> 00:11:20,010
its it's something that will develop
over time at the moment is a killer

190
00:11:20,010 --> 00:11:24,779
a reasonable listo firm kinda base
classes

191
00:11:24,779 --> 00:11:28,160
device classes that allows you to
confirm

192
00:11:28,160 --> 00:11:32,360
pretend to be those two to fit different
devices and by some I can expertise over

193
00:11:32,360 --> 00:11:33,190
the years have

194
00:11:33,190 --> 00:11:36,920
what types of mutations within the
enumeration phase in the

195
00:11:36,920 --> 00:11:40,410
Aktas Pacific phase trigger bugs

196
00:11:40,410 --> 00:11:43,720
I've created a whole bunch of test cases
that then applied to these different

197
00:11:43,720 --> 00:11:44,730
protocols

198
00:11:44,730 --> 00:11:50,579
subtle there any container that and a
new stuff

199
00:11:50,579 --> 00:11:54,240
so most recently I am on this

200
00:11:54,240 --> 00:11:57,240
their advisory for this went out last
week

201
00:11:57,240 --> 00:12:01,980
you map identify its arbitrary code
execution in of seven

202
00:12:01,980 --> 00:12:06,670
says pretty powerful stuff i mean if at
if somebody actually read an exploit

203
00:12:06,670 --> 00:12:09,760
exploit this particular vulnerability
were talking about tethered jailbreak

204
00:12:09,760 --> 00:12:10,410
here

205
00:12:10,410 --> 00:12:14,620
so some the fact that these kinda things
are still there

206
00:12:14,620 --> 00:12:19,139
and they can be find with you know open
source tools

207
00:12:19,139 --> 00:12:24,279
Dino team up in a play with it you never
know what you might find

208
00:12:24,279 --> 00:12:27,300
at my iPad I've got here is still
running

209
00:12:27,300 --> 00:12:31,200
an older version Aviles so basically any

210
00:12:31,200 --> 00:12:35,220
version allows prior to 7.1 is
vulnerable to this bug

211
00:12:35,220 --> 00:12:39,089
solder quick demo showing you what

212
00:12:39,089 --> 00:12:43,170
how to use a you map and also hopefully
triggering a bygone

213
00:12:43,170 --> 00:12:46,779
iPod

214
00:12:46,779 --> 00:12:50,209
and because my a.m. resolution was
forced to

215
00:12:50,209 --> 00:12:54,560
1024 by 768 everything's gonna be a bit
squashed on the screen

216
00:12:54,560 --> 00:13:00,870
am so

217
00:13:00,870 --> 00:13:06,120
what I've got is miss my face as my face
down support

218
00:13:06,120 --> 00:13:10,139
and that's connected when did that is
cut into my laptop here

219
00:13:10,139 --> 00:13:13,760
the other end is connected

220
00:13:13,760 --> 00:13:18,880
into please bring up this camera

221
00:13:18,880 --> 00:13:21,930
into the there

222
00:13:21,930 --> 00:13:25,430
so you can see it's yes be connected
into their

223
00:13:25,430 --> 00:13:32,430
and says point that screener

224
00:13:32,459 --> 00:13:35,529
K so I'm

225
00:13:35,529 --> 00:13:40,180
first thing to show you with him up and

226
00:13:40,180 --> 00:13:43,630
if you do you up minus Elm yeah

227
00:13:43,630 --> 00:13:47,610
it's good to see you there I K well you
get the idea so basically what is

228
00:13:47,610 --> 00:13:51,440
showing you here is a lot different
device class is that it supports

229
00:13:51,440 --> 00:13:54,940
so I within USB the class information is

230
00:13:54,940 --> 00:13:58,399
I'm specified by three from bites

231
00:13:58,399 --> 00:14:01,970
see you got the base class the subclass

232
00:14:01,970 --> 00:14:05,199
and then the protocol that's used say
the

233
00:14:05,199 --> 00:14:10,470
each lying on here is a different time
different type device

234
00:14:10,470 --> 00:14:14,290
so if we take am this one for example

235
00:14:14,290 --> 00:14:17,500
to the base class for printer is severn

236
00:14:17,500 --> 00:14:20,540
and subclasses while much as the default

237
00:14:20,540 --> 00:14:23,730
and the protocol is by directional
interface

238
00:14:23,730 --> 00:14:27,930
so you can specify that you want to
emulate one of these

239
00:14:27,930 --> 00:14:31,230
devices and plug it virtually plug it

240
00:14:31,230 --> 00:14:34,680
into the M the iPod

241
00:14:34,680 --> 00:14:37,839
so the first thing

242
00:14:37,839 --> 00:14:41,230
that I'll demo actually is

243
00:14:41,230 --> 00:14:45,230
if you just a minus RI it will iterate
through

244
00:14:45,230 --> 00:14:50,160
all those different device classes that
the map supports

245
00:14:50,160 --> 00:14:54,000
and just try them so I'll see whether
they the host the you're connected to

246
00:14:54,000 --> 00:14:56,110
actually understands that device

247
00:14:56,110 --> 00:15:00,170
serve him on a spy

248
00:15:00,170 --> 00:15:07,170
and French if we keeping our eye the
screen

249
00:15:10,180 --> 00:15:13,470
TTT in his quest aka

250
00:15:13,470 --> 00:15:17,649
as you can see is not superfast goes
reach one maybe takes

251
00:15:17,649 --> 00:15:21,570
by its seven to 10 seconds her

252
00:15:21,570 --> 00:15:28,570
and device that its emulating is going
through the whole enumeration phase

253
00:15:28,920 --> 00:15:33,220
an they see see messages coming up on
the iPod

254
00:15:33,220 --> 00:15:39,949
so cannot use this device doesn't
understand mister USB device

255
00:15:39,949 --> 00:15:46,949
device not supported

256
00:15:54,310 --> 00:15:58,149
so when it does eventually find one that
is supported change they will be very

257
00:15:58,149 --> 00:15:59,250
soon

258
00:15:59,250 --> 00:16:02,540
recapping

259
00:16:02,540 --> 00:16:07,170
si conseguir it understands hit devices

260
00:16:07,170 --> 00:16:10,630
it understands image devices

261
00:16:10,630 --> 00:16:14,600
in fact when it thought we plugged in an
image device am

262
00:16:14,600 --> 00:16:19,160
it tried to display the

263
00:16:19,160 --> 00:16:22,610
M the photos on my image device within
the iPod

264
00:16:22,610 --> 00:16:26,990
so it's kind of like

265
00:16:26,990 --> 00:16:31,050
em up for USB hence the name he map in
this sense

266
00:16:31,050 --> 00:16:36,050
for Mac convert discovery perspective is
identifying which of the protocols are

267
00:16:36,050 --> 00:16:36,760
supported

268
00:16:36,760 --> 00:16:43,760
before we actually go ahead and do any
fuzzing tttt

269
00:16:45,149 --> 00:16:48,180
need and this is the last

270
00:16:48,180 --> 00:16:51,510
so we can see there that

271
00:16:51,510 --> 00:16:55,410
it supports hid devices keyboards mice
like nothing

272
00:16:55,410 --> 00:16:59,110
image devices the cameras a mass storage
devices

273
00:16:59,110 --> 00:17:03,370
so USB sticks memory sticks like a thing
now I'm

274
00:17:03,370 --> 00:17:06,750
the particular bug

275
00:17:06,750 --> 00:17:10,770
that term that I discovered nr7

276
00:17:10,770 --> 00:17:14,439
was actually in class specific
information am

277
00:17:14,439 --> 00:17:18,770
and applied to my storage device Siam

278
00:17:18,770 --> 00:17:22,480
well-to-do I think Capri

279
00:17:22,480 --> 00:17:29,480
still got it in I G

280
00:17:33,360 --> 00:17:35,130
just in okay

281
00:17:35,130 --> 00:17:38,799
so with you can deduct them on a Sat
option which you go through phones

282
00:17:38,799 --> 00:17:40,440
religion test cases

283
00:17:40,440 --> 00:17:44,070
within I'm a test case file by Noah

284
00:17:44,070 --> 00:17:47,210
a specific one the trick is this bug so

285
00:17:47,210 --> 00:17:52,840
if on a she use

286
00:17:52,840 --> 00:17:56,399
the device class mass storage devices

287
00:17:56,399 --> 00:18:01,210
0h 06 50

288
00:18:01,210 --> 00:18:05,010
actually this is an enumeration face not
last specific

289
00:18:05,010 --> 00:18:08,179
enumeration phase I know this test case

290
00:18:08,179 --> 00:18:13,059
45 so for me that across he can

291
00:18:13,059 --> 00:18:16,519
keep an eye on the video screener

292
00:18:16,519 --> 00:18:23,370
a fine ass on this fingers crossed

293
00:18:23,370 --> 00:18:26,590
me just double check a thats

294
00:18:26,590 --> 00:18:29,870
case is sending a test case

295
00:18:29,870 --> 00:18:33,970
and pool there we go kernel panic so

296
00:18:33,970 --> 00:18:38,860
that's just repeated the iPad Mini
Aussie the Apple symbols is restarting

297
00:18:38,860 --> 00:18:39,260
their

298
00:18:39,260 --> 00:18:42,340
I'm night demos go

299
00:18:42,340 --> 00:18:45,389
some particular exciting but into the
day

300
00:18:45,389 --> 00:18:48,809
showing the fact that purely by sending
a

301
00:18:48,809 --> 00:18:51,870
Roddick um communication

302
00:18:51,870 --> 00:18:55,899
via USB to and that the iPad via

303
00:18:55,899 --> 00:18:59,230
by USB it causes a kernel panic and BBC
device

304
00:18:59,230 --> 00:19:02,830
another set up a confirm that this is
actually an exploitable

305
00:19:02,830 --> 00:19:06,760
vulnerability that would result in
arbitrary code execution

306
00:19:06,760 --> 00:19:09,929
in the kernel so

307
00:19:09,929 --> 00:19:14,149
meeting on

308
00:19:14,149 --> 00:19:19,380
so

309
00:19:19,380 --> 00:19:23,630
can in is me such as an example love

310
00:19:23,630 --> 00:19:26,789
view map and how I find USB bucks 'em

311
00:19:26,789 --> 00:19:30,470
so annexing was okay how can I move away
from

312
00:19:30,470 --> 00:19:34,139
it being some kind of physical access 01
I want to be able to do this to from a

313
00:19:34,139 --> 00:19:34,590
plea

314
00:19:34,590 --> 00:19:38,070
I'm and back in 2011

315
00:19:38,070 --> 00:19:41,130
I discovered a a bug in

316
00:19:41,130 --> 00:19:44,590
I own versions of Windows in hypothesis

317
00:19:44,590 --> 00:19:47,770
so when you plug in your head device um

318
00:19:47,770 --> 00:19:53,770
he a keyboard for example as part of
that communication that happens in the

319
00:19:53,770 --> 00:19:55,000
animation phase

320
00:19:55,000 --> 00:19:59,690
I think order a hit report descriptor
has sent which basically talks about the

321
00:19:59,690 --> 00:20:01,409
capabilities of the head device

322
00:20:01,409 --> 00:20:04,419
um you know what kind of keep all the
day's

323
00:20:04,419 --> 00:20:09,380
how the keys a map it on that device and
the a.m

324
00:20:09,380 --> 00:20:12,580
what kind what language cable today's

325
00:20:12,580 --> 00:20:16,490
all kinds of stuff like that um and
identified

326
00:20:16,490 --> 00:20:20,850
if you specified as a certain value
within a certain failed an airhead

327
00:20:20,850 --> 00:20:21,840
report descriptor

328
00:20:21,840 --> 00:20:25,409
it created a logic Cara that resulted

329
00:20:25,409 --> 00:20:30,210
in an open today reference night I sent
this to Microsoft and

330
00:20:30,210 --> 00:20:33,260
they were particularly interested in
fair enough you know I could plug in a

331
00:20:33,260 --> 00:20:35,990
device which or bluescreen any Windows
box but

332
00:20:35,990 --> 00:20:39,330
is an open to the reference so it's some

333
00:20:39,330 --> 00:20:43,130
not particularly exciting is all
exploitable iconic security code %uh can

334
00:20:43,130 --> 00:20:44,549
just blue screen the box

335
00:20:44,549 --> 00:20:48,429
you might as well just power the machine
off if you can she got physical access

336
00:20:48,429 --> 00:20:48,850
to

337
00:20:48,850 --> 00:20:52,899
um however

338
00:20:52,899 --> 00:20:57,520
INS to say screenshot be screened

339
00:20:57,520 --> 00:21:02,720
showing it powers still says triggers
many steps tell every version of Windows

340
00:21:02,720 --> 00:21:04,100
is abominable to this

341
00:21:04,100 --> 00:21:07,909
I'm so

342
00:21:07,909 --> 00:21:11,120
I was anyone else eases hit report the
Scriptures Bob

343
00:21:11,120 --> 00:21:14,340
Bluetooth keyboards day um powerful

344
00:21:14,340 --> 00:21:18,720
well show only Microsoft wouldn't have a
separate head

345
00:21:18,720 --> 00:21:23,080
passing routine for Bluetooth keyboards
anti-u_s_ be

346
00:21:23,080 --> 00:21:27,629
so maybe this bug but I find that it was
in your

347
00:21:27,629 --> 00:21:30,669
USB would also be valid for

348
00:21:30,669 --> 00:21:36,419
beauties I'm because that the report
descriptor has to be passed in exactly

349
00:21:36,419 --> 00:21:38,899
the same way as when you plug a USB
keyboard

350
00:21:38,899 --> 00:21:42,539
I'm so you know I know this is an USB

351
00:21:42,539 --> 00:21:47,549
and this was kind of like on describing
my thought process to try and move to a

352
00:21:47,549 --> 00:21:49,340
remote scenario here so I'm just

353
00:21:49,340 --> 00:21:52,409
can give you an example earth this thing
that I did next

354
00:21:52,409 --> 00:21:55,889
oh yeah

355
00:21:55,889 --> 00:21:59,919
and as a complete aside I am set one up
a demonstrated

356
00:21:59,919 --> 00:22:03,919
the year summer the USB bucks so when my
clients and they're interested to know

357
00:22:03,919 --> 00:22:08,470
he ok largest producer little simple
device I keep in my pocket and plugin

358
00:22:08,470 --> 00:22:12,669
and to to trigger some of these bugs and
I have a spare art we know

359
00:22:12,669 --> 00:22:16,919
and I'm various the bugs that that I
created

360
00:22:16,919 --> 00:22:20,750
I at just hardcoded into the outgoing is
like it just kind of

361
00:22:20,750 --> 00:22:24,539
one rump like this device in I'm I would
have brought it with me

362
00:22:24,539 --> 00:22:27,690
but I'm a brat nervous about taking
through airports

363
00:22:27,690 --> 00:22:31,450
I am people might think it does
something else

364
00:22:31,450 --> 00:22:36,520
especially in the US and

365
00:22:36,520 --> 00:22:41,529
so okay let's go for a plea teeth demo

366
00:22:41,529 --> 00:22:45,679
so what I've got here

367
00:22:45,679 --> 00:22:51,520
scat video scream backup

368
00:22:51,520 --> 00:22:58,010
K

369
00:22:58,010 --> 00:23:05,010
K so me just log into this

370
00:23:39,769 --> 00:23:42,509
okay so we've got here is I'm

371
00:23:42,509 --> 00:23:45,539
a.m. Microsoft surface tablet

372
00:23:45,539 --> 00:23:48,799
running Windows 8.1

373
00:23:48,799 --> 00:23:52,809
latest version tightly patched up I'm

374
00:23:52,809 --> 00:23:56,710
1 I've got here

375
00:23:56,710 --> 00:24:00,369
is up to burning Ubuntu where

376
00:24:00,369 --> 00:24:04,299
I I'm going to emulate a USB

377
00:24:04,299 --> 00:24:07,669
am8 abilities keyboard and Tom

378
00:24:07,669 --> 00:24:11,429
as a nah still SoCal hit a line that was
written by somebody else not me

379
00:24:11,429 --> 00:24:15,259
and within their you couldn't specify
all the details within the report

380
00:24:15,259 --> 00:24:15,940
descriptor

381
00:24:15,940 --> 00:24:19,909
circus or modify that report descriptor
to be the militias 1

382
00:24:19,909 --> 00:24:23,659
the trick at the park over USB site

383
00:24:23,659 --> 00:24:30,659
if I and the hit client

384
00:24:32,330 --> 00:24:36,039
so that's my pretending to be

385
00:24:36,039 --> 00:24:39,690
APT's keyboard and I moved over to my

386
00:24:39,690 --> 00:24:43,899
surface tablet and click

387
00:24:43,899 --> 00:24:50,899
at a Bluetooth device

388
00:24:59,280 --> 00:25:01,450
skid to list on

389
00:25:01,450 --> 00:25:04,670
okay so there's the keyboard this is
mine

390
00:25:04,670 --> 00:25:09,210
emulated keep old and say I want to pair
with that

391
00:25:09,210 --> 00:25:14,380
okay

392
00:25:14,380 --> 00:25:19,020
does the passcode match yes

393
00:25:19,020 --> 00:25:24,910
is the passcode match yes

394
00:25:24,910 --> 00:25:28,950
K what's happened it's blue screened

395
00:25:28,950 --> 00:25:32,800
now I know what you're thinking

396
00:25:32,800 --> 00:25:36,730
I have to pair with it so you know I had
to type in

397
00:25:36,730 --> 00:25:40,430
the code on each machine which is why
it's a contrived example

398
00:25:40,430 --> 00:25:44,170
but it kind of goes to show where where
I was going with this

399
00:25:44,170 --> 00:25:48,170
and the next thing I thought was okay
can you send it the legitimate

400
00:25:48,170 --> 00:25:53,890
um report descriptor and the first time
when you pair

401
00:25:53,890 --> 00:25:57,010
and then when chill paired with it can
you swap it for the

402
00:25:57,010 --> 00:26:00,630
malicious report descriptor so next time
you use the keyboard hit the screens

403
00:26:00,630 --> 00:26:03,710
unfortunate doesn't so that was kinda

404
00:26:03,710 --> 00:26:07,580
back to square one but a much to move
slightly away from meh

405
00:26:07,580 --> 00:26:10,870
from physical access so gt2

406
00:26:10,870 --> 00:26:17,870
repeat this for the next time

407
00:26:42,390 --> 00:26:49,390
hey there

408
00:26:58,850 --> 00:27:05,850
I K believe that too to repeat

409
00:27:11,990 --> 00:27:17,350
K right so I see you're all totally
blown away by that

410
00:27:17,350 --> 00:27:20,740
fantastic Demi it does get better honest

411
00:27:20,740 --> 00:27:24,680
okay so a thought

412
00:27:24,680 --> 00:27:28,890
how how we gonna get this USB remote
it's the must be a way of doing it

413
00:27:28,890 --> 00:27:31,910
and of the party PRD peas they're kind
of

414
00:27:31,910 --> 00:27:35,240
way that everybody remote into Windows
machines these days

415
00:27:35,240 --> 00:27:38,440
um and I remembered that you know there
was

416
00:27:38,440 --> 00:27:42,840
law so different things also different
devices and capabilities that you could

417
00:27:42,840 --> 00:27:43,630
remote

418
00:27:43,630 --> 00:27:48,340
from a client to a server when he
connected via RDP

419
00:27:48,340 --> 00:27:52,300
and I'm these are known as

420
00:27:52,300 --> 00:27:56,830
high-level redirection capabilities as
the count legacy capabilities a

421
00:27:56,830 --> 00:28:00,000
a body P that have been developed over
the years

422
00:28:00,000 --> 00:28:05,160
um and de con have grown organically
it's almost like care

423
00:28:05,160 --> 00:28:10,980
Microsoft gonna added the ability to
remote your printer and then a user said

424
00:28:10,980 --> 00:28:12,720
dole would be great if we could to know

425
00:28:12,720 --> 00:28:16,710
remote remote on local drives or remote
Asmar

426
00:28:16,710 --> 00:28:20,470
smart cards that kinda thing so I'm
Microsoft came up with all these

427
00:28:20,470 --> 00:28:21,060
different

428
00:28:21,060 --> 00:28:24,530
mechanisms for remote in things over Rd
pay

429
00:28:24,530 --> 00:28:27,750
um and

430
00:28:27,750 --> 00:28:31,560
unfortunately when you tryin remote e
USB bug

431
00:28:31,560 --> 00:28:35,690
it doesn't quite work act so what
happens

432
00:28:35,690 --> 00:28:39,660
let's say for example I'm you've got

433
00:28:39,660 --> 00:28:43,160
that a particular example with the
keyboard doesn't work to cover the

434
00:28:43,160 --> 00:28:44,370
remote a keyboard

435
00:28:44,370 --> 00:28:49,210
over Rd paper I just happened to find
another bug within a USB audio device

436
00:28:49,210 --> 00:28:52,500
and USB audio promoting

437
00:28:52,500 --> 00:28:56,100
is one of those legacy capabilities so I
thought what

438
00:28:56,100 --> 00:29:00,430
easy all I do is Sam Heights set up my
RDP client

439
00:29:00,430 --> 00:29:04,790
to to remote the USB audio connect up

440
00:29:04,790 --> 00:29:09,270
trigger buck and it did should work but
I'm fortune is is what happens

441
00:29:09,270 --> 00:29:13,080
see you plug in your iDevice when you're
RDP

442
00:29:13,080 --> 00:29:16,800
session is set up any blow yourself up

443
00:29:16,800 --> 00:29:20,590
um

444
00:29:20,590 --> 00:29:24,640
and that's because the way it works with
high-level redirection

445
00:29:24,640 --> 00:29:28,190
is it's using the the drive USB driver

446
00:29:28,190 --> 00:29:32,540
on the local machine rather than on the
server night

447
00:29:32,540 --> 00:29:36,500
theoretically if you used I am

448
00:29:36,500 --> 00:29:40,040
and RDP client that was non
windows-based

449
00:29:40,040 --> 00:29:44,610
and and used something that i'm gonna
talk about next

450
00:29:44,610 --> 00:29:49,900
I am there is a another way around this
from the way that i'm gonna described to

451
00:29:49,900 --> 00:29:51,900
you but is essentially the same kind of
thing

452
00:29:51,900 --> 00:29:56,080
but basically with high-level USB
redirection the kinda conventional way

453
00:29:56,080 --> 00:29:57,140
of doing things

454
00:29:57,140 --> 00:30:00,710
I'm you'll only ever gonna blow up
something locally

455
00:30:00,710 --> 00:30:04,260
nothing gets cents to the right remote
machine is not the remote

456
00:30:04,260 --> 00:30:08,770
and drive a USB Drive on the machine
those positing the data

457
00:30:08,770 --> 00:30:12,600
is being provided when you insert the
device into your client

458
00:30:12,600 --> 00:30:16,900
and then

459
00:30:16,900 --> 00:30:20,490
recently home relatively recently in

460
00:30:20,490 --> 00:30:24,150
competing terms last few years promoter
FX

461
00:30:24,150 --> 00:30:27,990
USB redirection was was added and

462
00:30:27,990 --> 00:30:31,150
that thought assigns a bit interesting
what's the difference between

463
00:30:31,150 --> 00:30:35,000
RemoteFX USB redirection and high-level
redirection

464
00:30:35,000 --> 00:30:39,070
or RemoteFX is used for all kinds of
things it's not just

465
00:30:39,070 --> 00:30:43,890
USB the USB redirection almost seems to
be like a a side story might affect his

466
00:30:43,890 --> 00:30:46,950
primarily fact I've in proving

467
00:30:46,950 --> 00:30:51,190
graphics capabilities over RDP sessions
doing funky things llama

468
00:30:51,190 --> 00:30:55,660
um but but yeah first certainly in
elements to it which shall I G much more

469
00:30:55,660 --> 00:30:56,490
control

470
00:30:56,490 --> 00:30:59,710
arrange USB redirection so

471
00:30:59,710 --> 00:31:05,070
us a look at this and

472
00:31:05,070 --> 00:31:09,670
fundamentally this is taken from

473
00:31:09,670 --> 00:31:13,800
where the microsoft MSDN web sites that
talks about the differences between

474
00:31:13,800 --> 00:31:17,480
the high level stuff in the RemoteFX but
fundamentally

475
00:31:17,480 --> 00:31:21,140
it's the device driver on the server

476
00:31:21,140 --> 00:31:24,860
the processing the data now I'm

477
00:31:24,860 --> 00:31:28,980
you go to make sure that the bug that
you're trying to trick a

478
00:31:28,980 --> 00:31:32,370
is in one other standard device drivers
that's gonna already be on the saffir

479
00:31:32,370 --> 00:31:33,010
otherwise

480
00:31:33,010 --> 00:31:36,820
you know gonna get anywhere so you know
it's gonna have to be a standard

481
00:31:36,820 --> 00:31:40,110
driver but fortunately the one that I'd
find

482
00:31:40,110 --> 00:31:45,000
walls in 10 the Microsoft standard
drivers

483
00:31:45,000 --> 00:31:49,940
side as you can see is open to different
differences between

484
00:31:49,940 --> 00:31:56,100
USB high-level redirection and the
RemoteFX tough

485
00:31:56,100 --> 00:31:59,270
now in order to use it I'm

486
00:31:59,270 --> 00:32:03,750
if you install RDP on Windows Server
2012

487
00:32:03,750 --> 00:32:08,430
the remote affect stuff is just there
but from a client perspective

488
00:32:08,430 --> 00:32:12,210
you need to do a bit of tweaking with
you on EP climbs in order to

489
00:32:12,210 --> 00:32:15,620
leverage this functionality so

490
00:32:15,620 --> 00:32:20,010
one within Group Policy settings

491
00:32:20,010 --> 00:32:23,010
you need to enable I'll RDP

492
00:32:23,010 --> 00:32:27,540
redirection all the supported RemoteFX
USB devices for this computer

493
00:32:27,540 --> 00:32:32,330
from this computer and the media GP
update such force

494
00:32:32,330 --> 00:32:38,080
ok so that will then tell you are deeply
client the you gonna be using

495
00:32:38,080 --> 00:32:41,530
am RemoteFX when you connect

496
00:32:41,530 --> 00:32:47,850
have to repeat your Ste your client
notify us take effect

497
00:32:47,850 --> 00:32:50,940
and then

498
00:32:50,940 --> 00:32:54,400
when you go to your configuration for
your client

499
00:32:54,400 --> 00:32:57,570
within local resources and mole

500
00:32:57,570 --> 00:33:02,580
you've now got the ability we've got a
new check box which is other supported

501
00:33:02,580 --> 00:33:05,000
RemoteFX USB devices

502
00:33:05,000 --> 00:33:09,110
and any devices that are currently
plugged into

503
00:33:09,110 --> 00:33:12,260
your client will show up there and you
can

504
00:33:12,260 --> 00:33:15,300
other tick box and say I wanna make that
device

505
00:33:15,300 --> 00:33:20,280
in fact within their kind of more
granular RDP client configuration

506
00:33:20,280 --> 00:33:23,690
you can specify any USB device bites

507
00:33:23,690 --> 00:33:27,210
puede I am and say our

508
00:33:27,210 --> 00:33:30,310
I want to remote this device so is not

509
00:33:30,310 --> 00:33:34,470
based on an specific

510
00:33:34,470 --> 00:33:38,260
use case types as it was with high-level
redirection

511
00:33:38,260 --> 00:33:42,460
now it's much more generic and the
function RT is there to allow you to

512
00:33:42,460 --> 00:33:42,990
remote

513
00:33:42,990 --> 00:33:47,710
any USB device using RemoteFX

514
00:33:47,710 --> 00:33:51,080
so now theoretically

515
00:33:51,080 --> 00:33:55,140
this is what happens actually more than
30 acres hope to work in a minute

516
00:33:55,140 --> 00:34:00,710
I'm so you but your RDP client I'm a new
RDP server

517
00:34:00,710 --> 00:34:05,730
night one thing that you need to do that
took me ages to work anchors I kept on

518
00:34:05,730 --> 00:34:09,810
having the same scenario as I had before
with high level stuff well kept

519
00:34:09,810 --> 00:34:14,340
blue screening my client is you have to
emulate a normal

520
00:34:14,340 --> 00:34:18,010
non rope device first because

521
00:34:18,010 --> 00:34:21,419
what you need to do is kinda capture the
session

522
00:34:21,419 --> 00:34:25,770
within RemoteFX and tell are the RDP
server

523
00:34:25,770 --> 00:34:29,770
that yeah a valid device of the class
that you're gonna

524
00:34:29,770 --> 00:34:34,070
send a Road example of an imminent I'm
is to be used

525
00:34:34,070 --> 00:34:37,960
within RDP session see start off by
mandating the normal device

526
00:34:37,960 --> 00:34:43,649
not the right ice within your RDP
session

527
00:34:43,649 --> 00:34:48,570
I'm so the audio device that gets
emulated by Yuma

528
00:34:48,570 --> 00:34:52,260
comes up as a creative headset

529
00:34:52,260 --> 00:34:57,510
say then take that say yep that's the 1i
want to use

530
00:34:57,510 --> 00:35:01,270
he then beneath a virtually

531
00:35:01,270 --> 00:35:04,390
a new virtually insert your ok device

532
00:35:04,390 --> 00:35:10,650
miss time the RDP server case being

533
00:35:10,650 --> 00:35:17,650
okay sipping it to work

534
00:36:29,590 --> 00:36:32,660
okay so what I've got is

535
00:36:32,660 --> 00:36:36,730
this laptop here is connected via USB

536
00:36:36,730 --> 00:36:40,840
to the faced an support the face
danceable old

537
00:36:40,840 --> 00:36:43,850
is then connected to this laptop here

538
00:36:43,850 --> 00:36:47,230
start to appear

539
00:36:47,230 --> 00:36:50,880
which has a remote desktop

540
00:36:50,880 --> 00:36:54,430
clients configured on it this laptop
here

541
00:36:54,430 --> 00:36:57,530
is connected via a crossover cable to

542
00:36:57,530 --> 00:37:04,530
it's not appear this laptop air is
running Windows Server 2012

543
00:37:04,920 --> 00:37:09,420
and that's what we're gonna Rd PNT site

544
00:37:09,420 --> 00:37:13,370
first thing that we need to do

545
00:37:13,370 --> 00:37:16,740
is RDP into the server

546
00:37:16,740 --> 00:37:20,050
and what I'm gonna do is because you
need to authenticate with it

547
00:37:20,050 --> 00:37:23,880
I'm demonstrating that you can
authenticate is the absolute lowest

548
00:37:23,880 --> 00:37:25,230
privileged user

549
00:37:25,230 --> 00:37:29,150
song it RT pay into the service as the
guest user

550
00:37:29,150 --> 00:37:32,860
so absolute lowest privilege and then 1
I'm gonna do

551
00:37:32,860 --> 00:37:36,040
from here is

552
00:37:36,040 --> 00:37:39,040
I will use he map

553
00:37:39,040 --> 00:37:43,540
to say I just want to emulate an audio
device

554
00:37:43,540 --> 00:37:46,950
and its conventional sense so it's not
gonna do anything

555
00:37:46,950 --> 00:37:50,010
never send any militia status is gonna
emulate it

556
00:37:50,010 --> 00:37:53,310
and then within the client are captured
bout session

557
00:37:53,310 --> 00:37:58,570
and tick tock tick box okay up at the
microphone download it so that I

558
00:37:58,570 --> 00:38:05,570
get it done without it timing act

559
00:38:34,270 --> 00:38:37,780
K epic fail just need to be where

560
00:38:37,780 --> 00:38:44,780
revert to snapshot on my Windows
snapshot

561
00:39:01,630 --> 00:39:08,630
to take a few seconds

562
00:39:42,960 --> 00:39:44,020
K

563
00:39:44,020 --> 00:39:51,020
let's try that again

564
00:39:59,310 --> 00:40:06,310
he has worked right okay so it's
currently looking into that's now

565
00:40:08,670 --> 00:40:13,130
Rd paid into their windows 2012 server

566
00:40:13,130 --> 00:40:16,340
their K

567
00:40:16,340 --> 00:40:21,410
Mac annexing on eating

568
00:40:21,410 --> 00:40:28,410
years grab this session associated with
the

569
00:40:29,490 --> 00:40:36,490
or did vice

570
00:40:45,740 --> 00:40:52,740
which %uh now den

571
00:41:04,070 --> 00:41:07,020
okay so as the

572
00:41:07,020 --> 00:41:10,020
2012 server and have nine

573
00:41:10,020 --> 00:41:13,720
grab the audio

574
00:41:13,720 --> 00:41:17,740
device session for USB between the
client and server

575
00:41:17,740 --> 00:41:21,670
so now I'm I send

576
00:41:21,670 --> 00:41:26,850
the malicious data which remember is
connected via the faced answerable to

577
00:41:26,850 --> 00:41:27,730
the client

578
00:41:27,730 --> 00:41:33,330
Sony Ethernet that's kept in a client to
the server that you can see it on the

579
00:41:33,330 --> 00:41:33,920
screen

580
00:41:33,920 --> 00:41:38,520
I can do

581
00:41:38,520 --> 00:41:43,340
the

582
00:41:43,340 --> 00:41:50,340
or

583
00:42:00,680 --> 00:42:07,680
juice

584
00:42:13,650 --> 00:42:17,500
K so

585
00:42:17,500 --> 00:42:21,660
this has some pretty serious
implications

586
00:42:21,660 --> 00:42:26,650
it means that some even if you've just
got

587
00:42:26,650 --> 00:42:30,890
Anna no pointed the reference books

588
00:42:30,890 --> 00:42:34,750
if you can use those to remotely be
screen a server on the other side of the

589
00:42:34,750 --> 00:42:35,350
world

590
00:42:35,350 --> 00:42:38,350
that changes the whole ball game with
USB attacks

591
00:42:38,350 --> 00:42:42,790
um what Windows

592
00:42:42,790 --> 00:42:47,320
what microsoft done with Windows RT pay
is they've exposed

593
00:42:47,320 --> 00:42:51,530
elements at the kernel over Rd pay

594
00:42:51,530 --> 00:42:54,680
which allow you to do that which is them

595
00:42:54,680 --> 00:42:58,630
it's pretty dangerous thing ready am

596
00:42:58,630 --> 00:43:03,010
and across this may also apply to other
non Windows relating technologies

597
00:43:03,010 --> 00:43:06,280
unelected RDP in detail there's a buncha
other

598
00:43:06,280 --> 00:43:10,040
am technology site that this might
potentially affect

599
00:43:10,040 --> 00:43:15,550
so I can you reduce the risks

600
00:43:15,550 --> 00:43:19,420
you can actually turned the RemoteFX

601
00:43:19,420 --> 00:43:22,680
function RT associate it with USB
redirection of

602
00:43:22,680 --> 00:43:27,160
so if you know any you say or your

603
00:43:27,160 --> 00:43:30,370
scared by it what you've just seen I'd
suggest turning it off

604
00:43:30,370 --> 00:43:35,300
um if you do actually need it there is a
quite granular control

605
00:43:35,300 --> 00:43:38,400
that you can use to them to make sure

606
00:43:38,400 --> 00:43:42,400
only the devices that you want to be
used camby remoted

607
00:43:42,400 --> 00:43:47,160
and fire Rd peso you know make sure that
it's configured correctly if you

608
00:43:47,160 --> 00:43:50,490
if you do you want to use USB
redirection by RemoteFX

609
00:43:50,490 --> 00:43:54,510
but again in eighteen decided on the
client's

610
00:43:54,510 --> 00:43:57,750
rather not enable it on the clients
because it's not there by default on

611
00:43:57,750 --> 00:44:02,760
on RDP client um I'd also suggest
minimizing the said

612
00:44:02,760 --> 00:44:06,450
from the high-level remoting stuffers
following a lot of people don't realize

613
00:44:06,450 --> 00:44:10,430
how much room 18 capability there is
within a RDP

614
00:44:10,430 --> 00:44:14,190
and certainly be more cautious

615
00:44:14,190 --> 00:44:17,820
by local or in quotes ok along abilities

616
00:44:17,820 --> 00:44:22,540
apply oil patches so if you can't asians

617
00:44:22,540 --> 00:44:26,140
and Tom further research so if

618
00:44:26,140 --> 00:44:30,310
as a demonstrated physical access is no
longer a requirement to trigger a USB

619
00:44:30,310 --> 00:44:33,570
bugs sonya Windows maybe another person
systems as well

620
00:44:33,570 --> 00:44:37,930
um promoter factors

621
00:44:37,930 --> 00:44:41,500
exposed the Windows kernel and

622
00:44:41,500 --> 00:44:44,830
therefore you know these concurred in a
level attacks

623
00:44:44,830 --> 00:44:48,410
now available over the network I need to
look at some of the other mating

624
00:44:48,410 --> 00:44:50,420
technologies like Citrix for example

625
00:44:50,420 --> 00:44:55,610
which may well apply in a similar sense
and the Internet of Things is for love

626
00:44:55,610 --> 00:44:57,170
USB possibilities

627
00:44:57,170 --> 00:45:01,480
basic K I've takin I E map

628
00:45:01,480 --> 00:45:05,090
and because it's completely host

629
00:45:05,090 --> 00:45:09,810
independent you can test any USB host up
there anything that's got a USB

630
00:45:09,810 --> 00:45:12,860
port on it and host stack

631
00:45:12,860 --> 00:45:16,560
the processes USB devices you can test
using new map

632
00:45:16,560 --> 00:45:20,100
so I'm sure there are thousands all USB

633
00:45:20,100 --> 00:45:23,880
host stack and passing on a bus is at
that the

634
00:45:23,880 --> 00:45:27,230
you could probably find using a map so
please download it

635
00:45:27,230 --> 00:45:34,230
have a play with it on some bucks thanks
very much

636
00:45:40,530 --> 00:45:41,960
and nobody questions

637
00:45:41,960 --> 00:45:48,700
if and

638
00:45:48,700 --> 00:45:52,320
the question was can you actually inject
code it depends on

639
00:45:52,320 --> 00:45:55,830
where the actual vulnerability is nice
summer

640
00:45:55,830 --> 00:46:00,090
the some the trigger points within

641
00:46:00,090 --> 00:46:03,100
the USB descriptors they can exchange
today

642
00:46:03,100 --> 00:46:06,760
at the enumeration face I'm a very small
however

643
00:46:06,760 --> 00:46:09,940
um it depends

644
00:46:09,940 --> 00:46:12,970
it's kind of a case by case basis really
because even

645
00:46:12,970 --> 00:46:16,590
in some instances where the trigger
point is small there are other

646
00:46:16,590 --> 00:46:20,750
descriptors that can be significantly
larger see could potentially PO payload

647
00:46:20,750 --> 00:46:24,440
and a different descriptor that would be
available in a different memory buffer

648
00:46:24,440 --> 00:46:26,010
at the time and exploitation

649
00:46:26,010 --> 00:46:31,000
um but yeah it is very very much on a
case by case basis depending on which

650
00:46:31,000 --> 00:46:32,610
descriptor the bugs in an

651
00:46:32,610 --> 00:46:38,750
what OS is passing it animal

652
00:46:38,750 --> 00:46:45,750
yeah

653
00:46:54,430 --> 00:46:57,380
Devils not something I've licked up I
I'm sure

654
00:46:57,380 --> 00:47:03,170
in a similar sense the I'm gonna
virtualization at the USB stack

655
00:47:03,170 --> 00:47:07,000
maybe contains passing boats just like
can bail

656
00:47:07,000 --> 00:47:11,070
am USB stack so yes sir in other areas
to look at

657
00:47:11,070 --> 00:47:18,070
right

658
00:47:18,390 --> 00:47:19,260
okay thanks very much

