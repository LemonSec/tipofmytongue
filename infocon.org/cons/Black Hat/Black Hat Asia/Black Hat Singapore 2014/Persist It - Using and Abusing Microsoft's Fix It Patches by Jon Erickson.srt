1
00:00:00,260 --> 00:00:04,230
good afternoon a man named John Erickson
this is persistent

2
00:00:04,230 --> 00:00:09,429
you can be seen at like suffix hatter's
I apologize my laptop so how does not

3
00:00:09,429 --> 00:00:11,099
work but the system so

4
00:00:11,099 --> 00:00:14,219
'em and can be clicking

5
00:00:14,219 --> 00:00:19,350
this in this at the same time so might
get confusing their

6
00:00:19,350 --> 00:00:22,699
patch this is me this by

7
00:00:22,699 --> 00:00:26,240
Twitter handle I don't read much they
can follow me if you want to

8
00:00:26,240 --> 00:00:30,660
I'm an engineer I said partners I've
been there about three years now

9
00:00:30,660 --> 00:00:34,559
but focus on looking at portability is

10
00:00:34,559 --> 00:00:38,079
exploits the became aware

11
00:00:38,079 --> 00:00:41,500
and a big for my job is looking at
patches which is

12
00:00:41,500 --> 00:00:44,500
but this talk is about I every

13
00:00:44,500 --> 00:00:48,350
pet shoot a look at microsoft adobe York
pork such a

14
00:00:48,350 --> 00:00:54,469
arm prior nice I was at the MITRE
Corporation for five years

15
00:00:54,469 --> 00:00:58,160
and before that I was that the they're
forced the couple

16
00:00:58,160 --> 00:01:02,030
defense contractors I said partners

17
00:01:02,030 --> 00:01:06,090
is a told mister provider if you would
like more information about our site

18
00:01:06,090 --> 00:01:08,350
please visit our website we're come talk
to me

19
00:01:08,350 --> 00:01:12,460
after the top K

20
00:01:12,460 --> 00:01:16,119
so here we're talking today a little
background about what these pics is

21
00:01:16,119 --> 00:01:17,070
actually do

22
00:01:17,070 --> 00:01:20,070
I some tools they can use to

23
00:01:20,070 --> 00:01:25,799
dead her that was my fly for my
companies are

24
00:01:25,799 --> 00:01:30,640
national talk about that I'll

25
00:01:30,640 --> 00:01:34,259
we're gonna talk about some tools they
can use to look at these

26
00:01:34,259 --> 00:01:37,460
fix patch is some real-world cases where
microsoft says

27
00:01:37,460 --> 00:01:40,960
utilized these fixes to prevent
exploitation

28
00:01:40,960 --> 00:01:44,310
on how I went about reverse engineering
districts at

29
00:01:44,310 --> 00:01:48,140
Park format are merciful and gracious
closure

30
00:01:48,140 --> 00:01:51,540
Beaulieu might want to say that I love
doing this

31
00:01:51,540 --> 00:01:54,670
as to explore which is the tool I wrote
during their

32
00:01:54,670 --> 00:01:58,350
this research and high to go back for
your own a memory

33
00:01:58,350 --> 00:02:01,950
patch fix its and I can use that she
made him persistence

34
00:02:01,950 --> 00:02:05,329
ok apso

35
00:02:05,329 --> 00:02:09,429
what are these in every patch fixes they
are a subset

36
00:02:09,429 --> 00:02:14,700
up application compatibility fixes
others a much different names out there

37
00:02:14,700 --> 00:02:18,510
the the called shame databases are
called captain Pat

38
00:02:18,510 --> 00:02:23,400
at compatibility fixes Microsoft has a
whole website dedicated

39
00:02:23,400 --> 00:02:28,030
to use fix it selects of Fix It center
thirst

40
00:02:28,030 --> 00:02:32,530
thousands out there they provided awaits
you

41
00:02:32,530 --> 00:02:36,280
modify now peace that behavior how it
interacts with Windows so

42
00:02:36,280 --> 00:02:40,819
I'll for example if you needed to modify
your

43
00:02:40,819 --> 00:02:45,239
resolution for some old program he could
have a shame that does that

44
00:02:45,239 --> 00:02:48,959
if you wanna touch you October to an old

45
00:02:48,959 --> 00:02:52,989
up you know Windows NT up to make it
work on Windows seven you money to

46
00:02:52,989 --> 00:02:54,050
change some

47
00:02:54,050 --> 00:02:58,489
up file a locations originally locations

48
00:02:58,489 --> 00:03:01,819
seeking to all with the same day missus
arm

49
00:03:01,819 --> 00:03:06,870
any minute X a marks of his hand but
occasionally experience toolkit

50
00:03:06,870 --> 00:03:10,370
I of the works be this mechanism

51
00:03:10,370 --> 00:03:14,890
so

52
00:03:14,890 --> 00:03:21,230
the the first public I information I saw
on this is from Alexander skid

53
00:03:21,230 --> 00:03:24,790
I made a blog back to 2007 called
secrets

54
00:03:24,790 --> 00:03:28,230
a deputy secretary Billy Davis I I guess

55
00:03:28,230 --> 00:03:31,260
he intended for two be in nine art blog
series

56
00:03:31,260 --> 00:03:34,959
a he only did these first for the night
that I saw least

57
00:03:34,959 --> 00:03:39,459
he gave a great introduction on the
technology

58
00:03:39,459 --> 00:03:43,420
some us the solutions are built into
Windows

59
00:03:43,420 --> 00:03:47,930
how the shin engine iraq's the key
loader and i won

60
00:03:47,930 --> 00:03:51,700
he never got to really see his tall or

61
00:03:51,700 --> 00:03:56,049
this bowl here %uh 7 the runtime min:

62
00:03:56,049 --> 00:03:59,700
and never had to be here in else s if he
would have released their blog entry I

63
00:03:59,700 --> 00:04:01,870
probably would not be here today to talk
about the stuff

64
00:04:01,870 --> 00:04:05,920
a

65
00:04:05,920 --> 00:04:10,319
mark Badgett a present rhetoric on last
year

66
00:04:10,319 --> 00:04:13,549
I he's mainly focused on

67
00:04:13,549 --> 00:04:18,850
I rootkits and doing penetration testing
works so that kinda his focus he wants

68
00:04:18,850 --> 00:04:19,440
to do

69
00:04:19,440 --> 00:04:24,130
I rootkit type things like process
execution redirection and

70
00:04:24,130 --> 00:04:28,540
API hokey in boss is a highly resistant
registry hiding

71
00:04:28,540 --> 00:04:33,400
I should I can't disable security
features though s like to sail in Solr

72
00:04:33,400 --> 00:04:37,930
depth for processes it had actually back
doors he show they could do all this

73
00:04:37,930 --> 00:04:41,180
through Bell pitched better really
framework that's built right into

74
00:04:41,180 --> 00:04:41,900
Windows

75
00:04:41,900 --> 00:04:45,770
a it's a very neat work he did not talk
about

76
00:04:45,770 --> 00:04:50,240
in every patches which is the focus for
this talk but still cool stuff

77
00:04:50,240 --> 00:04:53,889
so

78
00:04:53,889 --> 00:04:57,880
what's the motivation why did I want to
it started doing this

79
00:04:57,880 --> 00:05:01,740
you know Patch Tuesday comes out I depth

80
00:05:01,740 --> 00:05:06,240
the Petra I the you find it for the
previous example here

81
00:05:06,240 --> 00:05:09,550
455 functions that

82
00:05:09,550 --> 00:05:13,500
match that means you have to look to 465
functions

83
00:05:13,500 --> 00:05:16,949
they have third Thursday differences in
them

84
00:05:16,949 --> 00:05:21,370
and other differences secure related
trip fixes are they

85
00:05:21,370 --> 00:05:25,139
just normal bug fixes for Windows its

86
00:05:25,139 --> 00:05:29,320
it's a hard job it takes a long time it
takes a long time to just loaded these

87
00:05:29,320 --> 00:05:30,840
de Lausanne tied up

88
00:05:30,840 --> 00:05:34,169
run been defined above six hours I

89
00:05:34,169 --> 00:05:37,600
if you look at the pics a patch for this
particular see here

90
00:05:37,600 --> 00:05:41,030
first two changes so within

91
00:05:41,030 --> 00:05:45,590
P to fight me some downloading this pic
said running the story can see

92
00:05:45,590 --> 00:05:50,110
oh they change this assembly instruction
from the John article to a job per

93
00:05:50,110 --> 00:05:55,500
they changed this to hope this function
to redirect code somewhere else

94
00:05:55,500 --> 00:06:00,569
I am very cool stuff and that's what
time it start and this

95
00:06:00,569 --> 00:06:04,669
Tesla last night wasn't force Arden

96
00:06:04,669 --> 00:06:09,150
there's a few buy microsoft helped
especially talk it

97
00:06:09,150 --> 00:06:12,240
St Jacksonville and st. interest

98
00:06:12,240 --> 00:06:16,870
on as well as CD which will talk about
briefly and as to explore what to the

99
00:06:16,870 --> 00:06:18,340
tool I created

100
00:06:18,340 --> 00:06:25,340
during this research

101
00:06:25,780 --> 00:06:31,940
somebody help me fight for you to change
the slightly

102
00:06:31,940 --> 00:06:36,770
the kid in okay so that patients that
have a talk at

103
00:06:36,770 --> 00:06:40,509
a this is freely available for download
from Microsoft

104
00:06:40,509 --> 00:06:45,130
arm so nice to a tool that allows you
two points they keep rates

105
00:06:45,130 --> 00:06:49,810
nice application fixes however I don't
think it's very well documented

106
00:06:49,810 --> 00:06:54,720
I've got a couple examples here on that
I I just made up

107
00:06:54,720 --> 00:06:58,270
pointer so I created a

108
00:06:58,270 --> 00:07:02,360
competitor leach fix here called Shin
deat

109
00:07:02,360 --> 00:07:05,759
which means it your to hook up function
BR

110
00:07:05,759 --> 00:07:09,000
I expert at this table entry um

111
00:07:09,000 --> 00:07:12,419
when you treat this the Dewey it's nice
playing clicked yeah I wanna do it

112
00:07:12,419 --> 00:07:15,280
should be eighty and then it is your
text box

113
00:07:15,280 --> 00:07:19,270
that says arguments and it provides no
documentation

114
00:07:19,270 --> 00:07:22,949
what's the format for that are you at
how do you know

115
00:07:22,949 --> 00:07:28,030
I I have no idea so a is very confusing
um

116
00:07:28,030 --> 00:07:33,720
the they've fixes and they've got no its
nodes are clutching the pictures so

117
00:07:33,720 --> 00:07:37,620
and got the top point here is the
compatibility fix and

118
00:07:37,620 --> 00:07:41,770
the bottom what the compatibility mode
what I really want to point out here

119
00:07:41,770 --> 00:07:45,370
is the concept of matching files and

120
00:07:45,370 --> 00:07:48,690
so messy files for I E

121
00:07:48,690 --> 00:07:52,340
it has to match this particular by
reversion

122
00:07:52,340 --> 00:07:56,160
company name product may make such a if
the

123
00:07:56,160 --> 00:08:01,610
if those conditions are met than this
compatibility fix will be applied

124
00:08:01,610 --> 00:08:05,330
as well as the bottom if those
conditions are met

125
00:08:05,330 --> 00:08:08,639
that compatibility mode will be set

126
00:08:08,639 --> 00:08:12,740
'em

127
00:08:12,740 --> 00:08:15,830
now if we take the same

128
00:08:15,830 --> 00:08:20,000
your chocolate to hear and bring in one
of these exceptions

129
00:08:20,000 --> 00:08:23,870
um we see the same matching thousand
trees like we saw on

130
00:08:23,870 --> 00:08:27,550
in the previous slide however there's no

131
00:08:27,550 --> 00:08:31,160
compatibility fixed listed here there's
no compatibility mode

132
00:08:31,160 --> 00:08:34,560
listed here so how do you know what this
does

133
00:08:34,560 --> 00:08:38,630
it its has like no concept of what these
in memory fixes

134
00:08:38,630 --> 00:08:43,700
are what they do so I'm guessing that
Microsoft has some internal version of

135
00:08:43,700 --> 00:08:50,700
the stormy the use a little bit
different to create this

136
00:08:50,790 --> 00:08:53,810
kept on St Jacksonville

137
00:08:53,810 --> 00:08:58,390
free by Microsoft employee back into the
other seven so about the same time

138
00:08:58,390 --> 00:09:01,410
a Alex was doing his work arm

139
00:09:01,410 --> 00:09:05,490
this can dump what's called patch its
information

140
00:09:05,490 --> 00:09:08,570
this bid absurd this big

141
00:09:08,570 --> 00:09:13,120
love Bay 64 data you can also have a
dump

142
00:09:13,120 --> 00:09:16,700
these patch the section onto buyer fails
I'll

143
00:09:16,700 --> 00:09:20,170
on desk on

144
00:09:20,170 --> 00:09:24,779
now it at surface very slow here

145
00:09:24,779 --> 00:09:29,160
a but you could see that this kinda has
the same information

146
00:09:29,160 --> 00:09:32,580
that's provided in their position
politically toolkit

147
00:09:32,580 --> 00:09:36,779
it's got the application aims got the
message all entries followed by

148
00:09:36,779 --> 00:09:40,170
he read a little bit more information
now there's a patch rap

149
00:09:40,170 --> 00:09:44,130
I don't years that means if this
matching files entry

150
00:09:44,130 --> 00:09:47,230
is met it won't apply those Petra and

151
00:09:47,230 --> 00:09:51,279
it's got a pet tag i do. 218

152
00:09:51,279 --> 00:09:54,670
above what is 280 I have no idea this

153
00:09:54,670 --> 00:09:58,959
patch up here has no number associated
with it so

154
00:09:58,959 --> 00:10:03,550
is that to NH or is the one that's of
the screen right now a bitter

155
00:10:03,550 --> 00:10:07,760
the one about that or how do you get
this linkage oval

156
00:10:07,760 --> 00:10:11,490
if that blood on own data is for this
particular

157
00:10:11,490 --> 00:10:17,670
version up the message will be a little

158
00:10:17,670 --> 00:10:21,250
'em in CD

159
00:10:21,250 --> 00:10:24,820
a bellicose I never released it

160
00:10:24,820 --> 00:10:30,610
he's got this show patches option

161
00:10:30,610 --> 00:10:36,829
big a city by Alex she's got the sharp
edges option

162
00:10:36,829 --> 00:10:39,990
I'm it's not clear if this

163
00:10:39,990 --> 00:10:44,040
dumped out a 64 include a blog like has
to be to XML or

164
00:10:44,040 --> 00:10:47,769
that I'm actually parked out this
information

165
00:10:47,769 --> 00:10:50,890
I a better format but

166
00:10:50,890 --> 00:10:56,320
a.m. never released

167
00:10:56,320 --> 00:11:00,730
aka so experienced this is the file
that's already on your computer

168
00:11:00,730 --> 00:11:04,500
it's a way for you to install has to be
files

169
00:11:04,500 --> 00:11:09,160
if you were I V if you go to mike says
website you can download

170
00:11:09,160 --> 00:11:12,310
the the MSI to install

171
00:11:12,310 --> 00:11:16,510
a fix it but if you actually extract out
what's in and thus I lined up at the STB

172
00:11:16,510 --> 00:11:17,529
file

173
00:11:17,529 --> 00:11:20,649
in this tool allows you choose install

174
00:11:20,649 --> 00:11:24,339
St follows via this mechanism whether
they're

175
00:11:24,339 --> 00:11:27,890
s2000 treason depth issues particularly
framework

176
00:11:27,890 --> 00:11:32,110
but OK or once the download from
Microsoft

177
00:11:32,110 --> 00:11:35,779
you have to use the desk P option when
the STV file

178
00:11:35,779 --> 00:11:40,149
contains a.m. every patches

179
00:11:40,149 --> 00:11:43,560
you have to be administrator to run this
tool

180
00:11:43,560 --> 00:11:47,040
and walled talk about why later

181
00:11:47,040 --> 00:11:51,839
a also a side effect to this is that

182
00:11:51,839 --> 00:11:55,660
these I don't show up in your adult
pearls dialogue

183
00:11:55,660 --> 00:11:59,110
Amanda bed had mentioned in his Derby
Conn talk

184
00:11:59,110 --> 00:12:02,649
you know his to know the score rootkit
type things but

185
00:12:02,649 --> 00:12:07,510
then he has to go and see that his love
in a rooted fix it is in the habit of

186
00:12:07,510 --> 00:12:08,790
pearls I like so

187
00:12:08,790 --> 00:12:13,050
never never stop it

188
00:12:13,050 --> 00:12:17,300
so on these are that follow cations

189
00:12:17,300 --> 00:12:20,320
a min this is why you have to be
administrator his

190
00:12:20,320 --> 00:12:24,430
a St instant in my tool have to write to
these

191
00:12:24,430 --> 00:12:27,899
to raise relocations 80 local machine

192
00:12:27,899 --> 00:12:31,680
on custom and installed FTB

193
00:12:31,680 --> 00:12:35,740
and so what you'll find if you look at
this location custom you'll find

194
00:12:35,740 --> 00:12:38,829
entries for applications that have shims
applied

195
00:12:38,829 --> 00:12:44,089
so you might find one for I export I
Exce or for when Werder for a looker

196
00:12:44,089 --> 00:12:47,880
any other program that may have had a in
memory fix it

197
00:12:47,880 --> 00:12:51,130
a stole the time this is also

198
00:12:51,130 --> 00:12:55,350
where you'll see obligations a happy may
apply to the

199
00:12:55,350 --> 00:12:59,389
under the entries a custom W do it

200
00:12:59,389 --> 00:13:02,850
you felt like you aided under the stall
has to be folder

201
00:13:02,850 --> 00:13:06,160
and you'll find I

202
00:13:06,160 --> 00:13:09,839
information like this be the shows you

203
00:13:09,839 --> 00:13:14,029
the the description which is a comment
or say the deepest

204
00:13:14,029 --> 00:13:20,360
timestamp out the location on the file
system where the st. Paul excess

205
00:13:20,360 --> 00:13:25,100
in the Davis tight which in this case
disliked this means a

206
00:13:25,100 --> 00:13:28,130
it's a shame day to recite

207
00:13:28,130 --> 00:13:33,690
'em

208
00:13:33,690 --> 00:13:38,200
I get bored and apply to all the
animations and that's all I got Sep

209
00:13:38,200 --> 00:13:42,079
this is kinda like my other my cab ride
from the airport here

210
00:13:42,079 --> 00:13:45,800
Esprit excited um so

211
00:13:45,800 --> 00:13:49,860
this is Michael offer install amor talk
more volatile later

212
00:13:49,860 --> 00:13:55,170
but I'll you give the the deaths are
option with st. Paul that you

213
00:13:55,170 --> 00:14:00,800
you've got immediate publication name:
that you want you showed

214
00:14:00,800 --> 00:14:04,060
this does not show up that we programs

215
00:14:04,060 --> 00:14:08,089
I am it does not copy this to be file

216
00:14:08,089 --> 00:14:13,060
to the politicians I should've I should
mention back you're actually

217
00:14:13,060 --> 00:14:16,639
on this is the the Polish

218
00:14:16,639 --> 00:14:21,010
locations that St Inc program copy the
file to

219
00:14:21,010 --> 00:14:24,690
so if you're installing a 32 bit patch
is going to put it

220
00:14:24,690 --> 00:14:28,690
in the eyepatch custom directory if
you're installing a 64 bit patch is

221
00:14:28,690 --> 00:14:29,829
going to put it

222
00:14:29,829 --> 00:14:34,120
in the custom custom 64 record

223
00:14:34,120 --> 00:14:37,620
from my tool does not copy

224
00:14:37,620 --> 00:14:41,050
into the two politicians so you need to
be aware of

225
00:14:41,050 --> 00:14:47,649
if you're making a patch for 60 pips 50
for a program that you need to have

226
00:14:47,649 --> 00:14:50,699
I'll custom 64 somewhere

227
00:14:50,699 --> 00:14:55,000
in the fall director power thats how my
cuz how Windows checked to see if you

228
00:14:55,000 --> 00:14:56,079
have got

229
00:14:56,079 --> 00:15:02,279
a 32 bit or 64 bit patch it just checks
based on the structure im

230
00:15:02,279 --> 00:15:05,540
mmm

231
00:15:05,540 --> 00:15:10,410
but so's talk about some real world
cases for Microsoft as he is this

232
00:15:10,410 --> 00:15:14,100
um for Lowes our recent that i've seen

233
00:15:14,100 --> 00:15:18,100
even in memory fix it type are these

234
00:15:18,100 --> 00:15:21,130
I'm just a quick note in the news I'll

235
00:15:21,130 --> 00:15:25,970
this week lace up but out advisory but
RTF portability

236
00:15:25,970 --> 00:15:29,829
and in the security adviser they mention
a fix it pouch

237
00:15:29,829 --> 00:15:33,579
that ball help prevent it that's a
animal in memory

238
00:15:33,579 --> 00:15:37,050
pics a patch that or just disable

239
00:15:37,050 --> 00:15:41,050
word opening RTF file sent to your for
processing them

240
00:15:41,050 --> 00:15:44,339
so they don't have to they don't do in
every batch

241
00:15:44,339 --> 00:15:48,310
arm so these the top three are I E

242
00:15:48,310 --> 00:15:51,480
polls the bottom one was a XO core
services

243
00:15:51,480 --> 00:15:55,399
bugged and in all these cases

244
00:15:55,399 --> 00:15:58,839
the pic sets were actually targeting I E

245
00:15:58,839 --> 00:16:03,540
so XML core services is a system-wide

246
00:16:03,540 --> 00:16:07,880
livor used by many applications such as
you know we're now look

247
00:16:07,880 --> 00:16:12,899
arms but Microsoft just released the
fixed fix it to print protect

248
00:16:12,899 --> 00:16:18,139
I E using the library not not other ones

249
00:16:18,139 --> 00:16:22,019
and we're gonna focus on this most
recent one

250
00:16:22,019 --> 00:16:25,769
on for the rest the talk

251
00:16:25,769 --> 00:16:31,290
so this was public key believe this goes
by fire eye on February 11th

252
00:16:31,290 --> 00:16:34,930
be exploiting the wild Microsoft
released a fix it

253
00:16:34,930 --> 00:16:38,029
on the 19th such eight days %uh

254
00:16:38,029 --> 00:16:41,230
they already had a fix out the door
which is great so you'll have to wait

255
00:16:41,230 --> 00:16:42,570
till next

256
00:16:42,570 --> 00:16:48,750
patch cycle apaches day to you be able
to protect your enterprise

257
00:16:48,750 --> 00:16:53,240
arm again you see my tall which will
talk about later

258
00:16:53,240 --> 00:16:56,750
on this dash d optional will

259
00:16:56,750 --> 00:17:00,440
essentially print out all the matching
follow entries within

260
00:17:00,440 --> 00:17:04,329
the database so this particular

261
00:17:04,329 --> 00:17:07,850
I Davis file there was a different

262
00:17:07,850 --> 00:17:11,720
entries that their targeting these
versions of

263
00:17:11,720 --> 00:17:15,260
I'm these reserve I E

264
00:17:15,260 --> 00:17:20,870
with the peach excellence so I E nine
then I turned

265
00:17:20,870 --> 00:17:25,400
from

266
00:17:25,400 --> 00:17:29,140
and just you know I know I'm not if you
don't have the

267
00:17:29,140 --> 00:17:32,890
if you can have the latest versions of
these d lolss

268
00:17:32,890 --> 00:17:35,960
and install the fix it it does nothing
for you

269
00:17:35,960 --> 00:17:39,530
you have to have the exact versions for
this except you

270
00:17:39,530 --> 00:17:43,340
copy otherwise it it does nothing

271
00:17:43,340 --> 00:17:47,240
so the star talk about how so

272
00:17:47,240 --> 00:17:51,400
but if you're with this does now when I
first star research into this I don't

273
00:17:51,400 --> 00:17:53,049
actually know what this

274
00:17:53,049 --> 00:17:57,030
'em this extension to win a bug that I'm
showing here

275
00:17:57,030 --> 00:18:01,140
and so is a governmental process i lit
up I E

276
00:18:01,140 --> 00:18:04,620
I did a memory dump I install the pics a
patch

277
00:18:04,620 --> 00:18:08,080
I loaded I E again and another memory
dump

278
00:18:08,080 --> 00:18:12,610
and then it didn't buy her compare the
two you %uh puts to figure out

279
00:18:12,610 --> 00:18:16,490
where the place third for the different
essentially

280
00:18:16,490 --> 00:18:20,210
and done it was a pain the butt

281
00:18:20,210 --> 00:18:23,470
in this the Sun plugin here for

282
00:18:23,470 --> 00:18:27,740
went about this it was very helpful so
if you wanna play lawyer home

283
00:18:27,740 --> 00:18:31,650
this was the deal that i had random a
system what are in these commands

284
00:18:31,650 --> 00:18:34,960
and what we see here is

285
00:18:34,960 --> 00:18:39,960
before the fix it there is no corruption
that's what the stool calls

286
00:18:39,960 --> 00:18:43,350
arm prop shiner difference is
essentially

287
00:18:43,350 --> 00:18:46,630
and so BBC this memory range: here

288
00:18:46,630 --> 00:18:50,770
there was a fight by corruption if you
got symbols installed you'll see that

289
00:18:50,770 --> 00:18:51,470
this was it

290
00:18:51,470 --> 00:18:55,640
within the Insur text control method

291
00:18:55,640 --> 00:18:58,740
been expected 5 bytes for those

292
00:18:58,740 --> 00:19:02,309
in the bites it found there for those

293
00:19:02,309 --> 00:19:06,039
and there's a second one now I've

294
00:19:06,039 --> 00:19:09,980
i disassemble what those fly bites are
the new five bites are down here

295
00:19:09,980 --> 00:19:13,429
you can see they're both job
instructions

296
00:19:13,429 --> 00:19:17,210
and I don't have on the screen but if I
would show the disassembly

297
00:19:17,210 --> 00:19:20,260
love the before pics in Salt

298
00:19:20,260 --> 00:19:23,470
I you will see that the standard a
function

299
00:19:23,470 --> 00:19:27,299
prologue are just so you know movie Diti

300
00:19:27,299 --> 00:19:30,650
pushy p Sucher so they're essentially

301
00:19:30,650 --> 00:19:35,549
cooking these two functions

302
00:19:35,549 --> 00:19:39,020
and a.m. were to talk about

303
00:19:39,020 --> 00:19:42,990
these bikes later sigh bold two things
that I'm actually a focus on later

304
00:19:42,990 --> 00:19:47,500
address %uh here ends and 70 ETF

305
00:19:47,500 --> 00:19:50,500
there is a $5 by corruption

306
00:19:50,500 --> 00:19:57,500
and if you can remember those 10 but
remember mother was your mind you later

307
00:19:58,410 --> 00:20:02,120
aka so what's the specs actually do

308
00:20:02,120 --> 00:20:06,220
um if we look at what to say jump to you
be

309
00:20:06,220 --> 00:20:09,750
we see where jumps we disassemble echoed
and

310
00:20:09,750 --> 00:20:15,400
we can see that microsoft has in it

311
00:20:15,400 --> 00:20:19,669
CNN's Piers called some additional
function restore the registers

312
00:20:19,669 --> 00:20:22,789
I and then it will return back to where

313
00:20:22,789 --> 00:20:26,539
'em the jump came from this particular
function at their

314
00:20:26,539 --> 00:20:30,150
the tropics that the calling interests
are referenced counter

315
00:20:30,150 --> 00:20:34,809
and this is a use after free blog so
their mixture that they re always

316
00:20:34,809 --> 00:20:39,020
interment this reference count arm likes
of actually write a blog about this

317
00:20:39,020 --> 00:20:41,640
let's say you know we know that

318
00:20:41,640 --> 00:20:45,299
this produces a memory leak because
we're never free in this memory but at

319
00:20:45,299 --> 00:20:46,960
least preventing the vulnerability

320
00:20:46,960 --> 00:20:50,030
from expert be exploited as we

321
00:20:50,030 --> 00:20:55,820
avoid the free don't whatever for

322
00:20:55,820 --> 00:20:58,919
one other thing that I want to point out

323
00:20:58,919 --> 00:21:01,960
this other code here

324
00:21:01,960 --> 00:21:05,049
did not show up in the czech image up
but

325
00:21:05,049 --> 00:21:08,500
as a corruption and

326
00:21:08,500 --> 00:21:11,640
we just saw the two jobs not this
additional code

327
00:21:11,640 --> 00:21:15,900
in the reason for that is the check
image extension only considers

328
00:21:15,900 --> 00:21:20,210
code in there is a limited size so any
bites that are outside that

329
00:21:20,210 --> 00:21:24,870
its size are not considered for
potential corruption

330
00:21:24,870 --> 00:21:28,179
so basically Microsoft went to the end a
actual code

331
00:21:28,179 --> 00:21:35,179
growth additional code and then just put
a reference to a to jump to it

332
00:21:35,770 --> 00:21:40,200
lookup so let's continue on this first
to reverse engineering

333
00:21:40,200 --> 00:21:43,720
figure out how this patch its formats a

334
00:21:43,720 --> 00:21:47,809
process and other popular handles a

335
00:21:47,809 --> 00:21:51,850
other couple slides ago I highlighted
those bites and

336
00:21:51,850 --> 00:21:57,570
in bold for you um

337
00:21:57,570 --> 00:22:03,260
December 5 is a its little endian so
sleaze in a bit first

338
00:22:03,260 --> 00:22:08,909
but first so that fire was you know for
five by corruption we see the

339
00:22:08,909 --> 00:22:15,690
EF 70 those for the lower 16 bits for
that address

340
00:22:15,690 --> 00:22:19,080
we see these are the 5 bytes where

341
00:22:19,080 --> 00:22:22,539
expected 5 bytes this is another

342
00:22:22,539 --> 00:22:27,440
5 fell by EF 70 for some reason I don't
have that

343
00:22:27,440 --> 00:22:30,480
boxed and these are the fibroids

344
00:22:30,480 --> 00:22:35,750
that are now prompting those original
five

345
00:22:35,750 --> 00:22:40,630
so this is a to a general idea and let's
see how Windows Server

346
00:22:40,630 --> 00:22:44,789
actually purses impression I should say
that this this don't book packs right

347
00:22:44,789 --> 00:22:45,880
here

348
00:22:45,880 --> 00:22:49,740
if you go back to the stbx checks in
multiple

349
00:22:49,740 --> 00:22:52,799
angry about that Bay 64 blog

350
00:22:52,799 --> 00:22:59,799
that's the looks like it's just these
bites that's why did the

351
00:22:59,820 --> 00:23:03,169
the cup so hollis a here's a very

352
00:23:03,169 --> 00:23:06,679
high-level view of with P loader

353
00:23:06,679 --> 00:23:10,600
does what is supplying injury i fix it

354
00:23:10,600 --> 00:23:16,289
its a initialize aspersion engine it

355
00:23:16,289 --> 00:23:20,030
resolves a function within the laptop de
lo called

356
00:23:20,030 --> 00:23:23,970
SCD loaded as he stands for she
mentioned

357
00:23:23,970 --> 00:23:27,799
within that function that calls patch
key modules

358
00:23:27,799 --> 00:23:31,419
attempt patches and a.m.

359
00:23:31,419 --> 00:23:34,650
and apply patch and the

360
00:23:34,650 --> 00:23:38,120
applied text function is the one
actually does the work for processing

361
00:23:38,120 --> 00:23:44,010
this patch bits information

362
00:23:44,010 --> 00:23:47,529
ca so here's some city code
representation of this function

363
00:23:47,529 --> 00:23:51,610
it takes a pointer to a patch but
structure this is a

364
00:23:51,610 --> 00:23:55,110
structure I I came up with so it's my
name for I don't know what Microsoft

365
00:23:55,110 --> 00:23:56,090
calls a

366
00:23:56,090 --> 00:23:59,090
I but essentially it's gonna iterate
through

367
00:23:59,090 --> 00:24:02,360
all I am a click on Patch

368
00:24:02,360 --> 00:24:06,080
actions in a patch actually to be either
a match

369
00:24:06,080 --> 00:24:09,270
or or replace action

370
00:24:09,270 --> 00:24:12,320
from so if it's a a match action

371
00:24:12,320 --> 00:24:16,559
its just gonna do men compare up the
pattern specified

372
00:24:16,559 --> 00:24:19,929
um for some model-based plus

373
00:24:19,929 --> 00:24:24,080
an RB a for the pattern size if it two
matches

374
00:24:24,080 --> 00:24:28,720
it continues along just fine otherwise
it returns about

375
00:24:28,720 --> 00:24:32,470
if third-place action it's going to
change them every Commission

376
00:24:32,470 --> 00:24:35,950
love the area specified so go to r-va
for the

377
00:24:35,950 --> 00:24:40,230
number by specified ill make that memory
retractable

378
00:24:40,230 --> 00:24:44,919
bill then copy the bites that you want
into that new member area

379
00:24:44,919 --> 00:24:47,980
and then restore the person's back to
you original so

380
00:24:47,980 --> 00:24:53,309
retexture where they were than a foot
infection cash

381
00:24:53,309 --> 00:24:57,700
on will continue to do this still gets
to

382
00:24:57,700 --> 00:25:04,230
a.m. and essentially

383
00:25:04,230 --> 00:25:07,910
so along with the SEO pipettes function

384
00:25:07,910 --> 00:25:11,850
that we're just looking out a that help
deal has

385
00:25:11,850 --> 00:25:15,290
195 exports Microsoft has

386
00:25:15,290 --> 00:25:19,290
documents and somewhat at this location

387
00:25:19,290 --> 00:25:24,809
aren't they don't provide a any header
files for you to use or a library to

388
00:25:24,809 --> 00:25:25,910
link against

389
00:25:25,910 --> 00:25:29,020
so it's kinda cool a manual process to

390
00:25:29,020 --> 00:25:33,540
to create those a the code to a release
in

391
00:25:33,540 --> 00:25:36,550
has all that interpolation in there for
you

392
00:25:36,550 --> 00:25:41,650
up call the function names and so city
sometime

393
00:25:41,650 --> 00:25:45,929
this is this labor can be used to read
and write

394
00:25:45,929 --> 00:25:49,630
her crate has to be files on

395
00:25:49,630 --> 00:25:53,970
the documentation is definitely lacking
its you know

396
00:25:53,970 --> 00:25:58,000
been liking for many years like 2007

397
00:25:58,000 --> 00:26:02,670
l2 talking about lucky if patients so
welcome I was having with it was I want

398
00:26:02,670 --> 00:26:04,840
to extract out that patch bits area

399
00:26:04,840 --> 00:26:07,929
which the binary field and

400
00:26:07,929 --> 00:26:11,090
you're required to give this function a
buffer

401
00:26:11,090 --> 00:26:14,640
in a buffer size and I'm thinking
waterway

402
00:26:14,640 --> 00:26:18,230
know I'll be dispatched but serious were
dry figured out and I'm

403
00:26:18,230 --> 00:26:21,960
staring at this documentation Microsoft
for hours

404
00:26:21,960 --> 00:26:26,110
nothingness comment to maligned and
finally I just

405
00:26:26,110 --> 00:26:29,850
product has to be Jackson on I don't
appear to have it how do they do it

406
00:26:29,850 --> 00:26:34,030
and they're using this up undocumented
function called get tagged decis

407
00:26:34,030 --> 00:26:38,429
they'll give it a cited that it does not

408
00:26:38,429 --> 00:26:41,780
to tend to go to actually parse out what
these

409
00:26:41,780 --> 00:26:46,450
in every pets pets areas are on so
that's something were to get you in

410
00:26:46,450 --> 00:26:51,610
so in

411
00:26:51,610 --> 00:26:54,920
s2000 self are binary files

412
00:26:54,920 --> 00:26:58,790
I'm here's a a very simply re: brought
the other searching for

413
00:26:58,790 --> 00:27:01,950
for follows Peter um

414
00:27:01,950 --> 00:27:06,000
you'll find a lot there's a lot of
default St Paul's on your computer

415
00:27:06,000 --> 00:27:09,050
they are as to be files that are
packaged with

416
00:27:09,050 --> 00:27:12,870
installers for old games to make sure
that you know

417
00:27:12,870 --> 00:27:16,380
the resolution is set right so this will
give you

418
00:27:16,380 --> 00:27:20,000
a lotta crap by using suture so might
the

419
00:27:20,000 --> 00:27:24,350
better to modify this to look for now
only this magic

420
00:27:24,350 --> 00:27:28,070
a string St bf to also look for

421
00:27:28,070 --> 00:27:31,620
these files that contain a on patched
bits

422
00:27:31,620 --> 00:27:35,940
tag ID with them as well I'm set
something that

423
00:27:35,940 --> 00:27:42,419
together interested can do so

424
00:27:42,419 --> 00:27:45,730
here's a structure that I cuppa first

425
00:27:45,730 --> 00:27:48,950
there's match operations replace
operations

426
00:27:48,950 --> 00:27:52,040
40% respectively on

427
00:27:52,040 --> 00:27:57,809
you got a up code which is either a
match replace Steve got

428
00:27:57,809 --> 00:28:01,940
action size on which is the total size a

429
00:28:01,940 --> 00:28:06,480
the structure the pattern size for the
number by see what to search for a

430
00:28:06,480 --> 00:28:07,750
reporter place

431
00:28:07,750 --> 00:28:11,059
the r-va um

432
00:28:11,059 --> 00:28:16,350
and then a model and that we take that

433
00:28:16,350 --> 00:28:20,030
it applied to that same packed up and
can overlay it beat

434
00:28:20,030 --> 00:28:23,520
did the start make some sense so this
data so bc it starts with

435
00:28:23,520 --> 00:28:28,330
the number four which is for a match we
see 59

436
00:28:28,330 --> 00:28:31,400
is the size love the first

437
00:28:31,400 --> 00:28:35,010
action so to go to offset 59 in here

438
00:28:35,010 --> 00:28:39,780
we see if the two which would be
replaced so we know that it's just

439
00:28:39,780 --> 00:28:43,050
patch better patch action after patch
action

440
00:28:43,050 --> 00:28:49,179
I am 5 with that find that weird how it
before which is the number but

441
00:28:49,179 --> 00:28:52,610
search for this four bytes here

442
00:28:52,610 --> 00:28:56,870
it's your b-day and then here is the
model name

443
00:28:56,870 --> 00:29:01,240
which is not terminated and then after
the model name

444
00:29:01,240 --> 00:29:04,820
which I is the spatter to search for

445
00:29:04,820 --> 00:29:09,130
you'll notice that there's this big
block earth

446
00:29:09,130 --> 00:29:13,720
crop I'll call it from here to here

447
00:29:13,720 --> 00:29:17,890
that contains this random data fun

448
00:29:17,890 --> 00:29:21,090
and this is kinda what I'm talking about
simple if wishes clear

449
00:29:21,090 --> 00:29:24,929
on

450
00:29:24,929 --> 00:29:28,580
and so that

451
00:29:28,580 --> 00:29:32,020
the Muslim field is a fixed-length up

452
00:29:32,020 --> 00:29:35,330
64 bytes so 32 characters

453
00:29:35,330 --> 00:29:41,130
it contains uninitialized data from
likes of course that they use to you

454
00:29:41,130 --> 00:29:45,300
treaties Texas a they don't 0 its

455
00:29:45,300 --> 00:29:48,760
on have told them about this

456
00:29:48,760 --> 00:29:52,950
and their releases last one it still had
under slave status I don't know if they

457
00:29:52,950 --> 00:29:53,919
really care

458
00:29:53,919 --> 00:29:58,720
on ir I did option too much full

459
00:29:58,720 --> 00:30:03,380
the stash LA will go through and gravel
although nationalized a todos

460
00:30:03,380 --> 00:30:07,550
each patch action on it and save it to a
file for you

461
00:30:07,550 --> 00:30:11,710
I've done that for up to four except
that I've mentioned

462
00:30:11,710 --> 00:30:15,360
be getting I define things useful but
maybe someone to do something useful

463
00:30:15,360 --> 00:30:17,260
ovitz

464
00:30:17,260 --> 00:30:20,760
Anna it either stack or heap data

465
00:30:20,760 --> 00:30:23,830
in whatever toilet mix of uses creative
things says

466
00:30:23,830 --> 00:30:27,919
kindly for a fixed to patches that

467
00:30:27,919 --> 00:30:33,050
are crazy so much why I Richard 0 this
up

468
00:30:33,050 --> 00:30:36,179
and seismicity time to start talking
about

469
00:30:36,179 --> 00:30:40,380
on by chill here

470
00:30:40,380 --> 00:30:44,700
I've already mentioned hiking go about
installing us to be files

471
00:30:44,700 --> 00:30:48,760
with my tall up I can print match at
trees

472
00:30:48,760 --> 00:30:52,850
and I can dump this leak memory so we're
to focus on

473
00:30:52,850 --> 00:30:56,790
what a culprit in a tree pretty other
pets details

474
00:30:56,790 --> 00:31:03,790
and crimp edges so

475
00:31:03,980 --> 00:31:08,450
this is the print tree option is Dashti

476
00:31:08,450 --> 00:31:11,809
and the sprints and very similar
information to

477
00:31:11,809 --> 00:31:15,090
a s to beat XML but there's

478
00:31:15,090 --> 00:31:19,270
couple additions besides prolly looks
ugly

479
00:31:19,270 --> 00:31:23,730
um on the left to the each tagged

480
00:31:23,730 --> 00:31:26,890
is a tag ID

481
00:31:26,890 --> 00:31:30,610
fall by tag in the the stack code here
705 means

482
00:31:30,610 --> 00:31:34,550
patch 600 01 means name

483
00:31:34,550 --> 00:31:37,630
those numbers there are documented by
myself but they made

484
00:31:37,630 --> 00:31:41,380
but what's but i think is cool about
this it's now

485
00:31:41,380 --> 00:31:44,740
this is the same if wish we had before
with

486
00:31:44,740 --> 00:31:47,890
their explore the message all entries

487
00:31:47,890 --> 00:31:51,110
and then the Petra we see is 218

488
00:31:51,110 --> 00:31:55,580
or hacks Daha now we see that this is
actually DA

489
00:31:55,580 --> 00:31:58,640
a appear so now we have that linkage

490
00:31:58,640 --> 00:32:02,179
between a particular

491
00:32:02,179 --> 00:32:05,750
match entry and associated patch its
area

492
00:32:05,750 --> 00:32:09,440
I'm so we can tie the two together

493
00:32:09,440 --> 00:32:12,590
um to view catches you need to

494
00:32:12,590 --> 00:32:15,980
army use one of these five things either
a

495
00:32:15,980 --> 00:32:21,700
a patched ID era patch bits I D E or
patch ref ID

496
00:32:21,700 --> 00:32:25,200
or pastel ready or check some and so
I've highlighted

497
00:32:25,200 --> 00:32:32,150
them on this on the flight here

498
00:32:32,150 --> 00:32:35,919
apps are so

499
00:32:35,919 --> 00:32:39,610
the two letters to drop his first plane
touches PNS

500
00:32:39,610 --> 00:32:42,880
P you use for you

501
00:32:42,880 --> 00:32:46,200
all those patched I got to use that I
was talking about before

502
00:32:46,200 --> 00:32:53,200
Sule excuse with the the check some

503
00:32:53,909 --> 00:32:57,980
hit so this displays out information
nicely

504
00:32:57,980 --> 00:33:02,130
it shows you the model that the
targeting the popular action but there

505
00:33:02,130 --> 00:33:04,059
was a match replace

506
00:33:04,059 --> 00:33:08,120
exercise parents eyes r-va with with
that

507
00:33:08,120 --> 00:33:12,220
um and in the bites so this is going to
to match operation

508
00:33:12,220 --> 00:33:16,260
at their RB 80 the bites and I'm sure
the disassembly of

509
00:33:16,260 --> 00:33:19,290
those five bites which is that's just
some

510
00:33:19,290 --> 00:33:22,550
the standard function beginning

511
00:33:22,550 --> 00:33:26,040
and then second action here was a replay
section

512
00:33:26,040 --> 00:33:29,140
that are PA mix it up

513
00:33:29,140 --> 00:33:32,909
and that's the same thing that we saw a
using the check image

514
00:33:32,909 --> 00:33:38,070
extension on now this

515
00:33:38,070 --> 00:33:42,560
he give the dash high option this will
dump it in the area

516
00:33:42,560 --> 00:33:47,510
I to Python script former I was really
ready made a

517
00:33:47,510 --> 00:33:51,320
I to plug in for this and I think on the
process

518
00:33:51,320 --> 00:33:56,700
not funny and I was running out of time
and i ended up just

519
00:33:56,700 --> 00:34:01,040
making this happen reflects so I
basically bring in the model that you

520
00:34:01,040 --> 00:34:03,540
care about and I don't

521
00:34:03,540 --> 00:34:07,870
you in a run this tool against recipe
file copy and paste this into

522
00:34:07,870 --> 00:34:12,070
I to run it I'm in the school print the
console window

523
00:34:12,070 --> 00:34:15,480
there is patching so many bites that
some address and then you can either go

524
00:34:15,480 --> 00:34:16,379
into

525
00:34:16,379 --> 00:34:19,950
you're a patch bites menu or you can
just double click on the consulate will

526
00:34:19,950 --> 00:34:21,919
bring it to you the Associated

527
00:34:21,919 --> 00:34:25,780
I could reasons for this happens and

528
00:34:25,780 --> 00:34:29,330
so we can see here that on these

529
00:34:29,330 --> 00:34:33,310
two small ones are that's just applying
that book

530
00:34:33,310 --> 00:34:36,850
that's making the jump and these big
lines here that

531
00:34:36,850 --> 00:34:40,190
words putting the additional code at the
end of her

532
00:34:40,190 --> 00:34:45,389
the image hmmm

533
00:34:45,389 --> 00:34:50,429
Kessel's what I will help keep it our
own Texas

534
00:34:50,429 --> 00:34:53,909
I require depression you target need to
know

535
00:34:53,909 --> 00:34:57,220
target model or models so that could be

536
00:34:57,220 --> 00:35:01,200
a deal within the application HRN or can
be

537
00:35:01,200 --> 00:35:05,050
the application itself are mandatory
requirement because at that

538
00:35:05,050 --> 00:35:10,130
six-point field is that the the name has
to be less than 30 characters

539
00:35:10,130 --> 00:35:14,970
so 31 and it mister the Notre later that

540
00:35:14,970 --> 00:35:19,430
I need to know the RBS that your target
in pre their match replaces

541
00:35:19,430 --> 00:35:25,569
and the bites they were put there its
get politicians Pacific

542
00:35:25,569 --> 00:35:29,240
so I created a a config file that much
cool

543
00:35:29,240 --> 00:35:33,030
processes to create this on they have
tipped

544
00:35:33,030 --> 00:35:36,270
be getting and with the issue no tags
that I have

545
00:35:36,270 --> 00:35:41,730
discussed by the application name ID be
named to be anything that's what we'll

546
00:35:41,730 --> 00:35:42,339
end up sheesh

547
00:35:42,339 --> 00:35:46,230
um bill and up in your registry

548
00:35:46,230 --> 00:35:50,830
I am when I when I showed her the
screenshot before there was one

549
00:35:50,830 --> 00:35:54,260
to look like a comment it was CE

550
00:35:54,260 --> 00:35:58,510
you know XYZ dust or shopping diva named

551
00:35:58,510 --> 00:36:01,609
I have some comments and there's really
three things to do

552
00:36:01,609 --> 00:36:05,420
there's PE are in Mr subkey

553
00:36:05,420 --> 00:36:08,420
all the fine on a new

554
00:36:08,420 --> 00:36:12,900
matching policy entry and so within a
massive piles entry

555
00:36:12,900 --> 00:36:16,190
all a lie you to do has given a target
model

556
00:36:16,190 --> 00:36:19,700
which can be a deal all or sometimes
image name

557
00:36:19,700 --> 00:36:24,150
an option up so you can have a peach XO

558
00:36:24,150 --> 00:36:27,290
within a Pete act you can have

559
00:36:27,290 --> 00:36:31,330
are for Mr are does replace action

560
00:36:31,330 --> 00:36:36,280
II I think looking back I probably
should've called this

561
00:36:36,280 --> 00:36:39,280
a.m. a right action that makes more
sense but

562
00:36:39,280 --> 00:36:43,330
but I really dislike culture place so
its the total placer

563
00:36:43,330 --> 00:36:46,740
makes more sense to just cooperate a

564
00:36:46,740 --> 00:36:50,730
sore right you have a target model again
r-va

565
00:36:50,730 --> 00:36:54,010
and extra bites that you want to write
to

566
00:36:54,010 --> 00:36:57,630
that particular r-pa

567
00:36:57,630 --> 00:37:01,010
be a immerse does

568
00:37:01,010 --> 00:37:04,240
I'm at a place called the so you harvey
et

569
00:37:04,240 --> 00:37:08,400
here extremely you want to search for
and in the extreme that you want to

570
00:37:08,400 --> 00:37:13,750
to right there

571
00:37:13,750 --> 00:37:17,310
so occurred a separate forget that we
can go after

572
00:37:17,310 --> 00:37:20,970
this is included in the GitHub
repository

573
00:37:20,970 --> 00:37:25,580
a basically this code loads a message
will be lol

574
00:37:25,580 --> 00:37:29,109
it does I get progress for this a

575
00:37:29,109 --> 00:37:34,190
expert appraisal bill Prince up to our
BA for you and Prince out

576
00:37:34,190 --> 00:37:37,430
15 by some memory starting at Darby
minutes 5

577
00:37:37,430 --> 00:37:40,630
and then a Prince of the disassembly for
you

578
00:37:40,630 --> 00:37:45,480
so did the something the some target

579
00:37:45,480 --> 00:37:49,100
now I I took that same screen from the

580
00:37:49,100 --> 00:37:53,140
price I put it here and I've got a
simple

581
00:37:53,140 --> 00:37:56,410
configuration for first target program

582
00:37:56,410 --> 00:38:00,040
I hope you guys can see the soca but
again

583
00:38:00,040 --> 00:38:03,180
your application name some type of
comment

584
00:38:03,180 --> 00:38:06,420
um then we're going to I want to target

585
00:38:06,420 --> 00:38:09,830
this I message you know the OLG low with
in

586
00:38:09,830 --> 00:38:14,100
to start the application and I want to
do a metre place action

587
00:38:14,100 --> 00:38:17,250
for the steel at this r-va

588
00:38:17,250 --> 00:38:20,290
50 be that

589
00:38:20,290 --> 00:38:23,569
here 50 be going to look for

590
00:38:23,569 --> 00:38:27,100
these up codes which is what I get
listed here

591
00:38:27,100 --> 00:38:30,740
and I'm going to replace that with cccc

592
00:38:30,740 --> 00:38:34,870
then I'm going to do our place action
for the same deal

593
00:38:34,870 --> 00:38:39,160
at 506 which is appear to be getting

594
00:38:39,160 --> 00:38:46,040
and to put bites wanted it for them

595
00:38:46,040 --> 00:38:49,670
on sowie using the tool you give

596
00:38:49,670 --> 00:38:53,740
the dashed couple see option but the
configuration file you created

597
00:38:53,740 --> 00:38:59,600
and %uh show to arm just given up a name
for the ass to follow that

598
00:38:59,600 --> 00:39:04,230
I'm just ready now this is this process
is complete file

599
00:39:04,230 --> 00:39:07,580
on that puts out some W impression this
was really firmly

600
00:39:07,580 --> 00:39:11,270
um but it may be useful to you guys

601
00:39:11,270 --> 00:39:16,290
are you doing so well a then

602
00:39:16,290 --> 00:39:19,580
we take this st. Paul we go back to

603
00:39:19,580 --> 00:39:22,910
the permit gonna run it with the dash
are to install it

604
00:39:22,910 --> 00:39:26,640
or we use St instead we don't care about
that we programs

605
00:39:26,640 --> 00:39:30,010
thing and we saw on the system then

606
00:39:30,010 --> 00:39:33,250
when the rerun simple target we can see
that

607
00:39:33,250 --> 00:39:36,589
at of that be

608
00:39:36,589 --> 00:39:40,190
their cccc so probably did

609
00:39:40,190 --> 00:39:43,730
the mat replace and then we can see that
it did overwrite

610
00:39:43,730 --> 00:39:47,819
at 506 with 1234 and the

611
00:39:47,819 --> 00:39:53,410
the disassembly there doesn't make sense
cuz 1234 is something weird

612
00:39:53,410 --> 00:39:57,000
I'm so how does this all work

613
00:39:57,000 --> 00:40:02,220
on whether you double click on something
or the runs but let's play online

614
00:40:02,220 --> 00:40:08,130
it's a pair processes job to do a quick
process which calls for process internal

615
00:40:08,130 --> 00:40:12,300
and that preprocess internal determines
if the target needs to be shipped

616
00:40:12,300 --> 00:40:15,430
it go to the registry to the custom

617
00:40:15,430 --> 00:40:19,880
folder it looks does this image in a
match what I'm about to run

618
00:40:19,880 --> 00:40:23,109
the under is are associated Jim Davis
fall for this application

619
00:40:23,109 --> 00:40:26,370
if it does it's a similar flags and lets
the

620
00:40:26,370 --> 00:40:29,850
the child %uh start-up now the child

621
00:40:29,850 --> 00:40:33,339
P loader looks for a flag that Sat

622
00:40:33,339 --> 00:40:36,700
and determines if it should attempt to
you

623
00:40:36,700 --> 00:40:41,690
look for shows play it so yeah uses to
determine if it should look for shims

624
00:40:41,690 --> 00:40:45,589
a so it's their ill do that same go to
the registry

625
00:40:45,589 --> 00:40:49,380
my target yes there's as to be
phosphorylated

626
00:40:49,380 --> 00:40:53,100
apply it on this is

627
00:40:53,100 --> 00:40:57,259
kinda very big what I'm saying here but
Alexander

628
00:40:57,260 --> 00:41:00,270
give some details %uh how this works it
should read a

629
00:41:00,270 --> 00:41:03,350
block time so

630
00:41:03,350 --> 00:41:07,580
for the book in this the concert this
environment variable here

631
00:41:07,580 --> 00:41:10,930
and this is output from Sysinternals

632
00:41:10,930 --> 00:41:14,080
to bug you and

633
00:41:14,080 --> 00:41:18,330
its kinda small apologize but I'll just
put a couple things

634
00:41:18,330 --> 00:41:22,160
it has application name here to be
getting this says Stax

635
00:41:22,160 --> 00:41:26,730
the um just think that's simple target

636
00:41:26,730 --> 00:41:30,450
um then it clears

637
00:41:30,450 --> 00:41:34,210
some flags that was set

638
00:41:34,210 --> 00:41:38,440
then attempts to do a patch and it fails
because

639
00:41:38,440 --> 00:41:42,810
a message no deal has not been loaded
yet into the processor is Bess

640
00:41:42,810 --> 00:41:46,089
later on we see a SC

641
00:41:46,089 --> 00:41:51,120
deal a loaded says hey I finish loading
an assist while the lol

642
00:41:51,120 --> 00:41:55,040
then SC I apply patch

643
00:41:55,040 --> 00:41:59,770
actually does faction does the right's
it does the match does the right's

644
00:41:59,770 --> 00:42:05,080
and it says yes I successfully apply one
up on patches

645
00:42:05,080 --> 00:42:08,900
um

646
00:42:08,900 --> 00:42:13,060
so no thanks I'll meet in person

647
00:42:13,060 --> 00:42:16,880
so principally we can just target

648
00:42:16,880 --> 00:42:21,270
exporter exit patch when maim look at
two

649
00:42:21,270 --> 00:42:27,359
preprocess Cup so this is a sample pic
file for explore

650
00:42:27,359 --> 00:42:31,150
win 7 64 bit um

651
00:42:31,150 --> 00:42:34,810
he give Appian tree 4x4 txt

652
00:42:34,810 --> 00:42:38,660
the doesn't have to be a deal he give
the I gave it a Pacific

653
00:42:38,660 --> 00:42:42,339
P checks on the care up this

654
00:42:42,339 --> 00:42:45,930
r-va here is for when main

655
00:42:45,930 --> 00:42:50,290
and I overwrite the first bites with a
jump

656
00:42:50,290 --> 00:42:54,690
then this is at the end of the image
size that's just my show code

657
00:42:54,690 --> 00:42:58,069
I'm included and give up is the

658
00:42:58,069 --> 00:43:04,620
configuration files for win 7 32 bit 64
bit and when a 32 bit

659
00:43:04,620 --> 00:43:08,480
so if you took this traded you're used
to

660
00:43:08,480 --> 00:43:13,560
the tool with Desi and then

661
00:43:13,560 --> 00:43:17,609
I get up but not a Python script

662
00:43:17,609 --> 00:43:21,490
we'll explore entire to this is what
basically we'll see

663
00:43:21,490 --> 00:43:24,720
so before thick said out to fix it

664
00:43:24,720 --> 00:43:27,870
it just has that jump instructions on
doing

665
00:43:27,870 --> 00:43:31,339
if you follow the jump

666
00:43:31,339 --> 00:43:35,279
this is my show code a at a ratio code
for a living so

667
00:43:35,279 --> 00:43:39,830
a lot better base then this I save all
the registers I

668
00:43:39,830 --> 00:43:44,040
cock reprocess restore the registers and
come back to

669
00:43:44,040 --> 00:43:48,600
jump back to main so what do we do about
this

670
00:43:48,600 --> 00:43:53,180
are you could disable the same engine I
can do through Group Policy

671
00:43:53,180 --> 00:43:56,560
I don't recommend doing this I'll break

672
00:43:56,560 --> 00:44:00,160
emit it all basically

673
00:44:00,160 --> 00:44:03,580
make it easier to fix to the Microsoft
releases

674
00:44:03,580 --> 00:44:06,779
pointless a but it is possible on

675
00:44:06,779 --> 00:44:10,370
there's probably some other unintended a
consequences

676
00:44:10,370 --> 00:44:13,819
love disable it

677
00:44:13,819 --> 00:44:18,279
I'll should searcher

678
00:44:18,279 --> 00:44:23,170
such a registry I'll pasta soup or St
files

679
00:44:23,170 --> 00:44:27,130
is a YA veo provided arm

680
00:44:27,130 --> 00:44:30,620
your system is going to have to be
follows their normal

681
00:44:30,620 --> 00:44:34,870
on they're not all bad there's lots and
lots of good

682
00:44:34,870 --> 00:44:38,029
that was out there but you can use the
knowledge again today a

683
00:44:38,029 --> 00:44:41,799
how to use some these tools to be able
to figure out what are these false

684
00:44:41,799 --> 00:44:45,710
actually doing on your system and then
you can focus on

685
00:44:45,710 --> 00:44:49,190
okay I know all these are normal this
one doesn't look normal what does this

686
00:44:49,190 --> 00:44:50,900
actually do

687
00:44:50,900 --> 00:44:54,839
other runs from Sysinternals does not
consider

688
00:44:54,839 --> 00:44:59,060
officials bitterly fixes as on

689
00:44:59,060 --> 00:45:02,900
as a persistence mechanism so whether
they're

690
00:45:02,900 --> 00:45:06,580
something like I could hear this in
memory patch fix it

691
00:45:06,580 --> 00:45:09,580
I or some other things at work but he
talked about

692
00:45:09,580 --> 00:45:13,290
assistant roles does not a two separate

693
00:45:13,290 --> 00:45:18,710
arm I told likes of that they should as
signature sport st. files

694
00:45:18,710 --> 00:45:22,750
%uh you know my copy the Explorer signed
but yet

695
00:45:22,750 --> 00:45:26,100
if you lets me have my own signed code

696
00:45:26,100 --> 00:45:30,240
patch in memory and do weird things so
maybe they should

697
00:45:30,240 --> 00:45:37,240
let us know that some non sine st. Paul
is running are about to run

698
00:45:38,480 --> 00:45:43,940
fun in this is a feature that this is
not something that's making you more

699
00:45:43,940 --> 00:45:44,589
vulnerable

700
00:45:44,589 --> 00:45:48,160
I V this a default on your system

701
00:45:48,160 --> 00:45:53,339
on someone needs to be administrator on
your box to install these

702
00:45:53,339 --> 00:45:57,150
so if that that far your you're already
own

703
00:45:57,150 --> 00:46:01,060
but this is kinda just a new way that
you might not be considering how they're

704
00:46:01,060 --> 00:46:03,420
maintaining persistence on your system

705
00:46:03,420 --> 00:46:06,529
on and

706
00:46:06,529 --> 00:46:10,319
this third bill is really would is

707
00:46:10,319 --> 00:46:13,970
I think I also it this provides a great
opportunity to

708
00:46:13,970 --> 00:46:17,290
figure out but Microsoft is doing pixie

709
00:46:17,290 --> 00:46:20,660
things other it's so much easier to look
at

710
00:46:20,660 --> 00:46:24,140
to changes versus 100 some changes to
try to figure out

711
00:46:24,140 --> 00:46:27,510
what Microsoft did the try to prevent
exploitation and

712
00:46:27,510 --> 00:46:32,230
me if I mentioned earlier X isn't all
guys

713
00:46:32,230 --> 00:46:36,029
looked at some fix its eye care which 1i
was

714
00:46:36,029 --> 00:46:40,430
of summer hat but they showed within
that you know probably a dare

715
00:46:40,430 --> 00:46:44,680
couple hours probably that the pics at
the marks are provided for something was

716
00:46:44,680 --> 00:46:45,310
told he is

717
00:46:45,310 --> 00:46:49,900
insufficient to the defined away around
that too 28 code exact

718
00:46:49,900 --> 00:46:54,279
um and on

719
00:46:54,279 --> 00:46:58,049
so now you guys should know about his
tools which will help you

720
00:46:58,049 --> 00:47:02,299
a to your notice

721
00:47:02,299 --> 00:47:05,920
so sure some references if you guys are
really interested in this you should

722
00:47:05,920 --> 00:47:06,970
read the

723
00:47:06,970 --> 00:47:10,940
the paper that's on the couple CD on

724
00:47:10,940 --> 00:47:15,440
plus a good information there a.m.

725
00:47:15,440 --> 00:47:18,839
thanks to my way for friendless

726
00:47:18,839 --> 00:47:22,510
a by what I said a baby last week

727
00:47:22,510 --> 00:47:26,990
a one week old nightly which kinda
sucked us the thinker

728
00:47:26,990 --> 00:47:30,210
thanks to our soft I cited by Kat

729
00:47:30,210 --> 00:47:34,370
and as I can reach me

730
00:47:34,370 --> 00:47:37,850
by email Twitter a and this

731
00:47:37,850 --> 00:47:41,279
source code link this is now on the
conference cities so can take a picture

732
00:47:41,279 --> 00:47:42,010
or

733
00:47:42,010 --> 00:47:46,569
us an email and I'll send you a letter
and I don't if we got time for

734
00:47:46,569 --> 00:47:53,569
questions or not they would have
questions

735
00:48:04,700 --> 00:48:07,530
the question was does the Emory patch

736
00:48:07,530 --> 00:48:11,400
and believe the signature a

737
00:48:11,400 --> 00:48:15,480
shown by Process Explorer and I don't
know the answer to that question

738
00:48:15,480 --> 00:48:19,660
I would guess no areas

739
00:48:19,660 --> 00:48:26,660
to a

740
00:48:44,310 --> 00:48:47,330
for it a somewhat by the question was

741
00:48:47,330 --> 00:48:51,370
to a plan on continue to work on Ida pro
plugin

742
00:48:51,370 --> 00:48:54,640
and probably not

743
00:48:54,640 --> 00:48:57,900
and I don't think these happen

744
00:48:57,900 --> 00:49:02,340
often enough works worth my time to try
to develop

745
00:49:02,340 --> 00:49:06,630
want it I thought it was a very painful
process to do it was my first time ever

746
00:49:06,630 --> 00:49:07,540
trying

747
00:49:07,540 --> 00:49:10,860
and a better things to do

748
00:49:10,860 --> 00:49:14,630
who knows

749
00:49:14,630 --> 00:49:20,240
I will thank you

750
00:49:20,240 --> 00:49:23,880
give you anything else it to a person
after its

