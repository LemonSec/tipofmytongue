1
00:00:01,740 --> 00:00:04,810
[Music]

2
00:00:08,320 --> 00:00:11,519
hello everyone thanks for tuning in

3
00:00:11,519 --> 00:00:12,880
so um

4
00:00:12,880 --> 00:00:15,440
the title for our talks today is the

5
00:00:15,440 --> 00:00:18,640
next gen plug x shadow pad a dive into

6
00:00:18,640 --> 00:00:21,840
the emerging china nexus modular trojan

7
00:00:21,840 --> 00:00:24,880
pangolin i read

8
00:00:25,519 --> 00:00:27,039
so first

9
00:00:27,039 --> 00:00:29,039
i'll give a little bit of introduction

10
00:00:29,039 --> 00:00:30,800
about ourselves

11
00:00:30,800 --> 00:00:33,360
my name is sylvia and i'm third annual

12
00:00:33,360 --> 00:00:35,680
threat intelligence analyst from team t5

13
00:00:35,680 --> 00:00:39,680
my research interest includes osint apt

14
00:00:39,680 --> 00:00:41,840
and information operation in the apac

15
00:00:41,840 --> 00:00:44,640
region so previously i have presented my

16
00:00:44,640 --> 00:00:47,600
research at um cti summit code blue

17
00:00:47,600 --> 00:00:50,480
hitcom pacific and and etc

18
00:00:50,480 --> 00:00:53,760
and my co-presenter today is lion chang

19
00:00:53,760 --> 00:00:55,600
he is also a fair intelligence

20
00:00:55,600 --> 00:00:58,719
researcher from team t5 so his research

21
00:00:58,719 --> 00:01:01,520
interest includes reverse engineering

22
00:01:01,520 --> 00:01:04,640
apt campaign tracking in apec region as

23
00:01:04,640 --> 00:01:08,320
well as ioc security so his research can

24
00:01:08,320 --> 00:01:12,880
be seen in the jsat conference

25
00:01:12,880 --> 00:01:15,040
so this is the outline for our talk

26
00:01:15,040 --> 00:01:17,759
today first i'm going to give you some

27
00:01:17,759 --> 00:01:20,159
background information about

28
00:01:20,159 --> 00:01:22,560
the modular tools shared among the

29
00:01:22,560 --> 00:01:24,080
chinese ipt

30
00:01:24,080 --> 00:01:26,479
and then in the second section leong

31
00:01:26,479 --> 00:01:29,920
will um share an in-depth analysis of

32
00:01:29,920 --> 00:01:31,920
this malware name

33
00:01:31,920 --> 00:01:35,119
recording in progress

34
00:01:35,600 --> 00:01:36,799
um

35
00:01:36,799 --> 00:01:38,799
so in the in the second section the

36
00:01:38,799 --> 00:01:41,920
young will detail the in-depth analysis

37
00:01:41,920 --> 00:01:45,040
of this malware called pangolin red

38
00:01:45,040 --> 00:01:46,320
and then

39
00:01:46,320 --> 00:01:48,479
in the third section i'm going to share

40
00:01:48,479 --> 00:01:50,960
the activity timeline target scope and

41
00:01:50,960 --> 00:01:53,680
the attribution of this

42
00:01:53,680 --> 00:01:56,640
apt called tian which has a strong

43
00:01:56,640 --> 00:01:59,360
association with mingling at red

44
00:01:59,360 --> 00:02:00,320
and then

45
00:02:00,320 --> 00:02:02,240
in the final section and where i'm going

46
00:02:02,240 --> 00:02:05,200
to give you a conclusion outlook as well

47
00:02:05,200 --> 00:02:09,038
as counter measure to defend you a kind

48
00:02:09,038 --> 00:02:12,319
against this kind of attack

49
00:02:12,800 --> 00:02:13,920
so first

50
00:02:13,920 --> 00:02:16,879
um as we all know clock x and shadow pad

51
00:02:16,879 --> 00:02:19,200
are amongst among the most famous

52
00:02:19,200 --> 00:02:23,040
shirator among the chinese apt

53
00:02:23,040 --> 00:02:25,840
so plug x it was first discovered in

54
00:02:25,840 --> 00:02:29,840
2008 and it is a red with modular plugin

55
00:02:29,840 --> 00:02:32,239
so hence the name clock x

56
00:02:32,239 --> 00:02:34,879
so since its emergence it has been used

57
00:02:34,879 --> 00:02:37,920
by many chinese apd groups including the

58
00:02:37,920 --> 00:02:41,519
notorious apt-41 also known also tracked

59
00:02:41,519 --> 00:02:45,040
by team t5s amoeba and it is also been

60
00:02:45,040 --> 00:02:48,560
used by apt-27 dragon okay polaris

61
00:02:48,560 --> 00:02:51,280
manual pass and etc

62
00:02:51,280 --> 00:02:52,319
so

63
00:02:52,319 --> 00:02:54,640
the popularity of the malware because of

64
00:02:54,640 --> 00:02:56,400
it we have also seen a high

65
00:02:56,400 --> 00:02:59,280
detectability of this malware but

66
00:02:59,280 --> 00:03:02,159
nevertheless after its emergence for

67
00:03:02,159 --> 00:03:05,200
over a decade we still see those apt

68
00:03:05,200 --> 00:03:07,840
group using this malware with different

69
00:03:07,840 --> 00:03:10,080
kind of variants with different

70
00:03:10,080 --> 00:03:13,440
communication protocols

71
00:03:14,159 --> 00:03:16,720
on the other hand shadowpad emerged in

72
00:03:16,720 --> 00:03:21,840
2015 and it is also a modular malware

73
00:03:21,840 --> 00:03:22,879
and

74
00:03:22,879 --> 00:03:25,360
the re the relationship between plug x

75
00:03:25,360 --> 00:03:27,840
and shadowpad has been publicly

76
00:03:27,840 --> 00:03:29,360
discussed before

77
00:03:29,360 --> 00:03:30,400
and

78
00:03:30,400 --> 00:03:32,560
although there are a lot of similarity

79
00:03:32,560 --> 00:03:35,200
between these two malware group um we

80
00:03:35,200 --> 00:03:37,760
also see some difference between them so

81
00:03:37,760 --> 00:03:40,000
first is that the malware

82
00:03:40,000 --> 00:03:42,799
shadow pad is shared within a limited

83
00:03:42,799 --> 00:03:45,920
group of actors when compared to plug x

84
00:03:45,920 --> 00:03:46,720
so

85
00:03:46,720 --> 00:03:50,560
in comparison plug x is more is easier

86
00:03:50,560 --> 00:03:52,080
to access

87
00:03:52,080 --> 00:03:53,120
and then

88
00:03:53,120 --> 00:03:55,920
shadow pad is protected by layers of

89
00:03:55,920 --> 00:03:59,360
encryption and heavy objection so it

90
00:03:59,360 --> 00:04:01,640
means that it has a more advanced

91
00:04:01,640 --> 00:04:04,560
anti-analysis mechanism so some in the

92
00:04:04,560 --> 00:04:07,680
security community consider shadowpad as

93
00:04:07,680 --> 00:04:12,000
the successor of clockx

94
00:04:12,720 --> 00:04:15,439
so in fact um the modular architecture

95
00:04:15,439 --> 00:04:18,478
is not exclusive to plug x and shadow

96
00:04:18,478 --> 00:04:21,759
pad over the past few years we have seen

97
00:04:21,759 --> 00:04:24,080
a lot of other malware families that

98
00:04:24,080 --> 00:04:25,040
have

99
00:04:25,040 --> 00:04:28,000
this kind of feature or they will share

100
00:04:28,000 --> 00:04:29,199
some

101
00:04:29,199 --> 00:04:31,520
common characteristics with plug x and

102
00:04:31,520 --> 00:04:34,479
shadow pad including it the use of kcp

103
00:04:34,479 --> 00:04:37,680
protocol or they will support multiple

104
00:04:37,680 --> 00:04:39,280
c2 protocol

105
00:04:39,280 --> 00:04:41,759
and pangolin at red which is our main

106
00:04:41,759 --> 00:04:44,639
topic today is also among these power

107
00:04:44,639 --> 00:04:46,880
families

108
00:04:46,880 --> 00:04:49,759
what is noteworthy is that those malware

109
00:04:49,759 --> 00:04:54,639
are frequently used by apt41 aka amoeba

110
00:04:54,639 --> 00:04:56,960
we give the group this name because of

111
00:04:56,960 --> 00:05:00,160
its ability to constantly change its

112
00:05:00,160 --> 00:05:01,280
shape

113
00:05:01,280 --> 00:05:02,880
so um

114
00:05:02,880 --> 00:05:04,720
over the past year we have also seen

115
00:05:04,720 --> 00:05:07,280
another chinese apt called fish master

116
00:05:07,280 --> 00:05:10,960
aka luskar earth and tech 22 so um

117
00:05:10,960 --> 00:05:13,680
fishmaster has a has some ttps

118
00:05:13,680 --> 00:05:16,880
overlapped with amoeba but especially

119
00:05:16,880 --> 00:05:18,880
both groups have shared the use of

120
00:05:18,880 --> 00:05:21,520
shadowpad windy and funny switch so as

121
00:05:21,520 --> 00:05:24,000
we know three of the malware are modular

122
00:05:24,000 --> 00:05:25,440
red

123
00:05:25,440 --> 00:05:28,400
so when we discover this pangolin red in

124
00:05:28,400 --> 00:05:30,479
late 2020 we

125
00:05:30,479 --> 00:05:31,840
um

126
00:05:31,840 --> 00:05:35,280
quickly discover its malware overlap

127
00:05:35,280 --> 00:05:38,000
between pangolin ararat and the malware

128
00:05:38,000 --> 00:05:41,199
used by amoeba so this part will later

129
00:05:41,199 --> 00:05:44,479
detail um by lyon

130
00:05:44,479 --> 00:05:46,000
so

131
00:05:46,000 --> 00:05:48,639
we have categorized the cyber activity

132
00:05:48,639 --> 00:05:51,120
that use pangolin air red into this

133
00:05:51,120 --> 00:05:55,759
chinese apt group we named as tianwu

134
00:05:55,759 --> 00:05:59,520
so this is a profile of tianwu so we

135
00:05:59,520 --> 00:06:02,639
believe its origin is from china and

136
00:06:02,639 --> 00:06:04,960
then apart from the use of pangolin and

137
00:06:04,960 --> 00:06:07,840
red they also heavily used custom kobo

138
00:06:07,840 --> 00:06:09,199
stripe beacon

139
00:06:09,199 --> 00:06:11,199
and then it's ttp

140
00:06:11,199 --> 00:06:13,520
including the use of modular malware kcp

141
00:06:13,520 --> 00:06:17,360
protocol and phantom dll halloween

142
00:06:17,360 --> 00:06:20,240
so far its target region mainly was in

143
00:06:20,240 --> 00:06:22,479
the apec region and the industry have

144
00:06:22,479 --> 00:06:24,960
spent across different industries and

145
00:06:24,960 --> 00:06:27,199
that will be detailed later so in the

146
00:06:27,199 --> 00:06:28,960
next section i'm going to hand it to

147
00:06:28,960 --> 00:06:31,039
lyon and he will give you in-depth

148
00:06:31,039 --> 00:06:35,318
analysis of pangolin airport

149
00:06:37,280 --> 00:06:39,919
so hi i'm leon now i will introduce the

150
00:06:39,919 --> 00:06:42,240
detailed analysis of penguin array

151
00:06:42,240 --> 00:06:44,160
including the evolution of malware

152
00:06:44,160 --> 00:06:46,400
profile

153
00:06:46,400 --> 00:06:49,199
so first i will quickly introduce

154
00:06:49,199 --> 00:06:52,160
pencil yellow mr profile

155
00:06:52,160 --> 00:06:54,720
pancreas is a modular type of vector we

156
00:06:54,720 --> 00:06:56,960
found that angular developers have

157
00:06:56,960 --> 00:06:59,199
continued updating the mouse function

158
00:06:59,199 --> 00:07:01,120
since late

159
00:07:01,120 --> 00:07:04,000
2019 we name this children penguin array

160
00:07:04,000 --> 00:07:06,639
because its pb ptp string contains

161
00:07:06,639 --> 00:07:08,720
pangolin and its wrong type type

162
00:07:08,720 --> 00:07:11,039
information contains pla

163
00:07:11,039 --> 00:07:13,280
its functionality can be expanded by

164
00:07:13,280 --> 00:07:16,479
downloading dll from its c2 server his

165
00:07:16,479 --> 00:07:18,560
earlier version supported a

166
00:07:18,560 --> 00:07:20,720
communication protocol we believe this

167
00:07:20,720 --> 00:07:22,720
great spear under development as we

168
00:07:22,720 --> 00:07:25,360
observe its latest version support more

169
00:07:25,360 --> 00:07:28,479
than a protocol and developer continue

170
00:07:28,479 --> 00:07:31,599
use new technique to evade mutation

171
00:07:31,599 --> 00:07:33,520
and penelope is capable by passing

172
00:07:33,520 --> 00:07:35,199
various potential mechanisms and

173
00:07:35,199 --> 00:07:37,599
shuttering in the victims environment

174
00:07:37,599 --> 00:07:40,240
his trojan is like its name pangolin is

175
00:07:40,240 --> 00:07:42,960
an animal lace covered in armor and high

176
00:07:42,960 --> 00:07:46,000
in the dark knight slight activity good

177
00:07:46,000 --> 00:07:48,560
at vegan holes allow it to easily cross

178
00:07:48,560 --> 00:07:50,720
mountains

179
00:07:50,720 --> 00:07:52,639
and we have seen penguin away deploy

180
00:07:52,639 --> 00:07:55,039
numerous campaigns syria will introduce

181
00:07:55,039 --> 00:07:59,240
this part in case study later

182
00:07:59,759 --> 00:08:02,639
and in this page

183
00:08:02,720 --> 00:08:04,879
with this sum of pb string and runtime

184
00:08:04,879 --> 00:08:07,039
type information in some case

185
00:08:07,039 --> 00:08:08,800
we have found variants that only

186
00:08:08,800 --> 00:08:11,039
supports three pro quotes for serial

187
00:08:11,039 --> 00:08:13,039
communication which is the actor corey

188
00:08:13,039 --> 00:08:15,520
light core

189
00:08:17,280 --> 00:08:19,280
and now that you have a basic overview

190
00:08:19,280 --> 00:08:21,360
about pink on array we have to buy

191
00:08:21,360 --> 00:08:23,919
in-depth analysis of panel ray into four

192
00:08:23,919 --> 00:08:25,199
main parts

193
00:08:25,199 --> 00:08:27,199
first of all we will introduce the

194
00:08:27,199 --> 00:08:29,280
installer of engineering including the

195
00:08:29,280 --> 00:08:31,039
execution procedure and decryption

196
00:08:31,039 --> 00:08:33,279
method second we will share the

197
00:08:33,279 --> 00:08:36,080
evolution of ping on array and third we

198
00:08:36,080 --> 00:08:37,519
will quickly introduce the code

199
00:08:37,519 --> 00:08:42,479
similarity with ffa and weekly 2.0

200
00:08:42,640 --> 00:08:44,800
and finally we will show the pcp

201
00:08:44,800 --> 00:08:46,720
overlapped with army barcode malware

202
00:08:46,720 --> 00:08:48,640
family which some of content will not

203
00:08:48,640 --> 00:08:51,360
make public before

204
00:08:51,360 --> 00:08:53,839
so the installer is

205
00:08:53,839 --> 00:08:55,839
is reading in c-pass pass using

206
00:08:55,839 --> 00:09:00,080
microsoft mfc application for enrollable

207
00:09:00,080 --> 00:09:02,720
we have seen the developers name this

208
00:09:02,720 --> 00:09:05,360
component ffc loader from its pvp stream

209
00:09:05,360 --> 00:09:07,279
the installer will try to elevate

210
00:09:07,279 --> 00:09:09,360
privileges through calm section monica

211
00:09:09,360 --> 00:09:13,040
privilege exclusion method

212
00:09:13,200 --> 00:09:14,640
and it is worth noting that the

213
00:09:14,640 --> 00:09:16,560
installer of pencilware contains an

214
00:09:16,560 --> 00:09:18,560
additional module

215
00:09:18,560 --> 00:09:22,680
in the resource section

216
00:09:22,959 --> 00:09:25,040
so this figure describes the resource

217
00:09:25,040 --> 00:09:27,360
format the resource problem structure

218
00:09:27,360 --> 00:09:29,839
which contains the information such as

219
00:09:29,839 --> 00:09:32,240
module size css track sum

220
00:09:32,240 --> 00:09:35,360
ast and encrypted prop we will introduce

221
00:09:35,360 --> 00:09:37,680
the detail about how the package

222
00:09:37,680 --> 00:09:39,200
64

223
00:09:39,200 --> 00:09:42,480
equips modules later

224
00:09:44,320 --> 00:09:46,720
so here is the workflow of installer at

225
00:09:46,720 --> 00:09:47,839
first

226
00:09:47,839 --> 00:09:49,279
the installer will drop malware

227
00:09:49,279 --> 00:09:50,560
configuration

228
00:09:50,560 --> 00:09:52,360
with hardcoded name

229
00:09:52,360 --> 00:09:53,920
sm-cache.dat

230
00:09:53,920 --> 00:09:55,680
and next it will be compressed the

231
00:09:55,680 --> 00:09:56,720
packager

232
00:09:56,720 --> 00:09:59,040
from the results then load this module

233
00:09:59,040 --> 00:10:00,320
in memory

234
00:10:00,320 --> 00:10:02,480
after that you will call this export

235
00:10:02,480 --> 00:10:05,519
function to decrypt and drop modules

236
00:10:05,519 --> 00:10:08,320
finally the penguin away code is loaded

237
00:10:08,320 --> 00:10:09,839
in memory

238
00:10:09,839 --> 00:10:11,920
through the installer or a loader which

239
00:10:11,920 --> 00:10:14,399
dropped by white new white module

240
00:10:14,399 --> 00:10:16,640
depends on the different condition

241
00:10:16,640 --> 00:10:18,959
once core module is loaded it will

242
00:10:18,959 --> 00:10:22,399
connect to the c2 server

243
00:10:23,360 --> 00:10:24,959
and here is a module decryption

244
00:10:24,959 --> 00:10:28,079
procedure at first because duplicated

245
00:10:28,079 --> 00:10:30,880
windows api for decrypt the payload

246
00:10:30,880 --> 00:10:33,200
then code audio decompress buffer for

247
00:10:33,200 --> 00:10:34,480
decompression

248
00:10:34,480 --> 00:10:36,000
finally you will

249
00:10:36,000 --> 00:10:38,640
trigger csc trick sum of decrypted

250
00:10:38,640 --> 00:10:40,720
modules

251
00:10:40,720 --> 00:10:43,519
they are some version change in 2021

252
00:10:43,519 --> 00:10:45,680
installed of penguin array

253
00:10:45,680 --> 00:10:47,839
which includes merge this function into

254
00:10:47,839 --> 00:10:50,640
installer and select key parameter id

255
00:10:50,640 --> 00:10:51,760
with

256
00:10:51,760 --> 00:10:55,040
using harcode string

257
00:10:56,240 --> 00:10:58,560
we list all the resource id in tables in

258
00:10:58,560 --> 00:11:00,640
the following two slides the resource

259
00:11:00,640 --> 00:11:03,360
bob has two types of payload one is the

260
00:11:03,360 --> 00:11:05,839
malware configuration in pen test such

261
00:11:05,839 --> 00:11:09,120
as precision pass and situ config

262
00:11:09,120 --> 00:11:11,360
and the other one is encrypted module

263
00:11:11,360 --> 00:11:13,760
which use the execution method described

264
00:11:13,760 --> 00:11:15,600
in previous slides

265
00:11:15,600 --> 00:11:18,079
we have seen the usc bypass module in

266
00:11:18,079 --> 00:11:20,079
the new wise module

267
00:11:20,079 --> 00:11:22,160
it's for loading pancreatic core by

268
00:11:22,160 --> 00:11:26,079
using beer hijacking technique

269
00:11:26,640 --> 00:11:29,200
and indeed in this table we haven't seen

270
00:11:29,200 --> 00:11:31,839
the last three results i detect with

271
00:11:31,839 --> 00:11:34,880
asterisk but we found a layout this is

272
00:11:34,880 --> 00:11:37,519
on the fs research block you may refer

273
00:11:37,519 --> 00:11:42,440
the link for more detailed information

274
00:11:43,920 --> 00:11:46,079
and we summarize the evolution timeline

275
00:11:46,079 --> 00:11:47,920
of penguin array we believe that the

276
00:11:47,920 --> 00:11:51,680
penguin has been developers since

277
00:11:51,680 --> 00:11:54,560
2019 until now before

278
00:11:54,560 --> 00:11:57,360
2021 the actor used several evasion

279
00:11:57,360 --> 00:11:59,920
techniques from idi applications such as

280
00:11:59,920 --> 00:12:02,160
fentanyl halloween technique or check

281
00:12:02,160 --> 00:12:05,200
loaded edr driver basically the code is

282
00:12:05,200 --> 00:12:08,240
modified from open source repository

283
00:12:08,240 --> 00:12:11,000
and we will detail introduce notable

284
00:12:11,000 --> 00:12:13,920
technicians in the observed case studies

285
00:12:13,920 --> 00:12:17,440
later such as local circle injection

286
00:12:17,440 --> 00:12:21,519
or how they clear edl projects

287
00:12:22,880 --> 00:12:25,279
in case one first we have found that

288
00:12:25,279 --> 00:12:28,399
pancreatic no longer use hardcode aes iv

289
00:12:28,399 --> 00:12:30,959
value because the resource bulb contains

290
00:12:30,959 --> 00:12:31,920
an

291
00:12:31,920 --> 00:12:34,880
ast and ib value which use hashtag as

292
00:12:34,880 --> 00:12:36,320
the emitter

293
00:12:36,320 --> 00:12:38,720
second he used local circle injection

294
00:12:38,720 --> 00:12:40,959
technique to bypass easy application and

295
00:12:40,959 --> 00:12:44,079
this method is mentioned publicly before

296
00:12:44,079 --> 00:12:46,480
as you can see the loader will the

297
00:12:46,480 --> 00:12:48,399
loader of penguin array run the show

298
00:12:48,399 --> 00:12:50,320
call in memory through the windows

299
00:12:50,320 --> 00:12:53,360
callback function enum system code page

300
00:12:53,360 --> 00:12:55,680
w

301
00:12:57,040 --> 00:12:59,040
so the memory

302
00:12:59,040 --> 00:13:01,279
the developer convert penguin array call

303
00:13:01,279 --> 00:13:03,200
to show call we found the preview string

304
00:13:03,200 --> 00:13:06,639
in the encrypted shortcut which is p to

305
00:13:06,639 --> 00:13:10,320
show call and native loader

306
00:13:12,399 --> 00:13:14,160
here is the workflow of penguin array

307
00:13:14,160 --> 00:13:16,720
observer in march 2021. once the

308
00:13:16,720 --> 00:13:18,720
shortcode runs it will load ping on

309
00:13:18,720 --> 00:13:21,440
record in memory it's worth noting that

310
00:13:21,440 --> 00:13:23,920
some of module only exists in memory and

311
00:13:23,920 --> 00:13:26,079
this is the first time we have seen the

312
00:13:26,079 --> 00:13:30,560
parking manager module and online module

313
00:13:30,560 --> 00:13:33,120
from c2 server and manage we believe all

314
00:13:33,120 --> 00:13:35,440
the plugin was downloaded from c2 server

315
00:13:35,440 --> 00:13:39,200
and managed by the parking manager

316
00:13:42,160 --> 00:13:44,800
next in case tool here is the workflow

317
00:13:44,800 --> 00:13:48,160
of pancreatic observed in june 2021

318
00:13:48,160 --> 00:13:50,720
since this uh virus module we can only

319
00:13:50,720 --> 00:13:52,560
exchange

320
00:13:52,560 --> 00:13:54,079
from

321
00:13:54,079 --> 00:13:56,800
the process and analyze this module as

322
00:13:56,800 --> 00:13:59,040
much as possible to restore a complete

323
00:13:59,040 --> 00:14:01,600
workflow

324
00:14:01,600 --> 00:14:03,920
we will introduce the

325
00:14:03,920 --> 00:14:06,399
changes between case 1 and cash 2. first

326
00:14:06,399 --> 00:14:08,320
of all

327
00:14:08,320 --> 00:14:10,160
in the code

328
00:14:10,160 --> 00:14:12,560
refreshing part we found that loader of

329
00:14:12,560 --> 00:14:14,399
pancreatic array was from pancreatic

330
00:14:14,399 --> 00:14:16,959
core the loader will connect to the c2

331
00:14:16,959 --> 00:14:18,320
server which we

332
00:14:18,320 --> 00:14:20,000
that is why we call this

333
00:14:20,000 --> 00:14:23,120
component pancreas stage as for code

334
00:14:23,120 --> 00:14:26,240
marketing manager is dividing into the

335
00:14:26,240 --> 00:14:30,920
pancreatic core and product manager

336
00:14:31,120 --> 00:14:32,800
second

337
00:14:32,800 --> 00:14:35,680
the c2 config is encoded and stored in

338
00:14:35,680 --> 00:14:38,000
different resource id number

339
00:14:38,000 --> 00:14:40,000
and the third is

340
00:14:40,000 --> 00:14:42,079
the actor added the persistent path in

341
00:14:42,079 --> 00:14:45,839
the c2 config structure

342
00:14:47,040 --> 00:14:48,880
finally we observe

343
00:14:48,880 --> 00:14:51,760
three new plugin module in case two

344
00:14:51,760 --> 00:14:53,920
first is the show

345
00:14:53,920 --> 00:14:55,519
command module second is the file

346
00:14:55,519 --> 00:14:58,160
manager module and the third is online

347
00:14:58,160 --> 00:14:59,920
module which is built for creating

348
00:14:59,920 --> 00:15:03,279
infected host information

349
00:15:04,399 --> 00:15:06,800
we also found layer files which is

350
00:15:06,800 --> 00:15:09,680
related to persistent mechanism after

351
00:15:09,680 --> 00:15:12,079
our analysis we summarize the process

352
00:15:12,079 --> 00:15:15,279
into five stage in the first stage

353
00:15:15,279 --> 00:15:16,800
we observe

354
00:15:16,800 --> 00:15:19,360
that pancreatic ray is

355
00:15:19,360 --> 00:15:21,839
using

356
00:15:23,040 --> 00:15:24,560
in the first stage we absolutely have

357
00:15:24,560 --> 00:15:26,480
primarily use the known persistent

358
00:15:26,480 --> 00:15:28,800
method by each layer in real incident

359
00:15:28,800 --> 00:15:30,959
case then use the same charcoal

360
00:15:30,959 --> 00:15:33,759
injection technique to bypass er

361
00:15:33,759 --> 00:15:36,800
detection next we use the tinyas

362
00:15:36,800 --> 00:15:38,800
operation to replace the deprecated

363
00:15:38,800 --> 00:15:41,600
windows api to equip the payload

364
00:15:41,600 --> 00:15:43,839
and once the liquid ddr is low in the

365
00:15:43,839 --> 00:15:45,600
memory

366
00:15:45,600 --> 00:15:47,920
you will explore the vulnerable kernel

367
00:15:47,920 --> 00:15:50,560
driver which is rt core

368
00:15:50,560 --> 00:15:53,040
for local privilege acceleration so the

369
00:15:53,040 --> 00:15:56,680
cv 2019-16098

370
00:15:57,199 --> 00:15:59,360
and finally you will create

371
00:15:59,360 --> 00:16:02,959
projects with system privilege

372
00:16:04,399 --> 00:16:06,639
and the case suite is mainly focused on

373
00:16:06,639 --> 00:16:09,199
the new custom loader pectorpia which

374
00:16:09,199 --> 00:16:11,759
might relate to pancreatic ray

375
00:16:11,759 --> 00:16:13,360
we have seen categorical samples

376
00:16:13,360 --> 00:16:15,600
circulating in a while since

377
00:16:15,600 --> 00:16:17,360
this year february

378
00:16:17,360 --> 00:16:19,360
ketuggia was named after the previous

379
00:16:19,360 --> 00:16:21,279
stream of final stage

380
00:16:21,279 --> 00:16:24,000
gear the actor used multiple evasion

381
00:16:24,000 --> 00:16:26,560
techniques in catholic we've noticed

382
00:16:26,560 --> 00:16:29,440
that catholia will check specific method

383
00:16:29,440 --> 00:16:31,920
of antivirus process before excluding

384
00:16:31,920 --> 00:16:33,600
the ministry's code

385
00:16:33,600 --> 00:16:35,920
we will introduce some latest evasion

386
00:16:35,920 --> 00:16:38,000
techniques and decryption method in the

387
00:16:38,000 --> 00:16:40,880
following slides

388
00:16:41,680 --> 00:16:44,079
so this workflow describes how keg2gear

389
00:16:44,079 --> 00:16:46,160
decrypt the payload and this method is

390
00:16:46,160 --> 00:16:47,519
the same

391
00:16:47,519 --> 00:16:51,040
one as the precision part in test two

392
00:16:51,040 --> 00:16:53,839
we divide measure into six step just for

393
00:16:53,839 --> 00:16:56,000
your reference if you are interested

394
00:16:56,000 --> 00:16:57,120
if

395
00:16:57,120 --> 00:16:59,199
and if the previous year is not the

396
00:16:59,199 --> 00:17:01,120
final stage you were back to the step

397
00:17:01,120 --> 00:17:04,400
one and repeatedly longer performing

398
00:17:04,400 --> 00:17:07,679
mentioned steps again

399
00:17:08,400 --> 00:17:10,240
and these slides mainly focus on the

400
00:17:10,240 --> 00:17:12,400
lattice and spatial techniques used by

401
00:17:12,400 --> 00:17:13,839
catholic

402
00:17:13,839 --> 00:17:16,079
they use two latest techniques one is

403
00:17:16,079 --> 00:17:18,400
able to kill each idea projects we found

404
00:17:18,400 --> 00:17:20,079
that actor has well development

405
00:17:20,079 --> 00:17:22,720
capability and is unchained because this

406
00:17:22,720 --> 00:17:25,760
technique is just disclosed by elects

407
00:17:25,760 --> 00:17:28,640
appreciably and they use this in their

408
00:17:28,640 --> 00:17:32,200
manner in time

409
00:17:33,120 --> 00:17:35,520
this technique is able to clear windows

410
00:17:35,520 --> 00:17:37,679
defender process once it's successfully

411
00:17:37,679 --> 00:17:40,720
modified the token ppl protected process

412
00:17:40,720 --> 00:17:43,440
light process to untrust it

413
00:17:43,440 --> 00:17:45,200
and you may refer to the link for

414
00:17:45,200 --> 00:17:48,960
further technical detailed information

415
00:17:48,960 --> 00:17:50,880
and the other one is anti-iodine

416
00:17:50,880 --> 00:17:53,360
decompiler technique we found that actor

417
00:17:53,360 --> 00:17:55,919
inserts some junk code into ketuja which

418
00:17:55,919 --> 00:17:58,160
will cause decombination failure because

419
00:17:58,160 --> 00:18:01,960
the state frame is not available

420
00:18:14,320 --> 00:18:16,080
now i'm going to introduce the code

421
00:18:16,080 --> 00:18:19,360
similarity among penguinal ray ffla and

422
00:18:19,360 --> 00:18:22,559
winq 2.0 the final research is based on

423
00:18:22,559 --> 00:18:26,760
these three simple analysis

424
00:18:28,080 --> 00:18:31,039
we divide the analysis into two parts

425
00:18:31,039 --> 00:18:33,440
firstly we suspect that the actor have

426
00:18:33,440 --> 00:18:36,960
ffl resource code because we found that

427
00:18:36,960 --> 00:18:39,039
the code we used between pancreatic and

428
00:18:39,039 --> 00:18:42,000
ffla one is the similar code led only

429
00:18:42,000 --> 00:18:43,760
change xor key

430
00:18:43,760 --> 00:18:45,919
and the other one is programming away to

431
00:18:45,919 --> 00:18:48,880
use the ffl race proxy connector class

432
00:18:48,880 --> 00:18:51,440
code it is interestingly actor even

433
00:18:51,440 --> 00:18:54,320
didn't remove the debug string

434
00:18:54,320 --> 00:18:57,679
as for second part we notice that ffl is

435
00:18:57,679 --> 00:18:59,039
and we

436
00:18:59,039 --> 00:19:01,280
not only use the same debug stream but

437
00:19:01,280 --> 00:19:04,000
the workflow is also similar given that

438
00:19:04,000 --> 00:19:06,080
the number of the samples are not that

439
00:19:06,080 --> 00:19:09,520
much we suspect that fflo and windy 2.0

440
00:19:09,520 --> 00:19:12,720
mic developer by sam group oral resource

441
00:19:12,720 --> 00:19:14,799
all the source code has been only shared

442
00:19:14,799 --> 00:19:18,240
to specific group

443
00:19:18,880 --> 00:19:20,960
and here is the screenshot of the code

444
00:19:20,960 --> 00:19:23,200
then between the cold overlap between

445
00:19:23,200 --> 00:19:26,400
and red and windy 2.0

446
00:19:26,400 --> 00:19:28,160
as you can see the code structure is

447
00:19:28,160 --> 00:19:31,120
very similar they just use the different

448
00:19:31,120 --> 00:19:34,320
hard-coded key value

449
00:19:36,160 --> 00:19:37,360
next

450
00:19:37,360 --> 00:19:39,440
the second part is about that drop

451
00:19:39,440 --> 00:19:41,919
resolver technique they use this feature

452
00:19:41,919 --> 00:19:44,080
is designed to dynamically resolve the

453
00:19:44,080 --> 00:19:46,480
second c2 server configuration which can

454
00:19:46,480 --> 00:19:48,799
protect the c2 infrastructure from

455
00:19:48,799 --> 00:19:50,480
discovering

456
00:19:50,480 --> 00:19:53,600
through mail analysis

457
00:19:53,600 --> 00:19:54,960
we found that

458
00:19:54,960 --> 00:19:57,360
similar similarity of data drop resolver

459
00:19:57,360 --> 00:20:00,400
function amongst pancreatic effector and

460
00:20:00,400 --> 00:20:03,840
winter 2.0 we divide the drop resolver

461
00:20:03,840 --> 00:20:06,480
mentioned into four steps in server one

462
00:20:06,480 --> 00:20:08,720
you will try to connect the

463
00:20:08,720 --> 00:20:11,200
first stage server together encrypted

464
00:20:11,200 --> 00:20:12,400
stream

465
00:20:12,400 --> 00:20:14,960
next in the thread tool you will pass

466
00:20:14,960 --> 00:20:18,480
encrypted string with hacker dd inventor

467
00:20:18,480 --> 00:20:20,880
then convert data to bytes and decoder

468
00:20:20,880 --> 00:20:23,280
string

469
00:20:23,440 --> 00:20:25,840
and finally you will resolve the second

470
00:20:25,840 --> 00:20:28,480
stage ic to ip address if the c2 string

471
00:20:28,480 --> 00:20:31,120
is domain name

472
00:20:31,200 --> 00:20:32,880
and it is worth noting that the length

473
00:20:32,880 --> 00:20:35,039
of hakodi's delimiters is the same

474
00:20:35,039 --> 00:20:36,799
amongst these three

475
00:20:36,799 --> 00:20:38,080
family

476
00:20:38,080 --> 00:20:40,480
this workflow is quite similar between

477
00:20:40,480 --> 00:20:43,039
pancreatic ray parkin and ffra as you

478
00:20:43,039 --> 00:20:46,159
can see they just change the xr key

479
00:20:46,159 --> 00:20:49,679
as for winter 2.0 you use rc4 to the

480
00:20:49,679 --> 00:20:52,240
string instead of using simple xo

481
00:20:52,240 --> 00:20:54,799
operation

482
00:20:56,240 --> 00:20:58,720
so yeah in highlight the other highlight

483
00:20:58,720 --> 00:21:01,440
part in this session is the tp overlap

484
00:21:01,440 --> 00:21:03,520
with army by male 1 family

485
00:21:03,520 --> 00:21:06,159
we mainly focus on the vice gp used by

486
00:21:06,159 --> 00:21:08,080
penguin lane which is overlapped with

487
00:21:08,080 --> 00:21:11,840
amibar maleficent that we observe

488
00:21:11,840 --> 00:21:14,559
the following two slides are dgs

489
00:21:14,559 --> 00:21:17,840
reference which can help you to replace

490
00:21:17,840 --> 00:21:19,760
with malware connection map

491
00:21:19,760 --> 00:21:21,520
first is the phantom gear halloween

492
00:21:21,520 --> 00:21:24,000
technique we have not yet observed many

493
00:21:24,000 --> 00:21:27,760
apk using this technique

494
00:21:27,760 --> 00:21:30,400
we finally chella the ak cc vector is

495
00:21:30,400 --> 00:21:32,320
the custom loader which has many

496
00:21:32,320 --> 00:21:34,880
functionality including equitable bypass

497
00:21:34,880 --> 00:21:37,760
and phantom gear halloween technique

498
00:21:37,760 --> 00:21:39,840
we notice the network is one of the

499
00:21:39,840 --> 00:21:42,240
vector loaded by the traiload if you are

500
00:21:42,240 --> 00:21:45,039
interested in fentanyl halloween

501
00:21:45,039 --> 00:21:47,360
technique you may refer to one of my

502
00:21:47,360 --> 00:21:50,240
colleagues arrogance presentation on vb

503
00:21:50,240 --> 00:21:53,200
2021

504
00:21:53,440 --> 00:21:55,200
and in the second part is the entire

505
00:21:55,200 --> 00:21:58,080
product compiler we added we identified

506
00:21:58,080 --> 00:22:00,159
the network is also a cross-platform

507
00:22:00,159 --> 00:22:02,320
vector we discovered that the linear

508
00:22:02,320 --> 00:22:05,679
value of network have called of an idea

509
00:22:05,679 --> 00:22:07,919
property compiler which is similar to

510
00:22:07,919 --> 00:22:09,120
capture

511
00:22:09,120 --> 00:22:11,840
in addition we also confirm that spectre

512
00:22:11,840 --> 00:22:14,640
banner is the predecessor of network

513
00:22:14,640 --> 00:22:17,679
because they have code reuse as well but

514
00:22:17,679 --> 00:22:19,679
we don't have evidence last vector is

515
00:22:19,679 --> 00:22:23,200
developed by amiba currently

516
00:22:23,200 --> 00:22:25,679
and the third is data resolver technique

517
00:22:25,679 --> 00:22:27,919
which is just mentioned in the previous

518
00:22:27,919 --> 00:22:30,320
slides we have seen this feature in most

519
00:22:30,320 --> 00:22:34,080
of the vector used by amiban for example

520
00:22:34,080 --> 00:22:36,799
network aka sidewalk or scramble cross

521
00:22:36,799 --> 00:22:39,679
is a circle based vector we have seen

522
00:22:39,679 --> 00:22:43,760
amibar used this vector since march 2021

523
00:22:43,760 --> 00:22:46,480
this was note in the e6 repo indicated

524
00:22:46,480 --> 00:22:49,039
network used google doc as they drop

525
00:22:49,039 --> 00:22:50,559
resolver

526
00:22:50,559 --> 00:22:52,640
in addition we have observed other

527
00:22:52,640 --> 00:22:54,960
malware family abusing the japanese web

528
00:22:54,960 --> 00:22:57,840
service in the past such as should open

529
00:22:57,840 --> 00:22:59,840
progress an event

530
00:22:59,840 --> 00:23:02,000
and a variant of quickly use microsoft

531
00:23:02,000 --> 00:23:04,159
developer network following as a data

532
00:23:04,159 --> 00:23:06,240
drop resolver

533
00:23:06,240 --> 00:23:08,159
and it was noted in the mainland's

534
00:23:08,159 --> 00:23:10,480
recent risk reports shows that the

535
00:23:10,480 --> 00:23:12,799
windows version of prepared leveraged

536
00:23:12,799 --> 00:23:15,679
data resolver and two separate tech

537
00:23:15,679 --> 00:23:19,440
community forums as well

538
00:23:19,919 --> 00:23:21,120
and next

539
00:23:21,120 --> 00:23:23,280
we have observed kcp protocol is only

540
00:23:23,280 --> 00:23:26,000
used in army bus memory family in the

541
00:23:26,000 --> 00:23:27,440
past few years

542
00:23:27,440 --> 00:23:30,400
such as trade park crosswalk and funding

543
00:23:30,400 --> 00:23:32,159
switch

544
00:23:32,159 --> 00:23:33,919
unclear capacity mentioned the new

545
00:23:33,919 --> 00:23:36,080
malware family in their recent research

546
00:23:36,080 --> 00:23:38,000
report they point out shooter

547
00:23:38,000 --> 00:23:40,080
manuscripts have also used cancer

548
00:23:40,080 --> 00:23:42,640
protocol however we still didn't know

549
00:23:42,640 --> 00:23:46,559
the adversary behind his campaign

550
00:23:46,720 --> 00:23:49,760
and in order to detach avoid detection

551
00:23:49,760 --> 00:23:52,559
and analysis we observe that many army

552
00:23:52,559 --> 00:23:54,880
bus manual family developed multiple c2

553
00:23:54,880 --> 00:23:57,520
protocol and modular base design

554
00:23:57,520 --> 00:24:00,000
such as function switch

555
00:24:00,000 --> 00:24:01,840
crosswalk

556
00:24:01,840 --> 00:24:04,400
and tea park and solar panel

557
00:24:04,400 --> 00:24:06,799
from our observation we have seen some

558
00:24:06,799 --> 00:24:09,600
variant of winter you use the

559
00:24:09,600 --> 00:24:11,760
progress encoding organism to decrypt

560
00:24:11,760 --> 00:24:13,760
the malware configuration

561
00:24:13,760 --> 00:24:16,559
finally according to 1701 solar panel

562
00:24:16,559 --> 00:24:19,120
research they mentioned that shadow pair

563
00:24:19,120 --> 00:24:21,520
is highly likely to be the successor to

564
00:24:21,520 --> 00:24:25,840
packets based on the similar pdb string

565
00:24:27,520 --> 00:24:29,679
and here is the malware connection map

566
00:24:29,679 --> 00:24:32,559
the yellow malware icon means amiibo

567
00:24:32,559 --> 00:24:35,600
youtube has used this male family before

568
00:24:35,600 --> 00:24:38,480
the blue green manual icons means the

569
00:24:38,480 --> 00:24:40,960
adversary is still unknown

570
00:24:40,960 --> 00:24:43,200
in our research it is interesting that

571
00:24:43,200 --> 00:24:45,120
phallic switch has many similarities

572
00:24:45,120 --> 00:24:46,720
with

573
00:24:46,720 --> 00:24:48,159
crosswalk

574
00:24:48,159 --> 00:24:50,080
but we cannot confirm they are written

575
00:24:50,080 --> 00:24:52,000
by the same developer because there are

576
00:24:52,000 --> 00:24:54,720
no code overlap

577
00:24:54,720 --> 00:24:57,279
next we observe that keypad is related

578
00:24:57,279 --> 00:24:57,600
to

579
00:24:57,600 --> 00:24:59,600
[Music]

580
00:24:59,600 --> 00:25:00,799
the

581
00:25:00,799 --> 00:25:03,360
loki used by amibar based on our

582
00:25:03,360 --> 00:25:05,760
analysis we have median to high

583
00:25:05,760 --> 00:25:08,080
confidence that people reuse the low

584
00:25:08,080 --> 00:25:11,439
keys resource code

585
00:25:13,360 --> 00:25:15,200
and next here is the

586
00:25:15,200 --> 00:25:17,760
other gps overlap with amibar malware

587
00:25:17,760 --> 00:25:20,400
family we summarize the vector attacking

588
00:25:20,400 --> 00:25:23,679
the online gaming or gaming industry in

589
00:25:23,679 --> 00:25:26,080
some cases we found that king will also

590
00:25:26,080 --> 00:25:28,640
use copyright in their campaigns with

591
00:25:28,640 --> 00:25:31,360
these three overlapped tdp which amiba

592
00:25:31,360 --> 00:25:32,720
used before

593
00:25:32,720 --> 00:25:35,440
first one is they they were abusing

594
00:25:35,440 --> 00:25:38,480
carfair worker to highlight real c2ip

595
00:25:38,480 --> 00:25:41,520
address and they also modified xrt for

596
00:25:41,520 --> 00:25:43,039
c2

597
00:25:43,039 --> 00:25:44,480
configuration

598
00:25:44,480 --> 00:25:46,720
and they also used the

599
00:25:46,720 --> 00:25:49,279
earlier vertical injection tool in their

600
00:25:49,279 --> 00:25:52,159
malware family

601
00:25:53,679 --> 00:25:55,679
in this chart we found that is

602
00:25:55,679 --> 00:25:58,400
implemented the kcp protocol vector

603
00:25:58,400 --> 00:26:02,159
tools only appear after

604
00:26:02,559 --> 00:26:06,360
middle of 2019

605
00:26:06,720 --> 00:26:08,799
and from our terminology we would like

606
00:26:08,799 --> 00:26:11,440
to emphasize that this spectrum has

607
00:26:11,440 --> 00:26:13,039
started attack

608
00:26:13,039 --> 00:26:16,159
the gambling industry from the end of

609
00:26:16,159 --> 00:26:18,159
2020

610
00:26:18,159 --> 00:26:20,400
next i will hang it back to serbia she

611
00:26:20,400 --> 00:26:24,559
will give you an asset of epic

612
00:26:29,520 --> 00:26:30,320
um

613
00:26:30,320 --> 00:26:33,039
so what liangpi presents just now has

614
00:26:33,039 --> 00:26:35,679
shown you that we might have entered

615
00:26:35,679 --> 00:26:37,360
the new era of

616
00:26:37,360 --> 00:26:40,320
chinese apt analysis so the first trend

617
00:26:40,320 --> 00:26:42,240
is that we are observing

618
00:26:42,240 --> 00:26:46,000
an increasing intricacy of our family

619
00:26:46,000 --> 00:26:46,960
that is

620
00:26:46,960 --> 00:26:49,600
the share similar techniques and

621
00:26:49,600 --> 00:26:52,159
structure are observed across different

622
00:26:52,159 --> 00:26:55,279
malware families and then second is the

623
00:26:55,279 --> 00:26:57,840
increasing tendency of malware sharing

624
00:26:57,840 --> 00:26:59,520
between different groups

625
00:26:59,520 --> 00:27:01,919
so we suspect that there might be some

626
00:27:01,919 --> 00:27:04,400
kind of malware as a service operation

627
00:27:04,400 --> 00:27:05,440
mode

628
00:27:05,440 --> 00:27:09,200
among those apt groups

629
00:27:09,760 --> 00:27:13,600
so with that in mind we tentatively

630
00:27:13,600 --> 00:27:16,240
group all the actors that is that is

631
00:27:16,240 --> 00:27:19,600
using pangolin ararat into this apt

632
00:27:19,600 --> 00:27:23,679
group called tianwu so as i um so tianwu

633
00:27:23,679 --> 00:27:27,120
it is not a typical apt group that has a

634
00:27:27,120 --> 00:27:29,760
clear group grouping or definition in

635
00:27:29,760 --> 00:27:32,399
the past we tend to we tend to assume

636
00:27:32,399 --> 00:27:35,600
that this kind of nation-state apt group

637
00:27:35,600 --> 00:27:38,880
are cyber army under the direct command

638
00:27:38,880 --> 00:27:42,080
of military or intelligence unit but

639
00:27:42,080 --> 00:27:43,360
however

640
00:27:43,360 --> 00:27:46,080
nowadays the cyber activities make earth

641
00:27:46,080 --> 00:27:48,720
surmise that they there might be another

642
00:27:48,720 --> 00:27:52,559
mode of cyber operation um it means that

643
00:27:52,559 --> 00:27:55,279
maybe more and more civilian hackers are

644
00:27:55,279 --> 00:28:00,080
participating in this threat landscape

645
00:28:00,320 --> 00:28:01,440
so we named

646
00:28:01,440 --> 00:28:04,480
this group of actor with this beast in

647
00:28:04,480 --> 00:28:07,120
the classic of mountain and sea so

648
00:28:07,120 --> 00:28:09,520
tianhu is basically a beast with eight

649
00:28:09,520 --> 00:28:12,159
human heads eight feet and eight tails

650
00:28:12,159 --> 00:28:14,399
so this resembles with the modular

651
00:28:14,399 --> 00:28:17,840
feature of penguin air red as well as

652
00:28:17,840 --> 00:28:20,320
resembles our speculation that this

653
00:28:20,320 --> 00:28:21,679
group might be

654
00:28:21,679 --> 00:28:24,480
an amalgamation of different group of

655
00:28:24,480 --> 00:28:26,960
actors

656
00:28:27,039 --> 00:28:29,120
so these two pie charts show the target

657
00:28:29,120 --> 00:28:32,159
industry and region of the tianu actor

658
00:28:32,159 --> 00:28:34,720
so as you can see although

659
00:28:34,720 --> 00:28:36,399
most of the attack

660
00:28:36,399 --> 00:28:39,760
are directed at the gambling firms but

661
00:28:39,760 --> 00:28:42,320
we have also seen their attack against

662
00:28:42,320 --> 00:28:44,720
other industries such as telecom

663
00:28:44,720 --> 00:28:47,679
government transport and dissident

664
00:28:47,679 --> 00:28:50,480
and as for target region

665
00:28:50,480 --> 00:28:52,720
from our database we see most of the

666
00:28:52,720 --> 00:28:55,039
attacks are in the apec region but we

667
00:28:55,039 --> 00:28:57,600
have also seen the footprint in

668
00:28:57,600 --> 00:28:59,840
kazakhstan

669
00:29:00,159 --> 00:29:03,039
so this activity timeline summarized the

670
00:29:03,039 --> 00:29:05,919
notable the notable campaign of cambo

671
00:29:05,919 --> 00:29:09,520
actors over the past year

672
00:29:10,000 --> 00:29:12,799
and this slide summarize um the ttp

673
00:29:12,799 --> 00:29:15,600
which we have seen in this campaign so

674
00:29:15,600 --> 00:29:18,240
first um in the delivery method we see

675
00:29:18,240 --> 00:29:20,399
that the actors have excellent social

676
00:29:20,399 --> 00:29:23,200
engineering skill and they are equipped

677
00:29:23,200 --> 00:29:25,039
some new

678
00:29:25,039 --> 00:29:27,840
type of phishing that is um using the

679
00:29:27,840 --> 00:29:31,279
forum to send malicious files and as for

680
00:29:31,279 --> 00:29:33,440
malware abuse um like i said before it

681
00:29:33,440 --> 00:29:35,279
is pangolini area and copper stripe

682
00:29:35,279 --> 00:29:39,039
beacon and as for c as for the c2 infra

683
00:29:39,039 --> 00:29:41,440
we have seen them using

684
00:29:41,440 --> 00:29:43,679
repeatedly used the typo squatting

685
00:29:43,679 --> 00:29:45,679
technique to disguise their c2s

686
00:29:45,679 --> 00:29:48,240
legitimate website and some of the c2

687
00:29:48,240 --> 00:29:51,520
are hosted on vps and we even see the

688
00:29:51,520 --> 00:29:53,919
recent c2 activity indicate possible

689
00:29:53,919 --> 00:29:56,559
abuse of log4j

690
00:29:56,559 --> 00:29:57,760
and

691
00:29:57,760 --> 00:30:00,399
the advanced researcher also once

692
00:30:00,399 --> 00:30:03,360
pointed out that the group might have

693
00:30:03,360 --> 00:30:07,120
abused the exploit of wps office

694
00:30:07,120 --> 00:30:09,200
which is a document software that is

695
00:30:09,200 --> 00:30:11,120
popular in china

696
00:30:11,120 --> 00:30:13,360
and another interesting thing is that

697
00:30:13,360 --> 00:30:16,399
from an open directory owned by tmu we

698
00:30:16,399 --> 00:30:19,440
see it the group has possibly

699
00:30:19,440 --> 00:30:23,840
exploited a chromium vulnerability

700
00:30:24,000 --> 00:30:26,880
so next is some notable case of kianwu's

701
00:30:26,880 --> 00:30:29,200
attack so this is um

702
00:30:29,200 --> 00:30:31,039
so this slide shows you tianwu's

703
00:30:31,039 --> 00:30:33,760
month-long campaign against a telecom

704
00:30:33,760 --> 00:30:36,640
operator in kazakhstan so the victim is

705
00:30:36,640 --> 00:30:38,880
actually a very famous russian

706
00:30:38,880 --> 00:30:41,200
telecom operator so it

707
00:30:41,200 --> 00:30:43,279
so we are not ruling out the possibility

708
00:30:43,279 --> 00:30:45,360
that the actors might be launching

709
00:30:45,360 --> 00:30:48,080
attack against its other branches in the

710
00:30:48,080 --> 00:30:49,360
eurasia

711
00:30:49,360 --> 00:30:50,799
region

712
00:30:50,799 --> 00:30:52,159
so

713
00:30:52,159 --> 00:30:54,320
in this case it is it is interesting

714
00:30:54,320 --> 00:30:57,120
that they disguise their c2 domain as

715
00:30:57,120 --> 00:31:00,559
the domains of the victim

716
00:31:01,440 --> 00:31:04,640
and another interesting campaign is

717
00:31:04,640 --> 00:31:06,799
their campaign against taiwanese

718
00:31:06,799 --> 00:31:09,679
gambling firm and this campaign we

719
00:31:09,679 --> 00:31:12,720
believe it has been ongoing for about a

720
00:31:12,720 --> 00:31:13,840
year

721
00:31:13,840 --> 00:31:14,960
so

722
00:31:14,960 --> 00:31:17,200
a notable finding is that we found the

723
00:31:17,200 --> 00:31:19,600
actors have deployed hacking tool in

724
00:31:19,600 --> 00:31:21,600
their attack and they are trying to

725
00:31:21,600 --> 00:31:24,559
collect the info of victims browser and

726
00:31:24,559 --> 00:31:26,480
messaging software

727
00:31:26,480 --> 00:31:27,200
so

728
00:31:27,200 --> 00:31:29,679
actually um the online gambling firm is

729
00:31:29,679 --> 00:31:33,200
not typical target of apt in the past

730
00:31:33,200 --> 00:31:35,600
but the deployment of hacking tool

731
00:31:35,600 --> 00:31:37,919
indicates that now this gambling firm

732
00:31:37,919 --> 00:31:41,760
might be the target of this apt for

733
00:31:41,760 --> 00:31:44,480
espionage operation so by the way if you

734
00:31:44,480 --> 00:31:46,559
are interested in apt attack against

735
00:31:46,559 --> 00:31:48,559
game online game blinking industry you

736
00:31:48,559 --> 00:31:54,080
can refer to our kali's session tomorrow

737
00:31:54,159 --> 00:31:56,720
so in the next uh next one is its attack

738
00:31:56,720 --> 00:31:59,519
against taiwanese transport industry

739
00:31:59,519 --> 00:32:00,880
so um

740
00:32:00,880 --> 00:32:03,200
what is notable about this attack is

741
00:32:03,200 --> 00:32:06,640
that the c2 was disguised at as the

742
00:32:06,640 --> 00:32:09,039
enterprise management software used by

743
00:32:09,039 --> 00:32:11,440
the victim so this indicates that the

744
00:32:11,440 --> 00:32:14,399
actors are precisely targeting the

745
00:32:14,399 --> 00:32:15,600
victim

746
00:32:15,600 --> 00:32:17,519
and another thing is that we have seen

747
00:32:17,519 --> 00:32:20,399
the same situ infra was used in attack

748
00:32:20,399 --> 00:32:21,679
against

749
00:32:21,679 --> 00:32:25,679
gambling firms in the philippines

750
00:32:26,640 --> 00:32:28,399
and this is a case

751
00:32:28,399 --> 00:32:30,880
where the actors are using social

752
00:32:30,880 --> 00:32:33,600
engineering skills to launch that attack

753
00:32:33,600 --> 00:32:36,159
so we have seen on the tmu actors they

754
00:32:36,159 --> 00:32:38,880
disguise themselves as staff from a

755
00:32:38,880 --> 00:32:41,279
taiwanese i.t company and they have

756
00:32:41,279 --> 00:32:44,559
posts on the forum and at to ask how to

757
00:32:44,559 --> 00:32:47,760
put advertisement on abolowang.com

758
00:32:47,760 --> 00:32:50,559
so as some of you might know this

759
00:32:50,559 --> 00:32:54,240
calm is a famous anti-ccp news website

760
00:32:54,240 --> 00:32:57,360
so we suspect that the actor is luring

761
00:32:57,360 --> 00:32:59,919
the staff from this website and trying

762
00:32:59,919 --> 00:33:00,720
to

763
00:33:00,720 --> 00:33:03,120
send a malicious file

764
00:33:03,120 --> 00:33:05,279
by asking how to put advertisement on

765
00:33:05,279 --> 00:33:07,919
their website

766
00:33:07,919 --> 00:33:11,120
so um from the c2 infra used in this

767
00:33:11,120 --> 00:33:14,080
campaign we discover an open directory

768
00:33:14,080 --> 00:33:17,200
on the c2 and here's the list of file

769
00:33:17,200 --> 00:33:20,159
that is found on the open directory and

770
00:33:20,159 --> 00:33:22,880
some of the multiple files possibly

771
00:33:22,880 --> 00:33:25,919
indicate the use of an unknown chromium

772
00:33:25,919 --> 00:33:28,240
exploit targeting the chromium-based

773
00:33:28,240 --> 00:33:30,080
browser user

774
00:33:30,080 --> 00:33:31,120
so

775
00:33:31,120 --> 00:33:33,039
we suspect maybe

776
00:33:33,039 --> 00:33:36,080
the user of qq browser might be

777
00:33:36,080 --> 00:33:37,919
one of their targets because it is

778
00:33:37,919 --> 00:33:40,640
chromium-based and then we also found a

779
00:33:40,640 --> 00:33:43,519
malicious wechat chrome extension

780
00:33:43,519 --> 00:33:45,679
and this crop this malicious chrome

781
00:33:45,679 --> 00:33:46,799
extension

782
00:33:46,799 --> 00:33:48,880
have upon execution it will lead to the

783
00:33:48,880 --> 00:33:51,440
installment of pangolin area and copper

784
00:33:51,440 --> 00:33:54,080
stripe beacon

785
00:33:54,240 --> 00:33:56,799
so this slide we summarize um all the

786
00:33:56,799 --> 00:34:00,080
ttps we observe in the in those campaign

787
00:34:00,080 --> 00:34:02,720
and their overlaps with the amoeba group

788
00:34:02,720 --> 00:34:04,960
so as for delivery method both groups

789
00:34:04,960 --> 00:34:07,840
have used the forum phishing and as for

790
00:34:07,840 --> 00:34:09,918
the malware abuse this has been detailed

791
00:34:09,918 --> 00:34:11,520
by leon just now

792
00:34:11,520 --> 00:34:13,839
and both groups have abused cloud fair

793
00:34:13,839 --> 00:34:17,440
workers to hide their real c2ib address

794
00:34:17,440 --> 00:34:19,359
and as for target scope growth group

795
00:34:19,359 --> 00:34:21,679
have displayed their interest in online

796
00:34:21,679 --> 00:34:25,119
gaming and gambling industry

797
00:34:25,119 --> 00:34:28,320
so attribution we think that um tian wu

798
00:34:28,320 --> 00:34:31,119
it is possibly um operate

799
00:34:31,119 --> 00:34:34,399
like amoeba so as we know as we all know

800
00:34:34,399 --> 00:34:38,079
the amoeba group the apt-41 was indicted

801
00:34:38,079 --> 00:34:40,639
by the u.s department of justice and it

802
00:34:40,639 --> 00:34:42,480
was disclosed that

803
00:34:42,480 --> 00:34:44,879
some of the actors are actually staffed

804
00:34:44,879 --> 00:34:47,760
from a front company in china so we

805
00:34:47,760 --> 00:34:49,679
suspect that our preparation mode might

806
00:34:49,679 --> 00:34:52,399
be like that and they are maybe

807
00:34:52,399 --> 00:34:54,320
operating big projects from the

808
00:34:54,320 --> 00:34:57,839
authorities and conducting espionage or

809
00:34:57,839 --> 00:35:00,720
domestic surveillance for the authority

810
00:35:00,720 --> 00:35:02,560
but please note that so far we don't

811
00:35:02,560 --> 00:35:06,160
have evidence to support this theory

812
00:35:06,160 --> 00:35:08,880
and another possible scenario is that

813
00:35:08,880 --> 00:35:11,040
there may be a subgroup of amoeba

814
00:35:11,040 --> 00:35:13,119
because of the similarity between the

815
00:35:13,119 --> 00:35:16,160
two groups but also so far we have not

816
00:35:16,160 --> 00:35:20,720
seen share info infra and tools so um

817
00:35:20,720 --> 00:35:25,839
this we hold a low to low confidence

818
00:35:26,160 --> 00:35:28,640
so another interesting finding is that

819
00:35:28,640 --> 00:35:31,440
um from another open directory owned by

820
00:35:31,440 --> 00:35:33,760
the group we see the actors have

821
00:35:33,760 --> 00:35:37,760
actually con collected information of

822
00:35:37,760 --> 00:35:41,280
the victim including account credential

823
00:35:41,280 --> 00:35:44,160
software source code and business info

824
00:35:44,160 --> 00:35:45,520
so this

825
00:35:45,520 --> 00:35:47,359
finding led us to

826
00:35:47,359 --> 00:35:48,720
believe that

827
00:35:48,720 --> 00:35:51,599
the possible involvement of the actors

828
00:35:51,599 --> 00:35:54,560
in cyber crime

829
00:35:54,960 --> 00:35:57,680
so to sum up all the findings in our

830
00:35:57,680 --> 00:35:58,400
research

831
00:35:58,400 --> 00:36:00,560
um we think there is a new trend in the

832
00:36:00,560 --> 00:36:03,599
flat landscape so first it is that the

833
00:36:03,599 --> 00:36:06,079
difficulty of pinning out actors motive

834
00:36:06,079 --> 00:36:08,800
because as you can see um channel extra

835
00:36:08,800 --> 00:36:11,760
they don't actually have a consistent

836
00:36:11,760 --> 00:36:15,119
target or a clear motive so maybe the

837
00:36:15,119 --> 00:36:18,320
operation is outsourced by the authority

838
00:36:18,320 --> 00:36:20,880
and then second is that the operation

839
00:36:20,880 --> 00:36:22,320
will follow

840
00:36:22,320 --> 00:36:24,560
some of the operation is following the

841
00:36:24,560 --> 00:36:27,280
chinese authority crackdown campaign on

842
00:36:27,280 --> 00:36:29,760
those industry and it is possible they

843
00:36:29,760 --> 00:36:31,520
are collecting information for the

844
00:36:31,520 --> 00:36:33,359
crackdown campaign

845
00:36:33,359 --> 00:36:36,320
and last it is also possible that those

846
00:36:36,320 --> 00:36:39,359
actors are civilian hacker and

847
00:36:39,359 --> 00:36:41,920
the collection of source code might be

848
00:36:41,920 --> 00:36:45,200
them aiming for personal financial gain

849
00:36:45,200 --> 00:36:47,599
by selling the source code in the

850
00:36:47,599 --> 00:36:50,560
underground market

851
00:36:50,880 --> 00:36:53,440
so this diamond model slides summarize

852
00:36:53,440 --> 00:36:55,520
on the technical axis and social

853
00:36:55,520 --> 00:37:00,800
political exits of tianwu's operation

854
00:37:01,200 --> 00:37:05,839
so here's come to our conclusion today

855
00:37:05,839 --> 00:37:07,280
so first

856
00:37:07,280 --> 00:37:09,839
penguin era could be the next generation

857
00:37:09,839 --> 00:37:13,119
clock x and shadow pet because as we can

858
00:37:13,119 --> 00:37:15,760
see this modular feature red are

859
00:37:15,760 --> 00:37:18,160
becoming more and more popular amongst

860
00:37:18,160 --> 00:37:21,280
those nation state actors because this

861
00:37:21,280 --> 00:37:24,240
kind of mode will reduce the cost of

862
00:37:24,240 --> 00:37:27,119
developing malware and it also increase

863
00:37:27,119 --> 00:37:30,640
the difficulty for researcher to track

864
00:37:30,640 --> 00:37:32,320
down um

865
00:37:32,320 --> 00:37:35,599
to track down the identity of the actors

866
00:37:35,599 --> 00:37:39,040
and also the grouping has become more um

867
00:37:39,040 --> 00:37:40,079
difficult

868
00:37:40,079 --> 00:37:42,880
so maybe um for example shadowpad is

869
00:37:42,880 --> 00:37:44,480
shared among limited

870
00:37:44,480 --> 00:37:46,960
set of users so maybe this malware are

871
00:37:46,960 --> 00:37:49,200
only sold to those

872
00:37:49,200 --> 00:37:50,560
nations

873
00:37:50,560 --> 00:37:53,520
state actor and those tools might be

874
00:37:53,520 --> 00:37:56,320
used in both espionage and financially

875
00:37:56,320 --> 00:37:59,440
driven operation

876
00:37:59,599 --> 00:38:01,359
and another one is

877
00:38:01,359 --> 00:38:03,520
what i've mentioned before is the new

878
00:38:03,520 --> 00:38:06,720
mode of apt operation so because of the

879
00:38:06,720 --> 00:38:08,720
trends of mars sharing and then the

880
00:38:08,720 --> 00:38:11,440
intricacy between our families so we

881
00:38:11,440 --> 00:38:14,400
believe we will see more and more kind

882
00:38:14,400 --> 00:38:18,320
uh similar mode in the future so so far

883
00:38:18,320 --> 00:38:20,960
um we think tian wu might operate as

884
00:38:20,960 --> 00:38:24,240
maybe it is a collaborator of apt-41

885
00:38:24,240 --> 00:38:27,520
amiba or it is a group subgroup of the

886
00:38:27,520 --> 00:38:30,560
group or it is also possible they they

887
00:38:30,560 --> 00:38:33,200
they are the digital quartermaster of

888
00:38:33,200 --> 00:38:36,480
some chinese apts

889
00:38:37,119 --> 00:38:40,079
and what can we do about it so here is

890
00:38:40,079 --> 00:38:43,440
some counter measure we can do to

891
00:38:43,440 --> 00:38:45,680
defend your organization with this kind

892
00:38:45,680 --> 00:38:46,800
of attack

893
00:38:46,800 --> 00:38:47,520
so

894
00:38:47,520 --> 00:38:49,200
first we believe

895
00:38:49,200 --> 00:38:51,760
it is important to apply all level

896
00:38:51,760 --> 00:38:53,040
intelligence

897
00:38:53,040 --> 00:38:55,920
so on the tactical level we advise that

898
00:38:55,920 --> 00:38:58,079
you can always feed

899
00:38:58,079 --> 00:39:01,280
the iocs provided by cti vendors to

900
00:39:01,280 --> 00:39:03,280
cyber security infra

901
00:39:03,280 --> 00:39:05,599
and on the operational level

902
00:39:05,599 --> 00:39:08,240
you can you should always patch a server

903
00:39:08,240 --> 00:39:10,960
in timely manner and be aware of the new

904
00:39:10,960 --> 00:39:13,359
social engineering tactics

905
00:39:13,359 --> 00:39:15,920
and another thing is that fireless

906
00:39:15,920 --> 00:39:18,160
malware and in-memory based attack are

907
00:39:18,160 --> 00:39:20,640
becoming more and more popular so you

908
00:39:20,640 --> 00:39:23,839
can apply in memory detection to avoid

909
00:39:23,839 --> 00:39:25,280
those attack

910
00:39:25,280 --> 00:39:28,800
and finally on a strategic level first

911
00:39:28,800 --> 00:39:31,599
we must recognize that there's a new

912
00:39:31,599 --> 00:39:33,200
mode of

913
00:39:33,200 --> 00:39:35,520
the operation between those chinese app

914
00:39:35,520 --> 00:39:38,160
that makes the attribution and group

915
00:39:38,160 --> 00:39:40,320
tracking more difficult

916
00:39:40,320 --> 00:39:42,720
and another thing we can pay attention

917
00:39:42,720 --> 00:39:46,079
to is the policy and crackdown campaign

918
00:39:46,079 --> 00:39:47,760
in china because

919
00:39:47,760 --> 00:39:49,920
those policies will heavily affect the

920
00:39:49,920 --> 00:39:53,599
cyberspace in the apac region

921
00:39:53,599 --> 00:39:56,560
we have also summarized the ioc and the

922
00:39:56,560 --> 00:39:57,760
reference

923
00:39:57,760 --> 00:40:00,800
we have used in our research

924
00:40:00,800 --> 00:40:03,200
we found in our research

925
00:40:03,200 --> 00:40:05,599
so thanks for listening today

926
00:40:05,599 --> 00:40:08,839
thank you

927
00:40:17,760 --> 00:40:21,280
we will now proceed to q a

928
00:40:23,040 --> 00:40:25,440
for those of you that are here

929
00:40:25,440 --> 00:40:27,359
if you have any questions please head up

930
00:40:27,359 --> 00:40:28,880
to the

931
00:40:28,880 --> 00:40:33,240
podium microphone to ask your question

932
00:40:40,800 --> 00:40:43,040
one two three okay uh italy from

933
00:40:43,040 --> 00:40:44,640
kaspersky thank you for the presentation

934
00:40:44,640 --> 00:40:46,000
guys um

935
00:40:46,000 --> 00:40:47,599
i'm just wondering um a little bit

936
00:40:47,599 --> 00:40:48,880
technical question like what do you

937
00:40:48,880 --> 00:40:50,720
think was the motivation when they moved

938
00:40:50,720 --> 00:40:52,400
to the kcp protocol what was the

939
00:40:52,400 --> 00:40:53,839
advantage for them

940
00:40:53,839 --> 00:40:56,880
why did it take place

941
00:41:04,839 --> 00:41:06,079
okay young

942
00:41:06,079 --> 00:41:09,200
because i used to spell that the

943
00:41:09,200 --> 00:41:12,400
director will try to use now an unusual

944
00:41:12,400 --> 00:41:16,160
protocol for avoidation because

945
00:41:16,160 --> 00:41:20,560
it can provide you can put and

946
00:41:20,560 --> 00:41:21,839
you can

947
00:41:21,839 --> 00:41:24,400
decrease the change there will be code

948
00:41:24,400 --> 00:41:28,160
in the firewall or some

949
00:41:28,640 --> 00:41:30,480
some

950
00:41:30,480 --> 00:41:32,880
security

951
00:41:32,880 --> 00:41:35,839
policy yes

952
00:41:37,030 --> 00:41:40,099
[Music]

953
00:41:43,940 --> 00:41:47,030
[Music]

