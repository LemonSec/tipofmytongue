1
00:00:00,640 --> 00:00:02,800
hi my name is laura bernoull and i'm

2
00:00:02,800 --> 00:00:04,480
going to present a joint work with

3
00:00:04,480 --> 00:00:06,640
gaetan lauren on andrei schrotten lower

4
00:00:06,640 --> 00:00:08,880
entitled clustering effect in simon and

5
00:00:08,880 --> 00:00:09,840
simon

6
00:00:09,840 --> 00:00:11,360
so let's start by a little bit of

7
00:00:11,360 --> 00:00:13,360
context simon and speck are two

8
00:00:13,360 --> 00:00:15,280
lightweight block ciphers introduced

9
00:00:15,280 --> 00:00:18,480
introduced by the nsa in 2013. simon is

10
00:00:18,480 --> 00:00:20,320
optimizing hardware while spec is

11
00:00:20,320 --> 00:00:22,240
optimized in software

12
00:00:22,240 --> 00:00:24,400
the nsa tried to get simon and spec

13
00:00:24,400 --> 00:00:26,640
standardized at iso but some experts

14
00:00:26,640 --> 00:00:28,800
from other countries were suspicious

15
00:00:28,800 --> 00:00:30,640
there were suspicious because simon and

16
00:00:30,640 --> 00:00:32,719
spec were introduced without any

17
00:00:32,719 --> 00:00:35,040
rational and because of the nsa's

18
00:00:35,040 --> 00:00:36,719
previous involvement in the creation and

19
00:00:36,719 --> 00:00:38,480
promotion of bacter cryptographic

20
00:00:38,480 --> 00:00:41,200
algorithm as a dual ec

21
00:00:41,200 --> 00:00:43,680
and they were also suspicious because

22
00:00:43,680 --> 00:00:44,960
there were no clear need for

23
00:00:44,960 --> 00:00:47,360
standardization of new cipher so for

24
00:00:47,360 --> 00:00:49,520
those reasons many papers study simon

25
00:00:49,520 --> 00:00:50,480
and spec

26
00:00:50,480 --> 00:00:52,559
a little bit later an academic variant

27
00:00:52,559 --> 00:00:54,879
of simon and spec was introduced this

28
00:00:54,879 --> 00:00:57,440
variant is cymec so in the following

29
00:00:57,440 --> 00:00:59,840
we'll focus on simon and simek

30
00:00:59,840 --> 00:01:02,160
so here is a brief overview of our

31
00:01:02,160 --> 00:01:04,400
results and for example for psymek with

32
00:01:04,400 --> 00:01:07,040
a block size of 64 bit on the key size

33
00:01:07,040 --> 00:01:11,040
of 128 bits we obtain an attack over 42

34
00:01:11,040 --> 00:01:13,600
rounds out of 44 while previously the

35
00:01:13,600 --> 00:01:16,960
best attack only reached for 37 rounds

36
00:01:16,960 --> 00:01:19,680
so first i will describe simon and cymek

37
00:01:19,680 --> 00:01:20,960
and differential and linear equipped

38
00:01:20,960 --> 00:01:23,439
analysis then i will

39
00:01:23,439 --> 00:01:25,360
present our stronger distinguisher for

40
00:01:25,360 --> 00:01:27,600
differential and linear quota analysis

41
00:01:27,600 --> 00:01:29,200
and then i will present our improved

42
00:01:29,200 --> 00:01:30,960
care recovery attacks against cymac and

43
00:01:30,960 --> 00:01:31,920
simon

44
00:01:31,920 --> 00:01:34,000
so let's start by describing simon and

45
00:01:34,000 --> 00:01:36,400
simon simon and cymek are both festel

46
00:01:36,400 --> 00:01:39,360
cipher so a festive cipher works as

47
00:01:39,360 --> 00:01:42,000
follow first we start with the plaintext

48
00:01:42,000 --> 00:01:44,479
of n bits and we split into two blocks

49
00:01:44,479 --> 00:01:46,240
of n over two bits

50
00:01:46,240 --> 00:01:48,880
a left block on the right block and the

51
00:01:48,880 --> 00:01:50,960
left block goes into a run function

52
00:01:50,960 --> 00:01:52,799
which depends on the

53
00:01:52,799 --> 00:01:54,479
round key k0

54
00:01:54,479 --> 00:01:56,799
and the output of this round function is

55
00:01:56,799 --> 00:01:59,119
glow to the right part on the right part

56
00:01:59,119 --> 00:02:01,040
becomes the left part on the left part

57
00:02:01,040 --> 00:02:03,200
becomes the right part this is done r

58
00:02:03,200 --> 00:02:05,759
times with r the number of fronts and at

59
00:02:05,759 --> 00:02:07,600
the end we obtain the ciphertext by

60
00:02:07,600 --> 00:02:09,679
concatenating the left part on the right

61
00:02:09,679 --> 00:02:12,319
part so fester network is characterized

62
00:02:12,319 --> 00:02:15,040
by a block size and a key size keppa a

63
00:02:15,040 --> 00:02:16,879
number of fronts are on the round

64
00:02:16,879 --> 00:02:19,760
function f the famous example of festive

65
00:02:19,760 --> 00:02:22,959
cipher is the data encryption standard

66
00:02:22,959 --> 00:02:25,360
here the the run function will not

67
00:02:25,360 --> 00:02:27,599
depend on the run key so the run key

68
00:02:27,599 --> 00:02:30,480
will just pixel to the right part

69
00:02:30,480 --> 00:02:33,200
so now let's speak about simon speck and

70
00:02:33,200 --> 00:02:35,599
cymac so simon is a festive network with

71
00:02:35,599 --> 00:02:37,599
a quality grant function this round

72
00:02:37,599 --> 00:02:40,640
function is made of a left rotation of 8

73
00:02:40,640 --> 00:02:43,920
bit and a left rotation of 1 bits

74
00:02:43,920 --> 00:02:45,120
then

75
00:02:45,120 --> 00:02:47,360
those two things are on b twice and the

76
00:02:47,360 --> 00:02:50,720
result is zero to a x rotated by 2 bit

77
00:02:50,720 --> 00:02:51,840
to the left

78
00:02:51,840 --> 00:02:54,160
and simon has a linear key schedule

79
00:02:54,160 --> 00:02:56,480
concerning spec spec is an add rotate

80
00:02:56,480 --> 00:02:59,280
and xor cipher with this round function

81
00:02:59,280 --> 00:03:00,800
here i will not describe this round

82
00:03:00,800 --> 00:03:02,319
function because it's not the topic of

83
00:03:02,319 --> 00:03:04,800
this talk and spec has the particularity

84
00:03:04,800 --> 00:03:06,879
that he reuses its run function in the

85
00:03:06,879 --> 00:03:09,519
key schedule concerning cymex segment is

86
00:03:09,519 --> 00:03:11,200
a festival network with a quadratic

87
00:03:11,200 --> 00:03:13,280
round function this round function is

88
00:03:13,280 --> 00:03:14,800
very similar to the run function of

89
00:03:14,800 --> 00:03:17,360
simon but for simon the rotation amounts

90
00:03:17,360 --> 00:03:19,920
are eight one and two and for simek the

91
00:03:19,920 --> 00:03:23,280
rotation amounts are five zero on one

92
00:03:23,280 --> 00:03:26,080
and simek reuses its run function in the

93
00:03:26,080 --> 00:03:28,720
case schedule as expected so in a more

94
00:03:28,720 --> 00:03:31,519
graphical way simon works as follow so

95
00:03:31,519 --> 00:03:33,280
we have a rotation of eight bit to the

96
00:03:33,280 --> 00:03:35,599
left a rotation of one bit to the left

97
00:03:35,599 --> 00:03:37,920
and both are on bitwise and the result

98
00:03:37,920 --> 00:03:39,920
is grow to the right part this is a

99
00:03:39,920 --> 00:03:41,920
non-linear part and there is also a

100
00:03:41,920 --> 00:03:44,080
linear part which is composed of a left

101
00:03:44,080 --> 00:03:46,400
rotation of two bits

102
00:03:46,400 --> 00:03:47,360
there are

103
00:03:47,360 --> 00:03:49,760
10 sets of parameters for simon with

104
00:03:49,760 --> 00:03:51,840
different block size key size and number

105
00:03:51,840 --> 00:03:54,239
of fronts and the key schedule of simon

106
00:03:54,239 --> 00:03:57,120
is linear concerning cymek the rotation

107
00:03:57,120 --> 00:03:59,840
amounts are five zero on one and there

108
00:03:59,840 --> 00:04:02,879
is only three sets of parameters and the

109
00:04:02,879 --> 00:04:05,200
key size is always equal equal to the

110
00:04:05,200 --> 00:04:07,519
block size for cymac and cymac has a

111
00:04:07,519 --> 00:04:09,599
nonlinear key schedule which reuses the

112
00:04:09,599 --> 00:04:11,439
round function f

113
00:04:11,439 --> 00:04:13,840
so this is all for simon and simek and

114
00:04:13,840 --> 00:04:15,680
now let's speak about different script

115
00:04:15,680 --> 00:04:18,000
analysis so here we represent the

116
00:04:18,000 --> 00:04:20,478
possible input difference

117
00:04:20,478 --> 00:04:23,120
here and the possible output differences

118
00:04:23,120 --> 00:04:26,080
here so we defined a differential as a

119
00:04:26,080 --> 00:04:28,000
per delta delta prime such that the

120
00:04:28,000 --> 00:04:29,840
probability that an input difference

121
00:04:29,840 --> 00:04:32,720
delta output difference del prime is

122
00:04:32,720 --> 00:04:35,440
bigger than 2 to the minus n with n the

123
00:04:35,440 --> 00:04:37,040
block size

124
00:04:37,040 --> 00:04:39,520
in order to find such differential we'll

125
00:04:39,520 --> 00:04:42,000
study the propagation of differences

126
00:04:42,000 --> 00:04:44,479
through every round

127
00:04:44,479 --> 00:04:45,759
and then

128
00:04:45,759 --> 00:04:47,680
we first we need to define the

129
00:04:47,680 --> 00:04:50,320
probability transition through run run

130
00:04:50,320 --> 00:04:52,800
so the probability transition throughout

131
00:04:52,800 --> 00:04:55,040
round is just the probability that an

132
00:04:55,040 --> 00:04:56,800
input difference delta output a

133
00:04:56,800 --> 00:04:59,120
difference delta prime through run round

134
00:04:59,120 --> 00:05:01,600
this can be extending to our rounds

135
00:05:01,600 --> 00:05:04,080
using trails so the probability of a

136
00:05:04,080 --> 00:05:06,080
trail is just the product of the

137
00:05:06,080 --> 00:05:08,880
probability of each round transition so

138
00:05:08,880 --> 00:05:11,840
trail is determined by the differences

139
00:05:11,840 --> 00:05:14,320
at each one so here the trail defined by

140
00:05:14,320 --> 00:05:16,240
delta zero delta one delta two delta

141
00:05:16,240 --> 00:05:18,800
three and data four uh happens with

142
00:05:18,800 --> 00:05:20,960
probability p one times p two times p

143
00:05:20,960 --> 00:05:23,680
three times before so this is for run

144
00:05:23,680 --> 00:05:25,919
trail over r round but if you want to

145
00:05:25,919 --> 00:05:27,520
compute the probability that the

146
00:05:27,520 --> 00:05:29,759
difference delta 0 output difference

147
00:05:29,759 --> 00:05:32,320
delta 4 we need to take into account all

148
00:05:32,320 --> 00:05:34,720
those trails and as we can see here

149
00:05:34,720 --> 00:05:36,479
there are many many trails so in

150
00:05:36,479 --> 00:05:39,120
practice it is invisible to compute this

151
00:05:39,120 --> 00:05:40,080
sum

152
00:05:40,080 --> 00:05:40,880
but

153
00:05:40,880 --> 00:05:43,199
for several ciphers this can be

154
00:05:43,199 --> 00:05:46,320
approximated using only one trail but

155
00:05:46,320 --> 00:05:49,039
for simon and psymek this can't be done

156
00:05:49,039 --> 00:05:52,000
because there is no dominant trail so in

157
00:05:52,000 --> 00:05:55,360
the following we will search for

158
00:05:55,360 --> 00:05:56,560
a way of

159
00:05:56,560 --> 00:05:58,720
computing a lower bond of

160
00:05:58,720 --> 00:06:00,400
this probability

161
00:06:00,400 --> 00:06:03,759
so here is for our different cell and we

162
00:06:03,759 --> 00:06:06,160
also define a difference we also obtain

163
00:06:06,160 --> 00:06:08,160
a differential distinguisher so if we

164
00:06:08,160 --> 00:06:10,720
collect jeepers of plaintext with input

165
00:06:10,720 --> 00:06:13,360
difference delta and if we compute a

166
00:06:13,360 --> 00:06:15,759
statistic q which is equal to the number

167
00:06:15,759 --> 00:06:18,080
of pair that have an output difference

168
00:06:18,080 --> 00:06:20,400
of delta prime then we are able to

169
00:06:20,400 --> 00:06:22,880
distinguish our cipher from a random

170
00:06:22,880 --> 00:06:25,759
permutation if the probability of our

171
00:06:25,759 --> 00:06:27,520
differential is bigger than 2 to the

172
00:06:27,520 --> 00:06:30,400
minus n because for the cipher q is

173
00:06:30,400 --> 00:06:33,120
expected to be approximately d times the

174
00:06:33,120 --> 00:06:34,880
probability

175
00:06:34,880 --> 00:06:37,360
of our differential while for a random

176
00:06:37,360 --> 00:06:39,680
permutation q is expected to be

177
00:06:39,680 --> 00:06:43,280
approximately d times 2 to the minus n

178
00:06:43,280 --> 00:06:45,039
so this is for different circuit

179
00:06:45,039 --> 00:06:46,240
analysis

180
00:06:46,240 --> 00:06:48,800
and we can summarize uh

181
00:06:48,800 --> 00:06:50,800
the case for different circumstances

182
00:06:50,800 --> 00:06:52,319
like this so for different circuit

183
00:06:52,319 --> 00:06:55,039
analysis we study differential which are

184
00:06:55,039 --> 00:06:57,280
which is a per delta delta prime such

185
00:06:57,280 --> 00:06:58,720
that the probability that an input

186
00:06:58,720 --> 00:07:00,400
difference output a difference delta

187
00:07:00,400 --> 00:07:01,280
prime

188
00:07:01,280 --> 00:07:02,960
and this probability needs to be bigger

189
00:07:02,960 --> 00:07:04,800
than 2 to the minus n

190
00:07:04,800 --> 00:07:05,680
so

191
00:07:05,680 --> 00:07:07,280
to find some

192
00:07:07,280 --> 00:07:09,039
differential we will define the

193
00:07:09,039 --> 00:07:10,639
probabilities transition through one

194
00:07:10,639 --> 00:07:12,080
round and

195
00:07:12,080 --> 00:07:14,160
in order to find a different cell the

196
00:07:14,160 --> 00:07:16,560
probability of this differential is just

197
00:07:16,560 --> 00:07:19,759
the sum over all those trails

198
00:07:19,759 --> 00:07:22,240
under the sum of all the probability of

199
00:07:22,240 --> 00:07:23,440
this trail

200
00:07:23,440 --> 00:07:25,120
so this is for different cell

201
00:07:25,120 --> 00:07:26,560
cryptanalysis and for linear

202
00:07:26,560 --> 00:07:28,560
cryptanalysis we have approximately the

203
00:07:28,560 --> 00:07:30,960
same thing so concerning linear cut

204
00:07:30,960 --> 00:07:32,800
analysis will focus on linear

205
00:07:32,800 --> 00:07:35,840
approximation which is a per alpha for

206
00:07:35,840 --> 00:07:38,400
prime such as the probability that x

207
00:07:38,400 --> 00:07:40,720
massed by alpha equal the run or the

208
00:07:40,720 --> 00:07:42,960
encryption of x mass by alpha prime

209
00:07:42,960 --> 00:07:45,599
minus 1 alpha and the absolute value of

210
00:07:45,599 --> 00:07:47,759
this need to be bigger than 2 to the

211
00:07:47,759 --> 00:07:50,319
minus n over 2.

212
00:07:50,319 --> 00:07:52,319
and in order to find some linear

213
00:07:52,319 --> 00:07:54,639
approximation we will define the

214
00:07:54,639 --> 00:07:57,360
correlation of alpha alpha prime for run

215
00:07:57,360 --> 00:08:00,080
run as two times the probability that x

216
00:08:00,080 --> 00:08:02,319
mass by alpha equals the one wrong

217
00:08:02,319 --> 00:08:05,199
inclusion of x mass by alpha prime minus

218
00:08:05,199 --> 00:08:06,560
one

219
00:08:06,560 --> 00:08:07,599
and for

220
00:08:07,599 --> 00:08:10,080
our roms we will define the elp which is

221
00:08:10,080 --> 00:08:13,280
the expected linear potential of alpha 0

222
00:08:13,280 --> 00:08:14,879
alpha r as

223
00:08:14,879 --> 00:08:17,440
the sum over all the trails of the

224
00:08:17,440 --> 00:08:19,840
product of the square correlation

225
00:08:19,840 --> 00:08:22,160
so this formula is really similar to the

226
00:08:22,160 --> 00:08:24,479
formula of the differential case so in

227
00:08:24,479 --> 00:08:26,879
the following we will apply uh our

228
00:08:26,879 --> 00:08:28,800
approach to different cell and linear

229
00:08:28,800 --> 00:08:30,560
cryptanalysis

230
00:08:30,560 --> 00:08:32,559
so uh we also obtain a linear

231
00:08:32,559 --> 00:08:35,200
distinguisher so uh for this thing this

232
00:08:35,200 --> 00:08:37,519
distinguisher we need to collect deepers

233
00:08:37,519 --> 00:08:40,159
of plaintext ciphertext and to compute

234
00:08:40,159 --> 00:08:42,240
our statistic q which is equal to the

235
00:08:42,240 --> 00:08:44,560
number of pairs such that a p mass by

236
00:08:44,560 --> 00:08:47,680
alpha equals c mass by alpha prime minus

237
00:08:47,680 --> 00:08:49,839
the number of pairs that do not satisfy

238
00:08:49,839 --> 00:08:52,480
this relation and

239
00:08:52,480 --> 00:08:55,040
for the cipher q square is expected to

240
00:08:55,040 --> 00:08:57,519
be approximately d times the elp of

241
00:08:57,519 --> 00:08:59,760
alpha alpha prime while for a random

242
00:08:59,760 --> 00:09:02,000
permutation q square is expected to be

243
00:09:02,000 --> 00:09:05,200
approximately d times 2 to the minus n

244
00:09:05,200 --> 00:09:07,920
so in the next two parts we will focus

245
00:09:07,920 --> 00:09:08,720
on

246
00:09:08,720 --> 00:09:10,720
how to find some stronger distinguisher

247
00:09:10,720 --> 00:09:13,120
for simon and simon

248
00:09:13,120 --> 00:09:16,000
so let's start by the differential case

249
00:09:16,000 --> 00:09:17,920
so first we'll need to

250
00:09:17,920 --> 00:09:19,519
compute the probabilities transition

251
00:09:19,519 --> 00:09:22,560
through run run so through f so let's

252
00:09:22,560 --> 00:09:24,640
start by a small example here we

253
00:09:24,640 --> 00:09:27,839
represent one round of simek and if we

254
00:09:27,839 --> 00:09:30,160
consider a difference alpha equal 1 on

255
00:09:30,160 --> 00:09:31,760
the left part

256
00:09:31,760 --> 00:09:34,399
then we'll study the propagation of this

257
00:09:34,399 --> 00:09:36,560
difference through one round so first

258
00:09:36,560 --> 00:09:38,720
there is the linear uh

259
00:09:38,720 --> 00:09:42,000
propagation so uh this prop uh so this

260
00:09:42,000 --> 00:09:44,640
difference propagates uh through the run

261
00:09:44,640 --> 00:09:48,399
around the run bit rotation to the left

262
00:09:48,399 --> 00:09:50,800
uh and then there is the non-linear

263
00:09:50,800 --> 00:09:53,279
diffusion so in order to study the

264
00:09:53,279 --> 00:09:56,080
difference uh diffusion uh through the

265
00:09:56,080 --> 00:09:59,279
on operator we need to look at the value

266
00:09:59,279 --> 00:10:01,920
of the same bits in the other states so

267
00:10:01,920 --> 00:10:04,800
here for this bit we need to study the

268
00:10:04,800 --> 00:10:07,279
value of the gray bit and if the value

269
00:10:07,279 --> 00:10:09,519
is 0 then the difference will not

270
00:10:09,519 --> 00:10:12,720
propagate because 0 on 1 equals 0 on 0

271
00:10:12,720 --> 00:10:16,720
on 0 is equal also

272
00:10:16,880 --> 00:10:17,760
to

273
00:10:17,760 --> 00:10:18,720
zero

274
00:10:18,720 --> 00:10:21,680
but if the value is one then uh the

275
00:10:21,680 --> 00:10:24,079
difference uh propagate because one and

276
00:10:24,079 --> 00:10:27,600
zero equals zero on one on one equal one

277
00:10:27,600 --> 00:10:29,920
so uh here we have uh we will have

278
00:10:29,920 --> 00:10:32,160
sometimes a difference on this bit and

279
00:10:32,160 --> 00:10:34,079
some other time no difference

280
00:10:34,079 --> 00:10:35,839
the same thing happened for the second

281
00:10:35,839 --> 00:10:38,480
bit so in total we have four possible

282
00:10:38,480 --> 00:10:42,000
outputs and all each of these outputs

283
00:10:42,000 --> 00:10:46,040
happen with probability 0.25

284
00:10:46,320 --> 00:10:49,519
on this result can be generalized uh

285
00:10:49,519 --> 00:10:51,440
like this this was done by cobble

286
00:10:51,440 --> 00:10:55,040
leander on tsun at crypto 2015 and they

287
00:10:55,040 --> 00:10:57,600
say that since f is quadratic the exact

288
00:10:57,600 --> 00:10:59,600
probability transition through one run

289
00:10:59,600 --> 00:11:01,680
can be computed efficiently for simon

290
00:11:01,680 --> 00:11:02,640
and sami

291
00:11:02,640 --> 00:11:06,320
so they obtain those formula and now

292
00:11:06,320 --> 00:11:08,640
we are able to compute the probability

293
00:11:08,640 --> 00:11:10,959
transition through run round

294
00:11:10,959 --> 00:11:12,000
but

295
00:11:12,000 --> 00:11:14,000
computing the probability transition

296
00:11:14,000 --> 00:11:16,560
through our round remains hard

297
00:11:16,560 --> 00:11:17,360
and

298
00:11:17,360 --> 00:11:19,920
here is our starting point so

299
00:11:19,920 --> 00:11:22,320
we observe this thing so if we start

300
00:11:22,320 --> 00:11:24,880
with differences in a window of size w

301
00:11:24,880 --> 00:11:27,040
then in the worst case the difference

302
00:11:27,040 --> 00:11:29,839
will stand in a window of size w plus 5

303
00:11:29,839 --> 00:11:31,920
because the biggest amount of rotation

304
00:11:31,920 --> 00:11:34,800
is 5 but sometimes the

305
00:11:34,800 --> 00:11:36,000
difference

306
00:11:36,000 --> 00:11:37,760
will not propagate through the end

307
00:11:37,760 --> 00:11:41,519
operator and because the rotation

308
00:11:41,519 --> 00:11:44,079
amount five is associated to the

309
00:11:44,079 --> 00:11:46,240
nonlinear parts then sometimes the

310
00:11:46,240 --> 00:11:49,440
difference uh will not propagate so uh

311
00:11:49,440 --> 00:11:51,200
in the best case if we start with

312
00:11:51,200 --> 00:11:53,680
differences in a window of size w equal

313
00:11:53,680 --> 00:11:56,480
three then uh we will obtain some

314
00:11:56,480 --> 00:11:59,600
differences in a window of size w plus 1

315
00:11:59,600 --> 00:12:00,959
at the outputs

316
00:12:00,959 --> 00:12:01,839
so

317
00:12:01,839 --> 00:12:04,880
this can be summarized like this

318
00:12:04,880 --> 00:12:07,600
cymex has a relatively slow diffusion so

319
00:12:07,600 --> 00:12:09,519
in the following we'll exploit this

320
00:12:09,519 --> 00:12:10,639
property

321
00:12:10,639 --> 00:12:12,880
so our idea is to focus on trails that

322
00:12:12,880 --> 00:12:15,360
are only active in a window of w bits so

323
00:12:15,360 --> 00:12:17,680
it means that in place of taking into

324
00:12:17,680 --> 00:12:20,000
account all all of those trails we'll

325
00:12:20,000 --> 00:12:22,480
just focus on a window

326
00:12:22,480 --> 00:12:25,200
on all the trails that are in a window

327
00:12:25,200 --> 00:12:26,639
so

328
00:12:26,639 --> 00:12:30,399
here more formally we choose w size of

329
00:12:30,399 --> 00:12:33,600
the window and we define delta w as the

330
00:12:33,600 --> 00:12:35,600
vector space of the differences active

331
00:12:35,600 --> 00:12:38,720
only in the w least significant bits and

332
00:12:38,720 --> 00:12:40,560
due to the festal structure we also

333
00:12:40,560 --> 00:12:42,320
define delta w square which is the

334
00:12:42,320 --> 00:12:45,040
product delta w times delta w

335
00:12:45,040 --> 00:12:46,480
and then

336
00:12:46,480 --> 00:12:48,399
we are able to compute a lower bound of

337
00:12:48,399 --> 00:12:50,000
the probability of the differential

338
00:12:50,000 --> 00:12:51,760
delta zero delta r

339
00:12:51,760 --> 00:12:53,920
by summing over all the characteristics

340
00:12:53,920 --> 00:12:56,320
with intermediate differences in delta w

341
00:12:56,320 --> 00:12:57,360
squared

342
00:12:57,360 --> 00:13:02,639
so here we just compute the sum of all

343
00:13:02,639 --> 00:13:05,040
the probability of the trails that's r

344
00:13:05,040 --> 00:13:07,600
in a window of size delta w out of size

345
00:13:07,600 --> 00:13:09,200
w

346
00:13:09,200 --> 00:13:11,279
so uh in a more

347
00:13:11,279 --> 00:13:15,120
in practice we are able to compute the

348
00:13:15,120 --> 00:13:18,240
lower bond for a window of size 18

349
00:13:18,240 --> 00:13:21,839
but for size 18 it takes approximately a

350
00:13:21,839 --> 00:13:24,399
week on a 48 core machine using one

351
00:13:24,399 --> 00:13:26,639
terabyte of ram

352
00:13:26,639 --> 00:13:29,760
so this is a big computation

353
00:13:29,760 --> 00:13:32,800
so here are our results so first we find

354
00:13:32,800 --> 00:13:34,800
some tire lower bond for existing

355
00:13:34,800 --> 00:13:37,920
differential so this was done with w

356
00:13:37,920 --> 00:13:41,199
equal 18 and for example for the first

357
00:13:41,199 --> 00:13:43,519
differential the previous probability

358
00:13:43,519 --> 00:13:46,320
was 2 to the minus 60.02

359
00:13:46,320 --> 00:13:48,480
but here we find that a lower bound of

360
00:13:48,480 --> 00:13:53,560
the differential is 2 to the minus 54.60

361
00:13:53,600 --> 00:13:56,560
we also find a set of 64

362
00:13:56,560 --> 00:13:58,880
best characteristics but

363
00:13:58,880 --> 00:14:00,959
in the following we'll

364
00:14:00,959 --> 00:14:03,600
use the differential 01 to 1 0 because

365
00:14:03,600 --> 00:14:05,839
this differential is almost as good and

366
00:14:05,839 --> 00:14:07,279
it will lead to a more efficient key

367
00:14:07,279 --> 00:14:09,279
recovery because it has fewer active

368
00:14:09,279 --> 00:14:10,959
bits

369
00:14:10,959 --> 00:14:12,959
here is a comparison of

370
00:14:12,959 --> 00:14:15,279
the different size 01 to 1 0 on the

371
00:14:15,279 --> 00:14:17,680
different cell one two two two one which

372
00:14:17,680 --> 00:14:19,040
is one of

373
00:14:19,040 --> 00:14:20,800
the best characteristics we have

374
00:14:20,800 --> 00:14:23,519
identified and for example for thirty

375
00:14:23,519 --> 00:14:25,920
rounds the differences zero one two one

376
00:14:25,920 --> 00:14:28,399
zero have probability two to the minus

377
00:14:28,399 --> 00:14:30,079
sixty point 60.41

378
00:14:30,079 --> 00:14:31,760
while the best characteristic we have

379
00:14:31,760 --> 00:14:34,160
identified have a probability 2 to the

380
00:14:34,160 --> 00:14:36,639
minus 59.92

381
00:14:36,639 --> 00:14:38,399
so those two probabilities are really

382
00:14:38,399 --> 00:14:40,639
close so in the following we'll use the

383
00:14:40,639 --> 00:14:42,639
first one because it has fewer active

384
00:14:42,639 --> 00:14:45,199
bits so the key recovery part will be

385
00:14:45,199 --> 00:14:46,880
more efficient

386
00:14:46,880 --> 00:14:49,760
moreover we also study the effect of the

387
00:14:49,760 --> 00:14:52,480
size of the window w

388
00:14:52,480 --> 00:14:55,600
and what we observe is that after w

389
00:14:55,600 --> 00:14:58,399
equal 15 the increase is quite slow

390
00:14:58,399 --> 00:15:00,880
so we expect our lower bound of the

391
00:15:00,880 --> 00:15:02,160
difference of the probability of the

392
00:15:02,160 --> 00:15:03,920
differential to be close to the exact

393
00:15:03,920 --> 00:15:06,480
probability of the different cell

394
00:15:06,480 --> 00:15:08,560
so this is all for different circuit

395
00:15:08,560 --> 00:15:10,320
analysis now let's move on linear

396
00:15:10,320 --> 00:15:11,600
cryptanalysis

397
00:15:11,600 --> 00:15:12,480
so

398
00:15:12,480 --> 00:15:14,480
we apply exactly the same approach to

399
00:15:14,480 --> 00:15:16,800
linear cryptanalysis and we find a set

400
00:15:16,800 --> 00:15:19,600
of 64 almost optimal trials

401
00:15:19,600 --> 00:15:21,920
and those threads are just bit reverse

402
00:15:21,920 --> 00:15:23,760
version of the optimal differential

403
00:15:23,760 --> 00:15:25,920
characteristics but

404
00:15:25,920 --> 00:15:28,560
as for the differential case we will

405
00:15:28,560 --> 00:15:31,600
use the trail one zero two zero one

406
00:15:31,600 --> 00:15:33,680
because it has fewer active bits so it

407
00:15:33,680 --> 00:15:35,360
will lead to a more efficient key

408
00:15:35,360 --> 00:15:37,440
recovery

409
00:15:37,440 --> 00:15:40,480
so here we compare our results on

410
00:15:40,480 --> 00:15:43,199
differential on linear analysis and what

411
00:15:43,199 --> 00:15:44,959
we observe is that the results are

412
00:15:44,959 --> 00:15:46,800
really close so for example for 30

413
00:15:46,800 --> 00:15:49,920
rounds we have a probability of 2 to the

414
00:15:49,920 --> 00:15:52,720
minus 60.41 for the differential case

415
00:15:52,720 --> 00:15:54,680
and a probability of 2 to the minus

416
00:15:54,680 --> 00:15:57,600
60.36 for the linear case so those two

417
00:15:57,600 --> 00:16:00,560
values values are really really similar

418
00:16:00,560 --> 00:16:02,639
moreover here we represent in grade the

419
00:16:02,639 --> 00:16:04,480
log 2 of the number of trials that are

420
00:16:04,480 --> 00:16:06,959
taking into account in our analysis and

421
00:16:06,959 --> 00:16:08,720
what we observe is that

422
00:16:08,720 --> 00:16:10,639
we take into account a huge number of

423
00:16:10,639 --> 00:16:11,600
trades

424
00:16:11,600 --> 00:16:13,920
so for example for 30 rounds we takes

425
00:16:13,920 --> 00:16:16,639
into account two to the 254

426
00:16:16,639 --> 00:16:19,600
trails so this is why our lower bonds

427
00:16:19,600 --> 00:16:22,079
are higher than the previous lower bonds

428
00:16:22,079 --> 00:16:23,680
this is due to the fact that we take

429
00:16:23,680 --> 00:16:25,600
into account a

430
00:16:25,600 --> 00:16:28,720
high number of trails

431
00:16:28,720 --> 00:16:30,720
so here

432
00:16:30,720 --> 00:16:31,600
this

433
00:16:31,600 --> 00:16:32,720
our

434
00:16:32,720 --> 00:16:34,720
results on simon and

435
00:16:34,720 --> 00:16:37,040
we study the effects of the size of the

436
00:16:37,040 --> 00:16:40,480
window for simon in linear cryptanalysis

437
00:16:40,480 --> 00:16:42,399
and what we observed is that the

438
00:16:42,399 --> 00:16:44,560
increase is quite important even for the

439
00:16:44,560 --> 00:16:47,920
large values of w so this is probably

440
00:16:47,920 --> 00:16:49,600
due to the fact that the rotations

441
00:16:49,600 --> 00:16:52,160
amounts for simon are higher are bigger

442
00:16:52,160 --> 00:16:54,320
than the rotations amount for cymek

443
00:16:54,320 --> 00:16:56,160
because for simon we have a rotation of

444
00:16:56,160 --> 00:16:59,519
8 bits while for simek the the bigger

445
00:16:59,519 --> 00:17:01,279
rotation is 5.

446
00:17:01,279 --> 00:17:02,480
so

447
00:17:02,480 --> 00:17:04,559
here we expect our lower bound of the

448
00:17:04,559 --> 00:17:06,400
probability of the linear earth for

449
00:17:06,400 --> 00:17:09,039
simon to be not as tight as the one for

450
00:17:09,039 --> 00:17:10,959
simek so probably further work and

451
00:17:10,959 --> 00:17:14,319
improve our results for simon simon

452
00:17:14,319 --> 00:17:17,599
so this is all for linear cryptanalysis

453
00:17:17,599 --> 00:17:20,480
now let's move on a key recovery attack

454
00:17:20,480 --> 00:17:23,520
so here we start with our distant issues

455
00:17:23,520 --> 00:17:25,039
so a linear or differential

456
00:17:25,039 --> 00:17:27,919
distinguisher and then in order to do a

457
00:17:27,919 --> 00:17:30,000
recovery attack we will add some rounds

458
00:17:30,000 --> 00:17:32,880
before and or after our distinguisher

459
00:17:32,880 --> 00:17:33,840
and then

460
00:17:33,840 --> 00:17:36,320
we'll need to guess a subset of the key

461
00:17:36,320 --> 00:17:40,000
which is here denoted kp kt kb and kc

462
00:17:40,000 --> 00:17:42,640
and then using this subset of the key we

463
00:17:42,640 --> 00:17:45,360
will be able to compute our statistic q

464
00:17:45,360 --> 00:17:47,840
so the statistic of our distinguisher

465
00:17:47,840 --> 00:17:50,559
we did not kpsg the total number of

466
00:17:50,559 --> 00:17:53,200
guess bits on this number need to be

467
00:17:53,200 --> 00:17:56,320
smaller than the number of nand key size

468
00:17:56,320 --> 00:17:57,600
kpa

469
00:17:57,600 --> 00:17:59,919
so a nice way to do a key recovery

470
00:17:59,919 --> 00:18:00,880
attack

471
00:18:00,880 --> 00:18:03,760
is as follow so first we need to go over

472
00:18:03,760 --> 00:18:06,000
all the possible key guess and then for

473
00:18:06,000 --> 00:18:07,520
each key guess

474
00:18:07,520 --> 00:18:09,679
we will need to compute our statistic q

475
00:18:09,679 --> 00:18:12,000
of k and if this statistic is bigger

476
00:18:12,000 --> 00:18:14,240
than the threshold s then k is a

477
00:18:14,240 --> 00:18:17,280
possible candidate this requires d times

478
00:18:17,280 --> 00:18:20,320
2 to decap a g operation

479
00:18:20,320 --> 00:18:21,280
with the

480
00:18:21,280 --> 00:18:25,039
data on kpg the size of k

481
00:18:25,039 --> 00:18:27,919
but this can be improved to d plus 2 to

482
00:18:27,919 --> 00:18:30,799
the kpg using algorithm tricks so for

483
00:18:30,799 --> 00:18:32,720
differential cryptanalysis we will use

484
00:18:32,720 --> 00:18:34,880
the dynamic guessing and for linear

485
00:18:34,880 --> 00:18:36,640
cryptanalysis we will use the false

486
00:18:36,640 --> 00:18:39,120
watch transform approach

487
00:18:39,120 --> 00:18:40,880
i will not describe those two attacks in

488
00:18:40,880 --> 00:18:44,080
details but just to give an overview

489
00:18:44,080 --> 00:18:46,720
so this those attacks are made of three

490
00:18:46,720 --> 00:18:49,120
steps so first we need to find efficient

491
00:18:49,120 --> 00:18:51,440
distinguishers so this was done in the

492
00:18:51,440 --> 00:18:53,760
previous parts then we'll need to find

493
00:18:53,760 --> 00:18:55,520
the subset of the key that need to be

494
00:18:55,520 --> 00:18:56,400
guessed

495
00:18:56,400 --> 00:18:59,039
to evaluate our statistic q and then

496
00:18:59,039 --> 00:19:00,880
we'll need to rearrange operation to

497
00:19:00,880 --> 00:19:03,200
reduce the time complexity from d times

498
00:19:03,200 --> 00:19:06,880
2 to the kpg to d plus 2 to the kpg

499
00:19:06,880 --> 00:19:08,000
so

500
00:19:08,000 --> 00:19:10,799
we have previously seen that the step 0

501
00:19:10,799 --> 00:19:12,480
is quite similar for differential and

502
00:19:12,480 --> 00:19:14,080
linear crypto analysis

503
00:19:14,080 --> 00:19:14,799
and

504
00:19:14,799 --> 00:19:17,360
the step 2 is also really similar for

505
00:19:17,360 --> 00:19:19,280
different cell and linear cryptanalysis

506
00:19:19,280 --> 00:19:21,760
but concerning the step 1 this step is

507
00:19:21,760 --> 00:19:23,520
really different from different cell and

508
00:19:23,520 --> 00:19:25,280
linear cropped analysis

509
00:19:25,280 --> 00:19:29,039
because we'll need to guess a bigger

510
00:19:29,039 --> 00:19:31,919
higher number of bits for differential

511
00:19:31,919 --> 00:19:33,440
script analysis than for linear

512
00:19:33,440 --> 00:19:35,600
cryptanalysis so here we compare the

513
00:19:35,600 --> 00:19:37,280
number of bits that need to be guessed

514
00:19:37,280 --> 00:19:40,000
for different cell and linear attacks

515
00:19:40,000 --> 00:19:44,240
against cymex 64 128 so for each case so

516
00:19:44,240 --> 00:19:46,240
different cell and linear analysis we

517
00:19:46,240 --> 00:19:48,880
have two columns so the first column

518
00:19:48,880 --> 00:19:49,840
means

519
00:19:49,840 --> 00:19:52,000
the total number of bits on the second

520
00:19:52,000 --> 00:19:54,400
column mean the number of independent

521
00:19:54,400 --> 00:19:56,640
bits because one will guess a large

522
00:19:56,640 --> 00:19:58,559
number of key bits

523
00:19:58,559 --> 00:19:59,919
those qubits

524
00:19:59,919 --> 00:20:01,600
some of those qubits will be linked

525
00:20:01,600 --> 00:20:03,919
using key schedule relations

526
00:20:03,919 --> 00:20:06,559
so sometimes the number of independent

527
00:20:06,559 --> 00:20:08,480
key bits will be smaller than the total

528
00:20:08,480 --> 00:20:09,760
number of bits

529
00:20:09,760 --> 00:20:11,840
and what we observed is that if we want

530
00:20:11,840 --> 00:20:14,720
to add seven rounds before on or after

531
00:20:14,720 --> 00:20:16,480
our distinguisher

532
00:20:16,480 --> 00:20:19,280
we will need to guess 114 bits in

533
00:20:19,280 --> 00:20:22,080
differential flip analysis but in linear

534
00:20:22,080 --> 00:20:24,799
script analysis only 68 bits will need

535
00:20:24,799 --> 00:20:26,799
to be guessed so

536
00:20:26,799 --> 00:20:28,799
our attacks in linear credit analysis

537
00:20:28,799 --> 00:20:31,200
will be better than in different circuit

538
00:20:31,200 --> 00:20:32,720
analysis because

539
00:20:32,720 --> 00:20:34,400
those numbers are smaller than the

540
00:20:34,400 --> 00:20:36,960
number for different circuit analysis

541
00:20:36,960 --> 00:20:40,799
so uh here our our results so uh i just

542
00:20:40,799 --> 00:20:42,880
we just put the linear result because

543
00:20:42,880 --> 00:20:44,080
the linear

544
00:20:44,080 --> 00:20:45,919
cryptanalysis is uh

545
00:20:45,919 --> 00:20:47,679
better than different circuit analysis

546
00:20:47,679 --> 00:20:48,640
here

547
00:20:48,640 --> 00:20:50,360
and for cymex

548
00:20:50,360 --> 00:20:53,360
64-128 we obtained an attack

549
00:20:53,360 --> 00:20:56,159
that reached 42 rounds out of 44 while

550
00:20:56,159 --> 00:20:58,080
previously the best attack only reached

551
00:20:58,080 --> 00:21:01,679
37 rounds concerning simon for example

552
00:21:01,679 --> 00:21:06,640
for cymac simon 96 124 on 44 we find an

553
00:21:06,640 --> 00:21:10,080
attack on 45 rounds out of 54 while

554
00:21:10,080 --> 00:21:13,200
previously only 38 rounds were reached

555
00:21:13,200 --> 00:21:14,720
so

556
00:21:14,720 --> 00:21:17,280
to conclude uh in this work we find some

557
00:21:17,280 --> 00:21:19,280
better probability for existing

558
00:21:19,280 --> 00:21:21,360
differential and linear distinguishers

559
00:21:21,360 --> 00:21:23,600
using trails with all intermediate state

560
00:21:23,600 --> 00:21:25,840
in a window of w bits

561
00:21:25,840 --> 00:21:28,000
we also find some new distinguishers

562
00:21:28,000 --> 00:21:31,360
with the minimum number of activates so

563
00:21:31,360 --> 00:21:34,559
then the key recovery are cheaper

564
00:21:34,559 --> 00:21:35,520
and

565
00:21:35,520 --> 00:21:38,240
using that we obtained some attack

566
00:21:38,240 --> 00:21:40,240
against cymek and simon and in

567
00:21:40,240 --> 00:21:42,640
particular we obtained an attack on 42

568
00:21:42,640 --> 00:21:46,960
rounds out of 44 for cymax 64 128 and 43

569
00:21:46,960 --> 00:21:51,120
rounds out of 52 for simon 96.96

570
00:21:51,120 --> 00:21:53,520
and those attacks used

571
00:21:53,520 --> 00:21:54,559
some

572
00:21:54,559 --> 00:21:57,280
advanced tricks uh as the first

573
00:21:57,280 --> 00:21:59,679
transform approach

574
00:21:59,679 --> 00:22:02,640
however concerning simon our lower bond

575
00:22:02,640 --> 00:22:06,000
of the linear approximations seems to be

576
00:22:06,000 --> 00:22:08,880
not as tight as the lower bond for cymek

577
00:22:08,880 --> 00:22:10,640
this is probably due to the fact that

578
00:22:10,640 --> 00:22:12,880
the amount rotation for simon are bigger

579
00:22:12,880 --> 00:22:15,280
than the amount rotation for cymek so

580
00:22:15,280 --> 00:22:18,080
probably further work can improve our

581
00:22:18,080 --> 00:22:19,200
results

582
00:22:19,200 --> 00:22:21,600
so thanks for listening and if you go if

583
00:22:21,600 --> 00:22:23,440
you want more detail you can read our

584
00:22:23,440 --> 00:22:25,840
paper

