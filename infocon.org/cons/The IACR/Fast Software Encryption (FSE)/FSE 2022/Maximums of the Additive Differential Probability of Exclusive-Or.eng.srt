1
00:00:01,280 --> 00:00:03,760
hi everyone nikimura here this is a

2
00:00:03,760 --> 00:00:07,200
pre-recorded talk for fsc 2020

3
00:00:07,200 --> 00:00:10,080
the title of this talk is maximums of

4
00:00:10,080 --> 00:00:12,639
the additive differential probability of

5
00:00:12,639 --> 00:00:14,240
exclusive or

6
00:00:14,240 --> 00:00:16,079
it's a result that came forth from the

7
00:00:16,079 --> 00:00:18,800
2020 cryptography summer school so it

8
00:00:18,800 --> 00:00:20,720
was a summer school organized by

9
00:00:20,720 --> 00:00:23,439
novosibirsk state university

10
00:00:23,439 --> 00:00:25,119
the goal of the summer school was to

11
00:00:25,119 --> 00:00:27,760
divide the students into groups to work

12
00:00:27,760 --> 00:00:29,760
on a particular problem

13
00:00:29,760 --> 00:00:31,279
remember this from the way that the

14
00:00:31,279 --> 00:00:33,520
ecrypt research retreats or asian

15
00:00:33,520 --> 00:00:35,920
symmetric key works

16
00:00:35,920 --> 00:00:38,160
the problem that i proposed was one that

17
00:00:38,160 --> 00:00:40,640
i've been giving to many students over

18
00:00:40,640 --> 00:00:43,040
the past 10 years

19
00:00:43,040 --> 00:00:45,120
every time that i've been asked to give

20
00:00:45,120 --> 00:00:47,039
some problem to study

21
00:00:47,039 --> 00:00:49,200
it's a problem that's very easy to state

22
00:00:49,200 --> 00:00:52,559
basically it is come up with a proof for

23
00:00:52,559 --> 00:00:56,960
a theorem at a paper of fsc 2004

24
00:00:56,960 --> 00:01:01,359
and this is a proof that has been lost

25
00:01:01,359 --> 00:01:03,520
now it's not a problem that i expected

26
00:01:03,520 --> 00:01:06,560
to be solved because in those 10 years

27
00:01:06,560 --> 00:01:08,479
students have found it fun to explore

28
00:01:08,479 --> 00:01:10,240
some basic techniques and get a bit of

29
00:01:10,240 --> 00:01:13,200
taste for symmetric key crypt analysis

30
00:01:13,200 --> 00:01:15,520
but never came up with the solution

31
00:01:15,520 --> 00:01:18,240
so i was really surprised when the team

32
00:01:18,240 --> 00:01:19,680
reached out to me

33
00:01:19,680 --> 00:01:21,920
about two months after the summer school

34
00:01:21,920 --> 00:01:23,600
to let me know that a proof had been

35
00:01:23,600 --> 00:01:24,720
found

36
00:01:24,720 --> 00:01:26,400
now i'd like to stress

37
00:01:26,400 --> 00:01:29,360
this is not a result that is ground

38
00:01:29,360 --> 00:01:30,479
breaking

39
00:01:30,479 --> 00:01:32,240
in the way that

40
00:01:32,240 --> 00:01:35,280
we could just assume the proof was true

41
00:01:35,280 --> 00:01:38,560
and leave it at that right but still it

42
00:01:38,560 --> 00:01:41,360
does reveal some new insights

43
00:01:41,360 --> 00:01:42,880
and as i'm going to show you there are

44
00:01:42,880 --> 00:01:45,680
quite a few other results that follow

45
00:01:45,680 --> 00:01:48,079
from the study of this particular

46
00:01:48,079 --> 00:01:51,279
problem as i will show

47
00:01:51,600 --> 00:01:54,000
so i'm really really excited to give you

48
00:01:54,000 --> 00:01:56,399
this talk but before i'm going to say

49
00:01:56,399 --> 00:01:58,240
more i thought it would be a good idea

50
00:01:58,240 --> 00:02:01,520
to start with a basic overview of

51
00:02:01,520 --> 00:02:03,840
differential cryptanalysis

52
00:02:03,840 --> 00:02:05,600
so what's differential cryptanalysis

53
00:02:05,600 --> 00:02:08,560
well it's based on the idea that we're

54
00:02:08,560 --> 00:02:11,920
going to flip some bits at the input of

55
00:02:11,920 --> 00:02:13,680
the cryptographic algorithm let's say

56
00:02:13,680 --> 00:02:15,520
that it's a block cipher so that you'd

57
00:02:15,520 --> 00:02:18,239
be flipping bits in the plain text

58
00:02:18,239 --> 00:02:21,280
and then you want to see which outputs

59
00:02:21,280 --> 00:02:23,440
that's going to affect which output bits

60
00:02:23,440 --> 00:02:25,760
are going to be flipped

61
00:02:25,760 --> 00:02:27,360
now

62
00:02:27,360 --> 00:02:28,879
typically for a well-designed

63
00:02:28,879 --> 00:02:31,120
cryptographic algorithm those output

64
00:02:31,120 --> 00:02:33,120
bits are only going to be flipped with a

65
00:02:33,120 --> 00:02:34,840
certain

66
00:02:34,840 --> 00:02:37,200
probability and if there would be some

67
00:02:37,200 --> 00:02:39,840
probability that a particular input

68
00:02:39,840 --> 00:02:41,760
difference leads to a particular output

69
00:02:41,760 --> 00:02:44,560
difference higher than random

70
00:02:44,560 --> 00:02:46,319
then that is something that is

71
00:02:46,319 --> 00:02:48,400
considered to be a weakness because

72
00:02:48,400 --> 00:02:50,400
statistics of the cipher should be

73
00:02:50,400 --> 00:02:52,560
random but it can actually often be

74
00:02:52,560 --> 00:02:54,560
leveraged to do a more powerful attack

75
00:02:54,560 --> 00:02:57,280
as well for example to recover the

76
00:02:57,280 --> 00:03:00,159
secret key for a block cipher

77
00:03:00,159 --> 00:03:03,440
now typically a cipher consists of many

78
00:03:03,440 --> 00:03:04,400
rounds

79
00:03:04,400 --> 00:03:05,920
what we want to do is we want to

80
00:03:05,920 --> 00:03:08,000
determine the number of rounds that we

81
00:03:08,000 --> 00:03:09,760
can break

82
00:03:09,760 --> 00:03:11,920
because that gives us an idea of the

83
00:03:11,920 --> 00:03:15,040
security margin of the cipher

84
00:03:15,040 --> 00:03:16,720
shown on this slide

85
00:03:16,720 --> 00:03:19,120
is how it's often easier to make

86
00:03:19,120 --> 00:03:21,680
assumptions on the differences after

87
00:03:21,680 --> 00:03:23,360
each of the rounds

88
00:03:23,360 --> 00:03:24,959
because this helps us to calculate

89
00:03:24,959 --> 00:03:27,120
probabilities of course this is going to

90
00:03:27,120 --> 00:03:29,840
be a potential source for errors

91
00:03:29,840 --> 00:03:32,080
because it can be that there is more

92
00:03:32,080 --> 00:03:34,560
than one intermediate difference at a

93
00:03:34,560 --> 00:03:37,040
particular level that will eventually

94
00:03:37,040 --> 00:03:39,599
lead to the same output difference so

95
00:03:39,599 --> 00:03:41,040
that's uh

96
00:03:41,040 --> 00:03:42,400
something that is often called

97
00:03:42,400 --> 00:03:45,519
clustering in literature

98
00:03:45,519 --> 00:03:47,280
and it can also be

99
00:03:47,280 --> 00:03:50,239
that um because we're going to multiply

100
00:03:50,239 --> 00:03:52,640
the probabilities of every round

101
00:03:52,640 --> 00:03:54,560
assuming that they are independent that

102
00:03:54,560 --> 00:03:56,959
that's actually not a correct assumption

103
00:03:56,959 --> 00:03:59,599
and that um there might be a

104
00:03:59,599 --> 00:04:01,120
an

105
00:04:01,120 --> 00:04:02,319
error in

106
00:04:02,319 --> 00:04:05,519
computing it uh in that way

107
00:04:05,519 --> 00:04:07,680
now shown here in the slide what we have

108
00:04:07,680 --> 00:04:10,799
is a differential so a differential is

109
00:04:10,799 --> 00:04:14,239
delta x going to delta y and also a

110
00:04:14,239 --> 00:04:16,399
differential trail so for a trail we

111
00:04:16,399 --> 00:04:18,320
specify not only the input and the

112
00:04:18,320 --> 00:04:20,880
output difference but the intermediate

113
00:04:20,880 --> 00:04:25,360
differences after every round as well

114
00:04:25,360 --> 00:04:27,520
now we're going to focus on

115
00:04:27,520 --> 00:04:32,320
ar x or addition rotation xor algorithms

116
00:04:32,320 --> 00:04:34,960
so they involve a modular addition

117
00:04:34,960 --> 00:04:37,919
modulo 2 to the power n where n is the

118
00:04:37,919 --> 00:04:42,160
word size typically 32 or 64 bits the

119
00:04:42,160 --> 00:04:45,040
two other operations are a bit wise

120
00:04:45,040 --> 00:04:48,160
rotation and an exclusive ore

121
00:04:48,160 --> 00:04:51,360
now these are ciphers that are extremely

122
00:04:51,360 --> 00:04:54,080
fast especially on low end platforms

123
00:04:54,080 --> 00:04:55,680
that don't have any

124
00:04:55,680 --> 00:04:58,560
cryptographic instructions like

125
00:04:58,560 --> 00:05:00,800
instructions to compute a round or parts

126
00:05:00,800 --> 00:05:02,800
of a round of of aes

127
00:05:02,800 --> 00:05:05,280
so if you're looking at let's say a

128
00:05:05,280 --> 00:05:07,840
32-bit arm platform

129
00:05:07,840 --> 00:05:10,960
then you can do an addition and an xor

130
00:05:10,960 --> 00:05:14,080
operation on 32 bit watts in one clock

131
00:05:14,080 --> 00:05:15,039
cycle

132
00:05:15,039 --> 00:05:17,280
and the rotation can actually be done in

133
00:05:17,280 --> 00:05:18,960
zero clock cycles because on this

134
00:05:18,960 --> 00:05:21,759
particular platform you can provide the

135
00:05:21,759 --> 00:05:24,880
rotation amount for one

136
00:05:24,880 --> 00:05:27,440
operand as part of an instruction this

137
00:05:27,440 --> 00:05:28,639
instruction that case would be an

138
00:05:28,639 --> 00:05:30,160
additional or an

139
00:05:30,160 --> 00:05:31,840
xor instruction

140
00:05:31,840 --> 00:05:35,919
so these are really fast operations and

141
00:05:35,919 --> 00:05:37,600
if you want to analyze

142
00:05:37,600 --> 00:05:40,160
the way that differences propagate

143
00:05:40,160 --> 00:05:42,240
throughout these operations one thing we

144
00:05:42,240 --> 00:05:43,199
could do

145
00:05:43,199 --> 00:05:47,039
is we could have a look at um

146
00:05:47,039 --> 00:05:49,280
i saw explaining xor differences which

147
00:05:49,280 --> 00:05:50,560
are these bit flips that i was

148
00:05:50,560 --> 00:05:51,680
mentioning in differential crypt

149
00:05:51,680 --> 00:05:52,800
analysis

150
00:05:52,800 --> 00:05:56,080
they go through the rotation and the xor

151
00:05:56,080 --> 00:05:57,919
with probability one

152
00:05:57,919 --> 00:05:58,880
but

153
00:05:58,880 --> 00:06:00,720
going through the addition is going to

154
00:06:00,720 --> 00:06:04,479
be with a certain probability that is

155
00:06:04,479 --> 00:06:05,680
not

156
00:06:05,680 --> 00:06:07,120
necessarily one

157
00:06:07,120 --> 00:06:10,319
and um here i'm going to show how such a

158
00:06:10,319 --> 00:06:13,199
probability can be computed um

159
00:06:13,199 --> 00:06:17,600
so it goes back to a paper of um

160
00:06:17,600 --> 00:06:20,000
litma and moriah in

161
00:06:20,000 --> 00:06:23,120
fsc 2001. however the approach that i'm

162
00:06:23,120 --> 00:06:24,639
going to give here is a slightly

163
00:06:24,639 --> 00:06:26,880
different one that was given by

164
00:06:26,880 --> 00:06:27,840
litmus

165
00:06:27,840 --> 00:06:31,759
and duma at fsc 2004

166
00:06:31,759 --> 00:06:33,759
to compute the same probability in a

167
00:06:33,759 --> 00:06:35,520
different way using

168
00:06:35,520 --> 00:06:39,120
a multiplication of a series of matrices

169
00:06:39,120 --> 00:06:41,039
now the way it works is we have to

170
00:06:41,039 --> 00:06:42,400
specify

171
00:06:42,400 --> 00:06:43,440
the

172
00:06:43,440 --> 00:06:45,840
differences at the two inputs so a

173
00:06:45,840 --> 00:06:47,440
difference of one will say the input

174
00:06:47,440 --> 00:06:48,800
bits are different the difference of

175
00:06:48,800 --> 00:06:50,400
zero that they are the same at this

176
00:06:50,400 --> 00:06:52,560
particular bit position

177
00:06:52,560 --> 00:06:54,319
and then um

178
00:06:54,319 --> 00:06:57,680
for every particular bit position so you

179
00:06:57,680 --> 00:06:59,919
in the notation here have the

180
00:06:59,919 --> 00:07:01,599
most significant bit to the left and the

181
00:07:01,599 --> 00:07:03,599
least significant bit to the right so

182
00:07:03,599 --> 00:07:04,720
for every

183
00:07:04,720 --> 00:07:08,080
particular i bit position you'll look at

184
00:07:08,080 --> 00:07:11,120
what the differences are

185
00:07:11,120 --> 00:07:13,280
in the left operand the right operand

186
00:07:13,280 --> 00:07:14,800
and the

187
00:07:14,800 --> 00:07:17,280
output of the

188
00:07:17,280 --> 00:07:19,039
addition operation modular addition

189
00:07:19,039 --> 00:07:21,520
operation in this particular location

190
00:07:21,520 --> 00:07:24,560
and then you're going to select one of

191
00:07:24,560 --> 00:07:26,800
eight possible matrices that you can

192
00:07:26,800 --> 00:07:27,680
have

193
00:07:27,680 --> 00:07:29,840
these matrices are multiplied together

194
00:07:29,840 --> 00:07:32,639
you have one matrix for every bit

195
00:07:32,639 --> 00:07:35,039
of the word so for word length 32 you'd

196
00:07:35,039 --> 00:07:38,319
have 32 of those multiplications to be

197
00:07:38,319 --> 00:07:39,280
done

198
00:07:39,280 --> 00:07:41,919
then you left multiply

199
00:07:41,919 --> 00:07:44,560
by a vector that contains

200
00:07:44,560 --> 00:07:47,440
in this case a row vector that contains

201
00:07:47,440 --> 00:07:49,199
all ones

202
00:07:49,199 --> 00:07:52,560
and you'll write multiply with a

203
00:07:52,560 --> 00:07:54,639
vector that contains in this case column

204
00:07:54,639 --> 00:07:57,199
vector that contains a one in the first

205
00:07:57,199 --> 00:07:59,039
position

206
00:07:59,039 --> 00:08:00,479
and the zero in all of the other

207
00:08:00,479 --> 00:08:02,319
positions now for this particular

208
00:08:02,319 --> 00:08:04,000
example that i'm showing here if you

209
00:08:04,000 --> 00:08:05,840
guys are going to do this this

210
00:08:05,840 --> 00:08:07,919
computation to check this is a

211
00:08:07,919 --> 00:08:10,160
particular

212
00:08:10,160 --> 00:08:12,720
input difference that will propagate

213
00:08:12,720 --> 00:08:15,599
with probability 1 4 assuming that the

214
00:08:15,599 --> 00:08:19,520
inputs are chosen randomly

215
00:08:20,800 --> 00:08:22,879
so here we're not looking at

216
00:08:22,879 --> 00:08:24,720
xor differences but we're looking at

217
00:08:24,720 --> 00:08:26,400
additive differences

218
00:08:26,400 --> 00:08:28,800
what it means is that if you're going to

219
00:08:28,800 --> 00:08:29,680
go

220
00:08:29,680 --> 00:08:33,198
with extra differences through

221
00:08:33,919 --> 00:08:37,039
xor or through

222
00:08:37,200 --> 00:08:39,519
rotation operation differences will

223
00:08:39,519 --> 00:08:42,000
propagate with probability one but not

224
00:08:42,000 --> 00:08:43,599
necessarily when you're looking at an

225
00:08:43,599 --> 00:08:45,760
addition operation here it's the other

226
00:08:45,760 --> 00:08:48,399
way around probability will be one for

227
00:08:48,399 --> 00:08:49,760
any differences going through the

228
00:08:49,760 --> 00:08:51,519
addition operation because we're looking

229
00:08:51,519 --> 00:08:54,240
at additive differences but the

230
00:08:54,240 --> 00:08:57,440
probability to go through

231
00:08:57,760 --> 00:08:59,920
x or operation or rotation is not

232
00:08:59,920 --> 00:09:01,680
necessarily one

233
00:09:01,680 --> 00:09:03,920
so this is something that can be

234
00:09:03,920 --> 00:09:07,839
handy to analyze certain ciphers where

235
00:09:07,839 --> 00:09:10,000
there are a lot of additions

236
00:09:10,000 --> 00:09:11,760
maybe chaining additions or additions

237
00:09:11,760 --> 00:09:14,399
involving the key that are being done to

238
00:09:14,399 --> 00:09:17,120
analyze how

239
00:09:18,800 --> 00:09:22,880
differences propagated in that case

240
00:09:22,880 --> 00:09:25,279
now this approach that can be done here

241
00:09:25,279 --> 00:09:26,240
is

242
00:09:26,240 --> 00:09:27,279
similar

243
00:09:27,279 --> 00:09:29,760
um however the matrices will look a bit

244
00:09:29,760 --> 00:09:31,839
differently previously we had matrices

245
00:09:31,839 --> 00:09:33,200
of size

246
00:09:33,200 --> 00:09:37,040
2 by 2 now they are size eight by eight

247
00:09:37,040 --> 00:09:39,680
and um again the computation of the

248
00:09:39,680 --> 00:09:42,000
probability is similar so what you would

249
00:09:42,000 --> 00:09:43,120
do is

250
00:09:43,120 --> 00:09:45,440
multiply a

251
00:09:45,440 --> 00:09:47,680
row vector of all ones

252
00:09:47,680 --> 00:09:49,839
l and then a column vector with a one in

253
00:09:49,839 --> 00:09:51,440
the first position zero in the other

254
00:09:51,440 --> 00:09:54,160
positions and then the other matrices

255
00:09:54,160 --> 00:09:56,480
that you have depend on the differences

256
00:09:56,480 --> 00:09:58,080
in the bit positions that we are

257
00:09:58,080 --> 00:09:59,519
considering

258
00:09:59,519 --> 00:10:01,440
now

259
00:10:01,440 --> 00:10:03,760
in this particular case of the additive

260
00:10:03,760 --> 00:10:07,120
differential probability of exclusive or

261
00:10:07,120 --> 00:10:08,720
there is a

262
00:10:08,720 --> 00:10:11,920
symmetry property of those matrices

263
00:10:11,920 --> 00:10:13,920
where you can

264
00:10:13,920 --> 00:10:15,440
determine

265
00:10:15,440 --> 00:10:18,399
every matrix from every other matrix by

266
00:10:18,399 --> 00:10:23,279
doing a permutation of rows and columns

267
00:10:23,600 --> 00:10:25,040
okay so

268
00:10:25,040 --> 00:10:27,680
without further ado let's look at this

269
00:10:27,680 --> 00:10:29,360
theorem 3 of

270
00:10:29,360 --> 00:10:32,800
the fse 2004 paper by lip malwalen and

271
00:10:32,800 --> 00:10:33,760
duma

272
00:10:33,760 --> 00:10:36,880
so what the theorem states is that

273
00:10:36,880 --> 00:10:40,320
for all gamma so gamma is the output

274
00:10:40,320 --> 00:10:41,440
difference

275
00:10:41,440 --> 00:10:44,079
if you want to look at the

276
00:10:44,079 --> 00:10:46,320
maximum probability so the value that

277
00:10:46,320 --> 00:10:48,800
maximizes

278
00:10:48,800 --> 00:10:51,440
the probability of going from

279
00:10:51,440 --> 00:10:54,000
input differences alpha and beta in the

280
00:10:54,000 --> 00:10:55,920
left and the right operands of the x

281
00:10:55,920 --> 00:10:57,200
operation

282
00:10:57,200 --> 00:10:59,600
to output difference gamma then the

283
00:10:59,600 --> 00:11:01,760
maximum probability that you can have

284
00:11:01,760 --> 00:11:04,640
maximizing overall alpha and beta is

285
00:11:04,640 --> 00:11:06,959
going to be the same probability that

286
00:11:06,959 --> 00:11:09,279
you have to go from

287
00:11:09,279 --> 00:11:10,640
left operand

288
00:11:10,640 --> 00:11:11,760
difference

289
00:11:11,760 --> 00:11:14,480
zero right operand difference gamma

290
00:11:14,480 --> 00:11:18,160
going to output difference gamma

291
00:11:18,959 --> 00:11:20,880
so what you will see if you're going to

292
00:11:20,880 --> 00:11:24,000
look up this fsc 2004 paper is that it

293
00:11:24,000 --> 00:11:27,040
says that the proof is omitted from the

294
00:11:27,040 --> 00:11:28,880
conference version

295
00:11:28,880 --> 00:11:31,839
however it turns out

296
00:11:31,839 --> 00:11:35,200
i've spoken about this to helga litma

297
00:11:35,200 --> 00:11:38,560
that the proof has been lost so this is

298
00:11:38,560 --> 00:11:42,160
uh proof that we can seem to

299
00:11:42,160 --> 00:11:44,079
recover and that also we tried to come

300
00:11:44,079 --> 00:11:45,760
up with

301
00:11:45,760 --> 00:11:47,680
with other techniques when i was looking

302
00:11:47,680 --> 00:11:49,920
into this more than 10 years ago in the

303
00:11:49,920 --> 00:11:53,360
beginning of my phd thesis

304
00:11:53,360 --> 00:11:55,680
together with um christoph de ganier and

305
00:11:55,680 --> 00:11:57,920
vessel villagekov

306
00:11:57,920 --> 00:12:00,079
i don't want to say we spent too much

307
00:12:00,079 --> 00:12:02,079
time on this but still

308
00:12:02,079 --> 00:12:04,000
it doesn't seem to be something that we

309
00:12:04,000 --> 00:12:06,320
could do with any of the existing

310
00:12:06,320 --> 00:12:09,040
techniques that

311
00:12:09,040 --> 00:12:12,160
we know in in literature that we were

312
00:12:12,160 --> 00:12:14,079
rediscovering

313
00:12:14,079 --> 00:12:16,079
so let me maybe discuss a few strategies

314
00:12:16,079 --> 00:12:18,160
and see how you might want to approach

315
00:12:18,160 --> 00:12:20,720
this type of problem

316
00:12:20,720 --> 00:12:23,040
of course if the word size is small you

317
00:12:23,040 --> 00:12:25,760
can do an exhaustive search and i guess

318
00:12:25,760 --> 00:12:27,040
maybe for some people that might be

319
00:12:27,040 --> 00:12:28,480
enough that you would just say let's

320
00:12:28,480 --> 00:12:30,720
look at all small word sizes do an

321
00:12:30,720 --> 00:12:32,399
exhaustive search there

322
00:12:32,399 --> 00:12:34,800
and um if

323
00:12:34,800 --> 00:12:37,200
it works for small word sizes it's also

324
00:12:37,200 --> 00:12:39,760
going to work for large work sizes

325
00:12:39,760 --> 00:12:41,839
however i want to be careful saying that

326
00:12:41,839 --> 00:12:42,880
because

327
00:12:42,880 --> 00:12:45,279
it does happen in mathematics that there

328
00:12:45,279 --> 00:12:47,680
are conjectures that have very large

329
00:12:47,680 --> 00:12:49,200
counter examples

330
00:12:49,200 --> 00:12:51,360
so we cannot necessarily say because it

331
00:12:51,360 --> 00:12:53,120
works for small word size it works for

332
00:12:53,120 --> 00:12:56,000
any word size

333
00:12:56,079 --> 00:12:58,800
another would be to have a look at this

334
00:12:58,800 --> 00:13:01,519
s-function toolkit that thessaloni and

335
00:13:01,519 --> 00:13:04,480
christoph and i worked on

336
00:13:04,480 --> 00:13:09,279
this toolkit um does provide

337
00:13:09,360 --> 00:13:10,880
a way of

338
00:13:10,880 --> 00:13:12,800
sorting output differences by

339
00:13:12,800 --> 00:13:14,079
probability

340
00:13:14,079 --> 00:13:16,560
so if you can construct these matrices

341
00:13:16,560 --> 00:13:18,160
and the matrices can be bigger for

342
00:13:18,160 --> 00:13:20,560
different types of larger components if

343
00:13:20,560 --> 00:13:22,079
somehow you get these

344
00:13:22,079 --> 00:13:24,320
matrices you saw on the previous slide

345
00:13:24,320 --> 00:13:26,560
then this s function toolkit what it can

346
00:13:26,560 --> 00:13:29,200
do is it can

347
00:13:29,200 --> 00:13:29,740
give you

348
00:13:29,740 --> 00:13:30,800
[Music]

349
00:13:30,800 --> 00:13:33,519
four specific given input differences a

350
00:13:33,519 --> 00:13:36,240
list of output differences ranked by

351
00:13:36,240 --> 00:13:37,600
probability

352
00:13:37,600 --> 00:13:40,399
however this is not something that gives

353
00:13:40,399 --> 00:13:42,880
you an insight

354
00:13:42,880 --> 00:13:45,760
into theorem three

355
00:13:45,760 --> 00:13:47,360
because it it doesn't seem that the

356
00:13:47,360 --> 00:13:49,360
mechanics of the way that this a start

357
00:13:49,360 --> 00:13:51,279
search is done

358
00:13:51,279 --> 00:13:53,920
gives you something that um shows that

359
00:13:53,920 --> 00:13:57,040
this this theorem is is obvious um

360
00:13:57,040 --> 00:13:58,880
so that that seemed to be a way that

361
00:13:58,880 --> 00:14:01,440
that we were getting stuck

362
00:14:01,440 --> 00:14:04,880
another thing is you might say well um

363
00:14:04,880 --> 00:14:06,959
what about using some some automated

364
00:14:06,959 --> 00:14:08,079
techniques

365
00:14:08,079 --> 00:14:10,880
perhaps we can use that to

366
00:14:10,880 --> 00:14:13,760
search for for for certain types of uh

367
00:14:13,760 --> 00:14:15,600
differential trails

368
00:14:15,600 --> 00:14:17,920
these milp or maybe people are saying

369
00:14:17,920 --> 00:14:19,040
milk now

370
00:14:19,040 --> 00:14:22,800
sat or other types of automated

371
00:14:22,800 --> 00:14:24,560
solvers that you can use

372
00:14:24,560 --> 00:14:27,279
however in that case it's definitely

373
00:14:27,279 --> 00:14:29,519
clear that you cannot prove properties

374
00:14:29,519 --> 00:14:32,240
for any word size you fixed word sizes

375
00:14:32,240 --> 00:14:33,839
and for those you're going to

376
00:14:33,839 --> 00:14:36,560
obtain a result

377
00:14:36,560 --> 00:14:39,120
let me first start by an observation so

378
00:14:39,120 --> 00:14:40,720
a first observation is if you want to

379
00:14:40,720 --> 00:14:43,920
compute adb x or zero gamma gamma then

380
00:14:43,920 --> 00:14:46,399
only two matrices are needed because the

381
00:14:46,399 --> 00:14:49,199
matrices as i explained they depend on

382
00:14:49,199 --> 00:14:51,360
the bits that you have in a particular

383
00:14:51,360 --> 00:14:53,680
bit position in this case the difference

384
00:14:53,680 --> 00:14:55,440
that we have for any position let's say

385
00:14:55,440 --> 00:14:56,639
position

386
00:14:56,639 --> 00:14:57,360
i

387
00:14:57,360 --> 00:15:01,440
is going to be either 0 0 0 or 0 1 1 in

388
00:15:01,440 --> 00:15:03,600
this particular case so with two

389
00:15:03,600 --> 00:15:08,000
matrices we have enough to compute this

390
00:15:08,000 --> 00:15:13,040
probability of adp 0 gamma gamma

391
00:15:13,040 --> 00:15:15,839
now a second observation is that there

392
00:15:15,839 --> 00:15:17,920
is actually a property that we can use

393
00:15:17,920 --> 00:15:20,320
as a result of this permutation symmetry

394
00:15:20,320 --> 00:15:23,199
of the adb xor matrices that will turn

395
00:15:23,199 --> 00:15:25,600
out to be really important to compute

396
00:15:25,600 --> 00:15:27,760
the

397
00:15:27,760 --> 00:15:30,560
analysis of different cases in the proof

398
00:15:30,560 --> 00:15:32,720
that we have in the paper

399
00:15:32,720 --> 00:15:34,560
i've been told that

400
00:15:34,560 --> 00:15:36,800
for every good paper on a mathematical

401
00:15:36,800 --> 00:15:38,720
subject there should at least be one

402
00:15:38,720 --> 00:15:40,959
proof and slides so i'm going to give

403
00:15:40,959 --> 00:15:43,040
you here a proof in uh in this

404
00:15:43,040 --> 00:15:45,759
particular slide where you can see

405
00:15:45,759 --> 00:15:48,560
by using these uh permutation matrices

406
00:15:48,560 --> 00:15:51,759
tk that will swap english's i and i x or

407
00:15:51,759 --> 00:15:54,639
k these matrices are involution so tk

408
00:15:54,639 --> 00:15:58,560
times tk is the identity matrix

409
00:15:58,560 --> 00:15:59,920
you can

410
00:15:59,920 --> 00:16:02,639
compute a way of going from the formula

411
00:16:02,639 --> 00:16:04,240
on the left side to the formula on the

412
00:16:04,240 --> 00:16:05,839
right side which as i explained will be

413
00:16:05,839 --> 00:16:08,399
really useful to analyze the cases that

414
00:16:08,399 --> 00:16:10,639
will pop up and prove

415
00:16:10,639 --> 00:16:14,000
and then here i can sketch the proof

416
00:16:14,000 --> 00:16:16,079
so it's going to be approved by

417
00:16:16,079 --> 00:16:18,399
induction on n

418
00:16:18,399 --> 00:16:19,120
so

419
00:16:19,120 --> 00:16:22,800
to prove this that the maximum over any

420
00:16:22,800 --> 00:16:25,199
alpha and beta of alpha beta gamma is

421
00:16:25,199 --> 00:16:27,279
going to be the same as

422
00:16:27,279 --> 00:16:30,160
going from zero gamma to gamma

423
00:16:30,160 --> 00:16:32,880
you can rephrase that as saying that

424
00:16:32,880 --> 00:16:34,240
whatever

425
00:16:34,240 --> 00:16:36,480
probability you compute from going from

426
00:16:36,480 --> 00:16:38,320
alpha beta to gamma

427
00:16:38,320 --> 00:16:41,839
will never be more than the probability

428
00:16:41,839 --> 00:16:45,360
of going from zero gamma to gamma

429
00:16:45,360 --> 00:16:47,040
and that is something that in the proof

430
00:16:47,040 --> 00:16:52,240
of improved by induction we will assume

431
00:16:52,240 --> 00:16:54,720
for a certain value of n

432
00:16:54,720 --> 00:16:56,560
and then given that

433
00:16:56,560 --> 00:16:58,959
we're going to prove that the property

434
00:16:58,959 --> 00:17:02,959
also holds when you move from n to n

435
00:17:02,959 --> 00:17:06,640
plus 1. so the idea is to take the

436
00:17:06,640 --> 00:17:10,000
one bit larger cases and reduce them to

437
00:17:10,000 --> 00:17:12,319
the previous case

438
00:17:12,319 --> 00:17:14,559
so if you combine that with the

439
00:17:14,559 --> 00:17:16,880
base case of the induction which would

440
00:17:16,880 --> 00:17:19,599
be n equal to 1 where you can just

441
00:17:19,599 --> 00:17:21,119
straightforwardly check that the

442
00:17:21,119 --> 00:17:23,439
computation is correct then this allows

443
00:17:23,439 --> 00:17:25,679
you to prove the statement for any value

444
00:17:25,679 --> 00:17:28,079
of n

445
00:17:28,400 --> 00:17:30,960
now we don't only want to look at

446
00:17:30,960 --> 00:17:34,240
the proof itself but we also want to see

447
00:17:34,240 --> 00:17:36,160
what are those differences that are

448
00:17:36,160 --> 00:17:39,440
going to maximize the probability

449
00:17:39,440 --> 00:17:42,240
now to find those we need to recall some

450
00:17:42,240 --> 00:17:43,840
symmetries these are some symmetries

451
00:17:43,840 --> 00:17:44,960
that are quite

452
00:17:44,960 --> 00:17:47,840
well known in literature

453
00:17:49,280 --> 00:17:52,160
still makes sense to recall them here so

454
00:17:52,160 --> 00:17:54,640
one is related to

455
00:17:54,640 --> 00:17:57,679
adding an xoring

456
00:17:57,679 --> 00:17:59,760
value that has a bit in the highest

457
00:17:59,760 --> 00:18:00,799
position

458
00:18:00,799 --> 00:18:03,440
another is related to rearranging the

459
00:18:03,440 --> 00:18:05,120
differences

460
00:18:05,120 --> 00:18:07,440
and the third one is related to negating

461
00:18:07,440 --> 00:18:09,440
the differences so going from alpha to

462
00:18:09,440 --> 00:18:12,320
minus alpha

463
00:18:12,880 --> 00:18:15,520
if in that case we want to look at the

464
00:18:15,520 --> 00:18:17,200
number of maximums so the distinct

465
00:18:17,200 --> 00:18:18,640
number of pairs

466
00:18:18,640 --> 00:18:20,799
alpha beta

467
00:18:20,799 --> 00:18:23,520
so that adb x or alpha beta gamma

468
00:18:23,520 --> 00:18:25,520
is going to be that particular value

469
00:18:25,520 --> 00:18:27,679
that attains the maximum

470
00:18:27,679 --> 00:18:30,880
then we find that if gamma is equal to

471
00:18:30,880 --> 00:18:34,320
either 0 or 2 to the power n minus 1

472
00:18:34,320 --> 00:18:39,439
then we have exactly two distinct pairs

473
00:18:39,600 --> 00:18:40,880
if not

474
00:18:40,880 --> 00:18:43,280
then there will be exactly eight

475
00:18:43,280 --> 00:18:44,799
distinct pairs

476
00:18:44,799 --> 00:18:46,960
now you can see that all of those pairs

477
00:18:46,960 --> 00:18:49,520
are actually pairs that follow from the

478
00:18:49,520 --> 00:18:52,160
symmetries that i showed on the previous

479
00:18:52,160 --> 00:18:53,919
slide

480
00:18:53,919 --> 00:18:55,679
you can actually also see that they are

481
00:18:55,679 --> 00:18:58,480
distinct in the case that 0 and 2 to the

482
00:18:58,480 --> 00:19:00,880
power -1 are not the values of gamma but

483
00:19:00,880 --> 00:19:03,280
if gamma has those particular values

484
00:19:03,280 --> 00:19:05,440
then some of these pairs collapse to

485
00:19:05,440 --> 00:19:07,440
simpler pairs that's why you have not 8

486
00:19:07,440 --> 00:19:09,280
but 2 in that case

487
00:19:09,280 --> 00:19:12,000
now how do we compute the maximum

488
00:19:12,000 --> 00:19:14,400
probability well

489
00:19:14,400 --> 00:19:16,080
that's not so difficult because we

490
00:19:16,080 --> 00:19:17,840
already had this approach of computing

491
00:19:17,840 --> 00:19:19,840
the probability of any differences so

492
00:19:19,840 --> 00:19:22,240
that you can also use that to compute

493
00:19:22,240 --> 00:19:24,640
maximum difference but we want to see if

494
00:19:24,640 --> 00:19:27,039
there might perhaps be a more efficient

495
00:19:27,039 --> 00:19:29,280
way of doing this

496
00:19:29,280 --> 00:19:31,440
and there is so we'll first show how

497
00:19:31,440 --> 00:19:34,480
using the s function toolkit can do a

498
00:19:34,480 --> 00:19:36,960
more efficient calculation and then

499
00:19:36,960 --> 00:19:38,799
we're going to look into

500
00:19:38,799 --> 00:19:42,080
some recurrence formulas

501
00:19:42,080 --> 00:19:44,160
so the s function approach does

502
00:19:44,160 --> 00:19:46,000
is it says after you've obtained those

503
00:19:46,000 --> 00:19:47,200
matrices

504
00:19:47,200 --> 00:19:51,360
you can remove states that are non

505
00:19:51,360 --> 00:19:52,400
accessible

506
00:19:52,400 --> 00:19:53,679
and merge states that are

507
00:19:53,679 --> 00:19:56,080
indistinguishable now if you're working

508
00:19:56,080 --> 00:19:57,039
with

509
00:19:57,039 --> 00:19:59,039
the eight different matrices that's

510
00:19:59,039 --> 00:20:00,960
something that doesn't

511
00:20:00,960 --> 00:20:02,320
give you a better result you'll still

512
00:20:02,320 --> 00:20:04,480
get those eight by eight matrices but

513
00:20:04,480 --> 00:20:07,200
here we're only considering a0 and a3

514
00:20:07,200 --> 00:20:09,520
only two of the eight matrices so there

515
00:20:09,520 --> 00:20:11,840
will be some states that we can remove

516
00:20:11,840 --> 00:20:14,080
in this procedure and this gives us

517
00:20:14,080 --> 00:20:16,720
matrices of size already three by three

518
00:20:16,720 --> 00:20:20,760
instead of eight by eight

519
00:20:20,880 --> 00:20:23,280
we can actually do a modification of

520
00:20:23,280 --> 00:20:26,080
this approach to cheat

521
00:20:26,080 --> 00:20:29,120
and exclude the most significant bit of

522
00:20:29,120 --> 00:20:30,640
the difference gamma

523
00:20:30,640 --> 00:20:33,200
so if we're going to say

524
00:20:33,200 --> 00:20:34,880
let's multiply

525
00:20:34,880 --> 00:20:38,960
not n matrices but n minus one matrices

526
00:20:38,960 --> 00:20:40,799
plus one additional one on the left a

527
00:20:40,799 --> 00:20:42,480
national one on the right

528
00:20:42,480 --> 00:20:43,919
then um

529
00:20:43,919 --> 00:20:47,440
we can use matrices of size two by 2

530
00:20:47,440 --> 00:20:49,520
instead of matrices of size

531
00:20:49,520 --> 00:20:52,880
3 by 3 as in the previous slide

532
00:20:52,880 --> 00:20:54,240
this is something that gives an

533
00:20:54,240 --> 00:20:56,159
additional insight because if you look

534
00:20:56,159 --> 00:20:57,840
at the structure of these matrices they

535
00:20:57,840 --> 00:20:59,120
allow you to

536
00:20:59,120 --> 00:21:03,280
describe the probability of

537
00:21:03,280 --> 00:21:05,120
adp xor when you're looking at this

538
00:21:05,120 --> 00:21:07,600
maximum case so having zero gamma

539
00:21:07,600 --> 00:21:08,960
leading to gamma

540
00:21:08,960 --> 00:21:12,320
then you can describe those in terms of

541
00:21:12,320 --> 00:21:14,400
recurrence formula so the recurrence

542
00:21:14,400 --> 00:21:15,679
formula will

543
00:21:15,679 --> 00:21:17,520
tell you depending on whether there will

544
00:21:17,520 --> 00:21:22,240
be a zero or a one in the

545
00:21:22,240 --> 00:21:24,000
first bit position so the least

546
00:21:24,000 --> 00:21:26,159
significant bit position

547
00:21:26,159 --> 00:21:27,600
there are two different formulas that

548
00:21:27,600 --> 00:21:31,520
you can use to compute this probability

549
00:21:31,520 --> 00:21:33,600
so as i said the complexity is the same

550
00:21:33,600 --> 00:21:36,159
as the previous method but it can be

551
00:21:36,159 --> 00:21:37,679
useful to compute some theoretical

552
00:21:37,679 --> 00:21:39,440
properties

553
00:21:39,440 --> 00:21:41,039
i want to show a few other results as

554
00:21:41,039 --> 00:21:42,320
well

555
00:21:42,320 --> 00:21:44,720
you might be interested in the

556
00:21:44,720 --> 00:21:48,480
minimum non-zero adp xor

557
00:21:48,480 --> 00:21:51,840
zero gamma going to gamma

558
00:21:51,840 --> 00:21:53,919
one of the reviewers said that this was

559
00:21:53,919 --> 00:21:54,880
a

560
00:21:54,880 --> 00:21:57,440
really interesting mathematical result

561
00:21:57,440 --> 00:21:59,919
so i definitely wanted to show this

562
00:21:59,919 --> 00:22:02,000
formula one of the slides

563
00:22:02,000 --> 00:22:04,080
another thing is that duplicate values

564
00:22:04,080 --> 00:22:06,960
of adp xor zero gamma gamma are very

565
00:22:06,960 --> 00:22:07,919
rare

566
00:22:07,919 --> 00:22:11,039
there are at most 30 times

567
00:22:11,039 --> 00:22:13,200
duplicates up to n

568
00:22:13,200 --> 00:22:15,919
equal to 32 following from computational

569
00:22:15,919 --> 00:22:17,600
experiments that we've done

570
00:22:17,600 --> 00:22:19,520
it seems that duplicates grow linearly

571
00:22:19,520 --> 00:22:21,440
with n so they're approximately 2 to the

572
00:22:21,440 --> 00:22:24,080
power n over n distinct values for adp 0

573
00:22:24,080 --> 00:22:25,360
gamma gamma

574
00:22:25,360 --> 00:22:27,440
and if we're looking at the

575
00:22:27,440 --> 00:22:30,880
minimum non-zero adp xor for alpha beta

576
00:22:30,880 --> 00:22:34,080
going to gamma that would be eight times

577
00:22:34,080 --> 00:22:36,240
four to the power minus n for any n

578
00:22:36,240 --> 00:22:39,440
greater or equal to two

579
00:22:39,440 --> 00:22:41,039
so here i'd like to conclude my

580
00:22:41,039 --> 00:22:42,559
presentation

581
00:22:42,559 --> 00:22:45,360
we give the missing proof for theorem

582
00:22:45,360 --> 00:22:49,200
three of the fsc 2004 paper of litmus

583
00:22:49,200 --> 00:22:51,440
wallen and duma this proof that was

584
00:22:51,440 --> 00:22:53,840
related to finding the maximum over

585
00:22:53,840 --> 00:22:56,480
alpha and beta for adbx or alpha beta

586
00:22:56,480 --> 00:22:59,360
going to gamma this is equal to

587
00:22:59,360 --> 00:23:02,799
adp 0 gamma gamma

588
00:23:02,799 --> 00:23:04,640
we show that there are either two or

589
00:23:04,640 --> 00:23:07,919
eight distinct pairs for which adb xor

590
00:23:07,919 --> 00:23:10,159
zero gamma gamma attains this maximum

591
00:23:10,159 --> 00:23:11,120
value

592
00:23:11,120 --> 00:23:14,480
if we want to compute the maximum you

593
00:23:14,480 --> 00:23:16,400
can do that with matrix of size eight by

594
00:23:16,400 --> 00:23:17,840
eight but actually they can be reduced

595
00:23:17,840 --> 00:23:19,760
to size three by three and even two by

596
00:23:19,760 --> 00:23:22,480
two leading to recurrence formulas that

597
00:23:22,480 --> 00:23:24,720
can be used to compute an arbitrary adb

598
00:23:24,720 --> 00:23:27,919
xor alpha beta going to gamma

599
00:23:27,919 --> 00:23:29,440
we compute the

600
00:23:29,440 --> 00:23:32,000
minimum non-zero probabilities for the

601
00:23:32,000 --> 00:23:34,880
minimum of adp x or zero gamma gamma and

602
00:23:34,880 --> 00:23:37,520
we find also the value of gamma that is

603
00:23:37,520 --> 00:23:39,200
going to give you the minimum

604
00:23:39,200 --> 00:23:40,640
probability

605
00:23:40,640 --> 00:23:43,360
now here i'd like to conclude my talk if

606
00:23:43,360 --> 00:23:45,200
there are any questions i'd be happy to

607
00:23:45,200 --> 00:23:47,279
answer them by email or

608
00:23:47,279 --> 00:23:50,760
during the conference

609
00:23:51,200 --> 00:23:52,640
i hope you enjoyed my talk and i'm

610
00:23:52,640 --> 00:23:54,000
looking forward to meeting you at the

611
00:23:54,000 --> 00:23:57,000
conference

