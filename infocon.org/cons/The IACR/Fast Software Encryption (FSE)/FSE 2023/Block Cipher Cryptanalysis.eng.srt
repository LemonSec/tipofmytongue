1
00:00:00,000 --> 00:00:02,399
historical analysis this session

2
00:00:02,399 --> 00:00:04,860
includes three talks and the first talk

3
00:00:04,860 --> 00:00:07,319
is trunciate differential attacks on

4
00:00:07,319 --> 00:00:09,780
Contracting five-star ciphers the

5
00:00:09,780 --> 00:00:13,259
speakers are Tim bin and Newman Liu and

6
00:00:13,259 --> 00:00:16,920
I think we'll give the talk please start

7
00:00:16,920 --> 00:00:19,140
okay thank you

8
00:00:19,140 --> 00:00:21,359
um so as just introduced this talk is

9
00:00:21,359 --> 00:00:23,460
about truncated differential attacks and

10
00:00:23,460 --> 00:00:25,560
the attacks are going to be generic so

11
00:00:25,560 --> 00:00:27,119
we're not really going to use the

12
00:00:27,119 --> 00:00:29,720
details of the round function so

13
00:00:29,720 --> 00:00:33,239
a Contracting fiso Cipher is well it's

14
00:00:33,239 --> 00:00:35,340
basically a physio Cipher with more than

15
00:00:35,340 --> 00:00:38,040
two branches where you add up the

16
00:00:38,040 --> 00:00:40,440
rightmost D minus one branches in this

17
00:00:40,440 --> 00:00:42,239
figure and then put that through the

18
00:00:42,239 --> 00:00:44,160
round function and add the results to

19
00:00:44,160 --> 00:00:47,879
the leftmost branch and so there's been

20
00:00:47,879 --> 00:00:50,100
some uh generic attacks on this

21
00:00:50,100 --> 00:00:51,440
structure already

22
00:00:51,440 --> 00:00:54,899
and the main one is this meat in the

23
00:00:54,899 --> 00:00:59,340
middle attack from FSC 2016.

24
00:00:59,340 --> 00:01:01,260
um and there's there's a good reason to

25
00:01:01,260 --> 00:01:03,799
look at at these ciphers I think because

26
00:01:03,799 --> 00:01:07,140
there are at least a few uh interesting

27
00:01:07,140 --> 00:01:09,060
constructions that that are based on

28
00:01:09,060 --> 00:01:12,119
this so the first of these is sm4 which

29
00:01:12,119 --> 00:01:14,340
is uh of course the Chinese National

30
00:01:14,340 --> 00:01:16,680
Commercial encryption standard

31
00:01:16,680 --> 00:01:20,040
uh and then there's also GMC CRF which

32
00:01:20,040 --> 00:01:23,159
is a arithmetization oriented primitive

33
00:01:23,159 --> 00:01:25,259
so

34
00:01:25,259 --> 00:01:25,920
um

35
00:01:25,920 --> 00:01:27,900
the reason for looking at truncated

36
00:01:27,900 --> 00:01:30,060
differential attacks in this case is

37
00:01:30,060 --> 00:01:32,400
because in the expanding case which is

38
00:01:32,400 --> 00:01:34,320
very similar except that instead of

39
00:01:34,320 --> 00:01:37,439
adding up the T minus one branches you

40
00:01:37,439 --> 00:01:39,600
take one branch put it to the round

41
00:01:39,600 --> 00:01:41,159
function and then add this to all the

42
00:01:41,159 --> 00:01:43,200
other branches so in that case there's

43
00:01:43,200 --> 00:01:44,880
already a

44
00:01:44,880 --> 00:01:46,920
good truncated differential that was

45
00:01:46,920 --> 00:01:49,460
found by Guyton

46
00:01:49,460 --> 00:01:52,100
and so it's an iterative

47
00:01:52,100 --> 00:01:54,840
truncated differential on T rounds and

48
00:01:54,840 --> 00:01:56,460
the way it works is so you you start

49
00:01:56,460 --> 00:01:59,280
with a difference of a and minus a on

50
00:01:59,280 --> 00:02:01,439
the first two branches and then

51
00:02:01,439 --> 00:02:02,939
because you have a zero input difference

52
00:02:02,939 --> 00:02:06,360
in the first two rounds or the first D

53
00:02:06,360 --> 00:02:09,360
minus two rounds in general you just go

54
00:02:09,360 --> 00:02:11,160
through that with probability one

55
00:02:11,160 --> 00:02:13,620
and then uh in the here in the third

56
00:02:13,620 --> 00:02:16,080
round you'll get a difference B an

57
00:02:16,080 --> 00:02:17,760
arbitrary difference B dot this is still

58
00:02:17,760 --> 00:02:19,020
probability one

59
00:02:19,020 --> 00:02:21,620
and then in the last round

60
00:02:21,620 --> 00:02:24,900
we assume that the output difference is

61
00:02:24,900 --> 00:02:27,180
mine of the function is minus B so you

62
00:02:27,180 --> 00:02:29,099
cancel not just one B but you cancel

63
00:02:29,099 --> 00:02:31,739
both B's so you only have a probability

64
00:02:31,739 --> 00:02:34,020
of your probability of one over n but

65
00:02:34,020 --> 00:02:36,900
you have two zero output branches and so

66
00:02:36,900 --> 00:02:39,000
it's a natural question to ask if there

67
00:02:39,000 --> 00:02:40,860
is a similar attack on the Contracting

68
00:02:40,860 --> 00:02:41,819
case

69
00:02:41,819 --> 00:02:44,640
and um that's what what we are going to

70
00:02:44,640 --> 00:02:46,800
do in this talk basically

71
00:02:46,800 --> 00:02:48,720
um and we're going to focus especially

72
00:02:48,720 --> 00:02:51,120
on uh the case where you have a large

73
00:02:51,120 --> 00:02:53,879
number of fronts so you try to really

74
00:02:53,879 --> 00:02:56,400
maximize the number of rounds

75
00:02:56,400 --> 00:02:58,440
um and I also want to already mention

76
00:02:58,440 --> 00:03:00,840
from the start that it's also important

77
00:03:00,840 --> 00:03:04,920
to have small improvements because those

78
00:03:04,920 --> 00:03:06,780
really matter for small values of T and

79
00:03:06,780 --> 00:03:09,480
for example for T equals this equals

80
00:03:09,480 --> 00:03:11,819
four so that's the case of sm4 that's

81
00:03:11,819 --> 00:03:13,560
what you need

82
00:03:13,560 --> 00:03:16,319
so the way I'm going to structure this

83
00:03:16,319 --> 00:03:18,900
stock is first I will introduce a basic

84
00:03:18,900 --> 00:03:20,640
truncated differential that's

85
00:03:20,640 --> 00:03:24,300
essentially the Contracting variant of

86
00:03:24,300 --> 00:03:26,099
what I've just shown for the expanding

87
00:03:26,099 --> 00:03:27,060
case

88
00:03:27,060 --> 00:03:28,860
and then I will show how to actually

89
00:03:28,860 --> 00:03:31,860
improve that and then how this can be

90
00:03:31,860 --> 00:03:35,280
applied to uh to those two ciphers GMC

91
00:03:35,280 --> 00:03:39,360
CRF and sm4 that I mentioned before

92
00:03:39,360 --> 00:03:41,400
um so

93
00:03:41,400 --> 00:03:44,879
um the truncated differential that I'm

94
00:03:44,879 --> 00:03:47,459
going to use looks like this so in a way

95
00:03:47,459 --> 00:03:49,319
similar to the expanding case it's again

96
00:03:49,319 --> 00:03:51,540
iterative over T rounds with the

97
00:03:51,540 --> 00:03:54,840
probability also of 1 over n

98
00:03:54,840 --> 00:03:55,440
um

99
00:03:55,440 --> 00:03:57,720
so the way it works is

100
00:03:57,720 --> 00:04:00,180
um in the first round we allow and I

101
00:04:00,180 --> 00:04:02,220
mean basically an arbit arbitrary output

102
00:04:02,220 --> 00:04:04,500
difference b

103
00:04:04,500 --> 00:04:06,480
um and then

104
00:04:06,480 --> 00:04:08,940
um in the second round you're going to

105
00:04:08,940 --> 00:04:11,280
assume that the output difference is

106
00:04:11,280 --> 00:04:15,239
minus B so this happens with probability

107
00:04:15,239 --> 00:04:16,798
one over n

108
00:04:16,798 --> 00:04:19,260
and after that you have basically the

109
00:04:19,260 --> 00:04:20,940
first D minus one branches that are

110
00:04:20,940 --> 00:04:22,620
always going to sum to zero and then you

111
00:04:22,620 --> 00:04:24,960
can continue for T minus two rounds

112
00:04:24,960 --> 00:04:27,600
a bit probability one

113
00:04:27,600 --> 00:04:29,400
so

114
00:04:29,400 --> 00:04:31,259
um because the ideal probability so the

115
00:04:31,259 --> 00:04:33,060
probability that this generator

116
00:04:33,060 --> 00:04:34,500
differential holds for a random

117
00:04:34,500 --> 00:04:38,580
permutation is in general one over n to

118
00:04:38,580 --> 00:04:40,740
the T minus one because you have T minus

119
00:04:40,740 --> 00:04:42,180
two zero branches and then two equal

120
00:04:42,180 --> 00:04:44,759
branches so because of that you can

121
00:04:44,759 --> 00:04:47,880
iterate this at most uh T minus two

122
00:04:47,880 --> 00:04:50,040
times basically because then your Trail

123
00:04:50,040 --> 00:04:52,740
probability would become lower than your

124
00:04:52,740 --> 00:04:54,300
ideal probability

125
00:04:54,300 --> 00:04:57,120
and you can also prevent OSD minus two

126
00:04:57,120 --> 00:04:59,639
rounds because that's just the same as

127
00:04:59,639 --> 00:05:01,860
the last two rounds in this figure

128
00:05:01,860 --> 00:05:04,800
so then you get t squared minus D minus

129
00:05:04,800 --> 00:05:07,380
two rounds attack

130
00:05:07,380 --> 00:05:09,600
and the data complexity of that would be

131
00:05:09,600 --> 00:05:12,479
n to the T minus 2 but you have this

132
00:05:12,479 --> 00:05:14,220
arbitrary input difference a so that's

133
00:05:14,220 --> 00:05:15,960
an input structure of size and from

134
00:05:15,960 --> 00:05:18,900
which you can extract N squared pairs or

135
00:05:18,900 --> 00:05:21,720
N squared over 2 and that gives you a

136
00:05:21,720 --> 00:05:23,460
data complexity roughly n to the power

137
00:05:23,460 --> 00:05:25,740
of T minus 3.

138
00:05:25,740 --> 00:05:27,979
um now the natural question is if we can

139
00:05:27,979 --> 00:05:31,800
still do better so for example you might

140
00:05:31,800 --> 00:05:34,020
want to iterate this T minus one times

141
00:05:34,020 --> 00:05:37,020
but this would lead to a trail

142
00:05:37,020 --> 00:05:38,759
probability which is smaller than the

143
00:05:38,759 --> 00:05:40,280
ideal probability

144
00:05:40,280 --> 00:05:42,840
so because of that

145
00:05:42,840 --> 00:05:45,479
your data complexity will be affected

146
00:05:45,479 --> 00:05:47,400
but you can still do this at least if

147
00:05:47,400 --> 00:05:49,500
you heuristically assume that whenever a

148
00:05:49,500 --> 00:05:52,139
pair doesn't follow the trail it still

149
00:05:52,139 --> 00:05:54,600
has a probability of the ideal so just

150
00:05:54,600 --> 00:05:57,539
the same as four basically random pair

151
00:05:57,539 --> 00:06:00,300
to satisfy the truncated differential

152
00:06:00,300 --> 00:06:01,440
property

153
00:06:01,440 --> 00:06:03,080
so in this case

154
00:06:03,080 --> 00:06:05,400
if you want to have a distinguisher you

155
00:06:05,400 --> 00:06:06,840
will need to choose enough pair so

156
00:06:06,840 --> 00:06:09,419
that's the average number of pairs that

157
00:06:09,419 --> 00:06:11,940
you expect for the real case minus the

158
00:06:11,940 --> 00:06:13,680
number of pairs that you expect in a

159
00:06:13,680 --> 00:06:15,960
random case is much bigger than the

160
00:06:15,960 --> 00:06:17,940
standard deviation of the number of

161
00:06:17,940 --> 00:06:19,620
observed Pairs and that standard

162
00:06:19,620 --> 00:06:22,259
deviation is about the same in the in

163
00:06:22,259 --> 00:06:25,020
the real and the ideal cases and so if

164
00:06:25,020 --> 00:06:26,699
you work that out you get a data

165
00:06:26,699 --> 00:06:29,880
complexity of the probability of the the

166
00:06:29,880 --> 00:06:31,199
ideal probability of the circular

167
00:06:31,199 --> 00:06:32,880
differential divided by the square of

168
00:06:32,880 --> 00:06:34,560
the trail probability

169
00:06:34,560 --> 00:06:35,940
and so

170
00:06:35,940 --> 00:06:36,479
um

171
00:06:36,479 --> 00:06:38,819
with this you could iterate T minus one

172
00:06:38,819 --> 00:06:40,500
times

173
00:06:40,500 --> 00:06:41,160
um

174
00:06:41,160 --> 00:06:43,020
and you can even append one more round

175
00:06:43,020 --> 00:06:46,020
which is uh going to increase your ideal

176
00:06:46,020 --> 00:06:48,120
probability by a factor of n

177
00:06:48,120 --> 00:06:50,400
so we can still prevent T minus two

178
00:06:50,400 --> 00:06:51,840
around so that gives a total of D

179
00:06:51,840 --> 00:06:53,780
squared minus one rounds

180
00:06:53,780 --> 00:06:56,880
and so then the data complexity now is n

181
00:06:56,880 --> 00:06:58,620
to the power of D minus one so because

182
00:06:58,620 --> 00:07:00,479
we have this

183
00:07:00,479 --> 00:07:01,020
um

184
00:07:01,020 --> 00:07:03,180
slightly higher ideal probability and

185
00:07:03,180 --> 00:07:04,500
and because we need to take that into

186
00:07:04,500 --> 00:07:07,800
account uh when calculating the data

187
00:07:07,800 --> 00:07:08,819
complexity

188
00:07:08,819 --> 00:07:11,880
so now again the question is can we

189
00:07:11,880 --> 00:07:15,360
improve over this and we can and that's

190
00:07:15,360 --> 00:07:17,819
what I will do in this second part

191
00:07:17,819 --> 00:07:19,740
so

192
00:07:19,740 --> 00:07:22,919
um the basic idea of this Improvement is

193
00:07:22,919 --> 00:07:23,940
that

194
00:07:23,940 --> 00:07:26,280
um instead of starting with zero

195
00:07:26,280 --> 00:07:27,360
differences

196
00:07:27,360 --> 00:07:31,380
on the first uh D minus two branches I

197
00:07:31,380 --> 00:07:32,880
will start with non-zero differences

198
00:07:32,880 --> 00:07:35,280
because this is going to give bigger

199
00:07:35,280 --> 00:07:38,160
input structures uh which means I can

200
00:07:38,160 --> 00:07:40,680
generate more pairs and will reduce the

201
00:07:40,680 --> 00:07:42,720
data complexity but the problem with

202
00:07:42,720 --> 00:07:45,419
using a non-zero input differences is

203
00:07:45,419 --> 00:07:48,180
that it's normally going to lead to an

204
00:07:48,180 --> 00:07:50,460
ideal probability which is much higher

205
00:07:50,460 --> 00:07:52,139
again

206
00:07:52,139 --> 00:07:54,120
um but to still keep that in check what

207
00:07:54,120 --> 00:07:57,120
we do here is we use uh dependent input

208
00:07:57,120 --> 00:07:58,740
and output differences so that means

209
00:07:58,740 --> 00:07:59,880
that

210
00:07:59,880 --> 00:08:02,819
um this input difference B on the first

211
00:08:02,819 --> 00:08:04,680
two branches for example it is arbitrary

212
00:08:04,680 --> 00:08:06,840
and then it's going to in the output you

213
00:08:06,840 --> 00:08:08,280
also have some arbitrary difference

214
00:08:08,280 --> 00:08:10,259
that's non-zero but it's going to have

215
00:08:10,259 --> 00:08:12,360
to be equal to the input difference

216
00:08:12,360 --> 00:08:14,639
so that's what this uh the trail that's

217
00:08:14,639 --> 00:08:15,840
shown here

218
00:08:15,840 --> 00:08:19,319
um does and it works in basically the

219
00:08:19,319 --> 00:08:21,840
same way as the previous one so in the

220
00:08:21,840 --> 00:08:23,580
first round you get an output difference

221
00:08:23,580 --> 00:08:26,099
or what that is called C minus a here

222
00:08:26,099 --> 00:08:30,000
and then second round uh you assume that

223
00:08:30,000 --> 00:08:31,740
you get a minus C so this is a

224
00:08:31,740 --> 00:08:34,260
probability one over n event

225
00:08:34,260 --> 00:08:37,380
and then after that you just have the

226
00:08:37,380 --> 00:08:39,659
first three branches

227
00:08:39,659 --> 00:08:43,140
um at the top that sum to zero so you

228
00:08:43,140 --> 00:08:44,459
can go over the remaining rounds with

229
00:08:44,459 --> 00:08:46,800
probability one

230
00:08:46,800 --> 00:08:48,959
um so this has a ideal probability of 1

231
00:08:48,959 --> 00:08:51,720
over n cubed because you have

232
00:08:51,720 --> 00:08:56,100
um basically uh two well in general

233
00:08:56,100 --> 00:08:58,980
in this case for the D or D is equal to

234
00:08:58,980 --> 00:09:02,519
four uh case you would have two branches

235
00:09:02,519 --> 00:09:04,320
that are exactly equal to some known

236
00:09:04,320 --> 00:09:05,640
input difference

237
00:09:05,640 --> 00:09:10,260
and then uh two that that have to sum to

238
00:09:10,260 --> 00:09:12,240
minus that difference

239
00:09:12,240 --> 00:09:15,360
so with this in general you can do uh n

240
00:09:15,360 --> 00:09:18,600
to the power of T minus two inputs a

241
00:09:18,600 --> 00:09:20,399
structures of size input power of T

242
00:09:20,399 --> 00:09:22,440
minus two

243
00:09:22,440 --> 00:09:23,399
um

244
00:09:23,399 --> 00:09:24,440
so

245
00:09:24,440 --> 00:09:27,660
taking a bit uh a more General look at

246
00:09:27,660 --> 00:09:28,980
this so

247
00:09:28,980 --> 00:09:32,760
you could basically try to trade off

248
00:09:32,760 --> 00:09:34,980
various things so the obvious thing to

249
00:09:34,980 --> 00:09:36,899
look at is of course the probability of

250
00:09:36,899 --> 00:09:37,980
your Trail

251
00:09:37,980 --> 00:09:41,100
but using a high probability Trail might

252
00:09:41,100 --> 00:09:42,899
actually lead to a lower ideal

253
00:09:42,899 --> 00:09:45,360
probability a higher ideal probability

254
00:09:45,360 --> 00:09:46,860
which is not what you want to answer a

255
00:09:46,860 --> 00:09:50,279
low ideal probability and also

256
00:09:50,279 --> 00:09:52,320
you have to take into account how big

257
00:09:52,320 --> 00:09:54,720
the input structures are so if you uh

258
00:09:54,720 --> 00:09:57,480
kind of look at this and try to find a

259
00:09:57,480 --> 00:09:59,279
good trade-off

260
00:09:59,279 --> 00:10:02,160
um or at least what we found was two uh

261
00:10:02,160 --> 00:10:04,080
two interesting points here

262
00:10:04,080 --> 00:10:06,180
if we try to go for a large number of

263
00:10:06,180 --> 00:10:07,620
rounds

264
00:10:07,620 --> 00:10:10,080
um so the the one in red is a t-squared

265
00:10:10,080 --> 00:10:11,820
round a text so that's only one round

266
00:10:11,820 --> 00:10:14,820
more than the previous one I've done the

267
00:10:14,820 --> 00:10:18,420
basic Trail but this one uh has a factor

268
00:10:18,420 --> 00:10:20,459
of endless data and it's based on

269
00:10:20,459 --> 00:10:22,740
repeating the trail from the previous

270
00:10:22,740 --> 00:10:25,440
slide T minus one times

271
00:10:25,440 --> 00:10:28,440
and then prepending one round which

272
00:10:28,440 --> 00:10:29,940
which is for free basically and then

273
00:10:29,940 --> 00:10:32,940
appending uh T minus two rounds

274
00:10:32,940 --> 00:10:36,899
and then you can also go more rounds

275
00:10:36,899 --> 00:10:39,779
um so D squared plus D minus two rounds

276
00:10:39,779 --> 00:10:40,920
and

277
00:10:40,920 --> 00:10:41,760
um

278
00:10:41,760 --> 00:10:43,800
the way to do this is by prepending T

279
00:10:43,800 --> 00:10:46,140
rounds which actually reduces the trail

280
00:10:46,140 --> 00:10:49,019
probability by a factor of n

281
00:10:49,019 --> 00:10:52,200
but it has the advantage that it's uh

282
00:10:52,200 --> 00:10:54,959
increases the in the infrastructure size

283
00:10:54,959 --> 00:10:57,500
also by a factor of n

284
00:10:57,500 --> 00:10:59,880
and so in both cases the ideal

285
00:10:59,880 --> 00:11:01,500
probability is only one over N squared

286
00:11:01,500 --> 00:11:03,660
because you have to append the minus two

287
00:11:03,660 --> 00:11:06,120
rounds oh you don't have to but it turns

288
00:11:06,120 --> 00:11:08,339
out to be a better trade-off uh which

289
00:11:08,339 --> 00:11:10,860
which increases the ideal probability by

290
00:11:10,860 --> 00:11:13,260
a factor fan

291
00:11:13,260 --> 00:11:15,420
so this is just this is not too

292
00:11:15,420 --> 00:11:17,339
important but I just want to show that

293
00:11:17,339 --> 00:11:20,040
so you can do some experiments uh so we

294
00:11:20,040 --> 00:11:22,079
did that with random round functions and

295
00:11:22,079 --> 00:11:25,019
then you get this figure so it shows the

296
00:11:25,019 --> 00:11:26,040
success probability of this

297
00:11:26,040 --> 00:11:27,779
distinguisher for a given decision

298
00:11:27,779 --> 00:11:29,880
thresholds

299
00:11:29,880 --> 00:11:31,200
um

300
00:11:31,200 --> 00:11:33,779
uh so for 16 and 18 rounds so this is

301
00:11:33,779 --> 00:11:37,920
for four branches and at 32-bit uh

302
00:11:37,920 --> 00:11:39,540
Cipher

303
00:11:39,540 --> 00:11:41,880
Okay so

304
00:11:41,880 --> 00:11:43,079
um

305
00:11:43,079 --> 00:11:46,920
now I've we've got this distinguisher so

306
00:11:46,920 --> 00:11:50,339
um I want to apply them and I think it

307
00:11:50,339 --> 00:11:52,019
also makes sense to turn it into a key

308
00:11:52,019 --> 00:11:53,700
recovery first

309
00:11:53,700 --> 00:11:56,519
so we we don't really optimize the cubic

310
00:11:56,519 --> 00:11:58,980
over a lot we just basically we we do a

311
00:11:58,980 --> 00:12:00,540
partial decryption of the last round and

312
00:12:00,540 --> 00:12:02,220
then just use the t-square to run

313
00:12:02,220 --> 00:12:04,620
distinguisher we do not use the t

314
00:12:04,620 --> 00:12:06,300
squared plus D minus two round

315
00:12:06,300 --> 00:12:07,980
distinguisher because that would result

316
00:12:07,980 --> 00:12:11,700
in time complexity around n to the power

317
00:12:11,700 --> 00:12:13,500
of T which

318
00:12:13,500 --> 00:12:15,060
um well depending on how you count

319
00:12:15,060 --> 00:12:17,160
partial decryptions might be cheaper

320
00:12:17,160 --> 00:12:19,440
than Brute Force but it probably isn't

321
00:12:19,440 --> 00:12:22,500
so we didn't do that so the idea is that

322
00:12:22,500 --> 00:12:25,440
you filter out uh a list of n to the

323
00:12:25,440 --> 00:12:27,899
power of Delta candidate keys for the

324
00:12:27,899 --> 00:12:30,240
last round key so we we're in the case

325
00:12:30,240 --> 00:12:32,240
like in sm4 where

326
00:12:32,240 --> 00:12:35,700
each round is basically involves log 2

327
00:12:35,700 --> 00:12:37,440
and key bits

328
00:12:37,440 --> 00:12:39,540
and then you will need about a factor of

329
00:12:39,540 --> 00:12:42,839
log n uh more data in order to have a

330
00:12:42,839 --> 00:12:44,880
six I mean a low enough uh false

331
00:12:44,880 --> 00:12:46,320
positive rate so that you can actually

332
00:12:46,320 --> 00:12:48,959
do this filtering and then at the end

333
00:12:48,959 --> 00:12:51,660
you can essentially balance it depends

334
00:12:51,660 --> 00:12:52,920
what you want to achieve but for example

335
00:12:52,920 --> 00:12:54,540
if you want to minimize the time

336
00:12:54,540 --> 00:12:57,899
complexity you can balance the cost of

337
00:12:57,899 --> 00:12:59,820
um basically guessing and then the cost

338
00:12:59,820 --> 00:13:02,279
of the partial decryption operations

339
00:13:02,279 --> 00:13:06,360
by choosing this Delta parameter so

340
00:13:06,360 --> 00:13:09,839
um what is this give so for GMC CRF

341
00:13:09,839 --> 00:13:12,120
um this actually gives full round

342
00:13:12,120 --> 00:13:15,139
attacks on uh several instances

343
00:13:15,139 --> 00:13:18,480
especially those where you have a large

344
00:13:18,480 --> 00:13:20,279
number of branches compared to the

345
00:13:20,279 --> 00:13:22,200
logarithm of the the prime that's used

346
00:13:22,200 --> 00:13:24,839
to the prime is equal to the the size of

347
00:13:24,839 --> 00:13:27,899
of each branch basically

348
00:13:27,899 --> 00:13:31,139
um and in that case even the the

349
00:13:31,139 --> 00:13:33,720
t-squared around distinguisher is

350
00:13:33,720 --> 00:13:35,579
already covering more rounds than the

351
00:13:35,579 --> 00:13:37,200
number of rounds that the designers

352
00:13:37,200 --> 00:13:38,220
propose

353
00:13:38,220 --> 00:13:39,779
so of course you can also get key

354
00:13:39,779 --> 00:13:42,120
recovery there and then because you you

355
00:13:42,120 --> 00:13:43,860
can actually cover more rounds you'd

356
00:13:43,860 --> 00:13:45,480
probably have to look at

357
00:13:45,480 --> 00:13:46,200
um

358
00:13:46,200 --> 00:13:48,480
seeing how much the data complexity can

359
00:13:48,480 --> 00:13:50,880
be reduced for a lower number of rounds

360
00:13:50,880 --> 00:13:53,760
but we didn't do that because

361
00:13:53,760 --> 00:13:56,220
the problem with this is that most

362
00:13:56,220 --> 00:13:59,399
actually most practical instances of GMC

363
00:13:59,399 --> 00:14:02,940
CRF will have a number of branches that

364
00:14:02,940 --> 00:14:04,920
is much lower than the logarithm of this

365
00:14:04,920 --> 00:14:07,440
Prime so that is uh kind of uh that

366
00:14:07,440 --> 00:14:09,120
makes these attacks less interesting but

367
00:14:09,120 --> 00:14:11,279
well it's full round but just not for

368
00:14:11,279 --> 00:14:14,279
the most interesting cases

369
00:14:14,279 --> 00:14:17,160
um I run for sm4 and this is I think

370
00:14:17,160 --> 00:14:18,720
more interesting so

371
00:14:18,720 --> 00:14:20,339
um of course you can apply the

372
00:14:20,339 --> 00:14:22,019
distinguishers that we have more or less

373
00:14:22,019 --> 00:14:24,540
directly and we also propose a key

374
00:14:24,540 --> 00:14:26,820
recovery attack on 17 rounds

375
00:14:26,820 --> 00:14:29,339
uh with about 2 to the 70 data and

376
00:14:29,339 --> 00:14:32,820
around to the 99 time so uh the

377
00:14:32,820 --> 00:14:34,200
interesting thing here I think is that

378
00:14:34,200 --> 00:14:36,480
if you look at dedicated attacks so

379
00:14:36,480 --> 00:14:37,920
there are dedicated to takes on more

380
00:14:37,920 --> 00:14:40,019
than 17 rounds of course

381
00:14:40,019 --> 00:14:43,199
but uh if you would scale them down and

382
00:14:43,199 --> 00:14:46,079
we actually did try to look at that in

383
00:14:46,079 --> 00:14:48,600
some detail then it seems that actually

384
00:14:48,600 --> 00:14:51,779
this attack uh gives you a better 17

385
00:14:51,779 --> 00:14:53,279
rounds I think which is interesting

386
00:14:53,279 --> 00:14:55,199
given that it doesn't use any details of

387
00:14:55,199 --> 00:14:58,560
the of the round function at all so this

388
00:14:58,560 --> 00:15:00,660
is just the overview again

389
00:15:00,660 --> 00:15:04,560
um but I want to conclude so

390
00:15:04,560 --> 00:15:05,519
um

391
00:15:05,519 --> 00:15:08,940
as of uh just introduced I've shown that

392
00:15:08,940 --> 00:15:10,860
there are distinguishers for D squared

393
00:15:10,860 --> 00:15:13,079
plus D minus two rounds on Contracting

394
00:15:13,079 --> 00:15:15,720
fiso ciphers with d branches

395
00:15:15,720 --> 00:15:18,120
and then this translates into a full

396
00:15:18,120 --> 00:15:21,180
roundtake on some instances of GMC CRF

397
00:15:21,180 --> 00:15:22,920
although they are not the most

398
00:15:22,920 --> 00:15:25,620
interesting instances

399
00:15:25,620 --> 00:15:26,399
um

400
00:15:26,399 --> 00:15:30,300
and then uh so for sm4 we give this key

401
00:15:30,300 --> 00:15:33,300
recovery attack so for future work

402
00:15:33,300 --> 00:15:33,959
um

403
00:15:33,959 --> 00:15:36,779
I think it would be worthwhile to

404
00:15:36,779 --> 00:15:38,399
actually because this is a truncated

405
00:15:38,399 --> 00:15:39,660
differential attack so you can also

406
00:15:39,660 --> 00:15:41,399
reformulate it as a multi-dimensional

407
00:15:41,399 --> 00:15:43,620
linear attack which would probably

408
00:15:43,620 --> 00:15:45,420
clarify some of the heuristic

409
00:15:45,420 --> 00:15:48,240
assumptions that went into this attack

410
00:15:48,240 --> 00:15:51,240
and another thing is that we really

411
00:15:51,240 --> 00:15:53,399
didn't improve uh I mean we did try to

412
00:15:53,399 --> 00:15:56,519
improve too much the key recovery attack

413
00:15:56,519 --> 00:15:58,800
um so especially for sm4 if you use the

414
00:15:58,800 --> 00:16:01,199
structure of the round function it's it

415
00:16:01,199 --> 00:16:03,000
seems likely that you can get some

416
00:16:03,000 --> 00:16:04,440
improvements there

417
00:16:04,440 --> 00:16:05,459
okay

418
00:16:05,459 --> 00:16:09,380
thank you for your attention

419
00:16:10,519 --> 00:16:13,920
okay thanks for the talk any questions

420
00:16:13,920 --> 00:16:16,939
in Beijing

421
00:16:20,279 --> 00:16:23,959
there is a question in Beijing

422
00:16:24,300 --> 00:16:27,180
hello uh thanks for your presentation I

423
00:16:27,180 --> 00:16:29,279
have a question uh could you give us

424
00:16:29,279 --> 00:16:31,620
more details on your experimental

425
00:16:31,620 --> 00:16:33,839
verifications

426
00:16:33,839 --> 00:16:37,019
okay let me go there so what this

427
00:16:37,019 --> 00:16:39,199
experiment did

428
00:16:39,199 --> 00:16:42,300
we sampled yeah this one right here so

429
00:16:42,300 --> 00:16:45,420
we sampled uh I mean in the case of the

430
00:16:45,420 --> 00:16:48,360
16 round attack uh so we took a

431
00:16:48,360 --> 00:16:49,980
Contracting fossil Cipher with four

432
00:16:49,980 --> 00:16:53,100
branches and a random round function so

433
00:16:53,100 --> 00:16:55,980
the round function is a it's just a

434
00:16:55,980 --> 00:16:58,199
8-bit function selected uniformly at

435
00:16:58,199 --> 00:16:59,339
random

436
00:16:59,339 --> 00:17:01,500
uh and then

437
00:17:01,500 --> 00:17:03,120
um so

438
00:17:03,120 --> 00:17:05,400
you have to check I mean we we did this

439
00:17:05,400 --> 00:17:07,559
uh so we basically just did the attack

440
00:17:07,559 --> 00:17:08,699
and then

441
00:17:08,699 --> 00:17:12,419
uh we check if the number of

442
00:17:12,419 --> 00:17:15,119
um observed right pairs for the

443
00:17:15,119 --> 00:17:16,439
differential is bigger than this

444
00:17:16,439 --> 00:17:19,260
decision threshold

445
00:17:19,260 --> 00:17:20,939
um but then you have to check what the

446
00:17:20,939 --> 00:17:23,099
false positive rate uh for that is there

447
00:17:23,099 --> 00:17:25,619
is a calculation of that in the uh

448
00:17:25,619 --> 00:17:27,419
in the paper

449
00:17:27,419 --> 00:17:29,480
um

450
00:17:29,580 --> 00:17:31,919
yeah basically there's not that much to

451
00:17:31,919 --> 00:17:35,280
say about it we just um

452
00:17:35,280 --> 00:17:38,820
yeah just checked how often

453
00:17:38,820 --> 00:17:41,400
um the number of pairs is bigger or the

454
00:17:41,400 --> 00:17:42,900
deviation of the number of pairs is

455
00:17:42,900 --> 00:17:46,220
bigger than this decision threshold

456
00:17:46,440 --> 00:17:49,620
okay thank you uh I just saved from the

457
00:17:49,620 --> 00:17:54,539
figure that for the 18 runs uh maybe the

458
00:17:54,539 --> 00:17:58,799
improve uh your experimental results uh

459
00:17:58,799 --> 00:18:03,320
seems to note that fulfills culture

460
00:18:03,320 --> 00:18:07,080
correctly on your theoretical values

461
00:18:07,080 --> 00:18:10,440
it seems the distance may be a little

462
00:18:10,440 --> 00:18:11,820
high

463
00:18:11,820 --> 00:18:13,980
no I don't know what you mean I mean

464
00:18:13,980 --> 00:18:16,980
it's uh for 18 rounds I mean of course

465
00:18:16,980 --> 00:18:18,960
the it's the success probability doesn't

466
00:18:18,960 --> 00:18:21,120
go all the way to one yet with this

467
00:18:21,120 --> 00:18:22,919
number of structures but that's not

468
00:18:22,919 --> 00:18:24,539
necessary I mean the result just claims

469
00:18:24,539 --> 00:18:26,220
that you get uh

470
00:18:26,220 --> 00:18:30,360
a constant Advantage with uh with this

471
00:18:30,360 --> 00:18:34,080
amount of data so I think it's it does

472
00:18:34,080 --> 00:18:36,539
agree I mean you can

473
00:18:36,539 --> 00:18:38,640
yeah but I don't really see a problem

474
00:18:38,640 --> 00:18:40,140
there

475
00:18:40,140 --> 00:18:44,340
uh I mean you might do this with this

476
00:18:44,340 --> 00:18:46,380
experiment with more data but also this

477
00:18:46,380 --> 00:18:48,720
this so if you really want to see the

478
00:18:48,720 --> 00:18:51,000
maximum advantage that you can reach you

479
00:18:51,000 --> 00:18:52,679
would have to also choose your decision

480
00:18:52,679 --> 00:18:54,660
threshold optimally which we didn't try

481
00:18:54,660 --> 00:18:57,059
to do in this experiment so

482
00:18:57,059 --> 00:19:00,960
that may also be a reason why uh yeah I

483
00:19:00,960 --> 00:19:02,640
mean you I guess you want it to go up a

484
00:19:02,640 --> 00:19:05,720
bit faster but well that's how it is

485
00:19:05,720 --> 00:19:09,260
okay thank you

486
00:19:10,440 --> 00:19:12,660
this is by the way this may be also

487
00:19:12,660 --> 00:19:14,340
interesting say that's

488
00:19:14,340 --> 00:19:18,000
um so we do not use the t squared plus T

489
00:19:18,000 --> 00:19:21,720
minus two uh round distinguisher for uh

490
00:19:21,720 --> 00:19:24,179
the Q recovery so uh if you're worried

491
00:19:24,179 --> 00:19:26,039
that this wouldn't go to one and that

492
00:19:26,039 --> 00:19:27,419
the key recovery wouldn't work because

493
00:19:27,419 --> 00:19:28,740
of that so that that's not an issue

494
00:19:28,740 --> 00:19:30,539
because we don't use that for for key

495
00:19:30,539 --> 00:19:32,160
recovery

496
00:19:32,160 --> 00:19:34,940
uh yeah

497
00:19:35,820 --> 00:19:38,840
okay thank you

498
00:19:39,120 --> 00:19:44,899
any questions in Beijing or Kobe

499
00:19:48,419 --> 00:19:50,880
no questions incope

500
00:19:50,880 --> 00:19:54,140
any questions online

501
00:19:54,539 --> 00:19:57,000
okay if there's no questions let's thank

502
00:19:57,000 --> 00:19:59,760
the speaker again

503
00:19:59,760 --> 00:20:02,700
uh the next talk is

504
00:20:02,700 --> 00:20:06,059
new key recovery attack on radio strong

505
00:20:06,059 --> 00:20:07,500
AES

506
00:20:07,500 --> 00:20:10,860
and the speakers are that the others are

507
00:20:10,860 --> 00:20:13,159
navig

508
00:20:14,900 --> 00:20:18,539
we'll give the talk please start

509
00:20:18,539 --> 00:20:21,780
yeah thank you for introduction uh I'm

510
00:20:21,780 --> 00:20:23,760
going to introduce you

511
00:20:23,760 --> 00:20:27,299
and the okay recovery attack on 71. yes

512
00:20:27,299 --> 00:20:30,000
and this is the joint work with Vincent

513
00:20:30,000 --> 00:20:34,740
Raymond so let me first start by giving

514
00:20:34,740 --> 00:20:36,240
you a short overview

515
00:20:36,240 --> 00:20:38,580
Affairs I will explain you what is the

516
00:20:38,580 --> 00:20:41,580
AES and zero difference crypto analysis

517
00:20:41,580 --> 00:20:44,340
then I will

518
00:20:44,340 --> 00:20:46,740
show you how we can extend this

519
00:20:46,740 --> 00:20:49,200
photography using the related

520
00:20:49,200 --> 00:20:52,320
differential then I will show you a new

521
00:20:52,320 --> 00:20:54,240
key recovery attack on seven round of

522
00:20:54,240 --> 00:20:58,679
AES uh 128 bits and then I conclude the

523
00:20:58,679 --> 00:21:02,720
thought so what is the AES

524
00:21:04,940 --> 00:21:06,860
is

525
00:21:06,860 --> 00:21:10,080
128 bits and

526
00:21:10,080 --> 00:21:13,260
the number of runs varies depending on

527
00:21:13,260 --> 00:21:17,640
the key size so 10 rounds were 128 bit

528
00:21:17,640 --> 00:21:23,940
key uh 12 rounds for 192 hit key and 40

529
00:21:23,940 --> 00:21:29,100
rounds for 256 bitkey and its run

530
00:21:29,100 --> 00:21:34,280
function consists of the four operations

531
00:21:34,280 --> 00:21:37,260
Pro and mix color

532
00:21:37,260 --> 00:21:39,720
so now if we consider the two round of

533
00:21:39,720 --> 00:21:45,419
AES and if we swap the order of the

534
00:21:45,419 --> 00:21:48,360
first shift row and Supply then in the

535
00:21:48,360 --> 00:21:50,640
middle we have a soft bar cheap pro

536
00:21:50,640 --> 00:21:54,299
Atron key and Supply this is what is

537
00:21:54,299 --> 00:21:56,820
usually called as a super box and it

538
00:21:56,820 --> 00:22:00,179
consists of the four big box which are

539
00:22:00,179 --> 00:22:02,159
operating on the each column of estate

540
00:22:02,159 --> 00:22:04,080
independently

541
00:22:04,080 --> 00:22:07,440
and if you consider p as a shift row mix

542
00:22:07,440 --> 00:22:10,380
column Advanced key and she throw then

543
00:22:10,380 --> 00:22:13,260
the four round of AES has a SPS

544
00:22:13,260 --> 00:22:16,919
structure in the Middle with one shift

545
00:22:16,919 --> 00:22:20,220
row at the beginning and shift runs

546
00:22:20,220 --> 00:22:21,840
column at the end

547
00:22:21,840 --> 00:22:23,659
so we use this

548
00:22:23,659 --> 00:22:26,900
structure in this presentation

549
00:22:26,900 --> 00:22:30,720
so then the zero difference property was

550
00:22:30,720 --> 00:22:34,679
introduced at Asia Cube 17 by random

551
00:22:34,679 --> 00:22:38,280
birthday and hello sir so the main idea

552
00:22:38,280 --> 00:22:42,240
is to generate set of states such that

553
00:22:42,240 --> 00:22:45,179
all of them follow the specific

554
00:22:45,179 --> 00:22:48,059
photography after the song Run so in

555
00:22:48,059 --> 00:22:49,740
this technique

556
00:22:49,740 --> 00:22:52,980
a new page of Estates is generated in a

557
00:22:52,980 --> 00:22:56,100
simple way as follows so for a vector v

558
00:22:56,100 --> 00:22:59,280
and Tails of Estates Alpha and beta then

559
00:22:59,280 --> 00:23:02,100
we can Define new states such that the

560
00:23:02,100 --> 00:23:04,799
coordinate I of this state is equal to

561
00:23:04,799 --> 00:23:09,419
Alpha I if coordinate I of B is zero

562
00:23:09,419 --> 00:23:12,059
and that's the I otherwise so in this

563
00:23:12,059 --> 00:23:15,179
way we can generate two new States Alpha

564
00:23:15,179 --> 00:23:17,520
and Alpha Prime by exchanging the vote

565
00:23:17,520 --> 00:23:20,039
between Alpha and beta and we call them

566
00:23:20,039 --> 00:23:22,220
related pairs

567
00:23:22,220 --> 00:23:25,679
so then in this way you can generate at

568
00:23:25,679 --> 00:23:29,780
most two to the N minus 1 related phase

569
00:23:29,780 --> 00:23:33,659
so let us denote the binary indicator

570
00:23:33,659 --> 00:23:38,960
Vector which is one uh if the position

571
00:23:38,960 --> 00:23:42,179
in the position I if the ice word of s

572
00:23:42,179 --> 00:23:44,940
is non-zero and zero otherwise then we

573
00:23:44,940 --> 00:23:48,440
have these two on the

574
00:23:48,980 --> 00:23:51,120
difference probability

575
00:23:51,120 --> 00:23:55,320
so let Alpha and beta let's Alpha

576
00:23:55,320 --> 00:23:57,600
Android to be a two states and then we

577
00:23:57,600 --> 00:24:00,299
generate two new Estates Alpha Prime and

578
00:24:00,299 --> 00:24:02,280
bits of prime by exchanging board

579
00:24:02,280 --> 00:24:04,440
between Alpha Android

580
00:24:04,440 --> 00:24:08,520
then we have this relation so it tell us

581
00:24:08,520 --> 00:24:11,360
that the pattern of the

582
00:24:11,360 --> 00:24:14,159
non-zero and zero volt of these two

583
00:24:14,159 --> 00:24:16,320
differences are occurred in other words

584
00:24:16,320 --> 00:24:20,280
it means that uh if one of these

585
00:24:20,280 --> 00:24:22,860
differences has a zero volt in some

586
00:24:22,860 --> 00:24:25,799
position the other one has a zero volt

587
00:24:25,799 --> 00:24:29,039
in the exact same position

588
00:24:29,039 --> 00:24:34,200
so we have to State the alpha and beta

589
00:24:34,200 --> 00:24:39,059
we have a S P and S layer just for

590
00:24:39,059 --> 00:24:41,940
Simplicity I just omit the last P layer

591
00:24:41,940 --> 00:24:45,360
here P here is linear then the after

592
00:24:45,360 --> 00:24:48,659
first box layer we have a these two

593
00:24:48,659 --> 00:24:53,100
states now if we exchange volt I between

594
00:24:53,100 --> 00:24:55,679
Alpha and beta we get the two new

595
00:24:55,679 --> 00:24:59,220
Estates and after the Xbox layer we have

596
00:24:59,220 --> 00:25:01,080
these two states

597
00:25:01,080 --> 00:25:03,900
so as you look at if you look at here

598
00:25:03,900 --> 00:25:06,900
the difference of these two states is

599
00:25:06,900 --> 00:25:08,880
equal to the difference of piece to a

600
00:25:08,880 --> 00:25:09,539
state

601
00:25:09,539 --> 00:25:13,919
so then the after the permutation there

602
00:25:13,919 --> 00:25:17,280
since it's linear then these two

603
00:25:17,280 --> 00:25:20,220
differences here are still equal

604
00:25:20,220 --> 00:25:24,360
then after the second Xbox layer scenes

605
00:25:24,360 --> 00:25:28,080
is the permutation then these two

606
00:25:28,080 --> 00:25:30,059
difference here have the same zero

607
00:25:30,059 --> 00:25:33,179
pattern so it means that if this

608
00:25:33,179 --> 00:25:35,580
difference has a zero volt let's say in

609
00:25:35,580 --> 00:25:38,460
the first one this difference here has a

610
00:25:38,460 --> 00:25:41,580
zero wall in the force test mode as well

611
00:25:41,580 --> 00:25:45,080
you can do it in a adaptive way you can

612
00:25:45,080 --> 00:25:48,840
choose two Poland texts two Cipher texts

613
00:25:48,840 --> 00:25:51,600
which are equal let's say in the first

614
00:25:51,600 --> 00:25:54,600
one you decrease them you get the two

615
00:25:54,600 --> 00:25:57,419
Estates then you exchange the word I

616
00:25:57,419 --> 00:26:00,000
between them and you get two near States

617
00:26:00,000 --> 00:26:02,159
you encrypt them and these two cycle

618
00:26:02,159 --> 00:26:06,000
texts here are required in the four S4

619
00:26:06,000 --> 00:26:09,900
so related the differences and related

620
00:26:09,900 --> 00:26:12,960
differential are are introduced by a

621
00:26:12,960 --> 00:26:16,500
dominant Ryman as follows

622
00:26:16,500 --> 00:26:20,760
so a pairs of differences Delta X and

623
00:26:20,760 --> 00:26:24,240
Delta X Prime are related differences if

624
00:26:24,240 --> 00:26:25,919
and only if

625
00:26:25,919 --> 00:26:32,120
for every eye this uh relation holds so

626
00:26:32,120 --> 00:26:36,840
uh either for every I either Delta x i

627
00:26:36,840 --> 00:26:38,460
Delta

628
00:26:38,460 --> 00:26:43,380
um X Prime I or Delta x i xor Delta X

629
00:26:43,380 --> 00:26:47,279
Prime I should be zero so now if you

630
00:26:47,279 --> 00:26:50,340
consider the four states alpha alpha

631
00:26:50,340 --> 00:26:54,539
plus alpha x or Delta X alpha x or Delta

632
00:26:54,539 --> 00:26:57,240
X Prime and Alpha xor Delta X Delta X

633
00:26:57,240 --> 00:26:58,080
Prime

634
00:26:58,080 --> 00:27:01,620
and if you look at the coordinate I of

635
00:27:01,620 --> 00:27:04,799
these four states and then there are

636
00:27:04,799 --> 00:27:06,659
four values

637
00:27:06,659 --> 00:27:10,320
so now assume that Delta x i is equal to

638
00:27:10,320 --> 00:27:13,320
the Delta X Prime I then actually this

639
00:27:13,320 --> 00:27:15,480
Square collapse in the line

640
00:27:15,480 --> 00:27:19,620
so and there are only two values here

641
00:27:19,620 --> 00:27:22,559
so this is uh pretty much the same as

642
00:27:22,559 --> 00:27:26,159
when we generate uh the new two new

643
00:27:26,159 --> 00:27:28,320
Estates by exchanging World between two

644
00:27:28,320 --> 00:27:31,640
states so then actually we can represent

645
00:27:31,640 --> 00:27:35,600
the zero difference probability with the

646
00:27:35,600 --> 00:27:39,539
quarter that are generated is generated

647
00:27:39,539 --> 00:27:41,720
by two related difference

648
00:27:41,720 --> 00:27:46,620
and in this way we can generate uh more

649
00:27:46,620 --> 00:27:49,320
pair actually because we have a

650
00:27:49,320 --> 00:27:52,320
they can play with Delta X and Delta X

651
00:27:52,320 --> 00:27:58,320
Prime and generate more pairs so uh

652
00:27:58,320 --> 00:28:00,620
what is the

653
00:28:00,620 --> 00:28:03,120
related differential

654
00:28:03,120 --> 00:28:06,539
two differential Delta X Delta Y and

655
00:28:06,539 --> 00:28:09,360
Delta X Prime and Delta y for for a

656
00:28:09,360 --> 00:28:13,080
linear map or related differential

657
00:28:13,080 --> 00:28:16,440
if and only if the input differences are

658
00:28:16,440 --> 00:28:20,340
related differences and also the output

659
00:28:20,340 --> 00:28:23,400
differences are related differences so

660
00:28:23,400 --> 00:28:26,100
in the case of the AES mix column we

661
00:28:26,100 --> 00:28:28,440
have these four main related

662
00:28:28,440 --> 00:28:29,880
differential

663
00:28:29,880 --> 00:28:33,480
we can generate more by multiplying a

664
00:28:33,480 --> 00:28:37,200
scholar to them or rotate them so in the

665
00:28:37,200 --> 00:28:40,679
next slide I'm going to show you how we

666
00:28:40,679 --> 00:28:43,500
can construct the two run and pull Run

667
00:28:43,500 --> 00:28:45,779
related differential for as

668
00:28:45,779 --> 00:28:49,740
using the value in this table

669
00:28:49,740 --> 00:28:52,919
so before that let me introduce a

670
00:28:52,919 --> 00:28:55,799
function let me Define the function G

671
00:28:55,799 --> 00:29:00,539
which is actually the super box with two

672
00:29:00,539 --> 00:29:03,659
more ship Row one at the end and one at

673
00:29:03,659 --> 00:29:05,779
the beginning

674
00:29:05,779 --> 00:29:08,760
and then the two round of areas can be

675
00:29:08,760 --> 00:29:12,240
seen as a g mix column and the forerun

676
00:29:12,240 --> 00:29:14,340
can we see at the g mix column g mix

677
00:29:14,340 --> 00:29:15,620
column so

678
00:29:15,620 --> 00:29:20,159
the reason behind the the behind this is

679
00:29:20,159 --> 00:29:22,880
that to just show that how mix column

680
00:29:22,880 --> 00:29:26,940
changes affect the differences

681
00:29:26,940 --> 00:29:29,880
so this is a two-round related

682
00:29:29,880 --> 00:29:33,179
differential for AES uh this is our

683
00:29:33,179 --> 00:29:37,380
Delta X Delta X Prime and Delta xor

684
00:29:37,380 --> 00:29:38,779
Delta X Prime

685
00:29:38,779 --> 00:29:43,260
and here we assume that every diagonal

686
00:29:43,260 --> 00:29:45,960
form award then actually you can see

687
00:29:45,960 --> 00:29:49,740
that these these two differences are

688
00:29:49,740 --> 00:29:51,419
related

689
00:29:51,419 --> 00:29:55,260
so long does here or just a scholar then

690
00:29:55,260 --> 00:29:58,080
if you look at the output the output is

691
00:29:58,080 --> 00:30:00,960
also related difference related

692
00:30:00,960 --> 00:30:02,460
differences

693
00:30:02,460 --> 00:30:06,539
so we can actually extend it this to the

694
00:30:06,539 --> 00:30:09,299
Forum because of the lack of space I

695
00:30:09,299 --> 00:30:12,740
just only the first

696
00:30:16,399 --> 00:30:20,100
but we know that they are related and if

697
00:30:20,100 --> 00:30:23,940
we look at the output also these

698
00:30:23,940 --> 00:30:26,880
differences are related so our related

699
00:30:26,880 --> 00:30:28,320
differences

700
00:30:28,320 --> 00:30:31,679
so since both input and output are

701
00:30:31,679 --> 00:30:33,720
related differences then we can actually

702
00:30:33,720 --> 00:30:36,539
put this at the beginning of the zero

703
00:30:36,539 --> 00:30:38,880
difference probability and extend it to

704
00:30:38,880 --> 00:30:43,140
the six and the eight rounds

705
00:30:43,140 --> 00:30:46,679
so in the case of the

706
00:30:46,679 --> 00:30:50,779
Atron uh sixth round then we have this

707
00:30:50,779 --> 00:30:54,059
relation which are whole with

708
00:30:54,059 --> 00:30:57,480
probability 2 to the minus 94. in the

709
00:30:57,480 --> 00:30:59,640
case of the eight run we have this

710
00:30:59,640 --> 00:31:01,799
relation which are hot with probability

711
00:31:01,799 --> 00:31:06,240
to the one not to do minus 189

712
00:31:06,240 --> 00:31:09,299
so we can use this relation both in

713
00:31:09,299 --> 00:31:11,419
adaptive and non-adaptive way

714
00:31:11,419 --> 00:31:15,539
I'm going to use this relation when T is

715
00:31:15,539 --> 00:31:18,240
equal to 6 to attack the seven Roundup

716
00:31:18,240 --> 00:31:21,299
there yes in the next X slide

717
00:31:21,299 --> 00:31:24,659
so let's assume that we have a four

718
00:31:24,659 --> 00:31:27,200
politics

719
00:31:27,200 --> 00:31:30,539
which are generated by two related

720
00:31:30,539 --> 00:31:33,480
difference the differences Delta X and

721
00:31:33,480 --> 00:31:34,799
the 3x Prime

722
00:31:34,799 --> 00:31:36,779
then as we have seen in the previous

723
00:31:36,779 --> 00:31:39,960
slides we have this relation with

724
00:31:39,960 --> 00:31:44,880
probability 2 to the minus 189 now we

725
00:31:44,880 --> 00:31:47,940
assume one more condition here which

726
00:31:47,940 --> 00:31:51,059
basically says that this difference here

727
00:31:51,059 --> 00:31:54,120
and this difference here after six long

728
00:31:54,120 --> 00:31:57,960
has a two zero column

729
00:31:57,960 --> 00:32:01,740
so let's see this in a figure

730
00:32:01,740 --> 00:32:05,159
this is a seven round differential

731
00:32:05,159 --> 00:32:06,600
characteristic

732
00:32:06,600 --> 00:32:11,760
the First full run is just the four uh

733
00:32:11,760 --> 00:32:14,940
related differential that I'll just show

734
00:32:14,940 --> 00:32:17,220
you in the previous slide

735
00:32:17,220 --> 00:32:21,240
so in order to have a two zero column

736
00:32:21,240 --> 00:32:25,020
here then four byte in this difference

737
00:32:25,020 --> 00:32:29,039
should be zero and we we consider the

738
00:32:29,039 --> 00:32:31,740
all of cases for this event then the

739
00:32:31,740 --> 00:32:34,399
probability of this event is 2 to the

740
00:32:34,399 --> 00:32:36,799
minus

741
00:32:36,799 --> 00:32:39,659
29.7 and the probability of this

742
00:32:39,659 --> 00:32:42,380
characteristic is going to be 2 to the

743
00:32:42,380 --> 00:32:44,480
minus

744
00:32:44,480 --> 00:32:48,659
218.4 so then the attack is quite

745
00:32:48,659 --> 00:32:50,539
classical

746
00:32:50,539 --> 00:32:54,419
we include a lot of pay we expect that

747
00:32:54,419 --> 00:32:57,360
one of them follow this characteristic

748
00:32:57,360 --> 00:33:00,480
then we generate the cipher text pair

749
00:33:00,480 --> 00:33:04,500
and the the different and then they

750
00:33:04,500 --> 00:33:08,520
filter them and keep those that follow

751
00:33:08,520 --> 00:33:12,720
this uh to keep those that follow the

752
00:33:12,720 --> 00:33:14,220
second condition

753
00:33:14,220 --> 00:33:18,299
and then we literally partially decipher

754
00:33:18,299 --> 00:33:21,360
text pair using by guessing the last one

755
00:33:21,360 --> 00:33:25,679
key and check the first condition so

756
00:33:25,679 --> 00:33:28,679
then we keep the candidate the key

757
00:33:28,679 --> 00:33:32,240
candidate that follow the

758
00:33:32,240 --> 00:33:35,580
first condition so then we can find the

759
00:33:35,580 --> 00:33:37,760
last round here

760
00:33:37,760 --> 00:33:41,519
so the all complexity of this attack

761
00:33:41,519 --> 00:33:45,010
time data and the memory are

762
00:33:45,010 --> 00:33:46,200
[Music]

763
00:33:46,200 --> 00:33:51,659
two are below 2 to the 110.2

764
00:33:51,860 --> 00:33:55,080
which is not good at meet in the middle

765
00:33:55,080 --> 00:33:58,380
attack Bond and so

766
00:33:58,380 --> 00:34:02,100
if uh so as we have seen here that using

767
00:34:02,100 --> 00:34:04,580
the related

768
00:34:04,580 --> 00:34:08,040
differences we can have a better

769
00:34:08,040 --> 00:34:09,599
representation of course the difference

770
00:34:09,599 --> 00:34:12,800
perfectly than the original formulation

771
00:34:12,800 --> 00:34:16,260
then it's able us to actually generate

772
00:34:16,260 --> 00:34:20,460
more related Pairs and also it helps us

773
00:34:20,460 --> 00:34:22,619
to extend the

774
00:34:22,619 --> 00:34:25,980
zero difference probability from four

775
00:34:25,980 --> 00:34:28,199
round two six and eight round of eight

776
00:34:28,199 --> 00:34:32,219
years yeah so yeah thanks for your

777
00:34:32,219 --> 00:34:34,520
attention

778
00:34:36,560 --> 00:34:39,000
okay thanks for the talk

779
00:34:39,000 --> 00:34:42,859
any questions in Beijing

780
00:34:48,020 --> 00:34:52,219
any questions in copy

781
00:34:55,379 --> 00:34:57,440
um

782
00:34:57,540 --> 00:35:00,300
no questions here

783
00:35:00,300 --> 00:35:03,560
any questions online

784
00:35:04,560 --> 00:35:07,740
okay so if there's no questions I have a

785
00:35:07,740 --> 00:35:09,540
quick question for you

786
00:35:09,540 --> 00:35:12,300
so besides impossible differential and

787
00:35:12,300 --> 00:35:15,300
mid in the middle attack your attack is

788
00:35:15,300 --> 00:35:17,940
the third one that can break seven round

789
00:35:17,940 --> 00:35:21,180
AES right so do we have confidence that

790
00:35:21,180 --> 00:35:24,180
your method will move forward like

791
00:35:24,180 --> 00:35:27,440
attack it's wrong a yes

792
00:35:27,440 --> 00:35:32,099
uh no I don't think so

793
00:35:32,099 --> 00:35:34,619
at this I do not know if uh how we can

794
00:35:34,619 --> 00:35:37,040
do that

795
00:35:37,260 --> 00:35:40,460
okay okay thank you

796
00:35:41,700 --> 00:35:44,700
so the third talk is

797
00:35:44,700 --> 00:35:49,079
breaking half Loop 24. uh others are

798
00:35:49,079 --> 00:35:51,660
markers and sorry

799
00:35:51,660 --> 00:35:55,260
Patrick the best where I go Linder and

800
00:35:55,260 --> 00:35:58,520
Lucas Dennis

801
00:35:59,180 --> 00:36:04,460
and uh Lucas will give the talk

802
00:36:17,160 --> 00:36:19,440
yeah hi all thanks for the introduction

803
00:36:19,440 --> 00:36:21,960
I'm Lucas and I'm going to present a

804
00:36:21,960 --> 00:36:24,060
paper breaking after 24 which is joint

805
00:36:24,060 --> 00:36:26,880
work with Marcos Patrick and Craig

806
00:36:26,880 --> 00:36:30,900
so I want to start a talk with a quote

807
00:36:30,900 --> 00:36:32,780
um

808
00:36:32,780 --> 00:36:37,380
uh okay I can read it anyway I guess

809
00:36:37,380 --> 00:36:38,160
um

810
00:36:38,160 --> 00:36:42,119
so whether your B wrote half Loop is a

811
00:36:42,119 --> 00:36:44,400
parody of AES that can be summarized as

812
00:36:44,400 --> 00:36:47,880
what if we take AES 128 at The Tweak in

813
00:36:47,880 --> 00:36:49,859
the key and reduce the block size this

814
00:36:49,859 --> 00:36:52,440
paper focuses on half Loop 24 which has

815
00:36:52,440 --> 00:36:55,020
a 24-bit block size as one can expect it

816
00:36:55,020 --> 00:36:58,200
is completely wrong so that pretty much

817
00:36:58,200 --> 00:37:00,359
pinpoints our work and I hope it gives

818
00:37:00,359 --> 00:37:03,119
you a rough idea of what to expect in in

819
00:37:03,119 --> 00:37:04,200
this talk

820
00:37:04,200 --> 00:37:06,780
so before we go into the details about

821
00:37:06,780 --> 00:37:09,660
half loop I want to quickly explain

822
00:37:09,660 --> 00:37:11,880
for what half Loop is used

823
00:37:11,880 --> 00:37:14,040
and half Loop is used in in high

824
00:37:14,040 --> 00:37:15,480
frequency radio so what is high

825
00:37:15,480 --> 00:37:17,040
frequency radio

826
00:37:17,040 --> 00:37:20,460
the idea is that you take some some

827
00:37:20,460 --> 00:37:23,160
radio signal on a frequency of like

828
00:37:23,160 --> 00:37:27,540
three megahertz up to 30 megahertz and

829
00:37:27,540 --> 00:37:28,440
then

830
00:37:28,440 --> 00:37:31,200
those frequencies are reflected by the

831
00:37:31,200 --> 00:37:33,359
atmosphere so say we have Alice and Bob

832
00:37:33,359 --> 00:37:35,640
and they want to communicate then Alice

833
00:37:35,640 --> 00:37:38,160
can send a radio signal and it will

834
00:37:38,160 --> 00:37:40,200
bounce off the the atmosphere and then

835
00:37:40,200 --> 00:37:43,560
will reach pop and this is called Skyway

836
00:37:43,560 --> 00:37:45,599
propagation of course the it's in

837
00:37:45,599 --> 00:37:48,780
practice it's way more complicated but I

838
00:37:48,780 --> 00:37:50,400
hope this is enough to get the idea and

839
00:37:50,400 --> 00:37:52,740
of course it's super cool because it

840
00:37:52,740 --> 00:37:54,780
enables communication across really

841
00:37:54,780 --> 00:37:57,900
large distances without any uh external

842
00:37:57,900 --> 00:37:59,520
infrastructure so you don't need any

843
00:37:59,520 --> 00:38:02,400
satellites or cell towers nothing just

844
00:38:02,400 --> 00:38:05,520
radius on both sides and who is

845
00:38:05,520 --> 00:38:07,380
interested in such technology of course

846
00:38:07,380 --> 00:38:09,720
in Military and

847
00:38:09,720 --> 00:38:12,540
also others so diplomatic services and

848
00:38:12,540 --> 00:38:15,119
so for example those antennas are you

849
00:38:15,119 --> 00:38:17,339
can often find them on the roofs of

850
00:38:17,339 --> 00:38:19,980
embassies and also disaster management

851
00:38:19,980 --> 00:38:22,440
is a typical user because after

852
00:38:22,440 --> 00:38:24,180
disasters there's often no more

853
00:38:24,180 --> 00:38:25,280
infrastructure

854
00:38:25,280 --> 00:38:28,260
infrastructure and

855
00:38:28,260 --> 00:38:30,960
so then there's a protocol to set up

856
00:38:30,960 --> 00:38:33,320
such a link

857
00:38:33,320 --> 00:38:36,240
and inside this protocol there are

858
00:38:36,240 --> 00:38:38,460
handshake messages and those are

859
00:38:38,460 --> 00:38:41,400
encrypted with half Loop and so the

860
00:38:41,400 --> 00:38:43,740
security goals there are confidentiality

861
00:38:43,740 --> 00:38:47,520
and authentication so the these messages

862
00:38:47,520 --> 00:38:50,700
these handshake messages mainly consist

863
00:38:50,700 --> 00:38:53,520
of so-called call signs so that's kind

864
00:38:53,520 --> 00:38:55,260
of like an equivalent of phone numbers

865
00:38:55,260 --> 00:39:00,060
but in in high frequency radio and and

866
00:39:00,060 --> 00:39:02,460
those might be con confidential if

867
00:39:02,460 --> 00:39:06,000
you're like in a military scenario and

868
00:39:06,000 --> 00:39:08,460
then also Authentication

869
00:39:08,460 --> 00:39:11,280
should be or is they try to ensure

870
00:39:11,280 --> 00:39:13,200
authentication by using half Loop so

871
00:39:13,200 --> 00:39:15,060
that Alice knows she's communicating

872
00:39:15,060 --> 00:39:16,440
with Bob

873
00:39:16,440 --> 00:39:17,700
okay

874
00:39:17,700 --> 00:39:20,400
so now let's have look at half Loop

875
00:39:20,400 --> 00:39:22,560
first big picture so

876
00:39:22,560 --> 00:39:24,780
like it was already said it's a

877
00:39:24,780 --> 00:39:27,540
tweakable box Cipher so

878
00:39:27,540 --> 00:39:29,160
um and one thing I maybe should mention

879
00:39:29,160 --> 00:39:31,200
so there are actually three variants of

880
00:39:31,200 --> 00:39:35,220
half Loop 24 48 and 96 so that's

881
00:39:35,220 --> 00:39:38,099
this number is the block size but we

882
00:39:38,099 --> 00:39:40,619
only looked at the 24-bit version

883
00:39:40,619 --> 00:39:42,660
so for the 24-bit version of course we

884
00:39:42,660 --> 00:39:44,839
have 24-bit plain text and 24-bit

885
00:39:44,839 --> 00:39:49,079
ciphertext and then a 128 bit key and a

886
00:39:49,079 --> 00:39:52,560
64-bit tweak in this tweak

887
00:39:52,560 --> 00:39:56,700
is specified so it is like in in the

888
00:39:56,700 --> 00:39:58,980
standard it says like the first which

889
00:39:58,980 --> 00:40:01,260
should tell you the or is are filled

890
00:40:01,260 --> 00:40:02,520
with the the current time and then

891
00:40:02,520 --> 00:40:03,839
there's a word counter and the use

892
00:40:03,839 --> 00:40:06,259
frequency

893
00:40:06,660 --> 00:40:09,540
um yes and then maybe some some more

894
00:40:09,540 --> 00:40:12,180
General stuff about uh half Loop and

895
00:40:12,180 --> 00:40:14,359
it's used in this high frequency radio

896
00:40:14,359 --> 00:40:16,859
so actually before half Loop was used

897
00:40:16,859 --> 00:40:18,839
there was another Cipher called sodak

898
00:40:18,839 --> 00:40:22,680
which only used 56 bit keys and Marco

899
00:40:22,680 --> 00:40:24,839
said a nice talk about it at last year's

900
00:40:24,839 --> 00:40:27,720
FSE in in Athens and that's actually

901
00:40:27,720 --> 00:40:31,500
also where where this work started and

902
00:40:31,500 --> 00:40:35,099
so I am half will be specified in in

903
00:40:35,099 --> 00:40:37,859
this military standard so this this is a

904
00:40:37,859 --> 00:40:39,839
standard by the US Department of Defense

905
00:40:39,839 --> 00:40:44,520
and it specified since 2017 so

906
00:40:44,520 --> 00:40:46,920
um this gives you this and maybe also

907
00:40:46,920 --> 00:40:48,720
the fact that there's no public crypto

908
00:40:48,720 --> 00:40:51,180
analysis or there was no public crypto

909
00:40:51,180 --> 00:40:54,540
analysis before our work if you

910
00:40:54,540 --> 00:40:57,960
well maybe maybe that's maybe it is what

911
00:40:57,960 --> 00:40:59,640
you would expect from the military but

912
00:40:59,640 --> 00:41:01,980
that's not what you should hope for for

913
00:41:01,980 --> 00:41:05,280
such such stuff I think

914
00:41:05,280 --> 00:41:08,099
okay but

915
00:41:08,099 --> 00:41:10,380
um as it was also mentioned by by the

916
00:41:10,380 --> 00:41:11,940
reviewer

917
00:41:11,940 --> 00:41:13,980
um our group is heavily inspired by AES

918
00:41:13,980 --> 00:41:16,500
so it uses the same as box and

919
00:41:16,500 --> 00:41:18,780
essentially the same key scale with some

920
00:41:18,780 --> 00:41:21,320
minor but kind of crucial differences

921
00:41:21,320 --> 00:41:24,660
and so for for AES we would usually

922
00:41:24,660 --> 00:41:27,839
represent the state as a 4x4 Matrix and

923
00:41:27,839 --> 00:41:30,359
so for half Loop there are only 24 bits

924
00:41:30,359 --> 00:41:33,359
so we only have a three by one Matrix so

925
00:41:33,359 --> 00:41:35,940
just uh just one column

926
00:41:35,940 --> 00:41:40,020
but it's also seen as a state over f228

927
00:41:40,020 --> 00:41:42,780
and then there are also just 10 Rounds

928
00:41:42,780 --> 00:41:45,720
okay so let's have a look at one

929
00:41:45,720 --> 00:41:46,680
function

930
00:41:46,680 --> 00:41:49,619
we have our 24-bit input and the 24-bit

931
00:41:49,619 --> 00:41:51,720
one key and we just xorm

932
00:41:51,720 --> 00:41:53,820
nothing unusual then we apply the s-box

933
00:41:53,820 --> 00:41:56,880
also nothing unusual so the next step in

934
00:41:56,880 --> 00:41:59,760
AES would be a shift walls where there's

935
00:41:59,760 --> 00:42:03,060
there's only one column so

936
00:42:03,060 --> 00:42:05,820
you shift anyway or you rotate but not

937
00:42:05,820 --> 00:42:11,040
not the the divorce but divide itself

938
00:42:11,040 --> 00:42:12,060
um

939
00:42:12,060 --> 00:42:14,099
I would say you could move it to the mix

940
00:42:14,099 --> 00:42:15,839
column layer and that's actually what we

941
00:42:15,839 --> 00:42:18,060
do in our analysis I will just always

942
00:42:18,060 --> 00:42:21,540
write an L for the linear layer but okay

943
00:42:21,540 --> 00:42:24,300
that's how it's defined and then

944
00:42:24,300 --> 00:42:27,119
the mix column is again similar to to

945
00:42:27,119 --> 00:42:29,579
AES but there's you multiply with a

946
00:42:29,579 --> 00:42:31,859
different polynomial so if you think

947
00:42:31,859 --> 00:42:33,960
about it as a matrix multiplication the

948
00:42:33,960 --> 00:42:35,280
the entries are

949
00:42:35,280 --> 00:42:37,260
are different and of course it's also

950
00:42:37,260 --> 00:42:41,520
smaller uh and actually so this one

951
00:42:41,520 --> 00:42:43,740
is I think there's a typo in the in

952
00:42:43,740 --> 00:42:46,980
specification so the specification says

953
00:42:46,980 --> 00:42:51,060
um it has a four here so this was

954
00:42:51,060 --> 00:42:52,920
took some time to realize that it's

955
00:42:52,920 --> 00:42:55,320
actually a typo because it was kind of

956
00:42:55,320 --> 00:42:57,119
confused by this so if you have a look

957
00:42:57,119 --> 00:43:00,660
at the specification now you know

958
00:43:00,660 --> 00:43:02,220
um so let's talk about the key schedule

959
00:43:02,220 --> 00:43:05,040
and first maybe to to compare with the

960
00:43:05,040 --> 00:43:08,160
Ed as 128 key schedule so we have your

961
00:43:08,160 --> 00:43:11,040
master key and then this is like fights

962
00:43:11,040 --> 00:43:13,200
like structure which you do to derive

963
00:43:13,200 --> 00:43:14,819
the next one key and then you do this

964
00:43:14,819 --> 00:43:19,140
until you have all your 11 round keys

965
00:43:19,140 --> 00:43:20,460
and

966
00:43:20,460 --> 00:43:22,560
okay this is really there are some nice

967
00:43:22,560 --> 00:43:24,660
boxes and maybe shifting and one

968
00:43:24,660 --> 00:43:26,400
constants but it's not so important for

969
00:43:26,400 --> 00:43:27,300
us

970
00:43:27,300 --> 00:43:29,460
how does it look for half Loop kind of

971
00:43:29,460 --> 00:43:31,920
similar with two crucial differences

972
00:43:31,920 --> 00:43:35,400
there's our tweak here and

973
00:43:35,400 --> 00:43:37,079
well there are no Dots here anymore

974
00:43:37,079 --> 00:43:39,359
because we don't need that much because

975
00:43:39,359 --> 00:43:42,480
the the first one key is

976
00:43:42,480 --> 00:43:45,119
just the 20 first

977
00:43:45,119 --> 00:43:48,540
the 24 first bit and then the next one

978
00:43:48,540 --> 00:43:52,020
key the next 24 bits and so on and so on

979
00:43:52,020 --> 00:43:53,520
so

980
00:43:53,520 --> 00:43:55,920
after only one application of this this

981
00:43:55,920 --> 00:43:58,500
round called a drawn function

982
00:43:58,500 --> 00:43:59,160
um

983
00:43:59,160 --> 00:44:01,380
we are missing only one byte for for the

984
00:44:01,380 --> 00:44:04,140
very last wonky and this is this one so

985
00:44:04,140 --> 00:44:07,920
these Blitz are are not needed at all

986
00:44:07,920 --> 00:44:10,140
and then the other thing is that here we

987
00:44:10,140 --> 00:44:13,859
add a tweak so if you think about this

988
00:44:13,859 --> 00:44:16,440
um related trick attacks now give us

989
00:44:16,440 --> 00:44:18,900
related key attacks but it's kind of

990
00:44:18,900 --> 00:44:20,460
nice and that's actually what we will do

991
00:44:20,460 --> 00:44:23,760
so no going to to talk about our text

992
00:44:23,760 --> 00:44:27,859
and we come back to the key schedule

993
00:44:28,079 --> 00:44:30,660
um so let's say we have a related tweak

994
00:44:30,660 --> 00:44:33,839
of this form so the first 16 bits are

995
00:44:33,839 --> 00:44:35,599
the same and then there's one byte

996
00:44:35,599 --> 00:44:39,000
different call the data and then all the

997
00:44:39,000 --> 00:44:40,980
other bits are the same again and in

998
00:44:40,980 --> 00:44:43,980
fact this this would corresponds to to a

999
00:44:43,980 --> 00:44:47,040
difference in time so this position is

1000
00:44:47,040 --> 00:44:49,319
encoding the Decon time

1001
00:44:49,319 --> 00:44:51,960
and then what happens well

1002
00:44:51,960 --> 00:44:54,000
there's a difference in the last part of

1003
00:44:54,000 --> 00:44:56,040
the first round key and all the other

1004
00:44:56,040 --> 00:44:58,859
round Keys here stay the same so there's

1005
00:44:58,859 --> 00:45:01,260
no difference here so the data just goes

1006
00:45:01,260 --> 00:45:03,599
down and because of these connections

1007
00:45:03,599 --> 00:45:08,040
the Delta also goes to wonky 7 and 1k8

1008
00:45:08,040 --> 00:45:11,160
so and you notice it here it's in the

1009
00:45:11,160 --> 00:45:12,960
first byte here in the middle byte and

1010
00:45:12,960 --> 00:45:15,440
here in the last byte because those are

1011
00:45:15,440 --> 00:45:18,660
32-bit words in the AES key scalable the

1012
00:45:18,660 --> 00:45:20,819
one keys are only 24 bits so it's

1013
00:45:20,819 --> 00:45:23,180
shifted Always by by one byte position

1014
00:45:23,180 --> 00:45:26,339
so how can we use this in a

1015
00:45:26,339 --> 00:45:28,680
um sorry I forgot of course there's also

1016
00:45:28,680 --> 00:45:30,540
one and one key there

1017
00:45:30,540 --> 00:45:33,060
um so how can we use this um then in a

1018
00:45:33,060 --> 00:45:35,160
tech so let's have a look at a full half

1019
00:45:35,160 --> 00:45:39,060
Loop so 10 Rounds and then no again as

1020
00:45:39,060 --> 00:45:41,160
the Cs box lse linear layer and then

1021
00:45:41,160 --> 00:45:42,780
there's key Edition

1022
00:45:42,780 --> 00:45:46,020
so we know that those round Keys

1023
00:45:46,020 --> 00:45:46,680
um

1024
00:45:46,680 --> 00:45:49,020
have a difference

1025
00:45:49,020 --> 00:45:50,400
and

1026
00:45:50,400 --> 00:45:53,460
we know even more we know that those are

1027
00:45:53,460 --> 00:45:57,180
the positions where where the exact

1028
00:45:57,180 --> 00:45:59,040
where the exact positions of the

1029
00:45:59,040 --> 00:46:02,579
differences and so if you look at it

1030
00:46:02,579 --> 00:46:05,400
what can you do well it seems reasonable

1031
00:46:05,400 --> 00:46:07,800
to to just pick a plain text that has

1032
00:46:07,800 --> 00:46:09,540
also this difference right because then

1033
00:46:09,540 --> 00:46:13,200
we have a state different zero and so a

1034
00:46:13,200 --> 00:46:14,460
plain text with this difference

1035
00:46:14,460 --> 00:46:16,740
corresponds to to a difference in the

1036
00:46:16,740 --> 00:46:18,780
call sign so call sign again is this

1037
00:46:18,780 --> 00:46:20,819
phone number like

1038
00:46:20,819 --> 00:46:22,200
thing

1039
00:46:22,200 --> 00:46:23,880
so and then

1040
00:46:23,880 --> 00:46:25,980
all those round Keys there's no

1041
00:46:25,980 --> 00:46:28,740
difference so date difference zero one

1042
00:46:28,740 --> 00:46:31,440
different zero that means that until

1043
00:46:31,440 --> 00:46:33,780
here there's no difference no difference

1044
00:46:33,780 --> 00:46:36,300
in the state so we can skip those rounds

1045
00:46:36,300 --> 00:46:38,160
for free

1046
00:46:38,160 --> 00:46:40,680
and then what we will do in our attack

1047
00:46:40,680 --> 00:46:42,660
is we we just wait until we have

1048
00:46:42,660 --> 00:46:45,060
ciphertext with the difference data in

1049
00:46:45,060 --> 00:46:47,040
the first byte and no other difference

1050
00:46:47,040 --> 00:46:48,500
because then

1051
00:46:48,500 --> 00:46:51,720
these status cancel again and

1052
00:46:51,720 --> 00:46:53,579
we can essentially do the same thing but

1053
00:46:53,579 --> 00:46:55,859
from the other side so we can skip those

1054
00:46:55,859 --> 00:46:59,099
two and a half rounds and end up with

1055
00:46:59,099 --> 00:47:02,040
zero difference of the setium

1056
00:47:02,040 --> 00:47:05,339
and you know I don't want to go into any

1057
00:47:05,339 --> 00:47:07,619
more details but it should be clear that

1058
00:47:07,619 --> 00:47:10,560
we can then do key recovery because this

1059
00:47:10,560 --> 00:47:12,660
is like we have no difference here no

1060
00:47:12,660 --> 00:47:14,460
difference here in between we have these

1061
00:47:14,460 --> 00:47:17,280
differences and then

1062
00:47:17,280 --> 00:47:19,079
or whatever it takes does it is to

1063
00:47:19,079 --> 00:47:20,880
recovers uh

1064
00:47:20,880 --> 00:47:23,220
any dates for for the last three one

1065
00:47:23,220 --> 00:47:26,160
keys and one byte of 1v7 and then we

1066
00:47:26,160 --> 00:47:30,359
just put forth the remaining pivots

1067
00:47:30,359 --> 00:47:34,680
okay so this is just the idea and then

1068
00:47:34,680 --> 00:47:37,140
our attacks essentially comes in three

1069
00:47:37,140 --> 00:47:39,599
flavors so resetting so the first is

1070
00:47:39,599 --> 00:47:41,640
ciphertext only that means that the

1071
00:47:41,640 --> 00:47:44,460
adversary just e-stop messages he

1072
00:47:44,460 --> 00:47:45,960
doesn't know anything he just has a

1073
00:47:45,960 --> 00:47:48,780
radio and looks what what messages are

1074
00:47:48,780 --> 00:47:49,920
sent

1075
00:47:49,920 --> 00:47:51,720
and

1076
00:47:51,720 --> 00:47:54,300
this works because the the plain text

1077
00:47:54,300 --> 00:47:56,460
has a lot of structure because it's like

1078
00:47:56,460 --> 00:48:01,380
this in in this protocol the

1079
00:48:01,380 --> 00:48:04,200
um call signs I actually repeated so you

1080
00:48:04,200 --> 00:48:08,400
can make use of that to to attack but

1081
00:48:08,400 --> 00:48:11,040
notice that this is not really practical

1082
00:48:11,040 --> 00:48:14,220
but still clearly better than what you

1083
00:48:14,220 --> 00:48:16,980
maybe would or what a trivial attack

1084
00:48:16,980 --> 00:48:20,819
would do like 128 key bits

1085
00:48:20,819 --> 00:48:23,819
so then no implantic means that the

1086
00:48:23,819 --> 00:48:25,260
adversary has some some information

1087
00:48:25,260 --> 00:48:27,780
about the communicating party so let's

1088
00:48:27,780 --> 00:48:29,520
say he knows some of the call signs then

1089
00:48:29,520 --> 00:48:31,500
or take

1090
00:48:31,500 --> 00:48:35,060
is or at first looks rather practical so

1091
00:48:35,060 --> 00:48:38,280
237 data and okay memory is super good

1092
00:48:38,280 --> 00:48:42,180
time to do 56 this is actually so if we

1093
00:48:42,180 --> 00:48:44,760
use a little bit more data our weather

1094
00:48:44,760 --> 00:48:46,680
gets better and then only needs time two

1095
00:48:46,680 --> 00:48:48,780
to e48

1096
00:48:48,780 --> 00:48:51,660
and this is actually like in the shows

1097
00:48:51,660 --> 00:48:54,020
and plain text it's the same attack but

1098
00:48:54,020 --> 00:48:56,880
uh obtaining the data is way more easy

1099
00:48:56,880 --> 00:48:58,319
because we don't have to wait for the

1100
00:48:58,319 --> 00:49:00,300
differences to show up but we can just

1101
00:49:00,300 --> 00:49:03,300
pick the Divide input differences and

1102
00:49:03,300 --> 00:49:05,339
this one so the chosen plain text is

1103
00:49:05,339 --> 00:49:07,680
more like a lab setting we actually

1104
00:49:07,680 --> 00:49:09,240
implemented it

1105
00:49:09,240 --> 00:49:11,460
with a little bit more data and then

1106
00:49:11,460 --> 00:49:15,300
only two to 48. and then it takes

1107
00:49:15,300 --> 00:49:17,760
one or two hours to to fully recover the

1108
00:49:17,760 --> 00:49:19,140
key

1109
00:49:19,140 --> 00:49:20,579
and

1110
00:49:20,579 --> 00:49:22,380
okay and then

1111
00:49:22,380 --> 00:49:24,359
this one this chosen ciphertext attack

1112
00:49:24,359 --> 00:49:26,160
which in practice means that you have

1113
00:49:26,160 --> 00:49:29,060
physical access maybe only for a short

1114
00:49:29,060 --> 00:49:32,280
period of time to to a radio that stores

1115
00:49:32,280 --> 00:49:35,339
the key uh it's a boomerang attack and

1116
00:49:35,339 --> 00:49:37,680
I'm not going to to explain it in detail

1117
00:49:37,680 --> 00:49:39,180
but if you look at this

1118
00:49:39,180 --> 00:49:41,099
I hope that you believe me that the

1119
00:49:41,099 --> 00:49:43,079
boomerangs for for the full number of

1120
00:49:43,079 --> 00:49:44,940
rounds and then it's it was a super easy

1121
00:49:44,940 --> 00:49:47,720
key recovery

1122
00:49:47,819 --> 00:49:51,060
um okay so maybe you're wondering uh if

1123
00:49:51,060 --> 00:49:52,500
there's an attack which gives only

1124
00:49:52,500 --> 00:49:55,680
slightly more data but uh

1125
00:49:55,680 --> 00:50:00,300
is 228 times faster why are then those

1126
00:50:00,300 --> 00:50:01,980
numbers

1127
00:50:01,980 --> 00:50:03,060
um

1128
00:50:03,060 --> 00:50:05,400
in this table in stock and that's just

1129
00:50:05,400 --> 00:50:07,980
because data is what is really important

1130
00:50:07,980 --> 00:50:10,140
for whether you can actually apply these

1131
00:50:10,140 --> 00:50:13,920
attacks in practice or not so here is

1132
00:50:13,920 --> 00:50:15,900
some figure which shows the the

1133
00:50:15,900 --> 00:50:18,180
probability that our attack actually

1134
00:50:18,180 --> 00:50:20,640
succeeds so this is essentially the

1135
00:50:20,640 --> 00:50:22,220
probability that

1136
00:50:22,220 --> 00:50:25,619
we have enough or we have good data so

1137
00:50:25,619 --> 00:50:27,780
the data that our attack actually needs

1138
00:50:27,780 --> 00:50:29,460
so the the input difference and the

1139
00:50:29,460 --> 00:50:30,960
output difference are correct

1140
00:50:30,960 --> 00:50:33,359
and then on the x-axis we have the time

1141
00:50:33,359 --> 00:50:37,140
that we are eavesdropping messages and

1142
00:50:37,140 --> 00:50:39,180
then we have this for a different number

1143
00:50:39,180 --> 00:50:42,960
of messages per per minute and notice

1144
00:50:42,960 --> 00:50:45,420
this area so here Thousand Years 100

1145
00:50:45,420 --> 00:50:48,260
years 10 years one year

1146
00:50:48,260 --> 00:50:51,420
so okay if you have thousand years and

1147
00:50:51,420 --> 00:50:53,700
there are 10 messages per minute then

1148
00:50:53,700 --> 00:50:55,980
our attack will work but that's maybe

1149
00:50:55,980 --> 00:50:57,119
not exactly what you would call

1150
00:50:57,119 --> 00:50:59,400
practical

1151
00:50:59,400 --> 00:51:00,780
um and also

1152
00:51:00,780 --> 00:51:02,819
these number like one message per minute

1153
00:51:02,819 --> 00:51:05,880
is all already kind of kind of a high

1154
00:51:05,880 --> 00:51:06,900
traffic

1155
00:51:06,900 --> 00:51:08,579
so

1156
00:51:08,579 --> 00:51:11,220
after one year if there are 10 messages

1157
00:51:11,220 --> 00:51:14,700
that's like a lot of traffic then the

1158
00:51:14,700 --> 00:51:16,260
success probability is around one

1159
00:51:16,260 --> 00:51:17,880
percent I think so

1160
00:51:17,880 --> 00:51:19,980
that's not practical in the sense that

1161
00:51:19,980 --> 00:51:23,400
we could just you know get a radio and

1162
00:51:23,400 --> 00:51:27,059
get or e-stop messages and run our

1163
00:51:27,059 --> 00:51:29,460
attack that was not possible but it's

1164
00:51:29,460 --> 00:51:32,160
also not what you would expect or what

1165
00:51:32,160 --> 00:51:33,839
you would hope for if you are doing

1166
00:51:33,839 --> 00:51:36,119
equipment right

1167
00:51:36,119 --> 00:51:39,000
Okay so

1168
00:51:39,000 --> 00:51:42,240
um yeah let me conclude

1169
00:51:42,240 --> 00:51:46,020
so after is or half of 24 as far from

1170
00:51:46,020 --> 00:51:49,260
providing 128 bits of security and

1171
00:51:49,260 --> 00:51:51,420
therefore we advise against the usage of

1172
00:51:51,420 --> 00:51:54,960
any Alpha variant why of any uh

1173
00:51:54,960 --> 00:51:58,079
because we showed it it's not and you

1174
00:51:58,079 --> 00:52:00,300
should cannot just take AES and shrink

1175
00:52:00,300 --> 00:52:01,680
it down and think that it's still

1176
00:52:01,680 --> 00:52:03,839
secured it's not how it's done

1177
00:52:03,839 --> 00:52:05,460
and

1178
00:52:05,460 --> 00:52:08,819
so regarding possible future work of

1179
00:52:08,819 --> 00:52:11,040
course it it's obvious to to have a look

1180
00:52:11,040 --> 00:52:13,859
at how to 48 and half to 96 so the the

1181
00:52:13,859 --> 00:52:16,200
variance with larger States

1182
00:52:16,200 --> 00:52:18,780
and regarding our attacks like I just

1183
00:52:18,780 --> 00:52:21,480
explained the limiting factor is the

1184
00:52:21,480 --> 00:52:23,400
amount of data that our attack needs so

1185
00:52:23,400 --> 00:52:27,319
improving this would make it maybe like

1186
00:52:27,319 --> 00:52:29,579
practical in the sense that you can just

1187
00:52:29,579 --> 00:52:32,520
apply it in the real world

1188
00:52:32,520 --> 00:52:34,920
um yeah and it's it's for my side if you

1189
00:52:34,920 --> 00:52:36,599
are interested you can find PayPal and

1190
00:52:36,599 --> 00:52:38,819
code here so our implementation of the

1191
00:52:38,819 --> 00:52:42,619
attacks and yeah thank you

1192
00:52:45,540 --> 00:52:47,520
okay thanks for the talk

1193
00:52:47,520 --> 00:52:51,859
uh any questions in Beijing

1194
00:52:57,839 --> 00:53:02,540
any questions any questions in copy

1195
00:53:02,579 --> 00:53:05,059
question

1196
00:53:09,900 --> 00:53:12,660
do we have any idea who actually came up

1197
00:53:12,660 --> 00:53:14,640
with this

1198
00:53:14,640 --> 00:53:15,480
um

1199
00:53:15,480 --> 00:53:19,140
yes there was maybe Marcos can jump in I

1200
00:53:19,140 --> 00:53:21,599
think they will decipher was proposed at

1201
00:53:21,599 --> 00:53:23,599
a conference

1202
00:53:23,599 --> 00:53:27,920
regarding high frequency technology

1203
00:53:29,339 --> 00:53:32,220
yes so uh I can't remember the name of

1204
00:53:32,220 --> 00:53:34,559
the top of my head right now but the guy

1205
00:53:34,559 --> 00:53:36,420
who constructed this was the same guy

1206
00:53:36,420 --> 00:53:38,099
who constructed so dark

1207
00:53:38,099 --> 00:53:40,920
and he's a professor I think in New

1208
00:53:40,920 --> 00:53:43,440
Mexico that's worked a lot on the high

1209
00:53:43,440 --> 00:53:46,740
frequency link establishment parts so

1210
00:53:46,740 --> 00:53:49,740
that's his expertise and there is

1211
00:53:49,740 --> 00:53:51,660
something that looks like a design

1212
00:53:51,660 --> 00:53:53,339
rational document for this that was

1213
00:53:53,339 --> 00:53:56,640
presented in this high frequency radio

1214
00:53:56,640 --> 00:53:58,619
conference in Sweden a couple of years

1215
00:53:58,619 --> 00:54:02,040
ago which me and Lucas has a copy if

1216
00:54:02,040 --> 00:54:03,660
anyone's interested because it's kind of

1217
00:54:03,660 --> 00:54:06,558
hard to find that paper

1218
00:54:15,180 --> 00:54:16,980
I think my question is for you Marcus do

1219
00:54:16,980 --> 00:54:20,119
you know if this is deployed

1220
00:54:23,099 --> 00:54:26,359
or dancer no

1221
00:54:27,420 --> 00:54:30,839
no I don't know so the thing is we could

1222
00:54:30,839 --> 00:54:32,540
theoretically

1223
00:54:32,540 --> 00:54:35,940
collect these messages of the air

1224
00:54:35,940 --> 00:54:38,220
and you know it immediately tell us

1225
00:54:38,220 --> 00:54:40,079
they're encrypted or not and if they're

1226
00:54:40,079 --> 00:54:42,119
encrypted you know there's no immediate

1227
00:54:42,119 --> 00:54:43,740
way of telling the difference between so

1228
00:54:43,740 --> 00:54:47,339
dark and F Loop we could however try and

1229
00:54:47,339 --> 00:54:50,099
Brute Force so dark since it's a 56-bit

1230
00:54:50,099 --> 00:54:52,020
key and

1231
00:54:52,020 --> 00:54:54,480
then if we if that fails it will be half

1232
00:54:54,480 --> 00:54:56,640
Loop so we could go out there and check

1233
00:54:56,640 --> 00:54:59,359
if we wanted to

1234
00:55:03,900 --> 00:55:07,700
wait let's do some questions

1235
00:55:08,640 --> 00:55:11,040
um and this guy from New Mexico did he

1236
00:55:11,040 --> 00:55:12,720
do something else that we might be

1237
00:55:12,720 --> 00:55:15,558
interested in having a look at

1238
00:55:20,819 --> 00:55:23,339
not that I know of uh maybe maybe we

1239
00:55:23,339 --> 00:55:26,240
should email him and ask

1240
00:55:32,640 --> 00:55:35,160
so in your experimentation so it's

1241
00:55:35,160 --> 00:55:37,619
showing that that one message about one

1242
00:55:37,619 --> 00:55:40,819
minute so that and the is

1243
00:55:40,819 --> 00:55:45,599
just about to 24 bit right correct

1244
00:55:45,599 --> 00:55:48,059
yeah I'm asking about if there is any

1245
00:55:48,059 --> 00:55:50,099
specified mode of operation constantly

1246
00:55:50,099 --> 00:55:53,220
yeah for the this half Loop

1247
00:55:53,220 --> 00:55:55,440
um so this like in the in the protocols

1248
00:55:55,440 --> 00:55:57,900
or any link establish link establishment

1249
00:55:57,900 --> 00:55:59,700
protocol there in the beginning is a

1250
00:55:59,700 --> 00:56:03,240
freeway handshake and I think each is

1251
00:56:03,240 --> 00:56:07,619
consisting of uh three words and all of

1252
00:56:07,619 --> 00:56:10,880
them 20 bits so that should be in total

1253
00:56:10,880 --> 00:56:14,339
96 was something

1254
00:56:14,339 --> 00:56:16,619
yeah and then I think in the very end

1255
00:56:16,619 --> 00:56:18,480
there's like a finish finish message

1256
00:56:18,480 --> 00:56:21,660
again encrypted with half two yeah yeah

1257
00:56:21,660 --> 00:56:23,700
I'm just wondering why uh that's so

1258
00:56:23,700 --> 00:56:26,400
small yeah broke and yeah

1259
00:56:26,400 --> 00:56:28,559
so okay thank you

1260
00:56:28,559 --> 00:56:31,619
so maybe something about this I again

1261
00:56:31,619 --> 00:56:33,660
Marcos has a lot more expertise about

1262
00:56:33,660 --> 00:56:36,000
these high frequencies that's what uh

1263
00:56:36,000 --> 00:56:39,180
these lingers link establishment stuff

1264
00:56:39,180 --> 00:56:41,460
is kind of old so I think it's from the

1265
00:56:41,460 --> 00:56:43,920
70s or 80s some somewhere around there

1266
00:56:43,920 --> 00:56:45,240
yeah

1267
00:56:45,240 --> 00:56:48,259
okay thank you

1268
00:56:52,319 --> 00:56:55,520
are there any other questions

1269
00:56:58,020 --> 00:57:01,740
I think no questions in Kobe

1270
00:57:01,740 --> 00:57:05,598
oh okay any questions online

1271
00:57:06,180 --> 00:57:09,720
so if there's no questions I think we

1272
00:57:09,720 --> 00:57:12,119
can conclude this session so let's thank

1273
00:57:12,119 --> 00:57:15,020
all the speakers again

