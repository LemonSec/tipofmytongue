1
00:00:04,170 --> 00:00:11,050
thank you so I'm Thomas Watson

2
00:00:07,870 --> 00:00:12,879
I'm a wyvern area stat VM<font color="#E5E5E5"> ray</font><font color="#CCCCCC"> and I'm</font>

3
00:00:11,050 --> 00:00:15,460
going<font color="#CCCCCC"> to talk about</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> evolution of the</font>

4
00:00:12,880 --> 00:00:17,610
<font color="#CCCCCC">current car brands</font><font color="#E5E5E5"> over and I lost the</font>

5
00:00:15,460 --> 00:00:17,610
signal

6
00:00:24,150 --> 00:00:30,640
okay so first<font color="#E5E5E5"> I want to say</font><font color="#CCCCCC"> vice</font>

7
00:00:27,250 --> 00:00:32,738
interesting<font color="#E5E5E5"> first of</font><font color="#CCCCCC"> all it dominates</font>

8
00:00:30,640 --> 00:00:35,410
<font color="#CCCCCC">Durant's</font><font color="#E5E5E5"> of our market currently it's</font>

9
00:00:32,738 --> 00:00:40,000
basically the<font color="#CCCCCC"> only ransomware as a</font>

10
00:00:35,410 --> 00:00:41,500
service this<font color="#CCCCCC"> year</font><font color="#E5E5E5"> the second thing</font>

11
00:00:40,000 --> 00:00:44,680
that's interesting about it is that<font color="#E5E5E5"> has</font>

12
00:00:41,500 --> 00:00:47,590
it has an edge I like development it

13
00:00:44,680 --> 00:00:51,340
implements frequent and quick changes

14
00:00:47,590 --> 00:00:53,710
and<font color="#E5E5E5"> it started out as the most basic</font>

15
00:00:51,340 --> 00:00:56,050
possible<font color="#CCCCCC"> runs over in January</font><font color="#E5E5E5"> and now</font>

16
00:00:53,710 --> 00:00:59,079
it's more interesting<font color="#E5E5E5"> it uses multiple</font>

17
00:00:56,050 --> 00:01:00,669
exploits<font color="#E5E5E5"> and</font><font color="#CCCCCC"> tracking it gets more</font>

18
00:00:59,079 --> 00:01:05,530
<font color="#CCCCCC">challenging because of</font><font color="#E5E5E5"> the frequent</font>

19
00:01:00,670 --> 00:01:08,140
updates also<font color="#E5E5E5"> it's uncommon for a</font>

20
00:01:05,530 --> 00:01:11,710
commercial my work to use exploits they

21
00:01:08,140 --> 00:01:15,760
are<font color="#E5E5E5"> Marvel authors are usually software</font>

22
00:01:11,710 --> 00:01:17,679
developers<font color="#E5E5E5"> and</font><font color="#CCCCCC"> that hackers so even if</font>

23
00:01:15,760 --> 00:01:19,900
there's an existing<font color="#E5E5E5"> POC they are usually</font>

24
00:01:17,680 --> 00:01:24,189
<font color="#CCCCCC">not</font><font color="#E5E5E5"> able to implement it in their own</font>

25
00:01:19,900 --> 00:01:27,430
<font color="#E5E5E5">mother</font><font color="#CCCCCC"> that makes</font><font color="#E5E5E5"> it even more</font>

26
00:01:24,189 --> 00:01:32,020
interesting<font color="#E5E5E5"> that in August</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> burned a</font>

27
00:01:27,430 --> 00:01:36,189
zero day so they found<font color="#E5E5E5"> zero day in a in</font>

28
00:01:32,020 --> 00:01:39,699
an antivirus<font color="#CCCCCC"> software</font><font color="#E5E5E5"> driver and they</font>

29
00:01:36,189 --> 00:01:43,630
managed<font color="#CCCCCC"> to crash it we'll talk</font><font color="#E5E5E5"> a lot</font>

30
00:01:39,700 --> 00:01:45,490
more about<font color="#E5E5E5"> that zero day</font><font color="#CCCCCC"> it's</font><font color="#E5E5E5"> will try</font>

31
00:01:43,630 --> 00:01:48,039
to<font color="#E5E5E5"> analyze it a bit more in detail to</font>

32
00:01:45,490 --> 00:01:51,520
<font color="#CCCCCC">find out how advanced the group really</font>

33
00:01:48,040 --> 00:01:54,850
<font color="#E5E5E5">is so the topics I'm</font><font color="#CCCCCC"> going to talk about</font>

34
00:01:51,520 --> 00:01:58,298
<font color="#E5E5E5">is the business model</font><font color="#CCCCCC"> that they use</font>

35
00:01:54,850 --> 00:02:00,399
ransomware<font color="#CCCCCC"> the service I'm talking about</font>

36
00:01:58,299 --> 00:02:03,909
I'm talking<font color="#E5E5E5"> about the delivery methods</font>

37
00:02:00,399 --> 00:02:07,110
that they used to get get the<font color="#CCCCCC"> infection</font>

38
00:02:03,909 --> 00:02:09,940
to the victim talk<font color="#E5E5E5"> about the</font><font color="#CCCCCC"> Packer</font><font color="#E5E5E5"> and</font>

39
00:02:07,110 --> 00:02:13,239
<font color="#E5E5E5">the evolution of the</font><font color="#CCCCCC"> payloads over</font><font color="#E5E5E5"> the</font>

40
00:02:09,940 --> 00:02:16,390
year and finally<font color="#E5E5E5"> I will</font><font color="#CCCCCC"> analyze the</font><font color="#E5E5E5"> zero</font>

41
00:02:13,239 --> 00:02:21,990
<font color="#E5E5E5">day so to get you the</font>

42
00:02:16,390 --> 00:02:21,989
morning<font color="#E5E5E5"> kind of driver exploit analysis</font>

43
00:02:22,230 --> 00:02:27,970
<font color="#CCCCCC">so the business</font><font color="#E5E5E5"> model is ransomware is a</font>

44
00:02:24,730 --> 00:02:31,540
service this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> specific version of</font>

45
00:02:27,970 --> 00:02:36,250
<font color="#E5E5E5">the</font><font color="#CCCCCC"> library</font><font color="#E5E5E5"> service which is usually</font>

46
00:02:31,540 --> 00:02:38,890
used to<font color="#E5E5E5"> distribute my work is this it</font>

47
00:02:36,250 --> 00:02:40,990
the business model separates the

48
00:02:38,890 --> 00:02:43,839
developers of<font color="#E5E5E5"> the malware and the</font>

49
00:02:40,990 --> 00:02:48,100
attackers the developers create<font color="#CCCCCC"> an</font>

50
00:02:43,840 --> 00:02:52,989
<font color="#CCCCCC">easy-to-use service where the attackers</font>

51
00:02:48,100 --> 00:02:55,959
<font color="#E5E5E5">their affiliates just need to use web UI</font>

52
00:02:52,989 --> 00:02:57,730
<font color="#E5E5E5">and they need to click</font><font color="#CCCCCC"> around</font><font color="#E5E5E5"> to launch</font>

53
00:02:55,959 --> 00:03:00,610
<font color="#CCCCCC">attacks they don't need to be technical</font>

54
00:02:57,730 --> 00:03:04,660
at all or the technical<font color="#CCCCCC"> development is</font>

55
00:03:00,610 --> 00:03:08,290
on<font color="#E5E5E5"> the side of the developer this has</font>

56
00:03:04,660 --> 00:03:12,790
been our really successful<font color="#CCCCCC"> and often</font>

57
00:03:08,290 --> 00:03:17,649
used business in the past few<font color="#CCCCCC"> years but</font>

58
00:03:12,790 --> 00:03:21,970
it's slowly going<font color="#E5E5E5"> out of out</font><font color="#CCCCCC"> of fashion</font>

59
00:03:17,650 --> 00:03:28,570
<font color="#E5E5E5">this</font><font color="#CCCCCC"> year partially</font><font color="#E5E5E5"> because</font><font color="#CCCCCC"> Ganz crab</font>

60
00:03:21,970 --> 00:03:30,970
took<font color="#E5E5E5"> over the whole</font><font color="#CCCCCC"> thing so you know</font>

61
00:03:28,570 --> 00:03:34,750
it's being distributed in<font color="#E5E5E5"> a Russian</font>

62
00:03:30,970 --> 00:03:37,870
<font color="#CCCCCC">forum where they are trying</font><font color="#E5E5E5"> to get you</font>

63
00:03:34,750 --> 00:03:40,959
affiliates<font color="#E5E5E5"> and they are huge stars there</font>

64
00:03:37,870 --> 00:03:47,980
there's a line waiting<font color="#E5E5E5"> to be a member</font><font color="#CCCCCC"> of</font>

65
00:03:40,959 --> 00:03:49,930
their little<font color="#CCCCCC"> Club and</font><font color="#E5E5E5"> the attacker would</font>

66
00:03:47,980 --> 00:03:52,420
<font color="#E5E5E5">get a bad panel like</font><font color="#CCCCCC"> this where they</font>

67
00:03:49,930 --> 00:03:57,150
need to<font color="#CCCCCC"> click around they have a bunch</font>

68
00:03:52,420 --> 00:03:57,149
of<font color="#CCCCCC"> information</font><font color="#E5E5E5"> about their victims</font><font color="#CCCCCC"> like</font>

69
00:03:58,350 --> 00:04:05,530
<font color="#CCCCCC">what is their IP what's what operating</font>

70
00:04:02,650 --> 00:04:08,440
system<font color="#CCCCCC"> they use</font><font color="#E5E5E5"> did they yet start</font><font color="#CCCCCC"> dear</font>

71
00:04:05,530 --> 00:04:11,530
has the encryption yet started or have

72
00:04:08,440 --> 00:04:17,620
they paid yet there's also a support

73
00:04:11,530 --> 00:04:19,180
system where they<font color="#CCCCCC"> can get support the</font>

74
00:04:17,620 --> 00:04:22,180
attackers can get support<font color="#CCCCCC"> from the</font>

75
00:04:19,180 --> 00:04:25,660
developers or they can provide support

76
00:04:22,180 --> 00:04:27,400
<font color="#CCCCCC">to</font><font color="#E5E5E5"> the victims</font><font color="#CCCCCC"> so if their victim wants</font>

77
00:04:25,660 --> 00:04:29,929
to pay but doesn't know how<font color="#CCCCCC"> to purchase</font>

78
00:04:27,400 --> 00:04:36,558
cryptocurrency<font color="#E5E5E5"> then</font>

79
00:04:29,929 --> 00:04:38,779
they help them<font color="#E5E5E5"> out</font><font color="#CCCCCC"> so the next thing to</font>

80
00:04:36,559 --> 00:04:41,360
<font color="#CCCCCC">talk about is the delivery method at</font>

81
00:04:38,779 --> 00:04:44,419
this point the attacker has the marver

82
00:04:41,360 --> 00:04:49,639
but they need to<font color="#E5E5E5"> need some</font><font color="#CCCCCC"> way to</font><font color="#E5E5E5"> get it</font>

83
00:04:44,419 --> 00:04:51,919
<font color="#CCCCCC">to the victim machine reliably these</font>

84
00:04:49,639 --> 00:04:55,599
delivery methods are achieved through

85
00:04:51,919 --> 00:04:58,369
alliances<font color="#E5E5E5"> the</font><font color="#CCCCCC"> authors of the malware</font>

86
00:04:55,599 --> 00:05:00,529
<font color="#E5E5E5">don't create the delivery methods those</font>

87
00:04:58,369 --> 00:05:02,989
are created<font color="#E5E5E5"> by some other developers and</font>

88
00:05:00,529 --> 00:05:07,249
they make some alliances with these

89
00:05:02,989 --> 00:05:10,758
other groups so the most common<font color="#E5E5E5"> way to</font>

90
00:05:07,249 --> 00:05:13,729
<font color="#CCCCCC">deliberate was</font><font color="#E5E5E5"> yeah we</font><font color="#CCCCCC"> are email</font>

91
00:05:10,759 --> 00:05:17,769
attachments they attached various

92
00:05:13,729 --> 00:05:21,110
downloaders to it in JavaScript<font color="#CCCCCC"> docx or</font>

93
00:05:17,769 --> 00:05:28,689
<font color="#CCCCCC">sometimes encrypted</font><font color="#E5E5E5"> talks</font><font color="#CCCCCC"> sometimes more</font>

94
00:05:21,110 --> 00:05:32,749
<font color="#CCCCCC">convoluted</font><font color="#E5E5E5"> ways to download the</font><font color="#CCCCCC"> axe' but</font>

95
00:05:28,689 --> 00:05:34,819
usually using attachments they also used

96
00:05:32,749 --> 00:05:40,249
drive-by download via Web browser

97
00:05:34,819 --> 00:05:43,339
exploits and more recently they mostly

98
00:05:40,249 --> 00:05:48,619
<font color="#E5E5E5">switch to brute forcing RDP which is now</font>

99
00:05:43,339 --> 00:05:55,089
the more trendy way<font color="#E5E5E5"> on the on the</font>

100
00:05:48,619 --> 00:05:58,039
underground forums so simple document

101
00:05:55,089 --> 00:06:02,419
<font color="#CCCCCC">downloader would</font><font color="#E5E5E5"> look like this when the</font>

102
00:05:58,039 --> 00:06:06,938
victim opens it it s<font color="#E5E5E5"> ask them to enable</font>

103
00:06:02,419 --> 00:06:12,378
macros and when the macros are enabled

104
00:06:06,939 --> 00:06:15,409
it executes this 800 Ryan<font color="#E5E5E5"> VB script</font>

105
00:06:12,379 --> 00:06:19,849
<font color="#E5E5E5">which</font><font color="#CCCCCC"> is basically just a string the</font>

106
00:06:15,409 --> 00:06:22,069
obfuscator it<font color="#E5E5E5"> like changes the case and</font>

107
00:06:19,849 --> 00:06:24,949
<font color="#E5E5E5">advance them to each other reverses it</font>

108
00:06:22,069 --> 00:06:29,029
and<font color="#CCCCCC"> does it in loops it for 800 lines</font>

109
00:06:24,949 --> 00:06:32,089
and finally comes up with a<font color="#CCCCCC"> powershell</font>

110
00:06:29,029 --> 00:06:37,980
one-liner that<font color="#E5E5E5"> downloads and executes</font>

111
00:06:32,089 --> 00:06:41,080
<font color="#E5E5E5">them are so more</font>

112
00:06:37,980 --> 00:06:45,520
<font color="#CCCCCC">tricky way to deliver it is just by</font>

113
00:06:41,080 --> 00:06:48,310
encrypting this<font color="#CCCCCC"> dog</font><font color="#E5E5E5"> and providing the</font><font color="#CCCCCC"> D</font>

114
00:06:45,520 --> 00:06:51,460
<font color="#E5E5E5">password inside the</font><font color="#CCCCCC"> email which is</font>

115
00:06:48,310 --> 00:06:52,960
useful if<font color="#E5E5E5"> the victim has an email</font>

116
00:06:51,460 --> 00:06:56,650
appliance or something that scanning

117
00:06:52,960 --> 00:06:58,810
attachments because the encrypt because

118
00:06:56,650 --> 00:07:02,859
the<font color="#CCCCCC"> attachment here will be just</font><font color="#E5E5E5"> an</font>

119
00:06:58,810 --> 00:07:05,290
encrypted blob and the email appliance

120
00:07:02,860 --> 00:07:07,390
won't really be able<font color="#E5E5E5"> to</font><font color="#CCCCCC"> extract</font><font color="#E5E5E5"> the</font>

121
00:07:05,290 --> 00:07:13,870
password and decrypt it before it

122
00:07:07,390 --> 00:07:15,669
reaches the<font color="#E5E5E5"> before the victim open C so</font>

123
00:07:13,870 --> 00:07:19,210
another common method was browser

124
00:07:15,670 --> 00:07:21,130
exploit<font color="#CCCCCC"> kits these are also separate</font>

125
00:07:19,210 --> 00:07:24,159
<font color="#E5E5E5">services which</font><font color="#CCCCCC"> have been around</font><font color="#E5E5E5"> for many</font>

126
00:07:21,130 --> 00:07:28,750
years<font color="#E5E5E5"> developing different strains of</font>

127
00:07:24,160 --> 00:07:32,260
Marber<font color="#CCCCCC"> an exploit kits a browser exploit</font>

128
00:07:28,750 --> 00:07:35,710
kit contains already known<font color="#E5E5E5"> browser</font>

129
00:07:32,260 --> 00:07:38,920
exploits on the server<font color="#E5E5E5"> and when a web</font>

130
00:07:35,710 --> 00:07:41,979
server makes<font color="#CCCCCC"> a</font><font color="#E5E5E5"> request when a when a web</font>

131
00:07:38,920 --> 00:07:44,380
server gets a request<font color="#CCCCCC"> then the user</font>

132
00:07:41,980 --> 00:07:47,500
<font color="#E5E5E5">agent is</font><font color="#CCCCCC"> parsed and based on the user</font>

133
00:07:44,380 --> 00:07:49,890
agent<font color="#CCCCCC"> it decides which exploit to</font>

134
00:07:47,500 --> 00:07:53,020
deliver these exploits are usually

135
00:07:49,890 --> 00:07:55,740
expressed<font color="#E5E5E5"> for outdated Internet Explorer</font>

136
00:07:53,020 --> 00:07:59,380
<font color="#E5E5E5">or outdated Flash Player so they</font>

137
00:07:55,740 --> 00:08:02,350
shouldn't usually work<font color="#CCCCCC"> if the browser is</font>

138
00:07:59,380 --> 00:08:04,120
<font color="#E5E5E5">properly out updating but in some</font>

139
00:08:02,350 --> 00:08:07,090
environments the browser refresh<font color="#CCCCCC"> pair</font><font color="#E5E5E5"> is</font>

140
00:08:04,120 --> 00:08:08,530
not out updating so they are still

141
00:08:07,090 --> 00:08:11,530
around<font color="#CCCCCC"> this exploit gets a steer around</font>

142
00:08:08,530 --> 00:08:15,489
just much much fewer than a few<font color="#CCCCCC"> years</font>

143
00:08:11,530 --> 00:08:18,940
<font color="#E5E5E5">ago and there's even a new one this</font><font color="#CCCCCC"> year</font>

144
00:08:15,490 --> 00:08:22,480
it's called<font color="#E5E5E5"> fallout so one of these</font>

145
00:08:18,940 --> 00:08:24,820
<font color="#CCCCCC">popular exploit kits was Rick</font><font color="#E5E5E5"> on my</font>

146
00:08:22,480 --> 00:08:28,480
execution it used<font color="#CCCCCC"> a known Flash Player</font>

147
00:08:24,820 --> 00:08:31,719
exploit which is use of the free runner

148
00:08:28,480 --> 00:08:37,060
ability inside flash players<font color="#CCCCCC"> DRM</font>

149
00:08:31,720 --> 00:08:39,870
implementation<font color="#CCCCCC"> so it needs an</font><font color="#E5E5E5"> SPF file</font>

150
00:08:37,059 --> 00:08:42,429
which is an<font color="#E5E5E5"> ActionScript inside and this</font>

151
00:08:39,870 --> 00:08:45,340
<font color="#CCCCCC">it</font><font color="#E5E5E5"> was weird because it</font><font color="#CCCCCC"> was partly</font>

152
00:08:42,429 --> 00:08:49,030
obfuscated but the relevant<font color="#CCCCCC"> part was not</font>

153
00:08:45,340 --> 00:08:51,400
<font color="#CCCCCC">associated and it also used debug</font>

154
00:08:49,030 --> 00:08:53,230
symbols<font color="#CCCCCC"> so the part that loud</font>

155
00:08:51,400 --> 00:08:58,660
the use after free vulnerability was

156
00:08:53,230 --> 00:09:03,190
just called<font color="#CCCCCC"> UAF generator and the</font>

157
00:08:58,660 --> 00:09:05,500
currently common method is<font color="#E5E5E5"> RDP they are</font>

158
00:09:03,190 --> 00:09:10,870
looking for open RDP process and<font color="#E5E5E5"> rule</font>

159
00:09:05,500 --> 00:09:14,530
forcing them which is it enables<font color="#CCCCCC"> them to</font>

160
00:09:10,870 --> 00:09:19,660
do more targeted stuff so they can

161
00:09:14,530 --> 00:09:22,420
<font color="#CCCCCC">target some organization specifically it</font>

162
00:09:19,660 --> 00:09:26,790
allows them to ask for<font color="#CCCCCC"> bigger ransom but</font>

163
00:09:22,420 --> 00:09:29,020
<font color="#E5E5E5">fewer victims it's currently the more</font>

164
00:09:26,790 --> 00:09:29,550
<font color="#E5E5E5">trendy method of delivering around</font>

165
00:09:29,020 --> 00:09:32,470
somewhere

166
00:09:29,550 --> 00:09:37,870
it's<font color="#E5E5E5"> partly because they are hoping for</font>

167
00:09:32,470 --> 00:09:40,210
bigger profits and also because they

168
00:09:37,870 --> 00:09:42,100
like<font color="#CCCCCC"> to feel like</font><font color="#E5E5E5"> hackers but they don't</font>

169
00:09:40,210 --> 00:09:44,140
really<font color="#E5E5E5"> know how to properly to any kind</font>

170
00:09:42,100 --> 00:09:48,520
of<font color="#E5E5E5"> hacking but they can do a simple</font>

171
00:09:44,140 --> 00:09:50,370
<font color="#CCCCCC">brute-forcing on an RDP</font><font color="#E5E5E5"> port so it's</font>

172
00:09:48,520 --> 00:09:55,890
interesting how they are getting<font color="#E5E5E5"> the</font>

173
00:09:50,370 --> 00:09:59,500
<font color="#E5E5E5">open RDP ports</font><font color="#CCCCCC"> they are probably</font><font color="#E5E5E5"> not</font>

174
00:09:55,890 --> 00:10:01,210
scanning<font color="#E5E5E5"> scanning the whole internet</font>

175
00:09:59,500 --> 00:10:06,450
themselves but they are likely<font color="#E5E5E5"> using</font>

176
00:10:01,210 --> 00:10:10,180
<font color="#CCCCCC">shodhan</font><font color="#E5E5E5"> which is a search</font><font color="#CCCCCC"> engine for</font>

177
00:10:06,450 --> 00:10:12,820
security related stuff<font color="#CCCCCC"> and if you search</font>

178
00:10:10,180 --> 00:10:13,449
<font color="#CCCCCC">for</font><font color="#E5E5E5"> remote desktop you will find</font><font color="#CCCCCC"> 2.5</font>

179
00:10:12,820 --> 00:10:15,640
million

180
00:10:13,450 --> 00:10:20,440
open RDP ports which you can then<font color="#E5E5E5"> brute</font>

181
00:10:15,640 --> 00:10:21,689
<font color="#E5E5E5">force and so I also want to talk</font><font color="#CCCCCC"> about</font>

182
00:10:20,440 --> 00:10:25,330
the<font color="#CCCCCC"> backer</font>

183
00:10:21,690 --> 00:10:28,270
now that the now<font color="#E5E5E5"> that this</font><font color="#CCCCCC"> sample is</font>

184
00:10:25,330 --> 00:10:30,700
delivered it needs to evade<font color="#E5E5E5"> antivirus</font>

185
00:10:28,270 --> 00:10:33,610
and it needs<font color="#CCCCCC"> to make analyzes of it</font>

186
00:10:30,700 --> 00:10:39,970
harder especially automated<font color="#E5E5E5"> analyzes and</font>

187
00:10:33,610 --> 00:10:42,910
for<font color="#CCCCCC"> these marvered uses packers so I</font>

188
00:10:39,970 --> 00:10:45,340
want<font color="#E5E5E5"> to I have no time to analyze the</font>

189
00:10:42,910 --> 00:10:47,890
whole<font color="#CCCCCC"> Packer</font><font color="#E5E5E5"> but I want to highlight</font>

190
00:10:45,340 --> 00:10:50,500
some techniques<font color="#CCCCCC"> that it uses this is a</font>

191
00:10:47,890 --> 00:10:55,530
<font color="#E5E5E5">technique called</font><font color="#CCCCCC"> API hammering it's a</font>

192
00:10:50,500 --> 00:10:58,090
sandbox<font color="#E5E5E5"> evasion technique in a sandbox</font>

193
00:10:55,530 --> 00:11:01,300
<font color="#CCCCCC">sample would get launched</font><font color="#E5E5E5"> inside a</font>

194
00:10:58,090 --> 00:11:04,390
virtual machine<font color="#CCCCCC"> and it would run for</font><font color="#E5E5E5"> a</font>

195
00:11:01,300 --> 00:11:07,270
few minutes and

196
00:11:04,390 --> 00:11:10,390
the sandbox<font color="#CCCCCC"> would analyze the</font><font color="#E5E5E5"> results of</font>

197
00:11:07,270 --> 00:11:15,160
what it<font color="#E5E5E5"> what behavior it executed inside</font>

198
00:11:10,390 --> 00:11:18,819
the VM<font color="#E5E5E5"> so one way to bypass it</font><font color="#CCCCCC"> is to</font>

199
00:11:15,160 --> 00:11:20,740
wait<font color="#E5E5E5"> so try to reach the timeout but if</font>

200
00:11:18,820 --> 00:11:23,680
they<font color="#E5E5E5"> would call a simple sleep function</font>

201
00:11:20,740 --> 00:11:25,510
<font color="#E5E5E5">that would be mitigated by</font><font color="#CCCCCC"> the sandbox</font>

202
00:11:23,680 --> 00:11:29,680
<font color="#E5E5E5">and the sleep wouldn't have been</font>

203
00:11:25,510 --> 00:11:32,200
executed<font color="#E5E5E5"> which is why they are trying to</font>

204
00:11:29,680 --> 00:11:34,390
just do a long loop where they are

205
00:11:32,200 --> 00:11:36,780
calling a function<font color="#E5E5E5"> or incrementing a</font>

206
00:11:34,390 --> 00:11:40,630
variable over and over again many<font color="#CCCCCC"> times</font>

207
00:11:36,780 --> 00:11:43,209
but mitigation for<font color="#E5E5E5"> this also exists</font>

208
00:11:40,630 --> 00:11:45,340
because these unnecessary loops

209
00:11:43,210 --> 00:11:49,600
unnecessary loops can<font color="#E5E5E5"> be</font><font color="#CCCCCC"> detected</font><font color="#E5E5E5"> and</font>

210
00:11:45,340 --> 00:11:52,240
automatically skipped so what they

211
00:11:49,600 --> 00:11:59,800
implement here<font color="#E5E5E5"> is that they try to</font>

212
00:11:52,240 --> 00:12:02,920
obfuscate the the condition and also<font color="#E5E5E5"> do</font>

213
00:11:59,800 --> 00:12:09,099
a single useful function<font color="#CCCCCC"> call inside the</font>

214
00:12:02,920 --> 00:12:12,219
<font color="#CCCCCC">loop</font><font color="#E5E5E5"> so it cause causes loop</font><font color="#CCCCCC"> 20</font><font color="#E5E5E5"> million</font>

215
00:12:09,100 --> 00:12:15,610
times<font color="#CCCCCC"> but in one</font><font color="#E5E5E5"> of the iterations it</font>

216
00:12:12,220 --> 00:12:18,340
also<font color="#E5E5E5"> loads a library so this library is</font>

217
00:12:15,610 --> 00:12:20,650
<font color="#CCCCCC">neat later</font><font color="#E5E5E5"> so if the library is not</font>

218
00:12:18,340 --> 00:12:25,510
loaded<font color="#CCCCCC"> and the model</font><font color="#E5E5E5"> won't work</font><font color="#CCCCCC"> so the</font>

219
00:12:20,650 --> 00:12:28,000
loop<font color="#E5E5E5"> cannot be skipped easily simple map</font>

220
00:12:25,510 --> 00:12:30,850
method<font color="#CCCCCC"> it uses</font><font color="#E5E5E5"> just the post</font><font color="#CCCCCC"> occation on</font>

221
00:12:28,000 --> 00:12:33,370
the stack<font color="#E5E5E5"> it moves the opposite it</font>

222
00:12:30,850 --> 00:12:35,770
coding for<font color="#E5E5E5"> byte chunks of the stack it</font>

223
00:12:33,370 --> 00:12:40,810
adds and subtracts constants<font color="#E5E5E5"> from it to</font>

224
00:12:35,770 --> 00:12:43,600
get the final<font color="#E5E5E5"> payload and in a more</font>

225
00:12:40,810 --> 00:12:48,640
recent version they added a simple<font color="#E5E5E5"> anti</font>

226
00:12:43,600 --> 00:12:52,360
disassembly trick<font color="#CCCCCC"> right they this is a</font>

227
00:12:48,640 --> 00:12:54,730
van<font color="#CCCCCC"> known trick that is a method of</font>

228
00:12:52,360 --> 00:12:57,910
<font color="#E5E5E5">control flow food station the</font><font color="#CCCCCC"> cool</font>

229
00:12:54,730 --> 00:13:02,440
<font color="#E5E5E5">instruction just jumps to the</font><font color="#CCCCCC"> next</font>

230
00:12:57,910 --> 00:13:05,020
function the<font color="#E5E5E5"> next instruction and also</font>

231
00:13:02,440 --> 00:13:08,170
<font color="#CCCCCC">adds</font><font color="#E5E5E5"> the address of the next instruction</font>

232
00:13:05,020 --> 00:13:10,630
to the stack<font color="#E5E5E5"> and then it can be</font>

233
00:13:08,170 --> 00:13:14,050
incremented<font color="#E5E5E5"> so when</font><font color="#CCCCCC"> Delphis gated it</font>

234
00:13:10,630 --> 00:13:18,439
looks like this it just<font color="#E5E5E5"> it changes the</font>

235
00:13:14,050 --> 00:13:23,300
address on the stack it pops it<font color="#E5E5E5"> into a</font>

236
00:13:18,440 --> 00:13:25,550
<font color="#E5E5E5">X and</font><font color="#CCCCCC"> jump stir so this is a pretty old</font>

237
00:13:23,300 --> 00:13:28,069
technique they probably find it by just

238
00:13:25,550 --> 00:13:31,640
googling<font color="#E5E5E5"> anti disassembly and this is</font>

239
00:13:28,070 --> 00:13:33,440
the first result<font color="#E5E5E5"> that they found so it</font>

240
00:13:31,640 --> 00:13:36,370
makes sense<font color="#E5E5E5"> that when is figured out</font>

241
00:13:33,440 --> 00:13:40,450
that is complicated to<font color="#CCCCCC"> ACTU Packer that</font>

242
00:13:36,370 --> 00:13:42,860
<font color="#CCCCCC">they try to hire someone else to do it</font>

243
00:13:40,450 --> 00:13:44,840
<font color="#E5E5E5">there are already commercial</font><font color="#CCCCCC"> Packers</font>

244
00:13:42,860 --> 00:13:46,580
available<font color="#E5E5E5"> and they wanted</font><font color="#CCCCCC"> to find</font><font color="#E5E5E5"> out</font>

245
00:13:44,840 --> 00:13:51,080
which one is<font color="#CCCCCC"> the better</font><font color="#E5E5E5"> this one</font>

246
00:13:46,580 --> 00:13:53,750
so they made a competition<font color="#CCCCCC"> so whoever</font>

247
00:13:51,080 --> 00:13:56,690
gets them the best<font color="#E5E5E5"> Packer</font><font color="#CCCCCC"> it will get</font>

248
00:13:53,750 --> 00:14:00,050
<font color="#E5E5E5">recommended to their affiliates and</font>

249
00:13:56,690 --> 00:14:01,280
that's a constant<font color="#E5E5E5"> revenue for the</font>

250
00:14:00,050 --> 00:14:04,189
authors of the<font color="#CCCCCC"> Packer</font>

251
00:14:01,280 --> 00:14:05,860
and it will get more<font color="#CCCCCC"> revenue for the</font>

252
00:14:04,190 --> 00:14:11,540
attackers themselves<font color="#E5E5E5"> so it's a</font>

253
00:14:05,860 --> 00:14:14,900
profitable<font color="#CCCCCC"> alliance for them and that's</font>

254
00:14:11,540 --> 00:14:18,620
<font color="#E5E5E5">basically the Packers current state now</font>

255
00:14:14,900 --> 00:14:21,980
<font color="#E5E5E5">that the the sample is delivered its</font>

256
00:14:18,620 --> 00:14:25,820
unpacked<font color="#CCCCCC"> it might have bypassed security</font>

257
00:14:21,980 --> 00:14:29,660
products and now it's time to execute

258
00:14:25,820 --> 00:14:32,660
the actual<font color="#E5E5E5"> ransomware payload which</font>

259
00:14:29,660 --> 00:14:38,329
evolved a lot since January<font color="#E5E5E5"> and I'm</font>

260
00:14:32,660 --> 00:14:41,600
going to<font color="#E5E5E5"> talk about its evolution now so</font>

261
00:14:38,330 --> 00:14:43,430
it's<font color="#E5E5E5"> starting point</font><font color="#CCCCCC"> is basically what it</font>

262
00:14:41,600 --> 00:14:46,460
does<font color="#CCCCCC"> is basically a constant</font><font color="#E5E5E5"> through all</font>

263
00:14:43,430 --> 00:14:50,120
<font color="#CCCCCC">versions</font><font color="#E5E5E5"> with some minor changes first</font>

264
00:14:46,460 --> 00:14:52,220
it collects<font color="#CCCCCC"> data</font><font color="#E5E5E5"> it this is the data</font>

265
00:14:50,120 --> 00:14:56,990
<font color="#E5E5E5">that's displayed displayed on the web</font>

266
00:14:52,220 --> 00:15:00,740
panel<font color="#E5E5E5"> that the attacker uses it has it</font>

267
00:14:56,990 --> 00:15:04,460
called X the domain<font color="#E5E5E5"> host name processor</font>

268
00:15:00,740 --> 00:15:06,620
<font color="#CCCCCC">named</font><font color="#E5E5E5"> Windows version and collect</font>

269
00:15:04,460 --> 00:15:13,640
<font color="#CCCCCC">currently running antivirus software</font>

270
00:15:06,620 --> 00:15:17,780
world<font color="#CCCCCC"> software's and also the number of</font>

271
00:15:13,640 --> 00:15:19,490
drives and<font color="#E5E5E5"> the free space on them it's</font>

272
00:15:17,780 --> 00:15:22,459
more interesting<font color="#E5E5E5"> that it queries the</font>

273
00:15:19,490 --> 00:15:26,290
public IP address from an<font color="#E5E5E5"> external</font>

274
00:15:22,460 --> 00:15:29,900
service like what is my IP<font color="#E5E5E5"> this is</font>

275
00:15:26,290 --> 00:15:31,480
easily detectable<font color="#CCCCCC"> and it's interesting</font>

276
00:15:29,900 --> 00:15:33,610
<font color="#E5E5E5">that it's also carrying if</font>

277
00:15:31,480 --> 00:15:35,860
keyboard is<font color="#E5E5E5"> Russian</font><font color="#CCCCCC"> it's specifically</font>

278
00:15:33,610 --> 00:15:39,190
looking<font color="#CCCCCC"> for a Russian keyboard it</font>

279
00:15:35,860 --> 00:15:42,130
queries the keyboard language compares

280
00:15:39,190 --> 00:15:45,730
it to the<font color="#E5E5E5"> Russian constant and stores it</font>

281
00:15:42,130 --> 00:15:47,949
<font color="#E5E5E5">as a boolean instruction or not so then</font>

282
00:15:45,730 --> 00:15:50,829
it does<font color="#E5E5E5"> check into the command and</font>

283
00:15:47,949 --> 00:15:53,349
control server<font color="#CCCCCC"> it uploads all of this</font>

284
00:15:50,829 --> 00:15:55,870
data and then the server can decide

285
00:15:53,350 --> 00:15:59,980
based<font color="#E5E5E5"> on this if they want to encrypt or</font>

286
00:15:55,870 --> 00:16:01,779
not so if they want to<font color="#E5E5E5"> encrypt they need</font>

287
00:15:59,980 --> 00:16:05,170
to<font color="#E5E5E5"> send</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> response if there's no</font>

288
00:16:01,779 --> 00:16:11,649
response<font color="#E5E5E5"> and then the encryption won't</font>

289
00:16:05,170 --> 00:16:14,110
start in the initial version<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is the</font>

290
00:16:11,649 --> 00:16:17,470
drawback of this<font color="#E5E5E5"> for the attacker is</font>

291
00:16:14,110 --> 00:16:20,350
that if the server goes offline<font color="#CCCCCC"> then the</font>

292
00:16:17,470 --> 00:16:21,940
encryption won't happen so<font color="#CCCCCC"> if there is a</font>

293
00:16:20,350 --> 00:16:25,149
response<font color="#E5E5E5"> from the command and control</font>

294
00:16:21,940 --> 00:16:29,350
server<font color="#E5E5E5"> then it kills the processes that</font>

295
00:16:25,149 --> 00:16:31,720
it needs<font color="#CCCCCC"> to like these are processes</font>

296
00:16:29,350 --> 00:16:33,790
<font color="#CCCCCC">that</font><font color="#E5E5E5"> would hold an open handle to the</font>

297
00:16:31,720 --> 00:16:36,220
files<font color="#E5E5E5"> that it wants</font><font color="#CCCCCC"> to encrypt</font>

298
00:16:33,790 --> 00:16:38,349
<font color="#E5E5E5">so if worked holds a handle to a</font><font color="#CCCCCC"> doc</font>

299
00:16:36,220 --> 00:16:40,769
file then it can't decrypt can't encrypt

300
00:16:38,350 --> 00:16:44,220
<font color="#E5E5E5">the</font><font color="#CCCCCC"> doc</font><font color="#E5E5E5"> file so it needs to kill word</font>

301
00:16:40,769 --> 00:16:47,949
then it<font color="#E5E5E5"> encrypts all of the files based</font>

302
00:16:44,220 --> 00:16:50,880
<font color="#E5E5E5">based on an extension list and then</font>

303
00:16:47,949 --> 00:16:54,819
finally removes<font color="#CCCCCC"> Windows</font><font color="#E5E5E5"> is shadow copies</font>

304
00:16:50,880 --> 00:16:57,939
<font color="#E5E5E5">which can could be used to restore some</font>

305
00:16:54,819 --> 00:16:58,990
of<font color="#E5E5E5"> the data it's interesting that to</font>

306
00:16:57,940 --> 00:17:01,540
remove shadow copies you need

307
00:16:58,990 --> 00:17:05,410
administrator privileges<font color="#CCCCCC"> and most</font>

308
00:17:01,540 --> 00:17:09,010
ransomware<font color="#E5E5E5"> just doesn't try to escalate</font>

309
00:17:05,410 --> 00:17:11,110
privileges<font color="#CCCCCC"> adjusts it tries to remove</font>

310
00:17:09,010 --> 00:17:12,579
the shadow copies even<font color="#E5E5E5"> if it int if it</font>

311
00:17:11,109 --> 00:17:17,678
doesn't work<font color="#CCCCCC"> that it doesn't</font><font color="#E5E5E5"> work it</font>

312
00:17:12,579 --> 00:17:20,099
<font color="#CCCCCC">doesn't care</font><font color="#E5E5E5"> so after all of</font><font color="#CCCCCC"> this it</font>

313
00:17:17,679 --> 00:17:23,589
<font color="#E5E5E5">puts</font><font color="#CCCCCC"> a ransom note</font><font color="#E5E5E5"> which</font><font color="#CCCCCC"> is which has a</font>

314
00:17:20,099 --> 00:17:26,290
which has<font color="#CCCCCC"> an onion link and the</font>

315
00:17:23,589 --> 00:17:28,840
instructions to have to download<font color="#E5E5E5"> tor so</font>

316
00:17:26,290 --> 00:17:31,000
when the user<font color="#E5E5E5"> download it or they</font><font color="#CCCCCC"> can</font>

317
00:17:28,840 --> 00:17:33,250
browse<font color="#CCCCCC"> to the page where</font><font color="#E5E5E5"> they</font><font color="#CCCCCC"> can pay</font>

318
00:17:31,000 --> 00:17:38,320
the ransom and<font color="#E5E5E5"> they</font><font color="#CCCCCC"> needed</font><font color="#E5E5E5"> to pay it in</font>

319
00:17:33,250 --> 00:17:40,390
- yeah<font color="#E5E5E5"> so I want to talk</font><font color="#CCCCCC"> about the</font>

320
00:17:38,320 --> 00:17:42,970
specifics of<font color="#E5E5E5"> the first version it was</font>

321
00:17:40,390 --> 00:17:45,020
released in January it used<font color="#E5E5E5"> a yes to</font>

322
00:17:42,970 --> 00:17:47,030
<font color="#E5E5E5">encrypt</font>

323
00:17:45,020 --> 00:17:52,730
<font color="#E5E5E5">and the</font><font color="#CCCCCC"> command-and-control</font><font color="#E5E5E5"> server was</font>

324
00:17:47,030 --> 00:17:56,990
on dot<font color="#E5E5E5"> beat TLD domains which can be</font>

325
00:17:52,730 --> 00:17:58,640
resolved<font color="#E5E5E5"> by windows directly so</font><font color="#CCCCCC"> in so</font>

326
00:17:56,990 --> 00:18:01,070
they needed to resolve<font color="#E5E5E5"> the domains</font>

327
00:17:58,640 --> 00:18:03,890
themselves and they<font color="#E5E5E5"> look used nslookup</font>

328
00:18:01,070 --> 00:18:07,310
to do that which<font color="#E5E5E5"> is also a dead giveaway</font>

329
00:18:03,890 --> 00:18:10,930
so it's easy to<font color="#E5E5E5"> detect and for the first</font>

330
00:18:07,310 --> 00:18:10,929
<font color="#E5E5E5">version they could maybe - only</font>

331
00:18:13,900 --> 00:18:20,570
development in<font color="#E5E5E5"> February in</font><font color="#CCCCCC"> the end of</font>

332
00:18:18,260 --> 00:18:22,820
<font color="#E5E5E5">February was that</font><font color="#CCCCCC"> Europol</font><font color="#E5E5E5"> released the</font>

333
00:18:20,570 --> 00:18:28,700
Decrypter for it<font color="#E5E5E5"> which the victims could</font>

334
00:18:22,820 --> 00:18:32,629
use to get their files back a week later

335
00:18:28,700 --> 00:18:34,580
<font color="#E5E5E5">the</font><font color="#CCCCCC"> authors</font><font color="#E5E5E5"> of the ransomware admitted</font>

336
00:18:32,630 --> 00:18:37,580
that their infrastructure<font color="#E5E5E5"> was hacked</font>

337
00:18:34,580 --> 00:18:41,120
so that's<font color="#CCCCCC"> likely</font><font color="#E5E5E5"> the source of the</font>

338
00:18:37,580 --> 00:18:45,139
Decrypter and they added<font color="#E5E5E5"> a</font><font color="#CCCCCC"> new version</font>

339
00:18:41,120 --> 00:18:48,169
<font color="#E5E5E5">which for which the</font><font color="#CCCCCC"> Decrypter didn't</font>

340
00:18:45,140 --> 00:18:52,040
work<font color="#CCCCCC"> they</font><font color="#E5E5E5"> also change the extensions of</font>

341
00:18:48,170 --> 00:18:54,580
the of the encrypted<font color="#E5E5E5"> files to make it</font>

342
00:18:52,040 --> 00:18:57,770
more difficult<font color="#E5E5E5"> to track and they and</font>

343
00:18:54,580 --> 00:19:01,550
they started looking<font color="#CCCCCC"> for</font><font color="#E5E5E5"> clairemaude ad</font>

344
00:18:57,770 --> 00:19:04,310
components in the next version they

345
00:19:01,550 --> 00:19:07,370
added<font color="#CCCCCC"> that the change in</font><font color="#E5E5E5"> the wallpaper</font>

346
00:19:04,310 --> 00:19:09,889
<font color="#E5E5E5">they generate this image dynamically and</font>

347
00:19:07,370 --> 00:19:15,020
<font color="#E5E5E5">they personalize it for</font><font color="#CCCCCC"> the user</font><font color="#E5E5E5"> so it</font>

348
00:19:09,890 --> 00:19:18,140
contains the<font color="#CCCCCC"> username and they also</font>

349
00:19:15,020 --> 00:19:23,720
<font color="#CCCCCC">change</font><font color="#E5E5E5"> the user agent</font><font color="#CCCCCC"> which also makes</font>

350
00:19:18,140 --> 00:19:26,530
it a bit harder to<font color="#E5E5E5"> track in the next</font>

351
00:19:23,720 --> 00:19:29,120
version there was a bigger<font color="#CCCCCC"> leaf right</font>

352
00:19:26,530 --> 00:19:35,210
they<font color="#E5E5E5"> changed that encryption algorithm</font>

353
00:19:29,120 --> 00:19:37,879
from<font color="#CCCCCC"> a</font><font color="#E5E5E5"> esta salsa</font><font color="#CCCCCC"> it's likely because</font>

354
00:19:35,210 --> 00:19:44,210
<font color="#CCCCCC">they</font><font color="#E5E5E5"> want it</font><font color="#CCCCCC"> to manifest</font><font color="#E5E5E5"> an encryption</font>

355
00:19:37,880 --> 00:19:45,980
of<font color="#E5E5E5"> many</font><font color="#CCCCCC"> xx files they if the encryption</font>

356
00:19:44,210 --> 00:19:48,200
takes<font color="#CCCCCC"> too long then the victim I just</font>

357
00:19:45,980 --> 00:19:51,320
realize what's going<font color="#E5E5E5"> on and stop the</font>

358
00:19:48,200 --> 00:19:55,070
process<font color="#CCCCCC"> then they also start encrypting</font>

359
00:19:51,320 --> 00:19:56,659
<font color="#CCCCCC">Network shares and they remove the</font>

360
00:19:55,070 --> 00:19:58,310
ransomware<font color="#E5E5E5"> after it's done encrypting</font>

361
00:19:56,660 --> 00:20:01,410
everything

362
00:19:58,310 --> 00:20:03,870
<font color="#CCCCCC">for later it's important taste</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> they</font>

363
00:20:01,410 --> 00:20:07,800
started using<font color="#E5E5E5"> these log</font><font color="#CCCCCC"> files</font><font color="#E5E5E5"> they put</font>

364
00:20:03,870 --> 00:20:10,379
these files with dot<font color="#CCCCCC"> lock extension to a</font>

365
00:20:07,800 --> 00:20:14,610
<font color="#E5E5E5">folder to signal that</font><font color="#CCCCCC"> it started</font><font color="#E5E5E5"> being</font>

366
00:20:10,380 --> 00:20:18,330
<font color="#CCCCCC">encrypted</font><font color="#E5E5E5"> and they change the extension</font>

367
00:20:14,610 --> 00:20:20,129
again<font color="#CCCCCC"> it's interesting that they removed</font>

368
00:20:18,330 --> 00:20:23,040
the connection to<font color="#CCCCCC"> their</font>

369
00:20:20,130 --> 00:20:25,170
<font color="#CCCCCC">command-and-control</font><font color="#E5E5E5"> server and they do</font>

370
00:20:23,040 --> 00:20:27,120
not<font color="#E5E5E5"> create the</font><font color="#CCCCCC"> public hyper IP address</font>

371
00:20:25,170 --> 00:20:29,370
anymore<font color="#E5E5E5"> so the country completely</font>

372
00:20:27,120 --> 00:20:32,939
<font color="#E5E5E5">removed everything that's network</font>

373
00:20:29,370 --> 00:20:36,840
<font color="#CCCCCC">related which makes it stats here</font><font color="#E5E5E5"> it's</font>

374
00:20:32,940 --> 00:20:39,750
more<font color="#CCCCCC"> difficult to track and detect</font><font color="#E5E5E5"> but</font>

375
00:20:36,840 --> 00:20:41,639
it also removes features so if there<font color="#CCCCCC"> is</font>

376
00:20:39,750 --> 00:20:44,850
no<font color="#E5E5E5"> comment and control</font><font color="#CCCCCC"> connection then</font>

377
00:20:41,640 --> 00:20:49,230
<font color="#E5E5E5">their users are</font><font color="#CCCCCC"> not getting the fancy</font><font color="#E5E5E5"> no</font>

378
00:20:44,850 --> 00:20:50,699
data which is which might be bad<font color="#CCCCCC"> for</font>

379
00:20:49,230 --> 00:20:56,130
their business<font color="#CCCCCC"> because it's a missing</font>

380
00:20:50,700 --> 00:20:57,870
feature<font color="#E5E5E5"> so in a few days</font><font color="#CCCCCC"> a</font>

381
00:20:56,130 --> 00:21:00,930
<font color="#CCCCCC">command-and-control</font><font color="#E5E5E5"> collection was back</font>

382
00:20:57,870 --> 00:21:03,169
and this<font color="#E5E5E5"> time they moved it from their</font>

383
00:21:00,930 --> 00:21:06,750
<font color="#CCCCCC">own domains</font><font color="#E5E5E5"> to hacked WordPress sites</font>

384
00:21:03,170 --> 00:21:08,400
and they started<font color="#E5E5E5"> using a URL generation</font>

385
00:21:06,750 --> 00:21:15,030
algorithm to generate<font color="#CCCCCC"> a list</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> which</font>

386
00:21:08,400 --> 00:21:18,780
<font color="#CCCCCC">whereas the contact so if you remember</font>

387
00:21:15,030 --> 00:21:21,480
<font color="#E5E5E5">the log files from two slides back they</font>

388
00:21:18,780 --> 00:21:23,399
are<font color="#CCCCCC"> put in</font><font color="#E5E5E5"> a folder to signal for</font><font color="#CCCCCC"> the</font>

389
00:21:21,480 --> 00:21:25,470
ransomware that that folder is already

390
00:21:23,400 --> 00:21:28,380
being encrypted<font color="#CCCCCC"> and not to encrypt it</font>

391
00:21:25,470 --> 00:21:30,990
again<font color="#E5E5E5"> this allowed an</font><font color="#CCCCCC"> anti-virus</font><font color="#E5E5E5"> company</font>

392
00:21:28,380 --> 00:21:33,590
to<font color="#E5E5E5"> create a vaccine for it they put a</font>

393
00:21:30,990 --> 00:21:35,970
log file in one of the directories and

394
00:21:33,590 --> 00:21:38,340
<font color="#E5E5E5">the ransomware will not look in</font>

395
00:21:35,970 --> 00:21:41,220
<font color="#E5E5E5">subdirectory Stan and what encrypt</font>

396
00:21:38,340 --> 00:21:44,490
anything so this was pretty<font color="#CCCCCC"> short-lived</font>

397
00:21:41,220 --> 00:21:46,640
<font color="#E5E5E5">for four days after there was a new</font>

398
00:21:44,490 --> 00:21:49,680
version<font color="#CCCCCC"> that defeated the</font><font color="#E5E5E5"> vaccine and</font>

399
00:21:46,640 --> 00:21:52,050
<font color="#CCCCCC">that day later there was</font><font color="#E5E5E5"> a version</font><font color="#CCCCCC"> 2 of</font>

400
00:21:49,680 --> 00:21:53,550
<font color="#E5E5E5">the vaccine two days later there was</font>

401
00:21:52,050 --> 00:21:56,370
again a new version against a new

402
00:21:53,550 --> 00:21:58,649
<font color="#CCCCCC">vaccine and they probably realized that</font>

403
00:21:56,370 --> 00:22:03,000
this<font color="#E5E5E5"> doesn't really</font><font color="#CCCCCC"> make sense</font><font color="#E5E5E5"> so</font>

404
00:21:58,650 --> 00:22:07,640
vaccination is good if if the

405
00:22:03,000 --> 00:22:10,050
<font color="#E5E5E5">development cycle is long if they would</font>

406
00:22:07,640 --> 00:22:11,760
<font color="#CCCCCC">if the Marberry authors would have taken</font>

407
00:22:10,050 --> 00:22:13,169
once to deliver

408
00:22:11,760 --> 00:22:15,750
the new<font color="#E5E5E5"> version then it would make sense</font>

409
00:22:13,170 --> 00:22:18,000
but if it's taking a date and the

410
00:22:15,750 --> 00:22:20,810
<font color="#E5E5E5">vaccine is useless so they didn't</font>

411
00:22:18,000 --> 00:22:24,300
release a third version<font color="#E5E5E5"> of</font><font color="#CCCCCC"> the vaccine</font>

412
00:22:20,810 --> 00:22:28,399
however a<font color="#E5E5E5"> few weeks later the</font><font color="#CCCCCC"> canticle</font>

413
00:22:24,300 --> 00:22:31,620
butters<font color="#E5E5E5"> released a new version which had</font>

414
00:22:28,400 --> 00:22:36,620
which<font color="#CCCCCC"> had a zero day for the antivirus</font>

415
00:22:31,620 --> 00:22:39,540
companies drivers<font color="#E5E5E5"> and they didn't really</font>

416
00:22:36,620 --> 00:22:44,100
use it for<font color="#E5E5E5"> any function they just did it</font>

417
00:22:39,540 --> 00:22:47,399
<font color="#CCCCCC">as a retaliation they included a string</font>

418
00:22:44,100 --> 00:22:50,429
inside the marver<font color="#CCCCCC"> that's a message</font><font color="#E5E5E5"> to</font>

419
00:22:47,400 --> 00:22:55,190
the antivirus company it says that they

420
00:22:50,430 --> 00:22:57,810
they even the score<font color="#E5E5E5"> and they they found</font>

421
00:22:55,190 --> 00:23:01,680
<font color="#E5E5E5">denial of service one regret in it and</font>

422
00:22:57,810 --> 00:23:05,040
they think<font color="#CCCCCC"> that</font><font color="#E5E5E5"> it might</font><font color="#CCCCCC"> be developed</font>

423
00:23:01,680 --> 00:23:06,720
into<font color="#CCCCCC"> a</font><font color="#E5E5E5"> privilege</font><font color="#CCCCCC"> escalation it's</font>

424
00:23:05,040 --> 00:23:11,040
interesting that they also added a link

425
00:23:06,720 --> 00:23:12,990
which is a link to<font color="#E5E5E5"> the POC it's of so</font>

426
00:23:11,040 --> 00:23:16,740
it's a link to the source code<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the</font>

427
00:23:12,990 --> 00:23:20,280
exploit so they did this more as a full

428
00:23:16,740 --> 00:23:24,470
<font color="#E5E5E5">disclosure naturally as a as an</font>

429
00:23:20,280 --> 00:23:29,430
exploitation<font color="#CCCCCC"> we'll talk about</font><font color="#E5E5E5"> this later</font>

430
00:23:24,470 --> 00:23:32,550
<font color="#CCCCCC">towards the</font><font color="#E5E5E5"> end so the newer version is</font>

431
00:23:29,430 --> 00:23:34,530
version<font color="#CCCCCC"> 5 and they added</font><font color="#E5E5E5"> some privilege</font>

432
00:23:32,550 --> 00:23:36,780
escalation exploits which allows them to

433
00:23:34,530 --> 00:23:38,610
remove shadow copies and encrypt files

434
00:23:36,780 --> 00:23:46,080
that they wouldn't<font color="#E5E5E5"> have been able</font>

435
00:23:38,610 --> 00:23:48,530
<font color="#E5E5E5">otherwise these are known exploits one</font>

436
00:23:46,080 --> 00:23:53,490
of them is from a full<font color="#E5E5E5"> disclosure</font>

437
00:23:48,530 --> 00:23:55,620
<font color="#E5E5E5">somebody will released</font><font color="#CCCCCC"> Blewett</font>

438
00:23:53,490 --> 00:23:58,530
<font color="#CCCCCC">escalation Windows exploits</font><font color="#E5E5E5"> on Twitter</font>

439
00:23:55,620 --> 00:24:01,379
<font color="#E5E5E5">as a full</font><font color="#CCCCCC"> disclosure</font><font color="#E5E5E5"> and a few weeks</font>

440
00:23:58,530 --> 00:24:03,990
<font color="#E5E5E5">later they implemented it in in there</font>

441
00:24:01,380 --> 00:24:05,370
and somewhere<font color="#E5E5E5"> which is basically what</font>

442
00:24:03,990 --> 00:24:09,990
happens if you<font color="#E5E5E5"> are doing full disclosure</font>

443
00:24:05,370 --> 00:24:13,169
<font color="#CCCCCC">and they also fully randomized the</font>

444
00:24:09,990 --> 00:24:15,740
extension this time another interesting

445
00:24:13,170 --> 00:24:19,340
development is that there was<font color="#CCCCCC"> a</font>

446
00:24:15,740 --> 00:24:24,240
<font color="#CCCCCC">decrypter again released by bitdefender</font>

447
00:24:19,340 --> 00:24:25,530
<font color="#E5E5E5">which decrypts</font><font color="#CCCCCC"> the extreme victims files</font>

448
00:24:24,240 --> 00:24:27,000
<font color="#E5E5E5">it's based on a</font>

449
00:24:25,530 --> 00:24:31,110
<font color="#CCCCCC">the graphic arrow</font><font color="#E5E5E5"> that's made by the</font>

450
00:24:27,000 --> 00:24:32,610
ransomware<font color="#CCCCCC"> routers so but twelve</font><font color="#E5E5E5"> hours</font>

451
00:24:31,110 --> 00:24:38,639
later<font color="#CCCCCC"> there was a new version</font><font color="#E5E5E5"> which</font>

452
00:24:32,610 --> 00:24:39,360
fixed the fixative vulnerability so in

453
00:24:38,640 --> 00:24:42,210
its current<font color="#E5E5E5"> state</font>

454
00:24:39,360 --> 00:24:44,070
there is no<font color="#CCCCCC"> descriptor for the knot</font>

455
00:24:42,210 --> 00:24:48,600
<font color="#E5E5E5">somewhere the file extension is</font>

456
00:24:44,070 --> 00:24:51,450
randomized and comunicados server

457
00:24:48,600 --> 00:24:53,310
connection is less obvious<font color="#E5E5E5"> and</font><font color="#CCCCCC"> and it</font>

458
00:24:51,450 --> 00:24:56,280
also has some<font color="#E5E5E5"> chance for privilege</font>

459
00:24:53,310 --> 00:25:01,350
<font color="#E5E5E5">escalation so that's basically the</font>

460
00:24:56,280 --> 00:25:07,129
<font color="#E5E5E5">current state of the of the marver now I</font>

461
00:25:01,350 --> 00:25:07,129
can talk about<font color="#E5E5E5"> the</font><font color="#CCCCCC"> zero-day that</font><font color="#E5E5E5"> is used</font>

462
00:25:08,510 --> 00:25:16,560
it's the vulnerability the exploit<font color="#E5E5E5"> kit</font>

463
00:25:13,940 --> 00:25:18,330
<font color="#CCCCCC">sub-b sod it makes a blue screen of</font>

464
00:25:16,560 --> 00:25:20,960
death<font color="#E5E5E5"> because it's crashing a car driver</font>

465
00:25:18,330 --> 00:25:23,189
but<font color="#CCCCCC"> it doesn't really get code execution</font>

466
00:25:20,960 --> 00:25:24,990
that could be used for<font color="#E5E5E5"> privilege</font>

467
00:25:23,190 --> 00:25:29,370
<font color="#E5E5E5">escalation so in its current</font><font color="#CCCCCC"> state it's</font>

468
00:25:24,990 --> 00:25:31,950
not<font color="#E5E5E5"> really usable and also the exploit</font>

469
00:25:29,370 --> 00:25:33,719
works on its own but the<font color="#E5E5E5"> scenes but they</font>

470
00:25:31,950 --> 00:25:35,540
put<font color="#E5E5E5"> it inside</font><font color="#CCCCCC"> the ransomware</font><font color="#E5E5E5"> and the</font>

471
00:25:33,720 --> 00:25:41,120
ransomware is<font color="#E5E5E5"> detected</font><font color="#CCCCCC"> by</font><font color="#E5E5E5"> the antivirus</font>

472
00:25:35,540 --> 00:25:43,820
<font color="#E5E5E5">so it never really reaches this code and</font>

473
00:25:41,120 --> 00:25:47,010
it's interesting to see<font color="#E5E5E5"> why they did it</font>

474
00:25:43,820 --> 00:25:49,830
because and<font color="#CCCCCC"> acidotic costs a lot of</font>

475
00:25:47,010 --> 00:25:56,160
<font color="#E5E5E5">money so it's very unusual to burn a</font>

476
00:25:49,830 --> 00:25:58,919
<font color="#E5E5E5">zero-day</font><font color="#CCCCCC"> and even when they even when</font>

477
00:25:56,160 --> 00:26:01,530
they burn it<font color="#E5E5E5"> it has a purpose so they</font>

478
00:25:58,920 --> 00:26:05,250
don't just burn money<font color="#E5E5E5"> for no reason and</font>

479
00:26:01,530 --> 00:26:08,430
they transfer routers before the<font color="#CCCCCC"> release</font>

480
00:26:05,250 --> 00:26:11,550
contacted a new site<font color="#E5E5E5"> and told them that</font>

481
00:26:08,430 --> 00:26:14,790
<font color="#CCCCCC">it this</font><font color="#E5E5E5"> is a retaliation</font><font color="#CCCCCC"> and they were</font>

482
00:26:11,550 --> 00:26:17,730
expecting it to be a huge reputation

483
00:26:14,790 --> 00:26:20,280
problem for the antivirus vendor they

484
00:26:17,730 --> 00:26:22,520
basically<font color="#E5E5E5"> really overestimated the</font>

485
00:26:20,280 --> 00:26:25,590
impact<font color="#E5E5E5"> of the exploit that they found</font>

486
00:26:22,520 --> 00:26:28,290
<font color="#E5E5E5">they thought that this would like bring</font>

487
00:26:25,590 --> 00:26:31,350
down the company<font color="#E5E5E5"> or something in reality</font>

488
00:26:28,290 --> 00:26:33,840
it didn't really<font color="#E5E5E5"> make the news it's and</font>

489
00:26:31,350 --> 00:26:37,800
it's<font color="#E5E5E5"> not really that</font><font color="#CCCCCC"> relevant because</font><font color="#E5E5E5"> it</font>

490
00:26:33,840 --> 00:26:38,399
was fixed really quickly<font color="#E5E5E5"> so really it's</font>

491
00:26:37,800 --> 00:26:41,850
a

492
00:26:38,400 --> 00:26:43,530
<font color="#CCCCCC">increase the reputation of the antivirus</font>

493
00:26:41,850 --> 00:26:49,590
vendor<font color="#E5E5E5"> because it shows</font><font color="#CCCCCC"> that they know</font>

494
00:26:43,530 --> 00:26:55,080
how to handle<font color="#CCCCCC"> my liberty so I should</font>

495
00:26:49,590 --> 00:27:26,580
show how how it happens<font color="#CCCCCC"> I don't know if</font>

496
00:26:55,080 --> 00:27:32,820
I have<font color="#E5E5E5"> the fire</font><font color="#CCCCCC"> ok thank you ok I</font>

497
00:27:26,580 --> 00:27:35,428
successfully language the video<font color="#E5E5E5"> so first</font>

498
00:27:32,820 --> 00:27:37,439
I want to<font color="#CCCCCC"> start from the POC</font><font color="#E5E5E5"> that was</font>

499
00:27:35,429 --> 00:27:44,309
released that<font color="#CCCCCC"> was linked inside the</font>

500
00:27:37,440 --> 00:27:48,330
marver<font color="#CCCCCC"> No so it contains a bunch of</font>

501
00:27:44,309 --> 00:27:52,410
<font color="#E5E5E5">Russian folders but the part that</font><font color="#CCCCCC"> we</font>

502
00:27:48,330 --> 00:27:55,649
care<font color="#E5E5E5"> about is the POC that</font><font color="#CCCCCC"> CBP which has</font>

503
00:27:52,410 --> 00:27:57,920
a<font color="#E5E5E5"> preamble that they say they claim that</font>

504
00:27:55,650 --> 00:28:02,790
<font color="#CCCCCC">they are</font><font color="#E5E5E5"> the author of the exploit and</font>

505
00:27:57,920 --> 00:28:05,610
<font color="#E5E5E5">was and target of the exploit there's a</font>

506
00:28:02,790 --> 00:28:08,790
<font color="#E5E5E5">run POC function which is important to</font>

507
00:28:05,610 --> 00:28:13,260
<font color="#E5E5E5">us</font><font color="#CCCCCC"> it's it just does three things really</font>

508
00:28:08,790 --> 00:28:17,520
<font color="#E5E5E5">it acquires a handle to the driver then</font>

509
00:28:13,260 --> 00:28:19,830
it<font color="#E5E5E5"> sends it to device IO control</font>

510
00:28:17,520 --> 00:28:21,900
<font color="#E5E5E5">functions if you're in user mode that's</font>

511
00:28:19,830 --> 00:28:24,629
how you can communicate<font color="#CCCCCC"> with the kernel</font>

512
00:28:21,900 --> 00:28:27,809
driver<font color="#E5E5E5"> by sending it a device IO control</font>

513
00:28:24,630 --> 00:28:30,510
<font color="#E5E5E5">function with a specific control code</font>

514
00:28:27,809 --> 00:28:34,559
and the control code defines what a

515
00:28:30,510 --> 00:28:36,690
function will run inside<font color="#E5E5E5"> the driver so</font>

516
00:28:34,559 --> 00:28:40,320
this control codes the one of them they

517
00:28:36,690 --> 00:28:45,600
called<font color="#E5E5E5"> IO</font><font color="#CCCCCC"> CTO set address and the the</font>

518
00:28:40,320 --> 00:28:48,600
<font color="#E5E5E5">other one is ioctl trigger so we see</font>

519
00:28:45,600 --> 00:28:50,889
that<font color="#CCCCCC"> there the control code a</font><font color="#E5E5E5"> in</font>

520
00:28:48,600 --> 00:28:53,469
hexadecimal<font color="#E5E5E5"> form a start with an</font><font color="#CCCCCC"> 8</font>

521
00:28:50,890 --> 00:28:56,250
means that these<font color="#E5E5E5"> are</font><font color="#CCCCCC"> custom</font><font color="#E5E5E5"> defines</font>

522
00:28:53,470 --> 00:29:01,180
control codes by the driver and that

523
00:28:56,250 --> 00:29:03,100
<font color="#CCCCCC">Windows is predefined ones so to</font>

524
00:29:01,180 --> 00:29:05,890
understand them we need to<font color="#E5E5E5"> reverse</font>

525
00:29:03,100 --> 00:29:10,179
engineer<font color="#E5E5E5"> the driver but first I want to</font>

526
00:29:05,890 --> 00:29:16,780
<font color="#E5E5E5">try if the PLC actually works this is</font>

527
00:29:10,180 --> 00:29:21,460
the antivirus and when<font color="#E5E5E5"> I lounge the PLC</font>

528
00:29:16,780 --> 00:29:23,649
it should crash<font color="#E5E5E5"> and it crashed it's not</font>

529
00:29:21,460 --> 00:29:26,230
<font color="#CCCCCC">visible yet</font><font color="#E5E5E5"> it just assets everything</font><font color="#CCCCCC"> is</font>

530
00:29:23,650 --> 00:29:29,770
<font color="#CCCCCC">interests in responsive windows will</font>

531
00:29:26,230 --> 00:29:33,930
make memory<font color="#CCCCCC"> damp and reboot it</font><font color="#E5E5E5"> okay so</font>

532
00:29:29,770 --> 00:29:40,230
the reboot happens the exploit<font color="#E5E5E5"> worked</font>

533
00:29:33,930 --> 00:29:45,250
<font color="#E5E5E5">I've tried to save us some</font><font color="#CCCCCC"> time okay</font>

534
00:29:40,230 --> 00:29:47,530
so<font color="#E5E5E5"> after the reboot we can windows</font>

535
00:29:45,250 --> 00:29:49,450
generated dump

536
00:29:47,530 --> 00:29:54,070
<font color="#CCCCCC">I'm already</font><font color="#E5E5E5"> dumped so we can open that</font>

537
00:29:49,450 --> 00:29:58,420
<font color="#E5E5E5">memory</font><font color="#CCCCCC"> dump it windbg and it will</font>

538
00:29:54,070 --> 00:30:01,919
hopefully give us some<font color="#CCCCCC"> useful stuff that</font>

539
00:29:58,420 --> 00:30:01,920
you'll<font color="#E5E5E5"> get us started</font>

540
00:30:02,400 --> 00:30:14,080
<font color="#CCCCCC">ok</font><font color="#E5E5E5"> so it's I got first in the video but</font>

541
00:30:10,780 --> 00:30:25,080
it give<font color="#E5E5E5"> us a stack so on the stack we</font>

542
00:30:14,080 --> 00:30:27,970
can see that it's that it's calling this

543
00:30:25,080 --> 00:30:32,770
<font color="#E5E5E5">this</font><font color="#CCCCCC"> strawberry and we see the offset</font>

544
00:30:27,970 --> 00:30:37,000
<font color="#E5E5E5">and we also see that in the</font><font color="#CCCCCC"> final final</font>

545
00:30:32,770 --> 00:30:44,410
call<font color="#CCCCCC"> if we call this this anti function</font>

546
00:30:37,000 --> 00:30:46,450
which will<font color="#E5E5E5"> finally caused the crash</font><font color="#CCCCCC"> ok</font>

547
00:30:44,410 --> 00:30:48,250
so now we need<font color="#E5E5E5"> but now we know which</font>

548
00:30:46,450 --> 00:30:53,230
file and that<font color="#E5E5E5"> velocity is causing the</font>

549
00:30:48,250 --> 00:30:56,430
crash<font color="#E5E5E5"> we can open it in either and look</font>

550
00:30:53,230 --> 00:30:56,430
look<font color="#E5E5E5"> at what happens there</font>

551
00:30:59,950 --> 00:31:07,060
so this is where the crash happens<font color="#CCCCCC"> it's</font>

552
00:31:03,880 --> 00:31:17,590
<font color="#E5E5E5">calling that a function that</font><font color="#CCCCCC"> we saw in</font>

553
00:31:07,060 --> 00:31:23,230
the in the memory dump and and we can

554
00:31:17,590 --> 00:31:27,280
<font color="#E5E5E5">see that it's calling it with with</font><font color="#CCCCCC"> that</font>

555
00:31:23,230 --> 00:31:32,680
with two parameters<font color="#CCCCCC"> one</font><font color="#E5E5E5"> body one</font>

556
00:31:27,280 --> 00:31:35,889
variable and one other parameter this<font color="#E5E5E5"> is</font>

557
00:31:32,680 --> 00:31:38,650
<font color="#E5E5E5">for acquiring resource you need to edit</font>

558
00:31:35,890 --> 00:31:43,540
<font color="#E5E5E5">a pointer where to acquire the resource</font>

559
00:31:38,650 --> 00:31:45,600
from so if we change<font color="#E5E5E5"> this variable into</font>

560
00:31:43,540 --> 00:31:49,320
something<font color="#E5E5E5"> that's not a not a valid</font>

561
00:31:45,600 --> 00:31:52,689
location then it will crash the<font color="#CCCCCC"> driver</font>

562
00:31:49,320 --> 00:31:56,200
which<font color="#E5E5E5"> is exactly what they did</font><font color="#CCCCCC"> so we</font>

563
00:31:52,690 --> 00:32:01,240
need to see where this variable is set

564
00:31:56,200 --> 00:32:06,550
it can only be set at one place now<font color="#E5E5E5"> so</font>

565
00:32:01,240 --> 00:32:09,160
we follow<font color="#CCCCCC"> follow</font><font color="#E5E5E5"> this location up we</font>

566
00:32:06,550 --> 00:32:16,680
follow it up first I named it right

567
00:32:09,160 --> 00:32:20,710
ma'am<font color="#E5E5E5"> then I follow it up the stack and</font>

568
00:32:16,680 --> 00:32:25,270
we<font color="#CCCCCC"> arrived at a large switch case where</font>

569
00:32:20,710 --> 00:32:27,490
the ioctl<font color="#E5E5E5"> control codes are defined</font><font color="#CCCCCC"> the</font>

570
00:32:25,270 --> 00:32:29,680
<font color="#CCCCCC">it's defined what to do with each i/o</font>

571
00:32:27,490 --> 00:32:31,810
<font color="#E5E5E5">city a control code and we can see</font><font color="#CCCCCC"> that</font>

572
00:32:29,680 --> 00:32:35,020
this is the<font color="#CCCCCC"> Osito control code that they</font>

573
00:32:31,810 --> 00:32:39,460
<font color="#CCCCCC">use for</font><font color="#E5E5E5"> the i/o city or settlers so this</font>

574
00:32:35,020 --> 00:32:41,850
is how they<font color="#CCCCCC"> are changing</font><font color="#E5E5E5"> this variable</font>

575
00:32:39,460 --> 00:32:49,420
<font color="#E5E5E5">into something that's a pointer to</font><font color="#CCCCCC"> a</font>

576
00:32:41,850 --> 00:32:56,590
non-existing<font color="#E5E5E5"> Wow so it does we don't</font>

577
00:32:49,420 --> 00:32:59,320
<font color="#E5E5E5">really need it</font><font color="#CCCCCC"> that much so they change</font>

578
00:32:56,590 --> 00:33:04,540
it into<font color="#E5E5E5"> a variable that's pointing to</font>

579
00:32:59,320 --> 00:33:06,450
another<font color="#CCCCCC"> non-existing address and they do</font>

580
00:33:04,540 --> 00:33:09,629
the<font color="#E5E5E5"> i/o city</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> call to set the address</font>

581
00:33:06,450 --> 00:33:09,630
<font color="#E5E5E5">all right</font>

582
00:33:13,830 --> 00:33:18,249
they do one call to set the address<font color="#CCCCCC"> and</font>

583
00:33:16,629 --> 00:33:22,359
they do another<font color="#E5E5E5"> call to read it and it</font>

584
00:33:18,249 --> 00:33:24,159
<font color="#E5E5E5">crashes</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> driver and we want to know how</font>

585
00:33:22,359 --> 00:33:27,580
advanced they really are<font color="#E5E5E5"> because it's</font>

586
00:33:24,159 --> 00:33:30,820
<font color="#E5E5E5">really uncommon for someone to for a</font>

587
00:33:27,580 --> 00:33:33,399
group<font color="#E5E5E5"> like this to find an exploit it's</font>

588
00:33:30,820 --> 00:33:34,718
usually done<font color="#E5E5E5"> by nation states or</font>

589
00:33:33,399 --> 00:33:37,359
something<font color="#E5E5E5"> that's someone that's more</font>

590
00:33:34,719 --> 00:33:39,219
resourceful<font color="#CCCCCC"> so you see that</font><font color="#E5E5E5"> this is</font><font color="#CCCCCC"> very</font>

591
00:33:37,359 --> 00:33:42,460
simple and<font color="#E5E5E5"> they probably just fast it</font>

592
00:33:39,219 --> 00:33:44,499
and if you analyze<font color="#CCCCCC"> it</font><font color="#E5E5E5"> further we'd see</font>

593
00:33:42,460 --> 00:33:48,429
<font color="#CCCCCC">that turning it into a code execution</font>

594
00:33:44,499 --> 00:33:51,070
<font color="#E5E5E5">would be pretty difficult because it's</font>

595
00:33:48,429 --> 00:33:57,309
not<font color="#E5E5E5"> really doing anything to write</font><font color="#CCCCCC"> the</font>

596
00:33:51,070 --> 00:34:00,269
<font color="#CCCCCC">death</font><font color="#E5E5E5"> location so based on based on the</font>

597
00:33:57,309 --> 00:34:06,309
analysis we can make a profile for<font color="#E5E5E5"> this</font>

598
00:34:00,269 --> 00:34:08,168
adversary<font color="#E5E5E5"> the first thing that we saw is</font>

599
00:34:06,309 --> 00:34:10,359
<font color="#CCCCCC">that</font><font color="#E5E5E5"> this big Russian they post in</font>

600
00:34:08,168 --> 00:34:13,299
Russian forum<font color="#CCCCCC"> and they have special</font>

601
00:34:10,359 --> 00:34:15,038
handling for a<font color="#E5E5E5"> Russian local which could</font>

602
00:34:13,299 --> 00:34:16,538
all be false Flags it doesn't

603
00:34:15,039 --> 00:34:19,299
necessarily<font color="#E5E5E5"> mean that they are Russian</font>

604
00:34:16,539 --> 00:34:20,740
<font color="#E5E5E5">and it's honestly not even that</font>

605
00:34:19,299 --> 00:34:23,259
important the nationality is not

606
00:34:20,739 --> 00:34:25,479
<font color="#E5E5E5">important from a defenders point of view</font>

607
00:34:23,260 --> 00:34:27,669
it's more important<font color="#E5E5E5"> what their</font>

608
00:34:25,480 --> 00:34:30,159
capabilities are and based on the

609
00:34:27,668 --> 00:34:33,730
<font color="#CCCCCC">analyzes we can set upper and lower</font>

610
00:34:30,159 --> 00:34:35,139
boundaries to their capabilities<font color="#E5E5E5"> so we</font>

611
00:34:33,730 --> 00:34:38,079
see that they have<font color="#E5E5E5"> pre-existing</font>

612
00:34:35,139 --> 00:34:40,419
<font color="#E5E5E5">experience with marketing</font><font color="#CCCCCC"> ransomware the</font>

613
00:34:38,079 --> 00:34:42,429
service on the specific forum<font color="#E5E5E5"> they know</font>

614
00:34:40,418 --> 00:34:45,489
how<font color="#E5E5E5"> to handle that forum very well they</font>

615
00:34:42,429 --> 00:34:48,399
know the they know what their users<font color="#E5E5E5"> want</font>

616
00:34:45,489 --> 00:34:49,839
<font color="#E5E5E5">so it's likely</font><font color="#CCCCCC"> that this is not first</font>

617
00:34:48,399 --> 00:34:52,029
<font color="#E5E5E5">and</font><font color="#CCCCCC"> some of</font><font color="#E5E5E5"> the service that they</font>

618
00:34:49,839 --> 00:34:55,418
marketing<font color="#E5E5E5"> got marketed on this forum or</font>

619
00:34:52,029 --> 00:34:58,089
a similar one we also see that<font color="#E5E5E5"> their</font>

620
00:34:55,418 --> 00:35:01,720
<font color="#CCCCCC">development is organized in a enough to</font>

621
00:34:58,089 --> 00:35:03,759
react<font color="#E5E5E5"> quickly to changes and it's the</font>

622
00:35:01,720 --> 00:35:06,399
<font color="#E5E5E5">reaction times are getting quicker it</font>

623
00:35:03,760 --> 00:35:08,770
was one<font color="#E5E5E5"> week for the first</font><font color="#CCCCCC"> Decrypter and</font>

624
00:35:06,400 --> 00:35:13,119
it was<font color="#E5E5E5"> 12 hours for the most recent one</font>

625
00:35:08,770 --> 00:35:15,130
<font color="#CCCCCC">oh but they are not</font><font color="#E5E5E5"> organized</font><font color="#CCCCCC"> enough for</font>

626
00:35:13,119 --> 00:35:17,650
all<font color="#E5E5E5"> releases to work properly</font><font color="#CCCCCC"> is</font>

627
00:35:15,130 --> 00:35:19,420
sometimes it is non-working versions or

628
00:35:17,650 --> 00:35:22,990
versions that only<font color="#CCCCCC"> worked on specific</font>

629
00:35:19,420 --> 00:35:25,510
operating<font color="#E5E5E5"> systems so what do the</font>

630
00:35:22,990 --> 00:35:26,740
releases are quick<font color="#CCCCCC"> they are</font><font color="#E5E5E5"> not</font>

631
00:35:25,510 --> 00:35:29,950
organized<font color="#CCCCCC"> enough</font><font color="#E5E5E5"> to</font>

632
00:35:26,740 --> 00:35:33,100
always deliver<font color="#CCCCCC"> a proper</font><font color="#E5E5E5"> release which</font>

633
00:35:29,950 --> 00:35:35,350
makes missing everything<font color="#CCCCCC"> that they</font><font color="#E5E5E5"> are</font>

634
00:35:33,100 --> 00:35:39,930
not<font color="#E5E5E5"> really</font><font color="#CCCCCC"> doing</font><font color="#E5E5E5"> proper agile they just</font>

635
00:35:35,350 --> 00:35:39,930
implemented the quick<font color="#E5E5E5"> development part</font>

636
00:35:41,130 --> 00:35:46,630
<font color="#E5E5E5">we also saw that they are capable of</font>

637
00:35:43,540 --> 00:35:48,100
<font color="#E5E5E5">implementing</font><font color="#CCCCCC"> excavators</font><font color="#E5E5E5"> based on</font><font color="#CCCCCC"> POCs</font><font color="#E5E5E5"> we</font>

638
00:35:46,630 --> 00:35:51,490
saw this with<font color="#CCCCCC"> the privilege escalation</font>

639
00:35:48,100 --> 00:35:55,540
exploits<font color="#E5E5E5"> and they are also capable of</font>

640
00:35:51,490 --> 00:35:57,669
<font color="#CCCCCC">finding</font><font color="#E5E5E5"> a simple exploit via fuzzing but</font>

641
00:35:55,540 --> 00:36:01,150
they are not<font color="#CCCCCC"> capable</font><font color="#E5E5E5"> of developing a</font>

642
00:35:57,670 --> 00:36:03,280
<font color="#E5E5E5">more complex or more complex exploit</font>

643
00:36:01,150 --> 00:36:07,119
that<font color="#E5E5E5"> would get some good execution that</font>

644
00:36:03,280 --> 00:36:09,910
they didn't need and they<font color="#E5E5E5"> are also not</font>

645
00:36:07,119 --> 00:36:13,390
capable of<font color="#E5E5E5"> casting</font><font color="#CCCCCC"> the reputation</font><font color="#E5E5E5"> impact</font>

646
00:36:09,910 --> 00:36:16,270
of an exploit which leads us to<font color="#CCCCCC"> believe</font>

647
00:36:13,390 --> 00:36:20,049
that<font color="#E5E5E5"> this might be their</font><font color="#CCCCCC"> first try they</font>

648
00:36:16,270 --> 00:36:24,009
are not experienced in vulnerability

649
00:36:20,050 --> 00:36:27,480
research and that's basically<font color="#CCCCCC"> all of</font>

650
00:36:24,010 --> 00:36:27,480
what I wanted<font color="#E5E5E5"> to say thank you</font>

651
00:36:35,640 --> 00:36:41,770
thank you very<font color="#E5E5E5"> much for this every</font>

652
00:36:38,550 --> 00:36:50,380
<font color="#E5E5E5">comprehensive study we have time for a</font>

653
00:36:41,770 --> 00:36:54,490
few<font color="#E5E5E5"> questions yes thanks for</font><font color="#CCCCCC"> the</font>

654
00:36:50,380 --> 00:36:56,830
presentation<font color="#CCCCCC"> I wanted</font><font color="#E5E5E5"> to know if you</font>

655
00:36:54,490 --> 00:37:00,700
have an idea<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the improvement of the</font>

656
00:36:56,830 --> 00:37:04,569
random<font color="#E5E5E5"> quit</font><font color="#CCCCCC"> Oh run somewhere as an</font>

657
00:37:00,700 --> 00:37:07,240
impact of the<font color="#CCCCCC"> I dunno diffusion anti</font>

658
00:37:04,570 --> 00:37:11,950
<font color="#CCCCCC">viruses</font><font color="#E5E5E5"> why people want to do several</font>

659
00:37:07,240 --> 00:37:14,200
versions<font color="#E5E5E5"> I didn't really say so why</font>

660
00:37:11,950 --> 00:37:16,000
people<font color="#CCCCCC"> were</font><font color="#E5E5E5"> designing one somewhere I</font>

661
00:37:14,200 --> 00:37:18,370
want<font color="#E5E5E5"> to do several different version</font>

662
00:37:16,000 --> 00:37:20,740
what is the impact of the first v1 on

663
00:37:18,370 --> 00:37:23,890
the antivirus is on the second<font color="#E5E5E5"> one and</font>

664
00:37:20,740 --> 00:37:27,399
so<font color="#CCCCCC"> on so what</font><font color="#E5E5E5"> impact it has that they're</font>

665
00:37:23,890 --> 00:37:30,520
racing quickly<font color="#E5E5E5"> yeah</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> so it creates</font>

666
00:37:27,400 --> 00:37:34,900
<font color="#CCCCCC">more</font><font color="#E5E5E5"> work because they need to</font><font color="#CCCCCC"> track new</font>

667
00:37:30,520 --> 00:37:36,820
versions<font color="#E5E5E5"> and if there's</font><font color="#CCCCCC"> there frequent</font>

668
00:37:34,900 --> 00:37:45,030
releases<font color="#E5E5E5"> then it's more difficult to</font>

669
00:37:36,820 --> 00:37:45,030
track<font color="#CCCCCC"> another</font><font color="#E5E5E5"> question</font>

670
00:38:00,520 --> 00:38:08,390
yeah I'd like<font color="#E5E5E5"> to</font><font color="#CCCCCC"> know what kind of file</font>

671
00:38:04,940 --> 00:38:11,210
size are we<font color="#CCCCCC"> dealing with here are</font><font color="#E5E5E5"> the</font>

672
00:38:08,390 --> 00:38:16,040
size<font color="#E5E5E5"> requirements of the file is to be</font>

673
00:38:11,210 --> 00:38:17,990
very<font color="#E5E5E5"> small or is it several Meg's</font><font color="#CCCCCC"> what</font>

674
00:38:16,040 --> 00:38:21,050
<font color="#CCCCCC">they Marvel itself or the</font><font color="#E5E5E5"> encrypted</font>

675
00:38:17,990 --> 00:38:23,899
files for the email attachment for

676
00:38:21,050 --> 00:38:28,010
example the inner attachment is small

677
00:38:23,900 --> 00:38:31,520
because it's just<font color="#E5E5E5"> a dropper</font><font color="#CCCCCC"> and so it's</font>

678
00:38:28,010 --> 00:38:35,720
pretty<font color="#E5E5E5"> small and then the whole</font><font color="#CCCCCC"> virus to</font>

679
00:38:31,520 --> 00:38:39,590
download<font color="#CCCCCC"> afterburn</font><font color="#E5E5E5"> mojo so the</font>

680
00:38:35,720 --> 00:38:52,000
downloaded<font color="#CCCCCC"> Marvel itself is like a few</font>

681
00:38:39,590 --> 00:38:52,000
megabytes<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> that's someone else I</font>

682
00:38:54,160 --> 00:39:00,200
have a question for you<font color="#CCCCCC"> why did you</font>

683
00:38:57,290 --> 00:39:04,910
<font color="#CCCCCC">choose this family</font><font color="#E5E5E5"> is it representative</font>

684
00:39:00,200 --> 00:39:09,319
of a<font color="#CCCCCC"> new trend</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> foreign somewhere it's</font>

685
00:39:04,910 --> 00:39:13,460
not new in a sense that it's ransomware

686
00:39:09,320 --> 00:39:16,190
has been around forever<font color="#CCCCCC"> but it's new in</font>

687
00:39:13,460 --> 00:39:18,620
a sense of that it's developing more

688
00:39:16,190 --> 00:39:26,930
quickly than usual<font color="#CCCCCC"> and it's using</font>

689
00:39:18,620 --> 00:39:32,350
exploits like it's not usual so let's

690
00:39:26,930 --> 00:39:32,350
thank you the speaker<font color="#E5E5E5"> again thank you</font>

