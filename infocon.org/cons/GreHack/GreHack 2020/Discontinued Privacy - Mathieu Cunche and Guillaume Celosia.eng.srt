1
00:00:01,120 --> 00:00:04,319
hello my name is matt cash i'm an

2
00:00:03,120 --> 00:00:06,399
associate professor at

3
00:00:04,319 --> 00:00:08,160
insalion and i'm going to present you a

4
00:00:06,399 --> 00:00:11,200
joint work with my

5
00:00:08,160 --> 00:00:11,840
former pg student guillaume celosia so

6
00:00:11,200 --> 00:00:14,879
this work

7
00:00:11,840 --> 00:00:17,279
is about bluetooth low energy

8
00:00:14,880 --> 00:00:18,400
conservative protocols that are used by

9
00:00:17,279 --> 00:00:21,279
apple devices

10
00:00:18,400 --> 00:00:24,000
and the kind of privacy issues that you

11
00:00:21,279 --> 00:00:26,000
may have with those protocols

12
00:00:24,000 --> 00:00:27,039
so first what are apple continuity

13
00:00:26,000 --> 00:00:30,320
protocols

14
00:00:27,039 --> 00:00:33,440
so uppercase 3t is a family of services

15
00:00:30,320 --> 00:00:37,920
provided by apple devices such as

16
00:00:33,440 --> 00:00:40,800
airdrop apple pay instant all spots

17
00:00:37,920 --> 00:00:41,520
end off so end off is a tool that can

18
00:00:40,800 --> 00:00:43,680
use to

19
00:00:41,520 --> 00:00:45,360
transfer one activity such as writing an

20
00:00:43,680 --> 00:00:47,920
email from one device

21
00:00:45,360 --> 00:00:48,800
to the other so those continuity

22
00:00:47,920 --> 00:00:51,039
protocol the

23
00:00:48,800 --> 00:00:52,480
the main purpose is to enable

24
00:00:51,039 --> 00:00:55,840
interaction between

25
00:00:52,480 --> 00:00:56,559
nearby devices and how it works in

26
00:00:55,840 --> 00:00:59,039
practice

27
00:00:56,559 --> 00:01:01,599
is that they leverage bluetooth

28
00:00:59,039 --> 00:01:04,559
communication to carry

29
00:01:01,600 --> 00:01:04,879
information between nearby devices so

30
00:01:04,559 --> 00:01:07,600
it's

31
00:01:04,879 --> 00:01:09,520
more specifically it's bluetooth low

32
00:01:07,600 --> 00:01:11,199
energy that is used here

33
00:01:09,520 --> 00:01:12,720
so if you need to transfer an activity

34
00:01:11,200 --> 00:01:15,840
from one smartphone to

35
00:01:12,720 --> 00:01:17,920
your laptop this will be done by

36
00:01:15,840 --> 00:01:20,320
transferring some data over bluetooth

37
00:01:17,920 --> 00:01:22,799
energy

38
00:01:20,320 --> 00:01:23,839
so more particularly what kind of

39
00:01:22,799 --> 00:01:27,439
messages are

40
00:01:23,840 --> 00:01:30,079
used for that they use

41
00:01:27,439 --> 00:01:30,960
bluetooth low energy advertisement

42
00:01:30,079 --> 00:01:34,000
packets

43
00:01:30,960 --> 00:01:35,439
so those packets are transmitted

44
00:01:34,000 --> 00:01:38,320
periodically by

45
00:01:35,439 --> 00:01:39,600
bluetooth energy devices in order to

46
00:01:38,320 --> 00:01:43,039
announce their presence

47
00:01:39,600 --> 00:01:45,919
but in addition the bluetooth consortium

48
00:01:43,040 --> 00:01:46,560
enabled the possibility to include

49
00:01:45,920 --> 00:01:50,439
custom

50
00:01:46,560 --> 00:01:51,920
data in those packets inside the

51
00:01:50,439 --> 00:01:55,199
manufacturer-specific

52
00:01:51,920 --> 00:01:57,280
fields and this is what apple did so

53
00:01:55,200 --> 00:01:58,000
they use this manufacturer-specific

54
00:01:57,280 --> 00:02:01,280
field

55
00:01:58,000 --> 00:02:02,560
to include their data used by continuity

56
00:02:01,280 --> 00:02:05,360
protocols so

57
00:02:02,560 --> 00:02:06,159
inside the fields used by apple you will

58
00:02:05,360 --> 00:02:08,399
find

59
00:02:06,159 --> 00:02:09,920
continuity messages potentially several

60
00:02:08,399 --> 00:02:12,160
of them

61
00:02:09,919 --> 00:02:13,839
inside the same field and each of those

62
00:02:12,160 --> 00:02:17,440
continuity messages

63
00:02:13,840 --> 00:02:19,920
will follow um a typelength data

64
00:02:17,440 --> 00:02:19,920
format

65
00:02:20,879 --> 00:02:27,200
so those uh messages uh they are

66
00:02:24,160 --> 00:02:30,560
broadcasted uh in clear so

67
00:02:27,200 --> 00:02:32,640
there is no encryption on that um

68
00:02:30,560 --> 00:02:34,720
means that the information is available

69
00:02:32,640 --> 00:02:36,799
to any eavesdropper and this has been

70
00:02:34,720 --> 00:02:40,640
noticed by several works that have

71
00:02:36,800 --> 00:02:43,360
identified um serious previous issues

72
00:02:40,640 --> 00:02:45,279
associated with the use of continuity

73
00:02:43,360 --> 00:02:47,840
protocols

74
00:02:45,280 --> 00:02:49,120
most of those works they present

75
00:02:47,840 --> 00:02:51,519
tracking attacks

76
00:02:49,120 --> 00:02:53,280
in which an attacker can track a device

77
00:02:51,519 --> 00:02:55,599
over time because there are some

78
00:02:53,280 --> 00:02:57,599
identifiers that are included in those

79
00:02:55,599 --> 00:03:00,560
messages

80
00:02:57,599 --> 00:03:01,359
however those work they only discovered

81
00:03:00,560 --> 00:03:03,760
the tip

82
00:03:01,360 --> 00:03:04,720
of the iceberg with regard to privacy

83
00:03:03,760 --> 00:03:07,120
issues

84
00:03:04,720 --> 00:03:10,319
because they only add a partial

85
00:03:07,120 --> 00:03:13,519
understanding of the messages

86
00:03:10,319 --> 00:03:17,119
and what we did in our work is to

87
00:03:13,519 --> 00:03:20,319
reveal the rest of the iceberg

88
00:03:17,120 --> 00:03:23,840
by discovering the full

89
00:03:20,319 --> 00:03:27,040
meaning of the continuity messages

90
00:03:23,840 --> 00:03:29,280
so we wanted to understand what were

91
00:03:27,040 --> 00:03:32,480
those quantity messages meaning

92
00:03:29,280 --> 00:03:36,000
to basically understand the language

93
00:03:32,480 --> 00:03:37,599
of apple devices how they talk over

94
00:03:36,000 --> 00:03:41,599
bluetooth

95
00:03:37,599 --> 00:03:45,040
the problem is that those messages

96
00:03:41,599 --> 00:03:46,079
there is no public documentation about

97
00:03:45,040 --> 00:03:48,879
it so there is

98
00:03:46,080 --> 00:03:50,480
little information the software is close

99
00:03:48,879 --> 00:03:53,518
source and you will find

100
00:03:50,480 --> 00:03:55,679
no documentation almost from apple so

101
00:03:53,519 --> 00:03:57,680
what we did is we had recourse to

102
00:03:55,680 --> 00:04:00,959
reverse engineering to understand

103
00:03:57,680 --> 00:04:04,640
what where the meaning of those messages

104
00:04:00,959 --> 00:04:05,439
we first had a look at apple debugging

105
00:04:04,640 --> 00:04:08,720
tools to

106
00:04:05,439 --> 00:04:10,000
reverse engineering those messages then

107
00:04:08,720 --> 00:04:12,159
we also crafted

108
00:04:10,000 --> 00:04:13,519
our own contributing messages and

109
00:04:12,159 --> 00:04:16,159
finally

110
00:04:13,519 --> 00:04:17,440
we made a bit of disassembly of some of

111
00:04:16,160 --> 00:04:20,959
the binaries

112
00:04:17,440 --> 00:04:23,919
involved in continuity protocols

113
00:04:20,959 --> 00:04:25,919
so the first tool that we used was

114
00:04:23,919 --> 00:04:27,440
provided by apple it's called packet

115
00:04:25,919 --> 00:04:28,000
logger and packet decoder it's a

116
00:04:27,440 --> 00:04:31,600
debugging

117
00:04:28,000 --> 00:04:34,400
tool that will pass and log

118
00:04:31,600 --> 00:04:36,080
messages incoming on your device

119
00:04:34,400 --> 00:04:38,400
including the bluetooth

120
00:04:36,080 --> 00:04:40,080
messages so for each message you will

121
00:04:38,400 --> 00:04:42,960
have the meaning

122
00:04:40,080 --> 00:04:44,639
of the message as well as some potential

123
00:04:42,960 --> 00:04:45,680
actions that are triggered by the

124
00:04:44,639 --> 00:04:47,680
reception

125
00:04:45,680 --> 00:04:49,040
so it was really useful to get a first

126
00:04:47,680 --> 00:04:52,800
glimpse of

127
00:04:49,040 --> 00:04:56,080
what were those messages about

128
00:04:52,800 --> 00:04:59,919
then um we had recalls to crafting

129
00:04:56,080 --> 00:05:03,840
our own continuity messages

130
00:04:59,919 --> 00:05:06,400
so using hci tool we generated

131
00:05:03,840 --> 00:05:08,479
custom messages based on the templates

132
00:05:06,400 --> 00:05:11,679
of messages we've already

133
00:05:08,479 --> 00:05:14,479
observed and we sent broadcasted

134
00:05:11,680 --> 00:05:15,520
those messages over the air and we

135
00:05:14,479 --> 00:05:17,840
observe

136
00:05:15,520 --> 00:05:19,198
actions that were potentially triggered

137
00:05:17,840 --> 00:05:22,239
on nearby devices

138
00:05:19,199 --> 00:05:24,479
but most importantly we had a look at

139
00:05:22,240 --> 00:05:26,560
how they were interpreted by packet

140
00:05:24,479 --> 00:05:30,159
logger so this was another

141
00:05:26,560 --> 00:05:32,960
good source of information to understand

142
00:05:30,160 --> 00:05:34,240
the meaning of those messages and

143
00:05:32,960 --> 00:05:36,479
finally

144
00:05:34,240 --> 00:05:39,199
we did some disassembly so we selected

145
00:05:36,479 --> 00:05:42,639
the number of binaries and

146
00:05:39,199 --> 00:05:43,520
such as call speech used by the siri

147
00:05:42,639 --> 00:05:46,400
voice assistant

148
00:05:43,520 --> 00:05:47,758
sharing d involved in the airdrop

149
00:05:46,400 --> 00:05:49,840
functionalities

150
00:05:47,759 --> 00:05:52,080
also packet decoder and packet logger

151
00:05:49,840 --> 00:05:53,280
the two tools i've talked about and

152
00:05:52,080 --> 00:05:56,560
other softwares

153
00:05:53,280 --> 00:05:59,758
like omkit accessory simulator

154
00:05:56,560 --> 00:06:03,120
and what we had it was pretty neat

155
00:05:59,759 --> 00:06:05,919
we managed to get the

156
00:06:03,120 --> 00:06:07,759
information on all the messages uh so

157
00:06:05,919 --> 00:06:10,560
the format of those messages but

158
00:06:07,759 --> 00:06:12,800
most importantly uh the meaning of the

159
00:06:10,560 --> 00:06:13,280
code so for instance in this our case

160
00:06:12,800 --> 00:06:14,720
here

161
00:06:13,280 --> 00:06:16,880
when i'm presenting the code i'm

162
00:06:14,720 --> 00:06:19,680
presenting is related to

163
00:06:16,880 --> 00:06:20,080
the passing of one message that is

164
00:06:19,680 --> 00:06:23,360
called

165
00:06:20,080 --> 00:06:25,120
action and can have many types

166
00:06:23,360 --> 00:06:27,280
here i'm just linked listing the first

167
00:06:25,120 --> 00:06:29,759
types of this uh

168
00:06:27,280 --> 00:06:30,400
message uh so for instance if the value

169
00:06:29,759 --> 00:06:33,120
is

170
00:06:30,400 --> 00:06:35,440
three it's for mobile backup for it for

171
00:06:33,120 --> 00:06:38,479
watch setup and five it's for

172
00:06:35,440 --> 00:06:40,880
apple tv pair so

173
00:06:38,479 --> 00:06:43,039
we had uh thanks to those three

174
00:06:40,880 --> 00:06:45,440
approaches we managed to get a i mean

175
00:06:43,039 --> 00:06:46,840
pretty good view and what i can say is

176
00:06:45,440 --> 00:06:50,000
almost all the

177
00:06:46,840 --> 00:06:50,719
uh we we basically understood everything

178
00:06:50,000 --> 00:06:54,160
uh

179
00:06:50,720 --> 00:06:57,599
other language of uh upper continuity

180
00:06:54,160 --> 00:07:00,080
so what we asked was um the

181
00:06:57,599 --> 00:07:03,280
understanding of all the messages so we

182
00:07:00,080 --> 00:07:05,198
had a total of 10 messages type

183
00:07:03,280 --> 00:07:06,960
for each message we have the format of

184
00:07:05,199 --> 00:07:10,000
the message so different fields

185
00:07:06,960 --> 00:07:10,638
composing this message and also for each

186
00:07:10,000 --> 00:07:12,400
field

187
00:07:10,639 --> 00:07:14,720
the meaning of the code sometimes you

188
00:07:12,400 --> 00:07:17,919
have some codes in there

189
00:07:14,720 --> 00:07:21,599
so a lot of information that

190
00:07:17,919 --> 00:07:24,719
is listed and available inside

191
00:07:21,599 --> 00:07:28,159
our paper so now we

192
00:07:24,720 --> 00:07:30,800
understand fully the language of apple

193
00:07:28,160 --> 00:07:32,800
devices and we are ready to start

194
00:07:30,800 --> 00:07:36,160
investigating for potential

195
00:07:32,800 --> 00:07:39,520
privacy and security issues

196
00:07:36,160 --> 00:07:41,520
so we discovered many things uh but

197
00:07:39,520 --> 00:07:45,039
in this presentation i'm just gonna talk

198
00:07:41,520 --> 00:07:46,159
about four of them physical tracking so

199
00:07:45,039 --> 00:07:48,639
you can track users

200
00:07:46,160 --> 00:07:50,080
uh spying how we can spy on the smart

201
00:07:48,639 --> 00:07:53,280
home activity

202
00:07:50,080 --> 00:07:54,000
uh how some emails and phone numbers are

203
00:07:53,280 --> 00:07:57,198
leaked

204
00:07:54,000 --> 00:08:00,639
and finally the case of uh

205
00:07:57,199 --> 00:08:02,000
siri spoken comments

206
00:08:00,639 --> 00:08:04,560
so let's start with the physical

207
00:08:02,000 --> 00:08:07,360
tracking so physical tracking

208
00:08:04,560 --> 00:08:09,919
of ble devices and their user is

209
00:08:07,360 --> 00:08:11,840
possible because

210
00:08:09,919 --> 00:08:13,599
those devices they broadcast

211
00:08:11,840 --> 00:08:15,119
periodically advertisement packets the

212
00:08:13,599 --> 00:08:18,080
packets in which

213
00:08:15,120 --> 00:08:19,759
apple continuity are messages are

214
00:08:18,080 --> 00:08:22,960
included

215
00:08:19,759 --> 00:08:23,919
and those messages like any bluetooth

216
00:08:22,960 --> 00:08:28,239
messages they

217
00:08:23,919 --> 00:08:31,280
include a device address

218
00:08:28,240 --> 00:08:34,959
which could be used to track the user

219
00:08:31,280 --> 00:08:37,919
the device and the user over time so to

220
00:08:34,958 --> 00:08:38,958
limit this risk the bluetooth consortium

221
00:08:37,919 --> 00:08:42,079
are included

222
00:08:38,958 --> 00:08:43,039
inside the specification the possibility

223
00:08:42,080 --> 00:08:46,160
to

224
00:08:43,039 --> 00:08:46,720
use random addresses instead of the real

225
00:08:46,160 --> 00:08:49,839
address

226
00:08:46,720 --> 00:08:52,240
so periodically the device will switch

227
00:08:49,839 --> 00:08:55,680
to a new random address

228
00:08:52,240 --> 00:08:56,640
and doing so it will prevent any passive

229
00:08:55,680 --> 00:08:59,439
attacker from

230
00:08:56,640 --> 00:09:01,439
tracking the device over time based on

231
00:08:59,440 --> 00:09:04,320
the device address

232
00:09:01,440 --> 00:09:05,839
so this is a good thing but uh this is

233
00:09:04,320 --> 00:09:08,640
only about the device address

234
00:09:05,839 --> 00:09:09,440
and many works have shown that if you

235
00:09:08,640 --> 00:09:11,680
include

236
00:09:09,440 --> 00:09:13,120
all the data inside those advertising

237
00:09:11,680 --> 00:09:17,120
packets

238
00:09:13,120 --> 00:09:21,279
your device could still be tracked

239
00:09:17,120 --> 00:09:25,040
for instance inside

240
00:09:21,279 --> 00:09:28,560
continuity messages we identified that

241
00:09:25,040 --> 00:09:32,240
the airport message airport devices um

242
00:09:28,560 --> 00:09:34,000
and along with the case uh broadcast

243
00:09:32,240 --> 00:09:36,080
continuity messages in which you have

244
00:09:34,000 --> 00:09:40,080
information about the states of

245
00:09:36,080 --> 00:09:43,839
the airport sets so basically the

246
00:09:40,080 --> 00:09:47,600
battery states and the number of time

247
00:09:43,839 --> 00:09:49,760
the case has been opened

248
00:09:47,600 --> 00:09:51,200
and all this is advertised in clear of

249
00:09:49,760 --> 00:09:55,200
course

250
00:09:51,200 --> 00:09:58,880
so here we presented on this figure

251
00:09:55,200 --> 00:10:01,360
the evolution of the device address

252
00:09:58,880 --> 00:10:03,279
how it changes over time so the vertical

253
00:10:01,360 --> 00:10:05,600
gray and white stripes are

254
00:10:03,279 --> 00:10:06,800
the device address changes so the device

255
00:10:05,600 --> 00:10:10,079
address is changing

256
00:10:06,800 --> 00:10:12,160
every approximately 15 minutes

257
00:10:10,079 --> 00:10:14,239
and you can also see the lead open

258
00:10:12,160 --> 00:10:18,000
counter and the different battery levels

259
00:10:14,240 --> 00:10:20,560
of the device and if you look

260
00:10:18,000 --> 00:10:21,120
at the first leaderpod counter you can

261
00:10:20,560 --> 00:10:24,160
see that

262
00:10:21,120 --> 00:10:24,959
uh the this value remains uh the same

263
00:10:24,160 --> 00:10:27,120
for

264
00:10:24,959 --> 00:10:29,279
period that is way longer than the

265
00:10:27,120 --> 00:10:31,200
duration of a device address so

266
00:10:29,279 --> 00:10:33,439
this could be used to link to

267
00:10:31,200 --> 00:10:36,720
consecutive random addresses

268
00:10:33,440 --> 00:10:39,680
same thing for the battery level it has

269
00:10:36,720 --> 00:10:40,720
it stays the same for a period that is

270
00:10:39,680 --> 00:10:43,839
longer than

271
00:10:40,720 --> 00:10:44,880
the duration of 15 minutes used by the

272
00:10:43,839 --> 00:10:47,040
random address

273
00:10:44,880 --> 00:10:48,240
so based on the artifact broadcasted

274
00:10:47,040 --> 00:10:51,760
inside those

275
00:10:48,240 --> 00:10:56,160
messages it becomes kind of trivial

276
00:10:51,760 --> 00:10:59,360
to link consecutive addresses

277
00:10:56,160 --> 00:11:01,279
of a device and so you can defeat the

278
00:10:59,360 --> 00:11:02,640
purpose of advanced randomization and

279
00:11:01,279 --> 00:11:06,959
you can track

280
00:11:02,640 --> 00:11:09,279
advice and its owner over time

281
00:11:06,959 --> 00:11:12,479
but there are other examples of issues

282
00:11:09,279 --> 00:11:12,480
in in the paper

283
00:11:12,640 --> 00:11:16,880
second thing i want to talk about is how

284
00:11:15,680 --> 00:11:20,959
we can spy

285
00:11:16,880 --> 00:11:23,360
on smart home activity uh thanks to the

286
00:11:20,959 --> 00:11:24,560
messages emitted by uh smart home

287
00:11:23,360 --> 00:11:27,279
appliances

288
00:11:24,560 --> 00:11:28,640
so apple has introduced uh home kit so

289
00:11:27,279 --> 00:11:32,000
it's a framework for

290
00:11:28,640 --> 00:11:33,040
smart home uh it's used by apple devices

291
00:11:32,000 --> 00:11:36,480
but also by

292
00:11:33,040 --> 00:11:38,719
other vendors and each

293
00:11:36,480 --> 00:11:40,160
device using this framework is

294
00:11:38,720 --> 00:11:42,640
periodically

295
00:11:40,160 --> 00:11:43,199
transmitting broadcasting contributing

296
00:11:42,640 --> 00:11:46,240
messages

297
00:11:43,200 --> 00:11:49,279
in which you have a global state number

298
00:11:46,240 --> 00:11:50,079
and this global state number is

299
00:11:49,279 --> 00:11:53,680
basically

300
00:11:50,079 --> 00:11:55,279
a counter that follows the state of the

301
00:11:53,680 --> 00:11:57,279
device so whenever the state of your

302
00:11:55,279 --> 00:11:59,120
device changes

303
00:11:57,279 --> 00:12:00,560
this counter will be incremented so

304
00:11:59,120 --> 00:12:01,279
whenever for instance in the case of a

305
00:12:00,560 --> 00:12:04,160
light bulb

306
00:12:01,279 --> 00:12:05,839
whenever you turn it on or off the

307
00:12:04,160 --> 00:12:06,959
global state number of your light bulb

308
00:12:05,839 --> 00:12:08,959
will be incremented

309
00:12:06,959 --> 00:12:10,479
so by observing the evolution of the

310
00:12:08,959 --> 00:12:12,319
global state number

311
00:12:10,480 --> 00:12:14,240
you will be able to see if there is any

312
00:12:12,320 --> 00:12:17,519
activity inside the house and you can

313
00:12:14,240 --> 00:12:20,880
see which devices are used by

314
00:12:17,519 --> 00:12:23,920
the occupants so it's pretty invasive

315
00:12:20,880 --> 00:12:27,279
so to test uh to see

316
00:12:23,920 --> 00:12:29,920
how we can do that we conducted the

317
00:12:27,279 --> 00:12:30,560
small experiments in which we had a

318
00:12:29,920 --> 00:12:33,680
smart

319
00:12:30,560 --> 00:12:35,760
light bulb and a presence detector

320
00:12:33,680 --> 00:12:37,040
and we both placed them inside our

321
00:12:35,760 --> 00:12:39,439
office

322
00:12:37,040 --> 00:12:40,959
and we monitored the messages from

323
00:12:39,440 --> 00:12:44,959
outside the room

324
00:12:40,959 --> 00:12:48,000
and observed what we managed to to get

325
00:12:44,959 --> 00:12:51,199
and this was pretty obvious uh

326
00:12:48,000 --> 00:12:52,800
so here i'm presenting the

327
00:12:51,200 --> 00:12:54,800
the evolution of the global state number

328
00:12:52,800 --> 00:12:56,719
so each spy here presents a change in

329
00:12:54,800 --> 00:12:58,079
the robot state number either for the

330
00:12:56,720 --> 00:13:01,200
merchant sensor or

331
00:12:58,079 --> 00:13:04,800
the light bulb and you can see that

332
00:13:01,200 --> 00:13:08,160
based on these uh indicators you can

333
00:13:04,800 --> 00:13:09,760
see when we arrive at the office when we

334
00:13:08,160 --> 00:13:13,760
leave the office

335
00:13:09,760 --> 00:13:17,600
the also the lunch break we add

336
00:13:13,760 --> 00:13:20,399
during the day and you can even detect

337
00:13:17,600 --> 00:13:22,720
when the janitor is entering the office

338
00:13:20,399 --> 00:13:26,720
early in the morning

339
00:13:22,720 --> 00:13:29,680
so by remotely and passively

340
00:13:26,720 --> 00:13:30,079
listening to billy messages you can have

341
00:13:29,680 --> 00:13:33,199
a

342
00:13:30,079 --> 00:13:34,079
quite good idea of if there is someone

343
00:13:33,200 --> 00:13:37,360
inside a

344
00:13:34,079 --> 00:13:39,199
smart home and what this person is

345
00:13:37,360 --> 00:13:41,040
is doing so it's a bit uh it's a bit

346
00:13:39,199 --> 00:13:42,639
scary and of course all these messages

347
00:13:41,040 --> 00:13:48,079
are broadcasted and clear so

348
00:13:42,639 --> 00:13:48,639
there is no security to break here all

349
00:13:48,079 --> 00:13:51,760
right

350
00:13:48,639 --> 00:13:55,440
um a third point i want to discuss

351
00:13:51,760 --> 00:13:57,519
is the cases of the airdrop

352
00:13:55,440 --> 00:13:59,279
messages and nearby action used for

353
00:13:57,519 --> 00:14:01,839
wi-fi credential sharing

354
00:13:59,279 --> 00:14:04,079
in which we found that there are

355
00:14:01,839 --> 00:14:04,800
identifiers that are included so those

356
00:14:04,079 --> 00:14:08,719
identifiers

357
00:14:04,800 --> 00:14:10,959
are not included in clear they are ashed

358
00:14:08,720 --> 00:14:12,560
and why do they include identifiers in

359
00:14:10,959 --> 00:14:14,880
there it's for

360
00:14:12,560 --> 00:14:16,079
a friendly device and notification so

361
00:14:14,880 --> 00:14:19,920
for instance if you want to

362
00:14:16,079 --> 00:14:22,880
send a file to the device of a friend

363
00:14:19,920 --> 00:14:24,639
uh before establishing the connection

364
00:14:22,880 --> 00:14:26,800
the devices will make sure that

365
00:14:24,639 --> 00:14:28,240
the owner knows each other so you will

366
00:14:26,800 --> 00:14:32,160
send your identifier

367
00:14:28,240 --> 00:14:34,320
and the recipients will look up inside

368
00:14:32,160 --> 00:14:36,240
the contact list to see if there is a

369
00:14:34,320 --> 00:14:38,320
matching identifier so if you know the

370
00:14:36,240 --> 00:14:40,320
person

371
00:14:38,320 --> 00:14:42,560
so those identifiers are not sent in

372
00:14:40,320 --> 00:14:45,839
clear as i said they are ash using

373
00:14:42,560 --> 00:14:48,079
sha 256 and then later on they are

374
00:14:45,839 --> 00:14:49,199
truncated either to 16 bits in the case

375
00:14:48,079 --> 00:14:52,079
of airdrop or

376
00:14:49,199 --> 00:14:55,040
24 bits in the case of nearby action for

377
00:14:52,079 --> 00:14:57,920
the wi-fi credential sharing

378
00:14:55,040 --> 00:14:58,639
the problem is as you know that hashing

379
00:14:57,920 --> 00:15:01,680
is not

380
00:14:58,639 --> 00:15:05,040
a good way to protect

381
00:15:01,680 --> 00:15:07,439
uh identifiers in fact many words have

382
00:15:05,040 --> 00:15:10,000
shown that you can reverse this hashing

383
00:15:07,440 --> 00:15:10,880
using guesswork basically it's a brute

384
00:15:10,000 --> 00:15:12,480
force attack

385
00:15:10,880 --> 00:15:14,079
in which you try all the possible

386
00:15:12,480 --> 00:15:17,120
identifiers

387
00:15:14,079 --> 00:15:19,279
and this is what we try to evaluate uh

388
00:15:17,120 --> 00:15:21,440
using hypothetical attacks so we did not

389
00:15:19,279 --> 00:15:23,519
perform these attacks we just

390
00:15:21,440 --> 00:15:25,600
estimate the cost and the success rate

391
00:15:23,519 --> 00:15:29,199
of those attacks

392
00:15:25,600 --> 00:15:30,000
so we considered hypothetical sets of

393
00:15:29,199 --> 00:15:32,959
phone numbers

394
00:15:30,000 --> 00:15:34,240
and email addresses of various sizes and

395
00:15:32,959 --> 00:15:36,319
we computed the

396
00:15:34,240 --> 00:15:37,600
amount of time that we would take to

397
00:15:36,320 --> 00:15:40,800
test

398
00:15:37,600 --> 00:15:42,480
all the values as well there is an offer

399
00:15:40,800 --> 00:15:43,439
another thing to consider is the number

400
00:15:42,480 --> 00:15:46,639
of matches

401
00:15:43,440 --> 00:15:48,959
because when you uh

402
00:15:46,639 --> 00:15:51,440
compute the hash you only you fall back

403
00:15:48,959 --> 00:15:53,758
to either 16 bits or 24 bits

404
00:15:51,440 --> 00:15:55,519
so it's a for in the case of 16 bits in

405
00:15:53,759 --> 00:15:59,839
particular it's quite a small

406
00:15:55,519 --> 00:16:02,800
set it's 250 um to the power of 16

407
00:15:59,839 --> 00:16:05,040
different values um which means that if

408
00:16:02,800 --> 00:16:06,639
you have a set that is larger than that

409
00:16:05,040 --> 00:16:08,880
you can have ambiguities for several

410
00:16:06,639 --> 00:16:10,959
identifier matching the same

411
00:16:08,880 --> 00:16:13,439
hash so you will not know which of them

412
00:16:10,959 --> 00:16:16,479
is the correct one

413
00:16:13,440 --> 00:16:17,440
so we evaluated those two metrics so

414
00:16:16,480 --> 00:16:20,079
first the guesswork

415
00:16:17,440 --> 00:16:21,040
time the attack time is i mean pretty

416
00:16:20,079 --> 00:16:22,959
easy to achieve

417
00:16:21,040 --> 00:16:24,800
in the worst case we have a computation

418
00:16:22,959 --> 00:16:26,719
time of one hour

419
00:16:24,800 --> 00:16:28,319
and in the base case is less than one

420
00:16:26,720 --> 00:16:30,639
second

421
00:16:28,320 --> 00:16:32,480
but also we looked so computation is not

422
00:16:30,639 --> 00:16:32,800
a problem the only problem is the number

423
00:16:32,480 --> 00:16:36,000
of

424
00:16:32,800 --> 00:16:39,279
hashes that will match so in the case of

425
00:16:36,000 --> 00:16:41,040
a 16-bit identifier you have a matching

426
00:16:39,279 --> 00:16:43,040
set that is quite large

427
00:16:41,040 --> 00:16:45,599
so for instance you can have more than

428
00:16:43,040 --> 00:16:46,959
uh 70 000 matching entity files which is

429
00:16:45,600 --> 00:16:50,240
not very practical

430
00:16:46,959 --> 00:16:51,119
but if you have 24 bits uh you have much

431
00:16:50,240 --> 00:16:53,199
smaller sets

432
00:16:51,120 --> 00:16:54,639
and that can be used to narrow down your

433
00:16:53,199 --> 00:16:56,880
your search

434
00:16:54,639 --> 00:16:58,320
so for instance you can try uh all the

435
00:16:56,880 --> 00:17:00,959
phone numbers registered

436
00:16:58,320 --> 00:17:02,480
the landline phone numbers uh in average

437
00:17:00,959 --> 00:17:05,760
you will have only two matches

438
00:17:02,480 --> 00:17:08,559
uh with the um

439
00:17:05,760 --> 00:17:11,280
the the the 24 bits identifier

440
00:17:08,559 --> 00:17:14,959
broadcasted by the nearby actions

441
00:17:11,280 --> 00:17:15,599
uh on the other end um if you looked at

442
00:17:14,959 --> 00:17:18,640
uh

443
00:17:15,599 --> 00:17:22,480
smaller sets like uh

444
00:17:18,640 --> 00:17:24,959
for email addresses like the the

445
00:17:22,480 --> 00:17:27,439
users inside a university department

446
00:17:24,959 --> 00:17:30,960
like 7 000 users

447
00:17:27,439 --> 00:17:32,480
here you will have only one match that

448
00:17:30,960 --> 00:17:35,600
will happen

449
00:17:32,480 --> 00:17:38,559
so this shows that depending on the so

450
00:17:35,600 --> 00:17:39,918
depending on the the set of the size uh

451
00:17:38,559 --> 00:17:40,960
it would you will be more or less

452
00:17:39,919 --> 00:17:44,559
successful at

453
00:17:40,960 --> 00:17:48,320
uh identifying uniquely uh the

454
00:17:44,559 --> 00:17:51,280
the user in practice

455
00:17:48,320 --> 00:17:52,399
this shows that you need to prepare your

456
00:17:51,280 --> 00:17:54,320
work and to target

457
00:17:52,400 --> 00:17:56,000
a bit your user but for instance if you

458
00:17:54,320 --> 00:18:00,960
are in a small group that is

459
00:17:56,000 --> 00:18:03,919
quite easy to do

460
00:18:00,960 --> 00:18:04,480
and the last points i'm going to briefly

461
00:18:03,919 --> 00:18:09,120
discuss

462
00:18:04,480 --> 00:18:11,600
is the case of siri messages

463
00:18:09,120 --> 00:18:13,280
so siri is the voice assistant used by

464
00:18:11,600 --> 00:18:16,719
apple

465
00:18:13,280 --> 00:18:17,200
um and we discovered that whenever you

466
00:18:16,720 --> 00:18:20,320
talk

467
00:18:17,200 --> 00:18:22,160
to your device your phone

468
00:18:20,320 --> 00:18:23,520
whenever you send a comment to your

469
00:18:22,160 --> 00:18:27,360
phone your phone

470
00:18:23,520 --> 00:18:30,720
in parallel will send will broadcast

471
00:18:27,360 --> 00:18:33,199
a continuity message in which you have

472
00:18:30,720 --> 00:18:35,440
a hash a personal hash of the voice

473
00:18:33,200 --> 00:18:38,480
command you've just spoken

474
00:18:35,440 --> 00:18:40,400
so these perception hashes are

475
00:18:38,480 --> 00:18:43,280
not like cryptographic hashes in the

476
00:18:40,400 --> 00:18:45,200
sense that if there is a small variation

477
00:18:43,280 --> 00:18:46,160
in the input so in small variation in

478
00:18:45,200 --> 00:18:48,240
your command

479
00:18:46,160 --> 00:18:49,200
there will be a small variation inside

480
00:18:48,240 --> 00:18:51,120
the hash or

481
00:18:49,200 --> 00:18:53,600
sometimes if the variation is small

482
00:18:51,120 --> 00:18:56,159
enough there will be no changes at all

483
00:18:53,600 --> 00:18:56,799
uh so it's basically those specific

484
00:18:56,160 --> 00:19:00,640
hashes

485
00:18:56,799 --> 00:19:04,480
they are used to identify uh

486
00:19:00,640 --> 00:19:09,280
comments like voices or images

487
00:19:04,480 --> 00:19:11,760
to this kind of signal identification

488
00:19:09,280 --> 00:19:13,440
uh and so how it works is whenever you

489
00:19:11,760 --> 00:19:15,760
send a voice command

490
00:19:13,440 --> 00:19:16,559
it will take the audio signal as input

491
00:19:15,760 --> 00:19:19,760
put it

492
00:19:16,559 --> 00:19:22,000
through the perceptual hash and i'll put

493
00:19:19,760 --> 00:19:25,039
the 16-bit hash that will be

494
00:19:22,000 --> 00:19:25,520
included inside the message so again as

495
00:19:25,039 --> 00:19:28,559
for

496
00:19:25,520 --> 00:19:29,679
the email addresses and phone numbers in

497
00:19:28,559 --> 00:19:33,200
the previous section

498
00:19:29,679 --> 00:19:36,400
uh here we could try to

499
00:19:33,200 --> 00:19:38,559
see if based on the hash that is sent

500
00:19:36,400 --> 00:19:39,919
inside the bluetooth messages if we

501
00:19:38,559 --> 00:19:43,120
could try to

502
00:19:39,919 --> 00:19:45,520
reverse it to the original um

503
00:19:43,120 --> 00:19:46,320
to the original comment that was spoken

504
00:19:45,520 --> 00:19:48,559
by the user

505
00:19:46,320 --> 00:19:50,080
it means that you don't need to listen

506
00:19:48,559 --> 00:19:51,760
to the voice comment but you can be

507
00:19:50,080 --> 00:19:54,799
outside the house

508
00:19:51,760 --> 00:19:57,520
listen to bluetooth messages

509
00:19:54,799 --> 00:19:58,639
and try to pick up those perceptual hash

510
00:19:57,520 --> 00:20:02,240
and try to infer

511
00:19:58,640 --> 00:20:06,000
what was the comment spoken by the user

512
00:20:02,240 --> 00:20:08,960
so we try to do that the results are not

513
00:20:06,000 --> 00:20:11,039
uh great at the uh for now uh the

514
00:20:08,960 --> 00:20:14,080
problem is that 16 bits hash

515
00:20:11,039 --> 00:20:16,320
is quite small so again there is a lot

516
00:20:14,080 --> 00:20:18,158
of ambiguity but if you can shortlist

517
00:20:16,320 --> 00:20:19,678
the number of comments that you want to

518
00:20:18,159 --> 00:20:22,080
to test

519
00:20:19,679 --> 00:20:24,159
it it is interesting so um the

520
00:20:22,080 --> 00:20:24,480
performances are not as i said not great

521
00:20:24,159 --> 00:20:27,600
but

522
00:20:24,480 --> 00:20:31,039
uh i believe we could improve that uh

523
00:20:27,600 --> 00:20:32,320
and you could infer what is spoken

524
00:20:31,039 --> 00:20:36,240
inside the house

525
00:20:32,320 --> 00:20:39,760
just by listening to the voice comments

526
00:20:36,240 --> 00:20:43,679
the voice says sorry the the

527
00:20:39,760 --> 00:20:47,280
belly messages sent by um

528
00:20:43,679 --> 00:20:48,159
your siri device all right this was the

529
00:20:47,280 --> 00:20:50,559
last attack

530
00:20:48,159 --> 00:20:51,600
um was going to talk about now let's

531
00:20:50,559 --> 00:20:54,158
move to the

532
00:20:51,600 --> 00:20:56,719
conclusion so in this work we presented

533
00:20:54,159 --> 00:20:59,679
a full reverse engineering of

534
00:20:56,720 --> 00:21:00,480
uh the apple continuity protocols and we

535
00:20:59,679 --> 00:21:03,200
found that

536
00:21:00,480 --> 00:21:04,480
they were affected by a large number of

537
00:21:03,200 --> 00:21:06,720
privacy issues

538
00:21:04,480 --> 00:21:09,760
here i'm only presented four of them but

539
00:21:06,720 --> 00:21:12,080
they are way more than that

540
00:21:09,760 --> 00:21:13,280
so it includes a tracking inferring a

541
00:21:12,080 --> 00:21:16,559
smartphone activity

542
00:21:13,280 --> 00:21:19,200
discovering email and phone numbers

543
00:21:16,559 --> 00:21:20,080
and the bad news is that all those

544
00:21:19,200 --> 00:21:22,000
messages there

545
00:21:20,080 --> 00:21:24,000
all those issues they are affecting a

546
00:21:22,000 --> 00:21:26,159
pretty large number of devices so

547
00:21:24,000 --> 00:21:28,080
all the device of apple affected but

548
00:21:26,159 --> 00:21:31,360
also device

549
00:21:28,080 --> 00:21:34,960
of affiliated companies uh which we

550
00:21:31,360 --> 00:21:39,039
estimate around 1.5 billion

551
00:21:34,960 --> 00:21:40,960
devices worldwide this is uh

552
00:21:39,039 --> 00:21:43,360
another example that security by

553
00:21:40,960 --> 00:21:46,640
obscurity does not work so they've

554
00:21:43,360 --> 00:21:48,799
created their own protocols and they

555
00:21:46,640 --> 00:21:50,559
tried to include some protection but

556
00:21:48,799 --> 00:21:53,600
they were not

557
00:21:50,559 --> 00:21:56,799
we believe properly reviewed and so

558
00:21:53,600 --> 00:21:58,959
they have many many issues so maybe they

559
00:21:56,799 --> 00:22:01,760
were hoping that by

560
00:21:58,960 --> 00:22:02,720
not disclosing how the protocol were

561
00:22:01,760 --> 00:22:06,879
working

562
00:22:02,720 --> 00:22:09,520
maybe nobody will find um problems

563
00:22:06,880 --> 00:22:10,320
uh you may be interested in passing

564
00:22:09,520 --> 00:22:12,879
those

565
00:22:10,320 --> 00:22:15,120
messages if you want to pass the billy

566
00:22:12,880 --> 00:22:16,080
messages that are your devices are

567
00:22:15,120 --> 00:22:18,239
sending

568
00:22:16,080 --> 00:22:19,439
you can download the software we have

569
00:22:18,240 --> 00:22:21,760
released

570
00:22:19,440 --> 00:22:22,880
using that you will be able to see in

571
00:22:21,760 --> 00:22:26,080
wireshark

572
00:22:22,880 --> 00:22:28,720
the details of all the messages

573
00:22:26,080 --> 00:22:29,918
understand what's your device are saying

574
00:22:28,720 --> 00:22:32,480
uh over bluetooth

575
00:22:29,919 --> 00:22:34,480
energy and it's quite uh quite easy easy

576
00:22:32,480 --> 00:22:38,960
to do with a bluetooth dongle

577
00:22:34,480 --> 00:22:41,760
so try to do that and and have fun

578
00:22:38,960 --> 00:22:42,159
um before finishing i want to mention

579
00:22:41,760 --> 00:22:45,200
that

580
00:22:42,159 --> 00:22:49,120
um of course we notified

581
00:22:45,200 --> 00:22:51,520
apple in advance so in may 2019

582
00:22:49,120 --> 00:22:54,320
about that just before we submitted the

583
00:22:51,520 --> 00:22:56,799
first version of our paper uh

584
00:22:54,320 --> 00:22:59,360
so they receive our notification and

585
00:22:56,799 --> 00:23:02,559
they they acknowledged it

586
00:22:59,360 --> 00:23:05,120
but we noticed that they haven't fixed

587
00:23:02,559 --> 00:23:07,840
many things and nothing at all actually

588
00:23:05,120 --> 00:23:10,799
mostly attacks are still valid

589
00:23:07,840 --> 00:23:10,799
as of today

590
00:23:11,039 --> 00:23:15,039
we made recommendation how they could

591
00:23:13,200 --> 00:23:19,280
reduce some of these attacks they

592
00:23:15,039 --> 00:23:23,200
did not consider it so the question is

593
00:23:19,280 --> 00:23:26,240
why is uh why are those

594
00:23:23,200 --> 00:23:27,679
problems still around maybe they are too

595
00:23:26,240 --> 00:23:30,880
difficult to correct

596
00:23:27,679 --> 00:23:31,360
for instance homekit protocols so they

597
00:23:30,880 --> 00:23:34,400
are

598
00:23:31,360 --> 00:23:37,600
inside smart home appliances

599
00:23:34,400 --> 00:23:41,039
and as you know internet of things uh

600
00:23:37,600 --> 00:23:42,799
updating uh the the firmware is not

601
00:23:41,039 --> 00:23:45,120
something that is done often

602
00:23:42,799 --> 00:23:45,840
uh so changing the protocol will break

603
00:23:45,120 --> 00:23:48,320
all those

604
00:23:45,840 --> 00:23:49,039
devices so this is maybe why they

605
00:23:48,320 --> 00:23:52,399
haven't done it

606
00:23:49,039 --> 00:23:55,679
at least for the arm kit protocol uh

607
00:23:52,400 --> 00:23:57,679
or maybe the problem where was not

608
00:23:55,679 --> 00:24:01,279
serious enough

609
00:23:57,679 --> 00:24:04,000
so since we notified this there are

610
00:24:01,279 --> 00:24:05,520
more than 10 updates that have been done

611
00:24:04,000 --> 00:24:08,880
on ios

612
00:24:05,520 --> 00:24:09,840
and only one specific issue has been

613
00:24:08,880 --> 00:24:11,760
corrected

614
00:24:09,840 --> 00:24:14,559
i think it's the something to do with

615
00:24:11,760 --> 00:24:16,799
the battery level i need to check again

616
00:24:14,559 --> 00:24:19,279
but all the other problems they are

617
00:24:16,799 --> 00:24:22,960
still around

618
00:24:19,279 --> 00:24:25,039
so yeah apple is not

619
00:24:22,960 --> 00:24:27,440
i mean apple is often advertising that

620
00:24:25,039 --> 00:24:28,240
they are very careful about the privacy

621
00:24:27,440 --> 00:24:31,120
of their users

622
00:24:28,240 --> 00:24:34,080
but uh here we have a good example

623
00:24:31,120 --> 00:24:36,719
that's maybe

624
00:24:34,080 --> 00:24:37,360
it's just uh yeah it's just what they

625
00:24:36,720 --> 00:24:41,200
say and

626
00:24:37,360 --> 00:24:44,959
not what they do all right

627
00:24:41,200 --> 00:24:47,919
this is the end of my presentation um

628
00:24:44,960 --> 00:24:49,279
so i want to point to the original paper

629
00:24:47,919 --> 00:24:50,320
from which this presentation is

630
00:24:49,279 --> 00:24:52,080
extracted

631
00:24:50,320 --> 00:24:54,158
although this paper has been published

632
00:24:52,080 --> 00:24:57,760
at the conference uh

633
00:24:54,159 --> 00:25:01,200
pets in 2020 uh

634
00:24:57,760 --> 00:25:02,720
and if you want to

635
00:25:01,200 --> 00:25:04,720
know more about it and if you have any

636
00:25:02,720 --> 00:25:05,200
idea to share with us please get in

637
00:25:04,720 --> 00:25:09,200
touch

638
00:25:05,200 --> 00:25:09,200
with us using the following email

639
00:25:12,840 --> 00:25:17,199
addresses

640
00:25:14,080 --> 00:25:21,199
okay thank you matthew for for the

641
00:25:17,200 --> 00:25:24,480
great talk um i will i will start with a

642
00:25:21,200 --> 00:25:26,159
few questions uh how long does it take

643
00:25:24,480 --> 00:25:29,440
to to do all this

644
00:25:26,159 --> 00:25:31,679
fancy analysis of the the bluetooth

645
00:25:29,440 --> 00:25:34,799
energy

646
00:25:31,679 --> 00:25:38,000
um actually uh it didn't take

647
00:25:34,799 --> 00:25:41,600
that much time uh once guillaume

648
00:25:38,000 --> 00:25:42,159
identified the possibilities offered by

649
00:25:41,600 --> 00:25:44,879
i mean

650
00:25:42,159 --> 00:25:46,720
the three methods that we discovered

651
00:25:44,880 --> 00:25:47,200
especially the one with the disassembly

652
00:25:46,720 --> 00:25:50,960
it was

653
00:25:47,200 --> 00:25:53,039
uh pretty quick um uh it was

654
00:25:50,960 --> 00:25:54,640
discovering the thing was not so long

655
00:25:53,039 --> 00:25:57,120
then doing some experiments

656
00:25:54,640 --> 00:25:58,480
uh were a bit longer i think in total we

657
00:25:57,120 --> 00:26:01,600
worked maybe

658
00:25:58,480 --> 00:26:02,880
a month full time uh doing the the

659
00:26:01,600 --> 00:26:04,639
practical thing and then

660
00:26:02,880 --> 00:26:06,080
there was of course the writing of the

661
00:26:04,640 --> 00:26:09,440
paper

662
00:26:06,080 --> 00:26:12,080
may i ask a second question is about the

663
00:26:09,440 --> 00:26:13,600
the trusting aspect you you have a

664
00:26:12,080 --> 00:26:16,720
possibility to to

665
00:26:13,600 --> 00:26:18,399
to identify who who is moving with the

666
00:26:16,720 --> 00:26:22,000
blue too low energy

667
00:26:18,400 --> 00:26:22,960
and uh you say that addict random is not

668
00:26:22,000 --> 00:26:24,400
enough

669
00:26:22,960 --> 00:26:26,799
if i understood correctly because you

670
00:26:24,400 --> 00:26:27,520
have extra kind of side channel or other

671
00:26:26,799 --> 00:26:30,639
information

672
00:26:27,520 --> 00:26:32,480
that can identify the person but you

673
00:26:30,640 --> 00:26:35,760
didn't propose any idea of

674
00:26:32,480 --> 00:26:37,760
counter measure what should we do

675
00:26:35,760 --> 00:26:39,840
for avoiding this because i think is is

676
00:26:37,760 --> 00:26:42,400
a vanish problem

677
00:26:39,840 --> 00:26:43,279
yeah so yeah the problem i've mentioned

678
00:26:42,400 --> 00:26:46,640
is a

679
00:26:43,279 --> 00:26:47,679
pretty common in a wireless network that

680
00:26:46,640 --> 00:26:50,720
implements

681
00:26:47,679 --> 00:26:51,200
address standardization so bluetooth low

682
00:26:50,720 --> 00:26:54,559
energy

683
00:26:51,200 --> 00:26:56,480
doing it wi-fi is also doing it so

684
00:26:54,559 --> 00:26:58,480
some vendors are implementing it in

685
00:26:56,480 --> 00:26:59,520
wi-fi so the address is changing

686
00:26:58,480 --> 00:27:01,679
randomly but

687
00:26:59,520 --> 00:27:04,240
as you said and as i've showed with a

688
00:27:01,679 --> 00:27:07,039
specific example in a presentation

689
00:27:04,240 --> 00:27:08,000
if there are other elements inside the

690
00:27:07,039 --> 00:27:10,400
frame

691
00:27:08,000 --> 00:27:11,919
uh that can be used to link to

692
00:27:10,400 --> 00:27:15,360
consecutive addresses i mean

693
00:27:11,919 --> 00:27:16,159
you basically uh i mean kill the address

694
00:27:15,360 --> 00:27:19,678
organization

695
00:27:16,159 --> 00:27:21,679
purpose um and so

696
00:27:19,679 --> 00:27:23,440
several works i've been looking at so

697
00:27:21,679 --> 00:27:25,360
there is a group of researchers

698
00:27:23,440 --> 00:27:27,200
including myself and others that have

699
00:27:25,360 --> 00:27:30,479
been working on this topic for

700
00:27:27,200 --> 00:27:31,520
now more than six years and we came up

701
00:27:30,480 --> 00:27:34,000
with a

702
00:27:31,520 --> 00:27:34,960
pretty simple list of recommendations

703
00:27:34,000 --> 00:27:38,480
actually there is

704
00:27:34,960 --> 00:27:41,200
no documents i actually

705
00:27:38,480 --> 00:27:42,720
for specifically for the wi-fi standard

706
00:27:41,200 --> 00:27:44,080
that gives a number of rules that should

707
00:27:42,720 --> 00:27:46,640
be implemented

708
00:27:44,080 --> 00:27:47,279
uh those rules are quite simple to

709
00:27:46,640 --> 00:27:50,399
implement

710
00:27:47,279 --> 00:27:52,320
but like for instance if you have

711
00:27:50,399 --> 00:27:54,080
counters in your frame you need to reset

712
00:27:52,320 --> 00:27:56,000
them to a random value whenever you

713
00:27:54,080 --> 00:27:57,600
change your address

714
00:27:56,000 --> 00:27:59,279
this is one thing and also you should

715
00:27:57,600 --> 00:28:02,639
not obviously include

716
00:27:59,279 --> 00:28:04,799
other identifiers in this frame and if

717
00:28:02,640 --> 00:28:07,279
you include identifiers you need to

718
00:28:04,799 --> 00:28:08,240
rotate them at the same time as you

719
00:28:07,279 --> 00:28:11,600
rotate your

720
00:28:08,240 --> 00:28:13,600
device address um so you need to do that

721
00:28:11,600 --> 00:28:16,000
i mean the requirements are quite simple

722
00:28:13,600 --> 00:28:19,039
to express but in practice

723
00:28:16,000 --> 00:28:22,080
they are the first the vendors that

724
00:28:19,039 --> 00:28:24,480
do not consider those issues that make

725
00:28:22,080 --> 00:28:26,158
stupid mistakes and then there are

726
00:28:24,480 --> 00:28:28,000
vendors that are aware of the prem and

727
00:28:26,159 --> 00:28:32,399
try to do something

728
00:28:28,000 --> 00:28:35,760
this is the case of apple not in this um

729
00:28:32,399 --> 00:28:38,239
specific protocols um but

730
00:28:35,760 --> 00:28:39,760
uh you may be aware of the contact

731
00:28:38,240 --> 00:28:40,480
tracing application that have been

732
00:28:39,760 --> 00:28:44,240
released

733
00:28:40,480 --> 00:28:45,039
recently to um to to try to limit the

734
00:28:44,240 --> 00:28:48,320
spread of the

735
00:28:45,039 --> 00:28:50,960
the virus and apple and google then they

736
00:28:48,320 --> 00:28:52,080
presented uh they've introduced their

737
00:28:50,960 --> 00:28:54,240
own system in which

738
00:28:52,080 --> 00:28:56,320
they have um they also use bluetooth

739
00:28:54,240 --> 00:28:58,399
energy to transmit identifiers

740
00:28:56,320 --> 00:29:00,399
so there is the bluetooth uh address

741
00:28:58,399 --> 00:29:02,239
that is used and inside the the packets

742
00:29:00,399 --> 00:29:03,120
there is an identifier used for contact

743
00:29:02,240 --> 00:29:04,880
tracing

744
00:29:03,120 --> 00:29:06,719
and they thought of okay we need to

745
00:29:04,880 --> 00:29:08,240
rotate those two at the same time it's

746
00:29:06,720 --> 00:29:11,120
part of the specification

747
00:29:08,240 --> 00:29:12,240
and they actually do it inside in their

748
00:29:11,120 --> 00:29:14,559
implementation

749
00:29:12,240 --> 00:29:16,159
but in fact they try to do it but

750
00:29:14,559 --> 00:29:16,720
sometimes the synchronization is not

751
00:29:16,159 --> 00:29:18,880
exact

752
00:29:16,720 --> 00:29:20,159
and there is a small overlap and it

753
00:29:18,880 --> 00:29:23,200
breaks everything

754
00:29:20,159 --> 00:29:23,919
um so there is a paper from vodka and

755
00:29:23,200 --> 00:29:25,760
venue

756
00:29:23,919 --> 00:29:27,679
on this on this topic not on the paper

757
00:29:25,760 --> 00:29:28,960
actually a video i can send the link a

758
00:29:27,679 --> 00:29:30,799
bit later

759
00:29:28,960 --> 00:29:32,240
that shows that this is happening so it

760
00:29:30,799 --> 00:29:35,039
shows that

761
00:29:32,240 --> 00:29:36,799
the rules are simple but even uh the

762
00:29:35,039 --> 00:29:37,600
vendors that are controlling fully the

763
00:29:36,799 --> 00:29:40,639
os

764
00:29:37,600 --> 00:29:43,439
they are not capable of doing it

765
00:29:40,640 --> 00:29:45,760
implementing correctly the synchronous

766
00:29:43,440 --> 00:29:49,360
rotation of those identifiers

767
00:29:45,760 --> 00:29:50,879
so yeah we need to work more on that

768
00:29:49,360 --> 00:29:52,719
on the implementation and the

769
00:29:50,880 --> 00:29:55,840
verification side

770
00:29:52,720 --> 00:29:57,039
okay thanks uh one quick question two

771
00:29:55,840 --> 00:30:00,158
questions that i will

772
00:29:57,039 --> 00:30:00,799
summarize in one uh it's about the voice

773
00:30:00,159 --> 00:30:04,000
command

774
00:30:00,799 --> 00:30:04,799
on siri does it recognize any sound and

775
00:30:04,000 --> 00:30:08,320
can you get

776
00:30:04,799 --> 00:30:09,840
the command of the victim voice so

777
00:30:08,320 --> 00:30:11,678
it does not recognize any sound so you

778
00:30:09,840 --> 00:30:13,918
need to start uh

779
00:30:11,679 --> 00:30:15,520
to trigger this mechanism you need to

780
00:30:13,919 --> 00:30:18,720
start initiate it you

781
00:30:15,520 --> 00:30:20,559
saying hey siri to your computer to your

782
00:30:18,720 --> 00:30:23,360
smartphone or whatever

783
00:30:20,559 --> 00:30:24,158
and then it will record a short sequence

784
00:30:23,360 --> 00:30:27,199
uh

785
00:30:24,159 --> 00:30:29,919
and from this short sequence of uh voice

786
00:30:27,200 --> 00:30:30,399
it will compute the ash um but like i

787
00:30:29,919 --> 00:30:33,679
said

788
00:30:30,399 --> 00:30:35,439
16 bits is not a lot

789
00:30:33,679 --> 00:30:36,799
so we performed an experiment in which

790
00:30:35,440 --> 00:30:39,200
we had um

791
00:30:36,799 --> 00:30:41,600
a dictionary of comment spoken comment

792
00:30:39,200 --> 00:30:44,000
that we spoke in front of the

793
00:30:41,600 --> 00:30:46,399
of the the theory we recorded the the

794
00:30:44,000 --> 00:30:48,880
hash and we try to

795
00:30:46,399 --> 00:30:52,158
later on recognize which command was

796
00:30:48,880 --> 00:30:54,960
spoken and we found out that uh yes

797
00:30:52,159 --> 00:30:56,799
because there are variation in the voice

798
00:30:54,960 --> 00:30:59,919
and also because the

799
00:30:56,799 --> 00:31:02,240
the sets of the different ashes is small

800
00:30:59,919 --> 00:31:03,039
they are a lot of collisions so

801
00:31:02,240 --> 00:31:05,279
sometimes

802
00:31:03,039 --> 00:31:06,480
um you may confuse so for instance if i

803
00:31:05,279 --> 00:31:09,919
say hey siri

804
00:31:06,480 --> 00:31:13,360
uh call mary can be confused to

805
00:31:09,919 --> 00:31:15,519
hey siri called mark so you

806
00:31:13,360 --> 00:31:17,039
can infer if you know if you have a

807
00:31:15,519 --> 00:31:19,039
short list of comments you could

808
00:31:17,039 --> 00:31:20,879
recognize which comment

809
00:31:19,039 --> 00:31:22,879
is sent but if you have no idea of the

810
00:31:20,880 --> 00:31:24,320
comments that can be sent to your silly

811
00:31:22,880 --> 00:31:28,080
assistant

812
00:31:24,320 --> 00:31:28,080
it may be more complicated

813
00:31:28,399 --> 00:31:33,039
okay thank you matthew we'll now go to

814
00:31:30,799 --> 00:31:36,519
the next talk

815
00:31:33,039 --> 00:31:39,519
given by david bye bye

816
00:31:36,519 --> 00:31:39,519
bye

