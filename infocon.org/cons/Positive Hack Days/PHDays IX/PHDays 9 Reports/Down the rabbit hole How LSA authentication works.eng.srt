1
00:00:00,380 --> 00:00:10,410
right great how is your pH days going

2
00:00:07,620 --> 00:00:12,300
looks like you're a bit tired and you

3
00:00:10,410 --> 00:00:16,350
don't have enough of oxygen in this cell

4
00:00:12,300 --> 00:00:19,439
room but I'll try to still stay within

5
00:00:16,350 --> 00:00:22,470
our timeframe what people usually stop

6
00:00:19,439 --> 00:00:23,400
from not with the title definitely

7
00:00:22,470 --> 00:00:25,890
because it's on the slide

8
00:00:23,400 --> 00:00:28,229
my name is are Thompson listen I'm Hyde

9
00:00:25,890 --> 00:00:30,960
of information security Microsoft

10
00:00:28,230 --> 00:00:35,910
Central and Eastern Europe and I'm here

11
00:00:30,960 --> 00:00:38,670
today to talk to you about very useful

12
00:00:35,910 --> 00:00:42,209
things especially for those of you who

13
00:00:38,670 --> 00:00:45,719
are to this to that extent in charge of

14
00:00:42,210 --> 00:00:49,230
security of Microsoft Windows Windows

15
00:00:45,719 --> 00:00:54,420
Server I'm going to talk to you about

16
00:00:49,230 --> 00:00:56,640
the latest generous generations of

17
00:00:54,420 --> 00:00:59,100
Windows whatever we are going to refer

18
00:00:56,640 --> 00:01:02,210
to previous generations I'm going to

19
00:00:59,100 --> 00:01:06,090
mention it separately we are having very

20
00:01:02,210 --> 00:01:14,330
strict time frame oh let me set my timer

21
00:01:06,090 --> 00:01:14,330
by the way right so my plan is this

22
00:01:16,460 --> 00:01:22,880
it looks like I'm stepping at something

23
00:01:18,410 --> 00:01:25,490
from that never mind first off we're

24
00:01:22,880 --> 00:01:29,289
going to discuss why the paradigms that

25
00:01:25,490 --> 00:01:35,000
we used to live by for decades are

26
00:01:29,290 --> 00:01:45,950
athletes not really my sound is

27
00:01:35,000 --> 00:01:48,649
disappearing no it's here to listen to

28
00:01:45,950 --> 00:01:52,100
us in online broadcasting you may have

29
00:01:48,649 --> 00:01:54,740
problems so we're going to start by

30
00:01:52,100 --> 00:01:58,009
discussing the changes in paradigm then

31
00:01:54,740 --> 00:02:00,470
I'll give you a strategically then we're

32
00:01:58,009 --> 00:02:06,020
going to drill down and describing stack

33
00:02:00,470 --> 00:02:10,190
of security technology in 28:19

34
00:02:06,020 --> 00:02:14,959
client-server all asses next we're going

35
00:02:10,190 --> 00:02:17,270
to speak off of the safe cults with the

36
00:02:14,959 --> 00:02:20,390
guards windows guards when this

37
00:02:17,270 --> 00:02:22,610
protection family I'm not going to

38
00:02:20,390 --> 00:02:28,100
discuss all of them because we don't

39
00:02:22,610 --> 00:02:30,580
have enough time then the main of after

40
00:02:28,100 --> 00:02:35,720
days is to discuss the internals of

41
00:02:30,580 --> 00:02:37,450
Alice a local security authority

42
00:02:35,720 --> 00:02:41,330
subsystem in particular we're going to

43
00:02:37,450 --> 00:02:45,319
look at how you go into Windows what are

44
00:02:41,330 --> 00:02:49,250
the identification protocols

45
00:02:45,319 --> 00:02:52,790
what are the flaws what are the attack

46
00:02:49,250 --> 00:02:55,040
vectors most popular among the hackers

47
00:02:52,790 --> 00:02:59,450
and we are going to discuss the

48
00:02:55,040 --> 00:03:05,000
technology that is there to eliminate

49
00:02:59,450 --> 00:03:07,280
those vulnerabilities we are going to

50
00:03:05,000 --> 00:03:13,430
try a live demo to demonstrate to you

51
00:03:07,280 --> 00:03:16,969
how the how the how we can withstand

52
00:03:13,430 --> 00:03:20,889
mimic a so including security support

53
00:03:16,969 --> 00:03:24,620
provider and what was the help of

54
00:03:20,889 --> 00:03:28,459
Windows protector family with the scars

55
00:03:24,620 --> 00:03:30,769
and by going to look at the future and

56
00:03:28,459 --> 00:03:33,859
outlook what are the challenges were

57
00:03:30,769 --> 00:03:35,919
facing what is the route forward and I'm

58
00:03:33,859 --> 00:03:41,799
going to introduce to you another

59
00:03:35,919 --> 00:03:45,439
witness protector so let the fun begin

60
00:03:41,799 --> 00:03:48,739
and most probably we are going to have

61
00:03:45,439 --> 00:03:50,629
Q&A session in the Murray and we have

62
00:03:48,739 --> 00:03:54,849
motivators for those who you who want to

63
00:03:50,629 --> 00:03:57,500
ask questions to motivators the

64
00:03:54,849 --> 00:04:00,280
questions that I find most interesting

65
00:03:57,500 --> 00:04:04,900
are going to

66
00:04:00,280 --> 00:04:08,200
aren't you a very nice price so that you

67
00:04:04,900 --> 00:04:11,560
can post the old-school kind of price

68
00:04:08,200 --> 00:04:14,410
before your peers in the next

69
00:04:11,560 --> 00:04:18,040
presentation so what is this standard

70
00:04:14,410 --> 00:04:21,190
paradigm the standard process of witness

71
00:04:18,040 --> 00:04:24,790
protection first you get information on

72
00:04:21,190 --> 00:04:29,070
an attack then in a reactive mode we

73
00:04:24,790 --> 00:04:33,550
developed protection but then they

74
00:04:29,070 --> 00:04:36,419
evildoers find another way to enter the

75
00:04:33,550 --> 00:04:40,810
system and the attacker is always ahead

76
00:04:36,419 --> 00:04:43,500
because they are not limited by Essex

77
00:04:40,810 --> 00:04:48,610
they are not limited or constrained by

78
00:04:43,500 --> 00:04:50,410
regulations by the way thing state

79
00:04:48,610 --> 00:04:55,690
procurement is organized it and have

80
00:04:50,410 --> 00:04:58,480
their schedules they can operate 24 by 7

81
00:04:55,690 --> 00:05:02,620
I think it's pretty obvious it's just an

82
00:04:58,480 --> 00:05:04,660
axiom so what's to do about it

83
00:05:02,620 --> 00:05:09,490
first off you need to change your

84
00:05:04,660 --> 00:05:15,030
paradigm the set of dogmas the set of

85
00:05:09,490 --> 00:05:18,600
axioms that we live by day by day

86
00:05:15,030 --> 00:05:22,059
several times a day and build our

87
00:05:18,600 --> 00:05:25,419
security strategy using the new paradigm

88
00:05:22,060 --> 00:05:29,919
rather than the obsolete one fantasy

89
00:05:25,419 --> 00:05:31,930
fans out there would know that if you

90
00:05:29,919 --> 00:05:34,390
change paradigm from time to time it's a

91
00:05:31,930 --> 00:05:37,960
good way of us to attack and to defend

92
00:05:34,390 --> 00:05:41,020
yourself this is how it looks earlier

93
00:05:37,960 --> 00:05:44,049
and why this paradigm is now obsolete as

94
00:05:41,020 --> 00:05:47,830
you can see standard schematic

95
00:05:44,050 --> 00:06:00,970
representation of a model as we have

96
00:05:47,830 --> 00:06:02,979
certain set of hardware we have platform

97
00:06:00,970 --> 00:06:10,110
services that provide for this

98
00:06:02,979 --> 00:06:10,110
integration we have apps or what not

99
00:06:10,560 --> 00:06:17,770
things that we make use of everyday

100
00:06:12,970 --> 00:06:21,760
browsers mail clients games for those of

101
00:06:17,770 --> 00:06:24,640
you who are gamers here I I can't use

102
00:06:21,760 --> 00:06:27,400
the pointer anyway problem is that in

103
00:06:24,640 --> 00:06:30,010
this particular architecture when you

104
00:06:27,400 --> 00:06:35,859
compromise the core you compromise the

105
00:06:30,010 --> 00:06:40,210
whole system we have one and only fellow

106
00:06:35,860 --> 00:06:44,169
points and exploits are popular with the

107
00:06:40,210 --> 00:06:47,909
hackers there they evil to us that allow

108
00:06:44,169 --> 00:06:51,370
the attacker to achieve full control

109
00:06:47,910 --> 00:06:55,070
including concealing the presence in

110
00:06:51,370 --> 00:06:56,870
order for me to illustrate

111
00:06:55,070 --> 00:07:00,530
demonstrate this concept on a real

112
00:06:56,870 --> 00:07:05,240
example you can see the Dubrovnik in

113
00:07:00,530 --> 00:07:06,489
Croatia by the way it's one of the

114
00:07:05,240 --> 00:07:12,880
places of shooting of Game of Thrones

115
00:07:06,490 --> 00:07:15,950
they have one reliable if an evildoer

116
00:07:12,880 --> 00:07:18,440
breaks the perimeter in only one point

117
00:07:15,950 --> 00:07:24,320
it compromises the whole city the whole

118
00:07:18,440 --> 00:07:28,520
old city while say caucus are my friends

119
00:07:24,320 --> 00:07:33,430
it was designed in a different era from

120
00:07:28,520 --> 00:07:37,219
a different paradigm there are various

121
00:07:33,430 --> 00:07:40,910
Ashlyn's of protection we have we are

122
00:07:37,220 --> 00:07:48,580
limited in terms of numbers of entry

123
00:07:40,910 --> 00:07:51,290
points there is this on the left in

124
00:07:48,580 --> 00:07:53,359
northwest of the picture and you protect

125
00:07:51,290 --> 00:07:56,930
the score by all means

126
00:07:53,360 --> 00:08:00,470
so how now back to windows how it works

127
00:07:56,930 --> 00:08:06,190
and windows in Windows 10 we separate

128
00:08:00,470 --> 00:08:10,280
all our developments in four categories

129
00:08:06,190 --> 00:08:13,040
threat protection identification and sir

130
00:08:10,280 --> 00:08:16,640
ization procedure management and

131
00:08:13,040 --> 00:08:18,919
management of any credentials handling

132
00:08:16,640 --> 00:08:23,128
any credentials

133
00:08:18,919 --> 00:08:25,469
data production number three because

134
00:08:23,129 --> 00:08:28,439
it's the direct way of monetizing your

135
00:08:25,469 --> 00:08:30,719
attacks if you're an evildoer and a way

136
00:08:28,439 --> 00:08:33,149
to manage this

137
00:08:30,719 --> 00:08:33,750
this is ooh so the speaker security

138
00:08:33,149 --> 00:08:36,599
manager

139
00:08:33,750 --> 00:08:42,089
I'm not going to amplify on that I just

140
00:08:36,599 --> 00:08:46,200
want to say that our main focus today is

141
00:08:42,089 --> 00:08:48,209
some moderate protection in connection

142
00:08:46,200 --> 00:08:54,269
with that I'd like to present to you

143
00:08:48,209 --> 00:08:58,109
with this ten guards we have five device

144
00:08:54,269 --> 00:09:00,029
guard guards from Guardian system guard

145
00:08:58,110 --> 00:09:04,860
credentials course applications guard

146
00:09:00,029 --> 00:09:07,860
and key guard what you have in the

147
00:09:04,860 --> 00:09:12,420
bottom part of the slide is what's

148
00:09:07,860 --> 00:09:14,670
coming next so let's discuss in greater

149
00:09:12,420 --> 00:09:18,510
details what this guards around about

150
00:09:14,670 --> 00:09:21,649
from left to right on this slide you see

151
00:09:18,510 --> 00:09:27,560
the chronology of a standard attack

152
00:09:21,649 --> 00:09:30,779
first and exploits or backdoor or rat is

153
00:09:27,560 --> 00:09:35,069
delivered through two major delivery

154
00:09:30,779 --> 00:09:38,960
channels a web browser and mail client

155
00:09:35,070 --> 00:09:44,130
sir would defend ourselves here

156
00:09:38,960 --> 00:09:46,740
through reducing the area of attack here

157
00:09:44,130 --> 00:09:51,390
it's but device guards credentials gas

158
00:09:46,740 --> 00:09:53,760
and Bushell secure mode via Sam so that

159
00:09:51,390 --> 00:09:56,460
you understand the whole security stack

160
00:09:53,760 --> 00:09:58,680
you need to understand what is virtual

161
00:09:56,460 --> 00:10:00,960
secure mode and how it's different from

162
00:09:58,680 --> 00:10:02,640
the traditional approaches if you

163
00:10:00,960 --> 00:10:03,470
understand that and you understand

164
00:10:02,640 --> 00:10:09,630
everything

165
00:10:03,470 --> 00:10:13,590
then application control its control to

166
00:10:09,630 --> 00:10:16,320
provide for integrity code integrity

167
00:10:13,590 --> 00:10:18,450
through white listing is the development

168
00:10:16,320 --> 00:10:22,020
of a block device guard it's called

169
00:10:18,450 --> 00:10:23,940
application control application guard is

170
00:10:22,020 --> 00:10:24,840
an interesting topic I'm going to refer

171
00:10:23,940 --> 00:10:32,300
to it later

172
00:10:24,840 --> 00:10:36,120
it's from by isolation of strapping of

173
00:10:32,300 --> 00:10:39,599
potentially threatening processes one

174
00:10:36,120 --> 00:10:42,930
few protects and critical services and

175
00:10:39,600 --> 00:10:45,280
you clear the session after you close

176
00:10:42,930 --> 00:10:50,469
the browser

177
00:10:45,280 --> 00:10:53,439
exploit God in class system of IPs

178
00:10:50,470 --> 00:10:55,240
windows it consists of four parts and

179
00:10:53,440 --> 00:11:00,120
we're going to look at two of them in

180
00:10:55,240 --> 00:11:02,860
greater details so that I don't have to

181
00:11:00,120 --> 00:11:05,500
repeat myself it's control folder access

182
00:11:02,860 --> 00:11:08,290
which allows you to minimize the

183
00:11:05,500 --> 00:11:18,400
probability of full encryption of your

184
00:11:08,290 --> 00:11:24,180
files by encrypting virus and by default

185
00:11:18,400 --> 00:11:28,390
we are talking about user folders and

186
00:11:24,180 --> 00:11:33,160
profiles anyhow it gets you a

187
00:11:28,390 --> 00:11:35,920
notification or block data protection

188
00:11:33,160 --> 00:11:41,380
exploit protection is something I'm

189
00:11:35,920 --> 00:11:45,760
going to specifically I'm not going to

190
00:11:41,380 --> 00:11:49,420
speak of antivirus but this is not the

191
00:11:45,760 --> 00:11:52,960
objective of today's Windows Defender I

192
00:11:49,420 --> 00:11:55,870
should play it's an IP P type of

193
00:11:52,960 --> 00:11:57,610
solution win point puts player

194
00:11:55,870 --> 00:12:00,870
production platform and win point

195
00:11:57,610 --> 00:12:05,980
production response it's the umbrella

196
00:12:00,870 --> 00:12:07,550
that unites all the Microsoft's security

197
00:12:05,980 --> 00:12:10,380
technologies

198
00:12:07,550 --> 00:12:14,459
and we're not going to look at this one

199
00:12:10,380 --> 00:12:17,580
so we just have 40 minutes left so I'm

200
00:12:14,460 --> 00:12:19,320
going to rush through the beginning part

201
00:12:17,580 --> 00:12:21,840
of my presentation the introductory part

202
00:12:19,320 --> 00:12:23,280
for you to understand it's part of a

203
00:12:21,840 --> 00:12:25,350
stack that integrates with other

204
00:12:23,280 --> 00:12:27,800
mechanisms and production components to

205
00:12:25,350 --> 00:12:30,360
provide for you the most effective

206
00:12:27,800 --> 00:12:30,900
interaction of the home combined smart

207
00:12:30,360 --> 00:12:33,180
screen

208
00:12:30,900 --> 00:12:35,160
you all remember what smart screen from

209
00:12:33,180 --> 00:12:39,979
mental and Explorer times it used to

210
00:12:35,160 --> 00:12:43,829
block the obviously malicious sites

211
00:12:39,980 --> 00:12:51,600
using the reputation server of Microsoft

212
00:12:43,830 --> 00:12:53,940
that is now in the the one that is going

213
00:12:51,600 --> 00:12:54,690
to be on trauma mansion it's going to be

214
00:12:53,940 --> 00:12:56,550
there as well

215
00:12:54,690 --> 00:12:59,250
independent of the kind of place that

216
00:12:56,550 --> 00:13:02,010
you prefer if you work on Windows 10 you

217
00:12:59,250 --> 00:13:05,450
get the opportunity to use reputational

218
00:13:02,010 --> 00:13:10,470
clouds filters even on other browsers

219
00:13:05,450 --> 00:13:14,880
visit opera or pro whatnot in order for

220
00:13:10,470 --> 00:13:18,840
it to work you need to switch on wind

221
00:13:14,880 --> 00:13:24,450
protection in Windows and it's hijacks

222
00:13:18,840 --> 00:13:27,810
HTTP HTTPS protocol requests and centers

223
00:13:24,450 --> 00:13:30,390
do reputation service irrespective of

224
00:13:27,810 --> 00:13:33,300
the applications that asks for

225
00:13:30,390 --> 00:13:37,560
connection we can check its reputation

226
00:13:33,300 --> 00:13:41,750
and have a red screen if it's not

227
00:13:37,560 --> 00:13:45,410
reputable a very very very quick demo

228
00:13:41,750 --> 00:13:45,410
hopefully it works

229
00:13:45,620 --> 00:13:49,280
it all looks pretty

230
00:13:49,379 --> 00:13:57,239
if you want to try and you take edge

231
00:13:52,729 --> 00:14:01,109
open it with understand github.com / and

232
00:13:57,239 --> 00:14:05,489
okay / Minich us and you get this read

233
00:14:01,109 --> 00:14:07,049
saying it's a very dangerous utility and

234
00:14:05,489 --> 00:14:09,869
you don't want to follow its that's how

235
00:14:07,049 --> 00:14:15,169
red screen looks and you get a similar

236
00:14:09,869 --> 00:14:16,829
red screen in Chrome or in Opera

237
00:14:15,169 --> 00:14:19,139
irrespective of the browser

238
00:14:16,829 --> 00:14:21,659
besides this reputation service can be

239
00:14:19,139 --> 00:14:23,789
used to block a specific application

240
00:14:21,659 --> 00:14:28,169
downloaded from the internet you

241
00:14:23,789 --> 00:14:31,019
download the Mekons you you get blocked

242
00:14:28,169 --> 00:14:32,999
unless you put it in in exceptions so

243
00:14:31,019 --> 00:14:39,989
much for smart screen and network

244
00:14:32,999 --> 00:14:42,869
protection intro we have a sandboxing

245
00:14:39,989 --> 00:14:44,609
technology the problem of false unboxing

246
00:14:42,869 --> 00:14:46,289
technologies out there that are

247
00:14:44,609 --> 00:14:48,089
conventional for all the browsers the

248
00:14:46,289 --> 00:14:52,979
ones that were initially use not the

249
00:14:48,089 --> 00:14:55,649
ones that are currently is the

250
00:14:52,979 --> 00:14:58,829
traditional challenge was that if you

251
00:14:55,649 --> 00:15:02,129
use software sandbox you can bypass it

252
00:14:58,829 --> 00:15:06,868
by hacking a software component if it's

253
00:15:02,129 --> 00:15:10,079
a single security device the way the

254
00:15:06,869 --> 00:15:13,409
industry develops you need a hybrids as

255
00:15:10,079 --> 00:15:17,779
a solution so that your sandbox is built

256
00:15:13,409 --> 00:15:22,350
on a hybrid of hardware plus software

257
00:15:17,779 --> 00:15:25,620
including the functional offer hyper-v

258
00:15:22,350 --> 00:15:29,070
the hypothesis it looks pretty simple

259
00:15:25,620 --> 00:15:34,410
when web browser applications work like

260
00:15:29,070 --> 00:15:39,060
edge will launch a small virtualized

261
00:15:34,410 --> 00:15:41,550
container where you don't have any

262
00:15:39,060 --> 00:15:44,069
extensions activated all of them other

263
00:15:41,550 --> 00:15:46,380
des accelerated and interaction of them

264
00:15:44,070 --> 00:15:49,080
where's the operation system are

265
00:15:46,380 --> 00:15:55,050
strictly controlled in this particular

266
00:15:49,080 --> 00:15:57,450
place and thus you can specify what can

267
00:15:55,050 --> 00:16:00,300
be sent the system platform services

268
00:15:57,450 --> 00:16:04,920
exception one you close each whether

269
00:16:00,300 --> 00:16:09,000
everything disappears and Melbury cannot

270
00:16:04,920 --> 00:16:12,660
persist therefore the buffer is

271
00:16:09,000 --> 00:16:14,940
controlled the right function is

272
00:16:12,660 --> 00:16:18,589
controlled

273
00:16:14,940 --> 00:16:27,110
now let's rush through this demo and

274
00:16:18,590 --> 00:16:27,110
that will be for the intro wait a minute

275
00:16:29,180 --> 00:16:36,390
right there you go so let's say you

276
00:16:33,840 --> 00:16:38,730
visit the resource that is obviously not

277
00:16:36,390 --> 00:16:39,449
on the white list or obviously on the

278
00:16:38,730 --> 00:16:43,980
black list

279
00:16:39,450 --> 00:16:47,270
the policy is controlled by the main so

280
00:16:43,980 --> 00:16:50,160
you see what if you don't use

281
00:16:47,270 --> 00:16:56,310
containerization when you work with web

282
00:16:50,160 --> 00:17:00,180
resources through web browser if you to

283
00:16:56,310 --> 00:17:02,969
use it on the upper left hand corner you

284
00:17:00,180 --> 00:17:06,770
can see application guards right on

285
00:17:02,970 --> 00:17:08,990
orange background if you have a look at

286
00:17:06,770 --> 00:17:12,689
how it works

287
00:17:08,990 --> 00:17:16,770
you don't have access to file systems

288
00:17:12,689 --> 00:17:20,070
objects and it works on hyper-v isolated

289
00:17:16,770 --> 00:17:30,300
user and this credential has a minimum

290
00:17:20,069 --> 00:17:32,700
privilege level tax reduction it's a

291
00:17:30,300 --> 00:17:35,639
category that includes everything that

292
00:17:32,700 --> 00:17:42,030
has to do with minimizing the area of

293
00:17:35,640 --> 00:17:46,370
attack on a hosta of OS management why

294
00:17:42,030 --> 00:17:50,280
wouldn't it work for ah there you go

295
00:17:46,370 --> 00:17:52,229
it is an important point because you

296
00:17:50,280 --> 00:17:56,220
have a lot of services what we thereby

297
00:17:52,230 --> 00:17:58,230
define that by default the policy is not

298
00:17:56,220 --> 00:18:00,030
too strict to provide for interaction

299
00:17:58,230 --> 00:18:04,090
with the maximum amount of peripherals

300
00:18:00,030 --> 00:18:06,490
to provide for maximum

301
00:18:04,090 --> 00:18:09,399
amount of scenarios but it's not ideal

302
00:18:06,490 --> 00:18:11,560
in terms of security let's look at the

303
00:18:09,400 --> 00:18:15,430
standard example of palos that is

304
00:18:11,560 --> 00:18:19,000
delivered into the target within

305
00:18:15,430 --> 00:18:21,960
Microsoft Office we have a lot of

306
00:18:19,000 --> 00:18:26,410
Microsoft Office documents the whole

307
00:18:21,960 --> 00:18:28,900
setup the whole airing of them some of

308
00:18:26,410 --> 00:18:31,300
them are with macro says these are the

309
00:18:28,900 --> 00:18:34,240
ones that I used for evildoers some of

310
00:18:31,300 --> 00:18:36,790
the macro says deliver the malware the

311
00:18:34,240 --> 00:18:38,770
malware code into the system and I used

312
00:18:36,790 --> 00:18:41,110
for complementation and some macro says

313
00:18:38,770 --> 00:18:47,050
are not only executed in the system but

314
00:18:41,110 --> 00:18:50,379
also download - first - you shouldn't

315
00:18:47,050 --> 00:18:53,080
block them because your accountants use

316
00:18:50,380 --> 00:18:56,260
micro size and your Excel spreadsheets

317
00:18:53,080 --> 00:18:58,960
to generate your invoices and they would

318
00:18:56,260 --> 00:19:01,300
say oh we can work this way but the last

319
00:18:58,960 --> 00:19:04,150
two categories the lower ones they add

320
00:19:01,300 --> 00:19:09,669
once it should be controlled and attack

321
00:19:04,150 --> 00:19:12,250
surface reduction is in our garden let's

322
00:19:09,670 --> 00:19:14,860
take a standard way of pilot delivery

323
00:19:12,250 --> 00:19:17,860
delivering the cost of offence when you

324
00:19:14,860 --> 00:19:22,330
deliver an office documents through an

325
00:19:17,860 --> 00:19:24,850
email in mailing a client it's a panel

326
00:19:22,330 --> 00:19:27,520
of preview and outlook when you do not

327
00:19:24,850 --> 00:19:28,719
open it in a separate Microsoft are

328
00:19:27,520 --> 00:19:32,460
separate

329
00:19:28,720 --> 00:19:37,300
it's enough for you to just accidentally

330
00:19:32,460 --> 00:19:40,330
click on and unless you have a patch for

331
00:19:37,300 --> 00:19:42,280
especially for critical vulnerabilities

332
00:19:40,330 --> 00:19:47,649
this heart is going to be compromised

333
00:19:42,280 --> 00:19:50,850
with these things blocks on the type of

334
00:19:47,650 --> 00:19:53,920
system calls that can be used etc

335
00:19:50,850 --> 00:19:57,070
whether or not that code from macros can

336
00:19:53,920 --> 00:20:01,120
be ejected in other processes already

337
00:19:57,070 --> 00:20:04,960
launched in this saying because this is

338
00:20:01,120 --> 00:20:07,959
what is used to get to escalate

339
00:20:04,960 --> 00:20:10,690
privileges I cannot go in deeper details

340
00:20:07,960 --> 00:20:11,610
but we're interested in the one fourth

341
00:20:10,690 --> 00:20:16,350
from the bottom

342
00:20:11,610 --> 00:20:19,780
it's access control to local security

343
00:20:16,350 --> 00:20:22,300
station subsystem on the host where you

344
00:20:19,780 --> 00:20:24,850
cannot use credential guards or

345
00:20:22,300 --> 00:20:27,040
something like that you can use exploit

346
00:20:24,850 --> 00:20:29,409
guards to prevent member cassa from

347
00:20:27,040 --> 00:20:32,670
operating it's going to monitor any

348
00:20:29,410 --> 00:20:37,560
access to memory and any download of

349
00:20:32,670 --> 00:20:37,560
anything from memory that is

350
00:20:39,390 --> 00:20:44,850
correspondent processes as far as

351
00:20:42,250 --> 00:20:49,600
exploit god is concerned

352
00:20:44,850 --> 00:20:50,860
like I said exploit guard is a host IPS

353
00:20:49,600 --> 00:20:56,740
it's not something new

354
00:20:50,860 --> 00:20:59,250
it's a hobbyist that if they want to

355
00:20:56,740 --> 00:21:02,410
exploit a vulnerability into unpatched

356
00:20:59,250 --> 00:21:06,490
application or one you want to deliver

357
00:21:02,410 --> 00:21:10,360
payload into the target system you can

358
00:21:06,490 --> 00:21:12,910
block it and advise the administer that

359
00:21:10,360 --> 00:21:15,159
means so that self so you basically poke

360
00:21:12,910 --> 00:21:17,200
backs in your word in the will of the

361
00:21:15,160 --> 00:21:19,630
attacker it in crazy

362
00:21:17,200 --> 00:21:24,179
the cost of attack and gives you advice

363
00:21:19,630 --> 00:21:24,179
you enough time to respond to the attack

364
00:21:24,330 --> 00:21:30,240
to give you an example how it works

365
00:21:30,360 --> 00:21:37,389
this is malware was and it used DD

366
00:21:36,029 --> 00:21:42,929
functionality

367
00:21:37,389 --> 00:21:49,709
dynamic data embedding TD force it in I

368
00:21:42,929 --> 00:21:53,740
think it was in summer of 2017 or 18 so

369
00:21:49,710 --> 00:21:56,289
they use D de to execute power shell

370
00:21:53,740 --> 00:22:00,760
script or another script and get there

371
00:21:56,289 --> 00:22:03,429
by control of the search engines the

372
00:22:00,760 --> 00:22:06,879
necessary documents and you needed to

373
00:22:03,429 --> 00:22:08,340
push two or three times this is how it

374
00:22:06,880 --> 00:22:13,269
worked

375
00:22:08,340 --> 00:22:18,158
we have a conventional email that

376
00:22:13,269 --> 00:22:20,590
arrives like your bank gives you the

377
00:22:18,159 --> 00:22:23,139
invoice that you need to sign to keep

378
00:22:20,590 --> 00:22:28,120
getting salary on your salary card you

379
00:22:23,139 --> 00:22:30,250
open the document in a secure about you

380
00:22:28,120 --> 00:22:32,110
click through okay it's because you are

381
00:22:30,250 --> 00:22:36,870
sick and tired of this type of documents

382
00:22:32,110 --> 00:22:39,428
right and then we have Aaron not

383
00:22:36,870 --> 00:22:42,340
identified in this particular indicator

384
00:22:39,429 --> 00:22:44,529
if you have a closer loop as is empty is

385
00:22:42,340 --> 00:22:48,490
launched and then PowerShell is launched

386
00:22:44,529 --> 00:22:53,830
partial script and then you see an

387
00:22:48,490 --> 00:22:57,850
obfuscated commands here so in and then

388
00:22:53,830 --> 00:23:01,149
you get the logs that and you get the

389
00:22:57,850 --> 00:23:03,149
logs that inform you on the attempt of

390
00:23:01,149 --> 00:23:05,909
exploit

391
00:23:03,150 --> 00:23:10,700
this can be integrated was when the the

392
00:23:05,910 --> 00:23:14,610
Windows Defender Microsoft and the ITP

393
00:23:10,700 --> 00:23:16,530
and this information can be seen in a

394
00:23:14,610 --> 00:23:19,649
centralized way of together with

395
00:23:16,530 --> 00:23:23,970
information from other systems now the

396
00:23:19,650 --> 00:23:28,010
main dish of my talk for Pseudomonas

397
00:23:23,970 --> 00:23:30,540
local security Authority or LSA assassin

398
00:23:28,010 --> 00:23:32,490
for you not to get confused because

399
00:23:30,540 --> 00:23:34,200
oftentimes we get this confusion a

400
00:23:32,490 --> 00:23:36,410
different document in different

401
00:23:34,200 --> 00:23:38,880
documentation they used interchangeably

402
00:23:36,410 --> 00:23:42,570
LSA is a local security authorities

403
00:23:38,880 --> 00:23:46,410
subsystem and si is part of a local

404
00:23:42,570 --> 00:23:52,169
security authority sub system L si si si

405
00:23:46,410 --> 00:23:56,429
anyway before we actually go in from the

406
00:23:52,170 --> 00:23:58,670
main dish let me remind you that la la

407
00:23:56,429 --> 00:24:03,020
let's say SS is in search of

408
00:23:58,670 --> 00:24:07,460
identification of user authorization

409
00:24:03,020 --> 00:24:13,620
things like that or a change of password

410
00:24:07,460 --> 00:24:17,390
storing verification data in memory etc

411
00:24:13,620 --> 00:24:17,389
and we have two modes

412
00:24:17,450 --> 00:24:25,230
just to carry out identification of the

413
00:24:21,510 --> 00:24:28,410
user interactive and non interactive in

414
00:24:25,230 --> 00:24:34,790
interactive we do not use SSL while in

415
00:24:28,410 --> 00:24:38,430
the network access in network access we

416
00:24:34,790 --> 00:24:44,930
we use this one yes I know I'm rushing

417
00:24:38,430 --> 00:24:44,930
you just to look at credentials

418
00:24:45,290 --> 00:24:54,270
credentials I think it's a very

419
00:24:50,429 --> 00:24:54,929
difficult difficult term to define in

420
00:24:54,270 --> 00:25:00,750
Russian

421
00:24:54,929 --> 00:25:03,750
anyway it's names the Kerberos tickets

422
00:25:00,750 --> 00:25:07,440
at certificates and passwords and the

423
00:25:03,750 --> 00:25:09,390
pair of open and closed keys when used

424
00:25:07,440 --> 00:25:11,250
when you carry out that since

425
00:25:09,390 --> 00:25:14,160
efficacious reserved and derived

426
00:25:11,250 --> 00:25:16,230
credentials I don't know how to

427
00:25:14,160 --> 00:25:19,650
translate a direct reduction since

428
00:25:16,230 --> 00:25:21,720
Russian but these are kind of secondary

429
00:25:19,650 --> 00:25:24,630
credentials that you get from primary

430
00:25:21,720 --> 00:25:27,960
credentials like user password is your

431
00:25:24,630 --> 00:25:31,530
primary credential hash from a password

432
00:25:27,960 --> 00:25:37,940
from the password one way hash function

433
00:25:31,530 --> 00:25:37,940
is already a derived credential Alice a

434
00:25:39,590 --> 00:25:45,240
the target of a let's say is to store

435
00:25:43,200 --> 00:25:47,040
derived credentials not just the

436
00:25:45,240 --> 00:25:49,380
passwords but the hash of the password

437
00:25:47,040 --> 00:25:56,520
with some with some extent away

438
00:25:49,380 --> 00:25:59,870
exceptions why we have issues and why

439
00:25:56,520 --> 00:26:04,370
Magnum America is so popular there are

440
00:25:59,870 --> 00:26:07,830
wholesale of those but the problem is

441
00:26:04,370 --> 00:26:11,959
everybody loves single sign-on right you

442
00:26:07,830 --> 00:26:14,490
don't want to introduce 16-point

443
00:26:11,960 --> 00:26:17,370
password everybody wants to work

444
00:26:14,490 --> 00:26:20,550
conveniently and it's no more it's

445
00:26:17,370 --> 00:26:23,189
absolutely normal but you really need to

446
00:26:20,550 --> 00:26:32,159
sacrifice it in security level and when

447
00:26:23,190 --> 00:26:35,280
you do this sacrifice you have to store

448
00:26:32,160 --> 00:26:37,470
your credential in some sort of way be

449
00:26:35,280 --> 00:26:40,889
the derived credentials the hash the

450
00:26:37,470 --> 00:26:44,370
password hashes or other kind of direct

451
00:26:40,890 --> 00:26:46,080
credentials or sometimes even more

452
00:26:44,370 --> 00:26:51,030
credentials there are some scenarios

453
00:26:46,080 --> 00:26:52,770
like that as well the way it works I'm

454
00:26:51,030 --> 00:26:56,910
going to refer to single sign-on later

455
00:26:52,770 --> 00:26:58,889
let's talk about the most important

456
00:26:56,910 --> 00:27:01,050
thing this is a very high level

457
00:26:58,890 --> 00:27:02,340
representation but for us to understand

458
00:27:01,050 --> 00:27:05,730
the future scenario it would be enough

459
00:27:02,340 --> 00:27:08,250
ok I have 25 minutes left right we have

460
00:27:05,730 --> 00:27:10,770
locals curious authorities subsist on it

461
00:27:08,250 --> 00:27:15,600
has certain components the core

462
00:27:10,770 --> 00:27:19,590
component is service that orchestrates

463
00:27:15,600 --> 00:27:22,169
this whole process this is the most

464
00:27:19,590 --> 00:27:23,470
important of the Guardians then we have

465
00:27:22,170 --> 00:27:24,890
a full set

466
00:27:23,470 --> 00:27:28,169
[Music]

467
00:27:24,890 --> 00:27:34,080
well specifically for security support

468
00:27:28,169 --> 00:27:39,780
provider's basically they support

469
00:27:34,080 --> 00:27:43,379
certain a certification protocol and its

470
00:27:39,780 --> 00:27:48,620
execution then its purpose yes it's

471
00:27:43,380 --> 00:27:51,299
cameras cloud up the modern

472
00:27:48,620 --> 00:27:55,189
identification products where you have

473
00:27:51,299 --> 00:28:05,160
tokens of negative directories and

474
00:27:55,190 --> 00:28:07,049
feeders all that smart cards these

475
00:28:05,160 --> 00:28:11,400
things that are used in the process of

476
00:28:07,049 --> 00:28:20,129
identification like the pair are open

477
00:28:11,400 --> 00:28:22,710
closed key it's all as first by so net

478
00:28:20,130 --> 00:28:28,020
lock on is easiest when you enter the

479
00:28:22,710 --> 00:28:30,570
domain to have a secure communication

480
00:28:28,020 --> 00:28:34,639
with the channel security account

481
00:28:30,570 --> 00:28:40,020
manager started the local credentials

482
00:28:34,640 --> 00:28:42,240
KDC as we see is the service that is in

483
00:28:40,020 --> 00:28:45,840
Church of caprese tickets and all their

484
00:28:42,240 --> 00:28:52,830
precious wisdom and defecation

485
00:28:45,840 --> 00:28:55,320
DTaP is the saying that protects they're

486
00:28:52,830 --> 00:29:01,860
basically a cryptic container inside

487
00:28:55,320 --> 00:29:05,418
your ass that controls the data that are

488
00:29:01,860 --> 00:29:08,988
very vulnerable and important for you

489
00:29:05,419 --> 00:29:14,419
so how the interaction goes on you have

490
00:29:08,989 --> 00:29:17,059
an application as service I win in it it

491
00:29:14,419 --> 00:29:18,950
calls with Annette it's gas here through

492
00:29:17,059 --> 00:29:22,969
a security support provider interface

493
00:29:18,950 --> 00:29:27,139
through an RPC call or request and then

494
00:29:22,969 --> 00:29:30,019
you have interaction as well let's say

495
00:29:27,139 --> 00:29:33,678
with our certification providers and de

496
00:29:30,019 --> 00:29:37,179
facto when you write your own customized

497
00:29:33,679 --> 00:29:39,589
security support provider your own

498
00:29:37,179 --> 00:29:42,259
identification provided you need to

499
00:29:39,589 --> 00:29:43,399
write something right here and then use

500
00:29:42,259 --> 00:29:48,739
either something that is already

501
00:29:43,399 --> 00:29:50,629
existent the once that is already there

502
00:29:48,739 --> 00:29:54,169
from the vendor that is already attained

503
00:29:50,629 --> 00:29:56,718
asshole you write your own and then you

504
00:29:54,169 --> 00:29:59,299
have to keep it in mind because this is

505
00:29:56,719 --> 00:30:03,739
the most popular one of the most popular

506
00:29:59,299 --> 00:30:07,309
of vectors of attack on Alice a because

507
00:30:03,739 --> 00:30:09,919
it gives you access to the context of

508
00:30:07,309 --> 00:30:12,499
execution of the core assessment

509
00:30:09,919 --> 00:30:16,279
assessment you get the privileges to

510
00:30:12,499 --> 00:30:18,889
just a deal out that is going to be a

511
00:30:16,279 --> 00:30:22,099
custom provider classification and from

512
00:30:18,889 --> 00:30:28,449
here maybe cancer does it let me Casa

513
00:30:22,099 --> 00:30:32,269
does you have a dot X a mini they allow

514
00:30:28,450 --> 00:30:34,909
it is registered all is perfect and many

515
00:30:32,269 --> 00:30:37,249
Casas says hey provider address this

516
00:30:34,909 --> 00:30:41,029
Alice a and give me the credential that

517
00:30:37,249 --> 00:30:44,059
you find there and there you go so from

518
00:30:41,029 --> 00:30:46,639
the point of view of operation system

519
00:30:44,059 --> 00:30:49,820
design from the point of view of

520
00:30:46,639 --> 00:30:54,049
security it's a Mexican mini cutter that

521
00:30:49,820 --> 00:30:55,189
is executed was admin privileges and

522
00:30:54,049 --> 00:30:55,760
debugging privileges

523
00:30:55,190 --> 00:30:57,950
so the

524
00:30:55,760 --> 00:30:59,780
is a very popular factor of attack and

525
00:30:57,950 --> 00:31:02,630
it's not a problem from the point of

526
00:30:59,780 --> 00:31:04,790
view of design I mean the way the

527
00:31:02,630 --> 00:31:06,710
components behaves they behave normally

528
00:31:04,790 --> 00:31:10,750
the operation system would give you no

529
00:31:06,710 --> 00:31:15,620
sign of suspicious of things going on

530
00:31:10,750 --> 00:31:18,830
the MC this is interaction first hash

531
00:31:15,620 --> 00:31:22,129
bus ticket all that we going to skip

532
00:31:18,830 --> 00:31:29,480
this one I already mentioned it means as

533
00:31:22,130 --> 00:31:33,560
well anyway normally the admin would do

534
00:31:29,480 --> 00:31:36,640
everything rightly but they will just

535
00:31:33,560 --> 00:31:40,280
get the rights of a debugger I'll

536
00:31:36,640 --> 00:31:43,430
consume all the allocated memory space

537
00:31:40,280 --> 00:31:48,649
in whatever and yet another important

538
00:31:43,430 --> 00:31:50,720
point yet another important point just

539
00:31:48,650 --> 00:31:55,820
hold on a minute but it seems like that

540
00:31:50,720 --> 00:31:57,920
my presentation has gone is there a

541
00:31:55,820 --> 00:31:59,929
problem with the projector with the

542
00:31:57,920 --> 00:32:03,140
monitor seems like I'll have to switch

543
00:31:59,930 --> 00:32:05,500
the monitor I would like to see my

544
00:32:03,140 --> 00:32:05,500
slides

545
00:32:05,690 --> 00:32:13,169
anyway it's very important to understand

546
00:32:08,669 --> 00:32:15,960
that it's not about deleting the LSA

547
00:32:13,169 --> 00:32:19,320
data because otherwise you wouldn't be

548
00:32:15,960 --> 00:32:25,410
able to complete single sign-on you just

549
00:32:19,320 --> 00:32:28,559
need to minimize the log data the

550
00:32:25,410 --> 00:32:31,640
credentials that you keep even after the

551
00:32:28,559 --> 00:32:37,168
session is complete and also you have to

552
00:32:31,640 --> 00:32:41,270
remember about the alienated extracted

553
00:32:37,169 --> 00:32:44,010
data and the minimum set of credentials

554
00:32:41,270 --> 00:32:48,090
can be later utilize that and different

555
00:32:44,010 --> 00:32:50,760
device so it's not about storing the

556
00:32:48,090 --> 00:32:53,010
credentials it would be stupid otherwise

557
00:32:50,760 --> 00:32:55,320
as ISO would not be functioning without

558
00:32:53,010 --> 00:32:58,350
it it's not the point

559
00:32:55,320 --> 00:33:01,590
you just need to increase the number of

560
00:32:58,350 --> 00:33:04,980
data that can be used in other devices

561
00:33:01,590 --> 00:33:10,860
you can steal it you can hack it if you

562
00:33:04,980 --> 00:33:13,860
can use some crypto data that you have

563
00:33:10,860 --> 00:33:17,309
acquired through the course of bio and

564
00:33:13,860 --> 00:33:18,949
identification you can steal it there's

565
00:33:17,309 --> 00:33:21,418
nothing wrong about it

566
00:33:18,950 --> 00:33:29,130
now a few words about the credentials

567
00:33:21,419 --> 00:33:35,490
guard a few words about the credentials

568
00:33:29,130 --> 00:33:36,990
guard the idea is simple what you need

569
00:33:35,490 --> 00:33:42,140
to do is just to make sure that the

570
00:33:36,990 --> 00:33:45,540
critical services that are most desired

571
00:33:42,140 --> 00:33:47,770
during the attack are allocated into a

572
00:33:45,540 --> 00:33:53,080
standalone container

573
00:33:47,770 --> 00:33:58,360
that you can get access to not only at a

574
00:33:53,080 --> 00:34:03,580
software level at a standalone security

575
00:33:58,360 --> 00:34:06,370
domain the main point here is that when

576
00:34:03,580 --> 00:34:08,980
you isolate this virtualized container

577
00:34:06,370 --> 00:34:12,009
where you can keep and store the

578
00:34:08,980 --> 00:34:17,350
isolated copy and version of a local

579
00:34:12,010 --> 00:34:22,780
security authority subsystem process is

580
00:34:17,350 --> 00:34:25,960
being controlled by both software and

581
00:34:22,780 --> 00:34:28,780
hardware solutions like hypervisor

582
00:34:25,960 --> 00:34:31,570
resolution for instance therefore in

583
00:34:28,780 --> 00:34:35,950
order to breach it you should not only

584
00:34:31,570 --> 00:34:40,740
get access to it at the core level at a

585
00:34:35,949 --> 00:34:44,939
kernel level and compromise the security

586
00:34:40,739 --> 00:34:49,049
but you'd also have to have a find

587
00:34:44,940 --> 00:34:52,000
vulnerability and the hypervisor and

588
00:34:49,050 --> 00:34:57,520
have to have a local access to this

589
00:34:52,000 --> 00:35:00,460
system I've been trying it for one hour

590
00:34:57,520 --> 00:35:03,640
to shutdown it for one hour but I failed

591
00:35:00,460 --> 00:35:08,830
it although I had this physical access

592
00:35:03,640 --> 00:35:13,690
to the virtual machine and had all the

593
00:35:08,830 --> 00:35:14,650
admin credentials and I wanted to show a

594
00:35:13,690 --> 00:35:18,360
couple of things

595
00:35:14,650 --> 00:35:18,360
just hold on a second

596
00:35:18,820 --> 00:35:23,860
what I want to do now is run my demo

597
00:35:26,350 --> 00:35:37,190
there is nothing better than a demo tool

598
00:35:29,410 --> 00:35:39,890
is there just a whiteboard maybe what

599
00:35:37,190 --> 00:35:45,920
I'm trying to do now is just to take you

600
00:35:39,890 --> 00:35:48,740
on a guided tour of my artworks

601
00:35:45,920 --> 00:35:51,500
I'm an excellent artist as far as you

602
00:35:48,740 --> 00:35:56,509
can see you can see that virtual secure

603
00:35:51,500 --> 00:35:58,730
mall is one thing that we have to to

604
00:35:56,510 --> 00:36:01,820
embrace architecture away there is a

605
00:35:58,730 --> 00:36:04,100
problem in LSA and there is no other way

606
00:36:01,820 --> 00:36:08,900
of resolving it but the one I'm gonna

607
00:36:04,100 --> 00:36:14,299
mention traditionally there's a kernel

608
00:36:08,900 --> 00:36:20,300
in TOS if you can see it here just hold

609
00:36:14,300 --> 00:36:26,420
on can you sit now great so we have a

610
00:36:20,300 --> 00:36:31,130
kernel that's the one here's the kernel

611
00:36:26,420 --> 00:36:39,220
mode here's the user mode here's our

612
00:36:31,130 --> 00:36:41,300
normal kernel exactly like I put it here

613
00:36:39,220 --> 00:36:44,689
doesn't really matter whether it looks

614
00:36:41,300 --> 00:36:47,200
fancier doesn't what we have to mention

615
00:36:44,690 --> 00:36:50,890
is we have a an application with its

616
00:36:47,200 --> 00:36:56,770
libraries for the program code

617
00:36:50,890 --> 00:36:59,680
and here we have a set of phone data

618
00:36:56,770 --> 00:37:04,270
data structures set of data structures

619
00:36:59,680 --> 00:37:07,540
and they describe the access marker for

620
00:37:04,270 --> 00:37:10,990
example what are the processes that have

621
00:37:07,540 --> 00:37:14,529
access to it and it contains some

622
00:37:10,990 --> 00:37:18,939
metadata what it can do what it cannot

623
00:37:14,530 --> 00:37:23,800
do so imagine there is yet another

624
00:37:18,940 --> 00:37:26,980
process running here in theory we have

625
00:37:23,800 --> 00:37:30,420
to isolate this processes from one

626
00:37:26,980 --> 00:37:33,430
another for example one exe extension

627
00:37:30,420 --> 00:37:37,120
yet there is another one and they are

628
00:37:33,430 --> 00:37:42,549
isolated assume that that's true but if

629
00:37:37,120 --> 00:37:44,470
you isolate it from the kernel by one is

630
00:37:42,550 --> 00:37:46,990
not possible I have to be able to get

631
00:37:44,470 --> 00:37:51,609
access to all of them and the admin can

632
00:37:46,990 --> 00:37:55,359
raise its credentials level to local

633
00:37:51,610 --> 00:37:59,200
system and get access to all of the

634
00:37:55,360 --> 00:38:01,420
processes as far as you can see that's

635
00:37:59,200 --> 00:38:03,430
the paradigm I would like to describe

636
00:38:01,420 --> 00:38:07,240
the problem here is it

637
00:38:03,430 --> 00:38:11,080
Alice s is one of the issues for us

638
00:38:07,240 --> 00:38:13,930
which is running in the user mode thus

639
00:38:11,080 --> 00:38:19,540
if there is a hacker with the admin

640
00:38:13,930 --> 00:38:21,640
credentials if it's trying to mimic to

641
00:38:19,540 --> 00:38:24,130
such-and-such credentials because

642
00:38:21,640 --> 00:38:27,310
otherwise it would not run properly

643
00:38:24,130 --> 00:38:30,880
cannot pull off multiple cool scenarios

644
00:38:27,310 --> 00:38:34,779
without so the problem here is that we'd

645
00:38:30,880 --> 00:38:37,200
have to isolate with the is s dot TX

646
00:38:34,780 --> 00:38:37,200
year

647
00:38:37,520 --> 00:38:42,660
but we cannot do that because the

648
00:38:40,140 --> 00:38:46,020
windows architecture would not support

649
00:38:42,660 --> 00:38:49,859
it we can try it multiple times but

650
00:38:46,020 --> 00:38:54,060
still be failing so how do we cope with

651
00:38:49,860 --> 00:38:57,000
it how do we isolate the data what are

652
00:38:54,060 --> 00:39:01,650
we going to do about it let's wipe it

653
00:38:57,000 --> 00:39:04,350
all out and instead we'll give it

654
00:39:01,650 --> 00:39:08,250
another try and we'd be adding something

655
00:39:04,350 --> 00:39:16,049
into this equation like virtual secure

656
00:39:08,250 --> 00:39:20,250
mode we have a regular user mode we have

657
00:39:16,050 --> 00:39:29,970
a regular kernel mode and here's our

658
00:39:20,250 --> 00:39:34,650
kernel here's the L say SS process this

659
00:39:29,970 --> 00:39:37,410
is a normal operation mode what do we

660
00:39:34,650 --> 00:39:40,710
would like to run a scenario when the

661
00:39:37,410 --> 00:39:45,750
administrator the one who controls the

662
00:39:40,710 --> 00:39:50,010
kernels security has access to this

663
00:39:45,750 --> 00:39:53,160
process we need to put it into a

664
00:39:50,010 --> 00:39:59,040
separate container to isolate it and

665
00:39:53,160 --> 00:40:02,520
it's entitled isolated user mode thus we

666
00:39:59,040 --> 00:40:08,820
have a very tiny like 10 kilobytes in

667
00:40:02,520 --> 00:40:11,940
size LSA I saw local authority security

668
00:40:08,820 --> 00:40:16,710
isolated which contains primary

669
00:40:11,940 --> 00:40:20,790
credentials here it's in its own memory

670
00:40:16,710 --> 00:40:23,310
space right here so in order to make

671
00:40:20,790 --> 00:40:27,370
sure that kernel does not get access to

672
00:40:23,310 --> 00:40:28,580
this part it is trying to mimic

673
00:40:27,370 --> 00:40:32,279
[Music]

674
00:40:28,580 --> 00:40:34,440
the actual performance but in actual

675
00:40:32,280 --> 00:40:36,660
fact there is no access provided the

676
00:40:34,440 --> 00:40:40,850
only possible way of having this access

677
00:40:36,660 --> 00:40:46,140
is through the secure kernel which is

678
00:40:40,850 --> 00:40:50,160
controlled by the hypervisor the whole

679
00:40:46,140 --> 00:40:51,270
integrity is controlled by both hardware

680
00:40:50,160 --> 00:40:56,990
and software

681
00:40:51,270 --> 00:41:02,820
but hyper-v like for instance therefore

682
00:40:56,990 --> 00:41:04,979
we address here here and here and

683
00:41:02,820 --> 00:41:10,470
directly we cannot establish any link

684
00:41:04,980 --> 00:41:13,050
right here but this gap in between now

685
00:41:10,470 --> 00:41:17,970
I'm going to explain why it is really so

686
00:41:13,050 --> 00:41:21,440
safe this real small gap small shared

687
00:41:17,970 --> 00:41:26,640
buffer the Daruma makes change in your

688
00:41:21,440 --> 00:41:29,610
foreign currency in a bank when you are

689
00:41:26,640 --> 00:41:32,720
separated with a bulletproof glass from

690
00:41:29,610 --> 00:41:38,580
the cashier with a very small small box

691
00:41:32,720 --> 00:41:42,839
made of steel where you put your money

692
00:41:38,580 --> 00:41:46,529
in and move to the cashier it resembles

693
00:41:42,840 --> 00:41:49,470
something similar the actual kernel

694
00:41:46,530 --> 00:41:53,010
would signal you when it's going to give

695
00:41:49,470 --> 00:41:56,250
you this buffer to use where you can put

696
00:41:53,010 --> 00:42:01,680
your so-called money and this shared

697
00:41:56,250 --> 00:42:05,430
buffer buff is utilizing a separate V vs

698
00:42:01,680 --> 00:42:12,779
L request protocol via cell requests and

699
00:42:05,430 --> 00:42:15,290
right here we have standard s call do

700
00:42:12,780 --> 00:42:18,960
you understand how it operates basically

701
00:42:15,290 --> 00:42:23,960
because this container is called PS l

702
00:42:18,960 --> 00:42:28,330
and inside this container you can

703
00:42:23,960 --> 00:42:31,370
not only just isolate LSA you can

704
00:42:28,330 --> 00:42:37,940
include multiple components there like

705
00:42:31,370 --> 00:42:40,460
Colonel model mode integrity which

706
00:42:37,940 --> 00:42:45,200
provides security for the entire stack

707
00:42:40,460 --> 00:42:48,310
it sounds and looks cool but if you are

708
00:42:45,200 --> 00:42:50,330
able to shut it down a simple switch

709
00:42:48,310 --> 00:42:51,910
it's worth noting

710
00:42:50,330 --> 00:42:54,529
so therefore would have to provide

711
00:42:51,910 --> 00:42:57,500
kennel mode code integrity this

712
00:42:54,530 --> 00:43:01,420
component must be isolated and cannot

713
00:42:57,500 --> 00:43:04,220
belong here because otherwise the hacker

714
00:43:01,420 --> 00:43:06,830
once it gets access there would control

715
00:43:04,220 --> 00:43:10,970
everything all the settings if you get

716
00:43:06,830 --> 00:43:15,049
the if you get the rights from the admin

717
00:43:10,970 --> 00:43:17,299
to get the D back they would be able to

718
00:43:15,050 --> 00:43:19,700
manage the configuration of the system

719
00:43:17,300 --> 00:43:22,310
just like you are doing everything you

720
00:43:19,700 --> 00:43:28,149
are doing traditionally does matter

721
00:43:22,310 --> 00:43:30,799
it's an additional step and that's it

722
00:43:28,150 --> 00:43:33,620
there's one more thing which is

723
00:43:30,800 --> 00:43:39,240
important to understand and why it's

724
00:43:33,620 --> 00:43:40,540
important to do how it can be hacked so

725
00:43:39,240 --> 00:43:43,629
[Music]

726
00:43:40,540 --> 00:43:46,580
ten minutes prior the end of the

727
00:43:43,630 --> 00:43:51,340
presentation I'll just explain that we

728
00:43:46,580 --> 00:43:57,580
have some kind of hardware we have some

729
00:43:51,340 --> 00:44:00,580
fan where ufi bias etc etc whoever

730
00:43:57,580 --> 00:44:00,580
hyper-v

731
00:44:02,510 --> 00:44:10,890
then we have our interior sir that's our

732
00:44:06,960 --> 00:44:17,030
Colonel in normal mode Alice a SS

733
00:44:10,890 --> 00:44:22,859
process and standalone real atlas a SS

734
00:44:17,030 --> 00:44:30,630
siloed and secure colonel everything is

735
00:44:22,859 --> 00:44:34,640
managed by hyper-v how can it be hacked

736
00:44:30,630 --> 00:44:39,599
well first of all you can interfere here

737
00:44:34,640 --> 00:44:42,720
right into the procedure you by

738
00:44:39,599 --> 00:44:46,349
initializing a system call intercepting

739
00:44:42,720 --> 00:44:50,160
the data right before the data is sent

740
00:44:46,349 --> 00:44:55,320
from Alice 8 to the colonel and gets

741
00:44:50,160 --> 00:44:59,879
protected the second thing which can

742
00:44:55,320 --> 00:45:04,890
manage configuration you can shut on and

743
00:44:59,880 --> 00:45:08,849
off protection you can control the

744
00:45:04,890 --> 00:45:15,830
ability of downloading some kind of a

745
00:45:08,849 --> 00:45:15,830
mini driver device driver a mini driver

746
00:45:15,970 --> 00:45:21,680
and the second thing is we move the

747
00:45:19,010 --> 00:45:24,080
component which is responsible for its

748
00:45:21,680 --> 00:45:27,649
therefore the integrity from here to

749
00:45:24,080 --> 00:45:32,450
here but then if we completely rely only

750
00:45:27,650 --> 00:45:37,160
on software tools the hackers would be

751
00:45:32,450 --> 00:45:38,930
able to remotely breach them so we'd

752
00:45:37,160 --> 00:45:42,589
have to add some kind of a hybrid

753
00:45:38,930 --> 00:45:46,640
solution here would would be adding here

754
00:45:42,590 --> 00:45:48,950
not only the tracking solution this

755
00:45:46,640 --> 00:45:55,100
security tracking solution security

756
00:45:48,950 --> 00:45:58,359
status once is bridged it's alerting the

757
00:45:55,100 --> 00:46:02,690
admin and the system goes down and

758
00:45:58,360 --> 00:46:05,420
nothing is capable nothing that the

759
00:46:02,690 --> 00:46:07,520
hacker will be able to do any further so

760
00:46:05,420 --> 00:46:14,110
we'll have to back it up with the

761
00:46:07,520 --> 00:46:16,960
hyper-v enforced code integrity so both

762
00:46:14,110 --> 00:46:21,650
hardware and software part

763
00:46:16,960 --> 00:46:25,220
it's called hyper-v hypervisor which we

764
00:46:21,650 --> 00:46:28,280
call you don't necessarily need to

765
00:46:25,220 --> 00:46:31,069
install the entire hyper-v you just

766
00:46:28,280 --> 00:46:33,359
needs small containers not fully fledged

767
00:46:31,070 --> 00:46:38,039
virtual

768
00:46:33,359 --> 00:46:40,589
machines there but I hope I've explained

769
00:46:38,039 --> 00:46:43,559
this part about the two vectors of the

770
00:46:40,589 --> 00:46:49,019
attack and I would like to show you yet

771
00:46:43,559 --> 00:46:51,390
another one I'd like to explain that we

772
00:46:49,019 --> 00:46:53,218
have a number a great number of

773
00:46:51,390 --> 00:46:55,430
peripheral devices

774
00:46:53,219 --> 00:46:55,430
Oh

775
00:46:56,700 --> 00:47:04,700
EF good to say here's the hyper-v in the

776
00:46:59,789 --> 00:47:11,729
trusted mode - one you can always zero

777
00:47:04,700 --> 00:47:18,058
the user mode is three so we don't we'll

778
00:47:11,729 --> 00:47:21,078
be scaling it up and in the virtual

779
00:47:18,059 --> 00:47:23,700
trust levels zero and one and

780
00:47:21,079 --> 00:47:26,640
conceptually they can be plenty of such

781
00:47:23,700 --> 00:47:32,279
levels and the trust level can also be

782
00:47:26,640 --> 00:47:35,249
different and now for example we have

783
00:47:32,279 --> 00:47:42,949
some kind of devices peripherals which I

784
00:47:35,249 --> 00:47:50,609
mentioned our mice networking equipment

785
00:47:42,949 --> 00:47:54,900
GDI we have some allocated memory space

786
00:47:50,609 --> 00:47:59,209
allocated for kernel purposes for the

787
00:47:54,900 --> 00:47:59,209
normal mode and for the safe mode

788
00:47:59,490 --> 00:48:08,049
some devices a great many of them by

789
00:48:04,750 --> 00:48:12,640
default unless they have DMS protection

790
00:48:08,049 --> 00:48:15,280
enabled which is a mandatory requirement

791
00:48:12,640 --> 00:48:19,900
by certification unless it's in enabled

792
00:48:15,280 --> 00:48:24,130
they have direct access to memory and if

793
00:48:19,900 --> 00:48:27,609
we have the mimic cards with with a mini

794
00:48:24,130 --> 00:48:30,549
driver imagine it's a device driver and

795
00:48:27,609 --> 00:48:33,790
this device driver like I'm showing you

796
00:48:30,549 --> 00:48:36,220
right here is trying to connect to a

797
00:48:33,790 --> 00:48:40,150
networking device and this networking

798
00:48:36,220 --> 00:48:43,770
device has got the direct access to the

799
00:48:40,150 --> 00:48:48,130
memory also the memory part which is

800
00:48:43,770 --> 00:48:54,849
allocated for the VSM virtual secure

801
00:48:48,130 --> 00:48:57,750
amount the hacker may be sending

802
00:48:54,849 --> 00:48:57,750
instructions

803
00:49:02,099 --> 00:49:09,879
requesting this memory space to be

804
00:49:06,009 --> 00:49:12,789
utilized its standard attack mode which

805
00:49:09,879 --> 00:49:17,769
we can now withstand we cannot control

806
00:49:12,789 --> 00:49:21,159
from here let me show it we cannot

807
00:49:17,769 --> 00:49:24,519
control it from here because all these

808
00:49:21,159 --> 00:49:28,419
are hardware devices that are plugged in

809
00:49:24,519 --> 00:49:32,769
connected by administrator we can only

810
00:49:28,419 --> 00:49:38,199
do it and should do it physically by

811
00:49:32,769 --> 00:49:40,928
using IO mm you imagine that here we

812
00:49:38,199 --> 00:49:44,679
create this input-output memory

813
00:49:40,929 --> 00:49:52,329
management unit by all management unit

814
00:49:44,679 --> 00:50:03,249
in other words in hyper-v we have the

815
00:49:52,329 --> 00:50:05,319
agents to have the MMU controlled access

816
00:50:03,249 --> 00:50:08,888
there is no direct access to it any

817
00:50:05,319 --> 00:50:13,859
longer imagine that it's not mimicking

818
00:50:08,889 --> 00:50:18,639
as a device driver would be able to

819
00:50:13,859 --> 00:50:23,729
intercept this request right here and to

820
00:50:18,639 --> 00:50:32,619
different memory pages would be

821
00:50:23,729 --> 00:50:35,220
providing different access levels safety

822
00:50:32,619 --> 00:50:38,770
wise and security wise

823
00:50:35,220 --> 00:50:41,950
and you can only do it by using the

824
00:50:38,770 --> 00:50:45,450
combined software and hardware approach

825
00:50:41,950 --> 00:50:47,830
we need to use the hypervisor for that

826
00:50:45,450 --> 00:50:51,339
sorry we are running out of time so

827
00:50:47,830 --> 00:50:54,840
you'll have to wrap it up and this is it

828
00:50:51,340 --> 00:50:59,470
by the way we we only have two minutes

829
00:50:54,840 --> 00:51:02,380
before the end by the way we'd like to

830
00:50:59,470 --> 00:51:05,319
check out whether it's really it really

831
00:51:02,380 --> 00:51:10,000
works who would like to see it please

832
00:51:05,320 --> 00:51:16,360
raise your hands then I've just bought

833
00:51:10,000 --> 00:51:27,310
me some more time anyway it's a very

834
00:51:16,360 --> 00:51:30,270
simple finger take a look here it only

835
00:51:27,310 --> 00:51:33,960
works with this 64-bit versions of the

836
00:51:30,270 --> 00:51:37,210
operating system it's a standard

837
00:51:33,960 --> 00:51:39,520
solution for the state-of-the-art

838
00:51:37,210 --> 00:51:47,080
security requirements but what if you

839
00:51:39,520 --> 00:51:51,880
utilize a standard Windows 10 OS in this

840
00:51:47,080 --> 00:51:55,450
case you can mark the LSA version as

841
00:51:51,880 --> 00:51:58,110
protected and there will be no mimic in

842
00:51:55,450 --> 00:52:02,370
access to it with the standard tools

843
00:51:58,110 --> 00:52:06,670
there is a standard one through exe and

844
00:52:02,370 --> 00:52:09,819
also through this driver if it operates

845
00:52:06,670 --> 00:52:18,220
at the kernel level it has access to the

846
00:52:09,820 --> 00:52:21,420
LSA and can unplug it here if you are

847
00:52:18,220 --> 00:52:25,189
admin with all of the rights

848
00:52:21,420 --> 00:52:27,750
if it's not backed up by the hardware

849
00:52:25,190 --> 00:52:31,980
protection you can shut it down

850
00:52:27,750 --> 00:52:33,800
Americans remove the flag and work with

851
00:52:31,980 --> 00:52:37,620
the data it's real simple

852
00:52:33,800 --> 00:52:43,680
but for this you can utilize an exploit

853
00:52:37,620 --> 00:52:46,650
guard whether it's 80 for a 64-bit I

854
00:52:43,680 --> 00:52:49,109
don't really know but it allows us to

855
00:52:46,650 --> 00:52:54,350
control all of the requests and mocked

856
00:52:49,110 --> 00:52:58,860
and flag them as potentially unsafe it

857
00:52:54,350 --> 00:53:07,710
also regards the the dump files in

858
00:52:58,860 --> 00:53:11,190
memory of which should be warned by log

859
00:53:07,710 --> 00:53:14,850
file and all of the information in this

860
00:53:11,190 --> 00:53:16,650
log file correspondent Lee I'm not going

861
00:53:14,850 --> 00:53:20,779
to be showing any more slides I'll just

862
00:53:16,650 --> 00:53:24,150
show you a standard solution 64-bit OS

863
00:53:20,780 --> 00:53:27,930
admin rights that's what we have and I

864
00:53:24,150 --> 00:53:31,320
hope it works right now it is fresh out

865
00:53:27,930 --> 00:53:33,480
and I just prepared it this morning you

866
00:53:31,320 --> 00:53:36,570
know I did have to remove all of the VMs

867
00:53:33,480 --> 00:53:41,970
from the way of mimic cards and we run

868
00:53:36,570 --> 00:53:48,570
it we run it and let's check it out the

869
00:53:41,970 --> 00:53:53,390
recent built 19.3 that's their most

870
00:53:48,570 --> 00:53:53,390
recent one bit dates this year 1903

871
00:53:54,440 --> 00:54:02,460
March 1930 just raised the privilege

872
00:53:58,230 --> 00:54:03,720
level to a standard let's check it out

873
00:54:02,460 --> 00:54:05,300
whether it is going to work with click

874
00:54:03,720 --> 00:54:09,980
guard

875
00:54:05,300 --> 00:54:14,339
log on and we need our credentials here

876
00:54:09,980 --> 00:54:14,990
it works it runs and now let's take a

877
00:54:14,339 --> 00:54:25,078
look at this

878
00:54:14,990 --> 00:54:28,259
we've already enabled the EDL and we've

879
00:54:25,079 --> 00:54:33,480
enabled protected process light the

880
00:54:28,260 --> 00:54:35,730
protected process mode if you try to

881
00:54:33,480 --> 00:54:38,670
mimic it at the kernel level it's not

882
00:54:35,730 --> 00:54:41,069
possible it would be not capable of

883
00:54:38,670 --> 00:54:43,800
doing that but it's capable of doing yet

884
00:54:41,069 --> 00:54:48,480
another thing remember I was showing you

885
00:54:43,800 --> 00:54:50,640
it can just embed into the credentials

886
00:54:48,480 --> 00:54:53,160
at the previous level for this they

887
00:54:50,640 --> 00:55:01,500
would have to take this file this little

888
00:54:53,160 --> 00:55:05,040
file that's the one that's the one this

889
00:55:01,500 --> 00:55:08,970
is the custom authentication file which

890
00:55:05,040 --> 00:55:11,430
we haven't the LSA and as the hacker has

891
00:55:08,970 --> 00:55:15,598
the access to this system they can

892
00:55:11,430 --> 00:55:18,950
register it like I'm doing now inject it

893
00:55:15,599 --> 00:55:22,290
and see what's happening right now

894
00:55:18,950 --> 00:55:24,868
Archie um you're out of time one last

895
00:55:22,290 --> 00:55:28,619
thought and that's it come on let me

896
00:55:24,869 --> 00:55:31,050
show me the clip guard hold on a sec

897
00:55:28,619 --> 00:55:33,320
hold on a sec I'll be quick

898
00:55:31,050 --> 00:55:43,260
[Music]

899
00:55:33,320 --> 00:55:46,640
or come on anyway what's it doing right

900
00:55:43,260 --> 00:55:49,680
now it's just intercepting the data

901
00:55:46,640 --> 00:55:51,890
before they get encrypted and protected

902
00:55:49,680 --> 00:56:03,629
that's the whole point

903
00:55:51,890 --> 00:56:06,900
the idea is real simple damn it stop

904
00:56:03,630 --> 00:56:11,130
anyway trust me there'll be a file with

905
00:56:06,900 --> 00:56:18,350
the open credentials which is not

906
00:56:11,130 --> 00:56:23,280
encrypted I know it belongs see windows

907
00:56:18,350 --> 00:56:28,350
system32 folder that's the one that's

908
00:56:23,280 --> 00:56:30,420
the one we found it with my mega

909
00:56:28,350 --> 00:56:32,040
password like I promised you I'm showing

910
00:56:30,420 --> 00:56:36,330
it to you but that's not credit card

911
00:56:32,040 --> 00:56:39,560
enabled it will work like this unless we

912
00:56:36,330 --> 00:56:42,509
control the grid guard configuration II

913
00:56:39,560 --> 00:56:46,380
it's a very well known attack which

914
00:56:42,510 --> 00:56:51,570
we've known since the end of the last

915
00:56:46,380 --> 00:56:54,060
year so you cannot just unable it enable

916
00:56:51,570 --> 00:56:58,130
it again and run it through hyper-v

917
00:56:54,060 --> 00:57:01,650
called integrity for this we will be is

918
00:56:58,130 --> 00:57:04,650
swiftly switch you know what I'm showing

919
00:57:01,650 --> 00:57:06,630
you is going to be real quick real quick

920
00:57:04,650 --> 00:57:10,850
I'm not going to run into console

921
00:57:06,630 --> 00:57:10,850
solution I'm going to just use the

922
00:57:12,599 --> 00:57:19,040
the simple mode come on honey

923
00:57:19,820 --> 00:57:31,020
enable enable after reboot now it's

924
00:57:29,220 --> 00:57:34,919
going to automatically run old all

925
00:57:31,020 --> 00:57:37,470
through all of the dependencies it is

926
00:57:34,920 --> 00:57:39,240
now running in the background we don't

927
00:57:37,470 --> 00:57:42,319
have time for questions but thank you

928
00:57:39,240 --> 00:57:42,319
very much for showing us

