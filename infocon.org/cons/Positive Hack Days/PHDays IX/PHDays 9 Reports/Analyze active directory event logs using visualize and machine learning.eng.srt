1
00:00:00,000 --> 00:00:05,790
everybody thank you for coming to our

2
00:00:02,970 --> 00:00:08,790
session and I'm tamaki Thani from JP

3
00:00:05,790 --> 00:00:10,889
thar one that's not so off to Japan okay

4
00:00:08,790 --> 00:00:14,219
today I would like to talk about how to

5
00:00:10,889 --> 00:00:16,439
detect lateral movement using Active

6
00:00:14,219 --> 00:00:18,480
Directory bad logs and we've also a

7
00:00:16,440 --> 00:00:23,060
demonstration of our tool with the 80

8
00:00:18,480 --> 00:00:23,060
logs we collected in an APD instance day

9
00:00:24,350 --> 00:00:30,810
okay let me introduce myself I'm Tamaki

10
00:00:28,050 --> 00:00:32,850
Thani and it's my first pH days and

11
00:00:30,810 --> 00:00:35,280
first time to come in Russia and I'm

12
00:00:32,850 --> 00:00:38,010
very glad to be here with all of you

13
00:00:35,280 --> 00:00:39,989
today and it's our pleasure to give it a

14
00:00:38,010 --> 00:00:42,750
pleasure giving us an opportunity to

15
00:00:39,989 --> 00:00:44,849
have a presentation here Tamala Kazan

16
00:00:42,750 --> 00:00:47,250
and I belonged to the incident response

17
00:00:44,850 --> 00:00:50,610
group in JP start and my primary

18
00:00:47,250 --> 00:00:53,010
responsibility is dfi or speak a little

19
00:00:50,610 --> 00:00:55,500
bit of our group we receive almost

20
00:00:53,010 --> 00:00:58,140
10,000 instant reports every year and

21
00:00:55,500 --> 00:01:00,480
coordinate and cooperate with our

22
00:00:58,140 --> 00:01:04,290
partner in Japan and to mitigate

23
00:01:00,480 --> 00:01:06,960
security instance also we handle twenty

24
00:01:04,290 --> 00:01:09,960
to thirty abd instance per year and put

25
00:01:06,960 --> 00:01:12,990
a lot of time and effort to them and

26
00:01:09,960 --> 00:01:16,048
sometimes we just notice to our partner

27
00:01:12,990 --> 00:01:18,810
or Japanese corporations and sometimes

28
00:01:16,049 --> 00:01:20,490
we help the investigation together today

29
00:01:18,810 --> 00:01:23,850
stop some from the experiments we

30
00:01:20,490 --> 00:01:26,179
collected from the DF I our and I wish

31
00:01:23,850 --> 00:01:29,640
it will help your DF IR and your studies

32
00:01:26,180 --> 00:01:32,009
and I like to pass the mic to Susy my

33
00:01:29,640 --> 00:01:35,759
name is Jin se tomonaga I have been

34
00:01:32,009 --> 00:01:38,009
working at JP salt for six years my

35
00:01:35,759 --> 00:01:41,250
primary responsibilities are to analyze

36
00:01:38,009 --> 00:01:44,579
Maria on DFA are they also developed

37
00:01:41,250 --> 00:01:49,710
some tools which are useful maria nurses

38
00:01:44,579 --> 00:01:52,320
diesel available on github okay thank

39
00:01:49,710 --> 00:01:53,880
you see before moving to the main topic

40
00:01:52,320 --> 00:01:56,039
I would like to talk about the current

41
00:01:53,880 --> 00:01:59,009
state of the instant response especially

42
00:01:56,040 --> 00:01:59,820
in apt as you know when the incident

43
00:01:59,009 --> 00:02:02,549
happened

44
00:01:59,820 --> 00:02:05,130
the attacker intrudes into the network

45
00:02:02,549 --> 00:02:07,950
and affect many hosting servers with

46
00:02:05,130 --> 00:02:10,859
using malware and using the dim windows

47
00:02:07,950 --> 00:02:12,920
default tools in case number of the

48
00:02:10,860 --> 00:02:16,670
infected horse runs up to

49
00:02:12,920 --> 00:02:20,299
and it takes months is to reveal or hold

50
00:02:16,670 --> 00:02:21,440
picture of the incident okay so from

51
00:02:20,300 --> 00:02:24,560
here I would like to talk about the

52
00:02:21,440 --> 00:02:28,100
importance of they been localities in a

53
00:02:24,560 --> 00:02:30,170
PD case it been long Binh LOC analyzed

54
00:02:28,100 --> 00:02:32,090
will be one of the key factor to

55
00:02:30,170 --> 00:02:35,958
identify the compromised host in the big

56
00:02:32,090 --> 00:02:38,209
ten network so the reason so at Windows

57
00:02:35,959 --> 00:02:41,780
Active Directory record all of the logon

58
00:02:38,209 --> 00:02:43,700
history in their event log and we could

59
00:02:41,780 --> 00:02:46,970
taste the malicious activity from them

60
00:02:43,700 --> 00:02:49,579
very simple and most of the APD actors

61
00:02:46,970 --> 00:02:50,989
try to spread malware and execute it

62
00:02:49,580 --> 00:02:55,880
remotely with Active Directory

63
00:02:50,989 --> 00:03:00,140
authentication so what's the trend of

64
00:02:55,880 --> 00:03:02,320
the malicious logon method in these days

65
00:03:00,140 --> 00:03:05,119
as you know attacker use a pass a ticket

66
00:03:02,320 --> 00:03:07,430
for their lateral movement and they use

67
00:03:05,120 --> 00:03:09,380
it for their espionage and also use it

68
00:03:07,430 --> 00:03:12,530
for spreading their malware to their to

69
00:03:09,380 --> 00:03:14,359
other hosts PDT issues and are

70
00:03:12,530 --> 00:03:16,790
authorized skit from Kerberos

71
00:03:14,360 --> 00:03:20,079
authentication service and and grant

72
00:03:16,790 --> 00:03:23,989
access to other hast without additional

73
00:03:20,079 --> 00:03:26,780
additional authentication so well now go

74
00:03:23,989 --> 00:03:29,780
to intricate use DDT and tributes get

75
00:03:26,780 --> 00:03:33,799
use SD it's one of the most basic talk

76
00:03:29,780 --> 00:03:36,920
techniques for attackers nowadays so one

77
00:03:33,799 --> 00:03:39,700
very easy question does Windows System

78
00:03:36,920 --> 00:03:42,380
record past the ticket in the bed log

79
00:03:39,700 --> 00:03:44,238
maybe everyone is a very technical

80
00:03:42,380 --> 00:03:48,709
person and I think everyone knows and

81
00:03:44,239 --> 00:03:50,630
the answer is no when the past is ticket

82
00:03:48,709 --> 00:03:54,200
use the system records the same event

83
00:03:50,630 --> 00:03:56,090
log as a standard logon it means we need

84
00:03:54,200 --> 00:03:57,920
a new analyzing technique to detect

85
00:03:56,090 --> 00:04:00,290
these kind of Mouse's logon from the

86
00:03:57,920 --> 00:04:03,500
event logs okay

87
00:04:00,290 --> 00:04:05,269
let's consider about the tools what's

88
00:04:03,500 --> 00:04:07,160
the best so for the log event log

89
00:04:05,269 --> 00:04:10,010
artists there are several tools to

90
00:04:07,160 --> 00:04:12,859
analyze the logs of course events viewer

91
00:04:10,010 --> 00:04:16,159
grabs grab oak scene etcetera etcetera

92
00:04:12,859 --> 00:04:18,769
ok let's check them first

93
00:04:16,160 --> 00:04:20,299
I big Bureau yeah that's Apple to to

94
00:04:18,769 --> 00:04:22,820
view event logs and it could be the

95
00:04:20,298 --> 00:04:25,219
first option for analysts but as you

96
00:04:22,820 --> 00:04:26,700
know yeah it's just a beaut

97
00:04:25,220 --> 00:04:29,910
so not analyze

98
00:04:26,700 --> 00:04:31,560
yeah everything with the viewer is very

99
00:04:29,910 --> 00:04:34,170
painful and I have tried it to analyze

100
00:04:31,560 --> 00:04:37,470
it with with it but yeah I gave up in a

101
00:04:34,170 --> 00:04:39,450
moment so how can you find the malicious

102
00:04:37,470 --> 00:04:44,760
activity just viewing logs and of course

103
00:04:39,450 --> 00:04:47,400
we cannot okay option it's exported bed

104
00:04:44,760 --> 00:04:49,530
log as a text and use grep Oak set and

105
00:04:47,400 --> 00:04:53,489
other commands yeah it's much better

106
00:04:49,530 --> 00:04:55,710
than it beaver I believe but analyzing a

107
00:04:53,490 --> 00:04:58,170
massive data of the logs it's still

108
00:04:55,710 --> 00:05:00,419
painful and it is difficult to analyze

109
00:04:58,170 --> 00:05:02,640
and in the case of analyzing active

110
00:05:00,420 --> 00:05:06,170
directories dogs and the data size be

111
00:05:02,640 --> 00:05:09,900
dozens of gigas and it's still painful

112
00:05:06,170 --> 00:05:12,600
okay how about scene yes FEMA is very

113
00:05:09,900 --> 00:05:16,020
very useful to search logs and do static

114
00:05:12,600 --> 00:05:17,850
analysis also it as a function to a lot

115
00:05:16,020 --> 00:05:21,000
of us and yeah it's very very cool and I

116
00:05:17,850 --> 00:05:23,390
love it but in this case it's not clear

117
00:05:21,000 --> 00:05:27,240
where to find the malicious log because

118
00:05:23,390 --> 00:05:28,890
in this case it's very difficult to

119
00:05:27,240 --> 00:05:33,060
distinguish no it's just logs from

120
00:05:28,890 --> 00:05:35,159
legitimate logs so the problem of the

121
00:05:33,060 --> 00:05:36,210
compositions are methods for analyzing

122
00:05:35,160 --> 00:05:38,490
abend logs

123
00:05:36,210 --> 00:05:41,700
first it's difficult to analyze with

124
00:05:38,490 --> 00:05:44,490
default tools and second it requires new

125
00:05:41,700 --> 00:05:47,159
techniques to detect pass the ticket and

126
00:05:44,490 --> 00:05:50,970
finally it's not clear where to find the

127
00:05:47,160 --> 00:05:53,610
malicious log so so today's the goal of

128
00:05:50,970 --> 00:05:56,190
the today's presentation is proposed a

129
00:05:53,610 --> 00:05:59,910
method of analyzing active directory log

130
00:05:56,190 --> 00:06:02,430
in active directory event logs in this

131
00:05:59,910 --> 00:06:05,400
presentation we will like to introduce

132
00:06:02,430 --> 00:06:07,830
our approach to those challenges or

133
00:06:05,400 --> 00:06:10,260
operands or approach is investigate

134
00:06:07,830 --> 00:06:12,840
malicious windows welcome by visualizing

135
00:06:10,260 --> 00:06:14,849
and analyzing them if we could support

136
00:06:12,840 --> 00:06:18,090
visualizing and analyzing benlloch it

137
00:06:14,850 --> 00:06:21,620
will make it easier to find malicious

138
00:06:18,090 --> 00:06:23,700
for our logs or activities such as PTT

139
00:06:21,620 --> 00:06:26,880
so here's the topic for today's

140
00:06:23,700 --> 00:06:28,800
presentation first we would like to talk

141
00:06:26,880 --> 00:06:31,320
about a been logged visualization and

142
00:06:28,800 --> 00:06:33,390
second people so the additional analysis

143
00:06:31,320 --> 00:06:35,130
of the bay log using several algorithms

144
00:06:33,390 --> 00:06:37,919
and techniques including machine

145
00:06:35,130 --> 00:06:39,930
learning sir we will like to introduce

146
00:06:37,920 --> 00:06:41,009
also logon tracer

147
00:06:39,930 --> 00:06:44,820
and finally we will show the

148
00:06:41,009 --> 00:06:46,199
demonstration with apt instant locks so

149
00:06:44,820 --> 00:06:53,729
ok I would like to pass the mic to

150
00:06:46,199 --> 00:06:56,990
Tomlinson after destroyed we will

151
00:06:53,729 --> 00:06:58,620
introduce how to visualize event rogue

152
00:06:56,990 --> 00:07:03,090
analyzing the people

153
00:06:58,620 --> 00:07:06,449
another bit wrong how to visualizing

154
00:07:03,090 --> 00:07:10,049
bedrock the inventor organ has multiple

155
00:07:06,449 --> 00:07:12,030
event related to log on the rogue event

156
00:07:10,050 --> 00:07:13,889
contains account and the hostile

157
00:07:12,030 --> 00:07:21,320
information and analyze and visualize

158
00:07:13,889 --> 00:07:25,169
such information so this slide is

159
00:07:21,320 --> 00:07:28,979
restore our event IDs there are about 20

160
00:07:25,169 --> 00:07:37,789
log events for example logo success is

161
00:07:28,979 --> 00:07:41,400
ID 464 and Rockefeller for 6 to 5 but

162
00:07:37,789 --> 00:07:45,150
for Kerberos authentication Martha ideas

163
00:07:41,400 --> 00:07:49,789
with logo is recorded there are a lot of

164
00:07:45,150 --> 00:07:56,969
are going ID event ID like this however

165
00:07:49,789 --> 00:08:00,900
we need Malta or raga identities the

166
00:07:56,970 --> 00:08:03,659
other is known it is possible to detect

167
00:08:00,900 --> 00:08:07,440
Marshall slogan without mark monitoring

168
00:08:03,659 --> 00:08:10,020
your organ varieties in your result we

169
00:08:07,440 --> 00:08:18,090
know that it is important to monitor

170
00:08:10,020 --> 00:08:20,940
just 6 event IDs the Hydra to Deventer

171
00:08:18,090 --> 00:08:24,539
ideas event that we recommended to

172
00:08:20,940 --> 00:08:28,409
monitor in relation to the success and

173
00:08:24,539 --> 00:08:33,559
failure of logon Antarian the curve is

174
00:08:28,409 --> 00:08:33,559
authentication attempt is also important

175
00:08:34,458 --> 00:08:44,250
the event log is not easy for analysts

176
00:08:40,849 --> 00:08:47,760
current name of inventors are different

177
00:08:44,250 --> 00:08:49,460
for each event IDs the north or the

178
00:08:47,760 --> 00:08:54,920
event ID has the same

179
00:08:49,460 --> 00:08:57,770
type of information asset ID mayonnaise

180
00:08:54,920 --> 00:08:59,829
in vitro it is necessary to solve these

181
00:08:57,770 --> 00:08:59,829
problems

182
00:09:01,900 --> 00:09:10,280
this figure is a same simple thought of

183
00:09:06,140 --> 00:09:16,130
visualizing inventors by visualizing via

184
00:09:10,280 --> 00:09:20,030
metal a state can't name host from the

185
00:09:16,130 --> 00:09:23,510
rock event oh geez therefore it is easy

186
00:09:20,030 --> 00:09:30,620
to check which account name used to log

187
00:09:23,510 --> 00:09:32,960
on to host this is an example of a

188
00:09:30,620 --> 00:09:39,040
visualizing event rock based on the

189
00:09:32,960 --> 00:09:44,480
previous concept green node is a host

190
00:09:39,040 --> 00:09:48,140
blue and red and account if my prevent

191
00:09:44,480 --> 00:09:52,640
ID are recorded material drawing between

192
00:09:48,140 --> 00:09:54,710
the host and account how can we use the

193
00:09:52,640 --> 00:10:00,110
visualizing to analyzing malicious

194
00:09:54,710 --> 00:10:03,110
program if no host per account policies

195
00:10:00,110 --> 00:10:05,840
are private the ratio of the account and

196
00:10:03,110 --> 00:10:09,290
the host will be described as in the

197
00:10:05,840 --> 00:10:17,050
figure showing that the host and account

198
00:10:09,290 --> 00:10:22,400
ratio is 1 to 1 this is an example of

199
00:10:17,050 --> 00:10:29,780
Martha struggle we can find out many

200
00:10:22,400 --> 00:10:31,910
host log on using lateral movement if

201
00:10:29,780 --> 00:10:34,850
Martha struggle attempt to multi

202
00:10:31,910 --> 00:10:41,180
prahasta occur from account the road

203
00:10:34,850 --> 00:10:44,240
will be like this if the incident is in

204
00:10:41,180 --> 00:10:52,370
practice we can handle it is visualizing

205
00:10:44,240 --> 00:10:56,870
result however in dirty program is not

206
00:10:52,370 --> 00:10:59,200
as simple as we imagined this is an

207
00:10:56,870 --> 00:11:02,140
example visualize a pet

208
00:10:59,200 --> 00:11:09,250
active directory of the organization in

209
00:11:02,140 --> 00:11:12,330
which the incident occurred yes so this

210
00:11:09,250 --> 00:11:16,090
is always a problem with radical

211
00:11:12,330 --> 00:11:19,480
visualization if you have a good enough

212
00:11:16,090 --> 00:11:23,920
eyesight you could find much a struggle

213
00:11:19,480 --> 00:11:26,860
from this figure but most people will

214
00:11:23,920 --> 00:11:28,750
find it difficult to analyze this figure

215
00:11:26,860 --> 00:11:32,650
from this result

216
00:11:28,750 --> 00:11:35,890
Biron thought visualization is good

217
00:11:32,650 --> 00:11:39,550
support for analyzing simply talk but

218
00:11:35,890 --> 00:11:42,220
not a perfect solution missing that

219
00:11:39,550 --> 00:11:47,709
another approach is needed to analyzing

220
00:11:42,220 --> 00:11:51,430
the patrol therefore we thought about

221
00:11:47,710 --> 00:11:53,290
the next approach it is difficult to

222
00:11:51,430 --> 00:11:56,709
analyze the roto flows using

223
00:11:53,290 --> 00:12:00,810
visualization but if we can

224
00:11:56,710 --> 00:12:05,830
automatically least suspicious account

225
00:12:00,810 --> 00:12:07,959
analysis will be smooth so we proposed a

226
00:12:05,830 --> 00:12:14,670
new method to automatically detect

227
00:12:07,960 --> 00:12:22,150
malicious rogan next let me introduce

228
00:12:14,670 --> 00:12:25,630
methods of automatic analysis in order

229
00:12:22,150 --> 00:12:27,780
to create automatic detection method it

230
00:12:25,630 --> 00:12:31,300
is necessary to understand more about

231
00:12:27,780 --> 00:12:34,839
throttle movement through our experience

232
00:12:31,300 --> 00:12:37,300
in many case of instant response we

233
00:12:34,840 --> 00:12:39,870
found that the Tucker normal conductor a

234
00:12:37,300 --> 00:12:42,750
thermometer in the flowing steps

235
00:12:39,870 --> 00:12:47,530
this rider introduced a flow of

236
00:12:42,750 --> 00:12:50,020
repetitions Takaful infected the host

237
00:12:47,530 --> 00:12:54,160
with marina collecting information on

238
00:12:50,020 --> 00:12:57,220
the host next they corrected information

239
00:12:54,160 --> 00:13:01,719
of other host and serve of this in the

240
00:12:57,220 --> 00:13:06,670
network and the disability infection to

241
00:13:01,720 --> 00:13:08,380
other hosts there is the confidential

242
00:13:06,670 --> 00:13:16,030
information using your

243
00:13:08,380 --> 00:13:23,800
sorry son saw last they find credit

244
00:13:16,030 --> 00:13:27,160
files the rocks this is an example of

245
00:13:23,800 --> 00:13:31,900
lateral movement steps executed command

246
00:13:27,160 --> 00:13:34,300
by ticks attacker tip is espionage a

247
00:13:31,900 --> 00:13:36,939
groups known targeted to Japanese

248
00:13:34,300 --> 00:13:39,900
organization such as job government

249
00:13:36,940 --> 00:13:43,090
agency as well as there is a

250
00:13:39,900 --> 00:13:50,709
biotechnology electrical manufacturing

251
00:13:43,090 --> 00:13:53,470
and industrial chemistry inter

252
00:13:50,710 --> 00:13:57,280
investigation start with through a my

253
00:13:53,470 --> 00:14:01,390
command the use miracle to create a

254
00:13:57,280 --> 00:14:05,860
court etiquette internal recon years of

255
00:14:01,390 --> 00:14:14,350
income and after that years net command

256
00:14:05,860 --> 00:14:17,440
to map our remote hosts they execute the

257
00:14:14,350 --> 00:14:18,850
fire to remote host with the copy and

258
00:14:17,440 --> 00:14:26,290
eighty command

259
00:14:18,850 --> 00:14:30,610
and finally delete the files from our

260
00:14:26,290 --> 00:14:34,329
experience of the fil there are 3 common

261
00:14:30,610 --> 00:14:38,290
future in return movement first attack

262
00:14:34,330 --> 00:14:43,000
is not only at actors but also Windows

263
00:14:38,290 --> 00:14:45,810
command and res matters next they use

264
00:14:43,000 --> 00:14:50,770
domain unrest or attack account

265
00:14:45,810 --> 00:14:56,050
finally they use us they use the story I

266
00:14:50,770 --> 00:14:59,920
can't repeat it to rogue on my attacker

267
00:14:56,050 --> 00:15:04,449
you vertical use domain administrator

268
00:14:59,920 --> 00:15:07,990
account the reason for this is simple it

269
00:15:04,450 --> 00:15:09,910
is possible to log onto or host and

270
00:15:07,990 --> 00:15:15,320
server using the domain administrator

271
00:15:09,910 --> 00:15:18,709
account there are severe but how

272
00:15:15,320 --> 00:15:21,760
/ domain address traitor password an

273
00:15:18,710 --> 00:15:25,280
account the most common method is

274
00:15:21,760 --> 00:15:27,700
exploiting ability administrator account

275
00:15:25,280 --> 00:15:31,120
password

276
00:15:27,700 --> 00:15:34,300
many organizations common posada for

277
00:15:31,120 --> 00:15:37,970
administrator account to manage hosts

278
00:15:34,300 --> 00:15:41,479
therefore if the attacker can store my

279
00:15:37,970 --> 00:15:48,860
account at infected hosts they can

280
00:15:41,480 --> 00:15:51,590
easily account all host installs the

281
00:15:48,860 --> 00:15:55,760
attacker use return movement of advanced

282
00:15:51,590 --> 00:15:58,910
or account as a result a host that has

283
00:15:55,760 --> 00:16:03,290
been compromised by the attacker will be

284
00:15:58,910 --> 00:16:07,339
use of in for logon to many hosts with

285
00:16:03,290 --> 00:16:12,550
the same account robot many hosts this

286
00:16:07,340 --> 00:16:15,950
account is a special suspicious activity

287
00:16:12,550 --> 00:16:21,709
we apply the filter to automatic

288
00:16:15,950 --> 00:16:24,800
detection we oppress a common in certain

289
00:16:21,710 --> 00:16:29,240
moment introduced area to automatic

290
00:16:24,800 --> 00:16:32,780
analysis specifically in this

291
00:16:29,240 --> 00:16:37,670
visualization event roll we propose a

292
00:16:32,780 --> 00:16:41,870
method to automatically detect user a so

293
00:16:37,670 --> 00:16:46,490
how can I automatically detect user area

294
00:16:41,870 --> 00:16:50,410
of this figure there are several

295
00:16:46,490 --> 00:16:54,530
approach to services tasks we use

296
00:16:50,410 --> 00:16:59,719
network analysis to detect out accounts

297
00:16:54,530 --> 00:17:03,050
that log on to Mary host network

298
00:16:59,720 --> 00:17:05,800
analysis is analyzing the property of a

299
00:17:03,050 --> 00:17:10,839
complex network in the various field

300
00:17:05,800 --> 00:17:14,149
network analysis has two metrics

301
00:17:10,839 --> 00:17:17,448
clustering is a task of grouping a set

302
00:17:14,150 --> 00:17:21,009
of objects in such a way that object in

303
00:17:17,449 --> 00:17:26,049
the same group most similar to each

304
00:17:21,009 --> 00:17:32,450
those other groups me use other metrics

305
00:17:26,049 --> 00:17:34,908
centrality centrality and network

306
00:17:32,450 --> 00:17:38,559
analysis centrality indicates the most

307
00:17:34,909 --> 00:17:42,440
important parties is in a garage in

308
00:17:38,559 --> 00:17:45,320
other words it is a method of

309
00:17:42,440 --> 00:17:48,919
calculating which node is connected to

310
00:17:45,320 --> 00:17:53,090
the most known there are similar

311
00:17:48,919 --> 00:17:59,840
algorithm to calculate strategy the most

312
00:17:53,090 --> 00:18:03,699
famous algorithm is PageRank so pension

313
00:17:59,840 --> 00:18:09,220
is an algorithm used by Google search

314
00:18:03,700 --> 00:18:14,090
rank village there's such a journalism

315
00:18:09,220 --> 00:18:17,330
idea of PageRank is as false important

316
00:18:14,090 --> 00:18:20,168
of a page started from many sites owns a

317
00:18:17,330 --> 00:18:24,769
number of link will be Raj

318
00:18:20,169 --> 00:18:28,729
main page links from web page with Rajan

319
00:18:24,769 --> 00:18:33,769
above link of how important PageRank is

320
00:18:28,729 --> 00:18:37,519
also used for ranking other people's web

321
00:18:33,769 --> 00:18:43,929
page can be used for spreaded graphs

322
00:18:37,519 --> 00:18:49,690
such as event or graph the original

323
00:18:43,929 --> 00:18:54,169
PageRank algorithm was described by

324
00:18:49,690 --> 00:18:58,700
discussed described by Brian of the page

325
00:18:54,169 --> 00:19:03,849
in several publications we calculate the

326
00:18:58,700 --> 00:19:07,129
centrality using algorithm and foundatio

327
00:19:03,849 --> 00:19:12,320
the PageRank for account Oregon is

328
00:19:07,129 --> 00:19:16,428
Hyosung only one host is corrected this

329
00:19:12,320 --> 00:19:20,480
issue is that the algorithm every

330
00:19:16,429 --> 00:19:25,519
organism others own personal have this

331
00:19:20,480 --> 00:19:30,980
so we investigated method to better

332
00:19:25,519 --> 00:19:35,029
calculatepay Jacques we solve the issue

333
00:19:30,980 --> 00:19:37,730
using this method increase the rank of

334
00:19:35,029 --> 00:19:42,019
an important account by changing the

335
00:19:37,730 --> 00:19:45,019
damping factor for each account the

336
00:19:42,019 --> 00:19:47,120
pager accessory hose that imaginary

337
00:19:45,019 --> 00:19:50,539
internet to use of who is randomly

338
00:19:47,120 --> 00:19:55,340
clicking on link via virtual east of

339
00:19:50,539 --> 00:19:58,820
clicking the probably at any steps that

340
00:19:55,340 --> 00:20:03,559
person will conducted continues to is

341
00:19:58,820 --> 00:20:05,899
damping factor various studies has

342
00:20:03,559 --> 00:20:07,970
attested to differently but it is the

343
00:20:05,899 --> 00:20:14,979
general sense that the damping factor

344
00:20:07,970 --> 00:20:18,440
will be set around 0.85 so it has been

345
00:20:14,980 --> 00:20:22,250
proposed that a method controls the rank

346
00:20:18,440 --> 00:20:26,360
of the spam rate by adjusting the assist

347
00:20:22,250 --> 00:20:30,769
agitation coefficient we also use a

348
00:20:26,360 --> 00:20:35,529
method to control the lock of lunkov

349
00:20:30,769 --> 00:20:35,529
account by controlling the damping photo

350
00:20:37,370 --> 00:20:44,840
the president has that change the

351
00:20:41,809 --> 00:20:49,250
damping factor value for each account is

352
00:20:44,840 --> 00:20:53,929
defined by the following formula D is a

353
00:20:49,250 --> 00:20:56,809
damping factor of page a and the next

354
00:20:53,930 --> 00:21:03,410
question is how to decide the damping

355
00:20:56,809 --> 00:21:07,180
factor the dynamically calculate the

356
00:21:03,410 --> 00:21:10,760
damping factor from the flowing air vent

357
00:21:07,180 --> 00:21:11,210
account private audience authentication

358
00:21:10,760 --> 00:21:13,550
type

359
00:21:11,210 --> 00:21:16,550
Annamarie detection of a logo inventor

360
00:21:13,550 --> 00:21:20,590
of highbrow and unmarried detection of a

361
00:21:16,550 --> 00:21:20,590
state-transition over Logan Event log

362
00:21:22,000 --> 00:21:29,870
after destroyed we will introduce the

363
00:21:25,280 --> 00:21:34,190
servant first element is account private

364
00:21:29,870 --> 00:21:38,059
as I said earlier the other historical

365
00:21:34,190 --> 00:21:43,040
account is used by the target therefore

366
00:21:38,059 --> 00:21:44,950
it is better to not mistreat account to

367
00:21:43,040 --> 00:21:47,540
rank hoider

368
00:21:44,950 --> 00:21:52,270
second derivative is the authentication

369
00:21:47,540 --> 00:21:57,200
type if the attacker use pasta Hodge

370
00:21:52,270 --> 00:22:00,440
material syndication is recorded so if I

371
00:21:57,200 --> 00:22:06,980
can't use anything education for dog on

372
00:22:00,440 --> 00:22:09,830
the rug will be higher third parameter

373
00:22:06,980 --> 00:22:14,530
is unmarried detection of logo event

374
00:22:09,830 --> 00:22:17,270
roll timeline only detection by canto

375
00:22:14,530 --> 00:22:21,590
counting the number of dog inventor

376
00:22:17,270 --> 00:22:24,320
Alzheimer for example the Rose de

377
00:22:21,590 --> 00:22:28,250
Beauvoir go fellas maybe brute-force

378
00:22:24,320 --> 00:22:32,899
attack we use the change finder to

379
00:22:28,250 --> 00:22:35,510
unbury detection change finder is the

380
00:22:32,900 --> 00:22:38,330
time failure data change point detection

381
00:22:35,510 --> 00:22:42,170
algorithms that can detect the change

382
00:22:38,330 --> 00:22:44,540
point in real time future change Friday

383
00:22:42,170 --> 00:22:47,710
is the raw computational complexity

384
00:22:44,540 --> 00:22:51,279
therefore it is used for real-time

385
00:22:47,710 --> 00:22:54,549
Marie detection if change by the

386
00:22:51,279 --> 00:22:57,029
detector timeline Annamarie the rod will

387
00:22:54,549 --> 00:22:57,029
be higher

388
00:22:57,659 --> 00:23:03,909
finally unbury detection of the state

389
00:23:00,730 --> 00:23:06,870
transition of Oregon inventory window

390
00:23:03,909 --> 00:23:11,250
windows rogue have three state

391
00:23:06,870 --> 00:23:15,279
transition account to not Rogo Rogo

392
00:23:11,250 --> 00:23:19,690
attempt and the rock doll it shift from

393
00:23:15,279 --> 00:23:28,179
dog zone not rogue on state rogue

394
00:23:19,690 --> 00:23:30,669
attempt and finally dog dog dog if it is

395
00:23:28,179 --> 00:23:33,909
Marcia struggle the state transition

396
00:23:30,669 --> 00:23:37,390
male become animal in case of

397
00:23:33,909 --> 00:23:42,960
brute-force attack or plastic ate the

398
00:23:37,390 --> 00:23:47,529
state did not built doggone dog attempt

399
00:23:42,960 --> 00:23:53,049
the exam method detective unmarried in

400
00:23:47,529 --> 00:23:55,779
this state transition so we propose a

401
00:23:53,049 --> 00:24:00,539
method to detect on marine state

402
00:23:55,779 --> 00:24:00,539
transition using massive rolling

403
00:24:02,700 --> 00:24:11,080
resistance to state transition recently

404
00:24:07,690 --> 00:24:13,470
recurrent neural network is mainstream

405
00:24:11,080 --> 00:24:16,389
is in this field

406
00:24:13,470 --> 00:24:20,679
however recurrent neural network has a

407
00:24:16,390 --> 00:24:23,429
program of large computational

408
00:24:20,679 --> 00:24:26,529
complexity

409
00:24:23,429 --> 00:24:31,929
however we analyze a matter of using

410
00:24:26,529 --> 00:24:34,390
hidden Markov model the hidden Markov

411
00:24:31,929 --> 00:24:37,299
model is one of the most important

412
00:24:34,390 --> 00:24:42,460
machine learning model in speech and

413
00:24:37,299 --> 00:24:45,110
language processing this model is a

414
00:24:42,460 --> 00:24:50,180
state transition or passing

415
00:24:45,110 --> 00:24:54,649
a pass is a hidden state and the bed is

416
00:24:50,180 --> 00:24:56,200
model from the output result of that

417
00:24:54,650 --> 00:25:00,920
state

418
00:24:56,200 --> 00:25:04,720
this figure is an example of the hidden

419
00:25:00,920 --> 00:25:09,410
Markov model for example a summer

420
00:25:04,720 --> 00:25:14,690
Passover lipids as revent workshop and

421
00:25:09,410 --> 00:25:18,170
cream the the event to be conducted will

422
00:25:14,690 --> 00:25:23,990
depend on the visa of the time however

423
00:25:18,170 --> 00:25:27,140
will weather itself is not disclose when

424
00:25:23,990 --> 00:25:31,010
you only know the conduct at event you

425
00:25:27,140 --> 00:25:37,520
can serve the current vessel this is how

426
00:25:31,010 --> 00:25:40,700
hidden Markov model works beyond reside

427
00:25:37,520 --> 00:25:46,600
petrov using hidden Markov model event

428
00:25:40,700 --> 00:25:51,050
rogue this these raw doggin event IDs

429
00:25:46,600 --> 00:25:57,080
and the hidden state not rogue on dog

430
00:25:51,050 --> 00:26:01,370
attempt under dog law predicts estate

431
00:25:57,080 --> 00:26:04,340
firms identity timeline the hidden

432
00:26:01,370 --> 00:26:08,800
Markov model can detect that it does not

433
00:26:04,340 --> 00:26:08,800
move the stage one or two

434
00:26:09,400 --> 00:26:14,420
this is an example of analyzing a

435
00:26:12,080 --> 00:26:18,379
bedroll timeline with hidden Markov

436
00:26:14,420 --> 00:26:22,760
model if normal dog on it vary from

437
00:26:18,380 --> 00:26:28,600
state 0 to 1 and the finally move to

438
00:26:22,760 --> 00:26:32,720
stage 2 but in the case of pasta Hodge

439
00:26:28,600 --> 00:26:37,550
from opposite yet it has not shift to

440
00:26:32,720 --> 00:26:42,790
stage 1 if state transition other is

441
00:26:37,550 --> 00:26:42,790
because directed The Rock River higher

442
00:26:44,470 --> 00:26:52,230
we evacuated along the patriarchy using

443
00:26:47,950 --> 00:26:56,620
discernment as a result of evaluation

444
00:26:52,230 --> 00:26:59,710
dismissal Taha was capable of detecting

445
00:26:56,620 --> 00:27:03,040
account using is a pastor Hajj or

446
00:26:59,710 --> 00:27:06,820
passage killed by another human I went

447
00:27:03,040 --> 00:27:12,129
rogue it is all also post impossible to

448
00:27:06,820 --> 00:27:17,740
detect a suspicious rogue on however the

449
00:27:12,130 --> 00:27:22,020
case which cannot be detected page with

450
00:27:17,740 --> 00:27:26,350
dynamic damping factor has programs

451
00:27:22,020 --> 00:27:30,010
false positive if the built-in

452
00:27:26,350 --> 00:27:33,370
administrator account is used for all

453
00:27:30,010 --> 00:27:37,750
hosts on server the patriarchal

454
00:27:33,370 --> 00:27:42,040
vision cause account will be higher for

455
00:27:37,750 --> 00:27:47,170
the next fourth negative if the attacker

456
00:27:42,040 --> 00:27:51,310
infected only one host it is difficult

457
00:27:47,170 --> 00:27:58,150
to detect subtle active activity this is

458
00:27:51,310 --> 00:28:01,740
a future tasks okay thank you should say

459
00:27:58,150 --> 00:28:04,840
for insert introducing our method and

460
00:28:01,740 --> 00:28:07,330
analyzing Active Directory from here I

461
00:28:04,840 --> 00:28:11,949
would like to introduce our two logon

462
00:28:07,330 --> 00:28:14,320
tracer yes local tracer is a tool to

463
00:28:11,950 --> 00:28:16,570
investigate malicious logon by

464
00:28:14,320 --> 00:28:19,810
visualizing and analyzing Windows Active

465
00:28:16,570 --> 00:28:23,110
Directory led logs its python-based to

466
00:28:19,810 --> 00:28:25,870
with web GUI and we use nail for je as a

467
00:28:23,110 --> 00:28:28,870
database and use cytoscape for

468
00:28:25,870 --> 00:28:30,879
visualizing and it open-source software

469
00:28:28,870 --> 00:28:34,510
people office open source software and

470
00:28:30,880 --> 00:28:38,410
developed on github and we released the

471
00:28:34,510 --> 00:28:41,379
first version at no vapor 2017 and we

472
00:28:38,410 --> 00:28:46,300
released the latest version 1.3 last

473
00:28:41,380 --> 00:28:51,490
week here's how long on Twitter works

474
00:28:46,300 --> 00:28:55,629
it's very simple we applause a EVT X

475
00:28:51,490 --> 00:28:58,059
file or XML file and log on Twitter will

476
00:28:55,630 --> 00:29:02,080
analyze it and

477
00:28:58,059 --> 00:29:06,070
visualize it the file format should be

478
00:29:02,080 --> 00:29:08,830
every TX or XML okay

479
00:29:06,070 --> 00:29:11,649
local tracer has four features first

480
00:29:08,830 --> 00:29:13,599
feature is visualizing event logs it

481
00:29:11,649 --> 00:29:16,570
makes it easier to understand what is

482
00:29:13,599 --> 00:29:19,029
happening under the active directory and

483
00:29:16,570 --> 00:29:21,789
second is displays an important account

484
00:29:19,029 --> 00:29:24,460
at host this is very very useful feature

485
00:29:21,789 --> 00:29:26,109
and dfi are and you can find a

486
00:29:24,460 --> 00:29:28,929
suspicious account and hast very quickly

487
00:29:26,109 --> 00:29:32,289
with using the PageRank with dynamic

488
00:29:28,929 --> 00:29:34,389
damping factor the third one is at an

489
00:29:32,289 --> 00:29:37,509
event log search and it pretty it's a

490
00:29:34,389 --> 00:29:39,339
preset of the searches conditions for

491
00:29:37,509 --> 00:29:42,309
investigate active directory bin logs

492
00:29:39,339 --> 00:29:45,759
and it accelerate your log analysis and

493
00:29:42,309 --> 00:29:47,440
forced feature is timeline and you could

494
00:29:45,759 --> 00:29:50,200
make the timeline table very quickly in

495
00:29:47,440 --> 00:29:52,929
this tail it's - and this feature also

496
00:29:50,200 --> 00:29:58,059
helps your analysis and reporting I'd

497
00:29:52,929 --> 00:30:00,219
leave ok this is the web GUI for rocket

498
00:29:58,059 --> 00:30:04,629
racer and all the logon tracer and I

499
00:30:00,219 --> 00:30:07,509
believe it's very simple and opera area

500
00:30:04,629 --> 00:30:10,589
is a certain application part and you

501
00:30:07,509 --> 00:30:12,999
could set the search conditions here and

502
00:30:10,589 --> 00:30:14,529
the right side table shows the rank of

503
00:30:12,999 --> 00:30:17,109
the page rank with dynamic damping

504
00:30:14,529 --> 00:30:20,200
factor it is well the most important

505
00:30:17,109 --> 00:30:22,119
part of the GUI and the upper table in

506
00:30:20,200 --> 00:30:24,729
the red box so the suspicious account

507
00:30:22,119 --> 00:30:27,218
ranking and a lower table so the

508
00:30:24,729 --> 00:30:30,369
suspicious Hass ranking and you can find

509
00:30:27,219 --> 00:30:33,009
important ranking or malicious accounts

510
00:30:30,369 --> 00:30:37,449
and host and di-pi very quickly from

511
00:30:33,009 --> 00:30:40,089
here and the less box so the additional

512
00:30:37,450 --> 00:30:42,129
event log starts you could use this drop

513
00:30:40,089 --> 00:30:48,369
down menu to search our current names

514
00:30:42,129 --> 00:30:50,289
matching specific criteria and here's a

515
00:30:48,369 --> 00:30:53,049
list of the additional event log search

516
00:30:50,289 --> 00:30:56,379
all sorry for very small letters and

517
00:30:53,049 --> 00:30:58,658
this these searches are the essence of

518
00:30:56,379 --> 00:31:01,059
Active Directory live blog with this

519
00:30:58,659 --> 00:31:03,249
these searches you can check almost

520
00:31:01,059 --> 00:31:06,039
almost all kind of remote log long

521
00:31:03,249 --> 00:31:06,729
activities you could check the failure

522
00:31:06,039 --> 00:31:10,749
logs

523
00:31:06,729 --> 00:31:11,710
bigger logs all MS 1406 eight very

524
00:31:10,749 --> 00:31:14,320
famous explorer

525
00:31:11,710 --> 00:31:17,290
it could check the possibility of DC

526
00:31:14,320 --> 00:31:20,950
sync or DC shadow attempts and etcetera

527
00:31:17,290 --> 00:31:24,340
etcetera when I investigate 80 laws I

528
00:31:20,950 --> 00:31:27,310
check all of these Alice's and we knew

529
00:31:24,340 --> 00:31:30,000
where we add a new function this graph

530
00:31:27,310 --> 00:31:35,379
and the latest release let me introduce

531
00:31:30,000 --> 00:31:38,080
in the next slide so here's a diff graph

532
00:31:35,380 --> 00:31:41,950
it allows you to give to specific date

533
00:31:38,080 --> 00:31:44,949
and extract a unique event if you know

534
00:31:41,950 --> 00:31:47,530
of a clean day or not compromise day you

535
00:31:44,950 --> 00:31:50,170
could compare it compare it with and

536
00:31:47,530 --> 00:31:53,290
check it there is there any suspicious

537
00:31:50,170 --> 00:31:57,490
activity occurred if you could you find

538
00:31:53,290 --> 00:31:59,680
some graph like like one on the slide I

539
00:31:57,490 --> 00:32:02,700
recommend you to start your

540
00:31:59,680 --> 00:32:02,700
investigation right now

541
00:32:03,480 --> 00:32:09,370
okay another feature of functions is

542
00:32:06,490 --> 00:32:11,260
search paths this function allows you to

543
00:32:09,370 --> 00:32:15,550
search which node has the path to the

544
00:32:11,260 --> 00:32:17,140
administrator so for example if you know

545
00:32:15,550 --> 00:32:19,590
they've picked it hast you could find

546
00:32:17,140 --> 00:32:22,540
the possibility to the domain

547
00:32:19,590 --> 00:32:26,409
possibility post possible paths user to

548
00:32:22,540 --> 00:32:28,180
mayor the mayor any account this idea is

549
00:32:26,410 --> 00:32:31,620
based on the bloodhound and it's a very

550
00:32:28,180 --> 00:32:34,030
very famous - so you can google it and

551
00:32:31,620 --> 00:32:37,510
here's the interface of the timeline

552
00:32:34,030 --> 00:32:40,860
table and here it shows the summary of

553
00:32:37,510 --> 00:32:45,310
the event like a log in time lighter and

554
00:32:40,860 --> 00:32:48,610
the number and the cell is the count of

555
00:32:45,310 --> 00:32:52,240
the event in each hour and highlighted

556
00:32:48,610 --> 00:32:54,550
cells shows the anomaly score so you can

557
00:32:52,240 --> 00:32:59,020
find a suspicious activity if by the

558
00:32:54,550 --> 00:33:01,300
collar sell very quickly and this is an

559
00:32:59,020 --> 00:33:04,300
interface of a timeline graph this graph

560
00:33:01,300 --> 00:33:06,129
shows about the specific user and you

561
00:33:04,300 --> 00:33:08,950
could check the transition all depends

562
00:33:06,130 --> 00:33:13,120
with anomaly score yeah it's also a very

563
00:33:08,950 --> 00:33:15,070
useful feature okay now let's move on to

564
00:33:13,120 --> 00:33:16,899
the demonstration we prepare a

565
00:33:15,070 --> 00:33:18,820
demonstration movie and I like to show

566
00:33:16,900 --> 00:33:22,570
the usage of the demonstration which are

567
00:33:18,820 --> 00:33:24,889
also logon tracer with it in this

568
00:33:22,570 --> 00:33:27,309
demonstration I will like to

569
00:33:24,890 --> 00:33:31,100
a real case sample we handled in Japan

570
00:33:27,309 --> 00:33:35,389
possibly a reactor in this case is wente

571
00:33:31,100 --> 00:33:38,899
group vinci group is cyber espionage is

572
00:33:35,390 --> 00:33:42,230
known as no it's targeting in japan and

573
00:33:38,900 --> 00:33:45,320
targeting japanese chemical sector or

574
00:33:42,230 --> 00:33:46,610
Japanese governments and in the most

575
00:33:45,320 --> 00:33:48,860
recent of course I've masked all the

576
00:33:46,610 --> 00:33:50,510
sensitive data which which which is

577
00:33:48,860 --> 00:33:53,409
which shows a big stand so don't

578
00:33:50,510 --> 00:33:56,530
hesitate to debate take pictures here

579
00:33:53,410 --> 00:33:58,820
okay so before looping on the

580
00:33:56,530 --> 00:34:00,889
demonstration I'd like to introduce the

581
00:33:58,820 --> 00:34:03,860
background event background of the

582
00:34:00,890 --> 00:34:06,500
investigation so before starting

583
00:34:03,860 --> 00:34:08,659
investigation the trigger of the

584
00:34:06,500 --> 00:34:11,659
incident was detection of the malware

585
00:34:08,659 --> 00:34:16,720
and several hosts in the victim victim

586
00:34:11,659 --> 00:34:20,270
organization in this case the antivirus

587
00:34:16,719 --> 00:34:23,928
software detected a malware and it ended

588
00:34:20,270 --> 00:34:26,659
it indicated at a PT malware so the

589
00:34:23,929 --> 00:34:30,290
victim salt is there any other infection

590
00:34:26,659 --> 00:34:33,800
hosts under the 80 networks and they

591
00:34:30,290 --> 00:34:37,639
asked us and we started to help their ad

592
00:34:33,800 --> 00:34:39,200
log investigation so okay let's move on

593
00:34:37,639 --> 00:34:43,550
and I propellant movie of the

594
00:34:39,199 --> 00:34:45,678
administration okay first the first

595
00:34:43,550 --> 00:34:47,899
thing we do in the ad log investigation

596
00:34:45,679 --> 00:34:51,109
is of course importing the logs to log

597
00:34:47,899 --> 00:34:54,049
on tracer and we start investigating and

598
00:34:51,109 --> 00:35:02,390
checking the high score users with logon

599
00:34:54,050 --> 00:35:04,010
tracer okay it's coming yes so so people

600
00:35:02,390 --> 00:35:07,069
on the right part shows a high score

601
00:35:04,010 --> 00:35:09,310
user in other words suspicious users and

602
00:35:07,070 --> 00:35:13,040
let's check it one by one

603
00:35:09,310 --> 00:35:15,650
so let's click and yeah you find a very

604
00:35:13,040 --> 00:35:17,750
very suspicious I can't here and now

605
00:35:15,650 --> 00:35:24,590
it's changing the graph mode it's to

606
00:35:17,750 --> 00:35:27,830
show it more cooler and yes so you find

607
00:35:24,590 --> 00:35:31,310
that a demonstrator account has access

608
00:35:27,830 --> 00:35:33,500
to a lot of sauce and it has a system

609
00:35:31,310 --> 00:35:36,950
privilege surrend also the system

610
00:35:33,500 --> 00:35:38,420
privilege and that's that next one is

611
00:35:36,950 --> 00:35:40,310
that you find another

612
00:35:38,420 --> 00:35:44,000
privileged accounts very suspicious

613
00:35:40,310 --> 00:35:49,790
access to several hosts and checking

614
00:35:44,000 --> 00:35:51,800
next one is very clear clear there so

615
00:35:49,790 --> 00:35:55,250
yeah from the right side of the table

616
00:35:51,800 --> 00:35:57,620
you could find to triplets acts triplets

617
00:35:55,250 --> 00:36:03,260
users such Barrett it's very suspicious

618
00:35:57,620 --> 00:36:06,710
pretty decent here okay let's move on to

619
00:36:03,260 --> 00:36:10,160
the next demonstration from here we next

620
00:36:06,710 --> 00:36:12,080
we do is as you know event log certs lot

621
00:36:10,160 --> 00:36:16,250
on Twitter profile is a several preset

622
00:36:12,080 --> 00:36:19,340
searches so let's check it so first we

623
00:36:16,250 --> 00:36:21,890
extract all tributes users activity and

624
00:36:19,340 --> 00:36:25,460
the result was yeah it was same that we

625
00:36:21,890 --> 00:36:33,100
see in the previous movie and next let's

626
00:36:25,460 --> 00:36:33,100
x LT ml log on about Logan's okay and

627
00:36:34,840 --> 00:36:47,000
it's working working and yes it comes so

628
00:36:45,170 --> 00:36:49,190
yeah you can also find a privileged

629
00:36:47,000 --> 00:36:54,110
users who had access to several hot now

630
00:36:49,190 --> 00:36:58,010
it's true it's dragging and in this case

631
00:36:54,110 --> 00:37:00,020
if the previous user has used MDMA logon

632
00:36:58,010 --> 00:37:03,560
there's a high possibility of the pastor

633
00:37:00,020 --> 00:37:05,870
has or or sometimes a de-stressor

634
00:37:03,560 --> 00:37:08,180
account was used for the very old system

635
00:37:05,870 --> 00:37:11,600
authentication so we need to check it

636
00:37:08,180 --> 00:37:13,879
and we need to ask it with which is the

637
00:37:11,600 --> 00:37:17,650
true to the victim in this case and also

638
00:37:13,880 --> 00:37:21,020
you can find out gree Blue Note written

639
00:37:17,650 --> 00:37:24,860
anonymous logon but this is the system

640
00:37:21,020 --> 00:37:27,259
activity so Windows in this case network

641
00:37:24,860 --> 00:37:29,630
device search from the windows systems

642
00:37:27,260 --> 00:37:32,930
just working so it's it's not suspicious

643
00:37:29,630 --> 00:37:36,830
and now it's checking the RDP logon and

644
00:37:32,930 --> 00:37:39,620
you find one user has a demonstrated

645
00:37:36,830 --> 00:37:42,170
triple its account and access to three

646
00:37:39,620 --> 00:37:47,000
hosts it's very suspicious and now next

647
00:37:42,170 --> 00:37:48,700
we will check the MS 1406 8 exploits

648
00:37:47,000 --> 00:37:51,750
failures

649
00:37:48,700 --> 00:37:54,899
clicking the burden

650
00:37:51,750 --> 00:37:57,869
yes here and if nothing sir if it

651
00:37:54,900 --> 00:38:01,260
doesn't find its its it display isn't so

652
00:37:57,869 --> 00:38:05,010
it's failed and here it's checking the

653
00:38:01,260 --> 00:38:08,940
DC sync and DC said our attempts and you

654
00:38:05,010 --> 00:38:12,180
can find that the count was used DC sink

655
00:38:08,940 --> 00:38:15,920
and on this time so dizzy think is a

656
00:38:12,180 --> 00:38:20,940
very famous attack message to dump a

657
00:38:15,920 --> 00:38:25,829
domain controllers database and what it

658
00:38:20,940 --> 00:38:28,619
means this user has a was able to access

659
00:38:25,829 --> 00:38:31,410
whole database whole database in domain

660
00:38:28,619 --> 00:38:31,770
controller so it means almost it's game

661
00:38:31,410 --> 00:38:34,770
over

662
00:38:31,770 --> 00:38:37,859
in this case Senate seeking of other

663
00:38:34,770 --> 00:38:41,180
things and nothing fine Senya that's all

664
00:38:37,859 --> 00:38:45,150
for the stellar event log search and

665
00:38:41,180 --> 00:38:47,058
next and next we do is domain test so

666
00:38:45,150 --> 00:38:49,950
let's move on to the next movie

667
00:38:47,059 --> 00:38:54,359
so welcome tracer let us to check the

668
00:38:49,950 --> 00:38:56,939
domain name recorded it event log so

669
00:38:54,359 --> 00:38:59,788
purple node shows the domain name which

670
00:38:56,940 --> 00:39:03,029
was targeted by the host and we are now

671
00:38:59,789 --> 00:39:06,930
looking and looking and we find sounds

672
00:39:03,029 --> 00:39:13,079
interesting domain names from here one

673
00:39:06,930 --> 00:39:17,578
is full lower cap full low case domain

674
00:39:13,079 --> 00:39:21,119
name and one is yeah this one full upper

675
00:39:17,579 --> 00:39:24,079
case domain name so I will like to

676
00:39:21,119 --> 00:39:27,869
describe what it's suspicious

677
00:39:24,079 --> 00:39:30,000
so in Windows event logs Windows Event

678
00:39:27,869 --> 00:39:34,020
log records targeted to maintain with a

679
00:39:30,000 --> 00:39:36,539
full upper case or full lower case if it

680
00:39:34,020 --> 00:39:38,759
both appears on the same date ID and

681
00:39:36,539 --> 00:39:42,029
it's under the same 80 it's a high

682
00:39:38,760 --> 00:39:46,230
possibility of the tool usage like mini

683
00:39:42,029 --> 00:39:49,859
cats so here's a sample common of the

684
00:39:46,230 --> 00:39:51,930
mini cats and you can find that you

685
00:39:49,859 --> 00:39:54,869
figure it and here it's generating

686
00:39:51,930 --> 00:39:57,839
golden ticket you need to pass the

687
00:39:54,869 --> 00:40:01,890
domain name to mini cut in this case but

688
00:39:57,839 --> 00:40:03,460
hacker or attackers sometimes put in the

689
00:40:01,890 --> 00:40:07,390
domain name and lower

690
00:40:03,460 --> 00:40:09,310
case and if lower case is put in one

691
00:40:07,390 --> 00:40:13,180
suspicious domain navel

692
00:40:09,310 --> 00:40:14,890
whoa will pop up on the logon tracer so

693
00:40:13,180 --> 00:40:18,490
you can find these kind of very

694
00:40:14,890 --> 00:40:20,980
interesting activity from here okay

695
00:40:18,490 --> 00:40:25,410
finally I would like to drill down into

696
00:40:20,980 --> 00:40:29,890
the illustrator come with Timeline view

697
00:40:25,410 --> 00:40:31,750
so here's a timeline view first of all

698
00:40:29,890 --> 00:40:33,850
you can fire the many authentication

699
00:40:31,750 --> 00:40:37,300
events happening on the left part of the

700
00:40:33,850 --> 00:40:42,130
graph yes here maybe it's a attackers

701
00:40:37,300 --> 00:40:44,920
activity in this situation yeah we

702
00:40:42,130 --> 00:40:46,660
believe it was attackers activities and

703
00:40:44,920 --> 00:40:51,310
you can find a high noble score at

704
00:40:46,660 --> 00:40:53,589
surrounds or arrow here so here Alice

705
00:40:51,310 --> 00:40:56,710
trader account has authenticated 90

706
00:40:53,590 --> 00:41:01,540
times in an hour so we believe it's

707
00:40:56,710 --> 00:41:04,000
pretty interesting activity and next

708
00:41:01,540 --> 00:41:07,120
thing interest point is a number of the

709
00:41:04,000 --> 00:41:09,940
ID for six to four and a number of event

710
00:41:07,120 --> 00:41:13,089
for seven six nine and the post is

711
00:41:09,940 --> 00:41:16,690
clearly increasing here ID for seven six

712
00:41:13,090 --> 00:41:18,460
nine is helble's service it requests so

713
00:41:16,690 --> 00:41:21,970
it simply means Kerberos authentication

714
00:41:18,460 --> 00:41:23,830
service issued many many service tickets

715
00:41:21,970 --> 00:41:27,310
to the administrator account in this

716
00:41:23,830 --> 00:41:29,259
short term so okay let's think about the

717
00:41:27,310 --> 00:41:33,009
situation about this kind of activity

718
00:41:29,260 --> 00:41:33,910
one possibility is for example yes IT

719
00:41:33,010 --> 00:41:37,870
department

720
00:41:33,910 --> 00:41:40,839
deployed something new to honor to a lot

721
00:41:37,870 --> 00:41:43,930
of servers and hast using cables also

722
00:41:40,840 --> 00:41:46,840
education or another one is attacker

723
00:41:43,930 --> 00:41:49,569
used TT pass the ticket for their

724
00:41:46,840 --> 00:41:53,080
rational movements so how do you think

725
00:41:49,570 --> 00:41:56,670
in this case I believe it was passed

726
00:41:53,080 --> 00:41:59,819
ticket so let's wrap up

727
00:41:56,670 --> 00:42:02,230
dominar demonstration and we

728
00:41:59,820 --> 00:42:04,210
investigated the ad server in Japanese

729
00:42:02,230 --> 00:42:07,120
organization that was attacked by the

730
00:42:04,210 --> 00:42:08,860
Ritchie group known as an apt group and

731
00:42:07,120 --> 00:42:12,130
we found two suspicious presence account

732
00:42:08,860 --> 00:42:14,190
users and one is a possibility used for

733
00:42:12,130 --> 00:42:16,780
lateral movement and was possibility

734
00:42:14,190 --> 00:42:19,480
possibly used for a back door

735
00:42:16,780 --> 00:42:22,330
and we also found a suspicious ntlm Oh

736
00:42:19,480 --> 00:42:25,240
longer attempts and possibly it's passed

737
00:42:22,330 --> 00:42:28,810
a hash and we also found a suspicious

738
00:42:25,240 --> 00:42:31,810
RDP logon attempts and we find another

739
00:42:28,810 --> 00:42:35,950
interesting indicator that shows DT

740
00:42:31,810 --> 00:42:38,320
think has attempt here and we also find

741
00:42:35,950 --> 00:42:43,180
suspicious domain name strings and we

742
00:42:38,320 --> 00:42:45,820
it's possibly a type of attackers using

743
00:42:43,180 --> 00:42:48,009
under using the hacking tools and we

744
00:42:45,820 --> 00:42:50,620
also we could also find the active term

745
00:42:48,010 --> 00:42:54,910
of the attacker under the domain it was

746
00:42:50,620 --> 00:42:57,339
three days suspicious suspicious pecos I

747
00:42:54,910 --> 00:43:00,190
being sent possibly the passage ticket

748
00:42:57,340 --> 00:43:02,410
yeah I talked a lot of things about this

749
00:43:00,190 --> 00:43:05,560
investigation but what I wanted so here

750
00:43:02,410 --> 00:43:08,440
was you could find a lot of indicators

751
00:43:05,560 --> 00:43:11,529
from from Active Directory been logged

752
00:43:08,440 --> 00:43:16,900
very quickly if you analyze it it was

753
00:43:11,530 --> 00:43:18,730
the right method so to know more detail

754
00:43:16,900 --> 00:43:22,360
about a lock on tracer or so please

755
00:43:18,730 --> 00:43:25,510
check it out or wiki on github in this

756
00:43:22,360 --> 00:43:27,970
wiki you can find how to install of

757
00:43:25,510 --> 00:43:30,580
course and how to start with docker it's

758
00:43:27,970 --> 00:43:32,430
very very easy to start and how to use

759
00:43:30,580 --> 00:43:36,520
it

760
00:43:32,430 --> 00:43:37,080
everyone already scanned the QR code

761
00:43:36,520 --> 00:43:40,509
okay

762
00:43:37,080 --> 00:43:43,020
okay I would like to move on next okay

763
00:43:40,510 --> 00:43:46,530
so I would like to wrap up today's talk

764
00:43:43,020 --> 00:43:49,690
first we talked how to use visualization

765
00:43:46,530 --> 00:43:53,530
network analysis and machine learning to

766
00:43:49,690 --> 00:43:55,780
increase the efficiency of DF IR we saw

767
00:43:53,530 --> 00:43:58,750
our basic approach in instant

768
00:43:55,780 --> 00:44:02,140
investigation and second we talked how

769
00:43:58,750 --> 00:44:04,120
to detect a logon attempts of passage

770
00:44:02,140 --> 00:44:07,540
hats and passes tickets front a band

771
00:44:04,120 --> 00:44:09,880
logs we show it using page rank change

772
00:44:07,540 --> 00:44:12,550
finder machine learning with hidden

773
00:44:09,880 --> 00:44:15,340
Markov model here and finally we talked

774
00:44:12,550 --> 00:44:18,190
how to investigate lateral movement from

775
00:44:15,340 --> 00:44:20,650
a from Active Directory Glen logs using

776
00:44:18,190 --> 00:44:22,720
logon tracer I believe logon tracer

777
00:44:20,650 --> 00:44:25,300
makes it easier to find malicious

778
00:44:22,720 --> 00:44:28,730
activity caused by the attacker and this

779
00:44:25,300 --> 00:44:31,759
tool will help your DF ir I

780
00:44:28,730 --> 00:44:35,059
and we appreciate giving us any feedback

781
00:44:31,759 --> 00:44:38,180
about this tool also it's open source

782
00:44:35,059 --> 00:44:44,329
and any pull requests on github or

783
00:44:38,180 --> 00:44:46,759
welcome and ok our future works two

784
00:44:44,329 --> 00:44:50,269
points for next step we are planning to

785
00:44:46,759 --> 00:44:52,970
do more evaluation tests with huge scale

786
00:44:50,269 --> 00:44:54,709
network data our brush up our algorithms

787
00:44:52,970 --> 00:44:58,098
to improve the malicious activity

788
00:44:54,710 --> 00:45:00,710
detection and we are also planning to

789
00:44:58,099 --> 00:45:03,559
combine new algorithm which consider

790
00:45:00,710 --> 00:45:06,380
time series such as recurrent neural

791
00:45:03,559 --> 00:45:08,269
network we are now in progress and

792
00:45:06,380 --> 00:45:12,130
developing new techniques to reduce

793
00:45:08,269 --> 00:45:14,629
false positives and for negative and

794
00:45:12,130 --> 00:45:17,180
repress we appreciate again giving us

795
00:45:14,630 --> 00:45:18,289
the opportunity to join in pH days and

796
00:45:17,180 --> 00:45:19,450
thank you for attention

797
00:45:18,289 --> 00:45:22,830
spasiba

798
00:45:19,450 --> 00:45:22,830
[Applause]

799
00:45:31,970 --> 00:45:35,049
any questions

800
00:45:39,970 --> 00:45:46,399
thank you for presentation it tell me

801
00:45:44,150 --> 00:45:51,410
how many compromised hosts do need to

802
00:45:46,400 --> 00:45:55,850
detect malicious activity how many hosts

803
00:45:51,410 --> 00:45:59,089
are do you have any idea of this for

804
00:45:55,850 --> 00:46:01,400
this question honestly we haven't

805
00:45:59,090 --> 00:46:05,330
evaluated how many hosts we need to

806
00:46:01,400 --> 00:46:10,190
detect but at least in your evaluation

807
00:46:05,330 --> 00:46:12,440
we do with twenty hosts and we was

808
00:46:10,190 --> 00:46:14,510
possible to detect at this time so we

809
00:46:12,440 --> 00:46:21,310
don't know the smallest number but at

810
00:46:14,510 --> 00:46:25,130
least we need 20 hosts machine me please

811
00:46:21,310 --> 00:46:27,080
thank you what hosts should provide

812
00:46:25,130 --> 00:46:29,030
looks for your system or only demand

813
00:46:27,080 --> 00:46:32,810
controllers or all computers in our

814
00:46:29,030 --> 00:46:35,540
Active Directory or all who are gone

815
00:46:32,810 --> 00:46:39,049
locks are stored on domain controllers

816
00:46:35,540 --> 00:46:41,240
and it is enough to your system also

817
00:46:39,050 --> 00:46:44,120
rhythm the side was hiring and I

818
00:46:41,240 --> 00:46:47,990
couldn't hear well so could you could

819
00:46:44,120 --> 00:46:50,390
you tell me again it's more smaller

820
00:46:47,990 --> 00:46:54,950
which which computers should provide

821
00:46:50,390 --> 00:46:57,910
locks to your system to detect attacks

822
00:46:54,950 --> 00:47:01,490
is it on the domain controllers or all

823
00:46:57,910 --> 00:47:04,310
computers user machines and servers or

824
00:47:01,490 --> 00:47:09,049
should provide logs to your system or

825
00:47:04,310 --> 00:47:10,940
only domain controllers oh sorry I'm not

826
00:47:09,050 --> 00:47:16,070
understanding well the question so you

827
00:47:10,940 --> 00:47:23,360
mean how the method speak to to run the

828
00:47:16,070 --> 00:47:30,620
lock on tracer you're asking me oh I'll

829
00:47:23,360 --> 00:47:32,030
go to here oh okay I understand the

830
00:47:30,620 --> 00:47:33,680
interesting oh we only need Active

831
00:47:32,030 --> 00:47:33,980
Directory logs we don't need any point

832
00:47:33,680 --> 00:47:39,379
logs

833
00:47:33,980 --> 00:47:42,600
only Active Directory logs - yeah and

834
00:47:39,380 --> 00:47:45,840
next week it doesn't make sense

835
00:47:42,600 --> 00:47:49,370
to your question okay

836
00:47:45,840 --> 00:47:49,370
sorry okay Nick

837
00:47:57,579 --> 00:48:07,910
it's a eigenbasis system or it can be

838
00:48:02,240 --> 00:48:12,459
collected offline so it sometimes we

839
00:48:07,910 --> 00:48:17,420
have problem we have online connect and

840
00:48:12,460 --> 00:48:21,530
when not in every system we can collect

841
00:48:17,420 --> 00:48:28,400
logs in we need offline analysis it's

842
00:48:21,530 --> 00:48:30,799
impossible from video system oh so maybe

843
00:48:28,400 --> 00:48:38,000
I'm not understanding well so you have

844
00:48:30,799 --> 00:48:42,440
offline system regime of you working

845
00:48:38,000 --> 00:48:44,930
online collecting logs yes uh in this

846
00:48:42,440 --> 00:48:49,069
case we were working on offline

847
00:48:44,930 --> 00:48:52,730
collected collect collected rent logs

848
00:48:49,069 --> 00:48:56,710
and don't export it to other place and

849
00:48:52,730 --> 00:48:56,710
we imported it

850
00:49:03,109 --> 00:49:08,509
thank you how many data did you use to

851
00:49:06,380 --> 00:49:12,160
train your hidden Markov model its

852
00:49:08,509 --> 00:49:17,180
thousand millions data say data records

853
00:49:12,160 --> 00:49:19,368
how many did I know sorry in Japanese

854
00:49:17,180 --> 00:49:22,339
don't know but I know sky kalguksu

855
00:49:19,369 --> 00:49:24,829
scotomas in data set on sites the title

856
00:49:22,339 --> 00:49:26,779
so you're asking that the size of the

857
00:49:24,829 --> 00:49:32,259
data set the size of data set to train

858
00:49:26,779 --> 00:49:32,259
your model is to reach accuracy over 96%

859
00:49:36,609 --> 00:49:43,009
first we use the data set we in our

860
00:49:40,249 --> 00:49:45,859
testing environment it was almost three

861
00:49:43,009 --> 00:49:50,029
megabytes and after then we train it

862
00:49:45,859 --> 00:49:51,828
with real victim sighs and I'm sorry I

863
00:49:50,029 --> 00:49:53,719
cannot answer the size of the real I

864
00:49:51,829 --> 00:49:56,059
forgot the size of the real victims at

865
00:49:53,719 --> 00:50:03,259
data but we train it with that and we

866
00:49:56,059 --> 00:50:06,699
were improving with hello thank you so

867
00:50:03,259 --> 00:50:13,009
much for your report I want to ask you

868
00:50:06,699 --> 00:50:17,059
have you any cases with overfitting when

869
00:50:13,009 --> 00:50:22,430
the model doesn't work how many cases

870
00:50:17,059 --> 00:50:24,920
doesn't model work so yes so it's pretty

871
00:50:22,430 --> 00:50:28,399
difficult to answer how many cases but

872
00:50:24,920 --> 00:50:32,900
for example if the big of the

873
00:50:28,400 --> 00:50:37,459
compromised organization well and you

874
00:50:32,900 --> 00:50:41,239
had not using one by one for one for in

875
00:50:37,459 --> 00:50:45,169
other words if one account was not used

876
00:50:41,239 --> 00:50:47,719
to one host but I was the the user was

877
00:50:45,170 --> 00:50:48,319
using one one account to access a lot of

878
00:50:47,719 --> 00:50:51,259
heart

879
00:50:48,319 --> 00:50:56,779
and the daily operation it it will have

880
00:50:51,259 --> 00:51:01,209
a false positive and I have one more

881
00:50:56,779 --> 00:51:03,559
question please what did you do with

882
00:51:01,209 --> 00:51:09,198
false positive and false negative

883
00:51:03,559 --> 00:51:12,920
classes and how we can improve our PR

884
00:51:09,199 --> 00:51:16,200
curve okay so your question is what we

885
00:51:12,920 --> 00:51:20,340
do if we find a false positive attend to

886
00:51:16,200 --> 00:51:24,319
improve the 15 is it right yes oh yes

887
00:51:20,340 --> 00:51:27,270
it's a very very good question yeah for

888
00:51:24,320 --> 00:51:31,830
based on the Howell ISM base of them

889
00:51:27,270 --> 00:51:34,259
algorithm it if it's if the whole place

890
00:51:31,830 --> 00:51:36,390
is the daily operation for example what

891
00:51:34,260 --> 00:51:38,070
is a daily operation well in the

892
00:51:36,390 --> 00:51:40,440
victim's organization they all

893
00:51:38,070 --> 00:51:44,000
operations they use one account to a lot

894
00:51:40,440 --> 00:51:49,380
of heart it's it's pretty it's it may be

895
00:51:44,000 --> 00:51:56,730
impossible to detect with this this this

896
00:51:49,380 --> 00:51:57,800
method but if but yeah so other things

897
00:51:56,730 --> 00:52:02,330
yeah

898
00:51:57,800 --> 00:52:05,520
not okay and now I have a good idea to

899
00:52:02,330 --> 00:52:07,650
reduce Paul possible with just we sound

900
00:52:05,520 --> 00:52:11,280
so first thing we need to do it why why

901
00:52:07,650 --> 00:52:13,560
we was exporting the false positives and

902
00:52:11,280 --> 00:52:18,080
if it was possible to fix people takes

903
00:52:13,560 --> 00:52:18,080
like there sorry sorry for not critical

904
00:52:23,030 --> 00:52:28,620
hi guys it was very interesting but I

905
00:52:26,310 --> 00:52:30,960
have a question how big was the

906
00:52:28,620 --> 00:52:34,410
infrastructure where you test it how

907
00:52:30,960 --> 00:52:37,950
much users how much hosts all so the

908
00:52:34,410 --> 00:52:42,899
question is the size of the since we

909
00:52:37,950 --> 00:52:46,710
tested okay in today's case we show as a

910
00:52:42,900 --> 00:52:49,860
demonstration was almost in my memory

911
00:52:46,710 --> 00:52:54,690
about the company size was overton the

912
00:52:49,860 --> 00:52:57,690
employees with all person 10,000 and so

913
00:52:54,690 --> 00:53:01,500
maybe it was the largest one we tested

914
00:52:57,690 --> 00:53:05,070
and passed and we want to test our

915
00:53:01,500 --> 00:53:10,640
larger network but we need a partner to

916
00:53:05,070 --> 00:53:10,640
provide us 80 logs thank you

917
00:53:13,770 --> 00:53:21,030
hello thank you do you have any

918
00:53:16,710 --> 00:53:26,960
mechanisms to accept some hosts or users

919
00:53:21,030 --> 00:53:30,390
to not include them in when you analyze

920
00:53:26,960 --> 00:53:34,970
so your question is do we have any

921
00:53:30,390 --> 00:53:38,460
mechanism to to avoid them usually

922
00:53:34,970 --> 00:53:42,540
analyzed unfortunately in this and this

923
00:53:38,460 --> 00:53:46,200
and this tool we dr. is completely

924
00:53:42,540 --> 00:53:51,540
isolated from the real network so we we

925
00:53:46,200 --> 00:53:54,240
only import the a pair locked is a lot

926
00:53:51,540 --> 00:53:58,170
on tracers so if we want to do so we

927
00:53:54,240 --> 00:54:00,890
need to call a collaborate with teams

928
00:53:58,170 --> 00:54:04,110
taste em or something like that or some

929
00:54:00,890 --> 00:54:10,020
orchestration system so yes the answer

930
00:54:04,110 --> 00:54:19,170
is no we don't have it yet okay last

931
00:54:10,020 --> 00:54:19,470
question best questions so one more

932
00:54:19,170 --> 00:54:23,250
question

933
00:54:19,470 --> 00:54:25,740
oh it's over oh it's for time okay sorry

934
00:54:23,250 --> 00:54:36,780
and one question is thank you for a big

935
00:54:25,740 --> 00:54:38,930
very good question okay I'll go to say

936
00:54:36,780 --> 00:54:38,930
dude

937
00:54:41,069 --> 00:54:48,239
so thank you very much spasibo

938
00:54:43,570 --> 00:54:48,239
[Applause]

