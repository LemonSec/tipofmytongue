1
00:00:00,030 --> 00:00:07,350
nobody opponent well frankly I thought

2
00:00:04,680 --> 00:00:10,649
nobody would wake up that early because

3
00:00:07,350 --> 00:00:14,518
when it they told me that I'm speaking

4
00:00:10,650 --> 00:00:17,250
before the official starts at half-past

5
00:00:14,519 --> 00:00:19,529
nine and it's quarter past 9:00

6
00:00:17,250 --> 00:00:23,070
I feel quite curious I should I won't

7
00:00:19,529 --> 00:00:24,840
discuss something exciting last week we

8
00:00:23,070 --> 00:00:27,840
took three and a half hours to make this

9
00:00:24,840 --> 00:00:30,390
presentation I added another hundred

10
00:00:27,840 --> 00:00:31,890
slides to it so basically we can fit it

11
00:00:30,390 --> 00:00:33,450
within an hour and a half

12
00:00:31,890 --> 00:00:36,750
what I'd like to tell you about is how

13
00:00:33,450 --> 00:00:38,879
they investigate incidents maybe not

14
00:00:36,750 --> 00:00:40,860
using our products but you want to

15
00:00:38,879 --> 00:00:43,920
understand how it works in IT security

16
00:00:40,860 --> 00:00:46,739
and how it works in real life so I

17
00:00:43,920 --> 00:00:49,200
prepared some really cool stuff for you

18
00:00:46,739 --> 00:00:52,739
first self introduction which will be

19
00:00:49,200 --> 00:00:54,570
easy and then I'll show you three cases

20
00:00:52,739 --> 00:00:56,849
three incidents the biggest question

21
00:00:54,570 --> 00:01:02,070
they ask me quite often look I found

22
00:00:56,850 --> 00:01:06,930
malware and how can i rap out rap out

23
00:01:02,070 --> 00:01:11,280
the roll out the causal effect change

24
00:01:06,930 --> 00:01:16,110
and that's exactly what I'm going to do

25
00:01:11,280 --> 00:01:19,020
my name is technical experts I setup and

26
00:01:16,110 --> 00:01:21,390
run our products in terms of the basic

27
00:01:19,020 --> 00:01:24,479
so I disappear if you all know the

28
00:01:21,390 --> 00:01:27,900
concept of kill chain a lot of you have

29
00:01:24,479 --> 00:01:33,930
heard these words like for instance how

30
00:01:27,900 --> 00:01:37,619
to attack you there are some research

31
00:01:33,930 --> 00:01:43,350
approaches from hackers and you'll hear

32
00:01:37,619 --> 00:01:47,158
about that traffic I just give you some

33
00:01:43,350 --> 00:01:50,220
examples of that can be used so then you

34
00:01:47,159 --> 00:01:52,259
get preparation of on a hacker prepare

35
00:01:50,220 --> 00:01:55,259
some code specifically for you it could

36
00:01:52,259 --> 00:01:57,630
be absolutely anything could be some

37
00:01:55,259 --> 00:02:01,140
eggs a file or an exploit that so you'll

38
00:01:57,630 --> 00:02:03,179
get as a phishing email over the PDF or

39
00:02:01,140 --> 00:02:06,570
Word document then we talk about

40
00:02:03,180 --> 00:02:08,270
delivery the most widespread delivery

41
00:02:06,570 --> 00:02:13,160
methods that

42
00:02:08,270 --> 00:02:16,760
see our phishing emails they often use a

43
00:02:13,160 --> 00:02:20,380
private email Gmail mail.ru instant

44
00:02:16,760 --> 00:02:27,200
managers messages and USB flash drives

45
00:02:20,380 --> 00:02:31,100
last time I did pen test we you know

46
00:02:27,200 --> 00:02:33,950
through about 10 CDs and the last one of

47
00:02:31,100 --> 00:02:37,310
them was inserting computer in ten

48
00:02:33,950 --> 00:02:44,079
minutes after we left it and of course

49
00:02:37,310 --> 00:02:49,790
the disk carries a sign saying employees

50
00:02:44,080 --> 00:02:53,690
payroll so I very much like the case

51
00:02:49,790 --> 00:02:55,459
there's a set of phishing emails that

52
00:02:53,690 --> 00:02:57,800
you can find in many web sites and in

53
00:02:55,460 --> 00:03:01,610
one of the examples as there was an

54
00:02:57,800 --> 00:03:07,940
email to a person from asan purportedly

55
00:03:01,610 --> 00:03:12,500
ozone it said hey guy you bought the

56
00:03:07,940 --> 00:03:16,579
book beside of my destiny that happened

57
00:03:12,500 --> 00:03:19,760
10 years ago and FSB is showing interest

58
00:03:16,580 --> 00:03:22,610
to you are you really interested in this

59
00:03:19,760 --> 00:03:25,519
terrorist Messiah and if you want to

60
00:03:22,610 --> 00:03:28,520
cancel your order press here so it's

61
00:03:25,520 --> 00:03:31,940
clear that a person having received this

62
00:03:28,520 --> 00:03:34,640
letter who would feel emotional and you

63
00:03:31,940 --> 00:03:36,680
may be tempted to press this button so

64
00:03:34,640 --> 00:03:38,600
I'm not going to talk you about these

65
00:03:36,680 --> 00:03:41,360
techniques I'll just tell you how to

66
00:03:38,600 --> 00:03:43,420
protect yourself problem there are lots

67
00:03:41,360 --> 00:03:47,150
of techniques here in terms of

68
00:03:43,420 --> 00:03:50,450
management we see quite a lot mostly is

69
00:03:47,150 --> 00:03:53,840
a back-channel from within outside

70
00:03:50,450 --> 00:03:55,579
firewalls allowing such connections so

71
00:03:53,840 --> 00:03:57,980
from the inside to the outside the

72
00:03:55,580 --> 00:03:58,720
person gets elected and then executes

73
00:03:57,980 --> 00:04:04,579
the command

74
00:03:58,720 --> 00:04:07,100
so the email there are also images that

75
00:04:04,580 --> 00:04:08,660
you can use to hide these commands and a

76
00:04:07,100 --> 00:04:11,299
lot can be done here the biggest

77
00:04:08,660 --> 00:04:12,420
services monetization to find the chief

78
00:04:11,300 --> 00:04:16,680
accountant

79
00:04:12,420 --> 00:04:21,089
replace a payment order and send some

80
00:04:16,680 --> 00:04:23,400
money to yourself there are also cases

81
00:04:21,089 --> 00:04:25,260
of extortion and let's just talk about

82
00:04:23,400 --> 00:04:29,630
exactly about this in the past

83
00:04:25,260 --> 00:04:33,450
up until now what I see people say no

84
00:04:29,630 --> 00:04:36,390
we're fine we're good because we don't

85
00:04:33,450 --> 00:04:38,010
see letters you know falling out of the

86
00:04:36,390 --> 00:04:40,110
screen you remember the first virus is

87
00:04:38,010 --> 00:04:41,969
like this it means you feel okay

88
00:04:40,110 --> 00:04:44,520
Wi-Fi is there Wi-Fi in this room we

89
00:04:41,970 --> 00:04:46,910
don't see other attacks in our company

90
00:04:44,520 --> 00:04:50,219
we don't see them we needed to and

91
00:04:46,910 --> 00:04:54,390
before we have a tool we can feel fine

92
00:04:50,220 --> 00:04:54,840
on the weekend I described this case for

93
00:04:54,390 --> 00:04:57,240
year

94
00:04:54,840 --> 00:05:00,179
thank God example a company where

95
00:04:57,240 --> 00:05:02,610
incident management is done properly I

96
00:05:00,180 --> 00:05:06,810
just saw a video that they recorded it's

97
00:05:02,610 --> 00:05:09,780
a Norwegian aluminium company that keeps

98
00:05:06,810 --> 00:05:11,610
talking about how they were hacked and

99
00:05:09,780 --> 00:05:16,500
how they investigate incident so what

100
00:05:11,610 --> 00:05:18,960
happened everything started with on the

101
00:05:16,500 --> 00:05:24,900
18th of March this year in the evening

102
00:05:18,960 --> 00:05:29,120
at the quarter to 11 screens started to

103
00:05:24,900 --> 00:05:34,469
behave in a funny way this company

104
00:05:29,120 --> 00:05:38,820
35,000 employees in 40 countries 160,000

105
00:05:34,470 --> 00:05:43,320
locations all this just went down in the

106
00:05:38,820 --> 00:05:47,640
brink in terms of what was happening as

107
00:05:43,320 --> 00:05:50,010
people told I shocked me our all

108
00:05:47,640 --> 00:05:55,110
computers stopped even those that were

109
00:05:50,010 --> 00:05:58,460
controlling production processes so you

110
00:05:55,110 --> 00:06:00,900
can see here that some of the functions

111
00:05:58,460 --> 00:06:02,969
were manufacturing functions well most

112
00:06:00,900 --> 00:06:05,219
immediately and people just needed to do

113
00:06:02,970 --> 00:06:08,940
something if you take a look at the

114
00:06:05,220 --> 00:06:11,400
video people are saying that all the IT

115
00:06:08,940 --> 00:06:13,140
infrastructure sa piece I know you know

116
00:06:11,400 --> 00:06:17,310
you can use a different software it all

117
00:06:13,140 --> 00:06:19,050
stopped and people just went to the

118
00:06:17,310 --> 00:06:19,750
manual control mode what is manual

119
00:06:19,050 --> 00:06:23,210
control

120
00:06:19,750 --> 00:06:26,090
it's under so the lower geniuses who had

121
00:06:23,210 --> 00:06:28,729
printed out s AP databases on paper and

122
00:06:26,090 --> 00:06:31,340
thank God princess and Belgium the

123
00:06:28,729 --> 00:06:33,469
manager a day before that printed out

124
00:06:31,340 --> 00:06:38,508
all the orders they had to fulfill this

125
00:06:33,469 --> 00:06:41,479
day and use it to do the shipment but he

126
00:06:38,509 --> 00:06:44,120
said that if it took one click ASAP now

127
00:06:41,479 --> 00:06:46,068
I started taking three to four hours you

128
00:06:44,120 --> 00:06:48,830
can remember you can understand how

129
00:06:46,069 --> 00:06:52,689
automation helps you in Germany there

130
00:06:48,830 --> 00:06:56,180
was no access to the s AP system so

131
00:06:52,689 --> 00:06:59,000
16,000 SK used they had in the database

132
00:06:56,180 --> 00:07:01,189
thank God been printed out three months

133
00:06:59,000 --> 00:07:05,029
before that so strange that machine

134
00:07:01,189 --> 00:07:09,860
paper copies did work a lot of employees

135
00:07:05,029 --> 00:07:11,779
had to refocus for instance if there are

136
00:07:09,860 --> 00:07:14,389
marketing people here if an incident

137
00:07:11,779 --> 00:07:17,539
happened in your company maybe you have

138
00:07:14,389 --> 00:07:19,819
to travel around all the offices in this

139
00:07:17,539 --> 00:07:21,620
country from Vladivostok to Moscow with

140
00:07:19,819 --> 00:07:23,690
a flash drive checking the computers

141
00:07:21,620 --> 00:07:26,150
because IT people won't have time for

142
00:07:23,690 --> 00:07:30,650
that so that's exactly what most people

143
00:07:26,150 --> 00:07:34,549
did in France in the UK sales people

144
00:07:30,650 --> 00:07:39,198
would take a ruler and the pencil and

145
00:07:34,550 --> 00:07:42,319
draw schematics took pictures on their

146
00:07:39,199 --> 00:07:48,469
phones and send them over what's up in

147
00:07:42,319 --> 00:07:50,479
facebook also in Denmark they built some

148
00:07:48,469 --> 00:07:54,259
new software to manage their warehouses

149
00:07:50,479 --> 00:07:56,349
in Germany an SI p expert who was at the

150
00:07:54,259 --> 00:08:00,199
factory at that time took control and

151
00:07:56,349 --> 00:08:02,539
restored the functioning of the factory

152
00:08:00,199 --> 00:08:04,539
which was actually quite cool if you ask

153
00:08:02,539 --> 00:08:09,199
me and if you take a look at the people

154
00:08:04,539 --> 00:08:11,419
had anyone had an incident investigation

155
00:08:09,199 --> 00:08:13,580
you understand what it's all about is

156
00:08:11,419 --> 00:08:16,270
sleepless nights about sleepless nights

157
00:08:13,580 --> 00:08:19,729
and I felt that myself

158
00:08:16,270 --> 00:08:23,060
you just sit 24 hours around the clock

159
00:08:19,729 --> 00:08:24,830
working a Thank You hackers we love her

160
00:08:23,060 --> 00:08:25,600
working with you so this was a

161
00:08:24,830 --> 00:08:26,880
cryptolocker

162
00:08:25,600 --> 00:08:32,820
[Music]

163
00:08:26,880 --> 00:08:34,530
who attacks 40 countries if you take a

164
00:08:32,820 --> 00:08:36,630
look to this video in the US and they

165
00:08:34,530 --> 00:08:40,228
started they investigate the incidence

166
00:08:36,630 --> 00:08:42,780
they had just shut down everything it's

167
00:08:40,229 --> 00:08:45,300
Europe the Netherlands France to those

168
00:08:42,780 --> 00:08:49,819
and so on and so forth so what was

169
00:08:45,300 --> 00:08:53,310
actually done the IT network was

170
00:08:49,820 --> 00:08:55,470
attacked by cryptolocker in the

171
00:08:53,310 --> 00:08:58,520
beginning actually when we investigated

172
00:08:55,470 --> 00:09:02,250
it turned out that we had already

173
00:08:58,520 --> 00:09:04,800
encountered this family in January with

174
00:09:02,250 --> 00:09:09,600
it called it got the name of Gaga Locka

175
00:09:04,800 --> 00:09:13,380
Locka gaga so the witness systems were

176
00:09:09,600 --> 00:09:17,280
infected files were in Co encrypted and

177
00:09:13,380 --> 00:09:18,689
then what it also did it locked out a

178
00:09:17,280 --> 00:09:20,780
person changed all the passwords

179
00:09:18,690 --> 00:09:23,190
including local demonstrator and

180
00:09:20,780 --> 00:09:25,980
basically destroyed the computer it

181
00:09:23,190 --> 00:09:28,470
wouldn't allow connecting to it because

182
00:09:25,980 --> 00:09:32,010
on top of everything else it would just

183
00:09:28,470 --> 00:09:34,620
disable the network adapters so you

184
00:09:32,010 --> 00:09:37,319
understand you can't access the computer

185
00:09:34,620 --> 00:09:40,140
in a remote way so all the passwords are

186
00:09:37,320 --> 00:09:46,710
changed the computer is killed so it

187
00:09:40,140 --> 00:09:49,580
tried to post these files and I would

188
00:09:46,710 --> 00:09:54,180
say please write minutes like this and

189
00:09:49,580 --> 00:09:58,110
as I understand perhaps he was really

190
00:09:54,180 --> 00:10:03,780
expecting that to be paid the two months

191
00:09:58,110 --> 00:10:05,970
passed so it's already 21st of May still

192
00:10:03,780 --> 00:10:08,339
a lot some processes are working in

193
00:10:05,970 --> 00:10:10,830
manual mode I checked on their website

194
00:10:08,340 --> 00:10:13,500
but it's a great company a lot people a

195
00:10:10,830 --> 00:10:16,920
lot of people say that the shares a

196
00:10:13,500 --> 00:10:19,530
share price of the company drop after a

197
00:10:16,920 --> 00:10:25,110
hack but I took their graph and I saw

198
00:10:19,530 --> 00:10:28,329
that their stock price went up a bit

199
00:10:25,110 --> 00:10:31,270
just because everybody saw that they did

200
00:10:28,330 --> 00:10:32,830
the incidence management properly so

201
00:10:31,270 --> 00:10:37,060
even up until now

202
00:10:32,830 --> 00:10:40,390
well a part of the operations are run in

203
00:10:37,060 --> 00:10:42,849
the manual way they reported that their

204
00:10:40,390 --> 00:10:44,560
loss was 40 million dollars you know to

205
00:10:42,850 --> 00:10:49,540
get the insurance and they had been

206
00:10:44,560 --> 00:10:53,640
insurance so what I'm leading to what

207
00:10:49,540 --> 00:10:59,980
the hackers did in some way they

208
00:10:53,640 --> 00:11:04,780
penetrated into the network and a lot

209
00:10:59,980 --> 00:11:07,480
the people believe that they use a

210
00:11:04,780 --> 00:11:11,560
simple way to do that like GPO for

211
00:11:07,480 --> 00:11:12,490
instance ad policies we all watch news

212
00:11:11,560 --> 00:11:15,819
now

213
00:11:12,490 --> 00:11:18,340
no but the whole in RDP Microsoft

214
00:11:15,820 --> 00:11:22,390
doesn't explain what kind of hold it is

215
00:11:18,340 --> 00:11:24,340
maybe it was just a trivial RDP hold so

216
00:11:22,390 --> 00:11:27,960
but what they did they penetrated and

217
00:11:24,340 --> 00:11:31,810
then they use the customized malware

218
00:11:27,960 --> 00:11:33,910
Google Locker that was built

219
00:11:31,810 --> 00:11:37,150
specifically for this company and also

220
00:11:33,910 --> 00:11:40,420
it turned out that had lots of Windows

221
00:11:37,150 --> 00:11:42,819
and documented features it just I took a

222
00:11:40,420 --> 00:11:46,150
look NT create section for instance for

223
00:11:42,820 --> 00:11:49,960
me it is documented for some people it

224
00:11:46,150 --> 00:11:54,550
might look undocumented along the

225
00:11:49,960 --> 00:11:56,410
investigation the price of decryption or

226
00:11:54,550 --> 00:12:00,520
was growing so I think time is critical

227
00:11:56,410 --> 00:12:03,160
the speeds of investigation is always

228
00:12:00,520 --> 00:12:06,610
about money because if you're asked to

229
00:12:03,160 --> 00:12:08,560
pay rent a ransom you may ultimately

230
00:12:06,610 --> 00:12:10,270
need to do that so what does the hackers

231
00:12:08,560 --> 00:12:13,420
did they destroyed the data on the

232
00:12:10,270 --> 00:12:15,370
servers and made the entire company to

233
00:12:13,420 --> 00:12:18,640
switch off computers people who are

234
00:12:15,370 --> 00:12:20,290
working from homes they couldn't connect

235
00:12:18,640 --> 00:12:22,689
so they couldn't switch the computer on

236
00:12:20,290 --> 00:12:24,430
because they were fearing the

237
00:12:22,690 --> 00:12:26,290
cryptolocker I think if that computers

238
00:12:24,430 --> 00:12:28,120
12 so what's that

239
00:12:26,290 --> 00:12:30,240
it turned out so that the cloud was very

240
00:12:28,120 --> 00:12:33,600
well

241
00:12:30,240 --> 00:12:38,520
guys still got mail working on office

242
00:12:33,600 --> 00:12:39,420
365 continuing their communication with

243
00:12:38,520 --> 00:12:41,430
the outside world

244
00:12:39,420 --> 00:12:45,240
investors journalists everybody who's

245
00:12:41,430 --> 00:12:47,430
asking they immediately put their web

246
00:12:45,240 --> 00:12:50,100
portal on Microsoft Azure it forwarded

247
00:12:47,430 --> 00:12:51,959
to Microsoft as you see where they did

248
00:12:50,100 --> 00:12:53,790
the basic things they had backups that

249
00:12:51,959 --> 00:12:56,459
was also very good and I'm hoping you

250
00:12:53,790 --> 00:12:59,219
also have backups they didn't pay ransom

251
00:12:56,459 --> 00:13:01,770
that was also a super thing so they

252
00:12:59,220 --> 00:13:03,990
don't invest in the development of such

253
00:13:01,770 --> 00:13:10,410
attacks and they had a lot of print out

254
00:13:03,990 --> 00:13:14,310
printed out data so the shareholders did

255
00:13:10,410 --> 00:13:15,899
not start selling their shares just

256
00:13:14,310 --> 00:13:18,239
because they had full information about

257
00:13:15,899 --> 00:13:21,779
what was happening of course every share

258
00:13:18,240 --> 00:13:23,940
price fell a little bit but I think it

259
00:13:21,779 --> 00:13:27,570
was not significant in terms of security

260
00:13:23,940 --> 00:13:30,060
I like what I like is that the incident

261
00:13:27,570 --> 00:13:35,370
management process was built very well

262
00:13:30,060 --> 00:13:38,010
so a person who was responsible for

263
00:13:35,370 --> 00:13:40,470
managing their factory knew what to do

264
00:13:38,010 --> 00:13:42,870
in such case do you know what to do

265
00:13:40,470 --> 00:13:44,670
should something like this happen to you

266
00:13:42,870 --> 00:13:47,279
this is the first question there are

267
00:13:44,670 --> 00:13:49,760
special games for IT people security

268
00:13:47,279 --> 00:13:52,770
people where we're asking questions

269
00:13:49,760 --> 00:13:55,410
about incidents what your next step they

270
00:13:52,770 --> 00:13:58,529
had it and the security team started

271
00:13:55,410 --> 00:14:01,890
working of course they had a shortage of

272
00:13:58,529 --> 00:14:05,070
resources of people they started using

273
00:14:01,890 --> 00:14:07,290
people who were not supposed to do that

274
00:14:05,070 --> 00:14:09,899
like sales people marketing people and

275
00:14:07,290 --> 00:14:11,640
that was quite cool I think in Russia

276
00:14:09,899 --> 00:14:13,500
the support who would have been even

277
00:14:11,640 --> 00:14:16,949
higher because I believe in collectivism

278
00:14:13,500 --> 00:14:19,770
perhaps so what wasn't that good in

279
00:14:16,950 --> 00:14:22,230
terms of informing at the government

280
00:14:19,770 --> 00:14:24,420
level in no way and as I understand in

281
00:14:22,230 --> 00:14:27,570
this country there is no official

282
00:14:24,420 --> 00:14:29,430
mechanism to notify immediately all

283
00:14:27,570 --> 00:14:32,670
companies you know ad

284
00:14:29,430 --> 00:14:34,260
companies whichever dealing with the

285
00:14:32,670 --> 00:14:37,079
thinnest security there's a problem and

286
00:14:34,260 --> 00:14:38,640
he needs to be investigated I asked a

287
00:14:37,080 --> 00:14:40,560
question to Facebook yesterday nobody

288
00:14:38,640 --> 00:14:42,390
answered I have a lot of colleagues in

289
00:14:40,560 --> 00:14:44,989
security and I would even say it's

290
00:14:42,390 --> 00:14:47,580
either done through personal

291
00:14:44,990 --> 00:14:50,279
communication first you know some person

292
00:14:47,580 --> 00:14:56,730
working at Kaspersky Lab but just to

293
00:14:50,279 --> 00:14:57,149
give out a blank request you can't do

294
00:14:56,730 --> 00:15:01,770
that

295
00:14:57,149 --> 00:15:03,209
and also the ML web and was signed by a

296
00:15:01,770 --> 00:15:04,860
trusted certificate they just read

297
00:15:03,209 --> 00:15:09,029
sister company there were several people

298
00:15:04,860 --> 00:15:12,000
there and they got to the public CA and

299
00:15:09,029 --> 00:15:15,870
got the certification the next problem

300
00:15:12,000 --> 00:15:17,880
that emerged when they found the script

301
00:15:15,870 --> 00:15:20,610
locum there was three of them actually

302
00:15:17,880 --> 00:15:22,529
it turned out that this company had been

303
00:15:20,610 --> 00:15:25,260
recalling certificates for quite a long

304
00:15:22,529 --> 00:15:29,370
time and the next phase was that none of

305
00:15:25,260 --> 00:15:31,920
the vendors was checking certificate if

306
00:15:29,370 --> 00:15:35,660
Achatz recalls you know that if we do

307
00:15:31,920 --> 00:15:38,790
SSL encryption we need to use the CSP

308
00:15:35,660 --> 00:15:41,250
protocol to verify if the certificate

309
00:15:38,790 --> 00:15:44,069
was revoked so we don't need to trust

310
00:15:41,250 --> 00:15:45,959
the certificate we need to check if it

311
00:15:44,070 --> 00:15:48,060
has been revoked it's a very important

312
00:15:45,959 --> 00:15:49,859
component that a lot of people forget

313
00:15:48,060 --> 00:15:54,510
about it then local gauger

314
00:15:49,860 --> 00:16:00,270
each other longer with tampering unless

315
00:15:54,510 --> 00:16:01,860
you have protected your products against

316
00:16:00,270 --> 00:16:03,480
somebody just shutting down a product

317
00:16:01,860 --> 00:16:08,490
and what do you need those products so

318
00:16:03,480 --> 00:16:11,580
low just shut down your security systems

319
00:16:08,490 --> 00:16:14,910
and kept working getting the

320
00:16:11,580 --> 00:16:17,850
administrator permissions was actually

321
00:16:14,910 --> 00:16:19,829
quite a clear action that could be

322
00:16:17,850 --> 00:16:22,410
threatened which meant that nobody was

323
00:16:19,829 --> 00:16:25,319
you know washing was happening in the

324
00:16:22,410 --> 00:16:28,459
one also there's a statements that were

325
00:16:25,320 --> 00:16:30,630
made about sandboxes that I need to make

326
00:16:28,459 --> 00:16:33,239
actually this company and other

327
00:16:30,630 --> 00:16:35,380
companies are being broken by standard

328
00:16:33,240 --> 00:16:38,589
utilities

329
00:16:35,380 --> 00:16:40,389
if you ascend your power shelf into the

330
00:16:38,589 --> 00:16:46,329
sandbox it's not going to become better

331
00:16:40,389 --> 00:16:49,300
or worse if you run some data in the

332
00:16:46,329 --> 00:16:51,130
command line and run a scheduler to

333
00:16:49,300 --> 00:16:52,540
start your program so what can the

334
00:16:51,130 --> 00:16:54,699
sandbox do for you

335
00:16:52,540 --> 00:16:56,560
so therefore what's happening is

336
00:16:54,699 --> 00:16:58,120
happening over the help of standard

337
00:16:56,560 --> 00:17:01,719
utilities and you need to understand

338
00:16:58,120 --> 00:17:05,039
this also there's been a lot of

339
00:17:01,720 --> 00:17:08,260
discussions in the past five years about

340
00:17:05,039 --> 00:17:09,970
protecting SCADA and by the way in this

341
00:17:08,260 --> 00:17:13,650
company everything was good about scott

342
00:17:09,970 --> 00:17:17,589
nervous system but this hack was

343
00:17:13,650 --> 00:17:19,809
targeted at the irregular IT network and

344
00:17:17,589 --> 00:17:24,220
actually a lot of people forget that

345
00:17:19,809 --> 00:17:26,829
before you start learning exe protocol

346
00:17:24,220 --> 00:17:31,120
Siemens protocols you first need to get

347
00:17:26,829 --> 00:17:33,490
your regular land protected because it

348
00:17:31,120 --> 00:17:35,860
is the first thing to be broken if it's

349
00:17:33,490 --> 00:17:39,070
not protected in service okay they

350
00:17:35,860 --> 00:17:42,039
started I was expecting that you know

351
00:17:39,070 --> 00:17:43,658
hackers spent three weeks in the company

352
00:17:42,039 --> 00:17:46,600
as it turned out and over these three

353
00:17:43,659 --> 00:17:49,480
weeks there were plenty of opportunities

354
00:17:46,600 --> 00:17:53,320
to at least see something there but

355
00:17:49,480 --> 00:17:55,929
nobody noticed this has been the

356
00:17:53,320 --> 00:17:58,689
introduction actually my purpose today

357
00:17:55,929 --> 00:18:01,600
was to talk about the concept that we

358
00:17:58,690 --> 00:18:05,440
proposed for incident investigation look

359
00:18:01,600 --> 00:18:07,809
on with cortex XDR now I'd like to move

360
00:18:05,440 --> 00:18:10,929
on to three cases this these will be

361
00:18:07,809 --> 00:18:13,149
practical cases how we investigate

362
00:18:10,929 --> 00:18:17,820
incidents so we saw a problem and then

363
00:18:13,150 --> 00:18:17,820
how to wind

364
00:18:19,130 --> 00:18:28,760
cause and effect change then I show you

365
00:18:23,420 --> 00:18:30,590
how we do a threat hunting and also in

366
00:18:28,760 --> 00:18:33,290
the third case I'll show you how it's

367
00:18:30,590 --> 00:18:36,909
connected to the information that we get

368
00:18:33,290 --> 00:18:42,980
from the network so let's now talk about

369
00:18:36,910 --> 00:18:46,430
the specific things so we are is quite

370
00:18:42,980 --> 00:18:48,350
normally in large companies lots of

371
00:18:46,430 --> 00:18:53,840
security tools in the system

372
00:18:48,350 --> 00:18:57,110
somebody uses EDR other people use user

373
00:18:53,840 --> 00:18:59,899
entity behavior analytics UVA other

374
00:18:57,110 --> 00:19:03,530
people use cloud security of those have

375
00:18:59,900 --> 00:19:06,740
office 365 file shares we check that of

376
00:19:03,530 --> 00:19:08,860
those so what I'm driving there are lots

377
00:19:06,740 --> 00:19:11,800
of events millions of events however

378
00:19:08,860 --> 00:19:15,469
analysts manually collect this data

379
00:19:11,800 --> 00:19:18,730
correlate them between themselves and

380
00:19:15,470 --> 00:19:21,050
see what they can do that so quite often

381
00:19:18,730 --> 00:19:24,350
collecting data from everything and

382
00:19:21,050 --> 00:19:27,590
reaching it takes time and we need to

383
00:19:24,350 --> 00:19:30,260
shorten this time so it's very important

384
00:19:27,590 --> 00:19:31,669
to explain what cortex XDR is it's in

385
00:19:30,260 --> 00:19:35,150
your world I understand it's a buzzword

386
00:19:31,670 --> 00:19:38,560
I even built as a cloud for you I hope

387
00:19:35,150 --> 00:19:43,370
everybody understands all the words here

388
00:19:38,560 --> 00:19:45,860
and so axiom is one of the new ones that

389
00:19:43,370 --> 00:19:49,550
I want you to recognize from known in

390
00:19:45,860 --> 00:19:52,610
Syria where X means all sources of data

391
00:19:49,550 --> 00:19:54,290
house network and the clouds we just

392
00:19:52,610 --> 00:19:56,659
brought these three data sources

393
00:19:54,290 --> 00:19:59,810
together so what happens we have

394
00:19:56,660 --> 00:20:02,900
products with called network traffic now

395
00:19:59,810 --> 00:20:06,679
sentier we have a product called hey you

396
00:20:02,900 --> 00:20:09,860
EBA when products EDR EDR products

397
00:20:06,680 --> 00:20:12,350
endpoints and detection and response we

398
00:20:09,860 --> 00:20:17,240
have some other products and as a

399
00:20:12,350 --> 00:20:19,129
company we towards all these products we

400
00:20:17,240 --> 00:20:21,710
had some of these products of our own

401
00:20:19,130 --> 00:20:23,270
others we acquired and now we have all

402
00:20:21,710 --> 00:20:26,870
these products and you can do the same

403
00:20:23,270 --> 00:20:30,500
you can just buy it all and use the

404
00:20:26,870 --> 00:20:32,600
so it's we got from that we are known to

405
00:20:30,500 --> 00:20:35,750
position to collect data from three

406
00:20:32,600 --> 00:20:38,750
different sources the network the house

407
00:20:35,750 --> 00:20:41,630
and the clouds so why do we want that in

408
00:20:38,750 --> 00:20:45,679
order to bring all logs in one place

409
00:20:41,630 --> 00:20:53,419
which we call data like the quarters

410
00:20:45,679 --> 00:20:56,179
data like is unified database where we

411
00:20:53,419 --> 00:20:58,669
collect data for long-term storage and

412
00:20:56,179 --> 00:21:01,659
for quick access and the database is

413
00:20:58,669 --> 00:21:07,519
built incorrectly and of course we also

414
00:21:01,659 --> 00:21:12,710
collect wild file so the disparity that

415
00:21:07,519 --> 00:21:16,730
we had was gotten rid our business

416
00:21:12,710 --> 00:21:18,559
products and cortex yeah can use all the

417
00:21:16,730 --> 00:21:21,139
data collected according to data like

418
00:21:18,559 --> 00:21:25,370
actually we also provide an API for

419
00:21:21,139 --> 00:21:29,209
other companies and we just call on

420
00:21:25,370 --> 00:21:31,250
everyone to use it because it's a huge

421
00:21:29,210 --> 00:21:33,500
resource to use the statistical

422
00:21:31,250 --> 00:21:39,289
information for your company we have a

423
00:21:33,500 --> 00:21:42,889
four cell and if you go there you'll see

424
00:21:39,289 --> 00:21:45,620
this court other companies already do cm

425
00:21:42,889 --> 00:21:48,199
behavioral analytics there are other

426
00:21:45,620 --> 00:21:50,928
types of statistics and analysis and you

427
00:21:48,200 --> 00:21:53,779
can buy but in terms of our products

428
00:21:50,929 --> 00:21:56,509
cortex XDR works in exactly the same way

429
00:21:53,779 --> 00:21:59,570
it uses the sources let's start with a

430
00:21:56,509 --> 00:22:04,299
simple source that we've all got used to

431
00:21:59,570 --> 00:22:06,529
the workstations here your workstations

432
00:22:04,299 --> 00:22:08,240
always see something happening there

433
00:22:06,529 --> 00:22:11,029
your people are always doing something

434
00:22:08,240 --> 00:22:14,059
something there in terms of events it's

435
00:22:11,029 --> 00:22:17,690
about creating events you know updating

436
00:22:14,059 --> 00:22:22,000
registries registry some threat level

437
00:22:17,690 --> 00:22:25,399
data it all can be logged and by the way

438
00:22:22,000 --> 00:22:28,789
mocking people asked me to to remind you

439
00:22:25,399 --> 00:22:30,649
that these oisin needs to be filled out

440
00:22:28,789 --> 00:22:33,700
and it's not just for the sake of

441
00:22:30,649 --> 00:22:36,639
filling of the sheets you'll be able to

442
00:22:33,700 --> 00:22:40,420
yet prizes at the end so my colleagues

443
00:22:36,640 --> 00:22:44,560
Nastya is organizing that in terms of

444
00:22:40,420 --> 00:22:46,810
cortex atria let me come back we have an

445
00:22:44,560 --> 00:22:49,659
opportunity of collecting all these

446
00:22:46,810 --> 00:22:53,110
millions of events in a single database

447
00:22:49,660 --> 00:22:55,210
cortex data Lake and based on that to

448
00:22:53,110 --> 00:22:57,760
get the information of what specifically

449
00:22:55,210 --> 00:23:00,910
happened in a specific case then we can

450
00:22:57,760 --> 00:23:03,370
isolate it if we identified at the

451
00:23:00,910 --> 00:23:07,840
product we can build our process

452
00:23:03,370 --> 00:23:12,370
blacklist and most interestingly you can

453
00:23:07,840 --> 00:23:15,939
create behavior rules we call them be

454
00:23:12,370 --> 00:23:19,139
locks you can do these B locks if you

455
00:23:15,940 --> 00:23:23,350
have based on even your own ideas

456
00:23:19,140 --> 00:23:25,330
understanding how people hack you can

457
00:23:23,350 --> 00:23:31,570
get quite a lot of such knowledge here

458
00:23:25,330 --> 00:23:34,330
at PhD actually just listening to how

459
00:23:31,570 --> 00:23:37,000
you're being hacked you can record it as

460
00:23:34,330 --> 00:23:41,320
a behavior rule I'll tell you more about

461
00:23:37,000 --> 00:23:43,330
that in a minute so what the clouds and

462
00:23:41,320 --> 00:23:45,220
the network use there are such things as

463
00:23:43,330 --> 00:23:47,919
rootkits it's a piece of software that

464
00:23:45,220 --> 00:23:53,320
is hiding from you so that you shouldn't

465
00:23:47,920 --> 00:23:57,130
see any networking activity or for

466
00:23:53,320 --> 00:24:00,280
instance say you take a look at so the

467
00:23:57,130 --> 00:24:03,280
process solis sysinternals have as

468
00:24:00,280 --> 00:24:10,570
should tool for that but you will see

469
00:24:03,280 --> 00:24:15,639
them so no you you can check firewall

470
00:24:10,570 --> 00:24:18,280
and netstat you can see some connections

471
00:24:15,640 --> 00:24:22,690
that exist according to one source and

472
00:24:18,280 --> 00:24:24,760
don't according to the other so this is

473
00:24:22,690 --> 00:24:27,130
actually a very good indication as a

474
00:24:24,760 --> 00:24:29,650
rootkit by just comparing these two

475
00:24:27,130 --> 00:24:31,050
things we were to continue look there's

476
00:24:29,650 --> 00:24:34,210
some software running on the software

477
00:24:31,050 --> 00:24:36,310
that is hiding from you making some

478
00:24:34,210 --> 00:24:38,700
connections in the LC it so adding the

479
00:24:36,310 --> 00:24:42,210
network improves

480
00:24:38,700 --> 00:24:43,740
security considerably another topic a

481
00:24:42,210 --> 00:24:45,450
lot of people have gone into the cloud

482
00:24:43,740 --> 00:24:46,350
people are posting files you can't

483
00:24:45,450 --> 00:24:48,510
control that

484
00:24:46,350 --> 00:24:51,090
because you don't even know if they've

485
00:24:48,510 --> 00:24:55,230
aside this file is a public or private

486
00:24:51,090 --> 00:24:58,530
or the other one other way around if if

487
00:24:55,230 --> 00:25:02,250
some piece of malware has been posted on

488
00:24:58,530 --> 00:25:05,510
the Google Drive so being able to

489
00:25:02,250 --> 00:25:09,600
correlate all that you can build a chain

490
00:25:05,510 --> 00:25:13,410
so an incident that's been created you

491
00:25:09,600 --> 00:25:17,610
need it not only to identify but also to

492
00:25:13,410 --> 00:25:21,030
investigate how started to respond to

493
00:25:17,610 --> 00:25:23,459
block something and improve some rules

494
00:25:21,030 --> 00:25:25,020
that you have in place in terms of

495
00:25:23,460 --> 00:25:26,910
approaches there were old ones and the

496
00:25:25,020 --> 00:25:29,970
new ones our approach is to analyze

497
00:25:26,910 --> 00:25:30,800
let's say the workstations what do we

498
00:25:29,970 --> 00:25:34,890
use for that

499
00:25:30,800 --> 00:25:36,540
sensors in a very basic way sensors

500
00:25:34,890 --> 00:25:38,940
installed in the workstations in the

501
00:25:36,540 --> 00:25:41,340
network and so on we have a product so

502
00:25:38,940 --> 00:25:44,480
called traps for that I'll tell you

503
00:25:41,340 --> 00:25:47,639
about it why we use it you know that

504
00:25:44,480 --> 00:25:50,760
I'll be using two terms today a virus

505
00:25:47,640 --> 00:25:53,790
and exploit let me call everything a

506
00:25:50,760 --> 00:25:57,690
virus because you know different Krypton

507
00:25:53,790 --> 00:25:59,700
losses rootkits Trojans ransomware it

508
00:25:57,690 --> 00:26:02,250
takes so much time let me call all of

509
00:25:59,700 --> 00:26:03,660
these virus the most important thing

510
00:26:02,250 --> 00:26:08,220
that you understand the virus in my

511
00:26:03,660 --> 00:26:11,610
understanding is malware exploit is

512
00:26:08,220 --> 00:26:13,740
executive or codes that's inserted in

513
00:26:11,610 --> 00:26:16,740
some other file which is not executive

514
00:26:13,740 --> 00:26:22,050
in most cases like a document a flash

515
00:26:16,740 --> 00:26:25,760
video a PDF so I'll be using these two

516
00:26:22,050 --> 00:26:28,470
terms that's that's been a clarification

517
00:26:25,760 --> 00:26:31,950
as I've already said the very very big

518
00:26:28,470 --> 00:26:35,640
the kill chain where your network is

519
00:26:31,950 --> 00:26:43,200
explored then some malware is built than

520
00:26:35,640 --> 00:26:50,070
is delivered then it's started then it

521
00:26:43,200 --> 00:26:52,670
can somehow distribute then it gets into

522
00:26:50,070 --> 00:26:57,870
a connection with this control center

523
00:26:52,670 --> 00:27:01,140
offering the control capabilities to the

524
00:26:57,870 --> 00:27:04,620
bad guy and there's this at lateral

525
00:27:01,140 --> 00:27:08,390
movements well after having gotten

526
00:27:04,620 --> 00:27:12,780
control of one computer you gradually

527
00:27:08,390 --> 00:27:14,700
get access to others so having personal

528
00:27:12,780 --> 00:27:19,050
firewalls even in an enterprise network

529
00:27:14,700 --> 00:27:26,520
is a must and then people start doing

530
00:27:19,050 --> 00:27:30,830
what they had done it all for malware is

531
00:27:26,520 --> 00:27:35,400
being used in order to connect to the

532
00:27:30,830 --> 00:27:45,780
control set exploits are used at the

533
00:27:35,400 --> 00:27:50,340
moment of connecting to the network and

534
00:27:45,780 --> 00:27:52,700
perhaps is a product that locks exploits

535
00:27:50,340 --> 00:27:58,220
know then unknown and also blocks

536
00:27:52,700 --> 00:27:58,220
malware to viruses in terms of

537
00:27:59,210 --> 00:28:10,320
vulnerabilities we now have millions of

538
00:28:02,630 --> 00:28:13,170
malware and in a year we have fifteen

539
00:28:10,320 --> 00:28:15,000
thousand twelve thousand vulnerabilities

540
00:28:13,170 --> 00:28:17,520
oh by the way how do you know how do you

541
00:28:15,000 --> 00:28:19,950
think how many messages about four

542
00:28:17,520 --> 00:28:25,710
abilities we receive in our labs every

543
00:28:19,950 --> 00:28:28,140
day an idea forty well the order of

544
00:28:25,710 --> 00:28:32,040
magnitude is correct our count is eighty

545
00:28:28,140 --> 00:28:34,470
eight zero well several dozen several

546
00:28:32,040 --> 00:28:35,740
dozen of course it's average and it's

547
00:28:34,470 --> 00:28:40,020
quite a lot

548
00:28:35,740 --> 00:28:42,760
in terms of updates I understand that

549
00:28:40,020 --> 00:28:44,799
security people talk about that and

550
00:28:42,760 --> 00:28:47,309
everybody's is sick and tired of them

551
00:28:44,799 --> 00:28:51,570
about this information because updates

552
00:28:47,309 --> 00:28:54,940
you know shut down our services and

553
00:28:51,570 --> 00:28:57,668
restarting a route because you just

554
00:28:54,940 --> 00:29:01,000
found their whole Hindu VPNs may bring a

555
00:28:57,669 --> 00:29:03,429
problem so the problem is clear there

556
00:29:01,000 --> 00:29:07,240
are other abilities and so on however it

557
00:29:03,429 --> 00:29:09,429
turns out that the methods of operation

558
00:29:07,240 --> 00:29:12,130
operational operating systems and

559
00:29:09,429 --> 00:29:13,179
software they are finite and there are

560
00:29:12,130 --> 00:29:16,240
hundreds of them

561
00:29:13,179 --> 00:29:18,190
however our researchers have calculated

562
00:29:16,240 --> 00:29:21,580
that for Windows at the right hundred

563
00:29:18,190 --> 00:29:24,789
and thirteen methods of operation what

564
00:29:21,580 --> 00:29:27,279
does that mean that that means that if

565
00:29:24,789 --> 00:29:29,520
you'd stole our product traps then it

566
00:29:27,279 --> 00:29:32,470
will cover all the methods of operation

567
00:29:29,520 --> 00:29:36,429
and so we'll install a trap it's just

568
00:29:32,470 --> 00:29:39,390
called that traps and so if one of the

569
00:29:36,429 --> 00:29:42,970
several millions several million of

570
00:29:39,390 --> 00:29:46,059
malware and if for example some hacker

571
00:29:42,970 --> 00:29:49,659
decides to use this technique or method

572
00:29:46,059 --> 00:29:51,820
it will get trapped and statistically

573
00:29:49,659 --> 00:29:54,730
widows is protected you have to use at

574
00:29:51,820 --> 00:29:57,730
least three techniques at the same time

575
00:29:54,730 --> 00:30:04,330
so Windows is protected to a certain

576
00:29:57,730 --> 00:30:06,789
degree but in order to work around these

577
00:30:04,330 --> 00:30:09,340
they have to use a certain set of

578
00:30:06,789 --> 00:30:12,700
techniques of the traps you just wait

579
00:30:09,340 --> 00:30:14,080
they don't need any of these traps don't

580
00:30:12,700 --> 00:30:16,899
need any memory of the don't any

581
00:30:14,080 --> 00:30:20,399
processes however even without any

582
00:30:16,899 --> 00:30:27,699
updates a trap so will block the attacks

583
00:30:20,399 --> 00:30:30,189
quite effectively so you can you may not

584
00:30:27,700 --> 00:30:35,169
update some of their upgrade some of

585
00:30:30,190 --> 00:30:37,240
their computers and it walks some types

586
00:30:35,169 --> 00:30:39,580
of attacks quite efficiently and I'd

587
00:30:37,240 --> 00:30:42,250
like to stress that it does this without

588
00:30:39,580 --> 00:30:44,529
the new signature it just waits it uses

589
00:30:42,250 --> 00:30:44,850
the knowledge about the technology it

590
00:30:44,529 --> 00:30:46,710
does

591
00:30:44,850 --> 00:30:48,539
have to have any signature it doesn't

592
00:30:46,710 --> 00:30:51,289
need to be updated it doesn't need to

593
00:30:48,539 --> 00:30:57,000
have any prior knowledge about the

594
00:30:51,289 --> 00:30:59,580
vulnerabilities we have tests of people

595
00:30:57,000 --> 00:31:02,070
in our country like it and we have

596
00:30:59,580 --> 00:31:04,799
monitoring of different protection

597
00:31:02,070 --> 00:31:07,168
methodologies we have text tested it and

598
00:31:04,799 --> 00:31:14,429
we get quite high scores speak about

599
00:31:07,169 --> 00:31:17,190
malware well traps uses a sandbox we can

600
00:31:14,429 --> 00:31:21,389
do traffic profiling we can do code

601
00:31:17,190 --> 00:31:26,820
dynamic analysis of code static analysis

602
00:31:21,389 --> 00:31:30,840
machine learning and dynamic analysis of

603
00:31:26,820 --> 00:31:32,820
an ax cry was caught quite trivially

604
00:31:30,840 --> 00:31:37,309
using machine learning all crypt

605
00:31:32,820 --> 00:31:40,019
Walker's and caught by behavioral

606
00:31:37,309 --> 00:31:40,740
apprentice and we also have a better

607
00:31:40,019 --> 00:31:45,809
catalytics

608
00:31:40,740 --> 00:31:50,100
fair metal analysis hackers try will

609
00:31:45,809 --> 00:31:58,799
learn how to code a sidestep sandboxes

610
00:31:50,100 --> 00:32:02,129
and we also find that we try to deal

611
00:31:58,799 --> 00:32:05,940
with all sorts of malware in order to

612
00:32:02,129 --> 00:32:10,110
make sure that our product can service

613
00:32:05,940 --> 00:32:12,779
the events and to send them to X 0 we

614
00:32:10,110 --> 00:32:15,120
had the sector company probably heard

615
00:32:12,779 --> 00:32:17,460
about it it was two and three this

616
00:32:15,120 --> 00:32:20,729
function the the range of functions that

617
00:32:17,460 --> 00:32:23,370
are performed Rosetta 2x er it creates

618
00:32:20,730 --> 00:32:27,590
and stops processes it changes a

619
00:32:23,370 --> 00:32:30,739
register it controls the loading of

620
00:32:27,590 --> 00:32:33,959
images so all this information is needed

621
00:32:30,740 --> 00:32:39,809
to everybody to be able to incident

622
00:32:33,960 --> 00:32:43,270
investigation and I can't go back to my

623
00:32:39,809 --> 00:32:46,428
previous slides if you don't log

624
00:32:43,270 --> 00:32:48,929
[Music]

625
00:32:46,429 --> 00:32:51,690
as we discussed before

626
00:32:48,929 --> 00:32:55,830
what do you need to do for example there

627
00:32:51,690 --> 00:32:58,080
is an incident and you have to you have

628
00:32:55,830 --> 00:33:00,500
to investigate it if you don't have any

629
00:32:58,080 --> 00:33:03,418
log so how can you do an investigation

630
00:33:00,500 --> 00:33:05,399
so what I'm getting at is that you have

631
00:33:03,419 --> 00:33:07,320
to get ready for an attack you can't

632
00:33:05,399 --> 00:33:08,969
just start an investigation if you don't

633
00:33:07,320 --> 00:33:12,840
have any data to do this investigation

634
00:33:08,970 --> 00:33:16,350
on very often very often these logs even

635
00:33:12,840 --> 00:33:23,178
if they are kept they get erased so you

636
00:33:16,350 --> 00:33:26,519
have to protect them too of course we

637
00:33:23,179 --> 00:33:28,409
collect all the data in the common

638
00:33:26,519 --> 00:33:30,299
database which is called for this data

639
00:33:28,409 --> 00:33:32,340
collector it allows you to automatically

640
00:33:30,299 --> 00:33:34,769
detect attacks you get a list of attacks

641
00:33:32,340 --> 00:33:38,000
I'm gonna show it to you it speeds up

642
00:33:34,769 --> 00:33:41,460
the incidence response incident

643
00:33:38,000 --> 00:33:45,000
management it runs all the correlations

644
00:33:41,460 --> 00:33:47,549
and stage with investigation presents'

645
00:33:45,000 --> 00:33:50,730
to use this information in a human

646
00:33:47,549 --> 00:33:52,980
readable format and then post you

647
00:33:50,730 --> 00:33:54,360
can connect to computers you can send

648
00:33:52,980 --> 00:33:56,610
all sorts of commands I'm gonna share

649
00:33:54,360 --> 00:33:59,699
with you so now paradigm is pretty

650
00:33:56,610 --> 00:34:01,769
simple we collect all the information

651
00:33:59,700 --> 00:34:04,950
from the network from cost so we have a

652
00:34:01,769 --> 00:34:08,760
firewall everybody knows this we have

653
00:34:04,950 --> 00:34:11,070
cloud protect perch evident and other

654
00:34:08,760 --> 00:34:13,320
products that we have several global

655
00:34:11,070 --> 00:34:17,070
protect our clients with protection of

656
00:34:13,320 --> 00:34:18,780
remote remote office eccentric cloud

657
00:34:17,070 --> 00:34:22,919
service and not going to go into that

658
00:34:18,780 --> 00:34:26,940
now so we take all of this data where

659
00:34:22,918 --> 00:34:30,000
lies it we try to see if these are

660
00:34:26,940 --> 00:34:31,859
operating system events things are

661
00:34:30,000 --> 00:34:37,050
related to applications to what

662
00:34:31,859 --> 00:34:40,409
applications what each staff does and we

663
00:34:37,050 --> 00:34:42,240
also monitor or keep track of things

664
00:34:40,409 --> 00:34:45,830
that are not computer latest Rick

665
00:34:42,239 --> 00:34:49,969
straight away have you heard about

666
00:34:45,830 --> 00:34:51,949
pakkun a chemical factory through a

667
00:34:49,969 --> 00:34:53,330
coffee machine I'm gonna tell you the

668
00:34:51,949 --> 00:34:56,600
story okay

669
00:34:53,330 --> 00:35:00,290
they were guys they were bored they were

670
00:34:56,600 --> 00:35:02,270
probably doing some night shift and they

671
00:35:00,290 --> 00:35:05,180
ordered a coffee machine the coffee

672
00:35:02,270 --> 00:35:09,770
machine was installed in their shift

673
00:35:05,180 --> 00:35:13,040
room and then and then the coffee

674
00:35:09,770 --> 00:35:15,080
machine asked for Wi-Fi connection the

675
00:35:13,040 --> 00:35:18,380
coffee machine was connected to the

676
00:35:15,080 --> 00:35:21,440
local Wi-Fi router and this router was

677
00:35:18,380 --> 00:35:24,710
of course connected to the SCADA system

678
00:35:21,440 --> 00:35:27,950
but these guys were lucky because there

679
00:35:24,710 --> 00:35:31,970
was a well quote-unquote there was an

680
00:35:27,950 --> 00:35:34,040
epidemic of what a try and I remember

681
00:35:31,970 --> 00:35:36,980
this was a very funny time I remember

682
00:35:34,040 --> 00:35:40,400
getting calls about how we get protected

683
00:35:36,980 --> 00:35:46,370
if we never thought about protection so

684
00:35:40,400 --> 00:35:49,850
these were very funny this was a very

685
00:35:46,370 --> 00:35:53,240
funny weekend so what a crimes I saw the

686
00:35:49,850 --> 00:35:57,020
coffee machine and you probably remember

687
00:35:53,240 --> 00:35:59,870
this funny screen pay this ransom but

688
00:35:57,020 --> 00:36:01,490
this all started with a bunch of guys

689
00:35:59,870 --> 00:36:02,779
buying a coffee machine just because

690
00:36:01,490 --> 00:36:07,819
they were bored and they were doing a

691
00:36:02,780 --> 00:36:11,960
night shift so this is very important to

692
00:36:07,820 --> 00:36:17,810
monitor and get protected against so I'm

693
00:36:11,960 --> 00:36:21,050
getting I'm getting at this you need to

694
00:36:17,810 --> 00:36:24,220
create this structure and the structure

695
00:36:21,050 --> 00:36:27,920
allows you to figure out to understand

696
00:36:24,220 --> 00:36:32,299
where things come from so you do the

697
00:36:27,920 --> 00:36:34,490
one-click investigation you watch the

698
00:36:32,300 --> 00:36:37,810
entire sequence of events you analyze

699
00:36:34,490 --> 00:36:42,350
the concept the context unrelated to

700
00:36:37,810 --> 00:36:45,770
specific events we also consider we also

701
00:36:42,350 --> 00:36:48,830
consider accompanying behaviors related

702
00:36:45,770 --> 00:36:51,750
to certain applications so it also do

703
00:36:48,830 --> 00:36:54,299
else to do threat intelligence

704
00:36:51,750 --> 00:36:57,690
it also it is also said it is also

705
00:36:54,300 --> 00:37:00,540
important to use networking sensors why

706
00:36:57,690 --> 00:37:03,000
because they give you a lot of

707
00:37:00,540 --> 00:37:04,310
information that you just can't see on

708
00:37:03,000 --> 00:37:08,330
workstations

709
00:37:04,310 --> 00:37:12,500
moreover sensors must be selected

710
00:37:08,330 --> 00:37:15,540
correctly you need to select the right

711
00:37:12,500 --> 00:37:18,150
sensor let me tell you my favorite

712
00:37:15,540 --> 00:37:23,460
examples about firewalls if you take a

713
00:37:18,150 --> 00:37:26,160
normal there is there's this five tuple

714
00:37:23,460 --> 00:37:28,890
in five table term so on the firewall

715
00:37:26,160 --> 00:37:31,830
you get information and the dress and

716
00:37:28,890 --> 00:37:34,950
port numbers also the name of the

717
00:37:31,830 --> 00:37:40,680
protocol it is disappear or is it UDP

718
00:37:34,950 --> 00:37:43,439
and the destination destination so can

719
00:37:40,680 --> 00:37:46,290
you take this information and tell if

720
00:37:43,440 --> 00:37:48,570
it's an incident or an I camp but if you

721
00:37:46,290 --> 00:37:52,590
look if you look at the same TCP

722
00:37:48,570 --> 00:37:55,530
connection in another product in jail

723
00:37:52,590 --> 00:37:57,960
for volt for example we can see that

724
00:37:55,530 --> 00:38:00,119
this is Canada based on the IP address

725
00:37:57,960 --> 00:38:03,030
we also have the function called user ID

726
00:38:00,119 --> 00:38:07,619
so we can take this IP address to

727
00:38:03,030 --> 00:38:14,700
determine who the user is and in what

728
00:38:07,619 --> 00:38:17,940
group this user is then of course you

729
00:38:14,700 --> 00:38:20,879
can you can guess that if it's GCP four

730
00:38:17,940 --> 00:38:25,600
four three then this is SSL if it's SSL

731
00:38:20,880 --> 00:38:30,420
we can decrypt SSL and see a

732
00:38:25,600 --> 00:38:35,220
this looks like a file share activity

733
00:38:30,420 --> 00:38:38,590
there is another topic called the hl8

734
00:38:35,220 --> 00:38:43,870
there are very many applications working

735
00:38:38,590 --> 00:38:45,670
over HTTP and we can see that this HTTP

736
00:38:43,870 --> 00:38:49,270
was used for SlideShare and SlideShare

737
00:38:45,670 --> 00:38:51,430
has some low-level functions such as

738
00:38:49,270 --> 00:38:57,100
SlideShare oblivion and we see the files

739
00:38:51,430 --> 00:38:59,830
the firewall sees the files so we can we

740
00:38:57,100 --> 00:39:03,390
can even look for the content of this

741
00:38:59,830 --> 00:39:07,000
PowerPoint slide shake slide deck and

742
00:39:03,390 --> 00:39:09,310
find the word confidential so that means

743
00:39:07,000 --> 00:39:15,480
that somebody shared that confidential

744
00:39:09,310 --> 00:39:18,880
information if you google the world

745
00:39:15,480 --> 00:39:22,300
proprietary confidential and so on and

746
00:39:18,880 --> 00:39:24,100
so forth you'll find a huge amount of

747
00:39:22,300 --> 00:39:29,350
documents you'll you'll get a lot of

748
00:39:24,100 --> 00:39:32,410
hits in Google so enjoy firewalls a

749
00:39:29,350 --> 00:39:35,620
great source that enriches your data and

750
00:39:32,410 --> 00:39:42,520
makes your threat response much more

751
00:39:35,620 --> 00:39:45,700
efficient ng firewall shows eternal sent

752
00:39:42,520 --> 00:39:51,070
TCP and other asset this is a paper of

753
00:39:45,700 --> 00:39:54,609
packets in terms of the North Fargo of

754
00:39:51,070 --> 00:39:59,890
the scissors 40:53 connection it has

755
00:39:54,610 --> 00:40:02,290
some DNS requests and in d-tix if you'll

756
00:39:59,890 --> 00:40:06,069
we see that so the text is a little bit

757
00:40:02,290 --> 00:40:08,529
strange it's it is encrypted this is an

758
00:40:06,070 --> 00:40:11,920
implementation of the first tunnel and

759
00:40:08,530 --> 00:40:16,970
there are many such tunnels

760
00:40:11,920 --> 00:40:18,829
those who have normal firewalls they see

761
00:40:16,970 --> 00:40:22,459
that okay we have a lot of tunnels and

762
00:40:18,829 --> 00:40:25,539
they're none the wiser but if but our

763
00:40:22,460 --> 00:40:29,210
firewall sees this and provides you

764
00:40:25,539 --> 00:40:32,569
additional insight and another important

765
00:40:29,210 --> 00:40:35,960
thing that I'd like to stress is I'd

766
00:40:32,569 --> 00:40:39,308
like to encourage you to decrypt SSL who

767
00:40:35,960 --> 00:40:42,609
does SSL decryption in your parameter

768
00:40:39,309 --> 00:40:42,609
here's the deal

769
00:40:42,670 --> 00:40:50,630
70 to 80% of your encrypted traffic is

770
00:40:47,720 --> 00:40:53,029
probably written by Dunnigan and it

771
00:40:50,630 --> 00:40:55,999
checks this parts of this part of the

772
00:40:53,029 --> 00:41:02,630
traffic I don't know if it's good or bad

773
00:40:55,999 --> 00:41:10,069
for you but I believe that if you

774
00:41:02,630 --> 00:41:13,069
download malware on hosts that's

775
00:41:10,069 --> 00:41:14,690
possible so the question is we have been

776
00:41:13,069 --> 00:41:17,269
disk so the thing is we have a

777
00:41:14,690 --> 00:41:22,700
discussion for five years now originally

778
00:41:17,269 --> 00:41:26,479
we only we only a used SSL in 50% of the

779
00:41:22,700 --> 00:41:28,609
cases but now we use it in 80% of the

780
00:41:26,479 --> 00:41:34,669
cases but that's not enough even Google

781
00:41:28,609 --> 00:41:38,390
search uses SSL and just as a small plug

782
00:41:34,670 --> 00:41:43,150
used right and krypter assesses for not

783
00:41:38,390 --> 00:41:46,279
chances getting back to our cortex

784
00:41:43,150 --> 00:41:49,790
so after collecting all the data from

785
00:41:46,280 --> 00:41:52,070
forces from the network from the cloud

786
00:41:49,790 --> 00:41:54,860
we can go through the entire chain to

787
00:41:52,070 --> 00:41:56,750
attend so we can we can reconstruct what

788
00:41:54,860 --> 00:42:01,310
has happened for example we can see that

789
00:41:56,750 --> 00:42:03,230
the attacker that the attacker performed

790
00:42:01,310 --> 00:42:06,340
this certain set of actions for example

791
00:42:03,230 --> 00:42:10,370
a header you can spend three weeks to

792
00:42:06,340 --> 00:42:13,490
perform multiple actions or three weeks

793
00:42:10,370 --> 00:42:17,140
in this recent example three weeks the

794
00:42:13,490 --> 00:42:21,709
hackers were hacked in a way they were

795
00:42:17,140 --> 00:42:24,310
sending thousands of commands so we can

796
00:42:21,710 --> 00:42:31,100
reconstruct the sequence of these

797
00:42:24,310 --> 00:42:35,509
activities this is attacks of the intern

798
00:42:31,100 --> 00:42:41,120
period if something is being downloaded

799
00:42:35,510 --> 00:42:44,090
this something is wrong and also for

800
00:42:41,120 --> 00:42:47,600
example if we have a secretary of that

801
00:42:44,090 --> 00:42:49,990
uses SSH to configure the router and

802
00:42:47,600 --> 00:42:53,509
that looks like a suspicious activity

803
00:42:49,990 --> 00:42:56,990
even if even if nothing is broken but

804
00:42:53,510 --> 00:43:01,160
that's strange so if somebody logs onto

805
00:42:56,990 --> 00:43:02,689
a router or too many routers then the

806
00:43:01,160 --> 00:43:05,589
question the next question you want to

807
00:43:02,690 --> 00:43:09,230
ask of course is who gave the permission

808
00:43:05,590 --> 00:43:13,610
who give permission to this secretary to

809
00:43:09,230 --> 00:43:16,520
do configuration that she is what he or

810
00:43:13,610 --> 00:43:20,530
she is not supposed to do so you have to

811
00:43:16,520 --> 00:43:20,530
collect all this information from hosts

812
00:43:25,080 --> 00:43:33,210
so we have these profiles and we follow

813
00:43:27,850 --> 00:43:38,799
these profiles in it is impossible to

814
00:43:33,210 --> 00:43:44,320
get hidden in network packets so if you

815
00:43:38,800 --> 00:43:50,740
switch on your night vision you can spot

816
00:43:44,320 --> 00:43:53,140
a saboteur like here and this is a

817
00:43:50,740 --> 00:43:53,859
metaphor of what you can do on the

818
00:43:53,140 --> 00:43:57,150
network

819
00:43:53,860 --> 00:44:02,050
you can do the same thing on the network

820
00:43:57,150 --> 00:44:09,790
so if you miss one thing if you miss one

821
00:44:02,050 --> 00:44:11,650
thing you can have a major incident but

822
00:44:09,790 --> 00:44:19,120
there is another thing that the hacker

823
00:44:11,650 --> 00:44:26,430
knows the hacker must also do one wanted

824
00:44:19,120 --> 00:44:31,299
to make one mistake to be exposed make

825
00:44:26,430 --> 00:44:33,009
make mistake enter at the wrong key on

826
00:44:31,300 --> 00:44:37,240
the wrong command and this can be

827
00:44:33,010 --> 00:44:43,660
tracked any anomalous action can be

828
00:44:37,240 --> 00:44:47,700
trusted so we are back and they entire

829
00:44:43,660 --> 00:44:50,529
sequence of events we can do incident

830
00:44:47,700 --> 00:44:51,970
investigation we can do appropriate

831
00:44:50,530 --> 00:44:54,670
fixes to make sure that this never

832
00:44:51,970 --> 00:44:57,399
happens again and one more thing before

833
00:44:54,670 --> 00:45:00,910
I turn to the demonstration workstation

834
00:44:57,400 --> 00:45:05,740
protection of course the great thing and

835
00:45:00,910 --> 00:45:08,549
I believe that the EDR market well many

836
00:45:05,740 --> 00:45:11,620
of us are present there and very well -

837
00:45:08,550 --> 00:45:14,530
otherwise this market it's a great thing

838
00:45:11,620 --> 00:45:16,560
to be able to actually completely

839
00:45:14,530 --> 00:45:20,340
reconstruct the

840
00:45:16,560 --> 00:45:24,210
Hector attacked all I say for example

841
00:45:20,340 --> 00:45:27,660
you come for a read on a nice day and

842
00:45:24,210 --> 00:45:28,260
hear the news that your company has been

843
00:45:27,660 --> 00:45:30,299
hacked

844
00:45:28,260 --> 00:45:33,290
you can do an investigation it's very

845
00:45:30,300 --> 00:45:36,270
good to have a product that can that can

846
00:45:33,290 --> 00:45:40,350
automatically respond to a key to an

847
00:45:36,270 --> 00:45:43,440
attack because what we really want to

848
00:45:40,350 --> 00:45:47,310
have at the end of the day is not to be

849
00:45:43,440 --> 00:45:50,790
hacked and know about it but to never be

850
00:45:47,310 --> 00:45:54,120
hacked what are we doing for this we

851
00:45:50,790 --> 00:45:59,190
create great products traps NJ firewall

852
00:45:54,120 --> 00:46:01,859
traps and others as they are we also

853
00:45:59,190 --> 00:46:04,620
make sure that all the know-how that we

854
00:46:01,860 --> 00:46:09,140
have and all the know-how that's out

855
00:46:04,620 --> 00:46:14,100
there in the world that we use it to

856
00:46:09,140 --> 00:46:18,140
preventively respond to all attempts at

857
00:46:14,100 --> 00:46:20,850
your company or a business so an example

858
00:46:18,140 --> 00:46:24,150
if there is the life cycle of cyber

859
00:46:20,850 --> 00:46:26,970
attacks other people call it the kill

860
00:46:24,150 --> 00:46:29,390
chain all right we just scroll through

861
00:46:26,970 --> 00:46:29,390
this

862
00:46:31,100 --> 00:46:42,950
[Music]

863
00:46:38,290 --> 00:46:48,290
so what does traps do for you it blocks

864
00:46:42,950 --> 00:46:50,540
exploits blocks out the malware well I

865
00:46:48,290 --> 00:46:53,329
guess any products any simple product

866
00:46:50,540 --> 00:46:56,509
can do this but the question is the

867
00:46:53,329 --> 00:47:00,609
following when the traps product

868
00:46:56,510 --> 00:47:04,700
triggers you have to figure out how

869
00:47:00,609 --> 00:47:07,970
malware and this particular malware got

870
00:47:04,700 --> 00:47:09,379
onto your computer onto your system okay

871
00:47:07,970 --> 00:47:12,500
the most important thing is that we

872
00:47:09,380 --> 00:47:15,619
blocked it then we try to to do

873
00:47:12,500 --> 00:47:21,920
investigation to investigate the reason

874
00:47:15,619 --> 00:47:24,650
and then we need to fix the exploit to

875
00:47:21,920 --> 00:47:30,260
fix a vulnerability this is a screenshot

876
00:47:24,650 --> 00:47:32,780
from the real system okay how does an

877
00:47:30,260 --> 00:47:35,510
event list look in X er it's pretty much

878
00:47:32,780 --> 00:47:39,260
standard nothing special here you have

879
00:47:35,510 --> 00:47:47,319
sources alerts for example here traps

880
00:47:39,260 --> 00:47:50,809
blocked and malware so we can click on

881
00:47:47,319 --> 00:47:55,549
every event here and every row in this

882
00:47:50,809 --> 00:48:00,490
table and analyze what has happened how

883
00:47:55,549 --> 00:48:06,829
does this work in xtr so we right-click

884
00:48:00,490 --> 00:48:09,049
we choose analyze and I'm sure yeah I'm

885
00:48:06,829 --> 00:48:11,630
sure when you how this will look in real

886
00:48:09,049 --> 00:48:16,009
life you have a lot of options you can

887
00:48:11,630 --> 00:48:17,930
delete an event by the way I think it

888
00:48:16,010 --> 00:48:22,280
would be very interesting to know how

889
00:48:17,930 --> 00:48:26,529
often how often people click on the

890
00:48:22,280 --> 00:48:29,119
delete button I believe that the people

891
00:48:26,530 --> 00:48:30,920
click on the delete button much more

892
00:48:29,119 --> 00:48:33,349
frequently than on the analyze button

893
00:48:30,920 --> 00:48:37,520
people don't like to analyze things

894
00:48:33,349 --> 00:48:39,859
don't like to think benevolence let's

895
00:48:37,520 --> 00:48:42,160
click on the analyze here that's what we

896
00:48:39,859 --> 00:48:44,779
get after clicking on the analyze option

897
00:48:42,160 --> 00:48:49,500
we get the sequence

898
00:48:44,780 --> 00:48:52,320
this is a backward sequence this is the

899
00:48:49,500 --> 00:48:53,970
this is what we saw in traps that's a

900
00:48:52,320 --> 00:48:57,390
very standard way of doing things

901
00:48:53,970 --> 00:48:59,850
remember often you get hacked not by

902
00:48:57,390 --> 00:49:05,279
some sophisticated malware but by some

903
00:48:59,850 --> 00:49:09,810
scripts some eggs a files 7-zip archive

904
00:49:05,280 --> 00:49:15,410
er browser Chrome you don't we probably

905
00:49:09,810 --> 00:49:19,470
don't consider it to be an insecure

906
00:49:15,410 --> 00:49:22,440
program so these events can come from

907
00:49:19,470 --> 00:49:26,790
anywhere from from clown from holster

908
00:49:22,440 --> 00:49:29,460
from the network so I just wanted to

909
00:49:26,790 --> 00:49:32,310
find like to you how easy this can be

910
00:49:29,460 --> 00:49:35,250
done this investigation was done before

911
00:49:32,310 --> 00:49:39,960
your XE our stores millions of such

912
00:49:35,250 --> 00:49:44,040
chains they are only shown to you as you

913
00:49:39,960 --> 00:49:46,800
need them in siema you have millions of

914
00:49:44,040 --> 00:49:50,910
a films there is a correlation based

915
00:49:46,800 --> 00:49:56,580
analysis system but but what matters is

916
00:49:50,910 --> 00:50:02,240
that XE are really highlights the attack

917
00:49:56,580 --> 00:50:06,029
that led to a to an incident so in this

918
00:50:02,240 --> 00:50:11,509
investigation you can see what machine

919
00:50:06,030 --> 00:50:14,460
was affected what staff was to blame so

920
00:50:11,510 --> 00:50:19,430
this is a great program which allows you

921
00:50:14,460 --> 00:50:27,450
to see that very often very often keys

922
00:50:19,430 --> 00:50:29,730
are the weak link in this chain and this

923
00:50:27,450 --> 00:50:32,850
is very often seen here and you can

924
00:50:29,730 --> 00:50:36,450
study every program you can you can

925
00:50:32,850 --> 00:50:41,089
review these vulnerabilities you can for

926
00:50:36,450 --> 00:50:45,700
example do you can do additional checks

927
00:50:41,090 --> 00:50:47,500
for example the analysis

928
00:50:45,700 --> 00:50:50,230
the analysis believes that this was

929
00:50:47,500 --> 00:50:53,770
7-zip but you can do another more

930
00:50:50,230 --> 00:50:57,250
in-depth review and to make sure that

931
00:50:53,770 --> 00:50:59,530
maybe make sure that this result is

932
00:50:57,250 --> 00:51:02,170
completely correct so let's look at this

933
00:50:59,530 --> 00:51:07,150
when you click here when you click on

934
00:51:02,170 --> 00:51:09,390
the 7-zip 7-zip is open you see all the

935
00:51:07,150 --> 00:51:12,400
events associated with it the alerts

936
00:51:09,390 --> 00:51:14,770
what the process did what the process

937
00:51:12,400 --> 00:51:17,770
did to the registry to the files to the

938
00:51:14,770 --> 00:51:19,480
module you can click on the for example

939
00:51:17,770 --> 00:51:21,849
when you click on a word document and

940
00:51:19,480 --> 00:51:23,380
then it changes the registry you know

941
00:51:21,849 --> 00:51:26,619
it's always suspicious when a word

942
00:51:23,380 --> 00:51:29,319
document creates the exit files or it

943
00:51:26,619 --> 00:51:32,140
creates some changes in the registry if

944
00:51:29,319 --> 00:51:36,579
you identify those things it's a very

945
00:51:32,140 --> 00:51:38,589
good reason to be suspicious so this

946
00:51:36,579 --> 00:51:44,230
allows us to reconstruct the whole

947
00:51:38,589 --> 00:51:46,569
sequence of events associated with what

948
00:51:44,230 --> 00:51:50,650
the hacker did and I have different

949
00:51:46,569 --> 00:51:56,859
types of alerts we have Long's we have

950
00:51:50,650 --> 00:51:58,900
locks and B locks behavioural walks when

951
00:51:56,859 --> 00:52:04,390
something happens and a behavioral

952
00:51:58,900 --> 00:52:08,380
sequence is observed as I said there are

953
00:52:04,390 --> 00:52:12,308
kill chains and we do a breakdown of

954
00:52:08,380 --> 00:52:16,619
every kill chain allows you to see this

955
00:52:12,309 --> 00:52:21,940
allows you to see at what stage a

956
00:52:16,619 --> 00:52:27,280
particular piece of malware is for

957
00:52:21,940 --> 00:52:31,390
example can be evasion when when the

958
00:52:27,280 --> 00:52:35,510
script have obfuscates itself that needs

959
00:52:31,390 --> 00:52:38,000
to be decrypted or it can be persistent

960
00:52:35,510 --> 00:52:40,359
that's the more advanced it's a more

961
00:52:38,000 --> 00:52:40,359
advanced stage

962
00:52:42,329 --> 00:52:50,699
I'm going to skip this we can also

963
00:52:47,729 --> 00:52:54,538
review the files that were unpacked

964
00:52:50,699 --> 00:53:00,900
using the 7-zip software we can see what

965
00:52:54,539 --> 00:53:04,499
files were created we can also scroll

966
00:53:00,900 --> 00:53:08,069
through all these lines all these rows

967
00:53:04,499 --> 00:53:12,209
and also click on the tabs at the top of

968
00:53:08,069 --> 00:53:15,359
the screen so where we invest get these

969
00:53:12,209 --> 00:53:18,058
things we can see what the malware

970
00:53:15,359 --> 00:53:21,150
arrives in the registry and very many

971
00:53:18,059 --> 00:53:25,410
entries are not going to go into each

972
00:53:21,150 --> 00:53:27,630
and every one of them so you don't just

973
00:53:25,410 --> 00:53:31,739
have a bird's-eye view of what has

974
00:53:27,630 --> 00:53:34,559
happened you can dive deep you can get

975
00:53:31,739 --> 00:53:39,239
into the raw data and there is a lot of

976
00:53:34,559 --> 00:53:47,160
such data it's all organized we also

977
00:53:39,239 --> 00:53:48,929
have behavior locks algorithms we don't

978
00:53:47,160 --> 00:53:52,979
just show it on the screen we show you

979
00:53:48,929 --> 00:53:56,130
what it did and what it does if it's

980
00:53:52,979 --> 00:53:59,968
still active for example a script was

981
00:53:56,130 --> 00:54:01,979
written into a temporal folder it may be

982
00:53:59,969 --> 00:54:05,299
a good thing it may be a bad thing but

983
00:54:01,979 --> 00:54:10,339
we generate another alert in order to

984
00:54:05,299 --> 00:54:14,759
get to it later then a process creed's

985
00:54:10,339 --> 00:54:17,308
in the auto start section of the

986
00:54:14,759 --> 00:54:19,229
registry has some entry it may be a good

987
00:54:17,309 --> 00:54:21,869
thing or a bad thing we don't know it

988
00:54:19,229 --> 00:54:30,569
yet we will only know it when we unravel

989
00:54:21,869 --> 00:54:33,509
the whole structure we can see that a

990
00:54:30,569 --> 00:54:37,499
new entry has been added then we create

991
00:54:33,509 --> 00:54:39,009
a script in there auto all launch auto

992
00:54:37,499 --> 00:54:44,859
run

993
00:54:39,009 --> 00:54:51,039
and here we have an alert the malware

994
00:54:44,859 --> 00:54:56,299
connected to a dangerous or blacklisted

995
00:54:51,039 --> 00:55:02,029
IP so we realized that all of that all

996
00:54:56,299 --> 00:55:05,390
of those actions have been just part of

997
00:55:02,029 --> 00:55:07,069
the preparation and we see that all

998
00:55:05,390 --> 00:55:11,078
these actions have been associated are

999
00:55:07,069 --> 00:55:14,808
associated with this particular event

1000
00:55:11,079 --> 00:55:17,869
they were just the preparation now let's

1001
00:55:14,809 --> 00:55:26,359
see how cold it is alpha skated very

1002
00:55:17,869 --> 00:55:28,009
often PowerShell is used separate

1003
00:55:26,359 --> 00:55:34,578
presentations about execution promises

1004
00:55:28,009 --> 00:55:38,720
so we we work around them using the key

1005
00:55:34,579 --> 00:55:40,460
policy execution process and we will

1006
00:55:38,720 --> 00:55:44,118
just execute this code which is a

1007
00:55:40,460 --> 00:55:47,839
facility because is a very standard this

1008
00:55:44,119 --> 00:55:52,549
is a standard thing centered practice

1009
00:55:47,839 --> 00:55:56,538
and no host IPS can unpack it or if it

1010
00:55:52,549 --> 00:56:03,049
can it may fail at that so you can take

1011
00:55:56,539 --> 00:56:09,700
this code right from our program you can

1012
00:56:03,049 --> 00:56:13,579
copy it there is a program that can

1013
00:56:09,700 --> 00:56:17,960
reverse this base64 and you can review

1014
00:56:13,579 --> 00:56:22,749
this what this code does so again you

1015
00:56:17,960 --> 00:56:28,249
can click on all those options see

1016
00:56:22,749 --> 00:56:29,399
reconstructors this stages so what do we

1017
00:56:28,249 --> 00:56:33,029
have here

1018
00:56:29,400 --> 00:56:41,310
the most important thing is that the

1019
00:56:33,030 --> 00:56:50,910
command line instruction is refers to a

1020
00:56:41,310 --> 00:56:58,680
fat file and we see why we have CMD dot

1021
00:56:50,910 --> 00:57:02,029
excel in our chain of events it is it

1022
00:56:58,680 --> 00:57:05,009
was just a vote because there was a

1023
00:57:02,030 --> 00:57:06,750
reference to a script that was launched

1024
00:57:05,010 --> 00:57:10,890
through the command line to the command

1025
00:57:06,750 --> 00:57:14,730
prompt so this was launched in the PDF

1026
00:57:10,890 --> 00:57:17,879
bat and then we can go back even further

1027
00:57:14,730 --> 00:57:24,360
and try to figure out where this bat

1028
00:57:17,880 --> 00:57:27,210
came from how was that once again what

1029
00:57:24,360 --> 00:57:31,380
am i doing now I click from right to

1030
00:57:27,210 --> 00:57:34,080
left and try to figure out of where this

1031
00:57:31,380 --> 00:57:38,070
file came from where that team file came

1032
00:57:34,080 --> 00:57:43,080
from within goal to get to the bottom of

1033
00:57:38,070 --> 00:57:45,660
this I know that these screen shots may

1034
00:57:43,080 --> 00:57:50,810
not be as informative as you would want

1035
00:57:45,660 --> 00:57:50,810
but I just click on those balls always

1036
00:57:52,010 --> 00:58:00,900
on those stages or key milestones and

1037
00:57:57,660 --> 00:58:05,420
then I try to do investigation on each

1038
00:58:00,900 --> 00:58:05,420
and every one of them can hear you

1039
00:58:06,070 --> 00:58:14,810
[Music]

1040
00:58:07,910 --> 00:58:18,180
in 99% of the cases SSS are not

1041
00:58:14,810 --> 00:58:20,880
disclosed and the Gateway could not do

1042
00:58:18,180 --> 00:58:24,540
anything so you have to get protected at

1043
00:58:20,880 --> 00:58:28,050
the gateway and at the work station so

1044
00:58:24,540 --> 00:58:31,259
we click on the information about the

1045
00:58:28,050 --> 00:58:33,359
CMG this file was executed and then we

1046
00:58:31,260 --> 00:58:37,800
have to ask ourselves where it file came

1047
00:58:33,359 --> 00:58:40,470
from so we click on we click on the

1048
00:58:37,800 --> 00:58:43,530
7-zip because it got unpack from 7-zip I

1049
00:58:40,470 --> 00:58:47,879
click on that and we learned that this

1050
00:58:43,530 --> 00:58:50,790
was an archive this was a this was an

1051
00:58:47,880 --> 00:58:57,330
archive that was download that had been

1052
00:58:50,790 --> 00:58:59,730
downloaded from this short URL well it's

1053
00:58:57,330 --> 00:59:02,450
it's entirely okay to download things

1054
00:58:59,730 --> 00:59:05,760
from the internet but that's not it

1055
00:59:02,450 --> 00:59:08,250
actually it's not oh somebody I ran

1056
00:59:05,760 --> 00:59:11,940
Chrome how did user to that we have this

1057
00:59:08,250 --> 00:59:15,240
button called show all children and show

1058
00:59:11,940 --> 00:59:17,280
all parents sorry if you children and

1059
00:59:15,240 --> 00:59:21,049
show parents two different verbs what

1060
00:59:17,280 --> 00:59:23,609
does a show parent does it shows you who

1061
00:59:21,050 --> 00:59:27,660
started this Chrome it's important

1062
00:59:23,609 --> 00:59:32,869
because chrome started outlook you

1063
00:59:27,660 --> 00:59:32,868
understood I click on Chrome eggs a

1064
00:59:33,740 --> 00:59:42,899
click on the process that I'm interested

1065
00:59:38,910 --> 00:59:46,200
in then ask who started you show parent

1066
00:59:42,900 --> 00:59:48,359
and it adds a image for our

1067
00:59:46,200 --> 00:59:51,500
investigation is Outlook and here

1068
00:59:48,359 --> 00:59:55,710
everything becomes clear who can look in

1069
00:59:51,500 --> 00:59:58,270
Outlook which user used it in this case

1070
00:59:55,710 --> 01:00:00,400
Sauron and

1071
00:59:58,270 --> 01:00:03,160
then we're in the fence actually there

1072
01:00:00,400 --> 01:00:05,700
was a typical phishing attack what what

1073
01:00:03,160 --> 01:00:09,220
can we do at this point in time you know

1074
01:00:05,700 --> 01:00:14,020
there are different tools that you can

1075
01:00:09,220 --> 01:00:17,350
use in your investigation to remotely

1076
01:00:14,020 --> 01:00:21,460
connect the files will already have it

1077
01:00:17,350 --> 01:00:24,100
we already have it built in you can use

1078
01:00:21,460 --> 01:00:27,130
this great button called isolate host

1079
01:00:24,100 --> 01:00:30,549
who can isolate it so that shouldn't

1080
01:00:27,130 --> 01:00:35,280
infect anybody else in after we have

1081
01:00:30,550 --> 01:00:39,850
isolated it we get this remote access

1082
01:00:35,280 --> 01:00:43,510
tool that allows you enter every machine

1083
01:00:39,850 --> 01:00:48,000
that has traps installed take a look at

1084
01:00:43,510 --> 01:00:53,410
the process list as shown a such a tree

1085
01:00:48,000 --> 01:00:56,410
take a look at the files the list of

1086
01:00:53,410 --> 01:00:58,410
processes looking something like this

1087
01:00:56,410 --> 01:01:03,370
[Music]

1088
01:00:58,410 --> 01:01:08,020
so take a look at the files around some

1089
01:01:03,370 --> 01:01:12,940
commands and another interesting

1090
01:01:08,020 --> 01:01:18,730
capability is to start python scripts so

1091
01:01:12,940 --> 01:01:22,590
those those of you who can program on

1092
01:01:18,730 --> 01:01:27,960
Python it can come quite useful to you

1093
01:01:22,590 --> 01:01:32,860
so what have we done we started with

1094
01:01:27,960 --> 01:01:41,680
traps one is I said when it identifies

1095
01:01:32,860 --> 01:01:46,780
the malware and then we ran this whole

1096
01:01:41,680 --> 01:01:49,810
change PDF that's a bad starting

1097
01:01:46,780 --> 01:01:52,210
PowerShell and so just starting the

1098
01:01:49,810 --> 01:01:55,029
script we've understood that everything

1099
01:01:52,210 --> 01:01:58,680
was implemented through scripts how it

1100
01:01:55,030 --> 01:02:02,710
was done we isolated the host understood

1101
01:01:58,680 --> 01:02:06,330
what has been happening there

1102
01:02:02,710 --> 01:02:09,040
and this is exactly what you normally do

1103
01:02:06,330 --> 01:02:12,340
while investigating an interest in

1104
01:02:09,040 --> 01:02:15,279
incident but in actual fact there are

1105
01:02:12,340 --> 01:02:18,490
people called threat hunters when I was

1106
01:02:15,280 --> 01:02:21,580
thinking about them I thought it's great

1107
01:02:18,490 --> 01:02:23,740
when you have so much time you come to

1108
01:02:21,580 --> 01:02:26,590
work every day and you start thinking

1109
01:02:23,740 --> 01:02:28,330
what should I look for in events

1110
01:02:26,590 --> 01:02:30,790
actually I don't have the time for this

1111
01:02:28,330 --> 01:02:35,440
so that I should have an entire day to

1112
01:02:30,790 --> 01:02:38,759
generate something so using the work

1113
01:02:35,440 --> 01:02:42,400
that we've done investigating incidents

1114
01:02:38,760 --> 01:02:44,440
what can I do I can ask myself a

1115
01:02:42,400 --> 01:02:48,520
question look

1116
01:02:44,440 --> 01:02:53,100
files like this with PDF not bats

1117
01:02:48,520 --> 01:02:55,270
extension can they exist on some other

1118
01:02:53,100 --> 01:02:59,259
workstations yes it's just an idea

1119
01:02:55,270 --> 01:03:00,820
actually it's called TTP and if I have

1120
01:02:59,260 --> 01:03:04,120
the time I'll tell you more about that

1121
01:03:00,820 --> 01:03:06,810
this idea this is an idea that I have in

1122
01:03:04,120 --> 01:03:13,569
my head but I want to program it I need

1123
01:03:06,810 --> 01:03:16,720
to look on all of our machines and this

1124
01:03:13,570 --> 01:03:21,430
can be done using XDR we have an idea

1125
01:03:16,720 --> 01:03:27,009
and we need to adapt protection so that

1126
01:03:21,430 --> 01:03:28,629
should some files like this exist

1127
01:03:27,010 --> 01:03:33,520
we should be able to do something that

1128
01:03:28,630 --> 01:03:37,690
so evented xdr so we've seen this great

1129
01:03:33,520 --> 01:03:44,800
chain and we see this moment where in

1130
01:03:37,690 --> 01:03:48,850
CMD x a this grants updates PDF dot bat

1131
01:03:44,800 --> 01:03:50,560
a file is running so let's look for

1132
01:03:48,850 --> 01:03:53,170
things like this it's called double

1133
01:03:50,560 --> 01:03:56,290
extension so do we need to do we have

1134
01:03:53,170 --> 01:03:58,840
another menu in XD are we used to work

1135
01:03:56,290 --> 01:04:02,470
in the alerts menu but we also have a

1136
01:03:58,840 --> 01:04:04,270
Search tab which has query builder and

1137
01:04:02,470 --> 01:04:09,790
so we can be

1138
01:04:04,270 --> 01:04:11,140
a query allowing a certain doing certain

1139
01:04:09,790 --> 01:04:14,460
things so we can take a look at

1140
01:04:11,140 --> 01:04:19,240
processes files network connections

1141
01:04:14,460 --> 01:04:21,580
registry settings or all actions in this

1142
01:04:19,240 --> 01:04:23,950
particular case we are interested in

1143
01:04:21,580 --> 01:04:26,290
file events we're clicking of that so

1144
01:04:23,950 --> 01:04:29,140
what do we need we'll get a window where

1145
01:04:26,290 --> 01:04:33,029
we can look at all file events in our

1146
01:04:29,140 --> 01:04:38,319
enterprise network see creation reading

1147
01:04:33,030 --> 01:04:40,780
removal deletion writing you can track

1148
01:04:38,320 --> 01:04:44,460
all these things you just write the name

1149
01:04:40,780 --> 01:04:50,470
of the file PDF dot bat and that's it so

1150
01:04:44,460 --> 01:04:56,170
we type it and then you can hypothesize

1151
01:04:50,470 --> 01:04:59,980
that could be doc X dot path or

1152
01:04:56,170 --> 01:05:05,099
something like that right after you've

1153
01:04:59,980 --> 01:05:05,099
written this great rule you can apply it

1154
01:05:09,750 --> 01:05:15,580
actually there are quite a lot of

1155
01:05:12,130 --> 01:05:18,760
parameters here what how I chose chosen

1156
01:05:15,580 --> 01:05:21,060
here over the last month it's actually a

1157
01:05:18,760 --> 01:05:26,260
question about the retention policy

1158
01:05:21,060 --> 01:05:29,320
normally we retain them for a month you

1159
01:05:26,260 --> 01:05:33,160
can extend that if you need that so we

1160
01:05:29,320 --> 01:05:36,550
run this and you find out that such a

1161
01:05:33,160 --> 01:05:40,750
files exists and exists not only on the

1162
01:05:36,550 --> 01:05:44,400
computer that you have investigated CPC

1163
01:05:40,750 --> 01:05:48,220
o3o PCO for it's a test lab so look

1164
01:05:44,400 --> 01:05:52,900
you've identified that there are three

1165
01:05:48,220 --> 01:05:58,839
more computers where such files also

1166
01:05:52,900 --> 01:06:02,740
exists which means that something bad is

1167
01:05:58,839 --> 01:06:04,960
going on there as well so you need to go

1168
01:06:02,740 --> 01:06:07,839
to those hosts and start investigating

1169
01:06:04,960 --> 01:06:10,000
there as well if you're an SOC a

1170
01:06:07,839 --> 01:06:12,680
specialist or the threat investigator

1171
01:06:10,000 --> 01:06:16,099
this is a good clue for you

1172
01:06:12,680 --> 01:06:23,868
actually it's not yet all the ideal

1173
01:06:16,099 --> 01:06:28,609
thing is to automative you may want not

1174
01:06:23,869 --> 01:06:32,059
only to do automatic search but also to

1175
01:06:28,609 --> 01:06:37,098
analyze this and other computers so

1176
01:06:32,059 --> 01:06:39,200
there's this menu item analyze that you

1177
01:06:37,099 --> 01:06:43,010
can start on the computer

1178
01:06:39,200 --> 01:06:46,069
to unravel the chain just like you did

1179
01:06:43,010 --> 01:06:51,230
in the case that I explained so we click

1180
01:06:46,069 --> 01:06:55,329
analyze and so we find this a short

1181
01:06:51,230 --> 01:07:02,150
picture it's not yet all somebody

1182
01:06:55,329 --> 01:07:09,619
unzipped this file with 7-zip you may

1183
01:07:02,150 --> 01:07:15,440
click this icon with the label show

1184
01:07:09,619 --> 01:07:21,440
details see what it has an zipped what

1185
01:07:15,440 --> 01:07:24,680
archive you can see who ran it show

1186
01:07:21,440 --> 01:07:27,319
children I'll show parents and now we

1187
01:07:24,680 --> 01:07:30,259
see the parent again we investigate this

1188
01:07:27,319 --> 01:07:33,020
incident anyway States Firefox nothing

1189
01:07:30,260 --> 01:07:34,849
stands in the way for for us to click it

1190
01:07:33,020 --> 01:07:38,329
one second extra there are millions of

1191
01:07:34,849 --> 01:07:41,569
events like this stolen Exia will Ravel

1192
01:07:38,329 --> 01:07:44,029
them and they're all connected so based

1193
01:07:41,569 --> 01:07:49,180
on one events you can unravel the whole

1194
01:07:44,029 --> 01:07:51,980
chain let's do it again a show parents

1195
01:07:49,180 --> 01:07:55,098
look here it turns out that it's

1196
01:07:51,980 --> 01:08:00,140
Explorer and Firefox and again it was

1197
01:07:55,099 --> 01:08:04,220
some link that the user pressed same

1198
01:08:00,140 --> 01:08:08,288
thing all over again so what do we do

1199
01:08:04,220 --> 01:08:11,328
next we isolate this house again we get

1200
01:08:08,289 --> 01:08:15,410
secured again and in fact this query

1201
01:08:11,329 --> 01:08:19,429
building will be running always from

1202
01:08:15,410 --> 01:08:23,229
that this moment on but that's not yet

1203
01:08:19,429 --> 01:08:28,040
all I wanted to show you the third case

1204
01:08:23,229 --> 01:08:30,919
related the behavioral indicator in the

1205
01:08:28,040 --> 01:08:32,120
cases I'll show it to you now and if I

1206
01:08:30,920 --> 01:08:37,339
have the time how much time do I have

1207
01:08:32,120 --> 01:08:42,139
half an hour are great so I know it's

1208
01:08:37,339 --> 01:08:43,908
hard when I was first listening to this

1209
01:08:42,139 --> 01:08:46,339
presentation from my colleagues in the

1210
01:08:43,908 --> 01:08:48,948
Research Center you know let me make a

1211
01:08:46,339 --> 01:08:52,698
digression we went for a training that

1212
01:08:48,948 --> 01:08:54,888
Palo Alto Networks has research centers

1213
01:08:52,698 --> 01:08:59,330
in two places in California and in

1214
01:08:54,889 --> 01:09:04,870
Israel in Israel however strange machine

1215
01:08:59,330 --> 01:09:09,139
we use same buildings with a checkpoint

1216
01:09:04,870 --> 01:09:12,969
so we arrived and when they were first

1217
01:09:09,139 --> 01:09:18,409
showing this to me I don't know about

1218
01:09:12,969 --> 01:09:22,520
co-state I think I my brain died 20

1219
01:09:18,408 --> 01:09:25,790
slides before this one so I won't you

1220
01:09:22,520 --> 01:09:28,029
just because these are screenshots when

1221
01:09:25,790 --> 01:09:32,540
you're showing a demo it runs a slower

1222
01:09:28,029 --> 01:09:35,389
slow for me because some bugs happen and

1223
01:09:32,540 --> 01:09:39,649
it doesn't always run ideally at the

1224
01:09:35,389 --> 01:09:42,290
previous PhD I showed it with wraps and

1225
01:09:39,649 --> 01:09:47,629
PCG if I wall so some things didn't work

1226
01:09:42,290 --> 01:09:52,158
and it took me 10 minutes to investigate

1227
01:09:47,630 --> 01:09:53,719
so I backed it into a set a screenshot

1228
01:09:52,158 --> 01:09:55,790
they stopped but I didn't like it so

1229
01:09:53,719 --> 01:09:58,400
next time I'll do this live demo again

1230
01:09:55,790 --> 01:10:00,409
so or we showed you a few cases the

1231
01:09:58,400 --> 01:10:03,879
first case was interesting we unraveled

1232
01:10:00,409 --> 01:10:07,099
an investigation from the initial events

1233
01:10:03,880 --> 01:10:12,320
to the end the second case was about a

1234
01:10:07,100 --> 01:10:15,110
threat hunting and here we have seen

1235
01:10:12,320 --> 01:10:16,509
that you can find files with double

1236
01:10:15,110 --> 01:10:22,759
script

1237
01:10:16,510 --> 01:10:25,670
what am i leading you to I want to show

1238
01:10:22,760 --> 01:10:28,340
you show to you that this is actually a

1239
01:10:25,670 --> 01:10:30,830
behavioral pattern if you get double

1240
01:10:28,340 --> 01:10:33,800
extension files being creating your

1241
01:10:30,830 --> 01:10:37,870
computer you actually chose a behavioral

1242
01:10:33,800 --> 01:10:41,570
pattern of the hacker and you can add it

1243
01:10:37,870 --> 01:10:44,180
so everything that we've been doing so

1244
01:10:41,570 --> 01:10:50,090
far it's exactly what I want to do and

1245
01:10:44,180 --> 01:10:53,060
biak and basically adding this pattern

1246
01:10:50,090 --> 01:10:56,300
that I've identified so again a window

1247
01:10:53,060 --> 01:10:58,610
opens up I'm adding a pattern for files

1248
01:10:56,300 --> 01:11:02,540
for the network for the registry for the

1249
01:10:58,610 --> 01:11:07,339
processes standard things that you see

1250
01:11:02,540 --> 01:11:13,970
happening in your workstations then

1251
01:11:07,340 --> 01:11:17,540
again repeating myself same thing i and

1252
01:11:13,970 --> 01:11:20,960
by the way I understand it's too small

1253
01:11:17,540 --> 01:11:22,310
to see you can create your file at the

1254
01:11:20,960 --> 01:11:24,620
moment so where the file is being

1255
01:11:22,310 --> 01:11:28,340
created I can respond to see or what

1256
01:11:24,620 --> 01:11:32,240
your name is being assigned and then I

1257
01:11:28,340 --> 01:11:36,890
can respond to all other events reading

1258
01:11:32,240 --> 01:11:41,240
deletion and biak gets triggered at this

1259
01:11:36,890 --> 01:11:45,680
one moment and that's what I'm doing

1260
01:11:41,240 --> 01:11:47,660
what can I do I can first test it's

1261
01:11:45,680 --> 01:11:50,810
possible for me not to run immediately

1262
01:11:47,660 --> 01:11:53,139
but the first test same query and then

1263
01:11:50,810 --> 01:11:57,140
we've tested and found the same thing

1264
01:11:53,140 --> 01:12:00,770
3pcs pcl3 be sure to the co 4 where we

1265
01:11:57,140 --> 01:12:02,270
found there's a PD of those bats we can

1266
01:12:00,770 --> 01:12:06,170
start investigation but we don't need

1267
01:12:02,270 --> 01:12:08,990
that we need a behavioral Biak so we've

1268
01:12:06,170 --> 01:12:13,760
tested so we've seen for PCs like this

1269
01:12:08,990 --> 01:12:16,190
and when our wants to respond somehow to

1270
01:12:13,760 --> 01:12:18,950
them appearing again so again I will

1271
01:12:16,190 --> 01:12:20,900
click Save actually creating a björk is

1272
01:12:18,950 --> 01:12:23,230
a simple thing just because you already

1273
01:12:20,900 --> 01:12:29,349
have some data in terms of

1274
01:12:23,230 --> 01:12:32,990
the names I recommend well of course you

1275
01:12:29,350 --> 01:12:36,020
assign a name but it's important for you

1276
01:12:32,990 --> 01:12:39,170
that you should understand it recognize

1277
01:12:36,020 --> 01:12:41,830
it's in a column so I think you should

1278
01:12:39,170 --> 01:12:44,180
strain yourself and write a comment here

1279
01:12:41,830 --> 01:12:48,140
exactly the thing that programmers hate

1280
01:12:44,180 --> 01:12:50,300
to do so you have an action you have

1281
01:12:48,140 --> 01:12:53,360
silly severity you can prompt yourself

1282
01:12:50,300 --> 01:12:55,400
how severe it is according to you and as

1283
01:12:53,360 --> 01:12:58,059
type remember we're talking about kill

1284
01:12:55,400 --> 01:13:01,309
chain I think it's of the evasion

1285
01:12:58,060 --> 01:13:04,520
moments trying to bypass the protection

1286
01:13:01,310 --> 01:13:07,130
actually a part of the protection is in

1287
01:13:04,520 --> 01:13:09,590
the user head and there are lots of

1288
01:13:07,130 --> 01:13:13,100
methods but not all of them work because

1289
01:13:09,590 --> 01:13:15,830
so this is evasion so as a result we'll

1290
01:13:13,100 --> 01:13:18,470
take a look at how to use code again

1291
01:13:15,830 --> 01:13:21,769
three are for investigations response

1292
01:13:18,470 --> 01:13:26,360
threat hunting creating by ox

1293
01:13:21,770 --> 01:13:31,520
and we've done it based on the technique

1294
01:13:26,360 --> 01:13:36,049
that we've identified so we investigated

1295
01:13:31,520 --> 01:13:38,330
the hacker behavior case three we have

1296
01:13:36,050 --> 01:13:40,760
other type of sensors not only at the

1297
01:13:38,330 --> 01:13:43,670
workstation but also in the network that

1298
01:13:40,760 --> 01:13:46,190
you can get use as well let's just a

1299
01:13:43,670 --> 01:13:50,480
show actually it's about machine

1300
01:13:46,190 --> 01:13:52,580
learning there's lots of traffic in any

1301
01:13:50,480 --> 01:13:55,700
company hey guys were standing there are

1302
01:13:52,580 --> 01:13:56,710
so many seats there just come in don't

1303
01:13:55,700 --> 01:13:59,720
hesitate

1304
01:13:56,710 --> 01:14:02,990
let's take a look at the first reason so

1305
01:13:59,720 --> 01:14:08,739
we need to get prepared and take a look

1306
01:14:02,990 --> 01:14:11,950
at what's happening actually here in XDR

1307
01:14:08,739 --> 01:14:15,459
it's exactly the same thing you enter

1308
01:14:11,950 --> 01:14:18,760
the interface you click alerts and you

1309
01:14:15,460 --> 01:14:21,340
see alert sources here we used to click

1310
01:14:18,760 --> 01:14:23,950
on traps now let's click on the

1311
01:14:21,340 --> 01:14:26,980
magnifier magnifier is actually a

1312
01:14:23,950 --> 01:14:29,650
lightsaber product we acquired this

1313
01:14:26,980 --> 01:14:33,400
company three or four years ago and what

1314
01:14:29,650 --> 01:14:33,969
this company did it was building you a

1315
01:14:33,400 --> 01:14:37,330
BAS

1316
01:14:33,969 --> 01:14:40,330
this product is now integrated into exia

1317
01:14:37,330 --> 01:14:43,300
this event is quite simple it's not very

1318
01:14:40,330 --> 01:14:44,350
important maybe but let's see use it for

1319
01:14:43,300 --> 01:14:47,650
the investigation

1320
01:14:44,350 --> 01:14:50,950
it's about loading a lot of data outside

1321
01:14:47,650 --> 01:15:00,129
much upload so let's explore let's

1322
01:14:50,950 --> 01:15:04,330
investigate is it working I'll have to

1323
01:15:00,130 --> 01:15:08,320
walk about so here we have a bit expand

1324
01:15:04,330 --> 01:15:12,460
expanded so what we're interested in is

1325
01:15:08,320 --> 01:15:14,559
in the source not the computer well

1326
01:15:12,460 --> 01:15:17,440
prevent it of course it's good this is a

1327
01:15:14,560 --> 01:15:20,190
person another category what's important

1328
01:15:17,440 --> 01:15:22,839
is important for us is who in this case

1329
01:15:20,190 --> 01:15:25,089
magnifier understands that sits about

1330
01:15:22,840 --> 01:15:29,620
some Network event so we can click again

1331
01:15:25,090 --> 01:15:32,860
and take a look at the details its large

1332
01:15:29,620 --> 01:15:38,769
uploads and again we're just right click

1333
01:15:32,860 --> 01:15:43,719
and we need to delete no open who

1334
01:15:38,770 --> 01:15:48,540
chooses what I choose open actually by

1335
01:15:43,719 --> 01:15:54,070
opening it what we see is a new window

1336
01:15:48,540 --> 01:15:57,340
actually it's I think the second project

1337
01:15:54,070 --> 01:16:01,179
product within X 0 is called XDR

1338
01:15:57,340 --> 01:16:03,430
analytics this analytics is based on the

1339
01:16:01,180 --> 01:16:06,430
events that you have in cortex data Lake

1340
01:16:03,430 --> 01:16:10,120
and it also draws you nice pictures but

1341
01:16:06,430 --> 01:16:11,920
they are based on behavior analysis what

1342
01:16:10,120 --> 01:16:14,710
we're saying is that for this thing to

1343
01:16:11,920 --> 01:16:15,430
work we need to spend at least seven

1344
01:16:14,710 --> 01:16:18,550
days

1345
01:16:15,430 --> 01:16:25,000
to the traffic so what we see here some

1346
01:16:18,550 --> 01:16:27,730
person using a PC five using when CP he

1347
01:16:25,000 --> 01:16:32,740
they have uploaded two gigabytes of data

1348
01:16:27,730 --> 01:16:34,480
to a specific address is it good or bad

1349
01:16:32,740 --> 01:16:39,910
I don't know we can start an

1350
01:16:34,480 --> 01:16:42,580
investigation again as people who want

1351
01:16:39,910 --> 01:16:43,900
to do good for their company we can take

1352
01:16:42,580 --> 01:16:47,200
a look at different components for

1353
01:16:43,900 --> 01:16:50,769
instance more details about the alert

1354
01:16:47,200 --> 01:16:53,260
the codes whether it has been signed and

1355
01:16:50,770 --> 01:16:57,250
not just to take a look at some

1356
01:16:53,260 --> 01:17:00,640
parameters and then we can move to a

1357
01:16:57,250 --> 01:17:06,580
screen showing the information about

1358
01:17:00,640 --> 01:17:09,460
connections it can actually be anything

1359
01:17:06,580 --> 01:17:12,910
and it turns out that there have been a

1360
01:17:09,460 --> 01:17:15,990
lot of connections connecting with this

1361
01:17:12,910 --> 01:17:18,849
address through different ports and

1362
01:17:15,990 --> 01:17:23,349
actually is the functionality of the

1363
01:17:18,850 --> 01:17:28,870
file LG fair war Saturday technology far

1364
01:17:23,350 --> 01:17:36,010
walk here puts FTP on a specific port

1365
01:17:28,870 --> 01:17:41,430
and if it's identified as SMTP it's

1366
01:17:36,010 --> 01:17:45,070
another LG farm or if it's FTP it's

1367
01:17:41,430 --> 01:17:50,080
identifiable the important thing is that

1368
01:17:45,070 --> 01:17:52,179
tangia firewall sees on all ports so you

1369
01:17:50,080 --> 01:17:54,640
have lots of connections a network first

1370
01:17:52,180 --> 01:17:57,190
on the right port then some abnormal

1371
01:17:54,640 --> 01:18:00,550
ports this person was translating

1372
01:17:57,190 --> 01:18:03,070
something there so I have to get closer

1373
01:18:00,550 --> 01:18:06,870
for the clicker to work so you can take

1374
01:18:03,070 --> 01:18:06,870
a look there's some statistics

1375
01:18:08,580 --> 01:18:17,530
and then at some point they're sending a

1376
01:18:11,650 --> 01:18:20,440
lot of data but this big chunk of data

1377
01:18:17,530 --> 01:18:24,340
that doesn't tell us anything we need to

1378
01:18:20,440 --> 01:18:27,610
take a closer look and what I like in

1379
01:18:24,340 --> 01:18:30,040
this concept context is that Facebook is

1380
01:18:27,610 --> 01:18:33,009
recording all the traffic it they can

1381
01:18:30,040 --> 01:18:37,200
open it and take a look but you know

1382
01:18:33,010 --> 01:18:42,910
when I see a see SCP SCP it can be about

1383
01:18:37,200 --> 01:18:46,300
SSH transmission so we then need to

1384
01:18:42,910 --> 01:18:48,340
understand what else is happening and we

1385
01:18:46,300 --> 01:18:49,960
can take a look at the data we haven't

1386
01:18:48,340 --> 01:18:53,350
been collecting but we can take a look

1387
01:18:49,960 --> 01:18:55,930
at what else of this computer was doing

1388
01:18:53,350 --> 01:18:59,230
when these operations were happening

1389
01:18:55,930 --> 01:19:01,650
because we suspected that these are

1390
01:18:59,230 --> 01:19:06,309
hacker activities we have this menu

1391
01:19:01,650 --> 01:19:09,670
let's blow it up that will help you take

1392
01:19:06,310 --> 01:19:14,440
a look during the investigation what was

1393
01:19:09,670 --> 01:19:17,560
happening with a file system what this

1394
01:19:14,440 --> 01:19:21,759
person was opening what the traffic was

1395
01:19:17,560 --> 01:19:25,270
incoming because it's important for me

1396
01:19:21,760 --> 01:19:28,210
maybe they were sending something out

1397
01:19:25,270 --> 01:19:33,969
and let's take a look at the outgoing

1398
01:19:28,210 --> 01:19:36,880
traffic ok great we've taken a look and

1399
01:19:33,969 --> 01:19:39,840
now we see that's actually the world

1400
01:19:36,880 --> 01:19:44,680
many connection connections established

1401
01:19:39,840 --> 01:19:48,940
you can see the local IP the remote IP

1402
01:19:44,680 --> 01:19:52,510
remote foods and in this case a remote

1403
01:19:48,940 --> 01:19:55,509
country so I favorite our favorite

1404
01:19:52,510 --> 01:19:57,910
analyze button so we've seen that

1405
01:19:55,510 --> 01:20:01,110
there's a connection we click on the

1406
01:19:57,910 --> 01:20:06,199
event we click analyze and by the way I

1407
01:20:01,110 --> 01:20:08,969
did make a investigation online

1408
01:20:06,199 --> 01:20:12,500
screenshots investigating timeline

1409
01:20:08,969 --> 01:20:15,329
actually it's a quite good thing to do

1410
01:20:12,500 --> 01:20:20,670
so you can see all these events along

1411
01:20:15,329 --> 01:20:22,079
the kill chain entering exploiting if I

1412
01:20:20,670 --> 01:20:24,810
have the time I'll show you right from

1413
01:20:22,079 --> 01:20:28,259
the computer so we click on analyze and

1414
01:20:24,810 --> 01:20:31,860
again we have this great picture when we

1415
01:20:28,260 --> 01:20:35,579
find through winscp and we're looking

1416
01:20:31,860 --> 01:20:39,139
where it was started from why did I give

1417
01:20:35,579 --> 01:20:43,019
this example it's important for us that

1418
01:20:39,139 --> 01:20:46,380
Explorer or plus plus eggsy we can see

1419
01:20:43,020 --> 01:20:50,849
what it's already also started in this

1420
01:20:46,380 --> 01:20:53,610
case I would have clicked the show child

1421
01:20:50,849 --> 01:20:56,820
button in this case Explorer plus plus

1422
01:20:53,610 --> 01:21:01,079
XA we don't yet know what it is we see

1423
01:20:56,820 --> 01:21:08,070
that it's also started to win zip we

1424
01:21:01,079 --> 01:21:11,849
clicked it's showing child processes we

1425
01:21:08,070 --> 01:21:16,019
can also click again to show child

1426
01:21:11,849 --> 01:21:21,840
processes here here we are going to work

1427
01:21:16,020 --> 01:21:27,540
in the reverse order here we see again

1428
01:21:21,840 --> 01:21:30,050
that the person was packing files was

1429
01:21:27,540 --> 01:21:30,050
created

1430
01:21:30,409 --> 01:21:35,129
double double extension files and there

1431
01:21:33,389 --> 01:21:36,900
are lots of strange things so you can

1432
01:21:35,130 --> 01:21:39,920
see all this in the process of

1433
01:21:36,900 --> 01:21:43,129
investigation we can again

1434
01:21:39,920 --> 01:21:43,130
pay attention

1435
01:21:46,060 --> 01:21:59,180
to them creating strange files with

1436
01:21:53,570 --> 01:22:08,269
double extensions data as if TMP in this

1437
01:21:59,180 --> 01:22:11,060
particular case yeah I should have done

1438
01:22:08,270 --> 01:22:13,490
the other way what I was driving at

1439
01:22:11,060 --> 01:22:15,110
starting from the moments when you've

1440
01:22:13,490 --> 01:22:17,450
seen that something has happened on the

1441
01:22:15,110 --> 01:22:19,849
PC and you've started the investigation

1442
01:22:17,450 --> 01:22:22,610
you understand what else was happening

1443
01:22:19,850 --> 01:22:24,590
on this computer yes for this they took

1444
01:22:22,610 --> 01:22:28,370
this but you took a look at two other

1445
01:22:24,590 --> 01:22:32,090
connections for this I showed you that

1446
01:22:28,370 --> 01:22:34,790
this when a CP process was started by

1447
01:22:32,090 --> 01:22:37,550
someone what else it was doing and at

1448
01:22:34,790 --> 01:22:40,190
this point when we understood which

1449
01:22:37,550 --> 01:22:41,900
files were being connected and

1450
01:22:40,190 --> 01:22:45,410
transmitted we can understand all the

1451
01:22:41,900 --> 01:22:47,629
actions for instance creating double

1452
01:22:45,410 --> 01:22:51,340
extension files could be an attempt of

1453
01:22:47,630 --> 01:22:54,470
obfuscation energy firewall because

1454
01:22:51,340 --> 01:22:56,780
because you can actually rename a word

1455
01:22:54,470 --> 01:22:59,300
document it in an excel file and send it

1456
01:22:56,780 --> 01:23:00,559
with your firewall to take that or the

1457
01:22:59,300 --> 01:23:03,410
other way around

1458
01:23:00,560 --> 01:23:05,600
you can rename an excel file into a txt

1459
01:23:03,410 --> 01:23:08,000
file will your file will detect that

1460
01:23:05,600 --> 01:23:11,080
it's very important in actual facts

1461
01:23:08,000 --> 01:23:15,290
machine learning doesn't only show you

1462
01:23:11,080 --> 01:23:18,830
transmitting large files but also it can

1463
01:23:15,290 --> 01:23:24,050
identify any deviations from normal

1464
01:23:18,830 --> 01:23:28,880
behavior this is what's good for you you

1465
01:23:24,050 --> 01:23:33,260
can find some abnormal events and find

1466
01:23:28,880 --> 01:23:37,130
other things that this user is doing at

1467
01:23:33,260 --> 01:23:39,590
a stage quite often because my home last

1468
01:23:37,130 --> 01:23:41,270
week was about quarter questia what

1469
01:23:39,590 --> 01:23:45,140
quite often they asked my question

1470
01:23:41,270 --> 01:23:48,400
this is cm didn't anybody of you have

1471
01:23:45,140 --> 01:23:52,020
this feeling that ACM

1472
01:23:48,400 --> 01:23:55,389
a new idea right and by the way yes

1473
01:23:52,020 --> 01:23:58,120
sometimes you keep telling it for two

1474
01:23:55,390 --> 01:24:02,470
hours and if they tell you look we have

1475
01:23:58,120 --> 01:24:07,120
a navy it's good but it's quite enough I

1476
01:24:02,470 --> 01:24:10,090
don't know what to do because in the

1477
01:24:07,120 --> 01:24:13,260
example of it I give you people had

1478
01:24:10,090 --> 01:24:17,860
great security systems sometimes you

1479
01:24:13,260 --> 01:24:19,570
come to conference a bank shares how

1480
01:24:17,860 --> 01:24:22,660
well they're protected and then in a

1481
01:24:19,570 --> 01:24:25,990
week's time you see information how they

1482
01:24:22,660 --> 01:24:28,450
got hacked actually it's not about

1483
01:24:25,990 --> 01:24:31,179
products the product market is very

1484
01:24:28,450 --> 01:24:36,010
strong in Russia everybody wants to buy

1485
01:24:31,180 --> 01:24:38,020
products and I've worked I worked with

1486
01:24:36,010 --> 01:24:41,530
oxide for a long time and I saw this

1487
01:24:38,020 --> 01:24:52,110
happening people would buy oxide this is

1488
01:24:41,530 --> 01:24:55,719
from you know a story like you get max

1489
01:24:52,110 --> 01:24:57,400
you know to build a house then when you

1490
01:24:55,720 --> 01:24:59,260
think how to use this axe to build a

1491
01:24:57,400 --> 01:25:02,830
house all the tools that we use

1492
01:24:59,260 --> 01:25:05,410
including CM adjust tools they help you

1493
01:25:02,830 --> 01:25:07,390
automate something if you have nothing

1494
01:25:05,410 --> 01:25:07,870
to automate and why would you need those

1495
01:25:07,390 --> 01:25:12,900
tools

1496
01:25:07,870 --> 01:25:16,840
what does context HDR actually you can

1497
01:25:12,900 --> 01:25:20,620
do the same in cm but that will be done

1498
01:25:16,840 --> 01:25:24,690
through several products in cortex XDR

1499
01:25:20,620 --> 01:25:27,490
we collect the significant events and

1500
01:25:24,690 --> 01:25:29,919
what makes them different from alerts

1501
01:25:27,490 --> 01:25:33,219
that cm collects is that that's about

1502
01:25:29,920 --> 01:25:35,410
you know regular events happening in the

1503
01:25:33,220 --> 01:25:36,880
network they can also be sent this year

1504
01:25:35,410 --> 01:25:41,470
but people normally don't do that

1505
01:25:36,880 --> 01:25:44,170
because that's just blows out the number

1506
01:25:41,470 --> 01:25:47,200
of events per second and CM is becoming

1507
01:25:44,170 --> 01:25:50,440
too expensive cortex as via collects all

1508
01:25:47,200 --> 01:25:53,820
these events and immediately and

1509
01:25:50,440 --> 01:25:57,650
automatically it does the investigation

1510
01:25:53,820 --> 01:26:03,530
also it has a response actions

1511
01:25:57,650 --> 01:26:07,040
also it works out of the box you need to

1512
01:26:03,530 --> 01:26:09,019
set it up we just need to feed data to

1513
01:26:07,040 --> 01:26:11,090
it and by the way another question about

1514
01:26:09,020 --> 01:26:14,270
licensing you know there are different

1515
01:26:11,090 --> 01:26:17,290
licensing schematics somebody sells some

1516
01:26:14,270 --> 01:26:21,730
number of agents other people sell

1517
01:26:17,290 --> 01:26:27,980
sensors Korsak says dia is licensed

1518
01:26:21,730 --> 01:26:29,449
based on the size of the database where

1519
01:26:27,980 --> 01:26:32,718
you connect all these events for

1520
01:26:29,449 --> 01:26:34,009
instance you buy two terabytes and we

1521
01:26:32,719 --> 01:26:39,710
proceed from the fact that unfortunately

1522
01:26:34,010 --> 01:26:42,020
in so many ways that for 200 machines

1523
01:26:39,710 --> 01:26:45,370
you need 1 terabytes of data per month

1524
01:26:42,020 --> 01:26:49,429
you can understand the size of it so

1525
01:26:45,370 --> 01:26:53,269
this license includes all agents you can

1526
01:26:49,429 --> 01:26:57,080
use your own agents traps comes for free

1527
01:26:53,270 --> 01:26:59,929
you can use some other protection tools

1528
01:26:57,080 --> 01:27:03,260
but nothing stands in the way for you to

1529
01:26:59,929 --> 01:27:08,449
use at traps because perhaps is included

1530
01:27:03,260 --> 01:27:12,429
you already paid for Exia so I would

1531
01:27:08,449 --> 01:27:16,009
compare cm and Kotick SDR based on these

1532
01:27:12,429 --> 01:27:22,330
circles and very briefly I think I've

1533
01:27:16,010 --> 01:27:28,190
shown you so more data automatic links

1534
01:27:22,330 --> 01:27:29,929
and I've seen a lot of products and I

1535
01:27:28,190 --> 01:27:33,940
think you've also seen a lot of products

1536
01:27:29,929 --> 01:27:36,790
maybe agree with me maybe not that this

1537
01:27:33,940 --> 01:27:40,040
visualization a single window of all

1538
01:27:36,790 --> 01:27:44,570
events be that network related host

1539
01:27:40,040 --> 01:27:47,870
related this is exactly what you may

1540
01:27:44,570 --> 01:27:52,340
dream about it's exactly what you need

1541
01:27:47,870 --> 01:27:54,440
to strive at and by the way the topic of

1542
01:27:52,340 --> 01:27:57,170
this conference digits digital forensics

1543
01:27:54,440 --> 01:28:01,790
and responds a response it's exactly

1544
01:27:57,170 --> 01:28:05,260
what I'm interested in and that would be

1545
01:28:01,790 --> 01:28:05,260
the next topic I want to talk about

1546
01:28:11,400 --> 01:28:17,139
for those of you who are listening of a

1547
01:28:14,620 --> 01:28:20,620
broadcast the question was can traps

1548
01:28:17,140 --> 01:28:23,110
collect the operating system logs or can

1549
01:28:20,620 --> 01:28:26,530
it or does it rely on them actually

1550
01:28:23,110 --> 01:28:28,870
traps generates these events itself not

1551
01:28:26,530 --> 01:28:32,380
relied they're relying on any kind of

1552
01:28:28,870 --> 01:28:37,420
logs you can integrate some other

1553
01:28:32,380 --> 01:28:41,260
products or events you can put it in put

1554
01:28:37,420 --> 01:28:45,210
those from other products into the

1555
01:28:41,260 --> 01:28:45,210
cortex reflux and data lake

1556
01:28:52,050 --> 01:29:03,159
look the locking policies run on agents

1557
01:28:58,179 --> 01:29:04,960
just as we wrote them traps blocks the

1558
01:29:03,159 --> 01:29:12,040
firewall blocks them but the analytics

1559
01:29:04,960 --> 01:29:19,270
run in the big brain on top of this data

1560
01:29:12,040 --> 01:29:22,060
cloud once again the logs are stored in

1561
01:29:19,270 --> 01:29:26,650
this large cortex data Lake these are

1562
01:29:22,060 --> 01:29:31,060
not long but is it just is a more like

1563
01:29:26,650 --> 01:29:34,650
events all right to pick up where we

1564
01:29:31,060 --> 01:29:40,510
left off so we can use this product

1565
01:29:34,650 --> 01:29:45,219
together with this cm cortex does not

1566
01:29:40,510 --> 01:29:47,440
replace you but complements it okay what

1567
01:29:45,219 --> 01:29:52,300
products we have considered today well

1568
01:29:47,440 --> 01:29:55,928
we have considered how we can use thread

1569
01:29:52,300 --> 01:30:00,969
sensor using our interface how projects

1570
01:29:55,929 --> 01:30:03,250
are an attack attack how they idolize

1571
01:30:00,969 --> 01:30:04,710
how many more minutes do I have more 15

1572
01:30:03,250 --> 01:30:09,610
minutes okay great

1573
01:30:04,710 --> 01:30:12,310
okay I'm great in terms of time

1574
01:30:09,610 --> 01:30:14,790
management there are some things that we

1575
01:30:12,310 --> 01:30:19,480
have discussed today but we have not

1576
01:30:14,790 --> 01:30:20,349
named them explicitly we have discussed

1577
01:30:19,480 --> 01:30:26,348
playbooks

1578
01:30:20,349 --> 01:30:29,059
we also discussed TTP raise your hand if

1579
01:30:26,349 --> 01:30:31,190
you don't know these words okay

1580
01:30:29,059 --> 01:30:35,449
it's great that I have added these

1581
01:30:31,190 --> 01:30:37,730
slides I've added these lines to

1582
01:30:35,449 --> 01:30:40,969
encourage everybody to use these things

1583
01:30:37,730 --> 01:30:43,629
because these behavioral patterns and

1584
01:30:40,969 --> 01:30:46,639
they are cold

1585
01:30:43,630 --> 01:30:50,300
by the way they they have to use be used

1586
01:30:46,639 --> 01:30:53,150
inside your company everybody is talking

1587
01:30:50,300 --> 01:30:57,559
about the fact that every company should

1588
01:30:53,150 --> 01:30:59,900
have a red team and blue team red team

1589
01:30:57,559 --> 01:31:02,380
are those to try to protect the company

1590
01:30:59,900 --> 01:31:07,190
at the blue team are those that try to

1591
01:31:02,380 --> 01:31:10,190
attack the company so and also there's

1592
01:31:07,190 --> 01:31:15,409
talk of the purple team because human

1593
01:31:10,190 --> 01:31:22,119
ego is limitless and you know if

1594
01:31:15,409 --> 01:31:24,289
somebody gets to hack something then

1595
01:31:22,119 --> 01:31:25,820
something I mean well other people may

1596
01:31:24,289 --> 01:31:27,949
not agree with this so there has to be

1597
01:31:25,820 --> 01:31:33,739
there has to be some kind of a referee

1598
01:31:27,949 --> 01:31:39,440
so that's the purple team so my my best

1599
01:31:33,739 --> 01:31:45,799
my favorite link 300 pieces of advice

1600
01:31:39,440 --> 01:31:56,449
for the red team that's trash these are

1601
01:31:45,800 --> 01:31:58,550
just Linux commands and they are this

1602
01:31:56,449 --> 01:32:02,239
please I recommend you to go to that

1603
01:31:58,550 --> 01:32:05,239
link you have lots of things reason was

1604
01:32:02,239 --> 01:32:08,348
to do over the next weekend's over the

1605
01:32:05,239 --> 01:32:08,348
next few weeks

1606
01:32:09,260 --> 01:32:18,120
[Music]

1607
01:32:10,530 --> 01:32:21,880
what is a playbook in the game hackers

1608
01:32:18,120 --> 01:32:24,610
security guys football okay there are

1609
01:32:21,880 --> 01:32:27,880
algorithms that you used to attack and

1610
01:32:24,610 --> 01:32:31,240
took use to defend against attacks and

1611
01:32:27,880 --> 01:32:33,730
the playbook is a description of how you

1612
01:32:31,240 --> 01:32:34,360
can get attacked by hackers why though

1613
01:32:33,730 --> 01:32:39,669
we need it

1614
01:32:34,360 --> 01:32:42,400
if luck happens you have to be able to

1615
01:32:39,670 --> 01:32:46,410
have kind of a language that can be

1616
01:32:42,400 --> 01:32:52,960
understood by other software indices

1617
01:32:46,410 --> 01:32:56,740
security guys how to describe what has

1618
01:32:52,960 --> 01:32:59,860
happened so if you have a game this is

1619
01:32:56,740 --> 01:33:03,849
this is a methodology for what has to be

1620
01:32:59,860 --> 01:33:07,750
done by whom and when that's called

1621
01:33:03,850 --> 01:33:11,620
adversary playbook that's a collection

1622
01:33:07,750 --> 01:33:14,560
of attacks methods and techniques used

1623
01:33:11,620 --> 01:33:17,230
by hackers to break into networks so

1624
01:33:14,560 --> 01:33:24,480
these are called tools techniques and

1625
01:33:17,230 --> 01:33:29,469
procedures TTP's for example creating a

1626
01:33:24,480 --> 01:33:32,169
file with double extension such as PDF

1627
01:33:29,470 --> 01:33:33,970
thought that that's it that's a

1628
01:33:32,170 --> 01:33:39,040
technique that's a tactic

1629
01:33:33,970 --> 01:33:41,650
how can you expose these techniques in

1630
01:33:39,040 --> 01:33:46,540
fact there are some teams that play for

1631
01:33:41,650 --> 01:33:51,670
the hackers others play on the other

1632
01:33:46,540 --> 01:33:55,090
side of the field out of 1,000 attacks

1633
01:33:51,670 --> 01:34:02,099
on a company on average one of them is

1634
01:33:55,090 --> 01:34:04,570
political motivated ninth and 999 are

1635
01:34:02,099 --> 01:34:07,300
motivated are done for money basically

1636
01:34:04,570 --> 01:34:11,650
so these use play books for example

1637
01:34:07,300 --> 01:34:14,739
using logs that's just an example

1638
01:34:11,650 --> 01:34:17,848
of how this can be done and these

1639
01:34:14,739 --> 01:34:20,739
conduct attacks against companies to use

1640
01:34:17,849 --> 01:34:22,690
specific techniques and these techniques

1641
01:34:20,739 --> 01:34:26,169
have indicators these indicators can be

1642
01:34:22,690 --> 01:34:35,169
collected into a common database from

1643
01:34:26,170 --> 01:34:38,440
which everybody can take this data I'm

1644
01:34:35,170 --> 01:34:42,389
going to give you an example of an

1645
01:34:38,440 --> 01:34:51,308
attack database and there is sticks

1646
01:34:42,389 --> 01:34:57,070
exchange language how does it work we

1647
01:34:51,309 --> 01:34:59,559
have a site on github that allows you to

1648
01:34:57,070 --> 01:35:05,199
look at the playbook of the hacker teams

1649
01:34:59,559 --> 01:35:11,829
that we have that we have identified in

1650
01:35:05,199 --> 01:35:13,928
our lab this is in fact a web is as a

1651
01:35:11,829 --> 01:35:17,409
bit of a button has a lot of people in

1652
01:35:13,929 --> 01:35:19,960
it we do incident research and attack

1653
01:35:17,409 --> 01:35:24,070
research so these indicators can be used

1654
01:35:19,960 --> 01:35:27,639
in any product how do they look perhaps

1655
01:35:24,070 --> 01:35:32,949
you can read this it has specific

1656
01:35:27,639 --> 01:35:35,380
examples hash hashes hashes are

1657
01:35:32,949 --> 01:35:39,419
indicators you can use the hashes you

1658
01:35:35,380 --> 01:35:43,800
can look for a hash and you can identify

1659
01:35:39,420 --> 01:35:47,710
telltale signs of a specific attack what

1660
01:35:43,800 --> 01:35:49,300
channels have been used and so on so the

1661
01:35:47,710 --> 01:35:51,610
collection of these indicators is

1662
01:35:49,300 --> 01:35:54,429
exactly what you need to bump up the

1663
01:35:51,610 --> 01:35:55,690
level of your security okay there are

1664
01:35:54,429 --> 01:36:00,659
many other languages as well not just

1665
01:35:55,690 --> 01:36:04,598
sticks these are XML based languages

1666
01:36:00,659 --> 01:36:06,239
sticks and structured texture

1667
01:36:04,599 --> 01:36:08,699
information expression

1668
01:36:06,239 --> 01:36:12,089
is also a taxa trusted automated

1669
01:36:08,699 --> 01:36:18,018
indicator information inside box sever

1670
01:36:12,090 --> 01:36:23,599
observable expression these ones are

1671
01:36:18,019 --> 01:36:27,650
specifically optimized for threat

1672
01:36:23,599 --> 01:36:32,280
information exchange for incident

1673
01:36:27,650 --> 01:36:34,558
investigation tactic identification and

1674
01:36:32,280 --> 01:36:39,929
sharing these tactics with your

1675
01:36:34,559 --> 01:36:43,769
colleagues that's very convenient so

1676
01:36:39,929 --> 01:36:47,639
what are the techniques let me give you

1677
01:36:43,769 --> 01:36:49,920
this example from sticks well that's a

1678
01:36:47,639 --> 01:36:58,309
little bit too deep and too far into the

1679
01:36:49,920 --> 01:37:03,239
weave if you go to me my turn attack

1680
01:36:58,309 --> 01:37:06,030
you'll find a global public database of

1681
01:37:03,239 --> 01:37:08,759
attacks I can't read this word

1682
01:37:06,030 --> 01:37:13,800
adversarial tactics techniques and

1683
01:37:08,760 --> 01:37:17,939
common knowledge ATT and CK attack this

1684
01:37:13,800 --> 01:37:20,400
is what your blue and red teams need so

1685
01:37:17,939 --> 01:37:25,349
they can kind of synchronize their

1686
01:37:20,400 --> 01:37:32,518
watches or anything good thing with this

1687
01:37:25,349 --> 01:37:36,420
database and you check your procedures

1688
01:37:32,519 --> 01:37:40,590
you people who practices against what is

1689
01:37:36,420 --> 01:37:42,920
present in this database so your threat

1690
01:37:40,590 --> 01:37:45,980
hunter can

1691
01:37:42,920 --> 01:37:49,070
of search this database this database is

1692
01:37:45,980 --> 01:37:52,849
extremely popular if you click on it and

1693
01:37:49,070 --> 01:37:56,179
by the way we have a free utility that

1694
01:37:52,850 --> 01:37:58,400
uses the playbook but this is basically

1695
01:37:56,180 --> 01:38:01,370
how it looks it you can click on let's

1696
01:37:58,400 --> 01:38:09,530
say I don't know something something

1697
01:38:01,370 --> 01:38:13,360
more interesting PowerShell and you can

1698
01:38:09,530 --> 01:38:15,980
see what can be done with PowerShell to

1699
01:38:13,360 --> 01:38:20,690
let's say break the security company

1700
01:38:15,980 --> 01:38:23,929
these are kind of radium recipes that

1701
01:38:20,690 --> 01:38:25,509
you can take news immediately well I'm

1702
01:38:23,930 --> 01:38:27,790
about to finish

1703
01:38:25,510 --> 01:38:31,250
[Music]

1704
01:38:27,790 --> 01:38:37,070
there are popular tactics let's look at

1705
01:38:31,250 --> 01:38:43,370
them I don't remember where it was there

1706
01:38:37,070 --> 01:38:46,370
was a there was a kind of a poll on what

1707
01:38:43,370 --> 01:38:48,769
the most popular a PowerShell is the

1708
01:38:46,370 --> 01:38:55,180
most popular it's shown in black and

1709
01:38:48,770 --> 01:38:55,180
credential dumping and sorry this this

1710
01:38:55,390 --> 01:39:02,630
this is still the same the weakest point

1711
01:38:58,850 --> 01:39:06,610
security weak password passports people

1712
01:39:02,630 --> 01:39:06,610
don't like strong passwords

1713
01:39:09,610 --> 01:39:13,540
rootkits as well

1714
01:39:13,929 --> 01:39:25,580
increased privileged access unwarranted

1715
01:39:21,170 --> 01:39:28,969
access of other techniques to bypass

1716
01:39:25,580 --> 01:39:32,300
two-factor authentication for example

1717
01:39:28,969 --> 01:39:35,480
you need to move faster - when you when

1718
01:39:32,300 --> 01:39:40,370
you don't send the password but you send

1719
01:39:35,480 --> 01:39:44,389
the hash these are popular ones now what

1720
01:39:40,370 --> 01:39:48,590
I'm getting at that yes that this whole

1721
01:39:44,390 --> 01:39:52,250
thing is a is part of the of a larger

1722
01:39:48,590 --> 01:39:56,179
more complex process of data exchange we

1723
01:39:52,250 --> 01:39:58,640
as a security company we are part of the

1724
01:39:56,179 --> 01:40:00,590
cyber threat lines but that brings

1725
01:39:58,640 --> 01:40:06,429
together many companies that you need

1726
01:40:00,590 --> 01:40:12,550
that you know we exchange information we

1727
01:40:06,429 --> 01:40:16,910
open source access to these indicators

1728
01:40:12,550 --> 01:40:20,270
and company information you can use

1729
01:40:16,910 --> 01:40:25,040
anything from that database we have a

1730
01:40:20,270 --> 01:40:30,410
utility that's called wine meld it's

1731
01:40:25,040 --> 01:40:33,370
available from github you can you can

1732
01:40:30,410 --> 01:40:33,370
use it

1733
01:40:33,560 --> 01:40:42,510
we also is we have sources of TI such as

1734
01:40:40,410 --> 01:40:45,870
external blocklist red lock and

1735
01:40:42,510 --> 01:40:49,230
autofocus for example can get bad dns

1736
01:40:45,870 --> 01:40:56,280
lists you can you can upload them to

1737
01:40:49,230 --> 01:40:59,009
your EBL and and you can exchange threat

1738
01:40:56,280 --> 01:41:04,050
information as well so what I'm talking

1739
01:40:59,010 --> 01:41:07,590
about you can use this information that

1740
01:41:04,050 --> 01:41:11,970
I have shared with you to to review your

1741
01:41:07,590 --> 01:41:16,050
level of security and to enhance your

1742
01:41:11,970 --> 01:41:21,200
security make it more robust and we have

1743
01:41:16,050 --> 01:41:25,890
have we collected the feedback forms I

1744
01:41:21,200 --> 01:41:29,490
asked you at the beginning to fill out

1745
01:41:25,890 --> 01:41:34,590
the questionnaires less sure you have on

1746
01:41:29,490 --> 01:41:37,769
your seats and we are going to we're

1747
01:41:34,590 --> 01:41:40,680
going to give out prizes and based on

1748
01:41:37,770 --> 01:41:42,570
these questionnaires while you're

1749
01:41:40,680 --> 01:41:44,370
feeling out if you haven't done so yet

1750
01:41:42,570 --> 01:41:46,080
why are they filling out the

1751
01:41:44,370 --> 01:41:50,580
questionnaires can I ask you a question

1752
01:41:46,080 --> 01:41:54,670
name one technique at least that traps

1753
01:41:50,580 --> 01:41:57,769
agent uses for protection on the host

1754
01:41:54,670 --> 01:41:57,770
[Music]

1755
01:41:58,420 --> 01:42:03,099
anybody knows this raise your hand

1756
01:42:11,620 --> 01:42:24,830
no dialogue

1757
01:42:16,430 --> 01:42:26,570
come compromising in indicator you

1758
01:42:24,830 --> 01:42:28,940
remember what I was talking about traps

1759
01:42:26,570 --> 01:42:31,099
it has some machine learning or machine

1760
01:42:28,940 --> 01:42:34,309
learning module the sandbox module

1761
01:42:31,100 --> 01:42:35,870
another model so it has everything you

1762
01:42:34,310 --> 01:42:38,600
know vesicular it doesn't have the

1763
01:42:35,870 --> 01:42:40,550
standard signature based antivirus

1764
01:42:38,600 --> 01:42:46,420
software because it doesn't it is not

1765
01:42:40,550 --> 01:42:52,160
needed what else can you use can you use

1766
01:42:46,420 --> 01:42:54,820
other products for example other

1767
01:42:52,160 --> 01:43:00,559
benefits products from other

1768
01:42:54,820 --> 01:43:05,780
manufacturers yes or no

1769
01:43:00,560 --> 01:43:07,989
the simple answer what okay what is a

1770
01:43:05,780 --> 01:43:07,989
lock

1771
01:43:09,370 --> 01:43:17,900
what is a lock what was that I did I

1772
01:43:16,790 --> 01:43:37,750
could hear that

1773
01:43:17,900 --> 01:43:41,629
thank you and the what is B lock okay

1774
01:43:37,750 --> 01:43:44,620
now I'm going to draw randomly a

1775
01:43:41,630 --> 01:43:44,620
questionnaire

1776
01:44:03,910 --> 01:44:07,099
[Music]

1777
01:44:08,200 --> 01:44:14,330
okay I'd like to apologize it's just

1778
01:44:12,320 --> 01:44:21,070
somebody somebody who folded the list

1779
01:44:14,330 --> 01:44:21,070
okay let's let me take this one out and

1780
01:44:21,790 --> 01:44:30,190
keep the beginning cognizant okay here's

1781
01:44:26,690 --> 01:44:32,540
a price for you okay

1782
01:44:30,190 --> 01:44:40,969
this gentleman is gonna go back home

1783
01:44:32,540 --> 01:44:48,769
with a price okay four more if you're

1784
01:44:40,970 --> 01:44:50,960
not caught off mister net worth or as

1785
01:44:48,770 --> 01:44:59,230
rs10 for a row man all right

1786
01:44:50,960 --> 01:44:59,230
yes and three more prizes

1787
01:45:02,040 --> 01:45:06,689
[Music]

1788
01:45:08,920 --> 01:45:18,850
Vladimir first book chick okay

1789
01:45:14,960 --> 01:45:18,850
congratulations and tour

1790
01:45:20,830 --> 01:45:44,269
Alexander Lukashenko and one last but

1791
01:45:33,470 --> 01:45:49,040
not least Alexeevich Pauline come the

1792
01:45:44,270 --> 01:45:53,510
last price goes to a taxi okay let's

1793
01:45:49,040 --> 01:45:55,690
give him a big round of applause so

1794
01:45:53,510 --> 01:45:59,450
congratulations to a prize winners

1795
01:45:55,690 --> 01:46:04,419
thanks very much to everybody so a peace

1796
01:45:59,450 --> 01:46:04,420
and security to all of you thank you

