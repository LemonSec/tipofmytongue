1
00:00:01,580 --> 00:00:08,010
hi everybody happy to see you so many

2
00:00:05,310 --> 00:00:12,149
people came to my presentation I have I

3
00:00:08,010 --> 00:00:15,149
have two good news bad news so good news

4
00:00:12,150 --> 00:00:18,720
is that we went through the OD red tape

5
00:00:15,150 --> 00:00:22,740
and what I'm describing so is it on your

6
00:00:18,720 --> 00:00:24,930
table so it's there and then Tennessee

7
00:00:22,740 --> 00:00:27,000
Linux that we have been waiting since

8
00:00:24,930 --> 00:00:28,849
last year so well gained just to put it

9
00:00:27,000 --> 00:00:32,130
all in and the bad news that

10
00:00:28,849 --> 00:00:36,090
unfortunately I forgot to visit our

11
00:00:32,130 --> 00:00:39,210
department was stuff didn't get any any

12
00:00:36,090 --> 00:00:41,940
bonus codes any badges that's why if you

13
00:00:39,210 --> 00:00:43,829
see a wargaming and if you wanted to get

14
00:00:41,940 --> 00:00:46,709
the code for the tanks unfortunately I

15
00:00:43,829 --> 00:00:50,390
don't have it so I forgot it I left it

16
00:00:46,710 --> 00:00:52,949
at the office I have not picked it up so

17
00:00:50,390 --> 00:00:57,329
traditionally that's my name is Ivana

18
00:00:52,949 --> 00:01:00,180
Kharkov I am involved in a security have

19
00:00:57,329 --> 00:01:02,180
been in security for the last 15 years

20
00:01:00,180 --> 00:01:05,129
and wargaming

21
00:01:02,180 --> 00:01:07,140
and then I'm a maintenance maintenance

22
00:01:05,129 --> 00:01:12,920
is a Department of wargaming that's

23
00:01:07,140 --> 00:01:19,920
responsible for all server capacities

24
00:01:12,920 --> 00:01:23,369
for web for operation several servers so

25
00:01:19,920 --> 00:01:29,009
there are about 6,000 different pieces

26
00:01:23,369 --> 00:01:32,280
of hardware and 15 20 offices virtual

27
00:01:29,009 --> 00:01:36,689
machines etc so we operate at all and I

28
00:01:32,280 --> 00:01:41,670
and I just do security of it all and

29
00:01:36,689 --> 00:01:44,008
last year I I came to pH days so then I

30
00:01:41,670 --> 00:01:45,930
talked about enforcing with Linux we

31
00:01:44,009 --> 00:01:48,840
spoke about that about our critical

32
00:01:45,930 --> 00:01:50,759
systems product systems and today I'm

33
00:01:48,840 --> 00:01:53,570
gay just to talk about how we do the

34
00:01:50,759 --> 00:01:56,909
dynamic firewall and how it turned out

35
00:01:53,570 --> 00:01:59,969
so we have the contacts in the lower

36
00:01:56,909 --> 00:02:02,090
left hand corner so you can always so

37
00:01:59,969 --> 00:02:05,669
contact me through telegram

38
00:02:02,090 --> 00:02:08,399
so for you to understand how we have

39
00:02:05,670 --> 00:02:10,949
come to it and why we decided to do the

40
00:02:08,399 --> 00:02:12,900
dynamic fire world while were not happy

41
00:02:10,949 --> 00:02:15,030
with the standard firewall so let me

42
00:02:12,900 --> 00:02:17,700
explain how our network has been

43
00:02:15,030 --> 00:02:21,570
developing how company has been evolving

44
00:02:17,700 --> 00:02:25,470
so you can see the number of servers of

45
00:02:21,570 --> 00:02:28,890
a wargaming company since it started to

46
00:02:25,470 --> 00:02:32,250
grow quickly so after the tanks were

47
00:02:28,890 --> 00:02:37,470
marketed so we had future servers that

48
00:02:32,250 --> 00:02:39,870
was 2010 and then 2000 hosts every year

49
00:02:37,470 --> 00:02:42,180
so that was our annual growth so they

50
00:02:39,870 --> 00:02:44,340
don't have 20,000 hosts we have right

51
00:02:42,180 --> 00:02:45,930
now and will grow very rapid it's only

52
00:02:44,340 --> 00:02:49,110
production I'm not talking about laptops

53
00:02:45,930 --> 00:02:51,800
or office printers but it's only hosts

54
00:02:49,110 --> 00:02:54,510
where we have our games running and

55
00:02:51,800 --> 00:02:58,080
originally our network model looked like

56
00:02:54,510 --> 00:03:00,560
this so we had back-end so then so we

57
00:02:58,080 --> 00:03:02,790
had this this network on 50 servers

58
00:03:00,560 --> 00:03:03,239
everyone is fine that could be done

59
00:03:02,790 --> 00:03:05,070
anything

60
00:03:03,239 --> 00:03:09,420
everyone is happy then we have front-end

61
00:03:05,070 --> 00:03:12,359
we have only bad guys deny all hello by

62
00:03:09,420 --> 00:03:14,940
exception and then ever and there is a

63
00:03:12,360 --> 00:03:17,489
big firewall and in 2010 this model

64
00:03:14,940 --> 00:03:20,970
worked very well so then we started to

65
00:03:17,489 --> 00:03:27,420
have staging staging is it's where I can

66
00:03:20,970 --> 00:03:31,590
test different services and and and it

67
00:03:27,420 --> 00:03:33,059
was the first VLAN wheel an installation

68
00:03:31,590 --> 00:03:34,799
appeared and there sort of a

69
00:03:33,060 --> 00:03:38,580
surveillance cut into a

70
00:03:34,799 --> 00:03:40,019
compartmentalized and there was no

71
00:03:38,580 --> 00:03:42,810
problem no challenge so we did the

72
00:03:40,019 --> 00:03:44,400
staging sensor we insulated and there is

73
00:03:42,810 --> 00:03:47,940
no production and the same with the

74
00:03:44,400 --> 00:03:51,690
front end nothing changed then we had

75
00:03:47,940 --> 00:03:53,400
for our partners yeah third party

76
00:03:51,690 --> 00:03:56,579
companies that started to buy services

77
00:03:53,400 --> 00:03:58,950
over by their services and they put them

78
00:03:56,580 --> 00:04:02,370
into production and so then console

79
00:03:58,950 --> 00:04:04,798
tanks with Microsoft then prepares tanks

80
00:04:02,370 --> 00:04:07,709
I would pay a cent and all the services

81
00:04:04,799 --> 00:04:10,380
I saw there we need to insulate it even

82
00:04:07,709 --> 00:04:13,050
more so we still use the lens for that

83
00:04:10,380 --> 00:04:13,890
and the sir budget it was turning into a

84
00:04:13,050 --> 00:04:17,070
problem already

85
00:04:13,890 --> 00:04:21,419
so it was developing into an issue then

86
00:04:17,070 --> 00:04:23,210
and some time later we got some partners

87
00:04:21,420 --> 00:04:27,060
front-end partners

88
00:04:23,210 --> 00:04:29,430
depends and then we had a where our F's

89
00:04:27,060 --> 00:04:31,350
appeared as well so then it's a real

90
00:04:29,430 --> 00:04:34,110
answer they're small not fashionable

91
00:04:31,350 --> 00:04:36,120
anymore let's add virtual networks so

92
00:04:34,110 --> 00:04:40,200
then I started to grow to continue and

93
00:04:36,120 --> 00:04:43,980
eventually now so our network or here we

94
00:04:40,200 --> 00:04:47,969
lands where rafts and as a raft and a

95
00:04:43,980 --> 00:04:50,220
HCl so scores of thousands and so this

96
00:04:47,970 --> 00:04:51,600
is why our neo sees that's exactly what

97
00:04:50,220 --> 00:04:55,110
it looks like

98
00:04:51,600 --> 00:04:58,169
two more real ants and you can it's an

99
00:04:55,110 --> 00:05:01,740
isolated with more and so that's what it

100
00:04:58,169 --> 00:05:03,390
looked like and our technical that was

101
00:05:01,740 --> 00:05:06,000
more than the beauties of people

102
00:05:03,390 --> 00:05:10,440
operated and there so we realized then

103
00:05:06,000 --> 00:05:12,330
we need a new solution so let's do

104
00:05:10,440 --> 00:05:14,880
something we need new approach sure so

105
00:05:12,330 --> 00:05:19,620
what do we have so we calculated what we

106
00:05:14,880 --> 00:05:22,370
have and 24 different offices eight data

107
00:05:19,620 --> 00:05:25,919
centers around the world distributed

108
00:05:22,370 --> 00:05:30,440
data centers that mixed villa and v RF

109
00:05:25,919 --> 00:05:33,719
network but that 4,000 villains and

110
00:05:30,440 --> 00:05:35,280
sudden the in store store villains and

111
00:05:33,720 --> 00:05:38,910
then l5 brf's

112
00:05:35,280 --> 00:05:41,520
so that is purple hope that that are

113
00:05:38,910 --> 00:05:45,240
superimposed over those five those data

114
00:05:41,520 --> 00:05:47,490
centers and and then so then the some

115
00:05:45,240 --> 00:05:50,880
acquired companies but they're all

116
00:05:47,490 --> 00:05:53,520
networks with their own Knox neo C is

117
00:05:50,880 --> 00:05:55,979
with all the departments when we merged

118
00:05:53,520 --> 00:05:58,080
we acquired them and different user

119
00:05:55,979 --> 00:05:59,880
groups with different access partners

120
00:05:58,080 --> 00:06:01,500
because now they have an access to

121
00:05:59,880 --> 00:06:04,740
production sound don't have an access

122
00:06:01,500 --> 00:06:07,290
and some guys go to through internal VPN

123
00:06:04,740 --> 00:06:10,890
so then some get into there as a partner

124
00:06:07,290 --> 00:06:14,310
if it's not acquired to some as it as an

125
00:06:10,890 --> 00:06:17,159
employee so and and that we have on say

126
00:06:14,310 --> 00:06:19,680
VPNs so in back hands as well to connect

127
00:06:17,160 --> 00:06:22,110
the regions which would there are

128
00:06:19,680 --> 00:06:24,180
problems connection on the front end so

129
00:06:22,110 --> 00:06:26,580
this way we did the back end

130
00:06:24,180 --> 00:06:29,449
and then as a as a month at the bonus we

131
00:06:26,580 --> 00:06:33,150
have up to 200 new services per month

132
00:06:29,449 --> 00:06:37,529
per month and that's what needs to be

133
00:06:33,150 --> 00:06:40,258
healed and you repeatedly and then

134
00:06:37,529 --> 00:06:41,909
another sad thing as that we've done it

135
00:06:40,259 --> 00:06:43,620
we've done it actually that's good

136
00:06:41,909 --> 00:06:47,129
that's an achievement so let's talk

137
00:06:43,620 --> 00:06:51,270
about this process it's obvious that the

138
00:06:47,129 --> 00:06:53,759
system that was built so it continues to

139
00:06:51,270 --> 00:06:55,529
be it is still building and for the next

140
00:06:53,759 --> 00:06:58,740
ten years while as being an operations

141
00:06:55,529 --> 00:07:00,960
we'll be building and expanding so we

142
00:06:58,740 --> 00:07:03,120
identified the main problems that we

143
00:07:00,960 --> 00:07:05,840
needed to address so I think that the

144
00:07:03,120 --> 00:07:08,819
network and the way the VLANs a parade

145
00:07:05,840 --> 00:07:10,438
so those are the guys who used the

146
00:07:08,819 --> 00:07:13,259
networks and so they operate the

147
00:07:10,439 --> 00:07:15,659
networks we identified that we have so

148
00:07:13,259 --> 00:07:20,460
the main the main challenge for us it's

149
00:07:15,659 --> 00:07:21,810
a huge unknown uncontrolled and we don't

150
00:07:20,460 --> 00:07:23,758
know who they belong to

151
00:07:21,810 --> 00:07:25,860
unknown services not listed not

152
00:07:23,759 --> 00:07:27,719
controlled because in so there was an

153
00:07:25,860 --> 00:07:31,050
assumption in back-end we have friends

154
00:07:27,719 --> 00:07:34,889
it would just you do something in

155
00:07:31,050 --> 00:07:37,050
back-end then then later so they could

156
00:07:34,889 --> 00:07:38,639
be a lot so lots of product teams that

157
00:07:37,050 --> 00:07:43,529
are using this backyard and you're not

158
00:07:38,639 --> 00:07:46,379
even aware of that and so then missing

159
00:07:43,529 --> 00:07:48,589
missing firewall on back-end so the

160
00:07:46,379 --> 00:07:51,689
trusted began we trust them all the

161
00:07:48,589 --> 00:07:53,639
isolation on neuroses the last very rare

162
00:07:51,689 --> 00:07:57,149
so we trust everyone on back-end

163
00:07:53,639 --> 00:07:59,699
then missing so then that missing access

164
00:07:57,149 --> 00:08:02,699
control for back-end services so then

165
00:07:59,699 --> 00:08:05,250
when all the services were developed for

166
00:08:02,699 --> 00:08:08,159
the internal IP so we can consider that

167
00:08:05,250 --> 00:08:10,979
everyone was good and we had 50 servers

168
00:08:08,159 --> 00:08:13,080
and you have the IP port and how to to

169
00:08:10,979 --> 00:08:15,508
do a query with the URL so you can get

170
00:08:13,080 --> 00:08:19,229
anything you want and may do a lot of

171
00:08:15,509 --> 00:08:21,419
interesting things and and it is why and

172
00:08:19,229 --> 00:08:24,270
then a special problem its vendors

173
00:08:21,419 --> 00:08:26,490
problem that we didn't have a service

174
00:08:24,270 --> 00:08:28,590
catalog so that you find a rabbit

175
00:08:26,490 --> 00:08:30,180
it's a big problem or someone I could

176
00:08:28,590 --> 00:08:32,159
not find it and then they raise their

177
00:08:30,180 --> 00:08:34,200
own and then and then we have five

178
00:08:32,159 --> 00:08:37,080
erasers in one region so this way they

179
00:08:34,200 --> 00:08:40,050
could find and they made their own and

180
00:08:37,080 --> 00:08:43,320
then we started to to address this issue

181
00:08:40,049 --> 00:08:44,910
starting from the last one what is our

182
00:08:43,320 --> 00:08:50,700
discovery raise your hand what is

183
00:08:44,910 --> 00:08:51,920
service discovery cool then you tell me

184
00:08:50,700 --> 00:08:54,720
what that is

185
00:08:51,920 --> 00:08:57,329
so the way I understand it service

186
00:08:54,720 --> 00:08:58,860
discover because all this that are quite

187
00:08:57,330 --> 00:09:01,620
convoluted service discovery as I

188
00:08:58,860 --> 00:09:04,709
understand is an idea that you take and

189
00:09:01,620 --> 00:09:06,750
all our services that we have that we

190
00:09:04,709 --> 00:09:10,260
registered them in a special database

191
00:09:06,750 --> 00:09:14,070
and then we have several standard

192
00:09:10,260 --> 00:09:15,720
queries and the first query is to

193
00:09:14,070 --> 00:09:19,410
register the service right when I

194
00:09:15,720 --> 00:09:22,050
launched my scaling and I go to the base

195
00:09:19,410 --> 00:09:24,560
data database and there's a my scaling

196
00:09:22,050 --> 00:09:27,390
this is my port is my name master slave

197
00:09:24,560 --> 00:09:30,479
with a primary secondary so I have it

198
00:09:27,390 --> 00:09:33,149
all and and it's there it lives there we

199
00:09:30,480 --> 00:09:38,579
can just address so it's called in the

200
00:09:33,149 --> 00:09:41,010
Service registration query and then then

201
00:09:38,579 --> 00:09:46,140
there is D registration of the service

202
00:09:41,010 --> 00:09:48,720
dear-dear registration and and this is

203
00:09:46,140 --> 00:09:51,510
why I declined when he wants in my scale

204
00:09:48,720 --> 00:09:54,209
so where is this of my exhale max Yale

205
00:09:51,510 --> 00:09:55,980
is is here his is here if you want this

206
00:09:54,209 --> 00:09:58,260
you wanted here you can find here you

207
00:09:55,980 --> 00:10:00,959
know the not EF scale you find it by

208
00:09:58,260 --> 00:10:03,870
someplace else then any server can can

209
00:10:00,959 --> 00:10:07,010
ask you where is it that that that I

210
00:10:03,870 --> 00:10:10,560
have to have and what should be just

211
00:10:07,010 --> 00:10:13,500
working so for example I fell it and I

212
00:10:10,560 --> 00:10:20,520
rose to my feet I sort is it that I have

213
00:10:13,500 --> 00:10:24,089
not registered and it will introduce the

214
00:10:20,520 --> 00:10:27,060
service discovery and make people use it

215
00:10:24,089 --> 00:10:27,900
so then we cover at point number four

216
00:10:27,060 --> 00:10:29,640
and

217
00:10:27,900 --> 00:10:32,880
we'll have a catalog where we can find

218
00:10:29,640 --> 00:10:36,120
any service Assad and the first Saudi

219
00:10:32,880 --> 00:10:38,040
bees came to us they were the first and

220
00:10:36,120 --> 00:10:40,110
so even before the appearance of the

221
00:10:38,040 --> 00:10:41,939
idea of do the firewall the dynamic

222
00:10:40,110 --> 00:10:44,460
firewall they came to us those guys said

223
00:10:41,940 --> 00:10:48,089
we know the service catalog they said we

224
00:10:44,460 --> 00:10:49,350
have three thousand databases and and

225
00:10:48,089 --> 00:10:50,880
vanilla service catalog we need to

226
00:10:49,350 --> 00:10:54,570
understand and make sense of those

227
00:10:50,880 --> 00:10:57,120
databases and that we found it and start

228
00:10:54,570 --> 00:10:59,040
to test them and then I got an idea what

229
00:10:57,120 --> 00:11:01,170
do you have a service catalog and we

230
00:10:59,040 --> 00:11:04,290
know all the services in the kettle and

231
00:11:01,170 --> 00:11:07,439
every server registers its services so

232
00:11:04,290 --> 00:11:09,209
let's let's let's deny aim to do the

233
00:11:07,440 --> 00:11:11,100
services that that are not registered

234
00:11:09,210 --> 00:11:12,990
and then there will be no situation

235
00:11:11,100 --> 00:11:15,960
whereby there's a service that doesn't

236
00:11:12,990 --> 00:11:18,600
exist that is not registered that's it

237
00:11:15,960 --> 00:11:20,640
and then so then we address the first

238
00:11:18,600 --> 00:11:22,920
it's either registered the services are

239
00:11:20,640 --> 00:11:25,080
anyone know about it or it doesn't get

240
00:11:22,920 --> 00:11:30,060
an access how to do that so let's

241
00:11:25,080 --> 00:11:32,730
generate rules and so then when you

242
00:11:30,060 --> 00:11:35,040
register service you do the supports and

243
00:11:32,730 --> 00:11:36,720
different attributes attributes and so

244
00:11:35,040 --> 00:11:38,849
it can take and on the basis of the

245
00:11:36,720 --> 00:11:41,130
other data for this specific host and

246
00:11:38,850 --> 00:11:44,520
its services to generate the rules for

247
00:11:41,130 --> 00:11:48,209
the backend and these are rules for this

248
00:11:44,520 --> 00:11:50,670
hose can be brought at to to this host

249
00:11:48,209 --> 00:11:52,469
so this is this is what we get dynamics

250
00:11:50,670 --> 00:11:54,390
and firewall server register the service

251
00:11:52,470 --> 00:11:57,720
what's not registered we block what is

252
00:11:54,390 --> 00:12:00,449
registered we allow and then there's

253
00:11:57,720 --> 00:12:02,580
only one a question access control so we

254
00:12:00,450 --> 00:12:04,730
know that's for HTTP so there are many

255
00:12:02,580 --> 00:12:07,140
many ways to make access control

256
00:12:04,730 --> 00:12:11,700
transparent for applications so take

257
00:12:07,140 --> 00:12:12,569
your eyes tokens etc so by there is a

258
00:12:11,700 --> 00:12:14,220
subtlety

259
00:12:12,570 --> 00:12:16,170
we need to do it all transparent not

260
00:12:14,220 --> 00:12:17,700
only for the server application but for

261
00:12:16,170 --> 00:12:22,380
the client and that's the problem

262
00:12:17,700 --> 00:12:24,810
so because to do for tanks proxy that

263
00:12:22,380 --> 00:12:27,480
would be like tokens so that's not a

264
00:12:24,810 --> 00:12:29,250
good idea from a tokens to them so I

265
00:12:27,480 --> 00:12:31,560
said like I said like a supplication if

266
00:12:29,250 --> 00:12:33,630
you do it for a ps4

267
00:12:31,560 --> 00:12:35,189
eight years ago so the certain is not

268
00:12:33,630 --> 00:12:37,649
worth doing it

269
00:12:35,190 --> 00:12:39,870
and that is why so the only federal

270
00:12:37,649 --> 00:12:42,690
transparent filtration is the filtration

271
00:12:39,870 --> 00:12:45,959
at the network level and and as

272
00:12:42,690 --> 00:12:49,560
similarily to her to the service

273
00:12:45,959 --> 00:12:52,109
discovery so we thought up a new ID of

274
00:12:49,560 --> 00:12:55,109
client discovery the idea is as follows

275
00:12:52,110 --> 00:12:56,670
so we collect from the clients the

276
00:12:55,110 --> 00:12:59,550
informational kind of service they want

277
00:12:56,670 --> 00:13:02,550
to get so let's say somewhere look like

278
00:12:59,550 --> 00:13:06,540
IP shape and then we take the IP

279
00:13:02,550 --> 00:13:09,240
addresses engineer a dynamic lists for

280
00:13:06,540 --> 00:13:10,769
each service and then bring him to the

281
00:13:09,240 --> 00:13:15,360
service to the service that launched

282
00:13:10,769 --> 00:13:17,939
this services and this will decline so

283
00:13:15,360 --> 00:13:21,509
when he wants to to get into a service

284
00:13:17,939 --> 00:13:23,759
user so yeah - Cal - Cal for a certain

285
00:13:21,509 --> 00:13:26,129
production one I want this data date

286
00:13:23,759 --> 00:13:29,339
database please give it to me and then

287
00:13:26,129 --> 00:13:35,000
so then the base of the service

288
00:13:29,339 --> 00:13:38,519
discovery so stores it in its own Us

289
00:13:35,000 --> 00:13:40,980
store facility then and then show me

290
00:13:38,519 --> 00:13:42,660
show me my roles so together with their

291
00:13:40,980 --> 00:13:46,680
own so they get is the list of the

292
00:13:42,660 --> 00:13:48,899
clients and they generate IP sets and so

293
00:13:46,680 --> 00:13:51,660
thus so we have this interesting routing

294
00:13:48,899 --> 00:13:53,519
system so because we knew that the

295
00:13:51,660 --> 00:13:56,759
service discovery would have a console

296
00:13:53,519 --> 00:14:00,930
we knew that by console because console

297
00:13:56,759 --> 00:14:04,050
there are two big s software for search

298
00:14:00,930 --> 00:14:09,180
discovery which is a zookeeper console

299
00:14:04,050 --> 00:14:15,750
GCD a zookeeper has an amazing capacity

300
00:14:09,180 --> 00:14:19,589
of break and collapsing it's a if there

301
00:14:15,750 --> 00:14:21,720
is 20 milliseconds delay on the storing

302
00:14:19,589 --> 00:14:25,350
time on the desk so then immediately

303
00:14:21,720 --> 00:14:28,170
starts to fall and and that was since a

304
00:14:25,350 --> 00:14:30,149
sharing shared storing circles and then

305
00:14:28,170 --> 00:14:31,559
it would cluster well that's why we

306
00:14:30,149 --> 00:14:33,540
didn't like it that's why we selected

307
00:14:31,559 --> 00:14:35,969
console we had good experience of

308
00:14:33,540 --> 00:14:37,559
console so because of this delay and

309
00:14:35,970 --> 00:14:40,889
failure they were distorting

310
00:14:37,559 --> 00:14:43,990
so we we we stopped using the previous

311
00:14:40,889 --> 00:14:46,720
one so then IP IP sense that I've been

312
00:14:43,990 --> 00:14:48,910
is is the AP tables on top of a

313
00:14:46,720 --> 00:14:52,120
container where you can store in

314
00:14:48,910 --> 00:14:55,089
hash-table the the list of addresses up

315
00:14:52,120 --> 00:14:57,850
to fifty six thousand two dresses why

316
00:14:55,090 --> 00:14:59,830
it's good because IP table is in there

317
00:14:57,850 --> 00:15:02,200
is ten thousand rules so that each

318
00:14:59,830 --> 00:15:05,800
package so we'll go through the ten

319
00:15:02,200 --> 00:15:08,890
thousand comparisons but hash table is

320
00:15:05,800 --> 00:15:11,829
not linear and suresh table is much

321
00:15:08,890 --> 00:15:14,470
faster it speeds up the work of the

322
00:15:11,830 --> 00:15:18,580
network so i all the services turned and

323
00:15:14,470 --> 00:15:21,430
took the rules AP AP AP tables and that

324
00:15:18,580 --> 00:15:22,150
is a drop project that's the whole

325
00:15:21,430 --> 00:15:27,880
concept

326
00:15:22,150 --> 00:15:32,530
and then yeah so this is the whole

327
00:15:27,880 --> 00:15:34,540
concept so we select the all the old and

328
00:15:32,530 --> 00:15:37,140
all of them so let's start with console

329
00:15:34,540 --> 00:15:40,459
so who workers console

330
00:15:37,140 --> 00:15:40,460
[Music]

331
00:15:44,870 --> 00:15:50,490
okay then that's a good machine though

332
00:15:48,900 --> 00:15:52,260
is strange from the viewpoint of

333
00:15:50,490 --> 00:15:53,940
implementation but at that time we

334
00:15:52,260 --> 00:15:56,160
didn't have anything better and even now

335
00:15:53,940 --> 00:15:58,800
don't have anything better either and

336
00:15:56,160 --> 00:16:01,319
let's see how the network works so we

337
00:15:58,800 --> 00:16:05,760
have a data center so in this data

338
00:16:01,320 --> 00:16:09,300
center we set up two servers so it's the

339
00:16:05,760 --> 00:16:11,610
top usually odd number so that's to get

340
00:16:09,300 --> 00:16:13,290
the consensus about two servers if there

341
00:16:11,610 --> 00:16:16,230
is no connection they may think that

342
00:16:13,290 --> 00:16:20,339
each of them is leader and and starts

343
00:16:16,230 --> 00:16:23,940
writing and synchronized to data so then

344
00:16:20,340 --> 00:16:26,910
that's - it does have - and each of

345
00:16:23,940 --> 00:16:28,860
which so we connected some clients and

346
00:16:26,910 --> 00:16:34,680
that's how a traditional it looks like

347
00:16:28,860 --> 00:16:37,800
and then magic starts it's it's when the

348
00:16:34,680 --> 00:16:41,310
client start to discover each other and

349
00:16:37,800 --> 00:16:46,109
create this one arranged billing network

350
00:16:41,310 --> 00:16:49,709
on ghost IP protocol based and so it's

351
00:16:46,110 --> 00:16:52,110
convenient because we can one data

352
00:16:49,710 --> 00:16:57,180
center around 3,000 nodes and other data

353
00:16:52,110 --> 00:16:59,310
that 6000 nodes and if everyone goes for

354
00:16:57,180 --> 00:17:01,560
changes to the server then the server

355
00:16:59,310 --> 00:17:03,750
will die so on especially there are many

356
00:17:01,560 --> 00:17:06,240
changes if it events it's all the old

357
00:17:03,750 --> 00:17:08,220
seniors arising and droppings services

358
00:17:06,240 --> 00:17:12,060
then it will kill so that's why when

359
00:17:08,220 --> 00:17:14,280
there is one range peering suddenly

360
00:17:12,060 --> 00:17:17,730
changes get through very quickly so the

361
00:17:14,280 --> 00:17:20,339
real time out the real time out of the

362
00:17:17,730 --> 00:17:23,970
of the rules - old house after commit is

363
00:17:20,339 --> 00:17:28,560
less than ten seconds after commit to

364
00:17:23,970 --> 00:17:30,840
commit in you commit the new role ten

365
00:17:28,560 --> 00:17:34,679
seconds and it applied everywhere I said

366
00:17:30,840 --> 00:17:37,949
so 30 seconds only and that allows you

367
00:17:34,680 --> 00:17:41,250
to quickly make changes so this this

368
00:17:37,950 --> 00:17:44,850
thing now it's called a LAN LAN data

369
00:17:41,250 --> 00:17:47,660
center so when we unite them together we

370
00:17:44,850 --> 00:17:49,429
get Federation and the connection is one

371
00:17:47,660 --> 00:17:53,090
and so the difference between land and

372
00:17:49,430 --> 00:17:54,860
web is this is so this of the each of

373
00:17:53,090 --> 00:17:58,280
which so they appear with each other

374
00:17:54,860 --> 00:18:00,139
exchange information but so but here we

375
00:17:58,280 --> 00:18:02,270
have only the servers and servers not

376
00:18:00,140 --> 00:18:04,880
the clients so the server and decline

377
00:18:02,270 --> 00:18:08,510
the difference is the service selects

378
00:18:04,880 --> 00:18:10,040
the leader and and keeps the information

379
00:18:08,510 --> 00:18:12,140
about the clients and the client does

380
00:18:10,040 --> 00:18:15,110
not participate in that but technical is

381
00:18:12,140 --> 00:18:17,360
the same product the same agent just it

382
00:18:15,110 --> 00:18:20,360
launched with different flights so all

383
00:18:17,360 --> 00:18:23,990
this on the basis of IP look on a surf

384
00:18:20,360 --> 00:18:26,959
surf IO site and so can read it you can

385
00:18:23,990 --> 00:18:31,160
use it not only from console if you want

386
00:18:26,960 --> 00:18:34,060
to yeah to do quickly peer peering

387
00:18:31,160 --> 00:18:37,670
Network so the simple protocol to use

388
00:18:34,060 --> 00:18:40,879
the next point is about selecting the

389
00:18:37,670 --> 00:18:44,660
leader so then there are questions so we

390
00:18:40,880 --> 00:18:48,290
have three servers and we have the the

391
00:18:44,660 --> 00:18:50,210
clients query as a query will not be

392
00:18:48,290 --> 00:18:52,580
processed here the service having all

393
00:18:50,210 --> 00:18:55,820
the information and the databases so it

394
00:18:52,580 --> 00:18:57,679
will not process any query unless it

395
00:18:55,820 --> 00:19:00,439
connects to other servers in the cluster

396
00:18:57,680 --> 00:19:03,950
so even after the it's connected so it

397
00:19:00,440 --> 00:19:06,890
will not process the query until it has

398
00:19:03,950 --> 00:19:11,030
selected the leader and what is the

399
00:19:06,890 --> 00:19:13,550
leader and the leader is a note so where

400
00:19:11,030 --> 00:19:15,590
are all the queries will be will be

401
00:19:13,550 --> 00:19:18,530
rerouted so if you have five servers

402
00:19:15,590 --> 00:19:21,709
then realistically only one works and

403
00:19:18,530 --> 00:19:24,770
other four have four servers they they

404
00:19:21,710 --> 00:19:26,810
have selected it that's it and so if you

405
00:19:24,770 --> 00:19:30,470
have 10 servers to say away so there's

406
00:19:26,810 --> 00:19:33,409
no balancing and so there is that there

407
00:19:30,470 --> 00:19:36,530
is only forward if at some point leader

408
00:19:33,410 --> 00:19:38,390
does not respond and then then there is

409
00:19:36,530 --> 00:19:41,180
a failure of the query so now our

410
00:19:38,390 --> 00:19:44,380
servers picks it up so that's a strange

411
00:19:41,180 --> 00:19:44,380
so request denied

412
00:19:45,559 --> 00:19:53,450
and so to scale up the server adding

413
00:19:50,840 --> 00:19:56,149
final servers to console impossible

414
00:19:53,450 --> 00:19:58,549
because so it will just because it's no

415
00:19:56,149 --> 00:20:03,049
faster than the then the weakest server

416
00:19:58,549 --> 00:20:05,269
a wall and so this sorry

417
00:20:03,049 --> 00:20:07,519
it's select the new leader quickly if

418
00:20:05,269 --> 00:20:10,009
the old one fails so than 100

419
00:20:07,519 --> 00:20:12,850
milliseconds so I immediately selects

420
00:20:10,009 --> 00:20:16,940
the new leader right away so if peirong

421
00:20:12,850 --> 00:20:22,789
broke so then there is no delay but

422
00:20:16,940 --> 00:20:25,309
about the certainly the capacity grows

423
00:20:22,789 --> 00:20:28,340
and some person cannot handle it so

424
00:20:25,309 --> 00:20:28,700
that's why the Federation is done like

425
00:20:28,340 --> 00:20:32,090
this

426
00:20:28,700 --> 00:20:36,379
so console by itself 8 incidents

427
00:20:32,090 --> 00:20:39,080
distributed database my database because

428
00:20:36,379 --> 00:20:41,149
it's done for for the service discusses

429
00:20:39,080 --> 00:20:46,309
the guy is a database it has two types

430
00:20:41,149 --> 00:20:49,580
of substances as I said timeouts watch

431
00:20:46,309 --> 00:20:54,619
cetera so the first type of service and

432
00:20:49,580 --> 00:20:57,080
this second is kV is kkb so it's a

433
00:20:54,619 --> 00:20:58,970
comprehensive substance that is the name

434
00:20:57,080 --> 00:21:03,710
of the service the nodes where it

435
00:20:58,970 --> 00:21:06,710
operates ports IP and several IPS takes

436
00:21:03,710 --> 00:21:09,139
and and then metadata and so then the

437
00:21:06,710 --> 00:21:11,749
Harris of the health check system so

438
00:21:09,139 --> 00:21:14,959
then so we can always pinpoint health

439
00:21:11,749 --> 00:21:17,840
checks and if they have failed and then

440
00:21:14,960 --> 00:21:22,070
the service automatically registers so

441
00:21:17,840 --> 00:21:25,730
then mu school in the mode of master

442
00:21:22,070 --> 00:21:27,980
master was one of the masters dies so

443
00:21:25,730 --> 00:21:30,080
then in calls the registers no the

444
00:21:27,980 --> 00:21:32,600
clients that use cost of to determine in

445
00:21:30,080 --> 00:21:35,090
which Moscow to go it goes immediately

446
00:21:32,600 --> 00:21:37,759
to another one we don't have to build

447
00:21:35,090 --> 00:21:39,439
any proxy or whatever and then there is

448
00:21:37,759 --> 00:21:42,759
no way the support the driver is needed

449
00:21:39,440 --> 00:21:48,470
so just switched it over and go forward

450
00:21:42,759 --> 00:21:51,109
so it so kV is kV so we have key key

451
00:21:48,470 --> 00:21:53,149
value key value key value that's it

452
00:21:51,109 --> 00:21:56,389
so there are some limitations on the

453
00:21:53,149 --> 00:21:58,580
touch of four megabytes per key no not

454
00:21:56,389 --> 00:22:01,260
much limitations

455
00:21:58,580 --> 00:22:03,300
replication replication between the data

456
00:22:01,260 --> 00:22:04,500
sent and no replication so each data

457
00:22:03,300 --> 00:22:07,350
center

458
00:22:04,500 --> 00:22:09,120
stores its own information if we request

459
00:22:07,350 --> 00:22:12,149
a different information they would have

460
00:22:09,120 --> 00:22:14,520
that connected to an Mumbai well as a

461
00:22:12,150 --> 00:22:19,500
way forward the query and a leader of

462
00:22:14,520 --> 00:22:20,250
the data center which we are asking to

463
00:22:19,500 --> 00:22:22,590
which you are talking

464
00:22:20,250 --> 00:22:25,620
and so then security because Security's

465
00:22:22,590 --> 00:22:28,139
our business and they have security so

466
00:22:25,620 --> 00:22:32,429
then the level protocol is just PPS K

467
00:22:28,140 --> 00:22:36,740
and so we put on all agents one key and

468
00:22:32,430 --> 00:22:39,420
if there is no key this key that then

469
00:22:36,740 --> 00:22:42,810
anyone can connect a cluster just yeah

470
00:22:39,420 --> 00:22:45,510
so I can just take your notebook connect

471
00:22:42,810 --> 00:22:48,090
to the cluster if there is no PS k then

472
00:22:45,510 --> 00:22:52,020
did not give you access without PS PS

473
00:22:48,090 --> 00:22:55,860
paste the PSC but then there is TLS I

474
00:22:52,020 --> 00:22:57,960
don't know I've never done TLS so the

475
00:22:55,860 --> 00:23:07,370
level of the protocol this this is TLS

476
00:22:57,960 --> 00:23:10,260
the PS PS k 16 16 numbers in the system

477
00:23:07,370 --> 00:23:13,379
then authorization identification we

478
00:23:10,260 --> 00:23:15,990
used tokens so there is token anonymous

479
00:23:13,380 --> 00:23:18,150
embedded so which allows to read

480
00:23:15,990 --> 00:23:20,400
everything plus there are different

481
00:23:18,150 --> 00:23:23,580
tokens which which allowed to write a

482
00:23:20,400 --> 00:23:28,770
certain projects so then you can say

483
00:23:23,580 --> 00:23:32,129
deny deny read traffic starting with

484
00:23:28,770 --> 00:23:35,550
Walter also or register or deny

485
00:23:32,130 --> 00:23:37,980
registration service starting with

486
00:23:35,550 --> 00:23:40,050
prefix session session and there's about

487
00:23:37,980 --> 00:23:42,390
they said that's enough if you have good

488
00:23:40,050 --> 00:23:45,590
naming convention so can deny

489
00:23:42,390 --> 00:23:49,320
registration and then the servers

490
00:23:45,590 --> 00:23:52,649
servers are called a data center type of

491
00:23:49,320 --> 00:23:55,399
this set of and blah blah so we take we

492
00:23:52,650 --> 00:23:58,140
give a token for data center aek's

493
00:23:55,400 --> 00:24:03,480
so the servers in eggs can be registered

494
00:23:58,140 --> 00:24:04,539
only from from with prefix ax and so now

495
00:24:03,480 --> 00:24:06,940
data center will

496
00:24:04,539 --> 00:24:08,799
you will not get any other servers that

497
00:24:06,940 --> 00:24:10,989
that connected to cluster we don't know

498
00:24:08,799 --> 00:24:14,139
from where and the so but there is

499
00:24:10,989 --> 00:24:16,149
nothing more complicated another HTTP IP

500
00:24:14,139 --> 00:24:20,639
is so that is why it's an additional

501
00:24:16,149 --> 00:24:25,948
protection so that's all about console

502
00:24:20,639 --> 00:24:25,948
now I will say help put it all together

503
00:24:26,430 --> 00:24:29,539
[Music]

504
00:24:29,999 --> 00:24:37,539
yeah so here you want some cats getting

505
00:24:35,039 --> 00:24:40,599
sore at the kittens simnet slide with

506
00:24:37,539 --> 00:24:47,289
kittens yeah please look at those dear

507
00:24:40,599 --> 00:24:49,658
dear little kittens hmm and then now an

508
00:24:47,289 --> 00:24:53,440
operation of have three big data centers

509
00:24:49,659 --> 00:24:55,989
consoles it sure which is built along

510
00:24:53,440 --> 00:24:58,149
the same lines why three and there's a

511
00:24:55,989 --> 00:25:01,119
one that one over them is our main data

512
00:24:58,149 --> 00:25:02,619
center which is called yellow so they're

513
00:25:01,119 --> 00:25:04,799
called the same but we'll call to your

514
00:25:02,619 --> 00:25:08,948
Europe Europe called Europe Russia

515
00:25:04,799 --> 00:25:13,809
Europe the United States included what

516
00:25:08,949 --> 00:25:19,690
else Singapore well we have other points

517
00:25:13,809 --> 00:25:22,509
of presence Australia as well but about

518
00:25:19,690 --> 00:25:26,440
ten thousand machines they're all

519
00:25:22,509 --> 00:25:30,729
together and about wait twenty data

520
00:25:26,440 --> 00:25:33,639
centers and one main data center then we

521
00:25:30,729 --> 00:25:35,529
have a Chinese data center separate why

522
00:25:33,639 --> 00:25:38,049
separate has the lawyers because in

523
00:25:35,529 --> 00:25:40,959
China everything should be so Chinese

524
00:25:38,049 --> 00:25:43,389
Network separate developers separate

525
00:25:40,959 --> 00:25:44,799
everything separate talk to the words

526
00:25:43,389 --> 00:25:47,168
that's that's the law

527
00:25:44,799 --> 00:25:52,239
yeah you cannot just connect their

528
00:25:47,169 --> 00:25:55,539
networks without networks in a DNS and

529
00:25:52,239 --> 00:25:58,479
then as interest so you don't do it or

530
00:25:55,539 --> 00:25:59,860
just a big big Chinese firewall punishes

531
00:25:58,479 --> 00:26:03,429
you right away

532
00:25:59,860 --> 00:26:06,610
and they saw that doesn't like inch we

533
00:26:03,429 --> 00:26:10,720
have ten attend the 1,000 machines and

534
00:26:06,610 --> 00:26:13,809
ten and then a servers they attend

535
00:26:10,720 --> 00:26:16,929
datacenters then staging and staging is

536
00:26:13,809 --> 00:26:19,389
so a partner systems what is not

537
00:26:16,929 --> 00:26:22,390
production what is for testing offices I

538
00:26:19,390 --> 00:26:25,510
don't remember exactly so that would put

539
00:26:22,390 --> 00:26:30,880
everything what we could into it it's a

540
00:26:25,510 --> 00:26:33,850
data center with the Federation of

541
00:26:30,880 --> 00:26:36,909
consoles divided into two unequal groups

542
00:26:33,850 --> 00:26:39,969
one is what to call main and another one

543
00:26:36,909 --> 00:26:42,039
is the regular data center where the

544
00:26:39,970 --> 00:26:45,510
nodes are registered and their services

545
00:26:42,039 --> 00:26:49,658
I registered them so we are in isolated

546
00:26:45,510 --> 00:26:53,440
isolated piece of network where we store

547
00:26:49,659 --> 00:26:56,260
the data for authorization for

548
00:26:53,440 --> 00:26:58,510
management access access management

549
00:26:56,260 --> 00:27:03,120
client discovery store so their roles

550
00:26:58,510 --> 00:27:03,120
are generated for firewall there and

551
00:27:03,840 --> 00:27:09,100
then it works on different isolated

552
00:27:06,519 --> 00:27:11,620
machines no one has an axis and then

553
00:27:09,100 --> 00:27:13,870
Selene X is there and other security

554
00:27:11,620 --> 00:27:17,018
measures are out there so if you get an

555
00:27:13,870 --> 00:27:20,469
access to this then it will be very bad

556
00:27:17,019 --> 00:27:22,809
it will be a calamity so then the

557
00:27:20,470 --> 00:27:25,529
regular data center said it's an agent

558
00:27:22,809 --> 00:27:29,168
on any management machine so DNS server

559
00:27:25,529 --> 00:27:31,029
inside inside hitch region so there are

560
00:27:29,169 --> 00:27:34,960
some redundant the service management

561
00:27:31,029 --> 00:27:37,090
machines etc and satisfy this agent that

562
00:27:34,960 --> 00:27:39,549
does not store anything important and

563
00:27:37,090 --> 00:27:42,428
just has the lists of other agents of

564
00:27:39,549 --> 00:27:45,850
their data center and a list of their

565
00:27:42,429 --> 00:27:48,039
services if tomorrow he dies so you can

566
00:27:45,850 --> 00:27:50,769
always get a new one and register all

567
00:27:48,039 --> 00:27:54,429
the services in you so nothing nothing

568
00:27:50,769 --> 00:27:56,260
nothing horrible will happen so in the

569
00:27:54,429 --> 00:27:58,419
replication between the data center does

570
00:27:56,260 --> 00:28:00,490
not exist at the specifics of console I

571
00:27:58,419 --> 00:28:02,830
sell backup everything and the compass

572
00:28:00,490 --> 00:28:05,049
is a small file which looks like a

573
00:28:02,830 --> 00:28:07,629
backup console here in coastal store

574
00:28:05,049 --> 00:28:09,350
that's it very convenient so every hour

575
00:28:07,630 --> 00:28:14,210
just way restoring the sir

576
00:28:09,350 --> 00:28:17,350
in a different compartment so then what

577
00:28:14,210 --> 00:28:20,570
we refer to as the list of scripts and

578
00:28:17,350 --> 00:28:23,659
so then it could be done at scripts on

579
00:28:20,570 --> 00:28:25,789
bas but were a big coming we cannot bash

580
00:28:23,660 --> 00:28:32,929
farewell Manish we cannot recursion that

581
00:28:25,789 --> 00:28:37,070
is why so we did a different level first

582
00:28:32,929 --> 00:28:39,650
thing we did that is a is an agent an

583
00:28:37,070 --> 00:28:43,149
agent and launched on every note where

584
00:28:39,650 --> 00:28:46,220
there is console and it manages firewall

585
00:28:43,150 --> 00:28:47,409
so the second point is synchronization

586
00:28:46,220 --> 00:28:50,299
synchronizer

587
00:28:47,409 --> 00:28:53,000
synchronizer is it does not do one thing

588
00:28:50,299 --> 00:28:55,820
so it just transfers data from files to

589
00:28:53,000 --> 00:28:57,919
console back and there so then all our

590
00:28:55,820 --> 00:29:00,408
service so once you don't know we are

591
00:28:57,919 --> 00:29:02,659
castrate or all our servers with puppet

592
00:29:00,409 --> 00:29:05,539
do you know about puppet hands up yeah

593
00:29:02,659 --> 00:29:07,640
more people know so the puppet system of

594
00:29:05,539 --> 00:29:10,400
configuration management system allowing

595
00:29:07,640 --> 00:29:12,830
you to write a profile once that I need

596
00:29:10,400 --> 00:29:14,630
this and this and that and configure and

597
00:29:12,830 --> 00:29:17,720
setting and push the button and never

598
00:29:14,630 --> 00:29:19,549
repeat it again so with our number of

599
00:29:17,720 --> 00:29:26,059
servers are all main roles have been

600
00:29:19,549 --> 00:29:27,559
disk so if you don't have this puppet in

601
00:29:26,059 --> 00:29:27,950
the product system and you want to

602
00:29:27,559 --> 00:29:30,379
deploy

603
00:29:27,950 --> 00:29:38,330
you can just write single for Europe

604
00:29:30,380 --> 00:29:40,669
things achieve fancy and alliances so

605
00:29:38,330 --> 00:29:43,490
when we started thinking how to write

606
00:29:40,669 --> 00:29:45,860
rules with bigger network we invented a

607
00:29:43,490 --> 00:29:50,299
Lessing so it's the same rule but inside

608
00:29:45,860 --> 00:29:53,149
it does not have IP clients but IP what

609
00:29:50,299 --> 00:29:57,740
it masks so Ali Elias officer contains

610
00:29:53,150 --> 00:30:01,130
inside a hundred of office IP so for

611
00:29:57,740 --> 00:30:03,320
instance IP address SS so 24 offices

612
00:30:01,130 --> 00:30:07,490
every has two channels plus backup and

613
00:30:03,320 --> 00:30:10,129
it means that we have 100 IP IP it would

614
00:30:07,490 --> 00:30:12,350
be stupid to write them every time to

615
00:30:10,130 --> 00:30:14,870
list them once we wanted to open access

616
00:30:12,350 --> 00:30:18,379
from office so that's why we invented LS

617
00:30:14,870 --> 00:30:21,379
in soaps Elias so this script just makes

618
00:30:18,380 --> 00:30:23,419
them I'll tell you later how and

619
00:30:21,380 --> 00:30:25,400
but better that combines at all and

620
00:30:23,419 --> 00:30:28,610
allows you to bring the necessary

621
00:30:25,400 --> 00:30:31,760
consult to when necessary config files

622
00:30:28,610 --> 00:30:34,850
and the launch the services and no magic

623
00:30:31,760 --> 00:30:37,250
if you worked with puppets you know so

624
00:30:34,850 --> 00:30:39,199
you described which I just tried you

625
00:30:37,250 --> 00:30:43,100
watch the service here they are the

626
00:30:39,200 --> 00:30:48,530
largest part is an agent it's developed

627
00:30:43,100 --> 00:30:50,629
in Gua and i 100% wrote that I am NOT an

628
00:30:48,530 --> 00:30:54,918
expert in coil when your send request

629
00:30:50,630 --> 00:31:00,049
system now don't laugh at me because

630
00:30:54,919 --> 00:31:04,880
what it makes it to two things first it

631
00:31:00,049 --> 00:31:07,970
goes to the console asks what servers do

632
00:31:04,880 --> 00:31:10,730
you have active here what are the port

633
00:31:07,970 --> 00:31:14,360
so what needs to be done and generates

634
00:31:10,730 --> 00:31:16,909
the IP tables of rules and IP set rules

635
00:31:14,360 --> 00:31:19,639
from them and there you can see from the

636
00:31:16,909 --> 00:31:22,610
picture for each servers it will require

637
00:31:19,640 --> 00:31:24,890
ASCII W information about the client and

638
00:31:22,610 --> 00:31:26,229
then generate and collect and that makes

639
00:31:24,890 --> 00:31:31,700
IP set list

640
00:31:26,230 --> 00:31:36,919
that's first part simple and the second

641
00:31:31,700 --> 00:31:39,260
part it from puppet when we want well

642
00:31:36,919 --> 00:31:41,120
you can register service in different

643
00:31:39,260 --> 00:31:45,230
ways for instance you can go to console

644
00:31:41,120 --> 00:31:48,889
IP and just say we we have a service

645
00:31:45,230 --> 00:31:51,860
here you can raise the service sell dogs

646
00:31:48,890 --> 00:31:53,780
like I'm choosing plus a word support

647
00:31:51,860 --> 00:31:56,689
console out-of-the-box there are

648
00:31:53,780 --> 00:32:00,918
products as that can work out of the box

649
00:31:56,690 --> 00:32:04,190
a young you know fashionable but all the

650
00:32:00,919 --> 00:32:06,409
old I cannot if you have a new product

651
00:32:04,190 --> 00:32:09,169
that you can say go and register we

652
00:32:06,409 --> 00:32:11,750
added the opportunity in fact justo

653
00:32:09,169 --> 00:32:15,830
state you know in the necessary clause a

654
00:32:11,750 --> 00:32:19,820
piece a piece and the server and the

655
00:32:15,830 --> 00:32:22,520
agent are will somehow register in order

656
00:32:19,820 --> 00:32:24,500
to make the life of developers simple

657
00:32:22,520 --> 00:32:26,480
because they don't want to understand

658
00:32:24,500 --> 00:32:30,549
what the console or no console it's it's

659
00:32:26,480 --> 00:32:33,289
not easy and sinker

660
00:32:30,549 --> 00:32:35,418
does the same thing but for the client

661
00:32:33,289 --> 00:32:38,389
when I want to get access to some

662
00:32:35,419 --> 00:32:39,200
service I say I want to be a client of

663
00:32:38,389 --> 00:32:42,610
this service

664
00:32:39,200 --> 00:32:45,980
tinker will recognize me my IP address

665
00:32:42,610 --> 00:32:48,709
and what service I want to access and

666
00:32:45,980 --> 00:32:53,529
get it from puppet DB and put it onto a

667
00:32:48,710 --> 00:32:56,389
console in in and then again it's simple

668
00:32:53,529 --> 00:33:02,809
if you don't have puppets you don't need

669
00:32:56,389 --> 00:33:06,139
puppet Elias is even simpler it will

670
00:33:02,809 --> 00:33:08,509
collect information from whatever

671
00:33:06,139 --> 00:33:11,330
databases we have rights from front

672
00:33:08,509 --> 00:33:18,200
front end whatever it will collect and

673
00:33:11,330 --> 00:33:20,990
put together into in in this way so the

674
00:33:18,200 --> 00:33:26,110
IPO network lists and the numbers in the

675
00:33:20,990 --> 00:33:26,110
end if you can see they are different

676
00:33:26,470 --> 00:33:34,100
because and zero is time out because as

677
00:33:29,960 --> 00:33:36,860
we believe that there are time rolls

678
00:33:34,100 --> 00:33:38,990
timing OSA so a rule may have a timeout

679
00:33:36,860 --> 00:33:41,389
as soon as the time elapses the rule

680
00:33:38,990 --> 00:33:44,539
will be deleted automatically sync our

681
00:33:41,389 --> 00:33:47,240
canto cleaned up for that the less than

682
00:33:44,539 --> 00:33:50,059
0 it means indefinite turn out time out

683
00:33:47,240 --> 00:33:52,399
its main office IP people don't change

684
00:33:50,059 --> 00:33:57,710
and there is no sense to upgrade time

685
00:33:52,399 --> 00:33:59,449
out all the time and then it again it

686
00:33:57,710 --> 00:34:01,580
goes for their admin that work by

687
00:33:59,450 --> 00:34:04,279
default we have an admit Network with

688
00:34:01,580 --> 00:34:07,580
the direct access to servers without any

689
00:34:04,279 --> 00:34:15,069
nuts without firewalls and you get the

690
00:34:07,580 --> 00:34:18,109
access to the servers and as a way to

691
00:34:15,069 --> 00:34:22,009
smooth them they intraday implementation

692
00:34:18,109 --> 00:34:24,770
we have two working modes you understand

693
00:34:22,010 --> 00:34:27,290
why the names and how they work you

694
00:34:24,770 --> 00:34:30,230
since the permissive mode will log

695
00:34:27,290 --> 00:34:33,020
everything and block nothing so we can

696
00:34:30,230 --> 00:34:34,659
understand who is coming outside the

697
00:34:33,020 --> 00:34:37,119
rules and enforcing

698
00:34:34,659 --> 00:34:41,470
we log everything and then do reject I

699
00:34:37,119 --> 00:34:44,679
reject because if we just draw people

700
00:34:41,469 --> 00:34:47,888
them can misunderstand is it a network

701
00:34:44,679 --> 00:34:52,750
error or they are banned but in the in

702
00:34:47,889 --> 00:34:55,119
the in the reject mode they can see it

703
00:34:52,750 --> 00:34:57,760
helps us a lot when we need to deploy

704
00:34:55,119 --> 00:35:02,349
something but I'll tell you so

705
00:34:57,760 --> 00:35:05,710
additional tricks we support identify

706
00:35:02,349 --> 00:35:08,740
console watcher we have a as a common

707
00:35:05,710 --> 00:35:12,520
time of rules less than 10 seconds for

708
00:35:08,740 --> 00:35:15,819
all data centers then we wrote a client

709
00:35:12,520 --> 00:35:18,700
to a firewall g2m control to manage it

710
00:35:15,819 --> 00:35:21,788
without any route or without any things

711
00:35:18,700 --> 00:35:24,879
just like any so that any operator gba

712
00:35:21,789 --> 00:35:27,880
whatever could could come and what

713
00:35:24,880 --> 00:35:30,880
should set up something we describe it

714
00:35:27,880 --> 00:35:34,569
all in puppet and uploaded to get hub

715
00:35:30,880 --> 00:35:37,240
and you can enjoy speaking about

716
00:35:34,569 --> 00:35:39,609
deployment before all the product we

717
00:35:37,240 --> 00:35:43,328
made this permissive mode when we

718
00:35:39,609 --> 00:35:47,500
described the old service which somebody

719
00:35:43,329 --> 00:35:49,480
uses and we wait wait wait wait wait we

720
00:35:47,500 --> 00:35:52,869
gather information gather information

721
00:35:49,480 --> 00:35:59,049
and then turn on enforcing and keep her

722
00:35:52,869 --> 00:36:01,869
gathering and block someone and for

723
00:35:59,049 --> 00:36:08,589
instance we could turn on our main

724
00:36:01,869 --> 00:36:11,049
service that is single notification the

725
00:36:08,589 --> 00:36:14,589
main entry point for all notification

726
00:36:11,049 --> 00:36:17,230
all notifications returned because if we

727
00:36:14,589 --> 00:36:19,420
turn on in enforcing many clients and

728
00:36:17,230 --> 00:36:21,910
games or just report that we would never

729
00:36:19,420 --> 00:36:24,940
we never heard about it because you know

730
00:36:21,910 --> 00:36:27,460
from the well it's like we found it when

731
00:36:24,940 --> 00:36:30,670
I will use it or for instance take a

732
00:36:27,460 --> 00:36:34,210
company that we bought five years ago at

733
00:36:30,670 --> 00:36:36,730
a sale in Taiwan and developers use that

734
00:36:34,210 --> 00:36:40,000
we shall just Kineton the game would

735
00:36:36,730 --> 00:36:42,400
fall and in this mode we can do it quite

736
00:36:40,000 --> 00:36:44,799
safely for the new product naturally we

737
00:36:42,400 --> 00:36:46,560
don't have it we immediately go to end

738
00:36:44,799 --> 00:36:48,960
force turn it on and

739
00:36:46,560 --> 00:36:51,720
these are the rules of the game either

740
00:36:48,960 --> 00:36:55,470
you do it this way or your server

741
00:36:51,720 --> 00:36:58,200
doesn't get access so all servers that

742
00:36:55,470 --> 00:37:00,569
are not registered will not get access

743
00:36:58,200 --> 00:37:03,569
to the network this is the main rule of

744
00:37:00,570 --> 00:37:06,240
thumb in production now and naturally

745
00:37:03,570 --> 00:37:09,330
the managers came the whole life to say

746
00:37:06,240 --> 00:37:13,529
I see risk you ban everyone and for them

747
00:37:09,330 --> 00:37:16,319
we made several big red buttons there

748
00:37:13,530 --> 00:37:17,880
are several and there yeah there are

749
00:37:16,320 --> 00:37:20,520
people who know how to put we can

750
00:37:17,880 --> 00:37:24,860
unblock everything within 10 seconds or

751
00:37:20,520 --> 00:37:29,610
block to where for instance we had

752
00:37:24,860 --> 00:37:33,770
something in tanks you know and we we

753
00:37:29,610 --> 00:37:33,770
could bend everything within 10 seconds

754
00:37:34,700 --> 00:37:41,129
before that we had to set up senses so

755
00:37:38,490 --> 00:37:43,259
you can quickly remove as a switch to

756
00:37:41,130 --> 00:37:49,020
permissive unblock or disconnect all

757
00:37:43,260 --> 00:37:52,380
Firewall we have hello allow and deny by

758
00:37:49,020 --> 00:37:54,960
default where you can put IP addresses

759
00:37:52,380 --> 00:37:57,350
or just zero to disconnect disconnect

760
00:37:54,960 --> 00:37:59,880
firewall to switch off firewall

761
00:37:57,350 --> 00:38:01,920
completely and it looks to be seems to

762
00:37:59,880 --> 00:38:07,620
be working and the people seem to enjoy

763
00:38:01,920 --> 00:38:11,940
it and so it most important is that the

764
00:38:07,620 --> 00:38:15,150
people who are responsible with their

765
00:38:11,940 --> 00:38:18,470
money know that something can go wrong

766
00:38:15,150 --> 00:38:21,120
it's it's the risk if the people are

767
00:38:18,470 --> 00:38:23,790
have concerns you have to convince them

768
00:38:21,120 --> 00:38:26,009
that everything will be fine especially

769
00:38:23,790 --> 00:38:28,980
if it is a big company where all

770
00:38:26,010 --> 00:38:32,370
management actually seems sits somewhere

771
00:38:28,980 --> 00:38:35,250
else and once you deploy something in a

772
00:38:32,370 --> 00:38:37,140
large company unless you draw such a

773
00:38:35,250 --> 00:38:39,680
picture they will not let you do

774
00:38:37,140 --> 00:38:39,680
anything

775
00:38:40,010 --> 00:38:47,720
so the typical part is over now let me

776
00:38:43,640 --> 00:38:51,440
give you some cases and references case

777
00:38:47,720 --> 00:38:56,000
number one we have a closed cluster for

778
00:38:51,440 --> 00:38:58,460
instance elastica what did we do what

779
00:38:56,000 --> 00:39:01,700
did we used to we have elastica we add a

780
00:38:58,460 --> 00:39:04,340
node we need to write IP to all the

781
00:39:01,700 --> 00:39:06,740
hosts and then upgrade firewall

782
00:39:04,340 --> 00:39:11,360
everywhere and then so on and so forth

783
00:39:06,740 --> 00:39:14,990
and naturally it takes much time and now

784
00:39:11,360 --> 00:39:17,870
you can just say in puppet yes this is

785
00:39:14,990 --> 00:39:23,390
elastic cluster and it's thick becomes a

786
00:39:17,870 --> 00:39:25,930
client and that's it you're done in the

787
00:39:23,390 --> 00:39:25,930
next case

788
00:39:26,110 --> 00:39:32,510
searching for clients for instance you

789
00:39:29,420 --> 00:39:38,030
have a thing that we found like Kafka

790
00:39:32,510 --> 00:39:40,790
Kafka was initially used for our

791
00:39:38,030 --> 00:39:43,450
internal purposes but then we discussed

792
00:39:40,790 --> 00:39:46,700
terabytes of something because some guys

793
00:39:43,450 --> 00:39:50,259
found though that Kafka started using it

794
00:39:46,700 --> 00:39:55,189
why not and we needed to find out who

795
00:39:50,260 --> 00:39:58,040
exactly how would you don't go to admins

796
00:39:55,190 --> 00:40:00,710
and not ask them to TCP down look at the

797
00:39:58,040 --> 00:40:02,720
traffic because Kafka said something

798
00:40:00,710 --> 00:40:05,810
doesn't right if it right so then we

799
00:40:02,720 --> 00:40:08,810
shall have no space on the disk then

800
00:40:05,810 --> 00:40:12,020
resolve IP and find out who is the host

801
00:40:08,810 --> 00:40:15,230
owner go and ask them why and so on

802
00:40:12,020 --> 00:40:17,870
now you just defined the service put on

803
00:40:15,230 --> 00:40:20,300
permissive mode and sit and collect he

804
00:40:17,870 --> 00:40:22,220
will do it all for you and bring it on

805
00:40:20,300 --> 00:40:24,110
your plate this is the list these are

806
00:40:22,220 --> 00:40:26,419
the hosts and this is the owner

807
00:40:24,110 --> 00:40:31,040
everything is integrated what did we

808
00:40:26,420 --> 00:40:34,100
decide finally so we addressed four

809
00:40:31,040 --> 00:40:36,440
problems we control all the services we

810
00:40:34,100 --> 00:40:38,360
have services what don't have don't have

811
00:40:36,440 --> 00:40:40,280
access to production we control the

812
00:40:38,360 --> 00:40:44,570
client with no complete list of clients

813
00:40:40,280 --> 00:40:47,150
we can integrate so as that all our

814
00:40:44,570 --> 00:40:48,500
things we we plan to integrate towards

815
00:40:47,150 --> 00:40:50,810
all our

816
00:40:48,500 --> 00:40:54,650
products and within the next few years

817
00:40:50,810 --> 00:40:57,590
so we shall stop segmenting WOL vrf why

818
00:40:54,650 --> 00:40:59,720
do we need VF if we can just slice the

819
00:40:57,590 --> 00:41:02,630
rules by networks without making them

820
00:40:59,720 --> 00:41:06,830
virtual just do any everything on one

821
00:41:02,630 --> 00:41:10,820
flat network if you once leave with 5 V

822
00:41:06,830 --> 00:41:13,460
Fe you understand my pains yes because

823
00:41:10,820 --> 00:41:15,740
they're so difficult to handle with

824
00:41:13,460 --> 00:41:18,820
local role in routing and if you have

825
00:41:15,740 --> 00:41:22,370
thousands of her it's pain don't do it

826
00:41:18,820 --> 00:41:30,230
my advice and the way plan as a bonus to

827
00:41:22,370 --> 00:41:32,380
use BFF v4 - to stop client site VPN so

828
00:41:30,230 --> 00:41:36,170
these are the two do say things

829
00:41:32,380 --> 00:41:39,800
everything is in github you can send us

830
00:41:36,170 --> 00:41:44,330
comments or questions we are open to

831
00:41:39,800 --> 00:41:49,150
proposals and discussions I think I am

832
00:41:44,330 --> 00:41:49,150
done and thank you for your attention

833
00:41:51,520 --> 00:41:58,750
so this is a link take photos and you

834
00:41:56,180 --> 00:41:58,750
can ask questions

835
00:42:35,710 --> 00:42:41,470
no is Nigella magelia to the back end of

836
00:42:38,290 --> 00:42:44,589
most equipment computer storage or too

837
00:42:41,470 --> 00:42:47,348
much motion front that's a moment we

838
00:42:44,589 --> 00:42:50,828
decided that we used to do it on

839
00:42:47,349 --> 00:42:57,070
front-end and then we just switched it a

840
00:42:50,829 --> 00:43:09,030
one level higher to back-end so two best

841
00:42:57,070 --> 00:43:12,790
questions earn a gift iptables

842
00:43:09,030 --> 00:43:15,940
stops traffic to this server in case I

843
00:43:12,790 --> 00:43:19,140
get a was restored does not have keys on

844
00:43:15,940 --> 00:43:24,690
there is a key - and I guess it allows

845
00:43:19,140 --> 00:43:31,390
and we refresh on the separate chain so

846
00:43:24,690 --> 00:43:34,569
the traffic cannot be blocked yes in the

847
00:43:31,390 --> 00:43:36,848
microsecond of refresh it will send and

848
00:43:34,569 --> 00:43:39,369
it will go through all the traffic but

849
00:43:36,849 --> 00:43:41,400
one packet one whole packet may reach

850
00:43:39,369 --> 00:43:41,400
you

