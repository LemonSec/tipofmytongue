1
00:00:04,970 --> 00:00:08,109
good morning my name is John Dominic
lessons

2
00:00:08,109 --> 00:00:11,740
BTU about to me generation algorithms
and threatened diligence

3
00:00:11,740 --> 00:00:15,509
us a little bit about myself I am
president my own firm bembenek

4
00:00:15,509 --> 00:00:16,170
consulting

5
00:00:16,170 --> 00:00:20,000
I also teach for the Department of
Computer Science at the University of

6
00:00:20,000 --> 00:00:21,490
Illinois in the United States

7
00:00:21,490 --> 00:00:25,710
I produce some open source intelligence
feeds intelligence heats

8
00:00:25,710 --> 00:00:29,230
his ceiling to that in the last slide

9
00:00:29,230 --> 00:00:33,120
I work with companies in law enforcement
all over the world to address

10
00:00:33,120 --> 00:00:36,420
the growth cybercrime so

11
00:00:36,420 --> 00:00:40,450
about first about threat intelligence
there's a lot of misinformation about

12
00:00:40,450 --> 00:00:41,690
what this is I like

13
00:00:41,690 --> 00:00:45,000
at least defining what I believe it is
before I talk about it

14
00:00:45,000 --> 00:00:48,590
I information just generally is just a
sec data

15
00:00:48,590 --> 00:00:52,149
many companies just call hey look at all
these domains and IP address is no

16
00:00:52,149 --> 00:00:53,289
context no nothing

17
00:00:53,289 --> 00:00:56,730
call that threat intelligence that's not
really what threat intelligence is

18
00:00:56,730 --> 00:01:00,030
I intelligence is the art you know

19
00:01:00,030 --> 00:01:03,910
critically examining information to
produce some actionable conclusions

20
00:01:03,910 --> 00:01:04,650
based on

21
00:01:04,650 --> 00:01:08,320
so there's a very defined process that
goes about that not talk a little bit

22
00:01:08,320 --> 00:01:09,479
about that as I go through

23
00:01:09,479 --> 00:01:14,259
how I use DGX I said many companies just

24
00:01:14,259 --> 00:01:17,770
dump your seven million IP addresses
that do bad things

25
00:01:17,770 --> 00:01:21,680
you know that's just information that's
not really intelligence but there's very

26
00:01:21,680 --> 00:01:24,799
few that actually process set to create
meaningful information

27
00:01:24,799 --> 00:01:28,570
so the important point to that

28
00:01:28,570 --> 00:01:32,439
is at intelligence involves analyzing
your adversary capabilities

29
00:01:32,439 --> 00:01:35,479
their intentions and motivations and
that lets you tell something about what

30
00:01:35,479 --> 00:01:36,119
they're doing

31
00:01:36,119 --> 00:01:39,450
and what they will do and that's where
some real value is

32
00:01:39,450 --> 00:01:42,860
so why does all this matter

33
00:01:42,860 --> 00:01:46,990
impact reverse engineering you know now
where you can find a d-ga

34
00:01:46,990 --> 00:01:50,070
resolve all that might give you some
useful information is useful

35
00:01:50,070 --> 00:01:53,299
a but knowing why they're making those
decisions

36
00:01:53,299 --> 00:01:57,079
can give you some more valuable insight
into

37
00:01:57,079 --> 00:02:01,219
a you know what to block why to block in
exactly what's going on

38
00:02:01,219 --> 00:02:04,320
inside inside an organization on

39
00:02:04,320 --> 00:02:07,539
and the importance it to be able to
distinguish between

40
00:02:07,539 --> 00:02:11,390
you know the small amount to signal in a
large amount of noise that's out there

41
00:02:11,390 --> 00:02:11,970
if you're all

42
00:02:11,970 --> 00:02:15,430
if you're monitoring firewall logs you
gonna see things scanning

43
00:02:15,430 --> 00:02:19,430
in yourself all in organizational the
time that doesn't necessarily mean

44
00:02:19,430 --> 00:02:21,310
you've got an advanced read or something

45
00:02:21,310 --> 00:02:24,689
sophisticated that's just a lotta noise
the idea is to find a little

46
00:02:24,689 --> 00:02:28,219
bits and signal in that in for me in

47
00:02:28,219 --> 00:02:34,129
all that data to find some real use so

48
00:02:34,129 --> 00:02:38,219
adversarial objectives you know here
were I when we're talking about domain

49
00:02:38,219 --> 00:02:39,469
generation algorithms

50
00:02:39,469 --> 00:02:44,540
is generally a crime focused it's not
really used in APT's our nation's tater

51
00:02:44,540 --> 00:02:45,540
espionage stuff

52
00:02:45,540 --> 00:02:48,930
that usually a crime domain

53
00:02:48,930 --> 00:02:52,049
so you have some but it's usually
financially motivated

54
00:02:52,049 --> 00:02:58,010
you know that's their driving conclusion
sell some things that you already know

55
00:02:58,010 --> 00:03:01,069
about them is that you're dealing with
highly rational actors

56
00:03:01,069 --> 00:03:04,799
you know that what they do they do it
for some to find reason some defined

57
00:03:04,799 --> 00:03:05,469
objective

58
00:03:05,469 --> 00:03:09,099
that they made intelligent choice you
know has

59
00:03:09,099 --> 00:03:13,730
many of you probably know organized
crime is very hierarchical an organized

60
00:03:13,730 --> 00:03:17,859
in a very potentially siloed where the
in those people use of the development

61
00:03:17,859 --> 00:03:19,120
people into money laundering

62
00:03:19,120 --> 00:03:23,239
and so on and so forth many these
organizations or higher

63
00:03:23,239 --> 00:03:26,699
outside experts for lack of a more
appropriate word they may not have all

64
00:03:26,699 --> 00:03:28,340
the capabilities in-house

65
00:03:28,340 --> 00:03:31,909
and the last two kinda important points

66
00:03:31,909 --> 00:03:35,699
is at criminal actors have a desire to
remain quiet

67
00:03:35,699 --> 00:03:39,639
they tend not to wanna advertise that
they've on something and they want to

68
00:03:39,639 --> 00:03:42,430
remain resilient over the long term they
want to avoid

69
00:03:42,430 --> 00:03:46,590
law enforcement accompanies being able
to disrupt their activities

70
00:03:46,590 --> 00:03:49,919
saying keep the flow love fraud going

71
00:03:49,919 --> 00:03:56,199
over long periods of time so little bit
about the history

72
00:03:56,199 --> 00:03:59,870
%uh now we're command and control
networks you know over the last on

73
00:03:59,870 --> 00:04:05,109
10-15 some-odd years on I said an
adversary would like to persist

74
00:04:05,109 --> 00:04:08,560
their infections on the number of
victims over the long term

75
00:04:08,560 --> 00:04:12,400
and make their networks more resilient

76
00:04:12,400 --> 00:04:16,470
you know so that's how they evolved over
time the

77
00:04:16,470 --> 00:04:21,940
domain names generally tend to be easier
to take down the IP addresses

78
00:04:21,940 --> 00:04:25,530
and you know even despite jurisdictional
boundaries

79
00:04:25,530 --> 00:04:29,260
I so that has an effect and how they've
made choices over time

80
00:04:29,260 --> 00:04:33,730
on and I said the development over time
a largely show this

81
00:04:33,730 --> 00:04:37,030
that they've acted in ways to ensure
increased resiliency

82
00:04:37,030 --> 00:04:40,960
and we can map for overtime at Ford into
the future

83
00:04:40,960 --> 00:04:45,520
about how in how they're likely to
change their tactics

84
00:04:45,520 --> 00:04:53,180
over the coming years so in the
beginning

85
00:04:53,180 --> 00:04:57,490
you know now where actors right have
static IP addresses and domains in there

86
00:04:57,490 --> 00:05:01,330
you know here's 357 sometimes you just
want IP address

87
00:05:01,330 --> 00:05:05,110
the domain name says okay here's how you
I wanna be reached

88
00:05:05,110 --> 00:05:08,750
ally said domains are easy to take down
ISO

89
00:05:08,750 --> 00:05:12,300
you know IP addresses happen to be used
I

90
00:05:12,300 --> 00:05:16,270
and IP addresses the because a
jurisdictional issues

91
00:05:16,270 --> 00:05:19,340
it tends to be more difficult to take
those down so

92
00:05:19,340 --> 00:05:22,600
various countries will not work with
other law enforce our are

93
00:05:22,600 --> 00:05:26,050
last likely to work with law enforcement
from other countries

94
00:05:26,050 --> 00:05:29,330
so that allows command and control the
persist even

95
00:05:29,330 --> 00:05:33,050
when everybody kinda knows with
operating so

96
00:05:33,050 --> 00:05:37,790
because at this you know adversarial
responses increased numbers of domains

97
00:05:37,790 --> 00:05:38,780
and IP addresses

98
00:05:38,780 --> 00:05:42,340
and you service providers depending on
who the victims are

99
00:05:42,340 --> 00:05:46,620
that are more likely to not respond to
victim nation saying

100
00:05:46,620 --> 00:05:49,640
I hate this a problem here do something
about it

101
00:05:49,640 --> 00:05:54,080
so the more domains you have them you
know early on to tend to be more

102
00:05:54,080 --> 00:05:57,370
difficult to take things down

103
00:05:57,370 --> 00:06:01,140
kinda the next evolution zzzz proxies
and

104
00:06:01,140 --> 00:06:04,210
in-house so you have a domain and IP
address

105
00:06:04,210 --> 00:06:07,320
that's where the victims call to and
that simply just sense the traffic

106
00:06:07,320 --> 00:06:08,180
somewhere else

107
00:06:08,180 --> 00:06:11,850
so that makes it difficult so if you are
able to seize a machine

108
00:06:11,850 --> 00:06:15,340
are you really doing the season a proxy
you not really getting much information

109
00:06:15,340 --> 00:06:18,870
it would still be disruptive I to

110
00:06:18,870 --> 00:06:22,800
a botnet its command control mechanism
so

111
00:06:22,800 --> 00:06:26,020
on but attended the

112
00:06:26,020 --> 00:06:29,790
security companies in law enforcement
and be more leery have actually taking

113
00:06:29,790 --> 00:06:31,880
action at this point because you weren't
getting

114
00:06:31,880 --> 00:06:35,520
all of the data that you really want how
many people were compromised what

115
00:06:35,520 --> 00:06:37,140
information was compromised

116
00:06:37,140 --> 00:06:40,600
a solid be less likely to take over
proxies a side of

117
00:06:40,600 --> 00:06:43,980
an attempt to find what was behind it so

118
00:06:43,980 --> 00:06:48,360
our response I as security companies law
enforcement were

119
00:06:48,360 --> 00:06:51,970
to stop doing takedowns as much because

120
00:06:51,970 --> 00:06:55,930
the most valuable information was
transparent or I was

121
00:06:55,930 --> 00:07:01,910
was hidden to our into our immediate
view and the next stage of evolution Z

122
00:07:01,910 --> 00:07:03,380
is a dynamic dns

123
00:07:03,380 --> 00:07:09,810
so no I P 3322 .org several different
providers have that this basically

124
00:07:09,810 --> 00:07:11,070
allows people to

125
00:07:11,070 --> 00:07:14,150
register have a fixed a hostname

126
00:07:14,150 --> 00:07:17,380
to IP address to changes rapidly over
time

127
00:07:17,380 --> 00:07:20,860
the service was tended to be used more
for at least

128
00:07:20,860 --> 00:07:24,150
at its conception is used for consumers
I

129
00:07:24,150 --> 00:07:27,370
where add residential IP addresses that
would change frequently

130
00:07:27,370 --> 00:07:31,790
so have some way to contact your home PC
but organized crime actors found that

131
00:07:31,790 --> 00:07:33,030
this is really useful

132
00:07:33,030 --> 00:07:38,110
the 4e for their use as well it's still
being used today even though it's

133
00:07:38,110 --> 00:07:41,310
it fairly well-known tactic the rat

134
00:07:41,310 --> 00:07:44,330
remote access tools script kiddies tend
to use it

135
00:07:44,330 --> 00:07:48,570
but there is some kind of APT espionage
actors who uses as well

136
00:07:48,570 --> 00:07:53,040
so still even know it's been around for
a while it's still very active

137
00:07:53,040 --> 00:07:56,110
fast flux

138
00:07:56,110 --> 00:08:00,350
domains using multiple a records were
short time to live

139
00:08:00,350 --> 00:08:03,930
to create rolling lists have usually
proxies but not always to maintain

140
00:08:03,930 --> 00:08:04,440
control

141
00:08:04,440 --> 00:08:09,260
so given one hostname you'd see 10 50
100

142
00:08:09,260 --> 00:08:12,690
possibly know that's that usually proxy
back somewhere else

143
00:08:12,690 --> 00:08:15,800
so it it started to make it increasingly
difficult

144
00:08:15,800 --> 00:08:19,040
the to take down these machines

145
00:08:19,040 --> 00:08:23,120
so you can see is a machine the victim
victim happily move on because you can

146
00:08:23,120 --> 00:08:24,640
simply update DNS

147
00:08:24,640 --> 00:08:28,360
an sometimes not always but

148
00:08:28,360 --> 00:08:32,719
sometimes to be defined fast luck
networks that be reused and sold out

149
00:08:32,719 --> 00:08:36,400
but many times it also be just
compromised machines

150
00:08:36,400 --> 00:08:40,289
so you could taken action you know hey
this machine is in this

151
00:08:40,289 --> 00:08:45,170
fast flux network doing criminal fans
and it's really just somebody's home PC

152
00:08:45,170 --> 00:08:49,500
that was compromised or something else
so this is another way to one maintain

153
00:08:49,500 --> 00:08:50,180
resilience

154
00:08:50,180 --> 00:08:53,500
but to further hockey skate the

155
00:08:53,500 --> 00:08:56,760
the individual behind it and keep their
the data that they want to protect

156
00:08:56,760 --> 00:08:59,190
private so

157
00:08:59,190 --> 00:09:02,440
is a very quick example you see 5 IP
addresses

158
00:09:02,440 --> 00:09:06,720
a iraq shitty at 5 IP addresses 8.21
hostname

159
00:09:06,720 --> 00:09:11,180
Warefare you know a 30-minute time to
live so even though those

160
00:09:11,180 --> 00:09:15,320
a records you know are still resilient
is that I could take down those five IP

161
00:09:15,320 --> 00:09:16,010
addresses

162
00:09:16,010 --> 00:09:19,420
30 minutes later this five more IP
addresses in their place

163
00:09:19,420 --> 00:09:22,660
if I took down the domain I would just
assuming there's only one

164
00:09:22,660 --> 00:09:26,830
if I took down the domain or the name
servers it would still

165
00:09:26,830 --> 00:09:32,920
you know catastrophically disrupt the
bot so to evolve past that there was

166
00:09:32,920 --> 00:09:33,780
double flocks

167
00:09:33,780 --> 00:09:37,350
I so it added the same name server: %uh
same

168
00:09:37,350 --> 00:09:40,580
tactic for name servers sutton et contra

169
00:09:40,580 --> 00:09:44,230
they're controlling services more
resilient to so

170
00:09:44,230 --> 00:09:47,280
I can just take over the name servers
after

171
00:09:47,280 --> 00:09:50,680
do something else to take them down
however the domains

172
00:09:50,680 --> 00:09:54,540
you know were still was still
controlling so find a registrar

173
00:09:54,540 --> 00:09:58,380
and take out dive with sharks then
everything is

174
00:09:58,380 --> 00:10:02,060
as offline so does an example

175
00:10:02,060 --> 00:10:05,920
again you know fifteen-minute on the
list here probably

176
00:10:05,920 --> 00:10:09,250
wait a little bit and the IP addresses
change

177
00:10:09,250 --> 00:10:14,710
important or that is why the IP
addresses change frequently

178
00:10:14,710 --> 00:10:20,180
on if he sees the domain because the
Registrar was cooperative or you took

179
00:10:20,180 --> 00:10:21,290
some legal action

180
00:10:21,290 --> 00:10:25,610
I you'd still disrupt the botnet you
might never recover the data

181
00:10:25,610 --> 00:10:32,040
but no future loss would occur fairly
recent development is the introduction

182
00:10:32,040 --> 00:10:33,360
of torn i2p

183
00:10:33,360 --> 00:10:37,100
so these privacy enhancing technologies
particularly the hidden services

184
00:10:37,100 --> 00:10:37,940
component of it

185
00:10:37,940 --> 00:10:41,620
so using these and a min and ionisation
networks

186
00:10:41,620 --> 00:10:46,130
where at heights with the infrastructure
actually s so probably the most

187
00:10:46,130 --> 00:10:50,840
the the famous are well-known example
this is so corrode

188
00:10:50,840 --> 00:10:54,740
which is kinda a black an online black
market that was

189
00:10:54,740 --> 00:10:57,860
eventually taken down by a US law
enforcement

190
00:10:57,860 --> 00:11:01,320
and operated on hidden service so there
was no domain name to seize

191
00:11:01,320 --> 00:11:06,220
on they made their mistake earth that it
was that they leaked out information

192
00:11:06,220 --> 00:11:06,820
that had made

193
00:11:06,820 --> 00:11:11,930
made law enforcement able to identify
where infrastructure actually was

194
00:11:11,930 --> 00:11:15,030
and that are operator made other
mistakes which made it possible to

195
00:11:15,030 --> 00:11:16,380
identify who you what's

196
00:11:16,380 --> 00:11:19,430
but generally speaking without some kind
of mistake

197
00:11:19,430 --> 00:11:22,430
they're very hard to disrupt intake down

198
00:11:22,430 --> 00:11:26,460
even today there's really no good tactic
I can point to you

199
00:11:26,460 --> 00:11:29,460
better somebody's using tor I 2 p-4

200
00:11:29,460 --> 00:11:32,950
criminal operations want to disrupt them

201
00:11:32,950 --> 00:11:36,130
aside a blocking now that said most

202
00:11:36,130 --> 00:11:40,660
organizations companies institutions
could simply just block the use if to

203
00:11:40,660 --> 00:11:41,570
our hi to Pete

204
00:11:41,570 --> 00:11:46,500
that really want help consumers better
certainly help organizations because

205
00:11:46,500 --> 00:11:51,250
in very rare circumstances is a really a
legitimate business use

206
00:11:51,250 --> 00:11:54,460
after the use it or inside the company

207
00:11:54,460 --> 00:11:55,649
a you

208
00:11:55,649 --> 00:11:59,120
but it still still something that

209
00:11:59,120 --> 00:12:03,500
can't really be used to protect
consumers ca

210
00:12:03,500 --> 00:12:08,730
and the last iteration of evolution eyes
domain generation algorithms

211
00:12:08,730 --> 00:12:12,750
in DJ's basically you're just too
complicated math

212
00:12:12,750 --> 00:12:17,420
algorithm that creates pseudo random but
predictable domain names

213
00:12:17,420 --> 00:12:21,459
so run see some function did based on
whatever criteria

214
00:12:21,459 --> 00:12:25,199
given and says here's a hundred thousand
ten thousand domain names

215
00:12:25,199 --> 00:12:29,019
that will be searched to see if any one
of them

216
00:12:29,019 --> 00:12:32,480
a is is our at a botnet control

217
00:12:32,480 --> 00:12:36,459
so instead of a static list something
with Facebook something where there's a

218
00:12:36,459 --> 00:12:38,000
define small sets

219
00:12:38,000 --> 00:12:41,209
up things you could take action against
now you have a

220
00:12:41,209 --> 00:12:45,370
a somewhat dynamic list hundreds or
thousands subdomains

221
00:12:45,370 --> 00:12:49,180
back operate under a variety of
registrars your idea for

222
00:12:49,180 --> 00:12:53,740
top-level domains and the adversary only
needs to register a couple at a time

223
00:12:53,740 --> 00:12:58,930
so usually most to these things that
used Egas accountable to in sequence

224
00:12:58,930 --> 00:13:03,310
and say okay I've authenticated this one
as my controller

225
00:13:03,310 --> 00:13:07,829
now I don't need to keep searching if
things go offline because the seizure

226
00:13:07,829 --> 00:13:11,310
it simply just goes into rates to the
list again and

227
00:13:11,310 --> 00:13:14,529
I from their weights for another valid
hit

228
00:13:14,529 --> 00:13:17,569
whatever them our family to are defined
as a valid yet

229
00:13:17,569 --> 00:13:21,029
so this will allow on

230
00:13:21,029 --> 00:13:25,120
an adversary to shop registrars domain
registrars anti all these for that

231
00:13:25,120 --> 00:13:25,600
matter

232
00:13:25,600 --> 00:13:29,350
to find somebody who's more friendly I
to

233
00:13:29,350 --> 00:13:33,350
to their operation I should say less
willing to work with authorities

234
00:13:33,350 --> 00:13:37,680
so on be you know the F Go Daddy for
instance

235
00:13:37,680 --> 00:13:40,970
you know is suspending all their domain
segno shop to

236
00:13:40,970 --> 00:13:45,180
another domain domain registrar can

237
00:13:45,180 --> 00:13:49,940
and of course about now we're see to use
can use a variety these tactics and

238
00:13:49,940 --> 00:13:52,800
actually many other more sophisticated
ones to use a variety

239
00:13:52,800 --> 00:13:55,920
love static list domain generation
algorithms

240
00:13:55,920 --> 00:14:00,089
in torn i2p soda any particular ones are
these

241
00:14:00,089 --> 00:14:03,800
are disabled or blocked they're still
able to reassert control

242
00:14:03,800 --> 00:14:08,079
and for that matter Ste update
themselves are at date their victims

243
00:14:08,079 --> 00:14:11,459
with better control for our new control
code to

244
00:14:11,459 --> 00:14:14,750
avoid avoid tactics that

245
00:14:14,750 --> 00:14:17,990
law enforcement security companies are
doing to disrupt their activities

246
00:14:17,990 --> 00:14:25,199
so

247
00:14:25,199 --> 00:14:28,240
reverse engineering domain generation
outlines

248
00:14:28,240 --> 00:14:31,550
I you know there are do a lot of posts
out there the stock is only about

249
00:14:31,550 --> 00:14:33,040
reversing it so much

250
00:14:33,040 --> 00:14:38,709
but but if you take a look at I John as
mayors blonde John is better that CH

251
00:14:38,709 --> 00:14:42,250
he's got somewhere between a half-dozen
and doesn t GA's

252
00:14:42,250 --> 00:14:45,569
reverse-engineered new shows how he goes
about doing that

253
00:14:45,569 --> 00:14:49,240
and provides usually Python code to
basically

254
00:14:49,240 --> 00:14:53,620
provide command line ability to run the
GA's so if you're interested in that I

255
00:14:53,620 --> 00:14:58,190
I highly recommend his blog if you are
reverse engineering and now we're

256
00:14:58,190 --> 00:15:01,940
sample there's really no shortcuts to it
but there are a couple of things

257
00:15:01,940 --> 00:15:06,199
to look for a is looking for functions
iterate many times

258
00:15:06,199 --> 00:15:09,600
so you know they'll be some function
that says

259
00:15:09,600 --> 00:15:13,160
okay go through generate a thousand
domains

260
00:15:13,160 --> 00:15:16,430
guess he kinda for are a visual cue look
for

261
00:15:16,430 --> 00:15:20,180
on you know and then I'll be some
connecting function hey

262
00:15:20,180 --> 00:15:23,870
try to connect to these in sequence that
lets you know at least this is probably

263
00:15:23,870 --> 00:15:25,800
in the ballpark of what you're looking
for

264
00:15:25,800 --> 00:15:29,060
I you know that being said of course

265
00:15:29,060 --> 00:15:32,449
any now we're particularly the more
sophisticated than our is

266
00:15:32,449 --> 00:15:36,470
the more likely there is to be and
obfuscation

267
00:15:36,470 --> 00:15:41,480
I antibody technique so make life
difficult for you

268
00:15:41,480 --> 00:15:44,270
so as an example which is probably not I
really visible

269
00:15:44,270 --> 00:15:48,000
on the slide but from disassemble ida

270
00:15:48,000 --> 00:15:51,110
EC a DGAF

271
00:15:51,110 --> 00:15:57,220
Rambis right there so there are several
different types

272
00:15:57,220 --> 00:16:01,450
Adi DA's I all of them use some kind of
seed

273
00:16:01,450 --> 00:16:04,940
a seat a random seed to you generate a
list

274
00:16:04,940 --> 00:16:08,240
the many tend to be date based

275
00:16:08,240 --> 00:16:11,860
so based on whatever day whatever
calendar day it is

276
00:16:11,860 --> 00:16:16,060
you know they'll generate a given list
domains

277
00:16:16,060 --> 00:16:20,650
some will have simply a static seed that
says okay here's

278
00:16:20,650 --> 00:16:25,720
the thousand domains generated based on
this to find strain whether it's a4 byte

279
00:16:25,720 --> 00:16:26,420
string

280
00:16:26,420 --> 00:16:30,920
or some other domain name and then
there's also been the emergence of the

281
00:16:30,920 --> 00:16:32,120
use a dynamic seats

282
00:16:32,120 --> 00:16:35,750
but the seed has to be globally
consistent

283
00:16:35,750 --> 00:16:39,660
so it has to be something that makes
sense to anybody anywhere in the world

284
00:16:39,660 --> 00:16:42,710
the so that when you know that the
machine

285
00:16:42,710 --> 00:16:46,970
initiates the algorithm to run the D GA
all victims have to be able to run

286
00:16:46,970 --> 00:16:51,040
whatever code to do the DJ it has to be
predictable so that whoever

287
00:16:51,040 --> 00:16:55,900
operates the network knows what to
register and that all the victims were

288
00:16:55,900 --> 00:17:01,830
reliably connect to it some other
hardening techniques that they've taken

289
00:17:01,830 --> 00:17:05,920
a that they've taken using domain
generation arguments is a

290
00:17:05,920 --> 00:17:09,680
you know obviously the easy one is using
who is protection

291
00:17:09,680 --> 00:17:14,440
and so on many

292
00:17:14,440 --> 00:17:18,540
many will do you will who is protection
though an important point least I've

293
00:17:18,540 --> 00:17:19,400
notices at

294
00:17:19,400 --> 00:17:22,630
there are several registrars who while
they offer who is protection

295
00:17:22,630 --> 00:17:25,780
there will still be unique strains that

296
00:17:25,780 --> 00:17:29,660
will help you correlate whoever the
registrant is to other things that

297
00:17:29,660 --> 00:17:30,570
they've registered

298
00:17:30,570 --> 00:17:34,270
so there may be a custom I custom email
address

299
00:17:34,270 --> 00:17:37,910
it's not valid for anything but it'll
help you register okay this actor

300
00:17:37,910 --> 00:17:39,480
registered these other domains

301
00:17:39,480 --> 00:17:42,880
that may or may not be in the D GA some

302
00:17:42,880 --> 00:17:46,140
global top-level domains don't offer who
is protection

303
00:17:46,140 --> 00:17:49,260
you you may or may not be able to get
away with putting in shake who is

304
00:17:49,260 --> 00:17:50,020
information

305
00:17:50,020 --> 00:17:53,380
but there are several gTLD is it really
make it difficult

306
00:17:53,380 --> 00:17:57,050
for people who want to do singles so
there's a couple of

307
00:17:57,050 --> 00:18:00,190
the campaign to ease the GA's

308
00:18:00,190 --> 00:18:03,520
that specifically gravitated towards
those detailed these

309
00:18:03,520 --> 00:18:07,070
simply to make research charge for for
people looking defects

310
00:18:07,070 --> 00:18:11,960
several malware campaign to also rotate
their seat somewhat frequently

311
00:18:11,960 --> 00:18:15,660
as long as they're still in control of
their victims unable to update all their

312
00:18:15,660 --> 00:18:16,290
victims

313
00:18:16,290 --> 00:18:20,170
a that's not a very difficult thing to
do they just communicate the new seed

314
00:18:20,170 --> 00:18:20,900
everybody

315
00:18:20,900 --> 00:18:24,190
and they move on tiny banker a

316
00:18:24,190 --> 00:18:27,500
is very notorious for this I

317
00:18:27,500 --> 00:18:31,480
and there's been emergence in this least
last several months

318
00:18:31,480 --> 00:18:34,520
is that some now where tries to be
sinkhole aware

319
00:18:34,520 --> 00:18:38,480
where explicitly it looks when it tried
before to next

320
00:18:38,480 --> 00:18:41,880
to an IP address to say hey this isn't
really

321
00:18:41,880 --> 00:18:45,490
a really mine this belong to a security
researcher

322
00:18:45,490 --> 00:18:49,790
so you know they're adversarial
objective here maintain control in

323
00:18:49,790 --> 00:18:50,540
surveillance

324
00:18:50,540 --> 00:18:54,390
so get adversaries pursuer taking action

325
00:18:54,390 --> 00:18:58,920
a highly rational action based on
whatever their particular objectives are

326
00:18:58,920 --> 00:19:02,560
10 take a look at a couple of

327
00:19:02,560 --> 00:19:06,610
DGS really quickly the first as
Conficker

328
00:19:06,610 --> 00:19:10,020
seen round 2007 even though that

329
00:19:10,020 --> 00:19:15,170
Conficker is I wanna say dead and gone
the control of contractor infected note

330
00:19:15,170 --> 00:19:15,830
is gone

331
00:19:15,830 --> 00:19:20,690
but is still about 700,000 machine still
infected with Conficker

332
00:19:20,690 --> 00:19:23,900
other sexually just on these were just
connecting outward never getting

333
00:19:23,900 --> 00:19:24,490
anything

334
00:19:24,490 --> 00:19:27,740
the first two iterations of Conficker

335
00:19:27,740 --> 00:19:31,530
NB I generated only 250 domain names

336
00:19:31,530 --> 00:19:36,550
a early on is that security company
started registering dancing calling them

337
00:19:36,550 --> 00:19:37,520
taking down

338
00:19:37,520 --> 00:19:40,670
taking down domains so whoever was
behind

339
00:19:40,670 --> 00:19:44,010
behind Conficker a up the number of
domains

340
00:19:44,010 --> 00:19:49,160
in a DGAF to 50,000 across a 140 global
TLD so they had

341
00:19:49,160 --> 00:19:51,160
quite the

342
00:19:51,160 --> 00:19:55,010
selection in terms of choosing how to
maintain control

343
00:19:55,010 --> 00:19:58,920
the so their arse a coupla registries

344
00:19:58,920 --> 00:20:03,210
that started banning the use of
Conficker domains so now using 140

345
00:20:03,210 --> 00:20:04,440
global to: these

346
00:20:04,440 --> 00:20:08,320
and allow them to go around that problem
and still maintain control

347
00:20:08,320 --> 00:20:12,300
year ago

348
00:20:12,300 --> 00:20:16,139
so second example a script a locker

349
00:20:16,140 --> 00:20:19,780
generated two thousand domains today
across seven gTLD is

350
00:20:19,780 --> 00:20:23,190
crypto locker I was active

351
00:20:23,190 --> 00:20:26,260
in 2013 in 2040 I

352
00:20:26,260 --> 00:20:30,250
it was very similar to the domain
generation algorithm that's listed in

353
00:20:30,250 --> 00:20:32,090
the Wikipedia article on the GA's

354
00:20:32,090 --> 00:20:36,600
so if you google da me generation
algorithm the example that they provide

355
00:20:36,600 --> 00:20:37,660
their that code

356
00:20:37,660 --> 00:20:42,080
the you know only a couple small changes
in its the same as a crypto locker code

357
00:20:42,080 --> 00:20:47,820
which amused me when I was researching
it was used previously in 2011 by

358
00:20:47,820 --> 00:20:51,200
the the flashback or Saks warm which was

359
00:20:51,200 --> 00:20:54,590
a a Mac a Mac virus so

360
00:20:54,590 --> 00:20:57,750
when the interesting things in
researching investigating this is

361
00:20:57,750 --> 00:21:02,240
okay D GA based on Rd janet was
previously used a in a

362
00:21:02,240 --> 00:21:05,270
Mac campaign now being used in Windows

363
00:21:05,270 --> 00:21:09,360
in a kinda gave the impression that you
know there's somebody out there who

364
00:21:09,360 --> 00:21:12,350
selling this stuff because the people
who write Mac now where

365
00:21:12,350 --> 00:21:15,570
and that the same people who write
Windows malware generally speaking

366
00:21:15,570 --> 00:21:18,850
you know but somebody who knows a lot
about the GA's which is a very small

367
00:21:18,850 --> 00:21:20,320
subset appropriate people

368
00:21:20,320 --> 00:21:23,930
could simply use the code so I believe
this

369
00:21:23,930 --> 00:21:27,170
kinda small market place's people out
there who do nothing but right domain

370
00:21:27,170 --> 00:21:28,610
generation algorithms

371
00:21:28,610 --> 00:21:33,340
through the life of crypto locker in
about nine or ten months

372
00:21:33,340 --> 00:21:38,730
there was never any change in a in them
our campaign in the D GA itself

373
00:21:38,730 --> 00:21:42,220
so despite the fact that early on

374
00:21:42,220 --> 00:21:46,430
the the British the British government
has one registry for Olive

375
00:21:46,430 --> 00:21:51,310
COD UK early on they simply blocked all
the co.uk domains

376
00:21:51,310 --> 00:21:55,710
the actors behind trip to locker never
change tactics even know

377
00:21:55,710 --> 00:21:58,850
I that we were your honor ministry
well-known

378
00:21:58,850 --> 00:21:59,210
we're on

379
00:21:59,210 --> 00:22:02,899
into them on this is successfully taking
down in 2014

380
00:22:02,899 --> 00:22:07,270
but that take down basically involved
simply just registering

381
00:22:07,270 --> 00:22:10,750
and taking all of them to remain
separate a locker would use well into

382
00:22:10,750 --> 00:22:11,330
the future

383
00:22:11,330 --> 00:22:14,720
so they only had one method to reach out
he with

384
00:22:14,720 --> 00:22:18,690
it and it was the g8 never changed it
there was no update mechanism

385
00:22:18,690 --> 00:22:22,970
serial take it out by simply just
seizing a few hundred thousand domains

386
00:22:22,970 --> 00:22:26,899
so some conclusions about this

387
00:22:26,899 --> 00:22:30,700
are you mention one i think is likely.
written by after party a

388
00:22:30,700 --> 00:22:35,020
it would go days without an active a
register domain registration

389
00:22:35,020 --> 00:22:38,880
so the actor behind it wanted to get
paid but really wasn't overly concerned

390
00:22:38,880 --> 00:22:41,750
about you know I need to make sure this
is up 24 /7

391
00:22:41,750 --> 00:22:45,159
I did really tend to it is very casual
the

392
00:22:45,159 --> 00:22:48,210
and maintenance the up the network

393
00:22:48,210 --> 00:22:52,549
and he tended not to shift register as
even when domains are suspended

394
00:22:52,549 --> 00:22:56,480
so the couple a times he kept going back
to the same registrar

395
00:22:56,480 --> 00:22:59,600
even though we were able to take down as
domains on

396
00:22:59,600 --> 00:23:03,010
and Eden really monitor his own network

397
00:23:03,010 --> 00:23:06,940
because security researchers for those
thousand domains

398
00:23:06,940 --> 00:23:10,970
that were generated today for everyone
active malicious

399
00:23:10,970 --> 00:23:14,730
command to see two IP address there's
about 125 singles

400
00:23:14,730 --> 00:23:18,029
so we were you know obviously

401
00:23:18,029 --> 00:23:22,980
very flagrant and monitoring that next
example as tembo

402
00:23:22,980 --> 00:23:26,510
a already mentioned a little bit
generates a thousand domains today

403
00:23:26,510 --> 00:23:30,659
is not date seen it so it's basically in
fact a static list

404
00:23:30,659 --> 00:23:34,429
seeded by an initial hostname and a
defined GLT

405
00:23:34,429 --> 00:23:37,970
gTLD so it's a you know dot ordered

406
00:23:37,970 --> 00:23:41,380
and then some hostname and then it would
iterate through its algorithm

407
00:23:41,380 --> 00:23:45,610
this was interesting because have all
the malware

408
00:23:45,610 --> 00:23:49,350
families to track using DG is just one
change is the most frequent

409
00:23:49,350 --> 00:23:53,140
usually about a couple times a week
unusually

410
00:23:53,140 --> 00:23:56,159
almost as soon as somebody cracks in
starts in calling it

411
00:23:56,159 --> 00:23:58,929
they start moving in updating everybody

412
00:23:58,929 --> 00:24:02,630
every other victims so there's somebody
very active

413
00:24:02,630 --> 00:24:06,710
in trying to prevent surveillance so

414
00:24:06,710 --> 00:24:10,140
conclusions about 10 bux timber also
known as tiny banker

415
00:24:10,140 --> 00:24:13,860
they care about the infrastructure and
they're very

416
00:24:13,860 --> 00:24:17,390
a they're very active in trying to limit
the amount of surveillance

417
00:24:17,390 --> 00:24:23,539
that people can not take on them in CHEM
I

418
00:24:23,539 --> 00:24:26,539
last example is be deep which

419
00:24:26,539 --> 00:24:31,669
uses a dynamic seed this uses currency
exchange values

420
00:24:31,669 --> 00:24:35,100
as published by the European Central
Bank I

421
00:24:35,100 --> 00:24:39,030
the European Central Bank daily
generates basically a text file

422
00:24:39,030 --> 00:24:42,309
with values to the exchange rates
between various currencies

423
00:24:42,309 --> 00:24:45,559
so this malware reaches out to the
European Central Bank

424
00:24:45,559 --> 00:24:48,690
figures that out uses that as a seed to
generate domains

425
00:24:48,690 --> 00:24:52,110
so this makes it impossible to predict
in advance

426
00:24:52,110 --> 00:24:56,500
a what demands will be I you know you
have it for a given day but you can't

427
00:24:56,500 --> 00:24:58,190
map for what they're going to use

428
00:24:58,190 --> 00:25:02,570
so I found this a very interesting use
of a foreign exchange values

429
00:25:02,570 --> 00:25:06,250
but attempt to really stay at a bus cuz
now there's no way to predict in the

430
00:25:06,250 --> 00:25:08,220
future what domain something's going to
use

431
00:25:08,220 --> 00:25:12,270
on this blog post on there from however
networks if you wanna read more about

432
00:25:12,270 --> 00:25:13,780
that Inka

433
00:25:13,780 --> 00:25:17,659
so all successful takedowns

434
00:25:17,659 --> 00:25:20,990
love now where a now where that uses the
GA's

435
00:25:20,990 --> 00:25:24,400
generally involved season although the
domains in advance

436
00:25:24,400 --> 00:25:27,480
and suspending current domains so

437
00:25:27,480 --> 00:25:30,510
obviously if I keep predicting the
future what somebody's going to use

438
00:25:30,510 --> 00:25:33,860
I can't really take it down Jan now

439
00:25:33,860 --> 00:25:37,030
this would decapitate a botnet if and
only if

440
00:25:37,030 --> 00:25:41,159
there's no other fallback mechanism so
many of these now we're campaigns and

441
00:25:41,159 --> 00:25:41,789
I've gone through

442
00:25:41,789 --> 00:25:46,000
the DG may not be the primary may not
even be the secondary there's 20 right

443
00:25:46,000 --> 00:25:49,409
torn i2p or static lists so

444
00:25:49,409 --> 00:25:52,890
in this example I would be deep you
can't really do any

445
00:25:52,890 --> 00:25:56,460
any takedown activity against it at
least not the way that we've been doing

446
00:25:56,460 --> 00:26:00,320
that over the past couple of years

447
00:26:00,320 --> 00:26:03,520
set us a little bit about why dee dee is
a good for the bad guys let's talk about

448
00:26:03,520 --> 00:26:04,630
why DG's

449
00:26:04,630 --> 00:26:07,700
you know are good for the good guys
sense

450
00:26:07,700 --> 00:26:12,370
there's some predictable pattern you
know at least three a given day of DJs

451
00:26:12,370 --> 00:26:15,809
you know that allows us to create
sinkholes other get some additional

452
00:26:15,809 --> 00:26:16,820
information

453
00:26:16,820 --> 00:26:21,299
essentially register a domain inside the
DG a and then see what and what victims

454
00:26:21,299 --> 00:26:22,220
connect to us

455
00:26:22,220 --> 00:26:26,540
so you note aloud the creation of
signatures are traffic patterns

456
00:26:26,540 --> 00:26:30,840
that would allow some blocking release
and detection affirm our

457
00:26:30,840 --> 00:26:34,390
an hour infection time it does

458
00:26:34,390 --> 00:26:38,200
does provide some easy ability to take
down see if you can predict the domains

459
00:26:38,200 --> 00:26:39,200
and Advanced Cell

460
00:26:39,200 --> 00:26:42,950
operation toll bar which took down trip
to lock in game overseas

461
00:26:42,950 --> 00:26:46,130
both for those only used to DG a
mechanism

462
00:26:46,130 --> 00:26:49,809
we able to register six months worth a
domain term essentially decapitate both

463
00:26:49,809 --> 00:26:50,900
families and what's

464
00:26:50,900 --> 00:26:55,679
and more point this talk is to provide
some interesting ability

465
00:26:55,679 --> 00:26:59,240
to survey a malicious infrastructure I
in relative near time

466
00:26:59,240 --> 00:27:03,220
can the you serve

467
00:27:03,220 --> 00:27:07,049
DNS I you know limits the ability

468
00:27:07,049 --> 00:27:10,240
you know the adversary to play games and
what I mean by this is

469
00:27:10,240 --> 00:27:13,340
you know you want your victims to be
able to connect to you

470
00:27:13,340 --> 00:27:18,320
you may not know exactly who you're
victims are so if you using DNS server

471
00:27:18,320 --> 00:27:18,900
you know

472
00:27:18,900 --> 00:27:22,840
a hostname you really can't do any games
to deceive people

473
00:27:22,840 --> 00:27:26,590
or deceive researchers from figuring out
where you are because you want your

474
00:27:26,590 --> 00:27:28,090
victims to be able to connect to you

475
00:27:28,090 --> 00:27:32,640
so the entire world needs to be able to
reliably resolve your IP address

476
00:27:32,640 --> 00:27:36,900
I'm so even when and then the second
point is

477
00:27:36,900 --> 00:27:41,299
I even when adversaries tend to change
their domain generation algorithm

478
00:27:41,299 --> 00:27:44,669
they tend not to immediately change
their the underlying

479
00:27:44,669 --> 00:27:47,669
IP addresses that are using at least not
at same time

480
00:27:47,669 --> 00:27:51,850
so if you go back to the tiny banker to
the example

481
00:27:51,850 --> 00:27:55,870
you know they may change 30 GA update
all the victims

482
00:27:55,870 --> 00:27:59,270
but they're not updating the IP
addresses at the same time so at least

483
00:27:59,270 --> 00:28:01,360
gives you some hints to be able to go
back

484
00:28:01,360 --> 00:28:05,570
and say okay they change in GG a bit
here here still whether infrastructure

485
00:28:05,570 --> 00:28:06,010
is

486
00:28:06,010 --> 00:28:09,960
and you could use may be passive DNS to
figure out what that means they're using

487
00:28:09,960 --> 00:28:16,570
and maybe re help me a speedup reverse
engineering to the DGH so little bit

488
00:28:16,570 --> 00:28:17,520
about singling

489
00:28:17,520 --> 00:28:20,770
you know obviously many companies many
security companies do this

490
00:28:20,770 --> 00:28:24,160
for some particular reason many

491
00:28:24,160 --> 00:28:27,830
are very passionate about hiding that

492
00:28:27,830 --> 00:28:31,470
you know their IP addresses in fact the
sinkhole in

493
00:28:31,470 --> 00:28:34,600
I find this kind of ironic because most
now where

494
00:28:34,600 --> 00:28:37,830
authors I would think would know what IP
addresses to use in

495
00:28:37,830 --> 00:28:41,450
so anything that's answering energy g8
it's not them

496
00:28:41,450 --> 00:28:44,830
is obviously security company a but many

497
00:28:44,830 --> 00:28:48,720
will passion we try to avoid saying no I
don't wanna have anybody know that

498
00:28:48,720 --> 00:28:49,570
that's a single

499
00:28:49,570 --> 00:28:53,850
but as an industry we kinda excessive
about singling

500
00:28:53,850 --> 00:28:57,840
and print the lockers a great example
125 domains

501
00:28:57,840 --> 00:29:01,650
you know for everyone malicious
malicious domain

502
00:29:01,650 --> 00:29:05,670
and tracks for some our campaigns where
that now or author

503
00:29:05,670 --> 00:29:09,010
has already I updated dirty GA moved on

504
00:29:09,010 --> 00:29:13,620
their companies I'll go back in sync all
eighty GA's simply cuz they finally got

505
00:29:13,620 --> 00:29:17,270
around the reverse engineering at and
not getting any reliable information

506
00:29:17,270 --> 00:29:27,500
so if you know what I mean somebody's
using in trade some feeds pretty easily

507
00:29:27,500 --> 00:29:28,090
out of it

508
00:29:28,090 --> 00:29:33,120
you know to create some protective
protective technology if you want so

509
00:29:33,120 --> 00:29:36,600
here's an example trading simply feed
for May 22nd

510
00:29:36,600 --> 00:29:40,400
trip to locker not particularly useful
construct a locker is no more

511
00:29:40,400 --> 00:29:44,120
but you can generate a list to domains
and then you could see that into you

512
00:29:44,120 --> 00:29:47,340
RPZ or some other some other tool

513
00:29:47,340 --> 00:29:51,010
to simply block access to it you know
the rest of the world

514
00:29:51,010 --> 00:29:54,900
might be able to reach malicious
infrastructure whatever organization you

515
00:29:54,900 --> 00:29:58,470
protecting wouldn't will be able to
reach it so that's really easy to do

516
00:29:58,470 --> 00:30:03,310
can you know but what's more interesting
to me is the ability to do surveillance

517
00:30:03,310 --> 00:30:07,840
so fairly easy to do this on a on a
relatively small

518
00:30:07,840 --> 00:30:12,460
Amazon a.w.s instance requires two tools
parallel

519
00:30:12,460 --> 00:30:15,460
and a DNS tools for a synchronous

520
00:30:15,460 --> 00:30:18,320
DNS lookups

521
00:30:18,320 --> 00:30:21,320
so you know would start by

522
00:30:21,320 --> 00:30:25,480
so the general processes you pre
generate all your domains two days

523
00:30:25,480 --> 00:30:26,759
before the two days later

524
00:30:26,759 --> 00:30:30,570
miss assumes a date CDDA see general the
domain stat

525
00:30:30,570 --> 00:30:34,070
you want to look up you take that list
you pipette into you

526
00:30:34,070 --> 00:30:39,000
a DNS I N he and use parallel to limit
the number of lines about five hundred

527
00:30:39,000 --> 00:30:40,500
to a thousand if you fire

528
00:30:40,500 --> 00:30:43,559
more than that at once you start getting
on reliable results

529
00:30:43,559 --> 00:30:47,679
a and this allows you to basically get
IP addresses in near-real-time

530
00:30:47,679 --> 00:30:52,909
a and four I think roughly in processing
around 200,000 Domains now

531
00:30:52,909 --> 00:30:57,519
and neck in work inside a 10 minutes so

532
00:30:57,519 --> 00:31:00,690
as an example here the current I should
say here's

533
00:31:00,690 --> 00:31:04,029
1 I've the Cedars a timber so

534
00:31:04,029 --> 00:31:07,379
these active non single domains are
currently resolve in

535
00:31:07,379 --> 00:31:12,090
so you've got seven of them well we
already know how to generate two domains

536
00:31:12,090 --> 00:31:15,470
I but what's interesting is getting the
IP addresses

537
00:31:15,470 --> 00:31:19,210
so those seven are

538
00:31:19,210 --> 00:31:23,220
summer those domains will resolve to
these IP addresses you know it is given

539
00:31:23,220 --> 00:31:23,629
time

540
00:31:23,629 --> 00:31:27,450
cell a quick note about

541
00:31:27,450 --> 00:31:32,000
intelligence bias when people gather
intelligence and process information

542
00:31:32,000 --> 00:31:34,120
they bring some biases to the table

543
00:31:34,120 --> 00:31:38,980
the way I go about this is that I true
in all sinkholes because I don't really

544
00:31:38,980 --> 00:31:39,549
care

545
00:31:39,549 --> 00:31:42,740
what security companies say colin White
I

546
00:31:42,740 --> 00:31:46,789
because I'm interested in in surveilling
malicious infrastructure the

547
00:31:46,789 --> 00:31:50,279
so I'm generally uninterested in that
however

548
00:31:50,279 --> 00:31:53,370
you know if you're protecting an
organization is a company that you wanna

549
00:31:53,370 --> 00:31:57,669
in a protect are you would care about
same calls because if you've got a

550
00:31:57,669 --> 00:32:02,149
a a victim machine thats connecting to a
single it's to infected with something

551
00:32:02,149 --> 00:32:05,559
it may not be really you reaching the
malicious infrastructure but you still

552
00:32:05,559 --> 00:32:06,769
got something the cleanup

553
00:32:06,769 --> 00:32:11,200
so there's there's certainly some
considerations by such need to be

554
00:32:11,200 --> 00:32:13,610
involved with

555
00:32:13,610 --> 00:32:16,460
so one quick point about this I pew a

556
00:32:16,460 --> 00:32:20,710
IP address list you know it seems like
okay I've got six IP addresses I know

557
00:32:20,710 --> 00:32:21,780
there is all too

558
00:32:21,780 --> 00:32:25,420
militias are malicious domains register
those IP addresses

559
00:32:25,420 --> 00:32:29,580
killer just to put that in a firewall
and be done with it it's not generally

560
00:32:29,580 --> 00:32:31,300
not a good idea we'll talk about that

561
00:32:31,300 --> 00:32:35,430
in a couple slights this is probably not
entirely visible to you

562
00:32:35,430 --> 00:32:39,050
but you can also check nameserver
information so these are the six IP

563
00:32:39,050 --> 00:32:39,780
addresses

564
00:32:39,780 --> 00:32:42,950
or six up the IP addresses the

565
00:32:42,950 --> 00:32:46,610
for name servers that are used by tiny
banker

566
00:32:46,610 --> 00:32:49,900
and these are for host names that are
used to those

567
00:32:49,900 --> 00:32:55,050
so with those two data points you can
usually quickly validate what the same

568
00:32:55,050 --> 00:32:56,970
Colin what's more likely malicious

569
00:32:56,970 --> 00:33:00,790
so some security companies will simply
use

570
00:33:00,790 --> 00:33:04,190
a name server has sent home a title that
makes it obvious

571
00:33:04,190 --> 00:33:08,090
but malicious actors tend to reuse the
same nameservers

572
00:33:08,090 --> 00:33:13,510
even when they change other GGS so I'll
give you some quick indication of

573
00:33:13,510 --> 00:33:16,650
how to validate quickly what's malicious
and what's not malicious

574
00:33:16,650 --> 00:33:20,840
so with those for data points

575
00:33:20,840 --> 00:33:25,290
hostname archerd said domain IP address
name server IP address name server now

576
00:33:25,290 --> 00:33:28,840
domain he could start to make decisions
based on that information

577
00:33:28,840 --> 00:33:32,400
you know you could block those domains
and IP addresses will talk more about

578
00:33:32,400 --> 00:33:33,300
that in a second

579
00:33:33,300 --> 00:33:37,500
but you could block the name servers
anybody reaching out to the name servers

580
00:33:37,500 --> 00:33:40,980
the sometimes sometimes

581
00:33:40,980 --> 00:33:44,000
d-ga actors and malicious individuals

582
00:33:44,000 --> 00:33:47,840
will use otherwise legitimate name
servers and there's been more than a few

583
00:33:47,840 --> 00:33:49,090
security companies

584
00:33:49,090 --> 00:33:52,910
that it simply use the name server and
correlated everything

585
00:33:52,910 --> 00:33:57,350
and created some false conclusions base
simply on the user name server:

586
00:33:57,350 --> 00:34:01,730
so while it's not really useful
operationally it may be useful

587
00:34:01,730 --> 00:34:05,470
for intelligence

588
00:34:05,470 --> 00:34:09,540
so you know talked a little about what
we're doing but the adversaries know

589
00:34:09,540 --> 00:34:10,690
that we're doing this to

590
00:34:10,690 --> 00:34:15,079
so this is not particularly
sophisticated it's pretty easy to do you

591
00:34:15,079 --> 00:34:16,270
DNS lookups

592
00:34:16,270 --> 00:34:19,389
so in response to you us doing this

593
00:34:19,389 --> 00:34:22,649
you know they'll change their seats
frequently we talked about that

594
00:34:22,649 --> 00:34:26,669
you know they do have non d-ga
communication mechanisms use it or

595
00:34:26,669 --> 00:34:31,440
static list so whatever and the last one
which is somewhat recently and when I

596
00:34:31,440 --> 00:34:34,460
find one the most interesting is
engaging in counterintelligence

597
00:34:34,460 --> 00:34:39,280
so briefly counterintelligence is any
set of tactics used

598
00:34:39,280 --> 00:34:42,750
by somebody to thwart
information-gathering itself

599
00:34:42,750 --> 00:34:47,780
so nation-states and intelligence
organizations do this all the time

600
00:34:47,780 --> 00:34:52,040
I would make sense that a organized
crime

601
00:34:52,040 --> 00:34:55,639
actors we do the same so you remember
those domain I peed

602
00:34:55,639 --> 00:35:00,630
IP address lists before you know what if
an adversary registers domains that they

603
00:35:00,630 --> 00:35:01,430
are really using

604
00:35:01,430 --> 00:35:04,510
on okay maybe there's no real harm in
that

605
00:35:04,510 --> 00:35:07,549
the but how about something a little bit
more scary

606
00:35:07,549 --> 00:35:13,260
you probably can see these IP addresses
but remember that you know the DJ is

607
00:35:13,260 --> 00:35:14,290
fully known

608
00:35:14,290 --> 00:35:18,990
by an adversary the domains can be fully
in control as an adversary they can

609
00:35:18,990 --> 00:35:20,849
point the resolution anywhere they want

610
00:35:20,849 --> 00:35:24,349
most now where smart enough to
distinguish between

611
00:35:24,349 --> 00:35:28,089
this really is a controller in its not
so even if something connects to

612
00:35:28,089 --> 00:35:28,790
something

613
00:35:28,790 --> 00:35:32,660
if their victim machine connects to an
IP address it's not a control is really

614
00:35:32,660 --> 00:35:33,710
no harm to them

615
00:35:33,710 --> 00:35:37,569
so these 13 IP addresses point to the
DNS researchers

616
00:35:37,569 --> 00:35:41,490
so all 13 DNS root servers if I were a
bad person

617
00:35:41,490 --> 00:35:45,030
and wanted to screw the security company
that mindlessly talk

618
00:35:45,030 --> 00:35:48,319
IP addresses from malicious domains and
threw him into a firewall

619
00:35:48,319 --> 00:35:51,690
I put these in there because your break
dns1: organization

620
00:35:51,690 --> 00:35:55,700
completely and they will be down and
adversaries have done similar not

621
00:35:55,700 --> 00:35:57,640
exactly this but similar things where

622
00:35:57,640 --> 00:36:00,750
says okay somebody's surveilling my my
d-ga

623
00:36:00,750 --> 00:36:03,930
so I'm gonna play IP addresses that will
start breaking facts

624
00:36:03,930 --> 00:36:10,590
as I thought that was a particularly
interesting development

625
00:36:10,590 --> 00:36:14,160
this brings me to a point the to where I
started

626
00:36:14,160 --> 00:36:17,680
is at you know if you're taking
information simply based on information

627
00:36:17,680 --> 00:36:19,220
without any real analysis

628
00:36:19,220 --> 00:36:23,520
you know that could be catastrophic for
an organization

629
00:36:23,520 --> 00:36:27,140
and that's especially true when an
adversary is one highly rational

630
00:36:27,140 --> 00:36:30,190
to highly sophisticated and three knows
what you're doing

631
00:36:30,190 --> 00:36:33,610
you know security companies and
researchers most everything that we do

632
00:36:33,610 --> 00:36:34,620
is out in the open

633
00:36:34,620 --> 00:36:38,400
and easy to determine by adversaries so
this is why

634
00:36:38,400 --> 00:36:42,320
you know the active intelligence you
know is so important

635
00:36:42,320 --> 00:36:45,990
you know you can block those domain
names

636
00:36:45,990 --> 00:36:49,330
okay that's not really a problem there's
nothing really I

637
00:36:49,330 --> 00:36:53,130
no collateral damage to be at their but
IP address is under the control of the

638
00:36:53,130 --> 00:36:55,050
adversaries they can start manipulating
you

639
00:36:55,050 --> 00:36:58,550
in 10 so at least in my feeds you know
I've

640
00:36:58,550 --> 00:37:02,760
I've whitelisted the root servers and a
couple of other IP addresses after

641
00:37:02,760 --> 00:37:04,410
notice an adversarial action

642
00:37:04,410 --> 00:37:10,540
along those along those lines are some
who is

643
00:37:10,540 --> 00:37:13,710
Intel you know often actors

644
00:37:13,710 --> 00:37:16,710
reuse some the same information across
different

645
00:37:16,710 --> 00:37:21,240
different campaigns so it makes it easy
to correlate campaigns and correlate to

646
00:37:21,240 --> 00:37:22,280
other activities

647
00:37:22,280 --> 00:37:26,420
that somebody does I mention this little
bit earlier

648
00:37:26,420 --> 00:37:30,150
is that there are some registrars while
they offer who is protection

649
00:37:30,150 --> 00:37:34,660
they said they treat a unique strain
that allows you to map

650
00:37:34,660 --> 00:37:38,690
the same actor you may not know who they
really are but you can map the same

651
00:37:38,690 --> 00:37:42,460
actor to other domains even though
they're all under who is protection

652
00:37:42,460 --> 00:37:47,980
time so the reason this is important as
almost every successful criminal op

653
00:37:47,980 --> 00:37:51,500
penal prosecutions law enforcement
operation

654
00:37:51,500 --> 00:37:55,630
is due to some kind of operational
security screw up than an adversary did

655
00:37:55,630 --> 00:38:00,400
where you know they there was possible
to correlate domains

656
00:38:00,400 --> 00:38:04,230
back for five years and 45 years ago

657
00:38:04,230 --> 00:38:08,040
they registered a domain with the actual
main that allowed

658
00:38:08,040 --> 00:38:12,830
somebody to take legal action against
them select ability to decorrelation

659
00:38:12,830 --> 00:38:14,160
backwards

660
00:38:14,160 --> 00:38:19,170
has proven proven very helpful because
almost always given enough time

661
00:38:19,170 --> 00:38:21,940
I even a highly rational criminal actor

662
00:38:21,940 --> 00:38:25,490
I will generally screw-up can

663
00:38:25,490 --> 00:38:29,220
so we've talked a little bit about
surveillance you know and that's nice

664
00:38:29,220 --> 00:38:33,760
I you know but creation a fee data in
intake ovett in the firewalls intrusion

665
00:38:33,760 --> 00:38:34,710
detections

666
00:38:34,710 --> 00:38:38,530
is still generally a passive tactic you
know what it what about

667
00:38:38,530 --> 00:38:42,250
something a little bit more active is it
possible to simply notify and changes

668
00:38:42,250 --> 00:38:45,250
a so that he could take more I

669
00:38:45,250 --> 00:38:48,670
get more proactive action proactive
action

670
00:38:48,670 --> 00:38:52,920
time so possible to simply automated
notifications

671
00:38:52,920 --> 00:38:57,750
when there's key changes that happen in
terms of you domains being registered a

672
00:38:57,750 --> 00:38:58,770
new pipe knew I me

673
00:38:58,770 --> 00:39:03,150
new IP address is being used so for this
I use

674
00:39:03,150 --> 00:39:06,599
a an application called push push over
the

675
00:39:06,599 --> 00:39:10,650
available on Google and Apple Apple
stores as a very simple like

676
00:39:10,650 --> 00:39:14,579
at API you pass a key in whatever
message and all push on a notification

677
00:39:14,579 --> 00:39:15,530
your song

678
00:39:15,530 --> 00:39:19,160
the Sonus example you know

679
00:39:19,160 --> 00:39:22,990
it's a new tire domain registered here's
a domain

680
00:39:22,990 --> 00:39:27,170
the IP address in what country resolves
to so if I were

681
00:39:27,170 --> 00:39:31,140
interested in this I could turn around
and take some action or investigation on

682
00:39:31,140 --> 00:39:31,619
this

683
00:39:31,619 --> 00:39:35,430
now I know this is interesting because
the

684
00:39:35,430 --> 00:39:38,549
d-ga that I'm using for die right now
they

685
00:39:38,549 --> 00:39:42,079
the actors have moved off it for a
couple months this is actually just a

686
00:39:42,079 --> 00:39:43,130
security company

687
00:39:43,130 --> 00:39:47,210
registering a sinkhole three months
after the DG is already changed

688
00:39:47,210 --> 00:39:50,930
you something a little bit more
malicious

689
00:39:50,930 --> 00:39:55,480
our mats new which is a a word-based EJ
so it uses

690
00:39:55,480 --> 00:39:59,859
a date seed and a list of words to
create something that actually looks

691
00:39:59,859 --> 00:40:04,069
like it possibly could be a legitimate
domain so

692
00:40:04,069 --> 00:40:08,619
turned ash spread dash medicine so
there's three domains registered roughly

693
00:40:08,619 --> 00:40:11,430
the same time are should say three
domains it resolved roughly the same

694
00:40:11,430 --> 00:40:12,000
time

695
00:40:12,000 --> 00:40:15,779
you know years three aky addresses three
IP addresses

696
00:40:15,779 --> 00:40:19,760
name servers match well here's and
independence dot com

697
00:40:19,760 --> 00:40:23,020
maps to United States using a commodity
DNS

698
00:40:23,020 --> 00:40:28,579
a DNS server so in this particular case
I can look fairly quickly and say you

699
00:40:28,579 --> 00:40:29,039
know what

700
00:40:29,039 --> 00:40:33,880
these are my two bad domains this one
because it's a word-based UGA

701
00:40:33,880 --> 00:40:37,240
every now and then there's collusion
with something that actually is

702
00:40:37,240 --> 00:40:38,800
legitimate already exist

703
00:40:38,800 --> 00:40:43,780
you know this one is a collision are and
another interesting data point here is

704
00:40:43,780 --> 00:40:43,990
that

705
00:40:43,990 --> 00:40:47,990
even though these two were registered at
same time they're using two different

706
00:40:47,990 --> 00:40:48,950
registrars

707
00:40:48,950 --> 00:40:53,320
so this is a malicious actor who is
Canada for supplying

708
00:40:53,320 --> 00:40:56,450
what they're doing to be a little bit
more resilient

709
00:40:56,450 --> 00:41:00,310
so

710
00:41:00,310 --> 00:41:03,410
as you saw you know this to new domains
here

711
00:41:03,410 --> 00:41:07,100
Sam cast are and seed was Don so

712
00:41:07,100 --> 00:41:11,480
based on those 2i comparative it offer
those I and see what also served on

713
00:41:11,480 --> 00:41:13,940
those name servers to find additional
intelligence

714
00:41:13,940 --> 00:41:17,420
on you know caution is due had

715
00:41:17,420 --> 00:41:21,370
that may not always yield results and
certainly can yield false positives

716
00:41:21,370 --> 00:41:25,030
you know there's something that I'm
tracking right now involving

717
00:41:25,030 --> 00:41:28,460
commodity rats and various crime where

718
00:41:28,460 --> 00:41:31,500
the name server used by that

719
00:41:31,500 --> 00:41:35,270
points to an Iranian hosting company a

720
00:41:35,270 --> 00:41:39,990
you know being united states-based
anything Iran right now tends to you

721
00:41:39,990 --> 00:41:43,400
get people's shore up in the US

722
00:41:43,400 --> 00:41:46,740
but in that case it just happened to be
in Iranian hosting provider

723
00:41:46,740 --> 00:41:49,980
there are several security companies to
turn around and said oh look this is a

724
00:41:49,980 --> 00:41:54,920
Iranian nation-state based stuff now
this is just somebody using an A rating

725
00:41:54,920 --> 00:41:55,950
hosting company

726
00:41:55,950 --> 00:42:00,890
because that would be somebody would you
make some bad judgment about it

727
00:42:00,890 --> 00:42:04,090
and get out and chase so Canada's

728
00:42:04,090 --> 00:42:07,560
caveat there always correlate with
something else don't ever rely on one

729
00:42:07,560 --> 00:42:08,680
piece of information

730
00:42:08,680 --> 00:42:13,610
to make a conclusion can't I

731
00:42:13,610 --> 00:42:17,340
and as kinda last adversarial response

732
00:42:17,340 --> 00:42:20,840
I mention a little bit earlier starting
to see sinkhole where malware

733
00:42:20,840 --> 00:42:24,280
it's very true dan rudimentary right now
we're basically it

734
00:42:24,280 --> 00:42:28,630
it goes to the DG a chance to resolve it
and looks for

735
00:42:28,630 --> 00:42:32,680
indications of all this domain has some
sinkhole

736
00:42:32,680 --> 00:42:35,920
as a name sinkhole in its in its name
server:

737
00:42:35,920 --> 00:42:38,710
I'm just not gonna connect to it at all

738
00:42:38,710 --> 00:42:41,910
many sink also also include HTTP headers

739
00:42:41,910 --> 00:42:45,460
that's a x-23 call colon true

740
00:42:45,460 --> 00:42:48,780
something along the lines that advertise
themselves I

741
00:42:48,780 --> 00:42:52,150
so now we're starting to be developed
that will simply avoid that

742
00:42:52,150 --> 00:42:57,470
to bypass the sequels altogether which
word I take away our ability to do

743
00:42:57,470 --> 00:43:00,760
some intelligence on that so yeah I
thought it was a fairly

744
00:43:00,760 --> 00:43:10,560
interesting development so what will the
future hold

745
00:43:10,560 --> 00:43:14,950
I you know DJ's are going to be around
for a while I don't see them going away

746
00:43:14,950 --> 00:43:19,800
a anytime soon but too often be paired
with something else

747
00:43:19,800 --> 00:43:23,440
I to allow for communication so the DJ's

748
00:43:23,440 --> 00:43:27,180
and Torre de Jason I T PA DJ's in static
lists

749
00:43:27,180 --> 00:43:31,099
but because at least the last several
successful takedowns

750
00:43:31,099 --> 00:43:35,010
I've simply just seized all the domains
that once decapitated

751
00:43:35,010 --> 00:43:38,300
and that was at I certainly think toward

752
00:43:38,300 --> 00:43:42,740
tore will continue to be used because it
has some very good strong advantages

753
00:43:42,740 --> 00:43:47,770
I for criminal actors even though it's
fairly easy to block its use inside an

754
00:43:47,770 --> 00:43:48,670
organization

755
00:43:48,670 --> 00:43:53,140
a you know they're still some great
advantage is a good half

756
00:43:53,140 --> 00:43:57,060
the to the actor namely that it makes it
very difficult

757
00:43:57,060 --> 00:44:00,780
I don't ever want to say anything seemed
possible but very difficult to identify

758
00:44:00,780 --> 00:44:03,430
where the at infrastructure actually is

759
00:44:03,430 --> 00:44:06,890
and there's been a couple novel
interesting techniques to try to

760
00:44:06,890 --> 00:44:07,740
identify that

761
00:44:07,740 --> 00:44:11,150
and ultimately haven't panned out Sodus
point we're currently

762
00:44:11,150 --> 00:44:14,970
unless there's some other operational
security mistake

763
00:44:14,970 --> 00:44:18,589
there's no good way to identify where a
tour

764
00:44:18,589 --> 00:44:21,910
I to be had services are and ok

765
00:44:21,910 --> 00:44:25,849
there'll be an increase in the use of
interesting dynamic seats

766
00:44:25,849 --> 00:44:29,569
so I mention BT twitch uses European

767
00:44:29,569 --> 00:44:33,900
the European central banks a foreign
exchange values

768
00:44:33,900 --> 00:44:35,650
which is fairly new

769
00:44:35,650 --> 00:44:38,840
and I was a fairly interesting thing I
certainly think that kinda development

770
00:44:38,840 --> 00:44:40,610
will happen whether be some kind of

771
00:44:40,610 --> 00:44:44,530
a seed it's used where it's only valid
for a given day

772
00:44:44,530 --> 00:44:48,790
and there's no predictability going
forward which would also severely hamper

773
00:44:48,790 --> 00:44:49,690
any kind of

774
00:44:49,690 --> 00:44:53,270
a enforcement action that we would take
on

775
00:44:53,270 --> 00:44:56,340
can't so

776
00:44:56,340 --> 00:45:00,120
and my presentation thank you other Lake
right there

777
00:45:00,120 --> 00:45:04,030
is a list of the various speeds and I
produce if anybody is

778
00:45:04,030 --> 00:45:08,090
interested in using them in taking a
look and are there any questions

779
00:45:08,090 --> 00:45:12,080
I

780
00:45:12,080 --> 00:45:17,750
Michael from there good

781
00:45:17,750 --> 00:45:20,960
been on law

782
00:45:20,960 --> 00:45:24,430
thank you for the petition I or want to

783
00:45:24,430 --> 00:45:28,940
on as a question regarding for
decentralized systems which I am

784
00:45:28,940 --> 00:45:31,570
interested in for example name cohen
which is a

785
00:45:31,570 --> 00:45:36,230
between folk that on allows for food to
centralize keep a new storm

786
00:45:36,230 --> 00:45:39,420
which is used for maintaining and a

787
00:45:39,420 --> 00:45:42,590
decentralized domain name system %uh

788
00:45:42,590 --> 00:45:46,740
which I can and traditional diminish I
just can't

789
00:45:46,740 --> 00:45:50,430
%uh control so with it used in Melbourne

790
00:45:50,430 --> 00:45:54,620
are and are other are it going to lay
the technologies

791
00:45:54,620 --> 00:45:57,940
use that for example a you mentioned
using

792
00:45:57,940 --> 00:46:01,420
anti-european bank exchange rates as a
seed

793
00:46:01,420 --> 00:46:04,480
in for example the malware could use so

794
00:46:04,480 --> 00:46:09,740
big crime locations as seeds which are
also unpredictable

795
00:46:09,740 --> 00:46:13,620
but I'll which are impossible to

796
00:46:13,620 --> 00:46:19,480
takedown thinker I services two parts I
question the first is to use a

797
00:46:19,480 --> 00:46:20,740
decentralized

798
00:46:20,740 --> 00:46:24,080
I name services and as it used I am

799
00:46:24,080 --> 00:46:28,010
certainly not popularly most the main
line now we're on track he don't use it

800
00:46:28,010 --> 00:46:31,400
I I don't think I've seen any anything

801
00:46:31,400 --> 00:46:34,660
proof of concept that uses a get on

802
00:46:34,660 --> 00:46:38,110
and the second is the user's a

803
00:46:38,110 --> 00:46:41,800
in a bit coin indicators as a dynamic
seed

804
00:46:41,800 --> 00:46:46,980
on really that I think the first
mainline attendees a dynamic seed was

805
00:46:46,980 --> 00:46:50,020
was BD so I think

806
00:46:50,020 --> 00:46:53,600
as long as it's something that could be
access

807
00:46:53,600 --> 00:46:56,940
statically easy than I think it could be
used

808
00:46:56,940 --> 00:47:01,520
I think the problem that you would if I
were a criminal

809
00:47:01,520 --> 00:47:04,720
picking a dynamic seed the problem

810
00:47:04,720 --> 00:47:08,660
using anything within decline you
probably have to download the entire

811
00:47:08,660 --> 00:47:12,540
black chain to get any information which
I I don't invest rate

812
00:47:12,540 --> 00:47:17,200
are you okay did you can clearly in 10

813
00:47:17,200 --> 00:47:21,470
on dan yeah I I I see no reason that it
could be used

814
00:47:21,470 --> 00:47:24,500
the concern with clearing anything
outward is

815
00:47:24,500 --> 00:47:28,710
better while it makes it hard to take
down domains in the future

816
00:47:28,710 --> 00:47:32,920
it certainly produces some additional
intelligence because all the sudden

817
00:47:32,920 --> 00:47:36,390
you know you got a million people
clearing the same fate

818
00:47:36,390 --> 00:47:40,289
any when it's not only a small amount up
but I don't see any reason why that

819
00:47:40,289 --> 00:47:41,079
could be used

820
00:47:41,079 --> 00:47:50,609
ca other questions

821
00:47:50,609 --> 00:47:52,140
yeah

822
00:47:52,140 --> 00:47:54,999
alrighty well thank you and enjoy the
rest your conference

