1
00:00:02,300 --> 00:00:03,379
show you all

2
00:00:03,379 --> 00:00:06,879
a little bit of a deep dive into ideas
GPFS

3
00:00:06,879 --> 00:00:10,490
which is a cluster filesystem and we
have some

4
00:00:10,490 --> 00:00:15,679
like laying alt problems we couldn't
attach to the screens right here this is

5
00:00:15,679 --> 00:00:16,059
why

6
00:00:16,059 --> 00:00:21,119
we have a set up like this I hope that
my laptop is not going to fall down

7
00:00:21,119 --> 00:00:26,150
I'm anyways this is the agenda we're
going to talk about the technology

8
00:00:26,150 --> 00:00:27,689
overview first so

9
00:00:27,689 --> 00:00:31,510
we are going to give you a deep dive
into how a GPFS works

10
00:00:31,510 --> 00:00:37,260
I'm we are going to a stick to this
threefold structures whole basically

11
00:00:37,260 --> 00:00:38,309
we're first going

12
00:00:38,309 --> 00:00:43,379
into local attack back to us for the
high system for GPS as

13
00:00:43,379 --> 00:00:47,170
then we're going to take a look at the
remote you will hold us to give st. a

14
00:00:47,170 --> 00:00:48,640
tax office up to give us the

15
00:00:48,640 --> 00:00:52,520
from the outside to an attacker and then
we're going to the core which means the

16
00:00:52,520 --> 00:00:54,370
camera modules and all that is

17
00:00:54,370 --> 00:00:59,550
a it in the coral GPFS and hopefully we
will have the chance to have a Q&A

18
00:00:59,550 --> 00:01:00,070
session

19
00:01:00,070 --> 00:01:03,550
after what's so to give you a technology
overview real quick

20
00:01:03,550 --> 00:01:07,950
IBM's a general parallel file system

21
00:01:07,950 --> 00:01:12,520
is a cluster file system we named our
talk general program fire system

22
00:01:12,520 --> 00:01:16,659
because we think that quite a lot in the
architectural GPFS

23
00:01:16,659 --> 00:01:19,930
flaw as you will see in a minute I'm

24
00:01:19,930 --> 00:01:23,729
it claims to be fast simple and
scaleable which is we took that off

25
00:01:23,729 --> 00:01:27,170
of the website we have no idea if it's
really fast simple and scaleable

26
00:01:27,170 --> 00:01:31,470
I'm and it basically works like multiple
notes that get interconnected to each

27
00:01:31,470 --> 00:01:32,090
other

28
00:01:32,090 --> 00:01:36,619
and you have like two main operation
modes on it one is like the song mode

29
00:01:36,619 --> 00:01:39,650
which means that the notes are connected
to a son

30
00:01:39,650 --> 00:01:43,540
and the other one is network said discs
maynes you have

31
00:01:43,540 --> 00:01:47,890
a disc on one of the notes and you can
share the status on the disc

32
00:01:47,890 --> 00:01:53,360
throughout the whole cluster that
different operating system support us

33
00:01:53,360 --> 00:01:56,799
we are looking at a all research was
based on

34
00:01:56,799 --> 00:01:59,979
a GPS 3.5 on Linux and

35
00:01:59,979 --> 00:02:03,799
you can get it for Windows origin X
systems and for Linux

36
00:02:03,799 --> 00:02:06,950
basically they support all operating
systems a

37
00:02:06,950 --> 00:02:11,110
it has a really long history Sol I'm
when we found

38
00:02:11,110 --> 00:02:15,240
from or when we research were
researching it we we encountered at the

39
00:02:15,240 --> 00:02:16,190
customer sites

40
00:02:16,190 --> 00:02:19,190
doing improv penetration test and

41
00:02:19,190 --> 00:02:22,470
we were looking into how to game higher
privileges

42
00:02:22,470 --> 00:02:27,450
on a one of the notes but we had no
privileged access to what we have found

43
00:02:27,450 --> 00:02:29,550
by injuries that started with TS

44
00:02:29,550 --> 00:02:35,710
and mm s TS is kind of the tiger shark
fire system so they are binary is

45
00:02:35,710 --> 00:02:39,750
from like 1993 laying around on the
filesystem

46
00:02:39,750 --> 00:02:42,959
that I used to administrate a the
cluster

47
00:02:42,959 --> 00:02:47,670
all the note and then you have like MMFs
with which is the multimedia file

48
00:02:47,670 --> 00:02:48,360
systems

49
00:02:48,360 --> 00:02:51,790
this technology is quite old as you can
see in 1993

50
00:02:51,790 --> 00:02:56,030
and it is basically use in many
supercomputers

51
00:02:56,030 --> 00:03:00,170
and its basically if you have a cluster
architecture somewhere and you need to

52
00:03:00,170 --> 00:03:01,750
shop around Big Data

53
00:03:01,750 --> 00:03:05,760
then there's a high chance a high
probability that you can

54
00:03:05,760 --> 00:03:11,140
encounter GPFS even hurt that some of
the three-letter agencies are using its

55
00:03:11,140 --> 00:03:11,959
to do

56
00:03:11,959 --> 00:03:16,700
I don't know research I'll call it okay

57
00:03:16,700 --> 00:03:20,650
so what kind of components are in that
we have basically this threefold

58
00:03:20,650 --> 00:03:21,350
structure

59
00:03:21,350 --> 00:03:24,590
we have you space utilities these are
basically

60
00:03:24,590 --> 00:03:28,230
the ones that you've seen here they
start with TS or MMS

61
00:03:28,230 --> 00:03:31,340
I'm the more than 200 of these binaries

62
00:03:31,340 --> 00:03:35,209
on the filesystem if you install GPFS

63
00:03:35,209 --> 00:03:39,110
there are a bunch of shell scripts
laying around and basically

64
00:03:39,110 --> 00:03:42,340
most of them are just something a plane
copies of

65
00:03:42,340 --> 00:03:46,820
I I'm a handful of binaries so when you
start the binary

66
00:03:46,820 --> 00:03:50,560
it basically stopped to detect whole its
own name is

67
00:03:50,560 --> 00:03:55,640
and then it starts to do something some
of them are set to ID

68
00:03:55,640 --> 00:03:58,989
which makes it a prime target for attack
of a local attacker

69
00:03:58,989 --> 00:04:03,000
and this basically sums up the userspace
fertility so a lot of business

70
00:04:03,000 --> 00:04:03,769
activities

71
00:04:03,769 --> 00:04:07,130
and the most share a fast

72
00:04:07,130 --> 00:04:07,930
a

73
00:04:07,930 --> 00:04:12,409
called basis then you have the
communication even running on all of the

74
00:04:12,409 --> 00:04:13,030
hosts

75
00:04:13,030 --> 00:04:18,180
it is called MMF St and it uses a
proprietary communication protocol via

76
00:04:18,180 --> 00:04:18,930
TCP

77
00:04:18,930 --> 00:04:22,300
to shop around the day time to get data
to get information

78
00:04:22,300 --> 00:04:26,820
the one of the main parts is the counter
module

79
00:04:26,820 --> 00:04:30,050
of the two common modules basically the
job and

80
00:04:30,050 --> 00:04:33,280
account models that are all dolled I'm
the car

81
00:04:33,280 --> 00:04:37,880
kinda model is a binary only con Madre
and then you'll have a wrapper module a

82
00:04:37,880 --> 00:04:38,590
rounded

83
00:04:38,590 --> 00:04:43,690
that is available as open source which
makes it quite nice to research

84
00:04:43,690 --> 00:04:48,400
okay so coming from this you just
visited his communication demand and

85
00:04:48,400 --> 00:04:51,100
become a model we need you to remember
this structure

86
00:04:51,100 --> 00:04:54,610
we've built up a small checklist for you
so

87
00:04:54,610 --> 00:04:57,889
remember this structure in your talk we
have use the space it it's just the

88
00:04:57,889 --> 00:04:58,639
communication

89
00:04:58,639 --> 00:05:02,919
human become more and as you can imagine
we will start right away with the

90
00:05:02,919 --> 00:05:04,220
userspace utilities

91
00:05:04,220 --> 00:05:08,599
so we at I set react on the GPFS

92
00:05:08,599 --> 00:05:13,250
in a project at a customer site we were
researching on how to gain higher

93
00:05:13,250 --> 00:05:13,970
privileges

94
00:05:13,970 --> 00:05:18,190
on the system I'm and the Wii U were
looking into

95
00:05:18,190 --> 00:05:21,630
love we were identifying said through
it. finds that a

96
00:05:21,630 --> 00:05:24,740
are on the I'm on the host

97
00:05:24,740 --> 00:05:27,919
everything you see right here is like
tiger shark

98
00:05:27,919 --> 00:05:28,650
a

99
00:05:28,650 --> 00:05:33,440
I'm Administrative Tools and the ones in
red other side right you by no means and

100
00:05:33,440 --> 00:05:34,840
if you look at one of those

101
00:05:34,840 --> 00:05:38,340
a fast one that we picked was to use
state owes

102
00:05:38,340 --> 00:05:42,240
because it summer quite simple and what
it does it if you started

103
00:05:42,240 --> 00:05:45,430
simply princes out if the file system is
running

104
00:05:45,430 --> 00:05:48,620
or if it's not wrong saw just that's it

105
00:05:48,620 --> 00:05:53,610
then you can feed arguments we found out
that you can basically

106
00:05:53,610 --> 00:05:56,710
I think only put one argument in their
and

107
00:05:56,710 --> 00:05:59,900
if you are and this argument is a

108
00:05:59,900 --> 00:06:03,080
the name all filesystem so what you can
do

109
00:06:03,080 --> 00:06:07,630
is you can check if unknown filesystem
in the cluster is still alive

110
00:06:07,630 --> 00:06:11,990
if it's there if it's connected and
what's the status and

111
00:06:11,990 --> 00:06:15,230
the first thing that we tried is a
putting a bunch

112
00:06:15,230 --> 00:06:18,710
a sentence to feed upon surveys we knew
it was like why

113
00:06:18,710 --> 00:06:22,700
must be an old binary it's quite old and
we fed upon

114
00:06:22,700 --> 00:06:27,220
a is nothing happened there is a check a
nevertheless its using lot of string

115
00:06:27,220 --> 00:06:28,490
property is tough spot

116
00:06:28,490 --> 00:06:31,590
everything was safe from this
perspective and

117
00:06:31,590 --> 00:06:35,680
the next thing that we did was we fed it
a classic format string

118
00:06:35,680 --> 00:06:38,790
I'm to see if something's happening
right here

119
00:06:38,790 --> 00:06:42,440
and as you can see the press and X right
here

120
00:06:42,440 --> 00:06:45,910
gives us arm something that looks like
an address

121
00:06:45,910 --> 00:06:50,580
sold the output is not what we fed into
the binary you know it's

122
00:06:50,580 --> 00:06:55,000
seems to be something that is coming off
stack so this is a classic indicator for

123
00:06:55,000 --> 00:06:56,220
having a format string

124
00:06:56,220 --> 00:07:00,450
for ability in the binary and it's a set
writing binary as I mentioned

125
00:07:00,450 --> 00:07:03,700
okay I'm not all by

126
00:07:03,700 --> 00:07:08,280
specify multiple person excess freeware
able to retrieve stuff of the stack as

127
00:07:08,280 --> 00:07:09,360
you can see here

128
00:07:09,360 --> 00:07:12,600
a looks again like a classic format
string

129
00:07:12,600 --> 00:07:17,130
approach we then use the person and
identify it to see if there really is

130
00:07:17,130 --> 00:07:17,750
still

131
00:07:17,750 --> 00:07:22,380
informant string and as you can see it
in a segmentation fault happens this is

132
00:07:22,380 --> 00:07:22,850
why

133
00:07:22,850 --> 00:07:25,870
percent and basically writes the number
of of bytes

134
00:07:25,870 --> 00:07:29,110
written so far to an address in memory
and

135
00:07:29,110 --> 00:07:33,140
if this happens most likely will crest
binary and this is what you can see you

136
00:07:33,140 --> 00:07:33,910
what is happening

137
00:07:33,910 --> 00:07:37,380
right here next stop was the person ass

138
00:07:37,380 --> 00:07:41,090
we tried to fielded a person s and see
what was going on

139
00:07:41,090 --> 00:07:45,740
and as you can see you now basically
what we've expected

140
00:07:45,740 --> 00:07:48,890
is are thats

141
00:07:48,890 --> 00:07:52,330
Majhi happening right here thank you
very much that looks better now

142
00:07:52,330 --> 00:07:55,790
and so the person s that you can see
here

143
00:07:55,790 --> 00:07:59,470
should receive also retrieve stuff from
the stack

144
00:07:59,470 --> 00:08:03,080
but as you can see is we get an error
message stating that we have lost

145
00:08:03,080 --> 00:08:04,730
connection for the filesystem

146
00:08:04,730 --> 00:08:09,660
human so investigating this issue a
little bit farther piece of that

147
00:08:09,660 --> 00:08:15,080
we were able to crash the filesystem the
man with the press and s identify and we

148
00:08:15,080 --> 00:08:17,730
actually have no clue why this is
happening

149
00:08:17,730 --> 00:08:21,330
so percent X behaves like a normal
format string press and

150
00:08:21,330 --> 00:08:24,980
and creches this binary right here
expected behaviour

151
00:08:24,980 --> 00:08:28,610
person s precious them filesystem demand
and we were like

152
00:08:28,610 --> 00:08:32,500
what lies oppression saw we thought

153
00:08:32,500 --> 00:08:36,000
this is a pretty standard format string
vulnerability

154
00:08:36,000 --> 00:08:39,409
and this should be exploitable and

155
00:08:39,410 --> 00:08:42,969
we from where r looking at

156
00:08:42,969 --> 00:08:45,310
how to exploit that we were

157
00:08:45,310 --> 00:08:49,120
looking into the binary a little bit but
there was still this question hanging

158
00:08:49,120 --> 00:08:49,750
around

159
00:08:49,750 --> 00:08:53,190
why can we crash the filesystem the man
with the person

160
00:08:53,190 --> 00:08:56,760
ass so what we did first the ball was
because the

161
00:08:56,760 --> 00:09:01,279
the guys a you weapon testing put a
little pressure on

162
00:09:01,279 --> 00:09:04,329
on its and you report it a this

163
00:09:04,329 --> 00:09:08,019
vulnerability instantly to IBM but we
did not

164
00:09:08,019 --> 00:09:11,990
like submit an exploit we just use the
proof of concept that

165
00:09:11,990 --> 00:09:15,790
basically had at the the memory
corruption of the format string in it

166
00:09:15,790 --> 00:09:19,450
and was showing than we were able to
crash the filesystem

167
00:09:19,450 --> 00:09:22,730
human and this looks like a classic
format string vulnerability

168
00:09:22,730 --> 00:09:26,950
so they put out a CE a/c he was kind of
score

169
00:09:26,950 --> 00:09:32,140
pretty low most probably because we did
not submit an exploit for it

170
00:09:32,140 --> 00:09:36,089
re just used for the night love serve as
proof of concept this is why they

171
00:09:36,089 --> 00:09:37,480
started with for

172
00:09:37,480 --> 00:09:42,079
and if you read all or the the security
number or the CPUC that

173
00:09:42,079 --> 00:09:45,120
up security for a bit has been
identified that can result in a

174
00:09:45,120 --> 00:09:46,500
denial-of-service

175
00:09:46,500 --> 00:09:50,980
we kind of thought at this point of time
this is the classic format string so

176
00:09:50,980 --> 00:09:52,820
this would not only be denied us others

177
00:09:52,820 --> 00:09:56,160
upgrade to the little bit higher and
they stated

178
00:09:56,160 --> 00:09:59,260
has not yet shown to cause any other
side side effects

179
00:09:59,260 --> 00:10:02,720
besides the program terminating and

180
00:10:02,720 --> 00:10:06,699
affect said do it. kamande so by reading
this CPU

181
00:10:06,699 --> 00:10:10,740
we thought challenge accepted we need to
provide something

182
00:10:10,740 --> 00:10:14,550
that kind of does a little bit more
besides just pressing the file system

183
00:10:14,550 --> 00:10:15,269
daemon

184
00:10:15,269 --> 00:10:19,040
so we had our research time um

185
00:10:19,040 --> 00:10:22,260
we right debugging a little bits a as

186
00:10:22,260 --> 00:10:26,500
I said before this part completely
looked like a normal format string

187
00:10:26,500 --> 00:10:30,829
I'm read still didn't know why MMF St
was crashing

188
00:10:30,829 --> 00:10:34,540
we just ignore this fact and and went on
researching

189
00:10:34,540 --> 00:10:38,420
on what was happening and what we find
out

190
00:10:38,420 --> 00:10:42,640
of found out by using as trace is but if
you will start

191
00:10:42,640 --> 00:10:45,769
the binary tea estate us with one
argument

192
00:10:45,769 --> 00:10:49,079
but just ate us

193
00:10:49,079 --> 00:10:52,310
will buy into a random TCP port on

194
00:10:52,310 --> 00:10:55,970
all network interfaces it with them

195
00:10:55,970 --> 00:10:59,390
send the part number up and the
user-supplied

196
00:10:59,390 --> 00:11:04,510
import into a local message queue then

197
00:11:04,510 --> 00:11:07,680
the fine system demon after reading the
message queue

198
00:11:07,680 --> 00:11:13,100
connects to the port and sends the
result back to the binary

199
00:11:13,100 --> 00:11:18,110
I'm going over this quite slow because
you have to understand what what's

200
00:11:18,110 --> 00:11:20,290
really happening here because this is
really critical

201
00:11:20,290 --> 00:11:23,690
and then yes they just simply is
printing the result so again

202
00:11:23,690 --> 00:11:27,400
you fire up the TS status binary rights
its part number:

203
00:11:27,400 --> 00:11:30,760
into a message queue or the demand has
come to look into the message queue

204
00:11:30,760 --> 00:11:35,090
picking out the part connecting to the
binary that you're just ordered

205
00:11:35,090 --> 00:11:38,170
and suggests giving you import based on
the

206
00:11:38,170 --> 00:11:41,530
input that the use applied in part to
fed okay

207
00:11:41,530 --> 00:11:45,640
but waits while analyzing this behavior

208
00:11:45,640 --> 00:11:50,210
white especially the the part where the

209
00:11:50,210 --> 00:11:54,980
MMFs the year is connecting to the part
tortilla status and sending back the

210
00:11:54,980 --> 00:11:55,550
result

211
00:11:55,550 --> 00:12:00,510
we were encountering this know if you
look closely at this the second in as

212
00:12:00,510 --> 00:12:03,630
trace output you see like a read here
which is

213
00:12:03,630 --> 00:12:06,890
coming over the network services start
others coming over the network

214
00:12:06,890 --> 00:12:10,250
and then use your right here which is
the error message that is printed on but

215
00:12:10,250 --> 00:12:11,370
your status

216
00:12:11,370 --> 00:12:16,510
what you see right here is that they
actually sending

217
00:12:16,510 --> 00:12:20,080
of format string over the network

218
00:12:20,080 --> 00:12:24,110
so we're not getting this arrow message

219
00:12:24,110 --> 00:12:27,670
as string over the network we are
getting

220
00:12:27,670 --> 00:12:30,940
an error message with a

221
00:12:30,940 --> 00:12:36,290
a format string and the corresponding
suspect for this format string

222
00:12:36,290 --> 00:12:40,450
over that work to the binary saw

223
00:12:40,450 --> 00:12:44,860
going back to the walkthrough if the
file system daemon connects to the local

224
00:12:44,860 --> 00:12:45,780
part

225
00:12:45,780 --> 00:12:48,950
it does not send the result simply the
result but

226
00:12:48,950 --> 00:12:52,370
it sends it for murdered as a format
string plus

227
00:12:52,370 --> 00:12:56,830
the corresponding step and because

228
00:12:56,830 --> 00:12:58,459
this recreation

229
00:12:58,459 --> 00:13:02,250
does not support percent s this is los

230
00:13:02,250 --> 00:13:05,430
what what actually pressed for MMS St
because it

231
00:13:05,430 --> 00:13:09,220
did it what they did not implement like
the person

232
00:13:09,220 --> 00:13:12,540
s identify a and that's why it's just
simply crashes

233
00:13:12,540 --> 00:13:16,130
okay so this was the reason why MFS
discretion

234
00:13:16,130 --> 00:13:19,300
so but keep in mind what is happening
right here

235
00:13:19,300 --> 00:13:22,550
is a.m. MST is sending

236
00:13:22,550 --> 00:13:25,839
format string and the corresponding
stack over the network

237
00:13:25,839 --> 00:13:29,389
soul we came up with some ideas for the
attack

238
00:13:29,389 --> 00:13:32,490
what happens if we cannot to treat your
status

239
00:13:32,490 --> 00:13:37,110
instead of them MFS the sent over the
format string

240
00:13:37,110 --> 00:13:41,470
and our controls that weekend influence
the state and control it completely

241
00:13:41,470 --> 00:13:45,759
so that should be review straightforward
so-called execution right now

242
00:13:45,759 --> 00:13:49,259
but we have to challenge us right there
one is speed

243
00:13:49,259 --> 00:13:52,579
and the other one is the random party a
status putting up

244
00:13:52,579 --> 00:13:57,339
when it is starting so for the random
part we did some research

245
00:13:57,339 --> 00:14:01,029
and we reverse-engineered the binary and
we found

246
00:14:01,029 --> 00:14:04,970
a environment variable GPFS cm deep of
range

247
00:14:04,970 --> 00:14:08,750
which a concert to arbitrary values and
then your status

248
00:14:08,750 --> 00:14:11,920
with a on luck to you be this or

249
00:14:11,920 --> 00:14:16,000
that you specify so from a local attack
upon to view this is Scott

250
00:14:16,000 --> 00:14:19,100
because we don't have to deal with the
random hot we can just specify

251
00:14:19,100 --> 00:14:22,769
apart and for the race condition
connecting

252
00:14:22,769 --> 00:14:27,149
to but yes they just binary to the
specified port earlier than the MMS

253
00:14:27,149 --> 00:14:30,680
year I'm we have just to be faster than
MST

254
00:14:30,680 --> 00:14:34,250
the racist easy to win on a motive call
system

255
00:14:34,250 --> 00:14:37,500
we tested it on san ka systems and we're
not able to

256
00:14:37,500 --> 00:14:40,550
win the race all the time I'm a
colleague of

257
00:14:40,550 --> 00:14:45,370
us just said like why don't you just put
a few months ago use into your bottom

258
00:14:45,370 --> 00:14:46,519
testing machines

259
00:14:46,519 --> 00:14:49,930
and that basically worked so we we were
able to

260
00:14:49,930 --> 00:14:52,939
I I would have guessed that we would %um
have been able to

261
00:14:52,939 --> 00:14:57,160
win the race with job law no we r we're
using Python and it works fine

262
00:14:57,160 --> 00:15:00,269
I'm looking into it a bit more we

263
00:15:00,269 --> 00:15:03,649
are had some problems especially
establishing a connection or to send

264
00:15:03,649 --> 00:15:05,750
over the data that we want to send

265
00:15:05,750 --> 00:15:10,180
to tea estate owes and looking at the
binary use all that there's a cocky but

266
00:15:10,180 --> 00:15:13,459
your some kind of cookie value and a
debugger

267
00:15:13,459 --> 00:15:16,839
and looking at it and a little bit more
detailed it turns out that this is just

268
00:15:16,839 --> 00:15:17,510
the pit

269
00:15:17,510 --> 00:15:21,380
of tea estate or so that the whole
authentication but a manifest

270
00:15:21,380 --> 00:15:24,390
is giving to the state us is basically
is

271
00:15:24,390 --> 00:15:28,029
pit the process for soul I'm

272
00:15:28,029 --> 00:15:31,370
exploits kind of should look like the
following:

273
00:15:31,370 --> 00:15:35,000
first part reassessing all hard with an
environment variable

274
00:15:35,000 --> 00:15:39,709
we can win the race against a.m. MST we
are sending to your status

275
00:15:39,709 --> 00:15:43,480
it spit for authentication and in the
second part we just

276
00:15:43,480 --> 00:15:46,810
two hours of code execution that's it

277
00:15:46,810 --> 00:15:50,019
pretty simple saw

278
00:15:50,019 --> 00:15:54,670
we have an opportunity to ride by using
the present and modify out this is

279
00:15:54,670 --> 00:15:57,790
how we tribes to achieve code execution
all

280
00:15:57,790 --> 00:16:01,180
and so we have this format string and
our control stack

281
00:16:01,180 --> 00:16:05,070
we haven't Albert R NY arrives the
binary is not high and neighbors

282
00:16:05,070 --> 00:16:08,290
we have constant addresses which is
quite good from

283
00:16:08,290 --> 00:16:12,010
although the system libraries and sticky
pedals a randomized

284
00:16:12,010 --> 00:16:15,200
we are encountering the problem that we
cannot do

285
00:16:15,200 --> 00:16:18,980
and information week so not ready when
you have a format string from

286
00:16:18,980 --> 00:16:22,089
vulnerability you can leak stuff from
the start

287
00:16:22,089 --> 00:16:25,110
and see if there are some interesting
point us and if these

288
00:16:25,110 --> 00:16:28,310
on just what they have and you can
calculate the offsets and just try to

289
00:16:28,310 --> 00:16:29,520
get direct but working

290
00:16:29,520 --> 00:16:32,670
in this case this is not something that
we can do because

291
00:16:32,670 --> 00:16:37,270
from in our case we control the suspects
all the stuff that we are

292
00:16:37,270 --> 00:16:40,990
giving as the stack is not a real
stacked and tea estate us

293
00:16:40,990 --> 00:16:44,410
it is the stuff that we're sending over
the network so and in for the is not

294
00:16:44,410 --> 00:16:45,220
possible

295
00:16:45,220 --> 00:16:49,880
that we a decided okay what can we
override

296
00:16:49,880 --> 00:16:53,390
still override we went for function
pointers

297
00:16:53,390 --> 00:16:56,779
name year a global off the table and a

298
00:16:56,779 --> 00:17:01,600
we just tried to override library
functions so what we need to do is find

299
00:17:01,600 --> 00:17:04,760
a library function that is called after
the format string is triggered

300
00:17:04,760 --> 00:17:09,230
alright its point A and let it .2 with
the start all rock chain

301
00:17:09,230 --> 00:17:12,939
for example um the problem is that the
buyer is

302
00:17:12,939 --> 00:17:16,680
quite small and we could not find you
perspective up to

303
00:17:16,680 --> 00:17:20,210
all-star obtain so okay so we were
sitting there

304
00:17:20,210 --> 00:17:25,350
having like problems getting are opting
to work we came up with another idea

305
00:17:25,350 --> 00:17:29,130
you were just override the library
function to one library function

306
00:17:29,130 --> 00:17:32,370
with a different one for example we were
just override

307
00:17:32,370 --> 00:17:35,990
the pointer to print with the pointer to
a system the problem

308
00:17:35,990 --> 00:17:39,410
here is that we could not find any
compatible ivory function

309
00:17:39,410 --> 00:17:42,930
so this from the perspective right now
looks

310
00:17:42,930 --> 00:17:46,660
quite hard because you can just start of
your %ah

311
00:17:46,660 --> 00:17:51,430
chain you cannot overrides function
pointers 2.2 interesting functions like

312
00:17:51,430 --> 00:17:52,220
system

313
00:17:52,220 --> 00:17:55,540
and we were basically nearly at the end

314
00:17:55,540 --> 00:17:59,580
but then we came up with an alternative
approach

315
00:17:59,580 --> 00:18:03,820
by reversing the binary a little bit
more we found out that

316
00:18:03,820 --> 00:18:07,330
a the communication between MST

317
00:18:07,330 --> 00:18:10,590
and your status is basically using
difference

318
00:18:10,590 --> 00:18:15,130
kind of message types so the first
message type that we were using

319
00:18:15,130 --> 00:18:19,360
was display message just does was
assessed at this place

320
00:18:19,360 --> 00:18:22,890
the message and you have general RR we
didn't even take a look at this

321
00:18:22,890 --> 00:18:26,590
on I have no idea what it does actually
it bucks a little bit the same like

322
00:18:26,590 --> 00:18:28,420
display message but we we didn't

323
00:18:28,420 --> 00:18:32,090
look at this and when the then we
stumble upon added message

324
00:18:32,090 --> 00:18:35,690
which is quite interesting because edit
messages

325
00:18:35,690 --> 00:18:39,090
base does what its has the Sahara sands

326
00:18:39,090 --> 00:18:42,720
at message with an arbitrary context
content

327
00:18:42,720 --> 00:18:46,300
text content and the common line tool

328
00:18:46,300 --> 00:18:50,370
writes this content what just ate us
work on it your status in our case

329
00:18:50,370 --> 00:18:54,280
a.m. writes it into a temporary file
drops the privileges

330
00:18:54,280 --> 00:18:57,670
opens the edits are specified in the at
a time by improper

331
00:18:57,670 --> 00:19:01,200
variable and that's the Jews that added
this text

332
00:19:01,200 --> 00:19:05,050
you can see that right here so

333
00:19:05,050 --> 00:19:09,430
we have like environment variable if
this is not set it drops to be I

334
00:19:09,430 --> 00:19:13,360
then it's thrilling a dropping
privileges

335
00:19:13,360 --> 00:19:16,110
and executing a

336
00:19:16,110 --> 00:19:20,030
edit or with the text that we are
sending over the network

337
00:19:20,030 --> 00:19:23,180
so the user can edit the file all that
the message

338
00:19:23,180 --> 00:19:28,600
safe it exit the edit or close the Edit
on the data sent back

339
00:19:28,600 --> 00:19:32,750
soul what we're going to do with this
now

340
00:19:32,750 --> 00:19:35,920
is we are sending three messages

341
00:19:35,920 --> 00:19:39,550
the first two messages will override

342
00:19:39,550 --> 00:19:43,850
the set group and said user ID with
address operetta instruction

343
00:19:43,850 --> 00:19:47,080
which basically it means that we're
going to mop alt

344
00:19:47,080 --> 00:19:50,970
get said it grew but you said you liked

345
00:19:50,970 --> 00:19:54,230
soul this should not drop privileges
right now

346
00:19:54,230 --> 00:19:57,360
author message with them trigger

347
00:19:57,360 --> 00:20:02,360
and added message command which
basically sets the environment variable

348
00:20:02,360 --> 00:20:03,830
to use a pen pal

349
00:20:03,830 --> 00:20:07,190
and the text that we are going to send
over is

350
00:20:07,190 --> 00:20:11,580
simply something like this reusing said
throughout the subgroup idea and then

351
00:20:11,580 --> 00:20:13,750
Red Rock dropping to system bin bash

352
00:20:13,750 --> 00:20:17,070
I'm going to

353
00:20:17,070 --> 00:20:22,190
give the the control rolled back to
Phoenix right now because he's going to

354
00:20:22,190 --> 00:20:43,029
demonstrate all this is going to work

355
00:20:43,029 --> 00:20:46,989
so unfortunately do resolution is a big
bat to hope you can see

356
00:20:46,989 --> 00:20:51,049
explode so on the left side restart

357
00:20:51,049 --> 00:20:56,200
0 explode which is basically just a
Python script

358
00:20:56,200 --> 00:20:59,320
trying to connect to our halt and
sending

359
00:20:59,320 --> 00:21:04,690
performance touring as well as the other
message so this should Norman

360
00:21:04,690 --> 00:21:07,749
head and on the right side

361
00:21:07,749 --> 00:21:12,809
restart to tea estate binary so the
system on we actually want to exploit

362
00:21:12,809 --> 00:21:13,739
and to conceal

363
00:21:13,739 --> 00:21:18,440
we have edit or environment caught your
status and

364
00:21:18,440 --> 00:21:38,809
poor settings to export

365
00:21:38,809 --> 00:21:41,490
so could you adjust the screen size

366
00:21:41,490 --> 00:21:44,960
a little bit so we can see the last
three or two lines

367
00:21:44,960 --> 00:21:49,330
just for convenience if this is possible
thing

368
00:21:49,330 --> 00:21:54,170
hope going to now we have to explode
running on the left hand side

369
00:21:54,170 --> 00:22:04,210
and time and unknown starting to your
state is finally on the right side

370
00:22:04,210 --> 00:22:07,920
you can see low-pressure an overseer

371
00:22:07,920 --> 00:22:11,679
on the left hand side to exploit X
triggered on the right hand side with

372
00:22:11,679 --> 00:22:12,840
you look zeros

373
00:22:12,840 --> 00:22:16,200
and issues performance trends actually
printed out

374
00:22:16,200 --> 00:22:20,309
because really used to pass and and
explode church

375
00:22:20,309 --> 00:22:23,350
over what out pointer and

376
00:22:23,350 --> 00:22:28,330
crescent and works by specifying number
of characters already printed

377
00:22:28,330 --> 00:22:32,510
print look couple seconds

378
00:22:32,510 --> 00:22:35,970
and at the end

379
00:22:35,970 --> 00:22:44,270
should yet still running

380
00:22:44,270 --> 00:22:56,090
yes

381
00:22:56,090 --> 00:22:57,480
we were thinking about putting in some

382
00:22:57,480 --> 00:23:00,720
ASCII art so that this one minute or 45
seconds

383
00:23:00,720 --> 00:23:04,260
will not be that boring but to see only
see like noles

384
00:23:04,260 --> 00:23:07,340
floating around um we also

385
00:23:07,340 --> 00:23:11,100
tried all we also came up with the idea
to do some dancing

386
00:23:11,100 --> 00:23:14,810
why this is happening okay so no dancing
for now

387
00:23:14,810 --> 00:23:18,140
as you can see reno and

388
00:23:18,140 --> 00:23:28,610
you can see when rude thanks know it's
rich back

389
00:23:28,610 --> 00:24:04,660
over to Florian slides up

390
00:24:04,660 --> 00:24:07,560
ok it's all after submitting this again

391
00:24:07,560 --> 00:24:11,370
the to IBM we got another CD

392
00:24:11,370 --> 00:24:15,920
and the base car is a little bit higher
this time as you can see 6.9

393
00:24:15,920 --> 00:24:19,760
um and they kind of described

394
00:24:19,760 --> 00:24:22,950
what is happening right here quite good
so

395
00:24:22,950 --> 00:24:26,220
coming back from the only denial of
service

396
00:24:26,220 --> 00:24:30,650
keep on passing there's nothing to see
it was 6.9 in CVS

397
00:24:30,650 --> 00:24:34,910
escorts quite good so looking at the
userspace utilities right here

398
00:24:34,910 --> 00:24:39,540
we kind of thought the problem i'm for
the local privilege escalation

399
00:24:39,540 --> 00:24:43,610
and we managed to get Mike a full-blown
local root exploit for this

400
00:24:43,610 --> 00:24:46,690
server

401
00:24:46,690 --> 00:24:50,310
the deals already quite nice but

402
00:24:50,310 --> 00:24:54,400
of course is like a local exploit on the
local node in the cluster

403
00:24:54,400 --> 00:24:58,660
so we have like multiple nodes in the
cluster if you have a local user count

404
00:24:58,660 --> 00:25:00,770
on what is newsweek uncompromised

405
00:25:00,770 --> 00:25:04,800
now the next step of course would be to
compromise other nodes in the cluster

406
00:25:04,800 --> 00:25:08,240
I'm so really thinking about what

407
00:25:08,240 --> 00:25:11,310
you cool way it could explode to gain a

408
00:25:11,310 --> 00:25:15,240
access to other systems but if you
actually start looking into GPS

409
00:25:15,240 --> 00:25:16,650
documentation

410
00:25:16,650 --> 00:25:20,450
you see this statement so a prerequisite

411
00:25:20,450 --> 00:25:23,810
of to general powell height system is
actually

412
00:25:23,810 --> 00:25:28,170
that you are able to SS age from one
group to another note

413
00:25:28,170 --> 00:25:31,690
Andrew using do user ID

414
00:25:31,690 --> 00:25:35,320
we've all possible so they have to have

415
00:25:35,320 --> 00:25:39,110
the SSH keys reconfigured that you can
simply SSH

416
00:25:39,110 --> 00:25:43,470
into other news so look if you
compromise one note in the cluster

417
00:25:43,470 --> 00:25:49,120
you will get rich because would access
to all nodes in the cluster

418
00:25:49,120 --> 00:25:53,090
and you built-in functionality for this
so this this comment

419
00:25:53,090 --> 00:25:56,559
that's named mm yes H

420
00:25:56,559 --> 00:26:00,610
which probably stands for multimedia
distributed channel or something

421
00:26:00,610 --> 00:26:06,070
and you specify the command to execute
and two notes you want to execute all

422
00:26:06,070 --> 00:26:11,100
and then you get like to return order to
the output which home so we can see we

423
00:26:11,100 --> 00:26:11,870
can now

424
00:26:11,870 --> 00:26:15,720
executors Commons as rude on all systems
and custom

425
00:26:15,720 --> 00:26:19,090
no this

426
00:26:19,090 --> 00:26:23,240
interesting with still a little bit
boring because we're still requiring

427
00:26:23,240 --> 00:26:26,240
to have like one local called

428
00:26:26,240 --> 00:26:29,330
local it's too cold on the cluster
system

429
00:26:29,330 --> 00:26:33,210
on the cluster node so what would be
much more cooler is

430
00:26:33,210 --> 00:26:37,549
just cooked exploits appear as
completely from the remote site

431
00:26:37,549 --> 00:26:41,530
Sotomayor text her face for this

432
00:26:41,530 --> 00:26:46,169
is the MM FSD to multimedia pilot system
team

433
00:26:46,169 --> 00:26:50,570
magic again okay thanks

434
00:26:50,570 --> 00:26:55,330
this is that the main network demand
that surrounds and used for

435
00:26:55,330 --> 00:26:56,450
communication

436
00:26:56,450 --> 00:27:00,419
I'm all these all the nodes in the
cluster

437
00:27:00,419 --> 00:27:03,740
and it's running on pot 119 bone

438
00:27:03,740 --> 00:27:07,570
on all interfaces does is interesting
because

439
00:27:07,570 --> 00:27:10,730
like if you mention the supercomputer
that has mood

440
00:27:10,730 --> 00:27:14,120
network interfaces and some of them are
used for GPS

441
00:27:14,120 --> 00:27:18,010
communications but some of them open to
the outside to be in turn it on to the

442
00:27:18,010 --> 00:27:19,059
office network

443
00:27:19,059 --> 00:27:22,830
and the team in wins by default one on
all these interfaces

444
00:27:22,830 --> 00:27:26,630
so you can compromise potentially from
interface that

445
00:27:26,630 --> 00:27:30,850
isn't even used for GPS communication
and

446
00:27:30,850 --> 00:27:34,970
demon was mainly used for the class the
communication for synchronization

447
00:27:34,970 --> 00:27:36,110
between two states

448
00:27:36,110 --> 00:27:39,850
and if you're using GPFS the netbook
shutters

449
00:27:39,850 --> 00:27:42,940
mode so you don't have to like us harm
pic and in the end

450
00:27:42,940 --> 00:27:47,059
then it's also used for those that book
sharing of 26

451
00:27:47,059 --> 00:27:50,230
but works by that all cluster nodes

452
00:27:50,230 --> 00:27:54,580
ok mood move assistant is connections to
each other

453
00:27:54,580 --> 00:28:00,130
and then that means 3 main communicate
using a cockpit message you soon

454
00:28:00,130 --> 00:28:03,410
ordinances life and hide synchronization

455
00:28:03,410 --> 00:28:07,020
higher excess happens and

456
00:28:07,020 --> 00:28:10,550
what's interesting if you look at the
cluster communication so just open

457
00:28:10,550 --> 00:28:11,280
Bioshock

458
00:28:11,280 --> 00:28:15,050
look at UPS communication you can see
that by default

459
00:28:15,050 --> 00:28:18,070
also hi Lexus's a completely include
text

460
00:28:18,070 --> 00:28:21,960
so if somebody is writing to a file or
some fire

461
00:28:21,960 --> 00:28:25,420
on a network shit this this manipulated
you with simplicity

462
00:28:25,420 --> 00:28:28,610
include text doesn't quite nice

463
00:28:28,610 --> 00:28:34,190
but still it might be possibility that
there's no sensitive data on the picture

464
00:28:34,190 --> 00:28:37,920
bisque soup want seen anything
interesting and

465
00:28:37,920 --> 00:28:42,270
very of GPS is communicating over
private network interfaces

466
00:28:42,270 --> 00:28:45,830
to gaining a man in the middle
communication for which appears as

467
00:28:45,830 --> 00:28:46,800
communications

468
00:28:46,800 --> 00:28:50,610
kind of heart sustain if we have a

469
00:28:50,610 --> 00:28:53,810
the possibility to the former pirate
attack on

470
00:28:53,810 --> 00:28:59,120
a.m. MST that would be really create so
we started

471
00:28:59,120 --> 00:29:02,150
to analyzed not a call for a bit I'm

472
00:29:02,150 --> 00:29:05,570
it's a State football because they would
it builds up

473
00:29:05,570 --> 00:29:09,690
connects the persistent which is created
using to help a good

474
00:29:09,690 --> 00:29:13,740
and after work that you exchange text
data packets

475
00:29:13,740 --> 00:29:17,860
and own so the problem is a concept to
rebuild

476
00:29:17,860 --> 00:29:21,600
replay one of the stator pictures that
you have to create a

477
00:29:21,600 --> 00:29:24,610
a valid hello packet to build up the
connection

478
00:29:24,610 --> 00:29:29,180
no as possible but due to performance
review

479
00:29:29,180 --> 00:29:33,930
not used by anyone in production so
lonely and 2-fold

480
00:29:33,930 --> 00:29:38,470
is completely unprovoked sir

481
00:29:38,470 --> 00:29:41,480
be look at such a

482
00:29:41,480 --> 00:29:45,030
such a hella packed a mood

483
00:29:45,030 --> 00:29:50,010
we have some highlighted stuff under
some of it goes to a fluent in

484
00:29:50,010 --> 00:29:54,060
reading pics then you probably already
recognize

485
00:29:54,060 --> 00:29:58,480
and agreement grew on which are
basically

486
00:29:58,480 --> 00:30:02,780
IP addresses and other IP address

487
00:30:02,780 --> 00:30:05,970
of this horse and of 22 destination node

488
00:30:05,970 --> 00:30:09,800
to communicate with each other and
interesting thing is

489
00:30:09,800 --> 00:30:14,040
does not in the IP header or something
to say inside TCP payload

490
00:30:14,040 --> 00:30:18,240
so you have looked you specified IP
address inside

491
00:30:18,240 --> 00:30:23,040
TCP payload ago a mere blip a
two-pronged you have to smash a constant

492
00:30:23,040 --> 00:30:23,910
which is simply

493
00:30:23,910 --> 00:30:28,500
constant use but you as you have time
stand to have a cluster ID

494
00:30:28,500 --> 00:30:31,840
and it's like to. these type length you

495
00:30:31,840 --> 00:30:36,460
so pretty standard stuff no

496
00:30:36,460 --> 00:30:40,820
what kind of authentication is actually
used in this hello packet because you

497
00:30:40,820 --> 00:30:41,500
don't have a

498
00:30:41,500 --> 00:30:44,620
something that possible to into see

499
00:30:44,620 --> 00:30:49,460
so will be analyze the binary we sold

500
00:30:49,460 --> 00:30:53,140
the own kinda false indication that
actually using is

501
00:30:53,140 --> 00:30:57,200
that own communication between nodes in
the cluster

502
00:30:57,200 --> 00:31:01,830
law a lot and just check is performed
based on the IP address

503
00:31:01,830 --> 00:31:04,860
but it's not performed based on the IP
address

504
00:31:04,860 --> 00:31:08,660
in the IP header which would be pretty
hard to spoof instead

505
00:31:08,660 --> 00:31:12,920
performed on the IP address in the field
so

506
00:31:12,920 --> 00:31:16,490
if you simply portabella motorists in
the pew in the payload

507
00:31:16,490 --> 00:31:21,130
don't we can communicate as part of the
closest of course

508
00:31:21,130 --> 00:31:25,060
is opens of me extremely large attack
surface because

509
00:31:25,060 --> 00:31:28,070
it's like it's a it's a distributed file
system so

510
00:31:28,070 --> 00:31:32,520
consists proved that we are part of the
whole system by design we have like a

511
00:31:32,520 --> 00:31:35,030
lot of possibilities like many plating
date

512
00:31:35,030 --> 00:31:38,740
corrupting date her and stuff like this
would

513
00:31:38,740 --> 00:31:41,780
for us we're more interested in getting
like

514
00:31:41,780 --> 00:31:45,440
direkt remote code execution so

515
00:31:45,440 --> 00:31:48,860
we started analyzing the protocol used
for

516
00:31:48,860 --> 00:31:53,410
internode communication and if you spend
some time searching for interesting

517
00:31:53,410 --> 00:31:54,350
message types

518
00:31:54,350 --> 00:31:59,130
then you find something of Huntsman
called hendon CC message

519
00:31:59,130 --> 00:32:02,200
mm Road which is basically

520
00:32:02,200 --> 00:32:06,530
some kind of option C message mechanism
it has to

521
00:32:06,530 --> 00:32:12,520
it has the message type pics see and
what it does is

522
00:32:12,520 --> 00:32:15,910
did you simply called us this method
using your

523
00:32:15,910 --> 00:32:19,630
using it you give this message and two
to payload

524
00:32:19,630 --> 00:32:23,800
use hand in addition to this message
type is attached as

525
00:32:23,800 --> 00:32:27,530
argument to 103 comment lime juice so
comment line

526
00:32:27,530 --> 00:32:31,520
liberians by Nunes the line on the local
hard system

527
00:32:31,520 --> 00:32:34,650
called mm remote MMO RTS and

528
00:32:34,650 --> 00:32:38,110
mm head and what's interesting for all
system

529
00:32:38,110 --> 00:32:42,160
only mm remote actually exists on the
filesystem

530
00:32:42,160 --> 00:32:46,840
so dysfunctional to you so old most of
it doesn't work anymore

531
00:32:46,840 --> 00:32:52,830
and so know if you find a commodity
India memory more

532
00:32:52,830 --> 00:32:56,440
finally in then you have like completely
remote code execution

533
00:32:56,440 --> 00:33:01,740
and if you look at 25 you actually see
it's not binary its best script

534
00:33:01,740 --> 00:33:05,040
and if one of you ever order to the best
group known

535
00:33:05,040 --> 00:33:09,040
you quite like common injection
vulnerability 75 lines or something

536
00:33:09,040 --> 00:33:12,910
in this case is actually really good so
it has like potholes

537
00:33:12,910 --> 00:33:16,210
lines of code and by design

538
00:33:16,210 --> 00:33:19,870
so without any comment injections or
something like this: a connection

539
00:33:19,870 --> 00:33:24,780
unmount filesystems Mon file systems or
uninstall that UPS team

540
00:33:24,780 --> 00:33:28,080
but somewhere in the Indian

541
00:33:28,080 --> 00:33:31,380
hopes you have to school on injection
and

542
00:33:31,380 --> 00:33:35,890
sued basically if you on the local
system that you would executed

543
00:33:35,890 --> 00:33:39,060
does comment you would create 25 10

544
00:33:39,060 --> 00:33:42,880
poon in the yeah it would grade and 25

545
00:33:42,880 --> 00:33:46,480
10 pol no of gross using dis

546
00:33:46,480 --> 00:33:49,880
message from 20 th is presented you can
actually

547
00:33:49,880 --> 00:33:54,740
duties from remote just by connecting to
the GPS esteem

548
00:33:54,740 --> 00:33:58,000
withdrawal any kind of authentication
and

549
00:33:58,000 --> 00:34:01,500
of course this common excuse its route
so this is a remote

550
00:34:01,500 --> 00:34:04,210
root exploit without any hi

551
00:34:04,210 --> 00:34:08,560
authentication so we have to switch ago

552
00:34:08,560 --> 00:34:11,780
can you switch from for the temple

553
00:34:11,780 --> 00:34:16,740
sir a.m. the hospital it's a bit more
complex

554
00:34:16,740 --> 00:34:21,659
term because basically like the
contradiction is limited to a certain

555
00:34:21,659 --> 00:34:23,030
number of characters

556
00:34:23,030 --> 00:34:27,419
and really limited whoops kinda special
characters you can use

557
00:34:27,419 --> 00:34:31,790
so what we're doing here

558
00:34:31,790 --> 00:34:35,179
is on the top right hand side

559
00:34:35,179 --> 00:34:38,990
we're just starting US in HTTP so

560
00:34:38,990 --> 00:34:42,000
and I'm our

561
00:34:42,000 --> 00:34:46,550
exploit can to defrost comment execute
on the remote system

562
00:34:46,550 --> 00:34:50,020
simply downloads the back connector

563
00:34:50,020 --> 00:34:54,349
from the steps lol and a second command
and execution

564
00:34:54,349 --> 00:34:58,440
rich remix executes to spec connector to
connect

565
00:34:58,440 --> 00:35:01,619
to on that Kurt listening on the left
hand side

566
00:35:01,619 --> 00:35:06,920
and actually explode the whole
communications kind of way soon because

567
00:35:06,920 --> 00:35:10,130
just roofing like a note that actually
exists in the netbook

568
00:35:10,130 --> 00:35:13,589
so sometimes we have to execute to
explode much but Holmes

569
00:35:13,589 --> 00:35:16,710
woo

570
00:35:16,710 --> 00:35:21,089
yet as you can see I'm 22 to execute

571
00:35:21,089 --> 00:35:25,390
multiple times then you can select a
connection to to get the back a

572
00:35:25,390 --> 00:35:26,180
miniature

573
00:35:26,180 --> 00:35:30,290
and on the left hand side I have show
we're also

574
00:35:30,290 --> 00:35:33,369
and if I and type in you can see the
game I'm route

575
00:35:33,369 --> 00:35:38,850
so things

576
00:35:38,850 --> 00:35:42,910
so this again this is a completely new
remote code execution

577
00:35:42,910 --> 00:35:46,410
with root privileges out and kinda
falsification

578
00:35:46,410 --> 00:35:49,490
soon do slipped a point where it's

579
00:35:49,490 --> 00:35:54,380
game over yes sector

580
00:35:54,380 --> 00:35:59,190
know if is still remember

581
00:35:59,190 --> 00:36:05,869
to structure or talk damn

582
00:36:05,869 --> 00:36:10,670
we have like no sir we reported this
block

583
00:36:10,670 --> 00:36:14,840
and of the lead to patsy yes store for
Facebook

584
00:36:14,840 --> 00:36:19,000
in this case the agreed with pastors
something critical so pick up to

585
00:36:19,000 --> 00:36:22,250
nine points when I'm so it seems

586
00:36:22,250 --> 00:36:25,720
IBM learned a lesson and know that we
were the

587
00:36:25,720 --> 00:36:29,330
give highest yes calls to our qualities

588
00:36:29,330 --> 00:36:32,530
but if you remember the structure of
talk

589
00:36:32,530 --> 00:36:36,250
we still have something left so we have
to use the space utilities we have to

590
00:36:36,250 --> 00:36:37,560
communication %um

591
00:36:37,560 --> 00:36:42,869
but this truth interesting look in
common what you no

592
00:36:42,869 --> 00:36:46,980
to come on what your elected to hotel up
this on Linux basically did

593
00:36:46,980 --> 00:36:50,240
to PFS creates device as a

594
00:36:50,240 --> 00:36:55,590
you and is used for the communication
between all this you space utilities and

595
00:36:55,590 --> 00:36:56,440
caramel

596
00:36:56,440 --> 00:37:01,580
and its using normal looks I used to.
cause the problem is that

597
00:37:01,580 --> 00:37:07,000
data actually call ivory so stuff you
can use in your own application

598
00:37:07,000 --> 00:37:10,210
which used is interface to communicate

599
00:37:10,210 --> 00:37:14,980
so it's not possible to simply insert
device permission for Ruth only

600
00:37:14,980 --> 00:37:18,030
so this device you can use this device
is a local

601
00:37:18,030 --> 00:37:21,310
no privileged user which means

602
00:37:21,310 --> 00:37:25,690
although I used to. calls actually have
to implement our own commission checks

603
00:37:25,690 --> 00:37:29,210
and they are like 150 fifties

604
00:37:29,210 --> 00:37:33,830
so it is again we Logitech surface so

605
00:37:33,830 --> 00:37:38,900
we started auditing his column what use
and

606
00:37:38,900 --> 00:37:42,570
I'm basically they have like sry Connell
not use

607
00:37:42,570 --> 00:37:46,620
but MMFs loses just some kind of GPO

608
00:37:46,620 --> 00:37:50,280
potentially using 22 don't buy allied

609
00:37:50,280 --> 00:37:53,990
lead any licenses so they actually work
is performed by

610
00:37:53,990 --> 00:37:58,170
MMFs 26 and to consumption

611
00:37:58,170 --> 00:38:01,620
put it in iowa and stop halting all does
handlers

612
00:38:01,620 --> 00:38:06,920
and I business started with I'll City 1

613
00:38:06,920 --> 00:38:11,740
and if you come to her I was hit a
record number of heart in mine which is

614
00:38:11,740 --> 00:38:12,340
Cain

615
00:38:12,340 --> 00:38:15,750
Connell wait for flock which hospital
probably

616
00:38:15,750 --> 00:38:19,800
hi lock something like this consider I'm
no prude strikes

617
00:38:19,800 --> 00:38:23,010
it's called reviews a controlled
arguments

618
00:38:23,010 --> 00:38:27,740
and if you look at the code you
potentially see the problem

619
00:38:27,740 --> 00:38:31,930
you haven't Alberto rewrite to take the
fall

620
00:38:31,930 --> 00:38:35,230
argument you specify in 20 cities called

621
00:38:35,230 --> 00:38:38,540
do you ever insult and y tu

622
00:38:38,540 --> 00:38:42,380
well you look good as the first argument
services like

623
00:38:42,380 --> 00:38:45,630
tree ever exploited the Cardinal Park on
Linux

624
00:38:45,630 --> 00:38:48,940
like to most review to exploit a clause

625
00:38:48,940 --> 00:38:53,710
in general were so we report this but
again we made a mistake

626
00:38:53,710 --> 00:38:57,430
to not supply food code execution

627
00:38:57,430 --> 00:39:01,700
hope for this so didn't learn the lesson

628
00:39:01,700 --> 00:39:04,750
because basically depends to Bach but
decided

629
00:39:04,750 --> 00:39:07,790
up to we lighten the Cardinal

630
00:39:07,790 --> 00:39:10,980
looks harmless probably only two new
servers

631
00:39:10,980 --> 00:39:15,790
no code execution call possible of
course

632
00:39:15,790 --> 00:39:21,160
thats faults soon you can use it is up
to right

633
00:39:21,160 --> 00:39:24,430
to write addressable week 0 show code

634
00:39:24,430 --> 00:39:28,590
into unused entry of does a GPS

635
00:39:28,590 --> 00:39:32,320
I was have a table don't recall

636
00:39:32,320 --> 00:39:37,960
respect or a city and a to call execute
or show code and change to prove it was

637
00:39:37,960 --> 00:39:41,110
of to come process to root again

638
00:39:41,110 --> 00:39:45,060
we have a demo him this time to move
even have

639
00:39:45,060 --> 00:39:51,060
the really cool a group and designing
this logo actually took longer than

640
00:39:51,060 --> 00:39:54,160
writing to explode sir

641
00:39:54,160 --> 00:39:57,210
I'm it wasn't that hard

642
00:39:57,210 --> 00:40:01,060
I'm switching

643
00:40:01,060 --> 00:40:09,390
back to different Mike your pet

644
00:40:09,390 --> 00:40:13,910
our local homes switching to do

645
00:40:13,910 --> 00:40:17,050
directory

646
00:40:17,050 --> 00:40:20,470
I'm compiling an

647
00:40:20,470 --> 00:40:25,070
start cost Laura doesn't work

648
00:40:25,070 --> 00:40:28,900
lucien on Ford yet

649
00:40:28,900 --> 00:40:32,790
this sir took some time

650
00:40:32,790 --> 00:40:37,430
and it took longer than exploit 10
anti-vietnam

651
00:40:37,430 --> 00:40:43,910
roots using a common mode

652
00:40:43,910 --> 00:40:44,820
things

653
00:40:44,820 --> 00:40:49,500
hermano reflect 2 minutes left so just
for the World Cup

654
00:40:49,500 --> 00:40:59,870
and yeah if you remember the structure
of a talk with loses Bay cities where we

655
00:40:59,870 --> 00:41:01,770
had a local privilege escalation

656
00:41:01,770 --> 00:41:05,450
we had to communication between where we
had a real road route

657
00:41:05,450 --> 00:41:08,700
wooten on all syndicated loan through

658
00:41:08,700 --> 00:41:12,960
and we had to come in what you were also
good local privilege escalation

659
00:41:12,960 --> 00:41:17,700
will be on offer to hurry wide and

660
00:41:17,700 --> 00:41:21,330
so we have to say something to IBM's
response

661
00:41:21,330 --> 00:41:24,530
it was really professional handling of
the host of

662
00:41:24,530 --> 00:41:27,730
to still have liked is optimistic
estimation of explode

663
00:41:27,730 --> 00:41:30,930
Luton I'm but they were released will

664
00:41:30,930 --> 00:41:35,040
working patches for all this wooden box
that you can we list them on a Sunday

665
00:41:35,040 --> 00:41:35,740
service

666
00:41:35,740 --> 00:41:41,690
will spend some time to news and needed
like 30 days from how important to data

667
00:41:41,690 --> 00:41:42,220
released

668
00:41:42,220 --> 00:41:45,670
pensions which is an our impression will
you impressive

669
00:41:45,670 --> 00:41:49,980
own the problem with to remember patrons

670
00:41:49,980 --> 00:41:53,690
so you should definitely apply to refuse
to give us that

671
00:41:53,690 --> 00:41:57,800
Dec to remote explode so the problem
that you don't have looking at possible

672
00:41:57,800 --> 00:41:58,880
patient for those

673
00:41:58,880 --> 00:42:03,300
communication and to construe IP
addresses isn't actually fixed because

674
00:42:03,300 --> 00:42:04,870
this is a design problem

675
00:42:04,870 --> 00:42:08,540
and doing the creation is that you have
to enable as a

676
00:42:08,540 --> 00:42:13,050
so if you use GPS in an environment with
an attacker could probably reaching

677
00:42:13,050 --> 00:42:16,740
I P you should definitely in the butt as
other

678
00:42:16,740 --> 00:42:20,590
additional harming is required don't
have

679
00:42:20,590 --> 00:42:23,600
any notes in your class that that you
don't fully trust

680
00:42:23,600 --> 00:42:29,790
again enable SSL and if GPS is only used
on one network interface should

681
00:42:29,790 --> 00:42:33,360
higher by I firewall hot on all other
interfaces

682
00:42:33,360 --> 00:42:38,530
so the team in context directly some
final lessons learned

683
00:42:38,530 --> 00:42:41,810
presently text her face is

684
00:42:41,810 --> 00:42:45,530
keen if you have Logitech surface you
will get problems

685
00:42:45,530 --> 00:42:48,570
complexity canes because two professors
like

686
00:42:48,570 --> 00:42:52,330
really impressive architectural and
implementation but

687
00:42:52,330 --> 00:42:55,250
incredibly complex incredibly old

688
00:42:55,250 --> 00:42:58,370
so Ruth time excellent homes

689
00:42:58,370 --> 00:43:03,310
term never give up so even if some of
his box looks but Ricky India to

690
00:43:03,310 --> 00:43:04,970
probably get working exploit

691
00:43:04,970 --> 00:43:10,730
out of them said thanks free attention
so you can further problems with text

692
00:43:10,730 --> 00:43:12,140
make this stuff

693
00:43:12,140 --> 00:43:15,480
and we are happy to also some Christians
I guess

694
00:43:15,480 --> 00:43:32,469
text and personal

695
00:43:32,469 --> 00:43:35,829
doesn't look like it so thanks again
thanks by

