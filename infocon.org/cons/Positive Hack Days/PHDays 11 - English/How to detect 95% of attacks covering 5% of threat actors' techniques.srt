1
00:00:08,400 --> 00:00:10,800
i'm certainly so grateful to all those

2
00:00:10,800 --> 00:00:13,280
who chose to attend my speech

3
00:00:13,280 --> 00:00:14,719
that's why i'm feeling scared you know

4
00:00:14,719 --> 00:00:16,320
previously i was sitting with my back to

5
00:00:16,320 --> 00:00:19,199
you so it was okay but now i'm really

6
00:00:19,199 --> 00:00:23,199
scared no i'm kidding naturally

7
00:00:23,359 --> 00:00:25,279
so our plan today

8
00:00:25,279 --> 00:00:27,680
is to discuss something which is uh

9
00:00:27,680 --> 00:00:30,000
exceedingly simple to some people but

10
00:00:30,000 --> 00:00:31,920
probably not so simple to others and

11
00:00:31,920 --> 00:00:33,520
it's not really a complicated

12
00:00:33,520 --> 00:00:35,680
presentation

13
00:00:35,680 --> 00:00:37,840
so even if you don't know much about

14
00:00:37,840 --> 00:00:40,399
attacking carpet networks well at least

15
00:00:40,399 --> 00:00:42,000
let me put it differently if you don't

16
00:00:42,000 --> 00:00:43,360
know much about attacking corporate

17
00:00:43,360 --> 00:00:45,600
networks you stand to learn lots of

18
00:00:45,600 --> 00:00:48,320
useful things here

19
00:00:48,320 --> 00:00:51,199
we are going to learn how to detect 95

20
00:00:51,199 --> 00:00:53,280
of attacks

21
00:00:53,280 --> 00:00:56,719
while knowing only 5 of techniques

22
00:00:56,719 --> 00:00:59,760
techniques and sub techniques depending

23
00:00:59,760 --> 00:01:02,079
on the terminology you're

24
00:01:02,079 --> 00:01:03,920
used to

25
00:01:03,920 --> 00:01:06,560
and the subtitle is is it really that

26
00:01:06,560 --> 00:01:08,799
difficult to detect

27
00:01:08,799 --> 00:01:10,400
persistent

28
00:01:10,400 --> 00:01:12,880
advanced stress

29
00:01:12,880 --> 00:01:14,400
i should probably start by telling you

30
00:01:14,400 --> 00:01:17,280
something about myself i'm alex goldkin

31
00:01:17,280 --> 00:01:20,640
i'm in charge of the digital forensics

32
00:01:20,640 --> 00:01:24,680
lab at group ibm

33
00:01:28,080 --> 00:01:29,680
i'm really interested in incident

34
00:01:29,680 --> 00:01:31,520
response and

35
00:01:31,520 --> 00:01:32,880
forensics

36
00:01:32,880 --> 00:01:35,200
and cyber intelligence

37
00:01:35,200 --> 00:01:37,439
i've been doing it for over 10 years

38
00:01:37,439 --> 00:01:39,920
i've altered a bunch of books and

39
00:01:39,920 --> 00:01:42,479
studies on this subject including

40
00:01:42,479 --> 00:01:44,000
incident response techniques for

41
00:01:44,000 --> 00:01:45,920
ransomware attacks and if you want you

42
00:01:45,920 --> 00:01:48,159
can get a digital copy from me

43
00:01:48,159 --> 00:01:50,880
or alternatively i guess you know where

44
00:01:50,880 --> 00:01:53,600
to find digital copies of books you are

45
00:01:53,600 --> 00:01:55,280
interested in

46
00:01:55,280 --> 00:01:58,159
and i'm still certified by g act though

47
00:01:58,159 --> 00:02:00,320
i'm not really sure this certification

48
00:02:00,320 --> 00:02:02,399
will last long

49
00:02:02,399 --> 00:02:04,960
who knows

50
00:02:06,079 --> 00:02:07,200
anyway

51
00:02:07,200 --> 00:02:08,720
it's ready to uh

52
00:02:08,720 --> 00:02:11,200
let me start the simple things

53
00:02:11,200 --> 00:02:13,440
i think everybody knows what pizza is

54
00:02:13,440 --> 00:02:15,599
and we are going to use the example of

55
00:02:15,599 --> 00:02:19,120
pizza disclaimer to analyze attacks

56
00:02:19,120 --> 00:02:21,200
and by way of a disclaimer i should say

57
00:02:21,200 --> 00:02:23,520
that we're only discussing

58
00:02:23,520 --> 00:02:27,760
attacks targeting corporate networks

59
00:02:29,200 --> 00:02:30,959
we are talking about things happening

60
00:02:30,959 --> 00:02:34,319
between gaining initial access

61
00:02:34,319 --> 00:02:37,040
and doing say data exfiltration or

62
00:02:37,040 --> 00:02:39,440
encryption or you know some other

63
00:02:39,440 --> 00:02:41,280
malicious activities

64
00:02:41,280 --> 00:02:43,840
so everything that happens between these

65
00:02:43,840 --> 00:02:46,560
two points

66
00:02:47,280 --> 00:02:49,599
so for example your defense system has

67
00:02:49,599 --> 00:02:52,480
not been able to respond well you know

68
00:02:52,480 --> 00:02:55,040
somebody is already on your host

69
00:02:55,040 --> 00:02:57,280
or somebody has got you know valid

70
00:02:57,280 --> 00:03:00,879
credentials to do things on your network

71
00:03:00,879 --> 00:03:03,599
like how would you like to detect this

72
00:03:03,599 --> 00:03:06,400
kind of malicious activity

73
00:03:06,400 --> 00:03:08,480
so let's go back to pizzas you will see

74
00:03:08,480 --> 00:03:10,879
that these pizzas are different

75
00:03:10,879 --> 00:03:14,480
however they all have common components

76
00:03:14,480 --> 00:03:17,360
so each one has dough each one has a

77
00:03:17,360 --> 00:03:19,599
source and most of them have cheese on

78
00:03:19,599 --> 00:03:23,120
them same is true for attacks

79
00:03:23,120 --> 00:03:24,799
the kill chain

80
00:03:24,799 --> 00:03:27,760
can be pretty long

81
00:03:30,400 --> 00:03:33,400
uh

82
00:03:33,760 --> 00:03:36,400
attackers may be using diverse

83
00:03:36,400 --> 00:03:38,159
techniques

84
00:03:38,159 --> 00:03:40,560
and tools but there is still a list of

85
00:03:40,560 --> 00:03:43,360
techniques and sub techniques you will

86
00:03:43,360 --> 00:03:44,080
see

87
00:03:44,080 --> 00:03:47,280
pretty much every time regardless of

88
00:03:47,280 --> 00:03:48,720
whether you're responding to a

89
00:03:48,720 --> 00:03:51,440
particular incident or you're reading

90
00:03:51,440 --> 00:03:54,000
about threat studies or hearing threat

91
00:03:54,000 --> 00:03:55,920
studies produced by vendors or

92
00:03:55,920 --> 00:03:58,159
independent researchers

93
00:03:58,159 --> 00:04:00,959
there will be this

94
00:04:08,319 --> 00:04:10,319
so how can we use this kind of

95
00:04:10,319 --> 00:04:11,680
information

96
00:04:11,680 --> 00:04:15,200
in forensics in research

97
00:04:15,200 --> 00:04:16,798
and in proactive

98
00:04:16,798 --> 00:04:19,279
threat study so there is the kill chain

99
00:04:19,279 --> 00:04:20,959
like i said

100
00:04:20,959 --> 00:04:24,079
or the attack life cycle

101
00:04:25,120 --> 00:04:26,800
yes

102
00:04:26,800 --> 00:04:28,960
this

103
00:04:36,240 --> 00:04:38,639
very very ubiquitous and i'm going to

104
00:04:38,639 --> 00:04:42,080
show lots and lots of examples today

105
00:04:42,080 --> 00:04:45,600
coming back from you know our incident

106
00:04:45,600 --> 00:04:47,680
research activities both in russia and

107
00:04:47,680 --> 00:04:49,040
abroad

108
00:04:49,040 --> 00:04:51,440
and i'm also going to quote various

109
00:04:51,440 --> 00:04:54,000
incidents that were investigated by

110
00:04:54,000 --> 00:04:54,840
other

111
00:04:54,840 --> 00:04:57,360
people but you know we still know how

112
00:04:57,360 --> 00:04:59,680
they did it from say public sources of

113
00:04:59,680 --> 00:05:01,919
information

114
00:05:01,919 --> 00:05:04,240
so in every attack there will be a

115
00:05:04,240 --> 00:05:06,720
particular set of techniques which are

116
00:05:06,720 --> 00:05:10,000
very easy to detect

117
00:05:22,960 --> 00:05:24,800
like we've got an anti-virus system

118
00:05:24,800 --> 00:05:26,880
we've got a firewall and that's it

119
00:05:26,880 --> 00:05:29,360
or maybe we also have a bunch of scripts

120
00:05:29,360 --> 00:05:31,280
we can run in order to collect some

121
00:05:31,280 --> 00:05:32,880
information

122
00:05:32,880 --> 00:05:35,440
so even with this kind of data

123
00:05:35,440 --> 00:05:39,120
we should be able to detect

124
00:05:39,120 --> 00:05:42,800
indicators of compromise iocs

125
00:05:42,800 --> 00:05:44,560
if they are there

126
00:05:44,560 --> 00:05:47,360
so these are the top 10 techniques

127
00:05:47,360 --> 00:05:48,880
the ones that i want to cover in my

128
00:05:48,880 --> 00:05:50,720
presentation

129
00:05:50,720 --> 00:05:53,720
yes

130
00:05:55,280 --> 00:05:56,960
i'm assuming most people in the audience

131
00:05:56,960 --> 00:05:58,319
will know them

132
00:05:58,319 --> 00:06:01,360
there is this uh trend where people come

133
00:06:01,360 --> 00:06:03,360
up with top 10 lists

134
00:06:03,360 --> 00:06:06,479
usually however

135
00:06:08,800 --> 00:06:12,000
a system will parse many reports

136
00:06:12,000 --> 00:06:13,680
and you know this kind of frequency

137
00:06:13,680 --> 00:06:16,319
analysis will give you the top 10 lists

138
00:06:16,319 --> 00:06:19,039
the issue with such lists is that

139
00:06:19,039 --> 00:06:21,840
many reports will fail to cover the

140
00:06:21,840 --> 00:06:24,960
whole life cycle of an attack

141
00:06:24,960 --> 00:06:27,600
for example they may be analyzing a

142
00:06:27,600 --> 00:06:30,319
particular instance of malware

143
00:06:30,319 --> 00:06:33,639
or ransomware

144
00:06:34,000 --> 00:06:36,080
out of the whole kill chain they will

145
00:06:36,080 --> 00:06:39,759
only be looking at a small fraction

146
00:06:39,759 --> 00:06:42,720
so this automatically compiled lists

147
00:06:42,720 --> 00:06:44,400
they're not really good at representing

148
00:06:44,400 --> 00:06:45,759
the reality

149
00:06:45,759 --> 00:06:49,400
now this list

150
00:06:58,560 --> 00:07:01,919
and it's also based on reports that

151
00:07:01,919 --> 00:07:02,960
covered

152
00:07:02,960 --> 00:07:06,240
the whole attack life cycle

153
00:07:06,240 --> 00:07:08,000
you know we covered everything they did

154
00:07:08,000 --> 00:07:10,479
after they gained initial access

155
00:07:10,479 --> 00:07:12,639
well to you know doing the best thing so

156
00:07:12,639 --> 00:07:16,240
to speak so you can play this game

157
00:07:16,240 --> 00:07:18,639
you know if you read some other reports

158
00:07:18,639 --> 00:07:21,280
you can actually check how many of these

159
00:07:21,280 --> 00:07:24,319
techniques i am showing in this list

160
00:07:24,319 --> 00:07:26,000
were actually leveraged by the

161
00:07:26,000 --> 00:07:28,720
perpetrators and you will be surprised

162
00:07:28,720 --> 00:07:32,800
at how often they are featured

163
00:07:39,280 --> 00:07:41,680
some people do know a lot you know they

164
00:07:41,680 --> 00:07:43,440
do research

165
00:07:43,440 --> 00:07:45,919
they identify new techniques and it's

166
00:07:45,919 --> 00:07:48,720
great and attackers can indeed use those

167
00:07:48,720 --> 00:07:50,240
new techniques

168
00:07:50,240 --> 00:07:51,599
however

169
00:07:51,599 --> 00:07:54,319
this tendency to go looking for

170
00:07:54,319 --> 00:07:56,960
something really sophisticated may

171
00:07:56,960 --> 00:07:58,960
actually be

172
00:07:58,960 --> 00:08:01,440
counterproductive if you consult mitra

173
00:08:01,440 --> 00:08:03,520
attack you will find like 400 sub

174
00:08:03,520 --> 00:08:05,360
techniques and 200 techniques and

175
00:08:05,360 --> 00:08:07,520
looking for each of them is nearly

176
00:08:07,520 --> 00:08:09,520
impossible you can certainly automate

177
00:08:09,520 --> 00:08:11,599
some of this search but certainly not

178
00:08:11,599 --> 00:08:14,080
all of it and if we are talking about

179
00:08:14,080 --> 00:08:16,800
threat hunting even if it is automated

180
00:08:16,800 --> 00:08:18,720
you will still have to deal

181
00:08:18,720 --> 00:08:21,919
with a huge amount of data

182
00:08:21,919 --> 00:08:24,000
and it's impossible to cover everything

183
00:08:24,000 --> 00:08:26,560
all the time

184
00:08:33,808 --> 00:08:36,889
[Music]

185
00:08:39,200 --> 00:08:41,039
for hardware editions

186
00:08:41,039 --> 00:08:43,279
such as you know raspberry pi and so on

187
00:08:43,279 --> 00:08:45,839
things that are used in the wild but

188
00:08:45,839 --> 00:08:48,080
not really that often

189
00:08:48,080 --> 00:08:50,160
and his colleague comes running and says

190
00:08:50,160 --> 00:08:50,950
you know what

191
00:08:50,950 --> 00:08:53,680
[Music]

192
00:08:53,680 --> 00:08:55,519
we've been compromised for three months

193
00:08:55,519 --> 00:08:58,080
already and you know they've been using

194
00:08:58,080 --> 00:08:59,519
scheduled tasks

195
00:08:59,519 --> 00:09:01,440
and you know we we haven't really

196
00:09:01,440 --> 00:09:03,440
noticed them because we thought that

197
00:09:03,440 --> 00:09:06,000
things like this would be detected

198
00:09:06,000 --> 00:09:08,000
unfortunately it's based on a real life

199
00:09:08,000 --> 00:09:10,240
case

200
00:09:13,200 --> 00:09:15,760
so let's talk now individually about

201
00:09:15,760 --> 00:09:17,040
each and every

202
00:09:17,040 --> 00:09:19,440
technique from the list and i'm going to

203
00:09:19,440 --> 00:09:22,880
illustrate them with real life examples

204
00:09:22,880 --> 00:09:27,279
and i've tried to select my cases here

205
00:09:30,160 --> 00:09:32,800
primarily from the area matter to the

206
00:09:32,800 --> 00:09:34,880
russian landscape of threats so the

207
00:09:34,880 --> 00:09:36,640
first technique

208
00:09:36,640 --> 00:09:38,720
is powershell

209
00:09:38,720 --> 00:09:40,959
i don't really remember a single report

210
00:09:40,959 --> 00:09:42,959
by us or

211
00:09:42,959 --> 00:09:44,880
other threat researchers that wouldn't

212
00:09:44,880 --> 00:09:48,839
mention powershell powershell is used

213
00:09:48,839 --> 00:09:52,399
indeed ubiquitously and using it is so

214
00:09:52,399 --> 00:09:54,640
simple

215
00:09:55,279 --> 00:09:57,360
no perpetrators but actually not just

216
00:09:57,360 --> 00:09:59,360
perpetrators you know we will also be

217
00:09:59,360 --> 00:10:01,600
using powershell quite often

218
00:10:01,600 --> 00:10:05,760
and it can be used to do so many things

219
00:10:05,760 --> 00:10:09,279
which is actually why it's so ubiquitous

220
00:10:09,279 --> 00:10:11,519
so let's look at how it's being used and

221
00:10:11,519 --> 00:10:13,760
at what stages

222
00:10:13,760 --> 00:10:16,800
so a red curl

223
00:10:17,839 --> 00:10:20,399
these guys are quite active in attacking

224
00:10:20,399 --> 00:10:22,480
russian companies and most of uh what

225
00:10:22,480 --> 00:10:25,120
they're doing is industrial espionage

226
00:10:25,120 --> 00:10:27,600
they're not an abc they're effectively a

227
00:10:27,600 --> 00:10:31,160
commercial operation

228
00:10:38,240 --> 00:10:40,880
so what i am showing here is a redacted

229
00:10:40,880 --> 00:10:43,120
version of what they did

230
00:10:43,120 --> 00:10:47,600
there is nothing special about it right

231
00:10:47,600 --> 00:10:49,600
i guess that for the majority of people

232
00:10:49,600 --> 00:10:51,920
in audience you know stuff like this

233
00:10:51,920 --> 00:10:53,920
will look suspicious although it can be

234
00:10:53,920 --> 00:10:55,040
legit

235
00:10:55,040 --> 00:10:57,200
you know although these techniques are

236
00:10:57,200 --> 00:11:00,079
ubiquitous you know they can generate a

237
00:11:00,079 --> 00:11:02,800
certain amount of noise which makes them

238
00:11:02,800 --> 00:11:06,959
ideal for proactive threat surge

239
00:11:07,200 --> 00:11:09,360
so for example if you can remove the

240
00:11:09,360 --> 00:11:11,760
noise which like if you control the

241
00:11:11,760 --> 00:11:14,079
organization should be easy you will be

242
00:11:14,079 --> 00:11:16,079
able to see where this noise is

243
00:11:16,079 --> 00:11:18,320
legitimate and then therefore you should

244
00:11:18,320 --> 00:11:20,160
be able to identify the really

245
00:11:20,160 --> 00:11:22,079
suspicious elements

246
00:11:22,079 --> 00:11:23,760
now you can do your triage or your

247
00:11:23,760 --> 00:11:25,360
investigation

248
00:11:25,360 --> 00:11:28,160
couple strike requires no introduction

249
00:11:28,160 --> 00:11:30,240
this stuff should be

250
00:11:30,240 --> 00:11:33,120
very easily detected however the recent

251
00:11:33,120 --> 00:11:36,240
incidents have shown

252
00:11:37,440 --> 00:11:39,600
powershell that you know beacon

253
00:11:39,600 --> 00:11:41,760
uploaders on the basis of power shell

254
00:11:41,760 --> 00:11:45,120
are still used a lot and in event logs

255
00:11:45,120 --> 00:11:46,959
you will still see lots and lots of

256
00:11:46,959 --> 00:11:49,839
strings like this

257
00:11:50,720 --> 00:11:53,600
popular botnet

258
00:11:54,839 --> 00:11:58,480
problems no perpetrators no often have

259
00:11:58,480 --> 00:12:00,000
difficulties

260
00:12:00,000 --> 00:12:02,880
delivering their payload because macross

261
00:12:02,880 --> 00:12:04,720
are switched off by default so they're

262
00:12:04,720 --> 00:12:06,240
looking for new ways of doing it and

263
00:12:06,240 --> 00:12:08,800
this is not really a new way

264
00:12:08,800 --> 00:12:11,600
so the guys have been using lnk files in

265
00:12:11,600 --> 00:12:14,399
order to upload that payload to a host

266
00:12:14,399 --> 00:12:16,399
well because using documents is no

267
00:12:16,399 --> 00:12:18,959
longer a viable option

268
00:12:18,959 --> 00:12:20,959
so if as far as i remember there was an

269
00:12:20,959 --> 00:12:22,480
asl file

270
00:12:22,480 --> 00:12:25,279
and inside

271
00:12:26,959 --> 00:12:29,120
a label that would effectively launch

272
00:12:29,120 --> 00:12:30,959
power shell and payload would be

273
00:12:30,959 --> 00:12:34,880
downloaded from compromised websites

274
00:12:36,079 --> 00:12:38,480
so you don't really need to use it as

275
00:12:38,480 --> 00:12:40,639
say at the initial stage or the lateral

276
00:12:40,639 --> 00:12:42,720
movement

277
00:12:42,720 --> 00:12:46,000
although it can be used like this

278
00:12:46,720 --> 00:12:48,880
for example you can collect network

279
00:12:48,880 --> 00:12:51,040
information and by way of example i'm

280
00:12:51,040 --> 00:12:52,880
showing our evil and ariville is a

281
00:12:52,880 --> 00:12:53,839
pretty

282
00:12:53,839 --> 00:12:55,519
well-known group

283
00:12:55,519 --> 00:12:57,360
mostly

284
00:12:57,360 --> 00:12:59,760
ransomware and apparently they're back

285
00:12:59,760 --> 00:13:04,519
in business though it's not guaranteed

286
00:13:16,079 --> 00:13:19,959
so it's indeed very popular

287
00:13:28,480 --> 00:13:30,160
i guess it's one of the most popular

288
00:13:30,160 --> 00:13:33,040
techniques and it seems to be impervious

289
00:13:33,040 --> 00:13:36,399
to time you know it's used by very

290
00:13:36,399 --> 00:13:39,440
simplistic cyber criminals

291
00:13:39,440 --> 00:13:40,320
to

292
00:13:40,320 --> 00:13:41,600
chinese

293
00:13:41,600 --> 00:13:44,639
state sponsored groups

294
00:13:45,839 --> 00:13:48,160
you know if it comes so you know when we

295
00:13:48,160 --> 00:13:50,959
talk about uh persistence in the system

296
00:13:50,959 --> 00:13:53,360
schedule tasks are the weapon of choice

297
00:13:53,360 --> 00:13:55,279
and it's often used to escalate

298
00:13:55,279 --> 00:13:57,279
privileges as well

299
00:13:57,279 --> 00:14:00,000
so red curl

300
00:14:00,000 --> 00:14:00,839
likes

301
00:14:00,839 --> 00:14:03,600
using schedule tasks you know they would

302
00:14:03,600 --> 00:14:06,639
use it to execute malicious script and

303
00:14:06,639 --> 00:14:10,000
it was followed with powershell

304
00:14:10,000 --> 00:14:11,360
which means that you know they can be

305
00:14:11,360 --> 00:14:14,160
easily used in a combo

306
00:14:14,160 --> 00:14:17,040
no rats curl

307
00:14:27,680 --> 00:14:29,680
associated with the chinese government

308
00:14:29,680 --> 00:14:32,480
at least by numerous researchers

309
00:14:32,480 --> 00:14:34,880
so again in the scheduler

310
00:14:34,880 --> 00:14:37,440
they would create a task to launch the

311
00:14:37,440 --> 00:14:40,240
malicious file

312
00:14:40,320 --> 00:14:42,770
and note by the way

313
00:14:42,770 --> 00:14:45,860
[Music]

314
00:14:48,560 --> 00:14:50,480
some other techniques there will be lots

315
00:14:50,480 --> 00:14:52,560
of overlaps

316
00:14:52,560 --> 00:14:53,600
i mean

317
00:14:53,600 --> 00:14:55,760
one technique is often used in

318
00:14:55,760 --> 00:14:59,839
conjunction with another one

319
00:15:02,079 --> 00:15:04,320
which props up the popularity of all the

320
00:15:04,320 --> 00:15:06,639
techniques on this list

321
00:15:06,639 --> 00:15:09,680
and the final example is a quackbot

322
00:15:09,680 --> 00:15:11,680
another popular botnet are all pretty

323
00:15:11,680 --> 00:15:14,240
old but you know it's still there still

324
00:15:14,240 --> 00:15:17,839
propagating still developing

325
00:15:18,000 --> 00:15:18,959
once

326
00:15:18,959 --> 00:15:21,199
this

327
00:15:21,760 --> 00:15:23,279
once there

328
00:15:23,279 --> 00:15:25,120
which means that you know they only used

329
00:15:25,120 --> 00:15:25,839
it

330
00:15:25,839 --> 00:15:29,600
once to escalate privileges rather than

331
00:15:29,600 --> 00:15:31,839
to persist on the system

332
00:15:31,839 --> 00:15:32,639
and

333
00:15:32,639 --> 00:15:33,519
if

334
00:15:33,519 --> 00:15:34,800
for example

335
00:15:34,800 --> 00:15:36,480
you know they didn't work

336
00:15:36,480 --> 00:15:37,920
you know they would still get

337
00:15:37,920 --> 00:15:40,720
persistence on the system using the same

338
00:15:40,720 --> 00:15:43,199
schedule tasks technique

339
00:15:43,199 --> 00:15:46,800
another one is service execution

340
00:15:46,800 --> 00:15:49,120
actually so many post exploitation

341
00:15:49,120 --> 00:15:51,519
frameworks rely on this technique

342
00:15:51,519 --> 00:15:52,320
and

343
00:15:52,320 --> 00:15:53,580
it's all based

344
00:15:53,580 --> 00:15:56,709
[Music]

345
00:16:01,680 --> 00:16:03,759
it's not used as much but the underlying

346
00:16:03,759 --> 00:16:07,399
technique is

347
00:16:10,959 --> 00:16:13,040
well these guys are also

348
00:16:13,040 --> 00:16:14,639
making a little business out of

349
00:16:14,639 --> 00:16:16,399
ransomware

350
00:16:16,399 --> 00:16:18,160
and they're mostly

351
00:16:18,160 --> 00:16:22,120
attacking russian companies

352
00:16:23,600 --> 00:16:24,959
so do you know what's happening here by

353
00:16:24,959 --> 00:16:28,959
the way if you can read the string

354
00:16:31,360 --> 00:16:34,880
can you guess what firefox dot xa is

355
00:16:34,880 --> 00:16:37,440
absolutely it's just

356
00:16:37,440 --> 00:16:39,920
impacted

357
00:16:41,120 --> 00:16:43,120
smb exactly

358
00:16:43,120 --> 00:16:46,000
it will also create a lots and lots of

359
00:16:46,000 --> 00:16:48,240
events in the system log

360
00:16:48,240 --> 00:16:51,199
with event id

361
00:17:00,560 --> 00:17:03,120
associated with a chinese repeatedly

362
00:17:03,120 --> 00:17:06,640
chinese group a very popular tool

363
00:17:06,640 --> 00:17:09,039
almost as popular as a cobbled strike in

364
00:17:09,039 --> 00:17:10,880
fact a growing number of hackers are

365
00:17:10,880 --> 00:17:12,319
using it

366
00:17:12,319 --> 00:17:14,799
it was not as popular before

367
00:17:14,799 --> 00:17:18,079
and it's not as easy to detect really

368
00:17:18,079 --> 00:17:20,480
moreover

369
00:17:20,799 --> 00:17:23,199
you know some of the defense stills are

370
00:17:23,199 --> 00:17:24,880
using it

371
00:17:24,880 --> 00:17:26,319
and in order

372
00:17:26,319 --> 00:17:29,280
to avoid you know false positives

373
00:17:29,280 --> 00:17:33,720
sometimes you know detection systems

374
00:17:35,360 --> 00:17:37,600
now ps exact is here but in fact there

375
00:17:37,600 --> 00:17:40,400
are lots and lots of tools based on it

376
00:17:40,400 --> 00:17:44,080
such as pa exec at linux and so on

377
00:17:44,080 --> 00:17:46,400
which will also create a service on a

378
00:17:46,400 --> 00:17:47,440
remote

379
00:17:47,440 --> 00:17:49,200
system and will launch

380
00:17:49,200 --> 00:17:52,559
you know the payload that you need

381
00:17:52,960 --> 00:17:54,640
it may often be used on corporate

382
00:17:54,640 --> 00:17:56,960
networks

383
00:17:56,960 --> 00:17:59,200
and it's indeed a great thing

384
00:17:59,200 --> 00:18:02,640
to do proactive search

385
00:18:03,520 --> 00:18:05,360
and you know to check if it's your

386
00:18:05,360 --> 00:18:07,520
system administrator doing something or

387
00:18:07,520 --> 00:18:09,760
if it's a legit script or something

388
00:18:09,760 --> 00:18:13,200
suspicious is indeed happening

389
00:18:21,360 --> 00:18:23,520
but i find it exceedingly funny every

390
00:18:23,520 --> 00:18:24,880
time

391
00:18:24,880 --> 00:18:26,400
and let me show you

392
00:18:26,400 --> 00:18:28,160
this example i think everybody's leading

393
00:18:28,160 --> 00:18:30,640
secure is reading uh securely if you

394
00:18:30,640 --> 00:18:33,679
aren't please do so securely recently

395
00:18:33,679 --> 00:18:36,880
had a great post

396
00:18:37,919 --> 00:18:39,600
on using

397
00:18:39,600 --> 00:18:41,440
event

398
00:18:41,440 --> 00:18:44,080
for storing shell codes

399
00:18:44,080 --> 00:18:47,840
it's extremely complicated really

400
00:18:48,960 --> 00:18:52,080
so they took a legitimate warehouse

401
00:18:52,080 --> 00:18:55,280
and then they copied it to windows tasks

402
00:18:55,280 --> 00:18:58,320
i mean that's weird no legit binary

403
00:18:58,320 --> 00:19:01,039
would be launched from a windows task

404
00:19:01,039 --> 00:19:02,080
folder

405
00:19:02,080 --> 00:19:04,720
but what can you do

406
00:19:04,720 --> 00:19:06,880
then they did delayed hijacking and lots

407
00:19:06,880 --> 00:19:09,280
of other things and in the end saving

408
00:19:09,280 --> 00:19:10,400
those tasks

409
00:19:10,400 --> 00:19:12,559
on the pc you know

410
00:19:12,559 --> 00:19:15,919
so they would actually write to run

411
00:19:15,919 --> 00:19:18,720
but don't process the site you know the

412
00:19:18,720 --> 00:19:20,960
address to leading

413
00:19:20,960 --> 00:19:22,880
to see windows tasks

414
00:19:22,880 --> 00:19:25,200
so it's a complicated journey

415
00:19:25,200 --> 00:19:27,600
taking you all the way back

416
00:19:27,600 --> 00:19:30,559
to windows tasks

417
00:19:31,120 --> 00:19:33,840
so browse any reports

418
00:19:33,840 --> 00:19:35,520
there is a huge probability that the

419
00:19:35,520 --> 00:19:38,000
malware you will be reading about we'll

420
00:19:38,000 --> 00:19:41,120
be using this particular key

421
00:19:41,120 --> 00:19:43,840
it's indeed such a bad way

422
00:19:43,840 --> 00:19:46,240
of getting persistence on the system and

423
00:19:46,240 --> 00:19:48,240
it's still being used

424
00:19:48,240 --> 00:19:50,960
not just by the bots

425
00:19:50,960 --> 00:19:54,080
that are being you know sent out through

426
00:19:54,080 --> 00:19:56,160
major emailing campaigns but also by

427
00:19:56,160 --> 00:19:58,640
abcs

428
00:20:01,039 --> 00:20:03,360
we assumed that the system being

429
00:20:03,360 --> 00:20:06,159
defended has some anti-virus and sound

430
00:20:06,159 --> 00:20:08,640
firewall

431
00:20:09,840 --> 00:20:12,000
and sometimes you know attackers don't

432
00:20:12,000 --> 00:20:14,640
even want to buy possum as long as they

433
00:20:14,640 --> 00:20:16,640
can switch him off and some of them

434
00:20:16,640 --> 00:20:20,400
actually do it with a lot of food spa

435
00:20:21,120 --> 00:20:24,159
so let me give you a specific example i

436
00:20:24,159 --> 00:20:27,520
think you must have heard about lapses

437
00:20:27,520 --> 00:20:30,240
a pretty well-known group that was able

438
00:20:30,240 --> 00:20:31,039
to

439
00:20:31,039 --> 00:20:34,760
hack microsoft

440
00:20:36,720 --> 00:20:39,360
you know they broke them after the open

441
00:20:39,360 --> 00:20:41,440
source i'm sorry after the source codes

442
00:20:41,440 --> 00:20:44,600
were released

443
00:20:49,440 --> 00:20:53,200
so they connected via rdb to some host

444
00:20:53,200 --> 00:20:55,840
for which they got the credentials

445
00:20:55,840 --> 00:20:59,120
and there was a an endpoint engine and

446
00:20:59,120 --> 00:21:03,080
they simply downloaded

447
00:21:06,080 --> 00:21:08,000
and did everything they wanted you know

448
00:21:08,000 --> 00:21:10,240
they installed mimikats and so on and so

449
00:21:10,240 --> 00:21:11,039
forth

450
00:21:11,039 --> 00:21:13,600
you know it is possible even with large

451
00:21:13,600 --> 00:21:16,960
corporations like nvidia surprisingly

452
00:21:16,960 --> 00:21:18,320
enough

453
00:21:18,320 --> 00:21:20,640
so lapses and process hacker but it

454
00:21:20,640 --> 00:21:22,240
doesn't have to be process hacker

455
00:21:22,240 --> 00:21:24,000
naturally it all depends on the

456
00:21:24,000 --> 00:21:26,400
preferences of the attackers

457
00:21:26,400 --> 00:21:28,559
because it could be jimer

458
00:21:28,559 --> 00:21:31,039
and pc

459
00:21:38,640 --> 00:21:40,480
you know when you do have this kind of

460
00:21:40,480 --> 00:21:42,840
access you can do lots of

461
00:21:42,840 --> 00:21:45,120
things it doesn't mean that they they

462
00:21:45,120 --> 00:21:46,799
will really be

463
00:21:46,799 --> 00:21:48,240
switching everything up you know you can

464
00:21:48,240 --> 00:21:49,840
still find lots of networks which are

465
00:21:49,840 --> 00:21:53,440
only protected by defender

466
00:21:53,440 --> 00:21:55,840
you know people may often fail to notice

467
00:21:55,840 --> 00:21:58,840
that

468
00:22:08,400 --> 00:22:10,720
what they can do is to use powershell

469
00:22:10,720 --> 00:22:13,200
something we discussed previously

470
00:22:13,200 --> 00:22:16,080
in order to clean the event logs

471
00:22:16,080 --> 00:22:18,000
which is the second example here in the

472
00:22:18,000 --> 00:22:20,080
screen and the third one

473
00:22:20,080 --> 00:22:22,720
actually involved switching the defender

474
00:22:22,720 --> 00:22:24,880
up so if somehow defender is getting in

475
00:22:24,880 --> 00:22:28,320
your way you can do that

476
00:22:28,960 --> 00:22:31,520
and b65 is a pretty interesting group

477
00:22:31,520 --> 00:22:33,200
and they are currently attacking russian

478
00:22:33,200 --> 00:22:34,720
organizations

479
00:22:34,720 --> 00:22:36,320
as well

480
00:22:36,320 --> 00:22:40,200
they are mostly activists

481
00:22:43,280 --> 00:22:45,440
is a ransomware and there was a

482
00:22:45,440 --> 00:22:47,360
well-known leak after you know what

483
00:22:47,360 --> 00:22:50,400
started so they took the county source

484
00:22:50,400 --> 00:22:51,360
codes

485
00:22:51,360 --> 00:22:55,479
they edited them a bit

486
00:22:55,600 --> 00:22:58,080
spreading them in russian organizations

487
00:22:58,080 --> 00:22:59,919
so they don't really want to be paid

488
00:22:59,919 --> 00:23:02,320
they just say stop what's happening

489
00:23:02,320 --> 00:23:04,159
right now and then we shall

490
00:23:04,159 --> 00:23:05,840
stop

491
00:23:05,840 --> 00:23:08,480
our operations deal we have already seen

492
00:23:08,480 --> 00:23:09,840
it for sure

493
00:23:09,840 --> 00:23:12,799
it's a very popular binary

494
00:23:12,799 --> 00:23:15,200
you know it's science

495
00:23:15,200 --> 00:23:16,960
which means that

496
00:23:16,960 --> 00:23:20,320
you should be able to execute malware d

497
00:23:20,320 --> 00:23:22,960
uh malicious dll so what have you

498
00:23:22,960 --> 00:23:24,799
it's you know it will be quite good for

499
00:23:24,799 --> 00:23:27,919
exact using other binaries i'm not sure

500
00:23:27,919 --> 00:23:30,080
another example with conte i've just

501
00:23:30,080 --> 00:23:32,399
mentioned

502
00:23:32,480 --> 00:23:34,080
actually this league didn't stop them

503
00:23:34,080 --> 00:23:35,919
you know they're terrorizing costa rica

504
00:23:35,919 --> 00:23:37,280
now

505
00:23:37,280 --> 00:23:39,440
i understand that uh you know real hell

506
00:23:39,440 --> 00:23:42,559
has broken out in costa rica

507
00:23:42,559 --> 00:23:43,279
you know

508
00:23:43,279 --> 00:23:44,880
i understand that they have encrypted

509
00:23:44,880 --> 00:23:47,760
some governmental systems in costa rica

510
00:23:47,760 --> 00:23:50,559
making lives difficult

511
00:23:50,559 --> 00:23:52,640
no this is a couple strike beacons

512
00:23:52,640 --> 00:23:55,760
nothing really special

513
00:23:56,480 --> 00:23:58,559
so they effectively launch it with a

514
00:23:58,559 --> 00:24:03,200
round dll and iced idea is another part

515
00:24:15,840 --> 00:24:18,240
they can be seen quite often in russia

516
00:24:18,240 --> 00:24:19,360
as well

517
00:24:19,360 --> 00:24:21,120
but they're not really

518
00:24:21,120 --> 00:24:23,840
functional in russia i mean

519
00:24:23,840 --> 00:24:25,200
they will arrive in russian

520
00:24:25,200 --> 00:24:27,120
organizations but they won't really

521
00:24:27,120 --> 00:24:29,678
attack him

522
00:24:30,400 --> 00:24:33,400
group

523
00:24:38,400 --> 00:24:40,720
so you see the run dll here and the

524
00:24:40,720 --> 00:24:42,799
malicious library that will be

525
00:24:42,799 --> 00:24:44,640
effectively stored

526
00:24:44,640 --> 00:24:46,400
god knows where and will be pretty easy

527
00:24:46,400 --> 00:24:49,039
to detect

528
00:24:51,360 --> 00:24:53,919
and the next technique

529
00:24:53,919 --> 00:24:56,080
is credentialed

530
00:24:56,080 --> 00:24:58,159
super popular as well everybody has

531
00:24:58,159 --> 00:25:00,400
heard about mimikaz for sure

532
00:25:00,400 --> 00:25:02,320
i guess many of you guys have

533
00:25:02,320 --> 00:25:03,919
re-engineered it

534
00:25:03,919 --> 00:25:05,600
to avoid detection

535
00:25:05,600 --> 00:25:07,840
but uh naturally there is more to this

536
00:25:07,840 --> 00:25:10,080
world than many cats there are so many

537
00:25:10,080 --> 00:25:12,080
techniques that should enable you to get

538
00:25:12,080 --> 00:25:13,679
access to credentials because you know

539
00:25:13,679 --> 00:25:16,400
when attackers gain access to certain

540
00:25:16,400 --> 00:25:18,720
hosts they will often do not they often

541
00:25:18,720 --> 00:25:20,880
will not have the privileges

542
00:25:20,880 --> 00:25:23,840
to move around to find data

543
00:25:23,840 --> 00:25:24,720
or

544
00:25:24,720 --> 00:25:27,679
to hijack the whole network in order for

545
00:25:27,679 --> 00:25:31,600
example to spread their ransomware

546
00:25:32,640 --> 00:25:34,320
if we go back to the case i previously

547
00:25:34,320 --> 00:25:36,639
mentioned

548
00:25:37,279 --> 00:25:39,279
where the process

549
00:25:39,279 --> 00:25:41,520
was used to

550
00:25:41,520 --> 00:25:43,200
actually kill the defense agency and

551
00:25:43,200 --> 00:25:45,679
they first downloaded process hacker

552
00:25:45,679 --> 00:25:47,440
of source fortune that they downloaded

553
00:25:47,440 --> 00:25:48,559
mimikats

554
00:25:48,559 --> 00:25:50,559
of github

555
00:25:50,559 --> 00:25:52,799
so they got the credentials

556
00:25:52,799 --> 00:25:54,559
and from that moment on

557
00:25:54,559 --> 00:25:57,799
they were unstoppable

558
00:26:07,039 --> 00:26:08,640
so we've been previously guessing you

559
00:26:08,640 --> 00:26:12,400
know what's masqueraded as uh firefox

560
00:26:12,400 --> 00:26:14,559
different uh software here but obviously

561
00:26:14,559 --> 00:26:17,279
this is the same good old pro system

562
00:26:17,279 --> 00:26:19,760
used to get access to credits

563
00:26:19,760 --> 00:26:22,720
and another technique

564
00:26:22,840 --> 00:26:25,360
here it was with old gremlin that we

565
00:26:25,360 --> 00:26:28,320
first found this technique in the wilds

566
00:26:28,320 --> 00:26:30,159
and we found it interesting back then

567
00:26:30,159 --> 00:26:32,640
now it's being used by everybody

568
00:26:32,640 --> 00:26:34,640
it's super trivial

569
00:26:34,640 --> 00:26:36,720
so come on cbsdld

570
00:26:36,720 --> 00:26:38,799
is a default library

571
00:26:38,799 --> 00:26:41,200
you don't even need to bring anything to

572
00:26:41,200 --> 00:26:42,480
the host

573
00:26:42,480 --> 00:26:43,440
you can

574
00:26:43,440 --> 00:26:45,919
abuse what's already there and have you

575
00:26:45,919 --> 00:26:47,200
done it

576
00:26:47,200 --> 00:26:49,120
you can also use it

577
00:26:49,120 --> 00:26:51,840
together with a task manager for example

578
00:26:51,840 --> 00:26:55,039
so it's also being used

579
00:27:04,080 --> 00:27:06,240
when you already have access to a

580
00:27:06,240 --> 00:27:08,159
particular host

581
00:27:08,159 --> 00:27:11,440
anyone to go further

582
00:27:12,159 --> 00:27:14,080
as an attacker you will want to know

583
00:27:14,080 --> 00:27:16,880
where you are what kind of network it is

584
00:27:16,880 --> 00:27:18,399
and how you can

585
00:27:18,399 --> 00:27:20,559
move further

586
00:27:20,559 --> 00:27:22,159
in any attack against the corporate

587
00:27:22,159 --> 00:27:24,960
network this attack will be used this

588
00:27:24,960 --> 00:27:26,240
could be say

589
00:27:26,240 --> 00:27:28,080
network scanners

590
00:27:28,080 --> 00:27:30,070
says perfect network scanner

591
00:27:30,070 --> 00:27:31,679
[Music]

592
00:27:31,679 --> 00:27:34,799
which is so much loved by apts and

593
00:27:34,799 --> 00:27:37,918
ransomware operators

594
00:27:38,000 --> 00:27:40,960
it's indeed it's super popular

595
00:27:40,960 --> 00:27:42,880
now when we're talking about uh

596
00:27:42,880 --> 00:27:44,320
throughout the investigation the problem

597
00:27:44,320 --> 00:27:46,559
is that system administrators love it as

598
00:27:46,559 --> 00:27:48,480
well and they will often put it saying

599
00:27:48,480 --> 00:27:51,200
say intel

600
00:27:51,760 --> 00:27:54,480
so if you can find a house which has it

601
00:27:54,480 --> 00:27:58,559
it may easily turn out to be a legit one

602
00:27:58,880 --> 00:28:00,840
so the trend with

603
00:28:00,840 --> 00:28:03,279
attackers is often to say what's

604
00:28:03,279 --> 00:28:05,919
available on the host and to try using

605
00:28:05,919 --> 00:28:07,360
what's there well for example if there

606
00:28:07,360 --> 00:28:09,120
is team viewer there and system

607
00:28:09,120 --> 00:28:11,600
administrators will be using it

608
00:28:11,600 --> 00:28:14,240
well they will take the credits from the

609
00:28:14,240 --> 00:28:17,240
teamviewer

610
00:28:19,279 --> 00:28:22,240
you can install your own remote access

611
00:28:22,240 --> 00:28:25,120
tools and many people do that

612
00:28:25,120 --> 00:28:28,239
but why do that

613
00:28:28,640 --> 00:28:30,399
you know if there is no monitoring in

614
00:28:30,399 --> 00:28:32,240
place and most corporations still don't

615
00:28:32,240 --> 00:28:34,240
have it

616
00:28:34,240 --> 00:28:36,240
it will be very easy

617
00:28:36,240 --> 00:28:38,399
to deal with the defenders and thus

618
00:28:38,399 --> 00:28:42,639
effectively have get yourself a backdoor

619
00:28:42,799 --> 00:28:44,799
so let's go back to this issue of uh

620
00:28:44,799 --> 00:28:46,080
finding additional information on the

621
00:28:46,080 --> 00:28:50,399
network and again we see red curl here

622
00:28:50,399 --> 00:28:52,880
so ad explorer cis internals totally

623
00:28:52,880 --> 00:28:55,440
legit right

624
00:28:56,000 --> 00:28:59,840
it actually has graphic interface

625
00:28:59,840 --> 00:29:02,159
but there is a trick

626
00:29:02,159 --> 00:29:04,559
if you launch it from cli

627
00:29:04,559 --> 00:29:07,840
with a snapshot argument

628
00:29:07,919 --> 00:29:09,679
he can actually get a snapshot of

629
00:29:09,679 --> 00:29:12,080
everything

630
00:29:24,640 --> 00:29:26,960
well they actually brought it with them

631
00:29:26,960 --> 00:29:30,320
it wasn't on the system by default

632
00:29:30,320 --> 00:29:32,000
id explorer

633
00:29:32,000 --> 00:29:34,799
was in some systems but not the others

634
00:29:34,799 --> 00:29:38,080
but ads query

635
00:29:38,159 --> 00:29:40,399
cannot be found

636
00:29:40,399 --> 00:29:43,840
at its uh trivial location

637
00:29:43,840 --> 00:29:45,279
so this is something that would be

638
00:29:45,279 --> 00:29:47,279
relatively easy to detect but had it

639
00:29:47,279 --> 00:29:49,200
been there to start with they would have

640
00:29:49,200 --> 00:29:52,080
been able to use it

641
00:29:52,080 --> 00:29:55,199
and my favorite example

642
00:30:00,399 --> 00:30:02,240
so these are the people who actually

643
00:30:02,240 --> 00:30:04,960
attacked solarwinds

644
00:30:04,960 --> 00:30:06,399
and that's how they performed their

645
00:30:06,399 --> 00:30:08,399
supply chain attack

646
00:30:08,399 --> 00:30:10,240
so you can have for example a cobble

647
00:30:10,240 --> 00:30:12,240
strike beacon which

648
00:30:12,240 --> 00:30:15,520
will access or will uh you know query

649
00:30:15,520 --> 00:30:18,320
the admin every 14 days and

650
00:30:18,320 --> 00:30:22,120
one day attack starts

651
00:30:34,399 --> 00:30:36,559
in this example

652
00:30:36,559 --> 00:30:38,399
i think you can easily guess it if you

653
00:30:38,399 --> 00:30:42,158
look at the comment line arguments

654
00:30:42,799 --> 00:30:46,240
if you just download id finds and you

655
00:30:46,240 --> 00:30:48,799
rename it it won't really work you know

656
00:30:48,799 --> 00:30:51,120
it has to be called id fine dot exit but

657
00:30:51,120 --> 00:30:53,918
then you can patch it

658
00:30:58,799 --> 00:31:00,080
so usually you know when you're

659
00:31:00,080 --> 00:31:01,840
collecting network information lots of

660
00:31:01,840 --> 00:31:03,679
commands will be launched and it's very

661
00:31:03,679 --> 00:31:05,840
easy to detect such attacks at this

662
00:31:05,840 --> 00:31:08,720
particular stage

663
00:31:13,919 --> 00:31:15,679
in my list

664
00:31:15,679 --> 00:31:20,000
if it can be used it will be used

665
00:31:20,000 --> 00:31:22,080
regardless

666
00:31:22,080 --> 00:31:24,880
of how sophisticated a particular threat

667
00:31:24,880 --> 00:31:27,919
is because it is so convenient

668
00:31:27,919 --> 00:31:31,919
particularly if you are looking for data

669
00:31:35,880 --> 00:31:38,969
[Music]

670
00:31:46,559 --> 00:31:49,840
the rdp sometimes can not be leveraged

671
00:31:49,840 --> 00:31:50,880
but again

672
00:31:50,880 --> 00:31:54,000
attackers will know that

673
00:31:54,640 --> 00:31:57,039
which means that they will be able to

674
00:31:57,039 --> 00:31:59,200
use various scripts

675
00:31:59,200 --> 00:32:00,559
like for example

676
00:32:00,559 --> 00:32:04,320
if i want to go from host a to host b

677
00:32:04,320 --> 00:32:07,120
i can use aps exactly

678
00:32:07,120 --> 00:32:10,480
or ba exact which i mentioned previously

679
00:32:10,480 --> 00:32:13,760
i can launch the script there

680
00:32:27,679 --> 00:32:29,919
twists again the guys are using

681
00:32:29,919 --> 00:32:31,120
powershell

682
00:32:31,120 --> 00:32:34,000
so like i said all these techniques

683
00:32:34,000 --> 00:32:35,600
are so often used

684
00:32:35,600 --> 00:32:38,320
in combination

685
00:32:38,480 --> 00:32:40,480
i guess that's one half or maybe a

686
00:32:40,480 --> 00:32:44,000
two-thirds from this top 10 list

687
00:32:44,000 --> 00:32:47,039
will be found in combination in every

688
00:32:47,039 --> 00:32:47,919
attack

689
00:32:47,919 --> 00:32:50,000
file who is this premiere

690
00:32:50,000 --> 00:32:52,399
so another bad file here so in a

691
00:32:52,399 --> 00:32:54,240
particular example here we'll look at

692
00:32:54,240 --> 00:32:57,519
black cat

693
00:32:57,519 --> 00:32:59,279
you know they're often called aleph as

694
00:32:59,279 --> 00:33:00,640
well but they're effectively run

695
00:33:00,640 --> 00:33:03,519
somewhere in guys so the same script is

696
00:33:03,519 --> 00:33:07,360
being used by different operators

697
00:33:08,080 --> 00:33:11,039
because so many attacks today leveraging

698
00:33:11,039 --> 00:33:13,760
for ransomware

699
00:33:14,240 --> 00:33:17,039
based effectively on partnerships

700
00:33:17,039 --> 00:33:19,840
and since uh these partners

701
00:33:19,840 --> 00:33:21,679
operate like this uh you know they will

702
00:33:21,679 --> 00:33:24,159
be using different types of software you

703
00:33:24,159 --> 00:33:25,919
know some of these operators will be

704
00:33:25,919 --> 00:33:28,320
using like four different types of uh

705
00:33:28,320 --> 00:33:31,760
software at the same time

706
00:33:32,000 --> 00:33:34,320
so they will be deciding whether to use

707
00:33:34,320 --> 00:33:37,360
revel or direct sight or a black cat or

708
00:33:37,360 --> 00:33:39,840
something else

709
00:33:42,480 --> 00:33:46,000
and the final technique in my list

710
00:33:46,720 --> 00:33:48,559
is

711
00:33:48,559 --> 00:33:50,559
super popular as well

712
00:33:50,559 --> 00:33:52,799
both

713
00:33:53,120 --> 00:33:55,760
propagation inside the network and for

714
00:33:55,760 --> 00:33:57,440
checking out what's available on this to

715
00:33:57,440 --> 00:33:59,840
that host

716
00:33:59,900 --> 00:34:01,919
[Music]

717
00:34:01,919 --> 00:34:04,640
so for example you know in ransomware

718
00:34:04,640 --> 00:34:08,480
you can just you know mount all c drives

719
00:34:08,480 --> 00:34:10,399
from a single host and encrypt all of

720
00:34:10,399 --> 00:34:12,000
them and that's it

721
00:34:12,000 --> 00:34:14,159
bingo

722
00:34:14,159 --> 00:34:16,960
service execution

723
00:34:16,960 --> 00:34:18,560
it's very similar to what we discussed

724
00:34:18,560 --> 00:34:21,440
with the case of uh service execution

725
00:34:21,440 --> 00:34:23,040
where you would use a particular service

726
00:34:23,040 --> 00:34:25,359
to launch stuff on a remote's host

727
00:34:25,359 --> 00:34:26,960
and we could have used the same examples

728
00:34:26,960 --> 00:34:31,040
with bs exec here because in fact

729
00:34:31,119 --> 00:34:35,480
they have a very similar

730
00:34:40,330 --> 00:34:43,380
[Music]

731
00:34:44,639 --> 00:34:47,440
and if you have a linux host for example

732
00:34:47,440 --> 00:34:49,839
then the attackers will be able to get

733
00:34:49,839 --> 00:34:51,839
access to a vpn

734
00:34:51,839 --> 00:34:53,520
and then

735
00:34:53,520 --> 00:34:57,280
get access to the internal network

736
00:34:59,280 --> 00:35:01,359
add their machine and then if you want

737
00:35:01,359 --> 00:35:04,160
to do stuff on windows systems they will

738
00:35:04,160 --> 00:35:06,960
be using winixer instead of ps exactly

739
00:35:06,960 --> 00:35:09,200
correct

740
00:35:12,400 --> 00:35:14,160
i guess most people here will know where

741
00:35:14,160 --> 00:35:17,240
it is

742
00:35:22,000 --> 00:35:23,599
which enables you to collect network

743
00:35:23,599 --> 00:35:27,200
information and execute stuff only

744
00:35:27,200 --> 00:35:28,560
frameworks

745
00:35:28,560 --> 00:35:30,160
in fact pretty much any post

746
00:35:30,160 --> 00:35:32,400
exploitation framework

747
00:35:32,400 --> 00:35:33,760
present at least

748
00:35:33,760 --> 00:35:35,760
should enable you to create a remote

749
00:35:35,760 --> 00:35:37,920
service

750
00:35:37,920 --> 00:35:40,560
and launch things

751
00:35:41,040 --> 00:35:42,800
so if we are talking about defenders

752
00:35:42,800 --> 00:35:44,960
there will be artifacts for them such as

753
00:35:44,960 --> 00:35:47,119
uh

754
00:35:47,359 --> 00:35:49,760
instantiation of a new service

755
00:35:49,760 --> 00:35:51,599
and the same applies to cobble strike

756
00:35:51,599 --> 00:35:53,680
really

757
00:35:53,680 --> 00:35:56,720
so with cobbled strikes

758
00:35:56,800 --> 00:35:59,119
yes there are several opportunities to

759
00:35:59,119 --> 00:36:02,640
launch stuff remotely and ps exact psi

760
00:36:02,640 --> 00:36:05,040
was exactly this a power shell example

761
00:36:05,040 --> 00:36:07,520
you remote launch power shell and then

762
00:36:07,520 --> 00:36:11,200
launch something else inside it

763
00:36:25,040 --> 00:36:28,000
the ip address of the machine but if

764
00:36:28,000 --> 00:36:31,119
your version is uh

765
00:36:31,119 --> 00:36:33,920
you know it's beyond 4.1 then obviously

766
00:36:33,920 --> 00:36:36,960
this text will be different

767
00:36:37,839 --> 00:36:40,320
if you are interested in saying all this

768
00:36:40,320 --> 00:36:43,200
stuff in the world you can consult

769
00:36:43,200 --> 00:36:45,280
our reports this is something we've been

770
00:36:45,280 --> 00:36:46,640
publishing for the past two years

771
00:36:46,640 --> 00:36:48,480
ransomware and coverage is the name no

772
00:36:48,480 --> 00:36:50,240
advertising there this is you know pure

773
00:36:50,240 --> 00:36:51,119
play

774
00:36:51,119 --> 00:36:53,440
report

775
00:36:53,440 --> 00:36:55,760
so you can consult this one for example

776
00:36:55,760 --> 00:36:57,359
to check out

777
00:36:57,359 --> 00:36:59,359
how attackers

778
00:36:59,359 --> 00:37:01,760
had fun with carpet networks

779
00:37:01,760 --> 00:37:04,079
and all this stuff naturally is mapped

780
00:37:04,079 --> 00:37:06,320
to mitra attack system and there is a

781
00:37:06,320 --> 00:37:08,320
heat map there showing which techniques

782
00:37:08,320 --> 00:37:11,280
were used more often less often and you

783
00:37:11,280 --> 00:37:14,000
can download it naturally free of charge

784
00:37:14,000 --> 00:37:16,800
if you're interested

785
00:37:17,280 --> 00:37:19,280
this is it really for me if you want to

786
00:37:19,280 --> 00:37:22,780
ask any questions i will be happy

787
00:37:22,780 --> 00:37:30,399
[Applause]

788
00:37:35,280 --> 00:37:37,440
so you've told us about this uh 10

789
00:37:37,440 --> 00:37:40,000
popular techniques but this is ph days

790
00:37:40,000 --> 00:37:43,520
11. what can you propose

791
00:37:43,520 --> 00:37:45,280
you know on the basis of your recent

792
00:37:45,280 --> 00:37:47,359
experience

793
00:37:47,359 --> 00:37:50,960
what's you know particularly relevant

794
00:38:01,760 --> 00:38:03,520
and things are not really changing that

795
00:38:03,520 --> 00:38:05,520
fast

796
00:38:05,520 --> 00:38:08,160
no no so many vulnerabilities have

797
00:38:08,160 --> 00:38:11,279
already been discovered

798
00:38:11,450 --> 00:38:14,600
[Music]

799
00:38:15,440 --> 00:38:17,520
to try answering your question i would

800
00:38:17,520 --> 00:38:20,160
be thinking about uh supply chain

801
00:38:20,160 --> 00:38:21,920
attacks you know i'm not talking here

802
00:38:21,920 --> 00:38:24,800
about you know getting initial access

803
00:38:24,800 --> 00:38:27,280
nor am i talking about uh

804
00:38:27,280 --> 00:38:30,760
data exfiltration

805
00:38:33,150 --> 00:38:36,209
[Music]

806
00:38:38,990 --> 00:38:42,270
[Music]

807
00:38:45,200 --> 00:38:47,839
we should consider exfiltration of data

808
00:38:47,839 --> 00:38:49,520
to cloud

809
00:38:49,520 --> 00:38:52,160
data storages

810
00:38:52,160 --> 00:38:55,119
this is extremely popular now in the

811
00:38:55,119 --> 00:38:57,520
present threat landscape

812
00:38:57,520 --> 00:38:59,599
lots of operators of ransomware for

813
00:38:59,599 --> 00:39:01,839
example

814
00:39:04,560 --> 00:39:06,079
you know rather than just you know

815
00:39:06,079 --> 00:39:08,079
propagating on the carpet networks they

816
00:39:08,079 --> 00:39:09,280
just

817
00:39:09,280 --> 00:39:13,839
you know exfiltrate data and they demand

818
00:39:17,200 --> 00:39:19,359
so that would be my answer if you want

819
00:39:19,359 --> 00:39:23,440
uh technique number 11 that would be it

820
00:39:25,040 --> 00:39:29,119
off my question no principle

821
00:39:30,560 --> 00:39:32,160
so if you see i guess the question is

822
00:39:32,160 --> 00:39:34,880
about power shell well yes

823
00:39:34,880 --> 00:39:36,640
you should be able

824
00:39:36,640 --> 00:39:38,800
to switch it off

825
00:39:38,800 --> 00:39:42,160
now what you need to remember

826
00:39:46,960 --> 00:39:49,760
and very often this stuff is online

827
00:39:49,760 --> 00:39:51,839
uncontrollably so to speak you know

828
00:39:51,839 --> 00:39:53,359
there were questions there were cases

829
00:39:53,359 --> 00:39:54,079
when

830
00:39:54,079 --> 00:39:56,640
people would have idr

831
00:39:56,640 --> 00:39:58,960
but you know they wouldn't really be

832
00:39:58,960 --> 00:40:00,480
checking it

833
00:40:00,480 --> 00:40:01,680
that well

834
00:40:01,680 --> 00:40:04,560
you know vendor told us to install it

835
00:40:04,560 --> 00:40:06,720
and we we thought it would be working

836
00:40:06,720 --> 00:40:09,359
yes we do have soc

837
00:40:09,359 --> 00:40:11,520
but you know security operations century

838
00:40:11,520 --> 00:40:13,920
they still need to repair their printer

839
00:40:13,920 --> 00:40:15,520
so they don't have the time for your

840
00:40:15,520 --> 00:40:17,119
powershell business

841
00:40:17,119 --> 00:40:18,560
and it's not just happening in russia

842
00:40:18,560 --> 00:40:19,839
it's happening in other countries as

843
00:40:19,839 --> 00:40:22,000
well

844
00:40:36,720 --> 00:40:39,680
how can we actually you know monitor it

845
00:40:39,680 --> 00:40:43,200
well you need third-party sock and easy

846
00:40:43,200 --> 00:40:46,160
this is the way of doing it

847
00:40:46,160 --> 00:40:50,480
reliably with as little uh you know

848
00:40:50,480 --> 00:40:53,280
involvement on your part is needed well

849
00:40:53,280 --> 00:40:56,480
i guess it's a thank you

850
00:40:57,920 --> 00:40:59,359
microphone

851
00:40:59,359 --> 00:41:03,440
so do we have uh do we have a mic yes

852
00:41:04,880 --> 00:41:07,839
thanks for your report

853
00:41:09,119 --> 00:41:11,359
so you've touched upon a pain point here

854
00:41:11,359 --> 00:41:13,680
when you talked about suck

855
00:41:13,680 --> 00:41:15,280
how do we

856
00:41:15,280 --> 00:41:17,440
distinguish between the noise and what's

857
00:41:17,440 --> 00:41:21,000
really happening

858
00:41:25,520 --> 00:41:27,680
you have a shadow tool that

859
00:41:27,680 --> 00:41:31,440
launches an obfuscated powershell script

860
00:41:31,440 --> 00:41:33,280
and you know this is happening really

861
00:41:33,280 --> 00:41:35,839
very very often

862
00:41:35,839 --> 00:41:38,000
so as a forensics expert

863
00:41:38,000 --> 00:41:39,680
can you please tell us

864
00:41:39,680 --> 00:41:42,319
how can we distinguish between malicious

865
00:41:42,319 --> 00:41:46,240
obfuscated scripts and bona fide things

866
00:41:46,240 --> 00:41:47,599
well this is something that we run

867
00:41:47,599 --> 00:41:50,000
against so we run into ourselves you

868
00:41:50,000 --> 00:41:51,680
know just like everybody else we've got

869
00:41:51,680 --> 00:41:53,599
our own sock and our stock is not

870
00:41:53,599 --> 00:41:55,680
monitoring a single firm it's monitoring

871
00:41:55,680 --> 00:41:59,280
lots of companies i can relate to that

872
00:41:59,280 --> 00:42:01,119
so things are happening there all the

873
00:42:01,119 --> 00:42:03,839
time

874
00:42:03,920 --> 00:42:05,839
and for the past six months you know

875
00:42:05,839 --> 00:42:09,759
we've been profiling certain companies

876
00:42:09,920 --> 00:42:13,280
so we have automated deduction

877
00:42:13,280 --> 00:42:15,200
scripts so to speak you know we know for

878
00:42:15,200 --> 00:42:17,599
example that uh company a

879
00:42:17,599 --> 00:42:20,400
has run dll launching this this and this

880
00:42:20,400 --> 00:42:22,880
and this is legitimate

881
00:42:22,880 --> 00:42:24,880
update

882
00:42:24,880 --> 00:42:27,680
so you know from update to roaming

883
00:42:27,680 --> 00:42:30,240
or some hdr files that will be launched

884
00:42:30,240 --> 00:42:32,960
you know because somebody is using some

885
00:42:32,960 --> 00:42:35,280
software so you know we will have it in

886
00:42:35,280 --> 00:42:37,680
our profile for this particular

887
00:42:37,680 --> 00:42:39,280
corporate customer

888
00:42:39,280 --> 00:42:42,160
so this is you know a filter which kicks

889
00:42:42,160 --> 00:42:44,640
in after

890
00:42:47,200 --> 00:42:49,359
and all the new things you will need to

891
00:42:49,359 --> 00:42:51,280
triage and there is no other way around

892
00:42:51,280 --> 00:42:52,640
it

893
00:42:52,640 --> 00:42:55,920
so imagine that your administrator will

894
00:42:55,920 --> 00:42:58,400
download many cuts from github from a

895
00:42:58,400 --> 00:43:00,160
terminal server because he needs some

896
00:43:00,160 --> 00:43:01,760
credentials

897
00:43:01,760 --> 00:43:03,760
i'm not saying it happens every day but

898
00:43:03,760 --> 00:43:06,800
it does happen from time to time

899
00:43:06,800 --> 00:43:08,560
which means

900
00:43:08,560 --> 00:43:10,960
that you know

901
00:43:10,960 --> 00:43:13,520
attackers so they get access through

902
00:43:13,520 --> 00:43:16,000
sound vulnerability to your server and

903
00:43:16,000 --> 00:43:16,960
it will look

904
00:43:16,960 --> 00:43:18,960
just the same and they will be using the

905
00:43:18,960 --> 00:43:22,079
credentials of the same admin

906
00:43:22,079 --> 00:43:23,839
there is no silver bullet here it needs

907
00:43:23,839 --> 00:43:26,960
to be triaged and that requires a sock

908
00:43:26,960 --> 00:43:29,680
such a shame

909
00:43:32,880 --> 00:43:34,480
well but don't you talk to the admins

910
00:43:34,480 --> 00:43:36,240
don't you tell them they shouldn't do it

911
00:43:36,240 --> 00:43:37,280
you know what

912
00:43:37,280 --> 00:43:38,079
if it's

913
00:43:38,079 --> 00:43:40,560
like if you only employ like 500 people

914
00:43:40,560 --> 00:43:43,599
or 1 000 it will work

915
00:43:43,599 --> 00:43:46,400
potentially but some of our clients

916
00:43:46,400 --> 00:43:49,520
employ or like have uh 30 000 hosts

917
00:43:49,520 --> 00:43:52,000
and they say

918
00:43:52,000 --> 00:43:54,160
10 000 of our hosts they're laptops we

919
00:43:54,160 --> 00:43:56,079
don't really know who owns them we don't

920
00:43:56,079 --> 00:43:58,240
know how to get in touch with them

921
00:43:58,240 --> 00:44:00,000
because this is how it's often run and

922
00:44:00,000 --> 00:44:03,839
they also need to be defended

923
00:44:07,839 --> 00:44:10,720
you is it really really depends on the

924
00:44:10,720 --> 00:44:12,960
circumstances so to speak so there is

925
00:44:12,960 --> 00:44:14,240
this thing called business email

926
00:44:14,240 --> 00:44:17,040
compromise and we do see lots of cases

927
00:44:17,040 --> 00:44:19,760
like this or quite a lot at least

928
00:44:19,760 --> 00:44:22,160
so we are telling you need to fa because

929
00:44:22,160 --> 00:44:23,440
until you have two factory

930
00:44:23,440 --> 00:44:25,440
authentication you will be getting this

931
00:44:25,440 --> 00:44:27,440
 and they say no it's inconvenient

932
00:44:27,440 --> 00:44:29,599
when i kind of do that

933
00:44:29,599 --> 00:44:31,280
and you're telling me about admins you

934
00:44:31,280 --> 00:44:34,960
know it's even worse with the admins

935
00:44:40,240 --> 00:44:41,680
you know this is a case you know where

936
00:44:41,680 --> 00:44:44,879
exceptions prove the rule

937
00:44:48,319 --> 00:44:50,560
yeah i guess it takes it takes many

938
00:44:50,560 --> 00:44:52,720
years to teach people things and you

939
00:44:52,720 --> 00:44:54,319
cannot do it if you're working for a

940
00:44:54,319 --> 00:44:55,839
sock

941
00:44:55,839 --> 00:44:56,800
hi

942
00:44:56,800 --> 00:44:57,920
thanks for your prayer for your

943
00:44:57,920 --> 00:45:00,480
presentation i'm here

944
00:45:00,480 --> 00:45:03,960
in the very center

945
00:45:04,160 --> 00:45:06,560
you've been talking mostly about uh

946
00:45:06,560 --> 00:45:09,599
windows and what about linux

947
00:45:09,599 --> 00:45:11,599
and just slow booboo you know we don't

948
00:45:11,599 --> 00:45:14,960
really see many hexa other systems but

949
00:45:14,960 --> 00:45:18,160
there are many vectors

950
00:45:19,040 --> 00:45:20,880
and this is a disclaimer i should have

951
00:45:20,880 --> 00:45:22,720
mentioned i'm talking about corporate

952
00:45:22,720 --> 00:45:25,040
windows networks here

953
00:45:25,040 --> 00:45:28,000
and the simple answer to why here is

954
00:45:28,000 --> 00:45:30,800
that over 90 percent of cases we are

955
00:45:30,800 --> 00:45:33,119
dealing

956
00:45:37,200 --> 00:45:39,599
for obvious reasons maybe next year i'll

957
00:45:39,599 --> 00:45:43,200
be making a report on nick's attacks but

958
00:45:43,200 --> 00:45:46,839
so far it's windows

959
00:45:55,920 --> 00:45:57,599
thank you very much it's such an

960
00:45:57,599 --> 00:45:58,839
interesting

961
00:45:58,839 --> 00:46:00,800
report if we're talking about the

962
00:46:00,800 --> 00:46:03,680
windows world here and windows says uh

963
00:46:03,680 --> 00:46:06,480
still dominant

964
00:46:06,480 --> 00:46:08,400
what are your you know what's your top

965
00:46:08,400 --> 00:46:10,319
list of artifacts you will be collecting

966
00:46:10,319 --> 00:46:12,160
it's super easy really

967
00:46:12,160 --> 00:46:14,400
if you consult the top 10 list i've just

968
00:46:14,400 --> 00:46:16,560
showed you it should tell you which

969
00:46:16,560 --> 00:46:18,800
artifacts i'm looking for

970
00:46:18,800 --> 00:46:20,640
now for powershell for example

971
00:46:20,640 --> 00:46:24,160
powershell has got its own logs

972
00:46:24,560 --> 00:46:26,160
and if we're talking about service

973
00:46:26,160 --> 00:46:29,160
execution

974
00:46:39,440 --> 00:46:40,839
you know there will be

975
00:46:40,839 --> 00:46:43,280
incidents where none of this stuff

976
00:46:43,280 --> 00:46:45,520
available is available and they no if

977
00:46:45,520 --> 00:46:47,200
it's a binaries you know we will be

978
00:46:47,200 --> 00:46:49,350
looking at the cache

979
00:46:49,350 --> 00:46:50,480
[Music]

980
00:46:50,480 --> 00:46:52,000
and

981
00:46:52,000 --> 00:46:53,839
if we are talking about the initial

982
00:46:53,839 --> 00:46:56,839
stage

983
00:46:58,800 --> 00:47:00,640
you know we are collecting everything

984
00:47:00,640 --> 00:47:01,920
from everywhere it's not just like we

985
00:47:01,920 --> 00:47:04,079
are collecting from just three hosts

986
00:47:04,079 --> 00:47:06,160
you know we will tell our clients you've

987
00:47:06,160 --> 00:47:09,359
got 10 000 hosts so please collect

988
00:47:09,359 --> 00:47:11,680
this list of indicators from this 10 000

989
00:47:11,680 --> 00:47:12,720
hosts

990
00:47:12,720 --> 00:47:14,880
we are not really collecting too many

991
00:47:14,880 --> 00:47:17,520
indicators

992
00:47:17,920 --> 00:47:19,920
do you know cyber string theory you know

993
00:47:19,920 --> 00:47:22,079
there there is this life cycle now

994
00:47:22,079 --> 00:47:24,160
there's this blue lines you can pull and

995
00:47:24,160 --> 00:47:26,319
the idea here is the same you are

996
00:47:26,319 --> 00:47:28,720
collecting a certain minimum amount of

997
00:47:28,720 --> 00:47:31,839
data which effectively enables you to

998
00:47:31,839 --> 00:47:34,000
pull on those strings and then you will

999
00:47:34,000 --> 00:47:34,960
know

1000
00:47:34,960 --> 00:47:37,040
where and what kind of data to collect

1001
00:47:37,040 --> 00:47:40,079
so in some cases you will be able to do

1002
00:47:40,079 --> 00:47:42,160
a more extensive triage

1003
00:47:42,160 --> 00:47:44,640
or to do say a memory snapshot or in

1004
00:47:44,640 --> 00:47:46,400
some cases you will only need just a

1005
00:47:46,400 --> 00:47:48,319
couple of registry files and you know

1006
00:47:48,319 --> 00:47:51,119
several dozen strings from the event log

1007
00:47:51,119 --> 00:47:53,440
in order to see that something weird was

1008
00:47:53,440 --> 00:47:56,720
happening here or not

1009
00:47:58,720 --> 00:48:00,559
hi i'm leonid

1010
00:48:00,559 --> 00:48:02,079
and i wanted to build on the previous

1011
00:48:02,079 --> 00:48:04,319
question regarding next systems

1012
00:48:04,319 --> 00:48:07,440
so how do we know that the entry point

1013
00:48:07,440 --> 00:48:10,079
of the corporate network

1014
00:48:10,079 --> 00:48:14,640
is a web service i mean if we know it

1015
00:48:15,440 --> 00:48:16,960
shall we look for

1016
00:48:16,960 --> 00:48:18,880
artifacts there

1017
00:48:18,880 --> 00:48:21,040
for example you know when commands are

1018
00:48:21,040 --> 00:48:23,119
being executed

1019
00:48:23,119 --> 00:48:23,920
by

1020
00:48:23,920 --> 00:48:26,400
you know accounts and web services

1021
00:48:26,400 --> 00:48:29,440
yeah i do agree with that

1022
00:48:37,839 --> 00:48:40,400
well we have already decided that my

1023
00:48:40,400 --> 00:48:42,480
next speech will be about next systems

1024
00:48:42,480 --> 00:48:47,079
and attacks against them

1025
00:49:02,960 --> 00:49:06,319
no mitigation advice is difficult

1026
00:49:06,319 --> 00:49:09,920
i mean the specific advice bits are

1027
00:49:09,920 --> 00:49:12,000
pretty obvious

1028
00:49:12,000 --> 00:49:13,920
but the problem

1029
00:49:13,920 --> 00:49:14,640
is

1030
00:49:14,640 --> 00:49:16,480
you know if you do this mitigation

1031
00:49:16,480 --> 00:49:18,559
chances are you're going to put your

1032
00:49:18,559 --> 00:49:20,720
business processes at risk

1033
00:49:20,720 --> 00:49:23,839
that's why we're focusing on detection

1034
00:49:23,839 --> 00:49:25,200
and we're saying well these things will

1035
00:49:25,200 --> 00:49:27,920
be used pretty much every day and we

1036
00:49:27,920 --> 00:49:31,119
need to make sure we're detecting that

1037
00:49:31,119 --> 00:49:32,640
because you know i'd say you sort of

1038
00:49:32,640 --> 00:49:34,960
expected to simplify things

1039
00:49:34,960 --> 00:49:37,040
and if we are doing the opposite of it

1040
00:49:37,040 --> 00:49:39,359
you know we're hamstringing business we

1041
00:49:39,359 --> 00:49:41,680
need to go for some equilibrium here we

1042
00:49:41,680 --> 00:49:43,839
would love to prohibit everything but

1043
00:49:43,839 --> 00:49:45,359
naturally this is not how it should be

1044
00:49:45,359 --> 00:49:47,359
done again much will depend on the

1045
00:49:47,359 --> 00:49:48,480
customer

1046
00:49:48,480 --> 00:49:50,160
you know the russian companies for home

1047
00:49:50,160 --> 00:49:52,079
zero trust is okay and they will

1048
00:49:52,079 --> 00:49:53,680
prohibit everything

1049
00:49:53,680 --> 00:49:55,839
if sure like an employee will need

1050
00:49:55,839 --> 00:49:57,760
access to a single information system

1051
00:49:57,760 --> 00:49:59,280
and this is it

1052
00:49:59,280 --> 00:50:01,440
you know with a customer like this

1053
00:50:01,440 --> 00:50:03,599
obviously we will have more leeway so to

1054
00:50:03,599 --> 00:50:05,680
speak in terms of prohibitions but

1055
00:50:05,680 --> 00:50:07,520
unfortunately in the modern day world so

1056
00:50:07,520 --> 00:50:09,359
you cannot really do it in most cases

1057
00:50:09,359 --> 00:50:11,119
particularly with larger networks where

1058
00:50:11,119 --> 00:50:13,119
you have like you know thousands of

1059
00:50:13,119 --> 00:50:16,160
hosts you know where many processes are

1060
00:50:16,160 --> 00:50:19,359
legacy and so there mitigating is not

1061
00:50:19,359 --> 00:50:20,800
really an option we will be mostly

1062
00:50:20,800 --> 00:50:23,280
detecting

1063
00:50:23,680 --> 00:50:26,319
and yes you know had we mitigated them

1064
00:50:26,319 --> 00:50:28,319
all it would have been a boring world

1065
00:50:28,319 --> 00:50:30,720
for us

1066
00:50:33,520 --> 00:50:36,920
of my comments

1067
00:50:47,200 --> 00:50:49,040
yeah i guess the first thing

1068
00:50:49,040 --> 00:50:52,160
is that you know you you shouldn't allow

1069
00:50:52,160 --> 00:50:55,200
the users to format the drives it sounds

1070
00:50:55,200 --> 00:50:58,000
obvious but you know quite often we see

1071
00:50:58,000 --> 00:51:01,520
that we tell them guys we see a host

1072
00:51:01,520 --> 00:51:04,319
and it must be the first host to be

1073
00:51:04,319 --> 00:51:06,880
compromised do nothing about it isolate

1074
00:51:06,880 --> 00:51:10,720
it we are going to investigate it

1075
00:51:10,720 --> 00:51:12,720
so they read the message it's like the

1076
00:51:12,720 --> 00:51:14,559
first host

1077
00:51:14,559 --> 00:51:16,400
and you know somebody you know

1078
00:51:16,400 --> 00:51:18,800
disconnects the drive and throws it out

1079
00:51:18,800 --> 00:51:19,920
the window

1080
00:51:19,920 --> 00:51:22,640
it happens so often

1081
00:51:22,640 --> 00:51:24,800
same with lockers you know people will

1082
00:51:24,800 --> 00:51:27,440
often be switching the

1083
00:51:27,440 --> 00:51:30,240
these systems off where the process is

1084
00:51:30,240 --> 00:51:32,559
already running and many operators are

1085
00:51:32,559 --> 00:51:34,880
not really skilled enough and many of

1086
00:51:34,880 --> 00:51:36,880
them are

1087
00:51:36,880 --> 00:51:39,040
pretty bad at uh

1088
00:51:39,040 --> 00:51:40,960
actually writing the code so even if you

1089
00:51:40,960 --> 00:51:43,760
later on decrypt it or you even pay for

1090
00:51:43,760 --> 00:51:46,559
it your system will stay

1091
00:51:46,559 --> 00:51:48,559
encrypted

1092
00:51:48,559 --> 00:51:50,880
so if you don't know what to do do

1093
00:51:50,880 --> 00:51:52,640
nothing okay

1094
00:51:52,640 --> 00:51:56,480
just wait for the people who know uh

1095
00:51:56,640 --> 00:51:58,880
hi thank you very much for the report

1096
00:51:58,880 --> 00:52:01,520
now my question is like this

1097
00:52:01,520 --> 00:52:04,520
is

1098
00:52:04,720 --> 00:52:08,240
list of techniques and sub techniques

1099
00:52:08,240 --> 00:52:10,640
what's uh the variability

1100
00:52:10,640 --> 00:52:12,640
it varies between industries there is no

1101
00:52:12,640 --> 00:52:14,480
difference it's the same in different

1102
00:52:14,480 --> 00:52:16,880
countries across industries

1103
00:52:16,880 --> 00:52:20,160
so a south african crypto exchange for

1104
00:52:20,160 --> 00:52:23,839
example running linux machines only

1105
00:52:23,839 --> 00:52:26,000
and doing you know uh

1106
00:52:26,000 --> 00:52:28,400
services of a web service this is still

1107
00:52:28,400 --> 00:52:30,559
the least i shouldn't care about

1108
00:52:30,559 --> 00:52:32,400
no we are talking about carpet networks

1109
00:52:32,400 --> 00:52:33,359
again

1110
00:52:33,359 --> 00:52:35,440
and we are again talking about windows

1111
00:52:35,440 --> 00:52:37,520
based corporate networks

1112
00:52:37,520 --> 00:52:38,720
you know if we are talking about the

1113
00:52:38,720 --> 00:52:40,559
linux like systems it will be a

1114
00:52:40,559 --> 00:52:42,480
different list for sure

1115
00:52:42,480 --> 00:52:44,640
the problem however at least this is how

1116
00:52:44,640 --> 00:52:47,520
we see it is that first you know

1117
00:52:47,520 --> 00:52:50,720
attackers will hack the windows part

1118
00:52:50,720 --> 00:52:52,319
before

1119
00:52:52,319 --> 00:52:54,559
you know they start playing with the

1120
00:52:54,559 --> 00:52:57,280
linux systems

1121
00:52:57,280 --> 00:52:59,599
so it all starts with windows you know

1122
00:52:59,599 --> 00:53:02,880
over ssh for example they eventually get

1123
00:53:02,880 --> 00:53:05,920
access to linux

1124
00:53:06,000 --> 00:53:08,160
same would be true for say industrial

1125
00:53:08,160 --> 00:53:09,760
enterprises

1126
00:53:09,760 --> 00:53:11,760
where there is the industrial control

1127
00:53:11,760 --> 00:53:14,079
system

1128
00:53:26,800 --> 00:53:29,280
so it's effectively better to

1129
00:53:29,280 --> 00:53:31,359
you know stick to the same thing

1130
00:53:31,359 --> 00:53:33,520
no

1131
00:53:33,680 --> 00:53:36,079
well look for shell for example

1132
00:53:36,079 --> 00:53:39,040
there were lots and lots of knicks cases

1133
00:53:39,040 --> 00:53:40,839
so they could be

1134
00:53:40,839 --> 00:53:42,720
used

1135
00:53:42,720 --> 00:53:45,520
you know it all depends on uh what the

1136
00:53:45,520 --> 00:53:47,359
perpetrator wants to do because some of

1137
00:53:47,359 --> 00:53:49,680
them want to steal your data and others

1138
00:53:49,680 --> 00:53:51,359
you know want to steal your money and

1139
00:53:51,359 --> 00:53:53,040
yet others want to

1140
00:53:53,040 --> 00:53:55,280
spread their ransomware

1141
00:53:55,280 --> 00:53:59,040
so depending on your system which can be

1142
00:53:59,040 --> 00:54:00,640
said

1143
00:54:00,640 --> 00:54:03,440
spiced and open to the internet and it

1144
00:54:03,440 --> 00:54:05,200
has vulnerabilities and nobody's taking

1145
00:54:05,200 --> 00:54:07,119
care of them there are lots of service

1146
00:54:07,119 --> 00:54:09,200
like this you will be attacked over this

1147
00:54:09,200 --> 00:54:12,240
surface but if this system is so well

1148
00:54:12,240 --> 00:54:14,079
protected but it can be accessed from a

1149
00:54:14,079 --> 00:54:16,720
windows part of the network

1150
00:54:16,720 --> 00:54:19,520
and you know chances are you know

1151
00:54:19,520 --> 00:54:22,000
you will be using

1152
00:54:22,000 --> 00:54:24,000
laptops on the same system as well and

1153
00:54:24,000 --> 00:54:25,520
they won't be linux space right they

1154
00:54:25,520 --> 00:54:30,280
will be max or even windows based

1155
00:54:46,319 --> 00:54:48,160
over the years we are saying that you

1156
00:54:48,160 --> 00:54:50,480
know for the kill chains uh perpetrators

1157
00:54:50,480 --> 00:54:53,760
are using increasingly using

1158
00:54:53,760 --> 00:54:56,240
legitimate software

1159
00:54:56,240 --> 00:54:58,079
and therefore

1160
00:54:58,079 --> 00:55:00,160
the focus of what we're doing has

1161
00:55:00,160 --> 00:55:02,880
shifted from specific software to

1162
00:55:02,880 --> 00:55:05,280
methods

1163
00:55:17,440 --> 00:55:21,240
you're absolutely right

1164
00:55:23,520 --> 00:55:25,599
and indeed there are so many attacks

1165
00:55:25,599 --> 00:55:27,599
which are effectively

1166
00:55:27,599 --> 00:55:30,480
manually controlled so many things

1167
00:55:30,480 --> 00:55:33,119
previously were automated

1168
00:55:33,119 --> 00:55:35,280
now both state sponsors

1169
00:55:35,280 --> 00:55:37,599
and ransomware operators

1170
00:55:37,599 --> 00:55:40,480
you know they do involve

1171
00:55:40,480 --> 00:55:44,160
a lot of human intervention

1172
00:55:45,440 --> 00:55:49,640
this is something i previously mentioned

1173
00:56:00,960 --> 00:56:02,720
interestingly what we're seeing now is

1174
00:56:02,720 --> 00:56:05,520
that you know attackers try to abuse

1175
00:56:05,520 --> 00:56:08,000
what's already on the machine

1176
00:56:08,000 --> 00:56:10,240
because obviously you know if you have

1177
00:56:10,240 --> 00:56:13,200
any desk or a team viewer

1178
00:56:13,200 --> 00:56:15,599
appear on a server or browser's system

1179
00:56:15,599 --> 00:56:18,000
you know this is a telltale sign it's a

1180
00:56:18,000 --> 00:56:20,720
smoking gun

1181
00:56:27,119 --> 00:56:28,720
so for example

1182
00:56:28,720 --> 00:56:30,319
as you're collecting information on the

1183
00:56:30,319 --> 00:56:31,520
network

1184
00:56:31,520 --> 00:56:34,079
you may discover that administrators are

1185
00:56:34,079 --> 00:56:36,160
using special software to scan the

1186
00:56:36,160 --> 00:56:38,079
network

1187
00:56:38,079 --> 00:56:39,839
or for some other needs and they're

1188
00:56:39,839 --> 00:56:41,920
using certain random remote success

1189
00:56:41,920 --> 00:56:44,160
tools

1190
00:56:52,960 --> 00:56:55,040
you know they will try to use what's

1191
00:56:55,040 --> 00:56:58,000
already in place

1192
00:57:00,960 --> 00:57:02,880
very difficult to discern like some

1193
00:57:02,880 --> 00:57:04,400
people will be using any desk because

1194
00:57:04,400 --> 00:57:06,079
they're working remotely

1195
00:57:06,079 --> 00:57:08,000
and then attackers will be using any

1196
00:57:08,000 --> 00:57:11,119
desk as well at the same time how do you

1197
00:57:11,119 --> 00:57:13,520
detect that

1198
00:57:13,520 --> 00:57:16,319
you know so far

1199
00:57:16,880 --> 00:57:18,079
you know

1200
00:57:18,079 --> 00:57:20,079
we have been able to find them you know

1201
00:57:20,079 --> 00:57:22,000
when they continue mounting their

1202
00:57:22,000 --> 00:57:24,160
attacks

1203
00:57:24,160 --> 00:57:26,079
attacks against corporate networks they

1204
00:57:26,079 --> 00:57:28,880
usually involve lots of steps

1205
00:57:28,880 --> 00:57:31,119
so it will be at the other steps that we

1206
00:57:31,119 --> 00:57:33,680
will be able to identify them but it's

1207
00:57:33,680 --> 00:57:36,720
indeed very important you know not to be

1208
00:57:36,720 --> 00:57:38,960
blinded by all this noise

1209
00:57:38,960 --> 00:57:41,200
so the first integration iteration

1210
00:57:41,200 --> 00:57:44,400
involves you know the attackers using

1211
00:57:44,400 --> 00:57:45,359
uh

1212
00:57:45,359 --> 00:57:48,400
i'm sorry malware the next one is using

1213
00:57:48,400 --> 00:57:50,799
legit legit software what's the next

1214
00:57:50,799 --> 00:57:52,880
step i'm sorry it's a philosophical

1215
00:57:52,880 --> 00:57:55,200
question

1216
00:58:07,440 --> 00:58:10,720
users to provide authentication data to

1217
00:58:10,720 --> 00:58:11,920
servers

1218
00:58:11,920 --> 00:58:14,240
or to remote access tools

1219
00:58:14,240 --> 00:58:18,399
and they will request it from the users

1220
00:58:19,760 --> 00:58:22,640
social engineering if you ask me

1221
00:58:22,640 --> 00:58:24,799
yes

1222
00:58:26,319 --> 00:58:30,079
and there can be collusion there right

1223
00:58:30,079 --> 00:58:32,799
so for example your sock can ask you are

1224
00:58:32,799 --> 00:58:34,160
you doing something good there and

1225
00:58:34,160 --> 00:58:38,078
you'll say yes and it will be a lie

1226
00:58:38,640 --> 00:58:40,559
so it's not even social engineering this

1227
00:58:40,559 --> 00:58:42,559
uh sounds more like espionage and

1228
00:58:42,559 --> 00:58:46,400
bribery yes thank you so much

