1
00:00:00,000 --> 00:00:01,199
my name is philippe peters and today

2
00:00:01,199 --> 00:00:02,399
we're going to talk about discovering

3
00:00:02,399 --> 00:00:05,120
cnc malicious speedy app right so this

4
00:00:05,120 --> 00:00:08,000
is my contact at twitter at playbears

5
00:00:08,000 --> 00:00:10,320
and here some information about me you

6
00:00:10,320 --> 00:00:11,920
can find other talks that i've been

7
00:00:11,920 --> 00:00:15,200
talking in different events

8
00:00:15,440 --> 00:00:17,600
and my github here you can find other

9
00:00:17,600 --> 00:00:19,199
projects and articles that have been

10
00:00:19,199 --> 00:00:20,320
published there

11
00:00:20,320 --> 00:00:22,400
and my linkedin as well so if you'd like

12
00:00:22,400 --> 00:00:24,240
to exchange something with me so i

13
00:00:24,240 --> 00:00:27,199
really appreciate that okay so who am i

14
00:00:27,199 --> 00:00:28,880
i'm a security researcher at sapporo

15
00:00:28,880 --> 00:00:31,039
supports a company from switzerland and

16
00:00:31,039 --> 00:00:32,479
i'm responsible for creating the

17
00:00:32,479 --> 00:00:34,239
intelligent behind of this project

18
00:00:34,239 --> 00:00:36,800
basically i'm creating i crea i'm

19
00:00:36,800 --> 00:00:38,160
responsible for creating different

20
00:00:38,160 --> 00:00:39,680
attack modules for the attacker

21
00:00:39,680 --> 00:00:41,840
perspective and i create this logical

22
00:00:41,840 --> 00:00:43,520
this attacks

23
00:00:43,520 --> 00:00:45,120
based on on cloud on on-premise

24
00:00:45,120 --> 00:00:46,559
environment and i send those information

25
00:00:46,559 --> 00:00:48,079
to the developer and team and this team

26
00:00:48,079 --> 00:00:50,160
is responsible for creating intelligent

27
00:00:50,160 --> 00:00:50,960
for

28
00:00:50,960 --> 00:00:53,680
this specific product so the idea of

29
00:00:53,680 --> 00:00:55,039
this product is to working with the

30
00:00:55,039 --> 00:00:57,760
specific cyber resistance and give this

31
00:00:57,760 --> 00:00:59,920
information for our customers okay and

32
00:00:59,920 --> 00:01:02,239
i'm security advocate at singapore since

33
00:01:02,239 --> 00:01:03,840
it's a company a global company

34
00:01:03,840 --> 00:01:06,080
responsible for providing different

35
00:01:06,080 --> 00:01:07,680
solutions but it's economy of the

36
00:01:07,680 --> 00:01:10,560
previous access management right and i'm

37
00:01:10,560 --> 00:01:12,479
advocate of this awesome project called

38
00:01:12,479 --> 00:01:14,720
hacking is not a crime basically the

39
00:01:14,720 --> 00:01:16,640
idea behind of this project is to talk

40
00:01:16,640 --> 00:01:18,560
about this concept calling hacking

41
00:01:18,560 --> 00:01:20,560
because hacking is really the

42
00:01:20,560 --> 00:01:22,560
kind of lifestyle that you can use in

43
00:01:22,560 --> 00:01:25,759
your life not only of course we we are

44
00:01:25,759 --> 00:01:27,680
talking about about security about the

45
00:01:27,680 --> 00:01:29,680
technology but how you can use your

46
00:01:29,680 --> 00:01:31,360
creative mind how you can implementing

47
00:01:31,360 --> 00:01:34,240
this not only in software but in your

48
00:01:34,240 --> 00:01:36,640
life okay so that's the idea because

49
00:01:36,640 --> 00:01:38,560
when you let's suppose that you are a

50
00:01:38,560 --> 00:01:39,600
lawyer

51
00:01:39,600 --> 00:01:40,560
if you

52
00:01:40,560 --> 00:01:42,960
executing bad things you're in this

53
00:01:42,960 --> 00:01:45,119
moment you are a criminal and not a bad

54
00:01:45,119 --> 00:01:46,960
lawyer right so that's the difference so

55
00:01:46,960 --> 00:01:50,159
when you see something uh like like

56
00:01:50,159 --> 00:01:52,000
specifically leaks of the informations

57
00:01:52,000 --> 00:01:53,119
or

58
00:01:53,119 --> 00:01:56,159
some company that have some data expose

59
00:01:56,159 --> 00:01:58,960
it basically this is about the cyber

60
00:01:58,960 --> 00:02:01,280
criminals not a hacking hacking it's a

61
00:02:01,280 --> 00:02:03,119
mindset and how can using this this is

62
00:02:03,119 --> 00:02:05,520
project started in the us but we have

63
00:02:05,520 --> 00:02:08,399
advocates you know around the world

64
00:02:08,399 --> 00:02:10,479
okay and i'm is nick ambassador based in

65
00:02:10,479 --> 00:02:12,640
this specifically open source project

66
00:02:12,640 --> 00:02:14,560
the idea of this nick probably you know

67
00:02:14,560 --> 00:02:17,040
about that so it's a sad solution not

68
00:02:17,040 --> 00:02:18,879
only is a solution but the idea behind

69
00:02:18,879 --> 00:02:21,120
of this

70
00:02:21,120 --> 00:02:22,720
technology is to talk about the

71
00:02:22,720 --> 00:02:24,640
developer the secure development process

72
00:02:24,640 --> 00:02:26,239
process basically so when you create a

73
00:02:26,239 --> 00:02:28,640
specifically app or code so how you can

74
00:02:28,640 --> 00:02:30,959
create these in a sec in a safe way or a

75
00:02:30,959 --> 00:02:33,440
security way so how you can give this

76
00:02:33,440 --> 00:02:36,160
knowledge you mean knowledgement or this

77
00:02:36,160 --> 00:02:38,720
things to the developer team okay and

78
00:02:38,720 --> 00:02:42,720
i'm a lead of the dcg5511

79
00:02:42,720 --> 00:02:44,640
it's basically a small group a small

80
00:02:44,640 --> 00:02:47,040
community in in brazil in sao paulo as

81
00:02:47,040 --> 00:02:48,720
part of the defcon groups and i'm

82
00:02:48,720 --> 00:02:50,800
instructed writer and reviewer those

83
00:02:50,800 --> 00:02:53,040
three magazines here in europe by the

84
00:02:53,040 --> 00:02:56,239
way i'm brazilian i'm talking um in from

85
00:02:56,239 --> 00:02:58,800
portugal because i'm living here now and

86
00:02:58,800 --> 00:03:00,800
let's talk about our main topic today so

87
00:03:00,800 --> 00:03:02,879
what is exactly thread before to talk

88
00:03:02,879 --> 00:03:04,159
about them

89
00:03:04,159 --> 00:03:05,680
our main topic today it's pretty

90
00:03:05,680 --> 00:03:06,959
important to put all those people on the

91
00:03:06,959 --> 00:03:08,879
same page so it's a simple definition

92
00:03:08,879 --> 00:03:10,400
what is a thread because when you're

93
00:03:10,400 --> 00:03:12,159
looking from there specifically

94
00:03:12,159 --> 00:03:14,080
investigation analysis and stuff like

95
00:03:14,080 --> 00:03:16,560
that we need to understand first what is

96
00:03:16,560 --> 00:03:18,800
exactly a threat because you don't know

97
00:03:18,800 --> 00:03:20,800
if these malicious or not or you you

98
00:03:20,800 --> 00:03:23,040
have a simple you have a specifically

99
00:03:23,040 --> 00:03:25,040
artifact but you need to investigate

100
00:03:25,040 --> 00:03:26,879
more of that so what is a threat

101
00:03:26,879 --> 00:03:28,640
basically according to iso is a

102
00:03:28,640 --> 00:03:31,840
potential cause of the specific incident

103
00:03:31,840 --> 00:03:33,360
may cause arm in the system or

104
00:03:33,360 --> 00:03:36,560
organization but what kind of

105
00:03:36,560 --> 00:03:38,720
a specific incident or cause flip in

106
00:03:38,720 --> 00:03:40,799
this case is a software attack type of

107
00:03:40,799 --> 00:03:43,200
intellectual property identity death

108
00:03:43,200 --> 00:03:45,760
sabotage and information distortion are

109
00:03:45,760 --> 00:03:47,280
example of the information security

110
00:03:47,280 --> 00:03:49,280
thread so if you see here model

111
00:03:49,280 --> 00:03:51,519
many of those things that i'm talking

112
00:03:51,519 --> 00:03:53,680
now is about the software so if you

113
00:03:53,680 --> 00:03:55,200
think about software first you have a

114
00:03:55,200 --> 00:03:59,599
code so basically a thread it means is a

115
00:03:59,599 --> 00:04:02,159
possible or potential in this case a

116
00:04:02,159 --> 00:04:04,480
potential incident but all those things

117
00:04:04,480 --> 00:04:05,840
is related to it specifically in a

118
00:04:05,840 --> 00:04:07,760
software it's it's pretty interesting

119
00:04:07,760 --> 00:04:09,360
and basically this is the definition

120
00:04:09,360 --> 00:04:10,640
from these either it's not a philip

121
00:04:10,640 --> 00:04:12,959
definition but this specifically iso

122
00:04:12,959 --> 00:04:14,560
okay so

123
00:04:14,560 --> 00:04:15,680
first of all when you have a

124
00:04:15,680 --> 00:04:18,079
specifically artifact or a sample you

125
00:04:18,079 --> 00:04:19,918
need to go to this specifically staff

126
00:04:19,918 --> 00:04:21,839
the first step is identification step

127
00:04:21,839 --> 00:04:22,639
because you don't know if it's a

128
00:04:22,639 --> 00:04:24,639
malicious not or not you haven't

129
00:04:24,639 --> 00:04:26,800
specifically um you can have in the

130
00:04:26,800 --> 00:04:28,720
future when you execute these

131
00:04:28,720 --> 00:04:30,639
investigations you can have a mower it's

132
00:04:30,639 --> 00:04:32,560
a acronym of the malicious software or

133
00:04:32,560 --> 00:04:34,320
you can have a maldoc and a malicious

134
00:04:34,320 --> 00:04:36,800
document it's another uh contraction

135
00:04:36,800 --> 00:04:39,360
like this let's say this way okay so you

136
00:04:39,360 --> 00:04:41,440
can investigate that of course you can

137
00:04:41,440 --> 00:04:43,919
use indifference methodology to using

138
00:04:43,919 --> 00:04:45,280
this specific analysis those

139
00:04:45,280 --> 00:04:47,520
methodologies call the analysis static

140
00:04:47,520 --> 00:04:49,040
or statistical analysis and dynamic

141
00:04:49,040 --> 00:04:50,960
analysis basic on those two

142
00:04:50,960 --> 00:04:52,800
methodologies maybe you are thinking

143
00:04:52,800 --> 00:04:54,240
about the reverse engineer if you don't

144
00:04:54,240 --> 00:04:56,479
know basically it's a technique using

145
00:04:56,479 --> 00:04:58,720
in ethan the thought specifically

146
00:04:58,720 --> 00:05:00,960
methodology okay it's more deeply of

147
00:05:00,960 --> 00:05:02,560
course into looking from the assembly

148
00:05:02,560 --> 00:05:04,000
stuff like that and other things like

149
00:05:04,000 --> 00:05:05,120
this

150
00:05:05,120 --> 00:05:07,440
okay so when you perform a specific

151
00:05:07,440 --> 00:05:09,199
analysis my recommendation to you is

152
00:05:09,199 --> 00:05:12,000
always you're writing those things

153
00:05:12,000 --> 00:05:13,360
right why

154
00:05:13,360 --> 00:05:15,600
you you you need to do that because when

155
00:05:15,600 --> 00:05:18,160
you write this in some

156
00:05:18,160 --> 00:05:19,840
thing like this you can learn more about

157
00:05:19,840 --> 00:05:21,280
that and not only that but you can

158
00:05:21,280 --> 00:05:23,039
understand how the attacker is using

159
00:05:23,039 --> 00:05:24,560
different techniques

160
00:05:24,560 --> 00:05:27,759
to bypassing different security sensors

161
00:05:27,759 --> 00:05:30,000
and and other thing that you can use

162
00:05:30,000 --> 00:05:32,639
when you write this those things is to

163
00:05:32,639 --> 00:05:34,639
create a specific report in this report

164
00:05:34,639 --> 00:05:35,919
you can present your manager your

165
00:05:35,919 --> 00:05:37,199
coordinator it's very interesting

166
00:05:37,199 --> 00:05:38,880
because you can improve this you can

167
00:05:38,880 --> 00:05:40,960
improve your defense's mechanism it's

168
00:05:40,960 --> 00:05:42,880
other point important because when you

169
00:05:42,880 --> 00:05:44,639
understand about all those steps

170
00:05:44,639 --> 00:05:47,199
performed by the attacker you can

171
00:05:47,199 --> 00:05:49,199
understand what techniques used by these

172
00:05:49,199 --> 00:05:51,199
attackers and specifically i don't know

173
00:05:51,199 --> 00:05:53,600
fyro abs or

174
00:05:53,600 --> 00:05:56,639
ips or you know um

175
00:05:56,639 --> 00:06:00,160
antivirals or idr or other you know

176
00:06:00,160 --> 00:06:01,199
solution that you have in your

177
00:06:01,199 --> 00:06:03,360
environment you can understand exactly

178
00:06:03,360 --> 00:06:04,560
the technique

179
00:06:04,560 --> 00:06:06,000
using by the attacker and you can

180
00:06:06,000 --> 00:06:07,759
improve your security

181
00:06:07,759 --> 00:06:10,880
defenses mechanism and you can provide

182
00:06:10,880 --> 00:06:12,960
specific information for a cyber threat

183
00:06:12,960 --> 00:06:14,960
intelligence team and if you don't have

184
00:06:14,960 --> 00:06:16,319
this is in your organization you can

185
00:06:16,319 --> 00:06:17,759
create that of course

186
00:06:17,759 --> 00:06:19,600
and you need to

187
00:06:19,600 --> 00:06:22,160
not only understand that but you need to

188
00:06:22,160 --> 00:06:24,000
have this specific straining cyber

189
00:06:24,000 --> 00:06:26,639
resilience because the the threads are

190
00:06:26,639 --> 00:06:29,440
changing all the time so okay so we have

191
00:06:29,440 --> 00:06:32,080
a simple we have a specifically um

192
00:06:32,080 --> 00:06:34,000
artifact that you need to investigate

193
00:06:34,000 --> 00:06:36,880
okay so after that what the steps so if

194
00:06:36,880 --> 00:06:38,560
you see here first identification after

195
00:06:38,560 --> 00:06:39,840
that you can choose what the best

196
00:06:39,840 --> 00:06:41,919
methodology you can apply statistical

197
00:06:41,919 --> 00:06:43,840
analysis or dynamic analysis so what's

198
00:06:43,840 --> 00:06:45,039
that means philip in this case

199
00:06:45,039 --> 00:06:46,639
statistical is basically a simple

200
00:06:46,639 --> 00:06:48,880
definition usually is the first step

201
00:06:48,880 --> 00:06:51,440
using them our studies why because this

202
00:06:51,440 --> 00:06:53,680
process describes this the analysis of

203
00:06:53,680 --> 00:06:56,560
the program code or the structure or to

204
00:06:56,560 --> 00:06:58,080
determine

205
00:06:58,080 --> 00:07:00,639
specific function let's let me explain

206
00:07:00,639 --> 00:07:02,479
more thing about that so if you have any

207
00:07:02,479 --> 00:07:04,800
specifically dll or a specific library

208
00:07:04,800 --> 00:07:07,120
inside of your system operation this

209
00:07:07,120 --> 00:07:09,360
library is responsible for call for call

210
00:07:09,360 --> 00:07:10,080
and

211
00:07:10,080 --> 00:07:11,919
specific are using specifically function

212
00:07:11,919 --> 00:07:15,440
in your system operation or all those

213
00:07:15,440 --> 00:07:17,599
things is necessary to run specifically

214
00:07:17,599 --> 00:07:20,240
binary so when you analyze

215
00:07:20,240 --> 00:07:21,599
more deeply about that you can

216
00:07:21,599 --> 00:07:23,360
understand all those program code you

217
00:07:23,360 --> 00:07:24,960
can structure those information and you

218
00:07:24,960 --> 00:07:26,240
can move

219
00:07:26,240 --> 00:07:29,280
more deeply in this case but the program

220
00:07:29,280 --> 00:07:31,919
itself doesn't run at this time that's

221
00:07:31,919 --> 00:07:34,080
the idea behind of their statistical

222
00:07:34,080 --> 00:07:36,639
analysis so in this case it's make this

223
00:07:36,639 --> 00:07:39,919
process more safe okay on the other hand

224
00:07:39,919 --> 00:07:41,520
you have a dynamic analysis another

225
00:07:41,520 --> 00:07:42,880
different approach a different

226
00:07:42,880 --> 00:07:44,560
methodology than you can apply and this

227
00:07:44,560 --> 00:07:48,080
case is based is based uh solely on

228
00:07:48,080 --> 00:07:50,319
behavior in this case the interaction

229
00:07:50,319 --> 00:07:51,919
that the malware or the simple or

230
00:07:51,919 --> 00:07:55,759
artifact has when is executed in your

231
00:07:55,759 --> 00:07:57,680
environment or in your

232
00:07:57,680 --> 00:07:58,960
you know

233
00:07:58,960 --> 00:08:01,280
lab basically this in this case the

234
00:08:01,280 --> 00:08:03,440
analysis in runtime so if you see some

235
00:08:03,440 --> 00:08:05,199
two different approach in a runtime

236
00:08:05,199 --> 00:08:07,599
analysis another is a no runtime

237
00:08:07,599 --> 00:08:10,000
analysis okay and of course you can

238
00:08:10,000 --> 00:08:12,720
automate at this and this um this

239
00:08:12,720 --> 00:08:14,400
methodology basically you've been using

240
00:08:14,400 --> 00:08:16,639
this and one of this uh concept is

241
00:08:16,639 --> 00:08:18,240
called sandbox when you have a

242
00:08:18,240 --> 00:08:20,000
specifically controlled environment you

243
00:08:20,000 --> 00:08:22,160
can execute your sample inside of this

244
00:08:22,160 --> 00:08:25,039
and you can see those behavior but think

245
00:08:25,039 --> 00:08:26,879
a look at this pay attention on this

246
00:08:26,879 --> 00:08:28,319
when you have an ascent box you have a

247
00:08:28,319 --> 00:08:30,479
virtual machine inside of this virtual

248
00:08:30,479 --> 00:08:32,399
machine you have a different engines you

249
00:08:32,399 --> 00:08:34,240
need to have these engines inside of

250
00:08:34,240 --> 00:08:36,958
your sandbox why because when these

251
00:08:36,958 --> 00:08:39,679
engines will be responsible for give you

252
00:08:39,679 --> 00:08:42,719
the result of this specifically behavior

253
00:08:42,719 --> 00:08:45,279
inside of your environment okay so of

254
00:08:45,279 --> 00:08:47,200
course you have a different sandbox open

255
00:08:47,200 --> 00:08:49,519
source like a coco like

256
00:08:49,519 --> 00:08:52,240
others or you have an another

257
00:08:52,240 --> 00:08:54,640
online cloud sandbox or antivirus is

258
00:08:54,640 --> 00:08:57,040
kind of like a veristo for example or

259
00:08:57,040 --> 00:08:59,519
have the cloud or joy sandbox and and

260
00:08:59,519 --> 00:09:01,519
others to execute your sample inside of

261
00:09:01,519 --> 00:09:03,680
this and understand if this behavior is

262
00:09:03,680 --> 00:09:07,440
malicious or not okay so before to talk

263
00:09:07,440 --> 00:09:08,959
about the physical and enlarged

264
00:09:08,959 --> 00:09:10,720
structure of the pdf i would like to

265
00:09:10,720 --> 00:09:14,560
explain something about um more you know

266
00:09:14,560 --> 00:09:16,640
more idea about the identification step

267
00:09:16,640 --> 00:09:18,320
so how important it is to understand

268
00:09:18,320 --> 00:09:20,000
those things so i have here and

269
00:09:20,000 --> 00:09:22,240
specifically two artifacts here i have a

270
00:09:22,240 --> 00:09:25,120
regex dot python and simple.python two

271
00:09:25,120 --> 00:09:26,560
files that i have here in my virtual

272
00:09:26,560 --> 00:09:29,279
machine okay so first of all let me

273
00:09:29,279 --> 00:09:32,000
check what is exactly this file so if

274
00:09:32,000 --> 00:09:33,920
you see here i have a here in a python

275
00:09:33,920 --> 00:09:36,560
script okay it's a text file but in this

276
00:09:36,560 --> 00:09:39,920
case it's executable so let me read and

277
00:09:39,920 --> 00:09:42,640
more let me execute this no no i will

278
00:09:42,640 --> 00:09:44,000
not execute but i will read this

279
00:09:44,000 --> 00:09:45,839
information in this case as you can see

280
00:09:45,839 --> 00:09:48,000
here the bing python i have this

281
00:09:48,000 --> 00:09:50,399
information here the utf code the

282
00:09:50,399 --> 00:09:52,800
encoding the encoding responsible for

283
00:09:52,800 --> 00:09:55,200
this if you see here removing special

284
00:09:55,200 --> 00:09:57,360
characters for a string by regex it's a

285
00:09:57,360 --> 00:10:00,399
simple python code responsible for

286
00:10:00,399 --> 00:10:03,519
removing removing the stringings for a

287
00:10:03,519 --> 00:10:07,839
specific regex as you can see here okay

288
00:10:07,839 --> 00:10:10,160
and i will send all those information

289
00:10:10,160 --> 00:10:13,040
for a specifically said underscore the

290
00:10:13,040 --> 00:10:15,360
text so i will cut are you as a good

291
00:10:15,360 --> 00:10:18,640
spider i will uh removing special

292
00:10:18,640 --> 00:10:20,800
characteristics and sending for this

293
00:10:20,800 --> 00:10:24,160
specifically file is a python code okay

294
00:10:24,160 --> 00:10:27,120
so if i try see here another

295
00:10:27,120 --> 00:10:30,800
is a pdf sample version

296
00:10:30,800 --> 00:10:31,560
uh

297
00:10:31,560 --> 00:10:35,279
1.7 you can use you can see here and zip

298
00:10:35,279 --> 00:10:37,760
the flat encoded probably i need to it's

299
00:10:37,760 --> 00:10:40,320
a good something to uh the code here

300
00:10:40,320 --> 00:10:42,399
probably but let me

301
00:10:42,399 --> 00:10:44,160
show you something about the how you

302
00:10:44,160 --> 00:10:46,079
need to understand about those

303
00:10:46,079 --> 00:10:48,480
identification steps okay so remember we

304
00:10:48,480 --> 00:10:50,880
have here two different fibers okay

305
00:10:50,880 --> 00:10:52,839
regex.python and

306
00:10:52,839 --> 00:10:54,959
sample.pdf so if there is a good here

307
00:10:54,959 --> 00:10:56,320
pdf id

308
00:10:56,320 --> 00:10:59,040
it's a very interesting tool from dda

309
00:10:59,040 --> 00:11:02,480
steven if you see here a simple uh tools

310
00:11:02,480 --> 00:11:04,240
to

311
00:11:04,240 --> 00:11:06,480
looking from more informations about the

312
00:11:06,480 --> 00:11:09,040
pdf in this case and if you see here i

313
00:11:09,040 --> 00:11:11,600
can see the header informations about

314
00:11:11,600 --> 00:11:13,440
the specific version

315
00:11:13,440 --> 00:11:15,920
the quantity of the objects the

316
00:11:15,920 --> 00:11:18,000
streaming and other things so i will

317
00:11:18,000 --> 00:11:20,640
talk more about those steps in

318
00:11:20,640 --> 00:11:22,880
after okay but

319
00:11:22,880 --> 00:11:25,519
pay attention this here so how

320
00:11:25,519 --> 00:11:27,920
in this case how the file works in this

321
00:11:27,920 --> 00:11:29,920
case because i'm looking here and then

322
00:11:29,920 --> 00:11:31,920
in the identifier this file has a pdf

323
00:11:31,920 --> 00:11:34,800
script but existing one information

324
00:11:34,800 --> 00:11:38,000
pretty important that file

325
00:11:38,000 --> 00:11:39,760
using to collect those information to

326
00:11:39,760 --> 00:11:41,600
identify that so take a look at this

327
00:11:41,600 --> 00:11:43,600
what is first what is a file in this

328
00:11:43,600 --> 00:11:45,519
case is a specifically tool that

329
00:11:45,519 --> 00:11:47,360
determines file type okay you understand

330
00:11:47,360 --> 00:11:50,000
that but what is exactly information

331
00:11:50,000 --> 00:11:52,639
that you can see or you can use it when

332
00:11:52,639 --> 00:11:55,040
you execute the file command here is the

333
00:11:55,040 --> 00:11:57,680
information based on the manual pro you

334
00:11:57,680 --> 00:11:59,519
don't like to read the manual i don't

335
00:11:59,519 --> 00:12:02,480
like to but we need take a look at this

336
00:12:02,480 --> 00:12:03,920
this file

337
00:12:03,920 --> 00:12:06,000
have a magic number stored in a

338
00:12:06,000 --> 00:12:08,720
particular placer near the beginning so

339
00:12:08,720 --> 00:12:10,880
basically file using and specifically

340
00:12:10,880 --> 00:12:12,399
database

341
00:12:12,399 --> 00:12:15,279
to collect those magic numbers here and

342
00:12:15,279 --> 00:12:17,680
based on this magic number that you can

343
00:12:17,680 --> 00:12:20,399
find inside of this database from file

344
00:12:20,399 --> 00:12:21,440
they will

345
00:12:21,440 --> 00:12:23,920
identify what is exactly the file type

346
00:12:23,920 --> 00:12:25,680
let me explain more details about that

347
00:12:25,680 --> 00:12:29,519
so let me using here sudo no no

348
00:12:29,519 --> 00:12:31,440
yeah this is my add or text sorry about

349
00:12:31,440 --> 00:12:34,800
that so if you are frustrated but anyway

350
00:12:34,800 --> 00:12:36,880
so let me go there and i will put in

351
00:12:36,880 --> 00:12:38,880
here i will change something here so let

352
00:12:38,880 --> 00:12:40,720
me put in there we'll take a look this

353
00:12:40,720 --> 00:12:43,200
percent pdf

354
00:12:43,200 --> 00:12:45,360
percent pdf

355
00:12:45,360 --> 00:12:47,320
pdf

356
00:12:47,320 --> 00:12:50,480
1.7 and let me save here take a look

357
00:12:50,480 --> 00:12:52,959
this i save here and now take a look

358
00:12:52,959 --> 00:12:55,279
what happened in my specifically file

359
00:12:55,279 --> 00:13:00,000
wow we have a pdf document version 1.7

360
00:13:00,000 --> 00:13:02,800
you see so if i try to read again take a

361
00:13:02,800 --> 00:13:04,560
look at this i just change one

362
00:13:04,560 --> 00:13:07,680
informations here but in this case

363
00:13:07,680 --> 00:13:09,680
these information is based on this is

364
00:13:09,680 --> 00:13:12,320
the magic number of the pdf file so if

365
00:13:12,320 --> 00:13:15,200
you're using here pdf ide once again and

366
00:13:15,200 --> 00:13:17,360
i put the rig x dot python take a look

367
00:13:17,360 --> 00:13:19,600
this this is the ink station it's not

368
00:13:19,600 --> 00:13:22,560
this tools checks not based on extension

369
00:13:22,560 --> 00:13:25,600
but basin on the magic number if i try

370
00:13:25,600 --> 00:13:27,680
the cutting here take a look at this

371
00:13:27,680 --> 00:13:30,480
this is the identification of the header

372
00:13:30,480 --> 00:13:33,040
and the how many objects this pdf have

373
00:13:33,040 --> 00:13:34,959
in this case zero

374
00:13:34,959 --> 00:13:36,480
don't have any streams and other

375
00:13:36,480 --> 00:13:39,760
information but is a really a pdf

376
00:13:39,760 --> 00:13:40,880
even

377
00:13:40,880 --> 00:13:43,920
the workstation

378
00:13:43,920 --> 00:13:46,720
don't appears disappears as a doc pilot

379
00:13:46,720 --> 00:13:47,600
you see

380
00:13:47,600 --> 00:13:51,600
so but if i return here once again and i

381
00:13:51,600 --> 00:13:52,639
cut

382
00:13:52,639 --> 00:13:54,720
this and save once again take a look

383
00:13:54,720 --> 00:13:56,079
what happened

384
00:13:56,079 --> 00:13:58,079
i o regex and now i have a python once

385
00:13:58,079 --> 00:14:00,480
again but let me move

386
00:14:00,480 --> 00:14:03,199
once again for regex

387
00:14:03,199 --> 00:14:05,680
doc python but i will i changed for a

388
00:14:05,680 --> 00:14:06,880
pdf

389
00:14:06,880 --> 00:14:08,160
so now

390
00:14:08,160 --> 00:14:09,839
take a look what happened i have a two

391
00:14:09,839 --> 00:14:13,519
pdf files file react x dot python

392
00:14:13,519 --> 00:14:15,519
continue be

393
00:14:15,519 --> 00:14:19,120
a if i try using pdf id once again

394
00:14:19,120 --> 00:14:21,279
but now it's a pdf in this case take a

395
00:14:21,279 --> 00:14:25,199
look this is not a pdf document why

396
00:14:25,199 --> 00:14:27,680
because the magic number is

397
00:14:27,680 --> 00:14:30,959
a python script not a pdf you see so

398
00:14:30,959 --> 00:14:32,560
it's very important

399
00:14:32,560 --> 00:14:35,040
you understand how you can or how you

400
00:14:35,040 --> 00:14:37,199
will use your tools in your environment

401
00:14:37,199 --> 00:14:38,800
because based on these tools you can

402
00:14:38,800 --> 00:14:40,320
receive any specific

403
00:14:40,320 --> 00:14:41,440
results

404
00:14:41,440 --> 00:14:43,680
right so when you're using some tools to

405
00:14:43,680 --> 00:14:46,399
help in for example for um

406
00:14:46,399 --> 00:14:48,240
reversing engineers the same case we're

407
00:14:48,240 --> 00:14:50,800
receiving specifically uh response from

408
00:14:50,800 --> 00:14:52,320
these tools when you perform some

409
00:14:52,320 --> 00:14:54,480
comment we receive some results about

410
00:14:54,480 --> 00:14:56,800
that and that's the point here so we

411
00:14:56,800 --> 00:14:59,760
need to understand those bases when you

412
00:14:59,760 --> 00:15:01,199
understand that you can move it for the

413
00:15:01,199 --> 00:15:03,760
next steps okay we're learning here from

414
00:15:03,760 --> 00:15:06,959
the a presentation so uh let's in let's

415
00:15:06,959 --> 00:15:08,639
understand something about the structure

416
00:15:08,639 --> 00:15:10,560
of the pdf so we have our header you

417
00:15:10,560 --> 00:15:12,560
have a body you have a cross reference

418
00:15:12,560 --> 00:15:15,199
table or x table and you have a trailer

419
00:15:15,199 --> 00:15:17,519
responsible for identifying some

420
00:15:17,519 --> 00:15:20,000
information inside of this pdf basically

421
00:15:20,000 --> 00:15:21,360
okay so

422
00:15:21,360 --> 00:15:23,519
if you see here first we have a version

423
00:15:23,519 --> 00:15:25,040
in this case a version inside of the

424
00:15:25,040 --> 00:15:26,440
header remember

425
00:15:26,440 --> 00:15:29,759
1.7 when i execute the tools okay

426
00:15:29,759 --> 00:15:31,920
inside of the board you will have a page

427
00:15:31,920 --> 00:15:34,240
image fonts and stuff like that this is

428
00:15:34,240 --> 00:15:36,959
a shiny thing inside of the pdf and the

429
00:15:36,959 --> 00:15:38,800
important information you can find here

430
00:15:38,800 --> 00:15:41,199
in the x table i mean in the cross

431
00:15:41,199 --> 00:15:43,680
reframes table it's a location of this

432
00:15:43,680 --> 00:15:45,040
object

433
00:15:45,040 --> 00:15:48,560
ethan the file for act for random access

434
00:15:48,560 --> 00:15:50,959
i mean basically you have a specifically

435
00:15:50,959 --> 00:15:52,160
root file

436
00:15:52,160 --> 00:15:54,399
first one you're having specifically two

437
00:15:54,399 --> 00:15:55,440
tiles

438
00:15:55,440 --> 00:15:58,240
the object two and object

439
00:15:58,240 --> 00:15:59,360
three

440
00:15:59,360 --> 00:16:01,519
and you can have another like uh for

441
00:16:01,519 --> 00:16:03,839
example in uh object two can have

442
00:16:03,839 --> 00:16:06,000
another different object like a three

443
00:16:06,000 --> 00:16:08,320
four and five like that three you can

444
00:16:08,320 --> 00:16:10,160
see you have a hood in them in the

445
00:16:10,160 --> 00:16:12,000
middle in the beginning you have an

446
00:16:12,000 --> 00:16:14,240
other extension of all those objects so

447
00:16:14,240 --> 00:16:15,680
because of that it's very important will

448
00:16:15,680 --> 00:16:17,920
you understand those flows inside of the

449
00:16:17,920 --> 00:16:21,120
pdf file okay in the trailer is a part

450
00:16:21,120 --> 00:16:23,839
of this access

451
00:16:23,839 --> 00:16:26,160
of this or the certain object inside of

452
00:16:26,160 --> 00:16:28,880
the party okay all those

453
00:16:28,880 --> 00:16:30,959
if you see here in the pdf structure all

454
00:16:30,959 --> 00:16:32,240
those objects

455
00:16:32,240 --> 00:16:35,440
are connected okay so let me show you

456
00:16:35,440 --> 00:16:37,120
this specific demonstration that i

457
00:16:37,120 --> 00:16:39,040
recorded because we don't have a time to

458
00:16:39,040 --> 00:16:41,120
executing all those steps because of

459
00:16:41,120 --> 00:16:43,199
that i recorded but i will explain more

460
00:16:43,199 --> 00:16:45,360
about that so i receive in a cve

461
00:16:45,360 --> 00:16:47,920
basically a resume okay in a pdf so

462
00:16:47,920 --> 00:16:51,279
first i check if this pdf

463
00:16:51,279 --> 00:16:53,759
was a really a pdf document in this case

464
00:16:53,759 --> 00:16:56,079
it was and of course i

465
00:16:56,079 --> 00:16:57,680
i looking from

466
00:16:57,680 --> 00:16:59,600
more details about the structure to

467
00:16:59,600 --> 00:17:01,519
understand that and if you see here they

468
00:17:01,519 --> 00:17:04,400
have a 15 object as you can see here

469
00:17:04,400 --> 00:17:06,240
right and other information that you can

470
00:17:06,240 --> 00:17:08,160
find here it's about the streaming in

471
00:17:08,160 --> 00:17:10,799
this case they have a two streaming

472
00:17:10,799 --> 00:17:12,559
usually not is

473
00:17:12,559 --> 00:17:14,799
usually when you see this streaming is a

474
00:17:14,799 --> 00:17:16,640
part it's a good opportunity that

475
00:17:16,640 --> 00:17:18,400
attacker is using to put in malicious

476
00:17:18,400 --> 00:17:20,640
things inside of this string

477
00:17:20,640 --> 00:17:22,959
it's of course you can see other parts

478
00:17:22,959 --> 00:17:24,880
of this all the other structure of the

479
00:17:24,880 --> 00:17:26,959
object but the streaming is a very good

480
00:17:26,959 --> 00:17:29,600
part that that thread actors or

481
00:17:29,600 --> 00:17:33,520
attackers whatever name you want

482
00:17:33,520 --> 00:17:35,520
less hacker okay

483
00:17:35,520 --> 00:17:38,559
you can find malicious informations okay

484
00:17:38,559 --> 00:17:41,200
so and other things that you have here

485
00:17:41,200 --> 00:17:44,080
is a job script so we have a five

486
00:17:44,080 --> 00:17:46,320
javascript or or 5v reference of

487
00:17:46,320 --> 00:17:47,760
javascript so maybe

488
00:17:47,760 --> 00:17:49,679
some thing is not

489
00:17:49,679 --> 00:17:51,679
it's not common when you see when you

490
00:17:51,679 --> 00:17:54,720
can when you find this in a pdf okay so

491
00:17:54,720 --> 00:17:56,799
first of all executing pdf parsers

492
00:17:56,799 --> 00:17:58,799
another two another two

493
00:17:58,799 --> 00:18:02,960
from dj steven okay so we can using some

494
00:18:02,960 --> 00:18:03,919
commas

495
00:18:03,919 --> 00:18:06,480
like dash s to search for and

496
00:18:06,480 --> 00:18:09,760
specifically informations or

497
00:18:09,760 --> 00:18:12,640
something like this so first i try just

498
00:18:12,640 --> 00:18:15,679
to confirm where is exactly the place

499
00:18:15,679 --> 00:18:17,440
that you can find the javascript so we

500
00:18:17,440 --> 00:18:19,280
have enough first to reference object

501
00:18:19,280 --> 00:18:22,480
one all the references object seven and

502
00:18:22,480 --> 00:18:25,919
object twelve three reference all a

503
00:18:25,919 --> 00:18:28,960
javascript remember remember that three

504
00:18:28,960 --> 00:18:32,000
reference another is js

505
00:18:32,000 --> 00:18:34,559
the second one so if you see here object

506
00:18:34,559 --> 00:18:39,600
1 and object 12 two others reference so

507
00:18:39,600 --> 00:18:40,720
if you see

508
00:18:40,720 --> 00:18:42,880
make totally sense so first i use

509
00:18:42,880 --> 00:18:45,440
executing pdf id so i perform this

510
00:18:45,440 --> 00:18:47,520
specifically scan to to check these

511
00:18:47,520 --> 00:18:49,679
strings and after that

512
00:18:49,679 --> 00:18:52,000
i execute the pdf part or tools through

513
00:18:52,000 --> 00:18:54,720
looking more deeply about that okay the

514
00:18:54,720 --> 00:18:56,799
second comment that i used

515
00:18:56,799 --> 00:18:58,320
and this

516
00:18:58,320 --> 00:19:01,039
in this specific investigation it was

517
00:19:01,039 --> 00:19:01,919
dash

518
00:19:01,919 --> 00:19:02,720
or

519
00:19:02,720 --> 00:19:06,240
or no dash w in this case if that means

520
00:19:06,240 --> 00:19:09,679
the run output for data and filters

521
00:19:09,679 --> 00:19:12,400
because my idea here is

522
00:19:12,400 --> 00:19:14,160
was

523
00:19:14,160 --> 00:19:18,320
open the run data inside of this

524
00:19:18,320 --> 00:19:20,559
pdf so take a look at this

525
00:19:20,559 --> 00:19:22,960
first we have an object one this is the

526
00:19:22,960 --> 00:19:24,480
first remember

527
00:19:24,480 --> 00:19:27,120
the three okay

528
00:19:27,120 --> 00:19:29,280
and if you see here we have

529
00:19:29,280 --> 00:19:30,880
six reference

530
00:19:30,880 --> 00:19:33,360
two three four five

531
00:19:33,360 --> 00:19:35,600
six and seven

532
00:19:35,600 --> 00:19:39,360
thinking about the three okay and in the

533
00:19:39,360 --> 00:19:42,480
middle we have a specifically object one

534
00:19:42,480 --> 00:19:46,160
and six other informations behind of

535
00:19:46,160 --> 00:19:48,880
this object one remember the child

536
00:19:48,880 --> 00:19:52,160
object okay and we have here some open

537
00:19:52,160 --> 00:19:54,080
actions and javascript so philippe

538
00:19:54,080 --> 00:19:55,840
what's that means in this case open

539
00:19:55,840 --> 00:19:57,840
actions so i will explain more about

540
00:19:57,840 --> 00:20:00,720
that so take a look this behind you see

541
00:20:00,720 --> 00:20:03,840
the open actions in this case the open

542
00:20:03,840 --> 00:20:06,320
jackson is a functions inside of this

543
00:20:06,320 --> 00:20:08,480
pdf what is this open action is

544
00:20:08,480 --> 00:20:09,600
responsible

545
00:20:09,600 --> 00:20:11,600
basically if you're working in our

546
00:20:11,600 --> 00:20:13,919
specifically hdr team

547
00:20:13,919 --> 00:20:17,840
you probably receive resume or cv a lot

548
00:20:17,840 --> 00:20:19,760
if you work in a financial team probably

549
00:20:19,760 --> 00:20:23,200
you receive many voice per day okay so

550
00:20:23,200 --> 00:20:25,919
it's a normal behavior we will open the

551
00:20:25,919 --> 00:20:28,000
pdf because you receive these

552
00:20:28,000 --> 00:20:31,039
informations okay okay so

553
00:20:31,039 --> 00:20:32,799
let's suppose that you are these these

554
00:20:32,799 --> 00:20:35,760
people and you will open this file so

555
00:20:35,760 --> 00:20:37,600
when you open this this is the only

556
00:20:37,600 --> 00:20:38,880
click that you need to execute in this

557
00:20:38,880 --> 00:20:41,039
pdf you receive your resume from the

558
00:20:41,039 --> 00:20:43,520
your candidate email okay

559
00:20:43,520 --> 00:20:46,240
and you receive this you click you will

560
00:20:46,240 --> 00:20:48,799
open this pdf this is the first actions

561
00:20:48,799 --> 00:20:51,760
that you only not only first but the

562
00:20:51,760 --> 00:20:53,679
only action that you need to execute

563
00:20:53,679 --> 00:20:56,480
after these actions will executing and

564
00:20:56,480 --> 00:20:59,360
specifically automatically

565
00:20:59,360 --> 00:21:00,880
open actions

566
00:21:00,880 --> 00:21:03,039
why do why

567
00:21:03,039 --> 00:21:05,840
because in this pdf this pdf has this

568
00:21:05,840 --> 00:21:08,640
function so after the user open the

569
00:21:08,640 --> 00:21:10,159
document

570
00:21:10,159 --> 00:21:13,360
will be executed

571
00:21:13,360 --> 00:21:15,360
something in the background

572
00:21:15,360 --> 00:21:16,559
why

573
00:21:16,559 --> 00:21:18,559
i don't know when you investigate

574
00:21:18,559 --> 00:21:19,919
but

575
00:21:19,919 --> 00:21:22,640
this action is totally linked

576
00:21:22,640 --> 00:21:25,039
with the specifically job script as you

577
00:21:25,039 --> 00:21:26,960
can see here so in the

578
00:21:26,960 --> 00:21:28,799
part of this block

579
00:21:28,799 --> 00:21:32,000
the the of this no block but this this

580
00:21:32,000 --> 00:21:35,120
this is this a part of this document in

581
00:21:35,120 --> 00:21:37,200
this case this open action is totally

582
00:21:37,200 --> 00:21:40,880
linked with the this job script so

583
00:21:40,880 --> 00:21:43,200
what that means in this case when the

584
00:21:43,200 --> 00:21:44,960
the user received the document and

585
00:21:44,960 --> 00:21:46,480
clicking the pdf

586
00:21:46,480 --> 00:21:48,000
javascript will be executed in the

587
00:21:48,000 --> 00:21:49,520
bitmap machine

588
00:21:49,520 --> 00:21:52,159
what is the result

589
00:21:52,159 --> 00:21:54,480
i don't know we don't know so let's move

590
00:21:54,480 --> 00:21:56,480
on and this investigation to understand

591
00:21:56,480 --> 00:21:57,440
that so

592
00:21:57,440 --> 00:22:00,400
when we already understand this process

593
00:22:00,400 --> 00:22:01,919
open action and javascript let's

594
00:22:01,919 --> 00:22:03,760
continue to be

595
00:22:03,760 --> 00:22:06,159
to see here we some information but we

596
00:22:06,159 --> 00:22:08,400
and these tools probably

597
00:22:08,400 --> 00:22:10,400
don't have the mechanism to open these

598
00:22:10,400 --> 00:22:13,280
information objects to nothing three

599
00:22:13,280 --> 00:22:16,080
nothing object four we have another two

600
00:22:16,080 --> 00:22:18,159
reference or two another remember those

601
00:22:18,159 --> 00:22:20,799
three the the the three remember that

602
00:22:20,799 --> 00:22:23,600
object one other reference okay on the

603
00:22:23,600 --> 00:22:26,480
child for per object okay

604
00:22:26,480 --> 00:22:30,559
nice object 7 reference object 10

605
00:22:30,559 --> 00:22:32,320
here some informations about the

606
00:22:32,320 --> 00:22:34,240
javascript some reference

607
00:22:34,240 --> 00:22:35,840
object 80

608
00:22:35,840 --> 00:22:39,280
format images stuff like that not

609
00:22:39,280 --> 00:22:42,960
uh value information here and reference

610
00:22:42,960 --> 00:22:44,799
again one of the

611
00:22:44,799 --> 00:22:48,159
those child's reference itself okay

612
00:22:48,159 --> 00:22:51,200
in object 10 we have another object 12

613
00:22:51,200 --> 00:22:53,440
and maybe you have here the javascript

614
00:22:53,440 --> 00:22:55,679
and take a look at this here in object

615
00:22:55,679 --> 00:22:58,480
one we have the first streaming

616
00:22:58,480 --> 00:23:01,280
in this case as you can see in object 11

617
00:23:01,280 --> 00:23:03,520
we can see the content is streaming and

618
00:23:03,520 --> 00:23:05,919
having a specifically filter in this

619
00:23:05,919 --> 00:23:07,440
case the

620
00:23:07,440 --> 00:23:09,600
the filter all the information inside of

621
00:23:09,600 --> 00:23:13,200
this stream hasn't specifically left in

622
00:23:13,200 --> 00:23:15,760
this case is 36

623
00:23:15,760 --> 00:23:19,280
and they have the flat the code tag i

624
00:23:19,280 --> 00:23:22,159
mean in this case i need to decode this

625
00:23:22,159 --> 00:23:24,480
information inside of this

626
00:23:24,480 --> 00:23:27,039
specifically streaming and other point

627
00:23:27,039 --> 00:23:29,840
his is the left in this case the size is

628
00:23:29,840 --> 00:23:32,159
not too big it's 36 it's it's a small

629
00:23:32,159 --> 00:23:34,640
size okay but maybe you can look in from

630
00:23:34,640 --> 00:23:37,360
the object 11. in object 12 we have

631
00:23:37,360 --> 00:23:40,080
another reference object 13

632
00:23:40,080 --> 00:23:42,320
and maybe let's see here

633
00:23:42,320 --> 00:23:44,400
in object 13 we have the second

634
00:23:44,400 --> 00:23:48,240
streaming remember we have a two

635
00:23:48,240 --> 00:23:50,320
streaming in this case the lat is too

636
00:23:50,320 --> 00:23:53,200
big when you compare with the first okay

637
00:23:53,200 --> 00:23:55,440
so maybe this is

638
00:23:55,440 --> 00:23:58,799
uh should be the the main object to be

639
00:23:58,799 --> 00:24:00,720
to investigate because

640
00:24:00,720 --> 00:24:03,039
the side the left is it's high it's not

641
00:24:03,039 --> 00:24:04,480
high it's big

642
00:24:04,480 --> 00:24:06,480
and you know you have here this

643
00:24:06,480 --> 00:24:08,720
streaming okay if you remember they

644
00:24:08,720 --> 00:24:10,640
probably haven't specifically javascript

645
00:24:10,640 --> 00:24:12,320
here because here is the reference

646
00:24:12,320 --> 00:24:15,600
object 12 remember the the child so

647
00:24:15,600 --> 00:24:18,799
basically object 13 is a child of the

648
00:24:18,799 --> 00:24:20,320
object 12

649
00:24:20,320 --> 00:24:21,120
okay

650
00:24:21,120 --> 00:24:24,480
so let's move on it we had

651
00:24:24,480 --> 00:24:27,039
15 object remember that so here object

652
00:24:27,039 --> 00:24:28,480
uh 12

653
00:24:28,480 --> 00:24:31,039
uh i mean the 14

654
00:24:31,039 --> 00:24:35,200
and another is 15 okay so let's move on

655
00:24:35,200 --> 00:24:37,679
for the another tools

656
00:24:37,679 --> 00:24:40,080
so if i will need if i need to looking

657
00:24:40,080 --> 00:24:42,400
from the

658
00:24:42,400 --> 00:24:44,400
streaming probably i need to using other

659
00:24:44,400 --> 00:24:46,480
tools that i can

660
00:24:46,480 --> 00:24:47,840
extract

661
00:24:47,840 --> 00:24:50,799
the streaming information and

662
00:24:50,799 --> 00:24:52,559
in this case i execute the pdf tech

663
00:24:52,559 --> 00:24:54,799
because when you're using pdf deca you

664
00:24:54,799 --> 00:24:56,159
can

665
00:24:56,159 --> 00:24:57,840
compress those information inside of

666
00:24:57,840 --> 00:24:59,760
this specifically streaming not only

667
00:24:59,760 --> 00:25:02,799
compressed but you can uncompress the

668
00:25:02,799 --> 00:25:04,559
information so that's my idea if i can

669
00:25:04,559 --> 00:25:06,720
compress i i can

670
00:25:06,720 --> 00:25:09,279
uncompress right or recompress you can

671
00:25:09,279 --> 00:25:10,960
execute in different things with using

672
00:25:10,960 --> 00:25:13,679
these tools and or you can merge pdf as

673
00:25:13,679 --> 00:25:16,720
well so in this case is a good pdf deka

674
00:25:16,720 --> 00:25:20,640
i set the document and i request

675
00:25:20,640 --> 00:25:24,640
what i request this

676
00:25:25,120 --> 00:25:28,400
output and this output i request the

677
00:25:28,400 --> 00:25:30,240
uncompressed information as you can see

678
00:25:30,240 --> 00:25:32,400
here right so if you see here i have the

679
00:25:32,400 --> 00:25:34,720
dump so i can investigate more

680
00:25:34,720 --> 00:25:36,799
informations about that so when i try to

681
00:25:36,799 --> 00:25:39,039
looking from the dump informations take

682
00:25:39,039 --> 00:25:41,679
a look what i found in object 13 i have

683
00:25:41,679 --> 00:25:44,640
here the javascript the

684
00:25:44,640 --> 00:25:46,880
route date of the javascript in this

685
00:25:46,880 --> 00:25:48,960
case this javascript

686
00:25:48,960 --> 00:25:51,120
are using a specific technique this

687
00:25:51,120 --> 00:25:52,240
javascript

688
00:25:52,240 --> 00:25:55,360
is of course obfuscated so this is the

689
00:25:55,360 --> 00:25:57,520
first technique used by the attacker so

690
00:25:57,520 --> 00:25:59,919
the next steps i need to deself escape

691
00:25:59,919 --> 00:26:02,240
this javascript so

692
00:26:02,240 --> 00:26:05,279
first of all i copy this code and paste

693
00:26:05,279 --> 00:26:07,679
it here to understand all those

694
00:26:07,679 --> 00:26:09,360
informations and if you see here take a

695
00:26:09,360 --> 00:26:11,760
look at this i have here some evil

696
00:26:11,760 --> 00:26:13,600
parameters

697
00:26:13,600 --> 00:26:16,480
and i thought when i performed this

698
00:26:16,480 --> 00:26:19,760
specific investigation so if i if

699
00:26:19,760 --> 00:26:21,360
i were

700
00:26:21,360 --> 00:26:23,760
if i'm i was looking from the

701
00:26:23,760 --> 00:26:26,640
specifically job script maybe we i can

702
00:26:26,640 --> 00:26:30,799
looking from the html uh file or i can

703
00:26:30,799 --> 00:26:34,000
try to read this in a specifically uh uh

704
00:26:34,000 --> 00:26:36,799
web page that's my thought when i

705
00:26:36,799 --> 00:26:39,840
perform this uh investigation so i using

706
00:26:39,840 --> 00:26:43,120
this specific level parameter to rewrite

707
00:26:43,120 --> 00:26:44,960
this document because of that i put in

708
00:26:44,960 --> 00:26:47,279
this the the this specifically tag of

709
00:26:47,279 --> 00:26:50,000
this parameter actually from html if you

710
00:26:50,000 --> 00:26:52,559
see here then my ideas to using this and

711
00:26:52,559 --> 00:26:54,559
if you see here take a look this

712
00:26:54,559 --> 00:26:57,679
standard behavior if you see here ladder

713
00:26:57,679 --> 00:27:00,400
percent number ladder percentage number

714
00:27:00,400 --> 00:27:01,200
it's

715
00:27:01,200 --> 00:27:03,279
very very interesting behavior

716
00:27:03,279 --> 00:27:05,760
non-behavior but the standard

717
00:27:05,760 --> 00:27:08,000
the pattern actually the pattern of this

718
00:27:08,000 --> 00:27:11,039
information so i rewrited this file i

719
00:27:11,039 --> 00:27:13,760
created a specifier and that i call it

720
00:27:13,760 --> 00:27:14,720
sample

721
00:27:14,720 --> 00:27:16,720
and i give the permission to execute

722
00:27:16,720 --> 00:27:17,679
itself

723
00:27:17,679 --> 00:27:19,039
in

724
00:27:19,039 --> 00:27:21,039
in a specifically browser to open those

725
00:27:21,039 --> 00:27:22,559
information to understand what that

726
00:27:22,559 --> 00:27:24,080
means in this case it is javascript

727
00:27:24,080 --> 00:27:27,279
obfuscated so i described this code and

728
00:27:27,279 --> 00:27:29,279
take a look what i

729
00:27:29,279 --> 00:27:30,240
found

730
00:27:30,240 --> 00:27:34,159
in this case isaac this and wow we have

731
00:27:34,159 --> 00:27:36,720
here and specifically payloads you know

732
00:27:36,720 --> 00:27:38,080
what that means

733
00:27:38,080 --> 00:27:41,760
payload is the package or a code

734
00:27:41,760 --> 00:27:43,279
responsible for download this in the

735
00:27:43,279 --> 00:27:45,520
victory machine in this package this

736
00:27:45,520 --> 00:27:47,679
piece this piece of package is

737
00:27:47,679 --> 00:27:50,960
responsible for performing the callback

738
00:27:50,960 --> 00:27:52,720
of the commanding controller from the

739
00:27:52,720 --> 00:27:55,120
attacker so i found the javascript

740
00:27:55,120 --> 00:27:56,880
obfuscated and after that i found the

741
00:27:56,880 --> 00:27:58,399
payload

742
00:27:58,399 --> 00:28:00,559
so if i found the payload i just i can

743
00:28:00,559 --> 00:28:02,399
move on an investigation more about that

744
00:28:02,399 --> 00:28:04,320
to try to find

745
00:28:04,320 --> 00:28:06,559
the

746
00:28:06,799 --> 00:28:09,039
specifically the cnc from the attacker

747
00:28:09,039 --> 00:28:10,720
so after that is executing some

748
00:28:10,720 --> 00:28:13,440
investigations in unix platform but

749
00:28:13,440 --> 00:28:16,320
if i think flip just using the unix are

750
00:28:16,320 --> 00:28:18,720
using linux as well let me show you here

751
00:28:18,720 --> 00:28:22,159
let's move on yeah i copy here the same

752
00:28:22,159 --> 00:28:24,320
page the same payload as you can see

753
00:28:24,320 --> 00:28:25,120
here

754
00:28:25,120 --> 00:28:28,000
i cop this and i using other platform in

755
00:28:28,000 --> 00:28:29,200
the windows

756
00:28:29,200 --> 00:28:31,279
environment so if you see here are using

757
00:28:31,279 --> 00:28:34,000
mouse zilla to collect this information

758
00:28:34,000 --> 00:28:35,360
so first of all

759
00:28:35,360 --> 00:28:38,000
i pass here as you can see

760
00:28:38,000 --> 00:28:39,760
because in this case the attacker using

761
00:28:39,760 --> 00:28:42,240
another technique basically the

762
00:28:42,240 --> 00:28:44,480
unicodes technique bayesian and in two

763
00:28:44,480 --> 00:28:46,000
different bytes because you can use in

764
00:28:46,000 --> 00:28:48,480
for example an ascii or unicode ask is

765
00:28:48,480 --> 00:28:50,720
based on bytes and unicode is based on

766
00:28:50,720 --> 00:28:51,840
two bytes

767
00:28:51,840 --> 00:28:53,840
and the attacker using this specifically

768
00:28:53,840 --> 00:28:56,000
encoding techniques here but it's kind

769
00:28:56,000 --> 00:28:58,440
of old because the attacker using the

770
00:28:58,440 --> 00:29:01,360
ucs2 as you can see here below

771
00:29:01,360 --> 00:29:03,200
this is an encoding technique so i need

772
00:29:03,200 --> 00:29:06,480
to decode this and convert this in a

773
00:29:06,480 --> 00:29:08,640
decimal file as you can see here you

774
00:29:08,640 --> 00:29:09,760
click here

775
00:29:09,760 --> 00:29:12,640
and after that i have then specifically

776
00:29:12,640 --> 00:29:14,720
exa file

777
00:29:14,720 --> 00:29:16,960
payload okay

778
00:29:16,960 --> 00:29:19,600
after that i generate and specifically

779
00:29:19,600 --> 00:29:22,799
binary why do that philip

780
00:29:22,799 --> 00:29:25,039
because the binary

781
00:29:25,039 --> 00:29:27,440
is responsible for executing in the

782
00:29:27,440 --> 00:29:29,360
windows platform right

783
00:29:29,360 --> 00:29:31,279
so basically this is the format of the

784
00:29:31,279 --> 00:29:34,640
attack okay so i

785
00:29:34,640 --> 00:29:38,399
creating this file cnc doc bin and after

786
00:29:38,399 --> 00:29:42,719
that i use ensure to try

787
00:29:42,960 --> 00:29:45,360
maybe to find to try find some

788
00:29:45,360 --> 00:29:48,080
informations about the attp

789
00:29:48,080 --> 00:29:50,159
inside of this binary and if you see

790
00:29:50,159 --> 00:29:52,080
here using short search other two from

791
00:29:52,080 --> 00:29:54,960
dda stevens and if you see here i found

792
00:29:54,960 --> 00:29:56,559
the cnc

793
00:29:56,559 --> 00:29:58,080
from the attacker this is a commanding

794
00:29:58,080 --> 00:30:01,600
controller too right so i find here this

795
00:30:01,600 --> 00:30:03,440
information so if you see here in the

796
00:30:03,440 --> 00:30:05,919
end where is the place

797
00:30:05,919 --> 00:30:08,159
that the attacker are executing this

798
00:30:08,159 --> 00:30:11,039
specifically uh

799
00:30:11,039 --> 00:30:12,320
attacking

800
00:30:12,320 --> 00:30:15,679
basically is from estonia in europe so

801
00:30:15,679 --> 00:30:19,760
if you see here we have the we found the

802
00:30:19,760 --> 00:30:22,559
cnc so here i finish my presentation so

803
00:30:22,559 --> 00:30:24,240
here's some books

804
00:30:24,240 --> 00:30:25,520
that

805
00:30:25,520 --> 00:30:26,960
this topic is very interesting so you

806
00:30:26,960 --> 00:30:29,120
can investigate you can learn mainly

807
00:30:29,120 --> 00:30:30,960
about that in those

808
00:30:30,960 --> 00:30:32,080
four books

809
00:30:32,080 --> 00:30:33,039
from

810
00:30:33,039 --> 00:30:35,520
pact it's very nice and if you have any

811
00:30:35,520 --> 00:30:36,960
question

812
00:30:36,960 --> 00:30:39,279
guys so please let me know i i it's a

813
00:30:39,279 --> 00:30:40,640
pleasure to be here to talk with you

814
00:30:40,640 --> 00:30:42,000
about this talk

815
00:30:42,000 --> 00:30:44,640
and uh yeah if you have any question

816
00:30:44,640 --> 00:30:47,279
please let me know

