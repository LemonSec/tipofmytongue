1
00:00:00,160 --> 00:00:02,320
morning everybody i am pleased to be

2
00:00:02,320 --> 00:00:04,160
here with you

3
00:00:04,160 --> 00:00:06,399
in order to present my work about how to

4
00:00:06,399 --> 00:00:08,000
bypass

5
00:00:08,000 --> 00:00:09,440
data

6
00:00:09,440 --> 00:00:12,320
exfiltration detection by use of my just

7
00:00:12,320 --> 00:00:14,719
cryptography it is the second part of a

8
00:00:14,719 --> 00:00:17,440
work that i have presented last year in

9
00:00:17,440 --> 00:00:19,680
activity 2021

10
00:00:19,680 --> 00:00:22,560
it is an evolution

11
00:00:22,560 --> 00:00:24,880
and i'm very pleased to be with you

12
00:00:24,880 --> 00:00:26,320
today

13
00:00:26,320 --> 00:00:27,920
so first

14
00:00:27,920 --> 00:00:29,599
i'm very proud to be a speaker at

15
00:00:29,599 --> 00:00:31,279
positive act day

16
00:00:31,279 --> 00:00:33,280
i was not able to come in due time

17
00:00:33,280 --> 00:00:35,280
because i have tomorrow a critical

18
00:00:35,280 --> 00:00:37,760
business meeting and it was not possible

19
00:00:37,760 --> 00:00:40,239
due to the fly schedule to be with you

20
00:00:40,239 --> 00:00:41,600
here

21
00:00:41,600 --> 00:00:43,760
but if you have any question

22
00:00:43,760 --> 00:00:46,079
or any comments i will

23
00:00:46,079 --> 00:00:48,640
i will be free i'll be very happy to to

24
00:00:48,640 --> 00:00:50,879
exchange with you

25
00:00:50,879 --> 00:00:53,280
i wish you

26
00:00:53,280 --> 00:00:57,440
a very nice phd 11 event

27
00:00:57,440 --> 00:01:00,079
so here's the summary of my talk so i

28
00:01:00,079 --> 00:01:02,320
will first introduce the topic then

29
00:01:02,320 --> 00:01:04,080
present a state of the art of the

30
00:01:04,080 --> 00:01:06,080
different existing techniques and to

31
00:01:06,080 --> 00:01:07,680
show their limitation

32
00:01:07,680 --> 00:01:10,400
i will then present a very

33
00:01:10,400 --> 00:01:12,479
useful tool in order to prepare this

34
00:01:12,479 --> 00:01:14,720
kind of tech of attacks which are

35
00:01:14,720 --> 00:01:17,280
non-travel deniable cryptography

36
00:01:17,280 --> 00:01:19,439
and i will then ex

37
00:01:19,439 --> 00:01:22,080
show how to efficiently bypass

38
00:01:22,080 --> 00:01:23,200
um

39
00:01:23,200 --> 00:01:26,400
data excitation detection

40
00:01:26,400 --> 00:01:28,880
by using statistical profile and

41
00:01:28,880 --> 00:01:31,439
mimicking and

42
00:01:31,439 --> 00:01:34,320
even ejecting enquiry channel in place

43
00:01:34,320 --> 00:01:37,840
for example an existing ipsec vpn in in

44
00:01:37,840 --> 00:01:41,280
the target environment

45
00:01:41,280 --> 00:01:43,520
so

46
00:01:44,720 --> 00:01:47,520
nowadays quite all

47
00:01:47,520 --> 00:01:48,640
attacks

48
00:01:48,640 --> 00:01:52,560
especially the sophisticated attacks

49
00:01:52,640 --> 00:01:53,680
aim

50
00:01:53,680 --> 00:01:54,799
at

51
00:01:54,799 --> 00:01:56,560
exfiltrating

52
00:01:56,560 --> 00:01:58,159
data

53
00:01:58,159 --> 00:02:00,960
it can be a few bytes

54
00:02:00,960 --> 00:02:03,840
regarding a few credentials for logging

55
00:02:03,840 --> 00:02:05,040
password

56
00:02:05,040 --> 00:02:06,640
or complete

57
00:02:06,640 --> 00:02:09,598
data databases

58
00:02:09,598 --> 00:02:12,000
uh and generally the exchange of data is

59
00:02:12,000 --> 00:02:14,000
done between the malware and the command

60
00:02:14,000 --> 00:02:17,599
control but it can be an attacker

61
00:02:17,599 --> 00:02:18,959
himself

62
00:02:18,959 --> 00:02:20,640
and depending on the environment you

63
00:02:20,640 --> 00:02:21,920
have different

64
00:02:21,920 --> 00:02:23,200
constraint

65
00:02:23,200 --> 00:02:24,720
it is more or less difficult for the

66
00:02:24,720 --> 00:02:26,080
attacker

67
00:02:26,080 --> 00:02:29,120
if you have unconnected environment

68
00:02:29,120 --> 00:02:32,160
you have to enforce air gap attacks

69
00:02:32,160 --> 00:02:34,400
but you will have a limited amount of

70
00:02:34,400 --> 00:02:35,360
data

71
00:02:35,360 --> 00:02:37,360
to uh that can be

72
00:02:37,360 --> 00:02:40,480
exfiltrated due to a generally low data

73
00:02:40,480 --> 00:02:41,680
rate

74
00:02:41,680 --> 00:02:43,599
but on the contrary the target are

75
00:02:43,599 --> 00:02:46,560
generally a very low security awareness

76
00:02:46,560 --> 00:02:48,800
on the contrary unconnected network

77
00:02:48,800 --> 00:02:52,160
environment whatever may be the protocol

78
00:02:52,160 --> 00:02:54,959
in fact you have to bypass traffic

79
00:02:54,959 --> 00:02:57,040
surveillance

80
00:02:57,040 --> 00:02:59,440
but if you are successful you can create

81
00:02:59,440 --> 00:03:02,560
a higher amount of data with a high

82
00:03:02,560 --> 00:03:05,440
data rate and generally

83
00:03:05,440 --> 00:03:08,640
what i observed in different

84
00:03:08,640 --> 00:03:10,080
network that

85
00:03:10,080 --> 00:03:12,959
the awareness uh con regarding this kind

86
00:03:12,959 --> 00:03:14,800
of excitation

87
00:03:14,800 --> 00:03:18,560
techniques of a rather medium

88
00:03:18,560 --> 00:03:21,440
the defender himself can do either

89
00:03:21,440 --> 00:03:24,799
automated or semi-automatic analysis

90
00:03:24,799 --> 00:03:25,599
or

91
00:03:25,599 --> 00:03:28,640
in in k in very specific cases or in

92
00:03:28,640 --> 00:03:30,480
four and six steps

93
00:03:30,480 --> 00:03:33,599
he can perform manual or adopt analysis

94
00:03:33,599 --> 00:03:36,959
which can include for example malware

95
00:03:36,959 --> 00:03:41,040
reverse analysis reverse engineer

96
00:03:42,239 --> 00:03:45,200
so the context is

97
00:03:45,200 --> 00:03:48,720
to fold either you consider

98
00:03:48,720 --> 00:03:51,360
weekly targety attacks

99
00:03:51,360 --> 00:03:55,360
and in for environments where only very

100
00:03:55,360 --> 00:03:57,840
only dlp software will be in place in

101
00:03:57,840 --> 00:04:02,319
place dlp for data leak prevention

102
00:04:02,879 --> 00:04:05,439
or you want to perform a strongly

103
00:04:05,439 --> 00:04:07,200
targeted attacks

104
00:04:07,200 --> 00:04:10,480
typically apt attack

105
00:04:10,480 --> 00:04:11,519
and

106
00:04:11,519 --> 00:04:12,480
you can

107
00:04:12,480 --> 00:04:15,360
support that manual analysis or even the

108
00:04:15,360 --> 00:04:17,358
traffic of the malware can be

109
00:04:17,358 --> 00:04:18,798
analyzed

110
00:04:18,798 --> 00:04:21,199
we will focus on

111
00:04:21,199 --> 00:04:25,199
connecting environment but you can apply

112
00:04:25,199 --> 00:04:27,199
all the techniques presented in this

113
00:04:27,199 --> 00:04:29,520
talk for air gap environment you just

114
00:04:29,520 --> 00:04:32,880
have to adapt to the protocol and to the

115
00:04:32,880 --> 00:04:34,479
lower data

116
00:04:34,479 --> 00:04:37,120
data rate

117
00:04:38,320 --> 00:04:41,840
once again we want to focus on but on

118
00:04:41,840 --> 00:04:44,160
automated analysis to buy to be bypassed

119
00:04:44,160 --> 00:04:45,600
but you can

120
00:04:45,600 --> 00:04:47,280
you have to keep in mind that the

121
00:04:47,280 --> 00:04:50,080
defender can perform more sophisticated

122
00:04:50,080 --> 00:04:52,719
analysis

123
00:04:53,600 --> 00:04:55,360
because you are you are dealing with

124
00:04:55,360 --> 00:04:57,120
sensitive networks

125
00:04:57,120 --> 00:04:58,320
so

126
00:04:58,320 --> 00:04:59,680
since you are

127
00:04:59,680 --> 00:05:01,919
generally these kind of attacks are

128
00:05:01,919 --> 00:05:04,880
enforced through malware you can support

129
00:05:04,880 --> 00:05:08,080
that the malware will be analyzed

130
00:05:08,080 --> 00:05:11,280
statistically or dynamically

131
00:05:11,280 --> 00:05:14,960
and you have to take this into account

132
00:05:15,919 --> 00:05:18,960
another constraint is to consider the

133
00:05:18,960 --> 00:05:21,600
communication channel in place

134
00:05:21,600 --> 00:05:24,080
we do not create new communications

135
00:05:24,080 --> 00:05:25,600
channels

136
00:05:25,600 --> 00:05:28,479
or cover channels

137
00:05:28,479 --> 00:05:31,280
such as in air gap attack but if you

138
00:05:31,280 --> 00:05:34,320
want more information about this kind of

139
00:05:34,320 --> 00:05:38,320
attacks you can drop me an email

140
00:05:38,320 --> 00:05:40,479
from the attacker's perspective he has

141
00:05:40,479 --> 00:05:41,280
two

142
00:05:41,280 --> 00:05:42,080
uh

143
00:05:42,080 --> 00:05:44,160
critical point to consider first he has

144
00:05:44,160 --> 00:05:46,800
several critical issues

145
00:05:46,800 --> 00:05:49,919
to consider these issues refer relates

146
00:05:49,919 --> 00:05:52,160
to the capability of the defender to

147
00:05:52,160 --> 00:05:55,199
detect something and then trigger elect

148
00:05:55,199 --> 00:05:58,479
and of course to block data acceleration

149
00:05:58,479 --> 00:06:00,080
so you can have

150
00:06:00,080 --> 00:06:02,240
dlp software

151
00:06:02,240 --> 00:06:04,160
but most of the time they're working on

152
00:06:04,160 --> 00:06:05,360
keywords

153
00:06:05,360 --> 00:06:08,080
they don't really implement statistical

154
00:06:08,080 --> 00:06:09,280
profile

155
00:06:09,280 --> 00:06:11,600
it means that

156
00:06:11,600 --> 00:06:14,080
any dlp i have tested have been

157
00:06:14,080 --> 00:06:16,000
successfully bypassed

158
00:06:16,000 --> 00:06:18,880
they are very rather lame

159
00:06:18,880 --> 00:06:21,360
preventing and detecting

160
00:06:21,360 --> 00:06:24,000
sophisticated data

161
00:06:24,000 --> 00:06:26,240
data

162
00:06:26,240 --> 00:06:28,479
of course you can encrypt your data but

163
00:06:28,479 --> 00:06:30,400
you have to constraint first it is

164
00:06:30,400 --> 00:06:32,720
easily detected because the entropy for

165
00:06:32,720 --> 00:06:35,039
file is rather high

166
00:06:35,039 --> 00:06:37,199
it is rarely in place

167
00:06:37,199 --> 00:06:40,560
and if you want however use encryption

168
00:06:40,560 --> 00:06:43,280
you have to manage secret key and the

169
00:06:43,280 --> 00:06:45,600
secret key can be recovered during the

170
00:06:45,600 --> 00:06:48,319
reverse engineering step so you have an

171
00:06:48,319 --> 00:06:51,840
additional very strong constraint

172
00:06:51,840 --> 00:06:53,919
finally

173
00:06:53,919 --> 00:06:56,720
remind that in fact all urban traffics

174
00:06:56,720 --> 00:07:00,400
may be encrypted for typically ipsec dbm

175
00:07:00,400 --> 00:07:03,360
and this encryption is not managed by

176
00:07:03,360 --> 00:07:05,599
the attacker he cannot even access the

177
00:07:05,599 --> 00:07:08,560
keys so he has to deal with

178
00:07:08,560 --> 00:07:11,120
in and exfiltrate

179
00:07:11,120 --> 00:07:12,319
his data

180
00:07:12,319 --> 00:07:15,280
through this channel which means that

181
00:07:15,280 --> 00:07:16,639
if you want

182
00:07:16,639 --> 00:07:20,160
to get the data you will have a serious

183
00:07:20,160 --> 00:07:21,680
issue

184
00:07:21,680 --> 00:07:23,120
and

185
00:07:23,120 --> 00:07:24,720
you have also

186
00:07:24,720 --> 00:07:27,599
prevent the defender to detect that you

187
00:07:27,599 --> 00:07:30,639
are currently exfiltrating data

188
00:07:30,639 --> 00:07:31,440
or

189
00:07:31,440 --> 00:07:34,720
at least but even if it is not wishable

190
00:07:34,720 --> 00:07:38,319
you have to delay his efforts

191
00:07:38,400 --> 00:07:39,360
so

192
00:07:39,360 --> 00:07:41,360
the aim of the present work is not to

193
00:07:41,360 --> 00:07:43,599
perform attack of course but it is to

194
00:07:43,599 --> 00:07:45,440
evaluate

195
00:07:45,440 --> 00:07:48,160
what could be the revolution of

196
00:07:48,160 --> 00:07:49,360
data

197
00:07:49,360 --> 00:07:51,120
leak

198
00:07:51,120 --> 00:07:52,319
and

199
00:07:52,319 --> 00:07:54,560
malware attacker

200
00:07:54,560 --> 00:07:57,520
i have precisely in mind some apt

201
00:07:57,520 --> 00:07:59,599
attacks also

202
00:07:59,599 --> 00:08:02,319
sophisticated raw somewhere and the aim

203
00:08:02,319 --> 00:08:03,919
is to see how

204
00:08:03,919 --> 00:08:06,479
these attacks could evolve in order to

205
00:08:06,479 --> 00:08:07,759
find

206
00:08:07,759 --> 00:08:10,720
before the attacker

207
00:08:10,720 --> 00:08:13,759
mitigation and protection techniques

208
00:08:13,759 --> 00:08:14,800
uh

209
00:08:14,800 --> 00:08:18,479
i i would i have chosen to present each

210
00:08:18,479 --> 00:08:21,360
attack bridge one by one for a sake of

211
00:08:21,360 --> 00:08:23,680
quality but of course you can combine

212
00:08:23,680 --> 00:08:24,720
all of them

213
00:08:24,720 --> 00:08:26,960
and

214
00:08:26,960 --> 00:08:29,919
whenever you combine them in fact

215
00:08:29,919 --> 00:08:32,559
you you obtain very sophisticated and

216
00:08:32,559 --> 00:08:34,000
powerful attacks

217
00:08:34,000 --> 00:08:36,479
the codes are non-public but

218
00:08:36,479 --> 00:08:38,958
since they are developed for industrial

219
00:08:38,958 --> 00:08:42,958
purpose and analysis purposes

220
00:08:44,080 --> 00:08:46,240
so first let us present the state of the

221
00:08:46,240 --> 00:08:48,480
art and the technical background i mean

222
00:08:48,480 --> 00:08:53,480
what are already the already known

223
00:08:55,120 --> 00:08:57,120
original

224
00:08:57,120 --> 00:09:00,240
excitation techniques

225
00:09:00,240 --> 00:09:01,360
in fact

226
00:09:01,360 --> 00:09:04,560
whenever you consider communication

227
00:09:04,560 --> 00:09:06,240
i mean

228
00:09:06,240 --> 00:09:08,160
data acceleration you have to consider

229
00:09:08,160 --> 00:09:10,720
two issues or two aspects

230
00:09:10,720 --> 00:09:13,120
and i will take here the most of

231
00:09:13,120 --> 00:09:16,240
the most used term energy from nato you

232
00:09:16,240 --> 00:09:18,399
have either communication security which

233
00:09:18,399 --> 00:09:20,800
focus on the security of the data

234
00:09:20,800 --> 00:09:24,480
themselves but regardless of the channel

235
00:09:24,480 --> 00:09:26,160
so for that purpose you have

236
00:09:26,160 --> 00:09:28,080
cryptography

237
00:09:28,080 --> 00:09:30,160
electromagnetic security physical

238
00:09:30,160 --> 00:09:32,480
security of the environment

239
00:09:32,480 --> 00:09:33,920
but

240
00:09:33,920 --> 00:09:37,040
a clever attacker who will also wants

241
00:09:37,040 --> 00:09:39,360
not only to protect the data exituated

242
00:09:39,360 --> 00:09:41,360
but also to protect the fact that there

243
00:09:41,360 --> 00:09:44,320
is an affiliation it means that we want

244
00:09:44,320 --> 00:09:45,839
to protect

245
00:09:45,839 --> 00:09:48,240
the existence of a secret communication

246
00:09:48,240 --> 00:09:50,720
and then protect the channel

247
00:09:50,720 --> 00:09:52,800
and in this respect the most

248
00:09:52,800 --> 00:09:54,240
non the most famous technique is

249
00:09:54,240 --> 00:09:57,160
steganography but you also can consider

250
00:09:57,160 --> 00:09:59,600
electromagnetic security traffic flow

251
00:09:59,600 --> 00:10:02,079
security routing protocol and so on

252
00:10:02,079 --> 00:10:04,320
and in this study we have combined both

253
00:10:04,320 --> 00:10:06,720
geos we want to protect the information

254
00:10:06,720 --> 00:10:10,079
but also the channel itself

255
00:10:10,079 --> 00:10:12,959
it means that any defender

256
00:10:12,959 --> 00:10:16,480
cannot see or guess that currently and

257
00:10:16,480 --> 00:10:20,480
that exituation takes right place

258
00:10:20,480 --> 00:10:22,560
so let us compare cryptography versus

259
00:10:22,560 --> 00:10:24,800
staggering on the on the left you have

260
00:10:24,800 --> 00:10:26,880
steganography you have a cryptographic

261
00:10:26,880 --> 00:10:29,519
sorry so you transform any plane takes

262
00:10:29,519 --> 00:10:33,100
data into uh

263
00:10:33,100 --> 00:10:34,399
[Music]

264
00:10:34,399 --> 00:10:36,000
none

265
00:10:36,000 --> 00:10:38,160
non plain text data encrypted data with

266
00:10:38,160 --> 00:10:40,560
a secured key

267
00:10:40,560 --> 00:10:42,000
and the data

268
00:10:42,000 --> 00:10:45,040
once and encrypted looks like random

269
00:10:45,040 --> 00:10:47,040
data

270
00:10:47,040 --> 00:10:50,240
and we suppose in the security analysis

271
00:10:50,240 --> 00:10:52,959
that to recover plaintext data you have

272
00:10:52,959 --> 00:10:54,480
to

273
00:10:54,480 --> 00:10:56,560
recover the key which is supposed to be

274
00:10:56,560 --> 00:10:58,720
intractable and even the algorithm is

275
00:10:58,720 --> 00:11:00,640
supposed to be known

276
00:11:00,640 --> 00:11:04,160
on the right you have steganography

277
00:11:04,160 --> 00:11:06,079
secondography you have here the

278
00:11:06,079 --> 00:11:08,079
complete process so you take data you

279
00:11:08,079 --> 00:11:10,800
encrypt them you take a cover image it

280
00:11:10,800 --> 00:11:13,519
may be an image not geofile or whatever

281
00:11:13,519 --> 00:11:16,480
video file you will embed

282
00:11:16,480 --> 00:11:19,279
in to produce a stego image you send it

283
00:11:19,279 --> 00:11:23,200
to bob and bob will extract and decrypt

284
00:11:23,200 --> 00:11:25,360
in fact if

285
00:11:25,360 --> 00:11:27,200
it is mandatory to have no visual

286
00:11:27,200 --> 00:11:29,279
difference between cover image instagram

287
00:11:29,279 --> 00:11:32,160
image in fact since you embed you modify

288
00:11:32,160 --> 00:11:35,519
some bits or some data

289
00:11:35,519 --> 00:11:36,720
and

290
00:11:36,720 --> 00:11:39,360
all the issue is to modify without too

291
00:11:39,360 --> 00:11:40,240
much

292
00:11:40,240 --> 00:11:41,839
altering

293
00:11:41,839 --> 00:11:45,200
the statistical profile which is rather

294
00:11:45,200 --> 00:11:46,560
complicated

295
00:11:46,560 --> 00:11:48,079
um in

296
00:11:48,079 --> 00:11:50,240
in real cases

297
00:11:50,240 --> 00:11:53,120
let us compare that now the security of

298
00:11:53,120 --> 00:11:55,279
both techniques

299
00:11:55,279 --> 00:11:56,480
uh

300
00:11:56,480 --> 00:11:58,079
whenever you use cryptography you

301
00:11:58,079 --> 00:12:01,440
produce random data so using a entropy

302
00:12:01,440 --> 00:12:04,800
test it is very easy to detect a peak of

303
00:12:04,800 --> 00:12:06,399
entropy

304
00:12:06,399 --> 00:12:08,880
for example plaintext data for most

305
00:12:08,880 --> 00:12:12,399
languages is around four

306
00:12:12,399 --> 00:12:15,040
once you packed or you compress the data

307
00:12:15,040 --> 00:12:18,160
you the the entropy rise to six

308
00:12:18,160 --> 00:12:20,639
and whenever you encrypt the

309
00:12:20,639 --> 00:12:23,120
entropy will be maximal and you will

310
00:12:23,120 --> 00:12:25,760
have an entropy of eight so it means

311
00:12:25,760 --> 00:12:28,639
that a simple entropy profile test you

312
00:12:28,639 --> 00:12:30,560
are able to detect

313
00:12:30,560 --> 00:12:33,519
that the encrypted data are

314
00:12:33,519 --> 00:12:35,600
exfiltrated

315
00:12:35,600 --> 00:12:37,360
on the on

316
00:12:37,360 --> 00:12:41,440
on the right you have a different um

317
00:12:41,440 --> 00:12:44,079
result showing in fact i will summarize

318
00:12:44,079 --> 00:12:44,959
that

319
00:12:44,959 --> 00:12:47,279
you will find of course references in in

320
00:12:47,279 --> 00:12:49,920
the bibliography of the slides but

321
00:12:49,920 --> 00:12:53,040
you can uh stay rv has a very low rate

322
00:12:53,040 --> 00:12:55,040
if you want to

323
00:12:55,040 --> 00:12:58,160
remain undetected it means that

324
00:12:58,160 --> 00:13:01,839
less than three percent of the data can

325
00:13:01,839 --> 00:13:04,959
be used in order to

326
00:13:05,519 --> 00:13:08,639
to embed a secret data

327
00:13:08,639 --> 00:13:12,959
you have a very limited number of

328
00:13:12,959 --> 00:13:14,079
data

329
00:13:14,079 --> 00:13:16,480
that can be hidden if you want to remain

330
00:13:16,480 --> 00:13:19,120
undetected three percent means a few

331
00:13:19,120 --> 00:13:21,440
bites

332
00:13:21,440 --> 00:13:23,120
at best

333
00:13:23,120 --> 00:13:24,639
so it means that

334
00:13:24,639 --> 00:13:27,279
regarding the context we have considered

335
00:13:27,279 --> 00:13:30,399
in fact we cannot use charitography or

336
00:13:30,399 --> 00:13:34,079
stegonography for an efficient data

337
00:13:34,079 --> 00:13:37,920
natalie or data exfiltration

338
00:13:37,920 --> 00:13:39,839
so this is the reason why it is

339
00:13:39,839 --> 00:13:42,240
necessary to consider more sophisticated

340
00:13:42,240 --> 00:13:44,639
techniques and i will consider malicious

341
00:13:44,639 --> 00:13:47,120
cryptography measures mathematics in

342
00:13:47,120 --> 00:13:49,600
fact it is an emerging field that i have

343
00:13:49,600 --> 00:13:52,079
created in 2012

344
00:13:52,079 --> 00:13:54,959
coming from the or

345
00:13:54,959 --> 00:13:57,399
as a the young and young uh

346
00:13:57,399 --> 00:13:59,680
cryptocurrency but it was very limited

347
00:13:59,680 --> 00:14:02,399
because in fact they only consider the

348
00:14:02,399 --> 00:14:05,920
case of extortion malware which consists

349
00:14:05,920 --> 00:14:09,040
which was a prefiguration of ransomware

350
00:14:09,040 --> 00:14:10,560
it is not

351
00:14:10,560 --> 00:14:12,639
that you can do more

352
00:14:12,639 --> 00:14:13,760
in fact

353
00:14:13,760 --> 00:14:15,360
the magicians cryptography resource

354
00:14:15,360 --> 00:14:18,079
mathematics is a interconnection

355
00:14:18,079 --> 00:14:19,920
of

356
00:14:19,920 --> 00:14:22,160
the attack techniques on one side and

357
00:14:22,160 --> 00:14:24,399
the crypto region mathematics on the

358
00:14:24,399 --> 00:14:26,959
other side for their mutual benefit

359
00:14:26,959 --> 00:14:29,360
you can do a lot of things i have just

360
00:14:29,360 --> 00:14:31,120
given a few

361
00:14:31,120 --> 00:14:32,320
examples

362
00:14:32,320 --> 00:14:34,880
from super malware that are able to

363
00:14:34,880 --> 00:14:37,440
propagate optimal optimally

364
00:14:37,440 --> 00:14:39,040
to enforce

365
00:14:39,040 --> 00:14:41,600
sophisticated self-protection techniques

366
00:14:41,600 --> 00:14:43,279
or to

367
00:14:43,279 --> 00:14:46,480
to protect or become invisible

368
00:14:46,480 --> 00:14:49,839
you can also use complexity theory

369
00:14:49,839 --> 00:14:53,360
or computability theory to design really

370
00:14:53,360 --> 00:14:56,639
undetected malware

371
00:14:56,639 --> 00:14:58,079
you can use malware to perform

372
00:14:58,079 --> 00:15:00,320
cryptanalysis operation

373
00:15:00,320 --> 00:15:03,279
you can do recon in target environment

374
00:15:03,279 --> 00:15:05,199
for example we have designed a few years

375
00:15:05,199 --> 00:15:06,639
ago

376
00:15:06,639 --> 00:15:09,600
techniques that enable malware to to

377
00:15:09,600 --> 00:15:12,079
identify the kind of the theory of

378
00:15:12,079 --> 00:15:13,199
processor

379
00:15:13,199 --> 00:15:14,880
and be able to choose whether they

380
00:15:14,880 --> 00:15:17,199
attack or not depending on the brand or

381
00:15:17,199 --> 00:15:20,560
the model of the processor

382
00:15:20,560 --> 00:15:22,399
and finally

383
00:15:22,399 --> 00:15:24,720
malicious mathematics includes also the

384
00:15:24,720 --> 00:15:27,360
design of cryptography trapdoor if you

385
00:15:27,360 --> 00:15:29,600
want to have a clever example

386
00:15:29,600 --> 00:15:31,839
and sophisticated example have a look to

387
00:15:31,839 --> 00:15:34,000
our presentation of black at europe in

388
00:15:34,000 --> 00:15:37,680
2017 we have designed a

389
00:15:37,680 --> 00:15:40,320
block encryption algorithm very similar

390
00:15:40,320 --> 00:15:43,920
to the aos with the same key size and

391
00:15:43,920 --> 00:15:46,959
with a trapdoor that enabled to uh to to

392
00:15:46,959 --> 00:15:51,518
break the cipher in less than 30 seconds

393
00:15:51,759 --> 00:15:52,959
so

394
00:15:52,959 --> 00:15:55,279
let us now consider non-trivial deniable

395
00:15:55,279 --> 00:15:56,800
cryptography

396
00:15:56,800 --> 00:16:00,959
it is very it is important because

397
00:16:00,959 --> 00:16:03,440
most of the attack will be performed

398
00:16:03,440 --> 00:16:05,279
by means of malware

399
00:16:05,279 --> 00:16:07,440
so we have the risk that the malware can

400
00:16:07,440 --> 00:16:10,480
be analyzed and reveal

401
00:16:10,480 --> 00:16:13,519
the secret of the attack

402
00:16:13,519 --> 00:16:17,839
so the enabled cryptography consists in

403
00:16:17,839 --> 00:16:19,440
producing

404
00:16:19,440 --> 00:16:20,560
two

405
00:16:20,560 --> 00:16:22,720
different plane takes from a single

406
00:16:22,720 --> 00:16:25,360
ciphertext with two different keys this

407
00:16:25,360 --> 00:16:27,680
one of the application

408
00:16:27,680 --> 00:16:31,839
but the only known case is travel it by

409
00:16:31,839 --> 00:16:34,160
use of one-time pads it's supposed that

410
00:16:34,160 --> 00:16:35,279
you use

411
00:16:35,279 --> 00:16:37,680
random second as long as the two

412
00:16:37,680 --> 00:16:39,759
different plain text so two different

413
00:16:39,759 --> 00:16:42,240
random sequence and you sort them by

414
00:16:42,240 --> 00:16:44,560
twice it is not possible

415
00:16:44,560 --> 00:16:47,120
since you have to embed the random

416
00:16:47,120 --> 00:16:50,880
sequences into the malware code and of

417
00:16:50,880 --> 00:16:53,279
course there there will be recovered

418
00:16:53,279 --> 00:16:54,959
during the

419
00:16:54,959 --> 00:16:58,000
reverse engineering step

420
00:16:58,000 --> 00:16:59,519
so

421
00:16:59,519 --> 00:17:01,680
we managed to solve this problem by

422
00:17:01,680 --> 00:17:03,440
using

423
00:17:03,440 --> 00:17:06,480
deterministic algorithm with short keys

424
00:17:06,480 --> 00:17:08,400
short means

425
00:17:08,400 --> 00:17:11,280
the same size as usual

426
00:17:11,280 --> 00:17:13,799
encryption algorithm from 1 to

427
00:17:13,799 --> 00:17:17,439
128 to 256 bits

428
00:17:17,439 --> 00:17:20,559
and we do the same it means that

429
00:17:20,559 --> 00:17:23,839
from a given cipher text

430
00:17:23,839 --> 00:17:25,420
and from the same algorithm

431
00:17:25,420 --> 00:17:26,559
[Music]

432
00:17:26,559 --> 00:17:30,000
using two different keys q1 or key2 we

433
00:17:30,000 --> 00:17:33,280
can produce two different plain decks p1

434
00:17:33,280 --> 00:17:35,120
and p2

435
00:17:35,120 --> 00:17:38,000
and this game has been extended to a

436
00:17:38,000 --> 00:17:39,760
three plain text but of course key can

437
00:17:39,760 --> 00:17:40,400
be

438
00:17:40,400 --> 00:17:43,200
extended for a larger number of plain

439
00:17:43,200 --> 00:17:44,880
text

440
00:17:44,880 --> 00:17:48,480
so uh from a cryptographic security

441
00:17:48,480 --> 00:17:51,600
perspective in fact uh we have proven

442
00:17:51,600 --> 00:17:52,400
uh

443
00:17:52,400 --> 00:17:55,120
their security so we cannot guess p1 and

444
00:17:55,120 --> 00:17:58,400
p2 from the cypher text

445
00:17:58,400 --> 00:18:01,200
or even if we know p1 from p2 or

446
00:18:01,200 --> 00:18:03,440
conversely it is not possible to guess

447
00:18:03,440 --> 00:18:05,360
one from the other

448
00:18:05,360 --> 00:18:07,280
the number of applications are quite

449
00:18:07,280 --> 00:18:08,799
awesome

450
00:18:08,799 --> 00:18:11,679
and we are currently developing them

451
00:18:11,679 --> 00:18:12,840
for sec

452
00:18:12,840 --> 00:18:16,559
and it comes from cod protection

453
00:18:16,559 --> 00:18:18,880
anti-forensic techniques and multiple

454
00:18:18,880 --> 00:18:21,520
communications

455
00:18:21,919 --> 00:18:24,640
so let us consider

456
00:18:24,640 --> 00:18:26,840
a short demo

457
00:18:26,840 --> 00:18:28,400
so

458
00:18:28,400 --> 00:18:31,200
we have here

459
00:18:31,760 --> 00:18:33,919
the cipher text here

460
00:18:33,919 --> 00:18:36,000
the execution

461
00:18:36,000 --> 00:18:38,400
the binaries and the two keys

462
00:18:38,400 --> 00:18:40,400
just for

463
00:18:40,400 --> 00:18:41,919
to show

464
00:18:41,919 --> 00:18:44,000
the cipher text

465
00:18:44,000 --> 00:18:47,280
to prove that indeed it is a cipher text

466
00:18:47,280 --> 00:18:49,740
and here the two keys

467
00:18:49,740 --> 00:18:51,280
[Music]

468
00:18:51,280 --> 00:18:55,679
as you can see there are very short keys

469
00:18:55,679 --> 00:18:57,600
so now

470
00:18:57,600 --> 00:18:58,640
let us

471
00:18:58,640 --> 00:19:01,600
decrypt so

472
00:19:06,400 --> 00:19:09,039
okay and we do the same

473
00:19:09,039 --> 00:19:13,120
with the second dish

474
00:19:13,120 --> 00:19:16,160
and what you can see that the two plain

475
00:19:16,160 --> 00:19:19,640
decks are different

476
00:19:20,090 --> 00:19:23,169
[Music]

477
00:19:24,080 --> 00:19:26,640
yeah here's the first plain text and the

478
00:19:26,640 --> 00:19:28,320
the second one they are totally

479
00:19:28,320 --> 00:19:29,520
different

480
00:19:29,520 --> 00:19:32,320
so it means that we can from one cipher

481
00:19:32,320 --> 00:19:33,280
text

482
00:19:33,280 --> 00:19:36,080
using the same small algorithm and

483
00:19:36,080 --> 00:19:38,480
considering two different key we can

484
00:19:38,480 --> 00:19:43,280
produce two different plain text

485
00:19:43,280 --> 00:19:46,080
so let us come back to the to the to the

486
00:19:46,080 --> 00:19:47,200
slides

487
00:19:47,200 --> 00:19:50,000
what are the application in fact in our

488
00:19:50,000 --> 00:19:51,200
context

489
00:19:51,200 --> 00:19:53,760
we have

490
00:19:53,760 --> 00:19:56,160
an environment with a binary code which

491
00:19:56,160 --> 00:19:57,520
is encrypted

492
00:19:57,520 --> 00:20:01,360
and the binary code is able to perform

493
00:20:01,360 --> 00:20:04,000
analysis and to determine very precisely

494
00:20:04,000 --> 00:20:05,919
we have a very complex different

495
00:20:05,919 --> 00:20:07,120
protocol

496
00:20:07,120 --> 00:20:09,679
uh they are able to determine whether

497
00:20:09,679 --> 00:20:12,080
they are currently analyzed for anybody

498
00:20:12,080 --> 00:20:13,760
in virtual machine

499
00:20:13,760 --> 00:20:17,679
in dbi sandbox and so on or if they are

500
00:20:17,679 --> 00:20:20,320
in a real environment may discern one be

501
00:20:20,320 --> 00:20:22,960
physical or virtual

502
00:20:22,960 --> 00:20:24,159
so

503
00:20:24,159 --> 00:20:26,480
the malware is communicating with a

504
00:20:26,480 --> 00:20:27,440
common

505
00:20:27,440 --> 00:20:30,480
common control or with the attacker and

506
00:20:30,480 --> 00:20:33,039
if the the malware say okay i am

507
00:20:33,039 --> 00:20:34,799
currently analyzed

508
00:20:34,799 --> 00:20:36,720
the one key

509
00:20:36,720 --> 00:20:39,679
is sent and the malware is decrypting

510
00:20:39,679 --> 00:20:42,080
itself

511
00:20:42,080 --> 00:20:45,520
as a plaintext which is either

512
00:20:45,520 --> 00:20:47,679
an interesting looking malware

513
00:20:47,679 --> 00:20:49,760
or

514
00:20:49,760 --> 00:20:52,799
plaintext data but on the contrary you

515
00:20:52,799 --> 00:20:55,039
will receive a key that will produce the

516
00:20:55,039 --> 00:20:57,440
rail malware so it means that

517
00:20:57,440 --> 00:20:58,559
since

518
00:20:58,559 --> 00:21:01,200
the analyst cannot

519
00:21:01,200 --> 00:21:03,840
determine

520
00:21:04,640 --> 00:21:06,080
you cannot block

521
00:21:06,080 --> 00:21:06,960
the

522
00:21:06,960 --> 00:21:10,480
the identification of a current analysis

523
00:21:10,480 --> 00:21:11,760
it will be

524
00:21:11,760 --> 00:21:14,080
you will never have access to the real

525
00:21:14,080 --> 00:21:16,799
malware

526
00:21:16,799 --> 00:21:19,280
so you have here the the the verbal

527
00:21:19,280 --> 00:21:21,760
description and what

528
00:21:21,760 --> 00:21:23,440
we have to stress on

529
00:21:23,440 --> 00:21:26,000
the fact that of course we have to to

530
00:21:26,000 --> 00:21:28,000
embed and to consider secure and complex

531
00:21:28,000 --> 00:21:29,840
communication protocol between the

532
00:21:29,840 --> 00:21:32,400
malware and the cnc we have used

533
00:21:32,400 --> 00:21:34,720
fingerprint time index obfuscation

534
00:21:34,720 --> 00:21:37,600
random connection environment condition

535
00:21:37,600 --> 00:21:40,159
and it means that

536
00:21:40,159 --> 00:21:41,919
it is impossible

537
00:21:41,919 --> 00:21:45,039
to simulate this communication protocol

538
00:21:45,039 --> 00:21:48,159
and of course everything has been

539
00:21:48,159 --> 00:21:49,679
implemented in such a way that the

540
00:21:49,679 --> 00:21:52,400
malware itself is clueless

541
00:21:52,400 --> 00:21:54,480
with respect to some of the most

542
00:21:54,480 --> 00:21:57,679
important protocol parameters

543
00:21:57,679 --> 00:22:01,600
so now that we have a

544
00:22:01,600 --> 00:22:04,000
malware which is able to enforce this

545
00:22:04,000 --> 00:22:06,159
attack without being detected and

546
00:22:06,159 --> 00:22:07,120
analyzed

547
00:22:07,120 --> 00:22:08,880
let us see how to

548
00:22:08,880 --> 00:22:12,559
enforce our techniques

549
00:22:12,559 --> 00:22:15,360
so the very first case we have plenty of

550
00:22:15,360 --> 00:22:17,919
examples and we we did a lot of

551
00:22:17,919 --> 00:22:18,770
experiment

552
00:22:18,770 --> 00:22:20,240
[Music]

553
00:22:20,240 --> 00:22:23,200
we first consider metadata

554
00:22:23,200 --> 00:22:24,000
and

555
00:22:24,000 --> 00:22:26,880
it is very interesting because most dlps

556
00:22:26,880 --> 00:22:29,120
do not check metadata

557
00:22:29,120 --> 00:22:30,799
and so

558
00:22:30,799 --> 00:22:32,960
they don't even consider for example

559
00:22:32,960 --> 00:22:34,400
some format

560
00:22:34,400 --> 00:22:36,960
languages or internals

561
00:22:36,960 --> 00:22:38,960
so you can do a lot of things by

562
00:22:38,960 --> 00:22:41,679
considering these internals or these

563
00:22:41,679 --> 00:22:44,880
formats and metadata

564
00:22:45,280 --> 00:22:46,940
it means that documents

565
00:22:46,940 --> 00:22:48,960
[Music]

566
00:22:48,960 --> 00:22:52,320
excel pdf and so on there are very

567
00:22:52,320 --> 00:22:53,760
interesting

568
00:22:53,760 --> 00:22:56,320
to be considered a natural carrier for

569
00:22:56,320 --> 00:22:58,960
data exfiltration of course you can even

570
00:22:58,960 --> 00:23:00,400
be more clever

571
00:23:00,400 --> 00:23:02,320
by splitting your acceleration through

572
00:23:02,320 --> 00:23:04,720
different

573
00:23:05,200 --> 00:23:08,200
documents

574
00:23:09,840 --> 00:23:12,080
here a very simple

575
00:23:12,080 --> 00:23:13,200
case

576
00:23:13,200 --> 00:23:15,120
i have taken one

577
00:23:15,120 --> 00:23:17,919
pdf file like a new paper on the

578
00:23:17,919 --> 00:23:19,200
internet

579
00:23:19,200 --> 00:23:23,840
and i have eden here a secret

580
00:23:23,840 --> 00:23:26,720
secret uh

581
00:23:27,520 --> 00:23:30,159
message which is uh however in plain

582
00:23:30,159 --> 00:23:32,000
text and you

583
00:23:32,000 --> 00:23:34,400
and you can open the pdf there is no

584
00:23:34,400 --> 00:23:35,660
alert

585
00:23:35,660 --> 00:23:37,200
[Music]

586
00:23:37,200 --> 00:23:39,679
of course here i have i have let the

587
00:23:39,679 --> 00:23:42,000
data in in plain text

588
00:23:42,000 --> 00:23:43,600
in order

589
00:23:43,600 --> 00:23:46,240
for visibility purposes may

590
00:23:46,240 --> 00:23:48,840
we can apply with what

591
00:23:48,840 --> 00:23:51,918
is and next

592
00:23:54,640 --> 00:23:57,200
of course if you suppose that there are

593
00:23:57,200 --> 00:24:00,159
some document integrity in place so you

594
00:24:00,159 --> 00:24:02,480
can create these those documents from

595
00:24:02,480 --> 00:24:05,440
scratch it means that you will bypass

596
00:24:05,440 --> 00:24:08,880
the integrated checking

597
00:24:09,520 --> 00:24:11,760
so the next step

598
00:24:11,760 --> 00:24:14,559
is not to consider plain text

599
00:24:14,559 --> 00:24:16,880
as in the previous example

600
00:24:16,880 --> 00:24:20,159
but to you to mimic entropy and

601
00:24:20,159 --> 00:24:22,960
statistical profile

602
00:24:22,960 --> 00:24:24,320
why because

603
00:24:24,320 --> 00:24:26,720
generally dlps

604
00:24:26,720 --> 00:24:28,080
could

605
00:24:28,080 --> 00:24:30,159
most of them do not

606
00:24:30,159 --> 00:24:32,320
could enforce very sophisticated

607
00:24:32,320 --> 00:24:36,080
statistical entropy analysis

608
00:24:36,159 --> 00:24:39,200
so you must mimic

609
00:24:39,200 --> 00:24:42,400
for your a exfiltrated data

610
00:24:42,400 --> 00:24:44,960
you must mimic what

611
00:24:44,960 --> 00:24:45,600
a a

612
00:24:45,600 --> 00:24:49,279
on looking document would

613
00:24:49,279 --> 00:24:51,760
look like

614
00:24:52,400 --> 00:24:55,440
so you can as a general approach you

615
00:24:55,440 --> 00:24:57,200
have a key dependent transformation of

616
00:24:57,200 --> 00:24:59,200
the data

617
00:24:59,200 --> 00:25:02,480
you must prevent any manual analysis in

618
00:25:02,480 --> 00:25:04,320
order to recover the secret keys of

619
00:25:04,320 --> 00:25:05,360
course

620
00:25:05,360 --> 00:25:07,360
and you can be able to mimic and

621
00:25:07,360 --> 00:25:09,840
simulate any target statistical

622
00:25:09,840 --> 00:25:12,480
environment

623
00:25:12,960 --> 00:25:15,440
in the rest of the talk we will focus on

624
00:25:15,440 --> 00:25:17,360
the most simple distribution you can

625
00:25:17,360 --> 00:25:20,320
consider ngram provides but we have

626
00:25:20,320 --> 00:25:22,400
currently worked on more sophisticated

627
00:25:22,400 --> 00:25:24,880
profiles

628
00:25:24,880 --> 00:25:26,159
so

629
00:25:26,159 --> 00:25:28,559
for the security management in fact if

630
00:25:28,559 --> 00:25:31,360
you use a key dependent transformation

631
00:25:31,360 --> 00:25:34,240
for example encryption or a statistical

632
00:25:34,240 --> 00:25:36,480
profile mimiking

633
00:25:36,480 --> 00:25:38,960
uh you have to protect the key just

634
00:25:38,960 --> 00:25:41,360
suppose once again that the malware will

635
00:25:41,360 --> 00:25:42,880
be analyzed

636
00:25:42,880 --> 00:25:45,120
so the solution we have developed to use

637
00:25:45,120 --> 00:25:46,799
random keys

638
00:25:46,799 --> 00:25:50,000
generated from the environment

639
00:25:50,000 --> 00:25:52,880
and in this case

640
00:25:52,880 --> 00:25:55,840
we consider foreign key size of 40 bits

641
00:25:55,840 --> 00:25:57,600
which is

642
00:25:57,600 --> 00:25:59,840
large enough in order to prevent exosit

643
00:25:59,840 --> 00:26:02,880
search for the attacker and for every

644
00:26:02,880 --> 00:26:03,840
file

645
00:26:03,840 --> 00:26:07,120
used in order to accelerate data

646
00:26:07,120 --> 00:26:08,960
of course it is possible to use

647
00:26:08,960 --> 00:26:11,279
encryption algorithm with backdoor

648
00:26:11,279 --> 00:26:12,159
and

649
00:26:12,159 --> 00:26:14,240
it is very convenient because in this

650
00:26:14,240 --> 00:26:15,279
case you can

651
00:26:15,279 --> 00:26:18,640
use longer key size

652
00:26:19,279 --> 00:26:20,400
so

653
00:26:20,400 --> 00:26:22,400
since it is rather

654
00:26:22,400 --> 00:26:25,120
complicated mathematics uh let us sketch

655
00:26:25,120 --> 00:26:26,960
the general approach

656
00:26:26,960 --> 00:26:29,679
you have data to accelerate which have a

657
00:26:29,679 --> 00:26:31,200
given

658
00:26:31,200 --> 00:26:32,720
data

659
00:26:32,720 --> 00:26:34,159
profile

660
00:26:34,159 --> 00:26:39,440
in fact for example pdf or and so on and

661
00:26:39,440 --> 00:26:41,600
you want to

662
00:26:41,600 --> 00:26:44,799
execute data by mimicking some

663
00:26:44,799 --> 00:26:47,600
target data profile for example text

664
00:26:47,600 --> 00:26:51,600
file you want to insert a pdf

665
00:26:51,600 --> 00:26:52,960
under the form of

666
00:26:52,960 --> 00:26:54,640
text file

667
00:26:54,640 --> 00:26:56,320
for that you have to consider an

668
00:26:56,320 --> 00:26:58,720
intermediate profile and the combination

669
00:26:58,720 --> 00:27:00,720
of the two

670
00:27:00,720 --> 00:27:03,600
statistical profile will enable to

671
00:27:03,600 --> 00:27:06,000
create document following the target

672
00:27:06,000 --> 00:27:08,000
data profile

673
00:27:08,000 --> 00:27:10,000
so in fact from a multi-magical point of

674
00:27:10,000 --> 00:27:12,080
view you have to consider what we call

675
00:27:12,080 --> 00:27:14,960
the joint enterprise profile

676
00:27:14,960 --> 00:27:16,720
in order to combine them into the

677
00:27:16,720 --> 00:27:19,360
resulting and target data profile

678
00:27:19,360 --> 00:27:22,480
so any book of information theory

679
00:27:22,480 --> 00:27:24,320
will give you the basics the

680
00:27:24,320 --> 00:27:26,640
introduction about what joint interview

681
00:27:26,640 --> 00:27:28,960
fry is

682
00:27:28,960 --> 00:27:30,240
so

683
00:27:30,240 --> 00:27:34,000
let us consider examples

684
00:27:34,000 --> 00:27:37,039
it is very lame but it is for you uh

685
00:27:37,039 --> 00:27:39,440
just to understand easily

686
00:27:39,440 --> 00:27:42,159
just imagine i want to

687
00:27:42,159 --> 00:27:45,279
embed this secret message of course

688
00:27:45,279 --> 00:27:46,159
we

689
00:27:46,159 --> 00:27:47,440
would first

690
00:27:47,440 --> 00:27:49,120
encrypt it but it is just for the

691
00:27:49,120 --> 00:27:51,760
purpose of illustration

692
00:27:51,760 --> 00:27:54,159
there is a transformation

693
00:27:54,159 --> 00:27:56,399
towards different text distribution git

694
00:27:56,399 --> 00:27:58,559
sorry and second order markov

695
00:27:58,559 --> 00:28:00,880
distribution you will have this text of

696
00:28:00,880 --> 00:28:04,159
course if you read it you you you guess

697
00:28:04,159 --> 00:28:05,840
that something

698
00:28:05,840 --> 00:28:07,440
is odd

699
00:28:07,440 --> 00:28:09,279
but if you

700
00:28:09,279 --> 00:28:12,720
consider a first mark or the mark of

701
00:28:12,720 --> 00:28:14,159
word distribution

702
00:28:14,159 --> 00:28:17,200
you now obtain something that

703
00:28:17,200 --> 00:28:18,320
it is

704
00:28:18,320 --> 00:28:21,279
closer far closer from the english

705
00:28:21,279 --> 00:28:23,039
so these two

706
00:28:23,039 --> 00:28:24,080
these two

707
00:28:24,080 --> 00:28:26,720
very simple examples show

708
00:28:26,720 --> 00:28:28,840
very simply how we can

709
00:28:28,840 --> 00:28:30,960
proceed but

710
00:28:30,960 --> 00:28:34,000
recently we have achieved a

711
00:28:34,000 --> 00:28:36,480
embedding rate of nearly 30 percent

712
00:28:36,480 --> 00:28:39,120
which is far higher than if

713
00:28:39,120 --> 00:28:41,200
any undetectable

714
00:28:41,200 --> 00:28:43,760
steganography

715
00:28:43,760 --> 00:28:46,159
techniques

716
00:28:46,159 --> 00:28:49,200
and as that without detection it means

717
00:28:49,200 --> 00:28:52,960
that it's very very efficient

718
00:28:52,960 --> 00:28:53,679
so

719
00:28:53,679 --> 00:28:55,840
we can have a different

720
00:28:55,840 --> 00:28:57,679
evolution

721
00:28:57,679 --> 00:28:59,840
and with more complex modelling

722
00:28:59,840 --> 00:29:01,039
distribution

723
00:29:01,039 --> 00:29:03,039
we have managed so they are far more

724
00:29:03,039 --> 00:29:05,440
complex to to explain

725
00:29:05,440 --> 00:29:09,440
but we succeed in defeating even manual

726
00:29:09,440 --> 00:29:11,840
analysis it means that even if the

727
00:29:11,840 --> 00:29:14,480
analysis takes time to read every

728
00:29:14,480 --> 00:29:16,399
document

729
00:29:16,399 --> 00:29:18,399
you will not be able to

730
00:29:18,399 --> 00:29:21,200
guess that one document more than

731
00:29:21,200 --> 00:29:22,480
one other

732
00:29:22,480 --> 00:29:24,399
is containing something

733
00:29:24,399 --> 00:29:27,200
special

734
00:29:27,200 --> 00:29:30,720
so if you want a example

735
00:29:30,720 --> 00:29:33,679
i will send you a sample

736
00:29:33,679 --> 00:29:35,360
so

737
00:29:35,360 --> 00:29:37,360
there are a lot of possibilities and you

738
00:29:37,360 --> 00:29:41,279
have here what can be done very simply

739
00:29:41,279 --> 00:29:44,159
and at the present time it is impossible

740
00:29:44,159 --> 00:29:45,600
to prevent this

741
00:29:45,600 --> 00:29:49,279
and as far as you implement the consider

742
00:29:49,279 --> 00:29:53,039
these techniques and no dlp tool is able

743
00:29:53,039 --> 00:29:55,279
to detect this nowadays and

744
00:29:55,279 --> 00:29:56,320
it is

745
00:29:56,320 --> 00:29:57,760
i don't think they

746
00:29:57,760 --> 00:30:01,600
they will they will ever do

747
00:30:02,399 --> 00:30:06,000
so now let us deal with the last last

748
00:30:06,000 --> 00:30:07,120
case

749
00:30:07,120 --> 00:30:09,760
when we have a hijacked encrypted

750
00:30:09,760 --> 00:30:11,520
channel in place

751
00:30:11,520 --> 00:30:12,480
so

752
00:30:12,480 --> 00:30:14,080
most of the time

753
00:30:14,080 --> 00:30:15,600
for example in

754
00:30:15,600 --> 00:30:19,279
insensitive military network uh you have

755
00:30:19,279 --> 00:30:22,559
the attacker the malware has to

756
00:30:22,559 --> 00:30:23,760
us to

757
00:30:23,760 --> 00:30:26,960
cop with an existing ip6 vpn

758
00:30:26,960 --> 00:30:30,080
generally it means i will

759
00:30:30,080 --> 00:30:32,799
think to former non-attacks

760
00:30:32,799 --> 00:30:35,600
like in iran in fact we supported the

761
00:30:35,600 --> 00:30:38,159
malware is uh put into the target

762
00:30:38,159 --> 00:30:42,320
environment with the usb stick but now

763
00:30:42,320 --> 00:30:44,240
he has to

764
00:30:44,240 --> 00:30:46,320
took up with the ipsec channel for the

765
00:30:46,320 --> 00:30:49,279
data translation between two sensitive

766
00:30:49,279 --> 00:30:50,720
entities

767
00:30:50,720 --> 00:30:54,880
so we are going to use cover channels

768
00:30:54,880 --> 00:30:56,960
and

769
00:30:56,960 --> 00:30:59,919
this technique is very

770
00:31:00,080 --> 00:31:02,320
is very efficient even on very complex

771
00:31:02,320 --> 00:31:03,440
traffic

772
00:31:03,440 --> 00:31:06,720
the first development was made in 2008

773
00:31:06,720 --> 00:31:10,720
and has been updated last year

774
00:31:10,720 --> 00:31:12,559
and the first version has been presented

775
00:31:12,559 --> 00:31:13,760
i can say

776
00:31:13,760 --> 00:31:17,240
west 2011.

777
00:31:17,519 --> 00:31:20,960
so we are considering the um

778
00:31:20,960 --> 00:31:21,760
the

779
00:31:21,760 --> 00:31:25,679
esp in transport and tunnel but so

780
00:31:25,679 --> 00:31:27,840
the slide just to recall what was

781
00:31:27,840 --> 00:31:30,080
talking about but

782
00:31:30,080 --> 00:31:32,559
i suppose that you are very familiar

783
00:31:32,559 --> 00:31:35,120
with this so in fact in this part it is

784
00:31:35,120 --> 00:31:36,640
encrypted

785
00:31:36,640 --> 00:31:39,120
so even if you transmit something from

786
00:31:39,120 --> 00:31:41,600
the attackers perspective where

787
00:31:41,600 --> 00:31:42,960
we try to

788
00:31:42,960 --> 00:31:45,519
weigh or tap the channel it you will

789
00:31:45,519 --> 00:31:48,240
have encrypted data

790
00:31:48,240 --> 00:31:50,399
so here you have

791
00:31:50,399 --> 00:31:54,320
we consider ec in icmp being packets

792
00:31:54,320 --> 00:31:55,120
so

793
00:31:55,120 --> 00:31:57,120
but you can of course consider similar

794
00:31:57,120 --> 00:31:58,480
other

795
00:31:58,480 --> 00:32:01,039
data

796
00:32:01,039 --> 00:32:03,120
but this method is simple and

797
00:32:03,120 --> 00:32:05,679
illustrative in enough and it works it

798
00:32:05,679 --> 00:32:07,600
still works

799
00:32:07,600 --> 00:32:08,399
so

800
00:32:08,399 --> 00:32:10,399
the general attack scheme

801
00:32:10,399 --> 00:32:12,880
you have the two entities

802
00:32:12,880 --> 00:32:14,880
exchanging data

803
00:32:14,880 --> 00:32:17,679
with an i uh encrypted

804
00:32:17,679 --> 00:32:20,559
tunnel channel ipsec

805
00:32:20,559 --> 00:32:23,200
and the attacker can only wiretap

806
00:32:23,200 --> 00:32:25,440
observe the channel but he cannot

807
00:32:25,440 --> 00:32:28,240
decrypt the data since he has not the

808
00:32:28,240 --> 00:32:30,559
key

809
00:32:30,559 --> 00:32:32,480
so

810
00:32:32,480 --> 00:32:35,279
we are going to use a pink legs method

811
00:32:35,279 --> 00:32:38,960
and an optimized one

812
00:32:39,039 --> 00:32:41,440
in fact first we have established build

813
00:32:41,440 --> 00:32:43,519
a one-to-one correspondent between data

814
00:32:43,519 --> 00:32:46,799
character to evade and icmp packet size

815
00:32:46,799 --> 00:32:48,720
because most of the protocols do not

816
00:32:48,720 --> 00:32:51,519
practice padding it means that

817
00:32:51,519 --> 00:32:55,039
the the packet size is something

818
00:32:55,039 --> 00:32:58,799
which is a very

819
00:32:58,880 --> 00:33:01,679
that can vary

820
00:33:01,919 --> 00:33:02,880
so

821
00:33:02,880 --> 00:33:08,000
the aim is to do like morse code to code

822
00:33:08,320 --> 00:33:10,880
data to evade

823
00:33:10,880 --> 00:33:14,720
data to evade in order to

824
00:33:16,480 --> 00:33:21,559
to use the different size of the packet

825
00:33:27,679 --> 00:33:30,679
so

826
00:33:46,320 --> 00:33:50,158
so sorry for inter interruption but

827
00:33:50,320 --> 00:33:53,440
there are some meteorological issues

828
00:33:53,440 --> 00:33:55,360
so

829
00:33:55,360 --> 00:33:57,200
in fact

830
00:33:57,200 --> 00:33:59,679
each character we want to exfiltrate

831
00:33:59,679 --> 00:34:01,360
is

832
00:34:01,360 --> 00:34:03,279
encoded

833
00:34:03,279 --> 00:34:04,159
by

834
00:34:04,159 --> 00:34:07,440
a packet size in order to

835
00:34:07,440 --> 00:34:10,960
extract to be able to extract in fact uh

836
00:34:10,960 --> 00:34:14,960
we use five revision code in our case

837
00:34:14,960 --> 00:34:18,159
so we repeat every character

838
00:34:18,159 --> 00:34:22,480
key time in our case key or five

839
00:34:23,839 --> 00:34:25,760
of course you can play on the parameter

840
00:34:25,760 --> 00:34:28,000
key

841
00:34:28,000 --> 00:34:30,879
we use dedicated traffic types like

842
00:34:30,879 --> 00:34:33,280
begin on top stack and

843
00:34:33,280 --> 00:34:34,960
we have uh

844
00:34:34,960 --> 00:34:36,879
implemented other

845
00:34:36,879 --> 00:34:38,800
implement

846
00:34:38,800 --> 00:34:41,150
optimization in order to

847
00:34:41,150 --> 00:34:42,320
[Music]

848
00:34:42,320 --> 00:34:45,520
to be to increase

849
00:34:45,520 --> 00:34:48,560
the capability of decoding

850
00:34:48,560 --> 00:34:49,520
so

851
00:34:49,520 --> 00:34:52,399
here it is a simple version for example

852
00:34:52,399 --> 00:34:53,199
a

853
00:34:53,199 --> 00:34:54,679
packet size of

854
00:34:54,679 --> 00:34:57,200
232 bits will return

855
00:34:57,200 --> 00:35:00,560
this character and so on

856
00:35:01,440 --> 00:35:03,280
this new

857
00:35:03,280 --> 00:35:05,599
equivalence has been built in last year

858
00:35:05,599 --> 00:35:08,640
in order to adapt to

859
00:35:08,640 --> 00:35:12,000
some ip secretaries

860
00:35:12,000 --> 00:35:14,839
compared to the 2008

861
00:35:14,839 --> 00:35:18,480
version so on the attacker

862
00:35:18,480 --> 00:35:20,880
we passively observe the packet flow

863
00:35:20,880 --> 00:35:23,840
we extra extract suitable packet size

864
00:35:23,840 --> 00:35:26,160
[Music]

865
00:35:26,160 --> 00:35:29,680
and we use a maximum likelihood decoding

866
00:35:29,680 --> 00:35:31,920
due to the five revolution

867
00:35:31,920 --> 00:35:33,040
code

868
00:35:33,040 --> 00:35:34,880
and of course with the code once we have

869
00:35:34,880 --> 00:35:37,119
this

870
00:35:37,200 --> 00:35:38,079
the

871
00:35:38,079 --> 00:35:42,079
the interest of five regulation code

872
00:35:42,440 --> 00:35:46,000
is that they are very powerful in most

873
00:35:46,000 --> 00:35:47,280
cases

874
00:35:47,280 --> 00:35:49,920
uh of course they are rather resistant

875
00:35:49,920 --> 00:35:52,160
up to a certain limit to noise because

876
00:35:52,160 --> 00:35:54,400
your transmission can have noise and you

877
00:35:54,400 --> 00:35:56,800
have the normal transmission of data

878
00:35:56,800 --> 00:35:59,760
but you can use some optimization in

879
00:35:59,760 --> 00:36:02,880
order to increase your decoding uh

880
00:36:02,880 --> 00:36:05,440
efficiency

881
00:36:05,440 --> 00:36:08,240
just imagine that we want to code the

882
00:36:08,240 --> 00:36:10,720
sentence have you come on savage how do

883
00:36:10,720 --> 00:36:13,200
you how are you today

884
00:36:13,200 --> 00:36:15,440
and

885
00:36:15,440 --> 00:36:18,400
we are going to exp to show different

886
00:36:18,400 --> 00:36:19,599
results

887
00:36:19,599 --> 00:36:21,680
depending on the traffic load

888
00:36:21,680 --> 00:36:24,320
with respect to the time

889
00:36:24,320 --> 00:36:27,920
in fact here you have no residual error

890
00:36:27,920 --> 00:36:30,640
and to extract the data

891
00:36:30,640 --> 00:36:33,440
you need to transmit to transmit the

892
00:36:33,440 --> 00:36:34,640
uh

893
00:36:34,640 --> 00:36:37,200
it takes 145

894
00:36:37,200 --> 00:36:39,440
seconds

895
00:36:39,440 --> 00:36:41,440
normally it should be

896
00:36:41,440 --> 00:36:44,960
detected by good ideas

897
00:36:45,839 --> 00:36:47,920
here we have a

898
00:36:47,920 --> 00:36:50,480
random load of one kilo

899
00:36:50,480 --> 00:36:52,400
bit per second

900
00:36:52,400 --> 00:36:54,480
and

901
00:36:54,480 --> 00:36:56,240
and

902
00:36:56,240 --> 00:36:58,400
the total transition type is a bit

903
00:36:58,400 --> 00:36:59,440
higher

904
00:36:59,440 --> 00:37:02,079
but in this case we have tested it it is

905
00:37:02,079 --> 00:37:06,000
no longer detected by ids

906
00:37:06,560 --> 00:37:10,480
another case with random bursts

907
00:37:11,680 --> 00:37:14,000
we have still a fewer but it is possible

908
00:37:14,000 --> 00:37:14,720
to

909
00:37:14,720 --> 00:37:17,040
to cope with the final message

910
00:37:17,040 --> 00:37:20,720
and with random burst

911
00:37:20,720 --> 00:37:24,240
so in any cases we were able to recover

912
00:37:24,240 --> 00:37:25,280
the

913
00:37:25,280 --> 00:37:26,800
the

914
00:37:26,800 --> 00:37:28,640
to recover the

915
00:37:28,640 --> 00:37:31,520
the sentences and

916
00:37:31,520 --> 00:37:34,240
with manual verification to access to

917
00:37:34,240 --> 00:37:37,200
the message

918
00:37:37,200 --> 00:37:38,079
so

919
00:37:38,079 --> 00:37:39,040
there are

920
00:37:39,040 --> 00:37:40,800
possibly

921
00:37:40,800 --> 00:37:42,880
other optimization

922
00:37:42,880 --> 00:37:44,720
but once again if you

923
00:37:44,720 --> 00:37:47,440
it would need more mats but you can use

924
00:37:47,440 --> 00:37:49,520
more sophisticated data synchronization

925
00:37:49,520 --> 00:37:52,079
or tagging techniques

926
00:37:52,079 --> 00:37:53,839
here for example you have another

927
00:37:53,839 --> 00:37:56,480
version from the

928
00:37:56,480 --> 00:37:58,960
better and one-to-one character size

929
00:37:58,960 --> 00:38:00,320
mapping

930
00:38:00,320 --> 00:38:02,400
and so on

931
00:38:02,400 --> 00:38:04,880
so if you have uh if you are interested

932
00:38:04,880 --> 00:38:07,359
in the mathematical description and the

933
00:38:07,359 --> 00:38:09,359
proof of efficient encoding you have

934
00:38:09,359 --> 00:38:11,680
everything here

935
00:38:11,680 --> 00:38:13,920
you have different other

936
00:38:13,920 --> 00:38:16,720
evolution i will let you read this

937
00:38:16,720 --> 00:38:18,720
and just to conclude

938
00:38:18,720 --> 00:38:20,960
in order to keep time

939
00:38:20,960 --> 00:38:23,280
so if you want to exercise data without

940
00:38:23,280 --> 00:38:26,720
detection ids dlp flow analysis is still

941
00:38:26,720 --> 00:38:27,599
easy

942
00:38:27,599 --> 00:38:29,040
but you have to consider very

943
00:38:29,040 --> 00:38:31,200
sophisticated

944
00:38:31,200 --> 00:38:32,720
techniques

945
00:38:32,720 --> 00:38:34,880
in order to

946
00:38:34,880 --> 00:38:37,200
remain undetected

947
00:38:37,200 --> 00:38:39,040
i would like to stress on the huge

948
00:38:39,040 --> 00:38:40,960
potential of malicious mathematics

949
00:38:40,960 --> 00:38:42,320
cryptography

950
00:38:42,320 --> 00:38:44,000
and i'm

951
00:38:44,000 --> 00:38:46,240
very concerned about

952
00:38:46,240 --> 00:38:49,760
the evolution of numerous technology

953
00:38:49,760 --> 00:38:53,200
if it's not the case but i'm convinced

954
00:38:53,200 --> 00:38:54,640
that we

955
00:38:54,640 --> 00:38:58,078
we will have to face

956
00:38:58,480 --> 00:39:01,040
attacks we were quite impossible to

957
00:39:01,040 --> 00:39:04,480
detect provided that the attacker

958
00:39:04,480 --> 00:39:06,960
is mastering these malicious and

959
00:39:06,960 --> 00:39:10,240
mathematics and cryptographic techniques

960
00:39:10,240 --> 00:39:11,520
it means that

961
00:39:11,520 --> 00:39:12,880
many things

962
00:39:12,880 --> 00:39:15,520
are no longer at the security i mean but

963
00:39:15,520 --> 00:39:18,720
detection techniques but uh at the

964
00:39:18,720 --> 00:39:21,839
security architecture data assessment

965
00:39:21,839 --> 00:39:25,040
tightride management it means the

966
00:39:25,040 --> 00:39:28,320
computer security at the environment

967
00:39:28,320 --> 00:39:30,560
level

968
00:39:30,560 --> 00:39:33,440
there is a solution but which is

969
00:39:33,440 --> 00:39:36,560
very time consuming it would consist in

970
00:39:36,560 --> 00:39:37,920
systematically recording and

971
00:39:37,920 --> 00:39:41,599
transcending all album data

972
00:39:41,599 --> 00:39:43,599
so thank you for attention once again i

973
00:39:43,599 --> 00:39:46,000
was i was very sorry not um

974
00:39:46,000 --> 00:39:47,599
to be here with you

975
00:39:47,599 --> 00:39:50,400
and if you have questions and answer

976
00:39:50,400 --> 00:39:52,800
please send me three may i will very

977
00:39:52,800 --> 00:39:56,000
happy to uh actually with you and to

978
00:39:56,000 --> 00:39:58,640
give you answers and references i have

979
00:39:58,640 --> 00:40:02,400
very nice phd 11 event

980
00:40:02,400 --> 00:40:04,880
and thanks to the organization organizer

981
00:40:04,880 --> 00:40:10,000
for having my selecting my paper bye

