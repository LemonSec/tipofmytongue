1
00:00:03,819 --> 00:00:08,210
all right next up we have a really cool

2
00:00:06,020 --> 00:00:10,520
talk on lost and found certificates by

3
00:00:08,210 --> 00:00:16,730
Ian Foster and Dylan Eric please give

4
00:00:10,520 --> 00:00:18,860
them a warm welcome thank you very much

5
00:00:16,730 --> 00:00:23,060
I'm Ian I helped run to work on so

6
00:00:18,860 --> 00:00:30,500
hopefully all enjoying it a bit and this

7
00:00:23,060 --> 00:00:34,400
is my co-presenter Dylan so this is Ian

8
00:00:30,500 --> 00:00:36,769
he made a seraph he's a DNS researcher

9
00:00:34,400 --> 00:00:40,670
and you can check out more of his stuff

10
00:00:36,770 --> 00:00:41,899
from the URLs there and I'm Dylan I

11
00:00:40,670 --> 00:00:46,550
wrote truffle hog and some other stuff

12
00:00:41,899 --> 00:00:47,570
and you can check out my github so

13
00:00:46,550 --> 00:00:50,839
basically the problem that we're talking

14
00:00:47,570 --> 00:00:54,309
about today is what happens when an SSL

15
00:00:50,840 --> 00:00:57,350
certificate exceeds the lifespan of a

16
00:00:54,309 --> 00:00:58,879
domains ownership so basically you you

17
00:00:57,350 --> 00:01:02,270
buy a domain you get a valid SSL

18
00:00:58,880 --> 00:01:04,250
certificate and then the domain expires

19
00:01:02,270 --> 00:01:09,259
or transfers ownership the original

20
00:01:04,250 --> 00:01:12,439
certificate is still valid and so this

21
00:01:09,259 --> 00:01:15,289
this phenomenon can last for years in

22
00:01:12,439 --> 00:01:18,798
certain cases if you get a say 3-year

23
00:01:15,289 --> 00:01:20,779
SSL certificate and prior to 2013 there

24
00:01:18,799 --> 00:01:22,880
was absolutely no way to get any kind of

25
00:01:20,779 --> 00:01:25,219
visibility into this issue or tell that

26
00:01:22,880 --> 00:01:28,789
any previous owner of the domain may

27
00:01:25,219 --> 00:01:30,259
still have a valid Assessor this example

28
00:01:28,789 --> 00:01:31,759
that we've demonstrated the bottom here

29
00:01:30,259 --> 00:01:33,979
um Alice can rush your domain name for

30
00:01:31,759 --> 00:01:35,209
food on for one year and get a three

31
00:01:33,979 --> 00:01:36,829
hour sell certificate for that domain

32
00:01:35,209 --> 00:01:38,420
name at the time of registration then

33
00:01:36,829 --> 00:01:40,609
the domain name can become unregistered

34
00:01:38,420 --> 00:01:42,109
say Alice doesn't renew it and later bog

35
00:01:40,609 --> 00:01:42,770
committed sure it and goes own SSL

36
00:01:42,109 --> 00:01:45,499
certificate

37
00:01:42,770 --> 00:01:46,969
all while Alice's three wrestles SSL

38
00:01:45,499 --> 00:01:52,009
certificate is still valid completely

39
00:01:46,969 --> 00:01:53,389
unaware about where to Bob and so one

40
00:01:52,009 --> 00:01:56,389
type of certificate round parentsí which

41
00:01:53,389 --> 00:01:57,770
is a public inaudible log of all trusted

42
00:01:56,389 --> 00:01:59,598
certificates by certificate authorities

43
00:01:57,770 --> 00:02:01,700
is designed to catch misbehaving

44
00:01:59,599 --> 00:02:02,749
certificate authorities and currently is

45
00:02:01,700 --> 00:02:03,979
about half-million certificates and

46
00:02:02,749 --> 00:02:06,109
growing and right here we have a

47
00:02:03,979 --> 00:02:08,929
screenshot of a certificate transparency

48
00:02:06,109 --> 00:02:10,250
search tool CRT de Sh I'm showing an

49
00:02:08,929 --> 00:02:12,280
example of searching for certificates

50
00:02:10,250 --> 00:02:15,080
for google.com saying that you can see

51
00:02:12,280 --> 00:02:16,000
their blog to date the date how long

52
00:02:15,080 --> 00:02:19,090
they're good for and some other

53
00:02:16,000 --> 00:02:21,220
click I can view more information so

54
00:02:19,090 --> 00:02:22,750
basically we can use this to get some

55
00:02:21,220 --> 00:02:25,390
visibility into this problem which we

56
00:02:22,750 --> 00:02:28,270
didn't have before these certificates

57
00:02:25,390 --> 00:02:31,390
from previous owners will often get

58
00:02:28,270 --> 00:02:33,190
logged and certificate transparency and

59
00:02:31,390 --> 00:02:35,410
we can use that to tell if a previous

60
00:02:33,190 --> 00:02:37,120
owner still has a valid SSL certificate

61
00:02:35,410 --> 00:02:39,459
it's not perfect and a lot of the old

62
00:02:37,120 --> 00:02:41,500
certificates take years to show up and

63
00:02:39,459 --> 00:02:43,060
sometimes they never show up but it's

64
00:02:41,500 --> 00:02:45,610
way more visibility than we had before

65
00:02:43,060 --> 00:02:46,930
and new certificates that are minted are

66
00:02:45,610 --> 00:02:51,640
actually required to show up in

67
00:02:46,930 --> 00:02:53,470
certificate transparency logs so using

68
00:02:51,640 --> 00:02:56,950
this method we looked for notable

69
00:02:53,470 --> 00:02:59,590
examples of this problem and we were

70
00:02:56,950 --> 00:03:02,049
able to find some one that's pretty

71
00:02:59,590 --> 00:03:03,760
notable is stripe comm stripe is

72
00:03:02,050 --> 00:03:08,440
basically an online payment processor

73
00:03:03,760 --> 00:03:09,940
that they basically conduct credit card

74
00:03:08,440 --> 00:03:12,700
transactions for a lot of different

75
00:03:09,940 --> 00:03:14,170
ecommerce websites if you've bought

76
00:03:12,700 --> 00:03:17,440
stuff online you probably at some point

77
00:03:14,170 --> 00:03:19,119
I've interacted with stripe and what we

78
00:03:17,440 --> 00:03:21,340
found is when they bought stripe calm

79
00:03:19,120 --> 00:03:23,769
the previous owner of stripe com still

80
00:03:21,340 --> 00:03:27,070
had about SSL certificate the

81
00:03:23,769 --> 00:03:28,989
certificate has since expired but for a

82
00:03:27,070 --> 00:03:29,829
little while there was some overlap and

83
00:03:28,989 --> 00:03:34,090
we thought it was worth mentioning

84
00:03:29,830 --> 00:03:36,700
because it's pretty notable and so next

85
00:03:34,090 --> 00:03:37,900
we said how big is this issue so we

86
00:03:36,700 --> 00:03:39,100
searched their transparency for

87
00:03:37,900 --> 00:03:41,769
certificates that overlap multiple

88
00:03:39,100 --> 00:03:43,510
domain registrations and so what we end

89
00:03:41,769 --> 00:03:44,799
up doing is look at about 3 million to 3

90
00:03:43,510 --> 00:03:46,328
million randomly selected domain names

91
00:03:44,799 --> 00:03:48,519
and their associated 7.7 million

92
00:03:46,329 --> 00:03:50,230
certificates which is about just 1% of

93
00:03:48,519 --> 00:03:51,880
the Internet and to figure out domain

94
00:03:50,230 --> 00:03:53,560
name changes we ownership changes we

95
00:03:51,880 --> 00:03:55,930
looked at expiration dates the email

96
00:03:53,560 --> 00:03:57,340
contacts and who is the registrar name

97
00:03:55,930 --> 00:03:59,230
servers and some other information and

98
00:03:57,340 --> 00:04:00,670
for this we use their certificate

99
00:03:59,230 --> 00:04:02,619
transparency logs historical who is

100
00:04:00,670 --> 00:04:04,780
historical name servers and archive data

101
00:04:02,620 --> 00:04:06,010
loggers wayback machine this analysis

102
00:04:04,780 --> 00:04:07,900
was not perfect there were some false

103
00:04:06,010 --> 00:04:09,609
positives and false negatives but it

104
00:04:07,900 --> 00:04:11,200
should be low enough amount to where

105
00:04:09,610 --> 00:04:13,870
assume is an idea the picture of how big

106
00:04:11,200 --> 00:04:15,399
this issue is and we found that about

107
00:04:13,870 --> 00:04:17,560
1.5 million domain names on the internet

108
00:04:15,400 --> 00:04:20,769
or just less than half of the internet

109
00:04:17,560 --> 00:04:22,890
have a certificate for a pre-existing

110
00:04:20,769 --> 00:04:24,970
domain name so means that the

111
00:04:22,890 --> 00:04:26,260
certificates that are made before the

112
00:04:24,970 --> 00:04:28,060
domain name was registered to enter

113
00:04:26,260 --> 00:04:29,889
valid into its registration time and

114
00:04:28,060 --> 00:04:31,539
about 25% of these are too

115
00:04:29,889 --> 00:04:33,219
it's have not expired yet I mean they

116
00:04:31,539 --> 00:04:35,080
are still valid yeah these owners of

117
00:04:33,219 --> 00:04:37,539
these certificates can actively are now

118
00:04:35,080 --> 00:04:40,150
man SL man the middle the other to the

119
00:04:37,539 --> 00:04:43,870
current domain name users and we are

120
00:04:40,150 --> 00:04:45,370
calling this new phenomenon bygone SSL

121
00:04:43,870 --> 00:04:47,289
which is an SSO search we are defining

122
00:04:45,370 --> 00:04:49,509
as an SSL certificate does create before

123
00:04:47,289 --> 00:04:53,800
and supersedes its domain names current

124
00:04:49,509 --> 00:04:55,719
registration date so if we try to figure

125
00:04:53,800 --> 00:04:57,249
out how could this be any worse so as

126
00:04:55,719 --> 00:04:58,659
may be you probably know certificate

127
00:04:57,249 --> 00:05:00,430
scam May domain names which are called

128
00:04:58,659 --> 00:05:02,319
alt names and this means that

129
00:05:00,430 --> 00:05:03,849
certificates can contain some bygone

130
00:05:02,319 --> 00:05:05,680
domain names and some that are not so in

131
00:05:03,849 --> 00:05:08,800
this example here we have a certificate

132
00:05:05,680 --> 00:05:10,509
for foo.com bar com Baram is only ever

133
00:05:08,800 --> 00:05:11,979
had one owner bar food calm was what

134
00:05:10,509 --> 00:05:13,689
we're calling a bygone domain naming is

135
00:05:11,979 --> 00:05:16,590
change owners and the certificate is

136
00:05:13,689 --> 00:05:19,120
valid for both of these domain names so

137
00:05:16,590 --> 00:05:22,388
again we look for notable examples of

138
00:05:19,120 --> 00:05:24,099
this and we're choosing to sort of blur

139
00:05:22,389 --> 00:05:25,779
out most of this and not say which CDN

140
00:05:24,099 --> 00:05:28,419
because this is still an active issue

141
00:05:25,779 --> 00:05:31,120
but for one of the CD ends we looked at

142
00:05:28,419 --> 00:05:33,310
they actually had 700 customers put on

143
00:05:31,120 --> 00:05:35,710
the same certificate and it's common for

144
00:05:33,310 --> 00:05:37,629
CD ends to share certificates among

145
00:05:35,710 --> 00:05:39,310
customers but this one was notable

146
00:05:37,629 --> 00:05:41,740
because they put 700 on the same cert

147
00:05:39,310 --> 00:05:43,089
and they weren't paying any attention to

148
00:05:41,740 --> 00:05:45,009
whether or not domains transferred

149
00:05:43,089 --> 00:05:46,839
ownership so the one highlighted here

150
00:05:45,009 --> 00:05:50,589
actually was available for purchase it

151
00:05:46,839 --> 00:05:51,759
had expired and we could have you know

152
00:05:50,589 --> 00:05:55,389
easily bought it and then it would

153
00:05:51,759 --> 00:05:58,060
become a bygone SSL certificate

154
00:05:55,389 --> 00:06:00,129
so basically we're left with two choices

155
00:05:58,060 --> 00:06:01,509
here like should we have the right to

156
00:06:00,129 --> 00:06:05,529
revoke these certificates as the new

157
00:06:01,509 --> 00:06:07,210
domain owner if we say no you can

158
00:06:05,529 --> 00:06:08,889
imagine a scenario where a new company

159
00:06:07,210 --> 00:06:10,508
or startup shells out a whole bunch of

160
00:06:08,889 --> 00:06:11,860
money for like the perfect domain just

161
00:06:10,509 --> 00:06:13,360
for them

162
00:06:11,860 --> 00:06:15,460
and then they check the certificate

163
00:06:13,360 --> 00:06:16,839
transparency logs find out that the

164
00:06:15,460 --> 00:06:18,669
previous owner still has a valid cert

165
00:06:16,839 --> 00:06:21,460
and they have to live with it there's

166
00:06:18,669 --> 00:06:23,109
nothing they can do it might be a three

167
00:06:21,460 --> 00:06:24,909
year cert and they might have to just

168
00:06:23,110 --> 00:06:26,169
for the next three years live with the

169
00:06:24,909 --> 00:06:28,120
fact that the previous owner still has a

170
00:06:26,169 --> 00:06:30,219
valid certificate can imagine scenarios

171
00:06:28,120 --> 00:06:31,810
where bad guys may go out and purchase a

172
00:06:30,219 --> 00:06:34,479
whole bunch of desirable domains maybe

173
00:06:31,810 --> 00:06:36,490
single word domains and they could just

174
00:06:34,479 --> 00:06:40,360
squat on them and only selectively hand

175
00:06:36,490 --> 00:06:42,759
them out to e-commerce websites and they

176
00:06:40,360 --> 00:06:43,790
can set all that up so that they can get

177
00:06:42,759 --> 00:06:47,630
valid certificates

178
00:06:43,790 --> 00:06:48,680
and commit financial crimes and if and

179
00:06:47,630 --> 00:06:51,920
if we say that they don't have the right

180
00:06:48,680 --> 00:06:52,880
to revoke these certs then we just have

181
00:06:51,920 --> 00:06:53,900
to live with that reality and there's

182
00:06:52,880 --> 00:06:56,630
nothing we can do about it

183
00:06:53,900 --> 00:06:58,270
if we say yes and we grant new owners

184
00:06:56,630 --> 00:07:01,400
the right to revoke these certificates

185
00:06:58,270 --> 00:07:02,810
because certificates share multiple

186
00:07:01,400 --> 00:07:04,880
domains and because you can have a

187
00:07:02,810 --> 00:07:06,830
certificate like in the case of the CDN

188
00:07:04,880 --> 00:07:10,550
where you have many customers with

189
00:07:06,830 --> 00:07:13,700
legitimate demands and one one domain

190
00:07:10,550 --> 00:07:15,920
that's become bygone this would

191
00:07:13,700 --> 00:07:17,840
basically give strangers on the Internet

192
00:07:15,920 --> 00:07:20,390
the power to revoke these certificates

193
00:07:17,840 --> 00:07:22,340
and break the production websites of the

194
00:07:20,390 --> 00:07:25,190
other 700 customers on the cert in that

195
00:07:22,340 --> 00:07:26,960
case or in the case of a company maybe

196
00:07:25,190 --> 00:07:29,719
the company just gets a certificate puts

197
00:07:26,960 --> 00:07:31,909
five of their own domains on it and then

198
00:07:29,720 --> 00:07:35,210
one of those domains they no longer want

199
00:07:31,910 --> 00:07:37,310
to use it expires but the other domains

200
00:07:35,210 --> 00:07:38,419
are still actively using the cert this

201
00:07:37,310 --> 00:07:41,110
would give a stranger on the internet

202
00:07:38,420 --> 00:07:45,740
the power to take down all the other

203
00:07:41,110 --> 00:07:46,670
websites using that certificate so you

204
00:07:45,740 --> 00:07:47,870
try to dig a little deeper and learn

205
00:07:46,670 --> 00:07:51,110
more about this and we learned about the

206
00:07:47,870 --> 00:07:52,640
CA B browser form and this is a group of

207
00:07:51,110 --> 00:07:54,230
representatives from both certificate

208
00:07:52,640 --> 00:07:55,460
authorities and browsers that get

209
00:07:54,230 --> 00:07:57,350
together and create this set of rules

210
00:07:55,460 --> 00:07:59,210
that dictate how CAS and browsers

211
00:07:57,350 --> 00:07:59,900
operate and if this contractor sever

212
00:07:59,210 --> 00:08:01,580
roles is broken

213
00:07:59,900 --> 00:08:02,750
browsers distrust certificate

214
00:08:01,580 --> 00:08:04,940
authorities and this ever rules is

215
00:08:02,750 --> 00:08:06,530
called the baseline requirements for the

216
00:08:04,940 --> 00:08:08,330
issuance and management publicly trusted

217
00:08:06,530 --> 00:08:11,900
certificates it is very long and very

218
00:08:08,330 --> 00:08:13,700
dry but in in section nine six three or

219
00:08:11,900 --> 00:08:15,440
talks about reporting revocation of SSL

220
00:08:13,700 --> 00:08:16,909
certificates imagines that if any

221
00:08:15,440 --> 00:08:18,980
information in the certificate becomes

222
00:08:16,910 --> 00:08:20,570
inaccurate or incorrect that the

223
00:08:18,980 --> 00:08:24,110
certificate authority should revoke the

224
00:08:20,570 --> 00:08:26,150
certificate so there's a little bit of

225
00:08:24,110 --> 00:08:27,740
ambiguity with that what what it

226
00:08:26,150 --> 00:08:30,140
actually means for a certificate to

227
00:08:27,740 --> 00:08:32,990
become inaccurate I don't actually know

228
00:08:30,140 --> 00:08:35,630
aha if somebody issues a certificate and

229
00:08:32,990 --> 00:08:39,260
then they put some information in it and

230
00:08:35,630 --> 00:08:42,559
then that domain transfers ownership is

231
00:08:39,260 --> 00:08:44,540
that information inaccurate now that's I

232
00:08:42,559 --> 00:08:46,579
think one could argue either way but

233
00:08:44,540 --> 00:08:48,500
this new section that we found four

234
00:08:46,580 --> 00:08:51,020
point nine point one when one kind of

235
00:08:48,500 --> 00:08:53,540
puts the nail in the coffin it says

236
00:08:51,020 --> 00:08:55,850
basically if domain name registry failed

237
00:08:53,540 --> 00:08:56,910
to renew their domain and certificate

238
00:08:55,850 --> 00:08:59,850
authorities become maid

239
00:08:56,910 --> 00:09:02,449
we're of this within 24 hours they must

240
00:08:59,850 --> 00:09:05,250
revoke the certificate that seems really

241
00:09:02,450 --> 00:09:09,630
explicit and cut-and-dry that being said

242
00:09:05,250 --> 00:09:11,670
we did speak to some CA /b members and

243
00:09:09,630 --> 00:09:13,980
they they were very upfront and they

244
00:09:11,670 --> 00:09:16,140
told us that these you know these

245
00:09:13,980 --> 00:09:18,990
documents are by and large created by

246
00:09:16,140 --> 00:09:21,420
lawyers not by engineers and they can be

247
00:09:18,990 --> 00:09:25,500
in some cases self contradictory and in

248
00:09:21,420 --> 00:09:27,060
some cases some of the sections may be

249
00:09:25,500 --> 00:09:28,280
referenced by other sections in weird

250
00:09:27,060 --> 00:09:30,750
ways so the best of our understanding

251
00:09:28,280 --> 00:09:32,819
our interpretation is we can revoke

252
00:09:30,750 --> 00:09:34,110
these certificates but that's caveated

253
00:09:32,820 --> 00:09:37,680
by the fact these documents are really

254
00:09:34,110 --> 00:09:39,090
complicated and made by lawyers so going

255
00:09:37,680 --> 00:09:41,849
back to the prior example here we have a

256
00:09:39,090 --> 00:09:44,220
certificate for bukhoma 4.com this means

257
00:09:41,850 --> 00:09:45,420
that the pseudo column can be revoked

258
00:09:44,220 --> 00:09:47,430
because they share with food a column

259
00:09:45,420 --> 00:09:49,860
which has changed ownership so it means

260
00:09:47,430 --> 00:09:52,349
that potentially anyone who finds a

261
00:09:49,860 --> 00:09:54,810
certificate can revoke coms are socially

262
00:09:52,350 --> 00:09:56,970
causing a SL error for their users which

263
00:09:54,810 --> 00:09:58,439
would be a denial of service and so

264
00:09:56,970 --> 00:10:00,450
looking at our same data set for

265
00:09:58,440 --> 00:10:03,300
examples of this where domain names

266
00:10:00,450 --> 00:10:04,710
chery chery ssl certificate was another

267
00:10:03,300 --> 00:10:06,089
domain with its old name found that

268
00:10:04,710 --> 00:10:07,290
seven million domain names approximately

269
00:10:06,090 --> 00:10:10,170
are vulnerable which is just over two

270
00:10:07,290 --> 00:10:11,730
percent of the Internet and that's a 4x

271
00:10:10,170 --> 00:10:13,890
increase in our previous analysis and

272
00:10:11,730 --> 00:10:15,000
other these certificates forty-one

273
00:10:13,890 --> 00:10:16,800
percent are still bel and have not

274
00:10:15,000 --> 00:10:17,880
expires that means in theory maybe of

275
00:10:16,800 --> 00:10:19,800
these seven million domain names

276
00:10:17,880 --> 00:10:21,240
forty-one percent of these can actively

277
00:10:19,800 --> 00:10:23,430
actively used if the sugars are being

278
00:10:21,240 --> 00:10:28,190
used you can reach up to the CA and have

279
00:10:23,430 --> 00:10:31,530
them be revoked in theory so basically

280
00:10:28,190 --> 00:10:33,420
this this made us realize like those

281
00:10:31,530 --> 00:10:36,780
three hundred or sorry three million

282
00:10:33,420 --> 00:10:38,370
certificates that are still valid if Ian

283
00:10:36,780 --> 00:10:41,310
and I wanted to we could potentially

284
00:10:38,370 --> 00:10:42,540
revoke all of them and the certificate

285
00:10:41,310 --> 00:10:46,349
authorities would have to revoke them

286
00:10:42,540 --> 00:10:48,089
within 24 hours if was asking them to we

287
00:10:46,350 --> 00:10:52,320
can break large swathes of the internet

288
00:10:48,090 --> 00:10:53,490
and more particularly CD ends that put

289
00:10:52,320 --> 00:10:55,560
multiple customers on the same

290
00:10:53,490 --> 00:10:56,940
certificate if they're not paying

291
00:10:55,560 --> 00:10:59,359
attention to domains transferring

292
00:10:56,940 --> 00:11:01,890
ownership we can render those CD ends

293
00:10:59,360 --> 00:11:03,990
pretty unusable by just continuously

294
00:11:01,890 --> 00:11:08,280
spinning up new domains and revoking

295
00:11:03,990 --> 00:11:10,890
certificates with them so we're calling

296
00:11:08,280 --> 00:11:14,880
this issue bygone SSL

297
00:11:10,890 --> 00:11:16,170
and we we think it kind of deserves sort

298
00:11:14,880 --> 00:11:18,600
of a new class of vulnerability

299
00:11:16,170 --> 00:11:20,430
definition it's got two variants the

300
00:11:18,600 --> 00:11:21,960
first is the one that we initially

301
00:11:20,430 --> 00:11:23,729
talked about bygone SSL

302
00:11:21,960 --> 00:11:27,900
man-in-the-middle and that's what

303
00:11:23,730 --> 00:11:29,430
happens when you get a certificate for

304
00:11:27,900 --> 00:11:31,140
domain that you own and then you

305
00:11:29,430 --> 00:11:33,540
transfer ownership of that domain where

306
00:11:31,140 --> 00:11:35,250
it expires and you still have a valid

307
00:11:33,540 --> 00:11:37,920
SSL certificate for it when someone else

308
00:11:35,250 --> 00:11:39,930
picks up the new domain and that gives

309
00:11:37,920 --> 00:11:43,079
you the ability to man in the middle the

310
00:11:39,930 --> 00:11:44,310
new owner and the other variants by

311
00:11:43,080 --> 00:11:45,930
gonna sell denial of service when we

312
00:11:44,310 --> 00:11:47,699
were just talking about here where if a

313
00:11:45,930 --> 00:11:49,140
certificate has a subject alt name for

314
00:11:47,700 --> 00:11:51,360
Dominion that's no longer owned or can

315
00:11:49,140 --> 00:11:53,189
be taken over then the new owner of that

316
00:11:51,360 --> 00:11:55,470
domain name can reach out to the CA and

317
00:11:53,190 --> 00:11:56,850
revoke that certificate for through

318
00:11:55,470 --> 00:11:58,890
available domain name which can affect

319
00:11:56,850 --> 00:12:00,750
the non vult non by ghantasala and the

320
00:11:58,890 --> 00:12:01,890
middle domain name causing a potential

321
00:12:00,750 --> 00:12:04,860
denial of service if the shared

322
00:12:01,890 --> 00:12:07,140
certificate is still in use so if you

323
00:12:04,860 --> 00:12:09,240
remember back to the example with 700

324
00:12:07,140 --> 00:12:11,010
domains on it I mentioned that one of

325
00:12:09,240 --> 00:12:13,950
them was available for purchase we

326
00:12:11,010 --> 00:12:16,439
purchased it in a home it was like 11

327
00:12:13,950 --> 00:12:18,600
dollars and that to the best of our

328
00:12:16,440 --> 00:12:20,850
knowledge gives us the right to revoke

329
00:12:18,600 --> 00:12:24,600
the certificate and break the websites

330
00:12:20,850 --> 00:12:27,210
of the other 700 people using it so for

331
00:12:24,600 --> 00:12:30,450
our live demo I'm gonna be tabbing over

332
00:12:27,210 --> 00:12:33,570
to an email client and in real time I'm

333
00:12:30,450 --> 00:12:39,120
going to ask that they revoke this SSL

334
00:12:33,570 --> 00:12:45,510
certificate I'm I'm just kidding not

335
00:12:39,120 --> 00:12:48,030
really gonna do that but but we we

336
00:12:45,510 --> 00:12:49,650
totally to our understanding have the

337
00:12:48,030 --> 00:12:53,250
right to do that and they would have to

338
00:12:49,650 --> 00:12:56,069
do it within 24 hours based on our

339
00:12:53,250 --> 00:12:58,440
understanding so for our pre-recorded

340
00:12:56,070 --> 00:13:00,600
demo we reached out to a couple of

341
00:12:58,440 --> 00:13:03,420
certificate authorities to actually test

342
00:13:00,600 --> 00:13:05,820
this and we didn't do this with real CD

343
00:13:03,420 --> 00:13:08,310
ends we just created certificates with

344
00:13:05,820 --> 00:13:10,440
subject alt names for a bunch of domains

345
00:13:08,310 --> 00:13:11,939
that we owned but we didn't make that

346
00:13:10,440 --> 00:13:14,940
immediately transparent to the

347
00:13:11,940 --> 00:13:16,800
certificate authorities so in the first

348
00:13:14,940 --> 00:13:19,500
case here I reached out to digit sir and

349
00:13:16,800 --> 00:13:22,380
I said hey this certificate that has

350
00:13:19,500 --> 00:13:24,450
some alt names on it well I just bought

351
00:13:22,380 --> 00:13:26,730
this domain and my domain is on

352
00:13:24,450 --> 00:13:30,480
certificate can you please revoke that

353
00:13:26,730 --> 00:13:32,220
old certificate and they were really

354
00:13:30,480 --> 00:13:34,640
good about it within 24 hours they

355
00:13:32,220 --> 00:13:37,320
actually did revoke the certificate and

356
00:13:34,640 --> 00:13:40,110
the other domains that we had that were

357
00:13:37,320 --> 00:13:42,150
using it in production Brooke if you

358
00:13:40,110 --> 00:13:45,780
tried to visit to them they had HSTs

359
00:13:42,150 --> 00:13:47,220
enabled and you couldn't render or visit

360
00:13:45,780 --> 00:13:48,720
them in any way because this is all

361
00:13:47,220 --> 00:13:53,130
certificate was invalid or it was

362
00:13:48,720 --> 00:13:56,400
revoked now the next one we reached out

363
00:13:53,130 --> 00:13:58,290
to was Amazon Amazon was also pretty

364
00:13:56,400 --> 00:14:00,390
good about it but the issue we had there

365
00:13:58,290 --> 00:14:03,630
was we didn't want to actually make an

366
00:14:00,390 --> 00:14:05,640
Amazon account and really the only good

367
00:14:03,630 --> 00:14:08,580
way to get support from Amazon is to

368
00:14:05,640 --> 00:14:10,380
have an Amazon account so the previous

369
00:14:08,580 --> 00:14:11,790
owner of the certificate had an Amazon

370
00:14:10,380 --> 00:14:12,990
account we just wanted to reach up some

371
00:14:11,790 --> 00:14:16,079
support and say hey please revoke that

372
00:14:12,990 --> 00:14:17,370
so we we looked for an email that we

373
00:14:16,080 --> 00:14:19,320
could reach out to that might be able to

374
00:14:17,370 --> 00:14:21,900
route us to the right place the one we

375
00:14:19,320 --> 00:14:23,820
found was there ec2 abuse email that one

376
00:14:21,900 --> 00:14:25,550
was public and with a little bit of

377
00:14:23,820 --> 00:14:28,050
back-and-forth explaining the situation

378
00:14:25,550 --> 00:14:30,270
that actually worked they were able to

379
00:14:28,050 --> 00:14:31,800
route us to the right place we had to

380
00:14:30,270 --> 00:14:34,800
verify ownership of the domain but

381
00:14:31,800 --> 00:14:39,900
within a couple weeks they also revoked

382
00:14:34,800 --> 00:14:43,260
the certificate now on the other side of

383
00:14:39,900 --> 00:14:46,230
the coin we reach up to komodo and we

384
00:14:43,260 --> 00:14:49,050
ask them to prove the same thing we ask

385
00:14:46,230 --> 00:14:50,490
them to revoke certificate and every

386
00:14:49,050 --> 00:14:52,469
single time we reached out to them via

387
00:14:50,490 --> 00:14:53,760
support chat and via email they

388
00:14:52,470 --> 00:14:55,890
basically told us this wasn't possible

389
00:14:53,760 --> 00:14:58,410
if we weren't the original people that

390
00:14:55,890 --> 00:15:00,300
created the certificate they weren't

391
00:14:58,410 --> 00:15:01,589
going to help us and in the bottom there

392
00:15:00,300 --> 00:15:04,439
you can actually see with one of the

393
00:15:01,590 --> 00:15:05,970
support chats they told us you can

394
00:15:04,440 --> 00:15:08,040
forget about the old ssl certificate

395
00:15:05,970 --> 00:15:10,290
don't worry about that one but you can

396
00:15:08,040 --> 00:15:11,520
buy a new one no problem we'll sell you

397
00:15:10,290 --> 00:15:14,400
a new one

398
00:15:11,520 --> 00:15:15,689
so basically they they wouldn't help us

399
00:15:14,400 --> 00:15:20,340
and they tried to use it as an upselling

400
00:15:15,690 --> 00:15:21,900
opportunity to sell us other services so

401
00:15:20,340 --> 00:15:23,010
next we try using let's encrypt which is

402
00:15:21,900 --> 00:15:25,079
a little bit of a different type of CA

403
00:15:23,010 --> 00:15:27,210
um they rely almost entirely on

404
00:15:25,080 --> 00:15:28,680
automation for generating certificates

405
00:15:27,210 --> 00:15:31,710
revoking certificates or anything else

406
00:15:28,680 --> 00:15:33,599
I'm using the acne protocol and so there

407
00:15:31,710 --> 00:15:35,880
are current policy and specify the acne

408
00:15:33,600 --> 00:15:38,400
is to require proving ownership of all

409
00:15:35,880 --> 00:15:40,730
the way names before you can revoke

410
00:15:38,400 --> 00:15:42,630
so reach out to their CPS contact to

411
00:15:40,730 --> 00:15:44,280
talk to Malthus ass about this and they

412
00:15:42,630 --> 00:15:45,660
recognize this is a conflict with the

413
00:15:44,280 --> 00:15:47,280
agreement in the co browser for more

414
00:15:45,660 --> 00:15:49,860
evoke with just proofing ownership of a

415
00:15:47,280 --> 00:15:51,209
subset the domain names and however it's

416
00:15:49,860 --> 00:15:52,620
not only what they'll do but they are

417
00:15:51,210 --> 00:15:54,960
considering changing the policy to you

418
00:15:52,620 --> 00:15:56,100
more compliant or to change this so in

419
00:15:54,960 --> 00:15:57,750
the future this might be an automated

420
00:15:56,100 --> 00:15:59,040
way that you can revoke these these

421
00:15:57,750 --> 00:16:01,830
let's encrypt certificates by proving a

422
00:15:59,040 --> 00:16:03,329
subset but in the meantime if you are

423
00:16:01,830 --> 00:16:05,040
vulnerable to me involved with this

424
00:16:03,330 --> 00:16:06,060
there and you only have a subset of the

425
00:16:05,040 --> 00:16:09,390
domains there's no way you can get let's

426
00:16:06,060 --> 00:16:10,469
encrypt to revoke this certificate so

427
00:16:09,390 --> 00:16:12,300
nice like to point out a tool that wrote

428
00:16:10,470 --> 00:16:13,980
a while ago called cert graph and sir

429
00:16:12,300 --> 00:16:16,079
CREP is an open source intelligence tool

430
00:16:13,980 --> 00:16:18,060
to call the grout host Rafi alternative

431
00:16:16,080 --> 00:16:19,800
names and this works especially you give

432
00:16:18,060 --> 00:16:21,719
a domain name and it will find all

433
00:16:19,800 --> 00:16:22,650
certificates flood domain name and each

434
00:16:21,720 --> 00:16:24,390
of those all names and all the

435
00:16:22,650 --> 00:16:25,590
certificates final strip is for all

436
00:16:24,390 --> 00:16:27,870
those domain names and keep going and

437
00:16:25,590 --> 00:16:30,300
going until it's a complete graph so in

438
00:16:27,870 --> 00:16:31,890
this example the purple node which is

439
00:16:30,300 --> 00:16:33,510
for e FF 2 org is the domain name I've

440
00:16:31,890 --> 00:16:35,460
ever I did it they reached out and found

441
00:16:33,510 --> 00:16:36,990
these certificates in the red nodes that

442
00:16:35,460 --> 00:16:38,280
are developed that domain name and then

443
00:16:36,990 --> 00:16:39,900
I'll press alt names are all the other

444
00:16:38,280 --> 00:16:42,150
green nodes that are related domain

445
00:16:39,900 --> 00:16:43,800
names have found and so you can use this

446
00:16:42,150 --> 00:16:45,569
tool I wrote it for doing domain name

447
00:16:43,800 --> 00:16:47,219
enumeration through SSL Certificates

448
00:16:45,570 --> 00:16:49,380
they can use both connecting the sites

449
00:16:47,220 --> 00:16:51,930
over HTTP or using certificate

450
00:16:49,380 --> 00:16:53,930
transparency or SMTP or other protocols

451
00:16:51,930 --> 00:16:56,520
as well but you can use it too for

452
00:16:53,930 --> 00:16:59,189
determining sites that are vulnerable

453
00:16:56,520 --> 00:17:00,300
for bag on SSL it's not a service which

454
00:16:59,190 --> 00:17:01,410
can be very useful if you want to find

455
00:17:00,300 --> 00:17:03,540
sites that are vulnerable either

456
00:17:01,410 --> 00:17:05,399
yourself or for target announcement to

457
00:17:03,540 --> 00:17:07,500
eval I'm a bug bounty and at the bottom

458
00:17:05,400 --> 00:17:09,840
here I just have the options you provide

459
00:17:07,500 --> 00:17:12,240
to this to enumerate these domain names

460
00:17:09,839 --> 00:17:15,060
so you so let's go death one you entire

461
00:17:12,240 --> 00:17:16,200
graph just the graph of your target the

462
00:17:15,060 --> 00:17:17,550
new your say driver Google which is

463
00:17:16,200 --> 00:17:19,980
using Google certificate transparency

464
00:17:17,550 --> 00:17:21,690
search engine includes the certificates

465
00:17:19,980 --> 00:17:26,069
parry so domain names includes two

466
00:17:21,690 --> 00:17:27,510
certificates for CD ends and look at the

467
00:17:26,069 --> 00:17:29,060
DNS records of all the domain is found

468
00:17:27,510 --> 00:17:32,700
to see if they are unregistered and

469
00:17:29,060 --> 00:17:34,740
Tildy plus one will also look up the

470
00:17:32,700 --> 00:17:37,680
top-level domain name for a given domain

471
00:17:34,740 --> 00:17:40,050
Ian pounds so example say WWE FF 2 org

472
00:17:37,680 --> 00:17:41,220
it would also check for EF f dot org I'm

473
00:17:40,050 --> 00:17:44,129
not just one level up but the actual

474
00:17:41,220 --> 00:17:46,020
domain name at the Registrar level and

475
00:17:44,130 --> 00:17:48,330
so using this tool we found one example

476
00:17:46,020 --> 00:17:50,160
here with Salesforce so here I ran this

477
00:17:48,330 --> 00:17:50,939
tool on the domain name salesforce.com

478
00:17:50,160 --> 00:17:52,440
it's up there

479
00:17:50,940 --> 00:17:53,880
the purple node and it created this

480
00:17:52,440 --> 00:17:55,260
graph and it ended up here at

481
00:17:53,880 --> 00:17:56,910
Squarespace which is no connection of

482
00:17:55,260 --> 00:17:58,680
Salesforce and so what happened is

483
00:17:56,910 --> 00:18:01,260
they're linked here via this chain of

484
00:17:58,680 --> 00:18:03,450
domains in Hertz through do calm and the

485
00:18:01,260 --> 00:18:05,280
story here is that Duda column was once

486
00:18:03,450 --> 00:18:07,440
owned by Salesforce and they had a

487
00:18:05,280 --> 00:18:08,190
associative for it and they lost control

488
00:18:07,440 --> 00:18:10,020
that domain name

489
00:18:08,190 --> 00:18:11,730
Squarespace bought it up but that

490
00:18:10,020 --> 00:18:13,800
ultimatum was still being served by

491
00:18:11,730 --> 00:18:14,580
Salesforce domain name keeping one

492
00:18:13,800 --> 00:18:16,830
Salesforce

493
00:18:14,580 --> 00:18:19,439
try squarespace the ability to revoke a

494
00:18:16,830 --> 00:18:21,149
salesforce.com production WW so to calm

495
00:18:19,440 --> 00:18:23,220
SSL certificate and causing downtime for

496
00:18:21,150 --> 00:18:24,900
them or alternatively salesforce.com

497
00:18:23,220 --> 00:18:26,430
could have man the middle Squarespace

498
00:18:24,900 --> 00:18:27,900
because I had a valid SSL certificate

499
00:18:26,430 --> 00:18:29,910
one of their domain names and actually

500
00:18:27,900 --> 00:18:33,180
if you look at that graph the

501
00:18:29,910 --> 00:18:35,160
certificate that do.com is is shared

502
00:18:33,180 --> 00:18:37,170
with on Salesforce isn't just for

503
00:18:35,160 --> 00:18:39,960
salesforce.com it's for a whole bunch of

504
00:18:37,170 --> 00:18:40,560
sites that circular green dots on the

505
00:18:39,960 --> 00:18:43,560
left there

506
00:18:40,560 --> 00:18:45,300
if Squarespace wanted to they could take

507
00:18:43,560 --> 00:18:47,250
that whole cert down and all of those

508
00:18:45,300 --> 00:18:48,710
web sites from Salesforce would stop

509
00:18:47,250 --> 00:18:50,640
working

510
00:18:48,710 --> 00:18:52,350
yeah so they a little deeper in this

511
00:18:50,640 --> 00:18:54,630
here we seen the left is the circle

512
00:18:52,350 --> 00:18:55,889
DNS for to.com we find this isn't just

513
00:18:54,630 --> 00:18:57,420
unique to for this particular domain

514
00:18:55,890 --> 00:18:59,010
name is not just unique to Squarespace

515
00:18:57,420 --> 00:19:00,570
for salesforce those domain name here's

516
00:18:59,010 --> 00:19:03,930
been hosts at Microsoft's name servers

517
00:19:00,570 --> 00:19:05,310
AWS and a few others so at the period of

518
00:19:03,930 --> 00:19:07,920
time when that previous graph has taken

519
00:19:05,310 --> 00:19:09,540
we've highlighted in these red boxes in

520
00:19:07,920 --> 00:19:11,430
this example and the right we have a

521
00:19:09,540 --> 00:19:14,010
screenshot for that SSL stripping

522
00:19:11,430 --> 00:19:15,390
question verbal do comm and a wild card

523
00:19:14,010 --> 00:19:17,760
do comm and all these other salesforce

524
00:19:15,390 --> 00:19:18,960
domain names taken from the CRTs a

525
00:19:17,760 --> 00:19:21,090
certificate transparency search

526
00:19:18,960 --> 00:19:23,130
basically what we were finding was for

527
00:19:21,090 --> 00:19:24,480
some these single word domains they

528
00:19:23,130 --> 00:19:25,950
transfer ownership a lot and they

529
00:19:24,480 --> 00:19:28,110
usually transfer ownership from big

530
00:19:25,950 --> 00:19:29,700
companies so we think that this domain

531
00:19:28,110 --> 00:19:32,879
was actually owned by Microsoft at one

532
00:19:29,700 --> 00:19:34,740
point and it was owned by Salesforce and

533
00:19:32,880 --> 00:19:36,750
was owned by Squarespace and all of that

534
00:19:34,740 --> 00:19:39,320
was potentially within a life span of

535
00:19:36,750 --> 00:19:41,760
one SSL certificate which further

536
00:19:39,320 --> 00:19:43,200
strengthens the argument that a bad guy

537
00:19:41,760 --> 00:19:46,140
would potentially be able to squat on

538
00:19:43,200 --> 00:19:47,520
desirable domains and also for the pipe

539
00:19:46,140 --> 00:19:49,350
believe lost we checked this domain name

540
00:19:47,520 --> 00:19:51,740
was available for purchase for them

541
00:19:49,350 --> 00:19:55,500
wants to buy it

542
00:19:51,740 --> 00:19:57,240
so another tool that we wrote this one

543
00:19:55,500 --> 00:20:00,750
specifically geared at finding just this

544
00:19:57,240 --> 00:20:04,860
problem is this bygone SSL tool that

545
00:20:00,750 --> 00:20:07,559
uses Facebook's API to again search

546
00:20:04,860 --> 00:20:10,110
typical transparency logs and it's

547
00:20:07,559 --> 00:20:11,790
configured to look for both bygone SSL

548
00:20:10,110 --> 00:20:13,889
denial service and bygone SSL

549
00:20:11,790 --> 00:20:15,690
man-in-the-middle all you have to do is

550
00:20:13,890 --> 00:20:18,150
give it accurate information on when you

551
00:20:15,690 --> 00:20:19,740
first registered a domain and give it a

552
00:20:18,150 --> 00:20:21,480
complete list of all domains that you

553
00:20:19,740 --> 00:20:25,140
own and it'll tell you if any of your

554
00:20:21,480 --> 00:20:27,179
domains share certificates with domains

555
00:20:25,140 --> 00:20:29,429
that you don't own and it'll also tell

556
00:20:27,179 --> 00:20:31,920
you if there are any SSL certificates

557
00:20:29,429 --> 00:20:36,390
that predate the date that you purchased

558
00:20:31,920 --> 00:20:37,980
the domain another tool that we have

559
00:20:36,390 --> 00:20:39,690
worked on writing as we added bygone a

560
00:20:37,980 --> 00:20:41,549
cell detection to a cell mate certain

561
00:20:39,690 --> 00:20:43,260
spotter and certs spotter is a

562
00:20:41,549 --> 00:20:44,879
certificate transparency logged monitor

563
00:20:43,260 --> 00:20:46,830
so you'll run it yourself or you can use

564
00:20:44,880 --> 00:20:49,590
their hosted version and it looks at all

565
00:20:46,830 --> 00:20:52,168
the certificate transparency logs looks

566
00:20:49,590 --> 00:20:53,699
for SSL certificates and alert you if a

567
00:20:52,169 --> 00:20:55,860
certificate is logged for a domain name

568
00:20:53,700 --> 00:20:57,809
that you are monitoring so you provide a

569
00:20:55,860 --> 00:21:00,209
watchlist in this example here we have

570
00:20:57,809 --> 00:21:01,710
insecure - org or condo Network at Peter

571
00:21:00,210 --> 00:21:03,299
org and the belt add date which would be

572
00:21:01,710 --> 00:21:04,890
the date that you have acquired access

573
00:21:03,299 --> 00:21:07,530
this domain name and then it puts us a

574
00:21:04,890 --> 00:21:09,540
little bygone SSL equals true flag in

575
00:21:07,530 --> 00:21:11,580
the domains output information if it

576
00:21:09,540 --> 00:21:13,710
finds that the certificate was generated

577
00:21:11,580 --> 00:21:15,149
before that valid that date but and also

578
00:21:13,710 --> 00:21:16,590
valid after I mean that you should be

579
00:21:15,150 --> 00:21:18,030
aware that the certificate you probably

580
00:21:16,590 --> 00:21:21,540
don't have control over it and might

581
00:21:18,030 --> 00:21:22,620
want to get revoked and so at this point

582
00:21:21,540 --> 00:21:24,360
might be thinking like what can you do

583
00:21:22,620 --> 00:21:26,428
to protect your domain names or your own

584
00:21:24,360 --> 00:21:27,719
sites and the answer is kind of

585
00:21:26,429 --> 00:21:30,000
complicate the best you can do is use

586
00:21:27,720 --> 00:21:32,429
the expects eth3 header with the enforce

587
00:21:30,000 --> 00:21:34,320
flag to ensure that only CT log search

588
00:21:32,429 --> 00:21:35,820
will be trusts appear domain name so

589
00:21:34,320 --> 00:21:38,129
that means that if a certificate is

590
00:21:35,820 --> 00:21:39,809
found or served for your site that is

591
00:21:38,130 --> 00:21:42,330
not in search of transparency it will

592
00:21:39,809 --> 00:21:44,040
not be trusted and one limitation of

593
00:21:42,330 --> 00:21:45,720
this is that this only protects users on

594
00:21:44,040 --> 00:21:46,860
their on who first connect your

595
00:21:45,720 --> 00:21:48,120
legitimate site if their first

596
00:21:46,860 --> 00:21:49,830
connection to your site is through

597
00:21:48,120 --> 00:21:50,969
somebody's man the middling you there's

598
00:21:49,830 --> 00:21:54,510
nothing you can do unfortunately at this

599
00:21:50,970 --> 00:21:55,830
time and then of course if any producing

600
00:21:54,510 --> 00:21:58,140
certificate already exists for your

601
00:21:55,830 --> 00:21:59,340
domain name and it isn't CT logs it

602
00:21:58,140 --> 00:22:00,780
would still work with this case that's

603
00:21:59,340 --> 00:22:02,129
why it's important to monitor CT logs

604
00:22:00,780 --> 00:22:03,360
and reach out to the issuing CAS and

605
00:22:02,130 --> 00:22:06,030
have those certificates revoked for your

606
00:22:03,360 --> 00:22:07,860
domain names and so is it all good thing

607
00:22:06,030 --> 00:22:09,660
to do our next thing CT has only been

608
00:22:07,860 --> 00:22:11,790
required for non-tv cert since April of

609
00:22:09,660 --> 00:22:13,320
this year so prior to that certificates

610
00:22:11,790 --> 00:22:14,668
issued prior to April this year do not

611
00:22:13,320 --> 00:22:17,460
need to be in CT to be trusted by

612
00:22:14,669 --> 00:22:18,330
browsers there's so that prior existing

613
00:22:17,460 --> 00:22:19,649
sir

614
00:22:18,330 --> 00:22:23,428
there you don't know what's not in there

615
00:22:19,649 --> 00:22:24,539
it's a double negative set but that

616
00:22:23,429 --> 00:22:26,039
being said there are certificates issued

617
00:22:24,539 --> 00:22:27,179
before April this year that are still in

618
00:22:26,039 --> 00:22:29,250
there for example I had a certificate

619
00:22:27,179 --> 00:22:31,679
from 2009 chopped and CT logs very

620
00:22:29,250 --> 00:22:33,570
recently so at any point in time sure it

621
00:22:31,679 --> 00:22:35,370
gets me back ported or backlog into CT

622
00:22:33,570 --> 00:22:36,840
so it's important to clean my RCT logs

623
00:22:35,370 --> 00:22:41,699
you can use our search bar and by gonna

624
00:22:36,840 --> 00:22:43,860
sell tools or you sort graph and then we

625
00:22:41,700 --> 00:22:46,320
also have some asks for the general

626
00:22:43,860 --> 00:22:48,750
internet basically when you register

627
00:22:46,320 --> 00:22:51,240
domain the Registrar could do a check

628
00:22:48,750 --> 00:22:52,710
and certificate transparency for you and

629
00:22:51,240 --> 00:22:55,590
they could let you know ahead of time if

630
00:22:52,710 --> 00:22:57,269
a previous owner still has a valid

631
00:22:55,590 --> 00:22:59,070
certificate we think that would be a

632
00:22:57,269 --> 00:23:03,120
nice feature also

633
00:22:59,070 --> 00:23:06,149
ca'se could shift to models with a

634
00:23:03,120 --> 00:23:09,090
shorter lived SSL Certificates or a lot

635
00:23:06,149 --> 00:23:11,239
shorter lifespans so let's encrypt kind

636
00:23:09,090 --> 00:23:15,510
of is paving the road for that their

637
00:23:11,240 --> 00:23:17,690
certificates can only be 90 days but

638
00:23:15,510 --> 00:23:21,240
other certificate authorities issue

639
00:23:17,690 --> 00:23:23,309
certificates that are much longer and we

640
00:23:21,240 --> 00:23:25,049
think that if they also cut down their

641
00:23:23,309 --> 00:23:27,269
lifetime it wouldn't remediate the issue

642
00:23:25,049 --> 00:23:34,110
completely but it would make it much

643
00:23:27,269 --> 00:23:36,990
less severe we think that also if you do

644
00:23:34,110 --> 00:23:38,699
request that you revoke a certificate

645
00:23:36,990 --> 00:23:40,620
the certificate authority should do due

646
00:23:38,700 --> 00:23:43,889
diligence and notify all the other alt

647
00:23:40,620 --> 00:23:45,840
names on the certificate when they do

648
00:23:43,889 --> 00:23:47,639
the revocation so that way denial

649
00:23:45,840 --> 00:23:48,750
service doesn't just come from nowhere

650
00:23:47,639 --> 00:23:52,320
at least you have a little bit of a

651
00:23:48,750 --> 00:23:53,639
heads up we think that certificate

652
00:23:52,320 --> 00:23:56,580
authorities also shouldn't issue

653
00:23:53,639 --> 00:23:58,469
certificates that exceed the lifespan of

654
00:23:56,580 --> 00:24:00,809
the domain registration so when you

655
00:23:58,470 --> 00:24:03,120
register domain there's an expiration

656
00:24:00,809 --> 00:24:04,470
date on that and we don't think

657
00:24:03,120 --> 00:24:06,709
certificate authority should give you

658
00:24:04,470 --> 00:24:09,480
certs that exceed that and right now

659
00:24:06,710 --> 00:24:11,760
there's no protection or the limitation

660
00:24:09,480 --> 00:24:14,480
and and they will just give you a

661
00:24:11,760 --> 00:24:17,490
certificate that exceeds that that

662
00:24:14,480 --> 00:24:21,419
expiration date and then the last bullet

663
00:24:17,490 --> 00:24:23,970
here well point here really goes to see

664
00:24:21,419 --> 00:24:26,100
DNS like we mentioned before in some

665
00:24:23,970 --> 00:24:29,250
cases it's pretty extreme CDN is putting

666
00:24:26,100 --> 00:24:31,889
700 customers on one cert we think that

667
00:24:29,250 --> 00:24:35,220
they should really move to a model that

668
00:24:31,890 --> 00:24:36,870
each customer on their own cert and if

669
00:24:35,220 --> 00:24:38,760
you're using subject all names whether

670
00:24:36,870 --> 00:24:40,739
you're a CDN or a company you got to be

671
00:24:38,760 --> 00:24:43,320
really careful with it because again

672
00:24:40,740 --> 00:24:45,390
based on our understanding your

673
00:24:43,320 --> 00:24:46,919
customers basically have the right to

674
00:24:45,390 --> 00:24:48,960
revoke these certificates and in some

675
00:24:46,920 --> 00:24:53,460
cases surrender your service is pretty

676
00:24:48,960 --> 00:24:54,570
unusable and that concludes our talk

677
00:24:53,460 --> 00:24:56,010
thank you all very much

678
00:24:54,570 --> 00:24:57,659
we have more efficient on our demo site

679
00:24:56,010 --> 00:24:59,160
in skirt design here are links to the

680
00:24:57,660 --> 00:25:01,140
tools we talked about and if you want

681
00:24:59,160 --> 00:25:02,610
email us about this we have a bygone SSL

682
00:25:01,140 --> 00:25:08,240
insecure design does anyone have any

683
00:25:02,610 --> 00:25:08,240
questions there's a question in the back

684
00:25:15,430 --> 00:25:18,559
[Music]

685
00:25:24,270 --> 00:25:28,220
so that's obscene

686
00:25:29,570 --> 00:25:32,570
with

687
00:25:33,230 --> 00:25:36,440
[Music]

688
00:25:36,809 --> 00:25:40,570
so what if your account is still valid

689
00:25:39,220 --> 00:25:44,070
and you're still paying for the services

690
00:25:40,570 --> 00:25:44,070
just your domain name expires

691
00:26:04,420 --> 00:26:12,280
so basically the comment was that when

692
00:26:08,500 --> 00:26:14,720
and in some cases some CD ends will

693
00:26:12,280 --> 00:26:16,700
revoke certificates or stop using

694
00:26:14,720 --> 00:26:19,940
certificates when customers stop using

695
00:26:16,700 --> 00:26:21,230
their services which is helpful and then

696
00:26:19,940 --> 00:26:23,030
the other point that we pointed out is

697
00:26:21,230 --> 00:26:24,530
you know what happens if customer is

698
00:26:23,030 --> 00:26:27,889
still using their services but the

699
00:26:24,530 --> 00:26:29,690
domain just expires and CD ends could

700
00:26:27,890 --> 00:26:31,430
monitor that based on the expiration

701
00:26:29,690 --> 00:26:33,860
date but one thing that's harder to

702
00:26:31,430 --> 00:26:35,870
monitor in that case is actually when

703
00:26:33,860 --> 00:26:38,810
the domain doesn't expire it just

704
00:26:35,870 --> 00:26:40,850
transfers ownership there's really not a

705
00:26:38,810 --> 00:26:43,310
good way for students to know when that

706
00:26:40,850 --> 00:26:45,110
happened there's like a couple of

707
00:26:43,310 --> 00:26:50,149
high-level heuristics you can tell based

708
00:26:45,110 --> 00:26:52,790
on who is and based on some other stuff

709
00:26:50,150 --> 00:26:54,260
that we mentioned before but they are

710
00:26:52,790 --> 00:26:55,730
probably going to run into the same

711
00:26:54,260 --> 00:26:57,830
problems that we do that there isn't a

712
00:26:55,730 --> 00:26:59,150
really good central source or authority

713
00:26:57,830 --> 00:27:01,370
that can tell you that a domain

714
00:26:59,150 --> 00:27:03,290
transferred ownership but that is good

715
00:27:01,370 --> 00:27:06,110
to hear that some CD ends are building

716
00:27:03,290 --> 00:27:11,260
in some protections against this other

717
00:27:06,110 --> 00:27:11,260
questions yep

718
00:27:16,360 --> 00:27:20,120
yeah the screenshot we had earlier with

719
00:27:18,800 --> 00:27:24,649
all the stuff was bored out with some

720
00:27:20,120 --> 00:27:26,000
hundred actual live customers yes so

721
00:27:24,650 --> 00:27:27,500
repeat the question sorry the question

722
00:27:26,000 --> 00:27:29,540
was are there any people are still

723
00:27:27,500 --> 00:27:30,860
vulnerable to this after we have

724
00:27:29,540 --> 00:27:34,879
informed them that they were vulnerable

725
00:27:30,860 --> 00:27:37,540
to this and there may be some of that or

726
00:27:34,880 --> 00:27:37,540
have not been mentioned

727
00:27:46,510 --> 00:27:49,510
this

728
00:27:53,930 --> 00:27:58,800
why they're like we're level

729
00:27:56,590 --> 00:28:01,620
publications about

730
00:27:58,800 --> 00:28:03,330
is the question basically is have we

731
00:28:01,620 --> 00:28:07,709
ever seen this being exploited in the

732
00:28:03,330 --> 00:28:09,960
wild by a malicious actor not to my

733
00:28:07,710 --> 00:28:12,330
knowledge and not to mine either I think

734
00:28:09,960 --> 00:28:14,130
this is novel new but if there are any

735
00:28:12,330 --> 00:28:18,500
bad guys in the audience that want to

736
00:28:14,130 --> 00:28:18,500
prove us wrong by all means

737
00:28:39,480 --> 00:28:46,630
that's basically the comment there was

738
00:28:43,120 --> 00:28:47,860
like if you take over a domain like it

739
00:28:46,630 --> 00:28:48,820
wasn't intentionally transferred you

740
00:28:47,860 --> 00:28:52,299
take over domain and you get a

741
00:28:48,820 --> 00:28:54,039
certificate that also kind of manifests

742
00:28:52,299 --> 00:28:55,840
itself in the same capacity that like

743
00:28:54,039 --> 00:28:57,190
you're in this awkward state of like

744
00:28:55,840 --> 00:28:58,658
well komodo won't revoke that

745
00:28:57,190 --> 00:29:00,820
certificate because you're not the one

746
00:28:58,659 --> 00:29:02,230
that created it and there are cases like

747
00:29:00,820 --> 00:29:03,700
that that we can definitely point to

748
00:29:02,230 --> 00:29:05,980
where someone was able to temporarily

749
00:29:03,700 --> 00:29:07,690
hijack a domain and generate a real ssl

750
00:29:05,980 --> 00:29:09,220
certificate yeah so that's something

751
00:29:07,690 --> 00:29:10,600
happened a few times um but I don't know

752
00:29:09,220 --> 00:29:12,669
the example were someone's done that and

753
00:29:10,600 --> 00:29:14,320
then revoked the other the actual users

754
00:29:12,669 --> 00:29:15,250
as sole certificate that be not

755
00:29:14,320 --> 00:29:18,010
something hasn't happened I just don't

756
00:29:15,250 --> 00:29:20,919
know about name Campbells that other

757
00:29:18,010 --> 00:29:23,720
questions cool thank you very good enjoy

758
00:29:20,919 --> 00:29:28,069
very much thanks everyone

759
00:29:23,720 --> 00:29:28,069
[Applause]

