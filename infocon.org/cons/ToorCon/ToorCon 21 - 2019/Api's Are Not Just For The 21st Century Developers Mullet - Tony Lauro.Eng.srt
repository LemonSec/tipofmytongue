1
00:00:00,000 --> 00:00:02,070
once Tony enjoys skateboarding

2
00:00:02,070 --> 00:00:03,840
competitive grappling Brazilian Jews it

3
00:00:03,840 --> 00:00:05,910
- and spending time with his wife and

4
00:00:05,910 --> 00:00:06,210
kids

5
00:00:06,210 --> 00:00:10,260
in Dallas Texas awesome thank you all

6
00:00:10,260 --> 00:00:12,210
right we'll start the timer so this is

7
00:00:12,210 --> 00:00:15,089
my first time at torque on and it might

8
00:00:15,089 --> 00:00:18,119
be my last if I mess this up so thank

9
00:00:18,119 --> 00:00:19,140
you guys for being here so we're going

10
00:00:19,140 --> 00:00:22,470
to talk about a topic I really love I

11
00:00:22,470 --> 00:00:24,480
was trying to find a picture of me as a

12
00:00:24,480 --> 00:00:27,330
child I had the rat tail was like a full

13
00:00:27,330 --> 00:00:29,820
shaved head and then the long tail I

14
00:00:29,820 --> 00:00:31,560
didn't have a mullet but we'll get into

15
00:00:31,560 --> 00:00:34,380
some other famous mullets in just a

16
00:00:34,380 --> 00:00:38,969
moment here so let's talk about AP is

17
00:00:38,969 --> 00:00:41,820
this talking about AP eyes Google Trends

18
00:00:41,820 --> 00:00:44,850
has been tracking the decline and things

19
00:00:44,850 --> 00:00:48,680
like soap and wisdom kind of depreciated

20
00:00:48,680 --> 00:00:53,610
models for for ap eyes and looking at

21
00:00:53,610 --> 00:00:57,210
more increase in things like json

22
00:00:57,210 --> 00:00:59,820
restful services and micro services this

23
00:00:59,820 --> 00:01:01,620
all started if you guys have the phone

24
00:01:01,620 --> 00:01:03,719
that's got the name of a fruit and it's

25
00:01:03,719 --> 00:01:07,140
not a blackberry it all started in 2007

26
00:01:07,140 --> 00:01:09,869
with the invention of the iPhone right

27
00:01:09,869 --> 00:01:12,030
this was I mean people still go back and

28
00:01:12,030 --> 00:01:13,890
watch us on YouTube the the hits keep

29
00:01:13,890 --> 00:01:16,170
going up but this really started

30
00:01:16,170 --> 00:01:18,360
something really interesting which is

31
00:01:18,360 --> 00:01:20,549
driving API utilization more and more

32
00:01:20,549 --> 00:01:23,189
it's the app economy the mobile app

33
00:01:23,189 --> 00:01:25,650
economy and because mobile applications

34
00:01:25,650 --> 00:01:28,460
need a lightweight protocol api's are

35
00:01:28,460 --> 00:01:30,930
increasing massively so if you look at

36
00:01:30,930 --> 00:01:33,780
the difference between a soap call and

37
00:01:33,780 --> 00:01:37,590
then xml-rpc call versus a JSON API call

38
00:01:37,590 --> 00:01:40,490
you see that there's a lot of efficiency

39
00:01:40,490 --> 00:01:44,070
in a JSON API call the reason is is

40
00:01:44,070 --> 00:01:46,860
because we need a way to have some kind

41
00:01:46,860 --> 00:01:48,720
of uniform communication methodology

42
00:01:48,720 --> 00:01:50,970
that's lightweight and fast and it

43
00:01:50,970 --> 00:01:54,119
branches out kind of like a mullet to

44
00:01:54,119 --> 00:01:56,310
all the different applications in the

45
00:01:56,310 --> 00:01:59,520
backend right so this is why developers

46
00:01:59,520 --> 00:02:05,909
use them this guy is my hero so so the

47
00:02:05,909 --> 00:02:07,590
company I work for sees a whole bunch of

48
00:02:07,590 --> 00:02:09,239
web traffic and

49
00:02:09,239 --> 00:02:13,620
as of our last count 83% of the hits

50
00:02:13,620 --> 00:02:16,140
this is not per volume but a 383 % of

51
00:02:16,140 --> 00:02:19,560
the hits on the Akamai platform are api

52
00:02:19,560 --> 00:02:21,810
calls which i think is totally insane

53
00:02:21,810 --> 00:02:23,790
but again if you think about the

54
00:02:23,790 --> 00:02:25,980
majority of mobile traffic that might

55
00:02:25,980 --> 00:02:28,170
explain a little bit of that

56
00:02:28,170 --> 00:02:29,700
they're also being used heavily because

57
00:02:29,700 --> 00:02:32,129
they are how organizations are

58
00:02:32,129 --> 00:02:34,700
delivering and enriching user content

59
00:02:34,700 --> 00:02:36,870
and meeting kind of people where they

60
00:02:36,870 --> 00:02:38,790
they want to be met which makes them

61
00:02:38,790 --> 00:02:42,750
great to attack they're also a front

62
00:02:42,750 --> 00:02:45,150
door and then obviously a back door into

63
00:02:45,150 --> 00:02:47,700
your data which also makes them great to

64
00:02:47,700 --> 00:02:51,349
attack so here are some examples

65
00:02:51,349 --> 00:02:55,620
somebody cool to take take control via

66
00:02:55,620 --> 00:02:59,639
an API of these zo me pet feeders now

67
00:02:59,639 --> 00:03:02,069
somebody's cats got really fat that's

68
00:03:02,069 --> 00:03:05,159
not a huge hack right but if you look at

69
00:03:05,159 --> 00:03:07,769
some other interesting cases now I will

70
00:03:07,769 --> 00:03:10,799
tell you that this was actually not an

71
00:03:10,799 --> 00:03:13,019
API call but this is an IOT device and

72
00:03:13,019 --> 00:03:14,370
they're totally vulnerable I don't have

73
00:03:14,370 --> 00:03:16,829
to go into that but a Japanese hotel

74
00:03:16,829 --> 00:03:20,340
chain had robots kind of watching the

75
00:03:20,340 --> 00:03:24,060
beds of people and these robots were

76
00:03:24,060 --> 00:03:25,949
really excited when they got hacked so a

77
00:03:25,949 --> 00:03:27,750
researcher found a way to remotely

78
00:03:27,750 --> 00:03:31,439
access these cameras and and microphones

79
00:03:31,439 --> 00:03:34,439
and record so I already went over this

80
00:03:34,439 --> 00:03:36,540
I'm going kind of fast I was originally

81
00:03:36,540 --> 00:03:38,970
supposed to do lightning talk and I made

82
00:03:38,970 --> 00:03:41,459
my presentation was super long and now

83
00:03:41,459 --> 00:03:43,829
I'm making this even longer okay so

84
00:03:43,829 --> 00:03:46,199
there's a lot of different expectations

85
00:03:46,199 --> 00:03:48,449
and challenges around api's right so one

86
00:03:48,449 --> 00:03:51,509
is that for business innovation people

87
00:03:51,509 --> 00:03:54,509
using them most organizations aren't

88
00:03:54,509 --> 00:03:56,310
securing them properly the ones that I

89
00:03:56,310 --> 00:04:00,180
talked to are having huge problems just

90
00:04:00,180 --> 00:04:02,879
creating rule sets around API calls and

91
00:04:02,879 --> 00:04:05,040
understanding that you have to inspect

92
00:04:05,040 --> 00:04:06,989
each call before it hits your your web

93
00:04:06,989 --> 00:04:09,090
services and there's also legitimate

94
00:04:09,090 --> 00:04:11,400
problems which is you know authorization

95
00:04:11,400 --> 00:04:12,750
and authentication

96
00:04:12,750 --> 00:04:14,459
maybe offloading that if you're a real

97
00:04:14,459 --> 00:04:17,579
big shop and then quota enforcement and

98
00:04:17,579 --> 00:04:20,219
unpredictable load api's are extremely

99
00:04:20,219 --> 00:04:21,720
extremely vulnerable to

100
00:04:21,720 --> 00:04:24,120
overutilization so we'll go into some of

101
00:04:24,120 --> 00:04:27,420
the top threats that we've seen so

102
00:04:27,420 --> 00:04:29,990
denial-of-service this is like you know

103
00:04:29,990 --> 00:04:33,420
2005 everyone's favorite topic but

104
00:04:33,420 --> 00:04:35,160
denial service attacks are happening a

105
00:04:35,160 --> 00:04:39,360
ton to API services in a couple

106
00:04:39,360 --> 00:04:41,850
different ways so one you can specially

107
00:04:41,850 --> 00:04:43,650
craft a request to create hash

108
00:04:43,650 --> 00:04:45,930
collisions which basically makes the

109
00:04:45,930 --> 00:04:48,300
processing time on that web server go up

110
00:04:48,300 --> 00:04:52,020
extremely high and the deserialize err

111
00:04:52,020 --> 00:04:54,840
process is going to be overwhelmed and

112
00:04:54,840 --> 00:04:57,600
then fail similarly you can craft a

113
00:04:57,600 --> 00:04:59,550
request that has a really deep nested

114
00:04:59,550 --> 00:05:02,160
structure and this again it's like kind

115
00:05:02,160 --> 00:05:05,010
of you know decrypting something and

116
00:05:05,010 --> 00:05:06,990
then there's something else encrypted

117
00:05:06,990 --> 00:05:08,280
you have to decrypt so it's kind of this

118
00:05:08,280 --> 00:05:12,090
multiple payload problem so this is what

119
00:05:12,090 --> 00:05:14,460
a hash collision request looks like it's

120
00:05:14,460 --> 00:05:17,250
basically again trying to overwhelm the

121
00:05:17,250 --> 00:05:17,970
GC réaliser

122
00:05:17,970 --> 00:05:20,970
and this is what happens on the decode

123
00:05:20,970 --> 00:05:23,190
time when you look at those adding up

124
00:05:23,190 --> 00:05:26,669
over time now if you wrote if you were

125
00:05:26,669 --> 00:05:28,890
to have a way to perform a validation of

126
00:05:28,890 --> 00:05:30,360
what a request is supposed to look like

127
00:05:30,360 --> 00:05:32,730
you might see these hash collisions

128
00:05:32,730 --> 00:05:36,330
coming to an API endpoint that for all

129
00:05:36,330 --> 00:05:37,830
intents and purposes should never be

130
00:05:37,830 --> 00:05:39,990
seeing something of that format so if

131
00:05:39,990 --> 00:05:41,550
you could block it that way that would

132
00:05:41,550 --> 00:05:44,820
be ideal this is still things that that

133
00:05:44,820 --> 00:05:47,820
are in development in some cases and

134
00:05:47,820 --> 00:05:50,070
then looking at maximum nesting depth

135
00:05:50,070 --> 00:05:52,350
this is like saying if I get a letter

136
00:05:52,350 --> 00:05:55,910
that's got like 15 letters inside of it

137
00:05:55,910 --> 00:05:59,550
you know is this like you know some kind

138
00:05:59,550 --> 00:06:03,450
of like ricin attack or something do not

139
00:06:03,450 --> 00:06:05,130
open that many letters it's a waste of

140
00:06:05,130 --> 00:06:07,410
time so from a Red Team perspective

141
00:06:07,410 --> 00:06:10,320
attackers are looking at your typical

142
00:06:10,320 --> 00:06:12,060
application security vulnerabilities the

143
00:06:12,060 --> 00:06:14,160
same types of attacks that were against

144
00:06:14,160 --> 00:06:20,090
HTML web pages sequel injection you know

145
00:06:20,090 --> 00:06:22,919
basically anything religion it all works

146
00:06:22,919 --> 00:06:25,290
through an API service and the funny

147
00:06:25,290 --> 00:06:27,150
thing is most security teams when they

148
00:06:27,150 --> 00:06:29,250
see API traffic they say oh that's

149
00:06:29,250 --> 00:06:31,050
machine-to-machine traffic or that's

150
00:06:31,050 --> 00:06:33,630
secured via the API key that we have

151
00:06:33,630 --> 00:06:35,220
assigned to our mobile app

152
00:06:35,220 --> 00:06:37,500
and they kind of ignore it leaving most

153
00:06:37,500 --> 00:06:39,870
problems to be identified by the impact

154
00:06:39,870 --> 00:06:41,280
they have on the systems that they're

155
00:06:41,280 --> 00:06:43,980
communicating with input validation this

156
00:06:43,980 --> 00:06:45,680
is I mean we can have a whole talk at

157
00:06:45,680 --> 00:06:48,090
broken and weak authentication again

158
00:06:48,090 --> 00:06:49,650
I'll talk about that a little bit with

159
00:06:49,650 --> 00:06:53,940
API keys and Java web tokens and then

160
00:06:53,940 --> 00:06:59,700
deserialization process so this is this

161
00:06:59,700 --> 00:07:01,530
was kind of a snapshot of like the tops

162
00:07:01,530 --> 00:07:04,800
top attacks we saw against api's sequel

163
00:07:04,800 --> 00:07:06,960
injection again I think it turned like

164
00:07:06,960 --> 00:07:11,370
30 years old this past quarter which is

165
00:07:11,370 --> 00:07:13,440
kind of interesting so it's obviously

166
00:07:13,440 --> 00:07:15,870
still a favorite a really quick example

167
00:07:15,870 --> 00:07:19,680
here this is a customer who's in AWS and

168
00:07:19,680 --> 00:07:21,810
this call is basically looking at a

169
00:07:21,810 --> 00:07:24,720
credit card balance sheet and then we

170
00:07:24,720 --> 00:07:28,710
saw an attacker do the good old sequel

171
00:07:28,710 --> 00:07:31,650
injection tomfoolery to get access to

172
00:07:31,650 --> 00:07:34,160
more than one person's account balance

173
00:07:34,160 --> 00:07:38,790
so Java web tokens the place that we see

174
00:07:38,790 --> 00:07:41,160
these being misused or improperly uses

175
00:07:41,160 --> 00:07:43,140
that people think that a Java web token

176
00:07:43,140 --> 00:07:44,669
and whatever assert a ssin you make

177
00:07:44,669 --> 00:07:47,970
inside of there is secure most of the

178
00:07:47,970 --> 00:07:51,360
time it's just like encoded so when you

179
00:07:51,360 --> 00:07:53,190
do a decode you see the person's name

180
00:07:53,190 --> 00:07:55,650
you see an account number and then a

181
00:07:55,650 --> 00:07:58,680
base64 hash of their password which is

182
00:07:58,680 --> 00:08:00,030
probably not

183
00:08:00,030 --> 00:08:02,010
sometimes you see like user name colon

184
00:08:02,010 --> 00:08:04,350
password which is no bueno so don't do

185
00:08:04,350 --> 00:08:07,410
that the other thing is that the D

186
00:08:07,410 --> 00:08:09,440
serializer

187
00:08:09,440 --> 00:08:13,500
portion of an API call happens before

188
00:08:13,500 --> 00:08:16,380
the application logic kicks in so a

189
00:08:16,380 --> 00:08:18,660
request is sent and it's hitting a

190
00:08:18,660 --> 00:08:20,160
vulnerable deserialize err and I'll go

191
00:08:20,160 --> 00:08:23,880
into a Jakarta example in just a second

192
00:08:23,880 --> 00:08:26,280
the malicious code that runs is

193
00:08:26,280 --> 00:08:28,890
happening before that request is passed

194
00:08:28,890 --> 00:08:31,350
back to the application so if you think

195
00:08:31,350 --> 00:08:32,940
about from a security perspective you're

196
00:08:32,940 --> 00:08:34,530
like I'm gonna secure the application

197
00:08:34,530 --> 00:08:37,039
even more and like send my developers to

198
00:08:37,039 --> 00:08:39,929
security training some of this happens

199
00:08:39,929 --> 00:08:42,179
before that application logic even kicks

200
00:08:42,179 --> 00:08:45,780
in here's an example of a remote code

201
00:08:45,780 --> 00:08:47,490
execution we saw against a vulnerable

202
00:08:47,490 --> 00:08:48,990
deserialize err

203
00:08:48,990 --> 00:08:50,730
you'll see here this is someone's

204
00:08:50,730 --> 00:08:53,819
calling FTW Sh you know for the win I

205
00:08:53,819 --> 00:08:56,660
assume that that's what that means

206
00:08:56,660 --> 00:08:59,040
this problem has become so pervasive

207
00:08:59,040 --> 00:09:01,439
that Olas has added insecure D

208
00:09:01,439 --> 00:09:05,449
serialization to the to their OS top-10

209
00:09:05,449 --> 00:09:08,220
which means that most executives are

210
00:09:08,220 --> 00:09:10,199
gonna say can we protect against the OS

211
00:09:10,199 --> 00:09:11,850
top-10 that's like all they ever asked

212
00:09:11,850 --> 00:09:14,879
for some reason but if you were able to

213
00:09:14,879 --> 00:09:17,519
provide a positive security model that

214
00:09:17,519 --> 00:09:20,399
says this is what a request is supposed

215
00:09:20,399 --> 00:09:21,990
to look like and maybe even a negative

216
00:09:21,990 --> 00:09:24,240
security model that says if we see any

217
00:09:24,240 --> 00:09:26,279
kind of like you know breakouts here

218
00:09:26,279 --> 00:09:29,610
calling a a different string a URL via a

219
00:09:29,610 --> 00:09:31,230
different string that might be

220
00:09:31,230 --> 00:09:32,639
suspicious and if you could block that

221
00:09:32,639 --> 00:09:34,769
that would be ideal

222
00:09:34,769 --> 00:09:38,339
there was a Jakarta multi-part parser

223
00:09:38,339 --> 00:09:41,490
vulnerability in Apache struts that we

224
00:09:41,490 --> 00:09:45,540
saw a lot of activity on and this is

225
00:09:45,540 --> 00:09:47,670
another example here of someone using

226
00:09:47,670 --> 00:09:49,439
the D serialization process to make a

227
00:09:49,439 --> 00:09:54,629
curl request to this Sh file and when we

228
00:09:54,629 --> 00:09:57,000
looked at this SH file well what is this

229
00:09:57,000 --> 00:09:59,250
this K worker process and then we got

230
00:09:59,250 --> 00:10:00,509
you know some other things have been

231
00:10:00,509 --> 00:10:04,050
redacted we found out that it was a

232
00:10:04,050 --> 00:10:07,949
Bitcoin mining script so basically it

233
00:10:07,949 --> 00:10:10,439
ran and because of ulnar bul deserialize

234
00:10:10,439 --> 00:10:14,339
ER it it was you know active code on the

235
00:10:14,339 --> 00:10:16,199
machine and this helped golem and his

236
00:10:16,199 --> 00:10:21,059
buddies mine Bitcoin for fun so the

237
00:10:21,059 --> 00:10:23,970
other big problem is process and logic

238
00:10:23,970 --> 00:10:26,939
flaws this is one of my favorite logic

239
00:10:26,939 --> 00:10:29,040
flaws I tell my wife that you know this

240
00:10:29,040 --> 00:10:30,500
is why my shirts keep getting tighter

241
00:10:30,500 --> 00:10:33,800
I'm eating salad so it couldn't be that

242
00:10:33,800 --> 00:10:37,829
but we saw a particular case we saw a

243
00:10:37,829 --> 00:10:40,709
particular case where we had a customer

244
00:10:40,709 --> 00:10:42,029
comes to us and they're like yeah so

245
00:10:42,029 --> 00:10:45,120
someone's ordering a product and then

246
00:10:45,120 --> 00:10:47,970
they don't come pick it up and it's a

247
00:10:47,970 --> 00:10:49,709
it's a it's not a perishable it's like a

248
00:10:49,709 --> 00:10:51,899
soda or something and we thought that

249
00:10:51,899 --> 00:10:52,410
was weird

250
00:10:52,410 --> 00:10:55,439
and we see that several times per day at

251
00:10:55,439 --> 00:10:56,970
a whole bunch of our different stores

252
00:10:56,970 --> 00:10:58,769
and we're starting we're trying to

253
00:10:58,769 --> 00:11:00,240
figure out are they validating credit

254
00:11:00,240 --> 00:11:02,040
cards maybe they're validating a credit

255
00:11:02,040 --> 00:11:02,370
card

256
00:11:02,370 --> 00:11:03,960
and so they're buying something small

257
00:11:03,960 --> 00:11:06,210
that makes total sense but then we

258
00:11:06,210 --> 00:11:07,529
started to look and we saw this thing

259
00:11:07,529 --> 00:11:11,310
here order number equals one four five

260
00:11:11,310 --> 00:11:13,320
eight six and we're like okay let's

261
00:11:13,320 --> 00:11:16,080
start tracking these a little bit and

262
00:11:16,080 --> 00:11:19,200
then we saw the next order was order

263
00:11:19,200 --> 00:11:21,060
number one four five eight seven and

264
00:11:21,060 --> 00:11:23,700
we're like hmm this is quite interesting

265
00:11:23,700 --> 00:11:26,400
so effectively what someone was doing

266
00:11:26,400 --> 00:11:28,440
either a competitor or maybe someone

267
00:11:28,440 --> 00:11:31,529
trying to you know build a better burger

268
00:11:31,529 --> 00:11:34,830
they were hitting each of the branch

269
00:11:34,830 --> 00:11:37,140
locations in different markets and they

270
00:11:37,140 --> 00:11:38,850
could see how many orders were placed

271
00:11:38,850 --> 00:11:42,630
throughout the day and get a total order

272
00:11:42,630 --> 00:11:44,279
count of like what store was the most

273
00:11:44,279 --> 00:11:45,870
popular this was not either of these

274
00:11:45,870 --> 00:11:50,040
stores so but have you tried the

275
00:11:50,040 --> 00:11:52,440
impossible burger at Burger King it's

276
00:11:52,440 --> 00:11:55,920
awesome okay so maybe people are trading

277
00:11:55,920 --> 00:11:58,500
stocks finding out that hey Wow all of

278
00:11:58,500 --> 00:12:00,720
these locations their orders have

279
00:12:00,720 --> 00:12:03,360
dropped significantly because you know

280
00:12:03,360 --> 00:12:04,710
there's a new burger in town right

281
00:12:04,710 --> 00:12:08,220
that's that could be something so we

282
00:12:08,220 --> 00:12:09,959
we're trying to help them with that

283
00:12:09,959 --> 00:12:12,750
problem some of it is you know some of

284
00:12:12,750 --> 00:12:14,760
them are not just technology problems

285
00:12:14,760 --> 00:12:16,140
some of them are people problems that's

286
00:12:16,140 --> 00:12:19,140
obviously a big issue credential abuse

287
00:12:19,140 --> 00:12:20,520
raise your hand if your company is

288
00:12:20,520 --> 00:12:22,950
seeing credential abuse in the past six

289
00:12:22,950 --> 00:12:25,140
months okay the rest of your lives you

290
00:12:25,140 --> 00:12:28,410
all have okay so we took like a four

291
00:12:28,410 --> 00:12:32,040
month sample 34 million unit unique

292
00:12:32,040 --> 00:12:33,810
credentials were tried against 98

293
00:12:33,810 --> 00:12:38,070
different customers 67% of the total

294
00:12:38,070 --> 00:12:39,720
logins from during that time were

295
00:12:39,720 --> 00:12:43,220
fraudulent which i think is pretty scary

296
00:12:43,220 --> 00:12:45,420
the other thing that's scary is if

297
00:12:45,420 --> 00:12:47,400
you're in financial services attackers

298
00:12:47,400 --> 00:12:49,410
are targeting authentication

299
00:12:49,410 --> 00:12:52,290
methodologies that are built for like oh

300
00:12:52,290 --> 00:12:54,060
if X is built for the financial services

301
00:12:54,060 --> 00:12:56,600
industry ultimately and this is a little

302
00:12:56,600 --> 00:13:00,330
graph here of 21 million login attempts

303
00:13:00,330 --> 00:13:02,880
in just a few day period you'll see the

304
00:13:02,880 --> 00:13:06,360
time frame there 19 million um million

305
00:13:06,360 --> 00:13:09,209
of them were against ofx v1 end points

306
00:13:09,209 --> 00:13:13,290
and then 2.2 million were against ofx v2

307
00:13:13,290 --> 00:13:15,970
end points now what I think is really

308
00:13:15,970 --> 00:13:20,500
interesting 37% of the requests to v1

309
00:13:20,500 --> 00:13:25,120
endpoints were failures vs. 0.2% against

310
00:13:25,120 --> 00:13:28,480
v2 were six were failures so what that

311
00:13:28,480 --> 00:13:30,910
means is there might be something wrong

312
00:13:30,910 --> 00:13:34,680
with v2 that attackers are exploiting

313
00:13:34,680 --> 00:13:36,550
the other thing we're seeing is

314
00:13:36,550 --> 00:13:38,259
something called cypher stunting where

315
00:13:38,259 --> 00:13:42,040
attackers are randomizing TLS

316
00:13:42,040 --> 00:13:44,800
fingerprints over time and they do that

317
00:13:44,800 --> 00:13:48,100
one to avoid detection two to confuse

318
00:13:48,100 --> 00:13:51,370
any kind of automated rule sets things

319
00:13:51,370 --> 00:13:52,509
that are kicking in you'll see that

320
00:13:52,509 --> 00:13:57,360
there's a 95% of the time during this

321
00:13:57,360 --> 00:13:59,680
during this time frame which I think was

322
00:13:59,680 --> 00:14:01,480
the same time frame of that ten days or

323
00:14:01,480 --> 00:14:04,720
so we're seeing this it increased

324
00:14:04,720 --> 00:14:07,110
massively which i think is a big problem

325
00:14:07,110 --> 00:14:09,129
so where is this all coming from

326
00:14:09,129 --> 00:14:12,069
credential abuse is really a problem

327
00:14:12,069 --> 00:14:14,980
because there are other username and

328
00:14:14,980 --> 00:14:16,389
password databases that get breached

329
00:14:16,389 --> 00:14:18,819
people are like storing these in the

330
00:14:18,819 --> 00:14:20,949
clear which is obviously an issue if you

331
00:14:20,949 --> 00:14:22,449
go to any kind of forum you can do a

332
00:14:22,449 --> 00:14:24,790
search for combo lists which is like a

333
00:14:24,790 --> 00:14:26,829
huge text file that says username colon

334
00:14:26,829 --> 00:14:28,959
password or username comma password

335
00:14:28,959 --> 00:14:30,759
super fun to see what some people's

336
00:14:30,759 --> 00:14:33,910
passwords are and where this happens in

337
00:14:33,910 --> 00:14:36,819
the I was going to like hash tag like

338
00:14:36,819 --> 00:14:39,370
you know credential abuse lifecycle but

339
00:14:39,370 --> 00:14:41,740
this is kind of you know the anatomy of

340
00:14:41,740 --> 00:14:45,519
credential abuse they find stolen

341
00:14:45,519 --> 00:14:47,769
credentials they import them and they

342
00:14:47,769 --> 00:14:50,079
create a botnet that is going to make

343
00:14:50,079 --> 00:14:51,339
these requests from a bunch of different

344
00:14:51,339 --> 00:14:54,819
IP addresses and these are full this is

345
00:14:54,819 --> 00:14:56,620
not like a DDoS attack these are full

346
00:14:56,620 --> 00:14:58,180
like layer seven connections where

347
00:14:58,180 --> 00:14:59,949
they're they're looking like a real user

348
00:14:59,949 --> 00:15:03,279
there they're copying the header

349
00:15:03,279 --> 00:15:05,079
structure of whatever browser type

350
00:15:05,079 --> 00:15:07,660
they're there pretending to be and then

351
00:15:07,660 --> 00:15:09,699
the next step would be if they get a

352
00:15:09,699 --> 00:15:12,459
successful login they then resell that

353
00:15:12,459 --> 00:15:16,569
list for more money and then the end

354
00:15:16,569 --> 00:15:18,639
goal is to do something with that login

355
00:15:18,639 --> 00:15:22,059
right so sniper is one of the attack

356
00:15:22,059 --> 00:15:25,389
tools this is what I'm doing pretty good

357
00:15:25,389 --> 00:15:27,699
on time this is awesome sniper is one of

358
00:15:27,699 --> 00:15:29,770
the attack tools it's an automated tool

359
00:15:29,770 --> 00:15:32,950
that really you don't have to know what

360
00:15:32,950 --> 00:15:36,550
you're doing to use it the config files

361
00:15:36,550 --> 00:15:41,530
are pointing to login endpoints and most

362
00:15:41,530 --> 00:15:46,200
of time their API login endpoints and

363
00:15:46,200 --> 00:15:49,210
basically you load up the the file the

364
00:15:49,210 --> 00:15:52,090
config is specific for each customer

365
00:15:52,090 --> 00:15:53,500
you're attacking or each account you're

366
00:15:53,500 --> 00:15:55,840
attacking and then you press go and then

367
00:15:55,840 --> 00:15:57,070
all the sudden you get this list spit

368
00:15:57,070 --> 00:15:58,600
out that says these have a green

369
00:15:58,600 --> 00:16:01,120
checkmark they're successful you can't

370
00:16:01,120 --> 00:16:02,710
get much easier than that so this is why

371
00:16:02,710 --> 00:16:04,720
all of you that were lying about not

372
00:16:04,720 --> 00:16:05,920
getting attacked while you're getting

373
00:16:05,920 --> 00:16:07,870
attacked the other thing that's

374
00:16:07,870 --> 00:16:10,180
interesting is you say well just block

375
00:16:10,180 --> 00:16:12,100
the IPS man let's go old-school you know

376
00:16:12,100 --> 00:16:14,680
I got my my fat pipe or my big IP and

377
00:16:14,680 --> 00:16:16,870
I'm just gonna you know nothing against

378
00:16:16,870 --> 00:16:17,770
those company I don't even know if

379
00:16:17,770 --> 00:16:21,370
they're still around but single-use IP

380
00:16:21,370 --> 00:16:23,770
addresses so IP addresses that are only

381
00:16:23,770 --> 00:16:26,470
used once in a 24 hour time frame that's

382
00:16:26,470 --> 00:16:29,350
increasing massively that's typically

383
00:16:29,350 --> 00:16:30,370
because I'm not going to read through

384
00:16:30,370 --> 00:16:31,600
all this but it's typically because

385
00:16:31,600 --> 00:16:34,750
attackers are taking control of

386
00:16:34,750 --> 00:16:37,270
vulnerable IOT devices that live within

387
00:16:37,270 --> 00:16:40,300
your home IP range and now they have

388
00:16:40,300 --> 00:16:43,630
like a plethora of like thermostats and

389
00:16:43,630 --> 00:16:46,840
pet feeders and you know toasters and

390
00:16:46,840 --> 00:16:50,290
stuff that they use and they basically

391
00:16:50,290 --> 00:16:52,150
create a proxy they're all running you

392
00:16:52,150 --> 00:16:53,500
know embedded Linux so they create a

393
00:16:53,500 --> 00:16:56,830
socks proxy and then those same attack

394
00:16:56,830 --> 00:16:58,840
tools they're tunneled through each of

395
00:16:58,840 --> 00:17:01,600
these IOT devices and again this is not

396
00:17:01,600 --> 00:17:04,720
like like a network based DDoS they're

397
00:17:04,720 --> 00:17:08,800
making full HTTP requests against so

398
00:17:08,800 --> 00:17:10,240
they're taking things like sentry MBA

399
00:17:10,240 --> 00:17:12,490
and they're automating those requests to

400
00:17:12,490 --> 00:17:13,810
look like they're coming from a bunch of

401
00:17:13,810 --> 00:17:18,550
different random home IP addresses so of

402
00:17:18,550 --> 00:17:22,569
the campaign analysis we saw that API

403
00:17:22,569 --> 00:17:25,089
entry points or attacks four times more

404
00:17:25,089 --> 00:17:27,459
often that's because a lot of people are

405
00:17:27,459 --> 00:17:28,900
saying well you know it's it's the

406
00:17:28,900 --> 00:17:31,090
mobile app you know god forbid i you

407
00:17:31,090 --> 00:17:32,980
know make a resume-writing opportunity

408
00:17:32,980 --> 00:17:34,870
and like implement a wife rule that

409
00:17:34,870 --> 00:17:36,120
blocks all of our mobile traffic

410
00:17:36,120 --> 00:17:38,380
probably you know get kicked to the curb

411
00:17:38,380 --> 00:17:40,690
pretty quick the other thing is that

412
00:17:40,690 --> 00:17:43,150
because api's are built for

413
00:17:43,150 --> 00:17:45,630
Automation attackers are using

414
00:17:45,630 --> 00:17:48,940
automation to their advantage so one of

415
00:17:48,940 --> 00:17:51,280
the examples is a IO bot so these are

416
00:17:51,280 --> 00:17:52,380
all in one BOTS

417
00:17:52,380 --> 00:17:55,300
and effectively these are kind of like a

418
00:17:55,300 --> 00:17:57,460
mix between account checking and

419
00:17:57,460 --> 00:17:59,920
validation tools inventory sniping and

420
00:17:59,920 --> 00:18:04,270
cart checkout tools payments and

421
00:18:04,270 --> 00:18:06,490
validation tools and then like a full

422
00:18:06,490 --> 00:18:08,950
shipping profile and everything so one

423
00:18:08,950 --> 00:18:10,210
of them I thought was interesting is

424
00:18:10,210 --> 00:18:14,110
called cyber a IO and that the tool is

425
00:18:14,110 --> 00:18:16,240
actually called cyber soul this is

426
00:18:16,240 --> 00:18:18,790
hitting like sneaker brands high-end

427
00:18:18,790 --> 00:18:21,280
apparel brands etc and the way it works

428
00:18:21,280 --> 00:18:25,480
you can buy it for really cheap also but

429
00:18:25,480 --> 00:18:26,410
the way it works is it has a

430
00:18:26,410 --> 00:18:29,740
configuration and it says ok this is

431
00:18:29,740 --> 00:18:33,490
what we're gonna do we're going to put

432
00:18:33,490 --> 00:18:37,180
in payment details delivery details you

433
00:18:37,180 --> 00:18:40,180
know separate billing configurations so

434
00:18:40,180 --> 00:18:43,300
that you know if you're doing a batch

435
00:18:43,300 --> 00:18:45,220
and one of the payment cards gets

436
00:18:45,220 --> 00:18:46,570
declined you can switch to another

437
00:18:46,570 --> 00:18:48,850
payment profile and you can even start

438
00:18:48,850 --> 00:18:50,950
to customize who it's going to be

439
00:18:50,950 --> 00:18:52,540
shipped to depending on which card got

440
00:18:52,540 --> 00:18:55,420
paid etc it's quite I think it's cool

441
00:18:55,420 --> 00:18:57,250
but never say that in a client meeting

442
00:18:57,250 --> 00:18:58,780
I'm like this is so awesome how they're

443
00:18:58,780 --> 00:19:01,660
doing this I mean it'd be awesome if it

444
00:19:01,660 --> 00:19:03,850
wasn't happening to you but when you

445
00:19:03,850 --> 00:19:06,160
look at the configs of these and you

446
00:19:06,160 --> 00:19:09,100
open them up they're all like this drop

447
00:19:09,100 --> 00:19:11,050
down for like what size and all this

448
00:19:11,050 --> 00:19:13,420
stuff it's it's literally hitting the

449
00:19:13,420 --> 00:19:17,970
API resource of this this client and

450
00:19:17,970 --> 00:19:22,360
it's giving you feedback so like you

451
00:19:22,360 --> 00:19:24,460
choose your your size you choose what

452
00:19:24,460 --> 00:19:30,250
products color etc so this problem is so

453
00:19:30,250 --> 00:19:32,530
pervasive that they've created many

454
00:19:32,530 --> 00:19:34,300
different tools this is just for

455
00:19:34,300 --> 00:19:37,450
attacking customers on the Shopify

456
00:19:37,450 --> 00:19:41,440
platform and again you know you guys

457
00:19:41,440 --> 00:19:43,270
know how it is in the hacking community

458
00:19:43,270 --> 00:19:46,900
like anyone who's already using this to

459
00:19:46,900 --> 00:19:48,670
hurt someone it already knows about it

460
00:19:48,670 --> 00:19:50,620
so I'm trying to tell people about it

461
00:19:50,620 --> 00:19:53,140
because I don't want you to be hurt I

462
00:19:53,140 --> 00:19:54,419
care

463
00:19:54,419 --> 00:19:57,149
but if you look at how these bot tasks

464
00:19:57,149 --> 00:20:01,769
are configured they're all API base this

465
00:20:01,769 --> 00:20:08,130
is from the cyber sole manual so for

466
00:20:08,130 --> 00:20:09,630
what a git looks like for what a post

467
00:20:09,630 --> 00:20:12,779
looks like they even have like customer

468
00:20:12,779 --> 00:20:17,399
service resources that say you know I'll

469
00:20:17,399 --> 00:20:18,960
get to them in a second they even have

470
00:20:18,960 --> 00:20:24,419
you know resources that say they've been

471
00:20:24,419 --> 00:20:26,490
tuning their rate controls a lot lower

472
00:20:26,490 --> 00:20:29,039
so make sure that you dial that down

473
00:20:29,039 --> 00:20:32,639
even even more so this next one is not

474
00:20:32,639 --> 00:20:33,990
going to build right I can already tell

475
00:20:33,990 --> 00:20:38,100
but effectively within Shopify they have

476
00:20:38,100 --> 00:20:41,760
a CAPTCHA queue so when you get a

477
00:20:41,760 --> 00:20:43,919
CAPTCHA response what happens and this

478
00:20:43,919 --> 00:20:45,690
would have been really funny you know

479
00:20:45,690 --> 00:20:48,210
when you get a CAPTCHA response and says

480
00:20:48,210 --> 00:20:50,100
click the you know click the boxes that

481
00:20:50,100 --> 00:20:51,990
have a street sign and then there's like

482
00:20:51,990 --> 00:20:53,490
the little edge of one that has a little

483
00:20:53,490 --> 00:20:54,630
bit of a street sign and you're like

484
00:20:54,630 --> 00:20:55,799
sweating because you don't know if you

485
00:20:55,799 --> 00:20:57,870
should click it or not that's what this

486
00:20:57,870 --> 00:21:00,450
was supposed to be I'm glad you left so

487
00:21:00,450 --> 00:21:02,730
one of the options for Google reCAPTCHA

488
00:21:02,730 --> 00:21:07,100
is to open up YouTube with an account

489
00:21:07,100 --> 00:21:10,830
you log in again lots of jokes here in

490
00:21:10,830 --> 00:21:12,929
the back so when you open up YouTube and

491
00:21:12,929 --> 00:21:15,840
you start watching an actual stream what

492
00:21:15,840 --> 00:21:17,460
happens is you get kind of like user

493
00:21:17,460 --> 00:21:20,779
liveliness tokens so that when you get a

494
00:21:20,779 --> 00:21:22,860
reCAPTCHA instead of getting the street

495
00:21:22,860 --> 00:21:24,840
sign which is you know real problematic

496
00:21:24,840 --> 00:21:26,880
for automation you get the I'm not a

497
00:21:26,880 --> 00:21:28,260
robot you know and then you can have

498
00:21:28,260 --> 00:21:30,330
that hot dog spinning around is that

499
00:21:30,330 --> 00:21:31,919
what it was or that was that was

500
00:21:31,919 --> 00:21:33,870
something else but you can basically

501
00:21:33,870 --> 00:21:35,669
automate that I'm not a robot push

502
00:21:35,669 --> 00:21:40,350
button super easily so these are you

503
00:21:40,350 --> 00:21:42,120
know I'm really impressed with the time

504
00:21:42,120 --> 00:21:45,710
here these are just a couple resources

505
00:21:45,710 --> 00:21:48,000
it wouldn't be fair to talk about this

506
00:21:48,000 --> 00:21:52,460
without going for a blue team overview

507
00:21:52,460 --> 00:21:54,570
obviously one of the big issues that

508
00:21:54,570 --> 00:21:58,200
that that are really common is that API

509
00:21:58,200 --> 00:22:01,110
endpoints if you have just say like a

510
00:22:01,110 --> 00:22:03,330
picture frame that logs in automatically

511
00:22:03,330 --> 00:22:07,169
and it pools images versus an endpoint

512
00:22:07,169 --> 00:22:08,160
that has a

513
00:22:08,160 --> 00:22:11,420
in and it's a transactional webpage

514
00:22:11,420 --> 00:22:13,980
those are two different use cases and

515
00:22:13,980 --> 00:22:15,900
lots of times organizations they build

516
00:22:15,900 --> 00:22:17,430
out things so fast and they've got so

517
00:22:17,430 --> 00:22:19,110
much kind of technical debt that those

518
00:22:19,110 --> 00:22:22,010
endpoints exist on the same URL

519
00:22:22,010 --> 00:22:24,600
effectively so now it's very hard to

520
00:22:24,600 --> 00:22:27,000
separate and say okay we're gonna do API

521
00:22:27,000 --> 00:22:28,830
key management we're gonna do some cores

522
00:22:28,830 --> 00:22:31,230
rule sets to make sure that you're not

523
00:22:31,230 --> 00:22:33,240
you know commingling these these

524
00:22:33,240 --> 00:22:35,190
requests it's very hard to separate

525
00:22:35,190 --> 00:22:37,140
those out so in any case that you can

526
00:22:37,140 --> 00:22:39,780
try to be sure that you're separating

527
00:22:39,780 --> 00:22:43,260
mobile logins from you know automated

528
00:22:43,260 --> 00:22:47,180
machine to machine logins for you know

529
00:22:47,180 --> 00:22:51,450
maybe social login capabilities you want

530
00:22:51,450 --> 00:22:53,700
to separate those out from your normal

531
00:22:53,700 --> 00:22:55,140
logins and if you guys want to learn

532
00:22:55,140 --> 00:22:59,280
more about API security pixie project

533
00:22:59,280 --> 00:23:02,490
from a wasp is really cool and that is

534
00:23:02,490 --> 00:23:07,110
it I am open to any questions if you

535
00:23:07,110 --> 00:23:10,159
have any yes

536
00:23:18,500 --> 00:23:22,440
Thanks so I do a lot of API work but I

537
00:23:22,440 --> 00:23:24,270
think I do it more granularly like per

538
00:23:24,270 --> 00:23:25,890
client and the thing I see the most

539
00:23:25,890 --> 00:23:28,380
often is like access control problems I

540
00:23:28,380 --> 00:23:30,300
can't count the number of times I've

541
00:23:30,300 --> 00:23:32,640
looked at an API and the only access

542
00:23:32,640 --> 00:23:34,080
control checks is whether or not the

543
00:23:34,080 --> 00:23:35,520
users logged in so you can access

544
00:23:35,520 --> 00:23:38,040
anybody else's resources yeah do you do

545
00:23:38,040 --> 00:23:40,860
you get to see that pretty often or yeah

546
00:23:40,860 --> 00:23:41,640
yeah I do

547
00:23:41,640 --> 00:23:44,340
so you know access controls it is a

548
00:23:44,340 --> 00:23:47,940
really big issue it's funny because

549
00:23:47,940 --> 00:23:51,270
these same problems are the same if you

550
00:23:51,270 --> 00:23:52,680
guys have ever worked with like web goat

551
00:23:52,680 --> 00:23:54,240
or any kind of like intentionally

552
00:23:54,240 --> 00:24:00,930
vulnerable websites it's so Commons that

553
00:24:00,930 --> 00:24:03,000
you can log in as one user and then you

554
00:24:03,000 --> 00:24:05,400
changing the URI and then you get access

555
00:24:05,400 --> 00:24:08,130
to another users profile etc that's

556
00:24:08,130 --> 00:24:10,020
super common there's there's a whole

557
00:24:10,020 --> 00:24:11,700
slew of things that have to be done to

558
00:24:11,700 --> 00:24:15,090
correct those problems but if you're

559
00:24:15,090 --> 00:24:17,580
working in this space you see how simply

560
00:24:17,580 --> 00:24:18,840
these things can be bypassed the

561
00:24:18,840 --> 00:24:20,520
attackers are doing it all day long and

562
00:24:20,520 --> 00:24:24,030
there's little to no Intel feedback from

563
00:24:24,030 --> 00:24:25,920
the you know the operator side from the

564
00:24:25,920 --> 00:24:28,140
blue team side that it's happening like

565
00:24:28,140 --> 00:24:30,410
unless there's some egregious you know

566
00:24:30,410 --> 00:24:32,970
outcome on a web server or with an

567
00:24:32,970 --> 00:24:34,140
account

568
00:24:34,140 --> 00:24:35,760
you wouldn't know what's happening it's

569
00:24:35,760 --> 00:24:40,560
so subtle so yes the prom exists all

570
00:24:40,560 --> 00:24:42,930
right thank you Tony all right thank you

571
00:24:42,930 --> 00:24:45,030
everybody we're gonna be moving out to

572
00:24:45,030 --> 00:24:49,380
the back patio that was amazing I can't

573
00:24:49,380 --> 00:24:50,760
believe you turn the lightning talk into

574
00:24:50,760 --> 00:24:54,080
a full 25 minute

575
00:24:54,770 --> 00:25:04,079
[Applause]

576
00:25:04,270 --> 00:25:06,650
and you can follow me to head up the

577
00:25:06,650 --> 00:25:09,580
back patio or follow Tony

