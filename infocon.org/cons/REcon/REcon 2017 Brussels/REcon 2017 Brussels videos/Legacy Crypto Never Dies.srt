1
00:00:01,650 --> 00:00:13,309
[Music]

2
00:00:08,179 --> 00:00:13,309
<font color="#E5E5E5">we</font><font color="#CCCCCC"> gone 2017</font>

3
00:00:20,480 --> 00:00:26,490
<font color="#E5E5E5">all right so</font>

4
00:00:22,860 --> 00:00:29,310
<font color="#CCCCCC">holton I have done a lot of FPGA crypto</font>

5
00:00:26,490 --> 00:00:33,720
cracking stuff and I also run<font color="#CCCCCC"> to work</font><font color="#E5E5E5"> on</font>

6
00:00:29,310 --> 00:00:36,019
conference in San Diego and so this is

7
00:00:33,720 --> 00:00:37,530
called a legacy crypto<font color="#E5E5E5"> never dies but</font>

8
00:00:36,020 --> 00:00:40,950
subtitles

9
00:00:37,530 --> 00:00:42,120
why won't<font color="#E5E5E5"> des just die like</font><font color="#CCCCCC"> why why are</font>

10
00:00:40,950 --> 00:00:45,900
we<font color="#E5E5E5"> still dealing</font><font color="#CCCCCC"> with dealing with</font><font color="#E5E5E5"> this</font>

11
00:00:42,120 --> 00:00:48,660
crap<font color="#E5E5E5"> so did anybody see</font><font color="#CCCCCC"> my presentation</font>

12
00:00:45,900 --> 00:00:51,330
<font color="#E5E5E5">2012 with Moxie Marlinspike</font><font color="#CCCCCC"> just trying</font>

13
00:00:48,660 --> 00:00:53,339
<font color="#E5E5E5">to see okay cool</font><font color="#CCCCCC"> so I'll go over</font><font color="#E5E5E5"> a</font>

14
00:00:51,330 --> 00:00:56,160
little<font color="#E5E5E5"> bit of this but basically we</font>

15
00:00:53,340 --> 00:00:59,400
presented a<font color="#E5E5E5"> number of years ago on under</font>

16
00:00:56,160 --> 00:01:00,480
<font color="#CCCCCC">percent break-in</font><font color="#E5E5E5"> mschap v2 and for those</font>

17
00:00:59,400 --> 00:01:02,040
who might<font color="#E5E5E5"> not be familiar</font><font color="#CCCCCC"> with</font><font color="#E5E5E5"> the</font>

18
00:01:00,480 --> 00:01:03,720
protocol it provides mutual

19
00:01:02,040 --> 00:01:06,479
authentication for a number<font color="#E5E5E5"> of different</font>

20
00:01:03,720 --> 00:01:10,770
things<font color="#E5E5E5"> the things that we specifically</font>

21
00:01:06,479 --> 00:01:13,890
focused on were PPTP VPN and wpa2

22
00:01:10,770 --> 00:01:15,420
<font color="#CCCCCC">enterprise but we</font><font color="#E5E5E5"> quickly found out</font>

23
00:01:13,890 --> 00:01:17,790
there's a number<font color="#E5E5E5"> of other things to use</font>

24
00:01:15,420 --> 00:01:21,720
it as well<font color="#CCCCCC"> and this</font><font color="#E5E5E5"> research was nothing</font>

25
00:01:17,790 --> 00:01:23,270
new actually<font color="#E5E5E5"> in 99</font><font color="#CCCCCC"> you know Mudge and</font>

26
00:01:21,720 --> 00:01:25,950
Bruce Schneier and David Wagner

27
00:01:23,270 --> 00:01:29,580
published a paper that<font color="#E5E5E5"> spelled out all</font>

28
00:01:25,950 --> 00:01:32,100
these<font color="#E5E5E5"> problems</font><font color="#CCCCCC"> and and</font><font color="#E5E5E5"> basically stated</font>

29
00:01:29,580 --> 00:01:33,780
that<font color="#E5E5E5"> you know at the time state actors</font>

30
00:01:32,100 --> 00:01:36,539
and well-funded groups could<font color="#E5E5E5"> easily</font>

31
00:01:33,780 --> 00:01:39,780
break this and so so this is by<font color="#E5E5E5"> no means</font>

32
00:01:36,540 --> 00:01:42,780
new research<font color="#E5E5E5"> we just kind of looked</font><font color="#CCCCCC"> into</font>

33
00:01:39,780 --> 00:01:44,490
it a little<font color="#E5E5E5"> bit</font><font color="#CCCCCC"> more so if you aren't</font>

34
00:01:42,780 --> 00:01:46,850
<font color="#E5E5E5">that familiar with mschap v2 the basic</font>

35
00:01:44,490 --> 00:01:49,229
idea<font color="#CCCCCC"> is that</font><font color="#E5E5E5"> it's a challenge</font><font color="#CCCCCC"> response</font>

36
00:01:46,850 --> 00:01:52,408
<font color="#E5E5E5">authentication protocol that involves a</font>

37
00:01:49,229 --> 00:01:56,360
password so actually sent across the

38
00:01:52,409 --> 00:01:59,100
network you have<font color="#E5E5E5"> your challenge and</font>

39
00:01:56,360 --> 00:02:01,590
which is essentially your known

40
00:01:59,100 --> 00:02:03,030
plaintext<font color="#E5E5E5"> and and then you have</font><font color="#CCCCCC"> a</font>

41
00:02:01,590 --> 00:02:05,340
response which is essentially<font color="#CCCCCC"> your</font>

42
00:02:03,030 --> 00:02:08,580
<font color="#E5E5E5">cipher text and and so</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> know</font><font color="#CCCCCC"> all this</font>

43
00:02:05,340 --> 00:02:11,610
information<font color="#CCCCCC"> and all</font><font color="#E5E5E5"> of this is basically</font>

44
00:02:08,580 --> 00:02:14,910
<font color="#E5E5E5">based on a password</font><font color="#CCCCCC"> that turns into an</font>

45
00:02:11,610 --> 00:02:17,640
NT hash through<font color="#E5E5E5"> md4 and and then creates</font>

46
00:02:14,910 --> 00:02:20,430
your 128-bit key that's used to to

47
00:02:17,640 --> 00:02:22,619
create<font color="#CCCCCC"> your challenge response</font><font color="#E5E5E5"> and so up</font>

48
00:02:20,430 --> 00:02:25,440
until we gave our talk people<font color="#E5E5E5"> were</font>

49
00:02:22,620 --> 00:02:26,790
attacking the user<font color="#E5E5E5"> password by you know</font>

50
00:02:25,440 --> 00:02:29,489
doing<font color="#E5E5E5"> dictionary attacks or they would</font>

51
00:02:26,790 --> 00:02:32,250
try all the weak passwords<font color="#E5E5E5"> in order to</font>

52
00:02:29,489 --> 00:02:34,260
crack the<font color="#CCCCCC"> password that's used for these</font>

53
00:02:32,250 --> 00:02:36,690
sorts of things<font color="#E5E5E5"> so if you actually</font>

54
00:02:34,260 --> 00:02:38,220
<font color="#E5E5E5">analyze like doing a full break on this</font>

55
00:02:36,690 --> 00:02:42,510
using the password<font color="#E5E5E5"> it's you know</font>

56
00:02:38,220 --> 00:02:45,000
somewhere around<font color="#E5E5E5"> you know</font><font color="#CCCCCC"> 92 bits worth</font>

57
00:02:42,510 --> 00:02:47,489
of you know<font color="#E5E5E5"> passwords you have to search</font>

58
00:02:45,000 --> 00:02:50,160
<font color="#CCCCCC">through which is you know</font><font color="#E5E5E5"> really</font>

59
00:02:47,490 --> 00:02:51,810
<font color="#CCCCCC">difficult to do and so up until this</font>

60
00:02:50,160 --> 00:02:53,070
<font color="#E5E5E5">point you know it's pretty much as a</font>

61
00:02:51,810 --> 00:02:55,380
password<font color="#E5E5E5"> based attack and there were</font>

62
00:02:53,070 --> 00:02:57,900
<font color="#E5E5E5">they're just finding</font><font color="#CCCCCC"> uh</font><font color="#E5E5E5"> only finding</font>

63
00:02:55,380 --> 00:03:00,480
passwords that were really weak<font color="#CCCCCC"> and so</font>

64
00:02:57,900 --> 00:03:01,860
this paper<font color="#CCCCCC"> basically said you know why</font>

65
00:03:00,480 --> 00:03:03,720
attack that when you can attack<font color="#E5E5E5"> the</font>

66
00:03:01,860 --> 00:03:06,060
password equivalent which is<font color="#CCCCCC"> as NT hash</font>

67
00:03:03,720 --> 00:03:08,010
and<font color="#E5E5E5"> the NT hash is actually split into</font>

68
00:03:06,060 --> 00:03:10,380
three separate keys<font color="#CCCCCC"> they're used</font><font color="#E5E5E5"> to</font>

69
00:03:08,010 --> 00:03:13,260
<font color="#CCCCCC">encrypt</font><font color="#E5E5E5"> the same plaintext</font><font color="#CCCCCC"> let's</font>

70
00:03:10,380 --> 00:03:15,890
<font color="#E5E5E5">challenge hash up here so</font><font color="#CCCCCC"> so you</font><font color="#E5E5E5"> can</font>

71
00:03:13,260 --> 00:03:18,390
basically crack these independently<font color="#E5E5E5"> and</font>

72
00:03:15,890 --> 00:03:20,309
the basic<font color="#E5E5E5"> idea here is that you know</font>

73
00:03:18,390 --> 00:03:21,359
it's three independent des<font color="#CCCCCC"> operations so</font>

74
00:03:20,310 --> 00:03:22,980
they<font color="#CCCCCC"> claimed you know it would</font><font color="#E5E5E5"> be</font>

75
00:03:21,360 --> 00:03:25,020
roughly around<font color="#E5E5E5"> two to the</font><font color="#CCCCCC"> fifty-seven</font>

76
00:03:22,980 --> 00:03:29,489
<font color="#E5E5E5">that you would have to</font><font color="#CCCCCC"> brute-force in</font>

77
00:03:25,020 --> 00:03:31,680
<font color="#E5E5E5">order to to break this NT hash and so we</font>

78
00:03:29,490 --> 00:03:35,580
started looking at<font color="#E5E5E5"> this and when you're</font>

79
00:03:31,680 --> 00:03:37,050
actually<font color="#E5E5E5"> implementing this</font><font color="#CCCCCC"> you know we</font>

80
00:03:35,580 --> 00:03:39,390
have<font color="#CCCCCC"> the exact same plaintext for both</font>

81
00:03:37,050 --> 00:03:41,670
these does operations so naive it naive

82
00:03:39,390 --> 00:03:44,279
implementation is<font color="#CCCCCC"> that you would crack</font>

83
00:03:41,670 --> 00:03:47,549
<font color="#E5E5E5">these independently and do</font><font color="#CCCCCC"> two full</font><font color="#E5E5E5"> you</font>

84
00:03:44,280 --> 00:03:50,070
<font color="#CCCCCC">know des brute forces but it's super</font>

85
00:03:47,550 --> 00:03:51,750
<font color="#CCCCCC">easy</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> just basically encrypt your put</font>

86
00:03:50,070 --> 00:03:54,000
<font color="#E5E5E5">the</font><font color="#CCCCCC"> same plaintext and then just do</font><font color="#E5E5E5"> two</font>

87
00:03:51,750 --> 00:03:55,620
compares after that so it's<font color="#E5E5E5"> really</font><font color="#CCCCCC"> just</font>

88
00:03:54,000 --> 00:03:57,690
<font color="#CCCCCC">two to the fifty six you only</font><font color="#E5E5E5"> go through</font>

89
00:03:55,620 --> 00:03:59,430
the<font color="#E5E5E5"> key</font><font color="#CCCCCC"> space once</font><font color="#E5E5E5"> worst case in order</font>

90
00:03:57,690 --> 00:04:01,680
<font color="#CCCCCC">to</font><font color="#E5E5E5"> crack both of these keys and the</font>

91
00:03:59,430 --> 00:04:06,690
third key<font color="#CCCCCC"> is only sixteen bits so that</font>

92
00:04:01,680 --> 00:04:09,390
that can<font color="#E5E5E5"> be easily</font><font color="#CCCCCC"> brute-force and so we</font>

93
00:04:06,690 --> 00:04:10,500
basically<font color="#CCCCCC"> demonstrated that this</font><font color="#E5E5E5"> can</font>

94
00:04:09,390 --> 00:04:13,049
actually<font color="#E5E5E5"> be cracked</font><font color="#CCCCCC"> with two of the</font>

95
00:04:10,500 --> 00:04:14,489
<font color="#CCCCCC">fifty-six does computations</font><font color="#E5E5E5"> but</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> think</font>

96
00:04:13,050 --> 00:04:16,380
<font color="#CCCCCC">the cool thing about this</font><font color="#E5E5E5"> presentation</font>

97
00:04:14,489 --> 00:04:17,880
is<font color="#CCCCCC"> that we made this accessible to</font>

98
00:04:16,380 --> 00:04:21,329
everybody instead<font color="#E5E5E5"> of just well-funded</font>

99
00:04:17,880 --> 00:04:24,150
groups and so really software where<font color="#CCCCCC"> you</font>

100
00:04:21,329 --> 00:04:26,659
could<font color="#E5E5E5"> point it toward a you know capture</font>

101
00:04:24,150 --> 00:04:28,979
<font color="#E5E5E5">of a PB TP connection and then it would</font>

102
00:04:26,660 --> 00:04:31,200
extract out<font color="#CCCCCC"> the key material and create</font>

103
00:04:28,980 --> 00:04:32,940
<font color="#CCCCCC">the session token but then you could</font>

104
00:04:31,200 --> 00:04:34,560
<font color="#E5E5E5">submit to</font><font color="#CCCCCC"> cloud cracker comm which was</font>

105
00:04:32,940 --> 00:04:37,500
<font color="#CCCCCC">moxie service that he had running</font><font color="#E5E5E5"> and</font>

106
00:04:34,560 --> 00:04:39,210
then in the<font color="#E5E5E5"> backend that would run on an</font>

107
00:04:37,500 --> 00:04:43,590
FPGA cluster<font color="#E5E5E5"> that I had in my basement</font>

108
00:04:39,210 --> 00:04:45,840
<font color="#CCCCCC">and</font><font color="#E5E5E5"> so so the this basically made it</font>

109
00:04:43,590 --> 00:04:47,729
<font color="#CCCCCC">accessible for everybody we wanted</font><font color="#E5E5E5"> to</font>

110
00:04:45,840 --> 00:04:49,599
<font color="#E5E5E5">kind of rate limited so we started</font>

111
00:04:47,729 --> 00:04:52,270
charging $20 for<font color="#E5E5E5"> it</font>

112
00:04:49,600 --> 00:04:54,700
a<font color="#E5E5E5"> lot of people think that des is</font>

113
00:04:52,270 --> 00:04:56,289
<font color="#E5E5E5">relatively easy to break because</font><font color="#CCCCCC"> you</font>

114
00:04:54,700 --> 00:04:59,110
know<font color="#CCCCCC"> people</font><font color="#E5E5E5"> are doing it back in 1999</font>

115
00:04:56,290 --> 00:05:02,170
<font color="#CCCCCC">and just for reference</font><font color="#E5E5E5"> the FF des</font>

116
00:04:59,110 --> 00:05:04,300
cracker<font color="#E5E5E5"> ran</font><font color="#CCCCCC"> around 90 billion keys per</font>

117
00:05:02,170 --> 00:05:06,070
second<font color="#E5E5E5"> and took about nine point two</font>

118
00:05:04,300 --> 00:05:10,390
days to go<font color="#CCCCCC"> through the whole key</font><font color="#E5E5E5"> space</font>

119
00:05:06,070 --> 00:05:14,260
and we were targeting something<font color="#E5E5E5"> around</font>

120
00:05:10,390 --> 00:05:16,630
24<font color="#CCCCCC"> hours to do</font><font color="#E5E5E5"> force the full key so for</font>

121
00:05:14,260 --> 00:05:17,670
24 hours<font color="#E5E5E5"> just</font><font color="#CCCCCC"> doing</font><font color="#E5E5E5"> some benchmarks with</font>

122
00:05:16,630 --> 00:05:21,040
AWS

123
00:05:17,670 --> 00:05:23,320
<font color="#CCCCCC">it would take around</font><font color="#E5E5E5"> 80,000 CPU cores</font><font color="#CCCCCC"> in</font>

124
00:05:21,040 --> 00:05:25,750
order<font color="#E5E5E5"> to brute force des in 24 hours and</font>

125
00:05:23,320 --> 00:05:28,240
that's around<font color="#E5E5E5"> 125,000 dollars worth of</font>

126
00:05:25,750 --> 00:05:29,290
AWS credits which I<font color="#E5E5E5"> imagine they give</font>

127
00:05:28,240 --> 00:05:31,960
you a<font color="#CCCCCC"> little</font><font color="#E5E5E5"> bit of</font><font color="#CCCCCC"> a discount</font><font color="#E5E5E5"> if you</font>

128
00:05:29,290 --> 00:05:34,930
buy bulk like that<font color="#E5E5E5"> and then we looked at</font>

129
00:05:31,960 --> 00:05:38,159
<font color="#E5E5E5">the GPU instances and that's around</font><font color="#CCCCCC"> 1800</font>

130
00:05:34,930 --> 00:05:42,540
GPUs<font color="#E5E5E5"> or around</font><font color="#CCCCCC"> 6 months</font><font color="#E5E5E5"> on one GPU and</font>

131
00:05:38,160 --> 00:05:45,280
<font color="#CCCCCC">in AWS credits that's around</font><font color="#E5E5E5"> $20,000 and</font>

132
00:05:42,540 --> 00:05:47,110
on the system that<font color="#CCCCCC"> I had was just random</font>

133
00:05:45,280 --> 00:05:50,440
<font color="#CCCCCC">hardware for my company that</font><font color="#E5E5E5"> we can</font>

134
00:05:47,110 --> 00:05:52,630
resell<font color="#E5E5E5"> I managed</font><font color="#CCCCCC"> to scrounge together 48</font>

135
00:05:50,440 --> 00:05:55,090
<font color="#E5E5E5">FPGAs</font><font color="#CCCCCC"> and normally a system</font><font color="#E5E5E5"> like this</font>

136
00:05:52,630 --> 00:05:57,580
would sell for<font color="#CCCCCC"> over $100,000 but I</font>

137
00:05:55,090 --> 00:05:59,590
managed to kind<font color="#E5E5E5"> of borrow the hardware</font>

138
00:05:57,580 --> 00:06:02,560
and<font color="#CCCCCC"> put on my basement and</font><font color="#E5E5E5"> and so we</font>

139
00:05:59,590 --> 00:06:04,539
offered this<font color="#E5E5E5"> for $20 a key as a picture</font>

140
00:06:02,560 --> 00:06:08,590
<font color="#E5E5E5">of it in</font><font color="#CCCCCC"> my</font><font color="#E5E5E5"> basement so it's inside this</font>

141
00:06:04,540 --> 00:06:10,330
rack over<font color="#E5E5E5"> here next my son so of course</font>

142
00:06:08,590 --> 00:06:12,909
everybody rushed to fix things right<font color="#CCCCCC"> all</font>

143
00:06:10,330 --> 00:06:15,150
this can be<font color="#E5E5E5"> cracked easily and of course</font>

144
00:06:12,910 --> 00:06:19,990
not right<font color="#E5E5E5"> we know you know how things go</font>

145
00:06:15,150 --> 00:06:22,239
so you know<font color="#E5E5E5"> now a few</font><font color="#CCCCCC"> years</font><font color="#E5E5E5"> later we</font>

146
00:06:19,990 --> 00:06:24,310
look and one of the main examples in<font color="#E5E5E5"> our</font>

147
00:06:22,240 --> 00:06:27,010
talk was<font color="#CCCCCC"> ipredator</font><font color="#E5E5E5"> VPN because one of</font>

148
00:06:24,310 --> 00:06:28,570
<font color="#E5E5E5">the more popular VPN providers and we</font>

149
00:06:27,010 --> 00:06:30,520
specifically called them<font color="#E5E5E5"> out and of</font>

150
00:06:28,570 --> 00:06:32,680
<font color="#E5E5E5">course they're still offering PPTP VPN</font>

151
00:06:30,520 --> 00:06:34,030
<font color="#E5E5E5">they just added this</font><font color="#CCCCCC"> little note</font><font color="#E5E5E5"> on</font>

152
00:06:32,680 --> 00:06:36,880
their website like oh you probably

153
00:06:34,030 --> 00:06:39,280
<font color="#E5E5E5">shouldn't</font><font color="#CCCCCC"> use</font><font color="#E5E5E5"> PPTP because it's insecure</font>

154
00:06:36,880 --> 00:06:40,480
<font color="#E5E5E5">but you can still use it</font><font color="#CCCCCC"> and so that's</font>

155
00:06:39,280 --> 00:06:42,159
basically<font color="#CCCCCC"> what we've seen</font><font color="#E5E5E5"> across</font><font color="#CCCCCC"> the</font>

156
00:06:40,480 --> 00:06:47,140
board like<font color="#E5E5E5"> all these VPN providers are</font>

157
00:06:42,160 --> 00:06:49,540
still providing<font color="#E5E5E5"> PPTP VPN and and then</font>

158
00:06:47,140 --> 00:06:51,400
people kind<font color="#E5E5E5"> of discounted the wpa2 hack</font>

159
00:06:49,540 --> 00:06:55,540
as<font color="#E5E5E5"> it's like oh you know it's not</font><font color="#CCCCCC"> really</font>

160
00:06:51,400 --> 00:06:59,140
an issue<font color="#E5E5E5"> and and so recently I started</font>

161
00:06:55,540 --> 00:07:01,180
looking<font color="#CCCCCC"> back</font><font color="#E5E5E5"> into this stuff and</font><font color="#CCCCCC"> and</font>

162
00:06:59,140 --> 00:07:02,680
then also we were getting tons and tons

163
00:07:01,180 --> 00:07:03,430
of jobs<font color="#E5E5E5"> running through the system</font><font color="#CCCCCC"> so I</font>

164
00:07:02,680 --> 00:07:04,600
just started looking

165
00:07:03,430 --> 00:07:06,940
got these weird ones that started coming

166
00:07:04,600 --> 00:07:08,680
<font color="#CCCCCC">through so normally you know we would</font>

167
00:07:06,940 --> 00:07:12,100
have ones<font color="#E5E5E5"> that look</font><font color="#CCCCCC"> like fairly random</font>

168
00:07:08,680 --> 00:07:14,470
plaintext and<font color="#CCCCCC"> ciphertext but we noticed</font>

169
00:07:12,100 --> 00:07:16,090
like you know ones where it's like 1<font color="#CCCCCC"> 1 2</font>

170
00:07:14,470 --> 00:07:18,580
2<font color="#E5E5E5"> 3 3 you know that that</font><font color="#CCCCCC"> doesn't look</font>

171
00:07:16,090 --> 00:07:20,109
very random and<font color="#E5E5E5"> so just wondering what's</font>

172
00:07:18,580 --> 00:07:21,940
up<font color="#CCCCCC"> with that</font><font color="#E5E5E5"> and then we also notice</font>

173
00:07:20,110 --> 00:07:24,100
ones where both of<font color="#CCCCCC"> the cipher texts</font><font color="#E5E5E5"> are</font>

174
00:07:21,940 --> 00:07:25,270
exactly the<font color="#CCCCCC"> same and so they're</font>

175
00:07:24,100 --> 00:07:31,540
obviously<font color="#CCCCCC"> using this for something</font>

176
00:07:25,270 --> 00:07:32,830
<font color="#E5E5E5">that's not mschap</font><font color="#CCCCCC"> B 2 and so you know I</font>

177
00:07:31,540 --> 00:07:34,660
<font color="#E5E5E5">just like started seeing some different</font>

178
00:07:32,830 --> 00:07:39,039
articles<font color="#E5E5E5"> people are definitely</font><font color="#CCCCCC"> still</font>

179
00:07:34,660 --> 00:07:40,540
cracking<font color="#E5E5E5"> wpa2</font><font color="#CCCCCC"> Enterprise and</font><font color="#E5E5E5"> there's all</font>

180
00:07:39,040 --> 00:07:43,390
<font color="#E5E5E5">sorts of tutorials on the</font><font color="#CCCCCC"> internet now</font>

181
00:07:40,540 --> 00:07:45,070
for setting up<font color="#E5E5E5"> your own rogue</font><font color="#CCCCCC"> a.p.e with</font>

182
00:07:43,390 --> 00:07:46,570
a fake radius server for<font color="#E5E5E5"> basically</font>

183
00:07:45,070 --> 00:07:49,210
stealing<font color="#E5E5E5"> these credentials to crack</font>

184
00:07:46,570 --> 00:07:52,750
through<font color="#E5E5E5"> either asleep or through cloud</font>

185
00:07:49,210 --> 00:07:54,760
cracker<font color="#CCCCCC"> and and then also just with the</font>

186
00:07:52,750 --> 00:07:57,280
search on the 1 1 2 2 3 3 4 4

187
00:07:54,760 --> 00:08:01,000
<font color="#CCCCCC">it's the default challenge</font><font color="#E5E5E5"> string for</font>

188
00:07:57,280 --> 00:08:04,150
<font color="#CCCCCC">Metasploit SMB relay module so people</font>

189
00:08:01,000 --> 00:08:05,170
are definitely<font color="#E5E5E5"> using</font><font color="#CCCCCC"> it for that</font><font color="#E5E5E5"> so we</font>

190
00:08:04,150 --> 00:08:09,010
started looking<font color="#E5E5E5"> into this</font><font color="#CCCCCC"> little</font><font color="#E5E5E5"> bit</font>

191
00:08:05,170 --> 00:08:10,000
more and and yeah the bottom<font color="#E5E5E5"> line is</font>

192
00:08:09,010 --> 00:08:11,530
that<font color="#CCCCCC"> people</font><font color="#E5E5E5"> are using this</font><font color="#CCCCCC"> for other</font>

193
00:08:10,000 --> 00:08:15,640
other purposes and what was originally

194
00:08:11,530 --> 00:08:16,960
<font color="#E5E5E5">intended and one day traffic to</font><font color="#CCCCCC"> my</font>

195
00:08:15,640 --> 00:08:18,640
server just dropped off and I was<font color="#E5E5E5"> like</font>

196
00:08:16,960 --> 00:08:21,099
<font color="#CCCCCC">what</font><font color="#E5E5E5"> the hell is going on here and I</font>

197
00:08:18,640 --> 00:08:22,390
noticed<font color="#E5E5E5"> that cloud cracker</font><font color="#CCCCCC"> calm just</font>

198
00:08:21,100 --> 00:08:25,960
died one off the internet<font color="#CCCCCC"> I emailed</font>

199
00:08:22,390 --> 00:08:27,550
<font color="#CCCCCC">moxie he never replied and so I ended up</font>

200
00:08:25,960 --> 00:08:30,450
setting up my<font color="#CCCCCC"> own site that basically</font>

201
00:08:27,550 --> 00:08:33,630
just provides the DES cracking service

202
00:08:30,450 --> 00:08:36,730
specifically for the<font color="#CCCCCC"> fpga system I have</font>

203
00:08:33,630 --> 00:08:38,710
and while I was setting<font color="#E5E5E5"> this up I was</font>

204
00:08:36,730 --> 00:08:40,870
wanting to<font color="#E5E5E5"> kind of add</font><font color="#CCCCCC"> some extra</font>

205
00:08:38,710 --> 00:08:42,970
features<font color="#E5E5E5"> and try to you know update</font>

206
00:08:40,870 --> 00:08:45,370
everything<font color="#E5E5E5"> to make it work with new</font>

207
00:08:42,970 --> 00:08:48,610
things that people were<font color="#E5E5E5"> doing so what</font>

208
00:08:45,370 --> 00:08:51,220
were people<font color="#E5E5E5"> using</font><font color="#CCCCCC"> it for and what</font>

209
00:08:48,610 --> 00:08:52,300
features<font color="#CCCCCC"> should I add and most of all</font>

210
00:08:51,220 --> 00:08:54,250
the reason the whole reason why this

211
00:08:52,300 --> 00:08:57,030
project exists is to<font color="#E5E5E5"> you</font><font color="#CCCCCC"> know like how</font>

212
00:08:54,250 --> 00:09:00,070
can<font color="#CCCCCC"> we</font><font color="#E5E5E5"> kill</font><font color="#CCCCCC"> DES once and for all and how</font>

213
00:08:57,030 --> 00:09:02,709
well for<font color="#E5E5E5"> just legacy crypto in general</font>

214
00:09:00,070 --> 00:09:05,550
that everybody knows<font color="#E5E5E5"> is insecure but</font>

215
00:09:02,710 --> 00:09:09,850
it's just it's always<font color="#E5E5E5"> going to be there</font>

216
00:09:05,550 --> 00:09:12,790
so looking at the SMB relay module if

217
00:09:09,850 --> 00:09:15,070
you if you<font color="#E5E5E5"> look at the land man in ntlm</font>

218
00:09:12,790 --> 00:09:16,860
v1<font color="#CCCCCC"> challenge response it's exactly the</font>

219
00:09:15,070 --> 00:09:19,260
same<font color="#E5E5E5"> as mschap v2</font>

220
00:09:16,860 --> 00:09:21,690
and so people realize<font color="#E5E5E5"> this shortly after</font>

221
00:09:19,260 --> 00:09:23,130
our<font color="#E5E5E5"> talk and you know started doing</font>

222
00:09:21,690 --> 00:09:26,370
these attacks where they were basically

223
00:09:23,130 --> 00:09:27,750
<font color="#E5E5E5">using that to to crack people's</font>

224
00:09:26,370 --> 00:09:29,520
passwords<font color="#E5E5E5"> where they would either you</font>

225
00:09:27,750 --> 00:09:32,190
know set<font color="#CCCCCC"> up their own fake sama</font><font color="#E5E5E5"> server</font>

226
00:09:29,520 --> 00:09:33,569
or redirect you know servers and then

227
00:09:32,190 --> 00:09:36,020
when<font color="#CCCCCC"> people log in then they would snarf</font>

228
00:09:33,570 --> 00:09:39,930
the credentials<font color="#E5E5E5"> and crack the ntlm hash</font>

229
00:09:36,020 --> 00:09:41,600
and basically how this<font color="#CCCCCC"> works is that</font><font color="#E5E5E5"> so</font>

230
00:09:39,930 --> 00:09:43,739
if you use this and be really module

231
00:09:41,600 --> 00:09:46,170
<font color="#CCCCCC">it'll start just</font><font color="#E5E5E5"> spitting out its</font>

232
00:09:43,740 --> 00:09:48,690
captured<font color="#E5E5E5"> NT hash</font><font color="#CCCCCC"> these are the network</font>

233
00:09:46,170 --> 00:09:51,060
empty hash and and LM hash values here

234
00:09:48,690 --> 00:09:53,640
and<font color="#E5E5E5"> then you can</font><font color="#CCCCCC"> basically take that</font>

235
00:09:51,060 --> 00:09:56,069
feed it<font color="#CCCCCC"> directly into chap crack which</font>

236
00:09:53,640 --> 00:09:58,620
<font color="#CCCCCC">moxy wrote a long time ago and give</font><font color="#E5E5E5"> it</font>

237
00:09:56,070 --> 00:10:01,350
<font color="#CCCCCC">that fixed challenge of 1 1 two 2 three</font>

238
00:09:58,620 --> 00:10:04,410
3 four<font color="#E5E5E5"> 4 five 5</font><font color="#CCCCCC"> six 6 seven 7 eight 8</font>

239
00:10:01,350 --> 00:10:06,210
nine<font color="#CCCCCC"> nine and</font><font color="#E5E5E5"> and then it'll create a</font>

240
00:10:04,410 --> 00:10:09,630
token you submit<font color="#E5E5E5"> that</font><font color="#CCCCCC"> to the website and</font>

241
00:10:06,210 --> 00:10:11,750
then ultimately<font color="#E5E5E5"> the</font><font color="#CCCCCC"> value you get back</font>

242
00:10:09,630 --> 00:10:14,730
from<font color="#CCCCCC"> us in an email within 24 hours</font><font color="#E5E5E5"> is</font>

243
00:10:11,750 --> 00:10:16,350
either the land man hash or<font color="#E5E5E5"> the ntlm</font>

244
00:10:14,730 --> 00:10:20,790
hash based<font color="#E5E5E5"> on which one of these values</font>

245
00:10:16,350 --> 00:10:22,620
you you submit to us and then you<font color="#E5E5E5"> can do</font>

246
00:10:20,790 --> 00:10:24,449
you know any<font color="#CCCCCC"> number of pass</font><font color="#E5E5E5"> the hash</font>

247
00:10:22,620 --> 00:10:26,160
attacks or whatever to use the hash

248
00:10:24,450 --> 00:10:29,130
table<font color="#CCCCCC"> in decayed</font><font color="#E5E5E5"> with the actual system</font>

249
00:10:26,160 --> 00:10:31,469
and then then people<font color="#CCCCCC"> actually started</font>

250
00:10:29,130 --> 00:10:33,990
<font color="#E5E5E5">making it super</font><font color="#CCCCCC"> easy to create</font><font color="#E5E5E5"> your</font><font color="#CCCCCC"> own</font>

251
00:10:31,470 --> 00:10:37,080
fake access points for doing wpa2

252
00:10:33,990 --> 00:10:39,840
<font color="#CCCCCC">Enterprise attacks and so this is easy</font>

253
00:10:37,080 --> 00:10:42,780
creds<font color="#CCCCCC"> that'll actually fully set up you</font>

254
00:10:39,840 --> 00:10:45,450
know rogue hostapd daemon<font color="#E5E5E5"> and the radius</font>

255
00:10:42,780 --> 00:10:46,800
server<font color="#E5E5E5"> and everything</font><font color="#CCCCCC"> and then as people</font>

256
00:10:45,450 --> 00:10:47,970
connect<font color="#CCCCCC"> that just you</font><font color="#E5E5E5"> know basically</font>

257
00:10:46,800 --> 00:10:49,380
does<font color="#CCCCCC"> the</font><font color="#E5E5E5"> same thing where it gives you</font>

258
00:10:47,970 --> 00:10:54,120
the challenge in response that<font color="#CCCCCC"> was used</font>

259
00:10:49,380 --> 00:10:55,590
and then<font color="#E5E5E5"> you can take those and you</font><font color="#CCCCCC"> know</font>

260
00:10:54,120 --> 00:10:58,020
do<font color="#E5E5E5"> the exact same thing feed it to the</font>

261
00:10:55,590 --> 00:11:00,330
system<font color="#CCCCCC"> and it'll crack the</font><font color="#E5E5E5"> then T hash</font>

262
00:10:58,020 --> 00:11:01,920
equivalent but then you can use to

263
00:11:00,330 --> 00:11:05,040
<font color="#CCCCCC">authenticate to the wpa2 enterprise</font>

264
00:11:01,920 --> 00:11:06,780
network and I started<font color="#E5E5E5"> asking</font><font color="#CCCCCC"> people</font><font color="#E5E5E5"> in</font>

265
00:11:05,040 --> 00:11:08,400
industry<font color="#E5E5E5"> like how often do they</font><font color="#CCCCCC"> actually</font>

266
00:11:06,780 --> 00:11:11,780
see people<font color="#E5E5E5"> doing full you know</font>

267
00:11:08,400 --> 00:11:14,430
certificate validation of<font color="#E5E5E5"> the server and</font>

268
00:11:11,780 --> 00:11:16,110
a bunch of<font color="#E5E5E5"> people I talked</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> said that</font>

269
00:11:14,430 --> 00:11:18,810
<font color="#CCCCCC">you know it's</font><font color="#E5E5E5"> like maybe 95 percent of</font>

270
00:11:16,110 --> 00:11:20,520
<font color="#E5E5E5">the time this attack works and so either</font>

271
00:11:18,810 --> 00:11:21,750
people<font color="#E5E5E5"> aren't checking certificates at</font>

272
00:11:20,520 --> 00:11:24,210
all there's lots of phones<font color="#E5E5E5"> that</font><font color="#CCCCCC"> don't</font>

273
00:11:21,750 --> 00:11:25,920
really support<font color="#E5E5E5"> it or handle it very well</font>

274
00:11:24,210 --> 00:11:27,180
<font color="#E5E5E5">and there's also tons of</font><font color="#CCCCCC"> people that</font>

275
00:11:25,920 --> 00:11:28,199
just<font color="#CCCCCC"> say Oh certificate error</font><font color="#E5E5E5"> or</font>

276
00:11:27,180 --> 00:11:30,890
whatever I'm just<font color="#E5E5E5"> going to type in</font><font color="#CCCCCC"> my</font>

277
00:11:28,200 --> 00:11:30,890
credentials anyway

278
00:11:31,630 --> 00:11:38,000
so it's<font color="#E5E5E5"> definitely very much still a</font>

279
00:11:34,400 --> 00:11:39,709
thing and then shortly<font color="#CCCCCC"> after we</font><font color="#E5E5E5"> gave our</font>

280
00:11:38,000 --> 00:11:41,690
talk in 2012<font color="#E5E5E5"> I don't know if you guys</font>

281
00:11:39,710 --> 00:11:46,220
<font color="#CCCCCC">saw this talk by Carson Knoll that's our</font>

282
00:11:41,690 --> 00:11:49,640
labs<font color="#E5E5E5"> basically doing remote updates to</font>

283
00:11:46,220 --> 00:11:51,200
SIM cards<font color="#E5E5E5"> with the sim toolkit</font><font color="#CCCCCC"> a lot of</font>

284
00:11:49,640 --> 00:11:52,670
these operators rely on<font color="#CCCCCC"> DES for</font>

285
00:11:51,200 --> 00:11:56,780
<font color="#E5E5E5">therefore verifying the remote updates</font>

286
00:11:52,670 --> 00:11:59,089
and so he you know demonstrated that at

287
00:11:56,780 --> 00:12:00,740
<font color="#E5E5E5">least with a lot</font><font color="#CCCCCC"> of the</font><font color="#E5E5E5"> the carriers</font>

288
00:11:59,090 --> 00:12:03,080
<font color="#E5E5E5">that he looked at a good percentage of</font>

289
00:12:00,740 --> 00:12:05,840
<font color="#E5E5E5">them still used as and you can easily</font>

290
00:12:03,080 --> 00:12:07,010
crack the key and<font color="#E5E5E5"> be able to send remote</font>

291
00:12:05,840 --> 00:12:08,270
updates to people's phones and there's

292
00:12:07,010 --> 00:12:10,640
all sorts of new<font color="#E5E5E5"> various things you can</font>

293
00:12:08,270 --> 00:12:12,230
do with that but one thing<font color="#CCCCCC"> I thought</font><font color="#E5E5E5"> was</font>

294
00:12:10,640 --> 00:12:15,340
kind of cool is that<font color="#E5E5E5"> recently on mr.</font>

295
00:12:12,230 --> 00:12:18,950
robot<font color="#E5E5E5"> they featured this this hack and</font>

296
00:12:15,340 --> 00:12:23,780
actually use<font color="#CCCCCC"> Cloud cracker</font><font color="#E5E5E5"> to crack the</font>

297
00:12:18,950 --> 00:12:27,080
DES<font color="#E5E5E5"> keys and so</font><font color="#CCCCCC"> that was kind of neat so</font>

298
00:12:23,780 --> 00:12:28,550
so the the<font color="#CCCCCC"> main features I want to add</font>

299
00:12:27,080 --> 00:12:30,050
to this was to<font color="#CCCCCC"> provide more of a</font>

300
00:12:28,550 --> 00:12:32,240
<font color="#CCCCCC">general-purpose interface instead of</font>

301
00:12:30,050 --> 00:12:33,920
<font color="#E5E5E5">people just kind of like abusing</font><font color="#CCCCCC"> this</font>

302
00:12:32,240 --> 00:12:37,910
you know the system<font color="#E5E5E5"> in order</font><font color="#CCCCCC"> to crack</font>

303
00:12:33,920 --> 00:12:39,589
<font color="#E5E5E5">whatever they wanted and so I just set</font>

304
00:12:37,910 --> 00:12:41,900
out to create a really simple<font color="#E5E5E5"> role and</font>

305
00:12:39,589 --> 00:12:44,060
<font color="#E5E5E5">the basic idea here is</font><font color="#CCCCCC"> that now you can</font>

306
00:12:41,900 --> 00:12:46,760
submit<font color="#E5E5E5"> jobs to the system where if</font>

307
00:12:44,060 --> 00:12:48,170
you're trying to let's say if you have

308
00:12:46,760 --> 00:12:50,060
some<font color="#CCCCCC"> ciphertext and you know some of the</font>

309
00:12:48,170 --> 00:12:53,689
<font color="#CCCCCC">plaintext for</font><font color="#E5E5E5"> that block then you can</font>

310
00:12:50,060 --> 00:12:56,569
use a simple mask and<font color="#E5E5E5"> and then we we</font>

311
00:12:53,690 --> 00:12:58,640
allow up to 24 bits of<font color="#CCCCCC"> zeros so as long</font>

312
00:12:56,570 --> 00:13:00,140
<font color="#E5E5E5">as you know like something about the</font>

313
00:12:58,640 --> 00:13:01,610
<font color="#E5E5E5">plaintext and</font><font color="#CCCCCC"> will basically</font><font color="#E5E5E5"> find all</font>

314
00:13:00,140 --> 00:13:03,080
the keys that<font color="#E5E5E5"> match that</font><font color="#CCCCCC"> send you a</font><font color="#E5E5E5"> list</font>

315
00:13:01,610 --> 00:13:05,900
of<font color="#E5E5E5"> all the keys and</font><font color="#CCCCCC"> then you can</font><font color="#E5E5E5"> further</font>

316
00:13:03,080 --> 00:13:07,460
verify on your end<font color="#E5E5E5"> and and so this is</font>

317
00:13:05,900 --> 00:13:11,270
the feature<font color="#E5E5E5"> has</font><font color="#CCCCCC"> been up for a while now</font>

318
00:13:07,460 --> 00:13:13,130
<font color="#CCCCCC">and</font><font color="#E5E5E5"> I kind of wanted to</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> you know</font>

319
00:13:11,270 --> 00:13:14,569
experiment<font color="#CCCCCC"> this and try to try to</font><font color="#E5E5E5"> break</font>

320
00:13:13,130 --> 00:13:18,410
something using this new interface<font color="#CCCCCC"> and</font>

321
00:13:14,570 --> 00:13:22,240
so some of<font color="#E5E5E5"> my friends presented on this</font>

322
00:13:18,410 --> 00:13:25,699
<font color="#CCCCCC">a</font><font color="#E5E5E5"> number of years ago on how Kerberos</font>

323
00:13:22,240 --> 00:13:28,520
<font color="#E5E5E5">provides the DES option and and</font>

324
00:13:25,700 --> 00:13:30,530
downgrade attacks are fairly<font color="#E5E5E5"> easy</font><font color="#CCCCCC"> and so</font>

325
00:13:28,520 --> 00:13:32,900
I was<font color="#CCCCCC"> just</font><font color="#E5E5E5"> like Oh nobody uses DES</font>

326
00:13:30,530 --> 00:13:35,240
anymore with Kerberos<font color="#E5E5E5"> tonight for my day</font>

327
00:13:32,900 --> 00:13:37,520
job<font color="#CCCCCC"> I just</font><font color="#E5E5E5"> looked at our network and of</font>

328
00:13:35,240 --> 00:13:40,250
course our network only does does<font color="#E5E5E5"> in</font><font color="#CCCCCC"> rc4</font>

329
00:13:37,520 --> 00:13:42,140
so<font color="#E5E5E5"> I'm sure that there's a number of</font>

330
00:13:40,250 --> 00:13:42,889
environments<font color="#E5E5E5"> out</font><font color="#CCCCCC"> there that have pre</font>

331
00:13:42,140 --> 00:13:44,989
Windows<font color="#E5E5E5"> 2000</font>

332
00:13:42,889 --> 00:13:47,119
eight computers<font color="#CCCCCC"> that</font><font color="#E5E5E5"> you know still have</font>

333
00:13:44,989 --> 00:13:49,639
to provide<font color="#E5E5E5"> legacy support and support</font>

334
00:13:47,119 --> 00:13:51,399
does so<font color="#E5E5E5"> just looking at this the basic</font>

335
00:13:49,639 --> 00:13:55,429
idea is<font color="#CCCCCC"> that with the</font><font color="#E5E5E5"> initial</font>

336
00:13:51,399 --> 00:13:57,230
authentication<font color="#E5E5E5"> with the KDC you can man</font>

337
00:13:55,429 --> 00:13:59,959
the<font color="#E5E5E5"> middle it and then downgrade and say</font>

338
00:13:57,230 --> 00:14:02,869
<font color="#E5E5E5">only does is supported and and then</font>

339
00:13:59,959 --> 00:14:07,459
basically<font color="#CCCCCC"> from then on they use des keys</font>

340
00:14:02,869 --> 00:14:09,619
for<font color="#E5E5E5"> for all of Kerberos so so I wrote a</font>

341
00:14:07,459 --> 00:14:11,839
simple<font color="#E5E5E5"> ettercap filter that essentially</font>

342
00:14:09,619 --> 00:14:13,220
swaps out all the encryption possible

343
00:14:11,839 --> 00:14:16,100
encryption types that<font color="#E5E5E5"> flow through with</font>

344
00:14:13,220 --> 00:14:19,819
just<font color="#E5E5E5"> as</font><font color="#CCCCCC"> cbc and and this actually works</font>

345
00:14:16,100 --> 00:14:21,679
<font color="#E5E5E5">really well</font><font color="#CCCCCC"> and so so then all the all</font>

346
00:14:19,819 --> 00:14:25,579
<font color="#E5E5E5">the values you see flow flow by are all</font>

347
00:14:21,679 --> 00:14:29,059
<font color="#E5E5E5">des encrypted and then it's all</font><font color="#CCCCCC"> asm1</font>

348
00:14:25,579 --> 00:14:30,769
<font color="#E5E5E5">encoded and solve the all this and one</font>

349
00:14:29,059 --> 00:14:32,600
values are<font color="#CCCCCC"> fairly fixed</font><font color="#E5E5E5"> and so you can</font>

350
00:14:30,769 --> 00:14:35,419
actually<font color="#E5E5E5"> get really reliable known</font>

351
00:14:32,600 --> 00:14:36,649
plaintext out of that one example like

352
00:14:35,419 --> 00:14:39,309
<font color="#CCCCCC">that</font><font color="#E5E5E5"> I have shown on</font><font color="#CCCCCC"> here that</font><font color="#E5E5E5"> you</font>

353
00:14:36,649 --> 00:14:41,449
<font color="#E5E5E5">probably can't see</font><font color="#CCCCCC"> at all</font><font color="#E5E5E5"> is that</font>

354
00:14:39,309 --> 00:14:43,850
<font color="#E5E5E5">there's this particular block that's</font>

355
00:14:41,449 --> 00:14:45,589
very fixed and it's entirely<font color="#E5E5E5"> based on</font>

356
00:14:43,850 --> 00:14:47,869
<font color="#E5E5E5">the current day and</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> right actually</font>

357
00:14:45,589 --> 00:14:50,269
<font color="#CCCCCC">the year in the</font><font color="#E5E5E5"> month is like part of</font>

358
00:14:47,869 --> 00:14:51,619
<font color="#E5E5E5">that field and so it's pretty easy to to</font>

359
00:14:50,269 --> 00:14:56,269
figure out the entire<font color="#E5E5E5"> known plaintext</font>

360
00:14:51,619 --> 00:14:59,269
just based on<font color="#CCCCCC"> that and and then as far</font>

361
00:14:56,269 --> 00:15:02,569
as<font color="#E5E5E5"> CBC it's a fairly simple to figure</font>

362
00:14:59,269 --> 00:15:04,339
<font color="#CCCCCC">out</font><font color="#E5E5E5"> the actual plaintext for the known</font>

363
00:15:02,569 --> 00:15:06,439
plaintext for that particular<font color="#E5E5E5"> DES block</font>

364
00:15:04,339 --> 00:15:08,299
because you it's basically<font color="#CCCCCC"> just</font><font color="#E5E5E5"> the</font>

365
00:15:06,439 --> 00:15:11,209
<font color="#E5E5E5">ciphertext of the previous block ex-ored</font>

366
00:15:08,299 --> 00:15:12,889
with the plaintext of your current block

367
00:15:11,209 --> 00:15:14,899
and<font color="#CCCCCC"> C XOR those together and</font><font color="#E5E5E5"> that's your</font>

368
00:15:12,889 --> 00:15:20,059
known plaintext for what you're trying

369
00:15:14,899 --> 00:15:21,290
<font color="#CCCCCC">to crack and so so yeah just because</font>

370
00:15:20,059 --> 00:15:23,449
<font color="#CCCCCC">they're using some</font><font color="#E5E5E5"> mode doesn't</font>

371
00:15:21,290 --> 00:15:26,059
necessarily mean that it's adding much

372
00:15:23,449 --> 00:15:28,669
security for for<font color="#E5E5E5"> these types of</font><font color="#CCCCCC"> attacks</font>

373
00:15:26,059 --> 00:15:32,629
or your brute forcing<font color="#CCCCCC"> then the full key</font>

374
00:15:28,669 --> 00:15:34,970
<font color="#E5E5E5">space so then I you know wrote some code</font>

375
00:15:32,629 --> 00:15:35,839
<font color="#E5E5E5">to extract out all the snow in plain</font>

376
00:15:34,970 --> 00:15:38,149
text

377
00:15:35,839 --> 00:15:40,189
you know<font color="#E5E5E5"> blocks and then essentially</font>

378
00:15:38,149 --> 00:15:42,100
<font color="#E5E5E5">just create a cloud cracker token so if</font>

379
00:15:40,189 --> 00:15:44,959
you're able<font color="#E5E5E5"> to run the center cap filter</font>

380
00:15:42,100 --> 00:15:47,149
<font color="#CCCCCC">and then you know just like</font><font color="#E5E5E5"> do a</font><font color="#CCCCCC"> peek</font>

381
00:15:44,959 --> 00:15:49,638
<font color="#CCCCCC">app capture of the traffic run</font><font color="#E5E5E5"> into here</font>

382
00:15:47,149 --> 00:15:51,889
<font color="#CCCCCC">it'll basically</font><font color="#E5E5E5"> pull out a bunch of</font>

383
00:15:49,639 --> 00:15:54,230
tokens you can use for cracking<font color="#CCCCCC"> the</font>

384
00:15:51,889 --> 00:15:55,819
<font color="#E5E5E5">Kerberos keys and I still need</font><font color="#CCCCCC"> to do</font>

385
00:15:54,230 --> 00:15:56,140
some<font color="#CCCCCC"> work on actually</font><font color="#E5E5E5"> leveraging that</font><font color="#CCCCCC"> to</font>

386
00:15:55,819 --> 00:15:58,510
you

387
00:15:56,140 --> 00:15:59,530
<font color="#E5E5E5">then pull down all the tickets and you</font>

388
00:15:58,510 --> 00:16:00,640
know authenticate to<font color="#E5E5E5"> the domain</font>

389
00:15:59,530 --> 00:16:06,939
controller and<font color="#CCCCCC"> all that sort of stuff</font>

390
00:16:00,640 --> 00:16:08,319
but<font color="#E5E5E5"> that's a I guess for another talk so</font>

391
00:16:06,940 --> 00:16:12,070
yeah then you can<font color="#E5E5E5"> submit to the system</font>

392
00:16:08,320 --> 00:16:16,300
and then<font color="#CCCCCC"> you get</font><font color="#E5E5E5"> an email with the key</font>

393
00:16:12,070 --> 00:16:18,220
<font color="#E5E5E5">later on so then I started seeing people</font>

394
00:16:16,300 --> 00:16:21,310
asking specifically<font color="#E5E5E5"> for cracking des</font>

395
00:16:18,220 --> 00:16:23,410
<font color="#CCCCCC">crypt hashes do you guys remember</font><font color="#E5E5E5"> des</font>

396
00:16:21,310 --> 00:16:25,660
crypt from like what the 90s or

397
00:16:23,410 --> 00:16:28,449
<font color="#CCCCCC">something like</font><font color="#E5E5E5"> back</font><font color="#CCCCCC"> in Linux was using</font>

398
00:16:25,660 --> 00:16:31,300
<font color="#CCCCCC">that and like a long</font><font color="#E5E5E5"> time ago I wrote</font>

399
00:16:28,450 --> 00:16:33,190
some<font color="#CCCCCC"> fpga code for cracking</font><font color="#E5E5E5"> these but</font>

400
00:16:31,300 --> 00:16:35,349
like<font color="#CCCCCC"> I never</font><font color="#E5E5E5"> saw in use for</font><font color="#CCCCCC"> this and so</font>

401
00:16:33,190 --> 00:16:36,760
I just gave<font color="#CCCCCC"> up on it but now everybody's</font>

402
00:16:35,350 --> 00:16:38,830
emailing me asking<font color="#CCCCCC"> if I</font><font color="#E5E5E5"> can crack these</font>

403
00:16:36,760 --> 00:16:42,700
so I was like<font color="#E5E5E5"> okay I guess I'll try to</font>

404
00:16:38,830 --> 00:16:45,130
and<font color="#E5E5E5"> and just if you guys remember this</font>

405
00:16:42,700 --> 00:16:49,920
was actually<font color="#E5E5E5"> designed to replace an</font>

406
00:16:45,130 --> 00:16:53,200
older<font color="#CCCCCC"> M - oh not</font><font color="#E5E5E5"> M 209 cipher that took</font>

407
00:16:49,920 --> 00:16:55,089
<font color="#E5E5E5">1.25 milliseconds on a PDP 11 and they</font>

408
00:16:53,200 --> 00:16:57,700
wanted it<font color="#E5E5E5"> their new cipher to take over</font>

409
00:16:55,090 --> 00:16:59,200
<font color="#E5E5E5">one second on a PDP 11 and so that's the</font>

410
00:16:57,700 --> 00:17:03,670
<font color="#E5E5E5">design criteria</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> this but it's</font>

411
00:16:59,200 --> 00:17:05,410
essentially 25<font color="#E5E5E5"> rounds of des and and I</font>

412
00:17:03,670 --> 00:17:08,050
figured yeah nobody uses anymore right

413
00:17:05,410 --> 00:17:09,400
and so does<font color="#E5E5E5"> anybody here</font>

414
00:17:08,050 --> 00:17:13,599
<font color="#E5E5E5">reverse-engineer Q and X or come across</font>

415
00:17:09,400 --> 00:17:16,630
<font color="#CCCCCC">qnx at all a couple of uliana so</font><font color="#E5E5E5"> see I</font>

416
00:17:13,599 --> 00:17:19,719
found<font color="#CCCCCC"> out that yet tons of vehicles are</font>

417
00:17:16,630 --> 00:17:23,170
using<font color="#CCCCCC"> q NX for their infotainment system</font>

418
00:17:19,720 --> 00:17:24,339
and stuff<font color="#E5E5E5"> like that and so I am like</font>

419
00:17:23,170 --> 00:17:28,120
<font color="#CCCCCC">okay I guess you know this</font><font color="#E5E5E5"> is worthwhile</font>

420
00:17:24,339 --> 00:17:29,740
<font color="#E5E5E5">and and so I just like search for</font>

421
00:17:28,119 --> 00:17:32,080
presentations on different<font color="#CCCCCC"> things and so</font>

422
00:17:29,740 --> 00:17:33,310
this is<font color="#E5E5E5"> actually what Charlie Miller and</font>

423
00:17:32,080 --> 00:17:36,330
Chris valasek

424
00:17:33,310 --> 00:17:38,889
paper on<font color="#CCCCCC"> cracking the</font><font color="#E5E5E5"> Jeep</font><font color="#CCCCCC"> Cherokee in</font>

425
00:17:36,330 --> 00:17:40,210
<font color="#E5E5E5">2002 thousand</font><font color="#CCCCCC"> fourteen Jeep Cherokee and</font>

426
00:17:38,890 --> 00:17:41,830
so they<font color="#CCCCCC"> just published</font><font color="#E5E5E5"> the shadow file</font>

427
00:17:40,210 --> 00:17:44,140
for that<font color="#CCCCCC"> I'm like okay I got some</font><font color="#E5E5E5"> stuff</font>

428
00:17:41,830 --> 00:17:46,169
to<font color="#CCCCCC"> work off of</font><font color="#E5E5E5"> another presentation</font>

429
00:17:44,140 --> 00:17:48,640
<font color="#CCCCCC">where they publish the shadow file and</font>

430
00:17:46,170 --> 00:17:50,320
and then<font color="#E5E5E5"> just searching around I know</font>

431
00:17:48,640 --> 00:17:51,880
it's like you<font color="#E5E5E5"> know there's tons of des</font>

432
00:17:50,320 --> 00:17:53,800
hashes on the internet that<font color="#CCCCCC"> people are</font>

433
00:17:51,880 --> 00:17:54,910
trying<font color="#CCCCCC"> to you know get get passwords for</font>

434
00:17:53,800 --> 00:17:58,930
and so<font color="#E5E5E5"> maybe there was</font><font color="#CCCCCC"> something</font><font color="#E5E5E5"> to this</font>

435
00:17:54,910 --> 00:18:01,060
<font color="#E5E5E5">and so I set out to</font><font color="#CCCCCC"> basically do the</font>

436
00:17:58,930 --> 00:18:03,670
full<font color="#E5E5E5"> key possible key space for this and</font>

437
00:18:01,060 --> 00:18:06,100
so this is<font color="#E5E5E5"> 96</font>

438
00:18:03,670 --> 00:18:09,590
<font color="#E5E5E5">well 95 possible characters for all</font>

439
00:18:06,100 --> 00:18:11,780
possible key character lengths and so

440
00:18:09,590 --> 00:18:13,879
with 25 rounds of des it takes around

441
00:18:11,780 --> 00:18:15,678
three days for my system<font color="#CCCCCC"> to to go</font>

442
00:18:13,880 --> 00:18:20,900
<font color="#E5E5E5">through the full type of</font><font color="#CCCCCC"> oq space for</font>

443
00:18:15,679 --> 00:18:22,280
this<font color="#E5E5E5"> and and so I just started a you</font>

444
00:18:20,900 --> 00:18:23,750
know like you<font color="#E5E5E5"> can just submit this</font>

445
00:18:22,280 --> 00:18:28,040
directly to<font color="#E5E5E5"> the system if you go to</font>

446
00:18:23,750 --> 00:18:30,080
crack<font color="#E5E5E5"> that Sh now and I figured that</font>

447
00:18:28,040 --> 00:18:32,149
<font color="#CCCCCC">there</font><font color="#E5E5E5"> must be secure passwords out there</font>

448
00:18:30,080 --> 00:18:33,980
that I could<font color="#CCCCCC"> actually use</font><font color="#E5E5E5"> to use the</font>

449
00:18:32,150 --> 00:18:36,049
system on like I mean there has to be

450
00:18:33,980 --> 00:18:37,400
some some<font color="#E5E5E5"> people actually use special</font>

451
00:18:36,049 --> 00:18:41,000
characters<font color="#CCCCCC"> and</font><font color="#E5E5E5"> stuff in their passwords</font>

452
00:18:37,400 --> 00:18:43,970
<font color="#E5E5E5">right you think so yeah</font>

453
00:18:41,000 --> 00:18:45,350
so a friend of<font color="#E5E5E5"> mine I mentioned this</font>

454
00:18:43,970 --> 00:18:46,820
that you know I<font color="#E5E5E5"> built the system and</font>

455
00:18:45,350 --> 00:18:49,760
he's like oh I got<font color="#E5E5E5"> it I got a hash for</font>

456
00:18:46,820 --> 00:18:53,750
you to crack<font color="#E5E5E5"> here it's for the</font><font color="#CCCCCC"> OnStar</font>

457
00:18:49,760 --> 00:18:55,610
<font color="#E5E5E5">the newest on star systems have run Q</font>

458
00:18:53,750 --> 00:18:57,500
<font color="#E5E5E5">and X and here's their you know shadow</font>

459
00:18:55,610 --> 00:18:59,418
file for the root password for all<font color="#CCCCCC"> on</font>

460
00:18:57,500 --> 00:19:01,970
star systems<font color="#E5E5E5"> okay that's pretty cool and</font>

461
00:18:59,419 --> 00:19:03,799
<font color="#E5E5E5">so</font><font color="#CCCCCC"> I've put in my system and</font><font color="#E5E5E5"> I'm waiting</font>

462
00:19:01,970 --> 00:19:06,290
<font color="#E5E5E5">and it basically media immediately</font>

463
00:19:03,799 --> 00:19:08,740
returns and the password<font color="#CCCCCC"> is rude I'm</font>

464
00:19:06,290 --> 00:19:10,970
like what<font color="#CCCCCC"> the hell are</font><font color="#E5E5E5"> you kidding me</font><font color="#CCCCCC"> I</font>

465
00:19:08,740 --> 00:19:12,559
was expecting<font color="#CCCCCC"> something good out of it</font>

466
00:19:10,970 --> 00:19:14,200
and so then then I went<font color="#E5E5E5"> through and</font>

467
00:19:12,559 --> 00:19:18,470
looked<font color="#CCCCCC"> at these other</font><font color="#E5E5E5"> ones and it's like</font>

468
00:19:14,200 --> 00:19:20,960
simple like<font color="#CCCCCC"> BT donkey</font><font color="#E5E5E5"> I so so anyway</font>

469
00:19:18,470 --> 00:19:23,330
<font color="#E5E5E5">this</font><font color="#CCCCCC"> is a call out to</font><font color="#E5E5E5"> any of you if you</font>

470
00:19:20,960 --> 00:19:24,710
have any<font color="#CCCCCC"> DES</font><font color="#E5E5E5"> crypt hashes from</font><font color="#CCCCCC"> qnx</font>

471
00:19:23,330 --> 00:19:26,720
systems that you aren't able<font color="#CCCCCC"> to crack</font>

472
00:19:24,710 --> 00:19:28,610
with<font color="#E5E5E5"> with John the Ripper let me know</font>

473
00:19:26,720 --> 00:19:31,880
because I I want to have<font color="#E5E5E5"> something that</font>

474
00:19:28,610 --> 00:19:39,409
<font color="#E5E5E5">this is good for so please help me</font><font color="#CCCCCC"> out</font>

475
00:19:31,880 --> 00:19:43,820
here yeah<font color="#CCCCCC"> so anyway</font><font color="#E5E5E5"> I if you go on the</font>

476
00:19:39,410 --> 00:19:45,919
github<font color="#CCCCCC"> you know we have a ways</font><font color="#E5E5E5"> to verify</font>

477
00:19:43,820 --> 00:19:48,320
<font color="#E5E5E5">all</font><font color="#CCCCCC"> of you know how we're doing</font>

478
00:19:45,919 --> 00:19:51,020
<font color="#E5E5E5">everything as far as byte ordering you</font>

479
00:19:48,320 --> 00:19:53,200
know<font color="#CCCCCC"> keys with parity</font><font color="#E5E5E5"> versus non parity</font>

480
00:19:51,020 --> 00:19:57,470
so you can verify<font color="#E5E5E5"> your implementation</font>

481
00:19:53,200 --> 00:19:59,210
<font color="#CCCCCC">and then also you can submit jobs fairly</font>

482
00:19:57,470 --> 00:20:01,520
easily<font color="#E5E5E5"> and create tokens through this</font>

483
00:19:59,210 --> 00:20:03,080
and the tokens<font color="#E5E5E5"> are all basics</font><font color="#CCCCCC"> before in</font>

484
00:20:01,520 --> 00:20:04,700
code so<font color="#CCCCCC"> it's easy to to write yourself</font>

485
00:20:03,080 --> 00:20:06,500
<font color="#E5E5E5">if you want to but this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> just a</font>

486
00:20:04,700 --> 00:20:09,230
<font color="#CCCCCC">reference implementation and then</font><font color="#E5E5E5"> this</font>

487
00:20:06,500 --> 00:20:11,240
code<font color="#CCCCCC"> also implements the Kerberos key</font>

488
00:20:09,230 --> 00:20:14,910
cracking stuff<font color="#E5E5E5"> see at least have an idea</font>

489
00:20:11,240 --> 00:20:18,150
<font color="#CCCCCC">for how to how</font><font color="#E5E5E5"> to code with it as well</font>

490
00:20:14,910 --> 00:20:19,440
and then<font color="#E5E5E5"> yeah</font><font color="#CCCCCC"> basically</font><font color="#E5E5E5"> like took me</font>

491
00:20:18,150 --> 00:20:23,460
generate you can submit<font color="#CCCCCC"> to the website</font>

492
00:20:19,440 --> 00:20:25,410
and<font color="#E5E5E5"> you know within usually</font><font color="#CCCCCC"> within a day</font>

493
00:20:23,460 --> 00:20:27,560
you'll receive a list of all the keys to

494
00:20:25,410 --> 00:20:30,630
match that<font color="#CCCCCC"> and</font><font color="#E5E5E5"> then you know it's a</font>

495
00:20:27,560 --> 00:20:32,250
<font color="#CCCCCC">sizable</font><font color="#E5E5E5"> you know it's down to a decent</font>

496
00:20:30,630 --> 00:20:33,540
size you can easily verify with software

497
00:20:32,250 --> 00:20:35,490
<font color="#CCCCCC">or whatever so that's that's the</font>

498
00:20:33,540 --> 00:20:37,139
<font color="#E5E5E5">interface that</font><font color="#CCCCCC"> we have right now</font><font color="#E5E5E5"> and so</font>

499
00:20:35,490 --> 00:20:39,210
if you<font color="#E5E5E5"> happen to come across</font><font color="#CCCCCC"> des in the</font>

500
00:20:37,140 --> 00:20:42,480
wild which is becoming a more increasing

501
00:20:39,210 --> 00:20:47,730
<font color="#CCCCCC">please you know</font><font color="#E5E5E5"> a popular thing</font><font color="#CCCCCC"> for some</font>

502
00:20:42,480 --> 00:20:50,220
reason<font color="#CCCCCC"> then let</font><font color="#E5E5E5"> me know</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> the I mean</font>

503
00:20:47,730 --> 00:20:53,130
that's pretty<font color="#E5E5E5"> much the talk</font><font color="#CCCCCC"> I really</font>

504
00:20:50,220 --> 00:20:57,180
want to just have some help with killing

505
00:20:53,130 --> 00:20:59,370
legacy crypto<font color="#E5E5E5"> and</font><font color="#CCCCCC"> and so if anybody</font>

506
00:20:57,180 --> 00:21:01,440
wants<font color="#CCCCCC"> to or has any ideas please</font><font color="#E5E5E5"> just</font>

507
00:20:59,370 --> 00:21:03,899
email<font color="#CCCCCC"> me and I'll just give you</font><font color="#E5E5E5"> access</font>

508
00:21:01,440 --> 00:21:05,760
to the system<font color="#CCCCCC"> for free because</font><font color="#E5E5E5"> I mean I</font>

509
00:21:03,900 --> 00:21:07,020
<font color="#CCCCCC">just want to</font><font color="#E5E5E5"> get out there and and many</font>

510
00:21:05,760 --> 00:21:08,340
<font color="#E5E5E5">reason why we charge money is</font><font color="#CCCCCC"> just</font>

511
00:21:07,020 --> 00:21:10,320
because you don't<font color="#CCCCCC"> want</font><font color="#E5E5E5"> it flooded from</font>

512
00:21:08,340 --> 00:21:14,250
<font color="#E5E5E5">you know all these all these people</font>

513
00:21:10,320 --> 00:21:16,530
trying<font color="#E5E5E5"> to crack stupid things so you can</font>

514
00:21:14,250 --> 00:21:18,300
find<font color="#CCCCCC"> everything on crack that Sh on</font>

515
00:21:16,530 --> 00:21:22,860
github there's<font color="#E5E5E5"> links on the website as</font>

516
00:21:18,300 --> 00:21:24,690
<font color="#CCCCCC">well and and then also</font><font color="#E5E5E5"> just a quick plug</font>

517
00:21:22,860 --> 00:21:27,659
we have<font color="#E5E5E5"> torque on San Diego coming up</font>

518
00:21:24,690 --> 00:21:30,240
this<font color="#CCCCCC"> year at</font><font color="#E5E5E5"> the end of August and and</font>

519
00:21:27,660 --> 00:21:32,670
then we also have<font color="#CCCCCC"> tour camp which is the</font>

520
00:21:30,240 --> 00:21:34,650
<font color="#CCCCCC">u.s. hacker camp</font><font color="#E5E5E5"> next year on an island</font>

521
00:21:32,670 --> 00:21:37,200
in Washington which<font color="#E5E5E5"> is usually a lot of</font>

522
00:21:34,650 --> 00:21:39,590
<font color="#E5E5E5">fun so thanks for your time</font><font color="#CCCCCC"> I appreciate</font>

523
00:21:37,200 --> 00:21:39,590
<font color="#CCCCCC">it</font>

524
00:21:44,090 --> 00:21:55,429
any questions or comments complaints

525
00:21:51,430 --> 00:21:55,430
[Laughter]

526
00:21:57,140 --> 00:22:00,710
okay cool thanks

