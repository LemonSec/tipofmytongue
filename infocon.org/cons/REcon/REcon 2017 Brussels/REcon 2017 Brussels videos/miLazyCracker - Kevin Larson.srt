1
00:00:01,650 --> 00:00:13,309
[Music]

2
00:00:10,309 --> 00:00:13,309
2017

3
00:00:20,360 --> 00:00:25,230
so my name<font color="#E5E5E5"> is Kevin</font><font color="#CCCCCC"> large</font>

4
00:00:22,890 --> 00:00:27,240
this is the talk on my<font color="#E5E5E5"> for classic</font>

5
00:00:25,230 --> 00:00:29,580
<font color="#E5E5E5">cracking and it's not not going to get</font>

6
00:00:27,240 --> 00:00:31,650
in<font color="#CCCCCC"> just to what maybe many of</font><font color="#E5E5E5"> you</font>

7
00:00:29,580 --> 00:00:35,879
already know<font color="#E5E5E5"> have you heard</font><font color="#CCCCCC"> of MF OC and</font>

8
00:00:31,650 --> 00:00:37,530
that's the UK<font color="#CCCCCC"> a few people</font><font color="#E5E5E5"> all</font><font color="#CCCCCC"> right</font>

9
00:00:35,879 --> 00:00:39,089
that's been around for<font color="#CCCCCC"> quite a</font><font color="#E5E5E5"> while</font><font color="#CCCCCC"> so</font>

10
00:00:37,530 --> 00:00:41,670
the Mifare classic cards have<font color="#E5E5E5"> been able</font>

11
00:00:39,090 --> 00:00:43,590
<font color="#E5E5E5">to you can clone or crack them with free</font>

12
00:00:41,670 --> 00:00:47,430
<font color="#CCCCCC">open-source</font><font color="#E5E5E5"> tools</font><font color="#CCCCCC"> it's been around</font><font color="#E5E5E5"> for</font>

13
00:00:43,590 --> 00:00:48,890
<font color="#CCCCCC">quite a</font><font color="#E5E5E5"> while</font><font color="#CCCCCC"> but a little</font><font color="#E5E5E5"> bit about me</font>

14
00:00:47,430 --> 00:00:52,019
I'm a software<font color="#E5E5E5"> engineer</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> Honeywell</font>

15
00:00:48,890 --> 00:00:54,960
<font color="#E5E5E5">the disclaimer this is all my my work</font>

16
00:00:52,019 --> 00:00:59,430
for my master's degree<font color="#CCCCCC"> nothing to do</font>

17
00:00:54,960 --> 00:01:00,930
with my employer also<font color="#CCCCCC"> a note</font><font color="#E5E5E5"> I'm not</font>

18
00:00:59,430 --> 00:01:02,969
disclosing<font color="#CCCCCC"> anything that's</font><font color="#E5E5E5"> brand new</font>

19
00:01:00,930 --> 00:01:05,489
<font color="#E5E5E5">that's not out freely available on the</font>

20
00:01:02,969 --> 00:01:09,600
web so<font color="#CCCCCC"> nxb hopefully can't come run</font>

21
00:01:05,489 --> 00:01:12,149
after me when I leave<font color="#CCCCCC"> the Mifare classic</font>

22
00:01:09,600 --> 00:01:14,220
card is<font color="#E5E5E5"> just in in essence it's really</font>

23
00:01:12,149 --> 00:01:17,539
<font color="#E5E5E5">just a simple storage device</font>

24
00:01:14,220 --> 00:01:20,070
there's readwrite access per block and

25
00:01:17,539 --> 00:01:22,070
this is used<font color="#E5E5E5"> for things like a wallet</font>

26
00:01:20,070 --> 00:01:25,288
access<font color="#E5E5E5"> controlled transportation systems</font>

27
00:01:22,070 --> 00:01:27,330
<font color="#E5E5E5">getting in and</font><font color="#CCCCCC"> out</font><font color="#E5E5E5"> of your hotel and if</font>

28
00:01:25,289 --> 00:01:28,800
you notice maybe at<font color="#CCCCCC"> your hotel if you</font>

29
00:01:27,330 --> 00:01:30,810
wanted a late<font color="#E5E5E5"> check-out they might say</font>

30
00:01:28,800 --> 00:01:33,270
<font color="#E5E5E5">you have to bring your hotel car down to</font>

31
00:01:30,810 --> 00:01:35,369
<font color="#CCCCCC">the</font><font color="#E5E5E5"> front desk</font><font color="#CCCCCC"> we'll rescan it and you</font>

32
00:01:33,270 --> 00:01:36,810
can<font color="#E5E5E5"> check out an hour later</font><font color="#CCCCCC"> what</font><font color="#E5E5E5"> you can</font>

33
00:01:35,369 --> 00:01:38,789
<font color="#E5E5E5">really tell by that</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> there some</font>

34
00:01:36,810 --> 00:01:40,770
there's some<font color="#E5E5E5"> things that are</font><font color="#CCCCCC"> they're not</font>

35
00:01:38,789 --> 00:01:42,569
<font color="#CCCCCC">networked they're not doing server-side</font>

36
00:01:40,770 --> 00:01:45,440
checks there's there's local checks

37
00:01:42,569 --> 00:01:47,910
being done based on the data on the card

38
00:01:45,440 --> 00:01:49,890
the Mifare<font color="#E5E5E5"> classic actually used a</font>

39
00:01:47,910 --> 00:01:53,220
custom crypto library called crypto<font color="#CCCCCC"> 1</font>

40
00:01:49,890 --> 00:01:57,090
and the core of<font color="#E5E5E5"> that has been</font><font color="#CCCCCC"> broken for</font>

41
00:01:53,220 --> 00:02:00,479
quite some time<font color="#CCCCCC"> a little</font><font color="#E5E5E5"> background on</font>

42
00:01:57,090 --> 00:02:03,509
my<font color="#E5E5E5"> fair the memory layout this</font><font color="#CCCCCC"> is a 1k</font>

43
00:02:00,479 --> 00:02:05,520
card<font color="#E5E5E5"> so there's 16 sectors with</font><font color="#CCCCCC"> four</font>

44
00:02:03,509 --> 00:02:07,170
blocks each and there's a key a and<font color="#CCCCCC"> a</font>

45
00:02:05,520 --> 00:02:09,750
key B depending on if you<font color="#E5E5E5"> want to read</font>

46
00:02:07,170 --> 00:02:11,160
or write data for each block<font color="#E5E5E5"> so for a</font>

47
00:02:09,750 --> 00:02:12,900
<font color="#E5E5E5">typical card there's going to be some</font>

48
00:02:11,160 --> 00:02:14,310
default<font color="#CCCCCC"> information that the</font>

49
00:02:12,900 --> 00:02:16,440
manufacturer wants<font color="#E5E5E5"> you to be able to</font>

50
00:02:14,310 --> 00:02:18,450
<font color="#E5E5E5">read in</font><font color="#CCCCCC"> order to get</font><font color="#E5E5E5"> into the door or</font>

51
00:02:16,440 --> 00:02:20,489
just know what the card is and then

52
00:02:18,450 --> 00:02:21,869
there may be some<font color="#E5E5E5"> encrypted data like to</font>

53
00:02:20,489 --> 00:02:26,580
check<font color="#E5E5E5"> in</font><font color="#CCCCCC"> and check</font><font color="#E5E5E5"> out time of at a</font>

54
00:02:21,870 --> 00:02:31,230
hotel<font color="#E5E5E5"> or things</font><font color="#CCCCCC"> like</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> these</font><font color="#E5E5E5"> really</font>

55
00:02:26,580 --> 00:02:33,030
<font color="#E5E5E5">are</font><font color="#CCCCCC"> card only</font><font color="#E5E5E5"> attacks so what that means</font>

56
00:02:31,230 --> 00:02:34,859
is I don't<font color="#E5E5E5"> need</font><font color="#CCCCCC"> to be there's their</font>

57
00:02:33,030 --> 00:02:36,090
separate<font color="#CCCCCC"> different attacks</font><font color="#E5E5E5"> if you can</font>

58
00:02:34,860 --> 00:02:38,069
actually stand next<font color="#E5E5E5"> to a read</font>

59
00:02:36,090 --> 00:02:40,500
<font color="#E5E5E5">with a card and watch someone</font><font color="#CCCCCC"> actually</font>

60
00:02:38,069 --> 00:02:42,839
trying to<font color="#E5E5E5"> authenticate</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is only if</font>

61
00:02:40,500 --> 00:02:44,550
<font color="#CCCCCC">you have the card</font><font color="#E5E5E5"> by itself or if</font><font color="#CCCCCC"> you're</font>

62
00:02:42,840 --> 00:02:48,959
next<font color="#CCCCCC"> maybe someone on a subway if you're</font>

63
00:02:44,550 --> 00:02:50,879
in extremely close proximity<font color="#CCCCCC"> so what</font>

64
00:02:48,959 --> 00:02:54,150
we're<font color="#CCCCCC"> really using</font><font color="#E5E5E5"> here the basis is NFC</font>

65
00:02:50,879 --> 00:02:57,239
tools<font color="#CCCCCC"> for Mifare classic MS LC</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> M</font>

66
00:02:54,150 --> 00:02:59,459
<font color="#E5E5E5">fcuk</font><font color="#CCCCCC"> M FOC relies on the fact that you</font>

67
00:02:57,239 --> 00:03:02,220
know one key on<font color="#CCCCCC"> the entire card and</font>

68
00:02:59,459 --> 00:03:04,110
based on<font color="#E5E5E5"> that you</font><font color="#CCCCCC"> can you can do some</font>

69
00:03:02,220 --> 00:03:06,180
attacks to get all the keys on<font color="#E5E5E5"> the rest</font>

70
00:03:04,110 --> 00:03:08,549
of<font color="#CCCCCC"> the card</font><font color="#E5E5E5"> in practice there's almost</font>

71
00:03:06,180 --> 00:03:10,620
<font color="#E5E5E5">always one default key of all</font><font color="#CCCCCC"> F s--</font>

72
00:03:08,549 --> 00:03:11,930
just so you<font color="#E5E5E5"> can read the card type and</font>

73
00:03:10,620 --> 00:03:14,430
the size<font color="#CCCCCC"> and things like</font><font color="#E5E5E5"> that</font>

74
00:03:11,930 --> 00:03:16,250
there's also<font color="#E5E5E5"> another tool</font><font color="#CCCCCC"> called M fcuk</font>

75
00:03:14,430 --> 00:03:19,230
<font color="#E5E5E5">if you don't know any keys on the card</font>

76
00:03:16,250 --> 00:03:20,610
<font color="#CCCCCC">it takes a lot longer it's not</font><font color="#E5E5E5"> quite as</font>

77
00:03:19,230 --> 00:03:24,569
practical and<font color="#E5E5E5"> it's very rare you'll</font>

78
00:03:20,610 --> 00:03:27,030
actually need that<font color="#CCCCCC"> so nxb responded</font><font color="#E5E5E5"> to</font>

79
00:03:24,569 --> 00:03:30,238
<font color="#E5E5E5">these tools after</font><font color="#CCCCCC"> a while with a Mifare</font>

80
00:03:27,030 --> 00:03:33,269
plus card which is<font color="#E5E5E5"> which</font><font color="#CCCCCC"> has an Aes</font>

81
00:03:30,239 --> 00:03:34,500
option<font color="#CCCCCC"> what that means is is that they</font>

82
00:03:33,269 --> 00:03:36,510
really<font color="#E5E5E5"> wanted to be able to allow people</font>

83
00:03:34,500 --> 00:03:38,819
<font color="#E5E5E5">to update their readers in a building or</font>

84
00:03:36,510 --> 00:03:42,840
a transportation system while still

85
00:03:38,819 --> 00:03:44,458
<font color="#CCCCCC">using the old cards</font><font color="#E5E5E5"> and updating some</font>

86
00:03:42,840 --> 00:03:46,769
<font color="#CCCCCC">readers and leaving some at the same</font>

87
00:03:44,459 --> 00:03:48,510
time because<font color="#E5E5E5"> it's too expensive for the</font>

88
00:03:46,769 --> 00:03:51,299
<font color="#E5E5E5">infrastructure cost to actually</font><font color="#CCCCCC"> update</font>

89
00:03:48,510 --> 00:03:53,819
everything<font color="#E5E5E5"> all at once</font><font color="#CCCCCC"> what this means</font>

90
00:03:51,299 --> 00:03:55,349
though is<font color="#E5E5E5"> that you may be using AES for</font>

91
00:03:53,819 --> 00:03:58,319
some readers<font color="#E5E5E5"> but you're still using the</font>

92
00:03:55,349 --> 00:04:01,078
<font color="#CCCCCC">old</font><font color="#E5E5E5"> system with the crypto one custom</font>

93
00:03:58,319 --> 00:04:02,130
library for old readers<font color="#CCCCCC"> the other thing</font>

94
00:04:01,079 --> 00:04:03,630
they did do is they fix the

95
00:04:02,130 --> 00:04:06,269
pseudo-random number generator so it's

96
00:04:03,630 --> 00:04:07,709
not vulnerable to<font color="#E5E5E5"> MSL</font><font color="#CCCCCC"> crms the UK</font><font color="#E5E5E5"> so I</font>

97
00:04:06,269 --> 00:04:09,630
don't know if any of<font color="#E5E5E5"> you using</font><font color="#CCCCCC"> that and</font>

98
00:04:07,709 --> 00:04:11,099
you have a new card you're trying to use

99
00:04:09,630 --> 00:04:13,079
and it's not<font color="#E5E5E5"> working</font>

100
00:04:11,099 --> 00:04:16,048
it'll sit in<font color="#E5E5E5"> you can sit and try all</font>

101
00:04:13,079 --> 00:04:19,320
night it's not<font color="#E5E5E5"> going to work so</font><font color="#CCCCCC"> what</font>

102
00:04:16,048 --> 00:04:23,638
they've done<font color="#CCCCCC"> is they fix this so it's a</font>

103
00:04:19,320 --> 00:04:26,099
little<font color="#CCCCCC"> bit more</font><font color="#E5E5E5"> secure so there's been</font>

104
00:04:23,639 --> 00:04:29,240
<font color="#E5E5E5">some research done by</font><font color="#CCCCCC"> carlo and</font><font color="#E5E5E5"> roll</font>

105
00:04:26,099 --> 00:04:32,880
<font color="#E5E5E5">they found new card only attacks for the</font>

106
00:04:29,240 --> 00:04:36,060
<font color="#E5E5E5">for the Mifare plus in SL 1 mode SL 1</font>

107
00:04:32,880 --> 00:04:37,680
means<font color="#E5E5E5"> that you have the old crypto one</font>

108
00:04:36,060 --> 00:04:40,260
library being used for<font color="#E5E5E5"> the old readers</font>

109
00:04:37,680 --> 00:04:43,410
along with potentially another block on

110
00:04:40,260 --> 00:04:45,650
<font color="#E5E5E5">the card using</font><font color="#CCCCCC"> AES this is important</font>

111
00:04:43,410 --> 00:04:49,120
because<font color="#E5E5E5"> most installations did not</font>

112
00:04:45,650 --> 00:04:54,099
completely reinstall all of<font color="#E5E5E5"> their</font>

113
00:04:49,120 --> 00:04:56,680
<font color="#E5E5E5">all the readers</font><font color="#CCCCCC"> so my goal is really</font>

114
00:04:54,100 --> 00:04:58,000
<font color="#E5E5E5">were to reproduce the attack and see if</font>

115
00:04:56,680 --> 00:05:00,580
I can make<font color="#E5E5E5"> it faster</font><font color="#CCCCCC"> see if I could make</font>

116
00:04:58,000 --> 00:05:01,840
<font color="#CCCCCC">it real-time</font><font color="#E5E5E5"> could I really bump into</font>

117
00:05:00,580 --> 00:05:03,270
<font color="#E5E5E5">someone like you see in the movies could</font>

118
00:05:01,840 --> 00:05:05,440
<font color="#E5E5E5">you bump</font><font color="#CCCCCC"> into someone on a subway</font>

119
00:05:03,270 --> 00:05:09,219
actually copy their card follow them

120
00:05:05,440 --> 00:05:11,620
<font color="#E5E5E5">into work things like that so some</font><font color="#CCCCCC"> of</font>

121
00:05:09,220 --> 00:05:14,760
the hardware<font color="#CCCCCC"> and</font><font color="#E5E5E5"> tools I used with the</font>

122
00:05:11,620 --> 00:05:17,470
<font color="#CCCCCC">SCL 37:11 is just like a $30 USB reader</font>

123
00:05:14,760 --> 00:05:18,820
<font color="#CCCCCC">the proxmark</font><font color="#E5E5E5"> which is gets a little bit</font>

124
00:05:17,470 --> 00:05:21,070
more expensive<font color="#CCCCCC"> but has a very active</font>

125
00:05:18,820 --> 00:05:23,620
<font color="#CCCCCC">community so that was really a useful</font>

126
00:05:21,070 --> 00:05:24,789
<font color="#E5E5E5">tool to learn the core of what what I</font>

127
00:05:23,620 --> 00:05:27,460
needed<font color="#E5E5E5"> to do</font>

128
00:05:24,789 --> 00:05:29,530
Mifare plus cards and the reader with

129
00:05:27,460 --> 00:05:31,448
config software to actually<font color="#E5E5E5"> take</font>

130
00:05:29,530 --> 00:05:35,229
<font color="#E5E5E5">factory-fresh cards configure them like</font>

131
00:05:31,449 --> 00:05:37,750
a hotel<font color="#CCCCCC"> night or a transportation</font><font color="#E5E5E5"> system</font>

132
00:05:35,229 --> 00:05:41,139
and<font color="#E5E5E5"> then I bought this crappy</font><font color="#CCCCCC"> Evie lock</font>

133
00:05:37,750 --> 00:05:43,150
for 80 bucks of<font color="#CCCCCC"> ebay if you want to get</font>

134
00:05:41,139 --> 00:05:48,460
checked<font color="#CCCCCC"> by</font><font color="#E5E5E5"> TSA put one of those in your</font>

135
00:05:43,150 --> 00:05:50,799
checked bag<font color="#CCCCCC"> one of the things to note is</font>

136
00:05:48,460 --> 00:05:53,590
that the mistake I made<font color="#CCCCCC"> in buying</font><font color="#E5E5E5"> this</font>

137
00:05:50,800 --> 00:05:55,690
is actually not<font color="#CCCCCC"> all my</font><font color="#E5E5E5"> fur classic</font>

138
00:05:53,590 --> 00:05:57,820
readers<font color="#E5E5E5"> accept my fare plus as was</font>

139
00:05:55,690 --> 00:05:59,500
<font color="#E5E5E5">intended the Mifare plus card takes a</font>

140
00:05:57,820 --> 00:06:02,020
little<font color="#E5E5E5"> bit longer</font><font color="#CCCCCC"> for the</font><font color="#E5E5E5"> authentication</font>

141
00:05:59,500 --> 00:06:07,990
<font color="#E5E5E5">so this this lock actually doesn't even</font>

142
00:06:02,020 --> 00:06:09,789
<font color="#E5E5E5">work with Mifare plus cards</font><font color="#CCCCCC"> so the new</font>

143
00:06:07,990 --> 00:06:12,039
attack is it's dubbed the hard nested

144
00:06:09,789 --> 00:06:14,889
attack because it's it's<font color="#CCCCCC"> a</font><font color="#E5E5E5"> extension of</font>

145
00:06:12,039 --> 00:06:17,039
the existing nested attack on my<font color="#CCCCCC"> fare</font>

146
00:06:14,889 --> 00:06:20,979
<font color="#E5E5E5">plus cards which have</font><font color="#CCCCCC"> a hardened PRNG</font>

147
00:06:17,039 --> 00:06:22,990
it still requires one known key and what

148
00:06:20,979 --> 00:06:25,360
you do is you take you do many attempts

149
00:06:22,990 --> 00:06:29,320
at a nested authentication you collect

150
00:06:25,360 --> 00:06:32,260
the encrypted<font color="#E5E5E5"> unique encrypted nonces</font>

151
00:06:29,320 --> 00:06:33,699
between the known sector you have<font color="#CCCCCC"> the</font>

152
00:06:32,260 --> 00:06:36,580
key<font color="#CCCCCC"> 4 and the unknown sector</font><font color="#E5E5E5"> you're</font>

153
00:06:33,699 --> 00:06:38,650
trying to get<font color="#E5E5E5"> the key for with enough of</font>

154
00:06:36,580 --> 00:06:40,330
<font color="#E5E5E5">those tries there's some leak bits</font><font color="#CCCCCC"> and</font>

155
00:06:38,650 --> 00:06:42,638
you can<font color="#E5E5E5"> what you're basically trying to</font>

156
00:06:40,330 --> 00:06:44,919
<font color="#E5E5E5">do is reduce the</font><font color="#CCCCCC"> key</font><font color="#E5E5E5"> space from like</font><font color="#CCCCCC"> 2</font>

157
00:06:42,639 --> 00:06:47,620
to the 48 which is a<font color="#CCCCCC"> Mifare classic key</font>

158
00:06:44,919 --> 00:06:48,940
size down<font color="#E5E5E5"> to about</font><font color="#CCCCCC"> 2 to the 20 maybe</font><font color="#E5E5E5"> a</font>

159
00:06:47,620 --> 00:06:53,500
<font color="#E5E5E5">little bit bigger but then from there</font>

160
00:06:48,940 --> 00:06:55,690
you<font color="#E5E5E5"> can do a</font><font color="#CCCCCC"> brute-force so what did I</font>

161
00:06:53,500 --> 00:06:57,789
actually do I I tried to improve the

162
00:06:55,690 --> 00:06:59,289
<font color="#E5E5E5">attack but but really there's there's</font>

163
00:06:57,789 --> 00:07:01,000
people who don't<font color="#E5E5E5"> sleep and</font><font color="#CCCCCC"> a lot smarter</font>

164
00:06:59,289 --> 00:07:03,009
than<font color="#E5E5E5"> me who work on this all the</font><font color="#CCCCCC"> time</font>

165
00:07:01,000 --> 00:07:06,490
and they basically<font color="#E5E5E5"> reduce that down</font><font color="#CCCCCC"> so</font>

166
00:07:03,009 --> 00:07:08,199
almost the physical constraint of just

167
00:07:06,490 --> 00:07:12,069
the time it<font color="#CCCCCC"> takes to</font><font color="#E5E5E5"> authenticate a card</font>

168
00:07:08,199 --> 00:07:13,449
to the<font color="#CCCCCC"> reader so my goal is really just</font>

169
00:07:12,069 --> 00:07:15,969
to<font color="#CCCCCC"> make this easy to</font><font color="#E5E5E5"> use it took me a</font>

170
00:07:13,449 --> 00:07:18,550
month or two<font color="#E5E5E5"> of you know my spare time</font>

171
00:07:15,969 --> 00:07:20,830
<font color="#E5E5E5">and a fair amount of money to get this</font>

172
00:07:18,550 --> 00:07:22,180
up and running<font color="#E5E5E5"> so I figured if I can do</font>

173
00:07:20,830 --> 00:07:23,919
it<font color="#CCCCCC"> for twenty bucks</font><font color="#E5E5E5"> and no one has to</font>

174
00:07:22,180 --> 00:07:26,889
type in<font color="#E5E5E5"> a single command then maybe</font>

175
00:07:23,919 --> 00:07:29,198
<font color="#E5E5E5">it'll</font><font color="#CCCCCC"> get used a little</font><font color="#E5E5E5"> bit</font><font color="#CCCCCC"> more</font><font color="#E5E5E5"> so the</font>

176
00:07:26,889 --> 00:07:31,990
point of this is I think<font color="#E5E5E5"> everybody's</font>

177
00:07:29,199 --> 00:07:34,659
lazy I'm lazy<font color="#CCCCCC"> if you don't know if you</font>

178
00:07:31,990 --> 00:07:35,800
have a<font color="#E5E5E5"> my</font><font color="#CCCCCC"> for classic or Mifare plus you</font>

179
00:07:34,659 --> 00:07:37,509
<font color="#E5E5E5">don't know what kind</font><font color="#CCCCCC"> of pseudo random</font>

180
00:07:35,800 --> 00:07:38,979
number generator has you don't<font color="#E5E5E5"> want to</font>

181
00:07:37,509 --> 00:07:41,110
spend<font color="#CCCCCC"> two</font><font color="#E5E5E5"> hundred dollars or a months</font>

182
00:07:38,979 --> 00:07:43,120
trying to figure<font color="#CCCCCC"> this out</font><font color="#E5E5E5"> all you have</font>

183
00:07:41,110 --> 00:07:45,279
to<font color="#E5E5E5"> do is</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> download this there's a</font>

184
00:07:43,120 --> 00:07:48,189
<font color="#E5E5E5">installed script and you can run it with</font>

185
00:07:45,279 --> 00:07:51,789
no arguments<font color="#E5E5E5"> to to find the keys on your</font>

186
00:07:48,189 --> 00:07:54,189
<font color="#E5E5E5">card so really what I did here is I</font>

187
00:07:51,789 --> 00:07:56,020
modified the live NFC version of<font color="#CCCCCC"> MF OC</font>

188
00:07:54,189 --> 00:07:57,849
to identify if it has a new

189
00:07:56,020 --> 00:08:01,479
pseudo-random number generator<font color="#CCCCCC"> which is</font>

190
00:07:57,849 --> 00:08:03,729
not vulnerable<font color="#CCCCCC"> or the old one I modified</font>

191
00:08:01,479 --> 00:08:06,938
the live<font color="#CCCCCC"> NFC version of the heart of</font><font color="#E5E5E5"> the</font>

192
00:08:03,729 --> 00:08:08,740
hard nested attack to just hold<font color="#E5E5E5"> on to</font>

193
00:08:06,939 --> 00:08:09,939
some more<font color="#CCCCCC"> information so I</font><font color="#E5E5E5"> can automate</font>

194
00:08:08,740 --> 00:08:12,550
this and you<font color="#E5E5E5"> don't have to figure out</font>

195
00:08:09,939 --> 00:08:14,709
<font color="#E5E5E5">what keys are unknown and</font><font color="#CCCCCC"> type in more</font>

196
00:08:12,550 --> 00:08:16,509
parameters and<font color="#E5E5E5"> I also created a wrapper</font>

197
00:08:14,709 --> 00:08:19,689
script<font color="#E5E5E5"> to just figure this all out so</font>

198
00:08:16,509 --> 00:08:21,939
<font color="#E5E5E5">you can just run</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> with no problem so</font>

199
00:08:19,689 --> 00:08:23,409
here's a kind of a static demo of what

200
00:08:21,939 --> 00:08:24,580
<font color="#E5E5E5">would happen if you were running if you</font>

201
00:08:23,409 --> 00:08:27,789
didn't know if<font color="#E5E5E5"> you had</font><font color="#CCCCCC"> a Mifare classic</font>

202
00:08:24,580 --> 00:08:31,389
or Mifare plus you would just run<font color="#E5E5E5"> my</font>

203
00:08:27,789 --> 00:08:32,740
lazy cracker the the script<font color="#CCCCCC"> and the</font>

204
00:08:31,389 --> 00:08:34,599
first thing you would see is it would it

205
00:08:32,740 --> 00:08:36,519
<font color="#CCCCCC">would kind of identify do you have am i</font>

206
00:08:34,599 --> 00:08:39,069
<font color="#E5E5E5">fair or do you have a Mifare plus card</font>

207
00:08:36,519 --> 00:08:41,019
<font color="#E5E5E5">and from there it'll pick which attack</font>

208
00:08:39,068 --> 00:08:44,439
to use and in<font color="#E5E5E5"> this case it's a Mifare</font>

209
00:08:41,019 --> 00:08:46,600
plus and it will highlight what keys are

210
00:08:44,440 --> 00:08:48,069
unknown in what sectors<font color="#E5E5E5"> and it will just</font>

211
00:08:46,600 --> 00:08:52,360
<font color="#CCCCCC">recursively go</font><font color="#E5E5E5"> through and find those</font>

212
00:08:48,069 --> 00:08:54,310
keys for you so in this case it<font color="#E5E5E5"> makes it</font>

213
00:08:52,360 --> 00:08:55,949
known it says<font color="#CCCCCC"> PRNG is not vulnerable</font><font color="#E5E5E5"> to</font>

214
00:08:54,310 --> 00:08:59,138
the<font color="#E5E5E5"> nested</font><font color="#CCCCCC"> attacks so I'm selecting</font><font color="#E5E5E5"> the</font>

215
00:08:55,949 --> 00:09:01,689
<font color="#E5E5E5">hardness</font><font color="#CCCCCC"> attacks the in the</font><font color="#E5E5E5"> read there</font>

216
00:08:59,139 --> 00:09:03,190
it's it's selecting<font color="#E5E5E5"> the parameters for</font>

217
00:09:01,690 --> 00:09:04,630
you so you<font color="#E5E5E5"> don't have to understand what</font>

218
00:09:03,190 --> 00:09:07,899
<font color="#CCCCCC">really that is what</font><font color="#E5E5E5"> that's actually</font>

219
00:09:04,630 --> 00:09:11,079
doing is<font color="#E5E5E5"> saying I know that sector</font>

220
00:09:07,899 --> 00:09:12,610
block<font color="#CCCCCC"> 60 and TV is all zeros</font><font color="#E5E5E5"> you can use</font>

221
00:09:11,079 --> 00:09:15,339
that to try and authenticate<font color="#CCCCCC"> to another</font>

222
00:09:12,610 --> 00:09:21,759
unknown sector<font color="#E5E5E5"> 48 TV and try and crack</font>

223
00:09:15,339 --> 00:09:24,639
<font color="#CCCCCC">that so as it goes through</font><font color="#E5E5E5"> its finding</font>

224
00:09:21,759 --> 00:09:26,139
each key for you and in the red<font color="#CCCCCC"> you can</font>

225
00:09:24,639 --> 00:09:27,579
see<font color="#E5E5E5"> that there's it's finding separate</font>

226
00:09:26,139 --> 00:09:28,749
keys for key a and<font color="#CCCCCC"> key B and there's</font>

227
00:09:27,579 --> 00:09:31,989
still<font color="#E5E5E5"> one</font><font color="#CCCCCC"> key</font><font color="#E5E5E5"> left</font>

228
00:09:28,749 --> 00:09:33,579
sometimes the attack does fail<font color="#CCCCCC"> it tries</font>

229
00:09:31,990 --> 00:09:36,100
to<font color="#CCCCCC"> reduce the key</font><font color="#E5E5E5"> space down to a</font>

230
00:09:33,579 --> 00:09:37,989
certain<font color="#CCCCCC"> size and do this amass I don't</font>

231
00:09:36,100 --> 00:09:40,709
understand it gives up once in a while

232
00:09:37,990 --> 00:09:44,230
<font color="#CCCCCC">if</font><font color="#E5E5E5"> you just try again it seems to</font><font color="#CCCCCC"> work</font>

233
00:09:40,709 --> 00:09:46,540
<font color="#CCCCCC">so in this case</font><font color="#E5E5E5"> it's found three keys</font>

234
00:09:44,230 --> 00:09:48,459
<font color="#CCCCCC">and once you've found all keys for all</font>

235
00:09:46,540 --> 00:09:50,550
sectors<font color="#E5E5E5"> it just</font><font color="#CCCCCC"> dumps it to a to a</font>

236
00:09:48,459 --> 00:09:53,378
<font color="#CCCCCC">binary file</font><font color="#E5E5E5"> and from there you can</font>

237
00:09:50,550 --> 00:09:56,160
<font color="#E5E5E5">basically clone the card with with a lot</font>

238
00:09:53,379 --> 00:09:58,449
of<font color="#E5E5E5"> with NFC classic open</font><font color="#CCCCCC"> source tools</font>

239
00:09:56,160 --> 00:09:59,920
included in<font color="#CCCCCC"> the</font><font color="#E5E5E5"> script I made it'll just</font>

240
00:09:58,449 --> 00:10:03,279
ask you do you<font color="#CCCCCC"> want to</font><font color="#E5E5E5"> clone it yes or</font>

241
00:09:59,920 --> 00:10:04,899
no<font color="#E5E5E5"> so you can just put a blank card</font><font color="#CCCCCC"> on</font>

242
00:10:03,279 --> 00:10:06,759
there as<font color="#CCCCCC"> well if you want</font><font color="#E5E5E5"> if you want to</font>

243
00:10:04,899 --> 00:10:09,670
copy<font color="#E5E5E5"> it and you have a clone</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the card</font>

244
00:10:06,759 --> 00:10:13,059
<font color="#CCCCCC">the key for</font><font color="#E5E5E5"> the that you would need is</font>

245
00:10:09,670 --> 00:10:16,149
that<font color="#E5E5E5"> the UID on a my flat classic card</font>

246
00:10:13,059 --> 00:10:18,610
is read-only<font color="#E5E5E5"> and there's some Chinese</font>

247
00:10:16,149 --> 00:10:22,360
magic<font color="#E5E5E5"> cards which allow you to write to</font>

248
00:10:18,610 --> 00:10:24,100
<font color="#CCCCCC">that sector so you do need</font><font color="#E5E5E5"> to buy you go</font>

249
00:10:22,360 --> 00:10:25,389
to Alibaba or something and buy some

250
00:10:24,100 --> 00:10:29,999
magic

251
00:10:25,389 --> 00:10:29,999
Mifare plus cards or magic<font color="#E5E5E5"> my fare cards</font>

252
00:10:30,059 --> 00:10:36,699
so the source code is released<font color="#E5E5E5"> it's here</font>

253
00:10:34,629 --> 00:10:39,850
it's on github it's been<font color="#E5E5E5"> tested by a few</font>

254
00:10:36,699 --> 00:10:41,709
people<font color="#CCCCCC"> if you guys</font><font color="#E5E5E5"> ever go to troopers</font>

255
00:10:39,850 --> 00:10:44,920
in Germany and<font color="#CCCCCC"> heidelberg there's a</font>

256
00:10:41,709 --> 00:10:47,349
great<font color="#E5E5E5"> training called</font><font color="#CCCCCC"> rfid security and</font>

257
00:10:44,920 --> 00:10:48,459
privacy nightmares<font color="#E5E5E5"> these the guys that</font>

258
00:10:47,350 --> 00:10:49,779
give<font color="#E5E5E5"> this training</font><font color="#CCCCCC"> were the ones that</font>

259
00:10:48,459 --> 00:10:51,099
<font color="#E5E5E5">kind of got me interested in this so I</font>

260
00:10:49,779 --> 00:10:57,579
highly<font color="#CCCCCC"> recommend that</font><font color="#E5E5E5"> if</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> guys are</font>

261
00:10:51,100 --> 00:10:59,019
heading to troopers this year and I have

262
00:10:57,579 --> 00:11:01,229
<font color="#CCCCCC">a</font><font color="#E5E5E5"> short demo here if you want to see you</font>

263
00:10:59,019 --> 00:11:01,230
live

264
00:11:07,490 --> 00:11:12,090
so here I<font color="#CCCCCC"> have a Mifare plus card this</font>

265
00:11:10,530 --> 00:11:19,140
would not you could not crack this with

266
00:11:12,090 --> 00:11:24,350
<font color="#CCCCCC">n FOC so all you have to</font><font color="#E5E5E5"> do is run this</font>

267
00:11:19,140 --> 00:11:24,350
if you could<font color="#E5E5E5"> actually see it here you go</font>

268
00:11:24,410 --> 00:11:32,819
so what it's<font color="#CCCCCC"> doing here all I started</font>

269
00:11:28,470 --> 00:11:34,920
<font color="#CCCCCC">over well</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> can see it I just ran the</font>

270
00:11:32,820 --> 00:11:36,960
<font color="#E5E5E5">script with no parameters you can see</font>

271
00:11:34,920 --> 00:11:39,780
here that<font color="#CCCCCC"> there's two there's two keys</font>

272
00:11:36,960 --> 00:11:42,150
that<font color="#CCCCCC"> are</font><font color="#E5E5E5"> unknown TA and TB for sector 13</font>

273
00:11:39,780 --> 00:11:43,800
so here it's actually all it's trying to

274
00:11:42,150 --> 00:11:45,090
do is authenticate to<font color="#E5E5E5"> the card over</font><font color="#CCCCCC"> and</font>

275
00:11:43,800 --> 00:11:48,270
over<font color="#E5E5E5"> and over</font><font color="#CCCCCC"> again collecting different</font>

276
00:11:45,090 --> 00:11:50,070
unique encrypted nonces<font color="#E5E5E5"> and after a</font>

277
00:11:48,270 --> 00:11:51,840
short<font color="#CCCCCC"> period</font><font color="#E5E5E5"> of time it kind of varies</font>

278
00:11:50,070 --> 00:11:54,070
depending on<font color="#CCCCCC"> the card and</font><font color="#E5E5E5"> the key how</font>

279
00:11:51,840 --> 00:11:57,179
long it will take

280
00:11:54,070 --> 00:11:57,179
[Music]

281
00:12:05,350 --> 00:12:09,200
and while that's<font color="#E5E5E5"> running I have another</font>

282
00:12:07,820 --> 00:12:11,000
demo with<font color="#CCCCCC"> the relock and if you guys</font>

283
00:12:09,200 --> 00:12:13,700
have interest you can stop by<font color="#E5E5E5"> see me</font>

284
00:12:11,000 --> 00:12:15,410
afterward<font color="#CCCCCC"> so this this actually</font><font color="#E5E5E5"> works</font>

285
00:12:13,700 --> 00:12:18,590
with<font color="#CCCCCC"> Mifare classic it doesn't work with</font>

286
00:12:15,410 --> 00:12:20,270
the<font color="#E5E5E5"> with the plus because it's a bad</font>

287
00:12:18,590 --> 00:12:22,790
luck I bought off<font color="#E5E5E5"> eBay so you can see</font>

288
00:12:20,270 --> 00:12:25,250
here<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is a card that actually allows</font>

289
00:12:22,790 --> 00:12:30,650
me<font color="#CCCCCC"> to enter the enter</font><font color="#E5E5E5"> the room it turns</font>

290
00:12:25,250 --> 00:12:33,200
blue this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> key that does not it's</font>

291
00:12:30,650 --> 00:12:34,579
another key<font color="#E5E5E5"> that does not and I'll show</font>

292
00:12:33,200 --> 00:12:52,970
you<font color="#CCCCCC"> that I can</font><font color="#E5E5E5"> clone that and enter the</font>

293
00:12:34,580 --> 00:12:55,910
door pretty pretty quickly this<font color="#CCCCCC"> is a</font>

294
00:12:52,970 --> 00:12:58,880
<font color="#CCCCCC">runtime of</font><font color="#E5E5E5"> approximately between</font><font color="#CCCCCC"> I would</font>

295
00:12:55,910 --> 00:13:00,410
<font color="#E5E5E5">say five minutes</font><font color="#CCCCCC"> to to an hour and I</font>

296
00:12:58,880 --> 00:13:02,830
didn't pick a key that takes an hour

297
00:13:00,410 --> 00:13:02,829
don't worry

298
00:13:21,089 --> 00:13:26,619
and in the output<font color="#CCCCCC"> of the script</font><font color="#E5E5E5"> you can</font>

299
00:13:23,860 --> 00:13:28,299
see here it's actually<font color="#E5E5E5"> it said the</font><font color="#CCCCCC"> pran</font>

300
00:13:26,619 --> 00:13:30,549
<font color="#CCCCCC">G is</font><font color="#E5E5E5"> not vulnerable to the</font><font color="#CCCCCC"> neset</font><font color="#E5E5E5"> attack</font>

301
00:13:28,299 --> 00:13:35,499
so it automatically selects the<font color="#CCCCCC"> sector's</font>

302
00:13:30,549 --> 00:13:37,660
to use and here<font color="#E5E5E5"> it's it reduced the key</font>

303
00:13:35,499 --> 00:13:40,899
<font color="#E5E5E5">space down to like</font><font color="#CCCCCC"> 2 to the 36 so it's</font>

304
00:13:37,660 --> 00:13:42,160
going to brute force from here this

305
00:13:40,899 --> 00:13:44,829
might go a little<font color="#E5E5E5"> bit faster with a</font>

306
00:13:42,160 --> 00:13:47,219
better laptop but<font color="#E5E5E5"> it should do the trick</font>

307
00:13:44,829 --> 00:13:47,219
<font color="#E5E5E5">here</font>

308
00:13:55,139 --> 00:13:59,529
so another another<font color="#E5E5E5"> note I guess for for</font>

309
00:13:58,089 --> 00:14:02,019
<font color="#E5E5E5">things like hotels and</font><font color="#CCCCCC"> things like that</font>

310
00:13:59,529 --> 00:14:04,269
<font color="#E5E5E5">most of them are</font><font color="#CCCCCC"> using</font><font color="#E5E5E5"> their kind of</font>

311
00:14:02,019 --> 00:14:06,879
their own<font color="#E5E5E5"> version of encryption or or a</font>

312
00:14:04,269 --> 00:14:09,579
data format on the card so it's not<font color="#E5E5E5"> like</font>

313
00:14:06,879 --> 00:14:11,559
if you can crack the card for<font color="#E5E5E5"> one hotel</font>

314
00:14:09,579 --> 00:14:13,209
you can change<font color="#E5E5E5"> your check-in time for</font>

315
00:14:11,559 --> 00:14:16,149
every<font color="#CCCCCC"> Hotel</font><font color="#E5E5E5"> things like that are</font>

316
00:14:13,209 --> 00:14:18,819
typically proprietary so in<font color="#E5E5E5"> this case</font>

317
00:14:16,149 --> 00:14:20,769
it's<font color="#E5E5E5"> it's found the keys on this card</font>

318
00:14:18,819 --> 00:14:22,479
and<font color="#E5E5E5"> says</font><font color="#CCCCCC"> you want to clone the card</font><font color="#E5E5E5"> you</font>

319
00:14:20,769 --> 00:14:28,869
could say yes<font color="#E5E5E5"> or no put a new card on</font>

320
00:14:22,480 --> 00:14:31,149
and you'd be able<font color="#E5E5E5"> to clone the card and</font>

321
00:14:28,869 --> 00:14:35,079
so here's the case where this card did

322
00:14:31,149 --> 00:14:38,999
not let<font color="#E5E5E5"> me in the in in the</font><font color="#CCCCCC"> lock before</font>

323
00:14:35,079 --> 00:14:38,998
<font color="#E5E5E5">I'm just</font><font color="#CCCCCC"> going to run the script</font>

324
00:14:44,320 --> 00:14:48,730
and in this case it was it's<font color="#E5E5E5"> not a my</font>

325
00:14:47,259 --> 00:14:57,399
<font color="#CCCCCC">four plus card so it's able to crack it</font>

326
00:14:48,730 --> 00:15:04,319
<font color="#E5E5E5">very very very fast and</font><font color="#CCCCCC"> I can say yep</font>

327
00:14:57,399 --> 00:15:06,579
<font color="#E5E5E5">clone the card I cloned the wrong one</font>

328
00:15:04,319 --> 00:15:11,079
that's the demo<font color="#E5E5E5"> that's why I had a</font>

329
00:15:06,579 --> 00:15:18,699
static demo<font color="#CCCCCC"> alright here's the card</font><font color="#E5E5E5"> that</font>

330
00:15:11,079 --> 00:15:23,229
got me in and yes I want<font color="#E5E5E5"> to clone the</font>

331
00:15:18,699 --> 00:15:31,740
card<font color="#E5E5E5"> onto my onto my chinese clone which</font>

332
00:15:23,230 --> 00:15:53,139
doesn't want to stay so<font color="#CCCCCC"> i say yes so and</font>

333
00:15:31,740 --> 00:15:56,319
now<font color="#CCCCCC"> i can get in any questions so the</font>

334
00:15:53,139 --> 00:15:58,810
phase where you collect<font color="#E5E5E5"> numbers you need</font>

335
00:15:56,319 --> 00:16:01,990
<font color="#E5E5E5">to have the</font><font color="#CCCCCC"> cards physically the whole</font>

336
00:15:58,810 --> 00:16:05,138
time or<font color="#E5E5E5"> can you do a dump you need to</font>

337
00:16:01,990 --> 00:16:07,089
have the card<font color="#E5E5E5"> in order</font><font color="#CCCCCC"> to do with dump</font>

338
00:16:05,139 --> 00:16:08,500
you have to have the keys so in order<font color="#E5E5E5"> to</font>

339
00:16:07,089 --> 00:16:11,139
read<font color="#E5E5E5"> certain sectors you need to have</font>

340
00:16:08,500 --> 00:16:12,819
the keys<font color="#E5E5E5"> so you need to have you need to</font>

341
00:16:11,139 --> 00:16:14,889
<font color="#E5E5E5">have the card on</font><font color="#CCCCCC"> the reader during the</font>

342
00:16:12,819 --> 00:16:19,599
collection<font color="#CCCCCC"> process but you don't need</font><font color="#E5E5E5"> it</font>

343
00:16:14,889 --> 00:16:22,000
<font color="#E5E5E5">for the proof</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> space okay how long</font>

344
00:16:19,600 --> 00:16:23,380
<font color="#CCCCCC">does the gathering take how</font><font color="#E5E5E5"> long the</font><font color="#CCCCCC"> how</font>

345
00:16:22,000 --> 00:16:26,470
long do you need physical<font color="#E5E5E5"> access</font><font color="#CCCCCC"> to the</font>

346
00:16:23,380 --> 00:16:29,649
cost it typically depends on the card or

347
00:16:26,470 --> 00:16:32,139
<font color="#CCCCCC">the</font><font color="#E5E5E5"> key or which key it is like from my</font>

348
00:16:29,649 --> 00:16:34,269
what I've seen is between<font color="#CCCCCC"> five minutes</font>

349
00:16:32,139 --> 00:16:36,220
and an hour so it's not it's certainly

350
00:16:34,269 --> 00:16:38,529
<font color="#E5E5E5">not a</font><font color="#CCCCCC"> case where you can do</font><font color="#E5E5E5"> it you know</font>

351
00:16:36,220 --> 00:16:40,600
<font color="#CCCCCC">just</font><font color="#E5E5E5"> bump in and steal it you know in</font>

352
00:16:38,529 --> 00:16:42,930
any case maybe<font color="#E5E5E5"> if you have it on</font><font color="#CCCCCC"> a long</font>

353
00:16:40,600 --> 00:16:42,930
train ride

354
00:16:50,860 --> 00:16:54,310
<font color="#E5E5E5">all right thank you</font>

