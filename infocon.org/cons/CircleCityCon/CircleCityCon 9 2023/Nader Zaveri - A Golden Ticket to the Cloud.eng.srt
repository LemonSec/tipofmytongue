1
00:00:21,060 --> 00:00:24,240
good afternoon it's always tough to

2
00:00:24,240 --> 00:00:26,340
follow great speeches and great other

3
00:00:26,340 --> 00:00:28,920
presentations but it's even more tougher

4
00:00:28,920 --> 00:00:31,740
to follow lunch and I'll do my best to

5
00:00:31,740 --> 00:00:34,380
keep you awake it's that lunchtime drag

6
00:00:34,380 --> 00:00:37,079
that'll hit in and I appreciate it and I

7
00:00:37,079 --> 00:00:39,360
I know I've been there in the other uh

8
00:00:39,360 --> 00:00:42,120
side so a little bit about the

9
00:00:42,120 --> 00:00:43,920
presentation and about myself

10
00:00:43,920 --> 00:00:45,660
we're gonna be talking about a golden

11
00:00:45,660 --> 00:00:47,760
ticket to the cloud

12
00:00:47,760 --> 00:00:49,800
um some common and novel ways we've been

13
00:00:49,800 --> 00:00:52,379
seeing threat actors uh kind of attack

14
00:00:52,379 --> 00:00:55,680
the cloud I'm part of mandiant instant

15
00:00:55,680 --> 00:00:57,960
response firm and I'm a senior manager

16
00:00:57,960 --> 00:01:01,079
with our Response Team specific around

17
00:01:01,079 --> 00:01:03,000
remediation

18
00:01:03,000 --> 00:01:05,459
so give a quick introduction of myself a

19
00:01:05,459 --> 00:01:06,420
little bit of background and

20
00:01:06,420 --> 00:01:07,920
specifically around Mandy and kind of

21
00:01:07,920 --> 00:01:10,560
what we do here and

22
00:01:10,560 --> 00:01:12,180
um a little bit about what the threat

23
00:01:12,180 --> 00:01:14,159
landscape is looking like from what

24
00:01:14,159 --> 00:01:15,659
we're seeing from the instant response

25
00:01:15,659 --> 00:01:17,880
angle as well as the kind of proactive

26
00:01:17,880 --> 00:01:19,979
assessment type angle that we do and

27
00:01:19,979 --> 00:01:21,180
some of the common attacker

28
00:01:21,180 --> 00:01:23,340
methodologies we're seeing and then I'll

29
00:01:23,340 --> 00:01:24,960
bring about a little bit of a kind of

30
00:01:24,960 --> 00:01:27,720
Novel Technique we saw uh certain threat

31
00:01:27,720 --> 00:01:30,840
actors use a few years back that's still

32
00:01:30,840 --> 00:01:32,280
fairly novel not a lot of people are

33
00:01:32,280 --> 00:01:34,920
using it but we're going to create some

34
00:01:34,920 --> 00:01:36,540
we're going to introduce the novel

35
00:01:36,540 --> 00:01:38,340
technique and then also bring in ways to

36
00:01:38,340 --> 00:01:40,619
detect it because of this technique

37
00:01:40,619 --> 00:01:44,880
being so easily uh performed once it's

38
00:01:44,880 --> 00:01:46,740
performed the ability to bypass things

39
00:01:46,740 --> 00:01:49,399
like msj and all these other types of

40
00:01:49,399 --> 00:01:51,360
mitigation techniques and security

41
00:01:51,360 --> 00:01:54,299
controls it's fairly simple and then

42
00:01:54,299 --> 00:01:56,579
I'll kind of go through a Litany of best

43
00:01:56,579 --> 00:01:58,320
practices around the different types of

44
00:01:58,320 --> 00:01:59,759
domains Within

45
00:01:59,759 --> 00:02:02,759
to try to what we're seeing is best

46
00:02:02,759 --> 00:02:04,619
practices from just uh on the ground

47
00:02:04,619 --> 00:02:07,200
knowledge of these proactive engagements

48
00:02:07,200 --> 00:02:08,459
that we have as well as when we're doing

49
00:02:08,459 --> 00:02:09,959
instant response Services how we can

50
00:02:09,959 --> 00:02:13,379
best uh make our clients kind of get in

51
00:02:13,379 --> 00:02:15,480
a position to win and of course I'll

52
00:02:15,480 --> 00:02:18,180
leave it at least five minutes uh to for

53
00:02:18,180 --> 00:02:20,040
introductions I mean from my questions

54
00:02:20,040 --> 00:02:22,920
and discussions I want to keep it as

55
00:02:22,920 --> 00:02:25,560
free flown as possible

56
00:02:25,560 --> 00:02:27,300
a little bit about myself I hate talking

57
00:02:27,300 --> 00:02:29,520
about myself but I guess uh my name is

58
00:02:29,520 --> 00:02:31,739
Nader's very I'm a senior manager with

59
00:02:31,739 --> 00:02:33,780
Mandy and been with Manny for about four

60
00:02:33,780 --> 00:02:35,819
years but all together have about 15

61
00:02:35,819 --> 00:02:38,060
years of experience in cyber security

62
00:02:38,060 --> 00:02:41,220
infrastructure uh security and just

63
00:02:41,220 --> 00:02:42,840
really uh

64
00:02:42,840 --> 00:02:44,120
security

65
00:02:44,120 --> 00:02:47,340
have about uh and based in Houston Texas

66
00:02:47,340 --> 00:02:49,920
born raised uh so I guess there's some

67
00:02:49,920 --> 00:02:52,019
houstonians and Texans over on here it's

68
00:02:52,019 --> 00:02:56,879
awesome and really uh my main focus is

69
00:02:56,879 --> 00:02:59,340
around containing and remediating so

70
00:02:59,340 --> 00:03:01,500
during an IR so as you probably well

71
00:03:01,500 --> 00:03:03,000
aware somebody needs that foremost

72
00:03:03,000 --> 00:03:04,620
leader instant response Services I

73
00:03:04,620 --> 00:03:06,480
always kind of let everyone know

74
00:03:06,480 --> 00:03:08,099
in the past 10 years if you've heard of

75
00:03:08,099 --> 00:03:11,400
a major breach that's happened in uh

76
00:03:11,400 --> 00:03:13,560
that hit the news wire

77
00:03:13,560 --> 00:03:15,900
a good conservative number about 70 of

78
00:03:15,900 --> 00:03:17,640
the time it's usually us invested

79
00:03:17,640 --> 00:03:19,620
of course we are not always allowed to

80
00:03:19,620 --> 00:03:21,959
divulge we never divulge our name except

81
00:03:21,959 --> 00:03:24,000
when the client themselves actually

82
00:03:24,000 --> 00:03:26,580
divulge and say man it's here to assist

83
00:03:26,580 --> 00:03:29,819
so I'm specifically in the uh

84
00:03:29,819 --> 00:03:32,099
containment remediation part so during

85
00:03:32,099 --> 00:03:34,680
an IR uh there's two major teams that

86
00:03:34,680 --> 00:03:36,120
are deployed we have the investigative

87
00:03:36,120 --> 00:03:37,500
team they're there to kind of

88
00:03:37,500 --> 00:03:39,540
investigate what's happening what's with

89
00:03:39,540 --> 00:03:41,879
the threat actor how they got in how are

90
00:03:41,879 --> 00:03:43,860
they allowed to move be able to escalate

91
00:03:43,860 --> 00:03:46,200
exploitation of data anything like that

92
00:03:46,200 --> 00:03:49,080
and then really my team is there to as

93
00:03:49,080 --> 00:03:50,580
that's happening and understanding the

94
00:03:50,580 --> 00:03:53,099
incident we're here to contain remediate

95
00:03:53,099 --> 00:03:55,440
and kind of kick out the attacker so as

96
00:03:55,440 --> 00:03:56,940
we're understanding the incident we have

97
00:03:56,940 --> 00:03:59,459
plug holes fairly quickly finding out

98
00:03:59,459 --> 00:04:01,440
misconfigurations and then being able to

99
00:04:01,440 --> 00:04:03,000
prevent it when we are trying to take

100
00:04:03,000 --> 00:04:04,860
out

101
00:04:04,860 --> 00:04:06,900
and uh one of the main things

102
00:04:06,900 --> 00:04:08,760
specifically with myself is I've been

103
00:04:08,760 --> 00:04:11,400
really focused on cloud by ours I'm part

104
00:04:11,400 --> 00:04:13,680
of the IR team so I do help with the

105
00:04:13,680 --> 00:04:14,939
investigation but also containing a

106
00:04:14,939 --> 00:04:15,840
review

107
00:04:15,840 --> 00:04:18,660
a second full thing that we do specific

108
00:04:18,660 --> 00:04:21,060
with my team is we don't only do

109
00:04:21,060 --> 00:04:22,680
business we also do proactive type

110
00:04:22,680 --> 00:04:24,840
engagements security assessments of the

111
00:04:24,840 --> 00:04:26,880
cloud and Cloud configuration so I'm

112
00:04:26,880 --> 00:04:29,340
able to kind of see what is happening

113
00:04:29,340 --> 00:04:31,440
you have a very jaded view when you see

114
00:04:31,440 --> 00:04:33,300
only a

115
00:04:33,300 --> 00:04:35,880
the kind of bad side of uh cyber

116
00:04:35,880 --> 00:04:37,740
security where you only see people when

117
00:04:37,740 --> 00:04:39,600
they are being having to respond to an

118
00:04:39,600 --> 00:04:41,340
incident but I get a chance to see kind

119
00:04:41,340 --> 00:04:43,740
of those proactive teams where they

120
00:04:43,740 --> 00:04:45,600
really want to see how they're doing in

121
00:04:45,600 --> 00:04:47,400
terms of their Cloud infrastructure and

122
00:04:47,400 --> 00:04:48,720
how they kind of fare with other

123
00:04:48,720 --> 00:04:52,800
organizations similar in capacity and uh

124
00:04:52,800 --> 00:04:54,840
organization so I'll be talking about

125
00:04:54,840 --> 00:04:56,520
that throughout kind of giving my

126
00:04:56,520 --> 00:04:58,500
struggling my own anecdote

127
00:04:58,500 --> 00:05:01,680
experiences and of course uh

128
00:05:01,680 --> 00:05:04,680
housekeeping items I'm going to try as

129
00:05:04,680 --> 00:05:06,720
best as I can I'm going to be mentioning

130
00:05:06,720 --> 00:05:08,780
a lot of kind of real world scenarios

131
00:05:08,780 --> 00:05:11,220
that either I've personally done is

132
00:05:11,220 --> 00:05:13,500
response Services people in my team have

133
00:05:13,500 --> 00:05:15,600
done or just kind of public knowledge

134
00:05:15,600 --> 00:05:18,060
I'll try to obfuscate a little bit on

135
00:05:18,060 --> 00:05:20,940
the details just so it's not pinpointing

136
00:05:20,940 --> 00:05:22,440
back out to the specific line because

137
00:05:22,440 --> 00:05:25,380
some of these are are incidents that are

138
00:05:25,380 --> 00:05:28,440
not publicly disclosed on the methods

139
00:05:28,440 --> 00:05:30,180
techniques

140
00:05:30,180 --> 00:05:31,740
so I kind of wanted to kind of talk

141
00:05:31,740 --> 00:05:33,960
about the cloud threat landscape as

142
00:05:33,960 --> 00:05:36,060
cloud is growing this is one of the big

143
00:05:36,060 --> 00:05:37,320
things that are happening we're seeing

144
00:05:37,320 --> 00:05:38,639
this a lot is

145
00:05:38,639 --> 00:05:40,560
the rapid growth into the cloud

146
00:05:40,560 --> 00:05:41,940
especially

147
00:05:41,940 --> 00:05:45,120
post coded right when covet hit

148
00:05:45,120 --> 00:05:47,759
there we saw an influx just from my

149
00:05:47,759 --> 00:05:49,020
event is probably on the instant

150
00:05:49,020 --> 00:05:51,539
response side influx of cloud-based IRS

151
00:05:51,539 --> 00:05:54,660
because we're hearing our clients go to

152
00:05:54,660 --> 00:05:56,280
the cloud you know sometimes they're

153
00:05:56,280 --> 00:05:58,320
going in cloud in a more rapid fashion

154
00:05:58,320 --> 00:06:00,479
you know they're not used to having

155
00:06:00,479 --> 00:06:03,180
everyone being a remote Workforce so

156
00:06:03,180 --> 00:06:04,919
they had to find ways to make things

157
00:06:04,919 --> 00:06:06,120
work it's you know it's totally

158
00:06:06,120 --> 00:06:08,100
understandable it's operations you have

159
00:06:08,100 --> 00:06:10,259
to maintain the operations of the

160
00:06:10,259 --> 00:06:11,100
business

161
00:06:11,100 --> 00:06:14,039
but then with that there was a lot of

162
00:06:14,039 --> 00:06:16,380
security misconfigurations people were

163
00:06:16,380 --> 00:06:17,880
just kind of getting into the cloud all

164
00:06:17,880 --> 00:06:19,979
willy-nilly they were lack of kind of

165
00:06:19,979 --> 00:06:22,740
some of the key things within a cloud

166
00:06:22,740 --> 00:06:25,080
just basic misconfiguration steps

167
00:06:25,080 --> 00:06:27,120
certain things that are you know you

168
00:06:27,120 --> 00:06:28,860
would want to turn on by default were

169
00:06:28,860 --> 00:06:31,319
not being turned on like uh by default

170
00:06:31,319 --> 00:06:33,180
you know there's a lot of things where

171
00:06:33,180 --> 00:06:36,000
there's a lot of services that a cloud

172
00:06:36,000 --> 00:06:38,639
provider we're talking about AWS gcp

173
00:06:38,639 --> 00:06:41,759
Azure that they provide base Security

174
00:06:41,759 --> 00:06:44,280
Services that you know it's just a

175
00:06:44,280 --> 00:06:46,860
matter of enabling for the people to be

176
00:06:46,860 --> 00:06:48,660
able to utilize it but a lot of times

177
00:06:48,660 --> 00:06:50,340
that doesn't happen because the lack of

178
00:06:50,340 --> 00:06:53,039
awareness and also there is a issue with

179
00:06:53,039 --> 00:06:54,720
uh money right everything you turn on

180
00:06:54,720 --> 00:06:56,699
the cloud is going to cost money and

181
00:06:56,699 --> 00:06:58,819
they try to find the best way to have

182
00:06:58,819 --> 00:07:01,139
the best bang for their buck and a lot

183
00:07:01,139 --> 00:07:02,520
of times security is kind of pushed off

184
00:07:02,520 --> 00:07:05,060
by the wayside

185
00:07:05,400 --> 00:07:07,440
um so some of the uh

186
00:07:07,440 --> 00:07:10,319
Cloud statistics we've seen and then

187
00:07:10,319 --> 00:07:14,120
this is actually a little bit older data

188
00:07:14,580 --> 00:07:16,080
is around

189
00:07:16,080 --> 00:07:18,900
the really last one around 11 I would

190
00:07:18,900 --> 00:07:22,620
say this is 11 uh the data is a little

191
00:07:22,620 --> 00:07:24,479
bit higher now but just anecdotally

192
00:07:24,479 --> 00:07:27,720
speaking I know that I have a unique

193
00:07:27,720 --> 00:07:30,000
position so a lot of the cloud-based

194
00:07:30,000 --> 00:07:32,099
stuff is coming in I will be able to

195
00:07:32,099 --> 00:07:34,500
have visibility on but even I was

196
00:07:34,500 --> 00:07:36,780
talking with other people in other IR

197
00:07:36,780 --> 00:07:39,539
firms outside of Mandy and they've been

198
00:07:39,539 --> 00:07:42,000
seeing an influx of cloud-based on yours

199
00:07:42,000 --> 00:07:44,039
they were seeing a lot of thread actors

200
00:07:44,039 --> 00:07:47,660
start attacking Cloud uh infrastructure

201
00:07:47,660 --> 00:07:50,880
misconfigurations uh a whole different

202
00:07:50,880 --> 00:07:53,460
article around instance metadata service

203
00:07:53,460 --> 00:07:55,800
around AWS and Google

204
00:07:55,800 --> 00:07:57,599
and how they're able to attack that from

205
00:07:57,599 --> 00:08:01,199
the outside and there's a lot of now

206
00:08:01,199 --> 00:08:03,840
added risks that are happening within

207
00:08:03,840 --> 00:08:05,699
the cloud which of course you know

208
00:08:05,699 --> 00:08:09,199
everything will have a risk it's just

209
00:08:10,440 --> 00:08:12,000
it's just and you know most of the time

210
00:08:12,000 --> 00:08:13,500
we're seeing is

211
00:08:13,500 --> 00:08:15,780
most organizations as you know passion

212
00:08:15,780 --> 00:08:17,520
is still an issue one of the things that

213
00:08:17,520 --> 00:08:20,240
we've seen actually with ours is

214
00:08:20,240 --> 00:08:23,280
critical vulnerabilities

215
00:08:23,280 --> 00:08:25,319
critical vulnerabilities have been one

216
00:08:25,319 --> 00:08:28,800
of the big reasons why certain uh

217
00:08:28,800 --> 00:08:31,319
certain different organizations are

218
00:08:31,319 --> 00:08:34,200
being impacted the most so recent study

219
00:08:34,200 --> 00:08:36,539
that we did with Manny we have our M

220
00:08:36,539 --> 00:08:39,539
trans 2022 but this time around 18

221
00:08:39,539 --> 00:08:41,760
months is we were able to see that

222
00:08:41,760 --> 00:08:43,620
instead phishing wasn't the initial

223
00:08:43,620 --> 00:08:44,640
attack

224
00:08:44,640 --> 00:08:46,920
that got people normally you always hear

225
00:08:46,920 --> 00:08:48,240
about fishing training the biggest

226
00:08:48,240 --> 00:08:49,800
training was

227
00:08:49,800 --> 00:08:53,040
third party and vulnerabilities so

228
00:08:53,040 --> 00:08:54,660
thinking about the various

229
00:08:54,660 --> 00:08:55,920
vulnerabilities you have in your

230
00:08:55,920 --> 00:08:57,720
environment you're patching you can only

231
00:08:57,720 --> 00:08:59,700
do so quickly so fast especially when

232
00:08:59,700 --> 00:09:02,100
it's in production that was actually the

233
00:09:02,100 --> 00:09:04,560
highest method of how thread Acts were

234
00:09:04,560 --> 00:09:06,180
able to come in

235
00:09:06,180 --> 00:09:08,820
um you know majority of cloud uh

236
00:09:08,820 --> 00:09:10,440
security failures happens at the

237
00:09:10,440 --> 00:09:12,720
customer's responsibility right you all

238
00:09:12,720 --> 00:09:14,760
they're always taught the responsibility

239
00:09:14,760 --> 00:09:18,540
Matrix and where your responsibility

240
00:09:18,540 --> 00:09:21,720
ends and where the cloud provider begins

241
00:09:21,720 --> 00:09:23,880
but majority of the time that we're

242
00:09:23,880 --> 00:09:26,220
seeing is it's a misconfiguration from

243
00:09:26,220 --> 00:09:29,040
the client that if they had this enabled

244
00:09:29,040 --> 00:09:31,980
at the disabled uh then the threat actor

245
00:09:31,980 --> 00:09:35,160
was not able to come in or having this

246
00:09:35,160 --> 00:09:37,620
across board with even some threat

247
00:09:37,620 --> 00:09:40,140
actors being able to be used across

248
00:09:40,140 --> 00:09:42,959
Cloud providers now so one of the IRS I

249
00:09:42,959 --> 00:09:44,339
was just on

250
00:09:44,339 --> 00:09:46,860
Cloud uh the attacker was able to get in

251
00:09:46,860 --> 00:09:48,620
to AWS

252
00:09:48,620 --> 00:09:51,480
through uh instance metadata service

253
00:09:51,480 --> 00:09:53,519
Miss configuration of course on ec2

254
00:09:53,519 --> 00:09:56,279
instance and from there uh when they

255
00:09:56,279 --> 00:09:58,019
were able to go and get their GitHub

256
00:09:58,019 --> 00:10:00,360
repo which was on there then they were

257
00:10:00,360 --> 00:10:01,980
able to scrape credentials and found

258
00:10:01,980 --> 00:10:04,380
Azure credentials they went and loudly

259
00:10:04,380 --> 00:10:06,000
moved into that into Azure and started

260
00:10:06,000 --> 00:10:07,380
to do logins

261
00:10:07,380 --> 00:10:09,240
with the Azure VMS luckily they had

262
00:10:09,240 --> 00:10:10,860
better security Azure VMS because they

263
00:10:10,860 --> 00:10:12,720
had some EDR Solutions they're able to

264
00:10:12,720 --> 00:10:15,360
block it but the ability for threat

265
00:10:15,360 --> 00:10:17,580
actors now are are just not focused on

266
00:10:17,580 --> 00:10:20,459
one cloud provider which maybe a year or

267
00:10:20,459 --> 00:10:22,680
two years ago you used to see

268
00:10:22,680 --> 00:10:24,480
if they're hitting AWS they're just

269
00:10:24,480 --> 00:10:26,220
hitting it hard and then that's kind of

270
00:10:26,220 --> 00:10:28,680
where their playground will be plan or

271
00:10:28,680 --> 00:10:30,420
Azure but now we're starting to see

272
00:10:30,420 --> 00:10:32,279
where Throwbacks are now able to kind of

273
00:10:32,279 --> 00:10:34,680
maneuver across and just the third

274
00:10:34,680 --> 00:10:35,880
actor's knowledge of the cloud is

275
00:10:35,880 --> 00:10:37,500
getting better we definitely have to end

276
00:10:37,500 --> 00:10:39,779
up our game as well on making sure

277
00:10:39,779 --> 00:10:41,700
credentials aren't in GitHub repos and

278
00:10:41,700 --> 00:10:44,180
things like that

279
00:10:44,579 --> 00:10:46,680
you know and this is the m trans report

280
00:10:46,680 --> 00:10:48,360
that we specifically did just on the

281
00:10:48,360 --> 00:10:51,240
cloud as I mentioned in 2022 well those

282
00:10:51,240 --> 00:10:52,980
numbers have changed strategy especially

283
00:10:52,980 --> 00:10:54,660
when it comes to the initial attack

284
00:10:54,660 --> 00:10:57,899
Vector but really uh when we focused on

285
00:10:57,899 --> 00:11:00,600
just looking at cloud-based IRS uh lack

286
00:11:00,600 --> 00:11:03,240
of cloud adoption vegetation response so

287
00:11:03,240 --> 00:11:04,800
this is we're gonna I'm gonna Focus

288
00:11:04,800 --> 00:11:08,760
heavily on detection and response uh

289
00:11:08,760 --> 00:11:11,940
specifically on how to detect uh this

290
00:11:11,940 --> 00:11:13,320
certain kind of Novel methodical

291
00:11:13,320 --> 00:11:15,779
dissemble method and a tech utilizing

292
00:11:15,779 --> 00:11:17,700
hybrid environments right if you

293
00:11:17,700 --> 00:11:19,320
create a few credentials you were using

294
00:11:19,320 --> 00:11:20,700
on-prem and you have the same

295
00:11:20,700 --> 00:11:22,620
credentials going in the cloud it's just

296
00:11:22,620 --> 00:11:25,860
a matter of one of them to get

297
00:11:25,860 --> 00:11:27,540
pop so that was kind of a lot of the

298
00:11:27,540 --> 00:11:29,100
initial things we used to see early on

299
00:11:29,100 --> 00:11:31,200
two three years ago was the maneuvering

300
00:11:31,200 --> 00:11:34,019
from on-prem to cloud cloud to on-prem

301
00:11:34,019 --> 00:11:35,640
but as I mentioned now they're doing

302
00:11:35,640 --> 00:11:37,980
Cloud to cloud and it's all about

303
00:11:37,980 --> 00:11:40,500
scraping credentials trying to find it

304
00:11:40,500 --> 00:11:43,560
because as we know identity is the new

305
00:11:43,560 --> 00:11:44,519
perimeter

306
00:11:44,519 --> 00:11:46,500
right that is the new primary it's no

307
00:11:46,500 --> 00:11:51,120
more of the uh the rooms the on-prem the

308
00:11:51,120 --> 00:11:53,459
data centers it is the new parameters of

309
00:11:53,459 --> 00:11:54,959
thought so wanting to know that knowing

310
00:11:54,959 --> 00:11:57,420
that having the granularity and policies

311
00:11:57,420 --> 00:12:00,720
and specifically around IEM that is

312
00:12:00,720 --> 00:12:03,480
where a lot of this can be kind of uh

313
00:12:03,480 --> 00:12:05,339
fixed and a lot of permission issues

314
00:12:05,339 --> 00:12:07,980
that can come about

315
00:12:07,980 --> 00:12:09,180
so I want to kind of talk about a little

316
00:12:09,180 --> 00:12:11,700
bit common attack methodology so what

317
00:12:11,700 --> 00:12:13,260
we're seeing from the common attack

318
00:12:13,260 --> 00:12:15,839
methodologies is not this next one is

319
00:12:15,839 --> 00:12:19,019
really not methodology is more than the

320
00:12:19,019 --> 00:12:20,399
fact is when people are getting into the

321
00:12:20,399 --> 00:12:22,680
valley especially this is more so the

322
00:12:22,680 --> 00:12:24,720
case a few years ago but still we're

323
00:12:24,720 --> 00:12:27,839
seeing that now is the Rogue I.T Shadow

324
00:12:27,839 --> 00:12:30,980
I.T methodology what we're seeing is

325
00:12:30,980 --> 00:12:33,540
devops is the first to get to the Cloud

326
00:12:33,540 --> 00:12:36,240
right the cloud is very

327
00:12:36,240 --> 00:12:39,000
very uh very nice for people who are in

328
00:12:39,000 --> 00:12:40,620
development people who want to have that

329
00:12:40,620 --> 00:12:42,779
agile nature of trying to get spin-up

330
00:12:42,779 --> 00:12:45,120
apps all I need is a credit card on my

331
00:12:45,120 --> 00:12:48,120
department now I have a bunch of uh

332
00:12:48,120 --> 00:12:49,740
applications I don't need a rack and

333
00:12:49,740 --> 00:12:52,019
stack and server and have virtual

334
00:12:52,019 --> 00:12:53,339
machines I could just do that in the

335
00:12:53,339 --> 00:12:55,980
cloud and this is where we're seeing a

336
00:12:55,980 --> 00:12:58,800
lot of organizations kind of when we

337
00:12:58,800 --> 00:13:00,540
come in to do our security systems or

338
00:13:00,540 --> 00:13:04,320
during an IR the the security people on

339
00:13:04,320 --> 00:13:06,000
the team have no idea what's happening

340
00:13:06,000 --> 00:13:06,779
about

341
00:13:06,779 --> 00:13:08,339
or they have very little visibility

342
00:13:08,339 --> 00:13:09,720
because

343
00:13:09,720 --> 00:13:12,000
the devops yeah they handle it they

344
00:13:12,000 --> 00:13:12,959
supposedly

345
00:13:12,959 --> 00:13:16,200
we all know how much developers care

346
00:13:16,200 --> 00:13:18,360
about security if they hindrance a lot

347
00:13:18,360 --> 00:13:19,440
of times especially when they want to

348
00:13:19,440 --> 00:13:21,720
make things go just give it admin rights

349
00:13:21,720 --> 00:13:24,120
and let's see if it doesn't break then

350
00:13:24,120 --> 00:13:25,560
that's good right that's kind of the way

351
00:13:25,560 --> 00:13:28,260
uh as long as my application is running

352
00:13:28,260 --> 00:13:30,120
I don't need to worry about granularity

353
00:13:30,120 --> 00:13:31,200
permissions

354
00:13:31,200 --> 00:13:34,139
so we started seeing that a lot and if

355
00:13:34,139 --> 00:13:36,360
you were a call I mean old enough to

356
00:13:36,360 --> 00:13:39,120
remember back in maybe 10 10 15 years

357
00:13:39,120 --> 00:13:41,880
ago where Shadow Ikea was a big problem

358
00:13:41,880 --> 00:13:44,760
with on-premit where those are the big

359
00:13:44,760 --> 00:13:45,600
things around especially around

360
00:13:45,600 --> 00:13:47,220
hospitals a lot of the clients I had

361
00:13:47,220 --> 00:13:50,700
were hospitals and each Hospital Wing

362
00:13:50,700 --> 00:13:52,980
had its own kind of I.T Department not

363
00:13:52,980 --> 00:13:53,760
just

364
00:13:53,760 --> 00:13:56,339
racking a second or putting up a small

365
00:13:56,339 --> 00:13:59,880
uh wind closet Network closet or a small

366
00:13:59,880 --> 00:14:02,160
like desktop to being deployed but they

367
00:14:02,160 --> 00:14:03,779
had their own fully fun

368
00:14:03,779 --> 00:14:07,200
T where there was no centralized way of

369
00:14:07,200 --> 00:14:09,420
seeing security across the board and

370
00:14:09,420 --> 00:14:10,560
this is something that we're starting to

371
00:14:10,560 --> 00:14:12,779
see right now happen in the cloud

372
00:14:12,779 --> 00:14:14,639
in the club like I said the cloud is

373
00:14:14,639 --> 00:14:16,500
very interesting to people who are

374
00:14:16,500 --> 00:14:19,320
attackers because of the ease of nature

375
00:14:19,320 --> 00:14:21,959
from the outside but also for my uh

376
00:14:21,959 --> 00:14:24,060
developer it's something that hey I want

377
00:14:24,060 --> 00:14:25,800
to be able to get into the cloud it's

378
00:14:25,800 --> 00:14:27,720
easy I can just spin up if my

379
00:14:27,720 --> 00:14:29,160
application is running a little slow

380
00:14:29,160 --> 00:14:32,399
just uh puts uh put some meat on the

381
00:14:32,399 --> 00:14:34,560
servers and get it more faster

382
00:14:34,560 --> 00:14:36,779
and you know one of the things we're

383
00:14:36,779 --> 00:14:38,639
seeing is a lot of Internet facing

384
00:14:38,639 --> 00:14:41,639
Remote Management so as covid had

385
00:14:41,639 --> 00:14:44,459
increased the cloud influx you know we

386
00:14:44,459 --> 00:14:46,260
they still had to perform management

387
00:14:46,260 --> 00:14:48,899
functions items they started seeing a

388
00:14:48,899 --> 00:14:51,180
lot of uh externally facing RDP

389
00:14:51,180 --> 00:14:52,860
instances externally facing instances

390
00:14:52,860 --> 00:14:55,920
that had SSH open to the world uh you

391
00:14:55,920 --> 00:14:56,760
know

392
00:14:56,760 --> 00:14:57,959
if we could be shaking your head right

393
00:14:57,959 --> 00:15:00,300
now but I mean I'm pretty sure we all

394
00:15:00,300 --> 00:15:02,519
have heard of this throughout just the

395
00:15:02,519 --> 00:15:03,660
various you know speaking with everyone

396
00:15:03,660 --> 00:15:05,459
which is even your owner organization

397
00:15:05,459 --> 00:15:07,620
and of course the unpashed applications

398
00:15:07,620 --> 00:15:09,720
that are happening it's not only

399
00:15:09,720 --> 00:15:11,880
applications that are on-prem that hey

400
00:15:11,880 --> 00:15:13,620
you have to have at least initial access

401
00:15:13,620 --> 00:15:16,500
to come in to be able to export this

402
00:15:16,500 --> 00:15:18,360
vulnerability disk and also

403
00:15:18,360 --> 00:15:20,160
and also with application

404
00:15:20,160 --> 00:15:21,480
facing

405
00:15:21,480 --> 00:15:23,100
we have Jenkins servers always getting

406
00:15:23,100 --> 00:15:25,260
popped and things like that and of

407
00:15:25,260 --> 00:15:27,899
course admins being notoriously lazy

408
00:15:27,899 --> 00:15:30,060
they love to always trade back doors I

409
00:15:30,060 --> 00:15:32,940
was a system admin so I can kind of tell

410
00:15:32,940 --> 00:15:35,699
you being lazy is part of the parcel of

411
00:15:35,699 --> 00:15:38,279
being a systematic it is a badge of

412
00:15:38,279 --> 00:15:40,079
honor when you are the laziest system

413
00:15:40,079 --> 00:15:42,240
admin that means you are have automated

414
00:15:42,240 --> 00:15:45,060
everything you've done all the things as

415
00:15:45,060 --> 00:15:46,980
well as created some back doors just in

416
00:15:46,980 --> 00:15:48,660
case if you get kicked out because you

417
00:15:48,660 --> 00:15:50,040
always want to plan for a fact that

418
00:15:50,040 --> 00:15:51,839
things aren't operational I want to

419
00:15:51,839 --> 00:15:53,940
still be able to get in and that's one

420
00:15:53,940 --> 00:15:55,500
of the ways we've been seeing

421
00:15:55,500 --> 00:15:58,380
and of course uh fishing one thing when

422
00:15:58,380 --> 00:16:00,839
we're thinking about uh Cloud you're you

423
00:16:00,839 --> 00:16:02,699
kind of forget about fishing a little

424
00:16:02,699 --> 00:16:04,800
bit right because a way to access the

425
00:16:04,800 --> 00:16:05,880
cloud is still your through your

426
00:16:05,880 --> 00:16:06,779
endpoint

427
00:16:06,779 --> 00:16:08,279
you're still accessing through your

428
00:16:08,279 --> 00:16:10,920
endpoints so if you were to get popped

429
00:16:10,920 --> 00:16:13,620
with the fishing uh campaign I wish

430
00:16:13,620 --> 00:16:14,399
everyone

431
00:16:14,399 --> 00:16:16,199
had either gotten through a fishing

432
00:16:16,199 --> 00:16:18,839
campaign or really gotten popped then

433
00:16:18,839 --> 00:16:21,480
the possibility of that threat actor

434
00:16:21,480 --> 00:16:23,579
being able to scrape credentials from

435
00:16:23,579 --> 00:16:25,199
your actual system if you are a system

436
00:16:25,199 --> 00:16:27,899
if you're an admin of cloud or devops

437
00:16:27,899 --> 00:16:30,480
person then you're starting to see a lot

438
00:16:30,480 --> 00:16:33,959
of credentials SSH Keys access Keys when

439
00:16:33,959 --> 00:16:38,000
you're looking at the gcp and uh

440
00:16:39,480 --> 00:16:42,120
to get on and threat actors are starting

441
00:16:42,120 --> 00:16:44,519
to now once they get into a specific

442
00:16:44,519 --> 00:16:47,160
endpoint they will start scraping the

443
00:16:47,160 --> 00:16:49,019
credentials and

444
00:16:49,019 --> 00:16:50,639
Bahia keys right

445
00:16:50,639 --> 00:16:54,560
right long lived in AWS

446
00:16:55,139 --> 00:16:57,839
another one is kind of endpoint exploit

447
00:16:57,839 --> 00:17:00,420
of course there's still the L1 I want to

448
00:17:00,420 --> 00:17:01,920
kind of always

449
00:17:01,920 --> 00:17:03,360
wonderful or think about the cloud we're

450
00:17:03,360 --> 00:17:04,199
always thinking about that cloud

451
00:17:04,199 --> 00:17:06,480
infrastructure what's happening

452
00:17:06,480 --> 00:17:08,220
but also it's happening at your end

453
00:17:08,220 --> 00:17:10,199
point is very important make sure your

454
00:17:10,199 --> 00:17:13,199
own endpoint is secure with the right

455
00:17:13,199 --> 00:17:15,720
level of security uh right with the

456
00:17:15,720 --> 00:17:16,859
right level kind of zero trust

457
00:17:16,859 --> 00:17:19,859
capabilities but also you know when you

458
00:17:19,859 --> 00:17:21,839
have your endpoint and when you are one

459
00:17:21,839 --> 00:17:22,919
of the things that we always kind of

460
00:17:22,919 --> 00:17:23,819
mention especially if you're getting

461
00:17:23,819 --> 00:17:25,679
into the cloud just have approval

462
00:17:25,679 --> 00:17:27,419
Jackson's workstation to log into the

463
00:17:27,419 --> 00:17:28,980
account number so you don't have those

464
00:17:28,980 --> 00:17:31,320
credentials sitting in your own

465
00:17:31,320 --> 00:17:33,059
day-to-day machine where you check your

466
00:17:33,059 --> 00:17:34,980
emails you go research something

467
00:17:34,980 --> 00:17:37,320
that that get pop that gets popped and

468
00:17:37,320 --> 00:17:40,380
guess what you are compromised at a

469
00:17:40,380 --> 00:17:42,900
larger degree

470
00:17:42,900 --> 00:17:45,360
the credential compromised by a public

471
00:17:45,360 --> 00:17:47,039
exposure just happens probably one of

472
00:17:47,039 --> 00:17:49,020
the most common techniques in the cloud

473
00:17:49,020 --> 00:17:52,620
for us is credentials getting exposed uh

474
00:17:52,620 --> 00:17:54,600
getting leaked on the internet your

475
00:17:54,600 --> 00:17:58,140
GitHub you're on GitHub we've seen her a

476
00:17:58,140 --> 00:18:01,200
GitHub credentials get exposed for just

477
00:18:01,200 --> 00:18:03,960
a a private repository gets exposed for

478
00:18:03,960 --> 00:18:05,220
just an hour

479
00:18:05,220 --> 00:18:07,620
that's all it takes for the Google

480
00:18:07,620 --> 00:18:10,200
crawlers to go out and being crawlished

481
00:18:10,200 --> 00:18:13,140
to go out and start to cash the page so

482
00:18:13,140 --> 00:18:15,120
they quickly found out oh let's make it

483
00:18:15,120 --> 00:18:17,520
private again but the throw actor was

484
00:18:17,520 --> 00:18:19,919
able to go through the cash pages

485
00:18:19,919 --> 00:18:22,260
and see the credentials and then get in

486
00:18:22,260 --> 00:18:23,700
and it took us

487
00:18:23,700 --> 00:18:26,580
the the whole Fiasco of having to go

488
00:18:26,580 --> 00:18:28,919
contact Google will happen at Microsoft

489
00:18:28,919 --> 00:18:31,020
and all the different browsers that have

490
00:18:31,020 --> 00:18:33,419
those crawlers and ask them to remove

491
00:18:33,419 --> 00:18:35,039
the

492
00:18:35,039 --> 00:18:38,160
May the instant response take a lot

493
00:18:38,160 --> 00:18:40,200
longer and you just have to be very

494
00:18:40,200 --> 00:18:42,360
careful you know being able not to have

495
00:18:42,360 --> 00:18:44,280
any sort of code committee we'll talk

496
00:18:44,280 --> 00:18:45,600
about that and how what are the methods

497
00:18:45,600 --> 00:18:47,460
of it

498
00:18:47,460 --> 00:18:49,620
their Cloud platform service hijacking

499
00:18:49,620 --> 00:18:51,660
right this is where you know if there's

500
00:18:51,660 --> 00:18:54,660
like extremely exposed apis you have

501
00:18:54,660 --> 00:18:57,059
vulnerability in an application you can

502
00:18:57,059 --> 00:18:59,039
use serverless or this specific one uh

503
00:18:59,039 --> 00:19:00,660
if you ever get a chance to watch a

504
00:19:00,660 --> 00:19:02,520
video on a really cool cloud-based

505
00:19:02,520 --> 00:19:05,220
attack around uh serverless it's called

506
00:19:05,220 --> 00:19:08,400
Gone in 60 Seconds great topic uh but

507
00:19:08,400 --> 00:19:09,780
this is kind of the gist of it where

508
00:19:09,780 --> 00:19:12,480
they were able to get those externally

509
00:19:12,480 --> 00:19:15,900
facing uh apis be able to once they got

510
00:19:15,900 --> 00:19:18,720
in they're able to create a specific

511
00:19:18,720 --> 00:19:21,900
function that we're able to post kind of

512
00:19:21,900 --> 00:19:24,720
valid keys and sessions and once they're

513
00:19:24,720 --> 00:19:26,580
able to do that they're able to get into

514
00:19:26,580 --> 00:19:27,900
the application

515
00:19:27,900 --> 00:19:30,360
set up their externally facing uh let's

516
00:19:30,360 --> 00:19:31,860
just say they have their own cloud

517
00:19:31,860 --> 00:19:34,559
provider or their digital Ocean or

518
00:19:34,559 --> 00:19:36,179
whatever they want to have a storage

519
00:19:36,179 --> 00:19:38,160
bucket and then start being able to

520
00:19:38,160 --> 00:19:41,520
exfiltrate those to the externally

521
00:19:41,520 --> 00:19:44,419
facing storage bucket

522
00:19:44,419 --> 00:19:46,559
hybrid Cloud louder movement that's

523
00:19:46,559 --> 00:19:48,419
another one I talked about it a little

524
00:19:48,419 --> 00:19:49,679
bit is if

525
00:19:49,679 --> 00:19:53,220
identity is the parameters of the cloud

526
00:19:53,220 --> 00:19:56,220
of course a lot of organizations they

527
00:19:56,220 --> 00:19:57,660
are getting into the cloud special if

528
00:19:57,660 --> 00:19:59,220
you're using let's say azure all right

529
00:19:59,220 --> 00:20:00,840
so you're having the same permissions as

530
00:20:00,840 --> 00:20:02,580
your active directory on-prem

531
00:20:02,580 --> 00:20:04,919
es we always kind of recommend is if you

532
00:20:04,919 --> 00:20:06,840
have anyone who is an admin

533
00:20:06,840 --> 00:20:09,960
of azure right people Global ad server

534
00:20:09,960 --> 00:20:13,740
service ads user admins uh the various

535
00:20:13,740 --> 00:20:15,000
different routes so you can even secure

536
00:20:15,000 --> 00:20:17,160
your reader always want to have a

537
00:20:17,160 --> 00:20:19,620
separate cloud-only account so then

538
00:20:19,620 --> 00:20:22,200
those are not if one gets popped the

539
00:20:22,200 --> 00:20:23,880
other is compromised and vice versa

540
00:20:23,880 --> 00:20:25,799
because we see a lot of people that get

541
00:20:25,799 --> 00:20:27,360
you know if you're a domain admin

542
00:20:27,360 --> 00:20:28,440
on-prem

543
00:20:28,440 --> 00:20:31,080
or an exchange admin on-prem name I've

544
00:20:31,080 --> 00:20:32,640
gotten domain admin rights I want many

545
00:20:32,640 --> 00:20:34,980
times you will most likely then have

546
00:20:34,980 --> 00:20:37,799
that Global admin role and then the for

547
00:20:37,799 --> 00:20:40,020
the attacker to easily actual trade data

548
00:20:40,020 --> 00:20:41,760
and just kind of maneuver in and out of

549
00:20:41,760 --> 00:20:43,200
the cloud something that we've seen a

550
00:20:43,200 --> 00:20:46,020
lot and that's one of the things always

551
00:20:46,020 --> 00:20:48,600
have a separate role if you want if you

552
00:20:48,600 --> 00:20:52,140
are ssoing make sure that that uh

553
00:20:52,140 --> 00:20:54,059
credential you're using is not

554
00:20:54,059 --> 00:20:56,039
associated with actually an on-prem

555
00:20:56,039 --> 00:20:59,179
privileged credential store

556
00:20:59,400 --> 00:21:01,980
and third-party Library supply chain

557
00:21:01,980 --> 00:21:03,660
attack so this is

558
00:21:03,660 --> 00:21:06,360
something you know when putting this

559
00:21:06,360 --> 00:21:09,179
together you know I this is where we've

560
00:21:09,179 --> 00:21:11,100
been on the end of I helped write an

561
00:21:11,100 --> 00:21:12,179
article

562
00:21:12,179 --> 00:21:15,539
uh late last year around npm from

563
00:21:15,539 --> 00:21:18,059
vulnerabilities so what we've seen is

564
00:21:18,059 --> 00:21:21,360
attackers are now saying let me get the

565
00:21:21,360 --> 00:21:22,980
best bang for my wife the best thing is

566
00:21:22,980 --> 00:21:25,080
let me get into one of those libraries

567
00:21:25,080 --> 00:21:27,240
that everyone uses like one of the npm

568
00:21:27,240 --> 00:21:30,059
libraries here and let me put a back

569
00:21:30,059 --> 00:21:31,980
door into that leverage so when you are

570
00:21:31,980 --> 00:21:35,520
loading your software loads packages and

571
00:21:35,520 --> 00:21:38,159
libraries automatically it's going to

572
00:21:38,159 --> 00:21:41,039
load the uh old one all right it's going

573
00:21:41,039 --> 00:21:43,080
to load a malicious one and though and

574
00:21:43,080 --> 00:21:44,700
what happened was turns out the guy had

575
00:21:44,700 --> 00:21:46,980
his GitHub credential

576
00:21:46,980 --> 00:21:49,080
compromise that was compromising the

577
00:21:49,080 --> 00:21:51,240
get in and then put in their malicious

578
00:21:51,240 --> 00:21:53,640
code and then remember it's a trusted

579
00:21:53,640 --> 00:21:55,860
library that the application has been

580
00:21:55,860 --> 00:21:59,460
using every single day and the way if

581
00:21:59,460 --> 00:22:01,080
you're using a lot of microservices in

582
00:22:01,080 --> 00:22:02,940
your containers and kubernetes it

583
00:22:02,940 --> 00:22:06,799
reloads the application each time

584
00:22:07,020 --> 00:22:09,900
and the attacker was able to have a pack

585
00:22:09,900 --> 00:22:12,720
hundreds of applications across various

586
00:22:12,720 --> 00:22:14,780
different organizations because of the

587
00:22:14,780 --> 00:22:17,400
rampant use of that npn

588
00:22:17,400 --> 00:22:19,020
not just picking on npm this is really

589
00:22:19,020 --> 00:22:21,840
with anybody who has a using libraries

590
00:22:21,840 --> 00:22:24,000
to create that you have to have a way to

591
00:22:24,000 --> 00:22:27,179
review and the person who review each of

592
00:22:27,179 --> 00:22:28,500
these things and how can you do that

593
00:22:28,500 --> 00:22:30,360
when you have hundreds of applications

594
00:22:30,360 --> 00:22:34,500
each application has a dozen libraries

595
00:22:34,500 --> 00:22:36,960
into memory when the ER loading the

596
00:22:36,960 --> 00:22:38,580
application

597
00:22:38,580 --> 00:22:41,220
a few other ones you know exposed the

598
00:22:41,220 --> 00:22:43,380
externally exposed ec2 instance I mean

599
00:22:43,380 --> 00:22:48,900
uh three buckets or storage blobs within

600
00:22:48,900 --> 00:22:51,720
uh extra facing sometime that is by

601
00:22:51,720 --> 00:22:54,720
Design sometimes that is not by

602
00:22:54,720 --> 00:22:56,460
diet synonymous configuration or

603
00:22:56,460 --> 00:22:58,559
sometimes it is hey we want this bucket

604
00:22:58,559 --> 00:23:00,480
to be exposed because we have an app we

605
00:23:00,480 --> 00:23:02,580
have a website and that website needs to

606
00:23:02,580 --> 00:23:03,720
get images

607
00:23:03,720 --> 00:23:06,120
and the images comes in from S3 bucket

608
00:23:06,120 --> 00:23:09,419
which is very common but once we need to

609
00:23:09,419 --> 00:23:11,340
make sure that what is in that S2 bucket

610
00:23:11,340 --> 00:23:13,020
is exactly what

611
00:23:13,020 --> 00:23:15,960
as opposed to not and on-prem Cloud

612
00:23:15,960 --> 00:23:18,480
pivoting as well as third

613
00:23:18,480 --> 00:23:20,100
-party location

614
00:23:20,100 --> 00:23:22,679
and this getting gets into the more

615
00:23:22,679 --> 00:23:24,299
novel that we

616
00:23:24,299 --> 00:23:27,900
uh so the golden saml attack so go into

617
00:23:27,900 --> 00:23:29,340
Samuel attack a little background about

618
00:23:29,340 --> 00:23:30,659
it is

619
00:23:30,659 --> 00:23:34,200
it was first created by the folks in

620
00:23:34,200 --> 00:23:35,700
cyber Arc research Department

621
00:23:35,700 --> 00:23:38,280
they created they had created this cyber

622
00:23:38,280 --> 00:23:40,559
they have created this attack back in

623
00:23:40,559 --> 00:23:45,360
2017 about ways what you can do to

624
00:23:45,360 --> 00:23:48,419
have a Golden saml Ticket which then

625
00:23:48,419 --> 00:23:50,940
allows you to get into infrastructures

626
00:23:50,940 --> 00:23:53,039
that where you are using a Federated

627
00:23:53,039 --> 00:23:55,020
service like an adfs

628
00:23:55,020 --> 00:23:57,360
uh they had also created a program with

629
00:23:57,360 --> 00:24:00,600
it as well and and really it just allows

630
00:24:00,600 --> 00:24:03,720
you to get in and once you are in you

631
00:24:03,720 --> 00:24:06,539
can see get into every single Cloud

632
00:24:06,539 --> 00:24:08,400
especially if you're using

633
00:24:08,400 --> 00:24:10,260
that to log in

634
00:24:10,260 --> 00:24:13,200
and so to understand the golden saml

635
00:24:13,200 --> 00:24:16,200
technique I think we have to really

636
00:24:16,200 --> 00:24:18,419
what is Samo Authentication

637
00:24:18,419 --> 00:24:21,240
you know what we will do is there's

638
00:24:21,240 --> 00:24:22,559
three major

639
00:24:22,559 --> 00:24:24,419
entities right you have the user person

640
00:24:24,419 --> 00:24:26,940
who's logging in he logs into the

641
00:24:26,940 --> 00:24:30,539
service provider like AWS and if you're

642
00:24:30,539 --> 00:24:32,940
using a Federated service

643
00:24:32,940 --> 00:24:36,000
hey I'm not handling the identity let me

644
00:24:36,000 --> 00:24:38,940
send it over to my identity provider

645
00:24:38,940 --> 00:24:41,880
an identity provider then says okay what

646
00:24:41,880 --> 00:24:43,679
is your credentials okay let me just

647
00:24:43,679 --> 00:24:45,419
double check it's looking good okay

648
00:24:45,419 --> 00:24:47,159
we're gonna go give you a what is called

649
00:24:47,159 --> 00:24:50,100
an assemble assertion ticket and it's

650
00:24:50,100 --> 00:24:52,140
saying Yep this guy's all good let me

651
00:24:52,140 --> 00:24:54,179
just let you know he's good to go and

652
00:24:54,179 --> 00:24:57,059
then it will unlock your ability to get

653
00:24:57,059 --> 00:24:58,620
into account

654
00:24:58,620 --> 00:25:00,539
or whatever service this is really

655
00:25:00,539 --> 00:25:02,400
across you you see some authentication

656
00:25:02,400 --> 00:25:04,200
all the time when you log into your bank

657
00:25:04,200 --> 00:25:06,240
you'll see Samsung off if you really get

658
00:25:06,240 --> 00:25:08,340
a chance look at the URL uh when you're

659
00:25:08,340 --> 00:25:10,140
logging in Sam Authentication

660
00:25:10,140 --> 00:25:12,840
there was two saml I think uh the first

661
00:25:12,840 --> 00:25:15,720
demo came out 1.0 came out

662
00:25:15,720 --> 00:25:17,580
this demo authentication that most

663
00:25:17,580 --> 00:25:20,000
people utilize

664
00:25:20,159 --> 00:25:21,900
which is that which came out around

665
00:25:21,900 --> 00:25:24,900
2005.

666
00:25:25,260 --> 00:25:28,080
so knowing the method of the golden

667
00:25:28,080 --> 00:25:31,860
Samuel of stem Authentication what

668
00:25:31,860 --> 00:25:34,679
happens during a school district

669
00:25:34,679 --> 00:25:37,440
so we have three major entities still

670
00:25:37,440 --> 00:25:39,240
right we have the attacker instead of

671
00:25:39,240 --> 00:25:41,940
the user is the bad guy the bad guy the

672
00:25:41,940 --> 00:25:43,380
identity provider and then the service

673
00:25:43,380 --> 00:25:46,740
provider so one thing is it's a reverse

674
00:25:46,740 --> 00:25:49,320
so in order for this attack to be

675
00:25:49,320 --> 00:25:50,820
successful they already have to have

676
00:25:50,820 --> 00:25:53,460
access into your identity

677
00:25:53,460 --> 00:25:55,440
once again the identity providers are

678
00:25:55,440 --> 00:25:57,659
fairly high up on the tier list in terms

679
00:25:57,659 --> 00:26:01,020
of your uh priority your criticality of

680
00:26:01,020 --> 00:26:03,299
applications so you're looking at a very

681
00:26:03,299 --> 00:26:04,740
critical application so they have

682
00:26:04,740 --> 00:26:07,260
already almost god mode at in your

683
00:26:07,260 --> 00:26:10,140
domain uh in order for this to happen

684
00:26:10,140 --> 00:26:11,940
they have already initialized they've

685
00:26:11,940 --> 00:26:13,020
already privilege escalated they've

686
00:26:13,020 --> 00:26:14,880
already removed they've already did all

687
00:26:14,880 --> 00:26:16,620
the major techniques this is now to

688
00:26:16,620 --> 00:26:17,760
maintain

689
00:26:17,760 --> 00:26:21,480
persistent access and also to bypass MFA

690
00:26:21,480 --> 00:26:22,860
you're going to see the way it comes

691
00:26:22,860 --> 00:26:25,200
about so one thing is they first go into

692
00:26:25,200 --> 00:26:27,419
the identity provider and they extract

693
00:26:27,419 --> 00:26:30,179
all the specific uh

694
00:26:30,179 --> 00:26:33,240
credentials or certificates there's a

695
00:26:33,240 --> 00:26:35,400
specific function you could utilize and

696
00:26:35,400 --> 00:26:36,779
you know dump them certain utilities

697
00:26:36,779 --> 00:26:39,600
across the board and having everyone's

698
00:26:39,600 --> 00:26:42,240
capability block

699
00:26:42,240 --> 00:26:45,120
so that once they get that they'll log

700
00:26:45,120 --> 00:26:47,640
into AWS or have whatever copper binder

701
00:26:47,640 --> 00:26:48,720
you want to go

702
00:26:48,720 --> 00:26:50,880
aw says hey I'm still trying to log in

703
00:26:50,880 --> 00:26:53,279
with this identity provider

704
00:26:53,279 --> 00:26:57,120
what they do is they insert what is a

705
00:26:57,120 --> 00:26:59,640
Ford stimulation at this

706
00:26:59,640 --> 00:27:01,020
so it's when it's going through that

707
00:27:01,020 --> 00:27:03,240
they're going to insert their Force

708
00:27:03,240 --> 00:27:05,220
ticket Samuel assertion that happens

709
00:27:05,220 --> 00:27:08,580
and that will then trick the MFA

710
00:27:08,580 --> 00:27:10,620
provider saying yeah this is the service

711
00:27:10,620 --> 00:27:12,240
providers yeah this is already coming in

712
00:27:12,240 --> 00:27:14,820
MFA has been satisfied

713
00:27:14,820 --> 00:27:17,580
and then they will be able to get

714
00:27:17,580 --> 00:27:19,380
to

715
00:27:19,380 --> 00:27:21,600
the service provider

716
00:27:21,600 --> 00:27:23,940
so knowing that technique right so now

717
00:27:23,940 --> 00:27:27,000
we know kind of the major methods let's

718
00:27:27,000 --> 00:27:29,520
create some detection and learning so we

719
00:27:29,520 --> 00:27:33,720
know how saml works we know how gold and

720
00:27:33,720 --> 00:27:36,600
sound uh the uh the methodology is

721
00:27:36,600 --> 00:27:39,659
how do we create this type of learning

722
00:27:39,659 --> 00:27:41,100
that has to happen

723
00:27:41,100 --> 00:27:44,220
uh one thing is you know you have

724
00:27:44,220 --> 00:27:46,200
your identity provider you have your

725
00:27:46,200 --> 00:27:47,640
user so of course you're getting stuff

726
00:27:47,640 --> 00:27:49,200
from the user agent

727
00:27:49,200 --> 00:27:51,299
but you also have the identity provider

728
00:27:51,299 --> 00:27:54,000
and you have the actual service provider

729
00:27:54,000 --> 00:27:56,340
which is we're going to use AWS for

730
00:27:56,340 --> 00:27:59,279
example so you want to make sure logging

731
00:27:59,279 --> 00:28:01,140
is turned on at your ID so this is

732
00:28:01,140 --> 00:28:03,200
regardless so this could be adfs

733
00:28:03,200 --> 00:28:04,919
confederated we're actually going to use

734
00:28:04,919 --> 00:28:06,779
Confederate as an example

735
00:28:06,779 --> 00:28:09,120
during the golden saml attack with the

736
00:28:09,120 --> 00:28:12,240
people who utilize solarwinds uh apt-29

737
00:28:12,240 --> 00:28:14,580
uh they use Golden Samo they use that

738
00:28:14,580 --> 00:28:17,220
against adfs so that's fairly common and

739
00:28:17,220 --> 00:28:18,659
that's fairly talked about a lot we want

740
00:28:18,659 --> 00:28:19,500
to kind of focus

741
00:28:19,500 --> 00:28:21,480
a different ADP which is like

742
00:28:21,480 --> 00:28:23,039
confederated but I think this can go

743
00:28:23,039 --> 00:28:26,520
across any specific methodology uh

744
00:28:26,520 --> 00:28:29,279
detecting on the IDP ensuring that

745
00:28:29,279 --> 00:28:31,500
there's Advanced logging that's your IDP

746
00:28:31,500 --> 00:28:34,320
as well as the AWS service that we're

747
00:28:34,320 --> 00:28:35,760
going to utilize and then of course the

748
00:28:35,760 --> 00:28:37,500
correlation

749
00:28:37,500 --> 00:28:40,200
so you want to First detect golden saml

750
00:28:40,200 --> 00:28:42,059
you have to understand the data sources

751
00:28:42,059 --> 00:28:42,840
and then

752
00:28:42,840 --> 00:28:45,179
uh do the alert so when we are looking

753
00:28:45,179 --> 00:28:47,940
at the data sources right what type of

754
00:28:47,940 --> 00:28:49,559
data sources we're looking at log on

755
00:28:49,559 --> 00:28:52,440
event log on events at your IDP and log

756
00:28:52,440 --> 00:28:55,140
on events at the service provider AWS

757
00:28:55,140 --> 00:28:57,960
right you're going to look at when a

758
00:28:57,960 --> 00:28:59,700
curb like for example if they're using

759
00:28:59,700 --> 00:29:02,600
adfs for example

760
00:29:02,820 --> 00:29:05,039
they're using active directory uh

761
00:29:05,039 --> 00:29:06,539
Federated services

762
00:29:06,539 --> 00:29:08,539
when a Kerberos ticket is being

763
00:29:08,539 --> 00:29:11,580
requested and a new credential is

764
00:29:11,580 --> 00:29:14,220
created we know that's 47.69 so that's

765
00:29:14,220 --> 00:29:15,659
going to have that it's going to have a

766
00:29:15,659 --> 00:29:18,840
47.69 but also along with that it'll

767
00:29:18,840 --> 00:29:20,520
come in with an IP address the IP

768
00:29:20,520 --> 00:29:22,860
address should be pointing to your IDP

769
00:29:22,860 --> 00:29:25,740
if it's not pointing to your IDP and is

770
00:29:25,740 --> 00:29:28,919
pointing to a non-idp source that's the

771
00:29:28,919 --> 00:29:31,200
possibility of where you

772
00:29:31,200 --> 00:29:34,200
you'll get a a malicious actor trying to

773
00:29:34,200 --> 00:29:35,399
log in

774
00:29:35,399 --> 00:29:38,940
then you'll have of course within adfs

775
00:29:38,940 --> 00:29:41,640
you'll have the specific

776
00:29:41,640 --> 00:29:43,799
Advanced auditing function of course you

777
00:29:43,799 --> 00:29:48,720
can have those 1200 1201 1202 when the

778
00:29:48,720 --> 00:29:51,120
credentials being Federated you'll be

779
00:29:51,120 --> 00:29:53,820
able to also see if they're using a dump

780
00:29:53,820 --> 00:29:55,860
like a certain util dump you'll see that

781
00:29:55,860 --> 00:29:58,020
in the event name and the specific event

782
00:29:58,020 --> 00:30:00,840
description what's happening

783
00:30:00,840 --> 00:30:02,880
and then when creating a learning we're

784
00:30:02,880 --> 00:30:05,340
going to actually create a quick

785
00:30:05,340 --> 00:30:06,899
but when we're building out this

786
00:30:06,899 --> 00:30:08,399
detection

787
00:30:08,399 --> 00:30:10,380
what's happening at the cloud

788
00:30:10,380 --> 00:30:12,480
s right we're going to use cloudtrail

789
00:30:12,480 --> 00:30:13,919
logs specifically because we're using

790
00:30:13,919 --> 00:30:16,260
AWS as an example but look at the events

791
00:30:16,260 --> 00:30:19,200
in the cloud shell logs uh for logins

792
00:30:19,200 --> 00:30:21,299
what happens when your idb login so you

793
00:30:21,299 --> 00:30:23,220
have to of course have a baseline you

794
00:30:23,220 --> 00:30:24,899
have to know how events are happening

795
00:30:24,899 --> 00:30:27,419
when you want to on General legitimate

796
00:30:27,419 --> 00:30:30,140
users logging in in order to catch thing

797
00:30:30,140 --> 00:30:33,600
anomalous and your idv logs looking at

798
00:30:33,600 --> 00:30:35,399
the events specifically related to

799
00:30:35,399 --> 00:30:38,279
logging in to your service provider how

800
00:30:38,279 --> 00:30:40,080
does those look what IP address is

801
00:30:40,080 --> 00:30:41,580
happening what is the username that is

802
00:30:41,580 --> 00:30:43,320
being provided and what does the

803
00:30:43,320 --> 00:30:46,020
username look like inside the cloud

804
00:30:46,020 --> 00:30:48,240
provider right you and I will be able to

805
00:30:48,240 --> 00:30:49,860
create that and

806
00:30:49,860 --> 00:30:51,899
respond queries to kind of help people

807
00:30:51,899 --> 00:30:52,919
put that

808
00:30:52,919 --> 00:30:55,559
and of course aggregating both across by

809
00:30:55,559 --> 00:30:58,020
the user and then filtering out based

810
00:30:58,020 --> 00:31:00,899
off of NFS as I mentioned MFA will be

811
00:31:00,899 --> 00:31:03,059
set to true because if it's going

812
00:31:03,059 --> 00:31:04,799
through your IDP it is thinking you've

813
00:31:04,799 --> 00:31:07,260
gone through the basic methods of

814
00:31:07,260 --> 00:31:09,120
Authentication

815
00:31:09,120 --> 00:31:11,580
so for this example we see this is the

816
00:31:11,580 --> 00:31:15,740
login showing hey I am user logging in

817
00:31:15,740 --> 00:31:19,679
and making a through AWS API calls and

818
00:31:19,679 --> 00:31:21,720
here's kind of user and then on the on

819
00:31:21,720 --> 00:31:23,460
the right side we have at your ID P

820
00:31:23,460 --> 00:31:24,179
level

821
00:31:24,179 --> 00:31:27,000
you're logging in after IDP

822
00:31:27,000 --> 00:31:29,220
and IP address sometimes the IP address

823
00:31:29,220 --> 00:31:31,020
could be coming depending on the way

824
00:31:31,020 --> 00:31:32,940
your network is configured the matting

825
00:31:32,940 --> 00:31:35,580
rules it might be different each time so

826
00:31:35,580 --> 00:31:38,220
knowing how that is but you'll not only

827
00:31:38,220 --> 00:31:41,580
coming in from your your general IP and

828
00:31:41,580 --> 00:31:44,039
then also what is that so with this is

829
00:31:44,039 --> 00:31:46,260
you see two different uh so during the

830
00:31:46,260 --> 00:31:47,340
golden seminal attack you'll actually

831
00:31:47,340 --> 00:31:49,260
see two different users

832
00:31:49,260 --> 00:31:50,700
logging in

833
00:31:50,700 --> 00:31:53,100
uh at the service provider and what is

834
00:31:53,100 --> 00:31:55,260
being said at the IDP world because the

835
00:31:55,260 --> 00:31:57,120
person who's asserting it they're going

836
00:31:57,120 --> 00:31:59,100
to be using all types of credentials so

837
00:31:59,100 --> 00:32:01,380
just to get the bypass the initial

838
00:32:01,380 --> 00:32:03,659
authentication phase

839
00:32:03,659 --> 00:32:05,279
so when we're building out this alert

840
00:32:05,279 --> 00:32:07,260
the this is of course blunt based

841
00:32:07,260 --> 00:32:09,720
queries you know you want to create your

842
00:32:09,720 --> 00:32:12,779
event types of native us across as we

843
00:32:12,779 --> 00:32:14,480
saw API calls

844
00:32:14,480 --> 00:32:16,919
all users within the past hour that's

845
00:32:16,919 --> 00:32:19,380
logged in making sure we're not saying

846
00:32:19,380 --> 00:32:21,840
we're not using my AWS account and

847
00:32:21,840 --> 00:32:23,640
assume role right we're not doing assume

848
00:32:23,640 --> 00:32:26,100
role positions and we're making sure the

849
00:32:26,100 --> 00:32:31,500
uh source is not coming in from a

850
00:32:31,500 --> 00:32:35,460
AWS internal address or 10. we want to

851
00:32:35,460 --> 00:32:36,539
make sure we want to go look at

852
00:32:36,539 --> 00:32:38,399
specifically

853
00:32:38,399 --> 00:32:40,200
and then of course showing the user

854
00:32:40,200 --> 00:32:42,840
identity with MFA session equals to true

855
00:32:42,840 --> 00:32:44,940
as I mentioned you will see the true

856
00:32:44,940 --> 00:32:46,380
here

857
00:32:46,380 --> 00:32:47,760
um and then when you go into your

858
00:32:47,760 --> 00:32:49,620
identity level so this is specifically

859
00:32:49,620 --> 00:32:52,080
round pink right so being Federated will

860
00:32:52,080 --> 00:32:56,240
have what we have an author templog

861
00:32:56,360 --> 00:32:58,440
learning and logging function with

862
00:32:58,440 --> 00:33:00,240
confederated where you can see people

863
00:33:00,240 --> 00:33:04,679
logging in and the way their logs uh

864
00:33:04,679 --> 00:33:06,419
with pink Federated and some other IDP

865
00:33:06,419 --> 00:33:08,940
you want to kind of put a fairly large

866
00:33:08,940 --> 00:33:11,940
uh we put five hours usually when we're

867
00:33:11,940 --> 00:33:13,559
at uh various clients and we're doing

868
00:33:13,559 --> 00:33:15,659
investigations to be able to see all the

869
00:33:15,659 --> 00:33:16,799
logs that happened in the last five

870
00:33:16,799 --> 00:33:18,299
hours but specifically in cloudtrail

871
00:33:18,299 --> 00:33:20,279
because it is fairly instantaneous

872
00:33:20,279 --> 00:33:23,340
within uh real time in 15 within 15

873
00:33:23,340 --> 00:33:26,159
minutes to be able to see that

874
00:33:26,159 --> 00:33:29,519
and once you have that you can combine a

875
00:33:29,519 --> 00:33:33,000
coalesce uh the users uh from what you

876
00:33:33,000 --> 00:33:35,640
see at the user uh at the IDP level and

877
00:33:35,640 --> 00:33:37,679
also at the AWS

878
00:33:37,679 --> 00:33:40,140
and when you're aggregating it across

879
00:33:40,140 --> 00:33:41,880
different indexes right you want to be

880
00:33:41,880 --> 00:33:43,380
able to say

881
00:33:43,380 --> 00:33:46,200
I want to be able to see how many users

882
00:33:46,200 --> 00:33:49,080
have logged in from ping how many user

883
00:33:49,080 --> 00:33:52,080
login into our my AWS and then and

884
00:33:52,080 --> 00:33:53,940
especially if you enforce SSL across the

885
00:33:53,940 --> 00:33:56,880
board that should be a fairly uh similar

886
00:33:56,880 --> 00:33:58,799
number you want to make sure that a

887
00:33:58,799 --> 00:34:01,080
specific IPS and Source IPS that they're

888
00:34:01,080 --> 00:34:03,179
logging in from is the same Source IP

889
00:34:03,179 --> 00:34:04,919
that you typically have

890
00:34:04,919 --> 00:34:06,899
and when you're doing the final result

891
00:34:06,899 --> 00:34:10,379
uh you know you'll be able to see using

892
00:34:10,379 --> 00:34:12,780
the lookups you were able to see where

893
00:34:12,780 --> 00:34:15,480
AWS has been accessed to APS via API

894
00:34:15,480 --> 00:34:16,980
where MFA has been allowed and not

895
00:34:16,980 --> 00:34:18,960
allowed and then you'll be able to

896
00:34:18,960 --> 00:34:20,879
filter out those

897
00:34:20,879 --> 00:34:22,800
how to bypass so we've done this a few

898
00:34:22,800 --> 00:34:25,080
times with various clients since kind of

899
00:34:25,080 --> 00:34:27,480
the golden assembly has been very coin

900
00:34:27,480 --> 00:34:29,040
and Famous

901
00:34:29,040 --> 00:34:30,839
uh yeah one of the things kind of going

902
00:34:30,839 --> 00:34:32,580
through you know just seeing

903
00:34:32,580 --> 00:34:34,940
methods in the miter attack

904
00:34:34,940 --> 00:34:38,219
methods you know seeing where the force

905
00:34:38,219 --> 00:34:40,260
token is happening and the academic

906
00:34:40,260 --> 00:34:41,580
configuration

907
00:34:41,580 --> 00:34:43,379
for the Federated service

908
00:34:43,379 --> 00:34:45,239
you're seeing you know when that happens

909
00:34:45,239 --> 00:34:47,639
what are the methodologies of remediated

910
00:34:47,639 --> 00:34:50,399
by the ensuring that the token signings

911
00:34:50,399 --> 00:34:52,080
certificate is rolled but making sure

912
00:34:52,080 --> 00:34:54,540
you roll it twice because there's a copy

913
00:34:54,540 --> 00:34:56,639
that stays in azure so you want to roll

914
00:34:56,639 --> 00:34:58,320
it not just once but you enrolled it

915
00:34:58,320 --> 00:35:01,560
twice and this is a common uh technique

916
00:35:01,560 --> 00:35:03,060
of remediation that was kind of

917
00:35:03,060 --> 00:35:05,640
overlooked especially early on because

918
00:35:05,640 --> 00:35:08,400
uh you know still everyone's fairly new

919
00:35:08,400 --> 00:35:11,880
on the way the pack is of immediate

920
00:35:11,880 --> 00:35:13,920
they win you know it's always a trial

921
00:35:13,920 --> 00:35:15,960
and error situation

922
00:35:15,960 --> 00:35:18,359
and turning on as mentioned Advanced

923
00:35:18,359 --> 00:35:20,400
auditing functions within adfs but also

924
00:35:20,400 --> 00:35:22,680
your identity provider you should have

925
00:35:22,680 --> 00:35:24,720
some Advanced logging capabilities where

926
00:35:24,720 --> 00:35:26,700
you could see the specific logins that

927
00:35:26,700 --> 00:35:29,040
are happening where is it happening from

928
00:35:29,040 --> 00:35:30,900
and what specific service that is

929
00:35:30,900 --> 00:35:33,480
happening to uh and it provides discount

930
00:35:33,480 --> 00:35:35,579
management we mentioned that which

931
00:35:35,579 --> 00:35:38,160
they are getting to your IDP the

932
00:35:38,160 --> 00:35:40,140
privileged account that is that they

933
00:35:40,140 --> 00:35:41,460
they should have already multiple

934
00:35:41,460 --> 00:35:44,400
accounts to get to that your level IDP

935
00:35:44,400 --> 00:35:46,440
especially what we always say is keep it

936
00:35:46,440 --> 00:35:48,480
on your tier zero here's your

937
00:35:48,480 --> 00:35:50,400
application being your your domain

938
00:35:50,400 --> 00:35:54,119
controllers your adfs your uh your

939
00:35:54,119 --> 00:35:56,400
certificate authorities those that are

940
00:35:56,400 --> 00:35:59,400
critical to The Domain itself right

941
00:35:59,400 --> 00:36:00,839
right so not just critical from an

942
00:36:00,839 --> 00:36:02,160
application operation standpoint

943
00:36:02,160 --> 00:36:04,920
critical to The Domain

944
00:36:04,920 --> 00:36:07,560
if you have any additional kind of uh

945
00:36:07,560 --> 00:36:09,599
information you want to go look up with

946
00:36:09,599 --> 00:36:11,700
this specific threat actor we just came

947
00:36:11,700 --> 00:36:15,359
out with a version three 1.3 of this in

948
00:36:15,359 --> 00:36:18,119
our recent white paper uh is on

949
00:36:18,119 --> 00:36:20,040
remaining hardening strategies across

950
00:36:20,040 --> 00:36:23,640
M365 it also have adms adfs the golden

951
00:36:23,640 --> 00:36:27,900
salmon attack uh we just updated it and

952
00:36:27,900 --> 00:36:30,240
we what we did was actually coalesced

953
00:36:30,240 --> 00:36:34,380
UNC 2454 uh two which was our main

954
00:36:34,380 --> 00:36:36,660
nomenclature for this uh group they

955
00:36:36,660 --> 00:36:38,880
performed the solarwinds attack and now

956
00:36:38,880 --> 00:36:42,060
we've made them into apd29 after

957
00:36:42,060 --> 00:36:45,900
multiple times of having a different

958
00:36:45,900 --> 00:36:47,640
uh different techniques and finding out

959
00:36:47,640 --> 00:36:51,660
yep they're exactly indeed abc29

960
00:36:51,660 --> 00:36:53,339
so I wanted to kind of go through very

961
00:36:53,339 --> 00:36:55,920
security best practices across the

962
00:36:55,920 --> 00:36:58,320
different methodologies of the cloud you

963
00:36:58,320 --> 00:37:00,119
know starting with governance right the

964
00:37:00,119 --> 00:37:01,200
governance is you know you want to

965
00:37:01,200 --> 00:37:04,260
implement account guard rules if you are

966
00:37:04,260 --> 00:37:07,619
in the in AWS use AWS organizations and

967
00:37:07,619 --> 00:37:11,220
scps if you are doing GCB GCB

968
00:37:11,220 --> 00:37:12,960
organization two gcp organizational

969
00:37:12,960 --> 00:37:15,119
policy Azure same thing resource

970
00:37:15,119 --> 00:37:17,099
policies uh you know understand the

971
00:37:17,099 --> 00:37:18,720
shared responsibility model so this this

972
00:37:18,720 --> 00:37:21,000
is something that during our during our

973
00:37:21,000 --> 00:37:24,599
assessments we actually try to go

974
00:37:24,599 --> 00:37:25,980
through the shared responsibility model

975
00:37:25,980 --> 00:37:28,740
again right to understand what are you

976
00:37:28,740 --> 00:37:31,380
are you using is pads or status if

977
00:37:31,380 --> 00:37:33,839
you're using is keywords you guys are

978
00:37:33,839 --> 00:37:36,540
really uh on the hook board right to

979
00:37:36,540 --> 00:37:38,460
understand that and what those services

980
00:37:38,460 --> 00:37:40,020
are

981
00:37:40,020 --> 00:37:42,359
and it seems very rudimentary but I

982
00:37:42,359 --> 00:37:44,700
think starting at the very beginning

983
00:37:44,700 --> 00:37:46,740
building out that strategy early on to

984
00:37:46,740 --> 00:37:48,300
understand these are what I'm wonderful

985
00:37:48,300 --> 00:37:50,400
for so whenever things do hit the fan we

986
00:37:50,400 --> 00:37:51,359
kind of

987
00:37:51,359 --> 00:37:54,180
kind of who was uh in the who's the

988
00:37:54,180 --> 00:37:56,280
culprit who was not you know understand

989
00:37:56,280 --> 00:37:58,619
the terms of contracts have a security

990
00:37:58,619 --> 00:38:00,599
contract and uh in your class so

991
00:38:00,599 --> 00:38:02,520
whenever you have a you have a security

992
00:38:02,520 --> 00:38:04,740
point of contract and contact in

993
00:38:04,740 --> 00:38:09,720
Microsoft Azure you have it in AWS so if

994
00:38:09,720 --> 00:38:12,480
they were to create so what AWS does is

995
00:38:12,480 --> 00:38:15,119
they send you alerts if your credentials

996
00:38:15,119 --> 00:38:17,220
are found in the public on the internet

997
00:38:17,220 --> 00:38:18,960
they'll give you those alerts already

998
00:38:18,960 --> 00:38:21,599
and then they'll also try to uh make it

999
00:38:21,599 --> 00:38:24,480
temporary those credentials

1000
00:38:24,480 --> 00:38:27,540
best practice on uh I am of course MFA

1001
00:38:27,540 --> 00:38:29,700
you've heard that these privileged uh

1002
00:38:29,700 --> 00:38:31,320
you know one of the things we want to do

1003
00:38:31,320 --> 00:38:33,720
is kind of restrict the number of

1004
00:38:33,720 --> 00:38:35,700
privilege accounts that something is a

1005
00:38:35,700 --> 00:38:37,740
tall task for anybody who's ever had to

1006
00:38:37,740 --> 00:38:39,540
speak with clients and try to reduce

1007
00:38:39,540 --> 00:38:42,540
them but also this is the case in Cloud

1008
00:38:42,540 --> 00:38:43,980
right so

1009
00:38:43,980 --> 00:38:46,260
the cloud is a little bit different than

1010
00:38:46,260 --> 00:38:47,940
on-prem because the people who are in

1011
00:38:47,940 --> 00:38:49,320
the cloud is you know

1012
00:38:49,320 --> 00:38:52,079
devops is mostly devop people they're

1013
00:38:52,079 --> 00:38:54,839
going to have a lot of privileges overly

1014
00:38:54,839 --> 00:38:57,540
permissive Privileges and also being

1015
00:38:57,540 --> 00:38:59,700
able to have a multi-account strategy

1016
00:38:59,700 --> 00:39:01,800
right the best way to approach the cloud

1017
00:39:01,800 --> 00:39:03,480
is you want to have

1018
00:39:03,480 --> 00:39:06,060
a cloud if you have an application each

1019
00:39:06,060 --> 00:39:08,940
application should have a Dev it's QA

1020
00:39:08,940 --> 00:39:12,900
non-prod it's prod set up so then the

1021
00:39:12,900 --> 00:39:15,359
production the developers don't have any

1022
00:39:15,359 --> 00:39:16,920
sort of administration right at the

1023
00:39:16,920 --> 00:39:18,240
production

1024
00:39:18,240 --> 00:39:20,940
it is done purely through pushing cold

1025
00:39:20,940 --> 00:39:24,060
transable or some other uh Jenkins or

1026
00:39:24,060 --> 00:39:26,220
any other method like code build or

1027
00:39:26,220 --> 00:39:28,320
things like that so they're not pushing

1028
00:39:28,320 --> 00:39:30,780
code straight to production it's done

1029
00:39:30,780 --> 00:39:33,660
doing through a actual service or an

1030
00:39:33,660 --> 00:39:35,099
application

1031
00:39:35,099 --> 00:39:37,680
that reduces at the production then we

1032
00:39:37,680 --> 00:39:40,320
those production of course although

1033
00:39:40,320 --> 00:39:42,180
that were to get popped there's not a

1034
00:39:42,180 --> 00:39:44,099
lot of like devops credentials that are

1035
00:39:44,099 --> 00:39:45,960
there that are that are long-lived It's

1036
00:39:45,960 --> 00:39:47,520
All Temporary credentials used by

1037
00:39:47,520 --> 00:39:50,460
third-party applications uh you know of

1038
00:39:50,460 --> 00:39:52,320
course use temporary credentials right

1039
00:39:52,320 --> 00:39:54,420
if you see anything one good thing if

1040
00:39:54,420 --> 00:39:57,599
you get a chance to is if you have AWS

1041
00:39:57,599 --> 00:40:01,980
sift through all your AWS access keys

1042
00:40:01,980 --> 00:40:04,200
to hey IA that is the

1043
00:40:04,200 --> 00:40:05,820
change your a division is just for

1044
00:40:05,820 --> 00:40:07,920
long-lived Access keys look for that

1045
00:40:07,920 --> 00:40:09,599
you'll see you should select Asia like

1046
00:40:09,599 --> 00:40:12,420
Asia those are temporary you know

1047
00:40:12,420 --> 00:40:14,280
knowing that uh you know you could go

1048
00:40:14,280 --> 00:40:16,200
through and also go through GitHub repo

1049
00:40:16,200 --> 00:40:19,440
make sure you have nothing that shows a

1050
00:40:19,440 --> 00:40:21,240
long-lived access key one of the things

1051
00:40:21,240 --> 00:40:24,359
that we've had is I've had one of an IR

1052
00:40:24,359 --> 00:40:26,520
where

1053
00:40:26,520 --> 00:40:28,619
S3 bucket host compromise is probably

1054
00:40:28,619 --> 00:40:30,960
still in the largest uh public breaches

1055
00:40:30,960 --> 00:40:32,099
of

1056
00:40:32,099 --> 00:40:33,300
us and

1057
00:40:33,300 --> 00:40:35,700
the one that got popped was part of

1058
00:40:35,700 --> 00:40:37,380
their Legacy account

1059
00:40:37,380 --> 00:40:39,180
when I see Legacy they're they're the

1060
00:40:39,180 --> 00:40:42,300
ogs of uh AWS they've been in AWS since

1061
00:40:42,300 --> 00:40:44,880
2008.

1062
00:40:44,880 --> 00:40:48,599
so we're talking about long time AWS

1063
00:40:48,599 --> 00:40:50,339
and of course if you notice if you've

1064
00:40:50,339 --> 00:40:52,260
been following things around AWS it's

1065
00:40:52,260 --> 00:40:54,480
just in the cloud Community we've made

1066
00:40:54,480 --> 00:40:56,820
some strides towards security especially

1067
00:40:56,820 --> 00:41:00,780
in the last 10 years and that old Legacy

1068
00:41:00,780 --> 00:41:03,359
account was still up and running

1069
00:41:03,359 --> 00:41:05,099
when we were found out during the

1070
00:41:05,099 --> 00:41:06,599
investigation this is the key that was

1071
00:41:06,599 --> 00:41:09,420
used to do X Y and Z but okay we need to

1072
00:41:09,420 --> 00:41:12,599
rotate this key make it not a

1073
00:41:12,599 --> 00:41:14,220
Long Live credential make it temporary

1074
00:41:14,220 --> 00:41:15,780
we need to then rotate across wherever

1075
00:41:15,780 --> 00:41:17,940
this is at first thing they said is we

1076
00:41:17,940 --> 00:41:19,980
have no idea what this

1077
00:41:19,980 --> 00:41:22,500
what this can go what impact it would be

1078
00:41:22,500 --> 00:41:24,720
if we were to rotate this key now what

1079
00:41:24,720 --> 00:41:27,000
are the ramifications and impact

1080
00:41:27,000 --> 00:41:30,300
just because it's long-lived there's no

1081
00:41:30,300 --> 00:41:32,099
it's similar to when you're thinking

1082
00:41:32,099 --> 00:41:33,660
about on-prem right it's like service

1083
00:41:33,660 --> 00:41:34,859
accounts

1084
00:41:34,859 --> 00:41:36,839
you tell them you have to rotate service

1085
00:41:36,839 --> 00:41:37,740
accounts

1086
00:41:37,740 --> 00:41:39,780
and that worst day of that person's life

1087
00:41:39,780 --> 00:41:41,099
because they have no idea where that

1088
00:41:41,099 --> 00:41:43,280
service

1089
00:41:45,720 --> 00:41:47,579
um around configuration management so

1090
00:41:47,579 --> 00:41:50,280
you know of course if you're using Azure

1091
00:41:50,280 --> 00:41:53,640
and M365 you're logging in you want to

1092
00:41:53,640 --> 00:41:56,540
remove the

1093
00:41:57,540 --> 00:41:59,640
right you want to be able to log in

1094
00:41:59,640 --> 00:42:03,180
through methods that only allow MFA you

1095
00:42:03,180 --> 00:42:06,720
know restrict access uh CLI and also to

1096
00:42:06,720 --> 00:42:08,579
the console through IP address to the

1097
00:42:08,579 --> 00:42:11,099
ranges so you can say with I am policies

1098
00:42:11,099 --> 00:42:13,500
or scps if I'm logging in I should be

1099
00:42:13,500 --> 00:42:15,720
only be able to log into this AWS

1100
00:42:15,720 --> 00:42:16,920
console

1101
00:42:16,920 --> 00:42:18,859
via my

1102
00:42:18,859 --> 00:42:22,200
internal IP range or coming in from a VP

1103
00:42:22,200 --> 00:42:24,240
in my public VPN

1104
00:42:24,240 --> 00:42:25,920
you can do that at the cloud right so

1105
00:42:25,920 --> 00:42:28,260
that's where Cloud the IM being the

1106
00:42:28,260 --> 00:42:29,579
perimeter Cloud there's still ways that

1107
00:42:29,579 --> 00:42:31,320
you can ensure that only people from the

1108
00:42:31,320 --> 00:42:33,720
inside can log in right this is where

1109
00:42:33,720 --> 00:42:36,180
majority of the time when we are

1110
00:42:36,180 --> 00:42:37,619
getting into incident response services

1111
00:42:37,619 --> 00:42:39,720
this is the big thing that gets that's

1112
00:42:39,720 --> 00:42:41,099
not

1113
00:42:41,099 --> 00:42:42,500
uh talked about

1114
00:42:42,500 --> 00:42:45,119
they've never done that and everyone can

1115
00:42:45,119 --> 00:42:46,859
log in from anywhere even different

1116
00:42:46,859 --> 00:42:48,540
countries

1117
00:42:48,540 --> 00:42:51,119
you you know audited over the permissive

1118
00:42:51,119 --> 00:42:53,880
network security groups as well as the

1119
00:42:53,880 --> 00:42:56,579
uh security groups within AWS of course

1120
00:42:56,579 --> 00:42:58,800
backup Disaster Recovery

1121
00:42:58,800 --> 00:43:00,720
um some of the application devops you

1122
00:43:00,720 --> 00:43:02,160
know prevent credentials from being able

1123
00:43:02,160 --> 00:43:03,900
to be committed as I mentioned a little

1124
00:43:03,900 --> 00:43:06,420
earlier uh one of the things that we saw

1125
00:43:06,420 --> 00:43:09,119
was credentials from an azure

1126
00:43:09,119 --> 00:43:12,599
workstation uh being on a GitHub repo

1127
00:43:12,599 --> 00:43:14,520
which then they were found that out in

1128
00:43:14,520 --> 00:43:17,400
AWS and they pivoted straight to azure

1129
00:43:17,400 --> 00:43:19,800
so one of the things is how can we

1130
00:43:19,800 --> 00:43:21,480
prevent that so there's various tools

1131
00:43:21,480 --> 00:43:23,640
and I'm all for using open source tools

1132
00:43:23,640 --> 00:43:25,920
GitHub has now made it publicly

1133
00:43:25,920 --> 00:43:27,599
available and generally available for

1134
00:43:27,599 --> 00:43:29,160
anyone to be utilized in their secret

1135
00:43:29,160 --> 00:43:31,079
scanner we're also going to use git

1136
00:43:31,079 --> 00:43:33,060
secrets and you could use stuff like hit

1137
00:43:33,060 --> 00:43:35,460
secrets and have pre-commit hooks so

1138
00:43:35,460 --> 00:43:37,619
when you are committing your code

1139
00:43:37,619 --> 00:43:39,300
uh whatever developers come into their

1140
00:43:39,300 --> 00:43:41,700
code it does a scan to make sure none of

1141
00:43:41,700 --> 00:43:45,060
the specific secrets are in there right

1142
00:43:45,060 --> 00:43:46,500
it goes through the various different

1143
00:43:46,500 --> 00:43:48,420
methods of how secrets are put together

1144
00:43:48,420 --> 00:43:50,640
and what if it finds it it will not

1145
00:43:50,640 --> 00:43:52,740
allow you to commit the code it'll make

1146
00:43:52,740 --> 00:43:55,079
sure you can remediate and then it'll

1147
00:43:55,079 --> 00:43:56,460
run that again when you come in again

1148
00:43:56,460 --> 00:43:57,660
it'll go through that process again

1149
00:43:57,660 --> 00:44:00,900
until it is clean and one thing also to

1150
00:44:00,900 --> 00:44:02,520
think about is and

1151
00:44:02,520 --> 00:44:04,440
and just the last week I was talking

1152
00:44:04,440 --> 00:44:06,119
with the client about this

1153
00:44:06,119 --> 00:44:09,180
is that client that had that GitHub uh

1154
00:44:09,180 --> 00:44:11,819
they cleaned up all the repositories

1155
00:44:11,819 --> 00:44:14,760
that are current they forgot to uh Purge

1156
00:44:14,760 --> 00:44:17,880
all the secrets in the previous commits

1157
00:44:17,880 --> 00:44:19,680
and what we've seen is attackers go into

1158
00:44:19,680 --> 00:44:22,980
the previous commit history and hey you

1159
00:44:22,980 --> 00:44:24,480
cleaned it up that's good but if your

1160
00:44:24,480 --> 00:44:26,160
previous commit history still has some

1161
00:44:26,160 --> 00:44:28,319
long-lived credentials they will be

1162
00:44:28,319 --> 00:44:29,880
scraping that so going through your

1163
00:44:29,880 --> 00:44:32,400
previous commit history here's BFG repo

1164
00:44:32,400 --> 00:44:34,560
cleaner there's a few other open source

1165
00:44:34,560 --> 00:44:36,960
applications for gitlab and GitHub where

1166
00:44:36,960 --> 00:44:38,760
you can go into your commit history as

1167
00:44:38,760 --> 00:44:41,520
well and clean that up and also use the

1168
00:44:41,520 --> 00:44:44,420
git filter as well

1169
00:44:44,700 --> 00:44:47,339
data secrets and protection you know one

1170
00:44:47,339 --> 00:44:49,560
of the things we always talk about is

1171
00:44:49,560 --> 00:44:51,599
you know rotating the secrets as well as

1172
00:44:51,599 --> 00:44:53,760
encrypting the data in motion

1173
00:44:53,760 --> 00:44:56,280
and that rest so depending on the way

1174
00:44:56,280 --> 00:45:00,599
your regulatory standard requires

1175
00:45:00,599 --> 00:45:02,940
organizations kind of go right how are

1176
00:45:02,940 --> 00:45:05,760
they are they are they encrypting before

1177
00:45:05,760 --> 00:45:07,260
they get to the Cloud or are they

1178
00:45:07,260 --> 00:45:09,359
encrypting at the cloud level right so

1179
00:45:09,359 --> 00:45:11,760
you know this is all based off of kind

1180
00:45:11,760 --> 00:45:13,140
of what's your sort of regulatory

1181
00:45:13,140 --> 00:45:16,140
standard is have your own HSM and then

1182
00:45:16,140 --> 00:45:18,180
having it encrypted by your own self is

1183
00:45:18,180 --> 00:45:20,400
usually the best bet you know but it

1184
00:45:20,400 --> 00:45:22,140
depends on how your regulatory standards

1185
00:45:22,140 --> 00:45:23,099
your

1186
00:45:23,099 --> 00:45:24,660
answer and you know you want to also

1187
00:45:24,660 --> 00:45:27,359
make sure the data classification

1188
00:45:27,359 --> 00:45:29,460
the way you can classify data is you can

1189
00:45:29,460 --> 00:45:31,560
also tag data especially in the cloud

1190
00:45:31,560 --> 00:45:34,740
you do you can go through let's say uh

1191
00:45:34,740 --> 00:45:37,020
uh Amazon Macy and go through your S3

1192
00:45:37,020 --> 00:45:39,839
bucket and see any pii data or you could

1193
00:45:39,839 --> 00:45:42,000
go through what is automated uh

1194
00:45:42,000 --> 00:45:44,579
automatic DLP within Google cloud and

1195
00:45:44,579 --> 00:45:47,579
you could run through that and it'll use

1196
00:45:47,579 --> 00:45:49,920
Query bigquery tabs so when you're

1197
00:45:49,920 --> 00:45:51,300
running through the bigquery it can

1198
00:45:51,300 --> 00:45:54,000
automatically data mask it and obfuscate

1199
00:45:54,000 --> 00:45:55,740
it away so even when you're running

1200
00:45:55,740 --> 00:45:57,000
queries you won't be able to see that

1201
00:45:57,000 --> 00:45:58,980
data

1202
00:45:58,980 --> 00:46:00,599
and finally kind of threat detection

1203
00:46:00,599 --> 00:46:03,660
response uh one thing we've noticed is

1204
00:46:03,660 --> 00:46:05,640
when they're moving to the cloud the

1205
00:46:05,640 --> 00:46:07,560
on-prem has been really good over the

1206
00:46:07,560 --> 00:46:09,780
past few years of trying to get all

1207
00:46:09,780 --> 00:46:12,660
their log sources into the SIM but when

1208
00:46:12,660 --> 00:46:15,720
you get into the cloud those Cloud logs

1209
00:46:15,720 --> 00:46:17,220
are not being sent forwarded to the

1210
00:46:17,220 --> 00:46:19,920
cinema or if it is what we've seen is

1211
00:46:19,920 --> 00:46:23,099
being forwarded but it's just a pit in

1212
00:46:23,099 --> 00:46:25,079
this pit of cloudtrail logs what's

1213
00:46:25,079 --> 00:46:26,760
happening are they correlating they're

1214
00:46:26,760 --> 00:46:29,099
on-prem to their Cloud not at all right

1215
00:46:29,099 --> 00:46:30,900
they're just yeah we get collectoral

1216
00:46:30,900 --> 00:46:34,619
logs in our Splunk is that index

1217
00:46:34,619 --> 00:46:37,500
properly it is not tokenized so you

1218
00:46:37,500 --> 00:46:39,599
can't really make sense of it it's uh

1219
00:46:39,599 --> 00:46:40,800
you know somebody hasn't really gone

1220
00:46:40,800 --> 00:46:43,440
through and done the kind of leg work to

1221
00:46:43,440 --> 00:46:45,240
make it make sense

1222
00:46:45,240 --> 00:46:47,040
you know Advanced vlogging features

1223
00:46:47,040 --> 00:46:49,800
right you want to make sure

1224
00:46:49,800 --> 00:46:51,060
if you're logging enable you have

1225
00:46:51,060 --> 00:46:52,980
service server access logging and then

1226
00:46:52,980 --> 00:46:55,260
they have the object

1227
00:46:55,260 --> 00:46:57,180
uh the object logging will allow you to

1228
00:46:57,180 --> 00:46:58,800
have a lot more granularity so you can

1229
00:46:58,800 --> 00:47:01,200
see the gets and puts so for example

1230
00:47:01,200 --> 00:47:03,300
we've had an IR where

1231
00:47:03,300 --> 00:47:06,119
they only had server access logs so they

1232
00:47:06,119 --> 00:47:07,980
were able to see when the threat actor

1233
00:47:07,980 --> 00:47:09,720
was able to get into this S3 buckets

1234
00:47:09,720 --> 00:47:11,940
that S3 bucket had a hundred thousand

1235
00:47:11,940 --> 00:47:14,520
records in there

1236
00:47:14,520 --> 00:47:16,079
because they didn't have object level

1237
00:47:16,079 --> 00:47:19,079
logging we had no idea to tell which

1238
00:47:19,079 --> 00:47:21,780
specific record the attack was able to

1239
00:47:21,780 --> 00:47:22,800
access

1240
00:47:22,800 --> 00:47:26,160
by the way the the because of you know

1241
00:47:26,160 --> 00:47:27,720
we were dealing with IRS you had a lot

1242
00:47:27,720 --> 00:47:30,839
of uh Council and the councils like we

1243
00:47:30,839 --> 00:47:32,940
have to get say either everything we

1244
00:47:32,940 --> 00:47:35,640
have our evidence on everything or if we

1245
00:47:35,640 --> 00:47:37,440
had object level logs we could say yep

1246
00:47:37,440 --> 00:47:39,000
the attacker was only able to access

1247
00:47:39,000 --> 00:47:41,940
three thousand records as opposed to 100

1248
00:47:41,940 --> 00:47:43,740
000 records because we were able to do

1249
00:47:43,740 --> 00:47:45,599
that we in order to resolve it we had to

1250
00:47:45,599 --> 00:47:48,240
go through some mental gymnastics around

1251
00:47:48,240 --> 00:47:50,880
billing and all that it's a long story

1252
00:47:50,880 --> 00:47:53,280
where we're able to try to make sure

1253
00:47:53,280 --> 00:47:55,800
make that hundred thousand record look a

1254
00:47:55,800 --> 00:47:58,140
lot smaller because of very different

1255
00:47:58,140 --> 00:47:59,880
kind of loopholes if they had object

1256
00:47:59,880 --> 00:48:01,380
level login or made everything a lot

1257
00:48:01,380 --> 00:48:03,060
more easier

1258
00:48:03,060 --> 00:48:07,140
and that is it

1259
00:48:07,140 --> 00:48:09,060
um with some time to spare

1260
00:48:09,060 --> 00:48:12,720
is there any questions uh no talked on a

1261
00:48:12,720 --> 00:48:16,339
lot yeah please

1262
00:48:28,920 --> 00:48:31,500
it so we've seen a few different right

1263
00:48:31,500 --> 00:48:34,079
so it depends on the level of patching

1264
00:48:34,079 --> 00:48:38,280
right if let's say if it's a major potem

1265
00:48:38,280 --> 00:48:39,599
or some sort of thing on the domain

1266
00:48:39,599 --> 00:48:41,760
controllers people get scared right

1267
00:48:41,760 --> 00:48:44,280
especially if they get scared to

1268
00:48:44,280 --> 00:48:47,940
any sort of rebooting restarting certain

1269
00:48:47,940 --> 00:48:49,980
things especially if you're I do a lot

1270
00:48:49,980 --> 00:48:51,119
more

1271
00:48:51,119 --> 00:48:53,819
so I see a lot of issues around hey we

1272
00:48:53,819 --> 00:48:55,920
don't want to put this down for

1273
00:48:55,920 --> 00:48:57,180
maintenance if this is down for

1274
00:48:57,180 --> 00:48:58,440
maintenance then we have X amount of

1275
00:48:58,440 --> 00:49:00,859
time that goes down so a lot of time is

1276
00:49:00,859 --> 00:49:03,240
one not everything in their

1277
00:49:03,240 --> 00:49:05,460
vulnerability management

1278
00:49:05,460 --> 00:49:07,680
not prioritized so they just get a bunch

1279
00:49:07,680 --> 00:49:10,680
of vulnerabilities and you know patch

1280
00:49:10,680 --> 00:49:13,140
everything or hatch nothing

1281
00:49:13,140 --> 00:49:15,359
and so things aren't so this is where

1282
00:49:15,359 --> 00:49:16,800
people who are in the vulnerability

1283
00:49:16,800 --> 00:49:19,020
Management program has to help

1284
00:49:19,020 --> 00:49:21,420
prioritize for your developers or for

1285
00:49:21,420 --> 00:49:23,339
your server admins hey these are the

1286
00:49:23,339 --> 00:49:25,740
patches that just came out especially

1287
00:49:25,740 --> 00:49:27,420
what I like to say is

1288
00:49:27,420 --> 00:49:29,460
uh you know you don't want to wait if

1289
00:49:29,460 --> 00:49:31,020
it's a major vulnerability that gets

1290
00:49:31,020 --> 00:49:32,940
traction I'm on Twitter all the time so

1291
00:49:32,940 --> 00:49:35,359
I've seen

1292
00:49:35,760 --> 00:49:38,160
but especially when a POC hits

1293
00:49:38,160 --> 00:49:40,440
on a specific vulnerability that has to

1294
00:49:40,440 --> 00:49:43,440
happen right away I have a story where a

1295
00:49:43,440 --> 00:49:47,040
the vulnerability happened on October

1296
00:49:47,040 --> 00:49:48,900
21st

1297
00:49:48,900 --> 00:49:52,079
October 27th POC came out so around six

1298
00:49:52,079 --> 00:49:53,460
days later

1299
00:49:53,460 --> 00:49:57,060
the next day the 28th they got popped

1300
00:49:57,060 --> 00:49:59,280
so if you're thinking about your passion

1301
00:49:59,280 --> 00:50:00,900
in seven days right most passion Cycles

1302
00:50:00,900 --> 00:50:02,640
are seven days that's not even enough

1303
00:50:02,640 --> 00:50:04,619
right if you're thinking like that right

1304
00:50:04,619 --> 00:50:06,540
so you know you have to be on the bus

1305
00:50:06,540 --> 00:50:08,880
and that's how also you'll notice these

1306
00:50:08,880 --> 00:50:10,859
have come out with a major kind of

1307
00:50:10,859 --> 00:50:13,500
alerts when a POC comes out and it's

1308
00:50:13,500 --> 00:50:15,119
realized

1309
00:50:15,119 --> 00:50:17,339
the oven a proof of concept of the

1310
00:50:17,339 --> 00:50:19,200
actual vulnerability that's when they're

1311
00:50:19,200 --> 00:50:21,480
going to try to alert everybody hey this

1312
00:50:21,480 --> 00:50:23,880
this is one is already high level but

1313
00:50:23,880 --> 00:50:26,280
now you have the script kitties right so

1314
00:50:26,280 --> 00:50:27,480
I mean it takes

1315
00:50:27,480 --> 00:50:29,940
your Advanced person to create a POC

1316
00:50:29,940 --> 00:50:32,520
your normal apt groups they're not

1317
00:50:32,520 --> 00:50:34,920
caring about a lot of these low-level

1318
00:50:34,920 --> 00:50:37,619
you know outside facing ransomware type

1319
00:50:37,619 --> 00:50:38,940
things but the script could easier

1320
00:50:38,940 --> 00:50:39,960
you're going to come out and they're

1321
00:50:39,960 --> 00:50:43,260
gonna utilize a a extremely facing uh

1322
00:50:43,260 --> 00:50:46,020
vulnerability that has evpoc to then

1323
00:50:46,020 --> 00:50:48,839
utilize and from there it's kind of an

1324
00:50:48,839 --> 00:50:49,980
easy game

1325
00:50:49,980 --> 00:50:51,359
so it's really on your threat and

1326
00:50:51,359 --> 00:50:52,559
vulnerability management team to help

1327
00:50:52,559 --> 00:50:54,960
prioritize that because it'll just fall

1328
00:50:54,960 --> 00:50:57,000
on deaf ears as a developer and surround

1329
00:50:57,000 --> 00:50:57,660
them

1330
00:50:57,660 --> 00:51:00,500
great question actually

1331
00:51:25,260 --> 00:51:28,800
no so it for this you won't get a lot of

1332
00:51:28,800 --> 00:51:30,300
learning because it has to be is that

1333
00:51:30,300 --> 00:51:32,819
the server level so you know if it's if

1334
00:51:32,819 --> 00:51:34,440
it's useless we're using this example

1335
00:51:34,440 --> 00:51:36,300
like from an on-prem environment you

1336
00:51:36,300 --> 00:51:39,420
have your on-prem IDP that is also

1337
00:51:39,420 --> 00:51:41,700
helping to log into the cloud but also

1338
00:51:41,700 --> 00:51:43,140
even using OCTA or something like that

1339
00:51:43,140 --> 00:51:45,900
if if you are doing a dump of all the

1340
00:51:45,900 --> 00:51:48,839
certificates uh that will usually not

1341
00:51:48,839 --> 00:51:50,579
call it now they're starting to do it

1342
00:51:50,579 --> 00:51:52,020
now and that's something that we've we

1343
00:51:52,020 --> 00:51:53,940
have multiple IRS where we're talking

1344
00:51:53,940 --> 00:51:54,960
directly with

1345
00:51:54,960 --> 00:51:57,359
giving them like hey I think you guys

1346
00:51:57,359 --> 00:51:58,619
should turn on these types of learning

1347
00:51:58,619 --> 00:52:00,059
those are the type of things that we've

1348
00:52:00,059 --> 00:52:02,160
been talking with these identity

1349
00:52:02,160 --> 00:52:03,900
providers where they have those

1350
00:52:03,900 --> 00:52:06,420
automatic alerts that but even then

1351
00:52:06,420 --> 00:52:08,280
those customer notifications that come

1352
00:52:08,280 --> 00:52:09,000
in

1353
00:52:09,000 --> 00:52:10,980
who's our contact they're going to speak

1354
00:52:10,980 --> 00:52:13,380
with right is it is it's going to fall

1355
00:52:13,380 --> 00:52:16,740
into a Dropbox long inbox of security

1356
00:52:16,740 --> 00:52:18,180
alerts

1357
00:52:18,180 --> 00:52:20,520
um you know if usually by this time you

1358
00:52:20,520 --> 00:52:22,140
should have already had multiple alarms

1359
00:52:22,140 --> 00:52:24,359
set off before the attacker can even get

1360
00:52:24,359 --> 00:52:27,119
into the identity right the IDP as we

1361
00:52:27,119 --> 00:52:28,859
said should be tier zero so should be

1362
00:52:28,859 --> 00:52:30,480
really segmented away from the entire

1363
00:52:30,480 --> 00:52:31,619
environment

1364
00:52:31,619 --> 00:52:34,319
but normally most people have flat

1365
00:52:34,319 --> 00:52:36,960
networks I mean how many times we if you

1366
00:52:36,960 --> 00:52:38,880
can get into the DC you can get into the

1367
00:52:38,880 --> 00:52:40,200
same server you can get into workstation

1368
00:52:40,200 --> 00:52:41,579
you can already be anywhere you want

1369
00:52:41,579 --> 00:52:43,500
there's no real segmentation that's

1370
00:52:43,500 --> 00:52:46,140
happening so uh this should have already

1371
00:52:46,140 --> 00:52:48,660
uh tripped off a Few alarms by this time

1372
00:52:48,660 --> 00:52:50,280
unfortunately you won't have a lot of

1373
00:52:50,280 --> 00:52:52,440
alerts but you can create these types of

1374
00:52:52,440 --> 00:52:55,400
alerts when the when the

1375
00:52:55,400 --> 00:52:58,020
certificates being dumped and that's

1376
00:52:58,020 --> 00:52:59,099
where you can use like for example if

1377
00:52:59,099 --> 00:53:02,460
your adfs you can use event like ID 1202

1378
00:53:02,460 --> 00:53:04,619
and where you can see The Dumping of the

1379
00:53:04,619 --> 00:53:07,200
certain utility or export pfx there's

1380
00:53:07,200 --> 00:53:09,059
some open source tools that people

1381
00:53:09,059 --> 00:53:12,740
utilize and then you can see that

1382
00:53:14,040 --> 00:53:15,660
actually yeah no we're working with the

1383
00:53:15,660 --> 00:53:17,220
during our IRS we're seeing all these

1384
00:53:17,220 --> 00:53:19,980
novel ways and we're talking with the

1385
00:53:19,980 --> 00:53:22,140
idps if we see something that hey you

1386
00:53:22,140 --> 00:53:23,040
guys don't have it or the cloud

1387
00:53:23,040 --> 00:53:24,359
providers right the cloud providers

1388
00:53:24,359 --> 00:53:25,680
should also have something on their end

1389
00:53:25,680 --> 00:53:27,599
to be able to see it so something we've

1390
00:53:27,599 --> 00:53:29,339
been speaking with Microsoft and Google

1391
00:53:29,339 --> 00:53:31,800
and AWS to help with their detection

1392
00:53:31,800 --> 00:53:34,020
techniques so hopefully it does take

1393
00:53:34,020 --> 00:53:35,400
some time

1394
00:53:35,400 --> 00:53:37,680
um but yeah I think some of that we're

1395
00:53:37,680 --> 00:53:39,119
going to see for a while so we're trying

1396
00:53:39,119 --> 00:53:40,680
to create detections at the meantime is

1397
00:53:40,680 --> 00:53:43,160
really going to be key

1398
00:53:43,160 --> 00:53:46,140
and we're I guess we're a little bit

1399
00:53:46,140 --> 00:53:49,160
above time

1400
00:53:50,339 --> 00:53:52,440
already any other question I'll be more

1401
00:53:52,440 --> 00:53:53,819
than happy to answer the questions that

1402
00:53:53,819 --> 00:53:54,900
I think

1403
00:53:54,900 --> 00:53:57,420
my time is up but if there's any

1404
00:53:57,420 --> 00:54:01,099
questions please feel free to ask

1405
00:54:01,859 --> 00:54:04,279
awesome

