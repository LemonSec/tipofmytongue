1
00:00:00,709 --> 00:00:06,629
so it was a bright<font color="#CCCCCC"> sunny Colorado</font>

2
00:00:03,929 --> 00:00:07,560
morning<font color="#E5E5E5"> it was a Monday morning coming</font>

3
00:00:06,629 --> 00:00:10,290
back<font color="#E5E5E5"> to work</font>

4
00:00:07,560 --> 00:00:12,750
I<font color="#CCCCCC"> had just joined manion's Red Team</font><font color="#E5E5E5"> and</font>

5
00:00:10,290 --> 00:00:15,030
<font color="#E5E5E5">it was my first Red Team as an active</font>

6
00:00:12,750 --> 00:00:16,710
participant<font color="#CCCCCC"> I was no longer shadowing I</font>

7
00:00:15,030 --> 00:00:19,350
just taken the creative red team

8
00:00:16,710 --> 00:00:21,689
training course<font color="#CCCCCC"> that we give at</font><font color="#E5E5E5"> blackhat</font>

9
00:00:19,350 --> 00:00:23,340
<font color="#E5E5E5">as well as internally at our company</font><font color="#CCCCCC"> and</font>

10
00:00:21,689 --> 00:00:26,689
I had<font color="#E5E5E5"> learned all the things and I was</font>

11
00:00:23,340 --> 00:00:30,810
surely prepared for this<font color="#E5E5E5"> red team and</font>

12
00:00:26,689 --> 00:00:33,540
you know I woke up<font color="#CCCCCC"> cops</font><font color="#E5E5E5"> and coffee</font><font color="#CCCCCC"> took</font>

13
00:00:30,810 --> 00:00:35,699
a shower<font color="#E5E5E5"> and was getting</font><font color="#CCCCCC"> ready to do our</font>

14
00:00:33,540 --> 00:00:37,019
my first phishing campaign for the red

15
00:00:35,700 --> 00:00:40,140
team we had spent the week before

16
00:00:37,020 --> 00:00:40,860
preparing<font color="#E5E5E5"> and we were sending out our</font>

17
00:00:40,140 --> 00:00:43,559
<font color="#E5E5E5">fishes</font>

18
00:00:40,860 --> 00:00:47,039
you know I'm monitoring<font color="#E5E5E5"> the access</font><font color="#CCCCCC"> logs</font>

19
00:00:43,559 --> 00:00:49,828
for<font color="#CCCCCC"> Apache</font><font color="#E5E5E5"> and you know we're sending</font>

20
00:00:47,039 --> 00:00:52,129
out emails maybe one<font color="#E5E5E5"> every 30</font><font color="#CCCCCC"> minutes to</font>

21
00:00:49,829 --> 00:00:57,660
stay under<font color="#E5E5E5"> the radar of spam and</font>

22
00:00:52,129 --> 00:01:00,899
essentially<font color="#CCCCCC"> I see a hit</font><font color="#E5E5E5"> to our website</font>

23
00:00:57,660 --> 00:01:03,089
<font color="#E5E5E5">I'm like all</font><font color="#CCCCCC"> right cool but why aren't</font>

24
00:01:00,899 --> 00:01:07,140
<font color="#E5E5E5">they grabbing the HTML application like</font>

25
00:01:03,090 --> 00:01:10,470
<font color="#E5E5E5">that strange</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> few moments later maybe</font>

26
00:01:07,140 --> 00:01:13,290
10 to 15 minutes had passed<font color="#E5E5E5"> and then we</font>

27
00:01:10,470 --> 00:01:16,110
saw a<font color="#E5E5E5"> Linux user agent touch the web</font>

28
00:01:13,290 --> 00:01:19,619
server<font color="#E5E5E5"> and then pull down and I see the</font>

29
00:01:16,110 --> 00:01:23,310
user agent<font color="#CCCCCC"> and</font><font color="#E5E5E5"> it's virustotal</font><font color="#CCCCCC"> I got</font>

30
00:01:19,619 --> 00:01:28,950
caught<font color="#E5E5E5"> and then in our global Red Team</font>

31
00:01:23,310 --> 00:01:31,890
<font color="#E5E5E5">Skype chat</font><font color="#CCCCCC"> Nick</font><font color="#E5E5E5"> Carr had said is anyone</font>

32
00:01:28,950 --> 00:01:37,290
doing a red team for<font color="#CCCCCC"> X</font><font color="#E5E5E5"> client and I said</font>

33
00:01:31,890 --> 00:01:40,770
yes unfortunately<font color="#CCCCCC"> that's me he said well</font>

34
00:01:37,290 --> 00:01:43,829
I just<font color="#CCCCCC"> burned all your tradecraft so I</font>

35
00:01:40,770 --> 00:01:45,360
let out a<font color="#E5E5E5"> big side I'm like oh man this</font>

36
00:01:43,829 --> 00:01:47,520
<font color="#E5E5E5">isn't going well like I joined</font>

37
00:01:45,360 --> 00:01:50,119
maintenance to do true red teaming and<font color="#E5E5E5"> I</font>

38
00:01:47,520 --> 00:01:53,399
was so confident I fly I knew enough and

39
00:01:50,119 --> 00:01:55,079
I ended up<font color="#E5E5E5"> being the</font><font color="#CCCCCC"> daily scriptlet</font>

40
00:01:53,399 --> 00:01:57,990
that day which is something<font color="#CCCCCC"> that Nick</font>

41
00:01:55,079 --> 00:01:59,369
<font color="#E5E5E5">Carr does he posts a calm scriptlet</font>

42
00:01:57,990 --> 00:02:04,500
every single day and<font color="#E5E5E5"> it's called hashtag</font>

43
00:01:59,369 --> 00:02:06,710
<font color="#CCCCCC">daily</font><font color="#E5E5E5"> triplet that was me that day so I</font>

44
00:02:04,500 --> 00:02:08,759
looked in front<font color="#CCCCCC"> of me I</font><font color="#E5E5E5"> was</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> the</font>

45
00:02:06,710 --> 00:02:13,230
Denver Mannion office

46
00:02:08,758 --> 00:02:14,380
I said<font color="#CCCCCC"> KC</font><font color="#E5E5E5"> I'm sorry I just burned all</font>

47
00:02:13,230 --> 00:02:17,510
your tradecraft

48
00:02:14,380 --> 00:02:19,760
and he said no no like that's<font color="#E5E5E5"> okay</font>

49
00:02:17,510 --> 00:02:22,790
<font color="#E5E5E5">explain give me like 20 minutes and</font>

50
00:02:19,760 --> 00:02:24,260
<font color="#E5E5E5">maybe I can do some research and come up</font>

51
00:02:22,790 --> 00:02:26,209
some new tradecraft<font color="#CCCCCC"> to use on this</font>

52
00:02:24,260 --> 00:02:27,620
<font color="#E5E5E5">assessment</font><font color="#CCCCCC"> I said well do</font><font color="#E5E5E5"> you mind if I</font>

53
00:02:26,209 --> 00:02:29,810
shoulder surf you and watch what you're

54
00:02:27,620 --> 00:02:31,640
doing he said sure absolutely<font color="#CCCCCC"> so I</font>

55
00:02:29,810 --> 00:02:34,930
walked around we sat<font color="#E5E5E5"> right across from</font>

56
00:02:31,640 --> 00:02:37,549
<font color="#CCCCCC">each</font><font color="#E5E5E5"> other</font><font color="#CCCCCC"> and he</font><font color="#E5E5E5"> slowly started</font>

57
00:02:34,930 --> 00:02:40,670
removing different tags from the<font color="#CCCCCC"> comm</font>

58
00:02:37,550 --> 00:02:42,800
scriptlet<font color="#E5E5E5"> to minimize it</font><font color="#CCCCCC"> he was very</font>

59
00:02:40,670 --> 00:02:45,530
very close<font color="#E5E5E5"> to getting</font><font color="#CCCCCC"> it working and I</font>

60
00:02:42,800 --> 00:02:47,900
said I think<font color="#E5E5E5"> you're making a syntax in</font>

61
00:02:45,530 --> 00:02:50,600
tactical mistake here<font color="#CCCCCC"> he said yeah you</font>

62
00:02:47,900 --> 00:02:52,459
might<font color="#CCCCCC"> be</font><font color="#E5E5E5"> right I don't know</font><font color="#CCCCCC"> give me</font><font color="#E5E5E5"> 5 10</font>

63
00:02:50,600 --> 00:02:55,220
<font color="#E5E5E5">minutes like put my headphones on and</font>

64
00:02:52,459 --> 00:02:57,459
zone out for a few<font color="#E5E5E5"> minutes to</font><font color="#CCCCCC"> figure</font>

65
00:02:55,220 --> 00:02:59,660
this out I said<font color="#CCCCCC"> ok I went outside I</font>

66
00:02:57,459 --> 00:03:02,959
consumes in the<font color="#E5E5E5"> katene that came back</font>

67
00:02:59,660 --> 00:03:05,269
inside<font color="#CCCCCC"> and</font><font color="#E5E5E5"> then he said Spain you're</font>

68
00:03:02,959 --> 00:03:06,800
right<font color="#E5E5E5"> I got it working</font><font color="#CCCCCC"> and that's how</font>

69
00:03:05,269 --> 00:03:10,730
the minimalist<font color="#CCCCCC"> comScore put that</font><font color="#E5E5E5"> Casey</font>

70
00:03:06,800 --> 00:03:15,590
developed was born and so now<font color="#CCCCCC"> APC</font><font color="#E5E5E5"> 32 a</font>

71
00:03:10,730 --> 00:03:17,569
nation state level actor uses<font color="#E5E5E5"> the</font>

72
00:03:15,590 --> 00:03:20,150
minimalist conscript<font color="#CCCCCC"> luyt to do their</font>

73
00:03:17,569 --> 00:03:24,589
bidding<font color="#E5E5E5"> so one of the things that they</font>

74
00:03:20,150 --> 00:03:27,560
use it for<font color="#E5E5E5"> is a scheduled task to obtain</font>

75
00:03:24,590 --> 00:03:29,630
the first level<font color="#CCCCCC"> persistence on a machine</font>

76
00:03:27,560 --> 00:03:32,420
and so if you're interested<font color="#CCCCCC"> in learning</font>

77
00:03:29,630 --> 00:03:34,269
<font color="#CCCCCC">more about ABC 32 I can go to fireEye's</font>

78
00:03:32,420 --> 00:03:37,119
blog<font color="#CCCCCC"> closed to learn</font><font color="#E5E5E5"> more</font><font color="#CCCCCC"> about them</font>

79
00:03:34,269 --> 00:03:39,860
<font color="#CCCCCC">they're politically motivated</font><font color="#E5E5E5"> however</font>

80
00:03:37,120 --> 00:03:41,150
<font color="#E5E5E5">you know we're not focusing on ABC 32</font>

81
00:03:39,860 --> 00:03:43,040
today<font color="#CCCCCC"> really what we're focusing on</font>

82
00:03:41,150 --> 00:03:44,989
<font color="#E5E5E5">today is application whitelisting</font>

83
00:03:43,040 --> 00:03:46,880
and so<font color="#E5E5E5"> first a little bit about myself</font>

84
00:03:44,989 --> 00:03:48,579
<font color="#CCCCCC">I'm consulting on manias red team I</font>

85
00:03:46,880 --> 00:03:51,709
joined them about a year<font color="#CCCCCC"> and</font><font color="#E5E5E5"> a half ago</font>

86
00:03:48,579 --> 00:03:54,049
<font color="#CCCCCC">before that</font><font color="#E5E5E5"> you know I'm a gamer first</font>

87
00:03:51,709 --> 00:03:55,760
in a hacker second I grew up<font color="#E5E5E5"> hacking</font>

88
00:03:54,049 --> 00:03:57,739
<font color="#E5E5E5">Diablo</font><font color="#CCCCCC"> 2</font><font color="#E5E5E5"> if you're heard of</font><font color="#CCCCCC"> Blizz</font>

89
00:03:55,760 --> 00:04:00,320
hackers I was an admin on<font color="#E5E5E5"> there I told</font>

90
00:03:57,739 --> 00:04:04,850
you where to<font color="#E5E5E5"> get</font><font color="#CCCCCC"> your hacks</font><font color="#E5E5E5"> from enough</font>

91
00:04:00,320 --> 00:04:07,430
said<font color="#E5E5E5"> I also was a professional gamer for</font>

92
00:04:04,850 --> 00:04:09,079
<font color="#E5E5E5">a while and played dota or</font><font color="#CCCCCC"> Defense of</font>

93
00:04:07,430 --> 00:04:10,940
the<font color="#CCCCCC"> Ancients for evil geniuses and</font>

94
00:04:09,079 --> 00:04:13,850
thought that's what<font color="#E5E5E5"> I was gonna do</font><font color="#CCCCCC"> for</font>

95
00:04:10,940 --> 00:04:15,320
the rest<font color="#CCCCCC"> of</font><font color="#E5E5E5"> my life unfortunately</font><font color="#CCCCCC"> at the</font>

96
00:04:13,850 --> 00:04:19,190
time<font color="#CCCCCC"> that it make too much money now</font>

97
00:04:15,320 --> 00:04:20,570
<font color="#E5E5E5">they are millionaires</font><font color="#CCCCCC"> so maybe I didn't</font>

98
00:04:19,190 --> 00:04:22,310
go into<font color="#E5E5E5"> the right profession but I'm</font>

99
00:04:20,570 --> 00:04:24,530
very<font color="#E5E5E5"> happy with my decision it's a lot</font>

100
00:04:22,310 --> 00:04:25,490
<font color="#E5E5E5">of fun so I'm a hacker second some</font><font color="#CCCCCC"> of</font>

101
00:04:24,530 --> 00:04:27,229
<font color="#E5E5E5">the</font><font color="#CCCCCC"> things I'm known for</font>

102
00:04:25,490 --> 00:04:29,780
<font color="#CCCCCC">hoid project which was porting</font><font color="#E5E5E5"> Android</font>

103
00:04:27,229 --> 00:04:31,580
to the iPhone<font color="#CCCCCC"> and I can made</font><font color="#E5E5E5"> a</font>

104
00:04:29,780 --> 00:04:33,590
contribution to<font color="#E5E5E5"> open embedded that allow</font>

105
00:04:31,580 --> 00:04:35,810
anyone to develop their own<font color="#E5E5E5"> mobile</font>

106
00:04:33,590 --> 00:04:38,330
<font color="#E5E5E5">operating system for the iPhone 3G the</font>

107
00:04:35,810 --> 00:04:40,880
iPhone<font color="#CCCCCC"> 2 and a few other interest</font>

108
00:04:38,330 --> 00:04:43,520
iterations<font color="#CCCCCC"> maybe like the iPod Touch</font>

109
00:04:40,880 --> 00:04:45,830
first generation<font color="#CCCCCC"> it was a long time</font><font color="#E5E5E5"> ago</font>

110
00:04:43,520 --> 00:04:49,250
<font color="#CCCCCC">my Twitter's conscious</font><font color="#E5E5E5"> hacker and my</font>

111
00:04:45,830 --> 00:04:51,948
blog<font color="#E5E5E5"> is blog conscious hacker</font><font color="#CCCCCC"> dot</font><font color="#E5E5E5"> IO so</font>

112
00:04:49,250 --> 00:04:53,870
really the goals of<font color="#E5E5E5"> this talk is for all</font>

113
00:04:51,949 --> 00:04:55,699
of you guys to<font color="#E5E5E5"> understand efficacy</font><font color="#CCCCCC"> of</font>

114
00:04:53,870 --> 00:04:56,840
application whitelisting<font color="#E5E5E5"> application</font>

115
00:04:55,699 --> 00:04:58,250
whitelisting is the most effective

116
00:04:56,840 --> 00:05:00,349
security<font color="#E5E5E5"> control that you can</font><font color="#CCCCCC"> implement</font>

117
00:04:58,250 --> 00:05:02,319
<font color="#E5E5E5">if you do it right and that's what I</font>

118
00:05:00,349 --> 00:05:04,580
<font color="#E5E5E5">really want you to get</font><font color="#CCCCCC"> out of the talk</font>

119
00:05:02,319 --> 00:05:05,599
<font color="#E5E5E5">you know like</font><font color="#CCCCCC"> whenever</font><font color="#E5E5E5"> I go up an</font>

120
00:05:04,580 --> 00:05:07,909
application<font color="#E5E5E5"> whitelisting</font>

121
00:05:05,599 --> 00:05:09,409
and it's actually<font color="#E5E5E5"> done right I can't do</font>

122
00:05:07,909 --> 00:05:14,360
<font color="#CCCCCC">anything as a red teamer</font>

123
00:05:09,409 --> 00:05:15,680
<font color="#CCCCCC">I'm</font><font color="#E5E5E5"> completely shut down</font><font color="#CCCCCC"> so with that</font>

124
00:05:14,360 --> 00:05:17,690
<font color="#E5E5E5">you have to understand the importance of</font>

125
00:05:15,680 --> 00:05:20,330
application why those<font color="#E5E5E5"> bypasses in order</font>

126
00:05:17,690 --> 00:05:23,380
to be able<font color="#E5E5E5"> to tune your policy so that I</font>

127
00:05:20,330 --> 00:05:25,550
can't do anything<font color="#E5E5E5"> as a red teamer and so</font>

128
00:05:23,380 --> 00:05:27,620
with that<font color="#E5E5E5"> I want to make</font><font color="#CCCCCC"> you guys</font>

129
00:05:25,550 --> 00:05:30,219
capable of<font color="#E5E5E5"> testing the efficacy of your</font>

130
00:05:27,620 --> 00:05:31,849
application<font color="#CCCCCC"> Wireless policies as well as</font>

131
00:05:30,219 --> 00:05:35,419
<font color="#E5E5E5">demonstrate the capabilities of</font>

132
00:05:31,849 --> 00:05:36,560
application whitelist bypasses so now

133
00:05:35,419 --> 00:05:37,849
we're going<font color="#E5E5E5"> to talk about application</font>

134
00:05:36,560 --> 00:05:40,460
whitelisting and what that is so<font color="#E5E5E5"> we can</font>

135
00:05:37,849 --> 00:05:41,630
get some definitions<font color="#CCCCCC"> out of the way</font><font color="#E5E5E5"> so</font>

136
00:05:40,460 --> 00:05:43,489
application why<font color="#CCCCCC"> this</font><font color="#E5E5E5"> thing's really just</font>

137
00:05:41,630 --> 00:05:46,759
saying like hey you<font color="#E5E5E5"> can only run this</font>

138
00:05:43,490 --> 00:05:49,310
stuff on a system and that's it

139
00:05:46,759 --> 00:05:50,930
and this image<font color="#E5E5E5"> to the</font><font color="#CCCCCC"> right is</font><font color="#E5E5E5"> from Lee</font>

140
00:05:49,310 --> 00:05:53,180
homes from Microsoft from one of his

141
00:05:50,930 --> 00:05:54,919
personal<font color="#E5E5E5"> blog post and so this is what</font>

142
00:05:53,180 --> 00:05:58,039
he calls<font color="#E5E5E5"> the Maslow's hierarchy of</font>

143
00:05:54,919 --> 00:06:00,830
security<font color="#E5E5E5"> controls</font><font color="#CCCCCC"> what I really want to</font>

144
00:05:58,039 --> 00:06:03,680
<font color="#E5E5E5">focus on is app Locker and</font><font color="#CCCCCC"> allow mode an</font>

145
00:06:00,830 --> 00:06:06,080
app Locker and deny<font color="#CCCCCC"> mode so app Locker</font>

146
00:06:03,680 --> 00:06:08,180
and deny mode would be<font color="#E5E5E5"> like a blacklist</font>

147
00:06:06,080 --> 00:06:10,159
approach<font color="#E5E5E5"> saying you can't run these</font>

148
00:06:08,180 --> 00:06:12,830
executables all you can't run this<font color="#E5E5E5"> stuff</font>

149
00:06:10,159 --> 00:06:14,300
at all<font color="#E5E5E5"> app Locker and allow mode would</font>

150
00:06:12,830 --> 00:06:17,599
<font color="#E5E5E5">be</font><font color="#CCCCCC"> a white listing approach saying</font><font color="#E5E5E5"> you</font>

151
00:06:14,300 --> 00:06:22,849
can only<font color="#E5E5E5"> run this set of by name or this</font>

152
00:06:17,599 --> 00:06:24,949
set of stuff so<font color="#E5E5E5"> there's actually</font><font color="#CCCCCC"> a</font>

153
00:06:22,849 --> 00:06:26,599
report for from mandiant that was

154
00:06:24,949 --> 00:06:28,190
<font color="#E5E5E5">released earlier this</font><font color="#CCCCCC"> year called M</font>

155
00:06:26,599 --> 00:06:31,039
<font color="#E5E5E5">trends some of you may be familiar with</font>

156
00:06:28,190 --> 00:06:32,270
it some<font color="#E5E5E5"> of you may not</font><font color="#CCCCCC"> so this is</font>

157
00:06:31,039 --> 00:06:34,870
<font color="#E5E5E5">literally probably the</font><font color="#CCCCCC"> only</font><font color="#E5E5E5"> thing I'm</font>

158
00:06:32,270 --> 00:06:36,710
going<font color="#E5E5E5"> to read off my slides but</font>

159
00:06:34,870 --> 00:06:38,060
application whitelisting is another

160
00:06:36,710 --> 00:06:38,729
important detection and prevention

161
00:06:38,060 --> 00:06:40,379
control we

162
00:06:38,729 --> 00:06:42,449
lacking in<font color="#E5E5E5"> organizations we assess</font>

163
00:06:40,379 --> 00:06:44,099
without application<font color="#CCCCCC"> whitelisting end</font>

164
00:06:42,449 --> 00:06:45,990
<font color="#CCCCCC">users</font><font color="#E5E5E5"> and attackers have the ability</font><font color="#CCCCCC"> to</font>

165
00:06:44,099 --> 00:06:48,270
install arbitrary software<font color="#CCCCCC"> in an</font>

166
00:06:45,990 --> 00:06:49,830
uncontrolled manner<font color="#E5E5E5"> these weaknesses are</font>

167
00:06:48,270 --> 00:06:51,240
commonly exploited by<font color="#E5E5E5"> attackers and the</font>

168
00:06:49,830 --> 00:06:52,889
initial<font color="#CCCCCC"> compromised and established</font>

169
00:06:51,240 --> 00:06:54,539
foothold stages of the attacker

170
00:06:52,889 --> 00:06:57,150
<font color="#E5E5E5">lifecycle in the</font><font color="#CCCCCC"> incidents we</font>

171
00:06:54,539 --> 00:06:59,998
investigate so later in the talk we will

172
00:06:57,150 --> 00:07:03,179
talk<font color="#CCCCCC"> through an attack at a targeted</font>

173
00:06:59,999 --> 00:07:05,339
attacker lifecycle scenario and<font color="#E5E5E5"> maybe an</font>

174
00:07:03,180 --> 00:07:06,990
attacker that's not so enlightened<font color="#E5E5E5"> and</font>

175
00:07:05,339 --> 00:07:08,999
maybe<font color="#CCCCCC"> isn't aware of</font><font color="#E5E5E5"> these application</font>

176
00:07:06,990 --> 00:07:13,499
might was<font color="#CCCCCC"> bypass</font><font color="#E5E5E5"> or this living off the</font>

177
00:07:08,999 --> 00:07:15,089
land<font color="#CCCCCC"> type of methodology and then you</font>

178
00:07:13,499 --> 00:07:17,339
know we'll talk through<font color="#E5E5E5"> an enlightened</font>

179
00:07:15,089 --> 00:07:19,110
attacker scenario<font color="#E5E5E5"> in relation to</font>

180
00:07:17,339 --> 00:07:21,270
application whitelisting and having that

181
00:07:19,110 --> 00:07:23,339
implemented but first we need to talk

182
00:07:21,270 --> 00:07:24,628
<font color="#E5E5E5">about you know what solutions are</font>

183
00:07:23,339 --> 00:07:26,729
<font color="#CCCCCC">available for application whitelisting</font>

184
00:07:24,629 --> 00:07:28,499
like what can<font color="#E5E5E5"> you use and in this</font>

185
00:07:26,729 --> 00:07:30,419
<font color="#E5E5E5">particular</font><font color="#CCCCCC"> talk we're only focusing on</font>

186
00:07:28,499 --> 00:07:32,399
<font color="#CCCCCC">windows just</font><font color="#E5E5E5"> so that's clear</font>

187
00:07:30,419 --> 00:07:34,289
there's application whitelisting for<font color="#CCCCCC"> OSX</font>

188
00:07:32,399 --> 00:07:36,569
<font color="#E5E5E5">and</font><font color="#CCCCCC"> Linux as well</font><font color="#E5E5E5"> but I'm</font><font color="#CCCCCC"> not</font><font color="#E5E5E5"> talking</font>

189
00:07:34,289 --> 00:07:39,270
about<font color="#E5E5E5"> that at</font><font color="#CCCCCC"> all in this</font><font color="#E5E5E5"> particular</font>

190
00:07:36,569 --> 00:07:42,560
talk<font color="#E5E5E5"> so the free solutions from</font>

191
00:07:39,270 --> 00:07:44,698
Microsoft<font color="#E5E5E5"> are app Walker and</font><font color="#CCCCCC"> device card</font>

192
00:07:42,560 --> 00:07:47,490
app blocker is probably the most popular

193
00:07:44,699 --> 00:07:50,699
one<font color="#E5E5E5"> and the Vice card is much more</font>

194
00:07:47,490 --> 00:07:51,959
complex than application whitelisting<font color="#CCCCCC"> is</font>

195
00:07:50,699 --> 00:07:54,899
much more than<font color="#CCCCCC"> that</font><font color="#E5E5E5"> it's really</font><font color="#CCCCCC"> like a</font>

196
00:07:51,959 --> 00:07:56,999
whole code integrity<font color="#CCCCCC"> policies and code</font>

197
00:07:54,899 --> 00:07:59,399
integrity<font color="#CCCCCC"> policy for the entire system</font>

198
00:07:56,999 --> 00:08:01,139
<font color="#CCCCCC">so it's a lot different we're not going</font>

199
00:07:59,399 --> 00:08:02,729
<font color="#CCCCCC">to focus too much on device guard</font><font color="#E5E5E5"> today</font>

200
00:08:01,139 --> 00:08:06,229
we're going<font color="#E5E5E5"> to talk about app</font><font color="#CCCCCC"> Walker a</font>

201
00:08:02,729 --> 00:08:09,479
lot<font color="#CCCCCC"> and then like most next-generation</font>

202
00:08:06,229 --> 00:08:11,008
<font color="#E5E5E5">antivirus products has it in it the</font>

203
00:08:09,479 --> 00:08:13,139
ability to application whitelist<font color="#CCCCCC"> and</font>

204
00:08:11,009 --> 00:08:15,749
then most<font color="#E5E5E5"> endpoint defense and readiness</font>

205
00:08:13,139 --> 00:08:17,669
<font color="#CCCCCC">procs have it as well</font><font color="#E5E5E5"> not all</font><font color="#CCCCCC"> of them do</font>

206
00:08:15,749 --> 00:08:19,889
though there's a few other paid

207
00:08:17,669 --> 00:08:21,719
solutions like bit<font color="#E5E5E5"> 9</font><font color="#CCCCCC"> air lock digital</font>

208
00:08:19,889 --> 00:08:24,599
and there's some other<font color="#CCCCCC"> ones out</font><font color="#E5E5E5"> there</font>

209
00:08:21,719 --> 00:08:27,058
<font color="#CCCCCC">but</font><font color="#E5E5E5"> just to name a few</font><font color="#CCCCCC"> from the</font><font color="#E5E5E5"> paid</font>

210
00:08:24,599 --> 00:08:29,248
side<font color="#E5E5E5"> so if we take a look at app Locker</font>

211
00:08:27,059 --> 00:08:31,949
default rules it's kind<font color="#CCCCCC"> of</font><font color="#E5E5E5"> confusing</font>

212
00:08:29,249 --> 00:08:35,159
they really like Microsoft calls it the

213
00:08:31,949 --> 00:08:38,579
app Locker default rule but really it's

214
00:08:35,159 --> 00:08:40,139
<font color="#CCCCCC">three rules in one</font><font color="#E5E5E5"> that say</font><font color="#CCCCCC"> ok if you're</font>

215
00:08:38,578 --> 00:08:40,679
an admin you can<font color="#E5E5E5"> run anything on the</font>

216
00:08:40,139 --> 00:08:44,790
system

217
00:08:40,679 --> 00:08:47,550
<font color="#CCCCCC">alright makes sense and</font><font color="#E5E5E5"> then everyone</font>

218
00:08:44,790 --> 00:08:51,029
<font color="#CCCCCC">can run anything</font><font color="#E5E5E5"> from the windows</font>

219
00:08:47,550 --> 00:08:52,709
directory<font color="#CCCCCC"> so see</font><font color="#E5E5E5"> windows and</font><font color="#CCCCCC"> then</font>

220
00:08:51,029 --> 00:08:56,220
everyone can<font color="#E5E5E5"> run anything</font><font color="#CCCCCC"> from</font>

221
00:08:52,710 --> 00:08:57,630
see Program Files so I'd like all<font color="#CCCCCC"> of</font><font color="#E5E5E5"> you</font>

222
00:08:56,220 --> 00:08:59,490
to<font color="#E5E5E5"> just</font><font color="#CCCCCC"> kind of think about that for a</font>

223
00:08:57,630 --> 00:09:01,950
<font color="#CCCCCC">moment</font><font color="#E5E5E5"> and think about maybe like the</font>

224
00:08:59,490 --> 00:09:03,839
impact that might have<font color="#E5E5E5"> from a red team</font>

225
00:09:01,950 --> 00:09:05,700
<font color="#E5E5E5">where an attacker perspective especially</font>

226
00:09:03,839 --> 00:09:09,060
<font color="#CCCCCC">in the scenario of a more enlightened</font>

227
00:09:05,700 --> 00:09:10,380
<font color="#E5E5E5">attacker</font><font color="#CCCCCC"> so this is</font><font color="#E5E5E5"> actually how we</font>

228
00:09:09,060 --> 00:09:13,140
enforce<font color="#CCCCCC"> the policy you</font><font color="#E5E5E5"> can do this</font>

229
00:09:10,380 --> 00:09:14,790
through local security policy<font color="#CCCCCC"> through</font>

230
00:09:13,140 --> 00:09:16,560
the<font color="#E5E5E5"> Microsoft management console</font><font color="#CCCCCC"> snap-in</font>

231
00:09:14,790 --> 00:09:18,810
or through group policy<font color="#CCCCCC"> and push that</font>

232
00:09:16,560 --> 00:09:21,180
out to<font color="#CCCCCC"> your domain or for some multiple</font>

233
00:09:18,810 --> 00:09:22,589
domains or whatever it may be<font color="#CCCCCC"> and to</font>

234
00:09:21,180 --> 00:09:24,270
<font color="#CCCCCC">actually configure</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> outlaw core</font>

235
00:09:22,589 --> 00:09:25,709
<font color="#E5E5E5">policy and enforce it</font><font color="#CCCCCC"> you have to</font>

236
00:09:24,270 --> 00:09:27,149
restart<font color="#E5E5E5"> the</font><font color="#CCCCCC"> systems that's</font><font color="#E5E5E5"> something to</font>

237
00:09:25,709 --> 00:09:29,939
keep in mind<font color="#E5E5E5"> you know</font><font color="#CCCCCC"> you may</font><font color="#E5E5E5"> not just</font>

238
00:09:27,149 --> 00:09:31,500
<font color="#CCCCCC">be able to implement app Locker across</font>

239
00:09:29,940 --> 00:09:33,660
your organization and reboot every

240
00:09:31,500 --> 00:09:35,610
single<font color="#E5E5E5"> system</font><font color="#CCCCCC"> because you rely on it for</font>

241
00:09:33,660 --> 00:09:38,880
critical business functions just<font color="#E5E5E5"> as an</font>

242
00:09:35,610 --> 00:09:40,110
<font color="#CCCCCC">example so now we</font><font color="#E5E5E5"> need to talk</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> little</font>

243
00:09:38,880 --> 00:09:41,850
<font color="#CCCCCC">bit about application whitelist wipe</font>

244
00:09:40,110 --> 00:09:43,260
asses and what they<font color="#E5E5E5"> are like let's get a</font>

245
00:09:41,850 --> 00:09:46,260
definition<font color="#CCCCCC"> so really an application</font>

246
00:09:43,260 --> 00:09:47,850
<font color="#E5E5E5">Wireless bypass is really just using</font>

247
00:09:46,260 --> 00:09:49,319
something inherently trusted by the

248
00:09:47,850 --> 00:09:51,209
<font color="#E5E5E5">application whitelisting</font>

249
00:09:49,320 --> 00:09:52,740
to achieve code execution<font color="#E5E5E5"> like that's</font>

250
00:09:51,209 --> 00:09:55,500
the goal something trusted by the

251
00:09:52,740 --> 00:09:58,140
solution to achieve code execution<font color="#E5E5E5"> great</font>

252
00:09:55,500 --> 00:10:00,630
so what's an<font color="#CCCCCC"> example of</font><font color="#E5E5E5"> that so one</font>

253
00:09:58,140 --> 00:10:02,550
<font color="#E5E5E5">example that</font><font color="#CCCCCC"> is read served 32 exe this</font>

254
00:10:00,630 --> 00:10:04,760
is<font color="#E5E5E5"> also known as squiggly-doo you may</font>

255
00:10:02,550 --> 00:10:08,520
have seen<font color="#E5E5E5"> some</font><font color="#CCCCCC"> of the like</font><font color="#E5E5E5"> posters at</font>

256
00:10:04,760 --> 00:10:10,770
blackhat<font color="#E5E5E5"> you know</font><font color="#CCCCCC"> X vendor or product</font>

257
00:10:08,520 --> 00:10:13,829
<font color="#E5E5E5">stop squiggly-doo we've actually seen</font>

258
00:10:10,770 --> 00:10:15,630
that<font color="#E5E5E5"> there</font><font color="#CCCCCC"> so Casey Smith's</font><font color="#E5E5E5"> also known</font>

259
00:10:13,830 --> 00:10:18,900
<font color="#CCCCCC">is at sub T on</font><font color="#E5E5E5"> Twitter is</font><font color="#CCCCCC"> the one</font><font color="#E5E5E5"> that</font>

260
00:10:15,630 --> 00:10:20,279
originally<font color="#E5E5E5"> discovered this and so</font>

261
00:10:18,900 --> 00:10:22,650
essentially what<font color="#CCCCCC"> we discovered is you</font>

262
00:10:20,279 --> 00:10:25,320
<font color="#E5E5E5">could remotely retrieve and execute what</font>

263
00:10:22,650 --> 00:10:27,000
are called coms<font color="#E5E5E5"> triplets</font><font color="#CCCCCC"> a little like</font>

264
00:10:25,320 --> 00:10:29,550
Chris what does that<font color="#E5E5E5"> mean</font><font color="#CCCCCC"> comscore flow</font>

265
00:10:27,000 --> 00:10:32,670
like what it what is<font color="#E5E5E5"> that really what it</font>

266
00:10:29,550 --> 00:10:34,260
is is an XML file with the ability<font color="#CCCCCC"> to</font>

267
00:10:32,670 --> 00:10:38,130
execute different<font color="#E5E5E5"> windows script host</font>

268
00:10:34,260 --> 00:10:39,750
languages so for example<font color="#E5E5E5"> J script or VB</font>

269
00:10:38,130 --> 00:10:42,839
script<font color="#E5E5E5"> are two examples of windows</font>

270
00:10:39,750 --> 00:10:45,390
script host language<font color="#CCCCCC"> so if you look at</font>

271
00:10:42,839 --> 00:10:47,760
this the image at the bottom<font color="#CCCCCC"> is actually</font>

272
00:10:45,390 --> 00:10:50,490
straight from<font color="#CCCCCC"> MSDN which is also</font><font color="#E5E5E5"> Casey's</font>

273
00:10:47,760 --> 00:10:52,770
favorite video game<font color="#E5E5E5"> so all of you that</font>

274
00:10:50,490 --> 00:10:54,720
say you want to<font color="#E5E5E5"> be a red teamer and do</font>

275
00:10:52,770 --> 00:10:55,860
<font color="#E5E5E5">research like Casey or</font><font color="#CCCCCC"> Matt Graber or</font>

276
00:10:54,720 --> 00:10:58,440
some of these other fantastic

277
00:10:55,860 --> 00:11:00,000
researchers that<font color="#E5E5E5"> are out there coming up</font>

278
00:10:58,440 --> 00:11:01,650
with a lot of the living off the<font color="#CCCCCC"> land</font>

279
00:11:00,000 --> 00:11:03,360
and methodology as well as application

280
00:11:01,650 --> 00:11:04,770
while I was<font color="#E5E5E5"> bypasses</font><font color="#CCCCCC"> you have to realize</font>

281
00:11:03,360 --> 00:11:08,220
these people<font color="#E5E5E5"> work</font>

282
00:11:04,770 --> 00:11:10,170
non-stop<font color="#CCCCCC"> you know</font><font color="#E5E5E5"> when I worked with</font>

283
00:11:08,220 --> 00:11:12,060
<font color="#E5E5E5">Casey</font><font color="#CCCCCC"> I talked about</font>

284
00:11:10,170 --> 00:11:14,579
oh yeah like I've been playing some dota

285
00:11:12,060 --> 00:11:16,229
2 and doing this it's so much fun<font color="#E5E5E5"> he's</font>

286
00:11:14,580 --> 00:11:18,690
like she's like<font color="#CCCCCC"> my favorite video games</font>

287
00:11:16,230 --> 00:11:20,760
<font color="#CCCCCC">MSDN</font><font color="#E5E5E5"> and that's kind of an inside joke</font>

288
00:11:18,690 --> 00:11:23,190
<font color="#CCCCCC">between us</font><font color="#E5E5E5"> so if you</font><font color="#CCCCCC"> actually</font><font color="#E5E5E5"> look at</font>

289
00:11:20,760 --> 00:11:24,839
<font color="#CCCCCC">MSDN you can see you know there are</font>

290
00:11:23,190 --> 00:11:27,089
different parameters for<font color="#CCCCCC"> Rexxar</font><font color="#E5E5E5"> of 32</font>

291
00:11:24,839 --> 00:11:29,310
<font color="#CCCCCC">and so the /s here is really</font><font color="#E5E5E5"> just</font><font color="#CCCCCC"> saying</font>

292
00:11:27,089 --> 00:11:30,959
like please be silent for us like

293
00:11:29,310 --> 00:11:33,209
suppress any error messages we<font color="#CCCCCC"> don't</font>

294
00:11:30,959 --> 00:11:36,839
want the<font color="#E5E5E5"> user to see anything</font><font color="#CCCCCC"> when we're</font>

295
00:11:33,209 --> 00:11:39,959
doing<font color="#E5E5E5"> a red team or tip them off</font><font color="#CCCCCC"> these</font>

296
00:11:36,839 --> 00:11:41,940
flash<font color="#E5E5E5"> en specifically says to not call</font>

297
00:11:39,959 --> 00:11:44,040
the register component and the reason

298
00:11:41,940 --> 00:11:48,480
why this is important is because to

299
00:11:44,040 --> 00:11:50,099
register a common object<font color="#CCCCCC"> on system</font><font color="#E5E5E5"> it</font>

300
00:11:48,480 --> 00:11:53,130
requires you to be<font color="#E5E5E5"> a local administrator</font>

301
00:11:50,100 --> 00:11:56,730
<font color="#E5E5E5">whereas unregistering you just need to</font>

302
00:11:53,130 --> 00:11:59,250
be a normal user<font color="#CCCCCC"> so it's fantastic for</font>

303
00:11:56,730 --> 00:12:01,110
an initial asset<font color="#E5E5E5"> initial access</font>

304
00:11:59,250 --> 00:12:04,200
perspective and it's important<font color="#E5E5E5"> to</font>

305
00:12:01,110 --> 00:12:06,149
understand that<font color="#CCCCCC"> so</font><font color="#E5E5E5"> this last you again</font>

306
00:12:04,200 --> 00:12:08,850
unregister like we just talked about<font color="#E5E5E5"> and</font>

307
00:12:06,149 --> 00:12:11,970
<font color="#E5E5E5">the</font><font color="#CCCCCC"> /i is saying like hey i want</font><font color="#E5E5E5"> to</font>

308
00:12:08,850 --> 00:12:13,980
execute<font color="#E5E5E5"> this script let file so it can</font>

309
00:12:11,970 --> 00:12:15,390
actually<font color="#E5E5E5"> remotely really cheap remotely</font>

310
00:12:13,980 --> 00:12:18,779
retrieve these scriptlet files

311
00:12:15,390 --> 00:12:20,459
<font color="#CCCCCC">I mean sckraab</font><font color="#E5E5E5"> Jagiello is the specific</font>

312
00:12:18,779 --> 00:12:25,860
dynamic<font color="#E5E5E5"> link library that's related to</font>

313
00:12:20,459 --> 00:12:27,810
registering<font color="#E5E5E5"> comm objects so let's take a</font>

314
00:12:25,860 --> 00:12:30,690
look<font color="#E5E5E5"> at</font><font color="#CCCCCC"> KC's original proof of concept</font>

315
00:12:27,810 --> 00:12:33,000
that<font color="#E5E5E5"> he released a couple years ago</font><font color="#CCCCCC"> so</font>

316
00:12:30,690 --> 00:12:34,829
there are a<font color="#E5E5E5"> lot of lines here and you</font>

317
00:12:33,000 --> 00:12:37,230
know it looks<font color="#CCCCCC"> like</font><font color="#E5E5E5"> XML and you can see</font>

318
00:12:34,829 --> 00:12:38,969
<font color="#E5E5E5">jscript in there and the C data portion</font>

319
00:12:37,230 --> 00:12:41,399
which really means content data<font color="#E5E5E5"> within</font>

320
00:12:38,970 --> 00:12:43,770
<font color="#E5E5E5">XML as the fine was in the</font><font color="#CCCCCC"> external</font>

321
00:12:41,399 --> 00:12:45,450
standard it's nothing special<font color="#CCCCCC"> but like</font>

322
00:12:43,770 --> 00:12:47,279
the most important part<font color="#CCCCCC"> of this</font><font color="#E5E5E5"> is line</font>

323
00:12:45,450 --> 00:12:49,350
11 like this is the action<font color="#E5E5E5"> that we're</font>

324
00:12:47,279 --> 00:12:52,170
gonna take this is what we want to

325
00:12:49,350 --> 00:12:55,230
happen<font color="#E5E5E5"> on the system this is our code</font>

326
00:12:52,170 --> 00:12:57,000
execution<font color="#E5E5E5"> so in this case he just</font>

327
00:12:55,230 --> 00:13:02,160
<font color="#CCCCCC">released</font><font color="#E5E5E5"> they prove the concept</font><font color="#CCCCCC"> that</font>

328
00:12:57,000 --> 00:13:04,410
says to run Cal<font color="#CCCCCC"> PXE so if we travel</font><font color="#E5E5E5"> back</font>

329
00:13:02,160 --> 00:13:06,689
in time a little bit<font color="#CCCCCC"> to the day that</font>

330
00:13:04,410 --> 00:13:08,550
case you<font color="#E5E5E5"> release this how would we go</font>

331
00:13:06,690 --> 00:13:10,620
about weaponizing this you know like

332
00:13:08,550 --> 00:13:12,599
there's been<font color="#E5E5E5"> a lot of stuff done a lot</font>

333
00:13:10,620 --> 00:13:14,850
of<font color="#E5E5E5"> blog</font><font color="#CCCCCC"> post</font><font color="#E5E5E5"> written since then on how</font>

334
00:13:12,600 --> 00:13:16,890
to weaponize it however you know

335
00:13:14,850 --> 00:13:18,510
immediately<font color="#E5E5E5"> as a red</font><font color="#CCCCCC"> teamer</font><font color="#E5E5E5"> as a pen</font>

336
00:13:16,890 --> 00:13:20,760
tester how do<font color="#CCCCCC"> i start</font><font color="#E5E5E5"> using</font><font color="#CCCCCC"> this or</font>

337
00:13:18,510 --> 00:13:24,300
a blue<font color="#E5E5E5"> Timur how I start</font><font color="#CCCCCC"> creating more</font>

338
00:13:20,760 --> 00:13:27,350
advanced<font color="#E5E5E5"> payloads</font><font color="#CCCCCC"> to audit the my</font>

339
00:13:24,300 --> 00:13:30,810
ability to<font color="#E5E5E5"> detect and respond to things</font>

340
00:13:27,350 --> 00:13:32,940
so I'm gonna<font color="#E5E5E5"> peel as written a blog post</font>

341
00:13:30,810 --> 00:13:37,229
<font color="#CCCCCC">on our</font><font color="#E5E5E5"> exxor of 32 and if you go to my</font>

342
00:13:32,940 --> 00:13:38,730
<font color="#CCCCCC">blog</font><font color="#E5E5E5"> post</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> describe the process to</font>

343
00:13:37,230 --> 00:13:43,140
essentially weaponize the original<font color="#E5E5E5"> proof</font>

344
00:13:38,730 --> 00:13:46,110
<font color="#E5E5E5">of</font><font color="#CCCCCC"> concept and</font><font color="#E5E5E5"> later</font><font color="#CCCCCC"> we'll see further</font>

345
00:13:43,140 --> 00:13:48,060
weaponization of this but I actually

346
00:13:46,110 --> 00:13:50,280
have a quick demo for you guys of this

347
00:13:48,060 --> 00:13:54,209
blog post<font color="#E5E5E5"> of how you would perform this</font>

348
00:13:50,280 --> 00:13:56,819
process<font color="#E5E5E5"> manually so we're gonna go ahead</font>

349
00:13:54,210 --> 00:13:59,700
and fire<font color="#CCCCCC"> out Metasploit</font><font color="#E5E5E5"> and use exploit</font>

350
00:13:56,820 --> 00:14:01,920
multi script web<font color="#CCCCCC"> delivery we're going to</font>

351
00:13:59,700 --> 00:14:05,070
take a look at the<font color="#E5E5E5"> options make sure we</font>

352
00:14:01,920 --> 00:14:07,349
know what our PR IP address is and we're

353
00:14:05,070 --> 00:14:10,200
<font color="#E5E5E5">gonna go</font><font color="#CCCCCC"> ahead and set up a web delivery</font>

354
00:14:07,350 --> 00:14:12,810
attack via<font color="#CCCCCC"> Metasploit to utilize the</font>

355
00:14:10,200 --> 00:14:16,020
<font color="#E5E5E5">proof of</font><font color="#CCCCCC"> concept that we just saw from</font>

356
00:14:12,810 --> 00:14:18,300
<font color="#CCCCCC">Casey</font><font color="#E5E5E5"> so we're setting our IP address</font>

357
00:14:16,020 --> 00:14:19,530
our local port<font color="#CCCCCC"> how many people are like</font>

358
00:14:18,300 --> 00:14:20,579
familiar with<font color="#CCCCCC"> Metasploit in here I'm</font>

359
00:14:19,530 --> 00:14:23,220
<font color="#E5E5E5">sure you guys have seen this kind</font><font color="#CCCCCC"> of</font>

360
00:14:20,580 --> 00:14:26,490
stuff a<font color="#E5E5E5"> lot okay great looks</font><font color="#CCCCCC"> like so</font>

361
00:14:23,220 --> 00:14:29,630
there's decent<font color="#CCCCCC"> amount of</font><font color="#E5E5E5"> hands oh I'm</font>

362
00:14:26,490 --> 00:14:33,090
sorry we're gonna have to restart this

363
00:14:29,630 --> 00:14:35,130
that's my fault<font color="#CCCCCC"> I was wondering why it</font>

364
00:14:33,090 --> 00:14:37,020
wasn't<font color="#E5E5E5"> going on the screen</font><font color="#CCCCCC"> you know</font><font color="#E5E5E5"> you</font>

365
00:14:35,130 --> 00:14:41,520
know I'm good with technology<font color="#CCCCCC"> though</font>

366
00:14:37,020 --> 00:14:42,990
trust me see how we look at the IP

367
00:14:41,520 --> 00:14:44,670
address like I said<font color="#CCCCCC"> before we're gonna</font>

368
00:14:42,990 --> 00:14:48,030
set the local host IP<font color="#E5E5E5"> we're gonna set</font>

369
00:14:44,670 --> 00:14:49,680
the<font color="#E5E5E5"> local port and then we're gonna show</font>

370
00:14:48,030 --> 00:14:51,209
<font color="#E5E5E5">targets you</font><font color="#CCCCCC"> can see that in the</font>

371
00:14:49,680 --> 00:14:52,650
Metasploit framework they do have a<font color="#E5E5E5"> reg</font>

372
00:14:51,210 --> 00:14:54,180
<font color="#CCCCCC">surf</font><font color="#E5E5E5"> thirty-two option but we're</font>

373
00:14:52,650 --> 00:14:56,310
pretending<font color="#CCCCCC"> like remember we went back in</font>

374
00:14:54,180 --> 00:14:58,949
<font color="#CCCCCC">time here</font><font color="#E5E5E5"> this didn't</font><font color="#CCCCCC"> exist yet no one</font>

375
00:14:56,310 --> 00:15:01,369
merge the sins<font color="#E5E5E5"> of Metasploit</font><font color="#CCCCCC"> so we see</font>

376
00:14:58,950 --> 00:15:03,900
that there's a<font color="#CCCCCC"> powershell option and so</font>

377
00:15:01,370 --> 00:15:06,560
<font color="#CCCCCC">and here you</font><font color="#E5E5E5"> can</font><font color="#CCCCCC"> see me fumbling a</font>

378
00:15:03,900 --> 00:15:08,340
little bit and my<font color="#E5E5E5"> VM was running slow</font>

379
00:15:06,560 --> 00:15:10,979
<font color="#E5E5E5">but you know we're</font><font color="#CCCCCC"> just setting the</font>

380
00:15:08,340 --> 00:15:14,010
payload<font color="#E5E5E5"> to Windows interpreter</font><font color="#CCCCCC"> reverse</font>

381
00:15:10,980 --> 00:15:15,390
<font color="#CCCCCC">HTTP or a reverse HTTP we're checking</font>

382
00:15:14,010 --> 00:15:17,640
<font color="#CCCCCC">double-checking our options making sure</font>

383
00:15:15,390 --> 00:15:19,230
everything's<font color="#E5E5E5"> set right and</font><font color="#CCCCCC"> then we're</font>

384
00:15:17,640 --> 00:15:21,720
gonna go ahead<font color="#E5E5E5"> go</font><font color="#CCCCCC"> ahead and do exploit -</font>

385
00:15:19,230 --> 00:15:23,520
<font color="#E5E5E5">J and we get you</font><font color="#CCCCCC"> know our PowerShell</font>

386
00:15:21,720 --> 00:15:25,440
one-liner to put<font color="#E5E5E5"> into</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> original proof</font>

387
00:15:23,520 --> 00:15:27,060
of concept<font color="#E5E5E5"> that case you released</font>

388
00:15:25,440 --> 00:15:29,940
<font color="#E5E5E5">because we want to</font><font color="#CCCCCC"> actually</font><font color="#E5E5E5"> use</font><font color="#CCCCCC"> this on</font>

389
00:15:27,060 --> 00:15:31,770
<font color="#E5E5E5">an assessment and so we go</font><font color="#CCCCCC"> into his</font>

390
00:15:29,940 --> 00:15:32,790
<font color="#E5E5E5">original</font><font color="#CCCCCC"> proof concepts</font><font color="#E5E5E5"> and we're going</font>

391
00:15:31,770 --> 00:15:35,310
to<font color="#E5E5E5"> replace this</font><font color="#CCCCCC"> calc</font>

392
00:15:32,790 --> 00:15:38,670
<font color="#CCCCCC">with</font><font color="#E5E5E5"> power</font><font color="#CCCCCC"> Saudi imc really</font><font color="#E5E5E5"> right makes</font>

393
00:15:35,310 --> 00:15:40,290
sense<font color="#E5E5E5"> like actually pretty simple</font><font color="#CCCCCC"> we're</font>

394
00:15:38,670 --> 00:15:42,329
<font color="#CCCCCC">going to go ahead and save the file</font><font color="#E5E5E5"> and</font>

395
00:15:40,290 --> 00:15:44,390
we'll go<font color="#E5E5E5"> over to</font><font color="#CCCCCC"> our</font><font color="#E5E5E5"> Windows host we're</font>

396
00:15:42,330 --> 00:15:47,730
going to go ahead and execute

397
00:15:44,390 --> 00:15:52,439
<font color="#CCCCCC">Rexxar</font><font color="#E5E5E5"> of 32 with the payload we just</font>

398
00:15:47,730 --> 00:15:53,820
developed so with<font color="#E5E5E5"> reg</font><font color="#CCCCCC"> served 32 just</font><font color="#E5E5E5"> we</font>

399
00:15:52,440 --> 00:15:55,260
talked<font color="#CCCCCC"> about this earlier about</font><font color="#E5E5E5"> all</font><font color="#CCCCCC"> the</font>

400
00:15:53,820 --> 00:15:57,660
different<font color="#E5E5E5"> options as</font><font color="#CCCCCC"> its gonna suppress</font>

401
00:15:55,260 --> 00:15:59,689
<font color="#E5E5E5">everything and means to not call</font>

402
00:15:57,660 --> 00:16:02,010
register and you means to specifically

403
00:15:59,690 --> 00:16:04,200
unregister something and the<font color="#CCCCCC"> eye is</font>

404
00:16:02,010 --> 00:16:05,700
<font color="#CCCCCC">going</font><font color="#E5E5E5"> to point to the actual</font><font color="#CCCCCC"> proven</font>

405
00:16:04,200 --> 00:16:07,860
concept<font color="#E5E5E5"> which we're pulling remotely</font>

406
00:16:05,700 --> 00:16:10,590
from<font color="#E5E5E5"> my blog and again</font><font color="#CCCCCC"> this grabbed a</font>

407
00:16:07,860 --> 00:16:14,330
yellow specifically related to<font color="#CCCCCC"> Tom</font>

408
00:16:10,590 --> 00:16:17,100
objects to<font color="#E5E5E5"> register and unregister them</font>

409
00:16:14,330 --> 00:16:18,810
<font color="#CCCCCC">so we can</font><font color="#E5E5E5"> see that our</font><font color="#CCCCCC"> polish partially</font>

410
00:16:17,100 --> 00:16:20,550
<font color="#CCCCCC">XP pay</font><font color="#E5E5E5"> will actually executed and it</font>

411
00:16:18,810 --> 00:16:24,689
went back<font color="#CCCCCC"> to</font><font color="#E5E5E5"> the remote address that we</font>

412
00:16:20,550 --> 00:16:26,729
<font color="#CCCCCC">expected</font><font color="#E5E5E5"> it to call back</font><font color="#CCCCCC"> to and then I</font>

413
00:16:24,690 --> 00:16:29,190
don't actually interact<font color="#CCCCCC"> with</font><font color="#E5E5E5"> the session</font>

414
00:16:26,730 --> 00:16:33,090
<font color="#E5E5E5">but you know you can take my word</font><font color="#CCCCCC"> for it</font>

415
00:16:29,190 --> 00:16:36,000
that<font color="#E5E5E5"> it actually did</font><font color="#CCCCCC"> work so just kind</font>

416
00:16:33,090 --> 00:16:39,300
of get<font color="#E5E5E5"> that out</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the way we'll go back</font>

417
00:16:36,000 --> 00:16:40,590
to<font color="#E5E5E5"> our presentation and</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> wow we've</font>

418
00:16:39,300 --> 00:16:43,079
traveled back<font color="#E5E5E5"> in time we figured out</font>

419
00:16:40,590 --> 00:16:44,790
like<font color="#E5E5E5"> okay initially how did people</font>

420
00:16:43,080 --> 00:16:47,430
weaponize this how are people gonna

421
00:16:44,790 --> 00:16:49,199
start<font color="#E5E5E5"> using this and</font><font color="#CCCCCC"> this is a lot about</font>

422
00:16:47,430 --> 00:16:51,359
like we saw across<font color="#E5E5E5"> the</font><font color="#CCCCCC"> industry is</font>

423
00:16:49,200 --> 00:16:52,770
people like<font color="#E5E5E5"> oh sweet I can drop up you</font>

424
00:16:51,360 --> 00:16:54,300
know a power shell and liner in here<font color="#CCCCCC"> and</font>

425
00:16:52,770 --> 00:16:57,449
use<font color="#CCCCCC"> it for</font><font color="#E5E5E5"> remote access within an HTML</font>

426
00:16:54,300 --> 00:16:59,400
application like that's pretty<font color="#E5E5E5"> cool</font>

427
00:16:57,450 --> 00:17:02,400
so if I got another<font color="#CCCCCC"> example</font><font color="#E5E5E5"> that's</font>

428
00:16:59,400 --> 00:17:04,260
different than<font color="#E5E5E5"> reg serve 32 that works</font>

429
00:17:02,400 --> 00:17:06,750
in a different<font color="#E5E5E5"> way there's a developer</font>

430
00:17:04,260 --> 00:17:10,020
utility called<font color="#E5E5E5"> msbuild exe and it lives</font>

431
00:17:06,750 --> 00:17:12,150
in C Windows microsoft.net framework and

432
00:17:10,020 --> 00:17:13,980
there are<font color="#E5E5E5"> various versions of it based</font>

433
00:17:12,150 --> 00:17:18,000
on<font color="#E5E5E5"> version of.net that you want to use</font>

434
00:17:13,980 --> 00:17:20,520
<font color="#E5E5E5">associated with that so msbuild has a</font>

435
00:17:18,000 --> 00:17:23,040
built-in capability<font color="#E5E5E5"> called inline tasks</font>

436
00:17:20,520 --> 00:17:26,310
really what this<font color="#CCCCCC"> capability is is like</font>

437
00:17:23,040 --> 00:17:27,960
an XML file<font color="#E5E5E5"> that takes c-sharp code and</font>

438
00:17:26,310 --> 00:17:31,440
then compiles it and<font color="#CCCCCC"> execute it in</font>

439
00:17:27,960 --> 00:17:33,180
memory<font color="#E5E5E5"> so like with our if we go back</font><font color="#CCCCCC"> to</font>

440
00:17:31,440 --> 00:17:35,940
our<font color="#E5E5E5"> slide of like what is an application</font>

441
00:17:33,180 --> 00:17:37,980
<font color="#CCCCCC">why it was bypass it's something that's</font>

442
00:17:35,940 --> 00:17:40,440
inherently trusted by the application

443
00:17:37,980 --> 00:17:42,840
whitelisting solution<font color="#E5E5E5"> that achieves code</font>

444
00:17:40,440 --> 00:17:44,700
execution<font color="#E5E5E5"> and this will compile an</font>

445
00:17:42,840 --> 00:17:46,320
execute code in memory for us<font color="#E5E5E5"> so</font>

446
00:17:44,700 --> 00:17:49,470
this is great from an application

447
00:17:46,320 --> 00:17:51,750
<font color="#CCCCCC">Wireless bypass perspective</font><font color="#E5E5E5"> so we can</font>

448
00:17:49,470 --> 00:17:53,880
talk through you know let's pretend we

449
00:17:51,750 --> 00:17:56,370
go back to the day<font color="#CCCCCC"> that Casey releases</font>

450
00:17:53,880 --> 00:17:57,840
msbuild because Casey also<font color="#E5E5E5"> also came up</font>

451
00:17:56,370 --> 00:18:00,479
<font color="#E5E5E5">with this application why it was bypass</font>

452
00:17:57,840 --> 00:18:02,370
<font color="#E5E5E5">and think like how do we weaponize this</font>

453
00:18:00,480 --> 00:18:05,180
now on register 32

454
00:18:02,370 --> 00:18:08,459
Casey<font color="#E5E5E5"> didn't give as much information</font>

455
00:18:05,180 --> 00:18:10,440
with msbuild<font color="#E5E5E5"> he provided</font><font color="#CCCCCC"> multiple</font>

456
00:18:08,460 --> 00:18:12,570
different<font color="#CCCCCC"> proof concepts</font><font color="#E5E5E5"> not ones</font><font color="#CCCCCC"> that</font>

457
00:18:10,440 --> 00:18:14,370
just popped out<font color="#E5E5E5"> but also executed</font>

458
00:18:12,570 --> 00:18:17,370
<font color="#E5E5E5">shellcode and so we can kind of talk</font>

459
00:18:14,370 --> 00:18:19,649
<font color="#E5E5E5">through using his his</font><font color="#CCCCCC"> shellcode proof of</font>

460
00:18:17,370 --> 00:18:21,179
<font color="#E5E5E5">concepts in a few minutes here but</font><font color="#CCCCCC"> again</font>

461
00:18:19,650 --> 00:18:26,550
like what<font color="#E5E5E5"> we really care</font><font color="#CCCCCC"> about is the</font>

462
00:18:21,180 --> 00:18:28,590
<font color="#CCCCCC">red box line</font><font color="#E5E5E5"> 14 so this would be an idea</font>

463
00:18:26,550 --> 00:18:30,240
of<font color="#CCCCCC"> doing this with how you this is</font><font color="#E5E5E5"> how</font>

464
00:18:28,590 --> 00:18:34,260
<font color="#CCCCCC">you would do hello world and</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> is a</font>

465
00:18:30,240 --> 00:18:36,810
proof of<font color="#CCCCCC"> concept that</font><font color="#E5E5E5"> Casey released</font><font color="#CCCCCC"> but</font>

466
00:18:34,260 --> 00:18:40,830
again he<font color="#CCCCCC"> also released</font><font color="#E5E5E5"> a proof of</font>

467
00:18:36,810 --> 00:18:42,540
<font color="#CCCCCC">concept for shellcode injection so</font>

468
00:18:40,830 --> 00:18:45,689
that's a little<font color="#E5E5E5"> more interesting</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> I</font>

469
00:18:42,540 --> 00:18:47,340
wrote a blog<font color="#CCCCCC"> post on how to</font><font color="#E5E5E5"> utilize the</font>

470
00:18:45,690 --> 00:18:49,890
shell code<font color="#E5E5E5"> injection proof of concept</font>

471
00:18:47,340 --> 00:18:52,409
that<font color="#CCCCCC"> he released</font><font color="#E5E5E5"> so we're going to go</font>

472
00:18:49,890 --> 00:18:55,770
through another<font color="#CCCCCC"> quick demo of how to</font>

473
00:18:52,410 --> 00:18:58,620
actually do<font color="#CCCCCC"> that</font><font color="#E5E5E5"> and so we're</font><font color="#CCCCCC"> gonna go</font>

474
00:18:55,770 --> 00:19:01,050
<font color="#CCCCCC">ahead and generate</font><font color="#E5E5E5"> a payload with NSF</font>

475
00:18:58,620 --> 00:19:03,120
venom and set our output C sharp so

476
00:19:01,050 --> 00:19:05,490
we're generating shell code with<font color="#E5E5E5"> MSF</font>

477
00:19:03,120 --> 00:19:08,699
venom<font color="#E5E5E5"> that's specific to c-sharp</font><font color="#CCCCCC"> because</font>

478
00:19:05,490 --> 00:19:10,290
again and this<font color="#CCCCCC"> build can takes in an XML</font>

479
00:19:08,700 --> 00:19:12,210
file with the capability of<font color="#E5E5E5"> an inline</font>

480
00:19:10,290 --> 00:19:15,060
stats function<font color="#E5E5E5"> to compile and execute</font>

481
00:19:12,210 --> 00:19:17,070
<font color="#CCCCCC">msbuild</font><font color="#E5E5E5"> and the c-sharp code within</font>

482
00:19:15,060 --> 00:19:19,379
<font color="#E5E5E5">memory so this is the proof of concepts</font>

483
00:19:17,070 --> 00:19:21,270
<font color="#CCCCCC">that kc1 proof of concept that</font><font color="#E5E5E5"> Casey had</font>

484
00:19:19,380 --> 00:19:23,910
released for<font color="#CCCCCC"> Emma's build which was</font>

485
00:19:21,270 --> 00:19:26,820
using<font color="#E5E5E5"> you know shell code injection with</font>

486
00:19:23,910 --> 00:19:30,240
C sharp and<font color="#CCCCCC"> msbuild</font><font color="#E5E5E5"> and one of the</font>

487
00:19:26,820 --> 00:19:32,220
things<font color="#E5E5E5"> about this particular</font><font color="#CCCCCC"> proven</font>

488
00:19:30,240 --> 00:19:35,580
<font color="#E5E5E5">concept e release is it is not fully</font>

489
00:19:32,220 --> 00:19:37,470
weaponized<font color="#CCCCCC"> in memory it is rewrite</font>

490
00:19:35,580 --> 00:19:40,020
<font color="#CCCCCC">execute</font><font color="#E5E5E5"> and a lot of endpoint defense</font>

491
00:19:37,470 --> 00:19:43,590
and readiness products look for<font color="#CCCCCC"> that in</font>

492
00:19:40,020 --> 00:19:46,290
memory so you<font color="#CCCCCC"> know your mileage</font><font color="#E5E5E5"> may</font><font color="#CCCCCC"> vary</font>

493
00:19:43,590 --> 00:19:47,459
if you were to use this so again<font color="#E5E5E5"> we're</font>

494
00:19:46,290 --> 00:19:49,680
<font color="#E5E5E5">gonna go back to</font><font color="#CCCCCC"> Metasploit we're gonna</font>

495
00:19:47,460 --> 00:19:51,420
set up<font color="#CCCCCC"> our handler the same old boring</font>

496
00:19:49,680 --> 00:19:53,400
stuff that we kind of talked about<font color="#E5E5E5"> with</font>

497
00:19:51,420 --> 00:19:56,490
reg<font color="#E5E5E5"> surf 32 we're having to do</font><font color="#CCCCCC"> all this</font>

498
00:19:53,400 --> 00:19:57,420
manually and we're making sure<font color="#E5E5E5"> that</font><font color="#CCCCCC"> we</font>

499
00:19:56,490 --> 00:19:59,220
have the right

500
00:19:57,420 --> 00:20:02,610
set and I believe in this<font color="#E5E5E5"> case we're</font>

501
00:19:59,220 --> 00:20:03,900
using reverse<font color="#CCCCCC"> HTTP</font><font color="#E5E5E5"> yes</font><font color="#CCCCCC"> see you can</font><font color="#E5E5E5"> see I</font>

502
00:20:02,610 --> 00:20:07,560
make mistakes too

503
00:20:03,900 --> 00:20:09,330
don't be afraid<font color="#CCCCCC"> to make mistakes and go</font>

504
00:20:07,560 --> 00:20:13,620
<font color="#E5E5E5">ahead and start</font><font color="#CCCCCC"> the job and then we'll</font>

505
00:20:09,330 --> 00:20:18,240
switch<font color="#CCCCCC"> back over</font><font color="#E5E5E5"> to our Windows virtual</font>

506
00:20:13,620 --> 00:20:19,830
machine<font color="#E5E5E5"> and go ahead and execute this so</font>

507
00:20:18,240 --> 00:20:21,480
our job was running<font color="#E5E5E5"> pop properly we know</font>

508
00:20:19,830 --> 00:20:23,639
<font color="#CCCCCC">Metasploit is ready and we're</font><font color="#E5E5E5"> gonna go</font>

509
00:20:21,480 --> 00:20:25,080
<font color="#E5E5E5">ahead and</font><font color="#CCCCCC"> use msbuild but we have to</font>

510
00:20:23,640 --> 00:20:27,960
<font color="#E5E5E5">know the path of it and that's hard to</font>

511
00:20:25,080 --> 00:20:32,730
remember<font color="#E5E5E5"> but see</font><font color="#CCCCCC"> Windows microsoft.net</font>

512
00:20:27,960 --> 00:20:34,290
framework version<font color="#CCCCCC"> 4</font><font color="#E5E5E5"> msbuild</font><font color="#CCCCCC"> exe</font><font color="#E5E5E5"> now we</font>

513
00:20:32,730 --> 00:20:36,330
have this XML file that<font color="#E5E5E5"> we've dropped</font>

514
00:20:34,290 --> 00:20:37,920
the<font color="#E5E5E5"> disk and we see it it's calling back</font>

515
00:20:36,330 --> 00:20:39,689
<font color="#CCCCCC">to the remote</font><font color="#E5E5E5"> address that we expect and</font>

516
00:20:37,920 --> 00:20:42,120
<font color="#CCCCCC">we</font><font color="#E5E5E5"> can see that</font><font color="#CCCCCC"> it's end this bill bxe</font>

517
00:20:39,690 --> 00:20:45,210
and<font color="#E5E5E5"> it calls back to 443 which would be</font>

518
00:20:42,120 --> 00:20:49,050
<font color="#E5E5E5">HTTP</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> then we're actually able</font><font color="#CCCCCC"> to</font>

519
00:20:45,210 --> 00:20:50,490
interact<font color="#E5E5E5"> with that</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> session and I</font>

520
00:20:49,050 --> 00:20:51,389
don't<font color="#CCCCCC"> actually interact with</font><font color="#E5E5E5"> the session</font>

521
00:20:50,490 --> 00:20:58,980
on this one either

522
00:20:51,390 --> 00:21:00,390
but for demo later I do so go<font color="#E5E5E5"> back</font><font color="#CCCCCC"> to</font>

523
00:20:58,980 --> 00:21:03,000
our<font color="#CCCCCC"> presentation we talked about</font>

524
00:21:00,390 --> 00:21:04,440
register 32<font color="#CCCCCC"> we've talked about msbuild</font>

525
00:21:03,000 --> 00:21:06,120
<font color="#CCCCCC">we've got an idea for what an</font>

526
00:21:04,440 --> 00:21:09,830
application<font color="#E5E5E5"> and why it was</font><font color="#CCCCCC"> bypassed is</font>

527
00:21:06,120 --> 00:21:12,270
and some practical applications<font color="#E5E5E5"> of them</font>

528
00:21:09,830 --> 00:21:14,179
but<font color="#E5E5E5"> you know what about these very</font>

529
00:21:12,270 --> 00:21:17,340
<font color="#CCCCCC">targeted</font><font color="#E5E5E5"> attackers in their</font><font color="#CCCCCC"> lifecycle</font>

530
00:21:14,180 --> 00:21:19,320
<font color="#CCCCCC">one of the thing</font><font color="#E5E5E5"> about the target</font>

531
00:21:17,340 --> 00:21:20,730
attacker<font color="#CCCCCC"> lifecycle is</font><font color="#E5E5E5"> that the target</font>

532
00:21:19,320 --> 00:21:23,490
attacker life cycle does not really

533
00:21:20,730 --> 00:21:25,410
<font color="#CCCCCC">change and what</font><font color="#E5E5E5"> I mean by that is like</font>

534
00:21:23,490 --> 00:21:26,970
its initial<font color="#CCCCCC"> compromise its established</font>

535
00:21:25,410 --> 00:21:28,830
foothold<font color="#CCCCCC"> its</font><font color="#E5E5E5"> escalate privileges do</font>

536
00:21:26,970 --> 00:21:30,540
internal recon<font color="#E5E5E5"> move laterally maintain</font>

537
00:21:28,830 --> 00:21:31,949
persistence and then complete<font color="#CCCCCC"> the</font>

538
00:21:30,540 --> 00:21:33,360
mission to steal money or data like

539
00:21:31,950 --> 00:21:35,010
that's generally like what we're talking

540
00:21:33,360 --> 00:21:36,209
<font color="#E5E5E5">about</font><font color="#CCCCCC"> it doesn't really change and</font><font color="#E5E5E5"> I</font>

541
00:21:35,010 --> 00:21:37,680
mean I know there's a lot<font color="#CCCCCC"> of</font><font color="#E5E5E5"> varying</font>

542
00:21:36,210 --> 00:21:39,510
opinions about this sort of thing an

543
00:21:37,680 --> 00:21:41,250
industry with kill chain and the million

544
00:21:39,510 --> 00:21:42,720
<font color="#E5E5E5">other</font><font color="#CCCCCC"> things that are out there</font><font color="#E5E5E5"> however</font>

545
00:21:41,250 --> 00:21:47,910
<font color="#E5E5E5">this is the way that I like to speak to</font>

546
00:21:42,720 --> 00:21:50,520
<font color="#E5E5E5">it</font><font color="#CCCCCC"> so in this</font><font color="#E5E5E5"> scenario</font><font color="#CCCCCC"> you know</font><font color="#E5E5E5"> we have</font>

547
00:21:47,910 --> 00:21:52,350
in a just<font color="#E5E5E5"> kind of a basic attacker and</font>

548
00:21:50,520 --> 00:21:53,250
again you know<font color="#CCCCCC"> like here they're</font><font color="#E5E5E5"> using a</font>

549
00:21:52,350 --> 00:21:55,530
phishing<font color="#CCCCCC"> email</font>

550
00:21:53,250 --> 00:21:57,150
she's a word macro using<font color="#CCCCCC"> visual basic to</font>

551
00:21:55,530 --> 00:21:59,790
download and execute a<font color="#CCCCCC"> backdoor they're</font>

552
00:21:57,150 --> 00:22:01,590
using a run key to<font color="#CCCCCC"> do persistence and</font>

553
00:21:59,790 --> 00:22:03,030
<font color="#E5E5E5">establish a foothold the reason they're</font>

554
00:22:01,590 --> 00:22:05,610
<font color="#E5E5E5">chopping</font><font color="#CCCCCC"> Mimi cats</font><font color="#E5E5E5"> the disk</font>

555
00:22:03,030 --> 00:22:08,070
<font color="#E5E5E5">- maybe escalate privileges</font><font color="#CCCCCC"> they're</font>

556
00:22:05,610 --> 00:22:09,780
using PS exec and they're using the VPN

557
00:22:08,070 --> 00:22:11,100
because they don't<font color="#CCCCCC"> have two</font><font color="#E5E5E5"> factor</font>

558
00:22:09,780 --> 00:22:13,080
authentication on their<font color="#E5E5E5"> VP</font>

559
00:22:11,100 --> 00:22:15,870
and they're using<font color="#E5E5E5"> web shells on their</font>

560
00:22:13,080 --> 00:22:18,539
web servers to maintain<font color="#E5E5E5"> access</font><font color="#CCCCCC"> to the</font>

561
00:22:15,870 --> 00:22:20,219
environment<font color="#E5E5E5"> they're using like some</font>

562
00:22:18,539 --> 00:22:22,740
living<font color="#E5E5E5"> off the land utilities to do</font>

563
00:22:20,220 --> 00:22:24,120
internal recon which is cool<font color="#CCCCCC"> but</font>

564
00:22:22,740 --> 00:22:27,029
<font color="#CCCCCC">eventually you know they steal money</font><font color="#E5E5E5"> or</font>

565
00:22:24,120 --> 00:22:29,668
data<font color="#E5E5E5"> right so if you talk about like</font><font color="#CCCCCC"> the</font>

566
00:22:27,029 --> 00:22:31,409
scenario<font color="#CCCCCC"> of</font><font color="#E5E5E5"> you know what I like to call</font>

567
00:22:29,669 --> 00:22:35,309
an enlightened attacker and I stole that

568
00:22:31,409 --> 00:22:37,620
<font color="#CCCCCC">terminology from</font><font color="#E5E5E5"> Casey Smith as like</font>

569
00:22:35,309 --> 00:22:39,149
they do things slightly different and

570
00:22:37,620 --> 00:22:41,850
you can<font color="#CCCCCC"> already</font><font color="#E5E5E5"> see</font><font color="#CCCCCC"> you know take a</font>

571
00:22:39,149 --> 00:22:43,500
moment to like injustice slide and try

572
00:22:41,850 --> 00:22:45,029
and note for<font color="#CCCCCC"> yourself</font><font color="#E5E5E5"> what is different</font>

573
00:22:43,500 --> 00:22:47,190
I'm gonna highlight them<font color="#CCCCCC"> in a second</font>

574
00:22:45,029 --> 00:22:48,960
here for the stuff<font color="#E5E5E5"> that we're gonna</font>

575
00:22:47,190 --> 00:22:53,370
particularly focus<font color="#E5E5E5"> on in these scenarios</font>

576
00:22:48,960 --> 00:22:56,730
that we<font color="#E5E5E5"> talk through and so the red</font><font color="#CCCCCC"> box</font>

577
00:22:53,370 --> 00:22:58,199
<font color="#CCCCCC">is</font><font color="#E5E5E5"> pretty red box is pretty pictures we</font>

578
00:22:56,730 --> 00:23:01,200
have<font color="#E5E5E5"> on word</font><font color="#CCCCCC"> macro calling</font><font color="#E5E5E5"> register of</font>

579
00:22:58,200 --> 00:23:03,539
<font color="#CCCCCC">32.0 remote URL</font><font color="#E5E5E5"> but the phishing email</font>

580
00:23:01,200 --> 00:23:05,279
they're using a run key with renamed

581
00:23:03,539 --> 00:23:07,529
<font color="#E5E5E5">msbuild</font><font color="#CCCCCC"> to execute their backdoor</font>

582
00:23:05,279 --> 00:23:11,629
they're using<font color="#CCCCCC"> meme</font><font color="#E5E5E5"> cats in memory now</font>

583
00:23:07,529 --> 00:23:15,360
and now they're using<font color="#CCCCCC"> w mayan msbuild</font>

584
00:23:11,629 --> 00:23:17,279
to move laterally<font color="#CCCCCC"> a lot different type</font>

585
00:23:15,360 --> 00:23:19,769
of<font color="#E5E5E5"> scenario here a lot different</font>

586
00:23:17,279 --> 00:23:22,500
techniques again the target attacker<font color="#CCCCCC"> of</font>

587
00:23:19,769 --> 00:23:24,809
life cycle<font color="#CCCCCC"> does not change it is the</font>

588
00:23:22,500 --> 00:23:27,600
<font color="#E5E5E5">techniques that change across the Attar</font>

589
00:23:24,809 --> 00:23:28,799
gated<font color="#CCCCCC"> attacker life</font><font color="#E5E5E5"> cycle so in the</font>

590
00:23:27,600 --> 00:23:30,240
<font color="#E5E5E5">scenario with no application</font>

591
00:23:28,799 --> 00:23:33,000
whitelisting what do we think happens

592
00:23:30,240 --> 00:23:35,480
<font color="#E5E5E5">steal money or data</font><font color="#CCCCCC"> it's pretty simple</font>

593
00:23:33,000 --> 00:23:37,289
<font color="#E5E5E5">like that's that's what's gonna happen</font>

594
00:23:35,480 --> 00:23:38,460
<font color="#CCCCCC">now if you remember back to the</font>

595
00:23:37,289 --> 00:23:41,419
<font color="#E5E5E5">beginning</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the talk we talked about</font>

596
00:23:38,460 --> 00:23:43,679
app app Locker<font color="#E5E5E5"> and</font><font color="#CCCCCC"> it's default rules</font>

597
00:23:41,419 --> 00:23:45,960
<font color="#E5E5E5">let's talk through a scenario where we</font>

598
00:23:43,679 --> 00:23:49,080
have<font color="#CCCCCC"> AppLocker enabled with default</font>

599
00:23:45,960 --> 00:23:52,919
rules well if you remember<font color="#E5E5E5"> you</font><font color="#CCCCCC"> can't</font>

600
00:23:49,080 --> 00:23:54,899
<font color="#E5E5E5">call anything from</font><font color="#CCCCCC"> C Windows as a normal</font>

601
00:23:52,919 --> 00:23:58,470
user and anything in Program<font color="#CCCCCC"> Files is</font>

602
00:23:54,899 --> 00:24:01,469
white listed as well so where would<font color="#E5E5E5"> we</font>

603
00:23:58,470 --> 00:24:04,049
get here ultimately<font color="#E5E5E5"> they're gonna steal</font>

604
00:24:01,470 --> 00:24:06,539
money<font color="#E5E5E5"> or data like that's that's what's</font>

605
00:24:04,049 --> 00:24:08,580
going to happen in the scenario you know

606
00:24:06,539 --> 00:24:11,789
<font color="#E5E5E5">app Walker with default rules isn't</font>

607
00:24:08,580 --> 00:24:13,470
<font color="#CCCCCC">going</font><font color="#E5E5E5"> to stop this however if we talk</font>

608
00:24:11,789 --> 00:24:15,269
through<font color="#CCCCCC"> a scenario where we've done</font><font color="#E5E5E5"> in</font>

609
00:24:13,470 --> 00:24:18,299
<font color="#E5E5E5">proper systems development and determine</font>

610
00:24:15,269 --> 00:24:22,350
the<font color="#E5E5E5"> requirements for our users and I see</font>

611
00:24:18,299 --> 00:24:23,399
some people<font color="#CCCCCC"> smiling at that but you know</font>

612
00:24:22,350 --> 00:24:24,840
let's say we've<font color="#CCCCCC"> done that and</font><font color="#E5E5E5"> we've</font>

613
00:24:23,399 --> 00:24:26,459
really tweaked or tested

614
00:24:24,840 --> 00:24:29,908
the<font color="#CCCCCC"> efficacy of our application</font>

615
00:24:26,460 --> 00:24:32,909
whitelisting<font color="#CCCCCC"> if we've done that</font><font color="#E5E5E5"> and</font>

616
00:24:29,909 --> 00:24:34,770
we're aware and we're you know what<font color="#E5E5E5"> I'm</font>

617
00:24:32,909 --> 00:24:37,980
gonna<font color="#E5E5E5"> call an enlightened defender now</font>

618
00:24:34,770 --> 00:24:41,270
and we know about these<font color="#CCCCCC"> things we're an</font>

619
00:24:37,980 --> 00:24:44,549
apex defender as<font color="#CCCCCC"> Casey likes to put it</font>

620
00:24:41,270 --> 00:24:45,840
you know<font color="#E5E5E5"> it's sure they can execute word</font>

621
00:24:44,549 --> 00:24:49,080
but they're not<font color="#E5E5E5"> gonna be</font><font color="#CCCCCC"> able to</font><font color="#E5E5E5"> call</font>

622
00:24:45,840 --> 00:24:51,330
<font color="#CCCCCC">register 32</font><font color="#E5E5E5"> within word so we stop right</font>

623
00:24:49,080 --> 00:24:55,949
<font color="#E5E5E5">here initial compromise it ends game</font>

624
00:24:51,330 --> 00:24:57,689
<font color="#CCCCCC">over I can't do anything</font><font color="#E5E5E5"> no maybe</font>

625
00:24:55,950 --> 00:24:59,190
there's someone more skilled than<font color="#CCCCCC"> me</font><font color="#E5E5E5"> out</font>

626
00:24:57,690 --> 00:25:00,510
<font color="#CCCCCC">there and</font><font color="#E5E5E5"> they've done research and</font>

627
00:24:59,190 --> 00:25:02,549
maybe they have another<font color="#CCCCCC"> application why</font>

628
00:25:00,510 --> 00:25:04,919
those bypass but the thing I'm trying<font color="#E5E5E5"> to</font>

629
00:25:02,549 --> 00:25:06,658
convey<font color="#CCCCCC"> here is</font><font color="#E5E5E5"> like</font><font color="#CCCCCC"> allocate obligation</font>

630
00:25:04,919 --> 00:25:08,880
whitelisting done right<font color="#E5E5E5"> is the most</font>

631
00:25:06,659 --> 00:25:12,600
<font color="#CCCCCC">effective</font><font color="#E5E5E5"> security control that you</font><font color="#CCCCCC"> can</font>

632
00:25:08,880 --> 00:25:13,950
implement in<font color="#CCCCCC"> my humble opinion I go up</font>

633
00:25:12,600 --> 00:25:15,928
against application whitelisting as well

634
00:25:13,950 --> 00:25:19,520
as<font color="#CCCCCC"> eg our products whole time most of</font>

635
00:25:15,929 --> 00:25:21,840
time in tandem meaning both at once<font color="#E5E5E5"> and</font>

636
00:25:19,520 --> 00:25:23,399
I've been in<font color="#E5E5E5"> one or two scenarios where</font>

637
00:25:21,840 --> 00:25:26,220
application whitelisting was done right

638
00:25:23,399 --> 00:25:28,350
<font color="#E5E5E5">and I was like man I guess I'm like</font>

639
00:25:26,220 --> 00:25:30,570
spending time researching<font color="#E5E5E5"> new</font>

640
00:25:28,350 --> 00:25:35,459
application why those<font color="#E5E5E5"> bypasses this week</font>

641
00:25:30,570 --> 00:25:39,750
because<font color="#E5E5E5"> I don't know what to do so</font>

642
00:25:35,460 --> 00:25:41,100
<font color="#E5E5E5">introducing my tool Great Scott I'll</font>

643
00:25:39,750 --> 00:25:43,649
talk a<font color="#E5E5E5"> little more about like why</font>

644
00:25:41,100 --> 00:25:46,139
exactly<font color="#CCCCCC"> I created this tool</font><font color="#E5E5E5"> in the next</font>

645
00:25:43,649 --> 00:25:48,029
few slides<font color="#CCCCCC"> however it is open</font><font color="#E5E5E5"> source</font><font color="#CCCCCC"> it</font>

646
00:25:46,140 --> 00:25:51,059
<font color="#E5E5E5">is an application whitelist bypass</font>

647
00:25:48,029 --> 00:25:54,840
framework<font color="#E5E5E5"> it's intended</font><font color="#CCCCCC"> for both red and</font>

648
00:25:51,059 --> 00:25:56,100
blue team so like<font color="#E5E5E5"> red team obviously we</font>

649
00:25:54,840 --> 00:25:58,559
can use this for a national access

650
00:25:56,100 --> 00:26:00,330
lateral movement persistence<font color="#CCCCCC"> we can do</font>

651
00:25:58,559 --> 00:26:02,760
it use it in a<font color="#E5E5E5"> lot of different</font><font color="#CCCCCC"> ways</font>

652
00:26:00,330 --> 00:26:04,918
<font color="#E5E5E5">from</font><font color="#CCCCCC"> the blue team perspective let's say</font>

653
00:26:02,760 --> 00:26:07,529
you know you actually have application

654
00:26:04,919 --> 00:26:08,880
whitelisting implement<font color="#E5E5E5"> okay there's not</font>

655
00:26:07,529 --> 00:26:09,480
<font color="#E5E5E5">that many people</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> have application</font>

656
00:26:08,880 --> 00:26:12,149
whitelisting

657
00:26:09,480 --> 00:26:15,539
<font color="#CCCCCC">you would be able</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> test that to see of</font>

658
00:26:12,149 --> 00:26:17,580
your<font color="#E5E5E5"> policy with my tool</font><font color="#CCCCCC"> let's say</font>

659
00:26:15,539 --> 00:26:19,260
you've got<font color="#E5E5E5"> a brand new next-gen AV</font>

660
00:26:17,580 --> 00:26:21,000
product and you know it's<font color="#CCCCCC"> supposed to</font>

661
00:26:19,260 --> 00:26:23,490
solve<font color="#E5E5E5"> all your problems and everything's</font>

662
00:26:21,000 --> 00:26:24,929
going to<font color="#E5E5E5"> be good from then on out you</font>

663
00:26:23,490 --> 00:26:25,860
could use my tool to<font color="#CCCCCC"> demonstrate that</font>

664
00:26:24,929 --> 00:26:30,149
it's not going to<font color="#E5E5E5"> solve all</font><font color="#CCCCCC"> your</font>

665
00:26:25,860 --> 00:26:32,070
problems<font color="#E5E5E5"> and we need to focus on the</font>

666
00:26:30,149 --> 00:26:33,780
basics of doing<font color="#E5E5E5"> proper systems</font>

667
00:26:32,070 --> 00:26:36,510
development<font color="#E5E5E5"> and I like to relate this</font>

668
00:26:33,780 --> 00:26:37,980
back to application security<font color="#CCCCCC"> how like in</font>

669
00:26:36,510 --> 00:26:38,610
web application security<font color="#E5E5E5"> we've advocated</font>

670
00:26:37,980 --> 00:26:42,059
for

671
00:26:38,610 --> 00:26:43,350
many years to<font color="#E5E5E5"> implement the</font><font color="#CCCCCC"> esti uh you</font>

672
00:26:42,059 --> 00:26:45,360
know security into the software

673
00:26:43,350 --> 00:26:47,000
development<font color="#E5E5E5"> lifecycle</font><font color="#CCCCCC"> maybe this has the</font>

674
00:26:45,360 --> 00:26:51,330
same thing like with systems development

675
00:26:47,000 --> 00:26:54,540
<font color="#CCCCCC">if we actually</font><font color="#E5E5E5"> like are capable of being</font>

676
00:26:51,330 --> 00:26:56,460
able to determine all<font color="#CCCCCC"> of the</font>

677
00:26:54,540 --> 00:26:57,840
<font color="#E5E5E5">requirements for</font><font color="#CCCCCC"> our systems and</font><font color="#E5E5E5"> do</font>

678
00:26:56,460 --> 00:26:59,370
proper systems development<font color="#E5E5E5"> we can</font>

679
00:26:57,840 --> 00:27:03,120
<font color="#E5E5E5">implement application whitelisting from</font>

680
00:26:59,370 --> 00:27:05,370
the beginning however<font color="#E5E5E5"> a lot easier said</font>

681
00:27:03,120 --> 00:27:08,010
than done<font color="#CCCCCC"> I don't want anyone to</font><font color="#E5E5E5"> get me</font>

682
00:27:05,370 --> 00:27:09,270
wrong about<font color="#E5E5E5"> that</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> really</font><font color="#CCCCCC"> it's a</font>

683
00:27:08,010 --> 00:27:12,299
framework to dynamically<font color="#E5E5E5"> generate</font>

684
00:27:09,270 --> 00:27:15,090
<font color="#CCCCCC">application whitelist is based on user</font>

685
00:27:12,299 --> 00:27:17,610
input<font color="#CCCCCC"> and so there's no static</font><font color="#E5E5E5"> templates</font>

686
00:27:15,090 --> 00:27:18,870
<font color="#E5E5E5">every single bypass that you generate</font>

687
00:27:17,610 --> 00:27:23,040
within<font color="#E5E5E5"> the framework is going</font><font color="#CCCCCC"> to be</font>

688
00:27:18,870 --> 00:27:24,360
unique<font color="#E5E5E5"> so kind of like the</font><font color="#CCCCCC"> history</font><font color="#E5E5E5"> of</font>

689
00:27:23,040 --> 00:27:26,428
Great Scott I started developing<font color="#CCCCCC"> this</font>

690
00:27:24,360 --> 00:27:30,000
like about like<font color="#CCCCCC"> a</font><font color="#E5E5E5"> year and a half ago</font>

691
00:27:26,429 --> 00:27:32,220
<font color="#CCCCCC">whenever I</font><font color="#E5E5E5"> first joined mandiant and you</font>

692
00:27:30,000 --> 00:27:34,169
know the version<font color="#CCCCCC"> last year</font><font color="#E5E5E5"> there was no</font>

693
00:27:32,220 --> 00:27:35,610
<font color="#E5E5E5">command-line</font><font color="#CCCCCC"> options ooh a static</font>

694
00:27:34,169 --> 00:27:36,840
templates based<font color="#E5E5E5"> on proof of concepts</font>

695
00:27:35,610 --> 00:27:38,459
kind of like you're<font color="#E5E5E5"> seeing in my blog</font>

696
00:27:36,840 --> 00:27:41,309
<font color="#CCCCCC">post that</font><font color="#E5E5E5"> sort of thing was automating</font>

697
00:27:38,460 --> 00:27:43,350
like that process<font color="#CCCCCC"> as flagged as</font>

698
00:27:41,309 --> 00:27:45,178
malicious<font color="#E5E5E5"> by most antivirus under the</font>

699
00:27:43,350 --> 00:27:47,750
Sun so<font color="#CCCCCC"> okay like now I'm running</font><font color="#E5E5E5"> it's</font>

700
00:27:45,179 --> 00:27:50,190
the AV problem what do I do about that

701
00:27:47,750 --> 00:27:51,990
<font color="#E5E5E5">one of the legs up it did have on the</font>

702
00:27:50,190 --> 00:27:53,130
new version<font color="#CCCCCC"> but</font><font color="#E5E5E5"> this feature is planned</font>

703
00:27:51,990 --> 00:27:54,929
<font color="#E5E5E5">for the new version</font><font color="#CCCCCC"> is that</font><font color="#E5E5E5"> how to</font>

704
00:27:53,130 --> 00:27:57,980
generate all function for blue teamers

705
00:27:54,929 --> 00:28:00,929
where it also generates<font color="#E5E5E5"> a CSV file and</font>

706
00:27:57,980 --> 00:28:03,510
automatically<font color="#E5E5E5"> track through</font><font color="#CCCCCC"> Metasploit a</font>

707
00:28:00,929 --> 00:28:06,450
<font color="#CCCCCC">Metasploit resource file that ran every</font>

708
00:28:03,510 --> 00:28:08,309
time a session<font color="#E5E5E5"> came in and where to give</font>

709
00:28:06,450 --> 00:28:10,950
you<font color="#CCCCCC"> a CSV that</font><font color="#E5E5E5"> tells you like what</font>

710
00:28:08,309 --> 00:28:12,780
<font color="#E5E5E5">bypass has worked and what didn't</font><font color="#CCCCCC"> so</font>

711
00:28:10,950 --> 00:28:15,870
there is a feature plan for that<font color="#E5E5E5"> in the</font>

712
00:28:12,780 --> 00:28:17,399
<font color="#CCCCCC">future</font><font color="#E5E5E5"> in the new version</font><font color="#CCCCCC"> however</font><font color="#E5E5E5"> I have</font>

713
00:28:15,870 --> 00:28:18,780
some<font color="#CCCCCC"> logic problems to solve</font><font color="#E5E5E5"> and it's</font>

714
00:28:17,400 --> 00:28:22,860
not implemented<font color="#E5E5E5"> into the new framework</font>

715
00:28:18,780 --> 00:28:25,379
<font color="#CCCCCC">so in the new Great Scott they're robust</font>

716
00:28:22,860 --> 00:28:28,168
<font color="#E5E5E5">command-line options again like it's</font>

717
00:28:25,380 --> 00:28:31,740
dynamic generation no proof<font color="#E5E5E5"> of concepts</font>

718
00:28:28,169 --> 00:28:33,750
at all<font color="#CCCCCC"> it does</font><font color="#E5E5E5"> basic variable renaming</font>

719
00:28:31,740 --> 00:28:36,960
obfuscation so let's say you know yeah

720
00:28:33,750 --> 00:28:42,090
shellcode equals<font color="#E5E5E5"> blah</font><font color="#CCCCCC"> that would turn</font>

721
00:28:36,960 --> 00:28:44,190
into random letters equals blah and<font color="#CCCCCC"> so</font>

722
00:28:42,090 --> 00:28:45,809
<font color="#CCCCCC">there</font><font color="#E5E5E5"> are some</font><font color="#CCCCCC"> sand doc</font><font color="#E5E5E5"> the sandbox</font>

723
00:28:44,190 --> 00:28:47,370
detection features really<font color="#CCCCCC"> I should</font>

724
00:28:45,809 --> 00:28:49,790
probably change<font color="#E5E5E5"> the slide to sandbox</font>

725
00:28:47,370 --> 00:28:52,409
<font color="#CCCCCC">evasion rather than sandbox detection</font>

726
00:28:49,790 --> 00:28:54,510
and then there's a

727
00:28:52,410 --> 00:28:56,160
<font color="#CCCCCC">so we'll check</font><font color="#E5E5E5"> so you know like it's</font>

728
00:28:54,510 --> 00:28:57,810
never been<font color="#CCCCCC"> on virustotal and it's a</font>

729
00:28:56,160 --> 00:29:00,600
unique<font color="#E5E5E5"> hash and it's never been seen</font>

730
00:28:57,810 --> 00:29:01,710
before<font color="#CCCCCC"> and is powered by Vail how many</font>

731
00:29:00,600 --> 00:29:03,750
people are familiar with<font color="#E5E5E5"> the Vail</font>

732
00:29:01,710 --> 00:29:07,940
framework written<font color="#E5E5E5"> by Chris</font><font color="#CCCCCC"> truster and</font>

733
00:29:03,750 --> 00:29:12,330
<font color="#E5E5E5">will Schroeder</font><font color="#CCCCCC"> so there</font><font color="#E5E5E5"> was some hands</font>

734
00:29:07,940 --> 00:29:15,060
so Vail is<font color="#E5E5E5"> really an</font><font color="#CCCCCC"> antivirus</font><font color="#E5E5E5"> bypass</font>

735
00:29:12,330 --> 00:29:17,250
framework<font color="#E5E5E5"> and so I ran into the AV</font>

736
00:29:15,060 --> 00:29:19,950
problem right like well do I<font color="#E5E5E5"> really want</font>

737
00:29:17,250 --> 00:29:23,340
<font color="#E5E5E5">to reinvent</font><font color="#CCCCCC"> the wheel</font><font color="#E5E5E5"> and handle that</font>

738
00:29:19,950 --> 00:29:24,660
<font color="#CCCCCC">problem yet</font><font color="#E5E5E5"> again</font><font color="#CCCCCC"> and write in</font><font color="#E5E5E5"> the tool</font>

739
00:29:23,340 --> 00:29:27,600
when there's already plenty of tools

740
00:29:24,660 --> 00:29:31,020
that solve this problem<font color="#CCCCCC"> No so the story</font>

741
00:29:27,600 --> 00:29:33,000
behind this is<font color="#E5E5E5"> I was on sites in the</font>

742
00:29:31,020 --> 00:29:35,129
Seattle area with Trent sir for an

743
00:29:33,000 --> 00:29:37,020
internal<font color="#E5E5E5"> pen test and him and I were</font>

744
00:29:35,130 --> 00:29:38,730
<font color="#CCCCCC">hanging out after hours every night</font><font color="#E5E5E5"> we</font>

745
00:29:37,020 --> 00:29:40,320
were grabbing a drink<font color="#CCCCCC"> at the bar and</font><font color="#E5E5E5"> I</font>

746
00:29:38,730 --> 00:29:42,390
<font color="#E5E5E5">was showing him you know the old Great</font>

747
00:29:40,320 --> 00:29:44,250
<font color="#E5E5E5">Scott yeah man I've got like all this</font>

748
00:29:42,390 --> 00:29:48,780
great<font color="#CCCCCC"> stuff for it and all these these</font>

749
00:29:44,250 --> 00:29:51,840
<font color="#E5E5E5">great ideas</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> he was like I think you</font>

750
00:29:48,780 --> 00:29:55,740
should rewrite the entire tool<font color="#CCCCCC"> I don't</font>

751
00:29:51,840 --> 00:29:57,659
like come<font color="#CCCCCC"> on and</font><font color="#E5E5E5"> are you kidding me like</font>

752
00:29:55,740 --> 00:30:00,420
let me write the<font color="#CCCCCC"> entire thing like and</font>

753
00:29:57,660 --> 00:30:03,000
so the reasoning behind this is<font color="#CCCCCC"> you know</font>

754
00:30:00,420 --> 00:30:04,230
will<font color="#CCCCCC"> Schroder</font><font color="#E5E5E5"> or harm</font><font color="#CCCCCC"> joy was the person</font>

755
00:30:03,000 --> 00:30:06,510
that<font color="#CCCCCC"> originally wrote the</font><font color="#E5E5E5"> framework</font>

756
00:30:04,230 --> 00:30:08,880
portion for Vail<font color="#CCCCCC"> and in Vail</font><font color="#E5E5E5"> 3.0</font>

757
00:30:06,510 --> 00:30:11,580
<font color="#CCCCCC">trunkster rewrote the entire</font><font color="#E5E5E5"> framework</font>

758
00:30:08,880 --> 00:30:13,230
<font color="#E5E5E5">so he understood it and what was going</font>

759
00:30:11,580 --> 00:30:15,480
<font color="#E5E5E5">on because he</font><font color="#CCCCCC"> was monkey-patching his</font>

760
00:30:13,230 --> 00:30:17,340
code all the<font color="#E5E5E5"> time</font><font color="#CCCCCC"> I experienced the same</font>

761
00:30:15,480 --> 00:30:18,840
<font color="#CCCCCC">thing with a former co-worker of mine he</font>

762
00:30:17,340 --> 00:30:20,250
used to work on<font color="#E5E5E5"> this project with</font><font color="#CCCCCC"> me but</font>

763
00:30:18,840 --> 00:30:21,870
he left<font color="#E5E5E5"> the company since then and</font>

764
00:30:20,250 --> 00:30:25,800
didn't side to<font color="#CCCCCC"> continue in the</font>

765
00:30:21,870 --> 00:30:27,300
<font color="#E5E5E5">open-source arena so</font><font color="#CCCCCC"> I was</font><font color="#E5E5E5"> alone and I</font>

766
00:30:25,800 --> 00:30:30,419
was mucking<font color="#E5E5E5"> patched monkey-patching</font>

767
00:30:27,300 --> 00:30:31,409
<font color="#CCCCCC">Marcuse's code all the time</font><font color="#E5E5E5"> and I was</font>

768
00:30:30,420 --> 00:30:33,630
<font color="#CCCCCC">like</font><font color="#E5E5E5"> I don't</font><font color="#CCCCCC"> even</font><font color="#E5E5E5"> know how I'm gonna</font>

769
00:30:31,410 --> 00:30:35,730
solve<font color="#E5E5E5"> this next logic problem things are</font>

770
00:30:33,630 --> 00:30:37,710
so convoluted I don't understand it

771
00:30:35,730 --> 00:30:40,770
there are<font color="#CCCCCC"> comments in</font><font color="#E5E5E5"> his code that says</font>

772
00:30:37,710 --> 00:30:42,360
like<font color="#E5E5E5"> this is intentionally obfuscated</font>

773
00:30:40,770 --> 00:30:45,810
for intellectual<font color="#CCCCCC"> property rights</font><font color="#E5E5E5"> no</font>

774
00:30:42,360 --> 00:30:47,459
<font color="#E5E5E5">really</font><font color="#CCCCCC"> like why</font><font color="#E5E5E5"> are you laughing so</font>

775
00:30:45,810 --> 00:30:50,210
there<font color="#CCCCCC"> wasn't</font><font color="#E5E5E5"> much comments in the</font>

776
00:30:47,460 --> 00:30:52,920
framework portion so I decided<font color="#E5E5E5"> okay</font>

777
00:30:50,210 --> 00:30:55,220
<font color="#E5E5E5">maybe I maybe you're right transfer like</font>

778
00:30:52,920 --> 00:30:57,330
I should rewrite the entire<font color="#E5E5E5"> thing</font><font color="#CCCCCC"> and</font>

779
00:30:55,220 --> 00:31:00,150
<font color="#CCCCCC">he's like well why don't</font><font color="#E5E5E5"> you use like</font>

780
00:30:57,330 --> 00:31:03,590
<font color="#CCCCCC">Veils framework portion and</font><font color="#E5E5E5"> so he</font>

781
00:31:00,150 --> 00:31:05,410
started explaining to me<font color="#E5E5E5"> how there's the</font>

782
00:31:03,590 --> 00:31:07,179
conductor<font color="#E5E5E5"> that can</font>

783
00:31:05,410 --> 00:31:09,420
<font color="#CCCCCC">it's the orchestra within his framework</font>

784
00:31:07,180 --> 00:31:11,740
<font color="#E5E5E5">and</font><font color="#CCCCCC"> how he wrote in how it was</font><font color="#E5E5E5"> designed</font>

785
00:31:09,420 --> 00:31:12,070
<font color="#CCCCCC">and</font><font color="#E5E5E5"> I was like yeah that</font><font color="#CCCCCC"> actually makes</font>

786
00:31:11,740 --> 00:31:14,290
sense

787
00:31:12,070 --> 00:31:15,280
it's kind of corny<font color="#CCCCCC"> and I'm gonna</font><font color="#E5E5E5"> make</font>

788
00:31:14,290 --> 00:31:20,560
fun<font color="#E5E5E5"> of you for it</font>

789
00:31:15,280 --> 00:31:22,360
but it doesn't<font color="#E5E5E5"> make sense</font><font color="#CCCCCC"> it's really</font>

790
00:31:20,560 --> 00:31:23,919
again it's based on<font color="#CCCCCC"> vales project</font>

791
00:31:22,360 --> 00:31:26,020
framework<font color="#E5E5E5"> I essentially forked</font><font color="#CCCCCC"> bail</font>

792
00:31:23,920 --> 00:31:29,320
stripped it down<font color="#CCCCCC"> modified it took out</font>

793
00:31:26,020 --> 00:31:30,850
what I didn't<font color="#E5E5E5"> need and add it in some of</font>

794
00:31:29,320 --> 00:31:32,980
the unique<font color="#CCCCCC"> features that it had like</font>

795
00:31:30,850 --> 00:31:34,740
sandbox detection checking the bypass of

796
00:31:32,980 --> 00:31:38,110
<font color="#CCCCCC">the hash on virustotal</font>

797
00:31:34,740 --> 00:31:41,560
and again dynamic generation who's tired

798
00:31:38,110 --> 00:31:43,419
of hearing me say dynamic generation<font color="#E5E5E5"> so</font>

799
00:31:41,560 --> 00:31:45,129
you can<font color="#E5E5E5"> select things like your method</font>

800
00:31:43,420 --> 00:31:47,920
of<font color="#E5E5E5"> shellcode injection</font><font color="#CCCCCC"> you know virtual</font>

801
00:31:45,130 --> 00:31:49,780
<font color="#E5E5E5">a</font><font color="#CCCCCC"> locker heap you know everything is</font>

802
00:31:47,920 --> 00:31:51,670
dynamically<font color="#CCCCCC"> generated based on</font><font color="#E5E5E5"> user</font>

803
00:31:49,780 --> 00:31:53,200
input<font color="#CCCCCC"> what input you give it is what</font>

804
00:31:51,670 --> 00:31:55,360
you're going to get out<font color="#E5E5E5"> of the framework</font>

805
00:31:53,200 --> 00:31:57,550
and<font color="#E5E5E5"> that's something important to</font>

806
00:31:55,360 --> 00:32:01,149
understand there<font color="#CCCCCC"> are custom meterpreter</font>

807
00:31:57,550 --> 00:32:03,010
stagers<font color="#CCCCCC"> they're unmanaged powershell</font>

808
00:32:01,150 --> 00:32:04,330
payloads so like<font color="#E5E5E5"> I'm not sure if</font>

809
00:32:03,010 --> 00:32:06,250
<font color="#E5E5E5">everyone in the room knows this but</font>

810
00:32:04,330 --> 00:32:08,409
PowerShell<font color="#E5E5E5"> dot exe</font><font color="#CCCCCC"> is not actually</font>

811
00:32:06,250 --> 00:32:13,360
PowerShell it is system that management

812
00:32:08,410 --> 00:32:16,810
<font color="#E5E5E5">automation DLL</font><font color="#CCCCCC"> so one of</font><font color="#E5E5E5"> the things that</font>

813
00:32:13,360 --> 00:32:18,729
I did<font color="#E5E5E5"> another person at Mannion</font><font color="#CCCCCC"> or fire</font>

814
00:32:16,810 --> 00:32:21,460
I by the name<font color="#CCCCCC"> of Daniel Bohannon wrote a</font>

815
00:32:18,730 --> 00:32:24,010
power shell of<font color="#E5E5E5"> the obfuscation</font><font color="#CCCCCC"> tool</font>

816
00:32:21,460 --> 00:32:27,130
called invoke obfuscation<font color="#CCCCCC"> one of the</font>

817
00:32:24,010 --> 00:32:29,050
things that I did was take this and do a

818
00:32:27,130 --> 00:32:31,930
couple<font color="#E5E5E5"> ports to Python for ASCII</font><font color="#CCCCCC"> and</font>

819
00:32:29,050 --> 00:32:34,360
<font color="#E5E5E5">binary encoding</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> ASCII encoding is</font>

820
00:32:31,930 --> 00:32:37,030
actually implemented in<font color="#CCCCCC"> bike leader or</font>

821
00:32:34,360 --> 00:32:38,409
Marcel's tool called crack map exec so

822
00:32:37,030 --> 00:32:40,210
if you ever use crack map exec and<font color="#E5E5E5"> a</font>

823
00:32:38,410 --> 00:32:43,990
<font color="#E5E5E5">PowerShell payload in there what's in</font>

824
00:32:40,210 --> 00:32:45,790
like the<font color="#E5E5E5"> past year</font><font color="#CCCCCC"> you're utilizing my</font>

825
00:32:43,990 --> 00:32:48,040
port of Daniel<font color="#CCCCCC"> whoa</font><font color="#E5E5E5"> hands and</font><font color="#CCCCCC"> Volkov</font>

826
00:32:45,790 --> 00:32:50,470
<font color="#CCCCCC">Association ASCII encoding</font><font color="#E5E5E5"> one of the</font>

827
00:32:48,040 --> 00:32:54,070
other<font color="#E5E5E5"> unique features about Great Scott</font>

828
00:32:50,470 --> 00:32:55,780
in particular is I so who's familiar

829
00:32:54,070 --> 00:32:57,280
with James for<font color="#E5E5E5"> shells dotnet</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> jscript</font>

830
00:32:55,780 --> 00:33:00,850
let's like get some hands<font color="#CCCCCC"> alright</font>

831
00:32:57,280 --> 00:33:03,580
<font color="#E5E5E5">there's like one hand or two hands</font><font color="#CCCCCC"> so so</font>

832
00:33:00,850 --> 00:33:05,560
this was like<font color="#E5E5E5"> the number one piece of</font>

833
00:33:03,580 --> 00:33:07,810
tradecraft that came of Red Team

834
00:33:05,560 --> 00:33:11,050
tradecraft that came out last year<font color="#CCCCCC"> in my</font>

835
00:33:07,810 --> 00:33:14,350
humble<font color="#E5E5E5"> opinion and so James</font><font color="#CCCCCC"> Warshaw he's</font>

836
00:33:11,050 --> 00:33:17,139
worked for Google project<font color="#E5E5E5"> zero</font><font color="#CCCCCC"> Don nets</font>

837
00:33:14,350 --> 00:33:19,270
<font color="#CCCCCC">and jscript is essentially you feed a</font>

838
00:33:17,140 --> 00:33:20,680
c-sharp<font color="#E5E5E5"> assembly into</font><font color="#CCCCCC"> Dean</font>

839
00:33:19,270 --> 00:33:22,510
<font color="#CCCCCC">that's a jscript so like what's in</font>

840
00:33:20,680 --> 00:33:24,190
assembly<font color="#E5E5E5"> that's a deal or an executable</font>

841
00:33:22,510 --> 00:33:26,050
in our case we're almost<font color="#E5E5E5"> always going to</font>

842
00:33:24,190 --> 00:33:27,940
compile it to a<font color="#CCCCCC"> DLL or a dynamic link</font>

843
00:33:26,050 --> 00:33:31,000
library<font color="#CCCCCC"> and then we're gonna feed that</font>

844
00:33:27,940 --> 00:33:35,140
<font color="#E5E5E5">into dotnet to jscript</font><font color="#CCCCCC"> exe and</font><font color="#E5E5E5"> then it</font>

845
00:33:31,000 --> 00:33:37,540
is going<font color="#E5E5E5"> to generate a snippet of</font><font color="#CCCCCC"> code</font>

846
00:33:35,140 --> 00:33:40,570
<font color="#E5E5E5">from a</font><font color="#CCCCCC"> wisk windows script host language</font>

847
00:33:37,540 --> 00:33:42,370
that we specify<font color="#E5E5E5"> hence the name net to</font>

848
00:33:40,570 --> 00:33:44,379
<font color="#E5E5E5">jscript</font><font color="#CCCCCC"> is jscript as a windows script</font>

849
00:33:42,370 --> 00:33:45,969
host language so you<font color="#E5E5E5"> can also do VB</font>

850
00:33:44,380 --> 00:33:48,160
script in some other stuff<font color="#CCCCCC"> and elect</font>

851
00:33:45,970 --> 00:33:51,340
generate macros for you and things of

852
00:33:48,160 --> 00:33:53,050
<font color="#CCCCCC">that nature</font><font color="#E5E5E5"> however the important thing</font>

853
00:33:51,340 --> 00:33:54,189
<font color="#E5E5E5">to note here is that whenever it</font>

854
00:33:53,050 --> 00:33:56,770
generates<font color="#E5E5E5"> this code for you it's</font>

855
00:33:54,190 --> 00:33:59,260
generating<font color="#E5E5E5"> you a VB script or</font><font color="#CCCCCC"> J scripts</font>

856
00:33:56,770 --> 00:34:02,110
snippet<font color="#E5E5E5"> that</font><font color="#CCCCCC"> dammit dynamically loads</font>

857
00:33:59,260 --> 00:34:03,670
<font color="#CCCCCC">the sim assembly into memory and execute</font>

858
00:34:02,110 --> 00:34:07,899
whatever function<font color="#CCCCCC"> you want</font><font color="#E5E5E5"> because I</font>

859
00:34:03,670 --> 00:34:10,810
exposed it so I got all that working<font color="#E5E5E5"> via</font>

860
00:34:07,900 --> 00:34:12,159
wine and as I was corrected at Rocky

861
00:34:10,810 --> 00:34:15,070
Mountain<font color="#CCCCCC"> Information Security Conference</font>

862
00:34:12,159 --> 00:34:17,230
<font color="#CCCCCC">wine is not</font><font color="#E5E5E5"> an emulator so I'm not gonna</font>

863
00:34:15,070 --> 00:34:19,890
say it's an emulator this time<font color="#E5E5E5"> but I got</font>

864
00:34:17,230 --> 00:34:19,889
it<font color="#CCCCCC"> working in wine</font>

865
00:34:19,929 --> 00:34:24,159
so again dynamic generation if<font color="#E5E5E5"> you</font>

866
00:34:22,600 --> 00:34:26,440
wanted to like start using my framework

867
00:34:24,159 --> 00:34:30,280
<font color="#E5E5E5">now you would type dot slash Great Scott</font>

868
00:34:26,440 --> 00:34:32,409
<font color="#E5E5E5">and he would type used</font><font color="#CCCCCC"> bypass</font><font color="#E5E5E5"> and then</font>

869
00:34:30,280 --> 00:34:34,419
go type list to see<font color="#CCCCCC"> all the payloads</font><font color="#E5E5E5"> and</font>

870
00:34:32,409 --> 00:34:36,730
in this case we're saying we<font color="#CCCCCC"> want to</font><font color="#E5E5E5"> use</font>

871
00:34:34,418 --> 00:34:37,719
the<font color="#CCCCCC"> MS build unmanaged powershell</font><font color="#E5E5E5"> scale</font>

872
00:34:36,730 --> 00:34:39,909
<font color="#E5E5E5">ode where we're gonna feed it a</font>

873
00:34:37,719 --> 00:34:42,040
<font color="#CCCCCC">powershell script that we could apply</font>

874
00:34:39,909 --> 00:34:45,490
<font color="#E5E5E5">invoke obfuscation to if we wanted</font><font color="#CCCCCC"> to</font>

875
00:34:42,040 --> 00:34:46,810
ask<font color="#E5E5E5"> you your</font><font color="#CCCCCC"> binary encoding</font><font color="#E5E5E5"> and so</font>

876
00:34:45,489 --> 00:34:49,239
there's all these different<font color="#CCCCCC"> options that</font>

877
00:34:46,810 --> 00:34:51,730
<font color="#E5E5E5">you</font><font color="#CCCCCC"> can set</font><font color="#E5E5E5"> and eventually you know the</font>

878
00:34:49,239 --> 00:34:55,120
payload will be written<font color="#E5E5E5"> out and you can</font>

879
00:34:51,730 --> 00:34:56,290
do your thing<font color="#E5E5E5"> with it</font><font color="#CCCCCC"> so one of</font><font color="#E5E5E5"> the</font>

880
00:34:55,120 --> 00:34:58,870
things I<font color="#E5E5E5"> really want to highlight here</font>

881
00:34:56,290 --> 00:35:00,850
<font color="#CCCCCC">is like the basic random variable</font>

882
00:34:58,870 --> 00:35:04,779
renaming obfuscation<font color="#CCCCCC"> so every box in</font>

883
00:35:00,850 --> 00:35:06,040
blue is basic renaming of<font color="#E5E5E5"> variables you</font>

884
00:35:04,780 --> 00:35:07,810
know<font color="#E5E5E5"> we're</font><font color="#CCCCCC"> just changing</font><font color="#E5E5E5"> the name so</font>

885
00:35:06,040 --> 00:35:09,750
it's hard<font color="#E5E5E5"> to understand what's</font><font color="#CCCCCC"> going</font><font color="#E5E5E5"> on</font>

886
00:35:07,810 --> 00:35:12,610
<font color="#CCCCCC">and the event</font><font color="#E5E5E5"> that we did get caught</font>

887
00:35:09,750 --> 00:35:14,950
<font color="#CCCCCC">where someone was</font><font color="#E5E5E5"> trying to reverse our</font>

888
00:35:12,610 --> 00:35:17,110
stuff<font color="#E5E5E5"> in the case of M has build you</font>

889
00:35:14,950 --> 00:35:19,569
know the C sharp is all in the clear

890
00:35:17,110 --> 00:35:21,220
<font color="#E5E5E5">that's not like it gets compiled because</font>

891
00:35:19,570 --> 00:35:23,200
all that happens in memory so you know

892
00:35:21,220 --> 00:35:26,950
you're gonna<font color="#E5E5E5"> have your XML fire or CS</font>

893
00:35:23,200 --> 00:35:29,169
<font color="#E5E5E5">proj file on disk</font><font color="#CCCCCC"> so you know if they</font>

894
00:35:26,950 --> 00:35:31,810
<font color="#E5E5E5">find that they find it and they</font><font color="#CCCCCC"> have</font>

895
00:35:29,170 --> 00:35:32,960
your code<font color="#E5E5E5"> however at least my code looks</font>

896
00:35:31,810 --> 00:35:35,299
like<font color="#CCCCCC"> gibble guy really</font>

897
00:35:32,960 --> 00:35:36,710
but you know with like<font color="#CCCCCC"> advanced reverse</font>

898
00:35:35,300 --> 00:35:38,330
engineers they're gonna recognize what

899
00:35:36,710 --> 00:35:40,640
this<font color="#E5E5E5"> is right away</font>

900
00:35:38,330 --> 00:35:42,560
so line 26<font color="#E5E5E5"> is king of payload</font><font color="#CCCCCC"> to of</font>

901
00:35:40,640 --> 00:35:44,210
doing a Windows domain in this<font color="#CCCCCC"> case we</font>

902
00:35:42,560 --> 00:35:46,130
made our misc<font color="#CCCCCC"> so here's only these</font>

903
00:35:44,210 --> 00:35:48,520
slides<font color="#CCCCCC"> words buying designed for Rocky</font>

904
00:35:46,130 --> 00:35:51,589
Mountain<font color="#CCCCCC"> Information Security Conference</font>

905
00:35:48,520 --> 00:35:53,480
<font color="#E5E5E5">so like why did I create this like this</font>

906
00:35:51,589 --> 00:35:56,140
seems<font color="#E5E5E5"> like a</font><font color="#CCCCCC"> Red Team tool like are you</font>

907
00:35:53,480 --> 00:35:58,760
really talking this as a<font color="#E5E5E5"> blue team tool</font>

908
00:35:56,140 --> 00:36:02,150
no<font color="#E5E5E5"> I'm talking in his</font><font color="#CCCCCC"> book</font><font color="#E5E5E5"> I get it is</font>

909
00:35:58,760 --> 00:36:04,520
both and I firmly<font color="#E5E5E5"> believe that so the</font>

910
00:36:02,150 --> 00:36:07,160
reason why I wrote this is because<font color="#E5E5E5"> like</font>

911
00:36:04,520 --> 00:36:10,009
there was no way to test the efficacy of

912
00:36:07,160 --> 00:36:11,779
an application whitelisting<font color="#CCCCCC"> like there's</font>

913
00:36:10,010 --> 00:36:13,130
no good answer<font color="#CCCCCC"> I could</font><font color="#E5E5E5"> give to a</font><font color="#CCCCCC"> client</font>

914
00:36:11,780 --> 00:36:15,380
that<font color="#E5E5E5"> would ask me you know we'd use an</font>

915
00:36:13,130 --> 00:36:16,640
application why it was<font color="#E5E5E5"> bypass from KC or</font>

916
00:36:15,380 --> 00:36:18,470
whoever it may<font color="#CCCCCC"> be and they'd be like you</font>

917
00:36:16,640 --> 00:36:22,420
know<font color="#E5E5E5"> like how could I test this myself</font>

918
00:36:18,470 --> 00:36:24,348
and I'm like<font color="#E5E5E5"> I don't know keep hiring us</font>

919
00:36:22,420 --> 00:36:29,690
and I don't<font color="#CCCCCC"> think it's a</font><font color="#E5E5E5"> very good</font>

920
00:36:24,349 --> 00:36:31,280
answer<font color="#CCCCCC"> so you know I really</font><font color="#E5E5E5"> wrote it</font><font color="#CCCCCC"> to</font>

921
00:36:29,690 --> 00:36:35,359
like test application<font color="#CCCCCC"> Wireless policy</font>

922
00:36:31,280 --> 00:36:36,800
pitfalls<font color="#E5E5E5"> and so you know number one like</font>

923
00:36:35,359 --> 00:36:38,810
we talked<font color="#E5E5E5"> about early in the talk with</font>

924
00:36:36,800 --> 00:36:40,940
the app<font color="#E5E5E5"> Locker default rules inherently</font>

925
00:36:38,810 --> 00:36:42,830
<font color="#E5E5E5">trust every default binary on the</font>

926
00:36:40,940 --> 00:36:44,839
operating<font color="#E5E5E5"> system</font><font color="#CCCCCC"> so anything</font><font color="#E5E5E5"> Microsoft</font>

927
00:36:42,830 --> 00:36:46,880
<font color="#CCCCCC">signed</font><font color="#E5E5E5"> we're gonna trust that it's good</font>

928
00:36:44,839 --> 00:36:49,009
<font color="#E5E5E5">you know Microsoft knows what they're</font>

929
00:36:46,880 --> 00:36:52,910
<font color="#CCCCCC">doing and there's no</font><font color="#E5E5E5"> way</font><font color="#CCCCCC"> you know you</font>

930
00:36:49,010 --> 00:36:54,320
could use any of their software<font color="#E5E5E5"> and</font><font color="#CCCCCC"> you</font>

931
00:36:52,910 --> 00:36:56,089
know how does your<font color="#CCCCCC"> solution of whitelist</font>

932
00:36:54,320 --> 00:36:58,339
<font color="#CCCCCC">right</font><font color="#E5E5E5"> like it's doing it by hash this is</font>

933
00:36:56,089 --> 00:37:00,980
doing by<font color="#CCCCCC"> filename is doing by directory</font>

934
00:36:58,339 --> 00:37:04,220
name<font color="#E5E5E5"> we saw a lot of directory name and</font>

935
00:37:00,980 --> 00:37:06,740
the app Locker default rules<font color="#CCCCCC"> is it doing</font>

936
00:37:04,220 --> 00:37:08,689
it by<font color="#E5E5E5"> packed executable info or metadata</font>

937
00:37:06,740 --> 00:37:13,098
is it doing it by a code signing

938
00:37:08,690 --> 00:37:14,750
certificate and so one of the<font color="#CCCCCC"> other air</font>

939
00:37:13,099 --> 00:37:16,339
like pitfalls I've always seen is like

940
00:37:14,750 --> 00:37:17,599
<font color="#E5E5E5">nodding like</font><font color="#CCCCCC"> I've</font><font color="#E5E5E5"> heart on this</font>

941
00:37:16,339 --> 00:37:20,660
<font color="#CCCCCC">sometimes I guess it's like</font><font color="#E5E5E5"> not</font>

942
00:37:17,599 --> 00:37:23,599
including this sort of<font color="#E5E5E5"> application</font>

943
00:37:20,660 --> 00:37:26,779
whitelisting development process<font color="#E5E5E5"> in the</font>

944
00:37:23,599 --> 00:37:30,170
systems development<font color="#E5E5E5"> process</font><font color="#CCCCCC"> it goes back</font>

945
00:37:26,780 --> 00:37:31,760
to<font color="#E5E5E5"> my</font><font color="#CCCCCC"> example</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> like with application</font>

946
00:37:30,170 --> 00:37:33,230
security and implementing that<font color="#E5E5E5"> into the</font>

947
00:37:31,760 --> 00:37:34,550
<font color="#E5E5E5">software development lifecycle I'm</font>

948
00:37:33,230 --> 00:37:35,960
really like saying<font color="#E5E5E5"> the same thing of</font>

949
00:37:34,550 --> 00:37:38,810
like we need<font color="#E5E5E5"> to think about security</font>

950
00:37:35,960 --> 00:37:39,680
<font color="#CCCCCC">from the</font><font color="#E5E5E5"> start and again it is much</font>

951
00:37:38,810 --> 00:37:41,810
easier<font color="#CCCCCC"> said than done</font>

952
00:37:39,680 --> 00:37:45,919
implementing application<font color="#E5E5E5"> whitelisting is</font>

953
00:37:41,810 --> 00:37:46,850
extremely difficult<font color="#E5E5E5"> so a lot of times we</font>

954
00:37:45,920 --> 00:37:49,040
see exceptions for

955
00:37:46,850 --> 00:37:50,390
developers or executives<font color="#E5E5E5"> without</font>

956
00:37:49,040 --> 00:37:51,830
actually determining what the

957
00:37:50,390 --> 00:37:54,020
requirements are<font color="#CCCCCC"> for their system</font><font color="#E5E5E5"> like</font>

958
00:37:51,830 --> 00:37:57,730
what<font color="#E5E5E5"> do they actually need</font><font color="#CCCCCC"> to use on</font>

959
00:37:54,020 --> 00:37:59,960
their system<font color="#E5E5E5"> to get their job done</font>

960
00:37:57,730 --> 00:38:02,300
so there's a lot there there<font color="#E5E5E5"> are some</font>

961
00:37:59,960 --> 00:38:03,800
<font color="#E5E5E5">issues with</font><font color="#CCCCCC"> that but however again</font>

962
00:38:02,300 --> 00:38:05,720
application whitelisting is the most

963
00:38:03,800 --> 00:38:08,410
<font color="#CCCCCC">affects effective</font><font color="#E5E5E5"> security control you</font>

964
00:38:05,720 --> 00:38:12,529
can implement<font color="#E5E5E5"> if you do it right</font>

965
00:38:08,410 --> 00:38:17,569
so now after<font color="#CCCCCC"> I've rambled on for</font><font color="#E5E5E5"> so long</font>

966
00:38:12,530 --> 00:38:19,700
<font color="#CCCCCC">I'll actually show you my tool so this</font>

967
00:38:17,570 --> 00:38:21,830
particular bypass is called<font color="#E5E5E5"> reg</font><font color="#CCCCCC"> Azzam</font>

968
00:38:19,700 --> 00:38:26,600
and it really just<font color="#E5E5E5"> stands for register</font>

969
00:38:21,830 --> 00:38:28,810
<font color="#E5E5E5">assembly</font><font color="#CCCCCC"> and as we saw previously you</font>

970
00:38:26,600 --> 00:38:32,210
can typically either<font color="#E5E5E5"> register or</font>

971
00:38:28,810 --> 00:38:34,880
unregister something so this is a tool

972
00:38:32,210 --> 00:38:38,030
we type dot slash great<font color="#E5E5E5"> shot and again</font>

973
00:38:34,880 --> 00:38:39,290
<font color="#E5E5E5">we type use bypass good type list</font><font color="#CCCCCC"> this</font>

974
00:38:38,030 --> 00:38:40,820
<font color="#E5E5E5">is just to</font><font color="#CCCCCC"> show</font><font color="#E5E5E5"> you like the payloads</font>

975
00:38:39,290 --> 00:38:44,150
that<font color="#E5E5E5"> are in it</font><font color="#CCCCCC"> I think I'm actually up</font>

976
00:38:40,820 --> 00:38:46,400
to 27 in<font color="#CCCCCC"> the</font><font color="#E5E5E5"> development version</font><font color="#CCCCCC"> but I</font>

977
00:38:44,150 --> 00:38:47,600
need to push that code to github<font color="#CCCCCC"> but</font>

978
00:38:46,400 --> 00:38:48,890
this is<font color="#E5E5E5"> open</font><font color="#CCCCCC"> source and</font><font color="#E5E5E5"> out there right</font>

979
00:38:47,600 --> 00:38:51,020
<font color="#CCCCCC">now</font><font color="#E5E5E5"> and the link will</font><font color="#CCCCCC"> be at the end of</font>

980
00:38:48,890 --> 00:38:53,500
the slides<font color="#CCCCCC"> so in this particular</font><font color="#E5E5E5"> case</font>

981
00:38:51,020 --> 00:38:55,550
<font color="#CCCCCC">you know</font><font color="#E5E5E5"> we're gonna use reg</font><font color="#CCCCCC"> azzam</font>

982
00:38:53,500 --> 00:38:58,010
<font color="#CCCCCC">because it's</font><font color="#E5E5E5"> different than the other</font>

983
00:38:55,550 --> 00:39:00,230
bypass black passes we looked at and<font color="#CCCCCC"> I</font>

984
00:38:58,010 --> 00:39:02,300
<font color="#E5E5E5">show</font><font color="#CCCCCC"> that actually</font><font color="#E5E5E5"> does</font><font color="#CCCCCC"> compiled</font>

985
00:39:00,230 --> 00:39:06,200
assembly based application<font color="#E5E5E5"> why those</font>

986
00:39:02,300 --> 00:39:07,550
<font color="#E5E5E5">bypasses as well so in here we can set a</font>

987
00:39:06,200 --> 00:39:09,439
lot of<font color="#E5E5E5"> different</font><font color="#CCCCCC"> options as you</font><font color="#E5E5E5"> can see</font>

988
00:39:07,550 --> 00:39:11,900
you know we can check if<font color="#E5E5E5"> debuggers are</font>

989
00:39:09,440 --> 00:39:13,550
<font color="#CCCCCC">enabled we can key it to a domain we can</font>

990
00:39:11,900 --> 00:39:15,530
expire the payload after a<font color="#CCCCCC"> certain</font>

991
00:39:13,550 --> 00:39:18,800
<font color="#E5E5E5">amount of time you can keep to a certain</font>

992
00:39:15,530 --> 00:39:20,540
<font color="#CCCCCC">hostname</font><font color="#E5E5E5"> we have different options</font><font color="#CCCCCC"> for</font>

993
00:39:18,800 --> 00:39:22,610
<font color="#E5E5E5">how to provide</font><font color="#CCCCCC"> it shell code it's</font><font color="#E5E5E5"> not</font>

994
00:39:20,540 --> 00:39:23,720
just using<font color="#CCCCCC"> MSM venom all the time like</font>

995
00:39:22,610 --> 00:39:25,430
if you want<font color="#E5E5E5"> to use it with cobalt</font>

996
00:39:23,720 --> 00:39:27,620
<font color="#CCCCCC">striker or maybe like a custom rat</font><font color="#E5E5E5"> that</font>

997
00:39:25,430 --> 00:39:29,509
you've<font color="#E5E5E5"> developed</font><font color="#CCCCCC"> then you would be able</font>

998
00:39:27,620 --> 00:39:31,549
<font color="#E5E5E5">to use it with that as well using one of</font>

999
00:39:29,510 --> 00:39:33,710
<font color="#E5E5E5">the two three or</font><font color="#CCCCCC"> four</font><font color="#E5E5E5"> options pending</font>

1000
00:39:31,550 --> 00:39:36,020
how your<font color="#E5E5E5"> cell code is formatted with</font><font color="#CCCCCC"> how</font>

1001
00:39:33,710 --> 00:39:38,990
your rat generates<font color="#E5E5E5"> that shell code so</font>

1002
00:39:36,020 --> 00:39:40,790
this particular part of the<font color="#E5E5E5"> demo takes</font>

1003
00:39:38,990 --> 00:39:42,919
to do some out<font color="#E5E5E5"> of time because for</font>

1004
00:39:40,790 --> 00:39:45,200
<font color="#E5E5E5">whatever reason sometimes</font><font color="#CCCCCC"> MSM venom is</font>

1005
00:39:42,920 --> 00:39:48,620
like<font color="#E5E5E5"> snap</font><font color="#CCCCCC"> snap and I can't actually</font><font color="#E5E5E5"> snap</font>

1006
00:39:45,200 --> 00:39:49,819
otherwise<font color="#E5E5E5"> it would and then sometimes it</font>

1007
00:39:48,620 --> 00:39:51,230
takes like a minute<font color="#CCCCCC"> to generate shell</font>

1008
00:39:49,820 --> 00:39:52,790
code and it's probably<font color="#CCCCCC"> just</font><font color="#E5E5E5"> an issue</font>

1009
00:39:51,230 --> 00:39:55,430
with my VM or I was running too much

1010
00:39:52,790 --> 00:39:57,970
stuff at the time who knows<font color="#E5E5E5"> technology</font>

1011
00:39:55,430 --> 00:40:01,200
<font color="#CCCCCC">like I said</font>

1012
00:39:57,970 --> 00:40:03,700
you know trust me<font color="#E5E5E5"> I'm good at technology</font>

1013
00:40:01,200 --> 00:40:05,529
<font color="#E5E5E5">so again it's generating the shellcodes</font>

1014
00:40:03,700 --> 00:40:06,819
doing this thing<font color="#E5E5E5"> I like to tell you</font><font color="#CCCCCC"> that</font>

1015
00:40:05,530 --> 00:40:08,200
<font color="#CCCCCC">still</font><font color="#E5E5E5"> there's like some secret</font><font color="#CCCCCC"> awesome</font>

1016
00:40:06,820 --> 00:40:11,530
thing that<font color="#CCCCCC"> I'm like doing behind the</font>

1017
00:40:08,200 --> 00:40:13,089
<font color="#CCCCCC">scenes right now it's just not</font><font color="#E5E5E5"> true so</font>

1018
00:40:11,530 --> 00:40:16,030
we'll give it a<font color="#CCCCCC"> few more seconds and</font>

1019
00:40:13,090 --> 00:40:19,300
eventually it<font color="#E5E5E5"> will generate it</font><font color="#CCCCCC"> get</font>

1020
00:40:16,030 --> 00:40:21,160
everything compiled<font color="#E5E5E5"> now we can select</font><font color="#CCCCCC"> a</font>

1021
00:40:19,300 --> 00:40:22,540
name for<font color="#E5E5E5"> it we'll call it</font><font color="#CCCCCC"> reg Azzam so</font>

1022
00:40:21,160 --> 00:40:24,160
one thing<font color="#E5E5E5"> that's different in the newest</font>

1023
00:40:22,540 --> 00:40:26,500
<font color="#CCCCCC">version</font><font color="#E5E5E5"> it will</font><font color="#CCCCCC"> actually</font><font color="#E5E5E5"> print out</font>

1024
00:40:24,160 --> 00:40:28,149
execute with and give you the full path

1025
00:40:26,500 --> 00:40:31,270
to<font color="#E5E5E5"> execute the application why it was</font>

1026
00:40:28,150 --> 00:40:32,680
<font color="#E5E5E5">bypass with and I hit ctrl C here</font>

1027
00:40:31,270 --> 00:40:34,480
because I like<font color="#CCCCCC"> saying</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> ragequit to</font>

1028
00:40:32,680 --> 00:40:36,279
Great<font color="#E5E5E5"> Scott</font><font color="#CCCCCC"> because I almost did a</font>

1029
00:40:34,480 --> 00:40:39,010
million<font color="#CCCCCC"> times</font><font color="#E5E5E5"> whenever I was developing</font>

1030
00:40:36,280 --> 00:40:41,200
it<font color="#E5E5E5"> you know writing code</font><font color="#CCCCCC"> that generates</font>

1031
00:40:39,010 --> 00:40:43,660
code dynamically and obfuscates it

1032
00:40:41,200 --> 00:40:47,140
debugging<font color="#CCCCCC"> that stuff is kind of a pain</font>

1033
00:40:43,660 --> 00:40:48,549
and it drove me<font color="#CCCCCC"> nuts at times</font><font color="#E5E5E5"> so it also</font>

1034
00:40:47,140 --> 00:40:50,920
generates them thatís what resource file

1035
00:40:48,550 --> 00:40:52,750
just like<font color="#CCCCCC"> Vail using its framework and</font>

1036
00:40:50,920 --> 00:40:54,040
we can beat that<font color="#CCCCCC"> into Metasploit so we</font>

1037
00:40:52,750 --> 00:40:56,109
don't have<font color="#E5E5E5"> to type all that stuff we saw</font>

1038
00:40:54,040 --> 00:40:58,060
in the<font color="#CCCCCC"> register 32 and msbuild</font>

1039
00:40:56,109 --> 00:40:59,890
demos from<font color="#E5E5E5"> the blog post</font><font color="#CCCCCC"> I had written</font>

1040
00:40:58,060 --> 00:41:02,470
<font color="#E5E5E5">for kind of pretending we had gone back</font>

1041
00:40:59,890 --> 00:41:03,970
<font color="#CCCCCC">in time</font><font color="#E5E5E5"> and case you just released these</font>

1042
00:41:02,470 --> 00:41:08,020
bypasses and<font color="#E5E5E5"> we're trying to weaponize</font>

1043
00:41:03,970 --> 00:41:11,439
them so it's finally<font color="#E5E5E5"> starting</font><font color="#CCCCCC"> Metasploit</font>

1044
00:41:08,020 --> 00:41:13,119
framework<font color="#CCCCCC"> set everything for us our job</font>

1045
00:41:11,440 --> 00:41:14,050
is running<font color="#E5E5E5"> our listeners running like</font>

1046
00:41:13,119 --> 00:41:16,599
we're good to go

1047
00:41:14,050 --> 00:41:20,470
well<font color="#CCCCCC"> double check the jobs okay it is</font>

1048
00:41:16,599 --> 00:41:22,750
<font color="#E5E5E5">running and then we'll go</font><font color="#CCCCCC"> ahead</font><font color="#E5E5E5"> and head</font>

1049
00:41:20,470 --> 00:41:24,580
over<font color="#E5E5E5"> to</font><font color="#CCCCCC"> the code that it generated for</font>

1050
00:41:22,750 --> 00:41:26,470
us<font color="#E5E5E5"> so it provides you the source</font><font color="#CCCCCC"> code as</font>

1051
00:41:24,580 --> 00:41:28,270
<font color="#CCCCCC">well as the binary</font><font color="#E5E5E5"> and in here you can</font>

1052
00:41:26,470 --> 00:41:30,310
see<font color="#CCCCCC"> public static void register class</font>

1053
00:41:28,270 --> 00:41:32,349
public static void unregistered class

1054
00:41:30,310 --> 00:41:34,119
and<font color="#E5E5E5"> again this goes</font><font color="#CCCCCC"> back to you if you</font>

1055
00:41:32,349 --> 00:41:36,010
want to register something<font color="#CCCCCC"> you have to</font>

1056
00:41:34,119 --> 00:41:38,170
<font color="#E5E5E5">be local admin if you want to unregister</font>

1057
00:41:36,010 --> 00:41:40,930
something you only need user level

1058
00:41:38,170 --> 00:41:43,839
rights<font color="#E5E5E5"> so in this case you know we're</font>

1059
00:41:40,930 --> 00:41:47,680
gonna<font color="#E5E5E5"> end</font><font color="#CCCCCC"> up on</font><font color="#E5E5E5"> registering it using me</font>

1060
00:41:43,839 --> 00:41:49,000
<font color="#E5E5E5">slash</font><font color="#CCCCCC"> u flag</font><font color="#E5E5E5"> within reg</font><font color="#CCCCCC"> azzam it's not</font>

1061
00:41:47,680 --> 00:41:51,279
we<font color="#CCCCCC"> switched over</font><font color="#E5E5E5"> to our Windows machine</font>

1062
00:41:49,000 --> 00:41:54,070
<font color="#CCCCCC">and we're gonna type C Windows and again</font>

1063
00:41:51,280 --> 00:41:56,230
like I have this<font color="#E5E5E5"> execute with in there</font>

1064
00:41:54,070 --> 00:41:58,900
now<font color="#CCCCCC"> I did</font><font color="#E5E5E5"> that after</font><font color="#CCCCCC"> I recorded this</font>

1065
00:41:56,230 --> 00:42:01,390
<font color="#E5E5E5">demo</font><font color="#CCCCCC"> so you'll be able</font><font color="#E5E5E5"> to just like copy</font>

1066
00:41:58,900 --> 00:42:03,099
paste this in essentially in the future

1067
00:42:01,390 --> 00:42:05,140
instead<font color="#CCCCCC"> of</font><font color="#E5E5E5"> having to know the</font><font color="#CCCCCC"> past or</font>

1068
00:42:03,099 --> 00:42:06,849
<font color="#E5E5E5">all this and it's generally like</font><font color="#CCCCCC"> the</font>

1069
00:42:05,140 --> 00:42:09,400
same type<font color="#CCCCCC"> of</font><font color="#E5E5E5"> pass this either in system</font>

1070
00:42:06,849 --> 00:42:10,630
<font color="#E5E5E5">32 sis well 64 within you know the</font>

1071
00:42:09,400 --> 00:42:13,900
microsoft.net framework

1072
00:42:10,630 --> 00:42:15,579
so again we do<font color="#CCCCCC"> reg Azzam dot exe /u to</font>

1073
00:42:13,900 --> 00:42:17,529
unregister<font color="#CCCCCC"> we're going to go ahead and</font>

1074
00:42:15,579 --> 00:42:19,420
check<font color="#E5E5E5"> in process hacker make sure that</font>

1075
00:42:17,529 --> 00:42:22,299
it's actually<font color="#CCCCCC"> calling back again we have</font>

1076
00:42:19,420 --> 00:42:23,769
<font color="#CCCCCC">Regazzoni</font><font color="#E5E5E5"> XE and we see it calling back</font>

1077
00:42:22,299 --> 00:42:26,200
to<font color="#CCCCCC"> the remote address</font><font color="#E5E5E5"> that we expect on</font>

1078
00:42:23,769 --> 00:42:27,939
the port the<font color="#E5E5E5"> tcp port that we expect and</font>

1079
00:42:26,200 --> 00:42:29,529
we'll go ahead<font color="#E5E5E5"> and</font><font color="#CCCCCC"> go back</font><font color="#E5E5E5"> over its mess</font>

1080
00:42:27,940 --> 00:42:31,420
<font color="#E5E5E5">void and we'll see if we can interact</font>

1081
00:42:29,529 --> 00:42:33,849
with<font color="#E5E5E5"> the section of the session and get</font>

1082
00:42:31,420 --> 00:42:37,630
<font color="#CCCCCC">UID</font><font color="#E5E5E5"> to make sure that everything is</font>

1083
00:42:33,849 --> 00:42:39,220
<font color="#E5E5E5">actually functioning properly sure ain't</font>

1084
00:42:37,630 --> 00:42:40,839
gonna go ahead and sessions - I -

1085
00:42:39,220 --> 00:42:43,709
<font color="#E5E5E5">because that's the session we want</font><font color="#CCCCCC"> to</font>

1086
00:42:40,839 --> 00:42:46,390
interact with<font color="#E5E5E5"> all right</font><font color="#CCCCCC"> I get UID and</font>

1087
00:42:43,710 --> 00:42:48,119
<font color="#CCCCCC">hooray hey we did it we generated an</font>

1088
00:42:46,390 --> 00:42:50,140
application<font color="#CCCCCC"> why was bypassed that's all</font>

1089
00:42:48,119 --> 00:42:54,970
<font color="#E5E5E5">dynamically generated based on user</font>

1090
00:42:50,140 --> 00:42:58,598
input<font color="#E5E5E5"> so that's the last demo</font>

1091
00:42:54,970 --> 00:43:01,720
<font color="#CCCCCC">I know people might be</font><font color="#E5E5E5"> interested</font><font color="#CCCCCC"> in</font>

1092
00:42:58,599 --> 00:43:04,809
like what my future plans are<font color="#CCCCCC"> I don't</font>

1093
00:43:01,720 --> 00:43:08,979
have a slide for<font color="#CCCCCC"> it I can say that I do</font>

1094
00:43:04,809 --> 00:43:10,809
have<font color="#CCCCCC"> a lot of</font><font color="#E5E5E5"> future plans however I'm</font>

1095
00:43:08,979 --> 00:43:12,939
still<font color="#CCCCCC"> in talks</font><font color="#E5E5E5"> with another individual</font>

1096
00:43:10,809 --> 00:43:14,440
<font color="#E5E5E5">about</font><font color="#CCCCCC"> what we're</font><font color="#E5E5E5"> going to do with</font><font color="#CCCCCC"> Great</font>

1097
00:43:12,940 --> 00:43:16,390
<font color="#CCCCCC">Scott in the future and I don't want</font><font color="#E5E5E5"> to</font>

1098
00:43:14,440 --> 00:43:20,769
reveal<font color="#E5E5E5"> any of that</font><font color="#CCCCCC"> until him and I have</font>

1099
00:43:16,390 --> 00:43:22,390
talked again so it's one<font color="#E5E5E5"> of those things</font>

1100
00:43:20,769 --> 00:43:24,459
where there is some great stuff planned

1101
00:43:22,390 --> 00:43:27,339
<font color="#E5E5E5">and they generate all feature I plan on</font>

1102
00:43:24,460 --> 00:43:29,680
implementing that<font color="#E5E5E5"> back in and in</font>

1103
00:43:27,339 --> 00:43:32,140
relation to Great Scott<font color="#E5E5E5"> only I also plan</font>

1104
00:43:29,680 --> 00:43:35,019
<font color="#E5E5E5">on finishing the Python port of</font><font color="#CCCCCC"> Daniel</font>

1105
00:43:32,140 --> 00:43:36,759
<font color="#E5E5E5">Bohannon's and volkov</font><font color="#CCCCCC"> the station there</font>

1106
00:43:35,019 --> 00:43:38,700
<font color="#E5E5E5">are some other features that another</font>

1107
00:43:36,759 --> 00:43:40,749
individual and myself are talking<font color="#CCCCCC"> about</font>

1108
00:43:38,700 --> 00:43:42,910
<font color="#E5E5E5">and we're going</font><font color="#CCCCCC"> to be submitting</font><font color="#E5E5E5"> at the</font>

1109
00:43:40,749 --> 00:43:45,249
Derby<font color="#CCCCCC"> comm hopefully we get accepted</font>

1110
00:43:42,910 --> 00:43:47,529
there and you know if you happen to be

1111
00:43:45,249 --> 00:43:50,200
<font color="#CCCCCC">at</font><font color="#E5E5E5"> Derby</font><font color="#CCCCCC"> come to my talk</font><font color="#E5E5E5"> or you know</font>

1112
00:43:47,529 --> 00:43:51,579
<font color="#E5E5E5">keep an eye on me on Twitter keep an eye</font>

1113
00:43:50,200 --> 00:43:53,519
on<font color="#E5E5E5"> my github if you're interested in</font>

1114
00:43:51,579 --> 00:43:56,499
<font color="#E5E5E5">this project and this sort of research</font>

1115
00:43:53,519 --> 00:43:59,468
and<font color="#E5E5E5"> you know I just want to thank</font>

1116
00:43:56,499 --> 00:44:02,348
everyone I was<font color="#E5E5E5"> very flattered</font><font color="#CCCCCC"> to be made</font>

1117
00:43:59,469 --> 00:44:05,019
the keynote here<font color="#CCCCCC"> I</font><font color="#E5E5E5"> just kind of extended</font>

1118
00:44:02,349 --> 00:44:07,450
a talk and it<font color="#E5E5E5"> happens you know on</font>

1119
00:44:05,019 --> 00:44:08,680
Thursday<font color="#CCCCCC"> I</font><font color="#E5E5E5"> was talking to someone and</font>

1120
00:44:07,450 --> 00:44:09,999
<font color="#E5E5E5">they were asking me when my talk was</font>

1121
00:44:08,680 --> 00:44:11,319
<font color="#E5E5E5">they pull up the</font><font color="#CCCCCC"> schedule</font><font color="#E5E5E5"> and they said</font>

1122
00:44:09,999 --> 00:44:15,129
oh you're the closing keynote and<font color="#E5E5E5"> I was</font>

1123
00:44:11,319 --> 00:44:17,619
like news to me so hopefully you enjoyed

1124
00:44:15,130 --> 00:44:19,809
it<font color="#CCCCCC"> I try</font><font color="#E5E5E5"> to take it easier at</font><font color="#CCCCCC"> the con so</font>

1125
00:44:17,619 --> 00:44:22,000
that I could have enough energy<font color="#CCCCCC"> to try</font>

1126
00:44:19,809 --> 00:44:24,470
and deliver<font color="#E5E5E5"> for you guys</font>

1127
00:44:22,000 --> 00:44:26,420
thanks so much<font color="#E5E5E5"> to the</font><font color="#CCCCCC"> Khan for having me</font>

1128
00:44:24,470 --> 00:44:28,310
as well as the sponsors and<font color="#CCCCCC"> the</font><font color="#E5E5E5"> other</font>

1129
00:44:26,420 --> 00:44:30,590
speakers and<font color="#E5E5E5"> the fantastic trainers</font><font color="#CCCCCC"> that</font>

1130
00:44:28,310 --> 00:44:33,380
we've had this week<font color="#E5E5E5"> and most importantly</font>

1131
00:44:30,590 --> 00:44:35,450
you guys the attendees<font color="#CCCCCC"> that make this</font>

1132
00:44:33,380 --> 00:44:37,280
conference<font color="#E5E5E5"> awesome so if there's any</font>

1133
00:44:35,450 --> 00:44:41,419
questions<font color="#CCCCCC"> yeah</font><font color="#E5E5E5"> absolutely</font>

1134
00:44:37,280 --> 00:44:44,720
oh absolutely

1135
00:44:41,420 --> 00:44:48,770
<font color="#E5E5E5">so I need to add</font><font color="#CCCCCC"> in like a contributions</font>

1136
00:44:44,720 --> 00:44:50,779
markdown file<font color="#CCCCCC"> that way you know there's</font>

1137
00:44:48,770 --> 00:44:52,640
some guidelines on how to do it<font color="#E5E5E5"> but yeah</font>

1138
00:44:50,780 --> 00:44:53,870
absolutely you know feel<font color="#CCCCCC"> free to reach</font>

1139
00:44:52,640 --> 00:44:55,970
out<font color="#CCCCCC"> to me as well</font>

1140
00:44:53,870 --> 00:44:57,890
and you know you can<font color="#E5E5E5"> talk to me about</font>

1141
00:44:55,970 --> 00:44:59,689
<font color="#E5E5E5">what you're thinking</font><font color="#CCCCCC"> about or some ideas</font>

1142
00:44:57,890 --> 00:45:02,029
that<font color="#CCCCCC"> you have and I can</font><font color="#E5E5E5"> point you in the</font>

1143
00:44:59,690 --> 00:45:03,500
right<font color="#E5E5E5"> direction within</font><font color="#CCCCCC"> the framework</font><font color="#E5E5E5"> if</font>

1144
00:45:02,030 --> 00:45:27,110
you don't familiar like just like<font color="#E5E5E5"> deep</font>

1145
00:45:03,500 --> 00:45:29,270
diving<font color="#E5E5E5"> into the code yeah absolutely I</font>

1146
00:45:27,110 --> 00:45:32,090
<font color="#E5E5E5">would actually encourage that so the</font>

1147
00:45:29,270 --> 00:45:34,070
question<font color="#CCCCCC"> was you know</font><font color="#E5E5E5"> let's say</font><font color="#CCCCCC"> you like</font>

1148
00:45:32,090 --> 00:45:36,260
you don't like<font color="#E5E5E5"> you</font><font color="#CCCCCC"> know some a new</font>

1149
00:45:34,070 --> 00:45:39,080
application<font color="#E5E5E5"> whitelist or some research</font>

1150
00:45:36,260 --> 00:45:40,400
but<font color="#CCCCCC"> you know you don't necessarily</font><font color="#E5E5E5"> like</font>

1151
00:45:39,080 --> 00:45:42,890
want to<font color="#E5E5E5"> write the code</font><font color="#CCCCCC"> for it could I</font>

1152
00:45:40,400 --> 00:45:44,630
just like stick a github<font color="#E5E5E5"> issue on there</font>

1153
00:45:42,890 --> 00:45:46,430
<font color="#E5E5E5">and say hey consider implementing this I</font>

1154
00:45:44,630 --> 00:45:49,280
say yes absolutely<font color="#CCCCCC"> that</font><font color="#E5E5E5"> would be</font>

1155
00:45:46,430 --> 00:45:50,960
fantastic<font color="#CCCCCC"> you know I really like my goal</font>

1156
00:45:49,280 --> 00:45:52,460
is to<font color="#E5E5E5"> get everything complete I want</font>

1157
00:45:50,960 --> 00:45:55,640
every single<font color="#E5E5E5"> application</font><font color="#CCCCCC"> Wireless bypass</font>

1158
00:45:52,460 --> 00:45:57,170
in this framework<font color="#E5E5E5"> so that people can</font>

1159
00:45:55,640 --> 00:45:59,180
really test their ability to<font color="#E5E5E5"> detect and</font>

1160
00:45:57,170 --> 00:46:01,970
respond<font color="#E5E5E5"> and hopefully in the</font><font color="#CCCCCC"> future use</font>

1161
00:45:59,180 --> 00:46:04,190
my tool<font color="#CCCCCC"> and more</font><font color="#E5E5E5"> automated tgp</font>

1162
00:46:01,970 --> 00:46:06,500
adversarial type tools to provide<font color="#E5E5E5"> a more</font>

1163
00:46:04,190 --> 00:46:10,160
real is this<font color="#E5E5E5"> realistic situation and</font>

1164
00:46:06,500 --> 00:46:15,730
analysis<font color="#CCCCCC"> it's cool yeah great question</font>

1165
00:46:10,160 --> 00:46:15,730
<font color="#CCCCCC">thanks Dan any other any other</font><font color="#E5E5E5"> questions</font>

1166
00:46:16,180 --> 00:46:21,029
all right cool

1167
00:46:17,840 --> 00:46:24,119
sandy<font color="#E5E5E5"> hands so thank you so much</font>

1168
00:46:21,030 --> 00:46:24,119
[Applause]

