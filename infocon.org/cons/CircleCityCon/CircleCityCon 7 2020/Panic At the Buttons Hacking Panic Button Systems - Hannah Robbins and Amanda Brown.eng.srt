1
00:00:18,030 --> 00:00:23,220
it's hacking panic button systems I know

2
00:00:21,240 --> 00:00:25,169
with everything going on in this

3
00:00:23,220 --> 00:00:27,299
apocalypse there lots of reasons to

4
00:00:25,170 --> 00:00:29,730
panic but as we're about to show you

5
00:00:27,300 --> 00:00:36,739
guys these systems aren't gonna help you

6
00:00:29,730 --> 00:00:40,590
any in any way with that so hey everyone

7
00:00:36,739 --> 00:00:44,040
my name is Amanda Brown I'm a rising

8
00:00:40,590 --> 00:00:48,629
senior RIT and I currently work as a

9
00:00:44,040 --> 00:00:52,110
coop for IBM x-force read as a tester

10
00:00:48,629 --> 00:00:55,500
for this research I primarily focused on

11
00:00:52,110 --> 00:01:01,409
the networking in reversing and anything

12
00:00:55,500 --> 00:01:05,610
within bu Windows domain hi everyone my

13
00:01:01,409 --> 00:01:08,700
name is Hannah Robbins and I am about to

14
00:01:05,610 --> 00:01:11,520
start as a pen tester full-time with

15
00:01:08,700 --> 00:01:15,510
x-force read I just finished up getting

16
00:01:11,520 --> 00:01:17,670
my undergrad as a at the University of

17
00:01:15,510 --> 00:01:20,190
Tulsa for this research I focused

18
00:01:17,670 --> 00:01:24,149
primarily on anything in the mobile

19
00:01:20,190 --> 00:01:26,729
application world stuff including

20
00:01:24,149 --> 00:01:29,189
testing of our Android iOS apps and then

21
00:01:26,729 --> 00:01:32,240
I also worked with all the web testing

22
00:01:29,189 --> 00:01:32,240
in the wild wild west

23
00:01:33,079 --> 00:01:39,059
so before we demin let's talk about

24
00:01:36,450 --> 00:01:42,570
panic buttons in general since it's a

25
00:01:39,060 --> 00:01:45,240
little bit niche the best way to explain

26
00:01:42,570 --> 00:01:49,048
to you guys is to have you think about a

27
00:01:45,240 --> 00:01:52,500
classic bank robbery scene in a movie so

28
00:01:49,049 --> 00:01:55,619
the robber will come in and demand the

29
00:01:52,500 --> 00:01:59,039
teller to give them money and then the

30
00:01:55,619 --> 00:02:01,829
camera pans to the teller who hits a

31
00:01:59,039 --> 00:02:05,039
button underneath the table that button

32
00:02:01,829 --> 00:02:07,829
is a panic button which is essentially a

33
00:02:05,039 --> 00:02:11,880
way of announcing the emergency to

34
00:02:07,829 --> 00:02:15,090
either the police or some pre-assigned

35
00:02:11,880 --> 00:02:18,150
contacts paddock vines can be in the

36
00:02:15,090 --> 00:02:21,440
form of a physical button a mobile

37
00:02:18,150 --> 00:02:24,300
application or some sort of a software

38
00:02:21,440 --> 00:02:25,829
so you might be wondering why should we

39
00:02:24,300 --> 00:02:27,959
care about all the land realities that

40
00:02:25,830 --> 00:02:30,150
we found in panic button systems well

41
00:02:27,959 --> 00:02:31,920
first off panic button systems aren't

42
00:02:30,150 --> 00:02:33,810
industry specific or you

43
00:02:31,920 --> 00:02:36,208
is often in the government as they are

44
00:02:33,810 --> 00:02:38,069
in education as they are in banks as

45
00:02:36,209 --> 00:02:41,610
they are in local small businesses in

46
00:02:38,069 --> 00:02:43,769
addition panic buttons are used by

47
00:02:41,610 --> 00:02:46,200
individuals so some of the products that

48
00:02:43,770 --> 00:02:47,489
we tested could be used for individuals

49
00:02:46,200 --> 00:02:51,019
wanting to make sure they got home safe

50
00:02:47,489 --> 00:02:53,100
from a concert or individuals that are

51
00:02:51,020 --> 00:02:55,260
older that want to make sure want to be

52
00:02:53,100 --> 00:02:57,269
able to live their lifestyle but

53
00:02:55,260 --> 00:03:00,690
recognize that some things might happen

54
00:02:57,270 --> 00:03:03,030
in addition the panic button systems

55
00:03:00,690 --> 00:03:05,340
that we tested aren't just United States

56
00:03:03,030 --> 00:03:08,069
based products these are used by people

57
00:03:05,340 --> 00:03:10,560
all over the world so when we found all

58
00:03:08,069 --> 00:03:12,569
these vulnerabilities it's not just one

59
00:03:10,560 --> 00:03:17,670
person it's not just one industry but

60
00:03:12,569 --> 00:03:19,768
it's everyone that's effective to give

61
00:03:17,670 --> 00:03:23,819
you guys a little background information

62
00:03:19,769 --> 00:03:27,989
and then I both worked as interns for XO

63
00:03:23,819 --> 00:03:30,958
far last summer one aspect to our

64
00:03:27,989 --> 00:03:34,140
internship was completing a research

65
00:03:30,959 --> 00:03:38,880
project within a month a month and a

66
00:03:34,140 --> 00:03:41,880
half and we decided on testing a span of

67
00:03:38,880 --> 00:03:43,980
panic button systems primarily focusing

68
00:03:41,880 --> 00:03:47,640
on three different goals for our

69
00:03:43,980 --> 00:03:52,620
research the first being to suppress a

70
00:03:47,640 --> 00:03:54,510
panic alert meaning a user has triggered

71
00:03:52,620 --> 00:03:56,880
that alert and they believe that it's

72
00:03:54,510 --> 00:03:59,970
valid but we've actually suppressed that

73
00:03:56,880 --> 00:04:02,549
transmission the second research goal

74
00:03:59,970 --> 00:04:05,700
was to start a panic alert without that

75
00:04:02,549 --> 00:04:10,019
valid user interaction and finally we

76
00:04:05,700 --> 00:04:11,910
wanted to stop an active panic alert so

77
00:04:10,019 --> 00:04:13,769
before we go on to the bulk of our

78
00:04:11,910 --> 00:04:14,940
presentation just want to give you a

79
00:04:13,769 --> 00:04:17,160
little bit overview of what you're gonna

80
00:04:14,940 --> 00:04:18,779
see first off we're going to go through

81
00:04:17,160 --> 00:04:20,700
the three products we tested silent

82
00:04:18,779 --> 00:04:22,950
beacon little green button and community

83
00:04:20,700 --> 00:04:24,810
response systems we're gonna present all

84
00:04:22,950 --> 00:04:25,950
of our vulnerabilities as viable attack

85
00:04:24,810 --> 00:04:28,610
chains putting together all the

86
00:04:25,950 --> 00:04:31,969
vulnerabilities to go from low to no

87
00:04:28,610 --> 00:04:35,039
knowledge to be able to completely

88
00:04:31,970 --> 00:04:38,190
render the product or some of the other

89
00:04:35,039 --> 00:04:39,690
things associated with it useless just a

90
00:04:38,190 --> 00:04:42,090
disclaimer before we start we're going

91
00:04:39,690 --> 00:04:44,010
to be using some examples of some

92
00:04:42,090 --> 00:04:45,719
real-world companies we have no

93
00:04:44,010 --> 00:04:47,550
knowledge at all it

94
00:04:45,720 --> 00:04:49,230
any of these companies use this product

95
00:04:47,550 --> 00:04:52,170
we're just using them I stand in so you

96
00:04:49,230 --> 00:04:54,210
guys have an idea of the attack scenario

97
00:04:52,170 --> 00:04:56,010
we also aren't advocating using these

98
00:04:54,210 --> 00:04:57,270
vulnerabilities to attack anyone we want

99
00:04:56,010 --> 00:04:59,219
to make sure that these products are

100
00:04:57,270 --> 00:05:06,710
more secure after the research we've

101
00:04:59,220 --> 00:05:10,050
done so now that we've covered our butts

102
00:05:06,710 --> 00:05:12,930
the first company we'll be discussing is

103
00:05:10,050 --> 00:05:15,530
silent beacon they are a United States

104
00:05:12,930 --> 00:05:18,900
based product with worldwide clientele

105
00:05:15,530 --> 00:05:22,380
primarily focusing on the individual

106
00:05:18,900 --> 00:05:24,929
safety between the App Store and Google

107
00:05:22,380 --> 00:05:27,420
Play they have approximately a hundred

108
00:05:24,930 --> 00:05:31,770
thousand downloads just so you can get

109
00:05:27,420 --> 00:05:34,020
se gage for the impact so let's talk a

110
00:05:31,770 --> 00:05:35,760
little bit about how silent begin works

111
00:05:34,020 --> 00:05:38,700
silent beacon is primarily a mobile

112
00:05:35,760 --> 00:05:41,550
application they have Android and iOS

113
00:05:38,700 --> 00:05:43,919
versions when you first get to this app

114
00:05:41,550 --> 00:05:46,290
you go ahead and you register it gives

115
00:05:43,919 --> 00:05:47,909
you an account that's associated with

116
00:05:46,290 --> 00:05:50,940
your phone number you can go in you can

117
00:05:47,910 --> 00:05:56,940
customize everything from which contacts

118
00:05:50,940 --> 00:05:58,740
are texted your an alert that has a map

119
00:05:56,940 --> 00:06:00,540
that has where you were when this panic

120
00:05:58,740 --> 00:06:03,919
alert started to where you are when it

121
00:06:00,540 --> 00:06:07,160
stopped - and then you can also

122
00:06:03,919 --> 00:06:09,599
integrate with a physical Bluetooth

123
00:06:07,160 --> 00:06:10,940
panic one however we did not do any

124
00:06:09,600 --> 00:06:12,810
testing of that physical button

125
00:06:10,940 --> 00:06:16,410
important things to note with this

126
00:06:12,810 --> 00:06:18,450
product the only way to stop an active

127
00:06:16,410 --> 00:06:21,330
panic alert once you start it is to

128
00:06:18,450 --> 00:06:23,460
enter a PIN number and then everything's

129
00:06:21,330 --> 00:06:26,599
good it's as if there was no panic alert

130
00:06:23,460 --> 00:06:26,599
you're fine now

131
00:06:28,130 --> 00:06:33,750
so as we mentioned beforehand we want to

132
00:06:32,010 --> 00:06:36,150
have a little bit of fun with these

133
00:06:33,750 --> 00:06:39,060
vulnerabilities and present a valid

134
00:06:36,150 --> 00:06:44,190
attack chain for you guys so bear with

135
00:06:39,060 --> 00:06:46,950
us let's say that Hannah and I can

136
00:06:44,190 --> 00:06:49,320
actually leave the house and sit down at

137
00:06:46,950 --> 00:06:53,370
our local Starbucks six feet apart from

138
00:06:49,320 --> 00:06:55,409
others of course and as we sip our

139
00:06:53,370 --> 00:06:55,990
coffees you know we're on the public

140
00:06:55,410 --> 00:06:58,390
network

141
00:06:55,990 --> 00:07:01,930
and we're people watching through the

142
00:06:58,390 --> 00:07:05,830
packets and we stumble upon an

143
00:07:01,930 --> 00:07:08,080
interesting HTTP GET request that begins

144
00:07:05,830 --> 00:07:16,000
with tracker as you guys can see on the

145
00:07:08,080 --> 00:07:18,490
screen now Hannah and I are curious

146
00:07:16,000 --> 00:07:20,430
individuals so now truly we're gonna go

147
00:07:18,490 --> 00:07:24,430
to the link we're gonna check it out and

148
00:07:20,430 --> 00:07:28,810
we see a map with a person's name on it

149
00:07:24,430 --> 00:07:31,450
and also two different pins one pin

150
00:07:28,810 --> 00:07:34,200
where their panic alert started and the

151
00:07:31,450 --> 00:07:37,930
other pin where their panic alert ended

152
00:07:34,200 --> 00:07:40,900
let's say that I leave my house and I

153
00:07:37,930 --> 00:07:43,870
noticed someone is following me so I'm

154
00:07:40,900 --> 00:07:47,289
going to set off my panic button I'm

155
00:07:43,870 --> 00:07:50,800
gonna set off that alert and walk to a

156
00:07:47,290 --> 00:07:53,620
nearby location where I feel safe as an

157
00:07:50,800 --> 00:07:56,860
attacker Hannah would now know where I

158
00:07:53,620 --> 00:07:59,770
live and a place where I obviously feel

159
00:07:56,860 --> 00:08:03,070
safe at the implications of being able

160
00:07:59,770 --> 00:08:07,049
to know the exact path that someone

161
00:08:03,070 --> 00:08:11,950
would take when they feel panicked is

162
00:08:07,050 --> 00:08:13,870
frankly alarming so we're still at

163
00:08:11,950 --> 00:08:16,030
Starbucks we are sipping our coffees and

164
00:08:13,870 --> 00:08:19,720
we happen to cross this gate request

165
00:08:16,030 --> 00:08:22,960
here we examine a bit we recognize

166
00:08:19,720 --> 00:08:23,560
that's what's happening here is a long

167
00:08:22,960 --> 00:08:25,659
either

168
00:08:23,560 --> 00:08:28,330
one of the there are several different

169
00:08:25,660 --> 00:08:30,850
ways to login to silent beacon but the

170
00:08:28,330 --> 00:08:32,530
first one is to give them your phone

171
00:08:30,850 --> 00:08:34,420
number and then they'll call you and

172
00:08:32,530 --> 00:08:35,829
they'll tell you here's your passcode

173
00:08:34,419 --> 00:08:38,829
now you can log in they're trying to

174
00:08:35,830 --> 00:08:40,240
make sure that you're you actually have

175
00:08:38,830 --> 00:08:43,030
access to the phone number that this

176
00:08:40,240 --> 00:08:44,980
accounts associated with however you

177
00:08:43,030 --> 00:08:47,470
actually don't need to to be able to log

178
00:08:44,980 --> 00:08:49,570
in as we can see here this is HTTP

179
00:08:47,470 --> 00:08:52,950
requests and that password that we're

180
00:08:49,570 --> 00:08:56,470
wondering about is just in the URL so we

181
00:08:52,950 --> 00:08:59,170
used burp with intercept on we go ahead

182
00:08:56,470 --> 00:09:01,420
and try to log in and we stop that

183
00:08:59,170 --> 00:09:03,189
request and now we know that that phone

184
00:09:01,420 --> 00:09:06,910
that passcode that would have been

185
00:09:03,190 --> 00:09:08,860
called however the actual user of that

186
00:09:06,910 --> 00:09:09,829
product whoever has that specific Jay ID

187
00:09:08,860 --> 00:09:11,690
you see

188
00:09:09,830 --> 00:09:13,399
has never actually didn't actually get

189
00:09:11,690 --> 00:09:15,380
that call and doesn't know that we're

190
00:09:13,399 --> 00:09:18,230
now successfully logged in to their

191
00:09:15,380 --> 00:09:20,240
account so now that we're logged in

192
00:09:18,230 --> 00:09:23,660
there's a lot of stuff we can do we can

193
00:09:20,240 --> 00:09:26,060
go through and change the contacts that

194
00:09:23,660 --> 00:09:27,740
are going to get information when

195
00:09:26,060 --> 00:09:29,479
there's a panic alert we can also go

196
00:09:27,740 --> 00:09:34,100
ahead and do some things like changing

197
00:09:29,480 --> 00:09:36,350
the name and when we did that we saw

198
00:09:34,100 --> 00:09:38,600
this post request here that has the

199
00:09:36,350 --> 00:09:40,880
method update user details and what we

200
00:09:38,600 --> 00:09:43,370
realize here is that all we needed to

201
00:09:40,880 --> 00:09:44,630
update a lot of user information is just

202
00:09:43,370 --> 00:09:46,579
how the correct phone number which we

203
00:09:44,630 --> 00:09:49,010
already got because need logged in and

204
00:09:46,579 --> 00:09:52,069
the important thing to focus on here is

205
00:09:49,010 --> 00:09:53,959
that you can change the pin number since

206
00:09:52,070 --> 00:09:55,880
we wouldn't need to know the pin number

207
00:09:53,959 --> 00:09:59,390
to login but we do need to know the pin

208
00:09:55,880 --> 00:10:02,329
number to stop a panic alert or to

209
00:09:59,390 --> 00:10:03,800
logout we need to make sure that that's

210
00:10:02,329 --> 00:10:05,540
something we know so we can continue to

211
00:10:03,800 --> 00:10:07,910
test this product without having any

212
00:10:05,540 --> 00:10:09,800
certain issues so we can go ahead and

213
00:10:07,910 --> 00:10:11,810
just use the same method to change the

214
00:10:09,800 --> 00:10:17,209
pin to whatever we want and now we can

215
00:10:11,810 --> 00:10:19,250
go on with our testing so now comes the

216
00:10:17,209 --> 00:10:21,949
fun part we actually get to messing

217
00:10:19,250 --> 00:10:23,660
around with the testing of the panic

218
00:10:21,950 --> 00:10:26,390
button functionality and as you are

219
00:10:23,660 --> 00:10:28,730
doing this we recognize that this HTTP

220
00:10:26,390 --> 00:10:31,939
request that you see here actually has

221
00:10:28,730 --> 00:10:33,770
the information that is sent in text

222
00:10:31,940 --> 00:10:37,520
messages to any of the contacts that are

223
00:10:33,770 --> 00:10:40,279
associated with your with a your users

224
00:10:37,520 --> 00:10:42,140
panic alert so say I'm one of Amanda's

225
00:10:40,279 --> 00:10:43,700
contacts and she had that panic alert we

226
00:10:42,140 --> 00:10:45,230
were talking about earlier I would get

227
00:10:43,700 --> 00:10:48,350
this text that says she needs help

228
00:10:45,230 --> 00:10:49,490
and access to that tracker website that

229
00:10:48,350 --> 00:10:52,820
you can see all that specific

230
00:10:49,490 --> 00:10:54,320
information on now since we've already

231
00:10:52,820 --> 00:10:56,420
went ahead in our account that we've

232
00:10:54,320 --> 00:10:58,699
been playing with and we've changed all

233
00:10:56,420 --> 00:11:00,979
the contact so it doesn't matter and we

234
00:10:58,699 --> 00:11:03,560
were logged into this users account and

235
00:11:00,980 --> 00:11:05,270
we've been accepted this message now

236
00:11:03,560 --> 00:11:06,859
that's where the fun comes in we can go

237
00:11:05,270 --> 00:11:09,199
back we can change everything back we

238
00:11:06,860 --> 00:11:11,240
can change the pin number back we can

239
00:11:09,199 --> 00:11:13,149
change all the contacts back and get out

240
00:11:11,240 --> 00:11:15,949
of there as if nothing had ever happened

241
00:11:13,149 --> 00:11:17,480
but here's where the fun comes in

242
00:11:15,949 --> 00:11:19,099
because there's actually no replay

243
00:11:17,480 --> 00:11:22,670
protection against sending this message

244
00:11:19,100 --> 00:11:23,680
again so now a week later say we could

245
00:11:22,670 --> 00:11:26,540
send this message

246
00:11:23,680 --> 00:11:28,729
that this person needs help but they

247
00:11:26,540 --> 00:11:32,120
don't because it's an old message and

248
00:11:28,730 --> 00:11:33,440
nothing's actually going on so the users

249
00:11:32,120 --> 00:11:35,210
contacts with people that are supposed

250
00:11:33,440 --> 00:11:37,460
to make sure that something that the

251
00:11:35,210 --> 00:11:40,520
user is okay if something happens that

252
00:11:37,460 --> 00:11:42,710
causes a panic alert realizes that there

253
00:11:40,520 --> 00:11:46,579
was nothing wrong we do this enough time

254
00:11:42,710 --> 00:11:47,840
we we will make sure that the user

255
00:11:46,580 --> 00:11:49,910
doesn't actually have any trust with

256
00:11:47,840 --> 00:11:53,180
this product and that any contacts will

257
00:11:49,910 --> 00:11:54,860
ignore an alert that happens if there's

258
00:11:53,180 --> 00:11:56,719
something that's actually wrong creating

259
00:11:54,860 --> 00:11:58,370
a scenario where it's like the users

260
00:11:56,720 --> 00:11:59,570
crying wolf and none of the contacts

261
00:11:58,370 --> 00:12:01,700
want to help them anymore

262
00:11:59,570 --> 00:12:08,690
but that's not the only thing we can do

263
00:12:01,700 --> 00:12:11,660
with this product so we've been playing

264
00:12:08,690 --> 00:12:14,000
around we've had a lot of fun but you

265
00:12:11,660 --> 00:12:16,670
know coffee's getting cold it's time to

266
00:12:14,000 --> 00:12:19,990
move on there's one thing left to do

267
00:12:16,670 --> 00:12:22,910
though and that's delete some accounts

268
00:12:19,990 --> 00:12:25,940
we established before that we have the

269
00:12:22,910 --> 00:12:30,980
ability to make people completely lose

270
00:12:25,940 --> 00:12:33,440
faith in this product so why not just do

271
00:12:30,980 --> 00:12:36,320
them a favor and delete their account

272
00:12:33,440 --> 00:12:40,220
all we have to do is call the method

273
00:12:36,320 --> 00:12:46,970
delete user providing their phone number

274
00:12:40,220 --> 00:12:50,690
as the parameter so this is the result

275
00:12:46,970 --> 00:12:53,420
of calling the delete user method from a

276
00:12:50,690 --> 00:12:55,610
simple get request your information is

277
00:12:53,420 --> 00:12:59,209
cleared including your name and your

278
00:12:55,610 --> 00:13:04,940
password any account that is deleted in

279
00:12:59,210 --> 00:13:08,060
this way can't create any can't log out

280
00:13:04,940 --> 00:13:11,150
and they can't silence any alerts that

281
00:13:08,060 --> 00:13:16,250
they create instead they'll receive the

282
00:13:11,150 --> 00:13:19,910
pop up of user does not exist and with

283
00:13:16,250 --> 00:13:21,980
this you know pretty concerning

284
00:13:19,910 --> 00:13:24,770
especially when you keep in mind that

285
00:13:21,980 --> 00:13:26,960
the only information we needed to delete

286
00:13:24,770 --> 00:13:29,890
this account was the user's phone number

287
00:13:26,960 --> 00:13:33,710
which in the grand scheme of things

288
00:13:29,890 --> 00:13:36,380
isn't about hard to find if we really

289
00:13:33,710 --> 00:13:37,030
wanted to mess with things too we could

290
00:13:36,380 --> 00:13:39,970
simply

291
00:13:37,030 --> 00:13:42,839
grouped the process of iterating over

292
00:13:39,970 --> 00:13:46,450
every single phone number ensuring that

293
00:13:42,840 --> 00:13:50,800
no one is safe and no one can rely on

294
00:13:46,450 --> 00:13:53,410
this product so now it's time to talk

295
00:13:50,800 --> 00:13:54,849
about little green button little green

296
00:13:53,410 --> 00:13:56,829
button is the United Kingdom based

297
00:13:54,850 --> 00:13:58,570
product with worldwide clientele with a

298
00:13:56,830 --> 00:14:01,450
slight health care focus they have

299
00:13:58,570 --> 00:14:02,830
approximately 50,000 users and some of

300
00:14:01,450 --> 00:14:05,440
the biggest companies that use their

301
00:14:02,830 --> 00:14:09,270
product are Mercedes Benz young and the

302
00:14:05,440 --> 00:14:09,270
United Kingdom's National Health Service

303
00:14:10,050 --> 00:14:15,910
out of all the companies that we ended

304
00:14:13,240 --> 00:14:19,750
up testing little green button had the

305
00:14:15,910 --> 00:14:22,319
most complicated setup when you install

306
00:14:19,750 --> 00:14:25,360
the software multiple windows

307
00:14:22,320 --> 00:14:28,660
applications were installed but you

308
00:14:25,360 --> 00:14:32,080
wouldn't use most of them they also have

309
00:14:28,660 --> 00:14:34,420
and Android application and an optional

310
00:14:32,080 --> 00:14:36,490
physical button we did not test the

311
00:14:34,420 --> 00:14:41,920
physical button just for full disclosure

312
00:14:36,490 --> 00:14:43,510
and in order to configure and activate

313
00:14:41,920 --> 00:14:46,120
your account you would go to the

314
00:14:43,510 --> 00:14:49,060
management portal once everything was

315
00:14:46,120 --> 00:14:50,790
set up then you would have that green

316
00:14:49,060 --> 00:14:52,989
button in the corner of your screen

317
00:14:50,790 --> 00:14:56,500
which is the shortcut link to the

318
00:14:52,990 --> 00:14:58,510
application in order to create an alert

319
00:14:56,500 --> 00:15:03,130
all you would have to do is double click

320
00:14:58,510 --> 00:15:06,100
double click on that green button once

321
00:15:03,130 --> 00:15:09,160
an alert was made your fellow little

322
00:15:06,100 --> 00:15:11,590
green button users would receive that

323
00:15:09,160 --> 00:15:17,860
pop-up alert saying assistance is

324
00:15:11,590 --> 00:15:20,560
required by user so now it's time to get

325
00:15:17,860 --> 00:15:21,990
into a hypothetical example so we're

326
00:15:20,560 --> 00:15:25,390
gonna say in this case as a placeholder

327
00:15:21,990 --> 00:15:27,880
McDonald so say I'm really invested in

328
00:15:25,390 --> 00:15:30,310
finding out why McDonald's fries are so

329
00:15:27,880 --> 00:15:31,630
fabulous and I happen to look across

330
00:15:30,310 --> 00:15:33,550
some of the computers and I see that

331
00:15:31,630 --> 00:15:35,230
telltale green button because you can't

332
00:15:33,550 --> 00:15:38,859
really hide it has to stand screen at

333
00:15:35,230 --> 00:15:41,350
all times so the first thing that we

334
00:15:38,860 --> 00:15:43,870
want to find with this company is how to

335
00:15:41,350 --> 00:15:45,040
get access to their management website

336
00:15:43,870 --> 00:15:46,450
how to figure out what their

337
00:15:45,040 --> 00:15:47,130
configurations look like and everything

338
00:15:46,450 --> 00:15:49,330
like that

339
00:15:47,130 --> 00:15:50,560
we've known because we've done a little

340
00:15:49,330 --> 00:15:53,370
bit of testing

341
00:15:50,560 --> 00:15:56,800
that all you need to get to a specific

342
00:15:53,370 --> 00:15:59,110
accounts management website is this 14

343
00:15:56,800 --> 00:16:00,910
character key however as you can see

344
00:15:59,110 --> 00:16:02,950
from the picture here even though these

345
00:16:00,910 --> 00:16:05,250
four different sites were made at four

346
00:16:02,950 --> 00:16:10,990
separate times with separate information

347
00:16:05,250 --> 00:16:13,510
8 of the 14 characters are the same now

348
00:16:10,990 --> 00:16:15,010
it goes from being very difficult to

349
00:16:13,510 --> 00:16:16,870
figure out what this key would be to

350
00:16:15,010 --> 00:16:19,839
only having to brute-force those six

351
00:16:16,870 --> 00:16:22,029
uppercase and lowercase letters now

352
00:16:19,839 --> 00:16:25,900
this still does take at least not time

353
00:16:22,029 --> 00:16:28,390
but a little bit more than two and to

354
00:16:25,900 --> 00:16:29,920
enough billion tries but one attacker

355
00:16:28,390 --> 00:16:31,689
with one laptop going through these

356
00:16:29,920 --> 00:16:34,360
could find every single key in a year

357
00:16:31,690 --> 00:16:35,950
and a half say I enlists Amanda on this

358
00:16:34,360 --> 00:16:38,980
and her four laptops

359
00:16:35,950 --> 00:16:40,810
and now it's kind of trivial to figure

360
00:16:38,980 --> 00:16:42,670
out all these different keys and if we

361
00:16:40,810 --> 00:16:47,069
get lucky we'll find McDonald's key

362
00:16:42,670 --> 00:16:50,699
pretty early now that we've found

363
00:16:47,070 --> 00:16:54,700
McDonald's key and we have access to

364
00:16:50,700 --> 00:16:56,220
what will be their management site now

365
00:16:54,700 --> 00:16:59,320
we get to have a little bit of fun as

366
00:16:56,220 --> 00:17:02,380
you can see here we're going to be

367
00:16:59,320 --> 00:17:04,390
logged in logging in to what's our demo

368
00:17:02,380 --> 00:17:07,030
little green fund management site again

369
00:17:04,390 --> 00:17:08,439
we made some different accounts to test

370
00:17:07,030 --> 00:17:11,109
things to make sure okay we know how

371
00:17:08,439 --> 00:17:13,079
this works now this is going to be in

372
00:17:11,109 --> 00:17:15,790
this case our examples McDonald's is

373
00:17:13,079 --> 00:17:17,560
okay they haven't actually done a lot of

374
00:17:15,790 --> 00:17:19,000
things they actually haven't requested

375
00:17:17,560 --> 00:17:20,169
their password so hypothetically we

376
00:17:19,000 --> 00:17:22,540
shouldn't be able to log in or do

377
00:17:20,170 --> 00:17:26,020
anything with them now we're going back

378
00:17:22,540 --> 00:17:28,030
to our demo account that we've made we

379
00:17:26,020 --> 00:17:31,360
know all the credentials for we know the

380
00:17:28,030 --> 00:17:34,750
password and everything and we're going

381
00:17:31,360 --> 00:17:36,850
to go ahead and log into that so now all

382
00:17:34,750 --> 00:17:39,460
those previously greyed out things are

383
00:17:36,850 --> 00:17:42,399
green and we can do anything with our

384
00:17:39,460 --> 00:17:45,340
configuration but what we care about is

385
00:17:42,400 --> 00:17:48,660
going back to McDonald's and now as you

386
00:17:45,340 --> 00:17:52,560
can see all you have to do is refresh

387
00:17:48,660 --> 00:17:55,870
that page now we have full access to

388
00:17:52,560 --> 00:17:58,419
McDonald's site without having to know

389
00:17:55,870 --> 00:18:00,699
the password it even still says we're

390
00:17:58,420 --> 00:18:02,410
logged in as our user for our demo

391
00:18:00,700 --> 00:18:04,360
account but we still have access to

392
00:18:02,410 --> 00:18:11,890
change the configuration information

393
00:18:04,360 --> 00:18:16,178
without ever needing a password alright

394
00:18:11,890 --> 00:18:19,120
so keep in mind up to this point we know

395
00:18:16,179 --> 00:18:21,490
with confidence that McDonald's is using

396
00:18:19,120 --> 00:18:24,520
little green button and we even know

397
00:18:21,490 --> 00:18:27,040
what their side ideas naturally as the

398
00:18:24,520 --> 00:18:28,660
attackers Hannah and I are gonna do some

399
00:18:27,040 --> 00:18:31,330
recon on the product

400
00:18:28,660 --> 00:18:34,929
this might include us creating a fake

401
00:18:31,330 --> 00:18:37,570
account like you saw in the demo we're

402
00:18:34,929 --> 00:18:39,790
gonna use this fake account to map out

403
00:18:37,570 --> 00:18:42,730
the website and monitor the normal

404
00:18:39,790 --> 00:18:45,850
functionality doing so would lead us to

405
00:18:42,730 --> 00:18:49,120
see multiple requests to config that

406
00:18:45,850 --> 00:18:53,879
little green button comm along with our

407
00:18:49,120 --> 00:18:53,879
site ID so let's check it out

408
00:18:54,510 --> 00:19:02,770
all right so here's our file as you can

409
00:18:59,559 --> 00:19:05,080
see it includes all of our network

410
00:19:02,770 --> 00:19:07,990
information what poor little green

411
00:19:05,080 --> 00:19:11,590
button is hosted on and a bunch of

412
00:19:07,990 --> 00:19:14,440
personal information every location you

413
00:19:11,590 --> 00:19:18,370
have configured is shown along with your

414
00:19:14,440 --> 00:19:21,760
group ID and name coordinates and

415
00:19:18,370 --> 00:19:24,639
telephone numbers keep in mind that this

416
00:19:21,760 --> 00:19:28,059
is for every single location that's

417
00:19:24,640 --> 00:19:31,000
associated with your account so if we

418
00:19:28,059 --> 00:19:33,970
found the configuration site specific to

419
00:19:31,000 --> 00:19:36,540
McDonald's we would have every single

420
00:19:33,970 --> 00:19:40,080
location that uses little green button

421
00:19:36,540 --> 00:19:43,928
along with employee information and

422
00:19:40,080 --> 00:19:46,659
network information and even worse as

423
00:19:43,929 --> 00:19:50,110
you guys can see we have a directory

424
00:19:46,660 --> 00:19:53,350
list that contains all previous versions

425
00:19:50,110 --> 00:19:55,689
of our site configuration as well so not

426
00:19:53,350 --> 00:19:59,020
only do we have the current employee

427
00:19:55,690 --> 00:20:04,020
information but we have information on

428
00:19:59,020 --> 00:20:04,020
all of the employees to ever work there

429
00:20:05,700 --> 00:20:16,120
and so up to this point we've done recon

430
00:20:12,490 --> 00:20:17,340
on the website side but what about the

431
00:20:16,120 --> 00:20:20,229
Windows software

432
00:20:17,340 --> 00:20:23,139
if we're targeting a company where

433
00:20:20,230 --> 00:20:26,080
employees will most likely not have

434
00:20:23,140 --> 00:20:28,030
company phones investigating the

435
00:20:26,080 --> 00:20:32,620
software that would be available on

436
00:20:28,030 --> 00:20:35,139
Windows make sense similar to all the

437
00:20:32,620 --> 00:20:37,809
web stuff we need to understand the

438
00:20:35,140 --> 00:20:42,580
application and get that normal

439
00:20:37,809 --> 00:20:45,549
functionality so for this you I

440
00:20:42,580 --> 00:20:49,449
typically use proc line as one of my key

441
00:20:45,549 --> 00:20:52,360
tools and as I mentioned earlier little

442
00:20:49,450 --> 00:20:55,809
green button is decently complex and

443
00:20:52,360 --> 00:20:58,750
they installed multiple executables onto

444
00:20:55,809 --> 00:21:01,750
our system all of which made the mistake

445
00:20:58,750 --> 00:21:07,059
of referencing dll's that did not exist

446
00:21:01,750 --> 00:21:10,330
so we know that it's missing some stuff

447
00:21:07,059 --> 00:21:16,450
what can we do well we can generate our

448
00:21:10,330 --> 00:21:18,189
own DLL or we can create our own however

449
00:21:16,450 --> 00:21:22,150
you want to do it there are tools like

450
00:21:18,190 --> 00:21:27,010
noticably that you can use to make the

451
00:21:22,150 --> 00:21:29,740
process smoother so we've made the DLL

452
00:21:27,010 --> 00:21:34,179
now we have to get it onto the victim

453
00:21:29,740 --> 00:21:35,650
system in order for this to work and for

454
00:21:34,179 --> 00:21:39,970
this we're in a pretty unique situation

455
00:21:35,650 --> 00:21:41,890
where we have a lot of information on

456
00:21:39,970 --> 00:21:46,870
the employees from the configuration

457
00:21:41,890 --> 00:21:48,490
files so if we use that information we

458
00:21:46,870 --> 00:21:51,699
kind of have two golden ticket for a

459
00:21:48,490 --> 00:21:54,850
phishing attack let's assume that we

460
00:21:51,700 --> 00:21:58,660
were successful and the poor employee

461
00:21:54,850 --> 00:22:00,370
downloads our DLL and next time that

462
00:21:58,660 --> 00:22:03,419
they start up little green button our

463
00:22:00,370 --> 00:22:07,389
DLL is successfully loaded in now

464
00:22:03,419 --> 00:22:10,179
depending on the attackers intentions a

465
00:22:07,390 --> 00:22:14,220
lot can be done here the first time we

466
00:22:10,179 --> 00:22:18,520
tested this we used medically and

467
00:22:14,220 --> 00:22:21,580
started Reverse CCP handlers and we got

468
00:22:18,520 --> 00:22:23,040
an alarming amount of over shells onto

469
00:22:21,580 --> 00:22:26,439
the box

470
00:22:23,040 --> 00:22:29,779
in fact this DLL ended up being

471
00:22:26,440 --> 00:22:32,029
referenced so many times that it

472
00:22:29,779 --> 00:22:35,690
the application rendering them

473
00:22:32,029 --> 00:22:39,499
completely useless once the DLL is

474
00:22:35,690 --> 00:22:42,529
loaded a person can't trigger any panic

475
00:22:39,499 --> 00:22:44,210
alerts they can't silence any alerts in

476
00:22:42,529 --> 00:22:48,169
fact they can't even view the

477
00:22:44,210 --> 00:22:50,899
application so that's bad right we were

478
00:22:48,169 --> 00:22:52,519
essentially handed a loaded gun by

479
00:22:50,899 --> 00:22:58,459
having access to the company's

480
00:22:52,519 --> 00:23:00,679
configuration file now we realize we

481
00:22:58,460 --> 00:23:03,049
went back to config that little green

482
00:23:00,679 --> 00:23:07,359
button calm which is an HTTP website and

483
00:23:03,049 --> 00:23:09,950
we realized that it's not just that one

484
00:23:07,359 --> 00:23:13,220
configuration file that folder we found

485
00:23:09,950 --> 00:23:15,679
but it's every single configuration

486
00:23:13,220 --> 00:23:18,109
folder for every single company that's

487
00:23:15,679 --> 00:23:20,419
using little green button is publicly

488
00:23:18,109 --> 00:23:24,559
available on an HTTP website with no

489
00:23:20,419 --> 00:23:27,470
authentication yeah and keep in mind

490
00:23:24,559 --> 00:23:30,019
that within each of these folders you're

491
00:23:27,470 --> 00:23:32,480
going to have information on every

492
00:23:30,019 --> 00:23:35,929
single location and every single

493
00:23:32,480 --> 00:23:40,330
employee imagine if you have your CEOs

494
00:23:35,929 --> 00:23:43,879
location in that's not good

495
00:23:40,330 --> 00:23:50,389
but I mean this is kind of like the grub

496
00:23:43,879 --> 00:23:52,039
hub of config files no you choose a lot

497
00:23:50,389 --> 00:23:54,109
of different options here to exploit

498
00:23:52,039 --> 00:24:00,230
with those folders we talked about

499
00:23:54,109 --> 00:24:03,799
earlier so we've accomplished our goals

500
00:24:00,230 --> 00:24:07,340
for little green button so time to move

501
00:24:03,799 --> 00:24:11,450
on to our final company which is

502
00:24:07,340 --> 00:24:14,570
community response systems or CRS they

503
00:24:11,450 --> 00:24:17,570
are a united states-based products with

504
00:24:14,570 --> 00:24:21,939
north american clientele they are used

505
00:24:17,570 --> 00:24:25,580
by hundreds of companies primarily in

506
00:24:21,940 --> 00:24:28,460
government and education so a couple

507
00:24:25,580 --> 00:24:31,059
examples are think guard and the Indiana

508
00:24:28,460 --> 00:24:34,429
Wesleyan University

509
00:24:31,059 --> 00:24:36,220
so CRS works a little bit different than

510
00:24:34,429 --> 00:24:39,559
some of the other products we tested

511
00:24:36,220 --> 00:24:42,409
Cirrus actually has a local server so

512
00:24:39,559 --> 00:24:43,460
one of the computers in your company

513
00:24:42,409 --> 00:24:46,429
actually has to be the

514
00:24:43,460 --> 00:24:49,100
server location and from there all the

515
00:24:46,429 --> 00:24:51,200
other clients will connect to that and

516
00:24:49,100 --> 00:24:53,059
each of those clients is called CRS

517
00:24:51,200 --> 00:24:55,970
notify and you can see those on the

518
00:24:53,059 --> 00:24:57,799
bottom right with CRS you have separate

519
00:24:55,970 --> 00:24:59,330
options for a low panic alert or a high

520
00:24:57,799 --> 00:25:01,549
panic alert depending on what the

521
00:24:59,330 --> 00:25:03,620
scenario is and with each one of those

522
00:25:01,549 --> 00:25:05,770
you can see a lot of information about

523
00:25:03,620 --> 00:25:08,178
it from that CRS notify application

524
00:25:05,770 --> 00:25:10,520
including who started it what the

525
00:25:08,179 --> 00:25:12,020
location is and what time and then you

526
00:25:10,520 --> 00:25:13,429
can also reply to that and give more

527
00:25:12,020 --> 00:25:16,429
information or say what's going on

528
00:25:13,429 --> 00:25:19,250
however the only place you can actually

529
00:25:16,429 --> 00:25:21,080
stop a panic alert for CRS is using the

530
00:25:19,250 --> 00:25:23,149
management portal website so you

531
00:25:21,080 --> 00:25:25,850
actually the log in to that to be able

532
00:25:23,149 --> 00:25:28,010
to stop any panic alert that's going on

533
00:25:25,850 --> 00:25:30,918
and you can also use that to configure

534
00:25:28,010 --> 00:25:34,549
additional users and to adjust different

535
00:25:30,919 --> 00:25:36,470
settings worth noting here CRS also had

536
00:25:34,549 --> 00:25:42,020
physical panic buttons we were not able

537
00:25:36,470 --> 00:25:46,130
to test those for this research alright

538
00:25:42,020 --> 00:25:48,770
so up to this point it's been a proper

539
00:25:46,130 --> 00:25:49,940
day trip for Hannah and I we had some

540
00:25:48,770 --> 00:25:53,210
coffee at Starbucks

541
00:25:49,940 --> 00:25:54,740
we did some accounts went to McDonald's

542
00:25:53,210 --> 00:25:57,350
ate chicken nuggets

543
00:25:54,740 --> 00:26:01,210
rendered an application entirely useless

544
00:25:57,350 --> 00:26:04,000
right this next one means a lot to us

545
00:26:01,210 --> 00:26:06,100
we've been thinking about the next

546
00:26:04,000 --> 00:26:11,480
company for a little while

547
00:26:06,100 --> 00:26:15,168
Home Depot now we knew that Home Depot

548
00:26:11,480 --> 00:26:17,480
would be using a panic button so at

549
00:26:15,169 --> 00:26:21,260
first we try little green button because

550
00:26:17,480 --> 00:26:26,029
we already know a viable attack method

551
00:26:21,260 --> 00:26:29,299
for them but no dice doesn't work so we

552
00:26:26,029 --> 00:26:31,970
move on to our next contender CRS we

553
00:26:29,299 --> 00:26:35,990
happen to know this little problem with

554
00:26:31,970 --> 00:26:39,140
CRS called user enumeration as you can

555
00:26:35,990 --> 00:26:42,740
see in the slides Cirrus will give us a

556
00:26:39,140 --> 00:26:45,500
different URL when we try to give an

557
00:26:42,740 --> 00:26:47,330
invalid user name versus when we give a

558
00:26:45,500 --> 00:26:51,020
valid user name and an incorrect

559
00:26:47,330 --> 00:26:53,809
password so we can leverage this to find

560
00:26:51,020 --> 00:26:55,270
out if Home Depot is using CRS or not

561
00:26:53,809 --> 00:26:57,850
just by looking at you

562
00:26:55,270 --> 00:27:03,790
that were receiving back and what do you

563
00:26:57,850 --> 00:27:06,760
know they are so we decide in this

564
00:27:03,790 --> 00:27:09,670
fictional scenario to continue to go

565
00:27:06,760 --> 00:27:12,400
after own people and since we know a

566
00:27:09,670 --> 00:27:15,790
valid email that is associated with

567
00:27:12,400 --> 00:27:17,130
someone using this product we decide to

568
00:27:15,790 --> 00:27:20,649
fish them and see if they happen to have

569
00:27:17,130 --> 00:27:22,300
this email that every user when they

570
00:27:20,650 --> 00:27:23,950
start setting up their account for this

571
00:27:22,300 --> 00:27:25,810
product do they get us email similar to

572
00:27:23,950 --> 00:27:28,360
this with the username and the password

573
00:27:25,810 --> 00:27:30,399
in plain text or sang out an email and

574
00:27:28,360 --> 00:27:32,949
also telling you conveniently where you

575
00:27:30,400 --> 00:27:38,050
can go ahead to login to your management

576
00:27:32,950 --> 00:27:40,990
portal we were hoping and this fictional

577
00:27:38,050 --> 00:27:43,000
scenario we were hoping that maybe Home

578
00:27:40,990 --> 00:27:45,460
Depot will just keep the their

579
00:27:43,000 --> 00:27:47,260
credentials the same and we wouldn't

580
00:27:45,460 --> 00:27:48,880
have to do anything we would just be

581
00:27:47,260 --> 00:27:51,430
able to login with the creds we found

582
00:27:48,880 --> 00:27:53,650
here however unfortunately say that's

583
00:27:51,430 --> 00:27:55,540
not the case say we don't have any left

584
00:27:53,650 --> 00:27:56,800
on this front and we have to turn to

585
00:27:55,540 --> 00:27:59,139
something else to be able to get

586
00:27:56,800 --> 00:28:03,790
credentials to log into their management

587
00:27:59,140 --> 00:28:06,100
portal that's we're intercepting traffic

588
00:28:03,790 --> 00:28:08,379
comes in the next way that you could

589
00:28:06,100 --> 00:28:10,120
possibly get credentials is if a low

590
00:28:08,380 --> 00:28:12,670
privilege user tries to change their

591
00:28:10,120 --> 00:28:14,709
password when a low privilege user

592
00:28:12,670 --> 00:28:17,530
changes their password all the

593
00:28:14,710 --> 00:28:20,860
information that they're changing goes

594
00:28:17,530 --> 00:28:22,060
in the URL so if they're if they are

595
00:28:20,860 --> 00:28:24,010
just changing their password from

596
00:28:22,060 --> 00:28:25,330
lowercase password to uppercase password

597
00:28:24,010 --> 00:28:27,550
and we happen to intercept that as it

598
00:28:25,330 --> 00:28:29,110
happens congratulations now we know the

599
00:28:27,550 --> 00:28:31,570
email and password that associated with

600
00:28:29,110 --> 00:28:33,939
their CRS notify account we also happen

601
00:28:31,570 --> 00:28:36,010
to know some information about them full

602
00:28:33,940 --> 00:28:37,870
names those kind of things so now we

603
00:28:36,010 --> 00:28:39,520
have a lot more information and can

604
00:28:37,870 --> 00:28:43,320
leverage this against in this case on

605
00:28:39,520 --> 00:28:46,180
Deepa but maybe that's not the case

606
00:28:43,320 --> 00:28:47,470
there are some other inherent flaws with

607
00:28:46,180 --> 00:28:49,840
this product that could allow us to get

608
00:28:47,470 --> 00:28:53,770
credentials what you see right here is

609
00:28:49,840 --> 00:28:56,620
our CES CRS notify application so we're

610
00:28:53,770 --> 00:28:57,879
going to look at it here we have a lot

611
00:28:56,620 --> 00:29:01,360
of information there and you have that

612
00:28:57,880 --> 00:29:04,360
little logged in as you can and when you

613
00:29:01,360 --> 00:29:08,020
go ahead and click on logged in adds it

614
00:29:04,360 --> 00:29:08,678
goes ahead and it simply logs you in to

615
00:29:08,020 --> 00:29:11,200
your CRS

616
00:29:08,679 --> 00:29:13,029
notify that's the CRN's dashboard and

617
00:29:11,200 --> 00:29:14,499
this is very useful in the case that's

618
00:29:13,029 --> 00:29:15,909
trying to stop a panic alert you press

619
00:29:14,499 --> 00:29:18,970
the button to congratulations now you

620
00:29:15,909 --> 00:29:21,100
can go ahead and stop it however when

621
00:29:18,970 --> 00:29:23,320
you need to do that it goes ahead and

622
00:29:21,100 --> 00:29:25,360
sends a get request that has your

623
00:29:23,320 --> 00:29:27,970
username and password in the URL so if

624
00:29:25,360 --> 00:29:29,949
anyone tries to log into their notify

625
00:29:27,970 --> 00:29:32,019
account that way now we've accessed

626
00:29:29,950 --> 00:29:34,600
their credentials but maybe we haven't

627
00:29:32,019 --> 00:29:39,100
had any luck and that's where Amanda

628
00:29:34,600 --> 00:29:42,178
come son all right so as Hannah

629
00:29:39,100 --> 00:29:45,990
mentioned we haven't had any luck with

630
00:29:42,179 --> 00:29:49,929
using those means to get credentials so

631
00:29:45,990 --> 00:29:52,690
we're going to use unique experience

632
00:29:49,929 --> 00:29:56,019
that we've had with Home Depot fictional

633
00:29:52,690 --> 00:29:58,119
of course where every time we go in

634
00:29:56,019 --> 00:30:01,840
there's always at least one computer

635
00:29:58,119 --> 00:30:04,119
that is unlocked and unmanned we know

636
00:30:01,840 --> 00:30:07,480
this from our obviously extensive

637
00:30:04,119 --> 00:30:11,080
background in going to Home Depot so we

638
00:30:07,480 --> 00:30:16,539
decided to scope it out we want to see

639
00:30:11,080 --> 00:30:19,299
more about their usage of CRS but we get

640
00:30:16,539 --> 00:30:25,960
onto the computer just a normal guest

641
00:30:19,299 --> 00:30:29,860
account no fun right well CRS actually

642
00:30:25,960 --> 00:30:33,190
stores the username password and server

643
00:30:29,860 --> 00:30:35,619
IP for their server component of the

644
00:30:33,190 --> 00:30:40,600
software within the local machine five

645
00:30:35,619 --> 00:30:43,029
of the registry so now we have valid

646
00:30:40,600 --> 00:30:46,418
credentials on a guest account that has

647
00:30:43,029 --> 00:30:47,950
never even touched CRS but what if we

648
00:30:46,419 --> 00:30:54,639
want more what if we think that there

649
00:30:47,950 --> 00:31:00,220
are potentially more users now we start

650
00:30:54,639 --> 00:31:03,850
digging around within the AppData in the

651
00:31:00,220 --> 00:31:06,190
local directory there are files called

652
00:31:03,850 --> 00:31:09,789
user for both CRS server and CRS notify

653
00:31:06,190 --> 00:31:13,389
and in both of these the username and

654
00:31:09,789 --> 00:31:17,320
password are stored and then in the CRS

655
00:31:13,389 --> 00:31:20,498
server the server IP is also stored so

656
00:31:17,320 --> 00:31:22,610
this would potentially give us one more

657
00:31:20,499 --> 00:31:29,360
set of credentials to log into

658
00:31:22,610 --> 00:31:31,850
an employee's account or even worse so

659
00:31:29,360 --> 00:31:34,250
if you're keeping track that brings us

660
00:31:31,850 --> 00:31:36,830
to up to five separate ways that we

661
00:31:34,250 --> 00:31:39,799
could get credentials to login to CRS

662
00:31:36,830 --> 00:31:41,928
for this company first one it just

663
00:31:39,799 --> 00:31:43,519
didn't change the password from the one

664
00:31:41,929 --> 00:31:47,029
that was given from them and the

665
00:31:43,519 --> 00:31:49,279
registration email next if a low

666
00:31:47,029 --> 00:31:52,190
privilege user happens to change their

667
00:31:49,279 --> 00:31:54,740
password third if someone clicks on

668
00:31:52,190 --> 00:31:57,169
their name and the CRS notify

669
00:31:54,740 --> 00:31:59,600
application fourth by looking at the

670
00:31:57,169 --> 00:32:02,510
registry on a local account or tip in a

671
00:31:59,600 --> 00:32:05,360
file on a local machine and this is

672
00:32:02,510 --> 00:32:08,600
important because whenever you log in to

673
00:32:05,360 --> 00:32:11,479
CRS notify it the server sends you a

674
00:32:08,600 --> 00:32:13,309
bunch of information this information as

675
00:32:11,480 --> 00:32:15,409
you can see below it's completely

676
00:32:13,309 --> 00:32:17,870
unencrypted all this information sent in

677
00:32:15,409 --> 00:32:20,179
plaintext includes location ID the name

678
00:32:17,870 --> 00:32:21,469
the company address of the company phone

679
00:32:20,179 --> 00:32:23,750
number associated with it

680
00:32:21,470 --> 00:32:25,700
you have your admin user emails if

681
00:32:23,750 --> 00:32:28,909
anyone's getting text alerts from any

682
00:32:25,700 --> 00:32:30,950
sort of panic alert that's going on and

683
00:32:28,909 --> 00:32:34,580
then you also have for each of the users

684
00:32:30,950 --> 00:32:37,399
their information their hashed version

685
00:32:34,580 --> 00:32:39,168
of their cash password and also any

686
00:32:37,399 --> 00:32:41,678
phone numbers or location information

687
00:32:39,169 --> 00:32:44,090
its associated with them if we were

688
00:32:41,679 --> 00:32:46,100
invested and we have a lot of time we

689
00:32:44,090 --> 00:32:48,139
could go through and we could try to

690
00:32:46,100 --> 00:32:49,789
figure out what those passwords were

691
00:32:48,139 --> 00:32:52,580
however since we've already found those

692
00:32:49,789 --> 00:32:58,639
and that's not necessary for some of the

693
00:32:52,580 --> 00:33:01,250
fun that we're about to have so let's

694
00:32:58,639 --> 00:33:04,129
get down to it you want live the panic

695
00:33:01,250 --> 00:33:05,570
button system we always were trying to

696
00:33:04,130 --> 00:33:07,940
figure out what's each of them how does

697
00:33:05,570 --> 00:33:09,710
a panic alert work and with CRS as we've

698
00:33:07,940 --> 00:33:12,440
mentioned you go to the management

699
00:33:09,710 --> 00:33:14,029
portal you click you go there and in

700
00:33:12,440 --> 00:33:15,919
this case it says you can see at the top

701
00:33:14,029 --> 00:33:17,860
there's that end alert button so we

702
00:33:15,919 --> 00:33:20,919
press that button easy enough

703
00:33:17,860 --> 00:33:24,559
congratulations now we've ended an alert

704
00:33:20,919 --> 00:33:28,100
we found out really quickly that all it

705
00:33:24,559 --> 00:33:30,230
is is just visiting that URL and that's

706
00:33:28,100 --> 00:33:32,899
all you have to do you end a low or a

707
00:33:30,230 --> 00:33:36,200
high level alert as you can see from

708
00:33:32,899 --> 00:33:39,709
this request there but how does the

709
00:33:36,200 --> 00:33:45,409
tie back to our attack on hypothetically

710
00:33:39,710 --> 00:33:47,840
Home Depot all right so I think I saw in

711
00:33:45,409 --> 00:33:50,000
the last slide in order to stop that

712
00:33:47,840 --> 00:33:53,139
panic alert you just have to go to that

713
00:33:50,000 --> 00:33:56,779
URL where you're identified by the

714
00:33:53,139 --> 00:34:00,350
parameter Luke ID also known as your

715
00:33:56,779 --> 00:34:03,139
location ID each location ID is

716
00:34:00,350 --> 00:34:06,860
associated with a specific account so

717
00:34:03,139 --> 00:34:09,199
the URL that's used to stop any panic

718
00:34:06,860 --> 00:34:12,679
alert is the same every single time

719
00:34:09,199 --> 00:34:14,779
except for your location ID there is no

720
00:34:12,679 --> 00:34:18,560
login or authentication required

721
00:34:14,780 --> 00:34:21,740
involved in this process so you have the

722
00:34:18,560 --> 00:34:24,259
ability to stop any alert that is

723
00:34:21,739 --> 00:34:28,939
happening just by providing a four

724
00:34:24,260 --> 00:34:32,419
number identifier going back to Home

725
00:34:28,940 --> 00:34:34,940
Depot we've established that we know

726
00:34:32,418 --> 00:34:37,040
they're using CRS and just by sniffing

727
00:34:34,940 --> 00:34:41,300
their traffic or through what our other

728
00:34:37,040 --> 00:34:44,210
means we have their location ID if I

729
00:34:41,300 --> 00:34:48,649
were to go into Home Depot and start

730
00:34:44,210 --> 00:34:51,168
making a big scene about paint they gave

731
00:34:48,649 --> 00:34:54,109
us the wrong paint color very upset and

732
00:34:51,168 --> 00:34:57,200
I try to steal a bunch of paint buckets

733
00:34:54,109 --> 00:35:00,470
the natural assumption is that they

734
00:34:57,200 --> 00:35:03,560
would raise a panic alert however just

735
00:35:00,470 --> 00:35:06,680
by going to one URL how I can ensure

736
00:35:03,560 --> 00:35:09,200
that those security guards don't come

737
00:35:06,680 --> 00:35:12,759
running for me when I walk out with the

738
00:35:09,200 --> 00:35:17,419
stolen goods it's a relatively some

739
00:35:12,760 --> 00:35:20,359
silly example but the implications are

740
00:35:17,420 --> 00:35:23,540
there there are far away more serious

741
00:35:20,359 --> 00:35:26,180
situations where people are using these

742
00:35:23,540 --> 00:35:28,790
devices these products but with a

743
00:35:26,180 --> 00:35:32,419
serious of flaws as this they aren't

744
00:35:28,790 --> 00:35:35,210
reliable keep in mind keep all that in

745
00:35:32,420 --> 00:35:39,380
mind as we show you how simple it

746
00:35:35,210 --> 00:35:42,250
actually is okay so as you see here

747
00:35:39,380 --> 00:35:46,069
again we have our CRS notify product and

748
00:35:42,250 --> 00:35:48,470
we're gonna go ahead and create a high

749
00:35:46,069 --> 00:35:49,580
alert as you can see that alert state

750
00:35:48,470 --> 00:35:52,879
changes to high

751
00:35:49,580 --> 00:35:54,140
and now we're gonna go ahead and we're

752
00:35:52,880 --> 00:35:56,720
gonna do something super simple we're

753
00:35:54,140 --> 00:36:00,319
gonna go ahead and put that URL right

754
00:35:56,720 --> 00:36:02,180
there and we're gonna go ahead and go to

755
00:36:00,320 --> 00:36:04,940
it as you can see here the slope ID is a

756
00:36:02,180 --> 00:36:08,149
specific loci D that we've been trying

757
00:36:04,940 --> 00:36:09,920
to attack now we go to that website and

758
00:36:08,150 --> 00:36:12,080
as you can see on the CRS notify

759
00:36:09,920 --> 00:36:14,750
application an alert state is back to an

760
00:36:12,080 --> 00:36:16,790
active nothing happened and we weren't

761
00:36:14,750 --> 00:36:19,250
even logged in it prompts us here to log

762
00:36:16,790 --> 00:36:21,170
in so it's pretty simple as long as you

763
00:36:19,250 --> 00:36:26,570
know the look ID to stop any sort of

764
00:36:21,170 --> 00:36:29,150
active panic alert but let's take a step

765
00:36:26,570 --> 00:36:31,580
back on this one because CRS is the

766
00:36:29,150 --> 00:36:34,040
product that actually needs the least

767
00:36:31,580 --> 00:36:38,270
amount of information to be able to

768
00:36:34,040 --> 00:36:41,600
utilize it and to break it because say

769
00:36:38,270 --> 00:36:45,950
we didn't find out what Hobby Lobby or

770
00:36:41,600 --> 00:36:47,870
Home Depot's lokai D is and instead we

771
00:36:45,950 --> 00:36:50,029
have no clue but we saw that they're

772
00:36:47,870 --> 00:36:53,390
using the product and we want to do some

773
00:36:50,030 --> 00:36:55,460
sort of attack something serious all

774
00:36:53,390 --> 00:36:58,670
we'd have to do is go through and script

775
00:36:55,460 --> 00:37:01,550
to go ahead and toggle with every single

776
00:36:58,670 --> 00:37:02,930
look I'd be starting at the lowest

777
00:37:01,550 --> 00:37:05,750
number and going to however high we

778
00:37:02,930 --> 00:37:08,060
think they might be and we would stop

779
00:37:05,750 --> 00:37:10,010
any active alert without having to know

780
00:37:08,060 --> 00:37:13,310
any information just knowing they have

781
00:37:10,010 --> 00:37:14,840
CRS we can get around this it's pretty

782
00:37:13,310 --> 00:37:17,210
simple and it's pretty concerning that a

783
00:37:14,840 --> 00:37:19,820
product like this is this easy to

784
00:37:17,210 --> 00:37:27,080
circumvent the entire goal of the

785
00:37:19,820 --> 00:37:30,350
product alright so hopefully you guys

786
00:37:27,080 --> 00:37:33,440
get the vibe that there are a lot of

787
00:37:30,350 --> 00:37:36,259
problems with these products as I know

788
00:37:33,440 --> 00:37:39,740
we did responsibly disclose to the

789
00:37:36,260 --> 00:37:42,320
respective companies but even just with

790
00:37:39,740 --> 00:37:46,250
our findings we barely scratched the

791
00:37:42,320 --> 00:37:48,530
surface of this untested industry we had

792
00:37:46,250 --> 00:37:51,200
a very limited amount of time to

793
00:37:48,530 --> 00:37:53,750
complete our research and we only tested

794
00:37:51,200 --> 00:37:58,730
three different products and even just

795
00:37:53,750 --> 00:38:00,410
with that what we found was alarming we

796
00:37:58,730 --> 00:38:01,970
took you through a bunch of fictional

797
00:38:00,410 --> 00:38:03,220
scenarios none of the companies that we

798
00:38:01,970 --> 00:38:07,000
mentioned at any point

799
00:38:03,220 --> 00:38:09,339
that in our attack scenarios we know our

800
00:38:07,000 --> 00:38:10,990
using any panic button product but we

801
00:38:09,340 --> 00:38:13,000
showed you that there are critical

802
00:38:10,990 --> 00:38:14,680
service cyber security issues and

803
00:38:13,000 --> 00:38:16,720
products are intended to keep people

804
00:38:14,680 --> 00:38:20,140
safe the very thing that's supposed to

805
00:38:16,720 --> 00:38:23,439
help them is actually opening them up to

806
00:38:20,140 --> 00:38:27,009
wider a wider attack surface silent

807
00:38:23,440 --> 00:38:29,800
beacon now we could get we could delete

808
00:38:27,010 --> 00:38:32,619
all these accounts we can create a panic

809
00:38:29,800 --> 00:38:34,510
apocalypse with a little green button we

810
00:38:32,619 --> 00:38:36,580
now know all this information about

811
00:38:34,510 --> 00:38:37,960
every company that's using will the

812
00:38:36,580 --> 00:38:39,640
green button all that configuration

813
00:38:37,960 --> 00:38:40,810
information with no authentication

814
00:38:39,640 --> 00:38:44,140
whatsoever

815
00:38:40,810 --> 00:38:45,670
and we have the ability to get a reverse

816
00:38:44,140 --> 00:38:48,520
shell on any computer that's using

817
00:38:45,670 --> 00:38:51,190
little button then we come to CRS where

818
00:38:48,520 --> 00:38:52,960
now we can stop any sort of active panic

819
00:38:51,190 --> 00:38:54,640
alert for any product without having to

820
00:38:52,960 --> 00:38:58,180
know any information except for that

821
00:38:54,640 --> 00:39:01,060
specific URL these products were not

822
00:38:58,180 --> 00:39:03,009
made with safe with security in mind

823
00:39:01,060 --> 00:39:04,540
just in the thought of we can make a

824
00:39:03,010 --> 00:39:09,040
panic product we can try to keep people

825
00:39:04,540 --> 00:39:10,630
safe but by trying to add more safety

826
00:39:09,040 --> 00:39:13,810
they're actually just opening themselves

827
00:39:10,630 --> 00:39:16,480
up to greater risk and that's really

828
00:39:13,810 --> 00:39:18,970
unfortunate especially because this is

829
00:39:16,480 --> 00:39:22,300
just one test of three of the panic

830
00:39:18,970 --> 00:39:24,459
button products there are so many other

831
00:39:22,300 --> 00:39:26,020
items in the panic one mystery so many

832
00:39:24,460 --> 00:39:27,700
other systems that we have not tested

833
00:39:26,020 --> 00:39:34,950
that are probably just as insecure as

834
00:39:27,700 --> 00:39:34,950
this any questions

835
00:39:41,120 --> 00:39:47,430
and could we get those questions in chat

836
00:39:44,360 --> 00:39:50,640
I don't have that we possible

837
00:39:47,430 --> 00:39:50,640
[Music]

