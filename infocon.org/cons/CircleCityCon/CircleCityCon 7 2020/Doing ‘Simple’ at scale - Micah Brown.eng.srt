1
00:00:00,030 --> 00:00:05,609
the CIA s top or the first six CIS top

2
00:00:03,330 --> 00:00:08,550
20 controls using an open-source free

3
00:00:05,609 --> 00:00:09,750
source and self home-built tools with

4
00:00:08,550 --> 00:00:11,910
that being said before we get started

5
00:00:09,750 --> 00:00:15,420
I'd like to thank everyone involved with

6
00:00:11,910 --> 00:00:18,330
Circle City Con from the volunteers to

7
00:00:15,420 --> 00:00:21,000
the organizers to the sponsors and to

8
00:00:18,330 --> 00:00:22,528
you the attendees Circle City Con has

9
00:00:21,000 --> 00:00:25,920
meant a lot to me both professionally

10
00:00:22,529 --> 00:00:28,529
and personally over the years Who am I

11
00:00:25,920 --> 00:00:32,219
I'm Micah K Brown by day I go through

12
00:00:28,529 --> 00:00:34,590
and I am an IT security engineer for a

13
00:00:32,219 --> 00:00:36,870
very large global insurance organization

14
00:00:34,590 --> 00:00:39,090
by night I go through and I volunteer

15
00:00:36,870 --> 00:00:41,280
with the Greater Cincinnati Issa you

16
00:00:39,090 --> 00:00:43,980
might know me by some of my other talks

17
00:00:41,280 --> 00:00:45,890
which are all available free and open

18
00:00:43,980 --> 00:00:48,629
source right there on my github account

19
00:00:45,890 --> 00:00:51,390
including this talk in the tools that

20
00:00:48,629 --> 00:00:54,210
I'm releasing today along with this talk

21
00:00:51,390 --> 00:00:56,579
and with that let's go ahead and get

22
00:00:54,210 --> 00:00:59,910
started one thing I do want to say is

23
00:00:56,579 --> 00:01:01,949
Cincinnati is a great city for IT

24
00:00:59,910 --> 00:01:04,319
security and IT professionals we have a

25
00:01:01,949 --> 00:01:05,939
lot of different groups that are within

26
00:01:04,319 --> 00:01:07,500
our organization that go through and

27
00:01:05,939 --> 00:01:09,330
work together to make your professional

28
00:01:07,500 --> 00:01:11,490
and personal life just a little bit

29
00:01:09,330 --> 00:01:13,200
easier if you ever are in our city we'd

30
00:01:11,490 --> 00:01:15,390
love to have you any and all of our

31
00:01:13,200 --> 00:01:16,920
event if you're not in Cincinnati I

32
00:01:15,390 --> 00:01:19,040
would challenge you go through and find

33
00:01:16,920 --> 00:01:22,110
those types of groups within your own

34
00:01:19,040 --> 00:01:24,720
now I'm getting started with control one

35
00:01:22,110 --> 00:01:27,090
inventory and control of hardware assets

36
00:01:24,720 --> 00:01:29,729
one of the hardest things that I have to

37
00:01:27,090 --> 00:01:32,400
do as a global enterprise is these

38
00:01:29,729 --> 00:01:35,310
simple tasks at scale and nowhere is

39
00:01:32,400 --> 00:01:38,009
this more typifies in terms of control

40
00:01:35,310 --> 00:01:40,020
number one and truthfully and rightfully

41
00:01:38,009 --> 00:01:43,380
so how can I is an IT security

42
00:01:40,020 --> 00:01:45,899
practitioner go through and how can I

43
00:01:43,380 --> 00:01:48,030
protect my organization how can I

44
00:01:45,899 --> 00:01:51,869
protect assets they have zero knowledge

45
00:01:48,030 --> 00:01:54,600
of so are two critical tasks go through

46
00:01:51,869 --> 00:01:57,930
and is to utilize an active discovery

47
00:01:54,600 --> 00:02:00,419
tool on our environment to define what

48
00:01:57,930 --> 00:02:02,700
we have out there in terms of compute

49
00:02:00,420 --> 00:02:05,700
resources then we need to go through and

50
00:02:02,700 --> 00:02:07,170
we need to document in a central

51
00:02:05,700 --> 00:02:09,348
location usually this is called a

52
00:02:07,170 --> 00:02:12,330
configuration management database or

53
00:02:09,348 --> 00:02:13,040
CMDB to go through and describe all of

54
00:02:12,330 --> 00:02:16,189
the assets

55
00:02:13,040 --> 00:02:17,689
we found so our first step is we need to

56
00:02:16,189 --> 00:02:19,670
go through and we need to define our

57
00:02:17,689 --> 00:02:21,500
environment I'm very old-school the

58
00:02:19,670 --> 00:02:23,780
first thing that I really love to do is

59
00:02:21,500 --> 00:02:27,250
to go and talk to procurement and I

60
00:02:23,780 --> 00:02:29,569
usually ask them what is your server

61
00:02:27,250 --> 00:02:30,859
retention timeframe and you know it

62
00:02:29,569 --> 00:02:32,390
might be three it might be five years I

63
00:02:30,859 --> 00:02:34,609
might ask them hey can you give me all

64
00:02:32,390 --> 00:02:36,409
of IT spend for the past five years past

65
00:02:34,609 --> 00:02:38,420
three years that way I can go through

66
00:02:36,409 --> 00:02:41,569
and get a ballpark idea of what I am

67
00:02:38,420 --> 00:02:44,030
expecting to find the second thing is I

68
00:02:41,569 --> 00:02:45,950
want to do active discovery for our

69
00:02:44,030 --> 00:02:47,900
compute assets be they servers network

70
00:02:45,950 --> 00:02:50,149
devices appliance even things in the

71
00:02:47,900 --> 00:02:53,030
cloud and me I came to IT security

72
00:02:50,150 --> 00:02:55,040
through a very traditional path for

73
00:02:53,030 --> 00:02:57,049
someone of my age group that means I

74
00:02:55,040 --> 00:02:58,548
started on the helpdesk then once I

75
00:02:57,049 --> 00:03:01,010
became too valuable there I moved over

76
00:02:58,549 --> 00:03:03,379
to a server admin once I became too

77
00:03:01,010 --> 00:03:05,480
valuable there I got upgraded into the

78
00:03:03,379 --> 00:03:08,629
networking team and finally made it over

79
00:03:05,480 --> 00:03:11,298
to IT security so for me when I start

80
00:03:08,629 --> 00:03:14,120
wanting to discover the environment I go

81
00:03:11,299 --> 00:03:15,980
to each site core router core switch and

82
00:03:14,120 --> 00:03:19,430
I just dump the routing table that's

83
00:03:15,980 --> 00:03:21,619
going to give you about 80 to 85% of all

84
00:03:19,430 --> 00:03:22,699
of your networks you're going to miss a

85
00:03:21,620 --> 00:03:24,440
couple things the things that you're

86
00:03:22,699 --> 00:03:27,260
going to miss is anything that follows

87
00:03:24,440 --> 00:03:28,819
the old zeros path out to the internet

88
00:03:27,260 --> 00:03:30,858
you're also going to miss air gapped

89
00:03:28,819 --> 00:03:33,379
environments which are very critical for

90
00:03:30,859 --> 00:03:35,419
us to go through and to do these tools

91
00:03:33,379 --> 00:03:38,840
tactics techniques to implement these

92
00:03:35,419 --> 00:03:40,250
controls on and then I take those lists

93
00:03:38,840 --> 00:03:43,430
of networks and I feed them into an

94
00:03:40,250 --> 00:03:45,919
active discovery tool for client systems

95
00:03:43,430 --> 00:03:49,370
for servers we usually have some sort of

96
00:03:45,919 --> 00:03:51,409
automated control tool so it might be

97
00:03:49,370 --> 00:03:54,440
Active Directory it might be free radius

98
00:03:51,409 --> 00:03:56,090
we might also have malware or client

99
00:03:54,440 --> 00:03:58,699
discovery tools or client package

100
00:03:56,090 --> 00:04:00,799
management tools I like to query all of

101
00:03:58,699 --> 00:04:03,709
those and compare them to make sure that

102
00:04:00,799 --> 00:04:06,709
they are tightly focused on relatively

103
00:04:03,709 --> 00:04:09,979
the same ideally the same scope of

104
00:04:06,709 --> 00:04:12,079
topics then for mobile systems in the

105
00:04:09,979 --> 00:04:15,379
way that I define mobile system is these

106
00:04:12,079 --> 00:04:18,168
are company-owned assets that are not

107
00:04:15,379 --> 00:04:20,358
that use non-standard images so in my

108
00:04:18,168 --> 00:04:23,000
environments that's things like phones

109
00:04:20,358 --> 00:04:25,760
that's tablet that's marketing that they

110
00:04:23,000 --> 00:04:26,870
want to have Mac's because Photoshop in

111
00:04:25,760 --> 00:04:29,570
this day and age runs

112
00:04:26,870 --> 00:04:32,389
better on Macs and finally bring your

113
00:04:29,570 --> 00:04:34,880
own device so likewise we want to be

114
00:04:32,389 --> 00:04:37,790
able to have a valid inventory of what

115
00:04:34,880 --> 00:04:39,710
non company owned assets we are getting

116
00:04:37,790 --> 00:04:41,930
access to parts of our environment and

117
00:04:39,710 --> 00:04:43,219
finally the results of all of this needs

118
00:04:41,930 --> 00:04:46,880
to be stored in a centralized location

119
00:04:43,220 --> 00:04:49,460
usually that's a CMDB so when it comes

120
00:04:46,880 --> 00:04:50,120
to actually performing the network

121
00:04:49,460 --> 00:04:52,729
discovery

122
00:04:50,120 --> 00:04:54,470
nmap is king it's a free open-source

123
00:04:52,729 --> 00:04:56,479
command-line scanner it's built into

124
00:04:54,470 --> 00:04:59,419
almost every version of Linux you can

125
00:04:56,479 --> 00:05:01,880
even install it on Windows and it pays

126
00:04:59,419 --> 00:05:04,639
off in spades it's very powerful very

127
00:05:01,880 --> 00:05:07,460
flexible however there was a point in my

128
00:05:04,639 --> 00:05:09,440
life where the command line was just a

129
00:05:07,460 --> 00:05:12,020
little bit intimidating and for those

130
00:05:09,440 --> 00:05:14,180
people that would rather have a GUI type

131
00:05:12,020 --> 00:05:16,760
of interface Zen map is for you

132
00:05:14,180 --> 00:05:19,190
Zen map is a graphical overlay built on

133
00:05:16,760 --> 00:05:21,830
top of in map what I love about it is a

134
00:05:19,190 --> 00:05:23,449
couple things first off as you build out

135
00:05:21,830 --> 00:05:26,419
your scan it's going to show you

136
00:05:23,449 --> 00:05:28,970
basically in a title bar right where or

137
00:05:26,419 --> 00:05:30,409
the exact syntax of the scan that it is

138
00:05:28,970 --> 00:05:33,770
eventually going to launch for you

139
00:05:30,410 --> 00:05:34,849
secondly when you finish a scan in Zen

140
00:05:33,770 --> 00:05:38,359
map you're going to get a couple

141
00:05:34,849 --> 00:05:40,370
graphical in or graphics of your network

142
00:05:38,360 --> 00:05:42,800
that it's going to proactively put out

143
00:05:40,370 --> 00:05:45,979
there for you and that is a huge win for

144
00:05:42,800 --> 00:05:48,020
many people and finally for those people

145
00:05:45,979 --> 00:05:50,210
that are not as comfortable with the in

146
00:05:48,020 --> 00:05:51,590
map output because trust me depending on

147
00:05:50,210 --> 00:05:54,469
what you're looking for it can be a

148
00:05:51,590 --> 00:05:57,830
little bit overwhelming it does do a

149
00:05:54,470 --> 00:06:00,949
great job of putting it into a GUI

150
00:05:57,830 --> 00:06:04,520
interface with each asset that you each

151
00:06:00,949 --> 00:06:05,930
compute asset that you find is or goes

152
00:06:04,520 --> 00:06:07,849
through and has a little icon you can

153
00:06:05,930 --> 00:06:10,820
drill into it and it makes reviewing

154
00:06:07,849 --> 00:06:12,830
that information very cool other types

155
00:06:10,820 --> 00:06:16,310
of scan engines that you can use

156
00:06:12,830 --> 00:06:18,948
alienvault OS I am open audit and open

157
00:06:16,310 --> 00:06:20,840
NSM so once we've gone through and we've

158
00:06:18,949 --> 00:06:23,570
done our scan I didn't like to go

159
00:06:20,840 --> 00:06:26,119
through and look at automating system

160
00:06:23,570 --> 00:06:29,750
discovery so here I'm looking for our

161
00:06:26,120 --> 00:06:32,990
things like our laptops our desktops our

162
00:06:29,750 --> 00:06:35,000
servers and anything else and I start

163
00:06:32,990 --> 00:06:37,490
out by going through and most of us have

164
00:06:35,000 --> 00:06:39,080
some centralized authentication in most

165
00:06:37,490 --> 00:06:40,610
places I find it to be Active Directory

166
00:06:39,080 --> 00:06:43,068
it could be something like a free

167
00:06:40,610 --> 00:06:46,099
radius server I just go there and I ask

168
00:06:43,069 --> 00:06:47,479
can you please spit out and since I'm an

169
00:06:46,099 --> 00:06:51,199
active directory shop I use PowerShell

170
00:06:47,479 --> 00:06:53,840
the the name the operating system the

171
00:06:51,199 --> 00:06:56,270
patch level and but one thing that I

172
00:06:53,840 --> 00:06:58,429
always ask for is last lock on attribute

173
00:06:56,270 --> 00:07:02,870
you see me as IT security practitioners

174
00:06:58,430 --> 00:07:05,150
we are really good when we have users

175
00:07:02,870 --> 00:07:08,509
enter and exit our organizations were

176
00:07:05,150 --> 00:07:11,628
really good about managing that user

177
00:07:08,509 --> 00:07:13,669
account however I find all too often we

178
00:07:11,629 --> 00:07:15,860
are not as good when it actually comes

179
00:07:13,669 --> 00:07:17,900
to managing our computer accounts and

180
00:07:15,860 --> 00:07:20,090
that can lead to several different

181
00:07:17,900 --> 00:07:22,789
issues down the road likewise as I said

182
00:07:20,090 --> 00:07:24,830
before I then like to go through and I

183
00:07:22,789 --> 00:07:26,840
like to look at our other shared control

184
00:07:24,830 --> 00:07:29,300
so you might go through and you have

185
00:07:26,840 --> 00:07:31,188
might have anti-malware you might have a

186
00:07:29,300 --> 00:07:33,770
package management management system you

187
00:07:31,189 --> 00:07:36,259
might have a patching system and I make

188
00:07:33,770 --> 00:07:38,060
sure that between all of those other

189
00:07:36,259 --> 00:07:41,240
control tools that they look to be well

190
00:07:38,060 --> 00:07:45,560
aligned to what your active and your

191
00:07:41,240 --> 00:07:48,379
production environment actually is next

192
00:07:45,560 --> 00:07:50,960
in helping us gain a little bit traction

193
00:07:48,379 --> 00:07:53,690
moving forward I'd like to go through

194
00:07:50,960 --> 00:07:55,159
and implement some pretty strong DHCP

195
00:07:53,690 --> 00:07:57,650
logging so I've gone through and

196
00:07:55,159 --> 00:08:00,620
provided a two knowledgebase articles

197
00:07:57,650 --> 00:08:03,620
one for Windows one for Linux but DHCP

198
00:08:00,620 --> 00:08:06,529
is what gives a client system coming on

199
00:08:03,620 --> 00:08:08,659
to your network it gives them an IP and

200
00:08:06,529 --> 00:08:12,080
allows them to connect without manual

201
00:08:08,659 --> 00:08:15,080
configuration next I like to look into

202
00:08:12,080 --> 00:08:17,359
802 One X authentication so this is an

203
00:08:15,080 --> 00:08:20,389
open source protocol that allows you to

204
00:08:17,360 --> 00:08:23,629
go through and enforce strong

205
00:08:20,389 --> 00:08:25,430
authentication when a client system when

206
00:08:23,629 --> 00:08:27,979
a system is logging on to the network

207
00:08:25,430 --> 00:08:31,099
and if you want to do this you have two

208
00:08:27,979 --> 00:08:32,990
great options is either a Windows NPS

209
00:08:31,099 --> 00:08:35,269
server role within your environment or

210
00:08:32,990 --> 00:08:39,680
you can use something like free radius

211
00:08:35,269 --> 00:08:42,049
with 802 dot 1x now you can go through

212
00:08:39,679 --> 00:08:45,109
any can bolster this with network access

213
00:08:42,049 --> 00:08:48,229
control so network access control or

214
00:08:45,110 --> 00:08:50,779
neck allows you to ask other security

215
00:08:48,230 --> 00:08:51,700
posturing questions when a system is

216
00:08:50,779 --> 00:08:54,010
attempting to log

217
00:08:51,700 --> 00:08:55,960
to your network so you can ask what's

218
00:08:54,010 --> 00:08:58,930
the OS what's the patch level you can

219
00:08:55,960 --> 00:09:00,760
ask that you have a B if so when it's

220
00:08:58,930 --> 00:09:02,979
the most recent antivirus signatures

221
00:09:00,760 --> 00:09:04,840
that you have but you can also ask

222
00:09:02,980 --> 00:09:06,400
things like can you please give me your

223
00:09:04,840 --> 00:09:09,910
certificate so you could go through and

224
00:09:06,400 --> 00:09:12,790
push out trusted internal certificates

225
00:09:09,910 --> 00:09:15,100
to your end systems and then querying

226
00:09:12,790 --> 00:09:16,930
for that type of certificate you can say

227
00:09:15,100 --> 00:09:19,900
yes this is a corporate asset or no it's

228
00:09:16,930 --> 00:09:22,239
not and if it is a corporate asset you

229
00:09:19,900 --> 00:09:25,319
could even go through and you could even

230
00:09:22,240 --> 00:09:28,570
ask what are the group memberships

231
00:09:25,320 --> 00:09:30,700
associated with this user account and

232
00:09:28,570 --> 00:09:33,610
when you do that that allows you to make

233
00:09:30,700 --> 00:09:35,740
some very strong decisions so Bob from

234
00:09:33,610 --> 00:09:38,260
accounting since he's on his corporate

235
00:09:35,740 --> 00:09:42,010
device he would be allowed on to the

236
00:09:38,260 --> 00:09:45,280
accounting VLAN Alice let's say she's an

237
00:09:42,010 --> 00:09:47,740
IT she would go to the ITV LAN but let's

238
00:09:45,280 --> 00:09:49,689
say Alice has somebody a guest coming

239
00:09:47,740 --> 00:09:50,770
into giving a presentation for her on

240
00:09:49,690 --> 00:09:53,380
the new technology

241
00:09:50,770 --> 00:09:56,170
well that laptop when it tries to hit

242
00:09:53,380 --> 00:09:57,670
wireless in an axe Ellucian it could go

243
00:09:56,170 --> 00:09:59,560
through and be sent directly to the

244
00:09:57,670 --> 00:10:01,540
guest Wireless VLAN so there's a lot of

245
00:09:59,560 --> 00:10:04,390
power in going through and having a

246
00:10:01,540 --> 00:10:07,689
well-tuned neck and there are some great

247
00:10:04,390 --> 00:10:09,610
free and open source so open neck free

248
00:10:07,690 --> 00:10:11,470
neck PAC events I played around with

249
00:10:09,610 --> 00:10:13,900
them and all of them seem to be pretty

250
00:10:11,470 --> 00:10:16,300
good however just like most of our

251
00:10:13,900 --> 00:10:20,610
controls that we have we have to realize

252
00:10:16,300 --> 00:10:23,199
that they are based on some very serious

253
00:10:20,610 --> 00:10:27,220
accounts as well as some pretty

254
00:10:23,200 --> 00:10:28,150
sensitive PKI cryptography keys so we

255
00:10:27,220 --> 00:10:32,020
need to make sure that we're protecting

256
00:10:28,150 --> 00:10:33,910
them appropriately step 4 I kind of

257
00:10:32,020 --> 00:10:36,640
combined mobile and BYOD once again

258
00:10:33,910 --> 00:10:39,969
mobile is company owned non-standard

259
00:10:36,640 --> 00:10:42,610
assets bring your own device BYOD that

260
00:10:39,970 --> 00:10:45,220
is assets that are owned by others now

261
00:10:42,610 --> 00:10:47,710
generally we use some sort of an MDM

262
00:10:45,220 --> 00:10:50,560
mobile device management on those

263
00:10:47,710 --> 00:10:54,200
systems and so we can simply go to the

264
00:10:50,560 --> 00:10:56,479
MDM and we can just ask for a report

265
00:10:54,200 --> 00:10:58,579
in some instances I've seen an

266
00:10:56,480 --> 00:11:02,110
organization go through and to use a

267
00:10:58,579 --> 00:11:05,510
single unified MDM across the entire

268
00:11:02,110 --> 00:11:08,930
organization in other instances I've

269
00:11:05,510 --> 00:11:10,910
seen two versions of the same MDM one

270
00:11:08,930 --> 00:11:14,719
for more of the company owned assets

271
00:11:10,910 --> 00:11:18,380
mobiles as I call them and one BYOD for

272
00:11:14,720 --> 00:11:20,149
other lis owned assets now other

273
00:11:18,380 --> 00:11:21,829
companies that I've partnered with I've

274
00:11:20,149 --> 00:11:23,990
worked with they actually have two

275
00:11:21,829 --> 00:11:27,170
separate vendors once again this is up

276
00:11:23,990 --> 00:11:30,050
to you it's all up to what you are

277
00:11:27,170 --> 00:11:32,569
looking to do with it your use cases but

278
00:11:30,050 --> 00:11:35,089
just remember that the mDM's can give

279
00:11:32,570 --> 00:11:37,339
you a lot of it or a lot of real-time

280
00:11:35,089 --> 00:11:40,130
accounting on what systems are

281
00:11:37,339 --> 00:11:41,779
connecting through those ways and we

282
00:11:40,130 --> 00:11:44,089
probably should go through and make sure

283
00:11:41,779 --> 00:11:45,589
that we are pruning devices at an

284
00:11:44,089 --> 00:11:47,990
appropriate level if they've been

285
00:11:45,589 --> 00:11:49,610
inactive say for over three months over

286
00:11:47,990 --> 00:11:52,670
six months whatever you as an

287
00:11:49,610 --> 00:11:54,470
organization believe finally we need to

288
00:11:52,670 --> 00:11:56,779
take all of that information and we need

289
00:11:54,470 --> 00:11:58,519
to put it in a centralized location so

290
00:11:56,779 --> 00:12:02,810
our configuration management database or

291
00:11:58,519 --> 00:12:05,329
CMDB for many small shops you can get

292
00:12:02,810 --> 00:12:08,239
away with having a flat office type of

293
00:12:05,329 --> 00:12:10,069
document I strongly advise against it it

294
00:12:08,240 --> 00:12:13,160
really goes through and starts to fail

295
00:12:10,070 --> 00:12:14,810
at scale quite quickly but that is an

296
00:12:13,160 --> 00:12:17,660
option that you can go through and you

297
00:12:14,810 --> 00:12:20,959
can use like my services like Spiceworks

298
00:12:17,660 --> 00:12:22,880
they will give you a free CMDB out in

299
00:12:20,959 --> 00:12:25,760
their cloud on their web servers and

300
00:12:22,880 --> 00:12:29,329
that's great however they do go through

301
00:12:25,760 --> 00:12:32,990
they do review what you put in there and

302
00:12:29,329 --> 00:12:34,729
then they target you they monetize and

303
00:12:32,990 --> 00:12:36,860
target you with highly targeted ads

304
00:12:34,730 --> 00:12:39,380
based on what your technology is I have

305
00:12:36,860 --> 00:12:42,110
the same problem with this methodology

306
00:12:39,380 --> 00:12:44,329
that I do with HR going through and

307
00:12:42,110 --> 00:12:47,060
posting Arden help-wanted ads as

308
00:12:44,329 --> 00:12:49,000
sometimes we give away a little bit too

309
00:12:47,060 --> 00:12:53,750
much about our environments and there's

310
00:12:49,000 --> 00:12:55,910
or in those ads that being said most

311
00:12:53,750 --> 00:12:57,949
organizations simply use the CMDB

312
00:12:55,910 --> 00:13:00,620
functionality built into their ticketing

313
00:12:57,949 --> 00:13:04,209
system and that makes sense and I'm one

314
00:13:00,620 --> 00:13:06,709
of those so our this allows us to

315
00:13:04,209 --> 00:13:07,479
directly link to our incidents to our

316
00:13:06,709 --> 00:13:10,839
change to our

317
00:13:07,480 --> 00:13:14,290
problem tickets the CI or configuration

318
00:13:10,839 --> 00:13:16,600
item directly into the ticketing system

319
00:13:14,290 --> 00:13:20,139
itself and that does have a lot of good

320
00:13:16,600 --> 00:13:23,260
however that does mean that there might

321
00:13:20,139 --> 00:13:25,839
be some particularly use cases that are

322
00:13:23,260 --> 00:13:27,279
not functional for example I use a

323
00:13:25,839 --> 00:13:29,320
ticketing system that if you were to

324
00:13:27,279 --> 00:13:32,139
look on a quadrant that is magic it

325
00:13:29,320 --> 00:13:34,540
would be very high and right and with

326
00:13:32,139 --> 00:13:37,810
that being said there is one glaring

327
00:13:34,540 --> 00:13:43,209
flaw and that is my CIS can only have

328
00:13:37,810 --> 00:13:45,579
three highly indexed IPs and while that

329
00:13:43,209 --> 00:13:48,010
works for the vast vast vast majority of

330
00:13:45,579 --> 00:13:50,138
systems that we do have globally it

331
00:13:48,010 --> 00:13:52,899
really starts to fail when I go through

332
00:13:50,139 --> 00:13:56,139
and I start to look at my web servers

333
00:13:52,899 --> 00:13:57,790
which can have five ten or more IP

334
00:13:56,139 --> 00:14:00,310
addresses associated with them but it

335
00:13:57,790 --> 00:14:02,110
also really fails when I'm going through

336
00:14:00,310 --> 00:14:03,910
and I'm talking about networking a sec

337
00:14:02,110 --> 00:14:06,459
so routers switches firewall

338
00:14:03,910 --> 00:14:08,380
cryptographic termination points so that

339
00:14:06,459 --> 00:14:12,369
is something that we need to be aware of

340
00:14:08,380 --> 00:14:15,250
and finally you could build your own but

341
00:14:12,370 --> 00:14:18,220
it's going to be a Herculean task but I

342
00:14:15,250 --> 00:14:19,630
wanted in preparing for this talk to go

343
00:14:18,220 --> 00:14:22,600
through the process of designing my

344
00:14:19,630 --> 00:14:27,880
ideal CMDB now I know that this slide

345
00:14:22,600 --> 00:14:29,920
isn't a high soar but it took me about

346
00:14:27,880 --> 00:14:32,470
20 hours and I was really proud of it

347
00:14:29,920 --> 00:14:34,870
and not only did I put the Visio on the

348
00:14:32,470 --> 00:14:37,360
github I also took the next step and

349
00:14:34,870 --> 00:14:40,600
implemented this fully out in Microsoft

350
00:14:37,360 --> 00:14:42,819
Access now I was only interested on the

351
00:14:40,600 --> 00:14:45,160
design level I'm a horrible coder so

352
00:14:42,819 --> 00:14:49,000
please feel free to mock me relentlessly

353
00:14:45,160 --> 00:14:52,410
on that but I was very proud and it

354
00:14:49,000 --> 00:14:56,110
taught me a lot of things on how mica

355
00:14:52,410 --> 00:14:59,649
traditionally views my computer objects

356
00:14:56,110 --> 00:15:02,649
in my environment so now control to

357
00:14:59,649 --> 00:15:06,730
inventory and control of our software

358
00:15:02,649 --> 00:15:09,430
assets so once again very similar goals

359
00:15:06,730 --> 00:15:11,980
we want to use some sort of tool to scan

360
00:15:09,430 --> 00:15:13,689
our organization to discover what type

361
00:15:11,980 --> 00:15:16,269
of software is a in use in our

362
00:15:13,690 --> 00:15:17,829
environment and aspirationally we want

363
00:15:16,269 --> 00:15:20,170
to use some type of application

364
00:15:17,829 --> 00:15:21,040
whitelisting technology to control what

365
00:15:20,170 --> 00:15:25,180
is executed

366
00:15:21,040 --> 00:15:28,240
on our systems so once again I love

367
00:15:25,180 --> 00:15:30,219
going to procurement to purchasing

368
00:15:28,240 --> 00:15:32,470
because they're going to be able to set

369
00:15:30,220 --> 00:15:37,720
a good baseline of what we should expect

370
00:15:32,470 --> 00:15:41,259
to find in our environment step two guys

371
00:15:37,720 --> 00:15:44,529
PowerShell is amazing so right here is

372
00:15:41,259 --> 00:15:48,160
the exact scriptlet that I go through

373
00:15:44,529 --> 00:15:50,949
and I leverage to go through and to dump

374
00:15:48,160 --> 00:15:53,019
what is in the add/remove programs and

375
00:15:50,949 --> 00:15:54,609
so depending on your power show you

376
00:15:53,019 --> 00:15:56,759
might have to tweak it just a little bit

377
00:15:54,610 --> 00:16:00,339
but I find it runs really good I

378
00:15:56,759 --> 00:16:03,339
basically go through and I will send

379
00:16:00,339 --> 00:16:06,220
this PowerShell object to an external

380
00:16:03,339 --> 00:16:08,680
computer and/or to a computer on our

381
00:16:06,220 --> 00:16:10,660
network and I will in the script I'll

382
00:16:08,680 --> 00:16:13,508
have it write its results back you can

383
00:16:10,660 --> 00:16:16,420
do it in a CSV a text file and just have

384
00:16:13,509 --> 00:16:19,149
it dump on an open chair so it's really

385
00:16:16,420 --> 00:16:21,069
quite easily and it scales pretty well

386
00:16:19,149 --> 00:16:22,870
from there you can go through use your

387
00:16:21,069 --> 00:16:24,670
favorite data manipulation tool of

388
00:16:22,870 --> 00:16:26,440
choice in just all of the data

389
00:16:24,670 --> 00:16:29,649
manipulate it and you're going to have a

390
00:16:26,440 --> 00:16:32,649
really strong sense of what is in your

391
00:16:29,649 --> 00:16:33,940
Windows environment now this can also be

392
00:16:32,649 --> 00:16:35,860
done in Linux as long as you're going

393
00:16:33,940 --> 00:16:37,930
through and you're using a package

394
00:16:35,860 --> 00:16:39,790
manager you can read the notes on the

395
00:16:37,930 --> 00:16:42,120
past cage manager and you can go through

396
00:16:39,790 --> 00:16:45,339
and you can do that exact same approach

397
00:16:42,120 --> 00:16:48,100
within your Linux environment likewise

398
00:16:45,339 --> 00:16:50,279
alienvault Spiceworks neces community

399
00:16:48,100 --> 00:16:54,220
opened as they all have the capability

400
00:16:50,279 --> 00:16:57,010
to go through and to perform this via an

401
00:16:54,220 --> 00:16:59,529
automated scan this can either be

402
00:16:57,010 --> 00:17:01,720
credentialed or uncredentialed meaning

403
00:16:59,529 --> 00:17:04,209
either give them username and passwords

404
00:17:01,720 --> 00:17:07,809
or not generally I find credentialed

405
00:17:04,209 --> 00:17:09,850
scans are a little bit more valuable but

406
00:17:07,809 --> 00:17:11,829
we need to just like control one it's a

407
00:17:09,849 --> 00:17:13,958
continuous control that we are going

408
00:17:11,829 --> 00:17:16,510
through and affirming that we are

409
00:17:13,959 --> 00:17:19,419
meeting it on a regular basis the same

410
00:17:16,510 --> 00:17:21,849
is true with this control so step three

411
00:17:19,419 --> 00:17:25,059
I suggest going through in preventing

412
00:17:21,849 --> 00:17:27,760
install of unauthorized software first

413
00:17:25,059 --> 00:17:30,070
step separate user from admin rights we

414
00:17:27,760 --> 00:17:31,840
need to go through I would honestly

415
00:17:30,070 --> 00:17:35,049
suggest that you go through and you

416
00:17:31,840 --> 00:17:36,820
block access any

417
00:17:35,049 --> 00:17:39,460
see level at a euro level however you

418
00:17:36,820 --> 00:17:41,139
want to do it too many popular sites

419
00:17:39,460 --> 00:17:44,529
that allow your users today to go

420
00:17:41,139 --> 00:17:46,570
through and download portable apps next

421
00:17:44,529 --> 00:17:49,269
I would suggest pushing out a GPO to

422
00:17:46,570 --> 00:17:51,970
restrict the execution of code of

423
00:17:49,269 --> 00:17:54,789
binaries of applications from very

424
00:17:51,970 --> 00:17:55,869
well-known and documented locations that

425
00:17:54,789 --> 00:17:58,330
are currently being used by our

426
00:17:55,869 --> 00:18:00,279
malicious adversaries I've gone through

427
00:17:58,330 --> 00:18:02,350
and I've given you a knowledgebase

428
00:18:00,279 --> 00:18:04,539
article in a couple locations that I

429
00:18:02,350 --> 00:18:06,668
think are very valuable for us to go

430
00:18:04,539 --> 00:18:09,820
through and restrict and finally the

431
00:18:06,669 --> 00:18:12,519
outcome of all of this is you can go

432
00:18:09,820 --> 00:18:15,279
through and you can now go to your

433
00:18:12,519 --> 00:18:16,960
senior management and justify why we

434
00:18:15,279 --> 00:18:19,809
should go down an application

435
00:18:16,960 --> 00:18:23,139
whitelisting methodology and guys that I

436
00:18:19,809 --> 00:18:26,710
love application whitelisting but I've

437
00:18:23,139 --> 00:18:29,049
only seen it done well within the Apple

438
00:18:26,710 --> 00:18:31,509
ecosystem of the iPhone and the iPad

439
00:18:29,049 --> 00:18:33,820
there is a lot of fear uncertainty and

440
00:18:31,509 --> 00:18:36,009
doubt especially from IT because we're

441
00:18:33,820 --> 00:18:37,570
changing fundamentally how we go through

442
00:18:36,009 --> 00:18:42,489
and how we support systems how we

443
00:18:37,570 --> 00:18:44,408
distribute software and that's all right

444
00:18:42,489 --> 00:18:46,600
we are allowed to grow we're allowed to

445
00:18:44,409 --> 00:18:49,029
change things for the better and even

446
00:18:46,600 --> 00:18:51,580
though I see that there are bypasses

447
00:18:49,029 --> 00:18:53,559
regularly to application whitelisting

448
00:18:51,580 --> 00:18:56,259
technologies in the forms of tools to

449
00:18:53,559 --> 00:18:57,999
act extend techniques I still think it

450
00:18:56,259 --> 00:19:00,669
is where we should aspirationally be

451
00:18:57,999 --> 00:19:04,389
going forward now in order to implement

452
00:19:00,669 --> 00:19:05,919
it my recommendation to those in my

453
00:19:04,389 --> 00:19:09,039
community has always been start with

454
00:19:05,919 --> 00:19:10,809
Microsoft amplicor it's not perfect but

455
00:19:09,039 --> 00:19:13,539
it's something that you can start with

456
00:19:10,809 --> 00:19:15,039
that you can spin up a test lab that you

457
00:19:13,539 --> 00:19:16,960
can start to build trust in that

458
00:19:15,039 --> 00:19:20,049
technology can understand what you can

459
00:19:16,960 --> 00:19:22,239
do and also just as important is what

460
00:19:20,049 --> 00:19:24,429
other projects products would allow you

461
00:19:22,239 --> 00:19:29,679
to do likewise I played around a little

462
00:19:24,429 --> 00:19:33,340
bit with apps a or apps am vid and while

463
00:19:29,679 --> 00:19:34,899
it was a great concept the thing that

464
00:19:33,340 --> 00:19:36,699
really kind of was a deal breaker to me

465
00:19:34,899 --> 00:19:38,949
was there was no centralized management

466
00:19:36,700 --> 00:19:41,619
to it but I really liked some of the

467
00:19:38,950 --> 00:19:43,990
ideas that they had going which brings

468
00:19:41,619 --> 00:19:47,980
us to continuous vulnerability

469
00:19:43,990 --> 00:19:48,980
management so once again our two main

470
00:19:47,980 --> 00:19:51,470
goals

471
00:19:48,980 --> 00:19:54,410
is to utilize some sort of vulnerability

472
00:19:51,470 --> 00:19:56,510
scanning tool to scan our networks that

473
00:19:54,410 --> 00:19:58,610
we defined under control one in control

474
00:19:56,510 --> 00:20:00,800
- and then we need to have the people

475
00:19:58,610 --> 00:20:03,830
processes procedures and technologies to

476
00:20:00,800 --> 00:20:05,720
go through and to review each finding

477
00:20:03,830 --> 00:20:08,330
out of our vulnerability scanner to

478
00:20:05,720 --> 00:20:11,590
validate if it is an issue and then to

479
00:20:08,330 --> 00:20:14,240
remediate it in a in an appropriate time

480
00:20:11,590 --> 00:20:17,300
so when we when we're talking about full

481
00:20:14,240 --> 00:20:18,500
stack scanners this is where I would go

482
00:20:17,300 --> 00:20:21,530
through and I'd suggest something like

483
00:20:18,500 --> 00:20:24,350
open vas as a great starting point so

484
00:20:21,530 --> 00:20:26,030
open that it's an open source phone

485
00:20:24,350 --> 00:20:28,790
ability scanner it's built into Kali

486
00:20:26,030 --> 00:20:32,389
Linux and for many small and medium

487
00:20:28,790 --> 00:20:34,159
businesses this is a great option one of

488
00:20:32,390 --> 00:20:37,190
the things I appreciate about it so much

489
00:20:34,160 --> 00:20:39,410
is just by downloading Kali I can either

490
00:20:37,190 --> 00:20:42,200
download the ISO or I could download the

491
00:20:39,410 --> 00:20:45,740
offensive SEC virtual machine do a quick

492
00:20:42,200 --> 00:20:48,290
update and I'm ready to go through and

493
00:20:45,740 --> 00:20:50,840
to probe in an environment that I'm

494
00:20:48,290 --> 00:20:52,870
authorized to however we do have some

495
00:20:50,840 --> 00:20:55,189
great things coming from our vendors I

496
00:20:52,870 --> 00:20:58,540
have friends at both rapid7

497
00:20:55,190 --> 00:21:01,460
& tenable they're they're really great

498
00:20:58,540 --> 00:21:04,550
organizations rapid7 gives us an expose

499
00:21:01,460 --> 00:21:06,800
community which this is an enterprise

500
00:21:04,550 --> 00:21:09,649
class vulnerability management system

501
00:21:06,800 --> 00:21:13,190
and it's free for one year likewise

502
00:21:09,650 --> 00:21:16,250
Nessus us and chose by tenable they give

503
00:21:13,190 --> 00:21:18,530
you an a full Enterprise loaner ability

504
00:21:16,250 --> 00:21:22,280
management system how they go through

505
00:21:18,530 --> 00:21:23,899
and limit it to 16 devices at a time but

506
00:21:22,280 --> 00:21:26,120
that is something that you can you keep

507
00:21:23,900 --> 00:21:27,560
for years as long as you want to in your

508
00:21:26,120 --> 00:21:31,100
environment now if you're like my friend

509
00:21:27,560 --> 00:21:33,980
Cameron and you like to have human

510
00:21:31,100 --> 00:21:36,949
intelligent guiding these automated and

511
00:21:33,980 --> 00:21:39,500
semi-automated assessment then

512
00:21:36,950 --> 00:21:41,660
Metasploit is something that is really

513
00:21:39,500 --> 00:21:44,360
fun for you to go through and you to

514
00:21:41,660 --> 00:21:46,490
learn to play around with to probe those

515
00:21:44,360 --> 00:21:49,189
systems that you are either own or

516
00:21:46,490 --> 00:21:52,040
explicitly or have the owners explicit

517
00:21:49,190 --> 00:21:53,600
written authorization likewise

518
00:21:52,040 --> 00:21:56,480
retina CS is another vulnerability

519
00:21:53,600 --> 00:22:00,320
management solution that they're free

520
00:21:56,480 --> 00:22:01,070
model allows you to have 256 free scan

521
00:22:00,320 --> 00:22:03,470
assets

522
00:22:01,070 --> 00:22:07,550
now web servers there just a little bit

523
00:22:03,470 --> 00:22:10,520
different and with web servers the we

524
00:22:07,550 --> 00:22:12,710
allow dynamic code to either be run on

525
00:22:10,520 --> 00:22:15,740
the web servers themselves or on the

526
00:22:12,710 --> 00:22:17,870
end-user clients and so this opens our

527
00:22:15,740 --> 00:22:20,420
web servers up to just a couple

528
00:22:17,870 --> 00:22:23,540
different risks so for fully automated

529
00:22:20,420 --> 00:22:26,450
scans I would recommend nikto and Ava's

530
00:22:23,540 --> 00:22:28,930
app is great starting off point and if

531
00:22:26,450 --> 00:22:31,880
you want to have more of the human

532
00:22:28,930 --> 00:22:35,780
guiding the assessment burp suite free

533
00:22:31,880 --> 00:22:38,270
is very very fun with burp suite what

534
00:22:35,780 --> 00:22:42,139
ends up happening is it will sit between

535
00:22:38,270 --> 00:22:44,000
your server and the web or your web

536
00:22:42,140 --> 00:22:45,590
browser and the remote web server and

537
00:22:44,000 --> 00:22:48,400
you'll be able to see the full

538
00:22:45,590 --> 00:22:51,590
communication both ways even up to

539
00:22:48,400 --> 00:22:54,260
manipulating what is being sent and/or

540
00:22:51,590 --> 00:22:57,800
received so that can give you all sorts

541
00:22:54,260 --> 00:22:59,690
of fun discoveries and finally for

542
00:22:57,800 --> 00:23:03,710
sequel I would recommend something like

543
00:22:59,690 --> 00:23:05,750
sequel map all right

544
00:23:03,710 --> 00:23:09,110
control for controlled use of

545
00:23:05,750 --> 00:23:11,810
administrative privileges so our two

546
00:23:09,110 --> 00:23:14,120
main concerns is to go through and to

547
00:23:11,810 --> 00:23:15,980
separate user from administrative

548
00:23:14,120 --> 00:23:17,510
privileges and and only give an

549
00:23:15,980 --> 00:23:21,050
administrative privileges to those that

550
00:23:17,510 --> 00:23:23,840
have a proper business reason to have

551
00:23:21,050 --> 00:23:26,889
them and secondly to go through and to

552
00:23:23,840 --> 00:23:31,760
configure escalated logging of those

553
00:23:26,890 --> 00:23:34,700
administrative credentials so my number

554
00:23:31,760 --> 00:23:37,040
one recommendation is start out with an

555
00:23:34,700 --> 00:23:39,890
full-blown enterprise wide naming

556
00:23:37,040 --> 00:23:42,920
convention for all of your accounts and

557
00:23:39,890 --> 00:23:45,590
I should have added user and computer

558
00:23:42,920 --> 00:23:48,620
accounts in doing this you're giving

559
00:23:45,590 --> 00:23:52,370
your responders the ability to make

560
00:23:48,620 --> 00:23:54,709
quick and correct decisions as they go

561
00:23:52,370 --> 00:23:57,379
through and they start looking into an

562
00:23:54,710 --> 00:24:01,760
event so it's me that is something that

563
00:23:57,380 --> 00:24:04,640
has paid off huge spades second we need

564
00:24:01,760 --> 00:24:07,400
to go through and understand that we as

565
00:24:04,640 --> 00:24:09,290
IT security we have a lot of very sense

566
00:24:07,400 --> 00:24:12,320
of credentials we have a very a lot of

567
00:24:09,290 --> 00:24:13,500
very sensitive cryptographic keys so we

568
00:24:12,320 --> 00:24:16,530
need to protect

569
00:24:13,500 --> 00:24:20,010
I've worked at two or worked with too

570
00:24:16,530 --> 00:24:23,040
many large enterprises and their

571
00:24:20,010 --> 00:24:26,040
security department sometimes still use

572
00:24:23,040 --> 00:24:28,590
a password protective Office document we

573
00:24:26,040 --> 00:24:31,800
can do better me personally I've used

574
00:24:28,590 --> 00:24:33,750
keepass for years and I really love it

575
00:24:31,800 --> 00:24:36,240
for personal use it's a trust no-one

576
00:24:33,750 --> 00:24:39,090
open-source password manager however it

577
00:24:36,240 --> 00:24:41,010
starts to fail at scale when we go

578
00:24:39,090 --> 00:24:43,199
through and we have multiple people

579
00:24:41,010 --> 00:24:45,780
using the password database at one time

580
00:24:43,200 --> 00:24:47,370
only one person can go through and have

581
00:24:45,780 --> 00:24:50,520
read/write access so we have a

582
00:24:47,370 --> 00:24:53,580
highlander problem key pass pro that's

583
00:24:50,520 --> 00:24:55,800
perfectly viable value both workaround

584
00:24:53,580 --> 00:24:59,490
but i wanted to go through and i wanted

585
00:24:55,800 --> 00:25:01,260
to look at some others that i or other

586
00:24:59,490 --> 00:25:03,600
password managers that have come up and

587
00:25:01,260 --> 00:25:05,970
so team passed that one really caught my

588
00:25:03,600 --> 00:25:08,040
eye it looks really slick a lot of great

589
00:25:05,970 --> 00:25:10,620
features but what stood up to me is you

590
00:25:08,040 --> 00:25:12,149
can install it on your home server or

591
00:25:10,620 --> 00:25:13,620
you can stand it up in a dock or

592
00:25:12,150 --> 00:25:15,980
instance and i thought that was pretty

593
00:25:13,620 --> 00:25:19,439
cool from a portability stay in port

594
00:25:15,980 --> 00:25:21,900
likewise PS oh no integrates with the

595
00:25:19,440 --> 00:25:23,070
have i been poned a database which i

596
00:25:21,900 --> 00:25:26,460
thought was that was phenomenal

597
00:25:23,070 --> 00:25:28,110
especially going through and checking

598
00:25:26,460 --> 00:25:31,800
that to making sure that the credentials

599
00:25:28,110 --> 00:25:33,060
that are in there that they that there's

600
00:25:31,800 --> 00:25:35,730
no indicator that they've been

601
00:25:33,060 --> 00:25:39,210
compromised finally bit warden while

602
00:25:35,730 --> 00:25:41,220
they do offer any enterprise plan that

603
00:25:39,210 --> 00:25:43,980
has some advanced features you can get

604
00:25:41,220 --> 00:25:46,500
the base software to install either on

605
00:25:43,980 --> 00:25:49,830
your own server or spin it up as a

606
00:25:46,500 --> 00:25:52,650
docker now once we've got a password

607
00:25:49,830 --> 00:25:56,340
manager in place we want to go through

608
00:25:52,650 --> 00:25:58,680
and special set special auditing up for

609
00:25:56,340 --> 00:26:01,439
our user for administrative user

610
00:25:58,680 --> 00:26:03,450
accounts so i'd love to go through and

611
00:26:01,440 --> 00:26:06,270
interact with my application owners with

612
00:26:03,450 --> 00:26:09,080
my server owners i love to sit down job

613
00:26:06,270 --> 00:26:12,180
shadow them and understand from them

614
00:26:09,080 --> 00:26:14,939
what is normal administration of their

615
00:26:12,180 --> 00:26:17,070
systems what's adding normal and what

616
00:26:14,940 --> 00:26:19,020
would you see around administrative uses

617
00:26:17,070 --> 00:26:21,710
that if you saw that you'd be picking up

618
00:26:19,020 --> 00:26:25,190
the phone to your to your boss

619
00:26:21,710 --> 00:26:26,510
and we can go through and we can work to

620
00:26:25,190 --> 00:26:28,580
make sure that we can catch those

621
00:26:26,510 --> 00:26:32,450
scenarios that we can alert for them and

622
00:26:28,580 --> 00:26:34,490
this helps go through and do a great

623
00:26:32,450 --> 00:26:37,730
thing for us this brings us in as an

624
00:26:34,490 --> 00:26:40,790
active part of their world they start to

625
00:26:37,730 --> 00:26:42,830
see oh security is automating things for

626
00:26:40,790 --> 00:26:45,350
me they're making my job easier and the

627
00:26:42,830 --> 00:26:46,879
easier we can or the easier we make the

628
00:26:45,350 --> 00:26:48,679
jobs of our application owners our

629
00:26:46,880 --> 00:26:50,930
server owners the more they are

630
00:26:48,680 --> 00:26:53,420
incentivized us to intrinsically go

631
00:26:50,930 --> 00:26:55,010
through and bring us into new

632
00:26:53,420 --> 00:26:58,160
conversation so that we can provide

633
00:26:55,010 --> 00:27:00,800
guidance up at the very front so that is

634
00:26:58,160 --> 00:27:03,770
one thing that I've really struggled

635
00:27:00,800 --> 00:27:06,919
with in my nine-to-five is trying to

636
00:27:03,770 --> 00:27:09,650
rebrand IT security as from the

637
00:27:06,920 --> 00:27:12,440
Department of no to the department but

638
00:27:09,650 --> 00:27:14,930
yes and can we do it in this way which

639
00:27:12,440 --> 00:27:18,320
we think will add more value for x y&z

640
00:27:14,930 --> 00:27:20,690
reason and going through and do working

641
00:27:18,320 --> 00:27:22,610
and helping automate our application

642
00:27:20,690 --> 00:27:24,530
owners and that server owners jobs is a

643
00:27:22,610 --> 00:27:27,770
great way to extend that olive branch

644
00:27:24,530 --> 00:27:29,180
likewise we in IT security we go through

645
00:27:27,770 --> 00:27:32,510
and we have certain use cases that we

646
00:27:29,180 --> 00:27:35,210
care about for me it's install removal

647
00:27:32,510 --> 00:27:37,910
updates to software it starts stops

648
00:27:35,210 --> 00:27:39,620
creation deletion of services the

649
00:27:37,910 --> 00:27:41,420
creation deletion of a share the

650
00:27:39,620 --> 00:27:43,790
installation of patch is the creation

651
00:27:41,420 --> 00:27:46,940
deletion of a network drive it can also

652
00:27:43,790 --> 00:27:50,480
be network configuration changes oh and

653
00:27:46,940 --> 00:27:53,840
any time new admin access is added a

654
00:27:50,480 --> 00:27:57,110
very simple rule that I wrote is we had

655
00:27:53,840 --> 00:27:59,480
an issue where we thought that non IT

656
00:27:57,110 --> 00:28:01,610
security provisioners were creating

657
00:27:59,480 --> 00:28:04,400
service accounts in our environment so I

658
00:28:01,610 --> 00:28:08,360
went through found the Microsoft blog

659
00:28:04,400 --> 00:28:11,810
and I wrote a very basic rule so if I

660
00:28:08,360 --> 00:28:15,530
saw a new admin user created and it

661
00:28:11,810 --> 00:28:18,500
wasn't created by any of the IT security

662
00:28:15,530 --> 00:28:20,480
provisioners that we would get an alert

663
00:28:18,500 --> 00:28:23,810
and that was very effective in helping

664
00:28:20,480 --> 00:28:27,500
us go through discover and tamp down

665
00:28:23,810 --> 00:28:31,129
that type of access finally once we set

666
00:28:27,500 --> 00:28:32,900
this auditing in place it's not like Ron

667
00:28:31,130 --> 00:28:34,940
Popeil you don't set it and forget it

668
00:28:32,900 --> 00:28:35,330
you have to constantly go through and

669
00:28:34,940 --> 00:28:37,519
Pro

670
00:28:35,330 --> 00:28:39,830
that that control is working so I do

671
00:28:37,519 --> 00:28:41,570
this two ways I like to go through and

672
00:28:39,830 --> 00:28:44,570
have a controlled break where I do

673
00:28:41,570 --> 00:28:46,789
something and I testing did the alert go

674
00:28:44,570 --> 00:28:48,559
through and happen and then I am a big

675
00:28:46,789 --> 00:28:51,408
fan of even if we haven't automated

676
00:28:48,559 --> 00:28:53,299
alert at a reasonable interval we should

677
00:28:51,409 --> 00:28:56,419
probably do a manual check to make sure

678
00:28:53,299 --> 00:28:57,679
that there was no breakdowns and this is

679
00:28:56,419 --> 00:29:01,039
something that we of course have to do

680
00:28:57,679 --> 00:29:03,619
on a repeating process all right we're a

681
00:29:01,039 --> 00:29:05,710
little bit further than a half way here

682
00:29:03,619 --> 00:29:08,840
I am going to have to go through and

683
00:29:05,710 --> 00:29:10,820
stop a little bit early because I've got

684
00:29:08,840 --> 00:29:13,580
another talk that I have to go to a

685
00:29:10,820 --> 00:29:16,639
Cloudy with a Chance of breach with at

686
00:29:13,580 --> 00:29:18,678
Tricia kicks ass so we'll move on to

687
00:29:16,639 --> 00:29:21,549
control five and this is all about

688
00:29:18,679 --> 00:29:24,559
secure excuse me secure configuration

689
00:29:21,549 --> 00:29:28,580
for hardware and software on your

690
00:29:24,559 --> 00:29:30,678
devices so our first aspiration will go

691
00:29:28,580 --> 00:29:32,570
our first goal here is to go through and

692
00:29:30,679 --> 00:29:34,669
to define our system hardening

693
00:29:32,570 --> 00:29:36,980
procedures and then we need to go

694
00:29:34,669 --> 00:29:39,679
through and we need to have some sort of

695
00:29:36,980 --> 00:29:41,739
automated tool to scan our environment

696
00:29:39,679 --> 00:29:44,720
to make sure that we are living up to

697
00:29:41,739 --> 00:29:47,179
what our hardening standard says we're

698
00:29:44,720 --> 00:29:49,609
doing now this is where you as an

699
00:29:47,179 --> 00:29:53,600
organization go through and you do have

700
00:29:49,609 --> 00:29:55,759
some leeway so for most small to

701
00:29:53,600 --> 00:29:58,939
business or small to medium businesses I

702
00:29:55,759 --> 00:30:00,619
suggest please review the good

703
00:29:58,940 --> 00:30:03,200
frameworks out there and simply select

704
00:30:00,619 --> 00:30:06,529
one that you want to go through and you

705
00:30:03,200 --> 00:30:08,450
want to align to however if we say that

706
00:30:06,529 --> 00:30:09,830
we aligned to a standard we need to make

707
00:30:08,450 --> 00:30:10,940
sure that we are actually going through

708
00:30:09,830 --> 00:30:13,609
and aligning to it

709
00:30:10,940 --> 00:30:16,009
so in that case C is NIST Microsoft best

710
00:30:13,609 --> 00:30:17,629
practices these are all great places

711
00:30:16,009 --> 00:30:21,769
where you can jump in and you can get a

712
00:30:17,629 --> 00:30:24,289
good start a good running or a good

713
00:30:21,769 --> 00:30:26,779
starting point for this that being said

714
00:30:24,289 --> 00:30:30,799
I work for a very large global

715
00:30:26,779 --> 00:30:35,570
organization and we have competing rules

716
00:30:30,799 --> 00:30:38,720
laws and regulations from a city to a

717
00:30:35,570 --> 00:30:42,289
country even to regionally as well as

718
00:30:38,720 --> 00:30:44,080
globally conflicts and so for us what

719
00:30:42,289 --> 00:30:46,820
we've done is we picked a couple

720
00:30:44,080 --> 00:30:48,449
reference frameworks and we go through

721
00:30:46,820 --> 00:30:51,149
and we built our own

722
00:30:48,450 --> 00:30:53,310
security policies and because of rules

723
00:30:51,150 --> 00:30:56,160
laws regulations contractual agreements

724
00:30:53,310 --> 00:30:59,070
it broke down in two regions of the

725
00:30:56,160 --> 00:31:01,920
world for example I think it's fair to

726
00:30:59,070 --> 00:31:05,100
say be as expressed in GDP are in some

727
00:31:01,920 --> 00:31:09,780
other legislation that Europe has a

728
00:31:05,100 --> 00:31:12,060
little bit more as I say more

729
00:31:09,780 --> 00:31:13,980
expectation on the privacy of the

730
00:31:12,060 --> 00:31:15,870
individual and the data we collect about

731
00:31:13,980 --> 00:31:18,000
the individual than we do traditionally

732
00:31:15,870 --> 00:31:23,070
here in the States although I do believe

733
00:31:18,000 --> 00:31:26,310
that we are seeing a rapid alignment

734
00:31:23,070 --> 00:31:27,689
with GDP our type of rules laws and

735
00:31:26,310 --> 00:31:29,250
regulations here in the state and I

736
00:31:27,690 --> 00:31:32,730
expect that to go through and to

737
00:31:29,250 --> 00:31:35,550
continue but that being said so we have

738
00:31:32,730 --> 00:31:36,960
in America's in a set of America's

739
00:31:35,550 --> 00:31:39,149
hardening guides we have a European

740
00:31:36,960 --> 00:31:41,880
instead of a hardening guides and we

741
00:31:39,150 --> 00:31:44,640
have an APEC set of hardening guides and

742
00:31:41,880 --> 00:31:46,590
so whenever there's a change to one of

743
00:31:44,640 --> 00:31:48,120
our reference frameworks we have to go

744
00:31:46,590 --> 00:31:50,399
through we have to review it and we have

745
00:31:48,120 --> 00:31:53,699
to make a conscious decision do we go

746
00:31:50,400 --> 00:31:56,700
through do we need to update ours or can

747
00:31:53,700 --> 00:31:58,350
we just leave it as is and that brings

748
00:31:56,700 --> 00:32:00,090
us to of the final control that I wanted

749
00:31:58,350 --> 00:32:04,320
to touch on today and that's maintenance

750
00:32:00,090 --> 00:32:08,370
monitoring and analysis of audit logs so

751
00:32:04,320 --> 00:32:10,860
our main goal is to create a local

752
00:32:08,370 --> 00:32:13,169
logging standard and then ensure that

753
00:32:10,860 --> 00:32:15,120
the appropriate logs that we as IT

754
00:32:13,170 --> 00:32:18,030
security and the business decide decide

755
00:32:15,120 --> 00:32:19,830
on are being sent to a centralized

756
00:32:18,030 --> 00:32:23,730
management location that can be a data

757
00:32:19,830 --> 00:32:28,260
lake that can also be something like a

758
00:32:23,730 --> 00:32:30,510
sim so once again I'm very boring we

759
00:32:28,260 --> 00:32:34,020
need to define our logging standards and

760
00:32:30,510 --> 00:32:35,910
this is we're looking at other logging

761
00:32:34,020 --> 00:32:37,889
standards is a great jump start so

762
00:32:35,910 --> 00:32:41,610
Microsoft has a great best practice that

763
00:32:37,890 --> 00:32:44,280
we just reviewed within my 9 to 5 but

764
00:32:41,610 --> 00:32:46,490
also NIST has a great framework that you

765
00:32:44,280 --> 00:32:48,960
can go through and he can dig in a

766
00:32:46,490 --> 00:32:51,870
hidden secret though is that when you

767
00:32:48,960 --> 00:32:55,140
purchase us in you're not just going

768
00:32:51,870 --> 00:32:57,560
through in purchasing the hardware the

769
00:32:55,140 --> 00:33:01,309
software you're actually purchasing the

770
00:32:57,560 --> 00:33:03,529
help of that SCIM vendor to

771
00:33:01,309 --> 00:33:06,620
help you get the other devices logging

772
00:33:03,529 --> 00:33:10,129
in your environment likewise most

773
00:33:06,620 --> 00:33:13,219
hardware and software vendors unfund

774
00:33:10,129 --> 00:33:15,620
'mentally understand that in order to be

775
00:33:13,220 --> 00:33:18,529
successful in the medium to large

776
00:33:15,620 --> 00:33:21,799
enterprise network that you need to have

777
00:33:18,529 --> 00:33:23,029
built in centralized logging so if you

778
00:33:21,799 --> 00:33:25,399
reach out to your hardware or software

779
00:33:23,029 --> 00:33:27,110
vendors they probably have already gone

780
00:33:25,399 --> 00:33:30,080
through and have a knowledgebase article

781
00:33:27,110 --> 00:33:32,149
that they can just give you my last tip

782
00:33:30,080 --> 00:33:34,100
here with your logging standards is you

783
00:33:32,149 --> 00:33:35,600
need to consider different logging

784
00:33:34,100 --> 00:33:39,350
levels for different parts of your

785
00:33:35,600 --> 00:33:41,809
environment so when I first joined my

786
00:33:39,350 --> 00:33:44,959
nine-to-five what ended up happening was

787
00:33:41,809 --> 00:33:47,899
I took over the sim and we needed to

788
00:33:44,960 --> 00:33:51,200
write our own logging standards and so

789
00:33:47,899 --> 00:33:53,928
as I dug in to how the organization went

790
00:33:51,200 --> 00:33:57,559
through and described their machines I

791
00:33:53,929 --> 00:33:59,570
saw that we had a system classification

792
00:33:57,559 --> 00:34:03,200
and that system classification was built

793
00:33:59,570 --> 00:34:05,418
on two very simple pillars one was

794
00:34:03,200 --> 00:34:09,109
uptime and one was sensitivity of data

795
00:34:05,419 --> 00:34:12,409
so based on the uptime requirement one

796
00:34:09,109 --> 00:34:14,299
nine or I'm sorry two nine three nines

797
00:34:12,409 --> 00:34:17,450
four nine five nine

798
00:34:14,300 --> 00:34:20,359
that was a direct equivalent to how

799
00:34:17,449 --> 00:34:22,908
critical an asset was in our environment

800
00:34:20,359 --> 00:34:26,779
and we had our own internal data

801
00:34:22,909 --> 00:34:29,450
classification think top secret all the

802
00:34:26,780 --> 00:34:33,679
way down to public and based on where a

803
00:34:29,449 --> 00:34:36,739
system lined up in that analysis that

804
00:34:33,679 --> 00:34:40,010
system logging level would define what

805
00:34:36,739 --> 00:34:44,000
IT tools as well as IT security tools

806
00:34:40,010 --> 00:34:45,589
are applied to that and in going through

807
00:34:44,000 --> 00:34:48,079
and thinking about this is like well I

808
00:34:45,589 --> 00:34:50,179
probably should care more about logging

809
00:34:48,079 --> 00:34:53,869
on my domain controller then the

810
00:34:50,179 --> 00:34:56,599
internal wiki that tells us what's what

811
00:34:53,869 --> 00:34:59,780
the menu in the kitchen is so with that

812
00:34:56,599 --> 00:35:03,050
being said I simply chose to use that

813
00:34:59,780 --> 00:35:06,950
system classification in my logging

814
00:35:03,050 --> 00:35:09,280
definition so things that were very high

815
00:35:06,950 --> 00:35:12,529
in our system classification got more

816
00:35:09,280 --> 00:35:15,150
logging or got a greater detail of

817
00:35:12,530 --> 00:35:18,210
logging on it then say something

818
00:35:15,150 --> 00:35:20,910
was lower however this started to go

819
00:35:18,210 --> 00:35:22,680
through and to fail especially at our

820
00:35:20,910 --> 00:35:25,109
networking devices because if you think

821
00:35:22,680 --> 00:35:28,200
about it networking devices their whole

822
00:35:25,109 --> 00:35:29,970
job is to pass the traffic by almost

823
00:35:28,200 --> 00:35:32,879
definition they're assumed to have very

824
00:35:29,970 --> 00:35:35,939
high uptime and they don't really store

825
00:35:32,880 --> 00:35:38,160
data they traverse data and so this is

826
00:35:35,940 --> 00:35:40,890
where I went back to my old networking

827
00:35:38,160 --> 00:35:42,750
days and I thought of the Cisco or I'm

828
00:35:40,890 --> 00:35:45,240
sorry the Cisco traditional data center

829
00:35:42,750 --> 00:35:47,880
or enterprise data center and that has

830
00:35:45,240 --> 00:35:50,970
three different components so you've got

831
00:35:47,880 --> 00:35:52,859
the core which is think of it as your

832
00:35:50,970 --> 00:35:55,709
data center you've got the access that's

833
00:35:52,859 --> 00:35:57,538
where your users your guests your

834
00:35:55,710 --> 00:35:59,099
employees your contractors that's where

835
00:35:57,539 --> 00:36:00,900
their systems connect and the

836
00:35:59,099 --> 00:36:02,940
distribution goes through and connects

837
00:36:00,900 --> 00:36:05,549
the two and so based on that

838
00:36:02,940 --> 00:36:08,539
classification I put most of my logging

839
00:36:05,549 --> 00:36:11,339
resources at the core the second most

840
00:36:08,539 --> 00:36:12,900
blogging resources was targeting the

841
00:36:11,339 --> 00:36:15,630
access and the least was the

842
00:36:12,900 --> 00:36:18,359
distribution and the reason why we went

843
00:36:15,630 --> 00:36:21,869
through and did that is because every

844
00:36:18,359 --> 00:36:24,690
sim out there has a theoretical maximum

845
00:36:21,869 --> 00:36:28,319
compute resource and our job is IT and

846
00:36:24,690 --> 00:36:31,109
IT security is to go through and it is

847
00:36:28,319 --> 00:36:33,630
to maximize the value that we get out of

848
00:36:31,109 --> 00:36:36,569
our sim next we need to go through and

849
00:36:33,630 --> 00:36:39,990
think about all right cloud versus

850
00:36:36,569 --> 00:36:41,819
on-premise so where is your sim is it in

851
00:36:39,990 --> 00:36:45,000
the cloud already is it in the same

852
00:36:41,819 --> 00:36:47,279
cloud that your that your other cloud

853
00:36:45,000 --> 00:36:49,710
assets are in is it a different and

854
00:36:47,279 --> 00:36:53,970
you're going to have to do a benefit and

855
00:36:49,710 --> 00:36:56,640
cost analysis to understand do I go do I

856
00:36:53,970 --> 00:36:59,578
go through and send all of my cloud logs

857
00:36:56,640 --> 00:37:02,730
to the sim or do I stand up a second sim

858
00:36:59,579 --> 00:37:06,150
just for the cloud assets keep in mind

859
00:37:02,730 --> 00:37:08,069
as I pointed out earlier networks can be

860
00:37:06,150 --> 00:37:10,109
bound by rules laws regulations and

861
00:37:08,069 --> 00:37:14,700
contractual agreements and those might

862
00:37:10,109 --> 00:37:16,799
differ from location to location so now

863
00:37:14,700 --> 00:37:22,038
that we have our logging standard

864
00:37:16,799 --> 00:37:25,160
created we now need to select a a sim so

865
00:37:22,039 --> 00:37:28,170
in the free and open source world I

866
00:37:25,160 --> 00:37:29,009
default to recommending elks takei two

867
00:37:28,170 --> 00:37:31,230
years ago Derby

868
00:37:29,010 --> 00:37:33,390
on eight I went through and took a

869
00:37:31,230 --> 00:37:35,100
trusted second-class red team versus

870
00:37:33,390 --> 00:37:39,029
blue team and about a quarter of the

871
00:37:35,100 --> 00:37:41,790
time was spent in standing up and doing

872
00:37:39,030 --> 00:37:44,490
threat hunting in an elk stack and that

873
00:37:41,790 --> 00:37:46,290
just blew me away how mature that

874
00:37:44,490 --> 00:37:50,250
solution was back then and it's only

875
00:37:46,290 --> 00:37:52,650
gotten better in fact elk or an elk

876
00:37:50,250 --> 00:37:55,110
stack was built into the default

877
00:37:52,650 --> 00:37:57,480
security onion image for those of you

878
00:37:55,110 --> 00:37:59,610
don't that don't know security onion is

879
00:37:57,480 --> 00:38:02,610
kind of like the blue team's version of

880
00:37:59,610 --> 00:38:04,380
Kali so once you install and you go

881
00:38:02,610 --> 00:38:06,000
through the initiation steps with

882
00:38:04,380 --> 00:38:07,800
security onion you're going to have a

883
00:38:06,000 --> 00:38:09,480
built in elk stack that you can go

884
00:38:07,800 --> 00:38:11,760
through and you can start playing with

885
00:38:09,480 --> 00:38:13,760
right then and there I was on a Black

886
00:38:11,760 --> 00:38:17,520
Hills Hills information security

887
00:38:13,760 --> 00:38:19,590
training a couple weeks ago and I was

888
00:38:17,520 --> 00:38:23,910
introduced to the concept of a help

889
00:38:19,590 --> 00:38:26,370
stack a help stack to condense it it was

890
00:38:23,910 --> 00:38:28,740
built for threat to hunting so they

891
00:38:26,370 --> 00:38:32,069
implemented an entire elk stack in

892
00:38:28,740 --> 00:38:33,870
docker which is great for going through

893
00:38:32,070 --> 00:38:37,920
in a threat hunting lab either home or

894
00:38:33,870 --> 00:38:39,900
at work and it is absolutely fantastic

895
00:38:37,920 --> 00:38:41,940
to go through you can spin it up in

896
00:38:39,900 --> 00:38:44,940
about 15 minutes and then you can test

897
00:38:41,940 --> 00:38:46,710
and see if a full elk stack would be

898
00:38:44,940 --> 00:38:47,730
something that would be a value to your

899
00:38:46,710 --> 00:38:50,850
organization

900
00:38:47,730 --> 00:38:55,080
likewise gray log so grey log is a

901
00:38:50,850 --> 00:38:58,770
freemium type of sim however in my

902
00:38:55,080 --> 00:39:01,860
findings most small businesses will be

903
00:38:58,770 --> 00:39:04,650
able to use the free tier of grey log so

904
00:39:01,860 --> 00:39:06,900
it's worth a shout out that being said I

905
00:39:04,650 --> 00:39:08,670
had to go through and throw SolarWinds

906
00:39:06,900 --> 00:39:10,080
event log collector and key recess logs

907
00:39:08,670 --> 00:39:14,250
they have gotten me out of some

908
00:39:10,080 --> 00:39:15,720
ridiculous jams in the past but you

909
00:39:14,250 --> 00:39:17,730
could also consider splints they have a

910
00:39:15,720 --> 00:39:21,600
free version that limits you to 500

911
00:39:17,730 --> 00:39:24,510
megabytes a day and for a home lab for

912
00:39:21,600 --> 00:39:26,310
just a threat hunting lab and even for

913
00:39:24,510 --> 00:39:28,310
some small businesses that might be

914
00:39:26,310 --> 00:39:32,240
enough and you can have complete

915
00:39:28,310 --> 00:39:35,549
enterprise class tool to go through and

916
00:39:32,240 --> 00:39:37,560
centralize your logs now whatever tool

917
00:39:35,550 --> 00:39:41,100
you choose if it's one of those great if

918
00:39:37,560 --> 00:39:41,529
it's notes great - I would urge you that

919
00:39:41,100 --> 00:39:43,420
one of

920
00:39:41,530 --> 00:39:45,400
first law or one of the first alerts

921
00:39:43,420 --> 00:39:48,400
that we go through and we should be

922
00:39:45,400 --> 00:39:51,100
create is for those critical assets

923
00:39:48,400 --> 00:39:54,160
however you define them create an alert

924
00:39:51,100 --> 00:39:58,900
if a critical asset stops logging for 48

925
00:39:54,160 --> 00:40:02,049
hours if this is something that has bit

926
00:39:58,900 --> 00:40:03,970
me in the behind in trying to do an

927
00:40:02,050 --> 00:40:07,840
event analysis and I want to make sure

928
00:40:03,970 --> 00:40:11,200
that when we do stand up a sim that we

929
00:40:07,840 --> 00:40:16,750
do have this basic type of control built

930
00:40:11,200 --> 00:40:19,480
in but it's sim it is an important tool

931
00:40:16,750 --> 00:40:21,910
of friendship both to IT into the

932
00:40:19,480 --> 00:40:24,340
business so once I have my sim up and

933
00:40:21,910 --> 00:40:27,009
I'm ingesting logs I go to my app and

934
00:40:24,340 --> 00:40:28,570
system owners and I ask what logs do you

935
00:40:27,010 --> 00:40:32,380
care about what events do you care about

936
00:40:28,570 --> 00:40:34,930
what series of events would you want to

937
00:40:32,380 --> 00:40:37,300
get a kind automated call out what

938
00:40:34,930 --> 00:40:40,180
events are would have you picking up the

939
00:40:37,300 --> 00:40:41,740
phone and usually my app owners by

940
00:40:40,180 --> 00:40:43,210
system owners they can answer those

941
00:40:41,740 --> 00:40:46,390
questions and then I can go through and

942
00:40:43,210 --> 00:40:48,960
I can use those two highly automate some

943
00:40:46,390 --> 00:40:51,520
of their jobs once again going through

944
00:40:48,960 --> 00:40:53,610
helping our relationship with the

945
00:40:51,520 --> 00:40:55,750
business will pay off in spades

946
00:40:53,610 --> 00:40:57,910
next I'm sure most of you know about The

947
00:40:55,750 --> 00:41:00,130
MITRE attempt attack framework for those

948
00:40:57,910 --> 00:41:02,080
of you that this is new this is one of

949
00:41:00,130 --> 00:41:05,170
the single best tools that has been

950
00:41:02,080 --> 00:41:07,299
created in our industry over the past

951
00:41:05,170 --> 00:41:09,940
couple of years if you go to their

952
00:41:07,300 --> 00:41:12,280
website you can just quickly see all of

953
00:41:09,940 --> 00:41:14,920
the different real world adversaries

954
00:41:12,280 --> 00:41:16,870
techniques that they have indexed and if

955
00:41:14,920 --> 00:41:19,570
you click into one it'll give you the

956
00:41:16,870 --> 00:41:22,480
who what where when why and oftentimes

957
00:41:19,570 --> 00:41:25,120
here's what this might manifest itself

958
00:41:22,480 --> 00:41:27,220
this is what it might look like so if

959
00:41:25,120 --> 00:41:29,319
you haven't gone through and if you

960
00:41:27,220 --> 00:41:31,270
haven't looked at my tour please do

961
00:41:29,320 --> 00:41:33,730
yourself a favor make that one of your

962
00:41:31,270 --> 00:41:36,160
favorites and it's a wealth of

963
00:41:33,730 --> 00:41:38,200
information for those of you that

964
00:41:36,160 --> 00:41:42,549
haven't heard of the project Sigma

965
00:41:38,200 --> 00:41:44,500
github this is awesome so what the

966
00:41:42,550 --> 00:41:47,590
founders of the Sigma project went

967
00:41:44,500 --> 00:41:50,830
through and saw that each of these sims

968
00:41:47,590 --> 00:41:53,110
are built their own way they person in

969
00:41:50,830 --> 00:41:54,940
their own way you write rules and alerts

970
00:41:53,110 --> 00:41:59,260
in their own way and what this really is

971
00:41:54,940 --> 00:42:03,130
to do was to prevent people from being

972
00:41:59,260 --> 00:42:05,410
able to share their rules easily so what

973
00:42:03,130 --> 00:42:08,020
project sedima did is they said great

974
00:42:05,410 --> 00:42:13,690
we'll solve it by creating another meta

975
00:42:08,020 --> 00:42:16,810
rule framework for the sim I say that in

976
00:42:13,690 --> 00:42:19,180
jest but that was the solution and it's

977
00:42:16,810 --> 00:42:21,430
a really good one because if you go out

978
00:42:19,180 --> 00:42:23,049
to their gab you can see all of the

979
00:42:21,430 --> 00:42:26,049
alerts that they've written in their own

980
00:42:23,050 --> 00:42:28,359
proprietary framework and when I as an

981
00:42:26,050 --> 00:42:30,670
IT security practitioner look at those

982
00:42:28,359 --> 00:42:34,270
rules I can understand their logic and I

983
00:42:30,670 --> 00:42:38,980
can go through and or I can go through

984
00:42:34,270 --> 00:42:40,690
and I can alright sorry got distracted

985
00:42:38,980 --> 00:42:42,609
by a notification when I look at the

986
00:42:40,690 --> 00:42:45,069
rules I understand myself I understand

987
00:42:42,609 --> 00:42:47,740
how I need to write alerts and it's very

988
00:42:45,069 --> 00:42:51,339
simple for me to go through and to

989
00:42:47,740 --> 00:42:54,939
simply go through and implement that

990
00:42:51,339 --> 00:42:56,770
logic in my sim however they also have a

991
00:42:54,940 --> 00:42:58,540
program that you can install and it's a

992
00:42:56,770 --> 00:43:01,240
very simple program it's almost like

993
00:42:58,540 --> 00:43:03,160
ordering at a fast-food restaurant you

994
00:43:01,240 --> 00:43:06,848
pull up to the drive box you run the

995
00:43:03,160 --> 00:43:08,440
executable and you simply go through and

996
00:43:06,849 --> 00:43:10,030
you can say yes I'd like a number one

997
00:43:08,440 --> 00:43:12,069
and number three and number seven give

998
00:43:10,030 --> 00:43:15,040
me a number eleven but hold the

999
00:43:12,069 --> 00:43:17,500
mayonnaise and then at the next prompt

1000
00:43:15,040 --> 00:43:20,170
you say this is what sim I have and if

1001
00:43:17,500 --> 00:43:23,050
your sim is supported and a lot of the

1002
00:43:20,170 --> 00:43:26,560
major Sims are it'll go through and it

1003
00:43:23,050 --> 00:43:28,750
will pop out that rule in your sims

1004
00:43:26,560 --> 00:43:32,560
format for you so now all you have to do

1005
00:43:28,750 --> 00:43:36,010
is copy and paste another great tool for

1006
00:43:32,560 --> 00:43:40,000
going through and for helping you

1007
00:43:36,010 --> 00:43:45,670
maximize your return in the sim is

1008
00:43:40,000 --> 00:43:48,010
purple team exercises so with purple

1009
00:43:45,670 --> 00:43:51,630
team I'm a huge fan of I think they send

1010
00:43:48,010 --> 00:43:54,940
a such a better metric to our management

1011
00:43:51,630 --> 00:43:56,920
because let's face it if you have or if

1012
00:43:54,940 --> 00:43:58,900
a business does have a full-blown IT

1013
00:43:56,920 --> 00:44:01,660
security team we're already spending

1014
00:43:58,900 --> 00:44:05,530
hundreds of thousands of dollars a year

1015
00:44:01,660 --> 00:44:08,230
and when we do our annual pin test and

1016
00:44:05,530 --> 00:44:11,080
we have some very talented

1017
00:44:08,230 --> 00:44:14,320
teamers within our community and they do

1018
00:44:11,080 --> 00:44:15,910
a lot of good for us but I know that a

1019
00:44:14,320 --> 00:44:17,740
good pen tester is going to be able to

1020
00:44:15,910 --> 00:44:19,899
create a good pretext they're going to

1021
00:44:17,740 --> 00:44:21,609
be able to weaponize it either in a

1022
00:44:19,900 --> 00:44:24,460
watering hall attack or they're going to

1023
00:44:21,609 --> 00:44:29,080
be able to go through and to fish my

1024
00:44:24,460 --> 00:44:30,550
users and I know that someone is going

1025
00:44:29,080 --> 00:44:32,680
to be tripped someone is going to go

1026
00:44:30,550 --> 00:44:34,600
through and is going to click the link

1027
00:44:32,680 --> 00:44:37,450
to go to the watering hole attack and

1028
00:44:34,600 --> 00:44:40,569
when they do I know that there is a

1029
00:44:37,450 --> 00:44:42,279
chance that that red teamer is going to

1030
00:44:40,570 --> 00:44:44,080
get a shell and once they get a shell

1031
00:44:42,280 --> 00:44:46,210
they're going to find some way to live

1032
00:44:44,080 --> 00:44:49,029
off the land they're going to be able to

1033
00:44:46,210 --> 00:44:50,830
potentially run a derivation of me me

1034
00:44:49,030 --> 00:44:54,040
cats and they're going to be able to

1035
00:44:50,830 --> 00:44:56,350
spread laterally the concept of the

1036
00:44:54,040 --> 00:44:58,660
purple team for those of you that don't

1037
00:44:56,350 --> 00:45:01,420
know is to have the red team and the

1038
00:44:58,660 --> 00:45:03,368
blue team meet together and discuss the

1039
00:45:01,420 --> 00:45:06,030
what the attack is what the scope is and

1040
00:45:03,369 --> 00:45:08,020
then let the red teamer go through and

1041
00:45:06,030 --> 00:45:10,060
execute the attack while the blue team

1042
00:45:08,020 --> 00:45:12,609
err is looking and seeing what did we

1043
00:45:10,060 --> 00:45:15,730
detect what didn't we detect then after

1044
00:45:12,609 --> 00:45:17,890
the first attack is over you meet back

1045
00:45:15,730 --> 00:45:20,470
up you debrief this is what worked well

1046
00:45:17,890 --> 00:45:22,810
this is what didn't work well and then

1047
00:45:20,470 --> 00:45:24,689
you go through you agree on some

1048
00:45:22,810 --> 00:45:27,130
mitigation just in controls you

1049
00:45:24,690 --> 00:45:29,050
implement them you bring the red teamer

1050
00:45:27,130 --> 00:45:31,720
back they run it again with the blue

1051
00:45:29,050 --> 00:45:33,700
team watching and you get a much better

1052
00:45:31,720 --> 00:45:36,069
optics message because now when the

1053
00:45:33,700 --> 00:45:39,730
final report goes to management you can

1054
00:45:36,070 --> 00:45:41,680
go through and say this is quantifiable

1055
00:45:39,730 --> 00:45:44,050
quantifiably through this expenditure

1056
00:45:41,680 --> 00:45:46,240
how we increase the security and I think

1057
00:45:44,050 --> 00:45:48,070
that that's just some a lot better

1058
00:45:46,240 --> 00:45:49,509
metrics a lot better of a message for us

1059
00:45:48,070 --> 00:45:53,440
be communicating to our senior

1060
00:45:49,510 --> 00:45:55,840
management next we need to go through

1061
00:45:53,440 --> 00:45:58,690
and we need to make allies with our

1062
00:45:55,840 --> 00:46:00,160
audit so about six months ago I was

1063
00:45:58,690 --> 00:46:02,890
going through and I was cruising around

1064
00:46:00,160 --> 00:46:07,210
my network and I found something very

1065
00:46:02,890 --> 00:46:09,460
bad going on and as I dug a little bit

1066
00:46:07,210 --> 00:46:11,859
deeper I found more and more that I

1067
00:46:09,460 --> 00:46:13,720
don't like so I went to my seesaw I said

1068
00:46:11,859 --> 00:46:15,490
hey we need to have a meeting I think I

1069
00:46:13,720 --> 00:46:19,089
found something and as I laid out the

1070
00:46:15,490 --> 00:46:20,589
evidence he agreed that yes there's some

1071
00:46:19,090 --> 00:46:21,760
we do need to go through and we need to

1072
00:46:20,590 --> 00:46:24,340
do this however

1073
00:46:21,760 --> 00:46:26,410
I need you to be prioritized on the

1074
00:46:24,340 --> 00:46:30,190
topics that you're currently working on

1075
00:46:26,410 --> 00:46:32,649
so please just do this as you can so

1076
00:46:30,190 --> 00:46:35,020
this effort that I was independently

1077
00:46:32,650 --> 00:46:36,910
leading was a skunkworks project I

1078
00:46:35,020 --> 00:46:39,550
spending one to two hours a week and

1079
00:46:36,910 --> 00:46:42,970
months went by until about four months

1080
00:46:39,550 --> 00:46:44,410
later I got a call from internal aunt or

1081
00:46:42,970 --> 00:46:46,779
I got a meeting him but from an internal

1082
00:46:44,410 --> 00:46:48,879
audit and it's like okay and it was

1083
00:46:46,780 --> 00:46:51,070
pretty generic so I went through and I

1084
00:46:48,880 --> 00:46:52,480
reached back out and I said hey I saw

1085
00:46:51,070 --> 00:46:55,920
that you set up a meeting can you please

1086
00:46:52,480 --> 00:46:57,970
let me know what that meeting is about

1087
00:46:55,920 --> 00:46:59,620
so I can make sure I can bring the

1088
00:46:57,970 --> 00:47:02,709
correct documentation so I call we'll

1089
00:46:59,620 --> 00:47:04,600
just discuss at a high level in in the

1090
00:47:02,710 --> 00:47:06,220
media it's like okay the hairs on the

1091
00:47:04,600 --> 00:47:08,190
back of my head started to stand up a

1092
00:47:06,220 --> 00:47:11,310
little bit that's a little bit abnormal

1093
00:47:08,190 --> 00:47:15,130
but okay so I showed up to the meeting

1094
00:47:11,310 --> 00:47:19,890
and I love my auditors but I kind of

1095
00:47:15,130 --> 00:47:22,870
have a feeling of exactly how much of

1096
00:47:19,890 --> 00:47:25,540
technology they really truly understand

1097
00:47:22,870 --> 00:47:28,480
and they were going through and asking

1098
00:47:25,540 --> 00:47:30,520
me very highly technical questions that

1099
00:47:28,480 --> 00:47:33,310
I wouldn't have expected and sure enough

1100
00:47:30,520 --> 00:47:35,860
they had been briefed by somebody else

1101
00:47:33,310 --> 00:47:37,690
within the business of the effort that I

1102
00:47:35,860 --> 00:47:41,020
was currently going through and leading

1103
00:47:37,690 --> 00:47:44,620
and they were asking me questions so I

1104
00:47:41,020 --> 00:47:46,780
answered truthfully and at the end I

1105
00:47:44,620 --> 00:47:48,580
explained what we were doing when it was

1106
00:47:46,780 --> 00:47:51,360
detected that we I was already working

1107
00:47:48,580 --> 00:47:55,270
with the business as well as the CSO and

1108
00:47:51,360 --> 00:47:57,970
management to go through and to resolve

1109
00:47:55,270 --> 00:48:00,759
this but then something happened I got

1110
00:47:57,970 --> 00:48:03,310
hit with an audit and really that wasn't

1111
00:48:00,760 --> 00:48:05,800
a bad thing at all because as soon as

1112
00:48:03,310 --> 00:48:08,380
there was an audit this got traction

1113
00:48:05,800 --> 00:48:11,350
from senior management all the way up to

1114
00:48:08,380 --> 00:48:15,010
the board level and now whenever I went

1115
00:48:11,350 --> 00:48:17,410
to any group I the response when I said

1116
00:48:15,010 --> 00:48:19,030
hey I need your help doing XYZ was yes

1117
00:48:17,410 --> 00:48:22,299
we'll go through and we'll get that UC

1118
00:48:19,030 --> 00:48:25,330
audit they have a very great purpose

1119
00:48:22,300 --> 00:48:28,270
they are there to make sure of the

1120
00:48:25,330 --> 00:48:29,890
continuity of our businesses they're

1121
00:48:28,270 --> 00:48:32,980
there to help make sure that we meet any

1122
00:48:29,890 --> 00:48:34,609
rule law regulation and they have a seat

1123
00:48:32,980 --> 00:48:37,009
of trust at the very

1124
00:48:34,609 --> 00:48:40,339
most senior levels so if we can make

1125
00:48:37,009 --> 00:48:43,220
allies by helping audit automate their

1126
00:48:40,339 --> 00:48:46,009
job that starts out a very good

1127
00:48:43,220 --> 00:48:50,538
relationship that is for the betterment

1128
00:48:46,009 --> 00:48:52,640
of both groups so audit does not need to

1129
00:48:50,539 --> 00:48:55,849
be the bad guy in fact now we need to be

1130
00:48:52,640 --> 00:48:57,529
brothers and sisters with our auditing

1131
00:48:55,849 --> 00:48:59,509
team they are there to hold us

1132
00:48:57,529 --> 00:49:02,720
accountable they're there to make sure

1133
00:48:59,509 --> 00:49:06,259
that the business can be sustained and I

1134
00:49:02,720 --> 00:49:08,959
with that I need to go through and to

1135
00:49:06,259 --> 00:49:11,450
bring this presentation to a close I

1136
00:49:08,960 --> 00:49:14,119
would love to continue this conversation

1137
00:49:11,450 --> 00:49:16,970
here there anywhere please feel free to

1138
00:49:14,119 --> 00:49:19,819
reach out to me my slides are on the

1139
00:49:16,970 --> 00:49:22,788
github just github.com slash my cat K

1140
00:49:19,819 --> 00:49:25,269
Brown thank you very much once again to

1141
00:49:22,789 --> 00:49:27,890
everyone involved with Circle City Con

1142
00:49:25,269 --> 00:49:30,558
this conference has meant a lot to me

1143
00:49:27,890 --> 00:49:31,940
both professionally and personally thank

1144
00:49:30,559 --> 00:49:34,480
you very much and have a great rest of

1145
00:49:31,940 --> 00:49:34,480
your conference

