1
00:00:01,040 --> 00:00:12,290
I am Colin I'm here today to present on

2
00:00:09,349 --> 00:00:14,299
Chrome extensions by the way if you have

3
00:00:12,290 --> 00:00:16,580
any questions at all at any point during

4
00:00:14,299 --> 00:00:25,399
the talk feel free just to drop it in

5
00:00:16,580 --> 00:00:27,860
the track Tube channel so let me preface

6
00:00:25,399 --> 00:00:30,020
this with why I first started actually

7
00:00:27,860 --> 00:00:32,058
taking a look at Chrome extensions and

8
00:00:30,020 --> 00:00:35,840
some of the motive behind the research

9
00:00:32,058 --> 00:00:39,769
that led to this presentation in August

10
00:00:35,840 --> 00:00:42,050
Google announced the it was start a new

11
00:00:39,770 --> 00:00:44,180
bug bounty program one of those items

12
00:00:42,050 --> 00:00:47,780
that they were putting a bounty on was

13
00:00:44,180 --> 00:00:49,190
Chrome extensions along with apps kind

14
00:00:47,780 --> 00:00:50,630
of a breakdown of what this talk would

15
00:00:49,190 --> 00:00:53,540
look like is first I'm going to talk

16
00:00:50,630 --> 00:00:57,020
about that bounty program my initial

17
00:00:53,540 --> 00:00:59,239
process of collecting data from there

18
00:00:57,020 --> 00:01:01,010
I'm gonna go through a quick crash

19
00:00:59,239 --> 00:01:03,440
course on how to take apart Chrome

20
00:01:01,010 --> 00:01:05,449
extensions kind of figure out what's

21
00:01:03,440 --> 00:01:09,590
going on take a look at communications

22
00:01:05,449 --> 00:01:11,539
and get an idea of what is actually

23
00:01:09,590 --> 00:01:13,659
happening behind the hood of a Chrome

24
00:01:11,540 --> 00:01:15,920
extension in a couple different ways

25
00:01:13,659 --> 00:01:18,530
from there I'm gonna be talking about

26
00:01:15,920 --> 00:01:21,110
the actual results of my research which

27
00:01:18,530 --> 00:01:22,820
is actually threat hunting to find

28
00:01:21,110 --> 00:01:26,210
Chrome extensions that are either

29
00:01:22,820 --> 00:01:28,399
abusing user data privacy or delivering

30
00:01:26,210 --> 00:01:30,169
adware or other things like that I'm

31
00:01:28,400 --> 00:01:32,510
gonna be talking primarily about one

32
00:01:30,170 --> 00:01:34,130
family of Chrome extension called linker

33
00:01:32,510 --> 00:01:36,740
if you don't know what that is don't

34
00:01:34,130 --> 00:01:39,020
worry it's not super common or at least

35
00:01:36,740 --> 00:01:41,060
not well known so I'll be going into

36
00:01:39,020 --> 00:01:43,280
that a couple other examples and then

37
00:01:41,060 --> 00:01:45,890
finally and be talking about how it she

38
00:01:43,280 --> 00:01:48,140
went about disclosing this and what kind

39
00:01:45,890 --> 00:01:50,119
of benefits that had to me specifically

40
00:01:48,140 --> 00:01:52,369
like volunteer awards and stuff and then

41
00:01:50,119 --> 00:01:55,510
we'll have Q&A but feel free to drop any

42
00:01:52,369 --> 00:01:58,580
questions if you have any come up a

43
00:01:55,510 --> 00:02:00,830
little bit about myself I just recently

44
00:01:58,580 --> 00:02:03,170
graduated from Purdue with a degree in

45
00:02:00,830 --> 00:02:05,270
cyber security - one of the first to be

46
00:02:03,170 --> 00:02:07,909
and like the steinberg on the actual

47
00:02:05,270 --> 00:02:10,908
degree so that was certainly interesting

48
00:02:07,909 --> 00:02:12,980
kind of the guinea pig class but it was

49
00:02:10,908 --> 00:02:14,299
it was a good experience overall I just

50
00:02:12,980 --> 00:02:16,910
started actually

51
00:02:14,300 --> 00:02:18,650
my first week at Sophos as a threat

52
00:02:16,910 --> 00:02:22,420
analysts on there managed that response

53
00:02:18,650 --> 00:02:25,190
team and you can find me on Twitter so

54
00:02:22,420 --> 00:02:27,890
background information I kind of started

55
00:02:25,190 --> 00:02:30,260
going into this but Google created this

56
00:02:27,890 --> 00:02:32,510
rewards program called the developer

57
00:02:30,260 --> 00:02:34,570
data protections award program and

58
00:02:32,510 --> 00:02:36,679
essentially there's three different

59
00:02:34,570 --> 00:02:39,440
avenues that you can go about it a you

60
00:02:36,680 --> 00:02:42,590
can look at applications in the Google

61
00:02:39,440 --> 00:02:45,320
Play Store so any application with over

62
00:02:42,590 --> 00:02:47,930
1 million installs is actually in scope

63
00:02:45,320 --> 00:02:50,750
for the bug bounty program the other

64
00:02:47,930 --> 00:02:53,680
thing would be their API so things if

65
00:02:50,750 --> 00:02:56,210
previously known as the Chrome Web Store

66
00:02:53,680 --> 00:02:57,680
applications you could install them and

67
00:02:56,210 --> 00:02:59,000
they would be like Google Docs but I

68
00:02:57,680 --> 00:03:01,520
think third party or something like that

69
00:02:59,000 --> 00:03:04,850
have now moved to the G suite

70
00:03:01,520 --> 00:03:07,970
applications those use the Google API

71
00:03:04,850 --> 00:03:11,269
and if you can find signs of data abuse

72
00:03:07,970 --> 00:03:14,090
or someone abusing that API of a G suite

73
00:03:11,270 --> 00:03:16,000
application of over 50,000 users you can

74
00:03:14,090 --> 00:03:18,530
potentially get a reward there and

75
00:03:16,000 --> 00:03:21,980
finally the one that stood out to me was

76
00:03:18,530 --> 00:03:25,130
Chrome extensions any Chrome extension

77
00:03:21,980 --> 00:03:27,769
with over 50,000 users is in scope to

78
00:03:25,130 --> 00:03:30,049
receive a bug bounty from Google if you

79
00:03:27,770 --> 00:03:32,270
can prove undeniably that that extension

80
00:03:30,050 --> 00:03:34,880
lacks transparency and how it handles

81
00:03:32,270 --> 00:03:37,220
its user data as well or if it's

82
00:03:34,880 --> 00:03:40,040
violating the chrome store minimum user

83
00:03:37,220 --> 00:03:42,650
data privacy requirements so when Google

84
00:03:40,040 --> 00:03:44,120
first announced this last August I knew

85
00:03:42,650 --> 00:03:45,500
I wanted to look at Chrome extensions

86
00:03:44,120 --> 00:03:49,790
I'd done a little bit of stuff with web

87
00:03:45,500 --> 00:03:52,310
but I didn't really know where to start

88
00:03:49,790 --> 00:03:53,630
but I knew I wanted to download a good

89
00:03:52,310 --> 00:03:55,160
bit of Chrome extensions and get a

90
00:03:53,630 --> 00:03:58,130
understand you know what's actually

91
00:03:55,160 --> 00:04:00,799
normal in this environment so I started

92
00:03:58,130 --> 00:04:02,780
developing my own tooling and Python

93
00:04:00,800 --> 00:04:04,520
ended up downloading around like a

94
00:04:02,780 --> 00:04:07,220
thousand extensions that were within

95
00:04:04,520 --> 00:04:10,640
scope of the bounty program store them

96
00:04:07,220 --> 00:04:12,350
offline and then did some just

97
00:04:10,640 --> 00:04:14,238
extracting some more information from

98
00:04:12,350 --> 00:04:16,579
them to create a CSV file with

99
00:04:14,239 --> 00:04:19,010
information on what extensions have

100
00:04:16,579 --> 00:04:21,738
which files and where do those files

101
00:04:19,010 --> 00:04:24,710
actually call out to okay what URLs are

102
00:04:21,738 --> 00:04:27,049
there from there I knew I wanted to take

103
00:04:24,710 --> 00:04:28,250
that and somehow turn it into a bounty

104
00:04:27,050 --> 00:04:30,170
reward

105
00:04:28,250 --> 00:04:32,240
at first I wasn't really sure where I

106
00:04:30,170 --> 00:04:35,900
was gonna go however I started

107
00:04:32,240 --> 00:04:38,180
development anyways so I developed this

108
00:04:35,900 --> 00:04:41,000
tool called chrome lines and is built in

109
00:04:38,180 --> 00:04:42,710
Python 3 and it pretty much just goes

110
00:04:41,000 --> 00:04:46,190
through the Chrome Web Store and

111
00:04:42,710 --> 00:04:48,530
downloads different extensions I have it

112
00:04:46,190 --> 00:04:51,560
part seen for extensions that of course

113
00:04:48,530 --> 00:04:52,940
are in scope saves it offline after I

114
00:04:51,560 --> 00:04:54,650
developed it I learned that there's

115
00:04:52,940 --> 00:04:58,250
actually a better way to do this which

116
00:04:54,650 --> 00:05:02,630
would be to look at the site map of the

117
00:04:58,250 --> 00:05:05,090
Chrome Web Store from there you can use

118
00:05:02,630 --> 00:05:07,070
a script to just crawl that and download

119
00:05:05,090 --> 00:05:10,010
the entire store much faster than in

120
00:05:07,070 --> 00:05:12,440
Python there's actually a speaker Dylan

121
00:05:10,010 --> 00:05:14,870
Katz he's speaking on Saturday at 11:00

122
00:05:12,440 --> 00:05:18,050
a.m. who published a tool which is this

123
00:05:14,870 --> 00:05:19,190
link on the bottom of a script that can

124
00:05:18,050 --> 00:05:21,350
actually download it and clone the

125
00:05:19,190 --> 00:05:23,240
entire Chrome Web Store much faster than

126
00:05:21,350 --> 00:05:25,100
I was able to do in Python but

127
00:05:23,240 --> 00:05:26,930
nonetheless I wanted to do this

128
00:05:25,100 --> 00:05:31,419
partially just to gain the experience

129
00:05:26,930 --> 00:05:31,419
and because I like development in Python

130
00:05:38,020 --> 00:05:43,940
so one of the most prominent tools when

131
00:05:42,110 --> 00:05:45,950
it comes to actually analyzing Chrome

132
00:05:43,940 --> 00:05:48,710
extensions and looking into security of

133
00:05:45,950 --> 00:05:50,300
Chrome extensions is see our excavator I

134
00:05:48,710 --> 00:05:52,820
don't know if that's nice that I

135
00:05:50,300 --> 00:05:55,850
announced it but a tool by duo SEC that

136
00:05:52,820 --> 00:05:59,120
clones the Chrome Web Store every three

137
00:05:55,850 --> 00:06:01,190
hours and develops risk rankings on

138
00:05:59,120 --> 00:06:03,290
Chrome extensions based on its different

139
00:06:01,190 --> 00:06:06,260
policies as well as URLs and a few other

140
00:06:03,290 --> 00:06:07,820
things if you have the ID of an

141
00:06:06,260 --> 00:06:10,640
extension which you can find in the

142
00:06:07,820 --> 00:06:12,830
Chrome Web Store URL you can submit it

143
00:06:10,640 --> 00:06:13,640
to this website application and we'll

144
00:06:12,830 --> 00:06:16,159
give you a report

145
00:06:13,640 --> 00:06:17,900
allow you to view the source code but

146
00:06:16,160 --> 00:06:21,050
one of the things that I think is the

147
00:06:17,900 --> 00:06:22,520
most useful is the entry points feature

148
00:06:21,050 --> 00:06:25,130
which is shown on the right side of the

149
00:06:22,520 --> 00:06:26,930
screen from the actual report of the

150
00:06:25,130 --> 00:06:28,850
extension you can have it edge to the

151
00:06:26,930 --> 00:06:31,690
parts entry points and then from there

152
00:06:28,850 --> 00:06:34,490
it will actually break down and give you

153
00:06:31,690 --> 00:06:36,080
snippets of code that it thinks could

154
00:06:34,490 --> 00:06:39,080
potentially be dangerous so sometimes

155
00:06:36,080 --> 00:06:39,740
this can be just an easy quick wave you

156
00:06:39,080 --> 00:06:42,318
know you're on

157
00:06:39,740 --> 00:06:43,819
else's computer or you don't have access

158
00:06:42,319 --> 00:06:46,310
to offline tools you just want to go to

159
00:06:43,819 --> 00:06:47,599
a website click Submit take a look and

160
00:06:46,310 --> 00:06:51,020
you can see the permission that's some

161
00:06:47,599 --> 00:06:53,509
of the basics however if you want to go

162
00:06:51,020 --> 00:06:56,240
in more depth the tool that I like to

163
00:06:53,509 --> 00:06:58,699
use is called ext analysis which also

164
00:06:56,240 --> 00:07:02,479
works for Firefox extensions not just

165
00:06:58,699 --> 00:07:04,819
Chrome extensions but like CR excavator

166
00:07:02,479 --> 00:07:07,159
you can submit different extensions it

167
00:07:04,819 --> 00:07:08,330
will store it offline run some analysis

168
00:07:07,160 --> 00:07:11,900
and give you information

169
00:07:08,330 --> 00:07:15,109
I find that ext analysis just has a lot

170
00:07:11,900 --> 00:07:17,960
more information available it has source

171
00:07:15,110 --> 00:07:19,580
code viewers that have automatic

172
00:07:17,960 --> 00:07:22,310
beautify errs and can kind of clean up

173
00:07:19,580 --> 00:07:24,409
the JavaScript it has direct links to

174
00:07:22,310 --> 00:07:27,380
search things on the virustotal from the

175
00:07:24,409 --> 00:07:28,699
domain and URL that it finds and one

176
00:07:27,380 --> 00:07:32,630
feature that I think is really cool is

177
00:07:28,699 --> 00:07:34,490
it uses neo4j to plot B files and

178
00:07:32,630 --> 00:07:38,330
actually allow you to gain like a visual

179
00:07:34,490 --> 00:07:41,380
look at what the source code of that

180
00:07:38,330 --> 00:07:41,380
extension looks like

181
00:07:44,469 --> 00:07:50,960
although Exe analysis is good oftentimes

182
00:07:48,680 --> 00:07:53,479
it's not better than actually using the

183
00:07:50,960 --> 00:07:56,330
built-in browser tools so you may have

184
00:07:53,479 --> 00:07:58,400
used expect inspect element as a joke or

185
00:07:56,330 --> 00:08:00,080
something like that or perhaps this part

186
00:07:58,400 --> 00:08:03,560
of your day to day job me use it a lot I

187
00:08:00,080 --> 00:08:05,479
don't know but for Chrome extensions you

188
00:08:03,560 --> 00:08:07,909
can actually access the runtime

189
00:08:05,479 --> 00:08:09,979
environment of that extension installed

190
00:08:07,909 --> 00:08:12,620
in your browser and then do further

191
00:08:09,979 --> 00:08:14,930
testing with these developer tools to do

192
00:08:12,620 --> 00:08:17,990
that you visit Chrome this website

193
00:08:14,930 --> 00:08:20,090
address here enable developer mode and

194
00:08:17,990 --> 00:08:21,650
then from there you can see all your

195
00:08:20,090 --> 00:08:24,049
different extensions will have this new

196
00:08:21,650 --> 00:08:26,270
line that says inspect fuse and if you

197
00:08:24,050 --> 00:08:29,780
click on background HTML will take you

198
00:08:26,270 --> 00:08:32,120
directly to a new window a window of the

199
00:08:29,780 --> 00:08:36,250
runtime instance for that Chrome

200
00:08:32,120 --> 00:08:40,219
extension from there you can actually

201
00:08:36,250 --> 00:08:43,279
interact with the JavaScript variables

202
00:08:40,219 --> 00:08:45,829
you can take a look at what's being

203
00:08:43,279 --> 00:08:48,320
actively stored and going through memory

204
00:08:45,829 --> 00:08:50,089
of that extension as well as you can go

205
00:08:48,320 --> 00:08:50,810
to network and then you can enable it to

206
00:08:50,089 --> 00:08:53,660
law

207
00:08:50,810 --> 00:08:58,670
and store different Network requests and

208
00:08:53,660 --> 00:09:00,410
even started to kind of Mandal some of

209
00:08:58,670 --> 00:09:02,689
the traffic between the extension and be

210
00:09:00,410 --> 00:09:12,380
able to filter better to exactly what is

211
00:09:02,690 --> 00:09:14,779
coming from this extension so these

212
00:09:12,380 --> 00:09:18,290
tools are good and if you just are an

213
00:09:14,779 --> 00:09:20,960
user of Chrome extensions and you're

214
00:09:18,290 --> 00:09:23,120
curious what's actually happening then

215
00:09:20,960 --> 00:09:26,240
that might these tools might do the job

216
00:09:23,120 --> 00:09:28,820
now when you have an entire clone of a

217
00:09:26,240 --> 00:09:30,529
thousand extensions or five thousand

218
00:09:28,820 --> 00:09:33,080
extensions or something like that and

219
00:09:30,529 --> 00:09:34,910
you want it to be able to do analysis on

220
00:09:33,080 --> 00:09:37,400
all them is gonna take a lot longer

221
00:09:34,910 --> 00:09:39,550
which is why I started researching into

222
00:09:37,400 --> 00:09:41,839
how to automate that with Python and

223
00:09:39,550 --> 00:09:45,589
because I enjoy Python kind of a

224
00:09:41,839 --> 00:09:48,380
reoccurring theme here however so the

225
00:09:45,589 --> 00:09:51,410
code you see here is a simple snippet of

226
00:09:48,380 --> 00:09:55,839
what it takes to load up a Chrome

227
00:09:51,410 --> 00:09:58,699
extension in Python with the chrome

228
00:09:55,839 --> 00:10:01,160
selenium webdriver so this will create a

229
00:09:58,700 --> 00:10:04,130
new Chrome window install the Chrome

230
00:10:01,160 --> 00:10:06,469
extension from disk set it up to use

231
00:10:04,130 --> 00:10:08,240
your proxy so you can run any kind of

232
00:10:06,470 --> 00:10:09,830
proxy on your own side whether that's

233
00:10:08,240 --> 00:10:13,430
where I like to use men in the middle

234
00:10:09,830 --> 00:10:15,410
proxy and then from there actually start

235
00:10:13,430 --> 00:10:17,750
to intercept all traffic from the

236
00:10:15,410 --> 00:10:19,130
browser so not just the traffic from the

237
00:10:17,750 --> 00:10:22,460
Chrome extension but everything from

238
00:10:19,130 --> 00:10:24,020
that new browser instance and then now

239
00:10:22,460 --> 00:10:27,260
you can start to do a little bit more

240
00:10:24,020 --> 00:10:28,880
with dynamic analysis and building off

241
00:10:27,260 --> 00:10:31,010
of it since it is in Python you can

242
00:10:28,880 --> 00:10:37,580
really do a lot with some simple

243
00:10:31,010 --> 00:10:40,160
automation so after spending a few

244
00:10:37,580 --> 00:10:42,589
months in the fall of my last school

245
00:10:40,160 --> 00:10:46,040
semester kind of working on this project

246
00:10:42,589 --> 00:10:47,959
on the side developing when I can trying

247
00:10:46,040 --> 00:10:50,029
to figure out why my spider kept

248
00:10:47,959 --> 00:10:52,369
crashing and having issues with reggae

249
00:10:50,029 --> 00:10:54,200
URL parsing you know the fun thing is

250
00:10:52,370 --> 00:10:56,420
you expecting your side projects I

251
00:10:54,200 --> 00:10:59,660
decided that it was time to get more

252
00:10:56,420 --> 00:11:03,439
focused getting more precise

253
00:10:59,660 --> 00:11:05,930
and target specific families of adware

254
00:11:03,440 --> 00:11:08,600
and malware that have been found in the

255
00:11:05,930 --> 00:11:11,300
Chrome extension store before so like

256
00:11:08,600 --> 00:11:15,140
what is needed I did my background

257
00:11:11,300 --> 00:11:19,969
research and first I found this article

258
00:11:15,140 --> 00:11:26,150
by ad guard about uni mania essentially

259
00:11:19,970 --> 00:11:29,420
it was some fake ad blockers they had

260
00:11:26,150 --> 00:11:31,310
video downloaders PDF mergers the kind

261
00:11:29,420 --> 00:11:34,310
of utilities that people actually use in

262
00:11:31,310 --> 00:11:36,859
the chrome store and when you installed

263
00:11:34,310 --> 00:11:39,469
it it would immediately grab your

264
00:11:36,860 --> 00:11:41,300
information and then register you within

265
00:11:39,470 --> 00:11:43,670
their commanding control server and then

266
00:11:41,300 --> 00:11:46,370
ultimately start to scrape some of your

267
00:11:43,670 --> 00:11:51,199
social media information post you visit

268
00:11:46,370 --> 00:11:54,140
websites to visit but I was able to find

269
00:11:51,200 --> 00:11:57,440
a Chrome extension being operated by the

270
00:11:54,140 --> 00:11:59,150
same group that was actually live in the

271
00:11:57,440 --> 00:12:02,840
chrome store called video downloader

272
00:11:59,150 --> 00:12:05,660
with over a million users so I looked at

273
00:12:02,840 --> 00:12:07,910
the URLs that I parsed out from my

274
00:12:05,660 --> 00:12:09,880
Python script and I saw a couple

275
00:12:07,910 --> 00:12:12,230
different ones that referenced

276
00:12:09,880 --> 00:12:14,689
weird-lookin addresses took a look into

277
00:12:12,230 --> 00:12:16,400
it and found this extension and

278
00:12:14,690 --> 00:12:18,500
alternately was able to correlate it

279
00:12:16,400 --> 00:12:21,709
back to some of the other research

280
00:12:18,500 --> 00:12:23,870
posted by a guard now what does this

281
00:12:21,710 --> 00:12:26,350
actually look like in terms of

282
00:12:23,870 --> 00:12:29,360
communication when you install this

283
00:12:26,350 --> 00:12:30,940
video downloader the first thing it does

284
00:12:29,360 --> 00:12:34,130
is it reaches out to this

285
00:12:30,940 --> 00:12:37,460
strange-looking s3 bucket which for the

286
00:12:34,130 --> 00:12:40,130
record is the exact same as three bucket

287
00:12:37,460 --> 00:12:44,150
that was included in the report by a hat

288
00:12:40,130 --> 00:12:45,910
guard in 2018 so I guess you know not

289
00:12:44,150 --> 00:12:48,470
much concern for having to change

290
00:12:45,910 --> 00:12:51,860
operational security and tool in an

291
00:12:48,470 --> 00:12:54,350
infrastructure you can see they have my

292
00:12:51,860 --> 00:12:58,250
device that I was using my user agent

293
00:12:54,350 --> 00:12:59,990
string on a unique seed and just a

294
00:12:58,250 --> 00:13:02,350
couple of strings it's like device

295
00:12:59,990 --> 00:13:05,720
install not nothing too bad at first

296
00:13:02,350 --> 00:13:09,470
however it gets worst this extension

297
00:13:05,720 --> 00:13:12,499
actually had custom different libraries

298
00:13:09,470 --> 00:13:14,659
for social media that would inject

299
00:13:12,499 --> 00:13:17,959
grips into your browser and then collect

300
00:13:14,659 --> 00:13:20,509
information about what extensions or

301
00:13:17,959 --> 00:13:25,159
what tweets you view Promoted Tweet

302
00:13:20,509 --> 00:13:26,269
information user account information so

303
00:13:25,159 --> 00:13:28,609
you can see on the right here it's

304
00:13:26,269 --> 00:13:31,449
collecting the unique ids of tweets and

305
00:13:28,609 --> 00:13:33,469
you can see that the there's another

306
00:13:31,449 --> 00:13:36,258
variable here referencing the Chrome

307
00:13:33,469 --> 00:13:40,279
extension itself this was taken and

308
00:13:36,259 --> 00:13:42,289
developer tools of chrome by the way on

309
00:13:40,279 --> 00:13:45,859
the left here there's a different domain

310
00:13:42,289 --> 00:13:49,209
that it communicates FB downloader

311
00:13:45,859 --> 00:13:52,069
dotnet slapped filter slash adult and

312
00:13:49,209 --> 00:13:55,218
within the actual forum data it will

313
00:13:52,069 --> 00:13:58,419
collect the URL that you are visiting

314
00:13:55,219 --> 00:14:03,649
for every page you visit as well as your

315
00:13:58,419 --> 00:14:06,949
unique buit ID for the installation of

316
00:14:03,649 --> 00:14:10,129
that browser not great stuff however

317
00:14:06,949 --> 00:14:12,669
most of my research has been focused on

318
00:14:10,129 --> 00:14:18,409
the linker family of my way

319
00:14:12,669 --> 00:14:20,839
what is linker linker is a I said in my

320
00:14:18,409 --> 00:14:22,789
overview that it was a persistent threat

321
00:14:20,839 --> 00:14:25,879
that wasn't very advanced but in reality

322
00:14:22,789 --> 00:14:28,669
they are somewhat advanced in the sense

323
00:14:25,879 --> 00:14:32,059
they've been around for almost over

324
00:14:28,669 --> 00:14:35,209
seven years now and they managed to have

325
00:14:32,059 --> 00:14:36,649
massive campaigns ton of infections I

326
00:14:35,209 --> 00:14:40,518
guarantee you they're making good money

327
00:14:36,649 --> 00:14:42,499
but you'll see why I say they're not

328
00:14:40,519 --> 00:14:45,470
necessarily most advanced later on but

329
00:14:42,499 --> 00:14:47,869
how they actually make profit and what

330
00:14:45,470 --> 00:14:50,989
they actually do is redirecting user

331
00:14:47,869 --> 00:14:52,939
traffic and performing different sort of

332
00:14:50,989 --> 00:14:55,879
cookie stuffing so when you visit

333
00:14:52,939 --> 00:14:59,118
something like Amazon or another website

334
00:14:55,879 --> 00:15:01,039
that has affiliates and promotions it

335
00:14:59,119 --> 00:15:02,659
will inject stuff into your browser to

336
00:15:01,039 --> 00:15:05,169
make sure they make some money for

337
00:15:02,659 --> 00:15:07,669
quote-unquote referring you to the site

338
00:15:05,169 --> 00:15:11,109
but they've also been seen to deliver

339
00:15:07,669 --> 00:15:14,359
other adware as such as clean miners

340
00:15:11,109 --> 00:15:16,429
however you know chrome already uses

341
00:15:14,359 --> 00:15:19,009
enough RAM you add queen' miners to

342
00:15:16,429 --> 00:15:20,569
every site you visit and things can get

343
00:15:19,009 --> 00:15:23,859
pretty slow pretty quickly so I don't

344
00:15:20,569 --> 00:15:23,858
think that worked out well for them

345
00:15:24,310 --> 00:15:31,449
this research also really really helpful

346
00:15:28,209 --> 00:15:33,910
and honestly without other researchers

347
00:15:31,449 --> 00:15:36,040
sharing information like this and giving

348
00:15:33,910 --> 00:15:38,980
open public reports with indicators of

349
00:15:36,040 --> 00:15:40,660
compromise this entire project I did and

350
00:15:38,980 --> 00:15:46,529
research I did probably would not have

351
00:15:40,660 --> 00:15:49,689
been possible so from the report from

352
00:15:46,529 --> 00:15:51,670
security Street the company that shared

353
00:15:49,689 --> 00:15:54,759
a lot of indicators of compromise of a

354
00:15:51,670 --> 00:15:57,790
linker campaign in early 2019 I was able

355
00:15:54,759 --> 00:15:59,970
to actually threat hunt and find more

356
00:15:57,790 --> 00:16:04,540
infrastructure being used for these

357
00:15:59,970 --> 00:16:06,550
campaigns there is a handful of ways

358
00:16:04,540 --> 00:16:09,129
that I was able to pivot between pieces

359
00:16:06,550 --> 00:16:11,229
of information and find out more about

360
00:16:09,129 --> 00:16:14,079
this threat actor and their Chrome

361
00:16:11,230 --> 00:16:15,850
extensions I'm sure that there's even

362
00:16:14,079 --> 00:16:18,459
more ways to do it from what's listed on

363
00:16:15,850 --> 00:16:22,870
this page but particularly what really

364
00:16:18,459 --> 00:16:24,910
helped was DNS and overlapping just

365
00:16:22,870 --> 00:16:27,660
infrastructure of using the same servers

366
00:16:24,910 --> 00:16:30,459
for different websites and applications

367
00:16:27,660 --> 00:16:33,639
but there were other aspects to it like

368
00:16:30,459 --> 00:16:36,779
looking at the code offline and using

369
00:16:33,639 --> 00:16:39,579
some signatures there which I'll go into

370
00:16:36,779 --> 00:16:42,459
so for those who haven't heard of URL

371
00:16:39,579 --> 00:16:45,029
scan dot IO it's basically like

372
00:16:42,459 --> 00:16:49,329
virustotal or one of those other online

373
00:16:45,029 --> 00:16:51,879
analysis platforms but for URLs I really

374
00:16:49,329 --> 00:16:56,439
like it it has a great search feature

375
00:16:51,879 --> 00:16:59,339
which I was able to use to hunt on one

376
00:16:56,439 --> 00:17:02,170
of the IP addresses that was originally

377
00:16:59,339 --> 00:17:05,559
disclosed in previous link or Chrome

378
00:17:02,170 --> 00:17:08,289
extension reports you may see this part

379
00:17:05,559 --> 00:17:11,770
here that says end L T equals that's

380
00:17:08,289 --> 00:17:14,379
actually a parameter that's used by the

381
00:17:11,770 --> 00:17:16,929
linker adware to communicate with its

382
00:17:14,380 --> 00:17:18,909
command and control servers so one thing

383
00:17:16,929 --> 00:17:22,179
you may notice right away is these

384
00:17:18,909 --> 00:17:24,399
heartbeats essentially these extensions

385
00:17:22,179 --> 00:17:27,370
that they use and the link are add where

386
00:17:24,398 --> 00:17:29,709
we use flow heartbeat and just kind of

387
00:17:27,369 --> 00:17:32,439
beacon to a server until it receives a

388
00:17:29,710 --> 00:17:35,080
configuration that has a second stage of

389
00:17:32,440 --> 00:17:36,320
JavaScript unfortunately through most of

390
00:17:35,080 --> 00:17:38,330
my research I haven't

391
00:17:36,320 --> 00:17:39,980
been able to see their second state of

392
00:17:38,330 --> 00:17:43,279
JavaScript that much because they do

393
00:17:39,980 --> 00:17:46,070
really good environment checking but you

394
00:17:43,279 --> 00:17:49,399
can actually see some of these second

395
00:17:46,070 --> 00:17:54,168
stages in previous data including stuff

396
00:17:49,399 --> 00:17:56,658
that has been on you are else can do for

397
00:17:54,169 --> 00:18:00,440
an example we can look at this IP

398
00:17:56,659 --> 00:18:02,990
address and the specific report of a URL

399
00:18:00,440 --> 00:18:07,130
hosted on that IP to a domain called

400
00:18:02,990 --> 00:18:09,950
what's chrome org I actually was able to

401
00:18:07,130 --> 00:18:12,440
pivot from this and find a Chrome

402
00:18:09,950 --> 00:18:14,570
extension that was like a whatsapp login

403
00:18:12,440 --> 00:18:17,269
is like what's that for desktop totally

404
00:18:14,570 --> 00:18:20,600
just legit it may have been at one point

405
00:18:17,269 --> 00:18:26,960
but it was delivering adware and being

406
00:18:20,600 --> 00:18:30,080
used as a mechanism for redirecting

407
00:18:26,960 --> 00:18:32,990
traffic and other malicious activity so

408
00:18:30,080 --> 00:18:35,509
in this specific requests this might

409
00:18:32,990 --> 00:18:38,049
look like gibberish but this right here

410
00:18:35,509 --> 00:18:41,299
is actually the ID of a Chrome extension

411
00:18:38,049 --> 00:18:45,730
so on the web store every single Chrome

412
00:18:41,299 --> 00:18:49,100
extension has a unique ID that is just

413
00:18:45,730 --> 00:18:50,450
different lowercase characters no

414
00:18:49,100 --> 00:18:54,320
numbers

415
00:18:50,450 --> 00:18:56,659
I think it's 32 characters and the

416
00:18:54,320 --> 00:18:59,120
linker chrome accentuation broadcasts

417
00:18:56,659 --> 00:19:01,759
their ID in the web request which made

418
00:18:59,120 --> 00:19:03,860
it easy to actually go from a threat

419
00:19:01,759 --> 00:19:08,000
feed to figure out what extensions are

420
00:19:03,860 --> 00:19:13,418
they talking about in this case like

421
00:19:08,000 --> 00:19:15,830
search for this and you will find

422
00:19:13,419 --> 00:19:24,700
third-party Chrome extension web stores

423
00:19:15,830 --> 00:19:27,559
talking about what's green 4.6 now this

424
00:19:24,700 --> 00:19:33,350
here is not necessarily the easiest to

425
00:19:27,559 --> 00:19:36,710
view but what is going on here is

426
00:19:33,350 --> 00:19:38,330
essentially it has these environment C

427
00:19:36,710 --> 00:19:43,460
IDs which are different chrome

428
00:19:38,330 --> 00:19:45,620
extensions and the the Chrome extension

429
00:19:43,460 --> 00:19:47,659
that was receiving this configuration

430
00:19:45,620 --> 00:19:49,120
would check and make sure that all these

431
00:19:47,659 --> 00:19:51,610
other chrome extension

432
00:19:49,120 --> 00:19:54,280
you know war-worn installed before

433
00:19:51,610 --> 00:20:00,280
delivery in the second stage from there

434
00:19:54,280 --> 00:20:03,040
it would actually inject different

435
00:20:00,280 --> 00:20:08,770
content into iframes as well as redirect

436
00:20:03,040 --> 00:20:10,480
traffic to specific domains but from URL

437
00:20:08,770 --> 00:20:12,340
scan one of the things that I was able

438
00:20:10,480 --> 00:20:15,490
to do and pivot to other hosts is

439
00:20:12,340 --> 00:20:18,790
actually search for different reports

440
00:20:15,490 --> 00:20:21,160
that were on that same domain or

441
00:20:18,790 --> 00:20:22,629
tsoukalos a new IP address which as you

442
00:20:21,160 --> 00:20:26,740
can see there are things like video

443
00:20:22,630 --> 00:20:30,910
downloaders like FL players which stood

444
00:20:26,740 --> 00:20:34,180
for Flash Player you block ext dark

445
00:20:30,910 --> 00:20:36,190
YouTube flash playlist VLC players all

446
00:20:34,180 --> 00:20:39,430
these are domains that communicate to

447
00:20:36,190 --> 00:20:44,080
linker Chrome extensions that pose as

448
00:20:39,430 --> 00:20:47,410
fake downloaders they pose as the social

449
00:20:44,080 --> 00:20:49,480
media but on the desktop version they

450
00:20:47,410 --> 00:20:52,660
poses Flash Player all the time ad

451
00:20:49,480 --> 00:20:55,480
blockers and so from here I was able to

452
00:20:52,660 --> 00:20:58,210
actually find some of these Chrome

453
00:20:55,480 --> 00:21:00,730
extensions broadcasting their IDs start

454
00:20:58,210 --> 00:21:06,100
doing analysis and researching the

455
00:21:00,730 --> 00:21:07,990
threat actors behind it so here's an

456
00:21:06,100 --> 00:21:10,030
example of just some of the domains that

457
00:21:07,990 --> 00:21:12,370
are hosted on the same ip address if

458
00:21:10,030 --> 00:21:15,580
this adversary had used entirely

459
00:21:12,370 --> 00:21:18,100
different infrastructure you know

460
00:21:15,580 --> 00:21:19,750
switched up hosting providers changed

461
00:21:18,100 --> 00:21:22,030
how they were malware communicated maybe

462
00:21:19,750 --> 00:21:23,770
it would have been harder to detect and

463
00:21:22,030 --> 00:21:26,110
they could have had it under the radar

464
00:21:23,770 --> 00:21:27,340
for a lot longer but considering they

465
00:21:26,110 --> 00:21:31,389
had tons and tons of different

466
00:21:27,340 --> 00:21:34,330
extensions and other things all hosted

467
00:21:31,390 --> 00:21:37,150
on the same IP address and IP address

468
00:21:34,330 --> 00:21:41,639
was known to be used in past link or

469
00:21:37,150 --> 00:21:41,640
malware it made it a lot easier to pivot

470
00:21:42,930 --> 00:21:52,600
now I did mention that I also used some

471
00:21:47,020 --> 00:21:54,639
signatures on disk to hunt for linker

472
00:21:52,600 --> 00:21:56,740
malware so what you see in the top right

473
00:21:54,640 --> 00:21:58,690
here is a screenshot of some of the code

474
00:21:56,740 --> 00:22:01,540
from one of these extensions

475
00:21:58,690 --> 00:22:02,800
specifically one that communicates the

476
00:22:01,540 --> 00:22:06,010
FL player

477
00:22:02,800 --> 00:22:09,220
which this extension in particular was

478
00:22:06,010 --> 00:22:12,730
some sort of Flash Player or something

479
00:22:09,220 --> 00:22:14,320
like that now most of their extensions

480
00:22:12,730 --> 00:22:16,840
have a heartbeat functionality as I

481
00:22:14,320 --> 00:22:18,460
briefly mentioned earlier this is what

482
00:22:16,840 --> 00:22:20,649
that actually looks like on codes you

483
00:22:18,460 --> 00:22:23,080
can see it grabbing certain times doing

484
00:22:20,650 --> 00:22:26,320
some conditionals and then encoding a

485
00:22:23,080 --> 00:22:29,110
web request one of the features that I

486
00:22:26,320 --> 00:22:32,379
found really interesting for the sake of

487
00:22:29,110 --> 00:22:35,949
developing a signature was the user ID

488
00:22:32,380 --> 00:22:37,900
down here so all of their different

489
00:22:35,950 --> 00:22:43,420
extensions would develop different user

490
00:22:37,900 --> 00:22:46,780
IDs but sometimes this Xero would change

491
00:22:43,420 --> 00:22:48,850
numbers depending on the application or

492
00:22:46,780 --> 00:22:51,580
other things like that so I was able to

493
00:22:48,850 --> 00:22:55,290
use Yarra signatures which is a pattern

494
00:22:51,580 --> 00:22:58,840
matching signature library to develop

495
00:22:55,290 --> 00:23:00,520
detection on this code but allow it to

496
00:22:58,840 --> 00:23:02,350
be somewhat modular so if there was a

497
00:23:00,520 --> 00:23:05,260
different extension that had this string

498
00:23:02,350 --> 00:23:07,750
but with a different number here it

499
00:23:05,260 --> 00:23:09,460
would still detect it as well as added

500
00:23:07,750 --> 00:23:11,380
in detection on a bunch of the different

501
00:23:09,460 --> 00:23:16,420
functions that was used in their names

502
00:23:11,380 --> 00:23:18,460
in JavaScript from there I actually

503
00:23:16,420 --> 00:23:21,040
scanned the extensions that I downloaded

504
00:23:18,460 --> 00:23:25,720
offline and was able to gain not only

505
00:23:21,040 --> 00:23:27,580
somewhere in sight on linker extensions

506
00:23:25,720 --> 00:23:30,250
but also find some other Chrome

507
00:23:27,580 --> 00:23:33,340
extensions that had a functionality that

508
00:23:30,250 --> 00:23:35,080
were similar and but weren't actually

509
00:23:33,340 --> 00:23:37,840
linker and that helped me improve my

510
00:23:35,080 --> 00:23:44,139
signatures over time and help gain a

511
00:23:37,840 --> 00:23:45,610
better detection thresholds as well okay

512
00:23:44,140 --> 00:23:49,150
we're gonna talk about some examples

513
00:23:45,610 --> 00:23:52,750
here of different Chrome extensions I

514
00:23:49,150 --> 00:23:54,160
found out there in the wilds and how you

515
00:23:52,750 --> 00:23:56,160
can actually tell they're malicious and

516
00:23:54,160 --> 00:23:58,810
then I'll be talking about some of the

517
00:23:56,160 --> 00:24:00,190
challenges and interesting insights and

518
00:23:58,810 --> 00:24:06,520
disclosing this and trying to make a

519
00:24:00,190 --> 00:24:08,680
bounty first video downloader like a lot

520
00:24:06,520 --> 00:24:11,160
of their extensions they will beacon to

521
00:24:08,680 --> 00:24:13,660
a command control server look for

522
00:24:11,160 --> 00:24:15,510
additional configuration and then if it

523
00:24:13,660 --> 00:24:19,380
receives you configure

524
00:24:15,510 --> 00:24:21,090
it will load it the script into every

525
00:24:19,380 --> 00:24:23,130
single page you visit regardless of the

526
00:24:21,090 --> 00:24:25,590
content on it and then from there

527
00:24:23,130 --> 00:24:28,200
perform malicious activity or something

528
00:24:25,590 --> 00:24:30,449
like that but if you want any receiver

529
00:24:28,200 --> 00:24:34,980
that script you'd have to bypass and

530
00:24:30,450 --> 00:24:37,670
actually receive the second stage which

531
00:24:34,980 --> 00:24:40,560
I haven't been able to replicate

532
00:24:37,670 --> 00:24:42,350
forcefully some people have reported

533
00:24:40,560 --> 00:24:44,310
seeing it after like a week-long

534
00:24:42,350 --> 00:24:45,990
installation or things like that so it

535
00:24:44,310 --> 00:24:50,790
may be some sort of server-side

536
00:24:45,990 --> 00:24:53,250
verification so one thing that stood out

537
00:24:50,790 --> 00:24:54,990
as I was reviewing these extensions as I

538
00:24:53,250 --> 00:24:56,910
kept seeing a bunch of extensions that

539
00:24:54,990 --> 00:24:59,400
had the exact same set of permissions

540
00:24:56,910 --> 00:25:01,500
which is shown here I guess for some

541
00:24:59,400 --> 00:25:04,140
reason they decide that's what's needed

542
00:25:01,500 --> 00:25:06,750
but it does give them the ability to

543
00:25:04,140 --> 00:25:08,820
filter any web request in the browser it

544
00:25:06,750 --> 00:25:11,760
gives them the ability to use Chrome

545
00:25:08,820 --> 00:25:16,790
storage to save configurations offline

546
00:25:11,760 --> 00:25:19,320
and it gives them access to like

547
00:25:16,790 --> 00:25:21,030
interact with the tab you're on but I

548
00:25:19,320 --> 00:25:24,389
think that may have actually been just

549
00:25:21,030 --> 00:25:27,649
the default of the video professionals

550
00:25:24,390 --> 00:25:30,720
downloader anyways it was not legitimate

551
00:25:27,650 --> 00:25:33,810
these are some impressions it uses but

552
00:25:30,720 --> 00:25:36,270
let me talk about one of a very similar

553
00:25:33,810 --> 00:25:38,490
Chrome extension that gained a lot more

554
00:25:36,270 --> 00:25:42,139
visibility and also helped me report

555
00:25:38,490 --> 00:25:45,120
this whole thing page ruler in March

556
00:25:42,140 --> 00:25:48,750
Brian Krebs the author of Crimson

557
00:25:45,120 --> 00:25:50,699
security posted a blog posts called the

558
00:25:48,750 --> 00:25:54,090
case for limiting a browser extension

559
00:25:50,700 --> 00:25:57,270
and essentially the Chrome extension

560
00:25:54,090 --> 00:26:00,350
page ruler which had about 40,000

561
00:25:57,270 --> 00:26:02,730
400,000 downloads at the time had

562
00:26:00,350 --> 00:26:05,850
impacted Brian Krebs or he had saw

563
00:26:02,730 --> 00:26:09,090
adware delivery in the browser and ended

564
00:26:05,850 --> 00:26:10,919
up writing a article at the time I was

565
00:26:09,090 --> 00:26:13,320
actually in the process of disclosing

566
00:26:10,920 --> 00:26:15,930
that to Google through the hacker one

567
00:26:13,320 --> 00:26:18,020
bug bounty platform and had about a

568
00:26:15,930 --> 00:26:21,140
handful of other linker extensions

569
00:26:18,020 --> 00:26:24,370
reported at the same time

570
00:26:21,140 --> 00:26:26,900
this after Krebs wrote about it Google

571
00:26:24,370 --> 00:26:29,750
kind of noticed my reports a lot quicker

572
00:26:26,900 --> 00:26:31,730
and sped up that disclosure process but

573
00:26:29,750 --> 00:26:36,140
the thing that makes this extension

574
00:26:31,730 --> 00:26:37,760
really noticeable more than just crimes

575
00:26:36,140 --> 00:26:41,000
getting infected is it was actually a

576
00:26:37,760 --> 00:26:42,500
decent extension it essentially you

577
00:26:41,000 --> 00:26:44,900
could press it and it would show you

578
00:26:42,500 --> 00:26:46,370
grids so you can measure your content

579
00:26:44,900 --> 00:26:48,380
and if you were like a web design or

580
00:26:46,370 --> 00:26:50,300
something like that and make it a little

581
00:26:48,380 --> 00:26:52,880
bit easier to understand and see how big

582
00:26:50,300 --> 00:26:56,180
things need to be or whatever something

583
00:26:52,880 --> 00:26:58,850
like that but a certain company a threat

584
00:26:56,180 --> 00:27:00,680
actor behind linker was purchasing

585
00:26:58,850 --> 00:27:03,980
Chrome extensions and a lot of times yes

586
00:27:00,680 --> 00:27:07,490
they do get shitty chrome extension or

587
00:27:03,980 --> 00:27:09,950
poorly developed Chrome extensions like

588
00:27:07,490 --> 00:27:12,950
fake video downloaders and flash

589
00:27:09,950 --> 00:27:15,770
downloaders but they would also

590
00:27:12,950 --> 00:27:20,780
occasionally buy high quality Chrome

591
00:27:15,770 --> 00:27:24,889
extensions like this one now you may be

592
00:27:20,780 --> 00:27:27,440
wondering who is behind this previously

593
00:27:24,890 --> 00:27:30,470
some reports mentioned a shell company

594
00:27:27,440 --> 00:27:33,860
called BR code or broke code based out

595
00:27:30,470 --> 00:27:37,100
of Hong Kong security street hinted that

596
00:27:33,860 --> 00:27:42,679
there appears to be ties to Eastern

597
00:27:37,100 --> 00:27:45,590
Europe and that region however I can say

598
00:27:42,680 --> 00:27:47,240
definitively the threat actors behind

599
00:27:45,590 --> 00:27:52,689
this aren't necessarily going for

600
00:27:47,240 --> 00:27:55,670
stealth so that extension page ruler

601
00:27:52,690 --> 00:27:58,520
communicated to a domain called page -

602
00:27:55,670 --> 00:28:00,110
ruler com one of the things that I

603
00:27:58,520 --> 00:28:01,700
checked for when I was investigating

604
00:28:00,110 --> 00:28:04,580
this domain was the presence of a git

605
00:28:01,700 --> 00:28:07,400
repository so even though the website

606
00:28:04,580 --> 00:28:08,990
wasn't advertising that it was built on

607
00:28:07,400 --> 00:28:11,480
with git or anything like that I can't

608
00:28:08,990 --> 00:28:15,140
just have to check guess but it did have

609
00:28:11,480 --> 00:28:17,600
a git configuration file that referenced

610
00:28:15,140 --> 00:28:18,950
a private gitlab repository that is

611
00:28:17,600 --> 00:28:22,399
shown on the left side of the screen

612
00:28:18,950 --> 00:28:26,390
monetize Escom the repo name is promo

613
00:28:22,400 --> 00:28:29,000
sites page ruler dot git coincidentally

614
00:28:26,390 --> 00:28:30,320
after I discovered this I went and

615
00:28:29,000 --> 00:28:32,830
checked and a ton of the other

616
00:28:30,320 --> 00:28:35,230
extensions that had already been

617
00:28:32,830 --> 00:28:37,720
also had get configurations that

618
00:28:35,230 --> 00:28:40,630
referenced a prize a pride that get lab

619
00:28:37,720 --> 00:28:44,170
repository so I wondered to myself who

620
00:28:40,630 --> 00:28:47,440
is monetizes well I visited their site

621
00:28:44,170 --> 00:28:50,770
and they don't necessarily make it very

622
00:28:47,440 --> 00:28:53,800
hidden with the we're buying Chrome

623
00:28:50,770 --> 00:28:55,990
extensions so I ended up doing some

624
00:28:53,800 --> 00:28:57,850
research on them trying to figure out a

625
00:28:55,990 --> 00:29:00,580
little bit more about this threat actor

626
00:28:57,850 --> 00:29:03,639
and some of that intentions when

627
00:29:00,580 --> 00:29:06,189
ultimately I kept following the thread

628
00:29:03,640 --> 00:29:09,250
and I found this forum posting on a

629
00:29:06,190 --> 00:29:11,440
forum called go biz which is based

630
00:29:09,250 --> 00:29:13,570
it's a russian language forum it's been

631
00:29:11,440 --> 00:29:15,910
around for a good bit of time but it's

632
00:29:13,570 --> 00:29:18,340
essentially used for affiliates spam

633
00:29:15,910 --> 00:29:22,900
networks things like that and I found

634
00:29:18,340 --> 00:29:26,889
this post from 2015 about actually 2013

635
00:29:22,900 --> 00:29:30,940
excuse me 2015 sorry the user registered

636
00:29:26,890 --> 00:29:33,130
2013 but this post for 2015 about the

637
00:29:30,940 --> 00:29:37,120
launch of monetize us an affiliate

638
00:29:33,130 --> 00:29:39,040
program that the solution is offering

639
00:29:37,120 --> 00:29:42,489
two different website owners network

640
00:29:39,040 --> 00:29:45,280
owners JavaScript owners and distribute

641
00:29:42,490 --> 00:29:48,190
distributors and browser extension

642
00:29:45,280 --> 00:29:51,030
owners claiming they monetize via

643
00:29:48,190 --> 00:29:56,470
coupons smart links in text ads

644
00:29:51,030 --> 00:30:01,660
pop-unders and banners minimum volume

645
00:29:56,470 --> 00:30:05,350
5,000 users exploring some of this users

646
00:30:01,660 --> 00:30:08,440
activity on the same forum and I found a

647
00:30:05,350 --> 00:30:10,929
really interesting post about how this

648
00:30:08,440 --> 00:30:13,720
threat actor avoids detection from

649
00:30:10,930 --> 00:30:15,910
Google some what you can see it here it

650
00:30:13,720 --> 00:30:18,100
is translated from russian so some of it

651
00:30:15,910 --> 00:30:23,230
may not make the most grammatical sense

652
00:30:18,100 --> 00:30:25,540
but one of the interesting things that i

653
00:30:23,230 --> 00:30:28,450
see is the amount of focus on having

654
00:30:25,540 --> 00:30:30,850
your own different google developer

655
00:30:28,450 --> 00:30:34,450
accounts per an extension to the point

656
00:30:30,850 --> 00:30:37,270
of them even buying the entire google

657
00:30:34,450 --> 00:30:39,550
developer account as well as seeing the

658
00:30:37,270 --> 00:30:42,400
use of virtual machines to login to the

659
00:30:39,550 --> 00:30:45,100
google accounts so I guess that google

660
00:30:42,400 --> 00:30:46,419
has enough insight that they're easy a

661
00:30:45,100 --> 00:30:49,070
virtual machine

662
00:30:46,419 --> 00:30:52,789
rotating IP addresses to log into

663
00:30:49,070 --> 00:30:55,490
developer accounts but they don't bother

664
00:30:52,789 --> 00:30:57,890
changing their domains off of the same

665
00:30:55,490 --> 00:31:03,500
web server with the same IP address for

666
00:30:57,890 --> 00:31:07,669
multiple years after Brian Krebs his

667
00:31:03,500 --> 00:31:09,320
article was disclosed and some of the

668
00:31:07,669 --> 00:31:12,200
bounty reports that I had submitted to

669
00:31:09,320 --> 00:31:16,668
Google and further down the pipeline the

670
00:31:12,200 --> 00:31:18,049
monetizes company / group I don't really

671
00:31:16,669 --> 00:31:21,429
know if you could call them a company

672
00:31:18,049 --> 00:31:23,809
fully shut down their affiliate program

673
00:31:21,429 --> 00:31:25,820
visiting the website to this day will

674
00:31:23,809 --> 00:31:27,970
display this message thank you for your

675
00:31:25,820 --> 00:31:27,970
cooperation

676
00:31:28,059 --> 00:31:33,559
great you know we got done they're not

677
00:31:30,650 --> 00:31:35,390
no longer operating not so fast

678
00:31:33,559 --> 00:31:39,799
while exploring these sub domain

679
00:31:35,390 --> 00:31:44,150
information of the monetizes website

680
00:31:39,799 --> 00:31:48,190
I discovered a second shell company of

681
00:31:44,150 --> 00:31:51,950
the same thread actor advertised us

682
00:31:48,190 --> 00:31:55,669
really designed I mean rebrand it's

683
00:31:51,950 --> 00:31:58,640
totally undercover only has one linkage

684
00:31:55,669 --> 00:32:01,159
to the same server except it doesn't

685
00:31:58,640 --> 00:32:03,770
this site actually has the exact same

686
00:32:01,159 --> 00:32:07,010
site map as the old one that references

687
00:32:03,770 --> 00:32:08,929
the monetizes domain further linking

688
00:32:07,010 --> 00:32:12,320
that this is literally the exact same

689
00:32:08,929 --> 00:32:19,039
web site template and company just with

690
00:32:12,320 --> 00:32:20,720
a slightly different name disclosure so

691
00:32:19,039 --> 00:32:23,419
I did start this research with the

692
00:32:20,720 --> 00:32:25,580
intention of gaining bug bounties at the

693
00:32:23,419 --> 00:32:27,799
time I had never received any bug

694
00:32:25,580 --> 00:32:30,080
bounties before so I wasn't fully

695
00:32:27,799 --> 00:32:32,000
expecting to make anything at all I was

696
00:32:30,080 --> 00:32:35,178
kind of thinking this could be fun

697
00:32:32,000 --> 00:32:40,820
exciting research if I make any bounties

698
00:32:35,179 --> 00:32:44,030
in the process then even better Google

699
00:32:40,820 --> 00:32:49,100
launched their bug bounty platform on

700
00:32:44,030 --> 00:32:52,970
hacker 1 now hacker 1 is commonly used

701
00:32:49,100 --> 00:32:55,850
for a lot of web applications not really

702
00:32:52,970 --> 00:32:58,549
for you know privacy abuse and threat

703
00:32:55,850 --> 00:32:59,659
hunting so it was a little bit difficult

704
00:32:58,549 --> 00:33:02,480
to convince

705
00:32:59,660 --> 00:33:05,420
triage is that Chrome extensions that

706
00:33:02,480 --> 00:33:09,110
are going through excess excessive

707
00:33:05,420 --> 00:33:11,540
lengths to cover up their tracks and try

708
00:33:09,110 --> 00:33:16,729
and prevent researchers from detecting

709
00:33:11,540 --> 00:33:19,430
their adware was malicious in December I

710
00:33:16,730 --> 00:33:23,150
had reported my first linker extension

711
00:33:19,430 --> 00:33:26,810
to Google a month later I reported five

712
00:33:23,150 --> 00:33:29,540
more then it was until the end of

713
00:33:26,810 --> 00:33:33,950
January that my first report was

714
00:33:29,540 --> 00:33:40,670
actually for forwarded on from a hacker

715
00:33:33,950 --> 00:33:43,010
one to Google in February I got the

716
00:33:40,670 --> 00:33:45,620
first triage status which means that the

717
00:33:43,010 --> 00:33:48,740
report is actually valid and it has

718
00:33:45,620 --> 00:33:52,189
likely to get bounty in March only six

719
00:33:48,740 --> 00:33:55,730
days after Brian Krebs published about

720
00:33:52,190 --> 00:33:58,220
the Chrome extensions I received a very

721
00:33:55,730 --> 00:34:01,370
generous bounty reward for Google that

722
00:33:58,220 --> 00:34:03,620
helped me through some financial

723
00:34:01,370 --> 00:34:06,560
uncertainty between graduating and

724
00:34:03,620 --> 00:34:09,168
starting the full-time job and shortly

725
00:34:06,560 --> 00:34:10,969
after that in April Google left hacker

726
00:34:09,168 --> 00:34:14,000
won and is now in the process of

727
00:34:10,969 --> 00:34:20,379
standing up their in-house bug bounty

728
00:34:14,000 --> 00:34:23,630
program a little bit of statistics on

729
00:34:20,380 --> 00:34:27,410
just my entire bug bounty hunting

730
00:34:23,630 --> 00:34:29,330
process so far I have reported to Google

731
00:34:27,409 --> 00:34:32,239
over 30 different Chrome extensions from

732
00:34:29,330 --> 00:34:36,020
this adversary alone the install count

733
00:34:32,239 --> 00:34:38,330
over 15 million users and likely a good

734
00:34:36,020 --> 00:34:42,199
bit more and here are some of the

735
00:34:38,330 --> 00:34:44,270
examples of the Chrome extensions that

736
00:34:42,199 --> 00:34:47,659
were being used by the start actor to

737
00:34:44,270 --> 00:34:50,900
deliver adware and to abused user data

738
00:34:47,659 --> 00:34:54,049
privacy and as you can see some of these

739
00:34:50,900 --> 00:34:56,929
things look pretty legitimate and to

740
00:34:54,050 --> 00:34:59,330
have like a lot of users because they

741
00:34:56,929 --> 00:35:01,580
were legitimate extensions at one point

742
00:34:59,330 --> 00:35:06,340
in time before they were purchased by

743
00:35:01,580 --> 00:35:09,440
the monetize us or advertised this group

744
00:35:06,340 --> 00:35:12,820
so just a little bit of closing thoughts

745
00:35:09,440 --> 00:35:15,940
I have on the results of my research

746
00:35:12,820 --> 00:35:17,440
and the Chrome Web Store I have seen

747
00:35:15,940 --> 00:35:19,240
some of these extensions I've reported

748
00:35:17,440 --> 00:35:22,240
show back up on the store which is

749
00:35:19,240 --> 00:35:26,950
frustrating frustrating but fortunately

750
00:35:22,240 --> 00:35:29,250
in late August they're implementing a

751
00:35:26,950 --> 00:35:32,290
new policy which pretty much states that

752
00:35:29,250 --> 00:35:34,840
developers can only have one extension

753
00:35:32,290 --> 00:35:37,270
of the same purpose will this actually

754
00:35:34,840 --> 00:35:39,250
stop these threat actors from trying to

755
00:35:37,270 --> 00:35:42,400
flood the store with garbage chrome

756
00:35:39,250 --> 00:35:45,360
extensions I'm not sure but I do think

757
00:35:42,400 --> 00:35:48,250
that between their implementing of new

758
00:35:45,360 --> 00:35:50,380
policies willingness to actually start a

759
00:35:48,250 --> 00:35:55,810
bounty program and put their money where

760
00:35:50,380 --> 00:35:57,370
their mouth is it it's definitely a sign

761
00:35:55,810 --> 00:36:01,049
that they care about their chrome store

762
00:35:57,370 --> 00:36:03,910
and are trying to actually improve it I

763
00:36:01,050 --> 00:36:06,250
know this stream is a couple seconds too

764
00:36:03,910 --> 00:36:09,100
late but if you have any questions feel

765
00:36:06,250 --> 00:36:13,710
free to drop them in the discord in

766
00:36:09,100 --> 00:36:17,470
terms of bounty hunting for more money I

767
00:36:13,710 --> 00:36:19,120
haven't even touched the apps yet and I

768
00:36:17,470 --> 00:36:21,250
know there's definitely a ton of like

769
00:36:19,120 --> 00:36:24,930
popular apps out there that are covertly

770
00:36:21,250 --> 00:36:27,790
selling data and hijacking

771
00:36:24,930 --> 00:36:31,060
sensitive information from users and I

772
00:36:27,790 --> 00:36:33,850
encourage everyone to look into it if

773
00:36:31,060 --> 00:36:35,700
they want to because ultimately these

774
00:36:33,850 --> 00:36:39,250
kind of bounty programs are going to

775
00:36:35,700 --> 00:36:42,100
improve our digital ecosystem as a whole

776
00:36:39,250 --> 00:36:46,450
and I would be rejoiced to see if other

777
00:36:42,100 --> 00:36:49,750
big tech companies like Mozilla move

778
00:36:46,450 --> 00:36:53,790
towards models like this and expand what

779
00:36:49,750 --> 00:36:53,790
bounty beyond just web applications

780
00:36:59,040 --> 00:37:05,610
I'll give it a second just for any

781
00:37:02,230 --> 00:37:05,610
questions to come in if there are any

782
00:37:17,050 --> 00:37:23,930
so the question about Auto scanning for

783
00:37:20,600 --> 00:37:26,299
a malicious phone home code code I know

784
00:37:23,930 --> 00:37:28,879
they do have scanning but the thing is a

785
00:37:26,300 --> 00:37:31,700
lot of these linker extensions will

786
00:37:28,880 --> 00:37:34,850
communicate and receive what looks like

787
00:37:31,700 --> 00:37:38,540
a harmless configuration from the c2

788
00:37:34,850 --> 00:37:40,420
server and then periodically after a

789
00:37:38,540 --> 00:37:42,890
certain amount of time would happen that

790
00:37:40,420 --> 00:37:45,260
configuration we actually change like

791
00:37:42,890 --> 00:37:47,240
this that one report from URL scan was a

792
00:37:45,260 --> 00:37:49,490
full configuration normally the

793
00:37:47,240 --> 00:37:51,319
configurations are a lot smaller and so

794
00:37:49,490 --> 00:37:54,109
unless you actually wait and put in the

795
00:37:51,320 --> 00:37:56,750
time to see and to like bypass the

796
00:37:54,110 --> 00:38:00,010
server side and check in then it won't

797
00:37:56,750 --> 00:38:00,010
deliver that malicious code

798
00:38:15,330 --> 00:38:23,830
so the stores about observation

799
00:38:19,720 --> 00:38:26,560
technically it's not really allowed but

800
00:38:23,830 --> 00:38:28,330
just having an observation isn't enough

801
00:38:26,560 --> 00:38:30,460
to actually report it so that's not in

802
00:38:28,330 --> 00:38:31,990
scope of reporting but then you see it

803
00:38:30,460 --> 00:38:35,170
tons of developers doing stuff like

804
00:38:31,990 --> 00:38:37,299
minifying and stuff which is allowed so

805
00:38:35,170 --> 00:38:39,340
it gets kind of hard to draw the line of

806
00:38:37,300 --> 00:38:40,900
what are they trying to use to gate

807
00:38:39,340 --> 00:38:44,550
their code versus when are they just

808
00:38:40,900 --> 00:38:44,550
trying to make it minified

809
00:38:53,800 --> 00:38:58,369
thank you thanks everyone for stopping

810
00:38:56,330 --> 00:39:00,770
by and watching I hope that uh it was

811
00:38:58,369 --> 00:39:02,930
informative and opened the eye up to

812
00:39:00,770 --> 00:39:05,500
some of the world of chrome extension

813
00:39:02,930 --> 00:39:05,500
security

814
00:39:13,190 --> 00:39:15,250
you

