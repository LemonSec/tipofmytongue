1
00:00:10,940 --> 00:00:14,510
for threat Intel and open-source journey

2
00:00:13,220 --> 00:00:17,080
to building a threat intelligence

3
00:00:14,510 --> 00:00:17,080
program

4
00:00:19,300 --> 00:00:26,900
start with a little introduction and JJ

5
00:00:23,680 --> 00:00:30,220
chosing I'm a threat Intel analyst Miska

6
00:00:26,900 --> 00:00:33,589
Miska contributor cynic red team member

7
00:00:30,220 --> 00:00:35,150
pro hacker and hacked the Box in my

8
00:00:33,590 --> 00:00:37,250
spare time I like designing networks

9
00:00:35,150 --> 00:00:41,750
automating tools and breaking all the

10
00:00:37,250 --> 00:00:44,090
things um Matthew hugger um I'm at

11
00:00:41,750 --> 00:00:47,090
turtle face that on Twitter I'm also a

12
00:00:44,090 --> 00:00:49,580
threat intelligence analysts also a mis

13
00:00:47,090 --> 00:00:50,269
contributor I'm also a pro hacker on

14
00:00:49,580 --> 00:00:52,580
hack the box

15
00:00:50,269 --> 00:00:54,500
um in my spare time same thing I like

16
00:00:52,580 --> 00:00:56,300
building networks like building systems

17
00:00:54,500 --> 00:00:59,390
here at home in my lab and just trying

18
00:00:56,300 --> 00:01:05,449
to hack things and learn more more new

19
00:00:59,390 --> 00:01:08,090
things as much as I can so here's our

20
00:01:05,449 --> 00:01:09,920
agenda for today Wow I'm gonna talk a

21
00:01:08,090 --> 00:01:11,030
little bit about threat Intel what you

22
00:01:09,920 --> 00:01:13,850
can do with it

23
00:01:11,030 --> 00:01:16,550
talk about threat Intel platforms some

24
00:01:13,850 --> 00:01:19,759
malware sandboxes might our attack

25
00:01:16,550 --> 00:01:22,340
framework threat profiling attack group

26
00:01:19,760 --> 00:01:24,729
simulation and then we'll finish it off

27
00:01:22,340 --> 00:01:24,729
with some questions

28
00:01:26,800 --> 00:01:34,280
so what is their Intel it's

29
00:01:30,320 --> 00:01:35,750
evidence-based knowledge that adds

30
00:01:34,280 --> 00:01:38,230
valuable context around all your

31
00:01:35,750 --> 00:01:40,840
indicators of compromise

32
00:01:38,230 --> 00:01:42,220
and gives you better insights into the

33
00:01:40,840 --> 00:01:48,640
threats that are currently facing your

34
00:01:42,220 --> 00:01:51,730
organization and what can you do with

35
00:01:48,640 --> 00:01:53,800
your threat Intel well you can detect

36
00:01:51,730 --> 00:01:55,600
and that's by confirming your true

37
00:01:53,800 --> 00:01:57,730
positives and then being able to

38
00:01:55,600 --> 00:02:02,440
prioritize your incident responses

39
00:01:57,730 --> 00:02:07,330
necessary which also then lowers your

40
00:02:02,440 --> 00:02:09,130
alert fatigue you can predict by

41
00:02:07,330 --> 00:02:10,690
correlating your vulnerabilities with

42
00:02:09,130 --> 00:02:16,870
the threats that are hitting your

43
00:02:10,690 --> 00:02:18,550
externally exposed systems you can also

44
00:02:16,870 --> 00:02:20,290
prevent by using your threat until the

45
00:02:18,550 --> 00:02:24,010
heart in your systems to block the known

46
00:02:20,290 --> 00:02:29,680
TTP's the threat actors and isolating

47
00:02:24,010 --> 00:02:31,329
your machines when required and also you

48
00:02:29,680 --> 00:02:33,190
can respond to incidents faster by using

49
00:02:31,330 --> 00:02:36,420
prioritized alerts that you see

50
00:02:33,190 --> 00:02:36,420
correlated with your threat Intel

51
00:02:39,100 --> 00:02:44,680
so dive into the malware sandbox getting

52
00:02:43,010 --> 00:02:49,340
insult from your sandbox

53
00:02:44,680 --> 00:02:51,260
KooKoo is an open source project you can

54
00:02:49,340 --> 00:02:58,520
use it to analyze different types of

55
00:02:51,260 --> 00:03:01,280
malicious files and websites does it'll

56
00:02:58,520 --> 00:03:02,930
show trace API calls and give you a

57
00:03:01,280 --> 00:03:06,080
general behavior of what the files are

58
00:03:02,930 --> 00:03:10,640
doing can also perform memory analysis

59
00:03:06,080 --> 00:03:13,730
as well as process memory as well as

60
00:03:10,640 --> 00:03:20,059
built-in mist integration as a pretty

61
00:03:13,730 --> 00:03:21,410
pretty easy to use API as 12 so looking

62
00:03:20,060 --> 00:03:26,570
here this is just an example screenshot

63
00:03:21,410 --> 00:03:29,030
of the cuckoo dashboard gives you the

64
00:03:26,570 --> 00:03:32,060
ability to to drag and drop or click to

65
00:03:29,030 --> 00:03:35,450
upload files and then you can also

66
00:03:32,060 --> 00:03:38,630
submit URLs or hashes on the right-hand

67
00:03:35,450 --> 00:03:42,109
side and then we're going to dive right

68
00:03:38,630 --> 00:03:46,489
into an analysis summary so we submitted

69
00:03:42,110 --> 00:03:51,620
this binary file in ventilator SH 300

70
00:03:46,489 --> 00:03:54,739
specification this was a CO vid 19

71
00:03:51,620 --> 00:03:57,140
themed fishing email that came in that

72
00:03:54,739 --> 00:03:59,690
generated a spam filter alert

73
00:03:57,140 --> 00:04:02,149
so we went out pulled the email and

74
00:03:59,690 --> 00:04:04,220
grabbed the attachment and then

75
00:04:02,150 --> 00:04:06,709
submitted it into the sandbox to do

76
00:04:04,220 --> 00:04:10,400
analysis and then you can see it spits

77
00:04:06,709 --> 00:04:14,480
out on the file hashes if it matched

78
00:04:10,400 --> 00:04:17,769
with er rules it also gives you some

79
00:04:14,480 --> 00:04:20,630
information about the binary on analysis

80
00:04:17,769 --> 00:04:23,530
and also give you some some signatures

81
00:04:20,630 --> 00:04:23,530
that it saw as well

82
00:04:26,990 --> 00:04:33,770
so and we'll take that and start

83
00:04:30,530 --> 00:04:35,508
collecting the Intel so the Miss is what

84
00:04:33,770 --> 00:04:37,909
we currently use for the threat Intel

85
00:04:35,509 --> 00:04:41,060
platform it's a free and open source tip

86
00:04:37,910 --> 00:04:43,310
it's written in PHP for gathering

87
00:04:41,060 --> 00:04:51,380
sharing storing correlating your i/o

88
00:04:43,310 --> 00:04:54,139
sees threat Intel and etc it stores the

89
00:04:51,380 --> 00:04:55,250
IOC is in a structured manner so most

90
00:04:54,139 --> 00:04:57,800
likely all of you have a myriad of

91
00:04:55,250 --> 00:04:58,970
different security tools and data so why

92
00:04:57,800 --> 00:05:02,750
not put it to good use and start

93
00:04:58,970 --> 00:05:05,539
correlating them together the main goal

94
00:05:02,750 --> 00:05:06,889
of the MIS is to be used and the

95
00:05:05,539 --> 00:05:11,240
developers have made it super simple to

96
00:05:06,889 --> 00:05:16,130
store and use your i/o sees and the main

97
00:05:11,240 --> 00:05:17,630
goal of the MIS or one of the one of the

98
00:05:16,130 --> 00:05:20,780
awesome things about the message is

99
00:05:17,630 --> 00:05:24,050
sharing so makes it super simple to

100
00:05:20,780 --> 00:05:25,758
share and/or receive Intel a lot of

101
00:05:24,050 --> 00:05:28,610
similar organizations face the same

102
00:05:25,759 --> 00:05:31,340
threats so let's work smarter and not

103
00:05:28,610 --> 00:05:33,500
harder some of us might have analyzed

104
00:05:31,340 --> 00:05:36,049
something the piece of malware from a

105
00:05:33,500 --> 00:05:38,780
campaign that up there somebody else is

106
00:05:36,050 --> 00:05:45,080
seeing so we can share it out without

107
00:05:38,780 --> 00:05:46,250
having to redo some of the same work so

108
00:05:45,080 --> 00:05:47,750
basically you just want to gather and

109
00:05:46,250 --> 00:05:50,270
correlate everything you possibly can

110
00:05:47,750 --> 00:05:52,789
into the MIS whether that's your open

111
00:05:50,270 --> 00:05:56,210
source feeds your host sent threat

112
00:05:52,789 --> 00:05:59,500
research sticks taxi format if you're

113
00:05:56,210 --> 00:06:01,609
part of any Isaac or ISIL sharing groups

114
00:05:59,500 --> 00:06:04,310
so that would be like all your external

115
00:06:01,610 --> 00:06:06,590
Intel and then you want to also put any

116
00:06:04,310 --> 00:06:10,419
internal Intel that you see so you're

117
00:06:06,590 --> 00:06:13,698
similar it's firewall alerts IPS alerts

118
00:06:10,419 --> 00:06:17,630
antivirus CDR really any tool that has

119
00:06:13,699 --> 00:06:23,930
an API makes it super easy to get data

120
00:06:17,630 --> 00:06:24,760
into the mist itself so this is the

121
00:06:23,930 --> 00:06:28,240
sample mist

122
00:06:24,760 --> 00:06:31,300
from our kuku analysis of the ventilator

123
00:06:28,240 --> 00:06:35,080
file just kind of give it a little bit

124
00:06:31,300 --> 00:06:40,960
of a rundown it'll show who where the

125
00:06:35,080 --> 00:06:43,890
source from its tagged with kuku shows

126
00:06:40,960 --> 00:06:47,320
the number of attributes when it came in

127
00:06:43,890 --> 00:06:49,419
and if there's any changes it'll record

128
00:06:47,320 --> 00:06:51,280
the last change to the event and then on

129
00:06:49,420 --> 00:06:53,440
the right hand side it'll show all of

130
00:06:51,280 --> 00:06:55,900
all the related events so if there's

131
00:06:53,440 --> 00:06:57,370
anything that correlates to other events

132
00:06:55,900 --> 00:07:00,640
that pops up over there so you see we

133
00:06:57,370 --> 00:07:03,460
got some spam filter events that it

134
00:07:00,640 --> 00:07:07,000
correlated to as well as a URL how it's

135
00:07:03,460 --> 00:07:11,919
known bad one of our Isaac sharing

136
00:07:07,000 --> 00:07:14,190
groups and an import from an open source

137
00:07:11,920 --> 00:07:14,190
feed

138
00:07:18,069 --> 00:07:25,190
then digging into some of the attributes

139
00:07:20,650 --> 00:07:28,549
from the kuku sandbox go through and you

140
00:07:25,190 --> 00:07:34,130
see that it's got the the file name with

141
00:07:28,550 --> 00:07:37,610
the md5 sha-1 hashes found a URL that it

142
00:07:34,130 --> 00:07:39,949
tried to connect out to and then at the

143
00:07:37,610 --> 00:07:44,199
bottom those are some of the signatures

144
00:07:39,949 --> 00:07:49,520
that it picked up on so you can see that

145
00:07:44,199 --> 00:07:52,250
one of them is TTP 1055 or a process

146
00:07:49,520 --> 00:07:54,258
injection that was one that kind of

147
00:07:52,250 --> 00:07:56,419
stood out a little bit so keep that in

148
00:07:54,259 --> 00:07:59,360
mind we'll dive a little bit more into

149
00:07:56,419 --> 00:08:02,120
that one in the upcoming slides but then

150
00:07:59,360 --> 00:08:04,550
as we continue down we can see that it's

151
00:08:02,120 --> 00:08:08,210
got unpack shell code tagged it as goo

152
00:08:04,550 --> 00:08:14,780
loader and then there's some some yard

153
00:08:08,210 --> 00:08:18,229
rules that it detected on and then if

154
00:08:14,780 --> 00:08:22,340
you look in the tab on the right hand

155
00:08:18,229 --> 00:08:24,740
side under related events these are all

156
00:08:22,340 --> 00:08:27,888
the other events where you have the

157
00:08:24,740 --> 00:08:29,300
misfit seen this attribute in in another

158
00:08:27,889 --> 00:08:32,349
event so it makes it real simple

159
00:08:29,300 --> 00:08:34,610
you're able to click on any of those

160
00:08:32,349 --> 00:08:40,070
hyperlinks and drops you right into the

161
00:08:34,610 --> 00:08:43,520
next event and then it gives you your

162
00:08:40,070 --> 00:08:45,589
sample correlation map as well so all

163
00:08:43,520 --> 00:08:48,589
those other events that we saw it kind

164
00:08:45,589 --> 00:08:50,839
of visualizes that and shows you where

165
00:08:48,589 --> 00:08:52,760
those different events were saw with the

166
00:08:50,839 --> 00:08:55,490
different attributes and it kind of

167
00:08:52,760 --> 00:08:57,130
gives you a bigger a bigger view of

168
00:08:55,490 --> 00:08:59,959
everything kind of all together and how

169
00:08:57,130 --> 00:09:04,570
all these different attributes kind of

170
00:08:59,959 --> 00:09:04,569
tie together into this correlation

171
00:09:10,230 --> 00:09:16,110
the main goal is automating automation

172
00:09:14,040 --> 00:09:18,329
is key for us we were tasked with

173
00:09:16,110 --> 00:09:20,250
starting the threat Intel program at our

174
00:09:18,330 --> 00:09:23,850
organization just over a year ago and

175
00:09:20,250 --> 00:09:26,040
we're too two-person team so we don't

176
00:09:23,850 --> 00:09:28,410
have time to kind of manually go through

177
00:09:26,040 --> 00:09:31,709
and add in different indicators for

178
00:09:28,410 --> 00:09:33,630
different events so we we look to

179
00:09:31,710 --> 00:09:35,550
automate where we can and this is

180
00:09:33,630 --> 00:09:38,610
showing an example of how simple it is

181
00:09:35,550 --> 00:09:41,130
to make an ape make an API call to

182
00:09:38,610 --> 00:09:44,190
create an event in the MIS at the bare

183
00:09:41,130 --> 00:09:46,470
minimum this is what's needed so if if

184
00:09:44,190 --> 00:09:48,930
you even have just basic scripting

185
00:09:46,470 --> 00:09:51,240
abilities you'll be able to start taking

186
00:09:48,930 --> 00:09:53,250
advantage of this I mentioned earlier

187
00:09:51,240 --> 00:09:56,730
that missmiss wants it to be as simple

188
00:09:53,250 --> 00:09:58,890
as possible so they're Primus library

189
00:09:56,730 --> 00:10:01,320
that they have does just that

190
00:09:58,890 --> 00:10:04,470
it's it's got awesome constructors to

191
00:10:01,320 --> 00:10:08,400
build events attributes but at the

192
00:10:04,470 --> 00:10:19,400
minimum its eight lines to create an

193
00:10:08,400 --> 00:10:22,620
event eight lines of code really okay

194
00:10:19,400 --> 00:10:25,079
with that being said another open source

195
00:10:22,620 --> 00:10:28,500
or free tool or free information that we

196
00:10:25,080 --> 00:10:30,210
use is on the miter attack framework so

197
00:10:28,500 --> 00:10:31,830
as you can see here I'm pretty sure many

198
00:10:30,210 --> 00:10:35,160
of you familiar with the miter attack

199
00:10:31,830 --> 00:10:37,230
but what they do is create a globally

200
00:10:35,160 --> 00:10:39,240
accessible knowledge base of adversary

201
00:10:37,230 --> 00:10:41,970
tactics and techniques based on

202
00:10:39,240 --> 00:10:43,980
real-world observations as you can see

203
00:10:41,970 --> 00:10:45,570
here they be map it out in a kill chain

204
00:10:43,980 --> 00:10:48,120
fashion here and they give you all the

205
00:10:45,570 --> 00:10:49,620
different techniques that might fall

206
00:10:48,120 --> 00:10:51,750
along these different steps of the

207
00:10:49,620 --> 00:10:55,500
killer chain like an initial access

208
00:10:51,750 --> 00:10:57,450
execution persistence so we can look at

209
00:10:55,500 --> 00:10:59,250
this and just have a good place to map

210
00:10:57,450 --> 00:11:03,230
all this out and see the all different

211
00:10:59,250 --> 00:11:05,280
methods associated with each kill chain

212
00:11:03,230 --> 00:11:09,270
another good thing that they have is

213
00:11:05,280 --> 00:11:14,600
they show the groups you can go to the

214
00:11:09,270 --> 00:11:17,160
next slide JJ so here they'll list out a

215
00:11:14,600 --> 00:11:18,620
lot of the advanced persistent threat

216
00:11:17,160 --> 00:11:21,180
groups that are out there they see

217
00:11:18,620 --> 00:11:23,430
groups are sets of related intrusion

218
00:11:21,180 --> 00:11:24,089
activity that are tracked by a common

219
00:11:23,430 --> 00:11:26,400
name and

220
00:11:24,090 --> 00:11:28,410
community analysts track clusters of

221
00:11:26,400 --> 00:11:30,630
activities using various analytic

222
00:11:28,410 --> 00:11:33,180
methodologies and terms such as threat

223
00:11:30,630 --> 00:11:37,110
groups activity groups threat actors

224
00:11:33,180 --> 00:11:38,729
intrusion sets and campaigns they make

225
00:11:37,110 --> 00:11:40,920
it really easy they give you know the

226
00:11:38,730 --> 00:11:43,410
name of the group associated groups with

227
00:11:40,920 --> 00:11:46,319
that with that same name and a

228
00:11:43,410 --> 00:11:48,540
description on it so you can try to gain

229
00:11:46,320 --> 00:11:51,510
as much intel on these groups that you

230
00:11:48,540 --> 00:11:53,219
care about nothing they provide is the

231
00:11:51,510 --> 00:11:59,520
TTP's that are associated with each

232
00:11:53,220 --> 00:12:02,250
group go the next slide JJ so here's a

233
00:11:59,520 --> 00:12:06,270
way that they list them all out look at

234
00:12:02,250 --> 00:12:08,910
the TTP name a description of what it is

235
00:12:06,270 --> 00:12:11,370
and what it does they give really really

236
00:12:08,910 --> 00:12:12,660
good descriptions on how its performed

237
00:12:11,370 --> 00:12:17,190
what it's actually doing what it's

238
00:12:12,660 --> 00:12:19,380
touching yeah so once we yeah so we can

239
00:12:17,190 --> 00:12:21,750
get all that information just for

240
00:12:19,380 --> 00:12:24,090
mightor and then which we want to start

241
00:12:21,750 --> 00:12:28,020
doing with all this information is start

242
00:12:24,090 --> 00:12:30,930
direct profiling so when we threat

243
00:12:28,020 --> 00:12:33,710
profile we're primarily focused on who

244
00:12:30,930 --> 00:12:38,550
was targeting you or your organization

245
00:12:33,710 --> 00:12:41,580
how they are targeting you and then

246
00:12:38,550 --> 00:12:44,010
align with the mightor framework and

247
00:12:41,580 --> 00:12:46,500
then simulate so what this means is that

248
00:12:44,010 --> 00:12:49,950
we can use all those resources just

249
00:12:46,500 --> 00:12:51,870
provided to us from mightor to you know

250
00:12:49,950 --> 00:12:53,550
learn about the group's learn about

251
00:12:51,870 --> 00:12:55,200
their motives what they're after and

252
00:12:53,550 --> 00:12:57,839
really get to see that if your

253
00:12:55,200 --> 00:13:00,030
organization is in there is in their

254
00:12:57,840 --> 00:13:02,400
scope of attack it definitely help your

255
00:13:00,030 --> 00:13:04,800
organization shift focuses on things

256
00:13:02,400 --> 00:13:06,600
that actually matter and then with all

257
00:13:04,800 --> 00:13:07,920
that free information from my tour you

258
00:13:06,600 --> 00:13:09,720
can really start to learn about these

259
00:13:07,920 --> 00:13:11,430
groups and spend time focusing on a

260
00:13:09,720 --> 00:13:13,320
specific set of groups rather than

261
00:13:11,430 --> 00:13:15,209
trying to you know try to protect

262
00:13:13,320 --> 00:13:17,730
against the world because it's not gonna

263
00:13:15,210 --> 00:13:19,080
happen it's pretty impossible so when

264
00:13:17,730 --> 00:13:20,490
you have an organization that you're

265
00:13:19,080 --> 00:13:23,610
specifically you know your organization

266
00:13:20,490 --> 00:13:24,870
deals with maybe finances or retail you

267
00:13:23,610 --> 00:13:27,330
can definitely start narrowing down

268
00:13:24,870 --> 00:13:30,450
which groups are potential risks to your

269
00:13:27,330 --> 00:13:33,360
company and then you can start creating

270
00:13:30,450 --> 00:13:36,570
your threat profile based on that so you

271
00:13:33,360 --> 00:13:37,710
go the next slide this is an example of

272
00:13:36,570 --> 00:13:41,700
one of the three

273
00:13:37,710 --> 00:13:43,200
groups apt 37 they might have provides a

274
00:13:41,700 --> 00:13:45,120
nice description of the group like I

275
00:13:43,200 --> 00:13:47,520
mentioned they give you as much

276
00:13:45,120 --> 00:13:50,340
information as as about them as they can

277
00:13:47,520 --> 00:13:52,380
when they were first seen last seen how

278
00:13:50,340 --> 00:13:53,820
they were seen and then one of the big

279
00:13:52,380 --> 00:13:56,070
things is that they provide the

280
00:13:53,820 --> 00:13:59,910
techniques used on the bottom there you

281
00:13:56,070 --> 00:14:03,380
can see so they'll provide the ttp of it

282
00:13:59,910 --> 00:14:05,910
a description and then we can start to

283
00:14:03,380 --> 00:14:07,470
read read up on all these different

284
00:14:05,910 --> 00:14:10,800
groups that we've decided that our

285
00:14:07,470 --> 00:14:12,450
actual threat to to our organization and

286
00:14:10,800 --> 00:14:14,490
from there we can start you know collect

287
00:14:12,450 --> 00:14:17,340
the information collecting all the TTP's

288
00:14:14,490 --> 00:14:20,240
that are associated with these groups if

289
00:14:17,340 --> 00:14:22,620
you go to the next slide so here's

290
00:14:20,240 --> 00:14:25,740
here's Ana it's an Excel spreadsheet

291
00:14:22,620 --> 00:14:28,080
that I put together it's got some fancy

292
00:14:25,740 --> 00:14:31,080
functions and macros in it but we use

293
00:14:28,080 --> 00:14:32,700
this to gather all the TTP's that are

294
00:14:31,080 --> 00:14:36,420
associated to each of the threat groups

295
00:14:32,700 --> 00:14:38,010
that are in our scope of threat groups

296
00:14:36,420 --> 00:14:42,120
that we're worried about so as you can

297
00:14:38,010 --> 00:14:45,390
see I've collected the TTP there a name

298
00:14:42,120 --> 00:14:47,000
of it and there is a scoring system on

299
00:14:45,390 --> 00:14:49,710
there that I'll get to in a minute here

300
00:14:47,000 --> 00:14:50,820
description of the TTP and then the

301
00:14:49,710 --> 00:14:54,300
different threat groups that are

302
00:14:50,820 --> 00:14:55,620
associated with this TTP so as an

303
00:14:54,300 --> 00:14:57,120
organization you can go through you can

304
00:14:55,620 --> 00:15:00,060
collect all these and then you have a

305
00:14:57,120 --> 00:15:02,130
good solid basis of all the techniques

306
00:15:00,060 --> 00:15:05,489
that are possibly going to be tried

307
00:15:02,130 --> 00:15:06,660
against your company after it's

308
00:15:05,490 --> 00:15:07,980
basically after figuring out what threat

309
00:15:06,660 --> 00:15:10,589
groups might potentially be coming after

310
00:15:07,980 --> 00:15:12,450
you organizations started to gather the

311
00:15:10,590 --> 00:15:14,460
TCPS that are commonly associated with

312
00:15:12,450 --> 00:15:15,960
these particular threat groups knowing

313
00:15:14,460 --> 00:15:17,550
the tactics and techniques that are

314
00:15:15,960 --> 00:15:19,620
going to be actively tried against your

315
00:15:17,550 --> 00:15:23,310
organization is a great way to stay

316
00:15:19,620 --> 00:15:25,050
prepared and to prevent attacks and when

317
00:15:23,310 --> 00:15:28,079
I say prevent attacks the next thing

318
00:15:25,050 --> 00:15:29,640
would be to try to start simulating some

319
00:15:28,080 --> 00:15:32,100
of these attacks and seeing how your

320
00:15:29,640 --> 00:15:33,810
tools react to them um it's you know

321
00:15:32,100 --> 00:15:36,240
knowing how these groups are gonna come

322
00:15:33,810 --> 00:15:38,400
after your organization is a great thing

323
00:15:36,240 --> 00:15:40,230
and the next step is to see if if you're

324
00:15:38,400 --> 00:15:42,180
prepared for it to start actually

325
00:15:40,230 --> 00:15:43,980
simulating these attack groups and

326
00:15:42,180 --> 00:15:46,979
seeing how your tools or how your

327
00:15:43,980 --> 00:15:50,070
analysts can respond to things that they

328
00:15:46,980 --> 00:15:51,630
see like this so the next tool that we

329
00:15:50,070 --> 00:15:56,130
take good advantage of

330
00:15:51,630 --> 00:15:58,890
is atomic grad team go to the next slide

331
00:15:56,130 --> 00:16:02,310
Tomic red team is open-source it's made

332
00:15:58,890 --> 00:16:04,920
it made by red Canary it's a simple

333
00:16:02,310 --> 00:16:07,709
attack simulation and it also lines up

334
00:16:04,920 --> 00:16:10,050
with the mitre attack matrix that's just

335
00:16:07,710 --> 00:16:11,940
a little a little picture I stole from

336
00:16:10,050 --> 00:16:14,849
them but yet but develop detection

337
00:16:11,940 --> 00:16:16,350
execute tests and collects evidence and

338
00:16:14,850 --> 00:16:18,170
that's something that we really do take

339
00:16:16,350 --> 00:16:20,520
advantage of at our organization um

340
00:16:18,170 --> 00:16:22,800
we'll meet up like once a week or once

341
00:16:20,520 --> 00:16:24,680
once every other week and just use these

342
00:16:22,800 --> 00:16:28,020
TTP's that we gathered and start

343
00:16:24,680 --> 00:16:29,579
performing these simulated attacks on

344
00:16:28,020 --> 00:16:31,470
our own end and again this is this is

345
00:16:29,580 --> 00:16:33,840
open source which makes it really nice

346
00:16:31,470 --> 00:16:35,040
and it was really easy to to push on to

347
00:16:33,840 --> 00:16:37,260
our to our upper management and

348
00:16:35,040 --> 00:16:39,060
organization to try to try to utilize

349
00:16:37,260 --> 00:16:41,130
this I know there's a lot of paid

350
00:16:39,060 --> 00:16:44,520
services that are out there that they're

351
00:16:41,130 --> 00:16:46,680
pretty expensive so this just makes it a

352
00:16:44,520 --> 00:16:49,470
great way to kind of test waters and

353
00:16:46,680 --> 00:16:52,229
just just see how it goes to go to the

354
00:16:49,470 --> 00:16:55,260
next slide the atomic red team they

355
00:16:52,230 --> 00:16:56,340
provide atomic tests they're called and

356
00:16:55,260 --> 00:16:57,960
the reason why they're called atomic

357
00:16:56,340 --> 00:17:00,690
tests because they're they're designed

358
00:16:57,960 --> 00:17:04,650
to be just simple quick tests that kind

359
00:17:00,690 --> 00:17:07,350
of sum up the basis of that TTP in this

360
00:17:04,650 --> 00:17:09,600
case I know JJ mentioned we ran that

361
00:17:07,349 --> 00:17:11,069
sample and Kaku and one of the things

362
00:17:09,599 --> 00:17:12,929
that it pulled from out of there was a

363
00:17:11,069 --> 00:17:18,359
process injection and it lined it up to

364
00:17:12,930 --> 00:17:20,430
the mitre framework as TTP 10:55 so we

365
00:17:18,359 --> 00:17:22,859
can actually go to the atomic red team

366
00:17:20,430 --> 00:17:26,880
and look up that 10:55 and they'll

367
00:17:22,859 --> 00:17:29,189
provide multiple tests sometimes one

368
00:17:26,880 --> 00:17:31,500
sometimes ten different kind of tests to

369
00:17:29,190 --> 00:17:33,270
kind of simulate that in this example

370
00:17:31,500 --> 00:17:35,180
there's a really really easy easy one

371
00:17:33,270 --> 00:17:38,460
they provide just this atomic test for

372
00:17:35,180 --> 00:17:40,200
process injection via c-sharp in this

373
00:17:38,460 --> 00:17:42,810
case is actually an executable that they

374
00:17:40,200 --> 00:17:45,600
provide that will fully simulate this

375
00:17:42,810 --> 00:17:48,360
attack so what we do is we'll spin up

376
00:17:45,600 --> 00:17:51,209
virtual machines on our network ad join

377
00:17:48,360 --> 00:17:53,370
them and then we'll actually run these

378
00:17:51,210 --> 00:17:55,020
tests on there sometimes they're not as

379
00:17:53,370 --> 00:17:57,060
easy as running an executable but

380
00:17:55,020 --> 00:17:58,620
they'll just be a list of commands that

381
00:17:57,060 --> 00:18:01,500
they walk you through and they couldn't

382
00:17:58,620 --> 00:18:03,870
make it any easier it's really cool and

383
00:18:01,500 --> 00:18:05,549
you get to learn a lot of these TTP's

384
00:18:03,870 --> 00:18:08,039
and how these methods are used

385
00:18:05,549 --> 00:18:10,799
and at the same time as you do these you

386
00:18:08,039 --> 00:18:12,779
can actively monitor your tools and make

387
00:18:10,799 --> 00:18:14,249
sure that you're know detecting on its

388
00:18:12,779 --> 00:18:17,129
and collecting the right data and things

389
00:18:14,249 --> 00:18:20,970
like that so the next slide kind of

390
00:18:17,129 --> 00:18:23,070
shows how we're we run these um these

391
00:18:20,970 --> 00:18:24,210
tests on our virtual machine in this

392
00:18:23,070 --> 00:18:26,668
case it's just running it in

393
00:18:24,210 --> 00:18:29,460
administrative PowerShell which it does

394
00:18:26,669 --> 00:18:31,379
that process injection be a c-sharp it

395
00:18:29,460 --> 00:18:34,169
picks the process the notepad process

396
00:18:31,379 --> 00:18:36,869
there and then injects a malicious DLL

397
00:18:34,169 --> 00:18:39,299
in there which pops the calculator and

398
00:18:36,869 --> 00:18:42,529
that's just kind of a sample right there

399
00:18:39,299 --> 00:18:44,850
it is a lot cooler live but we weren't

400
00:18:42,529 --> 00:18:46,679
trusting the demo gods too much to try

401
00:18:44,850 --> 00:18:48,959
to do some live stuff but it does look

402
00:18:46,679 --> 00:18:51,179
you know it works really simple very

403
00:18:48,960 --> 00:18:53,789
fast and easy and what we'll do is we'll

404
00:18:51,179 --> 00:18:57,029
run these tests and then simultaneously

405
00:18:53,789 --> 00:18:58,499
have somebody in you know our sim or in

406
00:18:57,029 --> 00:19:00,359
any other tool that we use the tech than

407
00:18:58,499 --> 00:19:02,299
our EDR or whatever the case may be and

408
00:19:00,359 --> 00:19:05,070
try to see you know if we saw anything

409
00:19:02,299 --> 00:19:06,869
sometimes it's it's as easy as it was

410
00:19:05,070 --> 00:19:08,939
straight up blocked and even while this

411
00:19:06,869 --> 00:19:10,230
thing to run sometimes we got to do a

412
00:19:08,940 --> 00:19:11,940
little digging to see if we can actually

413
00:19:10,230 --> 00:19:16,350
find the data and the commands that were

414
00:19:11,940 --> 00:19:18,419
ran so with that being said we had those

415
00:19:16,350 --> 00:19:20,189
lists of TCPS that I had in my

416
00:19:18,419 --> 00:19:23,609
spreadsheet there you want to go to the

417
00:19:20,190 --> 00:19:26,340
next slide so we can start ranking all

418
00:19:23,609 --> 00:19:28,859
the stuff that we do so as we go through

419
00:19:26,340 --> 00:19:32,369
this list of TTP's we can provide these

420
00:19:28,859 --> 00:19:35,369
rankings on the side here which in the

421
00:19:32,369 --> 00:19:38,639
next slide I have kind of how I define

422
00:19:35,369 --> 00:19:40,439
the scoring this is a grading scale I

423
00:19:38,639 --> 00:19:42,059
base off the amount of the amount and

424
00:19:40,440 --> 00:19:45,269
type of data that you're collecting and

425
00:19:42,059 --> 00:19:47,700
what you're doing with that data so a

426
00:19:45,269 --> 00:19:49,499
none up or a zero score would be not

427
00:19:47,700 --> 00:19:52,320
enough data to even detect on that

428
00:19:49,499 --> 00:19:53,970
adversary technique and then excellent

429
00:19:52,320 --> 00:19:55,830
being your you know you're collecting

430
00:19:53,970 --> 00:19:57,659
all the data you're doing something with

431
00:19:55,830 --> 00:19:59,580
the data um you know automatically

432
00:19:57,659 --> 00:20:01,139
blocking things and then you're having a

433
00:19:59,580 --> 00:20:03,059
good understanding of the environment so

434
00:20:01,139 --> 00:20:04,469
you know whether you know this kind of

435
00:20:03,059 --> 00:20:06,509
stuff supposed to be ran in that in that

436
00:20:04,470 --> 00:20:10,799
environment or if it's normal unnormal

437
00:20:06,509 --> 00:20:12,869
and then some of the other scores just

438
00:20:10,799 --> 00:20:14,759
again based on if you're collecting the

439
00:20:12,869 --> 00:20:18,658
right data I mean that this scoring is

440
00:20:14,759 --> 00:20:19,590
basically made up just on what you're

441
00:20:18,659 --> 00:20:19,860
actually collecting and what you're

442
00:20:19,590 --> 00:20:22,169
doing

443
00:20:19,860 --> 00:20:23,340
with it I know as an organization it's

444
00:20:22,170 --> 00:20:25,590
gonna be really hard to get that

445
00:20:23,340 --> 00:20:27,990
excellent score so we try to aim towards

446
00:20:25,590 --> 00:20:29,610
getting a good score to where we're

447
00:20:27,990 --> 00:20:31,020
actually we're detecting on it so

448
00:20:29,610 --> 00:20:33,149
there's alert being generated so at

449
00:20:31,020 --> 00:20:34,440
least we're getting some highs on it but

450
00:20:33,150 --> 00:20:36,540
that detection still requires some

451
00:20:34,440 --> 00:20:39,660
validation on whether it's true positive

452
00:20:36,540 --> 00:20:42,990
or a false positive and then that very

453
00:20:39,660 --> 00:20:46,020
good score would be that we detect on it

454
00:20:42,990 --> 00:20:47,790
we do something about it and we know

455
00:20:46,020 --> 00:20:50,220
enough about it that it's a it's a true

456
00:20:47,790 --> 00:20:52,100
positive to actually make some you know

457
00:20:50,220 --> 00:20:54,090
take some automated actions on it um

458
00:20:52,100 --> 00:20:55,918
things like you know automatically

459
00:20:54,090 --> 00:20:57,540
blacklisting things or blocking things

460
00:20:55,919 --> 00:20:59,340
just because we know enough about this

461
00:20:57,540 --> 00:21:01,649
we have enough data there to actually

462
00:20:59,340 --> 00:21:03,149
make that decision confidently and like

463
00:21:01,650 --> 00:21:05,280
JJ mentioned like we're all about

464
00:21:03,150 --> 00:21:07,200
automation we're a small team and

465
00:21:05,280 --> 00:21:08,940
anything that we could do automate it a

466
00:21:07,200 --> 00:21:10,919
lot better and that that's where like a

467
00:21:08,940 --> 00:21:13,380
lot of this thread Intel helps out a lot

468
00:21:10,919 --> 00:21:16,410
is to make those um those competent

469
00:21:13,380 --> 00:21:18,540
decisions so I did mention that I wrote

470
00:21:16,410 --> 00:21:21,570
that Excel spreadsheet with some fancy

471
00:21:18,540 --> 00:21:26,059
functions on it the next spreadsheet

472
00:21:21,570 --> 00:21:27,899
shows that as we fill out those TTP's

473
00:21:26,059 --> 00:21:31,740
whether we give them you know the good

474
00:21:27,900 --> 00:21:33,390
poor excellent score from that list this

475
00:21:31,740 --> 00:21:35,750
excel spreadsheet will automatically

476
00:21:33,390 --> 00:21:39,000
start coloring up a heat map here and

477
00:21:35,750 --> 00:21:42,809
all this is is the miter attack matrix

478
00:21:39,000 --> 00:21:45,000
and then provided with those functions

479
00:21:42,809 --> 00:21:46,770
it'll automatically fill out the colors

480
00:21:45,000 --> 00:21:50,130
here this is just kind of like a high

481
00:21:46,770 --> 00:21:53,639
overview of you know how strong your

482
00:21:50,130 --> 00:21:55,980
organization is and where should we put

483
00:21:53,640 --> 00:21:57,360
our focuses on obviously we wouldn't you

484
00:21:55,980 --> 00:21:58,799
know things that were excellent in or

485
00:21:57,360 --> 00:22:01,049
proficient and we wouldn't want to spend

486
00:21:58,799 --> 00:22:02,549
too much time on we want to kind of set

487
00:22:01,049 --> 00:22:05,010
a goal for ourselves like I mentioned

488
00:22:02,549 --> 00:22:06,389
ours that good goal so we want to focus

489
00:22:05,010 --> 00:22:08,820
on some of these red things on these

490
00:22:06,390 --> 00:22:11,250
poor scores and figure out you know why

491
00:22:08,820 --> 00:22:12,870
weren't we collect enough data how do we

492
00:22:11,250 --> 00:22:14,390
collect the right data and just kind of

493
00:22:12,870 --> 00:22:16,530
work from there and this is really a

494
00:22:14,390 --> 00:22:18,900
collaborative team effort here when we

495
00:22:16,530 --> 00:22:20,280
do these tests as we're testing and our

496
00:22:18,900 --> 00:22:21,840
analysts are going through them and it

497
00:22:20,280 --> 00:22:24,000
really helps us get a better

498
00:22:21,840 --> 00:22:26,370
understanding of our tools and and how

499
00:22:24,000 --> 00:22:28,350
to use them also this also is a great

500
00:22:26,370 --> 00:22:30,959
way to and we've used it a couple times

501
00:22:28,350 --> 00:22:32,550
to POC some tools just to go through and

502
00:22:30,960 --> 00:22:33,690
you know we have a two-week access or

503
00:22:32,550 --> 00:22:34,889
three-week access

504
00:22:33,690 --> 00:22:36,750
we can go through and run through these

505
00:22:34,889 --> 00:22:39,120
tests and then we can side-by-side

506
00:22:36,750 --> 00:22:41,700
compare them to how our other tools are

507
00:22:39,120 --> 00:22:44,330
responding and reacting to you know some

508
00:22:41,700 --> 00:22:46,740
of these alerts or some of these TTP's

509
00:22:44,330 --> 00:22:48,449
yeah I think I gave him a couple times

510
00:22:46,740 --> 00:22:51,720
this helped a lot but yeah it gives us

511
00:22:48,450 --> 00:22:54,389
that initial look at a tool and then it

512
00:22:51,720 --> 00:22:56,610
even like provides the possibility to

513
00:22:54,389 --> 00:22:58,168
like go to vendors and say hey like you

514
00:22:56,610 --> 00:22:59,820
know you guys detect really good here

515
00:22:58,169 --> 00:23:02,789
you know what about these areas you know

516
00:22:59,820 --> 00:23:04,230
can we help can we do anything to to

517
00:23:02,789 --> 00:23:06,269
provide better detection or prevention

518
00:23:04,230 --> 00:23:07,919
in these areas where we saw that you

519
00:23:06,269 --> 00:23:09,509
guys lack on and it just makes it a

520
00:23:07,919 --> 00:23:11,009
great conversation piece to bring back

521
00:23:09,509 --> 00:23:12,899
to vendors and then have them work with

522
00:23:11,009 --> 00:23:14,309
their engineers I'm figuring out you

523
00:23:12,899 --> 00:23:16,018
know how to how to use their tools

524
00:23:14,309 --> 00:23:17,309
better or how to focus them more on

525
00:23:16,019 --> 00:23:21,840
things that your organization cares

526
00:23:17,309 --> 00:23:24,480
about and then with that we can track

527
00:23:21,840 --> 00:23:26,970
results over time this is another thing

528
00:23:24,480 --> 00:23:30,419
that we do we'll run these tests like

529
00:23:26,970 --> 00:23:32,909
quarterly and then we can start to see

530
00:23:30,419 --> 00:23:35,000
trends building on the different areas

531
00:23:32,909 --> 00:23:37,710
to do that mitre attack framework

532
00:23:35,000 --> 00:23:39,990
because he like initial access execution

533
00:23:37,710 --> 00:23:42,480
and how we're doing over time and just

534
00:23:39,990 --> 00:23:43,080
kind of give a good visual of what it

535
00:23:42,480 --> 00:23:45,330
looks like

536
00:23:43,080 --> 00:23:47,399
this is great for like upper management

537
00:23:45,330 --> 00:23:49,110
for your directors or for your seaso to

538
00:23:47,399 --> 00:23:51,750
kind of see you know how we're

539
00:23:49,110 --> 00:23:53,519
progressing as a company or say you know

540
00:23:51,750 --> 00:23:56,940
we see certain spikes it's because we

541
00:23:53,519 --> 00:23:58,409
you know added a tool or or maybe we POC

542
00:23:56,940 --> 00:24:00,720
a tool and we saw our numbers

543
00:23:58,409 --> 00:24:03,570
drastically jump up it definitely gives

544
00:24:00,720 --> 00:24:05,700
you some more ammo into wanting to to

545
00:24:03,570 --> 00:24:07,710
get a budget for new tools or to prove

546
00:24:05,700 --> 00:24:09,210
your point of why we need new tools and

547
00:24:07,710 --> 00:24:11,879
what they can do for our organization

548
00:24:09,210 --> 00:24:14,250
this makes that really easy to show in a

549
00:24:11,879 --> 00:24:16,860
visual level here I know we've used it

550
00:24:14,250 --> 00:24:19,379
several times to kind of go through and

551
00:24:16,860 --> 00:24:22,350
get better tooling um it was one of the

552
00:24:19,379 --> 00:24:23,428
ways that we we were faced though we

553
00:24:22,350 --> 00:24:27,449
were faced with the time that we had to

554
00:24:23,429 --> 00:24:29,580
choose our sim tool and our IDI our tool

555
00:24:27,450 --> 00:24:31,049
and things like that and we had a bunch

556
00:24:29,580 --> 00:24:32,939
of them to POC and we were going through

557
00:24:31,049 --> 00:24:35,700
and just running these tests and then we

558
00:24:32,940 --> 00:24:37,350
could actually have real-time numbers on

559
00:24:35,700 --> 00:24:39,659
how they compare to each other and what

560
00:24:37,350 --> 00:24:41,428
we really care about so it this makes

561
00:24:39,659 --> 00:24:42,809
are really really cool um and like I

562
00:24:41,429 --> 00:24:45,509
said this is just a spreadsheet that I

563
00:24:42,809 --> 00:24:47,639
wrote got the idea of some other ones on

564
00:24:45,509 --> 00:24:49,320
the Internet so if anybody

565
00:24:47,640 --> 00:24:51,570
a copy of this spreadsheet I'll gladly

566
00:24:49,320 --> 00:24:55,409
share it it's all ready to go all you

567
00:24:51,570 --> 00:24:56,730
have to do is just rank the TTP's that

568
00:24:55,410 --> 00:24:58,410
that you collected that you care about

569
00:24:56,730 --> 00:25:01,170
they're all listed there from The MITRE

570
00:24:58,410 --> 00:25:02,580
um from The MITRE website so it has

571
00:25:01,170 --> 00:25:04,350
everything you just rank the ones that

572
00:25:02,580 --> 00:25:06,000
you care about and you can just it'll

573
00:25:04,350 --> 00:25:10,580
automatically generate the heat map and

574
00:25:06,000 --> 00:25:10,580
this results over time graph here

575
00:25:11,260 --> 00:25:13,320
you

576
00:25:14,800 --> 00:25:18,428
all right and then the next one is we're

577
00:25:17,200 --> 00:25:19,960
just kind of showing I probably

578
00:25:18,429 --> 00:25:22,929
mentioned a couple times now but kind of

579
00:25:19,960 --> 00:25:25,390
that example workflow here um like JJ

580
00:25:22,929 --> 00:25:27,520
had mentioned we got spam filter

581
00:25:25,390 --> 00:25:31,780
generates an alerts that was that that

582
00:25:27,520 --> 00:25:32,980
binary that he mentioned earlier so one

583
00:25:31,780 --> 00:25:34,780
of the things that we have we do have an

584
00:25:32,980 --> 00:25:36,730
integration with our spam filter into

585
00:25:34,780 --> 00:25:38,649
the mist that'll automatically create

586
00:25:36,730 --> 00:25:40,870
that events in the mist so we'll we'll

587
00:25:38,650 --> 00:25:43,300
get as much data as our spam filter has

588
00:25:40,870 --> 00:25:45,219
captured things like sender email

589
00:25:43,300 --> 00:25:47,950
address under you know the headers the

590
00:25:45,220 --> 00:25:49,630
IP Akane came from um things like that

591
00:25:47,950 --> 00:25:51,970
will be already sent to the mist and

592
00:25:49,630 --> 00:25:54,490
ready for a correlation or ready for

593
00:25:51,970 --> 00:25:56,710
further analysis the next thing that we

594
00:25:54,490 --> 00:25:59,570
could do is take that binary and submit

595
00:25:56,710 --> 00:26:01,070
it to Kaku like JJ showed

596
00:25:59,570 --> 00:26:04,879
[Music]

597
00:26:01,070 --> 00:26:07,580
yeah so that yeah once that's in kakou

598
00:26:04,880 --> 00:26:09,140
then that'll also create a event and

599
00:26:07,580 --> 00:26:11,689
miss and then we can start to see that

600
00:26:09,140 --> 00:26:13,760
correlations whether that's correlating

601
00:26:11,690 --> 00:26:16,190
to obviously it'll correlate probably to

602
00:26:13,760 --> 00:26:18,230
our original spam filter event in the

603
00:26:16,190 --> 00:26:21,110
mist but it also might correlate to

604
00:26:18,230 --> 00:26:22,700
other things that were captured from our

605
00:26:21,110 --> 00:26:26,179
spam filter and that kind of gives us a

606
00:26:22,700 --> 00:26:27,560
really good picture on you know we see

607
00:26:26,180 --> 00:26:30,470
that this was targeted at our

608
00:26:27,560 --> 00:26:32,570
organization but at what scale we might

609
00:26:30,470 --> 00:26:35,660
see that this was targeted at you know

610
00:26:32,570 --> 00:26:38,210
one thousand something users or or

611
00:26:35,660 --> 00:26:44,420
whatever the case may be I know one good

612
00:26:38,210 --> 00:26:46,190
um excuse me one good example that we

613
00:26:44,420 --> 00:26:48,140
had is recently with the Cova da

614
00:26:46,190 --> 00:26:50,120
pandemic one of the questions that upper

615
00:26:48,140 --> 00:26:52,040
manager was asking well you know how

616
00:26:50,120 --> 00:26:54,739
many Kovac themed phishing emails are we

617
00:26:52,040 --> 00:26:56,690
receiving the miss made it really really

618
00:26:54,740 --> 00:26:59,750
easy to just you know search keyword

619
00:26:56,690 --> 00:27:01,610
coalbed and filter out on our spam

620
00:26:59,750 --> 00:27:05,360
filter events only and then get a

621
00:27:01,610 --> 00:27:06,979
real-time number on how many Cova themed

622
00:27:05,360 --> 00:27:08,389
emails we were getting and I know that

623
00:27:06,980 --> 00:27:10,370
made it extremely helpful to get that

624
00:27:08,390 --> 00:27:11,420
number really quick and get a confident

625
00:27:10,370 --> 00:27:15,350
number that we could share with other

626
00:27:11,420 --> 00:27:17,300
management um so after getting some of

627
00:27:15,350 --> 00:27:19,129
those events and the things in the mist

628
00:27:17,300 --> 00:27:21,980
JJ showed that one of the things that we

629
00:27:19,130 --> 00:27:23,930
did capture was a TTP that aligned with

630
00:27:21,980 --> 00:27:28,460
the mitre attack framework which we were

631
00:27:23,930 --> 00:27:30,950
able to simulate with atomic red team to

632
00:27:28,460 --> 00:27:32,780
you know test our tools obviously we

633
00:27:30,950 --> 00:27:35,180
promote threat intelligence we gather

634
00:27:32,780 --> 00:27:36,530
this is you know a Koba themed phishing

635
00:27:35,180 --> 00:27:38,690
email that was targeted at an

636
00:27:36,530 --> 00:27:41,030
organization in this case you might have

637
00:27:38,690 --> 00:27:43,340
seen that it was targeted at all of our

638
00:27:41,030 --> 00:27:45,560
sea levels or all of our users or

639
00:27:43,340 --> 00:27:50,209
someone's just using a you know spraying

640
00:27:45,560 --> 00:27:52,190
our entire company domain users and we

641
00:27:50,210 --> 00:27:54,920
can actually start to say well you know

642
00:27:52,190 --> 00:27:56,420
let's see how well we are prepared if

643
00:27:54,920 --> 00:27:58,760
you know someone does run this

644
00:27:56,420 --> 00:28:00,200
executable or someone does you know take

645
00:27:58,760 --> 00:28:02,030
this further and this is actually

646
00:28:00,200 --> 00:28:04,280
running in our environment and this is

647
00:28:02,030 --> 00:28:06,740
an active attack we can we can stay

648
00:28:04,280 --> 00:28:08,780
proactive by simulating it and making

649
00:28:06,740 --> 00:28:10,460
sure our tools you know rank well

650
00:28:08,780 --> 00:28:12,170
against it and if they don't then we can

651
00:28:10,460 --> 00:28:14,720
definitely shift our focus is on you

652
00:28:12,170 --> 00:28:16,130
know making it better getting getting

653
00:28:14,720 --> 00:28:18,710
better detections better Prevention's

654
00:28:16,130 --> 00:28:20,539
things like that one of the last things

655
00:28:18,710 --> 00:28:23,690
that we kind of didn't mention about was

656
00:28:20,539 --> 00:28:25,100
a sword tool we don't use an open source

657
00:28:23,690 --> 00:28:27,440
or tool that's why we kind of kept it

658
00:28:25,100 --> 00:28:28,879
out of the talk but um things that you

659
00:28:27,440 --> 00:28:31,179
can do with a smaller team if you do

660
00:28:28,880 --> 00:28:33,400
have a sword tools you can start

661
00:28:31,179 --> 00:28:35,539
automating some of this stuff based on

662
00:28:33,400 --> 00:28:37,789
say you know our spam filter see

663
00:28:35,539 --> 00:28:40,100
something and the mist is already

664
00:28:37,789 --> 00:28:42,230
correlated that you know this is this is

665
00:28:40,100 --> 00:28:44,270
known bad at this many organizations or

666
00:28:42,230 --> 00:28:46,490
you know this is already ranting a coup

667
00:28:44,270 --> 00:28:49,070
came back known bad it had you know this

668
00:28:46,490 --> 00:28:50,120
TTP and we already deem that this was

669
00:28:49,070 --> 00:28:53,570
you know something that we care about

670
00:28:50,120 --> 00:28:55,760
well you can use your sword tool to kind

671
00:28:53,570 --> 00:28:57,379
of take you know proactive measures

672
00:28:55,760 --> 00:29:00,169
against that it's kind of automated to

673
00:28:57,380 --> 00:29:02,539
help enrich alerts to the point where

674
00:29:00,169 --> 00:29:04,280
either analysts can quickly and

675
00:29:02,539 --> 00:29:05,870
confidently you know close alerts or

676
00:29:04,280 --> 00:29:09,289
identify if it's a true positive or

677
00:29:05,870 --> 00:29:11,389
false positive or not even having

678
00:29:09,289 --> 00:29:13,250
analysts have to look at it get it to

679
00:29:11,390 --> 00:29:15,530
the point where you know we see

680
00:29:13,250 --> 00:29:18,110
correlations we see this IP is it's

681
00:29:15,530 --> 00:29:20,870
correlated to you know this known bad

682
00:29:18,110 --> 00:29:22,639
list or this Isacc group shared with us

683
00:29:20,870 --> 00:29:24,469
that you know it's obviously known bad

684
00:29:22,640 --> 00:29:26,179
it should be blacklisted then we can

685
00:29:24,470 --> 00:29:28,400
just take those actions automatically I

686
00:29:26,179 --> 00:29:30,080
know at our organization we do those

687
00:29:28,400 --> 00:29:32,150
kind of automatic actions things like

688
00:29:30,080 --> 00:29:34,610
black listing IPS and our firewalls

689
00:29:32,150 --> 00:29:37,309
based on what we see in the correlations

690
00:29:34,610 --> 00:29:41,959
for mists and also black listing things

691
00:29:37,309 --> 00:29:45,399
in our a B and our EDR tools so this is

692
00:29:41,960 --> 00:29:45,400
kind of a way to tie it all together

693
00:29:59,059 --> 00:30:04,240
so to kind of wrap the

694
00:30:01,180 --> 00:30:06,790
back up you want to you want to make

695
00:30:04,240 --> 00:30:08,500
your threat profiles you want to see you

696
00:30:06,790 --> 00:30:10,540
know which which director is what groups

697
00:30:08,500 --> 00:30:13,480
are you most concerned about most likely

698
00:30:10,540 --> 00:30:14,920
to target you because you're not going

699
00:30:13,480 --> 00:30:18,190
to be able to defend against everything

700
00:30:14,920 --> 00:30:21,550
the mitre framework is so huge so really

701
00:30:18,190 --> 00:30:23,890
just dive down and to you know based on

702
00:30:21,550 --> 00:30:31,450
which vertical you're in who's most

703
00:30:23,890 --> 00:30:33,970
likely to be targeting you you want to

704
00:30:31,450 --> 00:30:35,440
gather and correlate excuse me you want

705
00:30:33,970 --> 00:30:39,970
to gather and correlate as much of your

706
00:30:35,440 --> 00:30:43,360
Intel into your mist as possible so like

707
00:30:39,970 --> 00:30:46,720
I mentioned all your external feeds any

708
00:30:43,360 --> 00:30:50,020
any sticks taxi formats any Isaac groups

709
00:30:46,720 --> 00:30:53,200
and he just OSINT work that you do along

710
00:30:50,020 --> 00:30:55,210
with all your security tools but the

711
00:30:53,200 --> 00:30:58,540
Prime Minister a P I it makes it so

712
00:30:55,210 --> 00:31:01,060
simple to get to get any data and you

713
00:30:58,540 --> 00:31:03,280
really just gotta you know go out make

714
00:31:01,060 --> 00:31:09,280
an API call parse your data and then

715
00:31:03,280 --> 00:31:11,500
feed it into the PI abyss make sure to

716
00:31:09,280 --> 00:31:13,120
analyze your binaries there's there's

717
00:31:11,500 --> 00:31:17,490
lots of good Intel that you can grab out

718
00:31:13,120 --> 00:31:20,590
of it you know we we built this talk

719
00:31:17,490 --> 00:31:22,000
about a year ago after we started

720
00:31:20,590 --> 00:31:26,699
getting our our threat Intel

721
00:31:22,000 --> 00:31:28,930
infrastructure up and kuku was still

722
00:31:26,700 --> 00:31:31,810
maintained at the time it seems like

723
00:31:28,930 --> 00:31:34,630
it's kind of a dead project it's all in

724
00:31:31,810 --> 00:31:37,899
Python too and they don't really seem to

725
00:31:34,630 --> 00:31:40,570
have any plans to move it over so while

726
00:31:37,900 --> 00:31:42,910
this was what worked for us you know we

727
00:31:40,570 --> 00:31:45,580
might recommend a different project

728
00:31:42,910 --> 00:31:49,660
that's based off of cuckoo but it's

729
00:31:45,580 --> 00:31:52,419
called Cape v2 it it's an updated

730
00:31:49,660 --> 00:31:54,790
version of cuckoo and it just does

731
00:31:52,420 --> 00:31:58,090
binary analysis but you can grab you

732
00:31:54,790 --> 00:32:00,159
know like the some potential TTP's from

733
00:31:58,090 --> 00:32:02,439
it you know you might be able to grab

734
00:32:00,160 --> 00:32:04,300
signatures with your rules out of it

735
00:32:02,440 --> 00:32:08,410
determine you know the type of malware

736
00:32:04,300 --> 00:32:09,850
family it's from you don't want to be

737
00:32:08,410 --> 00:32:12,280
selective on what you bring into your

738
00:32:09,850 --> 00:32:14,980
Mis so all that stuff is good data to

739
00:32:12,280 --> 00:32:17,120
have you want like like a central

740
00:32:14,980 --> 00:32:19,250
repository where you can go in and look

741
00:32:17,120 --> 00:32:21,500
in query and say you know what do I know

742
00:32:19,250 --> 00:32:24,350
about this and and know that you've got

743
00:32:21,500 --> 00:32:26,330
all your data there and that if you've

744
00:32:24,350 --> 00:32:28,520
seen it and you'd make you know quick

745
00:32:26,330 --> 00:32:32,120
search in the MIS it'll pull up anything

746
00:32:28,520 --> 00:32:34,100
that it's seem kind of cut down some of

747
00:32:32,120 --> 00:32:35,840
that investigative time that you'd spend

748
00:32:34,100 --> 00:32:39,709
having to go out to virustotal

749
00:32:35,840 --> 00:32:41,689
or hybrid analysis and and and go and

750
00:32:39,710 --> 00:32:44,240
find those things we're trying to

751
00:32:41,690 --> 00:32:46,070
provide all that in ahead of time so

752
00:32:44,240 --> 00:32:48,649
that we already have that that

753
00:32:46,070 --> 00:32:51,200
investigative work done cut down on time

754
00:32:48,649 --> 00:32:56,629
that would need to respond to incidents

755
00:32:51,200 --> 00:32:59,110
or events then you want to take all that

756
00:32:56,630 --> 00:33:01,760
and map it to the mitre framework

757
00:32:59,110 --> 00:33:05,928
determine you know which specific TTP's

758
00:33:01,760 --> 00:33:09,350
are being used and then do your attack

759
00:33:05,929 --> 00:33:11,390
simulation like that but that's it's a

760
00:33:09,350 --> 00:33:13,699
good an important way to go about

761
00:33:11,390 --> 00:33:18,260
showing your your detection and

762
00:33:13,700 --> 00:33:22,220
prevention capabilities Matt mentioned

763
00:33:18,260 --> 00:33:24,169
it doing this kind of with the process

764
00:33:22,220 --> 00:33:26,840
that we spoke of it makes it really

765
00:33:24,169 --> 00:33:29,080
simple and a lot easier to try to

766
00:33:26,840 --> 00:33:32,510
present that to the upper management to

767
00:33:29,080 --> 00:33:34,760
persuade them into understanding your

768
00:33:32,510 --> 00:33:37,330
reasoning behind asking for for this

769
00:33:34,760 --> 00:33:40,190
tool or more budget so that you can do

770
00:33:37,330 --> 00:33:41,899
more things because let's face it

771
00:33:40,190 --> 00:33:46,460
everybody everybody struggles to get

772
00:33:41,899 --> 00:33:51,379
that stuff so anything to make it easier

773
00:33:46,460 --> 00:33:54,320
is gonna be a win and then like like JJ

774
00:33:51,380 --> 00:33:56,750
said the Kaku was kind of seems like a

775
00:33:54,320 --> 00:33:59,809
dead project now we were able to get it

776
00:33:56,750 --> 00:34:02,029
working again up until this talk so I

777
00:33:59,809 --> 00:34:03,590
mean it did take a little bit but there

778
00:34:02,029 --> 00:34:05,419
is a lot of things that a lot of bugs

779
00:34:03,590 --> 00:34:07,039
and errors that haven't been fixed yet

780
00:34:05,419 --> 00:34:09,889
but if you just mess wouldn't know if

781
00:34:07,039 --> 00:34:11,899
you can get it working again but there

782
00:34:09,889 --> 00:34:14,869
is other options out there I know as an

783
00:34:11,899 --> 00:34:17,089
organization we we use Kaku to kind of

784
00:34:14,869 --> 00:34:19,700
show value in getting that that malware

785
00:34:17,089 --> 00:34:21,230
sandbox to analyze things so that kind

786
00:34:19,699 --> 00:34:22,580
of showed upper management the value in

787
00:34:21,230 --> 00:34:24,619
it and we were able to pivot to

788
00:34:22,580 --> 00:34:25,969
something that you know the organization

789
00:34:24,619 --> 00:34:28,560
could pay for that which provides a

790
00:34:25,969 --> 00:34:30,689
little bit more probably more cons

791
00:34:28,560 --> 00:34:32,400
a little bit easier to use and that's

792
00:34:30,690 --> 00:34:33,990
kind of I was kind of the goal when we

793
00:34:32,400 --> 00:34:35,820
started this threat Intel team we didn't

794
00:34:33,989 --> 00:34:37,830
really know where to go with it and it's

795
00:34:35,820 --> 00:34:40,080
kind of hard to convince upper

796
00:34:37,830 --> 00:34:42,420
management to spend you know sometimes

797
00:34:40,080 --> 00:34:44,730
millions of dollars on tools and we

798
00:34:42,420 --> 00:34:46,350
truly don't know the value that we can

799
00:34:44,730 --> 00:34:48,900
get from it considering this as a brand

800
00:34:46,350 --> 00:34:50,279
new threat Intel team and you know you

801
00:34:48,900 --> 00:34:52,050
know what if we pay for this tool and we

802
00:34:50,280 --> 00:34:55,710
don't like it or we find it's not

803
00:34:52,050 --> 00:34:58,230
working for us um that's what made using

804
00:34:55,710 --> 00:35:00,480
open-source tooling so much better we

805
00:34:58,230 --> 00:35:02,760
could actually get a feel for it and see

806
00:35:00,480 --> 00:35:05,100
how it does provide value that's where

807
00:35:02,760 --> 00:35:07,650
we got the mystic ooh an atomic red team

808
00:35:05,100 --> 00:35:09,270
and that did help a lot but currently we

809
00:35:07,650 --> 00:35:11,760
are still using miss when atomic red

810
00:35:09,270 --> 00:35:14,730
team miss was great I know there's a lot

811
00:35:11,760 --> 00:35:17,160
of paid or a lot of vendors that sell a

812
00:35:14,730 --> 00:35:19,410
tip and they are pretty expensive that's

813
00:35:17,160 --> 00:35:21,660
kind of where me and JJ that's how we

814
00:35:19,410 --> 00:35:23,509
discovered the miss we were searching

815
00:35:21,660 --> 00:35:26,670
for those common tips that people use

816
00:35:23,510 --> 00:35:28,170
and we saw a couple of them POC them and

817
00:35:26,670 --> 00:35:29,490
then we got to that price point and it

818
00:35:28,170 --> 00:35:31,560
was like wool like this is a lot of

819
00:35:29,490 --> 00:35:33,000
money and I mean I I just don't feel

820
00:35:31,560 --> 00:35:34,920
comfortable you know force my company to

821
00:35:33,000 --> 00:35:36,600
pay this much money let me do a little

822
00:35:34,920 --> 00:35:38,490
more research and we discovered you know

823
00:35:36,600 --> 00:35:41,330
this the miss tool and it's been nothing

824
00:35:38,490 --> 00:35:41,330
but great so far

825
00:35:48,320 --> 00:35:53,210
yeah we're a little early on time but

826
00:35:51,710 --> 00:35:54,500
like we mentioned earlier you can find

827
00:35:53,210 --> 00:35:55,790
us on Twitter if you guys have any

828
00:35:54,500 --> 00:35:58,220
questions want to reach out to us about

829
00:35:55,790 --> 00:36:03,890
anything and then we also have a list of

830
00:35:58,220 --> 00:36:05,600
our resources that we used as well and

831
00:36:03,890 --> 00:36:07,279
then we're I mean I know what we're both

832
00:36:05,600 --> 00:36:09,190
extremely open to anybody that has

833
00:36:07,280 --> 00:36:10,970
questions or needs help with the MIS

834
00:36:09,190 --> 00:36:12,170
like we mentioned we are miss

835
00:36:10,970 --> 00:36:13,819
contributors we wrote a couple

836
00:36:12,170 --> 00:36:17,120
integrations that really helped our

837
00:36:13,820 --> 00:36:18,920
organization out and then share those

838
00:36:17,120 --> 00:36:20,330
with the guys that that created the mist

839
00:36:18,920 --> 00:36:22,130
and you know that they they found them

840
00:36:20,330 --> 00:36:24,620
interesting too so they added them to

841
00:36:22,130 --> 00:36:26,000
their repos so we're pretty well

842
00:36:24,620 --> 00:36:27,740
informed we're pretty good at working in

843
00:36:26,000 --> 00:36:29,060
the mist and we just love hearing

844
00:36:27,740 --> 00:36:31,310
people's ideas and what they're trying

845
00:36:29,060 --> 00:36:33,080
to do with the mist but like I said like

846
00:36:31,310 --> 00:36:35,090
don't be selective get as much as you

847
00:36:33,080 --> 00:36:36,710
can in there and you'll just start

848
00:36:35,090 --> 00:36:38,720
seeing these correlations I know they're

849
00:36:36,710 --> 00:36:39,860
so I immediately start seeing value and

850
00:36:38,720 --> 00:36:43,689
the more you get in there which is

851
00:36:39,860 --> 00:36:46,430
really cool and there is a lot of free

852
00:36:43,690 --> 00:36:48,650
miss feeds that you can you can add you

853
00:36:46,430 --> 00:36:51,020
can integrate it into your own miss I

854
00:36:48,650 --> 00:36:52,340
know if anyone's interested in any of

855
00:36:51,020 --> 00:36:54,440
that you can reach out to us for that

856
00:36:52,340 --> 00:36:56,030
too we actually wrote a bunch of

857
00:36:54,440 --> 00:36:58,040
integrations that take advantage of

858
00:36:56,030 --> 00:36:59,450
these free and open source feeds whether

859
00:36:58,040 --> 00:37:02,120
they're in mist format or whether

860
00:36:59,450 --> 00:37:03,740
they're in CSV or Stix format we found

861
00:37:02,120 --> 00:37:06,140
ways to parse them out and to get them

862
00:37:03,740 --> 00:37:08,899
into mists and it just makes the mist a

863
00:37:06,140 --> 00:37:10,700
lot stronger of a tool and really really

864
00:37:08,900 --> 00:37:11,990
easy to start up if your your

865
00:37:10,700 --> 00:37:14,830
organization that doesn't have a threat

866
00:37:11,990 --> 00:37:17,720
intelligence team or our program yet

867
00:37:14,830 --> 00:37:20,590
focusing on the miss was just an amazing

868
00:37:17,720 --> 00:37:20,589
way to get that going

869
00:37:27,380 --> 00:37:33,690
all right so we're gonna we're gonna end

870
00:37:30,690 --> 00:37:37,230
it here will be available in the trek to

871
00:37:33,690 --> 00:37:39,480
channel you can reach us there or on

872
00:37:37,230 --> 00:37:41,310
Twitter but yeah let's collaborate with

873
00:37:39,480 --> 00:37:43,579
some submissive stuff and some thread

874
00:37:41,310 --> 00:37:47,558
and talk

875
00:37:43,579 --> 00:37:47,559
Thanks thank you

876
00:37:52,960 --> 00:37:56,410
all right awesome

877
00:38:01,110 --> 00:38:03,170
you

