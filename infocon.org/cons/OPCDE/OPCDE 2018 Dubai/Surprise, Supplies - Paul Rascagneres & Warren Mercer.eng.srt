1
00:00:02,090 --> 00:00:08,109
<font color="#CCCCCC">there we've done this before yeah we're</font>

2
00:00:05,870 --> 00:00:10,790
<font color="#CCCCCC">gonna</font><font color="#E5E5E5"> talk to their</font><font color="#CCCCCC"> boy</font><font color="#E5E5E5"> supplies</font><font color="#CCCCCC"> Unitec</font>

3
00:00:08,109 --> 00:00:12,768
surprise supplies<font color="#E5E5E5"> trying to be funny to</font>

4
00:00:10,790 --> 00:00:15,620
say<font color="#E5E5E5"> there is a surprise within your</font>

5
00:00:12,769 --> 00:00:18,890
supply team so<font color="#CCCCCC"> I'm or a Mercer security</font>

6
00:00:15,620 --> 00:00:20,660
researcher and see I'm pretty<font color="#E5E5E5"> sure your</font>

7
00:00:18,890 --> 00:00:21,320
first line you<font color="#CCCCCC"> posed yeah we wanted</font><font color="#E5E5E5"> me</font>

8
00:00:20,660 --> 00:00:23,420
to go first

9
00:00:21,320 --> 00:00:25,700
yeah so my name<font color="#E5E5E5"> is Paris Kenya I'm</font>

10
00:00:23,420 --> 00:00:29,240
French guy<font color="#E5E5E5"> so sorry for for the cute</font>

11
00:00:25,700 --> 00:00:33,980
accent it's not<font color="#CCCCCC"> my fault it's my parents</font>

12
00:00:29,240 --> 00:00:36,469
<font color="#CCCCCC">fault and so I'm security security</font>

13
00:00:33,980 --> 00:00:39,620
researchers at Cisco<font color="#CCCCCC"> Terrace in the same</font>

14
00:00:36,469 --> 00:00:41,839
teams and<font color="#CCCCCC"> Rory</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> I mainly work on apt</font>

15
00:00:39,620 --> 00:00:45,980
<font color="#E5E5E5">Marvel analyzes and this kind of finish</font>

16
00:00:41,839 --> 00:00:48,050
<font color="#E5E5E5">stuff and I forgot I had the clicker and</font>

17
00:00:45,980 --> 00:00:49,879
I was waiting<font color="#CCCCCC"> for myself and my name is</font>

18
00:00:48,050 --> 00:00:52,010
Warren Mercer<font color="#E5E5E5"> as Paul said we worked</font>

19
00:00:49,879 --> 00:00:54,589
together in<font color="#E5E5E5"> Cisco towels with security</font>

20
00:00:52,010 --> 00:00:56,420
threat researchers generally looking<font color="#CCCCCC"> at</font>

21
00:00:54,589 --> 00:00:58,159
malware find<font color="#E5E5E5"> that pull another part</font>

22
00:00:56,420 --> 00:01:00,229
<font color="#E5E5E5">trying to write some cool stuff about it</font>

23
00:00:58,159 --> 00:01:02,960
<font color="#CCCCCC">my backgrounds yeah I work security</font>

24
00:01:00,229 --> 00:01:04,940
<font color="#CCCCCC">malware analysis very</font><font color="#E5E5E5"> similar to polls</font>

25
00:01:02,960 --> 00:01:07,310
cool<font color="#CCCCCC"> finder</font><font color="#E5E5E5"> of P sites Belfast</font><font color="#CCCCCC"> if</font>

26
00:01:04,940 --> 00:01:08,899
anybody ever<font color="#E5E5E5"> wants to visit the rainiest</font>

27
00:01:07,310 --> 00:01:14,060
place in the world<font color="#CCCCCC"> feel</font><font color="#E5E5E5"> free to come</font>

28
00:01:08,899 --> 00:01:17,180
along<font color="#CCCCCC"> sue introduction why do we</font><font color="#E5E5E5"> write</font>

29
00:01:14,060 --> 00:01:19,430
this<font color="#E5E5E5"> so supply team attacks are pretty</font>

30
00:01:17,180 --> 00:01:22,280
invoke the last year 18 months<font color="#E5E5E5"> we've</font>

31
00:01:19,430 --> 00:01:24,740
seen<font color="#E5E5E5"> a couple going back to Ryan 2011 we</font>

32
00:01:22,280 --> 00:01:26,600
seen some biggest one from the sort of

33
00:01:24,740 --> 00:01:28,548
top<font color="#CCCCCC"> of my head earlier on was probably</font>

34
00:01:26,600 --> 00:01:30,559
target whenever they broke in by HVAC

35
00:01:28,549 --> 00:01:32,899
<font color="#E5E5E5">store the point to</font><font color="#CCCCCC"> seal terminal credit</font>

36
00:01:30,560 --> 00:01:34,490
card information<font color="#E5E5E5"> obviously the last year</font>

37
00:01:32,899 --> 00:01:36,859
<font color="#CCCCCC">as Matthew mentioned we started</font><font color="#E5E5E5"> writing</font>

38
00:01:34,490 --> 00:01:39,109
about<font color="#CCCCCC"> Natya</font><font color="#E5E5E5"> we called it not</font><font color="#CCCCCC"> patcher as</font>

39
00:01:36,859 --> 00:01:40,250
a lot of<font color="#E5E5E5"> people know what I was</font><font color="#CCCCCC"> and we</font>

40
00:01:39,109 --> 00:01:41,750
<font color="#E5E5E5">started writing avoid some of these</font>

41
00:01:40,250 --> 00:01:43,490
supply<font color="#E5E5E5"> to you know attacks that were</font>

42
00:01:41,750 --> 00:01:44,840
going<font color="#E5E5E5"> on and they're really quite</font>

43
00:01:43,490 --> 00:01:46,460
<font color="#CCCCCC">interesting</font><font color="#E5E5E5"> when you</font><font color="#CCCCCC"> start to delve down</font>

44
00:01:44,840 --> 00:01:48,530
and look<font color="#E5E5E5"> at them so today we're going to</font>

45
00:01:46,460 --> 00:01:51,139
cover two<font color="#E5E5E5"> I'm gonna cover one on notepad</font>

46
00:01:48,530 --> 00:01:53,659
<font color="#E5E5E5">you stroke</font><font color="#CCCCCC"> nacho and</font><font color="#E5E5E5"> Paul is gonna cover</font>

47
00:01:51,140 --> 00:01:54,890
one on a vast<font color="#CCCCCC"> ccleaner so the point</font><font color="#E5E5E5"> is</font>

48
00:01:53,659 --> 00:01:56,840
as I was<font color="#CCCCCC"> trying to mention there it is</font>

49
00:01:54,890 --> 00:01:58,789
to try and<font color="#CCCCCC"> meet people</font><font color="#E5E5E5"> understand that</font>

50
00:01:56,840 --> 00:02:01,340
<font color="#E5E5E5">trusted supply to unit</font><font color="#CCCCCC"> acts happen</font>

51
00:01:58,789 --> 00:02:04,070
<font color="#E5E5E5">they're quite consequential</font><font color="#CCCCCC"> some of</font>

52
00:02:01,340 --> 00:02:05,539
these were huge huge financial resources

53
00:02:04,070 --> 00:02:07,880
some<font color="#E5E5E5"> of them were huge destructive</font>

54
00:02:05,539 --> 00:02:09,350
resources so as<font color="#CCCCCC"> we step</font><font color="#E5E5E5"> through it will</font>

55
00:02:07,880 --> 00:02:12,079
will hopefully give you an idea what

56
00:02:09,350 --> 00:02:13,190
<font color="#E5E5E5">we're trying</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> portray so what I'm</font>

57
00:02:12,080 --> 00:02:15,350
going<font color="#CCCCCC"> to cover</font><font color="#E5E5E5"> here is</font><font color="#CCCCCC"> Natya as</font><font color="#E5E5E5"> I</font>

58
00:02:13,190 --> 00:02:17,660
mentioned

59
00:02:15,350 --> 00:02:19,579
started with a<font color="#E5E5E5"> phone call</font><font color="#CCCCCC"> so we're quite</font>

60
00:02:17,660 --> 00:02:21,079
<font color="#CCCCCC">lucky and that we've access to quite a</font>

61
00:02:19,580 --> 00:02:23,480
lot of partner infrastructure and

62
00:02:21,080 --> 00:02:24,860
everything<font color="#E5E5E5"> cuz we're Cisco we got a call</font>

63
00:02:23,480 --> 00:02:26,780
from one<font color="#E5E5E5"> of</font><font color="#CCCCCC"> our partners in</font><font color="#E5E5E5"> you Korean</font>

64
00:02:24,860 --> 00:02:28,670
and<font color="#E5E5E5"> the partner just basically filmed up</font>

65
00:02:26,780 --> 00:02:29,390
and said something's happening<font color="#E5E5E5"> it's</font>

66
00:02:28,670 --> 00:02:33,489
<font color="#E5E5E5">really bad</font>

67
00:02:29,390 --> 00:02:33,489
we think it's ransomware<font color="#CCCCCC"> okay bye</font>

68
00:02:33,590 --> 00:02:38,450
we need a bit<font color="#CCCCCC"> more</font><font color="#E5E5E5"> than that anyway so</font>

69
00:02:35,450 --> 00:02:40,339
we<font color="#E5E5E5"> were able to send people to you</font>

70
00:02:38,450 --> 00:02:42,739
Korean<font color="#CCCCCC"> we started</font><font color="#E5E5E5"> talking to him to find</font>

71
00:02:40,340 --> 00:02:45,440
<font color="#E5E5E5">out what was going on we came to the</font>

72
00:02:42,740 --> 00:02:47,060
<font color="#E5E5E5">point of</font><font color="#CCCCCC"> then basically saying yes it's</font>

73
00:02:45,440 --> 00:02:49,250
around somewhere<font color="#CCCCCC"> yes</font><font color="#E5E5E5"> it's bad in the</font>

74
00:02:47,060 --> 00:02:51,290
meantime the official<font color="#CCCCCC"> u Korean Twitter</font>

75
00:02:49,250 --> 00:02:52,940
tweeted some of our<font color="#E5E5E5"> government</font><font color="#CCCCCC"> the</font>

76
00:02:51,290 --> 00:02:56,030
<font color="#CCCCCC">agencies private firms were hit by a</font>

77
00:02:52,940 --> 00:02:57,410
virus there is no need to<font color="#E5E5E5"> panic that's</font>

78
00:02:56,030 --> 00:03:00,110
<font color="#E5E5E5">how you</font><font color="#CCCCCC"> knew you</font><font color="#E5E5E5"> definitely need</font><font color="#CCCCCC"> the</font>

79
00:02:57,410 --> 00:03:01,700
<font color="#CCCCCC">pollak we're putting our utmost efforts</font>

80
00:03:00,110 --> 00:03:04,100
to tackle<font color="#E5E5E5"> the issue so at this point we</font>

81
00:03:01,700 --> 00:03:05,989
were very<font color="#E5E5E5"> heavily involved our Incident</font>

82
00:03:04,100 --> 00:03:07,640
Response guys were on site with me<font color="#CCCCCC"> doc</font>

83
00:03:05,990 --> 00:03:09,080
trying<font color="#E5E5E5"> to</font><font color="#CCCCCC"> assess</font><font color="#E5E5E5"> it to find out what was</font>

84
00:03:07,640 --> 00:03:11,119
<font color="#E5E5E5">going on so that's what we're going to</font>

85
00:03:09,080 --> 00:03:14,150
step through so what do<font color="#CCCCCC"> we get</font>

86
00:03:11,120 --> 00:03:16,070
guys<font color="#CCCCCC"> it's ransomware</font><font color="#E5E5E5"> okay everything's</font>

87
00:03:14,150 --> 00:03:17,600
ransom or not<font color="#E5E5E5"> as it</font><font color="#CCCCCC"> appears to be</font>

88
00:03:16,070 --> 00:03:20,120
targeting every organisation<font color="#CCCCCC"> in you</font>

89
00:03:17,600 --> 00:03:21,829
Korean<font color="#E5E5E5"> like Ian seems a bit sort of</font>

90
00:03:20,120 --> 00:03:23,060
unpalatable<font color="#CCCCCC"> who's very unlikely</font><font color="#E5E5E5"> as every</font>

91
00:03:21,830 --> 00:03:25,220
organisation<font color="#CCCCCC"> in Ukraine</font>

92
00:03:23,060 --> 00:03:28,760
affecting this<font color="#CCCCCC"> compared to</font><font color="#E5E5E5"> flash flood</font>

93
00:03:25,220 --> 00:03:30,380
<font color="#E5E5E5">and so easiest way to explain that mass</font>

94
00:03:28,760 --> 00:03:32,750
impact hitting a lot<font color="#CCCCCC"> of things at</font><font color="#E5E5E5"> once</font>

95
00:03:30,380 --> 00:03:35,150
<font color="#E5E5E5">very quickly infection delivery and</font>

96
00:03:32,750 --> 00:03:37,430
<font color="#CCCCCC">Vector</font><font color="#E5E5E5"> unknown at the time so they say</font>

97
00:03:35,150 --> 00:03:39,500
we got a phone<font color="#CCCCCC"> call</font><font color="#E5E5E5"> we need help we went</font>

98
00:03:37,430 --> 00:03:42,110
and helped and what do we<font color="#CCCCCC"> find</font>

99
00:03:39,500 --> 00:03:44,270
<font color="#E5E5E5">so we find</font><font color="#CCCCCC"> company called</font><font color="#E5E5E5"> meetup and I</font>

100
00:03:42,110 --> 00:03:47,510
don't imagine anyone has ever heard<font color="#CCCCCC"> of</font>

101
00:03:44,270 --> 00:03:48,950
me<font color="#CCCCCC"> not prior this because I haven't</font><font color="#E5E5E5"> this</font>

102
00:03:47,510 --> 00:03:50,540
actually made me<font color="#E5E5E5"> talk the most</font><font color="#CCCCCC"> famous</font>

103
00:03:48,950 --> 00:03:52,600
company in you<font color="#E5E5E5"> Korean because now</font>

104
00:03:50,540 --> 00:03:55,790
everybody knows who<font color="#CCCCCC"> they are</font>

105
00:03:52,600 --> 00:03:57,560
<font color="#CCCCCC">me--don't is a dotnet</font><font color="#E5E5E5"> up used for tax</font>

106
00:03:55,790 --> 00:03:59,060
processing<font color="#E5E5E5"> don't know it's an awful</font>

107
00:03:57,560 --> 00:04:01,130
language<font color="#E5E5E5"> in general</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> when you try to</font>

108
00:03:59,060 --> 00:04:02,840
rob malware and it's even worse it has

109
00:04:01,130 --> 00:04:03,799
an auto update functionality built into

110
00:04:02,840 --> 00:04:05,240
the app itself

111
00:04:03,800 --> 00:04:07,490
so that means the app will constantly

112
00:04:05,240 --> 00:04:08,930
try<font color="#CCCCCC"> and</font><font color="#E5E5E5"> perform automatic</font><font color="#CCCCCC"> updates to</font>

113
00:04:07,490 --> 00:04:11,060
ensure it's<font color="#CCCCCC"> the</font><font color="#E5E5E5"> latest version</font><font color="#CCCCCC"> setup</font>

114
00:04:08,930 --> 00:04:11,840
<font color="#E5E5E5">used in various large companies</font>

115
00:04:11,060 --> 00:04:14,020
<font color="#E5E5E5">throughout the world</font>

116
00:04:11,840 --> 00:04:15,980
so the original<font color="#CCCCCC"> message we</font><font color="#E5E5E5"> got was</font>

117
00:04:14,020 --> 00:04:17,960
companies in Ukraine are being attacked

118
00:04:15,980 --> 00:04:19,849
<font color="#E5E5E5">obviously that's important we try</font>

119
00:04:17,959 --> 00:04:21,229
<font color="#E5E5E5">helping remediate etcetera but it</font>

120
00:04:19,850 --> 00:04:21,650
transpired that it wasn't<font color="#CCCCCC"> just you</font>

121
00:04:21,230 --> 00:04:23,330
<font color="#CCCCCC">korean</font>

122
00:04:21,649 --> 00:04:25,489
this is a piece<font color="#CCCCCC"> of a kind in</font><font color="#E5E5E5"> software</font>

123
00:04:23,330 --> 00:04:27,530
used pretty<font color="#CCCCCC"> much all over the world and</font>

124
00:04:25,490 --> 00:04:28,730
some massive major corporations as we'll

125
00:04:27,530 --> 00:04:31,830
see

126
00:04:28,730 --> 00:04:34,230
so how much<font color="#CCCCCC"> communication did we do</font><font color="#E5E5E5"> well</font>

127
00:04:31,830 --> 00:04:35,669
when your phone<font color="#E5E5E5"> company tells you you've</font>

128
00:04:34,230 --> 00:04:37,410
got lots of<font color="#E5E5E5"> charges you need to stop</font>

129
00:04:35,670 --> 00:04:38,610
calling<font color="#E5E5E5"> international people that gives</font>

130
00:04:37,410 --> 00:04:39,180
you a good<font color="#E5E5E5"> idea that you're fooling them</font>

131
00:04:38,610 --> 00:04:41,070
too much

132
00:04:39,180 --> 00:04:43,020
so AT&T got in touch with<font color="#E5E5E5"> one</font><font color="#CCCCCC"> of our</font>

133
00:04:41,070 --> 00:04:44,460
guys<font color="#CCCCCC"> and said please</font><font color="#E5E5E5"> stop all this</font>

134
00:04:43,020 --> 00:04:46,049
<font color="#CCCCCC">long-distance phone calls you've run up</font>

135
00:04:44,460 --> 00:04:48,239
<font color="#CCCCCC">to hundred dollar bill already and that</font>

136
00:04:46,050 --> 00:04:49,650
was in a<font color="#E5E5E5"> couple of hours</font><font color="#CCCCCC"> so we were</font>

137
00:04:48,240 --> 00:04:50,940
<font color="#CCCCCC">talking to you</font><font color="#E5E5E5"> Korean quite a lot to</font>

138
00:04:49,650 --> 00:04:52,500
keep<font color="#E5E5E5"> in communication as the war was</font>

139
00:04:50,940 --> 00:04:56,100
<font color="#CCCCCC">going on and what was</font><font color="#E5E5E5"> happening and how</font>

140
00:04:52,500 --> 00:04:57,870
we<font color="#E5E5E5"> could help so the timeline of</font><font color="#CCCCCC"> Medoc</font>

141
00:04:56,100 --> 00:04:59,540
<font color="#CCCCCC">so there's a couple of</font><font color="#E5E5E5"> timelines are</font>

142
00:04:57,870 --> 00:05:02,490
<font color="#E5E5E5">gonna go through</font><font color="#CCCCCC"> the first</font><font color="#E5E5E5"> one here is</font>

143
00:04:59,540 --> 00:05:04,050
obviously<font color="#CCCCCC"> after the fact we were able to</font>

144
00:05:02,490 --> 00:05:06,150
realize<font color="#E5E5E5"> this information prior to</font><font color="#CCCCCC"> this</font>

145
00:05:04,050 --> 00:05:09,180
<font color="#E5E5E5">we weren't aware so we go all</font><font color="#CCCCCC"> the way</font>

146
00:05:06,150 --> 00:05:10,620
back<font color="#E5E5E5"> to April 14 2017 the first version</font>

147
00:05:09,180 --> 00:05:12,590
of<font color="#CCCCCC"> Medoc was released with a</font><font color="#E5E5E5"> back door</font>

148
00:05:10,620 --> 00:05:16,860
so that<font color="#E5E5E5"> means anyone running</font>

149
00:05:12,590 --> 00:05:18,359
<font color="#E5E5E5">medo-persian 1.75 or 1.7 for whatever</font>

150
00:05:16,860 --> 00:05:20,550
the<font color="#CCCCCC"> last minor</font><font color="#E5E5E5"> up there would have</font><font color="#CCCCCC"> been</font>

151
00:05:18,360 --> 00:05:23,940
would<font color="#E5E5E5"> have</font><font color="#CCCCCC"> automatically updated to this</font>

152
00:05:20,550 --> 00:05:26,250
next version may feature release<font color="#E5E5E5"> grid</font>

153
00:05:23,940 --> 00:05:28,560
<font color="#CCCCCC">meet off probably thinking let's fix all</font>

154
00:05:26,250 --> 00:05:30,030
the bugs let's push out<font color="#E5E5E5"> new software so</font>

155
00:05:28,560 --> 00:05:32,240
everybody's updating as we always

156
00:05:30,030 --> 00:05:34,169
<font color="#E5E5E5">encourage always updated always patch</font>

157
00:05:32,240 --> 00:05:35,790
comes<font color="#E5E5E5"> June then there's a version</font>

158
00:05:34,169 --> 00:05:38,280
released at the very end with a<font color="#E5E5E5"> backdoor</font>

159
00:05:35,790 --> 00:05:41,340
on the 22nd so we were in contact<font color="#E5E5E5"> with</font>

160
00:05:38,280 --> 00:05:43,890
me doc from<font color="#E5E5E5"> around the 20</font><font color="#CCCCCC"> yes I think</font><font color="#E5E5E5"> it</font>

161
00:05:41,340 --> 00:05:45,539
was<font color="#CCCCCC"> of June so there's a backdoor in</font>

162
00:05:43,890 --> 00:05:47,400
there and we're quite<font color="#E5E5E5"> sure this again</font>

163
00:05:45,540 --> 00:05:49,530
after<font color="#CCCCCC"> the fact it's very</font><font color="#E5E5E5"> easy to be sure</font>

164
00:05:47,400 --> 00:05:51,810
<font color="#E5E5E5">after the fact so we started</font><font color="#CCCCCC"> looking</font><font color="#E5E5E5"> at</font>

165
00:05:49,530 --> 00:05:54,929
the backdoor effectively what we get is

166
00:05:51,810 --> 00:05:57,530
a<font color="#E5E5E5"> backdoor wrapped within me</font><font color="#CCCCCC"> doc</font><font color="#E5E5E5"> with</font>

167
00:05:54,930 --> 00:06:00,000
five<font color="#E5E5E5"> six</font><font color="#CCCCCC"> different distinct commands</font>

168
00:05:57,530 --> 00:06:01,710
first one being please try<font color="#E5E5E5"> and contact</font>

169
00:06:00,000 --> 00:06:04,400
us update<font color="#E5E5E5"> server as I mentioned however</font>

170
00:06:01,710 --> 00:06:06,659
<font color="#E5E5E5">if you had a proxy feel and don't update</font>

171
00:06:04,400 --> 00:06:08,340
so it feels back to itself<font color="#CCCCCC"> and</font><font color="#E5E5E5"> then</font>

172
00:06:06,660 --> 00:06:09,930
looks for<font color="#E5E5E5"> all local email instances</font>

173
00:06:08,340 --> 00:06:11,369
where it can<font color="#E5E5E5"> start to actually do some</font>

174
00:06:09,930 --> 00:06:14,010
credential harvesting the<font color="#E5E5E5"> email</font><font color="#CCCCCC"> steal</font>

175
00:06:11,370 --> 00:06:16,320
and information<font color="#CCCCCC"> well then we execute</font>

176
00:06:14,010 --> 00:06:17,700
commands<font color="#E5E5E5"> and then most of</font><font color="#CCCCCC"> these commands</font>

177
00:06:16,320 --> 00:06:19,409
were being used<font color="#E5E5E5"> to actually</font><font color="#CCCCCC"> distributing</font>

178
00:06:17,700 --> 00:06:21,659
yet just<font color="#CCCCCC"> through the capability to steal</font>

179
00:06:19,410 --> 00:06:23,700
information credential harvest patch

180
00:06:21,660 --> 00:06:25,050
files<font color="#E5E5E5"> write files and execute files all</font>

181
00:06:23,700 --> 00:06:28,650
through these command<font color="#CCCCCC"> set so we're</font>

182
00:06:25,050 --> 00:06:30,810
included SMTP<font color="#CCCCCC"> card answers that were</font>

183
00:06:28,650 --> 00:06:33,090
being stolen<font color="#E5E5E5"> very basic script</font><font color="#CCCCCC"> please</font>

184
00:06:30,810 --> 00:06:34,950
<font color="#E5E5E5">take all the SMTP server info and send</font>

185
00:06:33,090 --> 00:06:37,229
it across nothing<font color="#E5E5E5"> groundbreaking here</font>

186
00:06:34,950 --> 00:06:39,360
nothing really<font color="#E5E5E5"> interesting</font><font color="#CCCCCC"> like doing</font>

187
00:06:37,229 --> 00:06:41,039
that<font color="#E5E5E5"> they were using again wrong</font><font color="#CCCCCC"> this is</font>

188
00:06:39,360 --> 00:06:43,229
a<font color="#CCCCCC"> windy l32</font>

189
00:06:41,039 --> 00:06:46,979
and you'll see as<font color="#CCCCCC"> we step through how</font>

190
00:06:43,229 --> 00:06:48,029
this<font color="#CCCCCC"> actually runs</font><font color="#E5E5E5"> so again after</font><font color="#CCCCCC"> the</font>

191
00:06:46,979 --> 00:06:52,369
fact we're able to<font color="#E5E5E5"> build a better</font>

192
00:06:48,029 --> 00:06:56,279
<font color="#CCCCCC">timeline so</font><font color="#E5E5E5"> we realized June 27th</font><font color="#CCCCCC"> 859</font>

193
00:06:52,369 --> 00:06:59,069
<font color="#E5E5E5">server was logged on to</font><font color="#CCCCCC"> the user</font><font color="#E5E5E5"> su to</font>

194
00:06:56,279 --> 00:07:01,289
<font color="#E5E5E5">be in privileged access using stolen</font>

195
00:06:59,069 --> 00:07:03,419
credentials<font color="#E5E5E5"> what happened then</font><font color="#CCCCCC"> ten</font>

196
00:07:01,289 --> 00:07:05,369
<font color="#CCCCCC">minutes later was the wavefront dam was</font>

197
00:07:03,419 --> 00:07:09,058
modified to<font color="#E5E5E5"> redirect all up their</font>

198
00:07:05,369 --> 00:07:10,830
traffic to an OVH server<font color="#CCCCCC"> Oviatt</font><font color="#E5E5E5"> server</font>

199
00:07:09,059 --> 00:07:12,479
then started to proxy that traffic's<font color="#E5E5E5"> who</font>

200
00:07:10,830 --> 00:07:14,580
all updates were not being proxied by

201
00:07:12,479 --> 00:07:16,830
OVH<font color="#E5E5E5"> and all new updates being supplied</font>

202
00:07:14,580 --> 00:07:20,609
were from the<font color="#E5E5E5"> Soviet server obviously</font>

203
00:07:16,830 --> 00:07:23,159
not<font color="#E5E5E5"> me dog</font><font color="#CCCCCC"> 12 31</font><font color="#E5E5E5"> through some three</font>

204
00:07:20,610 --> 00:07:26,699
hours<font color="#E5E5E5"> 30</font><font color="#CCCCCC"> minutes later</font><font color="#E5E5E5"> connection was</font>

205
00:07:23,159 --> 00:07:27,748
pulled<font color="#E5E5E5"> on and OVH obviously realized</font>

206
00:07:26,699 --> 00:07:29,909
something bad was going on because

207
00:07:27,749 --> 00:07:31,529
<font color="#E5E5E5">people got in contact with him original</font>

208
00:07:29,909 --> 00:07:33,539
server configuration was restored and

209
00:07:31,529 --> 00:07:36,509
the last disconnect was received<font color="#E5E5E5"> from a</font>

210
00:07:33,539 --> 00:07:37,649
Latvian IP<font color="#E5E5E5"> know that taking false flags</font>

211
00:07:36,509 --> 00:07:39,419
are very important to point<font color="#CCCCCC"> out that</font>

212
00:07:37,649 --> 00:07:41,459
does not mean this actor was in<font color="#E5E5E5"> Latvia</font>

213
00:07:39,419 --> 00:07:44,639
<font color="#E5E5E5">that just means they access it</font><font color="#CCCCCC"> via</font><font color="#E5E5E5"> box</font>

214
00:07:41,459 --> 00:07:46,259
in Latvia<font color="#E5E5E5"> using a logged on</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> wiped</font>

215
00:07:44,639 --> 00:07:47,789
everything<font color="#E5E5E5"> which makes it extremely</font>

216
00:07:46,259 --> 00:07:49,469
<font color="#E5E5E5">difficult if you want to do any forensic</font>

217
00:07:47,789 --> 00:07:51,449
recovery obviously we are<font color="#CCCCCC"> not the third</font>

218
00:07:49,469 --> 00:07:53,069
party<font color="#CCCCCC"> hosting company as instance two we</font>

219
00:07:51,449 --> 00:07:56,300
weren't able to do that<font color="#E5E5E5"> but we would</font>

220
00:07:53,069 --> 00:07:58,919
<font color="#E5E5E5">have liked to drive a zero dot using PD</font>

221
00:07:56,300 --> 00:08:00,779
so that's the sort of real timeline<font color="#E5E5E5"> of</font>

222
00:07:58,919 --> 00:08:03,479
again after the fact how we really<font color="#E5E5E5"> build</font>

223
00:08:00,779 --> 00:08:06,209
up what happened when it<font color="#E5E5E5"> happened</font><font color="#CCCCCC"> so we</font>

224
00:08:03,479 --> 00:08:08,729
find was<font color="#CCCCCC"> Natya we called it Najaf for</font>

225
00:08:06,209 --> 00:08:10,800
<font color="#E5E5E5">new obviously in</font><font color="#CCCCCC"> ukrainian and ta what</font>

226
00:08:08,729 --> 00:08:12,269
<font color="#E5E5E5">dya bein from</font><font color="#CCCCCC"> pata</font><font color="#E5E5E5"> the original</font>

227
00:08:10,800 --> 00:08:15,209
ransomware this is sort of<font color="#CCCCCC"> spurned from</font>

228
00:08:12,269 --> 00:08:17,729
see what is born capability<font color="#CCCCCC"> credential</font>

229
00:08:15,209 --> 00:08:20,849
<font color="#E5E5E5">stealin ransomware activity stroke</font>

230
00:08:17,729 --> 00:08:22,550
destruction of the disk and<font color="#E5E5E5"> files so</font>

231
00:08:20,849 --> 00:08:25,229
let's<font color="#CCCCCC"> look at part actually</font><font color="#E5E5E5"> works so</font>

232
00:08:22,550 --> 00:08:28,259
<font color="#CCCCCC">first</font><font color="#E5E5E5"> file we get mainly is a perfect</font>

233
00:08:25,229 --> 00:08:31,680
<font color="#CCCCCC">seed file</font><font color="#E5E5E5"> it contains multiple embedded</font>

234
00:08:28,259 --> 00:08:35,370
<font color="#CCCCCC">resources that are ZL up compressed</font><font color="#E5E5E5"> so</font>

235
00:08:31,680 --> 00:08:37,229
what we<font color="#E5E5E5"> get from this dilemma IPS exact</font>

236
00:08:35,370 --> 00:08:38,760
<font color="#E5E5E5">on the use of</font><font color="#CCCCCC"> two shadow programs</font>

237
00:08:37,229 --> 00:08:40,260
exploits eternal<font color="#CCCCCC"> blue and eternal</font>

238
00:08:38,760 --> 00:08:42,630
romance<font color="#CCCCCC"> so as soon</font><font color="#E5E5E5"> as this malware</font>

239
00:08:40,260 --> 00:08:44,519
<font color="#CCCCCC">realizes it's on an</font><font color="#E5E5E5"> infected system it</font>

240
00:08:42,630 --> 00:08:46,350
enumerates all local resources from<font color="#E5E5E5"> a</font>

241
00:08:44,519 --> 00:08:49,410
network point of view and starts to scan

242
00:08:46,350 --> 00:08:51,240
everything on TCP 139 the reason it's

243
00:08:49,410 --> 00:08:52,180
doing<font color="#E5E5E5"> this is it's going to try to use</font>

244
00:08:51,240 --> 00:08:55,660
eternal blue

245
00:08:52,180 --> 00:08:57,760
<font color="#CCCCCC">Tomasz so first bill we talk about</font><font color="#E5E5E5"> is</font>

246
00:08:55,660 --> 00:08:59,770
credential<font color="#E5E5E5"> still obviously before you</font>

247
00:08:57,760 --> 00:09:01,660
try to laterally move within<font color="#E5E5E5"> a network</font>

248
00:08:59,770 --> 00:09:03,339
<font color="#E5E5E5">you want some additional credentials</font>

249
00:09:01,660 --> 00:09:05,199
<font color="#E5E5E5">because the fact that you've logged in</font>

250
00:09:03,339 --> 00:09:07,180
and<font color="#CCCCCC"> maybe stolen one subset</font><font color="#E5E5E5"> of</font>

251
00:09:05,200 --> 00:09:08,790
credentials doesn't<font color="#E5E5E5"> necessarily mean</font>

252
00:09:07,180 --> 00:09:11,949
<font color="#E5E5E5">you've capability to login everywhere</font>

253
00:09:08,790 --> 00:09:13,630
<font color="#E5E5E5">this</font><font color="#CCCCCC"> is a common TTP that overlaps</font><font color="#E5E5E5"> lots</font>

254
00:09:11,950 --> 00:09:15,700
of different pieces<font color="#E5E5E5"> of malware</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is</font>

255
00:09:13,630 --> 00:09:17,110
it's not new<font color="#E5E5E5"> other malware will sting</font>

256
00:09:15,700 --> 00:09:20,140
<font color="#CCCCCC">multiple credentials</font><font color="#E5E5E5"> and using when it</font>

257
00:09:17,110 --> 00:09:22,750
<font color="#E5E5E5">can so what we find is the use</font><font color="#CCCCCC"> of a</font>

258
00:09:20,140 --> 00:09:24,850
modified version<font color="#CCCCCC"> mimic cuts mimic ATS is</font>

259
00:09:22,750 --> 00:09:27,399
a legitimate tool very<font color="#E5E5E5"> handy - it's a</font>

260
00:09:24,850 --> 00:09:30,220
very<font color="#CCCCCC"> well-regarded pen testing tool so</font>

261
00:09:27,399 --> 00:09:31,810
it's<font color="#E5E5E5"> not anything bad</font><font color="#CCCCCC"> currently but we</font>

262
00:09:30,220 --> 00:09:34,240
see this version<font color="#E5E5E5"> of</font><font color="#CCCCCC"> mini</font><font color="#E5E5E5"> cuts and we see</font>

263
00:09:31,810 --> 00:09:36,459
<font color="#CCCCCC">the name pipe connectivity this is how</font>

264
00:09:34,240 --> 00:09:39,040
it passes credentials<font color="#CCCCCC"> against very many</font>

265
00:09:36,459 --> 00:09:40,420
cuts now<font color="#CCCCCC"> we're</font><font color="#E5E5E5"> collects</font><font color="#CCCCCC"> is stolen</font>

266
00:09:39,040 --> 00:09:42,520
credentials is probably<font color="#E5E5E5"> getting across</font>

267
00:09:40,420 --> 00:09:43,839
and you'll see that the<font color="#CCCCCC"> perc C</font><font color="#E5E5E5"> sorry</font>

268
00:09:42,520 --> 00:09:46,779
that laser<font color="#E5E5E5"> doesn't work so at the point</font>

269
00:09:43,839 --> 00:09:48,700
the perfect C has a hidden export so I

270
00:09:46,779 --> 00:09:51,160
not<font color="#E5E5E5"> hit an unnamed export which is</font>

271
00:09:48,700 --> 00:09:53,170
called<font color="#CCCCCC"> hash tag</font><font color="#E5E5E5"> one so anyone familiar</font>

272
00:09:51,160 --> 00:09:54,819
with<font color="#CCCCCC"> ID ll runs it could be an ordinal</font>

273
00:09:53,170 --> 00:09:57,430
potentially but<font color="#E5E5E5"> in this case it was an</font>

274
00:09:54,820 --> 00:09:59,529
omni and export<font color="#E5E5E5"> so now we've got all our</font>

275
00:09:57,430 --> 00:10:01,689
list of credentials<font color="#E5E5E5"> we looked for tokens</font>

276
00:09:59,529 --> 00:10:03,240
<font color="#E5E5E5">available</font><font color="#CCCCCC"> our</font><font color="#E5E5E5"> news API we have access to</font>

277
00:10:01,690 --> 00:10:05,860
<font color="#CCCCCC">an</font><font color="#E5E5E5"> on machine</font>

278
00:10:03,240 --> 00:10:07,510
we then see the modified version<font color="#E5E5E5"> in</font>

279
00:10:05,860 --> 00:10:10,029
<font color="#CCCCCC">maquettes as i mentioned</font><font color="#E5E5E5"> again so</font><font color="#CCCCCC"> i had</font>

280
00:10:07,510 --> 00:10:12,040
to<font color="#CCCCCC"> do some pointing so this is code from</font>

281
00:10:10,029 --> 00:10:15,339
<font color="#E5E5E5">memory</font><font color="#CCCCCC"> cast as</font><font color="#E5E5E5"> you can see and this is</font>

282
00:10:12,040 --> 00:10:16,750
the compiled<font color="#E5E5E5"> code from the</font><font color="#CCCCCC"> Maur</font><font color="#E5E5E5"> and you</font>

283
00:10:15,339 --> 00:10:19,990
<font color="#E5E5E5">maybe can't read that from there but</font>

284
00:10:16,750 --> 00:10:21,370
<font color="#E5E5E5">trust me it's it's the same thing can I</font>

285
00:10:19,990 --> 00:10:24,339
say<font color="#E5E5E5"> trust</font><font color="#CCCCCC"> me is</font><font color="#E5E5E5"> that current from a</font>

286
00:10:21,370 --> 00:10:26,890
security<font color="#CCCCCC"> researcher</font><font color="#E5E5E5"> but it immediately</font>

287
00:10:24,339 --> 00:10:30,040
<font color="#E5E5E5">knew but it is it's</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> hard to</font><font color="#CCCCCC"> depict</font>

288
00:10:26,890 --> 00:10:31,660
on the screen again this shoes more<font color="#E5E5E5"> than</font>

289
00:10:30,040 --> 00:10:33,579
any cats<font color="#E5E5E5"> overlap so you can see all the</font>

290
00:10:31,660 --> 00:10:34,839
bcrypt setup functions and here's all

291
00:10:33,580 --> 00:10:36,670
<font color="#E5E5E5">that bcrypt set of functions that exist</font>

292
00:10:34,839 --> 00:10:38,829
<font color="#E5E5E5">within</font><font color="#CCCCCC"> let me cut</font><font color="#E5E5E5"> through that</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> very</font>

293
00:10:36,670 --> 00:10:41,380
<font color="#E5E5E5">similar not identical</font><font color="#CCCCCC"> but a very similar</font>

294
00:10:38,829 --> 00:10:43,599
version<font color="#CCCCCC"> mmm because being used</font><font color="#E5E5E5"> that's</font>

295
00:10:41,380 --> 00:10:45,730
important to point<font color="#E5E5E5"> out because people</font>

296
00:10:43,600 --> 00:10:48,220
might<font color="#E5E5E5"> expect up in their environment I</font>

297
00:10:45,730 --> 00:10:49,870
mean you probably shouldn't<font color="#CCCCCC"> 99 percent</font>

298
00:10:48,220 --> 00:10:51,490
of the time<font color="#CCCCCC"> but</font><font color="#E5E5E5"> some people will expect</font>

299
00:10:49,870 --> 00:10:55,930
<font color="#CCCCCC">the seamy cuts in their environments -</font>

300
00:10:51,490 --> 00:10:58,060
this may not be alarming - so we stolen

301
00:10:55,930 --> 00:10:59,949
<font color="#CCCCCC">or credentials</font><font color="#E5E5E5"> we've now looked at all</font>

302
00:10:58,060 --> 00:11:02,000
the machines with access to we're back

303
00:10:59,950 --> 00:11:04,460
the perfect<font color="#CCCCCC"> cidade as I mentioned were</font>

304
00:11:02,000 --> 00:11:06,080
of all<font color="#E5E5E5"> our embedded</font><font color="#CCCCCC"> resources</font><font color="#E5E5E5"> we now</font>

305
00:11:04,460 --> 00:11:08,840
look at how do<font color="#E5E5E5"> we move</font><font color="#CCCCCC"> all around the</font>

306
00:11:06,080 --> 00:11:11,300
network<font color="#E5E5E5"> so</font><font color="#CCCCCC"> eternal blue</font><font color="#E5E5E5"> an eternal rule</font>

307
00:11:08,840 --> 00:11:13,190
<font color="#CCCCCC">Mansour</font><font color="#E5E5E5"> to the shadow</font><font color="#CCCCCC"> brokers exploits</font>

308
00:11:11,300 --> 00:11:14,750
it were released<font color="#E5E5E5"> born with the release</font>

309
00:11:13,190 --> 00:11:16,880
in really powerful exploits like<font color="#E5E5E5"> these</font>

310
00:11:14,750 --> 00:11:18,920
<font color="#E5E5E5">is anyone can copy them and use them</font>

311
00:11:16,880 --> 00:11:20,240
they<font color="#E5E5E5"> don't need to</font><font color="#CCCCCC"> knew how they work</font>

312
00:11:18,920 --> 00:11:21,890
<font color="#E5E5E5">they don't even need to know how to</font>

313
00:11:20,240 --> 00:11:23,030
actually put<font color="#E5E5E5"> them together</font><font color="#CCCCCC"> they</font><font color="#E5E5E5"> just</font>

314
00:11:21,890 --> 00:11:25,610
need to know<font color="#E5E5E5"> how to copy and paste</font>

315
00:11:23,030 --> 00:11:27,500
functionality within their code we then

316
00:11:25,610 --> 00:11:29,660
had a modified version of double<font color="#E5E5E5"> pulse</font>

317
00:11:27,500 --> 00:11:31,460
<font color="#E5E5E5">our double pulse our game was</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> leaked</font>

318
00:11:29,660 --> 00:11:34,100
shadow<font color="#E5E5E5"> broker's backdoor so they</font>

319
00:11:31,460 --> 00:11:37,130
<font color="#CCCCCC">leverage</font><font color="#E5E5E5"> double pulse or if you had</font>

320
00:11:34,100 --> 00:11:40,040
<font color="#CCCCCC">patched</font><font color="#E5E5E5"> with mas 1701 oh you would not</font>

321
00:11:37,130 --> 00:11:41,750
<font color="#E5E5E5">have been</font><font color="#CCCCCC"> vulnerable to this but</font><font color="#E5E5E5"> that</font>

322
00:11:40,040 --> 00:11:44,240
gets<font color="#E5E5E5"> to</font><font color="#CCCCCC"> be quite a quandary because</font>

323
00:11:41,750 --> 00:11:46,130
<font color="#CCCCCC">we've only got to this point because</font><font color="#E5E5E5"> we</font>

324
00:11:44,240 --> 00:11:48,050
patched<font color="#E5E5E5"> we want to go</font><font color="#CCCCCC"> to this</font><font color="#E5E5E5"> point</font>

325
00:11:46,130 --> 00:11:49,400
because<font color="#E5E5E5"> we updated</font><font color="#CCCCCC"> our me dawg which we</font>

326
00:11:48,050 --> 00:11:51,589
thought we were<font color="#E5E5E5"> being smart</font><font color="#CCCCCC"> about cuz</font>

327
00:11:49,400 --> 00:11:53,240
that's what people<font color="#CCCCCC"> should do</font><font color="#E5E5E5"> however</font>

328
00:11:51,590 --> 00:11:55,430
even<font color="#CCCCCC"> though this company</font><font color="#E5E5E5"> were quite good</font>

329
00:11:53,240 --> 00:11:58,850
<font color="#CCCCCC">at updating</font><font color="#E5E5E5"> all their accounting</font>

330
00:11:55,430 --> 00:12:00,380
<font color="#CCCCCC">software</font><font color="#E5E5E5"> they didn't feel it necessary</font>

331
00:11:58,850 --> 00:12:02,810
they opiate and other<font color="#E5E5E5"> Windows</font>

332
00:12:00,380 --> 00:12:04,220
infrastructure<font color="#CCCCCC"> tick from now would you</font>

333
00:12:02,810 --> 00:12:06,380
will<font color="#E5E5E5"> this obviously had</font><font color="#CCCCCC"> many many</font>

334
00:12:04,220 --> 00:12:08,900
<font color="#E5E5E5">companies so that's a sweeping statement</font>

335
00:12:06,380 --> 00:12:10,730
<font color="#CCCCCC">yeah so what do we get we get the double</font>

336
00:12:08,900 --> 00:12:11,990
pulse<font color="#CCCCCC"> are</font><font color="#E5E5E5"> all they did here and we'll</font>

337
00:12:10,730 --> 00:12:13,730
step through is they modified the

338
00:12:11,990 --> 00:12:15,350
different command<font color="#E5E5E5"> codes response codes</font>

339
00:12:13,730 --> 00:12:17,120
<font color="#E5E5E5">and actual location used within the</font>

340
00:12:15,350 --> 00:12:18,200
packet<font color="#E5E5E5"> the reason they do that is it</font>

341
00:12:17,120 --> 00:12:21,940
makes it<font color="#E5E5E5"> more difficult for you to</font>

342
00:12:18,200 --> 00:12:24,680
<font color="#CCCCCC">perform detection on</font><font color="#E5E5E5"> already known rules</font>

343
00:12:21,940 --> 00:12:27,980
so modifications in double<font color="#E5E5E5"> pulse or were</font>

344
00:12:24,680 --> 00:12:29,630
around the pain kill and execute

345
00:12:27,980 --> 00:12:32,240
commands<font color="#CCCCCC"> were being issued</font><font color="#E5E5E5"> no they</font>

346
00:12:29,630 --> 00:12:34,640
didn't<font color="#E5E5E5"> modify</font><font color="#CCCCCC"> it in a massively</font>

347
00:12:32,240 --> 00:12:37,970
complicated way you'll see<font color="#E5E5E5"> hopefully</font>

348
00:12:34,640 --> 00:12:40,699
you've got 23<font color="#CCCCCC"> hacks 77</font><font color="#E5E5E5"> X 0</font><font color="#CCCCCC"> C</font><font color="#E5E5E5"> attacks</font>

349
00:12:37,970 --> 00:12:44,270
here and they've just<font color="#E5E5E5"> changed it to f0</font>

350
00:12:40,700 --> 00:12:46,100
f1 f2 so<font color="#E5E5E5"> 10 11 12 now that becomes</font>

351
00:12:44,270 --> 00:12:47,689
<font color="#CCCCCC">difficult if you use maybe static</font>

352
00:12:46,100 --> 00:12:49,600
analysis techniques that look for code

353
00:12:47,690 --> 00:12:52,040
reuse our code overlap of known

354
00:12:49,600 --> 00:12:54,050
vulnerabilities and<font color="#E5E5E5"> noon exploits</font><font color="#CCCCCC"> or if</font>

355
00:12:52,040 --> 00:12:55,280
you're<font color="#CCCCCC"> using network based IDs</font>

356
00:12:54,050 --> 00:12:58,810
signatures<font color="#E5E5E5"> that look for this</font>

357
00:12:55,280 --> 00:13:01,010
information<font color="#E5E5E5"> second modification they did</font>

358
00:12:58,810 --> 00:13:02,869
was they<font color="#CCCCCC"> changed again</font>

359
00:13:01,010 --> 00:13:08,990
just simple<font color="#CCCCCC"> byte</font><font color="#E5E5E5"> code changes than the</font>

360
00:13:02,870 --> 00:13:10,940
opcode<font color="#E5E5E5"> 10-20-30 hex became</font><font color="#CCCCCC"> 10 21 31 hex</font>

361
00:13:08,990 --> 00:13:12,560
so they didn't<font color="#E5E5E5"> really go to the way to</font>

362
00:13:10,940 --> 00:13:14,240
<font color="#E5E5E5">change anything they just</font><font color="#CCCCCC"> made sure</font><font color="#E5E5E5"> they</font>

363
00:13:12,560 --> 00:13:14,670
made a small enough change to<font color="#E5E5E5"> make</font><font color="#CCCCCC"> it up</font>

364
00:13:14,240 --> 00:13:20,270
in

365
00:13:14,670 --> 00:13:22,829
to detect so what we see is the<font color="#E5E5E5"> actual</font>

366
00:13:20,270 --> 00:13:24,510
<font color="#E5E5E5">the double</font><font color="#CCCCCC"> pulsar modification as I</font>

367
00:13:22,830 --> 00:13:28,140
mentioned teens the offsets that<font color="#CCCCCC"> are</font>

368
00:13:24,510 --> 00:13:31,100
used within the SNP SMB<font color="#E5E5E5"> v1 pocket</font>

369
00:13:28,140 --> 00:13:34,439
so traditionally double pulse are used

370
00:13:31,100 --> 00:13:36,660
<font color="#CCCCCC">0x1 II which was the offset ID located</font>

371
00:13:34,440 --> 00:13:39,300
within a network<font color="#CCCCCC"> pickup</font><font color="#E5E5E5"> so if you did</font>

372
00:13:36,660 --> 00:13:40,740
network<font color="#E5E5E5"> IDs</font><font color="#CCCCCC"> based</font><font color="#E5E5E5"> detection</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> would</font>

373
00:13:39,300 --> 00:13:42,390
be one<font color="#CCCCCC"> of the signatures used it</font><font color="#E5E5E5"> would</font>

374
00:13:40,740 --> 00:13:44,880
look for<font color="#CCCCCC"> any information</font><font color="#E5E5E5"> being used</font>

375
00:13:42,390 --> 00:13:47,819
<font color="#E5E5E5">within there however Nanta stroke</font><font color="#CCCCCC"> knob</font>

376
00:13:44,880 --> 00:13:49,800
<font color="#CCCCCC">had</font><font color="#E5E5E5"> changed</font><font color="#CCCCCC"> it to 0</font><font color="#E5E5E5"> X 16 this is</font><font color="#CCCCCC"> a</font>

377
00:13:47,820 --> 00:13:51,600
reserved feeling that exists with an SMB

378
00:13:49,800 --> 00:13:54,510
protocol<font color="#E5E5E5"> should not be used it should</font>

379
00:13:51,600 --> 00:13:56,760
<font color="#E5E5E5">always be 0 0</font><font color="#CCCCCC"> in this instance</font><font color="#E5E5E5"> this</font>

380
00:13:54,510 --> 00:13:58,319
became for us<font color="#E5E5E5"> writing any signature</font>

381
00:13:56,760 --> 00:13:59,970
<font color="#E5E5E5">based off easy to detect</font><font color="#CCCCCC"> because you'd</font>

382
00:13:58,320 --> 00:14:02,040
write that quite quickly<font color="#E5E5E5"> but again you</font>

383
00:13:59,970 --> 00:14:06,870
see<font color="#CCCCCC"> the simple changes that</font><font color="#E5E5E5"> they make</font><font color="#CCCCCC"> to</font>

384
00:14:02,040 --> 00:14:09,420
<font color="#E5E5E5">make it more difficult to detect so then</font>

385
00:14:06,870 --> 00:14:11,760
we get the PS exact again<font color="#E5E5E5"> totally</font>

386
00:14:09,420 --> 00:14:13,260
legitimate when you still very<font color="#CCCCCC"> hardly</font><font color="#E5E5E5"> if</font>

387
00:14:11,760 --> 00:14:15,510
<font color="#E5E5E5">your systems administrator you can do</font>

388
00:14:13,260 --> 00:14:18,240
math<font color="#E5E5E5"> just administration capability</font>

389
00:14:15,510 --> 00:14:20,220
tools with this so we drop our perfect

390
00:14:18,240 --> 00:14:21,870
<font color="#CCCCCC">dot</font><font color="#E5E5E5"> data as we mentioned</font><font color="#CCCCCC"> before</font><font color="#E5E5E5"> this has</font>

391
00:14:20,220 --> 00:14:24,150
three<font color="#CCCCCC"> of them better</font><font color="#E5E5E5"> resources as I</font>

392
00:14:21,870 --> 00:14:26,430
mentioned<font color="#CCCCCC"> two more so one of them is PS</font>

393
00:14:24,150 --> 00:14:28,530
exact so we've no<font color="#CCCCCC"> stolen</font><font color="#E5E5E5"> the tokens</font>

394
00:14:26,430 --> 00:14:30,089
we've got all our credentials<font color="#E5E5E5"> will now</font>

395
00:14:28,530 --> 00:14:32,069
use<font color="#CCCCCC"> PS exact to try and connect the</font>

396
00:14:30,090 --> 00:14:35,490
other machines<font color="#E5E5E5"> that we've scanned and</font>

397
00:14:32,070 --> 00:14:38,520
what we see is being used as remove pipe

398
00:14:35,490 --> 00:14:40,770
except<font color="#CCCCCC"> ula to make it all silent</font><font color="#E5E5E5"> Lulla</font>

399
00:14:38,520 --> 00:14:44,340
command<font color="#E5E5E5"> and run orders windows DLL run</font>

400
00:14:40,770 --> 00:14:45,780
32<font color="#E5E5E5"> so we go off and</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> run</font><font color="#CCCCCC"> our</font><font color="#E5E5E5"> malware</font>

401
00:14:44,340 --> 00:14:49,860
and<font color="#E5E5E5"> you're called at application but we</font>

402
00:14:45,780 --> 00:14:53,220
<font color="#E5E5E5">run our malware</font><font color="#CCCCCC"> second methodology was</font>

403
00:14:49,860 --> 00:14:55,590
<font color="#E5E5E5">using</font><font color="#CCCCCC"> WMI so again we use wmic dollar XE</font>

404
00:14:53,220 --> 00:14:57,660
we do a remote<font color="#E5E5E5"> user password pass</font>

405
00:14:55,590 --> 00:14:59,730
information and we do a<font color="#E5E5E5"> process called</font>

406
00:14:57,660 --> 00:15:01,530
<font color="#E5E5E5">crit again this lets me run it remotely</font>

407
00:14:59,730 --> 00:15:03,210
without physically organ<font color="#CCCCCC"> onto a</font><font color="#E5E5E5"> machine</font>

408
00:15:01,530 --> 00:15:03,689
<font color="#CCCCCC">because there's no way an attacker can</font>

409
00:15:03,210 --> 00:15:05,820
do that

410
00:15:03,690 --> 00:15:09,750
<font color="#E5E5E5">Aniki and we see the on the export of</font>

411
00:15:05,820 --> 00:15:11,010
<font color="#E5E5E5">hash tag</font><font color="#CCCCCC"> won't being used again</font><font color="#E5E5E5"> so the</font>

412
00:15:09,750 --> 00:15:13,110
encryption<font color="#E5E5E5"> process this is where</font>

413
00:15:11,010 --> 00:15:14,880
obviously<font color="#CCCCCC"> it became the ransom or</font>

414
00:15:13,110 --> 00:15:17,730
element side of it this<font color="#E5E5E5"> is why initially</font>

415
00:15:14,880 --> 00:15:20,189
<font color="#CCCCCC">it was thought to be ransomware</font><font color="#E5E5E5"> so we'll</font>

416
00:15:17,730 --> 00:15:22,380
step<font color="#CCCCCC"> through this all</font><font color="#E5E5E5"> the propagation</font>

417
00:15:20,190 --> 00:15:24,960
techniques we've discussed<font color="#E5E5E5"> or all here</font>

418
00:15:22,380 --> 00:15:26,800
<font color="#CCCCCC">it</font><font color="#E5E5E5"> will get as many credentials as a con</font>

419
00:15:24,960 --> 00:15:28,300
and<font color="#E5E5E5"> it will then try</font><font color="#CCCCCC"> and laterally move</font>

420
00:15:26,800 --> 00:15:30,819
<font color="#CCCCCC">our machines by numerating and</font><font color="#E5E5E5"> network</font>

421
00:15:28,300 --> 00:15:32,890
as<font color="#CCCCCC"> we've discussed will try and ask you</font>

422
00:15:30,820 --> 00:15:35,019
<font color="#CCCCCC">leap privileges</font><font color="#E5E5E5"> so we're</font><font color="#CCCCCC"> looking for</font>

423
00:15:32,890 --> 00:15:37,180
<font color="#E5E5E5">obviously admin basic currency</font><font color="#CCCCCC"> be able</font>

424
00:15:35,019 --> 00:15:40,300
to move to more machines<font color="#E5E5E5"> etcetera and</font>

425
00:15:37,180 --> 00:15:42,099
<font color="#E5E5E5">we'll try to look</font><font color="#CCCCCC"> for down here se debug</font>

426
00:15:40,300 --> 00:15:44,949
privileges<font color="#E5E5E5"> and as he shut down privilege</font>

427
00:15:42,100 --> 00:15:48,130
<font color="#E5E5E5">this allows us to</font><font color="#CCCCCC"> have heightened user</font>

428
00:15:44,950 --> 00:15:49,720
access and<font color="#CCCCCC"> privileged user access once</font>

429
00:15:48,130 --> 00:15:53,740
we run on the machine will start to

430
00:15:49,720 --> 00:15:55,540
encrypt all the files RSA 2048 like most

431
00:15:53,740 --> 00:15:58,540
malware<font color="#CCCCCC"> it's standard encryption</font>

432
00:15:55,540 --> 00:16:01,060
<font color="#E5E5E5">obviously on crackle by anyone here as</font>

433
00:15:58,540 --> 00:16:02,800
far<font color="#E5E5E5"> as I knew someone does we can start</font>

434
00:16:01,060 --> 00:16:04,209
a malware around somewhere<font color="#E5E5E5"> company and</font>

435
00:16:02,800 --> 00:16:07,540
give everyone their files back which

436
00:16:04,209 --> 00:16:09,910
would be nice<font color="#E5E5E5"> and once we do that we</font>

437
00:16:07,540 --> 00:16:10,990
shared<font color="#CCCCCC"> your reboot</font><font color="#E5E5E5"> and if we've been</font>

438
00:16:09,910 --> 00:16:12,790
<font color="#E5E5E5">able to get</font><font color="#CCCCCC"> through the elevator</font>

439
00:16:10,990 --> 00:16:15,610
privileges we discussed will actually

440
00:16:12,790 --> 00:16:18,399
destroy<font color="#CCCCCC"> the</font><font color="#E5E5E5"> MBR so if you could se debug</font>

441
00:16:15,610 --> 00:16:20,500
or se<font color="#E5E5E5"> shutdown privileges will destroy a</font>

442
00:16:18,399 --> 00:16:22,000
Master Boot Record on physical<font color="#E5E5E5"> drive</font><font color="#CCCCCC"> 0</font>

443
00:16:20,500 --> 00:16:25,360
<font color="#E5E5E5">so the first drive that the</font><font color="#CCCCCC"> Machine</font>

444
00:16:22,000 --> 00:16:27,130
loads or will destroy the first<font color="#E5E5E5"> hand</font>

445
00:16:25,360 --> 00:16:29,980
disk sectors<font color="#E5E5E5"> regardless if we've got</font>

446
00:16:27,130 --> 00:16:32,920
administrative access<font color="#E5E5E5"> what's really</font>

447
00:16:29,980 --> 00:16:35,260
interesting<font color="#E5E5E5"> here is we're not</font><font color="#CCCCCC"> really</font>

448
00:16:32,920 --> 00:16:36,969
confirmed concerned with encrypting the

449
00:16:35,260 --> 00:16:39,579
<font color="#E5E5E5">machine really we want to trash the</font>

450
00:16:36,970 --> 00:16:40,839
<font color="#E5E5E5">machine we want to break the machine yes</font>

451
00:16:39,579 --> 00:16:42,880
will encrypt all the files<font color="#E5E5E5"> and that's</font>

452
00:16:40,839 --> 00:16:43,660
<font color="#E5E5E5">fine and</font><font color="#CCCCCC"> will look like ransomware as</font>

453
00:16:42,880 --> 00:16:45,910
you'll see in a moment

454
00:16:43,660 --> 00:16:51,310
ultimately we wanted to trash these

455
00:16:45,910 --> 00:16:54,370
machines<font color="#CCCCCC"> so this cost maersk</font><font color="#E5E5E5"> 300 million</font>

456
00:16:51,310 --> 00:16:56,619
<font color="#E5E5E5">in terms of lost</font><font color="#CCCCCC"> revenue marek the</font>

457
00:16:54,370 --> 00:16:58,930
pharmaceutical company it<font color="#CCCCCC"> cost</font><font color="#E5E5E5"> over 300</font>

458
00:16:56,620 --> 00:17:01,930
<font color="#CCCCCC">million</font><font color="#E5E5E5"> in terms of what</font><font color="#CCCCCC"> impact they</font>

459
00:16:58,930 --> 00:17:04,918
<font color="#E5E5E5">have</font><font color="#CCCCCC"> that alone</font><font color="#E5E5E5"> across</font><font color="#CCCCCC"> two companies is</font>

460
00:17:01,930 --> 00:17:07,480
over half a billion dollars all because

461
00:17:04,919 --> 00:17:10,419
someone compromised the supply chain and

462
00:17:07,480 --> 00:17:12,189
provided a ruby version of code<font color="#CCCCCC"> a</font>

463
00:17:10,419 --> 00:17:14,260
malicious version of<font color="#CCCCCC"> the software up it</font>

464
00:17:12,189 --> 00:17:16,600
but like I mentioned<font color="#CCCCCC"> these guys weren't</font>

465
00:17:14,260 --> 00:17:17,890
after<font color="#CCCCCC"> financial gain they didn't want to</font>

466
00:17:16,599 --> 00:17:19,780
<font color="#E5E5E5">run some you didn't want to get any</font>

467
00:17:17,890 --> 00:17:22,510
money<font color="#E5E5E5"> but they wanted to break your</font>

468
00:17:19,780 --> 00:17:24,819
<font color="#E5E5E5">machine reboot it so when it came</font><font color="#CCCCCC"> on you</font>

469
00:17:22,510 --> 00:17:27,550
couldn't<font color="#E5E5E5"> get</font><font color="#CCCCCC"> out anything and</font><font color="#E5E5E5"> obviously</font>

470
00:17:24,819 --> 00:17:29,168
final<font color="#E5E5E5"> all clear up because all attackers</font>

471
00:17:27,550 --> 00:17:31,450
do this now they clear their logs<font color="#CCCCCC"> to</font>

472
00:17:29,169 --> 00:17:34,330
<font color="#CCCCCC">make it harder to detect</font><font color="#E5E5E5"> so this is the</font>

473
00:17:31,450 --> 00:17:36,010
payload so as I mentioned it looks like

474
00:17:34,330 --> 00:17:36,980
<font color="#E5E5E5">Pacha</font><font color="#CCCCCC"> if any of you ever</font><font color="#E5E5E5"> seen</font><font color="#CCCCCC"> patchy</font>

475
00:17:36,010 --> 00:17:39,559
<font color="#E5E5E5">this is pretty much</font>

476
00:17:36,980 --> 00:17:40,929
carbon copy of<font color="#CCCCCC"> what the pager</font><font color="#E5E5E5"> and check</font>

477
00:17:39,559 --> 00:17:43,690
<font color="#E5E5E5">this screen looks like when you reboot</font>

478
00:17:40,929 --> 00:17:47,179
<font color="#CCCCCC">now what's really</font><font color="#E5E5E5"> interesting here is</font>

479
00:17:43,690 --> 00:17:52,570
one Bitcoin<font color="#E5E5E5"> address was used for every</font>

480
00:17:47,179 --> 00:17:55,040
<font color="#E5E5E5">single infection and one email</font><font color="#CCCCCC"> address</font>

481
00:17:52,570 --> 00:17:58,520
which was<font color="#CCCCCC"> Wolfe Smith one two three four</font>

482
00:17:55,040 --> 00:18:00,470
five so<font color="#E5E5E5"> Hakeem they didn't care really</font>

483
00:17:58,520 --> 00:18:02,900
<font color="#E5E5E5">about</font><font color="#CCCCCC"> getting paid</font><font color="#E5E5E5"> because similar to</font>

484
00:18:00,470 --> 00:18:05,390
<font color="#E5E5E5">wanna cry these guys had new method</font><font color="#CCCCCC"> to</font>

485
00:18:02,900 --> 00:18:06,820
actually<font color="#E5E5E5"> tie payments to addresses so</font>

486
00:18:05,390 --> 00:18:09,230
everyone in this room could<font color="#CCCCCC"> have paid</font>

487
00:18:06,820 --> 00:18:10,850
but I could<font color="#E5E5E5"> have emailed and said yeah</font>

488
00:18:09,230 --> 00:18:12,470
<font color="#E5E5E5">there was me the paid know obviously if</font>

489
00:18:10,850 --> 00:18:14,389
anyone does new Bitcoin we can do<font color="#E5E5E5"> ki</font>

490
00:18:12,470 --> 00:18:16,640
sign and stuff but my assumption<font color="#CCCCCC"> is</font>

491
00:18:14,390 --> 00:18:18,890
<font color="#E5E5E5">these guys didn't care</font><font color="#CCCCCC"> but there was new</font>

492
00:18:16,640 --> 00:18:21,049
<font color="#CCCCCC">there's no way to get in</font><font color="#E5E5E5"> contact this</font>

493
00:18:18,890 --> 00:18:22,549
email<font color="#E5E5E5"> address gets shoved on</font><font color="#CCCCCC"> it which</font>

494
00:18:21,049 --> 00:18:24,410
<font color="#E5E5E5">meant capability actually to discuss</font>

495
00:18:22,549 --> 00:18:27,918
with the attacker<font color="#CCCCCC"> the attack that card</font>

496
00:18:24,410 --> 00:18:28,720
<font color="#CCCCCC">ID was</font><font color="#E5E5E5"> null and void so genuine</font>

497
00:18:27,919 --> 00:18:31,610
ransomware

498
00:18:28,720 --> 00:18:32,900
no probably<font color="#CCCCCC"> not single Bitcoin wallet</font>

499
00:18:31,610 --> 00:18:35,030
<font color="#E5E5E5">too difficult</font><font color="#CCCCCC"> to work with he's paid</font>

500
00:18:32,900 --> 00:18:35,870
single email<font color="#E5E5E5"> address you can't actually</font>

501
00:18:35,030 --> 00:18:39,379
talk<font color="#CCCCCC"> to</font><font color="#E5E5E5"> him</font>

502
00:18:35,870 --> 00:18:40,639
most<font color="#E5E5E5"> ransom or will work on the basis</font>

503
00:18:39,380 --> 00:18:43,250
that they will be able<font color="#E5E5E5"> to</font><font color="#CCCCCC"> communicate</font>

504
00:18:40,640 --> 00:18:44,390
with you because that's<font color="#E5E5E5"> what</font><font color="#CCCCCC"> they</font><font color="#E5E5E5"> want</font>

505
00:18:43,250 --> 00:18:47,150
to<font color="#E5E5E5"> do to be able to give you private</font>

506
00:18:44,390 --> 00:18:49,640
keys<font color="#CCCCCC"> etcetera</font><font color="#E5E5E5"> as I said if they get</font><font color="#CCCCCC"> I'm</font>

507
00:18:47,150 --> 00:18:53,210
<font color="#CCCCCC">in the MBR is</font><font color="#E5E5E5"> overwritten suit disk is</font>

508
00:18:49,640 --> 00:18:55,610
trashed anyway MBR<font color="#CCCCCC"> is not overwritten it</font>

509
00:18:53,210 --> 00:18:57,080
will wipe the first<font color="#E5E5E5"> ten disk sectors but</font>

510
00:18:55,610 --> 00:18:58,100
<font color="#E5E5E5">necessarily doesn't mean the machine</font><font color="#CCCCCC"> is</font>

511
00:18:57,080 --> 00:18:59,199
<font color="#E5E5E5">crossed</font><font color="#CCCCCC"> where you definitely</font><font color="#E5E5E5"> have to</font>

512
00:18:58,100 --> 00:19:02,178
reimage it

513
00:18:59,200 --> 00:19:05,330
I'm really really interestingly<font color="#E5E5E5"> if you</font>

514
00:19:02,179 --> 00:19:09,290
run a VP dot XE does anybody<font color="#E5E5E5"> knew what</font><font color="#CCCCCC"> a</font>

515
00:19:05,330 --> 00:19:12,168
VP dot X years<font color="#E5E5E5"> longer do you know I</font>

516
00:19:09,290 --> 00:19:15,190
guess<font color="#E5E5E5"> Persky is right yeah so if this</font>

517
00:19:12,169 --> 00:19:18,020
<font color="#CCCCCC">mal were fined</font><font color="#E5E5E5"> Kaspersky on your machine</font>

518
00:19:15,190 --> 00:19:21,850
it went off and wiped the first 10

519
00:19:18,020 --> 00:19:23,900
sectors anyway no that's interesting<font color="#CCCCCC"> and</font>

520
00:19:21,850 --> 00:19:26,889
what was really<font color="#E5E5E5"> interesting with this it</font>

521
00:19:23,900 --> 00:19:29,360
was<font color="#CCCCCC"> very indiscriminate</font><font color="#E5E5E5"> it attacked</font>

522
00:19:26,890 --> 00:19:31,370
<font color="#E5E5E5">anyone of</font><font color="#CCCCCC"> coud you find with a lot</font>

523
00:19:29,360 --> 00:19:34,129
around<font color="#E5E5E5"> some were things like ignore</font>

524
00:19:31,370 --> 00:19:35,989
<font color="#E5E5E5">Russian language things like that with</font>

525
00:19:34,130 --> 00:19:38,990
this it attacked everyone<font color="#CCCCCC"> and anyone</font>

526
00:19:35,990 --> 00:19:40,640
<font color="#CCCCCC">coud it was warmer balls mansions who</font>

527
00:19:38,990 --> 00:19:43,640
<font color="#CCCCCC">would had the ability and capability to</font>

528
00:19:40,640 --> 00:19:45,890
spread with extreme velocity<font color="#E5E5E5"> and it did</font>

529
00:19:43,640 --> 00:19:49,460
spread very quickly and<font color="#E5E5E5"> this was the</font>

530
00:19:45,890 --> 00:19:50,770
actors go fix your<font color="#CCCCCC"> mess I'm done</font><font color="#E5E5E5"> because</font>

531
00:19:49,460 --> 00:19:51,970
<font color="#CCCCCC">they did not care</font>

532
00:19:50,770 --> 00:19:54,250
<font color="#E5E5E5">they didn't want you to recover because</font>

533
00:19:51,970 --> 00:19:55,630
<font color="#CCCCCC">they had no method</font><font color="#E5E5E5"> of communication they</font>

534
00:19:54,250 --> 00:19:57,130
didn't want<font color="#E5E5E5"> to give you any encryption</font>

535
00:19:55,630 --> 00:19:58,780
keys back because it<font color="#E5E5E5"> was all trash</font>

536
00:19:57,130 --> 00:20:00,400
anyway<font color="#E5E5E5"> they didn't want you to have</font>

537
00:19:58,780 --> 00:20:02,770
<font color="#CCCCCC">access</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> your machine</font><font color="#E5E5E5"> because they</font>

538
00:20:00,400 --> 00:20:06,160
tried to trash the<font color="#E5E5E5"> disk shut</font><font color="#CCCCCC"> down</font><font color="#E5E5E5"> the</font>

539
00:20:02,770 --> 00:20:07,960
<font color="#CCCCCC">machine and move on</font><font color="#E5E5E5"> so in my opinion</font><font color="#CCCCCC"> the</font>

540
00:20:06,160 --> 00:20:08,890
<font color="#CCCCCC">actor left like this I might no one</font>

541
00:20:07,960 --> 00:20:10,780
knows who it<font color="#E5E5E5"> was</font>

542
00:20:08,890 --> 00:20:13,230
authorities still<font color="#E5E5E5"> have not been able to</font>

543
00:20:10,780 --> 00:20:15,460
<font color="#E5E5E5">determine who</font><font color="#CCCCCC"> was they've got away</font>

544
00:20:13,230 --> 00:20:17,350
<font color="#E5E5E5">fairly cleanly so far they didn't get</font>

545
00:20:15,460 --> 00:20:18,940
<font color="#CCCCCC">away</font><font color="#E5E5E5"> with any money but</font><font color="#CCCCCC"> we don't believe</font>

546
00:20:17,350 --> 00:20:27,370
financial game was what they were really

547
00:20:18,940 --> 00:20:30,190
<font color="#E5E5E5">up to and I will let Paul talk</font><font color="#CCCCCC"> know so</font>

548
00:20:27,370 --> 00:20:32,260
<font color="#E5E5E5">rain machine you and describe your first</font>

549
00:20:30,190 --> 00:20:33,700
<font color="#E5E5E5">separate chain attacks we</font><font color="#CCCCCC"> have to work</font>

550
00:20:32,260 --> 00:20:35,290
on it and I'm<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to present</font><font color="#E5E5E5"> you</font>

551
00:20:33,700 --> 00:20:38,290
<font color="#E5E5E5">another one</font>

552
00:20:35,290 --> 00:20:42,700
about<font color="#E5E5E5"> a tool named</font><font color="#CCCCCC"> Selena</font><font color="#E5E5E5"> who knows this</font>

553
00:20:38,290 --> 00:20:50,620
application yes<font color="#E5E5E5"> we recommend this</font>

554
00:20:42,700 --> 00:20:54,040
application<font color="#E5E5E5"> to a friend so four people</font>

555
00:20:50,620 --> 00:20:56,830
would doesn't know this application is a

556
00:20:54,040 --> 00:20:58,810
cleaner application used to directly

557
00:20:56,830 --> 00:21:01,960
<font color="#E5E5E5">speed up your laptop and stuff like that</font>

558
00:20:58,810 --> 00:21:05,560
<font color="#E5E5E5">so it's it's used by a lot of people if</font>

559
00:21:01,960 --> 00:21:09,700
with<font color="#E5E5E5"> that efficient number from</font><font color="#CCCCCC"> ccleaner</font>

560
00:21:05,560 --> 00:21:11,950
<font color="#E5E5E5">it's billion of download and used by a</font>

561
00:21:09,700 --> 00:21:14,530
million of machine<font color="#E5E5E5"> around the world so</font>

562
00:21:11,950 --> 00:21:16,870
it's it's a<font color="#E5E5E5"> very famous</font><font color="#CCCCCC"> well-known</font><font color="#E5E5E5"> and</font>

563
00:21:14,530 --> 00:21:18,940
used free application it's free so

564
00:21:16,870 --> 00:21:23,800
that's<font color="#E5E5E5"> why it's so used you don't have</font>

565
00:21:18,940 --> 00:21:26,560
to pay to clean<font color="#E5E5E5"> your machine</font><font color="#CCCCCC"> so one of</font>

566
00:21:23,800 --> 00:21:29,590
our engine detects<font color="#E5E5E5"> something wrong on</font>

567
00:21:26,560 --> 00:21:31,179
this binary<font color="#E5E5E5"> and we did we decided to</font>

568
00:21:29,590 --> 00:21:34,090
<font color="#E5E5E5">start working</font><font color="#CCCCCC"> on it to understand if</font>

569
00:21:31,180 --> 00:21:37,660
<font color="#CCCCCC">it's</font><font color="#E5E5E5"> power on join that half issue</font><font color="#CCCCCC"> of if</font>

570
00:21:34,090 --> 00:21:40,480
the<font color="#E5E5E5"> binary that have issue the</font><font color="#CCCCCC"> thing is</font>

571
00:21:37,660 --> 00:21:42,460
<font color="#E5E5E5">first thing when you analyze a binary</font>

572
00:21:40,480 --> 00:21:44,260
you check the signatures if it's sign

573
00:21:42,460 --> 00:21:47,710
and in this case<font color="#E5E5E5"> the thing that just was</font>

574
00:21:44,260 --> 00:21:50,740
good<font color="#E5E5E5"> everything was fine</font><font color="#CCCCCC"> so it was not</font>

575
00:21:47,710 --> 00:21:52,630
simply a bad guys<font color="#CCCCCC"> that patch</font><font color="#E5E5E5"> binary with</font>

576
00:21:50,740 --> 00:21:56,560
malicious<font color="#CCCCCC"> cut cause the signatures is</font>

577
00:21:52,630 --> 00:21:58,180
impact is<font color="#E5E5E5"> good and not corrupted so yeah</font>

578
00:21:56,560 --> 00:22:01,570
it's<font color="#E5E5E5"> weird for things so we decided to</font>

579
00:21:58,180 --> 00:22:02,870
<font color="#E5E5E5">to spend more time</font><font color="#CCCCCC"> on it</font><font color="#E5E5E5"> and see what</font>

580
00:22:01,570 --> 00:22:07,750
happened and<font color="#E5E5E5"> what</font>

581
00:22:02,870 --> 00:22:11,719
is what our enjoying detectors malicious

582
00:22:07,750 --> 00:22:14,240
so as you guess<font color="#E5E5E5"> probably this binary was</font>

583
00:22:11,720 --> 00:22:17,450
was compromised and<font color="#E5E5E5"> it was specifically</font>

584
00:22:14,240 --> 00:22:19,100
<font color="#E5E5E5">this version of</font><font color="#CCCCCC"> ccleaner so seeking us</font>

585
00:22:17,450 --> 00:22:21,430
<font color="#E5E5E5">to version</font><font color="#CCCCCC"> the standalone</font><font color="#E5E5E5"> one and a</font>

586
00:22:19,100 --> 00:22:25,010
cloud one and both Russian was

587
00:22:21,430 --> 00:22:27,770
compromised<font color="#CCCCCC"> and I I think</font><font color="#E5E5E5"> you never read</font>

588
00:22:25,010 --> 00:22:32,059
a<font color="#E5E5E5"> change look like everybody but you've</font>

589
00:22:27,770 --> 00:22:36,020
got<font color="#E5E5E5"> a</font><font color="#CCCCCC"> history of of the</font><font color="#E5E5E5"> binary version</font>

590
00:22:32,059 --> 00:22:39,379
by<font color="#E5E5E5"> Selena and my</font><font color="#CCCCCC"> Turk will</font><font color="#E5E5E5"> be a button</font>

591
00:22:36,020 --> 00:22:43,250
minor bug just<font color="#E5E5E5"> for information and the</font>

592
00:22:39,380 --> 00:22:46,160
good thing is the<font color="#CCCCCC"> patch the backdoor</font>

593
00:22:43,250 --> 00:22:48,679
<font color="#E5E5E5">inside of the binary but as they forget</font>

594
00:22:46,160 --> 00:22:50,530
to<font color="#E5E5E5"> revoke signatures so they revoke the</font>

595
00:22:48,679 --> 00:22:52,760
signatures one week after patching

596
00:22:50,530 --> 00:22:58,000
removing the malicious code inside<font color="#CCCCCC"> of</font>

597
00:22:52,760 --> 00:23:00,679
the binary so when you reverse<font color="#E5E5E5"> marijuana</font>

598
00:22:58,000 --> 00:23:02,960
<font color="#CCCCCC">you</font><font color="#E5E5E5"> generally first thing you simply</font>

599
00:23:00,679 --> 00:23:05,240
ignore<font color="#E5E5E5"> off</font><font color="#CCCCCC"> runtime you don't take time</font>

600
00:23:02,960 --> 00:23:06,920
on<font color="#E5E5E5"> runtime runtime our code included by</font>

601
00:23:05,240 --> 00:23:09,380
<font color="#E5E5E5">compiler automatically it's not</font>

602
00:23:06,920 --> 00:23:12,470
developed by the developer itself<font color="#E5E5E5"> it's</font>

603
00:23:09,380 --> 00:23:14,450
simply add for performance<font color="#CCCCCC"> thread</font>

604
00:23:12,470 --> 00:23:16,760
management<font color="#CCCCCC"> and stuff</font><font color="#E5E5E5"> like that so</font>

605
00:23:14,450 --> 00:23:19,059
basically<font color="#E5E5E5"> when you opened binary on Ida</font>

606
00:23:16,760 --> 00:23:21,620
<font color="#E5E5E5">Pro it said to you</font><font color="#CCCCCC"> it's runtime</font>

607
00:23:19,059 --> 00:23:23,420
underscore something<font color="#E5E5E5"> and you simply</font>

608
00:23:21,620 --> 00:23:25,850
<font color="#E5E5E5">ignore this</font><font color="#CCCCCC"> button start to analyze</font>

609
00:23:23,420 --> 00:23:27,020
after runtime in execution<font color="#E5E5E5"> the attackers</font>

610
00:23:25,850 --> 00:23:29,540
did something pretty clever

611
00:23:27,020 --> 00:23:32,300
<font color="#E5E5E5">he had malicious code inside of runtime</font>

612
00:23:29,540 --> 00:23:34,550
<font color="#E5E5E5">so basically if you do your job as</font>

613
00:23:32,300 --> 00:23:38,419
usually<font color="#CCCCCC"> you simply ignore this part</font><font color="#E5E5E5"> and</font>

614
00:23:34,550 --> 00:23:42,200
you<font color="#E5E5E5"> don't find her sister inside of a</font>

615
00:23:38,420 --> 00:23:44,630
<font color="#CCCCCC">fronting it's something that</font><font color="#E5E5E5"> the Marvel</font>

616
00:23:42,200 --> 00:23:47,360
developers really enjoy<font color="#E5E5E5"> he use it on</font>

617
00:23:44,630 --> 00:23:51,250
several binary<font color="#CCCCCC"> to we</font><font color="#E5E5E5"> would see and it's</font>

618
00:23:47,360 --> 00:23:54,979
a classical way to to work for for him

619
00:23:51,250 --> 00:23:58,010
how works the<font color="#CCCCCC"> beta version of Selena</font><font color="#E5E5E5"> so</font>

620
00:23:54,980 --> 00:24:00,920
first<font color="#CCCCCC"> ccleaner</font><font color="#E5E5E5"> is executed the binary</font>

621
00:23:58,010 --> 00:24:05,000
you download on the<font color="#CCCCCC"> internet</font><font color="#E5E5E5"> and at this</font>

622
00:24:00,920 --> 00:24:08,030
<font color="#E5E5E5">time he the runtime is executed and</font><font color="#CCCCCC"> two</font>

623
00:24:05,000 --> 00:24:11,570
branch<font color="#CCCCCC"> how executed the ccleaner branch</font>

624
00:24:08,030 --> 00:24:13,760
<font color="#CCCCCC">the normal one your binary work as usual</font>

625
00:24:11,570 --> 00:24:15,570
<font color="#CCCCCC">it will clean your machine extra and</font>

626
00:24:13,760 --> 00:24:18,060
another branch

627
00:24:15,570 --> 00:24:21,450
he's executed and it's a malicious part

628
00:24:18,060 --> 00:24:23,700
the first<font color="#E5E5E5"> step of this branch is to</font>

629
00:24:21,450 --> 00:24:25,410
check if<font color="#CCCCCC"> the machine is normal if not a</font>

630
00:24:23,700 --> 00:24:27,330
virtual<font color="#CCCCCC"> machine not that sandbox or</font>

631
00:24:25,410 --> 00:24:31,220
something like<font color="#E5E5E5"> that</font><font color="#CCCCCC"> so first</font><font color="#E5E5E5"> he wait few</font>

632
00:24:27,330 --> 00:24:35,520
<font color="#CCCCCC">second</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> check if it's ready</font><font color="#E5E5E5"> wait and</font>

633
00:24:31,220 --> 00:24:37,650
cause<font color="#E5E5E5"> January sandbox remove slip and</font>

634
00:24:35,520 --> 00:24:41,700
delay<font color="#E5E5E5"> so it's a way to the text and</font><font color="#CCCCCC"> Docs</font>

635
00:24:37,650 --> 00:24:44,310
for example<font color="#CCCCCC"> and if the wait mechanism</font>

636
00:24:41,700 --> 00:24:46,760
fade<font color="#CCCCCC"> summer has stopped</font><font color="#E5E5E5"> execution</font><font color="#CCCCCC"> so he</font>

637
00:24:44,310 --> 00:24:49,500
<font color="#CCCCCC">decides</font><font color="#E5E5E5"> it's sandbox</font><font color="#CCCCCC"> I stop my execution</font>

638
00:24:46,760 --> 00:24:52,379
<font color="#CCCCCC">second thing the manual check if it's</font>

639
00:24:49,500 --> 00:24:54,830
executed as<font color="#CCCCCC"> an</font><font color="#E5E5E5"> mistresses</font><font color="#CCCCCC"> cause ccleaner</font>

640
00:24:52,380 --> 00:24:58,380
<font color="#E5E5E5">on normal execution is executed on as</font>

641
00:24:54,830 --> 00:25:01,429
<font color="#CCCCCC">administrators</font><font color="#E5E5E5"> so if</font><font color="#CCCCCC"> you're executed on</font>

642
00:24:58,380 --> 00:25:05,400
sandbox<font color="#E5E5E5"> maybe it will be executed with</font>

643
00:25:01,430 --> 00:25:09,570
standard users and he decided to fail to

644
00:25:05,400 --> 00:25:13,220
stop execution if everything<font color="#E5E5E5"> looks fine</font>

645
00:25:09,570 --> 00:25:16,500
for the malicious code<font color="#E5E5E5"> he decided to</font>

646
00:25:13,220 --> 00:25:17,520
communicate to the<font color="#CCCCCC"> situ and registers</font>

647
00:25:16,500 --> 00:25:19,470
<font color="#CCCCCC">infected machine</font>

648
00:25:17,520 --> 00:25:27,210
we will see later<font color="#CCCCCC"> how</font><font color="#E5E5E5"> it registers this</font>

649
00:25:19,470 --> 00:25:30,990
machine how he registers<font color="#CCCCCC"> a machine and</font>

650
00:25:27,210 --> 00:25:33,750
how we generate the CC it's not the IP

651
00:25:30,990 --> 00:25:36,900
<font color="#CCCCCC">I've got it inside of the binary not</font>

652
00:25:33,750 --> 00:25:39,480
ready because<font color="#E5E5E5"> in fact</font><font color="#CCCCCC"> we try to reach an</font>

653
00:25:36,900 --> 00:25:41,400
IP but this IP isn't was not reachable

654
00:25:39,480 --> 00:25:44,640
during our investigation and I think

655
00:25:41,400 --> 00:25:48,000
it's on<font color="#E5E5E5"> purpose so it failed</font><font color="#CCCCCC"> so at this</font>

656
00:25:44,640 --> 00:25:50,820
time<font color="#CCCCCC"> he'd generate ggf so</font><font color="#E5E5E5"> we generate</font>

657
00:25:48,000 --> 00:25:52,320
<font color="#E5E5E5">the main based on the mouth so based on</font>

658
00:25:50,820 --> 00:25:56,129
the mouth<font color="#CCCCCC"> he make some mathematic</font>

659
00:25:52,320 --> 00:25:57,870
algorithm and generate a domain<font color="#CCCCCC"> name</font><font color="#E5E5E5"> in</font>

660
00:25:56,130 --> 00:25:59,820
<font color="#E5E5E5">fact he does not directly connect to</font>

661
00:25:57,870 --> 00:26:02,429
<font color="#E5E5E5">this domain name but he performed a</font>

662
00:25:59,820 --> 00:26:04,919
<font color="#CCCCCC">genius request to</font><font color="#E5E5E5"> this domain name to</font>

663
00:26:02,430 --> 00:26:07,740
get the<font color="#CCCCCC"> IP of this domain and this</font>

664
00:26:04,920 --> 00:26:09,920
<font color="#E5E5E5">domain have in fact two IP with this two</font>

665
00:26:07,740 --> 00:26:16,050
IP<font color="#E5E5E5"> he makes some</font>

666
00:26:09,920 --> 00:26:20,340
<font color="#CCCCCC">byte swipe on it to generate the final</font>

667
00:26:16,050 --> 00:26:22,379
IP so you've got high P down<font color="#E5E5E5"> I generate</font>

668
00:26:20,340 --> 00:26:25,379
my<font color="#CCCCCC"> GGA based on the current month I</font>

669
00:26:22,380 --> 00:26:28,110
<font color="#E5E5E5">asked for the IP to this domain</font><font color="#CCCCCC"> name I</font>

670
00:26:25,380 --> 00:26:29,370
make some mathematic on the two IPs and

671
00:26:28,110 --> 00:26:33,449
I finally<font color="#CCCCCC"> have</font>

672
00:26:29,370 --> 00:26:35,309
my real IP<font color="#E5E5E5"> so it's something not so</font>

673
00:26:33,450 --> 00:26:38,309
common and it's a lot of<font color="#E5E5E5"> effort</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> hide</font>

674
00:26:35,309 --> 00:26:42,210
<font color="#E5E5E5">the final destination here is the</font>

675
00:26:38,309 --> 00:26:47,240
different domain generate each month by

676
00:26:42,210 --> 00:26:51,360
by<font color="#E5E5E5"> similar way here is some Open DNS</font>

677
00:26:47,240 --> 00:26:54,600
<font color="#CCCCCC">Cisco</font><font color="#E5E5E5"> umbrella</font><font color="#CCCCCC"> statistics so you can see</font>

678
00:26:51,360 --> 00:26:57,419
here August in August the August in

679
00:26:54,600 --> 00:27:00,149
domain has a lot<font color="#CCCCCC"> of activities and</font><font color="#E5E5E5"> the</font>

680
00:26:57,420 --> 00:27:02,850
<font color="#CCCCCC">first of September its</font><font color="#E5E5E5"> disappear</font><font color="#CCCCCC"> and</font>

681
00:27:00,150 --> 00:27:04,800
here we have the<font color="#E5E5E5"> September of activity</font>

682
00:27:02,850 --> 00:27:07,830
on this September

683
00:27:04,800 --> 00:27:12,720
<font color="#CCCCCC">Gigi a domain so and each month</font><font color="#E5E5E5"> we</font><font color="#CCCCCC"> can</font>

684
00:27:07,830 --> 00:27:16,110
see this kind<font color="#E5E5E5"> of modification so to this</font>

685
00:27:12,720 --> 00:27:18,780
final IP<font color="#E5E5E5"> so the Maria the backdoor</font>

686
00:27:16,110 --> 00:27:20,820
<font color="#CCCCCC">ccleaner application</font><font color="#E5E5E5"> registers a machine</font>

687
00:27:18,780 --> 00:27:23,040
by giving a lot of information in<font color="#E5E5E5"> start</font>

688
00:27:20,820 --> 00:27:25,080
software running process<font color="#E5E5E5"> Exeter we will</font>

689
00:27:23,040 --> 00:27:26,970
see after exactly<font color="#E5E5E5"> what kind of</font>

690
00:27:25,080 --> 00:27:28,830
<font color="#CCCCCC">information are are sent to to the</font>

691
00:27:26,970 --> 00:27:33,960
system for example<font color="#CCCCCC"> here you can</font><font color="#E5E5E5"> guess</font>

692
00:27:28,830 --> 00:27:36,360
<font color="#E5E5E5">it's a Chinese machine so stage 2</font><font color="#CCCCCC"> this</font>

693
00:27:33,960 --> 00:27:39,300
<font color="#E5E5E5">first stage was not</font><font color="#CCCCCC"> was</font><font color="#E5E5E5"> only designed to</font>

694
00:27:36,360 --> 00:27:42,000
register machine<font color="#E5E5E5"> and get a second stage</font>

695
00:27:39,300 --> 00:27:43,919
<font color="#E5E5E5">and the ethicist didn't send the second</font>

696
00:27:42,000 --> 00:27:46,530
stage to every<font color="#CCCCCC"> compromised machine but</font>

697
00:27:43,920 --> 00:27:48,929
<font color="#E5E5E5">only on specific targeted machine we</font>

698
00:27:46,530 --> 00:27:52,290
<font color="#E5E5E5">will see later how hot occurs select</font>

699
00:27:48,929 --> 00:27:54,059
interesting machine<font color="#E5E5E5"> so if the machine is</font>

700
00:27:52,290 --> 00:27:57,389
<font color="#CCCCCC">interesting machine will receive a</font>

701
00:27:54,059 --> 00:27:59,940
second stage<font color="#E5E5E5"> and it shows more as the</font>

702
00:27:57,390 --> 00:28:02,940
same<font color="#E5E5E5"> technique than previously the bad</font>

703
00:27:59,940 --> 00:28:05,070
guys took to legitimate binary and

704
00:28:02,940 --> 00:28:07,830
admonishes<font color="#E5E5E5"> could inside of this</font>

705
00:28:05,070 --> 00:28:09,928
legitimate<font color="#E5E5E5"> binary but in this case no</font>

706
00:28:07,830 --> 00:28:13,169
signatures<font color="#E5E5E5"> of course</font><font color="#CCCCCC"> it didn't</font>

707
00:28:09,929 --> 00:28:15,390
compromise<font color="#E5E5E5"> the company behind this</font>

708
00:28:13,170 --> 00:28:21,990
<font color="#CCCCCC">application they simply patch</font><font color="#E5E5E5"> the</font>

709
00:28:15,390 --> 00:28:24,450
application yeah and they do the<font color="#E5E5E5"> same</font>

710
00:28:21,990 --> 00:28:27,960
thing the<font color="#CCCCCC"> batch application on in the</font>

711
00:28:24,450 --> 00:28:31,040
<font color="#CCCCCC">runtime</font><font color="#E5E5E5"> so same</font><font color="#CCCCCC"> thing if you simply</font>

712
00:28:27,960 --> 00:28:33,270
avoid analyzing<font color="#CCCCCC"> runtime you cannot see</font>

713
00:28:31,040 --> 00:28:37,470
the malicious code<font color="#CCCCCC"> and the</font><font color="#E5E5E5"> malicious</font>

714
00:28:33,270 --> 00:28:39,810
jump<font color="#CCCCCC"> in fact something clever from the</font>

715
00:28:37,470 --> 00:28:41,320
attackers point<font color="#E5E5E5"> of view is here you got</font>

716
00:28:39,810 --> 00:28:45,519
the<font color="#CCCCCC"> Ida Pro graph</font>

717
00:28:41,320 --> 00:28:48,580
you of the<font color="#CCCCCC"> runtime and you can see here</font>

718
00:28:45,519 --> 00:28:53,559
it last instruction is but it's weird

719
00:28:48,580 --> 00:28:56,678
<font color="#E5E5E5">first but if you</font><font color="#CCCCCC"> switch on text view</font><font color="#E5E5E5"> you</font>

720
00:28:53,559 --> 00:28:59,710
will<font color="#CCCCCC"> see the last instruction</font><font color="#E5E5E5"> is jump in</font>

721
00:28:56,679 --> 00:29:01,360
fact see Atticus<font color="#E5E5E5"> use a</font><font color="#CCCCCC"> burger feature</font><font color="#E5E5E5"> in</font>

722
00:28:59,710 --> 00:29:04,090
different of the point<font color="#E5E5E5"> of</font><font color="#CCCCCC"> view of either</font>

723
00:29:01,360 --> 00:29:08,918
<font color="#CCCCCC">Pro</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> find</font><font color="#E5E5E5"> the jump if you use the</font>

724
00:29:04,090 --> 00:29:11,740
graph view in<font color="#E5E5E5"> fact either</font><font color="#CCCCCC"> produce some</font>

725
00:29:08,919 --> 00:29:14,919
metadata in the<font color="#E5E5E5"> binary to define with</font>

726
00:29:11,740 --> 00:29:19,570
where is the last<font color="#CCCCCC"> instruction and the</font>

727
00:29:14,919 --> 00:29:22,720
<font color="#CCCCCC">Atticus go one</font><font color="#E5E5E5"> byte later and thanks to</font>

728
00:29:19,570 --> 00:29:25,870
this<font color="#E5E5E5"> simple trick either get the view</font>

729
00:29:22,720 --> 00:29:29,500
<font color="#E5E5E5">too</font><font color="#CCCCCC"> early</font><font color="#E5E5E5"> in fact and if you switch here</font>

730
00:29:25,870 --> 00:29:33,629
you either don't<font color="#E5E5E5"> cut by graph so you can</font>

731
00:29:29,500 --> 00:29:33,629
<font color="#CCCCCC">see the final</font><font color="#E5E5E5"> jump</font><font color="#CCCCCC"> so it's pretty clever</font>

732
00:29:33,690 --> 00:29:39,820
yeah for Cudahy users you don't<font color="#CCCCCC"> have the</font>

733
00:29:37,299 --> 00:29:45,039
<font color="#E5E5E5">bug but I don't think someone really use</font>

734
00:29:39,820 --> 00:29:46,750
<font color="#CCCCCC">harder</font><font color="#E5E5E5"> hi what is the purpose of this</font>

735
00:29:45,039 --> 00:29:50,620
second stage<font color="#CCCCCC"> it's more or less</font><font color="#E5E5E5"> the same</font>

736
00:29:46,750 --> 00:29:54,159
goal than the first one<font color="#E5E5E5"> but instead of</font>

737
00:29:50,620 --> 00:29:57,268
using<font color="#CCCCCC"> GG hit connect</font><font color="#E5E5E5"> to to legitimate</font>

738
00:29:54,159 --> 00:30:00,309
website<font color="#CCCCCC"> github perform a specific search</font>

739
00:29:57,269 --> 00:30:03,100
<font color="#CCCCCC">WordPress perform a specific</font><font color="#E5E5E5"> search get</font>

740
00:30:00,309 --> 00:30:06,250
the first<font color="#E5E5E5"> results make some mathematical</font>

741
00:30:03,100 --> 00:30:07,809
results to generate<font color="#E5E5E5"> the IP so the</font>

742
00:30:06,250 --> 00:30:09,700
approach is<font color="#CCCCCC"> exactly the same but</font><font color="#E5E5E5"> instead</font>

743
00:30:07,809 --> 00:30:12,990
<font color="#E5E5E5">of using DNS they use</font><font color="#CCCCCC"> to legitimate</font>

744
00:30:09,700 --> 00:30:17,049
<font color="#E5E5E5">website</font><font color="#CCCCCC"> the bad thing is</font><font color="#E5E5E5"> when we analyze</font>

745
00:30:12,990 --> 00:30:18,779
<font color="#E5E5E5">this case this page was not</font><font color="#CCCCCC"> available</font>

746
00:30:17,049 --> 00:30:27,639
anymore so we were<font color="#E5E5E5"> not able to generate</font>

747
00:30:18,779 --> 00:30:30,700
<font color="#E5E5E5">sistered the new IP yeah so one will</font>

748
00:30:27,639 --> 00:30:33,969
speak<font color="#E5E5E5"> about cut similarities and here is</font>

749
00:30:30,700 --> 00:30:37,600
an example<font color="#CCCCCC"> where on our ccleaner first</font>

750
00:30:33,970 --> 00:30:42,299
stage we saw some I think<font color="#CCCCCC"> it's cues</font><font color="#E5E5E5"> done</font>

751
00:30:37,600 --> 00:30:46,840
by 64 function<font color="#E5E5E5"> and it's the same than</font>

752
00:30:42,299 --> 00:30:50,110
<font color="#CCCCCC">christian by 64 function used by a pt-17</font>

753
00:30:46,840 --> 00:30:53,649
<font color="#CCCCCC">group 72 i know if you know</font><font color="#E5E5E5"> this group</font>

754
00:30:50,110 --> 00:30:55,658
but a lot<font color="#E5E5E5"> of researchers spoke about it</font>

755
00:30:53,649 --> 00:30:58,359
so as you

756
00:30:55,659 --> 00:31:03,820
<font color="#E5E5E5">good</font><font color="#CCCCCC"> could similarities for attribution</font>

757
00:30:58,359 --> 00:31:06,728
<font color="#E5E5E5">is is</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> 100%</font><font color="#CCCCCC"> sure you cannot strictly</font>

758
00:31:03,820 --> 00:31:08,968
linked to stuff together<font color="#E5E5E5"> but it's</font><font color="#CCCCCC"> always</font>

759
00:31:06,729 --> 00:31:12,299
an<font color="#CCCCCC"> interesting point</font>

760
00:31:08,969 --> 00:31:14,739
come on control investigation so we

761
00:31:12,299 --> 00:31:16,059
<font color="#CCCCCC">spoke about the manual itself</font><font color="#E5E5E5"> but</font>

762
00:31:14,739 --> 00:31:19,169
something<font color="#E5E5E5"> really interesting in this</font>

763
00:31:16,059 --> 00:31:22,509
case<font color="#E5E5E5"> we had access to the c2 panel and</font>

764
00:31:19,169 --> 00:31:24,279
<font color="#CCCCCC">in</font><font color="#E5E5E5"> the database of the</font><font color="#CCCCCC"> bad guys</font><font color="#E5E5E5"> so we</font>

765
00:31:22,509 --> 00:31:27,690
were able<font color="#CCCCCC"> to look at the database make</font>

766
00:31:24,279 --> 00:31:30,879
some statistic understand what kind of

767
00:31:27,690 --> 00:31:34,179
profile<font color="#E5E5E5"> see Atticus is looking for etc</font>

768
00:31:30,879 --> 00:31:37,359
so first it's a simple PHP<font color="#CCCCCC"> website no</font>

769
00:31:34,179 --> 00:31:40,479
rocket science<font color="#CCCCCC"> with a MySQL database so</font>

770
00:31:37,359 --> 00:31:44,468
nothing very<font color="#CCCCCC"> complicated</font><font color="#E5E5E5"> something</font>

771
00:31:40,479 --> 00:31:47,619
interesting<font color="#E5E5E5"> first if you try to perform</font>

772
00:31:44,469 --> 00:31:50,169
<font color="#CCCCCC">request on the CC but without exactly</font>

773
00:31:47,619 --> 00:31:52,629
<font color="#E5E5E5">the good format</font><font color="#CCCCCC"> so good request a</font><font color="#E5E5E5"> good</font>

774
00:31:50,169 --> 00:31:55,179
post you<font color="#E5E5E5"> will be automatically redirect</font>

775
00:31:52,629 --> 00:31:59,649
to<font color="#CCCCCC"> perform calm which is the developers</font>

776
00:31:55,179 --> 00:32:01,629
of<font color="#CCCCCC"> ccleaner so imagine you see this</font>

777
00:31:59,649 --> 00:32:03,579
weird<font color="#E5E5E5"> IP on your log and</font><font color="#CCCCCC"> you say what</font>

778
00:32:01,629 --> 00:32:05,859
the you try to connect on this

779
00:32:03,579 --> 00:32:07,779
<font color="#E5E5E5">hyper to say maybe I would like to see</font>

780
00:32:05,859 --> 00:32:10,239
what<font color="#E5E5E5"> is behind this IP you'll be</font>

781
00:32:07,779 --> 00:32:12,700
redirected on piriform<font color="#CCCCCC"> calm and you</font><font color="#E5E5E5"> will</font>

782
00:32:10,239 --> 00:32:18,089
say<font color="#E5E5E5"> yeah</font><font color="#CCCCCC"> okay it's purely from IP no big</font>

783
00:32:12,700 --> 00:32:23,289
deal yeah so here is a configuration<font color="#E5E5E5"> of</font>

784
00:32:18,089 --> 00:32:25,839
<font color="#CCCCCC">the website</font><font color="#E5E5E5"> the MySQL database</font><font color="#CCCCCC"> so it</font>

785
00:32:23,289 --> 00:32:30,759
contains<font color="#CCCCCC"> database table extras so if the</font>

786
00:32:25,839 --> 00:32:36,158
users was<font color="#E5E5E5"> CC users may be linked to</font><font color="#CCCCCC"> CC C</font>

787
00:32:30,759 --> 00:32:39,639
<font color="#CCCCCC">cleaner database EC and time zone PRC</font>

788
00:32:36,159 --> 00:32:43,329
same thing I<font color="#E5E5E5"> can make</font><font color="#CCCCCC"> PS on my laptop</font><font color="#E5E5E5"> so</font>

789
00:32:39,639 --> 00:32:47,619
it's not very very<font color="#E5E5E5"> strong proof and here</font>

790
00:32:43,329 --> 00:32:52,509
is a<font color="#CCCCCC"> DLL path of the second stage sent</font>

791
00:32:47,619 --> 00:32:55,988
to interesting target here is<font color="#E5E5E5"> the info</font>

792
00:32:52,509 --> 00:32:58,599
sent to to the CC when of<font color="#E5E5E5"> machine is</font>

793
00:32:55,989 --> 00:33:02,049
compromised so basically they get<font color="#E5E5E5"> IP</font>

794
00:32:58,599 --> 00:33:05,559
address<font color="#E5E5E5"> online time</font><font color="#CCCCCC"> windows version</font><font color="#E5E5E5"> if</font>

795
00:33:02,049 --> 00:33:07,119
it's 32 or 64 bits<font color="#E5E5E5"> if the user sees and</font>

796
00:33:05,559 --> 00:33:08,800
<font color="#CCCCCC">miss</font><font color="#E5E5E5"> traitors a domain</font><font color="#CCCCCC"> name of</font><font color="#E5E5E5"> the</font>

797
00:33:07,119 --> 00:33:11,199
<font color="#CCCCCC">machine the MAC address in star</font><font color="#E5E5E5"> stuff</font>

798
00:33:08,800 --> 00:33:13,629
<font color="#E5E5E5">running process extra so more as a</font>

799
00:33:11,200 --> 00:33:19,930
global category of<font color="#E5E5E5"> the intricate system</font>

800
00:33:13,630 --> 00:33:21,340
and there<font color="#E5E5E5"> is a SQL injection here so the</font>

801
00:33:19,930 --> 00:33:25,360
<font color="#CCCCCC">two she'll cut so it's a shell</font><font color="#E5E5E5"> cut</font>

802
00:33:21,340 --> 00:33:27,669
executed<font color="#E5E5E5"> to load the second state on on</font>

803
00:33:25,360 --> 00:33:30,850
machine so<font color="#CCCCCC"> to version for two</font>

804
00:33:27,670 --> 00:33:32,650
<font color="#E5E5E5">architectures and here is from my</font><font color="#CCCCCC"> point</font>

805
00:33:30,850 --> 00:33:36,699
<font color="#E5E5E5">of view the most interesting part</font>

806
00:33:32,650 --> 00:33:39,460
so before sending the second stage<font color="#CCCCCC"> the</font>

807
00:33:36,700 --> 00:33:41,200
developers implement a filter<font color="#CCCCCC"> her way to</font>

808
00:33:39,460 --> 00:33:43,210
detect interesting machine<font color="#E5E5E5"> and not</font>

809
00:33:41,200 --> 00:33:46,240
interesting machine<font color="#E5E5E5"> it's based on two</font>

810
00:33:43,210 --> 00:33:48,130
things<font color="#E5E5E5"> it's based on the</font><font color="#CCCCCC"> domain name</font><font color="#E5E5E5"> of</font>

811
00:33:46,240 --> 00:33:49,240
<font color="#E5E5E5">the machine</font><font color="#CCCCCC"> so if the domain name is on</font>

812
00:33:48,130 --> 00:33:51,490
my<font color="#E5E5E5"> whitelist</font>

813
00:33:49,240 --> 00:33:55,600
I sent<font color="#CCCCCC"> the second stage and it's based</font>

814
00:33:51,490 --> 00:33:58,120
on<font color="#E5E5E5"> the IP address but in this CC the IP</font>

815
00:33:55,600 --> 00:34:02,230
address<font color="#E5E5E5"> filter was not</font><font color="#CCCCCC"> used only the</font>

816
00:33:58,120 --> 00:34:07,570
domain filters so let's<font color="#E5E5E5"> since database</font>

817
00:34:02,230 --> 00:34:11,020
this this list here<font color="#E5E5E5"> is the list of</font>

818
00:34:07,570 --> 00:34:22,299
domain such in the rest<font color="#E5E5E5"> Marathi</font><font color="#CCCCCC"> flippers</font>

819
00:34:11,020 --> 00:34:26,168
so<font color="#CCCCCC"> basically you can you can see it's</font>

820
00:34:22,300 --> 00:34:30,240
<font color="#E5E5E5">mainly IT company so for couples</font><font color="#CCCCCC"> HTC</font>

821
00:34:26,168 --> 00:34:35,259
<font color="#CCCCCC">Group Samsung Sony</font><font color="#E5E5E5"> VMware Intel Cisco</font>

822
00:34:30,239 --> 00:34:37,989
and<font color="#CCCCCC"> lynx is absent extra</font><font color="#E5E5E5"> so it's a lot</font>

823
00:34:35,260 --> 00:34:40,750
<font color="#E5E5E5">of IT company so in this specific</font>

824
00:34:37,989 --> 00:34:43,389
campaign so<font color="#E5E5E5"> the attackers on this</font>

825
00:34:40,750 --> 00:34:46,030
<font color="#E5E5E5">specific CC was only</font><font color="#CCCCCC"> looking for IT</font>

826
00:34:43,389 --> 00:34:49,299
company<font color="#CCCCCC"> and all the</font><font color="#E5E5E5"> other machine out of</font>

827
00:34:46,030 --> 00:34:51,730
<font color="#CCCCCC">this domain</font><font color="#E5E5E5"> I was simply ignored so in</font>

828
00:34:49,300 --> 00:34:54,370
the database<font color="#E5E5E5"> they can receive a second</font>

829
00:34:51,730 --> 00:35:00,030
stage<font color="#E5E5E5"> of the guide change</font><font color="#CCCCCC"> mind but at</font>

830
00:34:54,370 --> 00:35:02,290
this time they don't<font color="#E5E5E5"> receive anything so</font>

831
00:35:00,030 --> 00:35:04,360
let's let's see a little bit what

832
00:35:02,290 --> 00:35:07,390
contains the<font color="#CCCCCC"> database what kind of data</font>

833
00:35:04,360 --> 00:35:11,020
<font color="#E5E5E5">and</font><font color="#CCCCCC"> how many data</font><font color="#E5E5E5"> first thing we only</font>

834
00:35:07,390 --> 00:35:13,839
have the data of one cc there is five

835
00:35:11,020 --> 00:35:16,540
<font color="#E5E5E5">from our</font><font color="#CCCCCC"> analyzes we only have one</font>

836
00:35:13,840 --> 00:35:17,050
second thing we only have four days<font color="#E5E5E5"> of</font>

837
00:35:16,540 --> 00:35:20,650
<font color="#E5E5E5">data</font>

838
00:35:17,050 --> 00:35:22,040
<font color="#E5E5E5">why because bad guys is like everybody</font>

839
00:35:20,650 --> 00:35:24,170
he face

840
00:35:22,040 --> 00:35:27,259
and he didn't<font color="#CCCCCC"> size correctly this</font>

841
00:35:24,170 --> 00:35:30,140
machine and he has a full<font color="#CCCCCC"> face system</font>

842
00:35:27,260 --> 00:35:33,290
due<font color="#CCCCCC"> to number</font><font color="#E5E5E5"> of compromised machine so</font>

843
00:35:30,140 --> 00:35:34,850
the database<font color="#CCCCCC"> explose suffice system and</font>

844
00:35:33,290 --> 00:35:38,210
he lost his machine and<font color="#E5E5E5"> he has to</font>

845
00:35:34,850 --> 00:35:39,799
<font color="#E5E5E5">reinstall it and it means that the</font>

846
00:35:38,210 --> 00:35:41,720
<font color="#CCCCCC">machine</font><font color="#E5E5E5"> four days before our</font>

847
00:35:39,800 --> 00:35:44,030
investigation<font color="#E5E5E5"> that's right we only have</font>

848
00:35:41,720 --> 00:35:48,859
four<font color="#E5E5E5"> days in fact</font><font color="#CCCCCC"> it's simply cause</font><font color="#E5E5E5"> the</font>

849
00:35:44,030 --> 00:35:52,540
machine<font color="#CCCCCC"> was broken so this table is a</font>

850
00:35:48,860 --> 00:35:56,350
table with<font color="#E5E5E5"> all</font><font color="#CCCCCC"> the information</font>

851
00:35:52,540 --> 00:35:59,950
<font color="#E5E5E5">registered by every compromised system</font>

852
00:35:56,350 --> 00:36:04,460
so you have processed name and you<font color="#CCCCCC"> have</font>

853
00:35:59,950 --> 00:36:06,230
installed application<font color="#CCCCCC"> I I will show you</font>

854
00:36:04,460 --> 00:36:08,350
some statistic about<font color="#E5E5E5"> install application</font>

855
00:36:06,230 --> 00:36:14,960
and it can be a<font color="#CCCCCC"> little</font><font color="#E5E5E5"> bit scary</font>

856
00:36:08,350 --> 00:36:16,819
the<font color="#CCCCCC"> ok table in this case it's the</font>

857
00:36:14,960 --> 00:36:19,480
tables<font color="#E5E5E5"> that contain machines that</font>

858
00:36:16,820 --> 00:36:22,010
received the second stage some machine

859
00:36:19,480 --> 00:36:26,210
where the domain is one of the domain a

860
00:36:22,010 --> 00:36:29,960
list<font color="#E5E5E5"> before so 25 mission so when we</font>

861
00:36:26,210 --> 00:36:33,580
have access<font color="#CCCCCC"> to</font><font color="#E5E5E5"> the database</font><font color="#CCCCCC"> 25 machine</font>

862
00:36:29,960 --> 00:36:38,630
was compromised with<font color="#CCCCCC"> the second stage I</font>

863
00:36:33,580 --> 00:36:40,850
hide the domain of course but yeah if I

864
00:36:38,630 --> 00:36:42,830
take the<font color="#E5E5E5"> service table</font>

865
00:36:40,850 --> 00:36:44,900
it contained<font color="#CCCCCC"> whole the Machine all the</font>

866
00:36:42,830 --> 00:36:48,410
machine with the<font color="#E5E5E5"> first stage and</font><font color="#CCCCCC"> just</font>

867
00:36:44,900 --> 00:36:52,010
<font color="#E5E5E5">backed out</font><font color="#CCCCCC"> sickly now in this case I got</font>

868
00:36:48,410 --> 00:36:55,819
more<font color="#E5E5E5"> than</font><font color="#CCCCCC"> 300 thousand individual</font>

869
00:36:52,010 --> 00:36:59,300
machine<font color="#E5E5E5"> so the guy has more less a 1</font>

870
00:36:55,820 --> 00:37:01,700
million machine but net where he was

871
00:36:59,300 --> 00:37:04,460
able<font color="#E5E5E5"> to do what he wants something</font>

872
00:37:01,700 --> 00:37:07,250
difficult<font color="#E5E5E5"> is</font><font color="#CCCCCC"> Sakina</font><font color="#E5E5E5"> a used by a lot</font><font color="#CCCCCC"> of</font>

873
00:37:04,460 --> 00:37:09,350
individual<font color="#CCCCCC"> users</font><font color="#E5E5E5"> and company so it was</font>

874
00:37:07,250 --> 00:37:12,140
<font color="#E5E5E5">interesting</font><font color="#CCCCCC"> for me to</font><font color="#E5E5E5"> make a difference</font>

875
00:37:09,350 --> 00:37:14,240
between<font color="#E5E5E5"> individual users and company I</font>

876
00:37:12,140 --> 00:37:15,950
<font color="#E5E5E5">don't have a lot of detail on the</font>

877
00:37:14,240 --> 00:37:19,129
database but something can help<font color="#E5E5E5"> me I</font>

878
00:37:15,950 --> 00:37:21,980
decided<font color="#CCCCCC"> to</font><font color="#E5E5E5"> look at machine where the</font>

879
00:37:19,130 --> 00:37:24,530
domain name was not<font color="#E5E5E5"> new so if the</font>

880
00:37:21,980 --> 00:37:27,890
machine is<font color="#E5E5E5"> binded to a domain</font><font color="#CCCCCC"> I estimate</font>

881
00:37:24,530 --> 00:37:32,720
<font color="#CCCCCC">it's a</font><font color="#E5E5E5"> corporate machine and not home</font>

882
00:37:27,890 --> 00:37:35,330
machine<font color="#CCCCCC"> in this case</font><font color="#E5E5E5"> I</font><font color="#CCCCCC"> got</font><font color="#E5E5E5"> 41,000</font>

883
00:37:32,720 --> 00:37:35,649
mission so from my point of view<font color="#E5E5E5"> a lot</font>

884
00:37:35,330 --> 00:37:38,560
of

885
00:37:35,650 --> 00:37:43,090
<font color="#E5E5E5">individual machine were compromised</font><font color="#CCCCCC"> but</font>

886
00:37:38,560 --> 00:37:44,680
a lot<font color="#CCCCCC"> of cop admission to if I look</font><font color="#E5E5E5"> on</font>

887
00:37:43,090 --> 00:37:48,910
this corporate machine<font color="#E5E5E5"> I decided to</font>

888
00:37:44,680 --> 00:37:51,129
count by domain<font color="#E5E5E5"> and typically a specific</font>

889
00:37:48,910 --> 00:37:55,569
<font color="#E5E5E5">domain specific entities organization</font>

890
00:37:51,130 --> 00:37:57,220
<font color="#CCCCCC">cooperation whatever have has 960</font>

891
00:37:55,570 --> 00:37:59,410
compromised machine inside<font color="#E5E5E5"> of his</font>

892
00:37:57,220 --> 00:38:00,970
<font color="#CCCCCC">network</font><font color="#E5E5E5"> so it's a lot</font><font color="#CCCCCC"> of machine when</font>

893
00:37:59,410 --> 00:38:05,980
you<font color="#E5E5E5"> have to deal</font><font color="#CCCCCC"> with an incident and</font>

894
00:38:00,970 --> 00:38:10,240
<font color="#CCCCCC">you have 960 compromised machine</font><font color="#E5E5E5"> it's</font>

895
00:38:05,980 --> 00:38:12,310
<font color="#E5E5E5">not really easy to turn</font><font color="#CCCCCC"> dull yeah some</font>

896
00:38:10,240 --> 00:38:15,040
statistic about<font color="#E5E5E5"> Windows version so we</font>

897
00:38:12,310 --> 00:38:17,920
have it was really representative<font color="#E5E5E5"> of the</font>

898
00:38:15,040 --> 00:38:20,200
world<font color="#CCCCCC"> it's some Windows 10 machine more</font>

899
00:38:17,920 --> 00:38:23,350
<font color="#CCCCCC">Windows 7 machine and few Windows XP</font>

900
00:38:20,200 --> 00:38:26,399
machine<font color="#E5E5E5"> so it's it's not amazing it's</font>

901
00:38:23,350 --> 00:38:29,350
<font color="#E5E5E5">simply a representative of real life</font>

902
00:38:26,400 --> 00:38:31,480
something<font color="#E5E5E5"> more interesting</font><font color="#CCCCCC"> I make some</font>

903
00:38:29,350 --> 00:38:35,350
statistic<font color="#CCCCCC"> about domain containing</font>

904
00:38:31,480 --> 00:38:39,400
dot-gov<font color="#CCCCCC"> and in this case I've got 540</font>

905
00:38:35,350 --> 00:38:42,370
machine so 540 machine had<font color="#CCCCCC"> gov in in the</font>

906
00:38:39,400 --> 00:38:45,100
domain<font color="#E5E5E5"> of course you can have just</font><font color="#CCCCCC"> for</font>

907
00:38:42,370 --> 00:38:49,839
fun in<font color="#E5E5E5"> your domain same thing for</font><font color="#CCCCCC"> Bank</font>

908
00:38:45,100 --> 00:38:52,630
if I check for<font color="#E5E5E5"> Bank I had</font><font color="#CCCCCC"> 5151 machine</font>

909
00:38:49,840 --> 00:38:58,270
<font color="#E5E5E5">that contained Bank in the domain name</font>

910
00:38:52,630 --> 00:39:00,610
<font color="#CCCCCC">and this one this one are not</font><font color="#E5E5E5"> public but</font>

911
00:38:58,270 --> 00:39:02,130
it's interesting I think<font color="#CCCCCC"> I decided to</font>

912
00:39:00,610 --> 00:39:05,110
<font color="#E5E5E5">look at the installed software on</font>

913
00:39:02,130 --> 00:39:08,410
compromised machine<font color="#E5E5E5"> so</font><font color="#CCCCCC"> first high</font>

914
00:39:05,110 --> 00:39:10,690
<font color="#CCCCCC">maximum</font><font color="#E5E5E5"> search on PLC sim so it's PLC</font>

915
00:39:08,410 --> 00:39:14,890
simulator<font color="#CCCCCC"> so it was minute</font><font color="#E5E5E5"> off SCADA</font>

916
00:39:10,690 --> 00:39:17,500
system I got<font color="#CCCCCC"> 206 machine so 206 machine</font>

917
00:39:14,890 --> 00:39:19,540
compromised by<font color="#CCCCCC"> this guy he didn't care</font>

918
00:39:17,500 --> 00:39:21,580
about this<font color="#E5E5E5"> machine</font><font color="#CCCCCC"> because they on the</font>

919
00:39:19,540 --> 00:39:23,620
dot has it didn't have the good domain

920
00:39:21,580 --> 00:39:27,400
<font color="#E5E5E5">name but if you look at the application</font>

921
00:39:23,620 --> 00:39:29,440
<font color="#CCCCCC">it's people that have</font><font color="#E5E5E5"> scanner simulator</font>

922
00:39:27,400 --> 00:39:31,210
installed on the machine<font color="#CCCCCC"> so it's</font>

923
00:39:29,440 --> 00:39:33,160
probably<font color="#CCCCCC"> scatter developers or something</font>

924
00:39:31,210 --> 00:39:36,370
like<font color="#CCCCCC"> that I not</font><font color="#E5E5E5"> have</font><font color="#CCCCCC"> scattered spirit on</font>

925
00:39:33,160 --> 00:39:41,220
<font color="#E5E5E5">my laptop something else</font><font color="#CCCCCC"> if you look at</font>

926
00:39:36,370 --> 00:39:44,290
my boobs so protocol<font color="#E5E5E5"> use on SCADA system</font>

927
00:39:41,220 --> 00:39:46,810
209 machine so<font color="#E5E5E5"> this people have the</font>

928
00:39:44,290 --> 00:39:48,480
Medusa port on their laptop<font color="#E5E5E5"> so they are</font>

929
00:39:46,810 --> 00:39:50,750
playing<font color="#E5E5E5"> with Mabuse protocol for</font>

930
00:39:48,480 --> 00:39:53,400
whatever<font color="#CCCCCC"> reason so developers</font>

931
00:39:50,750 --> 00:39:56,490
<font color="#E5E5E5">potentially developers and this one is</font>

932
00:39:53,400 --> 00:39:59,400
is the worst one<font color="#E5E5E5"> PC monitor</font><font color="#CCCCCC"> so in this</font>

933
00:39:56,490 --> 00:40:01,859
case we<font color="#CCCCCC"> are not</font><font color="#E5E5E5"> on on developers mod we</font>

934
00:39:59,400 --> 00:40:04,020
are on monitor mode<font color="#E5E5E5"> so this one are</font>

935
00:40:01,859 --> 00:40:06,600
probably<font color="#CCCCCC"> very connected to SCADA system</font>

936
00:40:04,020 --> 00:40:09,859
and they<font color="#E5E5E5"> are currently monitoring the</font>

937
00:40:06,600 --> 00:40:13,109
system so and in this<font color="#E5E5E5"> case it's only</font>

938
00:40:09,859 --> 00:40:15,330
<font color="#CCCCCC">nine machine so if you look at</font><font color="#E5E5E5"> the</font>

939
00:40:13,109 --> 00:40:18,029
instant implication it's<font color="#CCCCCC"> little bit</font>

940
00:40:15,330 --> 00:40:20,100
<font color="#E5E5E5">scary because you have some potentially</font>

941
00:40:18,030 --> 00:40:21,720
a<font color="#CCCCCC"> very</font><font color="#E5E5E5"> sensitive machine and if you</font>

942
00:40:20,100 --> 00:40:24,000
cross information with a domain<font color="#CCCCCC"> name</font><font color="#E5E5E5"> you</font>

943
00:40:21,720 --> 00:40:29,189
can guess what kind<font color="#E5E5E5"> of machine it is and</font>

944
00:40:24,000 --> 00:40:34,109
it's not<font color="#E5E5E5"> good trust me so here's the end</font>

945
00:40:29,190 --> 00:40:37,230
of the<font color="#E5E5E5"> Sakina explanation demonstration</font>

946
00:40:34,109 --> 00:40:39,660
<font color="#E5E5E5">and we provide</font><font color="#CCCCCC"> you two different case of</font>

947
00:40:37,230 --> 00:40:43,770
<font color="#CCCCCC">suppression</font><font color="#E5E5E5"> attack and how</font><font color="#CCCCCC"> its efficient</font>

948
00:40:39,660 --> 00:40:47,640
<font color="#E5E5E5">if you take</font><font color="#CCCCCC"> warrant case it basically</font>

949
00:40:43,770 --> 00:40:49,680
put a country<font color="#CCCCCC"> down</font><font color="#E5E5E5"> so it's efficient in</font>

950
00:40:47,640 --> 00:40:53,700
this case the purpose<font color="#E5E5E5"> was to be massive</font>

951
00:40:49,680 --> 00:40:56,040
<font color="#E5E5E5">make a big at a specific time</font><font color="#CCCCCC"> in my</font>

952
00:40:53,700 --> 00:40:57,689
case<font color="#E5E5E5"> it's completely</font><font color="#CCCCCC"> different the</font>

953
00:40:56,040 --> 00:41:00,420
purpose<font color="#CCCCCC"> was to compromise</font><font color="#E5E5E5"> a maximum</font>

954
00:40:57,690 --> 00:41:03,140
machine to filter to a really<font color="#CCCCCC"> small</font>

955
00:41:00,420 --> 00:41:06,630
asset and compromises small asset to

956
00:41:03,140 --> 00:41:08,670
probably<font color="#CCCCCC"> steal information</font><font color="#E5E5E5"> and it's the</font>

957
00:41:06,630 --> 00:41:12,330
same technique<font color="#CCCCCC"> supply</font><font color="#E5E5E5"> chain attacks but</font>

958
00:41:08,670 --> 00:41:15,180
<font color="#E5E5E5">two different goal and at the end two</font>

959
00:41:12,330 --> 00:41:17,100
different impact<font color="#E5E5E5"> so difficulties</font><font color="#CCCCCC"> I don't</font>

960
00:41:15,180 --> 00:41:20,430
know if<font color="#CCCCCC"> people analyze malware</font><font color="#E5E5E5"> in the</font>

961
00:41:17,100 --> 00:41:22,470
room<font color="#E5E5E5"> but it's very hard on supply chain</font>

962
00:41:20,430 --> 00:41:25,440
in this context<font color="#CCCCCC"> because it's</font><font color="#E5E5E5"> legitimate</font>

963
00:41:22,470 --> 00:41:27,029
binary and you never you don't have time

964
00:41:25,440 --> 00:41:28,950
<font color="#E5E5E5">to analyze malware so you don't have</font>

965
00:41:27,030 --> 00:41:30,930
time<font color="#E5E5E5"> to analyze all legitimate binary</font>

966
00:41:28,950 --> 00:41:34,020
<font color="#E5E5E5">when you pay a provider generally you</font>

967
00:41:30,930 --> 00:41:36,118
trust him and<font color="#E5E5E5"> you</font><font color="#CCCCCC"> pay</font><font color="#E5E5E5"> for that and it's</font>

968
00:41:34,020 --> 00:41:39,600
generally huge binary if you look at

969
00:41:36,119 --> 00:41:42,570
Sakina<font color="#CCCCCC"> I think binary is three megabytes</font>

970
00:41:39,600 --> 00:41:45,600
<font color="#E5E5E5">so you cannot reverse free</font><font color="#CCCCCC"> megabytes</font><font color="#E5E5E5"> on</font>

971
00:41:42,570 --> 00:41:48,780
<font color="#CCCCCC">static analysis oh I cannot maybe you</font>

972
00:41:45,600 --> 00:41:51,118
can<font color="#CCCCCC"> that's a long</font><font color="#E5E5E5"> time</font><font color="#CCCCCC"> it's very</font><font color="#E5E5E5"> time</font>

973
00:41:48,780 --> 00:41:54,000
<font color="#E5E5E5">consuming and basically you don't do</font>

974
00:41:51,119 --> 00:41:57,390
that<font color="#CCCCCC"> and nobody do that and this</font><font color="#E5E5E5"> kind of</font>

975
00:41:54,000 --> 00:42:00,150
<font color="#E5E5E5">of campaign can stay under the radar</font><font color="#CCCCCC"> in</font>

976
00:41:57,390 --> 00:42:01,848
years<font color="#CCCCCC"> because you don't check for</font>

977
00:42:00,150 --> 00:42:05,430
legitimate binary

978
00:42:01,849 --> 00:42:08,400
something to<font color="#E5E5E5"> add no no particularly and</font>

979
00:42:05,430 --> 00:42:10,379
just as Paul said supply<font color="#CCCCCC"> T</font><font color="#E5E5E5"> and attacks</font>

980
00:42:08,400 --> 00:42:12,660
are in vogue as I<font color="#E5E5E5"> imagined at</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> start</font>

981
00:42:10,380 --> 00:42:14,460
if you use<font color="#CCCCCC"> software</font><font color="#E5E5E5"> that you get from a</font>

982
00:42:12,660 --> 00:42:15,118
third party<font color="#CCCCCC"> even</font><font color="#E5E5E5"> if you download it from</font>

983
00:42:14,460 --> 00:42:16,920
the internet

984
00:42:15,119 --> 00:42:18,660
just be<font color="#E5E5E5"> careful what you're getting and</font>

985
00:42:16,920 --> 00:42:21,480
<font color="#CCCCCC">why you're</font><font color="#E5E5E5"> getting it from because this</font>

986
00:42:18,660 --> 00:42:23,940
shows how massive legitimate dilutes

987
00:42:21,480 --> 00:42:27,089
<font color="#CCCCCC">turn into a</font><font color="#E5E5E5"> complete</font><font color="#CCCCCC"> disaster</font>

988
00:42:23,940 --> 00:42:29,280
when<font color="#CCCCCC"> ccleaner</font><font color="#E5E5E5"> was in our opinion clearly</font>

989
00:42:27,089 --> 00:42:31,410
<font color="#E5E5E5">used</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> target from a cyber espionage</font>

990
00:42:29,280 --> 00:42:32,910
point of view and just<font color="#CCCCCC"> the point though</font>

991
00:42:31,410 --> 00:42:35,129
<font color="#CCCCCC">it Cisco were on the list</font>

992
00:42:32,910 --> 00:42:36,839
we had no<font color="#E5E5E5"> compromised machines the</font>

993
00:42:35,130 --> 00:42:39,030
machine that<font color="#E5E5E5"> we had on</font><font color="#CCCCCC"> that list was</font><font color="#E5E5E5"> our</font>

994
00:42:36,839 --> 00:42:40,650
<font color="#E5E5E5">sandbox</font><font color="#CCCCCC"> and I don't</font><font color="#E5E5E5"> know if anyone's</font>

995
00:42:39,030 --> 00:42:42,480
familiar with virus tool<font color="#CCCCCC"> they were</font><font color="#E5E5E5"> also</font>

996
00:42:40,650 --> 00:42:44,369
<font color="#CCCCCC">on it as well</font><font color="#E5E5E5"> so tequila boom-boom</font>

997
00:42:42,480 --> 00:42:46,079
tequila boom-boom for example was in

998
00:42:44,369 --> 00:42:48,329
there<font color="#E5E5E5"> too but I just want</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> let you</font>

999
00:42:46,079 --> 00:42:51,569
<font color="#E5E5E5">know we we didn't get compromised just</font>

1000
00:42:48,329 --> 00:42:53,640
that point<font color="#CCCCCC"> that I'd so yes we</font><font color="#E5E5E5"> feel it</font>

1001
00:42:51,569 --> 00:42:55,349
disturbance in the supply chain<font color="#CCCCCC"> be</font>

1002
00:42:53,640 --> 00:42:57,410
careful who you're getting<font color="#E5E5E5"> things from I</font>

1003
00:42:55,349 --> 00:42:59,490
say things to<font color="#CCCCCC"> BV because it could</font><font color="#E5E5E5"> be</font>

1004
00:42:57,410 --> 00:43:01,680
<font color="#CCCCCC">ccleaner software that your parents</font><font color="#E5E5E5"> are</font>

1005
00:42:59,490 --> 00:43:03,180
using<font color="#E5E5E5"> or it could be legitimate</font>

1006
00:43:01,680 --> 00:43:05,250
accounting so for that<font color="#E5E5E5"> you're using</font>

1007
00:43:03,180 --> 00:43:08,629
across major corporations<font color="#E5E5E5"> throughout the</font>

1008
00:43:05,250 --> 00:43:14,079
world<font color="#E5E5E5"> so be careful and thank you</font>

1009
00:43:08,630 --> 00:43:14,079
[Applause]

