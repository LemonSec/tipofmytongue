1
00:00:09,219 --> 00:00:13,879
so I realize getting<font color="#E5E5E5"> towards</font><font color="#CCCCCC"> the end of</font>

2
00:00:11,809 --> 00:00:16,610
the day and I said<font color="#E5E5E5"> let's try and push it</font>

3
00:00:13,879 --> 00:00:19,570
through<font color="#CCCCCC"> so appreciate everyone is still</font>

4
00:00:16,610 --> 00:00:22,698
here<font color="#E5E5E5"> so disrupting the kill chain</font>

5
00:00:19,570 --> 00:00:26,539
<font color="#CCCCCC">started talking about</font><font color="#E5E5E5"> kill chain and and</font>

6
00:00:22,699 --> 00:00:28,279
<font color="#CCCCCC">windows defense</font><font color="#E5E5E5"> earlier this year</font><font color="#CCCCCC"> so the</font>

7
00:00:26,539 --> 00:00:30,650
talk that<font color="#E5E5E5"> you see today is based off</font>

8
00:00:28,279 --> 00:00:33,160
another talk that I did<font color="#CCCCCC"> at troopers and</font>

9
00:00:30,650 --> 00:00:35,780
at confidence

10
00:00:33,160 --> 00:00:37,760
well spoke about the defense's that

11
00:00:35,780 --> 00:00:40,879
<font color="#E5E5E5">Windows</font><font color="#CCCCCC"> 10 offers natively out of the</font>

12
00:00:37,760 --> 00:00:42,739
box<font color="#CCCCCC"> right</font><font color="#E5E5E5"> so said</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> what was my</font>

13
00:00:40,879 --> 00:00:44,780
problem statement I said<font color="#E5E5E5"> let's start</font>

14
00:00:42,739 --> 00:00:46,430
looking<font color="#E5E5E5"> at what Windows 10 in the</font>

15
00:00:44,780 --> 00:00:48,680
evolution of Windows 10<font color="#E5E5E5"> has brought to</font>

16
00:00:46,430 --> 00:00:49,940
the<font color="#CCCCCC"> table and what Microsoft has brought</font>

17
00:00:48,680 --> 00:00:52,760
to the table in<font color="#CCCCCC"> terms</font><font color="#E5E5E5"> of its security</font>

18
00:00:49,940 --> 00:00:56,599
offerings<font color="#E5E5E5"> so if you heard</font><font color="#CCCCCC"> Haroon maids</font>

19
00:00:52,760 --> 00:00:58,489
<font color="#CCCCCC">talk this</font><font color="#E5E5E5"> morning he</font><font color="#CCCCCC"> said off after CMS</font>

20
00:00:56,600 --> 00:01:01,100
<font color="#CCCCCC">one of the worst software's that</font><font color="#E5E5E5"> exists</font>

21
00:00:58,489 --> 00:01:03,709
out there is security<font color="#CCCCCC"> software right</font><font color="#E5E5E5"> and</font>

22
00:01:01,100 --> 00:01:06,260
it's not<font color="#E5E5E5"> wrong that you start to realize</font>

23
00:01:03,710 --> 00:01:08,780
once you start solving point solutions

24
00:01:06,260 --> 00:01:10,700
for point<font color="#E5E5E5"> problems you ended up with a</font>

25
00:01:08,780 --> 00:01:12,380
bloated<font color="#CCCCCC"> endpoint space right so if you</font>

26
00:01:10,700 --> 00:01:13,970
look<font color="#CCCCCC"> at any</font><font color="#E5E5E5"> of your endpoint spaces</font>

27
00:01:12,380 --> 00:01:15,830
<font color="#CCCCCC">today what I mean by endpoint spaces you</font>

28
00:01:13,970 --> 00:01:17,780
have<font color="#CCCCCC"> a Windows 10 you have a Windows 7</font>

29
00:01:15,830 --> 00:01:19,490
<font color="#CCCCCC">machine in your</font><font color="#E5E5E5"> network it's running</font>

30
00:01:17,780 --> 00:01:21,260
some sort<font color="#E5E5E5"> of a logging agent it's</font>

31
00:01:19,490 --> 00:01:23,030
running some sort<font color="#E5E5E5"> of an</font><font color="#CCCCCC"> anti-virus agent</font>

32
00:01:21,260 --> 00:01:25,640
<font color="#E5E5E5">if you're into forensics you're running</font>

33
00:01:23,030 --> 00:01:28,460
EDR of some sort<font color="#E5E5E5"> and to</font><font color="#CCCCCC"> top it</font><font color="#E5E5E5"> all off</font>

34
00:01:25,640 --> 00:01:30,770
your IT folks are<font color="#E5E5E5"> running some sort of a</font>

35
00:01:28,460 --> 00:01:32,390
telemetry<font color="#E5E5E5"> agent which</font><font color="#CCCCCC"> is like SCCM to</font>

36
00:01:30,770 --> 00:01:34,759
push patches and configure management

37
00:01:32,390 --> 00:01:37,130
right and so you<font color="#E5E5E5"> end up with</font><font color="#CCCCCC"> a bloated</font>

38
00:01:34,760 --> 00:01:39,680
<font color="#E5E5E5">endpoint space why is that relevant to</font>

39
00:01:37,130 --> 00:01:42,110
us from security a bloated endpoint

40
00:01:39,680 --> 00:01:43,850
space means that your attack surface is

41
00:01:42,110 --> 00:01:45,620
increasingly larger than what it was

42
00:01:43,850 --> 00:01:48,470
right so<font color="#E5E5E5"> Windows ships out</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the box</font>

43
00:01:45,620 --> 00:01:49,880
you<font color="#CCCCCC"> have a feature set</font><font color="#E5E5E5"> and then you go</font>

44
00:01:48,470 --> 00:01:52,429
and<font color="#E5E5E5"> install more stuff on it and that</font>

45
00:01:49,880 --> 00:01:54,679
<font color="#E5E5E5">feature set expands right so that's</font>

46
00:01:52,430 --> 00:01:56,060
that's why it's relevant<font color="#E5E5E5"> so so that's</font>

47
00:01:54,680 --> 00:01:58,130
where the talk is coming from so when

48
00:01:56,060 --> 00:02:00,560
you<font color="#E5E5E5"> listen to it try and refer back and</font>

49
00:01:58,130 --> 00:02:03,259
try<font color="#CCCCCC"> and map back to why we</font><font color="#E5E5E5"> decided to do</font>

50
00:02:00,560 --> 00:02:05,270
this<font color="#E5E5E5"> right so</font><font color="#CCCCCC"> that's</font><font color="#E5E5E5"> that we will start</font>

51
00:02:03,260 --> 00:02:07,280
by talking a little<font color="#CCCCCC"> bit about the mitre</font>

52
00:02:05,270 --> 00:02:09,799
<font color="#E5E5E5">attack framework and the</font><font color="#CCCCCC"> lockheed-martin</font>

53
00:02:07,280 --> 00:02:12,140
<font color="#CCCCCC">kill chain</font><font color="#E5E5E5"> why is this relevant to us</font>

54
00:02:09,800 --> 00:02:14,209
<font color="#E5E5E5">because I'm a defender</font><font color="#CCCCCC"> right that's what</font>

55
00:02:12,140 --> 00:02:15,768
I do<font color="#E5E5E5"> on a 24 by 7 basis that's my day</font>

56
00:02:14,209 --> 00:02:19,489
job<font color="#CCCCCC"> that's my night</font>

57
00:02:15,769 --> 00:02:22,519
and a defender is trying to find<font color="#E5E5E5"> the</font>

58
00:02:19,489 --> 00:02:25,040
<font color="#E5E5E5">best way to make a manageable repeatable</font>

59
00:02:22,519 --> 00:02:27,469
model for defense right so attackers

60
00:02:25,040 --> 00:02:29,269
have attacker methodologies your pen

61
00:02:27,469 --> 00:02:31,790
testers have been<font color="#E5E5E5"> tested methodologies</font>

62
00:02:29,269 --> 00:02:33,889
<font color="#E5E5E5">what</font><font color="#CCCCCC"> two defenders hi</font><font color="#E5E5E5"> right so defenders</font>

63
00:02:31,790 --> 00:02:36,170
are essentially<font color="#E5E5E5"> looking at ways where</font>

64
00:02:33,889 --> 00:02:38,420
<font color="#CCCCCC">they can</font><font color="#E5E5E5"> repeat the</font><font color="#CCCCCC"> sequence of defense</font>

65
00:02:36,170 --> 00:02:40,458
mechanisms that they can deploy<font color="#CCCCCC"> right</font><font color="#E5E5E5"> so</font>

66
00:02:38,420 --> 00:02:43,578
we look<font color="#E5E5E5"> at attack and then we talk about</font>

67
00:02:40,459 --> 00:02:46,459
<font color="#E5E5E5">the kill chain Windows 10 I spoke to you</font>

68
00:02:43,579 --> 00:02:49,340
about already<font color="#E5E5E5"> and then at the</font><font color="#CCCCCC"> end of the</font>

69
00:02:46,459 --> 00:02:51,319
talk<font color="#E5E5E5"> right we start to talk</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> what</font>

70
00:02:49,340 --> 00:02:53,840
is our end objective<font color="#E5E5E5"> right we're trying</font>

71
00:02:51,319 --> 00:02:56,268
to slow the attacker down<font color="#E5E5E5"> and why is it</font>

72
00:02:53,840 --> 00:02:59,199
important to<font color="#CCCCCC"> us</font><font color="#E5E5E5"> it is because we want</font><font color="#CCCCCC"> to</font>

73
00:02:56,269 --> 00:03:02,930
<font color="#E5E5E5">become an increasingly difficult target</font>

74
00:02:59,199 --> 00:03:05,150
it weighs<font color="#E5E5E5"> in right because</font><font color="#CCCCCC"> imagine</font><font color="#E5E5E5"> the</font>

75
00:03:02,930 --> 00:03:07,310
value<font color="#CCCCCC"> of the information you hold is</font>

76
00:03:05,150 --> 00:03:09,980
significant enough<font color="#CCCCCC"> that the attacker</font>

77
00:03:07,310 --> 00:03:13,159
might deploy<font color="#E5E5E5"> a nation-state adversary or</font>

78
00:03:09,980 --> 00:03:15,530
somebody to come after you but if the

79
00:03:13,159 --> 00:03:18,739
margin<font color="#E5E5E5"> to cross and enter your network</font>

80
00:03:15,530 --> 00:03:20,540
<font color="#E5E5E5">starts to rise the attacker starts to</font>

81
00:03:18,739 --> 00:03:22,340
realize that their<font color="#E5E5E5"> infiltration is</font>

82
00:03:20,540 --> 00:03:23,540
becoming<font color="#E5E5E5"> more expensive</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> right so we</font>

83
00:03:22,340 --> 00:03:27,549
<font color="#E5E5E5">will talk about why these things are</font>

84
00:03:23,540 --> 00:03:31,728
important so a<font color="#E5E5E5"> little bit about myself</font>

85
00:03:27,549 --> 00:03:36,680
<font color="#CCCCCC">I've I've been doing security now for</font>

86
00:03:31,729 --> 00:03:38,959
<font color="#E5E5E5">about 18 years</font><font color="#CCCCCC"> very young I started off</font>

87
00:03:36,680 --> 00:03:40,579
early<font color="#E5E5E5"> and I've been in security for a</font>

88
00:03:38,959 --> 00:03:43,280
long time right<font color="#CCCCCC"> so I did very little</font>

89
00:03:40,579 --> 00:03:45,500
above of<font color="#E5E5E5"> IT I started off in networks a</font>

90
00:03:43,280 --> 00:03:47,780
little<font color="#CCCCCC"> bit of programming</font><font color="#E5E5E5"> and then jump</font>

91
00:03:45,500 --> 00:03:52,970
straight into security back in the<font color="#CCCCCC"> ceh</font>

92
00:03:47,780 --> 00:03:55,459
days yeah<font color="#CCCCCC"> in terms</font><font color="#E5E5E5"> of verticals I've</font>

93
00:03:52,970 --> 00:03:58,579
done<font color="#CCCCCC"> pharma</font><font color="#E5E5E5"> I've done retail and most</font>

94
00:03:55,459 --> 00:04:00,530
recently I do<font color="#E5E5E5"> aviation now so look out</font>

95
00:03:58,579 --> 00:04:02,419
<font color="#CCCCCC">for a few interesting things coming out</font>

96
00:04:00,530 --> 00:04:05,800
<font color="#E5E5E5">of the pipeline in terms of avionics</font><font color="#CCCCCC"> and</font>

97
00:04:02,419 --> 00:04:09,340
<font color="#E5E5E5">ify</font><font color="#CCCCCC"> in my talks next</font><font color="#E5E5E5"> year</font>

98
00:04:05,800 --> 00:04:12,670
so what is in the stock how do

99
00:04:09,340 --> 00:04:15,280
<font color="#E5E5E5">adversaries behave right so my day job</font>

100
00:04:12,670 --> 00:04:16,870
<font color="#CCCCCC">is defense</font><font color="#E5E5E5"> primarily I look at how</font>

101
00:04:15,280 --> 00:04:18,399
<font color="#E5E5E5">adversities behave on the network how</font>

102
00:04:16,870 --> 00:04:19,959
red teamers behave on<font color="#CCCCCC"> the network</font>

103
00:04:18,399 --> 00:04:22,000
you heard<font color="#CCCCCC"> nikhil</font><font color="#E5E5E5"> methyls talk a little</font>

104
00:04:19,959 --> 00:04:24,130
bit<font color="#CCCCCC"> before this he spoke about</font><font color="#E5E5E5"> what is</font>

105
00:04:22,000 --> 00:04:27,850
he doing as a blue<font color="#E5E5E5"> Timur a newly-built</font>

106
00:04:24,130 --> 00:04:29,620
<font color="#E5E5E5">blue Timur</font><font color="#CCCCCC"> so I'll talk more</font><font color="#E5E5E5"> from my</font>

107
00:04:27,850 --> 00:04:32,050
experience of<font color="#E5E5E5"> what I've seen red teamers</font>

108
00:04:29,620 --> 00:04:36,040
do on the<font color="#E5E5E5"> networks what attackers do and</font>

109
00:04:32,050 --> 00:04:37,810
then some<font color="#CCCCCC"> of the nation-states right the</font>

110
00:04:36,040 --> 00:04:39,970
next<font color="#E5E5E5"> item is really how do you make</font>

111
00:04:37,810 --> 00:04:42,520
their inclusion<font color="#CCCCCC"> cost prohibitive and</font>

112
00:04:39,970 --> 00:04:44,470
this is the<font color="#CCCCCC"> value of</font><font color="#E5E5E5"> the information</font>

113
00:04:42,520 --> 00:04:48,070
<font color="#CCCCCC">that Haroon spoke about</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> morning</font>

114
00:04:44,470 --> 00:04:49,690
right says if the cost and and I<font color="#E5E5E5"> could</font>

115
00:04:48,070 --> 00:04:51,969
knows the cost<font color="#E5E5E5"> of the infiltration right</font>

116
00:04:49,690 --> 00:04:54,130
by all<font color="#E5E5E5"> means they always are holding</font>

117
00:04:51,970 --> 00:04:56,320
back the OTAs for a much more competent

118
00:04:54,130 --> 00:04:58,659
adversary they're also trying<font color="#E5E5E5"> to</font>

119
00:04:56,320 --> 00:05:00,940
determine what is the lowest threshold

120
00:04:58,660 --> 00:05:02,800
to cross in an attempt to<font color="#E5E5E5"> get into your</font>

121
00:05:00,940 --> 00:05:06,550
<font color="#E5E5E5">network</font><font color="#CCCCCC"> so what is the cost</font><font color="#E5E5E5"> to an</font>

122
00:05:02,800 --> 00:05:08,620
adversary how do we monitor<font color="#E5E5E5"> insecure of</font>

123
00:05:06,550 --> 00:05:11,020
<font color="#E5E5E5">in</font><font color="#CCCCCC"> derstand environment here it's a</font>

124
00:05:08,620 --> 00:05:12,730
native capability<font color="#CCCCCC"> out-of-the-box</font><font color="#E5E5E5"> not</font>

125
00:05:11,020 --> 00:05:18,039
doing anything<font color="#E5E5E5"> fancy not installing any</font>

126
00:05:12,730 --> 00:05:19,180
<font color="#E5E5E5">bloated endpoints nothing and finally</font>

127
00:05:18,040 --> 00:05:21,640
how do you<font color="#E5E5E5"> recover from an intrusion</font>

128
00:05:19,180 --> 00:05:22,990
<font color="#CCCCCC">right let's</font><font color="#E5E5E5"> say for a second you've gone</font>

129
00:05:21,640 --> 00:05:25,840
through the pain<font color="#E5E5E5"> of going and</font>

130
00:05:22,990 --> 00:05:26,980
configuring a fully<font color="#CCCCCC"> secure Windows 10</font>

131
00:05:25,840 --> 00:05:28,989
environment to the best of your

132
00:05:26,980 --> 00:05:31,780
abilities<font color="#E5E5E5"> if it does get compromised</font>

133
00:05:28,990 --> 00:05:33,490
what are you doing<font color="#CCCCCC"> here what</font><font color="#E5E5E5"> the stock</font>

134
00:05:31,780 --> 00:05:36,700
is not<font color="#E5E5E5"> about and this is</font><font color="#CCCCCC"> my disclaimer</font>

135
00:05:33,490 --> 00:05:38,110
<font color="#E5E5E5">it is not a silver bullet we are not</font>

136
00:05:36,700 --> 00:05:41,380
going to<font color="#E5E5E5"> solve all the security problems</font>

137
00:05:38,110 --> 00:05:43,600
<font color="#E5E5E5">right it is not going to be an</font>

138
00:05:41,380 --> 00:05:45,520
impediment to<font color="#CCCCCC"> a committed adversary</font><font color="#E5E5E5"> and</font>

139
00:05:43,600 --> 00:05:47,380
what<font color="#E5E5E5"> I mean by</font><font color="#CCCCCC"> that is if</font><font color="#E5E5E5"> you have</font>

140
00:05:45,520 --> 00:05:49,539
information<font color="#CCCCCC"> that is valuable</font><font color="#E5E5E5"> and you</font>

141
00:05:47,380 --> 00:05:51,159
have an adversary<font color="#CCCCCC"> that is committed</font><font color="#E5E5E5"> to</font>

142
00:05:49,540 --> 00:05:53,440
<font color="#E5E5E5">getting that information there is</font>

143
00:05:51,160 --> 00:05:54,850
nothing you can do to stop them<font color="#E5E5E5"> if</font>

144
00:05:53,440 --> 00:05:57,250
you've<font color="#E5E5E5"> been following the</font><font color="#CCCCCC"> news</font><font color="#E5E5E5"> that came</font>

145
00:05:54,850 --> 00:05:59,380
out<font color="#CCCCCC"> this evening</font><font color="#E5E5E5"> from Bloomberg around</font>

146
00:05:57,250 --> 00:06:02,410
the chip<font color="#E5E5E5"> you will understand what a</font>

147
00:05:59,380 --> 00:06:04,719
committed adversary looks like<font color="#E5E5E5"> and a</font>

148
00:06:02,410 --> 00:06:07,270
<font color="#E5E5E5">defense model really so this defense</font>

149
00:06:04,720 --> 00:06:10,210
model is not ones and<font color="#CCCCCC"> zeros right</font><font color="#E5E5E5"> you</font>

150
00:06:07,270 --> 00:06:12,159
cannot do bits and parts of this<font color="#E5E5E5"> and say</font>

151
00:06:10,210 --> 00:06:14,020
you're done<font color="#E5E5E5"> you either do all of it</font>

152
00:06:12,160 --> 00:06:15,630
or you do none of<font color="#E5E5E5"> it all right you can't</font>

153
00:06:14,020 --> 00:06:19,870
do<font color="#CCCCCC"> in-between</font>

154
00:06:15,630 --> 00:06:23,140
why because we like<font color="#E5E5E5"> to play games right</font>

155
00:06:19,870 --> 00:06:24,970
<font color="#CCCCCC">I would</font><font color="#E5E5E5"> like to see a defender as a</font>

156
00:06:23,140 --> 00:06:26,979
defender<font color="#CCCCCC"> and Packer come in and try and</font>

157
00:06:24,970 --> 00:06:29,320
sweep my network right<font color="#E5E5E5"> what is my</font>

158
00:06:26,980 --> 00:06:31,360
objective<font color="#CCCCCC"> I would like</font><font color="#E5E5E5"> to see them</font>

159
00:06:29,320 --> 00:06:33,840
<font color="#E5E5E5">that's essentially my objective right</font>

160
00:06:31,360 --> 00:06:39,910
I detect<font color="#CCCCCC"> early I respond effectively</font>

161
00:06:33,840 --> 00:06:41,950
<font color="#E5E5E5">that's the end goal right so adversity</font>

162
00:06:39,910 --> 00:06:44,920
behavior<font color="#E5E5E5"> kill chain right why is this</font>

163
00:06:41,950 --> 00:06:46,659
relevant<font color="#CCCCCC"> so before the lockheed-martin</font>

164
00:06:44,920 --> 00:06:47,980
<font color="#E5E5E5">kill chain and everyone is aware</font><font color="#CCCCCC"> of why</font>

165
00:06:46,660 --> 00:06:50,110
<font color="#CCCCCC">lockheed designed the kill chain right</font>

166
00:06:47,980 --> 00:06:51,550
<font color="#E5E5E5">it was back in 2001 there was an</font>

167
00:06:50,110 --> 00:06:52,300
intrusion they decided to do something

168
00:06:51,550 --> 00:06:54,400
<font color="#CCCCCC">about</font><font color="#E5E5E5"> it</font>

169
00:06:52,300 --> 00:06:57,010
they wanted<font color="#E5E5E5"> a scientific</font><font color="#CCCCCC"> approach to</font>

170
00:06:54,400 --> 00:06:58,659
<font color="#E5E5E5">mapping out adversary behavior and that</font>

171
00:06:57,010 --> 00:07:00,730
<font color="#CCCCCC">what the kill chain</font><font color="#E5E5E5"> right and that was</font>

172
00:06:58,660 --> 00:07:02,890
<font color="#CCCCCC">the</font><font color="#E5E5E5"> repeatable sequence of trying to say</font>

173
00:07:00,730 --> 00:07:05,320
this is what an adversary will do from

174
00:07:02,890 --> 00:07:07,320
the<font color="#CCCCCC"> moment they step in to</font><font color="#E5E5E5"> the moment</font>

175
00:07:05,320 --> 00:07:10,950
they have compromised<font color="#E5E5E5"> your network yeah</font>

176
00:07:07,320 --> 00:07:10,950
that was a<font color="#CCCCCC"> few chain</font>

177
00:07:17,319 --> 00:07:23,800
<font color="#E5E5E5">okay what's the</font><font color="#CCCCCC"> next one pre attack</font>

178
00:07:21,099 --> 00:07:26,558
<font color="#E5E5E5">right so the</font><font color="#CCCCCC"> minor attack framework if</font>

179
00:07:23,800 --> 00:07:28,449
you not<font color="#E5E5E5"> already seen it is is done by a</font>

180
00:07:26,559 --> 00:07:31,270
research body out<font color="#CCCCCC"> of Boston they called</font>

181
00:07:28,449 --> 00:07:32,919
<font color="#E5E5E5">mitre and they named it their framework</font>

182
00:07:31,270 --> 00:07:35,049
<font color="#E5E5E5">called attack they also came up with</font>

183
00:07:32,919 --> 00:07:36,698
something called pre attack pre attack

184
00:07:35,050 --> 00:07:39,909
is essentially the sequence of steps

185
00:07:36,699 --> 00:07:41,319
that<font color="#E5E5E5"> are taken before an adversary</font>

186
00:07:39,909 --> 00:07:43,300
decides to infiltrate<font color="#E5E5E5"> your network</font>

187
00:07:41,319 --> 00:07:46,089
correct<font color="#CCCCCC"> and what do those sequence of</font>

188
00:07:43,300 --> 00:07:47,860
events look like right so<font color="#E5E5E5"> we're trying</font>

189
00:07:46,089 --> 00:07:50,709
to<font color="#CCCCCC"> identify</font><font color="#E5E5E5"> are you being targeted</font>

190
00:07:47,860 --> 00:07:51,339
<font color="#CCCCCC">number one right is</font><font color="#E5E5E5"> an adversary coming</font>

191
00:07:50,709 --> 00:07:54,729
after you

192
00:07:51,339 --> 00:07:57,069
so what are those signs<font color="#E5E5E5"> what commonly</font>

193
00:07:54,729 --> 00:07:58,628
<font color="#E5E5E5">used techniques will the adversary use</font>

194
00:07:57,069 --> 00:08:02,559
against you<font color="#E5E5E5"> if they do decide to come</font>

195
00:07:58,629 --> 00:08:04,119
<font color="#E5E5E5">after you</font><font color="#CCCCCC"> right and what you should</font><font color="#E5E5E5"> be</font>

196
00:08:02,559 --> 00:08:06,580
doing<font color="#CCCCCC"> in terms of</font><font color="#E5E5E5"> your threat</font>

197
00:08:04,119 --> 00:08:08,499
intelligence to try and identify that<font color="#E5E5E5"> an</font>

198
00:08:06,580 --> 00:08:11,229
adversary has now started targeting you

199
00:08:08,499 --> 00:08:16,719
<font color="#E5E5E5">here so these are sort of the science</font>

200
00:08:11,229 --> 00:08:20,110
that<font color="#CCCCCC"> you</font><font color="#E5E5E5"> want to look for okay so</font>

201
00:08:16,719 --> 00:08:22,779
there's<font color="#CCCCCC"> 15 tactics and 151</font><font color="#E5E5E5"> techniques</font>

202
00:08:20,110 --> 00:08:24,009
they go<font color="#E5E5E5"> into significant detail</font><font color="#CCCCCC"> I'm not</font>

203
00:08:22,779 --> 00:08:26,469
going<font color="#E5E5E5"> to go through</font><font color="#CCCCCC"> all of them here</font>

204
00:08:24,009 --> 00:08:29,099
<font color="#E5E5E5">there's a link up there please after</font><font color="#CCCCCC"> you</font>

205
00:08:26,469 --> 00:08:32,969
find<font color="#E5E5E5"> time come and read it</font><font color="#CCCCCC"> right</font>

206
00:08:29,099 --> 00:08:36,098
what are they<font color="#E5E5E5"> essentially right so so an</font>

207
00:08:32,969 --> 00:08:38,649
adversary has to decide how<font color="#CCCCCC"> they will</font>

208
00:08:36,099 --> 00:08:40,510
deliver<font color="#E5E5E5"> a payload to you all right how</font>

209
00:08:38,649 --> 00:08:42,458
they will infiltrate your network they

210
00:08:40,510 --> 00:08:44,980
will try<font color="#CCCCCC"> to scan your network space and</font>

211
00:08:42,458 --> 00:08:47,469
identify really<font color="#E5E5E5"> is there an exposed</font>

212
00:08:44,980 --> 00:08:49,839
<font color="#CCCCCC">endpoint</font><font color="#E5E5E5"> that I can start to target</font><font color="#CCCCCC"> what</font>

213
00:08:47,470 --> 00:08:51,910
will be my first<font color="#E5E5E5"> vector to enter inside</font>

214
00:08:49,839 --> 00:08:53,620
that<font color="#CCCCCC"> network</font><font color="#E5E5E5"> once I have entered</font><font color="#CCCCCC"> inside</font>

215
00:08:51,910 --> 00:08:56,079
that<font color="#CCCCCC"> network how will I deliver</font><font color="#E5E5E5"> my</font>

216
00:08:53,620 --> 00:08:58,389
payload<font color="#E5E5E5"> once I deliver my payload how</font>

217
00:08:56,079 --> 00:09:00,670
will I execute it<font color="#E5E5E5"> and once I've executed</font>

218
00:08:58,389 --> 00:09:02,829
<font color="#E5E5E5">that payload how will I accelerate that</font>

219
00:09:00,670 --> 00:09:05,290
data right<font color="#E5E5E5"> so they're</font><font color="#CCCCCC"> trying to map out</font>

220
00:09:02,829 --> 00:09:07,689
and find out as an<font color="#E5E5E5"> example do you allow</font>

221
00:09:05,290 --> 00:09:09,010
<font color="#E5E5E5">SMB to the Internet</font><font color="#CCCCCC"> do you allow HTTP</font>

222
00:09:07,689 --> 00:09:11,050
<font color="#E5E5E5">SMB to the Internet</font>

223
00:09:09,010 --> 00:09:14,230
do you allow web<font color="#E5E5E5"> dev as an example do</font>

224
00:09:11,050 --> 00:09:16,050
<font color="#E5E5E5">you allow RPC out do you allow</font><font color="#CCCCCC"> DNS</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> on</font>

225
00:09:14,230 --> 00:09:18,550
and so forth right<font color="#CCCCCC"> and this</font><font color="#E5E5E5"> is all</font>

226
00:09:16,050 --> 00:09:19,760
typical adversary behavior to<font color="#CCCCCC"> try and</font>

227
00:09:18,550 --> 00:09:23,010
see

228
00:09:19,760 --> 00:09:27,529
can they do<font color="#E5E5E5"> to go undetected throughout</font>

229
00:09:23,010 --> 00:09:30,540
your network<font color="#E5E5E5"> so that's</font><font color="#CCCCCC"> pre-attack so</font>

230
00:09:27,529 --> 00:09:32,339
classified again<font color="#E5E5E5"> is</font><font color="#CCCCCC"> just recon</font><font color="#E5E5E5"> how do</font>

231
00:09:30,540 --> 00:09:37,439
<font color="#E5E5E5">they weaponize and how do they deliver</font>

232
00:09:32,339 --> 00:09:38,880
<font color="#E5E5E5">right</font><font color="#CCCCCC"> this is all pre then comes the</font>

233
00:09:37,440 --> 00:09:41,520
<font color="#CCCCCC">actual attack</font><font color="#E5E5E5"> right so attack is</font>

234
00:09:38,880 --> 00:09:43,800
adversarial tactics techniques<font color="#E5E5E5"> and</font>

235
00:09:41,520 --> 00:09:46,529
common knowledge<font color="#CCCCCC"> I really like this</font>

236
00:09:43,800 --> 00:09:49,349
<font color="#CCCCCC">framework</font><font color="#E5E5E5"> because this is sort</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> given</font>

237
00:09:46,529 --> 00:09:51,630
<font color="#CCCCCC">me a</font><font color="#E5E5E5"> framework as you say that is</font>

238
00:09:49,350 --> 00:09:54,300
repeatable<font color="#E5E5E5"> right which means I can now</font>

239
00:09:51,630 --> 00:09:55,860
<font color="#CCCCCC">start to</font><font color="#E5E5E5"> say if an</font><font color="#CCCCCC"> attacker</font><font color="#E5E5E5"> does this</font>

240
00:09:54,300 --> 00:09:58,740
<font color="#E5E5E5">this is what the defense model should</font>

241
00:09:55,860 --> 00:10:00,930
<font color="#E5E5E5">look</font><font color="#CCCCCC"> like alright</font><font color="#E5E5E5"> and these techniques</font>

242
00:09:58,740 --> 00:10:02,610
per se<font color="#E5E5E5"> are consistent in the Windows</font>

243
00:10:00,930 --> 00:10:04,529
environment<font color="#E5E5E5"> so the attack framework is</font>

244
00:10:02,610 --> 00:10:07,170
<font color="#E5E5E5">not just for Windows it's for Linux it's</font>

245
00:10:04,529 --> 00:10:09,360
for<font color="#E5E5E5"> Mac</font><font color="#CCCCCC"> OSX</font><font color="#E5E5E5"> and if you go down the path</font>

246
00:10:07,170 --> 00:10:11,969
of securing<font color="#E5E5E5"> any environment of any size</font>

247
00:10:09,360 --> 00:10:13,830
you want<font color="#CCCCCC"> a mechanism to</font><font color="#E5E5E5"> be able to tell</font>

248
00:10:11,970 --> 00:10:15,899
you<font color="#CCCCCC"> really what does the attack surface</font>

249
00:10:13,830 --> 00:10:17,880
look like right what<font color="#E5E5E5"> techniques exist</font>

250
00:10:15,899 --> 00:10:19,500
<font color="#CCCCCC">for which I need to build</font><font color="#E5E5E5"> a defense</font>

251
00:10:17,880 --> 00:10:21,029
<font color="#E5E5E5">mechanism</font><font color="#CCCCCC"> and that's</font><font color="#E5E5E5"> what this does</font><font color="#CCCCCC"> for</font>

252
00:10:19,500 --> 00:10:22,500
<font color="#E5E5E5">you right so you're looking at initial</font>

253
00:10:21,029 --> 00:10:24,720
access you're looking at execution

254
00:10:22,500 --> 00:10:26,850
persistence privilege escalation

255
00:10:24,720 --> 00:10:28,230
credential access and then<font color="#E5E5E5"> discovery you</font>

256
00:10:26,850 --> 00:10:31,170
want to go through<font color="#E5E5E5"> all of these sequence</font>

257
00:10:28,230 --> 00:10:32,730
to build<font color="#CCCCCC"> defenses against them and</font>

258
00:10:31,170 --> 00:10:35,790
that's the<font color="#E5E5E5"> that's the link you will find</font>

259
00:10:32,730 --> 00:10:42,000
<font color="#CCCCCC">these techniques in detail</font><font color="#E5E5E5"> there as well</font>

260
00:10:35,790 --> 00:10:43,740
<font color="#CCCCCC">okay so what what are we really trying</font>

261
00:10:42,000 --> 00:10:45,510
to do we're trying to summarize attacker

262
00:10:43,740 --> 00:10:49,290
behavior<font color="#E5E5E5"> we want</font><font color="#CCCCCC"> to know when they're</font>

263
00:10:45,510 --> 00:10:50,100
coming you<font color="#E5E5E5"> want to see them when they're</font>

264
00:10:49,290 --> 00:10:52,589
<font color="#CCCCCC">on your</font><font color="#E5E5E5"> network</font>

265
00:10:50,100 --> 00:10:54,450
right<font color="#E5E5E5"> you want to restrict them</font><font color="#CCCCCC"> to</font>

266
00:10:52,589 --> 00:10:57,270
specific<font color="#E5E5E5"> parts</font><font color="#CCCCCC"> of your network and you</font>

267
00:10:54,450 --> 00:10:59,880
want to be able<font color="#CCCCCC"> to control them</font><font color="#E5E5E5"> you want</font>

268
00:10:57,270 --> 00:11:01,709
to make their activities what is<font color="#E5E5E5"> mapping</font>

269
00:10:59,880 --> 00:11:04,740
activities mean you want to start

270
00:11:01,709 --> 00:11:05,760
breaking<font color="#E5E5E5"> it</font><font color="#CCCCCC"> down</font><font color="#E5E5E5"> to see at</font><font color="#CCCCCC"> what part of</font>

271
00:11:04,740 --> 00:11:08,279
the kill<font color="#E5E5E5"> chain are</font><font color="#CCCCCC"> they currently</font>

272
00:11:05,760 --> 00:11:10,410
<font color="#E5E5E5">operating in right if you see an</font>

273
00:11:08,279 --> 00:11:13,829
adversary<font color="#E5E5E5"> who's already progressed to</font>

274
00:11:10,410 --> 00:11:15,480
see<font color="#E5E5E5"> - yes jump to</font><font color="#CCCCCC"> mitigation but if you</font>

275
00:11:13,829 --> 00:11:17,370
see somebody<font color="#CCCCCC"> who's performing recon in</font>

276
00:11:15,480 --> 00:11:18,779
<font color="#E5E5E5">your network don't go around blocking</font>

277
00:11:17,370 --> 00:11:23,950
firewall rules immediately right and

278
00:11:18,779 --> 00:11:25,780
we'll talk a little<font color="#E5E5E5"> bit about why so</font>

279
00:11:23,950 --> 00:11:28,870
<font color="#CCCCCC">a little bit of psychology</font><font color="#E5E5E5"> behind this</font>

280
00:11:25,780 --> 00:11:32,199
right what what is the relevance of

281
00:11:28,870 --> 00:11:33,600
intrusions and attacker costs right so

282
00:11:32,200 --> 00:11:36,190
there was a little<font color="#E5E5E5"> bit of a study done</font>

283
00:11:33,600 --> 00:11:38,920
<font color="#CCCCCC">it is important for</font><font color="#E5E5E5"> us because we want</font>

284
00:11:36,190 --> 00:11:40,870
to we<font color="#CCCCCC"> want</font><font color="#E5E5E5"> to be able to understand and</font>

285
00:11:38,920 --> 00:11:42,819
attribute<font color="#E5E5E5"> what the intent of the</font>

286
00:11:40,870 --> 00:11:45,760
attacker is and how they will react once

287
00:11:42,820 --> 00:11:48,760
they enter our<font color="#E5E5E5"> network right and there</font>

288
00:11:45,760 --> 00:11:51,970
was this there's this paper from 1985

289
00:11:48,760 --> 00:11:53,590
<font color="#E5E5E5">the link is there</font><font color="#CCCCCC"> what it said is</font>

290
00:11:51,970 --> 00:11:55,660
<font color="#CCCCCC">attribution of intent to the attacker</font>

291
00:11:53,590 --> 00:11:57,040
<font color="#CCCCCC">and I'm reading</font><font color="#E5E5E5"> this and by self</font>

292
00:11:55,660 --> 00:12:01,060
presentation<font color="#CCCCCC"> to the attacker and the</font>

293
00:11:57,040 --> 00:12:04,360
experimenter retaliation varies<font color="#E5E5E5"> what</font>

294
00:12:01,060 --> 00:12:06,969
they're<font color="#E5E5E5"> trying to say is let's say a PT</font>

295
00:12:04,360 --> 00:12:09,700
<font color="#E5E5E5">one two three</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> an apt one</font><font color="#CCCCCC"> two three</font>

296
00:12:06,970 --> 00:12:13,090
will react differently<font color="#CCCCCC"> if it enters a</font>

297
00:12:09,700 --> 00:12:16,090
network<font color="#E5E5E5"> belonging to a versus belonging</font>

298
00:12:13,090 --> 00:12:18,130
to<font color="#CCCCCC"> B and why they do that</font><font color="#E5E5E5"> is they're</font>

299
00:12:16,090 --> 00:12:20,710
trying<font color="#E5E5E5"> to find out if</font><font color="#CCCCCC"> they've</font>

300
00:12:18,130 --> 00:12:23,380
benchmarked<font color="#CCCCCC"> network a to be at a certain</font>

301
00:12:20,710 --> 00:12:25,450
<font color="#CCCCCC">security level and network B to be at a</font>

302
00:12:23,380 --> 00:12:26,890
<font color="#CCCCCC">certain security</font><font color="#E5E5E5"> level the same attacker</font>

303
00:12:25,450 --> 00:12:29,110
is going<font color="#CCCCCC"> to behave completely</font>

304
00:12:26,890 --> 00:12:29,920
<font color="#E5E5E5">differently on</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> network that's</font>

305
00:12:29,110 --> 00:12:34,300
important

306
00:12:29,920 --> 00:12:36,160
and so<font color="#E5E5E5"> I this is the abstract</font><font color="#CCCCCC"> but I'll</font>

307
00:12:34,300 --> 00:12:38,380
read the highlighted part out right so

308
00:12:36,160 --> 00:12:41,800
<font color="#CCCCCC">there was there</font><font color="#E5E5E5"> was a study done there's</font>

309
00:12:38,380 --> 00:12:45,520
<font color="#CCCCCC">62</font><font color="#E5E5E5"> Japanese females who were all given</font>

310
00:12:41,800 --> 00:12:48,969
electric shock<font color="#E5E5E5"> okay we go with it</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> a</font>

311
00:12:45,520 --> 00:12:51,670
second<font color="#E5E5E5"> and they were given an</font><font color="#CCCCCC"> electric</font>

312
00:12:48,970 --> 00:12:54,310
shock<font color="#E5E5E5"> after</font><font color="#CCCCCC"> a question was asked to them</font>

313
00:12:51,670 --> 00:12:56,500
and what they<font color="#CCCCCC"> were trying to determine</font>

314
00:12:54,310 --> 00:12:59,829
<font color="#CCCCCC">is how will the</font><font color="#E5E5E5"> person receiving the</font>

315
00:12:56,500 --> 00:13:01,540
shock react differently<font color="#E5E5E5"> if or</font><font color="#CCCCCC"> not they</font>

316
00:12:59,830 --> 00:13:03,400
knew the right answer<font color="#CCCCCC"> right</font><font color="#E5E5E5"> so the</font>

317
00:13:01,540 --> 00:13:05,860
highlighted bit here is the results

318
00:13:03,400 --> 00:13:07,689
indicated<font color="#CCCCCC"> that</font><font color="#E5E5E5"> the subject showed more</font>

319
00:13:05,860 --> 00:13:10,060
intense aggression against an opponent

320
00:13:07,690 --> 00:13:12,670
who already had an aggressive intent

321
00:13:10,060 --> 00:13:14,609
than one who did not<font color="#E5E5E5"> regardless of the</font>

322
00:13:12,670 --> 00:13:16,689
<font color="#E5E5E5">actual</font><font color="#CCCCCC"> level of</font><font color="#E5E5E5"> the shock intensity</font>

323
00:13:14,610 --> 00:13:18,340
right<font color="#E5E5E5"> as a little bit</font><font color="#CCCCCC"> of psychology</font>

324
00:13:16,690 --> 00:13:21,850
<font color="#E5E5E5">behind this and why they're saying this</font>

325
00:13:18,340 --> 00:13:23,380
<font color="#CCCCCC">is if somebody feels threatened</font><font color="#E5E5E5"> on your</font>

326
00:13:21,850 --> 00:13:24,880
network<font color="#CCCCCC"> they're going</font><font color="#E5E5E5"> to react</font>

327
00:13:23,380 --> 00:13:26,020
<font color="#E5E5E5">completely different whether or not</font>

328
00:13:24,880 --> 00:13:28,480
<font color="#E5E5E5">you're</font><font color="#CCCCCC"> actually going to</font><font color="#E5E5E5"> do something</font>

329
00:13:26,020 --> 00:13:30,880
about them yeah<font color="#E5E5E5"> so try and map this out</font>

330
00:13:28,480 --> 00:13:32,360
into<font color="#CCCCCC"> the cyberspace so that's why</font>

331
00:13:30,880 --> 00:13:34,489
attacker intent

332
00:13:32,360 --> 00:13:39,489
and an attackers understanding of the

333
00:13:34,489 --> 00:13:39,489
outcome is important<font color="#E5E5E5"> for us okay</font>

334
00:13:46,910 --> 00:13:55,380
and so if an attacker perceives you as

335
00:13:51,540 --> 00:13:57,360
<font color="#E5E5E5">hostile if an attacker feels that they</font>

336
00:13:55,380 --> 00:13:59,490
have<font color="#E5E5E5"> been detected and they might be</font>

337
00:13:57,360 --> 00:14:02,700
kicked out they will react<font color="#E5E5E5"> completely</font>

338
00:13:59,490 --> 00:14:06,210
differently<font color="#E5E5E5"> so what is our end goal as a</font>

339
00:14:02,700 --> 00:14:07,740
defender my end goal is<font color="#E5E5E5"> to track the</font>

340
00:14:06,210 --> 00:14:10,320
<font color="#E5E5E5">attacker</font><font color="#CCCCCC"> without</font><font color="#E5E5E5"> letting them know that</font>

341
00:14:07,740 --> 00:14:13,170
<font color="#E5E5E5">they have</font><font color="#CCCCCC"> been picked</font><font color="#E5E5E5"> up and without</font>

342
00:14:10,320 --> 00:14:17,340
trying<font color="#E5E5E5"> to jump to remediation and why is</font>

343
00:14:13,170 --> 00:14:19,650
that important<font color="#E5E5E5"> let's say you detected an</font>

344
00:14:17,340 --> 00:14:23,070
attacker<font color="#E5E5E5"> he's still in the Recon face</font>

345
00:14:19,650 --> 00:14:24,870
<font color="#E5E5E5">and you say oh I see an IP</font><font color="#CCCCCC"> address from</font>

346
00:14:23,070 --> 00:14:26,430
China on my<font color="#E5E5E5"> network that's going out to</font>

347
00:14:24,870 --> 00:14:28,130
<font color="#E5E5E5">another IP address in South Africa</font>

348
00:14:26,430 --> 00:14:31,800
<font color="#CCCCCC">blocked the firewalls</font>

349
00:14:28,130 --> 00:14:33,870
even<font color="#CCCCCC"> though fall flat right and most</font>

350
00:14:31,800 --> 00:14:36,839
people<font color="#E5E5E5"> jump to that</font><font color="#CCCCCC"> conclusion because</font>

351
00:14:33,870 --> 00:14:39,330
they're trying<font color="#CCCCCC"> to protect</font><font color="#E5E5E5"> data what's</font>

352
00:14:36,840 --> 00:14:42,150
the problem<font color="#E5E5E5"> with that</font><font color="#CCCCCC"> approach you fail</font>

353
00:14:39,330 --> 00:14:44,790
to do<font color="#CCCCCC"> scoping you've not identified what</font>

354
00:14:42,150 --> 00:14:46,980
the scope of<font color="#E5E5E5"> the</font><font color="#CCCCCC"> incident is you fail to</font>

355
00:14:44,790 --> 00:14:49,500
determine how far<font color="#CCCCCC"> the</font><font color="#E5E5E5"> attacker has</font>

356
00:14:46,980 --> 00:14:51,630
<font color="#CCCCCC">gotten to your</font><font color="#E5E5E5"> network and you also not</font>

357
00:14:49,500 --> 00:14:55,200
try to find<font color="#E5E5E5"> out what the attacker</font>

358
00:14:51,630 --> 00:14:57,180
already has and has not<font color="#E5E5E5"> right what is</font>

359
00:14:55,200 --> 00:14:59,220
<font color="#E5E5E5">even more important is you</font><font color="#CCCCCC"> have not</font>

360
00:14:57,180 --> 00:15:02,069
<font color="#E5E5E5">found out what the intent of the</font>

361
00:14:59,220 --> 00:15:04,500
attacker was right<font color="#E5E5E5"> at the</font><font color="#CCCCCC"> end</font><font color="#E5E5E5"> of the day</font>

362
00:15:02,070 --> 00:15:06,300
when you are protecting information<font color="#CCCCCC"> you</font>

363
00:15:04,500 --> 00:15:07,380
know what your information is worth<font color="#E5E5E5"> you</font>

364
00:15:06,300 --> 00:15:10,020
<font color="#CCCCCC">know where your crown jewels</font><font color="#E5E5E5"> are</font>

365
00:15:07,380 --> 00:15:11,670
hopefully you do<font color="#CCCCCC"> all</font><font color="#E5E5E5"> right and if an</font>

366
00:15:10,020 --> 00:15:14,040
attacker lands<font color="#CCCCCC"> onto your</font><font color="#E5E5E5"> network and</font>

367
00:15:11,670 --> 00:15:16,140
you've not been<font color="#E5E5E5"> able to</font><font color="#CCCCCC"> identify why he</font>

368
00:15:14,040 --> 00:15:18,680
was there or she was there<font color="#E5E5E5"> that's part</font>

369
00:15:16,140 --> 00:15:18,680
of the<font color="#E5E5E5"> problem</font>

370
00:15:21,720 --> 00:15:27,660
okay so let's get serious<font color="#E5E5E5"> right how do</font>

371
00:15:26,140 --> 00:15:30,550
you<font color="#E5E5E5"> make intrusions cost-prohibitive</font>

372
00:15:27,660 --> 00:15:32,560
<font color="#CCCCCC">what is the end goal</font><font color="#E5E5E5"> right you</font>

373
00:15:30,550 --> 00:15:34,390
<font color="#E5E5E5">ring-fence attackers if an attacker</font>

374
00:15:32,560 --> 00:15:35,768
shows up on your<font color="#CCCCCC"> network</font><font color="#E5E5E5"> maybe give them</font>

375
00:15:34,390 --> 00:15:37,990
a<font color="#CCCCCC"> little</font><font color="#E5E5E5"> bit of a honey</font><font color="#CCCCCC"> network to play</font>

376
00:15:35,769 --> 00:15:40,450
around<font color="#E5E5E5"> with you want to be able</font><font color="#CCCCCC"> to track</font>

377
00:15:37,990 --> 00:15:42,250
their activities<font color="#E5E5E5"> you want</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> be able to</font>

378
00:15:40,450 --> 00:15:44,170
<font color="#E5E5E5">detect early</font><font color="#CCCCCC"> that is key</font>

379
00:15:42,250 --> 00:15:46,300
absolutely<font color="#CCCCCC"> if you're not spending</font><font color="#E5E5E5"> money</font>

380
00:15:44,170 --> 00:15:47,800
<font color="#E5E5E5">and time on content engineering that is</font>

381
00:15:46,300 --> 00:15:49,899
the<font color="#E5E5E5"> number one thing you should be</font><font color="#CCCCCC"> doing</font>

382
00:15:47,800 --> 00:15:52,630
<font color="#E5E5E5">if you go and invest a million dollars</font>

383
00:15:49,899 --> 00:15:55,420
in a sock<font color="#CCCCCC"> or you go and buy a nice shiny</font>

384
00:15:52,630 --> 00:15:57,070
<font color="#E5E5E5">seam and you have no one writing use</font>

385
00:15:55,420 --> 00:15:59,529
cases<font color="#E5E5E5"> at a relevant your line of</font>

386
00:15:57,070 --> 00:16:01,660
business<font color="#E5E5E5"> or to your company you're not</font>

387
00:15:59,529 --> 00:16:04,810
making use of that<font color="#E5E5E5"> investment right so</font>

388
00:16:01,660 --> 00:16:07,779
detect early<font color="#CCCCCC"> is absolutely key are you</font>

389
00:16:04,810 --> 00:16:10,689
remediate swiftly<font color="#E5E5E5"> okay you found an</font>

390
00:16:07,779 --> 00:16:11,890
attacker<font color="#E5E5E5"> an alarm goes off somebody's</font>

391
00:16:10,690 --> 00:16:13,290
going to<font color="#E5E5E5"> look at it at 8 o clock in</font><font color="#CCCCCC"> the</font>

392
00:16:11,890 --> 00:16:17,380
morning<font color="#E5E5E5"> tomorrow</font>

393
00:16:13,290 --> 00:16:20,019
you don't remediate after 12<font color="#E5E5E5"> hours you</font>

394
00:16:17,380 --> 00:16:22,660
remediate<font color="#CCCCCC"> 10 you get</font><font color="#E5E5E5"> an alarm</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> go</font>

395
00:16:20,019 --> 00:16:23,860
investigate it<font color="#E5E5E5"> right so if those alarms</font>

396
00:16:22,660 --> 00:16:28,899
are firing<font color="#E5E5E5"> and people are not reading</font>

397
00:16:23,860 --> 00:16:31,270
<font color="#E5E5E5">them you're missing the boat then do a</font>

398
00:16:28,899 --> 00:16:34,240
<font color="#E5E5E5">little bit of triple T's right so</font>

399
00:16:31,270 --> 00:16:36,310
deceive disrupt and<font color="#CCCCCC"> Ettore 8 what do I</font>

400
00:16:34,240 --> 00:16:39,040
mean<font color="#E5E5E5"> by this so Nick leave a nice talk</font>

401
00:16:36,310 --> 00:16:41,529
about honey tokens<font color="#E5E5E5"> in the ad environment</font>

402
00:16:39,040 --> 00:16:43,599
<font color="#E5E5E5">it's not bad</font><font color="#CCCCCC"> to do a little bit</font><font color="#E5E5E5"> of</font>

403
00:16:41,529 --> 00:16:46,209
deception right you want to<font color="#E5E5E5"> be able to</font>

404
00:16:43,600 --> 00:16:48,579
<font color="#E5E5E5">give a sense of achievement to the</font>

405
00:16:46,209 --> 00:16:50,649
attacker<font color="#E5E5E5"> and</font><font color="#CCCCCC"> it should</font><font color="#E5E5E5"> feel</font><font color="#CCCCCC"> or of</font>

406
00:16:48,579 --> 00:16:52,750
compromised<font color="#E5E5E5"> an account</font><font color="#CCCCCC"> oh I have an</font>

407
00:16:50,649 --> 00:16:54,610
account which will allow me<font color="#CCCCCC"> to escalate</font>

408
00:16:52,750 --> 00:16:56,200
a privilege to another level<font color="#CCCCCC"> and</font><font color="#E5E5E5"> that's</font>

409
00:16:54,610 --> 00:16:58,329
important because<font color="#E5E5E5"> you want to be able</font><font color="#CCCCCC"> to</font>

410
00:16:56,200 --> 00:17:00,579
do that you<font color="#E5E5E5"> also want the attacker</font><font color="#CCCCCC"> to</font>

411
00:16:58,329 --> 00:17:02,890
feel that they're on a network<font color="#E5E5E5"> which is</font>

412
00:17:00,579 --> 00:17:04,869
which is<font color="#E5E5E5"> having a few</font><font color="#CCCCCC"> services exposed</font>

413
00:17:02,890 --> 00:17:06,939
<font color="#E5E5E5">right you want the attacker to think oh</font>

414
00:17:04,869 --> 00:17:08,889
there's an SMB endpoint there<font color="#E5E5E5"> huh</font>

415
00:17:06,939 --> 00:17:10,569
there's an<font color="#E5E5E5"> FTP endpoint there oh there's</font>

416
00:17:08,890 --> 00:17:12,250
a few telnet ports open to the Internet

417
00:17:10,569 --> 00:17:14,829
<font color="#E5E5E5">let me go and</font><font color="#CCCCCC"> see what's on them right</font>

418
00:17:12,250 --> 00:17:16,059
so give the attacker enough time to go

419
00:17:14,829 --> 00:17:19,270
<font color="#CCCCCC">into a little bit of playing around</font><font color="#E5E5E5"> on</font>

420
00:17:16,059 --> 00:17:21,309
your network<font color="#CCCCCC"> you also want</font><font color="#E5E5E5"> to be able</font><font color="#CCCCCC"> to</font>

421
00:17:19,270 --> 00:17:24,819
disrupt<font color="#E5E5E5"> them when you want what does</font>

422
00:17:21,309 --> 00:17:26,319
<font color="#CCCCCC">that mean</font><font color="#E5E5E5"> right if you run any kind of</font>

423
00:17:24,819 --> 00:17:28,178
dark net on your<font color="#E5E5E5"> network or</font><font color="#CCCCCC"> tusen takk</font>

424
00:17:26,319 --> 00:17:30,010
<font color="#CCCCCC">net right so you let's say you have an</font>

425
00:17:28,179 --> 00:17:30,820
IP address<font color="#CCCCCC"> space that</font><font color="#E5E5E5"> is a slash 24</font>

426
00:17:30,010 --> 00:17:35,049
<font color="#E5E5E5">Network</font>

427
00:17:30,820 --> 00:17:37,149
you have<font color="#E5E5E5"> 200-300 hosts on your network</font>

428
00:17:35,049 --> 00:17:40,269
<font color="#E5E5E5">right</font><font color="#CCCCCC"> so you create two classes of</font>

429
00:17:37,149 --> 00:17:43,389
<font color="#E5E5E5">subnets create a third class of subnet</font>

430
00:17:40,269 --> 00:17:45,639
<font color="#E5E5E5">and on that subnet place nothing right</font>

431
00:17:43,389 --> 00:17:48,519
<font color="#E5E5E5">you can go and place a few decoy hosts</font>

432
00:17:45,639 --> 00:17:50,649
that's the end of it<font color="#CCCCCC"> right</font><font color="#E5E5E5"> and then sit</font>

433
00:17:48,519 --> 00:17:53,529
<font color="#E5E5E5">and collect</font><font color="#CCCCCC"> NetFlow from all of these</font>

434
00:17:50,649 --> 00:17:55,600
networks<font color="#CCCCCC"> that network should</font><font color="#E5E5E5"> that black</font>

435
00:17:53,529 --> 00:17:59,590
net should<font color="#CCCCCC"> that dark net should never</font>

436
00:17:55,600 --> 00:18:01,840
see any<font color="#CCCCCC"> traffic</font><font color="#E5E5E5"> but if it does you</font><font color="#CCCCCC"> want</font>

437
00:17:59,590 --> 00:18:04,269
to go and investigate<font color="#E5E5E5"> how somebody</font>

438
00:18:01,840 --> 00:18:06,639
laterally moved from one or two<font color="#CCCCCC"> of the</font>

439
00:18:04,269 --> 00:18:11,320
primary subnets<font color="#CCCCCC"> on to</font><font color="#E5E5E5"> the third subnet</font>

440
00:18:06,639 --> 00:18:15,070
<font color="#CCCCCC">and when they do go switch it off see</font>

441
00:18:11,320 --> 00:18:18,279
what happens<font color="#CCCCCC"> you can</font><font color="#E5E5E5"> afford to disrupt a</font>

442
00:18:15,070 --> 00:18:20,110
non-production<font color="#CCCCCC"> dark net more easily than</font>

443
00:18:18,279 --> 00:18:22,419
going<font color="#E5E5E5"> in disrupting a part of your</font>

444
00:18:20,110 --> 00:18:24,820
<font color="#E5E5E5">development network as an</font><font color="#CCCCCC"> example</font><font color="#E5E5E5"> right</font>

445
00:18:22,419 --> 00:18:26,980
so disrupt them and then deteriorate

446
00:18:24,820 --> 00:18:30,279
their service as well so let's say an

447
00:18:26,980 --> 00:18:32,889
attacker is now on<font color="#E5E5E5"> your network he is on</font>

448
00:18:30,279 --> 00:18:34,840
<font color="#E5E5E5">the dark net</font><font color="#CCCCCC"> he's found a few</font><font color="#E5E5E5"> files</font>

449
00:18:32,889 --> 00:18:37,508
<font color="#E5E5E5">which he thinks are of value</font>

450
00:18:34,840 --> 00:18:38,980
now he's tries to exfil them<font color="#CCCCCC"> yeah</font><font color="#E5E5E5"> you're</font>

451
00:18:37,509 --> 00:18:41,559
<font color="#E5E5E5">talking about a hundred two hundred Meg</font>

452
00:18:38,980 --> 00:18:44,500
file<font color="#E5E5E5"> let him try and exfiltrate that</font>

453
00:18:41,559 --> 00:18:46,928
data<font color="#CCCCCC"> give him a way out the moment the</font>

454
00:18:44,500 --> 00:18:49,570
data<font color="#E5E5E5"> starts to leave your network start</font>

455
00:18:46,929 --> 00:18:52,000
to drop a packet or<font color="#E5E5E5"> to corrupt the file</font>

456
00:18:49,570 --> 00:18:54,100
<font color="#CCCCCC">before it reaches the adversary let him</font>

457
00:18:52,000 --> 00:18:56,019
come back and try<font color="#CCCCCC"> again</font><font color="#E5E5E5"> and these are</font>

458
00:18:54,100 --> 00:18:58,360
<font color="#E5E5E5">things you can do today</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> so these</font>

459
00:18:56,019 --> 00:18:59,169
<font color="#CCCCCC">are these</font><font color="#E5E5E5"> are ways you start to make</font><font color="#CCCCCC"> it</font>

460
00:18:58,360 --> 00:19:00,370
more expensive

461
00:18:59,169 --> 00:19:01,899
the attackers<font color="#CCCCCC"> be</font><font color="#E5E5E5"> don't go and sit and</font>

462
00:19:00,370 --> 00:19:07,768
<font color="#E5E5E5">scratch his head and see what's going on</font>

463
00:19:01,899 --> 00:19:10,629
let me<font color="#CCCCCC"> go and try again</font><font color="#E5E5E5"> so Windows 10</font>

464
00:19:07,769 --> 00:19:12,580
Windows has has been evolving

465
00:19:10,629 --> 00:19:14,199
significantly and<font color="#E5E5E5"> I really mean this</font>

466
00:19:12,580 --> 00:19:17,710
because if you<font color="#CCCCCC"> have not seen the Windows</font>

467
00:19:14,200 --> 00:19:20,080
10<font color="#E5E5E5"> security space</font><font color="#CCCCCC"> I highly</font><font color="#E5E5E5"> recommend you</font>

468
00:19:17,710 --> 00:19:23,230
go<font color="#E5E5E5"> and have a look at it right</font><font color="#CCCCCC"> and that</font>

469
00:19:20,080 --> 00:19:24,820
was that was<font color="#E5E5E5"> my kickstart for all of</font>

470
00:19:23,230 --> 00:19:28,840
this<font color="#E5E5E5"> investigation around how to secure</font>

471
00:19:24,820 --> 00:19:31,779
an environment within<font color="#E5E5E5"> Windows so back to</font>

472
00:19:28,840 --> 00:19:33,668
<font color="#E5E5E5">Windows 7</font><font color="#CCCCCC"> I spoke about this</font><font color="#E5E5E5"> earlier</font><font color="#CCCCCC"> you</font>

473
00:19:31,779 --> 00:19:36,789
would have<font color="#CCCCCC"> an AV agent</font><font color="#E5E5E5"> you would have an</font>

474
00:19:33,669 --> 00:19:39,429
EDR agent<font color="#CCCCCC"> you would have a telemetry</font>

475
00:19:36,789 --> 00:19:41,980
agent like a CCM running you would have

476
00:19:39,429 --> 00:19:44,020
a number<font color="#CCCCCC"> of other services which were</font>

477
00:19:41,980 --> 00:19:47,620
trying<font color="#E5E5E5"> to offer you</font><font color="#CCCCCC"> a point solution</font>

478
00:19:44,020 --> 00:19:50,050
my problem right and as we internally

479
00:19:47,620 --> 00:19:53,649
decided to move from windows 7<font color="#CCCCCC"> to</font>

480
00:19:50,050 --> 00:19:56,080
Windows<font color="#CCCCCC"> 10</font><font color="#E5E5E5"> we really said what has</font>

481
00:19:53,650 --> 00:19:58,300
Windows 10<font color="#E5E5E5"> evolved to right</font><font color="#CCCCCC"> I don't want</font>

482
00:19:56,080 --> 00:19:58,840
to go down the<font color="#E5E5E5"> path of installing McAfee</font>

483
00:19:58,300 --> 00:20:00,520
Antivirus

484
00:19:58,840 --> 00:20:02,470
<font color="#CCCCCC">oceans I make</font><font color="#E5E5E5"> a figure I should install</font>

485
00:20:00,520 --> 00:20:05,620
any antivirus<font color="#E5E5E5"> on my Windows 10 machine</font>

486
00:20:02,470 --> 00:20:07,570
if I really don't have<font color="#E5E5E5"> to right and that</font>

487
00:20:05,620 --> 00:20:10,360
started<font color="#CCCCCC"> the process of looking</font><font color="#E5E5E5"> at</font>

488
00:20:07,570 --> 00:20:11,530
<font color="#E5E5E5">windows 10 security natively so that's</font>

489
00:20:10,360 --> 00:20:14,050
what we did

490
00:20:11,530 --> 00:20:16,210
Windows 10 security and and they changed

491
00:20:14,050 --> 00:20:18,669
this very regularly<font color="#E5E5E5"> right so so the last</font>

492
00:20:16,210 --> 00:20:20,530
<font color="#CCCCCC">update is</font><font color="#E5E5E5"> from 17th of September they</font>

493
00:20:18,670 --> 00:20:22,120
had they had about a dozen<font color="#E5E5E5"> different</font>

494
00:20:20,530 --> 00:20:23,830
blocks they brought it down to<font color="#E5E5E5"> three</font>

495
00:20:22,120 --> 00:20:24,250
blocks<font color="#E5E5E5"> I'm going to read a little bit of</font>

496
00:20:23,830 --> 00:20:26,320
this stuff

497
00:20:24,250 --> 00:20:28,120
<font color="#E5E5E5">so there's identity protection which is</font>

498
00:20:26,320 --> 00:20:29,919
<font color="#E5E5E5">essentially credential guard and remote</font>

499
00:20:28,120 --> 00:20:32,500
potential guard there's information

500
00:20:29,920 --> 00:20:34,480
protection<font color="#E5E5E5"> which is BitLocker the DMA</font>

501
00:20:32,500 --> 00:20:36,760
protection the<font color="#CCCCCC"> windows information</font>

502
00:20:34,480 --> 00:20:39,160
protection<font color="#E5E5E5"> the secure boot and there's</font>

503
00:20:36,760 --> 00:20:41,920
the TPM modules<font color="#E5E5E5"> and then there's threat</font>

504
00:20:39,160 --> 00:20:45,160
protection which is WD ATP and WTA<font color="#E5E5E5"> TP</font>

505
00:20:41,920 --> 00:20:48,820
now has<font color="#CCCCCC"> SR</font><font color="#E5E5E5"> the EDR product hunting any</font>

506
00:20:45,160 --> 00:20:50,740
IRS the IRS was the incident<font color="#CCCCCC"> response</font>

507
00:20:48,820 --> 00:20:52,720
and<font color="#E5E5E5"> then smart screen which was</font>

508
00:20:50,740 --> 00:20:56,320
essentially device guard and and the

509
00:20:52,720 --> 00:20:58,890
<font color="#E5E5E5">kernel protection so what are these</font>

510
00:20:56,320 --> 00:20:58,889
<font color="#E5E5E5">things right</font>

511
00:21:04,420 --> 00:21:10,510
it's a credential guard<font color="#CCCCCC"> many cats</font>

512
00:21:07,809 --> 00:21:12,580
everyone knows about<font color="#CCCCCC"> it right</font><font color="#E5E5E5"> you have</font>

513
00:21:10,510 --> 00:21:14,890
<font color="#E5E5E5">secrets in memory you have cached</font>

514
00:21:12,580 --> 00:21:16,600
credentials<font color="#CCCCCC"> you</font><font color="#E5E5E5"> have any of that</font><font color="#CCCCCC"> stuff</font>

515
00:21:14,890 --> 00:21:19,720
on<font color="#E5E5E5"> your network you're running ntlm one</font>

516
00:21:16,600 --> 00:21:22,419
<font color="#E5E5E5">and</font><font color="#CCCCCC"> DL mv2 they will find it</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> that is</font>

517
00:21:19,720 --> 00:21:23,890
<font color="#E5E5E5">the lowest bar to their entry if</font>

518
00:21:22,420 --> 00:21:26,320
somebody is able<font color="#E5E5E5"> to execute</font><font color="#CCCCCC"> mimicked</font><font color="#E5E5E5"> ads</font>

519
00:21:23,890 --> 00:21:28,150
on your network that's fine

520
00:21:26,320 --> 00:21:30,100
what<font color="#CCCCCC"> they extract out of</font><font color="#E5E5E5"> it makes the</font>

521
00:21:28,150 --> 00:21:30,760
<font color="#CCCCCC">difference that's what credential guard</font>

522
00:21:30,100 --> 00:21:32,980
comes in

523
00:21:30,760 --> 00:21:35,080
so secrets and memory<font color="#E5E5E5"> are typically</font>

524
00:21:32,980 --> 00:21:36,400
managed by the<font color="#E5E5E5"> else's process right and</font>

525
00:21:35,080 --> 00:21:38,949
that's how<font color="#E5E5E5"> windows credential</font>

526
00:21:36,400 --> 00:21:42,429
traditionally operated<font color="#E5E5E5"> so</font><font color="#CCCCCC"> they went</font><font color="#E5E5E5"> and</font>

527
00:21:38,950 --> 00:21:45,220
created<font color="#E5E5E5"> this isolated</font><font color="#CCCCCC"> alsace what it</font>

528
00:21:42,429 --> 00:21:46,960
meant was that<font color="#E5E5E5"> secrets in the</font><font color="#CCCCCC"> LCS were</font>

529
00:21:45,220 --> 00:21:49,330
again isolated<font color="#E5E5E5"> in a different part of</font>

530
00:21:46,960 --> 00:21:52,150
memory<font color="#E5E5E5"> like a hyper-v hypervisor and</font>

531
00:21:49,330 --> 00:21:54,129
what they did with that is they said hey

532
00:21:52,150 --> 00:21:55,929
if your credentials or your secrets in

533
00:21:54,130 --> 00:21:58,570
memory are stored and said inside this

534
00:21:55,929 --> 00:22:00,640
<font color="#E5E5E5">isolated abscess if somebody does a</font>

535
00:21:58,570 --> 00:22:02,610
credential dumping on this host<font color="#CCCCCC"> they're</font>

536
00:22:00,640 --> 00:22:05,260
not going to<font color="#E5E5E5"> be able to access this</font>

537
00:22:02,610 --> 00:22:07,209
right<font color="#E5E5E5"> so hold</font><font color="#CCCCCC"> that thought for a second</font>

538
00:22:05,260 --> 00:22:09,100
<font color="#CCCCCC">it was</font><font color="#E5E5E5"> a good implementation right so</font>

539
00:22:07,210 --> 00:22:13,570
cred<font color="#CCCCCC"> guard worked quite well</font><font color="#E5E5E5"> for boil</font>

540
00:22:09,100 --> 00:22:16,299
and then<font color="#E5E5E5"> Benjamin</font><font color="#CCCCCC"> Delfy said huh not so</font>

541
00:22:13,570 --> 00:22:18,280
much fun<font color="#E5E5E5"> all right and so there's</font>

542
00:22:16,299 --> 00:22:20,020
mitigations around it right so cred<font color="#CCCCCC"> gar</font>

543
00:22:18,280 --> 00:22:24,610
essentially does isolation<font color="#E5E5E5"> of</font><font color="#CCCCCC"> Secrets in</font>

544
00:22:20,020 --> 00:22:26,559
memory and then we'll come to<font color="#E5E5E5"> that in a</font>

545
00:22:24,610 --> 00:22:29,860
second<font color="#E5E5E5"> the second bit around credit card</font>

546
00:22:26,559 --> 00:22:32,290
<font color="#E5E5E5">was remote credential guard</font><font color="#CCCCCC"> wise remote</font>

547
00:22:29,860 --> 00:22:35,020
credential guard important you do RDP to

548
00:22:32,290 --> 00:22:36,668
a machine<font color="#E5E5E5"> the remote machine gives you a</font>

549
00:22:35,020 --> 00:22:39,580
prompt and says enter<font color="#E5E5E5"> your password</font>

550
00:22:36,669 --> 00:22:41,290
<font color="#CCCCCC">right</font><font color="#E5E5E5"> you provide a password</font><font color="#CCCCCC"> it's sent</font>

551
00:22:39,580 --> 00:22:43,750
back<font color="#CCCCCC"> to the machine</font><font color="#E5E5E5"> you are trying</font><font color="#CCCCCC"> to</font>

552
00:22:41,290 --> 00:22:46,299
connect<font color="#E5E5E5"> to that machine then validates</font>

553
00:22:43,750 --> 00:22:48,400
it against its own<font color="#E5E5E5"> ad and then provides</font>

554
00:22:46,299 --> 00:22:49,690
your response<font color="#E5E5E5"> hey you're right</font><font color="#CCCCCC"> the</font>

555
00:22:48,400 --> 00:22:51,580
<font color="#E5E5E5">password is correct you part of the</font>

556
00:22:49,690 --> 00:22:53,530
right<font color="#E5E5E5"> remote admin group here you can</font>

557
00:22:51,580 --> 00:22:55,928
have<font color="#CCCCCC"> access to the</font><font color="#E5E5E5"> host that was</font><font color="#CCCCCC"> the</font>

558
00:22:53,530 --> 00:22:58,360
problem<font color="#CCCCCC"> statement what remote credential</font>

559
00:22:55,929 --> 00:23:01,770
guard did is essentially<font color="#CCCCCC"> say hey I'm</font>

560
00:22:58,360 --> 00:23:04,928
trying to RDP into<font color="#CCCCCC"> this machine</font>

561
00:23:01,770 --> 00:23:06,910
authenticate to<font color="#CCCCCC"> me right and the machine</font>

562
00:23:04,929 --> 00:23:08,650
would<font color="#E5E5E5"> send back</font><font color="#CCCCCC"> a request to you to say</font>

563
00:23:06,910 --> 00:23:10,480
hey I see you part<font color="#E5E5E5"> of the same domain</font>

564
00:23:08,650 --> 00:23:12,790
why don't you authenticate yourself to

565
00:23:10,480 --> 00:23:14,890
the local ad and then<font color="#E5E5E5"> provide</font><font color="#CCCCCC"> the token</font>

566
00:23:12,790 --> 00:23:16,700
back<font color="#CCCCCC"> to me and so what remote credential</font>

567
00:23:14,890 --> 00:23:19,760
guard did is it allowed

568
00:23:16,700 --> 00:23:21,820
not to send secrets over<font color="#E5E5E5"> the wire right</font>

569
00:23:19,760 --> 00:23:25,160
that's what remote credential guarded

570
00:23:21,820 --> 00:23:26,899
<font color="#CCCCCC">but</font><font color="#E5E5E5"> again the problem</font><font color="#CCCCCC"> with</font><font color="#E5E5E5"> this was you</font>

571
00:23:25,160 --> 00:23:29,270
cannot defend against something<font color="#E5E5E5"> like</font>

572
00:23:26,900 --> 00:23:31,160
<font color="#E5E5E5">this if really there are existing</font><font color="#CCCCCC"> store</font>

573
00:23:29,270 --> 00:23:34,190
<font color="#CCCCCC">credentials on the</font><font color="#E5E5E5"> localhost</font><font color="#CCCCCC"> so as an</font>

574
00:23:31,160 --> 00:23:36,500
example<font color="#CCCCCC"> you are a</font><font color="#E5E5E5"> remote admin you are</font>

575
00:23:34,190 --> 00:23:39,200
allowed to<font color="#CCCCCC"> do</font><font color="#E5E5E5"> MSDS</font><font color="#CCCCCC"> C into a local into a</font>

576
00:23:36,500 --> 00:23:41,300
remote host<font color="#E5E5E5"> you are not protecting your</font>

577
00:23:39,200 --> 00:23:42,740
credentials but if there's a<font color="#CCCCCC"> service</font>

578
00:23:41,300 --> 00:23:44,540
<font color="#E5E5E5">running on that local machine that</font>

579
00:23:42,740 --> 00:23:47,300
you're already trying<font color="#E5E5E5"> to RDP</font><font color="#CCCCCC"> into and</font>

580
00:23:44,540 --> 00:23:48,980
that<font color="#E5E5E5"> has secrets in memory</font><font color="#CCCCCC"> you can't</font>

581
00:23:47,300 --> 00:23:52,010
defend against<font color="#CCCCCC"> it right so that's</font><font color="#E5E5E5"> what</font>

582
00:23:48,980 --> 00:23:53,420
remote<font color="#E5E5E5"> read guard did so let's talk a</font>

583
00:23:52,010 --> 00:23:55,760
little<font color="#E5E5E5"> bit about the credit card</font><font color="#CCCCCC"> right</font>

584
00:23:53,420 --> 00:23:57,560
and I wanted<font color="#E5E5E5"> this to</font><font color="#CCCCCC"> be a demo but</font><font color="#E5E5E5"> I</font>

585
00:23:55,760 --> 00:24:01,160
really<font color="#E5E5E5"> don't want to upset the demo</font>

586
00:23:57,560 --> 00:24:03,200
<font color="#E5E5E5">guard so so here is what a</font><font color="#CCCCCC"> machine looks</font>

587
00:24:01,160 --> 00:24:05,180
like and<font color="#CCCCCC"> let</font><font color="#E5E5E5"> me see if I can zoom</font><font color="#CCCCCC"> into</font>

588
00:24:03,200 --> 00:24:09,620
some<font color="#E5E5E5"> of this stuff can you see it</font>

589
00:24:05,180 --> 00:24:11,660
<font color="#E5E5E5">already so let me let</font><font color="#CCCCCC"> me</font><font color="#E5E5E5"> try and point</font>

590
00:24:09,620 --> 00:24:14,209
it<font color="#E5E5E5"> out right so so you have</font><font color="#CCCCCC"> two machines</font>

591
00:24:11,660 --> 00:24:16,250
here<font color="#E5E5E5"> this is this is the machine that's</font>

592
00:24:14,210 --> 00:24:17,720
already running<font color="#E5E5E5"> credit</font><font color="#CCCCCC"> card this</font><font color="#E5E5E5"> is a</font>

593
00:24:16,250 --> 00:24:19,760
<font color="#E5E5E5">machine that's not running thread guard</font>

594
00:24:17,720 --> 00:24:22,160
<font color="#E5E5E5">how do you know because</font><font color="#CCCCCC"> if</font><font color="#E5E5E5"> you do</font>

595
00:24:19,760 --> 00:24:23,840
<font color="#CCCCCC">privilege debug on this machine</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> get</font>

596
00:24:22,160 --> 00:24:25,970
<font color="#E5E5E5">a bunch of</font><font color="#CCCCCC"> stuff</font><font color="#E5E5E5"> but look what's missing</font>

597
00:24:23,840 --> 00:24:27,919
<font color="#E5E5E5">on this part</font><font color="#CCCCCC"> versus look what's</font>

598
00:24:25,970 --> 00:24:29,870
available<font color="#E5E5E5"> on this part right so</font><font color="#CCCCCC"> you have</font>

599
00:24:27,920 --> 00:24:32,330
<font color="#E5E5E5">the ntlm you have the</font><font color="#CCCCCC"> sha-1 hash is</font>

600
00:24:29,870 --> 00:24:34,520
available and<font color="#CCCCCC"> you also have the</font><font color="#E5E5E5"> W digest</font>

601
00:24:32,330 --> 00:24:36,620
values here right<font color="#E5E5E5"> you don't see them on</font>

602
00:24:34,520 --> 00:24:39,320
this side<font color="#E5E5E5"> why is this relevant because</font>

603
00:24:36,620 --> 00:24:41,600
<font color="#E5E5E5">if you</font><font color="#CCCCCC"> do thread</font><font color="#E5E5E5"> guard implementations</font>

604
00:24:39,320 --> 00:24:42,950
properly<font color="#E5E5E5"> the secrets disappear from</font>

605
00:24:41,600 --> 00:24:45,919
memory<font color="#CCCCCC"> all right so you don't have your</font>

606
00:24:42,950 --> 00:24:48,020
ntlm and sha-1 hashes anymore and hence

607
00:24:45,920 --> 00:24:54,710
you don't get those values when<font color="#E5E5E5"> you run</font>

608
00:24:48,020 --> 00:24:55,940
many cats but there's bypasses<font color="#E5E5E5"> right and</font>

609
00:24:54,710 --> 00:24:59,240
this<font color="#E5E5E5"> is what I was talking</font><font color="#CCCCCC"> about right</font>

610
00:24:55,940 --> 00:25:01,700
<font color="#CCCCCC">so so when credit</font><font color="#E5E5E5"> guard came out the</font>

611
00:24:59,240 --> 00:25:03,500
founder of Mimi<font color="#E5E5E5"> Katz said huh there</font>

612
00:25:01,700 --> 00:25:05,060
might be a bypass to it<font color="#E5E5E5"> let me explain</font>

613
00:25:03,500 --> 00:25:07,610
what he said<font color="#CCCCCC"> right before</font><font color="#E5E5E5"> we don't jump</font>

614
00:25:05,060 --> 00:25:09,950
into<font color="#E5E5E5"> the demo the logic behind is quite</font>

615
00:25:07,610 --> 00:25:11,419
simple you<font color="#E5E5E5"> have isolated processes in</font>

616
00:25:09,950 --> 00:25:13,280
memory<font color="#E5E5E5"> and then you have the else's</font>

617
00:25:11,420 --> 00:25:15,920
process that sits outside in the local

618
00:25:13,280 --> 00:25:17,960
system traditional processes so if

619
00:25:15,920 --> 00:25:20,720
you're going<font color="#E5E5E5"> installing a program you</font>

620
00:25:17,960 --> 00:25:22,670
run an MSI file as an example that MSI

621
00:25:20,720 --> 00:25:24,590
file is not running<font color="#E5E5E5"> inside an isolated</font>

622
00:25:22,670 --> 00:25:26,990
process<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> drawing on the local system</font>

623
00:25:24,590 --> 00:25:29,000
<font color="#CCCCCC">so it makes a call to the local else's</font>

624
00:25:26,990 --> 00:25:30,210
the<font color="#CCCCCC"> elseis is going to make a call</font><font color="#E5E5E5"> to</font>

625
00:25:29,000 --> 00:25:31,799
the isolated<font color="#E5E5E5"> else</font>

626
00:25:30,210 --> 00:25:38,779
and hence<font color="#E5E5E5"> that's how a gene is</font>

627
00:25:31,799 --> 00:25:41,970
established<font color="#CCCCCC"> so let's look at this so</font>

628
00:25:38,779 --> 00:25:45,150
he's looking<font color="#E5E5E5"> at a file called mini LS c</font>

629
00:25:41,970 --> 00:25:47,370
dot<font color="#CCCCCC"> loc</font><font color="#E5E5E5"> there's nothing in there okay he</font>

630
00:25:45,150 --> 00:25:50,039
runs the<font color="#CCCCCC"> privilege debug</font><font color="#E5E5E5"> command he gets</font>

631
00:25:47,370 --> 00:25:59,039
a<font color="#CCCCCC"> response saying</font><font color="#E5E5E5"> okay he tries to look</font>

632
00:25:50,039 --> 00:26:00,690
at<font color="#E5E5E5"> the</font><font color="#CCCCCC"> logon passwords there's a bunch</font>

633
00:25:59,039 --> 00:26:03,000
of<font color="#E5E5E5"> things fired</font><font color="#CCCCCC"> he really doesn't see</font>

634
00:26:00,690 --> 00:26:05,820
the ntlm<font color="#CCCCCC"> hashes he doesn't see the sha-1</font>

635
00:26:03,000 --> 00:26:09,899
hashes there's the<font color="#CCCCCC"> U n key keys so on</font>

636
00:26:05,820 --> 00:26:11,939
and so forth<font color="#CCCCCC"> all</font><font color="#E5E5E5"> right it goes back to</font>

637
00:26:09,899 --> 00:26:14,610
the<font color="#E5E5E5"> other machine</font><font color="#CCCCCC"> looks at the</font><font color="#E5E5E5"> version</font>

638
00:26:11,940 --> 00:26:16,260
<font color="#E5E5E5">it's a Windows NT</font><font color="#CCCCCC"> a secure kernel is</font>

639
00:26:14,610 --> 00:26:20,908
running credential guard is<font color="#E5E5E5"> also running</font>

640
00:26:16,260 --> 00:26:23,010
<font color="#CCCCCC">on this</font><font color="#E5E5E5"> machine right and then he</font>

641
00:26:20,909 --> 00:26:25,559
injects the<font color="#E5E5E5"> MSS</font><font color="#CCCCCC"> MSSP</font>

642
00:26:23,010 --> 00:26:27,899
and what's happened<font color="#CCCCCC"> now</font><font color="#E5E5E5"> is he's injected</font>

643
00:26:25,559 --> 00:26:30,720
a process it's running from<font color="#E5E5E5"> the local</font>

644
00:26:27,899 --> 00:26:32,279
system as the locally running user<font color="#E5E5E5"> he</font>

645
00:26:30,720 --> 00:26:33,990
waits<font color="#CCCCCC"> for</font><font color="#E5E5E5"> the user</font><font color="#CCCCCC"> to log off and log</font>

646
00:26:32,279 --> 00:26:38,850
<font color="#E5E5E5">back in or start to probe down with his</font>

647
00:26:33,990 --> 00:26:41,700
<font color="#CCCCCC">axis when he logs</font><font color="#E5E5E5"> back in a local log</font>

648
00:26:38,850 --> 00:26:44,340
file is created<font color="#E5E5E5"> on that system which</font>

649
00:26:41,700 --> 00:26:46,080
contains<font color="#E5E5E5"> all the</font><font color="#CCCCCC"> passwords what just</font>

650
00:26:44,340 --> 00:26:49,110
<font color="#E5E5E5">happened here right so</font><font color="#CCCCCC"> what's happened</font>

651
00:26:46,080 --> 00:26:52,559
here<font color="#E5E5E5"> is that somebody moved</font>

652
00:26:49,110 --> 00:26:54,000
secrets in memory from an MSI file that

653
00:26:52,559 --> 00:26:56,760
was supposed to be<font color="#E5E5E5"> running somebody</font>

654
00:26:54,000 --> 00:26:59,669
injected<font color="#E5E5E5"> code into that MSI file when it</font>

655
00:26:56,760 --> 00:27:01,320
ran it called the<font color="#E5E5E5"> isolated alsace pull</font>

656
00:26:59,669 --> 00:27:03,179
the secrets from<font color="#CCCCCC"> there dumped it to a</font>

657
00:27:01,320 --> 00:27:07,049
local text file<font color="#E5E5E5"> and that's how this</font>

658
00:27:03,179 --> 00:27:09,210
attack works<font color="#E5E5E5"> right can you do something</font>

659
00:27:07,049 --> 00:27:12,418
<font color="#E5E5E5">about it sure so for every action</font>

660
00:27:09,210 --> 00:27:15,720
there's a reaction as well<font color="#CCCCCC"> and here's</font>

661
00:27:12,419 --> 00:27:17,909
what a defender<font color="#E5E5E5"> would do fine somebody's</font>

662
00:27:15,720 --> 00:27:18,480
exploited<font color="#E5E5E5"> this</font><font color="#CCCCCC"> one durability this has</font>

663
00:27:17,909 --> 00:27:20,490
happened

664
00:27:18,480 --> 00:27:22,890
what<font color="#E5E5E5"> can you do to defend against it</font>

665
00:27:20,490 --> 00:27:25,340
number one<font color="#E5E5E5"> you can</font><font color="#CCCCCC"> go and disable</font><font color="#E5E5E5"> the</font>

666
00:27:22,890 --> 00:27:28,080
debug privilege<font color="#CCCCCC"> for your administrators</font>

667
00:27:25,340 --> 00:27:30,720
it might be<font color="#CCCCCC"> okay it might not be okay</font><font color="#E5E5E5"> in</font>

668
00:27:28,080 --> 00:27:33,149
<font color="#E5E5E5">some environments you can detect which</font>

669
00:27:30,720 --> 00:27:35,399
history changes so somebody goes<font color="#E5E5E5"> and</font>

670
00:27:33,149 --> 00:27:37,229
modifies a key that allows you<font color="#CCCCCC"> to change</font>

671
00:27:35,399 --> 00:27:39,689
<font color="#E5E5E5">the</font><font color="#CCCCCC"> W digests values from disabled to</font>

672
00:27:37,230 --> 00:27:42,570
enabled<font color="#CCCCCC"> maybe pick</font><font color="#E5E5E5"> up and then trigger</font>

673
00:27:39,690 --> 00:27:43,730
an alarm<font color="#CCCCCC"> you do not permit which cache</font>

674
00:27:42,570 --> 00:27:45,379
potentials to be stored

675
00:27:43,730 --> 00:27:47,570
by<font color="#CCCCCC"> default when you build your machines</font>

676
00:27:45,380 --> 00:27:49,550
make sure that that key is disabled<font color="#CCCCCC"> oh</font>

677
00:27:47,570 --> 00:27:53,600
<font color="#E5E5E5">you can do what</font><font color="#CCCCCC"> Niki methyl does and</font>

678
00:27:49,550 --> 00:27:55,909
says use honey tokens<font color="#E5E5E5"> and why is this</font>

679
00:27:53,600 --> 00:27:58,580
important<font color="#E5E5E5"> right let's say there is a</font>

680
00:27:55,910 --> 00:28:00,680
secret<font color="#E5E5E5"> in memory that was picked up as a</font>

681
00:27:58,580 --> 00:28:04,250
<font color="#E5E5E5">result of a creditor spear attack or MMS</font>

682
00:28:00,680 --> 00:28:06,170
SP attack that's fine<font color="#CCCCCC"> you want the</font>

683
00:28:04,250 --> 00:28:08,960
attacker<font color="#E5E5E5"> to pick it up and then you want</font>

684
00:28:06,170 --> 00:28:11,120
<font color="#E5E5E5">the attacker to use it but</font><font color="#CCCCCC"> you better</font>

685
00:28:08,960 --> 00:28:13,490
<font color="#E5E5E5">make sure that</font><font color="#CCCCCC"> your team knows</font><font color="#E5E5E5"> that a</font>

686
00:28:11,120 --> 00:28:15,800
use case should alert every time an

687
00:28:13,490 --> 00:28:18,170
account which was a honey token was used

688
00:28:15,800 --> 00:28:21,970
anywhere on your<font color="#E5E5E5"> network the matter of</font>

689
00:28:18,170 --> 00:28:25,160
the machine is on primer<font color="#CCCCCC"> off Prem and</font>

690
00:28:21,970 --> 00:28:28,430
<font color="#CCCCCC">some names right</font><font color="#E5E5E5"> why honey tokens you</font>

691
00:28:25,160 --> 00:28:32,870
present an attacker<font color="#CCCCCC"> oh he thinks</font><font color="#E5E5E5"> he's</font>

692
00:28:28,430 --> 00:28:34,700
found<font color="#E5E5E5"> a honey token that's good but</font>

693
00:28:32,870 --> 00:28:36,260
there's more right<font color="#E5E5E5"> and that's what</font>

694
00:28:34,700 --> 00:28:39,940
you're<font color="#CCCCCC"> trying to</font><font color="#E5E5E5"> do you're deceiving the</font>

695
00:28:36,260 --> 00:28:43,040
attacker<font color="#E5E5E5"> from going and finding the real</font>

696
00:28:39,940 --> 00:28:46,340
success factors right that's that's how

697
00:28:43,040 --> 00:28:48,080
it is information<font color="#E5E5E5"> protection and</font>

698
00:28:46,340 --> 00:28:50,120
information<font color="#E5E5E5"> protection has a lot</font><font color="#CCCCCC"> of</font>

699
00:28:48,080 --> 00:28:52,520
things so jumping now into information

700
00:28:50,120 --> 00:28:54,979
<font color="#E5E5E5">protection</font><font color="#CCCCCC"> I will talk only about device</font>

701
00:28:52,520 --> 00:28:57,170
health attestation<font color="#E5E5E5"> why is this important</font>

702
00:28:54,980 --> 00:28:59,390
so device health attestation is is

703
00:28:57,170 --> 00:29:01,670
relevant because you are then trying to

704
00:28:59,390 --> 00:29:03,530
<font color="#E5E5E5">protect your organization from</font>

705
00:29:01,670 --> 00:29:06,260
credential leakage right<font color="#E5E5E5"> so let's say</font>

706
00:29:03,530 --> 00:29:08,870
something<font color="#CCCCCC"> happens</font><font color="#E5E5E5"> traditional phishing</font>

707
00:29:06,260 --> 00:29:10,520
attack somebody goes online<font color="#E5E5E5"> puts the</font>

708
00:29:08,870 --> 00:29:12,770
username password you<font color="#CCCCCC"> have two factor</font>

709
00:29:10,520 --> 00:29:15,050
authentication available the guy clicks

710
00:29:12,770 --> 00:29:17,600
on<font color="#CCCCCC"> a fishing</font><font color="#E5E5E5"> link puts the password and</font>

711
00:29:15,050 --> 00:29:20,600
you're done right<font color="#E5E5E5"> you now want to be</font>

712
00:29:17,600 --> 00:29:23,260
<font color="#CCCCCC">able</font><font color="#E5E5E5"> to detect if somebody is</font><font color="#CCCCCC"> trying to</font>

713
00:29:20,600 --> 00:29:24,679
reuse a credential<font color="#CCCCCC"> of your network</font>

714
00:29:23,260 --> 00:29:25,940
<font color="#E5E5E5">irrespective of whether you have</font>

715
00:29:24,680 --> 00:29:28,190
two-factor authentication or not it's

716
00:29:25,940 --> 00:29:30,140
not relevant<font color="#E5E5E5"> here why because there are</font>

717
00:29:28,190 --> 00:29:31,910
<font color="#E5E5E5">traditional services they don't use</font>

718
00:29:30,140 --> 00:29:33,080
two-factor authentication<font color="#E5E5E5"> so if you</font>

719
00:29:31,910 --> 00:29:36,320
don't exchange<font color="#E5E5E5"> within your environment</font>

720
00:29:33,080 --> 00:29:38,449
<font color="#CCCCCC">as an example you have legacy auth and</font>

721
00:29:36,320 --> 00:29:40,580
you have modern author<font color="#E5E5E5"> modern earth</font>

722
00:29:38,450 --> 00:29:42,500
supports two-factor authentication<font color="#E5E5E5"> but</font>

723
00:29:40,580 --> 00:29:44,720
you have active sync you have exchange

724
00:29:42,500 --> 00:29:47,330
web services running<font color="#E5E5E5"> all of those don't</font>

725
00:29:44,720 --> 00:29:50,210
<font color="#CCCCCC">really use two-factor authentication so</font>

726
00:29:47,330 --> 00:29:52,070
reused credential is still<font color="#E5E5E5"> valid if I</font>

727
00:29:50,210 --> 00:29:55,430
know<font color="#E5E5E5"> Etienne is here</font><font color="#CCCCCC"> who used to work</font>

728
00:29:52,070 --> 00:29:57,879
for<font color="#E5E5E5"> sense post so it he installed rod of</font>

729
00:29:55,430 --> 00:30:01,610
pronouncing his name murdering it

730
00:29:57,880 --> 00:30:03,020
he wrote a tool called ruler if you've

731
00:30:01,610 --> 00:30:06,800
heard of<font color="#E5E5E5"> it</font><font color="#CCCCCC"> has anyone heard of</font><font color="#E5E5E5"> it</font>

732
00:30:03,020 --> 00:30:10,450
before<font color="#CCCCCC"> no yeah</font><font color="#E5E5E5"> so that tool is important</font>

733
00:30:06,800 --> 00:30:12,710
why because<font color="#E5E5E5"> it weighs in on an adversary</font>

734
00:30:10,450 --> 00:30:15,290
<font color="#E5E5E5">trying to go and create a malicious</font>

735
00:30:12,710 --> 00:30:16,850
<font color="#CCCCCC">Outlook rule</font><font color="#E5E5E5"> why is it important</font><font color="#CCCCCC"> all</font>

736
00:30:15,290 --> 00:30:18,950
<font color="#E5E5E5">right so</font><font color="#CCCCCC"> I gave you the example of</font><font color="#E5E5E5"> the</font>

737
00:30:16,850 --> 00:30:22,490
fishing incident<font color="#E5E5E5"> you send a blast of</font>

738
00:30:18,950 --> 00:30:23,990
<font color="#E5E5E5">fishing emails right and you expect that</font>

739
00:30:22,490 --> 00:30:26,480
if your organization has<font color="#CCCCCC"> a hundred</font>

740
00:30:23,990 --> 00:30:29,480
thousand people one out<font color="#CCCCCC"> of those 100,000</font>

741
00:30:26,480 --> 00:30:31,520
will click on<font color="#E5E5E5"> it yeah you wait</font><font color="#CCCCCC"> for the</font>

742
00:30:29,480 --> 00:30:34,040
guy<font color="#CCCCCC"> to click on it or a girl to click on</font>

743
00:30:31,520 --> 00:30:35,389
it<font color="#E5E5E5"> put their password in the attacker</font>

744
00:30:34,040 --> 00:30:37,670
then<font color="#E5E5E5"> takes the password that</font><font color="#CCCCCC"> they</font><font color="#E5E5E5"> have</font>

745
00:30:35,390 --> 00:30:40,670
recovered<font color="#E5E5E5"> and queries the auto discovery</font>

746
00:30:37,670 --> 00:30:44,330
URL for<font color="#CCCCCC"> your exchange from that he finds</font>

747
00:30:40,670 --> 00:30:46,550
what the EWS<font color="#E5E5E5"> notice he then tries to log</font>

748
00:30:44,330 --> 00:30:49,370
in<font color="#CCCCCC"> to the exchange web services and</font><font color="#E5E5E5"> says</font>

749
00:30:46,550 --> 00:30:51,740
with the ruler tool<font color="#E5E5E5"> hey can you show me</font>

750
00:30:49,370 --> 00:30:53,889
<font color="#E5E5E5">now with this</font><font color="#CCCCCC"> mapping endpoint exposed</font>

751
00:30:51,740 --> 00:30:56,630
<font color="#CCCCCC">what can I do on</font><font color="#E5E5E5"> this exchange mailbox</font>

752
00:30:53,890 --> 00:30:59,600
<font color="#CCCCCC">see so you</font><font color="#E5E5E5"> can read emails if you want</font>

753
00:30:56,630 --> 00:31:01,850
<font color="#E5E5E5">so it is great then what the tool does</font>

754
00:30:59,600 --> 00:31:03,409
<font color="#E5E5E5">say is</font><font color="#CCCCCC"> ok can you show me how many</font>

755
00:31:01,850 --> 00:31:06,949
<font color="#CCCCCC">outlook rules does the person have</font>

756
00:31:03,410 --> 00:31:09,680
already<font color="#CCCCCC"> sees yeah</font><font color="#E5E5E5"> here you go he has 40</font>

757
00:31:06,950 --> 00:31:12,290
rules<font color="#CCCCCC"> ok then</font><font color="#E5E5E5"> the tool says</font><font color="#CCCCCC"> all right</font>

758
00:31:09,680 --> 00:31:13,550
<font color="#E5E5E5">let's go in and I don't have a video for</font>

759
00:31:12,290 --> 00:31:15,379
this<font color="#E5E5E5"> unfortunately it's very interesting</font>

760
00:31:13,550 --> 00:31:17,270
<font color="#E5E5E5">but you should see it so what the tool</font>

761
00:31:15,380 --> 00:31:19,790
does and say<font color="#E5E5E5"> ok let me go and create a</font>

762
00:31:17,270 --> 00:31:22,100
<font color="#E5E5E5">new outlook rule and all that outlook</font>

763
00:31:19,790 --> 00:31:25,639
rules supposed to do is say<font color="#E5E5E5"> any time an</font>

764
00:31:22,100 --> 00:31:27,919
email comes in which says pop<font color="#E5E5E5"> as an</font>

765
00:31:25,640 --> 00:31:29,320
example<font color="#CCCCCC"> of making</font><font color="#E5E5E5"> up a word go and</font>

766
00:31:27,920 --> 00:31:32,210
<font color="#E5E5E5">execute the</font><font color="#CCCCCC"> script</font>

767
00:31:29,320 --> 00:31:35,080
what is<font color="#E5E5E5"> that script that script could be</font>

768
00:31:32,210 --> 00:31:37,820
hosted on<font color="#E5E5E5"> a web dev directory</font><font color="#CCCCCC"> somewhere</font>

769
00:31:35,080 --> 00:31:39,620
doesn't<font color="#CCCCCC"> matter what it</font><font color="#E5E5E5"> is every time an</font>

770
00:31:37,820 --> 00:31:43,939
email will come in that<font color="#E5E5E5"> has the word pop</font>

771
00:31:39,620 --> 00:31:45,350
<font color="#E5E5E5">to execute the script that's it yeah he</font>

772
00:31:43,940 --> 00:31:48,920
saves the rule<font color="#E5E5E5"> that's it</font>

773
00:31:45,350 --> 00:31:49,639
he's now waiting<font color="#E5E5E5"> for the</font><font color="#CCCCCC"> user to</font><font color="#E5E5E5"> come</font>

774
00:31:48,920 --> 00:31:52,400
into<font color="#E5E5E5"> his</font><font color="#CCCCCC"> office</font>

775
00:31:49,640 --> 00:31:55,670
open his outlook client<font color="#E5E5E5"> and he just</font>

776
00:31:52,400 --> 00:31:58,340
waits right<font color="#E5E5E5"> this is now something that's</font>

777
00:31:55,670 --> 00:32:00,170
waiting<font color="#E5E5E5"> in hiding right so there is some</font>

778
00:31:58,340 --> 00:32:02,270
sort of a persistence mechanism<font color="#E5E5E5"> but it's</font>

779
00:32:00,170 --> 00:32:04,940
not really established persistence but

780
00:32:02,270 --> 00:32:07,190
<font color="#E5E5E5">he has a leg into the door on one fine</font>

781
00:32:04,940 --> 00:32:08,929
day<font color="#E5E5E5"> he sends an email to the to the user</font>

782
00:32:07,190 --> 00:32:11,120
with<font color="#CCCCCC"> the word</font>

783
00:32:08,929 --> 00:32:12,650
the user<font color="#CCCCCC"> Caesar I was this guy who's</font>

784
00:32:11,120 --> 00:32:14,959
<font color="#E5E5E5">sending me an email with the word pop he</font>

785
00:32:12,650 --> 00:32:16,720
has absolutely<font color="#E5E5E5"> no idea what it</font><font color="#CCCCCC"> is a few</font>

786
00:32:14,960 --> 00:32:19,970
<font color="#E5E5E5">minutes later the email disappears</font>

787
00:32:16,720 --> 00:32:22,940
what's happened<font color="#CCCCCC"> right his outlook client</font>

788
00:32:19,970 --> 00:32:25,250
has interpreted the email<font color="#E5E5E5"> coming in has</font>

789
00:32:22,940 --> 00:32:28,610
tagged it to the outlook rule the

790
00:32:25,250 --> 00:32:30,890
outlook rule has said<font color="#E5E5E5"> ah pop go and</font>

791
00:32:28,610 --> 00:32:32,959
<font color="#E5E5E5">execute this code from from web dev and</font>

792
00:32:30,890 --> 00:32:35,090
in what has happened after<font color="#CCCCCC"> that</font>

793
00:32:32,960 --> 00:32:36,799
<font color="#E5E5E5">is that it's established a bunch of</font>

794
00:32:35,090 --> 00:32:38,240
persistence<font color="#E5E5E5"> it's downloaded a bunch of</font>

795
00:32:36,799 --> 00:32:38,889
things<font color="#E5E5E5"> and now he's sitting on your</font>

796
00:32:38,240 --> 00:32:42,080
<font color="#E5E5E5">local</font><font color="#CCCCCC"> machine</font>

797
00:32:38,890 --> 00:32:44,480
<font color="#E5E5E5">what is the attacker to Empire</font><font color="#CCCCCC"> she'll</font>

798
00:32:42,080 --> 00:32:46,309
<font color="#E5E5E5">reverse payload he sees it coming he</font>

799
00:32:44,480 --> 00:32:48,860
says ah<font color="#CCCCCC"> I have accessed inside the</font>

800
00:32:46,309 --> 00:32:51,379
network<font color="#E5E5E5"> it started</font><font color="#CCCCCC"> from a phishing email</font>

801
00:32:48,860 --> 00:32:54,289
<font color="#E5E5E5">all the</font><font color="#CCCCCC"> user had to do was enter</font>

802
00:32:51,380 --> 00:32:56,690
<font color="#CCCCCC">username</font><font color="#E5E5E5"> and password even better</font>

803
00:32:54,289 --> 00:32:58,879
the<font color="#E5E5E5"> attacker goes in and says I have a</font>

804
00:32:56,690 --> 00:33:01,250
reverse payload<font color="#E5E5E5"> the dropper has</font>

805
00:32:58,880 --> 00:33:03,350
established<font color="#CCCCCC"> let me go push more heavy</font>

806
00:33:01,250 --> 00:33:05,270
code into that machine<font color="#CCCCCC"> oh and by the way</font>

807
00:33:03,350 --> 00:33:07,070
while I'm at it<font color="#E5E5E5"> let</font><font color="#CCCCCC"> me</font><font color="#E5E5E5"> go back</font><font color="#CCCCCC"> to the</font>

808
00:33:05,270 --> 00:33:09,440
<font color="#CCCCCC">mappy endpoint and delete the rule I</font>

809
00:33:07,070 --> 00:33:12,020
created<font color="#E5E5E5"> and delete the email that came</font>

810
00:33:09,440 --> 00:33:14,120
<font color="#E5E5E5">in good luck as a defender going and</font>

811
00:33:12,020 --> 00:33:16,610
trying and finding that<font color="#CCCCCC"> here's</font><font color="#E5E5E5"> next to</font>

812
00:33:14,120 --> 00:33:19,189
<font color="#CCCCCC">impossible</font><font color="#E5E5E5"> for you to go and</font><font color="#CCCCCC"> find out</font>

813
00:33:16,610 --> 00:33:20,689
one rule that<font color="#E5E5E5"> is created in one Outlook</font>

814
00:33:19,190 --> 00:33:22,610
mail box somewhere<font color="#E5E5E5"> in your company</font>

815
00:33:20,690 --> 00:33:26,570
<font color="#E5E5E5">without knowing what the attacker did</font>

816
00:33:22,610 --> 00:33:28,668
extremely<font color="#E5E5E5"> difficult</font><font color="#CCCCCC"> but it does become</font>

817
00:33:26,570 --> 00:33:30,740
<font color="#E5E5E5">important</font><font color="#CCCCCC"> because you then want to be</font>

818
00:33:28,669 --> 00:33:32,870
able<font color="#E5E5E5"> to stop the attacker from doing</font>

819
00:33:30,740 --> 00:33:33,820
more with that credential<font color="#CCCCCC"> alright so</font>

820
00:33:32,870 --> 00:33:38,149
this<font color="#E5E5E5"> is what</font><font color="#CCCCCC"> it is</font>

821
00:33:33,820 --> 00:33:39,408
so before<font color="#CCCCCC"> Windows 10</font><font color="#E5E5E5"> there was no</font>

822
00:33:38,149 --> 00:33:41,539
concept of device health attestation

823
00:33:39,409 --> 00:33:44,480
right so if you compromise<font color="#E5E5E5"> to</font><font color="#CCCCCC"> username</font>

824
00:33:41,539 --> 00:33:46,129
<font color="#E5E5E5">or a password it was an assumed breach</font>

825
00:33:44,480 --> 00:33:48,710
that<font color="#E5E5E5"> was the end of it</font>

826
00:33:46,130 --> 00:33:50,450
<font color="#E5E5E5">right so somebody had a used name</font>

827
00:33:48,710 --> 00:33:52,460
password<font color="#E5E5E5"> they would log</font><font color="#CCCCCC"> into</font><font color="#E5E5E5"> your</font>

828
00:33:50,450 --> 00:33:54,020
<font color="#CCCCCC">SharePoint Online</font><font color="#E5E5E5"> they would log</font><font color="#CCCCCC"> into</font>

829
00:33:52,460 --> 00:33:57,320
your onedrive they would pick<font color="#E5E5E5"> out files</font>

830
00:33:54,020 --> 00:33:59,600
and that<font color="#E5E5E5"> was the end of it so with</font>

831
00:33:57,320 --> 00:34:03,559
device health attestation<font color="#E5E5E5"> what happens</font>

832
00:33:59,600 --> 00:34:06,110
is you<font color="#E5E5E5"> can configure trust to be</font>

833
00:34:03,559 --> 00:34:08,500
established<font color="#CCCCCC"> only user</font><font color="#E5E5E5"> name password plus</font>

834
00:34:06,110 --> 00:34:11,210
the health of<font color="#E5E5E5"> a device that you control</font>

835
00:34:08,500 --> 00:34:14,239
what does that<font color="#E5E5E5"> mean right so somebody</font>

836
00:34:11,210 --> 00:34:16,820
goes and compromises an account<font color="#E5E5E5"> username</font>

837
00:34:14,239 --> 00:34:18,020
<font color="#E5E5E5">password is lost</font><font color="#CCCCCC"> he now tries to use the</font>

838
00:34:16,820 --> 00:34:19,669
username and<font color="#CCCCCC"> password to access</font>

839
00:34:18,020 --> 00:34:22,219
<font color="#CCCCCC">sharepoint</font><font color="#E5E5E5"> online</font>

840
00:34:19,668 --> 00:34:24,980
what a<font color="#CCCCCC"> sharepoint online say hey</font><font color="#E5E5E5"> you're</font>

841
00:34:22,219 --> 00:34:28,368
coming<font color="#E5E5E5"> in from ABC Corp I know your</font>

842
00:34:24,980 --> 00:34:30,319
company<font color="#E5E5E5"> uses DHA if you are coming in</font>

843
00:34:28,369 --> 00:34:32,750
from<font color="#CCCCCC"> a registered asset</font><font color="#E5E5E5"> can you please</font>

844
00:34:30,319 --> 00:34:36,259
go to<font color="#E5E5E5"> my cloud broker and verify the</font>

845
00:34:32,750 --> 00:34:38,059
integrity<font color="#E5E5E5"> of your asset</font><font color="#CCCCCC"> ok so what the</font>

846
00:34:36,260 --> 00:34:39,770
device is<font color="#E5E5E5"> supposed to do when it</font>

847
00:34:38,059 --> 00:34:42,530
receives an instruction of<font color="#E5E5E5"> this sort is</font>

848
00:34:39,770 --> 00:34:44,569
supposed<font color="#E5E5E5"> to go out connect to a</font><font color="#CCCCCC"> DHEA</font>

849
00:34:42,530 --> 00:34:46,849
device<font color="#CCCCCC"> health attestation</font><font color="#E5E5E5"> cloud this is</font>

850
00:34:44,569 --> 00:34:49,549
free of cost<font color="#E5E5E5"> it's no cost to it</font><font color="#CCCCCC"> it</font>

851
00:34:46,849 --> 00:34:52,159
verifies parameters and<font color="#CCCCCC"> you can decide</font>

852
00:34:49,549 --> 00:34:53,509
<font color="#E5E5E5">what parameters</font><font color="#CCCCCC"> it wants to verify you</font>

853
00:34:52,159 --> 00:34:56,119
can say tell<font color="#E5E5E5"> me the list of installed</font>

854
00:34:53,510 --> 00:34:59,690
<font color="#E5E5E5">programs tell me if early launch</font>

855
00:34:56,119 --> 00:35:01,880
anti-malware<font color="#E5E5E5"> as a driver is enabled tell</font>

856
00:34:59,690 --> 00:35:04,579
me if the machine<font color="#E5E5E5"> has</font><font color="#CCCCCC"> been to the active</font>

857
00:35:01,880 --> 00:35:06,740
directory<font color="#E5E5E5"> in the last</font><font color="#CCCCCC"> seven days and so</font>

858
00:35:04,579 --> 00:35:09,770
on<font color="#E5E5E5"> and so forth right</font><font color="#CCCCCC"> and what that</font>

859
00:35:06,740 --> 00:35:11,180
starts to do is it starts<font color="#E5E5E5"> to say hey if</font>

860
00:35:09,770 --> 00:35:11,780
you've compromised<font color="#CCCCCC"> to</font><font color="#E5E5E5"> user name and</font>

861
00:35:11,180 --> 00:35:14,720
password

862
00:35:11,780 --> 00:35:17,480
you better have a corporate build that

863
00:35:14,720 --> 00:35:19,640
has a valid currency<font color="#CCCCCC"> which means it's</font>

864
00:35:17,480 --> 00:35:22,790
current in the active<font color="#E5E5E5"> directory the</font>

865
00:35:19,640 --> 00:35:25,578
certificates are valid<font color="#E5E5E5"> and you must have</font>

866
00:35:22,790 --> 00:35:28,160
a<font color="#E5E5E5"> mechanism to be able</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> get those keys</font>

867
00:35:25,579 --> 00:35:30,829
<font color="#E5E5E5">from the local CA on the network right</font>

868
00:35:28,160 --> 00:35:33,410
so which<font color="#CCCCCC"> means you have shifted the</font>

869
00:35:30,829 --> 00:35:35,780
responsibility of trying<font color="#CCCCCC"> to verify the</font>

870
00:35:33,410 --> 00:35:37,848
username and<font color="#E5E5E5"> password</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> to verifying</font>

871
00:35:35,780 --> 00:35:41,059
the username password plus the device

872
00:35:37,849 --> 00:35:43,040
the user<font color="#E5E5E5"> is coming from</font><font color="#CCCCCC"> right that's now</font>

873
00:35:41,059 --> 00:35:45,020
an additional threshold for the attacker

874
00:35:43,040 --> 00:35:46,759
to<font color="#E5E5E5"> reach a network right so if they want</font>

875
00:35:45,020 --> 00:35:49,099
<font color="#CCCCCC">to compromise</font><font color="#E5E5E5"> your network they don't</font>

876
00:35:46,760 --> 00:35:50,720
just need to<font color="#CCCCCC"> do fishing</font><font color="#E5E5E5"> they also need</font>

877
00:35:49,099 --> 00:35:53,270
<font color="#E5E5E5">to be</font><font color="#CCCCCC"> able to get access to your IT</font>

878
00:35:50,720 --> 00:35:55,339
stores<font color="#E5E5E5"> get a legitimate</font><font color="#CCCCCC"> copy of your</font>

879
00:35:53,270 --> 00:35:57,920
<font color="#CCCCCC">Windows build</font><font color="#E5E5E5"> they need to be able to</font>

880
00:35:55,339 --> 00:36:00,410
find an asset<font color="#CCCCCC"> that they need to steal</font><font color="#E5E5E5"> of</font>

881
00:35:57,920 --> 00:36:02,150
somebody who's<font color="#E5E5E5"> traveling somewhere to</font>

882
00:36:00,410 --> 00:36:03,828
make sure<font color="#E5E5E5"> that they can then reuse that</font>

883
00:36:02,150 --> 00:36:07,099
credential<font color="#CCCCCC"> to access your</font><font color="#E5E5E5"> network that's</font>

884
00:36:03,829 --> 00:36:08,720
<font color="#E5E5E5">what device has data station did so I</font>

885
00:36:07,099 --> 00:36:10,250
<font color="#E5E5E5">spoke about this so it's early boot</font>

886
00:36:08,720 --> 00:36:12,770
vulnerabilities<font color="#CCCCCC"> you're trying to</font>

887
00:36:10,250 --> 00:36:14,690
mitigate<font color="#E5E5E5"> that</font><font color="#CCCCCC"> you are also trying to</font>

888
00:36:12,770 --> 00:36:17,420
mitigate secure boot<font color="#E5E5E5"> tampering right so</font>

889
00:36:14,690 --> 00:36:19,220
<font color="#E5E5E5">you</font><font color="#CCCCCC"> efi</font><font color="#E5E5E5"> versus bios you want to be able</font>

890
00:36:17,420 --> 00:36:21,829
to detect if somebody<font color="#E5E5E5"> has injected</font>

891
00:36:19,220 --> 00:36:24,169
<font color="#E5E5E5">rootkits into your machine</font><font color="#CCCCCC"> so what it</font>

892
00:36:21,829 --> 00:36:26,540
<font color="#E5E5E5">does is it says signed boot process</font>

893
00:36:24,170 --> 00:36:28,790
somebody modifies my boot process<font color="#E5E5E5"> alarm</font>

894
00:36:26,540 --> 00:36:30,619
my boot has been tampered with<font color="#E5E5E5"> the</font>

895
00:36:28,790 --> 00:36:32,450
device of<font color="#E5E5E5"> the test asian flag gets set</font>

896
00:36:30,619 --> 00:36:35,300
<font color="#E5E5E5">and it says oops</font>

897
00:36:32,450 --> 00:36:36,770
the<font color="#CCCCCC"> machine integrity has been</font><font color="#E5E5E5"> lost call</font>

898
00:36:35,300 --> 00:36:38,990
your security<font color="#E5E5E5"> teams</font><font color="#CCCCCC"> ask</font><font color="#E5E5E5"> them to</font>

899
00:36:36,770 --> 00:36:40,430
<font color="#E5E5E5">investigate here so they that machine</font>

900
00:36:38,990 --> 00:36:42,549
<font color="#CCCCCC">can then no longer be used on</font><font color="#E5E5E5"> your</font>

901
00:36:40,430 --> 00:36:44,450
corporate<font color="#E5E5E5"> network if you have dhaa order</font>

902
00:36:42,550 --> 00:36:45,740
and these are the things that<font color="#E5E5E5"> I spoke</font>

903
00:36:44,450 --> 00:36:47,779
about right<font color="#CCCCCC"> so it checks if the</font>

904
00:36:45,740 --> 00:36:50,120
BitLocker status is enabled<font color="#E5E5E5"> secure boot</font>

905
00:36:47,780 --> 00:36:52,210
is enabled<font color="#E5E5E5"> alam driver now LM driver if</font>

906
00:36:50,120 --> 00:36:54,710
has anyone heard of<font color="#CCCCCC"> Alam</font>

907
00:36:52,210 --> 00:36:57,500
<font color="#E5E5E5">okay so</font><font color="#CCCCCC"> Alam is only launched</font>

908
00:36:54,710 --> 00:37:00,320
anti-malware<font color="#E5E5E5"> and what</font><font color="#CCCCCC"> microsoft did is</font>

909
00:36:57,500 --> 00:37:02,630
it gave om vendors from antivirus

910
00:37:00,320 --> 00:37:04,430
vendors<font color="#E5E5E5"> it gave security vendors an</font>

911
00:37:02,630 --> 00:37:07,630
option to be able<font color="#E5E5E5"> to call</font><font color="#CCCCCC"> into the</font>

912
00:37:04,430 --> 00:37:10,190
Windows kernel and say hey if you are

913
00:37:07,630 --> 00:37:13,430
detecting or if<font color="#CCCCCC"> you are writing any kind</font>

914
00:37:10,190 --> 00:37:16,280
<font color="#E5E5E5">of</font><font color="#CCCCCC"> pre boot driver right before the</font>

915
00:37:13,430 --> 00:37:17,960
operating<font color="#E5E5E5"> system loads</font><font color="#CCCCCC"> I would now be</font><font color="#E5E5E5"> I</font>

916
00:37:16,280 --> 00:37:21,590
would now like<font color="#CCCCCC"> to be able to determine</font>

917
00:37:17,960 --> 00:37:23,870
<font color="#E5E5E5">if any DLL any driver has loaded prior</font>

918
00:37:21,590 --> 00:37:27,470
to the launch of<font color="#E5E5E5"> the OS that is not</font>

919
00:37:23,870 --> 00:37:29,299
signed by Microsoft<font color="#CCCCCC"> and be able</font><font color="#E5E5E5"> to</font>

920
00:37:27,470 --> 00:37:30,890
<font color="#CCCCCC">verify</font><font color="#E5E5E5"> the integrity of those drivers</font>

921
00:37:29,300 --> 00:37:33,170
<font color="#E5E5E5">right that's essentially how root</font><font color="#CCCCCC"> kids</font>

922
00:37:30,890 --> 00:37:34,100
operate so for me to<font color="#E5E5E5"> be able to have a</font>

923
00:37:33,170 --> 00:37:36,380
<font color="#E5E5E5">kernel implant</font>

924
00:37:34,100 --> 00:37:38,180
<font color="#CCCCCC">I should be able</font><font color="#E5E5E5"> to start a driver</font>

925
00:37:36,380 --> 00:37:40,370
<font color="#E5E5E5">before the operating system boots up</font>

926
00:37:38,180 --> 00:37:42,919
<font color="#CCCCCC">Elom allows you to verify the integrity</font>

927
00:37:40,370 --> 00:37:45,440
<font color="#E5E5E5">of those drivers or</font><font color="#CCCCCC"> the boot process</font>

928
00:37:42,920 --> 00:37:46,140
before the OS gets booted<font color="#E5E5E5"> so that's what</font>

929
00:37:45,440 --> 00:37:49,290
<font color="#CCCCCC">alam does</font>

930
00:37:46,140 --> 00:37:49,290
[Music]

931
00:37:49,780 --> 00:38:01,210
then comes the<font color="#CCCCCC"> last</font><font color="#E5E5E5"> bit around</font><font color="#CCCCCC"> jsr right</font>

932
00:37:53,750 --> 00:38:03,380
<font color="#E5E5E5">so</font><font color="#CCCCCC"> threat protection has</font><font color="#E5E5E5"> mrs. light yeah</font>

933
00:38:01,210 --> 00:38:04,970
<font color="#E5E5E5">so there's other bits around around</font>

934
00:38:03,380 --> 00:38:07,369
<font color="#E5E5E5">threat protection so threat protection</font>

935
00:38:04,970 --> 00:38:08,868
has<font color="#E5E5E5"> primarily</font><font color="#CCCCCC"> Windows Defender</font><font color="#E5E5E5"> ATP and</font>

936
00:38:07,369 --> 00:38:10,220
they've started to consolidate a bunch

937
00:38:08,869 --> 00:38:13,280
<font color="#E5E5E5">of features under hundred Windows</font>

938
00:38:10,220 --> 00:38:16,009
<font color="#E5E5E5">Defender ATP so what is ASR ASR</font><font color="#CCCCCC"> is</font>

939
00:38:13,280 --> 00:38:18,500
attack surface reduction you can decide

940
00:38:16,010 --> 00:38:21,680
<font color="#CCCCCC">to implement a set of</font><font color="#E5E5E5"> rules and those</font>

941
00:38:18,500 --> 00:38:24,109
rules say hey if<font color="#E5E5E5"> X conditions are mapped</font>

942
00:38:21,680 --> 00:38:26,330
on my network<font color="#E5E5E5"> or on my host react</font>

943
00:38:24,109 --> 00:38:28,250
differently<font color="#E5E5E5"> and you said to you you can</font>

944
00:38:26,330 --> 00:38:30,259
<font color="#E5E5E5">set in the law as an example what you do</font>

945
00:38:28,250 --> 00:38:31,910
with office what you do with files<font color="#E5E5E5"> when</font>

946
00:38:30,260 --> 00:38:33,619
files<font color="#E5E5E5"> are copied versus when files are</font>

947
00:38:31,910 --> 00:38:37,520
moved<font color="#E5E5E5"> from USB so on and so forth right</font>

948
00:38:33,619 --> 00:38:39,200
<font color="#E5E5E5">so there's a bunch of features there so</font>

949
00:38:37,520 --> 00:38:41,089
<font color="#E5E5E5">as</font><font color="#CCCCCC"> hardware isolation application</font>

950
00:38:39,200 --> 00:38:43,520
control<font color="#E5E5E5"> X</font><font color="#CCCCCC"> PI protection</font><font color="#E5E5E5"> network</font>

951
00:38:41,089 --> 00:38:45,230
protection control folder access ASR

952
00:38:43,520 --> 00:38:47,119
itself<font color="#CCCCCC"> and the network rules right</font>

953
00:38:45,230 --> 00:38:51,500
<font color="#CCCCCC">we'll talk</font><font color="#E5E5E5"> a little bit about what ASR</font>

954
00:38:47,119 --> 00:38:54,890
<font color="#CCCCCC">is so you can write s our rules</font><font color="#E5E5E5"> for</font>

955
00:38:51,500 --> 00:38:57,050
office<font color="#E5E5E5"> for files for network movement</font>

956
00:38:54,890 --> 00:38:58,730
for firewall configurations<font color="#E5E5E5"> so on and so</font>

957
00:38:57,050 --> 00:39:01,310
forth<font color="#E5E5E5"> so let's go through a</font><font color="#CCCCCC"> few of them</font>

958
00:38:58,730 --> 00:39:04,599
right<font color="#E5E5E5"> how does</font><font color="#CCCCCC"> an attack actually</font><font color="#E5E5E5"> look</font>

959
00:39:01,310 --> 00:39:07,849
like<font color="#E5E5E5"> somebody sends you a word file as</font>

960
00:39:04,599 --> 00:39:10,670
an attachment says<font color="#E5E5E5"> absolutely important</font>

961
00:39:07,849 --> 00:39:13,609
can you<font color="#E5E5E5"> look at it right</font><font color="#CCCCCC"> away okay what</font>

962
00:39:10,670 --> 00:39:14,900
is the word file do says enable<font color="#E5E5E5"> macro to</font>

963
00:39:13,609 --> 00:39:16,880
be<font color="#CCCCCC"> able</font><font color="#E5E5E5"> to view the contents of this</font>

964
00:39:14,900 --> 00:39:21,380
file<font color="#E5E5E5"> sure</font>

965
00:39:16,880 --> 00:39:24,470
enable macro what has happened word has

966
00:39:21,380 --> 00:39:26,540
now created a<font color="#E5E5E5"> sub process that is</font>

967
00:39:24,470 --> 00:39:28,430
beaconing out to the attacker as an

968
00:39:26,540 --> 00:39:31,400
example<font color="#E5E5E5"> right I'm making</font><font color="#CCCCCC"> this up so an</font>

969
00:39:28,430 --> 00:39:33,770
attacker sends your file<font color="#E5E5E5"> that has that</font>

970
00:39:31,400 --> 00:39:35,960
has a macro in it the macros only job is

971
00:39:33,770 --> 00:39:38,210
if gets<font color="#CCCCCC"> enabled</font><font color="#E5E5E5"> go and call this version</font>

972
00:39:35,960 --> 00:39:41,690
<font color="#E5E5E5">of code out you want to be able to</font>

973
00:39:38,210 --> 00:39:43,730
detect<font color="#E5E5E5"> if</font><font color="#CCCCCC"> ms word dot exe</font><font color="#E5E5E5"> has a style</font>

974
00:39:41,690 --> 00:39:45,470
process created and<font color="#E5E5E5"> that child process</font>

975
00:39:43,730 --> 00:39:48,890
is beginning<font color="#E5E5E5"> out to the</font><font color="#CCCCCC"> internet that's</font>

976
00:39:45,470 --> 00:39:52,700
one you want to be able<font color="#CCCCCC"> to be to stop</font>

977
00:39:48,890 --> 00:39:54,680
somebody from<font color="#E5E5E5"> injecting into into the</font>

978
00:39:52,700 --> 00:39:57,470
word process right<font color="#CCCCCC"> so everyone is aware</font>

979
00:39:54,680 --> 00:40:00,500
<font color="#CCCCCC">of what the doppelganger</font>

980
00:39:57,470 --> 00:40:03,109
<font color="#E5E5E5">process injection attack was somebody</font>

981
00:40:00,500 --> 00:40:05,780
goes and<font color="#E5E5E5"> looks at</font><font color="#CCCCCC"> msword dot exe herman</font>

982
00:40:03,109 --> 00:40:08,119
better looks at<font color="#CCCCCC"> a</font><font color="#E5E5E5"> carbon black allows</font><font color="#CCCCCC"> ms</font>

983
00:40:05,780 --> 00:40:10,130
over<font color="#E5E5E5"> that exe to run</font><font color="#CCCCCC"> i now want</font><font color="#E5E5E5"> to be</font>

984
00:40:08,119 --> 00:40:12,619
<font color="#E5E5E5">able</font><font color="#CCCCCC"> to inject into ms</font><font color="#E5E5E5"> word dot exe and</font>

985
00:40:10,130 --> 00:40:14,480
run my own<font color="#CCCCCC"> version of malicious code so</font>

986
00:40:12,619 --> 00:40:21,590
you<font color="#E5E5E5"> can detect that or you can prevent</font>

987
00:40:14,480 --> 00:40:24,800
that<font color="#E5E5E5"> actually script rules if so if you</font>

988
00:40:21,590 --> 00:40:27,260
detect any<font color="#E5E5E5"> kind of</font><font color="#CCCCCC"> JavaScript shell</font>

989
00:40:24,800 --> 00:40:30,230
script<font color="#E5E5E5"> partial script running</font><font color="#CCCCCC"> on your</font>

990
00:40:27,260 --> 00:40:32,660
<font color="#E5E5E5">localhost</font><font color="#CCCCCC"> and that has any kind of</font>

991
00:40:30,230 --> 00:40:35,240
<font color="#CCCCCC">obfuscation in it</font><font color="#E5E5E5"> right if you</font><font color="#CCCCCC"> saw</font>

992
00:40:32,660 --> 00:40:37,580
Daniel Powhatan's talk today anyone

993
00:40:35,240 --> 00:40:39,470
doing<font color="#E5E5E5"> any kind of</font><font color="#CCCCCC"> obfuscation in any</font>

994
00:40:37,580 --> 00:40:44,390
script can be<font color="#E5E5E5"> blocked by a simple</font>

995
00:40:39,470 --> 00:40:46,399
configuration<font color="#CCCCCC"> on a SR ya email rules</font><font color="#E5E5E5"> I</font>

996
00:40:44,390 --> 00:40:48,440
spoke<font color="#CCCCCC"> about this there's a very</font><font color="#E5E5E5"> simple</font>

997
00:40:46,400 --> 00:40:50,810
flag if you see an<font color="#CCCCCC"> email when it comes</font>

998
00:40:48,440 --> 00:40:53,090
in and the email contains<font color="#E5E5E5"> an attachment</font>

999
00:40:50,810 --> 00:40:55,340
<font color="#E5E5E5">the moment that attachment is saved to</font>

1000
00:40:53,090 --> 00:40:58,099
your<font color="#E5E5E5"> local</font><font color="#CCCCCC"> system it has a tiny flag set</font>

1001
00:40:55,340 --> 00:41:01,040
that says file originated from the

1002
00:40:58,099 --> 00:41:03,349
<font color="#E5E5E5">internet it's as simple as</font><font color="#CCCCCC"> that you can</font>

1003
00:41:01,040 --> 00:41:05,420
then decide<font color="#E5E5E5"> what</font><font color="#CCCCCC"> happens with that</font><font color="#E5E5E5"> file</font>

1004
00:41:03,349 --> 00:41:07,730
once it's on your<font color="#CCCCCC"> local host</font><font color="#E5E5E5"> can it</font>

1005
00:41:05,420 --> 00:41:09,770
<font color="#CCCCCC">execute</font><font color="#E5E5E5"> if it does execute it executes</font>

1006
00:41:07,730 --> 00:41:11,210
inside<font color="#E5E5E5"> a hyper-v container</font><font color="#CCCCCC"> or is</font><font color="#E5E5E5"> it</font>

1007
00:41:09,770 --> 00:41:12,950
allowed to<font color="#CCCCCC"> call out to the internet so</font>

1008
00:41:11,210 --> 00:41:15,950
on and so forth or<font color="#E5E5E5"> completely stop it</font>

1009
00:41:12,950 --> 00:41:18,379
from executing<font color="#E5E5E5"> and final is what I spoke</font>

1010
00:41:15,950 --> 00:41:21,230
<font color="#CCCCCC">about right</font><font color="#E5E5E5"> so you have</font><font color="#CCCCCC"> a file sitting</font>

1011
00:41:18,380 --> 00:41:24,320
<font color="#E5E5E5">on a USB somebody plugs it in or to run</font>

1012
00:41:21,230 --> 00:41:26,450
runs<font color="#E5E5E5"> and then says okay if auto run is</font>

1013
00:41:24,320 --> 00:41:28,970
allowed<font color="#CCCCCC"> to run from</font><font color="#E5E5E5"> an untrusted USB is</font>

1014
00:41:26,450 --> 00:41:30,799
it allowed<font color="#E5E5E5"> to execute any code any code</font>

1015
00:41:28,970 --> 00:41:32,990
within<font color="#E5E5E5"> the constraints of the user mode</font>

1016
00:41:30,800 --> 00:41:34,760
the answer is yes<font color="#E5E5E5"> or</font><font color="#CCCCCC"> no so these are</font>

1017
00:41:32,990 --> 00:41:36,830
sort<font color="#CCCCCC"> of things that you can do with</font><font color="#E5E5E5"> ASR</font>

1018
00:41:34,760 --> 00:41:39,380
rules<font color="#E5E5E5"> they fall under</font><font color="#CCCCCC"> the exploit</font>

1019
00:41:36,830 --> 00:41:41,180
prevention umbrella<font color="#E5E5E5"> it's also important</font>

1020
00:41:39,380 --> 00:41:43,310
because<font color="#E5E5E5"> most of the attacks are going</font>

1021
00:41:41,180 --> 00:41:45,200
<font color="#CCCCCC">away from file based attacks to file</font><font color="#E5E5E5"> s</font>

1022
00:41:43,310 --> 00:41:47,119
attacks<font color="#E5E5E5"> it's the stuff that's happening</font>

1023
00:41:45,200 --> 00:41:49,730
in memory<font color="#CCCCCC"> you want</font><font color="#E5E5E5"> to be able to detect</font>

1024
00:41:47,119 --> 00:41:51,950
it and<font color="#E5E5E5"> react to it quite quickly</font><font color="#CCCCCC"> so the</font>

1025
00:41:49,730 --> 00:41:54,640
example of word trial process<font color="#E5E5E5"> being</font>

1026
00:41:51,950 --> 00:41:56,960
created in memory<font color="#E5E5E5"> nothing is on disk</font>

1027
00:41:54,640 --> 00:41:58,940
communication comes in macro<font color="#CCCCCC"> executes</font>

1028
00:41:56,960 --> 00:42:01,300
all<font color="#CCCCCC"> of</font><font color="#E5E5E5"> that can be prevented through</font><font color="#CCCCCC"> a</font>

1029
00:41:58,940 --> 00:42:01,300
yourself

1030
00:42:04,560 --> 00:42:11,380
yeah so I don't have much<font color="#E5E5E5"> on this except</font>

1031
00:42:08,830 --> 00:42:14,290
maybe I'll show you a demo around it so

1032
00:42:11,380 --> 00:42:16,780
Windows Defender ATP was Microsoft's

1033
00:42:14,290 --> 00:42:19,300
answer<font color="#E5E5E5"> to to the aging Windows Defender</font>

1034
00:42:16,780 --> 00:42:21,700
technology<font color="#E5E5E5"> right and Windows Defender</font>

1035
00:42:19,300 --> 00:42:23,340
was traditionally antivirus product so

1036
00:42:21,700 --> 00:42:26,740
what it would do is<font color="#E5E5E5"> it would receive</font>

1037
00:42:23,340 --> 00:42:28,900
updates in the form of<font color="#CCCCCC"> patch updates</font><font color="#E5E5E5"> so</font>

1038
00:42:26,740 --> 00:42:30,790
when Windows software would<font color="#E5E5E5"> be</font><font color="#CCCCCC"> updated</font>

1039
00:42:28,900 --> 00:42:33,250
<font color="#E5E5E5">they would also send a malware removal</font>

1040
00:42:30,790 --> 00:42:35,590
package right and Windows Defender would

1041
00:42:33,250 --> 00:42:37,690
take that update and<font color="#E5E5E5"> say huh</font><font color="#CCCCCC"> I send the</font>

1042
00:42:35,590 --> 00:42:39,580
local system<font color="#CCCCCC"> that's potentially unwanted</font>

1043
00:42:37,690 --> 00:42:42,130
<font color="#E5E5E5">software let me go remove it</font>

1044
00:42:39,580 --> 00:42:44,830
that was<font color="#CCCCCC"> defender back in the days and</font>

1045
00:42:42,130 --> 00:42:46,780
so Microsoft said<font color="#CCCCCC"> ok let's do something</font>

1046
00:42:44,830 --> 00:42:49,330
about the<font color="#CCCCCC"> epp space so the endpoint</font>

1047
00:42:46,780 --> 00:42:50,770
protection stack<font color="#E5E5E5"> and I said ok the</font>

1048
00:42:49,330 --> 00:42:54,340
endpoint protection stack is starting to

1049
00:42:50,770 --> 00:42:57,100
age they rewrote<font color="#E5E5E5"> defender with defender</font>

1050
00:42:54,340 --> 00:42:58,750
ATP<font color="#E5E5E5"> and what defender ATP does in</font>

1051
00:42:57,100 --> 00:43:01,690
Windows 10 and now it's back ported<font color="#E5E5E5"> to</font>

1052
00:42:58,750 --> 00:43:04,060
Windows<font color="#E5E5E5"> 7 as well</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> Windows 7 and 8 it</font>

1053
00:43:01,690 --> 00:43:06,310
allows you to<font color="#E5E5E5"> consume the telemetry</font><font color="#CCCCCC"> data</font>

1054
00:43:04,060 --> 00:43:08,920
that Windows<font color="#E5E5E5"> is sending out so if you</font>

1055
00:43:06,310 --> 00:43:11,230
look at Windows 10 Windows 10 has full

1056
00:43:08,920 --> 00:43:13,000
telemetry basic telemetry enabled you

1057
00:43:11,230 --> 00:43:15,010
<font color="#CCCCCC">can decide how much</font><font color="#E5E5E5"> information you send</font>

1058
00:43:13,000 --> 00:43:17,290
to the cloud right and this is<font color="#E5E5E5"> the</font>

1059
00:43:15,010 --> 00:43:19,150
Microsoft<font color="#E5E5E5"> cloud when you enable basic</font>

1060
00:43:17,290 --> 00:43:20,740
telemetry or full telemetry<font color="#E5E5E5"> you're</font>

1061
00:43:19,150 --> 00:43:23,020
sending some out<font color="#E5E5E5"> of information such</font><font color="#CCCCCC"> as</font>

1062
00:43:20,740 --> 00:43:25,089
running<font color="#E5E5E5"> processes how many applications</font>

1063
00:43:23,020 --> 00:43:27,550
are installed<font color="#E5E5E5"> the users who are logged</font>

1064
00:43:25,090 --> 00:43:29,920
in so on and so forth Windows<font color="#CCCCCC"> Defender</font>

1065
00:43:27,550 --> 00:43:33,310
<font color="#CCCCCC">ETP on the other hand if you</font><font color="#E5E5E5"> enable that</font>

1066
00:43:29,920 --> 00:43:36,460
<font color="#E5E5E5">it sends all</font><font color="#CCCCCC"> of this information</font><font color="#E5E5E5"> into</font>

1067
00:43:33,310 --> 00:43:37,930
the<font color="#E5E5E5"> Microsoft cloud</font><font color="#CCCCCC"> ok so you might ask</font>

1068
00:43:36,460 --> 00:43:40,540
<font color="#E5E5E5">why do I want to send all this</font>

1069
00:43:37,930 --> 00:43:42,759
information<font color="#CCCCCC"> to Microsoft ok</font><font color="#E5E5E5"> you could</font>

1070
00:43:40,540 --> 00:43:45,759
decide<font color="#CCCCCC"> to write a kernel implant</font>

1071
00:43:42,760 --> 00:43:48,760
yourself you can decide to<font color="#CCCCCC"> make every</font>

1072
00:43:45,760 --> 00:43:50,830
single<font color="#CCCCCC"> windows subsystem API call</font><font color="#E5E5E5"> map it</font>

1073
00:43:48,760 --> 00:43:53,320
out<font color="#E5E5E5"> identify when a use case is being</font>

1074
00:43:50,830 --> 00:43:55,060
triggered<font color="#E5E5E5"> or you can decide to go and</font>

1075
00:43:53,320 --> 00:43:58,240
build<font color="#E5E5E5"> your</font><font color="#CCCCCC"> own next</font><font color="#E5E5E5"> gen EDR solution</font>

1076
00:43:55,060 --> 00:43:59,740
right or you can probably leverage the

1077
00:43:58,240 --> 00:44:02,979
<font color="#CCCCCC">work that somebody else</font><font color="#E5E5E5"> has</font><font color="#CCCCCC"> done and</font>

1078
00:43:59,740 --> 00:44:04,870
<font color="#E5E5E5">your start right so for us when we</font>

1079
00:44:02,980 --> 00:44:07,480
looked at Windows Defender<font color="#E5E5E5"> ATP you said</font>

1080
00:44:04,870 --> 00:44:08,259
<font color="#CCCCCC">ok</font><font color="#E5E5E5"> you know the the entry</font><font color="#CCCCCC"> barrier is</font>

1081
00:44:07,480 --> 00:44:10,270
quite high

1082
00:44:08,260 --> 00:44:12,400
we don't have skills to<font color="#CCCCCC"> write kernel</font>

1083
00:44:10,270 --> 00:44:13,930
implants<font color="#E5E5E5"> we don't have skills to go out</font>

1084
00:44:12,400 --> 00:44:15,819
<font color="#E5E5E5">and procure an EDR solution that</font>

1085
00:44:13,930 --> 00:44:16,690
<font color="#CCCCCC">gonna</font><font color="#E5E5E5"> sit</font><font color="#CCCCCC"> on top of</font><font color="#E5E5E5"> another EPP solution</font>

1086
00:44:15,819 --> 00:44:20,109
and we're going to<font color="#E5E5E5"> go back</font><font color="#CCCCCC"> to the</font>

1087
00:44:16,690 --> 00:44:21,220
<font color="#E5E5E5">windows</font><font color="#CCCCCC"> 7 days and so</font><font color="#E5E5E5"> we took a bet so</font>

1088
00:44:20,109 --> 00:44:23,170
we went<font color="#CCCCCC"> down the path of looking</font><font color="#E5E5E5"> at</font>

1089
00:44:21,220 --> 00:44:24,520
Windows Defender<font color="#E5E5E5"> ATP so we'll talk</font><font color="#CCCCCC"> a</font>

1090
00:44:23,170 --> 00:44:27,040
little bit<font color="#CCCCCC"> about what Windows different</font>

1091
00:44:24,520 --> 00:44:29,589
to ATP<font color="#E5E5E5"> does but essentially the kernel</font>

1092
00:44:27,040 --> 00:44:32,440
implant tracks every single call is made

1093
00:44:29,589 --> 00:44:34,450
<font color="#E5E5E5">and then writes log and then that log is</font>

1094
00:44:32,440 --> 00:44:39,819
compared against<font color="#CCCCCC"> the things against a</font>

1095
00:44:34,450 --> 00:44:41,379
set of<font color="#CCCCCC"> things</font><font color="#E5E5E5"> that are good</font><font color="#CCCCCC"> or bad so</font>

1096
00:44:39,819 --> 00:44:45,490
<font color="#E5E5E5">this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> what it looks like right so if</font>

1097
00:44:41,380 --> 00:44:46,960
you have the entry space here<font color="#CCCCCC"> that entry</font>

1098
00:44:45,490 --> 00:44:48,669
space could be<font color="#CCCCCC"> anything right</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> you</font>

1099
00:44:46,960 --> 00:44:51,190
could<font color="#E5E5E5"> have your supply chain</font><font color="#CCCCCC"> you could</font>

1100
00:44:48,670 --> 00:44:54,309
<font color="#E5E5E5">have web you could have email USB</font>

1101
00:44:51,190 --> 00:44:56,920
network<font color="#E5E5E5"> traffic and then storage and</font>

1102
00:44:54,309 --> 00:44:59,170
Windows Defender ADP looks at all of<font color="#CCCCCC"> the</font>

1103
00:44:56,920 --> 00:45:01,359
stack and<font color="#E5E5E5"> says what you can do against</font>

1104
00:44:59,170 --> 00:45:01,690
<font color="#E5E5E5">you so that's where the ASR rules come</font>

1105
00:45:01,359 --> 00:45:03,308
in

1106
00:45:01,690 --> 00:45:04,750
that's where smart<font color="#E5E5E5"> screen and network</font>

1107
00:45:03,309 --> 00:45:06,700
protection comes<font color="#E5E5E5"> and smart screen is</font>

1108
00:45:04,750 --> 00:45:08,349
essentially the<font color="#E5E5E5"> first time your machine</font>

1109
00:45:06,700 --> 00:45:10,899
makes a call out<font color="#CCCCCC"> to an IP address</font><font color="#E5E5E5"> or a</font>

1110
00:45:08,349 --> 00:45:12,760
to a<font color="#E5E5E5"> URL on the</font><font color="#CCCCCC"> internet</font><font color="#E5E5E5"> it validates it</font>

1111
00:45:10,900 --> 00:45:14,829
against a list of good versus<font color="#E5E5E5"> buy it as</font>

1112
00:45:12,760 --> 00:45:16,690
simple as<font color="#CCCCCC"> that yeah</font>

1113
00:45:14,829 --> 00:45:17,890
email is<font color="#E5E5E5"> office365 when the built-in</font>

1114
00:45:16,690 --> 00:45:20,260
capabilities<font color="#E5E5E5"> we'll talk a little bit</font>

1115
00:45:17,890 --> 00:45:22,540
<font color="#CCCCCC">about that</font><font color="#E5E5E5"> USB control is quite simple</font>

1116
00:45:20,260 --> 00:45:24,730
<font color="#E5E5E5">so on and so forth</font><font color="#CCCCCC"> and this is where the</font>

1117
00:45:22,540 --> 00:45:27,910
Windows Defender stack is essentially so

1118
00:45:24,730 --> 00:45:29,829
<font color="#E5E5E5">pre run before</font><font color="#CCCCCC"> the file</font><font color="#E5E5E5"> execute on your</font>

1119
00:45:27,910 --> 00:45:31,960
<font color="#E5E5E5">host there's a bunch of things you can</font>

1120
00:45:29,829 --> 00:45:34,990
do<font color="#E5E5E5"> and then this is where the runtime</font>

1121
00:45:31,960 --> 00:45:37,809
stack is so known<font color="#E5E5E5"> behaviors proactive</font>

1122
00:45:34,990 --> 00:45:40,419
behavior scans anti-rootkit<font color="#CCCCCC"> behaviors</font>

1123
00:45:37,809 --> 00:45:42,099
shielding which is<font color="#CCCCCC"> ASR and then behavior</font>

1124
00:45:40,420 --> 00:45:43,930
recording which is which is<font color="#E5E5E5"> FDR right</font>

1125
00:45:42,099 --> 00:45:51,160
<font color="#E5E5E5">these are essentially components of the</font>

1126
00:45:43,930 --> 00:45:53,078
EDR stack advanced<font color="#CCCCCC"> fronting this</font><font color="#E5E5E5"> is the</font>

1127
00:45:51,160 --> 00:45:55,210
other<font color="#E5E5E5"> component which they baked in to</font>

1128
00:45:53,079 --> 00:45:55,780
Windows<font color="#E5E5E5"> Defender ATP why is this</font>

1129
00:45:55,210 --> 00:45:58,540
relevant

1130
00:45:55,780 --> 00:46:00,940
so all this telemetry information that

1131
00:45:58,540 --> 00:46:03,640
is<font color="#E5E5E5"> going out</font><font color="#CCCCCC"> to the cloud it's based on</font>

1132
00:46:00,940 --> 00:46:05,559
on the premise that hey Microsoft is

1133
00:46:03,640 --> 00:46:07,720
<font color="#E5E5E5">going to write a nice shiny rule that is</font>

1134
00:46:05,559 --> 00:46:10,119
<font color="#E5E5E5">going to pick up</font><font color="#CCCCCC"> apt one two three</font><font color="#E5E5E5"> the</font>

1135
00:46:07,720 --> 00:46:11,740
moment it<font color="#E5E5E5"> comes out</font><font color="#CCCCCC"> here what if</font>

1136
00:46:10,119 --> 00:46:13,869
Microsoft only came to<font color="#CCCCCC"> know about</font><font color="#E5E5E5"> it</font>

1137
00:46:11,740 --> 00:46:17,020
<font color="#E5E5E5">six months after you've already known</font>

1138
00:46:13,869 --> 00:46:18,430
about<font color="#E5E5E5"> it yeah and that happens right so</font>

1139
00:46:17,020 --> 00:46:20,650
if you do any kind<font color="#CCCCCC"> of defense you have</font>

1140
00:46:18,430 --> 00:46:22,839
<font color="#E5E5E5">TLP read</font><font color="#CCCCCC"> information available to you</font>

1141
00:46:20,650 --> 00:46:25,000
you have TLP ambit information available

1142
00:46:22,839 --> 00:46:27,509
to<font color="#CCCCCC"> TLP is</font><font color="#E5E5E5"> traffic</font><font color="#CCCCCC"> light</font><font color="#E5E5E5"> protocol it</font>

1143
00:46:25,000 --> 00:46:29,250
<font color="#E5E5E5">essentially is you having certain</font>

1144
00:46:27,510 --> 00:46:31,170
of intelligence which nobody<font color="#E5E5E5"> else does</font>

1145
00:46:29,250 --> 00:46:32,790
and<font color="#CCCCCC"> that might be</font><font color="#E5E5E5"> because you're in a</font>

1146
00:46:31,170 --> 00:46:34,440
particular vertical it's because you

1147
00:46:32,790 --> 00:46:36,330
receive direct intelligence sort of a

1148
00:46:34,440 --> 00:46:37,980
government<font color="#E5E5E5"> body so on and so forth</font>

1149
00:46:36,330 --> 00:46:39,960
or<font color="#E5E5E5"> you're sharing information in some</font>

1150
00:46:37,980 --> 00:46:41,970
sort of<font color="#CCCCCC"> a</font><font color="#E5E5E5"> nice</font><font color="#CCCCCC"> sack this is where</font>

1151
00:46:39,960 --> 00:46:44,700
advanced hunting comes in<font color="#E5E5E5"> right so</font>

1152
00:46:41,970 --> 00:46:47,100
advanced hunting says hey<font color="#E5E5E5"> here is a</font>

1153
00:46:44,700 --> 00:46:48,569
bunch of<font color="#CCCCCC"> information schema</font><font color="#E5E5E5"> companies</font>

1154
00:46:47,100 --> 00:46:50,940
that<font color="#E5E5E5"> you can query you can look at</font>

1155
00:46:48,570 --> 00:46:53,040
<font color="#CCCCCC">network</font><font color="#E5E5E5"> you can look at file you can</font>

1156
00:46:50,940 --> 00:46:55,620
<font color="#E5E5E5">look at registry you can look at process</font>

1157
00:46:53,040 --> 00:46:58,860
events and that schema once exposed

1158
00:46:55,620 --> 00:47:00,990
<font color="#E5E5E5">allows it to be queried</font><font color="#CCCCCC"> based on rules</font>

1159
00:46:58,860 --> 00:47:02,700
that you write<font color="#E5E5E5"> and</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> talked a little</font>

1160
00:47:00,990 --> 00:47:04,950
bit about what<font color="#E5E5E5"> those rules will look</font>

1161
00:47:02,700 --> 00:47:07,919
like but<font color="#CCCCCC"> it essentially</font><font color="#E5E5E5"> an advanced</font>

1162
00:47:04,950 --> 00:47:10,799
hunting rule can say hey if a process

1163
00:47:07,920 --> 00:47:13,890
gets created<font color="#E5E5E5"> in C : / dub dub dub</font>

1164
00:47:10,800 --> 00:47:18,290
and that<font color="#E5E5E5"> process name is called</font><font color="#CCCCCC"> ainít</font>

1165
00:47:13,890 --> 00:47:21,799
<font color="#CCCCCC">Pub dot exe</font><font color="#E5E5E5"> and has a hash of X and</font>

1166
00:47:18,290 --> 00:47:24,480
communicates to an IP address<font color="#E5E5E5"> 1.2.3.4</font>

1167
00:47:21,800 --> 00:47:25,170
<font color="#E5E5E5">triggered an alert for the sock to</font><font color="#CCCCCC"> go</font>

1168
00:47:24,480 --> 00:47:26,910
and pick it<font color="#E5E5E5"> up</font>

1169
00:47:25,170 --> 00:47:29,490
that's called an advanced hunting rule

1170
00:47:26,910 --> 00:47:31,109
and<font color="#E5E5E5"> that is unique</font><font color="#CCCCCC"> to your organization</font>

1171
00:47:29,490 --> 00:47:33,509
it is<font color="#E5E5E5"> unique</font><font color="#CCCCCC"> to your work environment</font>

1172
00:47:31,110 --> 00:47:36,000
and that advanced hunting rule can be

1173
00:47:33,510 --> 00:47:38,220
timed<font color="#E5E5E5"> so</font><font color="#CCCCCC"> you can say as an example</font>

1174
00:47:36,000 --> 00:47:40,410
hey this machine is<font color="#E5E5E5"> not online</font><font color="#CCCCCC"> right now</font>

1175
00:47:38,220 --> 00:47:42,060
so<font color="#E5E5E5"> off my 300 machines on the local</font>

1176
00:47:40,410 --> 00:47:44,399
network<font color="#CCCCCC"> I have a hundred</font><font color="#E5E5E5"> and fifty</font>

1177
00:47:42,060 --> 00:47:46,500
machines online if those machines start

1178
00:47:44,400 --> 00:47:49,320
to come online<font color="#CCCCCC"> in a different time zone</font>

1179
00:47:46,500 --> 00:47:51,410
make sure the rule runs every<font color="#E5E5E5"> 15 minutes</font>

1180
00:47:49,320 --> 00:47:54,150
<font color="#CCCCCC">so that every machine that</font><font color="#E5E5E5"> comes online</font>

1181
00:47:51,410 --> 00:47:55,950
<font color="#E5E5E5">gets that rule fired right that's how</font>

1182
00:47:54,150 --> 00:47:57,480
you<font color="#CCCCCC"> shed you those queries out so</font><font color="#E5E5E5"> that's</font>

1183
00:47:55,950 --> 00:48:04,080
possible again with advanced hunting

1184
00:47:57,480 --> 00:48:05,940
rules and then comes the a IRS right so

1185
00:48:04,080 --> 00:48:08,040
a IRS was essentially an acquisition

1186
00:48:05,940 --> 00:48:09,480
<font color="#CCCCCC">that Microsoft did</font><font color="#E5E5E5"> I think</font><font color="#CCCCCC"> about two</font>

1187
00:48:08,040 --> 00:48:12,540
years<font color="#CCCCCC"> ago from a company called hexa</font>

1188
00:48:09,480 --> 00:48:14,100
<font color="#E5E5E5">tight and a IRS is is Microsoft's answer</font>

1189
00:48:12,540 --> 00:48:15,840
<font color="#E5E5E5">to automated response why is this</font>

1190
00:48:14,100 --> 00:48:19,319
relevant<font color="#E5E5E5"> to you</font><font color="#CCCCCC"> right so if you run a</font>

1191
00:48:15,840 --> 00:48:21,270
sock today<font color="#CCCCCC"> your analysts are going</font><font color="#E5E5E5"> to be</font>

1192
00:48:19,320 --> 00:48:22,710
burdened<font color="#CCCCCC"> by the amount of information</font>

1193
00:48:21,270 --> 00:48:24,840
that's<font color="#CCCCCC"> getting thrown</font><font color="#E5E5E5"> at them through</font>

1194
00:48:22,710 --> 00:48:27,180
<font color="#CCCCCC">the</font><font color="#E5E5E5"> various sensors right and your</font>

1195
00:48:24,840 --> 00:48:29,490
analysts will experience what we call

1196
00:48:27,180 --> 00:48:31,230
alert fatigue<font color="#E5E5E5"> alert fatigue is</font>

1197
00:48:29,490 --> 00:48:33,330
essentially<font color="#E5E5E5"> saying hey I've told my</font>

1198
00:48:31,230 --> 00:48:34,920
users a million times not<font color="#CCCCCC"> to go</font><font color="#E5E5E5"> and plug</font>

1199
00:48:33,330 --> 00:48:37,319
in a USB that is found<font color="#E5E5E5"> in a parking lot</font>

1200
00:48:34,920 --> 00:48:39,330
<font color="#CCCCCC">but they still do</font><font color="#E5E5E5"> it right now I need</font><font color="#CCCCCC"> to</font>

1201
00:48:37,320 --> 00:48:40,539
go<font color="#E5E5E5"> and try</font><font color="#CCCCCC"> out</font><font color="#E5E5E5"> that incident</font><font color="#CCCCCC"> I need to</font>

1202
00:48:39,330 --> 00:48:43,119
go and deal with that<font color="#E5E5E5"> incident</font>

1203
00:48:40,539 --> 00:48:45,489
<font color="#E5E5E5">but a IRS allows you to do is run a</font>

1204
00:48:43,119 --> 00:48:48,219
generic playbook<font color="#E5E5E5"> which essentially says</font>

1205
00:48:45,489 --> 00:48:50,380
hey if you see it a thing happening<font color="#E5E5E5"> on</font><font color="#CCCCCC"> a</font>

1206
00:48:48,219 --> 00:48:54,009
local machine<font color="#CCCCCC"> and that thing looks like</font>

1207
00:48:50,380 --> 00:48:56,439
<font color="#E5E5E5">X go and do</font><font color="#CCCCCC"> Y automatically and that Y</font>

1208
00:48:54,009 --> 00:48:59,529
could<font color="#CCCCCC"> be as</font><font color="#E5E5E5"> simple as a kill this</font>

1209
00:48:56,439 --> 00:49:01,390
<font color="#E5E5E5">process or a quarantine this machine</font>

1210
00:48:59,529 --> 00:49:03,249
<font color="#E5E5E5">make sure it doesn't communicate to</font>

1211
00:49:01,390 --> 00:49:05,469
anything else<font color="#CCCCCC"> and once the machine has</font>

1212
00:49:03,249 --> 00:49:06,968
<font color="#CCCCCC">been quarantined go into ABC</font>

1213
00:49:05,469 --> 00:49:08,619
<font color="#E5E5E5">alright that's traditionally what play</font>

1214
00:49:06,969 --> 00:49:10,539
books are apart<font color="#E5E5E5"> so that's</font><font color="#CCCCCC"> what a IRS</font>

1215
00:49:08,619 --> 00:49:13,390
does out<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the box today</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> only could</font>

1216
00:49:10,539 --> 00:49:15,309
be<font color="#E5E5E5"> to that</font><font color="#CCCCCC"> is it needs</font><font color="#E5E5E5"> Windows 10</font>

1217
00:49:13,390 --> 00:49:20,319
version<font color="#CCCCCC"> 1803</font><font color="#E5E5E5"> and later so that's</font><font color="#CCCCCC"> about</font>

1218
00:49:15,309 --> 00:49:21,459
two versions now last two<font color="#CCCCCC"> versions and</font>

1219
00:49:20,319 --> 00:49:26,288
now we're<font color="#E5E5E5"> getting to the serious stuff</font>

1220
00:49:21,459 --> 00:49:28,269
<font color="#CCCCCC">all</font><font color="#E5E5E5"> right on threat protection</font><font color="#CCCCCC"> yes</font>

1221
00:49:26,289 --> 00:49:30,699
there's a concept called<font color="#E5E5E5"> device guard</font>

1222
00:49:28,269 --> 00:49:32,968
<font color="#E5E5E5">what is device guard right device guard</font>

1223
00:49:30,699 --> 00:49:35,829
was<font color="#E5E5E5"> Microsoft's answer to provide</font>

1224
00:49:32,969 --> 00:49:37,660
detailed security for an asset that<font color="#E5E5E5"> was</font>

1225
00:49:35,829 --> 00:49:40,509
meant to<font color="#E5E5E5"> be run only in lockdown</font><font color="#CCCCCC"> mode</font>

1226
00:49:37,660 --> 00:49:43,569
<font color="#E5E5E5">okay what does that mean it means you</font>

1227
00:49:40,509 --> 00:49:46,029
<font color="#E5E5E5">define what applications run you define</font>

1228
00:49:43,569 --> 00:49:48,130
how those applications run<font color="#E5E5E5"> you define</font>

1229
00:49:46,029 --> 00:49:50,109
where those applications can run<font color="#E5E5E5"> in</font>

1230
00:49:48,130 --> 00:49:52,929
memory<font color="#E5E5E5"> and what parts of the</font><font color="#CCCCCC"> memory they</font>

1231
00:49:50,109 --> 00:49:54,819
can<font color="#E5E5E5"> enhance access you define what the</font>

1232
00:49:52,929 --> 00:49:58,239
trusted boot process<font color="#E5E5E5"> should look like</font>

1233
00:49:54,819 --> 00:50:01,089
<font color="#E5E5E5">for those machines</font><font color="#CCCCCC"> and after you've done</font>

1234
00:49:58,239 --> 00:50:03,989
<font color="#E5E5E5">all</font><font color="#CCCCCC"> of that stuff you go and sign the</font>

1235
00:50:01,089 --> 00:50:06,819
boot process with the key and<font color="#CCCCCC"> that key</font>

1236
00:50:03,989 --> 00:50:08,140
exists within your environment<font color="#CCCCCC"> and what</font>

1237
00:50:06,819 --> 00:50:10,509
you're<font color="#CCCCCC"> trying to</font><font color="#E5E5E5"> do is you're trying to</font>

1238
00:50:08,140 --> 00:50:13,359
<font color="#E5E5E5">lock down a machine to a specific set</font><font color="#CCCCCC"> of</font>

1239
00:50:10,509 --> 00:50:16,089
objectives what could that<font color="#E5E5E5"> machine be so</font>

1240
00:50:13,359 --> 00:50:18,788
as simple<font color="#CCCCCC"> as a machine that does</font>

1241
00:50:16,089 --> 00:50:22,119
printing of tickets at a kiosk<font color="#CCCCCC"> right</font>

1242
00:50:18,789 --> 00:50:23,650
it's only job is to<font color="#CCCCCC"> run one binary</font><font color="#E5E5E5"> it's</font>

1243
00:50:22,119 --> 00:50:24,819
not supposed to<font color="#E5E5E5"> open office files it's</font>

1244
00:50:23,650 --> 00:50:27,009
not supposed to connect to the<font color="#E5E5E5"> internet</font>

1245
00:50:24,819 --> 00:50:28,689
it's<font color="#E5E5E5"> not supposed to scan for DNS</font>

1246
00:50:27,009 --> 00:50:30,789
traffic on the local network<font color="#E5E5E5"> it's not</font>

1247
00:50:28,689 --> 00:50:33,939
<font color="#E5E5E5">supposed to do any of that stuff it runs</font>

1248
00:50:30,789 --> 00:50:36,400
a program<font color="#E5E5E5"> that a program takes input via</font>

1249
00:50:33,939 --> 00:50:38,709
the screen prints<font color="#E5E5E5"> receipt by the printer</font>

1250
00:50:36,400 --> 00:50:41,019
<font color="#E5E5E5">that's it</font><font color="#CCCCCC"> and to be able</font><font color="#E5E5E5"> to lock a</font>

1251
00:50:38,709 --> 00:50:42,879
machine down<font color="#CCCCCC"> is how</font><font color="#E5E5E5"> you use device</font><font color="#CCCCCC"> guard</font>

1252
00:50:41,019 --> 00:50:44,709
<font color="#E5E5E5">so you can go and specify</font><font color="#CCCCCC"> what that does</font>

1253
00:50:42,880 --> 00:50:46,449
I'll read a<font color="#CCCCCC"> little</font><font color="#E5E5E5"> bit of these slides</font>

1254
00:50:44,709 --> 00:50:47,979
because<font color="#E5E5E5"> I might not be able to say it in</font>

1255
00:50:46,449 --> 00:50:49,299
the<font color="#E5E5E5"> same way</font><font color="#CCCCCC"> as</font><font color="#E5E5E5"> as they do on the under</font>

1256
00:50:47,979 --> 00:50:51,339
documentation<font color="#E5E5E5"> but what they're saying</font>

1257
00:50:49,299 --> 00:50:52,839
here is it's<font color="#E5E5E5"> configurable code and</font>

1258
00:50:51,339 --> 00:50:55,089
integrity so

1259
00:50:52,839 --> 00:50:57,038
means you verify the integrity of the

1260
00:50:55,089 --> 00:50:57,788
boot process before the OS is even

1261
00:50:57,039 --> 00:51:00,339
booted

1262
00:50:57,789 --> 00:51:02,229
that's important<font color="#E5E5E5"> it covers the code</font>

1263
00:51:00,339 --> 00:51:03,999
running<font color="#E5E5E5"> in user mode kernel mode</font>

1264
00:51:02,229 --> 00:51:05,979
including hardware and software drivers

1265
00:51:03,999 --> 00:51:09,519
including<font color="#E5E5E5"> those</font><font color="#CCCCCC"> that run as part</font><font color="#E5E5E5"> of</font>

1266
00:51:05,979 --> 00:51:12,339
Windows<font color="#E5E5E5"> what that means is you are able</font>

1267
00:51:09,519 --> 00:51:15,718
<font color="#CCCCCC">to assure</font><font color="#E5E5E5"> the integrity of the asset</font>

1268
00:51:12,339 --> 00:51:18,880
right from pre-boot until post boot

1269
00:51:15,719 --> 00:51:21,849
remember anything<font color="#E5E5E5"> that</font><font color="#CCCCCC"> is pre boot is is</font>

1270
00:51:18,880 --> 00:51:23,380
kernel implant right<font color="#E5E5E5"> is driver based to</font>

1271
00:51:21,849 --> 00:51:26,289
be<font color="#CCCCCC"> able</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> assure the integrity of that</font>

1272
00:51:23,380 --> 00:51:28,359
<font color="#E5E5E5">asset including</font><font color="#CCCCCC"> if somebody tampers with</font>

1273
00:51:26,289 --> 00:51:29,650
the<font color="#E5E5E5"> hardware</font><font color="#CCCCCC"> and installs an additional</font>

1274
00:51:28,359 --> 00:51:32,288
microchip on that keep on that

1275
00:51:29,650 --> 00:51:34,210
motherboard here<font color="#E5E5E5"> if that</font><font color="#CCCCCC"> Hardware</font>

1276
00:51:32,289 --> 00:51:37,660
changes in any shape or<font color="#CCCCCC"> form the</font>

1277
00:51:34,210 --> 00:51:39,849
<font color="#CCCCCC">integrity</font><font color="#E5E5E5"> of that asset is lost you also</font>

1278
00:51:37,660 --> 00:51:41,519
protect it from<font color="#E5E5E5"> somebody getting</font><font color="#CCCCCC"> local</font>

1279
00:51:39,849 --> 00:51:44,769
admin access<font color="#E5E5E5"> on your</font><font color="#CCCCCC"> local machine</font><font color="#E5E5E5"> and</font>

1280
00:51:41,519 --> 00:51:46,359
modifying<font color="#E5E5E5"> the</font><font color="#CCCCCC"> code</font><font color="#E5E5E5"> integrity policy once</font>

1281
00:51:44,769 --> 00:51:49,598
the coding<font color="#E5E5E5"> Tegrity policy has been</font>

1282
00:51:46,359 --> 00:51:52,569
defined and signed you would have to

1283
00:51:49,599 --> 00:51:54,609
modify<font color="#E5E5E5"> it reassign it from your local CA</font>

1284
00:51:52,569 --> 00:51:57,969
server and then be able<font color="#CCCCCC"> to do anything</font>

1285
00:51:54,609 --> 00:52:02,229
with<font color="#CCCCCC"> it and last</font><font color="#E5E5E5"> but not least is at V</font>

1286
00:51:57,969 --> 00:52:04,960
<font color="#E5E5E5">CI right and</font><font color="#CCCCCC"> HV CI is you want</font><font color="#E5E5E5"> to be</font>

1287
00:52:02,229 --> 00:52:07,359
able to<font color="#E5E5E5"> you want</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> be able to</font><font color="#CCCCCC"> protect a</font>

1288
00:52:04,960 --> 00:52:10,180
<font color="#CCCCCC">system from any</font><font color="#E5E5E5"> kind of attack</font><font color="#CCCCCC"> that</font>

1289
00:52:07,359 --> 00:52:12,609
occurs pre OS boot<font color="#CCCCCC"> right</font><font color="#E5E5E5"> so if an</font>

1290
00:52:10,180 --> 00:52:15,009
attacker has modified<font color="#E5E5E5"> a system prios</font>

1291
00:52:12,609 --> 00:52:17,410
boot<font color="#E5E5E5"> there is no way for the operating</font>

1292
00:52:15,009 --> 00:52:19,660
<font color="#E5E5E5">system</font><font color="#CCCCCC"> to be able</font><font color="#E5E5E5"> to detect it and hence</font>

1293
00:52:17,410 --> 00:52:21,670
<font color="#E5E5E5">any of the protection mechanisms on the</font>

1294
00:52:19,660 --> 00:52:25,170
<font color="#E5E5E5">local system can be enabled or disabled</font>

1295
00:52:21,670 --> 00:52:28,089
by this pre OS boot malicious process

1296
00:52:25,170 --> 00:52:30,969
that's where it gets<font color="#E5E5E5"> serious right this</font>

1297
00:52:28,089 --> 00:52:33,069
is a fully locked down state of a

1298
00:52:30,969 --> 00:52:33,670
Windows machine<font color="#E5E5E5"> that an attacker cannot</font>

1299
00:52:33,069 --> 00:52:36,009
compromise

1300
00:52:33,670 --> 00:52:38,200
<font color="#E5E5E5">till date there has been no way to</font>

1301
00:52:36,009 --> 00:52:39,999
<font color="#CCCCCC">compromise a machine that</font><font color="#E5E5E5"> is fully</font>

1302
00:52:38,200 --> 00:52:41,979
locked down with device<font color="#E5E5E5"> car and I see</font>

1303
00:52:39,999 --> 00:52:43,689
why this<font color="#E5E5E5"> is important it is important</font>

1304
00:52:41,979 --> 00:52:47,828
because people<font color="#E5E5E5"> are</font><font color="#CCCCCC"> experimenting with</font>

1305
00:52:43,690 --> 00:52:50,289
<font color="#E5E5E5">this concept there are users and fairly</font>

1306
00:52:47,829 --> 00:52:52,180
<font color="#CCCCCC">well-known field right so manifestation</font>

1307
00:52:50,289 --> 00:52:54,819
if you follow him<font color="#E5E5E5"> on Twitter came out</font>

1308
00:52:52,180 --> 00:52:57,669
and said<font color="#E5E5E5"> hey I am now implementing a</font>

1309
00:52:54,819 --> 00:52:59,558
fully<font color="#CCCCCC"> lockdown asset</font><font color="#E5E5E5"> which has</font>

1310
00:52:57,670 --> 00:53:01,960
<font color="#CCCCCC">absolutely nothing running</font><font color="#E5E5E5"> in terms of</font>

1311
00:52:59,559 --> 00:53:04,299
<font color="#E5E5E5">security except to device guard policy</font>

1312
00:53:01,960 --> 00:53:05,690
which is<font color="#E5E5E5"> properly implemented and it is</font>

1313
00:53:04,299 --> 00:53:07,550
important because

1314
00:53:05,690 --> 00:53:09,620
that shows<font color="#E5E5E5"> the amount of trust that</font>

1315
00:53:07,550 --> 00:53:11,450
exists in a machine that has<font color="#CCCCCC"> been fully</font>

1316
00:53:09,620 --> 00:53:14,779
locked<font color="#CCCCCC"> down</font><font color="#E5E5E5"> correctly with Windows right</font>

1317
00:53:11,450 --> 00:53:17,319
and so device guard<font color="#E5E5E5"> is is my answer</font>

1318
00:53:14,780 --> 00:53:20,360
hopefully<font color="#E5E5E5"> to a lot of the other problems</font>

1319
00:53:17,320 --> 00:53:22,370
<font color="#E5E5E5">well quickly go</font><font color="#CCCCCC"> through this because</font><font color="#E5E5E5"> we</font>

1320
00:53:20,360 --> 00:53:23,810
have about<font color="#E5E5E5"> 10 minutes left so Windows 10</font>

1321
00:53:22,370 --> 00:53:25,700
telemetry data<font color="#E5E5E5"> does a bunch of things</font>

1322
00:53:23,810 --> 00:53:27,980
<font color="#CCCCCC">there's privacy</font><font color="#E5E5E5"> there's privacy</font>

1323
00:53:25,700 --> 00:53:30,020
<font color="#E5E5E5">considerations around it when it does it</font>

1324
00:53:27,980 --> 00:53:32,180
it<font color="#E5E5E5"> sends a bunch of</font><font color="#CCCCCC"> information to the</font>

1325
00:53:30,020 --> 00:53:33,830
cloud and<font color="#E5E5E5"> that</font><font color="#CCCCCC"> cloud information can or</font>

1326
00:53:32,180 --> 00:53:36,529
cannot<font color="#CCCCCC"> be used</font><font color="#E5E5E5"> in a specific way right</font>

1327
00:53:33,830 --> 00:53:38,660
so that's that<font color="#CCCCCC"> now this is this is what</font>

1328
00:53:36,530 --> 00:53:41,120
advanced hunting is about<font color="#E5E5E5"> so I told</font><font color="#CCCCCC"> you</font>

1329
00:53:38,660 --> 00:53:44,569
about the schema<font color="#E5E5E5"> now the schema exposed</font>

1330
00:53:41,120 --> 00:53:46,250
<font color="#E5E5E5">is this it says a lot events process</font>

1331
00:53:44,570 --> 00:53:48,410
creation events<font color="#CCCCCC"> network</font><font color="#E5E5E5"> communication</font>

1332
00:53:46,250 --> 00:53:50,300
events file creation events register

1333
00:53:48,410 --> 00:53:52,580
events<font color="#CCCCCC"> logon image load</font><font color="#E5E5E5"> and</font>

1334
00:53:50,300 --> 00:53:55,040
miscellaneous events this schema is

1335
00:53:52,580 --> 00:53:57,560
exposed<font color="#E5E5E5"> by Microsoft Windows natively if</font>

1336
00:53:55,040 --> 00:53:59,540
you run defender ATP you can then write

1337
00:53:57,560 --> 00:54:01,640
your<font color="#E5E5E5"> own advanced hunting rules so let's</font>

1338
00:53:59,540 --> 00:54:04,220
take this<font color="#CCCCCC"> example</font><font color="#E5E5E5"> somebody</font><font color="#CCCCCC"> wants to</font><font color="#E5E5E5"> be</font>

1339
00:54:01,640 --> 00:54:07,549
able<font color="#E5E5E5"> to use accessibility features so</font>

1340
00:54:04,220 --> 00:54:10,069
set HC<font color="#CCCCCC"> tasks</font><font color="#E5E5E5"> man any of those</font><font color="#CCCCCC"> holds</font>

1341
00:54:07,550 --> 00:54:11,720
<font color="#E5E5E5">old-school attacks you write a simple</font>

1342
00:54:10,070 --> 00:54:13,370
advanced hunting<font color="#CCCCCC"> duel</font><font color="#E5E5E5"> and this is again</font>

1343
00:54:11,720 --> 00:54:15,470
based on<font color="#E5E5E5"> the</font><font color="#CCCCCC"> mitre</font><font color="#E5E5E5"> framework right so</font>

1344
00:54:13,370 --> 00:54:17,720
remember<font color="#CCCCCC"> we said at the</font><font color="#E5E5E5"> start we want a</font>

1345
00:54:15,470 --> 00:54:19,730
mechanism<font color="#CCCCCC"> to</font><font color="#E5E5E5"> be able</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> build</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> defenses</font>

1346
00:54:17,720 --> 00:54:21,290
that are<font color="#E5E5E5"> repeatable right so you look at</font>

1347
00:54:19,730 --> 00:54:23,120
the matter<font color="#E5E5E5"> my tree attack framework you</font>

1348
00:54:21,290 --> 00:54:24,890
identify what the attacks in are using a

1349
00:54:23,120 --> 00:54:26,960
<font color="#CCCCCC">Windows system should look like</font><font color="#E5E5E5"> you</font>

1350
00:54:24,890 --> 00:54:28,580
identify accessibility feature misuse

1351
00:54:26,960 --> 00:54:30,710
and then you go and write<font color="#E5E5E5"> a hunt rule</font>

1352
00:54:28,580 --> 00:54:33,319
against it<font color="#E5E5E5"> right</font><font color="#CCCCCC"> so this is what it</font><font color="#E5E5E5"> is</font>

1353
00:54:30,710 --> 00:54:35,900
<font color="#E5E5E5">it essentially says look at all events</font>

1354
00:54:33,320 --> 00:54:38,540
register events<font color="#E5E5E5"> that occurred one hour</font>

1355
00:54:35,900 --> 00:54:41,290
<font color="#E5E5E5">ago and identify</font><font color="#CCCCCC"> if</font><font color="#E5E5E5"> registry key</font>

1356
00:54:38,540 --> 00:54:44,720
contains<font color="#E5E5E5"> image file execution</font><font color="#CCCCCC"> options</font>

1357
00:54:41,290 --> 00:54:46,220
<font color="#E5E5E5">right so you're hoping that an attacker</font>

1358
00:54:44,720 --> 00:54:49,009
<font color="#E5E5E5">would have gone and modified registry</font>

1359
00:54:46,220 --> 00:54:51,680
entry and that<font color="#E5E5E5"> registry entry was image</font>

1360
00:54:49,010 --> 00:54:53,170
file execution options<font color="#E5E5E5"> and with that go</font>

1361
00:54:51,680 --> 00:54:55,850
and project all of<font color="#CCCCCC"> this information</font>

1362
00:54:53,170 --> 00:54:57,710
<font color="#E5E5E5">that's that's essentially what advanced</font>

1363
00:54:55,850 --> 00:54:59,210
hunting<font color="#CCCCCC"> announced oh</font><font color="#E5E5E5"> you can do the same</font>

1364
00:54:57,710 --> 00:55:01,490
<font color="#CCCCCC">for absurd I'm going to run through</font><font color="#E5E5E5"> this</font>

1365
00:54:59,210 --> 00:55:05,030
very<font color="#E5E5E5"> quickly you can do it for privilege</font>

1366
00:55:01,490 --> 00:55:06,830
escalation<font color="#E5E5E5"> and then there's there's more</font>

1367
00:55:05,030 --> 00:55:08,810
scripts<font color="#E5E5E5"> here right</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> I'll I'll release</font>

1368
00:55:06,830 --> 00:55:10,610
the scripts<font color="#E5E5E5"> release the slides right</font>

1369
00:55:08,810 --> 00:55:12,380
after this talk<font color="#E5E5E5"> so</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> can go pick it up</font>

1370
00:55:10,610 --> 00:55:14,330
<font color="#E5E5E5">there's a bunch of other use cases that</font>

1371
00:55:12,380 --> 00:55:15,680
<font color="#E5E5E5">we've also open sourced there's a bunch</font>

1372
00:55:14,330 --> 00:55:17,420
of other very intelligent people<font color="#E5E5E5"> who are</font>

1373
00:55:15,680 --> 00:55:19,529
<font color="#E5E5E5">working on this so the scripts</font><font color="#CCCCCC"> that you</font>

1374
00:55:17,420 --> 00:55:22,140
can go and run as an example

1375
00:55:19,530 --> 00:55:25,230
if<font color="#CCCCCC"> sir Q</font><font color="#E5E5E5"> tilde code is being running in</font>

1376
00:55:22,140 --> 00:55:26,848
<font color="#E5E5E5">app data so on and so forth and this was</font>

1377
00:55:25,230 --> 00:55:28,590
the a IRS module<font color="#E5E5E5"> that I showed you</font><font color="#CCCCCC"> a</font>

1378
00:55:26,849 --> 00:55:30,920
<font color="#CCCCCC">little bit earlier right</font><font color="#E5E5E5"> so power shall</font>

1379
00:55:28,590 --> 00:55:33,270
drop<font color="#CCCCCC"> to suspicious file</font><font color="#E5E5E5"> in the</font><font color="#CCCCCC"> Machine</font>

1380
00:55:30,920 --> 00:55:36,270
<font color="#E5E5E5">you want to be able to automatically</font>

1381
00:55:33,270 --> 00:55:38,790
triage it<font color="#E5E5E5"> it says hey I see a file</font>

1382
00:55:36,270 --> 00:55:41,369
that's<font color="#CCCCCC"> wrong here</font><font color="#E5E5E5"> and you can go and say</font>

1383
00:55:38,790 --> 00:55:42,779
the recommended step is quadrant II in

1384
00:55:41,369 --> 00:55:45,030
the<font color="#CCCCCC"> machine</font><font color="#E5E5E5"> and go and try and</font>

1385
00:55:42,780 --> 00:55:46,920
<font color="#E5E5E5">quarantine the file right and the</font>

1386
00:55:45,030 --> 00:55:49,050
<font color="#CCCCCC">machine</font><font color="#E5E5E5"> is fully remediated</font><font color="#CCCCCC"> if it works</font>

1387
00:55:46,920 --> 00:55:52,170
<font color="#E5E5E5">correctly</font><font color="#CCCCCC"> so on and so forth</font>

1388
00:55:49,050 --> 00:55:54,840
so what have we<font color="#E5E5E5"> done</font><font color="#CCCCCC"> right we're trying</font>

1389
00:55:52,170 --> 00:55:57,240
to disrupt<font color="#CCCCCC"> the attacker we're trying</font><font color="#E5E5E5"> to</font>

1390
00:55:54,840 --> 00:55:58,980
set an entry barrier<font color="#E5E5E5"> that</font><font color="#CCCCCC"> is high enough</font>

1391
00:55:57,240 --> 00:56:01,919
<font color="#E5E5E5">to demotivate the attacker</font><font color="#CCCCCC"> on your</font>

1392
00:55:58,980 --> 00:56:04,560
network<font color="#E5E5E5"> you have prevented</font><font color="#CCCCCC"> third</font><font color="#E5E5E5"> party</font>

1393
00:56:01,920 --> 00:56:07,290
code from running natively<font color="#E5E5E5"> and the</font>

1394
00:56:04,560 --> 00:56:10,950
attempt<font color="#E5E5E5"> to inject code into a process</font>

1395
00:56:07,290 --> 00:56:13,710
has been<font color="#CCCCCC"> detected attempts</font><font color="#E5E5E5"> to run</font><font color="#CCCCCC"> in</font>

1396
00:56:10,950 --> 00:56:16,200
memory have been<font color="#E5E5E5"> detected all registry</font>

1397
00:56:13,710 --> 00:56:19,020
<font color="#E5E5E5">network file process creation events can</font>

1398
00:56:16,200 --> 00:56:21,270
be<font color="#CCCCCC"> queried now the same state of</font>

1399
00:56:19,020 --> 00:56:23,580
<font color="#E5E5E5">security applies to assets that are on</font>

1400
00:56:21,270 --> 00:56:26,130
<font color="#CCCCCC">campus</font><font color="#E5E5E5"> versus</font><font color="#CCCCCC"> off-campus</font><font color="#E5E5E5"> my asset that</font>

1401
00:56:23,580 --> 00:56:27,990
<font color="#E5E5E5">is traveling</font><font color="#CCCCCC"> here today</font><font color="#E5E5E5"> has no relation</font>

1402
00:56:26,130 --> 00:56:30,000
to<font color="#E5E5E5"> an asset that's sitting on the local</font>

1403
00:56:27,990 --> 00:56:31,859
corporate network the<font color="#E5E5E5"> same amount of</font>

1404
00:56:30,000 --> 00:56:34,530
security applies no<font color="#CCCCCC"> matter where it is</font>

1405
00:56:31,859 --> 00:56:37,348
<font color="#E5E5E5">and hosts are</font><font color="#CCCCCC"> hard-earned pre-boot which</font>

1406
00:56:34,530 --> 00:56:38,880
means early boot tampering etcetera so

1407
00:56:37,349 --> 00:56:42,810
on and so forth<font color="#E5E5E5"> are not</font><font color="#CCCCCC"> possible</font>

1408
00:56:38,880 --> 00:56:45,180
so what nothing the attack cost has gone

1409
00:56:42,810 --> 00:56:47,040
<font color="#E5E5E5">up</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> means they cannot run generic</font>

1410
00:56:45,180 --> 00:56:49,049
run-of-the-mill attacks against<font color="#E5E5E5"> my</font>

1411
00:56:47,040 --> 00:56:50,670
assets<font color="#E5E5E5"> anymore the value of the</font>

1412
00:56:49,050 --> 00:56:52,740
objective<font color="#CCCCCC"> why they compromised my</font>

1413
00:56:50,670 --> 00:56:54,599
network in the first<font color="#CCCCCC"> place probably</font>

1414
00:56:52,740 --> 00:56:56,220
remains the same<font color="#E5E5E5"> but the return on</font>

1415
00:56:54,599 --> 00:56:59,070
investment has<font color="#E5E5E5"> reduced because the cost</font>

1416
00:56:56,220 --> 00:57:02,939
has gone<font color="#E5E5E5"> up</font><font color="#CCCCCC"> and defenders are at least</font>

1417
00:56:59,070 --> 00:57:06,450
in control<font color="#E5E5E5"> and watching so the pure</font>

1418
00:57:02,940 --> 00:57:08,940
profit<font color="#CCCCCC"> maybe not</font><font color="#E5E5E5"> at least</font><font color="#CCCCCC"> the defenders</font>

1419
00:57:06,450 --> 00:57:10,740
have<font color="#CCCCCC"> an opportunity now to</font><font color="#E5E5E5"> level the</font>

1420
00:57:08,940 --> 00:57:12,000
playing field<font color="#CCCCCC"> the red teamers and the</font>

1421
00:57:10,740 --> 00:57:14,339
blue teamers on the same playing field

1422
00:57:12,000 --> 00:57:17,339
and say if you do something<font color="#E5E5E5"> I will watch</font>

1423
00:57:14,339 --> 00:57:18,839
you that's it from me<font color="#CCCCCC"> if you want to</font>

1424
00:57:17,339 --> 00:57:20,910
read a<font color="#E5E5E5"> little bit more</font><font color="#CCCCCC"> there's</font><font color="#E5E5E5"> more</font>

1425
00:57:18,839 --> 00:57:26,029
information<font color="#E5E5E5"> on these slides please go</font>

1426
00:57:20,910 --> 00:57:26,029
and<font color="#E5E5E5"> look it up</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> questions</font>

1427
00:57:30,280 --> 00:57:33,430
thank you

1428
00:57:40,200 --> 00:57:49,029
sorry<font color="#E5E5E5"> more of a comment than a question</font>

1429
00:57:45,360 --> 00:57:51,690
<font color="#CCCCCC">so minor attack</font><font color="#E5E5E5"> also includes that so</font>

1430
00:57:49,030 --> 00:57:55,690
they have Windows Mac Enterprise Linux

1431
00:57:51,690 --> 00:57:59,530
<font color="#E5E5E5">they have mobile and they're about</font><font color="#CCCCCC"> to</font>

1432
00:57:55,690 --> 00:58:03,310
release ICS that<font color="#CCCCCC"> was one thing and</font><font color="#E5E5E5"> then</font>

1433
00:57:59,530 --> 00:58:05,010
the second<font color="#E5E5E5"> thing was that</font><font color="#CCCCCC"> I forget</font><font color="#E5E5E5"> the</font>

1434
00:58:03,310 --> 00:58:08,230
exact acronym but that's<font color="#E5E5E5"> sort of</font>

1435
00:58:05,010 --> 00:58:11,560
heuristic<font color="#E5E5E5"> for hunting for one of the</font>

1436
00:58:08,230 --> 00:58:15,580
attack<font color="#E5E5E5"> behaviors there is a group that's</font>

1437
00:58:11,560 --> 00:58:18,640
<font color="#CCCCCC">working</font><font color="#E5E5E5"> to put together the these type</font>

1438
00:58:15,580 --> 00:58:20,490
of<font color="#E5E5E5"> diseases say analytics yeah in</font>

1439
00:58:18,640 --> 00:58:22,839
<font color="#E5E5E5">pseudocode</font>

1440
00:58:20,490 --> 00:58:24,970
<font color="#E5E5E5">it's quasi-public</font>

1441
00:58:22,840 --> 00:58:28,660
are you<font color="#CCCCCC"> familiar with so that's</font><font color="#E5E5E5"> the</font>

1442
00:58:24,970 --> 00:58:31,750
Sigma project<font color="#E5E5E5"> I think</font><font color="#CCCCCC"> no</font><font color="#E5E5E5"> it's car anyway</font>

1443
00:58:28,660 --> 00:58:33,819
<font color="#CCCCCC">we can talk about</font><font color="#E5E5E5"> that offline</font><font color="#CCCCCC"> but you</font>

1444
00:58:31,750 --> 00:58:36,310
might want to get plugged<font color="#E5E5E5"> in there okay</font>

1445
00:58:33,820 --> 00:58:38,530
<font color="#CCCCCC">yes the Sigma project that you refer so</font>

1446
00:58:36,310 --> 00:58:40,420
a different project which does<font color="#E5E5E5"> something</font>

1447
00:58:38,530 --> 00:58:41,950
quite similar this<font color="#CCCCCC"> is Florian Roth Sigma</font>

1448
00:58:40,420 --> 00:58:44,320
project and what he's trying<font color="#CCCCCC"> to</font><font color="#E5E5E5"> do is</font>

1449
00:58:41,950 --> 00:58:46,509
he's<font color="#CCCCCC"> trying to write hunting code in a</font>

1450
00:58:44,320 --> 00:58:48,880
generic<font color="#E5E5E5"> language that is not applied</font><font color="#CCCCCC"> to</font>

1451
00:58:46,510 --> 00:58:50,500
<font color="#CCCCCC">Splunk does not apply to McAfee found</font>

1452
00:58:48,880 --> 00:58:52,210
<font color="#CCCCCC">stone does not apply to any platform as</font>

1453
00:58:50,500 --> 00:58:53,980
such<font color="#CCCCCC"> it's essentially saying</font><font color="#E5E5E5"> hey if you</font>

1454
00:58:52,210 --> 00:58:57,750
want to detect<font color="#E5E5E5"> X here's what you need to</font>

1455
00:58:53,980 --> 00:58:57,750
do<font color="#CCCCCC"> why but yeah</font>

1456
00:58:58,660 --> 00:59:04,859
somebody is no<font color="#CCCCCC"> okay if</font><font color="#E5E5E5"> they'll thank you</font>

1457
00:59:03,890 --> 00:59:05,370
very much

1458
00:59:04,860 --> 00:59:08,460
[Applause]

1459
00:59:05,370 --> 00:59:08,460
[Music]

