1
00:00:00,140 --> 00:00:02,469
[Applause]

2
00:00:02,540 --> 00:00:07,259
hello everyone thank you<font color="#E5E5E5"> for coming here</font>

3
00:00:05,250 --> 00:00:09,750
still at the end of this day<font color="#E5E5E5"> not</font>

4
00:00:07,259 --> 00:00:11,490
everyone left yet or still flattened<font color="#E5E5E5"> out</font>

5
00:00:09,750 --> 00:00:14,370
from the party yesterday good to see you

6
00:00:11,490 --> 00:00:17,369
all<font color="#E5E5E5"> now we're going to give a talk</font><font color="#CCCCCC"> about</font>

7
00:00:14,370 --> 00:00:20,419
<font color="#E5E5E5">a mirror on</font><font color="#CCCCCC"> the wall and how we use blue</font>

8
00:00:17,369 --> 00:00:23,130
team techniques in<font color="#E5E5E5"> our</font><font color="#CCCCCC"> team operations</font>

9
00:00:20,420 --> 00:00:27,449
<font color="#CCCCCC">it's</font><font color="#E5E5E5"> mark and</font><font color="#CCCCCC"> Marcus she already</font><font color="#E5E5E5"> hurts</font>

10
00:00:23,130 --> 00:00:30,630
<font color="#CCCCCC">Ben my mark</font><font color="#E5E5E5"> mom</font><font color="#CCCCCC"> I started before 2000</font>

11
00:00:27,449 --> 00:00:33,059
<font color="#E5E5E5">with the bank programming COBOL I'm not</font>

12
00:00:30,630 --> 00:00:35,250
yet average developer though I was

13
00:00:33,059 --> 00:00:36,718
reasonable in<font color="#E5E5E5"> writing coded works and</font>

14
00:00:35,250 --> 00:00:38,430
was not that<font color="#E5E5E5"> good in</font><font color="#CCCCCC"> writing code that's</font>

15
00:00:36,719 --> 00:00:41,190
actually<font color="#E5E5E5"> finished and has all the</font><font color="#CCCCCC"> Indian</font>

16
00:00:38,430 --> 00:00:42,989
<font color="#E5E5E5">else's but it got me going and it was</font>

17
00:00:41,190 --> 00:00:45,750
good enough<font color="#CCCCCC"> for me to dive into</font><font color="#E5E5E5"> seeing a</font>

18
00:00:42,989 --> 00:00:47,459
lot<font color="#CCCCCC"> of a</font><font color="#E5E5E5"> lot</font><font color="#CCCCCC"> of other languages</font><font color="#E5E5E5"> and</font>

19
00:00:45,750 --> 00:00:52,019
finally move to offensive security

20
00:00:47,460 --> 00:00:54,090
<font color="#CCCCCC">around 2004</font><font color="#E5E5E5"> worked for a big firm for</font>

21
00:00:52,020 --> 00:00:57,510
four<font color="#E5E5E5"> years and then self-employed after</font>

22
00:00:54,090 --> 00:00:59,760
that and by now I'm<font color="#E5E5E5"> full-time doing red</font>

23
00:00:57,510 --> 00:01:02,519
teaming<font color="#E5E5E5"> and I'm usually the guy that</font>

24
00:00:59,760 --> 00:01:05,009
<font color="#E5E5E5">gets asked can</font><font color="#CCCCCC"> we have</font><font color="#E5E5E5"> 25</font><font color="#CCCCCC"> nuri directors</font>

25
00:01:02,520 --> 00:01:08,430
and<font color="#E5E5E5"> four back-end servers for a new big</font>

26
00:01:05,010 --> 00:01:10,830
<font color="#E5E5E5">op and that's what I built</font><font color="#CCCCCC"> I tend to be</font>

27
00:01:08,430 --> 00:01:12,210
quite lazy so if I type a command<font color="#E5E5E5"> three</font>

28
00:01:10,830 --> 00:01:15,960
times I<font color="#CCCCCC"> think that's more or less</font><font color="#E5E5E5"> the</font>

29
00:01:12,210 --> 00:01:18,689
<font color="#E5E5E5">limit and it's time to script it</font><font color="#CCCCCC"> okay</font>

30
00:01:15,960 --> 00:01:21,658
thank you<font color="#CCCCCC"> thank</font><font color="#E5E5E5"> you all for being here</font>

31
00:01:18,689 --> 00:01:23,429
<font color="#CCCCCC">my name is</font><font color="#E5E5E5"> Mark Smith's somewhat</font>

32
00:01:21,659 --> 00:01:25,140
background<font color="#E5E5E5"> similar background like</font><font color="#CCCCCC"> like</font>

33
00:01:23,430 --> 00:01:26,580
<font color="#E5E5E5">yellow mark</font><font color="#CCCCCC"> we used to work at the same</font>

34
00:01:25,140 --> 00:01:29,159
<font color="#CCCCCC">company now</font><font color="#E5E5E5"> we started</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> new company</font>

35
00:01:26,580 --> 00:01:30,600
<font color="#E5E5E5">solely</font><font color="#CCCCCC"> focused on red teaming my own</font>

36
00:01:29,159 --> 00:01:31,890
<font color="#CCCCCC">background is more</font><font color="#E5E5E5"> on system and network</font>

37
00:01:30,600 --> 00:01:36,298
engineering<font color="#E5E5E5"> I used to do that before</font>

38
00:01:31,890 --> 00:01:38,400
going into offense<font color="#E5E5E5"> around 2006</font><font color="#CCCCCC"> if you're</font>

39
00:01:36,299 --> 00:01:41,369
on Twitter you<font color="#E5E5E5"> might follow me for some</font>

40
00:01:38,400 --> 00:01:43,649
rumblings about<font color="#E5E5E5"> InfoSec sports cars</font>

41
00:01:41,369 --> 00:01:45,360
champagne<font color="#CCCCCC"> all kinds of stuff if you only</font>

42
00:01:43,649 --> 00:01:47,340
want to follow stuff about<font color="#E5E5E5"> our company</font>

43
00:01:45,360 --> 00:01:49,439
<font color="#E5E5E5">what we're tweeting about the red</font>

44
00:01:47,340 --> 00:01:51,000
teaming stuff then you<font color="#CCCCCC"> can follow our</font>

45
00:01:49,439 --> 00:01:53,939
Twitter account<font color="#E5E5E5"> of the company itself</font>

46
00:01:51,000 --> 00:01:56,280
our company outflank<font color="#CCCCCC"> its</font><font color="#E5E5E5"> Dutch niche</font>

47
00:01:53,939 --> 00:01:58,110
company solely focused on red teaming

48
00:01:56,280 --> 00:02:00,780
<font color="#CCCCCC">we've been existing</font><font color="#E5E5E5"> now for two and</font><font color="#CCCCCC"> a</font>

49
00:01:58,110 --> 00:02:02,210
half<font color="#E5E5E5"> years and were solely focused on on</font>

50
00:02:00,780 --> 00:02:08,660
red teaming

51
00:02:02,210 --> 00:02:11,120
which is also the<font color="#E5E5E5"> topic of today sadly</font>

52
00:02:08,660 --> 00:02:14,150
this is still official of how most

53
00:02:11,120 --> 00:02:16,390
people both<font color="#E5E5E5"> providers as</font><font color="#CCCCCC"> well as</font>

54
00:02:14,150 --> 00:02:19,820
customers tend to see your head<font color="#CCCCCC"> teeming</font>

55
00:02:16,390 --> 00:02:22,489
full<font color="#CCCCCC"> no-limits wrecking ball</font>

56
00:02:19,820 --> 00:02:25,010
type of engagement everything is allows

57
00:02:22,490 --> 00:02:26,870
all for the same goal to<font color="#E5E5E5"> get</font><font color="#CCCCCC"> to the</font>

58
00:02:25,010 --> 00:02:30,170
crown jewels<font color="#E5E5E5"> whatever means are</font>

59
00:02:26,870 --> 00:02:31,850
<font color="#CCCCCC">necessary so</font><font color="#E5E5E5"> every means</font><font color="#CCCCCC"> necessary is it</font>

60
00:02:30,170 --> 00:02:33,980
put into<font color="#E5E5E5"> the engagements</font><font color="#CCCCCC"> that can be</font>

61
00:02:31,850 --> 00:02:37,640
from from regular fishing<font color="#E5E5E5"> to physical</font>

62
00:02:33,980 --> 00:02:39,709
access<font color="#CCCCCC"> to two very fancy</font><font color="#E5E5E5"> exporting to</font>

63
00:02:37,640 --> 00:02:44,839
all kinds of different techniques just

64
00:02:39,709 --> 00:02:46,970
<font color="#E5E5E5">solely for the end goal the</font><font color="#CCCCCC"> end result</font>

65
00:02:44,840 --> 00:02:50,360
<font color="#E5E5E5">most of</font><font color="#CCCCCC"> the time is just full knockout</font>

66
00:02:46,970 --> 00:02:53,030
<font color="#E5E5E5">for the blue team which can help for</font>

67
00:02:50,360 --> 00:02:54,920
making an impact but it's not always per

68
00:02:53,030 --> 00:02:56,420
se really<font color="#E5E5E5"> helpful</font><font color="#CCCCCC"> for the</font><font color="#E5E5E5"> blue team</font>

69
00:02:54,920 --> 00:02:58,458
itself<font color="#E5E5E5"> because well they got knocked</font>

70
00:02:56,420 --> 00:03:01,250
<font color="#CCCCCC">down</font><font color="#E5E5E5"> and not having trouble</font><font color="#CCCCCC"> cutting</font><font color="#E5E5E5"> up</font>

71
00:02:58,459 --> 00:03:04,610
the learning<font color="#E5E5E5"> effects of such a type</font><font color="#CCCCCC"> of</font>

72
00:03:01,250 --> 00:03:06,140
attachments really not not<font color="#E5E5E5"> that big so</font>

73
00:03:04,610 --> 00:03:07,970
that's<font color="#CCCCCC"> a</font><font color="#E5E5E5"> really big downside and and</font>

74
00:03:06,140 --> 00:03:10,790
that's<font color="#E5E5E5"> not the way how we see red</font>

75
00:03:07,970 --> 00:03:13,459
teaming<font color="#CCCCCC"> we'd like to see red teaming</font>

76
00:03:10,790 --> 00:03:17,109
more as this as boxing as a sparring

77
00:03:13,459 --> 00:03:21,140
trying to help<font color="#E5E5E5"> the blue team to improve</font>

78
00:03:17,110 --> 00:03:24,160
<font color="#E5E5E5">it's still real punches real movements</font>

79
00:03:21,140 --> 00:03:26,630
real combos<font color="#CCCCCC"> the punches still hurt</font><font color="#E5E5E5"> but</font>

80
00:03:24,160 --> 00:03:29,269
<font color="#E5E5E5">more in exercise environment where we</font>

81
00:03:26,630 --> 00:03:32,810
tune our level to the<font color="#E5E5E5"> level of the blue</font>

82
00:03:29,269 --> 00:03:35,480
team in a<font color="#E5E5E5"> way that they are excelled in</font>

83
00:03:32,810 --> 00:03:38,890
their<font color="#E5E5E5"> own expertise we try to bring them</font>

84
00:03:35,480 --> 00:03:38,890
up bring them<font color="#E5E5E5"> up a level</font>

85
00:03:40,030 --> 00:03:48,079
so it's fundamentally<font color="#CCCCCC"> different to put</font>

86
00:03:46,160 --> 00:03:49,430
this into perspective how we see the red

87
00:03:48,079 --> 00:03:52,100
teaming that we do compared<font color="#E5E5E5"> to other</font>

88
00:03:49,430 --> 00:03:53,780
types<font color="#E5E5E5"> of security</font><font color="#CCCCCC"> services</font><font color="#E5E5E5"> this is our</font>

89
00:03:52,100 --> 00:03:55,820
view does<font color="#CCCCCC"> not per se that were saying</font>

90
00:03:53,780 --> 00:03:58,010
this is<font color="#E5E5E5"> the truth but just to give you</font>

91
00:03:55,820 --> 00:04:00,230
an understanding<font color="#E5E5E5"> of how we see things if</font>

92
00:03:58,010 --> 00:04:02,570
you would compare<font color="#CCCCCC"> hurt him in to pen</font>

93
00:04:00,230 --> 00:04:05,840
<font color="#CCCCCC">testing</font><font color="#E5E5E5"> pen testing would be way more</font>

94
00:04:02,570 --> 00:04:08,180
efficient<font color="#CCCCCC"> it would be less realistic</font><font color="#E5E5E5"> so</font>

95
00:04:05,840 --> 00:04:09,980
you can divide within<font color="#CCCCCC"> a few</font><font color="#E5E5E5"> axis</font>

96
00:04:08,180 --> 00:04:12,829
realistic versus efficient and

97
00:04:09,980 --> 00:04:15,230
assessment versus exercise<font color="#CCCCCC"> purple</font>

98
00:04:12,829 --> 00:04:15,770
teaming for example would<font color="#CCCCCC"> be way more of</font>

99
00:04:15,230 --> 00:04:20,209
<font color="#CCCCCC">it</font>

100
00:04:15,770 --> 00:04:22,430
exercise and more<font color="#E5E5E5"> efficient</font><font color="#CCCCCC"> we're ahead</font>

101
00:04:20,209 --> 00:04:23,870
teaming would be way more realistic<font color="#CCCCCC"> the</font>

102
00:04:22,430 --> 00:04:25,430
same goes for hacking<font color="#CCCCCC"> to it cause and</font>

103
00:04:23,870 --> 00:04:27,710
the same goes<font color="#CCCCCC"> for see best see versus</font>

104
00:04:25,430 --> 00:04:31,250
<font color="#CCCCCC">the red teaming framework</font><font color="#E5E5E5"> from the Bank</font>

105
00:04:27,710 --> 00:04:33,440
of England<font color="#E5E5E5"> which tend to do Hill we tend</font>

106
00:04:31,250 --> 00:04:36,410
to do many<font color="#E5E5E5"> Red Team engagements</font><font color="#CCCCCC"> via the</font>

107
00:04:33,440 --> 00:04:38,210
type of<font color="#CCCCCC"> framework</font><font color="#E5E5E5"> so where we put that</font>

108
00:04:36,410 --> 00:04:40,730
evening<font color="#E5E5E5"> the same goes for type of it's</font>

109
00:04:38,210 --> 00:04:42,380
more realistic compared as the way<font color="#E5E5E5"> we</font>

110
00:04:40,730 --> 00:04:45,170
see it compared to<font color="#E5E5E5"> the</font><font color="#CCCCCC"> other other</font>

111
00:04:42,380 --> 00:04:47,080
<font color="#CCCCCC">screen works you see also</font><font color="#E5E5E5"> that kind of</font>

112
00:04:45,170 --> 00:04:49,760
fades up that gives us the<font color="#E5E5E5"> opportunity</font>

113
00:04:47,080 --> 00:04:52,099
during an engagement<font color="#E5E5E5"> during a teaming to</font>

114
00:04:49,760 --> 00:04:55,909
either make a second<font color="#E5E5E5"> scenario or third</font>

115
00:04:52,100 --> 00:04:58,460
scenario where we<font color="#E5E5E5"> are leveling down so</font>

116
00:04:55,910 --> 00:05:00,530
we are<font color="#E5E5E5"> easier cause it also allows us</font>

117
00:04:58,460 --> 00:05:03,169
during engagement to get caught<font color="#CCCCCC"> we might</font>

118
00:05:00,530 --> 00:05:05,150
fly in under<font color="#CCCCCC"> the radar try to get our</font>

119
00:05:03,170 --> 00:05:06,590
nice channels up and running<font color="#E5E5E5"> try to get</font>

120
00:05:05,150 --> 00:05:08,450
for the goal and<font color="#CCCCCC"> try</font><font color="#E5E5E5"> to go for the gold</font>

121
00:05:06,590 --> 00:05:11,030
<font color="#CCCCCC">in the end if we're not caught just</font>

122
00:05:08,450 --> 00:05:12,560
scale up<font color="#CCCCCC"> our visibility drop me</font><font color="#E5E5E5"> me cuts</font>

123
00:05:11,030 --> 00:05:14,030
the<font color="#E5E5E5"> tax on a</font><font color="#CCCCCC"> domain</font><font color="#E5E5E5"> controller</font><font color="#CCCCCC"> let's see</font>

124
00:05:12,560 --> 00:05:15,770
what happens<font color="#CCCCCC"> that kind of thing we</font>

125
00:05:14,030 --> 00:05:17,780
really think this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> must-have for a</font>

126
00:05:15,770 --> 00:05:21,140
teaming if you<font color="#E5E5E5"> guys I'm not sure how</font>

127
00:05:17,780 --> 00:05:23,020
many red team is on or in a room and

128
00:05:21,140 --> 00:05:25,219
<font color="#CCCCCC">through blue teamers</font>

129
00:05:23,020 --> 00:05:27,140
now I would say keep keep challenging

130
00:05:25,220 --> 00:05:29,570
<font color="#E5E5E5">the parties that bring red teaming to</font>

131
00:05:27,140 --> 00:05:32,690
you as well I think if during<font color="#E5E5E5"> a red team</font>

132
00:05:29,570 --> 00:05:36,050
there's no detection<font color="#E5E5E5"> and the red team</font>

133
00:05:32,690 --> 00:05:36,740
failed<font color="#E5E5E5"> yep most people tend to see it</font>

134
00:05:36,050 --> 00:05:38,870
the other<font color="#E5E5E5"> way around</font>

135
00:05:36,740 --> 00:05:40,340
- red team makes it dance if they can

136
00:05:38,870 --> 00:05:42,850
get to<font color="#CCCCCC"> the crown jewels</font><font color="#E5E5E5"> without being</font>

137
00:05:40,340 --> 00:05:45,739
caught but where<font color="#E5E5E5"> if the lesson in that</font>

138
00:05:42,850 --> 00:05:51,470
<font color="#E5E5E5">so red team with no detection is a</font><font color="#CCCCCC"> fill</font>

139
00:05:45,740 --> 00:05:54,650
for the<font color="#E5E5E5"> red team as well so</font><font color="#CCCCCC"> balanced</font>

140
00:05:51,470 --> 00:05:57,470
I tried searching<font color="#E5E5E5"> for abundancy thing</font>

141
00:05:54,650 --> 00:06:00,200
<font color="#E5E5E5">what</font><font color="#CCCCCC"> random</font><font color="#E5E5E5"> blue</font><font color="#CCCCCC"> so I found this the</font>

142
00:05:57,470 --> 00:06:03,530
reason<font color="#CCCCCC"> why it is in here</font><font color="#E5E5E5"> is that in</font>

143
00:06:00,200 --> 00:06:04,880
every<font color="#CCCCCC"> engagement we balance</font><font color="#E5E5E5"> our level to</font>

144
00:06:03,530 --> 00:06:07,309
the blue team

145
00:06:04,880 --> 00:06:10,000
and during time we see blue team's

146
00:06:07,310 --> 00:06:13,600
becoming more mature<font color="#E5E5E5"> and they're trying</font>

147
00:06:10,000 --> 00:06:16,250
thankfully adapting new<font color="#E5E5E5"> adagios new</font>

148
00:06:13,600 --> 00:06:18,200
<font color="#E5E5E5">theories like assume compromise so the</font>

149
00:06:16,250 --> 00:06:19,730
blue<font color="#CCCCCC"> team's are</font><font color="#E5E5E5"> there are</font><font color="#CCCCCC"> know</font><font color="#E5E5E5"> that they</font>

150
00:06:18,200 --> 00:06:21,380
know that<font color="#E5E5E5"> they don't</font><font color="#CCCCCC"> need</font><font color="#E5E5E5"> to solely</font>

151
00:06:19,730 --> 00:06:22,670
<font color="#CCCCCC">focus on the external</font><font color="#E5E5E5"> perimeter</font><font color="#CCCCCC"> but also</font>

152
00:06:21,380 --> 00:06:25,290
focus<font color="#E5E5E5"> on the inside of</font><font color="#CCCCCC"> the internal</font>

153
00:06:22,670 --> 00:06:28,440
<font color="#CCCCCC">network</font><font color="#E5E5E5"> assume come from</font>

154
00:06:25,290 --> 00:06:30,150
so the same<font color="#E5E5E5"> goes for the attackers</font>

155
00:06:28,440 --> 00:06:33,900
playground<font color="#CCCCCC"> ready use the internal</font>

156
00:06:30,150 --> 00:06:36,510
<font color="#CCCCCC">network to set up traps</font><font color="#E5E5E5"> where the</font>

157
00:06:33,900 --> 00:06:38,250
attacker can can be<font color="#E5E5E5"> caught</font><font color="#CCCCCC"> it slows us</font>

158
00:06:36,510 --> 00:06:40,650
<font color="#CCCCCC">down which are good things so the blue</font>

159
00:06:38,250 --> 00:06:42,540
teams are getting<font color="#CCCCCC"> more mature and the</font>

160
00:06:40,650 --> 00:06:44,340
same time the red teamers<font color="#E5E5E5"> are having a</font>

161
00:06:42,540 --> 00:06:46,200
<font color="#E5E5E5">more difficult time because</font><font color="#CCCCCC"> there are</font>

162
00:06:44,340 --> 00:06:47,849
more demands to<font color="#CCCCCC"> the red teaming being</font>

163
00:06:46,200 --> 00:06:50,060
performed<font color="#E5E5E5"> multiple multiple scenarios</font>

164
00:06:47,850 --> 00:06:53,460
bigger engagements multi team member of

165
00:06:50,060 --> 00:06:56,190
bigger infrastructures the team's job<font color="#CCCCCC"> is</font>

166
00:06:53,460 --> 00:06:59,669
becoming<font color="#E5E5E5"> harder which is a good thing</font><font color="#CCCCCC"> by</font>

167
00:06:56,190 --> 00:07:01,740
the<font color="#E5E5E5"> way the last thing that we want</font><font color="#CCCCCC"> to</font>

168
00:06:59,670 --> 00:07:05,580
do during a red team engagement is that

169
00:07:01,740 --> 00:07:07,320
we are being caught and<font color="#E5E5E5"> immediately</font><font color="#CCCCCC"> the</font>

170
00:07:05,580 --> 00:07:10,560
blue<font color="#E5E5E5"> team</font><font color="#CCCCCC"> thinks well this is not a true</font>

171
00:07:07,320 --> 00:07:11,849
attack this is a teaming so we should

172
00:07:10,560 --> 00:07:13,650
not<font color="#E5E5E5"> be going into the stress mode</font>

173
00:07:11,850 --> 00:07:14,940
because it's<font color="#E5E5E5"> just a</font><font color="#CCCCCC"> red teaming and just</font>

174
00:07:13,650 --> 00:07:17,549
<font color="#E5E5E5">an engagement we don't want to pull</font>

175
00:07:14,940 --> 00:07:19,980
<font color="#CCCCCC">all-nighters to</font><font color="#E5E5E5"> do the investigation</font><font color="#CCCCCC"> so</font>

176
00:07:17,550 --> 00:07:21,810
when we are<font color="#CCCCCC"> being caught we need to</font>

177
00:07:19,980 --> 00:07:24,150
think about<font color="#E5E5E5"> the way that were being</font>

178
00:07:21,810 --> 00:07:26,130
caught in order to stay<font color="#E5E5E5"> still to get to</font>

179
00:07:24,150 --> 00:07:28,890
<font color="#CCCCCC">that stress level at the blue</font><font color="#E5E5E5"> team</font><font color="#CCCCCC"> side</font>

180
00:07:26,130 --> 00:07:30,450
<font color="#E5E5E5">we're sort of planning being caught and</font>

181
00:07:28,890 --> 00:07:32,219
also planning<font color="#E5E5E5"> on how to move forward</font>

182
00:07:30,450 --> 00:07:33,960
<font color="#CCCCCC">from there</font><font color="#E5E5E5"> because in our opinion</font><font color="#CCCCCC"> when</font>

183
00:07:32,220 --> 00:07:36,120
we get caught or we when we get seen

184
00:07:33,960 --> 00:07:39,659
part of the operation<font color="#CCCCCC"> gets seen that's</font>

185
00:07:36,120 --> 00:07:41,190
where the game starts<font color="#CCCCCC"> yeah so we need to</font>

186
00:07:39,660 --> 00:07:44,040
<font color="#E5E5E5">level up we need to become more mature</font>

187
00:07:41,190 --> 00:07:46,590
we need to be more<font color="#E5E5E5"> in control</font><font color="#CCCCCC"> so that</font>

188
00:07:44,040 --> 00:07:49,590
led to<font color="#E5E5E5"> a few questions</font><font color="#CCCCCC"> for that we asked</font>

189
00:07:46,590 --> 00:07:51,840
ourselves<font color="#E5E5E5"> how can we</font><font color="#CCCCCC"> become more in</font>

190
00:07:49,590 --> 00:07:55,619
<font color="#CCCCCC">control of our</font><font color="#E5E5E5"> ever-expanding bigger</font>

191
00:07:51,840 --> 00:07:57,210
infrastructures and if we're<font color="#E5E5E5"> more in</font>

192
00:07:55,620 --> 00:07:59,720
<font color="#CCCCCC">control</font><font color="#E5E5E5"> are the possibilities that we</font>

193
00:07:57,210 --> 00:08:02,510
<font color="#E5E5E5">can detect that the blue</font><font color="#CCCCCC"> team</font><font color="#E5E5E5"> is</font>

194
00:07:59,720 --> 00:08:05,850
detecting us can we see that<font color="#E5E5E5"> in advance</font>

195
00:08:02,510 --> 00:08:08,130
and can we use<font color="#CCCCCC"> that knowledge</font><font color="#E5E5E5"> to maybe</font>

196
00:08:05,850 --> 00:08:12,510
extend<font color="#E5E5E5"> the whole the</font><font color="#CCCCCC"> whole operation and</font>

197
00:08:08,130 --> 00:08:16,409
make a better operation<font color="#E5E5E5"> that got us</font>

198
00:08:12,510 --> 00:08:18,270
thinking and to<font color="#CCCCCC"> covert at all we're</font>

199
00:08:16,410 --> 00:08:20,490
<font color="#CCCCCC">gonna</font><font color="#E5E5E5"> to answer this question</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> gonna</font>

200
00:08:18,270 --> 00:08:22,049
cover the three<font color="#E5E5E5"> topics the</font><font color="#CCCCCC"> advanced</font>

201
00:08:20,490 --> 00:08:24,390
<font color="#CCCCCC">infrastructures that</font><font color="#E5E5E5"> we are using when a</font>

202
00:08:22,050 --> 00:08:27,210
<font color="#E5E5E5">red teaming how to monitor all the</font>

203
00:08:24,390 --> 00:08:32,490
relevant<font color="#E5E5E5"> events and how to do the</font>

204
00:08:27,210 --> 00:08:35,520
analysis detection yes before<font color="#CCCCCC"> we dive</font>

205
00:08:32,490 --> 00:08:37,470
into this<font color="#E5E5E5"> detection and how that work</font>

206
00:08:35,520 --> 00:08:39,630
I think we first have<font color="#E5E5E5"> to cover some</font>

207
00:08:37,470 --> 00:08:41,250
basics on<font color="#E5E5E5"> what does regime</font>

208
00:08:39,630 --> 00:08:43,620
infrastructure actually look<font color="#CCCCCC"> like</font><font color="#E5E5E5"> as</font>

209
00:08:41,250 --> 00:08:45,420
most people<font color="#CCCCCC"> pentesting they have their</font>

210
00:08:43,620 --> 00:08:47,580
<font color="#E5E5E5">laptop</font><font color="#CCCCCC"> idly</font><font color="#E5E5E5"> with a collie installation</font>

211
00:08:45,420 --> 00:08:49,079
that's<font color="#E5E5E5"> and more</font><font color="#CCCCCC"> becoming</font><font color="#E5E5E5"> more or less</font>

212
00:08:47,580 --> 00:08:51,480
the base is where you start doing<font color="#E5E5E5"> pen</font>

213
00:08:49,080 --> 00:08:54,030
tests<font color="#E5E5E5"> but as we really see</font><font color="#CCCCCC"> that red</font>

214
00:08:51,480 --> 00:08:55,830
teaming is a totally different<font color="#CCCCCC"> kind of</font>

215
00:08:54,030 --> 00:08:58,829
game<font color="#E5E5E5"> you will also see that there's more</font>

216
00:08:55,830 --> 00:09:01,230
components involved<font color="#CCCCCC"> I think the typical</font>

217
00:08:58,830 --> 00:09:03,900
components<font color="#CCCCCC"> every one every red team</font>

218
00:09:01,230 --> 00:09:06,570
should use no<font color="#CCCCCC"> use there's a back-end</font>

219
00:09:03,900 --> 00:09:09,569
server<font color="#E5E5E5"> the C to the team server or</font><font color="#CCCCCC"> the</font>

220
00:09:06,570 --> 00:09:11,910
command and control server where<font color="#CCCCCC"> the</font>

221
00:09:09,570 --> 00:09:13,770
main operation takes place<font color="#CCCCCC"> we tend to</font>

222
00:09:11,910 --> 00:09:15,209
use a lot of<font color="#CCCCCC"> cobble</font><font color="#E5E5E5"> strike so in the</font>

223
00:09:13,770 --> 00:09:18,449
rest<font color="#E5E5E5"> of this presentation you'll see</font>

224
00:09:15,210 --> 00:09:21,450
that once we're talking<font color="#CCCCCC"> about C 2</font>

225
00:09:18,450 --> 00:09:23,400
traffic or C 2 servers<font color="#E5E5E5"> it's often aimed</font>

226
00:09:21,450 --> 00:09:26,430
for<font color="#CCCCCC"> call strike but the same would go</font>

227
00:09:23,400 --> 00:09:28,199
for<font color="#CCCCCC"> PowerShell Empire</font><font color="#E5E5E5"> puppy and all the</font>

228
00:09:26,430 --> 00:09:34,650
other parties and<font color="#CCCCCC"> all the other products</font>

229
00:09:28,200 --> 00:09:44,760
<font color="#CCCCCC">any couple strike users here tools often</font>

230
00:09:34,650 --> 00:09:46,590
<font color="#E5E5E5">use PowerShell</font><font color="#CCCCCC"> empire</font><font color="#E5E5E5"> puppy you need to</font>

231
00:09:44,760 --> 00:09:48,180
have your service to have<font color="#CCCCCC"> your incoming</font>

232
00:09:46,590 --> 00:09:49,740
<font color="#CCCCCC">connections</font><font color="#E5E5E5"> and also I</font><font color="#CCCCCC"> think it's quite</font>

233
00:09:48,180 --> 00:09:52,170
common<font color="#E5E5E5"> at least I hope it's quite common</font>

234
00:09:49,740 --> 00:09:54,660
by now that everyone<font color="#CCCCCC"> uses redirect errs</font>

235
00:09:52,170 --> 00:09:57,300
in their infrastructure<font color="#CCCCCC"> the main phone</font>

236
00:09:54,660 --> 00:09:58,829
ring is it technique<font color="#CCCCCC"> often used</font><font color="#E5E5E5"> what's</font>

237
00:09:57,300 --> 00:10:01,140
possible through Google<font color="#E5E5E5"> that changed</font>

238
00:09:58,830 --> 00:10:03,360
some<font color="#CCCCCC"> things there</font><font color="#E5E5E5"> and Amazon is still</font>

239
00:10:01,140 --> 00:10:06,060
possible and<font color="#E5E5E5"> it's a bit shifting</font>

240
00:10:03,360 --> 00:10:08,570
technique it might be still possible in

241
00:10:06,060 --> 00:10:14,819
some<font color="#E5E5E5"> certain cases maybe hint hint</font><font color="#CCCCCC"> and</font>

242
00:10:08,570 --> 00:10:18,060
<font color="#E5E5E5">Google I think everyone deploying</font><font color="#CCCCCC"> red</font>

243
00:10:14,820 --> 00:10:20,580
team first needs to engaged<font color="#E5E5E5"> their victim</font>

244
00:10:18,060 --> 00:10:21,839
<font color="#E5E5E5">and you start on the most social level</font>

245
00:10:20,580 --> 00:10:23,970
we tend to do a lot of LinkedIn

246
00:10:21,840 --> 00:10:26,520
identities or email accounts that<font color="#E5E5E5"> we can</font>

247
00:10:23,970 --> 00:10:28,740
use<font color="#CCCCCC"> to initiate contact</font><font color="#E5E5E5"> without giving</font>

248
00:10:26,520 --> 00:10:31,199
away who we are of course and then the

249
00:10:28,740 --> 00:10:33,690
<font color="#CCCCCC">one that might sound real</font><font color="#E5E5E5"> normal we use</font>

250
00:10:31,200 --> 00:10:35,940
a VPN<font color="#E5E5E5"> to browse doesn't everyone do</font><font color="#CCCCCC"> that</font>

251
00:10:33,690 --> 00:10:38,430
no<font color="#E5E5E5"> now and then you get to see we hear</font>

252
00:10:35,940 --> 00:10:40,530
of situations where the red team maybe

253
00:10:38,430 --> 00:10:42,479
just visits the<font color="#CCCCCC"> website of their future</font>

254
00:10:40,530 --> 00:10:45,360
<font color="#E5E5E5">customer and does that through a VPN</font>

255
00:10:42,480 --> 00:10:48,450
<font color="#E5E5E5">well if there's just to slide him</font><font color="#CCCCCC"> during</font>

256
00:10:45,360 --> 00:10:50,690
<font color="#CCCCCC">the</font><font color="#E5E5E5"> operation that that might</font><font color="#CCCCCC"> be a</font>

257
00:10:48,450 --> 00:10:54,420
going on<font color="#E5E5E5"> you would be surprised how</font>

258
00:10:50,690 --> 00:10:56,330
quick<font color="#CCCCCC"> setup means</font><font color="#E5E5E5"> go searching through</font>

259
00:10:54,420 --> 00:10:59,479
logs<font color="#CCCCCC"> who</font><font color="#E5E5E5"> must visited their</font>

260
00:10:56,330 --> 00:11:01,710
infrastructure so yeah do<font color="#CCCCCC"> that food VPN</font>

261
00:10:59,480 --> 00:11:04,080
and I<font color="#E5E5E5"> think that the component</font><font color="#CCCCCC"> that</font>

262
00:11:01,710 --> 00:11:06,150
might not<font color="#CCCCCC"> be that</font><font color="#E5E5E5"> that commonly used</font>

263
00:11:04,080 --> 00:11:08,220
with we tend<font color="#CCCCCC"> to use them multifunctional</font>

264
00:11:06,150 --> 00:11:10,110
<font color="#CCCCCC">redirect us</font><font color="#E5E5E5"> so we don't use a redirected</font>

265
00:11:08,220 --> 00:11:12,270
just<font color="#CCCCCC"> a for traffic it does a lot</font><font color="#E5E5E5"> more in</font>

266
00:11:10,110 --> 00:11:15,720
our infrastructure<font color="#E5E5E5"> web-based file</font>

267
00:11:12,270 --> 00:11:19,050
servers for serving files<font color="#CCCCCC"> we tend to use</font>

268
00:11:15,720 --> 00:11:21,180
HTML smuggling a lot<font color="#E5E5E5"> HTML smuggling is a</font>

269
00:11:19,050 --> 00:11:23,459
technique whereby<font color="#E5E5E5"> whereby we don't offer</font>

270
00:11:21,180 --> 00:11:26,880
a file to download but basically we

271
00:11:23,460 --> 00:11:29,370
<font color="#E5E5E5">offer a HTML</font><font color="#CCCCCC"> site with JavaScript eNOS</font>

272
00:11:26,880 --> 00:11:31,110
<font color="#CCCCCC">and on the browser</font><font color="#E5E5E5"> of the victim the</font>

273
00:11:29,370 --> 00:11:33,330
JavaScript will assembly the document

274
00:11:31,110 --> 00:11:35,040
and deliver it for local<font color="#CCCCCC"> downloads that</font>

275
00:11:33,330 --> 00:11:37,290
means that we're already<font color="#E5E5E5"> past the</font>

276
00:11:35,040 --> 00:11:39,120
proxies and all the scanners were

277
00:11:37,290 --> 00:11:40,740
already on the<font color="#CCCCCC"> endpoint so endpoint</font>

278
00:11:39,120 --> 00:11:42,660
security might still be in our way but

279
00:11:40,740 --> 00:11:44,520
we<font color="#E5E5E5"> were already on the endpoints but</font>

280
00:11:42,660 --> 00:11:47,430
when the word document with macros gets

281
00:11:44,520 --> 00:11:50,069
<font color="#CCCCCC">assembled and then</font><font color="#E5E5E5"> we use tracking</font>

282
00:11:47,430 --> 00:11:53,430
<font color="#E5E5E5">pixels like you would see in marketing</font>

283
00:11:50,070 --> 00:11:56,100
emails<font color="#CCCCCC"> and we use a lot of them</font><font color="#E5E5E5"> we if we</font>

284
00:11:53,430 --> 00:11:59,219
send out an email we want to know if the

285
00:11:56,100 --> 00:12:01,020
emails read and if the emails read we

286
00:11:59,220 --> 00:12:02,760
want to know if it's if it's the email

287
00:12:01,020 --> 00:12:04,350
client that's reading the email or if

288
00:12:02,760 --> 00:12:06,720
there's a proxy in between<font color="#E5E5E5"> that's pre</font>

289
00:12:04,350 --> 00:12:08,070
scanning every address<font color="#E5E5E5"> and then once we</font>

290
00:12:06,720 --> 00:12:09,870
<font color="#CCCCCC">know the</font><font color="#E5E5E5"> email is right we want to know</font>

291
00:12:08,070 --> 00:12:11,700
if the document is<font color="#CCCCCC"> open</font><font color="#E5E5E5"> so if just</font><font color="#CCCCCC"> the</font>

292
00:12:09,870 --> 00:12:14,640
<font color="#CCCCCC">raw</font><font color="#E5E5E5"> document is opened by the victim and</font>

293
00:12:11,700 --> 00:12:16,410
if it is we want to<font color="#E5E5E5"> know even though if</font>

294
00:12:14,640 --> 00:12:18,449
<font color="#CCCCCC">whether or</font><font color="#E5E5E5"> not the macro</font><font color="#CCCCCC"> ran we want to</font>

295
00:12:16,410 --> 00:12:20,100
know if he started<font color="#CCCCCC"> the macro that might</font>

296
00:12:18,450 --> 00:12:22,080
crash during<font color="#CCCCCC"> this process</font><font color="#E5E5E5"> or something</font>

297
00:12:20,100 --> 00:12:24,630
might go wrong we want to know did the

298
00:12:22,080 --> 00:12:26,400
macro it was it triggers and then<font color="#E5E5E5"> we</font>

299
00:12:24,630 --> 00:12:27,600
expect<font color="#CCCCCC"> to run</font><font color="#E5E5E5"> some payload</font><font color="#CCCCCC"> and we also</font>

300
00:12:26,400 --> 00:12:30,959
want to<font color="#E5E5E5"> know when the macro should be</font>

301
00:12:27,600 --> 00:12:32,460
finished<font color="#CCCCCC"> just in</font><font color="#E5E5E5"> case something</font><font color="#CCCCCC"> goes</font>

302
00:12:30,960 --> 00:12:33,960
<font color="#E5E5E5">wrong we want to know exactly where to</font>

303
00:12:32,460 --> 00:12:36,330
<font color="#E5E5E5">start debugging it's sort of a remote</font>

304
00:12:33,960 --> 00:12:37,920
debugger by placing pixels everywhere

305
00:12:36,330 --> 00:12:39,690
<font color="#E5E5E5">that get requested from our</font>

306
00:12:37,920 --> 00:12:43,790
infrastructure<font color="#CCCCCC"> so we</font><font color="#E5E5E5"> see one day get</font>

307
00:12:39,690 --> 00:12:46,800
requested there's<font color="#CCCCCC"> some more graphical</font>

308
00:12:43,790 --> 00:12:48,810
picture for<font color="#E5E5E5"> it for the same items we've</font>

309
00:12:46,800 --> 00:12:52,189
got the<font color="#E5E5E5"> Donora in red we've got the</font>

310
00:12:48,810 --> 00:12:55,229
<font color="#CCCCCC">backends our</font><font color="#E5E5E5"> service and we never ever</font>

311
00:12:52,190 --> 00:12:58,230
talk to<font color="#E5E5E5"> these machines directly quite</font>

312
00:12:55,230 --> 00:12:59,880
often if<font color="#E5E5E5"> we use a graphical interfaces</font>

313
00:12:58,230 --> 00:13:02,100
on our own systems

314
00:12:59,880 --> 00:13:04,110
then we work through redirect<font color="#CCCCCC"> rows</font><font color="#E5E5E5"> you</font>

315
00:13:02,100 --> 00:13:06,390
<font color="#E5E5E5">could never ever make the mistake this</font>

316
00:13:04,110 --> 00:13:08,130
red area so<font color="#E5E5E5"> our own</font><font color="#CCCCCC"> back-end you burned</font>

317
00:13:06,390 --> 00:13:09,870
<font color="#E5E5E5">that quite fast and it's quite</font><font color="#CCCCCC"> hard to</font>

318
00:13:08,130 --> 00:13:11,670
<font color="#CCCCCC">maintain and hard to</font><font color="#E5E5E5"> build up we</font><font color="#CCCCCC"> do</font>

319
00:13:09,870 --> 00:13:13,110
<font color="#E5E5E5">build</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> up per clients new systems</font>

320
00:13:11,670 --> 00:13:15,620
<font color="#E5E5E5">pipelines but you don't want to be</font>

321
00:13:13,110 --> 00:13:17,670
cycling<font color="#CCCCCC"> through those for a few reasons</font>

322
00:13:15,620 --> 00:13:20,190
<font color="#E5E5E5">first of all and I think that's the most</font>

323
00:13:17,670 --> 00:13:22,110
important and<font color="#E5E5E5"> we most certainly not too</font>

324
00:13:20,190 --> 00:13:24,180
lazy to build a lot of<font color="#CCCCCC"> these things</font><font color="#E5E5E5"> but</font>

325
00:13:22,110 --> 00:13:25,890
<font color="#E5E5E5">there are no</font><font color="#CCCCCC"> Hardware</font><font color="#E5E5E5"> sensitive data of</font>

326
00:13:24,180 --> 00:13:28,319
customers might be on<font color="#E5E5E5"> these</font><font color="#CCCCCC"> machines so</font>

327
00:13:25,890 --> 00:13:30,180
<font color="#CCCCCC">we're not</font><font color="#E5E5E5"> going to do that at some</font>

328
00:13:28,320 --> 00:13:33,360
<font color="#E5E5E5">virtual machine it's it's going to</font><font color="#CCCCCC"> be</font>

329
00:13:30,180 --> 00:13:36,060
<font color="#E5E5E5">our own bare metal where we build up</font>

330
00:13:33,360 --> 00:13:37,560
this infrastructure so that<font color="#E5E5E5"> that's four</font>

331
00:13:36,060 --> 00:13:39,540
for one is a reason<font color="#E5E5E5"> that they're</font><font color="#CCCCCC"> not</font>

332
00:13:37,560 --> 00:13:41,670
<font color="#E5E5E5">easily</font><font color="#CCCCCC"> replaced I've got</font><font color="#E5E5E5"> only so many IP</font>

333
00:13:39,540 --> 00:13:44,069
addresses<font color="#CCCCCC"> an IP space to give away there</font>

334
00:13:41,670 --> 00:13:47,010
<font color="#E5E5E5">and</font><font color="#CCCCCC"> then the layer in between</font><font color="#E5E5E5"> the</font>

335
00:13:44,070 --> 00:13:50,070
redirect<font color="#E5E5E5"> hrus we tend to spin up VPSs</font>

336
00:13:47,010 --> 00:13:52,380
at the utilization<font color="#E5E5E5"> Amazon and we can</font>

337
00:13:50,070 --> 00:13:54,570
dispose them quite easily<font color="#CCCCCC"> that's I once</font>

338
00:13:52,380 --> 00:13:56,880
had<font color="#CCCCCC"> to make</font><font color="#E5E5E5"> quite a race</font><font color="#CCCCCC"> rate to see how</font>

339
00:13:54,570 --> 00:13:59,310
<font color="#E5E5E5">many I</font><font color="#CCCCCC"> could start and I could get</font><font color="#E5E5E5"> it up</font>

340
00:13:56,880 --> 00:14:01,200
to like 40 a minute for the more don't

341
00:13:59,310 --> 00:14:03,239
<font color="#E5E5E5">be redirected so if we have a client's</font>

342
00:14:01,200 --> 00:14:05,820
who thinks he can<font color="#CCCCCC"> kick aside by just</font>

343
00:14:03,240 --> 00:14:09,450
blocking IP addresses that's<font color="#CCCCCC"> the</font><font color="#E5E5E5"> race we</font>

344
00:14:05,820 --> 00:14:12,390
usually win<font color="#CCCCCC"> the more complex redirect</font>

345
00:14:09,450 --> 00:14:14,280
<font color="#E5E5E5">errs do also SSL certification they know</font>

346
00:14:12,390 --> 00:14:15,540
that traffic not for the<font color="#E5E5E5"> back</font><font color="#CCCCCC"> end to</font>

347
00:14:14,280 --> 00:14:16,860
send somewhere else you can<font color="#E5E5E5"> see that in</font>

348
00:14:15,540 --> 00:14:20,579
the<font color="#E5E5E5"> bottom there's an</font><font color="#CCCCCC"> application server</font>

349
00:14:16,860 --> 00:14:23,760
<font color="#E5E5E5">that might get some of the traffic</font><font color="#CCCCCC"> to</font>

350
00:14:20,580 --> 00:14:27,180
<font color="#E5E5E5">direct it towards them</font><font color="#CCCCCC"> that means we can</font>

351
00:14:23,760 --> 00:14:29,400
also measure<font color="#E5E5E5"> what goes into our</font><font color="#CCCCCC"> cobble</font>

352
00:14:27,180 --> 00:14:31,650
strike<font color="#E5E5E5"> back-end and what's other noise</font>

353
00:14:29,400 --> 00:14:33,510
and this<font color="#E5E5E5"> other noise that's what gets</font>

354
00:14:31,650 --> 00:14:36,900
more interesting<font color="#E5E5E5"> later on in the</font>

355
00:14:33,510 --> 00:14:38,700
presentation to flatten out<font color="#E5E5E5"> this picture</font>

356
00:14:36,900 --> 00:14:40,410
<font color="#E5E5E5">this is basically what we have we've got</font>

357
00:14:38,700 --> 00:14:42,690
the target<font color="#CCCCCC"> Network</font><font color="#E5E5E5"> we've got three</font>

358
00:14:40,410 --> 00:14:44,670
directors<font color="#E5E5E5"> a layer of disposable machines</font>

359
00:14:42,690 --> 00:14:49,880
<font color="#E5E5E5">and we've got the</font><font color="#CCCCCC"> backend</font><font color="#E5E5E5"> that we are</font>

360
00:14:44,670 --> 00:14:49,880
more keen on of keeping keeping<font color="#E5E5E5"> secrets</font>

361
00:14:50,150 --> 00:14:56,280
basically there's a lot<font color="#E5E5E5"> of systems</font><font color="#CCCCCC"> for</font>

362
00:14:53,360 --> 00:14:58,500
<font color="#CCCCCC">one</font><font color="#E5E5E5"> operation for one client if you have</font>

363
00:14:56,280 --> 00:15:00,420
one big<font color="#E5E5E5"> red team we quite often ruin two</font>

364
00:14:58,500 --> 00:15:02,790
<font color="#E5E5E5">or three scenarios that means that for a</font>

365
00:15:00,420 --> 00:15:05,130
certain<font color="#CCCCCC"> scenario</font><font color="#E5E5E5"> we decide how advanced</font>

366
00:15:02,790 --> 00:15:06,719
do we want to be as we<font color="#E5E5E5"> are told in</font><font color="#CCCCCC"> the</font>

367
00:15:05,130 --> 00:15:08,460
beginning<font color="#E5E5E5"> we're not always</font><font color="#CCCCCC"> going in as</font>

368
00:15:06,720 --> 00:15:11,160
<font color="#E5E5E5">it falls as we can sometimes we</font><font color="#CCCCCC"> choose</font>

369
00:15:08,460 --> 00:15:11,880
choose once now to be pretty advanced

370
00:15:11,160 --> 00:15:14,430
<font color="#CCCCCC">and once</font>

371
00:15:11,880 --> 00:15:16,830
now<font color="#CCCCCC"> yo we'd use both files</font><font color="#E5E5E5"> link files</font>

372
00:15:14,430 --> 00:15:19,260
everything<font color="#E5E5E5"> that's me a script kiddie</font>

373
00:15:16,830 --> 00:15:21,420
style<font color="#E5E5E5"> but it can be really</font><font color="#CCCCCC"> useful to</font>

374
00:15:19,260 --> 00:15:23,250
tune yourself down<font color="#E5E5E5"> to try that but it</font>

375
00:15:21,420 --> 00:15:26,189
already means<font color="#E5E5E5"> we have at least two</font>

376
00:15:23,250 --> 00:15:29,640
<font color="#CCCCCC">backends two team servers likely even</font>

377
00:15:26,190 --> 00:15:31,830
<font color="#E5E5E5">three man will have few hands full of</font>

378
00:15:29,640 --> 00:15:34,530
these<font color="#E5E5E5"> redirects just for one client</font><font color="#CCCCCC"> one</font>

379
00:15:31,830 --> 00:15:38,130
operation<font color="#E5E5E5"> so as you see it's it's quite</font>

380
00:15:34,530 --> 00:15:39,810
fast<font color="#E5E5E5"> getting more complex and then we</font>

381
00:15:38,130 --> 00:15:41,220
want<font color="#CCCCCC"> to know</font><font color="#E5E5E5"> yesterday where you ran</font>

382
00:15:39,810 --> 00:15:42,750
<font color="#E5E5E5">this command on the one machine what's</font>

383
00:15:41,220 --> 00:15:44,880
the outcome<font color="#E5E5E5"> and we have to start</font>

384
00:15:42,750 --> 00:15:47,550
wrapping through logs we have to SSH

385
00:15:44,880 --> 00:15:50,730
into one of these machines<font color="#E5E5E5"> use grep to</font>

386
00:15:47,550 --> 00:15:52,709
to log to<font color="#E5E5E5"> find the commands</font><font color="#CCCCCC"> in the in</font>

387
00:15:50,730 --> 00:15:54,000
the log files<font color="#E5E5E5"> it's a lot of work and</font>

388
00:15:52,710 --> 00:15:56,070
<font color="#E5E5E5">also if something happens</font><font color="#CCCCCC"> on one</font>

389
00:15:54,000 --> 00:15:57,570
<font color="#E5E5E5">backends</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> thereafter on the other we</font>

390
00:15:56,070 --> 00:15:59,460
cannot correlate<font color="#E5E5E5"> this information it's</font>

391
00:15:57,570 --> 00:16:01,500
not<font color="#E5E5E5"> it's not linked together</font><font color="#CCCCCC"> so there's</font>

392
00:15:59,460 --> 00:16:02,700
no<font color="#E5E5E5"> easy</font><font color="#CCCCCC"> way to access</font><font color="#E5E5E5"> all</font><font color="#CCCCCC"> the data</font>

393
00:16:01,500 --> 00:16:04,380
that's scattered<font color="#CCCCCC"> over this</font>

394
00:16:02,700 --> 00:16:10,320
infrastructure<font color="#E5E5E5"> and that's</font><font color="#CCCCCC"> something</font>

395
00:16:04,380 --> 00:16:12,780
<font color="#E5E5E5">really I need to fix me yep so we want</font>

396
00:16:10,320 --> 00:16:15,390
to centralize all<font color="#E5E5E5"> those logs and we want</font>

397
00:16:12,780 --> 00:16:17,850
to centralize all<font color="#CCCCCC"> the important traffic</font>

398
00:16:15,390 --> 00:16:19,560
<font color="#CCCCCC">locks and all the</font><font color="#E5E5E5"> important operational</font>

399
00:16:17,850 --> 00:16:23,310
logs from from the stuff<font color="#E5E5E5"> that we typed</font>

400
00:16:19,560 --> 00:16:24,959
<font color="#E5E5E5">into our team service call strike and in</font>

401
00:16:23,310 --> 00:16:26,670
all those<font color="#CCCCCC"> logs they're actually really</font>

402
00:16:24,960 --> 00:16:31,470
<font color="#CCCCCC">relevant information so we need to get</font>

403
00:16:26,670 --> 00:16:33,479
at all<font color="#E5E5E5"> we want that</font><font color="#CCCCCC"> because</font><font color="#E5E5E5"> you want</font>

404
00:16:31,470 --> 00:16:36,000
better situational awareness we want to

405
00:16:33,480 --> 00:16:38,040
know what is going<font color="#E5E5E5"> on we want to also</font>

406
00:16:36,000 --> 00:16:40,520
get historical searching through the

407
00:16:38,040 --> 00:16:42,780
operation<font color="#CCCCCC"> just like like mark sets</font>

408
00:16:40,520 --> 00:16:44,670
<font color="#CCCCCC">enrichment</font><font color="#E5E5E5"> any type of information</font>

409
00:16:42,780 --> 00:16:47,790
element<font color="#E5E5E5"> we're in the lock we might be</font>

410
00:16:44,670 --> 00:16:50,880
able<font color="#E5E5E5"> to enrich and rich is better so</font>

411
00:16:47,790 --> 00:16:52,740
more<font color="#E5E5E5"> information</font><font color="#CCCCCC"> is better maybe you</font>

412
00:16:50,880 --> 00:16:55,050
build some real-time dashboards<font color="#E5E5E5"> people</font>

413
00:16:52,740 --> 00:16:58,260
tend to<font color="#E5E5E5"> like dashboards</font><font color="#CCCCCC"> and they can</font>

414
00:16:55,050 --> 00:16:59,670
<font color="#E5E5E5">give you</font><font color="#CCCCCC"> some</font><font color="#E5E5E5"> nicer overviews for</font><font color="#CCCCCC"> us but</font>

415
00:16:58,260 --> 00:17:02,040
maybe also for a white team so maybe the

416
00:16:59,670 --> 00:17:04,260
white team<font color="#E5E5E5"> instead of</font><font color="#CCCCCC"> creating us for</font>

417
00:17:02,040 --> 00:17:06,540
specific<font color="#E5E5E5"> information they could have a</font>

418
00:17:04,260 --> 00:17:08,339
dashboard<font color="#E5E5E5"> with specific ioc measures or</font>

419
00:17:06,540 --> 00:17:10,260
specific desktops<font color="#E5E5E5"> that might have been</font>

420
00:17:08,339 --> 00:17:12,869
compromised<font color="#E5E5E5"> stuff is everyone familiar</font>

421
00:17:10,260 --> 00:17:14,609
with<font color="#E5E5E5"> the term will our white team if we</font>

422
00:17:12,869 --> 00:17:15,300
do a red team<font color="#E5E5E5"> operation you've</font><font color="#CCCCCC"> got the</font>

423
00:17:14,609 --> 00:17:17,219
group of attackers

424
00:17:15,300 --> 00:17:18,720
<font color="#CCCCCC">us or at least</font><font color="#E5E5E5"> some aggressive team</font>

425
00:17:17,220 --> 00:17:20,250
<font color="#E5E5E5">attacking the customer</font><font color="#CCCCCC"> you've got the</font>

426
00:17:18,720 --> 00:17:22,199
blue team of course which is<font color="#E5E5E5"> the</font><font color="#CCCCCC"> shock</font>

427
00:17:20,250 --> 00:17:23,760
<font color="#CCCCCC">so you two operators</font><font color="#E5E5E5"> trying to keep</font>

428
00:17:22,199 --> 00:17:25,530
everything safe

429
00:17:23,760 --> 00:17:27,780
then not to know<font color="#E5E5E5"> that there's a that</font>

430
00:17:25,530 --> 00:17:29,460
there's a test<font color="#E5E5E5"> going on</font><font color="#CCCCCC"> they</font><font color="#E5E5E5"> just feel</font>

431
00:17:27,780 --> 00:17:31,649
it as a real<font color="#CCCCCC"> incidence</font><font color="#E5E5E5"> and then we've</font>

432
00:17:29,460 --> 00:17:33,660
got<font color="#E5E5E5"> the</font><font color="#CCCCCC"> y team where</font><font color="#E5E5E5"> we it's the red</font>

433
00:17:31,650 --> 00:17:35,880
team including a few guys at the

434
00:17:33,660 --> 00:17:37,380
customer and they are in place to<font color="#E5E5E5"> make</font>

435
00:17:35,880 --> 00:17:39,750
<font color="#CCCCCC">sure</font><font color="#E5E5E5"> that things don't escalate and</font>

436
00:17:37,380 --> 00:17:41,760
things don't<font color="#E5E5E5"> go really bad but like the</font>

437
00:17:39,750 --> 00:17:43,290
people<font color="#E5E5E5"> don't get fired if they name hit</font>

438
00:17:41,760 --> 00:17:46,530
up in a<font color="#E5E5E5"> law or that that the police</font>

439
00:17:43,290 --> 00:17:48,240
<font color="#CCCCCC">isn't</font><font color="#E5E5E5"> cold or it's cold whatever the</font>

440
00:17:46,530 --> 00:17:49,290
terms of the only agreement<font color="#CCCCCC"> ARB at least</font>

441
00:17:48,240 --> 00:17:50,730
you need<font color="#E5E5E5"> to monitor</font><font color="#CCCCCC"> that</font>

442
00:17:49,290 --> 00:17:52,260
that's what the<font color="#CCCCCC"> white email the white</font>

443
00:17:50,730 --> 00:17:53,700
image<font color="#E5E5E5"> so we want to give them</font>

444
00:17:52,260 --> 00:17:57,660
<font color="#E5E5E5">information we want to give them some</font>

445
00:17:53,700 --> 00:17:59,040
auditability<font color="#E5E5E5"> if you if you like</font><font color="#CCCCCC"> and also</font>

446
00:17:57,660 --> 00:18:00,900
<font color="#E5E5E5">again we want to centralize the logs</font>

447
00:17:59,040 --> 00:18:03,330
<font color="#CCCCCC">because if you ever used</font><font color="#E5E5E5"> cobble strike</font>

448
00:18:00,900 --> 00:18:05,250
and for<font color="#E5E5E5"> the few users</font><font color="#CCCCCC"> here that will you</font>

449
00:18:03,330 --> 00:18:08,220
know<font color="#E5E5E5"> what kind of a bitch it is to</font>

450
00:18:05,250 --> 00:18:10,260
search<font color="#E5E5E5"> through all</font><font color="#CCCCCC"> the tens and hundreds</font>

451
00:18:08,220 --> 00:18:12,690
of old beacon locks and trying to<font color="#E5E5E5"> find</font>

452
00:18:10,260 --> 00:18:15,300
that specific piece<font color="#E5E5E5"> of information it's</font>

453
00:18:12,690 --> 00:18:17,580
a great tool<font color="#E5E5E5"> but it's mental life</font>

454
00:18:15,300 --> 00:18:20,399
hacking not for historical searching so

455
00:18:17,580 --> 00:18:22,199
we've got some challenges<font color="#E5E5E5"> there</font><font color="#CCCCCC"> one more</font>

456
00:18:20,400 --> 00:18:24,450
<font color="#CCCCCC">thing</font><font color="#E5E5E5"> to note we're talking about</font>

457
00:18:22,200 --> 00:18:26,130
<font color="#CCCCCC">traffic and operational logs so we're</font>

458
00:18:24,450 --> 00:18:28,680
not<font color="#CCCCCC"> interested in</font><font color="#E5E5E5"> in like the base</font>

459
00:18:26,130 --> 00:18:30,600
<font color="#E5E5E5">operating system</font><font color="#CCCCCC"> ssh</font><font color="#E5E5E5"> stuff and a failed</font>

460
00:18:28,680 --> 00:18:34,830
<font color="#E5E5E5">authentication</font><font color="#CCCCCC"> that's like a</font><font color="#E5E5E5"> different</font>

461
00:18:30,600 --> 00:18:36,389
category but centralizing logs and and

462
00:18:34,830 --> 00:18:38,460
gathering it together kind<font color="#E5E5E5"> of</font><font color="#CCCCCC"> sounds</font>

463
00:18:36,390 --> 00:18:40,860
like<font color="#CCCCCC"> a problem that the blue team's have</font>

464
00:18:38,460 --> 00:18:44,040
<font color="#CCCCCC">already</font><font color="#E5E5E5"> solved a few</font><font color="#CCCCCC"> years ago</font><font color="#E5E5E5"> so that</font>

465
00:18:40,860 --> 00:18:47,479
<font color="#CCCCCC">way you can either go with Splunk or you</font>

466
00:18:44,040 --> 00:18:49,980
can go with<font color="#CCCCCC"> ELQ spelunkers commercial</font>

467
00:18:47,480 --> 00:18:52,980
<font color="#E5E5E5">fancy stuff but also has some drawbacks</font>

468
00:18:49,980 --> 00:18:55,470
and<font color="#E5E5E5"> we want to go open-source so</font><font color="#CCCCCC"> we went</font>

469
00:18:52,980 --> 00:18:57,810
with ELQ but because we are<font color="#CCCCCC"> a team and</font>

470
00:18:55,470 --> 00:19:00,210
in advance<font color="#CCCCCC"> I apologize</font><font color="#E5E5E5"> for the bad</font>

471
00:18:57,810 --> 00:19:01,200
graphics<font color="#CCCCCC"> but we needed</font><font color="#E5E5E5"> to have an Alec</font>

472
00:19:00,210 --> 00:19:06,240
for<font color="#E5E5E5"> the</font><font color="#CCCCCC"> red team</font>

473
00:19:01,200 --> 00:19:10,500
so we are<font color="#CCCCCC"> creating at ELQ</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> we will be</font>

474
00:19:06,240 --> 00:19:13,550
releasing<font color="#E5E5E5"> this tool right after so in a</font>

475
00:19:10,500 --> 00:19:17,970
nutshell it's a scene for the<font color="#E5E5E5"> red team</font>

476
00:19:13,550 --> 00:19:20,010
we're using<font color="#CCCCCC"> alq</font><font color="#E5E5E5"> so it's entirely</font><font color="#CCCCCC"> based</font>

477
00:19:17,970 --> 00:19:22,560
<font color="#CCCCCC">on</font><font color="#E5E5E5"> the ELQ stack we're gathering</font>

478
00:19:20,010 --> 00:19:24,240
operational data from from<font color="#CCCCCC"> copal strike</font>

479
00:19:22,560 --> 00:19:27,090
and<font color="#CCCCCC"> that's what we're supporting right</font>

480
00:19:24,240 --> 00:19:29,160
now so it's giving you a view<font color="#E5E5E5"> of</font><font color="#CCCCCC"> all the</font>

481
00:19:27,090 --> 00:19:32,699
<font color="#CCCCCC">operational data as well as all the data</font>

482
00:19:29,160 --> 00:19:34,440
<font color="#CCCCCC">that might be someway</font><font color="#E5E5E5"> indicated</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> could</font>

483
00:19:32,700 --> 00:19:36,210
be an<font color="#E5E5E5"> IOC so we're talking</font><font color="#CCCCCC"> about traffic</font>

484
00:19:34,440 --> 00:19:36,620
logs but also the IOC that are coming

485
00:19:36,210 --> 00:19:39,020
from

486
00:19:36,620 --> 00:19:40,580
<font color="#CCCCCC">Gobert</font><font color="#E5E5E5"> strike itself we want all that</font>

487
00:19:39,020 --> 00:19:42,080
<font color="#E5E5E5">information together one central</font>

488
00:19:40,580 --> 00:19:45,949
location better situational awareness

489
00:19:42,080 --> 00:19:47,480
<font color="#E5E5E5">and</font><font color="#CCCCCC"> like</font><font color="#E5E5E5"> marks that we have</font>

490
00:19:45,950 --> 00:19:48,890
infrastructures that are<font color="#E5E5E5"> quickly</font>

491
00:19:47,480 --> 00:19:51,380
expanding so we need to have the

492
00:19:48,890 --> 00:19:55,940
<font color="#CCCCCC">installation automate it's easy so</font>

493
00:19:51,380 --> 00:19:58,190
that's<font color="#CCCCCC"> what we're</font><font color="#E5E5E5"> doing so</font><font color="#CCCCCC"> the current</font>

494
00:19:55,940 --> 00:20:00,350
status<font color="#E5E5E5"> of</font><font color="#CCCCCC"> as we will be</font><font color="#E5E5E5"> releasing right</font>

495
00:19:58,190 --> 00:20:02,870
now is it does to all the log

496
00:20:00,350 --> 00:20:04,780
aggregation for<font color="#CCCCCC"> Cobra strike and 4-h a</font>

497
00:20:02,870 --> 00:20:07,129
proxy that's the tooling that<font color="#E5E5E5"> were using</font>

498
00:20:04,780 --> 00:20:10,520
<font color="#E5E5E5">another option would be to use Apache</font>

499
00:20:07,130 --> 00:20:14,000
<font color="#CCCCCC">many people use Apache</font><font color="#E5E5E5"> and for the ones</font>

500
00:20:10,520 --> 00:20:15,290
<font color="#E5E5E5">that of you that are looking online for</font>

501
00:20:14,000 --> 00:20:17,060
<font color="#E5E5E5">some information</font><font color="#CCCCCC"> about academic</font>

502
00:20:15,290 --> 00:20:18,860
infrastructures<font color="#E5E5E5"> a lot of other teams are</font>

503
00:20:17,060 --> 00:20:22,780
actually<font color="#E5E5E5"> using Apache we made a decision</font>

504
00:20:18,860 --> 00:20:25,820
<font color="#CCCCCC">way time</font><font color="#E5E5E5"> some time ago to use</font><font color="#CCCCCC"> H a proxy</font>

505
00:20:22,780 --> 00:20:28,490
we like it<font color="#E5E5E5"> better but Apache should not</font>

506
00:20:25,820 --> 00:20:30,139
be<font color="#E5E5E5"> that</font><font color="#CCCCCC"> easy</font><font color="#E5E5E5"> to implement there is quite</font>

507
00:20:28,490 --> 00:20:32,050
a<font color="#E5E5E5"> few open source stuff at the moment</font>

508
00:20:30,140 --> 00:20:35,480
<font color="#E5E5E5">and using Apache</font>

509
00:20:32,050 --> 00:20:38,750
<font color="#E5E5E5">especially the blue screen of Jeff</font><font color="#CCCCCC"> Vicki</font>

510
00:20:35,480 --> 00:20:40,130
has some<font color="#E5E5E5"> good</font><font color="#CCCCCC"> information but</font><font color="#E5E5E5"> yeah yeah</font>

511
00:20:38,750 --> 00:20:43,850
but by the time we were already halfway

512
00:20:40,130 --> 00:20:46,580
with our<font color="#E5E5E5"> H proxy conflicts with the it</font>

513
00:20:43,850 --> 00:20:48,320
was also and<font color="#CCCCCC"> logging which is detailed</font>

514
00:20:46,580 --> 00:20:50,389
<font color="#CCCCCC">there it does</font><font color="#E5E5E5"> not go into the deal that</font>

515
00:20:48,320 --> 00:20:52,909
<font color="#E5E5E5">we're</font><font color="#CCCCCC"> doing because we are</font><font color="#E5E5E5"> doing very</font>

516
00:20:50,390 --> 00:20:56,090
very<font color="#E5E5E5"> fine-grained filtering and logging</font>

517
00:20:52,910 --> 00:21:00,320
<font color="#E5E5E5">so if you compare this to Cobalt</font>

518
00:20:56,090 --> 00:21:04,220
<font color="#E5E5E5">Splunk by</font><font color="#CCCCCC"> Finn's</font><font color="#E5E5E5"> and I forgot his</font><font color="#CCCCCC"> last</font>

519
00:21:00,320 --> 00:21:06,530
name<font color="#E5E5E5"> that's cool but it's like generic</font>

520
00:21:04,220 --> 00:21:08,060
overview<font color="#CCCCCC"> quick</font><font color="#E5E5E5"> and generic this what</font>

521
00:21:06,530 --> 00:21:09,889
we're building is way more advanced way

522
00:21:08,060 --> 00:21:11,179
very<font color="#E5E5E5"> more better filtering</font><font color="#CCCCCC"> we're</font>

523
00:21:09,890 --> 00:21:13,910
chopping<font color="#E5E5E5"> up all the fields you</font><font color="#CCCCCC"> can do</font>

524
00:21:11,180 --> 00:21:15,410
<font color="#E5E5E5">diesel detail careening also lock</font>

525
00:21:13,910 --> 00:21:17,540
enrichment we want to filter<font color="#CCCCCC"> out all the</font>

526
00:21:15,410 --> 00:21:19,490
<font color="#E5E5E5">test beacons of our own testing systems</font>

527
00:21:17,540 --> 00:21:21,379
<font color="#CCCCCC">we don't</font><font color="#E5E5E5"> know about that it's in it's in</font>

528
00:21:19,490 --> 00:21:22,670
the stack<font color="#CCCCCC"> it's in the elk stack but we</font>

529
00:21:21,380 --> 00:21:24,320
can just<font color="#E5E5E5"> simply filter all the data out</font>

530
00:21:22,670 --> 00:21:25,880
<font color="#E5E5E5">so it will not</font><font color="#CCCCCC"> appear on dashboards it</font>

531
00:21:24,320 --> 00:21:28,550
will not<font color="#E5E5E5"> appear in historic searches</font>

532
00:21:25,880 --> 00:21:29,360
<font color="#E5E5E5">stuff like that one attack known good</font>

533
00:21:28,550 --> 00:21:33,649
and bad traffic

534
00:21:29,360 --> 00:21:36,379
<font color="#CCCCCC">GIP look ups etc</font><font color="#E5E5E5"> I</font><font color="#CCCCCC"> am on</font><font color="#E5E5E5"> an easy</font>

535
00:21:33,650 --> 00:21:37,940
carrying<font color="#E5E5E5"> of</font><font color="#CCCCCC"> screenshots keystrokes IOC</font>

536
00:21:36,380 --> 00:21:39,680
<font color="#CCCCCC">is</font><font color="#E5E5E5"> operators logs we just want to have a</font>

537
00:21:37,940 --> 00:21:42,500
better interface<font color="#E5E5E5"> than the default couple</font>

538
00:21:39,680 --> 00:21:44,240
<font color="#E5E5E5">track interface only leave a few couple</font>

539
00:21:42,500 --> 00:21:46,910
strike users here<font color="#E5E5E5"> in the room here</font><font color="#CCCCCC"> that</font>

540
00:21:44,240 --> 00:21:48,929
<font color="#CCCCCC">not sure if any of them wants to comment</font>

541
00:21:46,910 --> 00:21:50,940
if you ever tried<font color="#CCCCCC"> searching back in</font>

542
00:21:48,929 --> 00:21:54,019
the screen<font color="#E5E5E5"> output of</font><font color="#CCCCCC"> Koppel strike and</font>

543
00:21:50,940 --> 00:21:56,370
<font color="#E5E5E5">cop copy-pasting stuff and did that work</font>

544
00:21:54,019 --> 00:22:00,210
<font color="#E5E5E5">it's usually breaks quite hard it's a</font>

545
00:21:56,370 --> 00:22:02,070
java-based<font color="#E5E5E5"> screen and it's functional</font>

546
00:22:00,210 --> 00:22:04,379
for using it life<font color="#CCCCCC"> it's not functional</font>

547
00:22:02,070 --> 00:22:07,289
<font color="#CCCCCC">for going back in history</font><font color="#E5E5E5"> yeah exactly</font>

548
00:22:04,379 --> 00:22:08,668
<font color="#CCCCCC">and then again after data</font><font color="#E5E5E5"> we can do some</font>

549
00:22:07,289 --> 00:22:10,259
smart dashboards and<font color="#E5E5E5"> queries</font>

550
00:22:08,669 --> 00:22:13,259
aggregations and<font color="#E5E5E5"> stuff like that because</font>

551
00:22:10,259 --> 00:22:14,940
<font color="#E5E5E5">it's a nihilistic stick and then if we</font>

552
00:22:13,259 --> 00:22:17,850
have two data and maybe do some<font color="#E5E5E5"> smart</font>

553
00:22:14,940 --> 00:22:20,159
<font color="#CCCCCC">query to see what the blue team is up</font><font color="#E5E5E5"> so</font>

554
00:22:17,850 --> 00:22:25,590
to go back<font color="#CCCCCC"> to the in the overview</font><font color="#E5E5E5"> that</font>

555
00:22:20,159 --> 00:22:28,080
<font color="#CCCCCC">we just gave</font><font color="#E5E5E5"> brick using the data feed</font>

556
00:22:25,590 --> 00:22:30,119
simply<font color="#CCCCCC"> just file beat which is installed</font>

557
00:22:28,080 --> 00:22:33,869
on<font color="#CCCCCC"> the</font><font color="#E5E5E5"> reader vectors and on the team</font>

558
00:22:30,119 --> 00:22:35,699
service<font color="#E5E5E5"> it pulls all the data</font><font color="#CCCCCC"> to a log</font>

559
00:22:33,869 --> 00:22:38,158
<font color="#CCCCCC">stash which does the heavy filtering</font>

560
00:22:35,700 --> 00:22:41,039
which puts it into<font color="#CCCCCC"> elastic search</font><font color="#E5E5E5"> on top</font>

561
00:22:38,159 --> 00:22:42,869
<font color="#CCCCCC">there is a</font><font color="#E5E5E5"> Cabana interface but you see</font>

562
00:22:41,039 --> 00:22:45,090
on the right there's a second<font color="#E5E5E5"> data</font>

563
00:22:42,869 --> 00:22:47,699
<font color="#E5E5E5">copying stream because we also</font><font color="#CCCCCC"> want to</font>

564
00:22:45,090 --> 00:22:49,918
<font color="#E5E5E5">basically just everything all the data</font>

565
00:22:47,700 --> 00:22:53,249
back<font color="#CCCCCC"> to</font><font color="#E5E5E5"> our</font><font color="#CCCCCC"> one system we want that</font>

566
00:22:49,919 --> 00:22:54,929
<font color="#CCCCCC">because we in</font><font color="#E5E5E5"> the interface we just want</font>

567
00:22:53,249 --> 00:22:56,999
to click on<font color="#E5E5E5"> a simple</font><font color="#CCCCCC"> link to get</font><font color="#E5E5E5"> all the</font>

568
00:22:54,929 --> 00:22:59,190
screenshots<font color="#E5E5E5"> of all the different team</font>

569
00:22:56,999 --> 00:23:00,509
<font color="#CCCCCC">servers if we have 10 team servers we</font>

570
00:22:59,190 --> 00:23:02,369
don't want to be logging<font color="#CCCCCC"> into each team</font>

571
00:23:00,509 --> 00:23:03,570
server<font color="#CCCCCC"> to again scroll through the</font>

572
00:23:02,369 --> 00:23:05,879
screenshots now we just want to

573
00:23:03,570 --> 00:23:09,928
centralize everything<font color="#E5E5E5"> easy clicks easy</font>

574
00:23:05,879 --> 00:23:11,969
queries easy overview and in nutshell<font color="#E5E5E5"> we</font>

575
00:23:09,929 --> 00:23:16,769
do indexing enriching searching

576
00:23:11,970 --> 00:23:19,080
<font color="#CCCCCC">dashboard</font><font color="#E5E5E5"> seam etc etc I want to quickly</font>

577
00:23:16,769 --> 00:23:24,990
<font color="#E5E5E5">go</font><font color="#CCCCCC"> through how cobol strike</font><font color="#E5E5E5"> actually has</font>

578
00:23:19,080 --> 00:23:26,820
its lock<font color="#CCCCCC"> setup the reason is that coca</font>

579
00:23:24,990 --> 00:23:28,590
strike has very<font color="#E5E5E5"> detailed lock but</font><font color="#CCCCCC"> it's</font>

580
00:23:26,820 --> 00:23:30,450
not<font color="#CCCCCC"> in a</font><font color="#E5E5E5"> default way that syslog</font>

581
00:23:28,590 --> 00:23:32,970
actually works<font color="#E5E5E5"> and every specific lock</font>

582
00:23:30,450 --> 00:23:36,090
that<font color="#CCCCCC"> cocoa stark uses</font><font color="#E5E5E5"> has a different</font>

583
00:23:32,970 --> 00:23:37,860
<font color="#CCCCCC">setup</font><font color="#E5E5E5"> so the type of data is in a beacon</font>

584
00:23:36,090 --> 00:23:39,480
<font color="#E5E5E5">transcript that's just the output</font><font color="#CCCCCC"> of a</font>

585
00:23:37,860 --> 00:23:41,580
specific<font color="#CCCCCC"> session that that we have</font>

586
00:23:39,480 --> 00:23:43,649
<font color="#E5E5E5">that's a full transcript of every input</font>

587
00:23:41,580 --> 00:23:46,499
<font color="#E5E5E5">every</font><font color="#CCCCCC"> output all the commands all the</font>

588
00:23:43,649 --> 00:23:48,748
outputs are in there it's in<font color="#E5E5E5"> the</font>

589
00:23:46,499 --> 00:23:50,730
specific date<font color="#CCCCCC"> fall or based on</font><font color="#E5E5E5"> the IP</font>

590
00:23:48,749 --> 00:23:52,830
address based on beacon underscore

591
00:23:50,730 --> 00:23:56,519
beacon ID<font color="#E5E5E5"> and the beacon ID is like a</font>

592
00:23:52,830 --> 00:23:59,279
unique identifier ranging<font color="#E5E5E5"> from</font><font color="#CCCCCC"> 1</font><font color="#E5E5E5"> to 100</font>

593
00:23:56,519 --> 00:24:00,629
thousand which is<font color="#E5E5E5"> an identifier</font><font color="#CCCCCC"> for this</font>

594
00:23:59,279 --> 00:24:01,260
specific beacon session so there's a

595
00:24:00,629 --> 00:24:02,850
very

596
00:24:01,260 --> 00:24:04,379
very<font color="#E5E5E5"> very small chance that there's an</font>

597
00:24:02,850 --> 00:24:07,879
overlap<font color="#E5E5E5"> in</font><font color="#CCCCCC"> beacon IDs we never</font>

598
00:24:04,380 --> 00:24:10,440
<font color="#E5E5E5">experienced it and even if there's an</font>

599
00:24:07,880 --> 00:24:13,410
<font color="#CCCCCC">duplicate</font><font color="#E5E5E5"> we don't care we can still</font>

600
00:24:10,440 --> 00:24:15,090
work along<font color="#CCCCCC"> that we want to have that</font>

601
00:24:13,410 --> 00:24:17,310
beacon transcribed<font color="#E5E5E5"> in</font><font color="#CCCCCC"> us we also want to</font>

602
00:24:15,090 --> 00:24:19,590
<font color="#E5E5E5">have the screenshots that</font><font color="#CCCCCC"> are created on</font>

603
00:24:17,310 --> 00:24:21,389
<font color="#CCCCCC">the targets and</font><font color="#E5E5E5"> those are in different</font>

604
00:24:19,590 --> 00:24:23,550
<font color="#E5E5E5">directory we need to scrape them you</font>

605
00:24:21,390 --> 00:24:26,820
also<font color="#E5E5E5"> wanna have the</font><font color="#CCCCCC"> keylogger</font><font color="#E5E5E5"> output</font><font color="#CCCCCC"> and</font>

606
00:24:23,550 --> 00:24:27,960
there's like<font color="#E5E5E5"> this generic central event</font>

607
00:24:26,820 --> 00:24:30,000
lock where you can<font color="#E5E5E5"> chat with all the</font>

608
00:24:27,960 --> 00:24:33,590
other<font color="#CCCCCC"> Hitomi operators and you could put</font>

609
00:24:30,000 --> 00:24:36,150
in<font color="#E5E5E5"> generic information is it relevant</font>

610
00:24:33,590 --> 00:24:37,500
<font color="#E5E5E5">somewhat it is being indexed</font><font color="#CCCCCC"> no heavy</font>

611
00:24:36,150 --> 00:24:39,150
filtering on that because<font color="#CCCCCC"> we don't</font><font color="#E5E5E5"> see</font>

612
00:24:37,500 --> 00:24:41,130
any use<font color="#CCCCCC"> for</font><font color="#E5E5E5"> it yet</font>

613
00:24:39,150 --> 00:24:43,170
then<font color="#E5E5E5"> there's screenshots not of the</font>

614
00:24:41,130 --> 00:24:45,960
target but of the Kabul strike interface

615
00:24:43,170 --> 00:24:48,390
itself can be useful if you want<font color="#E5E5E5"> to show</font>

616
00:24:45,960 --> 00:24:51,360
the very big<font color="#CCCCCC"> diagram so hey man we had a</font>

617
00:24:48,390 --> 00:24:52,710
hundred beacons which in theory sounds

618
00:24:51,360 --> 00:24:54,240
<font color="#E5E5E5">nice but</font><font color="#CCCCCC"> then the</font><font color="#E5E5E5"> latest release of</font>

619
00:24:52,710 --> 00:24:57,990
course where I could actually crashes

620
00:24:54,240 --> 00:25:00,390
<font color="#E5E5E5">above a few amount of beacons so but</font>

621
00:24:57,990 --> 00:25:01,920
yeah we at the<font color="#E5E5E5"> moment we don't sink</font>

622
00:25:00,390 --> 00:25:04,500
those yet<font color="#CCCCCC"> but we will</font><font color="#E5E5E5"> be implementing</font>

623
00:25:01,920 --> 00:25:07,020
that<font color="#E5E5E5"> later on every once in a</font><font color="#CCCCCC"> while</font>

624
00:25:04,500 --> 00:25:08,400
there's a<font color="#CCCCCC"> failed beacon we know why</font>

625
00:25:07,020 --> 00:25:10,410
could be somewhere in the<font color="#CCCCCC"> process it</font>

626
00:25:08,400 --> 00:25:12,120
just<font color="#E5E5E5"> feels it has no beacon ID yet so</font>

627
00:25:10,410 --> 00:25:14,670
<font color="#CCCCCC">that comes</font><font color="#E5E5E5"> into an unknown directory</font>

628
00:25:12,120 --> 00:25:16,830
most of the time it has no relevant

629
00:25:14,670 --> 00:25:19,770
information whatsoever<font color="#E5E5E5"> there is be</font>

630
00:25:16,830 --> 00:25:22,710
<font color="#E5E5E5">things not being indexed then it's a web</font>

631
00:25:19,770 --> 00:25:24,210
server log and a<font color="#E5E5E5"> downloads log which are</font>

632
00:25:22,710 --> 00:25:27,930
not<font color="#E5E5E5"> really useful to us because the web</font>

633
00:25:24,210 --> 00:25:30,540
server log<font color="#E5E5E5"> we</font><font color="#CCCCCC"> already have all the web</font>

634
00:25:27,930 --> 00:25:33,660
traffic from the boxes which<font color="#E5E5E5"> we'll go</font>

635
00:25:30,540 --> 00:25:35,310
through later on<font color="#E5E5E5"> and we do not tend to</font>

636
00:25:33,660 --> 00:25:37,710
<font color="#E5E5E5">use the whole</font><font color="#CCCCCC"> web site</font><font color="#E5E5E5"> functionality</font>

637
00:25:35,310 --> 00:25:39,899
<font color="#E5E5E5">that the</font><font color="#CCCCCC"> COPO strike</font><font color="#E5E5E5"> itself has we tend</font>

638
00:25:37,710 --> 00:25:41,880
to use<font color="#E5E5E5"> called strike for that's good at</font>

639
00:25:39,900 --> 00:25:43,830
doing the<font color="#CCCCCC"> beaconing</font><font color="#E5E5E5"> yeah and serving</font>

640
00:25:41,880 --> 00:25:45,270
<font color="#CCCCCC">payloads call strike can do that but we</font>

641
00:25:43,830 --> 00:25:47,340
tend to solve<font color="#E5E5E5"> that on our own and we'll</font>

642
00:25:45,270 --> 00:25:48,930
<font color="#E5E5E5">get into that later so there's a reason</font>

643
00:25:47,340 --> 00:25:50,340
that we<font color="#E5E5E5"> don't need the server locks we</font>

644
00:25:48,930 --> 00:25:53,130
don't use to use the functionality<font color="#E5E5E5"> at</font>

645
00:25:50,340 --> 00:25:54,360
all<font color="#E5E5E5"> no no no</font><font color="#CCCCCC"> URL will</font><font color="#E5E5E5"> ever point to that</font>

646
00:25:53,130 --> 00:25:56,130
part of course<font color="#CCCCCC"> arc</font>

647
00:25:54,360 --> 00:25:58,830
exactly and then there's the download

648
00:25:56,130 --> 00:26:00,270
lock which is<font color="#E5E5E5"> fun</font><font color="#CCCCCC"> but nothing</font><font color="#E5E5E5"> really</font>

649
00:25:58,830 --> 00:26:02,580
fancy<font color="#E5E5E5"> because you already have all the</font>

650
00:26:00,270 --> 00:26:05,550
downloads within<font color="#E5E5E5"> the beacon transcript</font>

651
00:26:02,580 --> 00:26:07,679
so we already<font color="#E5E5E5"> have it big important</font>

652
00:26:05,550 --> 00:26:09,120
thing you could use a<font color="#CCCCCC"> graceful script</font>

653
00:26:07,680 --> 00:26:12,870
which is<font color="#CCCCCC"> the</font><font color="#E5E5E5"> scripting language on top</font>

654
00:26:09,120 --> 00:26:14,629
<font color="#E5E5E5">of</font><font color="#CCCCCC"> Cobra try</font><font color="#E5E5E5"> to do all fancy stuff we</font>

655
00:26:12,870 --> 00:26:17,809
tend to use

656
00:26:14,630 --> 00:26:19,970
the basics<font color="#E5E5E5"> no extra scripts because well</font>

657
00:26:17,809 --> 00:26:21,620
we already<font color="#E5E5E5"> get all the all the important</font>

658
00:26:19,970 --> 00:26:23,509
<font color="#E5E5E5">stuff</font><font color="#CCCCCC"> we don't use the script to</font>

659
00:26:21,620 --> 00:26:26,059
generate<font color="#E5E5E5"> lakhs</font><font color="#CCCCCC"> because we do use we've</font>

660
00:26:23,509 --> 00:26:27,620
got we've got virtual assistants that

661
00:26:26,059 --> 00:26:30,289
<font color="#CCCCCC">does a lot which is a big scene a script</font>

662
00:26:27,620 --> 00:26:30,620
but<font color="#E5E5E5"> no for logging we don't use it at</font>

663
00:26:30,289 --> 00:26:33,559
all

664
00:26:30,620 --> 00:26:35,090
exactly just go quick<font color="#E5E5E5"> through this is</font>

665
00:26:33,559 --> 00:26:36,590
one of<font color="#CCCCCC"> the beacon transcripts</font><font color="#E5E5E5"> and one of</font>

666
00:26:35,090 --> 00:26:39,769
the important things to<font color="#E5E5E5"> mention here</font><font color="#CCCCCC"> is</font>

667
00:26:36,590 --> 00:26:42,889
<font color="#CCCCCC">that it's multi-line and every rule line</font>

668
00:26:39,769 --> 00:26:44,929
can be different so it starts<font color="#CCCCCC"> with on</font>

669
00:26:42,889 --> 00:26:46,549
the left like a<font color="#E5E5E5"> time stamp and then the</font>

670
00:26:44,929 --> 00:26:47,809
first line<font color="#CCCCCC"> of</font><font color="#E5E5E5"> every beacon transcript is</font>

671
00:26:46,549 --> 00:26:50,029
really important because it<font color="#E5E5E5"> has all</font>

672
00:26:47,809 --> 00:26:53,240
relevant metadata<font color="#E5E5E5"> enter an</font><font color="#CCCCCC"> IP address</font>

673
00:26:50,029 --> 00:26:55,220
<font color="#CCCCCC">external</font><font color="#E5E5E5"> P address the targets</font><font color="#CCCCCC"> host</font><font color="#E5E5E5"> name</font>

674
00:26:53,240 --> 00:26:57,200
the target<font color="#E5E5E5"> user name the architecture</font>

675
00:26:55,220 --> 00:27:00,409
stuff like<font color="#E5E5E5"> that all the irrelevant</font>

676
00:26:57,200 --> 00:27:01,970
<font color="#E5E5E5">information all the other lines do not</font>

677
00:27:00,409 --> 00:27:04,460
<font color="#CCCCCC">have an</font><font color="#E5E5E5"> information anymore see if you</font>

678
00:27:01,970 --> 00:27:06,320
would just process this as it would<font color="#CCCCCC"> go</font>

679
00:27:04,460 --> 00:27:08,299
<font color="#E5E5E5">through you would lose all the relevant</font>

680
00:27:06,320 --> 00:27:09,950
information so that's<font color="#E5E5E5"> why we need</font><font color="#CCCCCC"> to get</font>

681
00:27:08,299 --> 00:27:12,470
that information<font color="#E5E5E5"> as tracked it's stored</font>

682
00:27:09,950 --> 00:27:14,149
somewhere else<font color="#E5E5E5"> and then</font><font color="#CCCCCC"> injected again</font>

683
00:27:12,470 --> 00:27:17,450
with all the<font color="#CCCCCC"> different lines I will show</font>

684
00:27:14,149 --> 00:27:19,789
you<font color="#E5E5E5"> later on there are inputs tasks in</font>

685
00:27:17,450 --> 00:27:22,370
this case mark enter the<font color="#CCCCCC"> get</font><font color="#E5E5E5"> system</font>

686
00:27:19,789 --> 00:27:24,889
which starts a service that results<font color="#E5E5E5"> into</font>

687
00:27:22,370 --> 00:27:29,120
an IOC<font color="#E5E5E5"> which is being printed over there</font>

688
00:27:24,889 --> 00:27:33,199
that<font color="#E5E5E5"> got indexed and we ran a</font><font color="#CCCCCC"> screenshot</font>

689
00:27:29,120 --> 00:27:35,600
<font color="#E5E5E5">and</font><font color="#CCCCCC"> we did some passwords</font><font color="#E5E5E5"> to get memory</font>

690
00:27:33,200 --> 00:27:37,129
cards<font color="#CCCCCC"> outputs which</font><font color="#E5E5E5"> is multi-line you</font>

691
00:27:35,600 --> 00:27:39,019
can see here<font color="#E5E5E5"> that it's totally different</font>

692
00:27:37,129 --> 00:27:40,459
<font color="#E5E5E5">from how you would find</font><font color="#CCCCCC"> lock lines in</font>

693
00:27:39,019 --> 00:27:43,009
<font color="#CCCCCC">sis lock where all the information is</font>

694
00:27:40,460 --> 00:27:46,039
<font color="#CCCCCC">always on the</font><font color="#E5E5E5"> same line it's not</font><font color="#CCCCCC"> the</font>

695
00:27:43,009 --> 00:27:49,240
case in called strike so looking<font color="#E5E5E5"> at the</font>

696
00:27:46,039 --> 00:27:52,639
<font color="#E5E5E5">a proxy locks that's more like syslog</font>

697
00:27:49,240 --> 00:27:55,460
<font color="#E5E5E5">type the important things here are that</font>

698
00:27:52,639 --> 00:27:58,129
there's like the basic system identifier

699
00:27:55,460 --> 00:28:00,139
<font color="#E5E5E5">and now we have a front end and a back</font>

700
00:27:58,129 --> 00:28:01,699
<font color="#E5E5E5">end and the front end is like the</font>

701
00:28:00,139 --> 00:28:03,559
<font color="#E5E5E5">interface where</font><font color="#CCCCCC"> the proxy got the</font>

702
00:28:01,700 --> 00:28:05,539
incoming traffic from and the back end

703
00:28:03,559 --> 00:28:08,539
<font color="#CCCCCC">is how it's after all the filtering</font>

704
00:28:05,539 --> 00:28:10,639
<font color="#CCCCCC">rules</font><font color="#E5E5E5"> decided to go for the specific</font>

705
00:28:08,539 --> 00:28:13,789
back end so in this case traffic came in

706
00:28:10,639 --> 00:28:17,629
<font color="#CCCCCC">via the interface that</font><font color="#E5E5E5"> we defined that</font>

707
00:28:13,789 --> 00:28:20,210
we named<font color="#CCCCCC"> WWE</font><font color="#E5E5E5"> HTTP antivirus on that</font>

708
00:28:17,629 --> 00:28:24,139
specific IP address and we redirected to

709
00:28:20,210 --> 00:28:25,700
the back<font color="#CCCCCC"> end W the W</font><font color="#E5E5E5"> decoy</font>

710
00:28:24,140 --> 00:28:27,200
you will see that there<font color="#CCCCCC"> are I P</font>

711
00:28:25,700 --> 00:28:30,800
addresses mentioned<font color="#E5E5E5"> also include the</font>

712
00:28:27,200 --> 00:28:32,870
ffff which is nowadays<font color="#CCCCCC"> Linux mentions</font>

713
00:28:30,800 --> 00:28:35,389
ipv4 addresses when you have<font color="#E5E5E5"> ipv6</font>

714
00:28:32,870 --> 00:28:37,729
<font color="#E5E5E5">enabled</font><font color="#CCCCCC"> in this way and we filter out</font>

715
00:28:35,390 --> 00:28:39,920
<font color="#CCCCCC">those</font><font color="#E5E5E5"> FFF s already unlocks - no worry</font>

716
00:28:37,730 --> 00:28:42,050
there<font color="#CCCCCC"> may be it's good to add something</font>

717
00:28:39,920 --> 00:28:44,410
<font color="#E5E5E5">on why we split on our redirect if you</font>

718
00:28:42,050 --> 00:28:47,240
split the traffic<font color="#E5E5E5"> so much we have our</font><font color="#CCCCCC"> c2</font>

719
00:28:44,410 --> 00:28:48,710
<font color="#E5E5E5">so our command and</font><font color="#CCCCCC"> control data that</font>

720
00:28:47,240 --> 00:28:50,240
goes to cope with<font color="#E5E5E5"> stripe see we can</font>

721
00:28:48,710 --> 00:28:52,130
<font color="#CCCCCC">actually steer the beacons that are out</font>

722
00:28:50,240 --> 00:28:54,230
<font color="#CCCCCC">there in the field on</font><font color="#E5E5E5"> the laptops but if</font>

723
00:28:52,130 --> 00:28:56,510
we have an investigator<font color="#CCCCCC"> the technical</font>

724
00:28:54,230 --> 00:28:59,180
<font color="#CCCCCC">investigator</font><font color="#E5E5E5"> searching for one</font><font color="#CCCCCC"> of the</font>

725
00:28:56,510 --> 00:29:01,580
<font color="#E5E5E5">URLs we use we like to catch that URL if</font>

726
00:28:59,180 --> 00:29:03,590
it's just to get from / or<font color="#E5E5E5"> index dot PHP</font>

727
00:29:01,580 --> 00:29:05,659
or whatever you<font color="#CCCCCC"> like</font><font color="#E5E5E5"> to catch that and</font>

728
00:29:03,590 --> 00:29:07,250
send that to<font color="#CCCCCC"> a decoy</font><font color="#E5E5E5"> size in our case</font>

729
00:29:05,660 --> 00:29:09,350
it's quite<font color="#E5E5E5"> often a locally hosted</font><font color="#CCCCCC"> patchy</font>

730
00:29:07,250 --> 00:29:12,950
on<font color="#CCCCCC"> all the ports and</font><font color="#E5E5E5"> it might show some</font>

731
00:29:09,350 --> 00:29:14,929
<font color="#E5E5E5">complex JSON which looks like financial</font>

732
00:29:12,950 --> 00:29:18,440
information so<font color="#E5E5E5"> even</font><font color="#CCCCCC"> if the investigator</font>

733
00:29:14,930 --> 00:29:21,020
thinks<font color="#E5E5E5"> it might not it might be somewhat</font>

734
00:29:18,440 --> 00:29:22,880
evil<font color="#E5E5E5"> in a financial institute you could</font>

735
00:29:21,020 --> 00:29:25,300
cut quite some<font color="#CCCCCC"> goods if you bring down</font>

736
00:29:22,880 --> 00:29:28,970
an interface that<font color="#E5E5E5"> might be a valid</font><font color="#CCCCCC"> API</font>

737
00:29:25,300 --> 00:29:30,620
<font color="#E5E5E5">so it's also already a reason to trigger</font>

738
00:29:28,970 --> 00:29:33,410
the blue team<font color="#CCCCCC"> in thinking</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> thinking</font>

739
00:29:30,620 --> 00:29:35,389
further<font color="#E5E5E5"> so the decoy side in our case is</font>

740
00:29:33,410 --> 00:29:37,040
often<font color="#E5E5E5"> not an empty side it</font><font color="#CCCCCC"> actually</font>

741
00:29:35,390 --> 00:29:40,130
mimics something that<font color="#CCCCCC"> much that looks</font>

742
00:29:37,040 --> 00:29:41,960
important<font color="#CCCCCC"> ok and then if you want</font><font color="#E5E5E5"> to</font>

743
00:29:40,130 --> 00:29:44,300
have the full user agent and<font color="#CCCCCC"> a full body</font>

744
00:29:41,960 --> 00:29:46,310
<font color="#CCCCCC">you need to use those custom login</font>

745
00:29:44,300 --> 00:29:47,659
format that<font color="#E5E5E5"> we have within a proxy if</font>

746
00:29:46,310 --> 00:29:50,690
you don't use that<font color="#E5E5E5"> you will not get the</font>

747
00:29:47,660 --> 00:29:54,100
information<font color="#E5E5E5"> and</font><font color="#CCCCCC"> that requires this</font><font color="#E5E5E5"> so</font>

748
00:29:50,690 --> 00:29:56,900
yeah<font color="#E5E5E5"> so</font><font color="#CCCCCC"> we got all those logs but</font>

749
00:29:54,100 --> 00:29:58,429
they're just<font color="#E5E5E5"> logs we want to enrich them</font>

750
00:29:56,900 --> 00:30:00,650
<font color="#E5E5E5">we want to</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> like the cool granny</font><font color="#CCCCCC"> we</font>

751
00:29:58,430 --> 00:30:02,990
want to be super cool<font color="#E5E5E5"> enriched with all</font>

752
00:30:00,650 --> 00:30:05,380
the<font color="#CCCCCC"> bling-bling so how do we</font><font color="#E5E5E5"> get</font><font color="#CCCCCC"> more</font>

753
00:30:02,990 --> 00:30:07,100
bling bling<font color="#CCCCCC"> with in copper strike we</font>

754
00:30:05,380 --> 00:30:08,870
remember the first line with the

755
00:30:07,100 --> 00:30:10,730
metadata info we<font color="#CCCCCC"> inject it every time</font>

756
00:30:08,870 --> 00:30:12,439
again for<font color="#E5E5E5"> every specific rules</font><font color="#CCCCCC"> so every</font>

757
00:30:10,730 --> 00:30:14,660
line<font color="#CCCCCC"> that is</font><font color="#E5E5E5"> being logged has that</font>

758
00:30:12,440 --> 00:30:16,250
<font color="#E5E5E5">specific information makes it easy to</font>

759
00:30:14,660 --> 00:30:18,590
<font color="#E5E5E5">create for specific host names user</font>

760
00:30:16,250 --> 00:30:20,660
names etc<font color="#E5E5E5"> for the he director for a</font>

761
00:30:18,590 --> 00:30:24,230
traffic<font color="#CCCCCC"> that we do all the</font><font color="#E5E5E5"> gyps reverse</font>

762
00:30:20,660 --> 00:30:26,270
<font color="#CCCCCC">dns</font><font color="#E5E5E5"> see who the IP block owner is that</font>

763
00:30:24,230 --> 00:30:28,100
<font color="#CCCCCC">will easily</font><font color="#E5E5E5"> let you identify if you're</font>

764
00:30:26,270 --> 00:30:30,889
being<font color="#CCCCCC"> queried</font><font color="#E5E5E5"> by for example say</font>

765
00:30:28,100 --> 00:30:33,439
<font color="#CCCCCC">semantic which does all the scanning</font>

766
00:30:30,890 --> 00:30:35,060
from<font color="#E5E5E5"> their own IP block which</font><font color="#CCCCCC"> is marked</font>

767
00:30:33,440 --> 00:30:36,840
as<font color="#CCCCCC"> being from Symantec so</font><font color="#E5E5E5"> you will</font>

768
00:30:35,060 --> 00:30:38,908
easily identify that this<font color="#E5E5E5"> is</font>

769
00:30:36,840 --> 00:30:39,959
<font color="#CCCCCC">-</font><font color="#E5E5E5"> semantics as well guys if you start</font>

770
00:30:38,909 --> 00:30:42,629
scanning stuff on the<font color="#CCCCCC"> Internet</font>

771
00:30:39,960 --> 00:30:46,049
don't do<font color="#E5E5E5"> it from</font><font color="#CCCCCC"> your own IP block we do</font>

772
00:30:42,629 --> 00:30:48,120
some<font color="#E5E5E5"> background processes that do system</font>

773
00:30:46,049 --> 00:30:50,429
classification<font color="#E5E5E5"> we set tax for known test</font>

774
00:30:48,120 --> 00:30:52,590
systems and known<font color="#CCCCCC"> send boxes and the</font>

775
00:30:50,429 --> 00:30:55,169
same goes<font color="#CCCCCC"> for</font><font color="#E5E5E5"> on the traffic data if</font>

776
00:30:52,590 --> 00:30:57,240
it's<font color="#E5E5E5"> a</font><font color="#CCCCCC"> tor node we</font><font color="#E5E5E5"> take that if it's</font>

777
00:30:55,169 --> 00:30:59,009
within the IP list of the customer that

778
00:30:57,240 --> 00:31:00,360
<font color="#CCCCCC">your being</font><font color="#E5E5E5"> that you're attacking or if</font>

779
00:30:59,009 --> 00:31:03,809
it's your own<font color="#CCCCCC"> or a team that's been</font>

780
00:31:00,360 --> 00:31:07,498
connecting<font color="#E5E5E5"> we set attack there's also a</font>

781
00:31:03,809 --> 00:31:10,230
list<font color="#E5E5E5"> I P list unknown for which you do</font>

782
00:31:07,499 --> 00:31:11,879
not<font color="#E5E5E5"> know what it is just</font><font color="#CCCCCC"> yet but</font><font color="#E5E5E5"> you</font>

783
00:31:10,230 --> 00:31:14,039
<font color="#E5E5E5">want to suppress the alarm</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> you see</font>

784
00:31:11,879 --> 00:31:15,570
the IP address<font color="#E5E5E5"> coming in every time but</font>

785
00:31:14,039 --> 00:31:18,049
<font color="#CCCCCC">you want to</font><font color="#E5E5E5"> suppress the alarm you put</font>

786
00:31:15,570 --> 00:31:22,158
it in<font color="#E5E5E5"> there and then</font><font color="#CCCCCC"> that's great nice</font>

787
00:31:18,049 --> 00:31:25,320
hands for people that know great noise

788
00:31:22,159 --> 00:31:29,190
<font color="#E5E5E5">it's a few few</font><font color="#CCCCCC"> ok</font><font color="#E5E5E5"> so for the rest the</font>

789
00:31:25,320 --> 00:31:32,460
gray noise is a scanner for<font color="#CCCCCC"> internet</font>

790
00:31:29,190 --> 00:31:34,139
scanners and it indexes all the

791
00:31:32,460 --> 00:31:35,279
different scanners<font color="#CCCCCC"> that are</font><font color="#E5E5E5"> out there so</font>

792
00:31:34,139 --> 00:31:37,080
that<font color="#E5E5E5"> one</font><font color="#CCCCCC"> of the scanners could</font><font color="#E5E5E5"> be</font>

793
00:31:35,279 --> 00:31:39,990
<font color="#CCCCCC">showdown</font><font color="#E5E5E5"> or it could be Google or it</font>

794
00:31:37,080 --> 00:31:43,168
could be one of<font color="#E5E5E5"> the universities doing</font>

795
00:31:39,990 --> 00:31:45,389
international incidents<font color="#E5E5E5"> wide scanning</font>

796
00:31:43,169 --> 00:31:48,570
gray noise<font color="#E5E5E5"> indexes those gives them a</font>

797
00:31:45,389 --> 00:31:51,178
<font color="#CCCCCC">classification it also includes all</font>

798
00:31:48,570 --> 00:31:53,158
kinds of vulnerability scanners that are

799
00:31:51,179 --> 00:31:55,980
just<font color="#E5E5E5"> scanning for a specific aperture</font>

800
00:31:53,159 --> 00:31:57,899
query ambient your specific<font color="#CCCCCC"> technical</font>

801
00:31:55,980 --> 00:31:59,220
<font color="#CCCCCC">number this</font><font color="#E5E5E5"> stuff like that for</font><font color="#CCCCCC"> us</font><font color="#E5E5E5"> it's</font>

802
00:31:57,899 --> 00:32:00,899
really important<font color="#E5E5E5"> because if</font><font color="#CCCCCC"> gray noise</font>

803
00:31:59,220 --> 00:32:03,720
has<font color="#CCCCCC"> knowledge</font><font color="#E5E5E5"> of the IP address being</font>

804
00:32:00,899 --> 00:32:05,459
that's connecting to us it's<font color="#E5E5E5"> like a</font>

805
00:32:03,720 --> 00:32:07,529
normal teen<font color="#CCCCCC"> Erik scanner</font><font color="#E5E5E5"> it's not going</font>

806
00:32:05,460 --> 00:32:10,499
to be the blue team so we include this

807
00:32:07,529 --> 00:32:12,059
data to have like a boolean filter well

808
00:32:10,499 --> 00:32:14,220
if great noise<font color="#E5E5E5"> now is it not interesting</font>

809
00:32:12,059 --> 00:32:16,049
<font color="#CCCCCC">for and the other</font><font color="#E5E5E5"> way around is even</font>

810
00:32:14,220 --> 00:32:17,909
more<font color="#E5E5E5"> interesting if we get scanned by an</font>

811
00:32:16,049 --> 00:32:20,629
IP address<font color="#CCCCCC"> that</font><font color="#E5E5E5"> that gray noise doesn't</font>

812
00:32:17,909 --> 00:32:23,480
<font color="#E5E5E5">know yeah then it's so on who'd choose</font>

813
00:32:20,629 --> 00:32:27,418
<font color="#E5E5E5">himself to specifically scanners that</font>

814
00:32:23,480 --> 00:32:29,610
<font color="#CCCCCC">might be blue okay so usability</font>

815
00:32:27,419 --> 00:32:34,039
improvements to get quick hyperlinks

816
00:32:29,610 --> 00:32:34,039
which I think I can<font color="#E5E5E5"> just show you</font>

817
00:32:34,220 --> 00:32:44,429
let me see if I can get this somewhat

818
00:32:38,309 --> 00:32:49,559
readable<font color="#E5E5E5"> welcome to it at ELQ</font><font color="#CCCCCC"> you see</font>

819
00:32:44,429 --> 00:32:52,409
the fancy logo<font color="#CCCCCC"> I apologize he made me do</font>

820
00:32:49,559 --> 00:32:56,220
it<font color="#CCCCCC"> so welcome</font><font color="#E5E5E5"> to just a normal key Bona</font>

821
00:32:52,409 --> 00:32:58,710
interface<font color="#CCCCCC"> from here you</font><font color="#E5E5E5"> can go to like</font>

822
00:32:56,220 --> 00:33:02,220
fancy fancy dashboards<font color="#CCCCCC"> that everybody</font>

823
00:32:58,710 --> 00:33:04,500
likes<font color="#CCCCCC"> this</font><font color="#E5E5E5"> is a dashboard showing the</font>

824
00:33:02,220 --> 00:33:07,470
<font color="#CCCCCC">current or the historic beacons</font><font color="#E5E5E5"> from the</font>

825
00:33:04,500 --> 00:33:10,049
last 30<font color="#CCCCCC"> days so on top</font><font color="#E5E5E5"> right you select</font>

826
00:33:07,470 --> 00:33:12,059
<font color="#E5E5E5">the time monolith beacons we we use this</font>

827
00:33:10,049 --> 00:33:14,370
<font color="#CCCCCC">setup</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> just generating some documents</font>

828
00:33:12,059 --> 00:33:17,700
<font color="#CCCCCC">in 72</font><font color="#E5E5E5"> virustotal</font><font color="#CCCCCC"> wants a lot of</font><font color="#E5E5E5"> public</font>

829
00:33:14,370 --> 00:33:20,699
scanners and we got beacons back you can

830
00:33:17,700 --> 00:33:24,539
do<font color="#E5E5E5"> selection from specific users and</font>

831
00:33:20,700 --> 00:33:27,240
specific systems<font color="#CCCCCC"> stuff like</font><font color="#E5E5E5"> that and the</font>

832
00:33:24,539 --> 00:33:30,120
top<font color="#CCCCCC"> views in</font><font color="#E5E5E5"> this case was</font><font color="#CCCCCC"> that specific</font>

833
00:33:27,240 --> 00:33:32,789
user<font color="#E5E5E5"> different dashboards also for</font>

834
00:33:30,120 --> 00:33:34,199
traffic<font color="#E5E5E5"> people like seeing the globe</font><font color="#CCCCCC"> so</font>

835
00:33:32,789 --> 00:33:38,490
that's why we put<font color="#CCCCCC"> it in there</font>

836
00:33:34,200 --> 00:33:40,260
and you<font color="#CCCCCC"> make a difference between</font><font color="#E5E5E5"> all</font>

837
00:33:38,490 --> 00:33:42,059
the traffic<font color="#CCCCCC"> and maybe you wanted to</font>

838
00:33:40,260 --> 00:33:44,700
<font color="#E5E5E5">specify between traffic being destined</font>

839
00:33:42,059 --> 00:33:47,190
for call strike and all the other decode

840
00:33:44,700 --> 00:33:48,870
traffic<font color="#E5E5E5"> so easy overviews this is just</font>

841
00:33:47,190 --> 00:33:50,250
the basic this<font color="#E5E5E5"> is included into</font><font color="#CCCCCC"> a talk</font>

842
00:33:48,870 --> 00:33:52,709
if<font color="#E5E5E5"> you install</font><font color="#CCCCCC"> that you will get</font><font color="#E5E5E5"> this</font>

843
00:33:50,250 --> 00:33:56,070
but you of<font color="#E5E5E5"> course you can</font><font color="#CCCCCC"> adjust all</font><font color="#E5E5E5"> to</font>

844
00:33:52,710 --> 00:33:57,929
your liking<font color="#E5E5E5"> so let's go searching the</font>

845
00:33:56,070 --> 00:33:59,730
most important thing is to<font color="#CCCCCC"> click the</font>

846
00:33:57,929 --> 00:34:03,049
open thing and you will get an<font color="#CCCCCC"> overview</font>

847
00:33:59,730 --> 00:34:08,550
<font color="#CCCCCC">of IOC is keystroke this is just typical</font>

848
00:34:03,049 --> 00:34:10,139
<font color="#E5E5E5">links for easy to see both of</font><font color="#CCCCCC"> you I mean</font>

849
00:34:08,550 --> 00:34:11,550
it's queries for using<font color="#CCCCCC"> the Bailey days</font>

850
00:34:10,139 --> 00:34:12,960
while we<font color="#CCCCCC"> are in Europe here in</font><font color="#E5E5E5"> the</font>

851
00:34:11,550 --> 00:34:15,030
operation that's<font color="#E5E5E5"> likely want to have</font>

852
00:34:12,960 --> 00:34:17,730
<font color="#CCCCCC">open on a</font><font color="#E5E5E5"> browser to</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> able to go</font>

853
00:34:15,030 --> 00:34:19,260
<font color="#E5E5E5">through this</font><font color="#CCCCCC"> timestamp the specific are</font>

854
00:34:17,730 --> 00:34:20,829
<font color="#E5E5E5">toxin</font><font color="#CCCCCC"> error that you gave with this</font>

855
00:34:19,260 --> 00:34:22,509
operation

856
00:34:20,829 --> 00:34:24,639
and then there's the user<font color="#CCCCCC"> target</font>

857
00:34:22,509 --> 00:34:26,139
internal IP address the beacon ID target

858
00:34:24,639 --> 00:34:29,919
<font color="#CCCCCC">host name target aware star could</font>

859
00:34:26,139 --> 00:34:32,829
<font color="#E5E5E5">Windows version and it's not really big</font>

860
00:34:29,918 --> 00:34:36,359
<font color="#CCCCCC">enough of course it also includes the</font>

861
00:34:32,829 --> 00:34:38,859
specific<font color="#E5E5E5"> command that was being entered</font>

862
00:34:36,359 --> 00:34:43,869
this is just a simple<font color="#E5E5E5"> overview the full</font>

863
00:34:38,859 --> 00:34:45,268
data is in every every star every<font color="#E5E5E5"> record</font>

864
00:34:43,869 --> 00:34:49,869
so it will give you all<font color="#CCCCCC"> the different</font>

865
00:34:45,268 --> 00:34:51,819
messages<font color="#CCCCCC"> that you can</font><font color="#E5E5E5"> query on so let's</font>

866
00:34:49,869 --> 00:34:54,669
say I want to see<font color="#CCCCCC"> everything with this</font>

867
00:34:51,819 --> 00:35:00,160
<font color="#CCCCCC">specific IP address which is going</font><font color="#E5E5E5"> to be</font>

868
00:34:54,668 --> 00:35:01,420
<font color="#E5E5E5">from that specific</font><font color="#CCCCCC"> director so if you</font>

869
00:35:00,160 --> 00:35:03,819
have multiple<font color="#CCCCCC"> he directors you can</font>

870
00:35:01,420 --> 00:35:05,459
select<font color="#E5E5E5"> what just this grave the data you</font>

871
00:35:03,819 --> 00:35:09,279
want<font color="#E5E5E5"> to see you from that leader factor</font>

872
00:35:05,459 --> 00:35:13,989
<font color="#E5E5E5">and it will there this is just typical</font>

873
00:35:09,279 --> 00:35:16,239
law typical<font color="#CCCCCC"> Cubana</font><font color="#E5E5E5"> stuff it takes a</font>

874
00:35:13,989 --> 00:35:17,950
while<font color="#CCCCCC"> to</font><font color="#E5E5E5"> get</font><font color="#CCCCCC"> used to it by the way I've</font>

875
00:35:16,239 --> 00:35:19,839
been cursing<font color="#E5E5E5"> along for a</font><font color="#CCCCCC"> few days but</font>

876
00:35:17,950 --> 00:35:22,299
once you<font color="#E5E5E5"> get the hang it's really quick</font>

877
00:35:19,839 --> 00:35:23,920
<font color="#E5E5E5">to find stuff</font><font color="#CCCCCC"> that was beacons this is</font>

878
00:35:22,299 --> 00:35:26,049
just traffic<font color="#CCCCCC"> did you see from the heat</font>

879
00:35:23,920 --> 00:35:27,699
detector<font color="#CCCCCC"> say</font><font color="#E5E5E5"> again you see the the</font>

880
00:35:26,049 --> 00:35:29,440
strings that<font color="#E5E5E5"> we inserted into</font><font color="#CCCCCC"> the H</font><font color="#E5E5E5"> a</font>

881
00:35:27,699 --> 00:35:33,009
proxy locks<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> it's right being</font>

882
00:35:29,440 --> 00:35:34,719
<font color="#E5E5E5">detected here you see the owner the</font>

883
00:35:33,009 --> 00:35:38,529
specific request<font color="#CCCCCC"> was</font><font color="#E5E5E5"> being made and</font>

884
00:35:34,719 --> 00:35:40,390
stuff<font color="#E5E5E5"> like that so that's not that's</font>

885
00:35:38,529 --> 00:35:41,440
really<font color="#E5E5E5"> helpful really helpful and you</font>

886
00:35:40,390 --> 00:35:44,129
can do the creating with this but

887
00:35:41,440 --> 00:35:49,299
usability wise we want to see easy

888
00:35:44,130 --> 00:35:50,619
keystrokes<font color="#E5E5E5"> for example boom and if</font>

889
00:35:49,299 --> 00:35:53,940
that's not<font color="#E5E5E5"> enough then you can</font><font color="#CCCCCC"> just</font>

890
00:35:50,619 --> 00:35:58,469
<font color="#CCCCCC">simply click this link</font><font color="#E5E5E5"> and get the</font><font color="#CCCCCC"> full</font>

891
00:35:53,940 --> 00:36:01,479
beacon and there you have<font color="#CCCCCC"> the the data</font>

892
00:35:58,469 --> 00:36:08,079
<font color="#E5E5E5">that allows you for quicker quicker</font>

893
00:36:01,479 --> 00:36:09,999
searching easier searching how about

894
00:36:08,079 --> 00:36:11,890
seeing screenshots<font color="#E5E5E5"> if you're in a bigger</font>

895
00:36:09,999 --> 00:36:13,808
operation<font color="#E5E5E5"> and you have a hundred</font>

896
00:36:11,890 --> 00:36:17,078
different<font color="#E5E5E5"> screenshots then all you want</font>

897
00:36:13,809 --> 00:36:18,369
to do is having a simple overview<font color="#E5E5E5"> you</font>

898
00:36:17,079 --> 00:36:20,199
still<font color="#E5E5E5"> remember that one single</font>

899
00:36:18,369 --> 00:36:21,699
screenshot at the<font color="#E5E5E5"> user desktop where</font>

900
00:36:20,199 --> 00:36:23,229
<font color="#E5E5E5">outlook was open or that specific</font>

901
00:36:21,699 --> 00:36:27,099
application was open but you don't know

902
00:36:23,229 --> 00:36:29,769
on<font color="#CCCCCC"> what team server it was</font><font color="#E5E5E5"> anymore using</font>

903
00:36:27,099 --> 00:36:32,049
this<font color="#E5E5E5"> you can click on the image or</font><font color="#CCCCCC"> you</font>

904
00:36:29,769 --> 00:36:33,879
can just simply browse and<font color="#E5E5E5"> have</font>

905
00:36:32,049 --> 00:36:36,400
thumbnails<font color="#E5E5E5"> of it to have just that that</font>

906
00:36:33,880 --> 00:36:44,500
<font color="#E5E5E5">instant view click on it and</font><font color="#CCCCCC"> you'll get</font>

907
00:36:36,400 --> 00:36:51,490
default image anything<font color="#E5E5E5"> else on here you</font>

908
00:36:44,500 --> 00:36:53,410
guys<font color="#E5E5E5"> think is a useful yeah thank you a</font>

909
00:36:51,490 --> 00:36:54,578
lot<font color="#E5E5E5"> of work into this</font><font color="#CCCCCC"> especially</font><font color="#E5E5E5"> on the</font>

910
00:36:53,410 --> 00:36:56,920
lock session filtering<font color="#E5E5E5"> and enrichment</font>

911
00:36:54,579 --> 00:36:58,690
<font color="#E5E5E5">and we're just giving it away because we</font>

912
00:36:56,920 --> 00:37:00,700
think that<font color="#CCCCCC"> the humours need to up their</font>

913
00:36:58,690 --> 00:37:02,020
game<font color="#CCCCCC"> this needs to</font><font color="#E5E5E5"> be</font><font color="#CCCCCC"> available</font><font color="#E5E5E5"> to</font>

914
00:37:00,700 --> 00:37:05,890
everybody so<font color="#E5E5E5"> and that's what we did</font>

915
00:37:02,020 --> 00:37:08,170
<font color="#CCCCCC">artwork we do like you</font><font color="#E5E5E5"> to actually help</font>

916
00:37:05,890 --> 00:37:10,180
us improve this further<font color="#E5E5E5"> so do your thing</font>

917
00:37:08,170 --> 00:37:11,710
<font color="#CCCCCC">go and try</font><font color="#E5E5E5"> it out that's it's built it's</font>

918
00:37:10,180 --> 00:37:15,069
built to be disposable<font color="#E5E5E5"> that means</font>

919
00:37:11,710 --> 00:37:18,400
installation is a breeze<font color="#E5E5E5"> yeah so IOC is</font>

920
00:37:15,069 --> 00:37:20,380
simple overview<font color="#CCCCCC"> it'll print everything</font>

921
00:37:18,400 --> 00:37:23,740
<font color="#E5E5E5">the data is within a couple strike and</font>

922
00:37:20,380 --> 00:37:25,630
of course this<font color="#E5E5E5"> being elastic search you</font>

923
00:37:23,740 --> 00:37:27,430
<font color="#E5E5E5">can simply just generate a CSV and</font><font color="#CCCCCC"> will</font>

924
00:37:25,630 --> 00:37:32,920
give you all<font color="#E5E5E5"> the output</font><font color="#CCCCCC"> and stuff like</font>

925
00:37:27,430 --> 00:37:35,558
that<font color="#E5E5E5"> so</font><font color="#CCCCCC"> I think we so instead of</font>

926
00:37:32,920 --> 00:37:37,119
spending<font color="#CCCCCC"> three days on making our final</font>

927
00:37:35,559 --> 00:37:38,619
log when we write a report for<font color="#CCCCCC"> the</font>

928
00:37:37,119 --> 00:37:40,539
customer you can<font color="#E5E5E5"> just export a full</font>

929
00:37:38,619 --> 00:37:41,799
<font color="#E5E5E5">timeline of what happened when which</font>

930
00:37:40,539 --> 00:37:42,660
commanders were entered and what the

931
00:37:41,799 --> 00:37:44,980
result was

932
00:37:42,660 --> 00:37:46,569
<font color="#CCCCCC">saves a lot</font><font color="#E5E5E5"> of time as well</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> thing I</font>

933
00:37:44,980 --> 00:37:48,069
forgot<font color="#CCCCCC"> but if you in the big</font><font color="#E5E5E5"> an overview</font>

934
00:37:46,569 --> 00:37:49,990
you can<font color="#E5E5E5"> simply click on the link</font><font color="#CCCCCC"> and</font>

935
00:37:48,069 --> 00:37:52,150
every specific<font color="#CCCCCC"> bigger</font><font color="#E5E5E5"> rule to get the</font>

936
00:37:49,990 --> 00:38:00,029
full transcript of<font color="#CCCCCC"> the specific beacons</font>

937
00:37:52,150 --> 00:38:00,029
so you no longer<font color="#E5E5E5"> need to search okay</font>

938
00:38:02,760 --> 00:38:07,200
and then there is<font color="#E5E5E5"> the</font><font color="#CCCCCC"> silence lady</font>

939
00:38:08,840 --> 00:38:12,590
now we can track<font color="#E5E5E5"> whatever we are doing</font>

940
00:38:10,970 --> 00:38:14,629
during<font color="#E5E5E5"> our assignments but that's not</font>

941
00:38:12,590 --> 00:38:16,040
how we started this talk and<font color="#E5E5E5"> now we can</font>

942
00:38:14,630 --> 00:38:18,230
see<font color="#E5E5E5"> what we've been</font><font color="#CCCCCC"> doing do you want</font>

943
00:38:16,040 --> 00:38:20,180
the blue<font color="#E5E5E5"> team did but yeah how do you</font>

944
00:38:18,230 --> 00:38:22,610
<font color="#E5E5E5">see the blue team they're back at the</font>

945
00:38:20,180 --> 00:38:25,270
<font color="#CCCCCC">customer side in some heading room often</font>

946
00:38:22,610 --> 00:38:27,770
<font color="#E5E5E5">and you don't see them but quite often</font>

947
00:38:25,270 --> 00:38:30,140
<font color="#E5E5E5">the blue team isn't as silent as they</font>

948
00:38:27,770 --> 00:38:32,240
should be<font color="#E5E5E5"> actually not</font><font color="#CCCCCC"> at all</font><font color="#E5E5E5"> and</font>

949
00:38:30,140 --> 00:38:35,029
<font color="#E5E5E5">especially now when we sit on this pile</font>

950
00:38:32,240 --> 00:38:37,189
of gold<font color="#CCCCCC"> with</font><font color="#E5E5E5"> enrich the information how</font>

951
00:38:35,030 --> 00:38:38,720
can<font color="#CCCCCC"> we</font><font color="#E5E5E5"> feel that this blue team out</font><font color="#CCCCCC"> had</font>

952
00:38:37,190 --> 00:38:40,910
the<font color="#E5E5E5"> information</font><font color="#CCCCCC"> we have</font><font color="#E5E5E5"> is all the</font>

953
00:38:38,720 --> 00:38:44,000
<font color="#E5E5E5">information about the sea to the sea to</font>

954
00:38:40,910 --> 00:38:46,250
traffic we already have and<font color="#CCCCCC"> also all the</font>

955
00:38:44,000 --> 00:38:48,590
information about<font color="#E5E5E5"> any noise</font><font color="#CCCCCC"> that might</font>

956
00:38:46,250 --> 00:38:52,700
hit how our systems<font color="#E5E5E5"> and somewhere in</font>

957
00:38:48,590 --> 00:38:55,760
there there might be blue so there's

958
00:38:52,700 --> 00:38:57,799
another<font color="#E5E5E5"> component edit and IOC sources</font>

959
00:38:55,760 --> 00:39:01,730
<font color="#E5E5E5">this basically it's it's a bunch of</font>

960
00:38:57,800 --> 00:39:04,060
<font color="#E5E5E5">Python scripts that will query random or</font>

961
00:39:01,730 --> 00:39:07,730
<font color="#E5E5E5">not random</font><font color="#CCCCCC"> that will</font><font color="#E5E5E5"> query a number of</font>

962
00:39:04,060 --> 00:39:10,880
<font color="#CCCCCC">IOC sources and test hashes we won't</font>

963
00:39:07,730 --> 00:39:16,070
upload our<font color="#E5E5E5"> own payloads of course but we</font>

964
00:39:10,880 --> 00:39:19,850
can ask<font color="#E5E5E5"> to public as a service provider</font>

965
00:39:16,070 --> 00:39:21,890
<font color="#E5E5E5">have you seen this hash before</font><font color="#CCCCCC"> and if</font>

966
00:39:19,850 --> 00:39:22,970
we're if we're lucky<font color="#E5E5E5"> we'll say no I've</font>

967
00:39:21,890 --> 00:39:25,190
never<font color="#CCCCCC"> seen</font><font color="#E5E5E5"> it has before</font>

968
00:39:22,970 --> 00:39:27,470
<font color="#E5E5E5">but quite often during</font><font color="#CCCCCC"> the operation we</font>

969
00:39:25,190 --> 00:39:29,270
certainly<font color="#E5E5E5"> got a hit and it says yes I've</font>

970
00:39:27,470 --> 00:39:31,910
seen<font color="#E5E5E5"> a</font><font color="#CCCCCC"> file but that hash being uploaded</font>

971
00:39:29,270 --> 00:39:34,640
yesterday evening and we know for sure

972
00:39:31,910 --> 00:39:36,950
<font color="#CCCCCC">something is wrong at</font><font color="#E5E5E5"> least we made a</font>

973
00:39:34,640 --> 00:39:39,680
detection possible and we need to up our

974
00:39:36,950 --> 00:39:41,390
game<font color="#E5E5E5"> or shift around or I mean I stopped</font>

975
00:39:39,680 --> 00:39:44,480
playing<font color="#E5E5E5"> with</font><font color="#CCCCCC"> that we</font><font color="#E5E5E5"> just entered the</font>

976
00:39:41,390 --> 00:39:46,490
next<font color="#E5E5E5"> phase of a red team basically so</font>

977
00:39:44,480 --> 00:39:48,770
now we've made connectors to<font color="#E5E5E5"> virustotal</font>

978
00:39:46,490 --> 00:39:51,140
which<font color="#E5E5E5"> is rate limited but with proper</font>

979
00:39:48,770 --> 00:39:54,320
caching<font color="#CCCCCC"> you can get around that as we</font>

980
00:39:51,140 --> 00:39:56,900
don't<font color="#E5E5E5"> expect to query</font><font color="#CCCCCC"> for new md5 so</font>

981
00:39:54,320 --> 00:39:59,090
much we often have a few handful of

982
00:39:56,900 --> 00:40:01,190
files out there which we want<font color="#E5E5E5"> to monitor</font>

983
00:39:59,090 --> 00:40:03,260
that won't be hundreds<font color="#CCCCCC"> we'll be in the</font>

984
00:40:01,190 --> 00:40:05,570
<font color="#E5E5E5">tenner so that's that's</font><font color="#CCCCCC"> ok</font><font color="#E5E5E5"> within the</font>

985
00:40:03,260 --> 00:40:07,070
normal rate limit so far<font color="#CCCCCC"> as total then</font>

986
00:40:05,570 --> 00:40:09,560
we<font color="#E5E5E5"> have IBM x-force</font>

987
00:40:07,070 --> 00:40:11,930
it's<font color="#E5E5E5"> red limited as well</font><font color="#CCCCCC"> you can</font>

988
00:40:09,560 --> 00:40:14,480
actually send<font color="#E5E5E5"> an md5 to IBM and it will</font>

989
00:40:11,930 --> 00:40:17,779
give you the report<font color="#E5E5E5"> for</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> md5 and</font>

990
00:40:14,480 --> 00:40:18,470
it's regular mated to<font color="#E5E5E5"> 500 a day</font><font color="#CCCCCC"> I</font>

991
00:40:17,780 --> 00:40:20,089
<font color="#CCCCCC">believe so</font>

992
00:40:18,470 --> 00:40:22,848
sounds<font color="#E5E5E5"> quite strict</font>

993
00:40:20,089 --> 00:40:24,949
but if they don't<font color="#E5E5E5"> have the report for</font>

994
00:40:22,849 --> 00:40:27,769
the<font color="#E5E5E5"> 95</font><font color="#CCCCCC"> you'll</font><font color="#E5E5E5"> get a 404 and that's for</font>

995
00:40:24,949 --> 00:40:29,689
free so you<font color="#CCCCCC"> can basically can query</font><font color="#E5E5E5"> the</font>

996
00:40:27,769 --> 00:40:32,149
hell out of them<font color="#E5E5E5"> and only the hits will</font>

997
00:40:29,689 --> 00:40:34,219
cost us do not tell them do not

998
00:40:32,150 --> 00:40:36,019
and then there's gray noise<font color="#E5E5E5"> already</font>

999
00:40:34,219 --> 00:40:37,640
mentioned which has quite<font color="#E5E5E5"> a high rate</font>

1000
00:40:36,019 --> 00:40:39,618
limit and we<font color="#CCCCCC"> carried em along as well</font>

1001
00:40:37,640 --> 00:40:42,348
but<font color="#CCCCCC"> basically for</font><font color="#E5E5E5"> every IP that we see</font>

1002
00:40:39,619 --> 00:40:45,709
in our external<font color="#E5E5E5"> form times we were query</font>

1003
00:40:42,349 --> 00:40:47,479
<font color="#CCCCCC">to gray noise and that's how we can</font>

1004
00:40:45,709 --> 00:40:50,989
pretty much see what the blue<font color="#CCCCCC"> team is</font>

1005
00:40:47,479 --> 00:40:56,439
doing<font color="#E5E5E5"> but yet then we know what do we do</font>

1006
00:40:50,989 --> 00:41:00,709
when<font color="#CCCCCC"> we see a blue team first we dig in</font>

1007
00:40:56,439 --> 00:41:02,598
we make sure you've<font color="#CCCCCC"> got a few extra</font><font color="#E5E5E5"> exit</font>

1008
00:41:00,709 --> 00:41:04,640
points we dig a few extra holes to<font color="#E5E5E5"> get</font>

1009
00:41:02,599 --> 00:41:12,650
in and out of the<font color="#CCCCCC"> system's presence ah</font>

1010
00:41:04,640 --> 00:41:14,839
<font color="#E5E5E5">but it actually has blue eyes so</font>

1011
00:41:12,650 --> 00:41:16,999
basically we try to anchor ourselves<font color="#CCCCCC"> a</font>

1012
00:41:14,839 --> 00:41:18,859
bit more building our<font color="#E5E5E5"> own data points</font>

1013
00:41:16,999 --> 00:41:22,098
it's<font color="#CCCCCC"> not necessarily a part</font><font color="#E5E5E5"> of the</font>

1014
00:41:18,859 --> 00:41:24,319
<font color="#E5E5E5">training we're doing and we tend not to</font>

1015
00:41:22,099 --> 00:41:26,179
start<font color="#E5E5E5"> hiding the channel they found was</font>

1016
00:41:24,319 --> 00:41:27,529
they<font color="#E5E5E5"> found it and it's</font><font color="#CCCCCC"> okay it's</font>

1017
00:41:26,179 --> 00:41:28,670
something<font color="#CCCCCC"> they can</font><font color="#E5E5E5"> work with so let them</font>

1018
00:41:27,529 --> 00:41:31,489
play around with that<font color="#CCCCCC"> and we'll monitor</font>

1019
00:41:28,670 --> 00:41:33,079
<font color="#E5E5E5">closely what what they do and we'll keep</font>

1020
00:41:31,489 --> 00:41:34,849
working<font color="#E5E5E5"> over that line as well because</font>

1021
00:41:33,079 --> 00:41:36,679
that<font color="#E5E5E5"> that's that's all part of the job</font>

1022
00:41:34,849 --> 00:41:38,209
but but also<font color="#E5E5E5"> we'll make sure that we</font>

1023
00:41:36,679 --> 00:41:45,410
<font color="#E5E5E5">won't get kicked out permanently at</font>

1024
00:41:38,209 --> 00:41:46,969
least so mistakes<font color="#CCCCCC"> that are often made by</font>

1025
00:41:45,410 --> 00:41:48,189
the blue team I think<font color="#CCCCCC"> I already gave one</font>

1026
00:41:46,969 --> 00:41:52,549
away

1027
00:41:48,189 --> 00:41:54,368
<font color="#CCCCCC">loading samples to public services it</font>

1028
00:41:52,549 --> 00:41:56,779
happens it still happens now and<font color="#E5E5E5"> then</font>

1029
00:41:54,369 --> 00:41:58,819
sometimes it's the blue team<font color="#E5E5E5"> as in the</font>

1030
00:41:56,779 --> 00:42:01,099
<font color="#CCCCCC">shock or someone working in the stock or</font>

1031
00:41:58,819 --> 00:42:04,119
<font color="#CCCCCC">at red hunter but</font><font color="#E5E5E5"> also quite often it's</font>

1032
00:42:01,099 --> 00:42:06,019
it's<font color="#E5E5E5"> just the victim the victim</font><font color="#CCCCCC"> gotten a</font>

1033
00:42:04,119 --> 00:42:07,459
<font color="#E5E5E5">document and it's crashes or did</font>

1034
00:42:06,019 --> 00:42:09,499
<font color="#CCCCCC">something wrong</font><font color="#E5E5E5"> or disappeared for</font>

1035
00:42:07,459 --> 00:42:11,629
example and we said<font color="#E5E5E5"> to</font><font color="#CCCCCC"> GUI -</font><font color="#E5E5E5"> invisible</font>

1036
00:42:09,499 --> 00:42:13,729
what is gone<font color="#CCCCCC"> try it again try it again</font>

1037
00:42:11,630 --> 00:42:15,170
try<font color="#E5E5E5"> it again and after five times they</font>

1038
00:42:13,729 --> 00:42:17,598
<font color="#CCCCCC">think are let's upload it to</font><font color="#E5E5E5"> virustotal</font>

1039
00:42:15,170 --> 00:42:19,459
<font color="#E5E5E5">if we see that hit quite fast we know</font>

1040
00:42:17,599 --> 00:42:21,109
that<font color="#CCCCCC"> it's quite often it's it's the</font>

1041
00:42:19,459 --> 00:42:23,479
victim and not<font color="#CCCCCC"> the blue</font><font color="#E5E5E5"> team</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> if we</font>

1042
00:42:21,109 --> 00:42:25,670
get the<font color="#E5E5E5"> similar behavior a few days</font>

1043
00:42:23,479 --> 00:42:28,218
later then small likely to be a blue

1044
00:42:25,670 --> 00:42:30,309
team uploading samples that's<font color="#E5E5E5"> one</font>

1045
00:42:28,219 --> 00:42:33,160
mistake<font color="#E5E5E5"> for the blue guys in the room</font>

1046
00:42:30,309 --> 00:42:38,319
do not do that<font color="#E5E5E5"> recently we saw another</font>

1047
00:42:33,160 --> 00:42:40,598
<font color="#E5E5E5">one we saw semantic scanners by</font>

1048
00:42:38,319 --> 00:42:41,229
<font color="#CCCCCC">themselves and we don't think</font><font color="#E5E5E5"> that was a</font>

1049
00:42:40,599 --> 00:42:44,319
<font color="#E5E5E5">mistake</font>

1050
00:42:41,229 --> 00:42:45,729
<font color="#E5E5E5">we we guess it</font><font color="#CCCCCC"> it wasn't</font><font color="#E5E5E5"> a mistake of</font>

1051
00:42:44,319 --> 00:42:47,439
<font color="#E5E5E5">the blue team but there was a mistake of</font>

1052
00:42:45,729 --> 00:42:49,419
<font color="#E5E5E5">semantics somehow not sure how they</font>

1053
00:42:47,439 --> 00:42:51,939
approach<font color="#CCCCCC"> their house cancer but they</font>

1054
00:42:49,420 --> 00:42:53,259
decided<font color="#CCCCCC"> to trigger</font><font color="#E5E5E5"> our URLs and we're</font>

1055
00:42:51,939 --> 00:42:56,439
still investigating what exactly that

1056
00:42:53,259 --> 00:42:58,689
<font color="#E5E5E5">was it also happens is that</font><font color="#CCCCCC"> people start</font>

1057
00:42:56,439 --> 00:43:02,319
<font color="#CCCCCC">playing around with the payloads</font><font color="#E5E5E5"> so now</font>

1058
00:42:58,689 --> 00:43:04,359
and then<font color="#E5E5E5"> we have beacon flying in just</font>

1059
00:43:02,319 --> 00:43:07,058
<font color="#CCCCCC">after 6:00</font><font color="#E5E5E5"> well that's usually simply</font>

1060
00:43:04,359 --> 00:43:09,308
opening<font color="#E5E5E5"> his laptop at home and doing</font>

1061
00:43:07,059 --> 00:43:11,979
<font color="#E5E5E5">some work there but also now</font><font color="#CCCCCC"> and then</font><font color="#E5E5E5"> we</font>

1062
00:43:09,309 --> 00:43:13,509
see beacon coming in off<font color="#E5E5E5"> a tour well</font>

1063
00:43:11,979 --> 00:43:15,519
that's not the average<font color="#E5E5E5"> home user so then</font>

1064
00:43:13,509 --> 00:43:18,359
we<font color="#E5E5E5"> usually also</font><font color="#CCCCCC"> have quite a strong</font>

1065
00:43:15,519 --> 00:43:21,549
<font color="#E5E5E5">indicator that</font><font color="#CCCCCC"> something is going</font><font color="#E5E5E5"> on</font>

1066
00:43:18,359 --> 00:43:23,890
<font color="#CCCCCC">menu of visits we often see once we're</font>

1067
00:43:21,549 --> 00:43:25,299
<font color="#E5E5E5">detectives and I found a year old our</font><font color="#CCCCCC"> c2</font>

1068
00:43:23,890 --> 00:43:27,129
<font color="#E5E5E5">URL that they're going to visit with</font><font color="#CCCCCC"> a</font>

1069
00:43:25,299 --> 00:43:29,410
Firefox browser so I said every user

1070
00:43:27,130 --> 00:43:31,809
agent or the<font color="#CCCCCC"> URL</font><font color="#E5E5E5"> isn't complete or isn't</font>

1071
00:43:29,410 --> 00:43:35,229
fully there that's also a clear giveaway

1072
00:43:31,809 --> 00:43:38,739
to us that<font color="#CCCCCC"> that something is going on we</font>

1073
00:43:35,229 --> 00:43:40,569
once<font color="#E5E5E5"> had a profile that used favicon</font>

1074
00:43:38,739 --> 00:43:42,880
that echo but that that gets<font color="#CCCCCC"> created a</font>

1075
00:43:40,569 --> 00:43:47,920
lot by a lot of<font color="#E5E5E5"> people this was a bit</font>

1076
00:43:42,880 --> 00:43:50,699
<font color="#CCCCCC">harder to</font><font color="#E5E5E5"> filter out but yeah once we</font>

1077
00:43:47,920 --> 00:43:54,130
<font color="#CCCCCC">know the blue is on to us what do we do</font>

1078
00:43:50,699 --> 00:43:55,569
<font color="#E5E5E5">well we throw them a bone let them play</font>

1079
00:43:54,130 --> 00:43:58,630
around a<font color="#CCCCCC"> bit let them chew on something</font>

1080
00:43:55,569 --> 00:44:01,420
<font color="#CCCCCC">let them work that's that's</font><font color="#E5E5E5"> what what I</font>

1081
00:43:58,630 --> 00:44:02,709
<font color="#E5E5E5">signed up for right train themselves</font><font color="#CCCCCC"> and</font>

1082
00:44:01,420 --> 00:44:05,289
we<font color="#CCCCCC"> helped them do</font><font color="#E5E5E5"> that in the best way</font>

1083
00:44:02,709 --> 00:44:06,939
<font color="#CCCCCC">possible to</font><font color="#E5E5E5"> get better by doing this</font>

1084
00:44:05,289 --> 00:44:09,989
over<font color="#E5E5E5"> and</font><font color="#CCCCCC"> over</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> over they might get</font>

1085
00:44:06,939 --> 00:44:16,269
<font color="#CCCCCC">better and better</font><font color="#E5E5E5"> and also more quiet</font>

1086
00:44:09,989 --> 00:44:18,429
now how do we throw to a blue team for

1087
00:44:16,269 --> 00:44:21,038
that<font color="#E5E5E5"> we go</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> red foul</font><font color="#CCCCCC"> it's separate</font>

1088
00:44:18,429 --> 00:44:23,079
products which<font color="#CCCCCC"> already was used by us</font>

1089
00:44:21,039 --> 00:44:24,759
for quite<font color="#E5E5E5"> a while before red</font><font color="#CCCCCC"> ELCA came</font>

1090
00:44:23,079 --> 00:44:27,039
along but they<font color="#E5E5E5"> combine really well</font>

1091
00:44:24,759 --> 00:44:28,539
<font color="#E5E5E5">because using red elk we can now see</font>

1092
00:44:27,039 --> 00:44:30,369
when the blue team there's some

1093
00:44:28,539 --> 00:44:33,400
detection<font color="#CCCCCC"> because can start acting on</font>

1094
00:44:30,369 --> 00:44:36,730
<font color="#E5E5E5">that so that's what we did what's red</font>

1095
00:44:33,400 --> 00:44:40,210
<font color="#CCCCCC">foul</font><font color="#E5E5E5"> is it's a it's a</font><font color="#CCCCCC"> small tool</font><font color="#E5E5E5"> small</font>

1096
00:44:36,730 --> 00:44:41,860
<font color="#E5E5E5">a small Python module that you can run</font>

1097
00:44:40,210 --> 00:44:45,310
on<font color="#E5E5E5"> a web server and it will basically</font>

1098
00:44:41,860 --> 00:44:46,630
serve files<font color="#E5E5E5"> you don't</font><font color="#CCCCCC"> need PI to for</font>

1099
00:44:45,310 --> 00:44:47,710
that<font color="#E5E5E5"> you can just put a file on the web</font>

1100
00:44:46,630 --> 00:44:50,320
server<font color="#E5E5E5"> yeah that's correct</font>

1101
00:44:47,710 --> 00:44:52,720
<font color="#E5E5E5">but I want to be able</font><font color="#CCCCCC"> to make this foul</font>

1102
00:44:50,320 --> 00:44:54,310
behave the way I<font color="#CCCCCC"> wanted</font><font color="#E5E5E5"> and we'll get to</font>

1103
00:44:52,720 --> 00:44:57,910
that<font color="#CCCCCC"> too a bit but basically</font><font color="#E5E5E5"> you can</font>

1104
00:44:54,310 --> 00:45:00,400
<font color="#E5E5E5">return any content or any content type</font>

1105
00:44:57,910 --> 00:45:02,049
based on parameters for example<font color="#CCCCCC"> if the</font>

1106
00:45:00,400 --> 00:45:04,150
<font color="#CCCCCC">user agent</font><font color="#E5E5E5"> is not what you expect you</font>

1107
00:45:02,050 --> 00:45:06,520
serve<font color="#E5E5E5"> something else or if a certain URL</font>

1108
00:45:04,150 --> 00:45:09,670
is queried for the fifth<font color="#CCCCCC"> time</font><font color="#E5E5E5"> you serve</font>

1109
00:45:06,520 --> 00:45:12,640
something else<font color="#CCCCCC"> or if a certain URL is</font>

1110
00:45:09,670 --> 00:45:15,000
create without the the office hours

1111
00:45:12,640 --> 00:45:19,710
<font color="#E5E5E5">these are something else</font>

1112
00:45:15,000 --> 00:45:19,710
stuff isn't<font color="#E5E5E5"> always what it seems</font>

1113
00:45:34,819 --> 00:45:54,049
again<font color="#CCCCCC"> before yeah let me</font><font color="#E5E5E5"> see</font><font color="#CCCCCC"> this one</font>

1114
00:45:50,919 --> 00:45:55,759
the last<font color="#E5E5E5"> one</font><font color="#CCCCCC"> ah</font><font color="#E5E5E5"> well this is one of our</font>

1115
00:45:54,049 --> 00:45:56,779
<font color="#CCCCCC">reader axis flex</font><font color="#E5E5E5"> so that's strangled on</font>

1116
00:45:55,759 --> 00:45:58,339
that if<font color="#E5E5E5"> you're going to</font><font color="#CCCCCC"> look for that</font>

1117
00:45:56,779 --> 00:45:59,439
<font color="#CCCCCC">and identifies you've got a lot of</font><font color="#E5E5E5"> it</font>

1118
00:45:58,339 --> 00:46:03,109
because<font color="#CCCCCC"> this is the one we've been</font>

1119
00:45:59,439 --> 00:46:04,699
trying catch me with a lot of antivirus

1120
00:46:03,109 --> 00:46:06,589
parties by sending in<font color="#E5E5E5"> more</font><font color="#CCCCCC"> where to</font>

1121
00:46:04,699 --> 00:46:09,979
<font color="#E5E5E5">virustotal and</font><font color="#CCCCCC"> wherever</font><font color="#E5E5E5"> we could upload</font>

1122
00:46:06,589 --> 00:46:17,660
them whatever<font color="#E5E5E5"> URL URL is almost the same</font>

1123
00:46:09,979 --> 00:46:19,189
but<font color="#CCCCCC"> it has one unique key in it if</font><font color="#E5E5E5"> we</font>

1124
00:46:17,660 --> 00:46:21,169
look<font color="#E5E5E5"> at that far what we what we've seen</font>

1125
00:46:19,189 --> 00:46:22,910
at the customer and we see it<font color="#E5E5E5"> we've seen</font>

1126
00:46:21,169 --> 00:46:24,919
<font color="#E5E5E5">multiple times actually that we send</font>

1127
00:46:22,910 --> 00:46:27,140
some more<font color="#CCCCCC"> out and</font><font color="#E5E5E5"> the first hit we get</font>

1128
00:46:24,919 --> 00:46:31,098
is some blue<font color="#CCCCCC"> code testing whether or</font><font color="#E5E5E5"> not</font>

1129
00:46:27,140 --> 00:46:34,009
<font color="#E5E5E5">it's a reliable</font><font color="#CCCCCC"> site so what</font><font color="#E5E5E5"> we serve</font>

1130
00:46:31,099 --> 00:46:36,199
the blue card or to the proxy we serve

1131
00:46:34,009 --> 00:46:38,390
whatever<font color="#E5E5E5"> they expect in this case we</font>

1132
00:46:36,199 --> 00:46:39,799
serve a robot on Dixie<font color="#E5E5E5"> or the euro is</font>

1133
00:46:38,390 --> 00:46:42,078
falling off<font color="#E5E5E5"> but in the end there's a</font>

1134
00:46:39,799 --> 00:46:44,209
robotic<font color="#CCCCCC"> txt it might not might be in a</font>

1135
00:46:42,079 --> 00:46:47,779
<font color="#E5E5E5">bit of an old place</font><font color="#CCCCCC"> but other than that</font>

1136
00:46:44,209 --> 00:46:50,868
seems<font color="#CCCCCC"> fellas</font><font color="#E5E5E5"> so no harm done there and</font>

1137
00:46:47,779 --> 00:46:52,249
then the next<font color="#CCCCCC"> step is that the victim</font>

1138
00:46:50,869 --> 00:46:56,479
connects to us what we don't want<font color="#E5E5E5"> to</font>

1139
00:46:52,249 --> 00:46:58,279
<font color="#E5E5E5">serve the victim</font><font color="#CCCCCC"> robots.txt</font><font color="#E5E5E5"> of course so</font>

1140
00:46:56,479 --> 00:47:00,678
we<font color="#CCCCCC"> serve the payload we want them to</font><font color="#E5E5E5"> run</font>

1141
00:46:58,279 --> 00:47:03,079
next<font color="#E5E5E5"> step I'm going to refresh it again</font>

1142
00:47:00,679 --> 00:47:05,449
because maybe a few days later just<font color="#CCCCCC"> as</font>

1143
00:47:03,079 --> 00:47:07,069
<font color="#E5E5E5">usual complaining</font><font color="#CCCCCC"> weird things happening</font>

1144
00:47:05,449 --> 00:47:10,640
<font color="#CCCCCC">on my machine or my window sometimes</font>

1145
00:47:07,069 --> 00:47:12,619
disappears at least we were trying<font color="#E5E5E5"> to</font>

1146
00:47:10,640 --> 00:47:14,509
get blue to trigger it<font color="#CCCCCC"> and</font><font color="#E5E5E5"> the blue team</font>

1147
00:47:12,619 --> 00:47:16,549
<font color="#E5E5E5">is going to look at this URL because</font>

1148
00:47:14,509 --> 00:47:20,749
they've seen<font color="#E5E5E5"> it a lot</font><font color="#CCCCCC"> in logs and what</font>

1149
00:47:16,549 --> 00:47:22,279
does<font color="#E5E5E5"> it do</font><font color="#CCCCCC"> now someone looks at</font><font color="#E5E5E5"> this</font>

1150
00:47:20,749 --> 00:47:25,279
<font color="#CCCCCC">essay but it looks</font><font color="#E5E5E5"> like a Bitcoin</font>

1151
00:47:22,279 --> 00:47:27,049
stealer<font color="#CCCCCC"> I did</font><font color="#E5E5E5"> that's bad because Bitcoin</font>

1152
00:47:25,279 --> 00:47:29,449
stealing is bad but that's really not

1153
00:47:27,049 --> 00:47:31,459
into bitcoins it's no harm for us so we

1154
00:47:29,449 --> 00:47:33,589
can<font color="#E5E5E5"> continue our normal operation but so</font>

1155
00:47:31,459 --> 00:47:35,629
it's interesting though a bit concealer

1156
00:47:33,589 --> 00:47:36,949
in<font color="#E5E5E5"> one of our</font><font color="#CCCCCC"> laptops let's have a</font>

1157
00:47:35,630 --> 00:47:39,289
<font color="#E5E5E5">colleague look at this as well so they</font>

1158
00:47:36,949 --> 00:47:40,459
<font color="#CCCCCC">also visit the URL and look at the</font>

1159
00:47:39,289 --> 00:47:42,180
<font color="#CCCCCC">bitcoin</font><font color="#E5E5E5"> stealers from war and</font><font color="#CCCCCC"> they</font>

1160
00:47:40,459 --> 00:47:44,710
decide<font color="#CCCCCC"> well Rob</font>

1161
00:47:42,180 --> 00:47:46,270
again it's it's not it's not evil for us

1162
00:47:44,710 --> 00:47:47,740
as we<font color="#E5E5E5"> don't do Bitcoin but it might be</font>

1163
00:47:46,270 --> 00:47:49,270
time to<font color="#E5E5E5"> call it management because at</font>

1164
00:47:47,740 --> 00:47:51,160
least<font color="#E5E5E5"> we have some sort of an infection</font>

1165
00:47:49,270 --> 00:47:53,349
<font color="#CCCCCC">going on and they go to management have</font>

1166
00:47:51,160 --> 00:47:57,089
a<font color="#CCCCCC"> Beemer on</font><font color="#E5E5E5"> and they</font><font color="#CCCCCC"> shower the problem</font>

1167
00:47:53,349 --> 00:47:59,349
there and this<font color="#E5E5E5"> is what I get</font>

1168
00:47:57,089 --> 00:48:01,029
of course in a real<font color="#CCCCCC"> operation we</font>

1169
00:47:59,349 --> 00:48:02,500
wouldn't<font color="#E5E5E5"> move on with this picture but</font>

1170
00:48:01,030 --> 00:48:04,630
what this is<font color="#CCCCCC"> doing there was this one</font>

1171
00:48:02,500 --> 00:48:06,910
unique<font color="#CCCCCC"> e in the URL</font><font color="#E5E5E5"> and it's just</font>

1172
00:48:04,630 --> 00:48:09,369
keeping<font color="#CCCCCC"> a log file of how often</font><font color="#E5E5E5"> it's</font>

1173
00:48:06,910 --> 00:48:11,170
called<font color="#E5E5E5"> and based upon the number the</font>

1174
00:48:09,369 --> 00:48:13,380
<font color="#E5E5E5">first time you get</font><font color="#CCCCCC"> all boards second</font>

1175
00:48:11,170 --> 00:48:16,859
time you get payloads<font color="#E5E5E5"> and so on</font>

1176
00:48:13,380 --> 00:48:19,359
basically<font color="#CCCCCC"> the</font><font color="#E5E5E5"> code for this for this for</font>

1177
00:48:16,859 --> 00:48:21,520
this part this<font color="#E5E5E5"> is another dummy</font><font color="#CCCCCC"> it place</font>

1178
00:48:19,359 --> 00:48:23,410
<font color="#E5E5E5">with user agents but this is all the</font>

1179
00:48:21,520 --> 00:48:25,900
code 24 lines you<font color="#E5E5E5"> need to build</font>

1180
00:48:23,410 --> 00:48:27,790
something<font color="#CCCCCC"> like this so if you take the</font>

1181
00:48:25,900 --> 00:48:29,380
<font color="#CCCCCC">two we've developed and you start</font>

1182
00:48:27,790 --> 00:48:31,058
<font color="#E5E5E5">playing around but only a few lines of</font>

1183
00:48:29,380 --> 00:48:33,940
parts<font color="#CCCCCC"> and you can</font><font color="#E5E5E5"> get this kind of</font>

1184
00:48:31,059 --> 00:48:35,799
behavior<font color="#CCCCCC"> you can</font><font color="#E5E5E5"> multiply it as much as</font>

1185
00:48:33,940 --> 00:48:37,650
<font color="#E5E5E5">you want you</font><font color="#CCCCCC"> micro write a</font><font color="#E5E5E5"> small plug in</font>

1186
00:48:35,799 --> 00:48:41,259
and there<font color="#E5E5E5"> you go</font>

1187
00:48:37,650 --> 00:48:42,970
<font color="#CCCCCC">how does this improve red teaming</font><font color="#E5E5E5"> as we</font>

1188
00:48:41,260 --> 00:48:45,250
said<font color="#E5E5E5"> before we want to see red teaming</font>

1189
00:48:42,970 --> 00:48:47,020
as a boxing<font color="#E5E5E5"> game we want to to play with</font>

1190
00:48:45,250 --> 00:48:49,180
the<font color="#CCCCCC"> opponents</font><font color="#E5E5E5"> let them hit us and we all</font>

1191
00:48:47,020 --> 00:48:50,799
head back<font color="#E5E5E5"> and that's that's the way if</font>

1192
00:48:49,180 --> 00:48:52,839
you'd never get to<font color="#E5E5E5"> train how can you</font>

1193
00:48:50,799 --> 00:48:54,670
<font color="#E5E5E5">ever in a real fight we want to have the</font>

1194
00:48:52,839 --> 00:48:57,490
blue team<font color="#CCCCCC"> onto the skill level that if</font>

1195
00:48:54,670 --> 00:48:59,260
trained enough to<font color="#E5E5E5"> win a real fight and</font>

1196
00:48:57,490 --> 00:49:01,598
in this<font color="#E5E5E5"> case it can be</font><font color="#CCCCCC"> a good</font><font color="#E5E5E5"> decoy if</font>

1197
00:48:59,260 --> 00:49:03,339
we<font color="#E5E5E5"> think the blue is</font><font color="#CCCCCC"> going to get too</font>

1198
00:49:01,599 --> 00:49:04,510
<font color="#CCCCCC">aggressive for</font><font color="#E5E5E5"> us we try to ease them</font>

1199
00:49:03,339 --> 00:49:06,279
down a bit<font color="#CCCCCC"> in the hope that</font><font color="#E5E5E5"> they'll</font>

1200
00:49:04,510 --> 00:49:08,440
<font color="#E5E5E5">think</font><font color="#CCCCCC"> ours just been caught Bitcoin code</font>

1201
00:49:06,280 --> 00:49:09,910
<font color="#E5E5E5">a bit concealer we don't have to follow</font>

1202
00:49:08,440 --> 00:49:12,069
<font color="#E5E5E5">a real incident for this we don't have</font>

1203
00:49:09,910 --> 00:49:14,950
<font color="#E5E5E5">to call an</font><font color="#CCCCCC"> external party to investigate</font>

1204
00:49:12,069 --> 00:49:19,390
<font color="#CCCCCC">this</font><font color="#E5E5E5"> and they might</font><font color="#CCCCCC"> just move on</font><font color="#E5E5E5"> doesn't</font>

1205
00:49:14,950 --> 00:49:21,430
<font color="#E5E5E5">work always might work sometimes well</font>

1206
00:49:19,390 --> 00:49:23,109
then the most important things for today

1207
00:49:21,430 --> 00:49:25,210
what should real them if<font color="#E5E5E5"> the party</font>

1208
00:49:23,109 --> 00:49:27,578
yesterday<font color="#E5E5E5"> was really to have you or if</font>

1209
00:49:25,210 --> 00:49:28,990
<font color="#CCCCCC">you really just do not get anything of</font>

1210
00:49:27,579 --> 00:49:32,890
what we're saying<font color="#E5E5E5"> just try to remember</font>

1211
00:49:28,990 --> 00:49:36,399
those three things<font color="#CCCCCC"> very simple boxing</font>

1212
00:49:32,890 --> 00:49:38,589
instead of the wrecking ball<font color="#CCCCCC"> red</font><font color="#E5E5E5"> elk</font>

1213
00:49:36,400 --> 00:49:40,000
<font color="#E5E5E5">we're releasing it right now and blue</font>

1214
00:49:38,589 --> 00:49:43,690
team<font color="#CCCCCC"> there blue team</font>

1215
00:49:40,000 --> 00:49:45,180
OPSEC<font color="#E5E5E5"> we can see things of what you're</font>

1216
00:49:43,690 --> 00:49:50,460
<font color="#E5E5E5">doing so</font>

1217
00:49:45,180 --> 00:49:50,819
yeah<font color="#E5E5E5"> I think it's time for if</font><font color="#CCCCCC"> they're</font>

1218
00:49:50,460 --> 00:49:53,279
<font color="#E5E5E5">already</font>

1219
00:49:50,819 --> 00:49:56,038
and while<font color="#E5E5E5"> the maybe people are asking</font>

1220
00:49:53,279 --> 00:49:58,109
questions<font color="#CCCCCC"> I will clearly get</font><font color="#E5E5E5"> head and</font>

1221
00:49:56,039 --> 00:50:00,539
get it<font color="#E5E5E5"> up and running</font><font color="#CCCCCC"> they will be an</font>

1222
00:49:58,109 --> 00:50:02,369
good<font color="#E5E5E5"> tip in no time</font><font color="#CCCCCC"> he said fall is on</font>

1223
00:50:00,539 --> 00:50:06,230
<font color="#E5E5E5">my laptop</font><font color="#CCCCCC"> so I'll grab</font><font color="#E5E5E5"> it in a minute</font>

1224
00:50:02,369 --> 00:50:06,230
and<font color="#CCCCCC"> Morel</font><font color="#E5E5E5"> case going on there</font><font color="#CCCCCC"> right now</font>

