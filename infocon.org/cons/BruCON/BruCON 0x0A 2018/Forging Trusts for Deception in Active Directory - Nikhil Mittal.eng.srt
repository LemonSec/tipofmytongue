1
00:00:02,590 --> 00:00:11,530
thank you<font color="#CCCCCC"> so we're going to talk about</font><font color="#E5E5E5"> I</font>

2
00:00:06,819 --> 00:00:14,320
was planning<font color="#CCCCCC"> to show some live demos so</font>

3
00:00:11,530 --> 00:00:18,250
<font color="#E5E5E5">I have to get some archive piece of</font>

4
00:00:14,320 --> 00:00:19,450
technology for<font color="#CCCCCC"> that thank you</font><font color="#E5E5E5"> for coming</font>

5
00:00:18,250 --> 00:00:21,190
to the talk<font color="#E5E5E5"> we're going to talk</font><font color="#CCCCCC"> about</font>

6
00:00:19,450 --> 00:00:24,939
forging<font color="#E5E5E5"> process in Active Directory</font>

7
00:00:21,190 --> 00:00:28,960
environment<font color="#E5E5E5"> for detection this is the</font>

8
00:00:24,940 --> 00:00:31,420
most blue talk ever<font color="#E5E5E5"> I have given so</font><font color="#CCCCCC"> I'm</font>

9
00:00:28,960 --> 00:00:35,640
<font color="#E5E5E5">basically a</font><font color="#CCCCCC"> red teamer</font><font color="#E5E5E5"> and this is my</font>

10
00:00:31,420 --> 00:00:38,620
attempt to<font color="#CCCCCC"> receive my own</font><font color="#E5E5E5"> community</font><font color="#CCCCCC"> so</font>

11
00:00:35,640 --> 00:00:42,159
<font color="#CCCCCC">let's get started</font><font color="#E5E5E5"> a couple of things</font>

12
00:00:38,620 --> 00:00:44,828
about me before<font color="#CCCCCC"> we begin</font><font color="#E5E5E5"> I am</font><font color="#CCCCCC"> a hacker</font>

13
00:00:42,159 --> 00:00:46,179
<font color="#CCCCCC">of course speak at a lot of conferences</font>

14
00:00:44,829 --> 00:00:48,579
<font color="#CCCCCC">trained there</font>

15
00:00:46,179 --> 00:00:50,440
I'm<font color="#CCCCCC"> currently associated</font><font color="#E5E5E5"> with pentester</font>

16
00:00:48,579 --> 00:00:53,170
academy the guys<font color="#E5E5E5"> and we are the guys</font>

17
00:00:50,440 --> 00:00:56,649
<font color="#CCCCCC">behind attack defense</font><font color="#E5E5E5"> comm pentester</font>

18
00:00:53,170 --> 00:01:00,489
academy security<font color="#CCCCCC"> to</font><font color="#E5E5E5"> you you can find me</font>

19
00:00:56,649 --> 00:01:02,920
on<font color="#CCCCCC"> twitter on with as Nikhil underscore</font>

20
00:01:00,489 --> 00:01:05,500
mi TT<font color="#E5E5E5"> a blog at lab for penetration</font>

21
00:01:02,920 --> 00:01:09,820
tester<font color="#CCCCCC"> comm</font><font color="#E5E5E5"> I'm</font><font color="#CCCCCC"> in den -</font><font color="#E5E5E5"> open source</font>

22
00:01:05,500 --> 00:01:13,000
<font color="#E5E5E5">tool kits for red teamers I'm generally</font>

23
00:01:09,820 --> 00:01:14,860
interested in breaking<font color="#E5E5E5"> into machines</font>

24
00:01:13,000 --> 00:01:16,930
<font color="#E5E5E5">environments where of</font><font color="#CCCCCC"> course I have the</font>

25
00:01:14,860 --> 00:01:19,119
<font color="#E5E5E5">permission to do so new methodologies</font><font color="#CCCCCC"> to</font>

26
00:01:16,930 --> 00:01:22,420
attack systems<font color="#E5E5E5"> I've been recently</font>

27
00:01:19,119 --> 00:01:26,380
<font color="#E5E5E5">working a lot on how to avoid detection</font>

28
00:01:22,420 --> 00:01:29,380
<font color="#CCCCCC">Zin</font><font color="#E5E5E5"> active directory attacks especially</font>

29
00:01:26,380 --> 00:01:32,949
with the with so<font color="#E5E5E5"> many vendors claiming</font>

30
00:01:29,380 --> 00:01:34,149
to be the ones<font color="#CCCCCC"> who can stop</font><font color="#E5E5E5"> domain</font>

31
00:01:32,950 --> 00:01:36,250
dominance attacks

32
00:01:34,149 --> 00:01:38,350
yes<font color="#E5E5E5"> poke last year</font><font color="#CCCCCC"> at broke on about</font>

33
00:01:36,250 --> 00:01:41,259
advanced threat analytics<font color="#CCCCCC"> my</font><font color="#E5E5E5"> that's no</font>

34
00:01:38,350 --> 00:01:43,798
<font color="#E5E5E5">microsoft tool which detects</font><font color="#CCCCCC"> Active</font>

35
00:01:41,259 --> 00:01:48,909
<font color="#E5E5E5">Directory attacks and that slowly</font>

36
00:01:43,799 --> 00:01:52,810
brought me to another<font color="#E5E5E5"> area of detection</font>

37
00:01:48,909 --> 00:01:56,350
<font color="#E5E5E5">stats deception</font><font color="#CCCCCC"> I evaluated like six or</font>

38
00:01:52,810 --> 00:01:59,499
<font color="#CCCCCC">seven</font><font color="#E5E5E5"> industry grade or</font><font color="#CCCCCC"> enterprise grade</font>

39
00:01:56,350 --> 00:02:02,499
offerings<font color="#E5E5E5"> in last</font><font color="#CCCCCC"> couple of months not</font>

40
00:01:59,499 --> 00:02:05,469
<font color="#CCCCCC">couple of months last</font><font color="#E5E5E5"> six months found</font>

41
00:02:02,499 --> 00:02:10,240
out<font color="#E5E5E5"> that there is a severe lack of open</font>

42
00:02:05,469 --> 00:02:14,079
source<font color="#E5E5E5"> projects which</font><font color="#CCCCCC"> can provide you</font>

43
00:02:10,240 --> 00:02:15,890
deception<font color="#E5E5E5"> capabilities right that is</font>

44
00:02:14,080 --> 00:02:17,720
what this talk is about

45
00:02:15,890 --> 00:02:19,940
<font color="#E5E5E5">I've previously spoken at</font><font color="#CCCCCC"> DEFCON</font>

46
00:02:17,720 --> 00:02:25,580
<font color="#E5E5E5">blackhead etc of course that</font><font color="#CCCCCC"> broke on as</font>

47
00:02:19,940 --> 00:02:29,030
I said so<font color="#CCCCCC"> a goat from niccolò</font>

48
00:02:25,580 --> 00:02:33,560
<font color="#E5E5E5">machiavelli that never attempt to win by</font>

49
00:02:29,030 --> 00:02:37,400
<font color="#E5E5E5">force</font><font color="#CCCCCC"> what</font><font color="#E5E5E5"> can</font><font color="#CCCCCC"> be won by deception</font><font color="#E5E5E5"> and</font>

50
00:02:33,560 --> 00:02:41,060
he<font color="#CCCCCC"> also says that</font><font color="#E5E5E5"> I am the brightest</font>

51
00:02:37,400 --> 00:02:43,340
scholar he has ever read<font color="#E5E5E5"> both are miss</font>

52
00:02:41,060 --> 00:02:44,990
<font color="#E5E5E5">Coates</font><font color="#CCCCCC"> so I was</font><font color="#E5E5E5"> looking for</font><font color="#CCCCCC"> codes about</font>

53
00:02:43,340 --> 00:02:47,270
<font color="#E5E5E5">deception which I can put on the</font>

54
00:02:44,990 --> 00:02:49,820
<font color="#E5E5E5">introduction slide and this is a miss</font>

55
00:02:47,270 --> 00:02:52,460
code attributed to McKinley<font color="#E5E5E5"> which I</font>

56
00:02:49,820 --> 00:02:57,560
thought<font color="#CCCCCC"> goes</font><font color="#E5E5E5"> really good with</font><font color="#CCCCCC"> the</font>

57
00:02:52,460 --> 00:02:59,270
persona he has so what is<font color="#E5E5E5"> deception for</font>

58
00:02:57,560 --> 00:03:03,260
<font color="#E5E5E5">red teamers deception is something which</font>

59
00:02:59,270 --> 00:03:06,310
we have<font color="#E5E5E5"> been</font><font color="#CCCCCC"> using for long</font><font color="#E5E5E5"> right now we</font>

60
00:03:03,260 --> 00:03:09,590
<font color="#CCCCCC">have been deceiving</font><font color="#E5E5E5"> or using decoys</font>

61
00:03:06,310 --> 00:03:11,900
<font color="#E5E5E5">against unsuspecting users in form of</font>

62
00:03:09,590 --> 00:03:15,650
malicious attachments we trick users<font color="#E5E5E5"> to</font>

63
00:03:11,900 --> 00:03:18,170
<font color="#E5E5E5">click on links open</font><font color="#CCCCCC"> attachments</font><font color="#E5E5E5"> once we</font>

64
00:03:15,650 --> 00:03:21,650
are inside<font color="#E5E5E5"> an environment or on network</font>

65
00:03:18,170 --> 00:03:25,700
we use privileges of other users<font color="#CCCCCC"> to</font>

66
00:03:21,650 --> 00:03:30,050
avoid getting<font color="#CCCCCC"> detected we use jump boxes</font>

67
00:03:25,700 --> 00:03:32,690
<font color="#E5E5E5">reverting</font><font color="#CCCCCC"> so that we can deceive any</font>

68
00:03:30,050 --> 00:03:35,630
<font color="#E5E5E5">detection mechanism in that environment</font>

69
00:03:32,690 --> 00:03:39,260
or in that<font color="#CCCCCC"> network</font><font color="#E5E5E5"> so as to remain</font>

70
00:03:35,630 --> 00:03:41,450
hidden right<font color="#CCCCCC"> that's how 30 must have</font>

71
00:03:39,260 --> 00:03:42,709
been<font color="#CCCCCC"> using deception a lot for example</font>

72
00:03:41,450 --> 00:03:44,810
human interface devices

73
00:03:42,709 --> 00:03:47,090
I have<font color="#E5E5E5"> personally</font><font color="#CCCCCC"> involved</font><font color="#E5E5E5"> worked quite</font>

74
00:03:44,810 --> 00:03:49,910
a lot on<font color="#E5E5E5"> human interface devices</font><font color="#CCCCCC"> you</font>

75
00:03:47,090 --> 00:03:54,019
<font color="#CCCCCC">hide such device inside</font><font color="#E5E5E5"> a mouse or</font>

76
00:03:49,910 --> 00:03:56,510
keyboard a USB<font color="#CCCCCC"> Troy drop them in parking</font>

77
00:03:54,019 --> 00:04:00,200
lots<font color="#CCCCCC"> send</font><font color="#E5E5E5"> them as gave to unsuspecting</font>

78
00:03:56,510 --> 00:04:02,690
<font color="#CCCCCC">users</font><font color="#E5E5E5"> do whatsoever and you would be</font>

79
00:04:00,200 --> 00:04:04,670
surprised by how<font color="#CCCCCC"> many users</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> how</font>

80
00:04:02,690 --> 00:04:08,239
connect that machine to their work

81
00:04:04,670 --> 00:04:12,890
<font color="#E5E5E5">connect that try or decoy to their work</font>

82
00:04:08,239 --> 00:04:14,720
machines<font color="#E5E5E5"> right that is how our red</font>

83
00:04:12,890 --> 00:04:16,820
teamers or<font color="#E5E5E5"> attackers have been</font><font color="#CCCCCC"> using</font>

84
00:04:14,720 --> 00:04:19,250
deception<font color="#CCCCCC"> a</font><font color="#E5E5E5"> lot blue teamers or</font>

85
00:04:16,820 --> 00:04:21,228
defenders have been<font color="#CCCCCC"> lacking lagging</font>

86
00:04:19,250 --> 00:04:25,789
behind when it<font color="#CCCCCC"> comes to using deception</font>

87
00:04:21,228 --> 00:04:27,520
<font color="#E5E5E5">the best open source solution which I</font>

88
00:04:25,789 --> 00:04:29,469
have seen or

89
00:04:27,520 --> 00:04:32,590
technique which I have seen when<font color="#CCCCCC"> it</font>

90
00:04:29,470 --> 00:04:34,780
comes to defense is to leave honey

91
00:04:32,590 --> 00:04:37,568
credentials honey users or honey tokens

92
00:04:34,780 --> 00:04:41,500
<font color="#CCCCCC">that is</font><font color="#E5E5E5"> relief credentials of a user in</font>

93
00:04:37,569 --> 00:04:44,139
memory on a box or on boxes<font color="#CCCCCC"> and hope</font>

94
00:04:41,500 --> 00:04:46,030
that if an attacker uses that you get an

95
00:04:44,139 --> 00:04:49,270
<font color="#E5E5E5">alert which means that it is</font><font color="#CCCCCC"> an</font>

96
00:04:46,030 --> 00:04:51,549
intrusion it's an animal<font color="#CCCCCC"> II right so</font>

97
00:04:49,270 --> 00:04:53,710
that's<font color="#E5E5E5"> how the current state of</font>

98
00:04:51,550 --> 00:04:56,970
deception as far as<font color="#E5E5E5"> well as far as I</font>

99
00:04:53,710 --> 00:05:01,409
know is for red teamers<font color="#E5E5E5"> and blue teamers</font>

100
00:04:56,970 --> 00:05:04,240
now how does<font color="#CCCCCC"> the attackers</font><font color="#E5E5E5"> for deception</font>

101
00:05:01,409 --> 00:05:06,880
<font color="#E5E5E5">there have been so many examples I</font><font color="#CCCCCC"> could</font>

102
00:05:04,240 --> 00:05:09,280
speak like whole day<font color="#E5E5E5"> of how deception</font>

103
00:05:06,880 --> 00:05:13,690
has been used for<font color="#CCCCCC"> so long from</font><font color="#E5E5E5"> Hannibal</font>

104
00:05:09,280 --> 00:05:16,599
<font color="#E5E5E5">to US Army</font><font color="#CCCCCC"> and for these Russians for</font>

105
00:05:13,690 --> 00:05:21,039
past few years have<font color="#CCCCCC"> been using this to</font>

106
00:05:16,599 --> 00:05:23,650
deceive their adversary's now deception

107
00:05:21,039 --> 00:05:25,960
is mostly<font color="#E5E5E5"> a psychology thing right you</font>

108
00:05:23,650 --> 00:05:27,388
have to play with<font color="#CCCCCC"> the mind of</font><font color="#E5E5E5"> your enemy</font>

109
00:05:25,960 --> 00:05:30,669
or your rival

110
00:05:27,389 --> 00:05:32,620
how does<font color="#CCCCCC"> Rhett immerse as an experienced</font>

111
00:05:30,669 --> 00:05:35,169
<font color="#CCCCCC">Redeemer I can tell you that when we</font>

112
00:05:32,620 --> 00:05:37,900
<font color="#E5E5E5">going into a network we</font><font color="#CCCCCC"> have something</font>

113
00:05:35,169 --> 00:05:40,930
which is called<font color="#E5E5E5"> the illusory superiority</font>

114
00:05:37,900 --> 00:05:44,169
<font color="#E5E5E5">that is we</font><font color="#CCCCCC"> think that</font><font color="#E5E5E5"> defenders are full</font>

115
00:05:40,930 --> 00:05:45,699
<font color="#CCCCCC">that's</font><font color="#E5E5E5"> not</font><font color="#CCCCCC"> me personally I respect blue</font>

116
00:05:44,169 --> 00:05:48,490
teamers a lot especially from<font color="#E5E5E5"> the time I</font>

117
00:05:45,699 --> 00:05:51,759
<font color="#E5E5E5">have been maintaining couple of labs but</font>

118
00:05:48,490 --> 00:05:55,360
that's how Redeemers go in<font color="#E5E5E5"> right with</font>

119
00:05:51,759 --> 00:05:58,090
<font color="#E5E5E5">the sense of superiority</font><font color="#CCCCCC"> the sexiness</font>

120
00:05:55,360 --> 00:06:00,430
<font color="#E5E5E5">attached with attack also adds up to it</font>

121
00:05:58,090 --> 00:06:02,919
right defending is not really considered

122
00:06:00,430 --> 00:06:05,050
<font color="#CCCCCC">cool</font><font color="#E5E5E5"> it's the attack part which</font><font color="#CCCCCC"> is</font>

123
00:06:02,919 --> 00:06:06,490
considered yes that's<font color="#E5E5E5"> that's something</font>

124
00:06:05,050 --> 00:06:11,979
<font color="#E5E5E5">which I want to be when I grow up</font>

125
00:06:06,490 --> 00:06:13,960
so we target<font color="#CCCCCC"> that part right which</font><font color="#E5E5E5"> I get</font>

126
00:06:11,979 --> 00:06:16,750
the attackers capability or the

127
00:06:13,960 --> 00:06:18,460
<font color="#E5E5E5">mentality of going for other than</font><font color="#CCCCCC"> this</font>

128
00:06:16,750 --> 00:06:20,560
that<font color="#E5E5E5"> going for the</font><font color="#CCCCCC"> lowest hanging fruit</font>

129
00:06:18,460 --> 00:06:23,169
<font color="#E5E5E5">that's what we have</font><font color="#CCCCCC"> been taught all the</font>

130
00:06:20,560 --> 00:06:24,520
time right you go in<font color="#CCCCCC"> a network go for</font>

131
00:06:23,169 --> 00:06:26,849
the lowest<font color="#E5E5E5"> hanging fruit and you would</font>

132
00:06:24,520 --> 00:06:29,258
be good then you<font color="#CCCCCC"> can later on</font><font color="#E5E5E5"> bag about</font>

133
00:06:26,849 --> 00:06:31,960
getting a<font color="#CCCCCC"> domain admin in half an</font><font color="#E5E5E5"> hour</font>

134
00:06:29,259 --> 00:06:35,810
on<font color="#CCCCCC"> your blog post that's how most of the</font>

135
00:06:31,960 --> 00:06:39,930
<font color="#E5E5E5">red team works right so</font>

136
00:06:35,810 --> 00:06:42,629
and with this<font color="#E5E5E5"> with the advent of mimic</font>

137
00:06:39,930 --> 00:06:47,090
ads and other<font color="#CCCCCC"> Active Directory</font><font color="#E5E5E5"> specific</font>

138
00:06:42,629 --> 00:06:50,129
tools<font color="#CCCCCC"> that the domain admin</font><font color="#E5E5E5"> is one such</font>

139
00:06:47,090 --> 00:06:52,138
<font color="#E5E5E5">coveted prize which everyone wants even</font>

140
00:06:50,129 --> 00:06:55,949
if that is not part of<font color="#E5E5E5"> their original</font>

141
00:06:52,139 --> 00:06:58,650
<font color="#E5E5E5">operations right so we target we text</font>

142
00:06:55,949 --> 00:07:02,069
all of<font color="#E5E5E5"> this thought process of an</font>

143
00:06:58,650 --> 00:07:05,128
attacker<font color="#E5E5E5"> and</font><font color="#CCCCCC"> then we plan a simps</font><font color="#E5E5E5"> of one</font>

144
00:07:02,069 --> 00:07:08,550
or<font color="#E5E5E5"> couple of simple</font><font color="#CCCCCC"> decos</font><font color="#E5E5E5"> which can be</font>

145
00:07:05,129 --> 00:07:15,169
used<font color="#CCCCCC"> to trip an attacker</font><font color="#E5E5E5"> or to just</font>

146
00:07:08,550 --> 00:07:15,169
raise some alerts so in Active Directory

147
00:07:15,500 --> 00:07:20,849
adversary's mostly implement deception

148
00:07:18,810 --> 00:07:22,550
by as I said pirating and replaying

149
00:07:20,849 --> 00:07:25,319
credentials

150
00:07:22,550 --> 00:07:28,529
<font color="#E5E5E5">defenders try to counter it</font><font color="#CCCCCC"> by injecting</font>

151
00:07:25,319 --> 00:07:32,219
<font color="#E5E5E5">fake or Democrats which men use reason</font>

152
00:07:28,529 --> 00:07:34,680
alert but in in case of<font color="#E5E5E5"> acne diet</font>

153
00:07:32,219 --> 00:07:38,430
<font color="#E5E5E5">directory</font><font color="#CCCCCC"> it is not something which we</font>

154
00:07:34,680 --> 00:07:40,860
<font color="#CCCCCC">need to</font><font color="#E5E5E5"> be limited to right if</font><font color="#CCCCCC"> you have</font>

155
00:07:38,430 --> 00:07:43,860
a look at this obligatory kill chain

156
00:07:40,860 --> 00:07:46,550
diagram we can<font color="#E5E5E5"> see</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> always the</font>

157
00:07:43,860 --> 00:07:48,000
attack phase starts with<font color="#CCCCCC"> Drakon or</font>

158
00:07:46,550 --> 00:07:50,340
<font color="#E5E5E5">information-gathering</font>

159
00:07:48,000 --> 00:07:54,000
or an<font color="#CCCCCC"> english and why don't</font><font color="#E5E5E5"> we try to</font>

160
00:07:50,340 --> 00:07:57,659
catch an attacker<font color="#E5E5E5"> during the enumeration</font>

161
00:07:54,000 --> 00:07:59,580
<font color="#E5E5E5">phase right so we'll all we have a look</font>

162
00:07:57,659 --> 00:08:01,979
at some of<font color="#E5E5E5"> the techniques which</font><font color="#CCCCCC"> can be</font>

163
00:07:59,580 --> 00:08:03,839
<font color="#E5E5E5">used for different objects</font><font color="#CCCCCC"> for</font>

164
00:08:01,979 --> 00:08:06,060
<font color="#E5E5E5">enumeration phase</font><font color="#CCCCCC"> and of course for the</font>

165
00:08:03,839 --> 00:08:09,089
<font color="#E5E5E5">little woman part or the domain</font>

166
00:08:06,060 --> 00:08:10,589
dominance part so what what could be the

167
00:08:09,089 --> 00:08:13,560
properties<font color="#CCCCCC"> of a decoy what are the</font>

168
00:08:10,589 --> 00:08:16,259
properties<font color="#E5E5E5"> of a good decoy it should be</font>

169
00:08:13,560 --> 00:08:19,409
<font color="#E5E5E5">desirable enough for an attacker so that</font>

170
00:08:16,259 --> 00:08:22,620
he<font color="#CCCCCC"> or she illuminates the object should</font>

171
00:08:19,409 --> 00:08:24,599
be easily<font color="#E5E5E5"> configurable there should be</font>

172
00:08:22,620 --> 00:08:26,580
no<font color="#E5E5E5"> configuration change required on</font>

173
00:08:24,599 --> 00:08:28,589
endpoints no agent should be<font color="#E5E5E5"> required on</font>

174
00:08:26,580 --> 00:08:31,289
endpoints right<font color="#E5E5E5"> have seen enough of</font>

175
00:08:28,589 --> 00:08:33,860
<font color="#E5E5E5">faith endpoint agents on end points</font>

176
00:08:31,289 --> 00:08:38,309
themselves<font color="#E5E5E5"> expose a new attack surface</font>

177
00:08:33,860 --> 00:08:40,079
and most importantly a deco<font color="#E5E5E5"> should not</font>

178
00:08:38,309 --> 00:08:41,698
be<font color="#E5E5E5"> triggered by normal admin activity</font>

179
00:08:40,078 --> 00:08:43,588
<font color="#CCCCCC">false for a</font><font color="#E5E5E5"> large number of false</font>

180
00:08:41,698 --> 00:08:47,010
positives<font color="#CCCCCC"> and you kill a good detection</font>

181
00:08:43,589 --> 00:08:48,750
mechanism now<font color="#E5E5E5"> when I was researching or</font>

182
00:08:47,010 --> 00:08:51,990
working on<font color="#E5E5E5"> this particular part</font>

183
00:08:48,750 --> 00:08:55,560
<font color="#CCCCCC">food was</font><font color="#E5E5E5"> the most</font><font color="#CCCCCC"> difficult thing to</font>

184
00:08:51,990 --> 00:08:58,020
achieve<font color="#E5E5E5"> right something when you're</font>

185
00:08:55,560 --> 00:09:00,420
talking about<font color="#E5E5E5"> enumeration</font><font color="#CCCCCC"> that is that</font>

186
00:08:58,020 --> 00:09:01,800
mixes really well<font color="#E5E5E5"> and attackers</font>

187
00:09:00,420 --> 00:09:04,050
enumeration<font color="#E5E5E5"> or an adversary's</font>

188
00:09:01,800 --> 00:09:05,790
enumeration mixes really well with the

189
00:09:04,050 --> 00:09:08,420
normal network traffic or the<font color="#E5E5E5"> normal</font>

190
00:09:05,790 --> 00:09:12,660
admin activity right<font color="#E5E5E5"> so how do we</font>

191
00:09:08,420 --> 00:09:13,979
separate it<font color="#CCCCCC"> the adversary's a new</font>

192
00:09:12,660 --> 00:09:16,260
mission<font color="#E5E5E5"> how do we separate it from</font>

193
00:09:13,980 --> 00:09:20,520
<font color="#E5E5E5">normal</font><font color="#CCCCCC"> admin</font><font color="#E5E5E5"> activity</font><font color="#CCCCCC"> that was the most</font>

194
00:09:16,260 --> 00:09:22,380
difficult part<font color="#E5E5E5"> so I'm</font><font color="#CCCCCC"> talking</font><font color="#E5E5E5"> about this</font>

195
00:09:20,520 --> 00:09:25,470
meme I really<font color="#E5E5E5"> wanted to put it on the</font>

196
00:09:22,380 --> 00:09:28,820
one<font color="#E5E5E5"> of the slides so what we are going</font>

197
00:09:25,470 --> 00:09:33,690
<font color="#E5E5E5">to do is we are going to forge some</font>

198
00:09:28,820 --> 00:09:36,690
objects like users computers<font color="#E5E5E5"> forests to</font>

199
00:09:33,690 --> 00:09:40,350
see if we can trick a user<font color="#CCCCCC"> an</font><font color="#E5E5E5"> adverse</font>

200
00:09:36,690 --> 00:09:42,360
<font color="#E5E5E5">fee in spending more time right even if</font>

201
00:09:40,350 --> 00:09:44,370
we cannot stop<font color="#CCCCCC"> an adversary because this</font>

202
00:09:42,360 --> 00:09:46,410
is not<font color="#CCCCCC"> a blocking thing we can at least</font>

203
00:09:44,370 --> 00:09:51,000
increase<font color="#E5E5E5"> the costs for them in terms of</font>

204
00:09:46,410 --> 00:09:53,370
<font color="#E5E5E5">time right</font><font color="#CCCCCC"> what we are going</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> do is we</font>

205
00:09:51,000 --> 00:09:55,920
are going to<font color="#E5E5E5"> use</font><font color="#CCCCCC"> built in tools like</font>

206
00:09:53,370 --> 00:09:57,510
Active Directory module from Microsoft

207
00:09:55,920 --> 00:09:59,969
which comes on your domain controller by

208
00:09:57,510 --> 00:10:01,980
default group policy and<font color="#CCCCCC"> built-in</font>

209
00:09:59,970 --> 00:10:05,010
<font color="#CCCCCC">logging mechanism</font><font color="#E5E5E5"> to do something</font>

210
00:10:01,980 --> 00:10:07,410
hopefully<font color="#CCCCCC"> interesting so let's start</font>

211
00:10:05,010 --> 00:10:11,010
<font color="#E5E5E5">with the enumeration phase and user</font>

212
00:10:07,410 --> 00:10:13,589
objects so when an adversary is

213
00:10:11,010 --> 00:10:16,050
enumerated<font color="#E5E5E5"> or an attacker is enumerating</font>

214
00:10:13,589 --> 00:10:18,210
any Active Directory environment<font color="#CCCCCC"> what is</font>

215
00:10:16,050 --> 00:10:21,510
that they are<font color="#CCCCCC"> looking for</font><font color="#E5E5E5"> in user</font>

216
00:10:18,210 --> 00:10:23,490
objects<font color="#E5E5E5"> users whose password do not</font>

217
00:10:21,510 --> 00:10:25,020
expire<font color="#E5E5E5"> users who are trusted for</font>

218
00:10:23,490 --> 00:10:27,150
delegation<font color="#CCCCCC"> constraint and</font><font color="#E5E5E5"> constraint</font>

219
00:10:25,020 --> 00:10:29,490
both of it users which have interesting

220
00:10:27,150 --> 00:10:32,069
<font color="#CCCCCC">SPN set rights so that they can Kerberos</font>

221
00:10:29,490 --> 00:10:34,860
<font color="#CCCCCC">tit passwords in description field</font>

222
00:10:32,070 --> 00:10:36,540
that's also very<font color="#CCCCCC"> interesting users who</font>

223
00:10:34,860 --> 00:10:39,420
are member of<font color="#E5E5E5"> high privileged groups</font>

224
00:10:36,540 --> 00:10:42,030
domain admins<font color="#E5E5E5"> right as I said that is</font>

225
00:10:39,420 --> 00:10:44,160
<font color="#CCCCCC">something very</font><font color="#E5E5E5"> coveted users who have</font>

226
00:10:42,030 --> 00:10:48,510
interesting<font color="#CCCCCC"> se else</font><font color="#E5E5E5"> as well</font>

227
00:10:44,160 --> 00:10:51,510
now we can turn on this<font color="#E5E5E5"> particular group</font>

228
00:10:48,510 --> 00:10:55,020
policy setting in under advanced audit

229
00:10:51,510 --> 00:10:56,880
<font color="#CCCCCC">policy configuration D sxs which logs</font><font color="#E5E5E5"> or</font>

230
00:10:55,020 --> 00:10:59,790
for double<font color="#CCCCCC"> six two directory service</font>

231
00:10:56,880 --> 00:11:00,889
<font color="#CCCCCC">access whenever</font><font color="#E5E5E5"> a directory object is</font>

232
00:10:59,790 --> 00:11:03,469
accessed

233
00:11:00,889 --> 00:11:05,929
now<font color="#E5E5E5"> after enabling this we can configure</font>

234
00:11:03,470 --> 00:11:10,189
each and every object<font color="#E5E5E5"> as per our choice</font>

235
00:11:05,929 --> 00:11:14,389
so<font color="#CCCCCC"> that affordable six-two is logged</font>

236
00:11:10,189 --> 00:11:16,009
when a particular right is used against

237
00:11:14,389 --> 00:11:19,779
that object when something particular is

238
00:11:16,009 --> 00:11:23,829
done against that object right<font color="#E5E5E5"> so a</font>

239
00:11:19,779 --> 00:11:27,499
quick look at how auditing looks like

240
00:11:23,829 --> 00:11:30,079
access<font color="#E5E5E5"> mask rights for which auditing is</font>

241
00:11:27,499 --> 00:11:34,579
done what's<font color="#E5E5E5"> that why what could be</font>

242
00:11:30,079 --> 00:11:37,779
<font color="#CCCCCC">Detroit Reid property greed Akal</font><font color="#E5E5E5"> video</font>

243
00:11:34,579 --> 00:11:40,969
<font color="#E5E5E5">is</font><font color="#CCCCCC"> C value</font><font color="#E5E5E5"> read an obscure property</font>

244
00:11:37,779 --> 00:11:43,730
that's<font color="#E5E5E5"> in case of the user objects or if</font>

245
00:11:40,970 --> 00:11:46,369
let's<font color="#CCCCCC"> say</font><font color="#E5E5E5"> in case of groups it</font><font color="#CCCCCC"> agreed</font>

246
00:11:43,730 --> 00:11:49,369
group membership in case of<font color="#CCCCCC"> for assist</font>

247
00:11:46,369 --> 00:11:52,069
could be read trusted for<font color="#E5E5E5"> s so these are</font>

248
00:11:49,369 --> 00:11:56,419
the different rights for which we can

249
00:11:52,069 --> 00:11:58,910
<font color="#E5E5E5">turn on auditing so then set of the</font>

250
00:11:56,419 --> 00:12:01,209
trustees<font color="#CCCCCC"> for which you can turn on</font>

251
00:11:58,910 --> 00:12:04,519
<font color="#E5E5E5">auditing everyone is the</font>

252
00:12:01,209 --> 00:12:07,579
all-encompassing<font color="#E5E5E5"> said and then we could</font>

253
00:12:04,519 --> 00:12:10,689
be<font color="#E5E5E5"> specific users as well then the last</font>

254
00:12:07,579 --> 00:12:14,209
<font color="#E5E5E5">two</font><font color="#CCCCCC"> ones</font><font color="#E5E5E5"> the bull ones</font><font color="#CCCCCC"> of would</font><font color="#E5E5E5"> you like</font>

255
00:12:10,689 --> 00:12:17,959
auditing to be turned on on<font color="#E5E5E5"> success or</font>

256
00:12:14,209 --> 00:12:21,618
failure so with that we can create a

257
00:12:17,959 --> 00:12:23,599
user with some interesting<font color="#E5E5E5"> flags now</font>

258
00:12:21,619 --> 00:12:26,230
auditing can be set as I said for some

259
00:12:23,600 --> 00:12:28,999
rights<font color="#E5E5E5"> what rights are usually useful</font>

260
00:12:26,230 --> 00:12:32,869
genrih<font color="#CCCCCC"> Creed</font><font color="#E5E5E5"> that is if someone reads</font>

261
00:12:28,999 --> 00:12:35,829
<font color="#E5E5E5">any property right then read control</font><font color="#CCCCCC"> if</font>

262
00:12:32,869 --> 00:12:39,230
someone reads the deckle specific rights

263
00:12:35,829 --> 00:12:41,899
of generally for a bit obscure one to

264
00:12:39,230 --> 00:12:44,389
avoid very verbose logging logging<font color="#E5E5E5"> right</font>

265
00:12:41,899 --> 00:12:46,789
for<font color="#CCCCCC"> example the one</font><font color="#E5E5E5"> written here</font><font color="#CCCCCC"> x500</font>

266
00:12:44,389 --> 00:12:49,579
unique identifier that's pretty much

267
00:12:46,789 --> 00:12:53,329
obscure one but it<font color="#E5E5E5"> is there for all the</font>

268
00:12:49,579 --> 00:12:56,539
Active<font color="#E5E5E5"> Directory objects now how do we</font>

269
00:12:53,329 --> 00:12:58,819
automate this right how do we<font color="#E5E5E5"> automate</font>

270
00:12:56,539 --> 00:13:02,779
creating an attractive<font color="#E5E5E5"> user and enabling</font>

271
00:12:58,819 --> 00:13:05,929
<font color="#E5E5E5">login for it so I wrote a partial module</font>

272
00:13:02,779 --> 00:13:07,399
called<font color="#E5E5E5"> deploy deception which is a</font>

273
00:13:05,929 --> 00:13:09,410
wrapper around<font color="#CCCCCC"> the</font><font color="#E5E5E5"> Active Directory</font>

274
00:13:07,399 --> 00:13:11,360
module which can be used to create

275
00:13:09,410 --> 00:13:14,040
different<font color="#CCCCCC"> types of decor</font><font color="#E5E5E5"> objects to turn</font>

276
00:13:11,360 --> 00:13:15,300
on<font color="#E5E5E5"> auditing so I that's not up</font>

277
00:13:14,040 --> 00:13:17,880
<font color="#E5E5E5">it would be</font><font color="#CCCCCC"> available on my github</font>

278
00:13:15,300 --> 00:13:20,550
account<font color="#E5E5E5"> so that</font><font color="#CCCCCC"> packs a</font><font color="#E5E5E5"> lot</font><font color="#CCCCCC"> of</font>

279
00:13:17,880 --> 00:13:22,199
interesting research<font color="#E5E5E5"> research it uses</font>

280
00:13:20,550 --> 00:13:25,380
artificial intelligence<font color="#CCCCCC"> and machine</font>

281
00:13:22,199 --> 00:13:27,750
learning to learn behavior of

282
00:13:25,380 --> 00:13:32,009
<font color="#E5E5E5">adversaries and then it uses blockchain</font>

283
00:13:27,750 --> 00:13:33,209
<font color="#E5E5E5">to compare that with a</font><font color="#CCCCCC"> database</font><font color="#E5E5E5"> of 10</font>

284
00:13:32,009 --> 00:13:39,810
million endpoints where I've<font color="#E5E5E5"> been</font>

285
00:13:33,209 --> 00:13:43,290
running this right<font color="#E5E5E5"> of course so this is</font>

286
00:13:39,810 --> 00:13:47,819
how we use it we can<font color="#CCCCCC"> simply</font><font color="#E5E5E5"> create a</font>

287
00:13:43,290 --> 00:13:49,319
<font color="#CCCCCC">dacoit</font><font color="#E5E5E5"> user and name it make it part of</font>

288
00:13:47,819 --> 00:13:51,240
an<font color="#E5E5E5"> interesting group</font><font color="#CCCCCC"> Latour if you want</font>

289
00:13:49,319 --> 00:13:53,519
for example<font color="#CCCCCC"> in this</font><font color="#E5E5E5"> case</font><font color="#CCCCCC"> we create</font><font color="#E5E5E5"> a</font>

290
00:13:51,240 --> 00:13:55,560
user called<font color="#E5E5E5"> simply user manager which</font>

291
00:13:53,519 --> 00:13:59,490
has the flag<font color="#CCCCCC"> side password never expires</font>

292
00:13:55,560 --> 00:14:01,529
he created<font color="#CCCCCC"> please keep in mind</font><font color="#E5E5E5"> that you</font>

293
00:13:59,490 --> 00:14:03,149
are creating an actual<font color="#CCCCCC"> object when we</font>

294
00:14:01,529 --> 00:14:06,630
run this we are creating an<font color="#E5E5E5"> actual</font>

295
00:14:03,149 --> 00:14:08,730
object<font color="#E5E5E5"> on the domain controller</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> we</font>

296
00:14:06,630 --> 00:14:10,680
like<font color="#CCCCCC"> to record changes or whatever</font>

297
00:14:08,730 --> 00:14:12,319
documentation<font color="#E5E5E5"> your organization follows</font>

298
00:14:10,680 --> 00:14:19,019
<font color="#E5E5E5">you use that for it</font>

299
00:14:12,319 --> 00:14:21,170
<font color="#E5E5E5">now once that is created for</font><font color="#CCCCCC"> example</font>

300
00:14:19,019 --> 00:14:24,329
these<font color="#CCCCCC"> are some of the</font><font color="#E5E5E5"> commands which</font>

301
00:14:21,170 --> 00:14:26,519
generally adversary's<font color="#CCCCCC"> use to enumerate</font>

302
00:14:24,329 --> 00:14:29,550
your environment<font color="#E5E5E5"> this gets the one we</font>

303
00:14:26,519 --> 00:14:32,910
<font color="#CCCCCC">created just now</font><font color="#E5E5E5"> this user called user</font>

304
00:14:29,550 --> 00:14:35,250
manager that logs<font color="#CCCCCC"> off for devil 6</font><font color="#E5E5E5"> - for</font>

305
00:14:32,910 --> 00:14:38,279
all of<font color="#CCCCCC"> these right which is not</font>

306
00:14:35,250 --> 00:14:43,440
<font color="#CCCCCC">desirable because that also includes</font>

307
00:14:38,279 --> 00:14:45,449
some<font color="#CCCCCC"> of normal admin activity right and</font>

308
00:14:43,440 --> 00:14:50,000
this is where we<font color="#CCCCCC"> start looking for ways</font>

309
00:14:45,449 --> 00:14:55,199
<font color="#CCCCCC">to</font><font color="#E5E5E5"> decrease the verbosity so for example</font>

310
00:14:50,000 --> 00:14:58,370
<font color="#E5E5E5">the X 500 unique identifier that's a</font>

311
00:14:55,199 --> 00:15:01,859
property<font color="#E5E5E5"> which is available for all</font><font color="#CCCCCC"> the</font>

312
00:14:58,370 --> 00:15:04,680
Active Directory objects but none<font color="#CCCCCC"> of the</font>

313
00:15:01,860 --> 00:15:07,649
tools which<font color="#E5E5E5"> we</font><font color="#CCCCCC"> have sewn on see</font><font color="#E5E5E5"> already</font>

314
00:15:04,680 --> 00:15:11,339
here<font color="#E5E5E5"> or none of the methods log it</font>

315
00:15:07,649 --> 00:15:12,870
unless you deliberately list all the

316
00:15:11,339 --> 00:15:15,360
properties of the<font color="#CCCCCC"> Active Directory</font>

317
00:15:12,870 --> 00:15:20,149
<font color="#E5E5E5">object of that particular object which</font>

318
00:15:15,360 --> 00:15:20,149
makes it quite<font color="#E5E5E5"> usable right</font>

319
00:15:21,079 --> 00:15:27,410
now you may like to notice that the

320
00:15:24,029 --> 00:15:30,480
elder based tools like powering or the

321
00:15:27,410 --> 00:15:33,089
the one from sysinternals<font color="#CCCCCC"> ad</font><font color="#E5E5E5"> Explorer</font>

322
00:15:30,480 --> 00:15:35,220
<font color="#E5E5E5">these are the tools which extract much</font>

323
00:15:33,089 --> 00:15:38,100
more<font color="#CCCCCC"> information than let's say net or</font>

324
00:15:35,220 --> 00:15:42,929
<font color="#E5E5E5">WMI based tools or defined user scripts</font>

325
00:15:38,100 --> 00:15:46,519
and<font color="#CCCCCC"> context squee so these</font><font color="#E5E5E5"> tools are the</font>

326
00:15:42,929 --> 00:15:48,569
ones which we are going to target for

327
00:15:46,519 --> 00:15:50,790
decreasing<font color="#CCCCCC"> the verbose logging right</font>

328
00:15:48,569 --> 00:15:53,998
<font color="#E5E5E5">these are the ones which may result in</font>

329
00:15:50,790 --> 00:15:55,910
false positives<font color="#CCCCCC"> if if the deployment is</font>

330
00:15:53,999 --> 00:16:01,049
not smart enough

331
00:15:55,910 --> 00:16:03,290
so I cannot still connect<font color="#E5E5E5"> to my RDP box</font>

332
00:16:01,049 --> 00:16:06,059
though so I'm going<font color="#E5E5E5"> to show you a video</font>

333
00:16:03,290 --> 00:16:08,509
which I<font color="#E5E5E5"> recorded this</font><font color="#CCCCCC"> morning I'm a big</font>

334
00:16:06,059 --> 00:16:10,499
fan of live demonstrations and

335
00:16:08,509 --> 00:16:12,179
thankfully I have the videos<font color="#E5E5E5"> today</font>

336
00:16:10,499 --> 00:16:15,809
otherwise<font color="#CCCCCC"> I would never</font><font color="#E5E5E5"> have</font><font color="#CCCCCC"> that as</font>

337
00:16:12,179 --> 00:16:25,619
<font color="#CCCCCC">well so to</font><font color="#E5E5E5"> have the voice turned off</font>

338
00:16:15,809 --> 00:16:27,179
good is this really visible yes good<font color="#E5E5E5"> so</font>

339
00:16:25,619 --> 00:16:30,929
we are on a<font color="#CCCCCC"> domain controller</font><font color="#E5E5E5"> right now</font>

340
00:16:27,179 --> 00:16:33,869
<font color="#CCCCCC">that's the domain controller</font><font color="#E5E5E5"> in</font><font color="#CCCCCC"> my lab</font>

341
00:16:30,929 --> 00:16:38,699
we load up<font color="#E5E5E5"> the module or</font><font color="#CCCCCC"> the script</font><font color="#E5E5E5"> and</font>

342
00:16:33,869 --> 00:16:42,449
then we create a user<font color="#E5E5E5"> a simple decoy</font>

343
00:16:38,699 --> 00:16:47,488
user right that<font color="#E5E5E5"> the core user does not</font>

344
00:16:42,449 --> 00:16:50,569
<font color="#E5E5E5">have</font><font color="#CCCCCC"> any special login turned on so I</font>

345
00:16:47,489 --> 00:16:54,209
turn on the login let me skip<font color="#E5E5E5"> that a bit</font>

346
00:16:50,569 --> 00:16:57,149
turn on the logging<font color="#E5E5E5"> then I go to this is</font>

347
00:16:54,209 --> 00:17:00,229
the attackers machine we enumerate users

348
00:16:57,149 --> 00:17:00,230
<font color="#E5E5E5">using different tools</font>

349
00:17:03,610 --> 00:17:10,690
and you can see that<font color="#CCCCCC"> even with</font><font color="#E5E5E5"> without</font>

350
00:17:07,180 --> 00:17:12,190
<font color="#E5E5E5">any if we are not using any verbose</font>

351
00:17:10,690 --> 00:17:15,490
sorry if you're<font color="#CCCCCC"> not suppressing any</font>

352
00:17:12,190 --> 00:17:19,950
logging<font color="#E5E5E5"> even a net user would would fire</font>

353
00:17:15,490 --> 00:17:19,950
<font color="#E5E5E5">this log so we do something better</font>

354
00:17:21,569 --> 00:17:34,929
what's that<font color="#CCCCCC"> okay now we create a user</font>

355
00:17:30,280 --> 00:17:38,460
which has a logging enabled only when<font color="#E5E5E5"> an</font>

356
00:17:34,930 --> 00:17:42,870
obscure<font color="#CCCCCC"> properties</font><font color="#E5E5E5"> read</font><font color="#CCCCCC"> write this one</font>

357
00:17:38,460 --> 00:17:42,870
so we create this particular<font color="#CCCCCC"> user</font>

358
00:17:50,480 --> 00:17:58,809
and right now we<font color="#E5E5E5"> are going to enumerate</font>

359
00:17:53,779 --> 00:17:58,809
<font color="#E5E5E5">the users on this in this domain</font>

360
00:18:05,750 --> 00:18:12,560
so we do the enumeration using net<font color="#CCCCCC"> WMI</font>

361
00:18:09,740 --> 00:18:15,920
<font color="#CCCCCC">now Power View</font><font color="#E5E5E5"> in the Active Directory</font>

362
00:18:12,560 --> 00:18:25,850
module which Microsoft<font color="#E5E5E5"> provides you we</font>

363
00:18:15,920 --> 00:18:27,830
do<font color="#E5E5E5"> any mission using</font><font color="#CCCCCC"> all of</font><font color="#E5E5E5"> them</font><font color="#CCCCCC"> you may</font>

364
00:18:25,850 --> 00:18:31,179
like to<font color="#E5E5E5"> notice that if I have shown that</font>

365
00:18:27,830 --> 00:18:35,419
here that<font color="#CCCCCC"> right</font><font color="#E5E5E5"> now there is no log when</font>

366
00:18:31,180 --> 00:18:37,940
normal attributes are<font color="#CCCCCC"> read right</font><font color="#E5E5E5"> but as</font>

367
00:18:35,420 --> 00:18:40,160
soon as<font color="#E5E5E5"> we run a tool which reads all of</font>

368
00:18:37,940 --> 00:18:42,920
the attributes<font color="#CCCCCC"> for example let's say</font>

369
00:18:40,160 --> 00:18:45,290
<font color="#E5E5E5">Power View or we read all properties</font>

370
00:18:42,920 --> 00:18:48,100
using<font color="#CCCCCC"> the ad module as soon as we do</font>

371
00:18:45,290 --> 00:18:48,100
<font color="#CCCCCC">that there</font><font color="#E5E5E5"> is a log</font>

372
00:18:56,170 --> 00:19:03,549
so now I<font color="#CCCCCC"> don't get net user from</font><font color="#E5E5E5"> Power</font>

373
00:18:59,590 --> 00:19:07,480
<font color="#E5E5E5">View we get a list of users and there is</font>

374
00:19:03,549 --> 00:19:10,440
affordable<font color="#CCCCCC"> 62 here right</font><font color="#E5E5E5"> so that's why</font>

375
00:19:07,480 --> 00:19:13,179
that's how we can make<font color="#E5E5E5"> tools which are</font>

376
00:19:10,440 --> 00:19:15,660
reading things which are not generally

377
00:19:13,179 --> 00:19:20,620
not<font color="#CCCCCC"> required for system administration</font>

378
00:19:15,660 --> 00:19:25,420
<font color="#E5E5E5">stand out now this is good but still</font>

379
00:19:20,620 --> 00:19:28,299
<font color="#E5E5E5">there are chances that we do not get</font>

380
00:19:25,420 --> 00:19:29,980
these logs initiated or get logged even

381
00:19:28,299 --> 00:19:32,168
when the normal<font color="#E5E5E5"> system</font><font color="#CCCCCC"> activity was</font>

382
00:19:29,980 --> 00:19:34,059
being done or there was an asset

383
00:19:32,169 --> 00:19:37,000
management system<font color="#E5E5E5"> which was looking at</font>

384
00:19:34,059 --> 00:19:47,710
all the<font color="#E5E5E5"> properties so to avoid that</font>

385
00:19:37,000 --> 00:19:50,380
scenario<font color="#E5E5E5"> okay we can turn logging on for</font>

386
00:19:47,710 --> 00:19:53,650
some really<font color="#E5E5E5"> interesting things as we saw</font>

387
00:19:50,380 --> 00:19:57,059
earlier<font color="#E5E5E5"> when someone reads tackle and</font>

388
00:19:53,650 --> 00:20:00,220
the<font color="#E5E5E5"> tackle that is the security based</font>

389
00:19:57,059 --> 00:20:02,440
the ACL that is the access control list

390
00:20:00,220 --> 00:20:06,760
which controls the security<font color="#E5E5E5"> that is not</font>

391
00:20:02,440 --> 00:20:09,730
read in normal scenarios right<font color="#E5E5E5"> which</font>

392
00:20:06,760 --> 00:20:15,970
makes logging a bit less verbose but

393
00:20:09,730 --> 00:20:18,700
<font color="#CCCCCC">very much accurate now this was about</font>

394
00:20:15,970 --> 00:20:22,270
normal users we can do the same thing

395
00:20:18,700 --> 00:20:24,100
with computer objects as well right that

396
00:20:22,270 --> 00:20:27,070
is we do have computer objects we can

397
00:20:24,100 --> 00:20:28,659
<font color="#CCCCCC">create them</font><font color="#E5E5E5"> those of</font><font color="#CCCCCC"> you are unaware of</font>

398
00:20:27,070 --> 00:20:30,939
<font color="#CCCCCC">that we can create any number of</font>

399
00:20:28,660 --> 00:20:33,490
computer objects when it comes to<font color="#E5E5E5"> Active</font>

400
00:20:30,940 --> 00:20:37,650
<font color="#E5E5E5">Directory</font><font color="#CCCCCC"> Network</font><font color="#E5E5E5"> it need not map to a</font>

401
00:20:33,490 --> 00:20:42,580
real computer<font color="#E5E5E5"> but it is always advised</font>

402
00:20:37,650 --> 00:20:46,090
to<font color="#E5E5E5"> have a real computer</font><font color="#CCCCCC"> so to</font><font color="#E5E5E5"> use a real</font>

403
00:20:42,580 --> 00:20:47,740
computer<font color="#E5E5E5"> as a decoy so that if someone</font>

404
00:20:46,090 --> 00:20:49,360
is<font color="#E5E5E5"> trying to figure</font><font color="#CCCCCC"> out if you are using</font>

405
00:20:47,740 --> 00:20:52,179
the coils in<font color="#E5E5E5"> your</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> in your environment</font>

406
00:20:49,360 --> 00:20:54,129
<font color="#E5E5E5">your</font><font color="#CCCCCC"> the coils should not stand out</font><font color="#E5E5E5"> so</font>

407
00:20:52,179 --> 00:20:55,570
what are the what are<font color="#E5E5E5"> the properties</font>

408
00:20:54,130 --> 00:20:58,179
<font color="#E5E5E5">which attackers are looking into</font>

409
00:20:55,570 --> 00:21:00,689
computers older operating<font color="#CCCCCC"> systems of</font>

410
00:20:58,179 --> 00:21:03,400
course interesting<font color="#CCCCCC"> SP ins</font>

411
00:21:00,690 --> 00:21:04,809
delegation settings membership of higher

412
00:21:03,400 --> 00:21:06,900
<font color="#E5E5E5">privileged groups like domain</font>

413
00:21:04,809 --> 00:21:09,910
controllers<font color="#CCCCCC"> it strong</font>

414
00:21:06,900 --> 00:21:12,640
quite similar<font color="#CCCCCC"> to</font><font color="#E5E5E5"> what we have done with</font>

415
00:21:09,910 --> 00:21:16,000
users we can use or we can create<font color="#E5E5E5"> deck</font>

416
00:21:12,640 --> 00:21:20,620
<font color="#CCCCCC">wire computers as well</font><font color="#E5E5E5"> properties could</font>

417
00:21:16,000 --> 00:21:24,460
be obscure ones like unique<font color="#CCCCCC"> x500</font><font color="#E5E5E5"> unique</font>

418
00:21:20,620 --> 00:21:26,229
<font color="#CCCCCC">identifier or</font><font color="#E5E5E5"> anything else now</font><font color="#CCCCCC"> if you</font>

419
00:21:24,460 --> 00:21:29,080
would<font color="#E5E5E5"> like to</font><font color="#CCCCCC"> experiment with</font><font color="#E5E5E5"> it you can</font>

420
00:21:26,230 --> 00:21:32,710
<font color="#CCCCCC">use</font><font color="#E5E5E5"> DC shadow from immigrants which can</font>

421
00:21:29,080 --> 00:21:36,399
which allows you<font color="#CCCCCC"> to modify</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> schema</font>

422
00:21:32,710 --> 00:21:38,550
<font color="#CCCCCC">off of your domain to make a make a</font>

423
00:21:36,400 --> 00:21:41,380
computer<font color="#E5E5E5"> look like a domain controller</font>

424
00:21:38,550 --> 00:21:43,300
<font color="#CCCCCC">that's not very stable in my</font><font color="#E5E5E5"> testing so</font>

425
00:21:41,380 --> 00:21:45,460
that's why they<font color="#E5E5E5"> have</font><font color="#CCCCCC"> not included it in</font>

426
00:21:43,300 --> 00:21:47,500
the in the module<font color="#E5E5E5"> but that is also</font>

427
00:21:45,460 --> 00:21:50,080
usable I played with it<font color="#E5E5E5"> somewhat</font>

428
00:21:47,500 --> 00:21:51,640
sometimes it may break authentication

429
00:21:50,080 --> 00:21:54,010
that's just my feeling<font color="#CCCCCC"> is that's</font><font color="#E5E5E5"> not</font>

430
00:21:51,640 --> 00:21:56,370
what<font color="#CCCCCC"> I found out</font><font color="#E5E5E5"> that's that's why it's</font>

431
00:21:54,010 --> 00:21:59,050
not<font color="#E5E5E5"> included yet</font>

432
00:21:56,370 --> 00:22:00,639
next comes<font color="#E5E5E5"> the</font><font color="#CCCCCC"> groups</font><font color="#E5E5E5"> so we are going</font>

433
00:21:59,050 --> 00:22:01,870
<font color="#CCCCCC">through different</font><font color="#E5E5E5"> types of objects in</font>

434
00:22:00,640 --> 00:22:04,210
<font color="#E5E5E5">the enumeration</font><font color="#CCCCCC"> phase right</font>

435
00:22:01,870 --> 00:22:06,699
we start with<font color="#E5E5E5"> users computers now come</font>

436
00:22:04,210 --> 00:22:09,370
groups groups of course are also

437
00:22:06,700 --> 00:22:12,850
interesting we can<font color="#CCCCCC"> have</font><font color="#E5E5E5"> decoy groups</font>

438
00:22:09,370 --> 00:22:16,030
<font color="#E5E5E5">which log whenever an obscure</font><font color="#CCCCCC"> property</font>

439
00:22:12,850 --> 00:22:17,860
<font color="#CCCCCC">is tried we</font><font color="#E5E5E5"> can make a group part of</font>

440
00:22:16,030 --> 00:22:19,360
another<font color="#E5E5E5"> interesting groups for example</font>

441
00:22:17,860 --> 00:22:21,490
group can be<font color="#CCCCCC"> a</font><font color="#E5E5E5"> member</font><font color="#CCCCCC"> of the domain</font>

442
00:22:19,360 --> 00:22:23,919
admins and then you can have<font color="#E5E5E5"> that</font>

443
00:22:21,490 --> 00:22:30,880
<font color="#E5E5E5">particular group my other</font><font color="#CCCCCC"> members are</font>

444
00:22:23,920 --> 00:22:32,920
users as<font color="#CCCCCC"> well</font><font color="#E5E5E5"> so for example if I create</font>

445
00:22:30,880 --> 00:22:34,180
run this<font color="#E5E5E5"> particular command what we are</font>

446
00:22:32,920 --> 00:22:38,170
<font color="#E5E5E5">doing here we</font><font color="#CCCCCC"> are creating a group</font>

447
00:22:34,180 --> 00:22:41,440
called<font color="#E5E5E5"> forest admins which has members</font>

448
00:22:38,170 --> 00:22:44,230
<font color="#E5E5E5">just one member called slave user and</font>

449
00:22:41,440 --> 00:22:47,650
then we add this particular<font color="#CCCCCC"> group to the</font>

450
00:22:44,230 --> 00:22:49,810
<font color="#E5E5E5">DNS DNS admin</font><font color="#CCCCCC"> scope right so now if</font>

451
00:22:47,650 --> 00:22:52,570
someone<font color="#E5E5E5"> enumerates the groups in your</font>

452
00:22:49,810 --> 00:22:55,379
environment<font color="#CCCCCC"> they would be</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> four double</font>

453
00:22:52,570 --> 00:22:58,840
<font color="#CCCCCC">six - if you want to suppress it a bit</font>

454
00:22:55,380 --> 00:23:02,200
then go for a good<font color="#E5E5E5"> a good property like</font>

455
00:22:58,840 --> 00:23:05,860
<font color="#E5E5E5">X 500 unique</font><font color="#CCCCCC"> identifier something like</font>

456
00:23:02,200 --> 00:23:07,480
this what what this<font color="#E5E5E5"> command does a log</font>

457
00:23:05,860 --> 00:23:10,149
is created only<font color="#E5E5E5"> when the group</font>

458
00:23:07,480 --> 00:23:13,030
<font color="#E5E5E5">membership is read not the group name so</font>

459
00:23:10,150 --> 00:23:14,890
you can experiment with<font color="#E5E5E5"> it depending on</font>

460
00:23:13,030 --> 00:23:16,960
<font color="#E5E5E5">the type of logs you want in your</font>

461
00:23:14,890 --> 00:23:22,850
environment

462
00:23:16,960 --> 00:23:27,550
so I think<font color="#E5E5E5"> I have a quick video</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> this</font>

463
00:23:22,850 --> 00:23:27,550
as well this is users and computers so I

464
00:23:27,970 --> 00:23:41,480
think we<font color="#CCCCCC"> should be fine with closing</font>

465
00:23:33,050 --> 00:23:43,899
<font color="#E5E5E5">this so we create a group called forest</font>

466
00:23:41,480 --> 00:23:43,900
admins

467
00:23:53,619 --> 00:23:57,769
and the logging is enabled only when

468
00:23:56,059 --> 00:24:00,489
<font color="#E5E5E5">someone reads the deckle of that</font>

469
00:23:57,769 --> 00:24:00,489
particular<font color="#E5E5E5"> group</font>

470
00:24:07,580 --> 00:24:13,520
and then we go to the attackers machine

471
00:24:10,169 --> 00:24:13,520
<font color="#CCCCCC">i numerate the</font><font color="#E5E5E5"> crops</font>

472
00:24:27,690 --> 00:24:38,589
using three different<font color="#CCCCCC"> tools okay so</font>

473
00:24:36,789 --> 00:24:43,229
there is no logging<font color="#CCCCCC"> because we are right</font>

474
00:24:38,589 --> 00:24:52,839
now<font color="#CCCCCC"> looking for a log only when someone</font>

475
00:24:43,229 --> 00:24:56,529
lists the membership<font color="#E5E5E5"> for the deckle</font>

476
00:24:52,839 --> 00:25:03,059
sorry<font color="#E5E5E5"> so here when we</font><font color="#CCCCCC"> read all the</font>

477
00:24:56,529 --> 00:25:08,649
properties which includes the deckle

478
00:25:03,059 --> 00:25:10,869
<font color="#E5E5E5">only in that case the log was created so</font>

479
00:25:08,649 --> 00:25:12,699
which<font color="#E5E5E5"> makes it quite usable even enough</font>

480
00:25:10,869 --> 00:25:15,039
fairly uses we<font color="#E5E5E5"> use a fairly large</font>

481
00:25:12,700 --> 00:25:16,960
environment<font color="#E5E5E5"> right so that you have</font>

482
00:25:15,039 --> 00:25:20,908
<font color="#E5E5E5">dressed less number of false positives</font>

483
00:25:16,960 --> 00:25:20,909
<font color="#CCCCCC">or unnecessary verbose logging</font>

484
00:25:30,330 --> 00:25:40,689
<font color="#CCCCCC">okay so we</font><font color="#E5E5E5"> have a four double six to</font>

485
00:25:32,770 --> 00:25:43,660
here and then we<font color="#CCCCCC"> can also do</font><font color="#E5E5E5"> quite</font>

486
00:25:40,690 --> 00:25:46,690
similar quite similarly<font color="#E5E5E5"> we can create a</font>

487
00:25:43,660 --> 00:25:49,180
log<font color="#E5E5E5"> when the group membership is read</font>

488
00:25:46,690 --> 00:25:58,660
<font color="#E5E5E5">and not</font><font color="#CCCCCC"> let's see even the deckle so we</font>

489
00:25:49,180 --> 00:26:00,760
can simply skip that part now this is

490
00:25:58,660 --> 00:26:02,700
this was about<font color="#CCCCCC"> the enumeration part</font>

491
00:26:00,760 --> 00:26:05,770
right we can play with<font color="#CCCCCC"> it you can have</font>

492
00:26:02,700 --> 00:26:07,750
<font color="#E5E5E5">groups or use I think</font><font color="#CCCCCC"> I have missed the</font>

493
00:26:05,770 --> 00:26:09,490
<font color="#CCCCCC">only part here</font><font color="#E5E5E5"> or it's right here you</font>

494
00:26:07,750 --> 00:26:09,850
can different organizational units as

495
00:26:09,490 --> 00:26:12,130
well

496
00:26:09,850 --> 00:26:15,459
you can<font color="#E5E5E5"> fairly create an organizational</font>

497
00:26:12,130 --> 00:26:17,950
unit<font color="#E5E5E5"> which has some users</font><font color="#CCCCCC"> you can create</font>

498
00:26:15,460 --> 00:26:19,930
groups which have multiple<font color="#E5E5E5"> users and the</font>

499
00:26:17,950 --> 00:26:22,840
level of<font color="#CCCCCC"> logging you have for each</font>

500
00:26:19,930 --> 00:26:26,590
object can be<font color="#E5E5E5"> decided right</font><font color="#CCCCCC"> you have</font>

501
00:26:22,840 --> 00:26:28,600
remember let's say you have a portable

502
00:26:26,590 --> 00:26:30,490
<font color="#CCCCCC">62 when</font><font color="#E5E5E5"> the group membership is</font><font color="#CCCCCC"> read</font>

503
00:26:28,600 --> 00:26:32,770
then out<font color="#CCCCCC"> of four group members we</font><font color="#E5E5E5"> have</font>

504
00:26:30,490 --> 00:26:36,880
been logging<font color="#CCCCCC"> in able on just one</font><font color="#E5E5E5"> of them</font>

505
00:26:32,770 --> 00:26:39,639
when<font color="#CCCCCC"> deckle is read</font><font color="#E5E5E5"> so that</font><font color="#CCCCCC"> can be</font><font color="#E5E5E5"> used</font>

506
00:26:36,880 --> 00:26:41,710
to device a quite<font color="#E5E5E5"> interesting strategy</font>

507
00:26:39,640 --> 00:26:44,950
for detecting a new<font color="#CCCCCC"> mission based</font>

508
00:26:41,710 --> 00:26:46,810
attacks but we<font color="#CCCCCC"> are not limited to</font>

509
00:26:44,950 --> 00:26:48,610
enumeration of course if you want we can

510
00:26:46,810 --> 00:26:52,570
<font color="#E5E5E5">once again without any additional tools</font>

511
00:26:48,610 --> 00:26:56,290
<font color="#CCCCCC">etc we can</font><font color="#E5E5E5"> have we can detect little</font>

512
00:26:52,570 --> 00:26:58,000
movement as well<font color="#E5E5E5"> so for example what an</font>

513
00:26:56,290 --> 00:27:01,659
attacker would be interested in once

514
00:26:58,000 --> 00:27:03,070
they escalated<font color="#E5E5E5"> their privileges in the</font>

515
00:27:01,660 --> 00:27:06,520
domain or<font color="#E5E5E5"> they want to escalate their</font>

516
00:27:03,070 --> 00:27:09,010
privileges<font color="#E5E5E5"> we can actually have users to</font>

517
00:27:06,520 --> 00:27:12,190
be part of domain admins group<font color="#E5E5E5"> actual</font>

518
00:27:09,010 --> 00:27:16,350
users and then we can set or restrict

519
00:27:12,190 --> 00:27:19,660
their<font color="#CCCCCC"> logon to a non-existent machine</font>

520
00:27:16,350 --> 00:27:22,780
right or just the domain controller<font color="#E5E5E5"> so</font>

521
00:27:19,660 --> 00:27:24,790
what happens when<font color="#E5E5E5"> we do this now this</font>

522
00:27:22,780 --> 00:27:26,950
means that<font color="#CCCCCC"> even</font><font color="#E5E5E5"> if one</font><font color="#CCCCCC"> of your domain</font>

523
00:27:24,790 --> 00:27:29,230
admins your<font color="#CCCCCC"> Decker domain admins</font><font color="#E5E5E5"> get</font>

524
00:27:26,950 --> 00:27:31,990
owned<font color="#CCCCCC"> or</font><font color="#E5E5E5"> its password gets leaked or</font>

525
00:27:29,230 --> 00:27:35,120
somehow<font color="#E5E5E5"> the credentials are stolen that</font>

526
00:27:31,990 --> 00:27:37,040
user cannot still be abused

527
00:27:35,120 --> 00:27:39,199
on any<font color="#E5E5E5"> of the</font><font color="#CCCCCC"> machines in</font><font color="#E5E5E5"> your network</font>

528
00:27:37,040 --> 00:27:41,690
<font color="#E5E5E5">and you will and as soon as someone</font>

529
00:27:39,200 --> 00:27:45,620
wants to try<font color="#CCCCCC"> that or use that you will</font>

530
00:27:41,690 --> 00:27:49,100
<font color="#E5E5E5">have</font><font color="#CCCCCC"> a log</font><font color="#E5E5E5"> right so</font><font color="#CCCCCC"> over two ways</font><font color="#E5E5E5"> right</font>

531
00:27:45,620 --> 00:27:51,050
<font color="#E5E5E5">now which I can think of is one we</font>

532
00:27:49,100 --> 00:27:53,389
restrict the<font color="#E5E5E5"> log on second we deny the</font>

533
00:27:51,050 --> 00:27:55,240
log on to the user at all<font color="#E5E5E5"> so when</font>

534
00:27:53,390 --> 00:27:57,680
someone enumerated the user would

535
00:27:55,240 --> 00:27:59,720
<font color="#E5E5E5">genuinely appear to be a part of the</font>

536
00:27:57,680 --> 00:28:03,980
<font color="#CCCCCC">domain admins group</font><font color="#E5E5E5"> but when they try to</font>

537
00:27:59,720 --> 00:28:07,640
use<font color="#CCCCCC"> it they cannot log on this needs a</font>

538
00:28:03,980 --> 00:28:10,300
<font color="#CCCCCC">bit of different logging enabled so let</font>

539
00:28:07,640 --> 00:28:10,300
me show<font color="#E5E5E5"> you</font><font color="#CCCCCC"> that as well</font>

540
00:28:15,080 --> 00:28:24,580
<font color="#E5E5E5">okay not this one so here we are</font>

541
00:28:20,509 --> 00:28:27,080
creating<font color="#CCCCCC"> a decoy user called the</font><font color="#E5E5E5"> deck da</font>

542
00:28:24,580 --> 00:28:37,610
which would be part of the<font color="#E5E5E5"> domain admins</font>

543
00:28:27,080 --> 00:28:41,739
<font color="#CCCCCC">crop and we had denying</font><font color="#E5E5E5"> log</font><font color="#CCCCCC"> onto that</font>

544
00:28:37,610 --> 00:28:41,738
user here right

545
00:28:47,590 --> 00:28:52,689
no portable<font color="#CCCCCC"> six to right now for this of</font>

546
00:28:50,480 --> 00:28:52,690
<font color="#CCCCCC">course</font>

547
00:28:57,890 --> 00:29:04,049
now we just<font color="#CCCCCC"> make</font><font color="#E5E5E5"> sure</font><font color="#CCCCCC"> that if someone</font><font color="#E5E5E5"> is</font>

548
00:29:01,070 --> 00:29:08,010
enumerated the domain admins group<font color="#E5E5E5"> is</font>

549
00:29:04,049 --> 00:29:12,230
our DAC<font color="#E5E5E5"> da user actually</font><font color="#CCCCCC"> a part of</font><font color="#E5E5E5"> the</font>

550
00:29:08,010 --> 00:29:12,230
domain<font color="#E5E5E5"> admin membership group membership</font>

551
00:29:13,340 --> 00:29:19,500
so here you<font color="#E5E5E5"> can see the user is now an</font>

552
00:29:17,160 --> 00:29:23,160
actual<font color="#E5E5E5"> domain admin but we have</font>

553
00:29:19,500 --> 00:29:25,350
restricted<font color="#E5E5E5"> its logins we are not</font>

554
00:29:23,160 --> 00:29:28,039
<font color="#E5E5E5">allowing it with denying logon to that</font>

555
00:29:25,350 --> 00:29:28,039
particular user

556
00:29:33,360 --> 00:29:37,540
so let's<font color="#E5E5E5"> see if the users credentials</font>

557
00:29:35,620 --> 00:29:40,330
get compromised in<font color="#E5E5E5"> clear-text</font>

558
00:29:37,540 --> 00:29:41,920
and someone would like<font color="#E5E5E5"> to</font><font color="#CCCCCC"> login</font><font color="#E5E5E5"> using</font>

559
00:29:40,330 --> 00:29:44,699
the<font color="#E5E5E5"> credentials of that particular</font>

560
00:29:41,920 --> 00:29:48,700
domain admin<font color="#E5E5E5"> it would not be possible</font>

561
00:29:44,700 --> 00:29:52,300
<font color="#CCCCCC">right because</font><font color="#E5E5E5"> we have</font><font color="#CCCCCC"> the logon denied</font>

562
00:29:48,700 --> 00:29:55,240
to that particular user<font color="#CCCCCC"> and here we will</font>

563
00:29:52,300 --> 00:29:57,340
have a<font color="#CCCCCC"> four seven six eight</font><font color="#E5E5E5"> which</font>

564
00:29:55,240 --> 00:30:00,040
clearly shows the<font color="#CCCCCC"> IP address etc and the</font>

565
00:29:57,340 --> 00:30:01,810
user which someone wanted<font color="#CCCCCC"> to abuse right</font>

566
00:30:00,040 --> 00:30:04,780
<font color="#E5E5E5">and this of course does</font><font color="#CCCCCC"> not work only</font>

567
00:30:01,810 --> 00:30:08,379
<font color="#E5E5E5">for the clear text credentials this is</font>

568
00:30:04,780 --> 00:30:12,280
useful<font color="#CCCCCC"> for your regular over</font><font color="#E5E5E5"> pasta hash</font>

569
00:30:08,380 --> 00:30:14,500
or whatsoever<font color="#E5E5E5"> attack if you use this in</font>

570
00:30:12,280 --> 00:30:15,879
any attack which needs<font color="#E5E5E5"> communication</font>

571
00:30:14,500 --> 00:30:18,400
with the<font color="#E5E5E5"> DC which means all of the</font>

572
00:30:15,880 --> 00:30:26,170
<font color="#E5E5E5">authentication based attacks then it</font>

573
00:30:18,400 --> 00:30:28,170
will<font color="#E5E5E5"> not work this is</font><font color="#CCCCCC"> an example</font><font color="#E5E5E5"> of me</font>

574
00:30:26,170 --> 00:30:31,390
if we set the log<font color="#E5E5E5"> on to a non-existent</font>

575
00:30:28,170 --> 00:30:33,910
<font color="#E5E5E5">workstation right so here you can see</font>

576
00:30:31,390 --> 00:30:36,010
the<font color="#CCCCCC"> logon workstation for that</font>

577
00:30:33,910 --> 00:30:39,040
particular user we are<font color="#E5E5E5"> recreating the</font>

578
00:30:36,010 --> 00:30:41,710
<font color="#E5E5E5">dag</font><font color="#CCCCCC"> da</font><font color="#E5E5E5"> that's non-existent</font><font color="#CCCCCC"> there is no</font>

579
00:30:39,040 --> 00:30:45,360
such machine here in the<font color="#CCCCCC"> target</font><font color="#E5E5E5"> domain</font>

580
00:30:41,710 --> 00:30:45,360
<font color="#E5E5E5">so once we create that</font>

581
00:30:48,410 --> 00:30:56,540
we go to the attacker machine<font color="#E5E5E5"> try try</font>

582
00:30:53,970 --> 00:30:58,799
the same<font color="#CCCCCC"> thing which we saw and the</font>

583
00:30:56,540 --> 00:31:00,540
message or<font color="#E5E5E5"> the error would exactly be</font>

584
00:30:58,799 --> 00:31:11,040
<font color="#E5E5E5">the same and we</font><font color="#CCCCCC"> will have a four seven</font>

585
00:31:00,540 --> 00:31:12,960
six<font color="#CCCCCC"> eight in the logs write an audit</font>

586
00:31:11,040 --> 00:31:15,450
failure for sound<font color="#E5E5E5"> six eight it's right</font>

587
00:31:12,960 --> 00:31:17,190
there quite detectable<font color="#E5E5E5"> now if you would</font>

588
00:31:15,450 --> 00:31:21,090
<font color="#E5E5E5">like to use anything like let's say over</font>

589
00:31:17,190 --> 00:31:23,400
pass the hash from<font color="#E5E5E5"> mimic</font><font color="#CCCCCC"> ads so that's</font>

590
00:31:21,090 --> 00:31:26,639
the ntlm hash of the of the<font color="#CCCCCC"> DAC deer</font>

591
00:31:23,400 --> 00:31:31,890
which we just<font color="#E5E5E5"> used which we are just</font>

592
00:31:26,640 --> 00:31:34,020
going to use in case<font color="#CCCCCC"> of tools like</font>

593
00:31:31,890 --> 00:31:36,030
mimikatz you won't even get<font color="#CCCCCC"> that there</font>

594
00:31:34,020 --> 00:31:38,160
is a<font color="#E5E5E5"> logon description that is if the</font>

595
00:31:36,030 --> 00:31:40,080
hash gets leaked not<font color="#CCCCCC"> dakhil clear text</font>

596
00:31:38,160 --> 00:31:42,090
credential<font color="#E5E5E5"> in such a case you wouldn't</font>

597
00:31:40,080 --> 00:31:44,580
want even get a message it would simply

598
00:31:42,090 --> 00:31:52,199
be an access denied<font color="#CCCCCC"> which makes it more</font>

599
00:31:44,580 --> 00:31:54,210
interesting<font color="#E5E5E5"> for you so this process</font>

600
00:31:52,200 --> 00:31:55,799
<font color="#E5E5E5">which opens up this PowerShell console</font>

601
00:31:54,210 --> 00:31:58,440
it<font color="#CCCCCC"> is supposedly</font><font color="#E5E5E5"> running with the</font>

602
00:31:55,799 --> 00:32:01,110
privileges of<font color="#CCCCCC"> dag da</font><font color="#E5E5E5"> but unless you try</font>

603
00:31:58,440 --> 00:32:03,570
<font color="#E5E5E5">to access a resource the privileges are</font>

604
00:32:01,110 --> 00:32:06,479
not assigned<font color="#E5E5E5"> to this particular process</font>

605
00:32:03,570 --> 00:32:08,970
or<font color="#E5E5E5"> the to that particular session now if</font>

606
00:32:06,480 --> 00:32:11,010
we go and have<font color="#E5E5E5"> a look at the logs here</font>

607
00:32:08,970 --> 00:32:14,190
<font color="#E5E5E5">there is another four seven six eight</font>

608
00:32:11,010 --> 00:32:16,110
here<font color="#CCCCCC"> foredeck ta from</font><font color="#E5E5E5"> the target machine</font>

609
00:32:14,190 --> 00:32:23,460
<font color="#E5E5E5">zero cross one from the attackers</font>

610
00:32:16,110 --> 00:32:26,070
machine 0.13 right so and<font color="#E5E5E5"> that was that</font>

611
00:32:23,460 --> 00:32:29,190
is how we can use<font color="#E5E5E5"> high</font><font color="#CCCCCC"> privilege users</font>

612
00:32:26,070 --> 00:32:31,409
right this is in my<font color="#CCCCCC"> opinion there could</font>

613
00:32:29,190 --> 00:32:33,660
be<font color="#E5E5E5"> ways around and that's that's where</font>

614
00:32:31,410 --> 00:32:36,120
the community<font color="#CCCCCC"> input</font><font color="#E5E5E5"> is required in my</font>

615
00:32:33,660 --> 00:32:39,090
testing there<font color="#CCCCCC"> is no way around tools to</font>

616
00:32:36,120 --> 00:32:42,389
bypass this restriction<font color="#E5E5E5"> of denying logon</font>

617
00:32:39,090 --> 00:32:44,820
or having a restricted<font color="#E5E5E5"> workstation right</font>

618
00:32:42,390 --> 00:32:47,000
which makes it<font color="#E5E5E5"> quite interesting</font><font color="#CCCCCC"> and</font>

619
00:32:44,820 --> 00:32:47,000
useful

620
00:32:48,720 --> 00:32:54,910
<font color="#E5E5E5">okay now another very interesting</font>

621
00:32:52,620 --> 00:32:57,790
<font color="#E5E5E5">opportunity or technique is to have a</font>

622
00:32:54,910 --> 00:32:59,260
master and slave user<font color="#E5E5E5"> that is something</font>

623
00:32:57,790 --> 00:33:01,450
which attackers are generally<font color="#CCCCCC"> also</font>

624
00:32:59,260 --> 00:33:04,840
interested in<font color="#E5E5E5"> right having a look at</font>

625
00:33:01,450 --> 00:33:08,010
<font color="#E5E5E5">those users which have permissions over</font>

626
00:33:04,840 --> 00:33:10,120
any<font color="#CCCCCC"> other user you can enumerate this</font>

627
00:33:08,010 --> 00:33:12,280
information without having<font color="#CCCCCC"> any special</font>

628
00:33:10,120 --> 00:33:14,379
<font color="#CCCCCC">privileges in the environment</font><font color="#E5E5E5"> and then</font>

629
00:33:12,280 --> 00:33:16,780
once you have acquired<font color="#E5E5E5"> that particular</font>

630
00:33:14,380 --> 00:33:20,740
<font color="#E5E5E5">knowledge you</font><font color="#CCCCCC"> will like to</font><font color="#E5E5E5"> go</font><font color="#CCCCCC"> after a</font>

631
00:33:16,780 --> 00:33:22,629
user which has escalated or good

632
00:33:20,740 --> 00:33:26,920
privileges or full control permissions

633
00:33:22,630 --> 00:33:30,910
<font color="#E5E5E5">like that on another user now how can we</font>

634
00:33:26,920 --> 00:33:32,890
<font color="#E5E5E5">do that there are different techniques</font>

635
00:33:30,910 --> 00:33:36,310
<font color="#E5E5E5">of employing this particular thing we</font>

636
00:33:32,890 --> 00:33:39,280
can<font color="#E5E5E5"> create a new slave and master pair</font>

637
00:33:36,310 --> 00:33:40,990
both<font color="#E5E5E5"> of them being decoy users both of</font>

638
00:33:39,280 --> 00:33:45,370
them aggressively logging any

639
00:33:40,990 --> 00:33:47,440
enumeration<font color="#CCCCCC"> or we can create an existing</font>

640
00:33:45,370 --> 00:33:51,239
user<font color="#E5E5E5"> we</font><font color="#CCCCCC"> can we can make</font><font color="#E5E5E5"> an existing user</font>

641
00:33:47,440 --> 00:33:57,220
part of a master<font color="#E5E5E5"> of a new slave user</font>

642
00:33:51,240 --> 00:33:59,410
right<font color="#E5E5E5"> we can also assign an SP n2o to a</font>

643
00:33:57,220 --> 00:34:00,820
new slave user<font color="#CCCCCC"> whatever we want</font><font color="#E5E5E5"> there</font>

644
00:33:59,410 --> 00:34:02,770
<font color="#E5E5E5">are different options which we can use</font>

645
00:34:00,820 --> 00:34:08,049
<font color="#E5E5E5">right</font><font color="#CCCCCC"> so what we are</font><font color="#E5E5E5"> doing right now</font>

646
00:34:02,770 --> 00:34:12,219
<font color="#E5E5E5">here is we create a user called master</font>

647
00:34:08,050 --> 00:34:14,380
and a user called slave then<font color="#E5E5E5"> then in the</font>

648
00:34:12,219 --> 00:34:18,819
third command<font color="#E5E5E5"> the master user is</font>

649
00:34:14,380 --> 00:34:20,740
<font color="#E5E5E5">provided full control now in the second</font>

650
00:34:18,820 --> 00:34:22,750
command sorry<font color="#CCCCCC"> master is provided full</font>

651
00:34:20,739 --> 00:34:26,908
control<font color="#CCCCCC"> over</font><font color="#E5E5E5"> the slave user and then the</font>

652
00:34:22,750 --> 00:34:29,620
third one we turn on the logging<font color="#CCCCCC"> this is</font>

653
00:34:26,909 --> 00:34:31,899
you may like to<font color="#E5E5E5"> notice that the</font><font color="#CCCCCC"> write</font>

654
00:34:29,620 --> 00:34:34,630
which we are<font color="#E5E5E5"> looking for is</font><font color="#CCCCCC"> right deckle</font>

655
00:34:31,899 --> 00:34:37,299
<font color="#E5E5E5">that is if the master uses its</font>

656
00:34:34,630 --> 00:34:40,120
privileges to make any changes to<font color="#E5E5E5"> the</font>

657
00:34:37,300 --> 00:34:43,060
ACL of the slave<font color="#E5E5E5"> right no enumeration</font>

658
00:34:40,120 --> 00:34:46,989
would trigger that<font color="#E5E5E5"> just when any changes</font>

659
00:34:43,060 --> 00:34:49,620
are made<font color="#E5E5E5"> to</font><font color="#CCCCCC"> the slave user so we</font><font color="#E5E5E5"> let's</font>

660
00:34:46,989 --> 00:34:49,620
have a look at this

661
00:34:52,119 --> 00:35:02,359
so we create a user called<font color="#E5E5E5"> slave user</font>

662
00:34:58,990 --> 00:35:04,750
quite medieval terminology<font color="#E5E5E5"> but that</font>

663
00:35:02,359 --> 00:35:04,750
works

664
00:35:11,810 --> 00:35:23,790
so that's our<font color="#E5E5E5"> slave user and here we are</font>

665
00:35:19,620 --> 00:35:26,009
<font color="#E5E5E5">and creating on the deck I for an</font>

666
00:35:23,790 --> 00:35:28,860
existing<font color="#E5E5E5"> user called user</font><font color="#CCCCCC"> one that is we</font>

667
00:35:26,010 --> 00:35:30,840
<font color="#CCCCCC">are providing full</font><font color="#E5E5E5"> more permission</font><font color="#CCCCCC"> we</font>

668
00:35:28,860 --> 00:35:34,700
are creating a deck<font color="#CCCCCC"> white that whenever</font>

669
00:35:30,840 --> 00:35:38,280
user one modifies<font color="#CCCCCC"> a CL of the slave user</font>

670
00:35:34,700 --> 00:35:45,629
and we get an alert<font color="#CCCCCC"> that's</font><font color="#E5E5E5"> what we are</font>

671
00:35:38,280 --> 00:35:47,280
<font color="#E5E5E5">doing here let's try this so this does</font>

672
00:35:45,630 --> 00:35:49,290
not<font color="#E5E5E5"> get triggered on any type of</font>

673
00:35:47,280 --> 00:35:54,030
enumeration<font color="#E5E5E5"> only when let's say you</font>

674
00:35:49,290 --> 00:35:56,160
modify the deckle of the slave<font color="#E5E5E5"> we are</font>

675
00:35:54,030 --> 00:35:59,130
<font color="#E5E5E5">adding a new</font><font color="#CCCCCC"> user with full rights</font><font color="#E5E5E5"> on</font>

676
00:35:56,160 --> 00:36:07,259
slave users<font color="#CCCCCC"> so now we</font><font color="#E5E5E5"> should have an</font>

677
00:35:59,130 --> 00:36:10,320
alert hey there that user<font color="#CCCCCC"> one has</font>

678
00:36:07,260 --> 00:36:13,170
modified the deckle see there right

679
00:36:10,320 --> 00:36:15,410
there<font color="#CCCCCC"> right BAC</font><font color="#E5E5E5"> that's what right</font><font color="#CCCCCC"> deckle</font>

680
00:36:13,170 --> 00:36:15,410
is

681
00:36:18,370 --> 00:36:28,450
right now<font color="#E5E5E5"> we can also create when when</font>

682
00:36:26,440 --> 00:36:31,090
it comes to something<font color="#E5E5E5"> I think there's</font>

683
00:36:28,450 --> 00:36:32,919
<font color="#E5E5E5">not on the in the video for our high</font>

684
00:36:31,090 --> 00:36:34,930
project privileged rights like let's say

685
00:36:32,920 --> 00:36:39,900
DC<font color="#CCCCCC"> sync rights as</font><font color="#E5E5E5"> well that</font><font color="#CCCCCC"> that is also</font>

686
00:36:34,930 --> 00:36:43,330
what<font color="#E5E5E5"> the tool has right</font><font color="#CCCCCC"> now</font><font color="#E5E5E5"> we can also</font>

687
00:36:39,900 --> 00:36:44,920
specify<font color="#E5E5E5"> as I said existing users of for</font>

688
00:36:43,330 --> 00:36:47,319
<font color="#CCCCCC">example</font><font color="#E5E5E5"> when I was testing</font><font color="#CCCCCC"> the</font>

689
00:36:44,920 --> 00:36:50,650
enterprise offerings for for Active

690
00:36:47,320 --> 00:36:53,020
Directory<font color="#CCCCCC"> Deception many of them allow</font>

691
00:36:50,650 --> 00:36:56,350
you to create a honey user or a decoy

692
00:36:53,020 --> 00:36:57,759
user which you can track whose use you

693
00:36:56,350 --> 00:37:00,279
can try quite<font color="#E5E5E5"> similar to what we</font><font color="#CCCCCC"> are</font>

694
00:36:57,760 --> 00:37:02,950
doing here<font color="#CCCCCC"> so we can include that as</font>

695
00:37:00,280 --> 00:37:04,750
well<font color="#CCCCCC"> right here for your decoy user you</font>

696
00:37:02,950 --> 00:37:07,720
can set that particular user as a

697
00:37:04,750 --> 00:37:09,670
<font color="#E5E5E5">principal if someone uses</font><font color="#CCCCCC"> that</font>

698
00:37:07,720 --> 00:37:12,330
particular user to let's say enumerate

699
00:37:09,670 --> 00:37:19,270
your environment or access<font color="#CCCCCC"> any other</font>

700
00:37:12,330 --> 00:37:22,240
user we can<font color="#E5E5E5"> have a log here right next</font>

701
00:37:19,270 --> 00:37:25,060
<font color="#CCCCCC">is when we talk about</font><font color="#E5E5E5"> trusts in Active</font>

702
00:37:22,240 --> 00:37:27,520
Directory<font color="#CCCCCC"> we</font><font color="#E5E5E5"> we have seen what the</font>

703
00:37:25,060 --> 00:37:28,270
domain trusts between users computers

704
00:37:27,520 --> 00:37:30,960
groups

705
00:37:28,270 --> 00:37:33,340
now then<font color="#CCCCCC"> forest comes as well</font>

706
00:37:30,960 --> 00:37:36,250
unfortunately<font color="#CCCCCC"> I could not find out a way</font>

707
00:37:33,340 --> 00:37:38,830
<font color="#CCCCCC">to</font><font color="#E5E5E5"> automate this right so right now what</font>

708
00:37:36,250 --> 00:37:42,370
we have is<font color="#CCCCCC"> you have</font><font color="#E5E5E5"> to have</font><font color="#CCCCCC"> a real</font>

709
00:37:38,830 --> 00:37:44,170
<font color="#CCCCCC">machine</font><font color="#E5E5E5"> as a forest when it comes to far</font>

710
00:37:42,370 --> 00:37:46,390
as there are so<font color="#E5E5E5"> many opportunities which</font>

711
00:37:44,170 --> 00:37:50,050
you can have because<font color="#CCCCCC"> the</font><font color="#E5E5E5"> Trust's between</font>

712
00:37:46,390 --> 00:37:52,779
forests<font color="#E5E5E5"> could be really segregated for</font>

713
00:37:50,050 --> 00:37:55,770
example what we can have is a<font color="#CCCCCC"> deco</font>

714
00:37:52,780 --> 00:37:58,030
<font color="#E5E5E5">forest which is full of users computers</font>

715
00:37:55,770 --> 00:37:59,710
probably some of them the choir wants

716
00:37:58,030 --> 00:38:03,550
all the real ones that depends<font color="#E5E5E5"> on your</font>

717
00:37:59,710 --> 00:38:05,440
deployment technique now you use

718
00:38:03,550 --> 00:38:08,830
selective authentication<font color="#CCCCCC"> between your</font>

719
00:38:05,440 --> 00:38:11,200
current forest and the decoy forest<font color="#E5E5E5"> you</font>

720
00:38:08,830 --> 00:38:14,799
allow enumeration of users and computers

721
00:38:11,200 --> 00:38:17,859
on that particular forest but no access

722
00:38:14,800 --> 00:38:21,220
<font color="#CCCCCC">to any</font><font color="#E5E5E5"> other machine at all right so</font>

723
00:38:17,860 --> 00:38:23,770
<font color="#CCCCCC">that is what that is how we can</font><font color="#E5E5E5"> use a</font>

724
00:38:21,220 --> 00:38:26,080
forest<font color="#E5E5E5"> as a decoy here there is a</font>

725
00:38:23,770 --> 00:38:28,840
bi-directional trust you have you can

726
00:38:26,080 --> 00:38:30,080
<font color="#E5E5E5">see everything in</font><font color="#CCCCCC"> the in the decoy</font>

727
00:38:28,840 --> 00:38:32,300
<font color="#E5E5E5">forest all the users</font>

728
00:38:30,080 --> 00:38:34,600
all the domain<font color="#CCCCCC"> controllers</font><font color="#E5E5E5"> all the</font>

729
00:38:32,300 --> 00:38:38,930
computers<font color="#CCCCCC"> lie just like a</font><font color="#E5E5E5"> normal forest</font>

730
00:38:34,600 --> 00:38:40,279
but you cannot<font color="#CCCCCC"> access any resource as</font>

731
00:38:38,930 --> 00:38:44,120
soon as you try to<font color="#CCCCCC"> access a resource</font>

732
00:38:40,280 --> 00:38:45,350
there would be log now and how do we

733
00:38:44,120 --> 00:38:47,540
<font color="#CCCCCC">achieve that using selective</font>

734
00:38:45,350 --> 00:38:50,810
authentication<font color="#E5E5E5"> once again right not that</font>

735
00:38:47,540 --> 00:38:55,910
<font color="#E5E5E5">isn't I could not automate it so</font><font color="#CCCCCC"> that</font>

736
00:38:50,810 --> 00:39:00,950
needs a bit<font color="#CCCCCC"> of setup so if</font><font color="#E5E5E5"> I run this</font>

737
00:38:55,910 --> 00:39:04,879
now so we run this<font color="#E5E5E5"> from our current</font>

738
00:39:00,950 --> 00:39:06,350
forest<font color="#E5E5E5"> to check if there</font><font color="#CCCCCC"> is an existing</font>

739
00:39:04,880 --> 00:39:08,270
<font color="#CCCCCC">trust</font><font color="#E5E5E5"> we find out that there is</font><font color="#CCCCCC"> a</font>

740
00:39:06,350 --> 00:39:16,759
trusted bi-directional trust forest

741
00:39:08,270 --> 00:39:19,910
called<font color="#CCCCCC"> rat</font><font color="#E5E5E5"> dot local we check if we</font><font color="#CCCCCC"> can</font>

742
00:39:16,760 --> 00:39:24,350
enumerate users in web dot local<font color="#CCCCCC"> of</font>

743
00:39:19,910 --> 00:39:29,140
course we can then we check<font color="#E5E5E5"> if we</font><font color="#CCCCCC"> can</font>

744
00:39:24,350 --> 00:39:29,140
enumerate computers on on web dot local

745
00:39:37,570 --> 00:39:42,700
so just two computers for now<font color="#E5E5E5"> so</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> found</font>

746
00:39:40,990 --> 00:39:49,060
out<font color="#E5E5E5"> that there</font><font color="#CCCCCC"> is the DC and another</font>

747
00:39:42,700 --> 00:39:50,560
machine here called<font color="#CCCCCC"> wrap desktop now</font>

748
00:39:49,060 --> 00:39:53,320
let's say we would<font color="#CCCCCC"> like to</font><font color="#E5E5E5"> access</font>

749
00:39:50,560 --> 00:39:55,720
resources or check resources so the

750
00:39:53,320 --> 00:39:57,640
example<font color="#E5E5E5"> is quite simple simply want to</font>

751
00:39:55,720 --> 00:40:06,220
see if we<font color="#CCCCCC"> can browse search on</font><font color="#E5E5E5"> that</font>

752
00:39:57,640 --> 00:40:07,960
particular machine so of course not<font color="#E5E5E5"> so</font>

753
00:40:06,220 --> 00:40:10,959
we can extract all<font color="#E5E5E5"> of the information</font>

754
00:40:07,960 --> 00:40:13,780
<font color="#E5E5E5">get fantastically logged but still</font>

755
00:40:10,960 --> 00:40:16,030
cannot access any resource there right

756
00:40:13,780 --> 00:40:24,130
<font color="#CCCCCC">so that's that's how</font><font color="#E5E5E5"> it works when it</font>

757
00:40:16,030 --> 00:40:26,380
comes to<font color="#CCCCCC"> Forrest's trusts right so that</font>

758
00:40:24,130 --> 00:40:30,390
was some of<font color="#CCCCCC"> the use cases of how we can</font>

759
00:40:26,380 --> 00:40:33,490
deploy<font color="#CCCCCC"> Deception using open source now</font>

760
00:40:30,390 --> 00:40:38,350
how do<font color="#E5E5E5"> red teamers identify</font><font color="#CCCCCC"> deception</font>

761
00:40:33,490 --> 00:40:39,879
right<font color="#E5E5E5"> once again having evaluated many</font>

762
00:40:38,350 --> 00:40:42,190
of the enterprise solutions there<font color="#CCCCCC"> are</font>

763
00:40:39,880 --> 00:40:46,140
some of the things<font color="#E5E5E5"> which stand out when</font>

764
00:40:42,190 --> 00:40:49,570
you see<font color="#E5E5E5"> deception for the first time</font>

765
00:40:46,140 --> 00:40:52,120
<font color="#E5E5E5">right for example</font><font color="#CCCCCC"> these are some of the</font>

766
00:40:49,570 --> 00:40:57,490
<font color="#E5E5E5">properties for a user</font><font color="#CCCCCC"> object for example</font>

767
00:40:52,120 --> 00:41:04,810
<font color="#CCCCCC">object said that's a</font><font color="#E5E5E5"> property which if I</font>

768
00:40:57,490 --> 00:41:06,459
could show<font color="#E5E5E5"> you that no no I cannot so</font>

769
00:41:04,810 --> 00:41:09,940
there<font color="#CCCCCC"> are properties like</font><font color="#E5E5E5"> object said</font>

770
00:41:06,460 --> 00:41:13,390
last logon last<font color="#CCCCCC"> logon</font><font color="#E5E5E5"> timestamp these</font>

771
00:41:09,940 --> 00:41:15,810
are for the users<font color="#E5E5E5"> logon count when the</font>

772
00:41:13,390 --> 00:41:21,240
user was<font color="#E5E5E5"> created bad password count</font>

773
00:41:15,810 --> 00:41:21,240
<font color="#E5E5E5">these can be used to spot a particular</font>

774
00:41:21,300 --> 00:41:27,640
decoy for example what's object said

775
00:41:24,160 --> 00:41:30,549
every object in a domain has its own

776
00:41:27,640 --> 00:41:34,839
<font color="#E5E5E5">security identifier which is the domain</font>

777
00:41:30,550 --> 00:41:37,330
<font color="#E5E5E5">said - rid of the object they</font><font color="#CCCCCC"> are many</font>

778
00:41:34,840 --> 00:41:39,550
of<font color="#E5E5E5"> course</font><font color="#CCCCCC"> I've</font><font color="#E5E5E5"> signed NDA's while trying</font>

779
00:41:37,330 --> 00:41:43,000
<font color="#E5E5E5">this</font><font color="#CCCCCC"> stuff out so no screenshots and</font><font color="#E5E5E5"> I</font>

780
00:41:39,550 --> 00:41:46,150
cannot name that but there<font color="#E5E5E5"> are deception</font>

781
00:41:43,000 --> 00:41:48,460
solutions the best<font color="#E5E5E5"> ones which use their</font>

782
00:41:46,150 --> 00:41:51,350
own object<font color="#CCCCCC"> sales when</font><font color="#E5E5E5"> they create a</font>

783
00:41:48,460 --> 00:41:55,010
<font color="#CCCCCC">decoy object if it's not a real</font><font color="#E5E5E5"> object</font>

784
00:41:51,350 --> 00:41:58,400
they have a<font color="#CCCCCC"> mismatch with the domain set</font>

785
00:41:55,010 --> 00:42:00,200
so that<font color="#E5E5E5"> can</font><font color="#CCCCCC"> be used to</font><font color="#E5E5E5"> spot one so this</font>

786
00:41:58,400 --> 00:42:02,960
<font color="#E5E5E5">is this is</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> tip right for the red</font>

787
00:42:00,200 --> 00:42:05,540
teamers<font color="#E5E5E5"> if you find a few enumerated</font>

788
00:42:02,960 --> 00:42:05,990
environment<font color="#E5E5E5"> and it looks too good</font><font color="#CCCCCC"> to be</font>

789
00:42:05,540 --> 00:42:08,120
<font color="#CCCCCC">true</font>

790
00:42:05,990 --> 00:42:09,169
make time take some<font color="#CCCCCC"> time to enumerate</font>

791
00:42:08,120 --> 00:42:12,710
these<font color="#E5E5E5"> things as well</font>

792
00:42:09,170 --> 00:42:15,950
last log on right<font color="#E5E5E5"> if</font><font color="#CCCCCC"> anyone</font><font color="#E5E5E5"> of you</font><font color="#CCCCCC"> have</font>

793
00:42:12,710 --> 00:42:18,020
ever used<font color="#CCCCCC"> an open</font><font color="#E5E5E5"> source project</font><font color="#CCCCCC"> called</font>

794
00:42:15,950 --> 00:42:20,540
<font color="#E5E5E5">honey</font><font color="#CCCCCC"> Buster</font><font color="#E5E5E5"> right</font>

795
00:42:18,020 --> 00:42:23,300
that's what honey<font color="#CCCCCC"> buster looks for last</font>

796
00:42:20,540 --> 00:42:25,310
<font color="#CCCCCC">logon count and last logon timestamp</font><font color="#E5E5E5"> if</font>

797
00:42:23,300 --> 00:42:27,740
<font color="#CCCCCC">they use a username that</font><font color="#E5E5E5"> makes sense</font>

798
00:42:25,310 --> 00:42:31,100
if there is a user in the domain which

799
00:42:27,740 --> 00:42:35,689
has a<font color="#CCCCCC"> logon count of zero then you</font><font color="#E5E5E5"> can</font>

800
00:42:31,100 --> 00:42:38,299
with much confidence mark that as a

801
00:42:35,690 --> 00:42:40,910
honeypot or honey account<font color="#E5E5E5"> right a user</font>

802
00:42:38,300 --> 00:42:43,400
without<font color="#E5E5E5"> a logon does not sound good</font><font color="#CCCCCC"> or</font>

803
00:42:40,910 --> 00:42:45,440
<font color="#CCCCCC">use it without a bad password count</font><font color="#E5E5E5"> does</font>

804
00:42:43,400 --> 00:42:47,360
not sound<font color="#E5E5E5"> good as well do you think</font>

805
00:42:45,440 --> 00:42:49,370
<font color="#CCCCCC">there would</font><font color="#E5E5E5"> be any user in a domain</font>

806
00:42:47,360 --> 00:42:52,310
which would not have<font color="#E5E5E5"> at least once</font><font color="#CCCCCC"> fat</font>

807
00:42:49,370 --> 00:42:54,440
<font color="#CCCCCC">fingered their password generally not so</font>

808
00:42:52,310 --> 00:42:57,410
that's what we<font color="#CCCCCC"> are</font><font color="#E5E5E5"> looking</font><font color="#CCCCCC"> for right</font>

809
00:42:54,440 --> 00:42:59,480
users who<font color="#E5E5E5"> have never been used</font><font color="#CCCCCC"> would</font>

810
00:42:57,410 --> 00:43:01,190
definitely<font color="#E5E5E5"> stand out without a logon</font>

811
00:42:59,480 --> 00:43:06,860
count<font color="#E5E5E5"> without a last</font><font color="#CCCCCC"> login' times term</font>

812
00:43:01,190 --> 00:43:11,600
without<font color="#CCCCCC"> a bad password etc now not only</font>

813
00:43:06,860 --> 00:43:13,310
<font color="#CCCCCC">that</font><font color="#E5E5E5"> some enterprise solutions also fill</font>

814
00:43:11,600 --> 00:43:16,900
up<font color="#E5E5E5"> all the properties to avoid that</font>

815
00:43:13,310 --> 00:43:19,460
<font color="#CCCCCC">particular stuff</font><font color="#E5E5E5"> right if you look up</font>

816
00:43:16,900 --> 00:43:22,250
properties or attributes of any real

817
00:43:19,460 --> 00:43:24,020
<font color="#E5E5E5">Active Directory object there would be a</font>

818
00:43:22,250 --> 00:43:26,930
large number<font color="#CCCCCC"> of properties which not</font>

819
00:43:24,020 --> 00:43:28,730
will ever be filled right<font color="#E5E5E5"> because all</font>

820
00:43:26,930 --> 00:43:31,520
the properties<font color="#CCCCCC"> are never required</font><font color="#E5E5E5"> at the</font>

821
00:43:28,730 --> 00:43:33,800
same time<font color="#E5E5E5"> so what do you do I'm sorry</font>

822
00:43:31,520 --> 00:43:35,420
<font color="#E5E5E5">what the vendors did was to start</font>

823
00:43:33,800 --> 00:43:36,800
filling up all the<font color="#E5E5E5"> things</font><font color="#CCCCCC"> I reported</font><font color="#E5E5E5"> a</font>

824
00:43:35,420 --> 00:43:38,720
<font color="#E5E5E5">couple of things to some vendors and</font>

825
00:43:36,800 --> 00:43:42,140
that's the<font color="#CCCCCC"> solution at least couple of</font>

826
00:43:38,720 --> 00:43:44,270
them came<font color="#CCCCCC"> up with Philip stuff with</font>

827
00:43:42,140 --> 00:43:45,770
whatever<font color="#E5E5E5"> properties were all the</font>

828
00:43:44,270 --> 00:43:49,100
<font color="#E5E5E5">properties</font><font color="#CCCCCC"> with whatever</font><font color="#E5E5E5"> information</font>

829
00:43:45,770 --> 00:43:51,740
<font color="#E5E5E5">they can think of some of them tried to</font>

830
00:43:49,100 --> 00:43:54,920
<font color="#CCCCCC">read information</font><font color="#E5E5E5"> from actual objects and</font>

831
00:43:51,740 --> 00:43:57,589
fill<font color="#CCCCCC"> that up in the decoy objects which</font>

832
00:43:54,920 --> 00:43:59,810
sounds good<font color="#E5E5E5"> but was not really practical</font>

833
00:43:57,590 --> 00:44:01,370
<font color="#E5E5E5">because</font><font color="#CCCCCC"> it was taking a lot of</font><font color="#E5E5E5"> time and</font>

834
00:43:59,810 --> 00:44:03,580
there were three dogs being left in the

835
00:44:01,370 --> 00:44:07,819
<font color="#E5E5E5">Active Directory environment</font>

836
00:44:03,580 --> 00:44:10,100
now how do you<font color="#E5E5E5"> compare I see here to</font>

837
00:44:07,820 --> 00:44:13,100
compare<font color="#CCCCCC"> in the last one compared with</font>

838
00:44:10,100 --> 00:44:15,860
the known actual objects now<font color="#E5E5E5"> imagine</font>

839
00:44:13,100 --> 00:44:17,660
that<font color="#E5E5E5"> you have your red teamer you are</font>

840
00:44:15,860 --> 00:44:20,000
doing really good<font color="#E5E5E5"> in an environment</font>

841
00:44:17,660 --> 00:44:22,250
ready with your report and to brag<font color="#CCCCCC"> about</font>

842
00:44:20,000 --> 00:44:27,800
<font color="#E5E5E5">it the domain admin privileges you have</font>

843
00:44:22,250 --> 00:44:30,440
now how<font color="#CCCCCC"> would</font><font color="#E5E5E5"> you spot or how</font><font color="#CCCCCC"> would you</font>

844
00:44:27,800 --> 00:44:32,720
ensure that your<font color="#CCCCCC"> basic object for which</font>

845
00:44:30,440 --> 00:44:37,010
<font color="#E5E5E5">VD would</font><font color="#CCCCCC"> like to compare other objects</font>

846
00:44:32,720 --> 00:44:39,319
<font color="#E5E5E5">it's a real one</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> very useful option is</font>

847
00:44:37,010 --> 00:44:41,060
to look for the domain controller<font color="#CCCCCC"> if you</font>

848
00:44:39,320 --> 00:44:42,560
have a foothold machine or it's<font color="#E5E5E5"> in a</font>

849
00:44:41,060 --> 00:44:44,540
<font color="#CCCCCC">zoom bridge scenario that is if you are</font>

850
00:44:42,560 --> 00:44:47,779
inside the domain environment<font color="#E5E5E5"> you can</font>

851
00:44:44,540 --> 00:44:50,150
<font color="#CCCCCC">always use</font><font color="#E5E5E5"> look for the environment</font>

852
00:44:47,780 --> 00:44:51,800
variable<font color="#CCCCCC"> logon server which would always</font>

853
00:44:50,150 --> 00:44:54,650
be if you are using Active Directory

854
00:44:51,800 --> 00:44:57,110
credential would always be your domain

855
00:44:54,650 --> 00:44:58,940
<font color="#E5E5E5">controller so list the properties of a</font>

856
00:44:57,110 --> 00:45:01,310
domain controller<font color="#CCCCCC"> and then</font><font color="#E5E5E5"> match</font><font color="#CCCCCC"> it with</font>

857
00:44:58,940 --> 00:45:05,000
this<font color="#E5E5E5"> objects which you</font><font color="#CCCCCC"> think are decoy</font>

858
00:45:01,310 --> 00:45:07,240
ones right works perfectly<font color="#E5E5E5"> works</font><font color="#CCCCCC"> like a</font>

859
00:45:05,000 --> 00:45:07,240
<font color="#E5E5E5">charm</font>

860
00:45:07,510 --> 00:45:13,790
or you can also<font color="#E5E5E5"> use your own computers</font>

861
00:45:11,660 --> 00:45:17,210
properties that is also an option<font color="#CCCCCC"> all</font>

862
00:45:13,790 --> 00:45:22,220
the time<font color="#E5E5E5"> also</font><font color="#CCCCCC"> one</font><font color="#E5E5E5"> thing is if you use</font>

863
00:45:17,210 --> 00:45:24,800
<font color="#CCCCCC">WMI for enumeration</font><font color="#E5E5E5"> right if you can</font>

864
00:45:22,220 --> 00:45:28,279
figure out<font color="#E5E5E5"> the associations which</font><font color="#CCCCCC"> W my</font>

865
00:45:24,800 --> 00:45:30,890
classes have then<font color="#E5E5E5"> that is the</font><font color="#CCCCCC"> best bet</font>

866
00:45:28,280 --> 00:45:33,490
for enumeration better than LDAP better

867
00:45:30,890 --> 00:45:38,720
than<font color="#CCCCCC"> Samer</font><font color="#E5E5E5"> which is used for net dot</font><font color="#CCCCCC"> XE</font>

868
00:45:33,490 --> 00:45:42,439
minimum detection<font color="#E5E5E5"> I've tested as I said</font>

869
00:45:38,720 --> 00:45:44,600
six or seven<font color="#CCCCCC"> of</font><font color="#E5E5E5"> them seven at three of</font>

870
00:45:42,440 --> 00:45:47,900
the decoy<font color="#CCCCCC"> three of the deception</font>

871
00:45:44,600 --> 00:45:50,089
mechanisms could not take into<font color="#CCCCCC"> account a</font>

872
00:45:47,900 --> 00:45:52,150
numeration using<font color="#CCCCCC"> WMI so they would be</font>

873
00:45:50,090 --> 00:45:56,330
injecting<font color="#CCCCCC"> dacoit objects on your desktop</font>

874
00:45:52,150 --> 00:45:58,820
in your on your<font color="#E5E5E5"> own</font><font color="#CCCCCC"> machine</font><font color="#E5E5E5"> which is</font>

875
00:45:56,330 --> 00:46:02,000
part of the domain<font color="#E5E5E5"> but if you run a new</font>

876
00:45:58,820 --> 00:46:05,540
nation using<font color="#CCCCCC"> WMI</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> DECA objects simply</font>

877
00:46:02,000 --> 00:46:11,560
<font color="#E5E5E5">show fail to show</font><font color="#CCCCCC"> up right so</font><font color="#E5E5E5"> please use</font>

878
00:46:05,540 --> 00:46:11,560
<font color="#CCCCCC">WMI</font><font color="#E5E5E5"> if you want not to get caught</font>

879
00:46:11,660 --> 00:46:18,799
so how do<font color="#E5E5E5"> we avoid deception</font><font color="#CCCCCC"> you need to</font>

880
00:46:17,060 --> 00:46:22,220
change<font color="#E5E5E5"> as red teamers we need to change</font>

881
00:46:18,800 --> 00:46:25,490
our approach<font color="#E5E5E5"> to avoid detection by</font>

882
00:46:22,220 --> 00:46:27,560
at<font color="#E5E5E5"> least lame deception right please</font>

883
00:46:25,490 --> 00:46:30,439
please stop going for the lowest<font color="#CCCCCC"> hanging</font>

884
00:46:27,560 --> 00:46:32,180
fruit<font color="#E5E5E5"> right I also like to have visitors</font>

885
00:46:30,440 --> 00:46:35,240
comment on my blog<font color="#CCCCCC"> post</font><font color="#E5E5E5"> that you are</font>

886
00:46:32,180 --> 00:46:37,669
<font color="#E5E5E5">awesome</font><font color="#CCCCCC"> I also like to brag about</font>

887
00:46:35,240 --> 00:46:41,350
getting domain admin privileges under<font color="#CCCCCC"> an</font>

888
00:46:37,670 --> 00:46:44,210
<font color="#CCCCCC">hour</font><font color="#E5E5E5"> right but please try to avoid that</font>

889
00:46:41,350 --> 00:46:46,370
domain admin privileges or a lowest

890
00:46:44,210 --> 00:46:48,220
hanging fruit<font color="#E5E5E5"> once again if it looks</font>

891
00:46:46,370 --> 00:46:50,900
<font color="#E5E5E5">like it is too good to</font><font color="#CCCCCC"> be true</font>

892
00:46:48,220 --> 00:46:52,910
in any or very<font color="#E5E5E5"> first enumeration you can</font>

893
00:46:50,900 --> 00:46:55,820
find out that there is an environment

894
00:46:52,910 --> 00:46:57,799
<font color="#E5E5E5">where with like</font><font color="#CCCCCC"> 50 percent of the</font><font color="#E5E5E5"> users</font>

895
00:46:55,820 --> 00:47:00,350
<font color="#E5E5E5">are domain admin I mean that could be</font>

896
00:46:57,800 --> 00:47:04,660
<font color="#E5E5E5">true as well but if you find that out</font>

897
00:47:00,350 --> 00:47:07,549
<font color="#E5E5E5">then put your detective cap on first</font>

898
00:47:04,660 --> 00:47:09,529
<font color="#E5E5E5">just make</font><font color="#CCCCCC"> sure that the object</font><font color="#E5E5E5"> or</font><font color="#CCCCCC"> the</font>

899
00:47:07,550 --> 00:47:13,100
users<font color="#CCCCCC"> you are looking at are</font><font color="#E5E5E5"> not the</font>

900
00:47:09,530 --> 00:47:16,790
fake ones are not<font color="#CCCCCC"> the dekai ones avoid</font>

901
00:47:13,100 --> 00:47:19,190
automated tools<font color="#E5E5E5"> right I know want to</font>

902
00:47:16,790 --> 00:47:21,050
name a tool<font color="#E5E5E5"> but of course there</font><font color="#CCCCCC"> are so</font>

903
00:47:19,190 --> 00:47:25,310
many<font color="#CCCCCC"> interesting tools which keep coming</font>

904
00:47:21,050 --> 00:47:30,050
out which for example<font color="#E5E5E5"> there was a tool</font>

905
00:47:25,310 --> 00:47:32,630
released last<font color="#CCCCCC"> year</font><font color="#E5E5E5"> by the name slips me</font>

906
00:47:30,050 --> 00:47:34,490
so what the tool go fetch<font color="#CCCCCC"> that I</font>

907
00:47:32,630 --> 00:47:37,880
remember<font color="#E5E5E5"> name of the tool what go fetch</font>

908
00:47:34,490 --> 00:47:40,160
does it takes the path created<font color="#CCCCCC"> by</font>

909
00:47:37,880 --> 00:47:42,530
identified<font color="#E5E5E5"> by bloodhound</font><font color="#CCCCCC"> and would</font>

910
00:47:40,160 --> 00:47:44,779
follow that and provide you automatic

911
00:47:42,530 --> 00:47:47,240
domain<font color="#E5E5E5"> takeover right any tool which</font>

912
00:47:44,780 --> 00:47:48,830
<font color="#CCCCCC">provides you automated domain takeover</font>

913
00:47:47,240 --> 00:47:50,810
and I'm specifically talking talking

914
00:47:48,830 --> 00:47:53,720
about red teamers not penetration tests

915
00:47:50,810 --> 00:47:55,279
<font color="#E5E5E5">your fine living credential living your</font>

916
00:47:53,720 --> 00:47:58,310
footprint everywhere in a<font color="#E5E5E5"> penetration</font>

917
00:47:55,280 --> 00:48:00,230
test but red teamers please do not use

918
00:47:58,310 --> 00:48:02,920
automatic domain<font color="#E5E5E5"> take</font><font color="#CCCCCC"> oh it will still</font>

919
00:48:00,230 --> 00:48:06,620
leave logs<font color="#E5E5E5"> and fingerprint everywhere</font>

920
00:48:02,920 --> 00:48:09,200
and if you<font color="#E5E5E5"> ever encounter</font><font color="#CCCCCC"> a blue team</font>

921
00:48:06,620 --> 00:48:10,790
worth<font color="#CCCCCC"> your salt</font><font color="#E5E5E5"> you would be gone for</font>

922
00:48:09,200 --> 00:48:13,160
good it would it would<font color="#CCCCCC"> be it's so</font>

923
00:48:10,790 --> 00:48:14,630
embarrassing I've been there<font color="#E5E5E5"> right if</font>

924
00:48:13,160 --> 00:48:18,490
you get<font color="#E5E5E5"> caught during a red team</font>

925
00:48:14,630 --> 00:48:21,100
engagement that's embarrassing

926
00:48:18,490 --> 00:48:23,479
once again I've been<font color="#CCCCCC"> watching</font><font color="#E5E5E5"> this</font>

927
00:48:21,100 --> 00:48:25,549
specifically<font color="#E5E5E5"> during my</font><font color="#CCCCCC"> ATA talks and in</font>

928
00:48:23,480 --> 00:48:28,580
my trainings please<font color="#E5E5E5"> avoid the</font><font color="#CCCCCC"> urge to</font>

929
00:48:25,550 --> 00:48:32,510
for the domain admin<font color="#E5E5E5"> it just make things</font>

930
00:48:28,580 --> 00:48:35,779
simpler<font color="#E5E5E5"> but also it's like what bringing</font>

931
00:48:32,510 --> 00:48:38,510
a tank to a knife<font color="#CCCCCC"> fight</font><font color="#E5E5E5"> right it's not</font>

932
00:48:35,780 --> 00:48:42,560
required looks cool but generally not

933
00:48:38,510 --> 00:48:47,630
<font color="#CCCCCC">required if you can avoid</font><font color="#E5E5E5"> da then that's</font>

934
00:48:42,560 --> 00:48:50,870
better now how do blue<font color="#CCCCCC"> teams avoid</font>

935
00:48:47,630 --> 00:48:55,190
identification<font color="#E5E5E5"> right how do they make</font>

936
00:48:50,870 --> 00:48:59,000
their the<font color="#CCCCCC"> deck wires are much more</font>

937
00:48:55,190 --> 00:49:03,110
believable<font color="#CCCCCC"> one use actually the objects</font>

938
00:48:59,000 --> 00:49:06,080
which my machine learning a I enable

939
00:49:03,110 --> 00:49:07,970
<font color="#CCCCCC">tool does</font><font color="#E5E5E5"> that is it uses actual objects</font>

940
00:49:06,080 --> 00:49:11,630
which makes detection<font color="#E5E5E5"> right like really</font>

941
00:49:07,970 --> 00:49:14,600
relief are not easy to<font color="#CCCCCC"> do for user</font>

942
00:49:11,630 --> 00:49:18,320
decoys it is advised if we can create a

943
00:49:14,600 --> 00:49:21,140
<font color="#CCCCCC">logon times from at least</font><font color="#E5E5E5"> one</font><font color="#CCCCCC"> logon if</font>

944
00:49:18,320 --> 00:49:23,630
you<font color="#E5E5E5"> log on that</font><font color="#CCCCCC"> they call user at least</font>

945
00:49:21,140 --> 00:49:28,069
once<font color="#E5E5E5"> that</font><font color="#CCCCCC"> fills a couple of interesting</font>

946
00:49:23,630 --> 00:49:29,900
<font color="#CCCCCC">properties right so I have tried to</font>

947
00:49:28,070 --> 00:49:33,200
<font color="#E5E5E5">address</font><font color="#CCCCCC"> that in deployed reception</font>

948
00:49:29,900 --> 00:49:36,020
actually how when you create a

949
00:49:33,200 --> 00:49:39,439
privileged user<font color="#CCCCCC"> who's part of the domain</font>

950
00:49:36,020 --> 00:49:42,770
admins group<font color="#E5E5E5"> you can restrict its</font><font color="#CCCCCC"> logon</font>

951
00:49:39,440 --> 00:49:45,500
just to the domain controller<font color="#E5E5E5"> and while</font>

952
00:49:42,770 --> 00:49:48,590
the user gets created<font color="#E5E5E5"> you start a</font>

953
00:49:45,500 --> 00:49:50,870
process<font color="#E5E5E5"> as that user momentarily so when</font>

954
00:49:48,590 --> 00:49:52,550
you start that the process with<font color="#CCCCCC"> that</font>

955
00:49:50,870 --> 00:49:55,160
particular<font color="#CCCCCC"> dacoit domain admin</font>

956
00:49:52,550 --> 00:49:57,860
momentarily<font color="#E5E5E5"> some of the interesting</font>

957
00:49:55,160 --> 00:50:03,440
<font color="#E5E5E5">fields like log on timestamp last</font><font color="#CCCCCC"> logon</font>

958
00:49:57,860 --> 00:50:05,300
<font color="#E5E5E5">etc gets populated and</font><font color="#CCCCCC"> I don't know how</font>

959
00:50:03,440 --> 00:50:07,370
<font color="#E5E5E5">but I forgot the video for that and then</font>

960
00:50:05,300 --> 00:50:10,190
if you run like the tool like invoke an

961
00:50:07,370 --> 00:50:13,279
investor on that the detection<font color="#E5E5E5"> rates</font>

962
00:50:10,190 --> 00:50:16,340
would<font color="#E5E5E5"> be really really</font><font color="#CCCCCC"> low</font><font color="#E5E5E5"> or</font><font color="#CCCCCC"> if someone</font>

963
00:50:13,280 --> 00:50:18,560
is manually having a look at that the

964
00:50:16,340 --> 00:50:20,390
user looks perfectly fine<font color="#CCCCCC"> a domain admin</font>

965
00:50:18,560 --> 00:50:22,460
with couple of logins it's perfectly

966
00:50:20,390 --> 00:50:26,120
fine with<font color="#E5E5E5"> zero logins probably not so</font>

967
00:50:22,460 --> 00:50:29,720
good<font color="#CCCCCC"> you may like to notice that if you</font>

968
00:50:26,120 --> 00:50:32,180
use this particular<font color="#E5E5E5"> command as of now a</font>

969
00:50:29,720 --> 00:50:34,250
profile for that particular user would

970
00:50:32,180 --> 00:50:36,919
<font color="#CCCCCC">be created on the</font><font color="#E5E5E5"> domain on the domain</font>

971
00:50:34,250 --> 00:50:37,980
controller<font color="#E5E5E5"> which does not mean anything</font>

972
00:50:36,920 --> 00:50:41,730
else<font color="#E5E5E5"> other</font>

973
00:50:37,980 --> 00:50:43,260
and<font color="#E5E5E5"> your</font><font color="#CCCCCC"> CE users directory when you go</font>

974
00:50:41,730 --> 00:50:45,000
there would not<font color="#E5E5E5"> look beautiful and I</font>

975
00:50:43,260 --> 00:50:47,520
<font color="#CCCCCC">know system administrators who keep that</font>

976
00:50:45,000 --> 00:50:50,580
neat and clean it

977
00:50:47,520 --> 00:50:53,730
keep that neat and clean<font color="#CCCCCC"> right</font><font color="#E5E5E5"> so that</font>

978
00:50:50,580 --> 00:50:57,950
is how we address a problem of getting

979
00:50:53,730 --> 00:50:57,950
<font color="#E5E5E5">detection of getting detected sorry</font>

980
00:50:59,040 --> 00:51:06,480
so what else we can expect<font color="#E5E5E5"> from it the</font>

981
00:51:03,840 --> 00:51:08,160
the biggest challenge right<font color="#CCCCCC"> now</font><font color="#E5E5E5"> once</font>

982
00:51:06,480 --> 00:51:11,310
<font color="#E5E5E5">again when I was testing this was to</font>

983
00:51:08,160 --> 00:51:12,899
find you in the<font color="#CCCCCC"> logging this has not</font>

984
00:51:11,310 --> 00:51:14,549
<font color="#CCCCCC">been tested</font><font color="#E5E5E5"> in many enterprise</font>

985
00:51:12,900 --> 00:51:17,940
environments only my friends have<font color="#E5E5E5"> tried</font>

986
00:51:14,550 --> 00:51:20,580
this<font color="#E5E5E5"> which were quite happy with that</font>

987
00:51:17,940 --> 00:51:22,200
the problem is<font color="#E5E5E5"> inventory management or</font>

988
00:51:20,580 --> 00:51:23,730
asset management tools which keep

989
00:51:22,200 --> 00:51:25,919
information<font color="#E5E5E5"> keep looking for information</font>

990
00:51:23,730 --> 00:51:29,970
about computers or users all the time

991
00:51:25,920 --> 00:51:31,800
that may trigger some<font color="#CCCCCC"> of the logs</font><font color="#E5E5E5"> right</font>

992
00:51:29,970 --> 00:51:34,709
so it still needs to<font color="#CCCCCC"> make sure the tool</font>

993
00:51:31,800 --> 00:51:37,440
is<font color="#CCCCCC"> just being</font><font color="#E5E5E5"> released so</font><font color="#CCCCCC"> still needs to</font>

994
00:51:34,710 --> 00:51:40,410
<font color="#CCCCCC">mature a lot so if</font><font color="#E5E5E5"> any one</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> you want</font>

995
00:51:37,440 --> 00:51:42,420
to<font color="#E5E5E5"> get involved but does not know the</font>

996
00:51:40,410 --> 00:51:45,029
programming<font color="#CCCCCC"> etc then you</font><font color="#E5E5E5"> test it and</font>

997
00:51:42,420 --> 00:51:47,580
drop me an insult<font color="#E5E5E5"> I'll take it happily I</font>

998
00:51:45,030 --> 00:51:50,190
mean once again this is the first blue

999
00:51:47,580 --> 00:51:53,190
tool which<font color="#CCCCCC"> I've</font><font color="#E5E5E5"> ever written or that's</font>

1000
00:51:50,190 --> 00:51:55,650
the first time I'm<font color="#E5E5E5"> releasing it so you</font>

1001
00:51:53,190 --> 00:52:00,570
can you may find out<font color="#CCCCCC"> a lot of false</font>

1002
00:51:55,650 --> 00:52:02,580
positives<font color="#CCCCCC"> initially also deploying</font><font color="#E5E5E5"> the</font>

1003
00:52:00,570 --> 00:52:06,300
<font color="#E5E5E5">COI domain and forest objects that's on</font>

1004
00:52:02,580 --> 00:52:08,310
my<font color="#CCCCCC"> to-do right</font><font color="#E5E5E5"> so that it can be</font>

1005
00:52:06,300 --> 00:52:12,030
automated<font color="#E5E5E5"> there is no need</font><font color="#CCCCCC"> of creating</font>

1006
00:52:08,310 --> 00:52:15,270
<font color="#CCCCCC">it</font><font color="#E5E5E5"> manually so that's something else</font>

1007
00:52:12,030 --> 00:52:17,700
which I'm going<font color="#E5E5E5"> to have a look at and</font>

1008
00:52:15,270 --> 00:52:20,190
finally a<font color="#CCCCCC"> very ambitious goal is to use</font>

1009
00:52:17,700 --> 00:52:24,379
virtualization<font color="#E5E5E5"> what is that that is</font><font color="#CCCCCC"> if</font>

1010
00:52:20,190 --> 00:52:29,760
if you want<font color="#CCCCCC"> one second</font><font color="#E5E5E5"> very ambitious</font><font color="#CCCCCC"> a</font>

1011
00:52:24,380 --> 00:52:31,680
forest gets deployed automagically<font color="#E5E5E5"> if</font>

1012
00:52:29,760 --> 00:52:33,750
someone is looking<font color="#E5E5E5"> for it or if you want</font>

1013
00:52:31,680 --> 00:52:35,970
with<font color="#CCCCCC"> on a single</font><font color="#E5E5E5"> click or with a single</font>

1014
00:52:33,750 --> 00:52:37,230
command<font color="#E5E5E5"> you can deploy an actual forest</font>

1015
00:52:35,970 --> 00:52:38,299
<font color="#CCCCCC">using containers let's</font><font color="#E5E5E5"> your</font>

1016
00:52:37,230 --> 00:52:42,480
<font color="#E5E5E5">virtualization</font>

1017
00:52:38,300 --> 00:52:45,119
so chances of do-deca is getting caught

1018
00:52:42,480 --> 00:52:49,240
<font color="#E5E5E5">are less and the amount of time it takes</font>

1019
00:52:45,119 --> 00:52:55,500
<font color="#E5E5E5">for the deployment gets reduced as</font><font color="#CCCCCC"> well</font>

1020
00:52:49,240 --> 00:52:58,330
so what we have seen we can<font color="#E5E5E5"> talk we can</font>

1021
00:52:55,500 --> 00:53:00,900
many plate an adversary's mindset once

1022
00:52:58,330 --> 00:53:04,900
again off of the illusionary superiority

1023
00:53:00,900 --> 00:53:06,970
<font color="#CCCCCC">to show them to</font><font color="#E5E5E5"> deceive them you know</font>

1024
00:53:04,900 --> 00:53:10,480
what<font color="#E5E5E5"> they want to look we provide them</font>

1025
00:53:06,970 --> 00:53:12,250
that<font color="#E5E5E5"> and that increases their time in</font>

1026
00:53:10,480 --> 00:53:15,520
our environment chances of detection<font color="#E5E5E5"> as</font>

1027
00:53:12,250 --> 00:53:16,990
well we didn't<font color="#E5E5E5"> know and one thing</font><font color="#CCCCCC"> I</font>

1028
00:53:15,520 --> 00:53:20,560
think<font color="#CCCCCC"> it's not written on</font><font color="#E5E5E5"> the slide so</font>

1029
00:53:16,990 --> 00:53:23,560
we<font color="#CCCCCC"> do not need those expensive tools for</font>

1030
00:53:20,560 --> 00:53:28,150
all of these upcoming<font color="#CCCCCC"> things right I</font>

1031
00:53:23,560 --> 00:53:33,360
wish I could<font color="#E5E5E5"> take names NDA's though</font><font color="#CCCCCC"> but</font>

1032
00:53:28,150 --> 00:53:37,060
this<font color="#CCCCCC"> comes quite close sense of</font>

1033
00:53:33,360 --> 00:53:39,640
<font color="#E5E5E5">cool-looking web console but the boring</font>

1034
00:53:37,060 --> 00:53:41,890
<font color="#E5E5E5">automated logging or the logging which</font>

1035
00:53:39,640 --> 00:53:43,810
is already<font color="#E5E5E5"> there but this is something</font>

1036
00:53:41,890 --> 00:53:46,480
which<font color="#E5E5E5"> many of the tools which</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> will</font>

1037
00:53:43,810 --> 00:53:48,940
purchase<font color="#E5E5E5"> they do the exact same thing</font>

1038
00:53:46,480 --> 00:53:54,430
<font color="#E5E5E5">but this suck even more than this to let</font>

1039
00:53:48,940 --> 00:53:57,280
that so<font color="#CCCCCC"> yes that's</font><font color="#E5E5E5"> the last</font><font color="#CCCCCC"> point</font>

1040
00:53:54,430 --> 00:54:00,609
actually<font color="#E5E5E5"> if we cleverly use the existing</font>

1041
00:53:57,280 --> 00:54:02,950
<font color="#E5E5E5">Active Directory tools we can actually</font>

1042
00:54:00,610 --> 00:54:05,860
match the<font color="#E5E5E5"> deception of the enterprise</font>

1043
00:54:02,950 --> 00:54:06,850
tools if<font color="#E5E5E5"> we if if we cannot</font><font color="#CCCCCC"> batter it at</font>

1044
00:54:05,860 --> 00:54:10,360
<font color="#E5E5E5">least we can match that</font>

1045
00:54:06,850 --> 00:54:12,580
<font color="#E5E5E5">so use your</font><font color="#CCCCCC"> security budget</font><font color="#E5E5E5"> to get some</font>

1046
00:54:10,360 --> 00:54:14,310
good<font color="#E5E5E5"> red teamers and pen testers in</font>

1047
00:54:12,580 --> 00:54:16,779
place of buying yet another appliance

1048
00:54:14,310 --> 00:54:19,630
<font color="#E5E5E5">with the vulnerable web console which</font>

1049
00:54:16,780 --> 00:54:24,250
will<font color="#CCCCCC"> ultimately let your</font><font color="#E5E5E5"> organization</font>

1050
00:54:19,630 --> 00:54:27,700
down so<font color="#E5E5E5"> I think that would</font><font color="#CCCCCC"> be all please</font>

1051
00:54:24,250 --> 00:54:30,250
leave feedback<font color="#E5E5E5"> I would</font><font color="#CCCCCC"> really like that</font>

1052
00:54:27,700 --> 00:54:33,759
<font color="#E5E5E5">once again my bluest rock ever you can</font>

1053
00:54:30,250 --> 00:54:35,890
follow me<font color="#E5E5E5"> drop me lines and slides and</font>

1054
00:54:33,760 --> 00:54:38,770
<font color="#E5E5E5">blog posts</font><font color="#CCCCCC"> would be available on my blog</font>

1055
00:54:35,890 --> 00:54:41,069
and<font color="#E5E5E5"> on my github and that would be all</font>

1056
00:54:38,770 --> 00:54:41,070
thank you

1057
00:54:47,430 --> 00:54:50,549
questions please

1058
00:55:07,400 --> 00:55:13,230
hi if normal<font color="#CCCCCC"> admins are unlikely to</font>

1059
00:55:11,460 --> 00:55:16,350
access<font color="#CCCCCC"> certain properties of these</font>

1060
00:55:13,230 --> 00:55:20,520
objects aren't attackers also<font color="#E5E5E5"> not going</font>

1061
00:55:16,350 --> 00:55:23,370
<font color="#E5E5E5">to need to</font><font color="#CCCCCC"> list them or access them good</font>

1062
00:55:20,520 --> 00:55:26,130
<font color="#E5E5E5">question so the the idea</font><font color="#CCCCCC"> behind and</font><font color="#E5E5E5"> that</font>

1063
00:55:23,370 --> 00:55:29,580
<font color="#E5E5E5">is why we have different types of</font><font color="#CCCCCC"> logins</font>

1064
00:55:26,130 --> 00:55:31,860
here in my experience what attackers are

1065
00:55:29,580 --> 00:55:34,319
looking for is to<font color="#CCCCCC"> gather</font><font color="#E5E5E5"> as</font><font color="#CCCCCC"> much</font>

1066
00:55:31,860 --> 00:55:38,430
information<font color="#CCCCCC"> as they can</font><font color="#E5E5E5"> and then analyze</font>

1067
00:55:34,320 --> 00:55:39,900
<font color="#CCCCCC">it to find out interesting things so in</font>

1068
00:55:38,430 --> 00:55:43,470
cases<font color="#E5E5E5"> of let's say you're</font><font color="#CCCCCC"> using an</font>

1069
00:55:39,900 --> 00:55:44,310
obscure property now for<font color="#E5E5E5"> you know</font>

1070
00:55:43,470 --> 00:55:46,980
<font color="#CCCCCC">further</font><font color="#E5E5E5"> logging</font>

1071
00:55:44,310 --> 00:55:49,410
chances are<font color="#CCCCCC"> really less of</font><font color="#E5E5E5"> course if</font>

1072
00:55:46,980 --> 00:55:51,330
they are<font color="#E5E5E5"> used going for the minimal</font>

1073
00:55:49,410 --> 00:55:53,430
enumeration part<font color="#E5E5E5"> let's say</font><font color="#CCCCCC"> just the</font>

1074
00:55:51,330 --> 00:55:57,290
domain user names or<font color="#CCCCCC"> just</font><font color="#E5E5E5"> the computer</font>

1075
00:55:53,430 --> 00:55:57,290
names in that<font color="#CCCCCC"> case it won't</font><font color="#E5E5E5"> be logged</font>

1076
00:56:06,720 --> 00:56:13,839
so thanks<font color="#E5E5E5"> for</font><font color="#CCCCCC"> your talk</font><font color="#E5E5E5"> regarding</font><font color="#CCCCCC"> you</font>

1077
00:56:10,780 --> 00:56:16,329
<font color="#CCCCCC">add</font><font color="#E5E5E5"> in a domain admin user and then</font>

1078
00:56:13,839 --> 00:56:19,270
setting a restricted logon for<font color="#E5E5E5"> a</font>

1079
00:56:16,329 --> 00:56:21,790
non-existent<font color="#E5E5E5"> workstation</font><font color="#CCCCCC"> does this come</font>

1080
00:56:19,270 --> 00:56:23,890
without any<font color="#CCCCCC"> other dangers for example</font>

1081
00:56:21,790 --> 00:56:25,960
just sitting in on a<font color="#E5E5E5"> workstation mean</font>

1082
00:56:23,890 --> 00:56:30,040
that this domain admin account won't

1083
00:56:25,960 --> 00:56:33,220
possibly<font color="#E5E5E5"> use for</font><font color="#CCCCCC"> example this is sink or</font>

1084
00:56:30,040 --> 00:56:36,099
<font color="#E5E5E5">get</font><font color="#CCCCCC"> SPN ticket or perform LDAP queries</font>

1085
00:56:33,220 --> 00:56:38,379
on the<font color="#E5E5E5"> domain environment it</font><font color="#CCCCCC"> may</font>

1086
00:56:36,099 --> 00:56:42,250
experience<font color="#CCCCCC"> no because for all</font><font color="#E5E5E5"> of these</font>

1087
00:56:38,380 --> 00:56:44,440
things<font color="#E5E5E5"> the decoy user need to at least</font>

1088
00:56:42,250 --> 00:56:46,660
<font color="#CCCCCC">once authenticate</font><font color="#E5E5E5"> with the domain</font>

1089
00:56:44,440 --> 00:56:49,450
controller<font color="#E5E5E5"> and we are restricting even</font>

1090
00:56:46,660 --> 00:56:52,810
that single authentication at all<font color="#E5E5E5"> so in</font>

1091
00:56:49,450 --> 00:56:54,310
my testing<font color="#E5E5E5"> it's not possible but please</font>

1092
00:56:52,810 --> 00:56:56,380
<font color="#E5E5E5">keep in mind that if you are creating</font>

1093
00:56:54,310 --> 00:56:58,630
<font color="#CCCCCC">adequate domain admin and your other</font>

1094
00:56:56,380 --> 00:57:00,490
domain admin gets owned then someone<font color="#E5E5E5"> can</font>

1095
00:56:58,630 --> 00:57:03,570
simply<font color="#CCCCCC"> remove that restriction so that</font>

1096
00:57:00,490 --> 00:57:03,569
<font color="#E5E5E5">possibility is always there</font>

