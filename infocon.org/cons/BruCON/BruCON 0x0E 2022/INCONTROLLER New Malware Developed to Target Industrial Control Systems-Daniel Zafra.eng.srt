1
00:00:03,319 --> 00:00:06,299
uh so first of all thanks for being here

2
00:00:06,299 --> 00:00:09,240
uh we're very excited to bring this uh

3
00:00:09,240 --> 00:00:10,980
very exciting topic for us that happened

4
00:00:10,980 --> 00:00:12,440
this year

5
00:00:12,440 --> 00:00:15,059
we've been already telling the story a

6
00:00:15,059 --> 00:00:18,180
bit but today we have some additional uh

7
00:00:18,180 --> 00:00:20,340
special material for you uh particularly

8
00:00:20,340 --> 00:00:22,380
we started working on some of the

9
00:00:22,380 --> 00:00:24,300
detections and some recommendations of

10
00:00:24,300 --> 00:00:26,100
how you could go and and try to find

11
00:00:26,100 --> 00:00:28,439
this type of malware particularly

12
00:00:28,439 --> 00:00:30,300
if you're passionate about going and

13
00:00:30,300 --> 00:00:32,640
searching for it and for this

14
00:00:32,640 --> 00:00:35,340
um well before getting into the story I

15
00:00:35,340 --> 00:00:37,040
just wanted to do a quick introduction

16
00:00:37,040 --> 00:00:39,420
uh right now you're going to see I'm

17
00:00:39,420 --> 00:00:43,140
Daniel uh technical analysis manager in

18
00:00:43,140 --> 00:00:45,000
demanding team with working with driver

19
00:00:45,000 --> 00:00:47,879
physical with IO and you're also going

20
00:00:47,879 --> 00:00:50,039
to see here Cam proska he's one of our

21
00:00:50,039 --> 00:00:52,260
star analysts from the Cyber physical

22
00:00:52,260 --> 00:00:53,640
team

23
00:00:53,640 --> 00:00:55,920
both of us and all of our team was

24
00:00:55,920 --> 00:00:58,079
involved in in this particular research

25
00:00:58,079 --> 00:01:00,899
Ken might not be coming here right now

26
00:01:00,899 --> 00:01:03,600
for some unfortunate circumstances that

27
00:01:03,600 --> 00:01:05,700
are happening right now but he's going

28
00:01:05,700 --> 00:01:07,920
to be around here so if you see if you

29
00:01:07,920 --> 00:01:09,540
have questions about detections mainly

30
00:01:09,540 --> 00:01:10,860
thread hunting and whatnot later that

31
00:01:10,860 --> 00:01:13,380
you want to get super into it please try

32
00:01:13,380 --> 00:01:14,700
to find him I'm pretty sure he's going

33
00:01:14,700 --> 00:01:18,240
to be super excited of chatting with you

34
00:01:18,240 --> 00:01:19,920
now

35
00:01:19,920 --> 00:01:22,799
let's get into the talk directly so the

36
00:01:22,799 --> 00:01:25,140
first thing industrial Control Systems

37
00:01:25,140 --> 00:01:26,580
malware something new

38
00:01:26,580 --> 00:01:29,159
this was very exciting for us well and

39
00:01:29,159 --> 00:01:31,799
you know the first thing is why is it so

40
00:01:31,799 --> 00:01:34,259
exciting uh because it has happened only

41
00:01:34,259 --> 00:01:36,780
a few times so whenever we see one of

42
00:01:36,780 --> 00:01:39,600
these cases basically uh as far as we

43
00:01:39,600 --> 00:01:41,880
when we were made aware that it existed

44
00:01:41,880 --> 00:01:43,680
all of our team it's almost like you

45
00:01:43,680 --> 00:01:45,420
drop the things to the floor and

46
00:01:45,420 --> 00:01:47,220
immediately you start going into how are

47
00:01:47,220 --> 00:01:48,960
we going to tackle this malware how are

48
00:01:48,960 --> 00:01:51,119
we going to find uh what it is let's go

49
00:01:51,119 --> 00:01:52,680
and try to do some sections let's try to

50
00:01:52,680 --> 00:01:54,240
figure out what's going on

51
00:01:54,240 --> 00:01:56,640
you will understand a bit more why it is

52
00:01:56,640 --> 00:01:58,799
so complicated uh to to work with this

53
00:01:58,799 --> 00:02:00,360
type of malware but yeah that was

54
00:02:00,360 --> 00:02:01,680
something we were very excited about

55
00:02:01,680 --> 00:02:03,479
this year and very unexcited because of

56
00:02:03,479 --> 00:02:04,979
the implications which also are going to

57
00:02:04,979 --> 00:02:08,299
be discussed through the talk

58
00:02:08,459 --> 00:02:11,640
so I mentioned a second ago

59
00:02:11,640 --> 00:02:13,080
um

60
00:02:13,080 --> 00:02:14,819
OT malware industrial Control Systems

61
00:02:14,819 --> 00:02:17,280
malware where you you prefer it's very

62
00:02:17,280 --> 00:02:19,860
fairly complex to identify even if

63
00:02:19,860 --> 00:02:21,660
you're looking for it all the time it's

64
00:02:21,660 --> 00:02:23,700
not a matter always of how good you look

65
00:02:23,700 --> 00:02:25,680
or where you're looking at but simply a

66
00:02:25,680 --> 00:02:27,120
matter of whether it exists and whether

67
00:02:27,120 --> 00:02:29,160
you're able to find it or to find you

68
00:02:29,160 --> 00:02:30,900
know through the different steps of an

69
00:02:30,900 --> 00:02:31,680
attack

70
00:02:31,680 --> 00:02:33,060
so

71
00:02:33,060 --> 00:02:35,160
historically based on the difficulties

72
00:02:35,160 --> 00:02:37,080
of finding this and even like the how

73
00:02:37,080 --> 00:02:39,599
rare it is we have only seen it a couple

74
00:02:39,599 --> 00:02:41,879
times this is this timeline is basically

75
00:02:41,879 --> 00:02:44,099
like the full history of control system

76
00:02:44,099 --> 00:02:45,840
security

77
00:02:45,840 --> 00:02:48,660
um first you know stocksnet we have most

78
00:02:48,660 --> 00:02:50,160
people in here if not everyone is

79
00:02:50,160 --> 00:02:52,500
already familiar uh Iranian nucleus and

80
00:02:52,500 --> 00:02:54,720
refugees basically there's a specific

81
00:02:54,720 --> 00:02:56,879
malware uh if you had more like

82
00:02:56,879 --> 00:02:58,739
worm-like capabilities it moves through

83
00:02:58,739 --> 00:03:00,599
the the targets environment and

84
00:03:00,599 --> 00:03:03,120
eventually uh drops a production for a

85
00:03:03,120 --> 00:03:03,959
while

86
00:03:03,959 --> 00:03:06,959
then the next years based on this there

87
00:03:06,959 --> 00:03:09,000
was more research like people started

88
00:03:09,000 --> 00:03:10,440
getting excited let's go and investigate

89
00:03:10,440 --> 00:03:12,599
let's figure out what it is and then uh

90
00:03:12,599 --> 00:03:14,340
we started seeing like what are

91
00:03:14,340 --> 00:03:16,140
vulnerabilities for Control Systems how

92
00:03:16,140 --> 00:03:17,879
does it look like what is it that we're

93
00:03:17,879 --> 00:03:20,580
facing and we started seeing then uh the

94
00:03:20,580 --> 00:03:22,379
first cases right like like the

95
00:03:22,379 --> 00:03:25,379
blackouts in in Ukraine two of them one

96
00:03:25,379 --> 00:03:27,120
of them with fairly complex malware

97
00:03:27,120 --> 00:03:29,879
called in Destroyer uh this is going to

98
00:03:29,879 --> 00:03:31,519
be something very important because

99
00:03:31,519 --> 00:03:33,659
we're just going to mention it like

100
00:03:33,659 --> 00:03:36,180
briefly but it came back in 2022 which

101
00:03:36,180 --> 00:03:37,560
is why I mentioned they're both in

102
00:03:37,560 --> 00:03:39,360
controller and in Destroyer the second

103
00:03:39,360 --> 00:03:41,159
version

104
00:03:41,159 --> 00:03:44,220
um and well 2017 Triton that was the

105
00:03:44,220 --> 00:03:46,260
basically the biggest case we've seen uh

106
00:03:46,260 --> 00:03:48,659
so far that was actually deployed in the

107
00:03:48,659 --> 00:03:49,920
Target that we were able to attribute

108
00:03:49,920 --> 00:03:51,900
and whatever uh if you're curious about

109
00:03:51,900 --> 00:03:53,760
any of these cases Melia Triton feel

110
00:03:53,760 --> 00:03:55,080
free to go and take a look at our blogs

111
00:03:55,080 --> 00:03:56,940
we have some very good materials or let

112
00:03:56,940 --> 00:03:58,620
me know and I'm glad to share a bit more

113
00:03:58,620 --> 00:04:00,599
but right now we're going to be focusing

114
00:04:00,599 --> 00:04:03,720
on in-controller the the newest case

115
00:04:03,720 --> 00:04:06,840
which is uh basically a set of tools to

116
00:04:06,840 --> 00:04:09,000
Target control systems

117
00:04:09,000 --> 00:04:11,099
in in possibly specific environments

118
00:04:11,099 --> 00:04:14,220
possibly not and uh the first question

119
00:04:14,220 --> 00:04:15,720
that always comes is how do you find it

120
00:04:15,720 --> 00:04:17,160
how do you know it exists you know it

121
00:04:17,160 --> 00:04:18,899
hasn't been deployed so does that make

122
00:04:18,899 --> 00:04:21,720
sense I know it's pretty tricky but uh

123
00:04:21,720 --> 00:04:24,060
basically what we can say is we do we

124
00:04:24,060 --> 00:04:25,979
utilize we employ many different

125
00:04:25,979 --> 00:04:27,840
techniques to try to identify malware

126
00:04:27,840 --> 00:04:30,540
and gladly some of these uh basically

127
00:04:30,540 --> 00:04:33,419
bear fruits we were able to learn about

128
00:04:33,419 --> 00:04:35,400
this malware somehow and eventually

129
00:04:35,400 --> 00:04:38,100
started looking into it and as soon as

130
00:04:38,100 --> 00:04:40,080
it came given the complexity and given

131
00:04:40,080 --> 00:04:41,400
all the different types of assets and

132
00:04:41,400 --> 00:04:43,620
basically everything that it involves we

133
00:04:43,620 --> 00:04:45,300
started working with

134
00:04:45,300 --> 00:04:46,139
um

135
00:04:46,139 --> 00:04:48,000
equipment manufacturers basically like

136
00:04:48,000 --> 00:04:49,440
with all other parties involved

137
00:04:49,440 --> 00:04:51,300
particularly here we we highlight

138
00:04:51,300 --> 00:04:53,280
Schneider Electric uh there are some

139
00:04:53,280 --> 00:04:55,979
devices that were related to well

140
00:04:55,979 --> 00:04:57,780
affected by this malware and you know

141
00:04:57,780 --> 00:04:59,400
they jumped immediately were very nice

142
00:04:59,400 --> 00:05:01,320
to work with us we started getting up

143
00:05:01,320 --> 00:05:03,120
some ideas and trying to figure out what

144
00:05:03,120 --> 00:05:04,259
was going on

145
00:05:04,259 --> 00:05:05,940
but if you want more sources you have

146
00:05:05,940 --> 00:05:07,740
them there in this slide uh you know I

147
00:05:07,740 --> 00:05:08,880
know all of this is going to go public

148
00:05:08,880 --> 00:05:10,680
so you know or let me know and I'm

149
00:05:10,680 --> 00:05:13,820
pretty pretty good to share

150
00:05:13,860 --> 00:05:17,220
so in controller what is it exactly

151
00:05:17,220 --> 00:05:18,780
in controller is a set of tools

152
00:05:18,780 --> 00:05:21,479
particularly three tools and we include

153
00:05:21,479 --> 00:05:26,100
here two sort of possibly related uh it

154
00:05:26,100 --> 00:05:28,740
malware which are the the two in ref in

155
00:05:28,740 --> 00:05:30,780
the Below on the screen so we're going

156
00:05:30,780 --> 00:05:31,979
to be focusing mainly on the first three

157
00:05:31,979 --> 00:05:33,960
but we kept those just to highlight that

158
00:05:33,960 --> 00:05:36,060
an attacker that wants to employ a tool

159
00:05:36,060 --> 00:05:37,620
such as scene controller will need to

160
00:05:37,620 --> 00:05:39,600
use some it tools to get to move through

161
00:05:39,600 --> 00:05:40,800
the target

162
00:05:40,800 --> 00:05:44,039
so the three core components tagram uh

163
00:05:44,039 --> 00:05:47,520
cold call on Michelle are basically uh

164
00:05:47,520 --> 00:05:50,280
we we try toward at him in sort of an

165
00:05:50,280 --> 00:05:52,080
order of

166
00:05:52,080 --> 00:05:53,460
how the attack will look like you're

167
00:05:53,460 --> 00:05:55,320
going to see a diagram in a second but

168
00:05:55,320 --> 00:05:57,380
basically the first one tagline

169
00:05:57,380 --> 00:06:00,900
is mainly possibly seems to be like a

170
00:06:00,900 --> 00:06:02,940
reconnaissance tool that is going to be

171
00:06:02,940 --> 00:06:04,139
interacting with a protocol that's

172
00:06:04,139 --> 00:06:07,320
called OPC UA OPC UA is a protocol used

173
00:06:07,320 --> 00:06:09,060
to interact with devices in the

174
00:06:09,060 --> 00:06:11,220
production side and basically make all

175
00:06:11,220 --> 00:06:13,080
that information readable for the

176
00:06:13,080 --> 00:06:15,419
machines that we normally work with

177
00:06:15,419 --> 00:06:17,600
the other two cold call and ohm shell

178
00:06:17,600 --> 00:06:20,699
are instead more like modules that you

179
00:06:20,699 --> 00:06:22,080
would use during an attack when you

180
00:06:22,080 --> 00:06:23,340
actually want to interact with the

181
00:06:23,340 --> 00:06:25,500
controller actually make some change in

182
00:06:25,500 --> 00:06:27,900
the physical process the first one

183
00:06:27,900 --> 00:06:31,460
specifically involves a modbus protocol

184
00:06:31,460 --> 00:06:34,860
involves some Schneider Electric devices

185
00:06:34,860 --> 00:06:37,500
and then the second one Omron devices

186
00:06:37,500 --> 00:06:39,840
particularly and a proprietary protocol

187
00:06:39,840 --> 00:06:41,520
called fins we're going to be discussing

188
00:06:41,520 --> 00:06:43,979
more of those and also HTTP which is

189
00:06:43,979 --> 00:06:45,360
fairly weird for the case of control

190
00:06:45,360 --> 00:06:48,060
systems but uh you know you can find a

191
00:06:48,060 --> 00:06:50,340
lot of things like that

192
00:06:50,340 --> 00:06:52,139
so this is this is the thing that we're

193
00:06:52,139 --> 00:06:53,340
the most proud about

194
00:06:53,340 --> 00:06:55,139
when when we when we started looking

195
00:06:55,139 --> 00:06:57,840
into it you know you have a ton of uh

196
00:06:57,840 --> 00:06:59,520
folders a ton of files everything is out

197
00:06:59,520 --> 00:07:00,960
for there and we're trying to figure out

198
00:07:00,960 --> 00:07:02,819
what what's going on so the first thing

199
00:07:02,819 --> 00:07:04,440
is figuring out what modules were the

200
00:07:04,440 --> 00:07:05,759
ones that were relevant for the control

201
00:07:05,759 --> 00:07:07,380
system trying to make sense of

202
00:07:07,380 --> 00:07:08,220
everything

203
00:07:08,220 --> 00:07:10,139
and then putting it together and trying

204
00:07:10,139 --> 00:07:12,300
to figure out what what is it that they

205
00:07:12,300 --> 00:07:13,919
even wanted you know because it has so

206
00:07:13,919 --> 00:07:15,900
many different components and pieces

207
00:07:15,900 --> 00:07:18,720
and so we sat down as a team and came up

208
00:07:18,720 --> 00:07:20,520
with this this diagram that basically

209
00:07:20,520 --> 00:07:21,900
illustrates how it could be used through

210
00:07:21,900 --> 00:07:24,900
an attack or separately uh later I was

211
00:07:24,900 --> 00:07:26,220
very glad to see that other

212
00:07:26,220 --> 00:07:28,500
organizations were also reproducing uh

213
00:07:28,500 --> 00:07:30,180
derived versions from this from this

214
00:07:30,180 --> 00:07:32,520
diagram uh so apparently it was well

215
00:07:32,520 --> 00:07:34,860
received the point in here is what you

216
00:07:34,860 --> 00:07:37,199
see is on the top you have a Pythagorean

217
00:07:37,199 --> 00:07:38,340
which was the one I was mentioning for

218
00:07:38,340 --> 00:07:39,660
OPC

219
00:07:39,660 --> 00:07:40,979
on the bottom you have called column

220
00:07:40,979 --> 00:07:44,280
shell this diagram how you see kind of

221
00:07:44,280 --> 00:07:45,360
like um

222
00:07:45,360 --> 00:07:47,759
vertically oriented is something we call

223
00:07:47,759 --> 00:07:50,580
the the Purdue model in in for OT

224
00:07:50,580 --> 00:07:53,039
control systems and what it shows is the

225
00:07:53,039 --> 00:07:54,840
full architecture of the full structure

226
00:07:54,840 --> 00:07:57,060
as an organization of how you would be

227
00:07:57,060 --> 00:07:58,560
seeing the different systems that are

228
00:07:58,560 --> 00:08:01,319
operating so when you go up to the top

229
00:08:01,319 --> 00:08:02,639
you're going to see more like corporate

230
00:08:02,639 --> 00:08:04,139
basically all the computers that we work

231
00:08:04,139 --> 00:08:06,660
with when you start going down you start

232
00:08:06,660 --> 00:08:09,000
getting into process data coming out of

233
00:08:09,000 --> 00:08:10,620
the process trying to block you know

234
00:08:10,620 --> 00:08:12,539
some the military son and whatnot when

235
00:08:12,539 --> 00:08:13,919
you go to the end you start getting

236
00:08:13,919 --> 00:08:16,199
devices that are so to speak less clever

237
00:08:16,199 --> 00:08:17,580
and it's going to be like the

238
00:08:17,580 --> 00:08:18,960
controllers they are very specific

239
00:08:18,960 --> 00:08:21,120
functionalities very consistent but are

240
00:08:21,120 --> 00:08:22,740
going to have less logic in place

241
00:08:22,740 --> 00:08:25,680
and uh finally well Trader sensors

242
00:08:25,680 --> 00:08:27,120
basically interact with the process

243
00:08:27,120 --> 00:08:28,800
gathering information from the physical

244
00:08:28,800 --> 00:08:30,539
world and whatnot

245
00:08:30,539 --> 00:08:33,299
this is how we think that an attacker

246
00:08:33,299 --> 00:08:34,500
might be able to use this either

247
00:08:34,500 --> 00:08:36,779
separate or together

248
00:08:36,779 --> 00:08:39,599
so to put it let's say to decompose

249
00:08:39,599 --> 00:08:41,279
this first component that is at the

250
00:08:41,279 --> 00:08:43,919
tagram one most likely would be used for

251
00:08:43,919 --> 00:08:45,660
reconnaissance for gathering information

252
00:08:45,660 --> 00:08:48,779
of what what assets do they have uh what

253
00:08:48,779 --> 00:08:50,820
are the tax for those assets what is

254
00:08:50,820 --> 00:08:52,980
information about the process uh how is

255
00:08:52,980 --> 00:08:54,660
it running basically learning everything

256
00:08:54,660 --> 00:08:57,480
from what they want to Target

257
00:08:57,480 --> 00:09:00,180
and then once they go from there

258
00:09:00,180 --> 00:09:01,680
you get to the second portion below

259
00:09:01,680 --> 00:09:03,839
where is the the actual the real Attack

260
00:09:03,839 --> 00:09:06,540
uh where you actually want to get what

261
00:09:06,540 --> 00:09:08,940
you can generate uh we're going to

262
00:09:08,940 --> 00:09:10,200
discuss some scenarios but basically

263
00:09:10,200 --> 00:09:11,640
something like sabotage something like

264
00:09:11,640 --> 00:09:13,800
disruption and even physical disruption

265
00:09:13,800 --> 00:09:15,480
depending on how the actor is going to

266
00:09:15,480 --> 00:09:18,720
deploy this because just to clarify uh

267
00:09:18,720 --> 00:09:20,160
this is not like something that you run

268
00:09:20,160 --> 00:09:21,720
and it happens just like for example

269
00:09:21,720 --> 00:09:23,580
instruction this is something that

270
00:09:23,580 --> 00:09:25,680
requires to have an operator so if you

271
00:09:25,680 --> 00:09:27,660
came to the beginning the first stocks

272
00:09:27,660 --> 00:09:28,980
for example we're talking about that how

273
00:09:28,980 --> 00:09:31,200
the adversary operations how normally

274
00:09:31,200 --> 00:09:33,720
right now have some active behind so all

275
00:09:33,720 --> 00:09:36,120
of this is going to necessarily have uh

276
00:09:36,120 --> 00:09:38,220
at least a lot of very skilled killful

277
00:09:38,220 --> 00:09:40,800
people that know from OT and from it how

278
00:09:40,800 --> 00:09:42,360
to move all across this

279
00:09:42,360 --> 00:09:44,220
the other two small pieces the ones that

280
00:09:44,220 --> 00:09:45,300
I'm trying not to mention because

281
00:09:45,300 --> 00:09:47,700
they're I.T malware but they seemed kind

282
00:09:47,700 --> 00:09:49,620
of related well those two for example

283
00:09:49,620 --> 00:09:51,779
are the type of what we see every day

284
00:09:51,779 --> 00:09:54,000
that might be used by the attacker to

285
00:09:54,000 --> 00:09:55,500
get to this point and then start

286
00:09:55,500 --> 00:09:57,839
deploying the attack

287
00:09:57,839 --> 00:09:59,339
so now

288
00:09:59,339 --> 00:10:01,320
before moving into more in detail I know

289
00:10:01,320 --> 00:10:02,760
that the area here is getting more into

290
00:10:02,760 --> 00:10:05,580
the width but we wanted to begin by just

291
00:10:05,580 --> 00:10:08,279
adding a very quick summary

292
00:10:08,279 --> 00:10:10,920
to summarizing controller what it is in

293
00:10:10,920 --> 00:10:12,360
in general so that you can leave from

294
00:10:12,360 --> 00:10:13,620
here already saying like I can grab a

295
00:10:13,620 --> 00:10:14,820
beer and talk about in controller

296
00:10:14,820 --> 00:10:16,800
without any problem

297
00:10:16,800 --> 00:10:18,540
um first of all it's large and complex

298
00:10:18,540 --> 00:10:21,300
code it's a ton of information it's not

299
00:10:21,300 --> 00:10:23,760
uh just one script that runs and and

300
00:10:23,760 --> 00:10:26,220
perfect each rather a bunch of different

301
00:10:26,220 --> 00:10:28,920
uh components that are going to be

302
00:10:28,920 --> 00:10:32,459
operating uh either together or separate

303
00:10:32,459 --> 00:10:33,779
second thing

304
00:10:33,779 --> 00:10:37,140
um it is nothing that you could just use

305
00:10:37,140 --> 00:10:39,660
as itself but rather something that the

306
00:10:39,660 --> 00:10:41,220
attacker needs to deploy with the help

307
00:10:41,220 --> 00:10:43,800
of additional iot tooling so most likely

308
00:10:43,800 --> 00:10:45,360
they have to go and compromise the

309
00:10:45,360 --> 00:10:47,459
victim environment from there move to

310
00:10:47,459 --> 00:10:49,640
wherever they can deploy and then use

311
00:10:49,640 --> 00:10:52,200
it's something they're going to use in

312
00:10:52,200 --> 00:10:53,579
response to how the environment works

313
00:10:53,579 --> 00:10:55,680
not just that you can deploy and you

314
00:10:55,680 --> 00:10:56,880
know

315
00:10:56,880 --> 00:10:58,620
basically it has it has this level of

316
00:10:58,620 --> 00:10:59,820
complexity

317
00:10:59,820 --> 00:11:01,380
the next one is

318
00:11:01,380 --> 00:11:03,779
that it targets devices that are using

319
00:11:03,779 --> 00:11:06,060
automation uh across different

320
00:11:06,060 --> 00:11:08,279
Industries so some of the Publications

321
00:11:08,279 --> 00:11:10,079
for in controller in different places

322
00:11:10,079 --> 00:11:12,420
have said for example uh that maybe this

323
00:11:12,420 --> 00:11:14,519
was something about oil and gas that

324
00:11:14,519 --> 00:11:17,040
this was about uh I don't know

325
00:11:17,040 --> 00:11:17,820
um

326
00:11:17,820 --> 00:11:19,380
I forgot the name well anyway any other

327
00:11:19,380 --> 00:11:22,320
industry particularly energy whatever

328
00:11:22,320 --> 00:11:23,760
at this point it's very difficult to

329
00:11:23,760 --> 00:11:25,620
tell because as we were working with the

330
00:11:25,620 --> 00:11:27,300
vendors they were telling us the devices

331
00:11:27,300 --> 00:11:29,100
that we are using

332
00:11:29,100 --> 00:11:30,740
can be used in many different

333
00:11:30,740 --> 00:11:33,060
organizations and can also be deployed

334
00:11:33,060 --> 00:11:35,519
in Machinery without you even knowing it

335
00:11:35,519 --> 00:11:37,920
exists so for example a random case that

336
00:11:37,920 --> 00:11:39,899
we found was a printing press that is

337
00:11:39,899 --> 00:11:41,640
using some of these controllers

338
00:11:41,640 --> 00:11:43,440
some of those cases it's going to be

339
00:11:43,440 --> 00:11:45,779
tricky to know where it was going to be

340
00:11:45,779 --> 00:11:48,420
deployed or what it was meant to do so

341
00:11:48,420 --> 00:11:49,680
at this point the only thing we can do

342
00:11:49,680 --> 00:11:51,540
is you know to make some some logical

343
00:11:51,540 --> 00:11:54,420
some educated analysis but it's

344
00:11:54,420 --> 00:11:55,800
difficult to tell and that is also why

345
00:11:55,800 --> 00:11:57,120
it's so important right because the

346
00:11:57,120 --> 00:11:58,860
learnings from here might prevent actual

347
00:11:58,860 --> 00:12:01,260
attack in the future

348
00:12:01,260 --> 00:12:02,700
um the next thing very likely state

349
00:12:02,700 --> 00:12:05,100
sponsored we haven't done any formal

350
00:12:05,100 --> 00:12:07,079
attribution we can't go and tell you it

351
00:12:07,079 --> 00:12:09,839
was here here on like in other cases but

352
00:12:09,839 --> 00:12:12,180
we have some educated guesses and some

353
00:12:12,180 --> 00:12:13,620
additional information that we're going

354
00:12:13,620 --> 00:12:15,180
to give later in the talk

355
00:12:15,180 --> 00:12:17,339
and then finally the capabilities as I

356
00:12:17,339 --> 00:12:18,540
mentioned you can have disruptions

357
00:12:18,540 --> 00:12:21,899
sabotage physical destruction uh but you

358
00:12:21,899 --> 00:12:24,720
know it depends on how it is deployed

359
00:12:24,720 --> 00:12:26,760
and for this uh another thing in the in

360
00:12:26,760 --> 00:12:27,660
the summary

361
00:12:27,660 --> 00:12:29,579
is that we wanted to highlight like the

362
00:12:29,579 --> 00:12:31,320
big three things from this malware that

363
00:12:31,320 --> 00:12:33,180
makes it so interesting from an OT

364
00:12:33,180 --> 00:12:34,860
perspective

365
00:12:34,860 --> 00:12:36,720
um it is that it is showing some sort of

366
00:12:36,720 --> 00:12:38,820
evolution or some sort of change

367
00:12:38,820 --> 00:12:40,920
what happens here is well first of all

368
00:12:40,920 --> 00:12:42,779
the malware is reusable

369
00:12:42,779 --> 00:12:44,459
when we were thinking many years ago

370
00:12:44,459 --> 00:12:45,959
about something like stocks net it was

371
00:12:45,959 --> 00:12:47,760
something that's deployed it's one very

372
00:12:47,760 --> 00:12:49,620
well-known victim you can develop

373
00:12:49,620 --> 00:12:51,420
detections you can go and find it it's

374
00:12:51,420 --> 00:12:54,060
something that you possibly can't use a

375
00:12:54,060 --> 00:12:56,160
lot but in this case each of these

376
00:12:56,160 --> 00:12:58,920
modules can be reused it depends more on

377
00:12:58,920 --> 00:13:01,500
the victim what type of devices what

378
00:13:01,500 --> 00:13:02,940
type of assets they have what are they

379
00:13:02,940 --> 00:13:05,100
doing do I have any visibility do I not

380
00:13:05,100 --> 00:13:07,260
it depends more on the actions of the

381
00:13:07,260 --> 00:13:09,360
actor and they can go and deploy making

382
00:13:09,360 --> 00:13:11,399
minor modifications

383
00:13:11,399 --> 00:13:13,200
the second one is that it's extensible

384
00:13:13,200 --> 00:13:16,260
so basically it wasn't built only to

385
00:13:16,260 --> 00:13:19,079
let's say to stay as it is most likely

386
00:13:19,079 --> 00:13:20,880
if we see it in the future it might be

387
00:13:20,880 --> 00:13:22,860
targeting more assets it might be more

388
00:13:22,860 --> 00:13:24,420
complex maybe they're going to add some

389
00:13:24,420 --> 00:13:25,880
additional logic some relational modules

390
00:13:25,880 --> 00:13:28,980
it depends it is basically like like how

391
00:13:28,980 --> 00:13:31,200
it's uh developed enables it to continue

392
00:13:31,200 --> 00:13:33,180
growing and to have more capabilities

393
00:13:33,180 --> 00:13:35,399
and this is very similar to what we saw

394
00:13:35,399 --> 00:13:37,500
a couple years ago with in Destroyer the

395
00:13:37,500 --> 00:13:39,959
the one in Ukraine in 2016 it was also

396
00:13:39,959 --> 00:13:41,160
had different modules for different

397
00:13:41,160 --> 00:13:44,519
protocols so this type of malware has

398
00:13:44,519 --> 00:13:46,320
the capability of you know continuing to

399
00:13:46,320 --> 00:13:48,120
be used it's not something we can only

400
00:13:48,120 --> 00:13:51,240
use basically signatures to go and find

401
00:13:51,240 --> 00:13:53,220
and finally operate it

402
00:13:53,220 --> 00:13:55,139
um basically as I was mentioning it's

403
00:13:55,139 --> 00:13:56,639
nothing that you just run and then it

404
00:13:56,639 --> 00:13:58,620
happens but rather it's something that

405
00:13:58,620 --> 00:14:00,180
is going to require an operator to sit

406
00:14:00,180 --> 00:14:03,000
down or many operators to sit down and

407
00:14:03,000 --> 00:14:05,700
go and figure out their way through the

408
00:14:05,700 --> 00:14:08,660
uh through the attack

409
00:14:09,000 --> 00:14:11,040
now

410
00:14:11,040 --> 00:14:12,540
a question that we get at this point

411
00:14:12,540 --> 00:14:16,139
always is is in controller coming back

412
00:14:16,139 --> 00:14:17,279
um are we going to see it you know

413
00:14:17,279 --> 00:14:18,480
because right now we disclose all this

414
00:14:18,480 --> 00:14:20,639
information everyone knows it does that

415
00:14:20,639 --> 00:14:22,440
mean that we won't see it like you know

416
00:14:22,440 --> 00:14:24,540
for example a Triton where you get all

417
00:14:24,540 --> 00:14:26,279
the information and then it's really

418
00:14:26,279 --> 00:14:28,200
very difficult to see it again

419
00:14:28,200 --> 00:14:31,079
in this case unfortunately it's uh

420
00:14:31,079 --> 00:14:32,519
likely that we're going to see it in the

421
00:14:32,519 --> 00:14:34,740
future it is something at least that we

422
00:14:34,740 --> 00:14:37,740
believe obviously no one knows but given

423
00:14:37,740 --> 00:14:39,180
the characteristic that I said a second

424
00:14:39,180 --> 00:14:41,399
ago the fact that it's extensible that

425
00:14:41,399 --> 00:14:43,560
you can deploy it in different ways that

426
00:14:43,560 --> 00:14:45,240
you can separate and just use some of

427
00:14:45,240 --> 00:14:46,740
the tools that you can expand to

428
00:14:46,740 --> 00:14:49,019
different capabilities basically it is

429
00:14:49,019 --> 00:14:51,959
something that if uh whomever was

430
00:14:51,959 --> 00:14:54,000
developing this decides to deploy it in

431
00:14:54,000 --> 00:14:57,120
the future they still can and finding it

432
00:14:57,120 --> 00:14:59,220
is not going to be easy even if we have

433
00:14:59,220 --> 00:15:01,199
disclosed any information if we have put

434
00:15:01,199 --> 00:15:03,120
all the research the only thing we can

435
00:15:03,120 --> 00:15:04,680
do is try to get some learnings some

436
00:15:04,680 --> 00:15:06,720
best practices for thread hunting for

437
00:15:06,720 --> 00:15:09,600
detections that we can uh move to try to

438
00:15:09,600 --> 00:15:11,699
find this activity and that is why we're

439
00:15:11,699 --> 00:15:14,579
trying to bring this up here

440
00:15:14,579 --> 00:15:16,620
now before getting to the detections

441
00:15:16,620 --> 00:15:18,000
part is going to be in the end which is

442
00:15:18,000 --> 00:15:19,440
actually my favorite right now that's

443
00:15:19,440 --> 00:15:22,079
actually by Ken Foster ship that that is

444
00:15:22,079 --> 00:15:23,339
right now unfortunately not being able

445
00:15:23,339 --> 00:15:25,440
to talk but he built all that amazing

446
00:15:25,440 --> 00:15:27,360
research for the end

447
00:15:27,360 --> 00:15:29,220
uh but right now the first thing I want

448
00:15:29,220 --> 00:15:31,560
to do is get into

449
00:15:31,560 --> 00:15:34,199
um the tooling more more a bit more into

450
00:15:34,199 --> 00:15:35,639
detail because I know we we just said

451
00:15:35,639 --> 00:15:38,279
it's super high level and you know might

452
00:15:38,279 --> 00:15:40,800
be good too to share more details so the

453
00:15:40,800 --> 00:15:43,019
first one about tag run uh as I was

454
00:15:43,019 --> 00:15:45,360
mentioning it goes specifically for uh

455
00:15:45,360 --> 00:15:47,820
targets OPC UA this protocol that

456
00:15:47,820 --> 00:15:49,680
converts and enables to communicate

457
00:15:49,680 --> 00:15:53,040
automation machinery and uh computers

458
00:15:53,040 --> 00:15:54,839
basically machine code

459
00:15:54,839 --> 00:15:57,480
it has the capability of looking and

460
00:15:57,480 --> 00:15:59,339
scanning for IP addresses going and

461
00:15:59,339 --> 00:16:00,959
finding the different tags going and

462
00:16:00,959 --> 00:16:02,699
finding what assets are running getting

463
00:16:02,699 --> 00:16:04,320
information of the process even

464
00:16:04,320 --> 00:16:05,820
modifying some of these Stacks so

465
00:16:05,820 --> 00:16:08,339
basically it has some very interesting

466
00:16:08,339 --> 00:16:10,440
capabilities that are more on the

467
00:16:10,440 --> 00:16:13,320
reconnaissance side uh if we were to

468
00:16:13,320 --> 00:16:15,420
compare this there's another case I

469
00:16:15,420 --> 00:16:17,519
believe 2014 something that's called um

470
00:16:17,519 --> 00:16:19,920
Peace Pipe we call it I think havx it

471
00:16:19,920 --> 00:16:21,540
would be kind of similar in that sense

472
00:16:21,540 --> 00:16:23,220
that it was OPC and it wants to get

473
00:16:23,220 --> 00:16:25,079
information wants to get uh

474
00:16:25,079 --> 00:16:26,699
reconnaissance try to figure out how to

475
00:16:26,699 --> 00:16:28,740
go and move to the victim so

476
00:16:28,740 --> 00:16:30,600
from a certain perspective this is the

477
00:16:30,600 --> 00:16:33,120
least sensitive uh but it's the one

478
00:16:33,120 --> 00:16:34,260
that's going to enable the actor to do

479
00:16:34,260 --> 00:16:36,360
anything in the first place so still

480
00:16:36,360 --> 00:16:39,060
very important to to find it

481
00:16:39,060 --> 00:16:42,600
the second one is uh for cold call

482
00:16:42,600 --> 00:16:44,759
as I was mentioning this one is more it

483
00:16:44,759 --> 00:16:47,279
goes actually tries to do an attack so

484
00:16:47,279 --> 00:16:49,079
it has a capability to connect to the

485
00:16:49,079 --> 00:16:52,199
PLC again basically trying to to sign up

486
00:16:52,199 --> 00:16:54,600
to to use it and

487
00:16:54,600 --> 00:16:56,759
um basically well scan for devices and

488
00:16:56,759 --> 00:16:58,320
we mentioned something here very

489
00:16:58,320 --> 00:17:00,720
specific Echo structure X I'm going to

490
00:17:00,720 --> 00:17:02,279
pronounce it terrible I'm sorry my

491
00:17:02,279 --> 00:17:04,679
Spanglish Eco structure machine expert

492
00:17:04,679 --> 00:17:06,000
or some machine

493
00:17:06,000 --> 00:17:07,859
that is a protocol that is proprietary

494
00:17:07,859 --> 00:17:10,559
by Schneider Electric but what it's very

495
00:17:10,559 --> 00:17:12,540
interesting about this is that it it's

496
00:17:12,540 --> 00:17:14,459
based upon something that's called

497
00:17:14,459 --> 00:17:16,799
causes which is

498
00:17:16,799 --> 00:17:18,780
very difficult to explain sort of

499
00:17:18,780 --> 00:17:21,240
software suite that can that has many

500
00:17:21,240 --> 00:17:23,040
capabilities upon which you can build

501
00:17:23,040 --> 00:17:25,260
for interacting with controllers and

502
00:17:25,260 --> 00:17:27,720
that many products actually are using

503
00:17:27,720 --> 00:17:30,480
so by the fact that the actor develops

504
00:17:30,480 --> 00:17:32,100
this malware with the capability to

505
00:17:32,100 --> 00:17:33,900
interact with this Echo structure and

506
00:17:33,900 --> 00:17:36,900
whatnot it also means that it might be

507
00:17:36,900 --> 00:17:38,520
effective with other controllers that we

508
00:17:38,520 --> 00:17:40,679
are not mentioning here and or to be

509
00:17:40,679 --> 00:17:42,240
expanded to interact for example with

510
00:17:42,240 --> 00:17:44,340
other type of codecious components which

511
00:17:44,340 --> 00:17:46,320
in a minute you're going to see how how

512
00:17:46,320 --> 00:17:48,900
large that is

513
00:17:48,900 --> 00:17:51,299
um the other thing is it is it can

514
00:17:51,299 --> 00:17:52,860
basically mimic what we call here

515
00:17:52,860 --> 00:17:55,860
workstation so workstation in in plane

516
00:17:55,860 --> 00:17:58,020
plane version is our fancy name for

517
00:17:58,020 --> 00:17:59,700
saying a computer but basically a

518
00:17:59,700 --> 00:18:01,440
computer that interacts with your PLC

519
00:18:01,440 --> 00:18:03,960
and that tells you what to do can gather

520
00:18:03,960 --> 00:18:06,780
and push information execute code

521
00:18:06,780 --> 00:18:08,340
um so basically it can mimic that

522
00:18:08,340 --> 00:18:10,740
workstation interact with the PLC and

523
00:18:10,740 --> 00:18:12,179
then uh it has a couple of attack

524
00:18:12,179 --> 00:18:14,100
commands we mentioned here the envelope

525
00:18:14,100 --> 00:18:16,380
service it can break it and uh basically

526
00:18:16,380 --> 00:18:19,080
delete data uh those that's actually

527
00:18:19,080 --> 00:18:20,640
interesting because it's already

528
00:18:20,640 --> 00:18:22,980
basically owns it can already interact

529
00:18:22,980 --> 00:18:24,840
with the PLC but also it's trying to

530
00:18:24,840 --> 00:18:27,480
disrupt its functioning so it might give

531
00:18:27,480 --> 00:18:30,480
you that idea by seeing how broad the

532
00:18:30,480 --> 00:18:32,880
capabilities are that what the actor is

533
00:18:32,880 --> 00:18:34,799
building is not something for once or

534
00:18:34,799 --> 00:18:37,440
for a specific case but rather they want

535
00:18:37,440 --> 00:18:39,000
to be prepared they want to be able to

536
00:18:39,000 --> 00:18:41,460
just modify something or photologic they

537
00:18:41,460 --> 00:18:43,020
might just want to delete maybe I want

538
00:18:43,020 --> 00:18:45,179
to do a Dos you know it has all the

539
00:18:45,179 --> 00:18:46,740
different capabilities which normally we

540
00:18:46,740 --> 00:18:50,520
don't see for Control Systems malware

541
00:18:50,520 --> 00:18:52,260
if you're wondering how these devices

542
00:18:52,260 --> 00:18:54,000
look like like when we say it's fairly

543
00:18:54,000 --> 00:18:56,280
specific it's because it is there are a

544
00:18:56,280 --> 00:18:58,320
couple boxes that we have in here these

545
00:18:58,320 --> 00:19:00,539
were the specific devices that we saw

546
00:19:00,539 --> 00:19:02,700
referenced in the code

547
00:19:02,700 --> 00:19:04,980
um what's interesting for example is uh

548
00:19:04,980 --> 00:19:08,880
mainly there was a module for the tm251

549
00:19:08,880 --> 00:19:10,860
but it had some mentions for the others

550
00:19:10,860 --> 00:19:13,799
particularly the tm258 for example there

551
00:19:13,799 --> 00:19:16,080
were some hard-coded credentials

552
00:19:16,080 --> 00:19:17,400
basically trying to use some some

553
00:19:17,400 --> 00:19:20,280
username and the reason why this is also

554
00:19:20,280 --> 00:19:22,620
interesting is it's almost even

555
00:19:22,620 --> 00:19:24,900
difficult to understand what what they

556
00:19:24,900 --> 00:19:26,120
were actually meaning to do in here

557
00:19:26,120 --> 00:19:29,280
because for example that username is

558
00:19:29,280 --> 00:19:31,380
actually comes from an older version of

559
00:19:31,380 --> 00:19:33,900
the tm251 so you start talking with the

560
00:19:33,900 --> 00:19:36,360
vendor and even they were like you know

561
00:19:36,360 --> 00:19:38,280
I don't know what maybe they were they

562
00:19:38,280 --> 00:19:39,600
maybe they were just working on a lab

563
00:19:39,600 --> 00:19:41,100
environment and there was no target at

564
00:19:41,100 --> 00:19:42,900
all and that's just what they had and

565
00:19:42,900 --> 00:19:44,280
they're trying to figure it out the same

566
00:19:44,280 --> 00:19:46,440
way or maybe they saw this in a specific

567
00:19:46,440 --> 00:19:48,120
environment and there's a specific

568
00:19:48,120 --> 00:19:50,700
Target that might be using these type of

569
00:19:50,700 --> 00:19:53,640
of credentials who knows it's just that

570
00:19:53,640 --> 00:19:55,380
is what we what we identified so we can

571
00:19:55,380 --> 00:19:57,059
make reference to some specific assets

572
00:19:57,059 --> 00:20:00,918
based on the module that they have

573
00:20:01,200 --> 00:20:03,059
um as I mentioned a second ago the one

574
00:20:03,059 --> 00:20:04,500
of the interesting things is the cold

575
00:20:04,500 --> 00:20:07,679
csv3 that upon which Echo structure is

576
00:20:07,679 --> 00:20:10,080
is built which means that other devices

577
00:20:10,080 --> 00:20:11,520
can also

578
00:20:11,520 --> 00:20:13,620
um you know be targeted to this malware

579
00:20:13,620 --> 00:20:16,200
in the same with models uh if you're

580
00:20:16,200 --> 00:20:17,940
familiar with models protocol that's

581
00:20:17,940 --> 00:20:19,860
actually one of the

582
00:20:19,860 --> 00:20:21,840
I would say one of the if not the most

583
00:20:21,840 --> 00:20:24,200
popular used for Industrial

584
00:20:24,200 --> 00:20:26,760
Communications and well the fact that it

585
00:20:26,760 --> 00:20:28,200
uses modbus even though it doesn't use

586
00:20:28,200 --> 00:20:29,640
it for attack but just to communicate

587
00:20:29,640 --> 00:20:31,320
with the PLC means that it can

588
00:20:31,320 --> 00:20:33,960
communicate lightly with other plcs you

589
00:20:33,960 --> 00:20:35,460
might do small changes in the code but

590
00:20:35,460 --> 00:20:37,500
the point is it has a capability to

591
00:20:37,500 --> 00:20:39,780
expand

592
00:20:39,780 --> 00:20:42,900
now I we decided to add a bit more of

593
00:20:42,900 --> 00:20:44,640
coaches in this in this case because we

594
00:20:44,640 --> 00:20:45,780
realized that it's actually quite

595
00:20:45,780 --> 00:20:48,360
mysterious if you go right now and try

596
00:20:48,360 --> 00:20:50,160
to understand it's pretty much in depth

597
00:20:50,160 --> 00:20:51,600
it might be a bit tricky actually

598
00:20:51,600 --> 00:20:53,039
because obviously it's something

599
00:20:53,039 --> 00:20:54,660
proprietary it's not open and whatnot

600
00:20:54,660 --> 00:20:57,299
and there is only one paper that I'm

601
00:20:57,299 --> 00:20:59,520
aware of from Kaspersky where actually

602
00:20:59,520 --> 00:21:01,320
they reverse engineered everything they

603
00:21:01,320 --> 00:21:03,299
were explaining everything and of course

604
00:21:03,299 --> 00:21:05,100
the vendor was like hey guys what are

605
00:21:05,100 --> 00:21:06,780
you doing come on this is not nice and

606
00:21:06,780 --> 00:21:08,940
now it's all reductive basically so you

607
00:21:08,940 --> 00:21:10,140
can read a couple lines and everything

608
00:21:10,140 --> 00:21:12,000
is you know it looks almost like a like

609
00:21:12,000 --> 00:21:14,340
a government document

610
00:21:14,340 --> 00:21:17,820
um so basically uh yeah it's difficult

611
00:21:17,820 --> 00:21:19,799
to to know about it so we wanted to do

612
00:21:19,799 --> 00:21:21,480
some research and share a bit of the

613
00:21:21,480 --> 00:21:22,740
awareness about the implications of

614
00:21:22,740 --> 00:21:25,320
these are this is this diagram is

615
00:21:25,320 --> 00:21:27,539
something that you're going to see more

616
00:21:27,539 --> 00:21:28,980
or less how it works basically you have

617
00:21:28,980 --> 00:21:30,419
your engineering workstation you have

618
00:21:30,419 --> 00:21:32,400
your machine it might be running courses

619
00:21:32,400 --> 00:21:34,320
uh the development system like I was

620
00:21:34,320 --> 00:21:36,120
saying it's it's more like a software

621
00:21:36,120 --> 00:21:37,380
suite where you can develop different

622
00:21:37,380 --> 00:21:39,600
capabilities to have a machine interface

623
00:21:39,600 --> 00:21:41,400
to interact with your PLC to push

624
00:21:41,400 --> 00:21:43,500
information from your machine and

625
00:21:43,500 --> 00:21:45,360
basically yeah this would be interacting

626
00:21:45,360 --> 00:21:47,640
with the plcs and then the plcs uh

627
00:21:47,640 --> 00:21:49,440
directly with the again sensors of

628
00:21:49,440 --> 00:21:51,900
Traders the the common uh structure that

629
00:21:51,900 --> 00:21:54,600
we have uh but yeah basically what's

630
00:21:54,600 --> 00:21:56,640
very interesting about coaches is uh if

631
00:21:56,640 --> 00:21:58,200
you actually go and just look for public

632
00:21:58,200 --> 00:21:59,400
information

633
00:21:59,400 --> 00:22:01,860
this is actually what what they have

634
00:22:01,860 --> 00:22:04,200
so what they uh have mentioned is that

635
00:22:04,200 --> 00:22:06,179
you can see here I mean this is

636
00:22:06,179 --> 00:22:07,679
obviously is from the vendor I call

637
00:22:07,679 --> 00:22:09,720
directly in there they mentioned here

638
00:22:09,720 --> 00:22:12,360
several million compatible devices is

639
00:22:12,360 --> 00:22:14,700
that true yes or not most likely yes and

640
00:22:14,700 --> 00:22:16,620
that's the point that actually when

641
00:22:16,620 --> 00:22:18,299
you're developing capabilities to

642
00:22:18,299 --> 00:22:20,340
interact with these type of um

643
00:22:20,340 --> 00:22:21,960
I'm going to say again software

644
00:22:21,960 --> 00:22:24,000
development environments

645
00:22:24,000 --> 00:22:24,780
um

646
00:22:24,780 --> 00:22:26,820
you can actually have the potential to

647
00:22:26,820 --> 00:22:29,159
go and impact more devices because also

648
00:22:29,159 --> 00:22:31,140
oftentimes coaches might be running on

649
00:22:31,140 --> 00:22:33,659
devices without you knowing it you know

650
00:22:33,659 --> 00:22:34,919
when you buy one of these products they

651
00:22:34,919 --> 00:22:36,600
don't tell you we built a b and c and

652
00:22:36,600 --> 00:22:37,860
it's based on this vendor and this

653
00:22:37,860 --> 00:22:39,539
vendor and this vendor it will be almost

654
00:22:39,539 --> 00:22:41,520
impossible to track mainly it might be

655
00:22:41,520 --> 00:22:43,559
big machinery you can't really track all

656
00:22:43,559 --> 00:22:44,880
of that so it's one of the big

657
00:22:44,880 --> 00:22:46,020
challenges from a supply chain

658
00:22:46,020 --> 00:22:48,120
perspective and actually this has

659
00:22:48,120 --> 00:22:49,919
triggered some industry talks of like

660
00:22:49,919 --> 00:22:51,960
hey you know what are we going to do can

661
00:22:51,960 --> 00:22:54,200
we start tracking this type of

662
00:22:54,200 --> 00:22:55,860
implementation you know different

663
00:22:55,860 --> 00:22:58,080
products upon each other

664
00:22:58,080 --> 00:23:00,539
but yeah so that is the impact that we

665
00:23:00,539 --> 00:23:02,820
see from Coco

666
00:23:02,820 --> 00:23:04,980
and I will go to the third one I'm sure

667
00:23:04,980 --> 00:23:07,500
was also very interesting because when

668
00:23:07,500 --> 00:23:10,140
you think of uh you know the specific

669
00:23:10,140 --> 00:23:12,000
industrial vendors

670
00:23:12,000 --> 00:23:14,280
Omron is not the first one that comes to

671
00:23:14,280 --> 00:23:15,299
your mind

672
00:23:15,299 --> 00:23:16,740
um like there are others like like

673
00:23:16,740 --> 00:23:18,059
Schneider you know like we've seen

674
00:23:18,059 --> 00:23:19,500
Siemens you know like the ones are like

675
00:23:19,500 --> 00:23:22,320
like the largest like by by market and

676
00:23:22,320 --> 00:23:23,340
this time they decided to go

677
00:23:23,340 --> 00:23:26,280
specifically for for for this um for

678
00:23:26,280 --> 00:23:27,299
these type of controllers from from

679
00:23:27,299 --> 00:23:28,860
Omron

680
00:23:28,860 --> 00:23:31,500
what's interesting in this code is what

681
00:23:31,500 --> 00:23:33,419
it does is it has well first of all it

682
00:23:33,419 --> 00:23:35,340
works with different protocols um the

683
00:23:35,340 --> 00:23:37,620
first one is fins Omron fins it's

684
00:23:37,620 --> 00:23:40,020
proprietary and what it does it it goes

685
00:23:40,020 --> 00:23:41,280
and actually tries to search for any

686
00:23:41,280 --> 00:23:44,880
plcs by pulling them using fins if

687
00:23:44,880 --> 00:23:46,440
you're curious about that yes you can

688
00:23:46,440 --> 00:23:49,799
find Finn's uh in the internet if you do

689
00:23:49,799 --> 00:23:51,299
show that on Google Docs or whatever is

690
00:23:51,299 --> 00:23:54,480
your favorite you can find some of this

691
00:23:54,480 --> 00:23:56,820
um so first of all it looks via fins

692
00:23:56,820 --> 00:23:59,159
and then once it finds specifically well

693
00:23:59,159 --> 00:24:00,780
it looks for a specific devices it

694
00:24:00,780 --> 00:24:02,460
basically queries based on Mac address

695
00:24:02,460 --> 00:24:05,039
that it has to be the devices they want

696
00:24:05,039 --> 00:24:07,320
and once it finds it what it tries to do

697
00:24:07,320 --> 00:24:11,220
is is it enables you to connect via HTTP

698
00:24:11,220 --> 00:24:14,280
and also turn on Port 23 telnet

699
00:24:14,280 --> 00:24:16,380
basically so that you basically it

700
00:24:16,380 --> 00:24:18,780
enables you to uh communicate fully with

701
00:24:18,780 --> 00:24:21,240
the device it's basically getting access

702
00:24:21,240 --> 00:24:23,940
it also has like in cold call it has

703
00:24:23,940 --> 00:24:25,679
some additional let's say disruptive

704
00:24:25,679 --> 00:24:27,900
type of capabilities they might or might

705
00:24:27,900 --> 00:24:29,640
not have to use them but you know it

706
00:24:29,640 --> 00:24:31,620
contains them and another interesting

707
00:24:31,620 --> 00:24:33,480
thing here is uh the server server

708
00:24:33,480 --> 00:24:36,059
module uh read write data

709
00:24:36,059 --> 00:24:39,600
what is a Servo Servo is basically I'm

710
00:24:39,600 --> 00:24:41,580
going to say like a very precise type of

711
00:24:41,580 --> 00:24:43,860
motor or basically a very precise type

712
00:24:43,860 --> 00:24:46,320
of small appliance and what it does is

713
00:24:46,320 --> 00:24:47,880
basically it enables you to have very

714
00:24:47,880 --> 00:24:49,740
precise motion for something you want to

715
00:24:49,740 --> 00:24:51,360
do possibly for example for Automation

716
00:24:51,360 --> 00:24:53,580
in a factory or whatnot

717
00:24:53,580 --> 00:24:56,100
and the point is they went specifically

718
00:24:56,100 --> 00:24:58,200
well they included in in one of their

719
00:24:58,200 --> 00:25:00,960
modules these uh capability to go for

720
00:25:00,960 --> 00:25:05,340
this Servo R8 HD I 1 sn10f blah blah

721
00:25:05,340 --> 00:25:06,840
blah so sorry that I didn't remember

722
00:25:06,840 --> 00:25:09,960
that right uh but the point for that is

723
00:25:09,960 --> 00:25:13,799
there if I recall well I think like 22

724
00:25:13,799 --> 00:25:16,860
different versions of the R8 HD and

725
00:25:16,860 --> 00:25:18,659
specifically they decided to go for this

726
00:25:18,659 --> 00:25:19,440
one

727
00:25:19,440 --> 00:25:21,720
so that's again what makes you think

728
00:25:21,720 --> 00:25:23,700
maybe there is a specific victim or

729
00:25:23,700 --> 00:25:26,039
maybe there's a laugh behind but they

730
00:25:26,039 --> 00:25:28,020
had very specific thing in mind

731
00:25:28,020 --> 00:25:29,820
and the idea is the other thing they had

732
00:25:29,820 --> 00:25:33,240
was um this NJ 501 and X1 P2

733
00:25:33,240 --> 00:25:35,340
what we did or well actually what like

734
00:25:35,340 --> 00:25:38,100
like our our malware analysts did

735
00:25:38,100 --> 00:25:40,260
is that they went back and started

736
00:25:40,260 --> 00:25:42,900
looking into this uh specific um

737
00:25:42,900 --> 00:25:45,779
controllers and they started trying to

738
00:25:45,779 --> 00:25:47,400
check like okay well which ones

739
00:25:47,400 --> 00:25:49,559
communicate the HTTP because it's not

740
00:25:49,559 --> 00:25:51,659
all all the range naturally in control

741
00:25:51,659 --> 00:25:53,880
systems and we were only able to

742
00:25:53,880 --> 00:25:56,400
identify these two ranges for NX and J

743
00:25:56,400 --> 00:25:58,500
series that have many different types of

744
00:25:58,500 --> 00:26:01,440
controllers so for now our theory is

745
00:26:01,440 --> 00:26:03,659
that basically the malware is targeting

746
00:26:03,659 --> 00:26:05,640
this full series and you know we know

747
00:26:05,640 --> 00:26:07,919
that this this particular cases were

748
00:26:07,919 --> 00:26:09,419
included in the

749
00:26:09,419 --> 00:26:11,760
in the malware basically

750
00:26:11,760 --> 00:26:13,620
um there might be more though you know

751
00:26:13,620 --> 00:26:15,480
finding this documentation from the

752
00:26:15,480 --> 00:26:17,820
vendors is not easy obviously they are

753
00:26:17,820 --> 00:26:19,620
not just making it public everywhere so

754
00:26:19,620 --> 00:26:21,659
it takes a bit of skills Dorking

755
00:26:21,659 --> 00:26:23,340
searching around and we find the manuals

756
00:26:23,340 --> 00:26:25,260
and start taking a look uh later during

757
00:26:25,260 --> 00:26:26,460
the detections you're going to see some

758
00:26:26,460 --> 00:26:28,200
more some more of that that looking

759
00:26:28,200 --> 00:26:30,360
around

760
00:26:30,360 --> 00:26:32,760
as I mentioned omgel main protocol is

761
00:26:32,760 --> 00:26:35,039
HTTP that's one of the most interesting

762
00:26:35,039 --> 00:26:37,860
things uh yeah because it's you know

763
00:26:37,860 --> 00:26:39,840
fairly common so again it's only going

764
00:26:39,840 --> 00:26:41,820
to use fins to find the controllers it's

765
00:26:41,820 --> 00:26:45,659
going to use HTTP to start interacting

766
00:26:45,659 --> 00:26:48,779
and finally for us as for the details of

767
00:26:48,779 --> 00:26:50,460
the of the malware these are the other

768
00:26:50,460 --> 00:26:53,220
two uh small pieces or components that I

769
00:26:53,220 --> 00:26:54,720
mentioned in the beginning that

770
00:26:54,720 --> 00:26:56,520
purposefully again I'm not getting super

771
00:26:56,520 --> 00:26:58,980
into we just add them there for context

772
00:26:58,980 --> 00:27:00,539
because they seem to be related

773
00:27:00,539 --> 00:27:02,640
positively it's possible that the actor

774
00:27:02,640 --> 00:27:04,380
is going to use this either for this or

775
00:27:04,380 --> 00:27:06,000
another attack but you know it's

776
00:27:06,000 --> 00:27:08,039
basically a regular bacter uh exploiting

777
00:27:08,039 --> 00:27:10,260
a vulnerability uh there's one of these

778
00:27:10,260 --> 00:27:11,880
drivers for example is often used in

779
00:27:11,880 --> 00:27:14,880
machines that can't that are used for

780
00:27:14,880 --> 00:27:16,260
example for machine interfaces

781
00:27:16,260 --> 00:27:20,400
industrial purposes but it is unclear I

782
00:27:20,400 --> 00:27:22,679
would definitely the focus from from our

783
00:27:22,679 --> 00:27:24,299
perspective from industrial is

784
00:27:24,299 --> 00:27:27,299
definitely on the other three tools

785
00:27:27,299 --> 00:27:30,059
so now we understand all the malware we

786
00:27:30,059 --> 00:27:31,620
understand the concept we know where in

787
00:27:31,620 --> 00:27:34,860
controller came from now a bit of the we

788
00:27:34,860 --> 00:27:36,900
can get you know our teen hats and start

789
00:27:36,900 --> 00:27:38,940
getting up in the in the discussions of

790
00:27:38,940 --> 00:27:40,320
what does this mean where is it coming

791
00:27:40,320 --> 00:27:42,360
from

792
00:27:42,360 --> 00:27:44,460
the first one in controller

793
00:27:44,460 --> 00:27:47,340
very likely State sponsor

794
00:27:47,340 --> 00:27:49,080
given the complexity of the malware

795
00:27:49,080 --> 00:27:50,279
that's that's the first thing that we're

796
00:27:50,279 --> 00:27:51,480
going to say the malware is super

797
00:27:51,480 --> 00:27:53,520
complex as we said it has a ton of

798
00:27:53,520 --> 00:27:56,220
different components that basically it's

799
00:27:56,220 --> 00:27:57,600
something that you can't just sit down

800
00:27:57,600 --> 00:27:59,340
grab a cup of coffee and do on your own

801
00:27:59,340 --> 00:28:01,380
you might need knowledge about different

802
00:28:01,380 --> 00:28:03,000
different components about different

803
00:28:03,000 --> 00:28:05,940
vendors about uh how those factory work

804
00:28:05,940 --> 00:28:08,460
about how am I going to deploy this and

805
00:28:08,460 --> 00:28:09,960
basically this requires a ton of

806
00:28:09,960 --> 00:28:12,299
resources uh and you know we can

807
00:28:12,299 --> 00:28:14,220
validate it simply by all the resources

808
00:28:14,220 --> 00:28:16,020
it takes from us to go and look into

809
00:28:16,020 --> 00:28:18,360
this when I said in the beginning that

810
00:28:18,360 --> 00:28:20,100
our team threw everything you know to

811
00:28:20,100 --> 00:28:21,659
the ground and started doing this I

812
00:28:21,659 --> 00:28:23,100
really mean it like the work you're

813
00:28:23,100 --> 00:28:24,360
seeing here is nothing that I was doing

814
00:28:24,360 --> 00:28:26,460
on my own is nothing that Ken was doing

815
00:28:26,460 --> 00:28:28,559
on his own is something that all of our

816
00:28:28,559 --> 00:28:30,539
team was doing together and we were just

817
00:28:30,539 --> 00:28:33,659
adding in the different pieces

818
00:28:33,659 --> 00:28:35,340
um and yeah well in the end we come with

819
00:28:35,340 --> 00:28:37,080
this very very precise very precise

820
00:28:37,080 --> 00:28:38,220
information

821
00:28:38,220 --> 00:28:40,260
now the other thing is in controller

822
00:28:40,260 --> 00:28:41,880
does not

823
00:28:41,880 --> 00:28:45,419
we did not find any overlaps in in code

824
00:28:45,419 --> 00:28:46,980
that we did not find any overlaps and

825
00:28:46,980 --> 00:28:48,779
similarities anything with any other

826
00:28:48,779 --> 00:28:50,279
malware we had seen before

827
00:28:50,279 --> 00:28:53,460
so again this does not help us from an

828
00:28:53,460 --> 00:28:54,840
attribution perspective

829
00:28:54,840 --> 00:28:56,880
the fact that there's a lack of victims

830
00:28:56,880 --> 00:28:58,559
that the known victims at the moment

831
00:28:58,559 --> 00:29:00,120
that is another thing that makes it

832
00:29:00,120 --> 00:29:02,520
difficult but we have limited

833
00:29:02,520 --> 00:29:04,620
circumstantial evidence that that points

834
00:29:04,620 --> 00:29:06,720
toward like like Russian Nexus and I

835
00:29:06,720 --> 00:29:09,360
highlight it is super circumstantial we

836
00:29:09,360 --> 00:29:10,740
have a couple extra details that

837
00:29:10,740 --> 00:29:13,799
unfortunately we cannot present but the

838
00:29:13,799 --> 00:29:16,200
big thing like that I'm gonna leave from

839
00:29:16,200 --> 00:29:17,460
the attribution perspective is more like

840
00:29:17,460 --> 00:29:19,620
it's your choice you decide where it

841
00:29:19,620 --> 00:29:21,960
comes from if it makes sense if not

842
00:29:21,960 --> 00:29:23,820
but we decided to make it you know kind

843
00:29:23,820 --> 00:29:25,740
of like more interactive with uh an

844
00:29:25,740 --> 00:29:28,380
actual timeline of what we have seen uh

845
00:29:28,380 --> 00:29:30,179
from an OT perspective like where the

846
00:29:30,179 --> 00:29:32,279
interest has been coming from what are

847
00:29:32,279 --> 00:29:34,200
the cases we've been observing

848
00:29:34,200 --> 00:29:36,899
if you realize uh actually most of these

849
00:29:36,899 --> 00:29:39,000
cases overlap with the first slide with

850
00:29:39,000 --> 00:29:40,679
the historical things basically we have

851
00:29:40,679 --> 00:29:43,020
Triton we have the

852
00:29:43,020 --> 00:29:43,740
um

853
00:29:43,740 --> 00:29:47,820
uh outages in Ukraine and um I mentioned

854
00:29:47,820 --> 00:29:49,559
also the first one the peace pipe that

855
00:29:49,559 --> 00:29:51,600
was basically a reconnaissance for OT

856
00:29:51,600 --> 00:29:55,200
particularly OPC similar to tag run

857
00:29:55,200 --> 00:29:57,480
some extra in here that's interesting

858
00:29:57,480 --> 00:29:59,940
2017 temp isotope that's another

859
00:29:59,940 --> 00:30:01,140
interesting one that we haven't

860
00:30:01,140 --> 00:30:02,700
mentioned but it was reconnaissance

861
00:30:02,700 --> 00:30:07,020
campaign in energy facilities again in

862
00:30:07,020 --> 00:30:08,460
that case we actually attributed to

863
00:30:08,460 --> 00:30:10,320
specific actors that case for example

864
00:30:10,320 --> 00:30:12,179
was very interesting because you can ask

865
00:30:12,179 --> 00:30:13,620
me how did you know that they are

866
00:30:13,620 --> 00:30:15,840
interested in OT well we know because we

867
00:30:15,840 --> 00:30:17,580
actually reproduced some of the data

868
00:30:17,580 --> 00:30:19,260
that they pulled and it was actually

869
00:30:19,260 --> 00:30:21,840
basically a machine interface OT data

870
00:30:21,840 --> 00:30:23,460
and whatnot

871
00:30:23,460 --> 00:30:24,600
um and you know also the type of

872
00:30:24,600 --> 00:30:25,980
organizations that go by many other

873
00:30:25,980 --> 00:30:27,179
things

874
00:30:27,179 --> 00:30:30,240
and finally uh here the last one is

875
00:30:30,240 --> 00:30:32,580
actually when it got interesting again

876
00:30:32,580 --> 00:30:35,100
like 2022 the other case that I that I

877
00:30:35,100 --> 00:30:36,960
mentioned uh in the beginning I don't

878
00:30:36,960 --> 00:30:38,340
know if you remember in Destroyer second

879
00:30:38,340 --> 00:30:40,500
version that one we saw it also this

880
00:30:40,500 --> 00:30:42,779
year we haven't attributed either but

881
00:30:42,779 --> 00:30:44,580
it's exactly the same code that was used

882
00:30:44,580 --> 00:30:47,520
by soundworm in uh 2016 for the outages

883
00:30:47,520 --> 00:30:49,799
they just literally popped one of the

884
00:30:49,799 --> 00:30:52,140
modules and tried to deploy and

885
00:30:52,140 --> 00:30:53,460
basically changed some IP address in

886
00:30:53,460 --> 00:30:54,240
there

887
00:30:54,240 --> 00:30:56,760
so this is actually where it becomes

888
00:30:56,760 --> 00:30:59,460
very interesting and then from a from a

889
00:30:59,460 --> 00:31:01,740
big picture perspective of ulti malware

890
00:31:01,740 --> 00:31:03,659
and it's the fact that what you have

891
00:31:03,659 --> 00:31:04,919
here is in controller is what we're

892
00:31:04,919 --> 00:31:06,360
discussing right now

893
00:31:06,360 --> 00:31:08,159
in the story of version 2 is a

894
00:31:08,159 --> 00:31:09,600
mysterious malware that we are not

895
00:31:09,600 --> 00:31:11,100
describing right now we're not going to

896
00:31:11,100 --> 00:31:13,380
get into that but what I wanted to

897
00:31:13,380 --> 00:31:14,820
highlight is that both cases that

898
00:31:14,820 --> 00:31:18,600
happened in 2022 also uh they they share

899
00:31:18,600 --> 00:31:20,399
a lot of these capabilities of what we

900
00:31:20,399 --> 00:31:22,799
said that was new in ultimalware which

901
00:31:22,799 --> 00:31:24,960
was the fact that uh for example if you

902
00:31:24,960 --> 00:31:26,640
want to run in controller you can just

903
00:31:26,640 --> 00:31:28,440
choose one of the modules you can

904
00:31:28,440 --> 00:31:29,520
probably change some of the devices

905
00:31:29,520 --> 00:31:31,440
focus on the ones you need for your

906
00:31:31,440 --> 00:31:33,899
Target if you want to use uh in

907
00:31:33,899 --> 00:31:35,880
Destroyer version 2 you switch the IP

908
00:31:35,880 --> 00:31:37,740
address you switch the path we publish

909
00:31:37,740 --> 00:31:39,659
the blog on that showing how they try to

910
00:31:39,659 --> 00:31:41,700
go after different victims so as you can

911
00:31:41,700 --> 00:31:43,679
tell both of them actually are going to

912
00:31:43,679 --> 00:31:46,020
be reusable both of them require an

913
00:31:46,020 --> 00:31:47,399
operator it's something that you just

914
00:31:47,399 --> 00:31:49,080
don't deploy and both of them are

915
00:31:49,080 --> 00:31:52,200
extensible industry version 2 shows how

916
00:31:52,200 --> 00:31:54,360
from an industry a very large very

917
00:31:54,360 --> 00:31:56,640
complex code like style in controller

918
00:31:56,640 --> 00:31:58,559
they could only pop one of the

919
00:31:58,559 --> 00:32:01,380
components and then deploy and try to to

920
00:32:01,380 --> 00:32:02,820
have you know a successful attack that

921
00:32:02,820 --> 00:32:04,860
gladly was was identified by Ukrainian

922
00:32:04,860 --> 00:32:06,960
government and whatnot before but you

923
00:32:06,960 --> 00:32:09,419
know it was possible it's exactly the

924
00:32:09,419 --> 00:32:11,399
same what we have within controller you

925
00:32:11,399 --> 00:32:13,620
can use it as all together or you can

926
00:32:13,620 --> 00:32:15,840
strip one of this and use it and build

927
00:32:15,840 --> 00:32:18,059
your own attack based on whatever your

928
00:32:18,059 --> 00:32:20,539
victim is

929
00:32:20,700 --> 00:32:23,220
the second thing is the attack scenarios

930
00:32:23,220 --> 00:32:25,679
for attack scenarios okay we have three

931
00:32:25,679 --> 00:32:27,720
things we were wondering what is it that

932
00:32:27,720 --> 00:32:29,159
the actor wants to do

933
00:32:29,159 --> 00:32:31,919
and we we order them actually in how we

934
00:32:31,919 --> 00:32:33,899
consider them to be of how sensitive

935
00:32:33,899 --> 00:32:35,399
they're considered to be

936
00:32:35,399 --> 00:32:37,440
and the first one is disrupt controllers

937
00:32:37,440 --> 00:32:40,020
shutdown operations

938
00:32:40,020 --> 00:32:41,640
recently there have been all this talk

939
00:32:41,640 --> 00:32:43,500
about for example ransomware cases right

940
00:32:43,500 --> 00:32:45,059
that someone deployed transfer

941
00:32:45,059 --> 00:32:47,399
industrial organization production goes

942
00:32:47,399 --> 00:32:48,360
down

943
00:32:48,360 --> 00:32:51,360
basically you lose money you lose some

944
00:32:51,360 --> 00:32:53,340
you can't deliver to your customers

945
00:32:53,340 --> 00:32:55,020
basically that's something that could be

946
00:32:55,020 --> 00:32:57,000
reproduced with this type of malware if

947
00:32:57,000 --> 00:32:58,559
you for example shut down some specific

948
00:32:58,559 --> 00:33:01,020
controllers uh you might for example use

949
00:33:01,020 --> 00:33:03,480
some of those capabilities to Dos or to

950
00:33:03,480 --> 00:33:06,120
crash or whatnot or you might simply you

951
00:33:06,120 --> 00:33:07,740
know modify how they are working in such

952
00:33:07,740 --> 00:33:09,480
a way that they force you to turn off

953
00:33:09,480 --> 00:33:12,240
operations and it might either take you

954
00:33:12,240 --> 00:33:14,279
a lot of time to bring them back or

955
00:33:14,279 --> 00:33:16,019
maybe it might mess up some of your your

956
00:33:16,019 --> 00:33:18,899
production or you know basically there

957
00:33:18,899 --> 00:33:20,820
are many different ways to do this

958
00:33:20,820 --> 00:33:22,919
the second one is sabotage

959
00:33:22,919 --> 00:33:24,600
and for sabotage we always think about

960
00:33:24,600 --> 00:33:27,419
this is this really theoretical uh I

961
00:33:27,419 --> 00:33:28,980
mean like I don't think there are many

962
00:33:28,980 --> 00:33:30,659
famous cases of something like that but

963
00:33:30,659 --> 00:33:32,820
uh sabotage basically we're talking

964
00:33:32,820 --> 00:33:34,500
about you know you have to be very

965
00:33:34,500 --> 00:33:36,120
precise with your production so what

966
00:33:36,120 --> 00:33:37,500
happens if I modify some of the

967
00:33:37,500 --> 00:33:38,700
parameters and you produce something

968
00:33:38,700 --> 00:33:40,679
that is not useful then you're basically

969
00:33:40,679 --> 00:33:42,360
going to mess up your batch and possibly

970
00:33:42,360 --> 00:33:44,039
your product depending on what the

971
00:33:44,039 --> 00:33:46,500
product is it's going to be more or less

972
00:33:46,500 --> 00:33:48,419
sensitive but in the end you know again

973
00:33:48,419 --> 00:33:49,500
a loss

974
00:33:49,500 --> 00:33:51,179
and the most relevant like which is

975
00:33:51,179 --> 00:33:52,440
always the most relevant for control

976
00:33:52,440 --> 00:33:54,960
systems and the worst case for a Cyber

977
00:33:54,960 --> 00:33:57,360
attack is basically physical destruction

978
00:33:57,360 --> 00:34:00,059
the point in here is if you modify how

979
00:34:00,059 --> 00:34:02,580
these controllers are working let's say

980
00:34:02,580 --> 00:34:03,960
in an informed way in which you know

981
00:34:03,960 --> 00:34:06,000
that it's going to affect the process

982
00:34:06,000 --> 00:34:07,860
then you might lead to physical

983
00:34:07,860 --> 00:34:10,260
destruction so to give an example it

984
00:34:10,260 --> 00:34:12,300
might be that this NX and J they have

985
00:34:12,300 --> 00:34:13,679
some controllers that I use for some

986
00:34:13,679 --> 00:34:16,020
safety functions so if you if you

987
00:34:16,020 --> 00:34:17,219
probably turn off one of those

988
00:34:17,219 --> 00:34:19,260
controllers for safety functions then

989
00:34:19,260 --> 00:34:20,879
you don't have that backup whenever a

990
00:34:20,879 --> 00:34:23,099
process changes then you force the

991
00:34:23,099 --> 00:34:24,480
process to change because you can also

992
00:34:24,480 --> 00:34:26,099
interact with the let's say in this case

993
00:34:26,099 --> 00:34:27,719
the cold cool ones the snap electric

994
00:34:27,719 --> 00:34:30,000
then you modify the process there is no

995
00:34:30,000 --> 00:34:32,280
safety behind basically that's how you

996
00:34:32,280 --> 00:34:34,020
would get to a physical destruction but

997
00:34:34,020 --> 00:34:36,119
again as you can tell all of this is you

998
00:34:36,119 --> 00:34:37,739
know it's kind of like in our brains how

999
00:34:37,739 --> 00:34:39,719
we try to do this analysis and it is

1000
00:34:39,719 --> 00:34:41,040
precisely because of how much

1001
00:34:41,040 --> 00:34:43,139
interaction it requires with the actor

1002
00:34:43,139 --> 00:34:45,659
really the tools are amazing it has a

1003
00:34:45,659 --> 00:34:47,460
lot of work behind but it's going to

1004
00:34:47,460 --> 00:34:48,839
definitely depend on the skills of the

1005
00:34:48,839 --> 00:34:51,359
actor and how they can use them

1006
00:34:51,359 --> 00:34:53,639
and then to begin on these attacks of

1007
00:34:53,639 --> 00:34:55,800
course it needs a picture that's where

1008
00:34:55,800 --> 00:34:58,320
Target would be tag run would be doing

1009
00:34:58,320 --> 00:35:01,140
basically fulfilling the purpose of uh

1010
00:35:01,140 --> 00:35:02,520
reconnaissance of gathering all the

1011
00:35:02,520 --> 00:35:04,560
information they need to be able to do

1012
00:35:04,560 --> 00:35:06,900
one of the scenarios that I was

1013
00:35:06,900 --> 00:35:09,680
discussing in a second

1014
00:35:09,839 --> 00:35:12,480
that is basically what we could do from

1015
00:35:12,480 --> 00:35:13,859
um yeah I didn't want to get that yet

1016
00:35:13,859 --> 00:35:16,200
but this is basically what we have from

1017
00:35:16,200 --> 00:35:17,880
from a tax in our perspective as you can

1018
00:35:17,880 --> 00:35:20,160
see three very concerning scenarios

1019
00:35:20,160 --> 00:35:23,400
and so until now that's basically what

1020
00:35:23,400 --> 00:35:24,839
we had built right now we want to add

1021
00:35:24,839 --> 00:35:26,460
some additional detail on hunting and

1022
00:35:26,460 --> 00:35:27,540
detections

1023
00:35:27,540 --> 00:35:30,060
uh parenthesis that image comes from one

1024
00:35:30,060 --> 00:35:32,579
of our peers for some reason he has 11

1025
00:35:32,579 --> 00:35:34,320
snakes no one knows why but they're

1026
00:35:34,320 --> 00:35:37,619
amazing and we always use these pictures

1027
00:35:37,619 --> 00:35:39,119
and this time on purpose we wanted to

1028
00:35:39,119 --> 00:35:40,320
bring that picture differently from the

1029
00:35:40,320 --> 00:35:42,839
cats that are just fun because right now

1030
00:35:42,839 --> 00:35:44,400
we actually want to focus on one point

1031
00:35:44,400 --> 00:35:46,859
uh on python actually it's going to be

1032
00:35:46,859 --> 00:35:48,599
one of our big topics right now for

1033
00:35:48,599 --> 00:35:51,960
detections something that basically is

1034
00:35:51,960 --> 00:35:54,599
not very common to observe in OT and the

1035
00:35:54,599 --> 00:35:56,579
review of service might actually give

1036
00:35:56,579 --> 00:35:58,440
you some hints of what the actor is

1037
00:35:58,440 --> 00:36:00,060
trying to do

1038
00:36:00,060 --> 00:36:01,619
so

1039
00:36:01,619 --> 00:36:02,760
okay

1040
00:36:02,760 --> 00:36:04,619
the first thing for hunting detection is

1041
00:36:04,619 --> 00:36:07,859
uh to know who has to do it who and why

1042
00:36:07,859 --> 00:36:09,540
because we are aware this is fairly

1043
00:36:09,540 --> 00:36:11,400
specific I know some of you might be

1044
00:36:11,400 --> 00:36:12,960
just learning about something different

1045
00:36:12,960 --> 00:36:15,240
and just never going to use this but

1046
00:36:15,240 --> 00:36:17,040
some of you that might ever run into it

1047
00:36:17,040 --> 00:36:18,660
or are already running into control

1048
00:36:18,660 --> 00:36:20,520
systems and trying to work with it

1049
00:36:20,520 --> 00:36:22,380
you're going to find it especially

1050
00:36:22,380 --> 00:36:25,380
useful so who has to care about this and

1051
00:36:25,380 --> 00:36:26,460
start thinking about thread hunting and

1052
00:36:26,460 --> 00:36:28,260
detections and whatnot first of course

1053
00:36:28,260 --> 00:36:30,960
any asset owners any any one of you that

1054
00:36:30,960 --> 00:36:32,280
works specifically with these type of

1055
00:36:32,280 --> 00:36:34,380
devices mainly if you see those type of

1056
00:36:34,380 --> 00:36:35,820
another electric if you're using the

1057
00:36:35,820 --> 00:36:37,320
protocols we mentioned the products we

1058
00:36:37,320 --> 00:36:39,780
mentioned that's you know the first use

1059
00:36:39,780 --> 00:36:42,720
case but the second one is of course if

1060
00:36:42,720 --> 00:36:44,280
you're curious maybe you have a good

1061
00:36:44,280 --> 00:36:45,660
sample of information you want to play

1062
00:36:45,660 --> 00:36:47,099
with it you want to see what there is

1063
00:36:47,099 --> 00:36:49,079
and what we're going to suggest in a

1064
00:36:49,079 --> 00:36:50,579
second is not only for in controller

1065
00:36:50,579 --> 00:36:52,380
it's for actually any type of ulti

1066
00:36:52,380 --> 00:36:55,140
malware so you know you might be able to

1067
00:36:55,140 --> 00:36:56,880
use it hopefully you'll find something

1068
00:36:56,880 --> 00:36:58,800
amazing and let us know

1069
00:36:58,800 --> 00:37:01,079
uh for challenges

1070
00:37:01,079 --> 00:37:02,820
challenges for this type of detections

1071
00:37:02,820 --> 00:37:04,800
though like like one thing to clarify is

1072
00:37:04,800 --> 00:37:07,079
first of all uh the three different

1073
00:37:07,079 --> 00:37:08,760
tools right like we're not talking about

1074
00:37:08,760 --> 00:37:10,320
just one single tool that we can go and

1075
00:37:10,320 --> 00:37:11,880
look for it we know there are different

1076
00:37:11,880 --> 00:37:13,619
they could be used together separate in

1077
00:37:13,619 --> 00:37:15,119
different parts at different levels of

1078
00:37:15,119 --> 00:37:16,440
an organization

1079
00:37:16,440 --> 00:37:18,960
so it's fairly chaotic to go and try to

1080
00:37:18,960 --> 00:37:20,160
identify

1081
00:37:20,160 --> 00:37:22,200
second thing is uh I mean yeah

1082
00:37:22,200 --> 00:37:24,599
presumably leveraged with itot so you're

1083
00:37:24,599 --> 00:37:26,220
going to have to see some of the of the

1084
00:37:26,220 --> 00:37:28,079
steps from the actor that might be using

1085
00:37:28,079 --> 00:37:30,480
entirely different tools that might come

1086
00:37:30,480 --> 00:37:32,220
from wherever you is expected that have

1087
00:37:32,220 --> 00:37:34,079
absolutely no relationship to this

1088
00:37:34,079 --> 00:37:36,420
and the other thing was uh the python

1089
00:37:36,420 --> 00:37:38,220
which starts coming in here

1090
00:37:38,220 --> 00:37:41,099
since the call is developing python it

1091
00:37:41,099 --> 00:37:43,140
can be deployed or executed in different

1092
00:37:43,140 --> 00:37:45,240
ways can come from a command line it can

1093
00:37:45,240 --> 00:37:48,060
come in the script uh it can come embed

1094
00:37:48,060 --> 00:37:50,820
it with something else so in this case

1095
00:37:50,820 --> 00:37:52,800
if you want to try and go and find it

1096
00:37:52,800 --> 00:37:54,480
you're going to have to focus instead on

1097
00:37:54,480 --> 00:37:58,320
the behaviors rather than itself on on

1098
00:37:58,320 --> 00:38:00,420
basically a sample even if you have all

1099
00:38:00,420 --> 00:38:01,740
the hashes for this it's not really

1100
00:38:01,740 --> 00:38:03,720
going to help you because most likely

1101
00:38:03,720 --> 00:38:05,160
when the attacker develops it which is

1102
00:38:05,160 --> 00:38:06,839
the other point in here they are going

1103
00:38:06,839 --> 00:38:09,060
to modify how it was how it developed is

1104
00:38:09,060 --> 00:38:10,619
already public and you can use it in

1105
00:38:10,619 --> 00:38:11,820
different ways and you can extend

1106
00:38:11,820 --> 00:38:13,619
depends the victim basically it is

1107
00:38:13,619 --> 00:38:15,300
fairly complicated to go and find a

1108
00:38:15,300 --> 00:38:17,820
precise match

1109
00:38:17,820 --> 00:38:19,980
so what to do about it

1110
00:38:19,980 --> 00:38:20,820
um

1111
00:38:20,820 --> 00:38:23,160
the first thing or how actually this is

1112
00:38:23,160 --> 00:38:25,560
uh I highlight once again this this last

1113
00:38:25,560 --> 00:38:27,660
portion is from from Ken's amazing work

1114
00:38:27,660 --> 00:38:30,540
what he was highlighting is that

1115
00:38:30,540 --> 00:38:31,800
um

1116
00:38:31,800 --> 00:38:33,599
what we want to do is sort of or

1117
00:38:33,599 --> 00:38:36,480
recommend is to set a tripwire

1118
00:38:36,480 --> 00:38:39,119
basically the idea is that oftentimes

1119
00:38:39,119 --> 00:38:40,800
when the actor comes and tries to

1120
00:38:40,800 --> 00:38:43,440
interact with the OT they're going to be

1121
00:38:43,440 --> 00:38:45,780
using very fairly common

1122
00:38:45,780 --> 00:38:47,820
um features let's say that in it are

1123
00:38:47,820 --> 00:38:48,900
very common you're going to see them

1124
00:38:48,900 --> 00:38:50,400
everywhere for example a pink if

1125
00:38:50,400 --> 00:38:51,780
someone's pinging around it could be

1126
00:38:51,780 --> 00:38:53,460
okay but if you're seeing that in your

1127
00:38:53,460 --> 00:38:54,900
controllers then it's going to be weird

1128
00:38:54,900 --> 00:38:57,900
and actually in these cases as we

1129
00:38:57,900 --> 00:38:59,400
mentioned a couple minutes ago both in

1130
00:38:59,400 --> 00:39:01,260
cold call and I'm chill the actor has

1131
00:39:01,260 --> 00:39:03,420
capabilities to do pink strips so if you

1132
00:39:03,420 --> 00:39:04,800
go and find those kind of like lazy

1133
00:39:04,800 --> 00:39:06,060
steps that they use for reconnaissance

1134
00:39:06,060 --> 00:39:08,160
for finding the details you know for

1135
00:39:08,160 --> 00:39:10,260
starting the attack you might be able to

1136
00:39:10,260 --> 00:39:12,720
identify the attack much earlier than

1137
00:39:12,720 --> 00:39:14,460
you know by the time they they get to

1138
00:39:14,460 --> 00:39:15,900
actually use it if they get to use it

1139
00:39:15,900 --> 00:39:18,300
you already lost so basically that's why

1140
00:39:18,300 --> 00:39:20,520
it's also so relevant so we focus here

1141
00:39:20,520 --> 00:39:23,400
on Behavior based another thing is uh

1142
00:39:23,400 --> 00:39:26,099
focus on Key Systems we mentioned here

1143
00:39:26,099 --> 00:39:28,020
what we mentioned what we refer by two

1144
00:39:28,020 --> 00:39:30,240
Key Systems is since we have all these

1145
00:39:30,240 --> 00:39:31,859
large organization all these different

1146
00:39:31,859 --> 00:39:33,599
areas where you have to look for for

1147
00:39:33,599 --> 00:39:35,460
data it can come with many different

1148
00:39:35,460 --> 00:39:37,380
tools and whatnot what we're suggesting

1149
00:39:37,380 --> 00:39:40,320
is to focus specifically on controllers

1150
00:39:40,320 --> 00:39:42,540
hmis and whatnot specifically that are

1151
00:39:42,540 --> 00:39:44,040
critical for the process

1152
00:39:44,040 --> 00:39:45,599
so as you're going to see when you're

1153
00:39:45,599 --> 00:39:47,099
talking about industrial it's not only

1154
00:39:47,099 --> 00:39:49,079
about the hunting itself but actually

1155
00:39:49,079 --> 00:39:51,000
you have to be very familiar with how

1156
00:39:51,000 --> 00:39:53,099
your process is running what devices

1157
00:39:53,099 --> 00:39:55,920
what is going on in there so I know that

1158
00:39:55,920 --> 00:39:57,359
this is a very big challenge at the

1159
00:39:57,359 --> 00:39:59,520
organizational level we always get into

1160
00:39:59,520 --> 00:40:01,320
those stocks with the different

1161
00:40:01,320 --> 00:40:03,060
organizations and whatnot but yeah

1162
00:40:03,060 --> 00:40:04,740
that's that's basically the way to go

1163
00:40:04,740 --> 00:40:06,660
for it so

1164
00:40:06,660 --> 00:40:08,820
that's why it's a challenge basically

1165
00:40:08,820 --> 00:40:10,260
and then finally

1166
00:40:10,260 --> 00:40:11,579
um collections for embedded devices

1167
00:40:11,579 --> 00:40:13,380
these actually my favorite in here

1168
00:40:13,380 --> 00:40:14,579
because

1169
00:40:14,579 --> 00:40:16,500
one of the things that we work a lot

1170
00:40:16,500 --> 00:40:18,660
with in OT is the fact that some of the

1171
00:40:18,660 --> 00:40:20,579
devices is not you don't you don't get

1172
00:40:20,579 --> 00:40:22,920
what you see you get what you see and

1173
00:40:22,920 --> 00:40:25,260
whatever it's inside it can it can be

1174
00:40:25,260 --> 00:40:27,000
running different types of software

1175
00:40:27,000 --> 00:40:28,980
firmware it can have different

1176
00:40:28,980 --> 00:40:31,260
components internally in a product

1177
00:40:31,260 --> 00:40:33,599
you're using and so working with these

1178
00:40:33,599 --> 00:40:34,859
type of embedded systems is often

1179
00:40:34,859 --> 00:40:36,800
difficult you also have like different

1180
00:40:36,800 --> 00:40:39,300
ways to communicate with them some of

1181
00:40:39,300 --> 00:40:40,800
them might you might only interact by

1182
00:40:40,800 --> 00:40:42,420
cable some of them you might have to go

1183
00:40:42,420 --> 00:40:44,760
and physically interact with them some

1184
00:40:44,760 --> 00:40:46,020
of them might have a software suite

1185
00:40:46,020 --> 00:40:48,060
there's just so much of a variety it's

1186
00:40:48,060 --> 00:40:49,680
not like like how you can interact with

1187
00:40:49,680 --> 00:40:51,839
your computer you have to go and learn

1188
00:40:51,839 --> 00:40:53,579
about each of them

1189
00:40:53,579 --> 00:40:55,140
and that is such a challenge that

1190
00:40:55,140 --> 00:40:57,300
actually uh in earlier this year we

1191
00:40:57,300 --> 00:40:59,520
presented this uh that's the dfir

1192
00:40:59,520 --> 00:41:01,500
framework for embedded OT systems for

1193
00:41:01,500 --> 00:41:03,839
mandians we presented this in S4

1194
00:41:03,839 --> 00:41:06,420
conference in uh January or February I

1195
00:41:06,420 --> 00:41:08,640
don't remember beginning of the year but

1196
00:41:08,640 --> 00:41:10,500
um basically what we were trying to do

1197
00:41:10,500 --> 00:41:12,300
is saying okay we know that you as an

1198
00:41:12,300 --> 00:41:13,619
organization are having a hard time

1199
00:41:13,619 --> 00:41:15,780
because all of these different products

1200
00:41:15,780 --> 00:41:17,280
that have different capabilities that

1201
00:41:17,280 --> 00:41:18,420
have you know that everything is

1202
00:41:18,420 --> 00:41:20,700
different in industrial so let's try to

1203
00:41:20,700 --> 00:41:23,339
put some order so that you are prepared

1204
00:41:23,339 --> 00:41:25,619
for whenever an IR comes or whenever a

1205
00:41:25,619 --> 00:41:27,420
thread hunting process comes and whatnot

1206
00:41:27,420 --> 00:41:29,460
so what we actually do is as you can see

1207
00:41:29,460 --> 00:41:30,839
here we have there the process for

1208
00:41:30,839 --> 00:41:32,579
incident response we focus on

1209
00:41:32,579 --> 00:41:34,440
Preparation and at the preparation level

1210
00:41:34,440 --> 00:41:36,960
we suggest three things the first one is

1211
00:41:36,960 --> 00:41:39,780
as simple as identifying what tool well

1212
00:41:39,780 --> 00:41:42,000
basically what you have what tools you

1213
00:41:42,000 --> 00:41:43,740
have to interact with it how do you get

1214
00:41:43,740 --> 00:41:45,359
access to that device

1215
00:41:45,359 --> 00:41:47,220
simple sounds simple of course there's a

1216
00:41:47,220 --> 00:41:48,900
ton of information the second one

1217
00:41:48,900 --> 00:41:50,460
collaborating with the equivalent

1218
00:41:50,460 --> 00:41:52,020
manufacturer so if you need more

1219
00:41:52,020 --> 00:41:54,180
information you need specific specific

1220
00:41:54,180 --> 00:41:56,640
tools whatever sometimes for example the

1221
00:41:56,640 --> 00:41:57,960
specific vendor might have tools to

1222
00:41:57,960 --> 00:41:59,160
interact with your controller quite

1223
00:41:59,160 --> 00:42:01,380
directly and you might as well take them

1224
00:42:01,380 --> 00:42:03,420
or otherwise invest 10 years in building

1225
00:42:03,420 --> 00:42:05,160
something and you know lots of money and

1226
00:42:05,160 --> 00:42:06,300
whatnot

1227
00:42:06,300 --> 00:42:09,000
and then finally data identification and

1228
00:42:09,000 --> 00:42:10,440
collection that's when you actually pull

1229
00:42:10,440 --> 00:42:12,180
the data you get some baselines you

1230
00:42:12,180 --> 00:42:13,800
start to set up everything that you need

1231
00:42:13,800 --> 00:42:15,480
so that whenever you see a change in how

1232
00:42:15,480 --> 00:42:17,339
your controller is working then you know

1233
00:42:17,339 --> 00:42:18,960
that there is something going on it is

1234
00:42:18,960 --> 00:42:21,720
not as obvious as you would do with the

1235
00:42:21,720 --> 00:42:23,940
other type of logging we'll have some

1236
00:42:23,940 --> 00:42:26,460
examples poked from the internet but uh

1237
00:42:26,460 --> 00:42:28,500
bare minimum

1238
00:42:28,500 --> 00:42:30,359
so if you're curious this is a block you

1239
00:42:30,359 --> 00:42:32,400
can go and find the the specific

1240
00:42:32,400 --> 00:42:34,980
framework but we did what we did for

1241
00:42:34,980 --> 00:42:37,320
this is actually use a framework this is

1242
00:42:37,320 --> 00:42:38,480
the first step

1243
00:42:38,480 --> 00:42:41,760
and basically in this case what we try

1244
00:42:41,760 --> 00:42:44,339
to supply this for uh for the

1245
00:42:44,339 --> 00:42:46,260
specification controller by separating

1246
00:42:46,260 --> 00:42:48,420
the three different uh tools that we

1247
00:42:48,420 --> 00:42:49,079
have

1248
00:42:49,079 --> 00:42:51,000
in the tools if you mentioned if you

1249
00:42:51,000 --> 00:42:52,500
realize that we have in this case it's

1250
00:42:52,500 --> 00:42:54,480
kind of hypothetical obviously it would

1251
00:42:54,480 --> 00:42:55,980
be specific for a specific environment

1252
00:42:55,980 --> 00:42:58,079
but we separate first on what are the

1253
00:42:58,079 --> 00:43:00,000
assets we including the assets the

1254
00:43:00,000 --> 00:43:01,500
specific ones that we should targeted

1255
00:43:01,500 --> 00:43:03,900
and the first one we have OPC endpoint

1256
00:43:03,900 --> 00:43:06,660
servers basically this First Column is

1257
00:43:06,660 --> 00:43:09,240
what can in controller Touch where can

1258
00:43:09,240 --> 00:43:11,160
it be where can it have an effect

1259
00:43:11,160 --> 00:43:13,380
the second column is the data that you

1260
00:43:13,380 --> 00:43:15,540
can look at in this case for example

1261
00:43:15,540 --> 00:43:16,980
we're suggesting tools and methods to

1262
00:43:16,980 --> 00:43:20,940
gather these Yarns and Garris North I

1263
00:43:20,940 --> 00:43:22,319
think we have some examples with sisman

1264
00:43:22,319 --> 00:43:25,500
just because it's uh free it's simple

1265
00:43:25,500 --> 00:43:28,440
it's easy we love it but basically you

1266
00:43:28,440 --> 00:43:29,579
know you can use whatever you have

1267
00:43:29,579 --> 00:43:32,660
internally for example for OPC

1268
00:43:32,660 --> 00:43:34,920
it depends on what you're using if

1269
00:43:34,920 --> 00:43:36,180
you're using for example a very popular

1270
00:43:36,180 --> 00:43:39,720
one is osisoft this work was based

1271
00:43:39,720 --> 00:43:41,819
mainly on that but you can have from

1272
00:43:41,819 --> 00:43:42,839
different vendors that have different

1273
00:43:42,839 --> 00:43:45,119
tools on how to pull the data what data

1274
00:43:45,119 --> 00:43:47,520
they have how do the logs look like and

1275
00:43:47,520 --> 00:43:49,260
uh well you can also go from logging for

1276
00:43:49,260 --> 00:43:52,560
Network traffic very similar

1277
00:43:52,560 --> 00:43:55,319
this is place the what what we just

1278
00:43:55,319 --> 00:43:56,760
mentioned but plays kind of like we

1279
00:43:56,760 --> 00:43:58,920
started looking at the organizational

1280
00:43:58,920 --> 00:44:01,260
level where would we looking for each of

1281
00:44:01,260 --> 00:44:03,420
different things this is basically just

1282
00:44:03,420 --> 00:44:05,579
like like keeping a high overview

1283
00:44:05,579 --> 00:44:09,119
and then we got into the specific four I

1284
00:44:09,119 --> 00:44:10,740
was just checking I'm good on time uh

1285
00:44:10,740 --> 00:44:12,359
then you go into the specifics for each

1286
00:44:12,359 --> 00:44:14,819
of these each of these different levels

1287
00:44:14,819 --> 00:44:17,339
so first

1288
00:44:17,339 --> 00:44:19,619
that was the the first point for for

1289
00:44:19,619 --> 00:44:22,200
hunting these actually is a reference to

1290
00:44:22,200 --> 00:44:25,380
a to a I I don't know if saying terrible

1291
00:44:25,380 --> 00:44:27,060
or very good movie yet I have to watch

1292
00:44:27,060 --> 00:44:28,200
it

1293
00:44:28,200 --> 00:44:30,540
um but basically it refers anyway the

1294
00:44:30,540 --> 00:44:33,540
point is uh python what I was mentioning

1295
00:44:33,540 --> 00:44:35,819
a couple minutes ago python is not very

1296
00:44:35,819 --> 00:44:39,000
commonly seen in at the Industrial Level

1297
00:44:39,000 --> 00:44:40,440
it's something that probably there's no

1298
00:44:40,440 --> 00:44:41,880
reason for you to have your plant and if

1299
00:44:41,880 --> 00:44:43,800
you have it you should you're probably

1300
00:44:43,800 --> 00:44:47,040
aware of it so just by finding one of

1301
00:44:47,040 --> 00:44:48,780
these events where you identify that

1302
00:44:48,780 --> 00:44:50,760
there is any python activity you might

1303
00:44:50,760 --> 00:44:52,140
already be knowing that something like

1304
00:44:52,140 --> 00:44:53,640
this might be happening

1305
00:44:53,640 --> 00:44:56,220
it is it is actually you know like what

1306
00:44:56,220 --> 00:44:58,800
we have been seeing in in industrial

1307
00:44:58,800 --> 00:45:00,300
Marvel recently all of them have some

1308
00:45:00,300 --> 00:45:02,339
similarities and then these for example

1309
00:45:02,339 --> 00:45:04,319
because of how easy it is to to use

1310
00:45:04,319 --> 00:45:06,720
let's say to deploy then it's being used

1311
00:45:06,720 --> 00:45:09,480
by by actors for this type of malware so

1312
00:45:09,480 --> 00:45:11,040
if you find that activity that is

1313
00:45:11,040 --> 00:45:12,720
something that you might be wanting to

1314
00:45:12,720 --> 00:45:14,700
take a look at the image is not nothing

1315
00:45:14,700 --> 00:45:16,920
realistic like it's not in control of

1316
00:45:16,920 --> 00:45:18,900
traffic or anything so uh it's just

1317
00:45:18,900 --> 00:45:20,579
basically like an event where you were

1318
00:45:20,579 --> 00:45:22,260
used to python

1319
00:45:22,260 --> 00:45:25,020
um and yeah anything that that is um

1320
00:45:25,020 --> 00:45:27,540
anything specifically in a set of OT

1321
00:45:27,540 --> 00:45:29,339
products if you see the the rule in the

1322
00:45:29,339 --> 00:45:30,960
end like for example that OT products

1323
00:45:30,960 --> 00:45:33,420
you would have to select which are the

1324
00:45:33,420 --> 00:45:34,440
ones where you want to see it because

1325
00:45:34,440 --> 00:45:36,960
otherwise it's going to be a ton of um

1326
00:45:36,960 --> 00:45:39,000
a ton of Noise We were aware if you're

1327
00:45:39,000 --> 00:45:40,319
at the I.T level it's going to be

1328
00:45:40,319 --> 00:45:42,480
everywhere it's definitely useless if

1329
00:45:42,480 --> 00:45:43,859
you're in a very specific set of assets

1330
00:45:43,859 --> 00:45:45,480
where you know it doesn't exist which is

1331
00:45:45,480 --> 00:45:47,940
this ulti prod then that is where we

1332
00:45:47,940 --> 00:45:49,440
would be suggesting to hunt and

1333
00:45:49,440 --> 00:45:51,180
basically any derivatives for example of

1334
00:45:51,180 --> 00:45:52,800
that when it might be trying to pull

1335
00:45:52,800 --> 00:45:54,420
updates or trying to set up for

1336
00:45:54,420 --> 00:45:56,280
installing anything those are the things

1337
00:45:56,280 --> 00:45:58,380
that we will be looking for and that an

1338
00:45:58,380 --> 00:46:00,060
actor might have to do because you know

1339
00:46:00,060 --> 00:46:01,319
if they want to run something in an

1340
00:46:01,319 --> 00:46:02,819
environment where it doesn't belong the

1341
00:46:02,819 --> 00:46:04,380
first thing you do is update whatever is

1342
00:46:04,380 --> 00:46:06,300
needed get to the version you want and

1343
00:46:06,300 --> 00:46:09,240
then you start running whatever you have

1344
00:46:09,240 --> 00:46:12,300
the second one just specific now in the

1345
00:46:12,300 --> 00:46:14,400
at the diagram level

1346
00:46:14,400 --> 00:46:16,380
uh specifically for for one of the ones

1347
00:46:16,380 --> 00:46:18,359
we use the image the example you see

1348
00:46:18,359 --> 00:46:20,220
here is more based what I was mentioning

1349
00:46:20,220 --> 00:46:22,079
kind of an OC software specific but

1350
00:46:22,079 --> 00:46:23,220
there might be different products they

1351
00:46:23,220 --> 00:46:25,380
might look different uh the big learning

1352
00:46:25,380 --> 00:46:27,300
in here try not to get too much into it

1353
00:46:27,300 --> 00:46:29,940
is simply that it's going to be tricky

1354
00:46:29,940 --> 00:46:32,400
to understand what is going in here all

1355
00:46:32,400 --> 00:46:33,480
of them are going to look different so

1356
00:46:33,480 --> 00:46:35,280
you're going to have to be familiar with

1357
00:46:35,280 --> 00:46:37,579
what solution you have how it looks like

1358
00:46:37,579 --> 00:46:39,900
and uh most likely you're going to be

1359
00:46:39,900 --> 00:46:41,460
having to work with Engineers the people

1360
00:46:41,460 --> 00:46:42,780
that are working directly with these

1361
00:46:42,780 --> 00:46:45,180
solutions to make sense of what is going

1362
00:46:45,180 --> 00:46:46,740
on and again you're going to be looking

1363
00:46:46,740 --> 00:46:49,140
for any type of modifications in any

1364
00:46:49,140 --> 00:46:51,839
type of weird traffic particularly in

1365
00:46:51,839 --> 00:46:54,619
OPC UA

1366
00:46:54,960 --> 00:46:56,400
um one of the big things that we had in

1367
00:46:56,400 --> 00:47:00,000
in OPC UA precisely was the pink sweeps

1368
00:47:00,000 --> 00:47:01,800
so that was what we were mentioning a

1369
00:47:01,800 --> 00:47:03,839
second ago with the tripwire if you see

1370
00:47:03,839 --> 00:47:05,940
any of these pink sweeps normally and

1371
00:47:05,940 --> 00:47:07,200
this is from from experience from our

1372
00:47:07,200 --> 00:47:08,940
peers that have been working in for

1373
00:47:08,940 --> 00:47:11,520
example a specific industrial facilities

1374
00:47:11,520 --> 00:47:13,680
to keep it broad uh one of the things

1375
00:47:13,680 --> 00:47:16,440
that happens is like hey that was pink

1376
00:47:16,440 --> 00:47:18,480
what happened okay there are many ways

1377
00:47:18,480 --> 00:47:20,880
to verify first of all should it be is

1378
00:47:20,880 --> 00:47:21,900
there anything scheduled because

1379
00:47:21,900 --> 00:47:23,460
everything is scheduled in one of these

1380
00:47:23,460 --> 00:47:26,280
one of these locations obviously

1381
00:47:26,280 --> 00:47:28,920
um well it's the normally they have

1382
00:47:28,920 --> 00:47:30,960
those practices the next thing you would

1383
00:47:30,960 --> 00:47:32,099
do is probably you can even check

1384
00:47:32,099 --> 00:47:34,619
physically like did this person use

1385
00:47:34,619 --> 00:47:36,480
their key card to go and go to this

1386
00:47:36,480 --> 00:47:39,240
location and use this specific asset so

1387
00:47:39,240 --> 00:47:40,619
you know it's Joe poking around yeah

1388
00:47:40,619 --> 00:47:42,900
yeah he's okay cool then we know that

1389
00:47:42,900 --> 00:47:44,520
it's going to be it's gonna be okay

1390
00:47:44,520 --> 00:47:46,200
otherwise that's something that you

1391
00:47:46,200 --> 00:47:47,880
definitely should be looking for

1392
00:47:47,880 --> 00:47:50,579
and uh well here we have the the rule

1393
00:47:50,579 --> 00:47:52,740
it's very similar again if you realize

1394
00:47:52,740 --> 00:47:55,500
there's this Focus uh and this is uh

1395
00:47:55,500 --> 00:47:57,839
super like involved OT Prof this is

1396
00:47:57,839 --> 00:47:59,880
something that the rules are very simple

1397
00:47:59,880 --> 00:48:01,319
this is something that probably you're

1398
00:48:01,319 --> 00:48:03,720
using everywhere much more specific much

1399
00:48:03,720 --> 00:48:05,700
more complex but that is precisely what

1400
00:48:05,700 --> 00:48:07,920
we want to highlight that with something

1401
00:48:07,920 --> 00:48:10,440
very simple if you place it in the

1402
00:48:10,440 --> 00:48:11,460
location

1403
00:48:11,460 --> 00:48:13,619
where it matters

1404
00:48:13,619 --> 00:48:15,119
it would make a significant difference

1405
00:48:15,119 --> 00:48:17,599
for OT

1406
00:48:17,700 --> 00:48:20,220
then cold call as you can see there's

1407
00:48:20,220 --> 00:48:23,099
already this this pattern of how we're

1408
00:48:23,099 --> 00:48:25,020
approaching it particularly for a cold

1409
00:48:25,020 --> 00:48:26,760
call what you see in here actually is is

1410
00:48:26,760 --> 00:48:28,859
very funny but it's just like it's

1411
00:48:28,859 --> 00:48:30,900
basically Dorking like searching a bit

1412
00:48:30,900 --> 00:48:32,579
around Google finding some of the

1413
00:48:32,579 --> 00:48:34,020
manuals from the manuals you go and

1414
00:48:34,020 --> 00:48:36,000
search and then actually this is you

1415
00:48:36,000 --> 00:48:37,319
find forums for help and things like

1416
00:48:37,319 --> 00:48:38,880
that that's the only way where you can

1417
00:48:38,880 --> 00:48:40,740
go and learn about this or having the

1418
00:48:40,740 --> 00:48:42,180
device and playing with it

1419
00:48:42,180 --> 00:48:44,460
so here the big learning is uh it's

1420
00:48:44,460 --> 00:48:46,079
gonna look very similar again looking

1421
00:48:46,079 --> 00:48:48,420
the very specific assets you know very

1422
00:48:48,420 --> 00:48:50,520
similar but the thing that's important

1423
00:48:50,520 --> 00:48:52,260
here is that oftentimes you're not going

1424
00:48:52,260 --> 00:48:53,520
to be able to understand this type of

1425
00:48:53,520 --> 00:48:55,440
logging as easy as you do with with

1426
00:48:55,440 --> 00:48:58,260
other type of computers basically so

1427
00:48:58,260 --> 00:48:59,339
most likely you're going to have to

1428
00:48:59,339 --> 00:49:01,500
collaborate with the engineers that are

1429
00:49:01,500 --> 00:49:03,780
familiar with this type of data if you

1430
00:49:03,780 --> 00:49:06,540
see it it might make no sense it depends

1431
00:49:06,540 --> 00:49:08,520
again specifically in what device what

1432
00:49:08,520 --> 00:49:10,980
is it that you're using

1433
00:49:10,980 --> 00:49:13,619
again some examples here uh you're

1434
00:49:13,619 --> 00:49:15,240
you're going to see this this pattern of

1435
00:49:15,240 --> 00:49:16,920
knowing what clients are communicating

1436
00:49:16,920 --> 00:49:19,140
because another factor is that

1437
00:49:19,140 --> 00:49:22,619
oftentimes the clients you have you only

1438
00:49:22,619 --> 00:49:24,060
have a limited set of clients that are

1439
00:49:24,060 --> 00:49:25,680
supposed to be communicating in this

1440
00:49:25,680 --> 00:49:27,060
industrial facility

1441
00:49:27,060 --> 00:49:30,480
so if there's any anything communicating

1442
00:49:30,480 --> 00:49:32,700
via those ports to let's say in this

1443
00:49:32,700 --> 00:49:34,200
case the specific code call assets

1444
00:49:34,200 --> 00:49:35,700
basically the another ones that we

1445
00:49:35,700 --> 00:49:38,160
mentioned then basically that's when you

1446
00:49:38,160 --> 00:49:40,099
should be worried about

1447
00:49:40,099 --> 00:49:43,319
and once again this is relevant just

1448
00:49:43,319 --> 00:49:44,579
because we have these very specific

1449
00:49:44,579 --> 00:49:46,020
patterns of communication at the

1450
00:49:46,020 --> 00:49:47,040
Industrial Level

1451
00:49:47,040 --> 00:49:49,319
if it was to be seen in I.T level it

1452
00:49:49,319 --> 00:49:52,220
would be a very different story

1453
00:49:53,099 --> 00:49:54,960
pretty much the same uh the only

1454
00:49:54,960 --> 00:49:56,339
difference is here we have also a couple

1455
00:49:56,339 --> 00:49:58,140
additional protocols to look for and

1456
00:49:58,140 --> 00:50:00,240
since we have HTTP we're also focusing

1457
00:50:00,240 --> 00:50:02,760
at the at the post level so we're also

1458
00:50:02,760 --> 00:50:04,500
finding there for example any user agent

1459
00:50:04,500 --> 00:50:06,720
with python which again uh some people

1460
00:50:06,720 --> 00:50:08,220
might think an actor would never use it

1461
00:50:08,220 --> 00:50:09,839
but some people might have seen that

1462
00:50:09,839 --> 00:50:12,420
actors use it so it is something that

1463
00:50:12,420 --> 00:50:13,920
you can find whenever the actor makes

1464
00:50:13,920 --> 00:50:16,680
this this small uh

1465
00:50:16,680 --> 00:50:19,020
let's say lazy step not not to call a

1466
00:50:19,020 --> 00:50:20,400
mistake

1467
00:50:20,400 --> 00:50:22,560
and well this is this is more again

1468
00:50:22,560 --> 00:50:24,839
these are some blocks actually just

1469
00:50:24,839 --> 00:50:28,380
another example of how basically the

1470
00:50:28,380 --> 00:50:30,300
logs that come might not have a lot of

1471
00:50:30,300 --> 00:50:31,619
sense unless you're familiar with the

1472
00:50:31,619 --> 00:50:34,020
technology so that is why you're going

1473
00:50:34,020 --> 00:50:36,300
to need to work with your with your um

1474
00:50:36,300 --> 00:50:37,740
with your engineers that are familiar

1475
00:50:37,740 --> 00:50:39,420
already with this type of specific home

1476
00:50:39,420 --> 00:50:42,839
run ether card products and whatnot

1477
00:50:42,839 --> 00:50:45,060
so that being said that's that's the

1478
00:50:45,060 --> 00:50:46,740
last I had I tried to run a bit more

1479
00:50:46,740 --> 00:50:47,940
right now because I was saying I was

1480
00:50:47,940 --> 00:50:49,260
getting close to time and I want to make

1481
00:50:49,260 --> 00:50:52,380
sure uh not to keep you here like until

1482
00:50:52,380 --> 00:50:55,079
the last minute but um the last thing is

1483
00:50:55,079 --> 00:50:56,339
just and this is more like a

1484
00:50:56,339 --> 00:50:58,079
responsibility the general mitigations

1485
00:50:58,079 --> 00:51:00,000
this is basically as you're going to

1486
00:51:00,000 --> 00:51:01,980
realize everything that everyone tells

1487
00:51:01,980 --> 00:51:04,380
you for OT segment everything don't keep

1488
00:51:04,380 --> 00:51:07,079
it together itot enable logging whenever

1489
00:51:07,079 --> 00:51:09,119
possible allow listing everything that

1490
00:51:09,119 --> 00:51:10,980
that you know that that you're going to

1491
00:51:10,980 --> 00:51:13,200
be using all of them are true and you

1492
00:51:13,200 --> 00:51:14,400
should follow them and they're super

1493
00:51:14,400 --> 00:51:15,540
recommended

1494
00:51:15,540 --> 00:51:18,420
but that is the reason why we brought

1495
00:51:18,420 --> 00:51:19,740
this additional section on the hunting

1496
00:51:19,740 --> 00:51:21,900
because we know that even if if you

1497
00:51:21,900 --> 00:51:23,579
follow all of that it's going to be

1498
00:51:23,579 --> 00:51:26,099
great a great Baseline but whenever you

1499
00:51:26,099 --> 00:51:29,579
find this anomaly uh these additional

1500
00:51:29,579 --> 00:51:31,020
um let's say malicious software that was

1501
00:51:31,020 --> 00:51:33,359
deployed or not well basically you're

1502
00:51:33,359 --> 00:51:34,920
not going to know because these best

1503
00:51:34,920 --> 00:51:36,599
practices are great but are not enough

1504
00:51:36,599 --> 00:51:38,520
there has to be some some proactive

1505
00:51:38,520 --> 00:51:40,260
additional research

1506
00:51:40,260 --> 00:51:44,099
and with that I wrap up with a gift for

1507
00:51:44,099 --> 00:51:46,920
for our peer the one with the snakes he

1508
00:51:46,920 --> 00:51:48,839
took an image particularly for all for

1509
00:51:48,839 --> 00:51:51,540
us it's a snake on controller a very bad

1510
00:51:51,540 --> 00:51:53,900
joke but it had to be our way to finish

1511
00:51:53,900 --> 00:51:57,490
ah yeah that's all for now thanks

1512
00:51:57,490 --> 00:52:01,959
[Applause]

