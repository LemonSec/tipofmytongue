1
00:00:04,319 --> 00:00:05,700
um and it's great to be back actually

2
00:00:05,700 --> 00:00:07,319
speaking in person it's been a while

3
00:00:07,319 --> 00:00:09,059
since I've actually got to be in front

4
00:00:09,059 --> 00:00:10,440
of a lot of folks talking so I think

5
00:00:10,440 --> 00:00:12,179
this will be a great uh presentation

6
00:00:12,179 --> 00:00:13,920
with some good stuff

7
00:00:13,920 --> 00:00:16,199
um but uh I've been to Belgium several

8
00:00:16,199 --> 00:00:17,520
times I've never been here before this

9
00:00:17,520 --> 00:00:20,460
is an amazing venue uh awesome area I've

10
00:00:20,460 --> 00:00:22,260
never seen so many people riding on

11
00:00:22,260 --> 00:00:24,480
bikes uh before we don't use bikes as

12
00:00:24,480 --> 00:00:26,039
much in the United States so it's really

13
00:00:26,039 --> 00:00:27,480
cool to see everybody actually out there

14
00:00:27,480 --> 00:00:30,180
and kids walking it was really neat

15
00:00:30,180 --> 00:00:32,520
um just a brief introduction to myself

16
00:00:32,520 --> 00:00:34,500
um

17
00:00:34,500 --> 00:00:36,120
my name is Dave Kennedy I've been in the

18
00:00:36,120 --> 00:00:37,620
security industry for over 20 some years

19
00:00:37,620 --> 00:00:40,739
which means I'm getting really old but I

20
00:00:40,739 --> 00:00:43,200
run I'm the founder of trusted SEC and

21
00:00:43,200 --> 00:00:44,940
binary defense I was the chief security

22
00:00:44,940 --> 00:00:46,800
officer for a fortune 1000 company for a

23
00:00:46,800 --> 00:00:48,899
number of years and uh really my whole

24
00:00:48,899 --> 00:00:51,180
Focus has always been building Cool

25
00:00:51,180 --> 00:00:53,219
Tools releasing awesome research and

26
00:00:53,219 --> 00:00:54,719
making the industry better for whatever

27
00:00:54,719 --> 00:00:57,600
I can so that's been me I'm also on the

28
00:00:57,600 --> 00:00:59,879
news quite often I've helped out the TV

29
00:00:59,879 --> 00:01:02,579
show Mr Robot I was in a Chris Brown rap

30
00:01:02,579 --> 00:01:04,080
video believe it or not that was really

31
00:01:04,080 --> 00:01:05,159
weird

32
00:01:05,159 --> 00:01:07,560
um never thought I'd be in a rap video I

33
00:01:07,560 --> 00:01:09,420
I my wife actually makes fun of me

34
00:01:09,420 --> 00:01:11,400
because I don't know how to move uh to

35
00:01:11,400 --> 00:01:13,560
the Beats so it's actually funny I was

36
00:01:13,560 --> 00:01:15,840
doing the rap video and I was bobbing my

37
00:01:15,840 --> 00:01:17,880
head and the producer's like uh yeah can

38
00:01:17,880 --> 00:01:19,200
you stop bobbing your head please I'm

39
00:01:19,200 --> 00:01:21,000
like okay no problem uh

40
00:01:21,000 --> 00:01:22,860
uh I've testified in front of Congress

41
00:01:22,860 --> 00:01:24,420
I've been on the Katie Kirk show in a

42
00:01:24,420 --> 00:01:25,979
number of news organizations

43
00:01:25,979 --> 00:01:27,540
um most recently

44
00:01:27,540 --> 00:01:29,460
um with all the stuff that's going on in

45
00:01:29,460 --> 00:01:31,619
Iran so I don't get nervous very often

46
00:01:31,619 --> 00:01:33,180
uh speaking in front of folks it's kind

47
00:01:33,180 --> 00:01:35,400
of my uh my I guess superpower on that

48
00:01:35,400 --> 00:01:36,180
front

49
00:01:36,180 --> 00:01:37,439
um but I get socially awkward with

50
00:01:37,439 --> 00:01:39,479
people it's really weird but when it

51
00:01:39,479 --> 00:01:41,100
comes to the new stuff you know you

52
00:01:41,100 --> 00:01:42,299
think going in from the news you get

53
00:01:42,299 --> 00:01:44,520
nervous but I really don't uh but

54
00:01:44,520 --> 00:01:46,799
recently I ran into an issue so when you

55
00:01:46,799 --> 00:01:47,939
go on the news and you go on national

56
00:01:47,939 --> 00:01:51,020
news so I'll do like CNN BBC Fox CNN

57
00:01:51,020 --> 00:01:53,220
MSNBC CNBC I'll do all the different

58
00:01:53,220 --> 00:01:55,680
news organizations and uh recently we're

59
00:01:55,680 --> 00:01:57,920
talking about Iran and I came in as a

60
00:01:57,920 --> 00:02:00,420
expert on cyber warfare and stuff like

61
00:02:00,420 --> 00:02:02,159
that for my Military Intelligence side

62
00:02:02,159 --> 00:02:05,399
of my background and uh and they got the

63
00:02:05,399 --> 00:02:07,320
segment mixed up and they introduced me

64
00:02:07,320 --> 00:02:09,959
in his Iranian nuclear experts

65
00:02:09,959 --> 00:02:12,720
and I don't know if any of you all have

66
00:02:12,720 --> 00:02:14,640
ever sweat underneath your nose or your

67
00:02:14,640 --> 00:02:16,739
ears before but it's possible

68
00:02:16,739 --> 00:02:18,720
um I was extremely nervous at that point

69
00:02:18,720 --> 00:02:20,459
because I know nothing about anything

70
00:02:20,459 --> 00:02:22,200
Iranian nuclear or anything to that

71
00:02:22,200 --> 00:02:24,120
effect and I'm live on national TV with

72
00:02:24,120 --> 00:02:25,440
millions of people watching it's like

73
00:02:25,440 --> 00:02:27,780
their top you know Prime Time Night Show

74
00:02:27,780 --> 00:02:30,060
and I read a nuclear expert was supposed

75
00:02:30,060 --> 00:02:31,620
to come on after me I was supposed to be

76
00:02:31,620 --> 00:02:33,360
the Cyber person but they got it flipped

77
00:02:33,360 --> 00:02:35,400
wrong so I'm now the Iranian nuclear

78
00:02:35,400 --> 00:02:37,739
expert and so you have a couple of

79
00:02:37,739 --> 00:02:39,360
seconds like literally like three or

80
00:02:39,360 --> 00:02:40,620
four seconds to decide what the hell

81
00:02:40,620 --> 00:02:42,360
you're gonna do because you're like

82
00:02:42,360 --> 00:02:45,120
either I I correct them on national TV

83
00:02:45,120 --> 00:02:46,980
and say hey I'm not an Iranian nuclear

84
00:02:46,980 --> 00:02:49,739
expert or you you try to your

85
00:02:49,739 --> 00:02:52,080
way out of it and um I unfortunately

86
00:02:52,080 --> 00:02:53,700
panicked and tried to BS my way out of

87
00:02:53,700 --> 00:02:55,739
it and uh so I was I became a new

88
00:02:55,739 --> 00:02:58,140
Iranian nuclear expert

89
00:02:58,140 --> 00:02:59,700
um and I knew nothing about what I was

90
00:02:59,700 --> 00:03:00,720
talking about they're like yeah what

91
00:03:00,720 --> 00:03:02,519
about the Treaty of 1983 I'm like yeah

92
00:03:02,519 --> 00:03:05,220
that treaty oh my gosh it's a whoo not

93
00:03:05,220 --> 00:03:07,019
doing good right now right you know and

94
00:03:07,019 --> 00:03:08,700
I tried navigating it towards cyber and

95
00:03:08,700 --> 00:03:10,200
I'm like oh yeah but the Cyber stuff

96
00:03:10,200 --> 00:03:11,640
that Iran's doing they're like yeah we

97
00:03:11,640 --> 00:03:12,720
have an expert coming on next that's

98
00:03:12,720 --> 00:03:13,680
gonna be talking about cyber we don't

99
00:03:13,680 --> 00:03:14,819
need to worry about that I'm like okay

100
00:03:14,819 --> 00:03:17,519
okay uh it was bad but uh you get to do

101
00:03:17,519 --> 00:03:21,000
really fun stuff uh on there and um I

102
00:03:21,000 --> 00:03:22,560
run two two companies we just released

103
00:03:22,560 --> 00:03:24,480
or we just opened up our headquarters uh

104
00:03:24,480 --> 00:03:26,159
downstairs uh over the bottom left of

105
00:03:26,159 --> 00:03:28,620
trusted SEC uh really cool building uh

106
00:03:28,620 --> 00:03:30,720
got a huge Conference Center in it and

107
00:03:30,720 --> 00:03:32,280
it's really cool I have an artist uh

108
00:03:32,280 --> 00:03:34,800
painting a mural and in the mural has a

109
00:03:34,800 --> 00:03:37,140
bunch of binary decode the binary it

110
00:03:37,140 --> 00:03:38,459
gives you a link that you can only do

111
00:03:38,459 --> 00:03:40,379
internally for an internal CTF to win

112
00:03:40,379 --> 00:03:42,000
prizes so we try to you know make the

113
00:03:42,000 --> 00:03:43,500
themes throughout the whole building uh

114
00:03:43,500 --> 00:03:45,299
pretty neat and have a lot of fun

115
00:03:45,299 --> 00:03:48,180
and last but not least I own a DeLorean

116
00:03:48,180 --> 00:03:50,459
um from Back to the Future so I it

117
00:03:50,459 --> 00:03:52,620
doesn't fly or do Time time travel yet

118
00:03:52,620 --> 00:03:55,260
I'm still working on that but um but

119
00:03:55,260 --> 00:03:57,120
that's my side project is working on a

120
00:03:57,120 --> 00:03:58,920
DeLorean which they are actually really

121
00:03:58,920 --> 00:04:01,440
horrible cars uh it definitely can't get

122
00:04:01,440 --> 00:04:03,480
to 88 miles per hour uh in any way shape

123
00:04:03,480 --> 00:04:04,980
or form I'm lucky to hit 60 miles an

124
00:04:04,980 --> 00:04:08,099
hour uh but yeah yeah anyways that's not

125
00:04:08,099 --> 00:04:09,360
why we're here today

126
00:04:09,360 --> 00:04:11,459
uh my talk today is is really about

127
00:04:11,459 --> 00:04:13,799
adaptive adversaries and what that is is

128
00:04:13,799 --> 00:04:15,180
if you look at

129
00:04:15,180 --> 00:04:17,339
um 10 to 15 years ago of what we had to

130
00:04:17,339 --> 00:04:18,779
deal with from a security perspective

131
00:04:18,779 --> 00:04:20,699
today it's vastly changed as you would

132
00:04:20,699 --> 00:04:23,580
expect technology progresses uh the

133
00:04:23,580 --> 00:04:25,680
security industry progresses offense and

134
00:04:25,680 --> 00:04:27,540
defense progresses we have better

135
00:04:27,540 --> 00:04:29,340
visibility than we ever have and so you

136
00:04:29,340 --> 00:04:31,320
look at what's happening both from an

137
00:04:31,320 --> 00:04:33,000
adversary perspective around organized

138
00:04:33,000 --> 00:04:34,800
crime groups or ransomware groups to

139
00:04:34,800 --> 00:04:37,500
nation state nation state groups the

140
00:04:37,500 --> 00:04:39,479
capabilities of attackers are always

141
00:04:39,479 --> 00:04:42,120
increasing you know we saw a Conti a

142
00:04:42,120 --> 00:04:44,520
dedicated research divisions um if you

143
00:04:44,520 --> 00:04:45,960
saw the Conti leaks I thought one thing

144
00:04:45,960 --> 00:04:49,560
that was really funny uh was uh there's

145
00:04:49,560 --> 00:04:51,060
always the debate on what's the better

146
00:04:51,060 --> 00:04:54,000
editor VI or Nano and uh if you looked

147
00:04:54,000 --> 00:04:56,060
at the translations in the

148
00:04:56,060 --> 00:04:58,380
let's not get into that right now I mean

149
00:04:58,380 --> 00:05:00,900
we all know and handles better but uh I

150
00:05:00,900 --> 00:05:02,100
know I've offended you by that one but

151
00:05:02,100 --> 00:05:05,160
uh you it's funny one of the uh Russian

152
00:05:05,160 --> 00:05:07,680
hackers was uh getting access into a

153
00:05:07,680 --> 00:05:09,180
system and they had a help desk here

154
00:05:09,180 --> 00:05:11,280
that you know you could escalate help to

155
00:05:11,280 --> 00:05:13,020
if you ran into a situation where you

156
00:05:13,020 --> 00:05:14,280
couldn't break into the company or

157
00:05:14,280 --> 00:05:17,100
something and uh the attacker was

158
00:05:17,100 --> 00:05:19,320
basically saying like what type of of

159
00:05:19,320 --> 00:05:21,180
horrible hell is this editor how do I

160
00:05:21,180 --> 00:05:23,639
exit it and he was talking about VI and

161
00:05:23,639 --> 00:05:24,960
uh the help desk had to be like you know

162
00:05:24,960 --> 00:05:26,340
hey you just hit the colon queue you

163
00:05:26,340 --> 00:05:27,600
know exclamation points or whatever so

164
00:05:27,600 --> 00:05:29,460
that was that was pretty funny

165
00:05:29,460 --> 00:05:32,160
um but we see the the sophistication

166
00:05:32,160 --> 00:05:34,740
continue to grow with adversaries and

167
00:05:34,740 --> 00:05:37,380
our defenses have to marry that and

168
00:05:37,380 --> 00:05:39,479
what's interesting is if you look at

169
00:05:39,479 --> 00:05:41,460
um a lot of organizations they're still

170
00:05:41,460 --> 00:05:43,560
at a very basic level of Security even

171
00:05:43,560 --> 00:05:45,960
if you have an EDR product or all this

172
00:05:45,960 --> 00:05:48,060
technology what you find is that if an

173
00:05:48,060 --> 00:05:49,800
attacker is changing their techniques or

174
00:05:49,800 --> 00:05:50,940
changing the way they look at an

175
00:05:50,940 --> 00:05:53,220
organization it largely circumvents that

176
00:05:53,220 --> 00:05:55,080
we actually need people looking at logs

177
00:05:55,080 --> 00:05:56,820
looking at Telemetry data building

178
00:05:56,820 --> 00:05:58,620
detections and understanding behavior in

179
00:05:58,620 --> 00:06:00,360
our own environments and these types of

180
00:06:00,360 --> 00:06:02,160
things are expensive they take a lot of

181
00:06:02,160 --> 00:06:04,380
effort and work to understand our own

182
00:06:04,380 --> 00:06:05,580
environments and that's what we run into

183
00:06:05,580 --> 00:06:07,020
today

184
00:06:07,020 --> 00:06:09,300
in 2014 I gave a talk with a good friend

185
00:06:09,300 --> 00:06:11,400
of mine Kevin mitnick and Kevin and I

186
00:06:11,400 --> 00:06:14,520
are on stage talking about how we as an

187
00:06:14,520 --> 00:06:16,740
industry have to focus on adapting our

188
00:06:16,740 --> 00:06:18,660
techniques and not focusing solely on

189
00:06:18,660 --> 00:06:20,280
vulnerability scanners and looking at

190
00:06:20,280 --> 00:06:22,319
that it was interesting uh back then is

191
00:06:22,319 --> 00:06:24,539
that you know you you go back 10 years

192
00:06:24,539 --> 00:06:26,340
and a lot of you look fairly young so

193
00:06:26,340 --> 00:06:28,020
maybe it's a little bit too far back but

194
00:06:28,020 --> 00:06:30,600
uh 10 years ago not Edwin you look old

195
00:06:30,600 --> 00:06:33,539
um but uh just kidding man 10 years ago

196
00:06:33,539 --> 00:06:35,819
you know we were focusing solely on

197
00:06:35,819 --> 00:06:38,220
technical findings so you'd find an

198
00:06:38,220 --> 00:06:39,900
exploits or a vulnerability you'd

199
00:06:39,900 --> 00:06:41,280
exploit that vulnerability and then from

200
00:06:41,280 --> 00:06:42,960
there you do privilege escalation you do

201
00:06:42,960 --> 00:06:44,460
lateral movement you get access to a

202
00:06:44,460 --> 00:06:45,660
domain controller once you get access to

203
00:06:45,660 --> 00:06:46,740
the main control you got to access all

204
00:06:46,740 --> 00:06:49,680
the data we didn't focus on the flow of

205
00:06:49,680 --> 00:06:51,780
that attack we focused on the myopic

206
00:06:51,780 --> 00:06:53,280
technical findings of that to address

207
00:06:53,280 --> 00:06:55,500
and so you know when I was at pen tester

208
00:06:55,500 --> 00:06:57,180
you know back then it was awesome

209
00:06:57,180 --> 00:06:58,800
because I would literally go into a

210
00:06:58,800 --> 00:07:01,440
company I'd break into a company they'd

211
00:07:01,440 --> 00:07:02,940
patch the individual findings and then

212
00:07:02,940 --> 00:07:04,080
next year I would do the exact same

213
00:07:04,080 --> 00:07:04,800
thing just find a different

214
00:07:04,800 --> 00:07:06,720
vulnerability and a lot of times they

215
00:07:06,720 --> 00:07:08,100
wouldn't fix that vulnerability so I

216
00:07:08,100 --> 00:07:08,759
just breaking with the same

217
00:07:08,759 --> 00:07:10,319
vulnerability and then it was the same

218
00:07:10,319 --> 00:07:11,400
thing over and over and over again it

219
00:07:11,400 --> 00:07:12,960
was the easiest thing ever like you got

220
00:07:12,960 --> 00:07:15,120
a week-long pen test and by Monday you

221
00:07:15,120 --> 00:07:16,319
had access to everything so then you

222
00:07:16,319 --> 00:07:17,520
would just write a tool for like four

223
00:07:17,520 --> 00:07:19,199
more days you know I'd release a new

224
00:07:19,199 --> 00:07:20,460
version of the social engineer toolkit

225
00:07:20,460 --> 00:07:22,440
or magic unicorn or whatever because I'd

226
00:07:22,440 --> 00:07:23,699
already done everything the first day

227
00:07:23,699 --> 00:07:26,699
now it's much more challenging today to

228
00:07:26,699 --> 00:07:28,139
do that you know it's actually gotten

229
00:07:28,139 --> 00:07:29,639
much more difficult to break into

230
00:07:29,639 --> 00:07:31,259
organizations we've seen advances in

231
00:07:31,259 --> 00:07:33,599
Microsoft and Apple uh and devices that

232
00:07:33,599 --> 00:07:35,880
we use we have to find flaws we have to

233
00:07:35,880 --> 00:07:37,440
find misconfigurations we have to

234
00:07:37,440 --> 00:07:39,900
circumvent detection criteria it's no

235
00:07:39,900 --> 00:07:42,180
longer you know running Chicago nay and

236
00:07:42,180 --> 00:07:43,740
Metasploit as an encoder to get around

237
00:07:43,740 --> 00:07:46,259
antivirus it's a lot more complex than

238
00:07:46,259 --> 00:07:47,280
what we have to deal with today and

239
00:07:47,280 --> 00:07:50,340
that's a good thing that's a good thing

240
00:07:50,340 --> 00:07:52,380
and what we started to see early on

241
00:07:52,380 --> 00:07:54,720
about 10 years ago is really the

242
00:07:54,720 --> 00:07:56,819
blending of red and blue red and blue

243
00:07:56,819 --> 00:07:59,340
working together I remember you know red

244
00:07:59,340 --> 00:08:01,139
was kind of the the mystical magic

245
00:08:01,139 --> 00:08:02,639
creature that would come out and run

246
00:08:02,639 --> 00:08:04,560
some awesome exploits and then all of a

247
00:08:04,560 --> 00:08:05,940
sudden now you'd have a report and then

248
00:08:05,940 --> 00:08:07,680
you'd have to fix those findings it's

249
00:08:07,680 --> 00:08:10,380
changed we understand offense now and we

250
00:08:10,380 --> 00:08:12,060
can build better defenses against that

251
00:08:12,060 --> 00:08:14,160
so when you look at what we've done in

252
00:08:14,160 --> 00:08:15,840
the past just 10 years alone and where

253
00:08:15,840 --> 00:08:17,819
we're focusing our efforts on the the

254
00:08:17,819 --> 00:08:19,620
blending of red and blue the purple side

255
00:08:19,620 --> 00:08:21,300
of the house has really made defense

256
00:08:21,300 --> 00:08:22,500
substantially better with everything

257
00:08:22,500 --> 00:08:24,240
that we're seeing

258
00:08:24,240 --> 00:08:26,400
the issue is is that the return on

259
00:08:26,400 --> 00:08:28,080
investment and securities still a

260
00:08:28,080 --> 00:08:30,660
challenging thing to communicate I was a

261
00:08:30,660 --> 00:08:32,219
chief security officer for a fortune

262
00:08:32,219 --> 00:08:34,140
1000 company for a number of years and

263
00:08:34,140 --> 00:08:36,240
one of my favorite stories uh I worked

264
00:08:36,240 --> 00:08:38,520
at a company called diebold and uh their

265
00:08:38,520 --> 00:08:40,500
manufacturer of ATM machines I came in

266
00:08:40,500 --> 00:08:42,360
after the voting machine issues I just

267
00:08:42,360 --> 00:08:43,500
want to throw that out there that I

268
00:08:43,500 --> 00:08:44,760
wasn't there during that that period of

269
00:08:44,760 --> 00:08:45,839
time

270
00:08:45,839 --> 00:08:49,200
um but when I was there uh what I really

271
00:08:49,200 --> 00:08:50,940
enjoyed was being able to work with it

272
00:08:50,940 --> 00:08:53,040
we were actually friends like I bought

273
00:08:53,040 --> 00:08:54,600
them beer and pizza because I used to

274
00:08:54,600 --> 00:08:56,459
like break stuff all the time so I had

275
00:08:56,459 --> 00:08:58,260
to like repair that every time

276
00:08:58,260 --> 00:08:59,820
um but we had a good relationship with

277
00:08:59,820 --> 00:09:01,279
one another and one of my favorite times

278
00:09:01,279 --> 00:09:03,779
uh at working as a chief security

279
00:09:03,779 --> 00:09:06,660
officer was uh it was at Defcon and uh

280
00:09:06,660 --> 00:09:08,640
we had found a flaw in SCCM that allowed

281
00:09:08,640 --> 00:09:10,680
you to patch SCCM and use the SCCM

282
00:09:10,680 --> 00:09:12,360
server to deploy malware to the entire

283
00:09:12,360 --> 00:09:14,160
company okay so using the patch

284
00:09:14,160 --> 00:09:15,720
management process to patch the entire

285
00:09:15,720 --> 00:09:16,860
company of malware which I thought was

286
00:09:16,860 --> 00:09:17,940
awesome

287
00:09:17,940 --> 00:09:19,860
um and I did live on stage I had a

288
00:09:19,860 --> 00:09:21,540
lighter and there was some heavy metal

289
00:09:21,540 --> 00:09:23,339
music playing in the background and I

290
00:09:23,339 --> 00:09:24,779
passed all of our production instances

291
00:09:24,779 --> 00:09:27,540
with malware at diebold so I had like 50

292
00:09:27,540 --> 00:09:29,700
000 shells raining in the background at

293
00:09:29,700 --> 00:09:31,260
Defcon in front of you know like 5 000

294
00:09:31,260 --> 00:09:32,399
people it was like the coolest moment

295
00:09:32,399 --> 00:09:33,480
ever

296
00:09:33,480 --> 00:09:35,820
um but when you look at at complexities

297
00:09:35,820 --> 00:09:38,160
of security it's often difficult for

298
00:09:38,160 --> 00:09:39,600
organizations especially in the

299
00:09:39,600 --> 00:09:41,700
medium-sized area to have dedicated

300
00:09:41,700 --> 00:09:43,380
security Personnel to be able to

301
00:09:43,380 --> 00:09:44,820
understand what's actually happening out

302
00:09:44,820 --> 00:09:47,040
there to have people that can handle and

303
00:09:47,040 --> 00:09:48,600
manage and own that Network

304
00:09:48,600 --> 00:09:50,720
infrastructure Cloud infrastructure

305
00:09:50,720 --> 00:09:52,860
application side of the house all of

306
00:09:52,860 --> 00:09:54,060
those start to become really really

307
00:09:54,060 --> 00:09:57,060
challenging and so the complexities

308
00:09:57,060 --> 00:09:59,940
around security is still a major issue

309
00:09:59,940 --> 00:10:02,820
uh Justin who runs our our research

310
00:10:02,820 --> 00:10:04,860
division you know is right in this uh

311
00:10:04,860 --> 00:10:07,560
you look at how some organizations and I

312
00:10:07,560 --> 00:10:09,180
would say when I say some it's it's

313
00:10:09,180 --> 00:10:12,300
below five percent of organizations have

314
00:10:12,300 --> 00:10:14,519
the capabilities of being able to

315
00:10:14,519 --> 00:10:17,100
understand emulation and simulation

316
00:10:17,100 --> 00:10:18,240
capabilities within their own

317
00:10:18,240 --> 00:10:19,560
environment I mean it's a very small

318
00:10:19,560 --> 00:10:21,540
percentage of companies that can

319
00:10:21,540 --> 00:10:23,820
actually detect new tools that come out

320
00:10:23,820 --> 00:10:26,100
uh modify techniques and attacks it's a

321
00:10:26,100 --> 00:10:27,660
very small percentage of companies that

322
00:10:27,660 --> 00:10:29,459
are still at a level that would consider

323
00:10:29,459 --> 00:10:31,680
Advanced or even close to being above

324
00:10:31,680 --> 00:10:33,360
average when it comes to what we see out

325
00:10:33,360 --> 00:10:34,440
there

326
00:10:34,440 --> 00:10:36,600
we look at lapsis as an example I

327
00:10:36,600 --> 00:10:38,519
thought lapsis is an interesting one uh

328
00:10:38,519 --> 00:10:40,380
the Uber hack recently uh that that

329
00:10:40,380 --> 00:10:42,240
happened and uh the the gaming company

330
00:10:42,240 --> 00:10:45,180
as well uh it looks to be that you know

331
00:10:45,180 --> 00:10:47,100
lapsis is a bunch of teenagers right

332
00:10:47,100 --> 00:10:49,380
they they broke into OCTA they broke

333
00:10:49,380 --> 00:10:52,680
into uh LG they broke into Microsoft uh

334
00:10:52,680 --> 00:10:54,000
you know head source code for Bing

335
00:10:54,000 --> 00:10:55,560
they're able to get into a lot of

336
00:10:55,560 --> 00:10:57,360
different areas and these are a bunch of

337
00:10:57,360 --> 00:10:58,860
teenagers that have offensive

338
00:10:58,860 --> 00:11:02,160
capabilities that you know at 17 or 16

339
00:11:02,160 --> 00:11:03,720
years old I would say is pretty awesome

340
00:11:03,720 --> 00:11:05,640
at that point in time leveraging Cloud

341
00:11:05,640 --> 00:11:07,140
infrastructure and being able to to get

342
00:11:07,140 --> 00:11:08,640
access into some of the largest

343
00:11:08,640 --> 00:11:09,959
companies out there that have dedicated

344
00:11:09,959 --> 00:11:12,620
security teams what's interesting about

345
00:11:12,620 --> 00:11:15,839
uh laps as specifically is uh they're

346
00:11:15,839 --> 00:11:19,140
using our own methods and attacks

347
00:11:19,140 --> 00:11:21,060
against us so you look at how they

348
00:11:21,060 --> 00:11:23,100
mostly go after organizations they get

349
00:11:23,100 --> 00:11:25,680
compromise credentials they go you know

350
00:11:25,680 --> 00:11:28,200
through a VPN concentrator and they use

351
00:11:28,200 --> 00:11:29,880
that as a method to get in now I'll talk

352
00:11:29,880 --> 00:11:31,140
about the multi-factor authentication

353
00:11:31,140 --> 00:11:32,820
thing in a second what I thought was

354
00:11:32,820 --> 00:11:35,279
interesting about the original hacks

355
00:11:35,279 --> 00:11:37,260
from lapses when they first came out is

356
00:11:37,260 --> 00:11:39,000
that they lived predominantly in the

357
00:11:39,000 --> 00:11:39,779
cloud

358
00:11:39,779 --> 00:11:42,200
now is anybody here feel like they have

359
00:11:42,200 --> 00:11:44,880
equal or greater visibility in their

360
00:11:44,880 --> 00:11:46,260
Cloud infrastructure than they do on

361
00:11:46,260 --> 00:11:48,240
their on-prem

362
00:11:48,240 --> 00:11:50,160
no right none of us we laugh at that

363
00:11:50,160 --> 00:11:51,779
because we're like cloudvisibility what

364
00:11:51,779 --> 00:11:52,980
the hell is that

365
00:11:52,980 --> 00:11:55,560
I don't know what that means right and

366
00:11:55,560 --> 00:11:57,300
so using Cloud infrastructure as a

367
00:11:57,300 --> 00:11:58,740
method of attack and we see that with

368
00:11:58,740 --> 00:12:00,480
you know uh nation-state actors in

369
00:12:00,480 --> 00:12:02,160
Russia focusing predominant Cloud China

370
00:12:02,160 --> 00:12:03,899
focusing predominantly on cloud the

371
00:12:03,899 --> 00:12:05,820
ability to abuse Cloud infrastructure as

372
00:12:05,820 --> 00:12:08,040
a way of going undetected gonna be and

373
00:12:08,040 --> 00:12:10,500
continue to be a major issue now if you

374
00:12:10,500 --> 00:12:12,060
look at the lapses hack and this came

375
00:12:12,060 --> 00:12:14,519
from uh Michael kazwara hopefully I

376
00:12:14,519 --> 00:12:16,079
pronounced that correctly but I thought

377
00:12:16,079 --> 00:12:18,060
it was a great representation of mapping

378
00:12:18,060 --> 00:12:20,700
um the various uh attacks against Uber

379
00:12:20,700 --> 00:12:23,040
directly to the minor attack techniques

380
00:12:23,040 --> 00:12:25,019
and what's interesting is the

381
00:12:25,019 --> 00:12:26,700
multi-factor authentication spamming

382
00:12:26,700 --> 00:12:30,120
stuff works so well all the time like if

383
00:12:30,120 --> 00:12:31,320
you just sit there and you annoy the

384
00:12:31,320 --> 00:12:32,820
crap out of a user they're gonna hit

385
00:12:32,820 --> 00:12:34,860
allow eventually they're never gonna

386
00:12:34,860 --> 00:12:36,420
report it by the way they're going to

387
00:12:36,420 --> 00:12:38,880
see 50 attempts of multi-factor

388
00:12:38,880 --> 00:12:39,959
authentication they're never going to

389
00:12:39,959 --> 00:12:41,880
send anything to anybody in security and

390
00:12:41,880 --> 00:12:42,899
they're going to eventually hit approve

391
00:12:42,899 --> 00:12:45,120
especially on push notifications

392
00:12:45,120 --> 00:12:47,220
um an interesting stat we've been using

393
00:12:47,220 --> 00:12:49,920
a pretext uh around multi-factor

394
00:12:49,920 --> 00:12:51,300
authentication especially for push

395
00:12:51,300 --> 00:12:53,519
solutions for about a year now we have

396
00:12:53,519 --> 00:12:55,920
100 success ratio with it like 100

397
00:12:55,920 --> 00:12:57,959
success ratio with it we've never had an

398
00:12:57,959 --> 00:13:00,779
issue if you send an SMS text message to

399
00:13:00,779 --> 00:13:02,579
the person you're going to try to get

400
00:13:02,579 --> 00:13:04,620
the push notification to and let them

401
00:13:04,620 --> 00:13:05,940
know that there's going to be an outage

402
00:13:05,940 --> 00:13:07,620
of your multi-factor authentication so

403
00:13:07,620 --> 00:13:09,899
just say it's Microsoft it looks like an

404
00:13:09,899 --> 00:13:11,459
automated message saying hey there's

405
00:13:11,459 --> 00:13:12,959
going to be an outage between you know

406
00:13:12,959 --> 00:13:14,399
eight o'clock at night to nine o'clock

407
00:13:14,399 --> 00:13:16,860
at night just so you know you may get a

408
00:13:16,860 --> 00:13:18,060
multi-factor you may have to

409
00:13:18,060 --> 00:13:19,740
re-authenticate Via multi-factor

410
00:13:19,740 --> 00:13:21,060
authentication during this period of

411
00:13:21,060 --> 00:13:22,860
time due to this outage and then you

412
00:13:22,860 --> 00:13:24,360
wait a couple hours and then you send

413
00:13:24,360 --> 00:13:25,800
the multi-factor authentication request

414
00:13:25,800 --> 00:13:27,839
they're going to hit approve 100 of the

415
00:13:27,839 --> 00:13:30,899
time 100 of the time push notifications

416
00:13:30,899 --> 00:13:34,380
suck they're awful they're the worst do

417
00:13:34,380 --> 00:13:36,839
not use push ever in any way shape or

418
00:13:36,839 --> 00:13:39,720
form ever use push notifications

419
00:13:39,720 --> 00:13:42,120
but again with this what I thought was

420
00:13:42,120 --> 00:13:44,880
interesting is the reaction uh from a

421
00:13:44,880 --> 00:13:47,279
lot of defensive folks out there around

422
00:13:47,279 --> 00:13:50,279
the surprise around finding uh so the

423
00:13:50,279 --> 00:13:52,260
lapsis hackers once they got access via

424
00:13:52,260 --> 00:13:54,300
VPN via a compromised contractor that

425
00:13:54,300 --> 00:13:55,620
looks like the credentials were bought

426
00:13:55,620 --> 00:13:57,600
for they move laterally and just started

427
00:13:57,600 --> 00:13:59,660
scanning servers now interesting enough

428
00:13:59,660 --> 00:14:03,240
most organizations focus on ttps or

429
00:14:03,240 --> 00:14:05,040
tactics techniques and procedures that

430
00:14:05,040 --> 00:14:06,660
are operating system focused right you

431
00:14:06,660 --> 00:14:08,760
have visibility and edrs whereas network

432
00:14:08,760 --> 00:14:10,440
has really gone by the wayside we don't

433
00:14:10,440 --> 00:14:12,120
see a lot of network visibility anymore

434
00:14:12,120 --> 00:14:14,880
for most organizations uh on the the

435
00:14:14,880 --> 00:14:16,440
network detection response out of the

436
00:14:16,440 --> 00:14:18,240
house so interesting enough they were

437
00:14:18,240 --> 00:14:19,980
scanning file shares looking for open

438
00:14:19,980 --> 00:14:21,720
file shares which I would say

439
00:14:21,720 --> 00:14:23,160
traditionally wouldn't get picked up by

440
00:14:23,160 --> 00:14:25,079
most companies out there and then they

441
00:14:25,079 --> 00:14:27,480
found a Powershell script that contained

442
00:14:27,480 --> 00:14:30,300
hard-coded passwords for their psychotic

443
00:14:30,300 --> 00:14:32,820
Pam system which uh whoops that's like

444
00:14:32,820 --> 00:14:34,500
the one thing you don't want admin

445
00:14:34,500 --> 00:14:35,579
credentials to do it's like your access

446
00:14:35,579 --> 00:14:37,019
management for your entire company right

447
00:14:37,019 --> 00:14:39,480
but the surprise around that was really

448
00:14:39,480 --> 00:14:41,339
into interesting by the industry let me

449
00:14:41,339 --> 00:14:42,420
tell you

450
00:14:42,420 --> 00:14:43,019
um

451
00:14:43,019 --> 00:14:45,320
the things that I have seen on networks

452
00:14:45,320 --> 00:14:47,940
is absolutely astonishing okay and this

453
00:14:47,940 --> 00:14:49,860
is no surprise to me seeing hard-coded

454
00:14:49,860 --> 00:14:52,380
admin credentials in a Powershell script

455
00:14:52,380 --> 00:14:54,600
the things that that I've seen and the

456
00:14:54,600 --> 00:14:56,100
most most horrible Network things you

457
00:14:56,100 --> 00:14:57,779
can possibly imagine are out there

458
00:14:57,779 --> 00:14:59,399
almost in every single Network you can

459
00:14:59,399 --> 00:15:00,899
possibly imagine just whether or not an

460
00:15:00,899 --> 00:15:02,760
attacker finds it before you do right

461
00:15:02,760 --> 00:15:06,240
and and I'm sure Uber we know Uber has a

462
00:15:06,240 --> 00:15:07,920
dedicated security program I know a

463
00:15:07,920 --> 00:15:09,000
number of folks that I've worked there

464
00:15:09,000 --> 00:15:11,399
before I mean they have procedures they

465
00:15:11,399 --> 00:15:13,139
have processes they have governance they

466
00:15:13,139 --> 00:15:15,300
have you know code analysis they have

467
00:15:15,300 --> 00:15:17,160
penetration tests they have red teams

468
00:15:17,160 --> 00:15:19,560
they have a mature security program and

469
00:15:19,560 --> 00:15:21,720
for them to fall you know by this

470
00:15:21,720 --> 00:15:23,220
specific type of attack does not

471
00:15:23,220 --> 00:15:25,920
surprise me in any way shape or form

472
00:15:25,920 --> 00:15:28,560
so what's changed between 10 years ago

473
00:15:28,560 --> 00:15:30,500
to today from an adversary perspective

474
00:15:30,500 --> 00:15:32,699
what's interesting in the ransomware

475
00:15:32,699 --> 00:15:34,440
side is that the ransomware groups have

476
00:15:34,440 --> 00:15:36,660
specializations just like we do in our

477
00:15:36,660 --> 00:15:38,519
industry you know I specialize I gave

478
00:15:38,519 --> 00:15:40,199
the very first ever Powershell security

479
00:15:40,199 --> 00:15:42,000
talk so I created the whole Powershell

480
00:15:42,000 --> 00:15:43,620
security industry which is really weird

481
00:15:43,620 --> 00:15:45,600
to say that I'm but I did

482
00:15:45,600 --> 00:15:47,040
um and so I got to work with Jeff Snover

483
00:15:47,040 --> 00:15:49,260
who wrote Powershell and I did the first

484
00:15:49,260 --> 00:15:51,300
ever Powershell security talk at Defcon

485
00:15:51,300 --> 00:15:53,279
and released a bunch of stuff there and

486
00:15:53,279 --> 00:15:54,779
continued to advance that stuff and then

487
00:15:54,779 --> 00:15:56,220
you know Lee Holmes obviously did a lot

488
00:15:56,220 --> 00:15:58,380
of great work on Powershell we all have

489
00:15:58,380 --> 00:16:00,480
our own specializations around what we

490
00:16:00,480 --> 00:16:03,060
do and what we like to see same thing

491
00:16:03,060 --> 00:16:04,560
for ransomware you know from ransomware

492
00:16:04,560 --> 00:16:06,600
as a service perspective you have folks

493
00:16:06,600 --> 00:16:07,980
that specialize in the delivery and

494
00:16:07,980 --> 00:16:09,720
weaponization the C2 initial access

495
00:16:09,720 --> 00:16:11,339
components you have folks that

496
00:16:11,339 --> 00:16:13,139
specialize in circumventing multi-factor

497
00:16:13,139 --> 00:16:15,120
authentication uh you know you have

498
00:16:15,120 --> 00:16:17,459
folks that specialize in the back end

499
00:16:17,459 --> 00:16:19,320
infrastructure for encryption decryption

500
00:16:19,320 --> 00:16:21,180
and payment so all of these things

501
00:16:21,180 --> 00:16:23,100
together have specializations that allow

502
00:16:23,100 --> 00:16:25,380
these groups to have higher level of

503
00:16:25,380 --> 00:16:27,060
capabilities and work with one another

504
00:16:27,060 --> 00:16:28,920
to become better same thing from a

505
00:16:28,920 --> 00:16:30,120
nation state perspective obviously

506
00:16:30,120 --> 00:16:32,339
unlimited funding equates to typically

507
00:16:32,339 --> 00:16:34,019
higher level capabilities what we see

508
00:16:34,019 --> 00:16:36,000
out there and we never really had that

509
00:16:36,000 --> 00:16:37,920
before you know we had groups out there

510
00:16:37,920 --> 00:16:39,300
that would hack into things we had

511
00:16:39,300 --> 00:16:41,579
groups that you know would have less

512
00:16:41,579 --> 00:16:43,680
sophisticated type of attacks the you

513
00:16:43,680 --> 00:16:46,199
know the business email compromises

514
00:16:46,199 --> 00:16:47,519
those types of things of changing

515
00:16:47,519 --> 00:16:51,000
invoices but never groups that had equal

516
00:16:51,000 --> 00:16:54,060
capabilities uh then as as Nation States

517
00:16:54,060 --> 00:16:55,079
from an organized crime group

518
00:16:55,079 --> 00:16:56,940
perspective and so now we have groups

519
00:16:56,940 --> 00:16:59,160
that adapt to our organization's

520
00:16:59,160 --> 00:17:00,720
infrastructure they manually attack

521
00:17:00,720 --> 00:17:02,160
organizations they look at their

522
00:17:02,160 --> 00:17:03,899
infrastructure they map it out they

523
00:17:03,899 --> 00:17:05,280
figure out what products we have in

524
00:17:05,280 --> 00:17:06,780
place and they get after it what's

525
00:17:06,780 --> 00:17:08,699
interesting is and it's not always spear

526
00:17:08,699 --> 00:17:10,859
phishing or social engineering we saw

527
00:17:10,859 --> 00:17:13,380
with Colonial pipeline where they got

528
00:17:13,380 --> 00:17:15,000
compromise credentials they had a backup

529
00:17:15,000 --> 00:17:16,559
VPN concentrator that didn't have

530
00:17:16,559 --> 00:17:17,839
multi-factor authentication

531
00:17:17,839 --> 00:17:20,160
authenticated to that figured out what

532
00:17:20,160 --> 00:17:21,299
antivirus product they were using

533
00:17:21,299 --> 00:17:23,040
disabled downpoint protection products

534
00:17:23,040 --> 00:17:24,240
on those systems and then went from

535
00:17:24,240 --> 00:17:25,559
there and had full access to their

536
00:17:25,559 --> 00:17:27,900
infrastructure manual attacks manual

537
00:17:27,900 --> 00:17:29,820
hacks manual penetration like we would

538
00:17:29,820 --> 00:17:32,520
typically do as a penetration test or a

539
00:17:32,520 --> 00:17:34,740
researcher Conte leaks showed the same

540
00:17:34,740 --> 00:17:36,480
thing they had operational playbooks

541
00:17:36,480 --> 00:17:38,640
that showed how to methodically go after

542
00:17:38,640 --> 00:17:40,500
organizations so they can reproduce it

543
00:17:40,500 --> 00:17:43,500
to larger masses so again we have a a

544
00:17:43,500 --> 00:17:45,720
time now where we have organized crime

545
00:17:45,720 --> 00:17:47,039
groups that have the same type of

546
00:17:47,039 --> 00:17:49,260
capabilities as nation states and that's

547
00:17:49,260 --> 00:17:50,760
alarming obviously because it hits every

548
00:17:50,760 --> 00:17:54,419
industry demographic uh out there but

549
00:17:54,419 --> 00:17:56,880
today we have all this stuff we have

550
00:17:56,880 --> 00:17:59,160
multi-factor authentication we have you

551
00:17:59,160 --> 00:18:00,960
know Telemetry data that allows us to

552
00:18:00,960 --> 00:18:03,000
see information out there we have zero

553
00:18:03,000 --> 00:18:04,380
trust which is Network segmentation

554
00:18:04,380 --> 00:18:05,520
which

555
00:18:05,520 --> 00:18:07,500
zero trust is a whole other discussion

556
00:18:07,500 --> 00:18:09,240
point I won't get into all that

557
00:18:09,240 --> 00:18:09,900
um

558
00:18:09,900 --> 00:18:11,580
yeah okay uh perimeter security

559
00:18:11,580 --> 00:18:13,140
education awareness endpoint visibility

560
00:18:13,140 --> 00:18:14,880
minimization of users trying to reduce

561
00:18:14,880 --> 00:18:16,380
lateral Movement we have all this stuff

562
00:18:16,380 --> 00:18:19,260
that we know works but it takes ages for

563
00:18:19,260 --> 00:18:20,580
us to actually get implemented in our

564
00:18:20,580 --> 00:18:22,679
own environments like forever zero trust

565
00:18:22,679 --> 00:18:25,200
is anybody here ever implemented a an

566
00:18:25,200 --> 00:18:26,460
amazing zero trust model in their

567
00:18:26,460 --> 00:18:28,500
environment if you did you probably have

568
00:18:28,500 --> 00:18:30,660
a cloud infrastructure that started off

569
00:18:30,660 --> 00:18:32,700
at a smaller size company that allowed

570
00:18:32,700 --> 00:18:33,660
you to go and do that but most

571
00:18:33,660 --> 00:18:35,160
organizations are in that that type of

572
00:18:35,160 --> 00:18:36,780
situation

573
00:18:36,780 --> 00:18:39,059
so we have adaptive adversaries okay and

574
00:18:39,059 --> 00:18:40,799
what adaptive means is the ability to

575
00:18:40,799 --> 00:18:43,620
look at an organization and change your

576
00:18:43,620 --> 00:18:45,539
techniques and procedures to that

577
00:18:45,539 --> 00:18:47,520
organization to customize and to

578
00:18:47,520 --> 00:18:48,840
circumvent detections and I'm going to

579
00:18:48,840 --> 00:18:50,160
show you a couple demos here in a few

580
00:18:50,160 --> 00:18:52,860
minutes uh around that uh for some cool

581
00:18:52,860 --> 00:18:55,679
stuff but again the specializations and

582
00:18:55,679 --> 00:18:57,360
the monetary gains for these have really

583
00:18:57,360 --> 00:18:59,100
Amplified what we're seeing we're seeing

584
00:18:59,100 --> 00:19:01,559
them shift very much to Cloud

585
00:19:01,559 --> 00:19:03,600
so let's talk about some fun

586
00:19:03,600 --> 00:19:06,660
um so talking about adapting and using

587
00:19:06,660 --> 00:19:08,400
research that's out there to do really

588
00:19:08,400 --> 00:19:11,160
cool things just recently we released uh

589
00:19:11,160 --> 00:19:14,400
fairly um recent like two days ago a

590
00:19:14,400 --> 00:19:16,559
beacon object file or a buff that allows

591
00:19:16,559 --> 00:19:18,840
you to extract the office tokens

592
00:19:18,840 --> 00:19:21,179
directly through memory so if you're

593
00:19:21,179 --> 00:19:22,620
using teams if you're using office

594
00:19:22,620 --> 00:19:24,240
you're using any of those things you

595
00:19:24,240 --> 00:19:26,940
have the ability to extract the uh

596
00:19:26,940 --> 00:19:29,520
tokens directly from memory in that

597
00:19:29,520 --> 00:19:30,780
specifically

598
00:19:30,780 --> 00:19:33,539
um uh xor if you're familiar or Mr doc

599
00:19:33,539 --> 00:19:36,960
sorry Mr docs put a public blog out

600
00:19:36,960 --> 00:19:38,820
about how to do this we had been using

601
00:19:38,820 --> 00:19:41,039
it for a quite a while internally at

602
00:19:41,039 --> 00:19:42,299
trusted SEC we just didn't publish our

603
00:19:42,299 --> 00:19:44,880
research and uh we released a bot that

604
00:19:44,880 --> 00:19:47,160
allows you to extract the

605
00:19:47,160 --> 00:19:49,679
um the tokens directly into memory and

606
00:19:49,679 --> 00:19:50,820
then use that from somewhere else and

607
00:19:50,820 --> 00:19:52,500
what's cool about that is works on 32

608
00:19:52,500 --> 00:19:55,140
and 64-bit once you get the session

609
00:19:55,140 --> 00:19:57,720
tokens you can take those session tokens

610
00:19:57,720 --> 00:19:59,520
and replay them on a different machine

611
00:19:59,520 --> 00:20:01,020
which circumvents multi-factor

612
00:20:01,020 --> 00:20:03,419
Authentication so if you compromise a

613
00:20:03,419 --> 00:20:05,039
machine that's logged into office or if

614
00:20:05,039 --> 00:20:07,080
it's logged into teams you can extract

615
00:20:07,080 --> 00:20:09,240
those tokens grab those tokens use it on

616
00:20:09,240 --> 00:20:10,559
a different machine that circumvents and

617
00:20:10,559 --> 00:20:12,840
still have persistent access to that

618
00:20:12,840 --> 00:20:13,799
infrastructure directly through

619
00:20:13,799 --> 00:20:15,360
extracting so let's take a look at how

620
00:20:15,360 --> 00:20:17,780
that works

621
00:20:18,059 --> 00:20:19,620
so here you can see the team servers on

622
00:20:19,620 --> 00:20:21,360
the right hand side

623
00:20:21,360 --> 00:20:23,820
and on the right hand side we're going

624
00:20:23,820 --> 00:20:25,500
to be using our tool that extracts all

625
00:20:25,500 --> 00:20:26,820
of the office tokens directly into

626
00:20:26,820 --> 00:20:28,320
memory and we're going to highlight some

627
00:20:28,320 --> 00:20:29,880
of those so you can't see them

628
00:20:29,880 --> 00:20:31,799
and over here we have to we have to

629
00:20:31,799 --> 00:20:33,840
parse that data so here's our office

630
00:20:33,840 --> 00:20:35,880
token here and we need to parse that

631
00:20:35,880 --> 00:20:38,640
data so that we can get the tokens

632
00:20:38,640 --> 00:20:41,520
directly off of there so the latest uh

633
00:20:41,520 --> 00:20:43,740
PR that or the latest uh pull request

634
00:20:43,740 --> 00:20:46,320
that was put into uh the the buff allows

635
00:20:46,320 --> 00:20:49,620
you to dump the token as well as parsa

636
00:20:49,620 --> 00:20:50,940
token and then replay that token

637
00:20:50,940 --> 00:20:53,160
directly on another machine

638
00:20:53,160 --> 00:20:54,720
so in here this is from Scott on our

639
00:20:54,720 --> 00:20:56,520
research division Scott newsbomb and so

640
00:20:56,520 --> 00:20:57,480
we're going to parse that and you can

641
00:20:57,480 --> 00:20:59,940
see here the full parse token that you

642
00:20:59,940 --> 00:21:01,440
can use directly on a different machine

643
00:21:01,440 --> 00:21:04,200
which is fantastic so if you compromise

644
00:21:04,200 --> 00:21:06,360
a machine you get initial access the

645
00:21:06,360 --> 00:21:07,980
ability to extract those tokens directly

646
00:21:07,980 --> 00:21:09,360
from there and then from there use it on

647
00:21:09,360 --> 00:21:10,380
a different machine and then go through

648
00:21:10,380 --> 00:21:11,880
all their emails go through their team's

649
00:21:11,880 --> 00:21:14,220
infrastructure uh whatever is very much

650
00:21:14,220 --> 00:21:15,840
possible circumvents multi-factor

651
00:21:15,840 --> 00:21:16,980
authentication because you already have

652
00:21:16,980 --> 00:21:19,080
access to the machine and that token but

653
00:21:19,080 --> 00:21:20,160
again you can play it on a different

654
00:21:20,160 --> 00:21:21,840
machine it doesn't need to be on the

655
00:21:21,840 --> 00:21:24,059
same machine to compromise which is nice

656
00:21:24,059 --> 00:21:25,320
now that doesn't get detected by

657
00:21:25,320 --> 00:21:26,880
anything which is great as well um and

658
00:21:26,880 --> 00:21:28,799
that's the big thing here is attack

659
00:21:28,799 --> 00:21:31,159
customization when you're changing and

660
00:21:31,159 --> 00:21:34,080
customizing uh your attack towards an

661
00:21:34,080 --> 00:21:35,400
organization you're typically typically

662
00:21:35,400 --> 00:21:37,320
going to circumvent uh their detection

663
00:21:37,320 --> 00:21:39,299
criteria I'll tell you a quick story

664
00:21:39,299 --> 00:21:41,280
about SMS phishing

665
00:21:41,280 --> 00:21:43,080
um SMS phishing is probably one of my

666
00:21:43,080 --> 00:21:46,679
favorite things to do because uh it can

667
00:21:46,679 --> 00:21:48,000
allow you to have somewhat of a

668
00:21:48,000 --> 00:21:49,980
believable pre-text or attack so if you

669
00:21:49,980 --> 00:21:51,900
can prep a person ahead of time it

670
00:21:51,900 --> 00:21:53,640
allows them to be more successful it

671
00:21:53,640 --> 00:21:54,900
allows you to be more successful in your

672
00:21:54,900 --> 00:21:57,059
pretext and um talking about push

673
00:21:57,059 --> 00:21:59,640
notifications there was a organization

674
00:21:59,640 --> 00:22:01,080
that I did a spear fishing attack

675
00:22:01,080 --> 00:22:02,880
against and I I was targeting two people

676
00:22:02,880 --> 00:22:04,260
in the research division for this

677
00:22:04,260 --> 00:22:06,360
company and it was the two Targets that

678
00:22:06,360 --> 00:22:08,039
had access to the data that I needed for

679
00:22:08,039 --> 00:22:10,679
my specific attack and I spent like a

680
00:22:10,679 --> 00:22:12,480
whole week researching these individuals

681
00:22:12,480 --> 00:22:14,400
building uh you know a completely

682
00:22:14,400 --> 00:22:15,960
fabricated infrastructure that looks

683
00:22:15,960 --> 00:22:17,580
real unbelievable when you're doing

684
00:22:17,580 --> 00:22:19,919
social engineering you have to build a

685
00:22:19,919 --> 00:22:21,480
story that looks real right it's

686
00:22:21,480 --> 00:22:23,220
completely fake a completely fake

687
00:22:23,220 --> 00:22:24,480
infrastructure completely everything

688
00:22:24,480 --> 00:22:26,039
else but the story you have to tell that

689
00:22:26,039 --> 00:22:28,620
person can't trigger any type of this is

690
00:22:28,620 --> 00:22:30,240
weird this shouldn't be happening or

691
00:22:30,240 --> 00:22:31,620
else it burns your whole infrastructure

692
00:22:31,620 --> 00:22:33,659
so I spent the whole week doing this and

693
00:22:33,659 --> 00:22:35,520
I had a kind of a two layer attack the

694
00:22:35,520 --> 00:22:37,500
first layer was cash for their

695
00:22:37,500 --> 00:22:39,419
credentials the second layer was remote

696
00:22:39,419 --> 00:22:41,039
code execution to gain code execution

697
00:22:41,039 --> 00:22:42,780
after the system so I can get access to

698
00:22:42,780 --> 00:22:44,280
their their system from a command and

699
00:22:44,280 --> 00:22:46,740
control perspective so I sent the fishes

700
00:22:46,740 --> 00:22:48,360
out to these two individuals and

701
00:22:48,360 --> 00:22:49,799
literally immediately I got two

702
00:22:49,799 --> 00:22:51,960
usernames and passwords sent back to me

703
00:22:51,960 --> 00:22:54,600
username password got them cool my

704
00:22:54,600 --> 00:22:56,220
remote code execution stuff failed

705
00:22:56,220 --> 00:22:57,539
though because I misconfigured something

706
00:22:57,539 --> 00:22:59,059
unfortunately which happens all the time

707
00:22:59,059 --> 00:23:01,440
and I didn't get the shell that actually

708
00:23:01,440 --> 00:23:03,480
dropped onto the box so I'm like okay

709
00:23:03,480 --> 00:23:05,220
well at least I have credentials let me

710
00:23:05,220 --> 00:23:06,659
see what they have from an MFA

711
00:23:06,659 --> 00:23:08,880
perspective and then I'll build in you

712
00:23:08,880 --> 00:23:11,220
know an MFA pre-text attack that I can

713
00:23:11,220 --> 00:23:13,559
get their second Factor and so I go to

714
00:23:13,559 --> 00:23:16,200
log into their VPN concentrator and

715
00:23:16,200 --> 00:23:18,120
unfortunately it'll remember their last

716
00:23:18,120 --> 00:23:20,460
uh configuration and said we're sending

717
00:23:20,460 --> 00:23:22,919
a push notification uh to you to make

718
00:23:22,919 --> 00:23:24,059
sure that this is actually you I'm like

719
00:23:24,059 --> 00:23:26,159
oh crap like sending a push notification

720
00:23:26,159 --> 00:23:27,900
to the person I just finished with using

721
00:23:27,900 --> 00:23:30,120
a password I'm going to get busted in my

722
00:23:30,120 --> 00:23:31,740
whole you know attack is going to be

723
00:23:31,740 --> 00:23:33,240
completely wasted I just wasted a whole

724
00:23:33,240 --> 00:23:34,860
week of work so I have to tear this down

725
00:23:34,860 --> 00:23:36,240
I'm gonna have to build a whole new

726
00:23:36,240 --> 00:23:37,559
pre-tax and I have to go after this

727
00:23:37,559 --> 00:23:38,820
again I have to do this whole thing over

728
00:23:38,820 --> 00:23:41,640
and over again uh to deal with it and so

729
00:23:41,640 --> 00:23:42,780
like I'm like all right I'm gonna go get

730
00:23:42,780 --> 00:23:44,640
a bourbon because it's gonna be a long

731
00:23:44,640 --> 00:23:46,500
night so I go get a bourbon I come back

732
00:23:46,500 --> 00:23:49,260
and by the time I get back uh I I was

733
00:23:49,260 --> 00:23:51,059
magically logged into the the VPN

734
00:23:51,059 --> 00:23:52,919
concentrator I'm like that's that's

735
00:23:52,919 --> 00:23:53,940
weird

736
00:23:53,940 --> 00:23:55,500
um and the user's like well I'm probably

737
00:23:55,500 --> 00:23:56,640
logging in from somewhere and hit

738
00:23:56,640 --> 00:23:58,200
approve because again push notifications

739
00:23:58,200 --> 00:23:59,880
are awful

740
00:23:59,880 --> 00:24:01,320
um and that's the thing I mean you know

741
00:24:01,320 --> 00:24:04,500
with push notifications if you uh set

742
00:24:04,500 --> 00:24:06,299
your geographic location to the general

743
00:24:06,299 --> 00:24:08,159
location of that individual or the

744
00:24:08,159 --> 00:24:10,140
corporate offices they typically will

745
00:24:10,140 --> 00:24:11,940
almost always hit a proof so the

746
00:24:11,940 --> 00:24:13,980
geolocation coupled with uh you know

747
00:24:13,980 --> 00:24:15,539
sending a notification typically works

748
00:24:15,539 --> 00:24:18,140
almost every time

749
00:24:18,720 --> 00:24:21,600
now when we talk about attacking

750
00:24:21,600 --> 00:24:23,220
organizations and going after an

751
00:24:23,220 --> 00:24:25,559
organization what's important to note is

752
00:24:25,559 --> 00:24:27,299
when you customize your attack and once

753
00:24:27,299 --> 00:24:29,220
you get initial access you're playing on

754
00:24:29,220 --> 00:24:30,900
a field that you don't know about so if

755
00:24:30,900 --> 00:24:32,880
you're running into an EDR product you

756
00:24:32,880 --> 00:24:34,500
know that that's a known entity from

757
00:24:34,500 --> 00:24:36,780
going against a specific EDR brand you

758
00:24:36,780 --> 00:24:38,039
know that they have certain detections

759
00:24:38,039 --> 00:24:39,240
in place that I have to circumvent

760
00:24:39,240 --> 00:24:40,980
against but if you go against a

761
00:24:40,980 --> 00:24:42,179
customized environment that has

762
00:24:42,179 --> 00:24:44,700
customized detections you don't know the

763
00:24:44,700 --> 00:24:45,720
playing field you don't know what's

764
00:24:45,720 --> 00:24:47,159
going to trigger to an analyst and

765
00:24:47,159 --> 00:24:48,659
what's not so you have to really start

766
00:24:48,659 --> 00:24:49,679
to look at that and say well how do I

767
00:24:49,679 --> 00:24:51,600
change that behavior

768
00:24:51,600 --> 00:24:54,299
so here's an example here and um this is

769
00:24:54,299 --> 00:24:56,460
you know circumventing amsi is nothing

770
00:24:56,460 --> 00:24:57,659
new and I'm just going to show you a

771
00:24:57,659 --> 00:24:59,520
demonstration of doing that the reason

772
00:24:59,520 --> 00:25:02,940
for that is the types of detections that

773
00:25:02,940 --> 00:25:04,440
we have today

774
00:25:04,440 --> 00:25:06,960
are almost always very basic and

775
00:25:06,960 --> 00:25:09,000
granular to the specific attack that was

776
00:25:09,000 --> 00:25:10,260
seen it's what we call more of

777
00:25:10,260 --> 00:25:13,260
one-to-one detection so you know a EDR

778
00:25:13,260 --> 00:25:15,900
provider or an antivirus provider saw an

779
00:25:15,900 --> 00:25:17,280
attack in the wild through threat

780
00:25:17,280 --> 00:25:18,780
intelligence or previously disclosed

781
00:25:18,780 --> 00:25:20,580
data breaches and they write a detection

782
00:25:20,580 --> 00:25:22,679
against that edrs are kind of the

783
00:25:22,679 --> 00:25:25,200
antivirus of the 1990s but more so from

784
00:25:25,200 --> 00:25:26,700
a tactics techniques and procedures

785
00:25:26,700 --> 00:25:28,740
perspective and so in this example here

786
00:25:28,740 --> 00:25:30,000
I'm going to use my tool called Magic

787
00:25:30,000 --> 00:25:31,559
unicorn

788
00:25:31,559 --> 00:25:33,539
and this uses Powershell and it uses

789
00:25:33,539 --> 00:25:34,980
what's called an x86 downgrade attack

790
00:25:34,980 --> 00:25:36,419
which injects Shell Code directly into

791
00:25:36,419 --> 00:25:38,220
memory now what we're going to do here

792
00:25:38,220 --> 00:25:39,779
is we're going to use interpreter which

793
00:25:39,779 --> 00:25:41,580
should be picked up by antivirus right

794
00:25:41,580 --> 00:25:43,200
you know interpreter is something that's

795
00:25:43,200 --> 00:25:44,640
well known I'm not going to use any

796
00:25:44,640 --> 00:25:46,140
obfuscation I'm not going to change in

797
00:25:46,140 --> 00:25:48,059
any way shape or form and I'm just going

798
00:25:48,059 --> 00:25:49,980
to generate this code here

799
00:25:49,980 --> 00:25:52,380
and I'm going to decode this this this

800
00:25:52,380 --> 00:25:54,059
Powershell command so you can see the

801
00:25:54,059 --> 00:25:55,679
raw command that's going to be executed

802
00:25:55,679 --> 00:25:57,840
in the Powershell interpreter now really

803
00:25:57,840 --> 00:25:59,940
quick just a brief introduction of what

804
00:25:59,940 --> 00:26:03,260
amsi is or the anti-mower scan interface

805
00:26:03,260 --> 00:26:07,080
amsi is is a hook into Powershell that

806
00:26:07,080 --> 00:26:08,640
right right when it's about to actually

807
00:26:08,640 --> 00:26:11,039
execute in the Powershell interpreter uh

808
00:26:11,039 --> 00:26:12,360
there's a hook for amsi and it has

809
00:26:12,360 --> 00:26:14,159
what's called AMS scan string and MSI

810
00:26:14,159 --> 00:26:16,679
scan buffer it'll take that code it'll

811
00:26:16,679 --> 00:26:19,140
compare it to that a specific amsi

812
00:26:19,140 --> 00:26:21,360
provider that amsi provider will scan

813
00:26:21,360 --> 00:26:22,380
that code to see if there's anything

814
00:26:22,380 --> 00:26:24,480
malicious in it so we have to get around

815
00:26:24,480 --> 00:26:26,760
the amsi provider essentially in this

816
00:26:26,760 --> 00:26:29,820
case it's going to be Windows Defender

817
00:26:29,820 --> 00:26:31,860
and so we run this tool and we're going

818
00:26:31,860 --> 00:26:33,299
to decode our code and we can see here

819
00:26:33,299 --> 00:26:35,220
here's our decoded code here

820
00:26:35,220 --> 00:26:37,799
and this is just uh if you piece this

821
00:26:37,799 --> 00:26:38,940
together it's just running invoke

822
00:26:38,940 --> 00:26:40,980
expression to inject our code directly

823
00:26:40,980 --> 00:26:42,360
into memory

824
00:26:42,360 --> 00:26:44,340
and we're going to execute it over here

825
00:26:44,340 --> 00:26:45,720
in the Powershell interpreter in our

826
00:26:45,720 --> 00:26:47,279
Windows machine

827
00:26:47,279 --> 00:26:48,840
I also need to create a listener to

828
00:26:48,840 --> 00:26:52,500
capture the shell if it works

829
00:26:52,500 --> 00:26:54,299
and over here we hit play we notice it

830
00:26:54,299 --> 00:26:55,440
gets a little bit blurry but uh you

831
00:26:55,440 --> 00:26:56,580
notice here it says it's malicious

832
00:26:56,580 --> 00:26:58,559
content so it blocks that specific thing

833
00:26:58,559 --> 00:27:00,960
from actually executing so in this

834
00:27:00,960 --> 00:27:02,340
specific case here when you start to

835
00:27:02,340 --> 00:27:04,919
look at how do I get around this we have

836
00:27:04,919 --> 00:27:06,539
to understand where is the detection

837
00:27:06,539 --> 00:27:08,039
coming from same thing from an EDR

838
00:27:08,039 --> 00:27:09,360
product perspective where is the

839
00:27:09,360 --> 00:27:10,799
detection coming from is everybody

840
00:27:10,799 --> 00:27:12,720
familiar with living off the land

841
00:27:12,720 --> 00:27:15,299
binaries and scripts right so wall bins

842
00:27:15,299 --> 00:27:17,880
are executables that are code signed

843
00:27:17,880 --> 00:27:19,559
typically by the operating system or a

844
00:27:19,559 --> 00:27:20,700
third-party platform that give you

845
00:27:20,700 --> 00:27:22,020
additional functionality whether that's

846
00:27:22,020 --> 00:27:24,059
download or execute attackers will

847
00:27:24,059 --> 00:27:25,740
commonly use those to abuse them to get

848
00:27:25,740 --> 00:27:27,539
code execution onto systems or to do

849
00:27:27,539 --> 00:27:29,400
certain types of functionality that get

850
00:27:29,400 --> 00:27:30,600
around application control or

851
00:27:30,600 --> 00:27:32,820
application or a lot or allow listing a

852
00:27:32,820 --> 00:27:34,679
good example of bypassing detection

853
00:27:34,679 --> 00:27:37,679
criteria is if you use Regis vr32 which

854
00:27:37,679 --> 00:27:39,120
is one of the most common ones that you

855
00:27:39,120 --> 00:27:40,559
typically see out there that is very

856
00:27:40,559 --> 00:27:42,480
nefarious most organizations don't ever

857
00:27:42,480 --> 00:27:44,520
use that binary especially from the user

858
00:27:44,520 --> 00:27:45,900
land side so if you see that you know

859
00:27:45,900 --> 00:27:48,659
something's actually wrong but most edrs

860
00:27:48,659 --> 00:27:50,220
and most antivirus products will

861
00:27:50,220 --> 00:27:52,440
completely shut down the use of register

862
00:27:52,440 --> 00:27:54,659
32 with certain parameter types so if

863
00:27:54,659 --> 00:27:56,580
you're using like slash s slash I slash

864
00:27:56,580 --> 00:27:59,580
uh it'll automatically block that but if

865
00:27:59,580 --> 00:28:02,220
you take Regis vr32 and you couple it

866
00:28:02,220 --> 00:28:04,440
with something like wget or bits admin

867
00:28:04,440 --> 00:28:05,820
and you use that to download the

868
00:28:05,820 --> 00:28:07,620
scriptlet object and then you call that

869
00:28:07,620 --> 00:28:09,720
without using the slash I parameter for

870
00:28:09,720 --> 00:28:11,640
the the not not using the download

871
00:28:11,640 --> 00:28:13,559
functionality it circumvents a detection

872
00:28:13,559 --> 00:28:15,120
criteria because you're not using all of

873
00:28:15,120 --> 00:28:17,520
those parameters to execute code so very

874
00:28:17,520 --> 00:28:19,740
fragile detections and again if we're

875
00:28:19,740 --> 00:28:21,659
just a novice type of attacker just by

876
00:28:21,659 --> 00:28:23,880
manipulating a little bit of our code we

877
00:28:23,880 --> 00:28:25,440
circumvent those detection criterias

878
00:28:25,440 --> 00:28:27,480
environments

879
00:28:27,480 --> 00:28:29,520
so if I remove the evoke expression side

880
00:28:29,520 --> 00:28:30,960
if I just move the IEX part the last

881
00:28:30,960 --> 00:28:32,100
part here notice here it doesn't

882
00:28:32,100 --> 00:28:34,919
actually trigger uh the antivirus alert

883
00:28:34,919 --> 00:28:36,419
so now we have to figure out well where

884
00:28:36,419 --> 00:28:38,159
is it actually you know coming from and

885
00:28:38,159 --> 00:28:38,940
all I'm going to do is I'm going to

886
00:28:38,940 --> 00:28:41,279
split this line up and say a equals that

887
00:28:41,279 --> 00:28:42,659
part of the code I'm going to make that

888
00:28:42,659 --> 00:28:46,140
say a can't be that easy right

889
00:28:46,140 --> 00:28:48,539
it is that easy and it's executes so

890
00:28:48,539 --> 00:28:49,980
just by splitting up that last command

891
00:28:49,980 --> 00:28:51,960
where that detection was written from we

892
00:28:51,960 --> 00:28:54,179
circumvent amsi the amsi provider that's

893
00:28:54,179 --> 00:28:55,860
scanning that code and we get our shell

894
00:28:55,860 --> 00:28:57,659
on the other side just by making some

895
00:28:57,659 --> 00:28:59,340
minor modifications to the code itself

896
00:28:59,340 --> 00:29:02,640
so again very fragile detections in our

897
00:29:02,640 --> 00:29:04,200
environments especially from third-party

898
00:29:04,200 --> 00:29:05,940
product perspectives that are supposed

899
00:29:05,940 --> 00:29:08,100
to be the backbone of our Security

900
00:29:08,100 --> 00:29:10,620
Programs right well I hate to tell you

901
00:29:10,620 --> 00:29:12,179
this but if you solely rely off of

902
00:29:12,179 --> 00:29:13,799
security products to fix your bad

903
00:29:13,799 --> 00:29:15,720
security practices you're already on

904
00:29:15,720 --> 00:29:17,520
technology is not going to fix the

905
00:29:17,520 --> 00:29:19,500
issues that you find today it's not

906
00:29:19,500 --> 00:29:20,760
really Morgan Freeman by the way to

907
00:29:20,760 --> 00:29:22,140
screw that in there

908
00:29:22,140 --> 00:29:24,600
um but I always hear his voice when I

909
00:29:24,600 --> 00:29:26,700
say it it's the best part

910
00:29:26,700 --> 00:29:27,659
um

911
00:29:27,659 --> 00:29:30,240
but the the the poor security practices

912
00:29:30,240 --> 00:29:32,399
that we have cannot be fixed by pieces

913
00:29:32,399 --> 00:29:34,440
of Technology unfortunately it requires

914
00:29:34,440 --> 00:29:36,419
us understanding visibility into our

915
00:29:36,419 --> 00:29:37,799
environment what's going on in our

916
00:29:37,799 --> 00:29:39,000
environment and being able to go from

917
00:29:39,000 --> 00:29:40,880
there

918
00:29:40,880 --> 00:29:44,460
msdt.exe is a great example so msdt.dxe

919
00:29:44,460 --> 00:29:46,440
the Felina attack that came out recently

920
00:29:46,440 --> 00:29:47,340
right

921
00:29:47,340 --> 00:29:49,140
um that was a law bin that allowed for

922
00:29:49,140 --> 00:29:50,640
remote code execution especially in

923
00:29:50,640 --> 00:29:51,960
office documents and everybody was

924
00:29:51,960 --> 00:29:53,279
panicking about that and there's no

925
00:29:53,279 --> 00:29:55,080
detections when it came out but if you

926
00:29:55,080 --> 00:29:57,179
look at the research research came back

927
00:29:57,179 --> 00:29:58,620
dates back to all the way to back to

928
00:29:58,620 --> 00:30:00,899
2015 around showing how you can use

929
00:30:00,899 --> 00:30:04,620
Felina uh use msdt.dxe as a way for code

930
00:30:04,620 --> 00:30:06,480
execution on the systems it just didn't

931
00:30:06,480 --> 00:30:07,799
allow code execution through office

932
00:30:07,799 --> 00:30:09,000
someone hadn't figured that that

933
00:30:09,000 --> 00:30:10,679
component out yet so we knew this is

934
00:30:10,679 --> 00:30:12,299
already problematic and it was already

935
00:30:12,299 --> 00:30:13,620
being abused in a while but there's no

936
00:30:13,620 --> 00:30:15,179
detections for it because again the

937
00:30:15,179 --> 00:30:16,860
fragility of our infrastructure is

938
00:30:16,860 --> 00:30:19,080
really based on how popular is this

939
00:30:19,080 --> 00:30:21,059
attack you know uh how many people

940
00:30:21,059 --> 00:30:23,399
download this tool and ultimately what

941
00:30:23,399 --> 00:30:24,539
signatures were actually written for

942
00:30:24,539 --> 00:30:27,240
this to be identified and so again you

943
00:30:27,240 --> 00:30:28,740
know it's one of those things where the

944
00:30:28,740 --> 00:30:30,600
fragile parts of our our infrastructure

945
00:30:30,600 --> 00:30:32,580
are really really important

946
00:30:32,580 --> 00:30:34,260
and what we'll typically see from a

947
00:30:34,260 --> 00:30:37,799
research perspective is that there'll be

948
00:30:37,799 --> 00:30:40,559
research on a specific attack but there

949
00:30:40,559 --> 00:30:42,240
might not be a tool released or a way to

950
00:30:42,240 --> 00:30:43,799
actually go and do it and so then

951
00:30:43,799 --> 00:30:45,899
there's no detections written uh we'll

952
00:30:45,899 --> 00:30:48,419
be releasing very soon this came from a

953
00:30:48,419 --> 00:30:50,399
obscure blog post from Sophos back in

954
00:30:50,399 --> 00:30:53,340
2019 uh looking at password managers uh

955
00:30:53,340 --> 00:30:55,860
password vaults and one of the bullet

956
00:30:55,860 --> 00:30:58,679
points in the article talks about how

957
00:30:58,679 --> 00:31:02,340
LastPass doesn't erase the hash that's

958
00:31:02,340 --> 00:31:05,220
in memory even when the vault is closed

959
00:31:05,220 --> 00:31:07,140
so we decided to take a look at that

960
00:31:07,140 --> 00:31:08,580
research and we've been using this for

961
00:31:08,580 --> 00:31:11,940
over a year you know to extract the

962
00:31:11,940 --> 00:31:14,940
vaults directly from memory on anybody

963
00:31:14,940 --> 00:31:16,559
that has LastPass installed and then

964
00:31:16,559 --> 00:31:18,480
again no no detections don't have to

965
00:31:18,480 --> 00:31:20,700
worry about anything we can if somebody

966
00:31:20,700 --> 00:31:22,140
has LastPass installed and they're using

967
00:31:22,140 --> 00:31:23,880
the browser plugins it's no issue for us

968
00:31:23,880 --> 00:31:26,880
whatsoever and so we'll be releasing a

969
00:31:26,880 --> 00:31:29,899
tool soon in the next couple of days

970
00:31:29,899 --> 00:31:33,059
that automatically searches through uh

971
00:31:33,059 --> 00:31:35,580
Chrome extensions and for Chrome and

972
00:31:35,580 --> 00:31:39,080
brave and will automatically extract the

973
00:31:39,080 --> 00:31:41,820
master password hash directly off of

974
00:31:41,820 --> 00:31:43,799
that that then gets salted that allows

975
00:31:43,799 --> 00:31:45,840
you to open up the Vault that allows you

976
00:31:45,840 --> 00:31:47,760
to extract all of the

977
00:31:47,760 --> 00:31:49,020
um you know passwords that are contained

978
00:31:49,020 --> 00:31:50,580
within a volt even if the person's

979
00:31:50,580 --> 00:31:51,539
logged off

980
00:31:51,539 --> 00:31:54,480
so it the so if I'm on a Windows machine

981
00:31:54,480 --> 00:31:57,659
and I log into the password Vault and I

982
00:31:57,659 --> 00:31:59,940
log off of it that password's still

983
00:31:59,940 --> 00:32:01,260
stored in a memory

984
00:32:01,260 --> 00:32:03,840
in a hash format that hash format then

985
00:32:03,840 --> 00:32:06,419
you salt it and then authenticate to the

986
00:32:06,419 --> 00:32:08,820
offline uh password Vault and allows you

987
00:32:08,820 --> 00:32:10,919
to extract those in addition if you're

988
00:32:10,919 --> 00:32:12,360
on a machine that has it and you just

989
00:32:12,360 --> 00:32:15,059
wait the clear text password is stored

990
00:32:15,059 --> 00:32:16,799
in memory for a few minutes uh during

991
00:32:16,799 --> 00:32:17,940
that period of time as well so you're

992
00:32:17,940 --> 00:32:19,260
able to extract that clear text password

993
00:32:19,260 --> 00:32:21,240
I remember if you need to again all the

994
00:32:21,240 --> 00:32:22,380
things that you can do directly from

995
00:32:22,380 --> 00:32:24,179
there but again things that are already

996
00:32:24,179 --> 00:32:26,039
researched that attackers if they look

997
00:32:26,039 --> 00:32:28,080
at it they build Tools around it and

998
00:32:28,080 --> 00:32:29,640
they start to uh you know automatically

999
00:32:29,640 --> 00:32:31,260
do those different things so that's why

1000
00:32:31,260 --> 00:32:33,179
you know when you look at

1001
00:32:33,179 --> 00:32:35,520
how fragile our infrastructure and

1002
00:32:35,520 --> 00:32:37,740
environments are today when it comes to

1003
00:32:37,740 --> 00:32:41,100
security again minor tweaks minor

1004
00:32:41,100 --> 00:32:42,899
changes completely circumvents most

1005
00:32:42,899 --> 00:32:44,399
detection programs that are out there

1006
00:32:44,399 --> 00:32:46,020
today especially if you're relying

1007
00:32:46,020 --> 00:32:47,640
specifically off of tools or products

1008
00:32:47,640 --> 00:32:50,340
what I find to be most effective is when

1009
00:32:50,340 --> 00:32:52,380
you make detections your own a good

1010
00:32:52,380 --> 00:32:53,940
example we were doing a red team

1011
00:32:53,940 --> 00:32:56,220
engagement for a really sophisticated

1012
00:32:56,220 --> 00:32:58,140
I'd say you know one percent of what we

1013
00:32:58,140 --> 00:32:59,460
deal with from a red teaming perspective

1014
00:32:59,460 --> 00:33:01,020
type of customers a financial

1015
00:33:01,020 --> 00:33:03,299
institution real difficult to get into

1016
00:33:03,299 --> 00:33:05,460
and we have six month engagements where

1017
00:33:05,460 --> 00:33:06,720
we have basically six months to break

1018
00:33:06,720 --> 00:33:08,760
into them it's a longer term spread out

1019
00:33:08,760 --> 00:33:11,039
red team engagement so we start building

1020
00:33:11,039 --> 00:33:12,539
tools and weaponizer stuff and look at

1021
00:33:12,539 --> 00:33:13,559
their infrastructure and try to figure

1022
00:33:13,559 --> 00:33:15,659
out the best ways in and we had done

1023
00:33:15,659 --> 00:33:17,279
this awesome hack and we have our own C2

1024
00:33:17,279 --> 00:33:19,320
that's internal that you know doesn't

1025
00:33:19,320 --> 00:33:20,399
get detected by anything which is

1026
00:33:20,399 --> 00:33:22,679
awesome and we get access to this box it

1027
00:33:22,679 --> 00:33:24,779
takes us like three months you know we

1028
00:33:24,779 --> 00:33:26,580
get a zero day we get access to their

1029
00:33:26,580 --> 00:33:28,740
machine compromise it and then we have

1030
00:33:28,740 --> 00:33:30,240
command and control established no

1031
00:33:30,240 --> 00:33:32,519
detections great everything's perfect

1032
00:33:32,519 --> 00:33:33,720
right now from an initial access

1033
00:33:33,720 --> 00:33:35,700
perspective everything's going wonderful

1034
00:33:35,700 --> 00:33:38,100
we were high-fiving each other it took

1035
00:33:38,100 --> 00:33:39,600
three months to get to this point and we

1036
00:33:39,600 --> 00:33:41,220
finally get there and we're on this

1037
00:33:41,220 --> 00:33:42,600
machine in this highly secured

1038
00:33:42,600 --> 00:33:43,980
environment and customer without any

1039
00:33:43,980 --> 00:33:45,600
detections

1040
00:33:45,600 --> 00:33:47,880
we start looking at the systems and we

1041
00:33:47,880 --> 00:33:51,120
hooked the API for who am I okay just to

1042
00:33:51,120 --> 00:33:52,440
see what we're running at we didn't run

1043
00:33:52,440 --> 00:33:54,000
the who am I command because that would

1044
00:33:54,000 --> 00:33:56,279
be not a good idea we wanted to see what

1045
00:33:56,279 --> 00:33:57,600
user account we're running over we

1046
00:33:57,600 --> 00:34:00,539
hooked the API for it they had a rule

1047
00:34:00,539 --> 00:34:02,760
set up in their environment that if

1048
00:34:02,760 --> 00:34:04,500
anything is querying who am I even the

1049
00:34:04,500 --> 00:34:07,799
API and it's a non-technical user to

1050
00:34:07,799 --> 00:34:09,179
trigger an alarm

1051
00:34:09,179 --> 00:34:11,639
and so because it was a non-technical

1052
00:34:11,639 --> 00:34:13,619
user they Baseline their users in two

1053
00:34:13,619 --> 00:34:15,359
different ad groups you know if you had

1054
00:34:15,359 --> 00:34:17,099
like a web developer title or an I.T

1055
00:34:17,099 --> 00:34:18,899
admin you were in a technical group if

1056
00:34:18,899 --> 00:34:20,219
you're in a non-technical group and you

1057
00:34:20,219 --> 00:34:21,359
triggered that it automatically

1058
00:34:21,359 --> 00:34:22,800
triggered an alarm we got bust and they

1059
00:34:22,800 --> 00:34:24,480
shut off our access it was like three

1060
00:34:24,480 --> 00:34:25,918
months worth of work and totally busted

1061
00:34:25,918 --> 00:34:28,560
us I'm like crap that sucks you know

1062
00:34:28,560 --> 00:34:30,119
worst day ever for us and we're

1063
00:34:30,119 --> 00:34:31,560
definitely we're not high-fiving at that

1064
00:34:31,560 --> 00:34:32,820
period of time

1065
00:34:32,820 --> 00:34:35,099
um and so it's the things that are your

1066
00:34:35,099 --> 00:34:37,679
own that make it very difficult for us

1067
00:34:37,679 --> 00:34:40,379
as as attackers to understand deception

1068
00:34:40,379 --> 00:34:42,300
is another great example if you have

1069
00:34:42,300 --> 00:34:43,679
deception in your environment and we're

1070
00:34:43,679 --> 00:34:44,879
sitting there trying to run over

1071
00:34:44,879 --> 00:34:46,440
landmines you know you have fake

1072
00:34:46,440 --> 00:34:48,359
credentials stored in memory or there's

1073
00:34:48,359 --> 00:34:49,800
a folder in there that looks like it has

1074
00:34:49,800 --> 00:34:51,300
credentials in and we authenticate to a

1075
00:34:51,300 --> 00:34:53,159
machine that you know is a honey system

1076
00:34:53,159 --> 00:34:55,379
that now triggers alarms we don't know

1077
00:34:55,379 --> 00:34:56,879
the difference as attackers typically

1078
00:34:56,879 --> 00:34:59,220
one of my favorite ones that I saw on an

1079
00:34:59,220 --> 00:35:02,280
organization is um they had a run-ass

1080
00:35:02,280 --> 00:35:04,380
script that would run on every single

1081
00:35:04,380 --> 00:35:05,880
user account that looked like a service

1082
00:35:05,880 --> 00:35:07,859
account that service account if you

1083
00:35:07,859 --> 00:35:09,599
looked at the permissions description

1084
00:35:09,599 --> 00:35:11,579
because we were already authenticated as

1085
00:35:11,579 --> 00:35:12,540
a normal user we can get the

1086
00:35:12,540 --> 00:35:14,940
descriptions out of ad it was a backup

1087
00:35:14,940 --> 00:35:17,460
service account for one of their backup

1088
00:35:17,460 --> 00:35:19,619
softwares um it looked legitimate

1089
00:35:19,619 --> 00:35:21,420
legitimate as hell so we get the

1090
00:35:21,420 --> 00:35:23,339
username and password it's got domain

1091
00:35:23,339 --> 00:35:24,540
admin rights of course because every

1092
00:35:24,540 --> 00:35:26,579
Backup Service needs domain admin rights

1093
00:35:26,579 --> 00:35:28,320
and I'm like all right cool we're in

1094
00:35:28,320 --> 00:35:29,820
like this is the easiest assessment ever

1095
00:35:29,820 --> 00:35:31,440
we got initial access we got the machine

1096
00:35:31,440 --> 00:35:33,540
we got a domain admin account I go to

1097
00:35:33,540 --> 00:35:34,920
authenticate and it says invalid

1098
00:35:34,920 --> 00:35:36,180
password I'm like oh that's really weird

1099
00:35:36,180 --> 00:35:38,460
and it triggered all hell alarms you

1100
00:35:38,460 --> 00:35:40,380
know honey pots uh stuff they'd put the

1101
00:35:40,380 --> 00:35:42,720
systems in or the username and passwords

1102
00:35:42,720 --> 00:35:45,119
and memory with a bad password which

1103
00:35:45,119 --> 00:35:46,619
authenticated to a domain controller

1104
00:35:46,619 --> 00:35:48,119
that should never have been using that

1105
00:35:48,119 --> 00:35:49,440
username and password because it was a

1106
00:35:49,440 --> 00:35:51,180
honey honey credit account totally

1107
00:35:51,180 --> 00:35:52,560
busted Us in those environments it's

1108
00:35:52,560 --> 00:35:55,380
hard for us to differentiate detections

1109
00:35:55,380 --> 00:35:57,119
in an environment that is based on an

1110
00:35:57,119 --> 00:35:59,040
environment's uh the environment itself

1111
00:35:59,040 --> 00:36:00,420
it's just really difficult for us as

1112
00:36:00,420 --> 00:36:02,400
attackers to do that

1113
00:36:02,400 --> 00:36:03,900
so let's talk about looking ahead what

1114
00:36:03,900 --> 00:36:06,420
does that look like in environments and

1115
00:36:06,420 --> 00:36:07,859
how do we get better with what we're

1116
00:36:07,859 --> 00:36:09,839
seeing out there we obviously saw that

1117
00:36:09,839 --> 00:36:11,520
it's fairly easy to circumvent and get

1118
00:36:11,520 --> 00:36:13,680
around detection criteria today if we're

1119
00:36:13,680 --> 00:36:15,660
using commodity things things that are

1120
00:36:15,660 --> 00:36:17,160
built into tools things that are built

1121
00:36:17,160 --> 00:36:19,260
into products that we use are usually

1122
00:36:19,260 --> 00:36:21,240
less of a concern for us than things

1123
00:36:21,240 --> 00:36:22,560
that are built in environments that

1124
00:36:22,560 --> 00:36:25,320
people understand and I think uh we had

1125
00:36:25,320 --> 00:36:27,060
a good start with things like the minor

1126
00:36:27,060 --> 00:36:29,339
attack framework the problem with miter

1127
00:36:29,339 --> 00:36:31,920
is that almost everybody uses miter as a

1128
00:36:31,920 --> 00:36:34,500
checklist so you see a TTP you write a

1129
00:36:34,500 --> 00:36:36,180
detection for a TTP or does my product

1130
00:36:36,180 --> 00:36:38,339
actually have those they don't take into

1131
00:36:38,339 --> 00:36:39,960
account like let's Baseline my

1132
00:36:39,960 --> 00:36:41,760
environment and let's look for things

1133
00:36:41,760 --> 00:36:44,400
like Regis vr32 does registr32 ever

1134
00:36:44,400 --> 00:36:46,680
execute from under the context as a

1135
00:36:46,680 --> 00:36:49,619
regular user no okay anytime that

1136
00:36:49,619 --> 00:36:51,300
process is ever created regardless

1137
00:36:51,300 --> 00:36:54,240
irrespective of you know uh variable

1138
00:36:54,240 --> 00:36:56,400
Flags or you know flag arguments we're

1139
00:36:56,400 --> 00:36:58,079
going to alert on that to investigate

1140
00:36:58,079 --> 00:37:00,180
understanding our environment is really

1141
00:37:00,180 --> 00:37:01,619
really important same thing for lateral

1142
00:37:01,619 --> 00:37:03,720
movement do you typically have an

1143
00:37:03,720 --> 00:37:05,040
administrator account from the same

1144
00:37:05,040 --> 00:37:07,200
Source on workstations logging into

1145
00:37:07,200 --> 00:37:09,359
other workstations from a workstation

1146
00:37:09,359 --> 00:37:10,859
workstation communication perspective

1147
00:37:10,859 --> 00:37:12,900
probably not those are the things you

1148
00:37:12,900 --> 00:37:14,160
kind of have to start to look at and say

1149
00:37:14,160 --> 00:37:15,960
these are weird in my environment and

1150
00:37:15,960 --> 00:37:17,700
you look at ransomware groups the the

1151
00:37:17,700 --> 00:37:19,440
terrifying thing about ransomware groups

1152
00:37:19,440 --> 00:37:21,540
is they're using legitimate applications

1153
00:37:21,540 --> 00:37:25,320
tooling and software not necessarily uh

1154
00:37:25,320 --> 00:37:29,040
you know c2s or or implants or you know

1155
00:37:29,040 --> 00:37:31,320
hacker tools like impact it's not saying

1156
00:37:31,320 --> 00:37:32,460
that impact as a hacker tool it's a

1157
00:37:32,460 --> 00:37:34,380
great tool it's amazing to go and do all

1158
00:37:34,380 --> 00:37:35,880
the awesome stuff that they do they use

1159
00:37:35,880 --> 00:37:37,560
legitimate applications they use RDP

1160
00:37:37,560 --> 00:37:40,260
they use PS exec interesting enough we

1161
00:37:40,260 --> 00:37:41,940
were doing a threat hunt on an

1162
00:37:41,940 --> 00:37:44,339
organization recently and we looked at

1163
00:37:44,339 --> 00:37:46,020
all the remoting Tools in our

1164
00:37:46,020 --> 00:37:48,119
organization and there's a concept you

1165
00:37:48,119 --> 00:37:49,980
can apply to data called the long tail

1166
00:37:49,980 --> 00:37:51,900
if you're not familiar with it as a book

1167
00:37:51,900 --> 00:37:54,060
that came out in like the 60s it has

1168
00:37:54,060 --> 00:37:55,680
nothing to do with with data but

1169
00:37:55,680 --> 00:37:57,540
applying the same concept of if there's

1170
00:37:57,540 --> 00:37:59,940
a lot of noise up here this is probably

1171
00:37:59,940 --> 00:38:02,160
normal the high noise stuff is probably

1172
00:38:02,160 --> 00:38:04,079
normal when you start looking down the

1173
00:38:04,079 --> 00:38:06,180
tail and you have these these these tail

1174
00:38:06,180 --> 00:38:07,859
parts that are very minimum as far as

1175
00:38:07,859 --> 00:38:09,720
noise like maybe one or two processes

1176
00:38:09,720 --> 00:38:11,040
that are executing in your environment

1177
00:38:11,040 --> 00:38:12,540
those are the things that you want to

1178
00:38:12,540 --> 00:38:13,680
take a look at and say hey is that

1179
00:38:13,680 --> 00:38:15,599
normal in my environment and so we start

1180
00:38:15,599 --> 00:38:16,920
looking at all remoting software and

1181
00:38:16,920 --> 00:38:18,420
organization you can see hey they're

1182
00:38:18,420 --> 00:38:19,800
using this remoting software all over

1183
00:38:19,800 --> 00:38:22,200
here but there's these two instances of

1184
00:38:22,200 --> 00:38:23,940
remoting software that's not used across

1185
00:38:23,940 --> 00:38:25,260
the entire company that's really weird

1186
00:38:25,260 --> 00:38:28,079
so we ended up uh talking to the

1187
00:38:28,079 --> 00:38:29,820
customer they reached out to the two

1188
00:38:29,820 --> 00:38:31,320
individual workstations that had this

1189
00:38:31,320 --> 00:38:33,180
remote software on there and the two

1190
00:38:33,180 --> 00:38:34,500
individuals like yeah I just got a call

1191
00:38:34,500 --> 00:38:37,320
from it yesterday and they told us that

1192
00:38:37,320 --> 00:38:38,640
we had to install this remoting software

1193
00:38:38,640 --> 00:38:40,260
so that you know they could fix an issue

1194
00:38:40,260 --> 00:38:41,400
with our computer so they just

1195
00:38:41,400 --> 00:38:42,660
downloaded and installed the remoting

1196
00:38:42,660 --> 00:38:44,160
software which happened to be you know

1197
00:38:44,160 --> 00:38:45,420
TeamViewer which wasn't used in their

1198
00:38:45,420 --> 00:38:47,099
entire environment so you know using

1199
00:38:47,099 --> 00:38:49,560
legitimate applications calling up on

1200
00:38:49,560 --> 00:38:51,359
the phone these are all things that are

1201
00:38:51,359 --> 00:38:52,980
possible now that are very difficult to

1202
00:38:52,980 --> 00:38:55,320
identify and detect I mean but anybody's

1203
00:38:55,320 --> 00:38:57,720
detection capabilities identify that

1204
00:38:57,720 --> 00:38:59,099
specific type of attack in their

1205
00:38:59,099 --> 00:39:00,300
environment

1206
00:39:00,300 --> 00:39:02,040
maybe maybe not again if we have

1207
00:39:02,040 --> 00:39:03,599
customized detections maybe but using

1208
00:39:03,599 --> 00:39:08,280
legitimate uh remote software we'll see

1209
00:39:08,280 --> 00:39:09,960
so some basic principles that we need

1210
00:39:09,960 --> 00:39:13,440
Telemetry today is so important storage

1211
00:39:13,440 --> 00:39:15,960
is cheap I'm saying you need full packet

1212
00:39:15,960 --> 00:39:17,099
captures and everything else but storage

1213
00:39:17,099 --> 00:39:19,200
is relatively inexpensive it's a lot

1214
00:39:19,200 --> 00:39:22,260
more inexpensive than it was 10 years

1215
00:39:22,260 --> 00:39:25,560
ago from a data perspective Telemetry in

1216
00:39:25,560 --> 00:39:27,119
our Cloud infrastructure Telemetry from

1217
00:39:27,119 --> 00:39:28,619
on-premise infrastructure Network

1218
00:39:28,619 --> 00:39:30,839
Telemetry is amazing all those things

1219
00:39:30,839 --> 00:39:32,760
together really start to paint the

1220
00:39:32,760 --> 00:39:34,320
picture of what our environment looks

1221
00:39:34,320 --> 00:39:36,359
like and what we need to start to do to

1222
00:39:36,359 --> 00:39:38,339
understand deviations of patterns of

1223
00:39:38,339 --> 00:39:40,079
behavior you look at a lot of the

1224
00:39:40,079 --> 00:39:41,400
textures that come out in the security

1225
00:39:41,400 --> 00:39:42,839
industry on Twitter or wherever else

1226
00:39:42,839 --> 00:39:44,940
they're one-to-one detections they're

1227
00:39:44,940 --> 00:39:46,800
looking very specific for very specific

1228
00:39:46,800 --> 00:39:48,900
things in specific environments and

1229
00:39:48,900 --> 00:39:50,280
those are great from a response

1230
00:39:50,280 --> 00:39:51,900
perspective or to see if we've had that

1231
00:39:51,900 --> 00:39:53,640
very similar attack that was seen over

1232
00:39:53,640 --> 00:39:56,520
here but you know two weeks go by a few

1233
00:39:56,520 --> 00:39:58,920
hours go by a month goes by that attack

1234
00:39:58,920 --> 00:40:01,020
is changing that attack is completely

1235
00:40:01,020 --> 00:40:02,160
different than the attack that was

1236
00:40:02,160 --> 00:40:03,300
originally here in your one-to-one

1237
00:40:03,300 --> 00:40:05,700
detection isn't necessarily as valid as

1238
00:40:05,700 --> 00:40:07,920
it used to be so one-to-one detections

1239
00:40:07,920 --> 00:40:09,180
are good those are things that we want

1240
00:40:09,180 --> 00:40:10,560
to look for in our environment from

1241
00:40:10,560 --> 00:40:12,839
previously known data breaches attacks

1242
00:40:12,839 --> 00:40:14,760
things of that effect but the

1243
00:40:14,760 --> 00:40:16,320
understanding of our own environment and

1244
00:40:16,320 --> 00:40:17,700
the behavior that's exhibited around

1245
00:40:17,700 --> 00:40:21,020
there becomes extremely important

1246
00:40:21,060 --> 00:40:23,640
and from there baselining and monitoring

1247
00:40:23,640 --> 00:40:25,560
um you know register 32 is a great

1248
00:40:25,560 --> 00:40:27,060
example because again you don't see that

1249
00:40:27,060 --> 00:40:28,859
everywhere but Powershell is a whole

1250
00:40:28,859 --> 00:40:30,660
other example Powershell is used

1251
00:40:30,660 --> 00:40:32,400
everywhere isn't it but it's also used

1252
00:40:32,400 --> 00:40:34,560
very heavily by attackers but does

1253
00:40:34,560 --> 00:40:36,060
everybody need a full-fledged

1254
00:40:36,060 --> 00:40:37,980
programming language at their fingertips

1255
00:40:37,980 --> 00:40:40,619
those Bob and sales need a Powershell

1256
00:40:40,619 --> 00:40:42,300
runtime environment

1257
00:40:42,300 --> 00:40:45,240
probably not so how do we reduce our

1258
00:40:45,240 --> 00:40:46,680
behavior and understand that and say

1259
00:40:46,680 --> 00:40:49,140
well if Powershell is being run under

1260
00:40:49,140 --> 00:40:50,940
the context of a regular user account

1261
00:40:50,940 --> 00:40:54,599
minus these exception you know groups

1262
00:40:54,599 --> 00:40:56,880
that are development or whatever is that

1263
00:40:56,880 --> 00:40:58,020
something we want to investigate and

1264
00:40:58,020 --> 00:40:59,339
look at or can we block that

1265
00:40:59,339 --> 00:41:00,480
specifically in our environment because

1266
00:41:00,480 --> 00:41:01,740
not everybody needs access the

1267
00:41:01,740 --> 00:41:02,460
Powershell we don't have any

1268
00:41:02,460 --> 00:41:03,780
applications that run or we have to put

1269
00:41:03,780 --> 00:41:05,760
exceptions in place baselining and

1270
00:41:05,760 --> 00:41:07,920
exceptions are really what's most

1271
00:41:07,920 --> 00:41:09,420
effective and those are the things that

1272
00:41:09,420 --> 00:41:11,700
really shut us down from an attacker's

1273
00:41:11,700 --> 00:41:13,140
perspective again going into an

1274
00:41:13,140 --> 00:41:15,060
environment that has customized

1275
00:41:15,060 --> 00:41:16,680
detections that is based off of their

1276
00:41:16,680 --> 00:41:18,000
own environment and their own behavior

1277
00:41:18,000 --> 00:41:20,820
is a nightmare for us it's very

1278
00:41:20,820 --> 00:41:22,680
difficult for us to understand what you

1279
00:41:22,680 --> 00:41:24,980
have now there are ways around that too

1280
00:41:24,980 --> 00:41:27,359
if you go into an environment that has a

1281
00:41:27,359 --> 00:41:29,520
mature detection program

1282
00:41:29,520 --> 00:41:32,579
what the story you tell is really

1283
00:41:32,579 --> 00:41:34,740
important so if you're using uh

1284
00:41:34,740 --> 00:41:36,180
obfuscated code you're using a

1285
00:41:36,180 --> 00:41:37,380
Powershell code that's heavily

1286
00:41:37,380 --> 00:41:39,839
manipulated it's obfuscated it has you

1287
00:41:39,839 --> 00:41:41,880
know substitution variables it has

1288
00:41:41,880 --> 00:41:43,800
injection of Powershell and if an

1289
00:41:43,800 --> 00:41:45,720
analyst looks at that they're gonna be

1290
00:41:45,720 --> 00:41:47,099
like yes that's malicious like that's

1291
00:41:47,099 --> 00:41:49,440
horrible right but if you download a

1292
00:41:49,440 --> 00:41:51,240
Powershell script from the internet

1293
00:41:51,240 --> 00:41:54,720
that's 500 lines of code and you put in

1294
00:41:54,720 --> 00:41:56,460
the you know comment section you do a

1295
00:41:56,460 --> 00:41:58,500
LinkedIn oh synth you know research on

1296
00:41:58,500 --> 00:42:00,300
the the environment you say who's the

1297
00:42:00,300 --> 00:42:01,859
head of it in this in this organization

1298
00:42:01,859 --> 00:42:03,480
and you put a comment code in here

1299
00:42:03,480 --> 00:42:04,980
saying this is what we use for data

1300
00:42:04,980 --> 00:42:07,020
Telemetry metrics you know written by

1301
00:42:07,020 --> 00:42:08,820
the head I.T person in your environment

1302
00:42:08,820 --> 00:42:11,040
and then halfway through that code you

1303
00:42:11,040 --> 00:42:12,359
throw your malicious code in there you

1304
00:42:12,359 --> 00:42:15,839
know line 470 is an analyst really going

1305
00:42:15,839 --> 00:42:18,599
to go through 470 lines of code to

1306
00:42:18,599 --> 00:42:20,460
identify that one malicious line of code

1307
00:42:20,460 --> 00:42:22,140
when it's already you know authored by

1308
00:42:22,140 --> 00:42:23,760
the main it person in your environment

1309
00:42:23,760 --> 00:42:26,280
probably not so there are ways that we

1310
00:42:26,280 --> 00:42:27,780
can get better from an offensive

1311
00:42:27,780 --> 00:42:30,720
perspective to tell a different story

1312
00:42:30,720 --> 00:42:32,880
when we know we're going to be seen in

1313
00:42:32,880 --> 00:42:35,099
environments but I rarely have to use

1314
00:42:35,099 --> 00:42:36,480
that because most of the time the

1315
00:42:36,480 --> 00:42:37,619
monitoring detection capabilities in

1316
00:42:37,619 --> 00:42:41,640
most organizations are are pretty weak

1317
00:42:41,640 --> 00:42:42,960
so getting into some last things here

1318
00:42:42,960 --> 00:42:44,760
and open up for some questions

1319
00:42:44,760 --> 00:42:46,320
there's a lot of cool things that we can

1320
00:42:46,320 --> 00:42:47,940
do in our environments to make it more

1321
00:42:47,940 --> 00:42:49,560
secure these are Basics that we all know

1322
00:42:49,560 --> 00:42:51,180
about I'm not going to sit here and

1323
00:42:51,180 --> 00:42:52,740
rehash you know hey you all should do

1324
00:42:52,740 --> 00:42:54,180
Network segmentation we've been talking

1325
00:42:54,180 --> 00:42:56,880
about that since like 1990 you know hey

1326
00:42:56,880 --> 00:42:58,200
you should Pat your systems hey we've

1327
00:42:58,200 --> 00:43:00,720
been talking about that since 1990 but

1328
00:43:00,720 --> 00:43:02,040
really there are things that can shut

1329
00:43:02,040 --> 00:43:03,480
things down very quickly you know

1330
00:43:03,480 --> 00:43:04,800
Network segmentation is really important

1331
00:43:04,800 --> 00:43:06,240
workstation workstation communication if

1332
00:43:06,240 --> 00:43:08,400
you look at the Crux of all the damages

1333
00:43:08,400 --> 00:43:09,960
that we see from most of these types of

1334
00:43:09,960 --> 00:43:12,599
attacks it's lateral movement it's the

1335
00:43:12,599 --> 00:43:14,099
ability to move from one system to the

1336
00:43:14,099 --> 00:43:15,420
next system to the next system to the

1337
00:43:15,420 --> 00:43:16,680
next system until they get access to the

1338
00:43:16,680 --> 00:43:18,720
data they want to they get access to the

1339
00:43:18,720 --> 00:43:19,859
backup so they get access to everything

1340
00:43:19,859 --> 00:43:21,660
else and they still that data they

1341
00:43:21,660 --> 00:43:22,859
encrypt all that data and they send it

1342
00:43:22,859 --> 00:43:24,900
out preventing lateral movement in some

1343
00:43:24,900 --> 00:43:27,359
way shape or form will make a very big

1344
00:43:27,359 --> 00:43:29,819
deal to reducing the amount of damage

1345
00:43:29,819 --> 00:43:31,319
that you have from a specific attack and

1346
00:43:31,319 --> 00:43:32,280
that's ultimately what we're trying to

1347
00:43:32,280 --> 00:43:34,859
do can we respond faster to a successful

1348
00:43:34,859 --> 00:43:36,119
attack because we know we're not going

1349
00:43:36,119 --> 00:43:38,280
to be perfect or can we reduce the

1350
00:43:38,280 --> 00:43:39,780
amount of damage that happens if we

1351
00:43:39,780 --> 00:43:41,220
don't detect it in our own environment

1352
00:43:41,220 --> 00:43:43,440
and that's ultimately the battle that we

1353
00:43:43,440 --> 00:43:44,220
have

1354
00:43:44,220 --> 00:43:46,560
prevention takes a long time to

1355
00:43:46,560 --> 00:43:47,940
implement would everybody agree with

1356
00:43:47,940 --> 00:43:50,400
that like to make a big change in your

1357
00:43:50,400 --> 00:43:51,960
environment does it happen overnight can

1358
00:43:51,960 --> 00:43:53,460
you do allow listing or application

1359
00:43:53,460 --> 00:43:54,780
control overnight in your in your

1360
00:43:54,780 --> 00:43:55,740
environment

1361
00:43:55,740 --> 00:43:58,079
no it takes time right unless you have

1362
00:43:58,079 --> 00:43:59,940
an awesome program that allows you to

1363
00:43:59,940 --> 00:44:01,079
break everything in your environment

1364
00:44:01,079 --> 00:44:02,940
then that's awesome for you that's cool

1365
00:44:02,940 --> 00:44:04,980
but most time most of the time you're

1366
00:44:04,980 --> 00:44:06,119
not going to be able to make big

1367
00:44:06,119 --> 00:44:08,760
sweeping changes of protection in your

1368
00:44:08,760 --> 00:44:10,680
environment immediately and that's what

1369
00:44:10,680 --> 00:44:11,880
we really have to think about is that

1370
00:44:11,880 --> 00:44:13,560
yes we have

1371
00:44:13,560 --> 00:44:15,359
multiple ways that we need to secure

1372
00:44:15,359 --> 00:44:16,740
environments that's going to take time

1373
00:44:16,740 --> 00:44:18,540
our businesses are going to have to ride

1374
00:44:18,540 --> 00:44:19,920
with us eventually down that road we're

1375
00:44:19,920 --> 00:44:20,940
going to have to eventually Implement

1376
00:44:20,940 --> 00:44:22,319
multi-factor authentication which I

1377
00:44:22,319 --> 00:44:24,300
thought was really interesting at blue

1378
00:44:24,300 --> 00:44:26,400
hat they released a stat something like

1379
00:44:26,400 --> 00:44:30,119
out of all Office 365 members only uh 76

1380
00:44:30,119 --> 00:44:31,920
did not have multi-factor authentication

1381
00:44:31,920 --> 00:44:33,480
enabled which I thought was like a

1382
00:44:33,480 --> 00:44:36,240
really low number so only 30 percent or

1383
00:44:36,240 --> 00:44:38,579
so of multi-factor Authentication

1384
00:44:38,579 --> 00:44:41,400
is enabled on Microsoft 365 which is a

1385
00:44:41,400 --> 00:44:43,500
horrible thing to think about but again

1386
00:44:43,500 --> 00:44:45,359
those preventative things will take time

1387
00:44:45,359 --> 00:44:47,819
so how do we get faster as an industry

1388
00:44:47,819 --> 00:44:50,700
to respond quicker to attacks that we

1389
00:44:50,700 --> 00:44:51,720
know it's going to take time to actually

1390
00:44:51,720 --> 00:44:53,400
shut down and prevent and that's really

1391
00:44:53,400 --> 00:44:55,380
through Telemetry data and understanding

1392
00:44:55,380 --> 00:44:56,819
our environments being able to pull that

1393
00:44:56,819 --> 00:44:58,560
data back and respond much more

1394
00:44:58,560 --> 00:44:59,880
effectively in the event that we're

1395
00:44:59,880 --> 00:45:01,980
actually attacked or hit and again the

1396
00:45:01,980 --> 00:45:04,079
difference between 10 years ago and

1397
00:45:04,079 --> 00:45:06,540
today is we're focusing on the patterns

1398
00:45:06,540 --> 00:45:08,940
of behavior that attackers use across

1399
00:45:08,940 --> 00:45:10,200
the board what does it look like from a

1400
00:45:10,200 --> 00:45:12,060
lateral movement perspective what does

1401
00:45:12,060 --> 00:45:13,500
it look like when we do privets

1402
00:45:13,500 --> 00:45:15,060
escalation what does it look like when

1403
00:45:15,060 --> 00:45:16,619
we extract clear text credentials out of

1404
00:45:16,619 --> 00:45:17,940
memory what does it look like when we

1405
00:45:17,940 --> 00:45:20,040
get access to a domain controller those

1406
00:45:20,040 --> 00:45:21,900
types of attacks and abuse of AD

1407
00:45:21,900 --> 00:45:23,819
permissions and everything else allows

1408
00:45:23,819 --> 00:45:25,079
us to really paint a picture of what's

1409
00:45:25,079 --> 00:45:26,460
commonly known attacks in the

1410
00:45:26,460 --> 00:45:28,319
environment I mean most attackers are

1411
00:45:28,319 --> 00:45:30,359
going to try to inject into lsas and

1412
00:45:30,359 --> 00:45:32,160
extract you know clear text passwords or

1413
00:45:32,160 --> 00:45:33,660
hash values out of memory they're going

1414
00:45:33,660 --> 00:45:35,160
to look for things like printer spool

1415
00:45:35,160 --> 00:45:37,260
options unconstrained delegation they're

1416
00:45:37,260 --> 00:45:38,220
going to look for service principal

1417
00:45:38,220 --> 00:45:40,980
names pns they're going to do llmnr or

1418
00:45:40,980 --> 00:45:42,240
local link multicast name resolution

1419
00:45:42,240 --> 00:45:44,160
protocol netball's name Services they're

1420
00:45:44,160 --> 00:45:45,540
going to do all those things pretty much

1421
00:45:45,540 --> 00:45:47,280
across your network consistently and

1422
00:45:47,280 --> 00:45:48,720
again if we can piece together what that

1423
00:45:48,720 --> 00:45:50,099
looks like from a behavior perspective

1424
00:45:50,099 --> 00:45:51,720
in our environment we have a much better

1425
00:45:51,720 --> 00:45:54,000
chance of really actually uh defending

1426
00:45:54,000 --> 00:45:55,859
against these things

1427
00:45:55,859 --> 00:45:57,480
so my final thoughts and I'll open up

1428
00:45:57,480 --> 00:45:59,280
for any questions that we have is that

1429
00:45:59,280 --> 00:46:01,980
you know security is still complex I

1430
00:46:01,980 --> 00:46:03,900
mean you look at the attacks that are

1431
00:46:03,900 --> 00:46:06,240
being used today uh you know harm joy

1432
00:46:06,240 --> 00:46:07,500
and those folks releasing stuff on the

1433
00:46:07,500 --> 00:46:08,819
the ca abuse stuff that you can do

1434
00:46:08,819 --> 00:46:11,359
that'll be around for the next 10 years

1435
00:46:11,359 --> 00:46:13,680
llmnr will still be around for another

1436
00:46:13,680 --> 00:46:16,500
10 more years you know uh all this these

1437
00:46:16,500 --> 00:46:18,900
these misconfigurations uh ways of

1438
00:46:18,900 --> 00:46:20,700
abusing active directory ways of abusing

1439
00:46:20,700 --> 00:46:22,619
misconfigurations in environments are

1440
00:46:22,619 --> 00:46:24,119
going to continue to be around and most

1441
00:46:24,119 --> 00:46:25,680
organizations don't even know they exist

1442
00:46:25,680 --> 00:46:27,060
because they're not continuously

1443
00:46:27,060 --> 00:46:28,920
focusing on that so until we reduce the

1444
00:46:28,920 --> 00:46:30,660
complexity

1445
00:46:30,660 --> 00:46:32,099
um it's going to be more complex for us

1446
00:46:32,099 --> 00:46:33,060
to actually address those security

1447
00:46:33,060 --> 00:46:35,099
concerns and for me until we can make

1448
00:46:35,099 --> 00:46:36,599
security industry and understandable for

1449
00:46:36,599 --> 00:46:38,640
everybody which is a really hard thing

1450
00:46:38,640 --> 00:46:41,579
uh to say or to do we're going to

1451
00:46:41,579 --> 00:46:43,079
continue to see a lot of the breaches

1452
00:46:43,079 --> 00:46:44,160
that we see today from a lot of these

1453
00:46:44,160 --> 00:46:45,359
different organized crime groups and

1454
00:46:45,359 --> 00:46:46,560
they're only going to continue to get

1455
00:46:46,560 --> 00:46:48,420
better and better and better and

1456
00:46:48,420 --> 00:46:49,920
diversify and specialize in different

1457
00:46:49,920 --> 00:46:52,079
areas and continue to focus on going

1458
00:46:52,079 --> 00:46:54,240
after organizations and companies

1459
00:46:54,240 --> 00:46:56,160
but with that I'd like to open up for

1460
00:46:56,160 --> 00:46:58,640
any questions

1461
00:46:58,859 --> 00:47:02,060
anybody have any questions thank you

1462
00:47:08,339 --> 00:47:10,740
great question here awesome

1463
00:47:10,740 --> 00:47:13,079
he's got a he's got a mic here

1464
00:47:13,079 --> 00:47:14,460
it's got to be a really nice question

1465
00:47:14,460 --> 00:47:17,040
though about Nano sure test well so

1466
00:47:17,040 --> 00:47:19,200
actually it's VI versus emacs but I

1467
00:47:19,200 --> 00:47:20,960
guess I'm that old

1468
00:47:20,960 --> 00:47:24,060
nothing wrong with Nano or any of them

1469
00:47:24,060 --> 00:47:26,880
um we talk a lot about security but like

1470
00:47:26,880 --> 00:47:29,700
when it comes to critical infrastructure

1471
00:47:29,700 --> 00:47:32,099
their safety implications for this

1472
00:47:32,099 --> 00:47:34,200
too and we talk about well this is going

1473
00:47:34,200 --> 00:47:35,940
to be this way in 10 years and it

1474
00:47:35,940 --> 00:47:38,660
probably will be in 20. but like

1475
00:47:38,660 --> 00:47:41,760
defending is hard absolutely what is

1476
00:47:41,760 --> 00:47:44,700
your advice for a cash strapped critical

1477
00:47:44,700 --> 00:47:46,680
infrastructure provider that's trying to

1478
00:47:46,680 --> 00:47:49,920
increase their safety margins from a pen

1479
00:47:49,920 --> 00:47:51,480
tester's perspective

1480
00:47:51,480 --> 00:47:53,579
what are some pragmatic things that can

1481
00:47:53,579 --> 00:47:55,920
be done to increase safety yeah good

1482
00:47:55,920 --> 00:47:58,319
question so critical infrastructure is a

1483
00:47:58,319 --> 00:48:00,900
whole uh plethora of discussion topics

1484
00:48:00,900 --> 00:48:03,180
that I could talk quite a bit about on

1485
00:48:03,180 --> 00:48:04,200
um the issue with critical

1486
00:48:04,200 --> 00:48:05,460
infrastructure you see is that you know

1487
00:48:05,460 --> 00:48:08,040
these are systems that run you know

1488
00:48:08,040 --> 00:48:10,079
energy that run medical treatment

1489
00:48:10,079 --> 00:48:11,400
facilities that run a lot of other

1490
00:48:11,400 --> 00:48:12,780
things that are really important for us

1491
00:48:12,780 --> 00:48:15,119
so when you look at what we Define as

1492
00:48:15,119 --> 00:48:16,440
critical infrastructure these devices

1493
00:48:16,440 --> 00:48:19,020
could be 10 15 20 years old they have to

1494
00:48:19,020 --> 00:48:20,579
go through a major accreditation process

1495
00:48:20,579 --> 00:48:22,380
just to get patches put onto their into

1496
00:48:22,380 --> 00:48:24,180
their system so they're going to be

1497
00:48:24,180 --> 00:48:25,440
delayed they're not going to be secure

1498
00:48:25,440 --> 00:48:26,460
they're not going to be secure out of

1499
00:48:26,460 --> 00:48:28,260
the box and they're very difficult from

1500
00:48:28,260 --> 00:48:30,000
a black box perspective to even

1501
00:48:30,000 --> 00:48:32,040
understand ports protocols hardening

1502
00:48:32,040 --> 00:48:33,839
everything else and then you topple that

1503
00:48:33,839 --> 00:48:38,099
with uh the ability for a third-party

1504
00:48:38,099 --> 00:48:39,900
vendor management to you know remotely

1505
00:48:39,900 --> 00:48:41,819
service those devices and have access to

1506
00:48:41,819 --> 00:48:44,160
those so I think when you look at the

1507
00:48:44,160 --> 00:48:45,300
best way to look at critical

1508
00:48:45,300 --> 00:48:47,280
infrastructure and what we see most of

1509
00:48:47,280 --> 00:48:49,020
being the most effective is Network

1510
00:48:49,020 --> 00:48:51,060
segmentation as much as possible try to

1511
00:48:51,060 --> 00:48:53,160
keep those segmented away in their in

1512
00:48:53,160 --> 00:48:54,359
their own individual Island that's the

1513
00:48:54,359 --> 00:48:55,619
same thing you'd see for like Legacy

1514
00:48:55,619 --> 00:48:57,599
systems too you know if you have if

1515
00:48:57,599 --> 00:48:59,460
you're in a business and I'm sure no

1516
00:48:59,460 --> 00:49:01,560
businesses here have Legacy systems that

1517
00:49:01,560 --> 00:49:02,579
you're not allowed to touch or patch or

1518
00:49:02,579 --> 00:49:03,599
anything like that everybody's gotten

1519
00:49:03,599 --> 00:49:04,920
rid of all those

1520
00:49:04,920 --> 00:49:06,900
um but uh when you look at Legacy

1521
00:49:06,900 --> 00:49:08,760
systems you know you put them in what we

1522
00:49:08,760 --> 00:49:10,980
call more high security zones where you

1523
00:49:10,980 --> 00:49:12,180
have enhanced monitoring attacking

1524
00:49:12,180 --> 00:49:13,619
capabilities both Network Telemetry data

1525
00:49:13,619 --> 00:49:16,260
that understand you know plcs or logic

1526
00:49:16,260 --> 00:49:17,520
controller type information that

1527
00:49:17,520 --> 00:49:20,280
understand uh protocol analysis uh that

1528
00:49:20,280 --> 00:49:22,140
allow you to see you know new systems or

1529
00:49:22,140 --> 00:49:23,760
devices that are coming in there so a

1530
00:49:23,760 --> 00:49:25,859
lot more monitoring without touching

1531
00:49:25,859 --> 00:49:27,720
those systems not being as aggressive as

1532
00:49:27,720 --> 00:49:29,040
actually touching the system in the

1533
00:49:29,040 --> 00:49:30,780
first place and scanning them and trying

1534
00:49:30,780 --> 00:49:32,220
to hack them more so Network

1535
00:49:32,220 --> 00:49:34,200
segmentation and visibility I think is

1536
00:49:34,200 --> 00:49:35,880
is really critical in those environments

1537
00:49:35,880 --> 00:49:37,500
and I think you know you look at some of

1538
00:49:37,500 --> 00:49:38,579
the tools that specialize in those like

1539
00:49:38,579 --> 00:49:40,460
dragos for example have some really good

1540
00:49:40,460 --> 00:49:42,180
systems and tools that give you

1541
00:49:42,180 --> 00:49:43,200
visibility and everything I'm not seeing

1542
00:49:43,200 --> 00:49:44,760
a tools the right method all the time

1543
00:49:44,760 --> 00:49:46,859
but the more Network visibility that you

1544
00:49:46,859 --> 00:49:49,200
have into those devices and the ability

1545
00:49:49,200 --> 00:49:50,460
you have around attacks that are

1546
00:49:50,460 --> 00:49:51,420
happening in those environments and you

1547
00:49:51,420 --> 00:49:53,940
have a nice tucked away Network segment

1548
00:49:53,940 --> 00:49:56,220
that allows that doesn't allow you know

1549
00:49:56,220 --> 00:49:57,540
Enterprise or corporate infrastructure

1550
00:49:57,540 --> 00:49:59,160
to be able to impact those you have a

1551
00:49:59,160 --> 00:50:00,540
much better I think way of being able to

1552
00:50:00,540 --> 00:50:02,220
address the security concerns there so

1553
00:50:02,220 --> 00:50:04,380
you know not easy easier said than done

1554
00:50:04,380 --> 00:50:06,119
by the way very difficult to do because

1555
00:50:06,119 --> 00:50:07,740
again the Porsche protocols analysis

1556
00:50:07,740 --> 00:50:09,900
documentation often lacks especially if

1557
00:50:09,900 --> 00:50:11,880
it's 15 20 years old but again something

1558
00:50:11,880 --> 00:50:13,440
that's very doable we've seen it work in

1559
00:50:13,440 --> 00:50:14,940
a lot of other companies too so more you

1560
00:50:14,940 --> 00:50:17,040
see skate infrastructure that type of

1561
00:50:17,040 --> 00:50:18,359
stuff the more segmentation you can do

1562
00:50:18,359 --> 00:50:19,920
across that the better

1563
00:50:19,920 --> 00:50:22,020
good question

1564
00:50:22,020 --> 00:50:24,859
any other questions

1565
00:50:25,920 --> 00:50:27,480
got one back there

1566
00:50:27,480 --> 00:50:29,579
can make you walk you gotta run you

1567
00:50:29,579 --> 00:50:30,740
gotta run

1568
00:50:30,740 --> 00:50:33,780
careful the steps change in size so I

1569
00:50:33,780 --> 00:50:36,740
learned that the hard way

1570
00:50:45,839 --> 00:50:47,280
thank you very much

1571
00:50:47,280 --> 00:50:49,980
so uh hacking Dave question for you

1572
00:50:49,980 --> 00:50:52,020
um most of the time during red team

1573
00:50:52,020 --> 00:50:54,180
assessments uh we're trying to bypass

1574
00:50:54,180 --> 00:50:56,339
EDR Solutions like you said it's the

1575
00:50:56,339 --> 00:50:58,680
antivirus of 1999.

1576
00:50:58,680 --> 00:51:01,680
but in your opinion if we have to advise

1577
00:51:01,680 --> 00:51:04,440
a client uh on which type of EDR

1578
00:51:04,440 --> 00:51:06,420
software to use what in your practice

1579
00:51:06,420 --> 00:51:09,180
and what you see in the out there is the

1580
00:51:09,180 --> 00:51:10,680
most effective one right now because

1581
00:51:10,680 --> 00:51:13,140
we've seen some you normally based uh

1582
00:51:13,140 --> 00:51:17,160
edrs that have no uh further uh ttps for

1583
00:51:17,160 --> 00:51:18,599
example in there they only look for

1584
00:51:18,599 --> 00:51:20,280
anomalies we think it's really strong

1585
00:51:20,280 --> 00:51:22,319
because you go for the outliers that you

1586
00:51:22,319 --> 00:51:24,420
say you don't look at the the top but

1587
00:51:24,420 --> 00:51:26,760
you really look at the outliers but we

1588
00:51:26,760 --> 00:51:28,980
also see of course the regular edrs

1589
00:51:28,980 --> 00:51:31,440
really looking for some uh some answers

1590
00:51:31,440 --> 00:51:34,260
there yeah um so specific vendors I

1591
00:51:34,260 --> 00:51:37,140
don't necessarily uh go into in my talks

1592
00:51:37,140 --> 00:51:39,300
you know but what I can say is the ones

1593
00:51:39,300 --> 00:51:40,980
that will provide you the most amount of

1594
00:51:40,980 --> 00:51:42,780
telemetry data and visibility for you to

1595
00:51:42,780 --> 00:51:44,220
be able to understand what's going on

1596
00:51:44,220 --> 00:51:45,359
your infrastructure is going to be the

1597
00:51:45,359 --> 00:51:47,460
best solution for you so I actually like

1598
00:51:47,460 --> 00:51:49,980
from a vendor perspective I actually

1599
00:51:49,980 --> 00:51:52,319
really like carbon black uh from the

1600
00:51:52,319 --> 00:51:53,700
fact that but it but it's something that

1601
00:51:53,700 --> 00:51:57,000
you need like 50 people to manage uh and

1602
00:51:57,000 --> 00:51:58,619
like another 100 people to support it so

1603
00:51:58,619 --> 00:52:00,720
that doesn't necessarily make sense in

1604
00:52:00,720 --> 00:52:02,760
most organizations but you know the

1605
00:52:02,760 --> 00:52:04,680
visibility you get from that type of

1606
00:52:04,680 --> 00:52:06,300
product is absolutely incredible right

1607
00:52:06,300 --> 00:52:08,940
but again you need extremely large and

1608
00:52:08,940 --> 00:52:10,920
mature program to actually go and

1609
00:52:10,920 --> 00:52:12,839
Implement something like that but what

1610
00:52:12,839 --> 00:52:14,460
I'll say about the visibility and

1611
00:52:14,460 --> 00:52:16,740
Telemetry side is you know the ones that

1612
00:52:16,740 --> 00:52:18,599
have one-to-one detections aren't bad

1613
00:52:18,599 --> 00:52:20,339
but what does it have on top of that

1614
00:52:20,339 --> 00:52:22,440
that allows you to build what's specific

1615
00:52:22,440 --> 00:52:23,640
to your environment and you mentioned

1616
00:52:23,640 --> 00:52:25,200
the anomaly detection components of it

1617
00:52:25,200 --> 00:52:26,940
they're coming out a lot now and I hate

1618
00:52:26,940 --> 00:52:28,079
to use the buzzwords but more like

1619
00:52:28,079 --> 00:52:29,819
machine learning about like hey what

1620
00:52:29,819 --> 00:52:31,020
does your environment look like what are

1621
00:52:31,020 --> 00:52:32,700
deviations of that data what does that

1622
00:52:32,700 --> 00:52:34,380
actually look like you know same Source

1623
00:52:34,380 --> 00:52:36,119
address you know coming from multiple

1624
00:52:36,119 --> 00:52:38,400
VPN cons or you know multiple source

1625
00:52:38,400 --> 00:52:39,599
source address coming from the same

1626
00:52:39,599 --> 00:52:40,980
account from a VPN concentrator those

1627
00:52:40,980 --> 00:52:42,420
are going to be you know anomalies that

1628
00:52:42,420 --> 00:52:44,400
you want to investigate the biggest Crux

1629
00:52:44,400 --> 00:52:46,380
that you have to look at is how do I

1630
00:52:46,380 --> 00:52:48,420
take that behavior in my environment

1631
00:52:48,420 --> 00:52:50,520
which is going to be very noisy shrink

1632
00:52:50,520 --> 00:52:52,140
it down to where it's manageable in my

1633
00:52:52,140 --> 00:52:53,640
own environment so that when an analyst

1634
00:52:53,640 --> 00:52:56,460
gets it it's not the 9000th false

1635
00:52:56,460 --> 00:52:58,260
positive that he misses that ends up

1636
00:52:58,260 --> 00:53:00,599
being that specific attack that he's

1637
00:53:00,599 --> 00:53:02,579
already seen nine other thousand false

1638
00:53:02,579 --> 00:53:04,020
positives before but it happens to be a

1639
00:53:04,020 --> 00:53:06,300
real one this time so you know for me I

1640
00:53:06,300 --> 00:53:09,300
I look at it as a detection engineering

1641
00:53:09,300 --> 00:53:11,819
problem not necessarily a uh product

1642
00:53:11,819 --> 00:53:13,500
problem so if you have detection

1643
00:53:13,500 --> 00:53:15,119
Engineers that are continuously willing

1644
00:53:15,119 --> 00:53:17,880
away at the exceptions and focusing more

1645
00:53:17,880 --> 00:53:19,619
on refining that data that's when you

1646
00:53:19,619 --> 00:53:20,760
have a lot of success so it's not

1647
00:53:20,760 --> 00:53:22,140
necessarily a product perspective it's

1648
00:53:22,140 --> 00:53:23,880
having somebody that's smart to actually

1649
00:53:23,880 --> 00:53:25,559
go through that data and make it

1650
00:53:25,559 --> 00:53:27,240
intelligible so you have good detections

1651
00:53:27,240 --> 00:53:29,520
in place hopefully that makes sense

1652
00:53:29,520 --> 00:53:30,960
and I actually had to slide that skip

1653
00:53:30,960 --> 00:53:33,119
past that I wanted to show really quick

1654
00:53:33,119 --> 00:53:36,359
um it didn't it was uh it's any you guys

1655
00:53:36,359 --> 00:53:38,400
might be too young for this but uh we'll

1656
00:53:38,400 --> 00:53:42,599
see so let's set that Edwin but um

1657
00:53:42,599 --> 00:53:44,880
where is it at where is it here it is

1658
00:53:44,880 --> 00:53:48,119
does anybody remember the anti-skip uh

1659
00:53:48,119 --> 00:53:50,040
protection on CD players

1660
00:53:50,040 --> 00:53:53,220
and anti-shock right it never worked at

1661
00:53:53,220 --> 00:53:55,260
all like you you'd get like three steps

1662
00:53:55,260 --> 00:53:56,280
and it'd skip but you had the

1663
00:53:56,280 --> 00:53:57,480
anti-shocking like did I actually have

1664
00:53:57,480 --> 00:53:58,859
that button on for anti-shot that did

1665
00:53:58,859 --> 00:54:00,059
absolutely nothing like you actually

1666
00:54:00,059 --> 00:54:01,980
took apart the hardware did nothing to

1667
00:54:01,980 --> 00:54:04,800
actually do anti uh shock at all yeah

1668
00:54:04,800 --> 00:54:06,480
that's good good analogy towards EDR

1669
00:54:06,480 --> 00:54:08,280
products today so

1670
00:54:08,280 --> 00:54:10,140
um any other questions happy to answer

1671
00:54:10,140 --> 00:54:13,040
them get one back there

1672
00:54:25,260 --> 00:54:28,859
you said something about the uh the

1673
00:54:28,859 --> 00:54:32,339
miter framework being used as a checkbox

1674
00:54:32,339 --> 00:54:33,540
like

1675
00:54:33,540 --> 00:54:35,640
I found the same thing with basically

1676
00:54:35,640 --> 00:54:37,500
organizations are basically checking off

1677
00:54:37,500 --> 00:54:42,540
ISO 27 XXX yeah and other

1678
00:54:42,540 --> 00:54:45,599
um uh my other Frameworks

1679
00:54:45,599 --> 00:54:47,880
then again yeah like if you don't do

1680
00:54:47,880 --> 00:54:50,220
that like I'm a big proponent not to do

1681
00:54:50,220 --> 00:54:51,720
that however

1682
00:54:51,720 --> 00:54:53,460
as she says security is hard nobody

1683
00:54:53,460 --> 00:54:54,960
understands it

1684
00:54:54,960 --> 00:54:57,540
so basically following checklist is

1685
00:54:57,540 --> 00:54:59,760
something that what would be a suggested

1686
00:54:59,760 --> 00:55:00,900
other

1687
00:55:00,900 --> 00:55:03,660
approach that people wouldn't just be

1688
00:55:03,660 --> 00:55:06,359
checking the boxes instead of like uh

1689
00:55:06,359 --> 00:55:08,339
just saying yeah we need a mature

1690
00:55:08,339 --> 00:55:10,619
program blah blah blah we have like we

1691
00:55:10,619 --> 00:55:12,480
know that but yeah what's actionable

1692
00:55:12,480 --> 00:55:14,760
that's a good question uh this is

1693
00:55:14,760 --> 00:55:15,720
actually probably one of my favorite

1694
00:55:15,720 --> 00:55:18,240
discussions to have because what is the

1695
00:55:18,240 --> 00:55:20,520
value of minor attack is it the

1696
00:55:20,520 --> 00:55:23,099
techniques and procedures or is it an

1697
00:55:23,099 --> 00:55:24,540
understanding of capabilities of

1698
00:55:24,540 --> 00:55:27,000
adversaries and what I like you know

1699
00:55:27,000 --> 00:55:29,220
I'll present the boards quite often and

1700
00:55:29,220 --> 00:55:31,020
if anybody's ever presented to a board

1701
00:55:31,020 --> 00:55:32,700
before and if you've ever heard board

1702
00:55:32,700 --> 00:55:35,339
presentations they're extremely dry and

1703
00:55:35,339 --> 00:55:36,900
boring they're talking about vulnerable

1704
00:55:36,900 --> 00:55:38,940
management programs like hey we had 200

1705
00:55:38,940 --> 00:55:41,040
000 vulnerabilities now we only have 150

1706
00:55:41,040 --> 00:55:42,420
000 critical vulnerabilities what is it

1707
00:55:42,420 --> 00:55:44,099
what does that even mean you know like a

1708
00:55:44,099 --> 00:55:44,880
board member's like I don't know what

1709
00:55:44,880 --> 00:55:45,960
the hell that means it sounds horrible

1710
00:55:45,960 --> 00:55:47,700
still you know you're like oh our

1711
00:55:47,700 --> 00:55:49,260
governance program is doing this and

1712
00:55:49,260 --> 00:55:50,819
we're hitting all of our key objectives

1713
00:55:50,819 --> 00:55:52,380
for data loss prevention which I've

1714
00:55:52,380 --> 00:55:53,940
never been into an organization that

1715
00:55:53,940 --> 00:55:56,280
actually had a DLP program that worked

1716
00:55:56,280 --> 00:55:57,900
um I've never had a DLP tool ever

1717
00:55:57,900 --> 00:55:59,819
trigger on anything let alone a program

1718
00:55:59,819 --> 00:56:01,619
that actually classifies data and goes

1719
00:56:01,619 --> 00:56:03,660
across the whole business so board

1720
00:56:03,660 --> 00:56:05,700
meetings were often very difficult and

1721
00:56:05,700 --> 00:56:07,619
challenging I think for security folks I

1722
00:56:07,619 --> 00:56:09,059
think miter kind of changed that because

1723
00:56:09,059 --> 00:56:11,700
if you structure your meetings and your

1724
00:56:11,700 --> 00:56:14,640
discussions Less on these are the things

1725
00:56:14,640 --> 00:56:16,380
that we're doing but more so here's our

1726
00:56:16,380 --> 00:56:18,180
adversaries that play in our industry

1727
00:56:18,180 --> 00:56:20,160
verticals that we're concerned about and

1728
00:56:20,160 --> 00:56:22,380
here's their capabilities and here's the

1729
00:56:22,380 --> 00:56:23,880
programs that we have that are trying to

1730
00:56:23,880 --> 00:56:25,319
address those capabilities from a

1731
00:56:25,319 --> 00:56:28,200
concern perspective and you're layering

1732
00:56:28,200 --> 00:56:30,000
that with the the tactics techniques and

1733
00:56:30,000 --> 00:56:31,559
procedures the techniques and procedures

1734
00:56:31,559 --> 00:56:33,420
section of miter again one-to-one

1735
00:56:33,420 --> 00:56:34,800
detections are still important so

1736
00:56:34,800 --> 00:56:36,480
hopefully I didn't dissuade people from

1737
00:56:36,480 --> 00:56:37,740
writing one-to-one detections I think

1738
00:56:37,740 --> 00:56:39,359
those are still very important to have

1739
00:56:39,359 --> 00:56:40,680
in your environment

1740
00:56:40,680 --> 00:56:43,260
but the difference is is understanding

1741
00:56:43,260 --> 00:56:45,119
who your adversaries are from an

1742
00:56:45,119 --> 00:56:46,859
offensive perspective so you can build a

1743
00:56:46,859 --> 00:56:49,740
solid defense so by by looking at their

1744
00:56:49,740 --> 00:56:51,599
capabilities and saying well here's the

1745
00:56:51,599 --> 00:56:53,460
10 groups that minor tracks that are

1746
00:56:53,460 --> 00:56:55,920
important to us those are the ones that

1747
00:56:55,920 --> 00:56:58,380
we're going to prioritize from a tactics

1748
00:56:58,380 --> 00:56:59,819
techniques and procedures perspective

1749
00:56:59,819 --> 00:57:01,260
and here's how we're going to look at

1750
00:57:01,260 --> 00:57:02,700
this in our environment they commonly

1751
00:57:02,700 --> 00:57:04,680
use PS exec okay well in our environment

1752
00:57:04,680 --> 00:57:06,900
what uses PS exec okay we're going to

1753
00:57:06,900 --> 00:57:08,460
put exceptions in just for those systems

1754
00:57:08,460 --> 00:57:09,660
and then we're gonna look for deviations

1755
00:57:09,660 --> 00:57:12,300
of patterns and behavior for PS exec or

1756
00:57:12,300 --> 00:57:13,680
they're heavily using Powershell

1757
00:57:13,680 --> 00:57:15,059
exploitation okay what does Powershell

1758
00:57:15,059 --> 00:57:16,619
look like in our environment those are

1759
00:57:16,619 --> 00:57:17,880
the things that we can do to start to

1760
00:57:17,880 --> 00:57:19,680
build our own detections across our own

1761
00:57:19,680 --> 00:57:21,660
environments that allow us to go above

1762
00:57:21,660 --> 00:57:23,339
and beyond the one-to-one mappings that

1763
00:57:23,339 --> 00:57:24,599
you see from a detection criteria

1764
00:57:24,599 --> 00:57:26,339
perspective that are more more flexible

1765
00:57:26,339 --> 00:57:28,500
because they're our own and that's the

1766
00:57:28,500 --> 00:57:30,000
concept that I'm trying to say here is

1767
00:57:30,000 --> 00:57:32,220
that the one-to-one detections are fine

1768
00:57:32,220 --> 00:57:34,319
they're going to get the low-hanging

1769
00:57:34,319 --> 00:57:35,160
fruit they're going to get the

1770
00:57:35,160 --> 00:57:36,960
previously you know disclosed attacks

1771
00:57:36,960 --> 00:57:38,880
that attackers haven't modified in 10

1772
00:57:38,880 --> 00:57:40,260
years or five years or whatever ends up

1773
00:57:40,260 --> 00:57:41,819
being but when we start making

1774
00:57:41,819 --> 00:57:43,079
detections our own in our own

1775
00:57:43,079 --> 00:57:44,460
environments that's when it becomes

1776
00:57:44,460 --> 00:57:45,960
really challenging for these adversaries

1777
00:57:45,960 --> 00:57:47,640
to be successful and I think that's

1778
00:57:47,640 --> 00:57:49,260
ultimately what we have to focus on is

1779
00:57:49,260 --> 00:57:50,760
try foreign security is that discussion

1780
00:57:50,760 --> 00:57:53,160
around the actors and attackers and I

1781
00:57:53,160 --> 00:57:54,440
think that's what Miter did really well

1782
00:57:54,440 --> 00:57:56,520
and then ultimately how do we build

1783
00:57:56,520 --> 00:57:59,460
defenses around that

1784
00:57:59,460 --> 00:58:01,440
good question all right well thank you

1785
00:58:01,440 --> 00:58:02,579
very much I think I'm out of time so

1786
00:58:02,579 --> 00:58:03,599
thank you all so much for having me

1787
00:58:03,599 --> 00:58:04,859
brewcon it's been amazing I'll be around

1788
00:58:04,859 --> 00:58:06,180
but uh thank you all for having me

1789
00:58:06,180 --> 00:58:08,660
appreciate it

