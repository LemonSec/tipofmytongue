1
00:00:00,719 --> 00:00:02,240
hello everyone

2
00:00:02,240 --> 00:00:04,160
this might be a bit too

3
00:00:04,160 --> 00:00:06,319
strong is that good okay

4
00:00:06,319 --> 00:00:08,160
so first of all thanks for for joining

5
00:00:08,160 --> 00:00:10,240
us in these uh challenging times after

6
00:00:10,240 --> 00:00:12,400
lunch i know how the food coma feels i

7
00:00:12,400 --> 00:00:13,679
will try to make it as dynamic as

8
00:00:13,679 --> 00:00:16,400
possible but thanks for being here and

9
00:00:16,400 --> 00:00:18,160
we let's begin

10
00:00:18,160 --> 00:00:19,439
so

11
00:00:19,439 --> 00:00:21,039
what we're going to be talking about is

12
00:00:21,039 --> 00:00:22,960
basically how to find some of the most

13
00:00:22,960 --> 00:00:24,960
unique well we're going to show one of

14
00:00:24,960 --> 00:00:26,480
the different approaches that we are

15
00:00:26,480 --> 00:00:28,480
applying to try to find some of the most

16
00:00:28,480 --> 00:00:29,840
unique malware

17
00:00:29,840 --> 00:00:31,599
and we refer specifically malware in

18
00:00:31,599 --> 00:00:33,040
operational technologies industrial

19
00:00:33,040 --> 00:00:35,120
control systems what we are calling here

20
00:00:35,120 --> 00:00:38,399
like the white whale of malware

21
00:00:38,399 --> 00:00:40,559
to give a bit of background of the

22
00:00:40,559 --> 00:00:43,040
speakers and who we are it's uh

23
00:00:43,040 --> 00:00:44,640
of course there's one person missing

24
00:00:44,640 --> 00:00:47,360
here that's rushikesh uh unfortunately

25
00:00:47,360 --> 00:00:48,879
he couldn't make make it all the way

26
00:00:48,879 --> 00:00:50,559
from india but he's gonna be here and

27
00:00:50,559 --> 00:00:52,719
omnipresent boys you're gonna see him in

28
00:00:52,719 --> 00:00:54,800
in his large face there in the screen in

29
00:00:54,800 --> 00:00:55,920
a couple of minutes he's gonna be

30
00:00:55,920 --> 00:00:57,440
introducing the second portion of the

31
00:00:57,440 --> 00:00:59,600
talk where he will talk about his a pro

32
00:00:59,600 --> 00:01:01,199
technical approach to actually go and

33
00:01:01,199 --> 00:01:02,800
filter the samples

34
00:01:02,800 --> 00:01:04,640
and during the first oh yeah

35
00:01:04,640 --> 00:01:06,720
and they're in the first portion uh i'm

36
00:01:06,720 --> 00:01:08,479
gonna be discussing more a bit about the

37
00:01:08,479 --> 00:01:10,720
context so from my perspective i'm gonna

38
00:01:10,720 --> 00:01:12,240
give you a thread intelligence

39
00:01:12,240 --> 00:01:14,640
perspective so that we analyze why this

40
00:01:14,640 --> 00:01:16,400
is so relevant why this is such a big

41
00:01:16,400 --> 00:01:17,520
challenge

42
00:01:17,520 --> 00:01:20,000
and in the end i mean we don't expect

43
00:01:20,000 --> 00:01:21,759
you to leave this room being experts in

44
00:01:21,759 --> 00:01:23,439
finding this because actually very few

45
00:01:23,439 --> 00:01:25,439
people have found any of this but

46
00:01:25,439 --> 00:01:27,119
actually to have the tools that are

47
00:01:27,119 --> 00:01:29,439
required to begin doing that if you're

48
00:01:29,439 --> 00:01:32,960
interested in being the next one

49
00:01:33,200 --> 00:01:35,200
so jumping into the story straight away

50
00:01:35,200 --> 00:01:39,360
in 2017 we received well our consultants

51
00:01:39,360 --> 00:01:41,520
back back in the company received an a

52
00:01:41,520 --> 00:01:43,119
call from from a customer that was

53
00:01:43,119 --> 00:01:44,880
telling them that something was going on

54
00:01:44,880 --> 00:01:46,320
in their facility

55
00:01:46,320 --> 00:01:48,159
and basically some of the processes were

56
00:01:48,159 --> 00:01:50,159
failing the plant was getting flooded so

57
00:01:50,159 --> 00:01:52,240
they went to to respond

58
00:01:52,240 --> 00:01:54,640
and what happened in the end was was

59
00:01:54,640 --> 00:01:56,719
very i mean exciting and unexciting

60
00:01:56,719 --> 00:01:58,399
depends on how you see it

61
00:01:58,399 --> 00:02:00,079
and what happened was this incident

62
00:02:00,079 --> 00:02:01,759
that's called trident i don't know if

63
00:02:01,759 --> 00:02:03,280
some people here might already be

64
00:02:03,280 --> 00:02:05,360
familiar with it for those who are not a

65
00:02:05,360 --> 00:02:07,119
very quick walkthrough what was

66
00:02:07,119 --> 00:02:09,119
particular about this incident is that

67
00:02:09,119 --> 00:02:10,720
in this facility

68
00:02:10,720 --> 00:02:11,680
um

69
00:02:11,680 --> 00:02:13,920
the actor had not only like crossed all

70
00:02:13,920 --> 00:02:16,080
the corporate and industrial networks

71
00:02:16,080 --> 00:02:18,239
but also had developed malware that

72
00:02:18,239 --> 00:02:21,040
specifically was developed for targeting

73
00:02:21,040 --> 00:02:24,160
a very specific device from schneider

74
00:02:24,160 --> 00:02:26,560
electric the triconics using a

75
00:02:26,560 --> 00:02:29,200
proprietary protocol udp protocol called

76
00:02:29,200 --> 00:02:31,360
the tristation

77
00:02:31,360 --> 00:02:33,040
and basically they had just done

78
00:02:33,040 --> 00:02:34,640
something extremely complex that took

79
00:02:34,640 --> 00:02:36,959
them around three or four years

80
00:02:36,959 --> 00:02:38,959
and well i mean this was like like one

81
00:02:38,959 --> 00:02:40,720
of the few chances when we had seen any

82
00:02:40,720 --> 00:02:42,400
of this malware that was not meant for

83
00:02:42,400 --> 00:02:45,360
going after pcs but actually after you

84
00:02:45,360 --> 00:02:47,599
know control systems and actually trying

85
00:02:47,599 --> 00:02:50,480
to generate a physical impact

86
00:02:50,480 --> 00:02:52,000
what's very interesting here is is that

87
00:02:52,000 --> 00:02:53,599
when we saw this of course it's very

88
00:02:53,599 --> 00:02:55,680
dangerous you take it very seriously we

89
00:02:55,680 --> 00:02:58,000
jump we work but at the same time our

90
00:02:58,000 --> 00:03:00,159
team was very excited right it just we

91
00:03:00,159 --> 00:03:01,680
were kind of like

92
00:03:01,680 --> 00:03:03,519
excited for the wrong reasons

93
00:03:03,519 --> 00:03:05,519
because on the on the one hand what

94
00:03:05,519 --> 00:03:06,959
happened is like okay we're seeing an

95
00:03:06,959 --> 00:03:08,480
attack that actually could blow up

96
00:03:08,480 --> 00:03:10,319
something that actually can have an

97
00:03:10,319 --> 00:03:12,159
impact in the physical world but at the

98
00:03:12,159 --> 00:03:13,840
same time we're excited because it's

99
00:03:13,840 --> 00:03:16,159
it's one of the few we've seen this only

100
00:03:16,159 --> 00:03:18,480
counted times so you know let's go and

101
00:03:18,480 --> 00:03:20,000
figure out how they did it what they did

102
00:03:20,000 --> 00:03:22,080
who is it you know and this there's a

103
00:03:22,080 --> 00:03:23,599
ton of story in here if you want more

104
00:03:23,599 --> 00:03:26,159
just google triton blogs and you're

105
00:03:26,159 --> 00:03:27,840
gonna find the ton that we were

106
00:03:27,840 --> 00:03:30,239
releasing little by little

107
00:03:30,239 --> 00:03:31,680
uh and also just just some background

108
00:03:31,680 --> 00:03:33,760
information we actually did ask the

109
00:03:33,760 --> 00:03:36,159
author of this uh meme to to share it

110
00:03:36,159 --> 00:03:38,239
because they had some issues so it was

111
00:03:38,239 --> 00:03:40,560
very funny but he was very delighted

112
00:03:40,560 --> 00:03:43,280
that it would be shown in a conference

113
00:03:43,280 --> 00:03:44,400
um

114
00:03:44,400 --> 00:03:45,120
so

115
00:03:45,120 --> 00:03:47,440
knowing that the point is this this this

116
00:03:47,440 --> 00:03:49,599
type of malware what we saw that day and

117
00:03:49,599 --> 00:03:51,120
what the reason why we're so excited is

118
00:03:51,120 --> 00:03:52,720
because this is so unique

119
00:03:52,720 --> 00:03:53,519
and

120
00:03:53,519 --> 00:03:55,519
if you realize the the timeline that you

121
00:03:55,519 --> 00:03:57,599
have here is is probably the the few

122
00:03:57,599 --> 00:03:59,040
times that we have seen any type of

123
00:03:59,040 --> 00:04:01,280
malware with this type of capabilities

124
00:04:01,280 --> 00:04:03,040
uh at least you know maybe there are

125
00:04:03,040 --> 00:04:04,799
others that have never been disclosed or

126
00:04:04,799 --> 00:04:06,720
would not but these are

127
00:04:06,720 --> 00:04:08,080
probably i might be missing one or

128
00:04:08,080 --> 00:04:09,519
something but there's not really much

129
00:04:09,519 --> 00:04:10,640
more than this

130
00:04:10,640 --> 00:04:12,319
uh most people here in the room might be

131
00:04:12,319 --> 00:04:15,280
familiar already with stocksnet stocks

132
00:04:15,280 --> 00:04:17,279
iranians and refugees it goes after some

133
00:04:17,279 --> 00:04:19,440
siemens devices finds a specific device

134
00:04:19,440 --> 00:04:22,240
then goals compromises you know like

135
00:04:22,240 --> 00:04:24,320
basically fairly complicated nation

136
00:04:24,320 --> 00:04:26,800
state versus nation state and there is a

137
00:04:26,800 --> 00:04:28,560
physical impact right

138
00:04:28,560 --> 00:04:30,400
the next three k well the next two cases

139
00:04:30,400 --> 00:04:33,199
the the the one from uh in destroyer

140
00:04:33,199 --> 00:04:34,960
havocs they were more well one was

141
00:04:34,960 --> 00:04:37,520
espionage the other one was energy and

142
00:04:37,520 --> 00:04:39,280
again the point was trying to either

143
00:04:39,280 --> 00:04:41,520
gather information or generate a

144
00:04:41,520 --> 00:04:43,600
physical impact basically they generated

145
00:04:43,600 --> 00:04:45,280
a couple of blackouts for for a couple

146
00:04:45,280 --> 00:04:46,800
hours in ukraine

147
00:04:46,800 --> 00:04:48,800
well i mean one of them

148
00:04:48,800 --> 00:04:52,160
uh the fourth one it's a poc it's not

149
00:04:52,160 --> 00:04:54,800
even it's not even an attack it never

150
00:04:54,800 --> 00:04:56,479
saw light we just published a blog on

151
00:04:56,479 --> 00:04:58,160
that and it was uh something that we

152
00:04:58,160 --> 00:04:59,680
found actually hunting and searching

153
00:04:59,680 --> 00:05:01,440
just for random things

154
00:05:01,440 --> 00:05:03,919
and it was also something similar i

155
00:05:03,919 --> 00:05:06,160
believe it was also siemens but anyway

156
00:05:06,160 --> 00:05:08,720
um it was searching again for a specific

157
00:05:08,720 --> 00:05:10,800
industrial type of

158
00:05:10,800 --> 00:05:13,199
equipment and it was just gonna

159
00:05:13,199 --> 00:05:15,919
basically take a portion of the traffic

160
00:05:15,919 --> 00:05:16,880
and then

161
00:05:16,880 --> 00:05:18,960
make the actor uh enable the actor to

162
00:05:18,960 --> 00:05:20,080
replay it

163
00:05:20,080 --> 00:05:21,520
and then the last one was strident what

164
00:05:21,520 --> 00:05:23,120
i mentioned right now

165
00:05:23,120 --> 00:05:24,800
what do we see in common in all of this

166
00:05:24,800 --> 00:05:26,080
malware and this is this is very

167
00:05:26,080 --> 00:05:28,160
important because that's why the second

168
00:05:28,160 --> 00:05:29,840
portion of the of the talk has has any

169
00:05:29,840 --> 00:05:32,160
relevance that all of this for all of

170
00:05:32,160 --> 00:05:33,919
these cases first of all i mean well

171
00:05:33,919 --> 00:05:36,160
except from one they are often found

172
00:05:36,160 --> 00:05:37,680
after the attack has already happened

173
00:05:37,680 --> 00:05:39,919
and there is already a physical danger

174
00:05:39,919 --> 00:05:41,840
uh and another thing in common is that

175
00:05:41,840 --> 00:05:43,600
in all of them when you start actually

176
00:05:43,600 --> 00:05:45,440
taking a look at the samples there are

177
00:05:45,440 --> 00:05:47,199
there are specific keywords that we

178
00:05:47,199 --> 00:05:49,440
might often miss uh that are basically

179
00:05:49,440 --> 00:05:50,960
just related with different type of

180
00:05:50,960 --> 00:05:54,080
industrial or ot type of

181
00:05:54,080 --> 00:05:55,440
of equipment right like like if you see

182
00:05:55,440 --> 00:05:57,600
some specific ot protocols it uses a

183
00:05:57,600 --> 00:05:59,360
specific type of equipment all of them

184
00:05:59,360 --> 00:06:02,080
had i know schneider or siemens uh they

185
00:06:02,080 --> 00:06:03,840
had probably like some functions that

186
00:06:03,840 --> 00:06:05,680
are embedded for this type of devices

187
00:06:05,680 --> 00:06:08,160
right so anyway taking that into

188
00:06:08,160 --> 00:06:10,800
consideration we have been taking this

189
00:06:10,800 --> 00:06:11,840
um

190
00:06:11,840 --> 00:06:14,080
let's say this task of of trying to find

191
00:06:14,080 --> 00:06:15,360
what it is

192
00:06:15,360 --> 00:06:16,479
but uh

193
00:06:16,479 --> 00:06:17,680
you know why is it that we're not

194
00:06:17,680 --> 00:06:19,280
finding anything right because we are

195
00:06:19,280 --> 00:06:21,199
definitely searching for it uh we know

196
00:06:21,199 --> 00:06:23,919
what it looks like sort of i mean we

197
00:06:23,919 --> 00:06:25,280
well sort of because there are many

198
00:06:25,280 --> 00:06:26,639
different vendors there

199
00:06:26,639 --> 00:06:29,120
um but yeah there are a couple reasons

200
00:06:29,120 --> 00:06:31,120
right the way it's not that simple

201
00:06:31,120 --> 00:06:32,720
uh one of them is basically that the

202
00:06:32,720 --> 00:06:34,880
tools cannot not handle it this is

203
00:06:34,880 --> 00:06:35,919
something that you're not going to find

204
00:06:35,919 --> 00:06:37,440
with a normal antivirus that you're not

205
00:06:37,440 --> 00:06:39,280
going to find in a malware analysis

206
00:06:39,280 --> 00:06:41,280
sandbox or whatever like if you drop

207
00:06:41,280 --> 00:06:43,680
this on any known platform it's not like

208
00:06:43,680 --> 00:06:44,720
it's going to tell you like hey

209
00:06:44,720 --> 00:06:46,560
something terrible is happening

210
00:06:46,560 --> 00:06:48,720
and fairly often legitimate files

211
00:06:48,720 --> 00:06:50,639
actually you look at them and they're

212
00:06:50,639 --> 00:06:52,639
already malicious detections and it can

213
00:06:52,639 --> 00:06:54,639
be entirely good it just like was

214
00:06:54,639 --> 00:06:56,240
created by someone and

215
00:06:56,240 --> 00:06:57,840
the sandbox cannot just reproduce it

216
00:06:57,840 --> 00:06:59,440
because it's fairly specific for a

217
00:06:59,440 --> 00:07:02,160
fairly specific process

218
00:07:02,160 --> 00:07:04,000
another opportunity another option sorry

219
00:07:04,000 --> 00:07:05,919
might be low visibility in 20 systems

220
00:07:05,919 --> 00:07:07,680
it's not as easy to look at the the

221
00:07:07,680 --> 00:07:09,440
traffic and everything is going that is

222
00:07:09,440 --> 00:07:10,880
going in there there are definitely

223
00:07:10,880 --> 00:07:12,400
companies that do that but it's it's

224
00:07:12,400 --> 00:07:14,240
fairly different than when you go and

225
00:07:14,240 --> 00:07:18,000
just look at all the all the it portion

226
00:07:18,000 --> 00:07:19,360
and the other options might be just that

227
00:07:19,360 --> 00:07:21,440
there's basically nothing or you know it

228
00:07:21,440 --> 00:07:22,720
hasn't been documented because it's

229
00:07:22,720 --> 00:07:24,080
fairly complex and you need someone that

230
00:07:24,080 --> 00:07:26,160
has the resources the motivation knows

231
00:07:26,160 --> 00:07:27,280
what they are doing and that really

232
00:07:27,280 --> 00:07:28,560
wants to do it

233
00:07:28,560 --> 00:07:29,919
so there might be actually a few

234
00:07:29,919 --> 00:07:32,080
motivated actors it has to be it has to

235
00:07:32,080 --> 00:07:33,520
be a government

236
00:07:33,520 --> 00:07:36,160
probably or it has to be a group that

237
00:07:36,160 --> 00:07:37,919
has you know enough of knowledge or a

238
00:07:37,919 --> 00:07:39,520
person that really invests a ton of time

239
00:07:39,520 --> 00:07:41,440
and don't have anything to do but are

240
00:07:41,440 --> 00:07:42,639
super clever

241
00:07:42,639 --> 00:07:44,479
so anyway at least that's how we've been

242
00:07:44,479 --> 00:07:46,800
seeing right now there's it has been

243
00:07:46,800 --> 00:07:48,479
getting a bit more simple but you know

244
00:07:48,479 --> 00:07:50,800
we won't get into that right now

245
00:07:50,800 --> 00:07:52,000
so let's begin the search because what

246
00:07:52,000 --> 00:07:54,400
we we came here to do is is to start

247
00:07:54,400 --> 00:07:55,759
thinking about how we're going to search

248
00:07:55,759 --> 00:07:57,120
about that and like i said there are

249
00:07:57,120 --> 00:07:58,960
different approaches

250
00:07:58,960 --> 00:08:00,560
but the first thing to start searching

251
00:08:00,560 --> 00:08:03,840
for this and how we would suggest it is

252
00:08:03,840 --> 00:08:05,280
you you need to know what you're looking

253
00:08:05,280 --> 00:08:07,280
at and and basically go and find some

254
00:08:07,280 --> 00:08:08,879
binaries right

255
00:08:08,879 --> 00:08:11,599
so to start filtering samples what what

256
00:08:11,599 --> 00:08:13,039
what we tried to do is first of all like

257
00:08:13,039 --> 00:08:15,599
define what would be an ot binary or

258
00:08:15,599 --> 00:08:18,240
sample for us right and for that this is

259
00:08:18,240 --> 00:08:20,160
a concept that that in

260
00:08:20,160 --> 00:08:21,440
in mandiant we've been we've been trying

261
00:08:21,440 --> 00:08:24,000
to push from from our ot side and it's

262
00:08:24,000 --> 00:08:25,520
the idea of intermediary systems that is

263
00:08:25,520 --> 00:08:27,680
just the idea of like if you're in i.t

264
00:08:27,680 --> 00:08:29,680
security you you love computers if

265
00:08:29,680 --> 00:08:31,680
you're in od security you love

266
00:08:31,680 --> 00:08:33,679
controllers but what happens is that

267
00:08:33,679 --> 00:08:35,279
actually both work together and then in

268
00:08:35,279 --> 00:08:36,559
the middle you're going to have specific

269
00:08:36,559 --> 00:08:38,559
software that is going to be used to

270
00:08:38,559 --> 00:08:41,039
interact with your plc to

271
00:08:41,039 --> 00:08:42,719
collect information from your sensors

272
00:08:42,719 --> 00:08:44,159
and then display it so that someone can

273
00:08:44,159 --> 00:08:46,560
use it basically that type of software

274
00:08:46,560 --> 00:08:48,320
that you have in the middle is is what

275
00:08:48,320 --> 00:08:50,240
we call intermediate systems and it's

276
00:08:50,240 --> 00:08:52,720
what we're trying to look at look for in

277
00:08:52,720 --> 00:08:54,880
in different platforms

278
00:08:54,880 --> 00:08:56,640
but even when you find this the sample

279
00:08:56,640 --> 00:08:58,640
there are different things that you have

280
00:08:58,640 --> 00:09:00,240
to consider

281
00:09:00,240 --> 00:09:02,240
um first of all like and this is

282
00:09:02,240 --> 00:09:03,600
something we started precisely with

283
00:09:03,600 --> 00:09:05,600
rushikesh realizing

284
00:09:05,600 --> 00:09:08,240
uh he's an amazing researcher and when

285
00:09:08,240 --> 00:09:10,080
he started looking into this

286
00:09:10,080 --> 00:09:12,320
one of the the first realization was

287
00:09:12,320 --> 00:09:14,560
like okay i have all these samples but

288
00:09:14,560 --> 00:09:15,920
let's see what are we gonna do with this

289
00:09:15,920 --> 00:09:18,640
okay daniel this is something malicious

290
00:09:18,640 --> 00:09:20,240
okay well uh

291
00:09:20,240 --> 00:09:22,800
and why why what is it actually doing

292
00:09:22,800 --> 00:09:23,600
uh

293
00:09:23,600 --> 00:09:25,200
differently from other types of samples

294
00:09:25,200 --> 00:09:27,120
the first thing that we consider is what

295
00:09:27,120 --> 00:09:29,600
is what is it actually meant to do like

296
00:09:29,600 --> 00:09:31,519
what type of equipment does it interact

297
00:09:31,519 --> 00:09:33,600
with uh what is the purpose in the

298
00:09:33,600 --> 00:09:36,880
process uh what type of physical impact

299
00:09:36,880 --> 00:09:39,519
can can it actually generate or

300
00:09:39,519 --> 00:09:40,800
because basically you're talking about a

301
00:09:40,800 --> 00:09:42,720
system of systems and then oftentimes

302
00:09:42,720 --> 00:09:45,519
you have to you even use like

303
00:09:45,519 --> 00:09:47,760
different segments or of code that are

304
00:09:47,760 --> 00:09:49,040
going to be used for one single purpose

305
00:09:49,040 --> 00:09:50,480
so the first thing you have you need to

306
00:09:50,480 --> 00:09:52,880
know is what it is actually meant to do

307
00:09:52,880 --> 00:09:54,399
and figuring that out is already a

308
00:09:54,399 --> 00:09:55,839
challenge

309
00:09:55,839 --> 00:09:57,120
the second one is going to be the

310
00:09:57,120 --> 00:09:58,320
malicious behavior because yeah

311
00:09:58,320 --> 00:09:59,760
oftentimes you can find like you know it

312
00:09:59,760 --> 00:10:01,920
was it had some detections but maybe you

313
00:10:01,920 --> 00:10:04,320
know it had a there was a p infector and

314
00:10:04,320 --> 00:10:05,680
then you're gonna see some very simple

315
00:10:05,680 --> 00:10:07,920
malware that oftentimes exists in

316
00:10:07,920 --> 00:10:09,519
industrial environments without you know

317
00:10:09,519 --> 00:10:11,200
sometimes they say we're not even gonna

318
00:10:11,200 --> 00:10:12,399
do anything about it because it's

319
00:10:12,399 --> 00:10:14,240
running and if it's running you know i

320
00:10:14,240 --> 00:10:15,600
just prefer to leave my environment

321
00:10:15,600 --> 00:10:16,880
running then than actually going and

322
00:10:16,880 --> 00:10:18,880
fixing it or sometimes it might generate

323
00:10:18,880 --> 00:10:20,560
some delays and whatever but you know

324
00:10:20,560 --> 00:10:21,600
the point is you need to know the

325
00:10:21,600 --> 00:10:23,360
functionality and you need to know what

326
00:10:23,360 --> 00:10:26,160
actually is making that

327
00:10:26,160 --> 00:10:28,160
malicious

328
00:10:28,160 --> 00:10:29,839
and so for that um

329
00:10:29,839 --> 00:10:31,279
yeah what we need is the legitimate

330
00:10:31,279 --> 00:10:34,160
binaries but then again we run into more

331
00:10:34,160 --> 00:10:36,079
challenges because getting the binaries

332
00:10:36,079 --> 00:10:38,560
by themselves is is already a challenge

333
00:10:38,560 --> 00:10:39,760
right

334
00:10:39,760 --> 00:10:41,040
um

335
00:10:41,040 --> 00:10:43,200
if you have like your windows pc in here

336
00:10:43,200 --> 00:10:44,320
and just try to look at all the

337
00:10:44,320 --> 00:10:45,360
processes that are running in the

338
00:10:45,360 --> 00:10:46,880
background

339
00:10:46,880 --> 00:10:48,160
likely they're going to be very similar

340
00:10:48,160 --> 00:10:50,079
to any of the other computers here but

341
00:10:50,079 --> 00:10:52,320
if you're trying to look at what

342
00:10:52,320 --> 00:10:55,200
hundreds of different ot ics vendors are

343
00:10:55,200 --> 00:10:57,600
doing what are their property protocols

344
00:10:57,600 --> 00:10:59,600
what are the you know all the specific

345
00:10:59,600 --> 00:11:01,680
things that they're that they're using

346
00:11:01,680 --> 00:11:03,680
it becomes a bit trickier

347
00:11:03,680 --> 00:11:06,000
so there's almost no documentation

348
00:11:06,000 --> 00:11:07,600
and if if there is it's because probably

349
00:11:07,600 --> 00:11:09,040
you're a user and you already bought it

350
00:11:09,040 --> 00:11:11,040
from the vendor and whatnot

351
00:11:11,040 --> 00:11:12,160
um

352
00:11:12,160 --> 00:11:14,640
well we also closed service development

353
00:11:14,640 --> 00:11:15,920
this is something that is not meant to

354
00:11:15,920 --> 00:11:17,440
just you know you don't go and find it

355
00:11:17,440 --> 00:11:19,120
on github you can't interact with it

356
00:11:19,120 --> 00:11:21,040
it's supposed to be more like for you as

357
00:11:21,040 --> 00:11:22,560
a user and sometimes you can modify it

358
00:11:22,560 --> 00:11:24,320
so you can do a specific physical

359
00:11:24,320 --> 00:11:25,839
process

360
00:11:25,839 --> 00:11:28,560
uh specific property distributing parts

361
00:11:28,560 --> 00:11:30,640
it basically it just it's just too much

362
00:11:30,640 --> 00:11:32,720
it's combined all over the place

363
00:11:32,720 --> 00:11:33,920
and

364
00:11:33,920 --> 00:11:35,920
well we just realized that it was it was

365
00:11:35,920 --> 00:11:38,880
kind of challenging right

366
00:11:39,200 --> 00:11:42,000
so but still we want to find them and

367
00:11:42,000 --> 00:11:44,160
that's basically what where russia is

368
00:11:44,160 --> 00:11:45,680
going to show one of the approaches we

369
00:11:45,680 --> 00:11:47,760
use so i mean regardless of whether it's

370
00:11:47,760 --> 00:11:49,200
challenging or not we need to figure out

371
00:11:49,200 --> 00:11:50,079
how

372
00:11:50,079 --> 00:11:51,040
so

373
00:11:51,040 --> 00:11:53,360
where are we going to look into it we

374
00:11:53,360 --> 00:11:55,519
we're proposing or i'm like there are

375
00:11:55,519 --> 00:11:56,959
four main sources

376
00:11:56,959 --> 00:11:58,639
the main service is in-house collection

377
00:11:58,639 --> 00:12:00,560
of course if in your company your

378
00:12:00,560 --> 00:12:02,639
organization you run industrial control

379
00:12:02,639 --> 00:12:04,560
systems ot or happens have any

380
00:12:04,560 --> 00:12:05,839
visibility

381
00:12:05,839 --> 00:12:07,279
you might be able to collect just be

382
00:12:07,279 --> 00:12:08,880
very careful how you do it of course you

383
00:12:08,880 --> 00:12:10,720
should not be active in that but you

384
00:12:10,720 --> 00:12:12,639
know that might be one one way to obtain

385
00:12:12,639 --> 00:12:13,600
it

386
00:12:13,600 --> 00:12:15,040
another option is directly from the

387
00:12:15,040 --> 00:12:17,839
manufacturers like if there's any any

388
00:12:17,839 --> 00:12:19,279
interaction for example if you can get

389
00:12:19,279 --> 00:12:20,880
it directly from them right now it's

390
00:12:20,880 --> 00:12:22,639
it's not so easy because you don't want

391
00:12:22,639 --> 00:12:24,000
to they don't want to go and just give

392
00:12:24,000 --> 00:12:26,399
it to anyone and there's a reason why it

393
00:12:26,399 --> 00:12:27,920
has been kind of like separate and

394
00:12:27,920 --> 00:12:29,600
secret historically

395
00:12:29,600 --> 00:12:32,000
but i mean that's an option

396
00:12:32,000 --> 00:12:33,600
another option might be we mentioned

397
00:12:33,600 --> 00:12:34,959
here discussion forums but it's just

398
00:12:34,959 --> 00:12:36,399
like

399
00:12:36,399 --> 00:12:38,320
like a lot of the software that you use

400
00:12:38,320 --> 00:12:40,000
for these cases oftentimes it's even

401
00:12:40,000 --> 00:12:41,760
like open source like

402
00:12:41,760 --> 00:12:43,120
yeah you can actually go and find some

403
00:12:43,120 --> 00:12:45,600
of those those scripts like or i don't

404
00:12:45,600 --> 00:12:46,480
know like

405
00:12:46,480 --> 00:12:47,519
some

406
00:12:47,519 --> 00:12:48,800
basically yeah there's a lot of open

407
00:12:48,800 --> 00:12:50,160
source or you go to the forums

408
00:12:50,160 --> 00:12:51,360
specifically from the engineers and

409
00:12:51,360 --> 00:12:53,440
they're sometimes even talking more than

410
00:12:53,440 --> 00:12:55,040
they should about like what's going on

411
00:12:55,040 --> 00:12:56,240
right

412
00:12:56,240 --> 00:12:57,519
and then finally malware analysis

413
00:12:57,519 --> 00:12:58,959
platforms that's probably like like the

414
00:12:58,959 --> 00:13:00,480
main one that we use because they have

415
00:13:00,480 --> 00:13:02,320
like a bit of everything right it's uh

416
00:13:02,320 --> 00:13:04,560
it's kind of like like the dream for for

417
00:13:04,560 --> 00:13:06,000
for threat intelligence and for threat

418
00:13:06,000 --> 00:13:07,440
hunting in general

419
00:13:07,440 --> 00:13:09,200
uh so if you go and look i don't know to

420
00:13:09,200 --> 00:13:11,680
virustotal police form you name it

421
00:13:11,680 --> 00:13:12,560
and

422
00:13:12,560 --> 00:13:13,680
yeah well

423
00:13:13,680 --> 00:13:15,200
that's where you can start taking a look

424
00:13:15,200 --> 00:13:17,440
but just to let you know it's never

425
00:13:17,440 --> 00:13:19,120
gonna tell you what there is and you

426
00:13:19,120 --> 00:13:20,399
have to figure out how to actually start

427
00:13:20,399 --> 00:13:21,839
filtering them and that's where that

428
00:13:21,839 --> 00:13:23,440
where the trick begins

429
00:13:23,440 --> 00:13:24,959
uh in this sense the only thing that i

430
00:13:24,959 --> 00:13:26,399
would highlight for for malware analysis

431
00:13:26,399 --> 00:13:28,480
platforms is there there's a new company

432
00:13:28,480 --> 00:13:30,240
that actually i personally find very

433
00:13:30,240 --> 00:13:32,720
interesting it's called adoles

434
00:13:32,720 --> 00:13:34,320
and what they're trying to do is kind of

435
00:13:34,320 --> 00:13:36,480
like something similar i mean like a

436
00:13:36,480 --> 00:13:38,560
repository but specifically for valid

437
00:13:38,560 --> 00:13:41,040
firmware from industrial organizations i

438
00:13:41,040 --> 00:13:42,560
foresee that in the future if any one of

439
00:13:42,560 --> 00:13:44,399
you is super curious that might be a

440
00:13:44,399 --> 00:13:46,880
very good repository to look for it

441
00:13:46,880 --> 00:13:49,120
um but yeah that that's

442
00:13:49,120 --> 00:13:50,399
that that's all the background really

443
00:13:50,399 --> 00:13:52,639
that that we need to to get into the the

444
00:13:52,639 --> 00:13:54,079
actual approaches

445
00:13:54,079 --> 00:13:56,639
uh just the last thing is from from our

446
00:13:56,639 --> 00:13:57,920
team in general like in threat

447
00:13:57,920 --> 00:14:00,560
intelligence at least from our side we

448
00:14:00,560 --> 00:14:02,399
the main things i would say like the

449
00:14:02,399 --> 00:14:04,160
easiest approaches that you can do is

450
00:14:04,160 --> 00:14:07,680
for of course yara rules uh snort rules

451
00:14:07,680 --> 00:14:09,920
and uh what roshike is going to show us

452
00:14:09,920 --> 00:14:12,000
in a couple minutes and actually as i

453
00:14:12,000 --> 00:14:13,839
speak actually i believe yesterday we

454
00:14:13,839 --> 00:14:15,440
had another speaker talking about our

455
00:14:15,440 --> 00:14:17,199
approach from yara rules so if you're

456
00:14:17,199 --> 00:14:19,199
interested i encourage you to search for

457
00:14:19,199 --> 00:14:20,240
cvs

458
00:14:20,240 --> 00:14:22,000
conference and kenneth proska and you

459
00:14:22,000 --> 00:14:24,240
will see a total different approach that

460
00:14:24,240 --> 00:14:26,720
he suggested a couple days ago

461
00:14:26,720 --> 00:14:30,800
with that being said i am going to send

462
00:14:30,800 --> 00:14:33,040
this to roshikesh

463
00:14:33,040 --> 00:14:35,199
uh so what exactly the tests of

464
00:14:35,199 --> 00:14:37,680
deduction uh mean here

465
00:14:37,680 --> 00:14:41,040
as daniel had already explained uh we

466
00:14:41,040 --> 00:14:42,720
tried to

467
00:14:42,720 --> 00:14:46,000
we tried to basically filter out uh

468
00:14:46,000 --> 00:14:48,639
interesting samples from

469
00:14:48,639 --> 00:14:50,720
uh from various sources

470
00:14:50,720 --> 00:14:52,639
so initially uh

471
00:14:52,639 --> 00:14:54,639
uh the the i i'll just tell you some

472
00:14:54,639 --> 00:14:57,120
basic story before going ahead as daniel

473
00:14:57,120 --> 00:14:59,440
already mentioned we've been discussing

474
00:14:59,440 --> 00:15:01,600
about you know hunting some interesting

475
00:15:01,600 --> 00:15:04,399
malicious samples and

476
00:15:04,399 --> 00:15:07,120
but then how was the bigger question we

477
00:15:07,120 --> 00:15:09,199
tried answer so initially we started

478
00:15:09,199 --> 00:15:11,920
like you know downloading some malware

479
00:15:11,920 --> 00:15:14,399
samples doing some analysis in the

480
00:15:14,399 --> 00:15:16,079
sandboxes and then

481
00:15:16,079 --> 00:15:17,920
uh you know reading through the reports

482
00:15:17,920 --> 00:15:19,760
but then we found the

483
00:15:19,760 --> 00:15:21,440
approaches

484
00:15:21,440 --> 00:15:22,560
lacking

485
00:15:22,560 --> 00:15:24,560
from industrial control systems point of

486
00:15:24,560 --> 00:15:26,480
view from cyber physical systems point

487
00:15:26,480 --> 00:15:29,120
of view reason being many a times what

488
00:15:29,120 --> 00:15:30,320
uh

489
00:15:30,320 --> 00:15:34,320
and a cyber physical systems binary

490
00:15:34,320 --> 00:15:37,040
uh is supposed to do is considered as a

491
00:15:37,040 --> 00:15:39,199
malicious behavior by

492
00:15:39,199 --> 00:15:41,040
uh by

493
00:15:41,040 --> 00:15:42,639
a sandbox

494
00:15:42,639 --> 00:15:45,360
and likewise there were many problems as

495
00:15:45,360 --> 00:15:46,240
well

496
00:15:46,240 --> 00:15:47,040
so

497
00:15:47,040 --> 00:15:48,880
the first question we tried answer was

498
00:15:48,880 --> 00:15:50,399
like how to

499
00:15:50,399 --> 00:15:53,360
how to basically defy in a specific

500
00:15:53,360 --> 00:15:56,959
executable or a binary or a dll as cyber

501
00:15:56,959 --> 00:15:58,240
physical relevant

502
00:15:58,240 --> 00:16:01,839
dll or binary and there is where we kind

503
00:16:01,839 --> 00:16:04,320
of you know

504
00:16:04,320 --> 00:16:06,480
we we kind of

505
00:16:06,480 --> 00:16:09,199
tried to pull some tests

506
00:16:09,199 --> 00:16:11,920
which can actually help in sorting such

507
00:16:11,920 --> 00:16:14,560
uh binaries or rather you know sorting

508
00:16:14,560 --> 00:16:15,759
them

509
00:16:15,759 --> 00:16:18,240
from the rest of the binary variants we

510
00:16:18,240 --> 00:16:19,279
can say

511
00:16:19,279 --> 00:16:21,680
so these are some of the

512
00:16:21,680 --> 00:16:24,399
tests as you can see on the screen we

513
00:16:24,399 --> 00:16:26,480
would be discussing about that is status

514
00:16:26,480 --> 00:16:29,279
strings strings in memory error rules

515
00:16:29,279 --> 00:16:32,240
functions of interest api sequence

516
00:16:32,240 --> 00:16:35,360
device and network device probes and

517
00:16:35,360 --> 00:16:38,800
import hashes some of them we will be

518
00:16:38,800 --> 00:16:40,720
actually looking into demo

519
00:16:40,720 --> 00:16:42,240
demonstrations as well

520
00:16:42,240 --> 00:16:46,160
so let's go to next slide

521
00:16:47,600 --> 00:16:49,199
statistics

522
00:16:49,199 --> 00:16:51,519
very basic approach most of the most of

523
00:16:51,519 --> 00:16:54,320
the analysts or malware researchers

524
00:16:54,320 --> 00:16:55,279
the

525
00:16:55,279 --> 00:16:57,680
the try run strings command on

526
00:16:57,680 --> 00:16:59,759
uh onto the binary they are trying

527
00:16:59,759 --> 00:17:02,079
analyze just to see like what exactly it

528
00:17:02,079 --> 00:17:03,759
is holding

529
00:17:03,759 --> 00:17:04,959
inside

530
00:17:04,959 --> 00:17:08,160
so we also did that particular command

531
00:17:08,160 --> 00:17:11,520
on some of the binaries and a small demo

532
00:17:11,520 --> 00:17:15,119
for static strings we can see

533
00:17:16,839 --> 00:17:19,520
here uh daniel can you

534
00:17:19,520 --> 00:17:21,679
go to next slide please

535
00:17:21,679 --> 00:17:22,880
yeah

536
00:17:22,880 --> 00:17:25,120
sorry

537
00:17:27,280 --> 00:17:29,280
so we just ran

538
00:17:29,280 --> 00:17:31,120
strings command on a binary and we could

539
00:17:31,120 --> 00:17:32,400
see like you know there are there are

540
00:17:32,400 --> 00:17:34,559
plethora of strings which are basically

541
00:17:34,559 --> 00:17:36,960
populating all the all the

542
00:17:36,960 --> 00:17:39,120
screens so we just grabbed some

543
00:17:39,120 --> 00:17:40,960
interesting keywords

544
00:17:40,960 --> 00:17:42,720
and we could see there are some entries

545
00:17:42,720 --> 00:17:43,679
around

546
00:17:43,679 --> 00:17:45,360
six entries here

547
00:17:45,360 --> 00:17:47,919
which are relevant to us which says plc

548
00:17:47,919 --> 00:17:50,320
station number and then something some

549
00:17:50,320 --> 00:17:53,120
value received from plc and what not so

550
00:17:53,120 --> 00:17:56,559
that gives us some idea about yes this

551
00:17:56,559 --> 00:17:58,880
binary is actually containing some

552
00:17:58,880 --> 00:18:00,880
information which is relevant to cyber

553
00:18:00,880 --> 00:18:02,400
physical systems

554
00:18:02,400 --> 00:18:04,240
but

555
00:18:04,240 --> 00:18:05,520
then still

556
00:18:05,520 --> 00:18:08,160
we cannot blindly rely on this because

557
00:18:08,160 --> 00:18:10,400
this is just a string command so

558
00:18:10,400 --> 00:18:12,960
some some mischievous

559
00:18:12,960 --> 00:18:15,039
actor can actually be you know embedding

560
00:18:15,039 --> 00:18:17,600
such text into the binary for somebody

561
00:18:17,600 --> 00:18:20,080
to mislead or to basically research us

562
00:18:20,080 --> 00:18:21,679
to mislead

563
00:18:21,679 --> 00:18:24,480
and that is where we uh kind of you know

564
00:18:24,480 --> 00:18:26,799
tried drilling this whole

565
00:18:26,799 --> 00:18:28,960
strings into little more

566
00:18:28,960 --> 00:18:30,799
uh depths and

567
00:18:30,799 --> 00:18:32,240
this time we

568
00:18:32,240 --> 00:18:33,679
we use some

569
00:18:33,679 --> 00:18:35,600
some some kind of instrumentation

570
00:18:35,600 --> 00:18:39,280
enabled tool uh we call it floss that is

571
00:18:39,280 --> 00:18:42,880
an open source tool released by fireeye

572
00:18:42,880 --> 00:18:44,720
quite a time back

573
00:18:44,720 --> 00:18:46,960
so we will see the demo for that

574
00:18:46,960 --> 00:18:48,720
daniel can you please move to a couple

575
00:18:48,720 --> 00:18:51,120
of slides

576
00:18:54,840 --> 00:19:00,480
yeah so here we can see the demo of uh

577
00:19:00,480 --> 00:19:04,240
strings are rather dynamic strings

578
00:19:04,240 --> 00:19:07,520
onto the same binary

579
00:19:08,640 --> 00:19:11,360
again plethora of strings

580
00:19:11,360 --> 00:19:14,559
just kind of you know

581
00:19:14,960 --> 00:19:16,799
jamming everything on to

582
00:19:16,799 --> 00:19:18,559
screen

583
00:19:18,559 --> 00:19:21,679
so here we can see uh there are

584
00:19:21,679 --> 00:19:25,919
quite a good number of entries visible

585
00:19:25,919 --> 00:19:27,200
and

586
00:19:27,200 --> 00:19:29,679
we can see there are some entries which

587
00:19:29,679 --> 00:19:32,240
are actually being fetched from memory

588
00:19:32,240 --> 00:19:34,960
so that's a benefit of using flaws we

589
00:19:34,960 --> 00:19:38,160
found like you know dynamic strings so

590
00:19:38,160 --> 00:19:40,480
this was actually second test of

591
00:19:40,480 --> 00:19:42,480
deduction

592
00:19:42,480 --> 00:19:45,919
we tried perform

593
00:19:50,400 --> 00:19:51,440
yeah

594
00:19:51,440 --> 00:19:53,679
uh before going ahead into this concept

595
00:19:53,679 --> 00:19:55,919
i i think we should we should discuss

596
00:19:55,919 --> 00:19:57,520
this concept in a bit like you know

597
00:19:57,520 --> 00:20:00,320
functions of interest

598
00:20:00,320 --> 00:20:02,480
what exactly does this mean

599
00:20:02,480 --> 00:20:05,760
uh we ran static strings we ran dynamic

600
00:20:05,760 --> 00:20:07,760
strings we found some interesting

601
00:20:07,760 --> 00:20:10,480
keywords but then still

602
00:20:10,480 --> 00:20:13,600
whatever we were trying to

603
00:20:13,600 --> 00:20:15,760
you know convince to the world okay this

604
00:20:15,760 --> 00:20:18,400
is cyber physical relevant binary is not

605
00:20:18,400 --> 00:20:19,919
for proof

606
00:20:19,919 --> 00:20:22,480
reason being as i've already told uh an

607
00:20:22,480 --> 00:20:25,679
interesting actor can actually you know

608
00:20:25,679 --> 00:20:27,600
keep on stuffing such keywords here and

609
00:20:27,600 --> 00:20:28,720
there and

610
00:20:28,720 --> 00:20:30,000
accordingly

611
00:20:30,000 --> 00:20:31,679
the binary would be flagged by cyber

612
00:20:31,679 --> 00:20:33,600
physical relevant binary which actually

613
00:20:33,600 --> 00:20:35,039
is not a truth

614
00:20:35,039 --> 00:20:37,039
so what could be another

615
00:20:37,039 --> 00:20:39,679
concrete test of deduction

616
00:20:39,679 --> 00:20:40,799
was our

617
00:20:40,799 --> 00:20:42,080
was our

618
00:20:42,080 --> 00:20:45,120
next question we tried answering the

619
00:20:45,120 --> 00:20:47,520
the thing was uh functions

620
00:20:47,520 --> 00:20:49,440
so here what we try to do

621
00:20:49,440 --> 00:20:51,280
is we

622
00:20:51,280 --> 00:20:54,320
so basically i interacted with many

623
00:20:54,320 --> 00:20:56,720
endpoint uh

624
00:20:56,720 --> 00:20:58,720
researchers to understand like how they

625
00:20:58,720 --> 00:21:01,360
visualize binary it was not one it was

626
00:21:01,360 --> 00:21:03,679
actually at least a couple of dozens of

627
00:21:03,679 --> 00:21:05,600
researchers just to understand more

628
00:21:05,600 --> 00:21:07,760
about how they visualize binaries or in

629
00:21:07,760 --> 00:21:10,159
how they visualize behaviors and whatnot

630
00:21:10,159 --> 00:21:12,000
and i realize there is something really

631
00:21:12,000 --> 00:21:14,320
very interesting which can actually be

632
00:21:14,320 --> 00:21:16,400
leveraged to solve industrial control

633
00:21:16,400 --> 00:21:18,480
systems relevant binaries and that is

634
00:21:18,480 --> 00:21:20,559
the behavior

635
00:21:20,559 --> 00:21:21,440
where

636
00:21:21,440 --> 00:21:23,520
these binaries

637
00:21:23,520 --> 00:21:26,400
have been programmed by design have been

638
00:21:26,400 --> 00:21:28,880
programmed to speak to some of the

639
00:21:28,880 --> 00:21:30,400
devices

640
00:21:30,400 --> 00:21:32,880
so for most of the operating systems

641
00:21:32,880 --> 00:21:35,760
which are in practice today

642
00:21:35,760 --> 00:21:38,480
every such

643
00:21:38,480 --> 00:21:41,200
device is recognized

644
00:21:41,200 --> 00:21:42,559
by the file

645
00:21:42,559 --> 00:21:46,320
as a file right so then i tried sort

646
00:21:46,320 --> 00:21:48,880
that particular uh

647
00:21:48,880 --> 00:21:51,679
type of call to that file

648
00:21:51,679 --> 00:21:54,159
which can give us more uh concrete

649
00:21:54,159 --> 00:21:57,200
information and i found the easiest way

650
00:21:57,200 --> 00:22:00,320
is is a function or in a an api call

651
00:22:00,320 --> 00:22:02,559
which says open file

652
00:22:02,559 --> 00:22:03,520
uh

653
00:22:03,520 --> 00:22:05,120
and that way

654
00:22:05,120 --> 00:22:08,400
we try to dig deeper and and try to see

655
00:22:08,400 --> 00:22:10,799
like what exactly open file can lead us

656
00:22:10,799 --> 00:22:11,600
to

657
00:22:11,600 --> 00:22:14,559
and here's the next demo for open file

658
00:22:14,559 --> 00:22:16,799
or functions of interest there's gonna

659
00:22:16,799 --> 00:22:19,280
be two demos one would be under dar a

660
00:22:19,280 --> 00:22:22,879
another would be using ketra

661
00:22:25,280 --> 00:22:27,919
so here i'm i just i'm trying to run

662
00:22:27,919 --> 00:22:30,240
some binary with array then doing some

663
00:22:30,240 --> 00:22:33,120
analysis with using some typical flags

664
00:22:33,120 --> 00:22:34,480
available

665
00:22:34,480 --> 00:22:35,679
uh

666
00:22:35,679 --> 00:22:37,679
let's not discuss more of radares

667
00:22:37,679 --> 00:22:39,520
functionality here because that's

668
00:22:39,520 --> 00:22:41,520
awesome and huge tool

669
00:22:41,520 --> 00:22:44,799
um just to keep uh our discussion

670
00:22:44,799 --> 00:22:48,400
succinct to our topic

671
00:22:49,679 --> 00:22:52,640
so uh i have ran i i command basically

672
00:22:52,640 --> 00:22:53,840
to see

673
00:22:53,840 --> 00:22:56,320
whatever it it spells out in form of

674
00:22:56,320 --> 00:22:58,400
functions or some resolved functions or

675
00:22:58,400 --> 00:23:00,240
whatever it is

676
00:23:00,240 --> 00:23:01,039
uh

677
00:23:01,039 --> 00:23:03,200
again it was plethora of information for

678
00:23:03,200 --> 00:23:04,400
me so

679
00:23:04,400 --> 00:23:07,280
next step was basically to drill it down

680
00:23:07,280 --> 00:23:11,280
and that i have used

681
00:23:11,280 --> 00:23:13,520
okay

682
00:23:15,360 --> 00:23:17,120
okay we won't be drilling it down here

683
00:23:17,120 --> 00:23:18,880
it's into the another demo so it's

684
00:23:18,880 --> 00:23:20,799
basically i'm trying to find

685
00:23:20,799 --> 00:23:23,679
uh those function calls or api calls

686
00:23:23,679 --> 00:23:25,679
where open file as a keyword is

687
00:23:25,679 --> 00:23:28,080
available and i found two interesting

688
00:23:28,080 --> 00:23:30,159
uh such entries

689
00:23:30,159 --> 00:23:32,480
so i just i just kind of you know pasted

690
00:23:32,480 --> 00:23:35,120
one of the address with command axt and

691
00:23:35,120 --> 00:23:37,200
now i would actually be reaching to the

692
00:23:37,200 --> 00:23:41,840
address 0 x 4 1 d a 7 1 to see what

693
00:23:41,840 --> 00:23:45,799
exactly is lying there

694
00:23:51,360 --> 00:23:54,480
and now pds will give us something

695
00:23:54,480 --> 00:23:57,360
so there are many entries in raid out of

696
00:23:57,360 --> 00:24:00,760
that i would

697
00:25:08,480 --> 00:25:09,279
yeah

698
00:25:09,279 --> 00:25:11,440
my apologies it was power outage here

699
00:25:11,440 --> 00:25:13,600
it's it's actually a rainy season in

700
00:25:13,600 --> 00:25:14,640
india and

701
00:25:14,640 --> 00:25:17,039
sometimes power happens my apologies for

702
00:25:17,039 --> 00:25:19,200
the disconnection

703
00:25:19,200 --> 00:25:21,279
uh daniel can we

704
00:25:21,279 --> 00:25:23,520
see the video from where it was

705
00:25:23,520 --> 00:25:26,559
disconnected please

706
00:25:27,279 --> 00:25:30,559
yep this is the next one

707
00:25:31,120 --> 00:25:34,080
okay uh the open file one

708
00:25:34,080 --> 00:25:35,600
yep

709
00:25:35,600 --> 00:25:37,760
okay

710
00:25:37,760 --> 00:25:40,480
no no not this one i i wanted to produce

711
00:25:40,480 --> 00:25:43,919
one you're still none

712
00:25:49,679 --> 00:25:52,960
you can forward the video

713
00:25:54,480 --> 00:25:56,159
to maybe like last 10 seconds or

714
00:25:56,159 --> 00:25:58,159
something we just want to share the

715
00:25:58,159 --> 00:26:00,000
inference we

716
00:26:00,000 --> 00:26:03,679
we found from that particular

717
00:26:05,919 --> 00:26:08,320
it will get there

718
00:26:08,320 --> 00:26:11,320
okay

719
00:27:06,080 --> 00:27:09,360
yeah it's almost there

720
00:27:11,919 --> 00:27:14,480
yes so we are seeking that particular

721
00:27:14,480 --> 00:27:16,880
location and yes here it is

722
00:27:16,880 --> 00:27:17,760
so

723
00:27:17,760 --> 00:27:19,679
so the thing which says you know error

724
00:27:19,679 --> 00:27:21,760
accessing coil register address field

725
00:27:21,760 --> 00:27:23,760
file something something something

726
00:27:23,760 --> 00:27:26,640
gives us a concrete proof that we are

727
00:27:26,640 --> 00:27:28,640
actually dealing with

728
00:27:28,640 --> 00:27:32,320
cyber physical relevant binary

729
00:27:32,720 --> 00:27:36,159
uh reason being coils are used in

730
00:27:36,159 --> 00:27:37,840
uh

731
00:27:37,840 --> 00:27:39,919
in majority of modbus

732
00:27:39,919 --> 00:27:42,880
implementations

733
00:27:43,039 --> 00:27:45,520
and and and that is how

734
00:27:45,520 --> 00:27:47,440
we can deduce that we are actually

735
00:27:47,440 --> 00:27:50,080
dealing with

736
00:27:50,159 --> 00:27:53,120
some cyber physical relevant binary and

737
00:27:53,120 --> 00:27:57,320
let's go to next demo

738
00:28:09,679 --> 00:28:12,480
so here we would be using

739
00:28:12,480 --> 00:28:15,279
an awesome openly available reverse

740
00:28:15,279 --> 00:28:17,279
engineering tool called

741
00:28:17,279 --> 00:28:21,360
so i just i'm setting up a project

742
00:28:21,919 --> 00:28:24,919
here

743
00:28:30,480 --> 00:28:31,679
yeah

744
00:28:31,679 --> 00:28:33,360
and now let's

745
00:28:33,360 --> 00:28:35,360
copy the binary to

746
00:28:35,360 --> 00:28:38,678
to the project

747
00:28:49,279 --> 00:28:51,600
this demo would actually cover the way i

748
00:28:51,600 --> 00:28:54,399
tried finding relevance

749
00:28:54,399 --> 00:28:56,720
for cyber physical binaries so there

750
00:28:56,720 --> 00:28:59,360
could be some scenarios where things

751
00:28:59,360 --> 00:29:00,480
actually

752
00:29:00,480 --> 00:29:03,440
did not return any result

753
00:29:03,440 --> 00:29:05,200
so now we will

754
00:29:05,200 --> 00:29:06,960
run the analysis through

755
00:29:06,960 --> 00:29:08,159
binary

756
00:29:08,159 --> 00:29:10,240
it usually takes some time depending

757
00:29:10,240 --> 00:29:12,960
upon the computing capabilities of heart

758
00:29:12,960 --> 00:29:15,520
where we have

759
00:29:16,480 --> 00:29:20,480
but but the interesting point we can uh

760
00:29:20,480 --> 00:29:22,880
start focusing on is on to the left

761
00:29:22,880 --> 00:29:24,799
upper left hand panel

762
00:29:24,799 --> 00:29:26,559
uh of

763
00:29:26,559 --> 00:29:28,320
of the user interface where we could see

764
00:29:28,320 --> 00:29:30,559
a symbol tree and then there are some

765
00:29:30,559 --> 00:29:33,120
entries saying you know imports exports

766
00:29:33,120 --> 00:29:37,279
functions labels classes namespaces

767
00:29:37,279 --> 00:29:40,000
uh interestingly

768
00:29:40,000 --> 00:29:41,039
in

769
00:29:41,039 --> 00:29:43,760
in in some of the relevance finding

770
00:29:43,760 --> 00:29:46,799
exercises we were able to find

771
00:29:46,799 --> 00:29:50,159
good entries in imports

772
00:29:50,159 --> 00:29:52,240
and in this particular present binary

773
00:29:52,240 --> 00:29:54,000
that we are trying to analyze we were

774
00:29:54,000 --> 00:29:56,960
able to find something in the entries of

775
00:29:56,960 --> 00:29:58,240
functions

776
00:29:58,240 --> 00:30:00,720
so let's wait for some time until the

777
00:30:00,720 --> 00:30:04,159
analysis is complete

778
00:30:06,559 --> 00:30:09,200
it usually happens

779
00:30:09,200 --> 00:30:11,600
in in a minute or something hopefully

780
00:30:11,600 --> 00:30:14,959
same will be here yeah

781
00:30:17,039 --> 00:30:20,840
uh there's another thing we can actually

782
00:30:20,840 --> 00:30:24,559
uh focus as well and that is on to the

783
00:30:24,559 --> 00:30:26,559
lower left

784
00:30:26,559 --> 00:30:28,799
panel lower left panel

785
00:30:28,799 --> 00:30:31,520
which says data types okay analysis is

786
00:30:31,520 --> 00:30:32,960
complete

787
00:30:32,960 --> 00:30:34,399
and now let's see

788
00:30:34,399 --> 00:30:37,279
earlier what i used to do is uh i used

789
00:30:37,279 --> 00:30:38,799
to manually browse through all the

790
00:30:38,799 --> 00:30:40,000
functions

791
00:30:40,000 --> 00:30:42,159
but then

792
00:30:42,159 --> 00:30:44,559
eventually i was as i was not aware of

793
00:30:44,559 --> 00:30:47,520
this particular filter text field

794
00:30:47,520 --> 00:30:49,279
so it used to take a lot of time but now

795
00:30:49,279 --> 00:30:53,360
that filter text field is of use to us

796
00:30:53,360 --> 00:30:54,640
okay uh

797
00:30:54,640 --> 00:30:57,279
before going further

798
00:30:57,279 --> 00:31:00,480
yeah so it says ib start address and

799
00:31:00,480 --> 00:31:01,919
something something which gives us an

800
00:31:01,919 --> 00:31:04,399
idea okay there is some need to work

801
00:31:04,399 --> 00:31:05,600
device

802
00:31:05,600 --> 00:31:08,480
where there is going to be a lp start

803
00:31:08,480 --> 00:31:10,320
address where there is going to be some

804
00:31:10,320 --> 00:31:11,519
address

805
00:31:11,519 --> 00:31:13,679
but again that is vague claim nobody is

806
00:31:13,679 --> 00:31:15,519
going to buy that unless we show them

807
00:31:15,519 --> 00:31:16,799
the real

808
00:31:16,799 --> 00:31:20,240
function if available

809
00:31:21,760 --> 00:31:24,000
okay so we are trying to search some

810
00:31:24,000 --> 00:31:27,200
keywords into the symbol tree uh but

811
00:31:27,200 --> 00:31:29,039
until well

812
00:31:29,039 --> 00:31:31,440
let's see if something interesting pops

813
00:31:31,440 --> 00:31:32,960
up still nothing

814
00:31:32,960 --> 00:31:34,880
now we'll try search similar keywords

815
00:31:34,880 --> 00:31:37,440
into uh into

816
00:31:37,440 --> 00:31:38,559
the

817
00:31:38,559 --> 00:31:39,919
data types

818
00:31:39,919 --> 00:31:40,960
as well

819
00:31:40,960 --> 00:31:44,840
to see if something works

820
00:31:47,440 --> 00:31:48,320
yeah

821
00:31:48,320 --> 00:31:50,559
so this was but the name of plc i mean

822
00:31:50,559 --> 00:31:52,640
name of the binary so nothing that can

823
00:31:52,640 --> 00:31:55,840
actually prove our claim

824
00:31:58,159 --> 00:32:01,360
yeah so this gives us some information

825
00:32:01,360 --> 00:32:05,199
but again nothing concrete so

826
00:32:07,200 --> 00:32:10,159
maybe some other way we could use

827
00:32:10,159 --> 00:32:13,159
and

828
00:32:14,320 --> 00:32:15,760
yeah

829
00:32:15,760 --> 00:32:18,399
now it says define if type plc so that

830
00:32:18,399 --> 00:32:21,519
gives us a concrete information about a

831
00:32:21,519 --> 00:32:24,159
data type used and which actually is

832
00:32:24,159 --> 00:32:26,159
defining some

833
00:32:26,159 --> 00:32:28,080
some property which is really relevant

834
00:32:28,080 --> 00:32:31,039
to program logic controllers

835
00:32:31,039 --> 00:32:33,440
uh but to drill it deeper again we would

836
00:32:33,440 --> 00:32:35,919
be resorting to strings in a different

837
00:32:35,919 --> 00:32:37,600
way

838
00:32:37,600 --> 00:32:39,519
uh not like the one we have seen

839
00:32:39,519 --> 00:32:41,600
previously so here we have tried

840
00:32:41,600 --> 00:32:44,159
extracting all the strings using

841
00:32:44,159 --> 00:32:45,440
gedraj's

842
00:32:45,440 --> 00:32:46,960
search capability

843
00:32:46,960 --> 00:32:48,799
and then we tried search for a keyword

844
00:32:48,799 --> 00:32:50,320
called plc

845
00:32:50,320 --> 00:32:52,559
now here we could see the plc station

846
00:32:52,559 --> 00:32:54,000
number and something something in the

847
00:32:54,000 --> 00:32:55,200
label

848
00:32:55,200 --> 00:32:56,399
uh

849
00:32:56,399 --> 00:32:58,799
and clicking on to that particular ad

850
00:32:58,799 --> 00:33:01,679
address took us to directly the function

851
00:33:01,679 --> 00:33:02,720
or

852
00:33:02,720 --> 00:33:05,360
we can say a source representation of

853
00:33:05,360 --> 00:33:08,000
that keyword into the

854
00:33:08,000 --> 00:33:11,279
uh into the binary now that gives us

855
00:33:11,279 --> 00:33:13,600
fair enough idea that the binary we are

856
00:33:13,600 --> 00:33:15,760
trying to deal with is actually cyber

857
00:33:15,760 --> 00:33:18,240
physical relevant binary

858
00:33:18,240 --> 00:33:19,600
because uh

859
00:33:19,600 --> 00:33:21,840
because of the representation we could

860
00:33:21,840 --> 00:33:24,480
see on to on the screen

861
00:33:24,480 --> 00:33:27,679
in the user interface

862
00:33:29,600 --> 00:33:31,840
so that is

863
00:33:31,840 --> 00:33:36,080
that is most of it into the second demo

864
00:33:36,080 --> 00:33:39,320
so far

865
00:33:39,519 --> 00:33:42,480
yeah so i just tried highlight the plc

866
00:33:42,480 --> 00:33:44,320
station number and

867
00:33:44,320 --> 00:33:46,080
i mean as a

868
00:33:46,080 --> 00:33:48,960
as an entry into this particular binary

869
00:33:48,960 --> 00:33:53,159
again more strings okay

870
00:33:57,360 --> 00:33:58,799
and this time we are trying to search

871
00:33:58,799 --> 00:34:01,039
something for modbus and let's see if

872
00:34:01,039 --> 00:34:03,279
something works out

873
00:34:03,279 --> 00:34:06,559
so these entries so far are technically

874
00:34:06,559 --> 00:34:08,879
string entries but are kind of you know

875
00:34:08,879 --> 00:34:11,599
present deeper into the source

876
00:34:11,599 --> 00:34:14,239
uh which can actually help us

877
00:34:14,239 --> 00:34:17,199
make our case stronger when we are

878
00:34:17,199 --> 00:34:18,960
when we are commenting that this

879
00:34:18,960 --> 00:34:20,719
particular binary is

880
00:34:20,719 --> 00:34:24,158
a physical relevant binary

881
00:34:27,760 --> 00:34:29,918
so in the location column when we click

882
00:34:29,918 --> 00:34:31,918
on to that particular address and when

883
00:34:31,918 --> 00:34:34,719
we close this particular string search

884
00:34:34,719 --> 00:34:37,440
utility get right access directly to

885
00:34:37,440 --> 00:34:40,480
that particular entry into uh

886
00:34:40,480 --> 00:34:43,918
and to disassemble source

887
00:34:45,599 --> 00:34:47,839
so that is how we get fair enough idea

888
00:34:47,839 --> 00:34:50,960
okay uh anything

889
00:34:52,239 --> 00:34:56,479
yeah uh so we could see

890
00:34:57,200 --> 00:34:59,839
okay no problem probably you exited the

891
00:34:59,839 --> 00:35:01,359
team no problem

892
00:35:01,359 --> 00:35:03,119
so in the

893
00:35:03,119 --> 00:35:05,040
the previous demo we wanted pause

894
00:35:05,040 --> 00:35:06,079
actually

895
00:35:06,079 --> 00:35:07,920
if possible

896
00:35:07,920 --> 00:35:10,720
the kidra demo

897
00:35:10,720 --> 00:35:12,079
so i'm not sure what happened in that

898
00:35:12,079 --> 00:35:14,400
one ah

899
00:35:14,400 --> 00:35:16,800
okay i don't think i can advance it

900
00:35:16,800 --> 00:35:19,440
i don't know why we can we can

901
00:35:19,440 --> 00:35:21,440
okay no problem

902
00:35:21,440 --> 00:35:23,520
there we could actually see some string

903
00:35:23,520 --> 00:35:27,520
called ets serial which was actually

904
00:35:27,520 --> 00:35:29,280
actually you know giving this fair

905
00:35:29,280 --> 00:35:31,359
enough idea about

906
00:35:31,359 --> 00:35:34,640
uh some conversion that's happening from

907
00:35:34,640 --> 00:35:37,040
uh that's happening about a traffic

908
00:35:37,040 --> 00:35:39,280
which is maybe coming from serial going

909
00:35:39,280 --> 00:35:40,000
to

910
00:35:40,000 --> 00:35:42,000
uh internet or maybe coming from

911
00:35:42,000 --> 00:35:43,680
ethernet going to serial or something

912
00:35:43,680 --> 00:35:46,320
like that so that gives us an idea about

913
00:35:46,320 --> 00:35:48,880
the device proven that to specifically

914
00:35:48,880 --> 00:35:50,800
network device pro

915
00:35:50,800 --> 00:35:52,800
uh which is

916
00:35:52,800 --> 00:35:54,960
which is potentially lying around in

917
00:35:54,960 --> 00:35:57,359
that particular binary

918
00:35:57,359 --> 00:35:59,680
then that's just fine we can skip this

919
00:35:59,680 --> 00:36:01,920
demo okay i mean we can skip the

920
00:36:01,920 --> 00:36:05,040
repetition per se yeah

921
00:36:05,040 --> 00:36:07,359
uh another important concept was fuzzy

922
00:36:07,359 --> 00:36:09,359
hash or import head

923
00:36:09,359 --> 00:36:13,040
uh a reason being the normal hashes

924
00:36:13,040 --> 00:36:15,599
just by changing a bit and we could see

925
00:36:15,599 --> 00:36:18,160
a complete new hash in the wild

926
00:36:18,160 --> 00:36:20,480
so that is kind of a challenge we tried

927
00:36:20,480 --> 00:36:23,280
solved and the answer was

928
00:36:23,280 --> 00:36:25,920
selectively hashing the binary for some

929
00:36:25,920 --> 00:36:29,119
maybe repetitively used code

930
00:36:29,119 --> 00:36:30,400
and

931
00:36:30,400 --> 00:36:32,400
as as

932
00:36:32,400 --> 00:36:34,079
as no

933
00:36:34,079 --> 00:36:35,920
developer is

934
00:36:35,920 --> 00:36:38,720
you know immune to use of code

935
00:36:38,720 --> 00:36:41,359
majority of majority of search

936
00:36:41,359 --> 00:36:43,520
development close source development we

937
00:36:43,520 --> 00:36:44,960
have witnessed like you know they use

938
00:36:44,960 --> 00:36:48,079
some kind of open source components or

939
00:36:48,079 --> 00:36:49,440
certain things which have been

940
00:36:49,440 --> 00:36:52,560
repetitively used

941
00:36:53,119 --> 00:36:56,240
uh having said that uh

942
00:36:56,240 --> 00:36:58,800
we tried uh kind of you know running

943
00:36:58,800 --> 00:37:01,119
fuzzy hash or import hash on selective

944
00:37:01,119 --> 00:37:02,320
part of

945
00:37:02,320 --> 00:37:04,480
binary and to see if

946
00:37:04,480 --> 00:37:07,119
any such hash could be you know

947
00:37:07,119 --> 00:37:09,920
matched into into other

948
00:37:09,920 --> 00:37:11,359
uh

949
00:37:11,359 --> 00:37:14,000
other uh hunted binaries

950
00:37:14,000 --> 00:37:16,160
there will be demo of this because

951
00:37:16,160 --> 00:37:19,280
that's kind of tricky to do right now uh

952
00:37:19,280 --> 00:37:22,480
in the smaller window of time but that

953
00:37:22,480 --> 00:37:24,480
was actually a thought behind you know

954
00:37:24,480 --> 00:37:27,040
in uh you know inducting this particular

955
00:37:27,040 --> 00:37:31,200
approach here in the in the presentation

956
00:37:34,720 --> 00:37:36,960
api sequences so

957
00:37:36,960 --> 00:37:38,079
um

958
00:37:38,079 --> 00:37:40,800
this was something this actually is the

959
00:37:40,800 --> 00:37:43,040
thing which actually came from from

960
00:37:43,040 --> 00:37:46,160
seasoned uh malware researchers who had

961
00:37:46,160 --> 00:37:48,400
been you know analyzing malware samples

962
00:37:48,400 --> 00:37:51,280
for decades uh

963
00:37:51,280 --> 00:37:54,400
they are so trained to look into space

964
00:37:54,400 --> 00:37:57,040
into binary for specific api call

965
00:37:57,040 --> 00:37:59,200
sequences that they can easily figure

966
00:37:59,200 --> 00:38:01,760
out okay this is maybe trifect this is

967
00:38:01,760 --> 00:38:04,560
maybe structured or whatever

968
00:38:04,560 --> 00:38:07,680
so uh we tried to use similar approach

969
00:38:07,680 --> 00:38:12,000
to kind of you know induct in our uh

970
00:38:12,000 --> 00:38:13,520
research as well

971
00:38:13,520 --> 00:38:17,680
uh results so far are uh kind of not in

972
00:38:17,680 --> 00:38:21,200
the state of uh production honestly uh

973
00:38:21,200 --> 00:38:22,960
we still are testing this particular

974
00:38:22,960 --> 00:38:25,440
approach but this approach is really

975
00:38:25,440 --> 00:38:26,720
awesome like in

976
00:38:26,720 --> 00:38:28,480
here an example we mentioned reading

977
00:38:28,480 --> 00:38:30,560
coil so like you know to read particular

978
00:38:30,560 --> 00:38:34,320
coil there would be some concrete set of

979
00:38:34,320 --> 00:38:36,960
api calls has to be done

980
00:38:36,960 --> 00:38:38,400
and

981
00:38:38,400 --> 00:38:40,640
and if we just kind of study some

982
00:38:40,640 --> 00:38:42,880
similar behaviors for other cyber

983
00:38:42,880 --> 00:38:46,400
physical systems then we can actually uh

984
00:38:46,400 --> 00:38:49,280
establish a concrete deduction mechanism

985
00:38:49,280 --> 00:38:50,079
for

986
00:38:50,079 --> 00:38:53,599
or for the given behavior across

987
00:38:53,599 --> 00:38:56,640
a multitude of binaries so that was an

988
00:38:56,640 --> 00:39:01,040
idea here uh next slide please

989
00:39:01,040 --> 00:39:03,280
device probes as we have already seen in

990
00:39:03,280 --> 00:39:04,720
previous

991
00:39:04,720 --> 00:39:07,839
demo there was there was a

992
00:39:07,839 --> 00:39:11,440
there was eth2 serial was being called

993
00:39:11,440 --> 00:39:14,160
similar scenarios can be found again

994
00:39:14,160 --> 00:39:16,800
there was a device probe in the plc uh

995
00:39:16,800 --> 00:39:18,880
relevant demo as well where with the red

996
00:39:18,880 --> 00:39:20,960
array we tried to actually locate that

997
00:39:20,960 --> 00:39:23,359
particular function where it was

998
00:39:23,359 --> 00:39:25,920
trying reach to a particular coil but as

999
00:39:25,920 --> 00:39:27,760
the coil was not present

1000
00:39:27,760 --> 00:39:29,520
into the local

1001
00:39:29,520 --> 00:39:31,200
network the

1002
00:39:31,200 --> 00:39:33,280
the failure the function failure

1003
00:39:33,280 --> 00:39:35,200
actually was highlighted and that's how

1004
00:39:35,200 --> 00:39:38,880
we realized i mean we uh deduce that yes

1005
00:39:38,880 --> 00:39:41,200
there are some devices being proved

1006
00:39:41,200 --> 00:39:45,118
um next slightly

1007
00:39:46,400 --> 00:39:49,040
yeah so the demo

1008
00:39:49,040 --> 00:39:52,480
here we would be uh so this demo uh

1009
00:39:52,480 --> 00:39:53,359
to

1010
00:39:53,359 --> 00:39:55,280
tell you okay we are doing modbus only

1011
00:39:55,280 --> 00:39:59,440
so yeah i i'll give you more details

1012
00:39:59,520 --> 00:40:01,839
so it is actually repetition demo from

1013
00:40:01,839 --> 00:40:04,800
the previous slide itself uh

1014
00:40:04,800 --> 00:40:07,119
then if possible we can fast forward it

1015
00:40:07,119 --> 00:40:08,960
to the end where we can actually show

1016
00:40:08,960 --> 00:40:13,640
the outcome directly

1017
00:40:29,040 --> 00:40:30,800
i don't think i can advance that

1018
00:40:30,800 --> 00:40:32,640
unfortunately

1019
00:40:32,640 --> 00:40:35,520
okay no problem

1020
00:40:37,119 --> 00:40:38,880
so again we are trying to probe those

1021
00:40:38,880 --> 00:40:42,160
open file functions uh or open file uh

1022
00:40:42,160 --> 00:40:44,400
api calls to understand what exactly is

1023
00:40:44,400 --> 00:40:45,440
happening

1024
00:40:45,440 --> 00:40:48,240
uh or rather where all all this

1025
00:40:48,240 --> 00:40:52,759
particular binary is trying to probe

1026
00:41:32,000 --> 00:41:34,240
yes and now we can see like error

1027
00:41:34,240 --> 00:41:36,160
accessing coil register address will

1028
00:41:36,160 --> 00:41:37,839
file something something so which gives

1029
00:41:37,839 --> 00:41:39,599
us fair enough idea that okay there is

1030
00:41:39,599 --> 00:41:41,920
some device being probed it could be

1031
00:41:41,920 --> 00:41:44,319
network device it could be you know

1032
00:41:44,319 --> 00:41:47,119
maybe a locally available device which

1033
00:41:47,119 --> 00:41:48,720
is actually being communicated over

1034
00:41:48,720 --> 00:41:50,560
serial

1035
00:41:50,560 --> 00:41:53,680
bus or something like that

1036
00:41:54,560 --> 00:41:56,240
so that was a motive there would be a

1037
00:41:56,240 --> 00:41:59,799
couple of more demos

1038
00:42:12,480 --> 00:42:15,200
no this is actually repetition

1039
00:42:15,200 --> 00:42:17,839
okay

1040
00:42:22,240 --> 00:42:24,720
so yes network device probes so there

1041
00:42:24,720 --> 00:42:27,200
are multiple ways we can actually detect

1042
00:42:27,200 --> 00:42:29,200
if the particular

1043
00:42:29,200 --> 00:42:31,200
binary is trying to reach a particular

1044
00:42:31,200 --> 00:42:33,040
network device that's either through

1045
00:42:33,040 --> 00:42:34,880
traffic analysis

1046
00:42:34,880 --> 00:42:38,079
or through addressing the ote protocols

1047
00:42:38,079 --> 00:42:38,880
or

1048
00:42:38,880 --> 00:42:42,319
through actually you know

1049
00:42:42,720 --> 00:42:46,079
doing again the analysis on binary so uh

1050
00:42:46,079 --> 00:42:48,240
for for traffic analysis simple thing is

1051
00:42:48,240 --> 00:42:50,240
in order to get the binary in in your

1052
00:42:50,240 --> 00:42:52,319
sandbox and monitor the traffic we

1053
00:42:52,319 --> 00:42:54,319
definitely would see some

1054
00:42:54,319 --> 00:42:57,520
some interesting uh

1055
00:42:57,520 --> 00:43:00,079
we can say probing or querying on to

1056
00:43:00,079 --> 00:43:00,960
local

1057
00:43:00,960 --> 00:43:02,480
uh network

1058
00:43:02,480 --> 00:43:05,200
and then as i mentioned about ot

1059
00:43:05,200 --> 00:43:07,599
protocols there would be some you know

1060
00:43:07,599 --> 00:43:10,160
uh interesting ot 11 protocols which can

1061
00:43:10,160 --> 00:43:13,119
be actually visible in most of the

1062
00:43:13,119 --> 00:43:15,119
most of the

1063
00:43:15,119 --> 00:43:16,800
packet analysis

1064
00:43:16,800 --> 00:43:19,280
but apart from that let's go to the

1065
00:43:19,280 --> 00:43:21,839
binary and see some demo on binary

1066
00:43:21,839 --> 00:43:25,680
directly so this demo was prepared

1067
00:43:25,680 --> 00:43:27,599
quite recently it

1068
00:43:27,599 --> 00:43:30,160
this binary actually is having

1069
00:43:30,160 --> 00:43:32,079
multitudes of functionality actually

1070
00:43:32,079 --> 00:43:34,640
addressing multitudes of uh

1071
00:43:34,640 --> 00:43:37,119
we can say protocol so here we

1072
00:43:37,119 --> 00:43:39,200
were actually able to see some relevant

1073
00:43:39,200 --> 00:43:44,160
functions specific to iec 1001 iec 102

1074
00:43:44,160 --> 00:43:50,520
iec 103 iec 104 iec 61850

1075
00:43:50,960 --> 00:43:53,839
then spa bus then

1076
00:43:53,839 --> 00:43:56,720
so uh but then the common interesting

1077
00:43:56,720 --> 00:44:00,400
thing among these all strings uh that i

1078
00:44:00,400 --> 00:44:02,160
have just altered

1079
00:44:02,160 --> 00:44:03,280
was

1080
00:44:03,280 --> 00:44:06,040
uh they all have uh you know

1081
00:44:06,040 --> 00:44:08,640
substation related functionality in

1082
00:44:08,640 --> 00:44:09,680
common

1083
00:44:09,680 --> 00:44:14,240
so which was kind of a unique uh

1084
00:44:14,240 --> 00:44:16,240
we can say deduction

1085
00:44:16,240 --> 00:44:18,400
we were able to make out of it

1086
00:44:18,400 --> 00:44:21,040
okay so analysis is complete and again

1087
00:44:21,040 --> 00:44:23,680
we would be going by the lazy approach

1088
00:44:23,680 --> 00:44:26,319
using the filters

1089
00:44:26,319 --> 00:44:28,800
for for finding if something interesting

1090
00:44:28,800 --> 00:44:30,240
is there

1091
00:44:30,240 --> 00:44:33,240
okay

1092
00:44:44,400 --> 00:44:45,839
yeah

1093
00:44:45,839 --> 00:44:48,880
so here we can see uh

1094
00:44:48,880 --> 00:44:50,480
some function which actually is an

1095
00:44:50,480 --> 00:44:52,000
external function

1096
00:44:52,000 --> 00:44:56,079
uh iec 101 underscore m probably means

1097
00:44:56,079 --> 00:44:57,359
master

1098
00:44:57,359 --> 00:44:59,280
reason being there is another entry for

1099
00:44:59,280 --> 00:45:03,119
iec 101 underscore s probably means

1100
00:45:03,119 --> 00:45:06,319
slave so that gives us like one concrete

1101
00:45:06,319 --> 00:45:07,599
proof

1102
00:45:07,599 --> 00:45:10,000
of this binary being cyber physical

1103
00:45:10,000 --> 00:45:12,079
relevant binary because there is some

1104
00:45:12,079 --> 00:45:15,599
master slave related

1105
00:45:15,760 --> 00:45:17,280
communication

1106
00:45:17,280 --> 00:45:19,599
embedded into this particular

1107
00:45:19,599 --> 00:45:22,960
uh function or in into this particular

1108
00:45:22,960 --> 00:45:24,240
binary

1109
00:45:24,240 --> 00:45:25,839
that is one

1110
00:45:25,839 --> 00:45:28,160
deduction we could find okay another was

1111
00:45:28,160 --> 00:45:31,440
iec 61850 another interesting substation

1112
00:45:31,440 --> 00:45:34,480
control protocol or standard we can say

1113
00:45:34,480 --> 00:45:36,960
that too we could see here again that is

1114
00:45:36,960 --> 00:45:39,040
external function call

1115
00:45:39,040 --> 00:45:41,839
so it's actually uh we can say an

1116
00:45:41,839 --> 00:45:43,680
external dll being called where these

1117
00:45:43,680 --> 00:45:46,400
all functions uh

1118
00:45:46,400 --> 00:45:49,040
were triggered

1119
00:45:49,040 --> 00:45:51,119
but nevertheless that gives us okay six

1120
00:45:51,119 --> 00:45:53,520
one eight five zero goes goose is again

1121
00:45:53,520 --> 00:45:55,920
another interesting implementation of

1122
00:45:55,920 --> 00:45:58,720
substations

1123
00:45:59,200 --> 00:46:01,599
uh now we could see you know good saint

1124
00:46:01,599 --> 00:46:03,760
andrews receives that gives us you know

1125
00:46:03,760 --> 00:46:05,920
concrete proof that this particular

1126
00:46:05,920 --> 00:46:09,040
binary is cyber physical relevant binary

1127
00:46:09,040 --> 00:46:12,560
against purpose underscore and probably

1128
00:46:12,560 --> 00:46:14,720
spa business protocols master

1129
00:46:14,720 --> 00:46:18,598
implementation it seems

1130
00:46:30,160 --> 00:46:32,960
so that's one demo there should be one

1131
00:46:32,960 --> 00:46:35,960
more

1132
00:46:45,119 --> 00:46:47,839
yes so this is taken demo where now we

1133
00:46:47,839 --> 00:46:52,560
are using radare tool to kind of uh

1134
00:46:52,560 --> 00:46:55,359
understand if the evidences we were able

1135
00:46:55,359 --> 00:46:57,839
to gather and get ra are are the real

1136
00:46:57,839 --> 00:47:00,160
one or is something missing or

1137
00:47:00,160 --> 00:47:02,000
something's false positive this is just

1138
00:47:02,000 --> 00:47:04,720
to validate the

1139
00:47:04,720 --> 00:47:06,640
the findings again

1140
00:47:06,640 --> 00:47:08,880
uh actually not required but then it's

1141
00:47:08,880 --> 00:47:10,480
always good to have

1142
00:47:10,480 --> 00:47:12,880
a couple of evidences in place going

1143
00:47:12,880 --> 00:47:15,359
further so here i did the same thing i

1144
00:47:15,359 --> 00:47:17,440
just tried search all functions

1145
00:47:17,440 --> 00:47:19,839
and i grabbed those all function lists

1146
00:47:19,839 --> 00:47:22,319
with i s d as a keyword and i could see

1147
00:47:22,319 --> 00:47:23,520
a lot of

1148
00:47:23,520 --> 00:47:27,200
iec relevant entries here so isc 104

1149
00:47:27,200 --> 00:47:31,200
source sorry slave iec 104 master

1150
00:47:31,200 --> 00:47:36,160
similar to 61850 61850 boos

1151
00:47:36,160 --> 00:47:39,839
and and so on and so forth

1152
00:47:42,880 --> 00:47:46,319
yeah the the instance of sparbus is also

1153
00:47:46,319 --> 00:47:48,480
here and that's actually a function call

1154
00:47:48,480 --> 00:47:49,680
that gives us

1155
00:47:49,680 --> 00:47:51,040
fair enough

1156
00:47:51,040 --> 00:47:52,880
set of proofs to consider this

1157
00:47:52,880 --> 00:47:56,079
particular binary is actually a cyber

1158
00:47:56,079 --> 00:47:59,599
physically relevant binary

1159
00:48:03,440 --> 00:48:07,280
here now we i'll be showing you some uh

1160
00:48:07,280 --> 00:48:09,359
some entries which are which actually is

1161
00:48:09,359 --> 00:48:11,680
a combination of the crept

1162
00:48:11,680 --> 00:48:14,160
outcomes we have seen in past here we

1163
00:48:14,160 --> 00:48:15,760
can see you know a lot of interesting

1164
00:48:15,760 --> 00:48:18,000
entries uh

1165
00:48:18,000 --> 00:48:21,200
uh mentioning you know ic61050

1166
00:48:21,200 --> 00:48:23,359
cybers powerbus

1167
00:48:23,359 --> 00:48:25,359
then google then

1168
00:48:25,359 --> 00:48:28,240
tcp cybers then there is cl cybers

1169
00:48:28,240 --> 00:48:30,800
should also be there modbus serial is

1170
00:48:30,800 --> 00:48:33,599
there modbus tcp is there

1171
00:48:33,599 --> 00:48:36,240
and for every of such

1172
00:48:36,240 --> 00:48:38,960
mentions there is either m or f appended

1173
00:48:38,960 --> 00:48:41,680
this is either master or slave

1174
00:48:41,680 --> 00:48:44,960
functionality being considered

1175
00:48:45,280 --> 00:48:48,240
so this is like you know concrete proof

1176
00:48:48,240 --> 00:48:50,319
that we were able to gather from this

1177
00:48:50,319 --> 00:48:53,359
whole analysis that okay the binary that

1178
00:48:53,359 --> 00:48:54,880
we are

1179
00:48:54,880 --> 00:48:57,359
considering for analysis or further

1180
00:48:57,359 --> 00:48:59,440
analysis is actually cyber physical

1181
00:48:59,440 --> 00:49:00,839
relevant

1182
00:49:00,839 --> 00:49:02,640
binary

1183
00:49:02,640 --> 00:49:05,520
next slide please

1184
00:49:14,800 --> 00:49:17,119
it is the same demo

1185
00:49:17,119 --> 00:49:18,720
we can

1186
00:49:18,720 --> 00:49:20,800
probably it was re

1187
00:49:20,800 --> 00:49:23,119
restarted yes

1188
00:49:23,119 --> 00:49:25,359
yara rules um

1189
00:49:25,359 --> 00:49:28,800
honestly uh my colleague was actually

1190
00:49:28,800 --> 00:49:30,960
able to find or rather is actually able

1191
00:49:30,960 --> 00:49:33,040
to find a lot of interesting samples

1192
00:49:33,040 --> 00:49:35,200
using yeah rules

1193
00:49:35,200 --> 00:49:37,440
but i was having no luck with yara rules

1194
00:49:37,440 --> 00:49:38,800
most of the time

1195
00:49:38,800 --> 00:49:40,640
reason being i was getting a lot of data

1196
00:49:40,640 --> 00:49:41,920
for sure a lot of

1197
00:49:41,920 --> 00:49:43,359
binaries

1198
00:49:43,359 --> 00:49:46,960
the problem was those binaries uh

1199
00:49:46,960 --> 00:49:48,640
were there but there was a lot of noise

1200
00:49:48,640 --> 00:49:49,680
as well

1201
00:49:49,680 --> 00:49:53,359
and sorting that noise in itself was

1202
00:49:53,359 --> 00:49:55,599
quite a competitive challenge reason

1203
00:49:55,599 --> 00:49:57,280
being i

1204
00:49:57,280 --> 00:50:00,160
per day i used to download at least 100

1205
00:50:00,160 --> 00:50:04,160
000 binaries and then used to sort them

1206
00:50:04,160 --> 00:50:06,240
even automatically

1207
00:50:06,240 --> 00:50:09,680
uh even if i happen to you know sort

1208
00:50:09,680 --> 00:50:12,319
them automatically it used to take at

1209
00:50:12,319 --> 00:50:15,440
least five hours for me

1210
00:50:15,440 --> 00:50:18,000
so that was kind of challenge for me uh

1211
00:50:18,000 --> 00:50:20,240
my colleague kenneth truska have solved

1212
00:50:20,240 --> 00:50:22,480
that challenge

1213
00:50:22,480 --> 00:50:25,680
but somehow i could not get a good lead

1214
00:50:25,680 --> 00:50:27,119
in that so far

1215
00:50:27,119 --> 00:50:29,200
uh but yes

1216
00:50:29,200 --> 00:50:31,119
for me what i could visualize out of

1217
00:50:31,119 --> 00:50:34,160
yara rules is that's kind of limited

1218
00:50:34,160 --> 00:50:36,480
approach at least for

1219
00:50:36,480 --> 00:50:37,680
my

1220
00:50:37,680 --> 00:50:39,280
mindset so far

1221
00:50:39,280 --> 00:50:41,280
and

1222
00:50:41,280 --> 00:50:44,000
unless it is really fine-tuned unless we

1223
00:50:44,000 --> 00:50:46,240
kind of you know

1224
00:50:46,240 --> 00:50:48,960
try to search for actual memory

1225
00:50:48,960 --> 00:50:51,839
artifacts using yara rules

1226
00:50:51,839 --> 00:50:53,520
uh this

1227
00:50:53,520 --> 00:50:56,880
is quite a challenging one to get uh uh

1228
00:50:56,880 --> 00:50:58,880
less noisy feeds

1229
00:50:58,880 --> 00:51:01,200
so that was kind of a limitation but

1230
00:51:01,200 --> 00:51:03,520
nevertheless it's actually really good

1231
00:51:03,520 --> 00:51:05,520
place to begin with

1232
00:51:05,520 --> 00:51:08,400
into ote relevant

1233
00:51:08,400 --> 00:51:10,720
malware hunting

1234
00:51:10,720 --> 00:51:13,439
next slide please

1235
00:51:15,520 --> 00:51:18,000
results uh

1236
00:51:18,000 --> 00:51:19,520
i think daniel

1237
00:51:19,520 --> 00:51:20,960
can actually

1238
00:51:20,960 --> 00:51:23,839
uh you know speak more on results i'll

1239
00:51:23,839 --> 00:51:25,440
just begin

1240
00:51:25,440 --> 00:51:26,480
uh

1241
00:51:26,480 --> 00:51:27,920
so okay

1242
00:51:27,920 --> 00:51:29,839
so this whole uh

1243
00:51:29,839 --> 00:51:31,359
we can say

1244
00:51:31,359 --> 00:51:33,280
excursion on

1245
00:51:33,280 --> 00:51:36,800
you know sorting the binaries for

1246
00:51:36,800 --> 00:51:38,720
ot relevance

1247
00:51:38,720 --> 00:51:41,680
uh gives gave us kind of kind of you

1248
00:51:41,680 --> 00:51:43,040
know

1249
00:51:43,040 --> 00:51:45,680
really trimmed down set of files to

1250
00:51:45,680 --> 00:51:47,520
further analyze

1251
00:51:47,520 --> 00:51:49,920
so earlier it used to be like you know

1252
00:51:49,920 --> 00:51:53,200
we used to using simple error rules i

1253
00:51:53,200 --> 00:51:55,040
used to get some file then i used to

1254
00:51:55,040 --> 00:51:56,800
analyze that and then

1255
00:51:56,800 --> 00:51:59,680
after the report was prepared i just

1256
00:51:59,680 --> 00:52:01,280
realized okay this

1257
00:52:01,280 --> 00:52:03,520
binary has some keywords which are

1258
00:52:03,520 --> 00:52:05,920
specific to ot but

1259
00:52:05,920 --> 00:52:08,960
ah there is no functionality which is

1260
00:52:08,960 --> 00:52:10,720
actually relevant to cyber physical

1261
00:52:10,720 --> 00:52:13,040
systems or operational technology

1262
00:52:13,040 --> 00:52:16,400
so using this particular set of tests of

1263
00:52:16,400 --> 00:52:18,640
reduction we were able to kind of you

1264
00:52:18,640 --> 00:52:22,559
know remove that operational overhead

1265
00:52:22,559 --> 00:52:23,839
uh

1266
00:52:23,839 --> 00:52:24,880
we did

1267
00:52:24,880 --> 00:52:28,000
try automating some of these tests and

1268
00:52:28,000 --> 00:52:29,599
that actually helped us you know

1269
00:52:29,599 --> 00:52:32,400
expediating analysis as well

1270
00:52:32,400 --> 00:52:34,160
and as i have said already like you know

1271
00:52:34,160 --> 00:52:37,119
it helped us reducing the clutter

1272
00:52:37,119 --> 00:52:39,760
and gave us gave us like you know fair

1273
00:52:39,760 --> 00:52:42,400
enough uh

1274
00:52:42,400 --> 00:52:45,599
informed decisive capability to

1275
00:52:45,599 --> 00:52:48,800
set a benchmark or at least a partial

1276
00:52:48,800 --> 00:52:51,359
benchmark to sort of operational

1277
00:52:51,359 --> 00:52:53,920
technology relevant or cyber physical

1278
00:52:53,920 --> 00:52:57,359
systems relevant binaries

1279
00:52:57,359 --> 00:53:00,920
next slide please

1280
00:53:01,839 --> 00:53:04,800
yeah i think we are reaching to end of

1281
00:53:04,800 --> 00:53:06,559
uh presentation

1282
00:53:06,559 --> 00:53:09,280
so these are some of the sources i have

1283
00:53:09,280 --> 00:53:10,319
used

1284
00:53:10,319 --> 00:53:13,680
uh all of them are openly available

1285
00:53:13,680 --> 00:53:16,240
so please feel free to

1286
00:53:16,240 --> 00:53:19,040
go through them if if there is

1287
00:53:19,040 --> 00:53:21,200
if there are any questions

1288
00:53:21,200 --> 00:53:22,079
uh

1289
00:53:22,079 --> 00:53:25,200
we would be more than happy to answer

1290
00:53:25,200 --> 00:53:26,240
and

1291
00:53:26,240 --> 00:53:28,880
if the time descent permit is answering

1292
00:53:28,880 --> 00:53:30,079
right now

1293
00:53:30,079 --> 00:53:30,880
uh

1294
00:53:30,880 --> 00:53:34,079
definitely we both are reachable offline

1295
00:53:34,079 --> 00:53:37,200
online we can all we can always be there

1296
00:53:37,200 --> 00:53:39,839
to help you

1297
00:53:41,119 --> 00:53:42,960
yeah thanks and and just to

1298
00:53:42,960 --> 00:53:45,760
echo what russia said in the end i'm i'm

1299
00:53:45,760 --> 00:53:47,680
really sorry really apologize that i did

1300
00:53:47,680 --> 00:53:49,680
not bring any responses like we give you

1301
00:53:49,680 --> 00:53:51,280
just some examples and foundations how

1302
00:53:51,280 --> 00:53:53,359
we're going about it but what we we

1303
00:53:53,359 --> 00:53:55,280
really want to everyone from here to get

1304
00:53:55,280 --> 00:53:57,119
it's more like there is a challenge an

1305
00:53:57,119 --> 00:53:58,960
open challenge to try to work in this

1306
00:53:58,960 --> 00:54:01,440
type of area we provide some examples of

1307
00:54:01,440 --> 00:54:03,200
one approach that we're using that's why

1308
00:54:03,200 --> 00:54:04,960
we highlighted the yara one for example

1309
00:54:04,960 --> 00:54:06,640
that we have there might be many

1310
00:54:06,640 --> 00:54:08,640
different approaches if you have ideas

1311
00:54:08,640 --> 00:54:09,839
we'd love to see you maybe in the next

1312
00:54:09,839 --> 00:54:11,680
conference or reach out to us and we

1313
00:54:11,680 --> 00:54:14,160
would love to work a bit more in that uh

1314
00:54:14,160 --> 00:54:15,839
because in the end the challenge for for

1315
00:54:15,839 --> 00:54:17,680
finding this type of malware is you know

1316
00:54:17,680 --> 00:54:19,520
it has a very high impact it's very

1317
00:54:19,520 --> 00:54:21,599
difficult to find it but if you find it

1318
00:54:21,599 --> 00:54:23,040
i'm pretty sure everyone's gonna love

1319
00:54:23,040 --> 00:54:24,640
you

1320
00:54:24,640 --> 00:54:26,480
the only thing in here is that there are

1321
00:54:26,480 --> 00:54:28,000
two two different approaches you can do

1322
00:54:28,000 --> 00:54:30,240
it a lot of that you can do it manually

1323
00:54:30,240 --> 00:54:32,000
but the challenge is it's mainly like

1324
00:54:32,000 --> 00:54:33,440
what the type of work that rishikesh is

1325
00:54:33,440 --> 00:54:35,520
doing to try to make it in in more

1326
00:54:35,520 --> 00:54:37,920
automated ways more clever ways so that

1327
00:54:37,920 --> 00:54:39,599
you can filter among all the clutter

1328
00:54:39,599 --> 00:54:41,599
because if you normally have this amount

1329
00:54:41,599 --> 00:54:44,160
of noise for ot we have twice as much

1330
00:54:44,160 --> 00:54:45,760
because only a couple are going to be

1331
00:54:45,760 --> 00:54:47,119
what matter

1332
00:54:47,119 --> 00:54:49,680
but uh yeah thanks for everything this

1333
00:54:49,680 --> 00:54:51,520
is all and we jump if you have any

1334
00:54:51,520 --> 00:54:53,040
questions i don't know

1335
00:54:53,040 --> 00:54:54,640
i think we have like a couple minutes so

1336
00:54:54,640 --> 00:54:55,839
if you have any questions feel free to

1337
00:54:55,839 --> 00:54:58,079
drop

1338
00:54:58,079 --> 00:55:00,880
well if not don't worry uh let us know

1339
00:55:00,880 --> 00:55:01,839
if you

1340
00:55:01,839 --> 00:55:03,760
have anything uh there's there our

1341
00:55:03,760 --> 00:55:05,920
emails feel free to reach out and thanks

1342
00:55:05,920 --> 00:55:09,720
a lot thank you

1343
00:55:10,250 --> 00:55:14,960
[Applause]

