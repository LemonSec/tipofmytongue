1
00:00:09,960 --> 00:00:10,550
so much good

2
00:00:10,550 --> 00:00:14,750
as so yeah I'm I'm snare a look at some
from

3
00:00:14,750 --> 00:00:19,700
now than Australia which is a really
long fucking way away I work as a

4
00:00:19,700 --> 00:00:20,360
security

5
00:00:20,360 --> 00:00:24,260
doing some computer stuff I like mostly
as a yes

6
00:00:24,260 --> 00:00:27,829
I you might have seen my talks ask the
is about

7
00:00:27,829 --> 00:00:31,180
if I you know for my persistence stuff
and

8
00:00:31,180 --> 00:00:34,670
your rs.10 colonel you have factory

9
00:00:34,670 --> 00:00:37,820
I am my body resonated this research
with me

10
00:00:37,820 --> 00:00:41,140
is in here because he's like being a
grown-up and

11
00:00:41,140 --> 00:00:44,870
riding a PhD thesis or something I which
he decided his

12
00:00:44,870 --> 00:00:47,930
two important terms of away from to come
drink all the beer

13
00:00:47,930 --> 00:00:51,239
but yessir on present on his behalf as
well

14
00:00:51,239 --> 00:00:55,589
he'll hot stuff which you'll see later
on so

15
00:00:55,589 --> 00:00:58,850
basically I'm gonna talk a little bit
about I on the ball

16
00:00:58,850 --> 00:01:04,100
damn attacks I be live in talking about
the attacks

17
00:01:04,100 --> 00:01:08,130
in a few years I've seen what if I last
of I than and on what kinda thing and

18
00:01:08,130 --> 00:01:11,220
people would just like to call you this
is the only thing we can do damage

19
00:01:11,220 --> 00:01:14,460
attacks but same things as what I did
with the FIA

20
00:01:14,460 --> 00:01:18,260
them with assistance of hadn't seen
anyone actually do as I want to do it

21
00:01:18,260 --> 00:01:19,510
and see you know make sure it's

22
00:01:19,510 --> 00:01:22,640
it's all it's all good life you things
in the process I

23
00:01:22,640 --> 00:01:25,650
resin the you note thought the same
thing we

24
00:01:25,650 --> 00:01:29,970
we pack up the conversations about it an
hour he's a he's like an FPGA guy

25
00:01:29,970 --> 00:01:34,390
I pressured on his injury thing yeah
he's it you know FPGA night

26
00:01:34,390 --> 00:01:38,410
he's a unique doing his PhD thingy on
FPGA stuff the ray tracing

27
00:01:38,410 --> 00:01:41,970
arm say it we you know got together and

28
00:01:41,970 --> 00:01:45,760
lesser alan simpson at BJ's and PCI
Express and whatnot

29
00:01:45,760 --> 00:01:50,290
and I came up with this stuff so he go
through a little bit about like that the

30
00:01:50,290 --> 00:01:51,030
history of

31
00:01:51,030 --> 00:01:54,310
a file id: attacks I and how that stuff
works

32
00:01:54,310 --> 00:01:58,550
I stood up on the ball outfits together
ups and

33
00:01:58,550 --> 00:02:02,840
PCI Express tough because that serve its
into this as well

34
00:02:02,840 --> 00:02:05,560
like what an FPGA is and how it works
for those who don't

35
00:02:05,560 --> 00:02:09,170
Dorner because I pictures locked in
before start this into them softly I

36
00:02:09,170 --> 00:02:12,800
arm and how we put a lot together in our
personal attack

37
00:02:12,800 --> 00:02:16,349
on the ball and as I i did not bring my
like Derek it

38
00:02:16,349 --> 00:02:19,880
because I'm traveling on two of two
months I don't like ares galaxy case on

39
00:02:19,880 --> 00:02:20,530
the wild side

40
00:02:20,530 --> 00:02:23,590
I video instead sweets act ima sorry

41
00:02:23,590 --> 00:02:27,769
and I guess those few slides on defense
does some people care about that

42
00:02:27,769 --> 00:02:31,860
I am so file I DM a tax

43
00:02:31,860 --> 00:02:35,680
a I think I think I like actually just
like on the bus

44
00:02:35,680 --> 00:02:39,170
DNA attacks all major or the bearded one
of the first ones on

45
00:02:39,170 --> 00:02:42,190
years ago on with his triple bought

46
00:02:42,190 --> 00:02:45,250
which is pretty Nate II in the first
hour

47
00:02:45,250 --> 00:02:48,510
the the first Flywire DMA trick like

48
00:02:48,510 --> 00:02:53,290
flexed on hacked I that I ever saw was
this crazy dude Apple Quinn the Eskimo

49
00:02:53,290 --> 00:02:57,580
who if you're you know ask arcane
colonel questions on the dow in kernel

50
00:02:57,580 --> 00:02:58,340
mailing list

51
00:02:58,340 --> 00:03:01,750
of I'll DCS like tech support incidence
Apple

52
00:03:01,750 --> 00:03:05,000
he'll usually answer your questions in
great detail

53
00:03:05,000 --> 00:03:08,450
and you wonder how the hell you know so
much about it arm

54
00:03:08,450 --> 00:03:13,630
say to this thing in 2002 arm way
connected to mexico the wifi while

55
00:03:13,630 --> 00:03:17,940
Andrew screensaver on the other Macs
framebuffer are the file I think the DNA

56
00:03:17,940 --> 00:03:22,180
and as I hey this is Cora and all the
evil people after

57
00:03:22,180 --> 00:03:26,250
yes this is cool arm and then Metal
Storm couple years later

58
00:03:26,250 --> 00:03:30,350
at its over rocks on where he United
this would not mind thing where

59
00:03:30,350 --> 00:03:33,489
he you know kept the two machines the
other by file I wrote to you

60
00:03:33,489 --> 00:03:37,440
your down the current in the in the
Windows my logon thing or whatever

61
00:03:37,440 --> 00:03:41,930
does the authentication retain I you
know not that some shit

62
00:03:41,930 --> 00:03:45,760
and made it so he can is like typing
faucet and hand it answer that the

63
00:03:45,760 --> 00:03:46,630
attack that we now

64
00:03:46,630 --> 00:03:50,850
you know commonly now no its inception
this is the so the comments all to do

65
00:03:50,850 --> 00:03:56,310
to that attack so flower DNA stuff works
by using the SBB tu protocol

66
00:03:56,310 --> 00:03:58,689
I'm just sort of power flower

67
00:03:58,689 --> 00:04:03,030
I and it basically just like you send
the Senate commando the file I bus

68
00:04:03,030 --> 00:04:06,049
I to the chips at the other end say a

69
00:04:06,049 --> 00:04:09,159
please do exits and MA reads and writes
to

70
00:04:09,159 --> 00:04:13,069
these regions memory doesn't so he can
do that

71
00:04:13,069 --> 00:04:16,590
years that's like two take for memory
done for the system like in stream all

72
00:04:16,590 --> 00:04:18,650
that daughter out flower in a vase
Lincoln

73
00:04:18,650 --> 00:04:21,870
the %um up on inception

74
00:04:21,870 --> 00:04:25,740
hacks whatever so looks kinda like this

75
00:04:25,740 --> 00:04:29,979
you know that I get us there I'll get
this express bus the bottom

76
00:04:29,979 --> 00:04:34,490
on that if i watch it to connect to it
and that the analysis iced

77
00:04:34,490 --> 00:04:38,470
you know for the bad guy whenever arm
attach 00 flour

78
00:04:38,470 --> 00:04:41,560
of I watch it says

79
00:04:41,560 --> 00:04:45,169
bird please read some doubt at this
address it says yet

80
00:04:45,169 --> 00:04:48,889
okay does it in a raid on this express
bus and sons a daughter back

81
00:04:48,889 --> 00:04:53,070
or whatever on there's a few limitations
is attack

82
00:04:53,070 --> 00:04:56,360
on Dec becoming more and more relevant
arm

83
00:04:56,360 --> 00:04:59,970
the size of a closet as a flower in the
face that's not a big problem

84
00:04:59,970 --> 00:05:03,510
on like you know Carmack systems or
anything with an Express card slot

85
00:05:03,510 --> 00:05:07,310
things like attachment to the PCI
Express bus by Thunderball

86
00:05:07,310 --> 00:05:10,349
or via Express card or some other
expansion you know

87
00:05:10,349 --> 00:05:13,449
expansion busting like you know maybe
when the docking interface

88
00:05:13,449 --> 00:05:17,580
like here talking Hastings or whatever I

89
00:05:17,580 --> 00:05:22,750
the the 1.1 some for the Miramar
implementations that firewire

90
00:05:22,750 --> 00:05:26,400
is that it is addressing sorry can only
access the law thought he was a memory

91
00:05:26,400 --> 00:05:30,970
which was a big problem you know when
file our tax became prevalent but now

92
00:05:30,970 --> 00:05:34,320
I mean my bike crappy to travel at all
as I

93
00:05:34,320 --> 00:05:37,330
is our apt SAR you know if the current I

94
00:05:37,330 --> 00:05:40,770
that contains the in authentication
retain happens

95
00:05:40,770 --> 00:05:44,010
not be the first for your memory can do
that the screen amongst on ACK

96
00:05:44,010 --> 00:05:47,909
and to remember apposition wall he top
acquire a love memory

97
00:05:47,909 --> 00:05:51,080
on tho the law on

98
00:05:51,080 --> 00:05:53,189
Mac OS I

99
00:05:53,189 --> 00:05:57,229
the firewire driver has a little code
which prohibits lies with us just like

100
00:05:57,229 --> 00:06:00,249
if secure mode arm which basically means

101
00:06:00,249 --> 00:06:03,550
if we have I fall

102
00:06:03,550 --> 00:06:07,110
to enabled so a full description abled
and screen is locked

103
00:06:07,110 --> 00:06:10,949
then tell if i watch upset to not do
damn animal

104
00:06:10,949 --> 00:06:16,339
right so that basically means when
screens lucky cock do to stop this

105
00:06:16,339 --> 00:06:17,599
screen unlock some hack

106
00:06:17,599 --> 00:06:22,490
on artie was a 10.7% then later or
something like that

107
00:06:22,490 --> 00:06:26,270
on Sarah so thats you know that's kinda
Obama

108
00:06:26,270 --> 00:06:29,889
so yeah there's quite a few limitations
that make firewire not the best option

109
00:06:29,889 --> 00:06:31,289
these days that kinda thing

110
00:06:31,289 --> 00:06:35,939
so the way that you know isn't about
them at accident on the spot is just

111
00:06:35,939 --> 00:06:39,659
kinda cheating with file I so it's just
effect fired after to that

112
00:06:39,659 --> 00:06:43,559
teleport arm and you know hence the PCI
Express bus

113
00:06:43,559 --> 00:06:47,439
and any birth a file I chipset and you
can just do the same old tax

114
00:06:47,439 --> 00:06:51,610
that you could do with FireWire with on
board file a chipset

115
00:06:51,610 --> 00:06:55,199
on so it's baseless and onboard

116
00:06:55,199 --> 00:06:59,069
by watch upset as basically subject to
the same limitations as an on board fire

117
00:06:59,069 --> 00:07:00,439
watch upset so this

118
00:07:00,439 --> 00:07:03,909
you know on the phone ramp you know

119
00:07:03,909 --> 00:07:07,050
dollop of screen screen locking doesn't
work

120
00:07:07,050 --> 00:07:10,129
et cetera arm so

121
00:07:10,129 --> 00:07:13,620
disbelief some more stuff we can do

122
00:07:13,620 --> 00:07:18,050
with Thunderbolt because it's basically
just PCI Express and display booklet

123
00:07:18,050 --> 00:07:18,550
together

124
00:07:18,550 --> 00:07:23,089
and then like some GPIO and you know
through this like 10 to 20 megabits

125
00:07:23,089 --> 00:07:26,669
Tom Surat gave its your connection right
arm

126
00:07:26,669 --> 00:07:30,639
if you look really closely actually see
the pixie dust there were

127
00:07:30,639 --> 00:07:32,180
simple stuck together

128
00:07:32,180 --> 00:07:36,160
um that's that's at work on Intel's
official in a mocking diagrams the pics

129
00:07:36,160 --> 00:07:36,690
yes there

130
00:07:36,690 --> 00:07:40,470
I see I think you know it by sending a
request directly

131
00:07:40,470 --> 00:07:44,820
the PCI Express if we can exit from the
airport arm

132
00:07:44,820 --> 00:07:47,830
so this is so what the Thunderball are

133
00:07:47,830 --> 00:07:51,100
control alike layout looks like in a in
a system

134
00:07:51,100 --> 00:07:54,199
on we've got four Lanza PCI Express

135
00:07:54,199 --> 00:07:58,000
that there's now more than double to
like you gotta you know she was unable

136
00:07:58,000 --> 00:07:58,449
to

137
00:07:58,449 --> 00:08:02,430
going into and get this label or going
into the Thunderball control

138
00:08:02,430 --> 00:08:06,389
and then we've got this you know twenty
28 a bit

139
00:08:06,389 --> 00:08:10,020
are link between the house and the
device and that the device and

140
00:08:10,020 --> 00:08:14,000
we've got and others on the controller's
probably essentially the same as the

141
00:08:14,000 --> 00:08:17,650
the one you know that host and/or could
be like it dissolves 2010 whatever

142
00:08:17,650 --> 00:08:21,590
arm lives without PCI Express in this
label

143
00:08:21,590 --> 00:08:25,289
savings essentially got PCI Express in
this Bible outside the case the same way

144
00:08:25,289 --> 00:08:26,130
the voice had

145
00:08:26,130 --> 00:08:29,300
you know Express card car bus

146
00:08:29,300 --> 00:08:32,779
docking soft whatever outside the case
which is

147
00:08:32,779 --> 00:08:36,640
sounds like fun right I am so

148
00:08:36,640 --> 00:08:41,370
inside the CIA as are the fumble I
controller itself this is kinda looks

149
00:08:41,370 --> 00:08:41,810
like

150
00:08:41,810 --> 00:08:45,980
arm ignore the bit where it says Mac and
PC asia's yes those from Apple's like

151
00:08:45,980 --> 00:08:46,810
diagrams

152
00:08:46,810 --> 00:08:50,100
from Apple's documentation that the sea
ice as he could just be like

153
00:08:50,100 --> 00:08:54,440
any other on the vault device so got

154
00:08:54,440 --> 00:08:57,850
the CIA switch an anatomical switch

155
00:08:57,850 --> 00:09:01,720
at this express goes in there I

156
00:09:01,720 --> 00:09:04,810
goes through the sea ice which and you
know becomes

157
00:09:04,810 --> 00:09:08,140
fancy 2820 Gigabit Thunderbolt

158
00:09:08,140 --> 00:09:12,190
connection comes out the other end and
then got PCI Express coming out the

159
00:09:12,190 --> 00:09:12,680
other end

160
00:09:12,680 --> 00:09:16,100
no matter the carrots with DisplayPort
Fiskars we can do DNA

161
00:09:16,100 --> 00:09:19,200
PCI Express sir

162
00:09:19,200 --> 00:09:23,060
little background on PCI Express because
I know I know a lot about this before I

163
00:09:23,060 --> 00:09:23,550
started

164
00:09:23,550 --> 00:09:28,140
and resin did because you know israel is
crazy ray tracing stuff

165
00:09:28,140 --> 00:09:31,250
there's always other is oxidizer sorry
lee mayer

166
00:09:31,250 --> 00:09:34,410
my area but I am so PCI Express

167
00:09:34,410 --> 00:09:39,080
I is the main system bus right it's a
it's a serial point to point to connect

168
00:09:39,080 --> 00:09:42,340
you know bunch lanes other

169
00:09:42,340 --> 00:09:45,720
negotiating set up so you know you can
have you like 16 lane

170
00:09:45,720 --> 00:09:50,470
fancy graphics card arm and Mike is a
dremel tool I cut the end out a one-lane

171
00:09:50,470 --> 00:09:52,590
slot and a stick the sixth inning ka din
that

172
00:09:52,590 --> 00:09:56,020
I'll just go all is only one way
connected electrically sir artist

173
00:09:56,020 --> 00:09:59,410
do is what mine sir it's all negotiated

174
00:09:59,410 --> 00:10:04,070
at link setup and you know works need
like that which is kinda got a few

175
00:10:04,070 --> 00:10:07,130
you know what I do like does call in
mining well

176
00:10:07,130 --> 00:10:10,380
punch cards new 1x lots I

177
00:10:10,380 --> 00:10:13,950
each lane has like you know just for
wires

178
00:10:13,950 --> 00:10:17,620
TX and arts like differential past two
season differential signaling

179
00:10:17,620 --> 00:10:20,640
same way that you know the microphone
cable works

180
00:10:20,640 --> 00:10:25,380
parent later cancer nyse: know much
about are a guy that seems legit to me

181
00:10:25,380 --> 00:10:30,770
on its your kinda like a lot of
networking protocols lead packet-based

182
00:10:30,770 --> 00:10:34,010
your transaction protocol 3

183
00:10:34,010 --> 00:10:37,020
three layers that we care about physical
day lincoln transaction

184
00:10:37,020 --> 00:10:41,360
Arnold the communication between you
know and points and the complex

185
00:10:41,360 --> 00:10:46,640
is done without co-pays transaction back
its says come out stock looks like

186
00:10:46,640 --> 00:10:49,810
got transaction led a link

187
00:10:49,810 --> 00:10:55,100
physical layer Lincoln between and
outside device called being

188
00:10:55,100 --> 00:10:58,200
you know maybe a tad that

189
00:10:58,200 --> 00:11:02,760
core whatever I sys-con what the PCI
Express

190
00:11:02,760 --> 00:11:07,200
boss layout looks like and a typical

191
00:11:07,200 --> 00:11:10,270
single CPU system got CPU their

192
00:11:10,270 --> 00:11:13,610
are connected to the conflicts

193
00:11:13,610 --> 00:11:17,140
which is or the you know the main I

194
00:11:17,140 --> 00:11:20,350
you know main and point it to which
everything else is connected

195
00:11:20,350 --> 00:11:23,910
I can have you know PCI switches

196
00:11:23,910 --> 00:11:27,120
PCI Express which is to i connect the
whole bunch devices for

197
00:11:27,120 --> 00:11:30,610
I you know you might have an endpoint
connected directly to the

198
00:11:30,610 --> 00:11:34,580
to the complex there and you know this
potentially bridges

199
00:11:34,580 --> 00:11:37,690
to legacy particles like legacy bus

200
00:11:37,690 --> 00:11:42,300
I sections like PC I'll Saix and

201
00:11:42,300 --> 00:11:45,400
the loss of memory connected directly to
your complex which is

202
00:11:45,400 --> 00:11:51,190
you know every due out Sunday myself on
so before transaction sites

203
00:11:51,190 --> 00:11:56,240
we only really care about the memories
all rights but is also I reason rights

204
00:11:56,240 --> 00:11:59,670
which is kinda deprecated now most
everything is

205
00:11:59,670 --> 00:12:04,930
I like memory mapped i/o biking I reads
and writes configuration reason rights

206
00:12:04,930 --> 00:12:08,150
which appear we can write to a device's
configuration space and

207
00:12:08,150 --> 00:12:12,780
and tell you know to enable some Mota
whether and as

208
00:12:12,780 --> 00:12:18,060
memories and rights and messaging
messages like no interruptions

209
00:12:18,060 --> 00:12:21,280
so the DNA we basically

210
00:12:21,280 --> 00:12:24,890
you know if you connect the device Allah
graphics card or whatever

211
00:12:24,890 --> 00:12:29,440
the system all be like okay in the past
master companies alike you know

212
00:12:29,440 --> 00:12:34,080
writers and MA officielle Kencana
whatever we can you write

213
00:12:34,080 --> 00:12:37,160
talking to Jessica man's advice I'll do
some stuff

214
00:12:37,160 --> 00:12:41,120
ride it all back to memory in a little
sentence right when it's finished

215
00:12:41,120 --> 00:12:44,430
so there's a table

216
00:12:44,430 --> 00:12:48,240
I saw from probably Intel thing on the
Intel

217
00:12:48,240 --> 00:12:53,340
presentations around stills diagrams
from which I have put in the references

218
00:12:53,340 --> 00:12:58,480
so that memories and writes I reason
rights come to grazing rights messaging

219
00:12:58,480 --> 00:13:01,970
and the completion of the completion
messages like the ones that you know the

220
00:13:01,970 --> 00:13:05,170
the at the other end point will send
back to you when it's done whether it's

221
00:13:05,170 --> 00:13:06,190
you know with daughter or

222
00:13:06,190 --> 00:13:10,210
nom an error or or whatever

223
00:13:10,210 --> 00:13:12,800
okay sir at BJ's

224
00:13:12,800 --> 00:13:17,290
there are not enough PJ's yep

225
00:13:17,290 --> 00:13:20,860
their aunt Annie FPGA development thank
you as always they have

226
00:13:20,860 --> 00:13:26,450
so for software guy its ocular kinda
daunting because it's not actually like

227
00:13:26,450 --> 00:13:29,870
your striker robot sorry card it's like
circuits

228
00:13:29,870 --> 00:13:35,839
arm sorry it's your curricula spent
surfaces based like a reprogrammable

229
00:13:35,839 --> 00:13:36,390
chip

230
00:13:36,390 --> 00:13:39,870
in a reprogrammable I C and a lot of
different stuff with its just you know

231
00:13:39,870 --> 00:13:40,560
bigger ray

232
00:13:40,560 --> 00:13:44,250
the matrix earth slices which each
contain Michael

233
00:13:44,250 --> 00:13:48,510
dinner lookup tables thoughts carry
chains you know all some some fancy

234
00:13:48,510 --> 00:13:52,279
circuit the stuff that I really know
that right arm

235
00:13:52,279 --> 00:13:55,540
is all but about that you know features
that features can have to make different

236
00:13:55,540 --> 00:13:56,470
types of

237
00:13:56,470 --> 00:13:59,720
you know circuits easy to build like DSP
stuff and

238
00:13:59,720 --> 00:14:03,760
in our block Rams and whatever else I
and also

239
00:14:03,760 --> 00:14:07,300
is leading a bunch of PJ's a
device-specific features like am I have

240
00:14:07,300 --> 00:14:07,700
a full

241
00:14:07,700 --> 00:14:11,470
ethernet cord so I can se dice dental
and all that stuff in logic

242
00:14:11,470 --> 00:14:14,470
you know dr. am on the chip maybe

243
00:14:14,470 --> 00:14:17,630
even of the heart I micro control a call
at the sink

244
00:14:17,630 --> 00:14:20,920
if EJ's on or PCI Express transceiver

245
00:14:20,920 --> 00:14:24,680
which is what you know it kinda
interested in so

246
00:14:24,680 --> 00:14:27,709
yep I guess the mornings as
reprogrammable and can basically you

247
00:14:27,709 --> 00:14:30,350
know do the job let's all the different
types of IC's

248
00:14:30,350 --> 00:14:35,529
on this on this one thing by like
programming and certain way on

249
00:14:35,529 --> 00:14:38,740
so that's kinda lot looks like a lookup
table

250
00:14:38,740 --> 00:14:42,700
you know it's some fancy thinking right
represent all different types

251
00:14:42,700 --> 00:14:46,410
gates him one thing depending on a
program at so

252
00:14:46,410 --> 00:14:49,630
year that this is basically may like

253
00:14:49,630 --> 00:14:54,370
Tom doing a PJ stuff that's

254
00:14:54,370 --> 00:14:59,990
I just I I don't get it I love sign to
get have it's it's kinda hard but I'm

255
00:14:59,990 --> 00:15:00,450
resin

256
00:15:00,450 --> 00:15:04,089
knows all that shit answer another
feature

257
00:15:04,089 --> 00:15:08,930
on that we see on on some others as I
links was RHP John on the on the mark on

258
00:15:08,930 --> 00:15:09,300
the

259
00:15:09,300 --> 00:15:11,690
I PJs but some who can implement in

260
00:15:11,690 --> 00:15:15,010
in FPGA logic is our Marco Blaze which
is

261
00:15:15,010 --> 00:15:18,650
I basically a soft miker control of that
we can implement

262
00:15:18,650 --> 00:15:22,410
on that on the FPGA I am so talks

263
00:15:22,410 --> 00:15:27,440
XI bus which is here just sort by the
microcontroller equivalents of PCI

264
00:15:27,440 --> 00:15:28,940
Express in the main system bus

265
00:15:28,940 --> 00:15:32,160
solely funds for we have an exile bus
with older

266
00:15:32,160 --> 00:15:35,950
peripherals connected to the CPU
whatever also taken all talk to each

267
00:15:35,950 --> 00:15:36,330
other

268
00:15:36,330 --> 00:15:40,050
I and its basically like

269
00:15:40,050 --> 00:15:43,580
I like memory mapped hotel yet

270
00:15:43,580 --> 00:15:46,630
may not enter into the market place's
like

271
00:15:46,630 --> 00:15:49,730
a memory space so we can talk to that to
the boss

272
00:15:49,730 --> 00:15:53,890
code for you know marketplace or any
other soft market control can ride in

273
00:15:53,890 --> 00:15:55,970
like whatever and then compile it to 'em

274
00:15:55,970 --> 00:15:59,500
talk about to binary for the marker
controllers are in this case with this

275
00:15:59,500 --> 00:16:00,820
record in like calc

276
00:16:00,820 --> 00:16:03,970
as possible API place STK tinker

277
00:16:03,970 --> 00:16:07,700
formica lies development with XI which
is quite nice

278
00:16:07,700 --> 00:16:11,220
so it's israelis overriding control
logic on

279
00:16:11,220 --> 00:16:15,540
rather than building lease overly
complex state machines in the HD lol

280
00:16:15,540 --> 00:16:18,890
yessir news like making right see card

281
00:16:18,890 --> 00:16:22,770
that will tell them you know chance that
BJ logic what to do

282
00:16:22,770 --> 00:16:26,090
which is which is great arm

283
00:16:26,090 --> 00:16:29,680
it also implements you out so we can in
a plugin USB

284
00:16:29,680 --> 00:16:33,440
cable into the FPGA development board
cancelled

285
00:16:33,440 --> 00:16:36,980
serial and then like if like for nafta
blog

286
00:16:36,980 --> 00:16:40,000
out the syrup or which is great rather
than Mike

287
00:16:40,000 --> 00:16:43,550
you know the way to debug the actual
logic is

288
00:16:43,550 --> 00:16:48,330
is on you no answer like a a logic
analyzer core

289
00:16:48,330 --> 00:16:52,040
and then you have this you know chips
car display

290
00:16:52,040 --> 00:16:59,029
with lotsa like square waves that
apparently mean PCI Express packets

291
00:16:59,029 --> 00:17:02,410
I'm so how do we do actually do PCI
Express with this guy

292
00:17:02,410 --> 00:17:07,900
the xy that is and i XI PCI Express Co
which is the bridge between Axim PCI

293
00:17:07,900 --> 00:17:08,500
Express

294
00:17:08,500 --> 00:17:13,230
on and that gets memory mapped into the
market place's address based so we can

295
00:17:13,230 --> 00:17:13,819
kinda

296
00:17:13,819 --> 00:17:18,100
and is delayed memories and writes arm
to sell registers

297
00:17:18,100 --> 00:17:22,980
and do a PCI Express the OP's of a
treaty this expressed GOP's from our

298
00:17:22,980 --> 00:17:24,170
members basic answer

299
00:17:24,170 --> 00:17:27,170
do whatever packets we want rather than
at having he is

300
00:17:27,170 --> 00:17:31,610
I can API that builds the packets for a
second is

301
00:17:31,610 --> 00:17:36,280
specify everything which is kinda nice
so Thunderbolt

302
00:17:36,280 --> 00:17:40,470
I talking thunderbolt from that from the
FPGA I am

303
00:17:40,470 --> 00:17:44,160
I is this our this B-plus THF I bought
which is

304
00:17:44,160 --> 00:17:47,620
has since been like scrubbed from their
website every

305
00:17:47,620 --> 00:17:51,030
single reference to this board has been
removed as far as I can

306
00:17:51,030 --> 00:17:56,090
say except that image which I saw from
the bus outside on sofa like when I

307
00:17:56,090 --> 00:17:59,470
when I when I got this board about

308
00:17:59,470 --> 00:18:03,520
I think maybe three or four weeks later
why they represented the mailman elect

309
00:18:03,520 --> 00:18:06,650
so recalling all the Thr fibroids

310
00:18:06,650 --> 00:18:09,830
so he can send it back to be great we'll
give you a full refund Pablo

311
00:18:09,830 --> 00:18:13,800
the postage cool as I can and I

312
00:18:13,800 --> 00:18:17,080
economy this board tom and i really
wanna go on by like I

313
00:18:17,080 --> 00:18:20,880
hundred-dollar mag buying clothes x8 you
know dicking around doesn't have any

314
00:18:20,880 --> 00:18:21,309
money

315
00:18:21,309 --> 00:18:25,809
arm so satellite what's what's actually
the problem with that

316
00:18:25,809 --> 00:18:29,330
and then like now week you know what are
the what go into it but you know should

317
00:18:29,330 --> 00:18:30,309
definitely send it back

318
00:18:30,309 --> 00:18:33,770
will arm you know we'll give you like
you know a couple hundred dollars credit

319
00:18:33,770 --> 00:18:36,980
I'm on a Web Store as well as your money
back and

320
00:18:36,980 --> 00:18:40,710
postage Mike right night

321
00:18:40,710 --> 00:18:43,720
I will give you will be 500 bucks credit

322
00:18:43,720 --> 00:18:47,050
miles other stuff I web so I will pay
the postage and give you my tackling

323
00:18:47,050 --> 00:18:52,150
here was the carrot on your emails now
sire I asked a friend my denzel

324
00:18:52,150 --> 00:18:58,060
arm it hurts companies like tonight

325
00:18:58,060 --> 00:19:03,220
man so I i'm I assume that you know
someone told them to stop talking making

326
00:19:03,220 --> 00:19:04,210
on about stuff without

327
00:19:04,210 --> 00:19:09,480
you know licensing that tech or
something like that on but yet that

328
00:19:09,480 --> 00:19:10,260
there's actually a

329
00:19:10,260 --> 00:19:13,540
20th others on the lawn closures on the
market now say I mean actually closes

330
00:19:13,540 --> 00:19:13,850
with

331
00:19:13,850 --> 00:19:16,910
you know if you can put at the Arcadian
and talked on the ball

332
00:19:16,910 --> 00:19:22,020
to it PCI Express card I

333
00:19:22,020 --> 00:19:25,450
so scan what our here said it looks like
we've got

334
00:19:25,450 --> 00:19:29,220
at Saugus that Connectify thunderbolts
3805 board

335
00:19:29,220 --> 00:19:32,510
I which is connected by this expressed
to the Xilinx

336
00:19:32,510 --> 00:19:36,180
3605 board which is just a FPGA
development board that we

337
00:19:36,180 --> 00:19:39,990
we bought from Avnet whatever 500 bucks

338
00:19:39,990 --> 00:19:44,600
I and then you know on that FPGA we've
got implemented

339
00:19:44,600 --> 00:19:48,210
Annex IV sex press corps and micro blaze

340
00:19:48,210 --> 00:19:51,430
process a so the the

341
00:19:51,430 --> 00:19:54,480
PCI Express like transceivers actually
implemented in in

342
00:19:54,480 --> 00:19:57,500
like hardware in in a in silicon on the
FPGA

343
00:19:57,500 --> 00:20:00,640
because the FPGA louise is too slow to

344
00:20:00,640 --> 00:20:04,010
talk likes you know full-speed PCI
Express

345
00:20:04,010 --> 00:20:08,780
and you know stuff like that and
overseer connection to add

346
00:20:08,780 --> 00:20:12,720
back to her sister to do debugging and
and then tell what to do

347
00:20:12,720 --> 00:20:15,960
not ass is kinda what our

348
00:20:15,960 --> 00:20:19,070
in the lab looks like now we've got the
two to us connected together

349
00:20:19,070 --> 00:20:23,270
on the block action which effectively
extends the PCI Express bus

350
00:20:23,270 --> 00:20:26,850
out the Thunderbolt port and I'm back in
the Thunderbolt port about you know bad

351
00:20:26,850 --> 00:20:27,990
I nelson sizet

352
00:20:27,990 --> 00:20:31,720
so now I've PJ can just do IDMA

353
00:20:31,720 --> 00:20:34,800
operations directly on the PCI Express
bus which is

354
00:20:34,800 --> 00:20:41,800
great that was l'école you know it from
the beginning okay

355
00:20:43,320 --> 00:20:46,820
so we going at this happy chair the
talks PCI Express service on the vault

356
00:20:46,820 --> 00:20:47,250
so

357
00:20:47,250 --> 00:20:50,800
what we do with it well the first days

358
00:20:50,800 --> 00:20:55,060
without testing stuff was the right
driver on come driver for Mac OS that

359
00:20:55,060 --> 00:20:58,600
on is loaded on the you know on our

360
00:20:58,600 --> 00:21:01,620
at Target you know just for testing
purposes

361
00:21:01,620 --> 00:21:05,220
and it like you know does config reads
and writes and our

362
00:21:05,220 --> 00:21:09,050
the makes the FPGA device postmaster and
tells what to do

363
00:21:09,050 --> 00:21:12,760
you know so it's set up our at this
stage with national marketplaces

364
00:21:12,760 --> 00:21:16,550
like this awful state machine that we
could tell what to do by writing some

365
00:21:16,550 --> 00:21:17,230
stuff to some

366
00:21:17,230 --> 00:21:21,120
some registers on the device so the next
day's

367
00:21:21,120 --> 00:21:24,740
on was actually to imitate other device

368
00:21:24,740 --> 00:21:27,780
so I rather than

369
00:21:27,780 --> 00:21:31,320
you know he is out driver which is
cheating and where is not gonna be able

370
00:21:31,320 --> 00:21:32,180
to use a real

371
00:21:32,180 --> 00:21:36,470
in a real-world attacks entire we need
to make our STJ

372
00:21:36,470 --> 00:21:40,710
PCI Express device imitated device the
system knows about

373
00:21:40,710 --> 00:21:43,860
Amilo driver for outfits and MA buffers

374
00:21:43,860 --> 00:21:47,750
services past master configure you know
whatever you know access control

375
00:21:47,750 --> 00:21:51,150
stuff ACS the law PCI Express bus

376
00:21:51,150 --> 00:21:54,580
on so take a little

377
00:21:54,580 --> 00:21:58,520
I tangent back to two effete PCI Express
here

378
00:21:58,520 --> 00:22:02,470
so so you guys might know the stuff from
like

379
00:22:02,470 --> 00:22:05,850
inner try a graphics card so were
complex and shit like that

380
00:22:05,850 --> 00:22:09,970
context base is basically just his
blockers on

381
00:22:09,970 --> 00:22:13,020
talk daughter presented by the PCI
Express device and

382
00:22:13,020 --> 00:22:16,100
his memory mapped into town space I

383
00:22:16,100 --> 00:22:19,710
which contains a bunch of properties for
the device like there's a vendor id:

384
00:22:19,710 --> 00:22:22,780
device id: there's like base addresses
all

385
00:22:22,780 --> 00:22:25,820
I am like registers there are mapped

386
00:22:25,820 --> 00:22:29,370
from the device so you know if for
example asada controller

387
00:22:29,370 --> 00:22:32,470
to be a set of registers arm ok you know

388
00:22:32,470 --> 00:22:36,940
for communicating with talks on a
whatever the capabilities and buncha

389
00:22:36,940 --> 00:22:38,820
flags like bus master and shit like that

390
00:22:38,820 --> 00:22:42,830
I am so

391
00:22:42,830 --> 00:22:46,059
I'm honey actually explain a bus master
main sponsors like

392
00:22:46,059 --> 00:22:49,670
a legacy thing sort of from BC I where

393
00:22:49,670 --> 00:22:53,300
you know you had so busy I and this
express our are kinda different

394
00:22:53,300 --> 00:22:57,659
but they're PCI Express was designed to
look kinda the same

395
00:22:57,659 --> 00:23:00,240
I whereas that like that their
architectures actually quite different

396
00:23:00,240 --> 00:23:00,830
so

397
00:23:00,830 --> 00:23:04,710
in PCI you had to have he had to tell a
device hey you're you're the boss now

398
00:23:04,710 --> 00:23:06,140
you're the other bus master

399
00:23:06,140 --> 00:23:10,690
and you can I you know gone do reason
rights to memory all you want and then

400
00:23:10,690 --> 00:23:11,580
when you done

401
00:23:11,580 --> 00:23:15,400
will like switch someone else osmosis so
they can be a ship but this Express

402
00:23:15,400 --> 00:23:18,679
doesn't really require that but the flag
is still there because they want the

403
00:23:18,679 --> 00:23:20,350
pasta look kinda the same

404
00:23:20,350 --> 00:23:25,630
yes so common space that's

405
00:23:25,630 --> 00:23:30,549
you know somewhat like this I we've got
like in some other important things like

406
00:23:30,549 --> 00:23:32,500
the device ID and righty then

407
00:23:32,500 --> 00:23:36,039
Costco Division I day ice planet

408
00:23:36,039 --> 00:23:40,620
a little bit about what this is for a
sec passing the subsystem ID and subs

409
00:23:40,620 --> 00:23:41,500
and then write a

410
00:23:41,500 --> 00:23:45,870
at the base address registers for you
know the registers

411
00:23:45,870 --> 00:23:50,549
within the device that we wanna talk to
extension on base address which is kinda

412
00:23:50,549 --> 00:23:51,409
far as well like you

413
00:23:51,409 --> 00:23:55,490
if a device is an expansion ROM are you
can seek a driver in there that the

414
00:23:55,490 --> 00:23:59,370
somewhere below the possible only when
the on devices connected a bit I'm

415
00:23:59,370 --> 00:24:02,950
so for example if you have a saw to
control a that you wanna

416
00:24:02,950 --> 00:24:06,039
route from a disk that's connected to it
on

417
00:24:06,039 --> 00:24:09,929
the bile says I know how to talk to the
south controller right because

418
00:24:09,929 --> 00:24:12,960
the boss is gonna be able to free the
operating system of this that's

419
00:24:12,960 --> 00:24:15,220
connected to it so you can provide

420
00:24:15,220 --> 00:24:18,730
arm driving expansion on the can tell by
us how to

421
00:24:18,730 --> 00:24:22,590
talk to it I'm sides and some fun stuff
that

422
00:24:22,590 --> 00:24:25,779
a couple years ago I am whereby Road at

423
00:24:25,779 --> 00:24:29,630
an AFI I driver doesn't actually help
ease of the hardware

424
00:24:29,630 --> 00:24:32,929
by just like index up in the account
when that when the system boots

425
00:24:32,929 --> 00:24:38,340
say can actually do something pretty fun
nasty stuff that on

426
00:24:38,340 --> 00:24:42,080
yeah nigga so I ok it I

427
00:24:42,080 --> 00:24:45,779
jumpy relentlessly riot it is a on Mac
OS

428
00:24:45,779 --> 00:24:49,860
is like the the jungle the Connell &
Poor's framework stuff that handles

429
00:24:49,860 --> 00:24:51,830
device driver loading

430
00:24:51,830 --> 00:24:57,260
up for the majority is drivers soul and
clarence E

431
00:24:57,260 --> 00:25:01,250
boss boss and is harmful to reverse
engineer because it was passed

432
00:25:01,250 --> 00:25:06,170
basically like it does list this driver
matching stuff Sony devices connected

433
00:25:06,170 --> 00:25:09,620
on PCI Express bus and I ok it like
looks at the comdex pace

434
00:25:09,620 --> 00:25:13,740
and goes okay well but there's been a
ride a

435
00:25:13,740 --> 00:25:17,450
for this device id: arm ideal for driver

436
00:25:17,450 --> 00:25:20,630
that that understands how to talk to
this then right into my side a

437
00:25:20,630 --> 00:25:24,300
goes through all the to either in for a
pee list files

438
00:25:24,300 --> 00:25:28,750
in all the Mac OS drivers the other in
exist in the system

439
00:25:28,750 --> 00:25:32,320
tries to find one that matches so they
can also match

440
00:25:32,320 --> 00:25:35,800
on like the Costco Division I day sir
you might have like

441
00:25:35,800 --> 00:25:39,320
a standard you know standard protocol
more standard

442
00:25:39,320 --> 00:25:43,210
architecture your you can talk to like
sada you know that they might be like

443
00:25:43,210 --> 00:25:43,690
your

444
00:25:43,690 --> 00:25:47,660
a standard for talking is otherwise is
in the kernel whatever sir

445
00:25:47,660 --> 00:25:50,880
you know you can say well I'm this kinda
solid advice for this revision and

446
00:25:50,880 --> 00:25:53,490
driver they can talk to that guy device
will know how to talk to me

447
00:25:53,490 --> 00:25:56,680
I sir

448
00:25:56,680 --> 00:26:01,020
got the invite the Les Paul and their in
the the bus driver that you know has

449
00:26:01,020 --> 00:26:04,020
some stuff corresponds to the device ID
and already there

450
00:26:04,020 --> 00:26:07,160
are so the the device that where

451
00:26:07,160 --> 00:26:11,550
imitating on is the Apple sexe slot
which has

452
00:26:11,550 --> 00:26:15,490
this name which is generated from that
been writing product id:

453
00:26:15,490 --> 00:26:20,190
and also has this flag

454
00:26:20,190 --> 00:26:23,560
I a PCI time a compatible which
basically tells

455
00:26:23,560 --> 00:26:27,650
I a kit that it's allowed Soward still
lost rather if the device is connected

456
00:26:27,650 --> 00:26:32,810
Thunderball or you know tunnels PCI
Express so we had to find one other

457
00:26:32,810 --> 00:26:36,910
wanna drive I want the drivers allow
this I a PC out on a compatible flag

458
00:26:36,910 --> 00:26:38,149
arm

459
00:26:38,149 --> 00:26:41,230
and had an easy name forced a match like
just bide by

460
00:26:41,230 --> 00:26:45,070
been right in Product ID and nothing
complicated I am

461
00:26:45,070 --> 00:26:48,769
say a birth concept that we dealt

462
00:26:48,769 --> 00:26:52,590
around this was basically you know the
sense that things will not lie or

463
00:26:52,590 --> 00:26:53,299
inception

464
00:26:53,299 --> 00:26:56,299
where I you know we find the

465
00:26:56,299 --> 00:26:59,149
the car that does the authentication the
logon screen door for the you know

466
00:26:59,149 --> 00:26:59,869
screen lock

467
00:26:59,869 --> 00:27:03,820
one I by doings and

468
00:27:03,820 --> 00:27:07,350
DNA rates and then we do it am i right
parking MWR tope

469
00:27:07,350 --> 00:27:11,159
art overwrite the card with something
that makes it not do what it would

470
00:27:11,159 --> 00:27:11,809
normally do

471
00:27:11,809 --> 00:27:16,340
I always like say yes you can of that
you're gonna get successfully

472
00:27:16,340 --> 00:27:20,230
and then we win assets car there

473
00:27:20,230 --> 00:27:24,639
it's basically just like you to call the
authentication function and then like

474
00:27:24,639 --> 00:27:28,700
North result the authentication
functions a X in return

475
00:27:28,700 --> 00:27:32,330
so this is a ride with like move one
into

476
00:27:32,330 --> 00:27:35,409
IX and then return 1 all the time

477
00:27:35,409 --> 00:27:38,610
so this is what our

478
00:27:38,610 --> 00:27:42,309
I a hobbit looks like we've got

479
00:27:42,309 --> 00:27:45,350
this SB 605 FPGA development board

480
00:27:45,350 --> 00:27:50,480
with the SPJ on that fancy looking BJ
attack is that

481
00:27:50,480 --> 00:27:54,549
and because like

482
00:27:54,549 --> 00:27:58,090
I pretty much all these the FPGA

483
00:27:58,090 --> 00:28:01,820
boards at the CIA expressed support arm
Dec I resigned to people who are

484
00:28:01,820 --> 00:28:04,549
building like Ethernet new Ethernet
hardware that's the stuff we networking

485
00:28:04,549 --> 00:28:05,039
hardware

486
00:28:05,039 --> 00:28:08,570
they have like all the other features he
could possibly ever has on a fucking

487
00:28:08,570 --> 00:28:10,159
development boards a huge

488
00:28:10,159 --> 00:28:13,559
and usually quite expensive this one by
the cheapest ones around

489
00:28:13,559 --> 00:28:16,889
I the agencies like compact flash in

490
00:28:16,889 --> 00:28:20,119
as a the slot and fuckin DVI

491
00:28:20,119 --> 00:28:24,940
Gigabit Ethernet like everything
everything else level as well

492
00:28:24,940 --> 00:28:29,020
I then we've got our th or five
Thunderbolt PCI Express port connected

493
00:28:29,020 --> 00:28:30,309
to the PC I a singer

494
00:28:30,309 --> 00:28:34,159
in the middle that and

495
00:28:34,159 --> 00:28:37,250
sun block connector there which is
connected off to the to the

496
00:28:37,250 --> 00:28:40,299
victim so this is what

497
00:28:40,299 --> 00:28:43,549
a the whole rate looks like we've got
our

498
00:28:43,549 --> 00:28:47,429
J tag in the you are connected to the to
the to the board that's just that's a

499
00:28:47,429 --> 00:28:48,510
debugging and Mike

500
00:28:48,510 --> 00:28:52,010
tie what to do we also implemented
sayings like press one other

501
00:28:52,010 --> 00:28:55,690
one of the buttons on the FPGA board
models do it doesn't need any

502
00:28:55,690 --> 00:29:00,000
interaction with our attack hosts and
with the Thunder well connected to the

503
00:29:00,000 --> 00:29:00,640
victim

504
00:29:00,640 --> 00:29:05,529
and Harry stop actor in the world there
is actually doing it ac

505
00:29:05,529 --> 00:29:10,140
as is back I and does that sort of thing
so in case I didn't make sense

506
00:29:10,140 --> 00:29:14,049
lockouts can explain it way maybe

507
00:29:14,049 --> 00:29:21,049
way no sound this is not good

508
00:29:28,179 --> 00:29:29,370
there was only started

509
00:29:29,370 --> 00:29:32,539
not okay

510
00:29:32,539 --> 00:29:36,740
well I hope you answer because got to
explain it to you now

511
00:29:36,740 --> 00:29:40,080
others access

512
00:29:40,080 --> 00:29:43,659
signatures sickens men with

513
00:29:43,659 --> 00:29:46,730
I keep

514
00:29:46,730 --> 00:29:50,010
mister pic dish

515
00:29:50,010 --> 00:29:53,700
the reposition the traditionally marked
absent

516
00:29:53,700 --> 00:29:56,760
be get dressed up for the wedding

517
00:29:56,760 --> 00:30:00,610
passing the downey's up the competition

518
00:30:00,610 --> 00:30:03,880
is at Compugen 137 into

519
00:30:03,880 --> 00:30:07,380
mister well almost

520
00:30:07,380 --> 00:30:10,160
to lose

521
00:30:10,160 --> 00:30:13,620
side that made no sense in my splash in
is

522
00:30:13,620 --> 00:30:16,820
much better explain that shit that I am
so um yet

523
00:30:16,820 --> 00:30:19,950
so I made a video of the actual attack
as well because like

524
00:30:19,950 --> 00:30:24,150
didn't bring all the popular around the
world sir so

525
00:30:24,150 --> 00:30:27,610
players are there's United typing
personal space into the

526
00:30:27,610 --> 00:30:30,870
to the talking machine that showing that
its

527
00:30:30,870 --> 00:30:34,580
you knockin authenticate with the
password the passwords not space I'll

528
00:30:34,580 --> 00:30:35,390
check the

529
00:30:35,390 --> 00:30:40,560
FPJ believe I thought about their as a
serial console talking to the FPGA board

530
00:30:40,560 --> 00:30:45,260
be a unlock please searching through
memory

531
00:30:45,260 --> 00:30:49,130
looking for the that a car that does the
authentication retain fines

532
00:30:49,130 --> 00:30:53,470
code Island patches that and because as
a good memory in that machine

533
00:30:53,470 --> 00:30:56,830
gonna let it sit there and keep going
and to it it's the end memory

534
00:30:56,830 --> 00:31:00,430
just in case there's multiple instances
that code that need to be patched

535
00:31:00,430 --> 00:31:04,050
which is happens all the time so much
alive never into it but

536
00:31:04,050 --> 00:31:07,450
yeah now space and concerns are marked

537
00:31:07,450 --> 00:31:13,410
be and the others looking

538
00:31:13,410 --> 00:31:17,890
pretty frighten the way I'm opposition
so yeah

539
00:31:17,890 --> 00:31:21,090
so until

540
00:31:21,090 --> 00:31:24,570
you know if figure this will probably
wasn't a good idea right I am

541
00:31:24,570 --> 00:31:27,590
which kinda makes sense you know if you
like security and stuff

542
00:31:27,590 --> 00:31:30,740
so the options best let you know Louis
potshot

543
00:31:30,740 --> 00:31:34,220
I am probably not the best option Lucas

544
00:31:34,220 --> 00:31:37,910
and I or you know put an access controls

545
00:31:37,910 --> 00:31:41,660
on device I R through this express which
is what I decided to do

546
00:31:41,660 --> 00:31:45,590
so they built this thing call the today
install a new chips

547
00:31:45,590 --> 00:31:49,690
I so they slates you notice access
control

548
00:31:49,690 --> 00:31:52,890
in the the PCH that

549
00:31:52,890 --> 00:31:56,030
you know if when PCI Express you know

550
00:31:56,030 --> 00:31:59,400
DNA reads and writes it the that the PCH

551
00:31:59,400 --> 00:32:02,680
because I game on a base on access
control so the tables

552
00:32:02,680 --> 00:32:06,070
to a more complicated than that but
that's the basic just a bit

553
00:32:06,070 --> 00:32:09,140
so it's actually was designed for for
virtualizing I R

554
00:32:09,140 --> 00:32:11,779
which is conical arm

555
00:32:11,779 --> 00:32:16,190
SAR basically United family with VMware
on the tab the indirect path works on

556
00:32:16,190 --> 00:32:17,240
ESXi whatever

557
00:32:17,240 --> 00:32:20,639
you can take advice and just like map it
right through to

558
00:32:20,639 --> 00:32:24,559
a.m. to a guest so DNA requests and
interrupts

559
00:32:24,559 --> 00:32:28,299
get remapped the same sort of way that
you you know APT works for

560
00:32:28,299 --> 00:32:31,649
shadow page tables SAR

561
00:32:31,649 --> 00:32:35,779
the VT the city unit which is actually
in the

562
00:32:35,779 --> 00:32:39,200
in the PCH their has like this concept
of domains

563
00:32:39,200 --> 00:32:43,370
where's you know you can a domain
generally represents

564
00:32:43,370 --> 00:32:47,279
a virtualization guests says least one
demand which is the host

565
00:32:47,279 --> 00:32:51,379
you know the host OS is to mail the
immense demand on and for each guest

566
00:32:51,379 --> 00:32:55,230
to it she wants a rematch advice our in
a possible advice you have

567
00:32:55,230 --> 00:32:59,730
another domain setup and then assign a
device to it

568
00:32:59,730 --> 00:33:04,690
in the remapping tales on

569
00:33:04,690 --> 00:33:09,649
so delisting colonel configures the city
for you this country has won the main

570
00:33:09,649 --> 00:33:13,190
so you know there's no support for the
indirect path style passed through this

571
00:33:13,190 --> 00:33:15,110
just this house demand set up and that's
all

572
00:33:15,110 --> 00:33:18,429
arms as I the DIAC I family

573
00:33:18,429 --> 00:33:21,450
device driver when it is loaded I

574
00:33:21,450 --> 00:33:25,230
integrates this demand and signs all the
devices to it

575
00:33:25,230 --> 00:33:30,809
and that's it so now when when I Rd Masr
when drawing kernel drivers allocate DMA

576
00:33:30,809 --> 00:33:31,440
buffers

577
00:33:31,440 --> 00:33:35,700
the al Qaeda arm goes in talks that the
city and it goes like a

578
00:33:35,700 --> 00:33:39,129
on al Qaeda's some DNA buffer to talk to
this device

579
00:33:39,129 --> 00:33:43,659
don't let anyone except this device
right read or write to this day and I've

580
00:33:43,659 --> 00:33:47,830
I can actually be more granular neck it
can say only let this device read from

581
00:33:47,830 --> 00:33:49,620
this damn about because it's a one-way

582
00:33:49,620 --> 00:33:53,100
you know da to transfer from the kernel
to the advice

583
00:33:53,100 --> 00:33:56,759
work it the other way it's your the
devices are never gonna write systemic

584
00:33:56,759 --> 00:33:57,120
for

585
00:33:57,120 --> 00:34:01,990
we actually have to be but so the
visiting it now knows about all the

586
00:34:01,990 --> 00:34:02,690
regions

587
00:34:02,690 --> 00:34:07,139
that vices need to read and write from
and set up this %ah context able

588
00:34:07,139 --> 00:34:10,579
I'm all for the you know that the the

589
00:34:10,579 --> 00:34:12,740
ACLs basically

590
00:34:12,740 --> 00:34:16,270
so that if you do not access yet this
sort of thing on our centenary

591
00:34:16,270 --> 00:34:17,230
console.log

592
00:34:17,230 --> 00:34:20,320
on which we saw heaps and heaps of on
your

593
00:34:20,320 --> 00:34:27,320
doing this development are so

594
00:34:30,030 --> 00:34:33,820
the city has been implemented I in
Ivybridge so I division has all

595
00:34:33,820 --> 00:34:37,430
and and forward has a stake in it I

596
00:34:37,430 --> 00:34:41,360
does require the US to configure apps
are as I say Mac West and exit

597
00:34:41,360 --> 00:34:44,500
since template went to SAR

598
00:34:44,500 --> 00:34:48,909
I windows before Windows 8 I think it's

599
00:34:48,910 --> 00:34:52,140
on the eight and forward actually can
things be today so windows 7

600
00:34:52,140 --> 00:34:55,150
if you're running Windows 7 in I'll

601
00:34:55,150 --> 00:34:59,740
you know on boot camp on here mac book
pro ever I'm you Donald this attack

602
00:34:59,740 --> 00:35:02,930
few running all those in the operating
system arstan

603
00:35:02,930 --> 00:35:06,740
on him on a Mac laptop you reliable to
this attack on Linux

604
00:35:06,740 --> 00:35:10,750
also configures the city and he just or
always set up at the Mann per device

605
00:35:10,750 --> 00:35:13,790
I'm assuming because it you know sets up

606
00:35:13,790 --> 00:35:17,180
things for KBM to be to be a

607
00:35:17,180 --> 00:35:20,910
your able to pass through devices or
maybe in future Mitchell

608
00:35:20,910 --> 00:35:24,650
with the Cajuns or something up I am
sorely lacking

609
00:35:24,650 --> 00:35:28,240
that's basically what I just said in a
pre Ivy Bridge machine you're always on

610
00:35:28,240 --> 00:35:31,550
because it doesn't have a TA comets and
I vigil at a machine

611
00:35:31,550 --> 00:35:34,650
and you're running lesson tied to your

612
00:35:34,650 --> 00:35:38,210
earned during kono s icon machine you
probably not I'm

613
00:35:38,210 --> 00:35:41,880
I said I mean there are some you know
some

614
00:35:41,880 --> 00:35:45,040
gushes without like this that's funny
stuff you can read and write a

615
00:35:45,040 --> 00:35:48,660
thunderbolt depending on which device
you pretend to be

616
00:35:48,660 --> 00:35:53,290
on system Johnson them either allocated
MA buffers and stuff that's just

617
00:35:53,290 --> 00:35:57,230
you know has access controls allies are
in right so if you are a taxi driver or

618
00:35:57,230 --> 00:35:57,940
something

619
00:35:57,940 --> 00:36:01,670
you can you reading right to those
bosses and you know something bad might

620
00:36:01,670 --> 00:36:03,480
happen

621
00:36:03,480 --> 00:36:06,400
I has plenty of other you know

622
00:36:06,400 --> 00:36:09,660
a attack surface I guess this this kinda
thing even

623
00:36:09,660 --> 00:36:13,410
even I given BT like you know

624
00:36:13,410 --> 00:36:17,970
actually emulating a device you know to
a certain extent

625
00:36:17,970 --> 00:36:21,780
and then starting to misbehaves when

626
00:36:21,780 --> 00:36:26,320
you know to it to you you know sense and
malicious dollar down some certain card

627
00:36:26,320 --> 00:36:27,150
part in the driver

628
00:36:27,150 --> 00:36:30,390
and see what happens so

629
00:36:30,390 --> 00:36:33,500
thats that's pretty much the just that I
guess

630
00:36:33,500 --> 00:36:38,230
the next next steps for this research
summer which was a startup issue

631
00:36:38,230 --> 00:36:41,890
i little bit but make it small is is
probably good

632
00:36:41,890 --> 00:36:45,470
11 good thing like a jerk it's to this
thing called slots triana

633
00:36:45,470 --> 00:36:48,930
which is kinda similar to what we've
done with talks a lot

634
00:36:48,930 --> 00:36:52,020
a with him over the last six months a
ser

635
00:36:52,020 --> 00:36:56,520
so he's using a USB say 380 chip which
is a USB 32

636
00:36:56,520 --> 00:37:00,560
PCI Express chip and you can from the
USB 3 side tell it to do

637
00:37:00,560 --> 00:37:05,630
DMA on the %uh PCI Express bus I other
limitation

638
00:37:05,630 --> 00:37:08,940
with that is that it's 32-bit PCI
Express

639
00:37:08,940 --> 00:37:12,970
still only four gigs is memory access
with it bus P Collins

640
00:37:12,970 --> 00:37:17,010
that's fuckin time sir so much better in
our God I am

641
00:37:17,010 --> 00:37:21,180
so you're bypassing the city is a
definitely desirable because that's the

642
00:37:21,180 --> 00:37:21,550
big

643
00:37:21,550 --> 00:37:24,630
stumbling block in be able to do damage
attacks

644
00:37:24,630 --> 00:37:28,070
so yeah we made some some inroads into
that let's play with

645
00:37:28,070 --> 00:37:31,090
attack surface to to mess around with
eighty

646
00:37:31,090 --> 00:37:34,890
I maybe see the new without imitating a
device

647
00:37:34,890 --> 00:37:38,810
has a few different your different ways
in look at doing that I actually

648
00:37:38,810 --> 00:37:40,100
implementing former capture

649
00:37:40,100 --> 00:37:43,970
to make this a forensics tool would be
kinda good at the moment it's it

650
00:37:43,970 --> 00:37:46,280
basically is just a one-trick pony list
on hack

651
00:37:46,280 --> 00:37:50,760
but the development where we have I you
know has a a Gigabit Ethernet interface

652
00:37:50,760 --> 00:37:52,370
and some other stuff so he basically

653
00:37:52,370 --> 00:37:56,500
you know implement the that PCI Express

654
00:37:56,500 --> 00:37:59,750
is an echo of on the FPGA as well and
stream daughter out the

655
00:37:59,750 --> 00:38:03,180
the Ethernet interface I

656
00:38:03,180 --> 00:38:07,060
actually injecting payloads into the
condo using or into processes

657
00:38:07,060 --> 00:38:11,530
is endemic sites like that a little bit

658
00:38:11,530 --> 00:38:16,050
that's absolutely basic Perth concept
stuff to be able to

659
00:38:16,050 --> 00:38:20,310
you know find the you know the al Qaeda

660
00:38:20,310 --> 00:38:24,100
dot structures in the Catalans inner
kinda allocate some pages and

661
00:38:24,100 --> 00:38:27,270
Anna write down every to them and then
patched kernel somewhere

662
00:38:27,270 --> 00:38:30,370
jump into our payload cutting

663
00:38:30,370 --> 00:38:33,420
on as I said before like driver
exploiting

664
00:38:33,420 --> 00:38:37,200
I wanna do is drive is also you're
finding bonneville car parts within

665
00:38:37,200 --> 00:38:41,050
drivers various PCI Express devices and
that reno's by

666
00:38:41,050 --> 00:38:44,190
in by emulating some of the protocol
device talks

667
00:38:44,190 --> 00:38:49,490
cut breeze through all that really
quickly

668
00:38:49,490 --> 00:38:53,470
on Saturday time left but that's that's
a that some some references there

669
00:38:53,470 --> 00:38:56,520
you I have a local give the slides that
occur

670
00:38:56,520 --> 00:39:00,010
to on the web site to another so at
those things

671
00:39:00,010 --> 00:39:05,240
and I'm any questions jar

672
00:39:05,240 --> 00:39:12,240
I this is a sigh

673
00:39:13,190 --> 00:39:16,510
your question so you might like it it's
probably really dumb 12

674
00:39:16,510 --> 00:39:20,800
so inured subject to the memory with
your Stan hack to try to find

675
00:39:20,800 --> 00:39:25,069
you know some address to patch for that
log in what it what exactly looking

676
00:39:25,069 --> 00:39:29,240
for their its kinda it's pretty cheap
the way that it works at the moment like

677
00:39:29,240 --> 00:39:29,490
a

678
00:39:29,420 --> 00:39:32,520
I we saw we saw a starter to implement
it a little bit cleaner

679
00:39:32,520 --> 00:39:36,140
and some supporting all the Asians like
with with signature he suffered at the

680
00:39:36,140 --> 00:39:37,410
moment is basically like

681
00:39:37,410 --> 00:39:40,760
I we know what the target OS version is

682
00:39:40,760 --> 00:39:43,890
so we're looking just for a chunk
occurred that

683
00:39:43,890 --> 00:39:47,700
is big enough to unico once march to the
time probably

684
00:39:47,700 --> 00:39:51,430
so it's because more than once it where
we just patching anyway and hoping that

685
00:39:51,430 --> 00:39:53,240
it's not something important are

686
00:39:53,240 --> 00:39:56,500
its usually occurs once a couple times
occurred twice

687
00:39:56,500 --> 00:40:00,810
like the I hope that's just another copy
of the another copy %uh the code

688
00:40:00,810 --> 00:40:05,190
it were actually looking at on a
specific offset within each page

689
00:40:05,190 --> 00:40:08,810
for that cut that out so it's I mean we
know it's always

690
00:40:08,810 --> 00:40:11,849
I mean we got this is a a space

691
00:40:11,849 --> 00:40:15,690
layout randomization it's gonna be at
the same offset within the page to be on

692
00:40:15,690 --> 00:40:16,530
a different page

693
00:40:16,530 --> 00:40:21,490
on this is random ice are you know that
basis looking for I think it's like

694
00:40:21,490 --> 00:40:24,530
maybe are 20 bytes or something

695
00:40:24,530 --> 00:40:29,170
actually knows the snackers these the at
nine bytes it was like

696
00:40:29,170 --> 00:40:33,720
we had to do to to to different like two
separate

697
00:40:33,720 --> 00:40:37,030
co-pays you know for eight bytes and
into the next one

698
00:40:37,030 --> 00:40:40,750
your yep next

699
00:40:40,750 --> 00:40:43,220
hours

700
00:40:43,220 --> 00:40:47,670
nice hi

701
00:40:47,670 --> 00:40:50,760
I mister the first part of your
presentations are you so with my

702
00:40:50,760 --> 00:40:51,740
question was

703
00:40:51,740 --> 00:40:55,070
already in it what least reply sorry
from

704
00:40:55,070 --> 00:40:59,570
within firewire remember to especially
on my on Apple Mac it was something like

705
00:40:59,570 --> 00:41:00,940
a locking mechanism

706
00:41:00,940 --> 00:41:04,190
that demais was only available if the
user was logged on

707
00:41:04,190 --> 00:41:07,890
um is there a certain situation with

708
00:41:07,890 --> 00:41:11,230
the with with this technique you know
also possible

709
00:41:11,230 --> 00:41:14,690
show so I mention that relates the
Thunderball

710
00:41:14,690 --> 00:41:18,590
to the file I think early at its like
there's some code in the eye of I'll add

711
00:41:18,590 --> 00:41:22,030
family driver that when Fall Ball is
enabled

712
00:41:22,030 --> 00:41:26,120
and screen is locked it disables our
tails off i watch upset to disable them

713
00:41:26,120 --> 00:41:27,890
and not to the Americas anymore

714
00:41:27,890 --> 00:41:31,560
on their could potentially be

715
00:41:31,560 --> 00:41:35,400
you know away implement that they would
have to be done in Thunderball control

716
00:41:35,400 --> 00:41:39,030
which I as far as I'm aware there is a
mechanism to doing that in hardware

717
00:41:39,030 --> 00:41:42,790
like there's not actually a feature that
I'm aware of in the middle controller

718
00:41:42,790 --> 00:41:46,690
are to do that I and when I say I'm not
aware of

719
00:41:46,690 --> 00:41:49,700
on it's nearly impossible to get
documentation

720
00:41:49,700 --> 00:41:53,270
dodges suffer those chips because
fucking Intel and their

721
00:41:53,270 --> 00:41:57,840
I have I haz them very nicely if I could
you know join the developer program and

722
00:41:57,840 --> 00:41:58,890
I like crickets

723
00:41:58,890 --> 00:42:02,400
and I'm like okay and I asked him again

724
00:42:02,400 --> 00:42:05,700
and they sent me a an email three weeks
later saying yes a little

725
00:42:05,700 --> 00:42:10,120
contact you in the next 2-3 months like
okay base the less you like talkin

726
00:42:10,120 --> 00:42:12,980
of you know someone like that is gonna
sell million units is something that

727
00:42:12,980 --> 00:42:13,860
will give you anything

728
00:42:13,860 --> 00:42:17,080
answer I mean it's gonna take

729
00:42:17,080 --> 00:42:20,400
I you know guys like like Jersey to
actually reverse engineer

730
00:42:20,400 --> 00:42:24,420
the chip and figure out what the fuck is
going on there on program with a little

731
00:42:24,420 --> 00:42:25,240
different software

732
00:42:25,240 --> 00:42:29,410
I by yet I A that's the name is Max
controls and that I'm aware of

733
00:42:29,410 --> 00:42:34,820
but year

734
00:42:34,820 --> 00:42:35,600
anybody else

735
00:42:35,600 --> 00:42:42,600
please

736
00:42:43,040 --> 00:42:50,040
around a bit early so ask questions took

737
00:42:50,300 --> 00:42:51,160
all right thank you very much

738
00:42:51,160 --> 00:42:51,410
guys

