1
00:00:00,830 --> 00:00:07,660
hi everyone so it's really great to be a
book on our talk to these about the

2
00:00:07,660 --> 00:00:12,900
research we've been doing into DNS from
both sides below the recursive been

3
00:00:12,900 --> 00:00:17,980
above the recursive and how we developed
a unified view of the units traffic to

4
00:00:17,980 --> 00:00:23,699
track Internet threats so I'm the
technical leader senior security

5
00:00:23,699 --> 00:00:29,869
researcher at OpenDNS so my focus is on
graph algorithms and how to apply them

6
00:00:29,869 --> 00:00:38,910
in our kind of massive amount of data to
extract patterns and detect threats my

7
00:00:38,910 --> 00:00:42,919
name is Thomas Matthew I'm a security
researcher at OpenDNS my background is

8
00:00:42,920 --> 00:00:49,380
in machine learning and kinda time
series analysis and the outline in a

9
00:00:49,380 --> 00:00:53,840
nutshell would be something like this so
we'll start with an overview of OpenDNS

10
00:00:53,840 --> 00:00:59,070
is kind of global view and the type of
traffic we will deal with and then we'll

11
00:00:59,070 --> 00:01:04,229
kind of cover the threat landscape that
we are focusing on are focusing on and

12
00:01:04,229 --> 00:01:10,039
then we'll talk about the actual methods
of traffic analysis and then we'll

13
00:01:10,040 --> 00:01:14,950
discuss some very interesting results
that I hope you will like and then we'll

14
00:01:14,950 --> 00:01:19,250
also look at another major part of the
this research which is studying the

15
00:01:19,250 --> 00:01:24,720
hosting infrastructures of these kind of
malicious domains that we catch with

16
00:01:24,720 --> 00:01:28,360
traffic analysis methods and then we'll
have a conclusion and will open it up

17
00:01:28,360 --> 00:01:36,020
for questions so this is kind of the
worldwide map of our resolver so we have

18
00:01:36,020 --> 00:01:41,530
25 data centers with a hundred-plus
recursive resolvers on five continents

19
00:01:41,530 --> 00:01:46,790
and that allows us to see a lot of
traffic and it's very useful to kind of

20
00:01:46,790 --> 00:01:52,020
see have a good perspective into what's
happening on the internet and the DNS

21
00:01:52,020 --> 00:01:59,030
traffic with the away there's actually
off two types so opened both recursive

22
00:01:59,030 --> 00:02:04,310
as well as authoritative DNS traffic and
dennis is the protocol that helps us map

23
00:02:04,310 --> 00:02:05,730
a domain name to tonight

24
00:02:05,730 --> 00:02:11,020
p and authority to traffic is kind of
the global repository of all the

25
00:02:11,020 --> 00:02:16,620
official mappings between a domain name
and IP and then the recursive traffic

26
00:02:16,620 --> 00:02:21,770
refers to an individual clients DNS
query and then a recursive resolver in

27
00:02:21,770 --> 00:02:25,330
this case opened in years then goes to
the authoritative server and fetches

28
00:02:25,330 --> 00:02:29,920
back the record so these are two
distinct types of data traffic there

29
00:02:29,920 --> 00:02:33,690
were dealing with when it comes to DNS
traffic in both these are extremely

30
00:02:33,690 --> 00:02:39,690
valuable so having said that let's take
a look at the threat landscape that we

31
00:02:39,690 --> 00:02:45,200
are trying to cover here so if we're
talking about cybercrime were kind of

32
00:02:45,200 --> 00:02:50,799
malware that is trying to with which the
bad guys are trying to kind of make

33
00:02:50,800 --> 00:02:51,280
money

34
00:02:51,280 --> 00:02:55,160
financially motivated cyber crime so
usually are you trying to infect as many

35
00:02:55,160 --> 00:03:01,650
machines as possible with a variety of
malware kind of kind of pieces so could

36
00:03:01,650 --> 00:03:07,430
be equipped or an somewhere a banking
Trojan all kinds of about $40 at fraud

37
00:03:07,430 --> 00:03:12,350
or like something software to force you
to kind of call a hotline and you know

38
00:03:12,350 --> 00:03:17,209
they money to fix your computer so all
of these attacks or all of these malware

39
00:03:17,209 --> 00:03:22,540
to get in planning on your box I usually
the they are delivered via what we call

40
00:03:22,540 --> 00:03:28,450
that exploit kids and to end up on the
exploit kit and drop the malware you'll

41
00:03:28,450 --> 00:03:32,670
have to go through another earlier stage
which is visiting like a popular

42
00:03:32,670 --> 00:03:38,350
compromise site for like an advertising
campaign and sometimes you will be sent

43
00:03:38,350 --> 00:03:42,480
like a phishing spam email where they
ask you to open up an attachment

44
00:03:42,480 --> 00:03:47,429
like some of the Walmart or UPS alerts
and if you click on it and open it up

45
00:03:47,430 --> 00:03:52,190
then you get the malware dropped on your
on your machine so our focus in this

46
00:03:52,190 --> 00:03:56,950
research is to kind of the TechEd the
patterns that are typical of exploit kit

47
00:03:56,950 --> 00:04:02,540
lens intimates and will show how if you
analyze DNS you can be very successful

48
00:04:02,540 --> 00:04:10,320
in kind of point zero in on on those
type of types of attacks so before we

49
00:04:10,320 --> 00:04:12,920
talk about some of the methods it's
useful though

50
00:04:12,920 --> 00:04:16,168
talk about the scale of data that we're
working with because I'll put the

51
00:04:16,168 --> 00:04:21,608
methods into perspective so we see about
seventy billion DNS queries per day and

52
00:04:21,608 --> 00:04:25,510
so that translates in about half a
terabyte of data per hour that needs to

53
00:04:25,510 --> 00:04:30,020
be processed furthermore if you just
took the sample of our authoritative

54
00:04:30,020 --> 00:04:35,099
data and Canada transformed into a
relational graph would have around 46

55
00:04:35,100 --> 00:04:39,169
million nodes as well as a hundred and
seventy four million edges between those

56
00:04:39,169 --> 00:04:43,770
notes and the net and the nodes
represent a domain IP peering and edges

57
00:04:43,770 --> 00:04:49,120
represent some sort of relationship
between nodes so with this amount but

58
00:04:49,120 --> 00:04:53,030
this many kind of nodes it's really an
example of a needle in a haystack type

59
00:04:53,030 --> 00:04:57,780
problem because it's just far too many
notes for an individual or even a group

60
00:04:57,780 --> 00:05:02,369
of analysts to quickly identify a
potential malicious domain and that's

61
00:05:02,370 --> 00:05:08,060
what we do develop some automated
techniques exactly so the challenge here

62
00:05:08,060 --> 00:05:12,950
is to have automated methods that can be
scalable and efficient at the same time

63
00:05:12,950 --> 00:05:20,800
so let's take a look at some of these
DNS traffic analysis techniques so the

64
00:05:20,800 --> 00:05:21,690
classic

65
00:05:21,690 --> 00:05:24,960
Dina stated that people are familiar
with working with is called

66
00:05:24,960 --> 00:05:29,479
authoritative data and I'm sure some of
you have heard of passive DNS data bases

67
00:05:29,479 --> 00:05:34,510
in a passive DNS data bases use
authoritative data authoritative DNS

68
00:05:34,510 --> 00:05:41,690
data is a historical kind of mapping of
a domain to IP pairing so for example I

69
00:05:41,690 --> 00:05:47,390
could see all of the IP's at google.com
has mapped to but the last one year if

70
00:05:47,390 --> 00:05:51,310
I'm keeping track of all my
authoritative data so it's really useful

71
00:05:51,310 --> 00:06:01,000
for a historical view of domains kind of
IP history as a result this is this type

72
00:06:01,000 --> 00:06:06,380
of data is extremely helpful in catching
three types of domain we have some

73
00:06:06,380 --> 00:06:11,130
badness the first is what's called a
fast flux two main fast flux domain is a

74
00:06:11,130 --> 00:06:15,930
domain that continually changes its IP
mapping in a matter of seconds this is

75
00:06:15,930 --> 00:06:19,529
used by a lot of botnets and Trojans so
they can evade

76
00:06:19,529 --> 00:06:24,319
captured by the authorities also many
researchers enjoyed using authoritative

77
00:06:24,319 --> 00:06:29,049
data to help them create domain
reputation mapping so they can kind of

78
00:06:29,049 --> 00:06:33,649
see that have a certain IP ranges
considered bad and a domain maps to it

79
00:06:33,649 --> 00:06:38,799
that domain is probably also a bad
domain and discontent to expand into the

80
00:06:38,799 --> 00:06:44,929
idea of prefix reputation essentially
authoritative data is helpful to kind of

81
00:06:44,929 --> 00:06:50,219
see how and I P relationship with a
domain can be somehow associated with

82
00:06:50,219 --> 00:07:01,389
some measure of badness so the most
popular method is domain reputation was

83
00:07:01,389 --> 00:07:05,369
talked about and it's kind of a matter
thats been used for the last ten fifteen

84
00:07:05,369 --> 00:07:08,939
year by 10 15 years by security
companies rather some sort of

85
00:07:08,939 --> 00:07:14,749
complicated formula involved identifying
whether a domain is good or bad so they

86
00:07:14,749 --> 00:07:20,029
look at the reputation of the IP the
Registrar the registrant email and some

87
00:07:20,029 --> 00:07:24,558
other crazy terms and then they come up
with the score and then if the scores

88
00:07:24,559 --> 00:07:31,299
over some threshold the added to the
blacklist so the problem is this was a

89
00:07:31,299 --> 00:07:34,799
matter that was developed around ten
fifteen years ago when the Internet in

90
00:07:34,799 --> 00:07:39,888
hosting was considerably different and
as a result while domain reputation has

91
00:07:39,889 --> 00:07:44,729
its place their new category of threats
that are able to easily evade classic

92
00:07:44,729 --> 00:07:51,839
domain reputation for example many times
DJs or a domain generated algorithms are

93
00:07:51,839 --> 00:07:56,159
able to create a slew of new demands
really quickly and authoritative DNS is

94
00:07:56,159 --> 00:07:57,869
unable to properly handle them

95
00:07:57,869 --> 00:08:02,359
secondly there's also a class of domains
that maliciousness can only really be

96
00:08:02,359 --> 00:08:07,818
inferred by by looking at the client
behavior as they interact with the

97
00:08:07,819 --> 00:08:09,849
website so

98
00:08:09,849 --> 00:08:15,199
as a result we've noticed an exploit
kits have used compromise domains which

99
00:08:15,199 --> 00:08:20,819
many times are associated with that have
a good reputation yet will then fly

100
00:08:20,819 --> 00:08:25,789
under the radar of that domain
repudiation algorithm because the domain

101
00:08:25,789 --> 00:08:30,080
that they're kind of compromise
everybody thinks is good and finally the

102
00:08:30,080 --> 00:08:33,919
price of domains and subdomains have
gone cheaper so it's easier to flood the

103
00:08:33,919 --> 00:08:38,348
market with a ton of domains that have
no reputation so you can even make a

104
00:08:38,349 --> 00:08:44,149
prediction so we decided that there
could be a couple of techniques to help

105
00:08:44,149 --> 00:08:47,810
us identify potentially malicious
domains that didn't rely on

106
00:08:47,810 --> 00:08:54,529
authoritative DNS and we want to look at
the DNS query patterns and particular we

107
00:08:54,529 --> 00:08:58,750
thought that Dennis Quaid patterns are
single that are harder for the attacker

108
00:08:58,750 --> 00:09:03,949
to control so more particularly want to
see whether we could use DNA scraped

109
00:09:03,949 --> 00:09:08,540
patterns to identify exploit kit domains
because they believe that there is a

110
00:09:08,540 --> 00:09:14,759
very specific signal between exploit kit
domain and dirtiness gray pattern from

111
00:09:14,759 --> 00:09:21,240
the client from the user and the user
and in the idea here is that the signals

112
00:09:21,240 --> 00:09:28,930
of these exploit kit domains or other
types of attacks they have inherent vs

113
00:09:28,930 --> 00:09:32,620
acquired or assigned features so if
you're talking about certain malicious

114
00:09:32,620 --> 00:09:40,040
domains the lexical makeup is kind of
sometimes used as a feature to detect

115
00:09:40,040 --> 00:09:44,360
them are you talking about the GaAs
you'll have like a CD also have a time

116
00:09:44,360 --> 00:09:49,420
granularity whether it's like the minute
the hour or the day that will be used

117
00:09:49,420 --> 00:09:53,810
internally to generate the domain name
there's also like the hosting with its

118
00:09:53,810 --> 00:09:59,768
IP prefix ASN and also the registration
like what type of registrars are you

119
00:09:59,769 --> 00:10:00,760
using

120
00:10:00,760 --> 00:10:04,830
so those are all the features that the
attacker will try to kind of change so

121
00:10:04,830 --> 00:10:11,380
he can evade detection and kind of being
caught the thing is those he can control

122
00:10:11,380 --> 00:10:16,340
however there are certain patterns that
developed or emerging globally from the

123
00:10:16,340 --> 00:10:20,510
infected machines or the kind of would
be infected machines that he cannot

124
00:10:20,510 --> 00:10:25,430
control he cannot escape for example
certain time elements are certain

125
00:10:25,430 --> 00:10:29,729
geographical kind of features of the
clients that are looking up these

126
00:10:29,730 --> 00:10:33,700
malicious domains so our objective here
or like the premise is that we went to

127
00:10:33,700 --> 00:10:40,320
defeat our campaigns by looking at these
features that are very hard for them to

128
00:10:40,320 --> 00:10:45,400
defeat or invade and that's kind of the
the novelty somewhat off of this

129
00:10:45,400 --> 00:10:53,640
research so the general ideas out there
can be significant changes in query

130
00:10:53,640 --> 00:10:58,189
patterns that could be correlated with
militias term domains and we're able to

131
00:10:58,190 --> 00:11:02,400
gather this data by looking at DNS
traffic from below the recursive later

132
00:11:02,400 --> 00:11:07,189
and this type of data contains six
pieces of valuable information there's a

133
00:11:07,190 --> 00:11:12,790
times down our client IP the domain
queried by the client the resolver

134
00:11:12,790 --> 00:11:18,490
queried which gives us a geographical
location as well as the query type or

135
00:11:18,490 --> 00:11:25,550
acute type and this then leads us to
building so the kind of the the system

136
00:11:25,550 --> 00:11:31,430
we are developing here is goes like this
so the block diagram looks like a a

137
00:11:31,430 --> 00:11:37,199
spike detection algorithm in the
beginning so you'll get like an input of

138
00:11:37,200 --> 00:11:42,070
hourly logs that you run the spike
detection algorithm and then you get

139
00:11:42,070 --> 00:11:46,550
like a large set of domains as the
output but then you'll have to clean up

140
00:11:46,550 --> 00:11:51,939
that set further so what we apply is a
domain history filter that I'll explain

141
00:11:51,940 --> 00:11:55,730
later and then from that you'll have
like a couple more filters that are kind

142
00:11:55,730 --> 00:11:59,700
of worked at the same time when is based
on cue type that we receive enquiries

143
00:11:59,700 --> 00:12:03,520
and the other one is some sort of an
active probing whether you check whether

144
00:12:03,520 --> 00:12:09,750
the domain has specific records and the
combination of those two will allow us

145
00:12:09,750 --> 00:12:14,400
to kind of the side whether this domain
is an exploit the potential exploit kit

146
00:12:14,400 --> 00:12:16,079
its effects software

147
00:12:16,080 --> 00:12:21,670
browser like fishing DGA spam etcetera
now having obtained that final set which

148
00:12:21,670 --> 00:12:27,110
is quite refined we still need to kind
of expand the intelligence graph so what

149
00:12:27,110 --> 00:12:31,790
do we do with pivot around the AP's the
Rangers the a sense the smaller hosters

150
00:12:31,790 --> 00:12:36,110
the registrant emails any kind of
indicator that you can extract from that

151
00:12:36,110 --> 00:12:40,460
set that will help you can identify
other things and enrich your kind of

152
00:12:40,460 --> 00:12:45,680
graph so in the process can keep going
like in different hops as much as you

153
00:12:45,680 --> 00:12:54,819
want as I mentioned earlier the traffic
pattern that we're looking for is a

154
00:12:54,820 --> 00:13:00,330
spike in traffic and we define a spike
as a particular jump in traffic over a

155
00:13:00,330 --> 00:13:06,630
two hour window however we also
calculated a threshold score that the

156
00:13:06,630 --> 00:13:11,360
spike needs across in order for it to be
considered like a valid spike and this

157
00:13:11,360 --> 00:13:15,760
helps us filter out high traffic demands
like Google Facebook the New York Times

158
00:13:15,760 --> 00:13:22,050
or to means that might naturally because
they're popular websites and a post

159
00:13:22,050 --> 00:13:26,010
something that attracts a lot of
followers so as a result are only

160
00:13:26,010 --> 00:13:30,180
looking for domains that haven't
received a lot of traffic in the past

161
00:13:30,180 --> 00:13:32,979
and then suddenly such exhibit

162
00:13:32,980 --> 00:13:38,800
bikes in their traffic pattern behavior
this entire day job is done by using a

163
00:13:38,800 --> 00:13:44,599
MapReduce job which helps us calculate
the domains that have spiked the problem

164
00:13:44,600 --> 00:13:50,389
is we still end up at around fifty to a
hundred K domains to inspect so we're

165
00:13:50,389 --> 00:13:56,720
not yet fully done so this is an example
of Philip to exploit kit domains and

166
00:13:56,720 --> 00:14:00,730
their traffic patterns as well as an
example of the types of spikes that

167
00:14:00,730 --> 00:14:10,019
we're hoping to extract from the DNS
query logs so because the majority of

168
00:14:10,019 --> 00:14:16,670
the 5200 k domains are not militias we
need to add some more features in fact

169
00:14:16,670 --> 00:14:20,219
when we started to look through the
domains we noticed that many domains

170
00:14:20,220 --> 00:14:25,310
belong two mail servers or random blogs
and also included what we called

171
00:14:25,310 --> 00:14:29,989
victimized domains and so this is an
example of a victimized domain that

172
00:14:29,990 --> 00:14:37,139
participated in a DNS amplification
attack essentially people's spoofed of

173
00:14:37,139 --> 00:14:42,800
series of DNS any requests to this
domain and this domain then responded

174
00:14:42,800 --> 00:14:48,250
with a much larger package response and
the spoofed people receive them these

175
00:14:48,250 --> 00:14:54,690
very large DNS packets that overloaded
their network capacity so that's as an

176
00:14:54,690 --> 00:14:59,079
example of a domain that it's not
necessarily it shouldn't be blocked but

177
00:14:59,079 --> 00:15:08,079
it's just being victimized by miscreants
so as we mentioned there's to be just

178
00:15:08,079 --> 00:15:11,089
can't rely on the spike alone to help us

179
00:15:11,089 --> 00:15:15,600
filter out demand so we need ok look at
the spike as being more than one

180
00:15:15,600 --> 00:15:19,949
dimension so we want to add extra
dimensions into modeling the spike

181
00:15:19,949 --> 00:15:21,939
better so

182
00:15:21,939 --> 00:15:26,939
one type of feature that helps us get a
better idea of the the type of spike is

183
00:15:26,939 --> 00:15:33,478
looking at the genus cleary type and so
every time you send a DNS query there is

184
00:15:33,479 --> 00:15:38,019
a query type that is associated with
that DNS requests so for example let's

185
00:15:38,019 --> 00:15:41,949
say that you're interested in knowing
the mail server IP address at google.com

186
00:15:41,949 --> 00:15:49,429
you would send a DNS query type 15 which
refers to an MX record there's also then

187
00:15:49,429 --> 00:15:55,959
34 other DNS query types of you look at
16 which is a tax record 99 region which

188
00:15:55,959 --> 00:16:01,518
is an SPF record which deals with mail
application and then a 255 which is in

189
00:16:01,519 --> 00:16:07,369
any record so the idea that we had
wasn't why don't we look at all of the

190
00:16:07,369 --> 00:16:13,679
spikes that have been generated and then
partitioned into various pairings genus

191
00:16:13,679 --> 00:16:19,499
clearly types so in this case the total
number of partitions that could exist is

192
00:16:19,499 --> 00:16:24,769
31 because we just sum up over the
number of possible combinations in this

193
00:16:24,769 --> 00:16:30,609
case being and choose five where n
ranges from one to five and we can then

194
00:16:30,609 --> 00:16:35,449
see all the various combinations that
can exist so for example a certain

195
00:16:35,449 --> 00:16:40,019
domain that spiked receive DNS query
types of one in fifteen what does it

196
00:16:40,019 --> 00:16:44,529
really received in discrete types of
only one what's interesting is that

197
00:16:44,529 --> 00:16:48,499
there's some very specific distributions
that are associated with the partition

198
00:16:48,499 --> 00:16:55,220
for example 75% of all the spike demands
only received a queries and many times

199
00:16:55,220 --> 00:17:00,899
we don't even see DNS queries of the
particular type for example the Q type

200
00:17:00,899 --> 00:17:05,269
99 never existed and we've been running
this study for about the last eight

201
00:17:05,269 --> 00:17:12,429
months and we have yet to see a single
denis leary of just type 99 occur in his

202
00:17:12,429 --> 00:17:17,470
bike domain so what this kind of give us
hope is that this type of partitioning

203
00:17:17,470 --> 00:17:19,589
can help us associate

204
00:17:19,589 --> 00:17:24,789
partitions of it the behavior of the
spike so I'm gonna walk through some of

205
00:17:24,789 --> 00:17:30,549
the examples that we found so for
example acute type of one in 15 that

206
00:17:30,549 --> 00:17:35,570
means a domain that spiked received two
types of both won in 15 belong to

207
00:17:35,570 --> 00:17:40,600
basically one classic family which was
legitimate mail servers and even within

208
00:17:40,600 --> 00:17:44,740
this legitimate class there were two
types of distributions so for example

209
00:17:44,740 --> 00:17:51,580
you could have a domain dad spiked to
say a hundred and then 50% would be of

210
00:17:51,580 --> 00:17:57,710
type genus to Taiwan in 50 percent would
be a penis type 15 and then there is

211
00:17:57,710 --> 00:18:04,570
also the 90 91 split where 99 was a few
type 1 and then one was cute I 15 and

212
00:18:04,570 --> 00:18:10,059
this just accounted for 4% of all spike
demands but what was interesting was

213
00:18:10,059 --> 00:18:14,450
when we started to look at the larger
time series for this partition there

214
00:18:14,450 --> 00:18:20,309
began to these domains began to exhibit
a periodic pattern in their past clear

215
00:18:20,309 --> 00:18:25,480
history so they realize that domains
that had some nature of periodic

216
00:18:25,480 --> 00:18:29,460
patterns the past would most likely be
benign demands and this was something

217
00:18:29,460 --> 00:18:36,279
that you would then use when creating a
time series filter later on one of the

218
00:18:36,279 --> 00:18:42,610
more interesting partition types was the
Q type group that contained all the cute

219
00:18:42,610 --> 00:18:47,250
I partition that contained all the Q
types and this partition was many times

220
00:18:47,250 --> 00:18:51,730
associated with spam demands and will be
identified was that domains that had a

221
00:18:51,730 --> 00:18:56,580
jump from said 1222 although sign a
couple thousand what many times

222
00:18:56,580 --> 00:19:03,149
associated with spam demand so for
example dem dudes XYZ was a domain that

223
00:19:03,149 --> 00:19:07,820
we found out to be participating in a
larger spam campaign however the

224
00:19:07,820 --> 00:19:10,649
challenge with relying on two types for

225
00:19:10,650 --> 00:19:17,970
straight black labels is you can always
blindly label things as spam so for

226
00:19:17,970 --> 00:19:24,530
example here's Eurovision need I T which
also received the same which also lay in

227
00:19:24,530 --> 00:19:29,600
the same cute I partition but it was a
completely completely legitimate domain

228
00:19:29,600 --> 00:19:38,409
finally there was the cute I partition
of 169 99 which all belong to families

229
00:19:38,410 --> 00:19:45,460
of mail servers so in this case all the
domains atlantis partition or somehow

230
00:19:45,460 --> 00:19:52,970
related by there to Aldi in this case
you can see the VPM . mad dog BR had two

231
00:19:52,970 --> 00:19:57,730
mail servers that are pretty much
spiking at exactly the same time and if

232
00:19:57,730 --> 00:20:01,250
we looked at the previous history of
these demands we can see that they're

233
00:20:01,250 --> 00:20:07,080
almost identical this was another
interesting part is you know having said

234
00:20:07,080 --> 00:20:11,649
that remember in the block diagram we
showed that we have the spike algorithm

235
00:20:11,650 --> 00:20:17,020
that looks at surges in traffic between
two hours so when we extract those

236
00:20:17,020 --> 00:20:22,300
domains before we do the Q type filter
we apply what we call a domain history

237
00:20:22,300 --> 00:20:27,740
filter this one is kind of trying to
separate benign versus domains that are

238
00:20:27,740 --> 00:20:34,220
kind of involved in malware distribution
and what we first do is eliminate

239
00:20:34,220 --> 00:20:38,950
anything that has more than X
consecutive 90 hours of traffic that's

240
00:20:38,950 --> 00:20:44,370
kind of eliminating all of the domains
that had past history and then we have

241
00:20:44,370 --> 00:20:48,449
been observing like exploit kit domains
for a while and we saw that they

242
00:20:48,450 --> 00:20:56,300
featured this behavior were the spike
will last no more than why consecutive

243
00:20:56,300 --> 00:21:01,500
90 hours of traffic and its specific to
the attacks so what we do in the next

244
00:21:01,500 --> 00:21:08,060
stages limit only keep the domains that
have the most recent why consecutive 90

245
00:21:08,060 --> 00:21:15,210
hours as an example of this domain here
it had a spike when we caught it but

246
00:21:15,210 --> 00:21:20,310
then when we checked the past 30 days
will see that it had earlier bump a

247
00:21:20,310 --> 00:21:25,200
couple weeks ago and that will kind of
eliminated from the specific types of

248
00:21:25,200 --> 00:21:31,660
attacks were trying to catch however if
we look at the nuclear exploit kit

249
00:21:31,660 --> 00:21:35,930
Landon domain we see that it has a spike
but then when we checked like the last

250
00:21:35,930 --> 00:21:37,180
30 days

251
00:21:37,180 --> 00:21:43,270
the history was kind of all flat so
that's kind of an indication of what its

252
00:21:43,270 --> 00:21:49,870
kind of repurposed for now the other
filter that goes in association with

253
00:21:49,870 --> 00:21:56,100
acute type filter is the active probing
or domains records filter this one is

254
00:21:56,100 --> 00:22:00,919
basically asked in the domains we
obtained from the previous stage do they

255
00:22:00,920 --> 00:22:07,470
have specific Guinness records so we'll
ask if it has an A record MX txt see

256
00:22:07,470 --> 00:22:11,500
name or name server and each one of
these will tell us something like a

257
00:22:11,500 --> 00:22:16,180
story about this domain so for example
for certain types of compromise domains

258
00:22:16,180 --> 00:22:20,040
of you see that they are having a
specific name server you would know that

259
00:22:20,040 --> 00:22:23,520
they are being compromised and
repurposed for certain attacks same

260
00:22:23,520 --> 00:22:28,790
thing if they are using certain name
servers you will know that they are are

261
00:22:28,790 --> 00:22:33,120
kind of used for delivering malware and
all of these

262
00:22:33,120 --> 00:22:41,370
records will actually contribute to the
decision at the end so the ultimate goal

263
00:22:41,370 --> 00:22:49,090
is to categorize a domain based on its
partition and some of the information

264
00:22:49,090 --> 00:22:53,820
regarding its pike and then put into
various groups whether it's an exploit

265
00:22:53,820 --> 00:22:54,689
kit domain

266
00:22:54,690 --> 00:23:01,120
ed garsten belonging to the product
family so and so on so we decided to do

267
00:23:01,120 --> 00:23:05,840
was to then can I write up a classifier
that could automatically kind of detect

268
00:23:05,840 --> 00:23:11,580
whether what what family despite domain
belong to so this could have brought up

269
00:23:11,580 --> 00:23:15,010
a larger than a philosophical point
which is what's the ground truth that

270
00:23:15,010 --> 00:23:21,480
we're working with and so in this case
the end of the known bad that we had

271
00:23:21,480 --> 00:23:26,580
been collected over the span of five or
six months and so in the future as we

272
00:23:26,580 --> 00:23:27,620
can move forward

273
00:23:27,620 --> 00:23:33,479
domains that we were to catch but only
kinda belong to this said it would be

274
00:23:33,480 --> 00:23:38,710
difficult for us to identify say newly
emerging demands because they have never

275
00:23:38,710 --> 00:23:42,950
seen any sort of you may like that in
the past and there was something just

276
00:23:42,950 --> 00:23:48,679
for us to Canon know as we built this
system so we decided to use probably the

277
00:23:48,679 --> 00:23:53,990
most basic of classifiers which is a
decision tree and so the idea behind a

278
00:23:53,990 --> 00:23:58,960
decision tree is to have a set of
questions that we can have all combined

279
00:23:58,960 --> 00:24:03,360
together to provide a former
classifications and once we go through

280
00:24:03,360 --> 00:24:07,979
the process of training the classifier
over a training set of data each of

281
00:24:07,980 --> 00:24:12,890
these questions are given a certain
level away and so when a domain kinda

282
00:24:12,890 --> 00:24:17,090
passes through a decision tree as it
kinda is asked each of these questions

283
00:24:17,090 --> 00:24:22,439
its output responds helps it cannot
follow down the tree and an end up in a

284
00:24:22,440 --> 00:24:27,559
certain classification bucket so what is
meant was we were passing a list of

285
00:24:27,559 --> 00:24:30,050
filter domains and then

286
00:24:30,050 --> 00:24:34,960
once again I went through the decision
tree it would be kind of spat out into a

287
00:24:34,960 --> 00:24:39,120
nice little buckets depending on whether
it's a spam demand or explain it to me

288
00:24:39,120 --> 00:24:45,439
so the types of features that the
decision tree looked at when asking its

289
00:24:45,440 --> 00:24:50,610
question involved the partition class
despite the main belong to the height of

290
00:24:50,610 --> 00:24:56,350
the site and the number of unique IP's
and so what we found out was passing

291
00:24:56,350 --> 00:25:00,209
through this list of domains of the
decision trees and then spitting it out

292
00:25:00,210 --> 00:25:05,770
into the various pockets made it far
more manageable task so we're able to

293
00:25:05,770 --> 00:25:12,310
reduce the list of $100,000 means to
actually only fifty or sixty domains and

294
00:25:12,310 --> 00:25:16,580
that was something that our hands could
easily you look through and define true

295
00:25:16,580 --> 00:25:22,460
positives so after kind of giving an
overview of the architecture and design

296
00:25:22,460 --> 00:25:27,240
of the system I know you like to see
results so there's a kind of the part

297
00:25:27,240 --> 00:25:32,440
that I find kind of exciting so these
are some of the types of attacks we

298
00:25:32,440 --> 00:25:36,620
catch so like I said exploit kits the
current ones like engler nuclear

299
00:25:36,620 --> 00:25:44,520
industry know a lot of DA's also lot to
fix software Chrome extensions and a

300
00:25:44,520 --> 00:25:49,100
bunch of other plugin extensions that
you receive and also a bunch of a lot of

301
00:25:49,100 --> 00:25:50,850
spyware scareware

302
00:25:50,850 --> 00:25:58,399
kind of executables and then we also
have the class of browser-based friends

303
00:25:58,400 --> 00:26:04,180
somewhere and finally we caught a lot of
phishing campaigns with the system now

304
00:26:04,180 --> 00:26:08,990
having said that there is another piece
in the study which is recording or

305
00:26:08,990 --> 00:26:13,670
documenting the hosting patterns of
these malicious domain so Thomas

306
00:26:13,670 --> 00:26:18,950
mentioned earlier the kind of the
problem of ground truth based on past

307
00:26:18,950 --> 00:26:25,800
history however if you also follow the
trail of the way kind of the bad guys

308
00:26:25,800 --> 00:26:29,060
establish their infrastructures that
also give you some more intelligence on

309
00:26:29,060 --> 00:26:33,270
how they are operating so you can
combine traffic analysis with hosting

310
00:26:33,270 --> 00:26:37,090
infrastructure monitoring and it gives
you like a much better perspective it's

311
00:26:37,090 --> 00:26:41,720
kind of the title of unified view to
catch baden's so there are some of the

312
00:26:41,720 --> 00:26:46,140
documented patterns we have a lot more
about we kind of shows a few to share

313
00:26:46,140 --> 00:26:50,230
with you so you have like what we call
compromise domains or what has been

314
00:26:50,230 --> 00:26:54,380
called in the past few months domain
shadowing is basically a compromise to

315
00:26:54,380 --> 00:26:59,600
Aldi's and they are injected with sub
domains and subdomains they are pointing

316
00:26:59,600 --> 00:27:04,709
to appease that are not those of the two
LEDs and the ideas usually kind of our

317
00:27:04,710 --> 00:27:10,130
hosting exploit kit lens and kind of
domains or proxies to the actual exploit

318
00:27:10,130 --> 00:27:14,810
and also used for Melbourne teasing the
other pattern we saw is that in addition

319
00:27:14,810 --> 00:27:16,929
to the domain shadowing you'll see them

320
00:27:16,930 --> 00:27:22,140
resolving to several IP's so it's kind
of awesome fault tolerance here if when

321
00:27:22,140 --> 00:27:25,640
I think it's shut down then they can use
the second one and usually they are kind

322
00:27:25,640 --> 00:27:31,210
of spread and different prefixes and
sometimes different ASN hosters the

323
00:27:31,210 --> 00:27:36,630
third pattern is we saw a lot of the
exploited domains and now we're kind of

324
00:27:36,630 --> 00:27:41,720
domains being hosted on bullet-proof
hosting providers and is usually are

325
00:27:41,720 --> 00:27:43,330
registered offshore

326
00:27:43,330 --> 00:27:47,590
you know like an Caribbean island
Southeast Asia sometimes and some

327
00:27:47,590 --> 00:27:54,500
Eastern European countries were kind of
the legislation or regulations are kind

328
00:27:54,500 --> 00:28:00,500
of lacks or they can evade you know
abuse responding to abuse reports or

329
00:28:00,500 --> 00:28:06,130
they can take longer to respond to those
kind of abuse reports and then they also

330
00:28:06,130 --> 00:28:09,830
try to diversify their IP space so if
its registered its in the Seychelles

331
00:28:09,830 --> 00:28:16,210
then they will try to have a presence in
datacenters in Aaron and and ripe IP

332
00:28:16,210 --> 00:28:19,440
space and again it's kind of fault
tolerance so they should get shut down

333
00:28:19,440 --> 00:28:23,230
in one country that can always use
another country and the country's will

334
00:28:23,230 --> 00:28:27,500
have different kind of legislation so
one will be like more strict and the

335
00:28:27,500 --> 00:28:31,970
other one will be lacks and they can
play that game the other one and I'm

336
00:28:31,970 --> 00:28:34,850
sure a lot of you are familiar with this
you have a lot of these big providers

337
00:28:34,850 --> 00:28:39,850
that are heavily abused over and over
again in Germany Lease weapon in the

338
00:28:39,850 --> 00:28:44,810
Netherlands in digital motion in both
like North America and Europe and then

339
00:28:44,810 --> 00:28:50,070
finally we love we saw a few examples of
shady hosters like smaller scale hosting

340
00:28:50,070 --> 00:28:55,990
providers that are created within larger
ones and they are catering to mostly

341
00:28:55,990 --> 00:29:02,200
criminals so I'll take the example of
vulture in a second so as the first

342
00:29:02,200 --> 00:29:06,610
example the compromise domains or
dementia doing like I explained earlier

343
00:29:06,610 --> 00:29:10,290
it's kind of the two will D injected
with subdomains for delivering attacks

344
00:29:10,290 --> 00:29:16,720
in as a side note Go Daddy has been the
most abused in the past I guess couple

345
00:29:16,720 --> 00:29:21,960
of years and what do you see try to
check is if the domain the suspicious

346
00:29:21,960 --> 00:29:25,840
one that you can to the spike model has
a name server as

347
00:29:25,840 --> 00:29:30,158
brody's name servers you will assume
it's kind of compromise and repurposed

348
00:29:30,159 --> 00:29:33,779
for attacks especially if it has a
sub-domain on an IP that the suspicious

349
00:29:33,779 --> 00:29:38,000
however we can find some false positive
so you can find these cases where it's

350
00:29:38,000 --> 00:29:42,220
actually a Chinese luxury where casino
site or some spam and this is kind of a

351
00:29:42,220 --> 00:29:45,679
not on the same level of madness you
cannot just like block it and see and do

352
00:29:45,679 --> 00:29:49,820
it like Iran global however when you
look at more features in terms of Q type

353
00:29:49,820 --> 00:29:56,168
or in terms of the IP of the clients the
AP's of the clients then you can make a

354
00:29:56,169 --> 00:30:04,390
better decision so this is an example of
spam domain and explained to me that

355
00:30:04,390 --> 00:30:10,230
both bikes and the decision she was able
to correctly classify these two examples

356
00:30:10,230 --> 00:30:17,130
because it was looking at the number of
unique IP's which in this case is 40 and

357
00:30:17,130 --> 00:30:22,120
compare that to the ratio of DNS queries
it saw that it became closer to a

358
00:30:22,120 --> 00:30:26,949
one-to-one ratio than in the case of the
spam domain which is you can see only

359
00:30:26,950 --> 00:30:32,720
had one unique IP and that one unique IP
generated 26 queries that was pretty far

360
00:30:32,720 --> 00:30:36,409
away from a one-to-one ratio so the
decision tree then realized that there

361
00:30:36,409 --> 00:30:41,649
is that difference and then classified
both of these groups directly on the

362
00:30:41,649 --> 00:30:46,469
other hand in terms of hosting
perspective this the exploit good domain

363
00:30:46,470 --> 00:30:51,520
is hosted on this ip that belongs to
this website is sent in more

364
00:30:51,520 --> 00:30:55,970
specifically under this smaller hosting
provider called your about that are you

365
00:30:55,970 --> 00:30:59,960
and this one has been kind of used for a
while for malicious purposes whether

366
00:30:59,960 --> 00:31:05,529
it's abused or kind of complicity of the
criminals that's kind of the way the

367
00:31:05,529 --> 00:31:10,320
spike looks for this exploit kit domain
and that's kind of the Europe by that

368
00:31:10,320 --> 00:31:10,918
are you

369
00:31:10,919 --> 00:31:15,679
hoster now taking a look at the next
pattern in terms of hosting

370
00:31:15,679 --> 00:31:20,990
infrastructure and as we associated with
the spiky domain so this one is still

371
00:31:20,990 --> 00:31:25,360
using the domain shadowing technique so
you have the domain MIT . Academy with a

372
00:31:25,360 --> 00:31:30,469
sub domain they both actually the domain
results to a couple IP's

373
00:31:30,470 --> 00:31:34,700
but they still belong so they belong to
different prefixes but they are still

374
00:31:34,700 --> 00:31:39,340
under the same percent and more
specifically that IP belongs to a VPS

375
00:31:39,340 --> 00:31:43,539
their servers that are you this kind of
a small hosting provider in russia now

376
00:31:43,539 --> 00:31:48,900
it's interesting how we as as we said
earlier how we can follow the trail so

377
00:31:48,900 --> 00:31:54,330
looking at the range of the 160 the
neighboring IP's are also hosting

378
00:31:54,330 --> 00:32:00,939
similar domains and among those aP's one
of them was hosting this other domain

379
00:32:00,940 --> 00:32:06,570
using domain shadowing which was also
resolving to another IP IP was living on

380
00:32:06,570 --> 00:32:12,030
host life dotnet and other Russian
hosting provider which is actually under

381
00:32:12,030 --> 00:32:15,570
lease web so this is kind of the case of
the big provider haven't smaller

382
00:32:15,570 --> 00:32:20,590
entities selling kind of EPs and
dedicated service and then when you

383
00:32:20,590 --> 00:32:25,360
check the range of that other LeaseWeb I
P you'll see that actually the range the

384
00:32:25,360 --> 00:32:29,428
neighboring ones are also hosting
similar domains to this kind of an

385
00:32:29,429 --> 00:32:34,620
example of at least three or two hops of
exploration to the intelligence graph

386
00:32:34,620 --> 00:32:38,780
where you can catch things that you
haven't hasn't caught with the initial

387
00:32:38,780 --> 00:32:42,780
model and we are kind of developing a
lot of these kind of micro models that

388
00:32:42,780 --> 00:32:51,158
help you have seeds to kind of probe the
big date of tnx or IP space now this is

389
00:32:51,159 --> 00:32:59,140
another example and other exploit kit
domain XYZ and it resolves to the IP so

390
00:32:59,140 --> 00:33:04,549
it lives on this year saying it's
actually part of Q hoster this is a

391
00:33:04,549 --> 00:33:11,100
hosting provider that have has been also
heavily abused or I would say may become

392
00:33:11,100 --> 00:33:14,709
complicit with the criminals now the
range of that I P

393
00:33:14,710 --> 00:33:21,090
all of the the APR 14 neighboring India
/ 24 they were delivering similar

394
00:33:21,090 --> 00:33:26,720
exploited domains and the domains on
those IP's the usually had less than a

395
00:33:26,720 --> 00:33:32,750
day of lifetime actually a couple hours
now another kind of technique will use

396
00:33:32,750 --> 00:33:37,309
we look at the fingerprint of the idea
that we discover and

397
00:33:37,309 --> 00:33:41,330
those ideas that had the same
fingerprint like they had a web server

398
00:33:41,330 --> 00:33:46,879
engine X and then necesitas port open
and then the same operating system now

399
00:33:46,879 --> 00:33:50,759
when you check the / 24 you'll see that
you have some other IP is having the

400
00:33:50,759 --> 00:33:55,950
same fingerprint and then I flag those
and they said well in a couple days or

401
00:33:55,950 --> 00:34:00,070
maybe a few hours they will also start
resolving they were start posting these

402
00:34:00,070 --> 00:34:04,960
bad domains and efficient and actually
that happened in kind of the next day

403
00:34:04,960 --> 00:34:10,109
where they started hosting similar kind
of exploded domains delivering the same

404
00:34:10,109 --> 00:34:13,848
attack so again this is kind of the way
you try to predict what's happening and

405
00:34:13,849 --> 00:34:21,310
it kind of worked out well on a larger
scale now another way to pivot around

406
00:34:21,310 --> 00:34:27,029
the domain we caught the registrant
email actually now I believe it's

407
00:34:27,030 --> 00:34:33,399
protected by privacy protect but then
before that it had this email for the

408
00:34:33,399 --> 00:34:38,310
registrant that's BC project at that our
audit are you that was used to register

409
00:34:38,310 --> 00:34:43,129
a lot of these XYZ exploited domains the
thing is it's also registering a

410
00:34:43,129 --> 00:34:48,009
vtext.com and a lot of you are familiar
with those kind of virus total for

411
00:34:48,010 --> 00:34:48,720
criminals

412
00:34:48,719 --> 00:34:53,658
services like scan for you is famous
this one AV check is the one we caught

413
00:34:53,659 --> 00:34:58,579
here I believe it existed before but
they changed their interface and they

414
00:34:58,579 --> 00:35:03,490
posted it on a different IP and this is
typically kind of interface where you

415
00:35:03,490 --> 00:35:07,609
can submit create an account and then
you can submit your samples and check

416
00:35:07,609 --> 00:35:12,230
whether like fun do not make sure
they're under the radar of the AV

417
00:35:12,230 --> 00:35:16,990
vendors of the industry you can also
submit your URLs for your exploit kit

418
00:35:16,990 --> 00:35:21,430
lyndon domains or your sample and you'll
get alerts telling you hey you're kind

419
00:35:21,430 --> 00:35:26,690
of getting caught now starting to become
scene so try to change or group you're

420
00:35:26,690 --> 00:35:34,690
you're malware now the poster of this
specific case like I said it's kind of

421
00:35:34,690 --> 00:35:38,690
shady hosting provider when we checked
its

422
00:35:38,690 --> 00:35:43,859
what's what's around it we saw that the
host was registering the business in

423
00:35:43,859 --> 00:35:48,450
billy's like the Central American kind
of exotic country and then when we

424
00:35:48,450 --> 00:35:52,290
checked their IP space we saw that they
have been doing it for a while

425
00:35:52,290 --> 00:35:59,560
terms of hosting ek domains fishing in
addition to kind of mundane content and

426
00:35:59,560 --> 00:36:04,259
then the IP space was diversified across
Aaron and right and like we said they

427
00:36:04,260 --> 00:36:08,380
try to have a presence in multiple data
centers across the globe and they will

428
00:36:08,380 --> 00:36:12,990
kind of tell you here if you want to
store this content of this tape you

429
00:36:12,990 --> 00:36:16,200
should choose service in this country
and if you wanna do something else you

430
00:36:16,200 --> 00:36:20,879
have to choose another country so for
example if you ignore the NCAA in a

431
00:36:20,880 --> 00:36:25,720
country where you're kind of okay or you
have up to 24 hours to kind of shut down

432
00:36:25,720 --> 00:36:30,839
your content and 24 hours you like it is
it is usually more than enough time to

433
00:36:30,839 --> 00:36:35,089
kind of clean up your servers and move
somewhere else so they always try to

434
00:36:35,089 --> 00:36:40,509
play on this kind of loopholes in the
jurisdiction or like the way ISPs

435
00:36:40,510 --> 00:36:47,730
operate now this is another case of
nuclear exploit kit lens and domain so

436
00:36:47,730 --> 00:36:52,109
it resolves to the IP this is still
fresh as of today and is hosted on

437
00:36:52,109 --> 00:36:56,460
digital ocean again digital ocean is
like a big provider we cannot say it's

438
00:36:56,460 --> 00:37:01,720
like a bad one because its catering to
all kinds of customers and the specific

439
00:37:01,720 --> 00:37:06,740
IP had more than four hundred domains
hosted for like a spender in a span of

440
00:37:06,740 --> 00:37:12,970
15 days in the domains usually have like
a lifetime of again a few hours and less

441
00:37:12,970 --> 00:37:17,959
than a day now the interesting thing is
that the previous patent we observed

442
00:37:17,960 --> 00:37:21,720
with nuclear from a hosting
infrastructure is that at some point

443
00:37:21,720 --> 00:37:27,689
early in february there was like a
massive amount of domains that were

444
00:37:27,690 --> 00:37:32,500
registered from the free nom registrar
and they were all three domains using

445
00:37:32,500 --> 00:37:39,560
like CCT lead like GTA TK and a few
other kind of African countries but they

446
00:37:39,560 --> 00:37:43,460
had nothing to do with Africa they were
all like purpose for exploit kit domains

447
00:37:43,460 --> 00:37:47,950
the interesting thing is that the name
servers were registered using a

448
00:37:47,950 --> 00:37:54,189
compromise to email job @ gmail.com and
the name servers are hosted on digital

449
00:37:54,190 --> 00:37:59,760
ocean and a super / vulture I'll explain
what that is super walter is in that

450
00:37:59,760 --> 00:38:03,640
case the lenin domains themselves like
the ones delivering the attack the worst

451
00:38:03,640 --> 00:38:09,098
hosted on a variety of a sense but most
notably a stripper vulture now the new

452
00:38:09,099 --> 00:38:13,819
pattern that we caught like recently is
that they switched from having dedicated

453
00:38:13,819 --> 00:38:18,750
nameservers to using free noms name
servers again it was easier for us to

454
00:38:18,750 --> 00:38:21,740
kind of pivot around the name servers
because they were exclusively for the

455
00:38:21,740 --> 00:38:26,098
exploited domains but now they are using
the free nom name servers which can be

456
00:38:26,099 --> 00:38:31,740
used for any kind of domain because
again you can go a hundred domains and

457
00:38:31,740 --> 00:38:36,069
the like some exotic city all these and
use the name servers of the Registrar in

458
00:38:36,069 --> 00:38:41,259
there is no way to say everything under
these dennis is bad that's kind of you

459
00:38:41,260 --> 00:38:44,470
know your carpet bombing the a lot of
things and you'll have a lot of

460
00:38:44,470 --> 00:38:48,279
collateral damage so it's kind of a
loophole where they try to use and can

461
00:38:48,280 --> 00:38:54,680
adapt at the same time the lenin domains
are still hosted on vulture individual

462
00:38:54,680 --> 00:38:59,140
ocean however the other interesting
thing is that they are not abusing the

463
00:38:59,140 --> 00:39:03,328
main ASN of digital ocean because when
you check digital ocean it's again

464
00:39:03,329 --> 00:39:10,349
hosting provider with a large IP space
and they have at least 98 cents and the

465
00:39:10,349 --> 00:39:15,050
ones that were abused there were like
the small ones in Singapore Netherlands

466
00:39:15,050 --> 00:39:23,839
and a couple other countries so what's
the story of this Volturi here so voters

467
00:39:23,839 --> 00:39:28,569
actually a child company of a stripper
that's kind of the number this is a

468
00:39:28,569 --> 00:39:33,329
hosting company in North America and
they created vulture as the kind of a

469
00:39:33,329 --> 00:39:38,530
small company to compete with digital
ocean on the affordable VPS market so

470
00:39:38,530 --> 00:39:44,200
they have like actually a large space
like 65,000 IP's

471
00:39:44,200 --> 00:39:51,899
spread across their own right and ethnic
and the fact that they were like very

472
00:39:51,900 --> 00:39:56,950
cost effective made them very attractive
for both legit and criminal kind of

473
00:39:56,950 --> 00:40:01,500
campaign so we found that they were
being used for the past would say since

474
00:40:01,500 --> 00:40:05,550
like the earlier this year for exploit
kids fishing and other great content we

475
00:40:05,550 --> 00:40:10,440
actually wrote a blog last month
explaining how we can we're monitoring

476
00:40:10,440 --> 00:40:19,760
this infrastructure for a while so I
invited to check it out something else

477
00:40:19,760 --> 00:40:24,470
that we've been able to catch RDA's
using this model and the concept behind

478
00:40:24,470 --> 00:40:31,009
a DGA is you are in fact but the piece
of malware and this piece of malware has

479
00:40:31,010 --> 00:40:36,339
a domain generation algorithm encoded in
it and uses the date as a seed and then

480
00:40:36,339 --> 00:40:43,089
on a pre-specified day it generates like
a list of a couple thousand domains and

481
00:40:43,089 --> 00:40:47,490
it then tries to connect to one of one
of these couple thousand domains and

482
00:40:47,490 --> 00:40:51,520
that domain host some sort of key
information or transmit information

483
00:40:51,520 --> 00:40:55,770
regarding some of your banking
information the DJs are a popular method

484
00:40:55,770 --> 00:41:00,200
used by a lot of banking Trojans and
other cybercriminals and in this case we

485
00:41:00,200 --> 00:41:03,779
were able to kind of see the initial
spike on the DGA

486
00:41:03,780 --> 00:41:08,840
and catching quite quickly and
unfortunately found out that are

487
00:41:08,840 --> 00:41:13,320
watching the news networks it already
caught it and it seemed cold it but we

488
00:41:13,320 --> 00:41:17,580
also noticed was that this traffic
pattern for DJs last law a lot longer

489
00:41:17,580 --> 00:41:23,310
around 24 hours while an exploit kit is
actual only five or six hours but what's

490
00:41:23,310 --> 00:41:29,360
interesting is if we look at the query
patterns for a teaches what we notice is

491
00:41:29,360 --> 00:41:34,840
that they're actually almost all
identical in their format so you have

492
00:41:34,840 --> 00:41:39,720
almost the same number of resolvers
being used client IP's and also the

493
00:41:39,720 --> 00:41:47,450
distribution of resolvers so then we
create clusters of sorry we create

494
00:41:47,450 --> 00:41:52,009
clusters of domains and they're kind of
patterns are known as a DJ's definitely

495
00:41:52,010 --> 00:41:56,280
former very tight group because the idea
behind it DJs that you have a state of

496
00:41:56,280 --> 00:42:00,940
infected machines are all calling out at
the same time to the same set of domains

497
00:42:00,940 --> 00:42:04,840
and so that pattern then becomes
repeatable across the state of domains

498
00:42:04,840 --> 00:42:09,850
and it becomes very clear signature as a
result DJs are pretty easy now to be

499
00:42:09,850 --> 00:42:18,970
identified with this method

500
00:42:18,970 --> 00:42:26,029
other type of scene are fake software
and so this is the type of software when

501
00:42:26,030 --> 00:42:30,390
you gonna watch maybe a free video or
something something pops up on your

502
00:42:30,390 --> 00:42:34,690
screen and then something becomes
download it usually an executable

503
00:42:34,690 --> 00:42:40,730
industry in this case we found that it
was downloading Windows executable and

504
00:42:40,730 --> 00:42:41,960
there were nine

505
00:42:41,960 --> 00:42:49,240
IP's in this vicinity overall hosting
the same type of fake software and then

506
00:42:49,240 --> 00:42:53,959
that's when we decided to look at the
executable beset notice that virustotal

507
00:42:53,960 --> 00:43:00,070
quite a bit of information regarding
previous AV vendors that it marked that

508
00:43:00,070 --> 00:43:05,510
executable as militias the other kind of
thing we noticed about this one is that

509
00:43:05,510 --> 00:43:09,780
all of those IP's in the range they are
not all of them had domains hosted on

510
00:43:09,780 --> 00:43:14,470
them but they all had the executable so
they were set up in advance and you

511
00:43:14,470 --> 00:43:19,279
could basically grab the the payload
from the IP's without any domain on them

512
00:43:19,280 --> 00:43:26,160
so just luck W get the IP with the path
and we we saw this actually since 2000

513
00:43:26,160 --> 00:43:30,660
13 or 14 were you have a lot of IP space
haven't been loads without any domains

514
00:43:30,660 --> 00:43:34,940
and they just wait there and all domains
are registered and then purposed

515
00:43:34,940 --> 00:43:40,880
repurposed for specific campaign this is
another interesting example of domain

516
00:43:40,880 --> 00:43:46,820
shadowing so again like they used those
to oldies rejected with subdomains the

517
00:43:46,820 --> 00:43:51,520
IP hear words hosted is like under this
is a test case in its kind of shady in

518
00:43:51,520 --> 00:43:56,650
the thinks its hosting so when we check
the IP belongs to the smaller range

519
00:43:56,650 --> 00:44:02,130
registered by a fellow called Valentin
Coolio most likely like a fake name but

520
00:44:02,130 --> 00:44:06,849
then when you check valentins other eye
peas you'll see that he has a few other

521
00:44:06,849 --> 00:44:11,780
eye peas from 16 to 23 interest-only
again like this for a kind of the

522
00:44:11,780 --> 00:44:17,140
amusement park all those IP's they were
hosting a lot of domains by the

523
00:44:17,140 --> 00:44:21,109
spherical Giovanni couple are so here's
what they call it the Italian goal of

524
00:44:21,109 --> 00:44:26,210
offshore so he's offering a lot of kind
of advice on how to make business in

525
00:44:26,210 --> 00:44:31,599
fiscal paradise countries and kind of
make money in offshore banks and this

526
00:44:31,599 --> 00:44:33,800
guy is like the Italian kind of

527
00:44:33,800 --> 00:44:40,840
police is after him but he's having fun
in South America delivering all of these

528
00:44:40,840 --> 00:44:46,080
blogs and books and he actually has a
large number of electronic books for

529
00:44:46,080 --> 00:44:50,750
people to immigrate to countries and
make a lot of money without paying any

530
00:44:50,750 --> 00:45:01,510
taxes so that's interesting side thing
here we also then ran across a wider

531
00:45:01,510 --> 00:45:07,910
view prologue to me is when you are
visiting a website that all of a sudden

532
00:45:07,910 --> 00:45:13,089
something pops up blocks your browser
says you need to either pay up some

533
00:45:13,090 --> 00:45:17,490
money or the police are going to be
contacted it's kind of like a baby

534
00:45:17,490 --> 00:45:23,509
crypto locker in this case we noticed
that there were brought to mean that

535
00:45:23,510 --> 00:45:28,030
were all spiky at the same time
unfortunately the overall hiding behind

536
00:45:28,030 --> 00:45:34,900
CloudFlare so we couldn't identify their
actual IP address in these specific ones

537
00:45:34,900 --> 00:45:44,450
they were all like russian police force
seem like MVD NFS be kind of alerts the

538
00:45:44,450 --> 00:45:49,859
other kind of the final set of malicious
domains when I cannot discuss here is

539
00:45:49,860 --> 00:45:54,810
fishing so this one we caught a couple
weeks ago it's an Amex fishing campaign

540
00:45:54,810 --> 00:46:00,840
and we called like the initial spike as
it happened in our lives and this is

541
00:46:00,840 --> 00:46:02,860
kind of the distribution of

542
00:46:02,860 --> 00:46:11,410
IP's and resolve or so you had like
around 13,000 1300 queries from 400 +

543
00:46:11,410 --> 00:46:16,850
ID's and they were asking 16 of our
resolvers so it was quite kind of

544
00:46:16,850 --> 00:46:21,839
widespread and the entire world here and
I when we checked the IDs were these

545
00:46:21,840 --> 00:46:27,810
domains were hosted there were again all
over the place and the thing is we try

546
00:46:27,810 --> 00:46:31,310
to pivot around the eighties and also
the registrant emails used for

547
00:46:31,310 --> 00:46:37,009
registering these domains and you would
expect to find some other badness in

548
00:46:37,010 --> 00:46:42,200
this case we found like some Nova Scotia
Nova Scotia Bank fishes and also Royal

549
00:46:42,200 --> 00:46:47,029
Bank of Canada fishes and also a bunch
of other card incites registered on with

550
00:46:47,030 --> 00:46:50,020
the email like private zone

551
00:46:50,020 --> 00:46:53,740
doctor ceci and mr Benn daddy W

552
00:46:53,740 --> 00:47:04,189
unfortunately we also run into false
positives so these are two examples of

553
00:47:04,190 --> 00:47:09,840
false positives that we run into and
this is an example of Chinese SEO sites

554
00:47:09,840 --> 00:47:14,770
in both these cases we were able to
identify them as balls positives for two

555
00:47:14,770 --> 00:47:20,130
reasons first was actually a lexical
reason these domains contain a little

556
00:47:20,130 --> 00:47:25,650
bit opinion and pinion is the
romanization of Mandarin so certain kind

557
00:47:25,650 --> 00:47:31,670
of character strings in like who you are
detected actually you have Mandarin

558
00:47:31,670 --> 00:47:36,570
meanings and the second was if you look
at the IP distribution we could see that

559
00:47:36,570 --> 00:47:41,600
the domain type is participating in
visiting these demands were also

560
00:47:41,600 --> 00:47:49,960
visiting other Chinese SEO demands are
also spiking within the same our alright

561
00:47:49,960 --> 00:47:55,080
so as a conclusion we can try to share
with you this unified view of into a DNS

562
00:47:55,080 --> 00:48:00,790
to catch threats the ideas that we try
to use the DNS traffic we try to use

563
00:48:00,790 --> 00:48:05,330
like a lot of things so one of them
which is the purpose of the stock was

564
00:48:05,330 --> 00:48:09,740
using stuff below the record select all
the traffic patterns you can catch below

565
00:48:09,740 --> 00:48:11,069
the recursive in then

566
00:48:11,069 --> 00:48:15,058
combined that with looking at the
hosting of the structures and that gives

567
00:48:15,059 --> 00:48:19,709
you like a better perspective of what's
going on on the threat landscape and

568
00:48:19,709 --> 00:48:24,219
like we said earlier a lot of these
models that use below the recursive or

569
00:48:24,219 --> 00:48:28,539
above the recursive since we have a lot
of DAT elected DNS kind of platform we

570
00:48:28,539 --> 00:48:32,709
have is quite massive and the idea you
have to develop a lot of micro models to

571
00:48:32,709 --> 00:48:37,799
kind of help you detect these little
seeds that then you can expand with the

572
00:48:37,799 --> 00:48:42,690
graph approach to catch more badness on
the internet so our approach is kind of

573
00:48:42,690 --> 00:48:50,130
a we use content but it's much less than
the patterns that emerge so what kind of

574
00:48:50,130 --> 00:48:54,160
your Allen content agnostic here that
gives us a lot of advantages but you

575
00:48:54,160 --> 00:48:59,598
also need sometimes to verify with URLs
and content analysis and this kind of

576
00:48:59,599 --> 00:49:06,229
the philosophy here that we kind of
advocate you can go and check some of

577
00:49:06,229 --> 00:49:12,058
our other references so we had the blog
about the IP infrastructure and domain

578
00:49:12,059 --> 00:49:16,519
shadowing we had a couple tax at black
hat and DEFCON virus bought in and then

579
00:49:16,519 --> 00:49:22,019
the spike model was discussed at bside
so this year and we had a blog

580
00:49:22,019 --> 00:49:27,390
discussing the combination of different
models so not trying to advertise

581
00:49:27,390 --> 00:49:31,779
anything but if you like this kind of
research we're hiring so talk to us you

582
00:49:31,779 --> 00:49:38,079
can join our team will be very happy to
tell you what we are doing and that's it

583
00:49:38,079 --> 00:50:02,920
so thanks again for your attention and
feel free to ask questions

584
00:50:02,920 --> 00:50:28,599
you mean how they switch from so we
haven't done a specific kind of research

585
00:50:28,599 --> 00:50:32,549
Brotherton that but every once in a
while when we run into domains are

586
00:50:32,549 --> 00:50:38,380
seeing called we try to see like expand
from the IPO the name server and see

587
00:50:38,380 --> 00:50:43,210
what else is kind of been like for
example for a new bus networks the

588
00:50:43,210 --> 00:50:51,190
sinkhole on a variety of things you
cannot just say the sinkhole is used

589
00:50:51,190 --> 00:50:55,780
forcing calling a specific attack so you
like a big company and you know they try

590
00:50:55,780 --> 00:51:00,270
to target they try to kind of take down
a variety of malicious campaigns and was

591
00:51:00,270 --> 00:51:01,190
that your question

592
00:51:01,190 --> 00:51:08,930
the only thing is I was wondering if you
find a way to group I think the

593
00:51:08,930 --> 00:51:12,890
double-digit for example to me explode
key to whatever to group them by your

594
00:51:12,890 --> 00:51:16,598
specific group in to see all only take
to reach you call and if you can

595
00:51:16,599 --> 00:51:23,819
basically use this as a classification
scheme for any case I we haven't seen

596
00:51:23,819 --> 00:51:28,970
any single decays cause usually they're
very short lived in I feel like it

597
00:51:28,970 --> 00:51:34,000
doesn't make it doesn't help much too
kind to sing call them

598
00:51:34,000 --> 00:51:40,150
sinkholes are usually in my opinion used
for domains that you know you don't

599
00:51:40,150 --> 00:51:44,010
expect them from the malware or you know
them from the Geograph them so you can

600
00:51:44,010 --> 00:51:49,339
go and just practically kind of try to
sniff the back at the traffic from

601
00:51:49,339 --> 00:51:53,980
infected machines but as for UK's don't
think it would help much

