1
00:00:00,350 --> 00:00:08,300
[Music]

2
00:00:08,300 --> 00:00:11,250
like to introduce the next speaker Chris

3
00:00:11,250 --> 00:00:14,849
Sistrunk so Chris is a newly minted

4
00:00:14,849 --> 00:00:18,600
principal consultant at mandiant thank

5
00:00:18,600 --> 00:00:21,390
you thank you congratulations he'll be

6
00:00:21,390 --> 00:00:22,740
talking about digital forensics and

7
00:00:22,740 --> 00:00:24,869
incident response for PLC's and other

8
00:00:24,869 --> 00:00:27,029
embedded devices all right Chris all

9
00:00:27,029 --> 00:00:27,810
right thanks Rob

10
00:00:27,810 --> 00:00:30,840
well glad you're here I know everybody's

11
00:00:30,840 --> 00:00:32,969
getting sleepy after lunch so I'll try

12
00:00:32,969 --> 00:00:35,840
to keep this entertaining this is a

13
00:00:35,840 --> 00:00:38,309
entitled what's the difference for ICS

14
00:00:38,309 --> 00:00:40,500
I'm trying to make that the best pun of

15
00:00:40,500 --> 00:00:43,140
the conference so hopefully you enjoy

16
00:00:43,140 --> 00:00:47,700
that my co-presenter wasn't able to be

17
00:00:47,700 --> 00:00:50,270
here today because he got caught up in a

18
00:00:50,270 --> 00:00:52,980
flight cancellation so Josh Triplett

19
00:00:52,980 --> 00:00:55,530
also was important in this research in

20
00:00:55,530 --> 00:00:58,379
this this effort so we're gonna talk

21
00:00:58,379 --> 00:00:59,940
about digital forensics and Incident

22
00:00:59,940 --> 00:01:04,349
Response in general has engineer we

23
00:01:04,349 --> 00:01:06,420
might call it root cause analysis you

24
00:01:06,420 --> 00:01:08,939
know after you know I had to do that

25
00:01:08,939 --> 00:01:10,140
when I was at the Power Company like

26
00:01:10,140 --> 00:01:13,369
when the Super Bowl has a power outage

27
00:01:13,369 --> 00:01:16,470
you get phone calls and then you have to

28
00:01:16,470 --> 00:01:18,390
figure out what happened I worked at

29
00:01:18,390 --> 00:01:20,159
that power company we're going to talk

30
00:01:20,159 --> 00:01:23,850
about digital forensics for ICS so

31
00:01:23,850 --> 00:01:25,259
that's not really talked about a whole

32
00:01:25,259 --> 00:01:27,659
lot some of you in here know about it

33
00:01:27,659 --> 00:01:30,210
and can do it very technical folks

34
00:01:30,210 --> 00:01:33,299
especially some of you who do a lot of

35
00:01:33,299 --> 00:01:35,990
this deep research with embedded devices

36
00:01:35,990 --> 00:01:38,640
you know what be collect what do you

37
00:01:38,640 --> 00:01:40,920
analyze and then I'm gonna go over some

38
00:01:40,920 --> 00:01:45,090
examples of two devices it's kind of a

39
00:01:45,090 --> 00:01:46,740
little preview of what we're gonna cover

40
00:01:46,740 --> 00:01:49,770
in our class on Friday as well a little

41
00:01:49,770 --> 00:01:52,710
overview you know instant response

42
00:01:52,710 --> 00:01:54,869
you're right something happened

43
00:01:54,869 --> 00:01:56,579
something's on fire you got to go put it

44
00:01:56,579 --> 00:01:59,310
out well first thing you do is you have

45
00:01:59,310 --> 00:02:01,860
to assess the situation see what's

46
00:02:01,860 --> 00:02:04,829
happening what is the damage it do

47
00:02:04,829 --> 00:02:07,380
triage you got to figure out just like

48
00:02:07,380 --> 00:02:10,470
you know emergency response crews like

49
00:02:10,470 --> 00:02:13,290
fire or health if you have a heart

50
00:02:13,290 --> 00:02:14,030
attack

51
00:02:14,030 --> 00:02:17,340
what do we do we go define objectives

52
00:02:17,340 --> 00:02:18,900
try to stop the bleeding

53
00:02:18,900 --> 00:02:22,110
and collect evidence from the devices

54
00:02:22,110 --> 00:02:25,530
themselves and in this specific instance

55
00:02:25,530 --> 00:02:26,850
later in the talk we're going to be

56
00:02:26,850 --> 00:02:28,650
talking about just the control system

57
00:02:28,650 --> 00:02:31,680
devices but we also know dfi are from

58
00:02:31,680 --> 00:02:33,950
doing in Windows and Linux and other

59
00:02:33,950 --> 00:02:37,680
popular operating systems as well do the

60
00:02:37,680 --> 00:02:39,540
analysis so if you're doing a memory

61
00:02:39,540 --> 00:02:42,270
analysis and/or you just file changes

62
00:02:42,270 --> 00:02:44,270
anything that could be changed

63
00:02:44,270 --> 00:02:47,610
communicate what happened on a regular

64
00:02:47,610 --> 00:02:51,660
basis to the key stakeholders you know

65
00:02:51,660 --> 00:02:54,570
up to upper management even and then

66
00:02:54,570 --> 00:02:56,340
have a remediation plan what are we

67
00:02:56,340 --> 00:02:58,200
going to do if there's an active

68
00:02:58,200 --> 00:03:00,000
intruder what are we going to do to kick

69
00:03:00,000 --> 00:03:01,980
them out and you know make sure that

70
00:03:01,980 --> 00:03:04,020
they don't come back and then you've got

71
00:03:04,020 --> 00:03:07,410
a document what happened so you'll have

72
00:03:07,410 --> 00:03:09,959
a good you know use case if it ever

73
00:03:09,959 --> 00:03:14,760
happens again you know what to do so if

74
00:03:14,760 --> 00:03:18,959
you take if you take collect and analyze

75
00:03:18,959 --> 00:03:21,900
that's the digital forensics part of

76
00:03:21,900 --> 00:03:23,730
that so you're going to collect data

77
00:03:23,730 --> 00:03:27,090
files operating system like volatile and

78
00:03:27,090 --> 00:03:29,580
non-volatile memory network traffic

79
00:03:29,580 --> 00:03:34,440
applications anything that can be in a

80
00:03:34,440 --> 00:03:38,220
in a operating system any computer and

81
00:03:38,220 --> 00:03:40,080
it doesn't matter if it's a modern

82
00:03:40,080 --> 00:03:42,630
computer or ancient computer like what

83
00:03:42,630 --> 00:03:47,190
we do with anything that we can look at

84
00:03:47,190 --> 00:03:50,459
digitally and they're very interesting

85
00:03:50,459 --> 00:03:53,610
things that we can learn about what we

86
00:03:53,610 --> 00:03:56,580
collect and then compare that to what is

87
00:03:56,580 --> 00:03:59,519
known good and what we designed the

88
00:03:59,519 --> 00:04:02,250
system to be doing the examination and

89
00:04:02,250 --> 00:04:04,230
analysis and reporting if has anybody

90
00:04:04,230 --> 00:04:08,340
ever read the instant response book ok

91
00:04:08,340 --> 00:04:11,459
if you haven't and if you are interested

92
00:04:11,459 --> 00:04:13,680
in doing digital forensics and instant

93
00:04:13,680 --> 00:04:16,798
response this is an excellent book a lot

94
00:04:16,798 --> 00:04:18,899
of the things that are talked about in

95
00:04:18,899 --> 00:04:22,560
that book apply can apply to control

96
00:04:22,560 --> 00:04:26,310
systems even on the you know HMI side

97
00:04:26,310 --> 00:04:30,600
this and also nist SP hundred 800 series

98
00:04:30,600 --> 00:04:35,280
- 86 these are really great resources if

99
00:04:35,280 --> 00:04:38,130
you want to learn more about general DF

100
00:04:38,130 --> 00:04:42,150
ir and in traditional DF ir with you

101
00:04:42,150 --> 00:04:44,190
know windows and linux and whatnot you

102
00:04:44,190 --> 00:04:47,760
have a good set of tools man ant we

103
00:04:47,760 --> 00:04:49,860
wrote red line it's been an industry

104
00:04:49,860 --> 00:04:52,320
standards free tool to do Windows

105
00:04:52,320 --> 00:04:55,860
analysis also there's open source tool

106
00:04:55,860 --> 00:04:59,220
called volatility excellent I mean it's

107
00:04:59,220 --> 00:05:02,370
easy even an electrical engineer a skate

108
00:05:02,370 --> 00:05:04,530
engineer can do it I last year they

109
00:05:04,530 --> 00:05:07,740
probably had a sans ICS challenge where

110
00:05:07,740 --> 00:05:09,360
he had to use redline or volatility to

111
00:05:09,360 --> 00:05:11,160
look at memory and I was able to do it

112
00:05:11,160 --> 00:05:14,520
and that was pretty fun but it's just

113
00:05:14,520 --> 00:05:18,419
because those tools are so well kept up

114
00:05:18,419 --> 00:05:19,830
to date and have a lot of features

115
00:05:19,830 --> 00:05:22,410
there's a lot of websites like malware

116
00:05:22,410 --> 00:05:25,500
in virustotal where people do you know

117
00:05:25,500 --> 00:05:28,050
sandbox analysis of strange binaries

118
00:05:28,050 --> 00:05:29,610
that they find or malware whatnot

119
00:05:29,610 --> 00:05:31,979
there's cheat sheets like the sans dfi

120
00:05:31,979 --> 00:05:33,890
are a cheat sheet that shows you how to

121
00:05:33,890 --> 00:05:37,380
do digital forensics and obviously books

122
00:05:37,380 --> 00:05:41,610
like the one I mentioned but what's the

123
00:05:41,610 --> 00:05:44,880
difference for control systems and we

124
00:05:44,880 --> 00:05:48,330
don't have all that stuff so let's break

125
00:05:48,330 --> 00:05:54,979
down the that list of instant response

126
00:05:54,979 --> 00:05:57,960
things that we want to do and see if it

127
00:05:57,960 --> 00:06:01,470
applies to you know control systems and

128
00:06:01,470 --> 00:06:03,030
how it applies so assessing the

129
00:06:03,030 --> 00:06:05,039
situation doing the triage that's pretty

130
00:06:05,039 --> 00:06:06,539
similar it's not going to be any change

131
00:06:06,539 --> 00:06:08,780
it's going to be similar to your

132
00:06:08,780 --> 00:06:11,430
disaster recovery plan for your control

133
00:06:11,430 --> 00:06:13,080
system that you've already have in case

134
00:06:13,080 --> 00:06:15,150
of a fire or any other kind of safety

135
00:06:15,150 --> 00:06:16,770
related a lot of the things are going to

136
00:06:16,770 --> 00:06:18,990
apply here when you define your

137
00:06:18,990 --> 00:06:21,660
objectives that's a little different you

138
00:06:21,660 --> 00:06:26,910
have physical processes that you know

139
00:06:26,910 --> 00:06:32,580
you can't just return Isis in the way

140
00:06:32,580 --> 00:06:35,820
same way you do an IT system you have to

141
00:06:35,820 --> 00:06:37,409
make sure it's done quickly and safely

142
00:06:37,409 --> 00:06:40,080
because uptime is important you make a

143
00:06:40,080 --> 00:06:42,090
money in your industrial processes and

144
00:06:42,090 --> 00:06:44,610
also safety is critical you don't want

145
00:06:44,610 --> 00:06:47,129
to get anyone hurt when you collect your

146
00:06:47,129 --> 00:06:49,379
evidence that's also that something

147
00:06:49,379 --> 00:06:52,530
that's different from regular IT you

148
00:06:52,530 --> 00:06:54,300
have real-time operating systems where

149
00:06:54,300 --> 00:06:56,280
there's no tools and you have strange

150
00:06:56,280 --> 00:06:59,639
protocols that IT folks don't understand

151
00:06:59,639 --> 00:07:01,319
they don't know the control system

152
00:07:01,319 --> 00:07:03,659
protocol so you really have to do a lot

153
00:07:03,659 --> 00:07:04,860
of manual collection

154
00:07:04,860 --> 00:07:08,580
same thing with analysis you have to

155
00:07:08,580 --> 00:07:11,340
have someone who knows how the ICS was

156
00:07:11,340 --> 00:07:14,699
designed to know what's normal and

157
00:07:14,699 --> 00:07:17,759
what's not normal and that is really

158
00:07:17,759 --> 00:07:20,729
important there's really no ICS specific

159
00:07:20,729 --> 00:07:24,870
dfi our tools that that we know of until

160
00:07:24,870 --> 00:07:26,969
this week we're going to be talking I'm

161
00:07:26,969 --> 00:07:28,710
going to talk later about the tool that

162
00:07:28,710 --> 00:07:31,469
Josh wrote it's going to be hopefully

163
00:07:31,469 --> 00:07:34,530
the first of multiple tools I'm trying

164
00:07:34,530 --> 00:07:36,199
to get you guys interested in

165
00:07:36,199 --> 00:07:38,310
contributing to that it's going to be

166
00:07:38,310 --> 00:07:41,490
really excellent communication obviously

167
00:07:41,490 --> 00:07:42,629
that's going to be similar and

168
00:07:42,629 --> 00:07:46,919
remediation plan that might be a little

169
00:07:46,919 --> 00:07:48,900
different as well because you can't just

170
00:07:48,900 --> 00:07:51,419
reimage a PLC that's what they do is you

171
00:07:51,419 --> 00:07:55,229
know you have a conflict we're on XP on

172
00:07:55,229 --> 00:07:57,690
you know that they might just reimage

173
00:07:57,690 --> 00:07:59,849
that machine and the control system

174
00:07:59,849 --> 00:08:03,389
they're gonna take a new one and put it

175
00:08:03,389 --> 00:08:05,370
back in you know place they have to

176
00:08:05,370 --> 00:08:07,139
completely replace the system in some

177
00:08:07,139 --> 00:08:09,479
some cases if you know if that's even

178
00:08:09,479 --> 00:08:12,180
possible that so you've got those

179
00:08:12,180 --> 00:08:13,860
constraints and then the last thing

180
00:08:13,860 --> 00:08:18,210
document obviously that's the same so

181
00:08:18,210 --> 00:08:21,090
yeah you have an anomaly has occurred

182
00:08:21,090 --> 00:08:24,330
you might be let's talk about what you

183
00:08:24,330 --> 00:08:27,270
would be as if you were an analyst

184
00:08:27,270 --> 00:08:30,060
sitting in a sock for a control system

185
00:08:30,060 --> 00:08:31,830
yeah well there's probably not many of

186
00:08:31,830 --> 00:08:34,320
those I know some of you work in control

187
00:08:34,320 --> 00:08:37,250
system socks there's a very few of us

188
00:08:37,250 --> 00:08:39,809
but the same anomaly has occurred you

189
00:08:39,809 --> 00:08:42,479
have strange networked activity strange

190
00:08:42,479 --> 00:08:45,390
behavior now how do we investigate that

191
00:08:45,390 --> 00:08:48,510
that's what we want to take that alert

192
00:08:48,510 --> 00:08:50,730
and drill down into the process and see

193
00:08:50,730 --> 00:08:52,930
what could it be is it known bad

194
00:08:52,930 --> 00:08:56,080
is it unknown bad so here's an example

195
00:08:56,080 --> 00:09:00,190
of well something's not working right

196
00:09:00,190 --> 00:09:02,440
with this rtu well we look in the

197
00:09:02,440 --> 00:09:04,620
configuration some of the configurations

198
00:09:04,620 --> 00:09:08,770
are you can edit with notepad so oh we

199
00:09:08,770 --> 00:09:10,600
looked in the serial port settings it

200
00:09:10,600 --> 00:09:13,720
was set for 2600 instead of 2400 so

201
00:09:13,720 --> 00:09:16,330
someone set the wrong baud rate so that

202
00:09:16,330 --> 00:09:18,220
happens a lot you have a lot of miss

203
00:09:18,220 --> 00:09:23,589
configurations so that's a known bad we

204
00:09:23,589 --> 00:09:25,060
have miss configurations all the time

205
00:09:25,060 --> 00:09:26,890
but you didn't know that until you did

206
00:09:26,890 --> 00:09:30,310
some investigation okay so when do we

207
00:09:30,310 --> 00:09:32,680
escalate this to a security incident you

208
00:09:32,680 --> 00:09:36,820
know is it so unknown we've got to and

209
00:09:36,820 --> 00:09:38,709
it's not something it's not like a Miss

210
00:09:38,709 --> 00:09:40,450
configuration something else is going on

211
00:09:40,450 --> 00:09:43,480
something's fishy something's questions

212
00:09:43,480 --> 00:09:45,399
you have too many questions as as an

213
00:09:45,399 --> 00:09:48,760
analyst who do we call who do we call we

214
00:09:48,760 --> 00:09:50,649
call the engineers that know the system

215
00:09:50,649 --> 00:09:53,110
and you know you know all the way up to

216
00:09:53,110 --> 00:09:56,860
vendors and PR and safety here's another

217
00:09:56,860 --> 00:09:59,589
example well oh well it was a squirrel

218
00:09:59,589 --> 00:10:02,440
on a substation okay okay so that's

219
00:10:02,440 --> 00:10:03,339
that's pretty normal

220
00:10:03,339 --> 00:10:05,350
well what if it's this unknown thing

221
00:10:05,350 --> 00:10:07,690
that's what we have to you know ask a

222
00:10:07,690 --> 00:10:10,060
lots and lots of questions about to be

223
00:10:10,060 --> 00:10:12,600
prepared for that and your environment

224
00:10:12,600 --> 00:10:16,959
whatever you do don't turn off and on

225
00:10:16,959 --> 00:10:21,130
the plc if it's got problems you know

226
00:10:21,130 --> 00:10:23,170
you familiar with these a lot of times

227
00:10:23,170 --> 00:10:25,930
the logs will just disappear all right

228
00:10:25,930 --> 00:10:28,870
and sometimes if you don't react fast

229
00:10:28,870 --> 00:10:32,560
enough the logs will roll over so

230
00:10:32,560 --> 00:10:34,810
there's a lot of interesting things we

231
00:10:34,810 --> 00:10:37,660
want to preserve the logs and any

232
00:10:37,660 --> 00:10:41,410
digital forensics evidence the best as

233
00:10:41,410 --> 00:10:44,589
possible so if there's a suspicious

234
00:10:44,589 --> 00:10:46,600
thing going on you know Jason Larson

235
00:10:46,600 --> 00:10:50,550
writes a plc rootkit just as an example

236
00:10:50,550 --> 00:10:54,279
you know it's we know he's been in there

237
00:10:54,279 --> 00:10:56,110
and he's touched it we don't want to

238
00:10:56,110 --> 00:10:57,670
reboot it we want to find out what he's

239
00:10:57,670 --> 00:11:01,620
done so how do we do this collection

240
00:11:01,620 --> 00:11:05,020
well we have to use the tools that the

241
00:11:05,020 --> 00:11:06,370
vendors give us and some

242
00:11:06,370 --> 00:11:08,740
other tools that are open-source so use

243
00:11:08,740 --> 00:11:13,420
terminal or teraterm or putty you might

244
00:11:13,420 --> 00:11:15,760
use in this example I'm going to cover

245
00:11:15,760 --> 00:11:18,130
two devices one from GE and one from

246
00:11:18,130 --> 00:11:19,630
Schweitzer so we're going to use those

247
00:11:19,630 --> 00:11:22,270
tools and you know a serial cable

248
00:11:22,270 --> 00:11:23,470
sometimes the only way you can get

249
00:11:23,470 --> 00:11:26,620
information is with a good old rs-232

250
00:11:26,620 --> 00:11:31,750
console cable right so for embedded

251
00:11:31,750 --> 00:11:33,640
devices specifically so I'm gonna skip

252
00:11:33,640 --> 00:11:35,980
the HMI stuff that's kind of more you

253
00:11:35,980 --> 00:11:38,020
know windows-based stuff that's been

254
00:11:38,020 --> 00:11:41,320
well covered in the industry a lot of

255
00:11:41,320 --> 00:11:43,600
tools there so what what can we collect

256
00:11:43,600 --> 00:11:45,870
well break it down into two things have

257
00:11:45,870 --> 00:11:49,089
physical data and then you have digital

258
00:11:49,089 --> 00:11:50,800
data well a physical thing we want to

259
00:11:50,800 --> 00:11:53,260
know when what what it is what firmware

260
00:11:53,260 --> 00:11:56,890
where it's at what are the LEDs so

261
00:11:56,890 --> 00:11:59,589
whenever something happened in a

262
00:11:59,589 --> 00:12:02,350
substation and I get a call our T's down

263
00:12:02,350 --> 00:12:05,260
that's so-and-so substation well how do

264
00:12:05,260 --> 00:12:07,750
you know it's down well it's not working

265
00:12:07,750 --> 00:12:10,029
well okay tell me what the lights say on

266
00:12:10,029 --> 00:12:12,160
the front well they're they're blinking

267
00:12:12,160 --> 00:12:15,220
red okay that's a bad sign or if they're

268
00:12:15,220 --> 00:12:16,570
blinking green well there's something

269
00:12:16,570 --> 00:12:18,550
else going on so a lot of the front

270
00:12:18,550 --> 00:12:22,570
panel LEDs tell you right there what the

271
00:12:22,570 --> 00:12:26,440
problem could be power consumption this

272
00:12:26,440 --> 00:12:27,370
one's really interesting

273
00:12:27,370 --> 00:12:31,480
do you guys know Mark Pfeffer oh right

274
00:12:31,480 --> 00:12:34,870
he had a story once they found an HMI

275
00:12:34,870 --> 00:12:37,270
that was running hot they noticed it

276
00:12:37,270 --> 00:12:39,760
with their FLIR camera one HM I was

277
00:12:39,760 --> 00:12:41,920
running hotter than the other and when

278
00:12:41,920 --> 00:12:43,660
they did some investigation they found a

279
00:12:43,660 --> 00:12:47,080
Trojan had been installed I guess by USB

280
00:12:47,080 --> 00:12:49,660
got infected and there was a Trojan on

281
00:12:49,660 --> 00:12:51,670
that on that HMI so they found it by

282
00:12:51,670 --> 00:12:55,959
using temperature camera so and also

283
00:12:55,959 --> 00:12:58,690
physical access so evidence of tampering

284
00:12:58,690 --> 00:13:02,740
did someone break in to a place cut a

285
00:13:02,740 --> 00:13:06,339
fence things like that digital data you

286
00:13:06,339 --> 00:13:09,400
know user accounts running configuration

287
00:13:09,400 --> 00:13:12,190
last known good if there's like a USB or

288
00:13:12,190 --> 00:13:16,300
a CD up in the in the RTO cabinet or in

289
00:13:16,300 --> 00:13:19,180
your central database running firmware

290
00:13:19,180 --> 00:13:20,230
proof firmware so some

291
00:13:20,230 --> 00:13:22,150
times we've had people upload rogue

292
00:13:22,150 --> 00:13:24,790
firmware before that they didn't weren't

293
00:13:24,790 --> 00:13:26,110
being malicious they just put the wrong

294
00:13:26,110 --> 00:13:29,590
firmware on there a lot of these devices

295
00:13:29,590 --> 00:13:32,980
show their CPU usage percentage and also

296
00:13:32,980 --> 00:13:35,440
memory and that's very helpful when

297
00:13:35,440 --> 00:13:37,390
we're doing collection running processes

298
00:13:37,390 --> 00:13:39,820
and then a lot of other things

299
00:13:39,820 --> 00:13:41,800
logs memory dumps see that's more

300
00:13:41,800 --> 00:13:45,130
advanced stuff that not every PLC can do

301
00:13:45,130 --> 00:13:49,840
but we're starting to see that how can

302
00:13:49,840 --> 00:13:52,420
we find evil or ways for able to do evil

303
00:13:52,420 --> 00:13:54,730
so that's things that are misconfigured

304
00:13:54,730 --> 00:13:58,480
or not hardened a feature that an

305
00:13:58,480 --> 00:14:01,540
attacker could use first responders

306
00:14:01,540 --> 00:14:03,250
you're going to you're going to rely on

307
00:14:03,250 --> 00:14:05,410
your control system engineers and your

308
00:14:05,410 --> 00:14:08,140
technicians because they know those

309
00:14:08,140 --> 00:14:10,270
PLC's backwards and Forge generally and

310
00:14:10,270 --> 00:14:12,370
they already know how to use those tools

311
00:14:12,370 --> 00:14:15,520
that they are to use every day so what

312
00:14:15,520 --> 00:14:17,230
are the user and event logs reveal you

313
00:14:17,230 --> 00:14:20,410
know well what does a configuration

314
00:14:20,410 --> 00:14:22,630
master firmware is it the same framer

315
00:14:22,630 --> 00:14:24,430
that we had approved from the factory

316
00:14:24,430 --> 00:14:27,400
acceptance test and these things can

317
00:14:27,400 --> 00:14:30,460
happen be analyzed pretty quickly when

318
00:14:30,460 --> 00:14:32,440
we do the analysis piece is the

319
00:14:32,440 --> 00:14:34,240
configuration and a ladder logic correct

320
00:14:34,240 --> 00:14:37,240
so like in the case of INL you know you

321
00:14:37,240 --> 00:14:40,390
went in and changed the switcher relay

322
00:14:40,390 --> 00:14:42,520
settings well if you take a relay

323
00:14:42,520 --> 00:14:43,810
engineering someone looks at the

324
00:14:43,810 --> 00:14:45,550
configuration set yeah that's not right

325
00:14:45,550 --> 00:14:46,840
someone's not supposed to allow the

326
00:14:46,840 --> 00:14:50,350
breaker to desync at you know hundred

327
00:14:50,350 --> 00:14:51,910
twenty degrees out of phase no that's

328
00:14:51,910 --> 00:14:54,160
not normal but you'd have to have that

329
00:14:54,160 --> 00:14:55,720
knowledge and you have to find an

330
00:14:55,720 --> 00:14:57,340
engineer with that knowledge to know

331
00:14:57,340 --> 00:15:00,160
that so that might take a little more

332
00:15:00,160 --> 00:15:03,660
time as we go down the time scale here

333
00:15:03,660 --> 00:15:07,630
are the communications normals compared

334
00:15:07,630 --> 00:15:08,860
to known good so you may have to do a

335
00:15:08,860 --> 00:15:12,940
packet capture serial or or network I've

336
00:15:12,940 --> 00:15:15,550
had to send folks out to substations to

337
00:15:15,550 --> 00:15:17,920
do cereal packet captures before to find

338
00:15:17,920 --> 00:15:19,960
problems and it takes a while to do that

339
00:15:19,960 --> 00:15:21,460
so it's takes a little bit more time as

340
00:15:21,460 --> 00:15:25,930
we get into the operating system and in

341
00:15:25,930 --> 00:15:28,150
any memory analysis that's going to take

342
00:15:28,150 --> 00:15:31,150
even more time that's why you see people

343
00:15:31,150 --> 00:15:33,670
want to hear oh malware attack

344
00:15:33,670 --> 00:15:36,160
and you wanna the news story sell them I

345
00:15:36,160 --> 00:15:37,720
pick on Blake and some of the other

346
00:15:37,720 --> 00:15:38,709
reporters they want to get that news

347
00:15:38,709 --> 00:15:39,550
story out quick

348
00:15:39,550 --> 00:15:43,810
well analysis takes a while it's not

349
00:15:43,810 --> 00:15:45,550
instantaneous the same thing you've got

350
00:15:45,550 --> 00:15:47,320
to dig through all the embedded

351
00:15:47,320 --> 00:15:49,779
operating system files that you can

352
00:15:49,779 --> 00:15:52,779
capture any data at rest then in transit

353
00:15:52,779 --> 00:15:56,140
and and any volatile memory if that's

354
00:15:56,140 --> 00:15:57,970
even possible to look for you know a

355
00:15:57,970 --> 00:16:00,430
potential route get all that stuff takes

356
00:16:00,430 --> 00:16:04,570
time and by the time you know some CEO

357
00:16:04,570 --> 00:16:06,040
wants to do attribution that's gonna

358
00:16:06,040 --> 00:16:08,620
take even if it's it may not even be

359
00:16:08,620 --> 00:16:12,820
possible so let's do some DF IR on to

360
00:16:12,820 --> 00:16:14,980
example Subsection artis and this is

361
00:16:14,980 --> 00:16:17,649
just an example of two devices that I

362
00:16:17,649 --> 00:16:20,050
have your devices may can be completely

363
00:16:20,050 --> 00:16:20,589
different

364
00:16:20,589 --> 00:16:23,050
but this kind of methodology is what we

365
00:16:23,050 --> 00:16:26,170
want to start sharing and be expecting

366
00:16:26,170 --> 00:16:28,720
as people do more research and write

367
00:16:28,720 --> 00:16:31,779
more malicious stuff it's starting to

368
00:16:31,779 --> 00:16:37,060
happen read manual just like Apollo 11

369
00:16:37,060 --> 00:16:38,890
they really had manuals for everything

370
00:16:38,890 --> 00:16:42,279
so the these the first one is GE d 20 M

371
00:16:42,279 --> 00:16:44,410
X that's the newer version of the older

372
00:16:44,410 --> 00:16:48,010
D 20 they have excellent manuals it's a

373
00:16:48,010 --> 00:16:51,490
power quick to pro processor a gig of

374
00:16:51,490 --> 00:16:53,350
ram

375
00:16:53,350 --> 00:16:56,320
they've got VX works real-time operating

376
00:16:56,320 --> 00:17:00,430
system on there so pretty popular so a

377
00:17:00,430 --> 00:17:02,199
lot of these things on the cover and

378
00:17:02,199 --> 00:17:04,480
this apply to your devices so like

379
00:17:04,480 --> 00:17:06,880
Emerson they have VxWorks running on

380
00:17:06,880 --> 00:17:11,470
your PLC's Dave Foose so the tools to

381
00:17:11,470 --> 00:17:14,410
use here is use the manual that comes

382
00:17:14,410 --> 00:17:18,189
with so it's not open source you might

383
00:17:18,189 --> 00:17:19,900
be able to find a copy of the manual and

384
00:17:19,900 --> 00:17:23,049
you know if you own these hopefully the

385
00:17:23,049 --> 00:17:25,059
SG config software terminal like

386
00:17:25,059 --> 00:17:28,329
territory putty and then winscp and they

387
00:17:28,329 --> 00:17:30,940
actually have a good guide in Chapter 11

388
00:17:30,940 --> 00:17:33,190
on troubleshooting so it talks about how

389
00:17:33,190 --> 00:17:34,840
to troubleshoot serial communications

390
00:17:34,840 --> 00:17:37,270
firmware mismatches shell commands and

391
00:17:37,270 --> 00:17:39,340
locks all the perfect things that we

392
00:17:39,340 --> 00:17:41,590
want to collect when we're doing digital

393
00:17:41,590 --> 00:17:46,480
forensics as an example we looked at

394
00:17:46,480 --> 00:17:47,420
these three

395
00:17:47,420 --> 00:17:49,700
different manuals you know this may not

396
00:17:49,700 --> 00:17:51,350
be interesting to you if you don't have

397
00:17:51,350 --> 00:17:52,910
these devices but I'm just giving you

398
00:17:52,910 --> 00:17:55,430
this as an example they have the

399
00:17:55,430 --> 00:17:57,320
controller user manual on

400
00:17:57,320 --> 00:17:59,690
troubleshooting it shows you how to use

401
00:17:59,690 --> 00:18:01,970
the shells there's actually three shells

402
00:18:01,970 --> 00:18:06,980
and this the two important logs anytime

403
00:18:06,980 --> 00:18:11,570
I had a rtu problem I had asked them to

404
00:18:11,570 --> 00:18:13,040
look at the air log on the user log so

405
00:18:13,040 --> 00:18:14,720
the air log tells you anything that

406
00:18:14,720 --> 00:18:17,750
there's wrong error wise and the

407
00:18:17,750 --> 00:18:19,160
configuration or if there's a warning

408
00:18:19,160 --> 00:18:21,140
and they actually have documentation for

409
00:18:21,140 --> 00:18:22,970
every single error and warning in their

410
00:18:22,970 --> 00:18:26,300
manuals excellent resource also the user

411
00:18:26,300 --> 00:18:28,970
log it actually logs every keystroke in

412
00:18:28,970 --> 00:18:33,160
this device and it gets put a syslog

413
00:18:33,160 --> 00:18:35,480
perfect opportunity to start collecting

414
00:18:35,480 --> 00:18:38,360
syslog if you have these collect it and

415
00:18:38,360 --> 00:18:41,000
then you can see it's kind of hard to

416
00:18:41,000 --> 00:18:43,100
see with this screen but you can get a

417
00:18:43,100 --> 00:18:44,750
copy of the presentation later but you

418
00:18:44,750 --> 00:18:47,930
can see who the user was logged in and

419
00:18:47,930 --> 00:18:52,220
they typed you know it shows ve are

420
00:18:52,220 --> 00:18:54,890
typed ve are in that and it actually

421
00:18:54,890 --> 00:18:56,630
shows every keystroke that they that

422
00:18:56,630 --> 00:18:58,850
they type it's really it's really great

423
00:18:58,850 --> 00:19:00,980
for forensics so there's three shells

424
00:19:00,980 --> 00:19:03,490
there's one that belongs to the d20 now

425
00:19:03,490 --> 00:19:06,200
itself and then there's two that are

426
00:19:06,200 --> 00:19:10,190
part of VxWorks so there's the one

427
00:19:10,190 --> 00:19:12,610
that's the d20 shell is the most popular

428
00:19:12,610 --> 00:19:16,520
and the one that most people use if the

429
00:19:16,520 --> 00:19:18,680
go down the VxWorks level you're getting

430
00:19:18,680 --> 00:19:20,990
into things that GE would ask you to do

431
00:19:20,990 --> 00:19:23,510
so the you might not have an expertise

432
00:19:23,510 --> 00:19:26,030
in that GE definitely will and then the

433
00:19:26,030 --> 00:19:27,800
people that are familiar with VX works

434
00:19:27,800 --> 00:19:29,870
well this will apply to them as well so

435
00:19:29,870 --> 00:19:32,450
if you've seen that movie he doesn't

436
00:19:32,450 --> 00:19:36,350
know how to use the three seashells yeah

437
00:19:36,350 --> 00:19:40,600
and and so on them in the main shell

438
00:19:40,600 --> 00:19:44,000
there's all this is a help printout so

439
00:19:44,000 --> 00:19:45,350
you can see all the different commands

440
00:19:45,350 --> 00:19:50,930
we can see basically all the things that

441
00:19:50,930 --> 00:19:53,000
we would if we're doing collecting data

442
00:19:53,000 --> 00:19:55,100
also attackers might want to use this

443
00:19:55,100 --> 00:19:57,500
shell too because you can actually write

444
00:19:57,500 --> 00:19:58,720
to memory

445
00:19:58,720 --> 00:20:02,110
if you're connected serially so you know

446
00:20:02,110 --> 00:20:04,750
that's perfect for attackers and

447
00:20:04,750 --> 00:20:07,539
defenders and I'm obviously a defender

448
00:20:07,539 --> 00:20:09,340
here so we want to be able to see what

449
00:20:09,340 --> 00:20:11,830
commands we have we can we're going to

450
00:20:11,830 --> 00:20:13,419
go over some of these shells but like

451
00:20:13,419 --> 00:20:16,049
for instance and I Fi and F shows the IP

452
00:20:16,049 --> 00:20:18,400
information so you can look at the IP

453
00:20:18,400 --> 00:20:22,900
address what not so when we connect to

454
00:20:22,900 --> 00:20:25,870
this it's a very common test we can look

455
00:20:25,870 --> 00:20:27,820
at the running configuration we can get

456
00:20:27,820 --> 00:20:30,429
the last known good configuration X it

457
00:20:30,429 --> 00:20:32,440
might be in the USB drive on the cabinet

458
00:20:32,440 --> 00:20:34,659
you know whatever how everybody does it

459
00:20:34,659 --> 00:20:37,210
a type IMG right find the running

460
00:20:37,210 --> 00:20:42,840
firmware query Ram you can my slides

461
00:20:42,840 --> 00:20:45,730
shifted there but the last one is query

462
00:20:45,730 --> 00:20:48,490
processes so you can see the pids so you

463
00:20:48,490 --> 00:20:50,200
can see what applications are running

464
00:20:50,200 --> 00:20:52,590
that's really great

465
00:20:52,590 --> 00:20:55,990
Syria analyzer so this is a seer

466
00:20:55,990 --> 00:20:59,080
analyzer before we had Wireshark we use

467
00:20:59,080 --> 00:21:02,530
this and you can look this is an example

468
00:21:02,530 --> 00:21:04,750
of dnp3 traffic going between the master

469
00:21:04,750 --> 00:21:07,510
station and the d 20s response so I had

470
00:21:07,510 --> 00:21:09,940
to do this a lot and a lot of your folks

471
00:21:09,940 --> 00:21:11,830
that may have to do this already this is

472
00:21:11,830 --> 00:21:15,610
very common to do so for finding

473
00:21:15,610 --> 00:21:20,070
especially finding miss configurations

474
00:21:20,070 --> 00:21:22,750
you can look at system information and

475
00:21:22,750 --> 00:21:26,380
also you can dump memory with this and

476
00:21:26,380 --> 00:21:31,870
so dumping a gig of ram is possible and

477
00:21:31,870 --> 00:21:32,710
the VxWorks

478
00:21:32,710 --> 00:21:34,390
I was talk about the sea shell real

479
00:21:34,390 --> 00:21:36,640
quick and the command shell c shell is

480
00:21:36,640 --> 00:21:39,460
just another smaller shell and VxWorks

481
00:21:39,460 --> 00:21:41,890
and then you can drill down into the

482
00:21:41,890 --> 00:21:44,650
command shell which gives you net stat

483
00:21:44,650 --> 00:21:47,830
IP firewalls syslog show devices show

484
00:21:47,830 --> 00:21:51,400
driver show history I have config which

485
00:21:51,400 --> 00:21:55,390
is you know that the network interfaces

486
00:21:55,390 --> 00:21:57,700
route and eight you can even do a peek

487
00:21:57,700 --> 00:21:59,710
app so it in the manual tells you how to

488
00:21:59,710 --> 00:22:04,030
store pcap on the PLC if you can't put

489
00:22:04,030 --> 00:22:07,480
in a tap yourself so that's perfect use

490
00:22:07,480 --> 00:22:10,020
there

491
00:22:10,430 --> 00:22:13,340
okay so let's think negatively now so

492
00:22:13,340 --> 00:22:16,400
Josh would be talking here and let's

493
00:22:16,400 --> 00:22:20,090
let's inject memory and with the command

494
00:22:20,090 --> 00:22:22,730
em in the VxWorks shell so we can say m

495
00:22:22,730 --> 00:22:26,600
and we can write dead beef into just a

496
00:22:26,600 --> 00:22:28,340
random place in memory we did that and

497
00:22:28,340 --> 00:22:30,350
we collect volatile memory using the

498
00:22:30,350 --> 00:22:33,200
dumped memory command D in the right and

499
00:22:33,200 --> 00:22:36,860
you can see it says dead beef so in live

500
00:22:36,860 --> 00:22:40,100
memory we can write and read stuff in

501
00:22:40,100 --> 00:22:44,570
the d20 whoops in the d20 you can only

502
00:22:44,570 --> 00:22:46,280
they have smart about it

503
00:22:46,280 --> 00:22:48,560
they've only allowed you to do that over

504
00:22:48,560 --> 00:22:49,940
the console port so you can't do it over

505
00:22:49,940 --> 00:22:51,860
SSH so you have physically have to be

506
00:22:51,860 --> 00:22:54,440
there which is a great thing that no

507
00:22:54,440 --> 00:22:57,320
remote dumping or no no remote modifying

508
00:22:57,320 --> 00:22:59,630
memory so here's the problem we need

509
00:22:59,630 --> 00:23:02,420
tools that enable us to form the FR on

510
00:23:02,420 --> 00:23:05,330
ICS and embedded devices so here's the

511
00:23:05,330 --> 00:23:07,760
solution now josh is not here but he

512
00:23:07,760 --> 00:23:10,460
wrote a tool that allows you to read

513
00:23:10,460 --> 00:23:12,710
memory from VxWorks

514
00:23:12,710 --> 00:23:16,460
and write to it if it is needed to cache

515
00:23:16,460 --> 00:23:19,910
the live memory locally also compare the

516
00:23:19,910 --> 00:23:22,730
system image to other images so you can

517
00:23:22,730 --> 00:23:24,380
take multiple images over time and

518
00:23:24,380 --> 00:23:26,840
compare them and it's all done in Python

519
00:23:26,840 --> 00:23:29,540
so you can have Python objects that

520
00:23:29,540 --> 00:23:31,490
fetch and cache memory as needed so

521
00:23:31,490 --> 00:23:34,580
whatever tools in the future some of the

522
00:23:34,580 --> 00:23:37,390
features it can do it over serial TCP

523
00:23:37,390 --> 00:23:40,700
and protocols specific to other dumping

524
00:23:40,700 --> 00:23:43,610
utilities actually a little free work

525
00:23:43,610 --> 00:23:49,370
before this HD more did a tool and

526
00:23:49,370 --> 00:23:51,950
Metasploit to dump VxWorks memory well

527
00:23:51,950 --> 00:23:54,260
this does as well he actually hooked up

528
00:23:54,260 --> 00:23:56,540
to a Raspberry Pi at my house and him

529
00:23:56,540 --> 00:23:57,800
connected to it over the Internet and

530
00:23:57,800 --> 00:24:00,980
was able to dump the memory does caching

531
00:24:00,980 --> 00:24:03,590
so if connectivity is lost

532
00:24:03,590 --> 00:24:06,950
it'll resume where it left off which is

533
00:24:06,950 --> 00:24:10,400
great and it works on anything that has

534
00:24:10,400 --> 00:24:13,340
a C cable Python file object so cache

535
00:24:13,340 --> 00:24:15,550
files memory dumps sparse memory Maps

536
00:24:15,550 --> 00:24:20,690
special objects so we can validate the

537
00:24:20,690 --> 00:24:24,230
host image here so what we did

538
00:24:24,230 --> 00:24:29,090
was it's kind of hard to see on this

539
00:24:29,090 --> 00:24:32,600
screen but there's a IP firewall start

540
00:24:32,600 --> 00:24:34,250
in vxworks

541
00:24:34,250 --> 00:24:36,410
and we wrote a zero at the beginning of

542
00:24:36,410 --> 00:24:39,260
that to make it stop so when we did the

543
00:24:39,260 --> 00:24:42,890
comparison I'll see you here when we do

544
00:24:42,890 --> 00:24:45,799
the comparison between the known good

545
00:24:45,799 --> 00:24:47,809
where the IP firewalls supposed to work

546
00:24:47,809 --> 00:24:49,490
and then we did another memory dump

547
00:24:49,490 --> 00:24:51,950
where we put a zero we have a mismatch

548
00:24:51,950 --> 00:24:55,460
here so we can tell the difference and

549
00:24:55,460 --> 00:24:57,950
vxworks that someone fooled with the

550
00:24:57,950 --> 00:25:01,370
memory cool projects use CLE loads

551
00:25:01,370 --> 00:25:03,440
everything so that's a Python script if

552
00:25:03,440 --> 00:25:05,210
you're familiar with that I'm not expert

553
00:25:05,210 --> 00:25:09,950
in Python and very very excellent it's

554
00:25:09,950 --> 00:25:12,770
supposed to be supporting elf now so

555
00:25:12,770 --> 00:25:15,460
we've got to add that to the tool and

556
00:25:15,460 --> 00:25:19,750
then use the project called capstone so

557
00:25:19,750 --> 00:25:22,760
basically ripping the files apart for

558
00:25:22,760 --> 00:25:27,559
disassembled disassembly plans for the

559
00:25:27,559 --> 00:25:30,890
future we moving the code to github and

560
00:25:30,890 --> 00:25:32,690
we're gonna be releasing that as soon as

561
00:25:32,690 --> 00:25:34,820
legally possible or the people that are

562
00:25:34,820 --> 00:25:36,470
taking the class this Friday you'll get

563
00:25:36,470 --> 00:25:38,450
a copy of this tool and as soon as we

564
00:25:38,450 --> 00:25:40,820
can get it had done we're gonna put it

565
00:25:40,820 --> 00:25:42,650
on github and everybody will be able to

566
00:25:42,650 --> 00:25:45,140
download it and make changes to it and

567
00:25:45,140 --> 00:25:47,690
whatnot let's talk about another device

568
00:25:47,690 --> 00:25:51,590
quickly we have a switcher 35:30 artac

569
00:25:51,590 --> 00:25:53,450
it's another rtu that's used in

570
00:25:53,450 --> 00:25:57,169
substations mostly in the US it's a

571
00:25:57,169 --> 00:26:01,460
PowerPC it uses it also has a gig ram it

572
00:26:01,460 --> 00:26:04,610
uses a Swiss version of embedded Linux

573
00:26:04,610 --> 00:26:08,059
and they've got great manuals as well so

574
00:26:08,059 --> 00:26:09,169
you're going to use the instruction

575
00:26:09,169 --> 00:26:12,940
manual their software web browser and

576
00:26:12,940 --> 00:26:15,650
that's really only tools that we can use

577
00:26:15,650 --> 00:26:18,140
for this so how do we collect the two

578
00:26:18,140 --> 00:26:20,750
types of data so we have digital data it

579
00:26:20,750 --> 00:26:22,820
gives us on the web page gives us the

580
00:26:22,820 --> 00:26:25,370
running firmware what user accounts CPU

581
00:26:25,370 --> 00:26:27,910
usage memory usage post checks and

582
00:26:27,910 --> 00:26:30,770
there's also a password jump or physical

583
00:26:30,770 --> 00:26:34,400
on these units also watcher relays tend

584
00:26:34,400 --> 00:26:36,460
to have a password jumper in case of

585
00:26:36,460 --> 00:26:38,220
emergencies so

586
00:26:38,220 --> 00:26:40,590
you can it's hard to see but right here

587
00:26:40,590 --> 00:26:43,020
it says password jumper is currently

588
00:26:43,020 --> 00:26:45,750
disabled so you can see that remotely if

589
00:26:45,750 --> 00:26:49,140
it's someone's tampered with anything so

590
00:26:49,140 --> 00:26:50,850
here's an example from Project robust

591
00:26:50,850 --> 00:26:54,059
and this is a live screenshot whenever I

592
00:26:54,059 --> 00:26:57,809
send a malicious D mp3 you know it took

593
00:26:57,809 --> 00:27:00,059
up all the CPU usage a hundred percent

594
00:27:00,059 --> 00:27:03,059
and it took up all the RAM eventually

595
00:27:03,059 --> 00:27:06,240
and then we get an error says our TAC is

596
00:27:06,240 --> 00:27:08,730
failed canoe area and when it rebooted

597
00:27:08,730 --> 00:27:10,740
you can see the CPU usage is back down

598
00:27:10,740 --> 00:27:12,510
to normal but it says project failed

599
00:27:12,510 --> 00:27:15,480
running failover project so just just

600
00:27:15,480 --> 00:27:17,730
using that web screen shows you some

601
00:27:17,730 --> 00:27:19,350
interesting things if you come and see

602
00:27:19,350 --> 00:27:23,520
your whoops if you come in and see your

603
00:27:23,520 --> 00:27:25,830
CPU usage is pegged around 100% that's

604
00:27:25,830 --> 00:27:28,289
not a good thing so you have to do some

605
00:27:28,289 --> 00:27:30,770
investigation about that

606
00:27:30,770 --> 00:27:34,080
there's also sections in the manual on

607
00:27:34,080 --> 00:27:35,520
testing and troubleshooting same as

608
00:27:35,520 --> 00:27:39,120
before web HMI logging and security it

609
00:27:39,120 --> 00:27:40,950
also has syslog so if you have these

610
00:27:40,950 --> 00:27:42,780
devices turn on syslog and start

611
00:27:42,780 --> 00:27:45,870
collecting it centrally and you can see

612
00:27:45,870 --> 00:27:48,330
I'll know which ports are assigned in

613
00:27:48,330 --> 00:27:51,409
which points are active which is great

614
00:27:51,409 --> 00:27:55,440
they also have an ability to in the

615
00:27:55,440 --> 00:27:58,530
database you can when you do the the

616
00:27:58,530 --> 00:28:02,909
system tags you can assign more

617
00:28:02,909 --> 00:28:05,760
forensics type of points that beacon can

618
00:28:05,760 --> 00:28:09,720
be collected and also be sent to syslog

619
00:28:09,720 --> 00:28:11,780
it's really great there's no linux shell

620
00:28:11,780 --> 00:28:17,520
so I have to cry about that so it's also

621
00:28:17,520 --> 00:28:20,640
a pro because hackers can't get you know

622
00:28:20,640 --> 00:28:24,210
evil hackers from you know elbonia can't

623
00:28:24,210 --> 00:28:28,350
get into and into your and there's no

624
00:28:28,350 --> 00:28:30,150
shell to get access to so they have to

625
00:28:30,150 --> 00:28:31,880
find another way to attack the device

626
00:28:31,880 --> 00:28:34,919
there is no ssh interface for it it's

627
00:28:34,919 --> 00:28:36,570
only used for pass through two relays

628
00:28:36,570 --> 00:28:40,919
behind it it can also do cyril packet

629
00:28:40,919 --> 00:28:44,640
capture and Wireshark they wrote some

630
00:28:44,640 --> 00:28:46,169
even some serial

631
00:28:46,169 --> 00:28:49,049
Wireshark parsers for sweitzer fast

632
00:28:49,049 --> 00:28:50,730
messaging and Telugu rating that seminar

633
00:28:50,730 --> 00:28:52,649
protocol so it

634
00:28:52,649 --> 00:28:55,049
and network and cereal packet captures

635
00:28:55,049 --> 00:28:59,429
is really great for further reading I've

636
00:28:59,429 --> 00:29:01,799
got a Seymour's blog posts on VxWorks

637
00:29:01,799 --> 00:29:05,159
from 2010 and has that Mavis point

638
00:29:05,159 --> 00:29:09,330
module for vxworks David Ogden Splunk

639
00:29:09,330 --> 00:29:11,669
Unix from 2012 soaked UNIX is another

640
00:29:11,669 --> 00:29:12,990
real-time operating system is very

641
00:29:12,990 --> 00:29:16,320
popular hopefully we can get some people

642
00:29:16,320 --> 00:29:19,590
writing some tools for UNIX as well we

643
00:29:19,590 --> 00:29:21,570
maybe even take able to take a crack at

644
00:29:21,570 --> 00:29:26,220
I know radix that project is out and you

645
00:29:26,220 --> 00:29:27,840
know it's probably gonna take four years

646
00:29:27,840 --> 00:29:30,090
for that to get done so but we can do

647
00:29:30,090 --> 00:29:31,950
this now we I think we can do it now and

648
00:29:31,950 --> 00:29:35,070
do it open source as well ics-cert has

649
00:29:35,070 --> 00:29:37,169
recommended practices for ICS forensics

650
00:29:37,169 --> 00:29:40,019
well they have a white paper about it

651
00:29:40,019 --> 00:29:43,169
Travis Goodspeed brilliant guy ain't

652
00:29:43,169 --> 00:29:44,700
knows a lot about embedded systems so

653
00:29:44,700 --> 00:29:46,860
he's got some really great bit of device

654
00:29:46,860 --> 00:29:50,880
work with msp430 processor family really

655
00:29:50,880 --> 00:29:54,510
great tools and other processes you can

656
00:29:54,510 --> 00:29:57,029
use to do digital forensics ralph wagner

657
00:29:57,029 --> 00:29:59,519
obviously for Stuxnet excellent

658
00:29:59,519 --> 00:30:02,340
excellent work on that the forensics

659
00:30:02,340 --> 00:30:07,620
there was Stuxnet and then the what sans

660
00:30:07,620 --> 00:30:11,789
ICS teen did with the Ukraine defense

661
00:30:11,789 --> 00:30:14,519
use case file from last year that they

662
00:30:14,519 --> 00:30:16,830
published shows that you know the

663
00:30:16,830 --> 00:30:19,409
firmware that was written over for the

664
00:30:19,409 --> 00:30:21,419
ethernet serial murders that that

665
00:30:21,419 --> 00:30:23,639
involves embedded devices so that's

666
00:30:23,639 --> 00:30:26,399
something to consider we've got about

667
00:30:26,399 --> 00:30:32,340
five minutes for questions thanks Chris

668
00:30:32,340 --> 00:30:33,600
we'll take questions from the audience

669
00:30:33,600 --> 00:30:36,149
like you to state your name and

670
00:30:36,149 --> 00:30:39,960
organization you're with marina corte

671
00:30:39,960 --> 00:30:41,940
phil honeywell industrial cyber security

672
00:30:41,940 --> 00:30:44,580
lab so i would like to hear your opinion

673
00:30:44,580 --> 00:30:46,320
especially now when you've got

674
00:30:46,320 --> 00:30:49,110
experiences so there is a problem so

675
00:30:49,110 --> 00:30:52,789
plan floor is the zoo so forensics

676
00:30:52,789 --> 00:30:55,679
doesn't scale so basically every device

677
00:30:55,679 --> 00:30:57,750
has absolutely different logs need

678
00:30:57,750 --> 00:30:59,880
different instruments a provides and so

679
00:30:59,880 --> 00:31:03,000
on so it doesn't scale neither for the

680
00:31:03,000 --> 00:31:05,580
defenders no for offenders

681
00:31:05,580 --> 00:31:07,169
and when you have been talking

682
00:31:07,169 --> 00:31:08,879
especially like yeah open the manual

683
00:31:08,879 --> 00:31:11,519
because I've heard stories when certain

684
00:31:11,519 --> 00:31:13,799
investigations of the attacks that they

685
00:31:13,799 --> 00:31:15,629
actually the adversary get into your

686
00:31:15,629 --> 00:31:17,909
network and start reading manuals that's

687
00:31:17,909 --> 00:31:18,269
right

688
00:31:18,269 --> 00:31:20,399
the point is how do you find what is

689
00:31:20,399 --> 00:31:22,139
your recommendation for the vendors and

690
00:31:22,139 --> 00:31:24,869
there for us as a community where do we

691
00:31:24,869 --> 00:31:27,210
find this trade-off between may heaven

692
00:31:27,210 --> 00:31:28,980
like you know like everything unified

693
00:31:28,980 --> 00:31:30,720
like can we develop like recommendation

694
00:31:30,720 --> 00:31:32,519
for the vendors please include those

695
00:31:32,519 --> 00:31:34,619
logs use those tools because you see

696
00:31:34,619 --> 00:31:36,659
it's easier for us but we also make this

697
00:31:36,659 --> 00:31:38,159
task easier for the attackers because

698
00:31:38,159 --> 00:31:40,350
they know what to wipe exactly and so on

699
00:31:40,350 --> 00:31:41,909
so where does this find this balance

700
00:31:41,909 --> 00:31:44,220
what is your opinion well I think it

701
00:31:44,220 --> 00:31:46,769
starts with awareness because if the

702
00:31:46,769 --> 00:31:48,509
vendors are aware that people have the

703
00:31:48,509 --> 00:31:50,999
ability to write rootkits and things

704
00:31:50,999 --> 00:31:52,619
like that that that are getting in the

705
00:31:52,619 --> 00:31:55,739
memory now they'll probably want to

706
00:31:55,739 --> 00:31:58,320
consider ways to you know your event

707
00:31:58,320 --> 00:32:00,600
you're at a vendor so hopefully you can

708
00:32:00,600 --> 00:32:03,090
take that back to the teams that with

709
00:32:03,090 --> 00:32:05,340
that and the others to take you back to

710
00:32:05,340 --> 00:32:07,919
your vendors and say hey if this

711
00:32:07,919 --> 00:32:09,869
happened what do we do

712
00:32:09,869 --> 00:32:11,460
I think there's ways to do it like you

713
00:32:11,460 --> 00:32:12,629
say there's so many different devices

714
00:32:12,629 --> 00:32:14,639
and so many different things focus on

715
00:32:14,639 --> 00:32:17,509
the ones like so we focused on VxWorks

716
00:32:17,509 --> 00:32:20,429
very popular operating system focus on

717
00:32:20,429 --> 00:32:22,019
cue necks you might be able to focus on

718
00:32:22,019 --> 00:32:23,759
the operating system underlying

719
00:32:23,759 --> 00:32:26,789
operating system first and if there's

720
00:32:26,789 --> 00:32:28,799
anything specific recommendations for

721
00:32:28,799 --> 00:32:31,649
each PLC type if you you know you want

722
00:32:31,649 --> 00:32:35,909
to get the major coverage of for your

723
00:32:35,909 --> 00:32:38,340
most critical assets first you know make

724
00:32:38,340 --> 00:32:40,710
sure those are covered because you know

725
00:32:40,710 --> 00:32:42,809
it it's just something that's kind of

726
00:32:42,809 --> 00:32:44,220
bleeding edge I think and we need to

727
00:32:44,220 --> 00:32:47,629
start thinking about it so and - I

728
00:32:47,629 --> 00:32:49,679
didn't mention this but it's true you

729
00:32:49,679 --> 00:32:51,299
may not be able to trust the things that

730
00:32:51,299 --> 00:32:54,929
you collect because an attacker may turn

731
00:32:54,929 --> 00:32:57,539
on things in memory and then make sure

732
00:32:57,539 --> 00:32:59,159
that the serial port goes back to normal

733
00:32:59,159 --> 00:33:01,350
and blah blah blah and hide their tracks

734
00:33:01,350 --> 00:33:03,840
and may infect the software like a she

735
00:33:03,840 --> 00:33:05,129
config they may be able to infect that

736
00:33:05,129 --> 00:33:07,590
or a lot of things so there's there's

737
00:33:07,590 --> 00:33:09,629
the caveat I forgot to mention you know

738
00:33:09,629 --> 00:33:11,039
you may not be able to trust the things

739
00:33:11,039 --> 00:33:14,190
that you collect may not be good but you

740
00:33:14,190 --> 00:33:17,600
know for instance in the d20 it takes

741
00:33:17,600 --> 00:33:22,039
five days to collect the whole memory

742
00:33:22,039 --> 00:33:24,890
dump because it's a gig over 115 200

743
00:33:24,890 --> 00:33:30,740
bought serially so your data may change

744
00:33:30,740 --> 00:33:32,840
in that both of those five days if you

745
00:33:32,840 --> 00:33:35,150
do a whole dump in one fell swoop and

746
00:33:35,150 --> 00:33:38,090
any other questions yeah another one

747
00:33:38,090 --> 00:33:42,919
here Lars region energy sector search we

748
00:33:42,919 --> 00:33:45,740
are talking about how easy it is now but

749
00:33:45,740 --> 00:33:49,059
what about central logging for also for

750
00:33:49,059 --> 00:33:52,400
industrial control systems and the

751
00:33:52,400 --> 00:33:56,299
vendors have to look forward and how to

752
00:33:56,299 --> 00:33:59,809
get the engineering capabilities out to

753
00:33:59,809 --> 00:34:03,140
central log so the things you are

754
00:34:03,140 --> 00:34:06,970
talking about now is not a longer a

755
00:34:06,970 --> 00:34:09,980
problem that's right

756
00:34:09,980 --> 00:34:12,020
you know the centralized logging is very

757
00:34:12,020 --> 00:34:13,460
important and it kind of dovetails into

758
00:34:13,460 --> 00:34:15,859
network security monitoring as a larger

759
00:34:15,859 --> 00:34:18,080
practice because it would be great

760
00:34:18,080 --> 00:34:20,149
wouldn't it be great to not only collect

761
00:34:20,149 --> 00:34:24,859
logs from you know like syslog but also

762
00:34:24,859 --> 00:34:26,810
look at your SCADA and control system

763
00:34:26,810 --> 00:34:29,480
logs and look at the time stamps can you

764
00:34:29,480 --> 00:34:31,969
correlate if a power outage happens and

765
00:34:31,969 --> 00:34:35,480
an intrusion you know that's just an

766
00:34:35,480 --> 00:34:37,340
example you you want to be able to you

767
00:34:37,340 --> 00:34:40,129
know you have say a smart grid which is

768
00:34:40,129 --> 00:34:42,230
on top of your power grid and right now

769
00:34:42,230 --> 00:34:44,389
that the logs are kind of separate well

770
00:34:44,389 --> 00:34:46,369
why don't we start collecting centrally

771
00:34:46,369 --> 00:34:48,859
and and correlate those things yeah you

772
00:34:48,859 --> 00:34:49,550
know you got all these different

773
00:34:49,550 --> 00:34:51,168
processes all I guess all these others

774
00:34:51,168 --> 00:34:53,210
so we can do the same thing with like

775
00:34:53,210 --> 00:34:55,070
collect your logs centrally a lot of

776
00:34:55,070 --> 00:34:57,230
these newer devices have syslog I don't

777
00:34:57,230 --> 00:34:58,609
see an excuse you shouldn't be

778
00:34:58,609 --> 00:35:00,710
collecting them now there's so many

779
00:35:00,710 --> 00:35:02,330
tools out there and so many vendors now

780
00:35:02,330 --> 00:35:03,560
that would do network security

781
00:35:03,560 --> 00:35:05,119
monitoring for control systems so you

782
00:35:05,119 --> 00:35:07,690
don't have an excuse anymore

783
00:35:07,690 --> 00:35:12,100
all right any other questions for Chris

784
00:35:17,190 --> 00:35:19,510
so the kind of logs that you will

785
00:35:19,510 --> 00:35:22,200
collect would they be helpful India fire

786
00:35:22,200 --> 00:35:24,490
because the syslog is probably not gonna

787
00:35:24,490 --> 00:35:31,450
go very deep yeah so again it's you know

788
00:35:31,450 --> 00:35:35,740
syslog but I don't know if this answers

789
00:35:35,740 --> 00:35:37,630
your question there's also sometimes

790
00:35:37,630 --> 00:35:40,480
very specific logs that are for each

791
00:35:40,480 --> 00:35:43,900
type of PLC that may not be called

792
00:35:43,900 --> 00:35:46,300
anything but just you know PLC log or

793
00:35:46,300 --> 00:35:50,440
you know rock well you know factory talk

794
00:35:50,440 --> 00:35:53,130
log or something like that

795
00:35:53,130 --> 00:35:56,290
collecting those all the types if

796
00:35:56,290 --> 00:35:59,710
possible is a good thing it did answer

797
00:35:59,710 --> 00:36:01,710
your question okay

798
00:36:01,710 --> 00:36:07,180
all right any other questions with with

799
00:36:07,180 --> 00:36:09,130
all the failures for Miss commit miss

800
00:36:09,130 --> 00:36:11,890
configurations and just random everyday

801
00:36:11,890 --> 00:36:14,580
issues how do you differentiate between

802
00:36:14,580 --> 00:36:17,980
something that needs a forensics

803
00:36:17,980 --> 00:36:20,170
approach versus day-to-day

804
00:36:20,170 --> 00:36:25,210
troubleshooting okay that kind of goes

805
00:36:25,210 --> 00:36:28,000
in with your visibility to miss

806
00:36:28,000 --> 00:36:31,360
configurations if usually the device

807
00:36:31,360 --> 00:36:33,070
will stop talking and then if you know

808
00:36:33,070 --> 00:36:34,780
someone's out there working on the

809
00:36:34,780 --> 00:36:37,960
device you might be able to put that

810
00:36:37,960 --> 00:36:40,630
together pretty quickly you know

811
00:36:40,630 --> 00:36:42,070
especially if you could do some

812
00:36:42,070 --> 00:36:46,330
correlation between a user login or like

813
00:36:46,330 --> 00:36:49,150
a door alarm or something like that

814
00:36:49,150 --> 00:36:51,010
you'd be able to correlate those events

815
00:36:51,010 --> 00:36:53,260
pretty quickly but yeah you know someone

816
00:36:53,260 --> 00:36:56,110
has on the ground first-hand knowledge

817
00:36:56,110 --> 00:36:57,910
of what's going on there probably oh

818
00:36:57,910 --> 00:37:01,000
yeah about when I was in the park I mean

819
00:37:01,000 --> 00:37:04,090
I had I was the top tier so four states

820
00:37:04,090 --> 00:37:05,320
and then by the time I got to me

821
00:37:05,320 --> 00:37:08,410
someone's on fire so it's one of those

822
00:37:08,410 --> 00:37:09,730
things where you have to have a tiered

823
00:37:09,730 --> 00:37:11,920
approach to you and hopefully the

824
00:37:11,920 --> 00:37:13,900
engineers and the technicians at the

825
00:37:13,900 --> 00:37:16,270
lower level can quickly determine if

826
00:37:16,270 --> 00:37:19,500
it's a Miss configuration or not

