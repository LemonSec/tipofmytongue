1
00:00:04,880 --> 00:00:06,640
hello everybody

2
00:00:06,640 --> 00:00:08,400
and i see some of you filtering in and

3
00:00:08,400 --> 00:00:10,480
out so keep going but we are going to

4
00:00:10,480 --> 00:00:12,080
get started because i know we are the

5
00:00:12,080 --> 00:00:14,559
only thing keeping you from your drinks

6
00:00:14,559 --> 00:00:16,320
uh this afternoon so we are going to be

7
00:00:16,320 --> 00:00:18,000
talking about a controller the new

8
00:00:18,000 --> 00:00:19,920
state-sponsored threat to industrial

9
00:00:19,920 --> 00:00:23,279
control systems my name is

10
00:00:23,279 --> 00:00:25,439
nathan brubaker i am a director at

11
00:00:25,439 --> 00:00:27,279
mandiant i manage the cyber physical

12
00:00:27,279 --> 00:00:29,359
intel focus area as well as information

13
00:00:29,359 --> 00:00:31,599
operations i'm joined today by keith

14
00:00:31,599 --> 00:00:33,600
keith hi everyone i'm keith london i'm

15
00:00:33,600 --> 00:00:35,360
the manager on mandiant's cyber physical

16
00:00:35,360 --> 00:00:37,280
threat analysis team so i manage the

17
00:00:37,280 --> 00:00:39,360
team that focuses on threat actors and

18
00:00:39,360 --> 00:00:43,120
activity targeting ics and ot

19
00:00:43,520 --> 00:00:45,600
so our plan for this presentation is to

20
00:00:45,600 --> 00:00:47,600
first give you an overview of what in

21
00:00:47,600 --> 00:00:49,840
controller is and some of our initial

22
00:00:49,840 --> 00:00:51,760
observations next we're going to do a

23
00:00:51,760 --> 00:00:53,600
deeper dive on the actual malware

24
00:00:53,600 --> 00:00:56,000
families that comprise in controller

25
00:00:56,000 --> 00:00:57,600
we developed a couple of high-level

26
00:00:57,600 --> 00:00:58,640
attack scenarios that we're going to

27
00:00:58,640 --> 00:01:00,399
walk you through to help put this in

28
00:01:00,399 --> 00:01:01,440
context

29
00:01:01,440 --> 00:01:02,800
after that we're going to highlight just

30
00:01:02,800 --> 00:01:04,879
some initial observations on attribution

31
00:01:04,879 --> 00:01:06,080
and we're going to close out with some

32
00:01:06,080 --> 00:01:07,600
high-level considerations that we want

33
00:01:07,600 --> 00:01:09,760
you to think about

34
00:01:09,760 --> 00:01:11,760
all right so before we get started i

35
00:01:11,760 --> 00:01:13,520
just wanted to you know give some shout

36
00:01:13,520 --> 00:01:15,680
outs and thank yous a lot of folks here

37
00:01:15,680 --> 00:01:17,200
get to work on similar types of stuff

38
00:01:17,200 --> 00:01:18,880
like this but for those of you who don't

39
00:01:18,880 --> 00:01:20,960
this takes an immense amount of time

40
00:01:20,960 --> 00:01:23,759
it's like months and months of work and

41
00:01:23,759 --> 00:01:25,119
very late nights so thank you to

42
00:01:25,119 --> 00:01:27,360
everyone at mandiant up on the screen

43
00:01:27,360 --> 00:01:29,360
and those who are not and a huge thank

44
00:01:29,360 --> 00:01:31,040
you to all of our partners at us

45
00:01:31,040 --> 00:01:32,880
government and certainly our industry

46
00:01:32,880 --> 00:01:34,799
partners including schneider electric

47
00:01:34,799 --> 00:01:39,040
who's here this year so thank you again

48
00:01:39,040 --> 00:01:41,360
all right

49
00:01:41,360 --> 00:01:43,280
so uh as background before we kind of

50
00:01:43,280 --> 00:01:44,720
jump into things i wanted to give a bit

51
00:01:44,720 --> 00:01:46,720
of well i get a lot of questions on

52
00:01:46,720 --> 00:01:48,880
twitter from customers so on and so

53
00:01:48,880 --> 00:01:51,040
forth about like well honestly from this

54
00:01:51,040 --> 00:01:53,360
all the way back to triton uh you know

55
00:01:53,360 --> 00:01:54,799
who's the victim where did this come

56
00:01:54,799 --> 00:01:56,640
from all that kind of stuff and the

57
00:01:56,640 --> 00:01:58,719
reality is you know we work for a global

58
00:01:58,719 --> 00:02:00,640
intelligence organization that gets

59
00:02:00,640 --> 00:02:02,000
information from a lot of different

60
00:02:02,000 --> 00:02:05,360
places so in this case uh we can't tell

61
00:02:05,360 --> 00:02:07,040
you explicitly where this came from but

62
00:02:07,040 --> 00:02:09,038
i can give you some insight we routinely

63
00:02:09,038 --> 00:02:10,878
collect information from you know our is

64
00:02:10,878 --> 00:02:12,239
the response engagements from our

65
00:02:12,239 --> 00:02:14,480
partnerships as well as from some of our

66
00:02:14,480 --> 00:02:15,920
independent research so that's kind of

67
00:02:15,920 --> 00:02:17,440
where this came from

68
00:02:17,440 --> 00:02:20,160
so hopefully that's good enough but uh

69
00:02:20,160 --> 00:02:22,160
to give you an idea we started working

70
00:02:22,160 --> 00:02:24,080
on this analysis really early this year

71
00:02:24,080 --> 00:02:26,720
on our own quickly realized that we were

72
00:02:26,720 --> 00:02:28,720
uh that this the malware really impacts

73
00:02:28,720 --> 00:02:31,040
a number of different uh vendors and so

74
00:02:31,040 --> 00:02:32,319
we reached out and have been working

75
00:02:32,319 --> 00:02:35,920
with many of them closely since

76
00:02:35,920 --> 00:02:38,239
again early this year and so a huge

77
00:02:38,239 --> 00:02:40,000
again shout out thank you to schneider

78
00:02:40,000 --> 00:02:42,000
who's partnered with us uh for much of

79
00:02:42,000 --> 00:02:43,280
our research

80
00:02:43,280 --> 00:02:44,720
finally in controller for those who are

81
00:02:44,720 --> 00:02:47,800
not aware directly relates to sisa alert

82
00:02:47,800 --> 00:02:49,920
aa22103a as well as the schneider

83
00:02:49,920 --> 00:02:52,640
bulletin and codesys advisory as well as

84
00:02:52,640 --> 00:02:54,400
dragoos there's some overlap with

85
00:02:54,400 --> 00:02:57,120
drago's pipedream reporting

86
00:02:57,120 --> 00:02:59,680
so what is in controller at a high level

87
00:02:59,680 --> 00:03:02,239
it is a piece of malware that targets

88
00:03:02,239 --> 00:03:05,040
industrial automation machines that is

89
00:03:05,040 --> 00:03:06,400
comprised of these kind of three

90
00:03:06,400 --> 00:03:09,200
components so the first one which is tag

91
00:03:09,200 --> 00:03:12,239
run targets opc ua servers and it is

92
00:03:12,239 --> 00:03:14,480
built to do recon and can provide some

93
00:03:14,480 --> 00:03:16,239
level of attack support keith's going to

94
00:03:16,239 --> 00:03:18,400
go into a lot more detail after a couple

95
00:03:18,400 --> 00:03:19,599
of slides and i give you kind of this

96
00:03:19,599 --> 00:03:21,120
overview but it's helpful to kind of

97
00:03:21,120 --> 00:03:22,879
have an understanding as we talk about

98
00:03:22,879 --> 00:03:24,959
through some of the initial

99
00:03:24,959 --> 00:03:27,920
observations we've had so that's tag run

100
00:03:27,920 --> 00:03:30,400
code call is uh target schneider

101
00:03:30,400 --> 00:03:32,400
electric controllers it communicates

102
00:03:32,400 --> 00:03:34,400
over

103
00:03:34,400 --> 00:03:36,720
modbus as well as code sys and it's

104
00:03:36,720 --> 00:03:38,720
extensible so it's got an ability to

105
00:03:38,720 --> 00:03:40,799
expand out its capabilities it has

106
00:03:40,799 --> 00:03:43,040
functionality related to kind of lower

107
00:03:43,040 --> 00:03:44,560
level disruption

108
00:03:44,560 --> 00:03:46,319
all the way up to kind of targeted

109
00:03:46,319 --> 00:03:48,000
destruction and

110
00:03:48,000 --> 00:03:49,519
that kind of attack so i think kind of

111
00:03:49,519 --> 00:03:52,319
like triton level of work

112
00:03:52,319 --> 00:03:55,280
shell is a framework that targets omron

113
00:03:55,280 --> 00:03:58,239
plcs and it's got similar capabilities

114
00:03:58,239 --> 00:04:00,000
ranging from lower sophistication all

115
00:04:00,000 --> 00:04:02,000
the way up to disruptive and targeted

116
00:04:02,000 --> 00:04:03,920
kind of destructive attacks

117
00:04:03,920 --> 00:04:05,760
so that's what falls under incontroller

118
00:04:05,760 --> 00:04:09,040
for us we also track this uh as rock

119
00:04:09,040 --> 00:04:11,599
driver exploit and what we call ice core

120
00:04:11,599 --> 00:04:13,040
which is a

121
00:04:13,040 --> 00:04:16,000
kind of i t focus command and control uh

122
00:04:16,000 --> 00:04:18,560
slash recon tool that keith will go into

123
00:04:18,560 --> 00:04:20,720
a bit more detail i think dragos tracks

124
00:04:20,720 --> 00:04:22,720
this all together under their pipe dream

125
00:04:22,720 --> 00:04:24,560
name we have reason to not do that and

126
00:04:24,560 --> 00:04:27,280
so we kind of separate these out

127
00:04:27,280 --> 00:04:29,280
to give you an idea about well for your

128
00:04:29,280 --> 00:04:31,199
visual learners but also to kind of

129
00:04:31,199 --> 00:04:32,800
understand how this all plays together

130
00:04:32,800 --> 00:04:34,880
we juxtaposed it against the our version

131
00:04:34,880 --> 00:04:36,240
of the purdue model so you can take a

132
00:04:36,240 --> 00:04:38,960
look up at the top here uh tag run again

133
00:04:38,960 --> 00:04:40,960
targets opc ua servers so it kind of

134
00:04:40,960 --> 00:04:43,520
falls into three and four then if you

135
00:04:43,520 --> 00:04:45,680
look at the exploit and ice core uh

136
00:04:45,680 --> 00:04:49,520
pardon all my fancy graphics here but uh

137
00:04:49,520 --> 00:04:51,840
those kind of could be used from level

138
00:04:51,840 --> 00:04:53,919
two all the way up to level four uh we

139
00:04:53,919 --> 00:04:56,639
do have reason to believe though that it

140
00:04:56,639 --> 00:04:59,360
potentially could target primarily

141
00:04:59,360 --> 00:05:01,520
intermediary systems so this would

142
00:05:01,520 --> 00:05:03,520
probably be more likely to be used at

143
00:05:03,520 --> 00:05:06,160
level two and level three

144
00:05:06,160 --> 00:05:08,560
then down at the bottom here we have

145
00:05:08,560 --> 00:05:10,639
code call and um shell targeting more

146
00:05:10,639 --> 00:05:13,919
kind of hardcore traditional ics devices

147
00:05:13,919 --> 00:05:15,440
all right so moving on to some

148
00:05:15,440 --> 00:05:18,479
observations before keith really digs in

149
00:05:18,479 --> 00:05:20,400
first there's quite a lot of code and

150
00:05:20,400 --> 00:05:22,639
it's really complex the

151
00:05:22,639 --> 00:05:25,039
malware is well written and this kind of

152
00:05:25,039 --> 00:05:27,039
contrasts pretty significantly against

153
00:05:27,039 --> 00:05:28,960
triton some of the other ics malware

154
00:05:28,960 --> 00:05:31,440
that we've done analysis on it probably

155
00:05:31,440 --> 00:05:33,440
would have taken a team of engineers and

156
00:05:33,440 --> 00:05:35,199
subject matter experts

157
00:05:35,199 --> 00:05:37,520
many months if not more to write

158
00:05:37,520 --> 00:05:38,960
and they probably would have needed a

159
00:05:38,960 --> 00:05:40,320
lab so that kind of gives you a sense

160
00:05:40,320 --> 00:05:42,000
about the amount of of money and

161
00:05:42,000 --> 00:05:44,560
resources that went into this

162
00:05:44,560 --> 00:05:46,160
the attacker definitely if they're

163
00:05:46,160 --> 00:05:48,160
looking to carry out some more targeted

164
00:05:48,160 --> 00:05:50,000
cyber physical type attack similar to

165
00:05:50,000 --> 00:05:52,160
triton or something of that consequence

166
00:05:52,160 --> 00:05:54,000
would definitely need additional i.t

167
00:05:54,000 --> 00:05:55,919
tooling to support earlier stages of the

168
00:05:55,919 --> 00:05:58,479
attack life cycle so this that kind of

169
00:05:58,479 --> 00:06:00,960
attack generally requires many months on

170
00:06:00,960 --> 00:06:03,039
target to prepare for and also

171
00:06:03,039 --> 00:06:05,680
eventually carry out so to to gain that

172
00:06:05,680 --> 00:06:07,520
kind of dwell time you need either

173
00:06:07,520 --> 00:06:09,360
custom or off-the-shelf tooling to

174
00:06:09,360 --> 00:06:11,199
support that we don't have any of that

175
00:06:11,199 --> 00:06:12,639
at the moment but it's something to keep

176
00:06:12,639 --> 00:06:14,319
in mind

177
00:06:14,319 --> 00:06:16,960
so the incontroller tooling is comprised

178
00:06:16,960 --> 00:06:19,039
again of these three components

179
00:06:19,039 --> 00:06:21,199
it's important to understand that

180
00:06:21,199 --> 00:06:23,039
theoretically each of these components

181
00:06:23,039 --> 00:06:25,520
could be delivered to any number of

182
00:06:25,520 --> 00:06:27,120
target environments

183
00:06:27,120 --> 00:06:29,600
independently and or we think equally

184
00:06:29,600 --> 00:06:32,240
likely deployed to the same or a small

185
00:06:32,240 --> 00:06:35,440
set of of targets under the incontroller

186
00:06:35,440 --> 00:06:36,319
kind of

187
00:06:36,319 --> 00:06:38,800
tool set

188
00:06:38,960 --> 00:06:40,720
so i mentioned before the code is

189
00:06:40,720 --> 00:06:42,560
extensible and modular at least parts of

190
00:06:42,560 --> 00:06:44,560
it are and this provides the actor with

191
00:06:44,560 --> 00:06:46,800
the ability to pretty easily increase

192
00:06:46,800 --> 00:06:48,720
the number of targeted devices as well

193
00:06:48,720 --> 00:06:50,800
as increase the capability

194
00:06:50,800 --> 00:06:52,479
and functionality we actually have

195
00:06:52,479 --> 00:06:54,479
reason to believe that the actor

196
00:06:54,479 --> 00:06:56,560
intended or has already built additional

197
00:06:56,560 --> 00:07:00,639
functionality to support their efforts

198
00:07:00,639 --> 00:07:03,680
so devices that are targeted explicitly

199
00:07:03,680 --> 00:07:06,160
in the code and also stuff that is kind

200
00:07:06,160 --> 00:07:09,199
of impacted based on uh overlapping

201
00:07:09,199 --> 00:07:11,680
technologies and things like that uh

202
00:07:11,680 --> 00:07:13,840
are generally present in kind of

203
00:07:13,840 --> 00:07:15,599
machines that are

204
00:07:15,599 --> 00:07:17,039
in a

205
00:07:17,039 --> 00:07:18,639
that are sold by a reseller or something

206
00:07:18,639 --> 00:07:21,039
like that so an an asset owner may not

207
00:07:21,039 --> 00:07:22,319
actually know that they have these

208
00:07:22,319 --> 00:07:24,000
devices in their networks which is

209
00:07:24,000 --> 00:07:27,599
something certainly to consider

210
00:07:27,599 --> 00:07:29,360
that all said there is a very good

211
00:07:29,360 --> 00:07:32,479
chance that based on our research that

212
00:07:32,479 --> 00:07:34,160
this tool and

213
00:07:34,160 --> 00:07:35,680
honestly we think probably it's meant to

214
00:07:35,680 --> 00:07:37,919
be used together is meant for a a

215
00:07:37,919 --> 00:07:39,759
specific target or

216
00:07:39,759 --> 00:07:43,039
small number of targets

217
00:07:43,440 --> 00:07:45,599
and finally

218
00:07:45,599 --> 00:07:47,440
we as we mentioned in the title think

219
00:07:47,440 --> 00:07:49,199
this is very likely state sponsored

220
00:07:49,199 --> 00:07:50,240
keith's going to go into that in a

221
00:07:50,240 --> 00:07:52,000
little bit more detail in a minute but

222
00:07:52,000 --> 00:07:54,479
uh we also have some evidence not much

223
00:07:54,479 --> 00:07:56,400
of it unfortunately we can share here uh

224
00:07:56,400 --> 00:07:59,039
that links this to some russian nexus

225
00:07:59,039 --> 00:08:00,639
and you know we usually don't go into

226
00:08:00,639 --> 00:08:01,919
that level of detail but we thought it

227
00:08:01,919 --> 00:08:03,520
was worthwhile for this considering the

228
00:08:03,520 --> 00:08:05,440
current geopolitical environment and

229
00:08:05,440 --> 00:08:07,039
kind of how this can then be actioned by

230
00:08:07,039 --> 00:08:08,080
defenders

231
00:08:08,080 --> 00:08:08,879
so

232
00:08:08,879 --> 00:08:10,240
on to keith

233
00:08:10,240 --> 00:08:11,919
thanks so i'm going to cover each of

234
00:08:11,919 --> 00:08:14,000
these tools and also those two

235
00:08:14,000 --> 00:08:16,080
supporting windows tools as well so

236
00:08:16,080 --> 00:08:18,319
first to talk about tag run it's best to

237
00:08:18,319 --> 00:08:20,720
describe this as basically an ics

238
00:08:20,720 --> 00:08:22,879
reconnaissance tool and potentially an

239
00:08:22,879 --> 00:08:25,199
attack support tool that's targeting opc

240
00:08:25,199 --> 00:08:27,599
ua servers and data so if you're not

241
00:08:27,599 --> 00:08:30,000
familiar with opc essentially its job is

242
00:08:30,000 --> 00:08:31,919
to collect what might otherwise be

243
00:08:31,919 --> 00:08:33,919
disparate ics data

244
00:08:33,919 --> 00:08:35,760
coming from different plc devices that

245
00:08:35,760 --> 00:08:37,679
might otherwise only speak

246
00:08:37,679 --> 00:08:40,159
vendor proprietary protocols so opc

247
00:08:40,159 --> 00:08:41,839
centralizes that data and gives you a

248
00:08:41,839 --> 00:08:43,599
singular view into

249
00:08:43,599 --> 00:08:45,600
the different ics devices on the network

250
00:08:45,600 --> 00:08:47,760
and also the status of those devices and

251
00:08:47,760 --> 00:08:49,360
the overall process

252
00:08:49,360 --> 00:08:51,040
so it stores that information as tags

253
00:08:51,040 --> 00:08:52,560
which is why we chose to call this piece

254
00:08:52,560 --> 00:08:54,880
of malware tag run and keep in mind this

255
00:08:54,880 --> 00:08:57,680
is opc ua not opc classic so it can run

256
00:08:57,680 --> 00:08:58,880
on windows

257
00:08:58,880 --> 00:09:00,560
linux systems and potentially embedded

258
00:09:00,560 --> 00:09:02,000
systems as well

259
00:09:02,000 --> 00:09:03,279
so to run through the malware's

260
00:09:03,279 --> 00:09:05,600
execution basically first it has some

261
00:09:05,600 --> 00:09:08,480
scanning functionality it does an icmp

262
00:09:08,480 --> 00:09:10,000
ping sweep

263
00:09:10,000 --> 00:09:13,120
to look for open ports and ip addresses

264
00:09:13,120 --> 00:09:15,440
to scan them for the presence of opc ua

265
00:09:15,440 --> 00:09:17,760
servers once it identifies them it'll

266
00:09:17,760 --> 00:09:20,240
try to connect using credentials that

267
00:09:20,240 --> 00:09:21,279
the attacker might have already

268
00:09:21,279 --> 00:09:22,399
harvested

269
00:09:22,399 --> 00:09:24,080
similarly but with authentication

270
00:09:24,080 --> 00:09:26,320
certificates but it also has a brute

271
00:09:26,320 --> 00:09:28,080
force mechanism as well to try to gain

272
00:09:28,080 --> 00:09:29,279
access

273
00:09:29,279 --> 00:09:30,959
once the attacker has access they can

274
00:09:30,959 --> 00:09:32,959
read the depth of the server structure

275
00:09:32,959 --> 00:09:35,200
but also read and write opc tags so

276
00:09:35,200 --> 00:09:36,080
that's why we think it has a

277
00:09:36,080 --> 00:09:37,839
reconnaissance component to read the

278
00:09:37,839 --> 00:09:39,440
tags and get an understanding of the

279
00:09:39,440 --> 00:09:41,760
process but also potentially in a tax

280
00:09:41,760 --> 00:09:43,200
support

281
00:09:43,200 --> 00:09:45,839
component as well by overwriting

282
00:09:45,839 --> 00:09:48,320
specific opc tags they can

283
00:09:48,320 --> 00:09:50,000
manipulate what the operator might be

284
00:09:50,000 --> 00:09:51,680
looking at and how they're viewing the

285
00:09:51,680 --> 00:09:53,440
process even though they're masking uh

286
00:09:53,440 --> 00:09:54,720
some changes they might make in the

287
00:09:54,720 --> 00:09:56,240
network

288
00:09:56,240 --> 00:09:57,839
so the implications of this activity are

289
00:09:57,839 --> 00:10:00,000
really similar to the opcda component

290
00:10:00,000 --> 00:10:01,760
that's an in destroyer and there's a lot

291
00:10:01,760 --> 00:10:04,480
of really great literature open source

292
00:10:04,480 --> 00:10:06,160
literature on that topic so i encourage

293
00:10:06,160 --> 00:10:07,279
you to read there further if you want

294
00:10:07,279 --> 00:10:08,880
some more information

295
00:10:08,880 --> 00:10:10,640
so next i'll cover code call so this is

296
00:10:10,640 --> 00:10:12,800
a disruption and attack tool that is

297
00:10:12,800 --> 00:10:15,440
targeting some schneider electric plcs i

298
00:10:15,440 --> 00:10:17,519
think this piece of malware requires the

299
00:10:17,519 --> 00:10:20,399
most nuance to to appropriately discuss

300
00:10:20,399 --> 00:10:21,839
at its highest level it's actually a

301
00:10:21,839 --> 00:10:23,600
framework for interacting with modbus

302
00:10:23,600 --> 00:10:25,920
enabled devices but it's extensible with

303
00:10:25,920 --> 00:10:29,040
additional plc specific device attack

304
00:10:29,040 --> 00:10:31,360
modules so when we say that incontroller

305
00:10:31,360 --> 00:10:33,279
is extensible we're primarily referring

306
00:10:33,279 --> 00:10:34,880
to this tool

307
00:10:34,880 --> 00:10:37,279
so first to cover the modbus component

308
00:10:37,279 --> 00:10:38,959
it's pretty straightforward it can scan

309
00:10:38,959 --> 00:10:41,760
and connect to modbus enabled devices

310
00:10:41,760 --> 00:10:43,600
and then read and write specific device

311
00:10:43,600 --> 00:10:44,720
registers

312
00:10:44,720 --> 00:10:46,640
so if you overwrite a modbus register

313
00:10:46,640 --> 00:10:49,839
that can impact how the plc is executing

314
00:10:49,839 --> 00:10:52,160
ultimately resulting in some potential

315
00:10:52,160 --> 00:10:54,079
change to the physical process that it's

316
00:10:54,079 --> 00:10:55,760
controlling

317
00:10:55,760 --> 00:10:58,240
more interestingly so there is a device

318
00:10:58,240 --> 00:10:59,839
module that's targeting the schneider

319
00:10:59,839 --> 00:11:02,720
electric tm-251 plc

320
00:11:02,720 --> 00:11:04,000
so there's a similar kind of

321
00:11:04,000 --> 00:11:05,600
identification component where it will

322
00:11:05,600 --> 00:11:07,839
scan for schneider electric devices

323
00:11:07,839 --> 00:11:09,680
then it'll try to connect to that device

324
00:11:09,680 --> 00:11:12,160
using schneider electric's machine

325
00:11:12,160 --> 00:11:14,399
expert or sew machine protocol which is

326
00:11:14,399 --> 00:11:16,160
essentially their implementation of code

327
00:11:16,160 --> 00:11:18,240
sys the programming

328
00:11:18,240 --> 00:11:19,839
software so that's why we called this

329
00:11:19,839 --> 00:11:20,959
code call

330
00:11:20,959 --> 00:11:22,480
because that's a really widely used

331
00:11:22,480 --> 00:11:24,640
programming language

332
00:11:24,640 --> 00:11:25,360
so

333
00:11:25,360 --> 00:11:27,839
it'll try to connect using a brute force

334
00:11:27,839 --> 00:11:30,560
mechanism it has a hard-coded dictionary

335
00:11:30,560 --> 00:11:32,320
list that it uses passwords from to try

336
00:11:32,320 --> 00:11:34,640
to to try to log onto the device if it

337
00:11:34,640 --> 00:11:36,560
successfully connects it essentially has

338
00:11:36,560 --> 00:11:37,839
engineering workstation-like

339
00:11:37,839 --> 00:11:40,000
capabilities so it can change the device

340
00:11:40,000 --> 00:11:41,920
configuration it can change the control

341
00:11:41,920 --> 00:11:42,800
logic

342
00:11:42,800 --> 00:11:44,399
ultimately affecting how the physical

343
00:11:44,399 --> 00:11:46,240
machines are operating

344
00:11:46,240 --> 00:11:47,760
lastly it does have some additional

345
00:11:47,760 --> 00:11:49,519
disruption capabilities

346
00:11:49,519 --> 00:11:51,040
for instance there's a denial of service

347
00:11:51,040 --> 00:11:53,040
capability there's a separate crash

348
00:11:53,040 --> 00:11:54,880
function and there's some simpler

349
00:11:54,880 --> 00:11:57,839
capabilities like file deletion

350
00:11:57,839 --> 00:11:59,360
so next i want to distinguish between

351
00:11:59,360 --> 00:12:01,440
the devices it's actually targeting

352
00:12:01,440 --> 00:12:04,079
versus those that it's impacting

353
00:12:04,079 --> 00:12:06,320
so aside from the modbus functionality

354
00:12:06,320 --> 00:12:07,839
all of those other components are

355
00:12:07,839 --> 00:12:10,560
implemented in the context of a device

356
00:12:10,560 --> 00:12:12,800
attack module and the only module that

357
00:12:12,800 --> 00:12:14,720
exists is the one for the

358
00:12:14,720 --> 00:12:17,360
tm 251 plc which i'm showing here in the

359
00:12:17,360 --> 00:12:19,760
center of the presentation

360
00:12:19,760 --> 00:12:22,079
so this is a pretty versatile plc it can

361
00:12:22,079 --> 00:12:23,360
be used for

362
00:12:23,360 --> 00:12:25,120
a number of different applications

363
00:12:25,120 --> 00:12:27,040
schneider describes it as supporting

364
00:12:27,040 --> 00:12:28,959
modular machines in distributed

365
00:12:28,959 --> 00:12:30,160
architectures

366
00:12:30,160 --> 00:12:31,680
there's also some use cases for

367
00:12:31,680 --> 00:12:33,600
substation automation so it's a pretty

368
00:12:33,600 --> 00:12:35,600
versatile plc

369
00:12:35,600 --> 00:12:37,680
and that is the only major attack module

370
00:12:37,680 --> 00:12:39,440
that we've identified although we did

371
00:12:39,440 --> 00:12:42,720
find a second reference to a second

372
00:12:42,720 --> 00:12:44,480
a device module which is targeting the

373
00:12:44,480 --> 00:12:47,440
tm 221 plc which here i have shown on

374
00:12:47,440 --> 00:12:49,360
the left side of the screen

375
00:12:49,360 --> 00:12:50,720
i'm showing some of the specs just so

376
00:12:50,720 --> 00:12:52,160
you can compare amongst those two

377
00:12:52,160 --> 00:12:54,240
devices but essentially it only has a

378
00:12:54,240 --> 00:12:56,399
fraction of the ram and flash memory

379
00:12:56,399 --> 00:12:59,519
capacity it's for much smaller use cases

380
00:12:59,519 --> 00:13:01,760
and schneider electric describes this as

381
00:13:01,760 --> 00:13:05,360
supporting simple repetitive machines

382
00:13:05,360 --> 00:13:07,279
so lastly there's also a component that

383
00:13:07,279 --> 00:13:08,399
targets

384
00:13:08,399 --> 00:13:12,639
the tm 258 potentially in the hard-coded

385
00:13:12,639 --> 00:13:15,200
list of usernames and passwords

386
00:13:15,200 --> 00:13:18,320
it references that m258 username and it

387
00:13:18,320 --> 00:13:20,399
tries to log on using that username so

388
00:13:20,399 --> 00:13:22,720
that could be indicative of targeting

389
00:13:22,720 --> 00:13:24,399
that device as well although we didn't

390
00:13:24,399 --> 00:13:25,920
identify an attack module for that

391
00:13:25,920 --> 00:13:28,319
device

392
00:13:28,399 --> 00:13:30,880
so we didn't find again any evidence

393
00:13:30,880 --> 00:13:32,720
that the malware is targeting any other

394
00:13:32,720 --> 00:13:34,800
devices but there are a lot of other

395
00:13:34,800 --> 00:13:36,320
impacted devices

396
00:13:36,320 --> 00:13:38,560
so some other schneider electric

397
00:13:38,560 --> 00:13:40,079
devices particularly those in that

398
00:13:40,079 --> 00:13:41,760
modicon family

399
00:13:41,760 --> 00:13:43,920
series of plc's are potentially

400
00:13:43,920 --> 00:13:46,959
vulnerable to the entirety of code call

401
00:13:46,959 --> 00:13:48,560
so when you look at some of the alerts

402
00:13:48,560 --> 00:13:50,639
and they cover some additional devices

403
00:13:50,639 --> 00:13:52,160
they're primarily talking about that

404
00:13:52,160 --> 00:13:54,639
those devices are impacted but not

405
00:13:54,639 --> 00:13:56,560
necessarily explicitly targeted by the

406
00:13:56,560 --> 00:13:57,839
malware

407
00:13:57,839 --> 00:13:59,440
there's a broader problem in that the

408
00:13:59,440 --> 00:14:01,279
malware implements code sys because

409
00:14:01,279 --> 00:14:03,600
that's a really widely deployed and

410
00:14:03,600 --> 00:14:06,800
popular programming application for plcs

411
00:14:06,800 --> 00:14:09,440
so given that it implements that library

412
00:14:09,440 --> 00:14:10,880
it's potentially

413
00:14:10,880 --> 00:14:12,880
compatible with a lot more devices and

414
00:14:12,880 --> 00:14:14,480
vendors because a lot of

415
00:14:14,480 --> 00:14:16,399
other systems utilize that

416
00:14:16,399 --> 00:14:17,839
but i distinguish between this and the

417
00:14:17,839 --> 00:14:19,600
prior point just because some pieces of

418
00:14:19,600 --> 00:14:22,000
the malware are still targeted towards

419
00:14:22,000 --> 00:14:23,839
schneider electric devices like

420
00:14:23,839 --> 00:14:25,839
potentially the identification module

421
00:14:25,839 --> 00:14:27,920
and some of those username and passwords

422
00:14:27,920 --> 00:14:30,160
that i mentioned

423
00:14:30,160 --> 00:14:32,000
and also i'll just mention that it does

424
00:14:32,000 --> 00:14:33,279
have that modbus component that's

425
00:14:33,279 --> 00:14:36,160
implemented outside of the device

426
00:14:36,160 --> 00:14:38,320
specific modules so it can potentially

427
00:14:38,320 --> 00:14:40,880
target any modbus enabled device

428
00:14:40,880 --> 00:14:42,800
there's nothing too new here because we

429
00:14:42,800 --> 00:14:44,800
know that modbus is very insecure

430
00:14:44,800 --> 00:14:46,320
although now we can consider that the

431
00:14:46,320 --> 00:14:48,160
risk is going up since risk is a

432
00:14:48,160 --> 00:14:49,920
function of threat activity times

433
00:14:49,920 --> 00:14:53,279
vulnerability times impact

434
00:14:53,440 --> 00:14:55,279
so next we'll talk about omshell so

435
00:14:55,279 --> 00:14:57,680
omshell is a similar framework this time

436
00:14:57,680 --> 00:14:59,920
targeting omron devices and through a

437
00:14:59,920 --> 00:15:01,199
very different

438
00:15:01,199 --> 00:15:02,959
execution cycle

439
00:15:02,959 --> 00:15:05,760
so it can also scan for omron devices

440
00:15:05,760 --> 00:15:07,760
using three different mechanisms it'll

441
00:15:07,760 --> 00:15:09,680
check the mac address of the device

442
00:15:09,680 --> 00:15:12,800
it'll parse the http response and it'll

443
00:15:12,800 --> 00:15:15,199
use the fins protocol fins being the

444
00:15:15,199 --> 00:15:16,480
factory

445
00:15:16,480 --> 00:15:18,160
interface network

446
00:15:18,160 --> 00:15:20,560
service which is a proprietary

447
00:15:20,560 --> 00:15:22,560
protocol from omron

448
00:15:22,560 --> 00:15:24,560
so after it identifies omron devices it

449
00:15:24,560 --> 00:15:27,760
primarily uses http to administer the

450
00:15:27,760 --> 00:15:29,120
device

451
00:15:29,120 --> 00:15:31,040
it will query for different types of

452
00:15:31,040 --> 00:15:33,120
information it can essentially change

453
00:15:33,120 --> 00:15:35,600
the configuration and again ultimately

454
00:15:35,600 --> 00:15:38,320
impact how that plc is executing

455
00:15:38,320 --> 00:15:39,920
and the physical processes that it's

456
00:15:39,920 --> 00:15:41,759
responsible for

457
00:15:41,759 --> 00:15:43,519
you can also read and write values of

458
00:15:43,519 --> 00:15:45,839
connected devices so not just that plc

459
00:15:45,839 --> 00:15:47,360
but other devices connected over

460
00:15:47,360 --> 00:15:49,680
ethercat it can change and read and

461
00:15:49,680 --> 00:15:52,240
write their values as well

462
00:15:52,240 --> 00:15:54,480
it can also execute the telnet daemon to

463
00:15:54,480 --> 00:15:55,920
initiate the telnet service on the

464
00:15:55,920 --> 00:15:57,839
device and transfer over an arbitrary

465
00:15:57,839 --> 00:16:00,160
payload uh potentially a shell that's

466
00:16:00,160 --> 00:16:02,000
why we called this particular

467
00:16:02,000 --> 00:16:04,160
malware family om shell

468
00:16:04,160 --> 00:16:06,480
there are also some other disruption

469
00:16:06,480 --> 00:16:08,959
capabilities they're not extensive as in

470
00:16:08,959 --> 00:16:10,639
code call but it has some simple

471
00:16:10,639 --> 00:16:12,959
capabilities like for example wiping the

472
00:16:12,959 --> 00:16:14,399
memory

473
00:16:14,399 --> 00:16:17,040
and lastly it also has a servo module so

474
00:16:17,040 --> 00:16:18,959
that it can explicitly interact with

475
00:16:18,959 --> 00:16:20,560
servo drives that are connected to the

476
00:16:20,560 --> 00:16:21,680
plc

477
00:16:21,680 --> 00:16:23,199
if you're not familiar with servo drives

478
00:16:23,199 --> 00:16:24,880
they essentially convert

479
00:16:24,880 --> 00:16:26,880
electrical power into precision motion

480
00:16:26,880 --> 00:16:29,440
control so you can think of like robotic

481
00:16:29,440 --> 00:16:31,199
applications that do pick and place

482
00:16:31,199 --> 00:16:33,519
types operations or anything else

483
00:16:33,519 --> 00:16:35,360
involving that type of precision motion

484
00:16:35,360 --> 00:16:37,600
control

485
00:16:37,600 --> 00:16:39,120
so it's a little bit less clear-cut

486
00:16:39,120 --> 00:16:41,360
which devices armshell is explicitly

487
00:16:41,360 --> 00:16:43,519
targeting versus those that had impact

488
00:16:43,519 --> 00:16:45,279
but we found a couple of references to

489
00:16:45,279 --> 00:16:48,000
specific plcs and an add-on module to

490
00:16:48,000 --> 00:16:49,680
those plcs

491
00:16:49,680 --> 00:16:51,519
so in a couple of places it references

492
00:16:51,519 --> 00:16:52,800
this nx

493
00:16:52,800 --> 00:16:55,600
1p2 and nj 501

494
00:16:55,600 --> 00:16:58,079
series of plcs this is actually the cpu

495
00:16:58,079 --> 00:17:00,880
unit of like more of a modular plc

496
00:17:00,880 --> 00:17:02,320
solution

497
00:17:02,320 --> 00:17:04,079
so these are both also involved in

498
00:17:04,079 --> 00:17:06,000
advanced motion control applications

499
00:17:06,000 --> 00:17:07,760
with one of them being

500
00:17:07,760 --> 00:17:09,760
more for compact solutions and the other

501
00:17:09,760 --> 00:17:12,079
being a bit more versatile for larger

502
00:17:12,079 --> 00:17:13,919
faster solutions

503
00:17:13,919 --> 00:17:17,039
there's also a specific reference to one

504
00:17:17,039 --> 00:17:19,599
servo module servo drive and omron

505
00:17:19,599 --> 00:17:22,400
actually offers 22 different omron servo

506
00:17:22,400 --> 00:17:24,559
drives in this r88d

507
00:17:24,559 --> 00:17:26,240
family of servo drives and we just see a

508
00:17:26,240 --> 00:17:28,319
reference to one particular one so that

509
00:17:28,319 --> 00:17:30,080
could be indicative of reconnaissance

510
00:17:30,080 --> 00:17:32,080
and to some targeted victim or it could

511
00:17:32,080 --> 00:17:34,080
just be a reflection of the attacker's

512
00:17:34,080 --> 00:17:36,559
testbed environment

513
00:17:36,559 --> 00:17:39,120
so i also mentioned that amchel does its

514
00:17:39,120 --> 00:17:41,200
initial identification by doing some mac

515
00:17:41,200 --> 00:17:43,039
address comparisons

516
00:17:43,039 --> 00:17:44,400
and i wanted to list here some of the

517
00:17:44,400 --> 00:17:47,280
different actually the omron specific

518
00:17:47,280 --> 00:17:49,440
mac addresses it looks for so one is

519
00:17:49,440 --> 00:17:51,360
related to their electronics division

520
00:17:51,360 --> 00:17:53,280
but there are also two specifically

521
00:17:53,280 --> 00:17:54,960
looking for the healthcare

522
00:17:54,960 --> 00:17:57,039
division of omron so while that's a

523
00:17:57,039 --> 00:17:58,000
little bit

524
00:17:58,000 --> 00:17:59,760
lower fidelity in terms of explicit

525
00:17:59,760 --> 00:18:01,600
targeting i think it's worth noting to

526
00:18:01,600 --> 00:18:03,440
highlight the the range of potentially

527
00:18:03,440 --> 00:18:06,400
impacted industries

528
00:18:06,880 --> 00:18:08,640
so next to talk about other impacted

529
00:18:08,640 --> 00:18:11,200
devices so again the primary protocol is

530
00:18:11,200 --> 00:18:13,520
http that it does to administer the

531
00:18:13,520 --> 00:18:14,400
device

532
00:18:14,400 --> 00:18:16,480
so potentially any other plc's that

533
00:18:16,480 --> 00:18:18,000
omron makes that are primarily

534
00:18:18,000 --> 00:18:19,280
administered over

535
00:18:19,280 --> 00:18:22,240
http could potentially be impacted and

536
00:18:22,240 --> 00:18:24,480
or targeted by this malware

537
00:18:24,480 --> 00:18:26,080
unfortunately omron doesn't have a lot

538
00:18:26,080 --> 00:18:28,080
of documentation that talks about their

539
00:18:28,080 --> 00:18:30,960
http protocol or api

540
00:18:30,960 --> 00:18:33,200
availability for some of the plcs but we

541
00:18:33,200 --> 00:18:35,120
know that there are others in the nj and

542
00:18:35,120 --> 00:18:37,760
nx series of plcs and so again when you

543
00:18:37,760 --> 00:18:39,520
see some of the public reporting listing

544
00:18:39,520 --> 00:18:41,440
other omron devices i think they're

545
00:18:41,440 --> 00:18:43,760
referring to impacted devices and again

546
00:18:43,760 --> 00:18:45,760
not necessarily explicitly targeted by

547
00:18:45,760 --> 00:18:47,039
the malware and i think that's a

548
00:18:47,039 --> 00:18:49,280
distinction worth making

549
00:18:49,280 --> 00:18:50,559
so we know some of those devices

550
00:18:50,559 --> 00:18:52,160
potentially support it as well but there

551
00:18:52,160 --> 00:18:54,320
could be others from omron and that's an

552
00:18:54,320 --> 00:18:57,280
area of ongoing research

553
00:18:57,280 --> 00:18:58,960
so lastly i'll cover those two windows

554
00:18:58,960 --> 00:19:00,080
tooling

555
00:19:00,080 --> 00:19:02,240
devices that we mentioned as well so one

556
00:19:02,240 --> 00:19:03,440
is a pretty straightforward

557
00:19:03,440 --> 00:19:05,360
implementation of an exploit targeting

558
00:19:05,360 --> 00:19:06,799
the as rock

559
00:19:06,799 --> 00:19:08,000
driver

560
00:19:08,000 --> 00:19:09,440
again it's straightforward so we didn't

561
00:19:09,440 --> 00:19:11,760
bother to classify this in a malware

562
00:19:11,760 --> 00:19:14,080
family but potentially this could be

563
00:19:14,080 --> 00:19:16,320
used in the it or ot network

564
00:19:16,320 --> 00:19:18,320
with again potentially some

565
00:19:18,320 --> 00:19:20,080
some types of systems in the ot network

566
00:19:20,080 --> 00:19:22,320
actually leveraging this motherboard

567
00:19:22,320 --> 00:19:24,400
the more interesting tool is ice core

568
00:19:24,400 --> 00:19:26,880
that's a commanded control and itot

569
00:19:26,880 --> 00:19:28,799
reconnaissance tool and here when i say

570
00:19:28,799 --> 00:19:30,160
reconnaissance i'm talking about the

571
00:19:30,160 --> 00:19:31,280
traditional

572
00:19:31,280 --> 00:19:33,120
network intrusion level reconnaissance

573
00:19:33,120 --> 00:19:34,640
where the attacker is looking for

574
00:19:34,640 --> 00:19:36,000
different systems and assets on the

575
00:19:36,000 --> 00:19:38,480
network to exploit them and gain further

576
00:19:38,480 --> 00:19:40,400
access so again there's a command and

577
00:19:40,400 --> 00:19:42,320
control tool it implements

578
00:19:42,320 --> 00:19:44,960
cnc over ssl and it has a couple of

579
00:19:44,960 --> 00:19:47,039
different capabilities related to

580
00:19:47,039 --> 00:19:49,919
for example doing wmi and enumerating

581
00:19:49,919 --> 00:19:52,919
directories

582
00:19:53,600 --> 00:19:55,440
so next nathan will talk about some

583
00:19:55,440 --> 00:19:56,880
high-level attack scenarios that we

584
00:19:56,880 --> 00:19:58,960
developed to kind of elaborate on these

585
00:19:58,960 --> 00:19:59,840
tools

586
00:19:59,840 --> 00:20:01,120
yeah thanks keith

587
00:20:01,120 --> 00:20:03,280
so you know we have limited information

588
00:20:03,280 --> 00:20:05,520
on what the attacker's intent is related

589
00:20:05,520 --> 00:20:07,200
to in controller so we thought it'd be

590
00:20:07,200 --> 00:20:08,640
helpful to kind of mock up some

591
00:20:08,640 --> 00:20:10,080
different scenarios to give you an idea

592
00:20:10,080 --> 00:20:11,919
about what is theoretically possible

593
00:20:11,919 --> 00:20:14,720
with the tech so in each of these cases

594
00:20:14,720 --> 00:20:16,000
well first of all if you want more

595
00:20:16,000 --> 00:20:17,039
information we're going to be pretty

596
00:20:17,039 --> 00:20:19,120
high level on this check out our blog we

597
00:20:19,120 --> 00:20:21,520
go into a bit more detail but for each

598
00:20:21,520 --> 00:20:23,360
of these scenarios it kind of expands

599
00:20:23,360 --> 00:20:26,159
from a lower sophistication scenario on

600
00:20:26,159 --> 00:20:29,200
up to destruction in scenario three so

601
00:20:29,200 --> 00:20:31,440
uh for all of these we kind of

602
00:20:31,440 --> 00:20:33,039
made an assumption that tag run would

603
00:20:33,039 --> 00:20:34,640
probably be used to enumerate and do

604
00:20:34,640 --> 00:20:37,600
recon certainly uh for scenario three

605
00:20:37,600 --> 00:20:39,440
and lesser extent as you move back down

606
00:20:39,440 --> 00:20:40,400
to one

607
00:20:40,400 --> 00:20:42,159
it's going to need a the attacker will

608
00:20:42,159 --> 00:20:43,760
need a decent amount of information on

609
00:20:43,760 --> 00:20:45,840
the physical process to actually plan

610
00:20:45,840 --> 00:20:48,720
out an attack and be successful so let's

611
00:20:48,720 --> 00:20:50,400
just jump into it scenario one this

612
00:20:50,400 --> 00:20:52,000
would be something similar to in

613
00:20:52,000 --> 00:20:54,640
destroyer one or two for that matter

614
00:20:54,640 --> 00:20:56,799
and where the actor would leverage kind

615
00:20:56,799 --> 00:20:58,480
of the lower level functionality to

616
00:20:58,480 --> 00:21:00,080
cause some sort of disruption which

617
00:21:00,080 --> 00:21:02,400
could shut down operations it'd be kind

618
00:21:02,400 --> 00:21:04,640
of less severe but still would make a

619
00:21:04,640 --> 00:21:07,520
point and statement scenario two is

620
00:21:07,520 --> 00:21:09,840
similar to stuxnet for example where the

621
00:21:09,840 --> 00:21:11,039
actor could

622
00:21:11,039 --> 00:21:13,360
carry out some sort of industrial

623
00:21:13,360 --> 00:21:16,240
sabotage and then leverage tag runs

624
00:21:16,240 --> 00:21:18,080
functionality to potentially hide that

625
00:21:18,080 --> 00:21:20,080
and let it carry on for a long period of

626
00:21:20,080 --> 00:21:22,720
time something like that scenario three

627
00:21:22,720 --> 00:21:24,400
would be akin to

628
00:21:24,400 --> 00:21:26,240
triton for example where the actor could

629
00:21:26,240 --> 00:21:28,400
leverage armshell to target specifically

630
00:21:28,400 --> 00:21:29,440
omron

631
00:21:29,440 --> 00:21:31,200
safety plcs

632
00:21:31,200 --> 00:21:33,440
leverage that access to

633
00:21:33,440 --> 00:21:36,000
allow for an unsafe state to persist and

634
00:21:36,000 --> 00:21:38,000
then go back and leverage other accesses

635
00:21:38,000 --> 00:21:40,080
and capabilities to actually make that

636
00:21:40,080 --> 00:21:42,000
unsafe state occur which could then

637
00:21:42,000 --> 00:21:44,640
spiral into some theoretical physical

638
00:21:44,640 --> 00:21:46,960
destruction this is similar to what we

639
00:21:46,960 --> 00:21:49,440
expected in triton from

640
00:21:49,440 --> 00:21:53,200
from that kind of attack perspective so

641
00:21:53,200 --> 00:21:54,880
let me pass it back over to keith for

642
00:21:54,880 --> 00:21:56,080
attribution and then we're going to wrap

643
00:21:56,080 --> 00:21:58,559
up with a couple of takeaways yep so

644
00:21:58,559 --> 00:22:00,240
when we did our reverse engineer of in

645
00:22:00,240 --> 00:22:02,400
controller we didn't identify any

646
00:22:02,400 --> 00:22:04,240
obvious overlaps with any previously

647
00:22:04,240 --> 00:22:05,679
tracked groups so right now we're

648
00:22:05,679 --> 00:22:07,919
tracking this as a new cluster of threat

649
00:22:07,919 --> 00:22:10,240
activity we think it's very likely that

650
00:22:10,240 --> 00:22:11,679
this is state-sponsored for a few

651
00:22:11,679 --> 00:22:13,120
different reasons

652
00:22:13,120 --> 00:22:15,679
one it's a really complex tool two it

653
00:22:15,679 --> 00:22:17,440
probably required a significant amount

654
00:22:17,440 --> 00:22:19,440
of investment in terms of expertise and

655
00:22:19,440 --> 00:22:21,600
resource costs and three there isn't

656
00:22:21,600 --> 00:22:24,080
really a obvious utility that other

657
00:22:24,080 --> 00:22:26,400
financially motivated threat actors

658
00:22:26,400 --> 00:22:27,360
would

659
00:22:27,360 --> 00:22:29,120
would be motivated to to use this tool

660
00:22:29,120 --> 00:22:31,440
for so it's very likely state-sponsored

661
00:22:31,440 --> 00:22:33,360
we found some initial circumstantial

662
00:22:33,360 --> 00:22:36,159
evidence that this is a russian nexus

663
00:22:36,159 --> 00:22:37,679
unfortunately we can't share too much

664
00:22:37,679 --> 00:22:38,960
information about that publicly at the

665
00:22:38,960 --> 00:22:41,200
moment but i think it's worth mentioning

666
00:22:41,200 --> 00:22:43,440
giving the current geopolitical context

667
00:22:43,440 --> 00:22:45,760
and the history of russia's

668
00:22:45,760 --> 00:22:48,400
threat activity targeting ics uh so here

669
00:22:48,400 --> 00:22:50,159
we're displaying kind of a high-level

670
00:22:50,159 --> 00:22:51,919
history of a lot of what they've done

671
00:22:51,919 --> 00:22:53,120
and

672
00:22:53,120 --> 00:22:55,280
basically to cover it since 2014 we've

673
00:22:55,280 --> 00:22:57,679
seen them target ics uh through a number

674
00:22:57,679 --> 00:22:59,600
of different espionage campaigns cyber

675
00:22:59,600 --> 00:23:01,840
physical attacks uh sometimes the

676
00:23:01,840 --> 00:23:04,000
malware is leveraging specific ics

677
00:23:04,000 --> 00:23:06,640
exploits so for instance piece pipe back

678
00:23:06,640 --> 00:23:08,640
in 2014 this is some of what was covered

679
00:23:08,640 --> 00:23:09,679
in the

680
00:23:09,679 --> 00:23:11,200
department of justice indictments that

681
00:23:11,200 --> 00:23:13,919
were released last month

682
00:23:13,919 --> 00:23:17,280
in 2015 they leveraged black energy

683
00:23:17,280 --> 00:23:19,840
to target different types of

684
00:23:19,840 --> 00:23:22,159
internet exposed hdmis

685
00:23:22,159 --> 00:23:24,000
there was multiple attacks targeting the

686
00:23:24,000 --> 00:23:26,159
ukrainian power grid so there's a long

687
00:23:26,159 --> 00:23:28,240
history of russia's attacks targeting

688
00:23:28,240 --> 00:23:29,520
ics

689
00:23:29,520 --> 00:23:31,679
more broadly a lot of the capabilities

690
00:23:31,679 --> 00:23:33,280
that we found in controller are

691
00:23:33,280 --> 00:23:34,960
consistent with some of those attacks so

692
00:23:34,960 --> 00:23:37,200
for instance in the different ukrainian

693
00:23:37,200 --> 00:23:39,600
power grid attacks they did some ics

694
00:23:39,600 --> 00:23:42,080
manipulations followed by a lot of

695
00:23:42,080 --> 00:23:44,960
discrete disruptive events

696
00:23:44,960 --> 00:23:46,799
wiping windows systems wiping linux

697
00:23:46,799 --> 00:23:47,919
systems

698
00:23:47,919 --> 00:23:50,559
wiping embedded embedded assets bricking

699
00:23:50,559 --> 00:23:52,880
serial to ethernet converters so the

700
00:23:52,880 --> 00:23:54,640
overall strategy they've employed in

701
00:23:54,640 --> 00:23:56,240
some of those attacks is really

702
00:23:56,240 --> 00:23:57,760
consistent with the capabilities that

703
00:23:57,760 --> 00:24:00,880
we're seeing in controller

704
00:24:00,880 --> 00:24:02,320
so we wanted to end with some high level

705
00:24:02,320 --> 00:24:03,840
considerations

706
00:24:03,840 --> 00:24:06,159
basically open-ended questions that we

707
00:24:06,159 --> 00:24:08,320
think are worth thinking about

708
00:24:08,320 --> 00:24:10,000
so the first one would be is how should

709
00:24:10,000 --> 00:24:10,720
we

710
00:24:10,720 --> 00:24:12,640
consider the threat posed by in

711
00:24:12,640 --> 00:24:13,679
controller

712
00:24:13,679 --> 00:24:15,600
so for example is this targeted towards

713
00:24:15,600 --> 00:24:18,240
some specific victim like certainly was

714
00:24:18,240 --> 00:24:19,840
in the case of stuxnet but also

715
00:24:19,840 --> 00:24:21,520
potentially in triton

716
00:24:21,520 --> 00:24:22,960
so you might recall in the trident

717
00:24:22,960 --> 00:24:24,799
incident that the actor got control of

718
00:24:24,799 --> 00:24:26,799
the ics network and basically

719
00:24:26,799 --> 00:24:28,960
immediately deployed triton which was

720
00:24:28,960 --> 00:24:31,200
tailored to a specific make and model of

721
00:24:31,200 --> 00:24:33,279
a safety controller

722
00:24:33,279 --> 00:24:34,640
so i mentioned a couple of times

723
00:24:34,640 --> 00:24:36,159
throughout this talk that there are some

724
00:24:36,159 --> 00:24:38,559
very specific devices that this

725
00:24:38,559 --> 00:24:40,320
malware currently seems weaponized

726
00:24:40,320 --> 00:24:42,480
toward so that could be indicative of

727
00:24:42,480 --> 00:24:45,120
some type of reconnaissance into some

728
00:24:45,120 --> 00:24:47,200
particular victims environment

729
00:24:47,200 --> 00:24:48,960
now alternatively we could view this as

730
00:24:48,960 --> 00:24:50,960
a capability so rather than focusing on

731
00:24:50,960 --> 00:24:52,960
the devices it's targeting think about

732
00:24:52,960 --> 00:24:54,159
some of those protocols that it

733
00:24:54,159 --> 00:24:56,000
implements like

734
00:24:56,000 --> 00:24:59,279
codesys and opc ua and modbus so that

735
00:24:59,279 --> 00:25:01,760
gives it really a broad use case across

736
00:25:01,760 --> 00:25:03,600
a lot of different environments

737
00:25:03,600 --> 00:25:04,960
and has potentially a repeatable

738
00:25:04,960 --> 00:25:08,159
capability like we saw within destroyer

739
00:25:08,159 --> 00:25:09,520
so i think another question that's worth

740
00:25:09,520 --> 00:25:11,279
thinking about is

741
00:25:11,279 --> 00:25:13,120
go back one slide

742
00:25:13,120 --> 00:25:14,880
i've gotten this one

743
00:25:14,880 --> 00:25:16,799
oh yeah what industries are most likely

744
00:25:16,799 --> 00:25:18,240
to be targeted

745
00:25:18,240 --> 00:25:20,159
so there were some initial analysis

746
00:25:20,159 --> 00:25:21,919
reporting that it could be utilities as

747
00:25:21,919 --> 00:25:23,520
a primary focus of this

748
00:25:23,520 --> 00:25:25,200
utilities have been the focus of a lot

749
00:25:25,200 --> 00:25:27,360
of prior activity but when we look at

750
00:25:27,360 --> 00:25:29,039
some of the devices that are impacted by

751
00:25:29,039 --> 00:25:30,000
this

752
00:25:30,000 --> 00:25:32,080
like for instance those nano plc's that

753
00:25:32,080 --> 00:25:34,159
have a lot of use cases in standalone

754
00:25:34,159 --> 00:25:35,200
machinery

755
00:25:35,200 --> 00:25:36,559
i think it's much more likely that we

756
00:25:36,559 --> 00:25:38,159
see some sort of manufacturing like

757
00:25:38,159 --> 00:25:39,679
target and a lot of different

758
00:25:39,679 --> 00:25:42,720
environments use these plc's all flavors

759
00:25:42,720 --> 00:25:44,400
of manufacturing like

760
00:25:44,400 --> 00:25:46,400
automotive aerospace

761
00:25:46,400 --> 00:25:48,080
even food and beverage and other types

762
00:25:48,080 --> 00:25:50,159
of service industries like for example

763
00:25:50,159 --> 00:25:51,600
shipping could use a lot of these

764
00:25:51,600 --> 00:25:53,440
different types of machines so i think

765
00:25:53,440 --> 00:25:55,200
there's a really broad applicability of

766
00:25:55,200 --> 00:25:56,720
these and that's important to get the

767
00:25:56,720 --> 00:25:58,640
messaging right so that all the

768
00:25:58,640 --> 00:26:00,000
different affected

769
00:26:00,000 --> 00:26:02,480
companies and organizations know to

770
00:26:02,480 --> 00:26:04,240
potentially look out for this malware

771
00:26:04,240 --> 00:26:06,320
and that it poses a risk to them yeah to

772
00:26:06,320 --> 00:26:08,799
be clear on that point we don't have any

773
00:26:08,799 --> 00:26:11,200
information to indicate a very specific

774
00:26:11,200 --> 00:26:12,880
sector or we obviously would have told

775
00:26:12,880 --> 00:26:14,000
you

776
00:26:14,000 --> 00:26:15,919
instead as keith mentioned we really

777
00:26:15,919 --> 00:26:17,919
want to expand the aperture here if you

778
00:26:17,919 --> 00:26:20,320
have these devices on your network you

779
00:26:20,320 --> 00:26:22,880
should definitely figure that out and

780
00:26:22,880 --> 00:26:25,520
mitigate any risk to them so

781
00:26:25,520 --> 00:26:27,200
if people are telling you otherwise you

782
00:26:27,200 --> 00:26:28,640
should ask them why and look for

783
00:26:28,640 --> 00:26:30,320
evidence

784
00:26:30,320 --> 00:26:32,559
all right so that's the gist of our talk

785
00:26:32,559 --> 00:26:35,760
i think we got four minutes so uh

786
00:26:35,760 --> 00:26:37,600
just to highlight some of the things

787
00:26:37,600 --> 00:26:38,960
that we can provide you if you have

788
00:26:38,960 --> 00:26:40,799
customers or if you yourselves are

789
00:26:40,799 --> 00:26:42,559
impacted our blog has a bunch of

790
00:26:42,559 --> 00:26:45,039
different uh mitigations and hunting

791
00:26:45,039 --> 00:26:46,400
rules and things like that we're hoping

792
00:26:46,400 --> 00:26:48,559
to rule more stuff out over time so

793
00:26:48,559 --> 00:26:50,159
check back there if you are interested

794
00:26:50,159 --> 00:26:52,320
in any of that but that's it for us

795
00:26:52,320 --> 00:26:53,760
thank you so much we appreciate your

796
00:26:53,760 --> 00:26:55,440
time and we will see you at the cabana

797
00:26:55,440 --> 00:26:56,320
session

798
00:26:56,320 --> 00:26:59,320
thanks

