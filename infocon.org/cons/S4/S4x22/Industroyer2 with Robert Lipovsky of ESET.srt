1
00:00:05,730 --> 00:00:07,710
[Music]

2
00:00:07,710 --> 00:00:10,800
[Applause]

3
00:00:11,120 --> 00:00:13,840
hello everyone

4
00:00:14,320 --> 00:00:17,119
so in destroyers back

5
00:00:17,119 --> 00:00:19,520
that's going to be the main subject of

6
00:00:19,520 --> 00:00:21,680
uh my talk my talk today but it's not

7
00:00:21,680 --> 00:00:23,039
going to be the only thing

8
00:00:23,039 --> 00:00:24,960
we're going to focus on we'll also put

9
00:00:24,960 --> 00:00:27,359
the attack into perspective and and

10
00:00:27,359 --> 00:00:29,199
cover also the context that it's

11
00:00:29,199 --> 00:00:30,720
happening and also look at the other

12
00:00:30,720 --> 00:00:31,840
attacks

13
00:00:31,840 --> 00:00:33,360
that we've been

14
00:00:33,360 --> 00:00:35,520
seeing that we've detected

15
00:00:35,520 --> 00:00:37,520
in ukraine since the beginning of the

16
00:00:37,520 --> 00:00:40,879
russian invasion as well as in the past

17
00:00:40,879 --> 00:00:44,320
eight years so i'm glad to be here uh as

18
00:00:44,320 --> 00:00:46,399
a last-minute presentation so thank you

19
00:00:46,399 --> 00:00:48,719
for thanks dale for for having me and

20
00:00:48,719 --> 00:00:49,760
and

21
00:00:49,760 --> 00:00:52,879
that we were able to set this up uh so

22
00:00:52,879 --> 00:00:55,039
last minute uh it's my first time uh

23
00:00:55,039 --> 00:00:57,760
here at s4 although i did speak

24
00:00:57,760 --> 00:00:59,680
at dale's

25
00:00:59,680 --> 00:01:02,239
conferences in stockholm

26
00:01:02,239 --> 00:01:04,559
on the early

27
00:01:04,559 --> 00:01:07,360
earlier cyber attacks in ukraine which

28
00:01:07,360 --> 00:01:10,240
i'll mention uh very briefly as well so

29
00:01:10,240 --> 00:01:11,680
this is the agenda that we have for

30
00:01:11,680 --> 00:01:12,880
today

31
00:01:12,880 --> 00:01:15,119
i'll begin with uh

32
00:01:15,119 --> 00:01:18,479
a recap of the original in destroyer uh

33
00:01:18,479 --> 00:01:20,799
the first version in 20s that we

34
00:01:20,799 --> 00:01:23,119
detected in 2016.

35
00:01:23,119 --> 00:01:26,159
uh i'm sure for you for this audience

36
00:01:26,159 --> 00:01:28,560
this needs very little introduction

37
00:01:28,560 --> 00:01:31,200
uh as uh you all read all the

38
00:01:31,200 --> 00:01:33,040
publications about it and i guess some

39
00:01:33,040 --> 00:01:35,040
of you maybe even worked analyzed it

40
00:01:35,040 --> 00:01:38,159
yourselves or were somehow uh part of

41
00:01:38,159 --> 00:01:40,640
that investigation uh for the but it's

42
00:01:40,640 --> 00:01:43,119
been over five years so so i'll do a

43
00:01:43,119 --> 00:01:44,960
little memory refresh so that we can

44
00:01:44,960 --> 00:01:46,079
compare

45
00:01:46,079 --> 00:01:49,439
uh the functionality and the changes uh

46
00:01:49,439 --> 00:01:51,920
in the new version that we discovered uh

47
00:01:51,920 --> 00:01:54,720
on the 8th of april um the malware

48
00:01:54,720 --> 00:01:57,360
wasn't deployed by itself uh there was

49
00:01:57,360 --> 00:02:00,000
other malware involved in that incident

50
00:02:00,000 --> 00:02:02,719
so we'll briefly discuss that as well

51
00:02:02,719 --> 00:02:04,479
and then we'll continue

52
00:02:04,479 --> 00:02:06,399
as i mentioned putting all of this into

53
00:02:06,399 --> 00:02:09,038
perspective and talking about talking

54
00:02:09,038 --> 00:02:11,280
about some of the the attacks the most

55
00:02:11,280 --> 00:02:14,080
notable attacks that the perpetrator uh

56
00:02:14,080 --> 00:02:17,680
the san juan apd group has been up to

57
00:02:17,680 --> 00:02:20,080
okay so uh

58
00:02:20,080 --> 00:02:22,560
a few words about myself robert lepowski

59
00:02:22,560 --> 00:02:26,239
i work for eset i've been doing

60
00:02:26,239 --> 00:02:29,280
threat intelligence research for over 15

61
00:02:29,280 --> 00:02:30,480
years now

62
00:02:30,480 --> 00:02:32,720
i lead a team of researchers in

63
00:02:32,720 --> 00:02:35,680
bratislava slovakia so what i'm going to

64
00:02:35,680 --> 00:02:38,560
be presenting today is not my personal

65
00:02:38,560 --> 00:02:40,560
discoveries but it's very much a team

66
00:02:40,560 --> 00:02:42,480
effort and the main credit goes to my

67
00:02:42,480 --> 00:02:45,920
colleague anton cherepanov

68
00:02:46,000 --> 00:02:49,360
and our focus in our team it's not ics

69
00:02:49,360 --> 00:02:51,519
centric instead our coverage is is

70
00:02:51,519 --> 00:02:53,599
pretty broad so

71
00:02:53,599 --> 00:02:54,400
we

72
00:02:54,400 --> 00:02:56,879
we look at we investigate we track and

73
00:02:56,879 --> 00:02:58,000
analyze

74
00:02:58,000 --> 00:03:02,080
uh apts nation-state actors but also

75
00:03:02,080 --> 00:03:04,400
e-crimes or regular cyber crime that's

76
00:03:04,400 --> 00:03:07,040
financially motivated and we also do uh

77
00:03:07,040 --> 00:03:10,159
some uh actual technical vulnerability

78
00:03:10,159 --> 00:03:12,480
research as well so pretty broad

79
00:03:12,480 --> 00:03:14,560
uh scope

80
00:03:14,560 --> 00:03:16,480
for those of you who

81
00:03:16,480 --> 00:03:19,680
uh don't know eset so we're a company

82
00:03:19,680 --> 00:03:23,040
based in slovakia and we're actually the

83
00:03:23,040 --> 00:03:24,000
biggest

84
00:03:24,000 --> 00:03:24,879
uh

85
00:03:24,879 --> 00:03:26,640
internet security provider in the

86
00:03:26,640 --> 00:03:28,319
european union

87
00:03:28,319 --> 00:03:30,640
um

88
00:03:30,640 --> 00:03:32,799
the fact that allows us to have all of

89
00:03:32,799 --> 00:03:36,159
this visibility and and and to

90
00:03:36,159 --> 00:03:38,879
what it enables me to uh bring to you

91
00:03:38,879 --> 00:03:40,159
the things i'm going to be talking about

92
00:03:40,159 --> 00:03:42,959
today is that we're also

93
00:03:42,959 --> 00:03:45,440
uh the most widely used security vendor

94
00:03:45,440 --> 00:03:48,239
in ukraine

95
00:03:48,239 --> 00:03:50,799
so we do we do endpoint security and edr

96
00:03:50,799 --> 00:03:53,280
xdr all that stuff but we also provide

97
00:03:53,280 --> 00:03:56,400
threat intelligence uh feeds to our

98
00:03:56,400 --> 00:03:58,879
subscribers as well

99
00:03:58,879 --> 00:04:02,319
so let's get on with it uh in industry

100
00:04:02,319 --> 00:04:04,720
one in 2016.

101
00:04:04,720 --> 00:04:06,480
so i'll first talk about the malware

102
00:04:06,480 --> 00:04:09,120
itself uh its architecture uh so that we

103
00:04:09,120 --> 00:04:12,159
can compare it to to the new version

104
00:04:12,159 --> 00:04:14,720
and along the way i'll i'll

105
00:04:14,720 --> 00:04:16,959
mention the impact and compare the

106
00:04:16,959 --> 00:04:19,440
impact as well uh so the first version

107
00:04:19,440 --> 00:04:21,918
of industry was uh as it's often called

108
00:04:21,918 --> 00:04:24,000
it's it's a modular framework so so

109
00:04:24,000 --> 00:04:26,160
there was a lot of components involved

110
00:04:26,160 --> 00:04:28,000
in there there it begins with the main

111
00:04:28,000 --> 00:04:30,479
backdoor uh it that establishes

112
00:04:30,479 --> 00:04:34,400
persistence uh on the system and and it

113
00:04:34,400 --> 00:04:36,560
uh makes sure that it stays persistent

114
00:04:36,560 --> 00:04:38,160
so there's even additional back door in

115
00:04:38,160 --> 00:04:40,880
case the first one uh gets uh gets

116
00:04:40,880 --> 00:04:43,840
removed somehow uh they're accompanying

117
00:04:43,840 --> 00:04:45,360
tools as i mentioned there's the port

118
00:04:45,360 --> 00:04:47,280
scanner there's the denial of service

119
00:04:47,280 --> 00:04:49,440
tool we'll get back to that in just a

120
00:04:49,440 --> 00:04:52,320
second because that's really important

121
00:04:52,320 --> 00:04:53,600
then the back door

122
00:04:53,600 --> 00:04:56,240
launches a launcher component and that's

123
00:04:56,240 --> 00:04:57,919
in charge of

124
00:04:57,919 --> 00:05:00,479
executing the most important parts

125
00:05:00,479 --> 00:05:02,880
which are these for payload at a

126
00:05:02,880 --> 00:05:04,240
specific

127
00:05:04,240 --> 00:05:06,320
time so that time is hard-coded in the

128
00:05:06,320 --> 00:05:07,360
malware

129
00:05:07,360 --> 00:05:10,960
and it was set to december 17th

130
00:05:10,960 --> 00:05:13,280
uh sometime before midnight about an

131
00:05:13,280 --> 00:05:14,720
hour and a half before midnight well

132
00:05:14,720 --> 00:05:17,759
that was utc time so around midnight in

133
00:05:17,759 --> 00:05:21,039
ukrainian local time

134
00:05:21,440 --> 00:05:22,400
and

135
00:05:22,400 --> 00:05:23,120
it

136
00:05:23,120 --> 00:05:25,840
what makes the malware unique and and

137
00:05:25,840 --> 00:05:28,639
when we discovered it it sort of uh blew

138
00:05:28,639 --> 00:05:31,520
our minds because this i mean we

139
00:05:31,520 --> 00:05:33,199
uh we detect new malware every single

140
00:05:33,199 --> 00:05:35,120
day and we detect malware that's

141
00:05:35,120 --> 00:05:37,120
probably worthy of mentioning and

142
00:05:37,120 --> 00:05:38,400
speaking about

143
00:05:38,400 --> 00:05:41,120
uh because it's unique in some way every

144
00:05:41,120 --> 00:05:44,720
month i suppose but for us to

145
00:05:44,720 --> 00:05:48,080
find this malware that's able to to

146
00:05:48,080 --> 00:05:49,039
speak

147
00:05:49,039 --> 00:05:51,440
with industrial uh hardware with

148
00:05:51,440 --> 00:05:53,280
protection relays and remote terminal

149
00:05:53,280 --> 00:05:54,479
units

150
00:05:54,479 --> 00:05:56,319
in using using these industrial

151
00:05:56,319 --> 00:05:57,759
communication protocols that's something

152
00:05:57,759 --> 00:05:59,520
that we have never seen before

153
00:05:59,520 --> 00:06:02,639
and industry basically joined this elite

154
00:06:02,639 --> 00:06:04,560
league of malware that can be counted on

155
00:06:04,560 --> 00:06:06,720
the on the fingers of just one hand

156
00:06:06,720 --> 00:06:09,600
that's directly uh

157
00:06:09,600 --> 00:06:11,600
affecting industrial

158
00:06:11,600 --> 00:06:14,240
hardware uh the others being like

159
00:06:14,240 --> 00:06:16,960
stuxnet and heavyx and and then triton

160
00:06:16,960 --> 00:06:19,680
that came after it

161
00:06:19,680 --> 00:06:21,680
okay so uh

162
00:06:21,680 --> 00:06:23,120
again this is just a refresher so i'm

163
00:06:23,120 --> 00:06:25,120
not going to go into all of the details

164
00:06:25,120 --> 00:06:27,039
about uh all of these

165
00:06:27,039 --> 00:06:28,560
communication protocols that's not

166
00:06:28,560 --> 00:06:29,680
necessary

167
00:06:29,680 --> 00:06:31,600
but i'll focus on this one just just a

168
00:06:31,600 --> 00:06:35,039
little bit further and that's iec 104 so

169
00:06:35,039 --> 00:06:38,240
it's a protocol based on tcp

170
00:06:38,240 --> 00:06:41,759
it operates in one of these modes range

171
00:06:41,759 --> 00:06:44,160
shift or sequence and its functionality

172
00:06:44,160 --> 00:06:46,319
is very dependent on the configuration

173
00:06:46,319 --> 00:06:48,400
that the malware is supplied

174
00:06:48,400 --> 00:06:50,160
uh this is an important thing to note

175
00:06:50,160 --> 00:06:51,840
and and that's also a differentiator

176
00:06:51,840 --> 00:06:54,080
from the new version uh here with

177
00:06:54,080 --> 00:06:56,960
indestroyer one uh the configurations

178
00:06:56,960 --> 00:06:59,280
were separate any files and there was a

179
00:06:59,280 --> 00:07:01,039
separate configuration for all of these

180
00:07:01,039 --> 00:07:03,360
payloads these payloads themselves were

181
00:07:03,360 --> 00:07:06,720
implemented as dlls that were basically

182
00:07:06,720 --> 00:07:08,560
part of the framework so here's an

183
00:07:08,560 --> 00:07:10,639
example of what such such a

184
00:07:10,639 --> 00:07:12,960
configuration file for this payload

185
00:07:12,960 --> 00:07:15,520
could look like it has the target ip the

186
00:07:15,520 --> 00:07:19,199
ports pretty standard stuff asdu

187
00:07:19,199 --> 00:07:21,360
it operates on

188
00:07:21,360 --> 00:07:24,080
ios information object addresses

189
00:07:24,080 --> 00:07:25,039
goes through

190
00:07:25,039 --> 00:07:27,280
can go through a range of these and it

191
00:07:27,280 --> 00:07:28,800
can also

192
00:07:28,800 --> 00:07:30,560
operate in parallel so targeting

193
00:07:30,560 --> 00:07:32,720
different uh different stations

194
00:07:32,720 --> 00:07:35,520
uh simultaneously

195
00:07:35,520 --> 00:07:37,360
um

196
00:07:37,360 --> 00:07:39,199
the code

197
00:07:39,199 --> 00:07:41,120
tells us basically what what it's doing

198
00:07:41,120 --> 00:07:44,960
so so it's producing uh command line uh

199
00:07:44,960 --> 00:07:47,919
output and also a log file so that kind

200
00:07:47,919 --> 00:07:49,919
of gives us an idea

201
00:07:49,919 --> 00:07:51,919
about its capability

202
00:07:51,919 --> 00:07:53,360
um

203
00:07:53,360 --> 00:07:56,080
from a high level perspective and just

204
00:07:56,080 --> 00:07:58,560
to really simplify it its main

205
00:07:58,560 --> 00:08:00,479
functionality is to change the state of

206
00:08:00,479 --> 00:08:03,120
the circuit breakers uh between open and

207
00:08:03,120 --> 00:08:04,160
closed

208
00:08:04,160 --> 00:08:06,319
so it can either change those uh

209
00:08:06,319 --> 00:08:09,120
discrete values or it can also

210
00:08:09,120 --> 00:08:11,840
uh depending again on the configuration

211
00:08:11,840 --> 00:08:14,160
it can do a strobing effect so switching

212
00:08:14,160 --> 00:08:18,560
between uh open closed back and forth

213
00:08:18,560 --> 00:08:20,319
okay so there were there were also these

214
00:08:20,319 --> 00:08:22,800
these other ones and all of those were

215
00:08:22,800 --> 00:08:26,080
executed and targeted different parts uh

216
00:08:26,080 --> 00:08:28,319
different different different equipment

217
00:08:28,319 --> 00:08:31,280
different remote terminal units at that

218
00:08:31,280 --> 00:08:35,519
electricity uh electrical substation

219
00:08:35,519 --> 00:08:37,200
but that was not the only thing so so

220
00:08:37,200 --> 00:08:38,559
these were the components that were

221
00:08:38,559 --> 00:08:41,839
there in place to to cause the impact of

222
00:08:41,839 --> 00:08:43,360
de-energizing

223
00:08:43,360 --> 00:08:46,320
uh the grid but that impact was

224
00:08:46,320 --> 00:08:48,080
amplified by

225
00:08:48,080 --> 00:08:50,000
by other modules that were there in

226
00:08:50,000 --> 00:08:52,640
place and there was a wiper component uh

227
00:08:52,640 --> 00:08:53,920
that's the one

228
00:08:53,920 --> 00:08:56,320
again launched by the launcher

229
00:08:56,320 --> 00:08:58,399
that you can see that you can see here

230
00:08:58,399 --> 00:08:59,839
and its purpose

231
00:08:59,839 --> 00:09:01,920
obviously it was to amplify the impact

232
00:09:01,920 --> 00:09:03,040
by making

233
00:09:03,040 --> 00:09:03,839
uh

234
00:09:03,839 --> 00:09:05,680
making recovery efforts more difficult

235
00:09:05,680 --> 00:09:07,440
so that the operators would have a

236
00:09:07,440 --> 00:09:08,480
harder time

237
00:09:08,480 --> 00:09:11,120
uh getting power back online it would

238
00:09:11,120 --> 00:09:13,279
take them offline they basically denied

239
00:09:13,279 --> 00:09:16,080
them visibility and control of what was

240
00:09:16,080 --> 00:09:18,640
going on in that substation so this is

241
00:09:18,640 --> 00:09:22,880
this is a significant part to the attack

242
00:09:22,880 --> 00:09:26,640
it was it was going after specific uh

243
00:09:26,640 --> 00:09:29,040
software's the specific machines running

244
00:09:29,040 --> 00:09:30,800
scada software the examples that you can

245
00:09:30,800 --> 00:09:33,920
see here so it was wiping the files uh

246
00:09:33,920 --> 00:09:35,440
that are the configuration files for

247
00:09:35,440 --> 00:09:37,360
some of these uh

248
00:09:37,360 --> 00:09:39,360
scada applications

249
00:09:39,360 --> 00:09:41,760
but also it will continue to

250
00:09:41,760 --> 00:09:42,720
corrupt

251
00:09:42,720 --> 00:09:45,519
the registry and reboot the machine and

252
00:09:45,519 --> 00:09:48,800
effectively make it make it unbootable

253
00:09:48,800 --> 00:09:50,640
but there was another component to the

254
00:09:50,640 --> 00:09:53,040
attack and that was a denial of service

255
00:09:53,040 --> 00:09:55,120
functionality implemented by as i

256
00:09:55,120 --> 00:09:57,760
mentioned in the in the overview by the

257
00:09:57,760 --> 00:10:00,160
denial of service uh

258
00:10:00,160 --> 00:10:03,040
component and this abused a

259
00:10:03,040 --> 00:10:05,440
vulnerability that was in siemens uh

260
00:10:05,440 --> 00:10:07,600
cyprus devices this was not a zero day

261
00:10:07,600 --> 00:10:09,200
so so

262
00:10:09,200 --> 00:10:12,160
a patch for that uh vulnerability had

263
00:10:12,160 --> 00:10:14,399
been made available uh by siemens

264
00:10:14,399 --> 00:10:16,000
nevertheless

265
00:10:16,000 --> 00:10:18,560
it was abused by the malware uh

266
00:10:18,560 --> 00:10:21,680
technically it's it's not that special

267
00:10:21,680 --> 00:10:23,839
it's but sen it's sending a specially

268
00:10:23,839 --> 00:10:28,560
crafted uh packet to udp port 50 000. uh

269
00:10:28,560 --> 00:10:30,320
this is an example this is this is

270
00:10:30,320 --> 00:10:33,040
actually what it looks like and the

271
00:10:33,040 --> 00:10:35,519
effect of sending this is that

272
00:10:35,519 --> 00:10:38,320
or the way that it causes the denial of

273
00:10:38,320 --> 00:10:41,040
service of these protection relays is

274
00:10:41,040 --> 00:10:44,160
that it effectively uh sends them into a

275
00:10:44,160 --> 00:10:46,800
firmware update mode and as you're all

276
00:10:46,800 --> 00:10:49,600
very well aware when you update the the

277
00:10:49,600 --> 00:10:51,440
operating system on your phones or on

278
00:10:51,440 --> 00:10:54,399
your on your laptop uh you pretty much

279
00:10:54,399 --> 00:10:56,800
can't use it right so that's the basic

280
00:10:56,800 --> 00:10:59,920
idea here with this with this exploit

281
00:10:59,920 --> 00:11:02,560
that uh these protection relays would

282
00:11:02,560 --> 00:11:05,440
not be doing their job uh

283
00:11:05,440 --> 00:11:06,240
and

284
00:11:06,240 --> 00:11:08,079
why were they doing that why why were

285
00:11:08,079 --> 00:11:10,079
the attackers trying to

286
00:11:10,079 --> 00:11:11,200
uh

287
00:11:11,200 --> 00:11:12,240
to do that so we have the

288
00:11:12,240 --> 00:11:15,519
de-energization we have the wiper module

289
00:11:15,519 --> 00:11:17,920
denying the operators visibility and

290
00:11:17,920 --> 00:11:19,839
control and then then we have protection

291
00:11:19,839 --> 00:11:21,040
relays

292
00:11:21,040 --> 00:11:23,360
being taken offline so when the

293
00:11:23,360 --> 00:11:27,200
attackers would uh go into manual mode

294
00:11:27,200 --> 00:11:29,839
and try to restore power uh during the

295
00:11:29,839 --> 00:11:32,640
incident then this could have the

296
00:11:32,640 --> 00:11:35,519
potential of causing physical damage to

297
00:11:35,519 --> 00:11:38,560
equipment all that being said this all

298
00:11:38,560 --> 00:11:40,800
this capability is in stark contrast

299
00:11:40,800 --> 00:11:43,600
with what was actually

300
00:11:43,600 --> 00:11:45,360
actually achieved

301
00:11:45,360 --> 00:11:47,600
by industry so

302
00:11:47,600 --> 00:11:50,000
it did cause a blackout

303
00:11:50,000 --> 00:11:53,680
the blackout lasted for about one hour

304
00:11:53,680 --> 00:11:55,279
but i think we can all agree that that's

305
00:11:55,279 --> 00:11:57,200
not the worst that they could have done

306
00:11:57,200 --> 00:11:58,880
and

307
00:11:58,880 --> 00:12:01,760
the intended impact the intended damage

308
00:12:01,760 --> 00:12:03,839
that they were trying to cause which was

309
00:12:03,839 --> 00:12:05,200
much much

310
00:12:05,200 --> 00:12:07,440
much larger

311
00:12:07,440 --> 00:12:09,360
so with that

312
00:12:09,360 --> 00:12:13,760
let's move on to in destroyer 2.

313
00:12:14,399 --> 00:12:17,279
this was a collaboration with with sir

314
00:12:17,279 --> 00:12:19,040
eway

315
00:12:19,040 --> 00:12:21,760
so so thanks to them we were able to

316
00:12:21,760 --> 00:12:22,880
analyze

317
00:12:22,880 --> 00:12:25,279
the malware and they also

318
00:12:25,279 --> 00:12:27,760
released their report

319
00:12:27,760 --> 00:12:29,920
on it so that's the screenshot that you

320
00:12:29,920 --> 00:12:31,600
can see here

321
00:12:31,600 --> 00:12:32,800
and

322
00:12:32,800 --> 00:12:33,839
uh

323
00:12:33,839 --> 00:12:36,079
really a hat tip to them for

324
00:12:36,079 --> 00:12:38,880
being able to to thwart the attack and

325
00:12:38,880 --> 00:12:41,440
and and to basically mitigate it and not

326
00:12:41,440 --> 00:12:43,839
allow another another blackout to happen

327
00:12:43,839 --> 00:12:45,440
they certainly learned a lot of their

328
00:12:45,440 --> 00:12:47,440
lessons from the past

329
00:12:47,440 --> 00:12:48,480
and

330
00:12:48,480 --> 00:12:51,519
uh when i said that in destroyer the

331
00:12:51,519 --> 00:12:54,079
first version didn't achieve its goals

332
00:12:54,079 --> 00:12:56,720
well industry two didn't even achieve

333
00:12:56,720 --> 00:13:00,480
that so that's a positive thing uh so in

334
00:13:00,480 --> 00:13:02,959
terms of impact uh

335
00:13:02,959 --> 00:13:04,720
some of those things have already been

336
00:13:04,720 --> 00:13:06,800
published

337
00:13:06,800 --> 00:13:08,240
i think we can all appreciate the

338
00:13:08,240 --> 00:13:10,720
sensitive nature of all of this so for

339
00:13:10,720 --> 00:13:12,160
example i'm not going to name the

340
00:13:12,160 --> 00:13:16,320
affected uh company the it's a regional

341
00:13:16,320 --> 00:13:17,920
regional

342
00:13:17,920 --> 00:13:19,360
electricity

343
00:13:19,360 --> 00:13:21,120
distributors so in ukraine they call

344
00:13:21,120 --> 00:13:23,760
them obel energos or from oblast which

345
00:13:23,760 --> 00:13:25,360
is which is a region

346
00:13:25,360 --> 00:13:28,160
um but they decided not to not to name

347
00:13:28,160 --> 00:13:29,920
this because of the situation that's

348
00:13:29,920 --> 00:13:32,639
going on uh what has been uh published

349
00:13:32,639 --> 00:13:34,880
is that this area

350
00:13:34,880 --> 00:13:37,360
uh provides power uh or or that this

351
00:13:37,360 --> 00:13:39,360
company provides power to uh power in an

352
00:13:39,360 --> 00:13:41,680
area that serves uh over two million

353
00:13:41,680 --> 00:13:44,240
people so had the attack been successful

354
00:13:44,240 --> 00:13:45,920
uh that means that

355
00:13:45,920 --> 00:13:47,600
potentially two million people would be

356
00:13:47,600 --> 00:13:49,600
left in the dark in the situation that

357
00:13:49,600 --> 00:13:52,959
ukraine is in

358
00:13:53,600 --> 00:13:55,600
okay so uh here's a little bit of

359
00:13:55,600 --> 00:13:58,639
timeline uh and and some time stamps of

360
00:13:58,639 --> 00:14:00,720
what was going on

361
00:14:00,720 --> 00:14:03,600
so all of the all of it was uh was uh

362
00:14:03,600 --> 00:14:06,079
launched through scheduled tasks

363
00:14:06,079 --> 00:14:09,680
uh we saw that at 1500 hours universal

364
00:14:09,680 --> 00:14:10,480
time

365
00:14:10,480 --> 00:14:13,360
uh the sandworm uh operator created this

366
00:14:13,360 --> 00:14:14,880
scheduled task to launch in destroyer

367
00:14:14,880 --> 00:14:18,720
and that industry itself executed at uh

368
00:14:18,720 --> 00:14:22,480
16 16 10 universal time and i'll fill in

369
00:14:22,480 --> 00:14:23,199
that

370
00:14:23,199 --> 00:14:25,279
timeline later on and i'll add

371
00:14:25,279 --> 00:14:28,720
additional context to that

372
00:14:28,839 --> 00:14:31,680
um there are a lot of differences in

373
00:14:31,680 --> 00:14:33,360
terms of architecture when we compare

374
00:14:33,360 --> 00:14:36,639
industry two with with in destroyer one

375
00:14:36,639 --> 00:14:38,800
uh and it looks like it's

376
00:14:38,800 --> 00:14:40,480
from an architectural perspective it's a

377
00:14:40,480 --> 00:14:43,120
lot simpler um it's implemented as a

378
00:14:43,120 --> 00:14:45,360
single executable

379
00:14:45,360 --> 00:14:46,160
uh

380
00:14:46,160 --> 00:14:47,760
that executable

381
00:14:47,760 --> 00:14:49,680
uh according to the compilation

382
00:14:49,680 --> 00:14:52,639
timestamp unless it was uh it was

383
00:14:52,639 --> 00:14:54,320
tampered with of course

384
00:14:54,320 --> 00:14:56,240
but what we quite often see is that

385
00:14:56,240 --> 00:14:58,160
these attackers don't really bother that

386
00:14:58,160 --> 00:15:01,120
much so so i think we can believe in

387
00:15:01,120 --> 00:15:03,920
this compilation timestamp and if valid

388
00:15:03,920 --> 00:15:06,320
then that means that the malware was

389
00:15:06,320 --> 00:15:09,199
compiled about two weeks before it was

390
00:15:09,199 --> 00:15:12,599
actually deployed

391
00:15:13,600 --> 00:15:15,279
an overview of of some of the main

392
00:15:15,279 --> 00:15:18,079
differences between industry 2 and and

393
00:15:18,079 --> 00:15:20,000
the original version so i said it's

394
00:15:20,000 --> 00:15:22,720
simpler and and it only implements one

395
00:15:22,720 --> 00:15:25,040
of those uh

396
00:15:25,040 --> 00:15:27,680
ics communication protocols that the

397
00:15:27,680 --> 00:15:30,480
original industry did specifically iec

398
00:15:30,480 --> 00:15:32,320
104.

399
00:15:32,320 --> 00:15:34,240
um i don't want to speculate why why

400
00:15:34,240 --> 00:15:37,040
they only specifically chose this one i

401
00:15:37,040 --> 00:15:37,839
guess

402
00:15:37,839 --> 00:15:40,399
uh that's what they uh

403
00:15:40,399 --> 00:15:42,000
established would would be most

404
00:15:42,000 --> 00:15:45,199
effective for them i'm sure uh the the

405
00:15:45,199 --> 00:15:48,000
ics experts here in the audience will be

406
00:15:48,000 --> 00:15:50,240
able to provide even better explanations

407
00:15:50,240 --> 00:15:52,959
uh than i can um i already mentioned the

408
00:15:52,959 --> 00:15:55,040
simpler arctic architecture so deployed

409
00:15:55,040 --> 00:15:58,000
as only as a single executable

410
00:15:58,000 --> 00:16:00,720
but it's but it wasn't so so it wasn't a

411
00:16:00,720 --> 00:16:04,079
framework with with dls and plugins uh

412
00:16:04,079 --> 00:16:06,320
as as the earlier one but it

413
00:16:06,320 --> 00:16:07,759
other pieces of malware other

414
00:16:07,759 --> 00:16:09,680
executables were co-deployed and i'll

415
00:16:09,680 --> 00:16:11,519
get to that in just a second

416
00:16:11,519 --> 00:16:12,639
um i already mentioned the

417
00:16:12,639 --> 00:16:15,199
configurations um so here the

418
00:16:15,199 --> 00:16:16,959
configuration is embedded so it's not

419
00:16:16,959 --> 00:16:18,880
standalone any files

420
00:16:18,880 --> 00:16:20,880
everything is is there

421
00:16:20,880 --> 00:16:22,480
which basically

422
00:16:22,480 --> 00:16:24,720
allows us i mean with with the original

423
00:16:24,720 --> 00:16:26,720
industry we basically were

424
00:16:26,720 --> 00:16:28,399
doing guesswork because a lot of those

425
00:16:28,399 --> 00:16:31,279
uh any files had not been recovered so

426
00:16:31,279 --> 00:16:33,839
during the analysis we were

427
00:16:33,839 --> 00:16:34,959
um

428
00:16:34,959 --> 00:16:36,880
we were analyzing the capabilities of

429
00:16:36,880 --> 00:16:38,320
malware what it what it what it could

430
00:16:38,320 --> 00:16:39,920
have done and actually comparing that

431
00:16:39,920 --> 00:16:42,480
with what it what was the uh what was

432
00:16:42,480 --> 00:16:44,800
the outcome and and looking at the log

433
00:16:44,800 --> 00:16:46,639
files but a lot of the configuration

434
00:16:46,639 --> 00:16:49,440
files we did not have them uh here we

435
00:16:49,440 --> 00:16:51,120
can actually analyze the configurations

436
00:16:51,120 --> 00:16:53,759
and analyze uh the intentions a little

437
00:16:53,759 --> 00:16:55,279
bit better

438
00:16:55,279 --> 00:16:56,880
there are code similarities there is

439
00:16:56,880 --> 00:16:58,880
code to reuse and i'll show that in just

440
00:16:58,880 --> 00:17:00,240
a second

441
00:17:00,240 --> 00:17:03,360
so here's uh here's the that embedded uh

442
00:17:03,360 --> 00:17:05,839
configuration parts of it uh in the code

443
00:17:05,839 --> 00:17:07,760
that i mentioned uh some of the

444
00:17:07,760 --> 00:17:11,439
sensitive parts have been uh redacted

445
00:17:11,439 --> 00:17:13,199
um

446
00:17:13,199 --> 00:17:14,880
in terms of functionality it's trying to

447
00:17:14,880 --> 00:17:17,439
accomplish very similar things to to the

448
00:17:17,439 --> 00:17:20,480
original industry so um we we see

449
00:17:20,480 --> 00:17:23,599
commands and and the um the parsing of

450
00:17:23,599 --> 00:17:26,079
this config it's able to uh change the

451
00:17:26,079 --> 00:17:29,200
states uh between open and close it also

452
00:17:29,200 --> 00:17:31,919
has uh the the the capability of doing

453
00:17:31,919 --> 00:17:34,080
the strobing effect as well

454
00:17:34,080 --> 00:17:37,360
operates on on ios 2 so so from a high

455
00:17:37,360 --> 00:17:39,120
level perspective very similar

456
00:17:39,120 --> 00:17:40,880
functionality

457
00:17:40,880 --> 00:17:43,600
and also the code looks like it's it's

458
00:17:43,600 --> 00:17:46,480
been made from from a similar code based

459
00:17:46,480 --> 00:17:48,880
like a refactored

460
00:17:48,880 --> 00:17:50,000
source code

461
00:17:50,000 --> 00:17:52,400
uh here you can see one example of the

462
00:17:52,400 --> 00:17:56,000
similarities this you notice uh i want

463
00:17:56,000 --> 00:17:57,840
to draw your attention to the similar

464
00:17:57,840 --> 00:18:00,000
text strings being used in these two

465
00:18:00,000 --> 00:18:01,360
functions

466
00:18:01,360 --> 00:18:04,000
and then in this next one this this this

467
00:18:04,000 --> 00:18:05,440
is a comparison of the piece of code

468
00:18:05,440 --> 00:18:07,520
that actually constructs uh the

469
00:18:07,520 --> 00:18:10,320
communication packets

470
00:18:10,320 --> 00:18:11,600
uh

471
00:18:11,600 --> 00:18:13,440
so yeah a lot of similarity there as

472
00:18:13,440 --> 00:18:15,840
well

473
00:18:16,400 --> 00:18:18,559
i deliberately

474
00:18:18,559 --> 00:18:20,400
mentioned the

475
00:18:20,400 --> 00:18:23,280
the log outputs of industry one so that

476
00:18:23,280 --> 00:18:25,760
we can compare with what industry two

477
00:18:25,760 --> 00:18:28,400
outputs and here as you can see here it

478
00:18:28,400 --> 00:18:31,679
makes a lot less sense so so it is

479
00:18:31,679 --> 00:18:33,520
providing something which looks a lot

480
00:18:33,520 --> 00:18:37,200
like garbage not making our jobs uh

481
00:18:37,200 --> 00:18:40,000
easier at all

482
00:18:40,240 --> 00:18:42,640
uh so let's continue to talk about the

483
00:18:42,640 --> 00:18:44,320
other malware that was deployed and as

484
00:18:44,320 --> 00:18:46,240
you can probably guess

485
00:18:46,240 --> 00:18:48,720
it's going to be something from from uh

486
00:18:48,720 --> 00:18:50,400
the similar functionality that what

487
00:18:50,400 --> 00:18:51,840
industry had

488
00:18:51,840 --> 00:18:54,480
uh and it was a wiper it was wiping

489
00:18:54,480 --> 00:18:57,919
wiping capability uh one of the

490
00:18:57,919 --> 00:19:00,080
wiper malware that we detected being

491
00:19:00,080 --> 00:19:02,960
co-deployed with in destroyer 2 was a

492
00:19:02,960 --> 00:19:05,280
new version of caddy wiper i'm stressing

493
00:19:05,280 --> 00:19:06,799
the part new because this was not the

494
00:19:06,799 --> 00:19:10,080
first time caddy wiper that we uh

495
00:19:10,080 --> 00:19:12,320
saw caddy wiper and i'll talk about the

496
00:19:12,320 --> 00:19:15,679
other times uh later on

497
00:19:15,679 --> 00:19:18,400
um otherwise caddy wiper pretty pretty

498
00:19:18,400 --> 00:19:21,280
uh advanced uh wiper

499
00:19:21,280 --> 00:19:22,240
um

500
00:19:22,240 --> 00:19:24,320
not going to go into too much detail you

501
00:19:24,320 --> 00:19:27,200
can read more in our publications uh

502
00:19:27,200 --> 00:19:30,799
it's uh going over the see user uh

503
00:19:30,799 --> 00:19:32,960
folders and and then the subsequent

504
00:19:32,960 --> 00:19:35,200
drives from d onwards so wiping all

505
00:19:35,200 --> 00:19:37,440
files with zeros and again corrupting

506
00:19:37,440 --> 00:19:39,520
critical parts of the of of the hard

507
00:19:39,520 --> 00:19:42,000
drive like the gpt the mbr and so on

508
00:19:42,000 --> 00:19:45,280
making the machine uh unbootable

509
00:19:45,280 --> 00:19:47,440
and here is how the deployment of caddy

510
00:19:47,440 --> 00:19:49,360
wiper sort of fills into that timeline

511
00:19:49,360 --> 00:19:51,280
that i showed you earlier

512
00:19:51,280 --> 00:19:53,919
so a caddy wiper was actually executed

513
00:19:53,919 --> 00:19:55,280
the first

514
00:19:55,280 --> 00:19:58,000
on some of the machines there

515
00:19:58,000 --> 00:20:01,039
running different operating systems

516
00:20:01,039 --> 00:20:03,919
then it was uh the execution of industry

517
00:20:03,919 --> 00:20:06,480
and then caddy wiper was scheduled to

518
00:20:06,480 --> 00:20:07,919
execute again

519
00:20:07,919 --> 00:20:10,400
on the same machine

520
00:20:10,400 --> 00:20:12,559
that industry two was deployed

521
00:20:12,559 --> 00:20:13,360
to

522
00:20:13,360 --> 00:20:17,840
erase the traces of the of it being run

523
00:20:18,159 --> 00:20:20,880
so that's this part on the left uh and

524
00:20:20,880 --> 00:20:23,039
then there were uh the components

525
00:20:23,039 --> 00:20:25,280
targeting the other uh operating systems

526
00:20:25,280 --> 00:20:27,919
so it was not not wipe the wipers

527
00:20:27,919 --> 00:20:30,080
uh not only featured for windows but

528
00:20:30,080 --> 00:20:33,200
also for linux and for solaris uh

529
00:20:33,200 --> 00:20:35,679
actually the launcher determines

530
00:20:35,679 --> 00:20:37,600
uh as you can see here this sets up the

531
00:20:37,600 --> 00:20:40,720
cron job and on the fly determines uh

532
00:20:40,720 --> 00:20:42,640
the right wiper to execute depending on

533
00:20:42,640 --> 00:20:44,240
the operating system

534
00:20:44,240 --> 00:20:46,960
uh running there

535
00:20:46,960 --> 00:20:48,720
what's

536
00:20:48,720 --> 00:20:50,799
what's interesting here uh one more

537
00:20:50,799 --> 00:20:53,600
thing to note is that uh with caddy

538
00:20:53,600 --> 00:20:56,799
wiper uh not only was it was a refreshed

539
00:20:56,799 --> 00:20:59,919
version but it also used a new execution

540
00:20:59,919 --> 00:21:01,200
chain

541
00:21:01,200 --> 00:21:05,120
and and the launcher for for caddy wiper

542
00:21:05,120 --> 00:21:06,880
was actually

543
00:21:06,880 --> 00:21:08,960
a modified a patched

544
00:21:08,960 --> 00:21:09,840
uh

545
00:21:09,840 --> 00:21:14,320
version of the ida pro remote debugger

546
00:21:14,320 --> 00:21:16,240
and this is i think this is pretty

547
00:21:16,240 --> 00:21:18,880
interesting because there's no real good

548
00:21:18,880 --> 00:21:21,520
reason why i mean it's definitely not

549
00:21:21,520 --> 00:21:24,000
there to to cover their tracks or make

550
00:21:24,000 --> 00:21:25,440
it make it appear

551
00:21:25,440 --> 00:21:28,159
uh innocuous uh ida pro is not used at

552
00:21:28,159 --> 00:21:30,559
an electrical substation

553
00:21:30,559 --> 00:21:33,120
we use it reverse engineers analysts to

554
00:21:33,120 --> 00:21:35,440
to do this analysis so

555
00:21:35,440 --> 00:21:37,200
uh it looks like they've been trolling

556
00:21:37,200 --> 00:21:39,360
us

557
00:21:39,679 --> 00:21:41,840
okay so

558
00:21:41,840 --> 00:21:43,679
since we're don't have that much time

559
00:21:43,679 --> 00:21:45,679
i'll quickly go over this part where

560
00:21:45,679 --> 00:21:46,880
we're going to

561
00:21:46,880 --> 00:21:48,320
put everything

562
00:21:48,320 --> 00:21:49,760
into context

563
00:21:49,760 --> 00:21:51,120
so

564
00:21:51,120 --> 00:21:53,039
sandworm isn't the only apt group

565
00:21:53,039 --> 00:21:55,760
targeting ukraine and even

566
00:21:55,760 --> 00:21:57,440
the list here is not comprehensive so

567
00:21:57,440 --> 00:21:59,039
this is just the tip of the iceberg some

568
00:21:59,039 --> 00:22:01,280
of the most noteworthy in my opinion

569
00:22:01,280 --> 00:22:02,400
groups that

570
00:22:02,400 --> 00:22:04,080
were targeting ukraine and that were

571
00:22:04,080 --> 00:22:05,440
tracking

572
00:22:05,440 --> 00:22:08,960
but as i indicated earlier we attribute

573
00:22:08,960 --> 00:22:11,520
indestroyer to sand worm

574
00:22:11,520 --> 00:22:13,200
sandworm has been attributed to the

575
00:22:13,200 --> 00:22:15,120
russian gru

576
00:22:15,120 --> 00:22:18,000
in 2020 the usdoj

577
00:22:18,000 --> 00:22:19,760
released this indictment of these six

578
00:22:19,760 --> 00:22:22,400
nice fellows

579
00:22:22,400 --> 00:22:24,080
in case anyone

580
00:22:24,080 --> 00:22:25,679
doesn't remember is wondering where the

581
00:22:25,679 --> 00:22:27,679
name san juan comes from it's coming

582
00:22:27,679 --> 00:22:30,400
from uh these strings so these come from

583
00:22:30,400 --> 00:22:32,880
one of the early black energy campaigns

584
00:22:32,880 --> 00:22:34,799
uh that we analyzed

585
00:22:34,799 --> 00:22:35,840
um

586
00:22:35,840 --> 00:22:37,840
and apparently

587
00:22:37,840 --> 00:22:39,520
the authors were

588
00:22:39,520 --> 00:22:42,640
fans of frank herbert's classic novel

589
00:22:42,640 --> 00:22:44,880
so

590
00:22:45,280 --> 00:22:47,039
let's put all of that

591
00:22:47,039 --> 00:22:48,799
into context of the geopolitical

592
00:22:48,799 --> 00:22:51,440
situation

593
00:22:51,760 --> 00:22:55,480
we have seen

594
00:22:55,679 --> 00:22:57,679
sand worm attacks

595
00:22:57,679 --> 00:22:59,760
even before these dates

596
00:22:59,760 --> 00:23:00,640
like

597
00:23:00,640 --> 00:23:03,440
in 2012 for example but they really

598
00:23:03,440 --> 00:23:05,200
intensified

599
00:23:05,200 --> 00:23:07,200
towards the end of 2013 and the

600
00:23:07,200 --> 00:23:10,320
beginning of 2014.

601
00:23:10,320 --> 00:23:12,960
um here's just one example uh and black

602
00:23:12,960 --> 00:23:14,799
energy targeted a lot of different

603
00:23:14,799 --> 00:23:17,120
sectors in ukraine government diplomatic

604
00:23:17,120 --> 00:23:18,400
military

605
00:23:18,400 --> 00:23:21,120
and critical infrastructure you name it

606
00:23:21,120 --> 00:23:23,360
it was using mainly spearfishing

607
00:23:23,360 --> 00:23:26,400
campaigns to disseminate the malware

608
00:23:26,400 --> 00:23:28,240
i would in my opinion the most notable

609
00:23:28,240 --> 00:23:30,240
campaign was this one because it was

610
00:23:30,240 --> 00:23:32,080
using a zero day

611
00:23:32,080 --> 00:23:34,480
within a microsoft powerpoint

612
00:23:34,480 --> 00:23:36,720
so this was pretty significant on their

613
00:23:36,720 --> 00:23:39,360
part uh so when the recipient would open

614
00:23:39,360 --> 00:23:41,039
this attachment again with the

615
00:23:41,039 --> 00:23:42,880
geopolitical context so this was

616
00:23:42,880 --> 00:23:45,840
referring to the warren donbass that was

617
00:23:45,840 --> 00:23:47,760
actually just starting

618
00:23:47,760 --> 00:23:49,200
um

619
00:23:49,200 --> 00:23:51,760
on the end even with the with the users

620
00:23:51,760 --> 00:23:53,840
having the latest and greatest uh

621
00:23:53,840 --> 00:23:55,520
operating systems and and office

622
00:23:55,520 --> 00:23:57,600
everything up to date the malware would

623
00:23:57,600 --> 00:23:59,919
be would be installed

624
00:23:59,919 --> 00:24:01,919
um

625
00:24:01,919 --> 00:24:05,919
then the most significant event uh was

626
00:24:05,919 --> 00:24:08,559
uh was the power outage in december

627
00:24:08,559 --> 00:24:10,799
2015.

628
00:24:10,799 --> 00:24:13,120
this was facilitated i want to highlight

629
00:24:13,120 --> 00:24:16,080
facilitated by blackout so black energy

630
00:24:16,080 --> 00:24:17,679
opened the door for the attackers it

631
00:24:17,679 --> 00:24:20,000
wasn't doing it programmatically as

632
00:24:20,000 --> 00:24:22,559
indestroyer was doing uh

633
00:24:22,559 --> 00:24:26,080
one year after that

634
00:24:26,880 --> 00:24:30,000
then there was an evolution of of of

635
00:24:30,000 --> 00:24:32,799
this group we actually track san

636
00:24:32,799 --> 00:24:34,559
sandworm and different subgroups

637
00:24:34,559 --> 00:24:37,039
belonging uh to these attackers so there

638
00:24:37,039 --> 00:24:39,279
was black energy there was in destroyer

639
00:24:39,279 --> 00:24:42,159
uh we tracked uh the subgroup that

640
00:24:42,159 --> 00:24:43,840
carried out the infamous non-petty

641
00:24:43,840 --> 00:24:46,880
outbreak uh what uh to a subgroup that

642
00:24:46,880 --> 00:24:49,520
we what we're tracking as telebots

643
00:24:49,520 --> 00:24:51,600
intellibus is pretty significant

644
00:24:51,600 --> 00:24:53,919
um not ptr will skip through that we

645
00:24:53,919 --> 00:24:56,559
doesn't need too much uh introduction

646
00:24:56,559 --> 00:24:57,679
uh

647
00:24:57,679 --> 00:24:58,880
but

648
00:24:58,880 --> 00:25:00,559
here this attack

649
00:25:00,559 --> 00:25:03,520
basically originated from a supply chain

650
00:25:03,520 --> 00:25:05,440
attack of emidoc

651
00:25:05,440 --> 00:25:08,880
uh a legitimate software vendor a vendor

652
00:25:08,880 --> 00:25:09,679
of

653
00:25:09,679 --> 00:25:11,679
the most popular accounting software in

654
00:25:11,679 --> 00:25:13,279
ukraine

655
00:25:13,279 --> 00:25:14,400
and

656
00:25:14,400 --> 00:25:15,840
then we know what followed it spread

657
00:25:15,840 --> 00:25:17,520
beyond the borders of the country and

658
00:25:17,520 --> 00:25:22,720
caused uh huge uh huge damage

659
00:25:22,720 --> 00:25:24,240
but

660
00:25:24,240 --> 00:25:26,880
that allowed us to

661
00:25:26,880 --> 00:25:28,720
put together pieces of the puzzle

662
00:25:28,720 --> 00:25:29,679
because

663
00:25:29,679 --> 00:25:32,480
uh when we discovered and analyzed and

664
00:25:32,480 --> 00:25:34,240
and then even as we published our

665
00:25:34,240 --> 00:25:36,960
findings on in destroyer uh at the time

666
00:25:36,960 --> 00:25:38,400
we weren't actually attributing it to

667
00:25:38,400 --> 00:25:40,720
sand worm uh it was the most possible

668
00:25:40,720 --> 00:25:42,799
the most probable explanation i mean it

669
00:25:42,799 --> 00:25:45,760
makes sense when when an apt group uh

670
00:25:45,760 --> 00:25:47,760
targets uh

671
00:25:47,760 --> 00:25:51,679
this the same types of targets as as the

672
00:25:51,679 --> 00:25:54,320
incident in 2015 it's it makes sense i

673
00:25:54,320 --> 00:25:56,400
mean you would kind of expect that

674
00:25:56,400 --> 00:25:58,640
and uh there were some

675
00:25:58,640 --> 00:26:01,840
low low confidence um

676
00:26:01,840 --> 00:26:03,440
indicators uh

677
00:26:03,440 --> 00:26:06,080
being around but there was no

678
00:26:06,080 --> 00:26:08,880
high there was no concrete evidence to

679
00:26:08,880 --> 00:26:11,279
actually confirm these claims and uh

680
00:26:11,279 --> 00:26:12,640
that proof

681
00:26:12,640 --> 00:26:15,440
was actually we we we found it in april

682
00:26:15,440 --> 00:26:18,720
2018 with exterminal so exterminal was

683
00:26:18,720 --> 00:26:21,520
uh a back door uh deployed by the

684
00:26:21,520 --> 00:26:23,120
telebot subgroup which we were able to

685
00:26:23,120 --> 00:26:24,880
attribute

686
00:26:24,880 --> 00:26:25,840
to

687
00:26:25,840 --> 00:26:28,000
to sandworm

688
00:26:28,000 --> 00:26:29,919
and that

689
00:26:29,919 --> 00:26:31,600
allowed us to link it with industry so

690
00:26:31,600 --> 00:26:33,279
there was actual code similarity with

691
00:26:33,279 --> 00:26:35,919
the industry main backdoor

692
00:26:35,919 --> 00:26:37,440
okay so

693
00:26:37,440 --> 00:26:39,919
then moving on to more more uh recent

694
00:26:39,919 --> 00:26:42,159
events

695
00:26:42,159 --> 00:26:44,000
as you can see a lot of these things

696
00:26:44,000 --> 00:26:45,520
they they have a common theme of

697
00:26:45,520 --> 00:26:49,120
disruption uh they were wiping

698
00:26:49,120 --> 00:26:51,840
capabilities wiping wiper malware

699
00:26:51,840 --> 00:26:54,640
in all sorts of flavors such as hermetic

700
00:26:54,640 --> 00:26:56,240
wiper for example

701
00:26:56,240 --> 00:26:58,640
which we discovered only a few hours

702
00:26:58,640 --> 00:26:59,679
before

703
00:26:59,679 --> 00:27:02,480
uh the russian invasion began so

704
00:27:02,480 --> 00:27:05,360
uh we published about that this was this

705
00:27:05,360 --> 00:27:07,919
was pretty uh pretty busy at the time

706
00:27:07,919 --> 00:27:09,919
and of course when we were doing this

707
00:27:09,919 --> 00:27:12,320
this analysis we had no idea what would

708
00:27:12,320 --> 00:27:17,360
happen just a few hours on february 24th

709
00:27:17,360 --> 00:27:18,320
um

710
00:27:18,320 --> 00:27:20,399
this affected various different

711
00:27:20,399 --> 00:27:22,240
organizations in ukraine and again the

712
00:27:22,240 --> 00:27:24,880
topic compilation timestamp suggests

713
00:27:24,880 --> 00:27:26,480
that the attackers had been planning

714
00:27:26,480 --> 00:27:29,279
that attack for some time in advance

715
00:27:29,279 --> 00:27:31,360
um the other thing i'll note with with

716
00:27:31,360 --> 00:27:34,960
the hermetic campaign is that it

717
00:27:34,960 --> 00:27:36,640
contained these components so there was

718
00:27:36,640 --> 00:27:38,559
the wiper there was the wizard which was

719
00:27:38,559 --> 00:27:41,200
a worm component by the way also this in

720
00:27:41,200 --> 00:27:44,640
destroyer two campaign uh

721
00:27:44,640 --> 00:27:46,880
the the

722
00:27:46,880 --> 00:27:51,440
wipers aimed at uh linux and solaris uh

723
00:27:51,440 --> 00:27:53,679
also contained worm functionality to be

724
00:27:53,679 --> 00:27:56,159
able to spread it along the the local

725
00:27:56,159 --> 00:27:57,120
network

726
00:27:57,120 --> 00:28:00,080
um but back to hermetic um so there were

727
00:28:00,080 --> 00:28:02,399
these different components and and it

728
00:28:02,399 --> 00:28:04,640
kind of resembles the from a very high

729
00:28:04,640 --> 00:28:07,039
level perspective the mo of what we've

730
00:28:07,039 --> 00:28:08,640
seen with no patio so it was able to

731
00:28:08,640 --> 00:28:12,080
spread the spread the malware um across

732
00:28:12,080 --> 00:28:14,840
the network as a worm

733
00:28:14,840 --> 00:28:17,760
and what initially didn't make that much

734
00:28:17,760 --> 00:28:19,279
sense there was a wiper component and

735
00:28:19,279 --> 00:28:21,200
then there was like a fall ransomware

736
00:28:21,200 --> 00:28:22,960
component so

737
00:28:22,960 --> 00:28:25,600
why but apparently fall ransomware is

738
00:28:25,600 --> 00:28:27,760
kind of a thing that they they're

739
00:28:27,760 --> 00:28:29,360
they're doing

740
00:28:29,360 --> 00:28:31,840
um this is the ransom message these are

741
00:28:31,840 --> 00:28:34,159
these are some easter eggs uh hidden in

742
00:28:34,159 --> 00:28:36,480
the code

743
00:28:36,480 --> 00:28:38,559
and then as i said there were a lot of

744
00:28:38,559 --> 00:28:39,600
these there were

745
00:28:39,600 --> 00:28:41,840
various different wiper malware that

746
00:28:41,840 --> 00:28:43,279
we've seen and i already already talked

747
00:28:43,279 --> 00:28:45,200
about caddy wiper which was

748
00:28:45,200 --> 00:28:48,480
used in the incident uh within destroyer

749
00:28:48,480 --> 00:28:50,240
2 but it was not the first time that it

750
00:28:50,240 --> 00:28:52,640
was used so the first time we

751
00:28:52,640 --> 00:28:57,440
saw caddywiper was on march 14th

752
00:28:57,440 --> 00:29:00,320
and then it led us to the events that i

753
00:29:00,320 --> 00:29:01,679
already talked about

754
00:29:01,679 --> 00:29:04,799
so to wrap this all up um

755
00:29:04,799 --> 00:29:06,880
the attackers

756
00:29:06,880 --> 00:29:09,200
sand worm they're they're doing they're

757
00:29:09,200 --> 00:29:10,960
trying to accomplish two main objectives

758
00:29:10,960 --> 00:29:13,039
with with all of their attacks the first

759
00:29:13,039 --> 00:29:14,799
category is espionage and data

760
00:29:14,799 --> 00:29:17,840
collection and the other type is is the

761
00:29:17,840 --> 00:29:19,679
destructive uh

762
00:29:19,679 --> 00:29:22,559
capability for sabotage for signaling uh

763
00:29:22,559 --> 00:29:25,120
these two are not mutually exclusive so

764
00:29:25,120 --> 00:29:26,960
so in a lot of the cases we will see

765
00:29:26,960 --> 00:29:29,200
that they are doing uh espionage trying

766
00:29:29,200 --> 00:29:32,320
to collect uh data and then

767
00:29:32,320 --> 00:29:34,799
pave the way for the most more visible

768
00:29:34,799 --> 00:29:37,679
attack for the disruption

769
00:29:37,679 --> 00:29:39,279
okay so

770
00:29:39,279 --> 00:29:42,320
with that we're almost at the end

771
00:29:42,320 --> 00:29:44,559
um what do we do about it well obviously

772
00:29:44,559 --> 00:29:46,960
we detect the malware and we also

773
00:29:46,960 --> 00:29:48,880
provide uh threat intelligence to our

774
00:29:48,880 --> 00:29:50,640
sub subscribers

775
00:29:50,640 --> 00:29:52,799
but we also since it's such an important

776
00:29:52,799 --> 00:29:56,720
topic we also like to share um publicly

777
00:29:56,720 --> 00:29:59,520
so so you can find a lot of

778
00:29:59,520 --> 00:30:02,159
those publications here on our blog

779
00:30:02,159 --> 00:30:05,279
we livesecurity.com and on our twitter

780
00:30:05,279 --> 00:30:07,039
eset research

781
00:30:07,039 --> 00:30:09,520
so with that i thank you and maybe we

782
00:30:09,520 --> 00:30:12,399
have time for some questions

783
00:30:12,399 --> 00:30:14,960
and i might have answers yeah sorry or

784
00:30:14,960 --> 00:30:17,440
might not should i come here first um i

785
00:30:17,440 --> 00:30:19,120
have a question you mentioned that the

786
00:30:19,120 --> 00:30:20,960
attack actually well this time the

787
00:30:20,960 --> 00:30:22,559
attempt of the attack was to stop before

788
00:30:22,559 --> 00:30:23,520
it happened

789
00:30:23,520 --> 00:30:24,399
uh

790
00:30:24,399 --> 00:30:26,559
if possible to say do you know what

791
00:30:26,559 --> 00:30:28,320
happened there like was it caught by any

792
00:30:28,320 --> 00:30:30,080
detections did you find it in the

793
00:30:30,080 --> 00:30:32,320
process maybe it failed or something do

794
00:30:32,320 --> 00:30:33,840
you have any details on that

795
00:30:33,840 --> 00:30:35,039
uh

796
00:30:35,039 --> 00:30:38,799
i have some details uh we did uh detect

797
00:30:38,799 --> 00:30:40,559
a lot of the malware and and then there

798
00:30:40,559 --> 00:30:42,000
was active

799
00:30:42,000 --> 00:30:43,679
uh

800
00:30:43,679 --> 00:30:45,520
active thwarting so so from the

801
00:30:45,520 --> 00:30:47,600
operators they they they were able to

802
00:30:47,600 --> 00:30:49,520
get on it quickly and basically take

803
00:30:49,520 --> 00:30:52,480
those machines offline um i don't have

804
00:30:52,480 --> 00:30:54,880
all the details so i can't really um

805
00:30:54,880 --> 00:30:56,960
provide much better explanation or

806
00:30:56,960 --> 00:31:00,080
closer explanation to that um and also

807
00:31:00,080 --> 00:31:02,000
because it's so sensitive so

808
00:31:02,000 --> 00:31:05,120
both the affected utility and and search

809
00:31:05,120 --> 00:31:06,159
uh

810
00:31:06,159 --> 00:31:08,720
are not disclosing every detail

811
00:31:08,720 --> 00:31:11,279
okay thank you

812
00:31:12,880 --> 00:31:14,960
hey robert thanks for being here um

813
00:31:14,960 --> 00:31:18,320
there's been some speculation about um

814
00:31:18,320 --> 00:31:20,240
the supposed hastiness with which the

815
00:31:20,240 --> 00:31:22,880
code was deployed or prepared

816
00:31:22,880 --> 00:31:25,039
um can you talk a little bit about how

817
00:31:25,039 --> 00:31:27,279
you see that whether it's

818
00:31:27,279 --> 00:31:29,440
you your your team assesses that this

819
00:31:29,440 --> 00:31:30,720
was rushed

820
00:31:30,720 --> 00:31:33,760
and at all um you know uh coordinated

821
00:31:33,760 --> 00:31:35,519
with what was going on on the ground in

822
00:31:35,519 --> 00:31:38,240
ukraine uh kinetically thanks yeah i

823
00:31:38,240 --> 00:31:40,960
mean um

824
00:31:40,960 --> 00:31:43,200
it does appear as a step backwards right

825
00:31:43,200 --> 00:31:46,480
i mean why why uh shrink the capability

826
00:31:46,480 --> 00:31:48,399
and make make something you know slimmer

827
00:31:48,399 --> 00:31:50,720
compared to the to the capabilities of

828
00:31:50,720 --> 00:31:52,480
the original version

829
00:31:52,480 --> 00:31:53,519
um

830
00:31:53,519 --> 00:31:57,200
at this time we haven't identified any

831
00:31:57,200 --> 00:32:00,159
errors coding errors per se uh there

832
00:32:00,159 --> 00:32:02,240
have been errors made in the

833
00:32:02,240 --> 00:32:04,799
uh in the original in destroyer version

834
00:32:04,799 --> 00:32:06,559
uh i would say it's pretty early it's

835
00:32:06,559 --> 00:32:09,120
too early to to actually judge the the

836
00:32:09,120 --> 00:32:12,240
efficacy of of the malware and

837
00:32:12,240 --> 00:32:14,399
the level as to which it was rushed so

838
00:32:14,399 --> 00:32:16,959
hard to say

839
00:32:23,519 --> 00:32:25,440
okay if there are any further questions

840
00:32:25,440 --> 00:32:28,480
that popped your mind stop by or reach

841
00:32:28,480 --> 00:32:30,399
out to me on twitter or anywhere thank

842
00:32:30,399 --> 00:32:32,410
you

843
00:32:32,410 --> 00:32:35,689
[Music]

844
00:32:43,039 --> 00:32:45,120
you

