1
00:00:00,120 --> 00:00:03,120
foreign

2
00:00:04,799 --> 00:00:07,080
body and thank you very much for joining

3
00:00:07,080 --> 00:00:08,519
me

4
00:00:08,519 --> 00:00:10,080
in this session we are going to talk

5
00:00:10,080 --> 00:00:12,059
about industrial wireless iot devices

6
00:00:12,059 --> 00:00:14,519
and how actually they can be used

7
00:00:14,519 --> 00:00:16,260
they can help attackers with the most

8
00:00:16,260 --> 00:00:18,359
difficult step of an OT attack gaining

9
00:00:18,359 --> 00:00:20,520
the initial access to the network we

10
00:00:20,520 --> 00:00:22,859
will focus on devices such as industrial

11
00:00:22,859 --> 00:00:25,560
solar gateways and Industrial Wi-Fi

12
00:00:25,560 --> 00:00:28,380
access points and as the title of this

13
00:00:28,380 --> 00:00:30,060
session suggests and we will soon

14
00:00:30,060 --> 00:00:32,340
explore further this device has commonly

15
00:00:32,340 --> 00:00:34,440
lead directly to the lower levels of the

16
00:00:34,440 --> 00:00:37,739
OT networks to devices such as plcs hmis

17
00:00:37,739 --> 00:00:39,300
field devices

18
00:00:39,300 --> 00:00:41,460
during the session we will cover three

19
00:00:41,460 --> 00:00:43,620
different attack vectors in which

20
00:00:43,620 --> 00:00:46,020
industrial wireless iot devices is

21
00:00:46,020 --> 00:00:47,040
exposed to

22
00:00:47,040 --> 00:00:49,079
among them the compromising of cloud

23
00:00:49,079 --> 00:00:51,000
managed industrial Wireless iot with a

24
00:00:51,000 --> 00:00:53,160
very cool exploitation demo so stay

25
00:00:53,160 --> 00:00:55,940
tuned for that part

26
00:00:56,100 --> 00:00:58,079
so industrial wireless iot devices is

27
00:00:58,079 --> 00:01:00,180
being used in various verticals of the

28
00:01:00,180 --> 00:01:02,039
OT and critical infrastructure for

29
00:01:02,039 --> 00:01:04,319
example in Wastewater utilities and oil

30
00:01:04,319 --> 00:01:06,299
fields for on-site Wi-Fi connectivity

31
00:01:06,299 --> 00:01:08,580
and remote cellular connectivity

32
00:01:08,580 --> 00:01:10,500
among the manufacturers there are

33
00:01:10,500 --> 00:01:12,420
well-known vendors like teutonica

34
00:01:12,420 --> 00:01:15,180
networks CR wireless internet networks

35
00:01:15,180 --> 00:01:17,760
and many many others as you all probably

36
00:01:17,760 --> 00:01:19,860
know it's very common in the OT to

37
00:01:19,860 --> 00:01:21,720
follow the Purdue model as the layer

38
00:01:21,720 --> 00:01:24,000
based architecture for operational

39
00:01:24,000 --> 00:01:26,400
environments but things may look a

40
00:01:26,400 --> 00:01:27,780
little different where there are

41
00:01:27,780 --> 00:01:29,280
multiple remote and distributed

42
00:01:29,280 --> 00:01:30,900
locations

43
00:01:30,900 --> 00:01:32,939
let's take a closer look at an oil and

44
00:01:32,939 --> 00:01:34,740
gas use case where there are multiple

45
00:01:34,740 --> 00:01:38,040
remote and distributed oil wells

46
00:01:38,040 --> 00:01:40,619
in each side there are level two to

47
00:01:40,619 --> 00:01:43,500
level zero devices such as plcs hmis and

48
00:01:43,500 --> 00:01:45,720
field devices in order to connect them

49
00:01:45,720 --> 00:01:48,240
to the scada servers in the level 3

50
00:01:48,240 --> 00:01:50,759
control center a very convenient and

51
00:01:50,759 --> 00:01:53,159
practical solution is to use the

52
00:01:53,159 --> 00:01:55,140
industrial cellular Gateway

53
00:01:55,140 --> 00:01:56,880
the industrial solar Gateway is

54
00:01:56,880 --> 00:01:58,920
connected to the level 3 control center

55
00:01:58,920 --> 00:02:01,979
over the solar ISP Network either by

56
00:02:01,979 --> 00:02:04,140
using a private APN or over the public

57
00:02:04,140 --> 00:02:06,299
APN leveraging built-in security

58
00:02:06,299 --> 00:02:09,419
features like firewall and VPN

59
00:02:09,419 --> 00:02:12,720
another feature they commonly have is

60
00:02:12,720 --> 00:02:15,300
the vendor Cloud management platform for

61
00:02:15,300 --> 00:02:16,980
Remote Management of the devices

62
00:02:16,980 --> 00:02:19,440
operations like firmware upgrade

63
00:02:19,440 --> 00:02:22,860
configuration changes reboot and many

64
00:02:22,860 --> 00:02:24,360
others can be done over the cloud

65
00:02:24,360 --> 00:02:25,500
platforms

66
00:02:25,500 --> 00:02:28,739
on the devices

67
00:02:28,739 --> 00:02:31,620
and this is a desirable feature since it

68
00:02:31,620 --> 00:02:35,940
allows to manage the devices without the

69
00:02:35,940 --> 00:02:37,379
need to physically travel to each

70
00:02:37,379 --> 00:02:38,640
location

71
00:02:38,640 --> 00:02:42,060
so successful exploitation of industrial

72
00:02:42,060 --> 00:02:44,640
Wireless iot in such architecture can

73
00:02:44,640 --> 00:02:46,800
have two possible impacts

74
00:02:46,800 --> 00:02:49,200
since level 2 to level 0 devices and

75
00:02:49,200 --> 00:02:51,239
their Protocols are insecure by design

76
00:02:51,239 --> 00:02:53,760
an attacker with direct access to them

77
00:02:53,760 --> 00:02:56,280
can easily import the process and in

78
00:02:56,280 --> 00:02:59,459
this example stop the old production

79
00:02:59,459 --> 00:03:02,099
in addition leveraging the built-in VPN

80
00:03:02,099 --> 00:03:05,459
on the devices if in use an attacker can

81
00:03:05,459 --> 00:03:07,920
find his way to the scada servers in the

82
00:03:07,920 --> 00:03:10,260
other side of the VPN connection

83
00:03:10,260 --> 00:03:13,500
so in our research we covered three main

84
00:03:13,500 --> 00:03:16,080
attack vectors in which industrial

85
00:03:16,080 --> 00:03:18,060
wireless iot devices is exposed to

86
00:03:18,060 --> 00:03:20,700
starting with on-site Wi-Fi solo

87
00:03:20,700 --> 00:03:21,720
channels

88
00:03:21,720 --> 00:03:24,360
internet explored services

89
00:03:24,360 --> 00:03:26,940
and the cloud management platforms let's

90
00:03:26,940 --> 00:03:29,280
start with the first one the onset solar

91
00:03:29,280 --> 00:03:30,300
channels

92
00:03:30,300 --> 00:03:33,840
so attackers can compromise

93
00:03:33,840 --> 00:03:35,819
industrial wireless iot devices by

94
00:03:35,819 --> 00:03:37,800
targeting their Wi-Fi and solar

95
00:03:37,800 --> 00:03:41,239
communication channels on site

96
00:03:41,340 --> 00:03:43,920
so there are different types of attacks

97
00:03:43,920 --> 00:03:46,200
that can be used against the Wi-Fi and

98
00:03:46,200 --> 00:03:48,299
solar communication channels starting

99
00:03:48,299 --> 00:03:51,120
with attacks on the encryption of Wi-Fi

100
00:03:51,120 --> 00:03:54,060
like wwp and Brute Force attack on the

101
00:03:54,060 --> 00:03:57,780
WPA and WPA2 and downgrade the tax on

102
00:03:57,780 --> 00:04:00,540
the vulnerable GPRS for cellular and all

103
00:04:00,540 --> 00:04:02,099
the way to complex chipset

104
00:04:02,099 --> 00:04:03,540
vulnerabilities

105
00:04:03,540 --> 00:04:06,420
since those types of vulnerabilities and

106
00:04:06,420 --> 00:04:08,640
attacks already discussed in many

107
00:04:08,640 --> 00:04:11,099
sessions we decided in our research to

108
00:04:11,099 --> 00:04:14,720
focus on how attackers can find

109
00:04:14,720 --> 00:04:17,519
geographically interesting Wi-Fi access

110
00:04:17,519 --> 00:04:18,720
points

111
00:04:18,720 --> 00:04:21,478
using open source platforms we found

112
00:04:21,478 --> 00:04:24,180
wiggle to be a very a practical platform

113
00:04:24,180 --> 00:04:27,020
to do so Google is actually

114
00:04:27,020 --> 00:04:29,220
publicly a free and publicly available

115
00:04:29,220 --> 00:04:31,440
platform that stores information about

116
00:04:31,440 --> 00:04:34,919
Wi-Fi networks in all of the world

117
00:04:34,919 --> 00:04:37,080
and users can install the wiggle

118
00:04:37,080 --> 00:04:38,520
application on their phone and the

119
00:04:38,520 --> 00:04:40,440
application will record information

120
00:04:40,440 --> 00:04:42,419
about Wi-Fi networks in the area

121
00:04:42,419 --> 00:04:44,340
information that includes the network

122
00:04:44,340 --> 00:04:46,620
name the network address and the

123
00:04:46,620 --> 00:04:48,000
encryption type

124
00:04:48,000 --> 00:04:50,340
and the coordinates and many other

125
00:04:50,340 --> 00:04:52,919
parameters the users can choose to

126
00:04:52,919 --> 00:04:54,240
upload the information to the Google

127
00:04:54,240 --> 00:04:57,300
database which includes almost 1 billion

128
00:04:57,300 --> 00:04:59,759
unique records there are also two types

129
00:04:59,759 --> 00:05:02,639
of filtering on wiggle the first one as

130
00:05:02,639 --> 00:05:04,440
you can see in the picture is the basic

131
00:05:04,440 --> 00:05:06,660
with the network name and the network

132
00:05:06,660 --> 00:05:10,259
address and the second searching options

133
00:05:10,259 --> 00:05:12,900
that the advanced filtering options is

134
00:05:12,900 --> 00:05:15,240
the Google API

135
00:05:15,240 --> 00:05:17,940
so we Leverage The Wiggle API and we

136
00:05:17,940 --> 00:05:20,160
brought a simple python script that

137
00:05:20,160 --> 00:05:22,160
allowed us for filtering of results

138
00:05:22,160 --> 00:05:24,360
using two different searching

139
00:05:24,360 --> 00:05:26,220
methodologies the first searching

140
00:05:26,220 --> 00:05:28,620
methodology is by the network name we

141
00:05:28,620 --> 00:05:31,460
search for OT related terms

142
00:05:31,460 --> 00:05:36,139
like process control PLC scada

143
00:05:36,139 --> 00:05:39,360
Wastewater and many others and we found

144
00:05:39,360 --> 00:05:41,460
a lot of results for example for the

145
00:05:41,460 --> 00:05:44,160
term westwater we found three 300

146
00:05:44,160 --> 00:05:45,240
results

147
00:05:45,240 --> 00:05:47,520
and the second searching methodology is

148
00:05:47,520 --> 00:05:50,699
by the Mac prefix of the industrial

149
00:05:50,699 --> 00:05:53,400
Wireless iot manufacturers

150
00:05:53,400 --> 00:05:56,340
for example in in this specific example

151
00:05:56,340 --> 00:05:59,900
we search for the Mac prefix of prosoft

152
00:05:59,900 --> 00:06:02,639
manufacturer of industrial Wi-Fi access

153
00:06:02,639 --> 00:06:06,479
points and we found over fourth thousand

154
00:06:06,479 --> 00:06:08,460
and three hundred results in this

155
00:06:08,460 --> 00:06:09,960
specific example

156
00:06:09,960 --> 00:06:12,300
that we found we can see a multinational

157
00:06:12,300 --> 00:06:15,240
food manufacturing company using on one

158
00:06:15,240 --> 00:06:17,060
of their plants

159
00:06:17,060 --> 00:06:19,919
industrial Wi-Fi access points with the

160
00:06:19,919 --> 00:06:23,539
weak encryption of WP

161
00:06:24,360 --> 00:06:26,460
so let's take a look on a few examples

162
00:06:26,460 --> 00:06:29,160
that we found on wiggle and this first

163
00:06:29,160 --> 00:06:30,900
example we can see

164
00:06:30,900 --> 00:06:33,840
a teletonica network industrial silver

165
00:06:33,840 --> 00:06:36,840
Gateway with Wi-Fi functionality in oil

166
00:06:36,840 --> 00:06:37,860
field

167
00:06:37,860 --> 00:06:40,680
because we have the coordinates we found

168
00:06:40,680 --> 00:06:43,139
these photos using Google Maps and

169
00:06:43,139 --> 00:06:44,460
Google studio

170
00:06:44,460 --> 00:06:49,020
the second example is a substation

171
00:06:49,020 --> 00:06:50,819
the third example is a wastewater

172
00:06:50,819 --> 00:06:53,660
treatment plant

173
00:06:54,840 --> 00:06:56,580
and the last example is another

174
00:06:56,580 --> 00:06:59,220
manufacturing plant using industrial

175
00:06:59,220 --> 00:07:03,919
Wi-Fi access points of prosoft

176
00:07:04,440 --> 00:07:06,960
so actually I don't know if attacker is

177
00:07:06,960 --> 00:07:08,819
really using this platform for any

178
00:07:08,819 --> 00:07:11,340
malicious activity but it's interesting

179
00:07:11,340 --> 00:07:13,259
to know that wiggle suddenly removed

180
00:07:13,259 --> 00:07:14,880
Ukraine information from the database

181
00:07:14,880 --> 00:07:17,039
approximately a year ago when the order

182
00:07:17,039 --> 00:07:20,000
first started

183
00:07:20,160 --> 00:07:22,080
foreign

184
00:07:22,080 --> 00:07:24,479
so let's move on to the second attack

185
00:07:24,479 --> 00:07:26,120
Vector the internet exposed Services

186
00:07:26,120 --> 00:07:30,780
local services like web SSH telnet and

187
00:07:30,780 --> 00:07:32,639
others could be exposed to the Internet

188
00:07:32,639 --> 00:07:35,099
by mistake or by Design and remote

189
00:07:35,099 --> 00:07:37,199
attackers can easily find them using

190
00:07:37,199 --> 00:07:41,039
search engines like Showdown census and

191
00:07:41,039 --> 00:07:43,259
there are many others and compromise

192
00:07:43,259 --> 00:07:45,360
them using one day's old days and the

193
00:07:45,360 --> 00:07:46,800
well-known vulnerability the default

194
00:07:46,800 --> 00:07:48,180
credentials

195
00:07:48,180 --> 00:07:51,840
so we decided in our research to focus

196
00:07:51,840 --> 00:07:54,660
on the web local interface of those

197
00:07:54,660 --> 00:07:59,220
devices The Local web interface unlike

198
00:07:59,220 --> 00:08:02,039
other services such as SSH and telnet

199
00:08:02,039 --> 00:08:04,319
contains a lot of vendor-specific logic

200
00:08:04,319 --> 00:08:07,319
which is often a preferred Target for

201
00:08:07,319 --> 00:08:08,639
attackers

202
00:08:08,639 --> 00:08:11,400
we'll see in the upcoming example why

203
00:08:11,400 --> 00:08:14,220
and in this specific table we can see a

204
00:08:14,220 --> 00:08:16,620
list of different industrial solar

205
00:08:16,620 --> 00:08:19,919
Gateway manufacturers and the shutdown

206
00:08:19,919 --> 00:08:22,860
filter that we use in order to find the

207
00:08:22,860 --> 00:08:24,960
exposed Local web services you can see

208
00:08:24,960 --> 00:08:25,860
also

209
00:08:25,860 --> 00:08:28,740
just how easy it is to to find them and

210
00:08:28,740 --> 00:08:31,139
the big numbers of exposed devices

211
00:08:31,139 --> 00:08:33,240
for example for Electronica Network and

212
00:08:33,240 --> 00:08:36,299
CR Wireless so during our research we

213
00:08:36,299 --> 00:08:38,520
also found several remote code execution

214
00:08:38,520 --> 00:08:40,620
vulnerabilities in different Local web

215
00:08:40,620 --> 00:08:43,380
services one of them is the

216
00:08:43,380 --> 00:08:45,480
vulnerability in the airlink family of

217
00:08:45,480 --> 00:08:47,940
devices in CR Wireless

218
00:08:47,940 --> 00:08:51,420
vulnerability is actually a bypass

219
00:08:51,420 --> 00:08:54,420
to a private for a patch for previously

220
00:08:54,420 --> 00:08:58,019
found vulnerability by Talos in 2018

221
00:08:58,019 --> 00:09:01,500
relevant patch was removing a risky

222
00:09:01,500 --> 00:09:03,839
command argument using regex but

223
00:09:03,839 --> 00:09:06,120
unfortunately it didn't cover all the

224
00:09:06,120 --> 00:09:09,120
cases and with slight modification we

225
00:09:09,120 --> 00:09:11,640
managed to use the same vulnerability

226
00:09:11,640 --> 00:09:13,800
and get remote code execution on the

227
00:09:13,800 --> 00:09:14,640
device

228
00:09:14,640 --> 00:09:16,500
leveraging another feature on the system

229
00:09:16,500 --> 00:09:20,660
we wrote a simple exploit that gives us

230
00:09:20,660 --> 00:09:22,860
reversal on the device

231
00:09:22,860 --> 00:09:24,720
unfortunately I don't have enough time

232
00:09:24,720 --> 00:09:26,640
to Deep dive with you into this the

233
00:09:26,640 --> 00:09:29,160
details of this vulnerability if you

234
00:09:29,160 --> 00:09:30,540
want to hear more about it you can talk

235
00:09:30,540 --> 00:09:32,880
with me or read the blog on the

236
00:09:32,880 --> 00:09:35,040
Authority website about this

237
00:09:35,040 --> 00:09:37,939
vulnerability

238
00:09:38,040 --> 00:09:40,260
let's move on to the third and last

239
00:09:40,260 --> 00:09:43,200
attack vector and the most critical in

240
00:09:43,200 --> 00:09:45,899
my point of view in my opinion the cloud

241
00:09:45,899 --> 00:09:47,640
management platforms

242
00:09:47,640 --> 00:09:50,700
so industrial Wireless iot manufacturers

243
00:09:50,700 --> 00:09:53,580
commonly provide these those

244
00:09:53,580 --> 00:09:56,100
platforms for Remote Management of the

245
00:09:56,100 --> 00:09:59,279
devices as I said operations like

246
00:09:59,279 --> 00:10:02,339
configuration changes turn link to the

247
00:10:02,339 --> 00:10:05,760
Local web and SSH Services reboot

248
00:10:05,760 --> 00:10:07,320
firmware upgrades and many others can be

249
00:10:07,320 --> 00:10:10,200
done over the public over the vendor

250
00:10:10,200 --> 00:10:11,880
Cloud management platform

251
00:10:11,880 --> 00:10:14,100
by targeting a single vendor Cloud

252
00:10:14,100 --> 00:10:16,260
management platform an attacker can

253
00:10:16,260 --> 00:10:18,779
compromise thousands of devices

254
00:10:18,779 --> 00:10:22,200
and get direct access to a lot of

255
00:10:22,200 --> 00:10:24,779
internal OT network with one way to the

256
00:10:24,779 --> 00:10:26,760
internet and the second way to the

257
00:10:26,760 --> 00:10:30,019
internal OT Network

258
00:10:32,519 --> 00:10:34,980
so the communication between the devices

259
00:10:34,980 --> 00:10:36,779
and the cloud management platform is

260
00:10:36,779 --> 00:10:38,279
carried out using machine to machine

261
00:10:38,279 --> 00:10:41,339
protocols like Co-op or mqtt

262
00:10:41,339 --> 00:10:43,800
which is the common one mqtt is a

263
00:10:43,800 --> 00:10:45,600
published subscribe protocol

264
00:10:45,600 --> 00:10:48,120
there is the mqtt broker which is the

265
00:10:48,120 --> 00:10:51,120
server the mqhd broker all the topics

266
00:10:51,120 --> 00:10:53,640
and devices can subscribe to those

267
00:10:53,640 --> 00:10:54,540
topics

268
00:10:54,540 --> 00:10:56,519
and once a publisher will publish an

269
00:10:56,519 --> 00:10:58,019
information to the topics all the

270
00:10:58,019 --> 00:11:01,920
subscribers will get this information

271
00:11:01,920 --> 00:11:04,980
so we will talk now about the device

272
00:11:04,980 --> 00:11:07,620
manager the cloud management platform of

273
00:11:07,620 --> 00:11:09,620
Inland networks one of the biggest

274
00:11:09,620 --> 00:11:13,220
manufacturers of industrial Wireless iot

275
00:11:13,220 --> 00:11:15,480
industrial solo gateways and Industrial

276
00:11:15,480 --> 00:11:18,480
Wi-Fi access points we found

277
00:11:18,480 --> 00:11:20,700
a chain of vulnerabilities in their

278
00:11:20,700 --> 00:11:21,899
platform

279
00:11:21,899 --> 00:11:24,720
that gives us a remote code execution

280
00:11:24,720 --> 00:11:27,420
with the root privileges on every cloud

281
00:11:27,420 --> 00:11:31,040
connected routers that they have

282
00:11:31,320 --> 00:11:34,380
so of the communication between the

283
00:11:34,380 --> 00:11:37,500
device manager and the routers look like

284
00:11:37,500 --> 00:11:40,500
so first a simple registration is being

285
00:11:40,500 --> 00:11:43,140
carried out using the cloud account that

286
00:11:43,140 --> 00:11:45,000
configured on the router and there are

287
00:11:45,000 --> 00:11:46,740
serial number

288
00:11:46,740 --> 00:11:49,980
if those parameters are correct and the

289
00:11:49,980 --> 00:11:52,200
device is assigned under this email

290
00:11:52,200 --> 00:11:54,540
account the device manager will send

291
00:11:54,540 --> 00:11:58,740
one-time mqtt credentials including ID

292
00:11:58,740 --> 00:12:02,339
mqtt username and mqtt password

293
00:12:02,339 --> 00:12:04,380
using those credentials the device will

294
00:12:04,380 --> 00:12:06,959
connect to the mqtt broker to the device

295
00:12:06,959 --> 00:12:08,339
manager

296
00:12:08,339 --> 00:12:10,380
and it's important to understand that

297
00:12:10,380 --> 00:12:13,200
for each Cloud connected router there is

298
00:12:13,200 --> 00:12:15,000
two main topics

299
00:12:15,000 --> 00:12:18,240
the one that ends with notice is for

300
00:12:18,240 --> 00:12:22,140
publishing the tasks to the router and

301
00:12:22,140 --> 00:12:24,360
the one that ends with update is the

302
00:12:24,360 --> 00:12:27,240
topics that the router published

303
00:12:27,240 --> 00:12:30,480
is results to the device manager the ID

304
00:12:30,480 --> 00:12:32,519
part is actually the part that

305
00:12:32,519 --> 00:12:34,560
differentiates between different routers

306
00:12:34,560 --> 00:12:37,940
topic names and it's 24 characters

307
00:12:37,940 --> 00:12:40,380
hexadecimal characters string

308
00:12:40,380 --> 00:12:43,019
that actually differentiate between the

309
00:12:43,019 --> 00:12:44,100
topics names

310
00:12:44,100 --> 00:12:46,920
so once the router connected to the

311
00:12:46,920 --> 00:12:50,040
cloud with the mqtt credentials

312
00:12:50,040 --> 00:12:52,139
the router subscribe to the test noticed

313
00:12:52,139 --> 00:12:53,220
a topic

314
00:12:53,220 --> 00:12:54,720
and

315
00:12:54,720 --> 00:12:58,980
get a get config task from the cloud and

316
00:12:58,980 --> 00:13:00,959
in response the router sending the

317
00:13:00,959 --> 00:13:03,060
configuration file directly to the cloud

318
00:13:03,060 --> 00:13:06,180
so this is the generic flow that happens

319
00:13:06,180 --> 00:13:08,459
when the device is Rebooted

320
00:13:08,459 --> 00:13:12,000
so for example if admin wants to upgrade

321
00:13:12,000 --> 00:13:14,160
the firmware the admin clicks on the

322
00:13:14,160 --> 00:13:17,339
update firmware on the UI and behind the

323
00:13:17,339 --> 00:13:18,660
scenes

324
00:13:18,660 --> 00:13:21,540
the device manager will send a task

325
00:13:21,540 --> 00:13:24,980
using the mqtt team

326
00:13:25,560 --> 00:13:28,139
so let's talk now about the

327
00:13:28,139 --> 00:13:30,660
vulnerabilities that we found that using

328
00:13:30,660 --> 00:13:33,240
them we created an exploit that gives us

329
00:13:33,240 --> 00:13:36,000
the opportunity to compromise every

330
00:13:36,000 --> 00:13:39,660
cloud connected devices on this platform

331
00:13:39,660 --> 00:13:41,700
so the first vulnerability is actually

332
00:13:41,700 --> 00:13:44,279
on the registration

333
00:13:44,279 --> 00:13:47,579
we perform the registration process

334
00:13:47,579 --> 00:13:50,279
with two different emails and two

335
00:13:50,279 --> 00:13:52,560
different device serials

336
00:13:52,560 --> 00:13:54,720
and we actually found a very interesting

337
00:13:54,720 --> 00:13:57,480
Behavior we did this with

338
00:13:57,480 --> 00:13:59,940
waiting like something like 10 seconds

339
00:13:59,940 --> 00:14:03,959
between each registration and we found

340
00:14:03,959 --> 00:14:06,720
here is the print of the results that we

341
00:14:06,720 --> 00:14:08,940
got

342
00:14:08,940 --> 00:14:11,339
actually the first part of the ID that

343
00:14:11,339 --> 00:14:13,560
we got is a timestamp in which the

344
00:14:13,560 --> 00:14:15,660
registration performed and the second

345
00:14:15,660 --> 00:14:16,620
part

346
00:14:16,620 --> 00:14:20,000
is ascending by two

347
00:14:20,399 --> 00:14:23,579
every time so actually

348
00:14:23,579 --> 00:14:25,620
this this behavior is very interesting

349
00:14:25,620 --> 00:14:28,860
so we did this operation again but in

350
00:14:28,860 --> 00:14:31,260
this time we decided to wait five

351
00:14:31,260 --> 00:14:33,540
minutes between each registration and

352
00:14:33,540 --> 00:14:35,220
here we found something more interesting

353
00:14:35,220 --> 00:14:38,180
we found it before

354
00:14:38,399 --> 00:14:41,279
the second and third registration

355
00:14:41,279 --> 00:14:44,760
between them the second part

356
00:14:44,760 --> 00:14:47,399
increased by four and not by two and

357
00:14:47,399 --> 00:14:50,279
from that we learned that probably

358
00:14:50,279 --> 00:14:52,139
a real router somewhere in the world

359
00:14:52,139 --> 00:14:54,300
connected to the cloud

360
00:14:54,300 --> 00:14:57,060
between those two registration that we

361
00:14:57,060 --> 00:15:00,300
performed so we actually know the idea

362
00:15:00,300 --> 00:15:02,160
of this router the second part we know

363
00:15:02,160 --> 00:15:05,160
exactly it ends with 472.

364
00:15:05,160 --> 00:15:08,160
and the first part is one of 300 options

365
00:15:08,160 --> 00:15:10,560
because in five minutes we have 300

366
00:15:10,560 --> 00:15:11,519
seconds

367
00:15:11,519 --> 00:15:15,120
so we actually know the the ID of this

368
00:15:15,120 --> 00:15:19,380
specific router and this parameter is

369
00:15:19,380 --> 00:15:20,940
actually the parameter that

370
00:15:20,940 --> 00:15:22,860
differentiates between topics names of

371
00:15:22,860 --> 00:15:25,740
different Cloud connected routers so

372
00:15:25,740 --> 00:15:27,959
this vulnerability leads us to the

373
00:15:27,959 --> 00:15:29,399
second vulnerability

374
00:15:29,399 --> 00:15:32,639
we decided to try to subscribe

375
00:15:32,639 --> 00:15:35,639
to all the topics of this router

376
00:15:35,639 --> 00:15:38,040
and see if there is an access control

377
00:15:38,040 --> 00:15:41,220
policy on this device manager

378
00:15:41,220 --> 00:15:43,380
and if there is no access control policy

379
00:15:43,380 --> 00:15:45,540
we will get the information of

380
00:15:45,540 --> 00:15:48,180
this router from the cloud the last

381
00:15:48,180 --> 00:15:49,800
thing that was written to the topic will

382
00:15:49,800 --> 00:15:51,540
will get this

383
00:15:51,540 --> 00:15:54,060
so we try to subscribe to all the task

384
00:15:54,060 --> 00:15:56,279
updates topics the topics that the

385
00:15:56,279 --> 00:15:58,560
router sending these responses to

386
00:15:58,560 --> 00:16:02,160
and actually after 175 attempts we eated

387
00:16:02,160 --> 00:16:04,199
the correct

388
00:16:04,199 --> 00:16:06,480
timestamp in which this router connected

389
00:16:06,480 --> 00:16:08,100
to the cloud and we got its

390
00:16:08,100 --> 00:16:09,899
configuration file

391
00:16:09,899 --> 00:16:12,180
so it's really crazy we have now the

392
00:16:12,180 --> 00:16:14,279
configuration file of

393
00:16:14,279 --> 00:16:17,880
router in the world very cool

394
00:16:17,880 --> 00:16:22,440
so we decided to check if we also can

395
00:16:22,440 --> 00:16:24,420
send configuration to router of course

396
00:16:24,420 --> 00:16:27,600
this we did to our router in lab yeah we

397
00:16:27,600 --> 00:16:29,459
didn't damage any operational router

398
00:16:29,459 --> 00:16:31,079
somewhere in the world

399
00:16:31,079 --> 00:16:34,380
so we checked it and actually we can

400
00:16:34,380 --> 00:16:35,940
also

401
00:16:35,940 --> 00:16:37,259
send

402
00:16:37,259 --> 00:16:39,720
tasks to routers

403
00:16:39,720 --> 00:16:41,100
and

404
00:16:41,100 --> 00:16:42,600
the device actually get the

405
00:16:42,600 --> 00:16:44,940
configuration we did we actually changed

406
00:16:44,940 --> 00:16:48,420
the hostname and send a set config with

407
00:16:48,420 --> 00:16:50,399
the modified configuration modified

408
00:16:50,399 --> 00:16:52,560
hostname to our lab device

409
00:16:52,560 --> 00:16:55,920
and actually the once the device manager

410
00:16:55,920 --> 00:16:58,639
Cloud platforms got the configuration

411
00:16:58,639 --> 00:17:01,440
it forwarded to the device and the

412
00:17:01,440 --> 00:17:03,899
device performed the reboot and load the

413
00:17:03,899 --> 00:17:05,640
a new configuration with the new

414
00:17:05,640 --> 00:17:07,199
hostname

415
00:17:07,199 --> 00:17:11,459
so cool we have the opportunity to also

416
00:17:11,459 --> 00:17:12,959
read and write configuration to Cloud

417
00:17:12,959 --> 00:17:14,520
connected devices

418
00:17:14,520 --> 00:17:17,339
let's see if we can also get reversion

419
00:17:17,339 --> 00:17:20,220
on those routers so this leads us to the

420
00:17:20,220 --> 00:17:23,400
third vulnerability we decided to check

421
00:17:23,400 --> 00:17:26,459
all the passing functions

422
00:17:26,459 --> 00:17:28,319
that responsible for passing the

423
00:17:28,319 --> 00:17:30,780
configuration on the device itself

424
00:17:30,780 --> 00:17:32,400
and we

425
00:17:32,400 --> 00:17:34,500
in the configuration file there are

426
00:17:34,500 --> 00:17:37,860
hundreds of configuration lines and we

427
00:17:37,860 --> 00:17:39,539
check all the function that's

428
00:17:39,539 --> 00:17:41,100
responsible for passing this

429
00:17:41,100 --> 00:17:43,260
configuration lines and we actually

430
00:17:43,260 --> 00:17:45,720
found a very interesting two parameters

431
00:17:45,720 --> 00:17:47,700
right in the beginning in the autoping

432
00:17:47,700 --> 00:17:50,160
enable and to Ping test

433
00:17:50,160 --> 00:17:53,100
once data ping enabled is one the device

434
00:17:53,100 --> 00:17:55,020
will perform an internet connectivity

435
00:17:55,020 --> 00:17:58,080
checks to the parameters in the autoping

436
00:17:58,080 --> 00:17:59,940
desk which is the Google DNS

437
00:17:59,940 --> 00:18:03,299
and as you can see this picture if

438
00:18:03,299 --> 00:18:05,940
this parameter the first one is enabled

439
00:18:05,940 --> 00:18:08,760
this function will be executed and the

440
00:18:08,760 --> 00:18:11,160
autoping this will be concatenated to

441
00:18:11,160 --> 00:18:14,220
the Ping command with a very unsafe

442
00:18:14,220 --> 00:18:16,440
manner okay without the boundary checks

443
00:18:16,440 --> 00:18:19,440
and will execute it as a system which is

444
00:18:19,440 --> 00:18:21,299
actually a root

445
00:18:21,299 --> 00:18:22,559
so

446
00:18:22,559 --> 00:18:24,660
probably some of you know already what

447
00:18:24,660 --> 00:18:27,299
I'm going to do now

448
00:18:27,299 --> 00:18:29,820
just concatenated the name cut command

449
00:18:29,820 --> 00:18:32,520
on the device with minus E been a sage

450
00:18:32,520 --> 00:18:34,559
of course there is an end cut on this

451
00:18:34,559 --> 00:18:38,039
router and sending this configuration to

452
00:18:38,039 --> 00:18:42,059
the device gives us a root on the device

453
00:18:42,059 --> 00:18:43,320
so

454
00:18:43,320 --> 00:18:45,419
we took all those three vulnerabilities

455
00:18:45,419 --> 00:18:48,539
and created an exploit script

456
00:18:48,539 --> 00:18:51,240
and now we will see a demonstration of

457
00:18:51,240 --> 00:18:53,700
this exploit on our of course lab device

458
00:18:53,700 --> 00:18:56,220
we didn't damage any operational router

459
00:18:56,220 --> 00:18:58,919
somewhere in the world so in the left

460
00:18:58,919 --> 00:19:01,740
side you can see the victim and the

461
00:19:01,740 --> 00:19:04,020
right side you can see the attacker

462
00:19:04,020 --> 00:19:06,780
in the Vixen side on the top it's the

463
00:19:06,780 --> 00:19:10,740
Local web service of the router we will

464
00:19:10,740 --> 00:19:15,179
enable there the cloud feature and in

465
00:19:15,179 --> 00:19:16,919
the bottom there is this is the cloud

466
00:19:16,919 --> 00:19:19,380
account that's responsible for death

467
00:19:19,380 --> 00:19:21,960
router in the attacker side in the top

468
00:19:21,960 --> 00:19:24,780
this is the command and control of the

469
00:19:24,780 --> 00:19:27,059
attacker in this case a listening gen

470
00:19:27,059 --> 00:19:29,160
cut and in the bottom this is the

471
00:19:29,160 --> 00:19:30,840
attacker exploit

472
00:19:30,840 --> 00:19:33,419
again in order to not damage any router

473
00:19:33,419 --> 00:19:36,720
in the world we decided to Art code our

474
00:19:36,720 --> 00:19:39,480
router serial number on the script

475
00:19:39,480 --> 00:19:41,460
so

476
00:19:41,460 --> 00:19:44,700
we do not attack by mistake any router

477
00:19:44,700 --> 00:19:48,559
in the world so now we will see the demo

478
00:19:51,419 --> 00:19:54,539
so here I am enabling the cloud

479
00:19:54,539 --> 00:19:57,240
management feature and you will see in

480
00:19:57,240 --> 00:19:59,340
the bottom that the zero will change to

481
00:19:59,340 --> 00:20:00,240
one

482
00:20:00,240 --> 00:20:02,160
okay the device is connected to the

483
00:20:02,160 --> 00:20:04,520
cloud now

484
00:20:05,400 --> 00:20:08,760
here I'm doing a configuration fetching

485
00:20:08,760 --> 00:20:11,280
this is the exploitation script okay I'm

486
00:20:11,280 --> 00:20:13,320
going to change the router name to pawn

487
00:20:13,320 --> 00:20:17,220
and I'm going also to insert a reverse

488
00:20:17,220 --> 00:20:18,900
shell in order to the device will

489
00:20:18,900 --> 00:20:21,900
connect to my listening and cut so here

490
00:20:21,900 --> 00:20:24,059
I'm running the exploit

491
00:20:24,059 --> 00:20:25,740
getting the configuration of the device

492
00:20:25,740 --> 00:20:27,419
from the cloud injecting the modify

493
00:20:27,419 --> 00:20:30,380
configuration you can see that the cloud

494
00:20:30,380 --> 00:20:32,880
forward this configuration to the device

495
00:20:32,880 --> 00:20:35,220
the device performed a reboot in order

496
00:20:35,220 --> 00:20:37,740
to load the new configuration and here

497
00:20:37,740 --> 00:20:39,660
you can see the configure the device

498
00:20:39,660 --> 00:20:41,820
name change to Pond and the device

499
00:20:41,820 --> 00:20:43,260
connected to the

500
00:20:43,260 --> 00:20:46,380
attacker command and control and

501
00:20:46,380 --> 00:20:48,419
we have a root on the device

502
00:20:48,419 --> 00:20:51,080
foreign

503
00:20:54,720 --> 00:20:56,940
so just to understand this is not a

504
00:20:56,940 --> 00:20:59,460
single example we actually found a

505
00:20:59,460 --> 00:21:01,380
serious vulnerabilities in other vendors

506
00:21:01,380 --> 00:21:04,620
as well big vendors unfortunately I can

507
00:21:04,620 --> 00:21:06,059
share with you the info the information

508
00:21:06,059 --> 00:21:08,640
about this because it's still under

509
00:21:08,640 --> 00:21:10,799
responsible disclosure process

510
00:21:10,799 --> 00:21:13,679
but you can follow us on LinkedIn or

511
00:21:13,679 --> 00:21:16,380
something and we will share our findings

512
00:21:16,380 --> 00:21:17,700
there

513
00:21:17,700 --> 00:21:19,320
so

514
00:21:19,320 --> 00:21:22,020
industrial wireless iot devices brings a

515
00:21:22,020 --> 00:21:23,880
lot of opportunities to operational

516
00:21:23,880 --> 00:21:25,919
Networks

517
00:21:25,919 --> 00:21:28,380
from operational perspective and also

518
00:21:28,380 --> 00:21:29,520
economic

519
00:21:29,520 --> 00:21:31,440
but they are also introducing the OT

520
00:21:31,440 --> 00:21:34,140
networks to new types of risks as we saw

521
00:21:34,140 --> 00:21:37,080
during this session

522
00:21:37,080 --> 00:21:39,360
so in order to reduce the risk from

523
00:21:39,360 --> 00:21:40,919
those devices we have few

524
00:21:40,919 --> 00:21:43,260
recommendations

525
00:21:43,260 --> 00:21:45,120
starting with the on-site Wi-Fi solar

526
00:21:45,120 --> 00:21:47,299
channels not used

527
00:21:47,299 --> 00:21:50,940
unsecure encryptions like WAP and the

528
00:21:50,940 --> 00:21:53,960
GPRS protocol if you can on the seller

529
00:21:53,960 --> 00:21:56,700
and I the network name of course don't

530
00:21:56,700 --> 00:21:57,659
use

531
00:21:57,659 --> 00:22:00,000
OT related terms that will make the life

532
00:22:00,000 --> 00:22:02,940
easier for attackers and perform a

533
00:22:02,940 --> 00:22:05,340
mag-based white listing for device that

534
00:22:05,340 --> 00:22:07,980
get connected to the Wi-Fi or a

535
00:22:07,980 --> 00:22:09,720
certificate based white listing for

536
00:22:09,720 --> 00:22:10,860
devices

537
00:22:10,860 --> 00:22:13,080
for internet exposed services

538
00:22:13,080 --> 00:22:15,120
if you can limit the access to the

539
00:22:15,120 --> 00:22:17,580
Management Services like HTTP SSH

540
00:22:17,580 --> 00:22:20,460
antenna to the Lan interface only and

541
00:22:20,460 --> 00:22:23,039
also ensure that no default credentials

542
00:22:23,039 --> 00:22:25,260
in use so if the device by mistake will

543
00:22:25,260 --> 00:22:27,000
be exposed to the internet those

544
00:22:27,000 --> 00:22:30,000
Services won't be and also the attacker

545
00:22:30,000 --> 00:22:31,500
won't be able to use the default

546
00:22:31,500 --> 00:22:33,600
credentials on the device

547
00:22:33,600 --> 00:22:36,059
and the third a recommendation for cloud

548
00:22:36,059 --> 00:22:38,880
management platform we saw that in a lot

549
00:22:38,880 --> 00:22:39,780
of

550
00:22:39,780 --> 00:22:42,480
industrial solar Gateway manufacturers

551
00:22:42,480 --> 00:22:45,480
this feature is enabled by default

552
00:22:45,480 --> 00:22:47,700
and if you are not using this feature

553
00:22:47,700 --> 00:22:50,520
just disable it on the Local web

554
00:22:50,520 --> 00:22:52,260
interface of the device

555
00:22:52,260 --> 00:22:55,860
and the second suggestion for the

556
00:22:55,860 --> 00:22:57,240
specific

557
00:22:57,240 --> 00:23:00,780
point of the cloud management platform

558
00:23:00,780 --> 00:23:02,880
we are suggesting not to use the

559
00:23:02,880 --> 00:23:04,679
built-in security features on the device

560
00:23:04,679 --> 00:23:07,679
if you can use a separated Hardware

561
00:23:07,679 --> 00:23:10,080
between the local network and the

562
00:23:10,080 --> 00:23:13,020
industrial cellular Gateway it'd be good

563
00:23:13,020 --> 00:23:15,720
because if attackers will compromise the

564
00:23:15,720 --> 00:23:16,559
device

565
00:23:16,559 --> 00:23:18,539
they won't be able to communicate

566
00:23:18,539 --> 00:23:20,880
directly with the level two to level

567
00:23:20,880 --> 00:23:23,520
zero devices the firewall will separate

568
00:23:23,520 --> 00:23:26,340
between them and also the attacker won't

569
00:23:26,340 --> 00:23:28,200
be able to perform and the middle

570
00:23:28,200 --> 00:23:30,360
attacks because the traffic already will

571
00:23:30,360 --> 00:23:32,580
be encrypted

572
00:23:32,580 --> 00:23:34,260
so

573
00:23:34,260 --> 00:23:36,900
my name is Ronnie I also want to thank

574
00:23:36,900 --> 00:23:39,240
to Adrian Young from fortunate research

575
00:23:39,240 --> 00:23:41,880
team my partner for This research

576
00:23:41,880 --> 00:23:43,500
and

577
00:23:43,500 --> 00:23:45,900
thank you all for for your time and for

578
00:23:45,900 --> 00:23:48,299
listening me and if if you have any

579
00:23:48,299 --> 00:23:51,240
questions about our research You're

580
00:23:51,240 --> 00:23:53,820
Welcome to our booth in the search floor

581
00:23:53,820 --> 00:23:56,820
in the moon room and ask me about Cloud

582
00:23:56,820 --> 00:23:58,799
management platforms a lot of research

583
00:23:58,799 --> 00:24:00,720
about wiggle if you want to test

584
00:24:00,720 --> 00:24:03,419
yourself on wiggle and

585
00:24:03,419 --> 00:24:04,670
thank you very much

586
00:24:04,670 --> 00:24:15,979
[Applause]

