1
00:00:03,819 --> 00:00:08,990
welcome to<font color="#E5E5E5"> s4 is stage</font><font color="#CCCCCC"> two</font><font color="#E5E5E5"> technical</font>

2
00:00:07,129 --> 00:00:10,940
deep dives<font color="#CCCCCC"> here we go</font>

3
00:00:08,990 --> 00:00:13,100
<font color="#CCCCCC">Steven hilt</font><font color="#E5E5E5"> is a senior threat</font>

4
00:00:10,940 --> 00:00:15,290
researcher and<font color="#E5E5E5"> Jonathan Anderson is the</font>

5
00:00:13,100 --> 00:00:17,780
<font color="#E5E5E5">manager of advanced security research at</font>

6
00:00:15,290 --> 00:00:25,400
Trend Micro please welcome<font color="#E5E5E5"> Steven and</font>

7
00:00:17,780 --> 00:00:26,710
Jonathan<font color="#E5E5E5"> to stage two so today we're</font>

8
00:00:25,400 --> 00:00:28,820
gonna<font color="#E5E5E5"> talk a little bit about</font>

9
00:00:26,710 --> 00:00:31,570
software-defined radio research that we

10
00:00:28,820 --> 00:00:34,520
<font color="#CCCCCC">have</font><font color="#E5E5E5"> been working on here</font><font color="#CCCCCC"> at Trend Micro</font>

11
00:00:31,570 --> 00:00:37,070
<font color="#CCCCCC">why did we start doing Trend Micro</font>

12
00:00:34,520 --> 00:00:39,380
traditionally as an<font color="#CCCCCC"> AV company so why</font>

13
00:00:37,070 --> 00:00:41,660
are we<font color="#E5E5E5"> doing software-defined radio</font>

14
00:00:39,380 --> 00:00:44,989
research it started back<font color="#CCCCCC"> actually before</font>

15
00:00:41,660 --> 00:00:47,690
<font color="#E5E5E5">this one of my co-workers</font><font color="#CCCCCC"> Marko</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> Kyle</font>

16
00:00:44,989 --> 00:00:50,000
<font color="#E5E5E5">will Hawaii</font><font color="#CCCCCC"> and a couple others</font><font color="#E5E5E5"> started</font>

17
00:00:47,690 --> 00:00:52,780
<font color="#E5E5E5">doing research with AIS and one of the</font>

18
00:00:50,000 --> 00:00:55,399
first<font color="#CCCCCC"> people to look into that</font><font color="#E5E5E5"> and then</font>

19
00:00:52,780 --> 00:00:57,469
two years<font color="#E5E5E5"> ago three years ago now I</font>

20
00:00:55,399 --> 00:01:02,140
released the series of looking at pagers

21
00:00:57,469 --> 00:01:04,909
and<font color="#CCCCCC"> how communications</font><font color="#E5E5E5"> are insecure and</font>

22
00:01:02,140 --> 00:01:05,869
you know we could sniff them and figure

23
00:01:04,909 --> 00:01:08,960
<font color="#CCCCCC">out what people were</font><font color="#E5E5E5"> trying to talk</font>

24
00:01:05,869 --> 00:01:13,790
<font color="#CCCCCC">about</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> we are tasked again to come up</font>

25
00:01:08,960 --> 00:01:17,750
<font color="#E5E5E5">with a new SDR research in which we came</font>

26
00:01:13,790 --> 00:01:19,850
up with few ideas<font color="#CCCCCC"> random by a bunch of</font>

27
00:01:17,750 --> 00:01:21,110
people<font color="#CCCCCC"> and</font><font color="#E5E5E5"> decided that well we were</font>

28
00:01:19,850 --> 00:01:24,320
gonna look at<font color="#E5E5E5"> it was something that you</font>

29
00:01:21,110 --> 00:01:27,350
<font color="#CCCCCC">see every day Jonathan</font><font color="#E5E5E5"> and I were</font>

30
00:01:24,320 --> 00:01:29,869
<font color="#CCCCCC">recently in Tokyo</font><font color="#E5E5E5"> for Trend</font><font color="#CCCCCC"> Micro CTF</font>

31
00:01:27,350 --> 00:01:34,189
and this is a<font color="#E5E5E5"> picture</font><font color="#CCCCCC"> from the Rainbow</font>

32
00:01:29,869 --> 00:01:38,479
<font color="#CCCCCC">Bridge</font><font color="#E5E5E5"> looking towards Tokyo and what we</font>

33
00:01:34,189 --> 00:01:40,100
saw here<font color="#E5E5E5"> looks like an average</font><font color="#CCCCCC"> City but</font>

34
00:01:38,479 --> 00:01:43,340
when you start<font color="#CCCCCC"> looking in closer you</font>

35
00:01:40,100 --> 00:01:46,130
<font color="#CCCCCC">start</font><font color="#E5E5E5"> seeing lots of things lots of</font>

36
00:01:43,340 --> 00:01:49,009
cranes lots of things like<font color="#CCCCCC"> that</font><font color="#E5E5E5"> so when</font>

37
00:01:46,130 --> 00:01:50,869
we originally pitched this idea<font color="#CCCCCC"> we</font>

38
00:01:49,009 --> 00:01:53,329
looked at things<font color="#E5E5E5"> that we were gonna look</font>

39
00:01:50,869 --> 00:01:55,479
at and cranes came up because<font color="#E5E5E5"> we</font>

40
00:01:53,329 --> 00:02:00,020
realized a lot<font color="#CCCCCC"> of these</font><font color="#E5E5E5"> systems are</font>

41
00:01:55,479 --> 00:02:01,789
<font color="#E5E5E5">wireless so</font><font color="#CCCCCC"> it was a prime target</font><font color="#E5E5E5"> target</font>

42
00:02:00,020 --> 00:02:07,429
for of course<font color="#CCCCCC"> the software-defined radio</font>

43
00:02:01,790 --> 00:02:10,009
research<font color="#E5E5E5"> so we went to a couple sites to</font>

44
00:02:07,430 --> 00:02:12,379
see<font color="#E5E5E5"> how all these things</font><font color="#CCCCCC"> worked</font><font color="#E5E5E5"> and we</font>

45
00:02:10,008 --> 00:02:14,858
quickly found you know this is one from

46
00:02:12,379 --> 00:02:18,548
a<font color="#E5E5E5"> co-worker of ours who went to a</font>

47
00:02:14,859 --> 00:02:20,599
industrial<font color="#E5E5E5"> site or</font><font color="#CCCCCC"> their a mini for</font>

48
00:02:18,549 --> 00:02:23,299
construction site<font color="#E5E5E5"> and this was a</font>

49
00:02:20,599 --> 00:02:26,149
<font color="#E5E5E5">construction crane and what we saw here</font>

50
00:02:23,299 --> 00:02:29,840
was<font color="#E5E5E5"> of course</font><font color="#CCCCCC"> its radio so this is one</font>

51
00:02:26,150 --> 00:02:33,799
type<font color="#CCCCCC"> that you see is it's a strap and</font>

52
00:02:29,840 --> 00:02:38,629
<font color="#E5E5E5">you hold it the other type is this kind</font>

53
00:02:33,799 --> 00:02:42,859
of system here<font color="#CCCCCC"> more of a pendant</font><font color="#E5E5E5"> around</font>

54
00:02:38,629 --> 00:02:44,090
<font color="#E5E5E5">your neck</font><font color="#CCCCCC"> so when once we</font><font color="#E5E5E5"> started</font>

55
00:02:42,859 --> 00:02:45,739
<font color="#E5E5E5">looking at these and realizing they were</font>

56
00:02:44,090 --> 00:02:49,999
<font color="#CCCCCC">wireless we asked ourselves three</font>

57
00:02:45,739 --> 00:02:53,180
questions<font color="#CCCCCC"> those</font><font color="#E5E5E5"> questions</font><font color="#CCCCCC"> were where are</font>

58
00:02:49,999 --> 00:02:54,590
they used<font color="#E5E5E5"> how do they work and</font><font color="#CCCCCC"> what are</font>

59
00:02:53,180 --> 00:02:58,180
the<font color="#E5E5E5"> risks</font><font color="#CCCCCC"> so we're gonna go real quick</font>

60
00:02:54,590 --> 00:03:00,889
through where are they used

61
00:02:58,180 --> 00:03:06,099
does anyone here<font color="#E5E5E5"> work in</font><font color="#CCCCCC"> a place that</font>

62
00:03:00,889 --> 00:03:08,569
<font color="#CCCCCC">has cranes a couple of us okay are they</font>

63
00:03:06,099 --> 00:03:12,409
<font color="#CCCCCC">wireless cranes or do you not</font><font color="#E5E5E5"> know I</font>

64
00:03:08,569 --> 00:03:14,659
asked one of my mechanic friends if I

65
00:03:12,409 --> 00:03:17,510
<font color="#CCCCCC">could look at his and he brought me over</font>

66
00:03:14,659 --> 00:03:19,279
and there<font color="#E5E5E5"> was no way to hack it it was</font>

67
00:03:17,510 --> 00:03:22,849
still<font color="#CCCCCC"> chained</font><font color="#E5E5E5"> driven so that didn't work</font>

68
00:03:19,279 --> 00:03:28,299
<font color="#E5E5E5">out very well so</font><font color="#CCCCCC"> that in case is an</font>

69
00:03:22,849 --> 00:03:31,388
industrial hoist<font color="#CCCCCC"> there's a mobile hoist</font>

70
00:03:28,299 --> 00:03:34,120
<font color="#E5E5E5">concrete pumps use these systems</font>

71
00:03:31,389 --> 00:03:37,760
agricultural uses these systems

72
00:03:34,120 --> 00:03:41,150
logistics<font color="#CCCCCC"> harbors and stuff</font><font color="#E5E5E5"> like that</font>

73
00:03:37,760 --> 00:03:44,629
<font color="#CCCCCC">used</font><font color="#E5E5E5"> wireless controllers here they use</font>

74
00:03:41,150 --> 00:03:46,639
them on a very forefront<font color="#E5E5E5"> and because the</font>

75
00:03:44,629 --> 00:03:49,608
crane operators get really bad vertigo

76
00:03:46,639 --> 00:03:51,829
<font color="#CCCCCC">they've actually</font><font color="#E5E5E5"> removed the people and</font>

77
00:03:49,609 --> 00:03:53,930
a lot<font color="#CCCCCC"> of places and</font><font color="#E5E5E5"> they move them to a</font>

78
00:03:51,829 --> 00:03:56,900
control center<font color="#E5E5E5"> and they aren't</font>

79
00:03:53,930 --> 00:04:01,099
<font color="#E5E5E5">physically sitting</font><font color="#CCCCCC"> there moving with the</font>

80
00:03:56,900 --> 00:04:03,619
crane forestry uses them

81
00:04:01,099 --> 00:04:08,358
drilling operations industrial

82
00:04:03,619 --> 00:04:12,589
automation<font color="#E5E5E5"> mining pretty much what we're</font>

83
00:04:08,359 --> 00:04:14,959
saying is everything<font color="#E5E5E5"> everywhere uses</font>

84
00:04:12,589 --> 00:04:18,069
these I used to work for a<font color="#E5E5E5"> utility I</font>

85
00:04:14,959 --> 00:04:22,580
know utilities use these nuclear

86
00:04:18,069 --> 00:04:25,699
industry uses them to<font color="#CCCCCC"> lift the material</font>

87
00:04:22,580 --> 00:04:26,960
out<font color="#CCCCCC"> to lift</font><font color="#E5E5E5"> the reactor lids</font><font color="#CCCCCC"> just any</font>

88
00:04:25,699 --> 00:04:28,520
any<font color="#E5E5E5"> work time</font>

89
00:04:26,960 --> 00:04:32,719
<font color="#CCCCCC">anyplace you need</font><font color="#E5E5E5"> to lift something</font>

90
00:04:28,520 --> 00:04:34,639
heavy<font color="#CCCCCC"> you're gonna find one of</font><font color="#E5E5E5"> these so</font>

91
00:04:32,720 --> 00:04:37,759
<font color="#E5E5E5">we started doing a survey on what we</font>

92
00:04:34,639 --> 00:04:39,860
wanted<font color="#E5E5E5"> to see was where they were used</font>

93
00:04:37,759 --> 00:04:41,030
where they're manufactured so we already

94
00:04:39,860 --> 00:04:43,669
<font color="#CCCCCC">Danelle down that</font><font color="#E5E5E5"> they're used</font>

95
00:04:41,030 --> 00:04:45,888
<font color="#E5E5E5">everywhere where they're manufactured so</font>

96
00:04:43,669 --> 00:04:49,280
we selected some vendors to look at

97
00:04:45,889 --> 00:04:51,110
regions that were a<font color="#E5E5E5"> global mapping to</font>

98
00:04:49,280 --> 00:04:55,429
make sure that we didn't just<font color="#E5E5E5"> pick one</font>

99
00:04:51,110 --> 00:04:58,280
area<font color="#E5E5E5"> one specific item or</font><font color="#CCCCCC"> we wanted</font><font color="#E5E5E5"> to</font>

100
00:04:55,430 --> 00:05:00,349
<font color="#E5E5E5">make sure that this was a problem</font>

101
00:04:58,280 --> 00:05:05,830
the findings are going to be a<font color="#E5E5E5"> global</font>

102
00:05:00,349 --> 00:05:08,539
issue<font color="#E5E5E5"> so as you can see we have</font><font color="#CCCCCC"> lots of</font>

103
00:05:05,830 --> 00:05:12,460
countries and regions from<font color="#E5E5E5"> around the</font>

104
00:05:08,539 --> 00:05:18,259
world covered here so how do they<font color="#E5E5E5"> work</font>

105
00:05:12,460 --> 00:05:20,299
<font color="#E5E5E5">the transmitter communicates over RF to</font>

106
00:05:18,259 --> 00:05:22,789
the receiver which<font color="#E5E5E5"> we're going to go</font>

107
00:05:20,300 --> 00:05:30,380
ahead and start it<font color="#E5E5E5"> up here and what</font>

108
00:05:22,789 --> 00:05:38,270
we're gonna do is turn the<font color="#CCCCCC"> column so</font>

109
00:05:30,380 --> 00:05:40,280
we're gonna do is it lifts<font color="#E5E5E5"> okay what</font>

110
00:05:38,270 --> 00:05:42,320
happened there was it open to relay and

111
00:05:40,280 --> 00:05:46,340
drove the motor<font color="#E5E5E5"> lifted the beer</font><font color="#CCCCCC"> ice that</font>

112
00:05:42,320 --> 00:05:48,740
coin the the receiver then controls

113
00:05:46,340 --> 00:05:50,239
something<font color="#E5E5E5"> in a factory and a</font><font color="#CCCCCC"> plant</font><font color="#E5E5E5"> in</font>

114
00:05:48,740 --> 00:05:52,909
any one<font color="#CCCCCC"> of</font><font color="#E5E5E5"> those locations we mentioned</font>

115
00:05:50,240 --> 00:05:55,669
earlier<font color="#CCCCCC"> okay so now we know how they</font>

116
00:05:52,909 --> 00:05:57,289
work<font color="#E5E5E5"> but what are the risks</font><font color="#CCCCCC"> and that's</font>

117
00:05:55,669 --> 00:05:59,599
what we<font color="#E5E5E5"> really wanted</font><font color="#CCCCCC"> to determine</font><font color="#E5E5E5"> here</font>

118
00:05:57,289 --> 00:06:02,810
was what was the risks of this how<font color="#CCCCCC"> does</font>

119
00:05:59,599 --> 00:06:05,599
this work can we reverse<font color="#E5E5E5"> engineer this</font>

120
00:06:02,810 --> 00:06:11,150
and and does everything work<font color="#E5E5E5"> out fine or</font>

121
00:06:05,599 --> 00:06:13,669
is it insecure<font color="#E5E5E5"> or was it secure so</font><font color="#CCCCCC"> the</font>

122
00:06:11,150 --> 00:06:17,030
risk here is most of these items<font color="#CCCCCC"> are</font>

123
00:06:13,669 --> 00:06:23,090
devices<font color="#CCCCCC"> that we</font><font color="#E5E5E5"> found</font><font color="#CCCCCC"> we're in the 400</font>

124
00:06:17,030 --> 00:06:25,099
<font color="#E5E5E5">to 900 megahertz range which means in by</font>

125
00:06:23,090 --> 00:06:27,349
specs and by design<font color="#CCCCCC"> they wanted them to</font>

126
00:06:25,099 --> 00:06:31,729
<font color="#CCCCCC">work within usually 300 meters of the</font>

127
00:06:27,349 --> 00:06:34,849
receiver<font color="#CCCCCC"> but as we</font><font color="#E5E5E5"> all</font><font color="#CCCCCC"> know from doing</font>

128
00:06:31,729 --> 00:06:38,779
security research<font color="#E5E5E5"> the limit there's by</font>

129
00:06:34,849 --> 00:06:40,438
power not by<font color="#E5E5E5"> distance so an attacker can</font>

130
00:06:38,779 --> 00:06:42,869
be<font color="#E5E5E5"> kilometers away</font>

131
00:06:40,439 --> 00:06:47,809
depending on the<font color="#CCCCCC"> frequency and ideal</font>

132
00:06:42,869 --> 00:06:51,059
scenarios moisture levels and<font color="#E5E5E5"> whatnot so</font>

133
00:06:47,809 --> 00:06:54,059
what we wanted<font color="#CCCCCC"> to do was place a</font>

134
00:06:51,059 --> 00:06:57,449
scenario where we are an attacker<font color="#E5E5E5"> so as</font>

135
00:06:54,059 --> 00:06:59,129
we mentioned<font color="#CCCCCC"> earlier</font><font color="#E5E5E5"> the operator is</font>

136
00:06:57,449 --> 00:07:01,409
controlling the factory what happens

137
00:06:59,129 --> 00:07:04,409
then<font color="#CCCCCC"> as the attacker records the command</font>

138
00:07:01,409 --> 00:07:07,919
<font color="#E5E5E5">so this is one of</font><font color="#CCCCCC"> the first tests we did</font>

139
00:07:04,409 --> 00:07:09,959
which was can we<font color="#E5E5E5"> do a replay attack and</font>

140
00:07:07,919 --> 00:07:13,799
so we wanted to<font color="#E5E5E5"> see if we were able to</font>

141
00:07:09,959 --> 00:07:16,619
just<font color="#E5E5E5"> record and replay commands so we</font>

142
00:07:13,800 --> 00:07:19,519
captured the data<font color="#E5E5E5"> and then the attacker</font>

143
00:07:16,619 --> 00:07:22,110
would transmit and record the data and

144
00:07:19,519 --> 00:07:23,759
<font color="#E5E5E5">then would</font><font color="#CCCCCC"> be able to control the</font>

145
00:07:22,110 --> 00:07:27,539
factory without<font color="#E5E5E5"> the operators finished</font>

146
00:07:23,759 --> 00:07:31,800
operators permission so we set out to

147
00:07:27,539 --> 00:07:34,919
<font color="#CCCCCC">start</font><font color="#E5E5E5"> doing that and what happened was</font><font color="#CCCCCC"> a</font>

148
00:07:31,800 --> 00:07:36,089
little<font color="#E5E5E5"> interesting and and</font><font color="#CCCCCC"> Jonathan is</font>

149
00:07:34,919 --> 00:07:39,419
<font color="#CCCCCC">going to talk a little</font><font color="#E5E5E5"> bit here about</font>

150
00:07:36,089 --> 00:07:44,449
<font color="#E5E5E5">our</font><font color="#CCCCCC"> methodology and the way we actually</font>

151
00:07:39,419 --> 00:07:44,448
tried to<font color="#E5E5E5"> achieve this so Jonathan</font>

152
00:07:48,580 --> 00:07:52,919
so as you guys might know if you've<font color="#E5E5E5"> ever</font>

153
00:07:51,250 --> 00:07:55,240
<font color="#E5E5E5">tried to do it for yourselves you</font><font color="#CCCCCC"> know</font>

154
00:07:52,920 --> 00:07:58,330
<font color="#E5E5E5">reversing</font><font color="#CCCCCC"> RF can</font><font color="#E5E5E5"> be challenging right</font>

155
00:07:55,240 --> 00:08:01,120
<font color="#E5E5E5">especially</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> know if you're talking</font>

156
00:07:58,330 --> 00:08:03,400
<font color="#E5E5E5">about different</font><font color="#CCCCCC"> devices and and kind of</font>

157
00:08:01,120 --> 00:08:05,170
a range of<font color="#E5E5E5"> targets and for us we had</font>

158
00:08:03,400 --> 00:08:07,510
chosen several vendors<font color="#E5E5E5"> and several</font>

159
00:08:05,170 --> 00:08:10,330
different devices<font color="#E5E5E5"> that we wanted</font><font color="#CCCCCC"> to kind</font>

160
00:08:07,510 --> 00:08:11,890
<font color="#E5E5E5">of attack</font><font color="#CCCCCC"> right so you know obviously</font>

161
00:08:10,330 --> 00:08:13,990
<font color="#CCCCCC">you can get</font><font color="#E5E5E5"> an SDR</font>

162
00:08:11,890 --> 00:08:16,090
<font color="#E5E5E5">you can record the signal but then what</font>

163
00:08:13,990 --> 00:08:18,880
do you do right<font color="#CCCCCC"> and typically you're</font>

164
00:08:16,090 --> 00:08:20,979
trying to first start<font color="#E5E5E5"> out by determining</font>

165
00:08:18,880 --> 00:08:22,600
<font color="#CCCCCC">the basic signal characteristics maybe</font>

166
00:08:20,980 --> 00:08:25,120
you want<font color="#E5E5E5"> to know the</font><font color="#CCCCCC"> frequency which is</font>

167
00:08:22,600 --> 00:08:27,580
used<font color="#E5E5E5"> maybe you want to know the</font>

168
00:08:25,120 --> 00:08:29,440
modulation or encoding or even something

169
00:08:27,580 --> 00:08:30,700
<font color="#E5E5E5">about the</font><font color="#CCCCCC"> higher-level protocols</font><font color="#E5E5E5"> that</font>

170
00:08:29,440 --> 00:08:34,539
<font color="#CCCCCC">are being used</font><font color="#E5E5E5"> in order</font><font color="#CCCCCC"> to determine</font>

171
00:08:30,700 --> 00:08:36,819
what security<font color="#E5E5E5"> risks there are and this</font>

172
00:08:34,539 --> 00:08:41,260
can be<font color="#E5E5E5"> difficult as mentioned especially</font>

173
00:08:36,820 --> 00:08:43,180
<font color="#CCCCCC">to be precise you know my SDR that I</font>

174
00:08:41,260 --> 00:08:45,580
purchased of course they manufacture it

175
00:08:43,179 --> 00:08:47,800
the best way<font color="#CCCCCC"> they can but it's</font><font color="#E5E5E5"> not</font>

176
00:08:45,580 --> 00:08:50,320
necessarily a piece of test<font color="#CCCCCC"> equipment</font>

177
00:08:47,800 --> 00:08:51,880
and crystals and frequencies and things

178
00:08:50,320 --> 00:08:55,510
can drift right and if you're trying<font color="#CCCCCC"> to</font>

179
00:08:51,880 --> 00:08:56,710
determine specifically<font color="#E5E5E5"> characteristics</font>

180
00:08:55,510 --> 00:09:00,100
<font color="#CCCCCC">about your signal</font><font color="#E5E5E5"> this can be</font>

181
00:08:56,710 --> 00:09:03,250
challenging<font color="#E5E5E5"> and again it can be tedious</font>

182
00:09:00,100 --> 00:09:06,100
<font color="#CCCCCC">to do if you have lots of</font><font color="#E5E5E5"> devices and</font>

183
00:09:03,250 --> 00:09:09,010
<font color="#E5E5E5">states that you want to examine and in</font>

184
00:09:06,100 --> 00:09:10,780
our case<font color="#E5E5E5"> we had a global team</font><font color="#CCCCCC"> so we had</font>

185
00:09:09,010 --> 00:09:13,120
a<font color="#E5E5E5"> certain</font><font color="#CCCCCC"> number of devices a certain</font>

186
00:09:10,780 --> 00:09:14,890
number<font color="#CCCCCC"> of</font><font color="#E5E5E5"> people so this is</font><font color="#CCCCCC"> also a you</font>

187
00:09:13,120 --> 00:09:19,330
know kind<font color="#CCCCCC"> of a logistical challenges and</font>

188
00:09:14,890 --> 00:09:21,610
in terms of reversing and again you

189
00:09:19,330 --> 00:09:25,150
might<font color="#E5E5E5"> end up</font><font color="#CCCCCC"> looking at waterfall plots</font>

190
00:09:21,610 --> 00:09:27,310
<font color="#E5E5E5">and graphs and if this is data that</font>

191
00:09:25,150 --> 00:09:29,530
<font color="#CCCCCC">you've never seen before you might be</font>

192
00:09:27,310 --> 00:09:33,750
wondering did I record<font color="#E5E5E5"> this properly</font><font color="#CCCCCC"> is</font>

193
00:09:29,530 --> 00:09:36,760
this noise<font color="#CCCCCC"> you have</font><font color="#E5E5E5"> no real kind of</font>

194
00:09:33,750 --> 00:09:40,240
standard to verify<font color="#E5E5E5"> your work against</font>

195
00:09:36,760 --> 00:09:41,650
because you've<font color="#E5E5E5"> never seen it before so</font>

196
00:09:40,240 --> 00:09:45,430
let's talk<font color="#CCCCCC"> about another way this can be</font>

197
00:09:41,650 --> 00:09:47,860
<font color="#E5E5E5">done you know you can start by examining</font>

198
00:09:45,430 --> 00:09:50,020
<font color="#E5E5E5">the embedded system that you're looking</font>

199
00:09:47,860 --> 00:09:51,250
at<font color="#E5E5E5"> kind of from a high level</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> you</font>

200
00:09:50,020 --> 00:09:54,069
might<font color="#E5E5E5"> be able</font><font color="#CCCCCC"> to determine that there's</font>

201
00:09:51,250 --> 00:09:55,480
a microcontroller<font color="#CCCCCC"> and a radio and some</font>

202
00:09:54,070 --> 00:09:57,660
basic components that kind<font color="#E5E5E5"> of work</font>

203
00:09:55,480 --> 00:09:57,660
together

204
00:09:58,130 --> 00:10:03,139
and in<font color="#E5E5E5"> these kinds of devices and in</font>

205
00:10:00,709 --> 00:10:05,839
fact in a<font color="#CCCCCC"> lot of sub gigahertz radio</font>

206
00:10:03,139 --> 00:10:08,959
devices<font color="#CCCCCC"> in fact potentially even</font><font color="#E5E5E5"> the</font>

207
00:10:05,839 --> 00:10:12,649
device I'm holding<font color="#CCCCCC"> there's a typical set</font>

208
00:10:08,959 --> 00:10:15,888
<font color="#CCCCCC">of radio ICS</font><font color="#E5E5E5"> that are used</font><font color="#CCCCCC"> there's not a</font>

209
00:10:12,649 --> 00:10:19,970
<font color="#E5E5E5">lot of them</font><font color="#CCCCCC"> and they typically are</font><font color="#E5E5E5"> all</font>

210
00:10:15,889 --> 00:10:22,430
controlled via spy<font color="#E5E5E5"> so what that implies</font>

211
00:10:19,970 --> 00:10:23,899
<font color="#CCCCCC">is</font><font color="#E5E5E5"> again if you look at your system</font>

212
00:10:22,430 --> 00:10:25,250
design you have<font color="#E5E5E5"> some firmware</font><font color="#CCCCCC"> and a</font>

213
00:10:23,899 --> 00:10:27,079
<font color="#E5E5E5">microcontroller and those are running</font>

214
00:10:25,250 --> 00:10:29,300
together and you have a radio sitting

215
00:10:27,079 --> 00:10:32,899
over here<font color="#E5E5E5"> and you can understand that</font>

216
00:10:29,300 --> 00:10:36,399
<font color="#E5E5E5">everything the radio does transits via</font>

217
00:10:32,899 --> 00:10:39,529
spy<font color="#E5E5E5"> so it's a great place</font><font color="#CCCCCC"> to instrument</font>

218
00:10:36,399 --> 00:10:42,740
and of course<font color="#E5E5E5"> in conjunction with the</font>

219
00:10:39,529 --> 00:10:44,779
<font color="#E5E5E5">datasheet of the radio I see you can</font>

220
00:10:42,740 --> 00:10:49,399
kind<font color="#CCCCCC"> of learn learn what all your</font>

221
00:10:44,779 --> 00:10:52,189
possible signal parameters might be and

222
00:10:49,399 --> 00:10:54,050
you can<font color="#E5E5E5"> also over spy look at some of</font>

223
00:10:52,190 --> 00:10:59,149
the more complex protocol interactions

224
00:10:54,050 --> 00:11:01,370
right so instead<font color="#CCCCCC"> of</font><font color="#E5E5E5"> recording RF let's</font>

225
00:10:59,149 --> 00:11:06,260
try to attach a logic<font color="#CCCCCC"> analyzer to spy</font>

226
00:11:01,370 --> 00:11:07,760
<font color="#E5E5E5">and log those signals and this is kind</font>

227
00:11:06,260 --> 00:11:09,310
of an<font color="#E5E5E5"> example of</font><font color="#CCCCCC"> what you might</font><font color="#E5E5E5"> see in a</font>

228
00:11:07,760 --> 00:11:11,870
datasheet<font color="#E5E5E5"> you can see several</font>

229
00:11:09,310 --> 00:11:13,638
configuration registers there and how

230
00:11:11,870 --> 00:11:15,319
they're mapped and the datasheet<font color="#E5E5E5"> will</font>

231
00:11:13,639 --> 00:11:17,690
give you<font color="#CCCCCC"> very specific</font><font color="#E5E5E5"> information about</font>

232
00:11:15,319 --> 00:11:23,510
<font color="#E5E5E5">what</font><font color="#CCCCCC"> the radio will do when</font><font color="#E5E5E5"> you</font>

233
00:11:17,690 --> 00:11:25,370
configure configure it so<font color="#CCCCCC"> we</font><font color="#E5E5E5"> attach the</font>

234
00:11:23,510 --> 00:11:28,010
logic analyzer<font color="#CCCCCC"> and then you end up with</font>

235
00:11:25,370 --> 00:11:29,870
<font color="#CCCCCC">a bunch</font><font color="#E5E5E5"> of waveforms which you know if</font>

236
00:11:28,010 --> 00:11:32,110
you want<font color="#E5E5E5"> to sit there and look at every</font>

237
00:11:29,870 --> 00:11:35,149
<font color="#E5E5E5">single wave and understand how spy works</font>

238
00:11:32,110 --> 00:11:38,630
<font color="#CCCCCC">you'll get there but it can be very</font><font color="#E5E5E5"> very</font>

239
00:11:35,149 --> 00:11:41,480
challenging<font color="#E5E5E5"> so we</font><font color="#CCCCCC"> we went</font><font color="#E5E5E5"> there and we</font>

240
00:11:38,630 --> 00:11:44,180
<font color="#E5E5E5">created a tool to log spy and kind of</font>

241
00:11:41,480 --> 00:11:47,899
convert it to basic<font color="#E5E5E5"> read and write spy</font>

242
00:11:44,180 --> 00:11:49,939
operations<font color="#E5E5E5"> but again with many different</font>

243
00:11:47,899 --> 00:11:52,130
<font color="#CCCCCC">radio</font><font color="#E5E5E5"> States and lots of spy commands</font>

244
00:11:49,939 --> 00:11:54,110
<font color="#E5E5E5">being sent and received this is a lot of</font>

245
00:11:52,130 --> 00:11:55,790
data<font color="#CCCCCC"> to look at especially if you you</font>

246
00:11:54,110 --> 00:11:58,040
know press a button or turn the device

247
00:11:55,790 --> 00:12:01,880
on<font color="#E5E5E5"> and you end up with thousands and</font>

248
00:11:58,040 --> 00:12:03,439
thousands of spy operations and<font color="#E5E5E5"> also you</font>

249
00:12:01,880 --> 00:12:05,480
might<font color="#CCCCCC"> want to examine many states like</font>

250
00:12:03,439 --> 00:12:07,699
what happens when<font color="#E5E5E5"> the device boots does</font>

251
00:12:05,480 --> 00:12:10,279
it authentic<font color="#E5E5E5"> eight is there some kind of</font>

252
00:12:07,699 --> 00:12:12,099
key exchange or what happens what is<font color="#E5E5E5"> the</font>

253
00:12:10,279 --> 00:12:14,480
device<font color="#CCCCCC"> do when it's idle</font>

254
00:12:12,100 --> 00:12:16,640
what happens when<font color="#CCCCCC"> I</font><font color="#E5E5E5"> press a button or</font>

255
00:12:14,480 --> 00:12:21,110
release a button you<font color="#CCCCCC"> can see how the</font>

256
00:12:16,640 --> 00:12:23,270
data<font color="#E5E5E5"> kind of can explode in this case so</font>

257
00:12:21,110 --> 00:12:25,130
here is kind<font color="#E5E5E5"> of an</font><font color="#CCCCCC"> example of a</font><font color="#E5E5E5"> few</font>

258
00:12:23,270 --> 00:12:27,920
different log formats that<font color="#E5E5E5"> we started</font>

259
00:12:25,130 --> 00:12:32,230
<font color="#E5E5E5">out with</font><font color="#CCCCCC"> you know</font><font color="#E5E5E5"> some have basic binary</font>

260
00:12:27,920 --> 00:12:35,000
decoding and then also some hex<font color="#E5E5E5"> here but</font>

261
00:12:32,230 --> 00:12:36,980
in the end you're<font color="#CCCCCC"> gonna be looking at</font>

262
00:12:35,000 --> 00:12:39,680
the<font color="#CCCCCC"> datasheet</font><font color="#E5E5E5"> looking at these logs and</font>

263
00:12:36,980 --> 00:12:43,040
kind of try to work through how<font color="#CCCCCC"> all this</font>

264
00:12:39,680 --> 00:12:47,000
works<font color="#CCCCCC"> and it's still not where we need</font>

265
00:12:43,040 --> 00:12:49,370
to<font color="#E5E5E5"> be to</font><font color="#CCCCCC"> be efficient</font><font color="#E5E5E5"> so let's go from</font>

266
00:12:47,000 --> 00:12:51,440
spy operations to datasheet registers

267
00:12:49,370 --> 00:12:53,990
right you know we can literally<font color="#E5E5E5"> look at</font>

268
00:12:51,440 --> 00:12:57,130
the datasheet<font color="#E5E5E5"> copy and paste all</font><font color="#CCCCCC"> the</font>

269
00:12:53,990 --> 00:12:59,690
register references<font color="#E5E5E5"> into Python right</font>

270
00:12:57,130 --> 00:13:03,170
and then we can start<font color="#E5E5E5"> work towards</font>

271
00:12:59,690 --> 00:13:05,630
making<font color="#E5E5E5"> a decoder right so at least now</font>

272
00:13:03,170 --> 00:13:07,790
<font color="#E5E5E5">we can see a particular</font><font color="#CCCCCC"> configuration</font>

273
00:13:05,630 --> 00:13:11,020
registers being accessed<font color="#E5E5E5"> which is a lot</font>

274
00:13:07,790 --> 00:13:13,550
<font color="#E5E5E5">better than looking at waveforms right</font>

275
00:13:11,020 --> 00:13:16,910
but again<font color="#CCCCCC"> we still might have hundreds</font>

276
00:13:13,550 --> 00:13:18,949
<font color="#E5E5E5">of register operations and so this is</font>

277
00:13:16,910 --> 00:13:21,620
what it looks<font color="#E5E5E5"> like at this layer you</font><font color="#CCCCCC"> can</font>

278
00:13:18,950 --> 00:13:24,230
<font color="#CCCCCC">see at the top</font><font color="#E5E5E5"> you know they're reading</font>

279
00:13:21,620 --> 00:13:26,510
the RSSI<font color="#E5E5E5"> state or the signal strength</font>

280
00:13:24,230 --> 00:13:27,980
<font color="#CCCCCC">they're</font><font color="#E5E5E5"> reading some</font><font color="#CCCCCC"> Radio State</font><font color="#E5E5E5"> waiting</font>

281
00:13:26,510 --> 00:13:30,890
it<font color="#E5E5E5"> for it to become idle and then</font>

282
00:13:27,980 --> 00:13:33,380
they're issuing a receive command<font color="#E5E5E5"> and</font>

283
00:13:30,890 --> 00:13:34,760
this<font color="#E5E5E5"> is you know kind of a</font><font color="#CCCCCC"> little</font><font color="#E5E5E5"> bit</font>

284
00:13:33,380 --> 00:13:36,290
<font color="#CCCCCC">more intuitive if you're familiar</font><font color="#E5E5E5"> with</font>

285
00:13:34,760 --> 00:13:42,050
the<font color="#E5E5E5"> datasheet than just looking at hex</font>

286
00:13:36,290 --> 00:13:44,480
or<font color="#CCCCCC"> binary right but</font><font color="#E5E5E5"> again if you</font><font color="#CCCCCC"> have</font>

287
00:13:42,050 --> 00:13:46,310
lots<font color="#CCCCCC"> of commands it's on you to</font><font color="#E5E5E5"> look at</font>

288
00:13:44,480 --> 00:13:48,410
<font color="#E5E5E5">the order of each command</font><font color="#CCCCCC"> kind of</font>

289
00:13:46,310 --> 00:13:51,170
understand<font color="#CCCCCC"> how the radio works</font><font color="#E5E5E5"> how a</font>

290
00:13:48,410 --> 00:13:54,530
radio this particular radio transmits

291
00:13:51,170 --> 00:13:58,219
and receives<font color="#E5E5E5"> but we can still do it</font>

292
00:13:54,530 --> 00:14:00,410
better<font color="#E5E5E5"> imagine if we persist the state</font>

293
00:13:58,220 --> 00:14:02,540
of the radio emulate the internal

294
00:14:00,410 --> 00:14:07,640
registers and just kind of keep<font color="#CCCCCC"> track</font><font color="#E5E5E5"> of</font>

295
00:14:02,540 --> 00:14:09,890
it<font color="#CCCCCC"> for you and you</font><font color="#E5E5E5"> might ask well how do</font>

296
00:14:07,640 --> 00:14:11,630
we<font color="#CCCCCC"> know</font><font color="#E5E5E5"> the initial values of these</font>

297
00:14:09,890 --> 00:14:13,730
particular registers and of course

298
00:14:11,630 --> 00:14:17,689
they're<font color="#E5E5E5"> documented in the datasheet</font><font color="#CCCCCC"> and</font>

299
00:14:13,730 --> 00:14:20,060
we further instrumented our tool to

300
00:14:17,690 --> 00:14:22,400
allow us to dump<font color="#CCCCCC"> the current state of</font>

301
00:14:20,060 --> 00:14:24,989
all the<font color="#E5E5E5"> emulated registers at any point</font>

302
00:14:22,400 --> 00:14:28,589
in<font color="#CCCCCC"> our logs</font>

303
00:14:24,990 --> 00:14:31,260
and clearly you might want to know what

304
00:14:28,589 --> 00:14:34,050
is the exact<font color="#CCCCCC"> configuration of the radio</font>

305
00:14:31,260 --> 00:14:36,330
at<font color="#CCCCCC"> the</font><font color="#E5E5E5"> transmit point or at the</font>

306
00:14:34,050 --> 00:14:38,670
reception point and this<font color="#E5E5E5"> is kind of ties</font>

307
00:14:36,330 --> 00:14:40,770
<font color="#CCCCCC">back to</font><font color="#E5E5E5"> the original</font><font color="#CCCCCC"> question</font><font color="#E5E5E5"> how</font><font color="#CCCCCC"> do</font><font color="#E5E5E5"> we</font>

308
00:14:38,670 --> 00:14:44,160
<font color="#E5E5E5">know the very specifics of the radio</font>

309
00:14:40,770 --> 00:14:46,680
signal<font color="#E5E5E5"> well if I have logs and I emulate</font>

310
00:14:44,160 --> 00:14:48,180
the state and I stop<font color="#CCCCCC"> I can then go and</font>

311
00:14:46,680 --> 00:14:51,620
<font color="#CCCCCC">examine the state and answer any</font>

312
00:14:48,180 --> 00:14:51,620
question I want to<font color="#E5E5E5"> know about the radio</font>

313
00:14:52,220 --> 00:14:57,390
and so this is kind of what our emulated

314
00:14:55,110 --> 00:15:00,420
radio looks like right<font color="#CCCCCC"> you can see</font><font color="#E5E5E5"> that</font>

315
00:14:57,390 --> 00:15:03,330
certain<font color="#E5E5E5"> registers were read and read</font><font color="#CCCCCC"> and</font>

316
00:15:00,420 --> 00:15:07,229
written<font color="#E5E5E5"> to their current values as well</font>

317
00:15:03,330 --> 00:15:09,750
<font color="#E5E5E5">as the number</font><font color="#CCCCCC"> of times they were</font>

318
00:15:07,230 --> 00:15:14,010
registers were accessed<font color="#E5E5E5"> and even here</font>

319
00:15:09,750 --> 00:15:16,620
<font color="#CCCCCC">whether</font><font color="#E5E5E5"> defaults were used meaning did</font>

320
00:15:14,010 --> 00:15:18,420
the software<font color="#CCCCCC"> rely on the default</font><font color="#E5E5E5"> from</font>

321
00:15:16,620 --> 00:15:20,940
the<font color="#CCCCCC"> datasheet or did the software</font>

322
00:15:18,420 --> 00:15:23,490
program the value of the<font color="#CCCCCC"> register and</font>

323
00:15:20,940 --> 00:15:27,420
default values of registers can change

324
00:15:23,490 --> 00:15:28,920
between part versions and generations of

325
00:15:27,420 --> 00:15:32,430
parts<font color="#E5E5E5"> so it's an important</font><font color="#CCCCCC"> thing to know</font>

326
00:15:28,920 --> 00:15:36,500
and then the bottom<font color="#CCCCCC"> section we can see</font>

327
00:15:32,430 --> 00:15:36,500
various commands that<font color="#E5E5E5"> were</font><font color="#CCCCCC"> also executed</font>

328
00:15:37,520 --> 00:15:43,800
so that gives us<font color="#E5E5E5"> kind of an initial view</font>

329
00:15:40,860 --> 00:15:46,589
of or an instantaneous view of the radio

330
00:15:43,800 --> 00:15:46,890
right<font color="#E5E5E5"> but it's more complicated</font><font color="#CCCCCC"> than</font>

331
00:15:46,589 --> 00:15:48,779
<font color="#CCCCCC">that</font>

332
00:15:46,890 --> 00:15:51,060
<font color="#CCCCCC">right because</font><font color="#E5E5E5"> the radio might have back</font>

333
00:15:48,779 --> 00:15:52,500
and forth communications<font color="#E5E5E5"> so you might</font>

334
00:15:51,060 --> 00:15:54,569
want to be able to<font color="#E5E5E5"> answer</font><font color="#CCCCCC"> questions</font>

335
00:15:52,500 --> 00:15:58,860
about what's happening at the<font color="#CCCCCC"> protocol</font>

336
00:15:54,570 --> 00:16:01,170
<font color="#E5E5E5">layer so</font><font color="#CCCCCC"> we also</font><font color="#E5E5E5"> created some</font><font color="#CCCCCC"> new radio</font>

337
00:15:58,860 --> 00:16:04,649
flow graphs<font color="#E5E5E5"> which would transmit and</font>

338
00:16:01,170 --> 00:16:07,920
receive packets and then<font color="#E5E5E5"> we attached it</font>

339
00:16:04,649 --> 00:16:11,420
<font color="#E5E5E5">to our emulator via</font><font color="#CCCCCC"> zero message</font><font color="#E5E5E5"> queue</font>

340
00:16:07,920 --> 00:16:16,130
and some new radio polymorphic types

341
00:16:11,420 --> 00:16:16,130
just a message passing kind of interface

342
00:16:16,339 --> 00:16:24,660
so<font color="#E5E5E5"> ultimately this allows</font><font color="#CCCCCC"> us to record</font>

343
00:16:20,100 --> 00:16:27,060
<font color="#E5E5E5">spy traffic replay it</font><font color="#CCCCCC"> all the way</font><font color="#E5E5E5"> from</font>

344
00:16:24,660 --> 00:16:29,730
the logic analyzer level out to RF

345
00:16:27,060 --> 00:16:32,489
<font color="#CCCCCC">over-the-air and once we have this</font>

346
00:16:29,730 --> 00:16:34,709
complete<font color="#E5E5E5"> framework now we can easily</font>

347
00:16:32,490 --> 00:16:37,709
<font color="#E5E5E5">compare between</font><font color="#CCCCCC"> the actual physical</font>

348
00:16:34,709 --> 00:16:38,729
device<font color="#CCCCCC"> and what our emulation says so we</font>

349
00:16:37,709 --> 00:16:40,319
<font color="#E5E5E5">can determine if</font>

350
00:16:38,730 --> 00:16:45,899
we're kind of<font color="#E5E5E5"> on the</font><font color="#CCCCCC"> right track in a</font>

351
00:16:40,320 --> 00:16:47,850
reversing process and these are on the

352
00:16:45,899 --> 00:16:50,250
top<font color="#E5E5E5"> the</font><font color="#CCCCCC"> transmitted section of our</font>

353
00:16:47,850 --> 00:16:52,260
<font color="#E5E5E5">Guinea radio flow graph and on the</font>

354
00:16:50,250 --> 00:16:54,149
bottom<font color="#E5E5E5"> of the receive side and you can</font>

355
00:16:52,260 --> 00:16:56,310
<font color="#E5E5E5">see we have the zero message</font><font color="#CCCCCC"> queue</font>

356
00:16:54,149 --> 00:17:02,250
blocks going<font color="#E5E5E5"> into our custom Guinea</font>

357
00:16:56,310 --> 00:17:05,369
radio protocol parsing and this is just

358
00:17:02,250 --> 00:17:07,470
<font color="#E5E5E5">kind of an example</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the message</font>

359
00:17:05,369 --> 00:17:09,479
passing interface<font color="#E5E5E5"> you can see that we're</font>

360
00:17:07,470 --> 00:17:12,299
<font color="#E5E5E5">just creating a</font><font color="#CCCCCC"> goonie radio polymorphic</font>

361
00:17:09,480 --> 00:17:14,720
type<font color="#E5E5E5"> as well as you know setting some</font>

362
00:17:12,299 --> 00:17:18,980
dictionary values which determine<font color="#CCCCCC"> the</font>

363
00:17:14,720 --> 00:17:18,980
exact packet that we want<font color="#E5E5E5"> to transmit</font>

364
00:17:20,150 --> 00:17:24,360
but as you learn how<font color="#CCCCCC"> the</font><font color="#E5E5E5"> protocol works</font>

365
00:17:22,919 --> 00:17:29,370
<font color="#CCCCCC">you've got also find the vulnerabilities</font>

366
00:17:24,359 --> 00:17:31,799
<font color="#E5E5E5">and luckily with this emulator setup you</font>

367
00:17:29,370 --> 00:17:34,439
<font color="#E5E5E5">can instrument or provide debugging</font>

368
00:17:31,799 --> 00:17:41,010
information<font color="#CCCCCC"> at almost any layer</font><font color="#E5E5E5"> in the</font>

369
00:17:34,440 --> 00:17:44,250
radio<font color="#CCCCCC"> and you can</font><font color="#E5E5E5"> replay logic analyzer</font>

370
00:17:41,010 --> 00:17:45,929
captures and use your emulated system to

371
00:17:44,250 --> 00:17:50,010
interact<font color="#CCCCCC"> with an actual</font><font color="#E5E5E5"> physical device</font>

372
00:17:45,929 --> 00:17:52,350
<font color="#E5E5E5">which is a huge benefit and</font><font color="#CCCCCC"> in my case</font>

373
00:17:50,010 --> 00:17:54,870
<font color="#E5E5E5">up</font><font color="#CCCCCC"> until today</font><font color="#E5E5E5"> I</font><font color="#CCCCCC"> never touched these</font>

374
00:17:52,350 --> 00:17:57,360
physical devices<font color="#E5E5E5"> right I had some RF</font>

375
00:17:54,870 --> 00:18:00,239
captures I had some spy logs<font color="#E5E5E5"> and</font><font color="#CCCCCC"> I was</font>

376
00:17:57,360 --> 00:18:03,139
able<font color="#E5E5E5"> to generate this radio kind of</font>

377
00:18:00,240 --> 00:18:05,010
system by you know kind of piecewise

378
00:18:03,140 --> 00:18:10,080
implementing it and<font color="#E5E5E5"> then allowing my</font>

379
00:18:05,010 --> 00:18:12,360
colleagues to do some simple tests and

380
00:18:10,080 --> 00:18:14,428
this<font color="#E5E5E5"> is example of how the emulator</font>

381
00:18:12,360 --> 00:18:16,799
works<font color="#CCCCCC"> you just kind of instantiate it</font>

382
00:18:14,429 --> 00:18:19,260
<font color="#E5E5E5">tell it to reset all its state to</font>

383
00:18:16,799 --> 00:18:21,179
default and<font color="#E5E5E5"> then play some logs through</font>

384
00:18:19,260 --> 00:18:22,679
it and then<font color="#E5E5E5"> you can configure whether it</font>

385
00:18:21,179 --> 00:18:25,460
will<font color="#E5E5E5"> break on transmitter and any</font>

386
00:18:22,679 --> 00:18:25,460
particular<font color="#E5E5E5"> point</font>

387
00:18:27,440 --> 00:18:31,909
and you know<font color="#E5E5E5"> through this process</font><font color="#CCCCCC"> at as</font>

388
00:18:30,649 --> 00:18:34,489
<font color="#E5E5E5">Steven mentioned we found several</font>

389
00:18:31,909 --> 00:18:36,649
different kinds of attacks<font color="#E5E5E5"> and in this</font>

390
00:18:34,490 --> 00:18:38,990
case<font color="#E5E5E5"> the vendors</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> we tested for</font>

391
00:18:36,649 --> 00:18:41,689
replay unfortunately all of<font color="#CCCCCC"> them are</font>

392
00:18:38,990 --> 00:18:45,500
susceptible<font color="#E5E5E5"> we found a command injection</font>

393
00:18:41,690 --> 00:18:47,090
<font color="#CCCCCC">and East</font><font color="#E5E5E5"> op abuse and if you don't know</font>

394
00:18:45,500 --> 00:18:49,549
what<font color="#CCCCCC"> East op is of course it's kind of</font>

395
00:18:47,090 --> 00:18:52,490
the emergency<font color="#E5E5E5"> stop button the big red</font>

396
00:18:49,549 --> 00:18:54,799
<font color="#CCCCCC">button</font><font color="#E5E5E5"> and here you can have</font><font color="#CCCCCC"> denial of</font>

397
00:18:52,490 --> 00:18:57,980
service by you know repeatedly sending<font color="#E5E5E5"> a</font>

398
00:18:54,799 --> 00:19:00,110
stop and<font color="#CCCCCC"> of course command injection you</font>

399
00:18:57,980 --> 00:19:02,570
can forge your<font color="#E5E5E5"> own commands and replay</font>

400
00:19:00,110 --> 00:19:05,289
you can cause chaos just<font color="#E5E5E5"> by replaying</font>

401
00:19:02,570 --> 00:19:09,049
the activities that<font color="#E5E5E5"> they're engaging in</font>

402
00:19:05,289 --> 00:19:10,669
and then malicious repairing may not be

403
00:19:09,049 --> 00:19:13,220
<font color="#E5E5E5">obvious but you know there's a way</font><font color="#CCCCCC"> to</font>

404
00:19:10,669 --> 00:19:15,139
associate<font color="#E5E5E5"> a device transmitter to a</font>

405
00:19:13,220 --> 00:19:18,080
receiver<font color="#E5E5E5"> so</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> can</font><font color="#CCCCCC"> actually interfere</font>

406
00:19:15,139 --> 00:19:21,139
<font color="#E5E5E5">with that and cause a repairing</font><font color="#CCCCCC"> to occur</font>

407
00:19:18,080 --> 00:19:22,970
<font color="#E5E5E5">where it repairs to the receiver repairs</font>

408
00:19:21,139 --> 00:19:25,459
to an unknown transmitter or to your

409
00:19:22,970 --> 00:19:32,090
transmitter<font color="#E5E5E5"> also</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> cause denial of</font>

410
00:19:25,460 --> 00:19:34,549
service so that's<font color="#E5E5E5"> good well what we</font>

411
00:19:32,090 --> 00:19:36,408
discussed there was so we<font color="#E5E5E5"> had physical</font>

412
00:19:34,549 --> 00:19:39,200
<font color="#CCCCCC">access so I wanted</font><font color="#E5E5E5"> to test</font><font color="#CCCCCC"> something</font>

413
00:19:36,409 --> 00:19:43,519
here which was without physical access

414
00:19:39,200 --> 00:19:46,009
<font color="#E5E5E5">could we obtain some information so</font><font color="#CCCCCC"> that</font>

415
00:19:43,519 --> 00:19:48,889
we could remotely attack a company<font color="#CCCCCC"> so</font>

416
00:19:46,009 --> 00:19:53,090
things are blurred here<font color="#CCCCCC"> to</font><font color="#E5E5E5"> protect the</font>

417
00:19:48,889 --> 00:19:56,870
<font color="#E5E5E5">innocent here</font><font color="#CCCCCC"> but this is a training</font>

418
00:19:53,090 --> 00:20:00,500
<font color="#CCCCCC">video I found online from a steel</font>

419
00:19:56,870 --> 00:20:02,928
manufacturer<font color="#E5E5E5"> that's in my area</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> this</font>

420
00:20:00,500 --> 00:20:06,409
training video<font color="#E5E5E5"> was on YouTube as you can</font>

421
00:20:02,929 --> 00:20:09,679
tell and what happened here was there it

422
00:20:06,409 --> 00:20:11,840
was the<font color="#E5E5E5"> training video for safety for</font>

423
00:20:09,679 --> 00:20:15,799
the crane operators<font color="#CCCCCC"> to how to safely</font>

424
00:20:11,840 --> 00:20:17,299
move material around<font color="#CCCCCC"> but what I saw</font><font color="#E5E5E5"> when</font>

425
00:20:15,799 --> 00:20:19,700
I<font color="#E5E5E5"> was</font><font color="#CCCCCC"> watching the video was a very</font>

426
00:20:17,299 --> 00:20:22,610
interesting<font color="#CCCCCC"> screenshot as I grabbed here</font>

427
00:20:19,700 --> 00:20:24,950
which we've blurred it but that's<font color="#E5E5E5"> the</font>

428
00:20:22,610 --> 00:20:27,459
manufacturer strap so it actually has

429
00:20:24,950 --> 00:20:30,289
the crane<font color="#E5E5E5"> manufacturer's name on it and</font>

430
00:20:27,460 --> 00:20:32,210
so based off of that<font color="#CCCCCC"> I've read the</font>

431
00:20:30,289 --> 00:20:36,169
documents<font color="#CCCCCC"> on it and they use dip</font>

432
00:20:32,210 --> 00:20:39,350
switches to determine which frequency

433
00:20:36,169 --> 00:20:43,130
that<font color="#E5E5E5"> they'll be communicating at</font>

434
00:20:39,350 --> 00:20:45,500
so I knew where this place was<font color="#E5E5E5"> so I sat</font>

435
00:20:43,130 --> 00:20:48,710
outside of it in a<font color="#CCCCCC"> public park with some</font>

436
00:20:45,500 --> 00:20:52,760
SDR equipment<font color="#E5E5E5"> and what I was able</font><font color="#CCCCCC"> to</font>

437
00:20:48,710 --> 00:20:54,950
find was the crane<font color="#CCCCCC"> and if you look at</font>

438
00:20:52,760 --> 00:20:55,610
that<font color="#CCCCCC"> I think that's</font><font color="#E5E5E5"> like channel 32 or</font>

439
00:20:54,950 --> 00:20:58,430
<font color="#CCCCCC">something like that</font>

440
00:20:55,610 --> 00:20:59,899
it was<font color="#E5E5E5"> around there</font><font color="#CCCCCC"> so as I started</font>

441
00:20:58,430 --> 00:21:02,090
<font color="#E5E5E5">moving through</font><font color="#CCCCCC"> I found the</font>

442
00:20:59,900 --> 00:21:06,350
communications<font color="#CCCCCC"> we were able</font><font color="#E5E5E5"> to record it</font>

443
00:21:02,090 --> 00:21:08,780
and I never replayed it<font color="#E5E5E5"> because</font><font color="#CCCCCC"> they're</font>

444
00:21:06,350 --> 00:21:11,780
an unwilling participant<font color="#CCCCCC"> but we did in</font>

445
00:21:08,780 --> 00:21:13,910
some of the cases overseas<font color="#CCCCCC"> with</font>

446
00:21:11,780 --> 00:21:18,320
<font color="#CCCCCC">permission were</font><font color="#E5E5E5"> able</font><font color="#CCCCCC"> to control real</font>

447
00:21:13,910 --> 00:21:21,500
cranes not just toy cranes<font color="#CCCCCC"> with</font>

448
00:21:18,320 --> 00:21:27,740
<font color="#E5E5E5">permission of the owners</font><font color="#CCCCCC"> so we were able</font>

449
00:21:21,500 --> 00:21:29,240
to do replay this attack and many many

450
00:21:27,740 --> 00:21:30,980
times<font color="#E5E5E5"> over and over</font><font color="#CCCCCC"> where we</font><font color="#E5E5E5"> were able</font>

451
00:21:29,240 --> 00:21:33,230
<font color="#CCCCCC">to after all</font><font color="#E5E5E5"> the hard work that Jonathan</font>

452
00:21:30,980 --> 00:21:35,000
had done and I<font color="#E5E5E5"> would also like to point</font>

453
00:21:33,230 --> 00:21:36,950
<font color="#E5E5E5">out I never had one</font><font color="#CCCCCC"> of these cranes</font>

454
00:21:35,000 --> 00:21:39,820
either<font color="#E5E5E5"> or one of the controllers we had</font>

455
00:21:36,950 --> 00:21:42,800
them overseas<font color="#CCCCCC"> because</font><font color="#E5E5E5"> this project had</font>

456
00:21:39,820 --> 00:21:45,169
seven<font color="#E5E5E5"> people on it and so they were</font>

457
00:21:42,800 --> 00:21:46,730
overseas so<font color="#E5E5E5"> we had to come up</font><font color="#CCCCCC"> with a way</font>

458
00:21:45,170 --> 00:21:49,130
to start<font color="#CCCCCC"> doing things very distributed</font>

459
00:21:46,730 --> 00:21:52,580
<font color="#CCCCCC">and it worked out</font><font color="#E5E5E5"> really well as you can</font>

460
00:21:49,130 --> 00:21:55,670
<font color="#CCCCCC">tell Jonathan was able to emulate a</font>

461
00:21:52,580 --> 00:22:00,080
whole system<font color="#E5E5E5"> to</font><font color="#CCCCCC"> where</font><font color="#E5E5E5"> we could</font>

462
00:21:55,670 --> 00:22:01,340
<font color="#CCCCCC">communicate with</font><font color="#E5E5E5"> the cranes so right now</font>

463
00:22:00,080 --> 00:22:03,350
what<font color="#E5E5E5"> we're</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> do is we're</font><font color="#CCCCCC"> gonna run a</font>

464
00:22:01,340 --> 00:22:11,990
<font color="#CCCCCC">really</font><font color="#E5E5E5"> quick demo as you can tell my</font>

465
00:22:03,350 --> 00:22:15,860
<font color="#E5E5E5">transmitter is here and from everything</font>

466
00:22:11,990 --> 00:22:18,500
<font color="#CCCCCC">that he learned we're going to move the</font>

467
00:22:15,860 --> 00:22:23,810
crane<font color="#E5E5E5"> with no one touching the</font>

468
00:22:18,500 --> 00:22:27,110
transmitter so here I kind<font color="#E5E5E5"> of have a</font>

469
00:22:23,810 --> 00:22:30,080
blade RF and really to demonstrate<font color="#CCCCCC"> the</font>

470
00:22:27,110 --> 00:22:32,149
<font color="#CCCCCC">ease of</font><font color="#E5E5E5"> this attack</font><font color="#CCCCCC"> all we did</font><font color="#E5E5E5"> was hold</font>

471
00:22:30,080 --> 00:22:33,919
down the official transmitter button

472
00:22:32,150 --> 00:22:35,720
record and now we're just<font color="#CCCCCC"> going to</font>

473
00:22:33,920 --> 00:22:39,320
<font color="#E5E5E5">replay a set of those commands which we</font>

474
00:22:35,720 --> 00:22:44,480
<font color="#CCCCCC">pre-recorded yeah there were some</font>

475
00:22:39,320 --> 00:22:47,030
vendors we tested<font color="#E5E5E5"> up</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> 14 vendors</font><font color="#CCCCCC"> Trend</font>

476
00:22:44,480 --> 00:22:49,880
Micro owns<font color="#CCCCCC"> zdi so everything</font><font color="#E5E5E5"> was</font>

477
00:22:47,030 --> 00:22:51,639
reported and has been fixed<font color="#E5E5E5"> where it can</font>

478
00:22:49,880 --> 00:22:54,650
be fixed

479
00:22:51,640 --> 00:22:57,679
and not all vendors were<font color="#CCCCCC"> susceptible to</font>

480
00:22:54,650 --> 00:23:02,510
replay attack<font color="#E5E5E5"> but it is a particularly</font>

481
00:22:57,679 --> 00:23:03,830
kind<font color="#E5E5E5"> of weak vulnerability</font><font color="#CCCCCC"> as</font><font color="#E5E5E5"> some of</font>

482
00:23:02,510 --> 00:23:06,440
them we had<font color="#CCCCCC"> to do a little extra work</font>

483
00:23:03,830 --> 00:23:08,629
and decode some messages and stuff like

484
00:23:06,440 --> 00:23:10,670
that<font color="#CCCCCC"> so this one was one of the easier</font>

485
00:23:08,630 --> 00:23:12,920
<font color="#E5E5E5">ones so that's why it's the demo just</font><font color="#CCCCCC"> so</font>

486
00:23:10,670 --> 00:23:17,809
we didn't have<font color="#CCCCCC"> to</font><font color="#E5E5E5"> sacrifice anything to</font>

487
00:23:12,920 --> 00:23:20,540
the demo gods and so as you could see<font color="#E5E5E5"> we</font>

488
00:23:17,809 --> 00:23:24,710
waved left or<font color="#CCCCCC"> east and</font><font color="#E5E5E5"> west and then up</font>

489
00:23:20,540 --> 00:23:30,950
<font color="#E5E5E5">and</font><font color="#CCCCCC"> down with with</font><font color="#E5E5E5"> this crane so if we</font>

490
00:23:24,710 --> 00:23:33,230
go back<font color="#CCCCCC"> to the slides real quick I was</font><font color="#E5E5E5"> I</font>

491
00:23:30,950 --> 00:23:35,270
live in Tennessee and<font color="#E5E5E5"> Travis</font><font color="#CCCCCC"> Goodspeed</font>

492
00:23:33,230 --> 00:23:37,190
lives in Tennessee<font color="#CCCCCC"> and he's you</font><font color="#E5E5E5"> know I</font>

493
00:23:35,270 --> 00:23:39,110
know him pretty well<font color="#E5E5E5"> and</font><font color="#CCCCCC"> so I watched a</font>

494
00:23:37,190 --> 00:23:41,750
<font color="#E5E5E5">presentation last year at</font><font color="#CCCCCC"> b-sides Knox</font>

495
00:23:39,110 --> 00:23:46,250
Hill that<font color="#CCCCCC"> I was a replay of what</font><font color="#E5E5E5"> he gave</font>

496
00:23:41,750 --> 00:23:47,630
it from<font color="#CCCCCC"> Kahn last January and</font><font color="#E5E5E5"> so there's</font>

497
00:23:46,250 --> 00:23:50,330
this thing<font color="#CCCCCC"> called the</font><font color="#E5E5E5"> good watch that he</font>

498
00:23:47,630 --> 00:23:52,700
made it made it<font color="#CCCCCC"> to be a wearable</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> he</font>

499
00:23:50,330 --> 00:23:56,720
liked that he would use and I was

500
00:23:52,700 --> 00:23:58,309
thinking<font color="#CCCCCC"> to myself but I could get I</font>

501
00:23:56,720 --> 00:24:04,179
wonder if I could<font color="#E5E5E5"> control a crane with</font>

502
00:23:58,309 --> 00:24:04,178
this watch and so I actually built one

503
00:24:10,070 --> 00:24:19,919
and yeah I can<font color="#E5E5E5"> so from a watch so what</font>

504
00:24:17,880 --> 00:24:25,230
we've<font color="#E5E5E5"> done is</font><font color="#CCCCCC"> we've miniaturized from</font>

505
00:24:19,920 --> 00:24:28,890
taking a blade<font color="#E5E5E5"> RF to a watch which is</font>

506
00:24:25,230 --> 00:24:30,660
<font color="#E5E5E5">good</font><font color="#CCCCCC"> battery life is horrible</font><font color="#E5E5E5"> if I do</font>

507
00:24:28,890 --> 00:24:33,060
this<font color="#E5E5E5"> for</font><font color="#CCCCCC"> five minutes</font><font color="#E5E5E5"> the batteries the</font>

508
00:24:30,660 --> 00:24:36,330
battery is dead<font color="#CCCCCC"> because it</font><font color="#E5E5E5"> takes a lot</font>

509
00:24:33,060 --> 00:24:39,240
of power it's a 3 volt<font color="#E5E5E5"> battery but I can</font>

510
00:24:36,330 --> 00:24:43,649
transmit<font color="#E5E5E5"> in proximity a pretty good</font>

511
00:24:39,240 --> 00:24:45,870
proximity with a watch<font color="#E5E5E5"> but that's still</font>

512
00:24:43,650 --> 00:24:47,820
a local attack<font color="#E5E5E5"> so what we also wanted to</font>

513
00:24:45,870 --> 00:24:53,010
do was could we<font color="#E5E5E5"> do this while we're</font>

514
00:24:47,820 --> 00:24:56,040
further<font color="#CCCCCC"> away and so what we were able to</font>

515
00:24:53,010 --> 00:24:59,550
do was one of my co-workers<font color="#E5E5E5"> on this</font>

516
00:24:56,040 --> 00:25:01,560
project Federico miniaturized some

517
00:24:59,550 --> 00:25:04,320
<font color="#CCCCCC">hardware bought some custom</font><font color="#E5E5E5"> chipsets and</font>

518
00:25:01,560 --> 00:25:06,450
what this is<font color="#E5E5E5"> it's a remote attacker over</font>

519
00:25:04,320 --> 00:25:11,129
a 4G LTE with a<font color="#E5E5E5"> planted device with a</font>

520
00:25:06,450 --> 00:25:12,990
battery<font color="#CCCCCC"> it</font><font color="#E5E5E5"> communicates to this on on</font>

521
00:25:11,130 --> 00:25:15,870
the command that<font color="#E5E5E5"> has a command-line</font>

522
00:25:12,990 --> 00:25:22,680
<font color="#E5E5E5">interface and remotely we can do the</font>

523
00:25:15,870 --> 00:25:27,199
exact same thing<font color="#E5E5E5"> over</font><font color="#CCCCCC"> all the equipment</font>

524
00:25:22,680 --> 00:25:31,830
that<font color="#E5E5E5"> we used so we have a blade</font><font color="#CCCCCC"> ahrefs</font>

525
00:25:27,200 --> 00:25:35,250
<font color="#E5E5E5">roughly $480 I'm a hack RF</font><font color="#CCCCCC"> one and</font>

526
00:25:31,830 --> 00:25:38,490
<font color="#CCCCCC">there's</font><font color="#E5E5E5"> $300 and we use one of those as</font>

527
00:25:35,250 --> 00:25:40,710
well<font color="#CCCCCC"> the yardstick</font><font color="#E5E5E5"> one we use that</font><font color="#CCCCCC"> for a</font>

528
00:25:38,490 --> 00:25:42,900
little<font color="#CCCCCC"> bit</font><font color="#E5E5E5"> has limitations on some of</font>

529
00:25:40,710 --> 00:25:47,510
the radios<font color="#CCCCCC"> that we were using</font><font color="#E5E5E5"> there was</font>

530
00:25:42,900 --> 00:25:52,380
more for<font color="#E5E5E5"> FSK so we</font><font color="#CCCCCC"> actually had</font><font color="#E5E5E5"> to patch</font>

531
00:25:47,510 --> 00:25:55,500
<font color="#CCCCCC">RF cat</font><font color="#E5E5E5"> to do a little bit better</font><font color="#CCCCCC"> still</font>

532
00:25:52,380 --> 00:25:57,960
didn't work<font color="#E5E5E5"> out use the</font><font color="#CCCCCC"> Panda</font><font color="#E5E5E5"> pan wah RF</font>

533
00:25:55,500 --> 00:26:00,390
a little it's a remote a little bit it's

534
00:25:57,960 --> 00:26:04,230
the<font color="#CCCCCC"> same it's</font><font color="#E5E5E5"> using RF cats and chipset</font>

535
00:26:00,390 --> 00:26:07,950
<font color="#E5E5E5">it's from a guy in</font><font color="#CCCCCC"> France</font><font color="#E5E5E5"> and then our</font>

536
00:26:04,230 --> 00:26:10,260
special<font color="#E5E5E5"> custom we spent</font><font color="#CCCCCC"> 40 dollars to</font>

537
00:26:07,950 --> 00:26:12,180
build it this watch is<font color="#E5E5E5"> roughly around</font>

538
00:26:10,260 --> 00:26:14,700
<font color="#E5E5E5">$100 you have to buy the watch off</font>

539
00:26:12,180 --> 00:26:17,460
<font color="#CCCCCC">Amazon because</font><font color="#E5E5E5"> Casio doesn't really make</font>

540
00:26:14,700 --> 00:26:20,340
them and<font color="#CCCCCC"> then the parts</font><font color="#E5E5E5"> hardware time</font>

541
00:26:17,460 --> 00:26:22,580
<font color="#E5E5E5">but we can miniaturize it down to to a</font>

542
00:26:20,340 --> 00:26:22,580
watch

543
00:26:23,070 --> 00:26:33,340
so that's where we're at<font color="#CCCCCC"> we had</font><font color="#E5E5E5"> 14</font>

544
00:26:28,750 --> 00:26:36,790
vendors tested<font color="#E5E5E5"> released their</font><font color="#CCCCCC"> CV ease on</font>

545
00:26:33,340 --> 00:26:39,730
many of them lots of patches<font color="#CCCCCC"> so if you</font>

546
00:26:36,790 --> 00:26:41,740
have a crane operator<font color="#E5E5E5"> or if you own or</font>

547
00:26:39,730 --> 00:26:44,460
if you are a crane operator and have

548
00:26:41,740 --> 00:26:48,610
<font color="#E5E5E5">these devices</font><font color="#CCCCCC"> talk to your vendors and</font>

549
00:26:44,460 --> 00:26:50,140
<font color="#E5E5E5">get them patched if they are ask them if</font>

550
00:26:48,610 --> 00:26:51,580
they're susceptible to this if it's one

551
00:26:50,140 --> 00:26:54,790
of the<font color="#E5E5E5"> vendors we may not have tested</font>

552
00:26:51,580 --> 00:26:58,449
which will be<font color="#E5E5E5"> available it's already</font>

553
00:26:54,790 --> 00:27:01,030
<font color="#CCCCCC">available in our paper came out today on</font>

554
00:26:58,450 --> 00:27:02,650
my last<font color="#CCCCCC"> slide here we have links to</font><font color="#E5E5E5"> it</font>

555
00:27:01,030 --> 00:27:05,830
you can<font color="#E5E5E5"> get to the blog to</font><font color="#CCCCCC"> the paper</font>

556
00:27:02,650 --> 00:27:11,190
<font color="#E5E5E5">from there the researchers on this</font>

557
00:27:05,830 --> 00:27:13,870
project<font color="#E5E5E5"> were Akira urano</font>

558
00:27:11,190 --> 00:27:17,730
<font color="#CCCCCC">Jonathan</font><font color="#E5E5E5"> Marco</font>

559
00:27:13,870 --> 00:27:20,500
<font color="#E5E5E5">old Uzi Steven hilts myself</font><font color="#CCCCCC"> Phillip Lin</font>

560
00:27:17,730 --> 00:27:24,010
Federico Maggie and<font color="#E5E5E5"> rain Reiner</font><font color="#CCCCCC"> by</font>

561
00:27:20,500 --> 00:27:25,720
<font color="#CCCCCC">Hustler that's who did all this and you</font>

562
00:27:24,010 --> 00:27:27,940
can tell by<font color="#E5E5E5"> the names were globally</font>

563
00:27:25,720 --> 00:27:31,090
dispersed<font color="#E5E5E5"> so that's why we had</font><font color="#CCCCCC"> to kind</font>

564
00:27:27,940 --> 00:27:34,570
<font color="#E5E5E5">of figure</font><font color="#CCCCCC"> out ways to remotely get to</font>

565
00:27:31,090 --> 00:27:38,189
the hardware so at this<font color="#E5E5E5"> point in time if</font>

566
00:27:34,570 --> 00:27:42,570
you have<font color="#E5E5E5"> any questions feel free to ask</font>

567
00:27:38,190 --> 00:27:42,570
<font color="#CCCCCC">okay thank you</font>

568
00:27:44,050 --> 00:27:48,760
my name is<font color="#CCCCCC"> Jacob Kitchel</font><font color="#E5E5E5"> accenture</font>

569
00:27:45,970 --> 00:27:53,860
security this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> a QA portion does</font>

570
00:27:48,760 --> 00:27:56,770
anybody have any<font color="#E5E5E5"> questions if you could</font>

571
00:27:53,860 --> 00:28:00,189
<font color="#E5E5E5">just</font><font color="#CCCCCC"> introduce yourself yeah sure Marty</font>

572
00:27:56,770 --> 00:28:01,600
Edwards<font color="#CCCCCC"> so beyond the basic replay</font>

573
00:28:00,190 --> 00:28:03,670
attacks did you see any<font color="#E5E5E5"> of the vendors</font>

574
00:28:01,600 --> 00:28:07,300
<font color="#CCCCCC">doing any attempt</font><font color="#E5E5E5"> at you know</font>

575
00:28:03,670 --> 00:28:09,370
<font color="#E5E5E5">cryptographic exchanges key exchanges or</font>

576
00:28:07,300 --> 00:28:12,010
<font color="#E5E5E5">assists pretty much all clear text or</font>

577
00:28:09,370 --> 00:28:14,469
would you prefer<font color="#E5E5E5"> not to say so there</font>

578
00:28:12,010 --> 00:28:17,080
were some that were<font color="#CCCCCC"> not clear</font><font color="#E5E5E5"> text but</font>

579
00:28:14,470 --> 00:28:20,740
they were encoded<font color="#CCCCCC"> but one of</font><font color="#E5E5E5"> the issues</font>

580
00:28:17,080 --> 00:28:25,928
<font color="#CCCCCC">one of</font><font color="#E5E5E5"> the vendors was it was X Ord with</font>

581
00:28:20,740 --> 00:28:29,400
the<font color="#E5E5E5"> pairing ID</font><font color="#CCCCCC"> so what we did in</font><font color="#E5E5E5"> that</font>

582
00:28:25,929 --> 00:28:33,700
case<font color="#CCCCCC"> is</font><font color="#E5E5E5"> we set our pairing ID to</font><font color="#CCCCCC"> zero</font>

583
00:28:29,400 --> 00:28:34,800
<font color="#CCCCCC">and then figured out</font><font color="#E5E5E5"> that oh that's what</font>

584
00:28:33,700 --> 00:28:36,240
they're using

585
00:28:34,800 --> 00:28:39,030
so then we built a library<font color="#E5E5E5"> of</font><font color="#CCCCCC"> every</font>

586
00:28:36,240 --> 00:28:40,650
possibility of all pairing<font color="#E5E5E5"> IDs and made</font>

587
00:28:39,030 --> 00:28:42,090
a dictionary<font color="#E5E5E5"> and so all we have to do is</font>

588
00:28:40,650 --> 00:28:45,360
run it against<font color="#CCCCCC"> that we pop out</font><font color="#E5E5E5"> the</font>

589
00:28:42,090 --> 00:28:47,189
pairing<font color="#CCCCCC"> ID</font><font color="#E5E5E5"> we can reverse it so you know</font>

590
00:28:45,360 --> 00:28:49,590
basically<font color="#E5E5E5"> another perfect</font><font color="#CCCCCC"> example of</font>

591
00:28:47,190 --> 00:28:55,410
<font color="#CCCCCC">roll-your-own</font><font color="#E5E5E5"> crypto gone wrong</font><font color="#CCCCCC"> right</font>

592
00:28:49,590 --> 00:28:57,689
yeah<font color="#CCCCCC"> so in a lot of cases</font><font color="#E5E5E5"> the from what</font>

593
00:28:55,410 --> 00:29:03,720
I understand when<font color="#CCCCCC"> people do XOR it's</font>

594
00:28:57,690 --> 00:29:05,820
more about FCC licensing<font color="#CCCCCC"> so they're</font><font color="#E5E5E5"> not</font>

595
00:29:03,720 --> 00:29:07,140
sending<font color="#E5E5E5"> too much power</font><font color="#CCCCCC"> so they're</font>

596
00:29:05,820 --> 00:29:09,330
shifting<font color="#E5E5E5"> it all over the</font><font color="#CCCCCC"> place so</font>

597
00:29:07,140 --> 00:29:12,180
they're not<font color="#E5E5E5"> just</font><font color="#CCCCCC"> sending all zeros or</font>

598
00:29:09,330 --> 00:29:14,699
all ones<font color="#E5E5E5"> so that's one of</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> original</font>

599
00:29:12,180 --> 00:29:16,260
reasons<font color="#E5E5E5"> but it is crypto gone wrong but</font>

600
00:29:14,700 --> 00:29:18,990
it may not<font color="#CCCCCC"> have been designed with</font>

601
00:29:16,260 --> 00:29:21,690
security<font color="#CCCCCC"> in mind</font><font color="#E5E5E5"> yeah unfortunately</font><font color="#CCCCCC"> we</font>

602
00:29:18,990 --> 00:29:24,840
didn't<font color="#CCCCCC"> find any proper authentication</font><font color="#E5E5E5"> or</font>

603
00:29:21,690 --> 00:29:26,730
encryption<font color="#E5E5E5"> but as he's mentioned there</font>

604
00:29:24,840 --> 00:29:30,120
<font color="#E5E5E5">was one vendor and this particular</font><font color="#CCCCCC"> ex</font>

605
00:29:26,730 --> 00:29:32,280
<font color="#CCCCCC">oaring scheme the protocol</font><font color="#E5E5E5"> did look very</font>

606
00:29:30,120 --> 00:29:33,959
difficult<font color="#CCCCCC"> initially right so it</font><font color="#E5E5E5"> might</font>

607
00:29:32,280 --> 00:29:36,960
<font color="#E5E5E5">have</font><font color="#CCCCCC"> the effect of discouraging a</font>

608
00:29:33,960 --> 00:29:39,090
<font color="#CCCCCC">reverser because it did kind of appear</font>

609
00:29:36,960 --> 00:29:41,970
like encryption right<font color="#CCCCCC"> but once we kind</font>

610
00:29:39,090 --> 00:29:49,310
of dug into<font color="#E5E5E5"> it</font><font color="#CCCCCC"> we were able</font><font color="#E5E5E5"> to reverse</font>

611
00:29:41,970 --> 00:29:49,310
it so any other<font color="#E5E5E5"> questions</font>

612
00:29:51,559 --> 00:29:56,279
hi Rick journey<font color="#E5E5E5"> did they do anything</font>

613
00:29:54,480 --> 00:30:00,029
<font color="#E5E5E5">about frequency</font><font color="#CCCCCC"> hopping or was it just</font>

614
00:29:56,279 --> 00:30:03,380
<font color="#CCCCCC">straight-up single frequency</font><font color="#E5E5E5"> none</font><font color="#CCCCCC"> of the</font>

615
00:30:00,029 --> 00:30:07,230
ones we looked<font color="#CCCCCC"> at had frequency hopping</font>

616
00:30:03,380 --> 00:30:08,850
<font color="#CCCCCC">there was one</font><font color="#E5E5E5"> vendor who came back to</font><font color="#CCCCCC"> us</font>

617
00:30:07,230 --> 00:30:12,179
<font color="#E5E5E5">and they didn't patch because their</font>

618
00:30:08,850 --> 00:30:15,299
product was<font color="#CCCCCC"> into life</font><font color="#E5E5E5"> we asked them</font><font color="#CCCCCC"> if</font>

619
00:30:12,179 --> 00:30:16,830
they<font color="#E5E5E5"> had any other I had changed any of</font>

620
00:30:15,299 --> 00:30:19,740
their communication since<font color="#E5E5E5"> that one</font>

621
00:30:16,830 --> 00:30:22,949
product<font color="#E5E5E5"> we tested</font><font color="#CCCCCC"> I don't think we ever</font>

622
00:30:19,740 --> 00:30:24,600
<font color="#E5E5E5">got a response so yeah and as I</font>

623
00:30:22,950 --> 00:30:26,580
mentioned you mentioned<font color="#E5E5E5"> the dip switches</font>

624
00:30:24,600 --> 00:30:28,469
earlier<font color="#E5E5E5"> many products are either set by</font>

625
00:30:26,580 --> 00:30:29,970
dip switches or in in the case of this

626
00:30:28,470 --> 00:30:31,649
one<font color="#E5E5E5"> here there's</font><font color="#CCCCCC"> just kind of a channel</font>

627
00:30:29,970 --> 00:30:33,360
<font color="#E5E5E5">number printed on the bottom and this</font>

628
00:30:31,649 --> 00:30:34,739
one will only<font color="#E5E5E5"> ever work on that channel</font>

629
00:30:33,360 --> 00:30:36,899
<font color="#E5E5E5">and if you need to change the frequency</font>

630
00:30:34,740 --> 00:30:39,240
<font color="#CCCCCC">you have to pry the crystal yeah there</font>

631
00:30:36,899 --> 00:30:41,428
was one user manual which suggests how

632
00:30:39,240 --> 00:30:45,889
to unsolder and replace a crystal<font color="#E5E5E5"> this</font>

633
00:30:41,429 --> 00:30:45,889
<font color="#E5E5E5">is fairly unsophisticated unfortunately</font>

634
00:30:48,230 --> 00:30:53,100
jello<font color="#CCCCCC"> for mop I'd risk have you guys</font>

635
00:30:51,000 --> 00:30:54,330
<font color="#E5E5E5">looked at the emitted part specially</font><font color="#CCCCCC"> it</font>

636
00:30:53,100 --> 00:30:56,428
<font color="#CCCCCC">firmware if there has been any</font>

637
00:30:54,330 --> 00:31:02,220
vulnerabilities of<font color="#E5E5E5"> course there's 14</font>

638
00:30:56,429 --> 00:31:04,710
devices so do we look at any other<font color="#CCCCCC"> than</font>

639
00:31:02,220 --> 00:31:06,870
the 14<font color="#E5E5E5"> devices is that question or do we</font>

640
00:31:04,710 --> 00:31:08,850
think<font color="#E5E5E5"> it continues on past the 14</font>

641
00:31:06,870 --> 00:31:12,870
<font color="#E5E5E5">devices yeah we had a little trouble</font>

642
00:31:08,850 --> 00:31:14,730
<font color="#E5E5E5">hearing</font><font color="#CCCCCC"> you but</font><font color="#E5E5E5"> yeah sorry just clarify</font>

643
00:31:12,870 --> 00:31:16,379
<font color="#E5E5E5">so I was referring to the embedded part</font>

644
00:31:14,730 --> 00:31:17,159
the farm<font color="#E5E5E5"> were part of those devices</font>

645
00:31:16,379 --> 00:31:19,019
<font color="#CCCCCC">mm-hm</font>

646
00:31:17,159 --> 00:31:23,220
<font color="#E5E5E5">so have you been able to</font><font color="#CCCCCC"> look into the</font>

647
00:31:19,019 --> 00:31:25,289
transmitters itself<font color="#E5E5E5"> yeah we did a little</font>

648
00:31:23,220 --> 00:31:26,639
firmware reversing yes you might be<font color="#CCCCCC"> able</font>

649
00:31:25,289 --> 00:31:29,220
<font color="#E5E5E5">to speak</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> it more than um so we did a</font>

650
00:31:26,639 --> 00:31:31,408
<font color="#E5E5E5">little bit once again when we really</font>

651
00:31:29,220 --> 00:31:32,909
wanted<font color="#CCCCCC"> to come after the radio</font>

652
00:31:31,409 --> 00:31:37,200
communications because<font color="#E5E5E5"> many</font><font color="#CCCCCC"> of these</font>

653
00:31:32,909 --> 00:31:40,350
devices<font color="#E5E5E5"> are</font><font color="#CCCCCC"> still not</font><font color="#E5E5E5"> Ethernet capable</font>

654
00:31:37,200 --> 00:31:43,200
so we didn't really<font color="#CCCCCC"> look too hard</font><font color="#E5E5E5"> into</font>

655
00:31:40,350 --> 00:31:46,129
the<font color="#E5E5E5"> firmware</font><font color="#CCCCCC"> we were out of the firmware</font>

656
00:31:43,200 --> 00:31:49,169
we were looking for more<font color="#CCCCCC"> things</font><font color="#E5E5E5"> like</font>

657
00:31:46,129 --> 00:31:50,580
were they you know ones<font color="#E5E5E5"> that were a</font>

658
00:31:49,169 --> 00:31:53,070
<font color="#CCCCCC">little harder to figure out</font><font color="#E5E5E5"> were they</font>

659
00:31:50,580 --> 00:31:56,129
doing<font color="#E5E5E5"> Hamming what was kind of the</font>

660
00:31:53,070 --> 00:31:58,259
modulations<font color="#E5E5E5"> those were in the firmware</font>

661
00:31:56,129 --> 00:32:00,779
<font color="#E5E5E5">when it's not necessarily set to the</font>

662
00:31:58,259 --> 00:32:02,909
chip<font color="#E5E5E5"> how is that being handled how do</font>

663
00:32:00,779 --> 00:32:03,790
they decode it<font color="#E5E5E5"> like we looked at that</font>

664
00:32:02,909 --> 00:32:06,250
one vendor

665
00:32:03,790 --> 00:32:08,470
with the exhorting trying to get the

666
00:32:06,250 --> 00:32:10,210
firmware<font color="#E5E5E5"> off of that device and they had</font>

667
00:32:08,470 --> 00:32:12,180
done some firmware protection so<font color="#CCCCCC"> we</font>

668
00:32:10,210 --> 00:32:15,430
couldn't<font color="#E5E5E5"> really pull it off the device</font>

669
00:32:12,180 --> 00:32:18,040
<font color="#E5E5E5">but we did not see things like encrypted</font>

670
00:32:15,430 --> 00:32:20,410
firmware packages<font color="#E5E5E5"> secure boot advanced</font>

671
00:32:18,040 --> 00:32:22,750
or cryptography being used in the

672
00:32:20,410 --> 00:32:24,280
firmware<font color="#E5E5E5"> update process</font><font color="#CCCCCC"> you know lots of</font>

673
00:32:22,750 --> 00:32:26,860
<font color="#E5E5E5">these embedded systems have kind of</font>

674
00:32:24,280 --> 00:32:29,950
small microcontrollers<font color="#E5E5E5"> so at typically</font>

675
00:32:26,860 --> 00:32:31,810
at most you see is the you know<font color="#E5E5E5"> the fuse</font>

676
00:32:29,950 --> 00:32:33,310
bit burned in the micro that says I'm

677
00:32:31,810 --> 00:32:35,200
not<font color="#CCCCCC"> allowed to read the</font><font color="#E5E5E5"> firmware out or</font>

678
00:32:33,310 --> 00:32:39,510
something of that nature<font color="#E5E5E5"> but you know</font>

679
00:32:35,200 --> 00:32:39,510
those systems can<font color="#CCCCCC"> also be circumvented</font>

680
00:32:39,960 --> 00:32:50,770
<font color="#E5E5E5">any other questions</font><font color="#CCCCCC"> ok I got one for you</font>

681
00:32:48,120 --> 00:32:53,260
<font color="#CCCCCC">once you pulled up on site for</font><font color="#E5E5E5"> the case</font>

682
00:32:50,770 --> 00:32:55,690
study<font color="#E5E5E5"> just walk us through what's the</font>

683
00:32:53,260 --> 00:32:58,840
time<font color="#CCCCCC"> - showing up</font><font color="#E5E5E5"> - the time you're able</font>

684
00:32:55,690 --> 00:33:00,730
<font color="#CCCCCC">to isolate</font><font color="#E5E5E5"> the frequency and just try a</font>

685
00:32:58,840 --> 00:33:03,939
replay<font color="#CCCCCC"> so because I hadn't found the</font>

686
00:33:00,730 --> 00:33:06,400
<font color="#E5E5E5">YouTube video prior</font><font color="#CCCCCC"> I already had done</font>

687
00:33:03,940 --> 00:33:10,210
<font color="#E5E5E5">my homework</font><font color="#CCCCCC"> knew which the</font><font color="#E5E5E5"> dips</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> what</font>

688
00:33:06,400 --> 00:33:13,150
<font color="#E5E5E5">dip switch settings were</font><font color="#CCCCCC"> so I sat down I</font>

689
00:33:10,210 --> 00:33:15,310
knew<font color="#E5E5E5"> the frequency to tune</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> all I had</font>

690
00:33:13,150 --> 00:33:17,950
to do is look<font color="#CCCCCC"> for communication so I</font>

691
00:33:15,310 --> 00:33:19,450
actually it was a hot summer<font color="#E5E5E5"> day so</font>

692
00:33:17,950 --> 00:33:21,550
actually they had all their doors open

693
00:33:19,450 --> 00:33:23,950
<font color="#E5E5E5">so I could</font><font color="#CCCCCC"> actually</font><font color="#E5E5E5"> see in and see when</font>

694
00:33:21,550 --> 00:33:26,440
they were<font color="#E5E5E5"> moving it</font><font color="#CCCCCC"> I looked and said</font>

695
00:33:23,950 --> 00:33:29,530
<font color="#CCCCCC">there it is and that's</font><font color="#E5E5E5"> the channel that</font>

696
00:33:26,440 --> 00:33:31,990
they were using yeah and the device<font color="#E5E5E5"> that</font>

697
00:33:29,530 --> 00:33:34,690
<font color="#E5E5E5">we created the radio relay kind of</font>

698
00:33:31,990 --> 00:33:37,690
device<font color="#CCCCCC"> if an attacker were to kind of</font>

699
00:33:34,690 --> 00:33:39,910
leave<font color="#CCCCCC"> that</font><font color="#E5E5E5"> device nearby you'd kind of</font>

700
00:33:37,690 --> 00:33:42,010
only<font color="#E5E5E5"> be limited</font><font color="#CCCCCC"> by the you</font><font color="#E5E5E5"> know battery</font>

701
00:33:39,910 --> 00:33:44,740
life of<font color="#E5E5E5"> that device and you could</font>

702
00:33:42,010 --> 00:33:49,450
remotely kind of monitor for

703
00:33:44,740 --> 00:33:51,040
transmissions or else replay right so

704
00:33:49,450 --> 00:33:54,460
you<font color="#E5E5E5"> mentioned at the beginning</font><font color="#CCCCCC"> of the</font>

705
00:33:51,040 --> 00:33:56,530
talk<font color="#CCCCCC"> that this was an RF research</font>

706
00:33:54,460 --> 00:33:59,050
project part of a series almost<font color="#E5E5E5"> yep</font>

707
00:33:56,530 --> 00:34:03,100
<font color="#CCCCCC">what's</font><font color="#E5E5E5"> next</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> started to think</font><font color="#CCCCCC"> about</font>

708
00:33:59,050 --> 00:34:03,970
<font color="#E5E5E5">where</font><font color="#CCCCCC"> to go after</font><font color="#E5E5E5"> cranes that's a good</font>

709
00:34:03,100 --> 00:34:05,469
<font color="#E5E5E5">question</font>

710
00:34:03,970 --> 00:34:09,129
we can talk<font color="#E5E5E5"> later because we're out of</font>

711
00:34:05,470 --> 00:34:12,480
<font color="#E5E5E5">time one last</font><font color="#CCCCCC"> question will you be</font>

712
00:34:09,129 --> 00:34:12,480
attacking Adam<font color="#E5E5E5"> Krane</font>

713
00:34:15,379 --> 00:34:21,350
he says no maybe<font color="#CCCCCC"> we'll talk</font><font color="#E5E5E5"> later</font>

714
00:34:19,379 --> 00:34:24,440
what's this protocol<font color="#E5E5E5"> like I don't know</font>

715
00:34:21,350 --> 00:34:27,440
only if it's over<font color="#E5E5E5"> dnp3</font>

716
00:34:24,440 --> 00:34:31,999
<font color="#E5E5E5">okay thanks guys let's give them around</font>

717
00:34:27,440 --> 00:34:31,999
[Applause]

718
00:34:35,100 --> 00:34:44,649
[Music]

719
00:34:42,589 --> 00:34:44,649
you

