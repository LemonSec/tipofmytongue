1
00:00:12,269 --> 00:00:14,510
so thanks for coming

2
00:00:14,510 --> 00:00:17,980
my name's is Christian I'm presenting
some work we did on

3
00:00:17,980 --> 00:00:22,350
protecting data is bit databases with
some technical another little

4
00:00:22,350 --> 00:00:25,930
annals of simple commands arm

5
00:00:25,930 --> 00:00:31,119
so that's called protecting data bases
with Greece this doesn't work

6
00:00:31,119 --> 00:00:35,260
so a.m. my primary professionalism

7
00:00:35,260 --> 00:00:38,710
researcher at Dove at the outage
Artificial Intelligence Group

8
00:00:38,710 --> 00:00:41,960
of the University of don't want and

9
00:00:41,960 --> 00:00:46,140
basically I'm starting the use of
machine learning methods and artificial

10
00:00:46,140 --> 00:00:48,409
intelligence methods like data mining
methods

11
00:00:48,409 --> 00:00:51,519
for machine learning for web security

12
00:00:51,519 --> 00:00:54,860
um as hobby I'm

13
00:00:54,860 --> 00:00:59,129
develop ok several projects from or
affiliated with much security

14
00:00:59,129 --> 00:01:02,909
with what security repetition firewall
so I have some

15
00:01:02,909 --> 00:01:06,400
stuff for my webpage Jay Walder dork
which is

16
00:01:06,400 --> 00:01:09,770
some look for aggregation management
stuff and some

17
00:01:09,770 --> 00:01:13,460
but occasion policy compiler and so on

18
00:01:13,460 --> 00:01:16,460
and missus what I do in my spare time so

19
00:01:16,460 --> 00:01:20,000
this talk is not touching anything all
that

20
00:01:20,000 --> 00:01:23,240
this talk is about the first some

21
00:01:23,240 --> 00:01:27,330
the threat of sequence actions is that

22
00:01:27,330 --> 00:01:32,680
looks to valid threat been I'll try to
give a picture on

23
00:01:32,680 --> 00:01:37,150
where we can find fight sequel
injections and I will start

24
00:01:37,150 --> 00:01:40,730
diving into how we forbes and

25
00:01:40,730 --> 00:01:44,170
seagram's actions might be fault at a
good place

26
00:01:44,170 --> 00:01:47,410
so I'd like to stop the store like

27
00:01:47,410 --> 00:01:51,230
every good sequin checking talk and
every

28
00:01:51,230 --> 00:01:54,610
group sequin texan talk probably start
with this and

29
00:01:54,610 --> 00:01:58,270
I guess who does not know this this

30
00:01:58,270 --> 00:02:01,990
okay at least one am

31
00:02:01,990 --> 00:02:05,490
so basically just student typing in his
his

32
00:02:05,490 --> 00:02:08,610
home to name and it types in robot

33
00:02:08,610 --> 00:02:13,129
at a a personal phone drop table
students and that gets into inserted

34
00:02:13,129 --> 00:02:14,129
into the database

35
00:02:14,129 --> 00:02:18,879
or in it gets into inserted ability to
into the replication

36
00:02:18,879 --> 00:02:22,629
it finally it's the database and it
answered some

37
00:02:22,629 --> 00:02:26,650
record and drops all the other records
as well so

38
00:02:26,650 --> 00:02:29,780
from this catwoman is

39
00:02:29,780 --> 00:02:33,310
about five years old and if you're just
attended the other talk

40
00:02:33,310 --> 00:02:36,829
beforehand you notice that seagram's
action is about

41
00:02:36,829 --> 00:02:40,170
through thirteen years old so its

42
00:02:40,170 --> 00:02:43,900
pretty amazing that so the first
question about

43
00:02:43,900 --> 00:02:47,790
would which rise to me was is it still a
valid research topic so is it

44
00:02:47,790 --> 00:02:51,510
really necessary to focus on seek
reductions

45
00:02:51,510 --> 00:02:56,079
this post the backpacking incident
database which is

46
00:02:56,079 --> 00:02:59,840
a record of or web hacking at the
incidents which I have been

47
00:02:59,840 --> 00:03:03,260
becoming public and this is just a.m.

48
00:03:03,260 --> 00:03:06,349
the first half of June this year so

49
00:03:06,349 --> 00:03:09,799
there was this Sony breach from Sony
Europe reach

50
00:03:09,799 --> 00:03:13,239
some US attacks from left

51
00:03:13,239 --> 00:03:16,450
FBI website was hacked and some more
stuff

52
00:03:16,450 --> 00:03:20,310
and if you look at the types of attacks

53
00:03:20,310 --> 00:03:24,090
then that's a lot of seek reductions

54
00:03:24,090 --> 00:03:27,370
involved in that and if you just the

55
00:03:27,370 --> 00:03:32,049
display that then those almost half of
the attacks which have been carried out

56
00:03:32,049 --> 00:03:32,709
against

57
00:03:32,709 --> 00:03:36,019
a web applications have been sequel
injections

58
00:03:36,019 --> 00:03:40,349
most of them just easy and is but
especially easily

59
00:03:40,349 --> 00:03:43,669
to be automated with a love to use

60
00:03:43,669 --> 00:03:47,010
Imperva has or a.m.

61
00:03:47,010 --> 00:03:51,109
a trend report from the giveaway every
month I guess

62
00:03:51,109 --> 00:03:54,889
and there was that one which is the
number for which the in which they

63
00:03:54,889 --> 00:03:56,870
monitored like 30 web applications

64
00:03:56,870 --> 00:04:01,529
and that we're just checking home what
is what what kind what XR

65
00:04:01,529 --> 00:04:04,989
have been raised against the A's so the
phone out to us like

66
00:04:04,989 --> 00:04:08,510
71 seagram's action at the terms on
average power

67
00:04:08,510 --> 00:04:12,219
have liked 802 1300

68
00:04:12,219 --> 00:04:16,220
Dec midterms at-times and most of these
have been

69
00:04:16,220 --> 00:04:19,739
carried out by highly automated inject
into its like

70
00:04:19,739 --> 00:04:23,030
seek a mag physical map or heavy has

71
00:04:23,030 --> 00:04:26,760
anyone experience in Sequim at so

72
00:04:26,760 --> 00:04:29,860
a and the others have the others ever
heard of Sequim

73
00:04:29,860 --> 00:04:34,170
was met who has not ever heard of
Superman so

74
00:04:34,170 --> 00:04:37,630
this is quite nice nice from to a by

75
00:04:37,630 --> 00:04:41,200
been up in a mirror and some a guy and

76
00:04:41,200 --> 00:04:44,310
it gives you is just checked the web
application for

77
00:04:44,310 --> 00:04:47,940
injectable para meterse and once had
found something

78
00:04:47,940 --> 00:04:53,080
it gives a complete show off your if
your weapon replica of your database

79
00:04:53,080 --> 00:04:56,470
through the web application a dozen
coding at best tempering and

80
00:04:56,470 --> 00:04:59,670
does try to a.m. if or detection

81
00:04:59,670 --> 00:05:04,060
by numerous from make mechanisms and its

82
00:05:04,060 --> 00:05:07,120
pretty good so

83
00:05:07,120 --> 00:05:10,300
another from trend report was about

84
00:05:10,300 --> 00:05:14,150
the from topics of hacking forum so they
just

85
00:05:14,150 --> 00:05:18,510
checked or online forums how to avoid
what type of

86
00:05:18,510 --> 00:05:22,130
types of to text to pecos discuss and

87
00:05:22,130 --> 00:05:26,300
you see again but see projections that
we along this almost

88
00:05:26,300 --> 00:05:29,930
20 percent then the

89
00:05:29,930 --> 00:05:33,580
when a woman and at this conference I
check my Twitter content

90
00:05:33,580 --> 00:05:37,150
I just use protect as a good source for

91
00:05:37,150 --> 00:05:41,760
getting notifies a few tech said this is
what I've just won't

92
00:05:41,760 --> 00:05:44,760
yesterday and thats week-old

93
00:05:44,760 --> 00:05:49,360
so there was a sequel injection in in
the secrecy shop

94
00:05:49,360 --> 00:05:54,150
home environment and them there was some
the story behind this is about

95
00:05:54,150 --> 00:05:57,210
some developers we just have a

96
00:05:57,210 --> 00:06:00,510
just coded to secure room C sharp age

97
00:06:00,510 --> 00:06:03,510
and some some other stuff didn't work

98
00:06:03,510 --> 00:06:07,570
so they found a plaque which says a.m.
validate

99
00:06:07,570 --> 00:06:11,120
because true or false and the just
turned off the

100
00:06:11,120 --> 00:06:14,200
input validation with that and and them

101
00:06:14,200 --> 00:06:17,820
the code worked so they were happy and

102
00:06:17,820 --> 00:06:21,690
this is the result so from

103
00:06:21,690 --> 00:06:25,290
if you just have a look at the top 10
him almost top 10 list

104
00:06:25,290 --> 00:06:28,400
been sick with chechen is on on that
list for a long time

105
00:06:28,400 --> 00:06:32,350
and the also if you look at other
institutes which

106
00:06:32,350 --> 00:06:36,790
own compiles such list and it's like
this is the Suns me to top 25

107
00:06:36,790 --> 00:06:37,990
programming hours

108
00:06:37,990 --> 00:06:41,090
so there's also the mmm improper no

109
00:06:41,090 --> 00:06:44,820
neutralization of the crew elements as
just the high

110
00:06:44,820 --> 00:06:48,230
impact topic guess what

111
00:06:48,230 --> 00:06:51,700
it doesn't always have hit web
applications

112
00:06:51,700 --> 00:06:55,450
so a.m. missus Android

113
00:06:55,450 --> 00:06:59,290
and home data restore it

114
00:06:59,290 --> 00:07:02,490
any data stored in databases also SMS so

115
00:07:02,490 --> 00:07:06,060
there wasn't a single injection in an
SMS gateway so you could just

116
00:07:06,060 --> 00:07:09,460
use your mobile phone to inject sukuk
months

117
00:07:09,460 --> 00:07:13,780
into the database of your SMS gateway
system so

118
00:07:13,780 --> 00:07:18,770
don't does not only effect sicko
injection

119
00:07:18,770 --> 00:07:22,190
so what makes up sick rejection
basically

120
00:07:22,190 --> 00:07:25,450
from what we have is the situation I
guess that is what

121
00:07:25,450 --> 00:07:28,950
most if you guys have at home or at work

122
00:07:28,950 --> 00:07:32,750
so we have some web server which is
serving you alls

123
00:07:32,750 --> 00:07:35,860
and once in a while though some URL's
%um

124
00:07:35,860 --> 00:07:39,000
Rep request hitting a database it in
your web server

125
00:07:39,000 --> 00:07:44,110
and you epic application is somehow
created executing a simple command

126
00:07:44,110 --> 00:07:48,000
back to bed back on the date back and a
two-race produces some results

127
00:07:48,000 --> 00:07:51,170
and delivers up to the client so

128
00:07:51,170 --> 00:07:55,840
the questions know what makes up sequel
injection

129
00:07:55,840 --> 00:08:00,090
basically this two things involved first
the attacker has two

130
00:08:00,090 --> 00:08:04,240
insert some payload some sequel payload
into the

131
00:08:04,240 --> 00:08:07,480
replication okay so this has to be

132
00:08:07,480 --> 00:08:11,400
insurgent somewhere here and Matt it has
to reach somewhere

133
00:08:11,400 --> 00:08:14,670
into the web repetition logic

134
00:08:14,670 --> 00:08:17,860
and the second room condition we need to
have this

135
00:08:17,860 --> 00:08:21,160
we need to have this sequel inject who
is this

136
00:08:21,160 --> 00:08:25,720
injection peace have to alter or modify
the

137
00:08:25,720 --> 00:08:29,290
xiiso sick or statement that is to be
executed

138
00:08:29,290 --> 00:08:32,349
so if we just

139
00:08:32,349 --> 00:08:35,709
insert some union select lookin password
from users

140
00:08:35,709 --> 00:08:39,490
and if we do is this correctly and the

141
00:08:39,490 --> 00:08:42,570
replication is vulnerable to sequence
actions

142
00:08:42,570 --> 00:08:45,889
then the database statement is not only
select

143
00:08:45,889 --> 00:08:49,070
title and abstract from docs but its the
Union

144
00:08:49,070 --> 00:08:54,240
of the first select and the result of
the sub the the second SELECT statement

145
00:08:54,240 --> 00:08:57,810
so this is basically the bait room for
or

146
00:08:57,810 --> 00:09:01,230
idea of a secret actions so

147
00:09:01,230 --> 00:09:05,340
where can we find or work every fight

148
00:09:05,340 --> 00:09:09,310
sick rejections and if you tend the last
talk then

149
00:09:09,310 --> 00:09:12,870
you should be aware that the first steps
you have to do is

150
00:09:12,870 --> 00:09:16,520
you have to check fight weapon rooms the
projections

151
00:09:16,520 --> 00:09:21,140
within your web application for called
so if you have any chance to access that

152
00:09:21,140 --> 00:09:22,450
code

153
00:09:22,450 --> 00:09:27,950
and if you have some you like you didn't
outsource your application but you

154
00:09:27,950 --> 00:09:32,860
reg application yourself and this is the
first step you need to take

155
00:09:32,860 --> 00:09:36,320
the second one which is used usually
donors

156
00:09:36,320 --> 00:09:40,570
we do within the HTTP traffic so you
employ like a web application firewall

157
00:09:40,570 --> 00:09:44,140
intrusion detection system or something
like that this these are all in front of

158
00:09:44,140 --> 00:09:44,660
your web

159
00:09:44,660 --> 00:09:48,150
web server or in front of your web
application

160
00:09:48,150 --> 00:09:51,590
and this check for known a.m.

161
00:09:51,590 --> 00:09:54,630
sequins actions and for

162
00:09:54,630 --> 00:09:58,930
last part we can do is and this is what
we what I will focus on him

163
00:09:58,930 --> 00:10:01,970
on the second half for talk is

164
00:10:01,970 --> 00:10:05,320
weekend fight a secret checksums within

165
00:10:05,320 --> 00:10:08,500
the executed XML code so this is

166
00:10:08,500 --> 00:10:12,120
for it location where we can

167
00:10:12,120 --> 00:10:16,430
fight having a look at the first one
mister

168
00:10:16,430 --> 00:10:20,050
so the pretty good from guides for a
code review

169
00:10:20,050 --> 00:10:23,140
and a.m. do Train Your

170
00:10:23,140 --> 00:10:26,589
developers raise awareness of sipple

171
00:10:26,589 --> 00:10:29,670
the danger of single injections and
stuff like this

172
00:10:29,670 --> 00:10:34,130
in with the neural development team to
penetration testing

173
00:10:34,130 --> 00:10:37,450
to rescue my risk management okay we
just heard

174
00:10:37,450 --> 00:10:41,029
forget about risk manage confirm the
other talk but the Scopus

175
00:10:41,029 --> 00:10:44,160
a one of the one of the approaches
Witcher

176
00:10:44,160 --> 00:10:48,110
recommended but missus just best thing
to do in the first place

177
00:10:48,110 --> 00:10:52,510
so what we can do is we can use prepared
statements

178
00:10:52,510 --> 00:10:56,300
prepared statement has been have been
around for quite some time from there

179
00:10:56,300 --> 00:10:57,779
are prepared statements for

180
00:10:57,779 --> 00:11:01,860
like almost every language and what they
do is

181
00:11:01,860 --> 00:11:06,690
you don't directly a.m. insert user
imprudent anymore into the

182
00:11:06,690 --> 00:11:09,740
sequestering you want to execute what
you do is

183
00:11:09,740 --> 00:11:13,950
you give that template string2 prefer to
a statement

184
00:11:13,950 --> 00:11:17,120
and then make the database driver escape

185
00:11:17,120 --> 00:11:20,250
all the special character so this the
safe

186
00:11:20,250 --> 00:11:24,210
and a safe contain out so that it the
attacker cannot break out

187
00:11:24,210 --> 00:11:27,990
of the statement this is a good and I
believe that

188
00:11:27,990 --> 00:11:31,830
almost if you don't have to but in your
day tourist driver than you will be

189
00:11:31,830 --> 00:11:32,560
probably

190
00:11:32,560 --> 00:11:35,940
almost a hundred percent sure about the
group's actions by just using prepared

191
00:11:35,940 --> 00:11:38,310
statement

192
00:11:38,310 --> 00:11:41,970
however you can also do wrong with the
two

193
00:11:41,970 --> 00:11:46,140
it was prepared statements so if you
just use prepared statement and

194
00:11:46,140 --> 00:11:47,760
concatenate the

195
00:11:47,760 --> 00:11:50,779
user input into the prepared statement

196
00:11:50,779 --> 00:11:53,990
then you don't have any benefit of it so
this is about

197
00:11:53,990 --> 00:11:57,790
develop a training and

198
00:11:57,790 --> 00:12:02,070
so I would risk disclose this have a
look at the code section

199
00:12:02,070 --> 00:12:05,070
no and no we moved onto some

200
00:12:05,070 --> 00:12:09,730
different part which is intrusion
detection and prevention and this is my

201
00:12:09,730 --> 00:12:10,890
favorite

202
00:12:10,890 --> 00:12:13,980
site of them to me I'm about how both
Sony

203
00:12:13,980 --> 00:12:17,080
focus ideas mailing this and the says
just

204
00:12:17,080 --> 00:12:20,570
all this stuff about intrusion detection
and intrusion prevention

205
00:12:20,570 --> 00:12:24,690
is just big attempt but hatchback system
so

206
00:12:24,690 --> 00:12:27,710
in the first place we need to have a
patch for the system itself

207
00:12:27,710 --> 00:12:33,589
for the application and this book by
everything we do now is just

208
00:12:33,589 --> 00:12:37,490
a hopeless a like crying for help me

209
00:12:37,490 --> 00:12:41,630
so home want to intrude into session
section systems to

210
00:12:41,630 --> 00:12:45,700
some from some things like PHP ID s or
snort or

211
00:12:45,700 --> 00:12:50,130
replication fireworks but not security
and some when the specific stuff

212
00:12:50,130 --> 00:12:53,500
'em have been promoted to check

213
00:12:53,500 --> 00:12:57,149
the web traffic against which hits your
web application

214
00:12:57,149 --> 00:13:01,070
and basically them what they do is a
check for

215
00:13:01,070 --> 00:13:05,029
keywords of sequel commands so the check
the user in Petes

216
00:13:05,029 --> 00:13:08,430
and just ask themselves is I have a list
of

217
00:13:08,430 --> 00:13:12,560
known sequel injections or known sequel
keywords

218
00:13:12,560 --> 00:13:15,589
and is there any of that keywords in my

219
00:13:15,589 --> 00:13:19,670
user data and this is

220
00:13:19,670 --> 00:13:22,690
room like a pet better matching approach
in this is

221
00:13:22,690 --> 00:13:26,070
employed by almost or replication
firewalls and

222
00:13:26,070 --> 00:13:30,380
idea intrusion detection system like
ModSecurity call Ruth

223
00:13:30,380 --> 00:13:33,710
the IBM repetition five are in power but
empower

224
00:13:33,710 --> 00:13:37,640
secures for you and some others so this
is basically

225
00:13:37,640 --> 00:13:41,310
for approach they do and as much rest

226
00:13:41,310 --> 00:13:44,470
just few words most of the time it's

227
00:13:44,470 --> 00:13:49,640
complex regular expressions so this is a
regular expression of more security rule

228
00:13:49,640 --> 00:13:53,130
which helps you find sequence actions in
your

229
00:13:53,130 --> 00:13:56,740
import no corresponding to that

230
00:13:56,740 --> 00:14:00,149
is a email on the mailing list asking

231
00:14:00,149 --> 00:14:04,029
okay I have a trigger of that regular
expression against

232
00:14:04,029 --> 00:14:07,310
that talkin so there was some cookie

233
00:14:07,310 --> 00:14:10,490
and basically the

234
00:14:10,490 --> 00:14:14,320
regular expression just found this two
characters or

235
00:14:14,320 --> 00:14:18,510
who that's it for tonight so

236
00:14:18,510 --> 00:14:22,010
it's really hot too to write good rules

237
00:14:22,010 --> 00:14:25,399
so and you have to you have to take care
of a lot of things and we'll see in a

238
00:14:25,399 --> 00:14:26,830
minute

239
00:14:26,830 --> 00:14:29,899
so um some of the web application
firewalls

240
00:14:29,899 --> 00:14:33,970
try to replace known keywords for
instance

241
00:14:33,970 --> 00:14:39,610
the following one would pro this one
will probably end up as a database error

242
00:14:39,610 --> 00:14:44,060
so if the web once the replication
starts removing a key word

243
00:14:44,060 --> 00:14:48,600
we end up with a much finer statement
and this is well in escrow statement and

244
00:14:48,600 --> 00:14:49,370
if you're

245
00:14:49,370 --> 00:14:52,760
if your application is is prone to

246
00:14:52,760 --> 00:14:57,390
sequence action I would have to date
that were hit the database

247
00:14:57,390 --> 00:15:02,550
or some great articles one is a
presentation by honest as a from the

248
00:15:02,550 --> 00:15:06,800
Road were university or welcome which is
some when you but my place

249
00:15:06,800 --> 00:15:10,540
and there's another white paper from the
CBSE WH

250
00:15:10,540 --> 00:15:14,740
underground crew from they just

251
00:15:14,740 --> 00:15:18,339
send out a list of Harlow to evade
detection

252
00:15:18,339 --> 00:15:22,020
of intrusion detection and pure weapon
because if I was

253
00:15:22,020 --> 00:15:25,180
that can be done by coding obfuscation

254
00:15:25,180 --> 00:15:28,630
over HTTP parameter suburban pollution
no

255
00:15:28,630 --> 00:15:33,140
if examples for that in a minute so

256
00:15:33,140 --> 00:15:37,380
uses being as some secret some
replication if I want

257
00:15:37,380 --> 00:15:41,339
just didn't do WL encoding so they just
use

258
00:15:41,339 --> 00:15:45,390
the data just you owe deco deco today to
bury taiwan's

259
00:15:45,390 --> 00:15:50,420
and if you just do this then they will
end up with this

260
00:15:50,420 --> 00:15:53,850
and if your web application itself thus

261
00:15:53,850 --> 00:15:56,860
W Allen coding and the them the

262
00:15:56,860 --> 00:16:00,070
application will be hit by this and this
again

263
00:16:00,070 --> 00:16:04,430
is about sequel that can be hit you
later it can hit you later Rees

264
00:16:04,430 --> 00:16:07,950
so that is very easy and I guess most
people most what

265
00:16:07,950 --> 00:16:12,589
'em and vendors have fixed that problem
so

266
00:16:12,589 --> 00:16:16,089
what about other in coding stuff what
about base64 encoding

267
00:16:16,089 --> 00:16:21,089
so if you run a is P application there's
some variable I was aware of

268
00:16:21,089 --> 00:16:24,279
score use ViewState and its so I'll

269
00:16:24,279 --> 00:16:27,709
just to maybe correct me if I'm wrong

270
00:16:27,709 --> 00:16:31,089
I'm not is P program about view status
just

271
00:16:31,089 --> 00:16:34,399
some variable for keeping the client
state and

272
00:16:34,399 --> 00:16:38,399
you can also and this one's based for
base64 encoded and

273
00:16:38,399 --> 00:16:41,550
changed between the client and server so

274
00:16:41,550 --> 00:16:45,750
know you end up with this house with
your replication fire will be aware of

275
00:16:45,750 --> 00:16:46,690
that

276
00:16:46,690 --> 00:16:50,390
so it had you have to configure your web
applications actually decode

277
00:16:50,390 --> 00:16:54,649
stuff in the right to coding because if
you to call it that

278
00:16:54,649 --> 00:16:59,000
your have for instance variable so rooms
something like

279
00:16:59,000 --> 00:17:02,490
or one greater than 0 this may

280
00:17:02,490 --> 00:17:06,019
return for instance more data records
and you

281
00:17:06,019 --> 00:17:09,630
want to a exposed to the user

282
00:17:09,630 --> 00:17:12,720
vendors Commons by

283
00:17:12,720 --> 00:17:16,179
for instance my school my sequels

284
00:17:16,179 --> 00:17:20,360
own numerous from different types of
Commons for instance

285
00:17:20,360 --> 00:17:24,850
from has tech to from the house
character until the end of the line

286
00:17:24,850 --> 00:17:28,449
from minus minus until the end of the
line seastar Commons

287
00:17:28,449 --> 00:17:32,929
and some of us and you can try to
obfuscate

288
00:17:32,929 --> 00:17:36,280
your injection payload by using comments

289
00:17:36,280 --> 00:17:39,440
this for instance is a completely
validated by MC crew

290
00:17:39,440 --> 00:17:42,559
common for Moscow

291
00:17:42,559 --> 00:17:46,500
no a.m. this one is

292
00:17:46,500 --> 00:17:50,120
from one of the examples of the going
after hamas does a

293
00:17:50,120 --> 00:17:54,740
to evade detection of a month security
court call would set

294
00:17:54,740 --> 00:17:59,360
and if it does decoded when that this is
a mixture of

295
00:17:59,360 --> 00:18:03,679
them off what from has taken to the has
courage until the end of the line

296
00:18:03,679 --> 00:18:04,730
comment mixed

297
00:18:04,730 --> 00:18:08,790
with the sea star comment which has no
effect because moscow's just ignoring

298
00:18:08,790 --> 00:18:10,130
everything after that

299
00:18:10,130 --> 00:18:13,480
and so on so you try to obfuscate the

300
00:18:13,480 --> 00:18:16,710
secret command away that patterns of
human

301
00:18:16,710 --> 00:18:20,299
web application firewall of or you
intrusion detection don't catch that

302
00:18:20,299 --> 00:18:22,400
anymore

303
00:18:22,400 --> 00:18:25,630
when you have MySQL special Commons
which have

304
00:18:25,630 --> 00:18:29,100
special than 2x with the extra
exclamation mark just for

305
00:18:29,100 --> 00:18:34,730
running specific code out only on
specific versions of MySQL database

306
00:18:34,730 --> 00:18:39,080
and this can be used for probing must go
version you're trying to attack and so

307
00:18:39,080 --> 00:18:40,650
on

308
00:18:40,650 --> 00:18:43,690
and there's a bunch of that to evade

309
00:18:43,690 --> 00:18:47,640
what security call rules and the rebel
Weber ish if I was that's

310
00:18:47,640 --> 00:18:50,670
commercial on and

311
00:18:50,670 --> 00:18:54,559
arm so this is basically is pretty basic

312
00:18:54,559 --> 00:18:57,580
or one because one so its pretty

313
00:18:57,580 --> 00:19:01,130
basic to just use but always true

314
00:19:01,130 --> 00:19:04,230
condition into in inject that into you
are

315
00:19:04,230 --> 00:19:07,679
Seabrook month to return more records
you are

316
00:19:07,679 --> 00:19:10,820
about to to allow to see and

317
00:19:10,820 --> 00:19:14,710
one thing you could do is if you just
start with all

318
00:19:14,710 --> 00:19:17,820
one equal one greater 0 or 1 because one

319
00:19:17,820 --> 00:19:21,030
you can start obfuscating that so

320
00:19:21,030 --> 00:19:24,750
to time three is greater than for that's
a true statement

321
00:19:24,750 --> 00:19:27,950
you can use what maestro most people
variables

322
00:19:27,950 --> 00:19:31,510
check you can see just use my house girl

323
00:19:31,510 --> 00:19:34,690
out what I think so this is the one this

324
00:19:34,690 --> 00:19:37,960
automatic types to im converted to true
or

325
00:19:37,960 --> 00:19:40,990
to casting this constant drew and

326
00:19:40,990 --> 00:19:44,670
you can run any type of mathematical
functions

327
00:19:44,670 --> 00:19:48,299
so sure on p by one and adds to it too

328
00:19:48,299 --> 00:19:51,470
the to that mewmew end up with five and
this

329
00:19:51,470 --> 00:19:55,450
people home almost for sure he quotes
your major version of

330
00:19:55,450 --> 00:19:58,860
my school there's a breeze so does the
trick to

331
00:19:58,860 --> 00:20:03,929
just evade pattern detection

332
00:20:03,929 --> 00:20:07,230
another thing which is really coolers

333
00:20:07,230 --> 00:20:11,330
if you just specify missing a power
meter more than once to you ever

334
00:20:11,330 --> 00:20:16,760
web application then typically different
web applications will behave different

335
00:20:16,760 --> 00:20:20,830
for instance and PHP Apache

336
00:20:20,830 --> 00:20:24,190
you were just rid return the first
government okay

337
00:20:24,190 --> 00:20:27,500
this is what I would have expected and
what

338
00:20:27,500 --> 00:20:31,160
people most people would have expected
if your own

339
00:20:31,160 --> 00:20:34,309
is peter arnett on I S

340
00:20:34,309 --> 00:20:38,299
the permit as well para to use get
contaminated

341
00:20:38,299 --> 00:20:42,530
we comma and thus pretty handy because

342
00:20:42,530 --> 00:20:47,080
if you start this and you have to you're
running is P

343
00:20:47,080 --> 00:20:51,100
from Webfusion and you just for just for
safety

344
00:20:51,100 --> 00:20:54,299
started to set up what security in front
about

345
00:20:54,299 --> 00:20:58,760
then this will be the view of most
security

346
00:20:58,760 --> 00:21:02,419
okay you can just start from

347
00:21:02,419 --> 00:21:06,200
start have throwing your pet on some
that at that and maybe you just don't

348
00:21:06,200 --> 00:21:09,600
catch that and it ends up

349
00:21:09,600 --> 00:21:12,650
in your database in %um web application
back and

350
00:21:12,650 --> 00:21:15,910
concatenated with comma so it's meet and

351
00:21:15,910 --> 00:21:19,850
perfectly fine Seabrook amount project
which is

352
00:21:19,850 --> 00:21:24,330
not really was a pallbearer soap is the
music sample but you can obfuscate all

353
00:21:24,330 --> 00:21:24,799
that's

354
00:21:24,799 --> 00:21:28,160
with Rivka muscle with commas as most so
just

355
00:21:28,160 --> 00:21:31,270
start open opening comment here

356
00:21:31,270 --> 00:21:34,820
and a closing comment here and this kid
Congo Congo two nated

357
00:21:34,820 --> 00:21:38,280
and you can't try to to evade your

358
00:21:38,280 --> 00:21:41,549
replication file business from

359
00:21:41,549 --> 00:21:45,580
at you is called permit to pollution and
this has been successfully used

360
00:21:45,580 --> 00:21:48,650
but only to evade more security but also
to evade

361
00:21:48,650 --> 00:21:53,860
the IBM tablet application firewall and
improv impair am-6 your sphere

362
00:21:53,860 --> 00:21:57,440
so my point here was just too

363
00:21:57,440 --> 00:22:01,520
emphasis this lot of things you can do
to get around

364
00:22:01,520 --> 00:22:05,450
detection of patterns and this is just

365
00:22:05,450 --> 00:22:09,440
home obfuscating so

366
00:22:09,440 --> 00:22:13,660
the big question is how'd to you buried
the invasion

367
00:22:13,660 --> 00:22:16,870
so we can I just use pain patterns
anymore we need to have

368
00:22:16,870 --> 00:22:20,240
were way to a.m. somehow

369
00:22:20,240 --> 00:22:23,830
home see the data

370
00:22:23,830 --> 00:22:28,020
in a plane way normalized way and we do
this by moving

371
00:22:28,020 --> 00:22:31,860
but due to a different perspective so

372
00:22:31,860 --> 00:22:34,860
we talked about the code security we
talked about

373
00:22:34,860 --> 00:22:37,900
intrusion detection at the HTTP traffic
and no

374
00:22:37,900 --> 00:22:41,140
we moving to the database

375
00:22:41,140 --> 00:22:44,610
and there's some benefits we get from
from this point detection

376
00:22:44,610 --> 00:22:47,610
first any encodings which have been

377
00:22:47,610 --> 00:22:50,610
used by the attacker have been decoded
by

378
00:22:50,610 --> 00:22:53,919
the application in the way that

379
00:22:53,919 --> 00:22:57,980
be a pic with that your program to
application so

380
00:22:57,980 --> 00:23:01,179
second there's no more mingling done so
the data the

381
00:23:01,179 --> 00:23:04,780
DATABASE statement that arrives at this
place

382
00:23:04,780 --> 00:23:08,669
is not from is not modified anymore

383
00:23:08,669 --> 00:23:11,790
there's an exception for that so it's
internally multi5

384
00:23:11,790 --> 00:23:15,610
by seat with a quick query optimizer of
a database but

385
00:23:15,610 --> 00:23:19,710
would is that we can just ignore that
for a moment

386
00:23:19,710 --> 00:23:24,660
and the practice that any encoding any
of the attacks approve presented

387
00:23:24,660 --> 00:23:27,660
like any of the coding a text don't work
at this level

388
00:23:27,660 --> 00:23:31,640
never so you're free you can the attack
unjust

389
00:23:31,640 --> 00:23:35,020
use tones of recording stuff into
calling tricks

390
00:23:35,020 --> 00:23:40,540
and it won't trick detection anymore
because it doesn't apply here

391
00:23:40,540 --> 00:23:44,040
so recall what and the sequence action
is made of

392
00:23:44,040 --> 00:23:48,500
so the secret checks needs to modify the
existing statement

393
00:23:48,500 --> 00:23:53,090
and books modified statement needs to be
developed super cold

394
00:23:53,090 --> 00:23:57,160
there are some that doesn't have to some
sometimes attackers can also get

395
00:23:57,160 --> 00:24:01,049
information from day to raise a ross so
it doesn't always have to be

396
00:24:01,049 --> 00:24:04,860
valid zip code but we just stick to that

397
00:24:04,860 --> 00:24:08,030
for a moment so in this case

398
00:24:08,030 --> 00:24:11,100
we have select item abstract where text
like

399
00:24:11,100 --> 00:24:14,270
drop table students so is that valid

400
00:24:14,270 --> 00:24:18,289
sequin injection and I'd like to ask you

401
00:24:18,289 --> 00:24:21,710
because we have this discussion
yesterday so it wouldn't be a secret

402
00:24:21,710 --> 00:24:28,710
sexual not

403
00:24:28,879 --> 00:24:32,690
okay and if that's a free text field
then that's a valid statement right

404
00:24:32,690 --> 00:24:36,090
so it's its home legal statement and

405
00:24:36,090 --> 00:24:39,519
this one would be okay so this one would
be

406
00:24:39,519 --> 00:24:42,940
it permits or conditions as get it has
some sequel

407
00:24:42,940 --> 00:24:46,029
soon see quick amount injected this is
thats

408
00:24:46,029 --> 00:24:49,570
the Union select and it has altered or
modified

409
00:24:49,570 --> 00:24:53,559
the structure of the sequel statement
and have

410
00:24:53,559 --> 00:24:56,899
thing we were I was thinking about is
how can we capture

411
00:24:56,899 --> 00:25:00,159
these modifications so

412
00:25:00,159 --> 00:25:05,249
in theory seek with a highly structured
language

413
00:25:05,249 --> 00:25:09,999
so a sequel statements can be passed
into an abstract syntax to you this what

414
00:25:09,999 --> 00:25:13,230
the database dust and from the

415
00:25:13,230 --> 00:25:16,610
up 6% from text you as the rhythm nice
representation

416
00:25:16,610 --> 00:25:20,619
on normalized replantation of your
secret a month so

417
00:25:20,619 --> 00:25:26,809
if you have a look at that this is some
statement and

418
00:25:26,809 --> 00:25:30,369
this is the abstract syntax tree

419
00:25:30,369 --> 00:25:33,529
the slick niven idea last one so there's
some

420
00:25:33,529 --> 00:25:36,549
some or if you just have a look at the
database itself from

421
00:25:36,549 --> 00:25:39,990
the some more stuff home attached to
each note but

422
00:25:39,990 --> 00:25:43,460
we start with us LEC note then we have a
from list

423
00:25:43,460 --> 00:25:47,029
and over from those just references a
table

424
00:25:47,029 --> 00:25:51,669
which is stocks when we have a result
columnist which this title and abstract

425
00:25:51,669 --> 00:25:54,940
so these are reserved result columns and
these have

426
00:25:54,940 --> 00:25:58,960
like two columns or talk column
references and these are referencing

427
00:25:58,960 --> 00:25:59,389
some

428
00:25:59,389 --> 00:26:02,970
column names and then we have a wear
clothes

429
00:26:02,970 --> 00:26:06,080
and the way across is also industry
structure

430
00:26:06,080 --> 00:26:09,919
so with that in mind we have a look now

431
00:26:09,919 --> 00:26:13,649
at so we have this kind of structure for
sequined written

432
00:26:13,649 --> 00:26:17,090
and for Norman Siegel command and now we
want to have

433
00:26:17,090 --> 00:26:20,470
the effect of a sequence action
regarding their tree

434
00:26:20,470 --> 00:26:23,549
so basically if you just take that one

435
00:26:23,549 --> 00:26:28,090
then the attacker is basically and
that's the goal of the attack a

436
00:26:28,090 --> 00:26:31,440
is adding lot of notes to our tree right

437
00:26:31,440 --> 00:26:36,950
so we start off with all the green one

438
00:26:36,950 --> 00:26:40,200
and all the red one is all the stuff but
this added

439
00:26:40,200 --> 00:26:43,929
to the statement in the tree or to the
trio statement

440
00:26:43,929 --> 00:26:47,960
it can be to trees as well if we have a
look at the

441
00:26:47,960 --> 00:26:51,820
little Bobby tables from the very
beginning a good to me and those that

442
00:26:51,820 --> 00:26:52,279
just

443
00:26:52,279 --> 00:26:55,460
a semicolon starting a new table a new
command

444
00:26:55,460 --> 00:26:58,480
so we have some legal statement

445
00:26:58,480 --> 00:27:01,879
with probably some invalid values

446
00:27:01,879 --> 00:27:06,809
and we have a completely different and
completely destroyed nutri

447
00:27:06,809 --> 00:27:09,879
and there has been some work on that

448
00:27:09,879 --> 00:27:12,889
um by Gregory Poole Brewer

449
00:27:12,889 --> 00:27:17,990
and others and what they did was past
revalidation to prevent the projections

450
00:27:17,990 --> 00:27:21,379
so they the

451
00:27:21,379 --> 00:27:25,119
that knows to go to state such as such
that the injected

452
00:27:25,119 --> 00:27:28,350
snippets change the overall structure of
the query

453
00:27:28,350 --> 00:27:32,309
of the choir retreat and what they did
is what they try to

454
00:27:32,309 --> 00:27:35,950
compare the different reasons before and
after

455
00:27:35,950 --> 00:27:40,990
been searching abuser use outdated input
and they had some implementation could

456
00:27:40,990 --> 00:27:42,899
see forgot I haven't had a look at that

457
00:27:42,899 --> 00:27:46,369
ahead I had a look at that but the
didn't work out for me

458
00:27:46,369 --> 00:27:50,369
and them rest on side of this is

459
00:27:50,369 --> 00:27:54,230
it needs a change of the application
called to use

460
00:27:54,230 --> 00:27:57,289
that before and after induction of the
user

461
00:27:57,289 --> 00:28:02,529
import of a sequel statement and yeah I
do have a game for you

462
00:28:02,529 --> 00:28:06,789
if you need to change the database

463
00:28:06,789 --> 00:28:11,009
your application code for god sake
forget about this

464
00:28:11,009 --> 00:28:14,250
and stick to prepared statement this is

465
00:28:14,250 --> 00:28:18,340
my first we're number one which we had
and beginning the best place to fight

466
00:28:18,340 --> 00:28:22,019
sick rejectionist to secure your coat so
if you have to touch

467
00:28:22,019 --> 00:28:25,379
an eap any everyplace where you are
using

468
00:28:25,379 --> 00:28:28,399
sequel commands then just use

469
00:28:28,399 --> 00:28:32,340
book or a tray of using preferred
statement and you're probably safe more

470
00:28:32,340 --> 00:28:34,019
safer than using the absolution

471
00:28:34,019 --> 00:28:37,809
so back to bed

472
00:28:37,809 --> 00:28:42,740
back to the streets watched tree what
properties of the trees can we monitor

473
00:28:42,740 --> 00:28:43,059
or

474
00:28:43,059 --> 00:28:47,269
to are detect any structural changes

475
00:28:47,269 --> 00:28:51,730
so we have like two trees who left for
mister regular one and the right one is

476
00:28:51,730 --> 00:28:52,840
injected 1 okay

477
00:28:52,840 --> 00:28:56,309
and so we can for instance have a look
at the number of

478
00:28:56,309 --> 00:29:00,850
in a in a tree knows all the Blue Notes
in the tree nodes and on the left hand

479
00:29:00,850 --> 00:29:03,899
we have 9 in a in %uh notes on the right
hand

480
00:29:03,899 --> 00:29:07,500
we have 15 we can have a look at

481
00:29:07,500 --> 00:29:11,129
the leaf nodes on the left-hand with six
leave notes

482
00:29:11,129 --> 00:29:14,730
on the right and we have 10 and

483
00:29:14,730 --> 00:29:17,980
of course we also can use the height of
the tree so

484
00:29:17,980 --> 00:29:21,679
we have for rules 5

485
00:29:21,679 --> 00:29:25,539
I know we check hold us this came to all
the

486
00:29:25,539 --> 00:29:28,830
obfuscation the techa might do

487
00:29:28,830 --> 00:29:33,070
from if you want to evade detection

488
00:29:33,070 --> 00:29:36,750
in the and first frontally American

489
00:29:36,750 --> 00:29:40,070
pattern detection so a old

490
00:29:40,070 --> 00:29:43,090
tecum I just replaced this sequel

491
00:29:43,090 --> 00:29:46,889
one equals one who's always true
statement and tries to affix

492
00:29:46,889 --> 00:29:51,799
obfuscate this by using wrong P and
Braun PI and

493
00:29:51,799 --> 00:29:55,769
thats that kinda stuff so what this ends
up in

494
00:29:55,769 --> 00:30:01,000
is this statement all alone just creates
a new tree

495
00:30:01,000 --> 00:30:05,580
and just imagine business 123 456

496
00:30:05,580 --> 00:30:08,659
in the notes just effort by the
sophistication

497
00:30:08,659 --> 00:30:13,240
so in this way the more the attacker
tries to obfuscate

498
00:30:13,240 --> 00:30:16,369
the more you changes tree so

499
00:30:16,369 --> 00:30:20,039
just imagine this isn't always true
statement

500
00:30:20,039 --> 00:30:24,149
just imagine how big hole large the tree
is for that injection

501
00:30:24,149 --> 00:30:28,619
and this is just have subtree of the one
weds concerted

502
00:30:28,619 --> 00:30:32,639
so it's not like five to six anymore
it's like 52

503
00:30:32,639 --> 00:30:35,950
65 or something

504
00:30:35,950 --> 00:30:39,679
and the question we asked was how can we
use this to

505
00:30:39,679 --> 00:30:43,250
somehow %um detect attacks in art

506
00:30:43,250 --> 00:30:48,830
you know applications so we started off
with a very simple Java web application

507
00:30:48,830 --> 00:30:53,080
and because I didn't have access to any
production systems

508
00:30:53,080 --> 00:30:56,970
which allowed me to access the database
log files and

509
00:30:56,970 --> 00:31:01,480
so I a new to have some sort of prove
environment

510
00:31:01,480 --> 00:31:05,340
so what I used as a used to as my school
massacre back and

511
00:31:05,340 --> 00:31:08,970
I is highly a broom route to a secret
actions

512
00:31:08,970 --> 00:31:12,490
and his nose lost to specify the the
small

513
00:31:12,490 --> 00:31:16,570
simple mapping of you else to see former
see pic months

514
00:31:16,570 --> 00:31:19,940
along with that I can access to assume
this web shop

515
00:31:19,940 --> 00:31:23,470
and you're all the statements that have
a nice day to day to a great

516
00:31:23,470 --> 00:31:26,559
aggregated so is how it looks like this

517
00:31:26,559 --> 00:31:31,019
the typical setup you have some dwells
and use a map to see post it was

518
00:31:31,019 --> 00:31:34,590
and you could call these you else and
Bjork recuperating subs

519
00:31:34,590 --> 00:31:38,039
sort of basic baseline of your shop shop

520
00:31:38,039 --> 00:31:41,899
and how it's used so we generated some

521
00:31:41,899 --> 00:31:46,539
normal workload and then we attacked the
shop with sixty per map just to see

522
00:31:46,539 --> 00:31:50,059
all the difference this so we ended up
with the word 6,000

523
00:31:50,059 --> 00:31:54,259
from legal Pacific Coast League so long
two hundred

524
00:31:54,259 --> 00:31:57,379
a secret room commands and

525
00:31:57,379 --> 00:32:01,450
150 or 250 of them have been secret
column

526
00:32:01,450 --> 00:32:06,220
see projections using the sequel map a
tech to

527
00:32:06,220 --> 00:32:09,720
and now if you look at the distribution
of

528
00:32:09,720 --> 00:32:12,899
the number of in the nodes versus the
number of

529
00:32:12,899 --> 00:32:16,250
total no notes yeah total notes than

530
00:32:16,250 --> 00:32:21,740
you see this blue dot is the single
statement

531
00:32:21,740 --> 00:32:25,590
in I'm not injected way so as soon as we

532
00:32:25,590 --> 00:32:28,779
start injecting was super map start
injecting

533
00:32:28,779 --> 00:32:32,849
for sequel statement is modified and

534
00:32:32,849 --> 00:32:36,269
its spreading over just because it has
more notes in it

535
00:32:36,269 --> 00:32:40,330
okay there's a special from special one
which is

536
00:32:40,330 --> 00:32:44,009
which has like 200 note over here and
this is just

537
00:32:44,009 --> 00:32:47,070
all the statements which did not
validate

538
00:32:47,070 --> 00:32:50,399
against pos or so these can be just
easily attacked because

539
00:32:50,399 --> 00:32:54,740
they're just not valid sequel critical
commands okay

540
00:32:54,740 --> 00:33:00,309
and to make that a little bit more
visual I just added some jitter because

541
00:33:00,309 --> 00:33:03,690
the small dot on the law and is not just
one dot

542
00:33:03,690 --> 00:33:07,690
its just lot of dots so we added some
random

543
00:33:07,690 --> 00:33:10,929
glitter so from machine learning

544
00:33:10,929 --> 00:33:14,070
point of view now what would what would
you do

545
00:33:14,070 --> 00:33:18,909
you would wants to just cut off all the
attacks and that's what we did with some

546
00:33:18,909 --> 00:33:22,940
magic so what would would like to have
this is

547
00:33:22,940 --> 00:33:26,089
some sort of binary classifier so some

548
00:33:26,089 --> 00:33:29,990
function linear function which just
decides whether

549
00:33:29,990 --> 00:33:34,659
good I'm wet weather statement as on the
left on the left hand side on the on the

550
00:33:34,659 --> 00:33:36,720
good side or on the bad side

551
00:33:36,720 --> 00:33:40,549
just using this note covered

552
00:33:40,549 --> 00:33:44,190
so this is what we basically with my
prime primary drivers ed

553
00:33:44,190 --> 00:33:47,789
artificial intelligence department so
we're looking for simple basic bare

554
00:33:47,789 --> 00:33:49,329
binary classifier

555
00:33:49,329 --> 00:33:53,460
comparable to a nice base or something
this which you use for taking

556
00:33:53,460 --> 00:33:57,649
your spam mails and we split up all the

557
00:33:57,649 --> 00:34:04,190
recorded data we into one training data
training dataset and tests at

558
00:34:04,190 --> 00:34:08,669
on the training dataset we just train a
classifier

559
00:34:08,669 --> 00:34:13,200
and them on the test said we used the
classifier

560
00:34:13,200 --> 00:34:18,069
to test whether this is good for
detection or not

561
00:34:18,069 --> 00:34:21,329
and it turned out that it didn't work
rebound the first

562
00:34:21,329 --> 00:34:26,060
step so what to see yours

563
00:34:26,060 --> 00:34:30,770
this is the number of real this the real
reality and this is

564
00:34:30,770 --> 00:34:34,200
and this is the predictions so

565
00:34:34,200 --> 00:34:38,079
from all normalno Macquarie's or MoMA
Chris Henry

566
00:34:38,079 --> 00:34:42,770
have been correctly identified okay so
we have no false positives

567
00:34:42,770 --> 00:34:46,659
but there have been like 21 Chris which
happens

568
00:34:46,659 --> 00:34:52,129
percent or bicycle map which didn't have
been classified as normal traffic

569
00:34:52,129 --> 00:34:56,220
so that would would be like 21 missed
the text and

570
00:34:56,220 --> 00:34:59,390
the not what you want right so

571
00:34:59,390 --> 00:35:04,710
we're fine with that but this work to be
done on that side

572
00:35:04,710 --> 00:35:08,869
so we have a look at this and in the
first experiment with reran

573
00:35:08,869 --> 00:35:12,200
it was like we were using a.m. the
user-agent

574
00:35:12,200 --> 00:35:15,859
field of Sequim map just to identify
attacks and

575
00:35:15,859 --> 00:35:19,569
and Norma no McCrory's and it turns out
that seagrams at

576
00:35:19,569 --> 00:35:24,230
map also sense normal various just for
probing the application

577
00:35:24,230 --> 00:35:28,069
just for free rigging hardware which is
a dynamic government-owned

578
00:35:28,069 --> 00:35:31,260
which or which power meter changes

579
00:35:31,260 --> 00:35:36,160
the the results just to it check which
permitted can be injected

580
00:35:36,160 --> 00:35:40,349
so I'm we weren't went through all these
21

581
00:35:40,349 --> 00:35:43,770
men early and they were all clean
statement so there's

582
00:35:43,770 --> 00:35:47,650
just modern tech we created another

583
00:35:47,650 --> 00:35:51,670
from a second dataset and this time

584
00:35:51,670 --> 00:35:55,040
we had like to file 1200

585
00:35:55,040 --> 00:35:58,299
a statement or grammys and

586
00:35:58,299 --> 00:36:02,510
all of them were perfectly be Sep have
been perfectly separated just by

587
00:36:02,510 --> 00:36:07,420
counting the number of nodes just a note
here

588
00:36:07,420 --> 00:36:11,270
and this is just observing a singer
statement so

589
00:36:11,270 --> 00:36:14,849
a book that was just more of a proof of
concept is can we

590
00:36:14,849 --> 00:36:19,349
for one statement can we do from just
detect the texan's or modifications

591
00:36:19,349 --> 00:36:21,049
about statement just by using two

592
00:36:21,049 --> 00:36:24,829
two features the tree node if the node
count the nah not count

593
00:36:24,829 --> 00:36:28,599
and the total not come so this works

594
00:36:28,599 --> 00:36:31,720
for saying you owe but

595
00:36:31,720 --> 00:36:35,190
who does run replication of you

596
00:36:35,190 --> 00:36:38,190
with the singer you well nobody

597
00:36:38,190 --> 00:36:42,660
I'm surprised so what happens if we just
use

598
00:36:42,660 --> 00:36:46,950
the same setup false for queries

599
00:36:46,950 --> 00:36:50,109
so we just used

600
00:36:50,109 --> 00:36:53,579
all to perfect south and 200 51

601
00:36:53,579 --> 00:36:56,720
groceries & you won't want to have them
classified

602
00:36:56,720 --> 00:37:00,190
with a classifier 10 and it turned out
it didn't work

603
00:37:00,190 --> 00:37:05,140
so this just to few information just
using the tree

604
00:37:05,140 --> 00:37:09,510
tree count between not count so

605
00:37:09,510 --> 00:37:13,359
if you just paint that then you see that

606
00:37:13,359 --> 00:37:18,740
a.m. there's some rat ones which are
modifications of these

607
00:37:18,740 --> 00:37:22,279
which which were interleaved with other
legal statement so

608
00:37:22,279 --> 00:37:25,549
arm just using use to access is not
enough

609
00:37:25,549 --> 00:37:28,650
for classification

610
00:37:28,650 --> 00:37:32,500
but we have the power of trees so so far
we just knew

611
00:37:32,500 --> 00:37:35,880
you who used to hide in the number of
nodes in the tree

612
00:37:35,880 --> 00:37:40,130
and but we can do some more for instance

613
00:37:40,130 --> 00:37:44,160
if we use this tree often seek a command

614
00:37:44,160 --> 00:37:47,730
than this is the SN text really and we
can derive

615
00:37:47,730 --> 00:37:52,339
all the the edges of the tree for
instance we start with some it imaginary

616
00:37:52,339 --> 00:37:53,410
select Start

617
00:37:53,410 --> 00:37:56,690
start node and still not and start is
derived to

618
00:37:56,690 --> 00:38:00,160
select select is derived to result
columnist it

619
00:38:00,160 --> 00:38:04,079
yet result comes to from those two were
close we can use

620
00:38:04,079 --> 00:38:07,790
all these edges and

621
00:38:07,790 --> 00:38:11,089
week can and that way we can map the
tree

622
00:38:11,089 --> 00:38:14,529
into a high dimensional feature vector

623
00:38:14,529 --> 00:38:17,560
you to wreck to space so we just

624
00:38:17,560 --> 00:38:21,630
for its statement we created to the past
re and then we just counted

625
00:38:21,630 --> 00:38:25,819
how many how many edges to Posterous
have in common

626
00:38:25,819 --> 00:38:29,480
and the santa banta hai dimension tree
and again

627
00:38:29,480 --> 00:38:32,740
this is the same concept you use in your
you

628
00:38:32,740 --> 00:38:36,299
everyday use in your spam detection
mechanism

629
00:38:36,299 --> 00:38:41,390
so there's just sort of work work
director presentation

630
00:38:41,390 --> 00:38:44,890
turnout work pretty well so we just
ended up with

631
00:38:44,890 --> 00:38:48,500
almost all six thousand a statements

632
00:38:48,500 --> 00:38:51,609
being perfectly classified

633
00:38:51,609 --> 00:38:55,490
so with two missing 11 attacks that's
backed

634
00:38:55,490 --> 00:38:59,890
especially since the attacks so

635
00:38:59,890 --> 00:39:03,190
that's just learning I wasn't were used

636
00:39:03,190 --> 00:39:06,950
so we just had a look at what went wrong

637
00:39:06,950 --> 00:39:11,359
so this was one of the text which have
been automatically labeled as a tech

638
00:39:11,359 --> 00:39:13,000
bicycle map

639
00:39:13,000 --> 00:39:16,290
so just by the user agent and

640
00:39:16,290 --> 00:39:19,440
you would agree to me that this is a
valid statement right

641
00:39:19,440 --> 00:39:23,040
so it was just not an arab out the state
by by the classifier

642
00:39:23,040 --> 00:39:27,410
was true just incorrectly labeled by me
as an attack

643
00:39:27,410 --> 00:39:30,940
is just a probe of query so you don't
want to have that

644
00:39:30,940 --> 00:39:34,430
ass reported reported as as home

645
00:39:34,430 --> 00:39:37,829
attack so the kristof I was right

646
00:39:37,829 --> 00:39:41,319
this is another one and you see I am

647
00:39:41,319 --> 00:39:45,470
it looks like a tag and like an attack
and most almost every web application

648
00:39:45,470 --> 00:39:46,589
firewall would have

649
00:39:46,589 --> 00:39:49,609
complained it it's it is an attack

650
00:39:49,609 --> 00:39:52,970
but infect it doesn't are to the
statement

651
00:39:52,970 --> 00:39:56,930
because it doesn't break out of a break
out of the string

652
00:39:56,930 --> 00:40:00,460
I'm Apple Store for right so that's

653
00:40:00,460 --> 00:40:03,520
not an attack its legal Crary so

654
00:40:03,520 --> 00:40:07,259
once we corrected the and the arose

655
00:40:07,259 --> 00:40:10,690
some statements we rear-end

656
00:40:10,690 --> 00:40:14,980
the experiment and it showed up that
with the higher dimensional vector space

657
00:40:14,980 --> 00:40:20,839
we could perfectly separate all the
attacks from the norm a craze

658
00:40:20,839 --> 00:40:24,190
as a classifier east to support vector
machine and was like

659
00:40:24,190 --> 00:40:28,279
details about the a gruesome

660
00:40:28,279 --> 00:40:32,009
so what about real application

661
00:40:32,009 --> 00:40:35,440
and is a good question so the the
question with the

662
00:40:35,440 --> 00:40:41,220
application we tested this on was like
day more application and

663
00:40:41,220 --> 00:40:44,299
its sort of very small

664
00:40:44,299 --> 00:40:47,770
if you have any interest in validating
this on your product

665
00:40:47,770 --> 00:40:51,779
just sent you database lock file and I
will be happy to have a look

666
00:40:51,779 --> 00:40:55,270
proper you want yeah I

667
00:40:55,270 --> 00:41:00,660
its it's hard to get a a productive
environment to test this on but

668
00:41:00,660 --> 00:41:04,779
what we did is which kicked out title3
everybody anyone using

669
00:41:04,779 --> 00:41:09,980
type a free so thats content management
system which highly

670
00:41:09,980 --> 00:41:14,160
I'm relies on secretaries and basically
typo3 does

671
00:41:14,160 --> 00:41:17,160
use good Moscow database for everything

672
00:41:17,160 --> 00:41:20,540
for caching for like everything and

673
00:41:20,540 --> 00:41:24,160
a.m. we had like to 1,000 calories of
from

674
00:41:24,160 --> 00:41:27,250
in typo3 and we just change these

675
00:41:27,250 --> 00:41:31,180
various a in men really to create like
15

676
00:41:31,180 --> 00:41:34,509
artificial attacks and about ninety
percent of those

677
00:41:34,509 --> 00:41:37,790
have been detected perfectly but they're
so

678
00:41:37,790 --> 00:41:42,099
like 10 percent missing and

679
00:41:42,099 --> 00:41:46,259
or impression is that this is just
because we had

680
00:41:46,259 --> 00:41:49,430
1,000 crore is which happened created in
the rough

681
00:41:49,430 --> 00:41:52,460
in Iraq 5 but not about a type a free
itself

682
00:41:52,460 --> 00:41:55,790
is using like 500 different

683
00:41:55,790 --> 00:41:59,339
types of crows so from is really hot its

684
00:41:59,339 --> 00:42:03,109
really hard to distinguish between all
these crisp picture with just

685
00:42:03,109 --> 00:42:06,770
that small amount of training data so

686
00:42:06,770 --> 00:42:10,839
what we tried to do was we try to use

687
00:42:10,839 --> 00:42:14,239
a.m. to use to use home

688
00:42:14,239 --> 00:42:17,630
I getting someone and an impression on
how

689
00:42:17,630 --> 00:42:20,950
this relates to title for you as well

690
00:42:20,950 --> 00:42:24,500
so I'm will be used was from we try to

691
00:42:24,500 --> 00:42:28,029
get a visa visualization of your
database use

692
00:42:28,029 --> 00:42:32,830
so this is typo3 you have against you
never had a look at table for you this

693
00:42:32,830 --> 00:42:34,230
way

694
00:42:34,230 --> 00:42:38,390
basically this is the ideas behind this
graph is just

695
00:42:38,390 --> 00:42:41,940
its amuses the UC into im

696
00:42:41,940 --> 00:42:46,290
tree acquire it 3-2 compare the
difference between queries

697
00:42:46,290 --> 00:42:49,560
and just try to start grouping similar a
reason to

698
00:42:49,560 --> 00:42:52,700
into blocks like you see that

699
00:42:52,700 --> 00:42:57,009
this is a blob of statements visible
above statements

700
00:42:57,009 --> 00:43:00,319
if you if if you inspect these then you
see that

701
00:43:00,319 --> 00:43:03,700
all these other statements which are
using like a SELECT statements for

702
00:43:03,700 --> 00:43:04,210
looking

703
00:43:04,210 --> 00:43:07,799
in users these page cashers this is all

704
00:43:07,799 --> 00:43:11,060
all those statements from doing some
like

705
00:43:11,060 --> 00:43:15,029
user settings or something like this: so
did that makes sense

706
00:43:15,029 --> 00:43:18,290
that out when I was just a for
validation that

707
00:43:18,290 --> 00:43:21,500
our approach wasn't that bad

708
00:43:21,500 --> 00:43:25,330
you see that there are some isolated
excess and these are all

709
00:43:25,330 --> 00:43:29,270
the 4015 artificial attacks

710
00:43:29,270 --> 00:43:33,049
so these have not been related

711
00:43:33,049 --> 00:43:37,069
to any of the other attack group to
other secret command group

712
00:43:37,069 --> 00:43:41,220
with one exception so you we see that
the Schism

713
00:43:41,220 --> 00:43:45,869
secret statement and but and this is
modification of these statements

714
00:43:45,869 --> 00:43:49,500
and this is how again highly doubt that
Bruce

715
00:43:49,500 --> 00:43:52,660
compared to be you group statements

716
00:43:52,660 --> 00:43:57,380
so this is some some evidence that this
distance measure on trees is not a bad

717
00:43:57,380 --> 00:43:58,299
idea for a

718
00:43:58,299 --> 00:44:01,529
for doing so to investigating that

719
00:44:01,529 --> 00:44:06,759
so um basically that's it so

720
00:44:06,759 --> 00:44:10,950
home for as a first for summary a.m.

721
00:44:10,950 --> 00:44:14,259
we as take-home messages my medical

722
00:44:14,259 --> 00:44:17,440
my vertical take-home messages like a
successful

723
00:44:17,440 --> 00:44:20,849
secretary needs to offer the statement
which you already have in your database

724
00:44:20,849 --> 00:44:22,080
somehow

725
00:44:22,080 --> 00:44:25,410
I am this in some tactical approach of

726
00:44:25,410 --> 00:44:29,700
the analyzing sequined a sequel commands
on the back and

727
00:44:29,700 --> 00:44:33,040
for detecting I'm sick rejections is

728
00:44:33,040 --> 00:44:37,480
pretty promising because it escapes any
invasion text techniques an attacker

729
00:44:37,480 --> 00:44:38,069
might

730
00:44:38,069 --> 00:44:41,690
a ploy to employ to to evade your

731
00:44:41,690 --> 00:44:45,940
pattern detection defect victories Asian
of trees has been

732
00:44:45,940 --> 00:44:49,259
proving shown to be to show good results
on

733
00:44:49,259 --> 00:44:52,319
machine learning and stole there's roof
or

734
00:44:52,319 --> 00:44:55,420
room for improvement especially on more
on but more validation on real-world

735
00:44:55,420 --> 00:44:56,920
applications

736
00:44:56,920 --> 00:45:01,080
and yeah last eight minutes

737
00:45:01,080 --> 00:45:04,420
creating the powers of secret positive
for for

738
00:45:04,420 --> 00:45:09,089
sequel statement is like almost the
hardest part of the whole project

739
00:45:09,089 --> 00:45:13,290
or has been so

740
00:45:13,290 --> 00:45:16,619
to some if you're interested on some
comment on that

741
00:45:16,619 --> 00:45:19,900
and like in theory

742
00:45:19,900 --> 00:45:23,630
passing a sequel tribute fairly easy

743
00:45:23,630 --> 00:45:27,920
so there should be some yeah I will it
to fit five minutes

744
00:45:27,920 --> 00:45:32,290
thanks so in theory there should be a
gram of you for your database

745
00:45:32,290 --> 00:45:36,779
which saw defied all the valid
statements of your database

746
00:45:36,779 --> 00:45:40,009
system in practice um

747
00:45:40,009 --> 00:45:44,000
and you can use that grammar to create
to draw automatically generate the call

748
00:45:44,000 --> 00:45:45,739
to go to the POS a

749
00:45:45,739 --> 00:45:49,859
in practice a.m. creating the power

750
00:45:49,859 --> 00:45:53,839
like doing the machine learning his
penis over over creating part I hate

751
00:45:53,839 --> 00:45:58,589
had a look at several I'm statements
ever

752
00:45:58,589 --> 00:46:02,219
database systems first I i'm have a look
at

753
00:46:02,219 --> 00:46:05,710
mice most record so my my first approach
was

754
00:46:05,710 --> 00:46:08,730
okay there's open source database as I
can just use their POS a

755
00:46:08,730 --> 00:46:12,099
no first it doesn't use

756
00:46:12,099 --> 00:46:16,180
for it doesn't really external I so you
cannot use the excess apologists

757
00:46:16,180 --> 00:46:21,210
very tightly hidden deep into the MySQL
database

758
00:46:21,210 --> 00:46:24,250
I am and it's not easy to

759
00:46:24,250 --> 00:46:28,119
to get the pass into creating a past re
so he can a really easily create

760
00:46:28,119 --> 00:46:31,430
excess the past the final and others

761
00:46:31,430 --> 00:46:35,440
and a.m. some this is where you find the
powers of

762
00:46:35,440 --> 00:46:38,819
my sequel and

763
00:46:38,819 --> 00:46:42,469
was using mice months ago here

764
00:46:42,469 --> 00:46:45,799
was using Posterous

765
00:46:45,799 --> 00:46:50,710
if you have a look at these two files
you with which to prosperous

766
00:46:50,710 --> 00:46:55,020
owned the POS of my secure the big big
mess

767
00:46:55,020 --> 00:46:58,489
I never I will not use my secret anymore
because

768
00:46:58,489 --> 00:47:01,680
the against us so much people fooling
around with that code

769
00:47:01,680 --> 00:47:05,170
so I'm also have a look at prosperous
and

770
00:47:05,170 --> 00:47:08,480
if you adjust I'm a C++ program I have
to after admit I do

771
00:47:08,480 --> 00:47:11,770
just do everything in Java so it was
kinda hard to read

772
00:47:11,770 --> 00:47:15,339
so all the C book because and C code but

773
00:47:15,339 --> 00:47:18,580
compared to my sickle Posterous was like
heaven

774
00:47:18,580 --> 00:47:21,619
it was like almost a pure joy

775
00:47:21,619 --> 00:47:25,420
just walking through the code because it
well documented

776
00:47:25,420 --> 00:47:29,739
well structured and is her at really
cool and clean design

777
00:47:29,739 --> 00:47:33,119
documented and perfect so

778
00:47:33,119 --> 00:47:37,200
there was that this for me this is just
a far better choice

779
00:47:37,200 --> 00:47:40,640
there's some somewhat because I need to
have that in Java for

780
00:47:40,640 --> 00:47:43,700
I'm hooking up with my machine learning

781
00:47:43,700 --> 00:47:47,230
Ivory's so idea I was looking looking
for some

782
00:47:47,230 --> 00:47:51,279
parting stuff in Java person by in USA

783
00:47:51,279 --> 00:47:54,500
might have created in MC quote pass a
collection which is a

784
00:47:54,500 --> 00:47:57,730
to between set for a lot of different

785
00:47:57,730 --> 00:48:01,200
dialects like Oracle and so on those Jas

786
00:48:01,200 --> 00:48:04,279
see papa's project of

787
00:48:04,279 --> 00:48:07,930
often italian guy I don't know the real
name from

788
00:48:07,930 --> 00:48:12,170
of and basically what I did for for
these experiments I

789
00:48:12,170 --> 00:48:17,520
more if it modified the CJC godfather to
do some more positive than

790
00:48:17,520 --> 00:48:21,109
the road original has and does

791
00:48:21,109 --> 00:48:24,200
or available on get up so and although

792
00:48:24,200 --> 00:48:28,330
as well as the rest so if you have any
interest in running but coaches contact

793
00:48:28,330 --> 00:48:29,009
me and

794
00:48:29,009 --> 00:48:32,529
at all opens so that's it that's more

795
00:48:32,529 --> 00:48:35,730
well that was my presentation and you
free

796
00:48:35,730 --> 00:48:42,730
to have any questions

797
00:49:00,109 --> 00:49:03,150
and if you do in if not do a dried

798
00:49:03,150 --> 00:49:06,529
you can your effective to

799
00:49:06,529 --> 00:49:09,529
from what's called second or does the
projections

800
00:49:09,529 --> 00:49:12,999
so just imagine stop procedure using

801
00:49:12,999 --> 00:49:16,259
values of a database so yours

802
00:49:16,259 --> 00:49:20,849
you used you start a sequel a you
created store procedure which

803
00:49:20,849 --> 00:49:24,209
does do concatenate some other values
you

804
00:49:24,209 --> 00:49:29,039
have your in some other table so for the
tech I was able to inject

805
00:49:29,039 --> 00:49:34,549
simple commands into that other table
and just or procedure

806
00:49:34,549 --> 00:49:38,209
is concatenated the values you know

807
00:49:38,209 --> 00:49:41,319
that could just need to know about the
project that's called

808
00:49:41,319 --> 00:49:45,599
a second-order seek protection so

809
00:49:45,599 --> 00:49:50,109
if you just if you're managed to use
like prepared statement

810
00:49:50,109 --> 00:49:53,579
to a.m. prevent the first case them

811
00:49:53,579 --> 00:49:57,170
if I so Mike my my approach would be to

812
00:49:57,170 --> 00:50:01,049
just have a look at every place where
you just weird ways use

813
00:50:01,049 --> 00:50:04,390
a sequel and just stick to report said

814
00:50:04,390 --> 00:50:08,859
no

815
00:50:08,859 --> 00:50:13,979
but a.m. if the the cree is the store
procedure is using

816
00:50:13,979 --> 00:50:18,429
is relying on values are stored in the
database and these

817
00:50:18,429 --> 00:50:21,900
have not been properly stored than your

818
00:50:21,900 --> 00:50:25,719
you infertile okay

819
00:50:25,719 --> 00:50:30,679
then thanks for attending and if you
have any more questions

820
00:50:30,679 --> 00:50:36,519
just contact me after whack

