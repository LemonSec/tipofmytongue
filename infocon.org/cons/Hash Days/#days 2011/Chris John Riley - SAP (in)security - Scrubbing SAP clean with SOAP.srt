1
00:00:10,060 --> 00:00:13,000
with requests a page so if you

2
00:00:13,000 --> 00:00:16,000
learn about social engineering is a
better talking over

3
00:00:16,000 --> 00:00:19,030
arm

4
00:00:19,030 --> 00:00:20,360
so awful about myself

5
00:00:20,360 --> 00:00:21,640
I'm

6
00:00:21,640 --> 00:00:25,020
and Chris I do various stuff podcasting

7
00:00:25,020 --> 00:00:28,380
blogging percent I'm I'm a firm believer
that

8
00:00:28,380 --> 00:00:31,940
the wisest man is he who knows that he
knows nothing which is a really

9
00:00:31,940 --> 00:00:35,470
bastardized quote from Socrates arm

10
00:00:35,470 --> 00:00:39,280
and I'm certainly not an expert okay

11
00:00:39,280 --> 00:00:42,960
despite the fact that I hate the word
expert I'm

12
00:00:42,960 --> 00:00:47,320
I don't think anyone could be a expert
on SAP purely because

13
00:00:47,320 --> 00:00:50,440
the documentation sucks so

14
00:00:50,440 --> 00:00:54,680
I'm today we're going to talk about sir
SAP obviously what it is

15
00:00:54,680 --> 00:00:58,130
we're going to talk about your
information and information that you can

16
00:00:58,130 --> 00:00:58,430
get

17
00:00:58,430 --> 00:01:01,550
from an SAP system um we can know

18
00:01:01,550 --> 00:01:06,190
talk a little bit not getting in the
middle to make more sense later on

19
00:01:06,190 --> 00:01:09,280
more friends mess sell stuff just for
laughs well

20
00:01:09,280 --> 00:01:13,800
will put it all together and then we'll
be stopping pop is anyone here

21
00:01:13,800 --> 00:01:17,929
know bob was eventually met Bob no

22
00:01:17,930 --> 00:01:21,869
great so what's what SAP

23
00:01:21,869 --> 00:01:26,600
who's heard a basically damn

24
00:01:26,600 --> 00:01:30,880
I was hoping I could just say that farts
rainbows and unicorns running stuff

25
00:01:30,880 --> 00:01:34,740
but if you actually had a recipe is
gonna be aware problematic I'm

26
00:01:34,740 --> 00:01:37,819
I also learn asleep a while back

27
00:01:37,819 --> 00:01:41,670
shortly before the hair loss incident um

28
00:01:41,670 --> 00:01:44,860
I spent about 18 months reading books

29
00:01:44,860 --> 00:01:48,130
looking information pulling all my hair
out

30
00:01:48,130 --> 00:01:51,619
trying desperately to find anything
about a sleep aid I could

31
00:01:51,619 --> 00:01:55,580
I'm again back to the whole
documentation Sox committing

32
00:01:55,580 --> 00:01:59,259
I manager customer your customer but
conditions great

33
00:01:59,259 --> 00:02:03,179
jynona customer you get to this level
where you have to log on and then you

34
00:02:03,179 --> 00:02:03,979
just can't get past

35
00:02:03,979 --> 00:02:07,929
I'm as a bee describe themselves

36
00:02:07,929 --> 00:02:12,790
will bo hue is a BB gun selves the
world's leading provider of business

37
00:02:12,790 --> 00:02:13,290
software

38
00:02:13,290 --> 00:02:16,660
blah blah blah marked chipmunk ship

39
00:02:16,660 --> 00:02:19,910
everyone else describes them as the
world's leading opposed to

40
00:02:19,910 --> 00:02:21,349
business-critical information

41
00:02:21,349 --> 00:02:25,030
security a no problem and all hackers

42
00:02:25,030 --> 00:02:28,980
Mike get access to critical information
okay SAP

43
00:02:28,980 --> 00:02:32,190
at its core it does so much

44
00:02:32,190 --> 00:02:36,160
you got customer relationship management
you got as I like yesterday from FX's

45
00:02:36,160 --> 00:02:36,640
talk

46
00:02:36,640 --> 00:02:40,190
industrial control systems you know want

47
00:02:40,190 --> 00:02:43,480
SEP touching industrial control systems
um

48
00:02:43,480 --> 00:02:46,980
it does everything a bronze it once
banks

49
00:02:46,980 --> 00:02:51,670
it runs cock compliments you runs
manufacturing it runs

50
00:02:51,670 --> 00:02:56,140
ordering it once software runs
everything if you don't think SAP

51
00:02:56,140 --> 00:02:57,290
touches our lives

52
00:02:57,290 --> 00:03:01,870
then you're probably not paying
attention great so is it that bad

53
00:03:01,870 --> 00:03:05,180
a sleepy yeah

54
00:03:05,180 --> 00:03:08,730
and no you know ASAP like everything has
its issues

55
00:03:08,730 --> 00:03:14,260
you know its it had this is a a nautical
came out last year on

56
00:03:14,260 --> 00:03:17,660
there was a high sir 500 patches in one
go

57
00:03:17,660 --> 00:03:21,690
for SAP just imagine if Microsoft at
that you

58
00:03:21,690 --> 00:03:26,110
you Ryan and then install Linux on
reserves but a lot of pictures and

59
00:03:26,110 --> 00:03:29,530
ok by the way that this security patches
been just patch

60
00:03:29,530 --> 00:03:33,130
a security patches in toto in 2010

61
00:03:33,130 --> 00:03:37,460
anyone got a rough guide how many
patches and security patches

62
00:03:37,460 --> 00:03:42,380
SAP released in 2010 no

63
00:03:42,380 --> 00:03:45,900
the 900 to 1000 security pact

64
00:03:45,900 --> 00:03:49,310
and the question is is that is that a
good thing or a bad thing you can look

65
00:03:49,310 --> 00:03:50,760
at it from one point of view and say

66
00:03:50,760 --> 00:03:55,260
thousand patches wow what you smoking
you know when you wrote this code

67
00:03:55,260 --> 00:03:59,300
you know there's a lot of bugs in code
race between

68
00:03:59,300 --> 00:04:03,430
fifteen fifty bucks per thousand lines
have delivered code

69
00:04:03,430 --> 00:04:06,490
and as a lot code in SAP so

70
00:04:06,490 --> 00:04:10,140
you can look at it from the other point
of view thousand as thousand security

71
00:04:10,140 --> 00:04:10,760
patches

72
00:04:10,760 --> 00:04:14,569
may be there actually starting to fix
some other shit and

73
00:04:14,569 --> 00:04:17,720
I think their moving more towards

74
00:04:17,720 --> 00:04:21,470
actually fixing this stuff so hopefully
in about 15 years

75
00:04:21,470 --> 00:04:24,699
it's a people actually be a reliable
system so

76
00:04:24,699 --> 00:04:29,819
what's the problem now thousands and
thousands of controls

77
00:04:29,819 --> 00:04:34,020
switches buttons what button do I
flicked to turn on SSL

78
00:04:34,020 --> 00:04:40,469
no and does this button turn on good SSL
or SSL to using a week so I for

79
00:04:40,469 --> 00:04:44,520
you know this so much configuration so
many issues there

80
00:04:44,520 --> 00:04:47,979
we can't all be as a peaceful 2001

81
00:04:47,979 --> 00:04:52,249
SAP consultant sell their who also have
no idea what will be the ones that

82
00:04:52,249 --> 00:04:55,810
it is go in and install it go before yes

83
00:04:55,810 --> 00:04:59,349
yes yes Stifel done secure

84
00:04:59,349 --> 00:05:03,300
and the other problem is its part the
business you know

85
00:05:03,300 --> 00:05:07,349
SAP installations ball to the business
like it is business data

86
00:05:07,349 --> 00:05:11,599
the business system is a business
policies and business workflows

87
00:05:11,599 --> 00:05:15,560
I am NOT interested in your techie doing
anything on this

88
00:05:15,560 --> 00:05:19,439
its normal operations issue financial
data is part of the business

89
00:05:19,439 --> 00:05:23,430
so security never even touched thing you
know those vulnerabilities in their

90
00:05:23,430 --> 00:05:26,499
this configuration issues the best gonna
get his maybe

91
00:05:26,499 --> 00:05:30,650
an audit of whether or not this
separation privileges

92
00:05:30,650 --> 00:05:34,449
whether or not you've got lease practice
here

93
00:05:34,449 --> 00:05:37,770
only access to the the stuff that you
should have are you separating

94
00:05:37,770 --> 00:05:41,689
def production and testing when it
really comes to

95
00:05:41,689 --> 00:05:46,090
security testing it's just love

96
00:05:46,090 --> 00:05:49,710
so and a typical you can test them

97
00:05:49,710 --> 00:05:54,629
business-critical no everyone has heard
back

98
00:05:54,629 --> 00:05:59,409
you end up testing test system which has
been patched fixed

99
00:05:59,409 --> 00:06:02,419
you never actually touch the productive
system which they've never change

100
00:06:02,419 --> 00:06:03,840
because of a change it

101
00:06:03,840 --> 00:06:07,289
they know things are gonna break their
process is going to stop working

102
00:06:07,289 --> 00:06:12,400
and yet maybe the right I mean if their
entire organization runs on SAP

103
00:06:12,400 --> 00:06:16,430
if you take that system down as Papa
test if you not experience in SAP

104
00:06:16,430 --> 00:06:17,580
security

105
00:06:17,580 --> 00:06:22,330
you take this thing down for five
minutes because the company $50 million

106
00:06:22,330 --> 00:06:26,409
and I I wouldn't wanna risk my
reputation

107
00:06:26,409 --> 00:06:31,020
to take an SAP system down gonna gonna
cost $50 million

108
00:06:31,020 --> 00:06:35,719
and there's not many out there that
would so

109
00:06:35,719 --> 00:06:41,120
soap also success but who's up who's had
a soap

110
00:06:41,120 --> 00:06:44,419
very Packers should use more soap
collapsing

111
00:06:44,419 --> 00:06:48,509
I've been today yeah he stink

112
00:06:48,509 --> 00:06:52,180
used I'm hackers

113
00:06:52,180 --> 00:06:55,870
yeah okay hackers and so we all know
pack a smell specially when they go to

114
00:06:55,870 --> 00:06:56,779
conferences

115
00:06:56,779 --> 00:07:00,479
I'm simple object access protocol it's
been kinda

116
00:07:00,479 --> 00:07:04,969
phased out more I'm nowadays people tend
to use rest instead of so

117
00:07:04,969 --> 00:07:08,120
but SAP still use soap going

118
00:07:08,120 --> 00:07:11,259
so what are we talking about here SAP
NetWeaver

119
00:07:11,259 --> 00:07:15,499
which is the latest definition from SAP

120
00:07:15,499 --> 00:07:19,490
you go soap and a small amount of SAP
NetWeaver

121
00:07:19,490 --> 00:07:22,550
there's a number of different soap
interfaces when you start looking at

122
00:07:22,550 --> 00:07:23,550
security realm

123
00:07:23,550 --> 00:07:26,860
what we're talking about is the small
speck on the edge here

124
00:07:26,860 --> 00:07:31,270
SAP is such a large target miss so many
different soap interfaces

125
00:07:31,270 --> 00:07:34,779
you couldn't fit this into 3 day-long
workshop you know

126
00:07:34,779 --> 00:07:38,599
soap interface is it is member so

127
00:07:38,599 --> 00:07:42,460
talk a little bit about the soap
Management Console

128
00:07:42,460 --> 00:07:45,520
I'm it defaults running on 5

129
00:07:45,520 --> 00:07:49,279
instance number thirteen forty it's this
number simply you can run multiple

130
00:07:49,279 --> 00:07:51,330
instances on SAP book so it's not

131
00:07:51,330 --> 00:07:55,939
00 your one except except as a you gonna
have bear is different

132
00:07:55,939 --> 00:07:59,210
numbers here depending on what instance
you running crazy got multiple targets

133
00:07:59,210 --> 00:08:00,569
are running on the same machine

134
00:08:00,569 --> 00:08:03,629
you can use SSL and as we all know SSL
will save

135
00:08:03,629 --> 00:08:06,849
day so we'll stop everything

136
00:08:06,849 --> 00:08:11,770
but if it's configured to we'll talk a
little bit more about that later

137
00:08:11,770 --> 00:08:14,779
because is basic or yes

138
00:08:14,779 --> 00:08:18,020
2011 yes companies to use bicycle yes

139
00:08:18,020 --> 00:08:21,580
bicycle is still plain text you know

140
00:08:21,580 --> 00:08:25,069
we know this lot two different options
out there we could be using

141
00:08:25,069 --> 00:08:28,719
but it's scary and surprising how many
times you see them using no less

142
00:08:28,719 --> 00:08:32,300
still I'm and bicycle going so

143
00:08:32,300 --> 00:08:35,880
I'm not even sure whether use that for
still

144
00:08:35,880 --> 00:08:39,070
open dimension SAP is in the way the
full

145
00:08:39,070 --> 00:08:42,529
on all SAP systems so

146
00:08:42,529 --> 00:08:46,120
this isn't something that you have to go
in turn on and maybe even turn on the

147
00:08:46,120 --> 00:08:47,870
configured correctly you vulnerable

148
00:08:47,870 --> 00:08:51,760
this is on every single SAP system out
there by default

149
00:08:51,760 --> 00:08:55,340
um even on test boxes like download you
can

150
00:08:55,340 --> 00:08:59,020
dollar number a trial in just boxers for
Windows Linux

151
00:08:59,020 --> 00:09:03,230
and the only thing that runs on those by
the 40s at Management Council

152
00:09:03,230 --> 00:09:06,670
nothing else runs on the Muni to go in
and configure it means licenses

153
00:09:06,670 --> 00:09:10,370
to this even runs when your license is
expired which is great cuz you find what

154
00:09:10,370 --> 00:09:13,600
testing de boxes that discipline

155
00:09:13,600 --> 00:09:18,000
I'm the number different ways you can
interact with the management console

156
00:09:18,000 --> 00:09:21,660
you got that the typical sap MMC console

157
00:09:21,660 --> 00:09:25,440
I'm where you can have access to your
box although

158
00:09:25,440 --> 00:09:29,210
various functionality you can see how
you know its app system is running a

159
00:09:29,210 --> 00:09:31,450
moment and then you got Java

160
00:09:31,450 --> 00:09:34,650
all we should probably accept

161
00:09:34,650 --> 00:09:37,750
all expired in 2006

162
00:09:37,750 --> 00:09:40,760
/url a problem I'm sure if we accept
it'll be fine

163
00:09:40,760 --> 00:09:44,150
stuff they for them alone a man in the
middle man

164
00:09:44,150 --> 00:09:48,000
I'm you get the same basic thing for
driver and we love jobbers bitches

165
00:09:48,000 --> 00:09:50,790
attackers can say we don't realize Java
wrapper

166
00:09:50,790 --> 00:09:54,980
a kid and I somewhere

167
00:09:54,980 --> 00:09:58,490
so information is king

168
00:09:58,490 --> 00:10:03,050
and special comes to SAP am SEP likes to
give you information

169
00:10:03,050 --> 00:10:07,100
it's a very friendly system

170
00:10:07,100 --> 00:10:11,680
ironic I'm it specially with with SEP
management console you connect to this

171
00:10:11,680 --> 00:10:12,380
thing

172
00:10:12,380 --> 00:10:16,470
its gonna give you information whether
you like it you know you gonna send

173
00:10:16,470 --> 00:10:20,340
packets which can be page to page six
and i'll back

174
00:10:20,340 --> 00:10:23,750
the question isn't whether or not you
can get information out a veces SAP

175
00:10:23,750 --> 00:10:26,710
especially the management console the
question is whether or not you can

176
00:10:26,710 --> 00:10:29,260
filter through all of the information
that they provide to you

177
00:10:29,260 --> 00:10:32,390
and use it for anything useful because
there's so much there

178
00:10:32,390 --> 00:10:35,620
it hard to bring everything together
what do you look at first

179
00:10:35,620 --> 00:10:38,840
shiny things here shiny things there and
his shiny things

180
00:10:38,840 --> 00:10:42,370
me to dig in a little bit and connect
the dots and lines on the

181
00:10:42,370 --> 00:10:46,340
you how you've got root so

182
00:10:46,340 --> 00:10:50,190
down to it what go again at least

183
00:10:50,190 --> 00:10:54,890
this information into Sat many consul
version information

184
00:10:54,890 --> 00:10:58,780
will you get that from HTTP headers like
it's

185
00:10:58,780 --> 00:11:02,240
I'm but SAP

186
00:11:02,240 --> 00:11:05,860
in their wisdom provide large range for

187
00:11:05,860 --> 00:11:09,400
have information on what version you're
using I'm always down to the individual

188
00:11:09,400 --> 00:11:10,310
patch little

189
00:11:10,310 --> 00:11:13,510
you can say whether or not they've
installed this individual patch on the

190
00:11:13,510 --> 00:11:14,330
system

191
00:11:14,330 --> 00:11:16,870
you can tell whether or not it's running
into the architecture in Intel

192
00:11:16,870 --> 00:11:18,030
Architecture

193
00:11:18,030 --> 00:11:21,370
if it's an air x-box its Linux box

194
00:11:21,370 --> 00:11:24,300
like to give you the information because
it's needed for the management console

195
00:11:24,300 --> 00:11:26,970
the weather don't know whether or not to
make the little icon on the Windows box

196
00:11:26,970 --> 00:11:28,350
a little icon

197
00:11:28,350 --> 00:11:31,510
UNIX box so it's helpful for us here

198
00:11:31,510 --> 00:11:37,150
I'm before we dive in it does everyone
know what time it is what free-market

199
00:11:37,150 --> 00:11:40,970
me no the

200
00:11:40,970 --> 00:11:44,040
I'm not gonna going to mess by it's a
it's a framework for exploitation for

201
00:11:44,040 --> 00:11:45,690
anyone who hasn't heard

202
00:11:45,690 --> 00:11:48,930
I'm so great example of how we're gonna
run these modules

203
00:11:48,930 --> 00:11:52,450
these models are all now an ESPN as a

204
00:11:52,450 --> 00:11:55,570
five days ago some I'm simply

205
00:11:55,570 --> 00:11:59,090
specifying the more do you want to run
Sat management console version

206
00:11:59,090 --> 00:12:02,230
showing the options and setting you need
to their interest in here

207
00:12:02,230 --> 00:12:06,170
though they are hosts you can specify
multiple hosts here in Tysabri

208
00:12:06,170 --> 00:12:10,000
subnet or file when you can X is
everything

209
00:12:10,000 --> 00:12:14,050
and a rope or in this case for using 500
13 which is

210
00:12:14,050 --> 00:12:17,510
00 its because that's our before target

211
00:12:17,510 --> 00:12:21,830
when you get back from the management
console is a huge amount of XML which is

212
00:12:21,830 --> 00:12:25,510
must be passed into a couple lines have
interesting information

213
00:12:25,510 --> 00:12:29,140
you got the version information 720
patch seventy

214
00:12:29,140 --> 00:12:32,260
changeless 1203 58 I can say

215
00:12:32,260 --> 00:12:35,400
buried you know this thing like Stevie
information

216
00:12:35,400 --> 00:12:39,510
and cover basic information n/t Int 0
goes running Intel architecture you know

217
00:12:39,510 --> 00:12:41,500
it's running into the system

218
00:12:41,500 --> 00:12:45,370
by NT means Windows 2000 Windows 2003

219
00:12:45,370 --> 00:12:49,040
has XP in this case XP when it's
definitely

220
00:12:49,040 --> 00:12:53,910
127 you know it uses NT for everything
and you get this here

221
00:12:53,910 --> 00:12:57,290
sacked said from which

222
00:12:57,290 --> 00:13:01,970
is a standard three letters this case
and sp which is when we test mode

223
00:13:01,970 --> 00:13:06,290
I'm and is really useful for everything
we do with SAP

224
00:13:06,290 --> 00:13:10,140
so useful way pretty much turn it every
single time you ask any peace

225
00:13:10,140 --> 00:13:11,220
information

226
00:13:11,220 --> 00:13:14,610
so I'm what else can you get you get the
startup perform

227
00:13:14,610 --> 00:13:18,190
you get the instance name the set system
named succeed again

228
00:13:18,190 --> 00:13:21,980
database schema parts you can's even
check to see which version

229
00:13:21,980 --> 00:13:25,580
up database that uses for example he get
the exact

230
00:13:25,580 --> 00:13:29,400
Sat profile poss you can get the system
they became which Sep said

231
00:13:29,400 --> 00:13:33,500
get information about what the the ideas
and the instance name which is again is

232
00:13:33,500 --> 00:13:38,180
really helpful information you get

233
00:13:38,180 --> 00:13:42,310
now this is all free unauthenticated

234
00:13:42,310 --> 00:13:46,160
you need to provide any authentication
good

235
00:13:46,160 --> 00:13:51,130
yet City

236
00:13:51,130 --> 00:13:56,140
wheels yeah %uh server instance
environment this is this is also

237
00:13:56,140 --> 00:13:59,840
great stuff you ever run export all set

238
00:13:59,840 --> 00:14:04,490
when your box I'm just to be other
output the entire environment variables

239
00:14:04,490 --> 00:14:06,750
with the user to running this process

240
00:14:06,750 --> 00:14:10,700
for Environment lays down to individual
from Asian about databases

241
00:14:10,700 --> 00:14:14,140
you go he obviously the the various
piece of information about whether not

242
00:14:14,140 --> 00:14:17,840
system 32 during a 32 bit system what
system name is

243
00:14:17,840 --> 00:14:21,070
the database type in this case ADA which
says the using a

244
00:14:21,070 --> 00:14:24,190
asap DB

245
00:14:24,190 --> 00:14:27,730
here would also say things like or of
Oracle more

246
00:14:27,730 --> 00:14:31,340
MSS a plea for him Microsoft sequel

247
00:14:31,340 --> 00:14:34,860
it's also going to give information
about the username

248
00:14:34,860 --> 00:14:37,890
this here key piece information this is

249
00:14:37,890 --> 00:14:41,600
the username the your request to be
runners

250
00:14:41,600 --> 00:14:44,690
so you already have half of the
information we need to brute-force

251
00:14:44,690 --> 00:14:45,870
access to the system

252
00:14:45,870 --> 00:14:48,880
we now know what the city's we know what
database it is

253
00:14:48,880 --> 00:14:53,040
we know without using powershell and we
know the username

254
00:14:53,040 --> 00:14:56,950
Metairie really important okay I'm

255
00:14:56,950 --> 00:15:00,550
sack blocks and trace files little
background on this I'm

256
00:15:00,550 --> 00:15:03,810
if you have a developer existing system
there

257
00:15:03,810 --> 00:15:08,280
usually coding in a bit Java depending
on which version using

258
00:15:08,280 --> 00:15:11,630
they have any kind of problems with the
coding that

259
00:15:11,630 --> 00:15:15,310
turn on debugging it saves it to debug
look for

260
00:15:15,310 --> 00:15:18,380
developed races so every time they get
an error

261
00:15:18,380 --> 00:15:22,390
it outputs exactly what I was doing
people like a sequel request or username

262
00:15:22,390 --> 00:15:23,550
password

263
00:15:23,550 --> 00:15:27,310
or a connection attempt to an external
box now puts

264
00:15:27,310 --> 00:15:30,620
a number of interesting parameters a
great for developers

265
00:15:30,620 --> 00:15:33,820
I'm also great for penetration testers

266
00:15:33,820 --> 00:15:37,000
especially when you can list log files

267
00:15:37,000 --> 00:15:41,840
unauthenticated remotely to simply
log-on run this is going to give you a

268
00:15:41,840 --> 00:15:46,870
an entire list upload files whether
those a startup files

269
00:15:46,870 --> 00:15:50,130
de VCM no i cm which is

270
00:15:50,130 --> 00:15:54,060
internet connection manager which is the
HTTP HTTPS

271
00:15:54,060 --> 00:15:57,240
front and for SAP systems you get so
much

272
00:15:57,240 --> 00:16:01,580
valuable information in this is a basic
develop a traceable to me there's not

273
00:16:01,580 --> 00:16:03,550
many developers on my chest

274
00:16:03,550 --> 00:16:07,560
because I conquered neighbor I'm but its
simple stuff like this

275
00:16:07,560 --> 00:16:11,430
allocating memory must be useful if you
tryna

276
00:16:11,430 --> 00:16:14,460
to a buffer overflow to know where
things are looking a memory

277
00:16:14,460 --> 00:16:19,680
not idea buffer overflow expert I'm sure
that could come in handy later

278
00:16:19,680 --> 00:16:23,240
any other stuff as well like the the
syslog responses you get

279
00:16:23,240 --> 00:16:27,630
when things started what the pit number
is and exactly what version división

280
00:16:27,630 --> 00:16:28,620
the using

281
00:16:28,620 --> 00:16:32,010
I'm which is also a really good
specially for targeted attacks

282
00:16:32,010 --> 00:16:35,740
I'm things where you really wanna dig
down and figure out exactly what they're

283
00:16:35,740 --> 00:16:37,690
running over my system

284
00:16:37,690 --> 00:16:41,100
things like missus going to use

285
00:16:41,100 --> 00:16:45,500
so I'm what else is in those low price
in this golden those log files every

286
00:16:45,500 --> 00:16:46,670
time there's an error in the system

287
00:16:46,670 --> 00:16:51,110
someone put in a log file for someone
types in their use in a row

288
00:16:51,110 --> 00:16:55,060
what appears in the low 40 issues in a
blog been incorrectly

289
00:16:55,060 --> 00:16:58,330
great so on active production box

290
00:16:58,330 --> 00:17:02,150
we're gonna we're gonna log in well
Logan's

291
00:17:02,150 --> 00:17:05,610
gonna connect freely and without
authentication

292
00:17:05,610 --> 00:17:09,339
and what is gonna download the error log
file scrape it and see what use them to

293
00:17:09,339 --> 00:17:10,079
their

294
00:17:10,079 --> 00:17:13,990
so you go is 10 entries that have been
found on a test books

295
00:17:13,990 --> 00:17:19,549
pasta around this time productively got
1,735

296
00:17:19,549 --> 00:17:23,579
you so he have a list valid SAP user
names

297
00:17:23,579 --> 00:17:26,770
theoretically ballad they could mistyped
the usually

298
00:17:26,770 --> 00:17:31,960
you can just go through this I guarantee
you if you have 1,735 use names

299
00:17:31,960 --> 00:17:35,880
someone has said user name to the same
is that possible

300
00:17:35,880 --> 00:17:39,740
always awesome some just waiting to

301
00:17:39,740 --> 00:17:44,370
so now you got you got the username that
the entire

302
00:17:44,370 --> 00:17:47,780
Sat management consoles running on which
is an administrative user

303
00:17:47,780 --> 00:17:52,360
you got list a valid SAP account names

304
00:17:52,360 --> 00:17:55,850
you got their entire environment you can
look at the log files

305
00:17:55,850 --> 00:18:00,190
and if you're lucky you can find sequel
queries you can find database structures

306
00:18:00,190 --> 00:18:01,410
you can find

307
00:18:01,410 --> 00:18:05,970
huge amount golden 6 going so what else
can we get

308
00:18:05,970 --> 00:18:10,570
process parameters that we've if
anyone's ever dealt with ASAP

309
00:18:10,570 --> 00:18:15,870
process parameters are basically the
entire configuration SAP

310
00:18:15,870 --> 00:18:19,430
it everything its its

311
00:18:19,430 --> 00:18:22,809
list love how SAP works

312
00:18:22,809 --> 00:18:26,830
paths user names configuration variables

313
00:18:26,830 --> 00:18:31,450
names everything you want so we've got a
list the recipe uses

314
00:18:31,450 --> 00:18:35,670
what can we do with our we can pull out
the the process parameters

315
00:18:35,670 --> 00:18:40,320
and his this is an example because the
actual list that outputs

316
00:18:40,320 --> 00:18:43,650
is again thousands and thousands of
lines make some

317
00:18:43,650 --> 00:18:47,020
so a I feel to the login password

318
00:18:47,020 --> 00:18:50,530
simple rejects about this uses

319
00:18:50,530 --> 00:18:53,800
a specific josette the hash algorithm

320
00:18:53,800 --> 00:18:57,190
the encoding uses show 1

321
00:18:57,190 --> 00:19:00,900
it's kinda depressing show 1 it's going
to be really hard

322
00:19:00,900 --> 00:19:04,420
first the brute force likely enough it
uses there were compatible

323
00:19:04,420 --> 00:19:07,550
there were compatible passwords which
means

324
00:19:07,550 --> 00:19:10,710
long which are one it was a pretty in a
plane and defy for you which is really

325
00:19:10,710 --> 00:19:12,140
handy

326
00:19:12,140 --> 00:19:16,520
arm not only that but this downward
compatibility mode means that

327
00:19:16,520 --> 00:19:19,870
if you log in with anyone have

328
00:19:19,870 --> 00:19:23,540
these SAP users that we failed

329
00:19:23,540 --> 00:19:28,520
you if they're password is 25 characters
long

330
00:19:28,520 --> 00:19:32,480
and upper/lower case a backward
compatibility mode means

331
00:19:32,480 --> 00:19:36,210
you can also login with the first eight
characters as long as it's all upper

332
00:19:36,210 --> 00:19:37,630
case

333
00:19:37,630 --> 00:19:40,950
so and I'm hashes all over again

334
00:19:40,950 --> 00:19:44,180
thanks thanks for coming so

335
00:19:44,180 --> 00:19:46,960
we've already found quite a lot of
information this is like a gold mine and

336
00:19:46,960 --> 00:19:47,640
this is

337
00:19:47,640 --> 00:19:51,580
this is stuff that even s won't find on
this is will put as

338
00:19:51,580 --> 00:19:55,230
yeah it's kinda below Sony information
insists

339
00:19:55,230 --> 00:19:58,360
says re good nation I'm

340
00:19:58,360 --> 00:20:01,430
you also get things like log directories
you know

341
00:20:01,430 --> 00:20:05,440
you invalid login attempts to block user
okay now I know I can try

342
00:20:05,440 --> 00:20:09,010
for before you reset the counter

343
00:20:09,010 --> 00:20:12,430
okay and the council SAP resets at
midnight

344
00:20:12,430 --> 00:20:16,520
so just before midnight

345
00:20:16,520 --> 00:20:19,960
you do five attempts and you lock the
user and if the settings to

346
00:20:19,960 --> 00:20:21,080
automatically unlock

347
00:20:21,080 --> 00:20:24,740
a midnight the usual unlock and you can
try five attempt again

348
00:20:24,740 --> 00:20:28,290
if you know the configuration you know
whether or not

349
00:20:28,290 --> 00:20:31,540
Alta la calle fails use the lock been
passwords

350
00:20:31,540 --> 00:20:36,090
yeah length parts which are set you've
got all this information

351
00:20:36,090 --> 00:20:41,100
so basically you can do a white box test
while you doing a black box too

352
00:20:41,100 --> 00:20:44,760
it's great so you can always order thing
stuff even though you doing a black box

353
00:20:44,760 --> 00:20:47,179
test from external

354
00:20:47,179 --> 00:20:53,270
so a quick demo this works

355
00:20:53,270 --> 00:20:59,820
so trust me the animation to go long
time

356
00:20:59,820 --> 00:21:03,340
so I got here little SAP box running on
Windows XP

357
00:21:03,340 --> 00:21:07,580
which is only using about 6 gigabytes
memory

358
00:21:07,580 --> 00:21:10,590
and I have here Metasploit

359
00:21:10,590 --> 00:21:15,250
which I upgraded from yesterday I
believe 28 so

360
00:21:15,250 --> 00:21:20,860
yesterday on do a quick search on Sep
management

361
00:21:20,860 --> 00:21:24,050
give you an overview the the models that
are in a moment

362
00:21:24,050 --> 00:21:28,580
quickly kisses found them

363
00:21:28,580 --> 00:21:32,120
August thousands of these things right
here okay so if you want to look at

364
00:21:32,120 --> 00:21:33,150
these modules you got

365
00:21:33,150 --> 00:21:36,740
instance control properties you go
console log files you've got star

366
00:21:36,740 --> 00:21:38,620
profiles were in information

367
00:21:38,620 --> 00:21:41,980
so does the quick

368
00:21:41,980 --> 00:21:48,870
skins management vision

369
00:21:48,870 --> 00:21:52,770
so woody specified the remote host which
is host with targeting

370
00:21:52,770 --> 00:21:56,110
and the remote poor and its easy as

371
00:21:56,110 --> 00:21:59,470
run they go so

372
00:21:59,470 --> 00:22:03,020
we get the version information the patch
to change list everything we %uh the

373
00:22:03,020 --> 00:22:03,630
SAPS it

374
00:22:03,630 --> 00:22:08,120
and this literally huge amounts

375
00:22:08,120 --> 00:22:11,270
information to be had here so

376
00:22:11,270 --> 00:22:16,830
this blog files was locals

377
00:22:16,830 --> 00:22:20,980
I'm sure in one of these developers
gonna be some really interesting stuff

378
00:22:20,980 --> 00:22:24,500
some stuff that you really can be aching

379
00:22:24,500 --> 00:22:28,500
aching to read

380
00:22:28,500 --> 00:22:32,500
yeah basically all you do is specify the
log file arm

381
00:22:32,500 --> 00:22:36,210
this to two models one called early slow
pulse

382
00:22:36,210 --> 00:22:43,210
will show you the

383
00:22:43,780 --> 00:22:48,480
I am not specifically no so

384
00:22:48,480 --> 00:22:52,920
Illinois is get log files

385
00:22:52,920 --> 00:22:56,190
so so

386
00:22:56,190 --> 00:22:59,580
get options again it defaults to the
store sap start the log

387
00:22:59,580 --> 00:23:03,570
which is the the configuration whenever
it starts operates a log

388
00:23:03,570 --> 00:23:07,050
simply run and it downloads faulty loot

389
00:23:07,050 --> 00:23:10,930
to check in loot is trace files

390
00:23:10,930 --> 00:23:15,600
information you can then simply just use
XML do

391
00:23:15,600 --> 00:23:21,600
work

392
00:23:21,600 --> 00:23:23,960
week

393
00:23:23,960 --> 00:23:27,779
bibles Chisholm fortunately best
available

394
00:23:27,779 --> 00:23:33,420
X middle-ground him

395
00:23:33,420 --> 00:23:37,000
so I'm in OC the question they yeah
there's a possibility that I think down

396
00:23:37,000 --> 00:23:37,450
which'll

397
00:23:37,450 --> 00:23:41,090
such a little bit later um but not tie
it down

398
00:23:41,090 --> 00:23:44,430
in a way that I would consider actually
say so I'm

399
00:23:44,430 --> 00:23:48,640
is a simple log when this is a small
version a lot they like to use XML

400
00:23:48,640 --> 00:23:52,890
so everything comes in XML format it is
simply told you when things started

401
00:23:52,890 --> 00:23:56,910
what the exact path profile is which is
a that profile here

402
00:23:56,910 --> 00:24:00,800
is the profile parameters that we
downloaded direct-mail

403
00:24:00,800 --> 00:24:04,090
I'm yeah this there's a

404
00:24:04,090 --> 00:24:11,090
host the information here which is jus
more than interesting so

405
00:24:13,440 --> 00:24:15,980
so information overload is all

406
00:24:15,980 --> 00:24:20,670
unauthenticated okay this there's no use
them password required axes any the

407
00:24:20,670 --> 00:24:22,090
information that would govern your
access

408
00:24:22,090 --> 00:24:27,340
but you have to be in the network right
yeah

409
00:24:27,340 --> 00:24:33,090
we have to be in the network I'm I
thought we had to be in the network to

410
00:24:33,090 --> 00:24:36,760
and I was really really hoping the

411
00:24:36,760 --> 00:24:40,070
people using SAP didn't

412
00:24:40,070 --> 00:24:43,780
decide that they want to put it out
there on the internet so I'm

413
00:24:43,780 --> 00:24:47,070
around small scan Austria

414
00:24:47,070 --> 00:24:50,520
so it's just a small IP range maybe

415
00:24:50,520 --> 00:24:53,680
you couple hundred thousand eyepiece and

416
00:24:53,680 --> 00:24:57,950
came up with a variety of SAP boxes you
know from

417
00:24:57,950 --> 00:25:01,650
I also didn't get arrested yet

418
00:25:01,650 --> 00:25:05,000
so I'm in total I i

419
00:25:05,000 --> 00:25:09,090
I stand on for individual ports mainly
because I wanted to

420
00:25:09,090 --> 00:25:12,380
order to get a feeling is 12 scanning
blindly for poor

421
00:25:12,380 --> 00:25:16,480
500 13 it could be anything to BS sage
running on that

422
00:25:16,480 --> 00:25:21,020
gays a fine scanning for sat through to
poor 3299

423
00:25:21,020 --> 00:25:26,450
sack gateway 3300 Sat Management Console
500 13

424
00:25:26,450 --> 00:25:30,040
partners are reporting for the SSO
version if they all come out around the

425
00:25:30,040 --> 00:25:32,010
same number like 2600

426
00:25:32,010 --> 00:25:35,520
then you can be pretty sure those a
recipe books

427
00:25:35,520 --> 00:25:40,470
because sending us in back at this point
sending

428
00:25:40,470 --> 00:25:44,430
you get the cynic back in OK their ports
open soon as i connect to it

429
00:25:44,430 --> 00:25:48,650
it starts to get a bit messy it is used
%ah connecting to the system's probing

430
00:25:48,650 --> 00:25:51,350
them in seeing if it really is set
Management Console

431
00:25:51,350 --> 00:25:55,300
if you can just check the version
information what point do you go from

432
00:25:55,300 --> 00:25:59,270
this is researching I'm just interested
to I'm fucking around with your

433
00:25:59,270 --> 00:26:01,710
production SAP box and you can assume
ownership

434
00:26:01,710 --> 00:26:04,910
I didn't really wanna see um

435
00:26:04,910 --> 00:26:08,380
but I did laugh I did laugh a.m.

436
00:26:08,380 --> 00:26:15,380
lot women so that me it's so

437
00:26:15,470 --> 00:26:19,720
HTTP so it's it's like a CBP

438
00:26:19,720 --> 00:26:23,360
a SOAP envelope um nomming for two

439
00:26:23,360 --> 00:26:27,340
there's no H Mac is nothing North
educational

440
00:26:27,340 --> 00:26:31,660
so is not even you connect from 500 13

441
00:26:31,660 --> 00:26:35,460
you get a response from the server

442
00:26:35,460 --> 00:26:39,180
to say well you gonna need the sampling
and it provided to you

443
00:26:39,180 --> 00:26:42,410
so and I'll touch on that in a minute
what's next

444
00:26:42,410 --> 00:26:46,460
getting in the middle this is something
I was working on getting quite manage to

445
00:26:46,460 --> 00:26:46,740
get

446
00:26:46,740 --> 00:26:51,310
fully finished um because it uses
bicycle vindication

447
00:26:51,310 --> 00:26:55,870
I'm Sat Management Console uses this
nice little window here

448
00:26:55,870 --> 00:27:01,290
in Java say you need to use ready
impossible doesn't even look like basic

449
00:27:01,290 --> 00:27:02,000
authentication

450
00:27:02,000 --> 00:27:05,990
because job grappler in the background
it's sending basic or

451
00:27:05,990 --> 00:27:09,340
but and willing to back we love SAP

452
00:27:09,340 --> 00:27:13,740
administrators think bases secure
because it's

453
00:27:13,740 --> 00:27:16,930
it's like all SAP Help school the logo
and everything look

454
00:27:16,930 --> 00:27:22,370
smallest SAP logo in the world I'm but
we basic of as we know

455
00:27:22,370 --> 00:27:27,260
its sends a request you get a response
telling you to basically piss off unless

456
00:27:27,260 --> 00:27:28,940
you've got the right username password

457
00:27:28,940 --> 00:27:33,770
you provide the cleartext password and
let you in

458
00:27:33,770 --> 00:27:37,740
I mean so what's to stop you from and
middling that nothing I mean

459
00:27:37,740 --> 00:27:40,740
this so many different ways the man in
the middle let me know

460
00:27:40,740 --> 00:27:44,170
I couldn't even for the ones lies with
the mother trying you proxy

461
00:27:44,170 --> 00:27:47,910
you use ages are paid off spoofing DNS
poisoning

462
00:27:47,910 --> 00:27:51,770
2001 possible ways you to sit in the
middle disconnection K

463
00:27:51,770 --> 00:27:55,200
depending on where you are in the world
where they are in the world there's a

464
00:27:55,200 --> 00:27:55,740
lot of stuff

465
00:27:55,740 --> 00:27:59,210
okay so what you to use in the middle
they make

466
00:27:59,210 --> 00:28:02,180
an unauthenticated request which they
always make because they need the

467
00:28:02,180 --> 00:28:03,920
version information too so you which

468
00:28:03,920 --> 00:28:07,770
kinda been like you need windows like
limit cycle well

469
00:28:07,770 --> 00:28:13,070
you simply reply back and say no I need
to use an impossible and if

470
00:28:13,070 --> 00:28:16,240
and if this stupid enough these uses

471
00:28:16,240 --> 00:28:19,450
I'm all they have it saved somewhere
poses

472
00:28:19,450 --> 00:28:23,830
somewhere in their browser by will send
it to you in cleartext

473
00:28:23,830 --> 00:28:27,930
going credentials for the win what are
these potentials that we get

474
00:28:27,930 --> 00:28:32,810
administrative credentials for us to do
whatever we want on the remote system

475
00:28:32,810 --> 00:28:37,280
more than we've what we've been doing
right now so instead of doing this

476
00:28:37,280 --> 00:28:42,390
we sit in the middle we get the request
we sent a response back saying no you

477
00:28:42,390 --> 00:28:44,040
need to offer that

478
00:28:44,040 --> 00:28:48,160
they send us the ortho Kon we start
doing a happy dance while we send on to

479
00:28:48,160 --> 00:28:50,600
Sapa let them go on a merry little way

480
00:28:50,600 --> 00:28:54,030
we've got a username and password that
we can use for whatever we want

481
00:28:54,030 --> 00:28:57,850
wat DigiNotar will save us

482
00:28:57,850 --> 00:29:02,920
SSL for the win surely if it s itself
nothing we can do about them

483
00:29:02,920 --> 00:29:07,070
I'm ignoring the fact that the job
applicants by 10 2002

484
00:29:07,070 --> 00:29:10,990
so I'm as a couple different ways the
SSO it implemented

485
00:29:10,990 --> 00:29:15,420
especially large infrastructure you got
stops on certs which a great

486
00:29:15,420 --> 00:29:18,660
for us support for them you got people

487
00:29:18,660 --> 00:29:22,330
that's device the force which isn't
really an option for SAP is mostly

488
00:29:22,330 --> 00:29:26,870
hardware devices they come with us
already embedded on them

489
00:29:26,870 --> 00:29:30,900
which is usually a asserts shared
between multiple devices

490
00:29:30,900 --> 00:29:34,850
she's also terrible object but little by
box project for that

491
00:29:34,850 --> 00:29:38,670
they poll will these devices and make
them available for download

492
00:29:38,670 --> 00:29:42,260
I'm isn't too pricey a you can sign your
own so essentially

493
00:29:42,260 --> 00:29:46,210
and I see this a lot I don't know what
you guys say but

494
00:29:46,210 --> 00:29:49,910
companies don't wanna pay for SSL certs
ballot this is also its inside their

495
00:29:49,910 --> 00:29:50,780
enterprise

496
00:29:50,780 --> 00:29:54,470
so they set up their own PKR because I
infrastructure

497
00:29:54,470 --> 00:29:58,590
based on their own sets which means
they're responsible for fix

498
00:29:58,590 --> 00:30:01,920
all they go externally did you know to
to the rescue SAP

499
00:30:01,920 --> 00:30:04,970
also offer the ability sign certs

500
00:30:04,970 --> 00:30:09,010
as a sole connections the SAP systems
much how many people use that

501
00:30:09,010 --> 00:30:12,270
but I trust I'm

502
00:30:12,270 --> 00:30:15,670
so how can we get in the middle you
impersonate the SSL

503
00:30:15,670 --> 00:30:19,340
in sounds and complex no

504
00:30:19,340 --> 00:30:22,940
as a module in Metasploit and a couple
days ago which

505
00:30:22,940 --> 00:30:26,020
great makes a arm uses this

506
00:30:26,020 --> 00:30:29,450
wonderful SE option to say expired
yesterday

507
00:30:29,450 --> 00:30:33,760
and Lacey skills pretty weak be be
surprised how many people just click on

508
00:30:33,760 --> 00:30:35,220
it like home

509
00:30:35,220 --> 00:30:38,570
those operations fools got to replace
the cert expired yesterday on this

510
00:30:38,570 --> 00:30:38,990
committee

511
00:30:38,990 --> 00:30:43,060
yes no phone I'm late secondly click yes

512
00:30:43,060 --> 00:30:48,070
you with guy but the whole SSL
impersonations a

513
00:30:48,070 --> 00:30:51,800
talk for another day but SSL is not
gonna save you in this case

514
00:30:51,800 --> 00:30:55,370
ksl has been beaten on a lot gay

515
00:30:55,370 --> 00:30:59,110
SSL is right now it's ready for the
fight cycle put all this together we've

516
00:30:59,110 --> 00:31:01,250
got all the pieces are SAP

517
00:31:01,250 --> 00:31:05,140
on where have we put all this together
because informations great

518
00:31:05,140 --> 00:31:08,250
we want OS execution

519
00:31:08,250 --> 00:31:11,250
set management costs console office and
of

520
00:31:11,250 --> 00:31:15,260
and OS execution function I'm

521
00:31:15,260 --> 00:31:19,100
when I asked them why they couldn't tell
me but I'm sure when they originally

522
00:31:19,100 --> 00:31:20,050
wrote the spectra

523
00:31:20,050 --> 00:31:23,750
thought it was going to be a great idea
so we have always execution we can run

524
00:31:23,750 --> 00:31:26,790
a command but wait a minute mission
impossible

525
00:31:26,790 --> 00:31:30,070
because we talked about men in the
middle we talked about basic or think a

526
00:31:30,070 --> 00:31:30,790
text

527
00:31:30,790 --> 00:31:34,200
you can sniff for you came in in the
middle it we've also got user name

528
00:31:34,200 --> 00:31:34,960
already

529
00:31:34,960 --> 00:31:38,460
we can brute force that use name
possible to me really simple

530
00:31:38,460 --> 00:31:42,450
I'm check I love the people posting its
rubber hose

531
00:31:42,450 --> 00:31:46,120
beat someone until they give them the
you the SAP user name password

532
00:31:46,120 --> 00:31:49,990
arm brute force is pretty simple a
couple of nice

533
00:31:49,990 --> 00:31:53,280
features we can put this accident will
automatically replace

534
00:31:53,280 --> 00:31:57,390
the the seed in the password so you set
the Sapp said

535
00:31:57,390 --> 00:32:00,640
and it will automatically try default
user names before passwords

536
00:32:00,640 --> 00:32:04,840
already conceived as the people whose
names and passwords when suddenly

537
00:32:04,840 --> 00:32:09,280
I'm you find one that works for that
mean

538
00:32:09,280 --> 00:32:14,809
whatever whatever you want

539
00:32:14,809 --> 00:32:16,230
it doesn't because

540
00:32:16,230 --> 00:32:19,610
these on SAP users these are operating
system uses

541
00:32:19,610 --> 00:32:23,860
so you have um for example Sep service
and SP

542
00:32:23,860 --> 00:32:27,210
is the user that we found previously won
animals

543
00:32:27,210 --> 00:32:30,210
gay in a Linux box that would be an SP
ATM

544
00:32:30,210 --> 00:32:33,289
in case they have standard user names

545
00:32:33,289 --> 00:32:36,929
but the passwords there's no kinda sap
Starr Pass

546
00:32:36,929 --> 00:32:40,149
various kinda week SAP user name
password

547
00:32:40,149 --> 00:32:45,740
combinations as far as I'm aware thats
yeah

548
00:32:45,740 --> 00:32:49,149
this is operating system of education
because this is

549
00:32:49,149 --> 00:32:52,220
OS authentication sis operating system
execution

550
00:32:52,220 --> 00:32:55,990
of indicates to the actual underlying
operating system itself so

551
00:32:55,990 --> 00:33:01,230
even if you've got SAP la calle if you
haven't got lockout enabled on your

552
00:33:01,230 --> 00:33:02,029
Linux box

553
00:33:02,029 --> 00:33:05,549
you can sit there and prove forces
password until you're blue in the face

554
00:33:05,549 --> 00:33:12,549
okay

555
00:33:13,840 --> 00:33:17,400
the no no they demanded in the face the
also uses

556
00:33:17,400 --> 00:33:21,360
I'm Windows or Linux or whatever the
underlying operating system is

557
00:33:21,360 --> 00:33:24,880
authentication let's not using SAP use
an impossible to talk

558
00:33:24,880 --> 00:33:27,940
is a feature in New Year in the
interface

559
00:33:27,940 --> 00:33:31,240
and where you can run SAP commands with
SAP itself

560
00:33:31,240 --> 00:33:36,060
back reports several litigation but this
is actually operating system user names

561
00:33:36,060 --> 00:33:36,650
passwords

562
00:33:36,650 --> 00:33:40,950
okay so the question is how well I
hardening their underlying

563
00:33:40,950 --> 00:33:41,720
infrastructure

564
00:33:41,720 --> 00:33:45,310
how well you got lookouts on your own on
your Linux box

565
00:33:45,310 --> 00:33:48,490
are they looking the administrator
account okay

566
00:33:48,490 --> 00:33:52,690
good even if the the user the brute
force like administrator for example

567
00:33:52,690 --> 00:33:55,800
it won't have the ability to run
operating system commands

568
00:33:55,800 --> 00:34:02,800
because in SAP doesn't have that right
someone correct group

569
00:34:09,800 --> 00:34:12,880
for SAP itself

570
00:34:12,880 --> 00:34:16,250
but doesn't apply to these these
accounts yes %uh the question was

571
00:34:16,250 --> 00:34:20,340
the the previous a username/password and
the previous usernames that we extracted

572
00:34:20,340 --> 00:34:22,470
from the locks our SAP user names itself

573
00:34:22,470 --> 00:34:26,090
we're looking now at the the operating
system user account just

574
00:34:26,090 --> 00:34:29,890
differently controlled as different
policies okay so

575
00:34:29,890 --> 00:34:33,510
you brute force the user name password
or you get it through using a man in the

576
00:34:33,510 --> 00:34:34,180
middle attack

577
00:34:34,180 --> 00:34:37,260
social engineering however you wanna go
about that he simply

578
00:34:37,260 --> 00:34:41,310
putting the information your institution
module tell you what command to run

579
00:34:41,310 --> 00:34:46,940
and it runs it gives you the app okay so
if it supports more purists it

580
00:34:46,940 --> 00:34:52,350
it's great but you know I don't want to
run one command I want full control of

581
00:34:52,350 --> 00:34:52,890
the system

582
00:34:52,890 --> 00:34:56,060
I'm if I want to run one commander in

583
00:34:56,060 --> 00:35:01,110
yeah but interpreter if you can run one
command

584
00:35:01,110 --> 00:35:04,840
you can get better going babes to go to
talk to

585
00:35:04,840 --> 00:35:08,470
is no sleeping bag I'm you encode the
payload you

586
00:35:08,470 --> 00:35:11,600
split it up into little chunks you shove
it into Windows

587
00:35:11,600 --> 00:35:15,110
stores in the file you decode it you
start it and you start winning

588
00:35:15,110 --> 00:35:19,340
going she does break it up into smaller
chunks you can provide over

589
00:35:19,340 --> 00:35:22,710
a SOAP requests run each individual
command

590
00:35:22,710 --> 00:35:25,880
to build up to payload cosas stuff
that's bill

591
00:35:25,880 --> 00:35:29,660
in sports officer stuff it's not that
hard to do

592
00:35:29,660 --> 00:35:36,660
so I'm quick demo getting the
temperature

593
00:35:42,530 --> 00:35:49,530
from women's

594
00:36:14,260 --> 00:36:21,260
point

595
00:36:45,579 --> 00:36:47,320
move

596
00:36:47,320 --> 00:36:54,320
you

597
00:36:58,670 --> 00:37:01,910
sorry this and just got acceptance media
roundup

598
00:37:01,910 --> 00:37:05,510
within

599
00:37:05,510 --> 00:37:08,770
so calls payload show options

600
00:37:08,770 --> 00:37:15,770
we're gonna have to do here is to set
the %ah host to attack books

601
00:37:15,800 --> 00:37:19,960
we set the user name which will be pro
forced jus Sep service

602
00:37:19,960 --> 00:37:23,880
in SB

603
00:37:23,880 --> 00:37:27,990
said password

604
00:37:27,990 --> 00:37:31,070
skis image

605
00:37:31,070 --> 00:37:38,070
okay so

606
00:37:49,570 --> 00:37:56,570
news

607
00:38:10,760 --> 00:38:15,450
so we should be doing exploit

608
00:38:15,450 --> 00:38:19,050
prayed search works okay so it's
connecting all those years break

609
00:38:19,050 --> 00:38:22,850
up the expo into smaller chunks which is
configurable depending on

610
00:38:22,850 --> 00:38:26,020
speedy connection them breaks everything
up

611
00:38:26,020 --> 00:38:30,100
for the final connection to the payload
and you end up getting a temperature

612
00:38:30,100 --> 00:38:36,620
min

613
00:38:36,620 --> 00:38:39,920
she jumped ahead cuz I actually had a a
nice slide

614
00:38:39,920 --> 00:38:46,750
tells you to clap so you know his point
backup plan in the event that it fails

615
00:38:46,750 --> 00:38:47,390
hideously

616
00:38:47,390 --> 00:38:50,730
almost it so you have to do that sodium

617
00:38:50,730 --> 00:38:54,340
so I'm stopping ball going

618
00:38:54,340 --> 00:38:58,880
the one who bob is we theoretically
nobody is bob is the

619
00:38:58,880 --> 00:39:04,060
invisible bad guy home person who breaks
into your systems and does everything

620
00:39:04,060 --> 00:39:05,520
the you don't want to do

621
00:39:05,520 --> 00:39:09,130
or able to do so if someone did
something bad bob did

622
00:39:09,130 --> 00:39:15,210
just for legal reasons I'm not saying
the Bob the Builder

623
00:39:15,210 --> 00:39:19,020
already bought the bell mister is evil

624
00:39:19,020 --> 00:39:23,970
evil hacker about and same round of

625
00:39:23,970 --> 00:39:27,090
so never know what he's doing so I'm

626
00:39:27,090 --> 00:39:31,950
fixing this why is your SAP Management
Console available from the internet why

627
00:39:31,950 --> 00:39:33,220
is this available to the world

628
00:39:33,220 --> 00:39:37,160
I'm remote

629
00:39:37,160 --> 00:39:40,840
yeah remote support because people need
to be able to

630
00:39:40,840 --> 00:39:45,590
remotely manage your productive
enterprise infrastructure

631
00:39:45,590 --> 00:39:48,680
from the beach okay

632
00:39:48,680 --> 00:39:54,470
yeah this this is this is the reason why
we can't have nice things

633
00:39:54,470 --> 00:39:58,000
yeah if you need to be a to provide

634
00:39:58,000 --> 00:40:01,670
5 administrators with the ability to
connect from home

635
00:40:01,670 --> 00:40:05,070
sit in the garden do they work remote
connect them

636
00:40:05,070 --> 00:40:08,880
somewhere on a firewall there needs to
be their specific

637
00:40:08,880 --> 00:40:13,300
IP's okay but from what i've seen these
things are just sit now they're ready to

638
00:40:13,300 --> 00:40:14,210
be connected to buy

639
00:40:14,210 --> 00:40:18,020
everyone in the world we maybe I'm wrong
cuz I scanned from

640
00:40:18,020 --> 00:40:23,580
Switzerland risk and the entirety of
Austria so maybe they blocked from China

641
00:40:23,580 --> 00:40:28,910
maybe they block from Russia I don't
know

642
00:40:28,910 --> 00:40:32,510
maybe you should check you know I just
going to get a random proxy in China and

643
00:40:32,510 --> 00:40:33,750
see whether I can connect to

644
00:40:33,750 --> 00:40:37,900
and trust me if an idiot like me can
find that shit then

645
00:40:37,900 --> 00:40:42,080
someone smarter than me is already in
the system's exploiting these on

646
00:40:42,080 --> 00:40:42,780
abilities

647
00:40:42,780 --> 00:40:46,490
home because stops the heart you

648
00:40:46,490 --> 00:40:51,050
so HTTP bad me terrible

649
00:40:51,050 --> 00:40:54,540
to bet HTTPS not quite as bad

650
00:40:54,540 --> 00:41:00,640
SSL still sucks but but what we've got
there's not a lot else we can do but

651
00:41:00,640 --> 00:41:03,000
please don't use of site search: that's
just stupid

652
00:41:03,000 --> 00:41:07,480
I'm SAP also fix this bug

653
00:41:07,480 --> 00:41:10,830
in sapno 143 known

654
00:41:10,830 --> 00:41:16,510
blah blah I'm unless your customer you
don't get access to this

655
00:41:16,510 --> 00:41:20,210
and in my personal research by don't
personally

656
00:41:20,210 --> 00:41:23,770
home half in SAP infrastructure that I
pay maintenance for

657
00:41:23,770 --> 00:41:27,470
so they don't want to give me access to
this Sat notes I haven't actually read

658
00:41:27,470 --> 00:41:28,110
with us

659
00:41:28,110 --> 00:41:31,390
officially unofficially

660
00:41:31,390 --> 00:41:35,870
I may have got a copy of it and may have
read it

661
00:41:35,870 --> 00:41:39,380
I'm best solution is to

662
00:41:39,380 --> 00:41:42,690
in force authentication for

663
00:41:42,690 --> 00:41:46,600
more than you do right now that's not
everything

664
00:41:46,600 --> 00:41:50,390
you can still get the version
information you can still get the status

665
00:41:50,390 --> 00:41:54,160
you can still get a number of things you
can force authentication earlier on in

666
00:41:54,160 --> 00:41:54,770
the process

667
00:41:54,770 --> 00:41:58,150
you can start downloading blocks which
is restates

668
00:41:58,150 --> 00:42:01,340
question I'm but also if you do not over
HTTP

669
00:42:01,340 --> 00:42:05,950
use to open a file horribly because it's
clear text in any one can stay fit

670
00:42:05,950 --> 00:42:09,920
uydess get username password earlier in
the process buses not gonna stop people

671
00:42:09,920 --> 00:42:10,820
from an intimidating

672
00:42:10,820 --> 00:42:15,680
connections okay bus SAP never turn
these things on by default

673
00:42:15,680 --> 00:42:19,260
so this fix when you install it will do
absolutely nothing

674
00:42:19,260 --> 00:42:23,810
into you go into 1 2001 configuration
options

675
00:42:23,810 --> 00:42:26,880
and say one steps here

676
00:42:26,880 --> 00:42:31,130
then you restart your productive box and
hope that it comes back up

677
00:42:31,130 --> 00:42:34,420
because if it doesn't you lost fifty
million every minute that is down

678
00:42:34,420 --> 00:42:39,660
so this blog will remain in SAP for a
number of years to come okay because

679
00:42:39,660 --> 00:42:41,410
people are not willing to take the

680
00:42:41,410 --> 00:42:44,570
this system's down into this kinda stuff
SAP is hard

681
00:42:44,570 --> 00:42:47,970
going I'm next steps for me

682
00:42:47,970 --> 00:42:50,990
I'm I'm working on smack in the middle
stuff I mean I talk to about man in the

683
00:42:50,990 --> 00:42:51,670
middle in here

684
00:42:51,670 --> 00:42:56,250
I've got a model that forces
authentication I'm

685
00:42:56,250 --> 00:42:59,830
it's not that hard to believe this in
the Middle English buybacks I know you

686
00:42:59,830 --> 00:43:02,100
need to give me his name password free
pass anything on

687
00:43:02,100 --> 00:43:06,140
on doesn't like POST request fortunately
which is something to work on

688
00:43:06,140 --> 00:43:09,670
I'm job rapid deployment is something
else I'm working on as well because

689
00:43:09,670 --> 00:43:13,300
if you connect to the web interface it
tries to shuffle a cuppa Java applets

690
00:43:13,300 --> 00:43:14,240
County

691
00:43:14,240 --> 00:43:17,290
and Abby really nice if one of them was
just a mess but Wenger

692
00:43:17,290 --> 00:43:21,240
that way you get access to the the guy
sitting on the beach during his

693
00:43:21,240 --> 00:43:25,730
administration and then you get all use
that password access from there

694
00:43:25,730 --> 00:43:30,070
game over um I'm also by looking at the
SAC SSL implementation

695
00:43:30,070 --> 00:43:35,850
could space it everyone else is this SSL
implementation really sucks

696
00:43:35,850 --> 00:43:38,910
so that's what I got

697
00:43:38,910 --> 00:43:45,910
questions you can throw things now like

698
00:43:47,080 --> 00:43:51,070
please

699
00:43:51,070 --> 00:43:55,050
blaming HTP for it I mean a.m. I i do

700
00:43:55,050 --> 00:43:59,300
I do see that those who some weakening
this at lot of weaknesses in HDPE

701
00:43:59,300 --> 00:44:02,380
traffic but do do you think that

702
00:44:02,380 --> 00:44:05,760
if they would be using any other
protocol there would be less

703
00:44:05,760 --> 00:44:08,830
spreading out information I mean a.m.

704
00:44:08,830 --> 00:44:12,180
they they doing this whom this spring
other information because

705
00:44:12,180 --> 00:44:16,090
they need to show the Aiken for the SEP
management console and some thinkers

706
00:44:16,090 --> 00:44:19,640
so I'm that's not HD piece for

707
00:44:19,640 --> 00:44:22,990
by no no but but they could easily do
this over another protocol which is

708
00:44:22,990 --> 00:44:24,170
secured by the full

709
00:44:24,170 --> 00:44:28,350
they could not over a they could use
client-side certificates that gives a

710
00:44:28,350 --> 00:44:30,030
number of secured ways

711
00:44:30,030 --> 00:44:33,420
yes cell is the coral colour solutions
that we use

712
00:44:33,420 --> 00:44:37,490
arm him 64 everything my simple

713
00:44:37,490 --> 00:44:42,400
coming here is such a critical piece %uh
view enterprise infrastructure

714
00:44:42,400 --> 00:44:46,619
should never ever ever for over HTTP

715
00:44:46,619 --> 00:44:51,800
to anything I don't care if it's
legitimate that's just stupid

716
00:44:51,800 --> 00:44:55,260
ago even SS will tell you that I hope

717
00:44:55,260 --> 00:44:58,290
I have another question like mister them

718
00:44:58,290 --> 00:45:01,480
it is a for a free diet trial for
downloading that a.m.

719
00:45:01,480 --> 00:45:04,500
a a the models know the SAP

720
00:45:04,500 --> 00:45:08,010
yeah there's a number a free models over
not a blog post on how much a pain in

721
00:45:08,010 --> 00:45:09,540
the ass is big SAP running

722
00:45:09,540 --> 00:45:12,500
and there's a number of links you can
download Windows versions you can

723
00:45:12,500 --> 00:45:15,070
download and explosions and you can
spend the next three and a half months

724
00:45:15,070 --> 00:45:15,820
try again

725
00:45:15,820 --> 00:45:20,440
demo version working I'm it's not the
nicest installer in the world

726
00:45:20,440 --> 00:45:23,900
okay so would you who be interested in
sharing

727
00:45:23,900 --> 00:45:29,040
virtual image I re-install written

728
00:45:29,040 --> 00:45:32,990
certainly am if you have just for
research if you have 60 gigabytes

729
00:45:32,990 --> 00:45:35,460
available space you can have the virtual
machine

730
00:45:35,460 --> 00:45:40,080
from my system %uh when it installs
itself it needs

731
00:45:40,080 --> 00:45:43,830
forgive much RAM the virtual memory

732
00:45:43,830 --> 00:45:49,520
or 16 gigabytes I believe 60 gigabytes
available space new disc

733
00:45:49,520 --> 00:45:53,260
I and English version of Windows to
Windows version

734
00:45:53,260 --> 00:45:56,690
you can check it with the German version
basically it's a pain in the ass

735
00:45:56,690 --> 00:46:01,930
okay arm like and even then mine is
limited to Sat Management Console

736
00:46:01,930 --> 00:46:04,660
because that's what I'm researching the
moment there's no license for anything

737
00:46:04,660 --> 00:46:05,060
else

738
00:46:05,060 --> 00:46:09,470
so but that this some to some good
downloading good links available on the

739
00:46:09,470 --> 00:46:09,869
blog

740
00:46:09,869 --> 00:46:13,640
and you can get them straight from from
SAP is a page you can find on their

741
00:46:13,640 --> 00:46:14,500
website so

742
00:46:14,500 --> 00:46:17,550
but woke me up later or show you exactly
where the link is

743
00:46:17,550 --> 00:46:24,390
need any other questions

744
00:46:24,390 --> 00:46:27,920
on your present is seen some web shops
build on

745
00:46:27,920 --> 00:46:30,920
some SAP stuff home when done pro

746
00:46:30,920 --> 00:46:33,920
you yeah um I we r any

747
00:46:33,920 --> 00:46:38,550
like remote so heartbeats excess the
same interface anything like that

748
00:46:38,550 --> 00:46:43,580
there's a number of soap interface is
some good stuff that term

749
00:46:43,580 --> 00:46:48,180
Jabra I'm has been doing what's rapid 72
working on some SAP stuff as well

750
00:46:48,180 --> 00:46:52,040
I'm not aware of any web Dynpro so stuff
that's built in

751
00:46:52,040 --> 00:46:55,040
you can deploy

752
00:46:55,040 --> 00:46:59,660
caplets through through soap with
respect to be NetWeaver

753
00:46:59,660 --> 00:47:02,950
that could then talk over so without
intimidating

754
00:47:02,950 --> 00:47:08,030
there by default because we also scan
the system's internal and saw all these

755
00:47:08,030 --> 00:47:11,080
20,000 open so ports and whatever

756
00:47:11,080 --> 00:47:14,140
going to prison yeah its

757
00:47:14,140 --> 00:47:18,640
Webdynpro is a is another thing entirely
there was presentation at this is broke

758
00:47:18,640 --> 00:47:19,390
on which goes

759
00:47:19,390 --> 00:47:22,570
quien depth on some other failures love
arm

760
00:47:22,570 --> 00:47:26,100
i cm ICS believes well in Webdynpro

761
00:47:26,100 --> 00:47:30,120
some serious bugs for this stuff is
going to the remote code execution style

762
00:47:30,120 --> 00:47:33,750
I don't like to they do all the cross
site scripting stuff just

763
00:47:33,750 --> 00:47:38,450
right long is a field where you put
texted if it's a drop down with a number

764
00:47:38,450 --> 00:47:42,420
they don't filter it'll so you just put
your payload into the drop downs that

765
00:47:42,420 --> 00:47:43,810
have number one through 10

766
00:47:43,810 --> 00:47:46,470
is that are expected to be anything else
than what was in the drop down a minute

767
00:47:46,470 --> 00:47:47,530
just execute when

768
00:47:47,530 --> 00:47:50,720
the verification fails I didn't tell you
that

769
00:47:50,720 --> 00:47:55,350
I was the only day that they've settled
drop it smells

770
00:47:55,350 --> 00:47:58,810
great we'll it was any other questions
feel free to grab me afterwards would

771
00:47:58,810 --> 00:48:00,800
like to thank everyone who helped me put
this thing together

772
00:48:00,800 --> 00:48:04,860
especially the dirty guys forgive me
feedback I don't know yet

773
00:48:04,860 --> 00:48:07,490
will so thanks coming sorry for sex

