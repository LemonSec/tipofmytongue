1
00:00:10,820 --> 00:00:14,410
so hi welcome everybody to my

2
00:00:14,410 --> 00:00:16,580
and right

3
00:00:16,580 --> 00:00:17,460
what I'm going to talk

4
00:00:17,460 --> 00:00:21,470
today is actually more less issues from
the past

5
00:00:21,470 --> 00:00:25,619
that's what a start with um I'm going a
little bit into

6
00:00:25,619 --> 00:00:29,149
the Android security and code concept

7
00:00:29,149 --> 00:00:33,180
and

8
00:00:33,180 --> 00:00:37,379
upwards I'm going to talk about
techniques for Penn testers and reverse

9
00:00:37,379 --> 00:00:38,059
engineers

10
00:00:38,059 --> 00:00:41,610
and in the end I hope that's the most
interesting part

11
00:00:41,610 --> 00:00:46,649
where a dive into some experiences and
generate coltie

12
00:00:46,649 --> 00:00:50,190
or perhaps what I experienced at least

13
00:00:50,190 --> 00:00:53,840
so

14
00:00:53,840 --> 00:00:57,079
my approach basically was I bought the
HTC Desire

15
00:00:57,079 --> 00:01:00,399
last year its it was on Android 2.0

16
00:01:00,399 --> 00:01:03,870
it's now updated to 220 and

17
00:01:03,870 --> 00:01:07,780
mmm yet my approach was of course
finding security related issues

18
00:01:07,780 --> 00:01:11,780
because I'm a pen tester so obviously
that's what I'm looking for

19
00:01:11,780 --> 00:01:15,860
am what let's start with the issues in
the past

20
00:01:15,860 --> 00:01:19,310
and basically I love people

21
00:01:19,310 --> 00:01:22,659
Aria losing their phones these days and

22
00:01:22,659 --> 00:01:26,439
it's getting closer to losing your
laptop because most people have like all

23
00:01:26,439 --> 00:01:27,880
the credentials and

24
00:01:27,880 --> 00:01:31,439
emails and everything on their mobile so

25
00:01:31,439 --> 00:01:36,100
um when I bought my htc desire for
testing purposes

26
00:01:36,100 --> 00:01:39,610
I bought it on ebay and when I got the
phone

27
00:01:39,610 --> 00:01:42,880
at the guy who sold it to me actually

28
00:01:42,880 --> 00:01:46,149
wiped it or affect to reset it but when
you do that

29
00:01:46,149 --> 00:01:50,600
there's actually a big pop up which says
yet the SD card is not going to be wiped

30
00:01:50,600 --> 00:01:54,799
and so of course he forgot to wipe the
SD card afterwards

31
00:01:54,799 --> 00:01:58,909
and I got all these private data like
your pictures and everything on it so

32
00:01:58,909 --> 00:02:02,420
first time I plugged it in ninety
already had I've dated someone else

33
00:02:02,420 --> 00:02:06,670
so there was quite ernie's beginning am

34
00:02:06,670 --> 00:02:10,369
and the next thing if you look at these
phones it

35
00:02:10,369 --> 00:02:14,310
is actually if his lock screens right
and as a pen test your skin

36
00:02:14,310 --> 00:02:17,920
want to you get around these lock
screens so

37
00:02:17,920 --> 00:02:22,440
I was looking for from one posted 01
possibilty for

38
00:02:22,440 --> 00:02:25,810
my phone and a Google around a little
bit

39
00:02:25,810 --> 00:02:29,329
and what a fun with ex lead that am

40
00:02:29,329 --> 00:02:32,389
on Android you have to drop pattern to
unlock the phone so

41
00:02:32,389 --> 00:02:36,579
you it's not a pin but that to
circumvent this

42
00:02:36,579 --> 00:02:41,620
I simply powered off first and as you
will see when I powered on again

43
00:02:41,620 --> 00:02:45,470
and it's a rooted phone you will see at
this at the splash screen

44
00:02:45,470 --> 00:02:49,079
that it's rude but newt it would also
work for non-root

45
00:02:49,079 --> 00:02:52,979
phones so pitches through two mines
though you will see the

46
00:02:52,979 --> 00:02:55,989
is blasting and what I'm doing right now
is um

47
00:02:55,989 --> 00:02:59,010
I'm hitting the year home button very

48
00:02:59,010 --> 00:03:02,750
very often and by fast due to start the
process all the time

49
00:03:02,750 --> 00:03:06,120
and well that's basic

50
00:03:06,120 --> 00:03:10,760
to hack as we will see so the I'm still
hitting the button and

51
00:03:10,760 --> 00:03:13,949
yet you have to be quite fast if to have
quell

52
00:03:13,949 --> 00:03:17,359
fast fingers and

53
00:03:17,359 --> 00:03:22,100
wherein with it meant

54
00:03:22,100 --> 00:03:26,430
lockscreen so yet it's actually quite
the

55
00:03:26,430 --> 00:03:29,850
funny start if you just have to go
around a lil bit and first

56
00:03:29,850 --> 00:03:33,440
the first national security's already
circumvent phone

57
00:03:33,440 --> 00:03:36,630
on first google it am

58
00:03:36,630 --> 00:03:40,209
so basically there are some other
techniques 01 is

59
00:03:40,209 --> 00:03:43,549
the the technique a just showed works
for

60
00:03:43,549 --> 00:03:48,009
not all brands but for some of them and
on Android 2.2 and

61
00:03:48,009 --> 00:03:51,030
you know am some also

62
00:03:51,030 --> 00:03:54,470
allowed to just press the back button
during call so

63
00:03:54,470 --> 00:03:58,239
you called phone pressed back button and
you also statement

64
00:03:58,239 --> 00:04:02,049
the lock screen and some allowed to

65
00:04:02,049 --> 00:04:06,220
just plugging into the car dock so you
take the phone

66
00:04:06,220 --> 00:04:10,269
plug it in and you have access to the
phone

67
00:04:10,269 --> 00:04:13,600
and what is also a feature

68
00:04:13,600 --> 00:04:18,169
is that when you actually forgot your
girl

69
00:04:18,169 --> 00:04:22,870
lock pattern you can type in your lock
button twenty times incorrectly

70
00:04:22,870 --> 00:04:26,610
and the need to last for each email
address and password and

71
00:04:26,610 --> 00:04:30,130
in the beginning it was incorrectly
implemented so you

72
00:04:30,130 --> 00:04:34,819
specified to correct gmail address but
as the password you just typed in

73
00:04:34,819 --> 00:04:38,039
now and it worked so

74
00:04:38,039 --> 00:04:41,409
there was also bucks it's now fixed um

75
00:04:41,409 --> 00:04:44,840
well and of course a lot of people just
don't have

76
00:04:44,840 --> 00:04:49,340
no lockscreen activate thats also so he
fanned phone just

77
00:04:49,340 --> 00:04:52,590
first was most of them are like it

78
00:04:52,590 --> 00:04:56,039
to scan access them without any security
message still

79
00:04:56,039 --> 00:05:01,210
and another thing is a lot of people
have fuse BD but on so that means

80
00:05:01,210 --> 00:05:04,530
if like you a.m. did ebook

81
00:05:04,530 --> 00:05:07,819
feature is enabled the can disconnect
your ATV shell

82
00:05:07,819 --> 00:05:13,740
a TV show is basically I'm like SSH over
at the USB cable

83
00:05:13,740 --> 00:05:16,759
and another way to circumvent it is of
course

84
00:05:16,759 --> 00:05:19,979
yes if you note yes it did Google
account to Gmail

85
00:05:19,979 --> 00:05:25,229
address and password because yeah courts
now it's fixed but then you can't just

86
00:05:25,229 --> 00:05:28,509
and draw the patent twenty times
incorrectly and two gmail address and

87
00:05:28,509 --> 00:05:30,740
password and you re

88
00:05:30,740 --> 00:05:35,120
and some milestone before Android 2.1
had also

89
00:05:35,120 --> 00:05:39,009
a buck in the boot Laurel loader so he
could just them

90
00:05:39,009 --> 00:05:42,999
though it is open recovery image and you
have a need to be shells well

91
00:05:42,999 --> 00:05:46,340
and what also lot a forensic tool do

92
00:05:46,340 --> 00:05:51,069
is like to the choir to physical memory
direct

93
00:05:51,069 --> 00:05:54,319
so what I get it for love from a lot of
people is like

94
00:05:54,319 --> 00:05:58,129
is and right now open source or is it
cools or

95
00:05:58,129 --> 00:06:01,379
what's up and Android is actually open
source

96
00:06:01,379 --> 00:06:04,520
so you can contribute you can download
the code whatever

97
00:06:04,520 --> 00:06:07,990
but of course could be strong force
behind it and

98
00:06:07,990 --> 00:06:11,860
they will pushed development and

99
00:06:11,860 --> 00:06:14,979
the Google Market is actually not open
source so

100
00:06:14,979 --> 00:06:18,050
good market itself where you get the
app's from

101
00:06:18,050 --> 00:06:21,449
is controlled by Google and

102
00:06:21,449 --> 00:06:24,999
you can create your own market but
basically if you buy an Android phone

103
00:06:24,999 --> 00:06:26,029
these days

104
00:06:26,029 --> 00:06:29,560
there's always to Google Market East the
installed so

105
00:06:29,560 --> 00:06:32,990
all the people will use that so
basically

106
00:06:32,990 --> 00:06:36,699
still the Android the field is

107
00:06:36,699 --> 00:06:41,370
more or less a.m. owned by by Google

108
00:06:41,370 --> 00:06:45,460
talking about the Google markets it's
actually really a few free moment

109
00:06:45,460 --> 00:06:50,419
and what I mean is like this is an error
message to use a gets

110
00:06:50,419 --> 00:06:54,889
when for some maps so it's like we swear
words in it

111
00:06:54,889 --> 00:06:58,520
worm and the a pump that in one app

112
00:06:58,520 --> 00:07:01,719
and actually I think they want wouldn't
pass the

113
00:07:01,719 --> 00:07:04,779
App Store am verification so

114
00:07:04,779 --> 00:07:08,020
on Google Market in not checking the
app's but the

115
00:07:08,020 --> 00:07:11,909
Apple does for its a App Store so I
guess

116
00:07:11,909 --> 00:07:16,150
a ball wouldn't like that and you can
also see that if you go to the

117
00:07:16,150 --> 00:07:19,270
and red website the on the market
website

118
00:07:19,270 --> 00:07:22,639
you search for asdf you find them abs
like

119
00:07:22,639 --> 00:07:25,819
past ap please ignore and like

120
00:07:25,819 --> 00:07:29,360
just random stuff on the Google Market
so

121
00:07:29,360 --> 00:07:34,340
you can't just put on all their their
nobody will look at it

122
00:07:34,340 --> 00:07:38,439
and love a useful downloaded Exley it's
all the

123
00:07:38,439 --> 00:07:42,550
most people who just the put on some ran
the maps on the market

124
00:07:42,550 --> 00:07:45,620
there always like 500 users who will
download it

125
00:07:45,620 --> 00:07:49,990
it doesn't matter what it is

126
00:07:49,990 --> 00:07:54,009
so at talking about molar mmm

127
00:07:54,009 --> 00:07:57,559
dried dream on so-called route pitcher
was the

128
00:07:57,559 --> 00:08:00,620
one of the more worse which made it into
Google Market

129
00:08:00,620 --> 00:08:03,650
most of them are to spread over
different markets in

130
00:08:03,650 --> 00:08:09,050
China most them and the funny thing was
that strike dream

131
00:08:09,050 --> 00:08:12,180
and was detected by Google and

132
00:08:12,180 --> 00:08:15,830
they wrote remover tool forty smaller

133
00:08:15,830 --> 00:08:18,849
and but actually tomorrow right too
salty lol

134
00:08:18,849 --> 00:08:22,550
if they do remover tool we do our own
removal tools well

135
00:08:22,550 --> 00:08:26,599
so with the wrote an their own remover
tool with which was actually another

136
00:08:26,599 --> 00:08:27,349
workpiece

137
00:08:27,349 --> 00:08:31,110
Muller and departed on the Chinese
markets

138
00:08:31,110 --> 00:08:34,719
so it's beaches surfaced deal remover
tool

139
00:08:34,719 --> 00:08:38,010
and the funny thing about

140
00:08:38,010 --> 00:08:42,070
that the small race that part of it is
ok but this release this

141
00:08:42,070 --> 00:08:45,089
open source so you can download part of
the code for

142
00:08:45,089 --> 00:08:48,100
of the Marler and

143
00:08:48,100 --> 00:08:51,470
yeah the guys are pretty funny they put
it on the who code

144
00:08:51,470 --> 00:08:54,680
so you can download called from

145
00:08:54,680 --> 00:08:58,160
called okay

146
00:08:58,160 --> 00:09:01,780
and if you want to bring over to the
mobile as a set that D

147
00:09:01,780 --> 00:09:04,790
easiest thing is just you commence a
user over

148
00:09:04,790 --> 00:09:07,930
just put it on market people somebody
will download it

149
00:09:07,930 --> 00:09:11,340
and then another thing which John over I
did

150
00:09:11,340 --> 00:09:16,140
fine artist that across that scripting
on the Google Market website is also fit

151
00:09:16,140 --> 00:09:17,080
sufficient

152
00:09:17,080 --> 00:09:20,190
soap on Android you basically have two
options to install

153
00:09:20,190 --> 00:09:23,790
ups first um is you take your mobile

154
00:09:23,790 --> 00:09:27,740
open the market up and say yeah please
install it up

155
00:09:27,740 --> 00:09:30,770
and it will install it the other way is

156
00:09:30,770 --> 00:09:34,220
if you look into the website market
Android com

157
00:09:34,220 --> 00:09:38,780
and you install nap there with you login
with your Google account

158
00:09:38,780 --> 00:09:43,130
which is associated with your mobile
phone and it will push it down over to

159
00:09:43,130 --> 00:09:45,380
Google posters

160
00:09:45,380 --> 00:09:48,980
gets installed so across that scripting
is actually enough so if you've

161
00:09:48,980 --> 00:09:52,090
fining cross-site scripting on Kumar
website

162
00:09:52,090 --> 00:09:57,510
just a many as I mean email or something
would be pretty interesting

163
00:09:57,510 --> 00:10:01,510
um and others saying what

164
00:10:01,510 --> 00:10:04,790
Muller also also does is that the

165
00:10:04,790 --> 00:10:08,150
if a nap if the user installed an app

166
00:10:08,150 --> 00:10:11,690
he has to um say okay this up

167
00:10:11,690 --> 00:10:16,240
can access my sd card and Mikey location
and everything

168
00:10:16,240 --> 00:10:20,060
am but their some exploits which just

169
00:10:20,060 --> 00:10:23,490
a.m. if you're already half a nap on the
mobile

170
00:10:23,490 --> 00:10:26,530
this app can exploit booty

171
00:10:26,530 --> 00:10:29,560
to install another app so basically you

172
00:10:29,560 --> 00:10:34,160
there's an app which has no permissions
at all and it will exploit something

173
00:10:34,160 --> 00:10:37,530
to install another app which has all the
permissions

174
00:10:37,530 --> 00:10:40,930
and one thing lost is

175
00:10:40,930 --> 00:10:44,070
Angry Birds extra level molar which was

176
00:10:44,070 --> 00:10:47,440
done by John oh but I did and

177
00:10:47,440 --> 00:10:50,660
there are some other will tease for for
example the invite browser

178
00:10:50,660 --> 00:10:54,350
is small ball to cookie stealing are
basically cross-site scripting

179
00:10:54,350 --> 00:10:58,380
on a.m. to cross site scripting from
within

180
00:10:58,380 --> 00:11:03,350
an app for every website it's now fixed

181
00:11:03,350 --> 00:11:06,680
and there's actually also a new
technique going to be released in

182
00:11:06,680 --> 00:11:07,270
November

183
00:11:07,270 --> 00:11:14,270
also by overriding lani its response
loan

184
00:11:16,729 --> 00:11:20,279
so the enterprise actually I did some
tests with the

185
00:11:20,279 --> 00:11:23,279
different motel um Wes

186
00:11:23,279 --> 00:11:26,579
I used upon and mall

187
00:11:26,579 --> 00:11:30,999
Windows Phone 7 and Android and I was
able to crash

188
00:11:30,999 --> 00:11:34,079
Internet Explorer on Windows Phone

189
00:11:34,079 --> 00:11:37,139
and also Safari on the iPhone

190
00:11:37,139 --> 00:11:40,259
but there was never able to crash the
Android browser well

191
00:11:40,259 --> 00:11:43,789
it could be that who just use the same
father decided that's why

192
00:11:43,789 --> 00:11:47,699
they already detected all problems am

193
00:11:47,699 --> 00:11:51,289
so I think gender prize browse is
actually quite good

194
00:11:51,289 --> 00:11:56,169
only am but what I don't like it like

195
00:11:56,169 --> 00:12:00,929
about it is that it puts bookmark
pictures on your SD card so

196
00:12:00,929 --> 00:12:04,089
SD card is actually a non protected
storage area

197
00:12:04,089 --> 00:12:07,639
so everybody who find two more well can
without the SD card

198
00:12:07,639 --> 00:12:10,839
and plugging into you his PC in Texas
all the date on it

199
00:12:10,839 --> 00:12:13,899
and what's what the Android browser does
is

200
00:12:13,899 --> 00:12:18,339
it if you make bookmark it will store a
small picture

201
00:12:18,339 --> 00:12:22,049
of how the website looks like and
started on the SD card

202
00:12:22,049 --> 00:12:25,220
so on my mobile they're sexually a small

203
00:12:25,220 --> 00:12:28,480
look like picture with life Facebook
account and

204
00:12:28,480 --> 00:12:32,429
by SBB the what it what it was searching
for

205
00:12:32,429 --> 00:12:36,509
and well if you do this if you bookmark
your

206
00:12:36,509 --> 00:12:40,259
mobile banking session it will also put
picture for mobile thank you sis

207
00:12:40,259 --> 00:12:44,019
on the SD card it's more like a privacy
issue but still

208
00:12:44,019 --> 00:12:48,649
it's not not that nice their lot of
other issues with Android

209
00:12:48,649 --> 00:12:51,709
they're getting better and better but
there were a lot

210
00:12:51,709 --> 00:12:57,269
in the past another issue is them

211
00:12:57,269 --> 00:13:00,929
that new worsen of the Facebook app from
ocean

212
00:13:00,929 --> 00:13:04,389
1.6 on it's able to read write and
editor

213
00:13:04,389 --> 00:13:08,589
SMS and MMS and the worst part is that
you cannot remove

214
00:13:08,589 --> 00:13:12,409
the Facebook app from the Android phone
because it's

215
00:13:12,409 --> 00:13:16,139
the its in special protected area

216
00:13:16,139 --> 00:13:21,919
self storage I'm there were some other
issues with splayed authentication token

217
00:13:21,919 --> 00:13:23,249
so Lexus nineties

218
00:13:23,249 --> 00:13:26,379
were sent or HP so we somebody was
sniffing

219
00:13:26,379 --> 00:13:29,389
could used is authentication tokens to

220
00:13:29,389 --> 00:13:33,709
X's the I think it was Picasa and

221
00:13:33,709 --> 00:13:36,850
sometimes yes mistress Eve was just
simply incorrect

222
00:13:36,850 --> 00:13:41,269
so you were writing Nesmith you
girlfriend but in the end

223
00:13:41,269 --> 00:13:44,779
your boss got the SMS so was quite
strange

224
00:13:44,779 --> 00:13:48,039
and another issue was just uncovered

225
00:13:48,039 --> 00:13:51,639
some weeks ago at the HTC logger which
means

226
00:13:51,639 --> 00:13:55,480
that is a service that is running on htc
and

227
00:13:55,480 --> 00:14:00,409
you can query it for example for dq
location even when your app doesn't half

228
00:14:00,409 --> 00:14:06,059
the permission to access to key
locations of course there's also some

229
00:14:06,059 --> 00:14:09,649
every person going on on the first one
doing is none

230
00:14:09,649 --> 00:14:13,589
and it's getting more and more and of
course there are a lot of other issues

231
00:14:13,589 --> 00:14:17,659
so one day about this a small comment

232
00:14:17,659 --> 00:14:22,699
on xkcd and it says basically dinuclear
chain of command in america

233
00:14:22,699 --> 00:14:25,899
like the president some top bike is in
charge

234
00:14:25,899 --> 00:14:29,559
but actually he only has the red button

235
00:14:29,559 --> 00:14:33,199
and if the engineer who installed the
red button um

236
00:14:33,199 --> 00:14:37,480
didn't install it correctly the
president can president long as he wants

237
00:14:37,480 --> 00:14:40,949
and did it will do nothing so like the
engineer

238
00:14:40,949 --> 00:14:44,059
um is actually the one who is the chart

239
00:14:44,059 --> 00:14:47,600
right and this is somehow similar to

240
00:14:47,600 --> 00:14:50,850
at the end right situation because am
here we have

241
00:14:50,850 --> 00:14:54,589
Google top a Google is fixing all the
security mobile case

242
00:14:54,589 --> 00:14:57,689
and like a.m. updating their softer

243
00:14:57,689 --> 00:15:01,139
but actually on the other side you're
manufacturers and providers

244
00:15:01,139 --> 00:15:06,100
that don't provide you with updates so
we're now on Android 2.3 Fife

245
00:15:06,100 --> 00:15:09,679
and actually Mike mobile is up-to-date

246
00:15:09,679 --> 00:15:13,059
as we will see and it's still on 222

247
00:15:13,059 --> 00:15:16,169
and no actually even to 20

248
00:15:16,169 --> 00:15:19,519
so my situation right now is

249
00:15:19,519 --> 00:15:23,220
abort before last year and I'm still on
and I to

250
00:15:23,220 --> 00:15:28,329
the 20 and my phone tells me your up to
date you find everything is

251
00:15:28,329 --> 00:15:33,889
is good and well basically a moldable to
the screen lock segments we saw

252
00:15:33,889 --> 00:15:39,179
to Detroit remover disposable loyalties
cookie stealing cross-site scripting

253
00:15:39,179 --> 00:15:42,389
the apps can use a lottery apso

254
00:15:42,389 --> 00:15:46,679
basically this is really scary am
especially if you

255
00:15:46,679 --> 00:15:50,489
not only half testing phone but your
private funds same

256
00:15:50,489 --> 00:15:53,629
sir

257
00:15:53,629 --> 00:15:58,459
okay let's talk about the year ARM
security and coat concept of Android

258
00:15:58,459 --> 00:16:04,119
when you write code for Android and only
write it in Java and HTML Javascript

259
00:16:04,119 --> 00:16:09,189
use T Android SDK its most obvious
protein I would say like

260
00:16:09,189 --> 00:16:13,369
ninety-five percent of a lapse on the
market just use this approach

261
00:16:13,369 --> 00:16:17,149
um and of course because its Java and

262
00:16:17,149 --> 00:16:20,269
it's not Javascript is already plane you
can

263
00:16:20,269 --> 00:16:24,850
decompile disassemble and reassemble the
stuff were easily

264
00:16:24,850 --> 00:16:28,519
and well another option would be to
write a

265
00:16:28,519 --> 00:16:32,230
absent are native code but actually a

266
00:16:32,230 --> 00:16:35,269
nobody does it and if you find

267
00:16:35,269 --> 00:16:38,649
an app that does it you can just the

268
00:16:38,649 --> 00:16:43,079
to normal arm assembler reverse
engineering so

269
00:16:43,079 --> 00:16:48,179
the gets normal reverse engineering task
as usual

270
00:16:48,179 --> 00:16:51,439
you can also use some frameworks
generators the

271
00:16:51,439 --> 00:16:55,129
I only know top 12 to them make dot com

272
00:16:55,129 --> 00:16:58,709
PhoneGap think there are others I have
some slides

273
00:16:58,709 --> 00:17:02,909
about this too but was little bit cutie
style float: I skip them

274
00:17:02,909 --> 00:17:06,250
um well okay

275
00:17:06,250 --> 00:17:10,899
let's dive into some techniques for Penn
testers and reverse engineers

276
00:17:10,899 --> 00:17:14,000
so if you wanna analyze Android apps

277
00:17:14,000 --> 00:17:17,419
a.m. you have to get these a pic a file
so it became

278
00:17:17,419 --> 00:17:22,220
also basically a just and write-ups so
one a pic if our lease 18

279
00:17:22,220 --> 00:17:26,769
Android a and my approach was actually I
want to look into a lot

280
00:17:26,769 --> 00:17:30,210
of Android apps not just one or two so

281
00:17:30,210 --> 00:17:33,460
what at first it was I opened markets a

282
00:17:33,460 --> 00:17:36,669
up on my mood well I clicked the app
unsaid install

283
00:17:36,669 --> 00:17:40,510
and afterwards I SSH into mobile phone

284
00:17:40,510 --> 00:17:44,200
and to secure copied over the a pic if
I'll

285
00:17:44,200 --> 00:17:48,090
at the works if you just want to
download download one or two ups

286
00:17:48,090 --> 00:17:51,700
but actually it slow and there's not
enough space on the mobile so

287
00:17:51,700 --> 00:17:55,340
every one of these up gets installed on
your mobile

288
00:17:55,340 --> 00:17:58,580
so what I did was actually am

289
00:17:58,580 --> 00:18:03,559
I tried to sit amended so that not all
the supps get installed on my mobile

290
00:18:03,559 --> 00:18:07,090
sewer connected my mobile phone 2t
laptop

291
00:18:07,090 --> 00:18:10,210
with over my feet so I made a new wifey
X

292
00:18:10,210 --> 00:18:13,519
point on mine laptop I used I P tables

293
00:18:13,519 --> 00:18:18,049
to redirect the them the traffic on port
80

294
00:18:18,049 --> 00:18:21,580
to a local burp instance burp sexually
to stir

295
00:18:21,580 --> 00:18:26,350
HTTP proxy passing to fence just HP
proxy

296
00:18:26,350 --> 00:18:30,909
um and yeah I had to use IP tables
because I could not specify a proxy

297
00:18:30,909 --> 00:18:32,619
nandroid because Android has no

298
00:18:32,619 --> 00:18:35,789
proxy options and

299
00:18:35,789 --> 00:18:39,609
use perplexed and that's the scripting
and Chang of this proxy

300
00:18:39,609 --> 00:18:43,429
to safe the responses with the AP ki
files to my laptop

301
00:18:43,429 --> 00:18:47,369
so firm they're not stored on my mobile
but on

302
00:18:47,369 --> 00:18:51,480
on the laptop and in the end my a laptop

303
00:18:51,480 --> 00:18:56,769
a safety a pic if all the Android app
but sent my mobile a 404 not found so he

304
00:18:56,769 --> 00:18:57,850
told my mobile

305
00:18:57,850 --> 00:19:01,299
yet Thursday's no such up and I'm about
that okay

306
00:19:01,299 --> 00:19:04,760
well if there's no such up then that's
fine and

307
00:19:04,760 --> 00:19:09,210
but actually D a pic if I'll was stored
on my lap

308
00:19:09,210 --> 00:19:12,359
so am right he

309
00:19:12,359 --> 00:19:16,070
like this I could just click a nap

310
00:19:16,070 --> 00:19:19,840
on the market and it sends a request to
Google

311
00:19:19,840 --> 00:19:24,109
over the wifey of my a laptop and want
the app comes back

312
00:19:24,109 --> 00:19:27,359
it gets tort and they remember well

313
00:19:27,359 --> 00:19:31,159
doesn't notice anything to says okay
that gap is not coming

314
00:19:31,159 --> 00:19:34,279
um now the problem is I don't want you

315
00:19:34,279 --> 00:19:37,519
like click every app on my mobile right

316
00:19:37,519 --> 00:19:42,320
so I had to find out way to instead to
say Google please install gapps

317
00:19:42,320 --> 00:19:46,149
that are on on on on on Android on the
Android Market

318
00:19:46,149 --> 00:19:50,849
and so I found out that you just have to
send one HTTP requests

319
00:19:50,849 --> 00:19:54,179
to the good market website and

320
00:19:54,179 --> 00:19:57,389
you just have to change the apt name
inside that request

321
00:19:57,389 --> 00:20:01,409
and he winced it will install that up so

322
00:20:01,409 --> 00:20:05,470
now I had the problem now what I know
that just have to sentence request

323
00:20:05,470 --> 00:20:08,570
but I have to find out all this app
names right

324
00:20:08,570 --> 00:20:11,830
so the next step was to

325
00:20:11,830 --> 00:20:15,609
to use at tool called WCF

326
00:20:15,609 --> 00:20:19,070
actually it does matter that's actually
a web application scanner but I just

327
00:20:19,070 --> 00:20:20,080
used it because

328
00:20:20,080 --> 00:20:23,690
I know that crawler so I used that
spider crawler

329
00:20:23,690 --> 00:20:27,419
and wrote a regex plugin which is rights
out

330
00:20:27,419 --> 00:20:31,500
all the apt names from the Google Market
website so it'll to troll to go to

331
00:20:31,500 --> 00:20:32,059
Google Mike

332
00:20:32,059 --> 00:20:35,599
website search for terms a two sets at
and right I'll

333
00:20:35,599 --> 00:20:40,159
out all the up names that are displayed
they were actually no restrictions that

334
00:20:40,159 --> 00:20:41,200
also

335
00:20:41,200 --> 00:20:44,369
can just search do is manage search
under who might

336
00:20:44,369 --> 00:20:48,609
website want and well in the end

337
00:20:48,609 --> 00:20:53,399
I wrote the scripts to send these Heps
request text yep names from the file

338
00:20:53,399 --> 00:20:56,440
and sense it to Google so

339
00:20:56,440 --> 00:21:00,340
maybe that was livid fast so this is
like

340
00:21:00,340 --> 00:21:04,210
the entire in my mint I'm first all we
have to crawl or

341
00:21:04,210 --> 00:21:08,869
who looks for all the app names and
basically we just have to them

342
00:21:08,869 --> 00:21:12,460
line separated file which us all the up
names in it

343
00:21:12,460 --> 00:21:15,549
then a small place in script textes up
names and

344
00:21:15,549 --> 00:21:19,839
sense a requests to Google please
install that up

345
00:21:19,839 --> 00:21:23,260
Google would say okay a pushdown yep
over to you

346
00:21:23,260 --> 00:21:27,700
group who service and my a pic people's
will say oh that's traffic on port

347
00:21:27,700 --> 00:21:31,589
eighty redirected to burp burp bill say
a letter for

348
00:21:31,589 --> 00:21:35,299
scripting in China who wants to know
what I'm doing so it will redirect

349
00:21:35,299 --> 00:21:40,330
to burp extender and super PACs and will
save the file so we have to a pic a file

350
00:21:40,330 --> 00:21:43,720
and sent mobile over key wifey

351
00:21:43,720 --> 00:21:47,260
an age before for not found

352
00:21:47,260 --> 00:21:51,830
so basically and their butts 3 and South
naps in the

353
00:21:51,830 --> 00:21:55,990
market I crawled about 10,000 up names

354
00:21:55,990 --> 00:21:59,529
and I successfully downloaded about
three and a half thousand but

355
00:21:59,529 --> 00:22:02,990
15 you but took me about three days but

356
00:22:02,990 --> 00:22:06,109
just left drain so

357
00:22:06,109 --> 00:22:10,500
now we have this a pic it falls rate
this is an Android app

358
00:22:10,500 --> 00:22:14,789
what do we do with it so we can
decompile disassemble it

359
00:22:14,789 --> 00:22:17,820
if you want disassemble it am

360
00:22:17,820 --> 00:22:21,570
well actually AP case nothing else and
that's it sip file

361
00:22:21,570 --> 00:22:25,879
so it you can basically just once a bit
but then you have all these

362
00:22:25,879 --> 00:22:29,240
a.m. main dot X amount is not really an
ex-model

363
00:22:29,240 --> 00:22:33,909
but it's a binary format binary XML see
you would have to convert it first

364
00:22:33,909 --> 00:22:37,339
and also the class is the pics thats
were actually

365
00:22:37,339 --> 00:22:40,379
the decode the

366
00:22:40,379 --> 00:22:45,089
Java code stored and it's just one
follow everything in one father

367
00:22:45,089 --> 00:22:48,820
not really handy to do anything with a
TA you don't you can order a TX more

368
00:22:48,820 --> 00:22:49,770
files

369
00:22:49,770 --> 00:22:53,080
and so on so what he uses actually a pic
a tool

370
00:22:53,080 --> 00:22:56,339
which is much better because you get
really small files

371
00:22:56,339 --> 00:22:59,539
and for example in Android manifest not
x-small

372
00:22:59,539 --> 00:23:03,609
you can just lookup which permissions at
the apt is using

373
00:23:03,609 --> 00:23:06,799
and what it produces as well is that um

374
00:23:06,799 --> 00:23:09,879
classes a optics is converted

375
00:23:09,879 --> 00:23:13,349
too small the codes so we'll see in a
minute

376
00:23:13,349 --> 00:23:16,830
what's more we could actually is or yeah

377
00:23:16,830 --> 00:23:21,409
and so we have basically two approaches
if you want to decompile disassemble

378
00:23:21,409 --> 00:23:24,869
is assembling and D compiling so
dissembling

379
00:23:24,869 --> 00:23:28,649
is done a.m. with small the code so

380
00:23:28,649 --> 00:23:31,750
small is similar to adjustment syntex

381
00:23:31,750 --> 00:23:35,099
I'm just mean I hope somebody knows it

382
00:23:35,099 --> 00:23:39,260
it's a Java summer coat it's like

383
00:23:39,260 --> 00:23:42,639
assembly code for Charla and at

384
00:23:42,639 --> 00:23:47,580
small is very similar to it used a pic I
used a pic a tool

385
00:23:47,580 --> 00:23:51,139
actually just because produces correct
smalley code

386
00:23:51,139 --> 00:23:55,279
so you can reuse it you can recompile it
and it will work

387
00:23:55,279 --> 00:23:58,330
am are you have unused extemp or

388
00:23:58,330 --> 00:24:01,629
de Dexter which basically do the same
but

389
00:24:01,629 --> 00:24:04,820
if he could tool was the enough reliable

390
00:24:04,820 --> 00:24:08,179
and the other approach would be to
compile to each other

391
00:24:08,179 --> 00:24:12,570
and Smalley code is pretty easy to read
this we'll see later

392
00:24:12,570 --> 00:24:16,849
but jobless of course the even even
better

393
00:24:16,849 --> 00:24:20,500
nicer to read used Dexter J

394
00:24:20,500 --> 00:24:23,760
the expert or and the just a standard

395
00:24:23,760 --> 00:24:27,369
java Decompiler the problem is actually
that

396
00:24:27,369 --> 00:24:31,629
it produces sometimes incorrect Java
code so Shia incorrect Java code you

397
00:24:31,629 --> 00:24:33,480
cannot take this code and

398
00:24:33,480 --> 00:24:37,770
recompile it again to to an Android app

399
00:24:37,770 --> 00:24:40,789
so the disassembling how to is actually

400
00:24:40,789 --> 00:24:44,849
just one command you'd say tell amongst
our epic it'll

401
00:24:44,849 --> 00:24:48,089
the char at these for decompile

402
00:24:48,089 --> 00:24:53,129
the or disassemble sorry a at that they
pic-a-state BK far we want to

403
00:24:53,129 --> 00:24:56,869
disassemble and we specify the output
for

404
00:24:56,869 --> 00:25:00,379
so smalley a.m. this morning samples
what good is

405
00:25:00,379 --> 00:25:04,830
actually pretty easy to read with a
method called is also dedicated

406
00:25:04,830 --> 00:25:08,869
at the set the tee and indicates that
it's the going to return

407
00:25:08,869 --> 00:25:12,440
bullion value locals one means there's

408
00:25:12,440 --> 00:25:15,589
won riches sir um which does matter

409
00:25:15,589 --> 00:25:18,629
uses so basically the

410
00:25:18,629 --> 00:25:22,049
the whole week that's T each other VM
for Android

411
00:25:22,049 --> 00:25:25,779
is the richest based and I'm like

412
00:25:25,779 --> 00:25:28,909
a normal child p.m. and well

413
00:25:28,909 --> 00:25:32,099
you can read that code it's not that
hard to read I mean it's like

414
00:25:32,099 --> 00:25:36,740
I get object so he gets some object from
you to Dropbox client

415
00:25:36,740 --> 00:25:41,369
and if equals 0 like we know that from
normal sample code that it's not really

416
00:25:41,369 --> 00:25:42,629
hard to read and

417
00:25:42,629 --> 00:25:48,099
the sum jumping around so busy pretty
easy to read

418
00:25:48,099 --> 00:25:51,470
and reassembling is also really really
easy just

419
00:25:51,470 --> 00:25:55,580
change something in the code which saw
and for example we just

420
00:25:55,580 --> 00:26:00,580
return always one a or true for a
forties authentication method

421
00:26:00,580 --> 00:26:03,669
so we're always authenticated and

422
00:26:03,669 --> 00:26:08,940
it just specify be for a build d output
folder where we sort DM

423
00:26:08,940 --> 00:26:13,230
a pic a tool output before and the new
name for Kia

424
00:26:13,230 --> 00:26:16,750
what did have to do as well lease also a
sign the

425
00:26:16,750 --> 00:26:19,919
chart the 38k file because

426
00:26:19,919 --> 00:26:24,559
Android will only accept files that are
signed a self-signed is fine

427
00:26:24,559 --> 00:26:27,809
because the only reason why it has to be
signed is actually

428
00:26:27,809 --> 00:26:31,659
because every update has to be signed
with the same key again

429
00:26:31,659 --> 00:26:35,289
so if you want to update your app you
have to sign processing key

430
00:26:35,289 --> 00:26:38,559
so basically you produce and you keep

431
00:26:38,559 --> 00:26:41,669
I'm use HR sign please sign that the

432
00:26:41,669 --> 00:26:46,010
that a pic a file at the last line
already installed it on your

433
00:26:46,010 --> 00:26:50,570
mobile so it be installments the if you
connect your phone

434
00:26:50,570 --> 00:26:53,830
overdue USB cable on your USB debug on

435
00:26:53,830 --> 00:26:59,299
a it will install the app so really
really easy

436
00:26:59,299 --> 00:27:02,359
okay there are some other techniques for
pen tester which are a pretty helpful

437
00:27:02,359 --> 00:27:03,529
their lot more but

438
00:27:03,529 --> 00:27:08,740
just the explain some of them I you can
make keep dumps actually on Android

439
00:27:08,740 --> 00:27:12,359
at of course E you have to be rude so
you have to root your

440
00:27:12,359 --> 00:27:15,379
phone first but that should be no
problem at all

441
00:27:15,379 --> 00:27:18,460
um you can find out the the

442
00:27:18,460 --> 00:27:21,629
in process ID and afterwards with

443
00:27:21,629 --> 00:27:25,200
kill -10 you can produce heat dumps

444
00:27:25,200 --> 00:27:29,529
so um you will find the heap dump end up
the Minack

445
00:27:29,529 --> 00:27:33,029
and you can grab for it for example here

446
00:27:33,029 --> 00:27:36,240
what I did was I for those have you know
keep us

447
00:27:36,240 --> 00:27:40,710
otherwise it's not that important but a
open KeePass database and my mouth

448
00:27:40,710 --> 00:27:41,580
password

449
00:27:41,580 --> 00:27:45,080
and I at the new password into the
keystore

450
00:27:45,080 --> 00:27:48,929
and when you look at the a heap dump
afterwards you still find the new

451
00:27:48,929 --> 00:27:49,889
password

452
00:27:49,889 --> 00:27:52,970
I include so basically you can

453
00:27:52,970 --> 00:27:56,359
look which which term are you able so
still stored

454
00:27:56,359 --> 00:28:01,190
in in the heap if you if you're weaver's
nap

455
00:28:01,190 --> 00:28:05,409
on and rights the 2.3 in the buff you
have to do to be different

456
00:28:05,409 --> 00:28:09,460
but does matter

457
00:28:09,460 --> 00:28:12,869
okay another thing is actually in
walking activity so

458
00:28:12,869 --> 00:28:15,919
an activity on Android's basically one
screen like

459
00:28:15,919 --> 00:28:19,859
if one screen yet some buttons and if
you click one change to another screen

460
00:28:19,859 --> 00:28:20,970
right

461
00:28:20,970 --> 00:28:25,669
and a lot of cops have like for screen
is your login screen

462
00:28:25,669 --> 00:28:28,909
and if you don't a.m. type it in
correctly

463
00:28:28,909 --> 00:28:32,799
you won't get to screen to now the
problem is

464
00:28:32,799 --> 00:28:36,639
a lot of developers don't check if a.m.
on-screen to

465
00:28:36,639 --> 00:28:40,079
and again if if you're if he's already
locked in

466
00:28:40,079 --> 00:28:43,190
so basically you can't just a.m.

467
00:28:43,190 --> 00:28:47,770
her start in activity directly so you
can you restart the password activity

468
00:28:47,770 --> 00:28:51,809
directly which maybe second screen and
you don't so you don't have to look in

469
00:28:51,809 --> 00:28:56,980
on the first green screen unfortunately
this example does work because key

470
00:28:56,980 --> 00:28:59,790
passes quickly implement

471
00:28:59,790 --> 00:29:04,490
okay there tons of other tools a and
regard I won't get

472
00:29:04,490 --> 00:29:08,429
talk about all of them man I haven't
actually used all of them

473
00:29:08,429 --> 00:29:12,290
but the it's getting more and more every
year every month

474
00:29:12,290 --> 00:29:15,290
and when I started the

475
00:29:15,290 --> 00:29:18,299
there were acts not that much to the
many tools

476
00:29:18,299 --> 00:29:22,190
and the also the thing I i explained
with

477
00:29:22,190 --> 00:29:27,200
downloading the AP K files today you
have a good market API so you would just

478
00:29:27,200 --> 00:29:31,069
basically used at and at library to

479
00:29:31,069 --> 00:29:34,659
to download is a pic a false but I was
just

480
00:29:34,659 --> 00:29:38,069
them trying to to tell you how

481
00:29:38,069 --> 00:29:43,089
can tackle these problems she just want
to

482
00:29:43,089 --> 00:29:46,159
if you know there's something on the
wire and you have to you want to

483
00:29:46,159 --> 00:29:50,200
a.m. storied when your laptop

484
00:29:50,200 --> 00:29:53,730
so hope this is now TV most interesting
part

485
00:29:53,730 --> 00:29:57,940
my experiences when 30 compiling
dissembling so many ups

486
00:29:57,940 --> 00:30:01,099
um as a set a.m.

487
00:30:01,099 --> 00:30:06,290
see now thousands ups I found about 2.3
K

488
00:30:06,290 --> 00:30:09,909
email addresses so if you want spam
around and

489
00:30:09,909 --> 00:30:15,270
yeah there the developers really low of
swear words they really loved it

490
00:30:15,270 --> 00:30:21,079
and you find a lot of the Twitter
Facebook Flickr give testing API keys

491
00:30:21,079 --> 00:30:24,480
so I don't really get the point the API
keys anymore

492
00:30:24,480 --> 00:30:28,220
because it's like a key so not everybody
can but somehow you can

493
00:30:28,220 --> 00:30:31,790
just extract them from everywhere okay

494
00:30:31,790 --> 00:30:35,339
so let's talk but the some low-hanging
fruits are found

495
00:30:35,339 --> 00:30:39,409
but first let's do just small hashing
encryption

496
00:30:39,409 --> 00:30:42,530
short best practice three fresh so

497
00:30:42,530 --> 00:30:46,329
if you wanna house in a trip to should
you secure algorithms

498
00:30:46,329 --> 00:30:49,369
stations random and long souls

499
00:30:49,369 --> 00:30:55,659
and when you do housing you should a.m.
use a separate sold for every house

500
00:30:55,659 --> 00:30:59,299
that's his best practice you should use

501
00:30:59,299 --> 00:31:03,030
subtle dashing rounds and when you do
encryption that's the most important

502
00:31:03,030 --> 00:31:04,020
part

503
00:31:04,020 --> 00:31:08,129
if you do encryption you should keep the
key secret

504
00:31:08,129 --> 00:31:11,869
I mean there's no point in in 15
anything if you don't keep the key

505
00:31:11,869 --> 00:31:12,859
secret

506
00:31:12,859 --> 00:31:16,720
so this guy here

507
00:31:16,720 --> 00:31:20,460
it's not that bad but you just used as
static saw right

508
00:31:20,460 --> 00:31:23,470
and he was in the process affirm

509
00:31:23,470 --> 00:31:27,760
thinking about yet now I have to like
them has something else

510
00:31:27,760 --> 00:31:30,770
and I don't want to use the same sold
but he was not like

511
00:31:30,770 --> 00:31:34,099
and dynamically grating random salts

512
00:31:34,099 --> 00:31:37,349
but what he did it was like oh now I
need a better one so I

513
00:31:37,349 --> 00:31:40,919
writing this one even better and the
same sort cans

514
00:31:40,919 --> 00:31:44,450
but still static so it would have been
much better if you just you

515
00:31:44,450 --> 00:31:50,369
produces one on the fly and then store
it along with the house

516
00:31:50,369 --> 00:31:54,220
um yeah now we're getting to do testing
part

517
00:31:54,220 --> 00:31:57,480
and this is an AES key because use

518
00:31:57,480 --> 00:32:00,549
byte array and then we see will use it
who

519
00:32:00,549 --> 00:32:04,099
would produce a key so basically
whatever

520
00:32:04,099 --> 00:32:08,559
trypsin is going on here we have two key
for it so we can depict

521
00:32:08,559 --> 00:32:12,549
and the funny thing about this key

522
00:32:12,549 --> 00:32:16,210
was actually when I was looking at it
a.m.

523
00:32:16,210 --> 00:32:19,679
a bite this normal like from 02

524
00:32:19,679 --> 00:32:23,270
255 right and

525
00:32:23,270 --> 00:32:26,399
but none of them is over one and 28

526
00:32:26,399 --> 00:32:29,879
so a the most significant bit of the ski

527
00:32:29,879 --> 00:32:33,349
for every bite is Siro and I was
wondering why

528
00:32:33,349 --> 00:32:37,190
why would anybody just what was his what
was he thinking

529
00:32:37,190 --> 00:32:40,500
and the problem is actually I guess that

530
00:32:40,500 --> 00:32:44,119
if you want to use in touch us like this
to initialize

531
00:32:44,119 --> 00:32:47,639
a and by to rate and you have to use

532
00:32:47,639 --> 00:32:51,530
signed contentious you cannot used
unsigned so you cannot use

533
00:32:51,530 --> 00:32:55,280
as your 0 to 255 but you have to use

534
00:32:55,280 --> 00:32:58,980
at minus 128 to 127

535
00:32:58,980 --> 00:33:02,169
and so to developer was like just
throwing out it was like

536
00:33:02,169 --> 00:33:05,639
okay 128 doesn't work so I just use

537
00:33:05,639 --> 00:33:10,329
numbers from 0 to 127

538
00:33:10,329 --> 00:33:14,079
actually was used to send passwords in
eighty guess it was still

539
00:33:14,079 --> 00:33:18,599
protected by SSL so it it's not that bad

540
00:33:18,599 --> 00:33:21,799
um the other more disguise would do the
same

541
00:33:21,799 --> 00:33:26,010
and anybody reads the secret message

542
00:33:26,010 --> 00:33:29,099
or Olympic soccer world cup

543
00:33:29,099 --> 00:33:33,079
hokey something I'm

544
00:33:33,079 --> 00:33:36,730
but still seek Ricky in and apso

545
00:33:36,730 --> 00:33:41,929
simply use it the cryptid it was used to
sing license server that in games

546
00:33:41,929 --> 00:33:46,159
goods WordPress chase odz was actually
game and now I'm to fish tank master

547
00:33:46,159 --> 00:33:46,679
because they're

548
00:33:46,679 --> 00:33:51,139
all the fishes in fish tank game so

549
00:33:51,139 --> 00:33:54,790
yeah really good at it now and

550
00:33:54,790 --> 00:33:58,740
yeah no comment on this one

551
00:33:58,740 --> 00:34:01,839
an you

552
00:34:01,839 --> 00:34:05,450
least on crack

553
00:34:05,450 --> 00:34:08,530
um what some of the apps right

554
00:34:08,530 --> 00:34:11,710
is um obfuscated code

555
00:34:11,710 --> 00:34:14,929
um as most of us know of is getting code

556
00:34:14,929 --> 00:34:18,679
doesn't really help was time

557
00:34:18,679 --> 00:34:22,270
am if you look at this code it doesn't
matter actually what is going on

558
00:34:22,270 --> 00:34:27,040
a dime on down here but as we see there
some secret key factory in some sick key

559
00:34:27,040 --> 00:34:30,099
anything and them we see that there's

560
00:34:30,099 --> 00:34:34,500
nay array be array and one para mi 22
these

561
00:34:34,500 --> 00:34:39,918
constructed so if we know all the inputs
to an encryption routine

562
00:34:39,919 --> 00:34:44,079
I am we know a hot the cryptid as well

563
00:34:44,079 --> 00:34:47,919
right so I was wondering okay we help
despite rape but

564
00:34:47,919 --> 00:34:51,530
where's this coming from sits uses
bright or

565
00:34:51,530 --> 00:34:55,579
key derivation function or whatever

566
00:34:55,579 --> 00:35:00,030
so question is who calls his age
constructed and of course

567
00:35:00,030 --> 00:35:03,059
for perhaps later you'll find the answer
there's

568
00:35:03,059 --> 00:35:06,510
a class called C-dot F because of his
kate is always like

569
00:35:06,510 --> 00:35:10,640
shortened class names so there's a class
called C-dot

570
00:35:10,640 --> 00:35:13,839
includes let's say a string

571
00:35:13,839 --> 00:35:17,230
CFF consider yes it'll be escorted out

572
00:35:17,230 --> 00:35:21,369
%eh was the key it up a cheese is the
key and all the local group for

573
00:35:21,369 --> 00:35:24,559
encryption we know all the input date
for decryption 13

574
00:35:24,559 --> 00:35:31,559
its limit the crib do so we can be
cryptid whatever it might be

575
00:35:32,920 --> 00:35:36,150
and some other stuff I found was the

576
00:35:36,150 --> 00:35:40,170
one guy was writing an email parser

577
00:35:40,170 --> 00:35:44,500
so hero to class test something but I'll

578
00:35:44,500 --> 00:35:48,400
and so they all have to test the class
so

579
00:35:48,400 --> 00:35:52,039
which is based in one of his emails so I
could do

580
00:35:52,039 --> 00:35:55,210
read all his were 150 North thats

581
00:35:55,210 --> 00:35:58,460
not that bad but mile basically should
remove

582
00:35:58,460 --> 00:36:02,109
that tell file or as sending it to the

583
00:36:02,109 --> 00:36:05,400
market and the same guy I saw yeah

584
00:36:05,400 --> 00:36:09,319
als left to authenticate the and server
so he wrote in see me like he's he's

585
00:36:09,319 --> 00:36:11,690
already is best which is certainly
manage the main aim

586
00:36:11,690 --> 00:36:14,859
your fault credentials you need to axis
the

587
00:36:14,859 --> 00:36:18,450
corporate sir okay

588
00:36:18,450 --> 00:36:22,869
that was just the low hanging fruit
Slyke sometimes don't even know what the

589
00:36:22,869 --> 00:36:24,410
encryption is used for

590
00:36:24,410 --> 00:36:28,309
alright just don't care but yeah
terrible there really a lot of keys

591
00:36:28,309 --> 00:36:31,390
and need to code and

592
00:36:31,390 --> 00:36:35,010
let's look at some absolute more closely

593
00:36:35,010 --> 00:36:39,460
at first one is a banking app and I
always wonder

594
00:36:39,460 --> 00:36:43,510
really wants banking on the mobile think
it's not the

595
00:36:43,510 --> 00:36:46,650
security guys most time there

596
00:36:46,650 --> 00:36:50,740
are a lot of ups who which do banking

597
00:36:50,740 --> 00:36:54,069
on the Android platform

598
00:36:54,069 --> 00:36:57,280
and this one a

599
00:36:57,280 --> 00:37:00,520
at No obfuscation tool could be he's
loopy

600
00:37:00,520 --> 00:37:03,930
recompiled searches change the code and
recompiled it again

601
00:37:03,930 --> 00:37:07,520
and said yes sent the credentials to my
server please

602
00:37:07,520 --> 00:37:11,349
and the app simply shows to website

603
00:37:11,349 --> 00:37:14,440
so the apt is excellent nothing else
than

604
00:37:14,440 --> 00:37:17,839
worse browser so it's like you're

605
00:37:17,839 --> 00:37:20,910
yep opens this one window

606
00:37:20,910 --> 00:37:25,000
it loads the the the normal e-banking
dots whatever dot

607
00:37:25,000 --> 00:37:29,160
com website and the problem is it is

608
00:37:29,160 --> 00:37:32,530
that it hides the URL so whenever you'd

609
00:37:32,530 --> 00:37:36,010
pulled your users yeah you have to check
if its

610
00:37:36,010 --> 00:37:39,859
a GPS or just HDPE and it also

611
00:37:39,859 --> 00:37:43,890
hides the SSL certificate or the small
lock

612
00:37:43,890 --> 00:37:46,900
lock you have nominee for SSL

613
00:37:46,900 --> 00:37:50,950
connection so you cannot tell you use it
anymore yep you have to check if its

614
00:37:50,950 --> 00:37:53,990
its GPS or whatever because it won't see
anything

615
00:37:53,990 --> 00:37:58,329
if you downloaded the wrong app which
has exactly the same name s3 Lapan

616
00:37:58,329 --> 00:38:01,859
just from that wonder which is has the
same name

617
00:38:01,859 --> 00:38:05,930
you know market you can put everything
um

618
00:38:05,930 --> 00:38:09,760
yeah should he know he's not connecting
to

619
00:38:09,760 --> 00:38:14,950
his ac and and the problem is that

620
00:38:14,950 --> 00:38:18,460
this up can only be used with anthem so

621
00:38:18,460 --> 00:38:21,950
you get the mobile time so you get in
this mess on your mobile

622
00:38:21,950 --> 00:38:26,319
with a.m. as a two-factor authentication
right

623
00:38:26,319 --> 00:38:29,630
but the problem is two-factor
authentication means there are two

624
00:38:29,630 --> 00:38:30,490
factors

625
00:38:30,490 --> 00:38:33,530
so an attacker has to own two things or

626
00:38:33,530 --> 00:38:37,000
to know two things or whatever to am

627
00:38:37,000 --> 00:38:40,589
really get through with it his attack
but actually if they're smaller and

628
00:38:40,589 --> 00:38:42,329
mobile

629
00:38:42,329 --> 00:38:45,450
he he at the user types in his password
to the mobile

630
00:38:45,450 --> 00:38:48,450
the and he gets yes miss on the move
also

631
00:38:48,450 --> 00:38:51,720
moreover can read everything so
basically dis the

632
00:38:51,720 --> 00:38:55,270
two-factor authentication is lil bit
useless because

633
00:38:55,270 --> 00:38:58,410
it's the moment no that's not correct

634
00:38:58,410 --> 00:39:03,089
and useless but the well it's not that
good

635
00:39:03,089 --> 00:39:06,349
well to be honest there there is
actually in another option you

636
00:39:06,349 --> 00:39:10,170
you don't have to use Anton you can also
use a USB stick

637
00:39:10,170 --> 00:39:14,920
but I'm not sure how you liking you use
sticking to your mobile

638
00:39:14,920 --> 00:39:18,480
I guess the work so doctor evil will be
very happy

639
00:39:18,480 --> 00:39:24,530
to them write some molar for Android

640
00:39:24,530 --> 00:39:27,970
cocaine um an abrupt which the first

641
00:39:27,970 --> 00:39:33,200
problem was that the two houses have the
self-signed SSL certificate

642
00:39:33,200 --> 00:39:36,940
which is bad on its own so we did a man
in the middle attack

643
00:39:36,940 --> 00:39:40,059
I'm standard many middle expresso and

644
00:39:40,059 --> 00:39:44,030
what we saw was something like odors
that's not really the

645
00:39:44,030 --> 00:39:47,319
password we entered test so

646
00:39:47,319 --> 00:39:50,329
a basically it looks like encrypt it so

647
00:39:50,329 --> 00:39:53,660
don't need to key for that and of course

648
00:39:53,660 --> 00:39:59,270
you'll just find it in the App so South
signed it SSL certificate and

649
00:39:59,270 --> 00:40:04,740
Kenya up is pretty fades

650
00:40:04,740 --> 00:40:07,809
um now another topic and

651
00:40:07,809 --> 00:40:12,220
some mobile device management's Wenders
try to

652
00:40:12,220 --> 00:40:16,069
um sell to customers like you can detect

653
00:40:16,069 --> 00:40:19,740
if the phone is rooted or not and

654
00:40:19,740 --> 00:40:23,329
one of Dez a.m. Wenders trite at

655
00:40:23,329 --> 00:40:27,200
this code in it so the method is called
device route on it

656
00:40:27,200 --> 00:40:30,359
a.m. tries to execute sOooo

657
00:40:30,359 --> 00:40:33,670
the superuser month and if it works it
returns through

658
00:40:33,670 --> 00:40:37,530
so device is rooted otherwise the device
is not rooted

659
00:40:37,530 --> 00:40:40,730
so I was thinking yeah well

660
00:40:40,730 --> 00:40:44,319
that could be hard to like like
circumvent this because

661
00:40:44,319 --> 00:40:48,910
every app can call Sue if the phone is
really rooted

662
00:40:48,910 --> 00:40:52,690
but then I realized well when I did my
routing

663
00:40:52,690 --> 00:40:56,780
there was an app installed which is
called superuser dot a pic /a

664
00:40:56,780 --> 00:41:00,480
and disappear you stop a PK Android app

665
00:41:00,480 --> 00:41:04,190
there's nothing else than before a nap
is granted

666
00:41:04,190 --> 00:41:07,390
subpoenas permission it asks the user

667
00:41:07,390 --> 00:41:11,500
so it was not necessary to circumvent
this route detection

668
00:41:11,500 --> 00:41:14,680
so basically am gap is

669
00:41:14,680 --> 00:41:19,020
the ask you odors there's an app from
your company

670
00:41:19,020 --> 00:41:22,579
which is which ones to get root
permissions and you to say

671
00:41:22,579 --> 00:41:26,299
remember in denying and your company
will never notice

672
00:41:26,299 --> 00:41:30,869
that your phone is rooted so the feature
of this

673
00:41:30,869 --> 00:41:36,270
the device management solution it's not
going to work Ill

674
00:41:36,270 --> 00:41:39,799
course another wondrous trying exactly
the same

675
00:41:39,799 --> 00:41:44,380
like digging it will be different
they're checking if the system has been

676
00:41:44,380 --> 00:41:45,119
to fall

677
00:41:45,119 --> 00:41:49,059
exists or not and basically

678
00:41:49,059 --> 00:41:54,470
um I thought yeah let's let's unaltered
is up and change something

679
00:41:54,470 --> 00:41:57,660
so um ID com disassembled it

680
00:41:57,660 --> 00:42:00,710
at then I used the STD command will
basically just a.m.

681
00:42:00,710 --> 00:42:04,000
changes s been sOooo to at the system s
been

682
00:42:04,000 --> 00:42:07,270
keeps link and I guess there's

683
00:42:07,270 --> 00:42:11,280
Exley no a.m. no file called with this
name

684
00:42:11,280 --> 00:42:14,390
on Android system insist mess been so

685
00:42:14,390 --> 00:42:17,750
td.text will always fail and I

686
00:42:17,750 --> 00:42:20,809
a sign it again and uploaded again

687
00:42:20,809 --> 00:42:24,609
and well it works quite well

688
00:42:24,609 --> 00:42:28,220
but what I was asking myself was that a
good message

689
00:42:28,220 --> 00:42:32,150
to remove to route detection because
every time there's an update

690
00:42:32,150 --> 00:42:37,369
have to do this disassembling changing
and reassembling again

691
00:42:37,369 --> 00:42:43,190
and actually won't we only want to feel
that simple check

692
00:42:43,190 --> 00:42:47,099
so um to prevent the route detection

693
00:42:47,099 --> 00:42:50,569
well the upper stuff is not that
important

694
00:42:50,569 --> 00:42:54,549
actually what I did was I looked into
the PATH variable and just move to Suk

695
00:42:54,549 --> 00:42:55,539
mom from

696
00:42:55,539 --> 00:42:58,869
system s been sOooo to system X been

697
00:42:58,869 --> 00:43:03,140
and its inside pass so all the ups will
still find it

698
00:43:03,140 --> 00:43:06,529
but as you remember DF was checking for

699
00:43:06,529 --> 00:43:10,970
the entire passes system has been soo
and it won't find pursue

700
00:43:10,970 --> 00:43:15,089
come out there but it will well all the
other apps will just execute soon only

701
00:43:15,089 --> 00:43:16,599
and will find it

702
00:43:16,599 --> 00:43:22,319
so that I'm through text was broken as
well

703
00:43:22,319 --> 00:43:25,319
so let's learn it live it roots days
route

704
00:43:25,319 --> 00:43:29,510
I mean the user is root on the phone so
he has the highest people each

705
00:43:29,510 --> 00:43:33,240
fall and now the company's installing
some

706
00:43:33,240 --> 00:43:36,309
up which us normal and read people each

707
00:43:36,309 --> 00:43:40,119
and the I'm people each seeing is trying
to

708
00:43:40,119 --> 00:43:43,230
to on to check in control

709
00:43:43,230 --> 00:43:46,950
route some I'll it doesn't work like
there's always a way

710
00:43:46,950 --> 00:43:49,980
a around it because you have more than
me permissions and

711
00:43:49,980 --> 00:43:53,250
is up well

712
00:43:53,250 --> 00:43:56,920
and one day I realized there's Exley

713
00:43:56,920 --> 00:44:01,319
really special secret key 445 aP's

714
00:44:01,319 --> 00:44:04,559
use the same a yes key I was wondering

715
00:44:04,559 --> 00:44:11,559
why would all the supps youths Amy a yes
key

716
00:44:11,970 --> 00:44:16,000
and the winner is Google outs

717
00:44:16,000 --> 00:44:19,440
what they do actually is the encrypt the
last known location

718
00:44:19,440 --> 00:44:24,890
of the user so D um get all the deal
occasion information from GPS

719
00:44:24,890 --> 00:44:28,410
you wifey and encrypt it

720
00:44:28,410 --> 00:44:31,680
with the key we saw and the send it to
be at the

721
00:44:31,680 --> 00:44:36,029
you you al each a super meter to Google
servers

722
00:44:36,029 --> 00:44:40,059
and well I notify cool but seems they
don't care

723
00:44:40,059 --> 00:44:44,650
and well actually to be honest I haven't
seen the you you only pay me to my

724
00:44:44,650 --> 00:44:45,529
network it

725
00:44:45,529 --> 00:44:49,700
as the left do that but to seeing is

726
00:44:49,700 --> 00:44:52,750
just white is Google outs

727
00:44:52,750 --> 00:44:56,250
using symmetric crypto when they use

728
00:44:56,250 --> 00:44:59,680
a symmetric crypto nobody on the network

729
00:44:59,680 --> 00:45:03,690
would be able to be cryptic because you
only have like the public key

730
00:45:03,690 --> 00:45:07,450
public keep for example is only used for
encrypting encryption

731
00:45:07,450 --> 00:45:10,609
and nobody can decrease it because you
don't have to priebke EP

732
00:45:10,609 --> 00:45:15,690
because it's only stored on the Google
server so what the I simply don't guess

733
00:45:15,690 --> 00:45:16,440
it's up to the

734
00:45:16,440 --> 00:45:19,450
a big problem but if u'd

735
00:45:19,450 --> 00:45:23,710
do encryption if they implemented and
use it

736
00:45:23,710 --> 00:45:27,480
well then they should use a symmetric to
because says

737
00:45:27,480 --> 00:45:30,930
secure because is worse right now

738
00:45:30,930 --> 00:45:35,650
doesn't help at all because everybody
knows the the key

739
00:45:35,650 --> 00:45:39,390
so the count measures are basically a.m.
developers should

740
00:45:39,390 --> 00:45:42,619
use more estimate crypto instead of
symmetry crypto

741
00:45:42,619 --> 00:45:45,670
so attackers on the network cannot the
crypt

742
00:45:45,670 --> 00:45:50,830
traffic the shitstorm or hash is in
session tokens instead of passwords

743
00:45:50,830 --> 00:45:53,900
love up so still storing passwords

744
00:45:53,900 --> 00:45:58,450
in the in playing annex lead to
protection mechanism

745
00:45:58,450 --> 00:46:01,880
is the like the Linux kernel and roads
just

746
00:46:01,880 --> 00:46:05,210
another Linux and basically

747
00:46:05,210 --> 00:46:09,260
every app is one a this one user

748
00:46:09,260 --> 00:46:12,700
and one use cannot treat the data from
another user

749
00:46:12,700 --> 00:46:16,030
and that's protecting Messinian making
some but yeah

750
00:46:16,030 --> 00:46:19,280
as we all know their love curl exploits
and stuff

751
00:46:19,280 --> 00:46:22,310
so their or a lot of the

752
00:46:22,310 --> 00:46:26,170
routing exploits around

753
00:46:26,170 --> 00:46:30,480
well and good apps kitchen is just
security through obscurity of course

754
00:46:30,480 --> 00:46:33,760
you ship enters through up so out of a
lot of work to do

755
00:46:33,760 --> 00:46:37,040
and you should also note limitations

756
00:46:37,040 --> 00:46:40,440
course route stays route

757
00:46:40,440 --> 00:46:43,690
here's some references and thanks you
can follow me on Twitter or

758
00:46:43,690 --> 00:46:47,700
just wasn't my website

759
00:46:47,700 --> 00:46:54,700
ardor and questions

760
00:46:56,930 --> 00:47:00,590
be who

761
00:47:00,590 --> 00:47:03,730
not sure if it's working it is working
this

762
00:47:03,730 --> 00:47:07,090
see in your point of view with your
experience

763
00:47:07,090 --> 00:47:10,090
what is the best so device Android
device to make

764
00:47:10,090 --> 00:47:13,710
the security researches at the best
device

765
00:47:13,710 --> 00:47:17,220
well actually depends not that much on

766
00:47:17,220 --> 00:47:21,990
device unless you're like really going
for two specific stuff

767
00:47:21,990 --> 00:47:25,660
like agencies different from some some
and

768
00:47:25,660 --> 00:47:29,080
well-intended it's also important which
and would worsen

769
00:47:29,080 --> 00:47:32,400
that's actually more important which
Android pushing your you're running

770
00:47:32,400 --> 00:47:36,840
because for example Android 4.0 cheese
not out yet but it will have

771
00:47:36,840 --> 00:47:41,990
a it will have ASLR and it will also
have the key chain

772
00:47:41,990 --> 00:47:44,990
so you don't have to the world his
passwords in plain and more

773
00:47:44,990 --> 00:47:48,120
so it it's more important which Android
worst news

774
00:47:48,120 --> 00:47:51,210
but well again it doesn't matter

775
00:47:51,210 --> 00:47:54,850
you just have to check that that there's
a root exploit for

776
00:47:54,850 --> 00:47:58,220
your Android version so you can just
program

777
00:47:58,220 --> 00:48:02,590
be questioned

778
00:48:02,590 --> 00:48:06,270
given why you could read to you on the T

779
00:48:06,270 --> 00:48:09,770
1500 abs even though you've found
thousand

780
00:48:09,770 --> 00:48:13,270
well basically I was livid lazy

781
00:48:13,270 --> 00:48:17,040
Michael to sleep was living sleaze Noah
in the end

782
00:48:17,040 --> 00:48:20,150
Google I the first like

783
00:48:20,150 --> 00:48:23,730
50 or 100 aP's which is like I got

784
00:48:23,730 --> 00:48:29,070
normal HP two hundred responses I guess
because TPK files were small enough

785
00:48:29,070 --> 00:48:33,790
searches got yeah okay your is the file
and I started and everything was good

786
00:48:33,790 --> 00:48:38,580
so I automate didn't let just let it run
enough to three days they realize that

787
00:48:38,580 --> 00:48:41,930
for big gaps its some returning and

788
00:48:41,930 --> 00:48:45,550
ATP 2006 or something like that so
there's more

789
00:48:45,550 --> 00:48:48,790
content coming and yeah got that

790
00:48:48,790 --> 00:48:52,540
the point but basically just have to
work correctly called

791
00:48:52,540 --> 00:48:56,050
already states are with you Steve good
market API

792
00:48:56,050 --> 00:49:00,870
library to just Donald that

793
00:49:00,870 --> 00:49:05,730
did and question I'm from earlier

794
00:49:05,730 --> 00:49:09,640
research have you seen any applications
try to protect themselves

795
00:49:09,640 --> 00:49:13,380
arm the question gives in on indirection

796
00:49:13,380 --> 00:49:17,290
you mentioned that it's pretty easy once
you route to state Route

797
00:49:17,290 --> 00:49:20,580
yeah if you have a application that
communicates with

798
00:49:20,580 --> 00:49:24,760
surveillance arm ass all applications
are signs

799
00:49:24,760 --> 00:49:28,470
couldn't you as an application first
check

800
00:49:28,470 --> 00:49:31,870
it been signs and if you come indicate
was server

801
00:49:31,870 --> 00:49:36,100
once again check still the original
certificate ours

802
00:49:36,100 --> 00:49:39,430
original digital signage on he

803
00:49:39,430 --> 00:49:43,160
you mean by changing yeah and with you
recompile it

804
00:49:43,160 --> 00:49:46,760
inside with your own signature well it
wasn't

805
00:49:46,760 --> 00:49:50,600
yet problem is sexually that the its
like the app

806
00:49:50,600 --> 00:49:53,910
is unpacking itself so they pick a
fellow sorry AC

807
00:49:53,910 --> 00:49:57,350
installed on camera device that somehow
unpacking

808
00:49:57,350 --> 00:50:01,030
and first full I don't think that a.m.
the

809
00:50:01,030 --> 00:50:05,250
and what up has access to do. regional a
pic if I'll even if it had

810
00:50:05,250 --> 00:50:08,690
it would know if the 50 unpacked worsen
is

811
00:50:08,690 --> 00:50:12,220
the still correct so I guess you could
implement

812
00:50:12,220 --> 00:50:16,490
some some things but problem is still
the same when you're rude to you have

813
00:50:16,490 --> 00:50:17,010
more

814
00:50:17,010 --> 00:50:21,400
missions or yeah open Legion can also

815
00:50:21,400 --> 00:50:24,710
organism nothing in this direction you
seamless on the

816
00:50:24,710 --> 00:50:29,090
not that far or have are had some I had
some crashes

817
00:50:29,090 --> 00:50:33,120
mister Decompiler and I'm not sure if
safety the

818
00:50:33,120 --> 00:50:37,080
up the train like reba anti reversing

819
00:50:37,080 --> 00:50:44,080
techniques but I'm not sure I don't
think so

820
00:50:48,300 --> 00:50:53,940
any more questions

821
00:50:53,940 --> 00:50:55,530
but

822
00:50:55,530 --> 00:50:56,130
okay thanks

