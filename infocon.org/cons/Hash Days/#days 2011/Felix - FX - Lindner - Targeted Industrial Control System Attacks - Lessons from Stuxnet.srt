1
00:00:10,590 --> 00:00:12,240
so

2
00:00:12,240 --> 00:00:15,750
first of all I have to apologize amended
the worse enough to fight

3
00:00:15,750 --> 00:00:20,060
to see is not the latest version and
here's an advice to all you haters

4
00:00:20,060 --> 00:00:24,119
if you're drunk and stoned arm and you
think it's a good idea to clean up your

5
00:00:24,119 --> 00:00:26,470
conference laptop before you go to the
conference

6
00:00:26,470 --> 00:00:29,779
don't a especially because you

7
00:00:29,779 --> 00:00:33,970
might happen to delete a directory dad
is containing the presentation for the

8
00:00:33,970 --> 00:00:36,090
conference you're going to which

9
00:00:36,090 --> 00:00:40,379
I happened to manage to do so this is a
older were Shin

10
00:00:40,379 --> 00:00:44,090
um but just slightly older on that about
me

11
00:00:44,090 --> 00:00:47,180
so 10 a.m. what are we covering some

12
00:00:47,180 --> 00:00:50,180
everyone is familiar with Stuxnet in
general but

13
00:00:50,180 --> 00:00:54,820
I would like to actually in I give you a
little bit more details about it as

14
00:00:54,820 --> 00:00:56,379
though you can appreciate

15
00:00:56,379 --> 00:00:59,739
d engineering done with this piece of

16
00:00:59,739 --> 00:01:03,989
targeted now where I if you're in
software development

17
00:01:03,989 --> 00:01:07,649
or your company is in software
development please make note

18
00:01:07,649 --> 00:01:12,550
this is how you build actual good
software so if all our productions

19
00:01:12,550 --> 00:01:14,060
offered like SAP

20
00:01:14,060 --> 00:01:18,220
or whatever um outlook would be
engineered to same way Stuxnet would be

21
00:01:18,220 --> 00:01:21,260
was engineered we wouldn't have a lotta

22
00:01:21,260 --> 00:01:24,790
problems that we have today serb arm

23
00:01:24,790 --> 00:01:28,650
and a sec to showcase in good
engineering some

24
00:01:28,650 --> 00:01:32,890
so let's start off with am what are the
actual gold solve

25
00:01:32,890 --> 00:01:36,250
attacking industrial control processes
so

26
00:01:36,250 --> 00:01:40,860
um their is a couple of documented
attacks on industry control process

27
00:01:40,860 --> 00:01:44,900
um most of them are for demonstration
purpose so

28
00:01:44,900 --> 00:01:48,490
um we haven't seen a single one um

29
00:01:48,490 --> 00:01:51,509
except Ford delaying a random

30
00:01:51,509 --> 00:01:55,299
enrichment program which is Stuxnet
everything else

31
00:01:55,299 --> 00:01:59,939
train systems power grid and et cetera
um has been doomed

32
00:01:59,939 --> 00:02:03,280
I have been done to show dead it can be
done

33
00:02:03,280 --> 00:02:06,340
um Stuxnet is the first instance where

34
00:02:06,340 --> 00:02:09,410
was actually done it was done a lot
better den

35
00:02:09,410 --> 00:02:13,350
in the demonstrations before noun

36
00:02:13,350 --> 00:02:17,880
um when we look at attacks on industrial
control processes what

37
00:02:17,880 --> 00:02:22,230
what is the most likely thing we're
gonna see cyberwar turning off power in

38
00:02:22,230 --> 00:02:23,760
the entire western hemisphere

39
00:02:23,760 --> 00:02:27,910
no very unlikely what is more likely as
and we're gonna see

40
00:02:27,910 --> 00:02:31,530
harming the competition think about
today's

41
00:02:31,530 --> 00:02:34,550
production cycles let's say in the car
industry

42
00:02:34,550 --> 00:02:37,640
and a half essentially zero storage

43
00:02:37,640 --> 00:02:41,080
raid arm everything is produced just in
time

44
00:02:41,080 --> 00:02:44,340
and deliver just in time so if you can
make

45
00:02:44,340 --> 00:02:48,160
let's say the production line for Rio my
really AM

46
00:02:48,160 --> 00:02:51,879
arm rhea you mara's fuck word

47
00:02:51,879 --> 00:02:55,450
arm forward for a car manufacture

48
00:02:55,450 --> 00:02:59,180
if you can delay does production for
lets a week warehouse a week

49
00:02:59,180 --> 00:03:02,200
at the entire production of the common a
picture goes down

50
00:03:02,200 --> 00:03:05,260
so this is actually a very very likely
scenario

51
00:03:05,260 --> 00:03:09,440
especially given the fact did I'm pretty
much every secret service in a developed

52
00:03:09,440 --> 00:03:09,950
world

53
00:03:09,950 --> 00:03:14,129
is now fifty percent industries be a
Nash and fifty percent

54
00:03:14,129 --> 00:03:17,430
um military's B&H um

55
00:03:17,430 --> 00:03:21,650
the other thing that we've seen is
essentially blackmailing ICS owners

56
00:03:21,650 --> 00:03:25,989
and this is this actually happened um
quite often so in

57
00:03:25,989 --> 00:03:29,510
and our professional life I'm we had a
case

58
00:03:29,510 --> 00:03:32,510
Ave manufacture love

59
00:03:32,510 --> 00:03:37,239
ICS equipment and um the guy you act you
bro to code

60
00:03:37,239 --> 00:03:41,310
um 40 ICS environment just left the
company in to cope with them

61
00:03:41,310 --> 00:03:46,290
and essentially blackmailed the company
into hiring him back as a consultant

62
00:03:46,290 --> 00:03:50,269
them so they called I G continue
producing the products

63
00:03:50,269 --> 00:03:53,409
another case which has mentioned here

64
00:03:53,409 --> 00:03:56,650
is um mister Terry childs who from

65
00:03:56,650 --> 00:04:01,019
was the network administrator for the
city of San Francisco and he was kinda

66
00:04:01,019 --> 00:04:04,129
annoyed about to politics and he wanted
to speak to two major

67
00:04:04,129 --> 00:04:08,580
so he essentially changed all the
passwords on it just goes

68
00:04:08,580 --> 00:04:12,560
and um yeah shut down the network a.m.

69
00:04:12,560 --> 00:04:15,900
he managed to speak to two major also
that was a visit from

70
00:04:15,900 --> 00:04:20,918
into prison and sodas this idea actually
didn't pan out too well for him

71
00:04:20,919 --> 00:04:25,130
um and also we have industry is being
ash

72
00:04:25,130 --> 00:04:28,220
as an ICS attack vector arm

73
00:04:28,220 --> 00:04:33,190
there's industries Lake potato chip
industry I am to chip in a stream

74
00:04:33,190 --> 00:04:36,680
abusers the same production equipment

75
00:04:36,680 --> 00:04:40,620
everyone uses the same production
equipment there's just a few vendors

76
00:04:40,620 --> 00:04:43,750
arm that can builds production equipment
that can make

77
00:04:43,750 --> 00:04:47,550
chips from silicon raid the only
difference

78
00:04:47,550 --> 00:04:52,020
between one chip vendor and the other is
the so-called recipes

79
00:04:52,020 --> 00:04:55,830
that essentially just the configuration
file on the production line

80
00:04:55,830 --> 00:04:59,400
so the configuration file makes the
difference between an AMD chip in an

81
00:04:59,400 --> 00:05:00,680
internship

82
00:05:00,680 --> 00:05:04,650
so having to recipes is essentially
having

83
00:05:04,650 --> 00:05:09,050
all the secrets of this vendor so
breaking into the ICS and just stealing

84
00:05:09,050 --> 00:05:10,280
the recipe without

85
00:05:10,280 --> 00:05:15,610
actually changing anything um is a very
lucrative business

86
00:05:15,610 --> 00:05:18,759
am when you look at industrial control
processes

87
00:05:18,759 --> 00:05:22,270
and compared them to regular
pirate-infested

88
00:05:22,270 --> 00:05:25,780
offers I G um there are some differences

89
00:05:25,780 --> 00:05:29,870
a that the biggest difference actually
is availability

90
00:05:29,870 --> 00:05:33,690
in office I do you were in any other IT
environment you connect to go ahead and

91
00:05:33,690 --> 00:05:37,110
say well we have a scheduled downtime
because we have to install service pack

92
00:05:37,110 --> 00:05:39,300
3 50 on exchange

93
00:05:39,300 --> 00:05:42,960
ride so in ICS let's and power grids

94
00:05:42,960 --> 00:05:46,580
downtime not so good people tend to
notice

95
00:05:46,580 --> 00:05:50,930
um same for wastewater cleaning people
tend to notice if you have a down time

96
00:05:50,930 --> 00:05:51,440
and

97
00:05:51,440 --> 00:05:54,470
you know there's literal shit coming out
after

98
00:05:54,470 --> 00:05:57,479
the water tap parade so you can actually
turn shit

99
00:05:57,479 --> 00:06:02,880
of to fix it um the same as like
anti-virus okay dad hasn't saved anyone

100
00:06:02,880 --> 00:06:03,449
at last

101
00:06:03,449 --> 00:06:07,169
twenty thirty years um but it's actually
very

102
00:06:07,169 --> 00:06:11,160
impossible to use they have a life time
about twenty years

103
00:06:11,160 --> 00:06:15,460
so if you have a Bach a.m. let's say in
Siemens

104
00:06:15,460 --> 00:06:21,600
PLC's then arm it is very unlikely to
decide she gets fixed over to lifetime

105
00:06:21,600 --> 00:06:24,919
because you don't have to I'm types um

106
00:06:24,919 --> 00:06:29,069
vendors are just as dumb as we know them
but because there's no disclosure

107
00:06:29,069 --> 00:06:31,199
process they're not fixing shit

108
00:06:31,199 --> 00:06:34,340
arm you really have to change management

109
00:06:34,340 --> 00:06:39,039
a change management happens in the
brains of Deacons items that come inside

110
00:06:39,039 --> 00:06:42,840
and fix your your control system um

111
00:06:42,840 --> 00:06:45,860
and security for them is essentially
physical security

112
00:06:45,860 --> 00:06:49,780
so if if you make it into the production
facility

113
00:06:49,780 --> 00:06:54,020
that is all security you need to bypass
if you need to know how to do to add

114
00:06:54,020 --> 00:06:57,280
a talk to mister nichols um

115
00:06:57,280 --> 00:07:01,919
and also even simple things like time
and and low correlation

116
00:07:01,919 --> 00:07:06,639
so here's an example and I can tell you
where I got this picture

117
00:07:06,639 --> 00:07:11,300
I'm desist a2 E two parts of a picture
from an actual

118
00:07:11,300 --> 00:07:15,800
Iranian mics and if you look closely

119
00:07:15,800 --> 00:07:18,840
you see here there's an alarm that says

120
00:07:18,840 --> 00:07:22,500
you know a.m. 2031

121
00:07:22,500 --> 00:07:25,889
December I'm this is when the alarm
happened

122
00:07:25,889 --> 00:07:29,770
so unless someone managed to time travel
they actually

123
00:07:29,770 --> 00:07:33,610
don't care about the time because the
real time is said here to walk on time

124
00:07:33,610 --> 00:07:35,389
which is on 2009

125
00:07:35,389 --> 00:07:38,530
lot more realistic and you can also see
um

126
00:07:38,530 --> 00:07:41,539
that the login a on user is use a one

127
00:07:41,539 --> 00:07:45,160
so also use a management is not a big
deal in ICS

128
00:07:45,160 --> 00:07:50,889
raid unless of course use the one as an
actor Iranian name

129
00:07:50,889 --> 00:07:54,199
says stegner detect patterns um

130
00:07:54,199 --> 00:07:57,710
the actual easiest way to get into an
ICS

131
00:07:57,710 --> 00:08:01,229
is simply by finding someone to bring
the stuff in

132
00:08:01,229 --> 00:08:04,520
I'm so I love you can you know

133
00:08:04,520 --> 00:08:08,220
as a just mentioned you can remove the
source code from the side

134
00:08:08,220 --> 00:08:12,250
or you can actually change the
configuration arm

135
00:08:12,250 --> 00:08:15,349
the second thing is thanks to management

136
00:08:15,349 --> 00:08:19,990
founder is a gazillion dashboard
applications

137
00:08:19,990 --> 00:08:23,500
there's even an SAP a.m. subsystem
that's called the

138
00:08:23,500 --> 00:08:29,310
SAP plant management which you can
configure to go into your ICS

139
00:08:29,310 --> 00:08:33,000
and monito read the entire production
line um

140
00:08:33,000 --> 00:08:37,890
in in a project with a customer once
tried to configure a fight a war

141
00:08:37,890 --> 00:08:42,729
in order to only let the ports through
that SAP plant management would need

142
00:08:42,729 --> 00:08:45,900
to get the information out of the plant
I am

143
00:08:45,900 --> 00:08:48,959
eventually we replaced if I will buy
router

144
00:08:48,959 --> 00:08:53,880
because that was equivalent to two ruled
said that we already had

145
00:08:53,880 --> 00:08:59,490
a.m. meaning we had to open the entire
thing

146
00:08:59,490 --> 00:09:02,990
and do you those management systems are
lot easier to find droid

147
00:09:02,990 --> 00:09:07,220
because they're mostly web-based a.m.
the next thing is

148
00:09:07,220 --> 00:09:11,980
you can simply pre compromise um the
equipment that someone needs

149
00:09:11,980 --> 00:09:16,250
that is usually used by arm by secret
services

150
00:09:16,250 --> 00:09:20,470
when they figure out well from this

151
00:09:20,470 --> 00:09:25,339
this company or discount re I need to
build such and such production line

152
00:09:25,339 --> 00:09:29,890
to figuring out to two or three possible
vendors that the call by from

153
00:09:29,890 --> 00:09:34,330
then they get the equipment back toward
the equipment and sell it cheaper

154
00:09:34,330 --> 00:09:38,680
um the determinative way of course is
the Chinese Way where the israeli way

155
00:09:38,680 --> 00:09:41,810
where um the government Archie's
subsidizes

156
00:09:41,810 --> 00:09:46,450
yeah for commerce or variant as they are
called now reid

157
00:09:46,450 --> 00:09:51,480
a.m. so essentially what they do is they
simply subsidize health of the price

158
00:09:51,480 --> 00:09:55,529
from the government sites so this is the
lowest bidder by far

159
00:09:55,529 --> 00:09:59,100
and and you know management is very
predictable when is the half the price

160
00:09:59,100 --> 00:10:00,100
of something

161
00:10:00,100 --> 00:10:03,290
they're gonna buy it um works really
well

162
00:10:03,290 --> 00:10:08,230
um the you would wonder how who are we
actually get all their equipment into

163
00:10:08,230 --> 00:10:10,370
our networks

164
00:10:10,370 --> 00:10:14,019
so um there's other ways of course I'm
to get

165
00:10:14,019 --> 00:10:17,020
um to get

166
00:10:17,020 --> 00:10:19,700
eat the stuff that is not cheap and hit

167
00:10:19,700 --> 00:10:23,070
Miko actually found this arm this is the

168
00:10:23,070 --> 00:10:26,730
fairly expensive Siemens control
software that you need to run

169
00:10:26,730 --> 00:10:30,820
um the men's plz send to program them
and here's a user called

170
00:10:30,820 --> 00:10:34,070
Ahmadinejad dead from as for seeding

171
00:10:34,070 --> 00:10:39,570
I'm can like make sense now awesome

172
00:10:39,570 --> 00:10:42,760
the the standard external attack pattern
is

173
00:10:42,760 --> 00:10:46,400
actually go I had find some secretary
poses workstation

174
00:10:46,400 --> 00:10:50,520
compromise that one a.m. or compromise
the secretary

175
00:10:50,520 --> 00:10:53,580
that is optional fuck

176
00:10:53,580 --> 00:10:57,590
I'm from there you compromise some
servers

177
00:10:57,590 --> 00:11:00,960
best way of course is is management
systems dashboards

178
00:11:00,960 --> 00:11:04,140
but it can be just the main controllers
arm

179
00:11:04,140 --> 00:11:07,630
dan you establish a man in a middle
point between armed the operator

180
00:11:07,630 --> 00:11:11,440
like dirt aboard guy with a comic
sitting in front of the of to stream

181
00:11:11,440 --> 00:11:15,770
and dr. Choi CS equipment and then you
modify to control system

182
00:11:15,770 --> 00:11:19,230
nobody notices as doug said goes away he

183
00:11:19,230 --> 00:11:23,220
beyond that and we're gonna covered at
in a minute so

184
00:11:23,220 --> 00:11:27,990
your s it's not removed um I had the
pleasure of

185
00:11:27,990 --> 00:11:31,600
actually playing from sorry training
from

186
00:11:31,600 --> 00:11:34,670
with a group at the Idaho National
Laboratory

187
00:11:34,670 --> 00:11:37,670
in 2005 their were

188
00:11:37,670 --> 00:11:42,730
already and let's say considering this
type of attack in

189
00:11:42,730 --> 00:11:46,430
a.m. and term so the story is

190
00:11:46,430 --> 00:11:49,920
the meeting in turn a video for the US
government to

191
00:11:49,920 --> 00:11:54,110
you note sell their services inside the
US government on which they showed me

192
00:11:54,110 --> 00:11:55,980
but they said well I can't give you that

193
00:11:55,980 --> 00:11:59,730
turns out in that in the beginning of
the video a.m.

194
00:11:59,730 --> 00:12:03,360
dimension to evil cyber terrorists and
showed a few led by page

195
00:12:03,360 --> 00:12:07,620
I'm which day realize the moment they
showed it to me

196
00:12:07,620 --> 00:12:10,810
and so we made a deal and i actually
gave me a copy of the video

197
00:12:10,810 --> 00:12:14,830
but that's the state-of-the-art in 2005
so

198
00:12:14,830 --> 00:12:19,310
as it can whereas you have seen there's
many of the patterns that we've seen in

199
00:12:19,310 --> 00:12:20,630
stocks net where

200
00:12:20,630 --> 00:12:24,250
known in 2005 it's not a it's not a big
deal

201
00:12:24,250 --> 00:12:28,310
if you're really you know into something
I doubt I'm to actually develop the

202
00:12:28,310 --> 00:12:29,070
exploits

203
00:12:29,070 --> 00:12:32,100
um the thing instead

204
00:12:32,100 --> 00:12:35,100
MDD environment actually bought the
display

205
00:12:35,100 --> 00:12:40,550
it used to be that every control system
as jason said in the video

206
00:12:40,550 --> 00:12:45,050
every control system is different grade
you actually have to know how it works

207
00:12:45,050 --> 00:12:50,050
now at standardization um is something
that can actually by Joe has pretty

208
00:12:50,050 --> 00:12:50,680
nicely

209
00:12:50,680 --> 00:12:54,010
I'm so the military started to use um

210
00:12:54,010 --> 00:12:57,390
commercial off-the-shelf equipment and
now is wondering why

211
00:12:57,390 --> 00:13:00,839
they have viruses on their drone control
does um

212
00:13:00,839 --> 00:13:04,900
and the industrial control system people
actually started to use

213
00:13:04,900 --> 00:13:08,110
very common technology so um

214
00:13:08,110 --> 00:13:12,970
did the landscape really changes stairs
lots of plug-and-play technology that

215
00:13:12,970 --> 00:13:14,010
you can put into

216
00:13:14,010 --> 00:13:17,270
a.m. into pepe is now and from

217
00:13:17,270 --> 00:13:21,980
02 the control processes are no longer
so different from each other

218
00:13:21,980 --> 00:13:26,010
one example is am and at an actual scary
example

219
00:13:26,010 --> 00:13:30,080
putting cable DCE like action electrical
cable to into

220
00:13:30,080 --> 00:13:34,610
a in mum into a fat mom factory is very
expensive

221
00:13:34,610 --> 00:13:39,060
because they have to be heat resistant
they have to be acid resistant imbaba

222
00:13:39,060 --> 00:13:42,370
so you know what they're actually doing
now to using wireless

223
00:13:42,370 --> 00:13:47,120
because wifi actually allows them to you
know have less cables and it's a lot

224
00:13:47,120 --> 00:13:48,730
cheaper to build up the factory

225
00:13:48,730 --> 00:13:52,010
so you're walking by a factory and you
have like valves on

226
00:13:52,010 --> 00:13:56,420
on as the tens that like stroll by
little ipv4 IP address

227
00:13:56,420 --> 00:13:59,850
and bleak on the network name and the
SSID

228
00:13:59,850 --> 00:14:03,120
and of course the they're not
interrupted because key distribution is

229
00:14:03,120 --> 00:14:03,990
problem grade

230
00:14:03,990 --> 00:14:09,120
them so at this is actually the Lakewood
would landscape just lookin

231
00:14:09,120 --> 00:14:13,660
at right now so now let's look at
Stuxnet

232
00:14:13,660 --> 00:14:18,210
'em the Stuxnet actually comes with a

233
00:14:18,210 --> 00:14:21,500
range of spreading mechanisms right so
we have

234
00:14:21,500 --> 00:14:26,300
the Alan cave on ability dad you know
all the AV companies dropped off about

235
00:14:26,300 --> 00:14:28,780
it because it was your day in Windows
seven and then

236
00:14:28,780 --> 00:14:31,910
ignored the fact that there's a lot more
to stocks and then this

237
00:14:31,910 --> 00:14:37,810
so firm goes to Alan Cade Windows Task
Editor keyboard layout print spooler

238
00:14:37,810 --> 00:14:43,070
I'm the old RPC issue um and urself
copying to remote network drives

239
00:14:43,070 --> 00:14:46,880
armed urself copping two cement C&C
servers

240
00:14:46,880 --> 00:14:50,450
an infection of our step 7 project files

241
00:14:50,450 --> 00:14:53,860
that's a lotta spreading mechanisms um

242
00:14:53,860 --> 00:14:57,030
we also have peer to peer updating serb
you know

243
00:14:57,030 --> 00:15:01,690
men in case you don't reached update
side offenders and C&C server

244
00:15:01,690 --> 00:15:05,000
there is a couple uprooted drivers arm

245
00:15:05,000 --> 00:15:08,400
the drivers i actually signed with code
certificates

246
00:15:08,400 --> 00:15:12,790
um and there's circumvention of a lot of
Client Security product

247
00:15:12,790 --> 00:15:16,930
enters a nice day we're loading routine
to circumvent host-based intrusion

248
00:15:16,930 --> 00:15:18,610
detection systems

249
00:15:18,610 --> 00:15:21,810
and so let's go into the details a No

250
00:15:21,810 --> 00:15:25,410
there's more of course there's a
fingerprinting over ICS

251
00:15:25,410 --> 00:15:29,570
murders back during um of 20c server and

252
00:15:29,570 --> 00:15:32,670
there's in this is a very nice one a.m.
is

253
00:15:32,670 --> 00:15:36,560
deep virtualization of appeared see
within itself

254
00:15:36,560 --> 00:15:40,860
in order to not have to do operated
spoofing

255
00:15:40,860 --> 00:15:44,400
so the first one and one came um

256
00:15:44,400 --> 00:15:48,220
most of you have probably looked at it
um it uses a special feature

257
00:15:48,220 --> 00:15:52,790
so Alan KR did little files that gives
your shortcut on windows because Windows

258
00:15:52,790 --> 00:15:53,190
sucks

259
00:15:53,190 --> 00:15:56,940
short it softly X-rayed some so

260
00:15:56,940 --> 00:16:00,450
it uses a little-known feature within
the Alan Kay filed

261
00:16:00,450 --> 00:16:05,589
where usually Jetton lMK if I just says
well this is when pointing to

262
00:16:05,589 --> 00:16:08,750
and then when Windows has to load the
Alan Kay file

263
00:16:08,750 --> 00:16:13,829
it will look where it points to look for
the Aiken of dad and then map this

264
00:16:13,829 --> 00:16:14,670
little

265
00:16:14,670 --> 00:16:18,040
arrow um for the link on top of that
item

266
00:16:18,040 --> 00:16:22,700
um what it does here is it uses a
feature where

267
00:16:22,700 --> 00:16:27,140
I'm ive d them to link actually goes
into special files that are in the

268
00:16:27,140 --> 00:16:28,310
control panel

269
00:16:28,310 --> 00:16:32,510
you know settings and stuff um then it
will actually check

270
00:16:32,510 --> 00:16:37,700
um what the status of this control panel
Aiken is because those can change

271
00:16:37,700 --> 00:16:42,570
so in order to find is out it will
actually lowered the corresponding dáil

272
00:16:42,570 --> 00:16:47,589
using load library now if you loaded TRL
using load library you automatically

273
00:16:47,589 --> 00:16:50,120
also execute idea of its main function

274
00:16:50,120 --> 00:16:54,000
which is exactly what happened here so
you're putting DL Inc a file

275
00:16:54,000 --> 00:16:57,490
and a dáil next to each other have donk
five-point

276
00:16:57,490 --> 00:17:00,550
to DL with him

277
00:17:00,550 --> 00:17:04,360
with a saint with a status this is a
control

278
00:17:04,360 --> 00:17:08,020
panel i kum and and it will actually
load to DL

279
00:17:08,020 --> 00:17:12,730
in order to find Aiken that gives you
100 percent reliable execution of code

280
00:17:12,730 --> 00:17:17,300
Indy explorer.exe I'm context

281
00:17:17,300 --> 00:17:20,500
and the second one the task scheduler im
is

282
00:17:20,500 --> 00:17:24,410
essentially it's this year's see 32
compensation attack

283
00:17:24,410 --> 00:17:27,620
so what Windows did um when and kisses

284
00:17:27,620 --> 00:17:31,030
um post XP I think winners dozen

285
00:17:31,030 --> 00:17:34,860
in the task scheduler is when you
schedule task you can actually set a

286
00:17:34,860 --> 00:17:36,140
couple of things like

287
00:17:36,140 --> 00:17:39,679
when does it run under which use a
context blah blah blah

288
00:17:39,679 --> 00:17:44,610
so arm when you create that ask its
doors in XML file

289
00:17:44,610 --> 00:17:48,710
but the XML file is still owned by the
user otherwise he would have about

290
00:17:48,710 --> 00:17:49,669
ability right there

291
00:17:49,669 --> 00:17:54,510
right so when that house when the time
comes to execute a task

292
00:17:54,510 --> 00:17:58,690
and the task under actually tries to
make sure that the files still the same

293
00:17:58,690 --> 00:18:03,960
so the way they did that was when the
house was created it will actually be um

294
00:18:03,960 --> 00:18:07,280
policy received 32 over the entire file

295
00:18:07,280 --> 00:18:11,660
and then Wendy executed house it would
verify to the crc32

296
00:18:11,660 --> 00:18:16,540
is still the same now most you will
probably notice your issue 32 is not a

297
00:18:16,540 --> 00:18:17,960
cryptographic hash

298
00:18:17,960 --> 00:18:22,360
and can be compensated so what would
your tag does is it creates

299
00:18:22,360 --> 00:18:25,850
you create a task the XML gets Britain

300
00:18:25,850 --> 00:18:28,860
um then it changes the user am

301
00:18:28,860 --> 00:18:32,150
them as which that house was to be
executed

302
00:18:32,150 --> 00:18:36,520
to administrator or system and then
perhaps the file onto a dirty received

303
00:18:36,520 --> 00:18:37,570
32 is

304
00:18:37,570 --> 00:18:41,360
the same again and so when Tesco track
two runs the task

305
00:18:41,360 --> 00:18:44,770
were executed as a privileged user again

306
00:18:44,770 --> 00:18:48,310
this gives you 100 percent reliable code
execution wouldn't have a single buffer

307
00:18:48,310 --> 00:18:49,380
overflow in here

308
00:18:49,380 --> 00:18:53,210
the system your logic block right

309
00:18:53,210 --> 00:18:57,810
so um Windows XP and lower don't have to
task scheduler and as for and they are

310
00:18:57,810 --> 00:19:01,780
not writing XML file too so they needed
another bond ability

311
00:19:01,780 --> 00:19:05,510
this one here um loads the keyboard
layout

312
00:19:05,510 --> 00:19:09,929
so an XP and below the keyboard layout
that you're loading the layout file

313
00:19:09,929 --> 00:19:13,210
can be anywhere grant arm later on

314
00:19:13,210 --> 00:19:17,530
Microsoft decided it must be below do it
this system directory

315
00:19:17,530 --> 00:19:21,270
now on XP and below it can be in
wherever you want

316
00:19:21,270 --> 00:19:24,640
and you tell the operating system to
load the file now they have

317
00:19:24,640 --> 00:19:28,290
a unchecked index within this file so
far has an index

318
00:19:28,290 --> 00:19:32,940
some into some table they're not taking
the index the table actually

319
00:19:32,940 --> 00:19:37,090
only has like four or five entries home
so

320
00:19:37,090 --> 00:19:40,929
um what happens if if you put in but a
higher index in there

321
00:19:40,929 --> 00:19:45,110
it will go past the table somewhere and
and call coat

322
00:19:45,110 --> 00:19:48,450
however I'm this is actually done by to
colonel

323
00:19:48,450 --> 00:19:55,100
um now day needed to find a way to
actually reliably execute code also

324
00:19:55,100 --> 00:19:58,800
its internal space and they don't know
how to memory in current space is gonna

325
00:19:58,800 --> 00:19:59,639
look like

326
00:19:59,640 --> 00:20:03,140
so what they do it was they're actually
skimming

327
00:20:03,140 --> 00:20:06,510
um the memory of and from

328
00:20:06,510 --> 00:20:09,750
and the resulting memory of the loaded
keymap

329
00:20:09,750 --> 00:20:13,550
for addresses that are be low I'm to
magic number

330
00:20:13,550 --> 00:20:16,800
them off 8000 users and 0 um

331
00:20:16,800 --> 00:20:21,020
hamster in userspace then day run a
program

332
00:20:21,020 --> 00:20:25,280
a prepper program that maps at this
address the Deaf Island

333
00:20:25,280 --> 00:20:28,840
from a memory page would actual code and
Dan

334
00:20:28,840 --> 00:20:32,530
this program causes windows too low to
keyboard layout

335
00:20:32,530 --> 00:20:37,419
pretty decent in also a hundred percent
reliable

336
00:20:37,419 --> 00:20:41,300
um next thing printer spooler I'm the
one was fun

337
00:20:41,300 --> 00:20:44,950
zone I usually when you when you print
on a remote

338
00:20:44,950 --> 00:20:48,320
friend share I'm on a print spooler some

339
00:20:48,320 --> 00:20:51,760
what the print spooler does is it looks
up to use a credentialed and then

340
00:20:51,760 --> 00:20:53,149
impersonates

341
00:20:53,149 --> 00:20:58,399
the process itself as the user right so
it's printing with your permissions

342
00:20:58,399 --> 00:21:01,730
an odd with someone else now the in the
issue is

343
00:21:01,730 --> 00:21:05,600
if you're any anonymous user make night
session for example

344
00:21:05,600 --> 00:21:09,560
on Window System Microsoft had an issue
figuring out well

345
00:21:09,560 --> 00:21:13,610
wonder who do we um who do we
impersonated here

346
00:21:13,610 --> 00:21:17,560
so well we don't wear doing it as system

347
00:21:17,560 --> 00:21:20,860
now bad by itself wasn't really a
viability

348
00:21:20,860 --> 00:21:25,490
the interesting part is that when you
print a you can also submit

349
00:21:25,490 --> 00:21:29,370
a so-called mofo file from funny side
story

350
00:21:29,370 --> 00:21:33,380
the Microsoft security researchers spend
about a day

351
00:21:33,380 --> 00:21:36,590
finding someone at Microsoft campus who
even know

352
00:21:36,590 --> 00:21:40,450
or new what moof fights are and what
they're doing

353
00:21:40,450 --> 00:21:43,640
well the attackers didn't know um so

354
00:21:43,640 --> 00:21:46,679
what what they're doing is they're
essentially like little bit like

355
00:21:46,679 --> 00:21:47,480
postscript

356
00:21:47,480 --> 00:21:51,179
there controlling scripts for the
printer so you can set up the printer

357
00:21:51,179 --> 00:21:52,330
correctly

358
00:21:52,330 --> 00:21:55,610
I'm so late you know what page
orientation blah blah blah

359
00:21:55,610 --> 00:22:00,649
also you can execute commands you know
you can execute coat

360
00:22:00,649 --> 00:22:04,179
um so what happens as you're submitting
the MiFi I'll

361
00:22:04,179 --> 00:22:09,760
together with the print shop and %um bed
in the xy file into the MMF in web file

362
00:22:09,760 --> 00:22:14,100
it ends up in a directory in a special
directory under dust system 32

363
00:22:14,100 --> 00:22:18,169
and Windows continuously scans for TMR
file and fires at of

364
00:22:18,169 --> 00:22:21,780
just run said as system well that gives
you

365
00:22:21,780 --> 00:22:25,919
100 percent reliable remote code
execution

366
00:22:25,919 --> 00:22:29,060
see a pattern am

367
00:22:29,060 --> 00:22:32,090
what's also interesting a is the 2008

368
00:22:32,090 --> 00:22:36,399
a.m. service a responsibility to their
but that they're using it to

369
00:22:36,399 --> 00:22:41,210
very old um RPC path can on occurs Asian
buck

370
00:22:41,210 --> 00:22:45,899
dead apparently still really works
really well in some parts of this

371
00:22:45,899 --> 00:22:49,800
globe um as where recently seeing what
to do to you

372
00:22:49,800 --> 00:22:53,600
were however you pronounce that thing
armed code reuse

373
00:22:53,600 --> 00:22:57,040
um and Stuxnet were not thingy

374
00:22:57,040 --> 00:23:01,740
a well 0 all those compromises
apparently come from the same viability

375
00:23:01,740 --> 00:23:05,860
its Britt eaten straight forward pack up
chemical ionisation issue

376
00:23:05,860 --> 00:23:09,050
um in contrast to the other bun
abilities that way

377
00:23:09,050 --> 00:23:12,370
already covered this one actually
doesn't have um

378
00:23:12,370 --> 00:23:17,990
100 percent reliability bid seriously if
you look at me to exploit into list of

379
00:23:17,990 --> 00:23:19,030
targets that

380
00:23:19,030 --> 00:23:23,850
are um within the Metasploit module and
to sheer amount of people that have

381
00:23:23,850 --> 00:23:27,140
successfully use this one ability to you

382
00:23:27,140 --> 00:23:31,760
gain access to something because they'd
forgot the password or PIN whatever

383
00:23:31,760 --> 00:23:35,260
um there's enough anecdotal

384
00:23:35,260 --> 00:23:38,560
knowledge about this possibility that
you can make it almost a hundred percent

385
00:23:38,560 --> 00:23:39,929
reliable

386
00:23:39,929 --> 00:23:45,050
I'm so this is the place pretty much in
the same room

387
00:23:45,050 --> 00:23:49,330
um to get around host-based I DS systems

388
00:23:49,330 --> 00:23:52,399
the they have a very very nice trick

389
00:23:52,399 --> 00:23:56,159
um well the host-based ideas is
snake-oil obviously

390
00:23:56,159 --> 00:23:59,169
um but

391
00:23:59,169 --> 00:24:02,490
day and they wanted a general general
way of doing that

392
00:24:02,490 --> 00:24:06,040
so essentially what they do is they're
hooking um

393
00:24:06,040 --> 00:24:09,530
d load library called some and

394
00:24:09,530 --> 00:24:12,659
when you do a load library calm um

395
00:24:12,659 --> 00:24:16,110
when they're when they're trying to load
their own libraries stocks led is all

396
00:24:16,110 --> 00:24:18,370
the yeltsin DL sections right

397
00:24:18,370 --> 00:24:22,690
when I try to load their own libraries
you're just a pending bullshit on it

398
00:24:22,690 --> 00:24:26,080
right bullshit but bolted in a dist in a
min

399
00:24:26,080 --> 00:24:29,760
discoverable pattern so didn't um

400
00:24:29,760 --> 00:24:33,840
in in a regular case they would just
pass on load library to its original

401
00:24:33,840 --> 00:24:37,550
function um in their own case

402
00:24:37,550 --> 00:24:41,770
they were actually correct to file name:
before loading the library

403
00:24:41,770 --> 00:24:46,260
what the host-based IDS sees is the
original fine and that they're trying to

404
00:24:46,260 --> 00:24:47,730
load with all the garbage

405
00:24:47,730 --> 00:24:51,320
the tries to open the file get to find
out front Aero goes like but

406
00:24:51,320 --> 00:24:54,820
that day I'll doesn't exist I don't need
to inspect it

407
00:24:54,820 --> 00:24:58,490
very easy am

408
00:24:58,490 --> 00:25:02,870
this is what I like the most so
apparently dated made a pretty good

409
00:25:02,870 --> 00:25:04,990
statistic on who uses what

410
00:25:04,990 --> 00:25:08,710
anti-virus solution within their target
area

411
00:25:08,710 --> 00:25:14,159
and so the anti-virus vendors all always
tell you now we don't just do signatures

412
00:25:14,159 --> 00:25:16,120
we also do your estates and

413
00:25:16,120 --> 00:25:21,230
arm a.m. you know we we look at D a
performance of the processes and their

414
00:25:21,230 --> 00:25:22,780
behavior

415
00:25:22,780 --> 00:25:27,120
well not all the processes some
processes eg to do all the things that

416
00:25:27,120 --> 00:25:28,440
viruses do

417
00:25:28,440 --> 00:25:32,010
arm for legitimate reason arms you can
probably guess

418
00:25:32,010 --> 00:25:36,330
that Allah as a as as as one of them
home elysees as does all the things that

419
00:25:36,330 --> 00:25:37,710
usually just meyerson

420
00:25:37,710 --> 00:25:41,649
where do I am and it's also pretty hard
to monitor port so they're just

421
00:25:41,649 --> 00:25:45,290
excluding it from the monitoring list
were even better

422
00:25:45,290 --> 00:25:49,270
term some of the year anti-virus
processes

423
00:25:49,270 --> 00:25:52,480
don't want to hurt themselves because
we're home you know

424
00:25:52,480 --> 00:25:56,409
the I'm the anti virus process right on
I can't do anything wrong

425
00:25:56,409 --> 00:25:59,909
so with Stuxnet does this actually
injecting fred's into

426
00:25:59,909 --> 00:26:03,820
um Kaspersky anti-virus into its own
process

427
00:26:03,820 --> 00:26:07,080
and runs with them cuz pesky that's just
a

428
00:26:07,080 --> 00:26:10,120
neatest way to show the antivirus arm

429
00:26:10,120 --> 00:26:13,690
industry how much they called a Proteus

430
00:26:13,690 --> 00:26:17,760
de must be some real fuck up indeed
trust worse in five and six because

431
00:26:17,760 --> 00:26:18,230
there'd

432
00:26:18,230 --> 00:26:21,950
actually just bailing out of their
fighters attorney to believe they're

433
00:26:21,950 --> 00:26:25,550
running at themselves

434
00:26:25,550 --> 00:26:29,220
am then for the project file TSO

435
00:26:29,220 --> 00:26:34,220
I'll stocks not actually im does a had
and patches

436
00:26:34,220 --> 00:26:38,520
all the project files for two years a
step 7 development environment so step 7

437
00:26:38,520 --> 00:26:39,860
as the environment did you

438
00:26:39,860 --> 00:26:44,830
program zemin's PLC's with a.m. the
project fights are essential the big zip

439
00:26:44,830 --> 00:26:45,760
file its

440
00:26:45,760 --> 00:26:49,669
with a certain directory structure
United um

441
00:26:49,669 --> 00:26:54,350
it's somewhat smart because every step 7
installation has a bunch

442
00:26:54,350 --> 00:26:57,550
of from sample files an example projects

443
00:26:57,550 --> 00:27:01,419
it's not infecting does and it's never
infecting projects that haven't been

444
00:27:01,419 --> 00:27:02,790
touched for three or

445
00:27:02,790 --> 00:27:08,370
longer years so I am it's not affecting
old stuff it's only infecting someone

446
00:27:08,370 --> 00:27:09,570
told stuff

447
00:27:09,570 --> 00:27:13,169
now zemin's apparently finds it totally

448
00:27:13,169 --> 00:27:17,210
susceptible but we have the following
mechanism within the project loading

449
00:27:17,210 --> 00:27:17,830
file

450
00:27:17,830 --> 00:27:20,879
by two projects are you just plz code

451
00:27:20,879 --> 00:27:25,419
engine wiring diagrams and stuff but if
it finds India Allen a certain

452
00:27:25,419 --> 00:27:26,220
subdirectory

453
00:27:26,220 --> 00:27:30,710
it will owe to DL 'em for obvious
reasons

454
00:27:30,710 --> 00:27:34,609
I don't know um and you're not
considering this one a bill team

455
00:27:34,609 --> 00:27:38,669
i'm too hasn't been any fix to it but
and this is what stocks that actually

456
00:27:38,669 --> 00:27:39,200
does too

457
00:27:39,200 --> 00:27:42,889
every project it finds on it infected
computer

458
00:27:42,889 --> 00:27:48,669
so it's almost it's like a regular file
in factor in the all-time list of states

459
00:27:48,669 --> 00:27:53,649
on similar to disturb 7 infection it
also looks for WinCC

460
00:27:53,649 --> 00:27:57,840
um servers those are a central database
servers then

461
00:27:57,840 --> 00:28:01,550
a you can use if you if you manage more
than one project

462
00:28:01,550 --> 00:28:04,740
um they have a hard-coded username

463
00:28:04,740 --> 00:28:08,619
a user name is as a they have a
hard-coded password

464
00:28:08,619 --> 00:28:12,159
from that is hard coded in all of cement
software

465
00:28:12,159 --> 00:28:16,070
that cannot be changed from well known
since 2008

466
00:28:16,070 --> 00:28:20,399
a Siemens never considered that a
problem from so they're using dads

467
00:28:20,399 --> 00:28:22,260
password and easy as a B

468
00:28:22,260 --> 00:28:28,520
a database superuser and in fact all the
project on the service as well

469
00:28:28,520 --> 00:28:33,919
um in order to actually get onto onto
the PLC im

470
00:28:33,919 --> 00:28:38,590
to infecting the d.a alum that is um
performing the communication with the

471
00:28:38,590 --> 00:28:40,409
actual PLC devices

472
00:28:40,409 --> 00:28:45,240
a.m. regular our function hooking they
take the original idea I'll put it

473
00:28:45,240 --> 00:28:48,629
to decide give it a new name put the new
DL

474
00:28:48,629 --> 00:28:51,879
in who called a fun export or the right
functions

475
00:28:51,879 --> 00:28:55,060
called him back into the original idea
all except for a couple

476
00:28:55,060 --> 00:28:59,550
of them did read and write and then arm
they modify everything on the fly

477
00:28:59,550 --> 00:29:04,320
so when you pry to the ps3 you get to
stock now plz code additional to it when

478
00:29:04,320 --> 00:29:07,129
you read its extracted from what you
read

479
00:29:07,129 --> 00:29:11,260
um when do you enders an additional
monitoring threat the

480
00:29:11,260 --> 00:29:15,030
introduce I'm to dis offered at Monett
Wars 2 PLC so

481
00:29:15,030 --> 00:29:19,450
as Stuxnet infected PLC is actually
better monitor cord and wondered isn't

482
00:29:19,450 --> 00:29:20,320
infected

483
00:29:20,320 --> 00:29:24,080
because they're two different monitoring
threats now um

484
00:29:24,080 --> 00:29:28,240
and there's another thread that the use
for controlling

485
00:29:28,240 --> 00:29:32,690
um before day in fact the PLC and this
is actually quite interesting

486
00:29:32,690 --> 00:29:37,419
um they're trying to fingerprint their
target system and this was thought of

487
00:29:37,419 --> 00:29:40,470
to be more complicated so we learn from
this

488
00:29:40,470 --> 00:29:43,580
that it's actually a lot easier than we
thought

489
00:29:43,580 --> 00:29:47,359
um so you first of all they take

490
00:29:47,359 --> 00:29:50,389
a if the right type of PLC issues like

491
00:29:50,389 --> 00:29:55,000
kills the Cebu types whether dares a
profit bus interface

492
00:29:55,000 --> 00:29:58,240
so if its networked or not if it's not
networked

493
00:29:58,240 --> 00:30:01,639
not what we're dealing with and then um

494
00:30:01,639 --> 00:30:04,669
pro-free bus actually uses
identification numbers

495
00:30:04,669 --> 00:30:08,159
and they're very similar to like the
first three

496
00:30:08,159 --> 00:30:11,830
abides of your Mac Address that usually
tells you the vendor

497
00:30:11,830 --> 00:30:15,690
after after network our trade and this
is the same with appropriate bus

498
00:30:15,690 --> 00:30:16,800
identification

499
00:30:16,800 --> 00:30:21,050
Prabhas identification a vendor is
signed

500
00:30:21,050 --> 00:30:24,399
number so they can act to check two
numbers on the PROFIBUS

501
00:30:24,399 --> 00:30:27,600
and see whether defined um a

502
00:30:27,600 --> 00:30:32,350
fire arrow were a big koon a variable
frequency drive

503
00:30:32,350 --> 00:30:36,440
into right number of it so they need I
think it's like 33

504
00:30:36,440 --> 00:30:41,770
in a cascade um because they're looking
for a cascade of centrifuges ride

505
00:30:41,770 --> 00:30:46,669
um so the check whether does devices are
on the property bus and nothing else

506
00:30:46,669 --> 00:30:49,869
and only then they're actually infecting
from

507
00:30:49,869 --> 00:30:53,169
the ICS am there's

508
00:30:53,169 --> 00:30:58,010
there's a couple of blocks in there um
semantic started to call them block AB

509
00:30:58,010 --> 00:30:58,669
and C

510
00:30:58,669 --> 00:31:02,399
so I'm gonna stick with that 'em your is

511
00:31:02,399 --> 00:31:06,850
a comparison between block anbe and you
can already see

512
00:31:06,850 --> 00:31:09,879
I'm this is this has been dif you can
already see that

513
00:31:09,879 --> 00:31:13,980
their identical the only thing that's
different between blockade

514
00:31:13,980 --> 00:31:19,440
and being is from actual well use their
writing to the variable frequency drives

515
00:31:19,440 --> 00:31:22,720
because block a iOS 4.2.1 type in brand

516
00:31:22,720 --> 00:31:27,050
in bobby is forty-odd so am completely
redundant

517
00:31:27,050 --> 00:31:30,869
um maybe they didn't know what to expect

518
00:31:30,869 --> 00:31:35,800
um as I said their redundant at the
third block see him

519
00:31:35,800 --> 00:31:39,740
am is still bit unclear what the
purposes

520
00:31:39,740 --> 00:31:44,440
there's a couple of um the couple of
theories one is that it's

521
00:31:44,440 --> 00:31:47,560
actually are targeting another facility
in this case

522
00:31:47,560 --> 00:31:50,770
Bush year a nuclear power plant

523
00:31:50,770 --> 00:31:55,220
I'm not truly I'm not really in favor of
that theory

524
00:31:55,220 --> 00:31:59,570
a the block a looks like either it's the
leftover

525
00:31:59,570 --> 00:32:04,359
from or it it served a certain purpose
that it actually never executed

526
00:32:04,359 --> 00:32:09,810
um so that states the PNC Park in
contrast to all of the other parts of

527
00:32:09,810 --> 00:32:10,710
Stuxnet

528
00:32:10,710 --> 00:32:15,060
actually shows a couple of sloppy arm

529
00:32:15,060 --> 00:32:18,580
sloppiness I'll in in design and
construction

530
00:32:18,580 --> 00:32:22,730
but that's probably because it's alt so
essentially what it does is

531
00:32:22,730 --> 00:32:26,790
um what brought a and B do is exactly
would do some

532
00:32:26,790 --> 00:32:30,580
described Indy in the video is there
recording

533
00:32:30,580 --> 00:32:34,399
the traffic on appropriate bus the
controlling traffic because state don't

534
00:32:34,399 --> 00:32:35,780
really care

535
00:32:35,780 --> 00:32:39,830
what does centrifuges I G do at the
moment to get in fact that they're just

536
00:32:39,830 --> 00:32:42,369
recording it for a couple of days

537
00:32:42,369 --> 00:32:46,530
um and then jus the recordings as a
template for two commands they're gonna

538
00:32:46,530 --> 00:32:47,389
send out

539
00:32:47,389 --> 00:32:50,740
so you could actually change the
programming of I'm off to control

540
00:32:50,740 --> 00:32:51,859
process

541
00:32:51,859 --> 00:32:54,869
them to use a different protocol you
could change the structures

542
00:32:54,869 --> 00:32:59,010
everything they don't need to know dad
they're just using what you're using on

543
00:32:59,010 --> 00:33:01,470
the network it's almost like blind
fuzzing

544
00:33:01,470 --> 00:33:04,740
a binary protocol um

545
00:33:04,740 --> 00:33:08,300
sewed a record or the Colts and then
later on

546
00:33:08,300 --> 00:33:11,909
spill it back um they in fact two
different

547
00:33:11,909 --> 00:33:16,109
areas in a PLC one of them is called the
organization block 1 dats to

548
00:33:16,109 --> 00:33:20,200
the court execution point I'm of every
PLC

549
00:33:20,200 --> 00:33:23,280
and the other is GOP 35 it's a

550
00:33:23,280 --> 00:33:27,750
time to execution slight watchdog um
which to use to mourn it or

551
00:33:27,750 --> 00:33:32,710
arm the healthy knows of the PLC and the
Stuxnet itself

552
00:33:32,710 --> 00:33:37,260
am diem what was widely published

553
00:33:37,260 --> 00:33:40,350
arm during did the first rate since of

554
00:33:40,350 --> 00:33:43,710
analysis of Stuxnet was a monitoring

555
00:33:43,710 --> 00:33:46,850
um code that is in OB 35

556
00:33:46,850 --> 00:33:53,270
um that actually im that actually tells
you whether devices infected or not

557
00:33:53,270 --> 00:33:56,270
um but this is mmm

558
00:33:56,270 --> 00:33:59,679
yeah a.m. but this actually turned out
to be

559
00:33:59,679 --> 00:34:03,940
not to keep functionality um within days
watchdog compared to watch dog was

560
00:34:03,940 --> 00:34:04,879
actually more

561
00:34:04,879 --> 00:34:08,250
for controlling did the health of the
whole device

562
00:34:08,250 --> 00:34:12,919
installation so this is what I just
mentioned so did Ricard two frames

563
00:34:12,919 --> 00:34:17,460
um inundate they wait a couple of hours
and then they actually send a couple of

564
00:34:17,460 --> 00:34:18,849
bursts through

565
00:34:18,849 --> 00:34:23,000
two different variable frequency drives
what this means is they're not trying to

566
00:34:23,000 --> 00:34:24,510
destroy anything

567
00:34:24,510 --> 00:34:28,750
what this means is if you have a Iranian
enrichment process

568
00:34:28,750 --> 00:34:33,560
you have a very long runtime after
centrifuges served it goes for days and

569
00:34:33,560 --> 00:34:34,080
days

570
00:34:34,080 --> 00:34:38,800
n then you move to uranium into a
different cascade of centrifuges and so

571
00:34:38,800 --> 00:34:40,149
on and so on

572
00:34:40,149 --> 00:34:43,889
so with those short bursts of um

573
00:34:43,889 --> 00:34:48,510
above the speed of rotation day
essentially fucked up the process

574
00:34:48,510 --> 00:34:51,590
so the Raynham enrichment is no longer
in reaching

575
00:34:51,590 --> 00:34:55,109
that's that's all they do and this is
why I was so hard for

576
00:34:55,109 --> 00:34:58,910
Iranians to actually figured it out by
themselves because they didn't they just

577
00:34:58,910 --> 00:35:01,510
had range unfailing dir tests

578
00:35:01,510 --> 00:35:05,270
and a hat um centrifuges tying on them

579
00:35:05,270 --> 00:35:08,390
and they didn't know why I'm so deity

580
00:35:08,390 --> 00:35:13,280
international home a nuclear-armed
oversight would ever dare called

581
00:35:13,280 --> 00:35:17,320
a.m. they have some cameras 'em on

582
00:35:17,320 --> 00:35:20,340
in the actual facility and from

583
00:35:20,340 --> 00:35:23,460
after dole stocks nothing became public

584
00:35:23,460 --> 00:35:27,650
day got all the video footage today had
from the cameras and started counting

585
00:35:27,650 --> 00:35:32,060
and they started counting how many
people with centrifuges on their backs

586
00:35:32,060 --> 00:35:35,520
actual walked out of the facility last
two years I'm

587
00:35:35,520 --> 00:35:38,940
which turned out to be a couple like
almost 2,000

588
00:35:38,940 --> 00:35:42,750
so they actually lost a shitload of
centrifuges to dad

589
00:35:42,750 --> 00:35:46,000
am so

590
00:35:46,000 --> 00:35:50,630
and talking about the state's I'm here
is d here's the actual code

591
00:35:50,630 --> 00:35:53,800
from bed to use to need to figure out
'em from

592
00:35:53,800 --> 00:35:57,420
a infected step 7: um 22 PLC

593
00:35:57,420 --> 00:36:02,180
whether Stuxnet is currently in action
were not so whether you're

594
00:36:02,180 --> 00:36:05,250
currently having a burst or not

595
00:36:05,250 --> 00:36:08,880
so arm I don't know if this is
interesting

596
00:36:08,880 --> 00:36:13,980
I'm I'm gonna skip this um this is
actual PLC code

597
00:36:13,980 --> 00:36:18,180
so but the interesting thing here is one
attacks like a

598
00:36:18,180 --> 00:36:24,160
goes 67 days it's very very unlikely
dead in a regular operation

599
00:36:24,160 --> 00:36:27,680
of any industrial control process you
would notice that

600
00:36:27,680 --> 00:36:30,720
a.m. if it won't happen like every day
um

601
00:36:30,720 --> 00:36:35,330
at noon were at midnight or whatever
that stands out like a sore thumb

602
00:36:35,330 --> 00:36:38,400
but if it takes over two months

603
00:36:38,400 --> 00:36:42,250
for one attacks I got to happen then
it's very unlikely even in your

604
00:36:42,250 --> 00:36:44,910
management dashboard and the SAP plants

605
00:36:44,910 --> 00:36:48,500
monitoring system you will not see it
because it's a very

606
00:36:48,500 --> 00:36:51,640
trainees spike over a very long period

607
00:36:51,640 --> 00:36:55,060
um so

608
00:36:55,060 --> 00:36:59,500
um here comes the because the best had
of all I think

609
00:36:59,500 --> 00:37:03,020
um in the video we saw that they were
using

610
00:37:03,020 --> 00:37:06,760
are man in the middle in order to spoof
the operator

611
00:37:06,760 --> 00:37:10,359
disses I G big advancement ship so um

612
00:37:10,359 --> 00:37:14,460
DD OB want your organization bought one
of two plz

613
00:37:14,460 --> 00:37:18,550
is two piece of code that gets called um
in Psych it's like

614
00:37:18,550 --> 00:37:22,990
continuously in this piece of code cause
of everything else

615
00:37:22,990 --> 00:37:26,670
from the way PLC's work is before Adam

616
00:37:26,670 --> 00:37:31,550
from organization block one is called
all descends or is all the readings

617
00:37:31,550 --> 00:37:35,730
am everything from temperature sensors
to whatever your house

618
00:37:35,730 --> 00:37:38,820
um is carried and

619
00:37:38,820 --> 00:37:43,010
you build a table of your inputs with a
specific well use

620
00:37:43,010 --> 00:37:46,470
once your code ran and read from his

621
00:37:46,470 --> 00:37:49,520
in this input table its rights to an
output table

622
00:37:49,520 --> 00:37:53,790
and then 10 be one is finished itttt
takes the opportunity ble

623
00:37:53,790 --> 00:37:57,410
and sense but the signals in the output
able to do

624
00:37:57,410 --> 00:38:01,109
respective outputs like dr. arm engine
control

625
00:38:01,109 --> 00:38:04,300
like a pro free bus interface or a
heater

626
00:38:04,300 --> 00:38:08,770
or whatever a.m. order an automatic
dildo

627
00:38:08,770 --> 00:38:12,140
whatever you have connected to a to your
heart

628
00:38:12,140 --> 00:38:16,440
now what stocks not actually does it
uses a undocumented feature

629
00:38:16,440 --> 00:38:21,380
of a Siemens PLC is that turns of this
out a medic updating of the input and

630
00:38:21,380 --> 00:38:22,970
output tables

631
00:38:22,970 --> 00:38:26,480
so the moment um Stuxnet in fact

632
00:38:26,480 --> 00:38:29,940
will be one it will actually change

633
00:38:29,940 --> 00:38:33,960
the input before it seem by to Rio code

634
00:38:33,960 --> 00:38:37,950
in once the rear cobro to the output it
will actually change the outputs

635
00:38:37,950 --> 00:38:42,130
and then manually right to tables 22
connected equipment

636
00:38:42,130 --> 00:38:46,080
um and a need very little coat for dat
dats alt accompanied

637
00:38:46,080 --> 00:38:49,990
became it's an undocumented feature but
it's a feature of the PLC so they can

638
00:38:49,990 --> 00:38:51,460
simply call plz

639
00:38:51,460 --> 00:38:54,480
to do it um this pretty calm

640
00:38:54,480 --> 00:38:57,820
because now they virtualized to PLC
within itself

641
00:38:57,820 --> 00:39:01,570
the fields he doesn't see what is
connected to the PLC but what stocks

642
00:39:01,570 --> 00:39:04,910
that once a to z:

643
00:39:04,910 --> 00:39:07,310
um years attracted

644
00:39:07,310 --> 00:39:10,810
I'm I said there's some sloppiness in a
PLC code he is attracted

645
00:39:10,810 --> 00:39:13,920
many um I see as engineers use

646
00:39:13,920 --> 00:39:17,150
you can you see hints in the code tutors

647
00:39:17,150 --> 00:39:23,170
up code called bldg and did well hinged
to dizzy men's disassembler

648
00:39:23,170 --> 00:39:26,360
what a certain block of code us and

649
00:39:26,360 --> 00:39:30,290
commonly um you can jus does opcodes

650
00:39:30,290 --> 00:39:34,160
they're not doing anything on appeal
cedar like knobs on a PLC

651
00:39:34,160 --> 00:39:37,420
but for December to give you a hint on

652
00:39:37,420 --> 00:39:42,510
what does block of code to use to be so
macros that used to house can be

653
00:39:42,510 --> 00:39:47,530
disassembled into macros again in not in
2d actual code that the Metra generated

654
00:39:47,530 --> 00:39:51,360
um Stuxnet actually doesn't use the
trick

655
00:39:51,360 --> 00:39:55,210
of intentionally including evil bood
instructions

656
00:39:55,210 --> 00:39:58,730
so what you do and what you can do is
for example you can say

657
00:39:58,730 --> 00:40:02,870
yo the seven and 8 which um which shows
here

658
00:40:02,870 --> 00:40:06,790
them to the disassembler hey here comes
call instruction um

659
00:40:06,790 --> 00:40:10,470
den you have a condition here that is
always true

660
00:40:10,470 --> 00:40:13,760
the times over here and a new put all
that you've a cold in here

661
00:40:13,760 --> 00:40:17,620
and dis unconditional call to SFC 46

662
00:40:17,620 --> 00:40:21,420
is what to December Dennis gonna show in
a December his gonna

663
00:40:21,420 --> 00:40:25,560
only showed as one line a which is
exactly the reason that I broke my own

664
00:40:25,560 --> 00:40:26,910
December for the soul

665
00:40:26,910 --> 00:40:31,360
shipped and it turned out to be useless
because the Stuxnet authors didn't use

666
00:40:31,360 --> 00:40:32,300
this fuckin trick

667
00:40:32,300 --> 00:40:36,400
Hasselt so

668
00:40:36,400 --> 00:40:41,310
what reusable about this um well there's
a lot of stuff reusable with

669
00:40:41,310 --> 00:40:44,760
and we're seeing it would term would do
to you or however you

670
00:40:44,760 --> 00:40:49,590
for can call it a now-dead own its
obviously a exploited

671
00:40:49,590 --> 00:40:53,190
kid that to use and now it's getting
reused for

672
00:40:53,190 --> 00:40:57,400
more Monday in purposes flake installing
key loggers and

673
00:40:57,400 --> 00:41:01,490
watching other people entering Derby
porn site passwords a.m.

674
00:41:01,490 --> 00:41:06,240
birds essentially for a targeted attack
of spreading mechanisms

675
00:41:06,240 --> 00:41:10,930
autoroute kept the rootkit driver today
obviously bought from someone else

676
00:41:10,930 --> 00:41:14,640
I'm on as crafted wasn't really
necessary

677
00:41:14,640 --> 00:41:19,650
my theory actually is 10 when when they
helped the exploit kit with all the PRC

678
00:41:19,650 --> 00:41:20,530
code and everything

679
00:41:20,530 --> 00:41:24,840
um day world actually im they would
actually

680
00:41:24,840 --> 00:41:28,960
a.m. gifford to one of the few often use
cyber warriors

681
00:41:28,960 --> 00:41:32,840
you know did former Air Force people
that wear too dumb to fly a plane and

682
00:41:32,840 --> 00:41:34,360
now are repurposed to

683
00:41:34,360 --> 00:41:38,420
a to be cyber warriors day probably gave
them the entire

684
00:41:38,420 --> 00:41:42,600
exploit kid in an someone when Blake
click click click click click click

685
00:41:42,600 --> 00:41:45,670
fire um that's probably what happened

686
00:41:45,670 --> 00:41:48,750
and now we're seeing someone more
smarter doing less

687
00:41:48,750 --> 00:41:52,080
checkboxes I'm almost am

688
00:41:52,080 --> 00:41:55,230
what they actually what you actually
need for targeted attack

689
00:41:55,230 --> 00:41:58,460
the step 7 project I'll infection well

690
00:41:58,460 --> 00:42:02,390
sand cement doesn't consider it
viability to execute code when you load

691
00:42:02,390 --> 00:42:03,060
a project

692
00:42:03,060 --> 00:42:07,880
I'm this is still open for you and Jimmy
to fingerprint ICS

693
00:42:07,880 --> 00:42:11,240
not a big deal if you know what your
targeting

694
00:42:11,240 --> 00:42:14,390
um the back during of two steps have
been as active

695
00:42:14,390 --> 00:42:17,680
for T optional you can actually send to
coat by yourself

696
00:42:17,680 --> 00:42:20,990
um and to virtualization of the PLC

697
00:42:20,990 --> 00:42:24,450
is necessary to spoof the operator but
as we have seen

698
00:42:24,450 --> 00:42:27,840
it's very little coat um

699
00:42:27,840 --> 00:42:32,280
some um the to be the relevant
functionality

700
00:42:32,280 --> 00:42:35,770
isn't spreading am in of course nowadays

701
00:42:35,770 --> 00:42:40,130
term after dins presentation at black
hat we all know that you can also just

702
00:42:40,130 --> 00:42:43,250
telnet into a Siemens PLC would have
fixed password

703
00:42:43,250 --> 00:42:47,350
I'm getting root level shell and patched
the underlying operating system

704
00:42:47,350 --> 00:42:51,200
or obscene the a monkeys on a red
background um

705
00:42:51,200 --> 00:42:54,870
that is also another avenue of attack
here obviously

706
00:42:54,870 --> 00:42:59,630
um and so at the problem with with
stocks that is I actually dead

707
00:42:59,630 --> 00:43:02,810
once you understand how little

708
00:43:02,810 --> 00:43:06,950
of it is actually needed for targeted
attack it gets

709
00:43:06,950 --> 00:43:10,100
a it becomes a lot more arm

710
00:43:10,100 --> 00:43:13,440
accessible for less talented

711
00:43:13,440 --> 00:43:16,540
attackers to actually use dead against
the competition

712
00:43:16,540 --> 00:43:19,930
um especially if your competition is
sitting in India

713
00:43:19,930 --> 00:43:24,120
China or whatever so current defenses

714
00:43:24,120 --> 00:43:29,960
um well cement point of view even with
leg root level access to PLC with fixed

715
00:43:29,960 --> 00:43:31,780
username and password is

716
00:43:31,780 --> 00:43:35,610
security is the issue of the customer
they have

717
00:43:35,610 --> 00:43:38,620
a senior manager of had proof products

718
00:43:38,620 --> 00:43:42,370
from that as I cheap you know traveling
around the world in telling everyone

719
00:43:42,370 --> 00:43:45,460
security is the problem of your
customers

720
00:43:45,460 --> 00:43:49,310
from why he still has a job is beyond me

721
00:43:49,310 --> 00:43:53,830
um as I said the code execution in
project load is not considered a

722
00:43:53,830 --> 00:43:54,920
viability

723
00:43:54,920 --> 00:43:58,550
the fixed password on the WinCC server
them

724
00:43:58,550 --> 00:44:03,000
well all day came around to say it's sup
optimal design

725
00:44:03,000 --> 00:44:07,500
but don't imagine dat their but putting
out Texas

726
00:44:07,500 --> 00:44:11,310
um at a maximum if they're putting out
six as I would like to take to fix

727
00:44:11,310 --> 00:44:12,690
whether it just changes

728
00:44:12,690 --> 00:44:16,660
the hardcoded password to another one um

729
00:44:16,660 --> 00:44:20,660
air gaps um you can as pretty much
everyone in our industry have some walks

730
00:44:20,660 --> 00:44:21,710
up to you and says well

731
00:44:21,710 --> 00:44:25,830
that never happens to us the network is
are gapped from the internet

732
00:44:25,830 --> 00:44:29,110
is lying because one of these operators

733
00:44:29,110 --> 00:44:33,040
probably has a wireless access point so
we can surf porn

734
00:44:33,040 --> 00:44:38,650
um thats very very clear especially if
you paid him like six dollars an hour

735
00:44:38,650 --> 00:44:42,560
um and as I said the dashboards form

736
00:44:42,560 --> 00:44:47,190
management and age I a production
environments all require for yourself

737
00:44:47,190 --> 00:44:50,250
to be connected virus scanners well

738
00:44:50,250 --> 00:44:53,430
if you still believe in virus scanners
then you can also just believe

739
00:44:53,430 --> 00:44:56,640
in Santa Claus protecting your systems
um

740
00:44:56,640 --> 00:45:01,030
that you know they haven't helped us
since the seventies

741
00:45:01,030 --> 00:45:04,660
um I see as a.m. engineers

742
00:45:04,660 --> 00:45:08,300
actually have a pretty good idea they
say well

743
00:45:08,300 --> 00:45:12,470
the code on on a PLC is not supposed to
change by itself

744
00:45:12,470 --> 00:45:16,430
so some how about we just have a
separate machine

745
00:45:16,430 --> 00:45:20,970
that we're not touching um that
frequently re programs

746
00:45:20,970 --> 00:45:26,590
are PLC's to talk to one of the smarter
ideas however of course how do they

747
00:45:26,590 --> 00:45:30,810
move to code over to that separate
machine it's gonna be with her

748
00:45:30,810 --> 00:45:35,180
you know house days batch um USB and USB
in welp

749
00:45:35,180 --> 00:45:39,750
owned from ok by the way did did I
mention that I put them like

750
00:45:39,750 --> 00:45:44,250
Stuxnet follow up on the bench no did
you put it in your USB

751
00:45:44,250 --> 00:45:48,130
ahead am under is

752
00:45:48,130 --> 00:45:51,460
um and rival honor has a you know

753
00:45:51,460 --> 00:45:55,300
didn't you can a late plate media's on
stocks midfield seaside

754
00:45:55,300 --> 00:46:00,360
I'm he actually has a um controller
integrity checker

755
00:46:00,360 --> 00:46:03,710
which has a stand-alone program um dead

756
00:46:03,710 --> 00:46:07,870
you know carries the PLC for a couple
very a bit and what code is on them

757
00:46:07,870 --> 00:46:11,240
um it is one of the better ideas a

758
00:46:11,240 --> 00:46:14,330
it is cement specific it doesn't help
you them

759
00:46:14,330 --> 00:46:18,190
if the attacker just used a well-known
username and password to town it into

760
00:46:18,190 --> 00:46:20,480
your PLC and route it that way

761
00:46:20,480 --> 00:46:24,410
and of course that house um detection
paradigm

762
00:46:24,410 --> 00:46:29,800
AKA v issue of not seeing shit if the
attacker knows that you're using it

763
00:46:29,800 --> 00:46:32,890
um but it's one of the better ideas the

764
00:46:32,890 --> 00:46:36,400
actual the actual thing that we need to
do

765
00:46:36,400 --> 00:46:39,470
as we need to study does environments
war some

766
00:46:39,470 --> 00:46:42,480
between not rely onto few people

767
00:46:42,480 --> 00:46:45,540
like I don't National Laboratory home to

768
00:46:45,540 --> 00:46:50,330
you know demonstrate how to turn off
power if you have an industrial control

769
00:46:50,330 --> 00:46:56,190
our system go look at yourself like make
actually sure that you know

770
00:46:56,190 --> 00:46:59,830
a does non existing air gaps where they
are how

771
00:46:59,830 --> 00:47:03,090
does code actually get into your system
arm

772
00:47:03,090 --> 00:47:07,320
what's change control measures do you
have in place for your

773
00:47:07,320 --> 00:47:11,270
external consultants to put code on your
control system do you actually have to

774
00:47:11,270 --> 00:47:13,880
fucking coded running your production
line

775
00:47:13,880 --> 00:47:18,340
um that would be a good question to ask
and the second question where is it

776
00:47:18,340 --> 00:47:22,760
can I see it um we actually need to look
at them

777
00:47:22,760 --> 00:47:26,390
individually um and then bill up read
more around it that's

778
00:47:26,390 --> 00:47:29,740
right now the only defense we have
because they're is nothing boilerplate

779
00:47:29,740 --> 00:47:30,590
nothing

780
00:47:30,590 --> 00:47:33,810
are like a super Superbad we can take
out

781
00:47:33,810 --> 00:47:38,430
from and shoot at them and I was at

782
00:47:38,430 --> 00:47:45,430
only slightly over questions

783
00:47:46,709 --> 00:47:51,170
it's unclear text I'm he actually stand
your and which one does WinCC wordy

784
00:47:51,170 --> 00:47:56,369
a it's unclear text and it's in every
single Siemens application because they

785
00:47:56,369 --> 00:47:57,910
all need to talk to WinCC

786
00:47:57,910 --> 00:48:01,529
am is same and same also forty

787
00:48:01,529 --> 00:48:04,549
iced I think the other password on a PLC
itself was

788
00:48:04,549 --> 00:48:08,809
Bell Basilisk or something a.m. then

789
00:48:08,809 --> 00:48:12,869
didn't actually stumbled across it
because he be pulled a memory dump out

790
00:48:12,869 --> 00:48:13,349
of it

791
00:48:13,349 --> 00:48:16,920
and actually said in clear text like
password Basilisk

792
00:48:16,920 --> 00:48:21,509
get out that's the level of shit we're
dealing with here

793
00:48:21,509 --> 00:48:25,329
and this is just not just seems like
Rockwell Automation

794
00:48:25,329 --> 00:48:29,380
and all the other players in a PRC
market do the same level or worse

795
00:48:29,380 --> 00:48:34,019
a in out this is German engineering my
ass but imagine

796
00:48:34,019 --> 00:48:37,599
you know imagine americans doing the
same thing at rockwell a

797
00:48:37,599 --> 00:48:41,270
it's not going to be any better

798
00:48:41,270 --> 00:48:45,910
just bigger any other question

799
00:48:45,910 --> 00:48:49,039
oh one last thing I want to mention is

800
00:48:49,039 --> 00:48:52,940
um as they did the PLC code in stocks
that is kinda sloppy because it's

801
00:48:52,940 --> 00:48:53,970
probably sold

802
00:48:53,970 --> 00:48:57,170
just for your reference the code was
compiled

803
00:48:57,170 --> 00:49:00,549
and they actually left a compile-time
time stems in there

804
00:49:00,549 --> 00:49:06,160
deco was compiled in September 2007
sodium attackers edgy completed the PLC

805
00:49:06,160 --> 00:49:07,410
part of the attack code

806
00:49:07,410 --> 00:49:12,510
2007

807
00:49:12,510 --> 00:49:12,830
anything else

