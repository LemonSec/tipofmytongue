1
00:00:06,660 --> 00:00:09,200
hi everybody um yeah

2
00:00:09,200 --> 00:00:12,889
this cop talk is called I V six in
security revolutions

3
00:00:12,889 --> 00:00:16,260
um the first talk 0 ipv6

4
00:00:16,260 --> 00:00:20,259
insecurities I didn't 2005-2006

5
00:00:20,259 --> 00:00:23,359
um there were lots of stuff to find
butts

6
00:00:23,359 --> 00:00:28,119
the following years to a fun way way way
more stuff so I did as

7
00:00:28,119 --> 00:00:31,460
second talk on ipv6 completely new stuff
and

8
00:00:31,460 --> 00:00:34,710
my fixed I call it i've 6 insecurity
reload its

9
00:00:34,710 --> 00:00:38,360
so thats widest talk now house

10
00:00:38,360 --> 00:00:41,870
to be called the revolutions of course
for no other reason

11
00:00:41,870 --> 00:00:46,870
um anybody here see one of my previous
talks in ipv6

12
00:00:46,870 --> 00:00:49,910
hands up please I don't have for some
okay

13
00:00:49,910 --> 00:00:54,820
am for dose we haven't seen all my
previous talks is completely new things

14
00:00:54,820 --> 00:00:58,010
and I don't give any ipv6 introduction

15
00:00:58,010 --> 00:01:01,030
so you don't know anything about ipv6

16
00:01:01,030 --> 00:01:04,890
arm your miss some aspects but's

17
00:01:04,890 --> 00:01:08,920
that's life I only have 50 minutes and
even the talk is secure for

18
00:01:08,920 --> 00:01:12,210
from the condos for 60 minutes so I have
to

19
00:01:12,210 --> 00:01:17,010
lipid foster I'm yeah i'm mark are about
hauser but not me from

20
00:01:17,010 --> 00:01:21,600
stuff I did for Susan this is about a
security or the heck a strong this year

21
00:01:21,600 --> 00:01:22,540
C-dot arc

22
00:01:22,540 --> 00:01:26,810
hydride a map and stuff like that so
I've been around for a long long time

23
00:01:26,810 --> 00:01:29,979
um and I love to hack stuff

24
00:01:29,979 --> 00:01:33,110
and actually its bio opinion that

25
00:01:33,110 --> 00:01:36,869
hacking is very very important actually

26
00:01:36,869 --> 00:01:41,400
for Society for every one of us if there
would not be hackers breaking stuff

27
00:01:41,400 --> 00:01:44,619
security on the system's we will be
using

28
00:01:44,619 --> 00:01:48,250
would be horribly bad so

29
00:01:48,250 --> 00:01:52,509
I a penis that everybody should to
secure to research published it and

30
00:01:52,509 --> 00:01:56,810
kick vendors and their balls so they
have to do better security in their

31
00:01:56,810 --> 00:01:57,490
products

32
00:01:57,490 --> 00:02:02,649
so that's why time and time again to go
back to ipv6

33
00:02:02,649 --> 00:02:06,210
for me actually everything is kinda
boring now bequests

34
00:02:06,210 --> 00:02:10,019
I've done so much that it's not really
new stuff for me

35
00:02:10,019 --> 00:02:13,019
butts I ship without

36
00:02:13,019 --> 00:02:16,730
arm nobody else seems to be doing that

37
00:02:16,730 --> 00:02:20,129
it's only a friend I'm no for an
undergarment

38
00:02:20,129 --> 00:02:23,190
um he does the others parts so

39
00:02:23,190 --> 00:02:27,230
ikik the vendors and the ball to hey you
fucked up is as bad as bad as bad

40
00:02:27,230 --> 00:02:32,099
and he's comes from hey I've written in
RFC this is how we should improve things

41
00:02:32,099 --> 00:02:35,709
and that's how we we to work now as a
team

42
00:02:35,709 --> 00:02:39,310
to actually make things better and its

43
00:02:39,310 --> 00:02:42,860
starting to to pay off for things are
going better

44
00:02:42,860 --> 00:02:47,440
um but they're still lots of lots of
remove provement

45
00:02:47,440 --> 00:02:50,480
so um this talk is

46
00:02:50,480 --> 00:02:53,760
hi call a pot pourri

47
00:02:53,760 --> 00:02:56,760
of things insecurity in ipv6

48
00:02:56,760 --> 00:02:59,890
of all the different matters step half

49
00:02:59,890 --> 00:03:03,420
somehow to do with autism really really
completely different things

50
00:03:03,420 --> 00:03:06,470
arm so there's nothing like it

51
00:03:06,470 --> 00:03:10,629
red threat or something like that and to
stalk um

52
00:03:10,629 --> 00:03:14,349
first shortly I want to talk about what
is actually this situation with ipv6

53
00:03:14,349 --> 00:03:19,730
do we get it finally or can we passed
the bucket and stay with ipv4

54
00:03:19,730 --> 00:03:22,739
hopefully yeah

55
00:03:22,739 --> 00:03:27,080
I'll tell you than all talk about
vulnerabilities of course that's the

56
00:03:27,080 --> 00:03:27,870
juicy stuff

57
00:03:27,870 --> 00:03:33,080
um damn who's doing penetration testing
here

58
00:03:33,080 --> 00:03:36,140
um how state paid or

59
00:03:36,140 --> 00:03:40,709
unpaid hoppy type heads up please

60
00:03:40,709 --> 00:03:44,090
okay with it is about a third

61
00:03:44,090 --> 00:03:47,849
what you other guys doing here in this
talk okay

62
00:03:47,849 --> 00:03:51,400
um so I will talk about shorty but pen
testing

63
00:03:51,400 --> 00:03:56,400
because so far there's basically

64
00:03:56,400 --> 00:04:00,450
no information on how you do what do I P
six pen testing

65
00:04:00,450 --> 00:04:04,420
from remote remote network which is
really challenge

66
00:04:04,420 --> 00:04:08,129
I show that in my training's but
actually is the first time I saw the

67
00:04:08,129 --> 00:04:10,480
property and there's no other
information for that available

68
00:04:10,480 --> 00:04:14,159
so if somehow for whatever reason yours

69
00:04:14,159 --> 00:04:18,840
use you does of his star sleeping if you
to pan testing best the point when you

70
00:04:18,840 --> 00:04:20,450
should wake up

71
00:04:20,450 --> 00:04:23,460
and if I have time left at the ants I
talk about

72
00:04:23,460 --> 00:04:28,000
is there any hope um I don't think I
with the hive have time so I'll see

73
00:04:28,000 --> 00:04:28,500
already

74
00:04:28,500 --> 00:04:32,220
nope yeah that's how it is sorry

75
00:04:32,220 --> 00:04:37,729
so this situation once upon a time in a
far far away fairyland what ipv6 was

76
00:04:37,729 --> 00:04:39,699
designed

77
00:04:39,699 --> 00:04:44,180
people were thinking everything would be
good in the future

78
00:04:44,180 --> 00:04:48,240
so you find stuff in the RC rethink okay

79
00:04:48,240 --> 00:04:52,660
what word is smoking to think that
something like that would happen in the

80
00:04:52,660 --> 00:04:53,410
future

81
00:04:53,410 --> 00:04:57,870
for example what essential thing what
they're hoping that what existed

82
00:04:57,870 --> 00:05:02,110
everybody would encrypt in the future
and I'm not talking about SSL

83
00:05:02,110 --> 00:05:06,680
I'm talking about it. sec Wednesday
diesel defined ipv6

84
00:05:06,680 --> 00:05:10,740
in 1995 they thought yeah I'm pretty
sure

85
00:05:10,740 --> 00:05:14,979
in 2050 when do start implementing ipv6

86
00:05:14,979 --> 00:05:20,130
everybody will use IP sec already so we
should prepare for that

87
00:05:20,130 --> 00:05:23,750
and required it is somehow mandatory for
security

88
00:05:23,750 --> 00:05:28,759
that it should be dear L now you have to
introduce ipv6 and berries I P sec

89
00:05:28,759 --> 00:05:32,669
nowhere are you only have it for VPN
connections over the internet and that's

90
00:05:32,669 --> 00:05:33,880
it

91
00:05:33,880 --> 00:05:38,090
so its wasn't done in a fairy tale to
hire him

92
00:05:38,090 --> 00:05:43,310
um when they decide ipv6 that we're
hoping for something like that

93
00:05:43,310 --> 00:05:46,600
so or or death sorry I don't know which
one to choose here

94
00:05:46,600 --> 00:05:50,090
um so expected year texas-size

95
00:05:50,090 --> 00:05:53,720
the size of the image that will grow
because more and more people get online

96
00:05:53,720 --> 00:05:57,440
direct thinking about mobile phones have
an internet connection or iPad so what

97
00:05:57,440 --> 00:05:58,320
so ever

98
00:05:58,320 --> 00:06:01,699
so but of course that would be cruel in
the Internet

99
00:06:01,699 --> 00:06:05,009
arm Essar only $4 billion possible the
puter SS

100
00:06:05,009 --> 00:06:10,530
in ipv4 every are already over six
billion people on the planet

101
00:06:10,530 --> 00:06:14,759
as something doesn't match here apso

102
00:06:14,759 --> 00:06:18,979
we need more dresses and is not possible
that before sort everything okay

103
00:06:18,979 --> 00:06:24,699
this largest size of the internet of
course the IP for port sizes depleting

104
00:06:24,699 --> 00:06:29,160
we as human rational beans we see that
coming

105
00:06:29,160 --> 00:06:32,340
and react accordingly to that so we
start

106
00:06:32,340 --> 00:06:36,380
early hoops early with ipv6 deployment

107
00:06:36,380 --> 00:06:40,850
and yeah I do you force at some point
not needed anymore

108
00:06:40,850 --> 00:06:44,490
and then everything will be fine the
relatively

109
00:06:44,490 --> 00:06:48,319
is dis the size of the to destroy

110
00:06:48,319 --> 00:06:51,389
ipv4 what's going down and IP 65

111
00:06:51,389 --> 00:06:55,100
monarch not much

112
00:06:55,100 --> 00:06:59,090
and that's our crime problem

113
00:06:59,090 --> 00:07:04,819
now starting with ipv6 is actually
already too late

114
00:07:04,819 --> 00:07:07,889
arm last month over last month the six

115
00:07:07,889 --> 00:07:11,120
weeks ago right-handed out the last

116
00:07:11,120 --> 00:07:14,560
ipv4 addresses so that now only one
class

117
00:07:14,560 --> 00:07:18,229
aid network is left for addressing in
Europe

118
00:07:18,229 --> 00:07:21,789
without a special protocol kick some
place

119
00:07:21,789 --> 00:07:24,940
you only get new ipv4 addresses from it

120
00:07:24,940 --> 00:07:31,930
a class network which is left if you
proof your already deploying ipv6

121
00:07:31,930 --> 00:07:37,490
if you know need new ipv4 addresses you
must deploy ipv6

122
00:07:37,490 --> 00:07:42,759
thats while now we will start very very
large rush of people fuck you have to

123
00:07:42,759 --> 00:07:44,240
drive his ex now

124
00:07:44,240 --> 00:07:48,919
if you want growth if you're new I mean
if you're in all company and you crapped

125
00:07:48,919 --> 00:07:52,039
large piece of the cake you have enough
I P fortress good for you

126
00:07:52,039 --> 00:07:55,949
re: I spew who grew up fast enough

127
00:07:55,949 --> 00:08:00,280
but if you're smaller company a new
company you come in trouble now

128
00:08:00,280 --> 00:08:04,389
and you have to do ipv6 fast so

129
00:08:04,389 --> 00:08:09,669
the and is basically near because we
have to ipv6 but we're not prepared

130
00:08:09,669 --> 00:08:13,669
especially security wise so

131
00:08:13,669 --> 00:08:18,110
arm in every talk on ipv6 I put in this
light

132
00:08:18,110 --> 00:08:22,020
and it shows an outdated of course every
every few month

133
00:08:22,020 --> 00:08:27,259
Sodus shows the reported number for her
ability so publicly reported CV

134
00:08:27,259 --> 00:08:31,569
entries on ipv6

135
00:08:31,569 --> 00:08:35,919
um the last summer 2012 that's was quick
reported your

136
00:08:35,919 --> 00:08:39,190
about 40 um but actually that's

137
00:08:39,190 --> 00:08:43,019
already for weeks ago Thomas whatever
three more

138
00:08:43,019 --> 00:08:46,540
there was someone found three security
for those he's in

139
00:08:46,540 --> 00:08:49,740
up DHCP v6 server implementations

140
00:08:49,740 --> 00:08:52,970
um but more and more is to come because
how this works

141
00:08:52,970 --> 00:08:56,970
you find a mobility you report to the
vendor um

142
00:08:56,970 --> 00:09:01,250
the CPE get his side's to the year but
it might not be made public

143
00:09:01,250 --> 00:09:06,570
usually until there's a fix out ants if
the reliability for some bizarre call

144
00:09:06,570 --> 00:09:10,399
to scan take three years or longer

145
00:09:10,399 --> 00:09:13,589
until he can make it public so

146
00:09:13,589 --> 00:09:17,160
I'm that's why a lot of lot of stuff
from 2012 is not

147
00:09:17,160 --> 00:09:20,160
not yet published and I have even

148
00:09:20,160 --> 00:09:24,370
one open from 2011 still and I'm pretty
sure others have as well so does

149
00:09:24,370 --> 00:09:28,550
always very conservative my guessing
here

150
00:09:28,550 --> 00:09:32,430
um I am i say okay ipv6 or abilities

151
00:09:32,430 --> 00:09:36,269
of course takes ist for abilities exist
in everything

152
00:09:36,269 --> 00:09:41,529
so of course texas also night before so
where's a difference Press risk

153
00:09:41,529 --> 00:09:46,130
um if you compared with the numbers of
ipv4 vulnerabilities

154
00:09:46,130 --> 00:09:49,269
there's a little mismatch here I mean
not

155
00:09:49,269 --> 00:09:52,459
all systems have ipv6 implemented

156
00:09:52,459 --> 00:09:55,490
but everything as I before

157
00:09:55,490 --> 00:10:00,760
so the target area for IP four is a much
larger than 5 p-6

158
00:10:00,760 --> 00:10:04,490
still twice a number for her abilities
are reported

159
00:10:04,490 --> 00:10:08,040
which shows you one thing there's a
difference in maturity

160
00:10:08,040 --> 00:10:11,760
of the security of the implementation
how so ipv6

161
00:10:11,760 --> 00:10:16,100
is long not at the same states ripe you
for his with the maturity of the

162
00:10:16,100 --> 00:10:17,570
security implementation

163
00:10:17,570 --> 00:10:20,620
which means there are many many books to
find

164
00:10:20,620 --> 00:10:24,810
and alone in this um presentation I will
show you

165
00:10:24,810 --> 00:10:30,810
stuff for six more CV entries which I
haven't even cut late in the air

166
00:10:30,810 --> 00:10:33,970
so um I grouped 'em

167
00:10:33,970 --> 00:10:38,079
the ball abilities together through some
stuff and a call them all surprises

168
00:10:38,079 --> 00:10:39,899
because people sometimes

169
00:10:39,899 --> 00:10:43,750
sought the people implementing something
would be totally surprised what could

170
00:10:43,750 --> 00:10:44,660
happen

171
00:10:44,660 --> 00:10:47,950
that's even hacker stuff hackers doing
something different

172
00:10:47,950 --> 00:10:51,420
Weber St will also also see desist
officious

173
00:10:51,420 --> 00:10:55,010
very very easy doesn't need

174
00:10:55,010 --> 00:10:59,540
a great actor to come up with these
attacks anybody can come up with the tax

175
00:10:59,540 --> 00:11:02,959
you don't need to be great Ecker just
being a script kiddie is basically

176
00:11:02,959 --> 00:11:04,790
enough to come up with that

177
00:11:04,790 --> 00:11:08,769
ants you you wouldn't believe who's the
fact that

178
00:11:08,769 --> 00:11:12,260
so flooding surprises um

179
00:11:12,260 --> 00:11:16,589
this is a reminder from two years ago in
my previous talk the

180
00:11:16,589 --> 00:11:19,940
reloaded one from 2000 arm

181
00:11:19,940 --> 00:11:23,610
remove the 2000 9 2010

182
00:11:23,610 --> 00:11:27,760
um F under pretty simple reliability

183
00:11:27,760 --> 00:11:32,019
in ninety-six you have a feature called
router advertisement

184
00:11:32,019 --> 00:11:35,890
um this is a router on the net for
extensive packets everybody on the local

185
00:11:35,890 --> 00:11:36,360
network

186
00:11:36,360 --> 00:11:39,450
knows out der Sar router up so you don't
have to do any

187
00:11:39,450 --> 00:11:42,829
default route configuration by hand or
by DCP anymore

188
00:11:42,829 --> 00:11:47,829
but the Roche announced himself on that
first so I'm here and the router

189
00:11:47,829 --> 00:11:51,200
and yeah its easier this way day at

190
00:11:51,200 --> 00:11:54,490
there's a option which is called
autoconfiguration

191
00:11:54,490 --> 00:12:00,000
the featured is meant to be a
replacement for DHCP so that DHCP

192
00:12:00,000 --> 00:12:03,990
doesn't need to be used anymore it's
part of the router advertisement and if

193
00:12:03,990 --> 00:12:04,589
dis

194
00:12:04,589 --> 00:12:07,970
option is set on the router
advertisement packet it says

195
00:12:07,970 --> 00:12:12,040
this is an effort prefix you should cut
yourself IP address in

196
00:12:12,040 --> 00:12:16,720
and the systems by default old without
the viability I found is if you

197
00:12:16,720 --> 00:12:21,589
pretty hands terry $1 billion routers on
the local network and they all say yes

198
00:12:21,589 --> 00:12:23,959
to alter conflagration ODIs different

199
00:12:23,959 --> 00:12:27,880
ipv6 address space um if its windows

200
00:12:27,880 --> 00:12:32,290
be is the juniper Cisco the all which do
that 40

201
00:12:32,290 --> 00:12:37,360
1 million addresses yeah who needs one
million ipv6 addresses per interface

202
00:12:37,360 --> 00:12:38,470
nobody

203
00:12:38,470 --> 00:12:42,630
your butts some people where surprised
that someone might

204
00:12:42,630 --> 00:12:46,350
come up to that idea which is I think
it's not that clever

205
00:12:46,350 --> 00:12:50,750
really anybody can come up without but
everything witnesses was affected Cisco

206
00:12:50,750 --> 00:12:53,339
was affected in a bar NetBSD

207
00:12:53,339 --> 00:12:58,459
um and everybody fixed up pretty fast
except for Windows and juniper

208
00:12:58,459 --> 00:13:03,160
they're still vulnerable after two years
what's the impact

209
00:13:03,160 --> 00:13:07,660
the impact this one out apps percent CPU
wanna 18 percent drop by just flooding

210
00:13:07,660 --> 00:13:09,950
for about 15 seconds

211
00:13:09,950 --> 00:13:14,360
and the systems are not recovering the
only thing you can do is

212
00:13:14,360 --> 00:13:17,589
for have to turn off now the hard way

213
00:13:17,589 --> 00:13:21,010
is the only thing you can do and
effectiveness also Windows

214
00:13:21,010 --> 00:13:25,010
a terminus 2012 Summer

215
00:13:25,010 --> 00:13:29,540
yet and it's not getting fixed um

216
00:13:29,540 --> 00:13:34,920
and let's revisit that 1p course exactly
the same for ability is present

217
00:13:34,920 --> 00:13:38,700
with the same culprits at this time I
was expected to

218
00:13:38,700 --> 00:13:41,810
same thing but this time not saying on a
congressional

219
00:13:41,810 --> 00:13:45,760
this time you put in route entries which
shows it had lots

220
00:13:45,760 --> 00:13:50,399
of ipv6 implement implementers so the
developers to implement ipv6

221
00:13:50,399 --> 00:13:55,899
day do what between security call Indian
development style

222
00:13:55,899 --> 00:13:59,610
Indian development style means if you
fix something

223
00:13:59,610 --> 00:14:04,180
you don't look left and right if there's
a simple ability in the dejected coat

224
00:14:04,180 --> 00:14:08,120
because you just don't care that because
that's not your job

225
00:14:08,120 --> 00:14:11,870
your job is to fix that Bach if there's
a park but one line before or after you

226
00:14:11,870 --> 00:14:14,139
don't care

227
00:14:14,139 --> 00:14:18,230
my call the races but that's how we call
if you work in office a man te canto

228
00:14:18,230 --> 00:14:20,180
recall

229
00:14:20,180 --> 00:14:23,620
you get fed up with how direct how to
fix packs how did not fix parks and

230
00:14:23,620 --> 00:14:24,579
stuff like that

231
00:14:24,579 --> 00:14:28,860
so sorry Indian programming or Indian
fixing

232
00:14:28,860 --> 00:14:32,500
yes and again i mean it's a simple bark
anybody can come up with that

233
00:14:32,500 --> 00:14:36,040
it's the same like two years before
basically

234
00:14:36,040 --> 00:14:40,120
and everyone again as affected now

235
00:14:40,120 --> 00:14:44,060
how surprising and stuff um

236
00:14:44,060 --> 00:14:48,100
there's a new tool for not flood router
26 which came down from the tutsi ipv6

237
00:14:48,100 --> 00:14:48,860
packets

238
00:14:48,860 --> 00:14:53,089
um I published three weeks ago you just
started everything which is beasty

239
00:14:53,089 --> 00:14:54,920
windows-based is gone

240
00:14:54,920 --> 00:15:01,920
from the ipv6 network have just gone so
don't try to tear the conference

241
00:15:03,550 --> 00:15:06,779
so um another thing which is

242
00:15:06,779 --> 00:15:11,060
so easy its unbelievable that it works

243
00:15:11,060 --> 00:15:15,310
arm in ipv6 you have neighbors so the
station it was solicitation is

244
00:15:15,310 --> 00:15:19,040
a replacement for are not be four if you
want on the local network

245
00:15:19,040 --> 00:15:22,760
the mecca dressed with ipv4 address to
be able to send that person

246
00:15:22,760 --> 00:15:26,300
packets you do it RP lookup are prick
West

247
00:15:26,300 --> 00:15:29,870
the same thing I have an ipv6 but %uh
some with ICMP instead of art

248
00:15:29,870 --> 00:15:34,320
escort neighbor solicitation because
it's homeschooler

249
00:15:34,320 --> 00:15:38,310
so unit ends if you want the mac address
to an ipv6 addresses

250
00:15:38,310 --> 00:15:41,570
said the neighbors so the station
requests to the network

251
00:15:41,570 --> 00:15:45,190
and this person who has dis ipv6 stress

252
00:15:45,190 --> 00:15:49,279
Oz's with neighbor advertisement packet
which contains the mac address

253
00:15:49,279 --> 00:15:52,300
of course you can do the same thing as I
before

254
00:15:52,300 --> 00:15:55,880
I'm are spoofing neighbor discovery
spoofing and stuff like that

255
00:15:55,880 --> 00:15:59,720
up men in the middle neighbor discovery
man in the middle same thing I presented

256
00:15:59,720 --> 00:16:01,610
on that seven years ago

257
00:16:01,610 --> 00:16:05,230
um but the surprising as

258
00:16:05,230 --> 00:16:10,850
if you sent thousands of his neighbor
solicitation packets 21 targets

259
00:16:10,850 --> 00:16:13,899
what happens is that that target

260
00:16:13,899 --> 00:16:16,920
this busy sending replies doing nothing
else

261
00:16:16,920 --> 00:16:20,480
because its how it works is dis is done
in the kernel

262
00:16:20,480 --> 00:16:24,240
the car and gets this packet and replies
to that

263
00:16:24,240 --> 00:16:28,699
and because the car has the highest
priority hired at any user space process

264
00:16:28,699 --> 00:16:32,110
it's the only thing at us and again you
might be surprised

265
00:16:32,110 --> 00:16:35,970
okay who what implement something I dot

266
00:16:35,970 --> 00:16:40,279
yeah everybody again it's a simple the
tech

267
00:16:40,279 --> 00:16:43,459
anybody can come over this really don't
have to be a great actor

268
00:16:43,459 --> 00:16:50,399
anybody can do that and come on

269
00:16:50,399 --> 00:16:53,880
you might suppress what about Linux I
mean the Linux kernel

270
00:16:53,880 --> 00:16:57,279
is not known to be the most secure
colonel

271
00:16:57,279 --> 00:17:03,519
being developed surprisingly very very
few vulnerabilities I found a fact Linux

272
00:17:03,519 --> 00:17:06,889
so I've taxes last year but its not
factored

273
00:17:06,889 --> 00:17:11,959
the very very newest whoever the three
dots 6

274
00:17:11,959 --> 00:17:15,809
arm has vulnerability I don't know what
it is but its

275
00:17:15,809 --> 00:17:19,829
while testing the last rains on that are
distributed but the train headed 'em

276
00:17:19,829 --> 00:17:23,549
three weeks ago we crashed the
newsletters cradled by his

277
00:17:23,549 --> 00:17:26,620
some fourth which are on the package and
we don't know which one because we're

278
00:17:26,620 --> 00:17:28,380
using them all at once

279
00:17:28,380 --> 00:17:34,850
um so maybe you find out which one is
unpublished data. please

280
00:17:34,850 --> 00:17:40,330
so than after flooding surprises let's
to fragmentation surprises

281
00:17:40,330 --> 00:17:43,789
what can happen with fragmentation um

282
00:17:43,789 --> 00:17:47,690
there's a big difference in how
fragmentation Brooks ipv6 10 it doesn't

283
00:17:47,690 --> 00:17:48,990
have to be four

284
00:17:48,990 --> 00:17:54,700
in ipv4 you just send out packets and if
there's is too small think on the part

285
00:17:54,700 --> 00:17:55,250
of

286
00:17:55,250 --> 00:17:59,840
the router fragments the packets for you
so it gets to the right size

287
00:17:59,840 --> 00:18:05,490
in ninety-six this is not and out no
route room a fragment packets

288
00:18:05,490 --> 00:18:10,179
the only thing a router may do is throw
the pack it away

289
00:18:10,179 --> 00:18:13,799
and send a package to the center saying
I want you know this packet was too

290
00:18:13,799 --> 00:18:18,700
harsh please make them smaller otherwise
i confident have to throw them away

291
00:18:18,700 --> 00:18:23,600
and then the host fragments the packets
and I V six only the host the sender is

292
00:18:23,600 --> 00:18:25,520
allowed to fragment the packets

293
00:18:25,520 --> 00:18:30,730
with a okay why can eat and must just re
sent and smaller packets and instead of

294
00:18:30,730 --> 00:18:32,360
fragmentation so

295
00:18:32,360 --> 00:18:35,500
but yet that's how it works um

296
00:18:35,500 --> 00:18:38,830
this is hard fragmentation is done in
ipv6

297
00:18:38,830 --> 00:18:42,549
there's an extra Hatter being put
between the ipv6 header and the

298
00:18:42,549 --> 00:18:44,910
transport layer tease puki CMP

299
00:18:44,910 --> 00:18:49,440
in between um always eight bytes in
length

300
00:18:49,440 --> 00:18:52,679
it has a fragmentation offset this is
calculated in

301
00:18:52,679 --> 00:18:55,910
it by its byte values so the first

302
00:18:55,910 --> 00:18:59,650
fragment always starts of course with
offset :0 because that's where the

303
00:18:59,650 --> 00:19:00,919
package starts

304
00:19:00,919 --> 00:19:04,299
and then there's one bit which is the
more fragments bits

305
00:19:04,299 --> 00:19:07,549
if they are more fragments to come
there's one if just

306
00:19:07,549 --> 00:19:11,340
the last fragment its 0

307
00:19:11,340 --> 00:19:15,460
so what you can do in ipv6 which is not
possible not to be four

308
00:19:15,460 --> 00:19:19,840
you can's put in a fragmentation header
it starts at of tits euro

309
00:19:19,840 --> 00:19:23,730
sewers the first fragment and you said
issuer to the more fragments but so is

310
00:19:23,730 --> 00:19:25,510
the last fragment

311
00:19:25,510 --> 00:19:29,929
which makes no sense Jeffress fragment
last fragment

312
00:19:29,929 --> 00:19:33,020
and string fragmentation but it works

313
00:19:33,020 --> 00:19:37,260
it's called one-shot fragmentation or
atomic fragment

314
00:19:37,260 --> 00:19:40,500
and it's it's accepted by all systems

315
00:19:40,500 --> 00:19:44,410
and we can do stuff with that of course
and then there's a fragmentation I D

316
00:19:44,410 --> 00:19:47,530
this is to identify re: so fragmentation
streams

317
00:19:47,530 --> 00:19:51,309
Cancino Katie's belong together these
fragments

318
00:19:51,309 --> 00:19:55,360
so what can we do without for example

319
00:19:55,360 --> 00:19:59,070
um we start fragmenting the large packet
sent

320
00:19:59,070 --> 00:20:03,000
one kilobytes of data used to the first
test offset of zero and the

321
00:20:03,000 --> 00:20:08,549
more fragments but to set we said the
second one of that is one at 1,024 bytes

322
00:20:08,549 --> 00:20:12,030
and more fragments we continue continue
continue

323
00:20:12,030 --> 00:20:16,610
until a very large number sixty four
thousand 512

324
00:20:16,610 --> 00:20:21,640
send set them more fragments bit and
said 1,060 bytes of data

325
00:20:21,640 --> 00:20:25,360
white-out we want to go to the maximum
amount possible

326
00:20:25,360 --> 00:20:29,010
of the fragmentation offset which is
65535

327
00:20:29,010 --> 00:20:32,380
it now we say this is the last fragment

328
00:20:32,380 --> 00:20:35,940
and said the maximum amount of tater
which is

329
00:20:35,940 --> 00:20:39,830
common on a units link which is 1500
bytes

330
00:20:39,830 --> 00:20:42,950
minus big fragmentation head of mine is
ipv6 header

331
00:20:42,950 --> 00:20:46,169
and then you get to 1,432 bites

332
00:20:46,169 --> 00:20:49,640
now when this is received

333
00:20:49,640 --> 00:20:52,960
the systems will reassemble the packets
because

334
00:20:52,960 --> 00:20:56,750
now it is complete what a gets

335
00:20:56,750 --> 00:21:01,539
come on is a packet switches 66

336
00:21:01,539 --> 00:21:05,159
thousand 960 bytes in size

337
00:21:05,159 --> 00:21:08,740
which is larger than it out because the
maximum packet size ipv6

338
00:21:08,740 --> 00:21:12,690
is the same as night before 64 kilobytes
dis mornin 64 kilobytes

339
00:21:12,690 --> 00:21:18,090
if you at which is a forty bites from
the ipv6 header if 67,000 bites

340
00:21:18,090 --> 00:21:22,150
what could possibly go wrong

341
00:21:22,150 --> 00:21:26,480
to some this might be a plot surprised
that this is possible

342
00:21:26,480 --> 00:21:32,470
how mmm actually all the stuff I'm
showing you now all the next mobility is

343
00:21:32,470 --> 00:21:36,380
I didn't look for any one of these you
might ask

344
00:21:36,380 --> 00:21:39,880
but how did you find this stuff I just
stumbled across it so

345
00:21:39,880 --> 00:21:43,340
I had back in the time ivory personal
file on my system

346
00:21:43,340 --> 00:21:46,549
and when I was training packet some
playing around I would always get a blue

347
00:21:46,549 --> 00:21:48,570
screen

348
00:21:48,570 --> 00:21:52,380
this one so I thought okay what the fark
com

349
00:21:52,380 --> 00:21:55,940
its and because it happened again again
as a cocky it must be destroyed

350
00:21:55,940 --> 00:21:59,990
I'm calling when I started the it grew
street so why and I

351
00:21:59,990 --> 00:22:03,380
looked into it until I found out it was
your personal firewall

352
00:22:03,380 --> 00:22:06,409
so any other person if I wipe might be
affected as well

353
00:22:06,409 --> 00:22:10,919
I have checked you can do that the tools
are on the package

354
00:22:10,919 --> 00:22:15,580
um its fixed with have your personal
firewall 2013 which came

355
00:22:15,580 --> 00:22:19,620
out for weeks ago ok before I did my
first presentation on that

356
00:22:19,620 --> 00:22:23,850
the fix it in time whatever if you still
have your personal file 2012

357
00:22:23,850 --> 00:22:28,280
it will take another months or so until
last until they put out a fix for the

358
00:22:28,280 --> 00:22:29,650
older version

359
00:22:29,650 --> 00:22:34,100
so if you still have 2012 you're still
vulnerable

360
00:22:34,100 --> 00:22:37,440
yeah um other fragmentation surprise us

361
00:22:37,440 --> 00:22:43,659
dis is its Sykes all sigh wall firewall
which is usually used in

362
00:22:43,659 --> 00:22:46,710
a small-medium business environments

363
00:22:46,710 --> 00:22:50,200
I'm because it's pretty flexible has
lots of options as I found on what are

364
00:22:50,200 --> 00:22:51,580
the options actually don't work

365
00:22:51,580 --> 00:22:56,100
butts yeah it's also not that expensive

366
00:22:56,100 --> 00:23:00,450
so um imagine you half a rule Conficker
twitch

367
00:23:00,450 --> 00:23:05,380
allows S's a success to an internal
machine

368
00:23:05,380 --> 00:23:10,320
but OK this time someone is accessing
that intro machine on SSH

369
00:23:10,320 --> 00:23:13,960
the administrator recognize faulk we
haven't evil hacker who

370
00:23:13,960 --> 00:23:17,200
just compromise our internal server
faulk

371
00:23:17,200 --> 00:23:21,980
I have to change the rule to block him
out

372
00:23:21,980 --> 00:23:25,520
how so connection is terminated he tries
again

373
00:23:25,520 --> 00:23:30,270
is blocked unless

374
00:23:30,270 --> 00:23:34,640
you put fragmentation header before the
TCP SYN packets

375
00:23:34,640 --> 00:23:37,720
that its allowed through

376
00:23:37,720 --> 00:23:41,159
and I was surprised so I sentiment but
reporter said hate

377
00:23:41,159 --> 00:23:46,789
I found this stuff you can bypassed the
ACL rule which was created

378
00:23:46,789 --> 00:23:49,820
um you should fix that

379
00:23:49,820 --> 00:23:54,020
it will be 90 this is correct behavior

380
00:23:54,020 --> 00:23:58,080
because as it has as a fragmented
packard

381
00:23:58,080 --> 00:24:01,260
it must be long to establish connection
Wichita

382
00:24:01,260 --> 00:24:05,260
actually half me to the peace and is
nothing being establish connection

383
00:24:05,260 --> 00:24:10,070
but because in some history hours ago
there once was a rude which allowed some

384
00:24:10,070 --> 00:24:12,720
it might be long-term debt old rule

385
00:24:12,720 --> 00:24:16,150
so we don't wonder hinder any customer
experience so

386
00:24:16,150 --> 00:24:21,260
we allow through unbelievable that even
if you have specific you set up a rule

387
00:24:21,260 --> 00:24:23,190
which denies that kind of traffic

388
00:24:23,190 --> 00:24:28,919
you can bypass it and yes state-owned
considered as a fuck

389
00:24:28,919 --> 00:24:32,080
yeah makes you ask question if

390
00:24:32,080 --> 00:24:36,500
if terry Lee security vendor

391
00:24:36,500 --> 00:24:39,510
now other fragmentation surprises again
dis

392
00:24:39,510 --> 00:24:43,270
this is now I'm Astaro firewall and was
just

393
00:24:43,270 --> 00:24:46,440
at innocent bystander to the test when I
was doing ipv6

394
00:24:46,440 --> 00:24:51,750
this more AP six project for customer
was just on the possum got hits

395
00:24:51,750 --> 00:24:55,110
buy something arm which is also very
very easy to

396
00:24:55,110 --> 00:24:59,250
actually um ice I sent a fragment

397
00:24:59,250 --> 00:25:02,570
fragment ideas a of its yours with the
first fragment

398
00:25:02,570 --> 00:25:06,590
I said it send a second package same
fragment I T

399
00:25:06,590 --> 00:25:11,220
but with of the top twenty thousand and
I think send a third one fragment ID

400
00:25:11,220 --> 00:25:16,650
eighty with offset of 60,000 arm

401
00:25:16,650 --> 00:25:21,260
what should happen well just collect you
33 Ackman's and fine

402
00:25:21,260 --> 00:25:25,539
if you float that whoever what happened
is that the Faroe just when

403
00:25:25,539 --> 00:25:28,909
1 percent secure totally crash

404
00:25:28,909 --> 00:25:32,580
and what happened there was that ol

405
00:25:32,580 --> 00:25:36,830
there's a package which will become if I
get all the other fragments 62 kilobytes

406
00:25:36,830 --> 00:25:40,679
I should already al Qaeda memory

407
00:25:40,679 --> 00:25:44,779
Louis just flout with some very small
packets

408
00:25:44,779 --> 00:25:49,539
and just after 20 seconds it's gone

409
00:25:49,539 --> 00:25:53,179
again very very easy attack

410
00:25:53,179 --> 00:25:57,460
and now we have failed all vendors which
are not able to implement

411
00:25:57,460 --> 00:26:00,570
ipv6 security in can be surprised by

412
00:26:00,570 --> 00:26:03,760
such simple things Packet Inc

413
00:26:03,760 --> 00:26:08,779
going a little bit too large and
fragmentation which is family

414
00:26:08,779 --> 00:26:13,559
poets and establish connection all are
struck me as I have to allocate memory

415
00:26:13,559 --> 00:26:17,960
come on this is not not science stuff
does easy stuff

416
00:26:17,960 --> 00:26:22,159
and the firewall vendors come get that
things right what would you expect

417
00:26:22,159 --> 00:26:26,549
windows or abuse to: rose X how good is
to implementation

418
00:26:26,549 --> 00:26:30,740
and actually before it's even worse so
that's a state of security

419
00:26:30,740 --> 00:26:34,080
that we have an ipv6 implementation
that's a reason why there's

420
00:26:34,080 --> 00:26:37,760
this large difference in IP for
implementation box and ipv6

421
00:26:37,760 --> 00:26:39,669
implementation box

422
00:26:39,669 --> 00:26:44,380
um there's one more I call this router
Lord magic

423
00:26:44,380 --> 00:26:47,820
what is that router at Magic okay

424
00:26:47,820 --> 00:26:53,150
there is an extension header 96 I find
very cool and thank you for having

425
00:26:53,150 --> 00:26:57,370
hackers and the RC's comment tease
putting stuff in we desperately need for

426
00:26:57,370 --> 00:26:59,770
hacking

427
00:26:59,770 --> 00:27:02,990
the hope i helped extension headers
something if you told that to have good

428
00:27:02,990 --> 00:27:04,360
at existing go like

429
00:27:04,360 --> 00:27:08,380
hop so hot by extension header is

430
00:27:08,380 --> 00:27:11,610
if you put this extension header into a
packet

431
00:27:11,610 --> 00:27:14,799
the standard says every router on the
mop of

432
00:27:14,799 --> 00:27:19,980
must inspect the package though the
contents of the package

433
00:27:19,980 --> 00:27:23,020
first extension header and then
depending on what to do this extension

434
00:27:23,020 --> 00:27:25,210
headers all the upper layer protocol

435
00:27:25,210 --> 00:27:29,340
and now imagine if from the book which
crashed for example a Cisco Juniper

436
00:27:29,340 --> 00:27:34,899
and just sent it on the positive router
on then it goes boom boom boom boom

437
00:27:34,899 --> 00:27:39,070
so sounds like a very good idea in my
opinion

438
00:27:39,070 --> 00:27:42,159
um so there's this extension at us which
forces every router

439
00:27:42,159 --> 00:27:45,500
on the path to at least look at the
extension header and there's

440
00:27:45,500 --> 00:27:48,850
an option called router alert you're
also not

441
00:27:48,850 --> 00:27:53,130
option means the up earlier Transfer
Protocol is important for you you must

442
00:27:53,130 --> 00:27:54,740
check it

443
00:27:54,740 --> 00:27:57,770
and they're different day there's
another officer says what kind of up in

444
00:27:57,770 --> 00:27:59,450
the air transfer protocol is dis would
be

445
00:27:59,450 --> 00:28:03,000
what the cuss listener discovery which
is ICMP type

446
00:28:03,000 --> 00:28:06,870
which actually would not be traveling
over over the dock alarm

447
00:28:06,870 --> 00:28:10,380
actually but you can and its

448
00:28:10,380 --> 00:28:13,700
what could property Coorong

449
00:28:13,700 --> 00:28:17,159
it's not a big issue but is surprising
issue

450
00:28:17,159 --> 00:28:21,299
if you have being a Cisco routers which
is a Cisco

451
00:28:21,299 --> 00:28:25,480
and it has an ACL which says no ICMP
from a guy

452
00:28:25,480 --> 00:28:30,059
now it will not reply because of its ACL

453
00:28:30,059 --> 00:28:34,380
it's preventing receiving the packet

454
00:28:34,380 --> 00:28:39,440
whoever if you ping a system which is
behind the Cisco router

455
00:28:39,440 --> 00:28:43,419
but put the router a word option in

456
00:28:43,419 --> 00:28:46,640
the Cisco answer and this is true for

457
00:28:46,640 --> 00:28:50,809
all ICMP version six types everything

458
00:28:50,809 --> 00:28:54,700
so with such a simple matter you can
bypass

459
00:28:54,700 --> 00:28:58,240
ICMP ACLs on Cisco's

460
00:28:58,240 --> 00:29:02,500
again how could just happen come on

461
00:29:02,500 --> 00:29:06,370
arm they're fixing that also Cisco's
actually one of my favorites

462
00:29:06,370 --> 00:29:10,960
arm companies to work with because
they're actually fixing stuff

463
00:29:10,960 --> 00:29:14,429
especially for ipv6 have also very good

464
00:29:14,429 --> 00:29:18,190
I P ipv6 security team

465
00:29:18,190 --> 00:29:23,330
um yeah and I want is bucks fix for a
reason

466
00:29:23,330 --> 00:29:27,360
why did my first firsts research like

467
00:29:27,360 --> 00:29:32,899
on Roger good stuff five years ago I was
thinking bout dis feature would be great

468
00:29:32,899 --> 00:29:35,020
enough service tool

469
00:29:35,020 --> 00:29:39,380
i flossed remote network with packets in
all half

470
00:29:39,380 --> 00:29:42,899
extension of action hope I hope and
router Road which would require

471
00:29:42,899 --> 00:29:46,440
every router on the path to inspect the
packets

472
00:29:46,440 --> 00:29:49,529
so how it usually works everest thing is
done and hardware

473
00:29:49,529 --> 00:29:52,809
ASIC otherwise you don't get any speed

474
00:29:52,809 --> 00:29:55,809
but if there's a hopper extension header
with the router good

475
00:29:55,809 --> 00:29:59,510
every row to must copy the package to
ram

476
00:29:59,510 --> 00:30:02,880
and then the CPU must assess the packet

477
00:30:02,880 --> 00:30:08,159
and CPU on a router is limited resource
it's an expensive resource

478
00:30:08,159 --> 00:30:12,020
so if you flood a router without my
expectation worse

479
00:30:12,020 --> 00:30:16,490
your route he will get very very slow
for the hope of

480
00:30:16,490 --> 00:30:20,309
to my room surprise what happened

481
00:30:20,309 --> 00:30:23,960
that my packet latency was cut by 50

482
00:30:23,960 --> 00:30:27,669
percent to 200 percent

483
00:30:27,669 --> 00:30:31,799
I had its a test for 80s look for love
topmost far away

484
00:30:31,799 --> 00:30:35,210
server I could find was in Japan

485
00:30:35,210 --> 00:30:39,159
to pick and back it was one-dot eight
seconds

486
00:30:39,159 --> 00:30:43,120
that I put the road to Rhode option into
the ping packet funny was only

487
00:30:43,120 --> 00:30:46,960
200 300 milliseconds I was like

488
00:30:46,960 --> 00:30:50,880
okay something is going wrong here

489
00:30:50,880 --> 00:30:54,299
i mean clearly this must be some Bach
the

490
00:30:54,299 --> 00:30:58,039
remote server can't be sending the state
I mean they're

491
00:30:58,039 --> 00:31:01,860
undersea lines and of course is must
take a long time to get to Japan

492
00:31:01,860 --> 00:31:05,440
so it just happened this can be true so

493
00:31:05,440 --> 00:31:08,850
I went to some friends who had servers
absurd

494
00:31:08,850 --> 00:31:12,809
really don't servers with ipv6 um

495
00:31:12,809 --> 00:31:16,130
in some places in the world as advocate
let me do that dis

496
00:31:16,130 --> 00:31:20,260
with your system and you to use a beat
Albany see if the packet really

497
00:31:20,260 --> 00:31:24,490
arrives at your system and if your
system release and the answer

498
00:31:24,490 --> 00:31:28,610
and with that and it really happened so
the answer was reeling from

499
00:31:28,610 --> 00:31:32,010
that system I was picking

500
00:31:32,010 --> 00:31:35,080
and it's amazing I mean I'm from germany
um

501
00:31:35,080 --> 00:31:38,269
if you 12 first-person shooters you know

502
00:31:38,269 --> 00:31:41,500
late inspected latency is very very
important

503
00:31:41,500 --> 00:31:44,950
to keep that your bullets fly faster
than the others

504
00:31:44,950 --> 00:31:48,570
ands you can pick extra

505
00:31:48,570 --> 00:31:52,870
to have a FOSS ok lower latency for your
packets for example tortured him calls

506
00:31:52,870 --> 00:31:53,960
that fast path

507
00:31:53,960 --> 00:31:57,789
cost something like five euros per month
or so I get away

508
00:31:57,789 --> 00:32:01,970
better delays latency by dis good doing
it for free

509
00:32:01,970 --> 00:32:05,029
so this is actually pretty nice whatever
damn

510
00:32:05,029 --> 00:32:08,580
Cisco implemented is bach in there are
US

511
00:32:08,580 --> 00:32:12,399
my eyes P in installed this

512
00:32:12,399 --> 00:32:17,330
buggy I US in der routers in system i
cant use this feature anymore

513
00:32:17,330 --> 00:32:21,510
so despite I am really desperate at this
back its fixed and then also

514
00:32:21,510 --> 00:32:26,059
didn't fix iris image gets implemented
the Rogers of my eyes P

515
00:32:26,059 --> 00:32:29,820
because dis is really good stuff

516
00:32:29,820 --> 00:32:32,820
yeah um to

517
00:32:32,820 --> 00:32:37,710
completely different topic when it comes
to ipv6

518
00:32:37,710 --> 00:32:41,710
people seem to think that everything is
nice

519
00:32:41,710 --> 00:32:45,830
like united 95 for an ipv6 was designed

520
00:32:45,830 --> 00:32:49,190
the internet was still very safe place

521
00:32:49,190 --> 00:32:53,159
you didn't need to encrypt your traffic
yeah you could do to help their Danish

522
00:32:53,159 --> 00:32:55,070
TPN everything

523
00:32:55,070 --> 00:32:59,010
no encryption necessary because to reno
or very few

524
00:32:59,010 --> 00:33:02,200
at people on the internet which is
totally different

525
00:33:02,200 --> 00:33:06,090
today especially in this room maybe um

526
00:33:06,090 --> 00:33:09,840
and it seems that the same thinking is
now on ipv6

527
00:33:09,840 --> 00:33:13,750
today so what I did

528
00:33:13,750 --> 00:33:18,450
bus I get a list up the 2000

529
00:33:18,450 --> 00:33:21,789
most high-profile domains

530
00:33:21,789 --> 00:33:27,110
which are ipv6 enabled on these two
thousand five hundred domains

531
00:33:27,110 --> 00:33:31,019
so New York Times whatsoever blah blah
um

532
00:33:31,019 --> 00:33:34,210
I its DNS hostname port forcing

533
00:33:34,210 --> 00:33:39,110
so W W dot company dot com FTP dot the
company dot com SMTP not coming to

534
00:33:39,110 --> 00:33:40,309
comment on and so on

535
00:33:40,309 --> 00:33:44,440
so far several thousand hostnames and
every time I get back

536
00:33:44,440 --> 00:33:47,570
IP four and an ipv6 address for server

537
00:33:47,570 --> 00:33:52,519
I put these address into a special file

538
00:33:52,519 --> 00:33:56,669
when I happen the tough up for the two
thousand five hundred domains

539
00:33:56,669 --> 00:34:00,990
for quite some time um what I did with
the servers

540
00:34:00,990 --> 00:34:04,080
a port scan them a port scan them for
ipv4 address

541
00:34:04,080 --> 00:34:08,089
and Fort ipv6 address for administrative
ports

542
00:34:08,089 --> 00:34:11,799
SS 8 remote desktop and so on and I
wasn't as

543
00:34:11,799 --> 00:34:15,280
is stir actually difference and
surprisingly

544
00:34:15,280 --> 00:34:19,149
there is so for service

545
00:34:19,149 --> 00:34:23,470
on ipv4 you see that for example a VNC
RTP

546
00:34:23,470 --> 00:34:26,980
arm or to hell that's telnet yet have

547
00:34:26,980 --> 00:34:31,980
um it's very very very rare Siro dot 1
percent

548
00:34:31,980 --> 00:34:36,419
that and administrative partners open on
ipv4 Internet for you

549
00:34:36,419 --> 00:34:39,780
that's a good number now okay as

550
00:34:39,780 --> 00:34:45,460
ages more dominant with 63 percent but
is usually done hosted servers

551
00:34:45,460 --> 00:34:49,329
let's have a look on ipv6 I was 6 is
still

552
00:34:49,329 --> 00:34:53,230
not that high number but if you compare
it is its 526

553
00:34:53,230 --> 00:34:56,750
times the number the five to six times

554
00:34:56,750 --> 00:35:00,079
more insecure ACL configuration or no AC

555
00:35:00,079 --> 00:35:05,030
a ACL configuration on ipv6

556
00:35:05,030 --> 00:35:08,770
okay thought mmm doesn't look good

557
00:35:08,770 --> 00:35:13,180
so companies don't seem to know that
well what to do

558
00:35:13,180 --> 00:35:16,250
how bout the eyes peas

559
00:35:16,250 --> 00:35:19,480
so at the next step what I did it i
trace route

560
00:35:19,480 --> 00:35:24,010
all these machines on ipv4 and ipv6

561
00:35:24,010 --> 00:35:27,940
and collected the routers on the party
dresses and I did the same thing todos

562
00:35:27,940 --> 00:35:29,680
Rogers from the ice peace

563
00:35:29,680 --> 00:35:33,270
so tell that SSH what's the difference

564
00:35:33,270 --> 00:35:37,900
on ipv4 you see that for example tell
that is available on five percent on all

565
00:35:37,900 --> 00:35:39,490
the ipv4

566
00:35:39,490 --> 00:35:42,550
routers

567
00:35:42,550 --> 00:35:46,220
where you half seven to eight percent

568
00:35:46,220 --> 00:35:50,339
telnet helmet I mean I can understand
for IP four maybe the voters say all

569
00:35:50,339 --> 00:35:54,190
they don't have as a supporter something
because RAM or CPU

570
00:35:54,190 --> 00:35:59,150
imitation stuff I i understand but every
device which supports ipv6

571
00:35:59,150 --> 00:36:04,589
has SSH so I don't understand white
hairs to helmet on ipv6 devices

572
00:36:04,589 --> 00:36:09,619
I don't understand that and SSH you see
it's something like sixteen percent

573
00:36:09,619 --> 00:36:10,570
where it was hearsay

574
00:36:10,570 --> 00:36:14,550
seven-percent so even eyes peas

575
00:36:14,550 --> 00:36:21,550
are way more in securing the
configurations on ipv6 compare to ipv4

576
00:36:21,730 --> 00:36:25,250
midas okay why actually I think there
are two reasons

577
00:36:25,250 --> 00:36:29,170
the first reason is thats to protect
your environment

578
00:36:29,170 --> 00:36:33,660
need to firewall and ipv6 firewalls are
scarce

579
00:36:33,660 --> 00:36:37,060
day have very limited support for
features

580
00:36:37,060 --> 00:36:40,760
they're expensive and really have to
bite him

581
00:36:40,760 --> 00:36:44,650
buying them in a company text time and
someone needs to sign off budget and

582
00:36:44,650 --> 00:36:45,630
stuff like up

583
00:36:45,630 --> 00:36:49,380
so that's why lots of the environment
today don't have an ipv6 firewall

584
00:36:49,380 --> 00:36:54,640
def not be for firewall and a filter
stuff and ipv6 is unfiltered

585
00:36:54,640 --> 00:36:59,869
arm I do lots of getting on ipv6 of
course for statistical purposes

586
00:36:59,869 --> 00:37:05,030
and I I really scandal at every year i
scan

587
00:37:05,030 --> 00:37:08,980
several hundred thousands of of machines

588
00:37:08,980 --> 00:37:12,310
and Pasha think that

589
00:37:12,310 --> 00:37:16,070
very rarely I getting email from the
abuse team of my eyes P

590
00:37:16,070 --> 00:37:20,849
very very rarely that there is some
common ones who always tell you put them

591
00:37:20,849 --> 00:37:22,910
in a list you don't get them again and

592
00:37:22,910 --> 00:37:26,170
my crew scans nobody has a problem

593
00:37:26,170 --> 00:37:30,940
nobody I scan really billions of
addresses nobody cares

594
00:37:30,940 --> 00:37:34,570
and from the output you see it well

595
00:37:34,570 --> 00:37:38,510
no security wonderful we come to that
act in the next slide

596
00:37:38,510 --> 00:37:42,760
done for you so the second reason I
think

597
00:37:42,760 --> 00:37:46,890
we see dot is so they're pretty curious
and ipv6

598
00:37:46,890 --> 00:37:50,020
its difficult enough to get ipv6 a new
environment

599
00:37:50,020 --> 00:37:53,880
running that caring also for security

600
00:37:53,880 --> 00:37:58,030
its you don't have the time and you
don't see the need because who's on ipv6

601
00:37:58,030 --> 00:38:01,369
nobody there are no hackers ipv6 0

602
00:38:01,369 --> 00:38:05,300
why you need protection now and that's
why you still see

603
00:38:05,300 --> 00:38:08,540
to helm thats being available on ipv6
devices

604
00:38:08,540 --> 00:38:12,210
horrible yeah

605
00:38:12,210 --> 00:38:17,490
so find a topic how to append just ipv6

606
00:38:17,490 --> 00:38:21,579
the main problem when packed st. ipv6
from remote

607
00:38:21,579 --> 00:38:25,510
is that two subnets

608
00:38:25,510 --> 00:38:31,040
the servers are standing in havoc very
very very large size

609
00:38:31,040 --> 00:38:34,480
Supper is a slash 64

610
00:38:34,480 --> 00:38:37,490
of 128-bit which means that

611
00:38:37,490 --> 00:38:40,859
every sup that in ipv6 you want to scan

612
00:38:40,859 --> 00:38:45,180
its four billion times the whole
internet

613
00:38:45,180 --> 00:38:49,089
so how do you want to scan that whoever
you in this room scanty whole internet

614
00:38:49,089 --> 00:38:51,280
for one port

615
00:38:51,280 --> 00:38:54,339
I did thats and several people I know
that dot

616
00:38:54,339 --> 00:38:57,430
now one hand there hard on did it take
you

617
00:38:57,430 --> 00:39:01,170
how many days

618
00:39:01,170 --> 00:39:04,890
the guy who was racing and Hall how many
days did didn't require you to skip to

619
00:39:04,890 --> 00:39:07,740
scan in it for one port

620
00:39:07,740 --> 00:39:11,930
okay I could tell my number its about 12
to 14 days

621
00:39:11,930 --> 00:39:15,190
from one machine not that powerful but a
very

622
00:39:15,190 --> 00:39:18,220
um good cook internet connection I'm

623
00:39:18,220 --> 00:39:21,230
took two days at two weeks

624
00:39:21,230 --> 00:39:25,470
so if you have better machines and stuff
like that and can distribute about

625
00:39:25,470 --> 00:39:31,400
you can get down to one to four days to
scan for one port

626
00:39:31,400 --> 00:39:35,960
arm port eighty and some others

627
00:39:35,960 --> 00:39:41,109
could yeah and it's very noisy get lots
of complaints really doesn't complain

628
00:39:41,109 --> 00:39:45,349
arm Dan Kaminsky and suppressor prom
outdated so I did but the initial

629
00:39:45,349 --> 00:39:47,210
purchase bussed in from a together

630
00:39:47,210 --> 00:39:51,740
dan ba course Stenhouse wasp wasp better
resources to do that

631
00:39:51,740 --> 00:39:56,810
Pentair scanning then 10 didn't specify
do its best to continue the present with

632
00:39:56,810 --> 00:39:58,270
them to get lots of complaints

633
00:39:58,270 --> 00:40:01,530
lots of complaints and even even skewing

634
00:40:01,530 --> 00:40:04,930
stuff in yeah was horrible for them when
I pieces it doesn't happen

635
00:40:04,930 --> 00:40:08,480
but the thickness if you want to start

636
00:40:08,480 --> 00:40:11,930
12 ping scan LifeScan one sup that

637
00:40:11,930 --> 00:40:16,829
once up not only on a remote network if
you start is today

638
00:40:16,829 --> 00:40:21,300
you for your grandchildren will not be
alive to see the output of that once cat

639
00:40:21,300 --> 00:40:25,609
so this is the main problem is ipv6
target discovery

640
00:40:25,609 --> 00:40:30,130
because the Lok the networks the subnets
are so large

641
00:40:30,130 --> 00:40:34,859
so this is why would now show you how to
do that

642
00:40:34,859 --> 00:40:38,819
of course 1 percent kept completeness is
what you wanted chief

643
00:40:38,819 --> 00:40:42,490
but with that Marsh something that size
it's not feasible

644
00:40:42,490 --> 00:40:47,210
but I can show you how we can
statistically gets to 92 to 95 percent

645
00:40:47,210 --> 00:40:50,710
in a very short time so

646
00:40:50,710 --> 00:40:53,839
mile thanks go out to the RIPE NCC as

647
00:40:53,839 --> 00:40:56,980
acting as my example for all this d

648
00:40:56,980 --> 00:40:59,980
the methods to show you

649
00:40:59,980 --> 00:41:04,109
they know about this part of the talk
and they say year we know but

650
00:41:04,109 --> 00:41:08,630
actually we are fine with that so I'm
very happy to say thank you

651
00:41:08,630 --> 00:41:12,540
to supporting this part of the talk
because every technical showing you

652
00:41:12,540 --> 00:41:18,040
works on ripe any will see stuff you all
know and accomplish that it works

653
00:41:18,040 --> 00:41:21,390
so first if you want

654
00:41:21,390 --> 00:41:25,410
to attack something and hopefully you're
getting paid for it out from your target

655
00:41:25,410 --> 00:41:27,150
not from somebody else

656
00:41:27,150 --> 00:41:30,980
um you must find out what is actually Dr
address space

657
00:41:30,980 --> 00:41:33,740
if you know the address space dan you
can attack to me don't want to text

658
00:41:33,740 --> 00:41:34,819
somebody else

659
00:41:34,819 --> 00:41:38,579
was may be innocent so

660
00:41:38,579 --> 00:41:43,910
the easiest way to do that is to go into
BGP routing table in C

661
00:41:43,910 --> 00:41:47,430
what is stats address space they are
using

662
00:41:47,430 --> 00:41:51,369
you can register ipv6 address space for
example it right

663
00:41:51,369 --> 00:41:55,150
but usually because they have eight
years like

664
00:41:55,150 --> 00:41:58,160
you have we will become the largest
company in the world

665
00:41:58,160 --> 00:42:01,700
so we should register very large ipv6
address space

666
00:42:01,700 --> 00:42:05,819
so what is just a is very very large
it's not what they're using

667
00:42:05,819 --> 00:42:09,349
so that's why you should not look for
what they have registered

668
00:42:09,349 --> 00:42:14,060
but rather what Rd renouncing by a BGP
what they want to have from there

669
00:42:14,060 --> 00:42:19,790
large address space for that you first
need the autonomous system number

670
00:42:19,790 --> 00:42:23,630
um this is how you find a man ripe you
just ask for

671
00:42:23,630 --> 00:42:26,660
RIPE NCC and the RIPE Database

672
00:42:26,660 --> 00:42:30,250
but there are many other searches where
you find that arm you gets

673
00:42:30,250 --> 00:42:33,300
the results of all doubt ima system
numbers

674
00:42:33,300 --> 00:42:36,550
now the next step is you dump the in

675
00:42:36,550 --> 00:42:40,780
deep announcements Fortis these
autonomous system numbers 10

676
00:42:40,780 --> 00:42:44,130
enough ports for doubt um

677
00:42:44,130 --> 00:42:49,630
won a good 1i like his arm from
hurricane electric

678
00:42:49,630 --> 00:42:53,329
um you just give them the ultimate
system and a show you this is the ipv6

679
00:42:53,329 --> 00:42:54,170
prefix

680
00:42:54,170 --> 00:42:57,690
day want to have brought it to their
network units for all the

681
00:42:57,690 --> 00:43:01,200
um folder for autonomous system numbers
you found for

682
00:43:01,200 --> 00:43:04,640
arm for ripe just this one does this one

683
00:43:04,640 --> 00:43:08,089
one of the other assistance has no ipv6

684
00:43:08,089 --> 00:43:11,339
and the fourth one has a lot

685
00:43:11,339 --> 00:43:15,560
you see already special 48 special 48

686
00:43:15,560 --> 00:43:19,030
is a very large network its

687
00:43:19,030 --> 00:43:22,310
if you compared to arm ipv4

688
00:43:22,310 --> 00:43:25,740
its class a network

689
00:43:25,740 --> 00:43:29,660
to his house 64k possible subnets

690
00:43:29,660 --> 00:43:34,150
which is a lot and now we have to here
we have maybe another 16

691
00:43:34,150 --> 00:43:39,380
18 class aid possible networks in every
sup that has four billion by four

692
00:43:39,380 --> 00:43:41,020
billion possible addresses

693
00:43:41,020 --> 00:43:44,869
so that such large number which seems
unfeasible

694
00:43:44,869 --> 00:43:48,990
but their stuff we can do

695
00:43:48,990 --> 00:43:52,099
I did lots of getting as I already told
you arm

696
00:43:52,099 --> 00:43:55,160
what I've found out in the statistic
announces that

697
00:43:55,160 --> 00:43:58,900
their are from this guy can tickle our
subnet address space

698
00:43:58,900 --> 00:44:03,700
there are precious which are for you
commonly configured

699
00:44:03,700 --> 00:44:06,720
the one the 1&2 this year 12

700
00:44:06,720 --> 00:44:10,900
you felt the most common one configured
host addresses on a subnet

701
00:44:10,900 --> 00:44:15,339
and they're usually the default gateway
is a main Rogers of the network

702
00:44:15,339 --> 00:44:20,000
so to call a call on one which would
trade says we've got one in ipv4

703
00:44:20,000 --> 00:44:25,170
is configured and sixty three percent of
all active networks

704
00:44:25,170 --> 00:44:28,859
if you go 401 to it seventy-nine percent
to roughly

705
00:44:28,859 --> 00:44:34,190
eighty percent of all the networks so
what we can't do

706
00:44:34,190 --> 00:44:38,180
is use a tool where we scan the range

707
00:44:38,180 --> 00:44:42,410
of pre-fixed they are using in just scan
for the host parts

708
00:44:42,410 --> 00:44:45,530
012 and eighty percent

709
00:44:45,530 --> 00:44:48,710
statistically of the networks being used

710
00:44:48,710 --> 00:44:52,690
will show us that they are a life

711
00:44:52,690 --> 00:44:56,240
so this is a very very quickly we're in
30 seconds

712
00:44:56,240 --> 00:45:00,420
you can scan one of these special forty
8 prefix iz

713
00:45:00,420 --> 00:45:04,900
and see eighty percent of the networks
that are actually being used

714
00:45:04,900 --> 00:45:09,160
that is very very frothing it is OK from
this large address space

715
00:45:09,160 --> 00:45:14,869
using these networks but is more you can
do

716
00:45:14,869 --> 00:45:20,910
in other techniques you can do is
extract everything possible from DNS

717
00:45:20,910 --> 00:45:24,900
in ipv6 addresses are very long there's
nothing like that

718
00:45:24,900 --> 00:45:28,550
who knows DDNS um IP address of Google

719
00:45:28,550 --> 00:45:31,890
hands up yeah

720
00:45:31,890 --> 00:45:36,930
twenty percent of the state's 8.8 8.8
everybody can remember that one come on

721
00:45:36,930 --> 00:45:40,290
on ipv6 there is something like that
easy address

722
00:45:40,290 --> 00:45:44,609
so if you know one ipv6 address in the
future you actually pretty good

723
00:45:44,609 --> 00:45:48,200
out so everything and ipv6 must be in
the DNS

724
00:45:48,200 --> 00:45:52,660
so that is why DNS is the very valuable
target for pen tester

725
00:45:52,660 --> 00:45:56,359
so first we look into that reverse River
stuff that as

726
00:45:56,359 --> 00:46:00,670
ipv6 address resolving to host them

727
00:46:00,670 --> 00:46:03,770
um and there's something nice in the DNS
protocol

728
00:46:03,770 --> 00:46:07,010
definition in that

729
00:46:07,010 --> 00:46:10,770
if you ask for a sub-domain

730
00:46:10,770 --> 00:46:14,290
you get a reply back if this up to Maine
Texas are not

731
00:46:14,290 --> 00:46:19,589
and we can use this technique to reverse
the to get the reverse DNS

732
00:46:19,589 --> 00:46:22,910
information so we ask for some part of
the reverse

733
00:46:22,910 --> 00:46:26,260
ipv6 look up address and does

734
00:46:26,260 --> 00:46:29,680
but there's nothing below we get an
extra may narrow

735
00:46:29,680 --> 00:46:33,579
for where there is something below we
getting no ever

736
00:46:33,579 --> 00:46:36,780
and for the whole slash forty eight
address space

737
00:46:36,780 --> 00:46:40,030
we can do that until we get down to the
to the re

738
00:46:40,030 --> 00:46:43,520
I'm reverse DNS name which 10 translate

739
00:46:43,520 --> 00:46:48,250
to the hostname and this is something
which takes about

740
00:46:48,250 --> 00:46:52,190
thirty-seconds for each slash 48

741
00:46:52,190 --> 00:46:57,020
a canticle our subnet so this is very
very very fast

742
00:46:57,020 --> 00:47:00,859
what we got is possible systems that are
a life

743
00:47:00,859 --> 00:47:06,550
possible ipv6 addresses that are being
in use and we collect them

744
00:47:06,550 --> 00:47:10,250
so this is how it looks for example for
ripe

745
00:47:10,250 --> 00:47:14,690
ap you see it's very very fast cents

746
00:47:14,690 --> 00:47:18,910
you get all the information out at the
half in in there soon for reverse on

747
00:47:18,910 --> 00:47:20,190
file

748
00:47:20,190 --> 00:47:25,450
um but what you also want to have St
host to ipv6 address relation

749
00:47:25,450 --> 00:47:29,319
their cell techniques for that so on
trance routine SX walking as brute

750
00:47:29,319 --> 00:47:31,329
forcing host and we're forcing

751
00:47:31,329 --> 00:47:36,030
I'm the first to really work sewn
transfers how often is he did you miss

752
00:47:36,030 --> 00:47:38,040
on transfer works

753
00:47:38,040 --> 00:47:41,490
it's very rare you Essex walking is very
nice

754
00:47:41,490 --> 00:47:44,680
butts in s sec is still very

755
00:47:44,680 --> 00:47:49,460
very reality ployed so used you're stuck
with the desperate for them is still

756
00:47:49,460 --> 00:47:50,910
good enough

757
00:47:50,910 --> 00:47:54,040
but 15s drawn some transfer work

758
00:47:54,040 --> 00:47:58,540
like on right you have every information
you need to have one percent

759
00:47:58,540 --> 00:48:01,630
completeness of the DNS information

760
00:48:01,630 --> 00:48:07,109
if your duty in SF walking you also get
100 percent completeness

761
00:48:07,109 --> 00:48:11,069
if they have teen ESSEC like ripe

762
00:48:11,069 --> 00:48:15,079
if that's not possible in its the more
common case then you have to do a DNS

763
00:48:15,079 --> 00:48:16,609
hostname port forcing

764
00:48:16,609 --> 00:48:20,720
so having a large word list of possible
host names they could have fun and try

765
00:48:20,720 --> 00:48:23,760
if state if that resolves to an ipv6
address

766
00:48:23,760 --> 00:48:28,099
and in the output you see all the
different net first ever actually using

767
00:48:28,099 --> 00:48:31,960
you get possible ipv6 addresses that
might be like the course to have an

768
00:48:31,960 --> 00:48:32,829
entry for help

769
00:48:32,829 --> 00:48:36,960
and you also see the possible the
networks tear using

770
00:48:36,960 --> 00:48:41,530
so now we have list of net first ever
using from

771
00:48:41,530 --> 00:48:44,700
the scanning we did from the prefix
canning aunt

772
00:48:44,700 --> 00:48:47,849
possible ipv6 addresses and networks

773
00:48:47,849 --> 00:48:53,369
from the DNS analysis so we all put that
in a very large file

774
00:48:53,369 --> 00:48:58,650
and we have a scanning tool which helps
us now doing the Live Scan

775
00:48:58,650 --> 00:49:02,490
um this I option is for the input follow

776
00:49:02,490 --> 00:49:07,550
where you have everything just puttin
the deeper from the common address come

777
00:49:07,550 --> 00:49:10,849
this is was output of a statistic
analysis bird

778
00:49:10,849 --> 00:49:14,450
where I fun ok how to take on Flickr
ipv6 host addresses

779
00:49:14,450 --> 00:49:17,500
and sometimes there around them
sometimes they have various different

780
00:49:17,500 --> 00:49:18,849
kind of

781
00:49:18,849 --> 00:49:22,869
um of patterns ants the talk from

782
00:49:22,869 --> 00:49:26,670
two years ago three years ago shows
exactly what people configure and how

783
00:49:26,670 --> 00:49:27,839
districts like

784
00:49:27,839 --> 00:49:31,559
then if there are configured address
this is the options for out

785
00:49:31,559 --> 00:49:35,069
F is a file piercing most settings in
Pakistan various sports you to keep

786
00:49:35,069 --> 00:49:35,970
packets

787
00:49:35,970 --> 00:49:39,990
and so on and so on and then you go and
then you'll see

788
00:49:39,990 --> 00:49:45,720
well 671 systems life on ipv6 on ripe

789
00:49:45,720 --> 00:49:50,300
from this search space was was several
trillion numbers of possible ipv6

790
00:49:50,300 --> 00:49:51,200
addresses

791
00:49:51,200 --> 00:49:54,990
was just five minutes of work we found

792
00:49:54,990 --> 00:49:59,369
at minimum 90 ninety percent of the
reachable systems

793
00:49:59,369 --> 00:50:02,770
that's how you do that I'm you can also
create mice network maps

794
00:50:02,770 --> 00:50:06,960
um yeah my time is up I can only say
lots of I've eaten

795
00:50:06,960 --> 00:50:11,380
ipv6 is broken not only security vice
also if you just want to implement it

796
00:50:11,380 --> 00:50:12,460
and get it running

797
00:50:12,460 --> 00:50:16,510
so everyone has to do that you have my
feelings

798
00:50:16,510 --> 00:50:20,250
um I have to leave after lunch the half
any more questions

799
00:50:20,250 --> 00:50:24,630
ask find me during lunch and house media
otherwise wish you a great conference

800
00:50:24,630 --> 00:50:27,760
compares to talk it's things to people
who

801
00:50:27,760 --> 00:50:32,059
make like me so fair will be a free day
to picture available for free to make

802
00:50:32,059 --> 00:50:34,260
more nice presentations thank you
everybody

