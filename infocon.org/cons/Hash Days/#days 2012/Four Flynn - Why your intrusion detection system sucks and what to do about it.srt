1
00:00:05,950 --> 00:00:08,110
alright hello everyone

2
00:00:08,110 --> 00:00:12,620
welcome my name is for and urine

3
00:00:12,620 --> 00:00:13,920
interest

4
00:00:13,920 --> 00:00:17,340
same thanks for coming I really
appreciate

5
00:00:17,340 --> 00:00:20,580
you guys have me out this conference and
I spent some time with me today

6
00:00:20,580 --> 00:00:23,760
'em let's do a little bit of a

7
00:00:23,760 --> 00:00:28,650
introductions so up as I said my name is
for I work at Facebook

8
00:00:28,650 --> 00:00:32,000
on in California

9
00:00:32,000 --> 00:00:37,000
and my entire adult life I've been
obsessed with the problem of intrusion

10
00:00:37,000 --> 00:00:37,559
detection

11
00:00:37,559 --> 00:00:41,920
and those view that have have known your
work with me

12
00:00:41,920 --> 00:00:45,680
can contested that's true um

13
00:00:45,680 --> 00:00:49,120
I actually think I've spent more time
thinking about Internet action than any

14
00:00:49,120 --> 00:00:49,500
other

15
00:00:49,500 --> 00:00:52,519
thing in my whole life is actually kinda
sad

16
00:00:52,519 --> 00:00:56,949
but I am I but %uh that's okay

17
00:00:56,949 --> 00:01:00,610
a so I love the problem I'm working on
for a long time

18
00:01:00,610 --> 00:01:04,269
and I i want I wanna talked a little bit
today

19
00:01:04,269 --> 00:01:07,460
about intrusion detection and its its

20
00:01:07,460 --> 00:01:10,490
is one those topics in security that the
you really see you people talking about

21
00:01:10,490 --> 00:01:10,990
a lot

22
00:01:10,990 --> 00:01:14,290
and and frank I haven't seen are people
thinking a lot all about either

23
00:01:14,290 --> 00:01:18,729
arm what I want to do in a stock is
actually spent some time

24
00:01:18,729 --> 00:01:22,990
I talking about how I think about
entering the texan

25
00:01:22,990 --> 00:01:27,710
an I am stepping through some approaches
to it that I thinkers somewhat novel

26
00:01:27,710 --> 00:01:30,899
arm the goal was not so much to impart
some

27
00:01:30,899 --> 00:01:35,729
major new discovery on you but that help
you think about this problem

28
00:01:35,729 --> 00:01:38,880
and hopefully have you come up with
ideas

29
00:01:38,880 --> 00:01:41,890
to help me with this problem so it's a
little bit over

30
00:01:41,890 --> 00:01:45,020
self-serving talk I guess in that way um

31
00:01:45,020 --> 00:01:48,369
but my goal in this is to get you
excited about the subject and get you

32
00:01:48,369 --> 00:01:52,429
to come away with this from the stalk
thinking about new ideas in the field in

33
00:01:52,429 --> 00:01:53,390
ways to contribute

34
00:01:53,390 --> 00:01:57,939
on so that's my goal so this is a

35
00:01:57,939 --> 00:02:00,990
this is talking three acts I the first
act

36
00:02:00,990 --> 00:02:04,490
is is kind of discussing discussing the
the state have

37
00:02:04,490 --> 00:02:08,569
the intrusion detection field and in
order to talk about the state have any

38
00:02:08,569 --> 00:02:09,539
field in security

39
00:02:09,539 --> 00:02:13,730
if the start of the logical place which
is money

40
00:02:13,730 --> 00:02:17,240
um so the security industry

41
00:02:17,240 --> 00:02:21,470
is roughly 3.5 billion dollar industry

42
00:02:21,470 --> 00:02:25,299
a in terms of money spent on on security
products

43
00:02:25,299 --> 00:02:29,470
a and that's according to Gartner

44
00:02:29,470 --> 00:02:34,090
IIT JEE another research firm did some
analysis I try to come up with some

45
00:02:34,090 --> 00:02:37,159
numbers and how much money people are
spending on internet action products

46
00:02:37,159 --> 00:02:40,540
and it turns out it's a little bit hard
to pin down

47
00:02:40,540 --> 00:02:44,879
but a I D G a release some information
about

48
00:02:44,879 --> 00:02:48,099
Sams you guys from our security event
managers and

49
00:02:48,099 --> 00:02:52,319
the whole field of those products on
Sophie people are spending about

50
00:02:52,319 --> 00:02:56,409
1.5 billion dollars a year on those
products arm

51
00:02:56,409 --> 00:02:59,950
sexy couple our money for things that
don't work and do anything useful

52
00:02:59,950 --> 00:03:04,290
so I am I Anna and I'll

53
00:03:04,290 --> 00:03:07,750
and I'll and I'll try to show I think
that's the case over the course in stock

54
00:03:07,750 --> 00:03:11,209
so okay so people spend money on
products

55
00:03:11,209 --> 00:03:14,299
but a how are they working force right

56
00:03:14,299 --> 00:03:18,599
international question ask so who can
return to kinda gays

57
00:03:18,599 --> 00:03:22,239
the date to glean some information about
how all these products are working well

58
00:03:22,239 --> 00:03:23,909
one other ports or so that information
is

59
00:03:23,909 --> 00:03:27,129
is something called the prize indeed a
brief report if you guys ever heard the

60
00:03:27,129 --> 00:03:27,799
saying before

61
00:03:27,799 --> 00:03:31,370
yes and sing some not some not knots
yeah

62
00:03:31,370 --> 00:03:35,040
actually you haven't seen this um you
know I'm not the kind of security guy

63
00:03:35,040 --> 00:03:37,640
that liked love the Magic Quadrant or
something like this:

64
00:03:37,640 --> 00:03:41,140
but some this reports actually really
good Tom

65
00:03:41,140 --> 00:03:44,519
and it's a pretty good summary of the
state of the industry and and so on

66
00:03:44,519 --> 00:03:48,780
so anyway a in the most recent 2012
report

67
00:03:48,780 --> 00:03:52,900
they they have a few different data
points and their I think ur interesting

68
00:03:52,900 --> 00:03:55,829
to eliminate this question of how well
these intrusion detection products are

69
00:03:55,829 --> 00:03:56,260
working

70
00:03:56,260 --> 00:04:00,860
so I'm just gonna walk you through a few
I think salient data points from that

71
00:04:00,860 --> 00:04:05,209
from that document we want well as too
much I see some people like oh my god

72
00:04:05,209 --> 00:04:05,900
another deter

73
00:04:05,900 --> 00:04:08,519
report I was spent too much time on it
but I think it's actually pretty

74
00:04:08,519 --> 00:04:09,239
interesting

75
00:04:09,239 --> 00:04:12,290
and I and II hope you agree in a minute
okay so what does this tell us

76
00:04:12,290 --> 00:04:16,209
seven to 10 targeted attackers are top
target to get attacks against larger

77
00:04:16,209 --> 00:04:17,900
organizations okay this is an all that

78
00:04:17,900 --> 00:04:22,090
like surprising right um but but want
two things I do want to talk about

79
00:04:22,090 --> 00:04:25,890
is intrusion detection in light of the
so-called targeted attacks the so-called

80
00:04:25,890 --> 00:04:29,470
a BTU tax or something like that right I
will these products doing against these

81
00:04:29,470 --> 00:04:32,820
these these targeted attacks that are
happening to become pennies

82
00:04:32,820 --> 00:04:36,030
and so um

83
00:04:36,030 --> 00:04:39,590
the current state of affairs is that
half of intrusions took months or years

84
00:04:39,590 --> 00:04:41,990
to discover that they happened at all

85
00:04:41,990 --> 00:04:45,760
13 years to discover they occurred a

86
00:04:45,760 --> 00:04:49,320
thats seems kinda flake not very good

87
00:04:49,320 --> 00:04:54,250
a okay I seventy-one percent of the time
in the attack surveyed

88
00:04:54,250 --> 00:04:58,390
I the attacker attacks took place in
minutes or less

89
00:04:58,390 --> 00:05:01,520
total time:

90
00:05:01,520 --> 00:05:04,940
about from from to come from Isaac
company

91
00:05:04,940 --> 00:05:08,680
um now over to step back a minute for
those that don't know about the raid

92
00:05:08,680 --> 00:05:11,840
present data breach report it's a it
encompasses actually

93
00:05:11,840 --> 00:05:15,220
almost all the the case studies that our
public

94
00:05:15,220 --> 00:05:19,130
and a bunch of them their private from
comp places like the secret service

95
00:05:19,130 --> 00:05:22,120
and a bunch of other international law
enforcement agencies as well as

96
00:05:22,120 --> 00:05:23,490
Verizon's own

97
00:05:23,490 --> 00:05:27,120
in some response group so everybody 155
cases a factual

98
00:05:27,120 --> 00:05:30,460
a intrusions an actual breaches that
have occurred

99
00:05:30,460 --> 00:05:33,770
so this isn't just a made up numbers
this is actually based on a

100
00:05:33,770 --> 00:05:37,410
actually fairly what the the single
largest study up data breaches that's

101
00:05:37,410 --> 00:05:38,090
ever been done

102
00:05:38,090 --> 00:05:41,250
is this report so anyway okay

103
00:05:41,250 --> 00:05:45,210
so those are kinda bad intrusion
detection systems maybe aren't working

104
00:05:45,210 --> 00:05:46,220
out well

105
00:05:46,220 --> 00:05:49,680
but let's put the nail in the coffin um

106
00:05:49,680 --> 00:05:52,980
so how these things discovered and these
companies in the first place

107
00:05:52,980 --> 00:05:57,500
right when they actually take you months
and years to discover our the discovered

108
00:05:57,500 --> 00:06:02,350
well after them are actually notified by
a third party and not discovered by the

109
00:06:02,350 --> 00:06:03,620
company and/or

110
00:06:03,620 --> 00:06:07,120
right the FBI comes and tells you
something happened or someone forced an

111
00:06:07,120 --> 00:06:08,000
agency

112
00:06:08,000 --> 00:06:11,290
or some other company tells you
something happened I

113
00:06:11,290 --> 00:06:16,260
so that's like half or more than half
the cases

114
00:06:16,260 --> 00:06:19,560
okay what about the rest well a third of
the cases

115
00:06:19,560 --> 00:06:22,670
are from somebody noticing hey something
is weird

116
00:06:22,670 --> 00:06:25,360
a system administrator noticing a
processes running on a system that

117
00:06:25,360 --> 00:06:26,050
should be

118
00:06:26,050 --> 00:06:29,680
a somebody thats non-security just you
know

119
00:06:29,680 --> 00:06:32,990
hamster no to something and notifies the
security team

120
00:06:32,990 --> 00:06:36,600
so were actually up to a fairly sizable
percentage of the day above the case

121
00:06:36,600 --> 00:06:37,570
studies

122
00:06:37,570 --> 00:06:40,930
and we haven't even gotten to the
Internet detection system yet

123
00:06:40,930 --> 00:06:44,770
right okay so that they call these
intrusion detection systems fraud

124
00:06:44,770 --> 00:06:46,690
detection systems in that report

125
00:06:46,690 --> 00:06:50,240
5 percent above the time up disk
particular study

126
00:06:50,240 --> 00:06:53,720
again the largest study ever done five
for some the time

127
00:06:53,720 --> 00:06:57,900
these intrusions are are discovered by
an intrusion detection system

128
00:06:57,900 --> 00:07:01,530
a you know the stack of dollar bills on
the previous slide red

129
00:07:01,530 --> 00:07:05,710
this is what it's giving you now 5
percent how bad is that really let's

130
00:07:05,710 --> 00:07:08,000
think about how that stacks up against
other things

131
00:07:08,000 --> 00:07:11,550
well it turns out routine log review

132
00:07:11,550 --> 00:07:15,580
somebody randomly going and looking at
logs is more successful at discovering

133
00:07:15,580 --> 00:07:16,880
intrusions then

134
00:07:16,880 --> 00:07:20,750
the intrusion detection systems okay

135
00:07:20,750 --> 00:07:24,420
what the hell I I these things are
working

136
00:07:24,420 --> 00:07:28,580
right okay say well you know what that's
just a single data source you know there

137
00:07:28,580 --> 00:07:32,070
by Astor whatever some sampling error
rate or whatever

138
00:07:32,070 --> 00:07:36,580
okay let's look at another so there's
another report put out by company called

139
00:07:36,580 --> 00:07:37,830
mandiant

140
00:07:37,830 --> 00:07:42,050
you guys heard a man yet before yeah
okay so they're they're like free famous

141
00:07:42,050 --> 00:07:43,180
for being

142
00:07:43,180 --> 00:07:47,180
like why the big companies that handle
arm Apte

143
00:07:47,180 --> 00:07:51,040
quote-unquote I'm using that I know
people like that term intrusions

144
00:07:51,040 --> 00:07:54,130
so-called and when a company gets
compromised by a nation-state

145
00:07:54,130 --> 00:07:57,640
actor to help them handle the response
figure out what happened in and

146
00:07:57,640 --> 00:07:58,770
remediate

147
00:07:58,770 --> 00:08:02,470
so they actually come up the report as
well they're kinda covers the same topic

148
00:08:02,470 --> 00:08:05,660
um and the report they say sixty so

149
00:08:05,660 --> 00:08:09,830
6 six-percent events intrusions are
detected by an internal process

150
00:08:09,830 --> 00:08:13,240
rate and in fact the numbers that were
detected by ensuring detection system

151
00:08:13,240 --> 00:08:14,150
worse

152
00:08:14,150 --> 00:08:17,310
right because we already know from the
previous slide an internal process can

153
00:08:17,310 --> 00:08:17,880
include

154
00:08:17,880 --> 00:08:21,500
pay something is weird and enter a
process can include random logging

155
00:08:21,500 --> 00:08:27,050
blog browsing right so

156
00:08:27,050 --> 00:08:31,480
this is a state-of-the-art this is where
we're at 20 2012 intrusion detection

157
00:08:31,480 --> 00:08:34,830
right so Lake

158
00:08:34,830 --> 00:08:38,070
we suck and we needed a better

159
00:08:38,070 --> 00:08:42,519
a yeah this is my wii has a problem
slide I

160
00:08:42,519 --> 00:08:46,170
yep it takes a minute

161
00:08:46,170 --> 00:08:49,230
it's actually fun I

162
00:08:49,230 --> 00:08:52,790
okay so some

163
00:08:52,790 --> 00:08:56,290
okay so like maybe these numbers are
wrong maybe these two different ports

164
00:08:56,290 --> 00:08:56,740
are like

165
00:08:56,740 --> 00:09:00,040
you know telling us things are the same
but they're still wrong you know

166
00:09:00,040 --> 00:09:03,519
look I know you guys all the security
are a lot of you guys

167
00:09:03,519 --> 00:09:07,500
arm you you know these numbers are wrong
if you've been doing this for a while

168
00:09:07,500 --> 00:09:08,300
right

169
00:09:08,300 --> 00:09:12,970
so I'm you know there's an Intuit
intuition aspect to this as well and I

170
00:09:12,970 --> 00:09:15,240
see about you guys nodding

171
00:09:15,240 --> 00:09:18,389
so I think the question is um if

172
00:09:18,389 --> 00:09:21,420
if if buying a bunch of boxes and
throwing them out there

173
00:09:21,420 --> 00:09:26,139
and forgive men isn't really cutting it
anymore area arguably if it ever did

174
00:09:26,139 --> 00:09:29,279
or with what can we do and how can we
how can we approach this problem in

175
00:09:29,279 --> 00:09:32,850
and try to try to do something smart so
that's what we're gonna start talking

176
00:09:32,850 --> 00:09:35,019
about now

177
00:09:35,019 --> 00:09:38,819
and that's that we get into our second
actor the story

178
00:09:38,819 --> 00:09:43,230
okay so first of all is to find what the
problem is

179
00:09:43,230 --> 00:09:46,259
art and science a defining actionable
deviations between normal behavior an

180
00:09:46,259 --> 00:09:48,699
attacker behavior is one definition I
came up with for

181
00:09:48,699 --> 00:09:52,019
what you're trying to do when you're
doing intrusion detection

182
00:09:52,019 --> 00:09:55,069
I'm this is kinda complicated so

183
00:09:55,069 --> 00:09:59,470
you know maybe this is a better way to
think about it

184
00:09:59,470 --> 00:10:03,939
rate you're trying to get lucky by
detecting somebody doing something dumb

185
00:10:03,939 --> 00:10:07,480
so how with the freemen trust to think
about this problem

186
00:10:07,480 --> 00:10:12,209
how do we actually Tom who actually
process

187
00:10:12,209 --> 00:10:15,519
alright so here's the first thing this
is a

188
00:10:15,519 --> 00:10:19,499
this is the this is the rookie mistake
the people make with intrusion detection

189
00:10:19,499 --> 00:10:23,689
and ninety-nine percent the world at
large people are doing transaction

190
00:10:23,689 --> 00:10:27,089
art are doing are making this mistake so

191
00:10:27,089 --> 00:10:30,499
the this is that this is example
somebody want to do a true texan

192
00:10:30,499 --> 00:10:33,999
they by Amish appliance or or they buy a
smart sensor

193
00:10:33,999 --> 00:10:37,939
right they put it into the network they
turn on Ubuntu signatures

194
00:10:37,939 --> 00:10:42,060
and then they say holy shit there's a
lot of alerts

195
00:10:42,060 --> 00:10:46,579
what I do and so they go and return of
everything that's making alert

196
00:10:46,579 --> 00:10:50,180
right and they're like okay sweet now
it's working

197
00:10:50,180 --> 00:10:53,699
right if I I mean that you know

198
00:10:53,699 --> 00:10:58,389
you know I'm you know I'm right here and
so like was a problem at this rate

199
00:10:58,389 --> 00:11:01,639
I people love the idea

200
00:11:01,639 --> 00:11:04,689
an intrusion detection system that's
going to

201
00:11:04,689 --> 00:11:08,480
always tell them the truth and never lie
to them

202
00:11:08,480 --> 00:11:13,589
and this is something we call the
false-positive fallacy

203
00:11:13,589 --> 00:11:17,170
of right it's a it's a

204
00:11:17,170 --> 00:11:20,699
it's this idea that that you know

205
00:11:20,699 --> 00:11:23,959
its I'm gonna build a perfect intrusion
detection system that's always going to

206
00:11:23,959 --> 00:11:25,089
tell me the right answer

207
00:11:25,089 --> 00:11:28,160
and it's never gonna tell me something
wrong and that's my goal

208
00:11:28,160 --> 00:11:31,310
right and if I ever get some noise or if
I ever get some spurious alerts or

209
00:11:31,310 --> 00:11:32,029
something then

210
00:11:32,029 --> 00:11:35,379
the whole systems a failure and I'm just
gonna turn often ignore

211
00:11:35,379 --> 00:11:39,029
and I think this is one the fundamental
problems with the field

212
00:11:39,029 --> 00:11:42,560
is that people don't understand that
this is the wrong approach

213
00:11:42,560 --> 00:11:45,899
so this is this is the picture of
somebody

214
00:11:45,899 --> 00:11:48,879
the idea here is that people wanna wanna
have something that wakes them up in the

215
00:11:48,879 --> 00:11:49,740
middle the night

216
00:11:49,740 --> 00:11:53,189
only if it's something that's really bad
and they don't know how to handle this

217
00:11:53,189 --> 00:11:54,529
stuff that's in the middle

218
00:11:54,529 --> 00:11:57,529
right how like it's very easy to
instrument something that every time

219
00:11:57,529 --> 00:11:58,810
this triggers I'm gonna go

220
00:11:58,810 --> 00:12:02,600
alerted I'm gonna get the fire truck and
I'm gonna drive in you know say the day

221
00:12:02,600 --> 00:12:08,600
right but the a the reality is is
unfortunately more subtle than that

222
00:12:08,600 --> 00:12:11,680
so this is something very important to
this discussion

223
00:12:11,680 --> 00:12:15,360
which is called the event pipeline and
this is the process by which

224
00:12:15,360 --> 00:12:18,430
you take a us a an event or a signal

225
00:12:18,430 --> 00:12:21,790
are some signs of suspicious activity
and you use or to put it through the

226
00:12:21,790 --> 00:12:22,509
series OHV

227
00:12:22,509 --> 00:12:26,240
a process he's and out the other income
something useful

228
00:12:26,240 --> 00:12:30,360
and so I'm gonna talk to you about how
you go about that

229
00:12:30,360 --> 00:12:35,370
so the first stage is dealing with noisy
events learning to love noisy events

230
00:12:35,370 --> 00:12:38,649
and that's what we're going to talk
about now so we talked about the example

231
00:12:38,649 --> 00:12:39,129
of the

232
00:12:39,129 --> 00:12:42,339
other thing that wakes you up in the
middle of the night right well

233
00:12:42,339 --> 00:12:46,120
let's talk a little bit more in in
subtle terms about things that

234
00:12:46,120 --> 00:12:49,939
are in the middle so

235
00:12:49,939 --> 00:12:52,959
this is an example I'm gonna show you
some examples from one to 10 I wanna

236
00:12:52,959 --> 00:12:54,800
spend too much time on this but

237
00:12:54,800 --> 00:12:57,819
let's see let's say you have a taxonomy
where you have up

238
00:12:57,819 --> 00:13:01,160
you know one is I want to be woken up in
the middle the night

239
00:13:01,160 --> 00:13:04,829
and 10 is like and everyone to look at
ever right and I want to show you that

240
00:13:04,829 --> 00:13:06,870
there's actually a bunch of stuff

241
00:13:06,870 --> 00:13:09,949
that is in the middle so maybe maybe you
find

242
00:13:09,949 --> 00:13:12,639
you know you've been talking to some
peers and you find hey you know we

243
00:13:12,639 --> 00:13:15,809
reverse this malware we found this now
we're going to this really weird domain

244
00:13:15,809 --> 00:13:16,279
name

245
00:13:16,279 --> 00:13:19,430
and no one's ever gonna go to the domain
name ever but if it so if you look for

246
00:13:19,430 --> 00:13:20,529
that domain name

247
00:13:20,529 --> 00:13:23,999
that's always bad right you get lucky
that's that that's actually for you

248
00:13:23,999 --> 00:13:27,459
pretty good signal okay what about a

249
00:13:27,459 --> 00:13:31,389
a PDF it's got some our innate and and
it do you want to be woken up every time

250
00:13:31,389 --> 00:13:33,360
you have PDF for them our

251
00:13:33,360 --> 00:13:37,980
mmm depends on our depends on the PDF
depends on the user a

252
00:13:37,980 --> 00:13:41,029
so now we start getting grayer and
grayer and grayer rate

253
00:13:41,029 --> 00:13:44,199
different log log into your locations
for same user

254
00:13:44,199 --> 00:13:47,439
right i mean there's ways you can make
this useful maybe they're traveling

255
00:13:47,439 --> 00:13:50,499
may be there you know in a in another
office or or

256
00:13:50,499 --> 00:13:53,490
you know so maybe it's a false positive
like you don't know at the point is I'm

257
00:13:53,490 --> 00:13:54,499
trying to say is like

258
00:13:54,499 --> 00:13:58,050
this is from highest confidence to lost
confidence and number the point on my

259
00:13:58,050 --> 00:14:01,730
my talk is going to be like how do you
use these other things

260
00:14:01,730 --> 00:14:04,600
rate I think what a lot of people do is
they just create an intrusion detection

261
00:14:04,600 --> 00:14:06,069
system and haven't email them

262
00:14:06,069 --> 00:14:09,699
every time something happens well if you
yourself every time

263
00:14:09,699 --> 00:14:12,839
these things on the list happen you
gonna stop paying attention pretty soon

264
00:14:12,839 --> 00:14:13,879
it pretty quickly

265
00:14:13,879 --> 00:14:18,559
right okay so anyway I want well as too
long but not for Best alerts for known

266
00:14:18,559 --> 00:14:21,009
that IP addresses so you get some eye
peas from somebody

267
00:14:21,009 --> 00:14:23,529
but if you've done this before you know
there's some reasons why this can create

268
00:14:23,529 --> 00:14:24,680
some noise

269
00:14:24,680 --> 00:14:28,749
unspecific registry modification so I
could say you're watching a machines

270
00:14:28,749 --> 00:14:32,350
and San you know you know that the run
once key is like an interesting place

271
00:14:32,350 --> 00:14:34,600
where people try to establish
persistence rate

272
00:14:34,600 --> 00:14:38,309
but you obviously don't wanna get a an
email every time a registry key changes

273
00:14:38,309 --> 00:14:39,860
rate that's not gonna work out

274
00:14:39,860 --> 00:14:42,869
so another example any worse alerts

275
00:14:42,869 --> 00:14:46,350
over the years this this keeps going
down the list this used to be up there

276
00:14:46,350 --> 00:14:49,899
now now these are you know kinda down
the list

277
00:14:49,899 --> 00:14:54,110
because they're not all that useful arm
this is an example use rather talk

278
00:14:54,110 --> 00:14:57,980
a snort event for a blink use region
already does not use region sorry hope

279
00:14:57,980 --> 00:15:00,990
maybe a blank use regions interesting
maybe it's not we'll talk about use

280
00:15:00,990 --> 00:15:01,850
regions

281
00:15:01,850 --> 00:15:06,199
um a successful RTP login again not
something you want to email the middle

282
00:15:06,199 --> 00:15:07,430
tonight but it has some poor

283
00:15:07,430 --> 00:15:10,569
part to play in the intrusion detection
story

284
00:15:10,569 --> 00:15:13,839
right I okay

285
00:15:13,839 --> 00:15:16,579
a snot event that you write that that
gives you an alert every time there's a

286
00:15:16,579 --> 00:15:17,610
trip to traffic

287
00:15:17,610 --> 00:15:22,430
so again we're going down the list
noisier noisier noisier noisier

288
00:15:22,430 --> 00:15:26,279
and in the final point is raw data
obviously you don't get woken up in the

289
00:15:26,279 --> 00:15:27,709
middle night because you got a log

290
00:15:27,709 --> 00:15:31,089
you gotta love you rate doesn't make any
sense

291
00:15:31,089 --> 00:15:34,079
but again they're important for the
story so how are the important part a

292
00:15:34,079 --> 00:15:36,040
story or thought about

293
00:15:36,040 --> 00:15:39,660
okay so let's say we went through we
instrumented those but those ten things

294
00:15:39,660 --> 00:15:41,389
we have an alert for every single one of
them

295
00:15:41,389 --> 00:15:44,550
right and we want to do something useful
with these events so

296
00:15:44,550 --> 00:15:47,709
how we gonna do something useful with
them well it's a good example

297
00:15:47,709 --> 00:15:51,089
let's take an example love the other
blank user-agent: one

298
00:15:51,089 --> 00:15:54,230
arm where is it ray here her

299
00:15:54,230 --> 00:15:57,689
yes seven thank you so let's take an
example number seven

300
00:15:57,689 --> 00:16:01,300
alright sorry to disappoint user-agent:
yeah from not something you wanna be

301
00:16:01,300 --> 00:16:02,209
walking about

302
00:16:02,209 --> 00:16:05,949
but there is a way to make those useful
so blacklisting

303
00:16:05,949 --> 00:16:09,149
see you create an event right and you
send it somewhere

304
00:16:09,149 --> 00:16:12,160
they consume those events and then you
wanna go through a process on that

305
00:16:12,160 --> 00:16:14,920
particular event called blacklisting

306
00:16:14,920 --> 00:16:18,379
the blacklisting is a process whereby
you tryin so so the whole goal we're

307
00:16:18,379 --> 00:16:19,110
trying to take

308
00:16:19,110 --> 00:16:22,319
is take those events from as we go
through the list

309
00:16:22,319 --> 00:16:25,449
we're going to take those noisy events
and push them up to big as least noise

310
00:16:25,449 --> 00:16:26,929
as possible

311
00:16:26,929 --> 00:16:30,480
right so that's the first aid for trying
to do so if we can get the number seven

312
00:16:30,480 --> 00:16:31,490
to be a number four

313
00:16:31,490 --> 00:16:34,699
number three like that's actually
awesome and then we get down a

314
00:16:34,699 --> 00:16:35,490
correlation

315
00:16:35,490 --> 00:16:37,970
well actually figure out how to combine
those number three's together into

316
00:16:37,970 --> 00:16:39,509
something worthwhile

317
00:16:39,509 --> 00:16:44,110
so how do we get the 7203 so the first
ever that is called blacklisting

318
00:16:44,110 --> 00:16:47,439
red so blacklisting is about

319
00:16:47,439 --> 00:16:50,509
taking in a vent and call

320
00:16:50,509 --> 00:16:54,050
taking out the the known false positives
red

321
00:16:54,050 --> 00:16:57,309
3 I'm walking out of the zone I

322
00:16:57,309 --> 00:17:01,139
um it's about taking event and removing
the non false positives so we give an

323
00:17:01,139 --> 00:17:01,850
example

324
00:17:01,850 --> 00:17:06,780
have anybody ever brightness not event
for a bike use region before

325
00:17:06,780 --> 00:17:09,850
Yes No well I have cuz I'm lame

326
00:17:09,850 --> 00:17:14,360
and everyone and this was years ago when
user agents are still interesting

327
00:17:14,360 --> 00:17:18,030
and I'm and I

328
00:17:18,030 --> 00:17:21,110
you guys ever heard a Fitbit before that
thing you like walk around with them I

329
00:17:21,110 --> 00:17:22,890
told him he steps

330
00:17:22,890 --> 00:17:27,190
that sound familiar so it turns out
Fitbit like the people that wrote Fitbit

331
00:17:27,190 --> 00:17:30,770
it calls back to some cloud service in
like records your steps or something

332
00:17:30,770 --> 00:17:34,150
and like they don't know how to program
very well so they they actually

333
00:17:34,150 --> 00:17:37,240
for got to including user-agent: and so

334
00:17:37,240 --> 00:17:39,900
10 things you notice as soon as you turn
a signature and if you have any users

335
00:17:39,900 --> 00:17:41,080
that use fits

336
00:17:41,080 --> 00:17:44,020
and also you got a bunch of alerts and
you look at the domain name or the

337
00:17:44,020 --> 00:17:44,990
destination IP

338
00:17:44,990 --> 00:17:48,000
and it turns out it's like some fit that
thing and I okay well that's probably

339
00:17:48,000 --> 00:17:49,560
not a PT year something like

340
00:17:49,560 --> 00:17:52,840
you know it's probably okay so you start
peeling back the layers

341
00:17:52,840 --> 00:17:56,130
to try to wait list those things so

342
00:17:56,130 --> 00:18:00,170
and I admit knows people can be tricky
and hide my I get that

343
00:18:00,170 --> 00:18:03,140
you have to make the call when you're
doing the blacklisting yourself so it

344
00:18:03,140 --> 00:18:04,290
the point is

345
00:18:04,290 --> 00:18:07,080
every single event type whether it's a
no would be Savannah host this event the

346
00:18:07,080 --> 00:18:08,500
user event whatever

347
00:18:08,500 --> 00:18:12,500
you you go through a process whereby you
you you you drop the ones on the floor

348
00:18:12,500 --> 00:18:15,450
that you know are just not worth looking
at

349
00:18:15,450 --> 00:18:18,230
now that's different than the model with
the the smart sensor we talked about

350
00:18:18,230 --> 00:18:21,000
earlier it we just plug in and turn off
everything

351
00:18:21,000 --> 00:18:24,250
we're not turning off the thing we're
just took turning off the ones that we

352
00:18:24,250 --> 00:18:25,350
know about it

353
00:18:25,350 --> 00:18:28,210
and we're loading everything else
through are being fairly permissive here

354
00:18:28,210 --> 00:18:28,670
red

355
00:18:28,670 --> 00:18:30,980
where is going to take the most
egregious cases in turn them off because

356
00:18:30,980 --> 00:18:32,200
this is just one stage in

357
00:18:32,200 --> 00:18:35,580
any event pipeline you guys do with your
this making sense

358
00:18:35,580 --> 00:18:39,720
okay like the look like the fall asleep
but it I think it's like the weird mood

359
00:18:39,720 --> 00:18:41,050
lighting going on so

360
00:18:41,050 --> 00:18:44,730
it's kinda hard to tell so the next step
after you do the blacklisting

361
00:18:44,730 --> 00:18:47,970
so that means you you take off although
although other creatures false positives

362
00:18:47,970 --> 00:18:51,520
the next episode a colleague identity
translation so

363
00:18:51,520 --> 00:18:54,830
this is my Superman changing his
identity um

364
00:18:54,830 --> 00:18:58,460
the point is that a wanna think this
really hard about intrusion detection in

365
00:18:58,460 --> 00:18:59,510
a modern enterprise

366
00:18:59,510 --> 00:19:02,660
is that a lot of the events come in and
they're like

367
00:19:02,660 --> 00:19:06,600
apples and oranges right so you get an
event from a network sensor

368
00:19:06,600 --> 00:19:09,630
like a smart sensor something and has a
at source IP

369
00:19:09,630 --> 00:19:12,880
rate and you get you get similar from
some loggers something

370
00:19:12,880 --> 00:19:16,550
and it's got like a username right and
this is actually like a little

371
00:19:16,550 --> 00:19:19,990
a really hard problem and it's really
subtle but like if you want to start

372
00:19:19,990 --> 00:19:22,730
doing interesting correlations between
these different types of things that are

373
00:19:22,730 --> 00:19:23,480
alerting

374
00:19:23,480 --> 00:19:26,690
you need to be able to do some
translation layer so that you understand

375
00:19:26,690 --> 00:19:28,710
that this source IP

376
00:19:28,710 --> 00:19:32,420
a is actually something to do with this
user so that you can start comparing the

377
00:19:32,420 --> 00:19:33,810
events together

378
00:19:33,810 --> 00:19:38,000
so this is hard and I spent a lot of
time working on this problem before

379
00:19:38,000 --> 00:19:41,730
I but I its its it's necessary

380
00:19:41,730 --> 00:19:44,710
because otherwise you'll never be able
to compare offense from your

381
00:19:44,710 --> 00:19:45,740
infrastructure

382
00:19:45,740 --> 00:19:49,010
to each other up if if you don't know
that they're related

383
00:19:49,010 --> 00:19:53,060
you have to have someone to relate them
right so you know what I would recommend

384
00:19:53,060 --> 00:19:56,400
is to have some sort of system whereby
you can take these events with various

385
00:19:56,400 --> 00:19:57,040
identities

386
00:19:57,040 --> 00:20:00,400
after the time after you've done
blacklisting a to take up all the false

387
00:20:00,400 --> 00:20:01,150
positives

388
00:20:01,150 --> 00:20:04,090
and then you just think of it like
attacked like you tag and then you have

389
00:20:04,090 --> 00:20:05,420
a system that says oh yeah

390
00:20:05,420 --> 00:20:09,110
that I P at this time i've a lookup
table for that you know using DHCP or

391
00:20:09,110 --> 00:20:09,720
something

392
00:20:09,720 --> 00:20:12,850
and that was this user or you know stuff
like that

393
00:20:12,850 --> 00:20:15,270
and if you're if you're interested in
talking more about something like that

394
00:20:15,270 --> 00:20:16,040
works

395
00:20:16,040 --> 00:20:19,270
because it's it's it's a little bit
difficult um I can talk to you after the

396
00:20:19,270 --> 00:20:20,220
talk about it

397
00:20:20,220 --> 00:20:23,930
but but the point is you basically just
the lookup tables that are life

398
00:20:23,930 --> 00:20:26,250
and there's a bunch of different
commercial systems you can use for this

399
00:20:26,250 --> 00:20:27,380
problem as well

400
00:20:27,380 --> 00:20:30,810
arm but it's pretty important okay

401
00:20:30,810 --> 00:20:34,010
so we've covered blacklisting and we've
covered

402
00:20:34,010 --> 00:20:38,110
um identity translation so you think
about that pipeline

403
00:20:38,110 --> 00:20:41,780
and our little event that was really
noisy is hopefully getting a little less

404
00:20:41,780 --> 00:20:42,410
noisy

405
00:20:42,410 --> 00:20:46,040
after going through these various stages
now the next four

406
00:20:46,040 --> 00:20:50,410
other discussion is going to be I gotta
take these noisy events

407
00:20:50,410 --> 00:20:53,440
and compare them together to create a
Metavante

408
00:20:53,440 --> 00:20:56,990
that is views make sense

409
00:20:56,990 --> 00:21:02,000
yeah you guys with me okay so this is
the stage called correlation

410
00:21:02,000 --> 00:21:05,420
so wanna talk a little bit about how to
think about correlation in general

411
00:21:05,420 --> 00:21:08,920
and I'm gonna introduce the concept that
is going to be a specific type of

412
00:21:08,920 --> 00:21:10,200
correlation that you guys can

413
00:21:10,200 --> 00:21:13,970
can't can't think about doing the other
with a coalition to it and I can talk

414
00:21:13,970 --> 00:21:14,960
about those but

415
00:21:14,960 --> 00:21:18,510
let's first talk about a coalition is in
the first place

416
00:21:18,510 --> 00:21:22,560
the idea is to take a bunch low
confidence I'd events like the seven

417
00:21:22,560 --> 00:21:23,880
fours and whatever

418
00:21:23,880 --> 00:21:26,890
right and turn them into high confidence
events right

419
00:21:26,890 --> 00:21:31,110
a combined event that include some
events better more interesting

420
00:21:31,110 --> 00:21:34,840
then individual events that you would
never look at right

421
00:21:34,840 --> 00:21:39,390
that's the key so how we do that

422
00:21:39,390 --> 00:21:42,630
well let's talk about a concept called
the attack plane

423
00:21:42,630 --> 00:21:46,530
this is not an attack fine other at
night in so many things is

424
00:21:46,530 --> 00:21:50,360
um actually what I mean by an attack
plan something else

425
00:21:50,360 --> 00:21:54,150
so what um because of a plane

426
00:21:54,150 --> 00:21:57,710
is in in this case it I mean like a a
two dimensional space

427
00:21:57,710 --> 00:22:00,820
right US familiar with that definition
of plain

428
00:22:00,820 --> 00:22:04,610
just think of it as a as a as a table
that you can stack things on

429
00:22:04,610 --> 00:22:08,450
like Apple's right and a.m.

430
00:22:08,450 --> 00:22:11,540
the purse the point I'm trying to make
is that the perspective you take when

431
00:22:11,540 --> 00:22:13,030
you build that desk

432
00:22:13,030 --> 00:22:16,960
the years plate placing the apples on
arm matters

433
00:22:16,960 --> 00:22:20,480
and so it's let's talk about an example
here's a very simple case

434
00:22:20,480 --> 00:22:23,830
so in this case this is my attack plane
this line here

435
00:22:23,830 --> 00:22:27,650
right and these are these things with
Apple's these are individual events

436
00:22:27,650 --> 00:22:29,230
these are noisy events

437
00:22:29,230 --> 00:22:33,280
that i won a combined together so this
is the trivial case

438
00:22:33,280 --> 00:22:37,890
over wave gripping events that a that
you can do at home kids

439
00:22:37,890 --> 00:22:41,500
I that you can do yourself um

440
00:22:41,500 --> 00:22:45,340
and this is the way of grouping them
it's by IP address

441
00:22:45,340 --> 00:22:48,660
rate seems pretty natural pretty obvious
pretty trivial

442
00:22:48,660 --> 00:22:51,980
rate if there's like four events from a
same IP

443
00:22:51,980 --> 00:22:55,500
over a certain time window maybe that's
more interesting than one event

444
00:22:55,500 --> 00:22:58,560
but I would never look at right for this
is the trivial case

445
00:22:58,560 --> 00:23:01,760
a correlation and in this case the
attack plane

446
00:23:01,760 --> 00:23:06,230
is the IP address based attack plane the
it desk I'm stuck in these things on is

447
00:23:06,230 --> 00:23:07,970
an IP address desk

448
00:23:07,970 --> 00:23:11,880
so let's see what that looks like it
looks like okay 1.2 the three or four

449
00:23:11,880 --> 00:23:16,050
has four offenses over here for to 3.2
that one is over here

450
00:23:16,050 --> 00:23:19,890
and it's got four events break and
depending on the nature of these bubbles

451
00:23:19,890 --> 00:23:24,670
these vents this whole box maybe
something worth looking at

452
00:23:24,670 --> 00:23:27,830
right maybe

453
00:23:27,830 --> 00:23:31,850
now this is a simple case of up grouping

454
00:23:31,850 --> 00:23:35,810
and this is for the state of the art of
correlation as it stands today

455
00:23:35,810 --> 00:23:39,500
but are there different ways of doing
grouping that could perhaps tell you

456
00:23:39,500 --> 00:23:40,790
something more interesting

457
00:23:40,790 --> 00:23:43,980
then simply stacking things by IP
address

458
00:23:43,980 --> 00:23:48,660
and turns out the answer is yes but we
have to take a minor digression

459
00:23:48,660 --> 00:23:51,930
before we get there so please forgive me
for a moment but this is gonna be really

460
00:23:51,930 --> 00:23:53,510
interesting

461
00:23:53,510 --> 00:23:56,770
the killed three those scary

462
00:23:56,770 --> 00:24:01,030
so the kill chain whose articulating

463
00:24:01,030 --> 00:24:05,550
and very awesome is actually a really
important idea in security

464
00:24:05,550 --> 00:24:08,610
I think and I'll it's got a new one

465
00:24:08,610 --> 00:24:12,340
and I think you'll find it interesting
so the idea to kill chain

466
00:24:12,340 --> 00:24:16,320
was started by the US military

467
00:24:16,320 --> 00:24:20,890
and it's a theoretical concept that
breaks what an attack a physical attack

468
00:24:20,890 --> 00:24:24,870
rate like a terrorist attack or a
whatever it breaks those attacks

469
00:24:24,870 --> 00:24:29,420
into a series of stages and it says

470
00:24:29,420 --> 00:24:33,940
an attacker who's gonna attack me has to
go through the stages

471
00:24:33,940 --> 00:24:37,050
no matter what they have to buy a weapon

472
00:24:37,050 --> 00:24:40,260
they have to reload the weapon they have
to like figure out where I'm at

473
00:24:40,260 --> 00:24:43,370
right have to come to me you know I
whatever the states are there's a bunch

474
00:24:43,370 --> 00:24:44,820
of papers on a kill chain

475
00:24:44,820 --> 00:24:48,550
in the military context and in a
military context they use this concept

476
00:24:48,550 --> 00:24:52,360
to figure out how they can do two things
brick the kill chain

477
00:24:52,360 --> 00:24:56,190
when the case have an attacker right so
how can I say they say

478
00:24:56,190 --> 00:24:59,740
you know a detector has to necessarily
go through the stages we're in that

479
00:24:59,740 --> 00:25:00,900
could we actually

480
00:25:00,900 --> 00:25:04,990
a mess them up right and it's actually
pretty useful for that

481
00:25:04,990 --> 00:25:09,120
but it's also useful on the other side
when are trying to kill people

482
00:25:09,120 --> 00:25:12,660
a for trying to figure out the how to
accelerate

483
00:25:12,660 --> 00:25:16,060
coaching so one of the things in the
coaching is like you know I wanna I have

484
00:25:16,060 --> 00:25:16,610
my

485
00:25:16,610 --> 00:25:20,950
my site on the target I you know I got a
college cue and confirm not my orders

486
00:25:20,950 --> 00:25:24,860
rate and you know its cues like well you
know get back to them

487
00:25:24,860 --> 00:25:30,110
so on the problems is like delays in
communication slows down the kill chain

488
00:25:30,110 --> 00:25:33,650
I'm not advocating killing anybody or
anything like that by the way has a

489
00:25:33,650 --> 00:25:36,770
don't get the wrong idea I just think
it's a cool idea from from

490
00:25:36,770 --> 00:25:40,280
from there that we can borrow for
information security context so

491
00:25:40,280 --> 00:25:43,530
Tom anyway so that's the deal so

492
00:25:43,530 --> 00:25:46,880
does that make sense so these two guys
or three guys

493
00:25:46,880 --> 00:25:50,430
at Lockheed Martin actually figured out
how to borrow this concept and bring in

494
00:25:50,430 --> 00:25:52,370
the information security to me

495
00:25:52,370 --> 00:25:55,830
as a copy for you to read it um

496
00:25:55,830 --> 00:25:59,580
but what they've done is a basically go
through with it intrusion attack looks

497
00:25:59,580 --> 00:26:01,390
like from a coaching standpoint

498
00:26:01,390 --> 00:26:04,770
and figure out using that how we can arm

499
00:26:04,770 --> 00:26:09,680
we can stop it how we can prevent so on
so here's my version of their papers

500
00:26:09,680 --> 00:26:11,080
skilled same

501
00:26:11,080 --> 00:26:13,930
I made this up but they're the pier is a
slightly different one this is my

502
00:26:13,930 --> 00:26:14,780
version

503
00:26:14,780 --> 00:26:18,960
I'll a because a I made a little
different optimize for intrusion

504
00:26:18,960 --> 00:26:21,890
detection

505
00:26:21,890 --> 00:26:25,240
so here's one attacker might do

506
00:26:25,240 --> 00:26:28,650
they might do some rekon break try to
figure out what your network is

507
00:26:28,650 --> 00:26:31,790
where your keys are with domain names
you have flick you know do some google

508
00:26:31,790 --> 00:26:32,440
searching

509
00:26:32,440 --> 00:26:36,010
most the stuff is passive they also
might set up um

510
00:26:36,010 --> 00:26:39,350
there see two notes right they might
register the domain names

511
00:26:39,350 --> 00:26:42,480
writes a some familiar over arm

512
00:26:42,480 --> 00:26:45,980
delivery how does delivery normally
happen these days above

513
00:26:45,980 --> 00:26:49,200
exploit spearfishing

514
00:26:49,200 --> 00:26:53,170
SMTP read email spree comment there's
others other vectors rate

515
00:26:53,170 --> 00:26:57,020
that some of common right now yes a
delivery so that's a good

516
00:26:57,020 --> 00:27:00,470
important particle chain right like you
know something as the

517
00:27:00,470 --> 00:27:05,590
go across male a exploitation right
though cut computers compromise

518
00:27:05,590 --> 00:27:08,480
the machine you know usually has a
downloader something in the in the in

519
00:27:08,480 --> 00:27:09,610
the payload

520
00:27:09,610 --> 00:27:12,980
download something answers coming back
to see two I mean obviously there's some

521
00:27:12,980 --> 00:27:15,710
differences in how people go about these
things but this is i think is pretty

522
00:27:15,710 --> 00:27:16,560
good

523
00:27:16,560 --> 00:27:19,900
I'll somebody could takes that takes
over the sea to becomes active

524
00:27:19,900 --> 00:27:23,080
then actively manually compromises that
the a

525
00:27:23,080 --> 00:27:26,180
the machine rate this is the part where
um

526
00:27:26,180 --> 00:27:29,250
they're like dumping hashes right doing
a

527
00:27:29,250 --> 00:27:32,770
a password cracking maybe if any to or

528
00:27:32,770 --> 00:27:36,110
you know doing some other a machine
analysis

529
00:27:36,110 --> 00:27:39,220
and there's internal rekon with a look
around your network try to figure out

530
00:27:39,220 --> 00:27:40,560
what kinda stuff going on

531
00:27:40,560 --> 00:27:44,140
this is where they look at your wiki and
see that the wiki page it says

532
00:27:44,140 --> 00:27:47,290
here's all our admins that have access
to the awesome stuff

533
00:27:47,290 --> 00:27:50,720
and you know here's the passwords so

534
00:27:50,720 --> 00:27:54,560
I that support with that happens I'll
ever movements the login to differ

535
00:27:54,560 --> 00:27:55,120
machines

536
00:27:55,120 --> 00:27:58,240
sorry I'm kinda many going to slow here
but

537
00:27:58,240 --> 00:28:01,260
persist in setting up a way to connect
back in an hour and in staging

538
00:28:01,260 --> 00:28:02,680
exultation

539
00:28:02,680 --> 00:28:06,240
so the state is in these concepts
familiar at least right yeah

540
00:28:06,240 --> 00:28:10,280
so the skill chain the notion that these
things are linked and and and

541
00:28:10,280 --> 00:28:13,280
by and large are necessarily done by an
attacker

542
00:28:13,280 --> 00:28:16,460
is actually an interesting concept for
us right so let's go back to where we

543
00:28:16,460 --> 00:28:17,880
were a minute ago

544
00:28:17,880 --> 00:28:21,260
we're talking about attack points right
and we had this trio case have an IP

545
00:28:21,260 --> 00:28:24,060
address and we're stacking these events
on this table

546
00:28:24,060 --> 00:28:28,170
well what if we had a more a
sophisticated idea

547
00:28:28,170 --> 00:28:31,370
what if we use the kilt same but I just
mentioned that these attackers

548
00:28:31,370 --> 00:28:33,330
necessarily have to go through

549
00:28:33,330 --> 00:28:36,520
what if we use that as the basis for a
correlation

550
00:28:36,520 --> 00:28:40,400
Rep again this is just one idea for
Hadoop more advanced has a coalition you

551
00:28:40,400 --> 00:28:40,970
probably have

552
00:28:40,970 --> 00:28:45,420
other ones but this one's interesting so
what say you have a command control

553
00:28:45,420 --> 00:28:48,870
a its event right maybe it's a low
quality event

554
00:28:48,870 --> 00:28:52,310
but maybe it's a you know a some sort of

555
00:28:52,310 --> 00:28:55,690
maybe it's the the dime que serve the
blank user agent or something

556
00:28:55,690 --> 00:28:59,810
when event comes in maybe it's a seven
out of 10 but you have a label on that

557
00:28:59,810 --> 00:29:03,120
and at the and when the event creates
gets created it's labeled with the kill

558
00:29:03,120 --> 00:29:05,540
chain stays that it belongs to you

559
00:29:05,540 --> 00:29:09,200
okay um exfiltration

560
00:29:09,200 --> 00:29:12,370
rate maybe have something for arm

561
00:29:12,370 --> 00:29:15,600
exultation adjusting for internal rekon
rate info

562
00:29:15,600 --> 00:29:18,650
if you have something if is somebody who
looks at too many wiki pages in two

563
00:29:18,650 --> 00:29:20,650
short amount of time maybe that's an
event

564
00:29:20,650 --> 00:29:23,650
again on the van I want to get woken up
in the middle of the night but an event

565
00:29:23,650 --> 00:29:24,710
you can label

566
00:29:24,710 --> 00:29:28,890
with the internal rekon for the kill
chain and exultation maybe you look at

567
00:29:28,890 --> 00:29:29,570
some

568
00:29:29,570 --> 00:29:33,220
a large amounts over our files going out
with your network

569
00:29:33,220 --> 00:29:36,940
just as an example right so beforehand

570
00:29:36,940 --> 00:29:40,290
maybe the you to these things like a
colour-coded this by how quote the

571
00:29:40,290 --> 00:29:42,480
quality the signal maybe these are kinda
bad

572
00:29:42,480 --> 00:29:46,390
and this ones kinda good right but maybe
they're still below the noise threshold

573
00:29:46,390 --> 00:29:47,230
that your

574
00:29:47,230 --> 00:29:50,990
a response people can handle but now
you've been able to

575
00:29:50,990 --> 00:29:54,240
since you did identity translation these
network-based events

576
00:29:54,240 --> 00:29:58,390
you know they were user Bob right there
may be other users that could have been

577
00:29:58,390 --> 00:30:01,210
tied to we can talk about that after the
after talk to you want to but

578
00:30:01,210 --> 00:30:05,010
was just say for simplicity that's that
you know that's user Bob

579
00:30:05,010 --> 00:30:08,050
you know that this was his are Bob and
you know this was your about

580
00:30:08,050 --> 00:30:11,880
now all the sudden because the fact that
those are tag with cocaine stage

581
00:30:11,880 --> 00:30:15,380
you now have a much more interesting
correlation than just a bag of things

582
00:30:15,380 --> 00:30:18,670
that an IP address did

583
00:30:18,670 --> 00:30:22,820
so anyway that's just one idea I've had
to do correlation

584
00:30:22,820 --> 00:30:26,710
but there's a bunch okay so recapping on
that part

585
00:30:26,710 --> 00:30:30,020
noisy events are an important part of
the story

586
00:30:30,020 --> 00:30:33,790
right if you're not figuring out a way
to use noisy low quality events

587
00:30:33,790 --> 00:30:37,110
intrusion detections that system you're
doing it wrong

588
00:30:37,110 --> 00:30:40,390
right because you're never gonna be able
to come up with the perfect alert was

589
00:30:40,390 --> 00:30:41,610
gonna wake up in the middle the night

590
00:30:41,610 --> 00:30:45,130
and tell you everything bad is happening
doesn't that's not how it works

591
00:30:45,130 --> 00:30:48,170
right so you need to

592
00:30:48,170 --> 00:30:51,280
you need to really figure out a plan for
how to deal with these noisy events

593
00:30:51,280 --> 00:30:55,400
you you reduce the noise as best you can
to prevent basis by blacklisting

594
00:30:55,400 --> 00:30:58,500
and then you figure out some smart ways
a correlation

595
00:30:58,500 --> 00:31:01,870
okay but we're not done we're not done

596
00:31:01,870 --> 00:31:05,140
there's took two stages left

597
00:31:05,140 --> 00:31:09,270
so afterward of correlation we do think
all applying context

598
00:31:09,270 --> 00:31:13,940
now this is something that came out of
context

599
00:31:13,940 --> 00:31:18,130
didn't even know this is from

600
00:31:18,130 --> 00:31:21,790
yes it's on Star Trek the old one

601
00:31:21,790 --> 00:31:25,020
and I have no idea what this episode was
about but it was really weird

602
00:31:25,020 --> 00:31:28,210
I'm up

603
00:31:28,210 --> 00:31:31,560
anyway context is is really really
important

604
00:31:31,560 --> 00:31:35,160
um because it helps you a

605
00:31:35,160 --> 00:31:38,550
speed-up analysis so what am I talking
about here the ideas like

606
00:31:38,550 --> 00:31:41,880
so you've got these events they've gone
through this pipeline they've gotten

607
00:31:41,880 --> 00:31:43,350
blacklisted they've gotten

608
00:31:43,350 --> 00:31:47,360
improved they've gotten better now yes
some things that you think a pretty good

609
00:31:47,360 --> 00:31:50,990
right at some point somebody's gonna
have to look at those with her eyeballs

610
00:31:50,990 --> 00:31:53,530
right now what you want to do is you
want to minimize the amount of time it

611
00:31:53,530 --> 00:31:56,130
takes for somebody look at those things
with your eyeballs

612
00:31:56,130 --> 00:31:59,540
right because you are these things and
you want to be able to you know

613
00:31:59,540 --> 00:32:03,510
look at as many as you can so cut taxes
such a valuable point

614
00:32:03,510 --> 00:32:06,570
and something to holy missed by most
people

615
00:32:06,570 --> 00:32:09,090
the idea is that as soon as you get to
set up a fence that you think are

616
00:32:09,090 --> 00:32:10,000
important

617
00:32:10,000 --> 00:32:13,050
then you can start pre applying
information

618
00:32:13,050 --> 00:32:16,200
about about it from your environment
that's interesting

619
00:32:16,200 --> 00:32:18,970
a lot of people think well how can I
just get all my data sources together

620
00:32:18,970 --> 00:32:20,490
and build intrusion events

621
00:32:20,490 --> 00:32:24,320
yes but how can you also use those same
sources of data

622
00:32:24,320 --> 00:32:28,280
to apply context an example what if your
system

623
00:32:28,280 --> 00:32:31,450
that was that that had a correlation and
had an interesting event

624
00:32:31,450 --> 00:32:35,850
right what if like what if you want to
see what tasks were running on the

625
00:32:35,850 --> 00:32:37,340
system on a Windows machine

626
00:32:37,340 --> 00:32:40,540
at the time in which you looking at the
event now those

627
00:32:40,540 --> 00:32:45,440
tasks the list of tasks wasn't part of
creating the event in the first place

628
00:32:45,440 --> 00:32:48,560
was actually super valuable when you're
looking at it right

629
00:32:48,560 --> 00:32:51,680
the make sense and so there's actually
put it like that right

630
00:32:51,680 --> 00:32:55,050
maybe some data from your logs maybe
some data from your a network forensics

631
00:32:55,050 --> 00:32:56,880
system right much a peek at the

632
00:32:56,880 --> 00:33:00,600
or I don't know you probably a better
ideas but the point is

633
00:33:00,600 --> 00:33:04,450
applying data before the analyst looks
at it

634
00:33:04,450 --> 00:33:07,730
a can actually make the the announces a
bit much more

635
00:33:07,730 --> 00:33:10,730
a palatable

636
00:33:10,730 --> 00:33:14,060
okay I think cover all this

637
00:33:14,060 --> 00:33:17,370
yeah so I could say you buy some fancy
schmancy better plants you can actually

638
00:33:17,370 --> 00:33:20,550
use that to provide context on events
that thing didn't even create the first

639
00:33:20,550 --> 00:33:21,560
place

640
00:33:21,560 --> 00:33:24,880
most people mister point I'm

641
00:33:24,880 --> 00:33:28,280
okay and then of course analysis so
someone to look at these things

642
00:33:28,280 --> 00:33:31,940
actually you know it's funny the time my
career but I wanted to make so it's a no

643
00:33:31,940 --> 00:33:33,440
humans ever had a look at the stuff

644
00:33:33,440 --> 00:33:36,610
and that you know there would never be a
human in the loop

645
00:33:36,610 --> 00:33:39,740
and I I give up on that after a couple
years a trying

646
00:33:39,740 --> 00:33:42,800
because I don't think that's possible so

647
00:33:42,800 --> 00:33:47,050
this is actually a real picture I think
%uh AT&T

648
00:33:47,050 --> 00:33:50,270
knock which is kind of insane

649
00:33:50,270 --> 00:33:54,370
a this is not what the Facebook a sock
looks like

650
00:33:54,370 --> 00:33:58,890
am but a it's pretty cool picture

651
00:33:58,890 --> 00:34:02,200
anyway the point is you know these
things and you know

652
00:34:02,200 --> 00:34:05,270
you want to be able to look at the
minimum up the

653
00:34:05,270 --> 00:34:08,520
the most impactful most useful offense
as possible

654
00:34:08,520 --> 00:34:13,119
with the most context free flights are
you going to do our work extra lazy

655
00:34:13,119 --> 00:34:16,829
okay this is the end so I'm

656
00:34:16,829 --> 00:34:20,599
as well as a couple things so

657
00:34:20,599 --> 00:34:23,839
one of the things that I've I'm from I
first I'm frustrated about and security

658
00:34:23,839 --> 00:34:25,419
is like you go to our conferences

659
00:34:25,419 --> 00:34:28,829
and everybody is always excited about
talking about the lease o'day

660
00:34:28,829 --> 00:34:32,309
and I mean I think that stuff's really
great and cool but I think the problem

661
00:34:32,309 --> 00:34:33,089
is

662
00:34:33,089 --> 00:34:36,289
like how many talks to go to where
somebody's talking about some cool

663
00:34:36,289 --> 00:34:40,440
def defense thing some cool way to stop
attackers rate

664
00:34:40,440 --> 00:34:44,069
like why is there nobody thinking about
that stuff I mean there's some

665
00:34:44,069 --> 00:34:47,109
don't get me wrong but like it seems
like the security community

666
00:34:47,109 --> 00:34:50,179
really focused on on attacking stuff I
think

667
00:34:50,179 --> 00:34:54,220
partially because defense is hard and I
don't know if we even really know how to

668
00:34:54,220 --> 00:34:55,240
do it right

669
00:34:55,240 --> 00:34:59,279
so um anyway that's like my thing

670
00:34:59,279 --> 00:35:02,359
I think people should spend more time on
figure out how to defense rate because

671
00:35:02,359 --> 00:35:03,859
we're in a very bad state

672
00:35:03,859 --> 00:35:06,670
and I showed him the intrusion detection
numbers earlier but that same

673
00:35:06,670 --> 00:35:08,920
presentation could be made about

674
00:35:08,920 --> 00:35:12,490
defense and in general Anna things are
pretty bad

675
00:35:12,490 --> 00:35:16,259
so anyway thanks I'll take questions

676
00:35:16,259 --> 00:35:16,940
if anybody has any

