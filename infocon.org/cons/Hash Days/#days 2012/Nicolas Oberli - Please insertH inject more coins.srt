1
00:00:05,320 --> 00:00:08,340
with all rights thanks for coming

2
00:00:08,340 --> 00:00:12,990
really appreciate it and I hope good
appreciate this also

3
00:00:12,990 --> 00:00:15,650
the store

4
00:00:15,650 --> 00:00:19,480
me as he sets my name is Nicole Tony
manic his brother

5
00:00:19,480 --> 00:00:23,029
I worker security engineer at society

6
00:00:23,029 --> 00:00:29,949
a security company and the friend spoke
to Switzerland's I do another city s

7
00:00:29,949 --> 00:00:33,699
with the 20 this sober I also love to
play

8
00:00:33,699 --> 00:00:36,949
or video games on different kind of
machines

9
00:00:36,949 --> 00:00:40,360
and I love to drink beer a nurse Abreu
them myself

10
00:00:40,360 --> 00:00:43,680
so

11
00:00:43,680 --> 00:00:48,180
how do I get there a few hours ago I is
studied building

12
00:00:48,180 --> 00:00:51,280
a or duck in machine using a desktop
computer

13
00:00:51,280 --> 00:00:54,500
and some emulators certain

14
00:00:54,500 --> 00:00:57,540
play some video games or video games
with friends et cetera

15
00:00:57,540 --> 00:01:02,520
I was thinking abouts adding the
possibility to insert goings

16
00:01:02,520 --> 00:01:05,800
to actually add new credits to to play
the game

17
00:01:05,800 --> 00:01:10,230
so I'm not that greedy but yep getting
some money from France's

18
00:01:10,230 --> 00:01:14,510
correspond so

19
00:01:14,510 --> 00:01:17,970
when we talk about cunning devices you

20
00:01:17,970 --> 00:01:21,260
if you try to to look at its

21
00:01:21,260 --> 00:01:24,450
there are lots of machines that accept
money

22
00:01:24,450 --> 00:01:28,510
bills all that return the money if you
look around

23
00:01:28,510 --> 00:01:31,790
they are vending machines for drinks for
cigarettes

24
00:01:31,790 --> 00:01:35,259
you buy train tickets also they are

25
00:01:35,259 --> 00:01:38,540
in the does he know and emotions that do
this

26
00:01:38,540 --> 00:01:42,460
ants the multiple devices but I used to
actually

27
00:01:42,460 --> 00:01:46,670
the see if your putting once this Frank
to assist fung's

28
00:01:46,670 --> 00:01:50,220
like to try to insert the euro or maybe
for sconce

29
00:01:50,220 --> 00:01:53,240
and some of these devices are

30
00:01:53,240 --> 00:01:57,100
for example going on bill acceptors this
device is

31
00:01:57,100 --> 00:02:03,030
obviously need detects

32
00:02:03,030 --> 00:02:06,440
the going inserts and dance n to the
device

33
00:02:06,440 --> 00:02:10,200
the great value and hopefully you will
have

34
00:02:10,200 --> 00:02:13,790
more credits in the machine to late to
buy cigarettes KSA

35
00:02:13,790 --> 00:02:16,850
gonna so did the full sconce and

36
00:02:16,850 --> 00:02:20,819
for some of them can detect multiple
kind of money likes

37
00:02:20,819 --> 00:02:23,920
euros doses fan sits atop

38
00:02:23,920 --> 00:02:27,560
other devices

39
00:02:27,560 --> 00:02:32,240
include going so to us they'll use to so
it's going to be different race

40
00:02:32,240 --> 00:02:36,209
for example if in the machine they are
trays for

41
00:02:36,209 --> 00:02:40,170
was once this fan so juice response this
device when

42
00:02:40,170 --> 00:02:43,380
the going to his dropped can switch

43
00:02:43,380 --> 00:02:46,620
in different ways the money so we can so
it's the money in

44
00:02:46,620 --> 00:02:50,430
different Rs to be maybe

45
00:02:50,430 --> 00:02:55,910
maybe it's easier for its to actually
get the money back for the

46
00:02:55,910 --> 00:03:00,590
under another kind of Machinists

47
00:03:00,590 --> 00:03:03,670
what is gonna kornhaber its stand up a
tree

48
00:03:03,670 --> 00:03:07,140
that's is able to give the money back to
the user so

49
00:03:07,140 --> 00:03:11,650
there's a lot of money in the tree and
once commanded to

50
00:03:11,650 --> 00:03:14,850
the hope it can give back one quite a at
a time

51
00:03:14,850 --> 00:03:18,220
this is nominee use to

52
00:03:18,220 --> 00:03:25,220
give you the the money change or
something like this: so

53
00:03:25,560 --> 00:03:29,040
in those devices DAW men even
communication protocols

54
00:03:29,040 --> 00:03:32,670
but can be used the lol so no

55
00:03:32,670 --> 00:03:36,660
and through other brokaw's called MTB
NCC talk

56
00:03:36,660 --> 00:03:39,990
those protocol on non-event a specific
so

57
00:03:39,990 --> 00:03:44,130
it's fun though does use a special kind
of one of these protocols

58
00:03:44,130 --> 00:03:47,580
and since the gun except I

59
00:03:47,580 --> 00:03:50,900
both for my projects was doing sissy
talk

60
00:03:50,900 --> 00:03:56,580
that's what we are talking about today
what is sissy talk

61
00:03:56,580 --> 00:03:59,790
assist us texts for gun-control stock

62
00:03:59,790 --> 00:04:02,990
it's a semi profit so critical simeon

63
00:04:02,990 --> 00:04:06,190
the meaning that's if you go to CC talk
about orc

64
00:04:06,190 --> 00:04:11,190
you can download some other specs some
of them are freely available

65
00:04:11,190 --> 00:04:15,280
some of the are the specs of on the
available after signing an NDA

66
00:04:15,280 --> 00:04:19,370
that's not cool but week

67
00:04:19,370 --> 00:04:23,240
could have to really implements all the
functionalities of

68
00:04:23,240 --> 00:04:30,240
the device which is before this stuff
works

69
00:04:30,250 --> 00:04:33,410
in a way that's know me there's a contra
the mainboard

70
00:04:33,410 --> 00:04:37,370
of the vending machine that sense
requests to the devices

71
00:04:37,370 --> 00:04:41,300
and the devices just respond to those
requests there's no

72
00:04:41,300 --> 00:04:44,400
TCP like connections or something

73
00:04:44,400 --> 00:04:49,190
is just a request a response that's all
it looks pretty much

74
00:04:49,190 --> 00:04:53,930
like a Sony Online so it's 9.6 give it
seconds

75
00:04:53,930 --> 00:04:58,210
but it uses detail signals so it's
between 0 and five votes

76
00:04:58,210 --> 00:05:02,130
and one thing those whites transits

77
00:05:02,130 --> 00:05:06,699
its on the UES one physical wire for
both sending and receiving so you an F

78
00:05:06,699 --> 00:05:10,700
one lawyer to send and receive data you
do it on the same

79
00:05:10,700 --> 00:05:16,860
wire this quite strange it uses
addresses

80
00:05:16,860 --> 00:05:21,000
for all the devices on the bus by
defaults address number one is the

81
00:05:21,000 --> 00:05:21,600
controller

82
00:05:21,600 --> 00:05:25,590
the mainboard number two is the default
address for con acceptor

83
00:05:25,590 --> 00:05:29,010
number three's the default for going
Cooper

84
00:05:29,010 --> 00:05:33,350
ants there is a special address that is
0 it's for a broadcast message so we can

85
00:05:33,350 --> 00:05:34,090
send

86
00:05:34,090 --> 00:05:41,090
requests that is accepted by all the
devices on the bus

87
00:05:42,030 --> 00:05:46,030
or France use the same for months this
is a four months

88
00:05:46,030 --> 00:05:51,280
of want to see top message there's
always one bite for this nation address

89
00:05:51,280 --> 00:05:56,780
one but for the debtor thanks one bus
for the source address

90
00:05:56,780 --> 00:06:01,590
one but for the header the header is due
actual command sent to the device so

91
00:06:01,590 --> 00:06:05,510
whatever it is it what's the difference
different functions

92
00:06:05,510 --> 00:06:08,550
the Contra sense to the device to
perform

93
00:06:08,550 --> 00:06:11,600
different actions then you have

94
00:06:11,600 --> 00:06:17,030
available thanks %uh data an attack some

95
00:06:17,030 --> 00:06:21,000
the payload length the data length the
second bite of the packets

96
00:06:21,000 --> 00:06:24,310
can vary from 0 to 252

97
00:06:24,310 --> 00:06:28,290
so the maximal size over the packets is
to an intense

98
00:06:28,290 --> 00:06:31,620
56 bytes

99
00:06:31,620 --> 00:06:34,700
the took some is on the the confidence
to with 255

100
00:06:34,700 --> 00:06:38,280
of the whole data so it's

101
00:06:38,280 --> 00:06:44,060
pretty easy to compile the took some

102
00:06:44,060 --> 00:06:49,300
as I said there are a lot of had us
since it's got in a fight stuff 256

103
00:06:49,300 --> 00:06:50,780
possible commence

104
00:06:50,780 --> 00:06:54,310
and from the documentation you have who
lists that's a screenshot of the

105
00:06:54,310 --> 00:06:55,770
documentation there

106
00:06:55,770 --> 00:07:01,250
with all the headers and the
corresponding function

107
00:07:01,250 --> 00:07:05,199
on you at us other the new versions of
the protocol and there are those that

108
00:07:05,199 --> 00:07:05,650
are

109
00:07:05,650 --> 00:07:12,650
reserved of for internal use only there
may be some things to check with his

110
00:07:13,280 --> 00:07:16,330
to have a look there's a simple
communication

111
00:07:16,330 --> 00:07:19,830
we can see this first request their

112
00:07:19,830 --> 00:07:23,389
its from the header in green its some
purple

113
00:07:23,389 --> 00:07:26,830
kind of a thing from device such as a
city-run

114
00:07:26,830 --> 00:07:31,160
the Contra to a device that other
similar to

115
00:07:31,160 --> 00:07:35,150
it gets a response had a 0-0

116
00:07:35,150 --> 00:07:39,290
from device at that list too to device
such as this one there's no data

117
00:07:39,290 --> 00:07:43,500
in both of them and if you look at this

118
00:07:43,500 --> 00:07:47,889
there's a wrist resting Riv this will
cause some problems too

119
00:07:47,889 --> 00:07:50,979
to actually sit sniff the data in the
response

120
00:07:50,979 --> 00:07:55,790
you don't have any way any relation
between the response and the request

121
00:07:55,790 --> 00:08:00,160
the response is always 0 so you have to
know the requests

122
00:08:00,160 --> 00:08:03,889
to know to the response

123
00:08:03,889 --> 00:08:07,740
was the corresponding response since
nobody

124
00:08:07,740 --> 00:08:11,000
there's only one controller soaked with
send the request

125
00:08:11,000 --> 00:08:14,199
receive a response then send another
request maybe on another device

126
00:08:14,199 --> 00:08:17,460
and and get the response but it's not
just

127
00:08:17,460 --> 00:08:20,669
connected to the bus you have no way to
no

128
00:08:20,669 --> 00:08:23,979
which which was the request for this
response

129
00:08:23,979 --> 00:08:27,750
this might be a problem for the future

130
00:08:27,750 --> 00:08:31,419
another I could sense

131
00:08:31,419 --> 00:08:35,339
the header is at six request man fucked
riding

132
00:08:35,339 --> 00:08:38,539
again from the Contra to the device

133
00:08:38,539 --> 00:08:41,709
and the US response with a length of 3

134
00:08:41,709 --> 00:08:46,070
ants the responses and there I its the
fun factor of

135
00:08:46,070 --> 00:08:50,070
this gone except a

136
00:08:50,070 --> 00:08:54,540
the Paleo this askin coated though the
responses that are

137
00:08:54,540 --> 00:09:00,889
binary encoded it really depends on the
device or the specs

138
00:09:00,889 --> 00:09:04,170
so for many some product

139
00:09:04,170 --> 00:09:07,639
was able to ping the area the device was
able to

140
00:09:07,639 --> 00:09:10,930
get some information for it but snow I
need to know

141
00:09:10,930 --> 00:09:16,160
exactly how to gets if somebody puts one
says Frank saw

142
00:09:16,160 --> 00:09:20,000
another going in the device to do this

143
00:09:20,000 --> 00:09:23,910
that's a header number 229

144
00:09:23,910 --> 00:09:27,050
sent to the device and the device sense
facts

145
00:09:27,050 --> 00:09:31,670
11 bytes of data that is one boat for a
counter

146
00:09:31,670 --> 00:09:35,360
ants 5 results that saw a

147
00:09:35,360 --> 00:09:40,000
two bites length this counter is
incremented

148
00:09:40,000 --> 00:09:43,930
by each events that is made on the going
to accept a

149
00:09:43,930 --> 00:09:48,130
so it's time you with going in its even
if its own room crying

150
00:09:48,130 --> 00:09:52,000
for Scion a a good guy I know if there's
a problem

151
00:09:52,000 --> 00:09:58,450
there will be a new even generated and
the council would be incremented

152
00:09:58,450 --> 00:10:02,330
the last five results are goaded into
bites

153
00:10:02,330 --> 00:10:06,580
nominee in the first bites does the
validation channel

154
00:10:06,580 --> 00:10:09,740
this this is no the this is not the
value

155
00:10:09,740 --> 00:10:12,830
of the going inserted it's the
validation to know

156
00:10:12,830 --> 00:10:17,350
if you like it's the ID of the
recognition is recognition nice piece

157
00:10:17,350 --> 00:10:23,330
going normally occur except a device can
organize up to 16

158
00:10:23,330 --> 00:10:26,980
different kind of guns and each of them
is a science

159
00:10:26,980 --> 00:10:31,290
a buddy this in turn out so from 1 to 16

160
00:10:31,290 --> 00:10:34,920
nobody does have been about the
manufacturer by default

161
00:10:34,920 --> 00:10:39,070
but you can also reconfigure its true
for example if you have one euro formats

162
00:10:39,070 --> 00:10:43,320
you can Jensen make to make the kind
except for a crisis

163
00:10:43,320 --> 00:10:47,020
clients something the second by its

164
00:10:47,020 --> 00:10:50,660
contains no money they owe codes so if
it's about going exited

165
00:10:50,660 --> 00:10:54,760
the con was correct accepted if there's
a mechanical

166
00:10:54,760 --> 00:10:58,529
et cetera and it can also contain the
channel

167
00:10:58,529 --> 00:11:01,810
where the the crime has been

168
00:11:01,810 --> 00:11:06,000
based to this

169
00:11:06,000 --> 00:11:09,310
using this kind sorta the center

170
00:11:09,310 --> 00:11:12,790
again this the this the going in
different race

171
00:11:12,790 --> 00:11:18,040
and you will get this information using
the result be

172
00:11:18,040 --> 00:11:21,100
the problem is that sometimes result be
%uh switched

173
00:11:21,100 --> 00:11:24,459
so for some vendors of going except us

174
00:11:24,459 --> 00:11:29,630
the results the first by contains the
error code and the second one contains

175
00:11:29,630 --> 00:11:33,050
the actual value tunnel so

176
00:11:33,050 --> 00:11:36,560
you have to look at the data sheets to
be sure on

177
00:11:36,560 --> 00:11:41,529
how you can accept the works

178
00:11:41,529 --> 00:11:46,350
so f1 information to create my initial
project

179
00:11:46,350 --> 00:11:50,160
so implemented the system protocol on a
teensy device

180
00:11:50,160 --> 00:11:53,700
for those who don't know with the SES
its

181
00:11:53,700 --> 00:11:57,529
kind of like an hour reno just look at
your butt

182
00:11:57,529 --> 00:12:01,010
but the advantage of the 13 C is that he
can emulates

183
00:12:01,010 --> 00:12:04,630
USB devices like a mouse so they are
both or

184
00:12:04,630 --> 00:12:07,740
what is insisting for me a keyboard

185
00:12:07,740 --> 00:12:10,740
so what I did is simply

186
00:12:10,740 --> 00:12:14,550
implements the brother the sister
protocol to all

187
00:12:14,550 --> 00:12:18,520
gone except a device and since it isn't

188
00:12:18,520 --> 00:12:22,149
it chills the one suspense has been
inserted

189
00:12:22,149 --> 00:12:25,660
it was sent a kiss talk to my

190
00:12:25,660 --> 00:12:29,520
Main tab and other new credit

191
00:12:29,520 --> 00:12:33,000
gonna to have a look

192
00:12:33,000 --> 00:12:36,330
the teensy is right there bigness of

193
00:12:36,330 --> 00:12:39,910
YS

194
00:12:39,910 --> 00:12:43,339
mostly for the burden purposes this game
running

195
00:12:43,339 --> 00:12:49,350
behind and gone except a its ok with one
Swiss francs

196
00:12:49,350 --> 00:12:53,339
would have wanted ok with to assist
thanks

197
00:12:53,339 --> 00:12:57,089
20 credits

198
00:12:57,089 --> 00:13:00,230
I do it again

199
00:13:00,230 --> 00:13:03,470
just 25 so great

200
00:13:03,470 --> 00:13:06,779
I was able to get some money more

201
00:13:06,779 --> 00:13:10,600
but sits on a hooker

202
00:13:10,600 --> 00:13:14,820
as staffing me but yeah but can we do
more thing

203
00:13:14,820 --> 00:13:18,570
can get more information or that the
main beam more things to do with the

204
00:13:18,570 --> 00:13:21,920
with this but also

205
00:13:21,920 --> 00:13:25,649
I have a look and phone several
different devices %uh vending machines

206
00:13:25,649 --> 00:13:27,390
that use it to talk

207
00:13:27,390 --> 00:13:32,080
and I was trying to maybe interpret the
data are

208
00:13:32,080 --> 00:13:35,450
at least know exactly how this is a how
this works in

209
00:13:35,450 --> 00:13:39,940
real-life situations not the kind of
fact that that I did

210
00:13:39,940 --> 00:13:44,709
the problem is that there's no open
source sis a doc sniffer

211
00:13:44,709 --> 00:13:49,350
for the moment so I created through to
us that got a cold

212
00:13:49,350 --> 00:13:52,830
cicis neeson city bus the

213
00:13:52,830 --> 00:13:56,350
couldn't buy them and cicis missus a
pissy

214
00:13:56,350 --> 00:13:59,709
used to sneak did on a bus and

215
00:13:59,709 --> 00:14:02,760
a safe there are on a on a fine

216
00:14:02,760 --> 00:14:06,820
and city bus is a tool to actually
faster data

217
00:14:06,820 --> 00:14:11,050
to a readable format so you can track
the requests and responses

218
00:14:11,050 --> 00:14:15,430
and see exactly how it works I had to
create this issue talk laboring

219
00:14:15,430 --> 00:14:20,170
because again there are no pienso stores
to do that

220
00:14:20,170 --> 00:14:23,430
ants the best used his

221
00:14:23,430 --> 00:14:27,930
you could do is to use abyss Pirates to
sniff the date on the bus

222
00:14:27,930 --> 00:14:31,700
waivers Pirates because you have on your
left up maybe

223
00:14:31,700 --> 00:14:35,269
a a soda lime the problem is that's this
number

224
00:14:35,269 --> 00:14:38,579
done not in the same voltage as

225
00:14:38,579 --> 00:14:42,149
the system bus so this is the spirits

226
00:14:42,149 --> 00:14:46,660
to the Perseus are working to it's
really easy to interface

227
00:14:46,660 --> 00:14:52,959
this with all kind of protocols UART SPI
i2c one wire Exeter Exeter

228
00:14:52,959 --> 00:14:58,029
you can use its using the terminal or
you can also script it's

229
00:14:58,029 --> 00:15:02,519
for tourists like the 1i did

230
00:15:02,519 --> 00:15:05,790
so for a quick demo

231
00:15:05,790 --> 00:15:11,170
cicis NIF takes for arguments the single
device

232
00:15:11,170 --> 00:15:14,269
and we select an output sign in them

233
00:15:14,269 --> 00:15:17,640
and we see their the day the these
troubling

234
00:15:17,640 --> 00:15:21,110
on the bus

235
00:15:21,110 --> 00:15:27,959
if with these data well using city bus

236
00:15:27,959 --> 00:15:31,950
doesn't ask us on a to face were you see
all the packets

237
00:15:31,950 --> 00:15:35,089
you can select them a Supercenter

238
00:15:35,089 --> 00:15:38,420
begets all the information of the
packets what is the

239
00:15:38,420 --> 00:15:41,500
correct name of that are not on in the
number

240
00:15:41,500 --> 00:15:45,230
it's a response again decode it

241
00:15:45,230 --> 00:15:50,060
and you can that way track what is
happening directly on the bus

242
00:15:50,060 --> 00:15:53,740
we see their the response ahead a 229

243
00:15:53,740 --> 00:15:56,940
the one used to get information for
going so to

244
00:15:56,940 --> 00:16:01,820
a kind except us on and UF the decoded
the road with the oven counter

245
00:16:01,820 --> 00:16:05,209
I'm or the five results

246
00:16:05,209 --> 00:16:09,180
in the two rights and also into annexed
above the packets

247
00:16:09,180 --> 00:16:12,360
with these tools it's really easy to
sniffer

248
00:16:12,360 --> 00:16:15,450
sniff assisted the bus and

249
00:16:15,450 --> 00:16:22,450
understand then run on how does it work
exactly

250
00:16:22,579 --> 00:16:26,550
as to how can I set to me gonna do maybe
even more

251
00:16:26,550 --> 00:16:29,560
because we on the bus we can listen to
the traffic

252
00:16:29,560 --> 00:16:35,029
but we able to insects data already down
this bus

253
00:16:35,029 --> 00:16:38,820
that for example turning okay I'm the
guy acceptor and I received

254
00:16:38,820 --> 00:16:42,620
truth to more frank's to my folks again
two more to mark tomorrow

255
00:16:42,620 --> 00:16:47,959
to get more credits for buying
cigarettes or something

256
00:16:47,959 --> 00:16:52,399
the progress that's again there's only
one physical while for the bus

257
00:16:52,399 --> 00:16:55,889
so if we can sniff the requests we will

258
00:16:55,889 --> 00:16:59,399
also for the corresponding device will
also do

259
00:16:59,399 --> 00:17:03,600
ants normally the corresponding device
with response to the controller

260
00:17:03,600 --> 00:17:08,299
before or at the same time as us and
this would end the signal unreason there

261
00:17:08,299 --> 00:17:08,799
a

262
00:17:08,799 --> 00:17:12,760
fire upon the arm or something

263
00:17:12,760 --> 00:17:16,559
so I can we make sits to disable

264
00:17:16,559 --> 00:17:20,649
the the correct device the the target
device

265
00:17:20,649 --> 00:17:24,620
to respond at its base

266
00:17:24,620 --> 00:17:28,409
with okay so I looked again at the
documentation

267
00:17:28,409 --> 00:17:31,679
and iPhone some comments goal me to drop
comments

268
00:17:31,679 --> 00:17:35,139
that are used by controller to resolve
conflicts

269
00:17:35,139 --> 00:17:39,519
for example if you have many can accept
us for a different kind of money

270
00:17:39,519 --> 00:17:43,350
by default it will all have that dress
number two

271
00:17:43,350 --> 00:17:47,620
so that the controller can send the
comments to one of the divisive

272
00:17:47,620 --> 00:17:50,769
to tell him to sent it to the restroom a
new one

273
00:17:50,769 --> 00:17:54,130
either the Contra can specify one

274
00:17:54,130 --> 00:17:58,830
address or you can use another header
the had a $250

275
00:17:58,830 --> 00:18:01,980
these address random so when using at
this random

276
00:18:01,980 --> 00:18:05,400
the device will try to sniff the

277
00:18:05,400 --> 00:18:08,430
the bus and use a new address

278
00:18:08,430 --> 00:18:13,660
that is not in use I at the moment so

279
00:18:13,660 --> 00:18:17,260
with these requests we may be able to

280
00:18:17,260 --> 00:18:20,540
stressed tense device address

281
00:18:20,540 --> 00:18:23,960
and start acting like we actually

282
00:18:23,960 --> 00:18:27,350
are the device to do this just

283
00:18:27,350 --> 00:18:30,770
sense a as a set and address tent
requests

284
00:18:30,770 --> 00:18:35,420
and tense the targets to

285
00:18:35,420 --> 00:18:41,030
another address somewhere on the bus
ants since it won't respond again

286
00:18:41,030 --> 00:18:45,380
to their requests we are not able to
responded today so

287
00:18:45,380 --> 00:18:49,990
well directly I dotting the device
weekend maybe for what the request

288
00:18:49,990 --> 00:18:54,250
to the device of respond instead of the
high-tech device

289
00:18:54,250 --> 00:18:58,660
again the problem is that's

290
00:18:58,660 --> 00:19:02,450
there's only one wire so we have to be
sure that we won't

291
00:19:02,450 --> 00:19:06,270
jam the toxic a could be able to do some
tests on

292
00:19:06,270 --> 00:19:09,840
real vending machines and I even someone
that when

293
00:19:09,840 --> 00:19:13,590
there was a jam all there was some kind
of interruption he was starting

294
00:19:13,590 --> 00:19:17,880
screaming with not I'm really really was
crazy so

295
00:19:17,880 --> 00:19:21,180
I did some coke for this and to send the
address change requests

296
00:19:21,180 --> 00:19:25,770
it takes about six final six minutes
seconds and

297
00:19:25,770 --> 00:19:29,860
as the specs sets unit 24 every device

298
00:19:29,860 --> 00:19:34,640
every 200 milliseconds so nominee this
largely enough time for us

299
00:19:34,640 --> 00:19:38,020
but the problem is that's the more
divisive on the bus

300
00:19:38,020 --> 00:19:41,960
the shorter the silence window

301
00:19:41,960 --> 00:19:45,530
will be available because just 24 every
device

302
00:19:45,530 --> 00:19:50,330
every 200 milliseconds let you go five
devices

303
00:19:50,330 --> 00:19:53,380
left to all them every

304
00:19:53,380 --> 00:19:56,380
200 milliseconds but one at a time so

305
00:19:56,380 --> 00:19:59,640
its to andrew is a consult silence
divided by five so

306
00:19:59,640 --> 00:20:05,500
what device the shorter the window to
sum it up

307
00:20:05,500 --> 00:20:09,330
fun too I took a device on the bus you
have to scan the best

308
00:20:09,330 --> 00:20:12,870
to actually look if this enough silence

309
00:20:12,870 --> 00:20:17,390
to inject data if there's sufficient
that subsidence

310
00:20:17,390 --> 00:20:20,590
you can prepare the end section so look
that's

311
00:20:20,590 --> 00:20:24,630
the device 128 X profound address that
is not in use at the moment

312
00:20:24,630 --> 00:20:28,400
then wait for a silence period

313
00:20:28,400 --> 00:20:33,070
insect the packets so the device with
changes address

314
00:20:33,070 --> 00:20:36,070
and then at the at this moment we can
start

315
00:20:36,070 --> 00:20:39,430
responding instead of the the target
device

316
00:20:39,430 --> 00:20:43,340
after we finished to be clean when it to

317
00:20:43,340 --> 00:20:46,640
think the device and tell him to get its
original address

318
00:20:46,640 --> 00:20:50,900
so would state stealth and normally they
won't be any

319
00:20:50,900 --> 00:20:55,250
arm signing up or something again

320
00:20:55,250 --> 00:20:58,360
need to do this when the bus is in use
so

321
00:20:58,360 --> 00:21:02,460
week we can't just send all the packets
and stuff responding we have to text

322
00:21:02,460 --> 00:21:06,510
if down not other devices that maybe

323
00:21:06,510 --> 00:21:09,730
out jamming the traffic or are
responding even

324
00:21:09,730 --> 00:21:12,820
a are responding so in

325
00:21:12,820 --> 00:21:16,970
a ahead of us so

326
00:21:16,970 --> 00:21:20,770
to simplify this I created a trickle sis
object

327
00:21:20,770 --> 00:21:26,240
that automates the hijacking process ok
let's buy

328
00:21:26,240 --> 00:21:30,280
sniffing the bus looking for data

329
00:21:30,280 --> 00:21:34,060
ants finding so the silence when those

330
00:21:34,060 --> 00:21:38,390
preparing the things x in since the
device address

331
00:21:38,390 --> 00:21:42,110
and stopped responding as the device we
want to I'd like

332
00:21:42,110 --> 00:21:45,530
again we are using a bus Pirates to
sniff

333
00:21:45,530 --> 00:21:49,480
anti-gun since it can also inject
traffic that's the perfect 02

334
00:21:49,480 --> 00:21:55,830
interact with with the bus physically as
an example

335
00:21:55,830 --> 00:22:01,080
that's the title of the the stocks label
to inject some kinds

336
00:22:01,080 --> 00:22:04,250
likes if you're a decade can accept a

337
00:22:04,250 --> 00:22:08,590
driver to respond to any

338
00:22:08,590 --> 00:22:12,110
to every request likes the one we saw we
saw previously

339
00:22:12,110 --> 00:22:15,400
ants just respond by incrementing

340
00:22:15,400 --> 00:22:18,700
the event counter every time you
recommend the even counter

341
00:22:18,700 --> 00:22:22,620
the last even will be replayed ants if
you

342
00:22:22,620 --> 00:22:26,970
just with once this thanks one suspect
for example if you include the counter

343
00:22:26,970 --> 00:22:30,150
the machine will actually think this new

344
00:22:30,150 --> 00:22:36,260
one you frank inserted et cetera et
cetera et cetera you want to do this you

345
00:22:36,260 --> 00:22:36,780
have to be

346
00:22:36,780 --> 00:22:41,580
really careful nuts to sets a

347
00:22:41,580 --> 00:22:45,970
and even counter lower than the previous
value

348
00:22:45,970 --> 00:22:49,360
because in that is the main board was
stopped again and I'll

349
00:22:49,360 --> 00:22:52,430
there are some protection that are made
for by the vendors

350
00:22:52,430 --> 00:22:56,280
to protect i ducking but normally if you
do this correctly

351
00:22:56,280 --> 00:23:00,450
like sniffing the bus to see what are
the last response from the device

352
00:23:00,450 --> 00:23:03,910
and right after I decking send the same
response

353
00:23:03,910 --> 00:23:07,340
before studying modifying them nominee

354
00:23:07,340 --> 00:23:10,500
you won't get any problem

355
00:23:10,500 --> 00:23:13,560
to see how it works again I have named
their

356
00:23:13,560 --> 00:23:16,900
so I'm still using my project so this

357
00:23:16,900 --> 00:23:21,810
and with Sis eject I use the same
parameters Asus sis NIF

358
00:23:21,810 --> 00:23:25,290
know the differences that's so we need
to specify a source address

359
00:23:25,290 --> 00:23:29,700
so the actual targets address and the
destination address

360
00:23:29,700 --> 00:23:33,520
the where we've we are gonna send the
the device

361
00:23:33,520 --> 00:23:37,530
on the bus for specified the could
accept our device to

362
00:23:37,530 --> 00:23:40,640
and send him to add a seventh and one is
done

363
00:23:40,640 --> 00:23:44,570
we see their the response that the %uh
that has been sniffed basis eject

364
00:23:44,570 --> 00:23:48,870
and we see modify its it with that two
more credits

365
00:23:48,870 --> 00:23:54,280
if we do it again by incrementing by one
the even counter

366
00:23:54,280 --> 00:23:57,800
will again a new credits and now

367
00:23:57,800 --> 00:24:01,240
if I tend to increments automatically

368
00:24:01,240 --> 00:24:08,240
in the machine with %uh getting more and
more and more and more more credit

369
00:24:15,990 --> 00:24:18,990
okay that's great but maybe we can do

370
00:24:18,990 --> 00:24:22,070
even more with this liked us

371
00:24:22,070 --> 00:24:25,490
for example on except those offline is
not responding to

372
00:24:25,490 --> 00:24:29,120
anything so we can do pretty much
whatever we want with it

373
00:24:29,120 --> 00:24:34,140
for example some kind except a I able to
be a reprogrammed

374
00:24:34,140 --> 00:24:37,640
by CC talk so we can send a header to

375
00:24:37,640 --> 00:24:43,460
two-time just switch in a learn mode
ants you can say okay reprogram the

376
00:24:43,460 --> 00:24:44,320
Cheonan amo

377
00:24:44,320 --> 00:24:49,030
5 for example so and the gun accept OEM

378
00:24:49,030 --> 00:24:52,330
ask for some clients new guns

379
00:24:52,330 --> 00:24:56,130
and it would stop learning about the the
diameter the

380
00:24:56,130 --> 00:24:59,330
the way tech cetera to done for no going

381
00:24:59,330 --> 00:25:04,960
for example let's say since the
mainboard

382
00:25:04,960 --> 00:25:09,660
actually on the nose the channel ID
other calling

383
00:25:09,660 --> 00:25:12,690
it has to have a

384
00:25:12,690 --> 00:25:16,750
a corresponding table between the 10 ID
and the actual value of the money

385
00:25:16,750 --> 00:25:20,170
so this table is in the gun except up

386
00:25:20,170 --> 00:25:23,530
and in the mainboard so for example if

387
00:25:23,530 --> 00:25:27,340
the five suspects the because I'm by six
thanks

388
00:25:27,340 --> 00:25:31,330
in isn't the 10 ID number five if you
reprogram

389
00:25:31,330 --> 00:25:34,870
the 10 ID number five with then sense

390
00:25:34,870 --> 00:25:38,240
kinds and

391
00:25:38,240 --> 00:25:41,540
move back to the the device to its
original address

392
00:25:41,540 --> 00:25:45,500
when putting 10 cents the cut except
over sense

393
00:25:45,500 --> 00:25:50,030
there's a new kind with 10 ID number
five and the main board will text

394
00:25:50,030 --> 00:25:53,040
okay an ID number five its ok thanks
great

395
00:25:53,040 --> 00:25:56,530
so that sci-fi fans in the credit but
got it

396
00:25:56,530 --> 00:26:00,220
up with 10 cents thats pretty easy to do

397
00:26:00,220 --> 00:26:03,630
on other devices

398
00:26:03,630 --> 00:26:07,080
he also contends the buff the context of
the been accepted

399
00:26:07,080 --> 00:26:10,420
leg was so we have a the going solo
effort going sort just

400
00:26:10,420 --> 00:26:13,580
the 10 this money in different race

401
00:26:13,580 --> 00:26:17,110
and there's always one to a for but
credits or

402
00:26:17,110 --> 00:26:20,460
but money that is sent back to the user
so

403
00:26:20,460 --> 00:26:23,750
what country to country change the SOTA
pop

404
00:26:23,750 --> 00:26:27,770
from nobody getting in the trade but
getting back to the user

405
00:26:27,770 --> 00:26:31,330
so just put five francs gets back and it
gets counted

406
00:26:31,330 --> 00:26:34,450
so since you went to speak in

407
00:26:34,450 --> 00:26:41,450
no problem let's go

408
00:26:42,630 --> 00:26:46,290
another topic for the whole process the
normally use

409
00:26:46,290 --> 00:26:49,700
a special scheme out to release the
money its kind of protected

410
00:26:49,700 --> 00:26:53,750
you have to ask for a challenge it would
send you backed eight when the bites

411
00:26:53,750 --> 00:26:57,630
then the controller needs to and go this
giant

412
00:26:57,630 --> 00:27:00,840
with the number of goings to actually
send back

413
00:27:00,840 --> 00:27:04,210
ants send this value to the whole per
and

414
00:27:04,210 --> 00:27:07,240
if the tenant and the response not it
was stopped

415
00:27:07,240 --> 00:27:12,100
giving up the money the problem is that

416
00:27:12,100 --> 00:27:15,110
to simplify this that's because the
algorithm

417
00:27:15,110 --> 00:27:19,260
is only available when signing an NDA so
I think even to even some

418
00:27:19,260 --> 00:27:23,620
vendors do not have to move to send the
NDA

419
00:27:23,620 --> 00:27:28,090
and to be most simple they're not
they're not using this standoff

420
00:27:28,090 --> 00:27:32,710
a tens response thing but only use the
cellular number so

421
00:27:32,710 --> 00:27:36,050
instead of for the the response and got
it with the challenge

422
00:27:36,050 --> 00:27:40,140
you only have two cents as a as the as
the response the set a number of the

423
00:27:40,140 --> 00:27:44,870
the device ants by looking at the
documentation of some hope first

424
00:27:44,870 --> 00:27:48,280
as the fine this face

425
00:27:48,280 --> 00:27:51,640
if the hope a credito this blah blah
blah then

426
00:27:51,640 --> 00:27:55,679
the dispense got common still it's an a
bike oath but the value of the code does

427
00:27:55,679 --> 00:27:56,450
not matter

428
00:27:56,450 --> 00:27:59,650
so good to some whatever you want that
beef

429
00:27:59,650 --> 00:28:06,650
a time Sun that's if you have the money
so

430
00:28:06,850 --> 00:28:12,830
if the Oprah does not use any kind of
talent response or

431
00:28:12,830 --> 00:28:15,960
can put whatever you want just tell him
to dispense

432
00:28:15,960 --> 00:28:19,090
to the 55 sconce with Tia

433
00:28:19,090 --> 00:28:22,660
its but you have to do this challenge
response thing even if

434
00:28:22,660 --> 00:28:26,130
the the response in the correct there's
another way

435
00:28:26,130 --> 00:28:30,020
much better this a comment score Berto
per and you just

436
00:28:30,020 --> 00:28:34,190
send its and all but was not clearing
tough doping all the money

437
00:28:34,190 --> 00:28:38,710
why use encryption all tenants response
if you have this comment I don't know

438
00:28:38,710 --> 00:28:45,190
okay

439
00:28:45,190 --> 00:28:49,360
so we finance many things to do but
isn't the only protection

440
00:28:49,360 --> 00:28:54,450
yeah in the in the specs DUP protection
like

441
00:28:54,450 --> 00:28:59,169
a pin code a four digit PIN code that
needs to be sent by the Comptroller

442
00:28:59,169 --> 00:29:02,510
to the device before actually sending
commands

443
00:29:02,510 --> 00:29:06,530
its on the four successive governments
and it depends on the device

444
00:29:06,530 --> 00:29:09,909
for example farrakhan acceptor you only
able to probe

445
00:29:09,909 --> 00:29:14,179
for new events after sending the PIN
code the problem is that

446
00:29:14,179 --> 00:29:17,580
the pic go descent in cleartext on the
city bus

447
00:29:17,580 --> 00:29:21,070
so if you sniff will get the pin and you
can't just

448
00:29:21,070 --> 00:29:25,190
send this this and this. been to to get
the information you want

449
00:29:25,190 --> 00:29:29,820
that's ok comment for the pink other is
had a two hundred and

450
00:29:29,820 --> 00:29:33,150
18 so this look for it

451
00:29:33,150 --> 00:29:36,550
know many you only have to do it once
and the device will

452
00:29:36,550 --> 00:29:40,250
Ian unlocked modes and respond to every
command from the

453
00:29:40,250 --> 00:29:43,980
from the Contra but if you really wonder
the PIN code just

454
00:29:43,980 --> 00:29:47,210
brought the power cord of the vending
machine full effect and

455
00:29:47,210 --> 00:29:50,890
since it would be a result whenever to
get this pink OTC

456
00:29:50,890 --> 00:29:57,890
into since its in cleartext there's no
problem for this

457
00:29:58,440 --> 00:30:02,760
in later versions of the specs there's a
song clips on

458
00:30:02,760 --> 00:30:06,440
the at the moment to encryption methods
appropriate and trypsin

459
00:30:06,440 --> 00:30:09,870
with obviously no details have to send
this NDA

460
00:30:09,870 --> 00:30:14,730
with 24-bit Keith and this encryption
using

461
00:30:14,730 --> 00:30:18,250
and 56 its key and deaths also for a new
version that

462
00:30:18,250 --> 00:30:22,210
should be coming to a hundred and 2013

463
00:30:22,210 --> 00:30:25,640
Avison with as:

464
00:30:25,640 --> 00:30:29,740
all of these use a pre-shared key
between the culture and the devices

465
00:30:29,740 --> 00:30:33,380
aunt Mexican uses different had us

466
00:30:33,380 --> 00:30:37,190
for example we normally used to have
those 229

467
00:30:37,190 --> 00:30:41,210
to requests data from the from UConn
acceptor

468
00:30:41,210 --> 00:30:44,860
ants the Contra mount must use to are
her

469
00:30:44,860 --> 00:30:48,900
ever 120 on 12 to read encrypt a defense

470
00:30:48,900 --> 00:30:52,050
that is included with this key

471
00:30:52,050 --> 00:30:55,350
the problem is that's if you really want
to know this study you

472
00:30:55,350 --> 00:30:59,700
you just have to send the header with
the head at 29-29

473
00:30:59,700 --> 00:31:03,820
even its is if its encryption enabled

474
00:31:03,820 --> 00:31:08,110
you are able to send this comment and
get the data and acquitted

475
00:31:08,110 --> 00:31:12,150
there's no disabling the the architects
the

476
00:31:12,150 --> 00:31:16,020
Heather is not disabled when using
encryption soap

477
00:31:16,020 --> 00:31:19,960
if you really were want this information
US stable to have it

478
00:31:19,960 --> 00:31:26,270
was great

479
00:31:26,270 --> 00:31:30,240
so left more thanks to defer to discover
for this protocol

480
00:31:30,240 --> 00:31:33,860
for example the encryption support numb
maybe

481
00:31:33,860 --> 00:31:37,809
more things to do for example the keys
can be transferred using city talk

482
00:31:37,809 --> 00:31:40,830
so that this key of the proprietary key

483
00:31:40,830 --> 00:31:43,950
is no money transfers using CC talk at
the city's ation

484
00:31:43,950 --> 00:31:46,980
of the device ants

485
00:31:46,980 --> 00:31:50,220
since it's appropriate are in close so
some corruption it could be weeks

486
00:31:50,220 --> 00:31:54,669
it should be weak because yeah in such a
small device you won't have any

487
00:31:54,669 --> 00:32:00,710
crypto device is something that they so
no way the production

488
00:32:00,710 --> 00:32:04,190
could be easily breakable

489
00:32:04,190 --> 00:32:07,200
there's also a possibility to dump the
internal memory on

490
00:32:07,200 --> 00:32:10,429
of all the devices on assisted the best
the seneca man I was

491
00:32:10,429 --> 00:32:13,909
you it would send you back all the
memory pages it has

492
00:32:13,909 --> 00:32:18,120
so maybe you can get information find
the nearest is in the film where

493
00:32:18,120 --> 00:32:23,900
of gets private data

494
00:32:23,900 --> 00:32:27,090
it is also possible to upload the new
film went to the device

495
00:32:27,090 --> 00:32:30,770
what it's in use so when the

496
00:32:30,770 --> 00:32:35,390
preparing a new film where with new
money configuration and just

497
00:32:35,390 --> 00:32:42,390
afloat its to the device at that would
be great

498
00:32:42,700 --> 00:32:47,070
for the whole first since not all the
device though

499
00:32:47,070 --> 00:32:50,280
actually some good devices that actually
use the

500
00:32:50,280 --> 00:32:54,440
Jones response Fogo there are maybe also
to

501
00:32:54,440 --> 00:32:58,210
thinks to do with this I'm still working
on this

502
00:32:58,210 --> 00:33:03,200
so there may be a new version are a new
tool to cracked the key or to break the

503
00:33:03,200 --> 00:33:06,980
the tens response I got it from and
servicing in the application

504
00:33:06,980 --> 00:33:13,290
maybe it was fun to speak about this
later

505
00:33:13,290 --> 00:33:16,590
and that's pretty much it for this

506
00:33:16,590 --> 00:33:19,730
a few words about the connectivity

507
00:33:19,730 --> 00:33:22,850
no money these vending machines are
locked

508
00:33:22,850 --> 00:33:26,360
you are not able to directly connect to
this bus

509
00:33:26,360 --> 00:33:30,340
for the the machines have checked
nominee there are two keys the 1t four

510
00:33:30,340 --> 00:33:33,730
the the technician that is able to

511
00:33:33,730 --> 00:33:37,510
open the machine fill it up for of
cigarettes for example

512
00:33:37,510 --> 00:33:41,070
or to to replace a broken device

513
00:33:41,070 --> 00:33:45,440
and another key for that show owner of
the most of the

514
00:33:45,440 --> 00:33:48,440
the vending machine but needs and second
key

515
00:33:48,440 --> 00:33:52,490
to actually get the money the problem is
that

516
00:33:52,490 --> 00:33:55,560
access to the the system is normally
only require this

517
00:33:55,560 --> 00:33:59,470
the motion to reopen because all the con
accepted devices are no money

518
00:33:59,470 --> 00:34:02,580
wrecked in the door so left all the
cables

519
00:34:02,580 --> 00:34:05,720
you can just connect to its using this

520
00:34:05,720 --> 00:34:09,060
so near

521
00:34:09,060 --> 00:34:12,200
everyone can get this for example in the
Ville employees are if

522
00:34:12,200 --> 00:34:15,220
UCI machine open wide open to stick to
it on

523
00:34:15,220 --> 00:34:20,440
start hacking

524
00:34:20,440 --> 00:34:23,909
at the moments we need to have our
laptop

525
00:34:23,909 --> 00:34:27,350
the spirits that acted as the success
also yep

526
00:34:27,350 --> 00:34:30,510
you wouldn't normally be easily spotted
in the casino if you are with your

527
00:34:30,510 --> 00:34:32,030
laptop on an open question

528
00:34:32,030 --> 00:34:36,399
to exit such a lack some stuff that may
be difficult

529
00:34:36,399 --> 00:34:39,440
the thing is and that's another project

530
00:34:39,440 --> 00:34:42,690
it would be possible to use another you
know for example

531
00:34:42,690 --> 00:34:47,129
that may be a good thing to do there and
use a puter Bluetooth shield

532
00:34:47,129 --> 00:34:50,679
so a Bluetooth interface for the deadly
no and to exactly the same

533
00:34:50,679 --> 00:34:53,960
into traffic intake mani exit to exit
for using Bluetooth

534
00:34:53,960 --> 00:34:57,300
so if you are able to final mission over
an open machine

535
00:34:57,300 --> 00:35:00,800
disconnected because the machine walk
away

536
00:35:00,800 --> 00:35:04,660
come back later and with your phone just
inject the traffic and

537
00:35:04,660 --> 00:35:11,660
at money for example that would be
possible

538
00:35:13,050 --> 00:35:17,170
eco-tourism specific protocols a really
fun to analyze

539
00:35:17,170 --> 00:35:21,480
dawson wrote funny things I some

540
00:35:21,480 --> 00:35:25,339
I didn't know there was those kind of
protocols

541
00:35:25,339 --> 00:35:28,530
Lexus a talk at didn't even know about
this before buying

542
00:35:28,530 --> 00:35:32,700
actually a 01 could accept a

543
00:35:32,700 --> 00:35:37,170
Dustin more work to do with this against
its money related

544
00:35:37,170 --> 00:35:40,980
there's always interest for this farkas

545
00:35:40,980 --> 00:35:44,060
so if you don't have it

546
00:35:44,060 --> 00:35:50,450
also by a bus parents and stuff I can
see stock

547
00:35:50,450 --> 00:35:54,170
just what about the doors I love them
would be available

548
00:35:54,170 --> 00:35:58,270
just a thought this took up my get have
accounts I'm

549
00:35:58,270 --> 00:36:02,569
with the application that's a on Monday

550
00:36:02,569 --> 00:36:04,359
and that's it thank you very much

