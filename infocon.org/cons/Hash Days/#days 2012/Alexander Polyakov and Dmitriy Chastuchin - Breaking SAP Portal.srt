1
00:00:05,810 --> 00:00:08,800
so a how many of you

2
00:00:08,800 --> 00:00:12,230
ASAP and how many

3
00:00:12,230 --> 00:00:17,009
don't know anything about SAP it's great
so

4
00:00:17,009 --> 00:00:20,369
up a cow in

5
00:00:20,369 --> 00:00:24,939
marking your piece can company you of
specialist on this EP security and with

6
00:00:24,939 --> 00:00:25,369
you

7
00:00:25,369 --> 00:00:29,769
love research in this area we also have
a the product for analyzing this

8
00:00:29,769 --> 00:00:34,280
as the peace security different areas an
hour speculative

9
00:00:34,280 --> 00:00:38,910
the different conferences like just
three days ago we came from there

10
00:00:38,910 --> 00:00:42,760
in total SAP security summit was very
interesting

11
00:00:42,760 --> 00:00:46,320
I Toby an you have

12
00:00:46,320 --> 00:00:49,629
bother the 160 acknowledgements from the

13
00:00:49,629 --> 00:00:54,309
message via for the fun and different
vulnerabilities in their products

14
00:00:54,309 --> 00:00:57,970
at self today albeit speaking

15
00:00:57,970 --> 00:01:01,559
about a yes the port I'll flight

16
00:01:01,559 --> 00:01:05,210
application which is usually can be
accessed from the internet

17
00:01:05,210 --> 00:01:08,460
so that's why it's portable and

18
00:01:08,460 --> 00:01:11,540
how to get access to this application

19
00:01:11,540 --> 00:01:15,090
through their vulnerability to serve the
other services and also for the

20
00:01:15,090 --> 00:01:19,840
liability so they've the bottle itself
so

21
00:01:19,840 --> 00:01:24,380
again if you if you no remember the SABS
like

22
00:01:24,380 --> 00:01:28,060
I company here which make the business
of for

23
00:01:28,060 --> 00:01:32,509
it's like soft over all the business
critical data is stored

24
00:01:32,509 --> 00:01:36,630
life and national HR data in such a so
if somebody will

25
00:01:36,630 --> 00:01:41,280
want to break your company it's probably
the best way

26
00:01:41,280 --> 00:01:47,179
to do it is to protect the SAP system
and a little bit

27
00:01:47,179 --> 00:01:50,810
of our our research that if down its
like

28
00:01:50,810 --> 00:01:53,999
make a scan of the all the Internet

29
00:01:53,999 --> 00:01:59,119
is me and my opinion there a different
sources like google searching and the

30
00:01:59,119 --> 00:01:59,740
showdown

31
00:01:59,740 --> 00:02:04,649
so we analyze how many a of SAP services
so exposed to the Internet because many

32
00:02:04,649 --> 00:02:06,619
people think that this EP it can be

33
00:02:06,619 --> 00:02:10,250
have a Bologna inside the company but
actually it now

34
00:02:10,250 --> 00:02:15,870
nowadays it it's not true so it's like
five thousand different services

35
00:02:15,870 --> 00:02:19,550
I management services I can beef

36
00:02:19,550 --> 00:02:25,790
can be found in the Internet in a
different different locations

37
00:02:25,790 --> 00:02:29,050
so if you interested moyer condone the
office up

38
00:02:29,050 --> 00:02:33,300
from the abyss cannot call them SAP
security and figures to see global story

39
00:02:33,300 --> 00:02:33,670
of

40
00:02:33,670 --> 00:02:37,530
a different things so

41
00:02:37,530 --> 00:02:40,900
yen of course every flight now

42
00:02:40,900 --> 00:02:44,190
must contain the some kind of sought in
searches like

43
00:02:44,190 --> 00:02:48,420
is like a trance though I his like
results how many are

44
00:02:48,420 --> 00:02:51,600
SEP portals if artists with a length

45
00:02:51,600 --> 00:02:54,870
by the Google and by search engine by s
post about

46
00:02:54,870 --> 00:02:58,270
more them are this number

47
00:02:58,270 --> 00:03:01,970
and what is the special about the

48
00:03:01,970 --> 00:03:05,160
SAP portal is like the gate to the

49
00:03:05,160 --> 00:03:08,630
internal network because the both always

50
00:03:08,630 --> 00:03:12,890
usually connected or is this different
internal systems

51
00:03:12,890 --> 00:03:17,270
and even with with the skin n met Miss
systems

52
00:03:17,270 --> 00:03:20,890
and it's like with you

53
00:03:20,890 --> 00:03:26,140
and usually the fourth-lowest kick can
be a access through the internet so if

54
00:03:26,140 --> 00:03:27,770
you break this the portal

55
00:03:27,770 --> 00:03:32,230
you can go through the links I with his
internal systems

56
00:03:32,230 --> 00:03:35,280
and sometimes the links I a

57
00:03:35,280 --> 00:03:39,080
have the passports in itself sometimes
they use this single sign-on

58
00:03:39,080 --> 00:03:40,030
authentication

59
00:03:40,030 --> 00:03:43,990
so it's it's very critical system am

60
00:03:43,990 --> 00:03:48,170
this how it looks like so it's not so
easy a

61
00:03:48,170 --> 00:03:52,070
an but the main thing so so the user
connects

62
00:03:52,070 --> 00:03:55,610
the to they have jetty engine from the
browser

63
00:03:55,610 --> 00:03:59,280
so there is a jtf evocation serra

64
00:03:59,280 --> 00:04:02,860
its something like a a buncha tom cat
but

65
00:04:02,860 --> 00:04:06,940
100 times complex and

66
00:04:06,940 --> 00:04:10,040
and also the bottle connects to the
different

67
00:04:10,040 --> 00:04:13,330
services in the in total network

68
00:04:13,330 --> 00:04:18,820
like the sebe your pieces template
databases

69
00:04:18,820 --> 00:04:22,270
verification so kinda all the systems

70
00:04:22,270 --> 00:04:27,639
his senate company and it stores the

71
00:04:27,639 --> 00:04:30,949
users in a database or up or the and
held up

72
00:04:30,949 --> 00:04:36,699
and there are are things like I've use
the rules an application so I've uses

73
00:04:36,699 --> 00:04:37,310
like the

74
00:04:37,310 --> 00:04:40,659
smallpox small the confidence of the
board tho

75
00:04:40,659 --> 00:04:44,180
like web pages or bartlett's

76
00:04:44,180 --> 00:04:47,449
of okay so

77
00:04:47,449 --> 00:04:50,990
what can we do West all this stuff ok
you

78
00:04:50,990 --> 00:04:55,530
held can be a I break the is it before
tho

79
00:04:55,530 --> 00:04:58,900
for think it's that I this topic is

80
00:04:58,900 --> 00:05:02,819
was collected I during our different the

81
00:05:02,819 --> 00:05:06,979
engagements for their their as two
people fell

82
00:05:06,979 --> 00:05:10,029
I'll parking and so

83
00:05:10,029 --> 00:05:15,400
all the things are like from the reopens
vision test so

84
00:05:15,400 --> 00:05:18,409
and first I've always thought that the
management console

85
00:05:18,409 --> 00:05:21,449
is like the service to manage a

86
00:05:21,449 --> 00:05:24,900
a the SAP server remotely

87
00:05:24,900 --> 00:05:28,759
and yes so

88
00:05:28,759 --> 00:05:32,340
have a my closest races and as

89
00:05:32,340 --> 00:05:36,029
any at and other systems an

90
00:05:36,029 --> 00:05:41,139
the the interesting thing that we found
but a session ID

91
00:05:41,139 --> 00:05:44,669
of the altercation and the locks but

92
00:05:44,669 --> 00:05:47,879
its only our

93
00:05:47,879 --> 00:05:50,879
it only when the trace level is on

94
00:05:50,879 --> 00:05:54,879
but we found in production system so it
means that are some people

95
00:05:54,879 --> 00:05:58,469
use it trace on the production systems
so think isn't

96
00:05:58,469 --> 00:06:01,969
J session ID's start the log files but

97
00:06:01,969 --> 00:06:06,939
okay you get access to the log files
probably need to have credentials or

98
00:06:06,939 --> 00:06:10,020
access to the system but actually it's
wrong so

99
00:06:10,020 --> 00:06:14,229
there is a remote interface you can send
us of requests

100
00:06:14,229 --> 00:06:20,169
for read lock file so it just send the
roots of request with other vindication

101
00:06:20,169 --> 00:06:25,099
and read the this kind of log file and
get all the decision ideas

102
00:06:25,099 --> 00:06:29,300
then he got budget session AT&T a cookie
and connect to this report of

103
00:06:29,300 --> 00:06:33,050
it's very so it was a first option

104
00:06:33,050 --> 00:06:38,779
but it mostly it works inside the
company because MC services

105
00:06:38,779 --> 00:06:42,729
its knots very often I can be accessed
only

106
00:06:42,729 --> 00:06:45,749
on the Internet now the next think it's

107
00:06:45,749 --> 00:06:50,889
up break known it shows a single sign-on
issue

108
00:06:50,889 --> 00:06:55,669
like up when when you implement the
single sign-on

109
00:06:55,669 --> 00:06:58,749
I the years a wrist by connecting

110
00:06:58,749 --> 00:07:02,419
to the implication proxy in sent some
kind of prudential's

111
00:07:02,419 --> 00:07:07,379
up them that X Active Directory or
something like

112
00:07:07,379 --> 00:07:10,969
like that check the authentication and

113
00:07:10,969 --> 00:07:15,039
Samba the same request but its it own

114
00:07:15,039 --> 00:07:18,469
only it's the head up to their HDPE like

115
00:07:18,469 --> 00:07:22,120
up the

116
00:07:22,120 --> 00:07:25,479
like as a so head over and the name of
the user

117
00:07:25,479 --> 00:07:30,580
like stock header administrator so

118
00:07:30,580 --> 00:07:35,050
at and nothing else so advanced up but
that I care

119
00:07:35,050 --> 00:07:38,400
I at that this had a risk known so you
just need to

120
00:07:38,400 --> 00:07:42,210
for there's a so header in the name of
the user like administrator

121
00:07:42,210 --> 00:07:45,680
and think it's if it at Enterprise
Portal

122
00:07:45,680 --> 00:07:50,120
I can be accessed daughter clear not not
through that in addition proxy

123
00:07:50,120 --> 00:07:53,139
are so you can and

124
00:07:53,139 --> 00:07:57,059
at this header to US to be request

125
00:07:57,059 --> 00:08:00,460
and you can be and you will be
authenticated

126
00:08:00,460 --> 00:08:07,460
like administrator just by adding the
simple header

127
00:08:07,960 --> 00:08:11,550
and yeah so you know the you to
implement the

128
00:08:11,550 --> 00:08:14,719
the fire also if you use a single
sign-on you should

129
00:08:14,719 --> 00:08:18,069
the both

130
00:08:18,069 --> 00:08:21,199
the single sign-on photo Sen

131
00:08:21,199 --> 00:08:24,330
the fire or and them to a

132
00:08:24,330 --> 00:08:28,180
the CP portal okay so

133
00:08:28,180 --> 00:08:32,039
next area is set at j2ee server itself

134
00:08:32,039 --> 00:08:36,000
and the worse up there are some critical
issues

135
00:08:36,000 --> 00:08:40,669
a we also well speaking about us issuers

136
00:08:40,669 --> 00:08:43,940
I before but anyway they have

137
00:08:43,940 --> 00:08:49,529
very useful for breaking the SAP portal

138
00:08:49,529 --> 00:08:53,970
though that accesses country to their
j2ee application is controlled with the

139
00:08:53,970 --> 00:08:57,050
WebEx mail and we have to do it region X
male

140
00:08:57,050 --> 00:09:00,470
so speaking about the web.xml I

141
00:09:00,470 --> 00:09:03,829
there's a no woman ability that we found
them love

142
00:09:03,829 --> 00:09:07,110
this cat present in the previous play

143
00:09:07,110 --> 00:09:11,259
have I so they think is

144
00:09:11,259 --> 00:09:15,560
when you have for some kind of

145
00:09:15,560 --> 00:09:19,120
critical service

146
00:09:19,120 --> 00:09:22,579
richest in the admin folder and you have
the

147
00:09:22,579 --> 00:09:27,880
restrictions listed here and for example
for admin for their only they get

148
00:09:27,880 --> 00:09:31,019
the GET method is I

149
00:09:31,019 --> 00:09:34,310
and ascended by their admit
Administrator role

150
00:09:34,310 --> 00:09:38,329
but I think it's what happened if you
send the head meta

151
00:09:38,329 --> 00:09:41,290
there is no had never been the
restriction certain is that everybody

152
00:09:41,290 --> 00:09:43,440
can send the head request

153
00:09:43,440 --> 00:09:47,740
its very a stupid but but the

154
00:09:47,740 --> 00:09:50,740
but it works so and the biggest if you

155
00:09:50,740 --> 00:09:54,509
did they get mad at it meant thats by
default

156
00:09:54,509 --> 00:09:59,170
all the medals are restricted but the
few least at least the

157
00:09:59,170 --> 00:10:02,509
at least one method it means that you
your

158
00:10:02,509 --> 00:10:05,630
you care a only about the get together

159
00:10:05,630 --> 00:10:09,160
so you should and

160
00:10:09,160 --> 00:10:13,100
that year whilst to find some kind of
for

161
00:10:13,100 --> 00:10:16,630
services and there are about 500

162
00:10:16,630 --> 00:10:19,930
service is installed by default in that
j2ee engine

163
00:10:19,930 --> 00:10:23,569
so the idea was to find at least some
kind of service which

164
00:10:23,569 --> 00:10:27,470
which can be exploited I by head request

165
00:10:27,470 --> 00:10:31,060
and it must must be some kind of
interesting on that ability because

166
00:10:31,060 --> 00:10:36,699
ahead this only make it something came
don't get you the information

167
00:10:36,699 --> 00:10:40,620
at so it's for Tom prank phone
innovative

168
00:10:40,620 --> 00:10:43,990
and yeah in it just

169
00:10:43,990 --> 00:10:47,529
send the head methods and we found a

170
00:10:47,529 --> 00:10:51,350
the application called see the web
service called city see is like

171
00:10:51,350 --> 00:10:55,880
said was for controlling up all that
shit to be in GM

172
00:10:55,880 --> 00:10:58,920
you can create user you can to sing user

173
00:10:58,920 --> 00:11:03,050
tour all you can and the Belait
operation system comments 0

174
00:11:03,050 --> 00:11:06,199
gonna everything an so it

175
00:11:06,199 --> 00:11:09,480
everything bill can be done with the two
head request like first headed west

176
00:11:09,480 --> 00:11:10,639
creates user

177
00:11:10,639 --> 00:11:13,769
and second-hand aggressed sing him the
administrator

178
00:11:13,769 --> 00:11:18,089
back to head requests to their internet

179
00:11:18,089 --> 00:11:22,740
of those terrorists and you're in it

180
00:11:22,740 --> 00:11:26,819
I yeah sold out some

181
00:11:26,819 --> 00:11:31,620
security knows from there sybian you can
usually prevent it

182
00:11:31,620 --> 00:11:34,630
and the second issue about the

183
00:11:34,630 --> 00:11:39,250
the web.xml again and okay you listed
all the matters

184
00:11:39,250 --> 00:11:43,240
you do it well but there is some

185
00:11:43,240 --> 00:11:47,480
I so if you call the admin critic
election

186
00:11:47,480 --> 00:11:52,550
I you cannot do this resultant education
because it's restricted

187
00:11:52,550 --> 00:11:57,490
but the river function that was which
called invoke a thoroughly earth

188
00:11:57,490 --> 00:12:01,620
to call any up some led by the class
name

189
00:12:01,620 --> 00:12:04,740
so it miss if you called history led

190
00:12:04,740 --> 00:12:08,769
you think this request a

191
00:12:08,769 --> 00:12:12,000
you can do this yet isn't

192
00:12:12,000 --> 00:12:16,730
go see voters to let so what what you
can do is the

193
00:12:16,730 --> 00:12:20,420
again a attacked the City CA

194
00:12:20,420 --> 00:12:24,089
even if its the previous former
abilities up

195
00:12:24,089 --> 00:12:27,350
this bytch and

196
00:12:27,350 --> 00:12:32,670
yeah so our idea was to

197
00:12:32,670 --> 00:12:36,620
up think what what can we do a

198
00:12:36,620 --> 00:12:39,660
addition a live air so

199
00:12:39,660 --> 00:12:43,420
if you break a city Porto we have we
want to to make a

200
00:12:43,420 --> 00:12:46,540
some kind of dives into internal and at
work

201
00:12:46,540 --> 00:12:51,069
and year so we were looking on the

202
00:12:51,069 --> 00:12:54,370
on this operation system boxes

203
00:12:54,370 --> 00:12:57,379
though you know you have is Alicia make

204
00:12:57,379 --> 00:13:00,639
operation system my sis with a social
call it like a

205
00:13:00,639 --> 00:13:04,290
execute comment was seen in the line so
we can do pretty

206
00:13:04,290 --> 00:13:08,209
everything and then the and Windows CE
the services

207
00:13:08,209 --> 00:13:11,850
I running for from there

208
00:13:11,850 --> 00:13:15,839
I'm fit sabu as a biz service

209
00:13:15,839 --> 00:13:19,759
which have administrator rights

210
00:13:19,759 --> 00:13:23,129
we're so okay so ever think

211
00:13:23,129 --> 00:13:26,959
its it will be like a how to break for
tell without breaking portal

212
00:13:26,959 --> 00:13:30,209
have but let's talk about the portal
itself

213
00:13:30,209 --> 00:13:33,220
and and what is a portal it's like a

214
00:13:33,220 --> 00:13:36,639
a that collection of the

215
00:13:36,639 --> 00:13:40,579
different the objects I like

216
00:13:40,579 --> 00:13:43,940
I've use and users roll them

217
00:13:43,940 --> 00:13:48,639
this kind of stuff and is like the big
deal to him

218
00:13:48,639 --> 00:13:53,259
a caught both both all content here
today and all access to the

219
00:13:53,259 --> 00:13:57,329
I objects is based on ACL

220
00:13:57,329 --> 00:14:01,160
and there are two types of access like
design time it's when you

221
00:14:01,160 --> 00:14:05,319
a have administrator access and runtime
just for users

222
00:14:05,319 --> 00:14:09,490
I though like the Wraith

223
00:14:09,490 --> 00:14:13,720
three different permission levels and if
you are seeing the user permission

224
00:14:13,720 --> 00:14:14,529
little for

225
00:14:14,529 --> 00:14:17,819
like administrator permissions began he
can to prepare

226
00:14:17,819 --> 00:14:22,379
everything and there was also end user
permissions just like

227
00:14:22,379 --> 00:14:27,269
if you have access to the I've you or
don't have my sisters I've you

228
00:14:27,269 --> 00:14:33,069
and yes so the end user permissions it's
pretty easy

229
00:14:33,069 --> 00:14:36,370
so you can make the save it or enable it

230
00:14:36,370 --> 00:14:43,370
you have access or don't have access and
the

231
00:14:43,370 --> 00:14:46,920
yeah and and also there is a but things
like

232
00:14:46,920 --> 00:14:51,139
I the security zones but I will

233
00:14:51,139 --> 00:14:54,930
talk about little bit later

234
00:14:54,930 --> 00:14:58,620
and yet that mister as a proficiency can
make the all the

235
00:14:58,620 --> 00:15:02,129
kind of their missions like over there
and for control in such a

236
00:15:02,129 --> 00:15:07,670
and they're also a crossing the
permissions

237
00:15:07,670 --> 00:15:11,819
like if the user canvassing different
users or alter this

238
00:15:11,819 --> 00:15:15,319
those companies and yes it's not too

239
00:15:15,319 --> 00:15:19,300
so who is it to understand the August
other things because

240
00:15:19,300 --> 00:15:22,550
just the beginning I also the

241
00:15:22,550 --> 00:15:26,089
the right security zones so

242
00:15:26,089 --> 00:15:29,569
speaking easiest like if you have many
I've use

243
00:15:29,569 --> 00:15:32,699
and you want to us think they're
different users so

244
00:15:32,699 --> 00:15:38,019
roast so believe I've use you put them
all into the security zone

245
00:15:38,019 --> 00:15:41,339
like it like a you've put files on the
folder

246
00:15:41,339 --> 00:15:46,060
let it and yet up this huge is on the
specified by the Federated

247
00:15:46,060 --> 00:15:50,430
like security areas like name of his own
is safe safety level

248
00:15:50,430 --> 00:15:54,430
so it's like up a who can get access to

249
00:15:54,430 --> 00:15:58,240
this zone date listed when the port
Lobster

250
00:15:58,240 --> 00:16:02,480
for mail application and

251
00:16:02,480 --> 00:16:05,810
yeah one one I've you can be. a

252
00:16:05,810 --> 00:16:11,300
think on the two I 1 securities on

253
00:16:11,300 --> 00:16:14,389
and

254
00:16:14,389 --> 00:16:18,139
so if you still want to have have access
to the iView

255
00:16:18,139 --> 00:16:22,550
the festival there and user permissions
are checking

256
00:16:22,550 --> 00:16:26,959
and if you're at the securities of
emissions

257
00:16:26,959 --> 00:16:30,069
which a which is additional it's not the

258
00:16:30,069 --> 00:16:35,220
default I so the festival the end user
permissions such a king and them

259
00:16:35,220 --> 00:16:38,569
the scared is all permissions such a
king

260
00:16:38,569 --> 00:16:42,100
but its looks like a a

261
00:16:42,100 --> 00:16:45,680
like secure I other think is

262
00:16:45,680 --> 00:16:48,959
you can access to the I've use up

263
00:16:48,959 --> 00:16:53,529
directly bypassing the I

264
00:16:53,529 --> 00:16:58,249
rock you and use a row permissions so it
means that the only security zones

265
00:16:58,249 --> 00:17:02,019
will be checked and

266
00:17:02,019 --> 00:17:05,420
too cute results it's not I'm not
configured by def

267
00:17:05,420 --> 00:17:08,520
by default and

268
00:17:08,520 --> 00:17:11,770
the right defensive tilson secure itself

269
00:17:11,770 --> 00:17:15,959
so it's like who can get access to the
different securities else

270
00:17:15,959 --> 00:17:19,909
so the most interesting kiss and no
safety and as low safety because no safe

271
00:17:19,909 --> 00:17:22,240
it is like everybody can get access

272
00:17:22,240 --> 00:17:25,360
without any rights it low safety is like
every user

273
00:17:25,360 --> 00:17:29,059
can get access and media outlets like
the

274
00:17:29,059 --> 00:17:33,039
some kind of users and high safeties
more restricted

275
00:17:33,039 --> 00:17:36,090
to our our idea was to to find if
they're up

276
00:17:36,090 --> 00:17:39,370
release some kind of far a

277
00:17:39,370 --> 00:17:43,480
I've used but are a signet to know
safety low safety

278
00:17:43,480 --> 00:17:46,760
and yes so

279
00:17:46,760 --> 00:17:50,210
we found during the made

280
00:17:50,210 --> 00:17:53,610
Tesla like a it its

281
00:17:53,610 --> 00:17:57,870
it's really exist in the incorporates

282
00:17:57,870 --> 00:18:01,340
net a corporate information so

283
00:18:01,340 --> 00:18:05,230
sarra a no safety a applications

284
00:18:05,230 --> 00:18:08,980
and in some of that applications a

285
00:18:08,980 --> 00:18:12,590
the they can be like critical wealth and
they also can

286
00:18:12,590 --> 00:18:15,669
have the vulnerabilities so some of
their applications with

287
00:18:15,669 --> 00:18:20,120
a can find this simple process ratings
and such a

288
00:18:20,120 --> 00:18:23,559
so yes this it's really works and

289
00:18:23,559 --> 00:18:26,710
its it's not so is it too understand
them

290
00:18:26,710 --> 00:18:29,720
configure probably that's why it's
sometimes

291
00:18:29,720 --> 00:18:32,929
I can be issues

292
00:18:32,929 --> 00:18:38,029
so either i think is still need to take
this securities all permissions

293
00:18:38,029 --> 00:18:41,760
up okay so what kind of

294
00:18:41,760 --> 00:18:45,929
right

295
00:18:45,929 --> 00:18:49,950
what can a father things we can find
that yes it before tho

296
00:18:49,950 --> 00:18:55,820
actually for the everything bike in
every other application

297
00:18:55,820 --> 00:19:00,169
those shame on me it's to use so that
went well for me still talking about the

298
00:19:00,169 --> 00:19:01,270
cross site scripting

299
00:19:01,270 --> 00:19:04,440
but here is like them a

300
00:19:04,440 --> 00:19:08,539
okay we have a square says cryptic
weekend get the cookie it but

301
00:19:08,539 --> 00:19:12,150
sometimes is to be only a but the think
it

302
00:19:12,150 --> 00:19:15,450
interest in seeing guess like I bottle
half

303
00:19:15,450 --> 00:19:18,559
I special I API

304
00:19:18,559 --> 00:19:24,380
which goeth a PCF and it's like 20 strip
API for our

305
00:19:24,380 --> 00:19:28,630
for for calling a

306
00:19:28,630 --> 00:19:32,770
festival for for calling different
objects and the second

307
00:19:32,770 --> 00:19:36,950
it's too transfer the data between the

308
00:19:36,950 --> 00:19:40,200
different I views I

309
00:19:40,200 --> 00:19:43,850
data ended at the different objects
between the eye views

310
00:19:43,850 --> 00:19:47,279
up so you can

311
00:19:47,279 --> 00:19:50,770
do like the cross I've used scripting
against

312
00:19:50,770 --> 00:19:55,210
okay like these are because the rat
different objects

313
00:19:55,210 --> 00:19:59,799
for the different I've use and they can
store the critical data

314
00:19:59,799 --> 00:20:02,830
so by the cross as cryptic a you can

315
00:20:02,830 --> 00:20:06,039
a don't know that both objects

316
00:20:06,039 --> 00:20:09,159
the PTF objects though that's more
interesting

317
00:20:09,159 --> 00:20:15,919
than that simple to assess cryptic

318
00:20:15,919 --> 00:20:20,510
and that they can think it's the the
portal have the college management

319
00:20:20,510 --> 00:20:23,789
documents it's like that folder of the
documents

320
00:20:23,789 --> 00:20:26,880
the simple documents with like

321
00:20:26,880 --> 00:20:30,220
a doc files Excel files and

322
00:20:30,220 --> 00:20:33,799
txt files and

323
00:20:33,799 --> 00:20:38,470
many many administrations so don't
disable the

324
00:20:38,470 --> 00:20:41,690
the full functionality a certain is the
festival

325
00:20:41,690 --> 00:20:45,090
you can read up most of the documents

326
00:20:45,090 --> 00:20:48,950
which up on the public are for those

327
00:20:48,950 --> 00:20:52,200
and the second will you can create your
own documents

328
00:20:52,200 --> 00:20:55,760
and you can create best email page n in
Sayre

329
00:20:55,760 --> 00:21:00,149
the XSS in the HTML basis though that
Nexus S is like

330
00:21:00,149 --> 00:21:03,309
began in said the JavaScript in the
image the email page

331
00:21:03,309 --> 00:21:07,460
and you can create any kind of page like
a fishing patient

332
00:21:07,460 --> 00:21:10,770
send this to the user and

333
00:21:10,770 --> 00:21:13,940
it's pretty simple but the it works

334
00:21:13,940 --> 00:21:17,529
and but they can sink is are

335
00:21:17,529 --> 00:21:21,760
like we found the Dutch Church were also
in the SAP portal see you can

336
00:21:21,760 --> 00:21:24,820
with any kind of files and

337
00:21:24,820 --> 00:21:30,870
it looks like these but with them with
information ASAP it was closed

338
00:21:30,870 --> 00:21:35,440
but and and with we came again to the
same company to make their

339
00:21:35,440 --> 00:21:39,539
the next assessment so we have the
quarto based assessments

340
00:21:39,539 --> 00:21:42,580
and we check this a

341
00:21:42,580 --> 00:21:46,429
up doctor to Russell M it was still
working

342
00:21:46,429 --> 00:21:50,330
and we ask did you install the budget
yes so we were surprised

343
00:21:50,330 --> 00:21:54,250
and the thing was that it was not
properly budgets or they just

344
00:21:54,250 --> 00:21:57,429
deleted the a denied the

345
00:21:57,429 --> 00:22:01,549
though those last thanks so you can a

346
00:22:01,549 --> 00:22:07,000
is a call that directs the filed by PTC
passports so you can

347
00:22:07,000 --> 00:22:10,289
a

348
00:22:10,289 --> 00:22:13,970
call the files from the root out today
director

349
00:22:13,970 --> 00:22:17,850
was without making told us less

350
00:22:17,850 --> 00:22:21,320
but this one already fudged

351
00:22:21,320 --> 00:22:24,380
but you know this not many people
Einstein

352
00:22:24,380 --> 00:22:27,549
okay so let's talk about

353
00:22:27,549 --> 00:22:30,820
something interests a more relevant to
their city Porto

354
00:22:30,820 --> 00:22:34,260
and are yeah we

355
00:22:34,260 --> 00:22:39,330
we found the file which is storing the

356
00:22:39,330 --> 00:22:43,440
their user and the password for the for
access to the

357
00:22:43,440 --> 00:22:47,649
j2ee engine and

358
00:22:47,649 --> 00:22:52,080
we found another file which store the Q
and we know they'll greatness there's

359
00:22:52,080 --> 00:22:55,500
so think was to get access to this file

360
00:22:55,500 --> 00:22:59,940
an okay hope read the file due to stress
all

361
00:22:59,940 --> 00:23:03,149
we already use a they lost on the issue

362
00:23:03,149 --> 00:23:06,929
went on break we already use we can do
this

363
00:23:06,929 --> 00:23:11,010
the XML some entity and but its is that
so

364
00:23:11,010 --> 00:23:14,350
when it come on external entity

365
00:23:14,350 --> 00:23:17,970
so look like look at this it's like a

366
00:23:17,970 --> 00:23:22,919
I response from there SAP portal is a
typical response

367
00:23:22,919 --> 00:23:26,919
when you for example click on their
portal menu

368
00:23:26,919 --> 00:23:30,750
to get this stuff what the hell is set
when we when the first year

369
00:23:30,750 --> 00:23:33,820
found this though it was like 100th

370
00:23:33,820 --> 00:23:37,330
up parameters in the request

371
00:23:37,330 --> 00:23:40,750
as the totally crazy so we were looking
at that and we

372
00:23:40,750 --> 00:23:43,909
can't understand anything so it's like a
missus

373
00:23:43,909 --> 00:23:47,090
then this ABC if API

374
00:23:47,090 --> 00:23:50,260
so than that how it works though it's
like

375
00:23:50,260 --> 00:23:53,850
to to go to the next page you need to
see

376
00:23:53,850 --> 00:23:57,679
sand the 100 parameters

377
00:23:57,679 --> 00:24:01,750
and was different crazy stuff and

378
00:24:01,750 --> 00:24:05,730
well we were analyzing this we found
interesting things like

379
00:24:05,730 --> 00:24:09,130
XML version so one of

380
00:24:09,130 --> 00:24:13,220
those 100 parameters is executive there

381
00:24:13,220 --> 00:24:16,370
XML file it's like

382
00:24:16,370 --> 00:24:20,200
XML in the parameter and was so

383
00:24:20,200 --> 00:24:23,299
different parameters they that a contain

384
00:24:23,299 --> 00:24:27,370
some kind of our Java classes

385
00:24:27,370 --> 00:24:30,830
so it's like the crazy where thing so

386
00:24:30,830 --> 00:24:33,860
are yep I'll

387
00:24:33,860 --> 00:24:37,380
we worst successfully I exploit this

388
00:24:37,380 --> 00:24:41,870
XML with using their exits you will not
have unity a

389
00:24:41,870 --> 00:24:45,350
the the problem was that is like error
based

390
00:24:45,350 --> 00:24:48,360
exit yes or I you see like

391
00:24:48,360 --> 00:24:52,010
can't restore the text a deal with blah
blah blah and

392
00:24:52,010 --> 00:24:55,140
here's the

393
00:24:55,140 --> 00:24:59,779
source of the all the file

394
00:24:59,779 --> 00:25:03,490
okay so now we can a read any kinda
files

395
00:25:03,490 --> 00:25:08,919
and bus course the

396
00:25:08,919 --> 00:25:12,190
your other password stored in this file
an

397
00:25:12,190 --> 00:25:15,760
with a thought this is the cook
configuration sorry this configuration

398
00:25:15,760 --> 00:25:16,740
file

399
00:25:16,740 --> 00:25:19,990
I security file with the keyfile so

400
00:25:19,990 --> 00:25:23,299
and security file looks like this I

401
00:25:23,299 --> 00:25:26,510
we have a some kind of

402
00:25:26,510 --> 00:25:30,049
passport which is equipped with

403
00:25:30,049 --> 00:25:33,360
and we have the

404
00:25:33,360 --> 00:25:38,679
thats access to the key

405
00:25:38,679 --> 00:25:41,909
over here easily to create this using
the

406
00:25:41,909 --> 00:25:45,470
the algorithm which is death down the
key in the passport

407
00:25:45,470 --> 00:25:49,539
an then we can get access to the

408
00:25:49,539 --> 00:25:52,730
j2ee like in and password

409
00:25:52,730 --> 00:25:55,809
and get access to the whole SAP portal

410
00:25:55,809 --> 00:26:00,279
and okay so what about the

411
00:26:00,279 --> 00:26:03,909
of exploitation what you can do then

412
00:26:03,909 --> 00:26:10,309
and how many of you know what sets
Somerset request forgery

413
00:26:10,309 --> 00:26:13,380
really school okay

414
00:26:13,380 --> 00:26:16,380
a so it's like

415
00:26:16,380 --> 00:26:19,659
though kind of attack which we were
presenting

416
00:26:19,659 --> 00:26:23,440
in the previous work but so let's
suppose we

417
00:26:23,440 --> 00:26:27,570
you you have the port of service which
can be accessed

418
00:26:27,570 --> 00:26:31,460
I for everybody then you have a firewall

419
00:26:31,460 --> 00:26:35,409
and then you have some kind of European
system or any think other

420
00:26:35,409 --> 00:26:38,950
am You Can Dance access to this system
because

421
00:26:38,950 --> 00:26:42,309
it's on at the firehall but the ortho

422
00:26:42,309 --> 00:26:46,649
can get access to the system because
they need to somehow interrupt

423
00:26:46,649 --> 00:26:49,840
with each other both this so

424
00:26:49,840 --> 00:26:53,100
a research request forgery it's like the
idea of this

425
00:26:53,100 --> 00:26:56,809
is to find some kind of service

426
00:26:56,809 --> 00:27:01,190
ice lucky though it to find some kind of
Service here.

427
00:27:01,190 --> 00:27:05,299
which we'll transmits your request to
this service

428
00:27:05,299 --> 00:27:09,100
at maybe not all request maybe just
Potter request

429
00:27:09,100 --> 00:27:12,929
and maybe with some modifications but

430
00:27:12,929 --> 00:27:16,909
they dislike this am yet the

431
00:27:16,909 --> 00:27:20,840
the hard to think is too to find this
terrorist

432
00:27:20,840 --> 00:27:24,580
and no details can be found in the

433
00:27:24,580 --> 00:27:28,130
our play cut talk with begin falsely

434
00:27:28,130 --> 00:27:32,320
a you can use them xx you have on their
ability

435
00:27:32,320 --> 00:27:36,929
I worry in there XML external entity
again

436
00:27:36,929 --> 00:27:41,649
call the ace to be a you can make the SP
request

437
00:27:41,649 --> 00:27:45,529
to the other services like to internal
network

438
00:27:45,529 --> 00:27:48,750
arbatov be found at there is a

439
00:27:48,750 --> 00:27:52,110
golfer am this

440
00:27:52,110 --> 00:27:56,320
pretty old protocol and

441
00:27:56,320 --> 00:27:59,539
yes so you think this protocol you can
send

442
00:27:59,539 --> 00:28:04,059
any I every occasion level request so
you construct

443
00:28:04,059 --> 00:28:07,779
a so everything cue points a after this

444
00:28:07,779 --> 00:28:10,880
flash its

445
00:28:10,880 --> 00:28:14,059
is like the

446
00:28:14,059 --> 00:28:19,539
its application going to start the
application level bakit

447
00:28:19,539 --> 00:28:23,970
I because if you if you make their HTTP
request

448
00:28:23,970 --> 00:28:28,299
it's like it it automatically make that
gets and then the

449
00:28:28,299 --> 00:28:32,330
a string that you you you do but the few
years ago for

450
00:28:32,330 --> 00:28:35,710
so all the like to put a

451
00:28:35,710 --> 00:28:38,990
and its and their application to go back
it was a a

452
00:28:38,990 --> 00:28:42,110
so you can trust me to every year

453
00:28:42,110 --> 00:28:45,139
exploit through the Gopher

454
00:28:45,139 --> 00:28:48,679
protocol folk and any application though

455
00:28:48,679 --> 00:28:51,820
so you can exploit the different
operation system whatever it is they're

456
00:28:51,820 --> 00:28:55,010
SEP vulnerabilities then the

457
00:28:55,010 --> 00:28:58,539
yet you can even bypass different SB

458
00:28:58,539 --> 00:29:01,870
restrictions and what's more just think
you can a

459
00:29:01,870 --> 00:29:05,610
exploit the local hospital motivated so
if you have the service on the local

460
00:29:05,610 --> 00:29:06,590
host

461
00:29:06,590 --> 00:29:09,960
which is which can be accessed remotely

462
00:29:09,960 --> 00:29:14,309
you you can't send the XML beckett's
with the

463
00:29:14,309 --> 00:29:18,010
the car for call to the internal IP

464
00:29:18,010 --> 00:29:22,730
local host IP address and local hotspot
and usually the local host service to

465
00:29:22,730 --> 00:29:23,470
start

466
00:29:23,470 --> 00:29:29,330
not so secure like I remote services

467
00:29:29,330 --> 00:29:34,760
arm yet am the next boss exportation
it's very funny

468
00:29:34,760 --> 00:29:38,690
so there is a college management that
there is a functionality to source

469
00:29:38,690 --> 00:29:42,250
in this college management and if you
put some kind of passport

470
00:29:42,250 --> 00:29:46,279
in this search you can find a lot of
interesting information

471
00:29:46,279 --> 00:29:50,620
and documents containing the bus which
in such a miss you know that the portal

472
00:29:50,620 --> 00:29:52,460
is like that

473
00:29:52,460 --> 00:29:56,399
the the key for all the infrastructure
also everybody is

474
00:29:56,399 --> 00:29:59,669
its it's for for storing documents

475
00:29:59,669 --> 00:30:03,029
so everybody storing all the documents
in SAP portal

476
00:30:03,029 --> 00:30:07,080
so it means that you can find a kinda
for interesting sank like a

477
00:30:07,080 --> 00:30:10,149
you can search for the confidential

478
00:30:10,149 --> 00:30:13,669
documents like like this and

479
00:30:13,669 --> 00:30:17,029
yet if you find some kind of passports
you can a

480
00:30:17,029 --> 00:30:22,000
I use the the SRF was a gopher

481
00:30:22,000 --> 00:30:25,289
to connectors as some kind of internal
services

482
00:30:25,289 --> 00:30:28,639
so you don't even need to a get

483
00:30:28,639 --> 00:30:32,389
access to the operation system of
support I'll in style for some kind of

484
00:30:32,389 --> 00:30:33,059
shale

485
00:30:33,059 --> 00:30:36,320
and make a next step

486
00:30:36,320 --> 00:30:40,210
you can do every kind of malicious
activities through the portal without

487
00:30:40,210 --> 00:30:41,970
installing anything on it

488
00:30:41,970 --> 00:30:46,830
so it's where is still see a a attack

489
00:30:46,830 --> 00:30:50,370
up so scanner

490
00:30:50,370 --> 00:30:54,980
I finished a for live faster than should
be but

491
00:30:54,980 --> 00:30:58,169
so yes those it was possible the

492
00:30:58,169 --> 00:31:01,169
it's possible to secure their CPU

493
00:31:01,169 --> 00:31:05,250
system I and recipes working on this
area

494
00:31:05,250 --> 00:31:09,730
and we're helping them are but but
nowadays it's like the

495
00:31:09,730 --> 00:31:14,149
more on the customer side so customers
should implement the budget

496
00:31:14,149 --> 00:31:18,870
because what we see is like SEP became
more and more secure about

497
00:31:18,870 --> 00:31:22,929
a in there cooperate implementations
with steel

498
00:31:22,929 --> 00:31:26,759
see their systems like more forest at
five years to go and

499
00:31:26,759 --> 00:31:31,350
resist stupid vulnerabilities and

500
00:31:31,350 --> 00:31:34,669
one most think like

501
00:31:34,669 --> 00:31:38,080
everybody we're asking the one question

502
00:31:38,080 --> 00:31:42,690
I how many real attacks on the CP system

503
00:31:42,690 --> 00:31:46,429
you see was the main question of
everybody because

504
00:31:46,429 --> 00:31:50,240
yeah we can speak about this a the loth
parts

505
00:31:50,240 --> 00:31:55,070
was a real threat and think it's a

506
00:31:55,070 --> 00:31:58,419
three days ago there wasn't

507
00:31:58,419 --> 00:32:02,110
there's news like they own the most a
quote the great

508
00:32:02,110 --> 00:32:05,230
final see so yet at

509
00:32:05,230 --> 00:32:09,139
usually I don't put this kind of lights
on by presentation like

510
00:32:09,139 --> 00:32:12,639
and people do but is like the first the

511
00:32:12,639 --> 00:32:16,100
attack using their their DNS is in SAP
system

512
00:32:16,100 --> 00:32:20,000
so that Amos a that they have this year
they for SAP

513
00:32:20,000 --> 00:32:23,669
and they use it for exploited the Greek
financement

514
00:32:23,669 --> 00:32:27,740
ministry and they exposed I love
critical data

515
00:32:27,740 --> 00:32:30,820
is in passports and the documents

516
00:32:30,820 --> 00:32:35,490
so is that example of the the first real
attack

517
00:32:35,490 --> 00:32:38,929
on the SAP system so

518
00:32:38,929 --> 00:32:42,309
I don't know it and the pink is they
have this exploit

519
00:32:42,309 --> 00:32:46,039
so they can use it on the other systems

520
00:32:46,039 --> 00:32:50,320
and yes now the house arrest

521
00:32:50,320 --> 00:32:53,750
there are threats an

522
00:32:53,750 --> 00:32:57,049
if you're interested in the more
presentation about the

523
00:32:57,049 --> 00:33:00,590
SEP a system vulnerabilities and also

524
00:33:00,590 --> 00:33:05,500
other things I we will be speaking in
those presentations and we also organize

525
00:33:05,500 --> 00:33:07,750
a conference which calls you a nice

526
00:33:07,750 --> 00:33:12,009
will be in Russian November it's pretty
interesting call france was a lot of

527
00:33:12,009 --> 00:33:16,490
Gould people hardcore

528
00:33:16,490 --> 00:33:22,940
of and yeah think everybody if you have
for any questions style

529
00:33:22,940 --> 00:33:23,399
up for them

