1
00:00:05,740 --> 00:00:08,520
okay so talk on

2
00:00:08,520 --> 00:00:12,070
member tracing which is a bit loosely
speaking about

3
00:00:12,070 --> 00:00:15,790
singer time component to member
forensics I

4
00:00:15,790 --> 00:00:20,260
this is joint work with David last
Dominic Fisher talk today we begin by I

5
00:00:20,260 --> 00:00:21,310
Dominic myself

6
00:00:21,310 --> 00:00:25,950
so the first like to introduce the idea
of what

7
00:00:25,950 --> 00:00:29,380
member Tracy actually is and to those to
this entry

8
00:00:29,380 --> 00:00:34,050
we have a look at this I'm patriot down
below what you see there is some

9
00:00:34,050 --> 00:00:38,110
execute a below which is on this then it
is run

10
00:00:38,110 --> 00:00:42,450
it is a memory and keeps running their
what's running in memory

11
00:00:42,450 --> 00:00:46,610
feel of course its memory will change
like Thursday that it will be modified

12
00:00:46,610 --> 00:00:47,700
to create it

13
00:00:47,700 --> 00:00:51,680
and sometimes even colder be modified if
you have like a.m.

14
00:00:51,680 --> 00:00:55,070
obfuscated code and sometimes go change
is

15
00:00:55,070 --> 00:00:59,300
but is essentially shown by the call as
you see here so

16
00:00:59,300 --> 00:01:02,550
college mean that memory much of this
process is changing

17
00:01:02,550 --> 00:01:06,790
now the ideals member tracey is actually
quite simple

18
00:01:06,790 --> 00:01:10,579
what you see here are these I am red
bars

19
00:01:10,579 --> 00:01:13,590
and each of these red bar stands for and
memory dump

20
00:01:13,590 --> 00:01:16,860
each time you see a red bar I'll

21
00:01:16,860 --> 00:01:21,940
be rights in Cyprus as memory to disk
and since you seen many red bars here

22
00:01:21,940 --> 00:01:25,700
your CV do that better relatively high
frequency I kinda know

23
00:01:25,700 --> 00:01:29,590
20 30 50 times per second I'll

24
00:01:29,590 --> 00:01:33,750
in all these data all these memory dumps
or snapshots as you call them as well

25
00:01:33,750 --> 00:01:37,650
are written to disk which yields you to
manage data

26
00:01:37,650 --> 00:01:41,000
that they Dyson analyzed offline to

27
00:01:41,000 --> 00:01:44,560
understand what these execute what he
was doing with

28
00:01:44,560 --> 00:01:50,619
so it's kind of a reverse engineering
technique out that the halftime

29
00:01:50,619 --> 00:01:53,710
come up with great

30
00:01:53,710 --> 00:01:58,490
so super probably heard of at this
member friends ex I mean what you see

31
00:01:58,490 --> 00:02:01,360
here to take member snapshot so it's
kind of a member technique

32
00:02:01,360 --> 00:02:04,409
and there are traditional techniques
which are very popular

33
00:02:04,409 --> 00:02:08,610
certainly heard about volatility in all
the tools which are on

34
00:02:08,610 --> 00:02:11,670
widely used to fine motor in memory

35
00:02:11,670 --> 00:02:15,970
it's very good to to find rootkits

36
00:02:15,970 --> 00:02:19,860
and ex-wife you step

37
00:02:19,860 --> 00:02:23,950
the ID there is similar to ours but it
looks a bit simpler

38
00:02:23,950 --> 00:02:26,980
essentially they only take one snapshot

39
00:02:26,980 --> 00:02:30,010
analyze it afterwards on

40
00:02:30,010 --> 00:02:34,279
to concepts look similar taxes are not a
quite different

41
00:02:34,279 --> 00:02:39,480
because in to dismember forensics you
take snapshots of the whole physical

42
00:02:39,480 --> 00:02:40,209
memory

43
00:02:40,209 --> 00:02:43,909
which means I'm kernel memory as well as
process memory

44
00:02:43,909 --> 00:02:48,019
in memory tracing the focusing on
process easy only take snapshot the

45
00:02:48,019 --> 00:02:48,840
process memory

46
00:02:48,840 --> 00:02:54,829
the focus is different as a consequence
in fact this number Sensex

47
00:02:54,829 --> 00:02:57,879
I'm you get lots of information about
system state like

48
00:02:57,879 --> 00:03:02,019
processes that are running I am letter
connections that are open that separates

49
00:03:02,019 --> 00:03:02,889
et cetera

50
00:03:02,889 --> 00:03:06,409
you get information about coding data

51
00:03:06,409 --> 00:03:12,180
overtime much less what system state
also the application areas of 22

52
00:03:12,180 --> 00:03:16,719
approaches are different and the goal
for this member friends is not as I said

53
00:03:16,719 --> 00:03:17,809
finding mother

54
00:03:17,809 --> 00:03:23,049
in memory and also because engineering
whereas our technique is essentially

55
00:03:23,049 --> 00:03:23,430
about

56
00:03:23,430 --> 00:03:28,279
reverse engineering so in summary these
are two techniques and they're not meant

57
00:03:28,279 --> 00:03:29,069
to compete

58
00:03:29,069 --> 00:03:33,709
they're much more a complimentary okay
so

59
00:03:33,709 --> 00:03:37,109
the next question would be why's it
probably good idea

60
00:03:37,109 --> 00:03:41,409
to dismember tracing what's the value
their and I'd like to give you some

61
00:03:41,409 --> 00:03:43,879
increase now issue much more details
later on

62
00:03:43,879 --> 00:03:47,859
doing to talk of course so the intuition
is the first increase in is

63
00:03:47,859 --> 00:03:52,230
you get so much data that must be
something good in their free throws

64
00:03:52,230 --> 00:03:54,879
engineering for finding interesting data
structures

65
00:03:54,879 --> 00:03:58,589
to and disassemble date that kill coat
etcetera

66
00:03:58,589 --> 00:04:01,629
that's the gut feeling lots on for it
lots of information

67
00:04:01,629 --> 00:04:05,139
must be useful but it can be also

68
00:04:05,139 --> 00:04:08,370
be a bit more criticize actually I'm

69
00:04:08,370 --> 00:04:11,489
there's lots of data and coding memory

70
00:04:11,489 --> 00:04:14,620
which is transient transient means

71
00:04:14,620 --> 00:04:17,660
if the piercing memory and disappears
again

72
00:04:17,660 --> 00:04:20,930
right so for instance what you could
have here

73
00:04:20,930 --> 00:04:24,190
I'm you could have a

74
00:04:24,190 --> 00:04:27,600
encrypt the texting memory some

75
00:04:27,600 --> 00:04:31,960
moment in time for the cryptids then the
Buffalo busy road out again and

76
00:04:31,960 --> 00:04:32,910
disappears again

77
00:04:32,910 --> 00:04:36,530
by this of course the hope in memory
tracing

78
00:04:36,530 --> 00:04:40,930
if you take snapshots at high frequency
we will get also trends in data which

79
00:04:40,930 --> 00:04:42,170
can be very valuable

80
00:04:42,170 --> 00:04:46,030
that's the it's certainly a

81
00:04:46,030 --> 00:04:50,120
strength of this technique it but does
not only applied to data

82
00:04:50,120 --> 00:04:53,880
go supply so called because I'm
certainly effort that's many of those

83
00:04:53,880 --> 00:04:54,270
cases

84
00:04:54,270 --> 00:04:59,920
techniques also encrypt go to the crib
that from time et cetera

85
00:04:59,920 --> 00:05:03,750
and relate to see also in this talk we
can do even more

86
00:05:03,750 --> 00:05:06,900
I am you will see that we can automate

87
00:05:06,900 --> 00:05:11,210
some aspects of of reverse engineering
uses traces

88
00:05:11,210 --> 00:05:14,420
and also sink which is quite valuable is

89
00:05:14,420 --> 00:05:18,090
we can guide the Middle East interesting
code and data parts

90
00:05:18,090 --> 00:05:21,220
by automatically analyzing certain
aspects you can say look you

91
00:05:21,220 --> 00:05:25,710
use interesting coat look at this in
more detail

92
00:05:25,710 --> 00:05:29,520
okay it was the basic idea so

93
00:05:29,520 --> 00:05:34,410
you have a brief morphosis you how to
such a system look like

94
00:05:34,410 --> 00:05:38,420
I am it's much like any other a dynamic
analysis system

95
00:05:38,420 --> 00:05:43,970
like mother sandboxes that these as
follows: you have here now this machine

96
00:05:43,970 --> 00:05:48,340
which contain some america's Ishant
module which is colonel

97
00:05:48,340 --> 00:05:51,440
component then you take amal there
already are

98
00:05:51,440 --> 00:05:54,870
any other execute will you want to
analyze

99
00:05:54,870 --> 00:05:58,100
read on the machine executed right

100
00:05:58,100 --> 00:06:02,760
and to keep it running for a no four
five six seven minutes

101
00:06:02,760 --> 00:06:07,700
and during execution it will I'm collect
always member data is never snapshots

102
00:06:07,700 --> 00:06:09,270
right into this

103
00:06:09,270 --> 00:06:13,830
we also collect some meta data go talk
about that with a true

104
00:06:13,830 --> 00:06:17,030
and then the analyst with some
appropriate tools

105
00:06:17,030 --> 00:06:20,180
scripts tools whatever to analyze these
data

106
00:06:20,180 --> 00:06:24,350
understand what mother is doing so the
whole system is about two components

107
00:06:24,350 --> 00:06:25,130
actually

108
00:06:25,130 --> 00:06:31,010
one is is because Asian here and the
other is analysis tools there

109
00:06:31,010 --> 00:06:34,320
and I'm this pretty much kisses
structure for the stalkers well on the

110
00:06:34,320 --> 00:06:36,780
first going to talk about member
acquisition

111
00:06:36,780 --> 00:06:40,800
how it's done some basic eighties then
be going to go over to the house is

112
00:06:40,800 --> 00:06:41,370
tools

113
00:06:41,370 --> 00:06:46,040
however could what they do and we gotta
have a case study in announcing

114
00:06:46,040 --> 00:06:49,270
analyzing a zulus at the banking Trojan

115
00:06:49,270 --> 00:06:52,280
using our tools to be a fairly a long
time

116
00:06:52,280 --> 00:06:55,410
actual

117
00:06:55,410 --> 00:06:59,830
okay some I am more verse about
acquisition

118
00:06:59,830 --> 00:07:04,150
so what's do we actually track which
process that we track

119
00:07:04,150 --> 00:07:08,060
and don't want two of them only certain
processes

120
00:07:08,060 --> 00:07:11,320
and actually be tracked processes which
get started

121
00:07:11,320 --> 00:07:15,970
after the acquisition engine has started
so any new process will be tracked

122
00:07:15,970 --> 00:07:20,520
and also processes that get an injection
for the track process

123
00:07:20,520 --> 00:07:24,310
see that in the picture below so sue me
RAM

124
00:07:24,310 --> 00:07:28,610
opposition model is running and mother
to XE process wills

125
00:07:28,610 --> 00:07:31,710
started later on and does its track
threat

126
00:07:31,710 --> 00:07:34,900
same for drop it off sexy also tracked

127
00:07:34,900 --> 00:07:37,980
and then 4.6 even receive an
eight-member injection from moment one

128
00:07:37,980 --> 00:07:39,590
of these processes

129
00:07:39,590 --> 00:07:43,840
disparate differ also tracked and the
process bardot sexy

130
00:07:43,840 --> 00:07:49,070
probably got started before we started
acquisition it's not being tracked

131
00:07:49,070 --> 00:07:52,230
okay so this is the process is your
tracking

132
00:07:52,230 --> 00:07:56,970
next question is when do we write those
snapshots that this

133
00:07:56,970 --> 00:08:00,310
and to this end we have triggers expand
trigger fires

134
00:08:00,310 --> 00:08:05,220
processes dumped and triggers currently
are a set of system calls

135
00:08:05,220 --> 00:08:09,980
I miss you can be configured to the file
and each time attract process

136
00:08:09,980 --> 00:08:13,740
calls one of the system calls its pro
its members dumps to disk

137
00:08:13,740 --> 00:08:17,460
way and how's it done

138
00:08:17,460 --> 00:08:22,910
I just very quickly essentially the
position engine is a

139
00:08:22,910 --> 00:08:27,220
girl components which I'm will intercept
system calls

140
00:08:27,220 --> 00:08:30,450
and see if comes from processed
distracting

141
00:08:30,450 --> 00:08:33,630
and I'm whether it's a system call
that's the triggers

142
00:08:33,630 --> 00:08:37,599
if so too right scan member invited to
this

143
00:08:37,599 --> 00:08:40,740
the whole system currently is
implemented for being those a

144
00:08:40,740 --> 00:08:45,070
XP soaking

145
00:08:45,070 --> 00:08:49,490
I mention that Sri also record meta-data
not just his memory traces although the

146
00:08:49,490 --> 00:08:50,430
member traces are

147
00:08:50,430 --> 00:08:53,689
and new concept here but we need me the
data

148
00:08:53,689 --> 00:08:57,610
for different reasons so make the data
can be like

149
00:08:57,610 --> 00:09:01,839
system calls me be really I record all
system calls also

150
00:09:01,839 --> 00:09:05,139
those that don't fire I was that
something engine

151
00:09:05,139 --> 00:09:08,180
we also record some events like process
start

152
00:09:08,180 --> 00:09:12,860
exit its load subject injections that's
it for today

153
00:09:12,860 --> 00:09:16,120
and the reason I think if you increase
in why that's important

154
00:09:16,120 --> 00:09:20,829
so issue my arm you have a process that
has some

155
00:09:20,829 --> 00:09:23,959
plain text in memory encrypts thats

156
00:09:23,959 --> 00:09:27,259
plain text and Tristyn cryptids cipher
text

157
00:09:27,259 --> 00:09:31,069
that's great now you wanna searching all
those members snapshots that there were

158
00:09:31,069 --> 00:09:34,829
traces on a search for plane tix because
that's interesting of course

159
00:09:34,829 --> 00:09:38,740
so one search strategy would be of
course to do some entropy analysis

160
00:09:38,740 --> 00:09:41,870
exe it's a good idea which will help we
don't

161
00:09:41,870 --> 00:09:45,660
you gonna get probably lots of hits okay
you see lots of snapshots memory since

162
00:09:45,660 --> 00:09:47,379
the current rupee

163
00:09:47,379 --> 00:09:51,110
now to be I able to refine your search

164
00:09:51,110 --> 00:09:54,430
it would be good to know when actually

165
00:09:54,430 --> 00:09:57,720
al Faisal written to disk for thats

166
00:09:57,720 --> 00:10:02,100
and recording system calls all system
calls is quite useful because then you

167
00:10:02,100 --> 00:10:05,490
only have to search right before right
operations right

168
00:10:05,490 --> 00:10:09,019
which which makes a search much more
efficient and sometimes only

169
00:10:09,019 --> 00:10:12,470
Island feasible actually okay

170
00:10:12,470 --> 00:10:16,290
here's some more details about the
triggering

171
00:10:16,290 --> 00:10:19,670
thats a very simple this is the
configuration file

172
00:10:19,670 --> 00:10:23,149
have used forum analyzing Zeus

173
00:10:23,149 --> 00:10:27,240
and have actually to kind of triggers
before after triggers

174
00:10:27,240 --> 00:10:31,949
so we see you for instance the the
system call in to create key

175
00:10:31,949 --> 00:10:35,430
is a trigger and its before triggers
that means

176
00:10:35,430 --> 00:10:40,410
when that schools before its code is
executed you take steps

177
00:10:40,410 --> 00:10:45,089
and and ask trigger here for anti
allocate virtual memory

178
00:10:45,089 --> 00:10:48,879
I with fire when the system called
returns from its icky

179
00:10:48,879 --> 00:10:52,259
execution Bay sometimes good to have
members before to call

180
00:10:52,259 --> 00:10:56,079
execute some time afterwards that steady

181
00:10:56,079 --> 00:10:59,579
the choice of triggers is crucial of
course if you have

182
00:10:59,579 --> 00:11:02,720
too few triggers you won't get enough
snapshots

183
00:11:02,720 --> 00:11:06,529
you miss probably the interesting
information you're looking for rights

184
00:11:06,529 --> 00:11:11,259
I yourself to choose latest too few
would also have to choose the right ones

185
00:11:11,259 --> 00:11:15,490
and the everything the naive I am

186
00:11:15,490 --> 00:11:19,079
idea would be of course the trigger ever
see so we get everything

187
00:11:19,079 --> 00:11:22,160
but that's not possible for performance
reasons if he would trigger for all

188
00:11:22,160 --> 00:11:24,550
system calls that the system will die
down

189
00:11:24,550 --> 00:11:27,660
so you have to find a good mix not too
few not too many

190
00:11:27,660 --> 00:11:32,240
and the right months and that's better
playing around

191
00:11:32,240 --> 00:11:36,230
K and some properties about this

192
00:11:36,230 --> 00:11:40,249
acquisition component I would like to
point out it's really stable

193
00:11:40,249 --> 00:11:44,389
it's not just them some resort act that
works like every other day

194
00:11:44,389 --> 00:11:47,579
a is tested it with many thousand
samples

195
00:11:47,579 --> 00:11:51,290
must testing and we can really say for X
really I'm

196
00:11:51,290 --> 00:11:55,999
I reliability and also looked briefly
fits Telsey

197
00:11:55,999 --> 00:12:00,300
I mean some whether it's detected by
Malter I mean some other texts

198
00:12:00,300 --> 00:12:03,329
I'm such components and stops working

199
00:12:03,329 --> 00:12:06,339
you had some samples which were packed
with our with a lot to me that said

200
00:12:06,339 --> 00:12:08,079
throughout a popular Packers for

201
00:12:08,079 --> 00:12:12,759
or and analysis its and it looks like
everything's pretty fine so that no

202
00:12:12,759 --> 00:12:13,319
problem there

203
00:12:13,319 --> 00:12:17,240
current it doesn't mean of course that

204
00:12:17,240 --> 00:12:22,100
components not detectable it's real have
a performance on

205
00:12:22,100 --> 00:12:25,529
it's really too performance overhead and
if you do timing attack

206
00:12:25,529 --> 00:12:29,869
you measure a lower price mistake you
will find out that it's

207
00:12:29,869 --> 00:12:33,259
being tracked but that's the same
problem for all these do not think I may

208
00:12:33,259 --> 00:12:33,949
come

209
00:12:33,949 --> 00:12:38,670
now so systems through virtual
performance

210
00:12:38,670 --> 00:12:42,279
Sega pretty happy performance
performances although

211
00:12:42,279 --> 00:12:45,480
although Cooper from this complex on
stands are many

212
00:12:45,480 --> 00:12:49,550
permit this that I'm that guy's the
performance so

213
00:12:49,550 --> 00:12:52,889
crew of course someone is the triggers
having things you have

214
00:12:52,889 --> 00:12:57,300
it's a very few triggers like two or
three I we can even Burke interactively

215
00:12:57,300 --> 00:12:57,990
the machine

216
00:12:57,990 --> 00:13:01,769
so we manage to load Internet Explorer
which is help process

217
00:13:01,769 --> 00:13:06,249
and play around with it of course it's a
bit slow down the group

218
00:13:06,249 --> 00:13:11,379
if you have lots of triggers like anger
site before system will slow down

219
00:13:11,379 --> 00:13:14,470
it's less interactive or almost
non-interactive

220
00:13:14,470 --> 00:13:17,759
but this still get the data we want to
have so in

221
00:13:17,759 --> 00:13:23,869
any cases use this tool it worked

222
00:13:23,869 --> 00:13:28,779
may be very briefly on challenges fights
hard to implement this

223
00:13:28,779 --> 00:13:31,910
on different days has acted on by their
it was not your today's

224
00:13:31,910 --> 00:13:35,389
curtain guru but the

225
00:13:35,389 --> 00:13:38,899
key and challenges valuable like so you
can

226
00:13:38,899 --> 00:13:42,439
remember much fast and compact disc
which make local

227
00:13:42,439 --> 00:13:45,769
the whole process that's cause a problem

228
00:13:45,769 --> 00:13:51,499
and the solution strategy strategy is
I'll ever simple of course

229
00:13:51,499 --> 00:13:55,259
I'm to avoid those problems you try to
minimize they tell you right

230
00:13:55,259 --> 00:13:59,100
this course the first place and in
second place

231
00:13:59,100 --> 00:14:03,540
I'm try to maximize output forms

232
00:14:03,540 --> 00:14:06,730
thats have done so to minimize the
DataView have done

233
00:14:06,730 --> 00:14:10,610
member that duplication which means the
only right pages that change between

234
00:14:10,610 --> 00:14:12,259
snapshots

235
00:14:12,259 --> 00:14:17,309
its you okay that's quite an optimized
implementation because speed mothers

236
00:14:17,309 --> 00:14:22,850
and four II you i'm for the output thing
david has implemented some I'm

237
00:14:22,850 --> 00:14:28,889
I'm specific output component which is
you're talking or something

238
00:14:28,889 --> 00:14:33,360
okay so we move on now to in the house
is parked which will be

239
00:14:33,360 --> 00:14:36,519
sent by Dominique

240
00:14:36,519 --> 00:14:40,249
thanks Andrew for going with those
through the process of getting memory

241
00:14:40,249 --> 00:14:41,129
trace some

242
00:14:41,129 --> 00:14:44,739
traces of specific applications

243
00:14:44,739 --> 00:14:51,149
an in our own analyzes we got memory
traces sized up to 1 pick up 80 for all

244
00:14:51,149 --> 00:14:51,480
day

245
00:14:51,480 --> 00:14:55,579
top and what we can do next how can be
fined into race

246
00:14:55,579 --> 00:14:58,809
interesting code and data and gain

247
00:14:58,809 --> 00:15:03,069
other insights on behavior how can we do
that

248
00:15:03,069 --> 00:15:06,129
and the first answer to that question is

249
00:15:06,129 --> 00:15:10,350
with all the station we sold about that
the human eye can detect

250
00:15:10,350 --> 00:15:14,540
alum anomalies and patterns enough fast
way

251
00:15:14,540 --> 00:15:18,369
so we tried realization we came up with

252
00:15:18,369 --> 00:15:23,160
essentially to graphs the first one is
shown on this lie to you

253
00:15:23,160 --> 00:15:26,939
it shows us nicely to running processes
and the running threats

254
00:15:26,939 --> 00:15:31,019
within this memory trace you can see
here

255
00:15:31,019 --> 00:15:34,559
the work equal line indicating that
there is to start

256
00:15:34,559 --> 00:15:37,689
of the memory trace and again here is
stir

257
00:15:37,689 --> 00:15:41,119
and where we stopped the to record

258
00:15:41,119 --> 00:15:46,839
and those white boxes 3p sense to
processes with the pro society and to

259
00:15:46,839 --> 00:15:48,269
process tittle

260
00:15:48,269 --> 00:15:52,549
title and does process boxes are
connected with

261
00:15:52,549 --> 00:15:56,139
a row with black arose if the

262
00:15:56,139 --> 00:15:59,319
opera process is a par in process softer

263
00:15:59,319 --> 00:16:05,559
lower one an then in does process pokes
you have 20 sparse here

264
00:16:05,559 --> 00:16:09,619
that are threats the red threats are
injected from

265
00:16:09,619 --> 00:16:13,139
all the processes or the origin of those

266
00:16:13,139 --> 00:16:16,369
threat is from an unchecked that process

267
00:16:16,369 --> 00:16:19,829
from injected threat so this threat here

268
00:16:19,829 --> 00:16:22,939
Colts injected from another process

269
00:16:22,939 --> 00:16:27,519
and this right here call started from an
interactive process

270
00:16:27,519 --> 00:16:30,639
essentially we see here to explore
explore

271
00:16:30,639 --> 00:16:34,189
starts our malicious software the bot

272
00:16:34,189 --> 00:16:38,999
right here and this box then starts to
know other processes

273
00:16:38,999 --> 00:16:43,119
one with randomly name a.m. which Tulsa
some

274
00:16:43,119 --> 00:16:46,709
thread injections and then though
leather one

275
00:16:46,709 --> 00:16:51,069
is the Windows comment program here
which God except you

276
00:16:51,069 --> 00:16:56,259
executed some time later

277
00:16:56,259 --> 00:17:01,350
where us the first graph showed us Mar
Morneau love you and help us to navigate

278
00:17:01,350 --> 00:17:01,929
through

279
00:17:01,929 --> 00:17:05,500
this detail view we came up with the
memory view

280
00:17:05,500 --> 00:17:08,599
which shows us X actly when we do

281
00:17:08,600 --> 00:17:13,250
or all recorded snapshots it's for one
process

282
00:17:13,250 --> 00:17:18,020
your its just a an extract of the whole
graph of one process

283
00:17:18,020 --> 00:17:21,160
you see the sna the snapshots the in a
frontal

284
00:17:21,160 --> 00:17:24,339
chronological order from left to right

285
00:17:24,339 --> 00:17:27,350
and each of those snapshots the mean

286
00:17:27,350 --> 00:17:31,500
memory regions or and arranged
accordingly to its work to address

287
00:17:31,500 --> 00:17:34,640
from of two down be used callers to

288
00:17:34,640 --> 00:17:37,880
called so much tributes of the memory
chance for example

289
00:17:37,880 --> 00:17:41,630
Aldrete rectangles here are execute
herbal

290
00:17:41,630 --> 00:17:47,360
memory regions and just to give you an
impression home much data is this

291
00:17:47,360 --> 00:17:53,670
here this small rectangle here often
execute double memory region

292
00:17:53,670 --> 00:17:56,720
is about 100 feel about its large if you
will

293
00:17:56,720 --> 00:18:01,230
converts that binary data into texas
will be about 20

294
00:18:01,230 --> 00:18:05,760
page long so you can imagine how many

295
00:18:05,760 --> 00:18:09,830
page this will be if we will collect it
and text on

296
00:18:09,830 --> 00:18:14,200
text con beyond just understood very
fostered and binary code

297
00:18:14,200 --> 00:18:20,150
so this is a huge amount of data you

298
00:18:20,150 --> 00:18:24,370
so essentially the last graph showed us
that

299
00:18:24,370 --> 00:18:28,610
there is a need for a photo processing
step between the role that though

300
00:18:28,610 --> 00:18:32,220
and still easily sation so we came up
with

301
00:18:32,220 --> 00:18:35,870
a.m. a few relatively simple bot

302
00:18:35,870 --> 00:18:40,660
they have proven to be quite useful
scripts here is a list of a few of them

303
00:18:40,660 --> 00:18:44,540
we will explain them briefly in the
coming slights

304
00:18:44,540 --> 00:18:50,170
and all of those scripts word and used
in hours Houston

305
00:18:50,170 --> 00:18:53,410
and all of those scripts produces

306
00:18:53,410 --> 00:18:56,730
results which we can which allies 10

307
00:18:56,730 --> 00:19:02,880
in one of the previously shows graphs

308
00:19:02,880 --> 00:19:06,060
yes oh one of the scripts is about
finding self belief I coach so

309
00:19:06,060 --> 00:19:07,580
qualifying code

310
00:19:07,580 --> 00:19:11,620
so so funny fine code is a obfuscation
techniques that means croat

311
00:19:11,620 --> 00:19:15,730
change its form during execution
typically

312
00:19:15,730 --> 00:19:19,830
what is he often is some code is encrypt
it before execution

313
00:19:19,830 --> 00:19:22,990
and it started there's a song small the
crips and stop

314
00:19:22,990 --> 00:19:27,610
with the cryptic wrote like the memory
and then jump the code executed

315
00:19:27,610 --> 00:19:30,840
maybe a reason a raise it again or
encrypt again depends on how

316
00:19:30,840 --> 00:19:31,880
sophisticated

317
00:19:31,880 --> 00:19:35,380
if the state Res it's widely used and
I'm

318
00:19:35,380 --> 00:19:38,910
suppose important to get that code if
it's meant to be hidden

319
00:19:38,910 --> 00:19:42,710
and getting the code is important and
then that works very well with

320
00:19:42,710 --> 00:19:47,410
with the member traces favorite me that
is a simple script that finds

321
00:19:47,410 --> 00:19:50,660
says modifying code I was very good
quality

322
00:19:50,660 --> 00:19:54,850
we really able to tech2 also small

323
00:19:54,850 --> 00:19:58,000
small ranges of self modifying code as
you will see in the

324
00:19:58,000 --> 00:20:02,310
in the demo I'm we surely it's very
simple yet fewer

325
00:20:02,310 --> 00:20:06,140
I'm an excerpt from member review here

326
00:20:06,140 --> 00:20:09,520
if he starts a qualifying colleges
market be by a

327
00:20:09,520 --> 00:20:12,900
black bar so you know UT's right

328
00:20:12,900 --> 00:20:16,090
look at it exported et cetera so that

329
00:20:16,090 --> 00:20:20,040
you also see later on so want the idea
of course is if you have found so far

330
00:20:20,040 --> 00:20:21,050
the fine coat

331
00:20:21,050 --> 00:20:24,380
you export thats to either pro December

332
00:20:24,380 --> 00:20:28,630
look at it no details

333
00:20:28,630 --> 00:20:33,120
the next feature I'd like to explain you
is the most you light listing

334
00:20:33,120 --> 00:20:38,220
and its does exactly that with you
expect from a model white Lister

335
00:20:38,220 --> 00:20:41,500
it generates all loaded modules

336
00:20:41,500 --> 00:20:45,370
like Windows dll's in the snapshot

337
00:20:45,370 --> 00:20:48,370
and then compares its original and

338
00:20:48,370 --> 00:20:52,390
data which the data in the memory into
memory trace

339
00:20:52,390 --> 00:20:56,660
so on the left hand side you see an
extract of the male review

340
00:20:56,660 --> 00:21:00,190
and basically you call to mom malicious
called be everywhere

341
00:21:00,190 --> 00:21:05,360
at least at or in the execute double
memory region so you don't know

342
00:21:05,360 --> 00:21:08,590
where to look at and on the right hand
side

343
00:21:08,590 --> 00:21:11,820
you see now the most you'll whitelist
/url a year

344
00:21:11,820 --> 00:21:17,350
enable it in this memory you and you can
see that there is now here

345
00:21:17,350 --> 00:21:20,360
all green that means that

346
00:21:20,360 --> 00:21:23,470
this is all firm

347
00:21:23,470 --> 00:21:28,440
clean loaded de ellos and you don't need
to look at those memory chins

348
00:21:28,440 --> 00:21:32,080
so their Texas only one redline

349
00:21:32,080 --> 00:21:35,690
now here that's one memory chin which

350
00:21:35,690 --> 00:21:39,050
doesn't belong to one then the lol so

351
00:21:39,050 --> 00:21:42,600
if we are looking for malicious Colt
that will be a star

352
00:21:42,600 --> 00:21:45,620
to look a and we see here also now

353
00:21:45,620 --> 00:21:48,690
that here is loaded the main execute
tubal

354
00:21:48,690 --> 00:21:52,320
so each of one of those is a loaded d
lol

355
00:21:52,320 --> 00:21:57,830
you two main and model whitelisting
helps us also do

356
00:21:57,830 --> 00:22:02,840
sport potential malicious modifications
of crude steel else

357
00:22:02,840 --> 00:22:07,440
we see here 3d Los let's also extract of
the memory view

358
00:22:07,440 --> 00:22:11,400
ac3 de los stacked on top of each other

359
00:22:11,400 --> 00:22:16,140
and they August all-star key is clean

360
00:22:16,140 --> 00:22:19,320
and then that's on time all of them
called modified

361
00:22:19,320 --> 00:22:22,570
you you see that here and

362
00:22:22,570 --> 00:22:25,890
the lowest one even got modified three
times

363
00:22:25,890 --> 00:22:31,820
successively and the nice thing here is
also that you see a certain pattern

364
00:22:31,820 --> 00:22:35,650
and we found out in our analyzes that

365
00:22:35,650 --> 00:22:38,650
for example in C you see that popped
into law

366
00:22:38,650 --> 00:22:42,080
in each process but with

367
00:22:42,080 --> 00:22:45,590
will see that later in the team

368
00:22:45,590 --> 00:22:48,850
and its the next feature is threats
grouping

369
00:22:48,850 --> 00:22:53,370
if a call shortly back to the process
you

370
00:22:53,370 --> 00:22:56,530
UCL all the threats threats injected
threat

371
00:22:56,530 --> 00:23:00,230
all attention potential malicious
threats

372
00:23:00,230 --> 00:23:05,150
and you don't know exactly what they are
doing if they are related to each other

373
00:23:05,150 --> 00:23:09,180
or the do they even the same seeing

374
00:23:09,180 --> 00:23:12,840
so we came up with the threat grouping
feature

375
00:23:12,840 --> 00:23:16,070
and it thus you start if the true if the
threat

376
00:23:16,070 --> 00:23:19,610
has the same goat and also the same

377
00:23:19,610 --> 00:23:25,420
entry point in that go it is the same
threat

378
00:23:25,420 --> 00:23:29,700
and you see it see now delay a.m.

379
00:23:29,700 --> 00:23:32,800
up lights to the process few on the top

380
00:23:32,800 --> 00:23:36,500
it's a one threat starting a couple of
other threats you don't know exactly

381
00:23:36,500 --> 00:23:38,290
what they are doing

382
00:23:38,290 --> 00:23:42,020
and with statler you see now exactly
that

383
00:23:42,020 --> 00:23:45,160
there are only three groups yellow

384
00:23:45,160 --> 00:23:48,770
a gray and agree and if you want to
understand

385
00:23:48,770 --> 00:23:52,140
now does threats you only have to look
at one threat

386
00:23:52,140 --> 00:23:56,070
a group and of course only understand
too cold

387
00:23:56,070 --> 00:24:02,380
underlying the group once

388
00:24:02,380 --> 00:24:06,880
okay a.m.

389
00:24:06,880 --> 00:24:10,830
f's a few more features which are easy
to explain so we have a memory Mac sure

390
00:24:10,830 --> 00:24:14,460
that's like I'm with like a text search
in a text editor

391
00:24:14,460 --> 00:24:17,590
you can input some some

392
00:24:17,590 --> 00:24:21,720
source region and search for it through
all snapshots

393
00:24:21,720 --> 00:24:26,000
I the difference though is that three
don't know exact matching because that's

394
00:24:26,000 --> 00:24:27,850
not so useful sometimes

395
00:24:27,850 --> 00:24:32,450
you some kinda fuzzy matching and that
turns out to be quite useful

396
00:24:32,450 --> 00:24:35,740
what to do then be with allies met you
return so you can say okay

397
00:24:35,740 --> 00:24:39,680
USC something I don't know what it is
police search for that

398
00:24:39,680 --> 00:24:43,160
through all the snapshots marked them
black I feel for you

399
00:24:43,160 --> 00:24:48,080
quite helpful as you see very soon it's
actually help for the photo find code:

400
00:24:48,080 --> 00:24:52,100
called injections are common data used
by processes

401
00:24:52,100 --> 00:24:55,330
the other thing is stacked fact races
I'm

402
00:24:55,330 --> 00:24:58,580
when you have a system call the me look
at stack

403
00:24:58,580 --> 00:25:01,790
can figure out which hearts memory

404
00:25:01,790 --> 00:25:04,960
have been executed that's also quite
useful to see

405
00:25:04,960 --> 00:25:08,300
what parts member actor active which
code is active

406
00:25:08,300 --> 00:25:11,360
it's a bit like with the bombing you
always know what's active right that's

407
00:25:11,360 --> 00:25:13,100
kinda very

408
00:25:13,100 --> 00:25:17,540
he'll be fucking like yeah I'm standing
Records Act

409
00:25:17,540 --> 00:25:20,700
and also very important feature although
simple one is the

410
00:25:20,700 --> 00:25:25,430
I the export so as I said before it's
about finding interesting memory tunes

411
00:25:25,430 --> 00:25:28,960
all things about that then once you have
found a new course need to analyze

412
00:25:28,960 --> 00:25:29,590
Manali

413
00:25:29,590 --> 00:25:32,820
but you can but what you can do then
this exported memory to I don't

414
00:25:32,820 --> 00:25:35,970
have a look at it

415
00:25:35,970 --> 00:25:39,760
okay when so we gonna start the

416
00:25:39,760 --> 00:25:43,980
zulus demo I

417
00:25:43,980 --> 00:25:49,960
its actual recording what I can tell you
it's not fake

418
00:25:49,960 --> 00:25:53,490
it's just for for time reasons

419
00:25:53,490 --> 00:25:57,510
essentially and also because its
resolution of these be was here

420
00:25:57,510 --> 00:26:01,510
I like to price high resolution we have

421
00:26:01,510 --> 00:26:05,330
your just a few words about those I mean
sources

422
00:26:05,330 --> 00:26:08,820
see fairly complex as many
functionalities like they to stealing

423
00:26:08,820 --> 00:26:10,620
injection of HTML

424
00:26:10,620 --> 00:26:15,170
and complication its EC et cetera in
this demo we only

425
00:26:15,170 --> 00:26:19,040
I'm focus on the installation behavior
his first thing that happens when you

426
00:26:19,040 --> 00:26:19,580
get in fact

427
00:26:19,580 --> 00:26:22,900
with sows be you can do more than that

428
00:26:22,900 --> 00:26:28,790
you don't show everything and I'm yeah

429
00:26:28,790 --> 00:26:34,790
so we start of here with the process for
you

430
00:26:34,790 --> 00:26:38,490
and then zoom in a bit and what you see
here

431
00:26:38,490 --> 00:26:43,090
is actually both process that's the best
mother had that's what you want to

432
00:26:43,090 --> 00:26:44,260
analyze

433
00:26:44,260 --> 00:26:48,520
you have taken that and run it in a
system right see actually got started by

434
00:26:48,520 --> 00:26:49,170
explored

435
00:26:49,170 --> 00:26:52,480
sexy is quite usual if you double click
on it

436
00:26:52,480 --> 00:26:57,450
and we also see that there's some child
process started by both the pixie

437
00:26:57,450 --> 00:27:04,370
filter now that's that's both the texas
dropper this year's property

438
00:27:04,370 --> 00:27:07,340
so what you gonna do now is actually
have a bit a closer look at these

439
00:27:07,340 --> 00:27:08,610
processes

440
00:27:08,610 --> 00:27:12,700
sitting here you know list and the
speech over now to memory view

441
00:27:12,700 --> 00:27:15,800
right every really have a look at memory
trace

442
00:27:15,800 --> 00:27:20,070
and what you see here is the memory
trace of I am

443
00:27:20,070 --> 00:27:23,330
well-thought sexy what you see roughly
his

444
00:27:23,330 --> 00:27:27,050
as he said I'm xxx is this time wise
what ru

445
00:27:27,050 --> 00:27:31,010
at this pace what you see here if you
notice face a bit

446
00:27:31,010 --> 00:27:35,360
down here are the lever is which loaders
appears mine execute people

447
00:27:35,360 --> 00:27:39,430
and you at the beginning to see some
loading is going on supply was loaded

448
00:27:39,430 --> 00:27:40,270
into memory

449
00:27:40,270 --> 00:27:43,740
you some allocations were happening over
there were

450
00:27:43,740 --> 00:27:46,800
then if you remain fairly stable over
time at this ground

451
00:27:46,800 --> 00:27:52,240
parity

452
00:27:52,240 --> 00:27:55,540
okay visa with in a bit

453
00:27:55,540 --> 00:27:59,350
first I am

454
00:27:59,350 --> 00:28:03,670
now you also see Power Tool Works

455
00:28:03,670 --> 00:28:06,680
it has been speaking about this and now
these features and each of them is a

456
00:28:06,680 --> 00:28:07,460
visual later

457
00:28:07,460 --> 00:28:10,510
your in this too so we can switch on
some

458
00:28:10,510 --> 00:28:13,710
some of these features and they will
have some visual impact on picture

459
00:28:13,710 --> 00:28:17,150
so you see look now for Vice listing
them like this thing

460
00:28:17,150 --> 00:28:20,150
will be switched on the interviewer

461
00:28:20,150 --> 00:28:23,650
that's what you have done actually why
this is now switched on NBC

462
00:28:23,650 --> 00:28:27,600
all these reasons here agree which is
this is good coat

463
00:28:27,600 --> 00:28:32,150
known good coat nothing to worry about
the code up he is unknown

464
00:28:32,150 --> 00:28:37,400
and your receipt is on on code actually
that's not very surprising that sexual

465
00:28:37,400 --> 00:28:40,540
made execute with both which is unknown

466
00:28:40,540 --> 00:28:45,820
wealthy also see piece the whole
patching saying we've been talking about

467
00:28:45,820 --> 00:28:51,180
scroll to the right in the second all we
have also met I'm formation you like

468
00:28:51,180 --> 00:28:54,300
size memory et cetera see

469
00:28:54,300 --> 00:28:57,910
you so this is still the

470
00:28:57,910 --> 00:29:04,910
main image of both zoom out

471
00:29:05,230 --> 00:29:09,120
for the right what you see here three
nights these are these injections

472
00:29:09,120 --> 00:29:12,690
I mean it's little bit more now says but
it turned out these are injections into

473
00:29:12,690 --> 00:29:13,450
the library's

474
00:29:13,450 --> 00:29:16,610
some modifications

475
00:29:16,610 --> 00:29:23,610
okay

476
00:29:25,030 --> 00:29:28,080
you see all psyched about laver is being
injected to weaken look at the name

477
00:29:28,080 --> 00:29:31,170
I wanna move on and I'm

478
00:29:31,170 --> 00:29:34,740
find out what's happening this end we
have now turned on

479
00:29:34,740 --> 00:29:38,300
South Franco detection I mean all the
Zacks a precomputed

480
00:29:38,300 --> 00:29:41,310
right and both be mark you now in the

481
00:29:41,310 --> 00:29:45,820
in the view is all those black thoughts
correspond to sell for the cycle your

482
00:29:45,820 --> 00:29:46,270
phone

483
00:29:46,270 --> 00:29:49,640
there are actually three regions one
small one appear

484
00:29:49,640 --> 00:29:54,070
but the bigger one down there then many
very small ones here

485
00:29:54,070 --> 00:30:01,070
you look at these two in more detail no
a

486
00:30:04,170 --> 00:30:11,170
again the thirty of those regions

487
00:30:12,070 --> 00:30:15,650
so we folks on this one I we've 69 other
layers

488
00:30:15,650 --> 00:30:18,730
what the media to senior I'm you have
some basic information

489
00:30:18,730 --> 00:30:21,890
memory so it's red execute people so
that my cell

490
00:30:21,890 --> 00:30:26,070
somehow sense there's some code that has
appeared and it's excusable so

491
00:30:26,070 --> 00:30:29,220
at most likely really called not the
false-positive

492
00:30:29,220 --> 00:30:32,380
I'm you're not sick

493
00:30:32,380 --> 00:30:36,920
whether this code is actually running
this and be switched on

494
00:30:36,920 --> 00:30:40,390
stock back traces so this this purple

495
00:30:40,390 --> 00:30:44,100
or pink whether it is lines they show
with Regan

496
00:30:44,100 --> 00:30:47,630
which memory sins are really executing
will be very nice to see

497
00:30:47,630 --> 00:30:52,120
up here back the main image of the book
has been yet seen execution here

498
00:30:52,120 --> 00:30:55,970
until this is called he has appeared now
its immediate the active

499
00:30:55,970 --> 00:30:58,980
so that's kind of true /code senior

500
00:30:58,980 --> 00:31:02,060
itself or the fine code is through croat
and it's funny

501
00:31:02,060 --> 00:31:05,090
the next thing is I'm

502
00:31:05,090 --> 00:31:12,090
you want to find out where it's coming
from and have another feature for that

503
00:31:12,930 --> 00:31:19,060
who in a bit and now we have switched on

504
00:31:19,060 --> 00:31:22,200
memory right detection if EC

505
00:31:22,200 --> 00:31:25,800
and is never right system calls the
track from that and where to their

506
00:31:25,800 --> 00:31:26,260
rights

507
00:31:26,260 --> 00:31:30,210
and the senior drew a red bar has been
gotten a bit bigger

508
00:31:30,210 --> 00:31:34,860
you see that means this memory T is a
target of memory rights okay

509
00:31:34,860 --> 00:31:40,310
that's very nice and also see voters
coming from its process 15 44

510
00:31:40,310 --> 00:31:43,990
so this memory thing was written by
process 54.4%

511
00:31:43,990 --> 00:31:48,620
let's see what it is goes back to
process list

512
00:31:48,620 --> 00:31:51,650
see okay

513
00:31:51,650 --> 00:31:55,270
that was explored a taxi so what they
have seen you essentially

514
00:31:55,270 --> 00:31:58,580
is member injection from explore

515
00:31:58,580 --> 00:32:03,290
sexy now we know it's coming from

516
00:32:03,290 --> 00:32:07,150
but we don't know what it is right so
it's time to use our

517
00:32:07,150 --> 00:32:12,230
matching feature that have gone now I am

518
00:32:12,230 --> 00:32:15,290
what you have said please match this
reason here

519
00:32:15,290 --> 00:32:19,400
and surgical old memory you see I V F
for smack to see you

520
00:32:19,400 --> 00:32:25,250
might disappear what's the what we learn
from that up here we have two main image

521
00:32:25,250 --> 00:32:25,890
of both

522
00:32:25,890 --> 00:32:29,360
and apparently the main image of the
book copy down here

523
00:32:29,360 --> 00:32:32,770
the funny thing is it came be explored
sexy

524
00:32:32,770 --> 00:32:37,520
so somehow got there we don't know yet
how but its kind protection it seems

525
00:32:37,520 --> 00:32:38,980
both is injected self

526
00:32:38,980 --> 00:32:42,870
certain processes okay

527
00:32:42,870 --> 00:32:45,870
in

528
00:32:45,870 --> 00:32:50,310
and I think I'm gonna switch over to

529
00:32:50,310 --> 00:32:54,420
yet to drop the process the second
process

530
00:32:54,420 --> 00:32:58,390
child process both the pixie you don't
have a look at that memory

531
00:32:58,390 --> 00:33:04,400
see if you can get generate someone
standing there okay it is again

532
00:33:04,400 --> 00:33:07,470
overview

533
00:33:07,470 --> 00:33:11,400
do some whitelisting I Logan going to
the taste is the simple things like

534
00:33:11,400 --> 00:33:11,930
before

535
00:33:11,930 --> 00:33:16,990
some patching going on one focus on
right now is the black parts you

536
00:33:16,990 --> 00:33:20,530
so we see again image of the BART

537
00:33:20,530 --> 00:33:23,580
also can use in the tight process K

538
00:33:23,580 --> 00:33:26,670
is the main one you love try process so
it seems to be

539
00:33:26,670 --> 00:33:30,910
sent to the same as of both Missy

540
00:33:30,910 --> 00:33:35,160
strange black taxis here that's an
example transient croat

541
00:33:35,160 --> 00:33:38,290
trends in data that means the image
appears

542
00:33:38,290 --> 00:33:44,660
and disappears again several times look
also see

543
00:33:44,660 --> 00:33:48,680
the right that's the same thing as
before same pattern as for the

544
00:33:48,680 --> 00:33:52,730
as for the pot see again MENA region

545
00:33:52,730 --> 00:33:56,520
he talked about the Pew so next on the
look

546
00:33:56,520 --> 00:34:00,700
have a look at the at these dumbasses

547
00:34:00,700 --> 00:34:04,860
because they're quite interesting why
does why does the if they both appear

548
00:34:04,860 --> 00:34:10,320
is appearing appear again to throw for a
sec

549
00:34:10,320 --> 00:34:15,919
you only use actual another feature

550
00:34:15,919 --> 00:34:21,280
I am week and what you gonna realize now
is like him

551
00:34:21,280 --> 00:34:28,280
where the heat is located

552
00:34:28,980 --> 00:34:32,990
okay he resuming now on on one of those
taxes to see more detail it's happening

553
00:34:32,990 --> 00:34:36,210
switch on the base craft and

554
00:34:36,210 --> 00:34:39,930
now we switched on heap location

555
00:34:39,930 --> 00:34:46,360
you see heap is marked in pink so these
memories in this heat and go through the

556
00:34:46,360 --> 00:34:47,580
sea is that them

557
00:34:47,580 --> 00:34:50,670
the image of the both will appear on
keep okay

558
00:34:50,670 --> 00:34:54,710
that's interesting it's not execute the
book he's not excusable

559
00:34:54,710 --> 00:34:58,610
on the rise to be read so the question
is what is it doing he

560
00:34:58,610 --> 00:35:01,880
and then they have switched on the gang
and

561
00:35:01,880 --> 00:35:06,070
memory right tracing and what you see
here now is a

562
00:35:06,070 --> 00:35:09,970
big green bar which means that memories
in

563
00:35:09,970 --> 00:35:14,850
is the source over memory right you see
this memory since written to process 15

564
00:35:14,850 --> 00:35:15,600
44

565
00:35:15,600 --> 00:35:19,220
and the story though is the following
one

566
00:35:19,220 --> 00:35:24,120
the image of the process is written heap
then that's injected

567
00:35:24,120 --> 00:35:27,750
to process your 15 44 which if you
remember is

568
00:35:27,750 --> 00:35:31,890
explore a sexy now cut somehow the story
make sense

569
00:35:31,890 --> 00:35:34,950
try process of the bought rights

570
00:35:34,950 --> 00:35:40,680
emit index for sexy which in turn then
makes the injection we have seen before

571
00:35:40,680 --> 00:35:45,090
to book a taxi so now we understand the
waste is memories traveling

572
00:35:45,090 --> 00:35:48,650
and you see the same

573
00:35:48,650 --> 00:35:52,440
in all the processes as well actually so
we see

574
00:35:52,440 --> 00:35:55,690
you each of these black cum arse

575
00:35:55,690 --> 00:36:00,860
is an injection into separate process if
you look at you too its time same path

576
00:36:00,860 --> 00:36:04,780
so we see the the drop key processes

577
00:36:04,780 --> 00:36:08,940
is doing it excellent running what's up
in Texas actually

578
00:36:08,940 --> 00:36:12,530
okay this was about

579
00:36:12,530 --> 00:36:15,530
analyzing the first self modifying code
written have seen

580
00:36:15,530 --> 00:36:18,610
so you have a very good understanding
what's happening already

581
00:36:18,610 --> 00:36:22,780
good intuition gonna have a look weak
locus the second round it's a very small

582
00:36:22,780 --> 00:36:23,410
region

583
00:36:23,410 --> 00:36:28,870
it's a bit different it is in the middle
of execute a book called you see that

584
00:36:28,870 --> 00:36:30,410
the threat before and after

585
00:36:30,410 --> 00:36:34,180
so this seems to be nothing injection
but Ruiz L qualifying coat

586
00:36:34,180 --> 00:36:37,330
what is the bottom animation has been

587
00:36:37,330 --> 00:36:41,210
change during execution you see it's
a.m.

588
00:36:41,210 --> 00:36:45,450
the black bars very small region just
one page one-page

589
00:36:45,450 --> 00:36:49,130
a large and what I wanna see what
functions

590
00:36:49,130 --> 00:36:53,870
actually a lot called is there now what
we do is

591
00:36:53,870 --> 00:36:58,610
the export just a snapshot before South
qualifying code has appeared

592
00:36:58,610 --> 00:37:02,450
and the snapshot very has appeared 30s
two snapshots here

593
00:37:02,450 --> 00:37:06,950
which have marked export into I need to
eat a four-month

594
00:37:06,950 --> 00:37:10,770
for further analysis it's happening now

595
00:37:10,770 --> 00:37:14,260
for using

596
00:37:14,260 --> 00:37:18,100
okay

597
00:37:18,100 --> 00:37:21,299
what you have done your we haven't
loaded them into right up but

598
00:37:21,300 --> 00:37:25,770
in the tool which is called been this
been the fees for comparing to bang Rhys

599
00:37:25,770 --> 00:37:29,540
and not on a by them about the
conceptual level like function

600
00:37:29,540 --> 00:37:32,920
basic plot level and a.m.

601
00:37:32,920 --> 00:37:36,660
would be in the show says indeed at the
location

602
00:37:36,660 --> 00:37:41,330
X 40 a et cetera very selfless thank all
those found

603
00:37:41,330 --> 00:37:45,500
we have three functions that appear
that's been it's it's very nice

604
00:37:45,500 --> 00:37:48,860
okay for the three functions that
apparently have been

605
00:37:48,860 --> 00:37:53,810
the cryptid from time and we can have
another

606
00:37:53,810 --> 00:37:56,860
look at it here from one of those
functions

607
00:37:56,860 --> 00:38:00,240
again been dif you see before after

608
00:38:00,240 --> 00:38:03,260
the ICC here before there was no coach
rubbish

609
00:38:03,260 --> 00:38:06,550
after receipt nice clean call you to get
allies now

610
00:38:06,550 --> 00:38:10,020
so in summary

611
00:38:10,020 --> 00:38:13,190
this South modifying code I'm detection

612
00:38:13,190 --> 00:38:17,300
has a that very directly to three
interesting for teens

613
00:38:17,300 --> 00:38:21,350
and if you look at them in detail you
will find out they all have to do

614
00:38:21,350 --> 00:38:24,550
with installation so we have been
directly

615
00:38:24,550 --> 00:38:30,920
guided tour installation routines of
both a sink

616
00:38:30,920 --> 00:38:37,920
you turn right so we have now seen some
details about the book

617
00:38:41,060 --> 00:38:46,360
then its child process some of the
aspect to this we'll see here

618
00:38:46,360 --> 00:38:50,280
calm for and we've seen you you to same
saying in an order you

619
00:38:50,280 --> 00:38:54,020
and it's much more like an over you know

620
00:38:54,020 --> 00:38:57,260
so if you remember to memory rights

621
00:38:57,260 --> 00:39:00,460
from with image very

622
00:39:00,460 --> 00:39:04,310
any to make post if you remember to
memory rights

623
00:39:04,310 --> 00:39:07,790
of in each process from the child
process

624
00:39:07,790 --> 00:39:11,630
you will see you to exact same saying
which the green lights

625
00:39:11,630 --> 00:39:14,890
so the Thai processes injecting goat to

626
00:39:14,890 --> 00:39:17,950
each or too many other processes

627
00:39:17,950 --> 00:39:21,610
so this year is though you of the OC

628
00:39:21,610 --> 00:39:24,760
and of course he does not only rights to
memory

629
00:39:24,760 --> 00:39:28,740
to another process also starts new
threats in it

630
00:39:28,740 --> 00:39:34,190
and this is shown here he does sry
memory rights to each process

631
00:39:34,190 --> 00:39:37,410
and then starts immediately a new threat

632
00:39:37,410 --> 00:39:41,630
the green dots are two memory rights and
the black told is still use threats

633
00:39:41,630 --> 00:39:45,720
which got started

634
00:39:45,720 --> 00:39:49,450
of course you can track down now does
red lines and see

635
00:39:49,450 --> 00:39:54,350
where it is threat is injected to

636
00:39:54,350 --> 00:40:00,260
and

637
00:40:00,260 --> 00:40:03,319
so the next thing would like to know is

638
00:40:03,319 --> 00:40:08,170
what what this disco twitches injected
into all the processes

639
00:40:08,170 --> 00:40:12,000
and for that pur- pose we and able to
threats group you

640
00:40:12,000 --> 00:40:16,910
and you see now that's there is in the
air yellow threat insect it into one of

641
00:40:16,910 --> 00:40:18,140
those processes

642
00:40:18,140 --> 00:40:21,390
it's called the label it this to trade
group I'm

643
00:40:21,390 --> 00:40:25,380
and year it wealth were toolbox

644
00:40:25,380 --> 00:40:29,470
not Eakes XE and for all of those
processes

645
00:40:29,470 --> 00:40:33,630
everywhere is stems threat and it's just
only one threat

646
00:40:33,630 --> 00:40:37,210
except for a few cases for example

647
00:40:37,210 --> 00:40:41,160
here is the Explorer and

648
00:40:41,160 --> 00:40:44,819
in case tote this I'm thread runs in
Explorer

649
00:40:44,819 --> 00:40:48,789
it will start a couple of all the
threats and you see that here on this

650
00:40:48,789 --> 00:40:49,859
picture right now

651
00:40:49,859 --> 00:40:53,170
and if it runs an explorer

652
00:40:53,170 --> 00:40:57,069
it will starts for example here too

653
00:40:57,069 --> 00:41:00,809
these threats there are exactly the same
this one year

654
00:41:00,809 --> 00:41:03,950
and Islam and they got

655
00:41:03,950 --> 00:41:10,950
both another argument

656
00:41:12,740 --> 00:41:16,380
you concede this and meta-data which
display

657
00:41:16,380 --> 00:41:22,490
and the other Singh is in the window
security notify your process

658
00:41:22,490 --> 00:41:25,710
it the book also behaves in all the way

659
00:41:25,710 --> 00:41:28,720
year it starts to New threats

660
00:41:28,720 --> 00:41:32,559
one of two groups che and one of two
groups an and

661
00:41:32,559 --> 00:41:36,490
those threats we also see here in the
Explorer process

662
00:41:36,490 --> 00:41:41,150
and what we can assume now is that the
window security Nov 25

663
00:41:41,150 --> 00:41:44,609
contains the soup set of the threats of
the Explorer

664
00:41:44,609 --> 00:41:49,690
so both of them have house some kind of
similar functionalities

665
00:41:49,690 --> 00:41:52,770
a.m. year is

666
00:41:52,770 --> 00:41:57,359
also shown one threat of the Explorer
does some more interactions

667
00:41:57,359 --> 00:42:01,960
and of course we'd need to know now what
is dis

668
00:42:01,960 --> 00:42:05,619
threat a.m. doing so for dis we go

669
00:42:05,619 --> 00:42:09,819
again in the memory view and see one of
those threats

670
00:42:09,819 --> 00:42:14,030
and and

671
00:42:14,030 --> 00:42:17,160
if we'd know was designed threat this
doing we can

672
00:42:17,160 --> 00:42:20,290
also although we know that for every and
threat

673
00:42:20,290 --> 00:42:24,380
also in the other process of course so
years again the

674
00:42:24,380 --> 00:42:28,049
both image its exactly the same with the
Memory Man

675
00:42:28,049 --> 00:42:31,309
much are we have proven that and

676
00:42:31,309 --> 00:42:34,819
it's also executing used to this
talkback trace again

677
00:42:34,819 --> 00:42:39,089
and what we now have a look at this time
the

678
00:42:39,089 --> 00:42:43,380
and loaded modules and with the might
weightlifter

679
00:42:43,380 --> 00:42:47,190
and we see here a lot of modifications
we go nose

680
00:42:47,190 --> 00:42:51,030
the in to one of them or three of them

681
00:42:51,030 --> 00:42:54,319
am we see here

682
00:42:54,319 --> 00:42:57,569
there is a ago their Easter

683
00:42:57,569 --> 00:43:00,970
anti DLL load it then

684
00:43:00,970 --> 00:43:04,119
there is a memory right a.m.

685
00:43:04,119 --> 00:43:08,450
there is two address given here and you
see also that

686
00:43:08,450 --> 00:43:12,720
there the got written five by its five
bucks that's a charm

687
00:43:12,720 --> 00:43:16,740
to another location difficult track down
this address you will come

688
00:43:16,740 --> 00:43:19,859
into the boat image so this is basically

689
00:43:19,859 --> 00:43:23,690
walking and it talks to create threat
met

690
00:43:23,690 --> 00:43:27,500
of ante de l'eau and you see here to
memory right

691
00:43:27,500 --> 00:43:30,710
which is highlights right now and one

692
00:43:30,710 --> 00:43:33,780
two snapshots later and whitelist to say

693
00:43:33,780 --> 00:43:38,740
that is called modified and you see the
exact same saying for

694
00:43:38,740 --> 00:43:42,609
for the other who Kings on the right
site now

695
00:43:42,609 --> 00:43:48,150
and for example here is still loader los
de lol who

696
00:43:48,150 --> 00:43:52,540
and some other system calls

697
00:43:52,540 --> 00:43:56,579
order or of Beatles and again also for
when

698
00:43:56,579 --> 00:44:00,700
unit so we have now seen

699
00:44:00,700 --> 00:44:04,119
the injections to patching from one
threat

700
00:44:04,119 --> 00:44:07,579
and it appears to be the same in all
other processes

701
00:44:07,579 --> 00:44:11,540
and we have now understood that the M's
threat is basically just

702
00:44:11,540 --> 00:44:15,329
who King some calls and our loaded my
the

703
00:44:15,329 --> 00:44:19,710
into los libros and in case it runs and
Explorer

704
00:44:19,710 --> 00:44:23,359
or in Windows security notify you it
starts

705
00:44:23,359 --> 00:44:26,400
all the threat which are basically there
for stealing on

706
00:44:26,400 --> 00:44:30,040
information or modifying some other
sings

707
00:44:30,040 --> 00:44:34,910
okay so I think we have seen really that
now intend two minutes a good

708
00:44:34,910 --> 00:44:38,410
fairly quickly develop some
understanding of what's going on on you

709
00:44:38,410 --> 00:44:41,750
I'm universal nice way of course

710
00:44:41,750 --> 00:44:44,950
constand all the tissue still have to go
into

711
00:44:44,950 --> 00:44:48,309
some this assembly and look at the
things that scare no one can automate

712
00:44:48,309 --> 00:44:48,680
that

713
00:44:48,680 --> 00:44:51,720
but was really about guiding at least
interesting parts and

714
00:44:51,720 --> 00:44:55,240
having a good increase in what's going
on between of course than helping

715
00:44:55,240 --> 00:45:00,049
detailed analysis so we're

716
00:45:00,049 --> 00:45:03,059
ready to conclude I'm think I've seen
some

717
00:45:03,059 --> 00:45:06,900
we think entirely new technique to tube
and analysis

718
00:45:06,900 --> 00:45:10,170
I'm are you know this I'm member tracey
is

719
00:45:10,170 --> 00:45:14,540
entirely new have also seen the can
automate some things like that I'm so

720
00:45:14,540 --> 00:45:17,420
qualifying code said cronkite Annalise
to impress

721
00:45:17,420 --> 00:45:20,599
regions I was also say that's

722
00:45:20,599 --> 00:45:24,950
absolutely open topic I mean it just
started working on that centrally I

723
00:45:24,950 --> 00:45:25,619
think

724
00:45:25,619 --> 00:45:29,190
what's questions i mean is is really
useful &

725
00:45:29,190 --> 00:45:33,020
is canned can there be new by the
techniques even

726
00:45:33,020 --> 00:45:36,640
more techniques found to make analyses
to gain insights

727
00:45:36,640 --> 00:45:40,630
entirely possible to sync but some clear
I'm

728
00:45:40,630 --> 00:45:45,670
also taken the questions like would be
nice if course if he could break off

729
00:45:45,670 --> 00:45:48,710
snapshots really nice Seok uses natural

730
00:45:48,710 --> 00:45:52,040
that's interesting probably now could
loaded like that the Brotherhood

731
00:45:52,040 --> 00:45:52,940
something

732
00:45:52,940 --> 00:45:56,799
start even from there but that's
technically heart

733
00:45:56,799 --> 00:46:00,079
but that of course very nice I am

734
00:46:00,079 --> 00:46:04,150
he also nice throws a capture go to
memory much as process memory

735
00:46:04,150 --> 00:46:08,290
costing you have much more information
that would really be volatility over

736
00:46:08,290 --> 00:46:10,790
time

737
00:46:10,790 --> 00:46:14,099
great so thank you Mark very much for
you

738
00:46:14,099 --> 00:46:17,130
for your attention seeing you can

739
00:46:17,130 --> 00:46:24,130
take some questions

740
00:46:26,240 --> 00:46:28,000
crack

