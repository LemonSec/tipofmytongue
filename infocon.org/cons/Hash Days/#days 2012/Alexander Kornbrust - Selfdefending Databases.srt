1
00:00:06,000 --> 00:00:08,060
okay I know it to talk

2
00:00:08,060 --> 00:00:11,220
of but the launch is always difficult
but I

3
00:00:11,220 --> 00:00:15,750
it will become interesting for you we
talk

4
00:00:15,750 --> 00:00:20,279
the two bolts introduction what is to
root cause of signal injection

5
00:00:20,279 --> 00:00:24,360
how can be a the detect an attack what's
there not have me

6
00:00:24,360 --> 00:00:27,810
P of an attack and countermeasures and
how to implement

7
00:00:27,810 --> 00:00:31,800
nowadays

8
00:00:31,800 --> 00:00:35,050
signal injection is one of the most

9
00:00:35,050 --> 00:00:38,180
a common problems in the day to be smart

10
00:00:38,180 --> 00:00:42,390
and all that applications are
persistently under attack from the

11
00:00:42,390 --> 00:00:42,940
internet

12
00:00:42,940 --> 00:00:46,940
and if a tech most successful a
successful

13
00:00:46,940 --> 00:00:50,110
the data is lost and sometimes posted on
Bay

14
00:00:50,110 --> 00:00:56,500
pastebin or just stolen and nowadays the
majority of to take a

15
00:00:56,500 --> 00:00:59,800
they are using towards like Pangaea in
Harvey

16
00:00:59,800 --> 00:01:04,860
and all this kind of stuff and in the
presentation from Las the iPhone also a

17
00:01:04,860 --> 00:01:05,590
few numbers

18
00:01:05,590 --> 00:01:10,720
so I just copied damn ODIs is the

19
00:01:10,720 --> 00:01:14,940
statistics from in power bar them when
you talk dirty

20
00:01:14,940 --> 00:01:18,509
but applications and a hat or on 71

21
00:01:18,509 --> 00:01:21,820
sequel injection attempts per second and

22
00:01:21,820 --> 00:01:24,820
up to 800 1300 injection intense

23
00:01:24,820 --> 00:01:29,979
I'll at 2p and they also realize that
the majority of to take us are using

24
00:01:29,979 --> 00:01:30,460
towards

25
00:01:30,460 --> 00:01:34,439
because people are lazy why should you
do it manually it does it will be just

26
00:01:34,439 --> 00:01:35,470
click and point

27
00:01:35,470 --> 00:01:40,570
so people are using towards and last
year there was a a

28
00:01:40,570 --> 00:01:43,650
talk about protecting data bases with
trees

29
00:01:43,650 --> 00:01:47,920
Chris Duhon ok among his comes from the
university so just talk morse

30
00:01:47,920 --> 00:01:52,159
quite academic it's interesting and

31
00:01:52,159 --> 00:01:56,420
comparing to my approach is dis complex

32
00:01:56,420 --> 00:01:59,600
so I'm using a really simple way

33
00:01:59,600 --> 00:02:02,700
and you can implemented in in a few of
us

34
00:02:02,700 --> 00:02:07,790
in your system to be good vantage of to
approach you will see is

35
00:02:07,790 --> 00:02:13,230
it's not necessary to modify application
and it's not complex it's easy to enable

36
00:02:13,230 --> 00:02:14,630
and also easy to war

37
00:02:14,630 --> 00:02:20,690
on disable what is so would cost of

38
00:02:20,690 --> 00:02:24,340
single injection we have two problem we
have so many by rebel

39
00:02:24,340 --> 00:02:30,340
systems and the solution is quite easy
we only have to fix audubon rebel

40
00:02:30,340 --> 00:02:33,959
but applications in our company or
organization

41
00:02:33,959 --> 00:02:39,120
and then we don't have any problem
anymore but

42
00:02:39,120 --> 00:02:44,160
do you think this is realistic so if you
are working in a pic

43
00:02:44,160 --> 00:02:48,050
organization you know that's not really
realistic decimal secure court

44
00:02:48,050 --> 00:02:52,530
in the majority of all cases you don't
have time to perform a pen test

45
00:02:52,530 --> 00:02:58,640
what time in no company is similar to
battered you're using applications

46
00:02:58,640 --> 00:02:59,920
longer than expected

47
00:02:59,920 --> 00:03:04,480
sometimes 10 years and longer and in
many cases dunno pictures available

48
00:03:04,480 --> 00:03:05,830
there's no pic strategy

49
00:03:05,830 --> 00:03:10,470
so it's difficult to fix this problem
and

50
00:03:10,470 --> 00:03:14,050
if you cannot fix the sequel injection
problem

51
00:03:14,050 --> 00:03:19,629
we have to work so much for another way
and before start to

52
00:03:19,629 --> 00:03:24,010
before we start love finding to solution
one approach

53
00:03:24,010 --> 00:03:27,750
we should have a look how is a single
injection attack

54
00:03:27,750 --> 00:03:33,459
performed and I'm quite sure some of you
here in the room already did this

55
00:03:33,459 --> 00:03:37,610
several times a typical it echoes
normally using a tool

56
00:03:37,610 --> 00:03:41,620
like net spock %uh metrics as: graham et
ways using Google

57
00:03:41,620 --> 00:03:45,739
to find the sequel injection
vulnerability the next step

58
00:03:45,739 --> 00:03:49,959
is to war selected table for take up
wants to or download

59
00:03:49,959 --> 00:03:53,370
and then you download to date are from

60
00:03:53,370 --> 00:03:56,530
will fit with let's have a look at

61
00:03:56,530 --> 00:04:00,940
find a single injection vulnerability
this is

62
00:04:00,940 --> 00:04:04,190
really really easy if you just want to
find

63
00:04:04,190 --> 00:04:09,129
one or multiple vulnerabilities so yeah
I was looking for all see I execute

64
00:04:09,129 --> 00:04:12,500
in this error message and then I got
shove

65
00:04:12,500 --> 00:04:16,709
from Google to rethought here for
example stone peak around makes

66
00:04:16,709 --> 00:04:22,080
they have arm US L and dis returns
quoted string a properly terminated

67
00:04:22,080 --> 00:04:25,830
I always try to woo use stuff from the

68
00:04:25,830 --> 00:04:30,930
country Wagg if the presentation so I
was just looking for all see I execute

69
00:04:30,930 --> 00:04:35,090
this is a IR a message created by PHP

70
00:04:35,090 --> 00:04:38,919
and I said okay such only in Switzerland

71
00:04:38,919 --> 00:04:42,250
and then I found one page ski or I'm not
sure

72
00:04:42,250 --> 00:04:45,330
what exactly do all some your stuff

73
00:04:45,330 --> 00:04:50,650
and you can see SQL commander properly
terminated

74
00:04:50,650 --> 00:04:55,229
though I started to page up by clicking
on Google Inc

75
00:04:55,229 --> 00:05:00,330
and you can see hear or see I execute
cyclical montel properly ended

76
00:05:00,330 --> 00:05:04,080
the next thing undertaken only bus

77
00:05:04,080 --> 00:05:08,290
he looks it to you I L so here we have a
number

78
00:05:08,290 --> 00:05:11,990
and here we have something random member

79
00:05:11,990 --> 00:05:18,990
and you can see is some we art character

80
00:05:18,990 --> 00:05:22,740
ends my own I think that this

81
00:05:22,740 --> 00:05:26,400
is the point where r to Google spider
was creating dis

82
00:05:26,400 --> 00:05:30,190
a wrong message we are replacing to
Sarah message

83
00:05:30,190 --> 00:05:33,360
or disassociate range string with

84
00:05:33,360 --> 00:05:38,210
signaled for all one equal you tell in
our DVR kit host address

85
00:05:38,210 --> 00:05:42,139
and you can insert your own as a
statement

86
00:05:42,139 --> 00:05:45,539
and with minors minesweeper mini to
statement everything is

87
00:05:45,539 --> 00:05:49,580
or is wrong and now we are getting a
different as good as statement

88
00:05:49,580 --> 00:05:53,340
and later to talk we will feed that this
is a typical pattern for sequel

89
00:05:53,340 --> 00:05:55,030
injection attack

90
00:05:55,030 --> 00:05:59,080
this means job ice is not installed and
a tech I was trying to use

91
00:05:59,080 --> 00:06:02,750
Java function so this is also an Oracle
database

92
00:06:02,750 --> 00:06:06,240
because in your databases job us not
necessary for dis

93
00:06:06,240 --> 00:06:09,360
attack but just

94
00:06:09,360 --> 00:06:13,350
leave writing this URL would now allow
me to want download

95
00:06:13,350 --> 00:06:17,300
everything from the database and this
was a manual attack

96
00:06:17,300 --> 00:06:24,090
but if you are using a tool everything
is much faster

97
00:06:24,090 --> 00:06:27,550
using a twin you can this is a Chinese
twill

98
00:06:27,550 --> 00:06:32,039
you can does specify you sooo our web
page

99
00:06:32,039 --> 00:06:36,130
in the next step

100
00:06:36,130 --> 00:06:40,199
you can see scan the entire up to me in
Aus can be current to mean you can

101
00:06:40,199 --> 00:06:41,710
specify to scan level

102
00:06:41,710 --> 00:06:45,669
how many threats should be used

103
00:06:45,669 --> 00:06:49,330
and you can specify what are you looking
for and here we are only looking for

104
00:06:49,330 --> 00:06:52,639
sequel injection the to you such a tool

105
00:06:52,639 --> 00:06:55,770
it's not rocket science you just have to
click

106
00:06:55,770 --> 00:07:01,160
and yes to know or can I want to look
for simple injection

107
00:07:01,160 --> 00:07:04,900
and then you start it will and

108
00:07:04,900 --> 00:07:10,319
if it's hard to find a winner ability
destroyed I'm normally offering your

109
00:07:10,319 --> 00:07:13,770
um the table names so you see

110
00:07:13,770 --> 00:07:17,210
they found food distort on the one who
bility Dept

111
00:07:17,210 --> 00:07:21,520
Tammy M so great and suit our column
names

112
00:07:21,520 --> 00:07:26,009
and he seems to also read out three
columns in the table Dept

113
00:07:26,009 --> 00:07:29,400
and by using a right mouse click you can
now download

114
00:07:29,400 --> 00:07:34,199
all the information from ODIs CIMA

115
00:07:34,199 --> 00:07:39,630
about tools are doing it similarly does
this have you

116
00:07:39,630 --> 00:07:42,789
this is another Chinese 21 own

117
00:07:42,789 --> 00:07:47,289
so you see you the tables you can
specify which columns are used

118
00:07:47,289 --> 00:07:51,300
and then if you or %uh download them you
can say safe

119
00:07:51,300 --> 00:07:55,069
and you get to see if the fight with
information

120
00:07:55,069 --> 00:07:59,389
know it's now a days really easy for the
majority of signal injection winner

121
00:07:59,389 --> 00:08:00,669
abilities in a bit page

122
00:08:00,669 --> 00:08:04,569
to download the data and get everything
back

123
00:08:04,569 --> 00:08:09,340
and as a rule of thumb it takes less
than two minutes before the start

124
00:08:09,340 --> 00:08:15,139
downloading data from your website

125
00:08:15,139 --> 00:08:18,250
do so. company augmentation you have to
react

126
00:08:18,250 --> 00:08:21,259
within two minutes

127
00:08:21,259 --> 00:08:25,680
solar in a perfect world the manager on
duty which is responsible for two

128
00:08:25,680 --> 00:08:27,740
operating of all the

129
00:08:27,740 --> 00:08:30,770
applications and systems in your
organization

130
00:08:30,770 --> 00:08:34,690
it's getting some ratification and tech
is going on

131
00:08:34,690 --> 00:08:38,459
and within two minutes he's stopping to
Saugus and nobody can do

132
00:08:38,459 --> 00:08:42,199
anything with just 10 bility

133
00:08:42,199 --> 00:08:46,230
over from last is it realistic

134
00:08:46,230 --> 00:08:49,290
no so if you are 2 days 10 probably

135
00:08:49,290 --> 00:08:52,920
that's more realistic a.m.

136
00:08:52,920 --> 00:08:56,190
my expense in in several cases companies

137
00:08:56,190 --> 00:09:01,680
never handle realized that they were
hacked candidate has lost

138
00:09:01,680 --> 00:09:05,360
the problem these two minutes coming
from the toward it's too hot for human

139
00:09:05,360 --> 00:09:07,149
reaction

140
00:09:07,149 --> 00:09:12,950
and even if you have those cm system
auto security operation center

141
00:09:12,950 --> 00:09:16,399
two minutes nobody can react that fast I
won't let

142
00:09:16,399 --> 00:09:20,010
not say nobody probably there are one or
two companies in the world which could

143
00:09:20,010 --> 00:09:21,310
create that fast

144
00:09:21,310 --> 00:09:26,070
but if not realistic for the rest of two

145
00:09:26,070 --> 00:09:29,300
and another problem the majority of
companies do not have

146
00:09:29,300 --> 00:09:32,910
action plans what happens if yon under
attack

147
00:09:32,910 --> 00:09:37,230
can be shut down or stop the system what
are the side effects

148
00:09:37,230 --> 00:09:41,080
is someone on complaining our services
depend on from this

149
00:09:41,080 --> 00:09:45,550
but system and phone and if you own or
manage on cutie responsible for one

150
00:09:45,550 --> 00:09:47,459
thousand applications all systems

151
00:09:47,459 --> 00:09:50,519
you would never shut down or stop the
system

152
00:09:50,519 --> 00:09:54,070
because so if you stop the wrong system
you probably

153
00:09:54,070 --> 00:09:57,430
lose your top

154
00:09:57,430 --> 00:10:00,890
the weed don't live in a perfect world
and

155
00:10:00,890 --> 00:10:03,950
the problems are you human so we need a
solution

156
00:10:03,950 --> 00:10:07,529
with out human beings

157
00:10:07,529 --> 00:10:11,060
the system itself has to detect the
hacking attempt

158
00:10:11,060 --> 00:10:15,930
and then the system has to take to write
countermeasures

159
00:10:15,930 --> 00:10:20,250
eSPN is think coach detect an attack

160
00:10:20,250 --> 00:10:24,839
but did to go love suspect up but
Application Firewall

161
00:10:24,839 --> 00:10:28,700
but the web application firewall is
normally locking

162
00:10:28,700 --> 00:10:33,550
a suspicious attacks and take us always
interested to bypass

163
00:10:33,550 --> 00:10:37,310
these by using special encoding schemes
and so on

164
00:10:37,310 --> 00:10:40,870
so what a better education firewall can
reduce the risk

165
00:10:40,870 --> 00:10:44,029
but if you you'll del often by

166
00:10:44,029 --> 00:10:47,920
to bypass tunnel tube of Repsol bought
Kinect

167
00:10:47,920 --> 00:10:52,110
similar to what of using for example
what security

168
00:10:52,110 --> 00:10:56,649
um for this is also limited the
application itself

169
00:10:56,649 --> 00:11:00,350
normally does not detect a sequel
injection because the

170
00:11:00,350 --> 00:11:03,529
will it use and application itself

171
00:11:03,529 --> 00:11:07,170
so I think the best way here to find an
attack

172
00:11:07,170 --> 00:11:10,380
is the database itself by looking at

173
00:11:10,380 --> 00:11:14,399
our messages part of the box

174
00:11:14,399 --> 00:11:18,600
systems like Oracle and sickle cell
about able to detect and react

175
00:11:18,600 --> 00:11:22,579
on specific error messages and so

176
00:11:22,579 --> 00:11:25,720
one of two speaker savvy he also
implemented this

177
00:11:25,720 --> 00:11:31,950
so yesterday or the day before to all my
seek for using my secret possible fate

178
00:11:31,950 --> 00:11:36,339
later see details and

179
00:11:36,339 --> 00:11:39,620
you only get a narrow message for
example quoted string not properly

180
00:11:39,620 --> 00:11:40,410
terminated

181
00:11:40,410 --> 00:11:43,820
if the system is fine rather so there's
no random

182
00:11:43,820 --> 00:11:49,550
love are a message and it's quite weird
if you have 4th positives

183
00:11:49,550 --> 00:11:52,560
if you have a really poor software and

184
00:11:52,560 --> 00:11:56,420
developers ascending incorrect
statements to the database

185
00:11:56,420 --> 00:12:02,190
ended could be possible that your
triggering the sorrow message

186
00:12:02,190 --> 00:12:06,519
ok with me implement this in article we
can use an Oracle database regatta will

187
00:12:06,519 --> 00:12:07,760
have an example

188
00:12:07,760 --> 00:12:11,420
for sequel so I started but I haven't
time to finish it

189
00:12:11,420 --> 00:12:16,870
and from you did it for my seek for
using the proxy

190
00:12:16,870 --> 00:12:21,209
ok and we detect the sequel injection
yaar a row messages

191
00:12:21,209 --> 00:12:24,350
and it simply because the majority of
the techs

192
00:12:24,350 --> 00:12:29,250
yeah starting with an arrow so if you
have a union if you extend the Cleary if

193
00:12:29,250 --> 00:12:32,040
you use error messages from three feet
are

194
00:12:32,040 --> 00:12:36,060
your getting error message for example
creep rock has incorrect number of urs

195
00:12:36,060 --> 00:12:37,029
outcomes

196
00:12:37,029 --> 00:12:41,220
this case you know someone is trying to
play with the union statement

197
00:12:41,220 --> 00:12:46,310
of hiya Oracle phone Microsoft equal
several message

198
00:12:46,310 --> 00:12:50,350
where you put Levine Robert string in
the

199
00:12:50,350 --> 00:12:53,940
a wrong message but that the sensitivity

200
00:12:53,940 --> 00:12:57,610
and hear how is how wanna take looks
like

201
00:12:57,610 --> 00:13:01,860
%uh including those statements this was
that you have to develop a

202
00:13:01,860 --> 00:13:05,310
select customer name custom ID custom
auto from custom

203
00:13:05,310 --> 00:13:09,990
now we have gonna take up and it a case
pending Union flicking the name common I

204
00:13:09,990 --> 00:13:10,990
come apart from

205
00:13:10,990 --> 00:13:14,880
youth if you run it you see in the same

206
00:13:14,880 --> 00:13:18,750
output username and possible

207
00:13:18,750 --> 00:13:22,010
and you can often CDs kind of examples

208
00:13:22,010 --> 00:13:25,370
in all kind of documentation but what is
missing

209
00:13:25,370 --> 00:13:29,589
that nominee there's no direct way from
not original statement

210
00:13:29,589 --> 00:13:33,760
22 injected statement in between you
have a lot of different attends

211
00:13:33,760 --> 00:13:37,839
to get a prop are simple statement

212
00:13:37,839 --> 00:13:43,889
oh yeah I have a small that application
showing to Oracle in Table

213
00:13:43,889 --> 00:13:48,470
and desist under for Oracle reports and
Oracle Reports has a nice feature if

214
00:13:48,470 --> 00:13:49,279
you're penned

215
00:13:49,279 --> 00:13:52,800
up %uh damage in the US Open forms yes

216
00:13:52,800 --> 00:13:57,100
and a new window pops up earlier in the
process and you can modify

217
00:13:57,100 --> 00:14:00,709
if you re to where condition

218
00:14:00,709 --> 00:14:04,120
when are we the developer thought up by
one

219
00:14:04,120 --> 00:14:07,970
to change the sort order and now we can
override disorder by one

220
00:14:07,970 --> 00:14:13,930
with our own is critical

221
00:14:13,930 --> 00:14:18,970
in this case I would stop using union
for like nyquil my username from

222
00:14:18,970 --> 00:14:23,230
youth and if I click on something to
read this is concatenated

223
00:14:23,230 --> 00:14:27,709
execute but the typical

224
00:14:27,709 --> 00:14:31,500
the the next step it's not that I'm
getting to reside

225
00:14:31,500 --> 00:14:34,990
the next step is I'm getting an error
message theory Prof has incorrect number

226
00:14:34,990 --> 00:14:36,050
of recycled

227
00:14:36,050 --> 00:14:40,699
if I inject this one but it a cotton
twill knows

228
00:14:40,699 --> 00:14:44,260
we have two at additional columns
thought

229
00:14:44,260 --> 00:14:47,870
now you are pending common now common I
I'm to disarm message

230
00:14:47,870 --> 00:14:52,230
disappears though in most lethal
injection

231
00:14:52,230 --> 00:14:55,310
attack scenarios you out pending stuff
until you get

232
00:14:55,310 --> 00:14:59,589
a well-formed let's go if they the
chances that you are getting away for

233
00:14:59,589 --> 00:15:01,380
myspace statement

234
00:15:01,380 --> 00:15:04,430
a using a tool is nearly

235
00:15:04,430 --> 00:15:08,800
next tonight

236
00:15:08,800 --> 00:15:11,880
then we are getting if you are
successful the statement

237
00:15:11,880 --> 00:15:15,060
is executed properly and we have

238
00:15:15,060 --> 00:15:18,500
next to slights are the typical Oracle

239
00:15:18,500 --> 00:15:21,910
error messages let's say we have a

240
00:15:21,910 --> 00:15:25,410
our our RR so 14

241
00:15:25,410 --> 00:15:28,540
76 he's a secret with you

242
00:15:28,540 --> 00:15:31,850
this is a typical are a message from

243
00:15:31,850 --> 00:15:35,720
the s Clement from Sequim

244
00:15:35,720 --> 00:15:38,820
because this tool is trying line
injection using

245
00:15:38,820 --> 00:15:41,949
so would be called and vid division is
the food

246
00:15:41,949 --> 00:15:45,089
20 we note that this is sOooo

247
00:15:45,089 --> 00:15:49,019
candidate for experiment well here we
have

248
00:15:49,019 --> 00:15:53,649
this from this risky all for commander
properly terminated

249
00:15:53,649 --> 00:15:56,709
sometimes you find missing left right
parenthesis

250
00:15:56,709 --> 00:16:02,750
if you have does the phone come on with
a lot of parenthesis

251
00:16:02,750 --> 00:16:06,920
and we saw in our creep rock has
incorrect number of urs icon a few

252
00:16:06,920 --> 00:16:10,220
someone tries to attempt union select

253
00:16:10,220 --> 00:16:13,750
and if this if you know the number of
Parliament us the next up is you have to

254
00:16:13,750 --> 00:16:15,380
find out at the top types

255
00:16:15,380 --> 00:16:18,610
and then you're running in the next hour
message

256
00:16:18,610 --> 00:16:22,779
or dis was Sarah message class does not
exist so someone was trying to use you

257
00:16:22,779 --> 00:16:24,120
tell you know how the Dr

258
00:16:24,120 --> 00:16:27,980
but I mobile phone installed

259
00:16:27,980 --> 00:16:31,470
and in a normal application you will
never see

260
00:16:31,470 --> 00:16:35,149
this kind of a wrong message

261
00:16:35,149 --> 00:16:40,070
what people say about dr. I have real
estate are typically UNCLOS quotation

262
00:16:40,070 --> 00:16:42,860
mark before the character string

263
00:16:42,860 --> 00:16:46,490
a if someone is using the thing unfold
all alright

264
00:16:46,490 --> 00:16:49,870
this converting arrow I if someone is
using minus minus

265
00:16:49,870 --> 00:16:52,990
and there's also in the documentation

266
00:16:52,990 --> 00:16:57,589
pages they can get more of these a wrong
message

267
00:16:57,589 --> 00:17:01,540
you know now they are lot of several
messages which are more or less unique

268
00:17:01,540 --> 00:17:02,339
for

269
00:17:02,339 --> 00:17:06,730
single injection attacks now our system
could do something

270
00:17:06,730 --> 00:17:10,820
so in secret case of the flu so by using
event notification

271
00:17:10,820 --> 00:17:16,060
in case of article using a rotary in
case of my FB using a proxy

272
00:17:16,060 --> 00:17:19,290
if ya carefully you just detective and
use anti-union

273
00:17:19,290 --> 00:17:22,459
but in the revol you will who stayed to
you

274
00:17:22,459 --> 00:17:25,870
just aware that someone stole you need

275
00:17:25,870 --> 00:17:30,020
you could also send an email to the
responsible manager

276
00:17:30,020 --> 00:17:34,850
but what I would reccommend if locked
the database account

277
00:17:34,850 --> 00:17:37,900
because if you are manager on duty we
will see

278
00:17:37,900 --> 00:17:41,140
this what do you prefer out someone its
future data

279
00:17:41,140 --> 00:17:45,360
and if posted on pace been or at the
flea go on some about

280
00:17:45,360 --> 00:17:48,640
newspaper assess this company effect

281
00:17:48,640 --> 00:17:52,299
on that the system is not available for
now onto

282
00:17:52,299 --> 00:17:56,090
what do you prefer who which are

283
00:17:56,090 --> 00:18:02,039
to all who would stop the system to
avoid in a tech

284
00:18:02,039 --> 00:18:08,750
only a few hands who would let the take
a few debater

285
00:18:08,750 --> 00:18:13,809
one hand discuss I

286
00:18:13,809 --> 00:18:17,419
why would you let people feel the data

287
00:18:17,419 --> 00:18:24,419
a computer data

288
00:18:29,040 --> 00:18:32,310
bennett's organization problem though

289
00:18:32,310 --> 00:18:36,360
I agree a manager should decide the
system is so important we

290
00:18:36,360 --> 00:18:40,240
we stop it before something is stolen
and

291
00:18:40,240 --> 00:18:43,810
you can say okay we don't have signal
injection so this case would never

292
00:18:43,810 --> 00:18:44,400
happen

293
00:18:44,400 --> 00:18:47,620
but you never know what so will be added
in the future

294
00:18:47,620 --> 00:18:51,620
after locking account we have still

295
00:18:51,620 --> 00:18:56,760
a sessions which are connected to the
database we have to work terminate the

296
00:18:56,760 --> 00:18:57,220
session

297
00:18:57,220 --> 00:19:00,580
and we can impact the

298
00:19:00,580 --> 00:19:03,650
we can limit the impact if you're using
different

299
00:19:03,650 --> 00:19:06,940
account for example your internal
employees are using

300
00:19:06,940 --> 00:19:11,500
different account to connect to the
database so someone is attacking from

301
00:19:11,500 --> 00:19:12,290
the outside

302
00:19:12,290 --> 00:19:15,930
you on eap looking to people from the
outside but your internal employees can

303
00:19:15,930 --> 00:19:16,620
still book

304
00:19:16,620 --> 00:19:21,090
but this would be an option all weekend
only Plock

305
00:19:21,090 --> 00:19:26,420
a people coming from special IP address
and to avoid false-positive

306
00:19:26,420 --> 00:19:30,430
everything but just not every arrow
message which is not quote

307
00:19:30,430 --> 00:19:34,150
lemme created from the applications of
is ignored

308
00:19:34,150 --> 00:19:39,530
if you are using some to like escuela
Management Studio of people plus or told

309
00:19:39,530 --> 00:19:43,220
you're not blocking the system only if
it's coming

310
00:19:43,220 --> 00:19:47,670
from the back and implementation here
for Oracle

311
00:19:47,670 --> 00:19:50,980
is quite simple you can download it and
play it

312
00:19:50,980 --> 00:19:55,870
labor of it you say off to an arrow cut
into database

313
00:19:55,870 --> 00:19:58,930
bust we are getting the

314
00:19:58,930 --> 00:20:02,680
to execute a bill which most revealing
that I want and then we are

315
00:20:02,680 --> 00:20:04,510
reconstructing desk where a statement

316
00:20:04,510 --> 00:20:08,390
in Oracle Espace statement can be longer
than 2,000 bite

317
00:20:08,390 --> 00:20:12,210
so if it's longer than we have to Ulm

318
00:20:12,210 --> 00:20:15,830
pop everything incompetent everything
together and

319
00:20:15,830 --> 00:20:20,540
at the end of the round you have to see
full text your week got everything

320
00:20:20,540 --> 00:20:21,110
together

321
00:20:21,110 --> 00:20:24,410
and then we say if program

322
00:20:24,410 --> 00:20:27,460
which was three young to sarah is the
Internet Information Server

323
00:20:27,460 --> 00:20:31,110
and if one of these are all messages or
Ochoa you can now decide

324
00:20:31,110 --> 00:20:34,650
money to undertake send an email not to
use our

325
00:20:34,650 --> 00:20:39,720
terminator session some other on
commission and it's clear

326
00:20:39,720 --> 00:20:43,980
dis it's a simple solution if you want
to implement it in your own environment

327
00:20:43,980 --> 00:20:44,850
you have to spend

328
00:20:44,850 --> 00:20:49,280
a little bit more time a doing what's
the fuss over

329
00:20:49,280 --> 00:20:52,340
of a possible but they have a concept of

330
00:20:52,340 --> 00:20:57,540
event notification do not have an hour
ago and you can create an event for

331
00:20:57,540 --> 00:21:01,450
sought to an his girl injection Ross and
then run

332
00:21:01,450 --> 00:21:05,200
I'll start procedure cold when about
this are all

333
00:21:05,200 --> 00:21:08,550
across by Esther L

334
00:21:08,550 --> 00:21:12,680
so I gave a manage our version of this
presentation

335
00:21:12,680 --> 00:21:16,370
two days ago and five you also joined so

336
00:21:16,370 --> 00:21:20,060
this presentation and is this his idea

337
00:21:20,060 --> 00:21:24,200
he's using a my sequel proxy if

338
00:21:24,200 --> 00:21:27,620
love it application so decline defending
a statement

339
00:21:27,620 --> 00:21:32,340
it's no longer connecting directly to
the databases connecting to the proxy

340
00:21:32,340 --> 00:21:35,840
and a proxy is enhancing desk with a
statement

341
00:21:35,840 --> 00:21:39,010
and here you a pending so warnings

342
00:21:39,010 --> 00:21:42,770
and if you have to warnings you get or
you're getting on are a message just

343
00:21:42,770 --> 00:21:46,800
from the database and

344
00:21:46,800 --> 00:21:50,860
the result is written to la clio using

345
00:21:50,860 --> 00:21:54,990
or UBS function and then you can re

346
00:21:54,990 --> 00:21:59,020
on it you can have a trigger looking
locking that something is going on

347
00:21:59,020 --> 00:22:06,020
and then you can also love stock you
can't imagine and yes a plot

348
00:22:06,200 --> 00:22:09,680
also ordered for you at your on

349
00:22:09,680 --> 00:22:13,850
if you have to pee if you can see it and
you have want details on his

350
00:22:13,850 --> 00:22:19,200
rebels from the counter measures we
already talked

351
00:22:19,200 --> 00:22:22,590
about what could we do sending email

352
00:22:22,590 --> 00:22:26,170
just monitoring the band is in my
opinion not enough

353
00:22:26,170 --> 00:22:30,630
desist has the smallest footprint we are
not affecting the availability

354
00:22:30,630 --> 00:22:35,790
IQ of you still feel that something is
going on we are not

355
00:22:35,790 --> 00:22:40,410
solving the problem with the with the
fast response

356
00:22:40,410 --> 00:22:43,850
my opinion if

357
00:22:43,850 --> 00:22:48,160
you are really undertake it's better to
stop and so on

358
00:22:48,160 --> 00:22:51,430
no date has lost but

359
00:22:51,430 --> 00:22:55,000
it acts as a denial of service because
the service is no longer available

360
00:22:55,000 --> 00:22:59,940
and we have potential false-positive
with leaders in a few flights

361
00:22:59,940 --> 00:23:03,670
if any night I got an idea from

362
00:23:03,670 --> 00:23:07,130
my poison he said okay is the database

363
00:23:07,130 --> 00:23:11,570
able to strike back and I said hey
that's not a bad idea

364
00:23:11,570 --> 00:23:15,270
so if you have a denial of service tool
on your system

365
00:23:15,270 --> 00:23:18,840
the database could even get the IP from
the techa

366
00:23:18,840 --> 00:23:24,140
and then started denial of service
against this IP address

367
00:23:24,140 --> 00:23:27,290
it the question is

368
00:23:27,290 --> 00:23:30,460
is this legal a it's possible

369
00:23:30,460 --> 00:23:35,370
and you should so have a look if the
takers using a proxy

370
00:23:35,370 --> 00:23:38,440
so if you are using a proxy then you
would only does

371
00:23:38,440 --> 00:23:41,840
still the proxy system

372
00:23:41,840 --> 00:23:44,980
and the big question is what happens

373
00:23:44,980 --> 00:23:48,030
after our faction incident

374
00:23:48,030 --> 00:23:51,460
what do you prefer and this is a
management decision not develop on no

375
00:23:51,460 --> 00:23:53,100
more

376
00:23:53,100 --> 00:23:56,980
be a candy fight this a to management
must provide

377
00:23:56,980 --> 00:24:00,440
what is important

378
00:24:00,440 --> 00:24:03,840
but from my experience if you look at
system it's much easier for

379
00:24:03,840 --> 00:24:06,960
manager on duty to recien able to assist

380
00:24:06,960 --> 00:24:11,210
let's say the system is down then you
can analyze which they find most

381
00:24:11,210 --> 00:24:15,860
triggering to attack it's a

382
00:24:15,860 --> 00:24:19,980
someone entered all single cord injury
and in this case

383
00:24:19,980 --> 00:24:24,120
you have viral square court because the
thing the court is triggering

384
00:24:24,120 --> 00:24:28,390
have a message but yes does not look
like an attack

385
00:24:28,390 --> 00:24:33,540
it could be. acceptable to re enable the
system again

386
00:24:33,540 --> 00:24:37,220
order minutes on cutie is looking at
this great statement or someone with

387
00:24:37,220 --> 00:24:40,370
a little bit experience and see full and
then you will

388
00:24:40,370 --> 00:24:44,660
a you undo dis lockout

389
00:24:44,660 --> 00:24:48,060
now the possibility for loan of positive
is

390
00:24:48,060 --> 00:24:51,270
if to develop are developed to the wrong

391
00:24:51,270 --> 00:24:56,130
called using a quote Missy

392
00:24:56,130 --> 00:24:59,350
and to be more confident if something is
an existential

393
00:24:59,350 --> 00:25:04,430
now or something triggered by bet
applications cannot

394
00:25:04,430 --> 00:25:08,560
it's possible to detect if that
applications can I is performing

395
00:25:08,560 --> 00:25:14,890
tech and you can even say which scanner
is used

396
00:25:14,890 --> 00:25:17,930
let's say we have US L some PHP program

397
00:25:17,930 --> 00:25:21,600
and you specify the name and then you
get

398
00:25:21,600 --> 00:25:25,830
something back if your past issue 02
about applications cannot

399
00:25:25,830 --> 00:25:29,040
event applications gonna probably is
trying to

400
00:25:29,040 --> 00:25:32,570
a inside and one equal union select one
my password from

401
00:25:32,570 --> 00:25:37,140
be a user's for you any you put this to
minus minus

402
00:25:37,140 --> 00:25:41,680
and you can get this as for a statement

403
00:25:41,680 --> 00:25:47,200
in the a into about to go so that I want
because he's the entire square statement

404
00:25:47,200 --> 00:25:50,710
and I know that if I see the string

405
00:25:50,710 --> 00:25:55,120
actually takes most use why is this the
case because I have a collection of two

406
00:25:55,120 --> 00:25:59,390
typical forensic patterns of two
different with

407
00:25:59,390 --> 00:26:03,660
we're here we see these on series which
I injected

408
00:26:03,660 --> 00:26:07,130
by back when he takes if you find these
pet on

409
00:26:07,130 --> 00:26:10,190
in your I want to go and I want to go
was

410
00:26:10,190 --> 00:26:13,830
fire in you know Akron in Texas use

411
00:26:13,830 --> 00:26:17,020
you have another example now the URL

412
00:26:17,020 --> 00:26:20,870
and someone is injecting while singer
Gordon s

413
00:26:20,870 --> 00:26:24,300
single quotes equal thing accord and s

414
00:26:24,300 --> 00:26:27,440
getting a different error message and
yeah I know its next baca

415
00:26:27,440 --> 00:26:33,370
because nets parka is cut kindly enough
to use deprivation NS

416
00:26:33,370 --> 00:26:39,020
but design other are a message is here

417
00:26:39,020 --> 00:26:42,560
you for them but we're metrics they but
inspect

418
00:26:42,560 --> 00:26:45,790
Pangolin so they are always wipes

419
00:26:45,790 --> 00:26:49,730
um by different

420
00:26:49,730 --> 00:26:52,950
it's clear that this will start sooner
or later the

421
00:26:52,950 --> 00:26:56,060
over next round in bed applications can
into

422
00:26:56,060 --> 00:26:59,260
to avoid a common pattern

423
00:26:59,260 --> 00:27:03,450
but nevertheless I'm quite sure you were
similar to anti-virus programs you will

424
00:27:03,450 --> 00:27:04,600
always find

425
00:27:04,600 --> 00:27:08,520
be able to find scanner also depending
from to see prints what what

426
00:27:08,520 --> 00:27:11,610
execute

427
00:27:11,610 --> 00:27:15,220
the when we get an error message we can
run

428
00:27:15,220 --> 00:27:18,670
stop procedure in the store procedure
has all the arrow messages

429
00:27:18,670 --> 00:27:21,970
embedded and then we can say okay
someone is so

430
00:27:21,970 --> 00:27:25,160
trying to take us with primary

431
00:27:25,160 --> 00:27:28,210
did chances that so mmm

432
00:27:28,210 --> 00:27:31,310
this is attack will be successful are
quite high

433
00:27:31,310 --> 00:27:35,040
so we are shutting down the system

434
00:27:35,040 --> 00:27:38,210
and the various ways to improved to
concepts or

435
00:27:38,210 --> 00:27:41,750
Dismas only to simply just install it
and the system is

436
00:27:41,750 --> 00:27:46,020
down if you spent more money and more
time

437
00:27:46,020 --> 00:27:50,460
you can also modify your application a
little bit

438
00:27:50,460 --> 00:27:53,690
though one possibility we are using
different

439
00:27:53,690 --> 00:27:57,370
database connection for the difference
offices so we have one database connect

440
00:27:57,370 --> 00:28:00,070
for US one database connect for Android

441
00:28:00,070 --> 00:28:03,830
if someone is trying a single injection
by and for on meat and produce a

442
00:28:03,830 --> 00:28:07,170
affect or we can only lock

443
00:28:07,170 --> 00:28:11,200
IP addresses we know this IP address is
performing to take

444
00:28:11,200 --> 00:28:15,180
so we are sending an entry to the
firewall the firewall is blocking only

445
00:28:15,180 --> 00:28:20,200
this on a map application firewall is
blocking only did Pietrus

446
00:28:20,200 --> 00:28:23,300
of some customers I have customers in
Germany is that

447
00:28:23,300 --> 00:28:27,180
ninety-nine percent of our customers are
coming from Germany

448
00:28:27,180 --> 00:28:31,240
and if someone is coming from another
country in the world

449
00:28:31,240 --> 00:28:38,030
we are just blocking on everything
outside of Germany

450
00:28:38,030 --> 00:28:42,630
this is a it youthful if you are able to
communicate with the

451
00:28:42,630 --> 00:28:46,850
application identification so

452
00:28:46,850 --> 00:28:51,310
another possibility is to use different
weights

453
00:28:51,310 --> 00:28:56,520
to decide what you are doing let's say
someone is creating SQL injection error

454
00:28:56,520 --> 00:28:56,990
message

455
00:28:56,990 --> 00:29:01,040
and he's coming from a torn at work
suspicious

456
00:29:01,040 --> 00:29:04,500
more suspicious than from a normal
Swisscom

457
00:29:04,500 --> 00:29:07,930
IP address someone is coming from the
internet

458
00:29:07,930 --> 00:29:13,050
intranet its missus Bishop spent all but

459
00:29:13,050 --> 00:29:16,160
you should also have a look Arab comes

460
00:29:16,160 --> 00:29:19,340
for example from took many fun miss the
pipe all

461
00:29:19,340 --> 00:29:22,700
this and ninety-nine percent of your
customers are coming from your

462
00:29:22,700 --> 00:29:26,580
is awful suspicion we could look for

463
00:29:26,580 --> 00:29:29,910
minus minus if there's a minus minus in
the spring

464
00:29:29,910 --> 00:29:33,590
it's really uncommon that and Norma name
contains the minus minus

465
00:29:33,590 --> 00:29:37,120
the thing at Fortis more common

466
00:29:37,120 --> 00:29:40,140
we could also use for her look for to be
ghost ring

467
00:29:40,140 --> 00:29:43,710
form a bit applications cannot

468
00:29:43,710 --> 00:29:47,340
a combination of thinking quotes with
the characters is all sore

469
00:29:47,340 --> 00:29:50,670
%uh possible to decide if it suspicious
or not

470
00:29:50,670 --> 00:29:55,700
I thought quite often ok or not so all
followed by a single called is less

471
00:29:55,700 --> 00:29:57,210
suspicious 10 HX

472
00:29:57,210 --> 00:30:01,740
followed by thing ice I know from French
pagers

473
00:30:01,740 --> 00:30:05,310
pound or and then they're using the
single quote so

474
00:30:05,310 --> 00:30:08,550
F

475
00:30:08,550 --> 00:30:12,590
socks for in in French work

476
00:30:12,590 --> 00:30:16,780
but they are a lot of different
possibilities to make dual

477
00:30:16,780 --> 00:30:21,850
prediction if something world become bat
I'll start

478
00:30:21,850 --> 00:30:26,310
you can at your and develop your own
metric and saying okay if someone is

479
00:30:26,310 --> 00:30:29,860
doing twice and using the format we
stopped a system

480
00:30:29,860 --> 00:30:35,060
of the prop to fuck you

481
00:30:35,060 --> 00:30:38,590
we have other ways to detect signal
injection

482
00:30:38,590 --> 00:30:41,760
without using error message us and
that's a

483
00:30:41,760 --> 00:30:47,730
a simple pot had full idea you can use
fake data or honey data

484
00:30:47,730 --> 00:30:51,930
was what is in it echoed to win he's
looking for something interesting

485
00:30:51,930 --> 00:30:56,050
and what we could do we create
interesting beat-up

486
00:30:56,050 --> 00:30:59,360
and if the state is interesting to take
a word downloaded

487
00:30:59,360 --> 00:31:03,020
from the internet or

488
00:31:03,020 --> 00:31:06,760
we are creating a table and the table
contains a new state that the state has

489
00:31:06,760 --> 00:31:08,960
not used by your application

490
00:31:08,960 --> 00:31:12,530
and this table contains a column called
pass what

491
00:31:12,530 --> 00:31:17,010
on celery or credit card and you know if
someone is

492
00:31:17,010 --> 00:31:20,670
accessing the stable this is not your
application

493
00:31:20,670 --> 00:31:24,320
but if you have any application server
is accessing to specific table

494
00:31:24,320 --> 00:31:27,990
you know that you are hecht on some of
the dbag

495
00:31:27,990 --> 00:31:31,190
no if it's coming really from the web
application process

496
00:31:31,190 --> 00:31:34,500
you know that you I hacked and someone
is accessing

497
00:31:34,500 --> 00:31:38,380
the two from my experience

498
00:31:38,380 --> 00:31:43,450
once you have a working single injection
string people are looking at

499
00:31:43,450 --> 00:31:46,590
columns Mar use or top columns or

500
00:31:46,590 --> 00:31:50,360
information schema columns and they're
looking for interesting stuff

501
00:31:50,360 --> 00:31:55,150
and pass what of French russians like
MBP motor power

502
00:31:55,150 --> 00:31:59,860
I to be cool those starting point

503
00:31:59,860 --> 00:32:02,880
by after you have few sequel injection
y'all

504
00:32:02,880 --> 00:32:05,970
retrieving data from 20 top columns then
you find

505
00:32:05,970 --> 00:32:09,120
the past what condom and then you are
starting

506
00:32:09,120 --> 00:32:13,100
those select data from this table

507
00:32:13,100 --> 00:32:18,170
and we can money twenty tables because
nobody else is using it we know if

508
00:32:18,170 --> 00:32:19,740
someone is doing it

509
00:32:19,740 --> 00:32:23,950
it's an attack an article has out of the
box the functionality quote for two

510
00:32:23,950 --> 00:32:25,480
private database

511
00:32:25,480 --> 00:32:29,640
and refer to private database you can
implement this functionality for free

512
00:32:29,640 --> 00:32:33,760
we are creating a table the table name
should the

513
00:32:33,760 --> 00:32:38,370
similar to dr. namely naming convention
of the application

514
00:32:38,370 --> 00:32:41,380
sofa table starts with T underscore this

515
00:32:41,380 --> 00:32:45,840
fake table should also contains the T
underscore

516
00:32:45,840 --> 00:32:50,260
and you're inserting data as can be
uninterrupted

517
00:32:50,260 --> 00:32:54,090
and be creative function and if I'm chin

518
00:32:54,090 --> 00:32:57,380
is doing our activity

519
00:32:57,380 --> 00:33:00,770
sending email locking account

520
00:33:00,770 --> 00:33:04,040
and at the end using dove

521
00:33:04,040 --> 00:33:07,660
they could cuban missile yes we are
signing dysfunction to a table

522
00:33:07,660 --> 00:33:12,020
whenever a someone is doing the

523
00:33:12,020 --> 00:33:15,240
is accessing the stable this function is
executed

524
00:33:15,240 --> 00:33:20,540
and to payload in this function is or
execute

525
00:33:20,540 --> 00:33:24,540
a similar approach is to use fake
functions

526
00:33:24,540 --> 00:33:30,290
developers nowadays saw all the time are
using obvious functioning

527
00:33:30,290 --> 00:33:35,010
um so a typical function name forty
crippling data is called

528
00:33:35,010 --> 00:33:38,230
the crypt so yeah and

529
00:33:38,230 --> 00:33:41,480
if you wanna take a and you find the the
cryptids

530
00:33:41,480 --> 00:33:45,440
own netcom to pass what field

531
00:33:45,440 --> 00:33:48,760
and it's normal that you call this
function so use a selected group from

532
00:33:48,760 --> 00:33:49,520
past what from

533
00:33:49,520 --> 00:33:52,950
epcot use of but

534
00:33:52,950 --> 00:33:57,260
in our case using the steak function
different functions is not

535
00:33:57,260 --> 00:34:00,440
be crippling to court the fake function
to

536
00:34:00,440 --> 00:34:05,370
affect function is sending Union are
looking to count

537
00:34:05,370 --> 00:34:09,320
and also depend to some 52 pen test
Sawant on a limb for youth

538
00:34:09,320 --> 00:34:12,669
can be really interesting to find
internal employees

539
00:34:12,669 --> 00:34:16,000
for DB is curious what's inside a
database

540
00:34:16,000 --> 00:34:23,000
he's probably smart enough to call this
function

541
00:34:23,120 --> 00:34:26,320
if the summary 50 pending databases

542
00:34:26,320 --> 00:34:29,600
and this approach looking at error
messages if

543
00:34:29,600 --> 00:34:32,870
really simple to implement you don't
need

544
00:34:32,870 --> 00:34:36,870
additional licenses and it's also easy
to

545
00:34:36,870 --> 00:34:40,730
the activate information implementation
it's transparent

546
00:34:40,730 --> 00:34:44,660
so it doesn't matter what kind of
application you are using

547
00:34:44,660 --> 00:34:47,730
it works out of the box the

548
00:34:47,730 --> 00:34:51,750
biggest problem in my opinion is good
decision for management

549
00:34:51,750 --> 00:34:55,160
should be stopped a system or or we
allow

550
00:34:55,160 --> 00:34:58,390
the couple's and this

551
00:34:58,390 --> 00:35:02,250
approach can also be useful for pen test
so if you activate

552
00:35:02,250 --> 00:35:05,860
those such a trick I in a pen test you
can

553
00:35:05,860 --> 00:35:10,710
find all the arrow messages you are road
creating two independent

554
00:35:10,710 --> 00:35:15,530
this case you should not stop the system
only though

555
00:35:15,530 --> 00:35:18,610
and information and a potential string
which most

556
00:35:18,610 --> 00:35:25,610
triggering the equity injection is sent
with a pent-up

557
00:35:26,940 --> 00:35:29,990
was little bit faster than expected

558
00:35:29,990 --> 00:35:30,730
any questions

