1
00:00:01,280 --> 00:00:03,280
there we go yes sir off

2
00:00:03,280 --> 00:00:05,040
of uh for a while and i started

3
00:00:05,040 --> 00:00:06,640
presenting on a different

4
00:00:06,640 --> 00:00:08,320
number of different topics from cloud

5
00:00:08,320 --> 00:00:09,920
security to network threat hunting and

6
00:00:09,920 --> 00:00:10,960
things like that

7
00:00:10,960 --> 00:00:14,000
but recently over the past

8
00:00:14,000 --> 00:00:16,239
month or so mitre has brought this back

9
00:00:16,239 --> 00:00:17,440
to the forefront

10
00:00:17,440 --> 00:00:19,199
as something that is is absolutely

11
00:00:19,199 --> 00:00:21,520
essential to anybody whenever they're

12
00:00:21,520 --> 00:00:23,199
talking about defense and how we can

13
00:00:23,199 --> 00:00:25,279
actually do defense correctly

14
00:00:25,279 --> 00:00:27,920
moving forward and the active defense

15
00:00:27,920 --> 00:00:28,720
concept

16
00:00:28,720 --> 00:00:30,400
i want to kind of set the stage when

17
00:00:30,400 --> 00:00:32,719
we're dealing with the legalities of

18
00:00:32,719 --> 00:00:34,559
this as we go through this next hour

19
00:00:34,559 --> 00:00:35,360
plus

20
00:00:35,360 --> 00:00:37,280
talking about active defense and cyber

21
00:00:37,280 --> 00:00:38,559
deception

22
00:00:38,559 --> 00:00:40,480
there's a number of cases that you can

23
00:00:40,480 --> 00:00:42,640
look at uh you can look at

24
00:00:42,640 --> 00:00:44,399
uh jerome hacking camp versus the united

25
00:00:44,399 --> 00:00:45,840
states of america the united states

26
00:00:45,840 --> 00:00:47,200
versus wallet act

27
00:00:47,200 --> 00:00:49,520
uh there's a ton of them out there but

28
00:00:49,520 --> 00:00:51,199
this one is my all-time favorite

29
00:00:51,199 --> 00:00:53,680
uh so in this particular case susan

30
00:00:53,680 --> 00:00:54,879
clements jeffrey

31
00:00:54,879 --> 00:00:56,960
is a uh was about was a substitute

32
00:00:56,960 --> 00:00:58,480
teacher in ohio

33
00:00:58,480 --> 00:01:02,000
and she was teaching a class and she

34
00:01:02,000 --> 00:01:03,520
had one of her students come up to her

35
00:01:03,520 --> 00:01:05,119
and say hey uh

36
00:01:05,119 --> 00:01:06,960
would you like to buy a macbook pro for

37
00:01:06,960 --> 00:01:08,560
50 bucks

38
00:01:08,560 --> 00:01:09,840
and she's thinking to herself this

39
00:01:09,840 --> 00:01:12,640
sounds totally legit and a smoking good

40
00:01:12,640 --> 00:01:13,360
deal

41
00:01:13,360 --> 00:01:15,200
so she said of course and one of the

42
00:01:15,200 --> 00:01:16,960
funny things about this particular case

43
00:01:16,960 --> 00:01:20,320
is she actually made the tr the sale

44
00:01:20,320 --> 00:01:23,360
with the student at a school bus stop

45
00:01:23,360 --> 00:01:26,320
so of course this particular notebook

46
00:01:26,320 --> 00:01:27,119
computer

47
00:01:27,119 --> 00:01:29,600
was stolen right it was actually stolen

48
00:01:29,600 --> 00:01:31,040
from another

49
00:01:31,040 --> 00:01:34,079
another school district okay she got

50
00:01:34,079 --> 00:01:35,600
home and she immediately started

51
00:01:35,600 --> 00:01:37,920
uh using the computer cyber sexting her

52
00:01:37,920 --> 00:01:38,880
boyfriend

53
00:01:38,880 --> 00:01:42,000
and while she was doing that uh absolute

54
00:01:42,000 --> 00:01:43,119
software had like the

55
00:01:43,119 --> 00:01:45,600
low jack type software for tracking a

56
00:01:45,600 --> 00:01:46,399
computer

57
00:01:46,399 --> 00:01:48,479
turning on the camera on the computer

58
00:01:48,479 --> 00:01:50,399
gaining access to that computer all the

59
00:01:50,399 --> 00:01:51,200
files

60
00:01:51,200 --> 00:01:52,640
and they started taking multiple

61
00:01:52,640 --> 00:01:54,560
pictures of susan clowns jeffrey quote

62
00:01:54,560 --> 00:01:55,040
unquote

63
00:01:55,040 --> 00:01:58,719
in various states of undress and sexual

64
00:01:58,719 --> 00:02:00,000
activity

65
00:02:00,000 --> 00:02:03,759
which is bad so she sued

66
00:02:03,759 --> 00:02:05,680
eventually absolute software settled out

67
00:02:05,680 --> 00:02:06,719
of court because they really didn't

68
00:02:06,719 --> 00:02:08,000
think that they were going to win this

69
00:02:08,000 --> 00:02:10,318
case but there was a ruling on whether

70
00:02:10,318 --> 00:02:12,319
or not the case could even move forward

71
00:02:12,319 --> 00:02:14,000
and the school district and absolute

72
00:02:14,000 --> 00:02:15,520
software said she

73
00:02:15,520 --> 00:02:18,480
had no case whatsoever because the

74
00:02:18,480 --> 00:02:19,840
computer system

75
00:02:19,840 --> 00:02:22,160
was not her computer it actually

76
00:02:22,160 --> 00:02:24,080
belonged to another school district

77
00:02:24,080 --> 00:02:26,400
and in this case judge walter rice ruled

78
00:02:26,400 --> 00:02:28,000
it is one thing to have a stolen

79
00:02:28,000 --> 00:02:29,200
computer system

80
00:02:29,200 --> 00:02:31,200
give its location information or an ip

81
00:02:31,200 --> 00:02:32,239
address in an

82
00:02:32,239 --> 00:02:34,319
effort to track it down it is something

83
00:02:34,319 --> 00:02:35,920
completely different

84
00:02:35,920 --> 00:02:38,640
violate federal wiretapping laws to do

85
00:02:38,640 --> 00:02:39,440
so

86
00:02:39,440 --> 00:02:42,480
so the point is when i'm talking about

87
00:02:42,480 --> 00:02:43,599
these things today

88
00:02:43,599 --> 00:02:46,239
if we want to worry about the legalities

89
00:02:46,239 --> 00:02:47,360
of what we're doing

90
00:02:47,360 --> 00:02:49,840
in active and engaged defense we want to

91
00:02:49,840 --> 00:02:51,519
worry about these legalities

92
00:02:51,519 --> 00:02:53,040
we need to make sure that we stay on

93
00:02:53,040 --> 00:02:55,040
this bright shiny line

94
00:02:55,040 --> 00:02:56,720
judge walter rice gave us this line and

95
00:02:56,720 --> 00:02:58,400
said ip address and locational

96
00:02:58,400 --> 00:02:59,920
information that's cool

97
00:02:59,920 --> 00:03:01,840
but as soon as we start gaining access

98
00:03:01,840 --> 00:03:03,840
to an attacker's computer system

99
00:03:03,840 --> 00:03:07,200
even if they are quote unquote evil

100
00:03:07,200 --> 00:03:10,400
attackers you do not have the right to

101
00:03:10,400 --> 00:03:11,040
break

102
00:03:11,040 --> 00:03:14,720
the law against law breakers

103
00:03:14,720 --> 00:03:16,159
so as i go through today i'm going to

104
00:03:16,159 --> 00:03:18,560
focus a lot on geolocation

105
00:03:18,560 --> 00:03:21,519
and i p address as we set this up okay

106
00:03:21,519 --> 00:03:22,000
so

107
00:03:22,000 --> 00:03:25,200
a larger conversation

108
00:03:25,680 --> 00:03:27,599
anytime i talk about active defense or i

109
00:03:27,599 --> 00:03:29,440
talk about cyber deception

110
00:03:29,440 --> 00:03:31,680
it's inevitable that i have someone

111
00:03:31,680 --> 00:03:33,040
bring up well

112
00:03:33,040 --> 00:03:36,159
that's not something anybody should do

113
00:03:36,159 --> 00:03:38,480
uh and we have quotes here from people

114
00:03:38,480 --> 00:03:40,400
that may disagree with me

115
00:03:40,400 --> 00:03:43,519
brian krebs said deception technologies

116
00:03:43,519 --> 00:03:44,879
are nice but advisable

117
00:03:44,879 --> 00:03:47,599
only if your organization is already

118
00:03:47,599 --> 00:03:48,799
doing 99

119
00:03:48,799 --> 00:03:51,040
of the rest of basic security stuff as

120
00:03:51,040 --> 00:03:52,720
it happens a lot of the really cool tech

121
00:03:52,720 --> 00:03:54,959
being advertised at rsa is for a very

122
00:03:54,959 --> 00:03:56,879
exclusive audience

123
00:03:56,879 --> 00:03:59,760
then jeff moss at a black hat conference

124
00:03:59,760 --> 00:04:00,799
in europe

125
00:04:00,799 --> 00:04:02,959
said he basically said and then i

126
00:04:02,959 --> 00:04:04,319
checked the canary oh

127
00:04:04,319 --> 00:04:06,640
he said i've never heard one speaker say

128
00:04:06,640 --> 00:04:08,640
and then i checked the canary or then i

129
00:04:08,640 --> 00:04:10,159
reviewed the deception tech

130
00:04:10,159 --> 00:04:12,319
who here is using deception technology

131
00:04:12,319 --> 00:04:13,840
and hardly any of the hands

132
00:04:13,840 --> 00:04:15,439
actually raised i think there was like

133
00:04:15,439 --> 00:04:17,279
four in the audience

134
00:04:17,279 --> 00:04:19,680
so the belief is that you really

135
00:04:19,680 --> 00:04:21,120
shouldn't do deception technology

136
00:04:21,120 --> 00:04:21,918
because

137
00:04:21,918 --> 00:04:23,759
really no one's doing deception

138
00:04:23,759 --> 00:04:26,400
technology or you shouldn't do deception

139
00:04:26,400 --> 00:04:27,520
technology

140
00:04:27,520 --> 00:04:30,080
because you should do everything else

141
00:04:30,080 --> 00:04:31,520
first

142
00:04:31,520 --> 00:04:33,759
well krebs we need to have a talk and by

143
00:04:33,759 --> 00:04:35,440
the way i respect the hell out of brian

144
00:04:35,440 --> 00:04:37,280
krebs i'm just kind of you know

145
00:04:37,280 --> 00:04:38,320
bringing him up here because of

146
00:04:38,320 --> 00:04:40,240
something he said but we have to have a

147
00:04:40,240 --> 00:04:41,520
talk

148
00:04:41,520 --> 00:04:43,520
we have to have a talk because if you

149
00:04:43,520 --> 00:04:45,120
look at organizations and how they

150
00:04:45,120 --> 00:04:46,960
discover that they were in fact

151
00:04:46,960 --> 00:04:49,600
breached and this graph is from the

152
00:04:49,600 --> 00:04:52,080
verizon data breach report from

153
00:04:52,080 --> 00:04:54,400
two years ago and the numbers haven't

154
00:04:54,400 --> 00:04:55,639
shifted much even since

155
00:04:55,639 --> 00:04:59,040
2013. the vast majority of organizations

156
00:04:59,040 --> 00:05:00,960
that were compromised

157
00:05:00,960 --> 00:05:03,280
found out they were compromised from

158
00:05:03,280 --> 00:05:05,039
external third parties

159
00:05:05,039 --> 00:05:06,639
i've gone through and i've highlighted

160
00:05:06,639 --> 00:05:08,320
every single one of the external

161
00:05:08,320 --> 00:05:10,560
third parties with little rectangles or

162
00:05:10,560 --> 00:05:11,919
red rectangles

163
00:05:11,919 --> 00:05:15,120
and over 67 percent

164
00:05:15,120 --> 00:05:17,440
of the detects that people discovered

165
00:05:17,440 --> 00:05:19,840
were from outside of their organization

166
00:05:19,840 --> 00:05:22,840
were outside of their organization's

167
00:05:22,840 --> 00:05:24,000
control

168
00:05:24,000 --> 00:05:25,759
you're looking in here you've got law

169
00:05:25,759 --> 00:05:28,240
enforcement responsible for 3.6

170
00:05:28,240 --> 00:05:32,880
antivirus is only responsible for 5.7

171
00:05:32,880 --> 00:05:36,840
your sim and log review 1.3

172
00:05:36,840 --> 00:05:39,120
percent so the whole idea that you

173
00:05:39,120 --> 00:05:39,600
should get

174
00:05:39,600 --> 00:05:41,280
everything else done in security

175
00:05:41,280 --> 00:05:43,280
correctly first

176
00:05:43,280 --> 00:05:47,440
is fundamentally at its core flawed

177
00:05:47,440 --> 00:05:50,080
and i'll discuss why it's flawed here as

178
00:05:50,080 --> 00:05:52,000
we progress throughout this session but

179
00:05:52,000 --> 00:05:53,199
the point is

180
00:05:53,199 --> 00:05:54,720
if you're looking at trying to just use

181
00:05:54,720 --> 00:05:56,479
the existing technologies

182
00:05:56,479 --> 00:05:58,400
that everyone else is using to try to

183
00:05:58,400 --> 00:05:59,919
defend your network

184
00:05:59,919 --> 00:06:01,600
then you're probably going to have a

185
00:06:01,600 --> 00:06:04,160
hard time of computer security

186
00:06:04,160 --> 00:06:06,400
so mitre actually jumped into the fray

187
00:06:06,400 --> 00:06:07,600
on this as well

188
00:06:07,600 --> 00:06:10,639
mitre released uh the matrix and this is

189
00:06:10,639 --> 00:06:12,000
predominantly the brainchild of

190
00:06:12,000 --> 00:06:14,240
christina fowler

191
00:06:14,240 --> 00:06:17,120
and this particular matrix is amazing

192
00:06:17,120 --> 00:06:17,600
because

193
00:06:17,600 --> 00:06:20,000
mitre as they were talking the matrix

194
00:06:20,000 --> 00:06:21,360
and as they were talking about cyber

195
00:06:21,360 --> 00:06:22,160
deception

196
00:06:22,160 --> 00:06:24,240
as they were working through the attack

197
00:06:24,240 --> 00:06:26,080
matrix from the enterprise side

198
00:06:26,080 --> 00:06:27,440
they realized that a lot of

199
00:06:27,440 --> 00:06:30,000
organizations were missing some key

200
00:06:30,000 --> 00:06:30,639
points

201
00:06:30,639 --> 00:06:33,039
of different attacks and detective

202
00:06:33,039 --> 00:06:34,319
capabilities

203
00:06:34,319 --> 00:06:37,360
and mitre realized that one of the only

204
00:06:37,360 --> 00:06:39,199
ways to actually address

205
00:06:39,199 --> 00:06:41,600
some of these deficiencies in these

206
00:06:41,600 --> 00:06:43,600
organizations ability to actually detect

207
00:06:43,600 --> 00:06:44,479
these attacks

208
00:06:44,479 --> 00:06:47,600
was to take an active defense

209
00:06:47,600 --> 00:06:50,960
stance so whenever you're talking about

210
00:06:50,960 --> 00:06:52,800
active defense with management or other

211
00:06:52,800 --> 00:06:53,759
people at work

212
00:06:53,759 --> 00:06:55,520
it's no longer the rantings of this

213
00:06:55,520 --> 00:06:56,800
crazy person

214
00:06:56,800 --> 00:06:58,639
at secure west virginia that you saw

215
00:06:58,639 --> 00:06:59,919
present

216
00:06:59,919 --> 00:07:01,440
you're now talking about something like

217
00:07:01,440 --> 00:07:02,960
mitre that's actually putting

218
00:07:02,960 --> 00:07:07,280
their weight behind cyber deception

219
00:07:07,280 --> 00:07:09,440
as not just a viable but not just a

220
00:07:09,440 --> 00:07:11,840
viable but a necessary part

221
00:07:11,840 --> 00:07:13,440
of security architectures for

222
00:07:13,440 --> 00:07:15,120
organizations moving forward

223
00:07:15,120 --> 00:07:16,960
so you see things here like decoy

224
00:07:16,960 --> 00:07:19,280
content decoy credentials

225
00:07:19,280 --> 00:07:22,560
uh decoin networks decoy system using

226
00:07:22,560 --> 00:07:22,960
that

227
00:07:22,960 --> 00:07:25,680
cyber deception we actually have the

228
00:07:25,680 --> 00:07:26,639
ability

229
00:07:26,639 --> 00:07:28,479
to change the methodologies and the

230
00:07:28,479 --> 00:07:30,240
approach of not just

231
00:07:30,240 --> 00:07:32,960
our security architectures but also the

232
00:07:32,960 --> 00:07:33,840
ability to

233
00:07:33,840 --> 00:07:36,479
change the approach of the attackers who

234
00:07:36,479 --> 00:07:38,400
are trying to break into our computer

235
00:07:38,400 --> 00:07:39,199
systems

236
00:07:39,199 --> 00:07:42,479
and that is absolutely essential

237
00:07:42,479 --> 00:07:45,280
so why would we do this so i have these

238
00:07:45,280 --> 00:07:46,639
rants that i give against threat

239
00:07:46,639 --> 00:07:49,280
intelligence feeds and i apologize

240
00:07:49,280 --> 00:07:50,639
if you're a huge fan of threat

241
00:07:50,639 --> 00:07:53,280
intelligence feeds because you're wrong

242
00:07:53,280 --> 00:07:55,199
um if you're looking at traditional

243
00:07:55,199 --> 00:07:56,879
threat intelligence feeds

244
00:07:56,879 --> 00:07:58,960
the vast majority of threat intelligence

245
00:07:58,960 --> 00:08:01,199
fees are purchasing and trying to

246
00:08:01,199 --> 00:08:02,000
implement

247
00:08:02,000 --> 00:08:05,599
blacklisted ips blacklisted urls

248
00:08:05,599 --> 00:08:08,080
blacklisted hashes and domains of

249
00:08:08,080 --> 00:08:09,360
systems

250
00:08:09,360 --> 00:08:11,280
all of these are what we call a thermal

251
00:08:11,280 --> 00:08:12,879
threat intelligence that means

252
00:08:12,879 --> 00:08:14,800
from an intelligence perspective the

253
00:08:14,800 --> 00:08:16,639
attackers may have used those ip

254
00:08:16,639 --> 00:08:19,199
addresses those hashes those urls

255
00:08:19,199 --> 00:08:22,479
a week ago a month ago even a day ago

256
00:08:22,479 --> 00:08:25,520
but it's not what they're using today

257
00:08:25,520 --> 00:08:27,280
right now to try to break into

258
00:08:27,280 --> 00:08:28,720
organizations

259
00:08:28,720 --> 00:08:30,879
now looking at thread intel and trying

260
00:08:30,879 --> 00:08:32,799
to understand the methodologies and the

261
00:08:32,799 --> 00:08:35,440
techniques that adversaries go through

262
00:08:35,440 --> 00:08:40,240
i think has a tremendous amount of value

263
00:08:40,240 --> 00:08:42,719
unfortunately the translation between

264
00:08:42,719 --> 00:08:44,720
the narrative of the overall attack

265
00:08:44,720 --> 00:08:46,000
methodology

266
00:08:46,000 --> 00:08:49,200
and the um and the ability for us to

267
00:08:49,200 --> 00:08:50,880
translate that into something

268
00:08:50,880 --> 00:08:52,800
that's a little bit more quantifiable

269
00:08:52,800 --> 00:08:55,920
and actionable is oftentimes lost

270
00:08:55,920 --> 00:08:58,000
so the cyber security infrastructure

271
00:08:58,000 --> 00:08:59,839
security agency sizza

272
00:08:59,839 --> 00:09:02,880
has been doing a great job and i think

273
00:09:02,880 --> 00:09:05,120
that there's a lot of really cool things

274
00:09:05,120 --> 00:09:07,120
whenever you review these summaries

275
00:09:07,120 --> 00:09:09,920
and these summaries are excellent threat

276
00:09:09,920 --> 00:09:10,959
intelligence

277
00:09:10,959 --> 00:09:13,760
sources but what do people take out of

278
00:09:13,760 --> 00:09:14,800
these sources

279
00:09:14,800 --> 00:09:17,920
and actually turn into ttps or

280
00:09:17,920 --> 00:09:19,519
indicators of compromises

281
00:09:19,519 --> 00:09:22,640
in their environment if you scroll down

282
00:09:22,640 --> 00:09:24,399
they'll go through and say well here's

283
00:09:24,399 --> 00:09:26,080
the ip addresses

284
00:09:26,080 --> 00:09:28,880
and the domains that these attackers

285
00:09:28,880 --> 00:09:30,160
used

286
00:09:30,160 --> 00:09:31,839
this is nice to know if you're doing

287
00:09:31,839 --> 00:09:33,600
research on a breach

288
00:09:33,600 --> 00:09:35,920
but trying to be proactive and blocking

289
00:09:35,920 --> 00:09:36,640
these

290
00:09:36,640 --> 00:09:38,800
is not going to stop an advanced

291
00:09:38,800 --> 00:09:39,839
attacker

292
00:09:39,839 --> 00:09:42,000
advanced companies like trusted sec and

293
00:09:42,000 --> 00:09:43,920
guardians rendition

294
00:09:43,920 --> 00:09:45,839
core all of these different companies

295
00:09:45,839 --> 00:09:47,120
that are out there

296
00:09:47,120 --> 00:09:48,720
they don't say well you know that

297
00:09:48,720 --> 00:09:50,240
company got us because their threat

298
00:09:50,240 --> 00:09:52,560
intelligence feeds were great

299
00:09:52,560 --> 00:09:54,880
no and that's because predominantly

300
00:09:54,880 --> 00:09:56,640
these threat intelligence fees

301
00:09:56,640 --> 00:09:58,640
are taking these ip addresses in these

302
00:09:58,640 --> 00:09:59,760
urls

303
00:09:59,760 --> 00:10:02,079
and they're turning them into signatures

304
00:10:02,079 --> 00:10:04,000
in things like firewalls

305
00:10:04,000 --> 00:10:07,519
what is really great is if you get down

306
00:10:07,519 --> 00:10:09,279
here to the bottom rather than just

307
00:10:09,279 --> 00:10:11,519
you know gathering ip addresses and

308
00:10:11,519 --> 00:10:12,640
things of that nature

309
00:10:12,640 --> 00:10:14,240
you actually get into the very

310
00:10:14,240 --> 00:10:16,160
techniques and the exploits that are

311
00:10:16,160 --> 00:10:17,680
actually being utilized

312
00:10:17,680 --> 00:10:20,880
by these attackers all right so

313
00:10:20,880 --> 00:10:22,800
getting away from just these standard

314
00:10:22,800 --> 00:10:24,480
these are the ip addresses that are

315
00:10:24,480 --> 00:10:28,560
used is incredibly important and instead

316
00:10:28,560 --> 00:10:31,040
trying to look at how these different

317
00:10:31,040 --> 00:10:32,640
techniques are utilizing

318
00:10:32,640 --> 00:10:34,720
the miter attack technique matrix

319
00:10:34,720 --> 00:10:36,560
techniques and making sure that we can

320
00:10:36,560 --> 00:10:37,760
detect those

321
00:10:37,760 --> 00:10:40,160
is absolutely critical for example if we

322
00:10:40,160 --> 00:10:42,800
go to miter

323
00:10:43,519 --> 00:10:47,839
go to the miter attack matrix

324
00:10:48,160 --> 00:10:50,560
these techniques the number of

325
00:10:50,560 --> 00:10:52,720
combinations and permutations of these

326
00:10:52,720 --> 00:10:53,920
techniques is almost

327
00:10:53,920 --> 00:10:56,160
infinite but if you look at the

328
00:10:56,160 --> 00:10:57,920
individual techniques

329
00:10:57,920 --> 00:11:01,200
they're finite so if you try to collect

330
00:11:01,200 --> 00:11:03,200
all the different apt groups and how

331
00:11:03,200 --> 00:11:05,040
they use these different combinations

332
00:11:05,040 --> 00:11:06,720
you're going to be dealing with this

333
00:11:06,720 --> 00:11:09,200
insane amount of combinations

334
00:11:09,200 --> 00:11:11,120
but if you look at it you say okay what

335
00:11:11,120 --> 00:11:12,560
is our

336
00:11:12,560 --> 00:11:14,560
what is our mitigation for lateral

337
00:11:14,560 --> 00:11:15,920
movement you can

338
00:11:15,920 --> 00:11:17,680
mitigate and shut down lateral movement

339
00:11:17,680 --> 00:11:19,440
in most of the techniques available to

340
00:11:19,440 --> 00:11:20,160
an attacker

341
00:11:20,160 --> 00:11:22,000
simply by doing network segmentation and

342
00:11:22,000 --> 00:11:23,200
turning on your firewalls

343
00:11:23,200 --> 00:11:25,360
by the way network segmentation is part

344
00:11:25,360 --> 00:11:26,640
of miter shield

345
00:11:26,640 --> 00:11:28,800
if you're looking at detecting command

346
00:11:28,800 --> 00:11:31,040
and control and data exfiltration

347
00:11:31,040 --> 00:11:32,959
you can take care of a lot of that by

348
00:11:32,959 --> 00:11:34,160
doing really solid

349
00:11:34,160 --> 00:11:36,560
network traffic analysis which by the

350
00:11:36,560 --> 00:11:38,399
way is in the miter attack

351
00:11:38,399 --> 00:11:41,200
technique matrix for shield and active

352
00:11:41,200 --> 00:11:42,560
defense

353
00:11:42,560 --> 00:11:45,200
so you can see where mitre looked at

354
00:11:45,200 --> 00:11:46,720
what people were doing

355
00:11:46,720 --> 00:11:49,440
for trying to implement security and

356
00:11:49,440 --> 00:11:50,639
they're like okay okay

357
00:11:50,639 --> 00:11:52,480
yeah we got it this is the attack matrix

358
00:11:52,480 --> 00:11:53,839
okay so we need to go through and block

359
00:11:53,839 --> 00:11:55,600
these ip addresses when we're saying

360
00:11:55,600 --> 00:11:57,760
no we need to block these hashes and

361
00:11:57,760 --> 00:11:58,639
we're safe

362
00:11:58,639 --> 00:12:00,880
no that is not what they were talking

363
00:12:00,880 --> 00:12:02,720
about but if we can abstract

364
00:12:02,720 --> 00:12:04,800
up a little bit all of a sudden we get

365
00:12:04,800 --> 00:12:06,079
very powerful

366
00:12:06,079 --> 00:12:08,240
in what we can actually detect and when

367
00:12:08,240 --> 00:12:09,839
you're talking about active defense and

368
00:12:09,839 --> 00:12:10,880
cyber deception

369
00:12:10,880 --> 00:12:13,839
you're talking about threat intel about

370
00:12:13,839 --> 00:12:14,399
what's

371
00:12:14,399 --> 00:12:17,839
attacking your network right

372
00:12:17,839 --> 00:12:21,440
now right now

373
00:12:21,440 --> 00:12:23,360
and the theory about this you know and

374
00:12:23,360 --> 00:12:24,880
why this is important and how this

375
00:12:24,880 --> 00:12:27,440
actually changes the attacker's behavior

376
00:12:27,440 --> 00:12:29,440
in the world of social sciences there's

377
00:12:29,440 --> 00:12:31,680
this theory of broken windows

378
00:12:31,680 --> 00:12:33,360
if you have a neighborhood that has lots

379
00:12:33,360 --> 00:12:35,200
and lots of broken windows

380
00:12:35,200 --> 00:12:36,880
you'll have criminals that'll be like

381
00:12:36,880 --> 00:12:38,959
well the ability for

382
00:12:38,959 --> 00:12:40,800
you know law enforcement to stop crime

383
00:12:40,800 --> 00:12:42,639
here is low i'm going to start

384
00:12:42,639 --> 00:12:44,320
graffitiing things or i'm going to start

385
00:12:44,320 --> 00:12:46,079
stealing things the point is

386
00:12:46,079 --> 00:12:48,320
the people that commit crimes tend to

387
00:12:48,320 --> 00:12:49,360
commit crimes

388
00:12:49,360 --> 00:12:51,920
associated with the perceived risk of

389
00:12:51,920 --> 00:12:52,880
that crime

390
00:12:52,880 --> 00:12:54,240
so if they think that there's a really

391
00:12:54,240 --> 00:12:55,279
high risk that they're going to get

392
00:12:55,279 --> 00:12:56,480
caught they're probably not going to

393
00:12:56,480 --> 00:12:57,360
commit crimes

394
00:12:57,360 --> 00:13:00,160
now this is incredibly controversial um

395
00:13:00,160 --> 00:13:02,000
especially on its implementation

396
00:13:02,000 --> 00:13:03,680
uh new york city implement this in a

397
00:13:03,680 --> 00:13:05,279
couple of other cities and i won't get

398
00:13:05,279 --> 00:13:06,320
too much into that

399
00:13:06,320 --> 00:13:08,160
but from a psychological perspective

400
00:13:08,160 --> 00:13:09,600
it's absolutely

401
00:13:09,600 --> 00:13:11,760
true that when criminals believe that

402
00:13:11,760 --> 00:13:14,399
there is a higher risk to an activity

403
00:13:14,399 --> 00:13:17,279
an illegal activity their likelihood of

404
00:13:17,279 --> 00:13:20,560
doing that illegal activity goes down

405
00:13:20,560 --> 00:13:23,120
the other thing i want to get across is

406
00:13:23,120 --> 00:13:24,160
when you're looking

407
00:13:24,160 --> 00:13:27,040
at nation state level attackers they

408
00:13:27,040 --> 00:13:27,920
generally have

409
00:13:27,920 --> 00:13:31,279
one rule don't get

410
00:13:31,279 --> 00:13:33,600
caught i know this because i've done

411
00:13:33,600 --> 00:13:35,440
this for the intelligence community i've

412
00:13:35,440 --> 00:13:36,880
done this for law enforcement

413
00:13:36,880 --> 00:13:38,880
i've done this for dod and that is

414
00:13:38,880 --> 00:13:40,079
pretty much the big rule that they

415
00:13:40,079 --> 00:13:41,600
always come back to it's like oh by the

416
00:13:41,600 --> 00:13:43,360
way when you're setting up these servers

417
00:13:43,360 --> 00:13:44,959
make sure it's not attributed don't get

418
00:13:44,959 --> 00:13:47,040
caught uh they might come and kill you

419
00:13:47,040 --> 00:13:48,240
and your family in your sleep

420
00:13:48,240 --> 00:13:51,440
have fun toodles don't

421
00:13:51,440 --> 00:13:54,480
get caught you don't want to burn a true

422
00:13:54,480 --> 00:13:55,120
ttp

423
00:13:55,120 --> 00:13:57,519
you can burn the individual hashes burn

424
00:13:57,519 --> 00:13:58,720
the ip addresses

425
00:13:58,720 --> 00:14:00,880
but if you're using a specific technique

426
00:14:00,880 --> 00:14:02,160
tactic or

427
00:14:02,160 --> 00:14:05,199
tool or procedure then you really want

428
00:14:05,199 --> 00:14:06,160
to make sure that you

429
00:14:06,160 --> 00:14:09,279
do not get caught at all with what

430
00:14:09,279 --> 00:14:10,160
you're doing

431
00:14:10,160 --> 00:14:11,920
so let's try to figure out how we can

432
00:14:11,920 --> 00:14:13,920
increase that risk for the attacker

433
00:14:13,920 --> 00:14:16,079
doing real life threat intelligence

434
00:14:16,079 --> 00:14:17,920
through active defense

435
00:14:17,920 --> 00:14:19,920
and put the attackers a little bit

436
00:14:19,920 --> 00:14:22,959
closer to breaking their one rule

437
00:14:22,959 --> 00:14:25,120
so getting started i'll spend a lot of

438
00:14:25,120 --> 00:14:27,199
time talking about canary tokens

439
00:14:27,199 --> 00:14:28,560
and then i'm going to share with you

440
00:14:28,560 --> 00:14:30,399
adhd and what we can do

441
00:14:30,399 --> 00:14:32,000
with the active defense harbinger

442
00:14:32,000 --> 00:14:33,440
distribution

443
00:14:33,440 --> 00:14:34,959
and i'll do some live demos and show you

444
00:14:34,959 --> 00:14:36,639
some stuff as we progress throughout

445
00:14:36,639 --> 00:14:37,360
today

446
00:14:37,360 --> 00:14:40,079
so if you're looking at uh canary tokens

447
00:14:40,079 --> 00:14:42,079
this is by think it's your own mirror

448
00:14:42,079 --> 00:14:45,199
and um uh what's his name completely

449
00:14:45,199 --> 00:14:46,480
forgot um

450
00:14:46,480 --> 00:14:48,399
i'll come back to it uh but roone mears

451
00:14:48,399 --> 00:14:50,399
company thinkus has a lot of

452
00:14:50,399 --> 00:14:52,560
technologies based on honey pots

453
00:14:52,560 --> 00:14:54,880
and they release this wonderful website

454
00:14:54,880 --> 00:14:55,920
for free

455
00:14:55,920 --> 00:14:58,079
that gives you the ability to create all

456
00:14:58,079 --> 00:14:59,680
kinds of attributional

457
00:14:59,680 --> 00:15:02,319
technology

458
00:15:03,600 --> 00:15:05,760
so we go to canary tokens you can

459
00:15:05,760 --> 00:15:07,760
generate the type of token

460
00:15:07,760 --> 00:15:09,519
and you can do it on the fly and let me

461
00:15:09,519 --> 00:15:10,959
show you how quick and easy it is i want

462
00:15:10,959 --> 00:15:11,199
to

463
00:15:11,199 --> 00:15:12,959
generate a word document i put in an

464
00:15:12,959 --> 00:15:15,360
email address i put in a little tag

465
00:15:15,360 --> 00:15:17,279
associated with this specific document

466
00:15:17,279 --> 00:15:19,040
create the document download the

467
00:15:19,040 --> 00:15:21,040
document and now when i

468
00:15:21,040 --> 00:15:24,160
open this document up it pops up

469
00:15:24,160 --> 00:15:25,839
and it says enable editing i'll talk

470
00:15:25,839 --> 00:15:27,920
about that more here just a little bit

471
00:15:27,920 --> 00:15:29,360
it there's nothing in it you can add

472
00:15:29,360 --> 00:15:31,279
whatever you want into it look at me mom

473
00:15:31,279 --> 00:15:32,560
i'm hacking

474
00:15:32,560 --> 00:15:34,240
um you can put anything you want into

475
00:15:34,240 --> 00:15:36,160
this particular document easy peasy to

476
00:15:36,160 --> 00:15:36,880
do

477
00:15:36,880 --> 00:15:38,399
um go ahead and save it it doesn't

478
00:15:38,399 --> 00:15:40,079
matter but if i go back to my

479
00:15:40,079 --> 00:15:42,959
token and i look at the history of this

480
00:15:42,959 --> 00:15:43,920
token

481
00:15:43,920 --> 00:15:47,360
it put a pin right on top of the town

482
00:15:47,360 --> 00:15:49,600
i'm attacking quote unquote attacking

483
00:15:49,600 --> 00:15:52,320
from which is spearfish south dakota

484
00:15:52,320 --> 00:15:54,000
resolution is not that great but later

485
00:15:54,000 --> 00:15:55,920
on this presentation i will go into some

486
00:15:55,920 --> 00:15:58,160
detail about how we can get

487
00:15:58,160 --> 00:16:01,279
much much much much better resolution uh

488
00:16:01,279 --> 00:16:02,880
a little bit later so just sit tight

489
00:16:02,880 --> 00:16:04,639
sit tight with me for just a few moments

490
00:16:04,639 --> 00:16:06,880
so it's amazing what you can do

491
00:16:06,880 --> 00:16:10,160
so when we're creating these different

492
00:16:10,160 --> 00:16:12,079
these different files right we're

493
00:16:12,079 --> 00:16:14,160
creating decoy content

494
00:16:14,160 --> 00:16:15,600
now if you're going to implement active

495
00:16:15,600 --> 00:16:17,440
defense and cyber deception

496
00:16:17,440 --> 00:16:18,720
and you're going to implement it

497
00:16:18,720 --> 00:16:20,959
correctly you need to make sure that you

498
00:16:20,959 --> 00:16:22,560
put the content

499
00:16:22,560 --> 00:16:25,839
in the proper place that an attacker

500
00:16:25,839 --> 00:16:28,079
will actually go i want you to think of

501
00:16:28,079 --> 00:16:29,600
this in terms of hunting

502
00:16:29,600 --> 00:16:32,160
with hunting you generally don't just go

503
00:16:32,160 --> 00:16:34,240
walking around the woods hoping you see

504
00:16:34,240 --> 00:16:34,959
something

505
00:16:34,959 --> 00:16:37,040
that you're hunting if you do it

506
00:16:37,040 --> 00:16:38,639
correctly which by the way there's

507
00:16:38,639 --> 00:16:41,040
tons of people huh that way and great at

508
00:16:41,040 --> 00:16:42,079
that point if you're just walking

509
00:16:42,079 --> 00:16:43,440
through the woods you're not hunting

510
00:16:43,440 --> 00:16:44,959
you're just drinking in the woods with

511
00:16:44,959 --> 00:16:48,079
guns if you are actually hunting

512
00:16:48,079 --> 00:16:50,480
you're going to try to find game trails

513
00:16:50,480 --> 00:16:52,160
you're going to try to find where your

514
00:16:52,160 --> 00:16:52,639
prey

515
00:16:52,639 --> 00:16:54,959
actually is you're going to put up game

516
00:16:54,959 --> 00:16:55,680
cameras

517
00:16:55,680 --> 00:16:57,120
and you're going to try to watch what

518
00:16:57,120 --> 00:16:58,959
time do they show up at this particular

519
00:16:58,959 --> 00:17:00,399
point how do they move

520
00:17:00,399 --> 00:17:02,160
what do they think fly fishing is the

521
00:17:02,160 --> 00:17:03,759
exact same thing

522
00:17:03,759 --> 00:17:05,199
i desperately want to come back to west

523
00:17:05,199 --> 00:17:06,799
virginia and go fly fishing i

524
00:17:06,799 --> 00:17:08,559
you know i heard you guys have some good

525
00:17:08,559 --> 00:17:10,480
fishing out there and if you're fly

526
00:17:10,480 --> 00:17:11,119
fishing

527
00:17:11,119 --> 00:17:12,720
you don't just go up to a river and just

528
00:17:12,720 --> 00:17:15,039
start casting you cast in the right

529
00:17:15,039 --> 00:17:15,679
areas

530
00:17:15,679 --> 00:17:17,679
right in front of rocks right behind

531
00:17:17,679 --> 00:17:19,599
rocks you've got little areas with

532
00:17:19,599 --> 00:17:21,439
whirlpools and swirls

533
00:17:21,439 --> 00:17:22,959
you're going to be casting in the right

534
00:17:22,959 --> 00:17:25,599
places and when we are talking about

535
00:17:25,599 --> 00:17:27,520
cyber deception and active defense

536
00:17:27,520 --> 00:17:30,080
it's no different we're going to put our

537
00:17:30,080 --> 00:17:31,919
attributional technologies and our

538
00:17:31,919 --> 00:17:33,679
active defense technologies

539
00:17:33,679 --> 00:17:36,720
in the certain places where we expect

540
00:17:36,720 --> 00:17:39,760
that attacker to actually go and the

541
00:17:39,760 --> 00:17:41,440
best way to learn how to do this

542
00:17:41,440 --> 00:17:44,240
is actually get familiar with attacker

543
00:17:44,240 --> 00:17:45,440
tactics and techniques

544
00:17:45,440 --> 00:17:48,240
take a class on pen testing and how

545
00:17:48,240 --> 00:17:50,080
attackers and pen testers move

546
00:17:50,080 --> 00:17:52,240
laterally and as you're watching that

547
00:17:52,240 --> 00:17:54,400
class start to tie together

548
00:17:54,400 --> 00:17:56,960
where can i drop a file okay attackers

549
00:17:56,960 --> 00:17:58,559
and pen testers

550
00:17:58,559 --> 00:18:00,640
get access to a workstation they do a

551
00:18:00,640 --> 00:18:01,600
password spray

552
00:18:01,600 --> 00:18:03,200
how are we going to detect that password

553
00:18:03,200 --> 00:18:05,120
spray they get on a workstation they

554
00:18:05,120 --> 00:18:06,799
start searching for files with the word

555
00:18:06,799 --> 00:18:07,679
password

556
00:18:07,679 --> 00:18:09,919
or social security numbers or whatever

557
00:18:09,919 --> 00:18:11,679
in it how do i put in

558
00:18:11,679 --> 00:18:14,000
decoy content so when they search for

559
00:18:14,000 --> 00:18:14,720
that file

560
00:18:14,720 --> 00:18:17,360
they pull up one of my honey docs they

561
00:18:17,360 --> 00:18:17,760
do

562
00:18:17,760 --> 00:18:19,919
website cloning how can i actually set

563
00:18:19,919 --> 00:18:21,760
up attributional technologies when they

564
00:18:21,760 --> 00:18:23,840
try to clone my website

565
00:18:23,840 --> 00:18:25,679
i'll be able to detect that somebody has

566
00:18:25,679 --> 00:18:27,039
cloned my website

567
00:18:27,039 --> 00:18:29,120
so you can actually react to that you're

568
00:18:29,120 --> 00:18:30,400
putting the content

569
00:18:30,400 --> 00:18:31,760
you're putting the active defense

570
00:18:31,760 --> 00:18:34,160
concepts in the right place

571
00:18:34,160 --> 00:18:37,360
to actually detect the attacker so i'd

572
00:18:37,360 --> 00:18:39,120
also like to ask you to check out

573
00:18:39,120 --> 00:18:41,679
adhd the active defense harbinger

574
00:18:41,679 --> 00:18:42,640
distribution

575
00:18:42,640 --> 00:18:44,240
i just so happen to have it up and

576
00:18:44,240 --> 00:18:46,480
running here let me start

577
00:18:46,480 --> 00:18:49,520
this up for you all right

578
00:18:49,520 --> 00:18:52,960
so this is adhd

579
00:18:55,039 --> 00:18:57,360
there we go and the active defense

580
00:18:57,360 --> 00:18:59,360
harbinger distribution has a wide number

581
00:18:59,360 --> 00:19:00,480
of different tools

582
00:19:00,480 --> 00:19:03,600
some of them like honey badger that

583
00:19:03,600 --> 00:19:04,080
gives you

584
00:19:04,080 --> 00:19:06,720
really hyperactive accurate geolocation

585
00:19:06,720 --> 00:19:07,919
information

586
00:19:07,919 --> 00:19:10,480
are installed and ready to go and the

587
00:19:10,480 --> 00:19:12,160
way that we have broken up the active

588
00:19:12,160 --> 00:19:14,000
defense harbinger distribution

589
00:19:14,000 --> 00:19:16,000
is a lot of the honeypot utilities and

590
00:19:16,000 --> 00:19:17,840
the different tools that you would use

591
00:19:17,840 --> 00:19:19,440
are broken up as soon as you open the

592
00:19:19,440 --> 00:19:21,120
browser so if you want to learn how to

593
00:19:21,120 --> 00:19:22,559
use artillery you just select

594
00:19:22,559 --> 00:19:24,160
artillery and it gives you all the

595
00:19:24,160 --> 00:19:25,840
instructions to get trusted sex

596
00:19:25,840 --> 00:19:27,120
artillery up and running

597
00:19:27,120 --> 00:19:28,960
you want to use port spoof great here's

598
00:19:28,960 --> 00:19:30,559
step-by-step instructions

599
00:19:30,559 --> 00:19:32,400
on how to run port spoof on the

600
00:19:32,400 --> 00:19:34,480
distribution you want to do attribution

601
00:19:34,480 --> 00:19:36,080
and do honey badger great

602
00:19:36,080 --> 00:19:37,679
here's the instructions to get honey

603
00:19:37,679 --> 00:19:39,360
badger up and running

604
00:19:39,360 --> 00:19:41,919
um on this particular distribution you

605
00:19:41,919 --> 00:19:43,440
want to move to full attack we've got

606
00:19:43,440 --> 00:19:45,919
browser exploitation framework gcat

607
00:19:45,919 --> 00:19:49,120
ghostwriting java web attack recon ng

608
00:19:49,120 --> 00:19:50,880
social engineering toolkit and all the

609
00:19:50,880 --> 00:19:53,120
credentials are here so think of this uh

610
00:19:53,120 --> 00:19:54,160
you were talking about

611
00:19:54,160 --> 00:19:56,240
backtrack at the beginning john was i

612
00:19:56,240 --> 00:19:57,679
thought that that was awesome

613
00:19:57,679 --> 00:20:00,640
it's kind of like kali linux but for

614
00:20:00,640 --> 00:20:02,799
defenders that are doing active defense

615
00:20:02,799 --> 00:20:05,840
uh this is a darpa funded project

616
00:20:05,840 --> 00:20:08,240
and they paid us money at black hills

617
00:20:08,240 --> 00:20:10,400
information security and secure ideas

618
00:20:10,400 --> 00:20:12,640
to develop this and release it for free

619
00:20:12,640 --> 00:20:14,799
you can absolutely use it if you want

620
00:20:14,799 --> 00:20:16,159
doesn't cost anything all the

621
00:20:16,159 --> 00:20:18,000
instructions are there we're trying to

622
00:20:18,000 --> 00:20:19,679
reduce the overall barrier for you

623
00:20:19,679 --> 00:20:20,000
getting

624
00:20:20,000 --> 00:20:22,159
involved in this to make it as cheap and

625
00:20:22,159 --> 00:20:23,600
as easy as possible

626
00:20:23,600 --> 00:20:25,840
to get started doing cyber deception

627
00:20:25,840 --> 00:20:27,360
technologies and active defense

628
00:20:27,360 --> 00:20:28,480
so let's go through some attack

629
00:20:28,480 --> 00:20:30,559
methodologies this is not exhaustive

630
00:20:30,559 --> 00:20:31,520
like

631
00:20:31,520 --> 00:20:34,880
at all i mean not even close folks um

632
00:20:34,880 --> 00:20:37,280
this is uh i just got done literally

633
00:20:37,280 --> 00:20:39,280
yesterday teaching a two-day class for

634
00:20:39,280 --> 00:20:39,840
you all

635
00:20:39,840 --> 00:20:41,679
um on these things and there's still

636
00:20:41,679 --> 00:20:43,360
more i actually have a full six day

637
00:20:43,360 --> 00:20:44,080
class

638
00:20:44,080 --> 00:20:47,200
on cyber deception so it's it's

639
00:20:47,200 --> 00:20:49,760
a lot here okay so let's set up a

640
00:20:49,760 --> 00:20:50,720
scenario

641
00:20:50,720 --> 00:20:53,120
recon whenever you think about what an

642
00:20:53,120 --> 00:20:54,159
attacker does

643
00:20:54,159 --> 00:20:55,600
they're gonna go to websites like

644
00:20:55,600 --> 00:20:57,679
showdown they're gonna go through

645
00:20:57,679 --> 00:20:59,200
and they're gonna go to linkedin they're

646
00:20:59,200 --> 00:21:00,559
gonna go through they're gonna try to

647
00:21:00,559 --> 00:21:01,760
find out as much about your

648
00:21:01,760 --> 00:21:04,720
organization as possible before they

649
00:21:04,720 --> 00:21:05,200
even

650
00:21:05,200 --> 00:21:07,919
attack your organization how can we mess

651
00:21:07,919 --> 00:21:08,559
with that

652
00:21:08,559 --> 00:21:10,000
there's a number of ways you can create

653
00:21:10,000 --> 00:21:11,760
fake linkedin accounts and all kinds of

654
00:21:11,760 --> 00:21:12,480
fun things

655
00:21:12,480 --> 00:21:14,320
but i'm going to focus on one of them

656
00:21:14,320 --> 00:21:15,679
i'm going to focus on one of them here

657
00:21:15,679 --> 00:21:17,200
over this next section

658
00:21:17,200 --> 00:21:22,000
so in aws you have these s3 buckets

659
00:21:22,000 --> 00:21:25,679
and these s3 buckets you can

660
00:21:29,840 --> 00:21:32,799
this whole s3 bucket problem is if

661
00:21:32,799 --> 00:21:34,240
you're watching the news

662
00:21:34,240 --> 00:21:35,919
there's tons of organizations that are

663
00:21:35,919 --> 00:21:37,520
getting compromised via

664
00:21:37,520 --> 00:21:41,120
open or insecure s3 buckets just

665
00:21:41,120 --> 00:21:43,440
tons of exploits and tons of things

666
00:21:43,440 --> 00:21:45,120
floating around out there

667
00:21:45,120 --> 00:21:46,559
that you know it's in the news

668
00:21:46,559 --> 00:21:47,679
constantly i'll show you some of these

669
00:21:47,679 --> 00:21:48,960
here in just a second

670
00:21:48,960 --> 00:21:50,480
and it's not just attackers that are

671
00:21:50,480 --> 00:21:52,960
doing this a lot of pen testing firms

672
00:21:52,960 --> 00:21:53,200
are

673
00:21:53,200 --> 00:21:55,200
scouring the internet for open s3

674
00:21:55,200 --> 00:21:57,440
buckets and when they find it they go

675
00:21:57,440 --> 00:22:00,640
right to wired or decipher or some type

676
00:22:00,640 --> 00:22:02,159
of internet news magazine

677
00:22:02,159 --> 00:22:04,159
and they're like oh i found this yeah

678
00:22:04,159 --> 00:22:05,919
it's it's this weird marketing stunt but

679
00:22:05,919 --> 00:22:06,960
it works for us

680
00:22:06,960 --> 00:22:09,760
so how do we mess with them what you can

681
00:22:09,760 --> 00:22:10,640
do

682
00:22:10,640 --> 00:22:13,760
in canary tokens is you can generate an

683
00:22:13,760 --> 00:22:14,880
aws

684
00:22:14,880 --> 00:22:18,720
key token and you can put this file up

685
00:22:18,720 --> 00:22:19,520
somewhere

686
00:22:19,520 --> 00:22:22,880
on a web server and robots.txt somewhere

687
00:22:22,880 --> 00:22:26,080
you could put it up on github maybe

688
00:22:26,080 --> 00:22:27,679
put it up on github and if the attacker

689
00:22:27,679 --> 00:22:28,880
is crawling through and seeing what

690
00:22:28,880 --> 00:22:31,120
github repositories your company has

691
00:22:31,120 --> 00:22:33,120
they're going to find these aws keys and

692
00:22:33,120 --> 00:22:34,720
try to authenticate

693
00:22:34,720 --> 00:22:37,919
to this aws s3 bucket there's nothing

694
00:22:37,919 --> 00:22:38,559
there

695
00:22:38,559 --> 00:22:40,080
but as soon as they import this thing

696
00:22:40,080 --> 00:22:42,159
into like s3 browser

697
00:22:42,159 --> 00:22:44,159
or cyberduck or whatever tool they're

698
00:22:44,159 --> 00:22:45,840
using to try to access

699
00:22:45,840 --> 00:22:48,000
s3 buckets it will automatically

700
00:22:48,000 --> 00:22:49,200
generate an alert

701
00:22:49,200 --> 00:22:50,880
of exactly where that particular

702
00:22:50,880 --> 00:22:53,200
attacker is trying to come from

703
00:22:53,200 --> 00:22:54,720
so this is what the trigger looks like

704
00:22:54,720 --> 00:22:56,240
it just pops up and it says

705
00:22:56,240 --> 00:22:58,080
hey unable to perform the requested

706
00:22:58,080 --> 00:22:59,600
action doesn't look like the bucket's

707
00:22:59,600 --> 00:23:00,080
there

708
00:23:00,080 --> 00:23:02,799
but on the back end we get an alert and

709
00:23:02,799 --> 00:23:04,880
it says that the aws api

710
00:23:04,880 --> 00:23:07,840
token key was fired the specific canary

711
00:23:07,840 --> 00:23:09,360
token gets a random string and a

712
00:23:09,360 --> 00:23:10,240
reminder

713
00:23:10,240 --> 00:23:12,000
and then of course the token type is the

714
00:23:12,000 --> 00:23:13,679
aws keys and you

715
00:23:13,679 --> 00:23:16,880
get the actual source ip address of the

716
00:23:16,880 --> 00:23:17,600
attacker

717
00:23:17,600 --> 00:23:20,840
that is trying to use this particular s3

718
00:23:20,840 --> 00:23:23,360
bucket so some context

719
00:23:23,360 --> 00:23:26,000
as i mentioned earlier attackers love

720
00:23:26,000 --> 00:23:27,120
looking for github

721
00:23:27,120 --> 00:23:29,760
to find aws keys we do this all the time

722
00:23:29,760 --> 00:23:31,679
at black hills information security

723
00:23:31,679 --> 00:23:33,120
if we're trying to break into an

724
00:23:33,120 --> 00:23:36,159
organization sure enough if they have s3

725
00:23:36,159 --> 00:23:37,679
buckets that are open or keys that we

726
00:23:37,679 --> 00:23:38,400
can use

727
00:23:38,400 --> 00:23:40,320
we're going to leverage those to gain

728
00:23:40,320 --> 00:23:41,679
access to the environment

729
00:23:41,679 --> 00:23:44,000
it's all about putting this active

730
00:23:44,000 --> 00:23:44,880
defense

731
00:23:44,880 --> 00:23:47,760
like little like trail of you know the

732
00:23:47,760 --> 00:23:49,120
breadcrumbs

733
00:23:49,120 --> 00:23:50,480
where an attacker is going to come

734
00:23:50,480 --> 00:23:52,240
across them and then

735
00:23:52,240 --> 00:23:53,520
lead them to the point where you can

736
00:23:53,520 --> 00:23:56,080
start attributing exactly where they are

737
00:23:56,080 --> 00:23:59,039
as an attacker by the way could somebody

738
00:23:59,039 --> 00:24:01,039
put in the chat the discord channel

739
00:24:01,039 --> 00:24:02,559
because i'd like to watch the questions

740
00:24:02,559 --> 00:24:03,360
and i realized

741
00:24:03,360 --> 00:24:05,120
i don't have the discord questions up

742
00:24:05,120 --> 00:24:06,480
here all right

743
00:24:06,480 --> 00:24:09,279
so now let's talk about executables i'm

744
00:24:09,279 --> 00:24:11,200
actually going to create and utilize an

745
00:24:11,200 --> 00:24:12,240
executable

746
00:24:12,240 --> 00:24:14,240
a little bit later on this morning we'll

747
00:24:14,240 --> 00:24:16,240
show you how we can actually do that

748
00:24:16,240 --> 00:24:19,520
and with that executable what we're

749
00:24:19,520 --> 00:24:20,400
doing

750
00:24:20,400 --> 00:24:22,240
is we're creating an executable that as

751
00:24:22,240 --> 00:24:24,000
soon as it opens it's going to beacon

752
00:24:24,000 --> 00:24:24,799
back

753
00:24:24,799 --> 00:24:27,279
to the defenders right so how would you

754
00:24:27,279 --> 00:24:28,720
get an attacker to run

755
00:24:28,720 --> 00:24:30,799
that particular executable uh if you

756
00:24:30,799 --> 00:24:33,520
could call it vpnconfig.exe once again

757
00:24:33,520 --> 00:24:36,960
do a robots.txt entry on a web server

758
00:24:36,960 --> 00:24:40,159
point at a specific um directory

759
00:24:40,159 --> 00:24:42,720
on that server and uh then in that

760
00:24:42,720 --> 00:24:43,919
server you would have indexable

761
00:24:43,919 --> 00:24:46,880
directories that have files sysprep.exe

762
00:24:46,880 --> 00:24:48,080
number of different ways to get the

763
00:24:48,080 --> 00:24:50,400
attacker to run the executable

764
00:24:50,400 --> 00:24:52,960
you can upload any executable you want

765
00:24:52,960 --> 00:24:55,039
you can actually take a real vpn

766
00:24:55,039 --> 00:24:56,000
executable

767
00:24:56,000 --> 00:24:58,960
like let's say i don't know cisco

768
00:24:58,960 --> 00:25:00,720
anyconnect vpn

769
00:25:00,720 --> 00:25:02,640
you can create that executable and you

770
00:25:02,640 --> 00:25:05,039
can insert your attributional

771
00:25:05,039 --> 00:25:06,159
technologies

772
00:25:06,159 --> 00:25:09,279
directly in to that

773
00:25:09,279 --> 00:25:11,760
executable so you don't have to just

774
00:25:11,760 --> 00:25:13,679
create an executable from scratch with c

775
00:25:13,679 --> 00:25:16,960
sharp which would be nice but you

776
00:25:16,960 --> 00:25:18,960
can actually insert it into any

777
00:25:18,960 --> 00:25:20,240
executable of your choosing

778
00:25:20,240 --> 00:25:22,080
and you want to test this first some

779
00:25:22,080 --> 00:25:23,919
executables for some reason

780
00:25:23,919 --> 00:25:26,559
don't work very well at all then when

781
00:25:26,559 --> 00:25:27,600
it's triggered

782
00:25:27,600 --> 00:25:29,760
you can actually see the dns resolution

783
00:25:29,760 --> 00:25:30,880
callback

784
00:25:30,880 --> 00:25:34,080
happens dns is not nearly as accurate as

785
00:25:34,080 --> 00:25:35,919
a straight http callback

786
00:25:35,919 --> 00:25:38,640
but it can get you in the ballpark of

787
00:25:38,640 --> 00:25:40,240
what you're looking for

788
00:25:40,240 --> 00:25:41,919
and we actually have some other ways

789
00:25:41,919 --> 00:25:43,679
that you can make executables come back

790
00:25:43,679 --> 00:25:46,080
directly to check for like a crl for

791
00:25:46,080 --> 00:25:48,320
digital code signing certificate

792
00:25:48,320 --> 00:25:51,360
but you know what you can make this real

793
00:25:51,360 --> 00:25:53,120
folks this is actually something that's

794
00:25:53,120 --> 00:25:54,960
pretty straightforward for example an

795
00:25:54,960 --> 00:25:57,279
openvpn you can do the same thing

796
00:25:57,279 --> 00:26:00,799
in windows vpn those vpn

797
00:26:00,799 --> 00:26:02,480
all the different vpns have the

798
00:26:02,480 --> 00:26:05,120
capability of actually inserting

799
00:26:05,120 --> 00:26:07,919
checks to validate machines before

800
00:26:07,919 --> 00:26:09,520
they're actually allowed onto the

801
00:26:09,520 --> 00:26:10,240
network

802
00:26:10,240 --> 00:26:11,760
and then based on the results of those

803
00:26:11,760 --> 00:26:13,840
checks can actually quarantine

804
00:26:13,840 --> 00:26:16,799
those systems so you have this ability

805
00:26:16,799 --> 00:26:17,440
to do

806
00:26:17,440 --> 00:26:20,720
scripts and execute things on a

807
00:26:20,720 --> 00:26:22,480
user's computer that's trying to

808
00:26:22,480 --> 00:26:24,480
authenticate to your environment

809
00:26:24,480 --> 00:26:26,080
all you really need to do is set up

810
00:26:26,080 --> 00:26:28,240
maybe a trace route where the attacker

811
00:26:28,240 --> 00:26:29,840
trace routes from their system to your

812
00:26:29,840 --> 00:26:31,039
system that way you can see if they're

813
00:26:31,039 --> 00:26:32,960
using tor or not

814
00:26:32,960 --> 00:26:34,720
verify their ip address is in fact a

815
00:26:34,720 --> 00:26:36,559
real ip address you could do

816
00:26:36,559 --> 00:26:39,919
a wireless site survey nets hw lan

817
00:26:39,919 --> 00:26:43,279
show networks mode equals bssid

818
00:26:43,279 --> 00:26:45,760
then we get all of the bss ids off of

819
00:26:45,760 --> 00:26:46,720
that system

820
00:26:46,720 --> 00:26:49,440
and their attenuation we can geo-locate

821
00:26:49,440 --> 00:26:50,640
where that computer

822
00:26:50,640 --> 00:26:53,840
is sometimes within 20 meters

823
00:26:53,840 --> 00:26:56,080
so there's a lot that you can do that

824
00:26:56,080 --> 00:26:58,000
isn't really hacking back it's not

825
00:26:58,000 --> 00:26:58,880
illegal

826
00:26:58,880 --> 00:27:01,039
it's just general security checks that

827
00:27:01,039 --> 00:27:02,159
you're already

828
00:27:02,159 --> 00:27:04,320
doing for a bunch of your users we're

829
00:27:04,320 --> 00:27:06,000
just tweaking them and feeding that

830
00:27:06,000 --> 00:27:08,559
data in differently so how would you do

831
00:27:08,559 --> 00:27:09,760
this as i mentioned

832
00:27:09,760 --> 00:27:12,799
you can use robots.txt it basically

833
00:27:12,799 --> 00:27:14,960
tells automated web crawlers things like

834
00:27:14,960 --> 00:27:16,880
googlebot msnbot

835
00:27:16,880 --> 00:27:19,440
where they should not index so you can

836
00:27:19,440 --> 00:27:20,720
say user agent

837
00:27:20,720 --> 00:27:22,799
star any of the different crawlers

838
00:27:22,799 --> 00:27:25,600
disallow registration admin admin page

839
00:27:25,600 --> 00:27:29,440
jfsf detect admin email maps whatever

840
00:27:29,440 --> 00:27:32,080
an attacker will see these directories

841
00:27:32,080 --> 00:27:33,760
in robots.txt

842
00:27:33,760 --> 00:27:35,840
and we'll immediately go to those

843
00:27:35,840 --> 00:27:37,039
directories

844
00:27:37,039 --> 00:27:39,679
a centered user will never see those

845
00:27:39,679 --> 00:27:40,559
directories

846
00:27:40,559 --> 00:27:42,799
so we're basically setting it up so

847
00:27:42,799 --> 00:27:45,120
we're not going to have a scenario

848
00:27:45,120 --> 00:27:47,360
where your user population is going to

849
00:27:47,360 --> 00:27:48,159
stumble

850
00:27:48,159 --> 00:27:50,399
upon your deception technology going

851
00:27:50,399 --> 00:27:51,440
back to hunting

852
00:27:51,440 --> 00:27:53,279
right you don't want to go hunting in

853
00:27:53,279 --> 00:27:54,480
the middle of a mall

854
00:27:54,480 --> 00:27:56,720
right that's not where your prey is and

855
00:27:56,720 --> 00:27:57,840
it's dangerous

856
00:27:57,840 --> 00:27:59,279
we want to make sure that we're going to

857
00:27:59,279 --> 00:28:01,039
put it in a location

858
00:28:01,039 --> 00:28:03,360
where the attackers are going to go but

859
00:28:03,360 --> 00:28:05,200
the user population will

860
00:28:05,200 --> 00:28:09,279
not go next one cloned website

861
00:28:09,279 --> 00:28:11,760
so a cloned website uh one of the

862
00:28:11,760 --> 00:28:13,840
methodologies that almost all attackers

863
00:28:13,840 --> 00:28:14,640
use

864
00:28:14,640 --> 00:28:16,720
is they'll find a website that has a

865
00:28:16,720 --> 00:28:18,880
user id password maybe two-factor

866
00:28:18,880 --> 00:28:19,760
authentication

867
00:28:19,760 --> 00:28:23,520
login and they will clone that website

868
00:28:23,520 --> 00:28:25,360
and then they will send an email into

869
00:28:25,360 --> 00:28:27,039
your organization saying

870
00:28:27,039 --> 00:28:28,799
update your password immediately you

871
00:28:28,799 --> 00:28:30,480
need to log into

872
00:28:30,480 --> 00:28:32,720
this portal immediately to update your

873
00:28:32,720 --> 00:28:33,679
your password

874
00:28:33,679 --> 00:28:35,360
you click the link it goes to the

875
00:28:35,360 --> 00:28:36,880
attacker's website

876
00:28:36,880 --> 00:28:39,520
which looks legit they enter user id

877
00:28:39,520 --> 00:28:41,679
password and two-factor authentication

878
00:28:41,679 --> 00:28:43,760
now the attacker has those credentials

879
00:28:43,760 --> 00:28:46,000
it's as old as the pen testing book

880
00:28:46,000 --> 00:28:48,640
you know going back 25 30 years ago

881
00:28:48,640 --> 00:28:49,840
right

882
00:28:49,840 --> 00:28:52,640
we can mess with the attacker you see

883
00:28:52,640 --> 00:28:53,279
what you

884
00:28:53,279 --> 00:28:56,399
do is you take the javascript

885
00:28:56,399 --> 00:28:59,919
that you see here and you insert it

886
00:28:59,919 --> 00:29:02,960
on your page okay

887
00:29:02,960 --> 00:29:06,000
you insert it on your page that has a

888
00:29:06,000 --> 00:29:07,520
user id password

889
00:29:07,520 --> 00:29:11,200
and a two-factor authentication pin

890
00:29:11,200 --> 00:29:14,080
and it sits there and if you look at it

891
00:29:14,080 --> 00:29:16,159
it says if the document domain is

892
00:29:16,159 --> 00:29:19,200
not thinkus.com that means if the domain

893
00:29:19,200 --> 00:29:20,320
that it's setting up

894
00:29:20,320 --> 00:29:23,840
is anything other than thinkus.com then

895
00:29:23,840 --> 00:29:26,240
i want you to get we got location href

896
00:29:26,240 --> 00:29:27,440
document references

897
00:29:27,440 --> 00:29:30,480
new image and it references the image

898
00:29:30,480 --> 00:29:32,480
that's stored on one of your servers

899
00:29:32,480 --> 00:29:34,240
this example it's from canary token

900
00:29:34,240 --> 00:29:34,799
server

901
00:29:34,799 --> 00:29:37,520
so it basically points to that specific

902
00:29:37,520 --> 00:29:38,240
image

903
00:29:38,240 --> 00:29:40,480
what's really cool about this is when

904
00:29:40,480 --> 00:29:44,240
the attacker stands that server up

905
00:29:44,240 --> 00:29:47,360
it will reach back try to

906
00:29:47,360 --> 00:29:50,399
grab that image and as soon as it grabs

907
00:29:50,399 --> 00:29:50,880
that

908
00:29:50,880 --> 00:29:53,919
image it will alert you where that

909
00:29:53,919 --> 00:29:55,520
system is so that you can start

910
00:29:55,520 --> 00:29:57,600
blacklisting or deny listing

911
00:29:57,600 --> 00:30:01,039
that ip address before they even send a

912
00:30:01,039 --> 00:30:04,159
single email into your organization this

913
00:30:04,159 --> 00:30:04,880
folks

914
00:30:04,880 --> 00:30:08,080
right here this is cyber

915
00:30:08,080 --> 00:30:10,720
threat intelligence not trying to detect

916
00:30:10,720 --> 00:30:11,679
or go off

917
00:30:11,679 --> 00:30:13,520
an attack that happened a week ago a

918
00:30:13,520 --> 00:30:15,600
month ago but an attack against

919
00:30:15,600 --> 00:30:16,640
what's happening against your

920
00:30:16,640 --> 00:30:18,799
organization right

921
00:30:18,799 --> 00:30:22,240
now trigger

922
00:30:22,240 --> 00:30:24,640
pops up you can see the http request you

923
00:30:24,640 --> 00:30:25,679
can see the callback

924
00:30:25,679 --> 00:30:27,600
uh that somebody was trying to access

925
00:30:27,600 --> 00:30:28,960
this particular and clone this

926
00:30:28,960 --> 00:30:30,159
particular page

927
00:30:30,159 --> 00:30:32,399
and we know that this works because at

928
00:30:32,399 --> 00:30:34,320
black hills information security got

929
00:30:34,320 --> 00:30:35,120
this weird

930
00:30:35,120 --> 00:30:37,840
fly bug thing at black hills information

931
00:30:37,840 --> 00:30:38,720
security

932
00:30:38,720 --> 00:30:41,039
we have this set up lighting on my head

933
00:30:41,039 --> 00:30:42,399
it's all over

934
00:30:42,399 --> 00:30:44,880
dang it it's a very excited i don't know

935
00:30:44,880 --> 00:30:45,840
mosquito

936
00:30:45,840 --> 00:30:49,279
um so we set this up because black hills

937
00:30:49,279 --> 00:30:50,720
information security

938
00:30:50,720 --> 00:30:53,600
is under attack quite a bit by some very

939
00:30:53,600 --> 00:30:54,880
advanced attackers

940
00:30:54,880 --> 00:30:57,200
and we get constant attacks and we're

941
00:30:57,200 --> 00:30:59,440
able to deny list those ip addresses and

942
00:30:59,440 --> 00:31:01,679
alert on where those ip addresses are

943
00:31:01,679 --> 00:31:04,399
before they even launch an attack at our

944
00:31:04,399 --> 00:31:05,200
organization

945
00:31:05,200 --> 00:31:08,640
that's powerful very very powerful to do

946
00:31:08,640 --> 00:31:11,600
so all right word documents word

947
00:31:11,600 --> 00:31:12,640
documents

948
00:31:12,640 --> 00:31:15,760
so with word documents we have documents

949
00:31:15,760 --> 00:31:16,880
that we can actually put

950
00:31:16,880 --> 00:31:19,840
in position where the attacker is going

951
00:31:19,840 --> 00:31:20,559
to be

952
00:31:20,559 --> 00:31:23,519
so we can put it on a file share and we

953
00:31:23,519 --> 00:31:23,919
can

954
00:31:23,919 --> 00:31:26,000
wait for the attacker to gain access to

955
00:31:26,000 --> 00:31:27,039
a workstation

956
00:31:27,039 --> 00:31:29,519
and then start looking for files that

957
00:31:29,519 --> 00:31:31,279
have the word password in them

958
00:31:31,279 --> 00:31:33,279
and when they do we'll basically be able

959
00:31:33,279 --> 00:31:34,720
to alert exactly

960
00:31:34,720 --> 00:31:37,840
where that attacker actually is so

961
00:31:37,840 --> 00:31:39,200
there's some fun things that we can do

962
00:31:39,200 --> 00:31:40,000
with this

963
00:31:40,000 --> 00:31:42,480
so uh back at the last derby con i miss

964
00:31:42,480 --> 00:31:44,000
derby con horribly and i know a lot of

965
00:31:44,000 --> 00:31:45,039
you do too

966
00:31:45,039 --> 00:31:47,679
at the last derby con uh i was uh

967
00:31:47,679 --> 00:31:48,960
sharing a room with my brother my

968
00:31:48,960 --> 00:31:50,000
brother's direct

969
00:31:50,000 --> 00:31:51,440
sales at black hills information

970
00:31:51,440 --> 00:31:53,919
security and one of the cool things

971
00:31:53,919 --> 00:31:55,840
about sharing a room with my brother one

972
00:31:55,840 --> 00:31:56,880
he doesn't snore

973
00:31:56,880 --> 00:31:58,960
but the other thing is i can torment

974
00:31:58,960 --> 00:32:00,960
them just like i did when we were kids

975
00:32:00,960 --> 00:32:03,200
so i basically had this document i was

976
00:32:03,200 --> 00:32:04,960
testing something out i wanted to see if

977
00:32:04,960 --> 00:32:06,000
it actually worked

978
00:32:06,000 --> 00:32:07,679
it was like three o'clock in the morning

979
00:32:07,679 --> 00:32:08,799
so i sent him this email and i'm like

980
00:32:08,799 --> 00:32:11,519
brian brian brian brian he's like what

981
00:32:11,519 --> 00:32:13,600
like hey hey check your email and open

982
00:32:13,600 --> 00:32:15,519
the document i just sent you he goes am

983
00:32:15,519 --> 00:32:16,880
i having a nightmare

984
00:32:16,880 --> 00:32:19,440
yes open the document come on brian come

985
00:32:19,440 --> 00:32:20,080
on

986
00:32:20,080 --> 00:32:21,679
and he's like god i just go back to

987
00:32:21,679 --> 00:32:23,440
sleep so we wrestled a little bit hotel

988
00:32:23,440 --> 00:32:24,720
security showed up they're like what's

989
00:32:24,720 --> 00:32:26,080
going on here i'm like we're brothers

990
00:32:26,080 --> 00:32:26,799
they're like

991
00:32:26,799 --> 00:32:29,120
carry on and uh eventually he opened up

992
00:32:29,120 --> 00:32:30,000
his computer

993
00:32:30,000 --> 00:32:32,000
and he saw this document and he's like

994
00:32:32,000 --> 00:32:33,679
this document looks creepy i don't think

995
00:32:33,679 --> 00:32:35,990
i should open this document

996
00:32:35,990 --> 00:32:38,240
[Music]

997
00:32:38,240 --> 00:32:41,360
so he did um so when he opened this

998
00:32:41,360 --> 00:32:42,080
document

999
00:32:42,080 --> 00:32:45,919
it made a call back in and of itself

1000
00:32:45,919 --> 00:32:47,760
not that interesting whenever you're

1001
00:32:47,760 --> 00:32:49,919
talking about geolocation based on ip

1002
00:32:49,919 --> 00:32:50,480
address

1003
00:32:50,480 --> 00:32:53,039
it's kind of garbage so we were way up

1004
00:32:53,039 --> 00:32:54,720
here in downtown louisville

1005
00:32:54,720 --> 00:32:56,960
in one of the main hotels and the

1006
00:32:56,960 --> 00:32:58,080
document put

1007
00:32:58,080 --> 00:33:00,640
the location of my brother opening that

1008
00:33:00,640 --> 00:33:01,840
document opening uh

1009
00:33:01,840 --> 00:33:03,440
that callback in the middle of

1010
00:33:03,440 --> 00:33:05,919
louisville that doesn't help me

1011
00:33:05,919 --> 00:33:08,880
not gonna be able to find him why why

1012
00:33:08,880 --> 00:33:10,559
does this suck so bad

1013
00:33:10,559 --> 00:33:12,399
turns out there's a very good reason

1014
00:33:12,399 --> 00:33:13,840
whenever you're an internet service

1015
00:33:13,840 --> 00:33:14,799
provider

1016
00:33:14,799 --> 00:33:17,679
many times you have pools of ip

1017
00:33:17,679 --> 00:33:18,559
addresses

1018
00:33:18,559 --> 00:33:20,240
that you hand out to your customers

1019
00:33:20,240 --> 00:33:22,840
these would be your dhcp

1020
00:33:22,840 --> 00:33:25,519
leases so you'd have pools of customers

1021
00:33:25,519 --> 00:33:27,600
with dhcpip address leases

1022
00:33:27,600 --> 00:33:29,440
you're not even going to bother doing

1023
00:33:29,440 --> 00:33:31,519
geolocation on those ip addresses

1024
00:33:31,519 --> 00:33:33,519
because those users are going to be all

1025
00:33:33,519 --> 00:33:34,720
over the place

1026
00:33:34,720 --> 00:33:37,279
it's going to change why bother dealing

1027
00:33:37,279 --> 00:33:38,960
with that so this looks like it's

1028
00:33:38,960 --> 00:33:41,039
worthless it looks like it's a dead end

1029
00:33:41,039 --> 00:33:45,200
however to the rescue comes tracer

1030
00:33:45,200 --> 00:33:47,600
you see with the trace route utility you

1031
00:33:47,600 --> 00:33:48,559
can actually

1032
00:33:48,559 --> 00:33:51,279
trace to the actual ip address that

1033
00:33:51,279 --> 00:33:53,440
opened up that document which is usually

1034
00:33:53,440 --> 00:33:55,919
the edge router for the user that

1035
00:33:55,919 --> 00:33:57,519
actually opened that document it's not

1036
00:33:57,519 --> 00:33:58,720
like their host computer

1037
00:33:58,720 --> 00:34:01,600
with an rca 1918 ip address it's their

1038
00:34:01,600 --> 00:34:02,480
edge router

1039
00:34:02,480 --> 00:34:04,159
and you can see down here at the bottom

1040
00:34:04,159 --> 00:34:06,240
the 74143

1041
00:34:06,240 --> 00:34:09,520
15 100 that's the ip address

1042
00:34:09,520 --> 00:34:12,560
of the source that made the callback for

1043
00:34:12,560 --> 00:34:12,879
the

1044
00:34:12,879 --> 00:34:15,199
callback on the word document that's not

1045
00:34:15,199 --> 00:34:16,879
the system i'm interested in

1046
00:34:16,879 --> 00:34:18,800
believe it or not that system is

1047
00:34:18,800 --> 00:34:20,560
worthless to me the system that's

1048
00:34:20,560 --> 00:34:23,679
interesting to me is the one step back

1049
00:34:23,679 --> 00:34:28,079
the one that's 74 142 115

1050
00:34:28,079 --> 00:34:31,199
130. that computer system

1051
00:34:31,199 --> 00:34:33,440
is incredibly interesting to me the

1052
00:34:33,440 --> 00:34:35,199
reason why

1053
00:34:35,199 --> 00:34:37,199
is internet service providers they may

1054
00:34:37,199 --> 00:34:39,440
not be very good at geolocating their

1055
00:34:39,440 --> 00:34:41,760
pool of dhcpip addresses

1056
00:34:41,760 --> 00:34:44,719
but they tend to be a lot better at

1057
00:34:44,719 --> 00:34:46,159
doing geolocation

1058
00:34:46,159 --> 00:34:48,399
on their infrastructure routing and

1059
00:34:48,399 --> 00:34:50,239
their points of presence in various

1060
00:34:50,239 --> 00:34:51,040
neighborhoods

1061
00:34:51,040 --> 00:34:52,560
because it gives them the ability to

1062
00:34:52,560 --> 00:34:54,960
easily troubleshoot the location

1063
00:34:54,960 --> 00:34:56,719
of those points of presence whenever

1064
00:34:56,719 --> 00:34:58,160
systems go down

1065
00:34:58,160 --> 00:35:01,359
and it turns up in this scenario

1066
00:35:01,359 --> 00:35:04,000
it put us within half a block of where

1067
00:35:04,000 --> 00:35:06,320
my brother and i were

1068
00:35:06,320 --> 00:35:09,839
now that is much better than just being

1069
00:35:09,839 --> 00:35:13,040
louisville now you can say louisville on

1070
00:35:13,040 --> 00:35:13,520
this

1071
00:35:13,520 --> 00:35:16,880
specific street that's cyber threat

1072
00:35:16,880 --> 00:35:17,839
intelligence

1073
00:35:17,839 --> 00:35:19,280
not only that we're being attacked by

1074
00:35:19,280 --> 00:35:21,440
said ip address but we can actually go

1075
00:35:21,440 --> 00:35:22,160
through

1076
00:35:22,160 --> 00:35:25,440
and that is one ugly bug and now he's

1077
00:35:25,440 --> 00:35:28,640
dead all right so now we can get down to

1078
00:35:28,640 --> 00:35:29,440
the point

1079
00:35:29,440 --> 00:35:31,440
where we can say not only is this an ip

1080
00:35:31,440 --> 00:35:33,440
address that's trying to attack us

1081
00:35:33,440 --> 00:35:36,000
but this is the actual block the

1082
00:35:36,000 --> 00:35:37,520
attacker is on

1083
00:35:37,520 --> 00:35:41,599
that's cool that's really cool but

1084
00:35:41,599 --> 00:35:44,400
the technique that i just talked about

1085
00:35:44,400 --> 00:35:45,520
that doesn't work

1086
00:35:45,520 --> 00:35:47,760
as well whenever you're dealing with

1087
00:35:47,760 --> 00:35:49,680
linux documents uh when you're looking

1088
00:35:49,680 --> 00:35:51,040
at canary tokens

1089
00:35:51,040 --> 00:35:53,839
their documents they do okay right but

1090
00:35:53,839 --> 00:35:55,760
and they work great on microsoft word

1091
00:35:55,760 --> 00:35:58,880
but as soon as as soon as you move off

1092
00:35:58,880 --> 00:36:01,599
to like libreoffice or obi-ward or any

1093
00:36:01,599 --> 00:36:03,359
of those different utilities

1094
00:36:03,359 --> 00:36:06,560
then at that point it's less effective

1095
00:36:06,560 --> 00:36:07,920
because a lot of those editors don't

1096
00:36:07,920 --> 00:36:09,440
work with the way that microsoft word

1097
00:36:09,440 --> 00:36:10,079
does it

1098
00:36:10,079 --> 00:36:13,359
in that specific instance however you

1099
00:36:13,359 --> 00:36:13,760
can

1100
00:36:13,760 --> 00:36:17,119
insert straight html into the

1101
00:36:17,119 --> 00:36:18,800
into the core of a file let me actually

1102
00:36:18,800 --> 00:36:20,880
show you what this looks like let's go

1103
00:36:20,880 --> 00:36:24,000
back to adhd

1104
00:36:24,839 --> 00:36:27,760
okay and i'm going to open up

1105
00:36:27,760 --> 00:36:31,040
a new command prompt here i got to jump

1106
00:36:31,040 --> 00:36:31,920
over here

1107
00:36:31,920 --> 00:36:35,200
got to open up a new terminal

1108
00:36:35,839 --> 00:36:40,000
there we go all right from the cd and

1109
00:36:40,000 --> 00:36:44,160
opt um web bug server

1110
00:36:44,160 --> 00:36:47,000
ls now this one document in here

1111
00:36:47,000 --> 00:36:48,560
webbug.doc

1112
00:36:48,560 --> 00:36:51,760
let me get my ip address 129

1113
00:36:51,760 --> 00:36:54,880
and let's go less and web bug

1114
00:36:54,880 --> 00:37:00,000
dot dot there we go all right awesome

1115
00:37:00,000 --> 00:37:02,160
so this is actually opening up this

1116
00:37:02,160 --> 00:37:03,760
document with less and i could have used

1117
00:37:03,760 --> 00:37:05,280
vi i could have used nano if i hated

1118
00:37:05,280 --> 00:37:05,839
myself

1119
00:37:05,839 --> 00:37:06,880
there's a bunch of different text

1120
00:37:06,880 --> 00:37:08,240
editors i could have used but i'm just

1121
00:37:08,240 --> 00:37:09,200
looking at it

1122
00:37:09,200 --> 00:37:11,760
so if you look at it it says html we

1123
00:37:11,760 --> 00:37:12,720
have head

1124
00:37:12,720 --> 00:37:15,520
we have an href referencing this local

1125
00:37:15,520 --> 00:37:16,720
ip address

1126
00:37:16,720 --> 00:37:19,599
and then the web server index.php and it

1127
00:37:19,599 --> 00:37:21,119
says you're looking for a cascading

1128
00:37:21,119 --> 00:37:22,480
style sheet that's how the page is

1129
00:37:22,480 --> 00:37:23,599
actually laid out

1130
00:37:23,599 --> 00:37:25,599
and then the image source tag down here

1131
00:37:25,599 --> 00:37:27,520
we're actually referencing a one pixel

1132
00:37:27,520 --> 00:37:29,680
by one pixel image

1133
00:37:29,680 --> 00:37:34,640
as well so if we were to copy this over

1134
00:37:34,640 --> 00:37:39,520
um oops if we were to copy this over

1135
00:37:39,520 --> 00:37:43,599
to var www

1136
00:37:43,599 --> 00:37:45,920
if we were to copy it here i could

1137
00:37:45,920 --> 00:37:48,079
easily copy that over to my windows

1138
00:37:48,079 --> 00:37:50,880
computer system

1139
00:37:50,880 --> 00:37:54,720
let me get the right ip address

1140
00:37:55,440 --> 00:37:58,079
oops i don't know why i'm watching this

1141
00:37:58,079 --> 00:37:59,680
presentation the guy can't even copy and

1142
00:37:59,680 --> 00:38:00,560
paste

1143
00:38:00,560 --> 00:38:04,320
all right and i can go to

1144
00:38:04,320 --> 00:38:18,960
there we go this

1145
00:38:18,960 --> 00:38:21,040
there we go i've just downloaded the web

1146
00:38:21,040 --> 00:38:23,599
bug and if i open it in microsoft word

1147
00:38:23,599 --> 00:38:27,440
i don't actually see the html

1148
00:38:27,440 --> 00:38:29,520
um it just basically shows me what a

1149
00:38:29,520 --> 00:38:32,079
buggy document which if we look at our

1150
00:38:32,079 --> 00:38:36,880
text inside of that document

1151
00:38:42,240 --> 00:38:45,839
here you can actually see the text

1152
00:38:45,839 --> 00:38:48,560
directly inside of this document it says

1153
00:38:48,560 --> 00:38:50,079
what a buggy document

1154
00:38:50,079 --> 00:38:51,920
all right so that's pretty easy to work

1155
00:38:51,920 --> 00:38:54,000
with

1156
00:38:54,000 --> 00:38:56,560
so it's simple and the coolest thing

1157
00:38:56,560 --> 00:38:57,440
about it

1158
00:38:57,440 --> 00:38:59,920
is it actually works with a wide variety

1159
00:38:59,920 --> 00:39:00,880
of different

1160
00:39:00,880 --> 00:39:04,000
um editors beyond just

1161
00:39:04,000 --> 00:39:07,280
your standard microsoft word um so if i

1162
00:39:07,280 --> 00:39:08,000
go back

1163
00:39:08,000 --> 00:39:10,560
let me go back to it here there we go i

1164
00:39:10,560 --> 00:39:15,839
can go over word

1165
00:39:16,160 --> 00:39:17,599
it's going to throw an error it's going

1166
00:39:17,599 --> 00:39:18,960
to say oh this document doesn't seem to

1167
00:39:18,960 --> 00:39:20,240
be legit

1168
00:39:20,240 --> 00:39:23,040
it doesn't matter because either way it

1169
00:39:23,040 --> 00:39:24,720
actually did the attribution

1170
00:39:24,720 --> 00:39:27,920
so if i want to i can go in here and add

1171
00:39:27,920 --> 00:39:29,119
minor and i can look

1172
00:39:29,119 --> 00:39:31,839
at the connections that came off and

1173
00:39:31,839 --> 00:39:33,440
what is it web bug user

1174
00:39:33,440 --> 00:39:36,960
okay let's go web bug user

1175
00:39:36,960 --> 00:39:40,400
password is adhd

1176
00:39:41,440 --> 00:39:44,079
there we go i'm logged in and i can look

1177
00:39:44,079 --> 00:39:47,040
at the requests

1178
00:39:47,040 --> 00:39:49,599
and here's the actual data that called

1179
00:39:49,599 --> 00:39:50,640
back

1180
00:39:50,640 --> 00:39:53,359
all right so you can see that i had

1181
00:39:53,359 --> 00:39:55,839
microsoft word made a connection

1182
00:39:55,839 --> 00:39:57,839
this is obvi word from my class

1183
00:39:57,839 --> 00:40:00,000
microsoft word made a connection today

1184
00:40:00,000 --> 00:40:02,079
and then this is obvi work

1185
00:40:02,079 --> 00:40:04,720
so it allows us to create a document

1186
00:40:04,720 --> 00:40:06,640
that is far more effective

1187
00:40:06,640 --> 00:40:09,119
than just using what web bug server or

1188
00:40:09,119 --> 00:40:10,960
excuse me what canary token server gives

1189
00:40:10,960 --> 00:40:11,520
us

1190
00:40:11,520 --> 00:40:13,359
i'm not saying that it's bad i'm just

1191
00:40:13,359 --> 00:40:15,680
saying it's just a different way and a

1192
00:40:15,680 --> 00:40:16,560
different utility

1193
00:40:16,560 --> 00:40:18,240
we can actually get different operating

1194
00:40:18,240 --> 00:40:20,400
systems fairly easily which i think is

1195
00:40:20,400 --> 00:40:21,599
awesome

1196
00:40:21,599 --> 00:40:23,200
all right so one step forward let's

1197
00:40:23,200 --> 00:40:25,280
continue with this whole trying to put

1198
00:40:25,280 --> 00:40:26,880
the proper cyber deception in the

1199
00:40:26,880 --> 00:40:28,960
pathways of where an attacker would

1200
00:40:28,960 --> 00:40:30,160
actually go

1201
00:40:30,160 --> 00:40:33,280
um so javelin is a symantec company that

1202
00:40:33,280 --> 00:40:35,119
creates honey user accounts

1203
00:40:35,119 --> 00:40:37,599
honey workstations one of the problems

1204
00:40:37,599 --> 00:40:38,720
with these accounts

1205
00:40:38,720 --> 00:40:40,640
is they're pretty easy to identify at

1206
00:40:40,640 --> 00:40:41,920
least they were i haven't seen it

1207
00:40:41,920 --> 00:40:42,720
recently

1208
00:40:42,720 --> 00:40:44,720
um because it's at the last log on time

1209
00:40:44,720 --> 00:40:46,480
to january 1st 1601

1210
00:40:46,480 --> 00:40:49,119
i know it says december 31st 1600 but

1211
00:40:49,119 --> 00:40:50,560
remember epoch time work your way

1212
00:40:50,560 --> 00:40:51,680
backwards

1213
00:40:51,680 --> 00:40:53,280
but at any rate the real date is january

1214
00:40:53,280 --> 00:40:55,520
1st 1601 utak time

1215
00:40:55,520 --> 00:40:59,040
so that's okay i guess and they charge

1216
00:40:59,040 --> 00:40:59,920
money for it

1217
00:40:59,920 --> 00:41:02,160
i guess but you can actually do this for

1218
00:41:02,160 --> 00:41:03,440
free which is

1219
00:41:03,440 --> 00:41:06,319
really really cool so how you would do

1220
00:41:06,319 --> 00:41:09,119
this is you would create an account

1221
00:41:09,119 --> 00:41:11,839
in your environment um and i i created

1222
00:41:11,839 --> 00:41:14,800
the account just admin adm administrator

1223
00:41:14,800 --> 00:41:16,640
um you could name it whatever you want i

1224
00:41:16,640 --> 00:41:18,560
just needed an administrator account for

1225
00:41:18,560 --> 00:41:19,680
a couple of reasons

1226
00:41:19,680 --> 00:41:21,359
some people are like well we want to

1227
00:41:21,359 --> 00:41:22,880
make sure that the attacker hits it so

1228
00:41:22,880 --> 00:41:24,560
let's call an administrator account

1229
00:41:24,560 --> 00:41:26,400
doesn't matter the attacker is not going

1230
00:41:26,400 --> 00:41:28,319
to download hundreds or thousands or

1231
00:41:28,319 --> 00:41:30,319
hundreds of thousands of user accounts

1232
00:41:30,319 --> 00:41:33,520
go through them and say admin adm

1233
00:41:33,520 --> 00:41:34,319
administrator

1234
00:41:34,319 --> 00:41:37,040
this one pleases me it's not how this is

1235
00:41:37,040 --> 00:41:37,599
going to work

1236
00:41:37,599 --> 00:41:39,520
right the attackers whenever they do a

1237
00:41:39,520 --> 00:41:40,720
password spray

1238
00:41:40,720 --> 00:41:42,079
they're going to hit every single

1239
00:41:42,079 --> 00:41:43,920
account with the same password so it'll

1240
00:41:43,920 --> 00:41:45,200
work no matter what

1241
00:41:45,200 --> 00:41:46,640
so this is important you're going to

1242
00:41:46,640 --> 00:41:48,800
create the account

1243
00:41:48,800 --> 00:41:51,520
then after you've created that account

1244
00:41:51,520 --> 00:41:52,640
you're going to log

1245
00:41:52,640 --> 00:41:54,800
in to update that last login time from

1246
00:41:54,800 --> 00:41:56,480
january 1st 1601

1247
00:41:56,480 --> 00:41:57,760
and then you're going to go into its

1248
00:41:57,760 --> 00:42:00,000
logon hours and you're going to wipe out

1249
00:42:00,000 --> 00:42:01,520
all the login out so

1250
00:42:01,520 --> 00:42:04,240
you're disabling the account without

1251
00:42:04,240 --> 00:42:06,960
technically disabling the account

1252
00:42:06,960 --> 00:42:09,280
because tools like domain password spray

1253
00:42:09,280 --> 00:42:11,440
will automatically identify the domains

1254
00:42:11,440 --> 00:42:12,720
that are basically

1255
00:42:12,720 --> 00:42:15,200
you or excuse me identify the accounts

1256
00:42:15,200 --> 00:42:16,800
that are officially disabled

1257
00:42:16,800 --> 00:42:18,960
we want the attacker to actually come in

1258
00:42:18,960 --> 00:42:19,839
and hit

1259
00:42:19,839 --> 00:42:23,040
this account so we disable it by logging

1260
00:42:23,040 --> 00:42:23,839
up

1261
00:42:23,839 --> 00:42:25,920
wiping out its login hours i would also

1262
00:42:25,920 --> 00:42:28,480
recommend giving it a really crazy long

1263
00:42:28,480 --> 00:42:32,079
password as well um then when they hit

1264
00:42:32,079 --> 00:42:33,280
it have a similar

1265
00:42:33,280 --> 00:42:35,920
next thing you can do kerber roasting um

1266
00:42:35,920 --> 00:42:37,760
we actually have a tool kit that we've

1267
00:42:37,760 --> 00:42:38,480
released

1268
00:42:38,480 --> 00:42:45,839
called the cred defense toolkit

1269
00:42:46,800 --> 00:42:49,359
and the credit defense toolkit has

1270
00:42:49,359 --> 00:42:50,560
password

1271
00:42:50,560 --> 00:42:52,000
so that you can update your password

1272
00:42:52,000 --> 00:42:54,160
complexity in your domain it also has

1273
00:42:54,160 --> 00:42:55,760
the ability to detect link local

1274
00:42:55,760 --> 00:42:58,240
multicast name resolution attacks it has

1275
00:42:58,240 --> 00:42:59,680
the ability to detect

1276
00:42:59,680 --> 00:43:02,880
curber roasting and feed like bad data

1277
00:43:02,880 --> 00:43:04,160
back to the attacker

1278
00:43:04,160 --> 00:43:06,000
so once again we're putting this where

1279
00:43:06,000 --> 00:43:07,760
the attacker actually goes

1280
00:43:07,760 --> 00:43:08,800
because one of the first things an

1281
00:43:08,800 --> 00:43:09,920
attacker is going to do is they're going

1282
00:43:09,920 --> 00:43:11,440
to try to do a password spray one of the

1283
00:43:11,440 --> 00:43:12,480
next things you're going to do is we're

1284
00:43:12,480 --> 00:43:13,920
going to see if there's kerberostable

1285
00:43:13,920 --> 00:43:14,720
accounts

1286
00:43:14,720 --> 00:43:16,160
now if you actually look at the service

1287
00:43:16,160 --> 00:43:18,560
principle name the kerberos account will

1288
00:43:18,560 --> 00:43:20,319
actually reference the system that it

1289
00:43:20,319 --> 00:43:21,280
logs into

1290
00:43:21,280 --> 00:43:23,440
you can make that a honeypot as well

1291
00:43:23,440 --> 00:43:24,800
you're just making your network a

1292
00:43:24,800 --> 00:43:25,520
nightmare

1293
00:43:25,520 --> 00:43:27,839
and it's not hard to do so with this as

1294
00:43:27,839 --> 00:43:29,760
soon as somebody tries to hit that

1295
00:43:29,760 --> 00:43:31,200
kerberostable account

1296
00:43:31,200 --> 00:43:33,119
you can have a pop up an email and say

1297
00:43:33,119 --> 00:43:35,440
hey this is a high priority alert

1298
00:43:35,440 --> 00:43:37,359
someone's trying to hit the systems or

1299
00:43:37,359 --> 00:43:38,480
service account

1300
00:43:38,480 --> 00:43:40,240
and this is not something your normal

1301
00:43:40,240 --> 00:43:41,599
user population

1302
00:43:41,599 --> 00:43:44,640
will ever do under any circumstances at

1303
00:43:44,640 --> 00:43:45,520
that point

1304
00:43:45,520 --> 00:43:48,480
you've got them dead to rights and we

1305
00:43:48,480 --> 00:43:50,480
love adding this to our reports

1306
00:43:50,480 --> 00:43:52,240
at black hills information security it's

1307
00:43:52,240 --> 00:43:53,680
one of our all-time

1308
00:43:53,680 --> 00:43:56,240
favorites if you ever get a report from

1309
00:43:56,240 --> 00:43:57,359
us and we put this in

1310
00:43:57,359 --> 00:44:00,640
i i i cry my pen testers cry i collect

1311
00:44:00,640 --> 00:44:01,520
their tears

1312
00:44:01,520 --> 00:44:04,000
i brew it it makes the best wine so with

1313
00:44:04,000 --> 00:44:06,400
this it says effective use of traps

1314
00:44:06,400 --> 00:44:08,000
multiple hosts on the domain were

1315
00:44:08,000 --> 00:44:10,160
installed as traps activities conducted

1316
00:44:10,160 --> 00:44:12,240
by bhis revealed that these traps were

1317
00:44:12,240 --> 00:44:14,240
vulnerable to multiple insecurities

1318
00:44:14,240 --> 00:44:16,720
and they made tempting targets any

1319
00:44:16,720 --> 00:44:18,160
interaction with these hosts triggered

1320
00:44:18,160 --> 00:44:19,440
an alerts to the customer

1321
00:44:19,440 --> 00:44:21,440
and those were reported to bhis during

1322
00:44:21,440 --> 00:44:22,880
the test that is

1323
00:44:22,880 --> 00:44:26,240
great folks and trust me

1324
00:44:26,240 --> 00:44:27,760
this matters like when you're pen

1325
00:44:27,760 --> 00:44:29,359
testing an organization that has a bunch

1326
00:44:29,359 --> 00:44:30,560
of cyber deception

1327
00:44:30,560 --> 00:44:32,960
it makes your life miserable but in that

1328
00:44:32,960 --> 00:44:34,240
really good way

1329
00:44:34,240 --> 00:44:37,440
the deep down you know you're growing as

1330
00:44:37,440 --> 00:44:39,599
a human being

1331
00:44:39,599 --> 00:44:42,960
all right honey badger um so do i

1332
00:44:42,960 --> 00:44:43,760
actually go through

1333
00:44:43,760 --> 00:44:45,200
let's actually go through honey badger

1334
00:44:45,200 --> 00:44:47,040
all right so this

1335
00:44:47,040 --> 00:44:49,760
is uh honey badger three um this is the

1336
00:44:49,760 --> 00:44:51,119
newest version

1337
00:44:51,119 --> 00:44:54,560
of honey badger and this particular

1338
00:44:54,560 --> 00:44:56,240
version is a little bit different we're

1339
00:44:56,240 --> 00:44:57,920
adding in a couple of features and how

1340
00:44:57,920 --> 00:44:58,960
it actually works

1341
00:44:58,960 --> 00:45:01,839
i want to do a work through work flow of

1342
00:45:01,839 --> 00:45:02,560
two different

1343
00:45:02,560 --> 00:45:06,319
things that you can do with honey badger

1344
00:45:06,319 --> 00:45:08,640
first things first whenever you create a

1345
00:45:08,640 --> 00:45:11,040
target

1346
00:45:13,520 --> 00:45:16,560
you're going to create a a target and i

1347
00:45:16,560 --> 00:45:18,160
want you to think of these as like

1348
00:45:18,160 --> 00:45:19,119
workflows

1349
00:45:19,119 --> 00:45:20,960
so if you're using honey badger and

1350
00:45:20,960 --> 00:45:23,119
you're using it for multiple different

1351
00:45:23,119 --> 00:45:26,240
types of engagements

1352
00:45:26,240 --> 00:45:28,560
you would want to create a different

1353
00:45:28,560 --> 00:45:29,359
guide

1354
00:45:29,359 --> 00:45:31,119
or a different target for each one of

1355
00:45:31,119 --> 00:45:32,720
those engagements if you're doing

1356
00:45:32,720 --> 00:45:33,760
engagement

1357
00:45:33,760 --> 00:45:35,520
as part of incident response you would

1358
00:45:35,520 --> 00:45:37,520
basically call it an ir engagement with

1359
00:45:37,520 --> 00:45:38,160
a specific

1360
00:45:38,160 --> 00:45:40,400
guide i just created one called secure

1361
00:45:40,400 --> 00:45:43,040
west virginia or secure wv

1362
00:45:43,040 --> 00:45:44,480
and i've got a couple of options on how

1363
00:45:44,480 --> 00:45:46,079
i can do it i'm going to show the first

1364
00:45:46,079 --> 00:45:48,560
two where i can generate a macro and i

1365
00:45:48,560 --> 00:45:50,640
can generate db.net

1366
00:45:50,640 --> 00:45:52,560
now i need to make sure that my windows

1367
00:45:52,560 --> 00:45:53,839
virtual machine is

1368
00:45:53,839 --> 00:45:56,880
up and running there we go that looks

1369
00:45:56,880 --> 00:46:01,280
good to me awesome

1370
00:46:01,280 --> 00:46:04,400
is my mono great all right so what i

1371
00:46:04,400 --> 00:46:05,960
want to do is i'm going to create a

1372
00:46:05,960 --> 00:46:07,200
vb.net

1373
00:46:07,200 --> 00:46:09,920
executable and this will allow me to

1374
00:46:09,920 --> 00:46:10,720
create an

1375
00:46:10,720 --> 00:46:14,079
actual real real little program

1376
00:46:14,079 --> 00:46:16,000
all right so i want to create a straight

1377
00:46:16,000 --> 00:46:17,359
up executable

1378
00:46:17,359 --> 00:46:20,560
utilizing this particular code

1379
00:46:20,560 --> 00:46:23,760
and uh i want the system that runs it to

1380
00:46:23,760 --> 00:46:26,000
beacon back and give me its location

1381
00:46:26,000 --> 00:46:28,880
all right so i generate this code and

1382
00:46:28,880 --> 00:46:29,760
then i go

1383
00:46:29,760 --> 00:46:32,000
over to my windows system and i'm going

1384
00:46:32,000 --> 00:46:34,240
to open up a new

1385
00:46:34,240 --> 00:46:36,720
document here sorry it's a little bit

1386
00:46:36,720 --> 00:46:38,240
hard to see

1387
00:46:38,240 --> 00:46:40,480
but what this is going to do is it's

1388
00:46:40,480 --> 00:46:42,560
going to um

1389
00:46:42,560 --> 00:46:45,119
it's going to basically do a wireless

1390
00:46:45,119 --> 00:46:46,720
sight survey let me show you what that

1391
00:46:46,720 --> 00:46:48,400
looks like here

1392
00:46:48,400 --> 00:46:50,079
wow that's not what i wanted i want this

1393
00:46:50,079 --> 00:46:57,839
one there we go

1394
00:47:01,200 --> 00:47:05,440
uh oh oh crap wrong system

1395
00:47:05,440 --> 00:47:07,520
hold on hold on i have windows systems

1396
00:47:07,520 --> 00:47:11,839
within windows systems

1397
00:47:14,640 --> 00:47:18,000
there we go this should be better

1398
00:47:22,839 --> 00:47:24,000
alright

1399
00:47:24,000 --> 00:47:27,920
all right so what happens is it fires

1400
00:47:27,920 --> 00:47:29,680
and it basically says okay i want to see

1401
00:47:29,680 --> 00:47:31,280
all the wireless networks that are

1402
00:47:31,280 --> 00:47:32,160
available

1403
00:47:32,160 --> 00:47:35,200
and i want to see their bss ids and i

1404
00:47:35,200 --> 00:47:36,960
want to see the signal attenuation for

1405
00:47:36,960 --> 00:47:39,200
each of those um what honey badger is

1406
00:47:39,200 --> 00:47:39,839
going to do

1407
00:47:39,839 --> 00:47:42,960
is it's going to take that data and it's

1408
00:47:42,960 --> 00:47:44,960
going to upload it to google

1409
00:47:44,960 --> 00:47:46,240
and then google is going to give us the

1410
00:47:46,240 --> 00:47:48,079
geolocation on exactly

1411
00:47:48,079 --> 00:47:50,640
where this particular computer system is

1412
00:47:50,640 --> 00:47:51,760
so that's the code

1413
00:47:51,760 --> 00:47:54,000
and that's what it does right here so

1414
00:47:54,000 --> 00:47:54,800
now let's go

1415
00:47:54,800 --> 00:47:58,079
file and let's go save as

1416
00:47:58,079 --> 00:48:01,040
and i'm going to save it in tools i'm

1417
00:48:01,040 --> 00:48:01,920
going to call it sec

1418
00:48:01,920 --> 00:48:07,440
wv oh i should have saved it as

1419
00:48:07,440 --> 00:48:10,240
i should have saved it as sec wv.vb hold

1420
00:48:10,240 --> 00:48:11,599
on file

1421
00:48:11,599 --> 00:48:13,040
sorry if it's small for you it's small

1422
00:48:13,040 --> 00:48:15,680
for me too i'm sorry

1423
00:48:15,680 --> 00:48:17,760
there we go all right so now let's save

1424
00:48:17,760 --> 00:48:18,720
it there

1425
00:48:18,720 --> 00:48:21,200
now i'm going to go into mono and i'm

1426
00:48:21,200 --> 00:48:21,920
going to run

1427
00:48:21,920 --> 00:48:25,040
the uh we'll go mono oh not mono

1428
00:48:25,040 --> 00:48:28,240
it's a vbc visual basic compiler

1429
00:48:28,240 --> 00:48:32,399
and we're going to compile tools

1430
00:48:33,680 --> 00:48:37,119
sec wv.vb compiles it

1431
00:48:37,119 --> 00:48:40,400
there we go and now that i have it on my

1432
00:48:40,400 --> 00:48:42,160
vm i have to move it over a system that

1433
00:48:42,160 --> 00:48:44,640
actually has a wireless adapter

1434
00:48:44,640 --> 00:48:46,160
so i'm going to do that really really

1435
00:48:46,160 --> 00:48:48,000
quick let's go

1436
00:48:48,000 --> 00:48:51,760
to this pc let's go to the hard drive

1437
00:48:51,760 --> 00:48:55,440
let's go to windows system 32

1438
00:48:55,440 --> 00:48:58,400
is where mono saves it unfortunately and

1439
00:48:58,400 --> 00:49:00,240
stretch it to date modified and then

1440
00:49:00,240 --> 00:49:03,280
pull the executable over to my desktop

1441
00:49:03,280 --> 00:49:07,520
all right now when i run this

1442
00:49:07,520 --> 00:49:10,160
there's a quick pop-up then it goes away

1443
00:49:10,160 --> 00:49:11,599
so what happened

1444
00:49:11,599 --> 00:49:17,280
whenever it did this is on the back end

1445
00:49:17,280 --> 00:49:20,800
if i go here go back to map

1446
00:49:20,800 --> 00:49:23,599
you can see sec wv let me shut off these

1447
00:49:23,599 --> 00:49:24,160
other ones

1448
00:49:24,160 --> 00:49:26,960
actually fired

1449
00:49:27,440 --> 00:49:29,520
enhance so you feel like you're like the

1450
00:49:29,520 --> 00:49:31,440
cia tracking and attacker

1451
00:49:31,440 --> 00:49:33,119
when you can actually zoom in on the

1452
00:49:33,119 --> 00:49:35,599
attacker now the reason why we choose an

1453
00:49:35,599 --> 00:49:37,680
executable is an executable is portable

1454
00:49:37,680 --> 00:49:39,839
um you can actually take this executable

1455
00:49:39,839 --> 00:49:41,280
you can move it into a word

1456
00:49:41,280 --> 00:49:43,280
document you can i'm going to show you

1457
00:49:43,280 --> 00:49:44,880
how to put the same code inside of an

1458
00:49:44,880 --> 00:49:47,680
excel spreadsheet here in just a second

1459
00:49:47,680 --> 00:49:50,720
but you can basically make it so you can

1460
00:49:50,720 --> 00:49:53,599
move it to just about anything

1461
00:49:53,599 --> 00:49:56,319
you want to insert it into it's just

1462
00:49:56,319 --> 00:49:58,160
really really really flexible

1463
00:49:58,160 --> 00:50:00,160
you can even merge two executables

1464
00:50:00,160 --> 00:50:02,240
together and when you merge the two

1465
00:50:02,240 --> 00:50:03,839
executables together

1466
00:50:03,839 --> 00:50:06,400
you can have one executable fire and the

1467
00:50:06,400 --> 00:50:07,839
other executable

1468
00:50:07,839 --> 00:50:11,359
um uh is just the other one that runs is

1469
00:50:11,359 --> 00:50:13,359
kind of like a parasite process

1470
00:50:13,359 --> 00:50:17,040
so this is right where my office is

1471
00:50:17,040 --> 00:50:19,200
so that's good squishy that's cyber

1472
00:50:19,200 --> 00:50:20,640
threat intelligence folks

1473
00:50:20,640 --> 00:50:23,839
so so that's neat um let me show you

1474
00:50:23,839 --> 00:50:26,640
the other one let's go to targets let's

1475
00:50:26,640 --> 00:50:27,040
go

1476
00:50:27,040 --> 00:50:28,720
to sequest virginia and i'm going to

1477
00:50:28,720 --> 00:50:30,400
grab macro

1478
00:50:30,400 --> 00:50:34,720
and i am going to grab this code

1479
00:50:34,720 --> 00:50:36,720
and what we're going to do is i'm

1480
00:50:36,720 --> 00:50:38,160
instead going to

1481
00:50:38,160 --> 00:50:40,559
start a excel spreadsheet so let me open

1482
00:50:40,559 --> 00:50:43,359
up excel here

1483
00:50:45,119 --> 00:50:48,400
all right so open up a blank workbook

1484
00:50:48,400 --> 00:50:51,040
now you need to add in the developer tab

1485
00:50:51,040 --> 00:50:52,400
ribbon

1486
00:50:52,400 --> 00:50:54,960
whatever the developer tab on the ribbon

1487
00:50:54,960 --> 00:50:56,559
and to do that you would right click

1488
00:50:56,559 --> 00:50:57,200
anywhere

1489
00:50:57,200 --> 00:50:59,440
on your ribbon up here your work bar you

1490
00:50:59,440 --> 00:51:00,720
get configure ribbon

1491
00:51:00,720 --> 00:51:02,400
and you make sure that developer is

1492
00:51:02,400 --> 00:51:03,839
selected okay

1493
00:51:03,839 --> 00:51:05,920
because we want to insert a macro here

1494
00:51:05,920 --> 00:51:08,000
so now you go to macros

1495
00:51:08,000 --> 00:51:11,599
and we'll call our macro honey badger

1496
00:51:11,599 --> 00:51:14,960
like so and i want to set this to

1497
00:51:14,960 --> 00:51:18,160
this workbook okay

1498
00:51:18,160 --> 00:51:21,440
we create it and i can take this and i

1499
00:51:21,440 --> 00:51:22,000
can

1500
00:51:22,000 --> 00:51:26,319
change this instead of auto open

1501
00:51:27,680 --> 00:51:29,520
we're going to change that to workbook

1502
00:51:29,520 --> 00:51:31,920
open and then i can i can run this and

1503
00:51:31,920 --> 00:51:33,200
just show you how it fires

1504
00:51:33,200 --> 00:51:36,559
so there we go it's fired there and if i

1505
00:51:36,559 --> 00:51:37,839
go back

1506
00:51:37,839 --> 00:51:40,720
to honey badger you're not going to see

1507
00:51:40,720 --> 00:51:42,160
the target it's going to be the exact

1508
00:51:42,160 --> 00:51:43,920
same pin on the exact same thing but i

1509
00:51:43,920 --> 00:51:45,520
can show you beacons here

1510
00:51:45,520 --> 00:51:47,599
if we go down to the bottom you can see

1511
00:51:47,599 --> 00:51:49,119
that this is the first one i fired that

1512
00:51:49,119 --> 00:51:50,240
was the executable

1513
00:51:50,240 --> 00:51:52,559
latitude and longitude and then this is

1514
00:51:52,559 --> 00:51:54,240
the one that i just fired from the excel

1515
00:51:54,240 --> 00:51:55,680
spreadsheet

1516
00:51:55,680 --> 00:51:59,119
latitude and longitude um so very easy

1517
00:51:59,119 --> 00:52:00,079
to use

1518
00:52:00,079 --> 00:52:01,599
once again the way that you would do

1519
00:52:01,599 --> 00:52:03,119
this is you would set this

1520
00:52:03,119 --> 00:52:05,200
up and you would put it on a file share

1521
00:52:05,200 --> 00:52:06,400
somewhere where

1522
00:52:06,400 --> 00:52:08,160
you think an attacker would get and you

1523
00:52:08,160 --> 00:52:09,599
would call it like you know

1524
00:52:09,599 --> 00:52:12,800
uh routing numbers or passwords

1525
00:52:12,800 --> 00:52:14,720
or social security numbers or something

1526
00:52:14,720 --> 00:52:16,640
and you put it on a file share

1527
00:52:16,640 --> 00:52:18,240
that your general user population

1528
00:52:18,240 --> 00:52:19,760
probably wouldn't see but an

1529
00:52:19,760 --> 00:52:21,119
attacker that's going through

1530
00:52:21,119 --> 00:52:24,079
automatically searching for files

1531
00:52:24,079 --> 00:52:26,400
would so that's how that would work now

1532
00:52:26,400 --> 00:52:28,079
let me show you a word of caution

1533
00:52:28,079 --> 00:52:30,480
on this one um here's the word of

1534
00:52:30,480 --> 00:52:32,559
caution so this fired for me and it ran

1535
00:52:32,559 --> 00:52:34,400
just great and that's awesome

1536
00:52:34,400 --> 00:52:37,520
there is no obfuscation whatsoever in

1537
00:52:37,520 --> 00:52:38,640
this

1538
00:52:38,640 --> 00:52:41,359
not at all this is just the straight raw

1539
00:52:41,359 --> 00:52:42,079
code

1540
00:52:42,079 --> 00:52:44,000
if you want this to actually fire you're

1541
00:52:44,000 --> 00:52:45,440
going to have to send it through a vb

1542
00:52:45,440 --> 00:52:47,119
obfuscation utility

1543
00:52:47,119 --> 00:52:49,359
or you can convert it into an executable

1544
00:52:49,359 --> 00:52:51,280
and then convert it back into a vb

1545
00:52:51,280 --> 00:52:51,839
script

1546
00:52:51,839 --> 00:52:54,640
and then insert it because if you don't

1547
00:52:54,640 --> 00:52:56,559
if you just keep this code exactly as

1548
00:52:56,559 --> 00:52:57,760
it's set here

1549
00:52:57,760 --> 00:53:04,079
if i save it as a macro enabled workbook

1550
00:53:05,040 --> 00:53:07,760
call it nope it's going to generate an

1551
00:53:07,760 --> 00:53:14,000
alert here in a second

1552
00:53:14,000 --> 00:53:18,400
great i guess it didn't well that sucks

1553
00:53:18,400 --> 00:53:22,240
um um yeah well i guess

1554
00:53:22,240 --> 00:53:24,880
that that's that um it should have

1555
00:53:24,880 --> 00:53:26,559
generated an alert

1556
00:53:26,559 --> 00:53:29,680
um from defender down here popping up

1557
00:53:29,680 --> 00:53:30,880
and saying hey

1558
00:53:30,880 --> 00:53:34,000
malware it didn't so i guess that part

1559
00:53:34,000 --> 00:53:36,640
of my demo failed in a cool way i guess

1560
00:53:36,640 --> 00:53:40,640
so yay one for bypassing amsi

1561
00:53:40,640 --> 00:53:42,960
whatever all right so all right it

1562
00:53:42,960 --> 00:53:43,839
should have thrown

1563
00:53:43,839 --> 00:53:45,599
and it should have absolutely have

1564
00:53:45,599 --> 00:53:47,760
thrown a defender alert

1565
00:53:47,760 --> 00:53:50,880
but it didn't so um what i'd like what

1566
00:53:50,880 --> 00:53:52,319
i'd recommend to you

1567
00:53:52,319 --> 00:53:54,720
is with this send it through an

1568
00:53:54,720 --> 00:53:55,440
obfuscation

1569
00:53:55,440 --> 00:53:57,680
utility uh before you actually load it

1570
00:53:57,680 --> 00:53:59,200
into a spreadsheet um

1571
00:53:59,200 --> 00:54:01,920
because it it can create problems with

1572
00:54:01,920 --> 00:54:03,760
antivirus detections except

1573
00:54:03,760 --> 00:54:06,160
whenever i'm i'm trying i literally just

1574
00:54:06,160 --> 00:54:07,119
failed at failing

1575
00:54:07,119 --> 00:54:09,920
like i go into this demo expecting hey

1576
00:54:09,920 --> 00:54:10,400
we're gonna

1577
00:54:10,400 --> 00:54:12,240
fail this little thing and it didn't

1578
00:54:12,240 --> 00:54:13,680
fail at all which sucks

1579
00:54:13,680 --> 00:54:16,000
because i wanted to show you it failing

1580
00:54:16,000 --> 00:54:17,599
but it didn't all right so

1581
00:54:17,599 --> 00:54:20,640
bummer um so this is updated um

1582
00:54:20,640 --> 00:54:22,640
here's the instructions to compile it

1583
00:54:22,640 --> 00:54:24,800
and then the results um this is whenever

1584
00:54:24,800 --> 00:54:25,280
i ran

1585
00:54:25,280 --> 00:54:28,079
it at derby con for uh the last

1586
00:54:28,079 --> 00:54:29,839
presentation that i ever did there and

1587
00:54:29,839 --> 00:54:31,760
probably will ever do there and it's

1588
00:54:31,760 --> 00:54:33,520
funny because it said its accuracy was

1589
00:54:33,520 --> 00:54:35,040
77 meters

1590
00:54:35,040 --> 00:54:36,559
and i'll have people in the military

1591
00:54:36,559 --> 00:54:38,400
from time to time look at that and go

1592
00:54:38,400 --> 00:54:42,880
hmm close enough like for oh my god you

1593
00:54:42,880 --> 00:54:43,599
know so

1594
00:54:43,599 --> 00:54:44,799
it depends on what you're doing with

1595
00:54:44,799 --> 00:54:46,799
horseshoes hand grenades and carpet

1596
00:54:46,799 --> 00:54:48,400
bombing possibly

1597
00:54:48,400 --> 00:54:50,559
and this is where you get it we'll be

1598
00:54:50,559 --> 00:54:52,240
getting these slides out it should be

1599
00:54:52,240 --> 00:54:55,040
in the discord channel uh for everybody

1600
00:54:55,040 --> 00:54:56,480
so you could basically pull

1601
00:54:56,480 --> 00:54:58,799
honey badger down and play with it it's

1602
00:54:58,799 --> 00:54:59,520
also in

1603
00:54:59,520 --> 00:55:02,319
adhd in the active defense harbinger

1604
00:55:02,319 --> 00:55:03,280
distribution

1605
00:55:03,280 --> 00:55:05,760
as well it's all set up there and ready

1606
00:55:05,760 --> 00:55:07,920
to rock you will need some api keys it's

1607
00:55:07,920 --> 00:55:09,440
the beginning of the instructions

1608
00:55:09,440 --> 00:55:10,960
you'll need to get those api keys to

1609
00:55:10,960 --> 00:55:13,440
make the maps actually fire properly

1610
00:55:13,440 --> 00:55:16,240
so this is us running an earlier version

1611
00:55:16,240 --> 00:55:17,280
of honey badger

1612
00:55:17,280 --> 00:55:19,040
thankfully google hasn't updated its map

1613
00:55:19,040 --> 00:55:20,640
in a long long long time

1614
00:55:20,640 --> 00:55:23,680
uh but we spent two weeks at a bank

1615
00:55:23,680 --> 00:55:26,720
and um it was kind of funny

1616
00:55:26,720 --> 00:55:29,119
because the uh bank in germany didn't

1617
00:55:29,119 --> 00:55:30,000
think that

1618
00:55:30,000 --> 00:55:33,200
it was going to uh it didn't think that

1619
00:55:33,200 --> 00:55:34,000
this was going to

1620
00:55:34,000 --> 00:55:37,040
work and we had over 250 hits

1621
00:55:37,040 --> 00:55:39,440
with honey badger and they went back and

1622
00:55:39,440 --> 00:55:41,440
they checked and cross-referenced all of

1623
00:55:41,440 --> 00:55:43,040
these different asn numbers for these

1624
00:55:43,040 --> 00:55:43,599
hits

1625
00:55:43,599 --> 00:55:44,960
and they were able to find it was like

1626
00:55:44,960 --> 00:55:46,880
three or four systems that were

1627
00:55:46,880 --> 00:55:47,680
compromised

1628
00:55:47,680 --> 00:55:50,400
that were connecting back beaconing back

1629
00:55:50,400 --> 00:55:52,400
to these particular computer systems

1630
00:55:52,400 --> 00:55:54,000
or to these network ranges and they were

1631
00:55:54,000 --> 00:55:55,599
able to find compromised computers once

1632
00:55:55,599 --> 00:55:56,559
again folks

1633
00:55:56,559 --> 00:55:59,599
this is threat intelligence this is

1634
00:55:59,599 --> 00:56:01,119
threat intelligence here

1635
00:56:01,119 --> 00:56:03,119
uh this is not like something that's on

1636
00:56:03,119 --> 00:56:04,559
the fringe of security

1637
00:56:04,559 --> 00:56:06,240
this is not something that brian krabs

1638
00:56:06,240 --> 00:56:08,480
would be like do everything else first

1639
00:56:08,480 --> 00:56:10,960
this works you know standard threat

1640
00:56:10,960 --> 00:56:13,040
intelligence and just ingesting feeds on

1641
00:56:13,040 --> 00:56:15,200
hash's ip addresses and urls

1642
00:56:15,200 --> 00:56:17,680
that doesn't stop an advanced attacker

1643
00:56:17,680 --> 00:56:19,760
this absolutely will stop

1644
00:56:19,760 --> 00:56:21,839
an advanced attacker and it will help

1645
00:56:21,839 --> 00:56:23,040
you and also

1646
00:56:23,040 --> 00:56:27,119
this makes security fun again

1647
00:56:27,119 --> 00:56:29,520
i mean this is what we thought computer

1648
00:56:29,520 --> 00:56:30,720
security was going to be

1649
00:56:30,720 --> 00:56:32,720
right we thought we would be tracking

1650
00:56:32,720 --> 00:56:34,640
hackers through cyberspace we'd be

1651
00:56:34,640 --> 00:56:37,359
hunting them down and it and it turns

1652
00:56:37,359 --> 00:56:38,079
out

1653
00:56:38,079 --> 00:56:39,920
that what we ended up doing was a lot of

1654
00:56:39,920 --> 00:56:42,839
audit and compliance and dealing with

1655
00:56:42,839 --> 00:56:45,760
spreadsheets and that sucks

1656
00:56:45,760 --> 00:56:47,920
because the more time we spend on those

1657
00:56:47,920 --> 00:56:49,760
things the less time we actually get to

1658
00:56:49,760 --> 00:56:51,200
spend working with real

1659
00:56:51,200 --> 00:56:53,520
actual honest-to-god security in our

1660
00:56:53,520 --> 00:56:54,640
networks

1661
00:56:54,640 --> 00:56:58,000
but this is fun and this works so

1662
00:56:58,000 --> 00:56:59,920
can we let go of some of the crap that

1663
00:56:59,920 --> 00:57:01,200
doesn't work or

1664
00:57:01,200 --> 00:57:02,960
more accurately the way i look at active

1665
00:57:02,960 --> 00:57:05,200
defense is not a replacement for

1666
00:57:05,200 --> 00:57:07,359
traditional security defenses but it's

1667
00:57:07,359 --> 00:57:09,280
helping us begin to fill

1668
00:57:09,280 --> 00:57:12,640
in those gaps that exist

1669
00:57:12,640 --> 00:57:15,040
in those defenses understanding that

1670
00:57:15,040 --> 00:57:16,880
there are in fact limitations

1671
00:57:16,880 --> 00:57:19,920
as well so how do we use this for threat

1672
00:57:19,920 --> 00:57:21,040
intel

1673
00:57:21,040 --> 00:57:23,440
so here's an email from kent a couple of

1674
00:57:23,440 --> 00:57:24,480
years ago

1675
00:57:24,480 --> 00:57:26,720
he said john i didn't think we'd um we

1676
00:57:26,720 --> 00:57:29,119
would think much of these on their own

1677
00:57:29,119 --> 00:57:30,559
however they all seem to be

1678
00:57:30,559 --> 00:57:32,319
geographically correlated

1679
00:57:32,319 --> 00:57:33,920
and we figured we should let you know in

1680
00:57:33,920 --> 00:57:35,839
the event you want to provide a specific

1681
00:57:35,839 --> 00:57:36,640
directive

1682
00:57:36,640 --> 00:57:38,400
this is what we've seen in the last four

1683
00:57:38,400 --> 00:57:41,599
weeks we've seen targeted phishing

1684
00:57:41,599 --> 00:57:44,160
originating from ipv6 addresses out of

1685
00:57:44,160 --> 00:57:44,799
the netherlands

1686
00:57:44,799 --> 00:57:46,960
targeted network scanning and rapid city

1687
00:57:46,960 --> 00:57:48,319
from the same network range

1688
00:57:48,319 --> 00:57:52,240
bhis doppel dns dynamic dns pointed

1689
00:57:52,240 --> 00:57:54,720
to an ip address a recent canary token

1690
00:57:54,720 --> 00:57:55,680
hidden webmail

1691
00:57:55,680 --> 00:57:58,559
from their address range godaddy cdn is

1692
00:57:58,559 --> 00:58:00,240
blocking an unusually high amount

1693
00:58:00,240 --> 00:58:03,040
of connections cj's getting phone calls

1694
00:58:03,040 --> 00:58:05,920
from antwerp

1695
00:58:06,799 --> 00:58:09,200
we using cyber deception and proper

1696
00:58:09,200 --> 00:58:10,400
monitoring

1697
00:58:10,400 --> 00:58:12,079
we were able to correlate all these

1698
00:58:12,079 --> 00:58:14,160
things back and i went on to twitter

1699
00:58:14,160 --> 00:58:15,760
because what are you gonna do

1700
00:58:15,760 --> 00:58:17,599
so i went on twitter and i said hey if

1701
00:58:17,599 --> 00:58:19,599
you're trying to attack our network

1702
00:58:19,599 --> 00:58:23,040
uh from these ranges please stop we see

1703
00:58:23,040 --> 00:58:23,920
you

1704
00:58:23,920 --> 00:58:25,520
and i got a direct message from like a

1705
00:58:25,520 --> 00:58:27,040
disposable account i don't know if it's

1706
00:58:27,040 --> 00:58:28,400
the real attackers or not

1707
00:58:28,400 --> 00:58:30,880
but they said how the hell did you know

1708
00:58:30,880 --> 00:58:33,359
that we were doing them

1709
00:58:33,359 --> 00:58:35,760
it's all about visibility it's all about

1710
00:58:35,760 --> 00:58:36,480
how we

1711
00:58:36,480 --> 00:58:38,400
change the way we look at security and

1712
00:58:38,400 --> 00:58:39,760
it's about augmenting

1713
00:58:39,760 --> 00:58:41,920
the different things that are missing in

1714
00:58:41,920 --> 00:58:43,200
computer security

1715
00:58:43,200 --> 00:58:46,799
as well so the final one i wanted to

1716
00:58:46,799 --> 00:58:48,079
talk about from mitre

1717
00:58:48,079 --> 00:58:51,520
is network analysis another part

1718
00:58:51,520 --> 00:58:54,720
that is so incredibly important to

1719
00:58:54,720 --> 00:58:56,400
everything that we do at black hills

1720
00:58:56,400 --> 00:58:58,000
information security and active

1721
00:58:58,000 --> 00:58:59,119
countermeasures

1722
00:58:59,119 --> 00:59:00,559
so active counter measures we have a

1723
00:59:00,559 --> 00:59:02,160
tool called ai hunter we're changing the

1724
00:59:02,160 --> 00:59:03,760
name to ac hunter

1725
00:59:03,760 --> 00:59:06,319
ai was a joke it was actual intelligence

1726
00:59:06,319 --> 00:59:08,319
instead of artificial intelligence

1727
00:59:08,319 --> 00:59:09,760
turns out there's a whole mess of people

1728
00:59:09,760 --> 00:59:11,520
at cai and they just aren't interested

1729
00:59:11,520 --> 00:59:12,559
in touching a product

1730
00:59:12,559 --> 00:59:15,119
but it's going to be called ac hunter

1731
00:59:15,119 --> 00:59:17,040
rebranding it here shortly

1732
00:59:17,040 --> 00:59:20,960
but miter added in network analysis for

1733
00:59:20,960 --> 00:59:24,400
detecting attacks at that in the two

1734
00:59:24,400 --> 00:59:25,839
columns for data exfiltration and

1735
00:59:25,839 --> 00:59:27,119
companion control

1736
00:59:27,119 --> 00:59:28,720
that none of your existing security

1737
00:59:28,720 --> 00:59:30,839
technologies are detecting

1738
00:59:30,839 --> 00:59:33,760
wow let's not

1739
00:59:33,760 --> 00:59:37,280
do that that's weird what am i hold on

1740
00:59:37,280 --> 00:59:38,799
i'm probably getting a spam mail right

1741
00:59:38,799 --> 00:59:41,040
now

1742
00:59:41,490 --> 00:59:44,000
[Music]

1743
00:59:44,000 --> 00:59:47,359
there fix that all right so network

1744
00:59:47,359 --> 00:59:49,599
monitoring is absolutely essential to

1745
00:59:49,599 --> 00:59:51,119
what we do

1746
00:59:51,119 --> 00:59:53,599
and how we defend our networks and the

1747
00:59:53,599 --> 00:59:54,480
reason why

1748
00:59:54,480 --> 00:59:56,559
we got into network monitoring is

1749
00:59:56,559 --> 00:59:58,079
because we had a wide number of

1750
00:59:58,079 --> 00:59:58,960
customers

1751
00:59:58,960 --> 01:00:00,880
almost all of them that couldn't detect

1752
01:00:00,880 --> 01:00:02,480
any of our command and control whenever

1753
01:00:02,480 --> 01:00:04,000
we were doing a pen test

1754
01:00:04,000 --> 01:00:06,880
so we created rita real intelligence

1755
01:00:06,880 --> 01:00:07,440
threat

1756
01:00:07,440 --> 01:00:10,079
analytics and what rita does is it

1757
01:00:10,079 --> 01:00:12,319
detects beacons in your environment

1758
01:00:12,319 --> 01:00:14,799
it'll detect uh fast beacons slow

1759
01:00:14,799 --> 01:00:16,160
beacons it'll detect

1760
01:00:16,160 --> 01:00:18,160
even beacons that are using variants if

1761
01:00:18,160 --> 01:00:19,359
they're using jitter

1762
01:00:19,359 --> 01:00:21,119
if you're using cobalt strike malleable

1763
01:00:21,119 --> 01:00:23,599
c2 profiles you set it at 10 second

1764
01:00:23,599 --> 01:00:24,559
intervals plus or

1765
01:00:24,559 --> 01:00:27,359
minus 20 seconds we can still detect

1766
01:00:27,359 --> 01:00:28,400
that with

1767
01:00:28,400 --> 01:00:31,200
jitter it does all kinds of things it

1768
01:00:31,200 --> 01:00:31,599
checks

1769
01:00:31,599 --> 01:00:34,000
existing internet blacklists it'll check

1770
01:00:34,000 --> 01:00:35,119
long connections

1771
01:00:35,119 --> 01:00:37,200
it'll do dns lookups looking for a high

1772
01:00:37,200 --> 01:00:38,480
number of dns

1773
01:00:38,480 --> 01:00:41,200
resolved subdomains or hosts indications

1774
01:00:41,200 --> 01:00:42,480
of attacks that are using command and

1775
01:00:42,480 --> 01:00:43,119
control

1776
01:00:43,119 --> 01:00:45,920
that are using dns like the ryuk botnet

1777
01:00:45,920 --> 01:00:47,680
that got the news last week because of

1778
01:00:47,680 --> 01:00:49,280
attacking hospitals

1779
01:00:49,280 --> 01:00:53,119
it's free it is absolutely free

1780
01:00:53,119 --> 01:00:57,839
so if you go to

1781
01:00:57,839 --> 01:01:01,359
rita active countermeasures

1782
01:01:06,319 --> 01:01:08,839
click download takes you to our github

1783
01:01:08,839 --> 01:01:10,799
repository

1784
01:01:10,799 --> 01:01:13,920
and we're updating it constantly and

1785
01:01:13,920 --> 01:01:16,400
this is important to me for a lot of

1786
01:01:16,400 --> 01:01:18,000
reasons this is easy to install

1787
01:01:18,000 --> 01:01:19,839
it'll automatically install zeek it'll

1788
01:01:19,839 --> 01:01:21,760
automatically install rita you're off

1789
01:01:21,760 --> 01:01:22,480
the races

1790
01:01:22,480 --> 01:01:25,359
automatic installer script works like a

1791
01:01:25,359 --> 01:01:26,240
champ

1792
01:01:26,240 --> 01:01:28,079
on a wide variety of different operating

1793
01:01:28,079 --> 01:01:30,160
systems so there's really no excuse for

1794
01:01:30,160 --> 01:01:30,559
you to

1795
01:01:30,559 --> 01:01:32,400
not run this set it up on a system with

1796
01:01:32,400 --> 01:01:33,839
a good network card

1797
01:01:33,839 --> 01:01:36,240
set it up on a system with good cpu and

1798
01:01:36,240 --> 01:01:37,359
good memory

1799
01:01:37,359 --> 01:01:39,119
and you're gonna get some amazing things

1800
01:01:39,119 --> 01:01:40,480
it is fast

1801
01:01:40,480 --> 01:01:42,799
um unless your network is like you know

1802
01:01:42,799 --> 01:01:43,839
50 gigs

1803
01:01:43,839 --> 01:01:46,240
per second or higher actually rita can

1804
01:01:46,240 --> 01:01:47,040
handle that too

1805
01:01:47,040 --> 01:01:49,760
just fine just give it enough cpu and

1806
01:01:49,760 --> 01:01:51,280
memory and read it is going to tear

1807
01:01:51,280 --> 01:01:52,799
through it but it's just like everything

1808
01:01:52,799 --> 01:01:54,400
you're going to need a big boat

1809
01:01:54,400 --> 01:01:56,000
we had one customer that was running a

1810
01:01:56,000 --> 01:01:57,599
100 gig network

1811
01:01:57,599 --> 01:01:59,760
rita had trouble with that um it had

1812
01:01:59,760 --> 01:02:00,960
trouble dealing with that it was

1813
01:02:00,960 --> 01:02:02,640
actually taking as long to process the

1814
01:02:02,640 --> 01:02:03,200
data

1815
01:02:03,200 --> 01:02:05,119
as it was for the data to come through

1816
01:02:05,119 --> 01:02:07,039
so it was definitely taking a while

1817
01:02:07,039 --> 01:02:09,760
but on the vast majority like 99.9

1818
01:02:09,760 --> 01:02:10,880
percent of the networks

1819
01:02:10,880 --> 01:02:12,319
rita is going to rock it it's written in

1820
01:02:12,319 --> 01:02:14,720
golang it's fast it's multi-threaded

1821
01:02:14,720 --> 01:02:17,760
it just it just kicks now the other

1822
01:02:17,760 --> 01:02:19,440
thing about this as i mentioned this is

1823
01:02:19,440 --> 01:02:20,079
free

1824
01:02:20,079 --> 01:02:21,839
and at black hills information security

1825
01:02:21,839 --> 01:02:23,760
we have put a tremendous amount of

1826
01:02:23,760 --> 01:02:24,480
effort

1827
01:02:24,480 --> 01:02:26,240
into this product over the years we have

1828
01:02:26,240 --> 01:02:27,920
our own dev team working in

1829
01:02:27,920 --> 01:02:29,599
now we do have a commercial product

1830
01:02:29,599 --> 01:02:31,280
absolutely we do have a commercial

1831
01:02:31,280 --> 01:02:33,599
product project associated with it

1832
01:02:33,599 --> 01:02:35,599
but the heart and soul of the commercial

1833
01:02:35,599 --> 01:02:37,119
project is in

1834
01:02:37,119 --> 01:02:40,559
rita it's very similar to sort snort and

1835
01:02:40,559 --> 01:02:42,000
cisco firepower

1836
01:02:42,000 --> 01:02:43,760
where snort if you know how to use it

1837
01:02:43,760 --> 01:02:45,119
you can stand up an intrusion detection

1838
01:02:45,119 --> 01:02:47,039
system on your own easy peasy

1839
01:02:47,039 --> 01:02:48,960
um but if you want a gui you want

1840
01:02:48,960 --> 01:02:50,079
alerting you want

1841
01:02:50,079 --> 01:02:52,160
tracking you want visualizations you're

1842
01:02:52,160 --> 01:02:53,359
gonna end up purchasing

1843
01:02:53,359 --> 01:02:56,000
a product so really ac hunter is really

1844
01:02:56,000 --> 01:02:57,119
the visualization

1845
01:02:57,119 --> 01:03:00,319
alerting and correlation engine for rita

1846
01:03:00,319 --> 01:03:02,880
um so why is this free and why is it

1847
01:03:02,880 --> 01:03:03,839
named rita

1848
01:03:03,839 --> 01:03:06,160
i didn't name it um it was named after

1849
01:03:06,160 --> 01:03:08,160
my mother

1850
01:03:08,160 --> 01:03:11,038
um so

1851
01:03:11,280 --> 01:03:14,720
when we started reading

1852
01:03:14,720 --> 01:03:16,640
my mom was kind of the cfo of black

1853
01:03:16,640 --> 01:03:19,039
hills information security

1854
01:03:19,039 --> 01:03:21,280
and i would fly down to phoenix arizona

1855
01:03:21,280 --> 01:03:23,599
to cancer treatment centers of america

1856
01:03:23,599 --> 01:03:26,000
and i would sit out in the hallway while

1857
01:03:26,000 --> 01:03:26,960
she was sleeping

1858
01:03:26,960 --> 01:03:28,160
doing her treatments and stuff for

1859
01:03:28,160 --> 01:03:31,359
before treatments and once she comes out

1860
01:03:31,359 --> 01:03:32,720
she sits down in the hallway with me

1861
01:03:32,720 --> 01:03:34,319
while i'm doing a webcast very similar

1862
01:03:34,319 --> 01:03:35,440
to this one

1863
01:03:35,440 --> 01:03:37,680
and um people saw her come on camera

1864
01:03:37,680 --> 01:03:39,200
they asked how she was doing she was

1865
01:03:39,200 --> 01:03:39,839
talking about

1866
01:03:39,839 --> 01:03:41,200
status of what she was doing with her

1867
01:03:41,200 --> 01:03:42,799
cancer treatment everything and there

1868
01:03:42,799 --> 01:03:44,400
was like a thousand people that were

1869
01:03:44,400 --> 01:03:46,400
giving her well wishes

1870
01:03:46,400 --> 01:03:50,079
and she asked that this

1871
01:03:50,079 --> 01:03:52,720
product stay free for the community and

1872
01:03:52,720 --> 01:03:54,000
her logic was

1873
01:03:54,000 --> 01:03:56,960
the community has been so good to black

1874
01:03:56,960 --> 01:03:58,799
hills information security

1875
01:03:58,799 --> 01:04:00,400
that this is absolutely something that

1876
01:04:00,400 --> 01:04:04,000
we need to give back

1877
01:04:05,200 --> 01:04:07,520
at black hills information security one

1878
01:04:07,520 --> 01:04:09,359
of our mottos is proudly sucking at

1879
01:04:09,359 --> 01:04:10,480
capitalism

1880
01:04:10,480 --> 01:04:13,200
and they need to clarify what that means

1881
01:04:13,200 --> 01:04:14,559
because a lot of people will be like

1882
01:04:14,559 --> 01:04:15,760
well they're socialists

1883
01:04:15,760 --> 01:04:17,680
no i'm not i'm not a socialist i'm not a

1884
01:04:17,680 --> 01:04:18,880
communist

1885
01:04:18,880 --> 01:04:22,319
but if you look at traditional like

1886
01:04:22,319 --> 01:04:24,720
traditional capitalism it's all about

1887
01:04:24,720 --> 01:04:26,240
trying to squeeze

1888
01:04:26,240 --> 01:04:28,400
as much money out of something as you

1889
01:04:28,400 --> 01:04:30,720
can possibly do

1890
01:04:30,720 --> 01:04:34,319
and i'm telling you that is not

1891
01:04:34,319 --> 01:04:37,440
true if you want to be successful in

1892
01:04:37,440 --> 01:04:38,640
business

1893
01:04:38,640 --> 01:04:40,960
don't watch wall street don't watch

1894
01:04:40,960 --> 01:04:42,799
movies and things that agreed is good

1895
01:04:42,799 --> 01:04:44,720
don't watch shark tank or swimming with

1896
01:04:44,720 --> 01:04:45,680
sharks or

1897
01:04:45,680 --> 01:04:48,799
uh boiler room or any of those things

1898
01:04:48,799 --> 01:04:52,799
that's garbage my mom knew

1899
01:04:52,799 --> 01:04:56,319
and i knew that

1900
01:04:56,319 --> 01:04:59,119
the more you give back to the community

1901
01:04:59,119 --> 01:05:00,720
you work in

1902
01:05:00,720 --> 01:05:02,640
the more that community gives back to

1903
01:05:02,640 --> 01:05:04,240
you

1904
01:05:04,240 --> 01:05:06,079
so by releasing this tool that we put

1905
01:05:06,079 --> 01:05:08,000
like three million dollars into

1906
01:05:08,000 --> 01:05:11,119
over the past four years by

1907
01:05:11,119 --> 01:05:13,280
releasing games that we break even on

1908
01:05:13,280 --> 01:05:15,039
backdoors and breaches jason and i were

1909
01:05:15,039 --> 01:05:16,000
talking about this

1910
01:05:16,000 --> 01:05:18,640
today we break even on every box that we

1911
01:05:18,640 --> 01:05:20,720
sell we are not out to make a profit

1912
01:05:20,720 --> 01:05:22,799
and this was the number one selling

1913
01:05:22,799 --> 01:05:24,880
educational game on amazon

1914
01:05:24,880 --> 01:05:27,200
for a few days we could have made a lot

1915
01:05:27,200 --> 01:05:29,039
of money off it but we didn't

1916
01:05:29,039 --> 01:05:30,799
our t-shirts that were we're selling in

1917
01:05:30,799 --> 01:05:32,720
our spearfish general store

1918
01:05:32,720 --> 01:05:35,440
they we're trying to break even folks

1919
01:05:35,440 --> 01:05:37,440
these webcasts that we do the training

1920
01:05:37,440 --> 01:05:38,720
that we do

1921
01:05:38,720 --> 01:05:42,559
all of it gives back to this company

1922
01:05:42,559 --> 01:05:46,319
and rita is a huge part of that my mom

1923
01:05:46,319 --> 01:05:48,960
was a huge part of it now unfortunately

1924
01:05:48,960 --> 01:05:50,640
she did pass away from pancreatic

1925
01:05:50,640 --> 01:05:52,559
cancer but it is something that's

1926
01:05:52,559 --> 01:05:55,119
important to us in adhd

1927
01:05:55,119 --> 01:05:58,480
in honey badger in rita and if you look

1928
01:05:58,480 --> 01:06:00,160
at the people of black hills information

1929
01:06:00,160 --> 01:06:01,200
security if you

1930
01:06:01,200 --> 01:06:04,160
look at the people at trusted sec if you

1931
01:06:04,160 --> 01:06:06,240
look at the people that rendition

1932
01:06:06,240 --> 01:06:08,160
you're gonna find a theme through a

1933
01:06:08,160 --> 01:06:09,920
whole bunch of great pen testing firms

1934
01:06:09,920 --> 01:06:11,039
and i didn't mention all of them right i

1935
01:06:11,039 --> 01:06:12,400
could have gone to secure ideas and

1936
01:06:12,400 --> 01:06:14,480
guardians and all these different firms

1937
01:06:14,480 --> 01:06:16,400
you have a tremendous number of groups

1938
01:06:16,400 --> 01:06:17,760
and firms out there

1939
01:06:17,760 --> 01:06:20,559
who are giving back to the community and

1940
01:06:20,559 --> 01:06:22,160
the people and the organizers that are

1941
01:06:22,160 --> 01:06:24,000
putting this conference together

1942
01:06:24,000 --> 01:06:26,319
they're giving back to the community so

1943
01:06:26,319 --> 01:06:28,480
i ask you this as we started this entire

1944
01:06:28,480 --> 01:06:29,359
conversation

1945
01:06:29,359 --> 01:06:30,799
there was a lot of talk of infosec

1946
01:06:30,799 --> 01:06:33,039
burnout and burnout being on twitter

1947
01:06:33,039 --> 01:06:34,880
and burnout in conversations that we

1948
01:06:34,880 --> 01:06:36,480
have dealing with politics and

1949
01:06:36,480 --> 01:06:37,440
everything

1950
01:06:37,440 --> 01:06:39,839
i ask you don't get burned out please

1951
01:06:39,839 --> 01:06:41,760
continue giving back

1952
01:06:41,760 --> 01:06:44,319
because amazing wonderful things will

1953
01:06:44,319 --> 01:06:45,200
happen to you

1954
01:06:45,200 --> 01:06:47,839
when you do so i'd like to open it up

1955
01:06:47,839 --> 01:06:49,680
for any questions that people have

1956
01:06:49,680 --> 01:06:52,799
um i actually don't have the discord

1957
01:06:52,799 --> 01:06:53,359
channel

1958
01:06:53,359 --> 01:06:56,240
up and running um once again if somebody

1959
01:06:56,240 --> 01:06:57,119
could put

1960
01:06:57,119 --> 01:07:00,640
the discord channel up in chat

1961
01:07:00,640 --> 01:07:02,640
on go to webinar so i can actually jump

1962
01:07:02,640 --> 01:07:04,960
into it i would appreciate it maybe is

1963
01:07:04,960 --> 01:07:08,160
it on our discord channel

1964
01:07:11,680 --> 01:07:15,119
come on over here

1965
01:07:15,119 --> 01:07:19,599
i don't see where we are all right

1966
01:07:19,599 --> 01:07:21,680
so like i said i wanted to throw it back

1967
01:07:21,680 --> 01:07:23,359
to the folks that are putting on the

1968
01:07:23,359 --> 01:07:24,720
conference let me stop

1969
01:07:24,720 --> 01:07:28,000
sharing my screen and like i said

1970
01:07:28,000 --> 01:07:30,559
i want to open this up to questions and

1971
01:07:30,559 --> 01:07:31,039
i'm not

1972
01:07:31,039 --> 01:07:34,079
getting the discord link sorry john

1973
01:07:34,079 --> 01:07:37,359
yeah um there were a couple of questions

1974
01:07:37,359 --> 01:07:39,119
in the discord

1975
01:07:39,119 --> 01:07:40,960
sure let's do it the first one's one of

1976
01:07:40,960 --> 01:07:42,640
the first ones that i saw

1977
01:07:42,640 --> 01:07:44,799
was can you use the canary tokens and

1978
01:07:44,799 --> 01:07:45,839
some of that for

1979
01:07:45,839 --> 01:07:49,119
insider threat um and i believe you can

1980
01:07:49,119 --> 01:07:50,400
but i wanted to get your

1981
01:07:50,400 --> 01:07:52,880
input on that yes yes you can just give

1982
01:07:52,880 --> 01:07:54,160
me a second let me open up a different

1983
01:07:54,160 --> 01:07:55,520
slide deck here

1984
01:07:55,520 --> 01:07:59,440
real quick um let me

1985
01:07:59,440 --> 01:08:00,960
i'm going to start sharing my screen i'm

1986
01:08:00,960 --> 01:08:02,960
opening up a different slide deck

1987
01:08:02,960 --> 01:08:05,920
just give me and while you do that i

1988
01:08:05,920 --> 01:08:07,680
think i was at the derby con where you

1989
01:08:07,680 --> 01:08:09,920
you released rita and it was one of my

1990
01:08:09,920 --> 01:08:11,599
first interactions with that

1991
01:08:11,599 --> 01:08:14,400
and it was amazing it was funny when we

1992
01:08:14,400 --> 01:08:15,359
first

1993
01:08:15,359 --> 01:08:17,439
yeah the first iteration of rito was

1994
01:08:17,439 --> 01:08:19,120
running in elastic

1995
01:08:19,120 --> 01:08:21,279
and uh it was on elk and it was written

1996
01:08:21,279 --> 01:08:24,000
in python it was very very very slow

1997
01:08:24,000 --> 01:08:26,319
um it's now i think it's like a thousand

1998
01:08:26,319 --> 01:08:28,238
times faster but that was a great derby

1999
01:08:28,238 --> 01:08:28,719
con

2000
01:08:28,719 --> 01:08:30,080
that was actually the derby con that

2001
01:08:30,080 --> 01:08:32,319
they set our booth up at bhis directly

2002
01:08:32,319 --> 01:08:34,238
across from semantics

2003
01:08:34,238 --> 01:08:36,960
and symantec the guy at symantec kept on

2004
01:08:36,960 --> 01:08:38,158
saying um

2005
01:08:38,158 --> 01:08:40,479
yeah our endpoint antivirus is

2006
01:08:40,479 --> 01:08:42,238
unhackable no one can bypass

2007
01:08:42,238 --> 01:08:44,640
it um i leave it to any of the so-called

2008
01:08:44,640 --> 01:08:46,479
hackers here to try to bypass our

2009
01:08:46,479 --> 01:08:47,439
antivirus

2010
01:08:47,439 --> 01:08:49,439
and uh in guardians i remember j beale

2011
01:08:49,439 --> 01:08:52,000
was there we sat down and we bypassed

2012
01:08:52,000 --> 01:08:54,158
the uh uh antivirus took us like 10

2013
01:08:54,158 --> 01:08:55,040
minutes to do

2014
01:08:55,040 --> 01:08:56,719
and then we created a loop where we were

2015
01:08:56,719 --> 01:08:58,319
bypassing the product he was talking

2016
01:08:58,319 --> 01:08:58,960
about

2017
01:08:58,960 --> 01:09:00,719
um every five minutes so that was a lot

2018
01:09:00,719 --> 01:09:03,759
of fun uh that was a great derby con

2019
01:09:03,759 --> 01:09:06,960
but the answer huh what's that thanks

2020
01:09:06,960 --> 01:09:07,839
not to ever say

2021
01:09:07,839 --> 01:09:10,640
unhackable well yeah that's right i mean

2022
01:09:10,640 --> 01:09:11,040
if

2023
01:09:11,040 --> 01:09:12,880
we're going to talk about the thing that

2024
01:09:12,880 --> 01:09:14,640
you should not do

2025
01:09:14,640 --> 01:09:16,719
ever you should never go to a hacker

2026
01:09:16,719 --> 01:09:17,679
conference

2027
01:09:17,679 --> 01:09:20,319
and basically say um you know we're

2028
01:09:20,319 --> 01:09:21,920
unhackable that's just a bad

2029
01:09:21,920 --> 01:09:25,439
life choice for anybody in marketing um

2030
01:09:25,439 --> 01:09:28,719
at all so okay so i'm opening up a

2031
01:09:28,719 --> 01:09:30,319
different deck i'm gonna start sharing

2032
01:09:30,319 --> 01:09:31,279
my screen

2033
01:09:31,279 --> 01:09:34,719
so for detecting the insider

2034
01:09:34,719 --> 01:09:36,319
so the way that you would detect an

2035
01:09:36,319 --> 01:09:38,238
insider is you can do a honey share and

2036
01:09:38,238 --> 01:09:39,279
a honey doc

2037
01:09:39,279 --> 01:09:41,279
all right so if you're looking at edward

2038
01:09:41,279 --> 01:09:42,719
snowden if you're looking at a number of

2039
01:09:42,719 --> 01:09:44,880
different types of attackers

2040
01:09:44,880 --> 01:09:46,319
that are insiders they're usually

2041
01:09:46,319 --> 01:09:48,479
looking for those sensitive documents

2042
01:09:48,479 --> 01:09:50,399
so what you do is you create your word

2043
01:09:50,399 --> 01:09:52,238
web bug just like i talked about showed

2044
01:09:52,238 --> 01:09:53,040
you

2045
01:09:53,040 --> 01:09:55,280
then you would be using in packet to

2046
01:09:55,280 --> 01:09:56,560
create your share

2047
01:09:56,560 --> 01:09:57,840
now you can do the same thing with

2048
01:09:57,840 --> 01:10:00,400
logging uh file and directory logging in

2049
01:10:00,400 --> 01:10:02,080
active directory and on windows

2050
01:10:02,080 --> 01:10:04,480
but you can also do it in packet as well

2051
01:10:04,480 --> 01:10:06,480
so we move our document over

2052
01:10:06,480 --> 01:10:08,560
and then if we start in packet in this

2053
01:10:08,560 --> 01:10:10,719
situation it's the dot forward slash smb

2054
01:10:10,719 --> 01:10:11,440
server

2055
01:10:11,440 --> 01:10:13,840
comment is secret super secret and then

2056
01:10:13,840 --> 01:10:14,800
we're basically

2057
01:10:14,800 --> 01:10:17,600
sharing out the directory secret super

2058
01:10:17,600 --> 01:10:19,440
and what happens whenever the

2059
01:10:19,440 --> 01:10:22,640
insider opens the document then

2060
01:10:22,640 --> 01:10:26,320
impacted also logs the ip address host

2061
01:10:26,320 --> 01:10:27,040
name

2062
01:10:27,040 --> 01:10:30,080
username and the nt net

2063
01:10:30,080 --> 01:10:33,440
ntlm v2 hash for the user that's

2064
01:10:33,440 --> 01:10:34,960
actually accessing the files

2065
01:10:34,960 --> 01:10:37,360
on that chair so hopefully that answered

2066
01:10:37,360 --> 01:10:44,719
your question any other questions you

2067
01:10:44,719 --> 01:10:48,239
said there was a couple of questions

2068
01:10:49,679 --> 01:10:51,440
yeah i'm looking through the discord now

2069
01:10:51,440 --> 01:10:53,600
and it doesn't there was a comment that

2070
01:10:53,600 --> 01:10:54,800
i had actually made about

2071
01:10:54,800 --> 01:10:56,960
um countermeasures leading to counter

2072
01:10:56,960 --> 01:10:58,080
counter measures right

2073
01:10:58,080 --> 01:11:00,320
so you start dropping canary tokens how

2074
01:11:00,320 --> 01:11:01,600
does the attacker

2075
01:11:01,600 --> 01:11:04,640
start cloning files into disconnected

2076
01:11:04,640 --> 01:11:07,920
networks and whatnot but

2077
01:11:08,159 --> 01:11:11,120
so this is really cool all right so this

2078
01:11:11,120 --> 01:11:12,400
is awesome

2079
01:11:12,400 --> 01:11:13,679
because what you're talking about is

2080
01:11:13,679 --> 01:11:14,880
you're talking about fundamentally

2081
01:11:14,880 --> 01:11:16,880
changing the behavior of the attacker

2082
01:11:16,880 --> 01:11:18,560
right and that is ultimately what we're

2083
01:11:18,560 --> 01:11:20,159
after with active countermeasures

2084
01:11:20,159 --> 01:11:22,159
so anytime you have someone that's like

2085
01:11:22,159 --> 01:11:23,199
well you know

2086
01:11:23,199 --> 01:11:25,120
if i found that there was this document

2087
01:11:25,120 --> 01:11:26,719
i would start opening it and all these

2088
01:11:26,719 --> 01:11:28,159
other different places

2089
01:11:28,159 --> 01:11:30,480
i'm okay with that it's kind of like a

2090
01:11:30,480 --> 01:11:32,159
claymore it's basically

2091
01:11:32,159 --> 01:11:34,640
let's use a bear trap let's say i have a

2092
01:11:34,640 --> 01:11:36,320
bear trap in my house and someone comes

2093
01:11:36,320 --> 01:11:37,199
in they're like

2094
01:11:37,199 --> 01:11:39,600
yeah dude as soon as i step into that

2095
01:11:39,600 --> 01:11:40,800
bear trap

2096
01:11:40,800 --> 01:11:43,040
then i could totally avoid the bear trap

2097
01:11:43,040 --> 01:11:44,880
it doesn't matter you already stepped

2098
01:11:44,880 --> 01:11:46,640
into the damn bear trap

2099
01:11:46,640 --> 01:11:48,239
so they're gonna trigger that canary

2100
01:11:48,239 --> 01:11:49,840
token and we see that

2101
01:11:49,840 --> 01:11:51,600
with honey badger once somebody knows

2102
01:11:51,600 --> 01:11:53,040
that there's a beacon it's like oops

2103
01:11:53,040 --> 01:11:54,000
we've been caught

2104
01:11:54,000 --> 01:11:56,000
they try to flood the honey badger

2105
01:11:56,000 --> 01:11:57,040
server with

2106
01:11:57,040 --> 01:11:59,840
millions of bogus locations but we

2107
01:11:59,840 --> 01:12:01,280
nailed them on the first time

2108
01:12:01,280 --> 01:12:04,719
that they did it so we're changing the

2109
01:12:04,719 --> 01:12:06,159
attacker's behavior

2110
01:12:06,159 --> 01:12:08,080
and that's exactly what we need to do we

2111
01:12:08,080 --> 01:12:09,520
can be like let's stick with sucky

2112
01:12:09,520 --> 01:12:10,960
defenses because we don't want the

2113
01:12:10,960 --> 01:12:12,080
attackers to get better

2114
01:12:12,080 --> 01:12:15,040
we just can't do that right no i i think

2115
01:12:15,040 --> 01:12:16,719
that's a good point and you you bring up

2116
01:12:16,719 --> 01:12:17,280
this is

2117
01:12:17,280 --> 01:12:19,360
actual threat intelligence i do a bunch

2118
01:12:19,360 --> 01:12:20,880
of threat intelligence with other

2119
01:12:20,880 --> 01:12:22,000
organizations it's not really

2120
01:12:22,000 --> 01:12:25,679
intelligence it's more like archaeology

2121
01:12:25,679 --> 01:12:27,360
i like that and there is some

2122
01:12:27,360 --> 01:12:29,199
intelligence in archaeology right i mean

2123
01:12:29,199 --> 01:12:30,719
there is

2124
01:12:30,719 --> 01:12:32,560
but it's not like you can read what the

2125
01:12:32,560 --> 01:12:33,760
egyptians did

2126
01:12:33,760 --> 01:12:35,920
and you can apply that to how to fix

2127
01:12:35,920 --> 01:12:37,360
your honda accord right

2128
01:12:37,360 --> 01:12:40,320
it's just there's lessons to be learned

2129
01:12:40,320 --> 01:12:40,640
from

2130
01:12:40,640 --> 01:12:42,400
overall engineering principles like you

2131
01:12:42,400 --> 01:12:44,000
know angle of repose and things like

2132
01:12:44,000 --> 01:12:44,480
that

2133
01:12:44,480 --> 01:12:46,400
but it's not exactly going to be useful

2134
01:12:46,400 --> 01:12:47,920
for you building your home

2135
01:12:47,920 --> 01:12:49,920
it there's things to be learned it's

2136
01:12:49,920 --> 01:12:51,040
additive but

2137
01:12:51,040 --> 01:12:52,800
for actually defending against specific

2138
01:12:52,800 --> 01:12:54,480
attackers not so much

2139
01:12:54,480 --> 01:12:56,080
no and i think it's a great point and

2140
01:12:56,080 --> 01:12:58,159
the tools as you said giving back to our

2141
01:12:58,159 --> 01:13:01,280
community i think helps us not burn out

2142
01:13:01,280 --> 01:13:05,360
yes teaching i would agree with that

2143
01:13:05,360 --> 01:13:06,880
it can go the other way we have a couple

2144
01:13:06,880 --> 01:13:08,880
developers uh bradley

2145
01:13:08,880 --> 01:13:12,239
and uh justin we've got a ton

2146
01:13:12,239 --> 01:13:13,840
um that they get into giving back and

2147
01:13:13,840 --> 01:13:15,600
they're like working bhis and then they

2148
01:13:15,600 --> 01:13:17,520
spend way too much time on open source

2149
01:13:17,520 --> 01:13:19,199
projects so we have to give them time

2150
01:13:19,199 --> 01:13:20,719
to work on those projects because it is

2151
01:13:20,719 --> 01:13:22,320
easy to get burnt out marcelo

2152
01:13:22,320 --> 01:13:24,800
is a great example bipleader he's

2153
01:13:24,800 --> 01:13:26,640
working his day job at bhcis

2154
01:13:26,640 --> 01:13:28,800
and he's releasing crack map exec death

2155
01:13:28,800 --> 01:13:30,960
star silent trinity

2156
01:13:30,960 --> 01:13:34,080
um all of these different tools and it's

2157
01:13:34,080 --> 01:13:34,320
it's

2158
01:13:34,320 --> 01:13:36,640
it takes its toll after a while and as a

2159
01:13:36,640 --> 01:13:38,239
community we tend not to treat people

2160
01:13:38,239 --> 01:13:38,880
real well

2161
01:13:38,880 --> 01:13:40,320
they're like hey there's a bug and crack

2162
01:13:40,320 --> 01:13:42,640
mac exec get off your ass and fix it

2163
01:13:42,640 --> 01:13:44,640
it's like oh we need to be nicer to

2164
01:13:44,640 --> 01:13:46,800
people that are giving free stuff out

2165
01:13:46,800 --> 01:13:49,520
yeah and i i learned i was in my cello's

2166
01:13:49,520 --> 01:13:50,320
stream

2167
01:13:50,320 --> 01:13:51,440
actually that's a funny story they

2168
01:13:51,440 --> 01:13:54,000
invited me instead of you oh wow that's

2169
01:13:54,000 --> 01:13:54,320
cool

2170
01:13:54,320 --> 01:13:57,440
yeah jason invited me by accident so but

2171
01:13:57,440 --> 01:13:58,880
i had actually watched marcelo's first

2172
01:13:58,880 --> 01:13:59,920
stream and i figured out what i was

2173
01:13:59,920 --> 01:14:01,040
doing wrong with python

2174
01:14:01,040 --> 01:14:02,719
libraries because i was using two

2175
01:14:02,719 --> 01:14:04,159
different

2176
01:14:04,159 --> 01:14:07,120
managers dude we don't get a lot of

2177
01:14:07,120 --> 01:14:08,320
people attending those it's a good

2178
01:14:08,320 --> 01:14:10,000
number but there's so many people like

2179
01:14:10,000 --> 01:14:13,760
that webcast just saved me weeks of time

2180
01:14:13,760 --> 01:14:15,679
and it's funny because if you look at it

2181
01:14:15,679 --> 01:14:18,080
it's marcelo wasted weeks of time and

2182
01:14:18,080 --> 01:14:19,040
he's sharing what he

2183
01:14:19,040 --> 01:14:21,440
did so you don't have to that's

2184
01:14:21,440 --> 01:14:22,239
absolutely

2185
01:14:22,239 --> 01:14:23,920
your slides are in the discord for

2186
01:14:23,920 --> 01:14:25,760
anybody who wants to download those

2187
01:14:25,760 --> 01:14:27,760
um john i will unless you have anything

2188
01:14:27,760 --> 01:14:30,159
else sir i will let you go we

2189
01:14:30,159 --> 01:14:32,480
absolutely appreciate your keynotes and

2190
01:14:32,480 --> 01:14:33,840
all the knowledge you share and all the

2191
01:14:33,840 --> 01:14:36,320
give back that you do to this community

2192
01:14:36,320 --> 01:14:38,239
that's what it's all about all right

2193
01:14:38,239 --> 01:14:39,840
well thank you so much you all have a

2194
01:14:39,840 --> 01:14:40,400
great

2195
01:14:40,400 --> 01:14:41,679
rest of the conference talk to you all

2196
01:14:41,679 --> 01:14:45,920
later you too sir

