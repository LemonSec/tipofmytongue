1
00:00:09,300 --> 00:00:11,400
all right great thank you everybody for

2
00:00:11,400 --> 00:00:14,580
attending the uh final talk track here

3
00:00:14,580 --> 00:00:16,560
at secure West Virginia pleasure to be

4
00:00:16,560 --> 00:00:17,580
here again I want to thank the

5
00:00:17,580 --> 00:00:19,500
conference organizers once again for

6
00:00:19,500 --> 00:00:20,880
having me

7
00:00:20,880 --> 00:00:22,859
um my talk today is called becoming an

8
00:00:22,859 --> 00:00:25,740
IR Superstar uh again you can follow me

9
00:00:25,740 --> 00:00:27,840
on Twitter or reach out to me on

10
00:00:27,840 --> 00:00:30,000
LinkedIn if you want to download a copy

11
00:00:30,000 --> 00:00:32,360
of the slide decks just go to

12
00:00:32,360 --> 00:00:35,280
slides.dfirmatt.com and that'll redirect

13
00:00:35,280 --> 00:00:37,140
you to my GitHub repo you can download

14
00:00:37,140 --> 00:00:39,480
my my slides here

15
00:00:39,480 --> 00:00:41,700
all right so just real quick about me

16
00:00:41,700 --> 00:00:43,980
what I do is I work for a big well-known

17
00:00:43,980 --> 00:00:46,680
organization as an assistant vice

18
00:00:46,680 --> 00:00:48,360
president of computer security and

19
00:00:48,360 --> 00:00:50,760
incident response however I have many

20
00:00:50,760 --> 00:00:53,039
years of Hands-On technical experience

21
00:00:53,039 --> 00:00:55,620
uh including digital forensics and

22
00:00:55,620 --> 00:00:58,199
incident response uh we've been in the

23
00:00:58,199 --> 00:01:00,480
dust bin for a while entirely my fault I

24
00:01:00,480 --> 00:01:02,340
don't have time to do audio editing but

25
00:01:02,340 --> 00:01:05,099
uh my buddy and I have a podcast called

26
00:01:05,099 --> 00:01:08,700
threat real you can check us out I also

27
00:01:08,700 --> 00:01:10,799
do a lot of volunteer work I'm an

28
00:01:10,799 --> 00:01:13,020
official hacking is not a crime Advocate

29
00:01:13,020 --> 00:01:15,600
and I can read out on that mission

30
00:01:15,600 --> 00:01:18,420
statement there I'm also a technical

31
00:01:18,420 --> 00:01:20,640
Mentor for wampsa which is the women's

32
00:01:20,640 --> 00:01:22,979
security Alliance great organization

33
00:01:22,979 --> 00:01:25,080
they're always looking for mentors and

34
00:01:25,080 --> 00:01:28,920
mentees so check out their website

35
00:01:28,920 --> 00:01:31,259
a quick disclaimer is that yes I do have

36
00:01:31,259 --> 00:01:33,540
a day job the opinions expressed are

37
00:01:33,540 --> 00:01:35,340
based solely on my own independent

38
00:01:35,340 --> 00:01:37,200
security research and do not express or

39
00:01:37,200 --> 00:01:39,180
reflect the views or opinions of my

40
00:01:39,180 --> 00:01:40,560
employer

41
00:01:40,560 --> 00:01:42,360
the agenda is we're going to talk about

42
00:01:42,360 --> 00:01:44,520
instant response Essentials covering

43
00:01:44,520 --> 00:01:47,040
basic technical skills and Baseline

44
00:01:47,040 --> 00:01:49,079
knowledge required for incident response

45
00:01:49,079 --> 00:01:51,840
investigative analysis and then we'll do

46
00:01:51,840 --> 00:01:54,180
q a to wrap it up

47
00:01:54,180 --> 00:01:56,759
why this talk this talk is inspired by

48
00:01:56,759 --> 00:01:58,799
job candidates I participated in

49
00:01:58,799 --> 00:02:01,079
interviewing for level four principal

50
00:02:01,079 --> 00:02:04,320
security engineer incident response

51
00:02:04,320 --> 00:02:06,360
positions and really finding people

52
00:02:06,360 --> 00:02:10,199
ready for that level of uh you know

53
00:02:10,199 --> 00:02:12,360
having that level of skill finding him

54
00:02:12,360 --> 00:02:13,980
for those kind of roles is pretty hard

55
00:02:13,980 --> 00:02:16,620
and we see consistently some knowledge

56
00:02:16,620 --> 00:02:18,900
and skill gaps and so the purpose of

57
00:02:18,900 --> 00:02:22,140
this talk is the help address that and

58
00:02:22,140 --> 00:02:24,420
uh you know really also for anybody

59
00:02:24,420 --> 00:02:26,780
that's an aspiring incident response

60
00:02:26,780 --> 00:02:29,220
analyst or engineer just to kind of help

61
00:02:29,220 --> 00:02:31,200
them build upon their knowledge and

62
00:02:31,200 --> 00:02:33,180
really share some resources where people

63
00:02:33,180 --> 00:02:37,080
can go to uh hone in on those skills uh

64
00:02:37,080 --> 00:02:39,300
the role in the instant response is uh

65
00:02:39,300 --> 00:02:40,860
that in the incident responders

66
00:02:40,860 --> 00:02:42,959
investigate security incidents events

67
00:02:42,959 --> 00:02:45,599
and alerts answer this classic who what

68
00:02:45,599 --> 00:02:49,200
where why when and how questions

69
00:02:49,200 --> 00:02:51,959
inspiring incident responders uh really

70
00:02:51,959 --> 00:02:55,080
should have a uh good working knowledge

71
00:02:55,080 --> 00:02:57,900
preferably firsthand of defensive

72
00:02:57,900 --> 00:02:59,160
security

73
00:02:59,160 --> 00:03:01,920
offensive security and digital forensics

74
00:03:01,920 --> 00:03:03,480
and we're going to touch on all of these

75
00:03:03,480 --> 00:03:06,660
throughout the talk but when IR starts

76
00:03:06,660 --> 00:03:10,319
is it typically begins when uh somebody

77
00:03:10,319 --> 00:03:12,720
reports suspicious activity within an

78
00:03:12,720 --> 00:03:15,420
Enterprise environment uh well that

79
00:03:15,420 --> 00:03:17,099
happens sometimes most of the time

80
00:03:17,099 --> 00:03:18,780
though you're getting some sort of an

81
00:03:18,780 --> 00:03:22,800
automated alert from a SIM platform uh

82
00:03:22,800 --> 00:03:25,400
some sort of a soar platform

83
00:03:25,400 --> 00:03:27,720
automated triggers configured within

84
00:03:27,720 --> 00:03:31,920
like AV EDR uh or network detection

85
00:03:31,920 --> 00:03:34,680
response ndr sometimes you see endpoint

86
00:03:34,680 --> 00:03:36,780
detection response and network detection

87
00:03:36,780 --> 00:03:39,540
response melded together and they will

88
00:03:39,540 --> 00:03:42,360
call it xdr to you know sort of say

89
00:03:42,360 --> 00:03:44,760
they're covering both of those bases and

90
00:03:44,760 --> 00:03:46,620
then you have your classic IDs and IPS

91
00:03:46,620 --> 00:03:48,959
systems just to name several so most of

92
00:03:48,959 --> 00:03:50,819
the investigations start with the

93
00:03:50,819 --> 00:03:53,340
systems but once in a while a user will

94
00:03:53,340 --> 00:03:56,040
report something uh and uh you know

95
00:03:56,040 --> 00:03:57,659
that's when we start digging into those

96
00:03:57,659 --> 00:03:59,280
things

97
00:03:59,280 --> 00:04:02,519
so diving deep here and uh you know I'm

98
00:04:02,519 --> 00:04:05,099
going to start out fairly simple

99
00:04:05,099 --> 00:04:07,920
um but really my objective is not to

100
00:04:07,920 --> 00:04:09,720
tell people in this room things they

101
00:04:09,720 --> 00:04:11,640
already know hopefully you walk out of

102
00:04:11,640 --> 00:04:14,040
here Having learned something new if you

103
00:04:14,040 --> 00:04:15,480
walk out of this room and have not

104
00:04:15,480 --> 00:04:17,040
learned something new sitting on this

105
00:04:17,040 --> 00:04:19,199
talk come talk to me afterwards because

106
00:04:19,199 --> 00:04:20,579
we should chat about career

107
00:04:20,579 --> 00:04:23,820
opportunities but while working with

108
00:04:23,820 --> 00:04:27,419
information from an organization Sims or

109
00:04:27,419 --> 00:04:33,419
AV EDR ndr xdr and IPS uh or IDs while

110
00:04:33,419 --> 00:04:34,919
those Solutions are critical in an

111
00:04:34,919 --> 00:04:36,780
Enterprise environment what I caution

112
00:04:36,780 --> 00:04:39,180
people is don't become too reliant on

113
00:04:39,180 --> 00:04:41,400
any one of those security tools or

114
00:04:41,400 --> 00:04:43,979
Solutions alone learning and developing

115
00:04:43,979 --> 00:04:46,080
a better understanding of the properties

116
00:04:46,080 --> 00:04:48,120
of files and the underlying activities

117
00:04:48,120 --> 00:04:50,460
that trigger those alerts really is

118
00:04:50,460 --> 00:04:52,199
Paramount to becoming a better incident

119
00:04:52,199 --> 00:04:54,900
responder and so this is we're going to

120
00:04:54,900 --> 00:04:56,460
start off real basic just to make sure

121
00:04:56,460 --> 00:04:58,199
everybody knows where I'm coming from

122
00:04:58,199 --> 00:05:00,479
but uh understanding alert dispositions

123
00:05:00,479 --> 00:05:02,340
so most everybody in this room probably

124
00:05:02,340 --> 00:05:04,800
knows this but in case you don't

125
00:05:04,800 --> 00:05:08,280
um you have really like a true detection

126
00:05:08,280 --> 00:05:11,220
false detection or a positive condition

127
00:05:11,220 --> 00:05:13,380
or a negative condition and those are

128
00:05:13,380 --> 00:05:15,060
usually the verdicts that that things

129
00:05:15,060 --> 00:05:16,979
get assigned and so of course a true

130
00:05:16,979 --> 00:05:18,960
positive is correctly classifying

131
00:05:18,960 --> 00:05:21,479
malicious activity is malicious in a

132
00:05:21,479 --> 00:05:23,160
perfect world you would only ever have

133
00:05:23,160 --> 00:05:25,259
alerts on true positives that's not

134
00:05:25,259 --> 00:05:28,740
realistic but that's the Target and the

135
00:05:28,740 --> 00:05:30,720
closer you can get to that the better

136
00:05:30,720 --> 00:05:33,360
it's going to be false positive is

137
00:05:33,360 --> 00:05:35,699
incorrectly classifying benign activity

138
00:05:35,699 --> 00:05:38,460
as malicious I have a good friend Micah

139
00:05:38,460 --> 00:05:40,740
Brown who likes to say all the time

140
00:05:40,740 --> 00:05:42,840
there are no such things as false

141
00:05:42,840 --> 00:05:45,479
positives only poorly written rules and

142
00:05:45,479 --> 00:05:47,400
there's some truth to that

143
00:05:47,400 --> 00:05:49,680
um and so false positives are those

144
00:05:49,680 --> 00:05:51,120
things that will give you alert fatigue

145
00:05:51,120 --> 00:05:53,039
you want to try to eliminate as many of

146
00:05:53,039 --> 00:05:55,680
those environment is possible again you

147
00:05:55,680 --> 00:05:57,360
can't ever get to that perfect state but

148
00:05:57,360 --> 00:06:00,479
the closer you can get to it the better

149
00:06:00,479 --> 00:06:02,460
it's going to be the easier to raise job

150
00:06:02,460 --> 00:06:05,000
gets true negative is correctly

151
00:06:05,000 --> 00:06:07,620
classifying benign activity is benign

152
00:06:07,620 --> 00:06:09,600
that's really just the stuff you ignore

153
00:06:09,600 --> 00:06:12,300
because it's legitimate it's business as

154
00:06:12,300 --> 00:06:15,960
usual uh false negative is probably the

155
00:06:15,960 --> 00:06:18,060
worst thing it's incorrectly classifying

156
00:06:18,060 --> 00:06:19,979
malicious activity as benign that's

157
00:06:19,979 --> 00:06:21,660
something that was missed that was

158
00:06:21,660 --> 00:06:23,819
actually going wrong within an

159
00:06:23,819 --> 00:06:25,800
environment so I put together this table

160
00:06:25,800 --> 00:06:27,539
just to make sure everybody understands

161
00:06:27,539 --> 00:06:30,539
what those dispositions are and so I

162
00:06:30,539 --> 00:06:32,699
want to spend some time talking about OS

163
00:06:32,699 --> 00:06:36,479
Basics and so understanding you know

164
00:06:36,479 --> 00:06:38,520
processes services or demons and their

165
00:06:38,520 --> 00:06:40,919
impacts on CPU and memory utilization

166
00:06:40,919 --> 00:06:43,680
can be pretty darn important and so I'm

167
00:06:43,680 --> 00:06:45,180
going to talk a bit about Windows and

168
00:06:45,180 --> 00:06:47,819
Linux throughout this talk so within

169
00:06:47,819 --> 00:06:49,440
Windows you of course have the task

170
00:06:49,440 --> 00:06:52,199
manager and you also have the services

171
00:06:52,199 --> 00:06:55,199
console that'll show you what's running

172
00:06:55,199 --> 00:06:57,500
on a system it'll show you services

173
00:06:57,500 --> 00:07:00,600
that are started they're stopped they're

174
00:07:00,600 --> 00:07:02,759
configured whether they start up

175
00:07:02,759 --> 00:07:04,919
automatically or sort of get kicked off

176
00:07:04,919 --> 00:07:07,919
on demand within Linux you have the PS

177
00:07:07,919 --> 00:07:09,419
command which will show you what's

178
00:07:09,419 --> 00:07:13,199
running on a host you also have top and

179
00:07:13,199 --> 00:07:15,360
h-top if it's available in the host

180
00:07:15,360 --> 00:07:18,300
h-stop is a little prettier to look at I

181
00:07:18,300 --> 00:07:20,340
like it but if it's not there you can

182
00:07:20,340 --> 00:07:22,800
only see if top is available that shows

183
00:07:22,800 --> 00:07:24,660
you not just what's running but it also

184
00:07:24,660 --> 00:07:26,580
shows you the things are eating up the

185
00:07:26,580 --> 00:07:28,380
most memory the things are eating up the

186
00:07:28,380 --> 00:07:30,780
most CPU because those are things that

187
00:07:30,780 --> 00:07:32,280
might be worth digging into a little

188
00:07:32,280 --> 00:07:33,660
further when you're doing incident

189
00:07:33,660 --> 00:07:35,759
response

190
00:07:35,759 --> 00:07:37,680
um file system Basics knowing where

191
00:07:37,680 --> 00:07:39,840
things are supposed to be located on an

192
00:07:39,840 --> 00:07:41,759
endpoint is vitally important to

193
00:07:41,759 --> 00:07:44,340
incident response conversely knowing

194
00:07:44,340 --> 00:07:47,880
where things shouldn't be but R is also

195
00:07:47,880 --> 00:07:50,520
really important but it requires a

196
00:07:50,520 --> 00:07:52,680
working level of knowledge of the

197
00:07:52,680 --> 00:07:54,960
Windows File system the Linux file

198
00:07:54,960 --> 00:07:57,840
system and if your environment includes

199
00:07:57,840 --> 00:08:00,840
Mac OS you know potentially needing to

200
00:08:00,840 --> 00:08:03,000
understand that depending how prevalent

201
00:08:03,000 --> 00:08:05,240
that is in your environment

202
00:08:05,240 --> 00:08:07,500
so understanding where the user

203
00:08:07,500 --> 00:08:10,440
directory is on an endpoint it's sort of

204
00:08:10,440 --> 00:08:12,599
shocking to me that the people that you

205
00:08:12,599 --> 00:08:14,819
talk to that are fairly seasoned and

206
00:08:14,819 --> 00:08:17,280
they can't just name these off but on a

207
00:08:17,280 --> 00:08:19,020
Windows endpoint you have typically your

208
00:08:19,020 --> 00:08:21,060
C drive your system root and you have

209
00:08:21,060 --> 00:08:23,940
users and whatever the login username is

210
00:08:23,940 --> 00:08:26,639
and there's also an environment variable

211
00:08:26,639 --> 00:08:28,639
if you do percent user profile percent

212
00:08:28,639 --> 00:08:32,099
it'll also get you straight there on

213
00:08:32,099 --> 00:08:34,200
Linux you're typically having a slash

214
00:08:34,200 --> 00:08:37,860
home slash and the username folder and

215
00:08:37,860 --> 00:08:39,240
again there are things that you

216
00:08:39,240 --> 00:08:40,799
shouldn't see system things running

217
00:08:40,799 --> 00:08:44,219
typically from the users folder if you

218
00:08:44,219 --> 00:08:46,860
do see that it might be legit it might

219
00:08:46,860 --> 00:08:48,899
be very suspicious and worth looking

220
00:08:48,899 --> 00:08:51,140
into at the at the very least

221
00:08:51,140 --> 00:08:54,540
so file system Basics on Windows most

222
00:08:54,540 --> 00:08:56,940
configuration settings are not all of

223
00:08:56,940 --> 00:08:59,040
them but most of them are stored within

224
00:08:59,040 --> 00:09:01,440
the Windows registry and the registry

225
00:09:01,440 --> 00:09:03,240
when you look at it it's just one big

226
00:09:03,240 --> 00:09:05,580
long list realistically though the

227
00:09:05,580 --> 00:09:08,459
registry is comp or comprised of

228
00:09:08,459 --> 00:09:11,040
different hives different sections that

229
00:09:11,040 --> 00:09:14,100
when you fire up reg edit it'll you know

230
00:09:14,100 --> 00:09:16,200
sort of present that as one list but you

231
00:09:16,200 --> 00:09:19,320
have each key local machine software HP

232
00:09:19,320 --> 00:09:22,080
local machine system HD local machine

233
00:09:22,080 --> 00:09:24,300
Sam which is you know were the

234
00:09:24,300 --> 00:09:26,519
credentials uh hkey local machine

235
00:09:26,519 --> 00:09:30,120
security and then hkey users default HP

236
00:09:30,120 --> 00:09:32,820
current config and understanding where

237
00:09:32,820 --> 00:09:35,339
those files are at on a system can be

238
00:09:35,339 --> 00:09:37,860
important so typically under the system

239
00:09:37,860 --> 00:09:41,040
root which is usually see windows then

240
00:09:41,040 --> 00:09:44,040
the system 32 config folder is where you

241
00:09:44,040 --> 00:09:46,620
can find the high files and sometimes

242
00:09:46,620 --> 00:09:49,680
you want to grab those by default

243
00:09:49,680 --> 00:09:52,440
it's usually backed up and so unless

244
00:09:52,440 --> 00:09:54,660
you're using forensic tools on a running

245
00:09:54,660 --> 00:09:57,839
system it can sometimes be hard to grab

246
00:09:57,839 --> 00:10:00,420
the specific Hive files what you can do

247
00:10:00,420 --> 00:10:02,700
is you can look in the if it's there the

248
00:10:02,700 --> 00:10:06,420
slash reg back folder and so oftentimes

249
00:10:06,420 --> 00:10:08,160
it's easier to grab things out of the

250
00:10:08,160 --> 00:10:11,060
reg back folder and analyze them offline

251
00:10:11,060 --> 00:10:13,260
than it is the retrieve them on a live

252
00:10:13,260 --> 00:10:16,860
system another sort of pro tip there is

253
00:10:16,860 --> 00:10:19,019
you can compare what's in the running

254
00:10:19,019 --> 00:10:21,779
Windows registry with maybe a point in

255
00:10:21,779 --> 00:10:25,440
time backup and see what's changed and

256
00:10:25,440 --> 00:10:27,060
that can be really helpful when you're

257
00:10:27,060 --> 00:10:29,339
investigating something to understand

258
00:10:29,339 --> 00:10:31,620
how it looked before how it looks now

259
00:10:31,620 --> 00:10:33,660
and if you can find those little red

260
00:10:33,660 --> 00:10:37,320
line diff uh items where things are have

261
00:10:37,320 --> 00:10:40,560
changed those can be some you know

262
00:10:40,560 --> 00:10:43,019
potential keys to maybe helping identify

263
00:10:43,019 --> 00:10:44,880
what's happened and then under the

264
00:10:44,880 --> 00:10:47,060
user's profile folder you have the

265
00:10:47,060 --> 00:10:50,180
ntuser.dat and typically you can use

266
00:10:50,180 --> 00:10:54,019
regedit.exe old school reg

267
00:10:54,019 --> 00:10:56,399
edt32.exe which now is just a pointer

268
00:10:56,399 --> 00:10:57,440
back to

269
00:10:57,440 --> 00:11:00,360
regedit.exe and then also third-party

270
00:11:00,360 --> 00:11:03,000
tools forensic tools will also help you

271
00:11:03,000 --> 00:11:04,880
with those things

272
00:11:04,880 --> 00:11:07,079
understanding some file system basics

273
00:11:07,079 --> 00:11:09,899
for Linux most configuration files are

274
00:11:09,899 --> 00:11:12,959
stored under the slash Etsy folder uh

275
00:11:12,959 --> 00:11:16,680
you know or subdirectories within slash

276
00:11:16,680 --> 00:11:19,560
Etsy directory noteworthy files there

277
00:11:19,560 --> 00:11:22,440
and this is nothing in the stocks an

278
00:11:22,440 --> 00:11:25,440
all-inclusive list but past WD basically

279
00:11:25,440 --> 00:11:27,120
has all the user accounts and it's

280
00:11:27,120 --> 00:11:31,140
usually universally readable uh file the

281
00:11:31,140 --> 00:11:34,440
shadow file which has really the salt

282
00:11:34,440 --> 00:11:37,079
and the hashes and that's really where

283
00:11:37,079 --> 00:11:40,200
the password hashes live on a system

284
00:11:40,200 --> 00:11:42,779
those are very juicy targets for threat

285
00:11:42,779 --> 00:11:44,880
actors they will often try to get those

286
00:11:44,880 --> 00:11:47,399
two files in particular if they get a

287
00:11:47,399 --> 00:11:48,899
hold of the Shadow file they can then

288
00:11:48,899 --> 00:11:52,440
attempt to do password cracking offline

289
00:11:52,440 --> 00:11:54,420
password cracking so you'll never see

290
00:11:54,420 --> 00:11:57,540
that stuff in logs if you're not

291
00:11:57,540 --> 00:12:01,200
familiar with the Linux Foundation they

292
00:12:01,200 --> 00:12:03,360
have a file system hierarchy standard

293
00:12:03,360 --> 00:12:07,320
FHS it's a great reference it tells you

294
00:12:07,320 --> 00:12:09,600
really what directories are on a Linux

295
00:12:09,600 --> 00:12:12,560
host and why they exist in those places

296
00:12:12,560 --> 00:12:15,360
so if you don't have a lot of intimate

297
00:12:15,360 --> 00:12:17,360
knowledge or familiarity with Linux

298
00:12:17,360 --> 00:12:20,160
peruse that it'll tell you again what

299
00:12:20,160 --> 00:12:22,680
directories why they're there it can

300
00:12:22,680 --> 00:12:24,839
really help you understand what's

301
00:12:24,839 --> 00:12:28,079
happening so I want to talk about logs

302
00:12:28,079 --> 00:12:30,420
and pcaps because really the Bedrock of

303
00:12:30,420 --> 00:12:33,000
any security investigation begins with

304
00:12:33,000 --> 00:12:35,880
the available logs you have and packet

305
00:12:35,880 --> 00:12:37,860
capture data

306
00:12:37,860 --> 00:12:39,120
so

307
00:12:39,120 --> 00:12:41,220
what about the Sim well Sims are great

308
00:12:41,220 --> 00:12:43,380
uh while centralized logging is

309
00:12:43,380 --> 00:12:45,800
incredibly important they aren't perfect

310
00:12:45,800 --> 00:12:48,540
often due to Resource constraints and

311
00:12:48,540 --> 00:12:52,019
either bad or missing inputs Sims are

312
00:12:52,019 --> 00:12:53,880
often only configured to capture

313
00:12:53,880 --> 00:12:57,480
specific events or event types important

314
00:12:57,480 --> 00:13:00,180
details might be tuned out filtered out

315
00:13:00,180 --> 00:13:03,260
or simply parsed incorrectly

316
00:13:03,260 --> 00:13:06,420
input sources can become broken also

317
00:13:06,420 --> 00:13:08,700
Sims use a lot of system resources

318
00:13:08,700 --> 00:13:10,860
typically and sometimes you can have

319
00:13:10,860 --> 00:13:12,959
automated searches correlation searches

320
00:13:12,959 --> 00:13:14,880
they just get skipped because the Sim

321
00:13:14,880 --> 00:13:16,500
literally doesn't have enough resources

322
00:13:16,500 --> 00:13:19,139
to process everything so that's why you

323
00:13:19,139 --> 00:13:20,820
can't depend a hundred percent on your

324
00:13:20,820 --> 00:13:22,740
sim having everything even if you think

325
00:13:22,740 --> 00:13:24,420
it might

326
00:13:24,420 --> 00:13:26,700
um Native logs understanding where logs

327
00:13:26,700 --> 00:13:28,680
exist on various endpoints is really

328
00:13:28,680 --> 00:13:30,899
important uh even if you think they're

329
00:13:30,899 --> 00:13:32,940
feeding into the Sim because again you

330
00:13:32,940 --> 00:13:34,680
want to double check those things or if

331
00:13:34,680 --> 00:13:36,660
it's missing from the Sim you need to

332
00:13:36,660 --> 00:13:38,639
know where to retrieve those uh so we're

333
00:13:38,639 --> 00:13:39,959
going to talk about those for Windows

334
00:13:39,959 --> 00:13:42,899
Linux also just server logs in general

335
00:13:42,899 --> 00:13:45,420
and application logs and just some

336
00:13:45,420 --> 00:13:48,240
little potential gotchas Windows logs

337
00:13:48,240 --> 00:13:50,579
there are like four primary Windows logs

338
00:13:50,579 --> 00:13:53,160
that have been around forever and the

339
00:13:53,160 --> 00:13:55,019
base Windows logs are application

340
00:13:55,019 --> 00:13:59,459
security setup and system they event

341
00:13:59,459 --> 00:14:02,399
exist as there's a lot more now if

342
00:14:02,399 --> 00:14:05,220
they're enabled but they exist as.evtx

343
00:14:05,220 --> 00:14:08,700
files under system 32 usually see

344
00:14:08,700 --> 00:14:12,420
Windows system 32 when EVT logs on

345
00:14:12,420 --> 00:14:14,519
Modern versions of Windows and they can

346
00:14:14,519 --> 00:14:17,040
be open using the Windows Event Viewer

347
00:14:17,040 --> 00:14:19,019
including some other third-party

348
00:14:19,019 --> 00:14:21,720
forensic tools things like that but

349
00:14:21,720 --> 00:14:23,700
Windows log knowledge

350
00:14:23,700 --> 00:14:25,980
I don't have time because of the the

351
00:14:25,980 --> 00:14:28,380
breadth of this talk to go into like

352
00:14:28,380 --> 00:14:31,019
specific event IDs but understand that

353
00:14:31,019 --> 00:14:32,880
Windows logs things using different

354
00:14:32,880 --> 00:14:35,519
event ID numbers which have different

355
00:14:35,519 --> 00:14:38,579
significances uh and so there's a link

356
00:14:38,579 --> 00:14:41,399
here again if you get the slides uh you

357
00:14:41,399 --> 00:14:44,160
can have this these are the particular

358
00:14:44,160 --> 00:14:47,040
event IDs that Microsoft says is

359
00:14:47,040 --> 00:14:49,500
important now Microsoft

360
00:14:49,500 --> 00:14:51,839
they created the OS if they say these

361
00:14:51,839 --> 00:14:53,480
are the important events to monitor

362
00:14:53,480 --> 00:14:57,240
probably worth monitoring and then also

363
00:14:57,240 --> 00:14:59,899
when you're looking at log on attempts

364
00:14:59,899 --> 00:15:02,339
understand that Windows has different

365
00:15:02,339 --> 00:15:04,800
logon types depending on whether it was

366
00:15:04,800 --> 00:15:07,440
an interactive logon at the console or

367
00:15:07,440 --> 00:15:09,360
somebody's trying to use remote desktop

368
00:15:09,360 --> 00:15:12,000
to log into a system and so just

369
00:15:12,000 --> 00:15:13,740
understanding the different logon type

370
00:15:13,740 --> 00:15:15,480
conditions and again here's another

371
00:15:15,480 --> 00:15:17,820
Microsoft resource that explains what

372
00:15:17,820 --> 00:15:20,339
those are but if nothing else just know

373
00:15:20,339 --> 00:15:22,320
that you know different logons have

374
00:15:22,320 --> 00:15:24,720
different logon types and you can always

375
00:15:24,720 --> 00:15:27,720
look those up Linux logs most of the

376
00:15:27,720 --> 00:15:30,120
Linux logs they exist under the slash

377
00:15:30,120 --> 00:15:34,079
bar log folder one quick example is

378
00:15:34,079 --> 00:15:37,620
slash VAR slash log slash syslog and

379
00:15:37,620 --> 00:15:39,300
logs on a Linux host are typically

380
00:15:39,300 --> 00:15:42,240
viewable using whatever text editor you

381
00:15:42,240 --> 00:15:45,600
want it can also use the cat command the

382
00:15:45,600 --> 00:15:48,660
more command I like piping things in the

383
00:15:48,660 --> 00:15:50,160
less because then I can can search

384
00:15:50,160 --> 00:15:52,380
through them I can arrow through them

385
00:15:52,380 --> 00:15:56,279
very helpful and then the head command

386
00:15:56,279 --> 00:15:57,899
will give you the first X number of

387
00:15:57,899 --> 00:16:01,320
lines of a particular file can be

388
00:16:01,320 --> 00:16:04,139
important sometimes the tail command is

389
00:16:04,139 --> 00:16:05,820
the opposite of that it'll give you the

390
00:16:05,820 --> 00:16:09,180
last X number of lines and tail has a

391
00:16:09,180 --> 00:16:11,940
nice option Dash F that'll live follow a

392
00:16:11,940 --> 00:16:14,339
log file so you can see what's happening

393
00:16:14,339 --> 00:16:17,639
in logs real time on your terminal using

394
00:16:17,639 --> 00:16:21,420
tail Dash F really really helpful

395
00:16:21,420 --> 00:16:24,060
um Linux log knowledge while many Linux

396
00:16:24,060 --> 00:16:26,100
logs are times well they're time stamped

397
00:16:26,100 --> 00:16:28,800
in Epoch time so they are human readable

398
00:16:28,800 --> 00:16:31,019
but it's really just a numeric string

399
00:16:31,019 --> 00:16:32,519
that doesn't make a whole lot of sense

400
00:16:32,519 --> 00:16:34,980
when you're looking at it what Epoch

401
00:16:34,980 --> 00:16:37,680
time means is the Unix operating system

402
00:16:37,680 --> 00:16:41,820
came into existence in 1970 so the epoch

403
00:16:41,820 --> 00:16:46,079
or birth of Linux is 1970 so really all

404
00:16:46,079 --> 00:16:47,880
of those time stamps are in relation to

405
00:16:47,880 --> 00:16:51,720
January 1st of 1970 and so while they're

406
00:16:51,720 --> 00:16:53,639
human readable again not understandable

407
00:16:53,639 --> 00:16:57,060
but you can use various converters and

408
00:16:57,060 --> 00:16:58,740
I'm going to touch on like cyber chef

409
00:16:58,740 --> 00:17:00,480
but there's online ones there's a lot of

410
00:17:00,480 --> 00:17:03,600
different ways to do it but use those to

411
00:17:03,600 --> 00:17:05,839
convert them into a human readable time

412
00:17:05,839 --> 00:17:08,880
also when you're looking at time stamps

413
00:17:08,880 --> 00:17:09,859
understand

414
00:17:09,859 --> 00:17:12,919
what time zone things are logging in

415
00:17:12,919 --> 00:17:17,040
because it might be local time it might

416
00:17:17,040 --> 00:17:19,199
be you may have an offset depending on

417
00:17:19,199 --> 00:17:20,819
daylight savings

418
00:17:20,819 --> 00:17:23,280
and understand if something's in a

419
00:17:23,280 --> 00:17:24,959
different time zone it might be logging

420
00:17:24,959 --> 00:17:27,660
in a different time there if you're

421
00:17:27,660 --> 00:17:30,000
small enough maybe local time logging

422
00:17:30,000 --> 00:17:32,580
makes the most sense uh if you're you

423
00:17:32,580 --> 00:17:34,380
know very specific location but if

424
00:17:34,380 --> 00:17:36,960
you're across the country organization

425
00:17:36,960 --> 00:17:40,020
or International uh anything you can do

426
00:17:40,020 --> 00:17:43,140
in GMT slash UTC time is incredibly

427
00:17:43,140 --> 00:17:44,760
helpful because then you have one common

428
00:17:44,760 --> 00:17:47,280
time stamp but really timelining and

429
00:17:47,280 --> 00:17:49,559
time stamping activities and and

430
00:17:49,559 --> 00:17:51,299
understanding those events really is

431
00:17:51,299 --> 00:17:53,580
crucial to incident response

432
00:17:53,580 --> 00:17:56,520
investigation so know that you might be

433
00:17:56,520 --> 00:17:58,080
looking at this time here but you need

434
00:17:58,080 --> 00:18:00,600
to adjust the number of hours depending

435
00:18:00,600 --> 00:18:02,400
where those came from and how things

436
00:18:02,400 --> 00:18:04,500
were configured

437
00:18:04,500 --> 00:18:06,539
um server logs be aware that various

438
00:18:06,539 --> 00:18:08,760
server applications might store their

439
00:18:08,760 --> 00:18:11,280
own logs independently the host os's

440
00:18:11,280 --> 00:18:14,520
native logging uh and default log paths

441
00:18:14,520 --> 00:18:16,919
and names can also be configured so they

442
00:18:16,919 --> 00:18:20,160
can be changed on a host potentially by

443
00:18:20,160 --> 00:18:22,679
default just one example

444
00:18:22,679 --> 00:18:24,960
Windows IIs server logs are typically

445
00:18:24,960 --> 00:18:28,380
stored under numbered W3 SVC folders

446
00:18:28,380 --> 00:18:31,400
under the C

447
00:18:31,400 --> 00:18:34,860
inet Pub logs log files but again that's

448
00:18:34,860 --> 00:18:37,740
configurable it might be C on one host

449
00:18:37,740 --> 00:18:40,320
well that might be the d e or F drive on

450
00:18:40,320 --> 00:18:42,179
a different host depending how the web

451
00:18:42,179 --> 00:18:43,760
server is configured so again

452
00:18:43,760 --> 00:18:45,539
understanding these things can be

453
00:18:45,539 --> 00:18:47,160
changed it's not necessarily give you

454
00:18:47,160 --> 00:18:51,120
one stationary place every time but you

455
00:18:51,120 --> 00:18:52,740
know that is something that doesn't show

456
00:18:52,740 --> 00:18:54,600
up in Event Viewer those are logs you

457
00:18:54,600 --> 00:18:56,880
have to look at independently

458
00:18:56,880 --> 00:18:59,580
application logs sort of the same kind

459
00:18:59,580 --> 00:19:01,500
of thing be aware that various

460
00:19:01,500 --> 00:19:03,539
applications might store their own logs

461
00:19:03,539 --> 00:19:05,520
independent of the host os's native

462
00:19:05,520 --> 00:19:07,860
logging sometimes things will log into

463
00:19:07,860 --> 00:19:09,600
Event Viewer sometimes they have their

464
00:19:09,600 --> 00:19:12,240
own log files and again just understand

465
00:19:12,240 --> 00:19:15,179
those paths the file names all those

466
00:19:15,179 --> 00:19:17,760
things can be potentially changed you

467
00:19:17,760 --> 00:19:18,960
know depending what the application

468
00:19:18,960 --> 00:19:21,780
supports and then you also have

469
00:19:21,780 --> 00:19:24,720
situations where some log files might

470
00:19:24,720 --> 00:19:28,320
reside on the endpoint itself some of

471
00:19:28,320 --> 00:19:30,299
them might reside in a central console

472
00:19:30,299 --> 00:19:33,419
somewhere else and sometimes like for

473
00:19:33,419 --> 00:19:35,880
example antivirus will typically log in

474
00:19:35,880 --> 00:19:37,740
both places you'll have logs on the

475
00:19:37,740 --> 00:19:40,080
local endpoint and you'll have logs in

476
00:19:40,080 --> 00:19:42,900
the central console so sometimes both of

477
00:19:42,900 --> 00:19:45,419
those conditions are true

478
00:19:45,419 --> 00:19:47,220
um networking Basics I don't have time

479
00:19:47,220 --> 00:19:49,620
to dig too deep in here but uh just

480
00:19:49,620 --> 00:19:51,600
understand the difference between the

481
00:19:51,600 --> 00:19:54,660
TCP three-way handshake and UDP

482
00:19:54,660 --> 00:19:56,880
connectionless protocols and those are

483
00:19:56,880 --> 00:19:57,960
going to look different when you're

484
00:19:57,960 --> 00:20:00,600
looking at them and packets

485
00:20:00,600 --> 00:20:03,240
um this is just a very short list but

486
00:20:03,240 --> 00:20:05,580
understanding the common TCP and UDP

487
00:20:05,580 --> 00:20:06,960
port numbers because you're going to be

488
00:20:06,960 --> 00:20:08,820
seeing those things in logs all the time

489
00:20:08,820 --> 00:20:10,559
you're going to see those in packet

490
00:20:10,559 --> 00:20:14,059
capture data and so you know for example

491
00:20:14,059 --> 00:20:17,700
TCP 22 is typically SSH and a lot of

492
00:20:17,700 --> 00:20:20,400
other secure protocols will will also

493
00:20:20,400 --> 00:20:24,840
leverage that 80 would be HTTP HEBs is

494
00:20:24,840 --> 00:20:26,539
going to be 443

495
00:20:26,539 --> 00:20:29,340
445 if you're looking at net bios in a

496
00:20:29,340 --> 00:20:30,919
Windows environment

497
00:20:30,919 --> 00:20:34,820
3389 is remote desktop protocol RDP

498
00:20:34,820 --> 00:20:36,960
typically something you would see in a

499
00:20:36,960 --> 00:20:39,539
Windows environment and then just one

500
00:20:39,539 --> 00:20:42,780
quick example UDP 53 is typically DNS

501
00:20:42,780 --> 00:20:45,059
traffic so

502
00:20:45,059 --> 00:20:46,799
I don't have time to dig into all of

503
00:20:46,799 --> 00:20:48,840
these but there's a great resource on

504
00:20:48,840 --> 00:20:52,440
from packet life on the common ports so

505
00:20:52,440 --> 00:20:54,360
highly recommend checking that out and

506
00:20:54,360 --> 00:20:56,940
just being familiar again with the most

507
00:20:56,940 --> 00:20:59,160
popular ones you're likely to see within

508
00:20:59,160 --> 00:21:00,840
an environment it can kind of help you

509
00:21:00,840 --> 00:21:03,240
identify if some of these Port scanning

510
00:21:03,240 --> 00:21:05,760
if they're launching attack those kind

511
00:21:05,760 --> 00:21:08,460
of things and also what I encourage

512
00:21:08,460 --> 00:21:09,900
folks is if you haven't messed around

513
00:21:09,900 --> 00:21:12,299
with nmap mess mess around with nmap and

514
00:21:12,299 --> 00:21:14,220
do some Port scanning it'll really help

515
00:21:14,220 --> 00:21:16,200
further your knowledge and you'll start

516
00:21:16,200 --> 00:21:19,320
seeing how things get identified from

517
00:21:19,320 --> 00:21:22,200
the outside perspective incredibly

518
00:21:22,200 --> 00:21:24,120
helpful

519
00:21:24,120 --> 00:21:26,340
um and networking packets so being able

520
00:21:26,340 --> 00:21:29,280
to analyze Network traffic data is

521
00:21:29,280 --> 00:21:30,960
really important incident response skill

522
00:21:30,960 --> 00:21:33,900
learning how to create save analyze

523
00:21:33,900 --> 00:21:37,220
packet capture files or pcaps

524
00:21:37,220 --> 00:21:40,440
is incredibly helpful and so this is

525
00:21:40,440 --> 00:21:42,120
again not all-inclusive lists but

526
00:21:42,120 --> 00:21:45,539
Wireshark is one I use all the time

527
00:21:45,539 --> 00:21:47,820
t-shark is basically a terminal version

528
00:21:47,820 --> 00:21:51,059
of that you've got the classic TCP dump

529
00:21:51,059 --> 00:21:53,039
that's been around forever wind dump

530
00:21:53,039 --> 00:21:54,600
there's a whole bunch of other ones

531
00:21:54,600 --> 00:21:58,200
that's just the name a quick view and I

532
00:21:58,200 --> 00:21:59,760
actually have put together a Wireshark

533
00:21:59,760 --> 00:22:02,760
Workshop it's a two hour Workshop you

534
00:22:02,760 --> 00:22:04,980
can basically download as a very small

535
00:22:04,980 --> 00:22:08,340
zip file extract it out I wrote the lab

536
00:22:08,340 --> 00:22:11,179
guide It's the txt file inside of there

537
00:22:11,179 --> 00:22:13,500
so if you don't have familiarity with

538
00:22:13,500 --> 00:22:17,760
Wireshark download the uh the lab and

539
00:22:17,760 --> 00:22:20,039
the literally the guide will step you

540
00:22:20,039 --> 00:22:22,380
through step by step by step every step

541
00:22:22,380 --> 00:22:25,020
of the way absolutely free just go out

542
00:22:25,020 --> 00:22:27,000
there and again it's on my GitHub repo

543
00:22:27,000 --> 00:22:30,059
and uh you know have at it share it with

544
00:22:30,059 --> 00:22:32,880
friends if somebody is trying to learn

545
00:22:32,880 --> 00:22:35,159
um in an ideal situation you would

546
00:22:35,159 --> 00:22:37,440
always have decrypted packets that's not

547
00:22:37,440 --> 00:22:40,860
always feasible you may not have that

548
00:22:40,860 --> 00:22:43,260
um and when you look at things like

549
00:22:43,260 --> 00:22:45,780
across a large Enterprise

550
00:22:45,780 --> 00:22:47,940
um if you're fortunate you may have a

551
00:22:47,940 --> 00:22:49,740
solution like a gigamon or something

552
00:22:49,740 --> 00:22:52,919
like that that will do that it's very

553
00:22:52,919 --> 00:22:54,780
very expensive unless you're a huge

554
00:22:54,780 --> 00:22:57,840
organization with a nice big budget may

555
00:22:57,840 --> 00:22:59,820
not have a tool like that so it may not

556
00:22:59,820 --> 00:23:02,460
be feasible but if you have it you know

557
00:23:02,460 --> 00:23:04,500
if you have them decrypted to another

558
00:23:04,500 --> 00:23:08,039
solution that's fantastic

559
00:23:08,039 --> 00:23:11,280
um OAS pop 10 just being familiar with

560
00:23:11,280 --> 00:23:14,159
this it's really a standard awareness

561
00:23:14,159 --> 00:23:16,500
document for developers in web

562
00:23:16,500 --> 00:23:19,260
application security it represents a

563
00:23:19,260 --> 00:23:21,240
broad consensus about the most critical

564
00:23:21,240 --> 00:23:24,120
security risk the web applications and

565
00:23:24,120 --> 00:23:25,620
really the intention of this thing it

566
00:23:25,620 --> 00:23:28,140
gets updated every like three or four

567
00:23:28,140 --> 00:23:30,000
years typically

568
00:23:30,000 --> 00:23:33,059
um it sort of tells you as a Defender

569
00:23:33,059 --> 00:23:34,980
like if you're going to secure your web

570
00:23:34,980 --> 00:23:36,600
application start with these things

571
00:23:36,600 --> 00:23:38,820
first they're the most important it's

572
00:23:38,820 --> 00:23:40,740
again not all-inclusive lists it's not

573
00:23:40,740 --> 00:23:42,480
intended to be that it's really just to

574
00:23:42,480 --> 00:23:44,580
help people prioritize what they want to

575
00:23:44,580 --> 00:23:46,260
do but there's a wealth of information

576
00:23:46,260 --> 00:23:49,200
because it'll tell you what those things

577
00:23:49,200 --> 00:23:52,380
are it'll talk through the attacks and

578
00:23:52,380 --> 00:23:54,179
how things are potentially exploited

579
00:23:54,179 --> 00:23:56,400
vulnerabilities how to mitigate those

580
00:23:56,400 --> 00:23:59,039
things be familiar with the things on

581
00:23:59,039 --> 00:24:01,500
that list because if somebody's trying

582
00:24:01,500 --> 00:24:04,140
to attack your infrastructure and it's

583
00:24:04,140 --> 00:24:06,780
web stuff you know web applications web

584
00:24:06,780 --> 00:24:07,820
pages

585
00:24:07,820 --> 00:24:10,500
chances are most of the attacks you're

586
00:24:10,500 --> 00:24:12,120
going to see are part of the owas top

587
00:24:12,120 --> 00:24:14,460
10.

588
00:24:14,460 --> 00:24:15,900
um understanding web requests

589
00:24:15,900 --> 00:24:18,179
particularly you're looking at log files

590
00:24:18,179 --> 00:24:20,880
so the most common HTTP request methods

591
00:24:20,880 --> 00:24:24,059
are going to be get head post and

592
00:24:24,059 --> 00:24:24,860
connect

593
00:24:24,860 --> 00:24:27,299
potentially concerning HTTP request

594
00:24:27,299 --> 00:24:30,240
methods are like put and delete now you

595
00:24:30,240 --> 00:24:31,559
have to understand what you're looking

596
00:24:31,559 --> 00:24:35,220
at if I have a website that with a photo

597
00:24:35,220 --> 00:24:38,760
bucket sharing feature for example it

598
00:24:38,760 --> 00:24:40,380
might be common practice to see me

599
00:24:40,380 --> 00:24:43,799
putting multiple files on there and also

600
00:24:43,799 --> 00:24:46,620
deleting multiple files at once but if I

601
00:24:46,620 --> 00:24:49,260
start seeing those commands for a

602
00:24:49,260 --> 00:24:51,000
contact form

603
00:24:51,000 --> 00:24:53,340
that's not quite right that tells me

604
00:24:53,340 --> 00:24:55,400
something somebody's looking at

605
00:24:55,400 --> 00:24:58,260
exploiting something here and so some of

606
00:24:58,260 --> 00:25:00,600
the other ones you'll see that are other

607
00:25:00,600 --> 00:25:04,020
methods or like options trace and patch

608
00:25:04,020 --> 00:25:07,500
uh understanding HTTP response codes is

609
00:25:07,500 --> 00:25:09,900
really important so uh I'm just going to

610
00:25:09,900 --> 00:25:12,600
go through what the series are so 200

611
00:25:12,600 --> 00:25:15,539
series responses are basically okay that

612
00:25:15,539 --> 00:25:19,140
means the server recognizes the request

613
00:25:19,140 --> 00:25:21,299
the results may or may not be what you

614
00:25:21,299 --> 00:25:23,400
expect though just because the server

615
00:25:23,400 --> 00:25:26,340
gives you an okay doesn't mean that the

616
00:25:26,340 --> 00:25:29,760
request was actually executed on the

617
00:25:29,760 --> 00:25:31,440
server that's just something that you

618
00:25:31,440 --> 00:25:33,000
potentially have to dig further in

619
00:25:33,000 --> 00:25:35,880
understand did this actually happen or

620
00:25:35,880 --> 00:25:38,279
did nothing happen but those are

621
00:25:38,279 --> 00:25:40,260
typically the ones you want to look at a

622
00:25:40,260 --> 00:25:43,440
lot 300 series response codes are always

623
00:25:43,440 --> 00:25:45,840
going to be redirect so 301s are

624
00:25:45,840 --> 00:25:48,900
permanent redirects on the web 302 is

625
00:25:48,900 --> 00:25:51,360
your temporary redirects just

626
00:25:51,360 --> 00:25:53,340
understanding the 100 Series in these is

627
00:25:53,340 --> 00:25:55,380
incredibly helpful unless you're using a

628
00:25:55,380 --> 00:25:58,620
deprecated version of HTTP uh that

629
00:25:58,620 --> 00:25:59,760
protocol you're probably not going to

630
00:25:59,760 --> 00:26:01,440
see 100s which were just kind of

631
00:26:01,440 --> 00:26:03,600
informational I haven't seen those and I

632
00:26:03,600 --> 00:26:05,279
couldn't tell you how long it's been a

633
00:26:05,279 --> 00:26:09,240
many many years uh 400 series responses

634
00:26:09,240 --> 00:26:11,880
are a client error response so that

635
00:26:11,880 --> 00:26:15,120
means that the server gets a request and

636
00:26:15,120 --> 00:26:18,299
it makes no sense and so like a classic

637
00:26:18,299 --> 00:26:22,500
404 is a not found error and that's in

638
00:26:22,500 --> 00:26:24,840
that 400 series and there's a number of

639
00:26:24,840 --> 00:26:26,400
things that could cause that it could be

640
00:26:26,400 --> 00:26:29,159
somebody basically crawling the website

641
00:26:29,159 --> 00:26:31,620
to understand what they is on a server

642
00:26:31,620 --> 00:26:33,840
what's potentially attackable but it

643
00:26:33,840 --> 00:26:36,000
could also just be bad code it could be

644
00:26:36,000 --> 00:26:38,820
somebody referencing an image file in

645
00:26:38,820 --> 00:26:42,480
the HTML code to somewhere location or

646
00:26:42,480 --> 00:26:45,360
file that doesn't exist so it may be the

647
00:26:45,360 --> 00:26:47,580
the actually how the page is coded

648
00:26:47,580 --> 00:26:50,039
resulting in that but either way you

649
00:26:50,039 --> 00:26:52,559
know again it's something the client has

650
00:26:52,559 --> 00:26:55,500
requested that doesn't exist somehow and

651
00:26:55,500 --> 00:26:58,860
so those are your 400 responses 500 is

652
00:26:58,860 --> 00:27:01,200
basically the server saying this request

653
00:27:01,200 --> 00:27:04,140
is just crazy I don't know it makes no

654
00:27:04,140 --> 00:27:06,900
sense not processing this it's just

655
00:27:06,900 --> 00:27:11,220
basically you know server error response

656
00:27:11,220 --> 00:27:14,220
SQL Basics uh understanding structured

657
00:27:14,220 --> 00:27:16,500
query language or SQL to help identify

658
00:27:16,500 --> 00:27:19,260
injection attacks which is on that OAS

659
00:27:19,260 --> 00:27:21,900
top 10 injection has been that won that

660
00:27:21,900 --> 00:27:24,360
thing since its Inception and it hasn't

661
00:27:24,360 --> 00:27:26,659
gone away and it probably won't go away

662
00:27:26,659 --> 00:27:29,159
so there's a couple great free online

663
00:27:29,159 --> 00:27:31,380
training courses these are pretty quick

664
00:27:31,380 --> 00:27:35,220
hitting uh they're completely free so

665
00:27:35,220 --> 00:27:38,100
check out the SQL course.com they have a

666
00:27:38,100 --> 00:27:39,600
beginner course an advanced course

667
00:27:39,600 --> 00:27:42,059
they're not too long to work through but

668
00:27:42,059 --> 00:27:44,220
if you haven't messed with SQL or messed

669
00:27:44,220 --> 00:27:46,700
with it in a really long time

670
00:27:46,700 --> 00:27:49,380
understanding how that works will help

671
00:27:49,380 --> 00:27:51,539
you then when you look at attack traffic

672
00:27:51,539 --> 00:27:54,179
understand what you're looking at and

673
00:27:54,179 --> 00:27:55,980
hopefully understand what the attacker

674
00:27:55,980 --> 00:27:58,440
is trying to do

675
00:27:58,440 --> 00:28:01,799
um so IR skill data encoding learn to

676
00:28:01,799 --> 00:28:03,720
recognize and identify the most popular

677
00:28:03,720 --> 00:28:07,260
data data encoding string traits uh so

678
00:28:07,260 --> 00:28:09,299
I'm just going to touch on this uh dig

679
00:28:09,299 --> 00:28:11,820
into this just a little bit so I take

680
00:28:11,820 --> 00:28:14,640
the string hello attendees it's got a

681
00:28:14,640 --> 00:28:16,620
capital h a space and an exclamation

682
00:28:16,620 --> 00:28:19,559
mark at the end

683
00:28:19,559 --> 00:28:22,200
what I look at with base64

684
00:28:22,200 --> 00:28:23,820
um and I can't really use my pointer

685
00:28:23,820 --> 00:28:25,679
here so I'll just kind of use the

686
00:28:25,679 --> 00:28:27,360
pointer well what you see it's

687
00:28:27,360 --> 00:28:29,700
interesting about this how I can guess

688
00:28:29,700 --> 00:28:32,659
this might be base64 is it's

689
00:28:32,659 --> 00:28:35,400
alphanumeric but also the alphabet is

690
00:28:35,400 --> 00:28:38,220
mixed case I have uppercase characters I

691
00:28:38,220 --> 00:28:40,740
have lowercase characters and it seems

692
00:28:40,740 --> 00:28:43,260
to span the entire alphabet in addition

693
00:28:43,260 --> 00:28:46,140
to the numeric characters

694
00:28:46,140 --> 00:28:49,140
um and so when I see that and then for

695
00:28:49,140 --> 00:28:51,000
me The Telltale sign this might be

696
00:28:51,000 --> 00:28:52,860
base64 if I'm not sure what I'm looking

697
00:28:52,860 --> 00:28:55,020
at is if I have one or two equal signs

698
00:28:55,020 --> 00:28:57,600
at the end of that that's a pad what

699
00:28:57,600 --> 00:28:59,400
that is is if the file doesn't have

700
00:28:59,400 --> 00:29:03,500
enough bytes to be basic C4

701
00:29:03,500 --> 00:29:06,840
decodable basically the equal sign will

702
00:29:06,840 --> 00:29:09,480
pad out those bytes so that it can be

703
00:29:09,480 --> 00:29:13,080
decoded and so when I see that instantly

704
00:29:13,080 --> 00:29:14,820
I'm thinking you know one or two equal

705
00:29:14,820 --> 00:29:17,400
sign at the end mixed case alphanumeric

706
00:29:17,400 --> 00:29:18,840
full alphabet

707
00:29:18,840 --> 00:29:22,260
a good chance it could be base 64. rot

708
00:29:22,260 --> 00:29:24,960
13 is just we rotation and Cipher the

709
00:29:24,960 --> 00:29:27,539
alphabet 13 characters you might be

710
00:29:27,539 --> 00:29:29,460
thinking oh Matt that's silly Believe It

711
00:29:29,460 --> 00:29:31,679
or Not Microsoft uses this

712
00:29:31,679 --> 00:29:34,140
more than you would think and I'm going

713
00:29:34,140 --> 00:29:37,260
to touch on a specific example with this

714
00:29:37,260 --> 00:29:39,960
um but what's interesting with with the

715
00:29:39,960 --> 00:29:43,919
right 13 is what you notice is the H and

716
00:29:43,919 --> 00:29:46,620
hello attendees is capitalized so is the

717
00:29:46,620 --> 00:29:49,320
first character in our rot 13

718
00:29:49,320 --> 00:29:49,919
um

719
00:29:49,919 --> 00:29:53,399
also the space is still there in both

720
00:29:53,399 --> 00:29:54,260
places

721
00:29:54,260 --> 00:29:58,320
and finally the exclamation mark

722
00:29:58,320 --> 00:30:00,240
is there in both places because

723
00:30:00,240 --> 00:30:03,480
exclamation part mark is not part of the

724
00:30:03,480 --> 00:30:06,899
English language so it doesn't rotate so

725
00:30:06,899 --> 00:30:08,640
if I see something it's not necessarily

726
00:30:08,640 --> 00:30:10,620
human readable but it has those

727
00:30:10,620 --> 00:30:12,659
characteristics here there's a good

728
00:30:12,659 --> 00:30:14,039
chance it's some sort of a rotation

729
00:30:14,039 --> 00:30:16,500
Cipher and probably the first one I

730
00:30:16,500 --> 00:30:18,059
would try there's other ones right or

731
00:30:18,059 --> 00:30:19,679
other rotation ciphers but probably one

732
00:30:19,679 --> 00:30:21,240
of the first ones I'm going to try is

733
00:30:21,240 --> 00:30:23,240
rot 13 just to see

734
00:30:23,240 --> 00:30:25,460
and then

735
00:30:25,460 --> 00:30:27,360
hexadecimal you see an awful lot

736
00:30:27,360 --> 00:30:29,940
particularly in networking uh and so

737
00:30:29,940 --> 00:30:32,159
typically you have two character

738
00:30:32,159 --> 00:30:34,320
pairings now these may or may not be

739
00:30:34,320 --> 00:30:38,340
prefixed by a zero X but typically when

740
00:30:38,340 --> 00:30:41,279
I see alphanumeric pairings but the

741
00:30:41,279 --> 00:30:43,500
alphabet characters never go beyond the

742
00:30:43,500 --> 00:30:45,600
letter F I'm thinking this is

743
00:30:45,600 --> 00:30:49,559
hexadecimal because hexadecimal is zero

744
00:30:49,559 --> 00:30:52,740
through nine a through F so when I don't

745
00:30:52,740 --> 00:30:55,980
see G or higher in the alphabet good

746
00:30:55,980 --> 00:30:57,600
chance I'm looking at something that's

747
00:30:57,600 --> 00:30:59,399
hexadecimal and sometimes you even have

748
00:30:59,399 --> 00:31:02,159
hexadecimal to ASCII and you can convert

749
00:31:02,159 --> 00:31:04,200
those things but believe it or not all

750
00:31:04,200 --> 00:31:06,240
three of these encoding methods are very

751
00:31:06,240 --> 00:31:08,899
commonplace

752
00:31:09,179 --> 00:31:12,419
and so an IR skill and this the talk

753
00:31:12,419 --> 00:31:15,600
before was fantastic on uh talking about

754
00:31:15,600 --> 00:31:18,539
uh you know bashing into forensics and

755
00:31:18,539 --> 00:31:21,240
he talked a lot about uh understanding

756
00:31:21,240 --> 00:31:22,679
the files and it was really about

757
00:31:22,679 --> 00:31:24,720
figuring out what you're looking at but

758
00:31:24,720 --> 00:31:26,580
understanding those file signatures

759
00:31:26,580 --> 00:31:29,399
magic bytes magic numbers file headers

760
00:31:29,399 --> 00:31:31,260
or whatever you want to call them I've

761
00:31:31,260 --> 00:31:33,899
heard them called many different names

762
00:31:33,899 --> 00:31:35,340
um is really important because

763
00:31:35,340 --> 00:31:38,700
extensions can be renamed they can be

764
00:31:38,700 --> 00:31:41,100
renamed purposely by a threat actor they

765
00:31:41,100 --> 00:31:44,159
could also just be lopped off and so it

766
00:31:44,159 --> 00:31:46,200
might be you know a multi-stage attack

767
00:31:46,200 --> 00:31:49,980
where first it comes in as a JPG file

768
00:31:49,980 --> 00:31:52,380
but it's really an executable file and

769
00:31:52,380 --> 00:31:55,220
then it gets renamed later and executed

770
00:31:55,220 --> 00:31:58,860
and so I know Dr Phil touched on this

771
00:31:58,860 --> 00:32:00,960
but uh you know so just a couple real

772
00:32:00,960 --> 00:32:03,419
quick hitting examples MZ is a Microsoft

773
00:32:03,419 --> 00:32:05,940
executable when you are looking at a

774
00:32:05,940 --> 00:32:08,279
file in a text editor or a hex editor

775
00:32:08,279 --> 00:32:10,740
and the ASCII output table

776
00:32:10,740 --> 00:32:13,200
if you see MZ in the first few bytes

777
00:32:13,200 --> 00:32:16,620
probably a Windows executable file and

778
00:32:16,620 --> 00:32:18,720
if you see PK it's typically some sort

779
00:32:18,720 --> 00:32:21,000
of a compressed file and what I like to

780
00:32:21,000 --> 00:32:23,220
tell people is if you see something and

781
00:32:23,220 --> 00:32:25,080
it's not human readable

782
00:32:25,080 --> 00:32:28,799
there's a number of options of what you

783
00:32:28,799 --> 00:32:30,960
might be looking at there's so it could

784
00:32:30,960 --> 00:32:34,020
be a binary file it could be something

785
00:32:34,020 --> 00:32:36,240
it's encoded it could be something

786
00:32:36,240 --> 00:32:38,399
that's encrypted or could just simply be

787
00:32:38,399 --> 00:32:40,860
compressed and so if you're looking at a

788
00:32:40,860 --> 00:32:42,899
Big Blob of stuff and it's not really

789
00:32:42,899 --> 00:32:44,880
human readable those are just some of

790
00:32:44,880 --> 00:32:47,700
the common things that might be and uh

791
00:32:47,700 --> 00:32:50,100
actually Dr Phil referenced Gary Kessler

792
00:32:50,100 --> 00:32:52,320
I've got the link right here to his file

793
00:32:52,320 --> 00:32:54,659
signature list I use this thing all the

794
00:32:54,659 --> 00:32:57,720
time it'll break down not just those two

795
00:32:57,720 --> 00:33:00,059
but a whole bunch of different file

796
00:33:00,059 --> 00:33:02,460
types and it also will give you end the

797
00:33:02,460 --> 00:33:05,520
file markers so one thing if you're kind

798
00:33:05,520 --> 00:33:08,399
of hunting it's not perfect but if

799
00:33:08,399 --> 00:33:09,539
you're looking at things that might be

800
00:33:09,539 --> 00:33:11,820
steganography if you look in into file

801
00:33:11,820 --> 00:33:15,840
marker in some some file formats have

802
00:33:15,840 --> 00:33:18,419
that some don't but when you have one if

803
00:33:18,419 --> 00:33:20,159
you see a bunch of data after that end

804
00:33:20,159 --> 00:33:22,200
of file marker there might be more than

805
00:33:22,200 --> 00:33:23,820
meets the eye it could even potentially

806
00:33:23,820 --> 00:33:26,960
be a steganography situation

807
00:33:26,960 --> 00:33:31,080
so understanding persistence there's a

808
00:33:31,080 --> 00:33:32,940
number of methods for threat actors to

809
00:33:32,940 --> 00:33:34,919
ensure persistence in order to greatly

810
00:33:34,919 --> 00:33:37,559
reduce the risk of losing access to an

811
00:33:37,559 --> 00:33:40,080
endpoint that they've compromised some

812
00:33:40,080 --> 00:33:42,299
of them are unique to Windows or Linux

813
00:33:42,299 --> 00:33:44,399
and I don't have time to drill into a

814
00:33:44,399 --> 00:33:46,620
lot of these but and I promise this is

815
00:33:46,620 --> 00:33:48,360
not the

816
00:33:48,360 --> 00:33:50,220
forty thousandth talk on the miter

817
00:33:50,220 --> 00:33:53,039
attack framework but check out their

818
00:33:53,039 --> 00:33:56,039
link here for understanding persistence

819
00:33:56,039 --> 00:33:58,860
because it breaks these down across the

820
00:33:58,860 --> 00:34:02,760
uh you know the different os's

821
00:34:03,740 --> 00:34:07,019
identifying file execution understanding

822
00:34:07,019 --> 00:34:09,000
how to know if a file executed on

823
00:34:09,000 --> 00:34:11,099
Windows endpoint is important so just

824
00:34:11,099 --> 00:34:12,540
because something has a malware file

825
00:34:12,540 --> 00:34:15,000
doesn't mean that malware file ran or

826
00:34:15,000 --> 00:34:16,980
that suspicious file ran but it's

827
00:34:16,980 --> 00:34:18,300
important to understand if it's

828
00:34:18,300 --> 00:34:22,500
suspicious did it run did it not run and

829
00:34:22,500 --> 00:34:23,699
there's a number of ways you can do that

830
00:34:23,699 --> 00:34:27,418
so a lot of EDR and xdr solutions will

831
00:34:27,418 --> 00:34:29,339
actually have that information they

832
00:34:29,339 --> 00:34:31,918
actually monitor for processes that ran

833
00:34:31,918 --> 00:34:34,760
on a host if you have that great use it

834
00:34:34,760 --> 00:34:37,379
also within the registry remember I

835
00:34:37,379 --> 00:34:39,719
talked earlier about rot13 how Microsoft

836
00:34:39,719 --> 00:34:42,599
still uses it yeah they do actually and

837
00:34:42,599 --> 00:34:45,119
here's a Windows registry key HP current

838
00:34:45,119 --> 00:34:47,580
user software Microsoft Windows current

839
00:34:47,580 --> 00:34:50,879
version explore user assist there's a

840
00:34:50,879 --> 00:34:52,859
grid and then this count

841
00:34:52,859 --> 00:34:56,879
that's actually rot 13 uh encoded and so

842
00:34:56,879 --> 00:34:59,040
if I want to understand the notepad.exe

843
00:34:59,040 --> 00:35:00,960
run I don't search the Windows registry

844
00:35:00,960 --> 00:35:05,460
for notepad.exe I write 13 encode that

845
00:35:05,460 --> 00:35:08,160
and then I search for that rot 13 value

846
00:35:08,160 --> 00:35:10,560
in the Windows registry

847
00:35:10,560 --> 00:35:12,420
um so yeah I talked earlier Microsoft

848
00:35:12,420 --> 00:35:14,700
uses it there's one example there's

849
00:35:14,700 --> 00:35:17,280
others but uh that's you know certainly

850
00:35:17,280 --> 00:35:19,380
an important one also if you have a

851
00:35:19,380 --> 00:35:22,920
memory dump you can look at shim cash on

852
00:35:22,920 --> 00:35:24,960
Windows host there's a prefetch folder

853
00:35:24,960 --> 00:35:27,420
which is typically under the windows

854
00:35:27,420 --> 00:35:30,180
directory there's a prefetch folder and

855
00:35:30,180 --> 00:35:33,300
so when you see these files in prefetch

856
00:35:33,300 --> 00:35:35,760
what happens in Windows when a file is

857
00:35:35,760 --> 00:35:38,040
executed is Windows will sort of cache

858
00:35:38,040 --> 00:35:41,280
that on the OS so that the next time you

859
00:35:41,280 --> 00:35:43,260
launch it it knows exactly where to go

860
00:35:43,260 --> 00:35:45,180
you know in the file system disk

861
00:35:45,180 --> 00:35:47,760
whatever have you uh to execute a little

862
00:35:47,760 --> 00:35:50,520
bit faster next time but things that

863
00:35:50,520 --> 00:35:51,780
don't run aren't going to be in the

864
00:35:51,780 --> 00:35:54,060
prefetch folder but that can be a clue

865
00:35:54,060 --> 00:35:55,560
if you see something in the prefetch

866
00:35:55,560 --> 00:35:57,260
folder you know it's been run before

867
00:35:57,260 --> 00:35:59,760
there's other methods but those are just

868
00:35:59,760 --> 00:36:02,040
some real quick hitting ones that I

869
00:36:02,040 --> 00:36:04,560
wanted to cover uh Windows is really

870
00:36:04,560 --> 00:36:07,079
hard to secure so for most people that

871
00:36:07,079 --> 00:36:09,720
have a personal Mac or personal Linux

872
00:36:09,720 --> 00:36:13,260
system don't run antivirus well why is

873
00:36:13,260 --> 00:36:15,000
that even among Security Professionals

874
00:36:15,000 --> 00:36:17,640
you'd think that would be important

875
00:36:17,640 --> 00:36:19,859
thing with Windows and the reason it's

876
00:36:19,859 --> 00:36:21,780
very hard to secure is there's a lot of

877
00:36:21,780 --> 00:36:24,180
different file types and extensions that

878
00:36:24,180 --> 00:36:28,020
just run by default so nobody probably

879
00:36:28,020 --> 00:36:30,359
even knows exactly how many executable

880
00:36:30,359 --> 00:36:32,940
file types there are extensions on

881
00:36:32,940 --> 00:36:35,160
Windows but there's at least 50 of them

882
00:36:35,160 --> 00:36:37,260
and here's a link to a how to geek

883
00:36:37,260 --> 00:36:40,800
article that covers those uh and so

884
00:36:40,800 --> 00:36:44,220
yeah if I download a.exe file from the

885
00:36:44,220 --> 00:36:46,260
internet and I double click on it what's

886
00:36:46,260 --> 00:36:47,700
going to happen

887
00:36:47,700 --> 00:36:49,500
it's going to run because it's an

888
00:36:49,500 --> 00:36:51,359
executable file that's what Windows does

889
00:36:51,359 --> 00:36:54,300
is it runs executable files when you

890
00:36:54,300 --> 00:36:57,240
tell it to run it if I download a DOT sh

891
00:36:57,240 --> 00:36:59,760
file which is a script file on my Linux

892
00:36:59,760 --> 00:37:01,740
laptop and I double click on it you know

893
00:37:01,740 --> 00:37:03,060
what's going to happen

894
00:37:03,060 --> 00:37:06,720
nothing because if I don't purposely set

895
00:37:06,720 --> 00:37:09,180
the executable bit myself to make that

896
00:37:09,180 --> 00:37:11,099
script file executable it's not

897
00:37:11,099 --> 00:37:13,740
executable by default that's why Windows

898
00:37:13,740 --> 00:37:16,619
is really sort of challenging to secure

899
00:37:16,619 --> 00:37:18,540
relative to some of the other operating

900
00:37:18,540 --> 00:37:20,880
systems

901
00:37:20,880 --> 00:37:22,560
um evidence collection I'm not gonna

902
00:37:22,560 --> 00:37:24,119
spend a lot of time on this but

903
00:37:24,119 --> 00:37:25,980
understanding the order of volatility

904
00:37:25,980 --> 00:37:29,099
and uh here's a link to uh an RFC

905
00:37:29,099 --> 00:37:31,619
request for comments uh this is an old

906
00:37:31,619 --> 00:37:34,980
one RFC 3227

907
00:37:34,980 --> 00:37:38,099
um and so the idea behind understanding

908
00:37:38,099 --> 00:37:39,839
the order of volatility is if I'm

909
00:37:39,839 --> 00:37:41,460
collecting evidence from an endpoint

910
00:37:41,460 --> 00:37:43,680
that I'm investigating I want to get the

911
00:37:43,680 --> 00:37:44,940
stuff that's going to potentially

912
00:37:44,940 --> 00:37:47,820
disappear fastest I want to collect that

913
00:37:47,820 --> 00:37:50,760
first uh as opposed to things that are

914
00:37:50,760 --> 00:37:53,280
not likely to change I want to get those

915
00:37:53,280 --> 00:37:57,240
things last and so the idea is that uh

916
00:37:57,240 --> 00:37:59,160
something that's in memory on a his

917
00:37:59,160 --> 00:38:02,700
system if it gets rebooted it's gone if

918
00:38:02,700 --> 00:38:04,740
the system gets powered off it's gone

919
00:38:04,740 --> 00:38:07,200
I'm not getting it back I can know I

920
00:38:07,200 --> 00:38:09,420
don't have a second shot at that

921
00:38:09,420 --> 00:38:11,400
if there's a USB stick that's plugged

922
00:38:11,400 --> 00:38:13,140
into that endpoint

923
00:38:13,140 --> 00:38:14,640
unless it's you know somebody

924
00:38:14,640 --> 00:38:16,500
specifically written code to modify

925
00:38:16,500 --> 00:38:18,599
what's on that USB stick or clean up

926
00:38:18,599 --> 00:38:21,240
after itself it's probably not going to

927
00:38:21,240 --> 00:38:23,280
change the data on that USB stick is

928
00:38:23,280 --> 00:38:25,619
much less likely to change relative to

929
00:38:25,619 --> 00:38:28,200
memory so the idea is that I would get

930
00:38:28,200 --> 00:38:30,359
the memory first I would get things like

931
00:38:30,359 --> 00:38:35,339
a USB stick last and then that's not the

932
00:38:35,339 --> 00:38:38,339
only uh so nist has a guide to

933
00:38:38,339 --> 00:38:40,140
integrating forensic techniques and the

934
00:38:40,140 --> 00:38:43,200
incident response and so they also have

935
00:38:43,200 --> 00:38:45,540
a recommended order here but it's the

936
00:38:45,540 --> 00:38:48,540
same idea right get the most volatile uh

937
00:38:48,540 --> 00:38:51,540
data first the least volatile last and

938
00:38:51,540 --> 00:38:54,420
it doesn't really matter which to a

939
00:38:54,420 --> 00:38:55,800
great degree it doesn't probably matter

940
00:38:55,800 --> 00:38:57,900
which standard you use you could even

941
00:38:57,900 --> 00:38:59,700
create your own standard internal in

942
00:38:59,700 --> 00:39:01,920
your organization just make sure if you

943
00:39:01,920 --> 00:39:04,260
do that you document it so that you can

944
00:39:04,260 --> 00:39:07,260
explain here's our process for doing

945
00:39:07,260 --> 00:39:09,240
this and here's why we do it the way we

946
00:39:09,240 --> 00:39:11,760
do it in this precise order we do it so

947
00:39:11,760 --> 00:39:14,280
you can explain to an auditor or an

948
00:39:14,280 --> 00:39:16,980
investigator you know here's how this

949
00:39:16,980 --> 00:39:19,380
was done the order and why we do it that

950
00:39:19,380 --> 00:39:20,780
way

951
00:39:20,780 --> 00:39:24,780
and then some tools for skill building I

952
00:39:24,780 --> 00:39:27,180
mentioned cyber Chef earlier cyber Chef

953
00:39:27,180 --> 00:39:29,520
is the Cyber Swiss army knife you can do

954
00:39:29,520 --> 00:39:31,859
a lot of cool stuff a lot of those

955
00:39:31,859 --> 00:39:34,140
decoding things I talked about you can

956
00:39:34,140 --> 00:39:36,359
use cyber Chef converting Linux time

957
00:39:36,359 --> 00:39:39,000
Epoch time stamps into human readable

958
00:39:39,000 --> 00:39:41,520
time local time you can use it with do a

959
00:39:41,520 --> 00:39:43,619
cyber Chef you want to generate a QR

960
00:39:43,619 --> 00:39:45,780
code you can do it in cyber Chef you can

961
00:39:45,780 --> 00:39:47,460
do like a million things in cyber Chef

962
00:39:47,460 --> 00:39:50,099
uh and so I actually did create another

963
00:39:50,099 --> 00:39:52,980
workshop for cyber Chef again about a

964
00:39:52,980 --> 00:39:55,260
two hour Workshop absolutely free just

965
00:39:55,260 --> 00:39:56,480
go to

966
00:39:56,480 --> 00:39:59,940
workshops.dfirmat.com download that and

967
00:39:59,940 --> 00:40:01,980
it's just a bunch of lab files you can

968
00:40:01,980 --> 00:40:04,020
either do it online or you can download

969
00:40:04,020 --> 00:40:07,079
and run the Cyber Chef web app locally

970
00:40:07,079 --> 00:40:09,660
on your system it is incredibly powerful

971
00:40:09,660 --> 00:40:11,400
and What it lets you do is it lets you

972
00:40:11,400 --> 00:40:13,140
string a bunch of different functions

973
00:40:13,140 --> 00:40:16,560
together without coding and get you can

974
00:40:16,560 --> 00:40:20,040
do a lot with it quickly and so I use it

975
00:40:20,040 --> 00:40:22,260
a lot I I really like it it's a great

976
00:40:22,260 --> 00:40:24,480
tool and then

977
00:40:24,480 --> 00:40:26,820
incident response and forensic tools if

978
00:40:26,820 --> 00:40:28,800
you're looking for tools to learn

979
00:40:28,800 --> 00:40:30,480
believe it or not you might be thinking

980
00:40:30,480 --> 00:40:32,760
well Kali Linux is offensive security

981
00:40:32,760 --> 00:40:35,760
predominantly and yes it is but it

982
00:40:35,760 --> 00:40:37,440
actually does have some forensic tools

983
00:40:37,440 --> 00:40:40,980
such as autopsy if you have Cali try

984
00:40:40,980 --> 00:40:42,660
your hand at autopsy and play around

985
00:40:42,660 --> 00:40:45,540
with it it's a great tool there's also

986
00:40:45,540 --> 00:40:48,000
some specific distributions like remnux

987
00:40:48,000 --> 00:40:49,740
which is primarily for a reverse

988
00:40:49,740 --> 00:40:52,140
engineering malware you also have the

989
00:40:52,140 --> 00:40:55,260
Sans sift workstation that you can also

990
00:40:55,260 --> 00:40:59,520
use to investigate files and you can

991
00:40:59,520 --> 00:41:01,260
combine those things so you can install

992
00:41:01,260 --> 00:41:03,599
the sand sift workstation tools and

993
00:41:03,599 --> 00:41:07,500
remnucks or install or vice versa you

994
00:41:07,500 --> 00:41:10,920
can install one to the other either way

995
00:41:10,920 --> 00:41:13,020
there's also a distribution out there

996
00:41:13,020 --> 00:41:15,180
called CSI Linux has a lot of cool

997
00:41:15,180 --> 00:41:17,940
forensic tools so you can always check

998
00:41:17,940 --> 00:41:19,520
that out as well

999
00:41:19,520 --> 00:41:23,400
that helps you a lot with doing that

1000
00:41:23,400 --> 00:41:26,339
static analysis sometimes though in

1001
00:41:26,339 --> 00:41:28,740
order to see Dynamic analysis on

1002
00:41:28,740 --> 00:41:31,440
understand okay I can tell a lot about

1003
00:41:31,440 --> 00:41:33,240
this by looking at the dynamic

1004
00:41:33,240 --> 00:41:34,619
properties but I actually need to see

1005
00:41:34,619 --> 00:41:36,420
what happens when this is running on a

1006
00:41:36,420 --> 00:41:38,880
live system and the only way you can do

1007
00:41:38,880 --> 00:41:40,619
that a lot of times is to run Windows

1008
00:41:40,619 --> 00:41:43,859
stuff on a Windows system so you can use

1009
00:41:43,859 --> 00:41:46,800
an evaluation version of Windows and

1010
00:41:46,800 --> 00:41:49,260
install fireeyes flare VM Tools in it

1011
00:41:49,260 --> 00:41:51,500
you have to be careful because some

1012
00:41:51,500 --> 00:41:53,640
malware is actually is an evasion

1013
00:41:53,640 --> 00:41:55,260
technique checking to see if it's an

1014
00:41:55,260 --> 00:41:58,440
evaluation version of Windows but the

1015
00:41:58,440 --> 00:42:01,560
flare VM tools has a lot of great tools

1016
00:42:01,560 --> 00:42:04,980
within it specific for Windows but again

1017
00:42:04,980 --> 00:42:07,980
you can actually look at files and see

1018
00:42:07,980 --> 00:42:10,220
what happens on a Windows system

1019
00:42:10,220 --> 00:42:12,420
using that you just have to be careful

1020
00:42:12,420 --> 00:42:16,760
to you know properly sandbox this stuff

1021
00:42:16,980 --> 00:42:19,800
um so other ways to build skills uh I'm

1022
00:42:19,800 --> 00:42:21,660
a big proponent of the Anisa training

1023
00:42:21,660 --> 00:42:24,119
Labs put out by the European Union these

1024
00:42:24,119 --> 00:42:26,520
labs are absolutely free it's cool they

1025
00:42:26,520 --> 00:42:28,560
give you the lab guides you get the

1026
00:42:28,560 --> 00:42:30,660
virtual machine they're very low

1027
00:42:30,660 --> 00:42:33,660
resource so you don't need much to run

1028
00:42:33,660 --> 00:42:36,839
them even old Hardware can typically run

1029
00:42:36,839 --> 00:42:40,200
these in like virtual box for example

1030
00:42:40,200 --> 00:42:42,660
um awesome training material there's

1031
00:42:42,660 --> 00:42:45,359
some caveats because it's European based

1032
00:42:45,359 --> 00:42:47,339
it's the United States based but just

1033
00:42:47,339 --> 00:42:49,740
fantastic resource for learning this

1034
00:42:49,740 --> 00:42:52,140
stuff I always encourage people to

1035
00:42:52,140 --> 00:42:54,359
participate and Capture the Flag or CTF

1036
00:42:54,359 --> 00:42:57,180
events I don't think I've done a CTF or

1037
00:42:57,180 --> 00:42:59,220
haven't learned something or relearned

1038
00:42:59,220 --> 00:43:01,160
something I haven't brushed on in ages

1039
00:43:01,160 --> 00:43:05,460
it'll really help you up your skills in

1040
00:43:05,460 --> 00:43:07,619
those things and then again just

1041
00:43:07,619 --> 00:43:09,119
touching on miter real quick just

1042
00:43:09,119 --> 00:43:11,400
understanding the tactics the techniques

1043
00:43:11,400 --> 00:43:13,079
and procedures the miter attack

1044
00:43:13,079 --> 00:43:16,740
framework will help you and again

1045
00:43:16,740 --> 00:43:18,599
um yeah that's why I think offensive

1046
00:43:18,599 --> 00:43:20,520
security stuff is important for instant

1047
00:43:20,520 --> 00:43:23,880
responders because understanding what

1048
00:43:23,880 --> 00:43:26,280
tools somebody's using against your

1049
00:43:26,280 --> 00:43:27,599
environment

1050
00:43:27,599 --> 00:43:29,940
how they work why they're using those

1051
00:43:29,940 --> 00:43:32,700
tools and then also very importantly the

1052
00:43:32,700 --> 00:43:35,220
artifacts they leave behind it's going

1053
00:43:35,220 --> 00:43:38,160
to make you a better incident responder

1054
00:43:38,160 --> 00:43:40,619
and so really learn those offensive

1055
00:43:40,619 --> 00:43:43,680
security skills uh you can also do like

1056
00:43:43,680 --> 00:43:46,560
bug bounty hunting stuff and you know

1057
00:43:46,560 --> 00:43:48,780
maybe even earn a few extra dollars to

1058
00:43:48,780 --> 00:43:51,720
hack stuff legally and all of them you

1059
00:43:51,720 --> 00:43:54,480
know like bug crowd hacker one and you

1060
00:43:54,480 --> 00:43:56,640
know probably synac like there's a whole

1061
00:43:56,640 --> 00:43:58,800
bunch of them they have training

1062
00:43:58,800 --> 00:44:01,740
resources freely available and so or

1063
00:44:01,740 --> 00:44:03,540
everything you can improve your own IR

1064
00:44:03,540 --> 00:44:05,940
skills and then figure out what

1065
00:44:05,940 --> 00:44:07,859
indicators that compromise those

1066
00:44:07,859 --> 00:44:10,440
offensive security tools generate and

1067
00:44:10,440 --> 00:44:12,839
then figure out ways to Monitor and

1068
00:44:12,839 --> 00:44:15,020
detect that type of activity

1069
00:44:15,020 --> 00:44:18,119
and then some hands-on experience again

1070
00:44:18,119 --> 00:44:20,460
be really careful about this but safely

1071
00:44:20,460 --> 00:44:23,160
have a look at some bad stuff uh so

1072
00:44:23,160 --> 00:44:25,319
sometimes you find publicly shared data

1073
00:44:25,319 --> 00:44:29,040
breach dumps some resources or any dot

1074
00:44:29,040 --> 00:44:30,780
run you have to be a little careful with

1075
00:44:30,780 --> 00:44:32,579
that because they've got Russian ties

1076
00:44:32,579 --> 00:44:35,099
and so that's a little dicey these days

1077
00:44:35,099 --> 00:44:39,300
uh but great resource nonetheless uh and

1078
00:44:39,300 --> 00:44:41,339
then sometimes breach data gets uploaded

1079
00:44:41,339 --> 00:44:42,780
to GitHub

1080
00:44:42,780 --> 00:44:44,040
um if you're trying to learn this stuff

1081
00:44:44,040 --> 00:44:46,800
uh Sans uses this a lot a lot of things

1082
00:44:46,800 --> 00:44:49,099
use malware hyphen traffic hyphen

1083
00:44:49,099 --> 00:44:52,619
analysis.net uh has pcap files and other

1084
00:44:52,619 --> 00:44:54,780
things out there has little challenges

1085
00:44:54,780 --> 00:44:57,660
walkthroughs uh great examples of bad

1086
00:44:57,660 --> 00:44:59,819
stuff that you can look at safely

1087
00:44:59,819 --> 00:45:03,240
yourself and try to figure it out and

1088
00:45:03,240 --> 00:45:06,119
then phishing emails and sites I like to

1089
00:45:06,119 --> 00:45:08,700
use fishtank.com they always have like

1090
00:45:08,700 --> 00:45:10,500
if you want to see what phishing attacks

1091
00:45:10,500 --> 00:45:12,839
are actually happening in the wild

1092
00:45:12,839 --> 00:45:15,060
that's a great resource you just go to

1093
00:45:15,060 --> 00:45:16,680
fish tank and look to see the latest

1094
00:45:16,680 --> 00:45:18,960
stuff that's been posted and if it's

1095
00:45:18,960 --> 00:45:21,480
still live or not and then you know

1096
00:45:21,480 --> 00:45:23,040
another thing you can do if you have a

1097
00:45:23,040 --> 00:45:24,839
home lab or you can spin up at least a

1098
00:45:24,839 --> 00:45:28,200
couple VMS go DIY style become your own

1099
00:45:28,200 --> 00:45:30,300
one person purple team learn the

1100
00:45:30,300 --> 00:45:32,720
offensive side and the defensive side

1101
00:45:32,720 --> 00:45:35,220
you'll learn an awful lot when you play

1102
00:45:35,220 --> 00:45:36,839
when you wear both hats when you're

1103
00:45:36,839 --> 00:45:38,880
doing that

1104
00:45:38,880 --> 00:45:41,520
um so that is it for

1105
00:45:41,520 --> 00:45:43,440
um really the talk I want to thank

1106
00:45:43,440 --> 00:45:45,540
everybody for attending I will uh open

1107
00:45:45,540 --> 00:45:48,380
it up for questions

1108
00:45:50,760 --> 00:45:53,359
yes

1109
00:46:15,680 --> 00:46:19,500
right away okay so those things that

1110
00:46:19,500 --> 00:46:22,319
those alerts or triggers that sort of

1111
00:46:22,319 --> 00:46:23,940
raise an eyebrow

1112
00:46:23,940 --> 00:46:27,359
um and so you know if I see a lot of

1113
00:46:27,359 --> 00:46:29,040
failed logins

1114
00:46:29,040 --> 00:46:31,140
um particularly from an IP address off

1115
00:46:31,140 --> 00:46:33,000
of my network and it's maybe something

1116
00:46:33,000 --> 00:46:35,099
it shouldn't be exposed to the public

1117
00:46:35,099 --> 00:46:38,220
internet uh that's always that's always

1118
00:46:38,220 --> 00:46:40,740
a tricky situation it gets my attention

1119
00:46:40,740 --> 00:46:44,460
real quick and in particular so like an

1120
00:46:44,460 --> 00:46:46,859
example is uh with a merger and

1121
00:46:46,859 --> 00:46:48,480
acquisition

1122
00:46:48,480 --> 00:46:50,040
um you know this thing had been under

1123
00:46:50,040 --> 00:46:52,380
the organizational umbrella for quite a

1124
00:46:52,380 --> 00:46:54,660
while but they aren't fully onboarded

1125
00:46:54,660 --> 00:46:56,220
with our standard processes and

1126
00:46:56,220 --> 00:46:59,160
procedures and so when I have an alert

1127
00:46:59,160 --> 00:47:03,000
that is you know that's and this is

1128
00:47:03,000 --> 00:47:04,920
something in the cloud but when we have

1129
00:47:04,920 --> 00:47:07,680
a guard Duty alert that's saying hey

1130
00:47:07,680 --> 00:47:10,079
this thing is talking to known Russian

1131
00:47:10,079 --> 00:47:13,800
crypto mining IP address and we talked

1132
00:47:13,800 --> 00:47:15,660
to the developers and oh these hosts

1133
00:47:15,660 --> 00:47:17,400
aren't internet accessible

1134
00:47:17,400 --> 00:47:20,280
really I would like to know then how

1135
00:47:20,280 --> 00:47:21,780
this thing is phoning home back to

1136
00:47:21,780 --> 00:47:24,420
Mother Russia uh

1137
00:47:24,420 --> 00:47:28,200
when it's not internet accessible and so

1138
00:47:28,200 --> 00:47:30,060
the funny thing is because they had so

1139
00:47:30,060 --> 00:47:32,099
like some weird memory leak situation

1140
00:47:32,099 --> 00:47:33,420
like they basically have their

1141
00:47:33,420 --> 00:47:35,220
infrastructure Auto tear down and

1142
00:47:35,220 --> 00:47:37,020
rebuild from scratch

1143
00:47:37,020 --> 00:47:38,880
so we were kind of stuck because we

1144
00:47:38,880 --> 00:47:41,220
didn't have what we needed to do

1145
00:47:41,220 --> 00:47:43,440
yeah we didn't have those artifacts and

1146
00:47:43,440 --> 00:47:45,359
they were lost but sure enough it

1147
00:47:45,359 --> 00:47:48,060
happened again and you know again it's

1148
00:47:48,060 --> 00:47:49,500
like one of these things like well okay

1149
00:47:49,500 --> 00:47:51,660
so explain this to me if this thing is

1150
00:47:51,660 --> 00:47:53,579
not directly internet accessible how

1151
00:47:53,579 --> 00:47:55,319
this happened and then what we find is

1152
00:47:55,319 --> 00:47:58,680
lo and behold uh oh yeah I guess there

1153
00:47:58,680 --> 00:48:00,420
is a load balancer in front of these

1154
00:48:00,420 --> 00:48:02,819
things and so it's Distributing them so

1155
00:48:02,819 --> 00:48:04,560
it's amazing because they didn't even

1156
00:48:04,560 --> 00:48:07,440
realize and unfortunately you know in a

1157
00:48:07,440 --> 00:48:09,119
situation like that turns out to be like

1158
00:48:09,119 --> 00:48:12,900
a Dev QA fictional data nothing lost but

1159
00:48:12,900 --> 00:48:15,359
it's very eye-opening when you see those

1160
00:48:15,359 --> 00:48:18,420
things that don't make sense and so a

1161
00:48:18,420 --> 00:48:19,560
good bit of that is sort of

1162
00:48:19,560 --> 00:48:22,500
understanding the environment uh what's

1163
00:48:22,500 --> 00:48:25,859
normal and also the other lesson there

1164
00:48:25,859 --> 00:48:27,540
is you can't take other people's word

1165
00:48:27,540 --> 00:48:29,640
for what they tell you all the time do

1166
00:48:29,640 --> 00:48:32,640
your own investigation and uh figure it

1167
00:48:32,640 --> 00:48:33,960
out you might arrive at the same

1168
00:48:33,960 --> 00:48:36,300
conclusion but you might arrive at a

1169
00:48:36,300 --> 00:48:39,380
totally different conclusion

1170
00:48:39,540 --> 00:48:42,500
anybody else

1171
00:48:42,720 --> 00:48:45,240
all right well that's going to conclude

1172
00:48:45,240 --> 00:48:46,740
for me

1173
00:48:46,740 --> 00:48:49,680
this talk was a part of our 2022 secure

1174
00:48:49,680 --> 00:48:52,079
West Virginia Lucky 13 conference if you

1175
00:48:52,079 --> 00:48:53,700
would like more information about this

1176
00:48:53,700 --> 00:48:55,319
talk or our speaker check the

1177
00:48:55,319 --> 00:48:57,540
description below and if you enjoyed the

1178
00:48:57,540 --> 00:48:59,280
content consider liking and sharing this

1179
00:48:59,280 --> 00:49:01,560
video for more information on secure

1180
00:49:01,560 --> 00:49:03,060
West Virginia or you want to stay

1181
00:49:03,060 --> 00:49:05,160
updated with the latest upcoming events

1182
00:49:05,160 --> 00:49:08,819
follow us on Twitter at securewbcon or

1183
00:49:08,819 --> 00:49:11,760
visit our website securewv.org

1184
00:49:11,760 --> 00:49:13,980
we would like also like to thank our

1185
00:49:13,980 --> 00:49:16,380
2022 sponsors for being a huge part of

1186
00:49:16,380 --> 00:49:19,520
Lucky 13 success

