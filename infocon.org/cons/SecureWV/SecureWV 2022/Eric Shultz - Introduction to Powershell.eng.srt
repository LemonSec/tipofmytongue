1
00:00:09,480 --> 00:00:12,200
reported

2
00:00:13,099 --> 00:00:15,599
good afternoon everyone I realize I am

3
00:00:15,599 --> 00:00:17,760
the guy after lunch so I'm going to try

4
00:00:17,760 --> 00:00:19,619
to keep things moving

5
00:00:19,619 --> 00:00:21,660
I will try to be entertaining I didn't

6
00:00:21,660 --> 00:00:23,340
bring my dad jokes

7
00:00:23,340 --> 00:00:24,779
but I'll try to keep things entertaining

8
00:00:24,779 --> 00:00:25,920
anyway

9
00:00:25,920 --> 00:00:29,340
uh I do like to I do encourage people to

10
00:00:29,340 --> 00:00:31,560
try the things uh like Hands-On I think

11
00:00:31,560 --> 00:00:32,880
that's the best way to learn so if any

12
00:00:32,880 --> 00:00:34,020
of you brought your laptops I was

13
00:00:34,020 --> 00:00:36,840
mentioning earlier fire them up if you

14
00:00:36,840 --> 00:00:39,120
have Windows I know sometimes I'm amazed

15
00:00:39,120 --> 00:00:40,320
to be here I know sometimes they don't

16
00:00:40,320 --> 00:00:42,840
like Windows people here but I work with

17
00:00:42,840 --> 00:00:44,700
Windows I work with Linux I works on the

18
00:00:44,700 --> 00:00:46,440
Mac

19
00:00:46,440 --> 00:00:47,700
um

20
00:00:47,700 --> 00:00:49,440
written code in lots of different

21
00:00:49,440 --> 00:00:51,000
languages and works a lot of different

22
00:00:51,000 --> 00:00:52,379
interfaces through the years more people

23
00:00:52,379 --> 00:00:55,460
excellent we're just starting

24
00:01:00,620 --> 00:01:02,940
wow I realize I guess I thought it might

25
00:01:02,940 --> 00:01:04,500
be an introduction so my name is Eric

26
00:01:04,500 --> 00:01:05,939
Schultz and I've been working in the

27
00:01:05,939 --> 00:01:08,820
industry for a number of years now

28
00:01:08,820 --> 00:01:11,220
I've done some software developments and

29
00:01:11,220 --> 00:01:13,500
some systems engineering assistant

30
00:01:13,500 --> 00:01:16,439
Administration and the last 10 15 years

31
00:01:16,439 --> 00:01:18,780
working in the cyber security field in a

32
00:01:18,780 --> 00:01:20,400
number of different roles such as red

33
00:01:20,400 --> 00:01:22,500
teams and penetration testing blue

34
00:01:22,500 --> 00:01:25,320
teaming even a touch reverse engineering

35
00:01:25,320 --> 00:01:27,360
but not as much as I would have liked

36
00:01:27,360 --> 00:01:31,340
anyway let's get started here

37
00:01:31,439 --> 00:01:33,659
what I'd like to do today is give you a

38
00:01:33,659 --> 00:01:35,400
really brief history of Powershell I

39
00:01:35,400 --> 00:01:37,200
don't think that's all that important I

40
00:01:37,200 --> 00:01:40,079
highlight a few uh specific things along

41
00:01:40,079 --> 00:01:41,579
the way

42
00:01:41,579 --> 00:01:44,220
and then get started by

43
00:01:44,220 --> 00:01:46,079
um giving you a quick view of the

44
00:01:46,079 --> 00:01:47,579
integrated scripting environment and the

45
00:01:47,579 --> 00:01:48,900
command line shell those are the two

46
00:01:48,900 --> 00:01:51,180
main ways of working with Powershell

47
00:01:51,180 --> 00:01:52,860
we'll talk briefly again about

48
00:01:52,860 --> 00:01:55,799
differences and then I'll just make

49
00:01:55,799 --> 00:01:58,680
mention in some cases depending on where

50
00:01:58,680 --> 00:01:59,939
you are what you're doing you may need

51
00:01:59,939 --> 00:02:03,479
administrator level access for example

52
00:02:03,479 --> 00:02:05,219
then we'll get into what you probably

53
00:02:05,219 --> 00:02:06,899
want to know about things like aliases

54
00:02:06,899 --> 00:02:10,080
and commands and functions and modules

55
00:02:10,080 --> 00:02:11,400
and Scripts

56
00:02:11,400 --> 00:02:13,319
but this was supposed to be an entry

57
00:02:13,319 --> 00:02:14,760
level beginning level so it won't get

58
00:02:14,760 --> 00:02:17,640
too deep into these areas

59
00:02:17,640 --> 00:02:19,739
can everybody hear me over there you

60
00:02:19,739 --> 00:02:21,840
guys can hear me okay uh sorry that's

61
00:02:21,840 --> 00:02:23,580
not much I can do about the screen I

62
00:02:23,580 --> 00:02:24,540
don't know if you guys want to move in a

63
00:02:24,540 --> 00:02:26,940
little closer up to you

64
00:02:26,940 --> 00:02:30,560
you folks are in good shape I think

65
00:02:30,560 --> 00:02:33,720
all right so the real brief history it

66
00:02:33,720 --> 00:02:36,239
started way back in 2006 for anybody who

67
00:02:36,239 --> 00:02:37,980
didn't know that uh it was November

68
00:02:37,980 --> 00:02:39,599
something like that version one very

69
00:02:39,599 --> 00:02:43,200
basic it's it's grown it's evolved

70
00:02:43,200 --> 00:02:44,519
I don't really think the versions are

71
00:02:44,519 --> 00:02:45,780
all that important except they will note

72
00:02:45,780 --> 00:02:48,120
version six uh is when they introduce

73
00:02:48,120 --> 00:02:51,420
their Powershell core idea across

74
00:02:51,420 --> 00:02:53,940
platform open source I think the ideas

75
00:02:53,940 --> 00:02:56,220
they they offer updates releases like

76
00:02:56,220 --> 00:02:57,840
every six months

77
00:02:57,840 --> 00:02:59,700
and we are now currently at Powershell

78
00:02:59,700 --> 00:03:02,340
version seven 7.2 I think is the latest

79
00:03:02,340 --> 00:03:06,510
release and there is a 7.3 pre-release

80
00:03:06,510 --> 00:03:09,360
[Music]

81
00:03:09,360 --> 00:03:11,340
all right for those in the back I could

82
00:03:11,340 --> 00:03:13,500
launch it but uh the ISE if you're new

83
00:03:13,500 --> 00:03:14,879
to software development you might like

84
00:03:14,879 --> 00:03:16,260
the ISE

85
00:03:16,260 --> 00:03:19,099
integrated scripting environment

86
00:03:19,099 --> 00:03:21,420
and I spelled that out and it's gone now

87
00:03:21,420 --> 00:03:22,920
okay the integrated scripting

88
00:03:22,920 --> 00:03:25,140
environment gives you a window with a

89
00:03:25,140 --> 00:03:26,099
nice blue window that's where you're

90
00:03:26,099 --> 00:03:27,480
dealing with your code and then the

91
00:03:27,480 --> 00:03:29,099
window to the side gives you help right

92
00:03:29,099 --> 00:03:30,599
then and there you're looking at a list

93
00:03:30,599 --> 00:03:34,260
of functions and commandlets that are

94
00:03:34,260 --> 00:03:35,519
available to you

95
00:03:35,519 --> 00:03:37,739
it is a nice way to begin programming

96
00:03:37,739 --> 00:03:40,319
begin Powershell programming

97
00:03:40,319 --> 00:03:42,420
I personally I'm old school I personally

98
00:03:42,420 --> 00:03:44,519
prefer the uh other way the command

99
00:03:44,519 --> 00:03:46,799
shell it is

100
00:03:46,799 --> 00:03:50,220
any uh old dos command show or it's

101
00:03:50,220 --> 00:03:52,140
similar to any of your Linux or Unix

102
00:03:52,140 --> 00:03:53,340
type of shell

103
00:03:53,340 --> 00:03:54,959
pretty straightforward everything is

104
00:03:54,959 --> 00:03:57,540
text based you can have fun with the

105
00:03:57,540 --> 00:03:59,159
colors as I like to do there that those

106
00:03:59,159 --> 00:04:01,500
are my color settings

107
00:04:01,500 --> 00:04:03,720
and let's see the nice things about the

108
00:04:03,720 --> 00:04:04,860
command shell

109
00:04:04,860 --> 00:04:07,500
it offers help and help can be very

110
00:04:07,500 --> 00:04:09,659
beneficial and it can be very helpful

111
00:04:09,659 --> 00:04:12,000
but

112
00:04:12,000 --> 00:04:14,220
it depends on the author you do not have

113
00:04:14,220 --> 00:04:15,780
to write any help for the scripts that

114
00:04:15,780 --> 00:04:16,798
you write

115
00:04:16,798 --> 00:04:18,418
I can write a script I can share with

116
00:04:18,418 --> 00:04:19,798
the world and it doesn't have to provide

117
00:04:19,798 --> 00:04:22,019
any help at all there are a lot of good

118
00:04:22,019 --> 00:04:23,639
examples of helping a lot of the scripts

119
00:04:23,639 --> 00:04:25,680
being written and that's how I base my

120
00:04:25,680 --> 00:04:27,240
work

121
00:04:27,240 --> 00:04:29,160
but you don't have to and you may run

122
00:04:29,160 --> 00:04:32,220
into scripts that don't offer any help

123
00:04:32,220 --> 00:04:34,380
the other thing you will like you will

124
00:04:34,380 --> 00:04:35,759
want to get used to is what they call

125
00:04:35,759 --> 00:04:38,880
tab complete tap completion

126
00:04:38,880 --> 00:04:40,620
if you can't quite remember the command

127
00:04:40,620 --> 00:04:43,020
start typing it start pressing the tab

128
00:04:43,020 --> 00:04:44,580
and it'll cycle you through it if

129
00:04:44,580 --> 00:04:45,840
there's only one possible I'm going to

130
00:04:45,840 --> 00:04:48,240
bring that one up if you uh if there are

131
00:04:48,240 --> 00:04:49,800
a couple different possibilities you can

132
00:04:49,800 --> 00:04:51,900
get a kind of a cycle through the list

133
00:04:51,900 --> 00:04:55,680
of that and you can also do shifts to go

134
00:04:55,680 --> 00:04:57,780
backwards if you think the command might

135
00:04:57,780 --> 00:04:58,740
have been down the bottom of the list

136
00:04:58,740 --> 00:05:01,639
you can press shift tab

137
00:05:03,180 --> 00:05:05,040
feel free if you have any other

138
00:05:05,040 --> 00:05:08,479
questions let's see

139
00:05:11,160 --> 00:05:13,699
now

140
00:05:16,320 --> 00:05:17,820
part of the reason I like to work with

141
00:05:17,820 --> 00:05:19,860
the command shell as opposed to the ISE

142
00:05:19,860 --> 00:05:22,620
is it does a few things differently

143
00:05:22,620 --> 00:05:24,720
and if you're going to turn your work

144
00:05:24,720 --> 00:05:26,639
into a script and let other people run

145
00:05:26,639 --> 00:05:29,220
it or run it yourself you will probably

146
00:05:29,220 --> 00:05:31,919
want to run it in the command shell

147
00:05:31,919 --> 00:05:34,380
memory management is different

148
00:05:34,380 --> 00:05:36,360
and there are some features that are not

149
00:05:36,360 --> 00:05:38,639
available in the ISE like this idea of

150
00:05:38,639 --> 00:05:41,820
the transcripts you can have Powershell

151
00:05:41,820 --> 00:05:43,139
record everything you're doing and

152
00:05:43,139 --> 00:05:44,940
everything is getting back just like the

153
00:05:44,940 --> 00:05:47,220
log of any other thing your SSH can log

154
00:05:47,220 --> 00:05:50,039
output rule Powershell can log the

155
00:05:50,039 --> 00:05:51,660
output as well but that's not available

156
00:05:51,660 --> 00:05:54,979
in the ISE version

157
00:05:55,620 --> 00:05:57,900
and once again administrator level

158
00:05:57,900 --> 00:05:59,940
access will pop up on you every now and

159
00:05:59,940 --> 00:06:01,199
then depending on what you're trying to

160
00:06:01,199 --> 00:06:04,800
do depending on the execution policies

161
00:06:04,800 --> 00:06:07,860
depending on the profiles uh if you're

162
00:06:07,860 --> 00:06:09,180
at work you may not be able to do what

163
00:06:09,180 --> 00:06:10,620
you'd like to do without permissions and

164
00:06:10,620 --> 00:06:13,440
if you're at home on your own laptop

165
00:06:13,440 --> 00:06:17,419
you can do anything you want

166
00:06:18,720 --> 00:06:21,120
I mentioned the profiles there are at

167
00:06:21,120 --> 00:06:23,639
least six profiles

168
00:06:23,639 --> 00:06:26,400
they cover different combinations all

169
00:06:26,400 --> 00:06:29,280
users all hosts all users on the current

170
00:06:29,280 --> 00:06:30,660
host

171
00:06:30,660 --> 00:06:33,660
current user and you want to view on all

172
00:06:33,660 --> 00:06:35,479
hosts or the current user current host

173
00:06:35,479 --> 00:06:38,280
these are just different ways of

174
00:06:38,280 --> 00:06:40,380
controlling Powershell in an

175
00:06:40,380 --> 00:06:42,000
environments if you're on your own it's

176
00:06:42,000 --> 00:06:44,520
really your choice what you do how you

177
00:06:44,520 --> 00:06:47,460
configure your profiles if you are in a

178
00:06:47,460 --> 00:06:48,720
corporate environment you may find

179
00:06:48,720 --> 00:06:50,340
certain things are allowed and certain

180
00:06:50,340 --> 00:06:53,119
things are restricted

181
00:06:53,759 --> 00:06:55,319
if you'd like more information there are

182
00:06:55,319 --> 00:06:57,000
a lot of good Pages out there here is

183
00:06:57,000 --> 00:06:58,500
one in particular

184
00:06:58,500 --> 00:07:01,560
uh it is Microsoft's own

185
00:07:01,560 --> 00:07:03,300
it'll give you more details on the

186
00:07:03,300 --> 00:07:04,740
different profiles where you can find

187
00:07:04,740 --> 00:07:07,259
them what they might do for you how they

188
00:07:07,259 --> 00:07:09,919
all interact

189
00:07:11,699 --> 00:07:14,160
any questions feel free there will be

190
00:07:14,160 --> 00:07:16,770
some Show and Tell in a few moments

191
00:07:16,770 --> 00:07:18,060
[Music]

192
00:07:18,060 --> 00:07:23,099
now we get into the most beneficial

193
00:07:23,099 --> 00:07:25,139
Powershell supports this idea of an

194
00:07:25,139 --> 00:07:27,000
alias I imagine you all have heard that

195
00:07:27,000 --> 00:07:28,800
term before it's just one name for

196
00:07:28,800 --> 00:07:29,880
something else a different name for

197
00:07:29,880 --> 00:07:30,960
something else

198
00:07:30,960 --> 00:07:32,819
so for example those of you who are

199
00:07:32,819 --> 00:07:35,039
familiar with the Linux or Unix World

200
00:07:35,039 --> 00:07:39,479
you've probably heard the uh command cat

201
00:07:39,479 --> 00:07:41,280
I was always told that stupid catalog

202
00:07:41,280 --> 00:07:45,000
but anyway on the old DOS commands type

203
00:07:45,000 --> 00:07:46,979
in Powershell that would be the

204
00:07:46,979 --> 00:07:50,419
equivalent of get contents

205
00:07:50,419 --> 00:07:54,780
CD or change directory chdir is set

206
00:07:54,780 --> 00:07:56,160
location

207
00:07:56,160 --> 00:07:58,380
if you want to delete or erase

208
00:07:58,380 --> 00:08:00,060
that's the equivalent of removing an

209
00:08:00,060 --> 00:08:01,620
item and all these things there are many

210
00:08:01,620 --> 00:08:02,880
more all these things can be listed

211
00:08:02,880 --> 00:08:04,680
anytime from the command line or from

212
00:08:04,680 --> 00:08:08,699
the ISE and we'll do that in a moments

213
00:08:08,699 --> 00:08:12,660
a larger list are the get command

214
00:08:12,660 --> 00:08:14,639
function

215
00:08:14,639 --> 00:08:16,380
it will show you all the functions all

216
00:08:16,380 --> 00:08:18,000
the commandlets there is a bit of a

217
00:08:18,000 --> 00:08:19,560
difference there

218
00:08:19,560 --> 00:08:22,979
and it will also again list the aliases

219
00:08:22,979 --> 00:08:25,979
just like a moment ago when you get your

220
00:08:25,979 --> 00:08:28,280
list

221
00:08:31,690 --> 00:08:33,779
[Music]

222
00:08:33,779 --> 00:08:36,719
lots of things scrolling by

223
00:08:36,719 --> 00:08:40,500
they are organized first by the type

224
00:08:40,500 --> 00:08:42,059
like commandlet

225
00:08:42,059 --> 00:08:44,339
function alias

226
00:08:44,339 --> 00:08:46,860
gives you the name of the commandlet or

227
00:08:46,860 --> 00:08:48,779
function or Alias and the versions and

228
00:08:48,779 --> 00:08:50,820
where it came from the module or the bit

229
00:08:50,820 --> 00:08:53,040
of Microsoft code that gives you that

230
00:08:53,040 --> 00:08:55,339
ability

231
00:08:57,480 --> 00:08:59,339
thank you

232
00:08:59,339 --> 00:09:00,899
so an example I have here on the screen

233
00:09:00,899 --> 00:09:02,640
was simply the clear host you all have

234
00:09:02,640 --> 00:09:05,040
heard CLS or clear command these

235
00:09:05,040 --> 00:09:06,060
different commands on different

236
00:09:06,060 --> 00:09:07,200
platforms

237
00:09:07,200 --> 00:09:09,959
that would be clear screen or clear host

238
00:09:09,959 --> 00:09:13,260
but you can type in any of those

239
00:09:13,260 --> 00:09:16,320
the functions generally are meant to be

240
00:09:16,320 --> 00:09:18,600
uh probably part of a script more than

241
00:09:18,600 --> 00:09:20,040
anything else not necessarily a command

242
00:09:20,040 --> 00:09:21,839
line whereas what they call a commandlet

243
00:09:21,839 --> 00:09:24,540
is its own little utility if you will

244
00:09:24,540 --> 00:09:26,700
so it's more something more likely to be

245
00:09:26,700 --> 00:09:27,839
used from the command line but I'm not

246
00:09:27,839 --> 00:09:29,640
aware of any restrictions I'm not aware

247
00:09:29,640 --> 00:09:32,720
of anything that limits you

248
00:09:36,600 --> 00:09:38,399
one thing I really like about Powershell

249
00:09:38,399 --> 00:09:40,620
and why I would recommend learning it

250
00:09:40,620 --> 00:09:43,260
it gives you access to just about

251
00:09:43,260 --> 00:09:47,580
everything on box it is almost visual C

252
00:09:47,580 --> 00:09:49,980
plus plus a command line as opposed to

253
00:09:49,980 --> 00:09:52,860
having the script entire programs you

254
00:09:52,860 --> 00:09:54,480
can do a lot of things right at the

255
00:09:54,480 --> 00:09:56,399
command line

256
00:09:56,399 --> 00:09:58,680
you can look at the settings of the

257
00:09:58,680 --> 00:10:01,440
environments uh here's the dir command

258
00:10:01,440 --> 00:10:06,140
or LS command or get child item command

259
00:10:11,470 --> 00:10:14,580
[Music]

260
00:10:17,279 --> 00:10:18,839
people familiar with command line or

261
00:10:18,839 --> 00:10:20,519
shell might be familiar with some of

262
00:10:20,519 --> 00:10:21,750
these different settings

263
00:10:21,750 --> 00:10:24,240
[Music]

264
00:10:24,240 --> 00:10:26,160
you can find out different paths where

265
00:10:26,160 --> 00:10:28,019
things can be stored where things will

266
00:10:28,019 --> 00:10:29,820
be stored like your temp folders

267
00:10:29,820 --> 00:10:32,040
if you want to make use of the temp or

268
00:10:32,040 --> 00:10:36,240
TMP variable that's where it points

269
00:10:36,240 --> 00:10:38,640
the user domain user domain roaming

270
00:10:38,640 --> 00:10:40,019
profile you can see what kind of network

271
00:10:40,019 --> 00:10:42,300
you're on

272
00:10:42,300 --> 00:10:45,500
the windows directory

273
00:10:49,800 --> 00:10:52,740
and the hive the registry

274
00:10:52,740 --> 00:10:55,920
's hives are accessible right there on

275
00:10:55,920 --> 00:10:59,240
the command line again

276
00:11:00,220 --> 00:11:03,309
[Music]

277
00:11:09,260 --> 00:11:12,600
hkcu stands for the current user

278
00:11:12,600 --> 00:11:14,459
you can

279
00:11:14,459 --> 00:11:15,690
work your way down

280
00:11:15,690 --> 00:11:18,819
[Music]

281
00:11:19,740 --> 00:11:22,260
and it will keep on going if you have

282
00:11:22,260 --> 00:11:23,339
permissions

283
00:11:23,339 --> 00:11:24,959
because there's a lot in this life if

284
00:11:24,959 --> 00:11:26,279
you have permissions you can change

285
00:11:26,279 --> 00:11:28,260
these things if you have permissions you

286
00:11:28,260 --> 00:11:28,920
can

287
00:11:28,920 --> 00:11:31,320
delete the settings you can create new

288
00:11:31,320 --> 00:11:33,180
settings if they have not been created

289
00:11:33,180 --> 00:11:34,260
already

290
00:11:34,260 --> 00:11:36,660
right there on the command line it just

291
00:11:36,660 --> 00:11:39,000
depends on your permissions your

292
00:11:39,000 --> 00:11:41,959
authorization level

293
00:11:43,560 --> 00:11:44,880
okay

294
00:11:44,880 --> 00:11:47,220
my apologies I am kind of zooming

295
00:11:47,220 --> 00:11:50,300
through some of this stuff um

296
00:11:53,160 --> 00:11:56,940
I'll show again the uh tab you do want

297
00:11:56,940 --> 00:12:00,740
to get used to the tab itself

298
00:12:01,140 --> 00:12:05,060
if I bring up the hkcu

299
00:12:05,579 --> 00:12:08,779
it will start to list

300
00:12:09,060 --> 00:12:11,579
the areas below that I can work my way

301
00:12:11,579 --> 00:12:13,819
into

302
00:12:13,860 --> 00:12:17,959
I can shift and tab backwards

303
00:12:21,120 --> 00:12:23,839
I believe

304
00:12:26,579 --> 00:12:28,380
if you're not sure where you're going if

305
00:12:28,380 --> 00:12:29,940
you're not sure exactly how to spell it

306
00:12:29,940 --> 00:12:33,320
try the tab command

307
00:12:40,860 --> 00:12:44,700
another area this is confusing sometimes

308
00:12:44,700 --> 00:12:45,959
um

309
00:12:45,959 --> 00:12:50,119
the good old execution policy

310
00:12:56,279 --> 00:12:57,839
there are various different levels I'll

311
00:12:57,839 --> 00:12:59,100
get to in just a moment right now it

312
00:12:59,100 --> 00:13:03,660
says for example I am restricted

313
00:13:05,579 --> 00:13:07,019
this is the default policy for the

314
00:13:07,019 --> 00:13:09,420
windows clients

315
00:13:09,420 --> 00:13:11,339
I'm allowed individual commands but I'm

316
00:13:11,339 --> 00:13:13,980
not allowed to run scripts at this uh at

317
00:13:13,980 --> 00:13:16,860
this time which is rather surprising to

318
00:13:16,860 --> 00:13:19,620
me considering it's my own laptop but

319
00:13:19,620 --> 00:13:21,600
I have not gotten in here to mess with

320
00:13:21,600 --> 00:13:24,860
these various settings

321
00:13:31,440 --> 00:13:35,040
there are different execution policy

322
00:13:35,040 --> 00:13:37,500
types there's machine policy user policy

323
00:13:37,500 --> 00:13:39,300
process policy

324
00:13:39,300 --> 00:13:42,420
all of these will have an impact on

325
00:13:42,420 --> 00:13:44,880
your ability to get your job done

326
00:13:44,880 --> 00:13:48,060
to run things you want to run

327
00:13:48,060 --> 00:13:50,480
if as you see here

328
00:13:50,480 --> 00:13:53,040
four of them are undefined

329
00:13:53,040 --> 00:13:55,740
it will default down into whichever one

330
00:13:55,740 --> 00:13:57,899
isn't and it will work off of that

331
00:13:57,899 --> 00:14:01,579
policy which is why I'm restricted

332
00:14:04,500 --> 00:14:07,200
back to the different policy values I

333
00:14:07,200 --> 00:14:09,959
mentioned the restricted all signed

334
00:14:09,959 --> 00:14:12,120
you can run scripts but every script

335
00:14:12,120 --> 00:14:14,820
must be signed even scripts you write

336
00:14:14,820 --> 00:14:17,279
yourself they must be digitally signed

337
00:14:17,279 --> 00:14:20,160
with an accepted certificate

338
00:14:20,160 --> 00:14:22,200
remote signs a little bit different it's

339
00:14:22,200 --> 00:14:26,660
the default policy for Windows servers

340
00:14:26,660 --> 00:14:29,339
only the scripts from remote systems

341
00:14:29,339 --> 00:14:31,380
would have to be signed scripts that you

342
00:14:31,380 --> 00:14:32,820
brought down to the box would have to be

343
00:14:32,820 --> 00:14:33,720
signed

344
00:14:33,720 --> 00:14:37,100
others do not need to be

345
00:14:37,980 --> 00:14:40,740
a few more possibilities unrestricted

346
00:14:40,740 --> 00:14:42,779
default for most non-windows computers

347
00:14:42,779 --> 00:14:45,060
if you're running Powershell on Linux

348
00:14:45,060 --> 00:14:47,100
which you can do nowadays

349
00:14:47,100 --> 00:14:48,600
you're going to get an unrestricted

350
00:14:48,600 --> 00:14:52,399
which lets you do pretty much everything

351
00:14:53,160 --> 00:14:55,320
if you have the ability you can set the

352
00:14:55,320 --> 00:14:57,060
execution policy temporarily to

353
00:14:57,060 --> 00:14:59,459
something like bypass it will let you do

354
00:14:59,459 --> 00:15:01,380
what you want to do nothing but blocked

355
00:15:01,380 --> 00:15:04,980
but you won't get any warnings either

356
00:15:04,980 --> 00:15:06,959
if you run a script and it hoses up your

357
00:15:06,959 --> 00:15:09,138
system

358
00:15:09,660 --> 00:15:12,620
start rebuilding

359
00:15:13,079 --> 00:15:15,360
and undefined means exactly that no

360
00:15:15,360 --> 00:15:17,160
policy has been defined if things are

361
00:15:17,160 --> 00:15:18,720
undefined then it will ignore those and

362
00:15:18,720 --> 00:15:20,940
look at the other policies in

363
00:15:20,940 --> 00:15:23,040
an order until it finds one that is

364
00:15:23,040 --> 00:15:25,760
applicable

365
00:15:26,339 --> 00:15:28,920
I like to point out these are not really

366
00:15:28,920 --> 00:15:31,079
security they're not going to stop

367
00:15:31,079 --> 00:15:32,940
everybody

368
00:15:32,940 --> 00:15:34,860
they'll slow down the honest computer

369
00:15:34,860 --> 00:15:36,240
user but there are ways of getting

370
00:15:36,240 --> 00:15:38,160
around them

371
00:15:38,160 --> 00:15:39,500
um

372
00:15:39,500 --> 00:15:41,940
that's part of what red teaming and blue

373
00:15:41,940 --> 00:15:44,699
team is about finding the waves around

374
00:15:44,699 --> 00:15:47,699
uh I mentioned with the restricted I

375
00:15:47,699 --> 00:15:50,760
believe it was you can't run a script

376
00:15:50,760 --> 00:15:52,500
it's awkward but you could take each

377
00:15:52,500 --> 00:15:54,420
command one at a time and type it in the

378
00:15:54,420 --> 00:15:55,620
command line

379
00:15:55,620 --> 00:15:57,060
and probably still get the results you

380
00:15:57,060 --> 00:15:57,959
want

381
00:15:57,959 --> 00:16:00,450
depending on the detail of the script

382
00:16:00,450 --> 00:16:02,220
[Music]

383
00:16:02,220 --> 00:16:05,220
there are also

384
00:16:05,220 --> 00:16:07,320
was it was like not Powershell I'm

385
00:16:07,320 --> 00:16:09,120
trying to think of the things people had

386
00:16:09,120 --> 00:16:10,440
put together basically another

387
00:16:10,440 --> 00:16:12,180
executable which gave you all the

388
00:16:12,180 --> 00:16:14,579
ability of Powershell but it wasn't

389
00:16:14,579 --> 00:16:16,620
recognized as Powershell

390
00:16:16,620 --> 00:16:18,360
and so if you could bring that onto the

391
00:16:18,360 --> 00:16:21,180
Box during your penetration test or your

392
00:16:21,180 --> 00:16:23,399
hack you could still run your scripts

393
00:16:23,399 --> 00:16:24,360
because

394
00:16:24,360 --> 00:16:25,800
Windows didn't understand that it was

395
00:16:25,800 --> 00:16:28,160
Powershell

396
00:16:29,699 --> 00:16:32,040
so as I said here these are really much

397
00:16:32,040 --> 00:16:33,839
more idiot-proofing than anything else

398
00:16:33,839 --> 00:16:35,699
though they'll slow down the honest

399
00:16:35,699 --> 00:16:36,720
folks

400
00:16:36,720 --> 00:16:38,519
but there is usually a way to get around

401
00:16:38,519 --> 00:16:41,540
it if you really want to

402
00:16:46,199 --> 00:16:47,339
now we're going to talk a little bit

403
00:16:47,339 --> 00:16:50,240
about modules

404
00:16:50,540 --> 00:16:53,100
how do you find out what's on your

405
00:16:53,100 --> 00:16:54,600
system

406
00:16:54,600 --> 00:16:58,459
get module or GMO

407
00:16:58,500 --> 00:17:00,300
we'll list out the modules that came

408
00:17:00,300 --> 00:17:01,620
right here that's pretty much out of the

409
00:17:01,620 --> 00:17:04,380
box I haven't modified this one

410
00:17:04,380 --> 00:17:06,780
starts to give you a list of the

411
00:17:06,780 --> 00:17:08,579
exported commands which means the

412
00:17:08,579 --> 00:17:12,020
functions and the Commandments

413
00:17:14,520 --> 00:17:16,559
yeah it's going to scroll off the screen

414
00:17:16,559 --> 00:17:19,079
verbose will give you more detail but I

415
00:17:19,079 --> 00:17:20,520
think in this case it's scrolling off to

416
00:17:20,520 --> 00:17:22,079
the right side of the screen so you

417
00:17:22,079 --> 00:17:23,939
still can't see it

418
00:17:23,939 --> 00:17:25,919
thank you

419
00:17:25,919 --> 00:17:27,720
if you have a module somebody else is

420
00:17:27,720 --> 00:17:29,160
written and you want to import it there

421
00:17:29,160 --> 00:17:31,460
you go

422
00:17:32,040 --> 00:17:33,780
if you want to remove modules from

423
00:17:33,780 --> 00:17:34,980
memory

424
00:17:34,980 --> 00:17:36,960
pretty obvious

425
00:17:36,960 --> 00:17:40,559
and one nice thing about the get command

426
00:17:40,559 --> 00:17:43,860
and you can ask it what module gave me

427
00:17:43,860 --> 00:17:46,039
this

428
00:17:58,080 --> 00:18:01,020
the PS Reliant module gives me one

429
00:18:01,020 --> 00:18:03,240
function in those five Commandments

430
00:18:03,240 --> 00:18:04,980
wow

431
00:18:04,980 --> 00:18:06,960
if you are bringing down some module

432
00:18:06,960 --> 00:18:08,160
somebody else has written you might want

433
00:18:08,160 --> 00:18:10,140
to take a look before running it to see

434
00:18:10,140 --> 00:18:12,000
what it offers you and we're familiar

435
00:18:12,000 --> 00:18:14,299
with it

436
00:18:23,580 --> 00:18:26,580
Now we move on to help as I mentioned

437
00:18:26,580 --> 00:18:28,980
previously though it is up to the author

438
00:18:28,980 --> 00:18:31,740
of the code how much help they've

439
00:18:31,740 --> 00:18:34,760
provided you

440
00:18:38,280 --> 00:18:41,100
a lot of the professionally written ones

441
00:18:41,100 --> 00:18:43,140
will give you some

442
00:18:43,140 --> 00:18:44,520
syntax

443
00:18:44,520 --> 00:18:48,840
not always the most clear in my opinion

444
00:18:48,840 --> 00:18:51,120
by better than nothing you see the Alias

445
00:18:51,120 --> 00:18:52,320
is listed down there in this case

446
00:18:52,320 --> 00:18:54,780
there's only the one really GCM kit

447
00:18:54,780 --> 00:18:56,820
command

448
00:18:56,820 --> 00:18:59,780
if offered

449
00:19:03,960 --> 00:19:05,059
yeah

450
00:19:05,059 --> 00:19:09,720
no uh no examples are given you can

451
00:19:09,720 --> 00:19:11,820
ask it to give you examples you can ask

452
00:19:11,820 --> 00:19:15,020
it to give you the full list

453
00:19:16,500 --> 00:19:18,179
explains the parameters a little bit

454
00:19:18,179 --> 00:19:19,860
more

455
00:19:19,860 --> 00:19:22,380
the all parameter what type it is

456
00:19:22,380 --> 00:19:25,220
position

457
00:19:25,260 --> 00:19:26,480
argument list

458
00:19:26,480 --> 00:19:29,579
[Music]

459
00:19:32,580 --> 00:19:34,440
I'm throwing a lot at you I realize

460
00:19:34,440 --> 00:19:35,280
that's

461
00:19:35,280 --> 00:19:35,820
um

462
00:19:35,820 --> 00:19:37,140
if you have any questions you want to

463
00:19:37,140 --> 00:19:39,840
see anything again let me know

464
00:19:39,840 --> 00:19:42,439
question

465
00:19:53,340 --> 00:19:55,200
okay I don't think I don't know if I

466
00:19:55,200 --> 00:19:57,799
remember that one

467
00:19:59,100 --> 00:20:00,419
I don't think I remember that one very

468
00:20:00,419 --> 00:20:03,080
good all right

469
00:20:07,440 --> 00:20:08,760
okay

470
00:20:08,760 --> 00:20:11,280
and you know here's another good example

471
00:20:11,280 --> 00:20:13,320
tab complete

472
00:20:13,320 --> 00:20:14,940
you want to know what parameters are

473
00:20:14,940 --> 00:20:18,799
available to you start pressing the tab

474
00:20:21,539 --> 00:20:24,780
I guess had I gone through

475
00:20:24,780 --> 00:20:26,340
yeah there it was

476
00:20:26,340 --> 00:20:29,460
I did not remember that one

477
00:20:29,460 --> 00:20:30,780
there's your post I'll work with that

478
00:20:30,780 --> 00:20:31,679
one a lot

479
00:20:31,679 --> 00:20:33,360
shift tab will work your way back

480
00:20:33,360 --> 00:20:35,160
through

481
00:20:35,160 --> 00:20:37,260
that was the examples I mentioned full

482
00:20:37,260 --> 00:20:38,760
so we're looking at right here on the

483
00:20:38,760 --> 00:20:41,240
screen right now

484
00:20:48,360 --> 00:20:50,220
yeah okay that's right it's trying to

485
00:20:50,220 --> 00:20:52,080
remember uh you can

486
00:20:52,080 --> 00:20:54,299
get it to explain what happens when an

487
00:20:54,299 --> 00:20:56,700
error happens

488
00:20:56,700 --> 00:20:58,020
you're trying to remember this one I

489
00:20:58,020 --> 00:21:01,100
have not worked with very much

490
00:21:02,450 --> 00:21:05,509
[Music]

491
00:21:09,360 --> 00:21:12,000
as you can see there is a lot GCM can do

492
00:21:12,000 --> 00:21:14,360
for you

493
00:21:18,480 --> 00:21:20,660
thank you

494
00:21:31,980 --> 00:21:34,260
so ran you through you do help in the

495
00:21:34,260 --> 00:21:36,120
command and ex for example sort of help

496
00:21:36,120 --> 00:21:38,220
command and the full which will give you

497
00:21:38,220 --> 00:21:39,600
every Last Detail that it has available

498
00:21:39,600 --> 00:21:41,400
to you

499
00:21:41,400 --> 00:21:43,860
but it will depend on the code AS

500
00:21:43,860 --> 00:21:45,659
written by the person if they provided

501
00:21:45,659 --> 00:21:47,880
you help you're you're fortunate if you

502
00:21:47,880 --> 00:21:49,700
provided you a lot of help

503
00:21:49,700 --> 00:21:51,840
but they don't have to

504
00:21:51,840 --> 00:21:54,539
the command scripts can be very sweet

505
00:21:54,539 --> 00:21:57,620
very short

506
00:21:59,580 --> 00:22:01,919
so how do you run your script so there

507
00:22:01,919 --> 00:22:04,140
are two main ways

508
00:22:04,140 --> 00:22:06,120
if the script is basically designed

509
00:22:06,120 --> 00:22:09,299
Standalone just to do its thing all you

510
00:22:09,299 --> 00:22:11,460
have to do is name the script

511
00:22:11,460 --> 00:22:13,559
and it will start with whatever module

512
00:22:13,559 --> 00:22:15,360
whatever function in the code has been

513
00:22:15,360 --> 00:22:18,059
designated as the starting points

514
00:22:18,059 --> 00:22:19,919
and it provides you with a menu or

515
00:22:19,919 --> 00:22:22,740
provides you with output right away

516
00:22:22,740 --> 00:22:25,380
if it is a more involved module and it

517
00:22:25,380 --> 00:22:27,419
might have several functions several

518
00:22:27,419 --> 00:22:29,460
commandlets built into it

519
00:22:29,460 --> 00:22:31,919
Imports of the module

520
00:22:31,919 --> 00:22:34,200
and from that point forward you can now

521
00:22:34,200 --> 00:22:36,179
use any of those commands until you

522
00:22:36,179 --> 00:22:38,840
remove that module

523
00:22:45,059 --> 00:22:47,159
all right I mentioned I thought it was

524
00:22:47,159 --> 00:22:49,440
funny I mentioned in the uh

525
00:22:49,440 --> 00:22:52,880
opening talk

526
00:22:53,340 --> 00:22:55,980
there are a lot of good scripts out

527
00:22:55,980 --> 00:22:57,780
there I guess I say be careful some of

528
00:22:57,780 --> 00:22:59,340
the other scripts as well but there are

529
00:22:59,340 --> 00:23:01,620
a lot of good ones the Power view is one

530
00:23:01,620 --> 00:23:04,200
I first remembered power scan I think I

531
00:23:04,200 --> 00:23:07,380
noticed on his presentation

532
00:23:07,380 --> 00:23:09,120
and there are a few others was there

533
00:23:09,120 --> 00:23:11,159
even a power sploit I think don't know

534
00:23:11,159 --> 00:23:12,539
if that one's still being maintained or

535
00:23:12,539 --> 00:23:13,260
not

536
00:23:13,260 --> 00:23:15,480
but the power of you gave you a lot of

537
00:23:15,480 --> 00:23:19,020
net commands written in Powershell

538
00:23:19,020 --> 00:23:21,059
someone else had put together the power

539
00:23:21,059 --> 00:23:23,340
can't script you can probably get your

540
00:23:23,340 --> 00:23:25,200
hands on anyone here familiar with

541
00:23:25,200 --> 00:23:27,419
netcat or NC

542
00:23:27,419 --> 00:23:28,919
I would imagine a lot of you have heard

543
00:23:28,919 --> 00:23:30,179
it's been around for a couple decades

544
00:23:30,179 --> 00:23:32,280
now well someone wrote power account

545
00:23:32,280 --> 00:23:34,799
which is netcat in Powershell

546
00:23:34,799 --> 00:23:36,900
and quite handy

547
00:23:36,900 --> 00:23:38,460
on one

548
00:23:38,460 --> 00:23:40,140
one role I was in where I was basically

549
00:23:40,140 --> 00:23:43,020
the outside red team member uh I just

550
00:23:43,020 --> 00:23:44,940
opened up connections between boxes to

551
00:23:44,940 --> 00:23:46,679
see when the Cyber defense guys finally

552
00:23:46,679 --> 00:23:48,240
noticed that these two boxes are talking

553
00:23:48,240 --> 00:23:50,760
on a database support and they shouldn't

554
00:23:50,760 --> 00:23:53,840
be because of both workstations

555
00:23:54,419 --> 00:23:57,360
and we did also relay some data through

556
00:23:57,360 --> 00:24:00,299
with two uh tunnels from A to B to C

557
00:24:00,299 --> 00:24:02,400
using power cat since we had access to

558
00:24:02,400 --> 00:24:05,419
windows boxes

559
00:24:08,880 --> 00:24:11,039
and where I'm at now

560
00:24:11,039 --> 00:24:12,299
um

561
00:24:12,299 --> 00:24:15,299
I often have written tools where I've

562
00:24:15,299 --> 00:24:17,780
needed them

563
00:24:17,820 --> 00:24:20,460
previous roles I've been in I wrote a

564
00:24:20,460 --> 00:24:22,860
script I just called Wander you start it

565
00:24:22,860 --> 00:24:25,140
at a share on a network drive for

566
00:24:25,140 --> 00:24:26,400
example and it will work its way into

567
00:24:26,400 --> 00:24:28,500
every folder okay let's keep trying and

568
00:24:28,500 --> 00:24:31,200
until it can't go any further was

569
00:24:31,200 --> 00:24:33,380
designed so that it would look for files

570
00:24:33,380 --> 00:24:35,960
perhaps by the name or by the extension

571
00:24:35,960 --> 00:24:38,700
and it has a basic searching ability in

572
00:24:38,700 --> 00:24:40,080
it

573
00:24:40,080 --> 00:24:41,280
so that I could look for certain

574
00:24:41,280 --> 00:24:43,620
keywords and I did find documents and I

575
00:24:43,620 --> 00:24:45,600
did find spreadsheets that had accounts

576
00:24:45,600 --> 00:24:47,520
and passwords and they did not always

577
00:24:47,520 --> 00:24:50,100
work but a lot of them did

578
00:24:50,100 --> 00:24:52,500
and let's see this was a simple web

579
00:24:52,500 --> 00:24:54,299
server here on the screen that I was

580
00:24:54,299 --> 00:24:55,440
showing you

581
00:24:55,440 --> 00:24:56,880
uh it's not much more than what you're

582
00:24:56,880 --> 00:24:58,380
looking at right there

583
00:24:58,380 --> 00:25:01,200
but it simply listens on a ports I think

584
00:25:01,200 --> 00:25:03,240
I picked 8080 in this case

585
00:25:03,240 --> 00:25:04,799
because it's basically running on my

586
00:25:04,799 --> 00:25:06,659
workstation work

587
00:25:06,659 --> 00:25:08,760
and I use this for some of my what I

588
00:25:08,760 --> 00:25:11,460
like to call my cheat sheets uh as I'm

589
00:25:11,460 --> 00:25:13,320
working in Linux or Powershell or

590
00:25:13,320 --> 00:25:14,880
whatever you've got commands you use

591
00:25:14,880 --> 00:25:16,200
again and again again

592
00:25:16,200 --> 00:25:17,760
but you may not remember all the

593
00:25:17,760 --> 00:25:18,960
parameters you may not remember how you

594
00:25:18,960 --> 00:25:20,760
like to use it so I put together a cheat

595
00:25:20,760 --> 00:25:22,919
sheet and I put together the simple web

596
00:25:22,919 --> 00:25:25,440
server they're static but it's good

597
00:25:25,440 --> 00:25:26,880
enough for me that's all I need I don't

598
00:25:26,880 --> 00:25:30,380
need to have a complete web server

599
00:25:31,400 --> 00:25:34,500
I did some passwords spraying on one job

600
00:25:34,500 --> 00:25:36,360
that was a lot of fun if you're not

601
00:25:36,360 --> 00:25:37,679
familiar with that term you take one

602
00:25:37,679 --> 00:25:39,659
password and you throw it against maybe

603
00:25:39,659 --> 00:25:41,400
100 different counts to see if anything

604
00:25:41,400 --> 00:25:43,320
matched then you maybe wait a couple

605
00:25:43,320 --> 00:25:44,100
hours

606
00:25:44,100 --> 00:25:45,779
I had a lot of fun that was that was

607
00:25:45,779 --> 00:25:47,340
quite quite the adventure I can tell you

608
00:25:47,340 --> 00:25:49,080
a lot about passwords that organizations

609
00:25:49,080 --> 00:25:51,360
use and the tendency of people to use

610
00:25:51,360 --> 00:25:52,679
the same password

611
00:25:52,679 --> 00:25:55,260
across different networks or let's see

612
00:25:55,260 --> 00:25:57,000
if you um

613
00:25:57,000 --> 00:26:00,539
if you know the idea of the keyboard War

614
00:26:00,539 --> 00:26:03,000
anybody familiar with that it's not so

615
00:26:03,000 --> 00:26:05,220
much a word or phrase you just go up and

616
00:26:05,220 --> 00:26:07,440
down the rows or maybe go across those

617
00:26:07,440 --> 00:26:08,820
keyboard blocks you just kind of follow

618
00:26:08,820 --> 00:26:10,020
pattern

619
00:26:10,020 --> 00:26:12,240
well just imagine basically one down as

620
00:26:12,240 --> 00:26:14,400
I call it although you actually yeah you

621
00:26:14,400 --> 00:26:16,559
start with the number and then maybe two

622
00:26:16,559 --> 00:26:18,600
up and three down and four yeah I found

623
00:26:18,600 --> 00:26:19,679
those

624
00:26:19,679 --> 00:26:21,539
and I found the inverse of that people

625
00:26:21,539 --> 00:26:24,600
being clever they start at the bottom

626
00:26:24,600 --> 00:26:26,460
and I also found that when people were

627
00:26:26,460 --> 00:26:29,640
done with using one down two and the

628
00:26:29,640 --> 00:26:31,559
expired they just moved over

629
00:26:31,559 --> 00:26:33,980
so

630
00:26:35,580 --> 00:26:38,100
we had a lot of fun and our ciso was

631
00:26:38,100 --> 00:26:39,539
getting tired of reading how we easily

632
00:26:39,539 --> 00:26:41,940
cracked passwords

633
00:26:41,940 --> 00:26:43,799
so but yeah we often started an

634
00:26:43,799 --> 00:26:45,059
assessment we already had accounts to

635
00:26:45,059 --> 00:26:47,640
try so that was a script written in

636
00:26:47,640 --> 00:26:48,720
Powershell

637
00:26:48,720 --> 00:26:52,220
had to leave that one behind though

638
00:26:53,159 --> 00:26:57,360
and I do apologize boy I guess I um I

639
00:26:57,360 --> 00:26:58,320
thought there might be a little more

640
00:26:58,320 --> 00:27:00,779
questions a little more interaction

641
00:27:00,779 --> 00:27:02,700
I guess I've kind of gone fast but we're

642
00:27:02,700 --> 00:27:04,679
basically down to the Q a I'm sorry

643
00:27:04,679 --> 00:27:06,360
about that people but you can take a

644
00:27:06,360 --> 00:27:09,379
walk before your next

645
00:27:10,080 --> 00:27:12,480
your next uh talk whichever attack you

646
00:27:12,480 --> 00:27:14,820
want to go to I uh I'm back but I guess

647
00:27:14,820 --> 00:27:16,980
not till two o'clock this was supposed

648
00:27:16,980 --> 00:27:18,779
to be again a little more Hands-On I was

649
00:27:18,779 --> 00:27:21,059
going to take you through there are some

650
00:27:21,059 --> 00:27:23,039
sites you go to online which lets you

651
00:27:23,039 --> 00:27:26,039
try your Powershell skills uh that was

652
00:27:26,039 --> 00:27:27,840
the idea of the two o'clock

653
00:27:27,840 --> 00:27:30,120
if anyone's heard of under the wire that

654
00:27:30,120 --> 00:27:31,500
was what we were going to be looking at

655
00:27:31,500 --> 00:27:32,240
okay

656
00:27:32,240 --> 00:27:35,279
well you can stay and watch if you want

657
00:27:35,279 --> 00:27:37,980
or you know but the idea was these will

658
00:27:37,980 --> 00:27:39,600
get you to try your Powershell to do

659
00:27:39,600 --> 00:27:42,120
some research and to see if you can get

660
00:27:42,120 --> 00:27:45,139
your way through the levels

661
00:27:48,539 --> 00:27:50,120
thank you

662
00:27:50,120 --> 00:27:53,100
my human's falling flat huh

663
00:27:53,100 --> 00:27:55,140
nothing nothing there okay no that's not

664
00:27:55,140 --> 00:27:56,940
really Me No I gave it away at the

665
00:27:56,940 --> 00:27:59,120
beginning

666
00:28:01,140 --> 00:28:03,419
and social media influencer right didn't

667
00:28:03,419 --> 00:28:04,740
I put that in there

668
00:28:04,740 --> 00:28:06,960
yeah that's uh I I don't know sometimes

669
00:28:06,960 --> 00:28:10,580
I just build those people really

670
00:28:10,740 --> 00:28:13,320
and who would trust them what some guy

671
00:28:13,320 --> 00:28:15,419
recently confessed that

672
00:28:15,419 --> 00:28:17,340
China I think was was trying to reach

673
00:28:17,340 --> 00:28:19,200
out to him to get him to

674
00:28:19,200 --> 00:28:20,760
that they were really paying money to

675
00:28:20,760 --> 00:28:23,340
say certain things like really we trust

676
00:28:23,340 --> 00:28:25,559
these folks anymore

677
00:28:25,559 --> 00:28:27,600
okay sorry I'm getting political I'll

678
00:28:27,600 --> 00:28:29,760
stop now

679
00:28:29,760 --> 00:28:31,080
but if you want the real information

680
00:28:31,080 --> 00:28:33,960
come on back uh I do apologize this is

681
00:28:33,960 --> 00:28:35,520
my first time being up in a conference

682
00:28:35,520 --> 00:28:38,100
like this I have generally

683
00:28:38,100 --> 00:28:40,820
but thank you

684
00:28:42,659 --> 00:28:44,940
I have generally given presentations you

685
00:28:44,940 --> 00:28:46,860
know co-workers or maybe to customers

686
00:28:46,860 --> 00:28:48,659
like I did I did have a lot of fun with

687
00:28:48,659 --> 00:28:51,360
the password one I mentioned earlier

688
00:28:51,360 --> 00:28:53,100
everybody was just kind of sitting there

689
00:28:53,100 --> 00:28:54,179
quietly because I think people were

690
00:28:54,179 --> 00:28:55,260
nodding their heads and shaking their

691
00:28:55,260 --> 00:28:56,460
heads you know

692
00:28:56,460 --> 00:28:58,320
I I could say like the top of my past

693
00:28:58,320 --> 00:29:00,240
which we found and how frequently they

694
00:29:00,240 --> 00:29:03,120
were and I the ciso he enjoyed the

695
00:29:03,120 --> 00:29:04,260
presentation but like I said he was

696
00:29:04,260 --> 00:29:07,020
getting tired of hearing how we were

697
00:29:07,020 --> 00:29:08,340
starting some of our assessments and we

698
00:29:08,340 --> 00:29:09,539
already had accounts and passwords

699
00:29:09,539 --> 00:29:12,840
because my boss would let me go I like a

700
00:29:12,840 --> 00:29:14,520
couple days a week before the assessment

701
00:29:14,520 --> 00:29:16,020
he'd let me start running the script

702
00:29:16,020 --> 00:29:17,520
again to see if I could find any

703
00:29:17,520 --> 00:29:19,260
accounts and passwords

704
00:29:19,260 --> 00:29:21,600
and at least one time uh

705
00:29:21,600 --> 00:29:24,240
the password had timed out you know it

706
00:29:24,240 --> 00:29:26,640
expired and so I thought okay this is a

707
00:29:26,640 --> 00:29:28,380
great account if we could get it I tried

708
00:29:28,380 --> 00:29:30,120
again I tried like shifting over one

709
00:29:30,120 --> 00:29:31,620
didn't work it started shifting over

710
00:29:31,620 --> 00:29:34,380
again we're in so

711
00:29:34,380 --> 00:29:35,940
he was really getting tired of hearing

712
00:29:35,940 --> 00:29:37,860
about that stuff but it was a lot of fun

713
00:29:37,860 --> 00:29:38,940
so

714
00:29:38,940 --> 00:29:41,100
like I said any questions or anything

715
00:29:41,100 --> 00:29:43,880
else if not I guess

716
00:29:43,880 --> 00:29:46,020
I'll try to be a little more

717
00:29:46,020 --> 00:29:48,600
entertaining next time

718
00:29:48,600 --> 00:29:50,940
and I'll try not to go through I really

719
00:29:50,940 --> 00:29:52,020
thought there'd be a few more questions

720
00:29:52,020 --> 00:29:54,360
and stuff so I thought I'd take a little

721
00:29:54,360 --> 00:29:55,679
more time so

722
00:29:55,679 --> 00:29:58,260
yes

723
00:29:58,260 --> 00:30:01,260
like

724
00:30:01,260 --> 00:30:04,220
a small turkey might

725
00:30:06,020 --> 00:30:09,419
virtually oh sorry do you have any

726
00:30:09,419 --> 00:30:11,580
prescriptions those groups have you ran

727
00:30:11,580 --> 00:30:13,980
outside of here

728
00:30:13,980 --> 00:30:15,480
okay if you didn't hear what scripts

729
00:30:15,480 --> 00:30:17,580
have I written outside of work

730
00:30:17,580 --> 00:30:19,919
well I guess none

731
00:30:19,919 --> 00:30:21,600
I don't do a lot of programming at home

732
00:30:21,600 --> 00:30:22,620
anymore

733
00:30:22,620 --> 00:30:24,899
but I've perhaps made use of the scripts

734
00:30:24,899 --> 00:30:27,179
like I am running my personal web server

735
00:30:27,179 --> 00:30:29,700
at home on my laptop I didn't pull that

736
00:30:29,700 --> 00:30:31,320
into this one like I said this is fairly

737
00:30:31,320 --> 00:30:33,059
new and I haven't set it up yet

738
00:30:33,059 --> 00:30:35,100
uh but I do have my personal web server

739
00:30:35,100 --> 00:30:36,539
at home I don't buy the cracking my own

740
00:30:36,539 --> 00:30:38,760
passwords I I leave my wife alone I

741
00:30:38,760 --> 00:30:42,320
don't try to break into her accounts so

742
00:30:44,700 --> 00:30:46,700
um

743
00:30:47,480 --> 00:30:50,159
do I have something like GitHub that I

744
00:30:50,159 --> 00:30:51,720
can share in my description no I don't

745
00:30:51,720 --> 00:30:54,480
but I'd be more than happy to share any

746
00:30:54,480 --> 00:30:55,679
of the scripts

747
00:30:55,679 --> 00:30:57,299
um I'll talk to you when we're done here

748
00:30:57,299 --> 00:31:00,379
on our break

749
00:31:01,470 --> 00:31:04,569
[Music]

750
00:31:05,580 --> 00:31:09,299
what did they call them I I tend to work

751
00:31:09,299 --> 00:31:10,380
in environments where I can't

752
00:31:10,380 --> 00:31:12,059
necessarily bring things in which is why

753
00:31:12,059 --> 00:31:13,980
I tend to write them more myself

754
00:31:13,980 --> 00:31:15,840
you all can probably start to guess what

755
00:31:15,840 --> 00:31:16,980
I'm talking about were you kind of

756
00:31:16,980 --> 00:31:18,179
restricted you can't bring things in

757
00:31:18,179 --> 00:31:21,059
like computers and phones Okay so

758
00:31:21,059 --> 00:31:22,799
uh so we tend to write our own stuff

759
00:31:22,799 --> 00:31:26,059
there but uh what was Empire

760
00:31:26,059 --> 00:31:28,679
uh well that was the name of I think one

761
00:31:28,679 --> 00:31:31,279
of their um

762
00:31:31,279 --> 00:31:33,600
because I haven't been doing that role

763
00:31:33,600 --> 00:31:36,480
for a couple years now but Empire was a

764
00:31:36,480 --> 00:31:39,980
uh I think the name of a Powershell

765
00:31:39,980 --> 00:31:42,120
you started

766
00:31:42,120 --> 00:31:43,799
oh

767
00:31:43,799 --> 00:31:45,360
I still think I was trying to think of

768
00:31:45,360 --> 00:31:48,000
you know a whole package uh Empire is

769
00:31:48,000 --> 00:31:49,980
where a power view I think was a part of

770
00:31:49,980 --> 00:31:52,559
uh Empire and and like power scan or

771
00:31:52,559 --> 00:31:53,700
something like that

772
00:31:53,700 --> 00:31:55,799
yeah I thought there was a power sport I

773
00:31:55,799 --> 00:31:57,779
thought there was and I and like five or

774
00:31:57,779 --> 00:31:59,159
six years ago I was using those more

775
00:31:59,159 --> 00:32:01,620
often and I'll be honest I I would

776
00:32:01,620 --> 00:32:02,760
probably say that's a good place to

777
00:32:02,760 --> 00:32:04,260
start I found his code good I found

778
00:32:04,260 --> 00:32:06,360
their code sorry that was a little slip

779
00:32:06,360 --> 00:32:07,980
I actually like 10 years ago I worked

780
00:32:07,980 --> 00:32:09,419
with one of the guys who ended up in

781
00:32:09,419 --> 00:32:10,980
that effort he was one of their names

782
00:32:10,980 --> 00:32:13,740
you recognized I won't try to you know

783
00:32:13,740 --> 00:32:15,720
what is it when I when you try to grab

784
00:32:15,720 --> 00:32:17,880
somebody else's I won't mention his name

785
00:32:17,880 --> 00:32:19,799
but uh yeah I worked with that guy way

786
00:32:19,799 --> 00:32:23,159
back when before he knew a Powershell so

787
00:32:23,159 --> 00:32:25,080
uh he was he was a bit smarter than I

788
00:32:25,080 --> 00:32:28,740
was he um realize way back in version

789
00:32:28,740 --> 00:32:30,299
one version two that there was some

790
00:32:30,299 --> 00:32:32,880
potential for Powershell because it is

791
00:32:32,880 --> 00:32:35,220
on all these computers

792
00:32:35,220 --> 00:32:37,020
and so somebody came in late I was

793
00:32:37,020 --> 00:32:38,580
saying I'm actually surprised to be here

794
00:32:38,580 --> 00:32:39,960
talking about our show because I know in

795
00:32:39,960 --> 00:32:41,220
some of these conferences people don't

796
00:32:41,220 --> 00:32:43,620
like Windows they they don't

797
00:32:43,620 --> 00:32:45,179
I work with Windows and I work with

798
00:32:45,179 --> 00:32:46,679
Linux I've worked with computer and

799
00:32:46,679 --> 00:32:49,620
flavors of Unix I have some Mac at home

800
00:32:49,620 --> 00:32:52,080
but Windows is out there so I would

801
00:32:52,080 --> 00:32:54,960
encourage people learn it

802
00:32:54,960 --> 00:32:57,480
uh you have access to Powershell if you

803
00:32:57,480 --> 00:32:58,620
have a Windows computer Windows Server

804
00:32:58,620 --> 00:33:00,299
Windows laptop or desktop you have

805
00:33:00,299 --> 00:33:01,679
Powershell

806
00:33:01,679 --> 00:33:03,720
figure out what it can do for you right

807
00:33:03,720 --> 00:33:05,220
now figure out how to bring the modules

808
00:33:05,220 --> 00:33:06,120
down

809
00:33:06,120 --> 00:33:07,500
sorry did I see something or is it

810
00:33:07,500 --> 00:33:09,120
inside job okay

811
00:33:09,120 --> 00:33:11,100
am I am I becoming too much of the uh

812
00:33:11,100 --> 00:33:13,500
Advocate okay I was gonna say my in my

813
00:33:13,500 --> 00:33:14,519
advocating because I really have no

814
00:33:14,519 --> 00:33:16,679
stock in Microsoft I have no stocking

815
00:33:16,679 --> 00:33:19,220
into this stuff

816
00:33:20,460 --> 00:33:22,799
okay yeah okay so yeah I'll work with

817
00:33:22,799 --> 00:33:24,659
whatever I'm doing

818
00:33:24,659 --> 00:33:27,659
um and I'm I'm actually one of those

819
00:33:27,659 --> 00:33:29,519
who leans a little more toward the

820
00:33:29,519 --> 00:33:32,640
they're called living off the land or I

821
00:33:32,640 --> 00:33:34,980
call living off the OS if you will uh I

822
00:33:34,980 --> 00:33:36,840
think we there's a lot here already and

823
00:33:36,840 --> 00:33:38,399
we don't know what's out there

824
00:33:38,399 --> 00:33:40,260
and I I that's why I do try to

825
00:33:40,260 --> 00:33:41,940
familiarize myself with what is out

826
00:33:41,940 --> 00:33:43,320
there because I love it if you've been

827
00:33:43,320 --> 00:33:44,760
in the corporate environment you may not

828
00:33:44,760 --> 00:33:46,919
be able to shut down or reboot

829
00:33:46,919 --> 00:33:48,720
and I've been doing this stuff for years

830
00:33:48,720 --> 00:33:50,340
you open things up you close things out

831
00:33:50,340 --> 00:33:52,980
opening I just like to reboot if it's

832
00:33:52,980 --> 00:33:54,840
windows I admit I still reboot fairly

833
00:33:54,840 --> 00:33:56,580
frequently but it's down to maybe once

834
00:33:56,580 --> 00:33:58,260
or twice a week if we're forced to or

835
00:33:58,260 --> 00:33:59,039
something

836
00:33:59,039 --> 00:34:01,080
but I found out a while ago where you

837
00:34:01,080 --> 00:34:03,120
can't select shutdown or reboot from the

838
00:34:03,120 --> 00:34:07,639
menu but there's a nice little EXE

839
00:34:11,940 --> 00:34:13,859
and they don't stop that

840
00:34:13,859 --> 00:34:16,040
foreign

841
00:34:17,060 --> 00:34:19,619
yeah they won't stop there

842
00:34:19,619 --> 00:34:23,339
so slash R for reboot or slash g is kind

843
00:34:23,339 --> 00:34:24,960
of fun it doesn't always work slash g

844
00:34:24,960 --> 00:34:26,520
will

845
00:34:26,520 --> 00:34:28,679
um try to restart any apps that have

846
00:34:28,679 --> 00:34:30,179
been up and running sometimes they do

847
00:34:30,179 --> 00:34:31,859
come back if you had a couple browser

848
00:34:31,859 --> 00:34:34,199
windows uh the shutdown with slash g

849
00:34:34,199 --> 00:34:36,480
when you log back in it'll bring up your

850
00:34:36,480 --> 00:34:37,679
browser

851
00:34:37,679 --> 00:34:39,418
anime he's right back where you were

852
00:34:39,418 --> 00:34:42,000
I've actually found out surprisingly

853
00:34:42,000 --> 00:34:44,060
okay who here knows notepad plus plus

854
00:34:44,060 --> 00:34:46,560
Windows World notepad it's nice nice app

855
00:34:46,560 --> 00:34:47,760
right

856
00:34:47,760 --> 00:34:49,800
I still do bring up notepad every now

857
00:34:49,800 --> 00:34:51,599
and then because it's just easy

858
00:34:51,599 --> 00:34:54,000
it doesn't bring any of the formatting I

859
00:34:54,000 --> 00:34:55,260
don't know about you all but if you get

860
00:34:55,260 --> 00:34:57,060
a corporate document or something I I

861
00:34:57,060 --> 00:34:58,740
usually bring it out of word or out of

862
00:34:58,740 --> 00:35:00,359
excel into notepad and then into

863
00:35:00,359 --> 00:35:01,800
whatever because it leaves all the

864
00:35:01,800 --> 00:35:03,060
formatting behind it just brings the

865
00:35:03,060 --> 00:35:04,020
text

866
00:35:04,020 --> 00:35:06,300
and maybe it's it's from word to notepad

867
00:35:06,300 --> 00:35:07,980
to another word that I'm doing but it

868
00:35:07,980 --> 00:35:10,560
leaves all the formatting behind

869
00:35:10,560 --> 00:35:12,780
so I found actually

870
00:35:12,780 --> 00:35:15,240
using the G option when you log back in

871
00:35:15,240 --> 00:35:17,220
notepad is right there again

872
00:35:17,220 --> 00:35:19,859
I'm surprised notepad plus plus saves

873
00:35:19,859 --> 00:35:21,000
all your temporary files you may not

874
00:35:21,000 --> 00:35:23,820
saved but notepad you close notepad it's

875
00:35:23,820 --> 00:35:24,720
gone

876
00:35:24,720 --> 00:35:27,480
but you run the slash g after you reboot

877
00:35:27,480 --> 00:35:29,040
it'll actually be there is it's worked

878
00:35:29,040 --> 00:35:31,200
for me a few times so

879
00:35:31,200 --> 00:35:33,540
okay I'm rambled on and on what time we

880
00:35:33,540 --> 00:35:35,760
got here well still only 140 any other

881
00:35:35,760 --> 00:35:37,320
questions any comments I got lots of fun

882
00:35:37,320 --> 00:35:39,300
stories I mean I can I'm not dad jokes

883
00:35:39,300 --> 00:35:42,720
but their their stories so

884
00:35:42,720 --> 00:35:45,500
anything else

885
00:35:58,079 --> 00:36:00,180
foreign

886
00:36:00,180 --> 00:36:02,700
I can't think of anything offhand I do

887
00:36:02,700 --> 00:36:05,280
not have that on the box here too bad

888
00:36:05,280 --> 00:36:07,260
I can't think of anything offhand I

889
00:36:07,260 --> 00:36:09,060
don't know I suppose maybe you might say

890
00:36:09,060 --> 00:36:10,500
the ability to

891
00:36:10,500 --> 00:36:12,540
handle multiple sessions

892
00:36:12,540 --> 00:36:14,460
um something like that what do you work

893
00:36:14,460 --> 00:36:18,200
with you you're one of the Developers

894
00:36:18,420 --> 00:36:20,520
oh oh well I got to talk to you online

895
00:36:20,520 --> 00:36:23,339
then oh okay oh well okay I didn't know

896
00:36:23,339 --> 00:36:24,480
I honestly didn't know I'm not trying to

897
00:36:24,480 --> 00:36:25,980
plug his stuff there but but power cat

898
00:36:25,980 --> 00:36:27,780
was it was a fun one I I found a few

899
00:36:27,780 --> 00:36:31,099
years ago it was quite handy so

900
00:36:32,579 --> 00:36:34,440
attitude

901
00:36:34,440 --> 00:36:36,420
well yeah I got to get your contact

902
00:36:36,420 --> 00:36:38,460
information and I will uh you know I'll

903
00:36:38,460 --> 00:36:41,060
keep you in mind

904
00:36:41,880 --> 00:36:43,619
right now I'm doing more cyber defense

905
00:36:43,619 --> 00:36:45,480
type work and I'm just supporting some

906
00:36:45,480 --> 00:36:47,520
hardware and software I've gotten away

907
00:36:47,520 --> 00:36:50,099
from Red teaming but I Tell You Folks if

908
00:36:50,099 --> 00:36:52,020
that's your interest if you like the

909
00:36:52,020 --> 00:36:54,180
geeky you want to learn some tools you

910
00:36:54,180 --> 00:36:55,859
want to learn some languages and then

911
00:36:55,859 --> 00:36:57,420
you want to do things yeah get into red

912
00:36:57,420 --> 00:36:59,040
team

913
00:36:59,040 --> 00:37:01,260
oh that can be a lot of fun a lot of uh

914
00:37:01,260 --> 00:37:03,060
a lot of things you find out there a lot

915
00:37:03,060 --> 00:37:05,579
of things that are leave a shaking your

916
00:37:05,579 --> 00:37:07,740
head and and even some of the uh perhaps

917
00:37:07,740 --> 00:37:09,420
more of the social engineering type

918
00:37:09,420 --> 00:37:12,720
stuff my previous job I was able to walk

919
00:37:12,720 --> 00:37:13,740
around the building every now and then

920
00:37:13,740 --> 00:37:15,599
just try my badge trying to get into

921
00:37:15,599 --> 00:37:16,980
doors and

922
00:37:16,980 --> 00:37:19,200
they they didn't lock that place down I

923
00:37:19,200 --> 00:37:21,660
was getting into all sorts of doors

924
00:37:21,660 --> 00:37:23,400
I was telling that my team leader at one

925
00:37:23,400 --> 00:37:24,960
time I came back from meeting and I said

926
00:37:24,960 --> 00:37:26,579
dude do we have access to these rooms

927
00:37:26,579 --> 00:37:28,740
and he said no and I said well I got

928
00:37:28,740 --> 00:37:30,720
into this power room right out here so

929
00:37:30,720 --> 00:37:32,280
we walked out to the room and walked in

930
00:37:32,280 --> 00:37:34,079
and I just kind of jokingly said to him

931
00:37:34,079 --> 00:37:35,339
hey you want to send everybody home for

932
00:37:35,339 --> 00:37:36,359
the day

933
00:37:36,359 --> 00:37:38,940
you know uh yeah we're walking right

934
00:37:38,940 --> 00:37:41,160
into one of the sections I'm sure we

935
00:37:41,160 --> 00:37:42,240
wouldn't shut down everything you know

936
00:37:42,240 --> 00:37:43,380
we could have shut down some of the

937
00:37:43,380 --> 00:37:44,579
power

938
00:37:44,579 --> 00:37:47,220
and we've walked into wiring rooms

939
00:37:47,220 --> 00:37:48,960
we walked into the room with the fire

940
00:37:48,960 --> 00:37:51,900
control system which was by the way an

941
00:37:51,900 --> 00:37:53,700
older version of Windows like 95 or

942
00:37:53,700 --> 00:37:57,720
maybe 2000 no password protecting it

943
00:37:57,720 --> 00:37:59,339
at least it wasn't on the Internet or

944
00:37:59,339 --> 00:38:00,300
anything like that but yeah you could

945
00:38:00,300 --> 00:38:02,280
walk up and move the mouse and you got

946
00:38:02,280 --> 00:38:02,790
access to

947
00:38:02,790 --> 00:38:04,020
[Music]

948
00:38:04,020 --> 00:38:06,980
so

949
00:38:07,079 --> 00:38:09,480
and uh yeah my boss that was that was

950
00:38:09,480 --> 00:38:11,400
quite entertaining my boss I say you use

951
00:38:11,400 --> 00:38:14,220
governments okay I let it slipper we

952
00:38:14,220 --> 00:38:16,740
walked into one wiring room and man you

953
00:38:16,740 --> 00:38:19,260
could just watch his face just went from

954
00:38:19,260 --> 00:38:22,920
normal to Red to bright red to like I

955
00:38:22,920 --> 00:38:23,880
thought he was going to pass out or

956
00:38:23,880 --> 00:38:24,720
something

957
00:38:24,720 --> 00:38:26,280
because we were looking various racks

958
00:38:26,280 --> 00:38:27,540
and various different network components

959
00:38:27,540 --> 00:38:28,980
and there were cables connecting

960
00:38:28,980 --> 00:38:30,660
components that shouldn't be connected

961
00:38:30,660 --> 00:38:33,420
view was Joseph

962
00:38:33,420 --> 00:38:34,560
really thought he was going to have a

963
00:38:34,560 --> 00:38:37,079
heart attack or something so

964
00:38:37,079 --> 00:38:40,320
but yeah three guys though sorry you

965
00:38:40,320 --> 00:38:41,880
question

966
00:38:41,880 --> 00:38:44,540
yes

967
00:38:48,180 --> 00:38:50,598
foreign

968
00:38:51,800 --> 00:38:54,660
yes not not a lot but yes I have done

969
00:38:54,660 --> 00:38:55,920
that it's it's been a little while since

970
00:38:55,920 --> 00:38:58,320
I've worked out as well yeah that's

971
00:38:58,320 --> 00:39:00,839
another way to get to boxes here

972
00:39:00,839 --> 00:39:03,000
you talk about a feature that will let

973
00:39:03,000 --> 00:39:04,800
you basically get to the remote box and

974
00:39:04,800 --> 00:39:07,700
run Powershell there

975
00:39:09,480 --> 00:39:11,820
all right

976
00:39:11,820 --> 00:39:15,320
any last questions let's take a break

977
00:39:15,980 --> 00:39:19,160
thank you

978
00:39:22,320 --> 00:39:23,960
foreign

979
00:39:23,960 --> 00:39:27,240
this talk was a part of our 2022 secure

980
00:39:27,240 --> 00:39:29,700
West Virginia Lucky 13 conference if you

981
00:39:29,700 --> 00:39:31,260
would like more information about this

982
00:39:31,260 --> 00:39:32,940
talk or our speaker check the

983
00:39:32,940 --> 00:39:35,099
description below and if you enjoyed the

984
00:39:35,099 --> 00:39:36,839
content consider liking and sharing this

985
00:39:36,839 --> 00:39:39,119
video for more information on secure

986
00:39:39,119 --> 00:39:40,619
West Virginia or you want to stay

987
00:39:40,619 --> 00:39:42,720
updated with the latest upcoming events

988
00:39:42,720 --> 00:39:46,380
follow us on Twitter at secured wvcon or

989
00:39:46,380 --> 00:39:49,380
visit our website securedwv.org

990
00:39:49,380 --> 00:39:51,540
we would like also like to thank our

991
00:39:51,540 --> 00:39:53,940
2022 sponsors for being a huge part of

992
00:39:53,940 --> 00:39:57,079
Lucky 13 success

