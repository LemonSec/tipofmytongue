1
00:00:00,000 --> 00:00:08,800
[Music]

2
00:00:14,469 --> 00:00:22,520
<font color="#E5E5E5">okay welcome here at</font><font color="#CCCCCC"> cha 2017</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> is I</font>

3
00:00:19,759 --> 00:00:24,919
believe<font color="#CCCCCC"> the</font><font color="#E5E5E5"> second slot</font><font color="#CCCCCC"> and we will now</font>

4
00:00:22,520 --> 00:00:27,980
<font color="#E5E5E5">have some great</font><font color="#CCCCCC"> information about</font><font color="#E5E5E5"> crypto</font>

5
00:00:24,919 --> 00:00:32,599
who<font color="#CCCCCC"> fu has recently been using some kind</font>

6
00:00:27,980 --> 00:00:33,920
<font color="#E5E5E5">of encryption there are people who</font>

7
00:00:32,598 --> 00:00:37,398
didn't<font color="#E5E5E5"> I'm surprised</font>

8
00:00:33,920 --> 00:00:39,920
<font color="#E5E5E5">okay who of you has</font><font color="#CCCCCC"> been</font><font color="#E5E5E5"> using RSA in</font>

9
00:00:37,399 --> 00:00:42,949
the<font color="#CCCCCC"> up methacel implementation or at</font>

10
00:00:39,920 --> 00:00:45,739
<font color="#E5E5E5">least no</font><font color="#CCCCCC"> steady that or she did some</font><font color="#E5E5E5"> of</font>

11
00:00:42,949 --> 00:00:48,349
them well<font color="#CCCCCC"> oh gosh and</font><font color="#E5E5E5"> Praveen will now</font>

12
00:00:45,739 --> 00:00:54,769
tell<font color="#CCCCCC"> us how horribly broken it is I</font>

13
00:00:48,350 --> 00:00:58,640
assume they are<font color="#CCCCCC"> searchers at risk you</font>

14
00:00:54,769 --> 00:01:02,210
and<font color="#E5E5E5"> mostly work on</font><font color="#CCCCCC"> side-channel attacks</font>

15
00:00:58,640 --> 00:01:04,069
<font color="#E5E5E5">for instance or specifically on RSA have</font>

16
00:01:02,210 --> 00:01:14,860
a give them a warm round<font color="#CCCCCC"> of applause</font>

17
00:01:04,069 --> 00:01:17,089
please<font color="#E5E5E5"> thank you because some problems</font>

18
00:01:14,860 --> 00:01:22,750
there<font color="#CCCCCC"> are some</font><font color="#E5E5E5"> problem there are some</font>

19
00:01:17,090 --> 00:01:25,850
problems<font color="#CCCCCC"> with</font><font color="#E5E5E5"> turning on this okay so</font><font color="#CCCCCC"> oh</font>

20
00:01:22,750 --> 00:01:28,579
<font color="#CCCCCC">how then let's start with the nice part</font>

21
00:01:25,850 --> 00:01:31,610
how<font color="#E5E5E5"> else they</font><font color="#CCCCCC"> come for you up</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> now</font>

22
00:01:28,579 --> 00:01:35,329
well we got quite light<font color="#E5E5E5"> so</font><font color="#CCCCCC"> we just run</font>

23
00:01:31,610 --> 00:01:42,170
here<font color="#E5E5E5"> we haven't seen much yet yeah so</font>

24
00:01:35,329 --> 00:01:43,729
well I hope it will be<font color="#E5E5E5"> great okay so</font>

25
00:01:42,170 --> 00:01:50,509
maybe let's have<font color="#E5E5E5"> a question do you know</font>

26
00:01:43,729 --> 00:01:53,210
<font color="#E5E5E5">guys what is side channel analysis okay</font>

27
00:01:50,509 --> 00:01:56,750
I didn't<font color="#E5E5E5"> hear but</font><font color="#CCCCCC"> yeah there are</font><font color="#E5E5E5"> few</font>

28
00:01:53,210 --> 00:02:00,829
hands<font color="#E5E5E5"> okay so what we do mostly we work</font>

29
00:01:56,750 --> 00:02:02,659
for<font color="#E5E5E5"> a for a lab that that does let's say</font>

30
00:02:00,829 --> 00:02:04,520
<font color="#CCCCCC">hardware evaluation fault injection site</font>

31
00:02:02,659 --> 00:02:07,330
channel analysis there will be some more

32
00:02:04,520 --> 00:02:09,829
<font color="#CCCCCC">people talking about the other topics</font><font color="#E5E5E5"> in</font>

33
00:02:07,330 --> 00:02:13,520
<font color="#CCCCCC">particular</font><font color="#E5E5E5"> here we will show something</font>

34
00:02:09,830 --> 00:02:18,379
on on<font color="#E5E5E5"> open</font><font color="#CCCCCC"> SSL on the si implementation</font>

35
00:02:13,520 --> 00:02:20,209
this is of<font color="#E5E5E5"> course not the it has some</font>

36
00:02:18,379 --> 00:02:21,500
countermeasures<font color="#E5E5E5"> against actual analysis</font>

37
00:02:20,209 --> 00:02:24,890
mainly

38
00:02:21,500 --> 00:02:26,300
against all these<font color="#CCCCCC"> Casas parks and maybe</font>

39
00:02:24,890 --> 00:02:28,549
maybe<font color="#E5E5E5"> you are aware they were shown</font>

40
00:02:26,300 --> 00:02:30,740
<font color="#E5E5E5">attacks how using timing click each</font>

41
00:02:28,550 --> 00:02:34,330
following<font color="#E5E5E5"> from cache or all the</font><font color="#CCCCCC"> other</font>

42
00:02:30,740 --> 00:02:38,270
<font color="#E5E5E5">things to get their key of</font><font color="#CCCCCC"> si from there</font>

43
00:02:34,330 --> 00:02:40,820
we do it<font color="#E5E5E5"> using we did it using</font><font color="#CCCCCC"> a.m. and</font>

44
00:02:38,270 --> 00:02:45,490
power<font color="#E5E5E5"> here we will present some results</font>

45
00:02:40,820 --> 00:02:45,489
based on power<font color="#CCCCCC"> ok</font>

46
00:02:56,849 --> 00:03:05,589
<font color="#CCCCCC">hey go</font><font color="#E5E5E5"> okay</font>

47
00:03:00,129 --> 00:03:09,129
so<font color="#CCCCCC"> google talk about how we attack the</font>

48
00:03:05,590 --> 00:03:12,280
RSA implementation from<font color="#E5E5E5"> open</font><font color="#CCCCCC"> ssl</font><font color="#E5E5E5"> so as</font>

49
00:03:09,129 --> 00:03:16,689
<font color="#E5E5E5">Lucas already mentioned there are some</font>

50
00:03:12,280 --> 00:03:20,200
countermeasures<font color="#CCCCCC"> and even then we could</font>

51
00:03:16,689 --> 00:03:25,870
still attack it<font color="#E5E5E5"> so we will explain</font><font color="#CCCCCC"> how</font>

52
00:03:20,200 --> 00:03:28,379
<font color="#E5E5E5">we did that so this was a joint work</font>

53
00:03:25,870 --> 00:03:31,870
<font color="#CCCCCC">with three people that's me and</font><font color="#E5E5E5"> the left</font>

54
00:03:28,379 --> 00:03:33,548
because on the right and then Rafa is

55
00:03:31,870 --> 00:03:39,150
<font color="#E5E5E5">supposed to be here he'll</font><font color="#CCCCCC"> will</font><font color="#E5E5E5"> be back</font>

56
00:03:33,549 --> 00:03:43,419
<font color="#E5E5E5">soon</font><font color="#CCCCCC"> so this</font><font color="#E5E5E5"> is a joint work all of us</font>

57
00:03:39,150 --> 00:03:47,859
<font color="#CCCCCC">ok to give you a</font><font color="#E5E5E5"> very high level</font>

58
00:03:43,419 --> 00:03:49,480
<font color="#E5E5E5">overview of what this is going to be the</font>

59
00:03:47,859 --> 00:03:54,189
attack<font color="#CCCCCC"> that we are talking about is</font>

60
00:03:49,480 --> 00:03:56,709
called cross correlation attack<font color="#E5E5E5"> and we</font>

61
00:03:54,189 --> 00:03:59,828
will explain<font color="#E5E5E5"> how it</font><font color="#CCCCCC"> works</font><font color="#E5E5E5"> in</font><font color="#CCCCCC"> general</font>

62
00:03:56,709 --> 00:04:04,389
<font color="#E5E5E5">without taking RSA</font><font color="#CCCCCC"> are open SSL into</font>

63
00:03:59,829 --> 00:04:07,209
frame and then we will show how the RSA

64
00:04:04,389 --> 00:04:11,229
implementation in open SSL is vulnerable

65
00:04:07,209 --> 00:04:13,299
<font color="#CCCCCC">to this kind of</font><font color="#E5E5E5"> attack you can see the</font>

66
00:04:11,229 --> 00:04:15,840
picture<font color="#E5E5E5"> this is actual setup that we</font>

67
00:04:13,299 --> 00:04:18,849
used to break<font color="#E5E5E5"> it so there is</font><font color="#CCCCCC"> a</font>

68
00:04:15,840 --> 00:04:24,280
oscilloscope<font color="#CCCCCC"> the</font><font color="#E5E5E5"> power supply and then</font>

69
00:04:18,849 --> 00:04:26,680
there's a small here this is where we

70
00:04:24,280 --> 00:04:32,440
had<font color="#E5E5E5"> the open SSL running it's a small</font>

71
00:04:26,680 --> 00:04:34,570
bowl<font color="#CCCCCC"> 32-bit microcontroller inside</font><font color="#E5E5E5"> or we</font>

72
00:04:32,440 --> 00:04:38,639
will<font color="#CCCCCC"> will show the set up bit later but</font>

73
00:04:34,570 --> 00:04:38,639
<font color="#E5E5E5">yeah this is actual setup that we used</font>

74
00:04:38,759 --> 00:04:46,719
so we already saw<font color="#CCCCCC"> some hands raised when</font>

75
00:04:43,680 --> 00:04:50,229
we<font color="#E5E5E5"> asked do you guys know about side</font>

76
00:04:46,719 --> 00:04:53,740
channels so to give a very<font color="#E5E5E5"> brief</font>

77
00:04:50,229 --> 00:04:57,300
overview<font color="#E5E5E5"> for those who don't we know</font>

78
00:04:53,740 --> 00:05:01,090
that<font color="#E5E5E5"> every embedded device has some</font>

79
00:04:57,300 --> 00:05:05,199
interfaces<font color="#E5E5E5"> and some of them are intended</font>

80
00:05:01,090 --> 00:05:08,580
for example<font color="#E5E5E5"> keypad to enter let's say</font>

81
00:05:05,199 --> 00:05:12,610
password<font color="#E5E5E5"> or any other information or</font>

82
00:05:08,580 --> 00:05:13,390
screen to see things<font color="#E5E5E5"> so</font><font color="#CCCCCC"> there all these</font>

83
00:05:12,610 --> 00:05:16,750
kind of

84
00:05:13,390 --> 00:05:18,969
our speakers<font color="#E5E5E5"> so these are all intended</font>

85
00:05:16,750 --> 00:05:23,770
ones<font color="#E5E5E5"> that means this is these</font><font color="#CCCCCC"> are</font>

86
00:05:18,970 --> 00:05:27,070
provided<font color="#E5E5E5"> by this system but there are</font>

87
00:05:23,770 --> 00:05:29,190
also some unintended interfaces<font color="#E5E5E5"> for</font>

88
00:05:27,070 --> 00:05:31,300
example<font color="#E5E5E5"> power consumption our</font>

89
00:05:29,190 --> 00:05:33,820
electromagnetic<font color="#E5E5E5"> radiation</font>

90
00:05:31,300 --> 00:05:36,580
these are<font color="#E5E5E5"> byproduct of your system so</font>

91
00:05:33,820 --> 00:05:39,420
they are there<font color="#E5E5E5"> you can't do anything</font>

92
00:05:36,580 --> 00:05:42,580
about<font color="#E5E5E5"> them and these can actually be</font>

93
00:05:39,420 --> 00:05:44,710
exploited by an attacker to recover

94
00:05:42,580 --> 00:05:47,500
secrets<font color="#E5E5E5"> so that is what we</font><font color="#CCCCCC"> are going</font><font color="#E5E5E5"> to</font>

95
00:05:44,710 --> 00:05:51,609
show so these kind of<font color="#E5E5E5"> things interfaces</font>

96
00:05:47,500 --> 00:05:54,070
are what we call<font color="#CCCCCC"> side showers some of</font>

97
00:05:51,610 --> 00:05:56,920
the<font color="#E5E5E5"> widely</font><font color="#CCCCCC"> used side channels I think</font>

98
00:05:54,070 --> 00:05:59,740
you know<font color="#E5E5E5"> a few of them already</font><font color="#CCCCCC"> for</font>

99
00:05:56,920 --> 00:06:03,670
example time<font color="#E5E5E5"> how much</font><font color="#CCCCCC"> time a particular</font>

100
00:05:59,740 --> 00:06:07,230
<font color="#CCCCCC">operation takes</font><font color="#E5E5E5"> and in terms of RSA for</font>

101
00:06:03,670 --> 00:06:10,000
<font color="#E5E5E5">example as we show bit later but</font>

102
00:06:07,230 --> 00:06:13,150
depending on<font color="#E5E5E5"> what</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> the secret</font><font color="#CCCCCC"> key</font><font color="#E5E5E5"> bit</font>

103
00:06:10,000 --> 00:06:15,670
whether<font color="#E5E5E5"> it is 0 or</font><font color="#CCCCCC"> 1 the operation that</font>

104
00:06:13,150 --> 00:06:17,979
it performs is going to be different<font color="#CCCCCC"> and</font>

105
00:06:15,670 --> 00:06:19,960
based<font color="#CCCCCC"> on that</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> recover full</font>

106
00:06:17,980 --> 00:06:23,050
secret key<font color="#E5E5E5"> that</font><font color="#CCCCCC"> the implementation</font><font color="#E5E5E5"> is</font>

107
00:06:19,960 --> 00:06:25,270
not protected so that's one of<font color="#CCCCCC"> the side</font>

108
00:06:23,050 --> 00:06:27,490
channels and then we have power

109
00:06:25,270 --> 00:06:31,270
consumption<font color="#E5E5E5"> so this is what we actually</font>

110
00:06:27,490 --> 00:06:35,830
did so we measure the power while the

111
00:06:31,270 --> 00:06:37,870
<font color="#CCCCCC">device is executing RSA and that could</font>

112
00:06:35,830 --> 00:06:40,900
leak<font color="#CCCCCC"> information and even</font>

113
00:06:37,870 --> 00:06:43,870
electromagnetic radiation so you can put

114
00:06:40,900 --> 00:06:46,090
the probe on<font color="#CCCCCC"> top</font><font color="#E5E5E5"> of your chip and then</font>

115
00:06:43,870 --> 00:06:48,850
measure<font color="#E5E5E5"> the</font><font color="#CCCCCC"> e/m radiation and then that</font>

116
00:06:46,090 --> 00:06:50,770
could<font color="#E5E5E5"> be used as well so there are</font>

117
00:06:48,850 --> 00:06:57,610
others like light sound and temperatures

118
00:06:50,770 --> 00:07:01,479
or the many side channels then how do we

119
00:06:57,610 --> 00:07:04,270
exploit this<font color="#CCCCCC"> tight channels right again</font>

120
00:07:01,480 --> 00:07:06,610
there<font color="#CCCCCC"> are two different</font><font color="#E5E5E5"> ways one is what</font>

121
00:07:04,270 --> 00:07:10,990
<font color="#CCCCCC">we call a passive side channel where we</font>

122
00:07:06,610 --> 00:07:15,370
<font color="#E5E5E5">just observe the operations and we don't</font>

123
00:07:10,990 --> 00:07:17,860
do anything with the normal behavior of

124
00:07:15,370 --> 00:07:20,350
<font color="#CCCCCC">the device</font><font color="#E5E5E5"> so that means we</font><font color="#CCCCCC"> just see</font>

125
00:07:17,860 --> 00:07:23,200
what is the power consumption while it

126
00:07:20,350 --> 00:07:26,080
is computing something<font color="#E5E5E5"> or we see the e/m</font>

127
00:07:23,200 --> 00:07:27,010
radiation but we don't do<font color="#E5E5E5"> anything with</font>

128
00:07:26,080 --> 00:07:29,530
the normal<font color="#E5E5E5"> behave</font>

129
00:07:27,010 --> 00:07:32,230
so those are what we call<font color="#E5E5E5"> passive</font>

130
00:07:29,530 --> 00:07:36,549
<font color="#E5E5E5">attacks and this is where our side</font>

131
00:07:32,230 --> 00:07:38,860
channels<font color="#CCCCCC"> Falls</font><font color="#E5E5E5"> in and the other kind of</font>

132
00:07:36,550 --> 00:07:42,280
<font color="#E5E5E5">side channels is active</font><font color="#CCCCCC"> so there</font><font color="#E5E5E5"> you can</font>

133
00:07:38,860 --> 00:07:46,210
actually go and change the behavior<font color="#E5E5E5"> for</font>

134
00:07:42,280 --> 00:07:50,500
<font color="#CCCCCC">example in inject fault</font><font color="#E5E5E5"> during</font><font color="#CCCCCC"> the</font>

135
00:07:46,210 --> 00:07:52,750
computation<font color="#E5E5E5"> and use that to again</font>

136
00:07:50,500 --> 00:07:56,640
recover the<font color="#E5E5E5"> secret key for example</font><font color="#CCCCCC"> so</font>

137
00:07:52,750 --> 00:07:56,640
those are called active attacks and

138
00:07:56,760 --> 00:08:01,870
normally they are also called fault

139
00:07:59,650 --> 00:08:05,710
injection attacks<font color="#CCCCCC"> because we induce</font>

140
00:08:01,870 --> 00:08:07,870
fault<font color="#E5E5E5"> during</font><font color="#CCCCCC"> the execution but in this</font>

141
00:08:05,710 --> 00:08:10,989
<font color="#E5E5E5">talk we are only going to concentrate on</font>

142
00:08:07,870 --> 00:08:13,770
passive attacks<font color="#E5E5E5"> which is side channels</font>

143
00:08:10,990 --> 00:08:20,800
and in specific<font color="#CCCCCC"> only power consumption</font>

144
00:08:13,770 --> 00:08:24,700
<font color="#E5E5E5">yeah okay to show you how power analysis</font>

145
00:08:20,800 --> 00:08:28,510
can be<font color="#E5E5E5"> very powerful let's take an</font>

146
00:08:24,700 --> 00:08:31,570
example for<font color="#E5E5E5"> example</font><font color="#CCCCCC"> you have a</font><font color="#E5E5E5"> car and</font>

147
00:08:28,510 --> 00:08:33,210
you<font color="#E5E5E5"> need to enter the</font><font color="#CCCCCC"> pin</font><font color="#E5E5E5"> and only when</font>

148
00:08:31,570 --> 00:08:38,830
<font color="#E5E5E5">you enter the correct pin you can login</font>

149
00:08:33,210 --> 00:08:40,419
<font color="#E5E5E5">let's say and you</font><font color="#CCCCCC"> want</font><font color="#E5E5E5"> you're trying to</font>

150
00:08:38,830 --> 00:08:44,860
measure<font color="#E5E5E5"> the power while you are doing</font>

151
00:08:40,419 --> 00:08:48,250
<font color="#E5E5E5">this verification right so everybody can</font>

152
00:08:44,860 --> 00:08:51,130
<font color="#CCCCCC">see this figure clearly</font><font color="#E5E5E5"> yeah</font><font color="#CCCCCC"> okay</font>

153
00:08:48,250 --> 00:08:54,760
so this these<font color="#CCCCCC"> are</font><font color="#E5E5E5"> the actual power</font>

154
00:08:51,130 --> 00:08:57,990
traces<font color="#E5E5E5"> while the verification process is</font>

155
00:08:54,760 --> 00:09:01,720
<font color="#E5E5E5">happening okay so in the first attempt</font>

156
00:08:57,990 --> 00:09:04,990
we we entered a random key<font color="#CCCCCC"> a random</font>

157
00:09:01,720 --> 00:09:07,500
<font color="#E5E5E5">password it's four digits and then</font>

158
00:09:04,990 --> 00:09:13,390
<font color="#E5E5E5">nothing happens and we have this trace</font>

159
00:09:07,500 --> 00:09:18,810
and in the second attempt so we try it

160
00:09:13,390 --> 00:09:20,620
for the first let's say this bit this

161
00:09:18,810 --> 00:09:23,500
digit sorry

162
00:09:20,620 --> 00:09:26,620
so they are like<font color="#CCCCCC"> 0 to 9</font><font color="#E5E5E5"> 10</font><font color="#CCCCCC"> options so we</font>

163
00:09:23,500 --> 00:09:29,790
<font color="#E5E5E5">tried all of them and apparently for 8</font>

164
00:09:26,620 --> 00:09:32,770
the<font color="#CCCCCC"> power trace</font><font color="#E5E5E5"> looks a bit different</font>

165
00:09:29,790 --> 00:09:34,719
<font color="#E5E5E5">yeah because this is when you enter</font>

166
00:09:32,770 --> 00:09:36,160
wrong<font color="#CCCCCC"> well but when you have the first</font>

167
00:09:34,720 --> 00:09:41,019
digit right

168
00:09:36,160 --> 00:09:45,699
then the operation that verification

169
00:09:41,019 --> 00:09:48,550
fails bit later<font color="#E5E5E5"> yeah and similarly if</font>

170
00:09:45,699 --> 00:09:52,410
you get the second digit right<font color="#E5E5E5"> your</font>

171
00:09:48,550 --> 00:09:55,359
<font color="#E5E5E5">application is failing bit later again</font>

172
00:09:52,410 --> 00:09:58,420
right<font color="#CCCCCC"> so this will give you feedback</font>

173
00:09:55,360 --> 00:10:00,730
about<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> whether the</font><font color="#CCCCCC"> enter digit is</font>

174
00:09:58,420 --> 00:10:02,349
right or<font color="#CCCCCC"> wrong and by measuring the</font>

175
00:10:00,730 --> 00:10:04,420
power you<font color="#E5E5E5"> can see okay</font>

176
00:10:02,350 --> 00:10:07,209
at which<font color="#E5E5E5"> place the verification goes</font>

177
00:10:04,420 --> 00:10:10,628
<font color="#E5E5E5">right then you can say that okay this is</font>

178
00:10:07,209 --> 00:10:13,989
the corresponding digit and similar way

179
00:10:10,629 --> 00:10:16,899
we can<font color="#E5E5E5"> find</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> third and the fourth so</font>

180
00:10:13,990 --> 00:10:19,420
this is how we can<font color="#CCCCCC"> actually measure the</font>

181
00:10:16,899 --> 00:10:23,769
power and figure<font color="#CCCCCC"> out what are the four</font>

182
00:10:19,420 --> 00:10:27,670
digits by maximum how many<font color="#CCCCCC"> attempts</font><font color="#E5E5E5"> ten</font>

183
00:10:23,769 --> 00:10:29,220
times four right instead<font color="#E5E5E5"> of if you want</font>

184
00:10:27,670 --> 00:10:32,979
a brute<font color="#CCCCCC"> force you</font><font color="#E5E5E5"> need like almost</font><font color="#CCCCCC"> ten</font>

185
00:10:29,220 --> 00:10:36,009
actually<font color="#CCCCCC"> 10,000 attempts but we can do</font>

186
00:10:32,980 --> 00:10:41,439
it<font color="#CCCCCC"> in 40 attempts right</font><font color="#E5E5E5"> so that's the</font>

187
00:10:36,009 --> 00:10:46,509
power<font color="#E5E5E5"> of side channels so this is the</font>

188
00:10:41,439 --> 00:10:49,089
<font color="#CCCCCC">verification process</font><font color="#E5E5E5"> and what I just</font>

189
00:10:46,509 --> 00:10:53,319
<font color="#E5E5E5">showed you is called</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> simple power</font>

190
00:10:49,089 --> 00:10:56,139
analysis because<font color="#E5E5E5"> we are</font><font color="#CCCCCC"> just trying to</font>

191
00:10:53,319 --> 00:11:02,079
figure<font color="#CCCCCC"> out the operations</font><font color="#E5E5E5"> or how the</font>

192
00:10:56,139 --> 00:11:05,380
paths are going<font color="#E5E5E5"> in we use modulus we use</font>

193
00:11:02,079 --> 00:11:07,089
the exponents of<font color="#CCCCCC"> 1/2 of size which is</font>

194
00:11:05,380 --> 00:11:09,819
going<font color="#CCCCCC"> to be more efficient</font><font color="#E5E5E5"> but then we</font>

195
00:11:07,089 --> 00:11:12,130
have a way<font color="#E5E5E5"> to combine them so</font><font color="#CCCCCC"> that at</font>

196
00:11:09,819 --> 00:11:16,149
<font color="#CCCCCC">the end we</font><font color="#E5E5E5"> get the correct</font><font color="#CCCCCC"> answer so</font>

197
00:11:12,130 --> 00:11:20,819
<font color="#CCCCCC">that's that's</font><font color="#E5E5E5"> another way</font><font color="#CCCCCC"> of computing</font>

198
00:11:16,149 --> 00:11:28,420
<font color="#E5E5E5">the same either encryption or signature</font>

199
00:11:20,819 --> 00:11:30,459
and to implement<font color="#E5E5E5"> RSA the most critical</font>

200
00:11:28,420 --> 00:11:33,790
operation is the exponentiation because

201
00:11:30,459 --> 00:11:37,569
we are talking<font color="#CCCCCC"> about numbers of 1024 or</font>

202
00:11:33,790 --> 00:11:40,089
2048 bits or if you if we talk about<font color="#E5E5E5"> CRT</font>

203
00:11:37,569 --> 00:11:42,099
then it's half of<font color="#E5E5E5"> the size that means we</font>

204
00:11:40,089 --> 00:11:44,819
have to raise<font color="#E5E5E5"> the numbers to such large</font>

205
00:11:42,100 --> 00:11:48,590
<font color="#E5E5E5">powers and this</font><font color="#CCCCCC"> is a costly operation</font>

206
00:11:44,819 --> 00:11:52,459
<font color="#CCCCCC">okay</font><font color="#E5E5E5"> so there are</font>

207
00:11:48,590 --> 00:11:55,430
ways to<font color="#CCCCCC"> improve the efficiency and if</font>

208
00:11:52,460 --> 00:11:59,300
you talk<font color="#CCCCCC"> about the basic implement is</font>

209
00:11:55,430 --> 00:12:04,069
what we call<font color="#E5E5E5"> square and multiply yeah</font><font color="#CCCCCC"> so</font>

210
00:11:59,300 --> 00:12:07,870
here what we do is if this<font color="#E5E5E5"> if the</font>

211
00:12:04,070 --> 00:12:12,500
exponent bit is<font color="#CCCCCC"> zero we</font><font color="#E5E5E5"> just do square</font>

212
00:12:07,870 --> 00:12:14,780
if it<font color="#E5E5E5"> is one we do both square and</font>

213
00:12:12,500 --> 00:12:20,060
multiplication<font color="#E5E5E5"> so there is a clear</font>

214
00:12:14,780 --> 00:12:21,380
<font color="#E5E5E5">difference</font><font color="#CCCCCC"> let me show you a bit more in</font>

215
00:12:20,060 --> 00:12:25,819
detail how<font color="#E5E5E5"> this works</font>

216
00:12:21,380 --> 00:12:30,380
yeah we have the modular exponentiation

217
00:12:25,820 --> 00:12:36,410
<font color="#E5E5E5">and the exponent length is let's say</font><font color="#CCCCCC"> L</font>

218
00:12:30,380 --> 00:12:46,760
and you initialize this to your message

219
00:12:36,410 --> 00:12:51,199
<font color="#CCCCCC">m</font><font color="#E5E5E5"> okay it's quite straightforward</font>

220
00:12:46,760 --> 00:12:55,430
algorithm<font color="#E5E5E5"> you you go through</font><font color="#CCCCCC"> bit every</font>

221
00:12:51,200 --> 00:13:00,050
bit from left<font color="#E5E5E5"> to right and then see if</font>

222
00:12:55,430 --> 00:13:05,000
the<font color="#E5E5E5"> bit</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> 0 or 1</font><font color="#CCCCCC"> if it's</font><font color="#E5E5E5"> 0 you just do</font>

223
00:13:00,050 --> 00:13:09,050
the square<font color="#E5E5E5"> and then return</font><font color="#CCCCCC"> back if it is</font>

224
00:13:05,000 --> 00:13:10,880
1<font color="#CCCCCC"> then you also do the multiplication</font><font color="#E5E5E5"> so</font>

225
00:13:09,050 --> 00:13:14,120
there<font color="#E5E5E5"> there's clear cut difference</font>

226
00:13:10,880 --> 00:13:15,620
between<font color="#CCCCCC"> bit 0 and bit 1 this</font><font color="#E5E5E5"> can</font>

227
00:13:14,120 --> 00:13:18,890
<font color="#CCCCCC">actually be used in a straight forward</font>

228
00:13:15,620 --> 00:13:21,560
<font color="#E5E5E5">timing attack because it takes different</font>

229
00:13:18,890 --> 00:13:28,189
amounts of time depending on<font color="#E5E5E5"> the secret</font>

230
00:13:21,560 --> 00:13:31,489
key bit so there<font color="#E5E5E5"> are several sequences</font>

231
00:13:28,190 --> 00:13:35,540
of operations<font color="#CCCCCC"> square multiplication</font><font color="#E5E5E5"> and</font>

232
00:13:31,490 --> 00:13:41,150
square and<font color="#E5E5E5"> sometimes you just go from</font>

233
00:13:35,540 --> 00:13:43,939
square<font color="#CCCCCC"> to square ok i'll skip</font><font color="#E5E5E5"> this but</font>

234
00:13:41,150 --> 00:13:49,360
this is just<font color="#CCCCCC"> the algorithm of what what</font>

235
00:13:43,940 --> 00:13:49,360
<font color="#CCCCCC">i</font><font color="#E5E5E5"> just mentioned but you can see that</font>

236
00:13:51,040 --> 00:14:02,550
you can see<font color="#E5E5E5"> that these</font><font color="#CCCCCC"> two the in this</font>

237
00:13:59,450 --> 00:14:05,700
<font color="#E5E5E5">particular operation the multiplication</font>

238
00:14:02,550 --> 00:14:09,209
what we are doing<font color="#CCCCCC"> M is going</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> same</font>

239
00:14:05,700 --> 00:14:11,339
for<font color="#E5E5E5"> every multiplication yeah so because</font>

240
00:14:09,209 --> 00:14:13,739
the message<font color="#CCCCCC"> M is</font><font color="#E5E5E5"> constant that is where</font>

241
00:14:11,339 --> 00:14:17,790
we are<font color="#E5E5E5"> operating on and if you take the</font>

242
00:14:13,740 --> 00:14:21,300
<font color="#E5E5E5">power trace and then try to take two</font>

243
00:14:17,790 --> 00:14:25,829
<font color="#E5E5E5">places where this M is being manipulated</font>

244
00:14:21,300 --> 00:14:29,729
you can see a definite correlation<font color="#E5E5E5"> so</font>

245
00:14:25,829 --> 00:14:32,699
that means if<font color="#E5E5E5"> you</font><font color="#CCCCCC"> take any trace and try</font>

246
00:14:29,730 --> 00:14:35,970
to do a<font color="#E5E5E5"> correlation on it compute the</font>

247
00:14:32,700 --> 00:14:40,410
correlation on this power values you<font color="#E5E5E5"> see</font>

248
00:14:35,970 --> 00:14:45,060
<font color="#CCCCCC">a certain spike</font><font color="#E5E5E5"> when the message</font><font color="#CCCCCC"> M is</font>

249
00:14:40,410 --> 00:14:48,420
being used<font color="#E5E5E5"> so</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> is what we can use to</font>

250
00:14:45,060 --> 00:14:51,300
see if the operation was<font color="#E5E5E5"> just square or</font>

251
00:14:48,420 --> 00:14:55,010
multiplication and<font color="#CCCCCC"> that can be actually</font>

252
00:14:51,300 --> 00:14:55,010
used to read out the full secret key

253
00:14:55,220 --> 00:15:02,970
this<font color="#CCCCCC"> is actually a just a simulation of</font>

254
00:14:58,950 --> 00:15:07,850
<font color="#E5E5E5">what I just explained you</font><font color="#CCCCCC"> have the</font><font color="#E5E5E5"> the</font>

255
00:15:02,970 --> 00:15:14,880
bits<font color="#E5E5E5"> both on the rows and columns</font><font color="#CCCCCC"> and</font>

256
00:15:07,850 --> 00:15:16,670
then when<font color="#CCCCCC"> your when your</font><font color="#E5E5E5"> bit is 1 that</font>

257
00:15:14,880 --> 00:15:22,290
<font color="#E5E5E5">means the multiplication is happening</font>

258
00:15:16,670 --> 00:15:25,829
you see a certain energy<font color="#CCCCCC"> here</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> by</font>

259
00:15:22,290 --> 00:15:27,719
<font color="#E5E5E5">looking at this figure you can directly</font>

260
00:15:25,829 --> 00:15:33,089
read out the key because<font color="#E5E5E5"> this means this</font>

261
00:15:27,720 --> 00:15:35,430
bit is 1 0<font color="#CCCCCC"> 1 0 and so on so just if</font><font color="#E5E5E5"> you</font>

262
00:15:33,089 --> 00:15:38,550
compute<font color="#E5E5E5"> the correlation on this</font>

263
00:15:35,430 --> 00:15:40,829
particular trace and then you have<font color="#E5E5E5"> this</font>

264
00:15:38,550 --> 00:15:48,149
<font color="#CCCCCC">picture</font><font color="#E5E5E5"> and then that's it you</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> I can</font>

265
00:15:40,829 --> 00:15:51,060
find out what the secret give us this<font color="#E5E5E5"> is</font>

266
00:15:48,149 --> 00:15:53,430
<font color="#E5E5E5">actually a power trace that we collected</font>

267
00:15:51,060 --> 00:15:57,300
when RSA is happening and the

268
00:15:53,430 --> 00:16:00,300
exponentiation was<font color="#CCCCCC"> basic square</font><font color="#E5E5E5"> and</font>

269
00:15:57,300 --> 00:16:02,670
multiply<font color="#E5E5E5"> and you can already see there</font>

270
00:16:00,300 --> 00:16:06,359
is a huge difference between<font color="#E5E5E5"> when the</font>

271
00:16:02,670 --> 00:16:08,099
operation was just<font color="#CCCCCC"> Square and when the</font>

272
00:16:06,360 --> 00:16:10,019
operation was<font color="#E5E5E5"> Square and</font><font color="#CCCCCC"> multiplied</font><font color="#E5E5E5"> so</font>

273
00:16:08,100 --> 00:16:13,320
there is a huge<font color="#CCCCCC"> difference and then even</font>

274
00:16:10,019 --> 00:16:16,910
this can be used<font color="#E5E5E5"> to find out what is its</font>

275
00:16:13,320 --> 00:16:16,910
particular secret<font color="#E5E5E5"> key bit is</font>

276
00:16:17,050 --> 00:16:22,069
<font color="#E5E5E5">okay that was a very straightforward</font>

277
00:16:19,160 --> 00:16:24,230
implementation as I mentioned but there

278
00:16:22,069 --> 00:16:28,250
<font color="#CCCCCC">exists countermeasures and one of them</font>

279
00:16:24,230 --> 00:16:36,319
is<font color="#CCCCCC"> multiply always which as you can</font>

280
00:16:28,250 --> 00:16:39,500
guess which as you can<font color="#E5E5E5"> guess is going to</font>

281
00:16:36,319 --> 00:16:43,459
<font color="#CCCCCC">do the multiplication irrespective of</font>

282
00:16:39,500 --> 00:16:45,529
the bit is<font color="#CCCCCC"> 0 or 1 right so now you</font><font color="#E5E5E5"> can't</font>

283
00:16:43,459 --> 00:16:51,219
<font color="#E5E5E5">really just look at the trace and say oh</font>

284
00:16:45,529 --> 00:16:54,920
this must be<font color="#CCCCCC"> 0 this</font><font color="#E5E5E5"> must be 1 yeah so</font>

285
00:16:51,220 --> 00:16:59,420
every time you do the multiplication<font color="#E5E5E5"> but</font>

286
00:16:54,920 --> 00:17:02,389
you only take the<font color="#E5E5E5"> result into account if</font>

287
00:16:59,420 --> 00:17:07,668
that bit was<font color="#CCCCCC"> 1</font><font color="#E5E5E5"> if the bit</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> 0 you just</font>

288
00:17:02,389 --> 00:17:11,000
discard the result so that<font color="#CCCCCC"> means you do</font>

289
00:17:07,669 --> 00:17:13,610
you follow<font color="#E5E5E5"> the same path irrespective of</font>

290
00:17:11,000 --> 00:17:16,189
whether the bit is 0 or<font color="#CCCCCC"> 1 but</font><font color="#E5E5E5"> only in</font>

291
00:17:13,609 --> 00:17:18,979
one<font color="#E5E5E5"> case you're</font><font color="#CCCCCC"> going</font><font color="#E5E5E5"> to can take the</font>

292
00:17:16,189 --> 00:17:23,449
result in the<font color="#E5E5E5"> other case you're going to</font>

293
00:17:18,980 --> 00:17:27,980
discard<font color="#E5E5E5"> it so this will make the simple</font>

294
00:17:23,449 --> 00:17:30,110
attacks<font color="#E5E5E5"> like like I</font><font color="#CCCCCC"> just showed if not</font>

295
00:17:27,980 --> 00:17:33,049
<font color="#CCCCCC">possible because</font><font color="#E5E5E5"> it takes the same</font>

296
00:17:30,110 --> 00:17:37,219
<font color="#E5E5E5">amount of time and same if you see the</font>

297
00:17:33,049 --> 00:17:41,860
power<font color="#E5E5E5"> trace is going to be similar yeah</font>

298
00:17:37,220 --> 00:17:44,450
<font color="#E5E5E5">and this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> here it's a bit important</font>

299
00:17:41,860 --> 00:17:47,860
<font color="#CCCCCC">what is the sequence</font><font color="#E5E5E5"> of operation going</font>

300
00:17:44,450 --> 00:17:50,929
to be so here sometimes you<font color="#CCCCCC"> have square</font>

301
00:17:47,860 --> 00:17:53,600
multiplication<font color="#E5E5E5"> and square and sometimes</font>

302
00:17:50,929 --> 00:17:56,120
<font color="#CCCCCC">you have square</font><font color="#E5E5E5"> multiplication and</font>

303
00:17:53,600 --> 00:18:01,000
discard<font color="#E5E5E5"> so you are discarding the result</font>

304
00:17:56,120 --> 00:18:01,000
and then you<font color="#E5E5E5"> follow it with the square</font>

305
00:18:02,230 --> 00:18:09,710
<font color="#CCCCCC">ok again</font><font color="#E5E5E5"> what are the operations that</font>

306
00:18:06,950 --> 00:18:13,669
<font color="#E5E5E5">are sharing one particular operand here</font>

307
00:18:09,710 --> 00:18:18,470
earlier it<font color="#E5E5E5"> was M right M is same</font><font color="#CCCCCC"> for</font>

308
00:18:13,669 --> 00:18:20,450
<font color="#E5E5E5">every multiplication so that means</font><font color="#CCCCCC"> when</font>

309
00:18:18,470 --> 00:18:24,320
you when you compute<font color="#E5E5E5"> the correlation it</font>

310
00:18:20,450 --> 00:18:27,950
will stand out<font color="#E5E5E5"> but even here we have a</font>

311
00:18:24,320 --> 00:18:29,149
certain value<font color="#E5E5E5"> which is shared and that</font>

312
00:18:27,950 --> 00:18:36,499
<font color="#E5E5E5">is</font>

313
00:18:29,149 --> 00:18:41,119
<font color="#E5E5E5">to the s used here in the next iteration</font>

314
00:18:36,499 --> 00:18:45,499
is same as the s used here<font color="#CCCCCC"> if you</font>

315
00:18:41,119 --> 00:18:48,408
discard it right<font color="#E5E5E5"> so if you continue this</font>

316
00:18:45,499 --> 00:18:50,179
s is if the bit is<font color="#E5E5E5"> 1 this</font><font color="#CCCCCC"> s</font><font color="#E5E5E5"> is going to</font>

317
00:18:48,409 --> 00:18:54,289
<font color="#E5E5E5">be different when you use in the next</font>

318
00:18:50,179 --> 00:18:57,499
iteration but if it's<font color="#CCCCCC"> 0</font><font color="#E5E5E5"> and in which</font>

319
00:18:54,289 --> 00:19:01,309
case with this car<font color="#E5E5E5"> this s and this s is</font>

320
00:18:57,499 --> 00:19:04,249
<font color="#E5E5E5">going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> be same</font><font color="#CCCCCC"> so again</font><font color="#E5E5E5"> by combining</font>

321
00:19:01,309 --> 00:19:07,039
the power<font color="#E5E5E5"> consumption at these two</font>

322
00:19:04,249 --> 00:19:11,629
<font color="#E5E5E5">points you</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> see a correlation which</font>

323
00:19:07,039 --> 00:19:15,070
can be used<font color="#E5E5E5"> to read out the key again so</font>

324
00:19:11,629 --> 00:19:19,089
we do the<font color="#E5E5E5"> same attack but now with</font>

325
00:19:15,070 --> 00:19:21,918
<font color="#CCCCCC">multiply always</font><font color="#E5E5E5"> countermeasures enable</font>

326
00:19:19,089 --> 00:19:22,609
the figure now<font color="#E5E5E5"> will be slightly</font>

327
00:19:21,919 --> 00:19:27,619
different

328
00:19:22,609 --> 00:19:30,859
but again you can<font color="#E5E5E5"> see that there</font><font color="#CCCCCC"> are</font>

329
00:19:27,619 --> 00:19:36,619
places<font color="#E5E5E5"> where</font><font color="#CCCCCC"> you can</font><font color="#E5E5E5"> see a square which</font>

330
00:19:30,859 --> 00:19:41,149
<font color="#CCCCCC">is much more</font><font color="#E5E5E5"> like spread across four</font>

331
00:19:36,619 --> 00:19:42,678
blocks<font color="#E5E5E5"> at least so in this case that</font>

332
00:19:41,149 --> 00:19:46,789
means<font color="#E5E5E5"> the there are two operations</font>

333
00:19:42,679 --> 00:19:51,320
<font color="#CCCCCC">sharing an</font><font color="#E5E5E5"> operand which is s and that</font>

334
00:19:46,789 --> 00:19:53,690
means the bit is 0 so this the<font color="#E5E5E5"> same</font>

335
00:19:51,320 --> 00:19:58,999
attack can actually be used even<font color="#E5E5E5"> if you</font>

336
00:19:53,690 --> 00:20:07,639
use<font color="#CCCCCC"> multiplayer less confirmation that's</font>

337
00:19:58,999 --> 00:20:09,109
<font color="#E5E5E5">what you take ok yeah so to just give a</font>

338
00:20:07,639 --> 00:20:13,248
<font color="#CCCCCC">logical conclusion to what I've been</font>

339
00:20:09,109 --> 00:20:18,109
telling<font color="#CCCCCC"> you have a basic exponentiation</font>

340
00:20:13,249 --> 00:20:20,869
<font color="#E5E5E5">which</font><font color="#CCCCCC"> is binary</font><font color="#E5E5E5"> that can be attacked by</font>

341
00:20:18,109 --> 00:20:23,149
using cross correlation but even if you

342
00:20:20,869 --> 00:20:25,939
do a simple<font color="#CCCCCC"> current</font><font color="#E5E5E5"> dimension</font><font color="#CCCCCC"> like</font>

343
00:20:23,149 --> 00:20:28,908
<font color="#CCCCCC">multiply always we can</font><font color="#E5E5E5"> still do the</font>

344
00:20:25,940 --> 00:20:32,599
cross correlation attack and read out

345
00:20:28,909 --> 00:20:36,529
the key and then<font color="#CCCCCC"> Akash</font><font color="#E5E5E5"> will take over</font>

346
00:20:32,599 --> 00:20:40,428
<font color="#E5E5E5">and talk about how we how the open ssl</font>

347
00:20:36,529 --> 00:20:42,050
RSA<font color="#E5E5E5"> implements exponentiation and then</font>

348
00:20:40,429 --> 00:20:45,890
we give

349
00:20:42,050 --> 00:20:48,200
full<font color="#E5E5E5"> attack part from measuring and then</font>

350
00:20:45,890 --> 00:20:54,860
how we actually<font color="#E5E5E5"> process</font><font color="#CCCCCC"> these traces</font><font color="#E5E5E5"> and</font>

351
00:20:48,200 --> 00:21:04,460
then how we got the<font color="#E5E5E5"> secret key out okay</font>

352
00:20:54,860 --> 00:21:07,879
<font color="#E5E5E5">so</font><font color="#CCCCCC"> a so these implementations that were</font>

353
00:21:04,460 --> 00:21:09,650
shown here<font color="#E5E5E5"> they are they are</font><font color="#CCCCCC"> not very</font>

354
00:21:07,880 --> 00:21:11,420
commonly used these are things<font color="#CCCCCC"> that used</font>

355
00:21:09,650 --> 00:21:12,950
to<font color="#E5E5E5"> be used maybe</font><font color="#CCCCCC"> 10 years</font><font color="#E5E5E5"> ago</font><font color="#CCCCCC"> or</font>

356
00:21:11,420 --> 00:21:16,429
<font color="#E5E5E5">something like</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> it's still</font><font color="#CCCCCC"> possible</font>

357
00:21:12,950 --> 00:21:18,920
<font color="#E5E5E5">to switch to see it sometimes but in</font>

358
00:21:16,429 --> 00:21:22,190
<font color="#CCCCCC">open SSL that they decide to</font><font color="#E5E5E5"> use</font>

359
00:21:18,920 --> 00:21:23,800
<font color="#E5E5E5">different implementation so this is a</font>

360
00:21:22,190 --> 00:21:26,780
<font color="#E5E5E5">kre</font>

361
00:21:23,800 --> 00:21:28,790
exponentiation method so previously as

362
00:21:26,780 --> 00:21:30,230
far as I remember<font color="#E5E5E5"> in</font><font color="#CCCCCC"> the open</font><font color="#E5E5E5"> SSL there</font>

363
00:21:28,790 --> 00:21:33,020
was some<font color="#E5E5E5"> kind of windowed method</font>

364
00:21:30,230 --> 00:21:37,280
<font color="#E5E5E5">implemented but you do to the timing</font>

365
00:21:33,020 --> 00:21:39,559
cutbacks and<font color="#E5E5E5"> cached attacks they decided</font>

366
00:21:37,280 --> 00:21:44,590
<font color="#CCCCCC">to implement a bit more regular method</font>

367
00:21:39,559 --> 00:21:51,559
<font color="#E5E5E5">so forget for our fault injection and</font>

368
00:21:44,590 --> 00:21:57,199
<font color="#E5E5E5">and side channel analysis R&D just to</font>

369
00:21:51,559 --> 00:22:01,550
have fun<font color="#CCCCCC"> and discover new techniques</font><font color="#E5E5E5"> it</font>

370
00:21:57,200 --> 00:22:03,140
<font color="#E5E5E5">can run at 168 megahertz</font><font color="#CCCCCC"> and that's</font>

371
00:22:01,550 --> 00:22:05,090
actually<font color="#E5E5E5"> the implementation</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> we will</font>

372
00:22:03,140 --> 00:22:09,020
attack it's possible to clock it with<font color="#E5E5E5"> 30</font>

373
00:22:05,090 --> 00:22:11,570
<font color="#E5E5E5">megahertz and yeah did we actually clock</font>

374
00:22:09,020 --> 00:22:13,879
it at 30 or<font color="#E5E5E5"> at 168</font><font color="#CCCCCC"> okay so here in this</font>

375
00:22:11,570 --> 00:22:15,800
case<font color="#CCCCCC"> we clocked it at 30 but we also did</font>

376
00:22:13,880 --> 00:22:17,480
the<font color="#E5E5E5"> same effect</font><font color="#CCCCCC"> so the the problem is</font>

377
00:22:15,800 --> 00:22:19,520
<font color="#E5E5E5">exactly what's mentioned is</font><font color="#CCCCCC"> that flash</font>

378
00:22:17,480 --> 00:22:21,559
<font color="#CCCCCC">waiting cycles so it may happen that</font>

379
00:22:19,520 --> 00:22:25,540
there<font color="#CCCCCC"> will occur jitter when you do to</font>

380
00:22:21,559 --> 00:22:29,990
do some flash caching of<font color="#E5E5E5"> instructions</font>

381
00:22:25,540 --> 00:22:34,690
but anyway we did it<font color="#CCCCCC"> also for 168 the</font>

382
00:22:29,990 --> 00:22:34,690
misalignment<font color="#E5E5E5"> is small difference in time</font>

383
00:22:35,050 --> 00:22:39,710
<font color="#CCCCCC">okay this is this is designed by us</font><font color="#E5E5E5"> as</font>

384
00:22:37,460 --> 00:22:41,600
the realistic training<font color="#E5E5E5"> target so we</font><font color="#CCCCCC"> have</font>

385
00:22:39,710 --> 00:22:43,309
source code we<font color="#E5E5E5"> can modify it and then we</font>

386
00:22:41,600 --> 00:22:45,139
we know what's happening<font color="#E5E5E5"> so essentially</font>

387
00:22:43,309 --> 00:22:47,899
we<font color="#CCCCCC"> attacked software implementation</font>

388
00:22:45,140 --> 00:22:51,470
there was no crypto<font color="#CCCCCC"> hardware crypto</font>

389
00:22:47,900 --> 00:22:52,970
accelerator or something<font color="#CCCCCC"> at all though I</font>

390
00:22:51,470 --> 00:22:55,360
<font color="#E5E5E5">still believe that would be also</font>

391
00:22:52,970 --> 00:22:57,920
breakable even then

392
00:22:55,360 --> 00:22:59,590
actually now and I<font color="#E5E5E5"> think about</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> even</font>

393
00:22:57,920 --> 00:23:02,330
<font color="#E5E5E5">if there was a crypto accelerator</font>

394
00:22:59,590 --> 00:23:04,399
<font color="#CCCCCC">OpenSSL doesn't use it</font><font color="#E5E5E5"> by default maybe</font>

395
00:23:02,330 --> 00:23:09,350
with some flag settings it's possible to

396
00:23:04,400 --> 00:23:10,880
turn it on<font color="#E5E5E5"> okay we will use power</font>

397
00:23:09,350 --> 00:23:13,699
consumption<font color="#E5E5E5"> so essentially we will</font>

398
00:23:10,880 --> 00:23:19,520
measure it<font color="#E5E5E5"> at 3.3 volt pin as far as I</font>

399
00:23:13,700 --> 00:23:25,790
<font color="#CCCCCC">remember it's this one</font><font color="#E5E5E5"> and then ground</font>

400
00:23:19,520 --> 00:23:28,400
<font color="#E5E5E5">are pretty much all these pins so okay</font>

401
00:23:25,790 --> 00:23:30,980
here is no need for amplifier so

402
00:23:28,400 --> 00:23:33,110
essentially there are on the other side

403
00:23:30,980 --> 00:23:35,420
<font color="#CCCCCC">there are some capacitors</font><font color="#E5E5E5"> so we just</font>

404
00:23:33,110 --> 00:23:38,030
removed them removed<font color="#E5E5E5"> as many as we could</font>

405
00:23:35,420 --> 00:23:39,920
<font color="#E5E5E5">so the board still works</font><font color="#CCCCCC"> then the</font><font color="#E5E5E5"> signal</font>

406
00:23:38,030 --> 00:23:43,309
using current probe<font color="#E5E5E5"> I think there is a</font>

407
00:23:39,920 --> 00:23:45,110
<font color="#E5E5E5">picture okay</font><font color="#CCCCCC"> maybe</font><font color="#E5E5E5"> not anyway there is</font>

408
00:23:43,309 --> 00:23:47,120
we<font color="#E5E5E5"> are using current probe we remove</font>

409
00:23:45,110 --> 00:23:49,790
capacitors we will be<font color="#E5E5E5"> able to see signal</font>

410
00:23:47,120 --> 00:23:54,820
we<font color="#E5E5E5"> will see traces in</font><font color="#CCCCCC"> him in a second we</font>

411
00:23:49,790 --> 00:23:56,840
used<font color="#CCCCCC"> picol scope 3 to 0 7 B</font><font color="#E5E5E5"> this is a</font>

412
00:23:54,820 --> 00:24:00,439
relatively<font color="#E5E5E5"> nice model with a lot of</font>

413
00:23:56,840 --> 00:24:06,010
<font color="#E5E5E5">memory so we were able</font><font color="#CCCCCC"> to to capture</font><font color="#E5E5E5"> all</font>

414
00:24:00,440 --> 00:24:09,110
the all the<font color="#E5E5E5"> all the execution of RSA</font>

415
00:24:06,010 --> 00:24:12,830
<font color="#CCCCCC">excused some relatively</font><font color="#E5E5E5"> stable external</font>

416
00:24:09,110 --> 00:24:15,320
power supply<font color="#CCCCCC"> we also since</font><font color="#E5E5E5"> we wrote the</font>

417
00:24:12,830 --> 00:24:18,860
code we just generate a trigger on a

418
00:24:15,320 --> 00:24:19,939
GPIO pin just<font color="#E5E5E5"> before just before the</font>

419
00:24:18,860 --> 00:24:21,800
decryption so essentially<font color="#E5E5E5"> our</font>

420
00:24:19,940 --> 00:24:26,050
oscilloscope will be<font color="#CCCCCC"> able to in</font><font color="#E5E5E5"> real</font>

421
00:24:21,800 --> 00:24:28,700
<font color="#E5E5E5">time to know now there sa is happening</font><font color="#CCCCCC"> a</font>

422
00:24:26,050 --> 00:24:30,379
communication is through FTDI cable<font color="#E5E5E5"> then</font>

423
00:24:28,700 --> 00:24:34,940
again current<font color="#E5E5E5"> probe that's our in-house</font>

424
00:24:30,380 --> 00:24:36,770
hardware<font color="#E5E5E5"> and we use the</font><font color="#CCCCCC"> ddd our our</font>

425
00:24:34,940 --> 00:24:41,470
software<font color="#E5E5E5"> risk our inspector for</font>

426
00:24:36,770 --> 00:24:46,400
acquisition and for the analysis<font color="#CCCCCC"> ok</font>

427
00:24:41,470 --> 00:24:50,720
let's<font color="#E5E5E5"> I will just</font><font color="#CCCCCC"> play</font><font color="#E5E5E5"> the whole</font><font color="#CCCCCC"> setup</font>

428
00:24:46,400 --> 00:24:56,990
<font color="#CCCCCC">when it's ready ok sorry</font><font color="#E5E5E5"> ok so what will</font>

429
00:24:50,720 --> 00:24:58,970
happen<font color="#E5E5E5"> here</font><font color="#CCCCCC"> is that</font><font color="#E5E5E5"> ok first of all</font>

430
00:24:56,990 --> 00:25:02,059
there is connected the current probe so

431
00:24:58,970 --> 00:25:03,740
that will collect<font color="#E5E5E5"> them</font><font color="#CCCCCC"> the power</font>

432
00:25:02,059 --> 00:25:05,420
consumption<font color="#CCCCCC"> will be collected</font><font color="#E5E5E5"> and sent</font>

433
00:25:03,740 --> 00:25:08,310
to<font color="#E5E5E5"> oscilloscope so there is just</font><font color="#CCCCCC"> a cable</font>

434
00:25:05,420 --> 00:25:10,110
<font color="#E5E5E5">connected now our</font>

435
00:25:08,310 --> 00:25:12,629
<font color="#CCCCCC">PC first</font><font color="#E5E5E5"> will say to the oscilloscope</font>

436
00:25:10,110 --> 00:25:14,729
<font color="#CCCCCC">now be ready to capture</font><font color="#E5E5E5"> the traces so</font>

437
00:25:12,630 --> 00:25:18,120
then<font color="#E5E5E5"> this moment oscilloscope starts</font>

438
00:25:14,730 --> 00:25:20,760
waiting for any signal<font color="#CCCCCC"> from them</font><font color="#E5E5E5"> from</font>

439
00:25:18,120 --> 00:25:23,909
from here from the<font color="#E5E5E5"> embedded system then</font>

440
00:25:20,760 --> 00:25:27,720
from PC<font color="#E5E5E5"> fro FTDI cable we send a</font><font color="#CCCCCC"> comment</font>

441
00:25:23,910 --> 00:25:30,450
that essentially says and performers say

442
00:25:27,720 --> 00:25:32,160
on this ciphertext<font color="#CCCCCC"> then the device will</font>

443
00:25:30,450 --> 00:25:34,920
start<font color="#E5E5E5"> doing its magic so we'll do the</font>

444
00:25:32,160 --> 00:25:38,670
blind link or anything<font color="#E5E5E5"> that that we</font>

445
00:25:34,920 --> 00:25:41,880
mentioned<font color="#CCCCCC"> before and then before</font><font color="#E5E5E5"> the the</font>

446
00:25:38,670 --> 00:25:44,160
real operation starts<font color="#E5E5E5"> it sends it sends</font>

447
00:25:41,880 --> 00:25:48,600
the<font color="#CCCCCC"> information</font><font color="#E5E5E5"> okay now the now please</font>

448
00:25:44,160 --> 00:25:50,280
start measuring then it of course

449
00:25:48,600 --> 00:25:53,429
computer everything sends the<font color="#E5E5E5"> response</font>

450
00:25:50,280 --> 00:25:55,440
and the the oscilloscope sends the

451
00:25:53,430 --> 00:25:58,860
signal the<font color="#CCCCCC"> digital I signal already to</font>

452
00:25:55,440 --> 00:26:01,110
to<font color="#E5E5E5"> our PC and then we can observe our</font>

453
00:25:58,860 --> 00:26:07,770
trace<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is by</font><font color="#E5E5E5"> the way not</font><font color="#CCCCCC"> the trace</font>

454
00:26:01,110 --> 00:26:09,659
not ever say but probably does<font color="#CCCCCC"> okay what</font>

455
00:26:07,770 --> 00:26:12,240
sampling frequency did you use so there

456
00:26:09,660 --> 00:26:14,670
are there<font color="#E5E5E5"> are some</font><font color="#CCCCCC"> details about</font>

457
00:26:12,240 --> 00:26:18,240
acquisition that<font color="#E5E5E5"> we again didn't go into</font>

458
00:26:14,670 --> 00:26:20,640
detail but we have to sample<font color="#E5E5E5"> at higher</font>

459
00:26:18,240 --> 00:26:24,390
frequency that the target<font color="#E5E5E5"> works in this</font>

460
00:26:20,640 --> 00:26:26,580
case it was<font color="#E5E5E5"> 30 megahertz there are some</font>

461
00:26:24,390 --> 00:26:29,520
theories<font color="#CCCCCC"> but rule of thumb we should go</font>

462
00:26:26,580 --> 00:26:31,860
at least<font color="#CCCCCC"> 5 times</font><font color="#E5E5E5"> more so if it was 40</font>

463
00:26:29,520 --> 00:26:33,960
megahertz<font color="#CCCCCC"> than we should</font><font color="#E5E5E5"> have should be</font>

464
00:26:31,860 --> 00:26:37,350
<font color="#E5E5E5">capturing at 650 million samples per</font>

465
00:26:33,960 --> 00:26:39,570
second<font color="#E5E5E5"> we go a bit</font><font color="#CCCCCC"> higher</font><font color="#E5E5E5"> so go 250</font>

466
00:26:37,350 --> 00:26:41,490
million<font color="#CCCCCC"> samples per second why because</font>

467
00:26:39,570 --> 00:26:43,679
we<font color="#E5E5E5"> have space on our</font><font color="#CCCCCC"> oscilloscope and</font>

468
00:26:41,490 --> 00:26:47,070
<font color="#E5E5E5">it's</font><font color="#CCCCCC"> always better to over sample than</font>

469
00:26:43,680 --> 00:26:51,570
under sample or that's<font color="#E5E5E5"> it is what I</font>

470
00:26:47,070 --> 00:26:55,139
<font color="#CCCCCC">believe</font><font color="#E5E5E5"> number</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> samples 170 million</font>

471
00:26:51,570 --> 00:26:58,889
for the full operation so that's that's

472
00:26:55,140 --> 00:27:01,950
quite<font color="#E5E5E5"> a lot</font><font color="#CCCCCC"> it will</font><font color="#E5E5E5"> result in huge</font>

473
00:26:58,890 --> 00:27:05,430
traces but what's important is<font color="#E5E5E5"> it's 80</font>

474
00:27:01,950 --> 00:27:08,430
million for<font color="#E5E5E5"> the first exponentiation in</font>

475
00:27:05,430 --> 00:27:12,570
CRT so I'm not<font color="#E5E5E5"> sure</font><font color="#CCCCCC"> if you remember but</font>

476
00:27:08,430 --> 00:27:14,280
there<font color="#E5E5E5"> was</font><font color="#CCCCCC"> DP and DQ in there</font><font color="#E5E5E5"> sa CRT and</font>

477
00:27:12,570 --> 00:27:17,220
the question is do we need to<font color="#E5E5E5"> actually</font>

478
00:27:14,280 --> 00:27:19,170
<font color="#E5E5E5">recover both of them</font><font color="#CCCCCC"> fortunately there</font>

479
00:27:17,220 --> 00:27:21,300
<font color="#CCCCCC">are</font><font color="#E5E5E5"> mathematicians they worked out we</font>

480
00:27:19,170 --> 00:27:21,910
don't we<font color="#E5E5E5"> only we need one we only do DP</font>

481
00:27:21,300 --> 00:27:24,850
<font color="#E5E5E5">if we</font>

482
00:27:21,910 --> 00:27:26,410
<font color="#CCCCCC">cover</font><font color="#E5E5E5"> DP or DQ then we are done</font><font color="#CCCCCC"> the</font>

483
00:27:24,850 --> 00:27:29,379
second one can<font color="#CCCCCC"> be computed based</font><font color="#E5E5E5"> on the</font>

484
00:27:26,410 --> 00:27:32,350
public<font color="#CCCCCC"> key so we will the roughly</font>

485
00:27:29,380 --> 00:27:34,720
speaking<font color="#E5E5E5"> need 80 million okay these are</font>

486
00:27:32,350 --> 00:27:36,760
some<font color="#E5E5E5"> technical</font><font color="#CCCCCC"> details 150 millivolts so</font>

487
00:27:34,720 --> 00:27:39,880
that's the range for the for the

488
00:27:36,760 --> 00:27:42,450
oscilloscope<font color="#E5E5E5"> how much how much variation</font>

489
00:27:39,880 --> 00:27:45,280
there are so this<font color="#E5E5E5"> is to avoid some</font>

490
00:27:42,450 --> 00:27:47,500
issues with quantization errors or we've

491
00:27:45,280 --> 00:27:49,300
just set in<font color="#CCCCCC"> Costillo scope</font><font color="#E5E5E5"> not correctly</font>

492
00:27:47,500 --> 00:27:51,040
<font color="#E5E5E5">there are only</font><font color="#CCCCCC"> eight</font><font color="#E5E5E5"> bits that the</font>

493
00:27:49,300 --> 00:27:55,169
oscilloscope<font color="#CCCCCC"> can measure so we don't</font>

494
00:27:51,040 --> 00:27:57,700
want to waste too many of these<font color="#CCCCCC"> bits</font><font color="#E5E5E5"> and</font>

495
00:27:55,170 --> 00:28:04,390
<font color="#CCCCCC">how many</font><font color="#E5E5E5"> traces did we acquire for this</font>

496
00:27:57,700 --> 00:28:05,920
attack<font color="#CCCCCC"> ten thousand</font><font color="#E5E5E5"> well</font><font color="#CCCCCC"> that we</font>

497
00:28:04,390 --> 00:28:07,690
acquired as many as we need it

498
00:28:05,920 --> 00:28:09,490
essentially<font color="#E5E5E5"> if</font><font color="#CCCCCC"> we need it more we would</font>

499
00:28:07,690 --> 00:28:11,650
have continued we<font color="#E5E5E5"> succeed</font><font color="#CCCCCC"> if</font><font color="#E5E5E5"> if ten</font>

500
00:28:09,490 --> 00:28:13,390
<font color="#E5E5E5">thousand we</font><font color="#CCCCCC"> are done</font><font color="#E5E5E5"> we didn't succeed</font>

501
00:28:11,650 --> 00:28:18,190
<font color="#CCCCCC">obviously with thousand because</font><font color="#E5E5E5"> we tried</font>

502
00:28:13,390 --> 00:28:24,220
that first<font color="#E5E5E5"> okay so</font><font color="#CCCCCC"> how would how would</font>

503
00:28:18,190 --> 00:28:28,030
the trace look here<font color="#E5E5E5"> so this is even even</font>

504
00:28:24,220 --> 00:28:30,100
if I don't<font color="#E5E5E5"> know how really RSA even if I</font>

505
00:28:28,030 --> 00:28:31,540
didn't implement<font color="#E5E5E5"> it what I would look in</font>

506
00:28:30,100 --> 00:28:33,790
there<font color="#E5E5E5"> is a trace is essentially these</font>

507
00:28:31,540 --> 00:28:35,530
<font color="#E5E5E5">two</font><font color="#CCCCCC"> huge patterns because almost</font>

508
00:28:33,790 --> 00:28:38,110
everywhere<font color="#E5E5E5"> there is implemented errors a</font>

509
00:28:35,530 --> 00:28:40,330
CRT<font color="#E5E5E5"> that standard because it's roughly</font>

510
00:28:38,110 --> 00:28:43,600
speaking three times faster<font color="#E5E5E5"> or around</font>

511
00:28:40,330 --> 00:28:46,720
<font color="#E5E5E5">that so almost it is almost always two</font>

512
00:28:43,600 --> 00:28:48,070
huge patterns so this will be the

513
00:28:46,720 --> 00:28:50,860
exponentiation<font color="#E5E5E5"> number one this is</font>

514
00:28:48,070 --> 00:28:54,399
exponentiation number two in in RSA in

515
00:28:50,860 --> 00:28:57,520
in<font color="#CCCCCC"> open SSL they first</font><font color="#E5E5E5"> use DQ then the</font>

516
00:28:54,400 --> 00:28:59,470
second DP<font color="#E5E5E5"> what's happening before we can</font>

517
00:28:57,520 --> 00:29:04,930
just be guessing but maybe the modular

518
00:28:59,470 --> 00:29:06,760
inverse is happening<font color="#E5E5E5"> also somewhere we</font>

519
00:29:04,930 --> 00:29:08,650
should expect<font color="#E5E5E5"> the pre computations so</font>

520
00:29:06,760 --> 00:29:11,410
<font color="#E5E5E5">probably</font><font color="#CCCCCC"> just before</font><font color="#E5E5E5"> the real</font>

521
00:29:08,650 --> 00:29:13,000
explanation happens there is the there

522
00:29:11,410 --> 00:29:15,040
are some pre computations performed and

523
00:29:13,000 --> 00:29:18,280
what<font color="#E5E5E5"> we should expect</font><font color="#CCCCCC"> that the</font><font color="#E5E5E5"> at is</font>

524
00:29:15,040 --> 00:29:19,930
somewhere here<font color="#E5E5E5"> probably there may be</font>

525
00:29:18,280 --> 00:29:22,120
despite somewhere around these spikes

526
00:29:19,930 --> 00:29:24,940
there should<font color="#E5E5E5"> be this combining of two</font>

527
00:29:22,120 --> 00:29:26,229
messages<font color="#E5E5E5"> so of two parts so there is one</font>

528
00:29:24,940 --> 00:29:28,150
exponentiation second and then the

529
00:29:26,230 --> 00:29:33,300
result has<font color="#CCCCCC"> to be combined that's that's</font>

530
00:29:28,150 --> 00:29:36,240
what prevention<font color="#E5E5E5"> okay</font>

531
00:29:33,300 --> 00:29:39,750
yeah<font color="#E5E5E5"> so actually this trace</font><font color="#CCCCCC"> is quite</font>

532
00:29:36,240 --> 00:29:42,750
readable<font color="#CCCCCC"> okay so actually everything six</font>

533
00:29:39,750 --> 00:29:43,230
planes here so there again<font color="#E5E5E5"> recombination</font>

534
00:29:42,750 --> 00:29:46,650
is here

535
00:29:43,230 --> 00:29:50,090
we didn't mark it but it's there this is

536
00:29:46,650 --> 00:29:54,350
<font color="#E5E5E5">already slightly pre-process traced</font>

537
00:29:50,090 --> 00:29:54,350
<font color="#E5E5E5">essentially it's</font><font color="#CCCCCC"> just low past slightly</font>

538
00:29:54,530 --> 00:30:00,720
so again blinding it's actually my<font color="#E5E5E5"> best</font>

539
00:29:59,100 --> 00:30:06,629
guess that this<font color="#CCCCCC"> is the</font><font color="#E5E5E5"> inverse that's</font>

540
00:30:00,720 --> 00:30:09,330
what cost<font color="#E5E5E5"> time absolute to slope us okay</font>

541
00:30:06,630 --> 00:30:11,670
so here we<font color="#CCCCCC"> can</font><font color="#E5E5E5"> find</font><font color="#CCCCCC"> this nice pattern so</font>

542
00:30:09,330 --> 00:30:12,750
the the<font color="#CCCCCC"> first</font><font color="#E5E5E5"> step we it's not</font><font color="#CCCCCC"> visible</font>

543
00:30:11,670 --> 00:30:15,350
<font color="#CCCCCC">here because we are only showing one</font>

544
00:30:12,750 --> 00:30:18,060
trace but this is quite a lot<font color="#E5E5E5"> of time</font>

545
00:30:15,350 --> 00:30:19,620
<font color="#E5E5E5">okay we don't even give the time but we</font>

546
00:30:18,060 --> 00:30:23,040
<font color="#CCCCCC">are talking about</font><font color="#E5E5E5"> the whole operation is</font>

547
00:30:19,620 --> 00:30:25,280
probably<font color="#E5E5E5"> like</font><font color="#CCCCCC"> 500</font><font color="#E5E5E5"> milliseconds or</font>

548
00:30:23,040 --> 00:30:30,149
something like<font color="#E5E5E5"> that</font>

549
00:30:25,280 --> 00:30:32,370
<font color="#E5E5E5">650 okay 650 so how to what will happen</font>

550
00:30:30,150 --> 00:30:34,710
there<font color="#E5E5E5"> is supposedly everything is</font>

551
00:30:32,370 --> 00:30:35,969
constant time but not everything<font color="#E5E5E5"> is</font>

552
00:30:34,710 --> 00:30:37,980
really constant time<font color="#CCCCCC"> so there will be</font>

553
00:30:35,970 --> 00:30:40,410
quite<font color="#CCCCCC"> a</font><font color="#E5E5E5"> bit</font><font color="#CCCCCC"> of misalignment the other</font>

554
00:30:37,980 --> 00:30:45,600
thing will be<font color="#E5E5E5"> the trigger it's not very</font>

555
00:30:40,410 --> 00:30:47,850
it's never really perfect<font color="#E5E5E5"> so first to</font>

556
00:30:45,600 --> 00:30:50,040
<font color="#E5E5E5">start any analysis we</font><font color="#CCCCCC"> should somehow</font>

557
00:30:47,850 --> 00:30:51,719
<font color="#E5E5E5">have these traces that like each value</font>

558
00:30:50,040 --> 00:30:54,389
<font color="#CCCCCC">should be processed</font><font color="#E5E5E5"> exactly at the same</font>

559
00:30:51,720 --> 00:30:56,790
time in our traces<font color="#E5E5E5"> so what we need to do</font>

560
00:30:54,390 --> 00:30:59,370
we need<font color="#CCCCCC"> to start somehow the</font><font color="#E5E5E5"> alignment</font>

561
00:30:56,790 --> 00:31:03,330
so we first we zoom in somewhere here

562
00:30:59,370 --> 00:31:10,250
let's say<font color="#E5E5E5"> and we find this distinctive</font>

563
00:31:03,330 --> 00:31:14,340
pattern here<font color="#E5E5E5"> so we have we have the we</font>

564
00:31:10,250 --> 00:31:15,870
<font color="#CCCCCC">have in our software</font><font color="#E5E5E5"> tool there is a</font>

565
00:31:14,340 --> 00:31:18,030
<font color="#E5E5E5">mechanism to essentially align on</font>

566
00:31:15,870 --> 00:31:20,310
patterns it uses some it uses

567
00:31:18,030 --> 00:31:22,290
correlation essentially but roughly

568
00:31:20,310 --> 00:31:24,179
speaking<font color="#E5E5E5"> if we if these tools is to</font>

569
00:31:22,290 --> 00:31:29,629
<font color="#E5E5E5">similar</font><font color="#CCCCCC"> patterns somewhere it will</font><font color="#E5E5E5"> just</font>

570
00:31:24,180 --> 00:31:34,830
correct the<font color="#E5E5E5"> offset the time offset okay</font>

571
00:31:29,630 --> 00:31:36,510
<font color="#E5E5E5">this this is maybe not</font><font color="#CCCCCC"> the most exciting</font>

572
00:31:34,830 --> 00:31:40,919
part of<font color="#E5E5E5"> work but that usually</font><font color="#CCCCCC"> takes</font>

573
00:31:36,510 --> 00:31:42,690
<font color="#E5E5E5">quite a few trial and errors tries and</font>

574
00:31:40,920 --> 00:31:45,630
and and what we did is essentially we

575
00:31:42,690 --> 00:31:47,490
<font color="#CCCCCC">tried</font><font color="#E5E5E5"> manually as many times as we could</font>

576
00:31:45,630 --> 00:31:50,040
to<font color="#E5E5E5"> and visually check the trace</font>

577
00:31:47,490 --> 00:31:53,700
are they do<font color="#CCCCCC"> they seem aligned</font><font color="#E5E5E5"> and from</font>

578
00:31:50,040 --> 00:31:57,450
<font color="#E5E5E5">these</font><font color="#CCCCCC"> 10,000 traces after after enough</font>

579
00:31:53,700 --> 00:31:58,650
work we got<font color="#CCCCCC"> 8,000 traces that</font><font color="#E5E5E5"> that</font>

580
00:31:57,450 --> 00:32:01,740
seemed to<font color="#E5E5E5"> be aligned</font>

581
00:31:58,650 --> 00:32:05,790
what happened also<font color="#E5E5E5"> here yeah now I now I</font>

582
00:32:01,740 --> 00:32:08,429
see<font color="#E5E5E5"> I remember so we got this</font><font color="#CCCCCC"> 8,000</font>

583
00:32:05,790 --> 00:32:11,580
<font color="#E5E5E5">quite well aligned traces but what we</font>

584
00:32:08,429 --> 00:32:14,330
started<font color="#E5E5E5"> noticing is</font><font color="#CCCCCC"> that the trace</font>

585
00:32:11,580 --> 00:32:16,919
seemed to be slightly vertically moving

586
00:32:14,330 --> 00:32:19,260
<font color="#E5E5E5">that's usually big that's that sometimes</font>

587
00:32:16,920 --> 00:32:21,150
happens due to<font color="#CCCCCC"> the let</font><font color="#E5E5E5"> us imagine</font><font color="#CCCCCC"> that</font>

588
00:32:19,260 --> 00:32:23,720
<font color="#E5E5E5">we run this acquisition</font><font color="#CCCCCC"> it takes we</font><font color="#E5E5E5"> run</font>

589
00:32:21,150 --> 00:32:27,179
it for<font color="#E5E5E5"> the night the temperature changes</font>

590
00:32:23,720 --> 00:32:29,670
<font color="#CCCCCC">and then what happens is that the trace</font>

591
00:32:27,179 --> 00:32:32,280
starts moving slowly like for<font color="#CCCCCC"> example at</font>

592
00:32:29,670 --> 00:32:33,990
8<font color="#E5E5E5"> o clock in</font><font color="#CCCCCC"> the evening hits</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> may</font><font color="#E5E5E5"> be</font>

593
00:32:32,280 --> 00:32:35,550
somewhere high<font color="#E5E5E5"> because it was maybe</font>

594
00:32:33,990 --> 00:32:39,630
summer warm outside and<font color="#CCCCCC"> then it goes</font>

595
00:32:35,550 --> 00:32:41,040
<font color="#CCCCCC">slightly lower</font><font color="#E5E5E5"> this is this is</font><font color="#CCCCCC"> just this</font>

596
00:32:39,630 --> 00:32:42,600
problem of course can<font color="#CCCCCC"> be solved in some</font>

597
00:32:41,040 --> 00:32:45,870
kind<font color="#E5E5E5"> of controlled environment or really</font>

598
00:32:42,600 --> 00:32:48,120
stable temperature<font color="#E5E5E5"> but well we we</font>

599
00:32:45,870 --> 00:32:50,040
applied one of our modules<font color="#CCCCCC"> that one of</font>

600
00:32:48,120 --> 00:32:53,610
our<font color="#E5E5E5"> software tools let's say that that</font>

601
00:32:50,040 --> 00:32:55,080
that tries to compute the mean compute

602
00:32:53,610 --> 00:32:58,050
the variance<font color="#E5E5E5"> so and then correct</font>

603
00:32:55,080 --> 00:33:06,449
<font color="#E5E5E5">everything not the best but again it</font>

604
00:32:58,050 --> 00:33:09,540
worked<font color="#CCCCCC"> so we were happy okay another</font>

605
00:33:06,450 --> 00:33:11,700
<font color="#E5E5E5">thing maybe just to give a bit of</font>

606
00:33:09,540 --> 00:33:15,059
feeling this<font color="#E5E5E5"> alignment on 10,000 traces</font>

607
00:33:11,700 --> 00:33:18,570
already takes probably<font color="#E5E5E5"> an hour or two a</font>

608
00:33:15,059 --> 00:33:20,340
single try but what about the cross

609
00:33:18,570 --> 00:33:22,290
correlation cross correlation requires

610
00:33:20,340 --> 00:33:24,330
is<font color="#E5E5E5"> a squared algorithm</font><font color="#CCCCCC"> so we've seen</font>

611
00:33:22,290 --> 00:33:30,780
there were<font color="#CCCCCC"> this on the simulations</font>

612
00:33:24,330 --> 00:33:32,250
<font color="#E5E5E5">everything</font><font color="#CCCCCC"> were squares okay so we</font>

613
00:33:30,780 --> 00:33:34,889
cannot<font color="#CCCCCC"> really run it on 18 million</font>

614
00:33:32,250 --> 00:33:38,610
<font color="#E5E5E5">samples that would take way way too much</font>

615
00:33:34,890 --> 00:33:39,720
time so<font color="#E5E5E5"> first thing is using</font><font color="#CCCCCC"> windows 3</font>

616
00:33:38,610 --> 00:33:41,010
<font color="#E5E5E5">something so essential that's a</font>

617
00:33:39,720 --> 00:33:42,690
<font color="#E5E5E5">compression method that we take like</font>

618
00:33:41,010 --> 00:33:47,550
hundred<font color="#E5E5E5"> samples and add them together</font>

619
00:33:42,690 --> 00:33:52,050
<font color="#E5E5E5">and get one it also there is a hope that</font>

620
00:33:47,550 --> 00:33:56,909
it reduces signal-to-noise ratio so let

621
00:33:52,050 --> 00:33:59,760
us see<font color="#CCCCCC"> oh</font><font color="#E5E5E5"> how the window</font><font color="#CCCCCC"> or example</font>

622
00:33:56,910 --> 00:34:01,410
output<font color="#CCCCCC"> would look like I'm</font><font color="#E5E5E5"> not sure how</font>

623
00:33:59,760 --> 00:34:03,330
visibility is but essentially

624
00:34:01,410 --> 00:34:05,669
<font color="#CCCCCC">there-there started occurring such</font>

625
00:34:03,330 --> 00:34:09,330
patterns essentially the result<font color="#CCCCCC"> is a bit</font>

626
00:34:05,669 --> 00:34:11,250
similar to<font color="#E5E5E5"> low-pass so what we started</font>

627
00:34:09,330 --> 00:34:15,000
seeing here<font color="#E5E5E5"> so this is just the</font>

628
00:34:11,250 --> 00:34:18,989
beginning<font color="#E5E5E5"> of the trace so we are looking</font>

629
00:34:15,000 --> 00:34:20,609
<font color="#CCCCCC">here now a bit</font><font color="#E5E5E5"> more carefully so what</font>

630
00:34:18,989 --> 00:34:25,319
what we notice is<font color="#E5E5E5"> that there are since</font>

631
00:34:20,609 --> 00:34:28,259
there I<font color="#E5E5E5"> think 15 patterns here and then</font>

632
00:34:25,320 --> 00:34:32,609
they<font color="#E5E5E5"> are starting being a single for</font>

633
00:34:28,260 --> 00:34:34,290
groups of distinctive patterns<font color="#E5E5E5"> so there</font>

634
00:34:32,609 --> 00:34:36,629
<font color="#E5E5E5">are five there</font><font color="#CCCCCC"> are five peaks in this</font>

635
00:34:34,290 --> 00:34:38,550
pattern<font color="#CCCCCC"> so we</font><font color="#E5E5E5"> can guess it since there</font>

636
00:34:36,629 --> 00:34:40,290
are five since there are five<font color="#CCCCCC"> Peaks</font>

637
00:34:38,550 --> 00:34:43,649
there should be<font color="#E5E5E5"> four squares and one</font>

638
00:34:40,290 --> 00:34:44,600
multiplied so that will be processing

639
00:34:43,649 --> 00:34:47,638
<font color="#CCCCCC">four bits</font>

640
00:34:44,600 --> 00:34:48,989
<font color="#CCCCCC">doo-doo-doo-doo and this thing is just</font>

641
00:34:47,639 --> 00:34:50,490
<font color="#CCCCCC">by</font><font color="#E5E5E5"> computation of points how the</font>

642
00:34:48,989 --> 00:34:53,609
pre-computation of points is done is

643
00:34:50,489 --> 00:34:57,930
<font color="#E5E5E5">essentially first we start with M we</font>

644
00:34:53,609 --> 00:35:00,390
multiply M by M we get<font color="#E5E5E5"> M</font><font color="#CCCCCC"> squared then</font><font color="#E5E5E5"> we</font>

645
00:34:57,930 --> 00:35:04,980
multiply M Squared by M we<font color="#CCCCCC"> have m to the</font>

646
00:35:00,390 --> 00:35:10,859
third<font color="#E5E5E5"> and</font><font color="#CCCCCC"> we go on</font><font color="#E5E5E5"> like that so that</font>

647
00:35:04,980 --> 00:35:13,530
matches<font color="#CCCCCC"> what we see in the code so what</font>

648
00:35:10,859 --> 00:35:16,109
we<font color="#E5E5E5"> did later what happens is that</font><font color="#CCCCCC"> these</font>

649
00:35:13,530 --> 00:35:20,430
<font color="#CCCCCC">patterns here are not perfectly aligned</font>

650
00:35:16,109 --> 00:35:22,230
when we take the traces<font color="#CCCCCC"> or</font><font color="#E5E5E5"> when when we</font>

651
00:35:20,430 --> 00:35:24,359
put traces on top of each<font color="#E5E5E5"> other</font><font color="#CCCCCC"> so we</font>

652
00:35:22,230 --> 00:35:28,080
<font color="#CCCCCC">used another</font><font color="#E5E5E5"> module that essentially</font>

653
00:35:24,359 --> 00:35:32,130
aligns at this window so the traces are

654
00:35:28,080 --> 00:35:34,950
aligned on top of<font color="#CCCCCC"> each other</font><font color="#E5E5E5"> again this</font>

655
00:35:32,130 --> 00:35:37,700
is again one of<font color="#E5E5E5"> our tools that we have</font>

656
00:35:34,950 --> 00:35:45,149
there there<font color="#E5E5E5"> are other things that we</font>

657
00:35:37,700 --> 00:35:48,390
let's go just further so now<font color="#CCCCCC"> we have the</font>

658
00:35:45,150 --> 00:35:51,840
<font color="#CCCCCC">aligned traces this is this is again the</font>

659
00:35:48,390 --> 00:35:56,368
pre-processing<font color="#CCCCCC"> and this is our this is</font>

660
00:35:51,840 --> 00:35:59,040
<font color="#E5E5E5">already dddd exponentiation part if</font>

661
00:35:56,369 --> 00:36:00,780
everything is aligned<font color="#E5E5E5"> correctly we could</font>

662
00:35:59,040 --> 00:36:02,640
already<font color="#E5E5E5"> try to play with cross</font>

663
00:36:00,780 --> 00:36:07,320
correlation and actually<font color="#E5E5E5"> that's how we</font>

664
00:36:02,640 --> 00:36:09,240
did<font color="#E5E5E5"> it the</font><font color="#CCCCCC"> first</font><font color="#E5E5E5"> time but let's we we</font>

665
00:36:07,320 --> 00:36:11,490
<font color="#E5E5E5">slightly improve the processing so what</font>

666
00:36:09,240 --> 00:36:13,669
did we<font color="#E5E5E5"> do we realize that what we really</font>

667
00:36:11,490 --> 00:36:15,689
what we<font color="#E5E5E5"> are really</font><font color="#CCCCCC"> interested is the</font>

668
00:36:13,670 --> 00:36:17,460
<font color="#CCCCCC">easy multiply</font>

669
00:36:15,690 --> 00:36:19,320
so we brought our own<font color="#E5E5E5"> module that</font>

670
00:36:17,460 --> 00:36:21,570
essentially cuts off everything<font color="#E5E5E5"> that</font>

671
00:36:19,320 --> 00:36:22,589
<font color="#CCCCCC">looks</font><font color="#E5E5E5"> like multiplication</font><font color="#CCCCCC"> and everything</font>

672
00:36:21,570 --> 00:36:25,410
that looks<font color="#CCCCCC"> different</font>

673
00:36:22,589 --> 00:36:27,119
essentially squares<font color="#E5E5E5"> we</font><font color="#CCCCCC"> kick</font><font color="#E5E5E5"> it out so</font>

674
00:36:25,410 --> 00:36:31,859
then we will only do cross correlation

675
00:36:27,119 --> 00:36:35,369
on the on the multiplications so<font color="#CCCCCC"> that</font>

676
00:36:31,859 --> 00:36:37,740
was our<font color="#CCCCCC"> our result so essentially we</font>

677
00:36:35,369 --> 00:36:41,730
<font color="#E5E5E5">have this these guys that we hope the</font>

678
00:36:37,740 --> 00:36:49,618
leakage will be<font color="#E5E5E5"> only here so what can we</font>

679
00:36:41,730 --> 00:36:51,330
<font color="#E5E5E5">do here okay so this is this expertise</font>

680
00:36:49,619 --> 00:36:53,520
these multiplications<font color="#E5E5E5"> are coming only</font>

681
00:36:51,330 --> 00:36:56,009
from exponentiation<font color="#CCCCCC"> so what do we hope</font>

682
00:36:53,520 --> 00:36:59,790
for<font color="#E5E5E5"> we hope that we would be able to</font>

683
00:36:56,010 --> 00:37:03,180
<font color="#E5E5E5">detect</font><font color="#CCCCCC"> what's called a cross correlation</font>

684
00:36:59,790 --> 00:37:07,460
between groups of beads that<font color="#CCCCCC"> are</font><font color="#E5E5E5"> the</font>

685
00:37:03,180 --> 00:37:09,359
same so for example if<font color="#E5E5E5"> I have 0 0 0 1 1</font>

686
00:37:07,460 --> 00:37:13,109
<font color="#E5E5E5">multiplication and then somewhere later</font>

687
00:37:09,359 --> 00:37:14,790
0 0 0 0<font color="#CCCCCC"> 1 again I would like to see</font>

688
00:37:13,109 --> 00:37:19,200
cross correlation<font color="#CCCCCC"> they're the same</font><font color="#E5E5E5"> if I</font>

689
00:37:14,790 --> 00:37:21,089
have 0 0<font color="#CCCCCC"> 1 0 I</font><font color="#E5E5E5"> should see all the that</font>

690
00:37:19,200 --> 00:37:24,689
correlating<font color="#CCCCCC"> with all the other places</font>

691
00:37:21,089 --> 00:37:27,960
where the value corresponding<font color="#E5E5E5"> to 0 0 1</font><font color="#CCCCCC"> 0</font>

692
00:37:24,690 --> 00:37:29,670
<font color="#E5E5E5">is being processed</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> that that value</font>

693
00:37:27,960 --> 00:37:32,820
will be square essentially<font color="#E5E5E5"> M</font><font color="#CCCCCC"> squared</font>

694
00:37:29,670 --> 00:37:41,580
<font color="#E5E5E5">because this is 0 0</font><font color="#CCCCCC"> 1 0 so it's 2 so</font><font color="#E5E5E5"> M</font>

695
00:37:32,820 --> 00:37:44,400
<font color="#E5E5E5">Squared</font><font color="#CCCCCC"> ok so we</font><font color="#E5E5E5"> run it</font>

696
00:37:41,580 --> 00:37:49,440
what did we see the picture is maybe not

697
00:37:44,400 --> 00:37:52,530
not completely clear<font color="#E5E5E5"> what</font><font color="#CCCCCC"> yeah yeah</font><font color="#E5E5E5"> but</font>

698
00:37:49,440 --> 00:37:55,109
<font color="#CCCCCC">ok I will go slowly</font><font color="#E5E5E5"> because that's</font>

699
00:37:52,530 --> 00:37:56,550
actually<font color="#CCCCCC"> how we got here so on the next</font>

700
00:37:55,109 --> 00:37:59,130
<font color="#E5E5E5">picture that we saw everything will be</font>

701
00:37:56,550 --> 00:38:00,210
clear<font color="#CCCCCC"> but here</font><font color="#E5E5E5"> essentially this</font><font color="#CCCCCC"> is cross</font>

702
00:37:59,130 --> 00:38:02,609
correlation within<font color="#CCCCCC"> a single</font>

703
00:38:00,210 --> 00:38:05,640
multiplication that always happens<font color="#E5E5E5"> maybe</font>

704
00:38:02,609 --> 00:38:09,930
<font color="#E5E5E5">it's not very</font><font color="#CCCCCC"> visible</font><font color="#E5E5E5"> but we saw we</font>

705
00:38:05,640 --> 00:38:11,368
started seeing such<font color="#CCCCCC"> peaks here at the</font>

706
00:38:09,930 --> 00:38:13,919
<font color="#E5E5E5">beginning I thought that my eyes are</font>

707
00:38:11,369 --> 00:38:15,270
getting<font color="#E5E5E5"> crazy but then then then we</font>

708
00:38:13,920 --> 00:38:18,240
started<font color="#E5E5E5"> thinking maybe this is a real</font>

709
00:38:15,270 --> 00:38:21,060
leakage so we checked just<font color="#E5E5E5"> manually what</font>

710
00:38:18,240 --> 00:38:22,950
is the<font color="#E5E5E5"> secret</font><font color="#CCCCCC"> key here and what is</font><font color="#E5E5E5"> the</font>

711
00:38:21,060 --> 00:38:24,660
<font color="#E5E5E5">secret key in the subsequent operation</font>

712
00:38:22,950 --> 00:38:26,609
here and then we<font color="#E5E5E5"> discovered it</font><font color="#CCCCCC"> the same</font>

713
00:38:24,660 --> 00:38:28,890
so<font color="#E5E5E5"> these</font><font color="#CCCCCC"> 4 bits</font><font color="#E5E5E5"> were the same so then we</font>

714
00:38:26,609 --> 00:38:31,450
knew<font color="#CCCCCC"> ok we have the leakage</font>

715
00:38:28,890 --> 00:38:33,100
so later for the same traces<font color="#CCCCCC"> we</font>

716
00:38:31,450 --> 00:38:34,390
<font color="#E5E5E5">essentially used we</font><font color="#CCCCCC"> have the same</font>

717
00:38:33,100 --> 00:38:37,390
picture but<font color="#CCCCCC"> we</font><font color="#E5E5E5"> used GIMP</font>

718
00:38:34,390 --> 00:38:41,440
with binary<font color="#E5E5E5"> threshold and that's just</font>

719
00:38:37,390 --> 00:38:43,779
easier to<font color="#E5E5E5"> detect the same the same</font><font color="#CCCCCC"> Chris</font>

720
00:38:41,440 --> 00:38:46,030
<font color="#CCCCCC">Korell</font><font color="#E5E5E5"> very weak cross correlations but</font>

721
00:38:43,780 --> 00:38:48,730
<font color="#E5E5E5">what we discovered it actually worked</font>

722
00:38:46,030 --> 00:38:55,530
<font color="#E5E5E5">so this was these two operations shared</font>

723
00:38:48,730 --> 00:38:58,300
the same the same the same value<font color="#CCCCCC"> okay so</font>

724
00:38:55,530 --> 00:39:02,920
when<font color="#E5E5E5"> we would work and when it would not</font>

725
00:38:58,300 --> 00:39:04,660
work<font color="#E5E5E5"> so that value intuitively should</font>

726
00:39:02,920 --> 00:39:06,580
always work<font color="#E5E5E5"> because that's how we just</font>

727
00:39:04,660 --> 00:39:10,120
described<font color="#CCCCCC"> algorithm</font><font color="#E5E5E5"> but that's not true</font>

728
00:39:06,580 --> 00:39:11,890
<font color="#CCCCCC">because</font><font color="#E5E5E5"> open SSL treats</font><font color="#CCCCCC"> zero</font><font color="#E5E5E5"> deletes one</font>

729
00:39:10,120 --> 00:39:13,720
<font color="#E5E5E5">differently it doesn't perform</font>

730
00:39:11,890 --> 00:39:16,720
multiplication by<font color="#E5E5E5"> one but</font><font color="#CCCCCC"> does something</font>

731
00:39:13,720 --> 00:39:18,459
<font color="#E5E5E5">strange so for once</font><font color="#CCCCCC"> we never see cross</font>

732
00:39:16,720 --> 00:39:21,970
correlation like that we<font color="#CCCCCC"> never see these</font>

733
00:39:18,460 --> 00:39:25,690
<font color="#E5E5E5">spots what do we see</font><font color="#CCCCCC"> then</font><font color="#E5E5E5"> we see very</font>

734
00:39:21,970 --> 00:39:28,089
<font color="#CCCCCC">very strange pattern</font><font color="#E5E5E5"> here</font><font color="#CCCCCC"> so we actually</font>

735
00:39:25,690 --> 00:39:31,180
<font color="#E5E5E5">don't recognize recognize multiplication</font>

736
00:39:28,090 --> 00:39:32,770
by one hand by the by the cross

737
00:39:31,180 --> 00:39:34,480
correlation we can only recognize it by

738
00:39:32,770 --> 00:39:36,960
the internal cross correlation here<font color="#E5E5E5"> the</font>

739
00:39:34,480 --> 00:39:39,280
pattern<font color="#CCCCCC"> is</font><font color="#E5E5E5"> completely different and</font>

740
00:39:36,960 --> 00:39:40,930
<font color="#E5E5E5">actually we didn't</font><font color="#CCCCCC"> analyze why it's like</font>

741
00:39:39,280 --> 00:39:49,300
<font color="#E5E5E5">that we are</font><font color="#CCCCCC"> just happy</font><font color="#E5E5E5"> that we can</font>

742
00:39:40,930 --> 00:39:50,560
recognize it<font color="#E5E5E5"> okay okay we are</font><font color="#CCCCCC"> getting</font>

743
00:39:49,300 --> 00:39:55,020
<font color="#CCCCCC">close to</font><font color="#E5E5E5"> the end what we couldn't</font>

744
00:39:50,560 --> 00:39:58,240
<font color="#E5E5E5">recognize here</font><font color="#CCCCCC"> is we know that these two</font>

745
00:39:55,020 --> 00:39:59,770
operands shared the same key and and

746
00:39:58,240 --> 00:40:02,439
then we<font color="#E5E5E5"> maybe know that these two</font><font color="#CCCCCC"> share</font>

747
00:39:59,770 --> 00:40:04,840
<font color="#CCCCCC">the</font><font color="#E5E5E5"> same four bits</font><font color="#CCCCCC"> but we don't know</font>

748
00:40:02,440 --> 00:40:06,400
what is<font color="#E5E5E5"> that value</font><font color="#CCCCCC"> so what did we</font><font color="#E5E5E5"> do</font>

749
00:40:04,840 --> 00:40:08,440
later<font color="#E5E5E5"> that's just exponentiation and</font>

750
00:40:06,400 --> 00:40:10,660
then we went for<font color="#E5E5E5"> the pre-computation so</font>

751
00:40:08,440 --> 00:40:13,660
essentially this part here corresponds

752
00:40:10,660 --> 00:40:14,799
to<font color="#E5E5E5"> these 15 pre computations and this</font>

753
00:40:13,660 --> 00:40:18,609
part here corresponds to<font color="#E5E5E5"> the</font>

754
00:40:14,800 --> 00:40:19,900
<font color="#E5E5E5">exponentiation then here we know the</font>

755
00:40:18,610 --> 00:40:21,460
order<font color="#E5E5E5"> so we know that the first</font>

756
00:40:19,900 --> 00:40:23,590
operation will be computing<font color="#CCCCCC"> m squared</font>

757
00:40:21,460 --> 00:40:25,960
the second<font color="#E5E5E5"> operation will be computing</font><font color="#CCCCCC"> M</font>

758
00:40:23,590 --> 00:40:29,740
to the<font color="#CCCCCC"> third</font><font color="#E5E5E5"> M to the fourth</font><font color="#CCCCCC"> M and so on</font>

759
00:40:25,960 --> 00:40:31,120
<font color="#E5E5E5">so if we for</font><font color="#CCCCCC"> example would see here</font>

760
00:40:29,740 --> 00:40:34,209
cross correlation and<font color="#E5E5E5"> we know that this</font>

761
00:40:31,120 --> 00:40:37,569
is the<font color="#CCCCCC"> tenth operation then we know</font><font color="#E5E5E5"> that</font>

762
00:40:34,210 --> 00:40:39,730
here<font color="#CCCCCC"> that point is</font><font color="#E5E5E5"> being processed</font><font color="#CCCCCC"> so</font>

763
00:40:37,570 --> 00:40:42,339
<font color="#E5E5E5">essentially when you compute for example</font>

764
00:40:39,730 --> 00:40:45,489
<font color="#CCCCCC">M to the power of 3 it's essentially M</font>

765
00:40:42,339 --> 00:40:46,869
multiplied<font color="#CCCCCC"> by M squared so we see</font><font color="#E5E5E5"> we set</font>

766
00:40:45,489 --> 00:40:50,349
for the cross correlation between<font color="#CCCCCC"> M</font>

767
00:40:46,869 --> 00:40:52,420
<font color="#CCCCCC">squared</font><font color="#E5E5E5"> and the actual and the</font><font color="#CCCCCC"> actual</font>

768
00:40:50,349 --> 00:40:58,150
<font color="#E5E5E5">value somewhere somewhere here so for</font>

769
00:40:52,420 --> 00:41:00,339
example let's<font color="#E5E5E5"> say this one as far as I</font>

770
00:40:58,150 --> 00:41:04,199
can say based<font color="#CCCCCC"> on</font><font color="#E5E5E5"> this picture this is</font><font color="#CCCCCC"> M</font>

771
00:41:00,339 --> 00:41:06,640
to the<font color="#E5E5E5"> power of</font><font color="#CCCCCC"> three</font><font color="#E5E5E5"> so if I go here</font>

772
00:41:04,199 --> 00:41:10,150
<font color="#CCCCCC">then I know that in this</font><font color="#E5E5E5"> operation</font>

773
00:41:06,640 --> 00:41:12,160
there will be since this is the<font color="#CCCCCC"> third</font>

774
00:41:10,150 --> 00:41:16,449
one then it was M<font color="#CCCCCC"> squared multiplied by</font>

775
00:41:12,160 --> 00:41:20,890
M so this the<font color="#CCCCCC"> bits here should be</font><font color="#E5E5E5"> 0 0</font><font color="#CCCCCC"> 1</font>

776
00:41:16,449 --> 00:41:24,009
<font color="#E5E5E5">0 that's that's also what is strange on</font>

777
00:41:20,890 --> 00:41:29,618
this<font color="#E5E5E5"> picture the strange pink on this</font>

778
00:41:24,009 --> 00:41:32,049
<font color="#E5E5E5">picture is this</font><font color="#CCCCCC"> pink so what what that</font>

779
00:41:29,619 --> 00:41:36,609
would<font color="#E5E5E5"> really mean and that that actually</font>

780
00:41:32,049 --> 00:41:39,099
is multiplication<font color="#E5E5E5"> by in this case</font><font color="#CCCCCC"> by</font><font color="#E5E5E5"> 0 0</font>

781
00:41:36,609 --> 00:41:44,729
<font color="#E5E5E5">0 1 here the problem is that there is M</font>

782
00:41:39,099 --> 00:41:47,259
multiplied by M so that means that here

783
00:41:44,729 --> 00:41:49,118
there is<font color="#E5E5E5"> multiplication by M that cross</font>

784
00:41:47,259 --> 00:41:52,029
correlates with everything because<font color="#CCCCCC"> for</font>

785
00:41:49,119 --> 00:41:55,239
each<font color="#E5E5E5"> of this part of the loop there is I</font>

786
00:41:52,029 --> 00:41:58,239
multiply M by M then M Squared by M then

787
00:41:55,239 --> 00:41:59,979
so the operation that multiplies by<font color="#CCCCCC"> m to</font>

788
00:41:58,239 --> 00:42:02,499
<font color="#CCCCCC">the power of 1 Cross correlates with</font>

789
00:41:59,979 --> 00:42:06,549
everything still good<font color="#E5E5E5"> enough</font><font color="#CCCCCC"> because we</font>

790
00:42:02,499 --> 00:42:10,629
can we we know exactly<font color="#CCCCCC"> the value again</font>

791
00:42:06,549 --> 00:42:13,479
what will<font color="#E5E5E5"> not work here it's it's an M</font>

792
00:42:10,630 --> 00:42:15,549
to the power of of 15<font color="#CCCCCC"> M to the power of</font>

793
00:42:13,479 --> 00:42:18,669
<font color="#E5E5E5">15 is never used because there is no M</font>

794
00:42:15,549 --> 00:42:20,529
to the<font color="#E5E5E5"> power of 16 computed here so that</font>

795
00:42:18,670 --> 00:42:21,670
will<font color="#E5E5E5"> have to be</font><font color="#CCCCCC"> broad forced</font><font color="#E5E5E5"> but that's</font>

796
00:42:20,529 --> 00:42:23,939
the only<font color="#CCCCCC"> thing that will have to be</font>

797
00:42:21,670 --> 00:42:26,949
brute force

798
00:42:23,939 --> 00:42:31,949
so essentially<font color="#E5E5E5"> M to the</font><font color="#CCCCCC"> power of</font><font color="#E5E5E5"> 16 will</font>

799
00:42:26,949 --> 00:42:39,759
not cross correlate with anything<font color="#E5E5E5"> so</font><font color="#CCCCCC"> no</font>

800
00:42:31,949 --> 00:42:41,859
actually yeah<font color="#CCCCCC"> okay okay these</font><font color="#E5E5E5"> are these</font>

801
00:42:39,759 --> 00:42:44,529
are<font color="#E5E5E5"> just a few</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> few examples but it's</font>

802
00:42:41,859 --> 00:42:46,449
exactly<font color="#E5E5E5"> it's exactly how I described so</font>

803
00:42:44,529 --> 00:42:49,650
here is<font color="#CCCCCC"> three here</font><font color="#E5E5E5"> is 12 so we can</font>

804
00:42:46,449 --> 00:42:49,650
recognize<font color="#E5E5E5"> the values here</font>

805
00:42:51,100 --> 00:42:55,880
<font color="#CCCCCC">no conclusion first</font><font color="#E5E5E5"> of all</font>

806
00:42:53,860 --> 00:43:01,940
<font color="#E5E5E5">straightforward binary exponentiations</font>

807
00:42:55,880 --> 00:43:05,150
are insecure against against against<font color="#E5E5E5"> SP</font>

808
00:43:01,940 --> 00:43:06,950
<font color="#E5E5E5">a multiply always implementation</font><font color="#CCCCCC"> KP</font><font color="#E5E5E5"> can</font>

809
00:43:05,150 --> 00:43:09,110
be also<font color="#E5E5E5"> attacked with cross correlation</font>

810
00:43:06,950 --> 00:43:11,960
<font color="#CCCCCC">messenge</font><font color="#E5E5E5"> blighting class</font><font color="#CCCCCC"> multiply always</font>

811
00:43:09,110 --> 00:43:17,900
is it<font color="#E5E5E5"> it's not good</font><font color="#CCCCCC"> enough</font><font color="#E5E5E5"> to stop to</font>

812
00:43:11,960 --> 00:43:19,400
<font color="#CCCCCC">stop</font><font color="#E5E5E5"> the attack</font><font color="#CCCCCC"> so now there is exponent</font>

813
00:43:17,900 --> 00:43:21,140
<font color="#CCCCCC">blind intervention</font><font color="#E5E5E5"> here we didn't</font>

814
00:43:19,400 --> 00:43:23,660
explain it<font color="#E5E5E5"> but there of course there are</font>

815
00:43:21,140 --> 00:43:25,910
<font color="#E5E5E5">more counter measures the more counter</font>

816
00:43:23,660 --> 00:43:28,569
measures you<font color="#CCCCCC"> had the smaller chance for</font>

817
00:43:25,910 --> 00:43:30,890
the attack<font color="#CCCCCC"> that there is for the attack</font>

818
00:43:28,570 --> 00:43:33,110
again it's costly<font color="#E5E5E5"> so it's for example</font>

819
00:43:30,890 --> 00:43:35,589
<font color="#CCCCCC">not in open ssl but in may be more</font>

820
00:43:33,110 --> 00:43:37,850
secure<font color="#CCCCCC"> implementations in can be there</font>

821
00:43:35,590 --> 00:43:38,360
<font color="#E5E5E5">would cross correlation work in this</font>

822
00:43:37,850 --> 00:43:43,069
<font color="#E5E5E5">case</font>

823
00:43:38,360 --> 00:43:44,990
no<font color="#E5E5E5"> it would not work but</font><font color="#CCCCCC"> i would i would</font>

824
00:43:43,070 --> 00:43:47,720
<font color="#E5E5E5">say that way there are attacks also for</font>

825
00:43:44,990 --> 00:43:50,479
this in these<font color="#CCCCCC"> cases so you can</font><font color="#E5E5E5"> it's</font>

826
00:43:47,720 --> 00:43:55,870
<font color="#E5E5E5">always possible to pile more counter</font>

827
00:43:50,480 --> 00:43:58,940
measures on top of each other<font color="#E5E5E5"> but but</font>

828
00:43:55,870 --> 00:44:02,330
there are always<font color="#E5E5E5"> attacks also that that</font>

829
00:43:58,940 --> 00:44:04,010
are therefore<font color="#E5E5E5"> for that cases if you well</font>

830
00:44:02,330 --> 00:44:05,360
<font color="#CCCCCC">if you liked the presentation evident if</font>

831
00:44:04,010 --> 00:44:07,640
you would like<font color="#CCCCCC"> to see maybe more or even</font>

832
00:44:05,360 --> 00:44:10,550
<font color="#E5E5E5">how</font><font color="#CCCCCC"> we do try to template attacks or</font>

833
00:44:07,640 --> 00:44:12,290
clustering<font color="#E5E5E5"> attacks we have</font><font color="#CCCCCC"> some traces</font>

834
00:44:10,550 --> 00:44:13,970
and<font color="#E5E5E5"> we will have it</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> our</font><font color="#CCCCCC"> tenth so then</font>

835
00:44:12,290 --> 00:44:17,720
we can<font color="#CCCCCC"> may even show the acquisition</font>

836
00:44:13,970 --> 00:44:19,790
demo or we were initially<font color="#CCCCCC"> thinking about</font>

837
00:44:17,720 --> 00:44:22,850
trying<font color="#CCCCCC"> to do</font><font color="#E5E5E5"> it now but i think</font><font color="#CCCCCC"> it's it</font>

838
00:44:19,790 --> 00:44:24,200
<font color="#E5E5E5">will be too much hassle so well if</font>

839
00:44:22,850 --> 00:44:28,250
you're<font color="#E5E5E5"> interested just come to our tent</font>

840
00:44:24,200 --> 00:44:30,919
and then then then we<font color="#CCCCCC"> can</font><font color="#E5E5E5"> talk more</font><font color="#CCCCCC"> so</font>

841
00:44:28,250 --> 00:44:32,510
<font color="#CCCCCC">public</font><font color="#E5E5E5"> key crypto is well</font><font color="#CCCCCC"> i really like</font>

842
00:44:30,920 --> 00:44:38,050
<font color="#CCCCCC">that</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> i can talk about</font><font color="#E5E5E5"> that a lot if</font>

843
00:44:32,510 --> 00:44:38,050
<font color="#E5E5E5">you are interested yeah</font>

844
00:44:38,950 --> 00:44:55,470
[Applause]

845
00:44:48,740 --> 00:44:57,419
<font color="#CCCCCC">hey questions</font><font color="#E5E5E5"> okay thank you for the</font>

846
00:44:55,470 --> 00:45:00,180
talk<font color="#CCCCCC"> we still have a little bit</font><font color="#E5E5E5"> of time</font>

847
00:44:57,420 --> 00:45:03,270
for<font color="#CCCCCC"> Q&A</font><font color="#E5E5E5"> if you have questions please</font>

848
00:45:00,180 --> 00:45:06,180
<font color="#E5E5E5">line up at the mic in the</font><font color="#CCCCCC"> middle</font>

849
00:45:03,270 --> 00:45:10,520
<font color="#E5E5E5">we really would ask you to</font><font color="#CCCCCC"> ask questions</font>

850
00:45:06,180 --> 00:45:10,520
<font color="#CCCCCC">that had comments and yeah</font>

851
00:45:21,490 --> 00:45:29,240
please<font color="#E5E5E5"> get closer to the mic</font><font color="#CCCCCC"> should</font>

852
00:45:25,220 --> 00:45:32,870
really what will be it for<font color="#CCCCCC"> the demo</font>

853
00:45:29,240 --> 00:45:35,299
this is risk our<font color="#CCCCCC"> tent it's in the hopper</font>

854
00:45:32,870 --> 00:45:37,220
hopper field<font color="#E5E5E5"> it's in the hopper field</font>

855
00:45:35,300 --> 00:45:44,180
<font color="#E5E5E5">yes close to the Spanish village I</font>

856
00:45:37,220 --> 00:45:46,399
believe we<font color="#CCCCCC"> just came so yeah so</font><font color="#E5E5E5"> just to</font>

857
00:45:44,180 --> 00:45:49,279
maybe give a bit of<font color="#CCCCCC"> a feeling</font><font color="#E5E5E5"> so from</font>

858
00:45:46,400 --> 00:45:51,290
the acquisition<font color="#CCCCCC"> to the actual attack</font><font color="#E5E5E5"> the</font>

859
00:45:49,280 --> 00:45:54,350
time of<font color="#E5E5E5"> processing the traces it's like</font>

860
00:45:51,290 --> 00:45:56,000
<font color="#E5E5E5">10 hours or more but so probably either</font>

861
00:45:54,350 --> 00:45:59,029
we will show just acquisition and then

862
00:45:56,000 --> 00:46:00,920
already slightly<font color="#CCCCCC"> pre-process traces so</font>

863
00:45:59,030 --> 00:46:06,440
just the full attack is way too much

864
00:46:00,920 --> 00:46:08,570
time hello thank<font color="#E5E5E5"> you for the talk you</font>

865
00:46:06,440 --> 00:46:10,910
mentioned<font color="#CCCCCC"> that used a</font><font color="#E5E5E5"> Pico scope for</font>

866
00:46:08,570 --> 00:46:13,180
doing the acquisition yeah how did<font color="#CCCCCC"> you</font>

867
00:46:10,910 --> 00:46:17,149
<font color="#E5E5E5">what do you use for automating the</font>

868
00:46:13,180 --> 00:46:19,160
telling it to start capturing for what

869
00:46:17,150 --> 00:46:21,770
<font color="#E5E5E5">what do you have</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> mentioned that</font>

870
00:46:19,160 --> 00:46:24,170
there was<font color="#E5E5E5"> a tracker coming from the PC</font>

871
00:46:21,770 --> 00:46:26,270
to<font color="#CCCCCC"> the</font><font color="#E5E5E5"> Pico scope telling it to ready</font>

872
00:46:24,170 --> 00:46:29,570
itself what did you use for<font color="#E5E5E5"> automating</font>

873
00:46:26,270 --> 00:46:30,860
that yeah so we<font color="#CCCCCC"> actually so the the</font>

874
00:46:29,570 --> 00:46:36,920
trigger was from the device itself

875
00:46:30,860 --> 00:46:38,390
<font color="#CCCCCC">coming okay so it's just yeah so</font>

876
00:46:36,920 --> 00:46:40,400
essentially that<font color="#E5E5E5"> the software was</font>

877
00:46:38,390 --> 00:46:43,490
telling continuously the<font color="#CCCCCC"> Deepika's</font>

878
00:46:40,400 --> 00:46:46,400
called<font color="#E5E5E5"> arm arm arm arm and then and then</font>

879
00:46:43,490 --> 00:46:48,439
the the<font color="#E5E5E5"> trigger was generated</font><font color="#CCCCCC"> by the by</font>

880
00:46:46,400 --> 00:46:50,210
the device itself but it's it's<font color="#CCCCCC"> it's</font>

881
00:46:48,440 --> 00:46:52,220
<font color="#E5E5E5">simplicity it's not very hard to make a</font>

882
00:46:50,210 --> 00:46:54,740
trigger from<font color="#E5E5E5"> the even from the</font>

883
00:46:52,220 --> 00:46:57,680
communication it would it would imply

884
00:46:54,740 --> 00:46:59,750
that we would have<font color="#CCCCCC"> to get more more</font>

885
00:46:57,680 --> 00:47:01,879
sample slightly but the<font color="#E5E5E5"> misalignment is</font>

886
00:46:59,750 --> 00:47:04,010
usually since this operation is so huge

887
00:47:01,880 --> 00:47:06,380
even if you in style I'm and<font color="#CCCCCC"> he's in</font><font color="#E5E5E5"> two</font>

888
00:47:04,010 --> 00:47:09,710
milliseconds<font color="#CCCCCC"> or five we can live with it</font>

889
00:47:06,380 --> 00:47:11,630
<font color="#CCCCCC">yeah</font><font color="#E5E5E5"> okay</font><font color="#CCCCCC"> cool so</font><font color="#E5E5E5"> the the arm</font><font color="#CCCCCC"> the</font>

890
00:47:09,710 --> 00:47:15,470
repeated on<font color="#CCCCCC"> signals</font><font color="#E5E5E5"> that being just set</font>

891
00:47:11,630 --> 00:47:17,810
from<font color="#CCCCCC"> Pico text and</font><font color="#E5E5E5"> software</font><font color="#CCCCCC"> no we used</font>

892
00:47:15,470 --> 00:47:19,759
to we used our<font color="#CCCCCC"> own implementation so so</font>

893
00:47:17,810 --> 00:47:21,890
we<font color="#E5E5E5"> have we have</font><font color="#CCCCCC"> this inspector tool but</font>

894
00:47:19,760 --> 00:47:24,140
just to<font color="#E5E5E5"> explain there</font><font color="#CCCCCC"> are I am aware of</font>

895
00:47:21,890 --> 00:47:28,640
<font color="#E5E5E5">the open</font><font color="#CCCCCC"> source implementation online</font><font color="#E5E5E5"> oh</font>

896
00:47:24,140 --> 00:47:30,319
<font color="#E5E5E5">I wasn't so okay</font><font color="#CCCCCC"> there are there</font><font color="#E5E5E5"> i i'm</font>

897
00:47:28,640 --> 00:47:33,220
not<font color="#CCCCCC"> sure if i can remember from memory</font>

898
00:47:30,320 --> 00:47:33,220
but<font color="#E5E5E5"> yeah there are</font>

899
00:47:35,000 --> 00:47:41,130
so you mentioned needing<font color="#CCCCCC"> a little lot of</font>

900
00:47:38,310 --> 00:47:42,990
traces about<font color="#CCCCCC"> 10,000 yeah what'd you do</font>

901
00:47:41,130 --> 00:47:45,450
this for a<font color="#CCCCCC"> real-world</font><font color="#E5E5E5"> attack where</font>

902
00:47:42,990 --> 00:47:48,209
you're<font color="#E5E5E5"> not</font><font color="#CCCCCC"> able to get a device</font><font color="#E5E5E5"> to</font>

903
00:47:45,450 --> 00:47:49,830
<font color="#CCCCCC">calculate the same</font><font color="#E5E5E5"> thing that many times</font>

904
00:47:48,210 --> 00:47:51,720
<font color="#E5E5E5">over and over but it's not the same</font>

905
00:47:49,830 --> 00:47:54,840
<font color="#CCCCCC">thing it can calculate</font><font color="#E5E5E5"> whatever a</font>

906
00:47:51,720 --> 00:47:56,700
message it wants<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> so if you've</font><font color="#E5E5E5"> got a</font>

907
00:47:54,840 --> 00:48:01,770
real device it might<font color="#E5E5E5"> still implement</font>

908
00:47:56,700 --> 00:48:04,680
some<font color="#CCCCCC"> kind of limit home yes it does</font>

909
00:48:01,770 --> 00:48:09,330
happen sure<font color="#E5E5E5"> so how what do we do then</font><font color="#CCCCCC"> so</font>

910
00:48:04,680 --> 00:48:11,970
then then then essentially we<font color="#CCCCCC"> need to</font>

911
00:48:09,330 --> 00:48:15,990
get<font color="#E5E5E5"> as clear signal as possible so this</font>

912
00:48:11,970 --> 00:48:20,970
<font color="#CCCCCC">attack</font><font color="#E5E5E5"> we did on another on another</font>

913
00:48:15,990 --> 00:48:22,830
<font color="#E5E5E5">device on another also ARM Cortex but we</font>

914
00:48:20,970 --> 00:48:24,149
used<font color="#CCCCCC"> a.m.</font><font color="#E5E5E5"> so this is slightly more</font>

915
00:48:22,830 --> 00:48:26,880
<font color="#CCCCCC">expensive technique so</font><font color="#E5E5E5"> we used</font><font color="#CCCCCC"> two</font>

916
00:48:24,150 --> 00:48:30,660
electromagnetic probe for that and then

917
00:48:26,880 --> 00:48:33,080
<font color="#E5E5E5">we were able to detect a decent decent</font>

918
00:48:30,660 --> 00:48:35,879
<font color="#CCCCCC">cross correlation with hundred traces</font>

919
00:48:33,080 --> 00:48:37,470
okay<font color="#CCCCCC"> however</font><font color="#E5E5E5"> we</font><font color="#CCCCCC"> are not showing this</font>

920
00:48:35,880 --> 00:48:41,700
result but because it was in a project

921
00:48:37,470 --> 00:48:43,620
<font color="#E5E5E5">but yeah yeah</font><font color="#CCCCCC"> we we</font><font color="#E5E5E5"> found a crisis it's</font>

922
00:48:41,700 --> 00:48:45,210
possible to do this attack so this

923
00:48:43,620 --> 00:48:46,799
particular<font color="#E5E5E5"> attack doesn't require a lot</font>

924
00:48:45,210 --> 00:48:49,490
<font color="#CCCCCC">of traces there are other side channel</font>

925
00:48:46,800 --> 00:48:51,990
attacks that do require<font color="#CCCCCC"> a lot of traces</font>

926
00:48:49,490 --> 00:48:55,020
okay<font color="#E5E5E5"> on the other hand if</font><font color="#CCCCCC"> text target</font><font color="#E5E5E5"> is</font>

927
00:48:51,990 --> 00:49:00,620
<font color="#CCCCCC">very protected</font><font color="#E5E5E5"> we will just</font><font color="#CCCCCC"> or very</font>

928
00:48:55,020 --> 00:49:00,620
noisy well it's okay to fail<font color="#CCCCCC"> then yeah</font>

929
00:49:02,030 --> 00:49:05,870
any further question

930
00:49:09,710 --> 00:49:21,240
then<font color="#E5E5E5"> please thank our speakers</font><font color="#CCCCCC"> again and</font>

931
00:49:13,970 --> 00:49:33,390
[Applause]

932
00:49:21,240 --> 00:49:33,390
[Music]

