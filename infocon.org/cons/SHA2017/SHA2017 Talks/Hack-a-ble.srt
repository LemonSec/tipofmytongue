1
00:00:00,000 --> 00:00:08,780
[Music]

2
00:00:15,470 --> 00:00:22,320
so now intent no<font color="#CCCCCC"> HR 2015 day 5</font><font color="#E5E5E5"> I have</font>

3
00:00:20,970 --> 00:00:25,169
with me on stage

4
00:00:22,320 --> 00:00:26,880
<font color="#CCCCCC">towel melamed</font><font color="#E5E5E5"> is an application security</font>

5
00:00:25,170 --> 00:00:28,439
expert with<font color="#CCCCCC"> the long history in the</font>

6
00:00:26,880 --> 00:00:30,840
<font color="#E5E5E5">field he will probably</font><font color="#CCCCCC"> tell you</font><font color="#E5E5E5"> about in</font>

7
00:00:28,439 --> 00:00:33,719
a minute<font color="#CCCCCC"> and he's going to</font><font color="#E5E5E5"> talk about</font>

8
00:00:30,840 --> 00:00:36,149
Bluetooth<font color="#CCCCCC"> Low</font><font color="#E5E5E5"> Energy</font><font color="#CCCCCC"> key</font><font color="#E5E5E5"> security issues</font>

9
00:00:33,719 --> 00:00:42,770
<font color="#E5E5E5">piece please give a very warm welcome to</font>

10
00:00:36,149 --> 00:00:49,350
<font color="#E5E5E5">Tom element hi everyone can you hear me</font>

11
00:00:42,770 --> 00:00:54,030
<font color="#E5E5E5">yeah great okay so I'm tal</font><font color="#CCCCCC"> application</font>

12
00:00:49,350 --> 00:00:59,219
<font color="#E5E5E5">security expert so in this talk I'm</font>

13
00:00:54,030 --> 00:01:02,850
<font color="#E5E5E5">going</font><font color="#CCCCCC"> to explain about what is ble</font><font color="#E5E5E5"> where</font>

14
00:00:59,219 --> 00:01:05,700
is the risk<font color="#E5E5E5"> in all that work I mean</font>

15
00:01:02,850 --> 00:01:09,869
where is<font color="#E5E5E5"> the risk in having these ble</font>

16
00:01:05,700 --> 00:01:13,530
devices will speak in a second<font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> going</font>

17
00:01:09,869 --> 00:01:15,780
<font color="#E5E5E5">to talk</font><font color="#CCCCCC"> about some security key security</font>

18
00:01:13,530 --> 00:01:18,750
<font color="#E5E5E5">aspects like the security manager the</font>

19
00:01:15,780 --> 00:01:21,390
<font color="#E5E5E5">Billy pairing and the gut and then I'm</font>

20
00:01:18,750 --> 00:01:24,570
<font color="#E5E5E5">going to dive into the application level</font>

21
00:01:21,390 --> 00:01:29,689
of it and see how we can<font color="#CCCCCC"> man in the</font>

22
00:01:24,570 --> 00:01:33,298
middle<font color="#CCCCCC"> Bluetooth devices and use it to</font>

23
00:01:29,689 --> 00:01:35,220
hack<font color="#E5E5E5"> either the</font><font color="#CCCCCC"> device or the mobile</font><font color="#E5E5E5"> app</font>

24
00:01:33,299 --> 00:01:39,450
that<font color="#CCCCCC"> communicates with it I've got some</font>

25
00:01:35,220 --> 00:01:42,720
devices<font color="#E5E5E5"> here I hope they will work in</font>

26
00:01:39,450 --> 00:01:45,360
<font color="#CCCCCC">real time we'll see some cool</font><font color="#E5E5E5"> tools that</font>

27
00:01:42,720 --> 00:01:47,369
are available<font color="#E5E5E5"> today for for the use for</font>

28
00:01:45,360 --> 00:01:49,259
the<font color="#CCCCCC"> man in the</font><font color="#E5E5E5"> middle and we'll talk</font>

29
00:01:47,369 --> 00:01:53,909
<font color="#CCCCCC">about</font><font color="#E5E5E5"> some possible country</font>

30
00:01:49,259 --> 00:01:55,530
countermeasures and what's<font color="#E5E5E5"> next so just</font>

31
00:01:53,909 --> 00:01:59,460
a little<font color="#CCCCCC"> about me</font>

32
00:01:55,530 --> 00:02:04,140
I'm<font color="#CCCCCC"> Todd</font><font color="#E5E5E5"> I work at</font><font color="#CCCCCC"> Absa clubs</font><font color="#E5E5E5"> as the</font>

33
00:01:59,460 --> 00:02:06,509
name says<font color="#E5E5E5"> we deal with secure apps so we</font>

34
00:02:04,140 --> 00:02:10,169
our goal is<font color="#CCCCCC"> to secure</font><font color="#E5E5E5"> all the apps in</font>

35
00:02:06,509 --> 00:02:12,750
the world<font color="#CCCCCC"> apps I mean web applications</font>

36
00:02:10,169 --> 00:02:13,739
<font color="#E5E5E5">client desktop application mobile</font>

37
00:02:12,750 --> 00:02:18,120
application

38
00:02:13,740 --> 00:02:22,320
IOT and this is part of the IOT<font color="#E5E5E5"> that I'm</font>

39
00:02:18,120 --> 00:02:25,320
talking<font color="#CCCCCC"> about about twelve</font><font color="#E5E5E5"> years in the</font>

40
00:02:22,320 --> 00:02:29,790
<font color="#E5E5E5">field of information</font><font color="#CCCCCC"> security working</font><font color="#E5E5E5"> at</font>

41
00:02:25,320 --> 00:02:34,500
some companies security companies like

42
00:02:29,790 --> 00:02:37,829
<font color="#E5E5E5">checkpoint and RSA and others and part</font>

43
00:02:34,500 --> 00:02:40,200
of what I'm doing<font color="#E5E5E5"> is developing</font><font color="#CCCCCC"> security</font>

44
00:02:37,830 --> 00:02:43,110
content for training<font color="#E5E5E5"> for training</font>

45
00:02:40,200 --> 00:02:48,179
purposes<font color="#CCCCCC"> whether it's secure coding for</font>

46
00:02:43,110 --> 00:02:52,830
developers hacking for hackers<font color="#E5E5E5"> and</font>

47
00:02:48,180 --> 00:02:55,170
awareness for who else needs<font color="#E5E5E5"> it</font><font color="#CCCCCC"> you can</font>

48
00:02:52,830 --> 00:03:01,230
follow me at my<font color="#E5E5E5"> personal website at</font><font color="#CCCCCC"> my</font>

49
00:02:55,170 --> 00:03:03,000
<font color="#CCCCCC">Geetha</font><font color="#E5E5E5"> or through LinkedIn</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> about a</font>

50
00:03:01,230 --> 00:03:08,340
word about<font color="#CCCCCC"> abstract labs we deal with</font>

51
00:03:03,000 --> 00:03:12,090
<font color="#E5E5E5">all the all the industry vectors we have</font>

52
00:03:08,340 --> 00:03:14,730
<font color="#E5E5E5">clients from biggest organizations like</font>

53
00:03:12,090 --> 00:03:17,910
Intel Microsoft's<font color="#E5E5E5"> to small startups</font>

54
00:03:14,730 --> 00:03:20,940
<font color="#E5E5E5">where we work on really cool cool things</font>

55
00:03:17,910 --> 00:03:25,190
like<font color="#E5E5E5"> I don't know biometric logins and</font>

56
00:03:20,940 --> 00:03:28,050
things like that<font color="#E5E5E5"> and you</font><font color="#CCCCCC"> can see us in</font>

57
00:03:25,190 --> 00:03:32,640
<font color="#CCCCCC">the past five years</font><font color="#E5E5E5"> in all the</font><font color="#CCCCCC"> blackhat</font>

58
00:03:28,050 --> 00:03:35,550
Vegas events and<font color="#CCCCCC"> host events</font>

59
00:03:32,640 --> 00:03:40,910
another cool hacking conferences like

60
00:03:35,550 --> 00:03:45,000
<font color="#CCCCCC">Shah but this is the first</font><font color="#E5E5E5"> time okay</font><font color="#CCCCCC"> so</font>

61
00:03:40,910 --> 00:03:47,220
let's start<font color="#E5E5E5"> with what is</font><font color="#CCCCCC"> Billy I'll just</font>

62
00:03:45,000 --> 00:03:47,580
mention Billy Billy but what is it

63
00:03:47,220 --> 00:03:50,609
<font color="#E5E5E5">really</font>

64
00:03:47,580 --> 00:03:51,900
so Billy is an abbreviation for

65
00:03:50,610 --> 00:03:55,800
Bluetooth Low Energy

66
00:03:51,900 --> 00:03:59,130
it's the successor of the normal

67
00:03:55,800 --> 00:04:01,380
<font color="#CCCCCC">Bluetooth that we all heard of it's code</font>

68
00:03:59,130 --> 00:04:04,799
also<font color="#E5E5E5"> Bluetooth</font><font color="#CCCCCC"> smart it's part</font><font color="#E5E5E5"> of the</font>

69
00:04:01,380 --> 00:04:09,420
Bluetooth<font color="#CCCCCC"> 4 specifications</font><font color="#E5E5E5"> and designed</font>

70
00:04:04,800 --> 00:04:14,940
to be power efficient<font color="#CCCCCC"> it's smaller much</font>

71
00:04:09,420 --> 00:04:19,380
easier to implement<font color="#E5E5E5"> and it it's supposed</font>

72
00:04:14,940 --> 00:04:22,200
to<font color="#CCCCCC"> last longer so why did the</font><font color="#E5E5E5"> Bluetooth</font>

73
00:04:19,380 --> 00:04:26,669
come with the ble because as we<font color="#E5E5E5"> can see</font>

74
00:04:22,200 --> 00:04:31,979
today<font color="#E5E5E5"> we got coyotes everywhere I</font>

75
00:04:26,669 --> 00:04:37,139
I mean in every<font color="#E5E5E5"> aspect houses wearables</font>

76
00:04:31,979 --> 00:04:39,979
etc<font color="#E5E5E5"> medical everything so there was a</font>

77
00:04:37,139 --> 00:04:42,810
need<font color="#CCCCCC"> for a protocol that can support the</font>

78
00:04:39,979 --> 00:04:48,120
<font color="#E5E5E5">scale this type of scale which will be</font>

79
00:04:42,810 --> 00:04:53,909
<font color="#E5E5E5">cost-effective</font><font color="#CCCCCC"> and efficient and will</font>

80
00:04:48,120 --> 00:04:57,060
<font color="#E5E5E5">last long</font><font color="#CCCCCC"> so by 2021 there's supposed</font><font color="#E5E5E5"> to</font>

81
00:04:53,909 --> 00:05:01,139
<font color="#CCCCCC">be according</font><font color="#E5E5E5"> to Gartner or something 48</font>

82
00:04:57,060 --> 00:05:05,969
billion IOT devices and<font color="#CCCCCC"> they're</font>

83
00:05:01,139 --> 00:05:09,240
<font color="#E5E5E5">estimated</font><font color="#CCCCCC"> third of all the</font><font color="#E5E5E5"> devices would</font>

84
00:05:05,969 --> 00:05:12,979
<font color="#CCCCCC">be based on bluetooth so we've got a</font>

85
00:05:09,240 --> 00:05:16,889
wide range of devices<font color="#E5E5E5"> to hack and secure</font>

86
00:05:12,979 --> 00:05:20,219
<font color="#CCCCCC">what word is the difference between the</font>

87
00:05:16,889 --> 00:05:22,349
<font color="#CCCCCC">Billy</font><font color="#E5E5E5"> and the Bluetooth classic</font><font color="#CCCCCC"> so they</font>

88
00:05:20,219 --> 00:05:25,650
are different<font color="#CCCCCC"> completely</font><font color="#E5E5E5"> different</font><font color="#CCCCCC"> they</font>

89
00:05:22,349 --> 00:05:27,870
talk on<font color="#E5E5E5"> the same spectrum 2.5 gigahertz</font>

90
00:05:25,650 --> 00:05:32,489
but they have different as architecture

91
00:05:27,870 --> 00:05:36,919
<font color="#E5E5E5">the ble is working in a</font><font color="#CCCCCC"> master/slave</font>

92
00:05:32,490 --> 00:05:39,469
kind of mode<font color="#CCCCCC"> we'll see it</font>

93
00:05:36,919 --> 00:05:42,270
they have<font color="#E5E5E5"> different module parameters</font>

94
00:05:39,469 --> 00:05:45,779
channels<font color="#E5E5E5"> the format of the packets are</font>

95
00:05:42,270 --> 00:05:47,849
totally different<font color="#E5E5E5"> and on top of that</font>

96
00:05:45,779 --> 00:05:52,020
<font color="#E5E5E5">they cannot</font><font color="#CCCCCC"> communicate with each other</font>

97
00:05:47,849 --> 00:05:54,900
<font color="#E5E5E5">so it's not that ble devices supports</font>

98
00:05:52,020 --> 00:05:58,370
also<font color="#E5E5E5"> communication with BT</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> Bluetooth</font>

99
00:05:54,900 --> 00:06:01,679
classic<font color="#E5E5E5"> nope you have to buy new</font><font color="#CCCCCC"> ones</font>

100
00:05:58,370 --> 00:06:03,750
<font color="#CCCCCC">and if you have them</font><font color="#E5E5E5"> you probably have</font>

101
00:06:01,680 --> 00:06:09,569
to buy<font color="#CCCCCC"> new</font><font color="#E5E5E5"> one soon after you hear this</font>

102
00:06:03,750 --> 00:06:13,469
talk<font color="#CCCCCC"> ok so I told</font><font color="#E5E5E5"> you why why the change</font>

103
00:06:09,569 --> 00:06:18,330
<font color="#E5E5E5">so good power consumption and costs it's</font>

104
00:06:13,469 --> 00:06:22,620
very cheap<font color="#CCCCCC"> you can look on Aliexpress or</font>

105
00:06:18,330 --> 00:06:23,969
whatever and find<font color="#CCCCCC"> lakhs chips and</font>

106
00:06:22,620 --> 00:06:29,940
<font color="#E5E5E5">everything</font>

107
00:06:23,969 --> 00:06:34,649
Bluetooth<font color="#CCCCCC"> II that costs 5 from</font><font color="#E5E5E5"> 10 cents</font>

108
00:06:29,940 --> 00:06:36,750
to<font color="#E5E5E5"> $100 so where the risk in all of</font><font color="#CCCCCC"> that</font>

109
00:06:34,649 --> 00:06:39,220
<font color="#E5E5E5">so of course in</font><font color="#CCCCCC"> the industry if we go to</font>

110
00:06:36,750 --> 00:06:43,090
the most<font color="#E5E5E5"> may be one</font><font color="#CCCCCC"> of them</font>

111
00:06:39,220 --> 00:06:48,150
important ones<font color="#E5E5E5"> for medical industry so</font>

112
00:06:43,090 --> 00:06:51,810
also<font color="#E5E5E5"> they already managed to hacked some</font>

113
00:06:48,150 --> 00:06:55,359
medical equipment like<font color="#CCCCCC"> they met diabetic</font>

114
00:06:51,810 --> 00:07:00,070
insulin pumps<font color="#E5E5E5"> so you can</font><font color="#CCCCCC"> imagine what</font>

115
00:06:55,360 --> 00:07:02,170
they can<font color="#E5E5E5"> do</font><font color="#CCCCCC"> if we go to our</font><font color="#E5E5E5"> own lives</font><font color="#CCCCCC"> we</font>

116
00:07:00,070 --> 00:07:06,849
can see now<font color="#CCCCCC"> everywhere so there's a</font>

117
00:07:02,170 --> 00:07:11,080
thermometer<font color="#CCCCCC"> insulin pump that attach</font><font color="#E5E5E5"> to</font>

118
00:07:06,850 --> 00:07:13,860
<font color="#CCCCCC">your body</font><font color="#E5E5E5"> if you</font><font color="#CCCCCC"> can just pump</font><font color="#E5E5E5"> someone</font>

119
00:07:11,080 --> 00:07:17,890
from remote<font color="#E5E5E5"> that could be dangerous</font>

120
00:07:13,860 --> 00:07:19,660
we've got everywhere this<font color="#CCCCCC"> is now the the</font>

121
00:07:17,890 --> 00:07:22,690
most common<font color="#CCCCCC"> thing you can</font><font color="#E5E5E5"> find online is</font>

122
00:07:19,660 --> 00:07:25,630
<font color="#CCCCCC">the</font><font color="#E5E5E5"> Bluetooth devices locks</font><font color="#CCCCCC"> I've got one</font>

123
00:07:22,690 --> 00:07:28,719
here<font color="#CCCCCC"> I hope it it will work</font><font color="#E5E5E5"> sometimes</font>

124
00:07:25,630 --> 00:07:33,190
they<font color="#CCCCCC"> don't</font><font color="#E5E5E5"> work that well especially</font><font color="#CCCCCC"> if</font>

125
00:07:28,720 --> 00:07:34,750
you buy them<font color="#E5E5E5"> from Aliexpress</font><font color="#CCCCCC"> so we've</font>

126
00:07:33,190 --> 00:07:36,580
got<font color="#E5E5E5"> all these locks and they are all</font>

127
00:07:34,750 --> 00:07:40,350
<font color="#E5E5E5">very secure</font><font color="#CCCCCC"> because their locks their</font>

128
00:07:36,580 --> 00:07:43,659
physical not only technical not

129
00:07:40,350 --> 00:07:46,270
technological but after all<font color="#E5E5E5"> also</font><font color="#CCCCCC"> be</font>

130
00:07:43,660 --> 00:07:49,210
bluetooths have the software layer upon

131
00:07:46,270 --> 00:07:52,359
above it and this is what<font color="#E5E5E5"> where we come</font>

132
00:07:49,210 --> 00:07:57,909
and<font color="#E5E5E5"> we see that they are not so tough</font>

133
00:07:52,360 --> 00:08:00,130
after all of course<font color="#E5E5E5"> open</font><font color="#CCCCCC"> watch and other</font>

134
00:07:57,910 --> 00:08:02,590
<font color="#CCCCCC">gadgets to open your door your garage</font>

135
00:08:00,130 --> 00:08:06,850
door your home door you don't<font color="#E5E5E5"> have to</font>

136
00:08:02,590 --> 00:08:13,349
talk<font color="#CCCCCC"> about</font><font color="#E5E5E5"> sound and the most part we</font>

137
00:08:06,850 --> 00:08:17,169
have<font color="#CCCCCC"> also inhalers</font><font color="#E5E5E5"> medical inhalers that</font>

138
00:08:13,350 --> 00:08:20,490
also<font color="#E5E5E5"> are smart today someone has to be</font>

139
00:08:17,169 --> 00:08:26,340
smart<font color="#CCCCCC"> if they're using it</font>

140
00:08:20,490 --> 00:08:29,350
so let's talk shortly about the

141
00:08:26,340 --> 00:08:32,919
architecture<font color="#E5E5E5"> what how does it work</font>

142
00:08:29,350 --> 00:08:35,469
so<font color="#CCCCCC"> three layers we can submit that that</font>

143
00:08:32,919 --> 00:08:40,870
<font color="#E5E5E5">way we have the controller layer where</font>

144
00:08:35,469 --> 00:08:42,640
the physical engineering<font color="#E5E5E5"> stuff the radio</font>

145
00:08:40,870 --> 00:08:47,530
<font color="#CCCCCC">control connection linking I'm not in</font>

146
00:08:42,640 --> 00:08:49,630
<font color="#CCCCCC">Hardware guy radio testing and of course</font>

147
00:08:47,530 --> 00:08:51,980
the interface for<font color="#E5E5E5"> the</font><font color="#CCCCCC"> host so the</font>

148
00:08:49,630 --> 00:08:54,709
interface is how

149
00:08:51,980 --> 00:08:57,230
the components are<font color="#CCCCCC"> going</font><font color="#E5E5E5"> to talk with</font>

150
00:08:54,709 --> 00:08:59,899
<font color="#E5E5E5">the physical layers and on the host we</font>

151
00:08:57,230 --> 00:09:02,119
have the<font color="#E5E5E5"> it sits on top</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the radio and</font>

152
00:08:59,899 --> 00:09:04,100
it provides<font color="#E5E5E5"> API to the application we</font>

153
00:09:02,119 --> 00:09:06,889
have some components there<font color="#E5E5E5"> like the</font>

154
00:09:04,100 --> 00:09:09,739
security manager<font color="#E5E5E5"> and other component</font>

155
00:09:06,889 --> 00:09:13,999
<font color="#E5E5E5">that we're going to shortly discuss soon</font>

156
00:09:09,739 --> 00:09:17,660
<font color="#E5E5E5">and we've got the</font><font color="#CCCCCC"> app player</font><font color="#E5E5E5"> where this</font>

157
00:09:13,999 --> 00:09:20,359
<font color="#E5E5E5">is where the</font><font color="#CCCCCC"> upcome</font><font color="#E5E5E5"> so the interface to</font>

158
00:09:17,660 --> 00:09:25,269
the<font color="#CCCCCC"> hosts</font><font color="#E5E5E5"> and they</font><font color="#CCCCCC"> communicate with</font>

159
00:09:20,359 --> 00:09:31,040
<font color="#CCCCCC">billy components scanning</font><font color="#E5E5E5"> pairing</font>

160
00:09:25,269 --> 00:09:33,169
crypting hopefully and other things that

161
00:09:31,040 --> 00:09:37,579
<font color="#CCCCCC">bluetooth devices can do music camera</font>

162
00:09:33,169 --> 00:09:42,319
<font color="#CCCCCC">etc so the security</font><font color="#E5E5E5"> manager part of the</font>

163
00:09:37,579 --> 00:09:48,529
host part<font color="#E5E5E5"> of the architecture it has</font>

164
00:09:42,319 --> 00:09:50,229
three main goals<font color="#E5E5E5"> it is</font><font color="#CCCCCC"> doing the it is</font>

165
00:09:48,529 --> 00:09:53,329
in charge of the pairing<font color="#E5E5E5"> feature</font>

166
00:09:50,230 --> 00:09:58,369
exchange the short key term key

167
00:09:53,329 --> 00:10:00,709
generation<font color="#E5E5E5"> and</font><font color="#CCCCCC"> key</font><font color="#E5E5E5"> distribution it</font><font color="#CCCCCC"> has</font>

168
00:09:58,369 --> 00:10:08,259
built<font color="#CCCCCC"> in some built-in</font><font color="#E5E5E5"> security</font>

169
00:10:00,709 --> 00:10:08,258
functions and for<font color="#E5E5E5"> example aes-128</font>

170
00:10:08,319 --> 00:10:20,479
and it is it<font color="#CCCCCC"> uses</font><font color="#E5E5E5"> a key exchange for</font>

171
00:10:18,139 --> 00:10:22,970
transferring keys<font color="#E5E5E5"> between the device and</font>

172
00:10:20,480 --> 00:10:26,949
<font color="#E5E5E5">the client the client</font><font color="#CCCCCC"> could be mobile</font>

173
00:10:22,970 --> 00:10:33,589
app or another device<font color="#E5E5E5"> or some hardware</font>

174
00:10:26,949 --> 00:10:35,839
etc and<font color="#CCCCCC"> they it uses a symmetric</font><font color="#E5E5E5"> team</font>

175
00:10:33,589 --> 00:10:39,019
the a<font color="#E5E5E5"> symmetric key model where they</font>

176
00:10:35,839 --> 00:10:42,889
have private<font color="#E5E5E5"> key and public key so it</font>

177
00:10:39,019 --> 00:10:46,279
sounds a little secure<font color="#E5E5E5"> is it really</font>

178
00:10:42,889 --> 00:10:50,779
secure<font color="#E5E5E5"> so the problem comes</font><font color="#CCCCCC"> in the</font>

179
00:10:46,279 --> 00:10:55,609
pairing the most the<font color="#CCCCCC"> the problem that</font>

180
00:10:50,779 --> 00:10:58,039
reveals<font color="#E5E5E5"> the apps for for this expose the</font>

181
00:10:55,609 --> 00:11:00,169
apps for<font color="#CCCCCC"> that risks for the</font><font color="#E5E5E5"> risks so</font>

182
00:10:58,039 --> 00:11:03,350
we've got the pairing we said the

183
00:11:00,169 --> 00:11:05,569
pairing<font color="#E5E5E5"> the pairing is made between the</font>

184
00:11:03,350 --> 00:11:10,640
smart device to them

185
00:11:05,570 --> 00:11:12,740
up or some other up<font color="#CCCCCC"> in order to encrypt</font>

186
00:11:10,640 --> 00:11:15,319
their communication link between<font color="#E5E5E5"> them so</font>

187
00:11:12,740 --> 00:11:19,430
they can speak privately<font color="#CCCCCC"> and no one else</font>

188
00:11:15,320 --> 00:11:24,260
will<font color="#E5E5E5"> be able to listen</font><font color="#CCCCCC"> the key can be</font>

189
00:11:19,430 --> 00:11:26,630
<font color="#CCCCCC">used also to sign and verify data</font><font color="#E5E5E5"> random</font>

190
00:11:24,260 --> 00:11:33,560
address<font color="#CCCCCC"> resolution and some other parts</font>

191
00:11:26,630 --> 00:11:36,310
that<font color="#E5E5E5"> Bluetooth provides the the pair the</font>

192
00:11:33,560 --> 00:11:40,310
pairing process<font color="#E5E5E5"> is a three phase</font><font color="#CCCCCC"> process</font>

193
00:11:36,310 --> 00:11:42,050
<font color="#E5E5E5">first of all the device so now I'm going</font>

194
00:11:40,310 --> 00:11:44,900
<font color="#E5E5E5">to say device I'm going</font><font color="#CCCCCC"> to use this</font>

195
00:11:42,050 --> 00:11:50,000
<font color="#E5E5E5">smart bracelet you can't see</font><font color="#CCCCCC"> from</font><font color="#E5E5E5"> behind</font>

196
00:11:44,900 --> 00:11:53,030
just believe me and then the other one

197
00:11:50,000 --> 00:11:56,630
will<font color="#CCCCCC"> be</font><font color="#E5E5E5"> second</font><font color="#CCCCCC"> okay</font>

198
00:11:53,030 --> 00:11:59,870
the<font color="#E5E5E5"> Apple show the screen</font><font color="#CCCCCC"> of the app of</font>

199
00:11:56,630 --> 00:12:01,280
the<font color="#E5E5E5"> mobile phone on the screen soon so</font>

200
00:11:59,870 --> 00:12:03,950
they are going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> communicate with each</font>

201
00:12:01,280 --> 00:12:07,870
<font color="#CCCCCC">other and while the pairing</font><font color="#E5E5E5"> they</font>

202
00:12:03,950 --> 00:12:11,030
<font color="#E5E5E5">exchange the pairing feature</font>

203
00:12:07,870 --> 00:12:12,800
possibilities because some<font color="#E5E5E5"> devices and</font>

204
00:12:11,030 --> 00:12:15,020
this<font color="#E5E5E5"> is the the next slide I'm going to</font>

205
00:12:12,800 --> 00:12:18,770
<font color="#E5E5E5">talk about the three types of pairing</font>

206
00:12:15,020 --> 00:12:23,360
they have so I have<font color="#E5E5E5"> two after they they</font>

207
00:12:18,770 --> 00:12:29,210
<font color="#E5E5E5">changed their pairing feature features</font>

208
00:12:23,360 --> 00:12:33,170
<font color="#E5E5E5">they go with the chosen one and then the</font>

209
00:12:29,210 --> 00:12:36,530
device or<font color="#CCCCCC"> the app one</font><font color="#E5E5E5"> of them</font><font color="#CCCCCC"> generates</font>

210
00:12:33,170 --> 00:12:40,160
a key<font color="#E5E5E5"> if we're talking about</font><font color="#CCCCCC"> Bluetooth</font>

211
00:12:36,530 --> 00:12:42,380
<font color="#CCCCCC">for 4.0 it's going to be the legacy</font>

212
00:12:40,160 --> 00:12:47,260
pairing<font color="#E5E5E5"> which is the same pairing that</font>

213
00:12:42,380 --> 00:12:50,240
<font color="#E5E5E5">words in the</font><font color="#CCCCCC"> Baloo's classic and from</font>

214
00:12:47,260 --> 00:12:52,580
4.1<font color="#E5E5E5"> to</font><font color="#CCCCCC"> Bluetooth five they're going to</font>

215
00:12:50,240 --> 00:12:55,400
they're using secure connections this<font color="#CCCCCC"> is</font>

216
00:12:52,580 --> 00:12:58,780
<font color="#CCCCCC">it's it's called that way at the</font><font color="#E5E5E5"> using</font>

217
00:12:55,400 --> 00:13:02,390
long term key<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> much more secure</font>

218
00:12:58,780 --> 00:13:05,030
<font color="#E5E5E5">key exchange</font><font color="#CCCCCC"> low</font><font color="#E5E5E5"> key generation and then</font>

219
00:13:02,390 --> 00:13:10,069
they transport the keys between<font color="#E5E5E5"> them so</font>

220
00:13:05,030 --> 00:13:14,420
they can encrypt the link so pairing<font color="#E5E5E5"> we</font>

221
00:13:10,070 --> 00:13:18,290
<font color="#E5E5E5">have three types of pairing</font><font color="#CCCCCC"> which is</font>

222
00:13:14,420 --> 00:13:19,520
really how do the device determine how

223
00:13:18,290 --> 00:13:22,819
<font color="#CCCCCC">to create the key</font>

224
00:13:19,520 --> 00:13:27,949
so we have the<font color="#E5E5E5"> first most common one</font>

225
00:13:22,820 --> 00:13:31,160
<font color="#E5E5E5">legacy one just works</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is this is</font>

226
00:13:27,950 --> 00:13:34,130
its name<font color="#E5E5E5"> they branded it just works</font><font color="#CCCCCC"> when</font>

227
00:13:31,160 --> 00:13:36,829
you go and check<font color="#E5E5E5"> why it just works</font>

228
00:13:34,130 --> 00:13:41,180
then you find out<font color="#E5E5E5"> that</font><font color="#CCCCCC"> the key is</font><font color="#E5E5E5"> zero</font>

229
00:13:36,830 --> 00:13:44,990
<font color="#CCCCCC">so of course it just works I could do</font><font color="#E5E5E5"> it</font>

230
00:13:41,180 --> 00:13:48,050
myself<font color="#CCCCCC"> the other way</font>

231
00:13:44,990 --> 00:13:51,740
method is the six digit<font color="#CCCCCC"> pin</font><font color="#E5E5E5"> could be</font>

232
00:13:48,050 --> 00:13:55,160
also four digit PIN<font color="#CCCCCC"> I think anyway if</font>

233
00:13:51,740 --> 00:13:58,610
your device have a screen and<font color="#E5E5E5"> only then</font>

234
00:13:55,160 --> 00:14:00,860
because<font color="#E5E5E5"> you have to see the pin</font><font color="#CCCCCC"> then</font>

235
00:13:58,610 --> 00:14:03,709
sometimes if both<font color="#CCCCCC"> of the devices</font>

236
00:14:00,860 --> 00:14:08,120
communicate has<font color="#E5E5E5"> this the 6 pin digit</font>

237
00:14:03,709 --> 00:14:10,310
then you can one device<font color="#CCCCCC"> can display</font><font color="#E5E5E5"> pin</font>

238
00:14:08,120 --> 00:14:13,370
serial<font color="#E5E5E5"> I don't know a pin</font><font color="#CCCCCC"> number</font><font color="#E5E5E5"> and</font>

239
00:14:10,310 --> 00:14:15,170
then you have to manually click it<font color="#CCCCCC"> on</font>

240
00:14:13,370 --> 00:14:18,709
the other device type it<font color="#E5E5E5"> on the other</font>

241
00:14:15,170 --> 00:14:22,490
device<font color="#CCCCCC"> so this is going to generate the</font>

242
00:14:18,709 --> 00:14:25,219
key<font color="#CCCCCC"> the</font><font color="#E5E5E5"> temporary key so they can</font>

243
00:14:22,490 --> 00:14:26,329
communicate<font color="#E5E5E5"> with</font><font color="#CCCCCC"> each other ok</font><font color="#E5E5E5"> six</font>

244
00:14:25,220 --> 00:14:30,410
digits

245
00:14:26,329 --> 00:14:32,420
1 million<font color="#E5E5E5"> options we can brute force it</font>

246
00:14:30,410 --> 00:14:34,300
<font color="#CCCCCC">of course I'm not</font><font color="#E5E5E5"> going to show I'm</font>

247
00:14:32,420 --> 00:14:40,990
going to<font color="#CCCCCC"> brute-force</font><font color="#E5E5E5"> it it's already</font>

248
00:14:34,300 --> 00:14:47,449
shown by<font color="#E5E5E5"> Mike Ryan on</font><font color="#CCCCCC"> blackhat I think</font>

249
00:14:40,990 --> 00:14:52,329
you can see is a great presentation on

250
00:14:47,450 --> 00:14:57,370
<font color="#E5E5E5">blackhat and it shows how all the</font>

251
00:14:52,329 --> 00:15:01,790
bluetooth pairing<font color="#E5E5E5"> model is not so good</font>

252
00:14:57,370 --> 00:15:04,430
<font color="#CCCCCC">it's not working</font><font color="#E5E5E5"> really secure and the</font>

253
00:15:01,790 --> 00:15:07,730
other option<font color="#CCCCCC"> the third one is out of</font>

254
00:15:04,430 --> 00:15:09,439
<font color="#E5E5E5">band out of</font><font color="#CCCCCC"> band means they are the</font>

255
00:15:07,730 --> 00:15:11,959
<font color="#CCCCCC">devices that</font><font color="#E5E5E5"> communicate with</font><font color="#CCCCCC"> each other</font>

256
00:15:09,440 --> 00:15:18,529
they transfer the key on<font color="#CCCCCC"> a different</font>

257
00:15:11,959 --> 00:15:21,199
protocol different spectrum but supposed

258
00:15:18,529 --> 00:15:24,170
to<font color="#E5E5E5"> be</font><font color="#CCCCCC"> secure because</font><font color="#E5E5E5"> the key is going</font>

259
00:15:21,200 --> 00:15:28,850
over a<font color="#E5E5E5"> different channel so no one's</font>

260
00:15:24,170 --> 00:15:32,170
listening it to it<font color="#CCCCCC"> hopefully</font><font color="#E5E5E5"> like NFC or</font>

261
00:15:28,850 --> 00:15:36,810
something like<font color="#E5E5E5"> that</font><font color="#CCCCCC"> so for that</font><font color="#E5E5E5"> to work</font>

262
00:15:32,170 --> 00:15:39,670
both<font color="#E5E5E5"> devices have</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> support this new</font>

263
00:15:36,810 --> 00:15:42,160
<font color="#E5E5E5">smartphones maybe support NFC but most</font>

264
00:15:39,670 --> 00:15:46,410
Bluetooth devices doesn't support<font color="#E5E5E5"> NFC</font>

265
00:15:42,160 --> 00:15:49,680
because they are<font color="#E5E5E5"> Bluetooth devices so I</font>

266
00:15:46,410 --> 00:15:52,140
actually haven't<font color="#CCCCCC"> seen one that using</font><font color="#E5E5E5"> it</font>

267
00:15:49,680 --> 00:15:56,729
hopefully<font color="#CCCCCC"> they're not just saying</font><font color="#E5E5E5"> that</font>

268
00:15:52,140 --> 00:15:59,920
<font color="#E5E5E5">but there are some ways to</font><font color="#CCCCCC"> do that so</font>

269
00:15:56,730 --> 00:16:02,500
<font color="#CCCCCC">Bluetooth says none of the pairing</font>

270
00:15:59,920 --> 00:16:06,160
methods provide protection again passive

271
00:16:02,500 --> 00:16:09,250
eavesdropper<font color="#E5E5E5"> great thank you</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> letting</font>

272
00:16:06,160 --> 00:16:13,540
us<font color="#E5E5E5"> know</font><font color="#CCCCCC"> you could come up with</font><font color="#E5E5E5"> something</font>

273
00:16:09,250 --> 00:16:16,380
that does protect against a passive

274
00:16:13,540 --> 00:16:19,540
eavesdropper but<font color="#E5E5E5"> oh sorry</font><font color="#CCCCCC"> don't worry</font>

275
00:16:16,380 --> 00:16:22,270
<font color="#CCCCCC">because the next version will support</font><font color="#E5E5E5"> a</font>

276
00:16:19,540 --> 00:16:25,089
<font color="#E5E5E5">light T curve and if you</font><font color="#CCCCCC"> Elmont for key</font>

277
00:16:22,270 --> 00:16:27,640
exchange<font color="#CCCCCC"> okay great that's really great</font>

278
00:16:25,090 --> 00:16:29,650
they understood the problem but the

279
00:16:27,640 --> 00:16:34,780
<font color="#CCCCCC">problem for</font><font color="#E5E5E5"> me</font><font color="#CCCCCC"> is that I already</font><font color="#E5E5E5"> bought</font>

280
00:16:29,650 --> 00:16:40,170
the<font color="#E5E5E5"> devices so my devices are using BT</font>

281
00:16:34,780 --> 00:16:43,030
<font color="#E5E5E5">blue</font><font color="#CCCCCC"> ble 4.0 so they are not secure so</font>

282
00:16:40,170 --> 00:16:46,270
<font color="#CCCCCC">from</font><font color="#E5E5E5"> all that I didn't understand are</font>

283
00:16:43,030 --> 00:16:49,689
they secure or not secure<font color="#CCCCCC"> so in practice</font>

284
00:16:46,270 --> 00:16:54,280
<font color="#CCCCCC">we test a lot of</font><font color="#E5E5E5"> IOT devices</font>

285
00:16:49,690 --> 00:16:59,050
<font color="#CCCCCC">Bailey devices and at least</font><font color="#E5E5E5"> 80% or about</font>

286
00:16:54,280 --> 00:17:03,189
<font color="#E5E5E5">80% of the smart devices doesn't use the</font>

287
00:16:59,050 --> 00:17:08,980
cryptographic possibilities of the of

288
00:17:03,190 --> 00:17:11,560
the protocol<font color="#E5E5E5"> and they just work and they</font>

289
00:17:08,980 --> 00:17:16,360
don't use the encryption<font color="#CCCCCC"> they don't use</font>

290
00:17:11,560 --> 00:17:19,179
<font color="#E5E5E5">the verification and they let the app</font>

291
00:17:16,359 --> 00:17:22,448
handle everything<font color="#CCCCCC"> so but the problem is</font>

292
00:17:19,180 --> 00:17:25,800
that<font color="#E5E5E5"> the app mobile</font><font color="#CCCCCC"> app cannot control</font>

293
00:17:22,449 --> 00:17:28,360
everything<font color="#E5E5E5"> because the app doesn't have</font>

294
00:17:25,800 --> 00:17:31,480
control over<font color="#E5E5E5"> the operation level or</font>

295
00:17:28,359 --> 00:17:34,030
let's say the device<font color="#E5E5E5"> so if it's a mobile</font>

296
00:17:31,480 --> 00:17:37,720
device<font color="#E5E5E5"> the app usually cannot control</font>

297
00:17:34,030 --> 00:17:40,899
the<font color="#E5E5E5"> Bluetooth features of the of the</font>

298
00:17:37,720 --> 00:17:46,540
device because it it is it is installed

299
00:17:40,900 --> 00:17:49,990
on a<font color="#CCCCCC"> device random device</font>

300
00:17:46,540 --> 00:17:52,750
so as I<font color="#CCCCCC"> said they're not</font><font color="#E5E5E5"> really</font><font color="#CCCCCC"> secure</font>

301
00:17:49,990 --> 00:17:56,650
why<font color="#CCCCCC"> I don't have to tell</font><font color="#E5E5E5"> you why things</font>

302
00:17:52,750 --> 00:17:59,410
are not<font color="#E5E5E5"> secure because probably the most</font>

303
00:17:56,650 --> 00:18:06,400
common<font color="#E5E5E5"> answer is because it's easier to</font>

304
00:17:59,410 --> 00:18:09,340
<font color="#CCCCCC">do it that way okay so the next next</font>

305
00:18:06,400 --> 00:18:10,060
part of<font color="#E5E5E5"> the Bluetooth the ble</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> we'll</font>

306
00:18:09,340 --> 00:18:13,379
talk about

307
00:18:10,060 --> 00:18:17,470
it's most important for<font color="#CCCCCC"> me is the gut</font>

308
00:18:13,380 --> 00:18:20,310
<font color="#E5E5E5">generic attribute profile</font><font color="#CCCCCC"> this is like a</font>

309
00:18:17,470 --> 00:18:24,100
ski scheme used to communicate<font color="#E5E5E5"> between</font>

310
00:18:20,310 --> 00:18:25,929
<font color="#E5E5E5">ble devices like so they know what to</font>

311
00:18:24,100 --> 00:18:29,730
<font color="#CCCCCC">expect</font>

312
00:18:25,930 --> 00:18:33,190
build on top of the attribute protocol

313
00:18:29,730 --> 00:18:37,600
server the gut server which is one

314
00:18:33,190 --> 00:18:41,050
device<font color="#CCCCCC"> and stores</font><font color="#E5E5E5"> data</font><font color="#CCCCCC"> receiving from</font>

315
00:18:37,600 --> 00:18:43,030
other devices<font color="#E5E5E5"> and then it is the to</font>

316
00:18:41,050 --> 00:18:46,990
communicate with the device<font color="#CCCCCC"> I'll show</font>

317
00:18:43,030 --> 00:18:49,510
you how it works<font color="#CCCCCC"> and they organized it</font>

318
00:18:46,990 --> 00:18:52,260
<font color="#E5E5E5">does</font><font color="#CCCCCC"> this game were organized of data</font>

319
00:18:49,510 --> 00:18:54,580
and objects<font color="#E5E5E5"> in profiles</font><font color="#CCCCCC"> characters</font>

320
00:18:52,260 --> 00:18:56,260
characteristics<font color="#E5E5E5"> and services so it's</font>

321
00:18:54,580 --> 00:18:57,070
going to<font color="#E5E5E5"> be something like looks</font>

322
00:18:56,260 --> 00:19:00,490
something like that

323
00:18:57,070 --> 00:19:04,689
<font color="#CCCCCC">I have a service</font><font color="#E5E5E5"> let's say it has a</font>

324
00:19:00,490 --> 00:19:08,920
heart monitor<font color="#CCCCCC"> so how does the app that</font>

325
00:19:04,690 --> 00:19:12,790
<font color="#E5E5E5">communicates with it know that it has a</font>

326
00:19:08,920 --> 00:19:17,200
heart monitor<font color="#E5E5E5"> so it tells there is this</font>

327
00:19:12,790 --> 00:19:19,870
gut profiling<font color="#CCCCCC"> it tells the mobile app or</font>

328
00:19:17,200 --> 00:19:23,020
everyone that wants<font color="#CCCCCC"> to listen okay I've</font>

329
00:19:19,870 --> 00:19:26,560
<font color="#E5E5E5">got this service</font><font color="#CCCCCC"> it's a heart rate this</font>

330
00:19:23,020 --> 00:19:29,230
<font color="#E5E5E5">is the name script or this is the</font>

331
00:19:26,560 --> 00:19:32,800
property<font color="#E5E5E5"> you can write tweet retweet or</font>

332
00:19:29,230 --> 00:19:38,520
notify<font color="#E5E5E5"> notify is like registering and</font>

333
00:19:32,800 --> 00:19:41,350
receiving constant data you can in the

334
00:19:38,520 --> 00:19:44,710
the architectures<font color="#CCCCCC"> had or developers</font>

335
00:19:41,350 --> 00:19:47,679
<font color="#E5E5E5">needed to decide whether you</font><font color="#CCCCCC"> can do act</font>

336
00:19:44,710 --> 00:19:53,260
on this service<font color="#CCCCCC"> radio service or write</font>

337
00:19:47,680 --> 00:19:56,560
to it<font color="#E5E5E5"> authenticated or not and etc other</font>

338
00:19:53,260 --> 00:19:59,260
services line up so what is the<font color="#E5E5E5"> typical</font>

339
00:19:56,560 --> 00:20:01,899
flow the typical flow

340
00:19:59,260 --> 00:20:04,030
for communication between<font color="#E5E5E5"> the</font><font color="#CCCCCC"> mobile app</font>

341
00:20:01,900 --> 00:20:06,820
and<font color="#CCCCCC"> the</font><font color="#E5E5E5"> smart device so this is the</font>

342
00:20:04,030 --> 00:20:10,750
smart device<font color="#E5E5E5"> now I want to pair my</font>

343
00:20:06,820 --> 00:20:14,168
mobile app to it<font color="#CCCCCC"> so</font><font color="#E5E5E5"> usually just</font><font color="#CCCCCC"> I turn</font>

344
00:20:10,750 --> 00:20:17,049
it on<font color="#E5E5E5"> and then it just advertise itself</font>

345
00:20:14,169 --> 00:20:20,380
<font color="#E5E5E5">I am a Bluetooth device someone wants</font><font color="#CCCCCC"> to</font>

346
00:20:17,049 --> 00:20:23,950
connect to me<font color="#CCCCCC"> these are my</font><font color="#E5E5E5"> services and</font>

347
00:20:20,380 --> 00:20:27,970
characteristics<font color="#CCCCCC"> and</font><font color="#E5E5E5"> you can connect to</font>

348
00:20:23,950 --> 00:20:30,790
me then<font color="#CCCCCC"> on the mobile app to connect to</font>

349
00:20:27,970 --> 00:20:33,970
communicate with it I will start by some

350
00:20:30,790 --> 00:20:36,520
app or using<font color="#E5E5E5"> the</font><font color="#CCCCCC"> built-in feature of the</font>

351
00:20:33,970 --> 00:20:40,090
<font color="#E5E5E5">mobile app</font><font color="#CCCCCC"> to scan</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> billy devices</font>

352
00:20:36,520 --> 00:20:45,600
you'll start seeing ble devices<font color="#E5E5E5"> in the</font>

353
00:20:40,090 --> 00:20:47,949
range<font color="#CCCCCC"> once you</font><font color="#E5E5E5"> select an advertise the</font>

354
00:20:45,600 --> 00:20:49,840
application will try to start<font color="#E5E5E5"> reading</font>

355
00:20:47,950 --> 00:20:55,809
all the services and<font color="#E5E5E5"> characteristics</font><font color="#CCCCCC"> and</font>

356
00:20:49,840 --> 00:21:01,470
<font color="#CCCCCC">build</font><font color="#E5E5E5"> your profile on the mobile on the</font>

357
00:20:55,809 --> 00:21:01,470
ble device with what it can operate<font color="#E5E5E5"> on</font>

358
00:21:01,590 --> 00:21:08,049
<font color="#E5E5E5">communication is determined</font><font color="#CCCCCC"> I mean the</font>

359
00:21:04,330 --> 00:21:10,600
device identified<font color="#E5E5E5"> according</font><font color="#CCCCCC"> to its MAC</font>

360
00:21:08,049 --> 00:21:12,700
address<font color="#E5E5E5"> so if</font><font color="#CCCCCC"> you have the same device</font>

361
00:21:10,600 --> 00:21:15,129
with different MAC addresses this is how

362
00:21:12,700 --> 00:21:18,429
they're going<font color="#CCCCCC"> to determine</font><font color="#E5E5E5"> which device</font>

363
00:21:15,130 --> 00:21:23,620
<font color="#CCCCCC">is it which</font><font color="#E5E5E5"> is cool because then we have</font>

364
00:21:18,429 --> 00:21:26,950
<font color="#CCCCCC">Mac spoofing and</font><font color="#E5E5E5"> after they are paired</font>

365
00:21:23,620 --> 00:21:29,020
they have this they have an encrypted

366
00:21:26,950 --> 00:21:31,929
<font color="#CCCCCC">Lincoln and they can start</font><font color="#E5E5E5"> communicating</font>

367
00:21:29,020 --> 00:21:36,400
with<font color="#CCCCCC"> each other but maybe this</font><font color="#E5E5E5"> is a</font>

368
00:21:31,929 --> 00:21:39,250
<font color="#CCCCCC">little</font><font color="#E5E5E5"> complicated let me simplify how</font>

369
00:21:36,400 --> 00:21:44,140
it looks<font color="#CCCCCC"> so this is a billy device I am</font>

370
00:21:39,250 --> 00:21:47,520
a<font color="#E5E5E5"> billy device and this is me</font><font color="#CCCCCC"> thank you</font>

371
00:21:44,140 --> 00:21:53,650
<font color="#E5E5E5">for</font><font color="#CCCCCC"> showing me</font><font color="#E5E5E5"> all your services and</font>

372
00:21:47,520 --> 00:21:56,080
whatever<font color="#E5E5E5"> I</font><font color="#CCCCCC"> can do so at</font><font color="#E5E5E5"> this point I</font>

373
00:21:53,650 --> 00:21:59,020
have<font color="#E5E5E5"> I I told you that the device is</font>

374
00:21:56,080 --> 00:22:02,439
<font color="#E5E5E5">just publishing advertising itself so at</font>

375
00:21:59,020 --> 00:22:08,190
this point what<font color="#CCCCCC"> I do just to start</font>

376
00:22:02,440 --> 00:22:10,680
looking around I download a ble<font color="#E5E5E5"> scanner</font>

377
00:22:08,190 --> 00:22:15,630
randomly from

378
00:22:10,680 --> 00:22:19,890
from<font color="#CCCCCC"> App Store</font><font color="#E5E5E5"> or Play Store and then I</font>

379
00:22:15,630 --> 00:22:24,900
can<font color="#E5E5E5"> start scan for services for</font><font color="#CCCCCC"> a ble</font>

380
00:22:19,890 --> 00:22:27,600
devices<font color="#CCCCCC"> I don't</font><font color="#E5E5E5"> need any special app or</font>

381
00:22:24,900 --> 00:22:30,990
anything<font color="#E5E5E5"> for it</font><font color="#CCCCCC"> i download ble scanner</font>

382
00:22:27,600 --> 00:22:34,350
<font color="#E5E5E5">click on scan</font><font color="#CCCCCC"> i see all the scan</font><font color="#E5E5E5"> all the</font>

383
00:22:30,990 --> 00:22:36,780
<font color="#E5E5E5">ble devices and then I can connect to to</font>

384
00:22:34,350 --> 00:22:38,879
them<font color="#E5E5E5"> some of</font><font color="#CCCCCC"> them I need require some</font>

385
00:22:36,780 --> 00:22:41,250
further<font color="#E5E5E5"> authentication we'll discuss</font>

386
00:22:38,880 --> 00:22:43,320
that<font color="#CCCCCC"> and then I can see something like</font>

387
00:22:41,250 --> 00:22:46,700
<font color="#E5E5E5">this</font><font color="#CCCCCC"> all the device information</font>

388
00:22:43,320 --> 00:22:49,560
attributes and services and I can start

389
00:22:46,700 --> 00:22:52,640
<font color="#E5E5E5">reading them or</font><font color="#CCCCCC"> calling them so I can</font>

390
00:22:49,560 --> 00:22:55,350
<font color="#E5E5E5">just connect to</font><font color="#CCCCCC"> one of your devices</font>

391
00:22:52,640 --> 00:22:58,950
<font color="#E5E5E5">probably</font><font color="#CCCCCC"> they have this is very common</font>

392
00:22:55,350 --> 00:23:02,209
<font color="#E5E5E5">just to see the battery level so I'm</font>

393
00:22:58,950 --> 00:23:05,310
going<font color="#CCCCCC"> to see is there battery level here</font>

394
00:23:02,210 --> 00:23:07,350
<font color="#E5E5E5">stamp I can read the specification of</font>

395
00:23:05,310 --> 00:23:11,370
<font color="#CCCCCC">the device and it will tell me the</font>

396
00:23:07,350 --> 00:23:14,100
battery level of the of the device you

397
00:23:11,370 --> 00:23:17,639
can<font color="#CCCCCC"> see there are all these uuuu IDs</font>

398
00:23:14,100 --> 00:23:22,080
<font color="#E5E5E5">there what are</font><font color="#CCCCCC"> they what are they doing</font>

399
00:23:17,640 --> 00:23:25,320
I don't know<font color="#CCCCCC"> but it's</font><font color="#E5E5E5"> a specification</font>

400
00:23:22,080 --> 00:23:28,110
<font color="#E5E5E5">name so you can take this name because</font>

401
00:23:25,320 --> 00:23:30,419
<font color="#E5E5E5">you don't know what all these services</font>

402
00:23:28,110 --> 00:23:32,790
<font color="#CCCCCC">over here you can see battery</font><font color="#E5E5E5"> service so</font>

403
00:23:30,420 --> 00:23:34,740
what are<font color="#CCCCCC"> all these custom services and</font>

404
00:23:32,790 --> 00:23:37,710
generic attributes<font color="#E5E5E5"> well you don't know</font>

405
00:23:34,740 --> 00:23:41,130
<font color="#E5E5E5">what they do so you</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> copied this</font>

406
00:23:37,710 --> 00:23:43,440
number and then you<font color="#CCCCCC"> Google it</font><font color="#E5E5E5"> or you go</font>

407
00:23:41,130 --> 00:23:46,980
into<font color="#CCCCCC"> Bluetooth and then you have all the</font>

408
00:23:43,440 --> 00:23:50,700
specification<font color="#E5E5E5"> ok if you see the</font><font color="#CCCCCC"> x66</font>

409
00:23:46,980 --> 00:23:53,310
as 1 8 1 1 then this<font color="#CCCCCC"> is alert and if</font>

410
00:23:50,700 --> 00:23:56,640
occasion<font color="#E5E5E5"> sir vez so you know what is</font>

411
00:23:53,310 --> 00:24:01,639
this is used for<font color="#E5E5E5"> and this is how you can</font>

412
00:23:56,640 --> 00:24:06,410
learn about<font color="#E5E5E5"> the device services so now</font>

413
00:24:01,640 --> 00:24:06,410
let's see if if it works<font color="#E5E5E5"> right</font>

414
00:24:08,290 --> 00:24:16,210
<font color="#E5E5E5">okay so I'm going</font><font color="#CCCCCC"> to launch the Billy</font>

415
00:24:13,820 --> 00:24:16,210
<font color="#E5E5E5">Skinner</font>

416
00:24:19,590 --> 00:24:27,019
yeah<font color="#E5E5E5"> okay so now I'm going to scan don't</font>

417
00:24:23,669 --> 00:24:30,809
know<font color="#CCCCCC"> who's</font><font color="#E5E5E5"> blank is someone around here</font>

418
00:24:27,019 --> 00:24:33,840
let's see if I can try<font color="#E5E5E5"> that okay</font><font color="#CCCCCC"> so I've</font>

419
00:24:30,809 --> 00:24:36,809
got this<font color="#E5E5E5"> I tagged it's a simple ble</font>

420
00:24:33,840 --> 00:24:39,629
device where<font color="#CCCCCC"> you can put on</font><font color="#E5E5E5"> your dog or</font>

421
00:24:36,809 --> 00:24:42,418
your wallet<font color="#E5E5E5"> or something and then you</font>

422
00:24:39,629 --> 00:24:45,360
<font color="#E5E5E5">can track it okay so you'd think you</font>

423
00:24:42,419 --> 00:24:47,970
have<font color="#CCCCCC"> a</font><font color="#E5E5E5"> designated up that only</font><font color="#CCCCCC"> this up</font>

424
00:24:45,360 --> 00:24:49,830
<font color="#CCCCCC">nose so you need to put in a serial</font>

425
00:24:47,970 --> 00:24:51,990
number<font color="#CCCCCC"> or</font><font color="#E5E5E5"> something</font><font color="#CCCCCC"> like that and then</font>

426
00:24:49,830 --> 00:24:55,830
you can<font color="#E5E5E5"> you're the</font><font color="#CCCCCC"> only one that can use</font>

427
00:24:51,990 --> 00:25:00,749
it<font color="#CCCCCC"> but</font><font color="#E5E5E5"> no I can just scan it really</font><font color="#CCCCCC"> so</font>

428
00:24:55,830 --> 00:25:02,720
I'm coming<font color="#CCCCCC"> I hope so I hope to find some</font>

429
00:25:00,749 --> 00:25:06,749
ble device I'll connect to it

430
00:25:02,720 --> 00:25:10,970
sorry you can't see the screen<font color="#CCCCCC"> so this</font>

431
00:25:06,749 --> 00:25:13,230
<font color="#E5E5E5">is not healthy I'm talking okay</font>

432
00:25:10,970 --> 00:25:16,919
so you<font color="#E5E5E5"> don't you don't know what I'm</font>

433
00:25:13,230 --> 00:25:21,629
talking about<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> so this is my mobile</font>

434
00:25:16,919 --> 00:25:28,619
<font color="#E5E5E5">okay and then I'm scanning for</font><font color="#CCCCCC"> devices</font>

435
00:25:21,629 --> 00:25:35,699
for ble devices hopefully to<font color="#CCCCCC"> find my my</font>

436
00:25:28,619 --> 00:25:39,059
device let's see if I can find it you

437
00:25:35,700 --> 00:25:44,879
can<font color="#CCCCCC"> see the numbers</font><font color="#E5E5E5"> telling</font><font color="#CCCCCC"> you how far</font>

438
00:25:39,059 --> 00:25:47,700
is it<font color="#E5E5E5"> from the</font><font color="#CCCCCC"> device</font><font color="#E5E5E5"> the the problem is</font>

439
00:25:44,879 --> 00:25:53,418
Billy<font color="#E5E5E5"> that they are not working that</font>

440
00:25:47,700 --> 00:25:56,720
<font color="#E5E5E5">good anyway especially</font><font color="#CCCCCC"> those you</font><font color="#E5E5E5"> buy</font>

441
00:25:53,419 --> 00:25:56,720
<font color="#CCCCCC">metallics press</font>

442
00:26:02,090 --> 00:26:07,639
<font color="#E5E5E5">okay</font><font color="#CCCCCC"> I don't know</font><font color="#E5E5E5"> maybe it's some I'm</font>

443
00:26:05,870 --> 00:26:10,310
<font color="#E5E5E5">not going to do anything so I'm</font><font color="#CCCCCC"> just</font>

444
00:26:07,640 --> 00:26:13,220
clicking on<font color="#E5E5E5"> a device</font><font color="#CCCCCC"> it tries to connect</font>

445
00:26:10,310 --> 00:26:17,690
not sure if it's going to connect<font color="#E5E5E5"> to it</font>

446
00:26:13,220 --> 00:26:20,230
and then I'm<font color="#E5E5E5"> going to see all the</font>

447
00:26:17,690 --> 00:26:20,230
<font color="#E5E5E5">services</font>

448
00:26:23,160 --> 00:26:25,970
<font color="#E5E5E5">okay</font>

449
00:26:34,040 --> 00:26:36,760
<font color="#E5E5E5">okay</font>

450
00:26:39,179 --> 00:26:45,539
<font color="#E5E5E5">okay there it is</font><font color="#CCCCCC"> so I couldn't</font><font color="#E5E5E5"> I'm</font>

451
00:26:41,700 --> 00:26:47,179
connecting<font color="#E5E5E5"> to to this I</font><font color="#CCCCCC"> tagged it's as I</font>

452
00:26:45,539 --> 00:26:53,570
<font color="#E5E5E5">told you it's a general application</font>

453
00:26:47,179 --> 00:26:53,570
<font color="#CCCCCC">Billy scanning let's hope</font><font color="#E5E5E5"> that it works</font>

454
00:26:53,659 --> 00:27:01,700
<font color="#E5E5E5">now it tries</font><font color="#CCCCCC"> to read all the services</font>

455
00:26:56,369 --> 00:27:04,228
that<font color="#E5E5E5"> there that</font><font color="#CCCCCC"> the device is providing</font>

456
00:27:01,700 --> 00:27:16,109
<font color="#E5E5E5">never mind let's go on I'll show</font><font color="#CCCCCC"> you</font>

457
00:27:04,229 --> 00:27:18,659
<font color="#CCCCCC">better</font><font color="#E5E5E5"> stuff okay let's go on so anyway</font>

458
00:27:16,109 --> 00:27:24,178
I can connect to<font color="#E5E5E5"> most of the devices and</font>

459
00:27:18,659 --> 00:27:27,149
then start studying over Google<font color="#E5E5E5"> or over</font>

460
00:27:24,179 --> 00:27:30,539
<font color="#E5E5E5">Bluetooth</font><font color="#CCCCCC"> the problem is</font><font color="#E5E5E5"> that most</font>

461
00:27:27,149 --> 00:27:32,699
devices do not<font color="#E5E5E5"> apply any authentication</font>

462
00:27:30,539 --> 00:27:35,789
to their services so<font color="#CCCCCC"> you can just</font>

463
00:27:32,700 --> 00:27:40,710
register it<font color="#E5E5E5"> or write to any device</font><font color="#CCCCCC"> that</font>

464
00:27:35,789 --> 00:27:43,320
<font color="#CCCCCC">you can find and scan okay so let's talk</font>

465
00:27:40,710 --> 00:27:45,929
about<font color="#E5E5E5"> men in the middle so this is how a</font>

466
00:27:43,320 --> 00:27:47,639
normal<font color="#E5E5E5"> man in the middle will work right</font>

467
00:27:45,929 --> 00:27:51,239
<font color="#CCCCCC">we have the mobile</font><font color="#E5E5E5"> app and the</font><font color="#CCCCCC"> Bluetooth</font>

468
00:27:47,639 --> 00:27:55,589
device<font color="#CCCCCC"> and then we come in the middle</font>

469
00:27:51,239 --> 00:27:58,549
<font color="#E5E5E5">this</font><font color="#CCCCCC"> is in the</font><font color="#E5E5E5"> middle so this is not</font>

470
00:27:55,589 --> 00:28:02,460
going<font color="#CCCCCC"> to work on Bluetooth because</font>

471
00:27:58,549 --> 00:28:07,259
<font color="#CCCCCC">Bluetooth can only do one</font><font color="#E5E5E5"> Bluetooth</font>

472
00:28:02,460 --> 00:28:09,749
<font color="#CCCCCC">thingy so if it advertises itself it</font>

473
00:28:07,259 --> 00:28:10,919
cannot commune<font color="#E5E5E5"> connect to a device and</font>

474
00:28:09,749 --> 00:28:16,950
<font color="#CCCCCC">vice-versa</font>

475
00:28:10,919 --> 00:28:19,759
<font color="#E5E5E5">so I have a ble adapter or an app and I</font>

476
00:28:16,950 --> 00:28:22,289
want to connect to the Bluetooth device

477
00:28:19,759 --> 00:28:24,719
<font color="#CCCCCC">but then I</font><font color="#E5E5E5"> will not be able also to</font>

478
00:28:22,289 --> 00:28:29,399
connect to the mobile<font color="#E5E5E5"> app</font><font color="#CCCCCC"> because I can</font>

479
00:28:24,719 --> 00:28:32,609
do only<font color="#E5E5E5"> one</font><font color="#CCCCCC"> thing so for</font><font color="#E5E5E5"> that I have</font><font color="#CCCCCC"> to</font>

480
00:28:29,399 --> 00:28:35,399
have a different<font color="#CCCCCC"> architecture</font><font color="#E5E5E5"> for men in</font>

481
00:28:32,609 --> 00:28:36,749
the<font color="#E5E5E5"> middle so this is something like how</font>

482
00:28:35,399 --> 00:28:40,738
it's going to<font color="#CCCCCC"> work</font>

483
00:28:36,749 --> 00:28:42,899
<font color="#CCCCCC">I have to</font><font color="#E5E5E5"> bill the adapters they are</font>

484
00:28:40,739 --> 00:28:45,479
here<font color="#E5E5E5"> you can't see them I</font><font color="#CCCCCC"> don't</font><font color="#E5E5E5"> want to</font>

485
00:28:42,899 --> 00:28:46,049
disconnect them<font color="#E5E5E5"> I'll show you in a</font>

486
00:28:45,479 --> 00:28:48,539
second

487
00:28:46,049 --> 00:28:49,979
one will connect to the mobile app<font color="#E5E5E5"> the</font>

488
00:28:48,539 --> 00:28:52,500
other<font color="#E5E5E5"> one will connect to the Bluetooth</font>

489
00:28:49,979 --> 00:28:56,730
<font color="#CCCCCC">device and then the</font>

490
00:28:52,500 --> 00:28:59,340
have to communicate<font color="#E5E5E5"> with</font><font color="#CCCCCC"> each other I</font>

491
00:28:56,730 --> 00:29:04,320
will<font color="#CCCCCC"> use a different</font><font color="#E5E5E5"> protocol because</font>

492
00:28:59,340 --> 00:29:07,620
<font color="#E5E5E5">the Bluetooth possibilities</font><font color="#CCCCCC"> are over for</font>

493
00:29:04,320 --> 00:29:10,700
me so I'm going<font color="#CCCCCC"> to show you tools or how</font>

494
00:29:07,620 --> 00:29:13,439
you can do it<font color="#E5E5E5"> over WebSocket so the</font>

495
00:29:10,700 --> 00:29:15,210
components are<font color="#CCCCCC"> community connected</font><font color="#E5E5E5"> to</font>

496
00:29:13,440 --> 00:29:18,060
the ble devices and they communicate

497
00:29:15,210 --> 00:29:20,370
<font color="#E5E5E5">with each other over WebSocket this is</font>

498
00:29:18,060 --> 00:29:23,100
how we create<font color="#E5E5E5"> them and in the middle so</font>

499
00:29:20,370 --> 00:29:24,090
how do we<font color="#E5E5E5"> start this doing this so we</font>

500
00:29:23,100 --> 00:29:28,699
<font color="#CCCCCC">bye</font>

501
00:29:24,090 --> 00:29:34,649
I love Aliexpress yes<font color="#CCCCCC"> we buy two dongles</font>

502
00:29:28,700 --> 00:29:39,000
<font color="#CCCCCC">CSR 4.0 these are Bluetooth ble</font><font color="#E5E5E5"> adapters</font>

503
00:29:34,650 --> 00:29:41,940
and one will work as<font color="#CCCCCC"> the master and one</font>

504
00:29:39,000 --> 00:29:47,400
work as a slave<font color="#CCCCCC"> you can buy them at two</font>

505
00:29:41,940 --> 00:29:50,790
<font color="#CCCCCC">seventy</font><font color="#E5E5E5"> dollars including shipping so</font>

506
00:29:47,400 --> 00:29:53,940
that's not<font color="#E5E5E5"> a problem</font><font color="#CCCCCC"> and then what I'll</font>

507
00:29:50,790 --> 00:29:56,399
do<font color="#CCCCCC"> is I'll download Kali Linux VM</font><font color="#E5E5E5"> or any</font>

508
00:29:53,940 --> 00:29:59,730
other VM<font color="#CCCCCC"> that you like and I</font><font color="#E5E5E5"> will</font>

509
00:29:56,400 --> 00:30:02,580
<font color="#E5E5E5">connect one</font><font color="#CCCCCC"> to this virtual machine and</font>

510
00:29:59,730 --> 00:30:05,430
<font color="#E5E5E5">the other to the</font><font color="#CCCCCC"> other virtual machine</font>

511
00:30:02,580 --> 00:30:07,649
<font color="#E5E5E5">now I have two</font><font color="#CCCCCC"> machines everyone has its</font>

512
00:30:05,430 --> 00:30:09,540
own don't go and<font color="#E5E5E5"> that will be used one</font>

513
00:30:07,650 --> 00:30:13,920
to connect<font color="#CCCCCC"> to the mobile app</font><font color="#E5E5E5"> and one</font>

514
00:30:09,540 --> 00:30:16,830
will connect to the smart device<font color="#CCCCCC"> so</font>

515
00:30:13,920 --> 00:30:19,500
after I did<font color="#CCCCCC"> that</font><font color="#E5E5E5"> there are some basic</font>

516
00:30:16,830 --> 00:30:22,860
commands<font color="#E5E5E5"> that you need to know how to</font>

517
00:30:19,500 --> 00:30:27,930
work on the<font color="#E5E5E5"> machine to see that you are</font>

518
00:30:22,860 --> 00:30:32,879
<font color="#E5E5E5">connected so</font><font color="#CCCCCC"> HDI config is to see the</font>

519
00:30:27,930 --> 00:30:35,340
interfaces of the<font color="#E5E5E5"> ble so you see the</font>

520
00:30:32,880 --> 00:30:39,270
<font color="#CCCCCC">address they have the MAC address and if</font>

521
00:30:35,340 --> 00:30:43,139
they are<font color="#CCCCCC"> running or not</font><font color="#E5E5E5"> you can you can</font>

522
00:30:39,270 --> 00:30:47,580
use<font color="#CCCCCC"> ATI config it's the interface</font><font color="#E5E5E5"> and</font>

523
00:30:43,140 --> 00:30:50,280
then up down to start and close it<font color="#E5E5E5"> HCI</font>

524
00:30:47,580 --> 00:30:55,100
tool is another tool that<font color="#E5E5E5"> lets you scan</font>

525
00:30:50,280 --> 00:30:58,260
for ble devices so you<font color="#E5E5E5"> just type it's a</font>

526
00:30:55,100 --> 00:31:00,879
tool le scan and<font color="#E5E5E5"> you start seeing</font>

527
00:30:58,260 --> 00:31:04,550
devices

528
00:31:00,880 --> 00:31:06,860
we've got we have<font color="#CCCCCC"> got to another</font><font color="#E5E5E5"> tool</font>

529
00:31:04,550 --> 00:31:11,990
<font color="#E5E5E5">command lines they are coming</font><font color="#CCCCCC"> with this</font>

530
00:31:06,860 --> 00:31:15,889
libraries<font color="#E5E5E5"> that you need to install got</font>

531
00:31:11,990 --> 00:31:18,290
tool<font color="#CCCCCC"> you can read characteristics from</font><font color="#E5E5E5"> a</font>

532
00:31:15,890 --> 00:31:20,270
device after<font color="#E5E5E5"> you connect to it so got</font><font color="#CCCCCC"> to</font>

533
00:31:18,290 --> 00:31:23,570
<font color="#CCCCCC">and the MAC address</font><font color="#E5E5E5"> of the device to</font>

534
00:31:20,270 --> 00:31:26,480
communicate connect to it<font color="#E5E5E5"> and then you</font>

535
00:31:23,570 --> 00:31:30,110
can read and<font color="#E5E5E5"> write to it from the</font>

536
00:31:26,480 --> 00:31:34,010
command<font color="#CCCCCC"> line</font><font color="#E5E5E5"> and we have some cool tools</font>

537
00:31:30,110 --> 00:31:37,490
that already implemented everything<font color="#E5E5E5"> so</font>

538
00:31:34,010 --> 00:31:43,309
we don't need<font color="#E5E5E5"> to</font><font color="#CCCCCC"> do it ourselves</font>

539
00:31:37,490 --> 00:31:46,429
<font color="#E5E5E5">so the first great tool is get occur and</font>

540
00:31:43,309 --> 00:31:48,830
these<font color="#E5E5E5"> tools lets you or gives you the</font>

541
00:31:46,429 --> 00:31:54,110
ability<font color="#CCCCCC"> to</font><font color="#E5E5E5"> use the architecture</font><font color="#CCCCCC"> that I</font>

542
00:31:48,830 --> 00:31:59,540
discussed earlier<font color="#CCCCCC"> when</font><font color="#E5E5E5"> you communicate</font>

543
00:31:54,110 --> 00:32:04,280
over WebSocket<font color="#E5E5E5"> so now I'm going to show</font>

544
00:31:59,540 --> 00:32:07,550
<font color="#E5E5E5">you how I'm going</font><font color="#CCCCCC"> to our musing it this</font>

545
00:32:04,280 --> 00:32:09,290
tool in order<font color="#E5E5E5"> to see or do</font>

546
00:32:07,550 --> 00:32:14,178
<font color="#CCCCCC">man-in-the-middle between the mobile</font>

547
00:32:09,290 --> 00:32:19,010
device and<font color="#E5E5E5"> the smart device smart</font><font color="#CCCCCC"> ble</font>

548
00:32:14,179 --> 00:32:23,540
device and as part of that<font color="#E5E5E5"> I'm going to</font>

549
00:32:19,010 --> 00:32:25,940
<font color="#E5E5E5">show you how you can use tools like</font>

550
00:32:23,540 --> 00:32:29,809
proper<font color="#E5E5E5"> burp don't know if you're</font>

551
00:32:25,940 --> 00:32:32,570
<font color="#E5E5E5">familiar with burp is a my best friend</font>

552
00:32:29,809 --> 00:32:35,210
<font color="#CCCCCC">as an application security</font><font color="#E5E5E5"> expert</font><font color="#CCCCCC"> it</font>

553
00:32:32,570 --> 00:32:39,800
helps you it's a proxy tool that lets

554
00:32:35,210 --> 00:32:44,140
you see<font color="#CCCCCC"> intercept the the communication</font>

555
00:32:39,800 --> 00:32:50,440
over HTTP and HTTPS and<font color="#CCCCCC"> WebSockets</font>

556
00:32:44,140 --> 00:32:50,440
so let's see how<font color="#CCCCCC"> that looks</font>

557
00:32:55,830 --> 00:33:07,899
<font color="#CCCCCC">okay so</font><font color="#E5E5E5"> I showed you</font><font color="#CCCCCC"> I connect one</font>

558
00:33:01,200 --> 00:33:09,610
device<font color="#CCCCCC"> one VM to the ble adapter</font><font color="#E5E5E5"> the</font>

559
00:33:07,900 --> 00:33:15,549
other way<font color="#E5E5E5"> around</font><font color="#CCCCCC"> i connect one adapter</font>

560
00:33:09,610 --> 00:33:17,760
to the<font color="#E5E5E5"> virtual machine</font><font color="#CCCCCC"> just checking</font>

561
00:33:15,549 --> 00:33:22,139
that it works<font color="#CCCCCC"> yeah you can see</font><font color="#E5E5E5"> I can</font>

562
00:33:17,760 --> 00:33:25,330
scan for devices and then on the<font color="#CCCCCC"> other</font>

563
00:33:22,140 --> 00:33:28,990
I'm<font color="#CCCCCC"> going</font><font color="#E5E5E5"> to connect the</font><font color="#CCCCCC"> other adapter</font>

564
00:33:25,330 --> 00:33:32,590
then<font color="#E5E5E5"> I need to if I have more than one</font>

565
00:33:28,990 --> 00:33:35,500
interface<font color="#E5E5E5"> for Billy then I need to</font>

566
00:33:32,590 --> 00:33:38,918
specify which of the interfaces<font color="#E5E5E5"> I'm</font>

567
00:33:35,500 --> 00:33:41,650
going to use sorry<font color="#E5E5E5"> one second so here</font>

568
00:33:38,919 --> 00:33:44,049
I'm going<font color="#E5E5E5"> to tell him</font><font color="#CCCCCC"> where is the slave</font>

569
00:33:41,650 --> 00:33:45,789
what is the<font color="#E5E5E5"> IP of the slave machine so</font>

570
00:33:44,049 --> 00:33:55,418
then they will know how to communicate

571
00:33:45,789 --> 00:33:59,250
<font color="#E5E5E5">with each</font><font color="#CCCCCC"> other</font><font color="#E5E5E5"> of a WebSocket then I'm</font>

572
00:33:55,419 --> 00:34:03,270
just<font color="#E5E5E5"> going to start the slave on one VM</font>

573
00:33:59,250 --> 00:34:05,740
and start scanning on the other the

574
00:34:03,270 --> 00:34:08,259
virtual machine here<font color="#E5E5E5"> you can see on the</font>

575
00:34:05,740 --> 00:34:11,469
bottom<font color="#E5E5E5"> of virtual machine you can see</font>

576
00:34:08,260 --> 00:34:13,450
all the services<font color="#E5E5E5"> where they got profiles</font>

577
00:34:11,469 --> 00:34:17,739
that it collected you can<font color="#CCCCCC"> see some</font>

578
00:34:13,449 --> 00:34:24,730
devices<font color="#E5E5E5"> power watch</font><font color="#CCCCCC"> +</font><font color="#E5E5E5"> lock ass and here</font>

579
00:34:17,739 --> 00:34:28,239
some other<font color="#E5E5E5"> device</font><font color="#CCCCCC"> ami I YJ the the</font>

580
00:34:24,730 --> 00:34:30,668
master device stores all these

581
00:34:28,239 --> 00:34:33,939
<font color="#CCCCCC">characteristics and got profiles on the</font>

582
00:34:30,668 --> 00:34:36,219
<font color="#CCCCCC">on the disk so I can use them</font><font color="#E5E5E5"> so now</font>

583
00:34:33,940 --> 00:34:39,909
this is<font color="#CCCCCC"> how I'm going to use</font><font color="#E5E5E5"> to do the</font>

584
00:34:36,219 --> 00:34:42,790
<font color="#CCCCCC">man in the middle</font><font color="#E5E5E5"> I'm</font><font color="#CCCCCC"> going to do this</font>

585
00:34:39,909 --> 00:34:46,359
is the file<font color="#CCCCCC"> that the scan stored</font><font color="#E5E5E5"> so I'm</font>

586
00:34:42,790 --> 00:34:49,960
going to<font color="#E5E5E5"> advertise myself</font><font color="#CCCCCC"> I'm going to</font>

587
00:34:46,359 --> 00:34:51,879
connect to<font color="#E5E5E5"> the mobile device and then</font>

588
00:34:49,960 --> 00:34:57,070
<font color="#E5E5E5">because I know all its characteristics</font>

589
00:34:51,879 --> 00:35:00,910
and profiles<font color="#CCCCCC"> I will pretend to</font><font color="#E5E5E5"> be it so</font>

590
00:34:57,070 --> 00:35:03,880
I will<font color="#CCCCCC"> just advertise them myself</font>

591
00:35:00,910 --> 00:35:07,180
<font color="#E5E5E5">I already connected to</font><font color="#CCCCCC"> the device so it</font>

592
00:35:03,880 --> 00:35:09,440
cannot advertise<font color="#CCCCCC"> anymore because it</font>

593
00:35:07,180 --> 00:35:13,669
already<font color="#E5E5E5"> paired so if you</font>

594
00:35:09,440 --> 00:35:15,319
example pair<font color="#E5E5E5"> a device to</font><font color="#CCCCCC"> your app</font><font color="#E5E5E5"> then</font>

595
00:35:13,670 --> 00:35:18,290
you<font color="#E5E5E5"> scan again from a different device</font>

596
00:35:15,319 --> 00:35:20,300
you will not be able<font color="#CCCCCC"> to see that if the</font>

597
00:35:18,290 --> 00:35:23,710
the smart device because it is<font color="#CCCCCC"> already</font>

598
00:35:20,300 --> 00:35:30,200
paired<font color="#E5E5E5"> so it does not advertise anymore</font>

599
00:35:23,710 --> 00:35:34,010
so I'm just going<font color="#CCCCCC"> to advertise</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> and</font>

600
00:35:30,200 --> 00:35:38,390
wait<font color="#CCCCCC"> for the other D up to come to</font>

601
00:35:34,010 --> 00:35:40,579
connect to it<font color="#E5E5E5"> so of course if I'm using</font>

602
00:35:38,390 --> 00:35:42,740
<font color="#E5E5E5">a different MAC address and the user</font>

603
00:35:40,579 --> 00:35:46,099
already

604
00:35:42,740 --> 00:35:49,220
paired once before to the device<font color="#E5E5E5"> then it</font>

605
00:35:46,099 --> 00:35:51,440
will see a different device if it if he

606
00:35:49,220 --> 00:35:53,799
will he or<font color="#CCCCCC"> she will notice because</font><font color="#E5E5E5"> it</font>

607
00:35:51,440 --> 00:35:56,480
<font color="#E5E5E5">depends on</font><font color="#CCCCCC"> the app how it presents it</font>

608
00:35:53,800 --> 00:36:00,560
<font color="#CCCCCC">but of</font><font color="#E5E5E5"> course there is a possibility</font><font color="#CCCCCC"> to</font>

609
00:35:56,480 --> 00:36:04,390
<font color="#E5E5E5">max proof your to spoof</font><font color="#CCCCCC"> your MAC address</font>

610
00:36:00,560 --> 00:36:07,730
<font color="#E5E5E5">so they will automatically communicate</font>

611
00:36:04,390 --> 00:36:10,879
<font color="#E5E5E5">so this is the device</font><font color="#CCCCCC"> sorry one second</font>

612
00:36:07,730 --> 00:36:12,680
slower this is the device<font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> going to</font>

613
00:36:10,880 --> 00:36:14,599
start the<font color="#E5E5E5"> power sensor up this is a</font>

614
00:36:12,680 --> 00:36:19,160
designated<font color="#E5E5E5"> up to communicate with this</font>

615
00:36:14,599 --> 00:36:22,400
sport bracelet<font color="#CCCCCC"> and then</font><font color="#E5E5E5"> I will scan for</font>

616
00:36:19,160 --> 00:36:24,828
device<font color="#E5E5E5"> now I see the power watch but</font>

617
00:36:22,400 --> 00:36:27,920
this power watch is not the actual power

618
00:36:24,829 --> 00:36:32,060
watch<font color="#CCCCCC"> it's it's the one that I copied</font>

619
00:36:27,920 --> 00:36:34,520
<font color="#E5E5E5">cloned and then advertised myself so it</font>

620
00:36:32,060 --> 00:36:38,180
in a second you<font color="#E5E5E5"> will be able to see here</font>

621
00:36:34,520 --> 00:36:41,839
on<font color="#E5E5E5"> the upper VM all the traffic that</font>

622
00:36:38,180 --> 00:36:45,680
<font color="#CCCCCC">goes between the</font><font color="#E5E5E5"> mobile the smart device</font>

623
00:36:41,839 --> 00:36:49,310
to the mobile app and here you<font color="#E5E5E5"> will</font><font color="#CCCCCC"> see</font>

624
00:36:45,680 --> 00:36:52,910
<font color="#CCCCCC">it</font><font color="#E5E5E5"> as hex values so this app has a</font>

625
00:36:49,310 --> 00:36:54,430
feature of sport activities so I can

626
00:36:52,910 --> 00:36:58,609
count

627
00:36:54,430 --> 00:37:01,669
jumping<font color="#E5E5E5"> ropes</font><font color="#CCCCCC"> up</font><font color="#E5E5E5"> so I will not jump now</font>

628
00:36:58,609 --> 00:37:04,730
but when I recorded it<font color="#CCCCCC"> I had to flip</font>

629
00:37:01,670 --> 00:37:08,869
<font color="#CCCCCC">listening in the air</font><font color="#E5E5E5"> so I'm just going</font>

630
00:37:04,730 --> 00:37:13,220
to<font color="#E5E5E5"> count it and you can see that in some</font>

631
00:37:08,869 --> 00:37:16,339
<font color="#CCCCCC">hacks version</font><font color="#E5E5E5"> I I can see that the data</font>

632
00:37:13,220 --> 00:37:18,230
coming from the device to<font color="#CCCCCC"> the mobile app</font>

633
00:37:16,339 --> 00:37:23,308
so this<font color="#CCCCCC"> is just passive right I can only</font>

634
00:37:18,230 --> 00:37:27,630
see this but there<font color="#E5E5E5"> are two other you can</font>

635
00:37:23,309 --> 00:37:31,829
<font color="#CCCCCC">also here</font><font color="#E5E5E5"> the watch small there</font><font color="#CCCCCC"> are</font>

636
00:37:27,630 --> 00:37:35,400
other ways to to do the active<font color="#CCCCCC"> men in</font>

637
00:37:31,829 --> 00:37:38,759
the middle<font color="#E5E5E5"> one is by hooking to a</font>

638
00:37:35,400 --> 00:37:46,130
service or using a<font color="#E5E5E5"> real-time</font>

639
00:37:38,759 --> 00:37:51,529
modification so now I pre hooked<font color="#CCCCCC"> a</font>

640
00:37:46,130 --> 00:37:54,749
service so what it will do it<font color="#CCCCCC"> will just</font>

641
00:37:51,529 --> 00:37:57,109
raise up<font color="#E5E5E5"> the increase the numbers so I</font>

642
00:37:54,749 --> 00:38:03,899
can<font color="#CCCCCC"> you can see here that I did</font>

643
00:37:57,109 --> 00:38:09,019
<font color="#E5E5E5">treadmill hook all it does is locating</font>

644
00:38:03,900 --> 00:38:11,969
this<font color="#E5E5E5"> sorry one second</font>

645
00:38:09,019 --> 00:38:14,609
locating this<font color="#E5E5E5"> notification event</font>

646
00:38:11,969 --> 00:38:18,390
<font color="#E5E5E5">according</font><font color="#CCCCCC"> to its characteristics I know</font>

647
00:38:14,609 --> 00:38:20,459
it starts<font color="#CCCCCC"> with</font><font color="#E5E5E5"> nine seven something</font>

648
00:38:18,390 --> 00:38:23,908
something<font color="#E5E5E5"> and then I will replace this</font>

649
00:38:20,459 --> 00:38:28,469
string with<font color="#E5E5E5"> this hax</font><font color="#CCCCCC"> hacks a string and</font>

650
00:38:23,909 --> 00:38:34,369
what will<font color="#E5E5E5"> happen is that the next time I</font>

651
00:38:28,469 --> 00:38:34,369
can<font color="#E5E5E5"> really show off of my hard work</font>

652
00:38:34,579 --> 00:38:43,369
so I'm going<font color="#CCCCCC"> to do the same with this</font>

653
00:38:40,619 --> 00:38:43,369
with the hook

654
00:38:47,090 --> 00:38:54,160
<font color="#E5E5E5">okay so I'm adding the</font><font color="#CCCCCC"> smart device the</font>

655
00:38:50,510 --> 00:39:01,730
ble device<font color="#E5E5E5"> now I'm going to do the</font>

656
00:38:54,160 --> 00:39:05,089
treadmill<font color="#CCCCCC"> and then when I'll start</font><font color="#E5E5E5"> you</font>

657
00:39:01,730 --> 00:39:08,350
can see<font color="#CCCCCC"> there hook that</font><font color="#E5E5E5"> I just did so</font>

658
00:39:05,090 --> 00:39:12,830
I'm now going to do a lot of sport<font color="#E5E5E5"> and I</font>

659
00:39:08,350 --> 00:39:18,680
can really show off<font color="#E5E5E5"> of my art yeah thank</font>

660
00:39:12,830 --> 00:39:21,350
you<font color="#CCCCCC"> running</font><font color="#E5E5E5"> not so tiring though</font><font color="#CCCCCC"> so you</font>

661
00:39:18,680 --> 00:39:23,419
can see it keeps on counting I can do of

662
00:39:21,350 --> 00:39:26,180
course<font color="#E5E5E5"> whatever</font><font color="#CCCCCC"> now I can I'm showing</font>

663
00:39:23,420 --> 00:39:31,040
<font color="#CCCCCC">you how you</font><font color="#E5E5E5"> you can manipulate numbers</font>

664
00:39:26,180 --> 00:39:35,149
but of course it could<font color="#CCCCCC"> be other severe</font>

665
00:39:31,040 --> 00:39:39,110
things<font color="#CCCCCC"> okay so now I'm adding burp burp</font>

666
00:39:35,150 --> 00:39:41,360
as I mentioned is a proxy<font color="#CCCCCC"> - great tool</font>

667
00:39:39,110 --> 00:39:44,420
that<font color="#E5E5E5"> helps you</font><font color="#CCCCCC"> man in the middle</font>

668
00:39:41,360 --> 00:39:48,790
<font color="#CCCCCC">WebSockets and HTTP so this is WebSocket</font>

669
00:39:44,420 --> 00:39:52,340
<font color="#E5E5E5">so I'm going to use the same</font><font color="#CCCCCC"> I'll just</font>

670
00:39:48,790 --> 00:39:57,290
let tell burp to<font color="#E5E5E5"> listen to the right</font>

671
00:39:52,340 --> 00:39:59,920
port and interface and then I'm going to

672
00:39:57,290 --> 00:39:59,920
<font color="#E5E5E5">do the same</font>

673
00:40:05,089 --> 00:40:12,169
and then you can see<font color="#CCCCCC"> all the</font><font color="#E5E5E5"> traffic</font>

674
00:40:07,249 --> 00:40:17,629
already in<font color="#E5E5E5"> burb burb has the ability</font><font color="#CCCCCC"> to</font>

675
00:40:12,169 --> 00:40:23,029
do on-the-fly manipulation so this time

676
00:40:17,630 --> 00:40:25,400
I'm going to do sit-ups<font color="#CCCCCC"> and then you can</font>

677
00:40:23,029 --> 00:40:27,890
see all the data transfers through burp

678
00:40:25,400 --> 00:40:31,099
I don't have to do<font color="#E5E5E5"> anything myself</font><font color="#CCCCCC"> I can</font>

679
00:40:27,890 --> 00:40:33,549
intercept<font color="#CCCCCC"> let me run it further I can</font>

680
00:40:31,099 --> 00:40:37,339
intercept the request<font color="#E5E5E5"> just modify it and</font>

681
00:40:33,549 --> 00:40:41,150
then hit the forward<font color="#CCCCCC"> and then I will do</font>

682
00:40:37,339 --> 00:40:45,380
a lot<font color="#CCCCCC"> of push-ups</font><font color="#E5E5E5"> you can't see my my</font>

683
00:40:41,150 --> 00:40:48,979
squares here but<font color="#E5E5E5"> because it's on the</font><font color="#CCCCCC"> fly</font>

684
00:40:45,380 --> 00:40:54,769
<font color="#CCCCCC">then</font><font color="#E5E5E5"> the next request will will tell it</font>

685
00:40:48,979 --> 00:40:57,019
on<font color="#CCCCCC"> 11 not on 3</font><font color="#E5E5E5"> million</font><font color="#CCCCCC"> ok so this</font><font color="#E5E5E5"> is why</font>

686
00:40:54,769 --> 00:41:02,529
we do the hooks<font color="#E5E5E5"> so it will permanently</font>

687
00:40:57,019 --> 00:41:02,529
work okay so this is thanks to<font color="#CCCCCC"> get occur</font>

688
00:41:03,339 --> 00:41:09,349
<font color="#CCCCCC">okay</font>

689
00:41:04,849 --> 00:41:11,719
the other tool is<font color="#CCCCCC"> beetlejuice another</font>

690
00:41:09,349 --> 00:41:15,380
<font color="#CCCCCC">man-in-the-middle framework</font><font color="#E5E5E5"> also has a</font>

691
00:41:11,719 --> 00:41:18,769
web interface<font color="#E5E5E5"> really cool</font><font color="#CCCCCC"> tool gives you</font>

692
00:41:15,380 --> 00:41:21,079
also<font color="#E5E5E5"> the ability to reply</font><font color="#CCCCCC"> we through the</font>

693
00:41:18,769 --> 00:41:23,569
<font color="#E5E5E5">interface so the attacker tool now has</font>

694
00:41:21,079 --> 00:41:26,779
<font color="#CCCCCC">also the</font><font color="#E5E5E5"> ability to reply but you need</font>

695
00:41:23,569 --> 00:41:29,630
to dump<font color="#E5E5E5"> a request and then</font><font color="#CCCCCC"> replayed</font><font color="#E5E5E5"> here</font>

696
00:41:26,779 --> 00:41:38,539
you have the reply feature on the web

697
00:41:29,630 --> 00:41:48,289
interface<font color="#E5E5E5"> so I'll try to do a live demo</font>

698
00:41:38,539 --> 00:41:51,579
<font color="#CCCCCC">it's going to be nicer okay</font><font color="#E5E5E5"> okay so can</font>

699
00:41:48,289 --> 00:41:51,579
<font color="#E5E5E5">you see my screen</font><font color="#CCCCCC"> great</font>

700
00:41:56,730 --> 00:42:04,859
<font color="#CCCCCC">the bezel just proxy on one ready the</font>

701
00:42:01,950 --> 00:42:08,129
<font color="#E5E5E5">Beetlejuice master on the other you can</font>

702
00:42:04,859 --> 00:42:14,700
see that they are<font color="#CCCCCC"> connected</font><font color="#E5E5E5"> I'll put the</font>

703
00:42:08,130 --> 00:42:17,280
<font color="#CCCCCC">mobile up here</font><font color="#E5E5E5"> okay so now I can browse</font>

704
00:42:14,700 --> 00:42:19,470
to<font color="#CCCCCC"> the Beetlejuice interface</font><font color="#E5E5E5"> or a let's</font>

705
00:42:17,280 --> 00:42:23,099
just<font color="#CCCCCC"> do it</font><font color="#E5E5E5"> like this here I can select</font>

706
00:42:19,470 --> 00:42:26,399
the target<font color="#CCCCCC"> device</font><font color="#E5E5E5"> so I'm going to</font>

707
00:42:23,099 --> 00:42:29,970
connect to<font color="#CCCCCC"> my power watch</font><font color="#E5E5E5"> now</font><font color="#CCCCCC"> what</font>

708
00:42:26,400 --> 00:42:33,530
happens is that it<font color="#E5E5E5"> tries to read all the</font>

709
00:42:29,970 --> 00:42:33,529
services<font color="#CCCCCC"> and characteristics</font>

710
00:42:35,150 --> 00:42:40,169
[Music]

711
00:42:42,650 --> 00:42:45,400
come on

712
00:42:46,150 --> 00:42:56,200
<font color="#E5E5E5">okay connected</font><font color="#CCCCCC"> so now I'm going</font><font color="#E5E5E5"> to use</font>

713
00:42:52,779 --> 00:43:03,190
the same up that I showed you<font color="#CCCCCC"> before</font><font color="#E5E5E5"> the</font>

714
00:42:56,200 --> 00:43:04,749
powers and soar and device<font color="#E5E5E5"> great so I</font>

715
00:43:03,190 --> 00:43:09,519
think<font color="#E5E5E5"> they're already connected</font><font color="#CCCCCC"> because</font>

716
00:43:04,749 --> 00:43:12,930
the same<font color="#E5E5E5"> MAC address yep</font><font color="#CCCCCC"> okay so now the</font>

717
00:43:09,519 --> 00:43:18,848
cool feature is you cannot<font color="#CCCCCC"> see that</font><font color="#E5E5E5"> but</font>

718
00:43:12,930 --> 00:43:23,160
from<font color="#E5E5E5"> this wristband</font><font color="#CCCCCC"> bracelet I can you</font>

719
00:43:18,849 --> 00:43:32,319
can look here in a second

720
00:43:23,160 --> 00:43:33,930
yeah<font color="#CCCCCC"> I can take</font><font color="#E5E5E5"> pictures</font><font color="#CCCCCC"> okay so let's</font>

721
00:43:32,319 --> 00:43:39,960
see if it works

722
00:43:33,930 --> 00:43:39,960
yeah hi so one second

723
00:43:43,340 --> 00:43:51,610
there you go so it great<font color="#E5E5E5"> so I took a</font>

724
00:43:47,420 --> 00:43:54,470
picture<font color="#CCCCCC"> now I have the</font><font color="#E5E5E5"> request on this I</font>

725
00:43:51,610 --> 00:44:00,590
think it's this one<font color="#E5E5E5"> so I'm going just</font>

726
00:43:54,470 --> 00:44:00,919
going to reply it<font color="#E5E5E5"> one second</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> all</font>

727
00:44:00,590 --> 00:44:06,080
<font color="#CCCCCC">right</font>

728
00:44:00,920 --> 00:44:10,010
oh that's let's do this

729
00:44:06,080 --> 00:44:12,049
so you can see them together<font color="#E5E5E5"> so here you</font>

730
00:44:10,010 --> 00:44:18,260
<font color="#E5E5E5">can see I can take pictures</font><font color="#CCCCCC"> from my</font>

731
00:44:12,050 --> 00:44:23,530
computer<font color="#E5E5E5"> now yeah</font><font color="#CCCCCC"> let's take</font><font color="#E5E5E5"> one picture</font>

732
00:44:18,260 --> 00:44:29,510
<font color="#E5E5E5">of you no no yeah you want some yeah</font>

733
00:44:23,530 --> 00:44:31,390
<font color="#E5E5E5">okay so it's going to be tough and three</font>

734
00:44:29,510 --> 00:44:37,460
two one

735
00:44:31,390 --> 00:44:40,580
great sorry guys yeah this is not<font color="#E5E5E5"> okay</font>

736
00:44:37,460 --> 00:44:50,060
so one cool thing<font color="#E5E5E5"> and the</font><font color="#CCCCCC"> other one is</font>

737
00:44:40,580 --> 00:44:55,549
even<font color="#CCCCCC"> nicer because what you can't see</font>

738
00:44:50,060 --> 00:45:00,799
but I'm closing the app so it's closed

739
00:44:55,550 --> 00:45:03,220
<font color="#CCCCCC">right but now I can also</font><font color="#E5E5E5"> and let's hope</font>

740
00:45:00,800 --> 00:45:03,220
it<font color="#E5E5E5"> works</font>

741
00:45:14,119 --> 00:45:19,790
<font color="#E5E5E5">okay great so it's</font><font color="#CCCCCC"> on mute</font>

742
00:45:20,000 --> 00:45:31,850
okay<font color="#E5E5E5"> and</font><font color="#CCCCCC"> you're here so I can also</font>

743
00:45:28,369 --> 00:45:31,850
switch<font color="#E5E5E5"> songs</font>

744
00:45:40,120 --> 00:45:50,750
yeah it is connected one second so as I

745
00:45:47,780 --> 00:45:56,630
<font color="#CCCCCC">told you</font><font color="#E5E5E5"> the only</font><font color="#CCCCCC"> thing problem is</font><font color="#E5E5E5"> Billy</font>

746
00:45:50,750 --> 00:46:00,250
<font color="#E5E5E5">that it gets disconnected</font><font color="#CCCCCC"> okay again I'm</font>

747
00:45:56,630 --> 00:46:00,250
connected<font color="#E5E5E5"> let's try again</font>

748
00:46:04,650 --> 00:46:14,940
<font color="#E5E5E5">okay yeah so</font><font color="#CCCCCC"> we got some other</font><font color="#E5E5E5"> songs and</font>

749
00:46:10,500 --> 00:46:20,730
then our victim goes to sleep or<font color="#E5E5E5"> to a</font>

750
00:46:14,940 --> 00:46:24,540
meeting and but we<font color="#E5E5E5"> just got this</font><font color="#CCCCCC"> let's</font>

751
00:46:20,730 --> 00:46:28,650
even<font color="#E5E5E5"> do this yeah</font>

752
00:46:24,540 --> 00:46:32,040
so I'm going<font color="#CCCCCC"> to a meeting my phone is</font>

753
00:46:28,650 --> 00:46:34,230
locked or something<font color="#E5E5E5"> and then someone who</font>

754
00:46:32,040 --> 00:46:38,270
sits nearby<font color="#E5E5E5"> because</font><font color="#CCCCCC"> you have to have</font><font color="#E5E5E5"> the</font>

755
00:46:34,230 --> 00:46:41,850
proximity<font color="#CCCCCC"> just recorded the request and</font>

756
00:46:38,270 --> 00:46:55,020
then<font color="#E5E5E5"> starts it in the middle of the of</font>

757
00:46:41,850 --> 00:46:56,110
the meeting<font color="#E5E5E5"> so it's really cool thank</font>

758
00:46:55,020 --> 00:46:59,720
you

759
00:46:56,110 --> 00:47:03,670
[Music]

760
00:46:59,720 --> 00:47:09,049
<font color="#E5E5E5">okay so we could use the mobile device</font>

761
00:47:03,670 --> 00:47:10,970
<font color="#CCCCCC">to hack into the mobile app</font><font color="#E5E5E5"> sorry the</font>

762
00:47:09,050 --> 00:47:15,140
smart device to hack into the mobile

763
00:47:10,970 --> 00:47:17,689
device<font color="#E5E5E5"> we bypassed the app because the</font>

764
00:47:15,140 --> 00:47:20,118
app has permissions on the<font color="#E5E5E5"> device to</font>

765
00:47:17,690 --> 00:47:23,630
start the music<font color="#CCCCCC"> to start to take</font>

766
00:47:20,119 --> 00:47:28,849
pictures<font color="#E5E5E5"> and whatnot</font><font color="#CCCCCC"> so we are using the</font>

767
00:47:23,630 --> 00:47:31,550
ble<font color="#E5E5E5"> layer to target the mobile app to</font>

768
00:47:28,849 --> 00:47:36,589
hack into the device

769
00:47:31,550 --> 00:47:41,950
so we<font color="#CCCCCC"> already showed the demo</font><font color="#E5E5E5"> okay</font>

770
00:47:36,589 --> 00:47:44,990
last words<font color="#CCCCCC"> so I applied for another</font>

771
00:47:41,950 --> 00:47:47,210
<font color="#E5E5E5">conference different conference totally</font>

772
00:47:44,990 --> 00:47:51,589
different they even have cocktails and

773
00:47:47,210 --> 00:47:55,609
galas<font color="#CCCCCC"> but the problem was that you had</font>

774
00:47:51,589 --> 00:47:57,950
<font color="#CCCCCC">to submit a paper and if you had</font><font color="#E5E5E5"> over</font>

775
00:47:55,609 --> 00:48:00,490
six pages<font color="#CCCCCC"> then it would cost you one</font>

776
00:47:57,950 --> 00:48:06,740
thousand and ten<font color="#E5E5E5"> dollars for</font><font color="#CCCCCC"> each page</font>

777
00:48:00,490 --> 00:48:09,109
<font color="#E5E5E5">really</font><font color="#CCCCCC"> so what I did so they have galas</font>

778
00:48:06,740 --> 00:48:16,459
<font color="#E5E5E5">only but really guys you must do the</font>

779
00:48:09,109 --> 00:48:25,960
math first<font color="#E5E5E5"> I just put minus nine I have</font>

780
00:48:16,460 --> 00:48:30,740
minus nine pages<font color="#E5E5E5"> so thanks</font>

781
00:48:25,960 --> 00:48:37,430
got a free ticket<font color="#E5E5E5"> yeah also</font><font color="#CCCCCC"> to a gala</font>

782
00:48:30,740 --> 00:48:41,149
<font color="#CCCCCC">didn't go okay so we saw that we</font><font color="#E5E5E5"> can we</font>

783
00:48:37,430 --> 00:48:44,299
cannot protect<font color="#E5E5E5"> Billy point 4.0 because</font>

784
00:48:41,150 --> 00:48:47,420
it's in the device<font color="#E5E5E5"> so what we can do is</font>

785
00:48:44,300 --> 00:48:50,420
if we're building<font color="#E5E5E5"> apps is to put some</font>

786
00:48:47,420 --> 00:48:54,650
security into the app as a security

787
00:48:50,420 --> 00:48:59,300
application security<font color="#E5E5E5"> person</font><font color="#CCCCCC"> we have some</font>

788
00:48:54,650 --> 00:49:03,710
rules of thumb<font color="#CCCCCC"> of</font><font color="#E5E5E5"> course</font><font color="#CCCCCC"> do not rely</font><font color="#E5E5E5"> on</font>

789
00:48:59,300 --> 00:49:06,290
what's coming<font color="#E5E5E5"> from the user duh</font><font color="#CCCCCC"> and</font>

790
00:49:03,710 --> 00:49:08,960
force access control so if you're going

791
00:49:06,290 --> 00:49:14,390
<font color="#E5E5E5">to</font><font color="#CCCCCC"> now start</font><font color="#E5E5E5"> downloading the scanner app</font>

792
00:49:08,960 --> 00:49:18,170
and scan each other devices on you yeah

793
00:49:14,390 --> 00:49:21,230
if the<font color="#E5E5E5"> the app is smart enough then it</font>

794
00:49:18,170 --> 00:49:25,280
will require an access<font color="#CCCCCC"> control to access</font>

795
00:49:21,230 --> 00:49:30,650
some<font color="#E5E5E5"> services</font><font color="#CCCCCC"> also do input validation</font>

796
00:49:25,280 --> 00:49:35,300
<font color="#CCCCCC">and there is some features</font><font color="#E5E5E5"> that can</font><font color="#CCCCCC"> be</font>

797
00:49:30,650 --> 00:49:39,770
<font color="#E5E5E5">done using the</font><font color="#CCCCCC"> ble technique or exposing</font>

798
00:49:35,300 --> 00:49:42,710
the ble<font color="#E5E5E5"> pairing</font><font color="#CCCCCC"> model just in a</font><font color="#E5E5E5"> secure</font>

799
00:49:39,770 --> 00:49:46,940
more secure way is that<font color="#E5E5E5"> for</font><font color="#CCCCCC"> example in</font>

800
00:49:42,710 --> 00:49:49,460
order<font color="#E5E5E5"> to pair to a device you first need</font>

801
00:49:46,940 --> 00:49:51,800
to click it physically click it<font color="#E5E5E5"> for I</font>

802
00:49:49,460 --> 00:49:55,790
don't know three seconds and<font color="#E5E5E5"> then</font><font color="#CCCCCC"> you</font>

803
00:49:51,800 --> 00:49:56,840
have five seconds to pair so it adds

804
00:49:55,790 --> 00:50:00,200
more security

805
00:49:56,840 --> 00:50:04,040
of course the app should properly<font color="#E5E5E5"> warn</font>

806
00:50:00,200 --> 00:50:06,439
you if you're using<font color="#CCCCCC"> a different Mac if</font>

807
00:50:04,040 --> 00:50:09,650
<font color="#E5E5E5">you're it comes across the same device</font>

808
00:50:06,440 --> 00:50:12,290
with a different MAC address<font color="#E5E5E5"> and do not</font>

809
00:50:09,650 --> 00:50:17,090
rely<font color="#CCCCCC"> on the Devon the ble creep sign</font>

810
00:50:12,290 --> 00:50:21,620
<font color="#CCCCCC">verify data in transit I must say thank</font>

811
00:50:17,090 --> 00:50:27,500
especially<font color="#E5E5E5"> Slav Amir for his toolkit</font>

812
00:50:21,620 --> 00:50:30,529
occur<font color="#E5E5E5"> he also contributed to</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> to</font>

813
00:50:27,500 --> 00:50:33,860
then start<font color="#E5E5E5"> initial of the research</font><font color="#CCCCCC"> also</font>

814
00:50:30,530 --> 00:50:36,960
thanks to<font color="#CCCCCC"> Damian and</font><font color="#E5E5E5"> Mike you can see</font>

815
00:50:33,860 --> 00:50:40,740
there are great<font color="#CCCCCC"> tools and talks</font>

816
00:50:36,960 --> 00:50:44,040
<font color="#E5E5E5">a clue and black hat</font><font color="#CCCCCC"> and I'm going to</font>

817
00:50:40,740 --> 00:50:47,549
discuss<font color="#E5E5E5"> further this or past discuss</font>

818
00:50:44,040 --> 00:50:54,630
this<font color="#E5E5E5"> talk in other conferences you can</font>

819
00:50:47,550 --> 00:50:58,650
see so yeah<font color="#CCCCCC"> Bluetooth is vulnerable</font>

820
00:50:54,630 --> 00:51:01,470
against if drops<font color="#E5E5E5"> but hopefully if we're</font>

821
00:50:58,650 --> 00:51:04,440
<font color="#E5E5E5">going to get the</font><font color="#CCCCCC"> next versions of</font>

822
00:51:01,470 --> 00:51:08,419
Bluetooth<font color="#CCCCCC"> ble devices they're going</font><font color="#E5E5E5"> to</font>

823
00:51:04,440 --> 00:51:12,510
<font color="#E5E5E5">be four point two or five which are now</font>

824
00:51:08,420 --> 00:51:16,890
<font color="#E5E5E5">really</font><font color="#CCCCCC"> amazing they are much more secure</font>

825
00:51:12,510 --> 00:51:19,470
<font color="#CCCCCC">because they use known encryption crypto</font>

826
00:51:16,890 --> 00:51:28,470
libraries and algorithms<font color="#E5E5E5"> and they didn't</font>

827
00:51:19,470 --> 00:51:31,890
not<font color="#CCCCCC"> implicate new ones and use the also</font>

828
00:51:28,470 --> 00:51:34,770
the<font color="#CCCCCC"> application side thank you very</font><font color="#E5E5E5"> much</font>

829
00:51:31,890 --> 00:51:39,500
for<font color="#CCCCCC"> coming and</font><font color="#E5E5E5"> for staying the lock for</font>

830
00:51:34,770 --> 00:51:43,890
<font color="#E5E5E5">the last way</font><font color="#CCCCCC"> you can contact me thanks</font>

831
00:51:39,500 --> 00:51:47,250
thank you<font color="#E5E5E5"> you can</font><font color="#CCCCCC"> contact me</font><font color="#E5E5E5"> at this</font>

832
00:51:43,890 --> 00:51:49,259
email if you want<font color="#E5E5E5"> questions thank you</font>

833
00:51:47,250 --> 00:51:51,300
<font color="#E5E5E5">very much</font><font color="#CCCCCC"> tall if you have any questions</font>

834
00:51:49,260 --> 00:51:53,310
please<font color="#E5E5E5"> line up at the microphones as it</font>

835
00:51:51,300 --> 00:51:55,380
is already<font color="#CCCCCC"> as it has already started</font>

836
00:51:53,310 --> 00:51:59,720
<font color="#E5E5E5">it's</font><font color="#CCCCCC"> raining</font><font color="#E5E5E5"> stay inside ask a few</font>

837
00:51:55,380 --> 00:51:59,720
questions come on up to the microphones

838
00:52:02,150 --> 00:52:08,010
yeah the first one<font color="#E5E5E5"> thank you</font>

839
00:52:05,270 --> 00:52:10,890
hello<font color="#CCCCCC"> alright oh you showed an attack</font>

840
00:52:08,010 --> 00:52:13,290
with this bracelet<font color="#CCCCCC"> you were showing and</font>

841
00:52:10,890 --> 00:52:15,569
I was curious<font color="#E5E5E5"> whether there was no</font>

842
00:52:13,290 --> 00:52:18,690
pairing involved at all<font color="#E5E5E5"> or if you could</font>

843
00:52:15,570 --> 00:52:22,200
like replay values that were somehow

844
00:52:18,690 --> 00:52:24,330
<font color="#E5E5E5">encrypted</font><font color="#CCCCCC"> not sure I understood</font><font color="#E5E5E5"> the</font>

845
00:52:22,200 --> 00:52:26,460
question you're at the are asking if it

846
00:52:24,330 --> 00:52:29,790
I had to<font color="#E5E5E5"> bear it with a beam or</font>

847
00:52:26,460 --> 00:52:31,770
something<font color="#E5E5E5"> right</font><font color="#CCCCCC"> no so just works</font><font color="#E5E5E5"> because</font>

848
00:52:29,790 --> 00:52:34,770
it's a very really shitty device right

849
00:52:31,770 --> 00:52:37,200
<font color="#CCCCCC">yeah but most of</font><font color="#E5E5E5"> the devices most of</font>

850
00:52:34,770 --> 00:52:40,080
them<font color="#CCCCCC"> I mean</font><font color="#E5E5E5"> maybe the most new ones will</font>

851
00:52:37,200 --> 00:52:43,910
not be but<font color="#E5E5E5"> most of the devices that you</font>

852
00:52:40,080 --> 00:52:47,400
<font color="#E5E5E5">get or you'll</font><font color="#CCCCCC"> just bear to them and go</font>

853
00:52:43,910 --> 00:52:49,440
so but when you pair right<font color="#CCCCCC"> yeah them</font>

854
00:52:47,400 --> 00:52:50,460
isn't there some<font color="#E5E5E5"> kind of encryption</font>

855
00:52:49,440 --> 00:52:52,830
going on on the

856
00:52:50,460 --> 00:52:56,510
<font color="#E5E5E5">yes there is an encryption and I told</font>

857
00:52:52,830 --> 00:53:02,810
you<font color="#E5E5E5"> the</font><font color="#CCCCCC"> beginning also</font><font color="#E5E5E5"> a symmetric</font><font color="#CCCCCC"> key</font>

858
00:52:56,510 --> 00:53:06,720
key exchange<font color="#CCCCCC"> but the problem</font><font color="#E5E5E5"> is that</font>

859
00:53:02,810 --> 00:53:09,810
when I do the<font color="#CCCCCC"> SMN in the middle I first</font>

860
00:53:06,720 --> 00:53:11,279
connect myself<font color="#CCCCCC"> to the device</font><font color="#E5E5E5"> so it</font>

861
00:53:09,810 --> 00:53:15,060
doesn't really matter I'm<font color="#CCCCCC"> not showing</font>

862
00:53:11,280 --> 00:53:16,920
how you<font color="#E5E5E5"> can hack a ble communication</font>

863
00:53:15,060 --> 00:53:19,799
link although it's possible<font color="#CCCCCC"> already</font>

864
00:53:16,920 --> 00:53:22,920
showed by Mike Ryan<font color="#E5E5E5"> he also has a tool</font>

865
00:53:19,800 --> 00:53:28,380
for<font color="#E5E5E5"> it</font><font color="#CCCCCC"> you can</font><font color="#E5E5E5"> download it from lobster</font>

866
00:53:22,920 --> 00:53:32,190
net<font color="#CCCCCC"> where</font><font color="#E5E5E5"> you can actually brute force a</font>

867
00:53:28,380 --> 00:53:35,280
paired communication or<font color="#E5E5E5"> jam and already</font>

868
00:53:32,190 --> 00:53:38,130
paired a communication in<font color="#E5E5E5"> order to</font>

869
00:53:35,280 --> 00:53:41,820
establish a new one and<font color="#E5E5E5"> then</font><font color="#CCCCCC"> hacking to</font>

870
00:53:38,130 --> 00:53:43,740
it but just I wanted<font color="#E5E5E5"> to show you the</font>

871
00:53:41,820 --> 00:53:47,390
<font color="#CCCCCC">application level</font><font color="#E5E5E5"> of the application</font>

872
00:53:43,740 --> 00:53:52,020
side of it<font color="#E5E5E5"> thank you</font><font color="#CCCCCC"> very</font><font color="#E5E5E5"> much thank you</font>

873
00:53:47,390 --> 00:53:53,910
next question please<font color="#CCCCCC"> more recommend one</font>

874
00:53:52,020 --> 00:53:56,609
<font color="#E5E5E5">thing also the devices shouldn't do is</font>

875
00:53:53,910 --> 00:53:59,250
<font color="#E5E5E5">sending out data that you</font><font color="#CCCCCC"> already</font><font color="#E5E5E5"> can</font>

876
00:53:56,609 --> 00:54:03,630
use Fitbit<font color="#CCCCCC"> is known for</font><font color="#E5E5E5"> sending out how</font>

877
00:53:59,250 --> 00:54:05,400
many steps you take always so<font color="#E5E5E5"> you get</font>

878
00:54:03,630 --> 00:54:08,630
the name of<font color="#CCCCCC"> the device and</font><font color="#E5E5E5"> how</font><font color="#CCCCCC"> many</font>

879
00:54:05,400 --> 00:54:10,920
steps<font color="#CCCCCC"> it</font><font color="#E5E5E5"> take on that day without any</font>

880
00:54:08,630 --> 00:54:17,700
interaction<font color="#CCCCCC"> with the device other than</font>

881
00:54:10,920 --> 00:54:21,150
scanning<font color="#E5E5E5"> yeah</font><font color="#CCCCCC"> not sure I understood the</font>

882
00:54:17,700 --> 00:54:23,700
<font color="#CCCCCC">question it's what's going wrong with</font>

883
00:54:21,150 --> 00:54:26,250
yeah yeah yeah so<font color="#CCCCCC"> all the information</font>

884
00:54:23,700 --> 00:54:29,368
<font color="#CCCCCC">without even asking yeah so</font><font color="#E5E5E5"> as I</font><font color="#CCCCCC"> showed</font>

885
00:54:26,250 --> 00:54:32,760
you<font color="#CCCCCC"> that the</font><font color="#E5E5E5"> problem is that today the</font>

886
00:54:29,369 --> 00:54:35,520
Bluetooth just tells you<font color="#CCCCCC"> hello I'm</font><font color="#E5E5E5"> a</font>

887
00:54:32,760 --> 00:54:38,580
<font color="#E5E5E5">Bluetooth this is what I can do just use</font>

888
00:54:35,520 --> 00:54:41,190
it free<font color="#CCCCCC"> connect</font><font color="#E5E5E5"> to it and though you</font>

889
00:54:38,580 --> 00:54:44,970
<font color="#E5E5E5">think that you can think</font><font color="#CCCCCC"> that these</font>

890
00:54:41,190 --> 00:54:48,150
there<font color="#E5E5E5"> is an and designated app that only</font>

891
00:54:44,970 --> 00:54:50,700
<font color="#CCCCCC">eat can work with the with the device</font>

892
00:54:48,150 --> 00:54:53,730
this<font color="#E5E5E5"> is not true I</font><font color="#CCCCCC"> could do all</font><font color="#E5E5E5"> all of</font>

893
00:54:50,700 --> 00:54:55,980
these from<font color="#E5E5E5"> a normal scanner Billy</font>

894
00:54:53,730 --> 00:55:01,180
<font color="#E5E5E5">Skinner generic one I'll just</font><font color="#CCCCCC"> need to</font>

895
00:54:55,980 --> 00:55:03,940
<font color="#CCCCCC">know the exact packets to</font><font color="#E5E5E5"> send</font><font color="#CCCCCC"> or</font>

896
00:55:01,180 --> 00:55:07,750
data to send to it<font color="#E5E5E5"> or to read from how</font>

897
00:55:03,940 --> 00:55:13,750
<font color="#E5E5E5">to read to it from it yeah next question</font>

898
00:55:07,750 --> 00:55:15,640
<font color="#CCCCCC">Melissa hi</font><font color="#E5E5E5"> how do you do</font><font color="#CCCCCC"> what you did</font><font color="#E5E5E5"> on</font>

899
00:55:13,750 --> 00:55:19,210
an existing<font color="#E5E5E5"> connection so what's the</font>

900
00:55:15,640 --> 00:55:22,230
deal<font color="#CCCCCC"> story or how do you</font><font color="#E5E5E5"> okay</font><font color="#CCCCCC"> so if</font>

901
00:55:19,210 --> 00:55:27,279
there is<font color="#CCCCCC"> an already established</font><font color="#E5E5E5"> compare</font>

902
00:55:22,230 --> 00:55:30,190
devices are paired<font color="#E5E5E5"> so you cannot do it</font>

903
00:55:27,279 --> 00:55:33,160
at the<font color="#CCCCCC"> moment because</font><font color="#E5E5E5"> I told you that</font>

904
00:55:30,190 --> 00:55:37,329
once you<font color="#CCCCCC"> the device is paired it can no</font>

905
00:55:33,160 --> 00:55:41,700
<font color="#CCCCCC">longer do anything else</font><font color="#E5E5E5"> so I I told the</font>

906
00:55:37,329 --> 00:55:44,859
other guy<font color="#E5E5E5"> that there is a way to jam</font>

907
00:55:41,700 --> 00:55:48,520
communication over<font color="#E5E5E5"> Bluetooth so in that</font>

908
00:55:44,859 --> 00:55:50,740
way<font color="#E5E5E5"> the communication is jammed and</font><font color="#CCCCCC"> deep</font>

909
00:55:48,520 --> 00:55:52,900
<font color="#CCCCCC">air and then</font><font color="#E5E5E5"> you have to come in the</font>

910
00:55:50,740 --> 00:55:55,959
middle<font color="#E5E5E5"> and do that like if you've tried</font>

911
00:55:52,900 --> 00:55:59,440
it<font color="#E5E5E5"> it's actually</font><font color="#CCCCCC"> really</font><font color="#E5E5E5"> hard to like</font>

912
00:55:55,960 --> 00:56:00,700
yeah you can broadcast noise on the

913
00:55:59,440 --> 00:56:02,380
spectrum<font color="#E5E5E5"> but that's pretty much</font><font color="#CCCCCC"> all you</font>

914
00:56:00,700 --> 00:56:06,569
can<font color="#E5E5E5"> do and it's not very reliable as a</font>

915
00:56:02,380 --> 00:56:09,190
way to do<font color="#E5E5E5"> that yeah</font><font color="#CCCCCC"> so you have some</font>

916
00:56:06,569 --> 00:56:12,819
<font color="#E5E5E5">limitations with Bluetooth you also have</font>

917
00:56:09,190 --> 00:56:15,549
to<font color="#E5E5E5"> have the proximity</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> so it's not</font>

918
00:56:12,819 --> 00:56:18,450
<font color="#CCCCCC">that easy as it looks but if you already</font>

919
00:56:15,549 --> 00:56:21,210
<font color="#E5E5E5">in the middle then</font><font color="#CCCCCC"> you can do bad stuff</font>

920
00:56:18,450 --> 00:56:28,328
<font color="#E5E5E5">thank you thank you</font>

921
00:56:21,210 --> 00:56:31,180
any further questions no apparently<font color="#CCCCCC"> not</font>

922
00:56:28,329 --> 00:56:33,570
<font color="#CCCCCC">so please give</font><font color="#E5E5E5"> another warm round of</font>

923
00:56:31,180 --> 00:56:38,990
applause<font color="#E5E5E5"> thank you</font><font color="#CCCCCC"> thank you</font><font color="#E5E5E5"> everyone</font>

924
00:56:33,570 --> 00:56:51,140
[Applause]

925
00:56:38,990 --> 00:56:51,140
[Music]

