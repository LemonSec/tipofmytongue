1
00:00:00,000 --> 00:00:05,490
hello everyone and today me and my

2
00:00:03,720 --> 00:00:07,440
collegue generator<font color="#E5E5E5"> on</font><font color="#CCCCCC"> earth we will</font>

3
00:00:05,490 --> 00:00:10,889
<font color="#E5E5E5">present you five former world kids myths</font>

4
00:00:07,440 --> 00:00:13,710
and realities<font color="#E5E5E5"> so I'm Alex matrosov</font><font color="#CCCCCC"> and</font>

5
00:00:10,889 --> 00:00:16,079
I'm working<font color="#E5E5E5"> for silence</font><font color="#CCCCCC"> as principal</font>

6
00:00:13,710 --> 00:00:21,410
research scientist and focus it on

7
00:00:16,079 --> 00:00:24,538
<font color="#CCCCCC">thermo rootkits</font><font color="#E5E5E5"> and former security for</font>

8
00:00:21,410 --> 00:00:31,160
actually developed some interesting ways

9
00:00:24,539 --> 00:00:34,680
to<font color="#E5E5E5"> research complex threats for that so</font>

10
00:00:31,160 --> 00:00:37,320
today we will be<font color="#E5E5E5"> speak a little bit</font>

11
00:00:34,680 --> 00:00:40,469
<font color="#E5E5E5">about historical value for</font><font color="#CCCCCC"> visored</font><font color="#E5E5E5"> kids</font>

12
00:00:37,320 --> 00:00:43,379
<font color="#E5E5E5">some</font><font color="#CCCCCC"> tread</font><font color="#E5E5E5"> model for</font><font color="#CCCCCC"> you five firmware</font>

13
00:00:40,469 --> 00:00:47,129
<font color="#E5E5E5">and how actually</font><font color="#CCCCCC"> hood kids can placed</font>

14
00:00:43,379 --> 00:00:49,649
here<font color="#E5E5E5"> and also we will be</font><font color="#CCCCCC"> discussed known</font>

15
00:00:47,129 --> 00:00:53,430
issue since<font color="#E5E5E5"> a while like hacking team</font>

16
00:00:49,649 --> 00:00:56,520
rootkit<font color="#CCCCCC"> BIOS implants and compute</font><font color="#E5E5E5"> race</font>

17
00:00:53,430 --> 00:00:59,039
so also<font color="#CCCCCC"> we will be speak about some</font>

18
00:00:56,520 --> 00:01:01,530
issues with the BIOS update and secure

19
00:00:59,039 --> 00:01:03,750
boot which<font color="#CCCCCC"> is known as the past and</font>

20
00:01:01,530 --> 00:01:06,450
<font color="#E5E5E5">focusing on forensic approaches how we</font>

21
00:01:03,750 --> 00:01:09,780
can recognize inside the firmware<font color="#E5E5E5"> some</font>

22
00:01:06,450 --> 00:01:12,390
malicious infection<font color="#E5E5E5"> and a little bit</font>

23
00:01:09,780 --> 00:01:17,369
about thermal<font color="#CCCCCC"> medications</font><font color="#E5E5E5"> and future</font>

24
00:01:12,390 --> 00:01:20,600
attack vectors so history<font color="#E5E5E5"> about the bias</font>

25
00:01:17,369 --> 00:01:24,330
<font color="#CCCCCC">rootkits</font><font color="#E5E5E5"> actually it's not a lot of</font>

26
00:01:20,600 --> 00:01:27,720
<font color="#E5E5E5">known threats in the wild for real cases</font>

27
00:01:24,330 --> 00:01:32,189
<font color="#E5E5E5">with the bias</font><font color="#CCCCCC"> root</font><font color="#E5E5E5"> kids and if we can</font>

28
00:01:27,720 --> 00:01:37,289
see<font color="#E5E5E5"> actually first one it was virus</font>

29
00:01:32,189 --> 00:01:41,460
<font color="#E5E5E5">Chernobyl also known as win</font><font color="#CCCCCC"> cih which is</font>

30
00:01:37,290 --> 00:01:46,799
in fact<font color="#E5E5E5"> the virus and clean</font><font color="#CCCCCC"> and don't</font>

31
00:01:41,460 --> 00:01:49,850
have payload just<font color="#CCCCCC"> actually</font><font color="#E5E5E5"> just some</font>

32
00:01:46,799 --> 00:01:54,420
<font color="#E5E5E5">destruction mechanism for the</font><font color="#CCCCCC"> bias</font><font color="#E5E5E5"> and</font>

33
00:01:49,850 --> 00:01:59,490
we can see<font color="#E5E5E5"> actually a</font><font color="#CCCCCC"> really low threat</font>

34
00:01:54,420 --> 00:02:02,759
activity in the past<font color="#E5E5E5"> till</font><font color="#CCCCCC"> 2013 and also</font>

35
00:01:59,490 --> 00:02:08,818
<font color="#CCCCCC">it's</font><font color="#E5E5E5"> not a lot</font><font color="#CCCCCC"> of researchers focus it</font>

36
00:02:02,759 --> 00:02:12,750
<font color="#CCCCCC">into</font><font color="#E5E5E5"> former PC</font><font color="#CCCCCC"> formal research and after</font>

37
00:02:08,818 --> 00:02:13,390
<font color="#CCCCCC">2013</font><font color="#E5E5E5"> actually interest of security</font>

38
00:02:12,750 --> 00:02:17,920
researcher

39
00:02:13,390 --> 00:02:20,880
for for research<font color="#E5E5E5"> the u5 firmware grows a</font>

40
00:02:17,920 --> 00:02:23,950
lot and we can see how<font color="#CCCCCC"> many</font><font color="#E5E5E5"> different</font>

41
00:02:20,880 --> 00:02:27,579
attack vectors<font color="#E5E5E5"> were discovered for this</font>

42
00:02:23,950 --> 00:02:30,310
<font color="#E5E5E5">three years and also we can</font><font color="#CCCCCC"> see some</font>

43
00:02:27,580 --> 00:02:36,459
targeted attacks which is maybe not<font color="#E5E5E5"> new</font>

44
00:02:30,310 --> 00:02:39,730
what was disclosed at the moment<font color="#CCCCCC"> we will</font>

45
00:02:36,459 --> 00:02:42,700
discuss partially of<font color="#CCCCCC"> this attacks today</font>

46
00:02:39,730 --> 00:02:47,549
<font color="#E5E5E5">like hacking team rootkit and some of</font>

47
00:02:42,700 --> 00:02:47,549
dirty bouncer and banana<font color="#CCCCCC"> glut implants</font>

48
00:02:48,209 --> 00:02:53,230
so as<font color="#E5E5E5"> I mentioned actually Chernobyl</font>

49
00:02:51,220 --> 00:02:57,010
it's pretty simple virus<font color="#E5E5E5"> which</font><font color="#CCCCCC"> is in</font>

50
00:02:53,230 --> 00:03:00,640
<font color="#E5E5E5">fact</font><font color="#CCCCCC"> PS and after that</font><font color="#E5E5E5"> just</font><font color="#CCCCCC"> try to erase</font>

51
00:02:57,010 --> 00:03:04,660
virus ROM in some<font color="#E5E5E5"> specific date</font><font color="#CCCCCC"> but it</font>

52
00:03:00,640 --> 00:03:09,399
was very<font color="#CCCCCC"> destructive and</font><font color="#E5E5E5"> actually kill a</font>

53
00:03:04,660 --> 00:03:14,019
lot<font color="#E5E5E5"> of machines also maybe you heard</font>

54
00:03:09,400 --> 00:03:17,920
<font color="#E5E5E5">here about some in the past my bro me</font>

55
00:03:14,019 --> 00:03:19,870
it's also known as<font color="#CCCCCC"> a</font><font color="#E5E5E5"> BIOS kid</font><font color="#CCCCCC"> it's trade</font>

56
00:03:17,920 --> 00:03:22,660
which is<font color="#E5E5E5"> focus it for the legacy</font><font color="#CCCCCC"> BIOS</font>

57
00:03:19,870 --> 00:03:25,329
but actually specifically nothing

58
00:03:22,660 --> 00:03:28,570
interesting here<font color="#CCCCCC"> it's a biased part it</font>

59
00:03:25,329 --> 00:03:31,239
just<font color="#CCCCCC"> infects the bias and try</font><font color="#E5E5E5"> every time</font>

60
00:03:28,570 --> 00:03:35,920
<font color="#E5E5E5">we cover in fact that MBR if as example</font>

61
00:03:31,239 --> 00:03:39,880
if bias will be clean the malicious code

62
00:03:35,920 --> 00:03:44,738
here<font color="#CCCCCC"> but what was actually</font><font color="#E5E5E5"> trade model</font>

63
00:03:39,880 --> 00:03:47,829
<font color="#E5E5E5">for modern biases it's actually not a</font>

64
00:03:44,739 --> 00:03:50,980
lot<font color="#E5E5E5"> of mitigations and progression</font>

65
00:03:47,829 --> 00:03:55,329
mechanism exists at the moment<font color="#CCCCCC"> we can</font>

66
00:03:50,980 --> 00:03:58,090
see like attackers moved from kernel

67
00:03:55,329 --> 00:04:01,739
mode to some<font color="#CCCCCC"> boot see sectors but boot</font>

68
00:03:58,090 --> 00:04:04,630
sectors also<font color="#CCCCCC"> have some protections like</font>

69
00:04:01,739 --> 00:04:07,060
secure and measure it<font color="#E5E5E5"> would also</font><font color="#CCCCCC"> good</font>

70
00:04:04,630 --> 00:04:10,680
guard<font color="#CCCCCC"> into technology which is focusing</font>

71
00:04:07,060 --> 00:04:15,609
<font color="#CCCCCC">to prevent and</font><font color="#E5E5E5"> armor at the secure boot</font>

72
00:04:10,680 --> 00:04:17,798
<font color="#CCCCCC">trusted boots him and IV</font><font color="#E5E5E5"> security</font>

73
00:04:15,609 --> 00:04:20,859
software actually<font color="#E5E5E5"> checks and</font><font color="#CCCCCC"> try</font><font color="#E5E5E5"> to</font>

74
00:04:17,798 --> 00:04:21,700
prevent infection for boot sectors but

75
00:04:20,858 --> 00:04:24,460
if it

76
00:04:21,700 --> 00:04:26,500
can<font color="#E5E5E5"> evolve the</font><font color="#CCCCCC"> buyers here is not a lot</font>

77
00:04:24,460 --> 00:04:28,810
of<font color="#E5E5E5"> things which is we know as</font>

78
00:04:26,500 --> 00:04:30,490
mitigations and<font color="#CCCCCC"> prevention</font><font color="#E5E5E5"> and we speak</font>

79
00:04:28,810 --> 00:04:34,570
<font color="#E5E5E5">not</font><font color="#CCCCCC"> about the expectation and</font>

80
00:04:30,490 --> 00:04:40,930
specifically for infection of of

81
00:04:34,570 --> 00:04:44,200
malicious<font color="#CCCCCC"> bias implants</font><font color="#E5E5E5"> so if we compare</font>

82
00:04:40,930 --> 00:04:47,230
legacy BIOS and UEFI<font color="#E5E5E5"> BIOS actually</font><font color="#CCCCCC"> unify</font>

83
00:04:44,200 --> 00:04:49,420
firmware takes a lot<font color="#CCCCCC"> of more activity</font>

84
00:04:47,230 --> 00:04:52,450
before<font color="#E5E5E5"> the operating system boot and</font>

85
00:04:49,420 --> 00:04:56,920
here is no more any of bootstrap code

86
00:04:52,450 --> 00:04:59,050
like MBR<font color="#CCCCCC"> VBR</font><font color="#E5E5E5"> and now it's actually you</font>

87
00:04:56,920 --> 00:05:01,030
find<font color="#E5E5E5"> farmer execute some different</font>

88
00:04:59,050 --> 00:05:04,120
stages<font color="#E5E5E5"> in the boot process and after</font>

89
00:05:01,030 --> 00:05:05,760
<font color="#CCCCCC">that pass</font><font color="#E5E5E5"> control to operating system</font>

90
00:05:04,120 --> 00:05:09,280
loader

91
00:05:05,760 --> 00:05:11,650
so actually you<font color="#E5E5E5"> face very complex that's</font>

92
00:05:09,280 --> 00:05:16,590
developed mainly on the<font color="#E5E5E5"> C language and</font>

93
00:05:11,650 --> 00:05:20,080
<font color="#E5E5E5">also it's executed in protected mode and</font>

94
00:05:16,590 --> 00:05:23,739
overall it's more than three million

95
00:05:20,080 --> 00:05:25,719
hundred<font color="#E5E5E5"> two million lines of code</font><font color="#CCCCCC"> and</font>

96
00:05:23,740 --> 00:05:29,140
actually<font color="#CCCCCC"> it's a lot it's almost like a</font>

97
00:05:25,720 --> 00:05:31,600
<font color="#E5E5E5">Windows code</font><font color="#CCCCCC"> base</font><font color="#E5E5E5"> it's looks like</font>

98
00:05:29,140 --> 00:05:35,789
<font color="#E5E5E5">infirmary we have an</font><font color="#CCCCCC"> operation system</font>

99
00:05:31,600 --> 00:05:40,210
and in modern<font color="#CCCCCC"> u5 firmware it's existed</font>

100
00:05:35,790 --> 00:05:43,330
<font color="#CCCCCC">network stack and</font><font color="#E5E5E5"> also implementation of</font>

101
00:05:40,210 --> 00:05:45,700
IPSec and<font color="#E5E5E5"> a lot of things which is can</font>

102
00:05:43,330 --> 00:05:51,159
<font color="#E5E5E5">be actually extend surface for the</font>

103
00:05:45,700 --> 00:05:53,890
attacker<font color="#CCCCCC"> so this team shows different</font>

104
00:05:51,160 --> 00:05:59,650
stages of boot operating system and we

105
00:05:53,890 --> 00:06:04,060
can<font color="#E5E5E5"> see I have a</font><font color="#CCCCCC"> laser pointer okay</font><font color="#E5E5E5"> so</font>

106
00:05:59,650 --> 00:06:06,099
we can see<font color="#E5E5E5"> actually different stages how</font>

107
00:06:04,060 --> 00:06:10,510
the system boots<font color="#E5E5E5"> from</font><font color="#CCCCCC"> the reset vector</font>

108
00:06:06,100 --> 00:06:12,870
<font color="#E5E5E5">and most interesting actually stage</font><font color="#CCCCCC"> for</font>

109
00:06:10,510 --> 00:06:15,400
attacker perspective it's<font color="#E5E5E5"> a driver</font>

110
00:06:12,870 --> 00:06:20,380
<font color="#E5E5E5">execution when the Dixit drivers is</font>

111
00:06:15,400 --> 00:06:25,270
executed because actually Dixit drivers

112
00:06:20,380 --> 00:06:29,020
is<font color="#E5E5E5"> normal P format files which is can be</font>

113
00:06:25,270 --> 00:06:33,340
infected<font color="#CCCCCC"> and can be modified</font><font color="#E5E5E5"> inside this</font>

114
00:06:29,020 --> 00:06:36,979
<font color="#E5E5E5">play yeah</font>

115
00:06:33,340 --> 00:06:40,010
<font color="#CCCCCC">this stage</font><font color="#E5E5E5"> it's most interesting</font><font color="#CCCCCC"> for</font>

116
00:06:36,980 --> 00:06:42,650
<font color="#CCCCCC">that I care</font><font color="#E5E5E5"> also we can see here is</font>

117
00:06:40,010 --> 00:06:44,990
configuration<font color="#E5E5E5"> for</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> CPI tables and</font>

118
00:06:42,650 --> 00:06:48,560
system tables which is accessible<font color="#E5E5E5"> from</font>

119
00:06:44,990 --> 00:06:51,110
<font color="#CCCCCC">the rating</font><font color="#E5E5E5"> system</font><font color="#CCCCCC"> and attacker can used</font>

120
00:06:48,560 --> 00:06:56,510
for<font color="#CCCCCC"> height something in</font><font color="#E5E5E5"> this particular</font>

121
00:06:51,110 --> 00:07:01,480
<font color="#E5E5E5">memory so and from after the system is</font>

122
00:06:56,510 --> 00:07:04,400
booted<font color="#CCCCCC"> operating system just actually</font>

123
00:07:01,480 --> 00:07:08,020
<font color="#E5E5E5">minimum have access to minimal you fight</font>

124
00:07:04,400 --> 00:07:10,489
runtime<font color="#CCCCCC"> services which is provide some</font>

125
00:07:08,020 --> 00:07:14,150
communications with the system hardware

126
00:07:10,490 --> 00:07:16,780
and operating system<font color="#CCCCCC"> and let's see what</font>

127
00:07:14,150 --> 00:07:21,489
we have<font color="#CCCCCC"> in the past</font>

128
00:07:16,780 --> 00:07:26,390
actually<font color="#CCCCCC"> Dixit drivers it's not a new</font>

129
00:07:21,490 --> 00:07:28,910
new vector for in fact and<font color="#CCCCCC"> embed the</font>

130
00:07:26,390 --> 00:07:31,190
implant into<font color="#E5E5E5"> the buyers and in the past</font>

131
00:07:28,910 --> 00:07:36,580
researchers<font color="#CCCCCC"> already discovered</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> way</font>

132
00:07:31,190 --> 00:07:39,200
<font color="#CCCCCC">so</font><font color="#E5E5E5"> in fact and in</font><font color="#CCCCCC"> fact the firmware so</font>

133
00:07:36,580 --> 00:07:41,650
<font color="#CCCCCC">patching cops</font><font color="#E5E5E5"> in wrong option</font><font color="#CCCCCC"> ROM</font><font color="#E5E5E5"> is</font>

134
00:07:39,200 --> 00:07:46,010
actually<font color="#CCCCCC"> specific firmware which is</font>

135
00:07:41,650 --> 00:07:50,479
<font color="#CCCCCC">existent</font><font color="#E5E5E5"> in</font><font color="#CCCCCC"> the additional devices</font><font color="#E5E5E5"> wide</font>

136
00:07:46,010 --> 00:07:53,570
network<font color="#E5E5E5"> cards storages and etc so and</font>

137
00:07:50,480 --> 00:07:56,480
also attacker can add and replace

138
00:07:53,570 --> 00:08:01,460
additional driver<font color="#E5E5E5"> into the</font><font color="#CCCCCC"> thermal image</font>

139
00:07:56,480 --> 00:08:03,860
and most simple<font color="#CCCCCC"> way</font><font color="#E5E5E5"> it's actually don't</font>

140
00:08:01,460 --> 00:08:06,320
touch the firmware and<font color="#E5E5E5"> the system don't</font>

141
00:08:03,860 --> 00:08:09,740
<font color="#E5E5E5">have secure boots humans just modifies</font>

142
00:08:06,320 --> 00:08:12,349
the<font color="#CCCCCC"> u5</font><font color="#E5E5E5"> bottle</font><font color="#CCCCCC"> odors which is received</font>

143
00:08:09,740 --> 00:08:16,670
control just after the firmware<font color="#E5E5E5"> is</font>

144
00:08:12,350 --> 00:08:22,850
booted in the last stage<font color="#E5E5E5"> of you fight</font>

145
00:08:16,670 --> 00:08:25,100
<font color="#E5E5E5">boot so but from like on modern</font>

146
00:08:22,850 --> 00:08:29,680
operating<font color="#CCCCCC"> system secure boot of course</font>

147
00:08:25,100 --> 00:08:34,120
<font color="#CCCCCC">take care about</font><font color="#E5E5E5"> verifying boot chain and</font>

148
00:08:29,680 --> 00:08:41,339
<font color="#CCCCCC">this modifications will be</font><font color="#E5E5E5"> easily</font>

149
00:08:34,120 --> 00:08:45,970
<font color="#E5E5E5">discovered by secure good driver but so</font>

150
00:08:41,339 --> 00:08:49,240
what we have<font color="#E5E5E5"> for from operating system</font>

151
00:08:45,970 --> 00:08:53,010
we have<font color="#E5E5E5"> fair if I run time services</font>

152
00:08:49,240 --> 00:08:56,740
<font color="#E5E5E5">which usually accessible from</font><font color="#CCCCCC"> her</font>

153
00:08:53,010 --> 00:09:00,399
hardware abstraction level and it's done

154
00:08:56,740 --> 00:09:03,520
from<font color="#E5E5E5"> either on Windows 10 and we can see</font>

155
00:09:00,399 --> 00:09:06,190
here<font color="#E5E5E5"> is like structures for access to</font>

156
00:09:03,520 --> 00:09:11,380
<font color="#E5E5E5">run time if I</font><font color="#CCCCCC"> run time</font><font color="#E5E5E5"> services boot</font>

157
00:09:06,190 --> 00:09:14,500
services and some other structures so

158
00:09:11,380 --> 00:09:17,589
actually how we can infect<font color="#E5E5E5"> the system</font>

159
00:09:14,500 --> 00:09:18,459
but not like have a physical access<font color="#CCCCCC"> to</font>

160
00:09:17,589 --> 00:09:21,339
<font color="#CCCCCC">the system</font>

161
00:09:18,459 --> 00:09:24,670
what attacker can do for in fact the

162
00:09:21,339 --> 00:09:27,040
system like a real case<font color="#E5E5E5"> of course all</font>

163
00:09:24,670 --> 00:09:30,160
the biases<font color="#CCCCCC"> it's have a lot</font><font color="#E5E5E5"> of specifics</font>

164
00:09:27,040 --> 00:09:32,680
<font color="#E5E5E5">for each hardware platform and mostly</font>

165
00:09:30,160 --> 00:09:37,480
<font color="#E5E5E5">these attack vectors can be used just</font>

166
00:09:32,680 --> 00:09:42,310
for the targeted attacks<font color="#E5E5E5"> but what what</font>

167
00:09:37,480 --> 00:09:44,560
actually<font color="#CCCCCC"> firm</font><font color="#E5E5E5"> a rootkit can can how firm</font>

168
00:09:42,310 --> 00:09:48,069
a rootkit can be installed<font color="#E5E5E5"> and in fact</font>

169
00:09:44,560 --> 00:09:52,089
the system<font color="#E5E5E5"> let's talk about some</font>

170
00:09:48,070 --> 00:09:54,970
<font color="#CCCCCC">specific scheme for for that so let's</font>

171
00:09:52,089 --> 00:09:57,300
<font color="#E5E5E5">assume we</font><font color="#CCCCCC"> have some vulnerable</font>

172
00:09:54,970 --> 00:09:59,740
application and the user<font color="#E5E5E5"> mode and</font>

173
00:09:57,300 --> 00:10:03,040
attacker<font color="#E5E5E5"> have a remote code execution</font>

174
00:09:59,740 --> 00:10:05,860
exploit<font color="#E5E5E5"> it will be a stage</font><font color="#CCCCCC"> 1</font><font color="#E5E5E5"> as example</font>

175
00:10:03,040 --> 00:10:08,079
browser or whatever malicious<font color="#E5E5E5"> word file</font>

176
00:10:05,860 --> 00:10:10,690
will be<font color="#E5E5E5"> passed to the</font><font color="#CCCCCC"> email and then</font>

177
00:10:08,080 --> 00:10:13,150
payload will be dropped<font color="#E5E5E5"> to the system</font>

178
00:10:10,690 --> 00:10:15,730
and<font color="#CCCCCC"> way world will be execute some</font>

179
00:10:13,150 --> 00:10:19,029
exploit for<font color="#E5E5E5"> the</font><font color="#CCCCCC"> away of privileges to</font>

180
00:10:15,730 --> 00:10:21,790
kernel<font color="#E5E5E5"> but because for for operating</font>

181
00:10:19,029 --> 00:10:24,279
<font color="#E5E5E5">with you fire</font><font color="#CCCCCC"> on time services and some</font>

182
00:10:21,790 --> 00:10:28,000
specific<font color="#CCCCCC"> memory regions</font><font color="#E5E5E5"> you should have</font>

183
00:10:24,279 --> 00:10:32,110
access<font color="#E5E5E5"> to</font><font color="#CCCCCC"> the kernel mode and after that</font>

184
00:10:28,000 --> 00:10:34,360
<font color="#E5E5E5">actually on the stage</font><font color="#CCCCCC"> 3 Oh actually</font>

185
00:10:32,110 --> 00:10:36,940
payload into the kernel<font color="#CCCCCC"> mode</font><font color="#E5E5E5"> will be</font>

186
00:10:34,360 --> 00:10:38,920
execute system management mode exploit

187
00:10:36,940 --> 00:10:40,880
and I want to ask you guys who knows

188
00:10:38,920 --> 00:10:43,069
what is the system management mode

189
00:10:40,880 --> 00:10:48,590
is I should make some notes here<font color="#E5E5E5"> about</font>

190
00:10:43,070 --> 00:10:50,750
<font color="#E5E5E5">that okay</font><font color="#CCCCCC"> actually system management mod</font>

191
00:10:48,590 --> 00:10:54,680
its most privileged<font color="#CCCCCC"> yet mod into the</font>

192
00:10:50,750 --> 00:10:57,350
system and<font color="#E5E5E5"> usually</font><font color="#CCCCCC"> all the</font><font color="#E5E5E5"> Intel not</font>

193
00:10:54,680 --> 00:11:02,870
just Intel<font color="#CCCCCC"> MD have also some pretty</font>

194
00:10:57,350 --> 00:11:06,670
similar model<font color="#E5E5E5"> my system management mode</font>

195
00:11:02,870 --> 00:11:09,980
<font color="#E5E5E5">its calls like rink</font><font color="#CCCCCC"> -2 because it's</font>

196
00:11:06,670 --> 00:11:12,140
under actually virtualization<font color="#E5E5E5"> also</font>

197
00:11:09,980 --> 00:11:13,850
virtualization<font color="#E5E5E5"> its rink minus 1 and we</font>

198
00:11:12,140 --> 00:11:16,340
have rink<font color="#CCCCCC"> minus zero which</font><font color="#E5E5E5"> is normal</font>

199
00:11:13,850 --> 00:11:19,130
<font color="#CCCCCC">kernel mode and here we're talking about</font>

200
00:11:16,340 --> 00:11:21,260
the<font color="#E5E5E5"> exploit will be take care</font><font color="#CCCCCC"> for some</font>

201
00:11:19,130 --> 00:11:24,140
code execution<font color="#E5E5E5"> inside the</font><font color="#CCCCCC"> samam as</font>

202
00:11:21,260 --> 00:11:29,960
example by vulnerability in<font color="#CCCCCC"> its my</font>

203
00:11:24,140 --> 00:11:32,390
handler<font color="#E5E5E5"> and then so he passed some calls</font>

204
00:11:29,960 --> 00:11:35,930
<font color="#E5E5E5">during</font><font color="#CCCCCC"> like hardware abstraction level</font>

205
00:11:32,390 --> 00:11:40,010
<font color="#CCCCCC">calls you file system services runtime</font>

206
00:11:35,930 --> 00:11:42,969
services<font color="#E5E5E5"> and then try to attack</font><font color="#CCCCCC"> sm m and</font>

207
00:11:40,010 --> 00:11:46,819
execute some payload<font color="#E5E5E5"> shell code here but</font>

208
00:11:42,970 --> 00:11:49,250
<font color="#CCCCCC">it's</font><font color="#E5E5E5"> still will</font><font color="#CCCCCC"> be difficult to modify</font>

209
00:11:46,820 --> 00:11:51,890
the spy flash<font color="#CCCCCC"> because spy flash it's</font>

210
00:11:49,250 --> 00:11:54,500
<font color="#E5E5E5">actually specific chip which</font><font color="#CCCCCC"> store some</font>

211
00:11:51,890 --> 00:11:58,000
image with the system farmer in the boot

212
00:11:54,500 --> 00:12:01,010
process<font color="#E5E5E5"> actually</font><font color="#CCCCCC"> platform mapped this</font>

213
00:11:58,000 --> 00:12:03,980
<font color="#E5E5E5">cyst system</font><font color="#CCCCCC"> firmware image from spy</font>

214
00:12:01,010 --> 00:12:06,650
flash to<font color="#E5E5E5"> the memory and after that start</font>

215
00:12:03,980 --> 00:12:11,600
<font color="#E5E5E5">execution and preparation for</font><font color="#CCCCCC"> the boot</font>

216
00:12:06,650 --> 00:12:13,490
and if we can modify<font color="#CCCCCC"> a</font><font color="#E5E5E5"> flash memory</font><font color="#CCCCCC"> we</font>

217
00:12:11,600 --> 00:12:15,770
<font color="#CCCCCC">can make a persistent which will be</font>

218
00:12:13,490 --> 00:12:19,250
every time map to the memory with

219
00:12:15,770 --> 00:12:22,490
infection<font color="#E5E5E5"> because if we stuck on this</font>

220
00:12:19,250 --> 00:12:25,160
level<font color="#E5E5E5"> we will be just have execution of</font>

221
00:12:22,490 --> 00:12:27,890
the payload<font color="#E5E5E5"> and if the system</font><font color="#CCCCCC"> will be</font>

222
00:12:25,160 --> 00:12:32,719
reboot this malicious payload will be

223
00:12:27,890 --> 00:12:35,480
gone so then we should<font color="#E5E5E5"> like on this</font>

224
00:12:32,720 --> 00:12:38,120
stage they care about modifies despite

225
00:12:35,480 --> 00:12:41,500
<font color="#CCCCCC">write</font><font color="#E5E5E5"> protection policies which is</font>

226
00:12:38,120 --> 00:12:45,020
possible from privileges<font color="#CCCCCC"> SMM mod and</font>

227
00:12:41,500 --> 00:12:48,220
after that we<font color="#E5E5E5"> can try to figure out how</font>

228
00:12:45,020 --> 00:12:48,220
we can modify the spy flash

229
00:12:49,970 --> 00:12:56,970
so as you<font color="#CCCCCC"> can see it's</font><font color="#E5E5E5"> pretty complex</font>

230
00:12:55,110 --> 00:13:00,060
him for infection and<font color="#E5E5E5"> it's a lot of</font>

231
00:12:56,970 --> 00:13:02,370
nuances on each level<font color="#E5E5E5"> because as you</font>

232
00:13:00,060 --> 00:13:04,410
<font color="#E5E5E5">know it can</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> a lot</font><font color="#CCCCCC"> of differences</font>

233
00:13:02,370 --> 00:13:06,899
<font color="#CCCCCC">between different</font><font color="#E5E5E5"> platforms</font><font color="#CCCCCC"> but for the</font>

234
00:13:04,410 --> 00:13:09,180
<font color="#E5E5E5">target</font><font color="#CCCCCC"> Attica attacks</font><font color="#E5E5E5"> it can be fair and</font>

235
00:13:06,899 --> 00:13:12,680
we will be discussed<font color="#E5E5E5"> some known tress in</font>

236
00:13:09,180 --> 00:13:16,199
the<font color="#E5E5E5"> vial and real cases in the context</font>

237
00:13:12,680 --> 00:13:19,258
so just few words<font color="#CCCCCC"> about a CPI tables</font>

238
00:13:16,199 --> 00:13:22,378
<font color="#E5E5E5">actually</font><font color="#CCCCCC"> a CPI tables it's not directly</font>

239
00:13:19,259 --> 00:13:24,470
actually related with the<font color="#CCCCCC"> firmware but</font>

240
00:13:22,379 --> 00:13:27,660
it's really<font color="#CCCCCC"> interested in specific</font>

241
00:13:24,470 --> 00:13:31,019
memory regions for mostly<font color="#CCCCCC"> use it for</font>

242
00:13:27,660 --> 00:13:34,139
<font color="#E5E5E5">power management but also very</font>

243
00:13:31,019 --> 00:13:38,629
interesting for<font color="#E5E5E5"> attacker perspective as</font>

244
00:13:34,139 --> 00:13:44,129
example<font color="#CCCCCC"> windows platform binary table</font>

245
00:13:38,629 --> 00:13:47,250
usually<font color="#CCCCCC"> used for</font><font color="#E5E5E5"> recovery of of the</font>

246
00:13:44,129 --> 00:13:50,490
system for on modern laptops as example

247
00:13:47,250 --> 00:13:52,620
<font color="#CCCCCC">lonoa have Lenovo service engine which</font>

248
00:13:50,490 --> 00:13:54,740
<font color="#CCCCCC">is actually try</font><font color="#E5E5E5"> to recover a rating</font>

249
00:13:52,620 --> 00:13:57,180
system<font color="#CCCCCC"> which will be</font><font color="#E5E5E5"> corrupt</font>

250
00:13:54,740 --> 00:14:01,439
<font color="#E5E5E5">automatically and you</font><font color="#CCCCCC"> can run actually</font>

251
00:13:57,180 --> 00:14:04,138
<font color="#CCCCCC">from I know in the past some models even</font>

252
00:14:01,439 --> 00:14:11,099
have like a button<font color="#E5E5E5"> for recover on on the</font>

253
00:14:04,139 --> 00:14:14,389
laptop<font color="#E5E5E5"> and in 2015 in October it will be</font>

254
00:14:11,100 --> 00:14:17,519
<font color="#CCCCCC">discover</font><font color="#E5E5E5"> some issue for like inject</font>

255
00:14:14,389 --> 00:14:19,680
specific binaries<font color="#E5E5E5"> inside the recovery</font>

256
00:14:17,519 --> 00:14:21,750
<font color="#CCCCCC">image and then if you will</font><font color="#E5E5E5"> be recover</font>

257
00:14:19,680 --> 00:14:24,508
the system malicious content will<font color="#CCCCCC"> be</font>

258
00:14:21,750 --> 00:14:26,639
inside<font color="#CCCCCC"> the system after recover it's</font>

259
00:14:24,509 --> 00:14:29,790
pretty much interesting and as we can

260
00:14:26,639 --> 00:14:32,279
<font color="#CCCCCC">see it's a</font><font color="#E5E5E5"> lot</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> different and actually</font>

261
00:14:29,790 --> 00:14:35,279
it's partially<font color="#CCCCCC"> documented information</font>

262
00:14:32,279 --> 00:14:38,040
<font color="#CCCCCC">about the core system resource table and</font>

263
00:14:35,279 --> 00:14:40,860
also<font color="#CCCCCC"> Windows platform binary table</font>

264
00:14:38,040 --> 00:14:43,709
<font color="#E5E5E5">pretty well documented and</font><font color="#CCCCCC"> hardware</font>

265
00:14:40,860 --> 00:14:48,930
watchdogs for<font color="#CCCCCC"> a supplied tables actually</font>

266
00:14:43,709 --> 00:14:51,899
also very interesting place but also in

267
00:14:48,930 --> 00:14:54,569
the past we have the issue<font color="#E5E5E5"> with a stable</font>

268
00:14:51,899 --> 00:14:59,029
script which<font color="#E5E5E5"> is actually also related</font>

269
00:14:54,569 --> 00:15:00,170
with<font color="#CCCCCC"> the supply</font><font color="#E5E5E5"> table because sometimes</font>

270
00:14:59,029 --> 00:15:03,649
Dixit

271
00:15:00,170 --> 00:15:07,339
drivers and specifically SMI handlers

272
00:15:03,649 --> 00:15:09,709
can use as a parameter<font color="#E5E5E5"> some values from</font>

273
00:15:07,339 --> 00:15:12,040
a<font color="#E5E5E5"> supplier tables and it can be very</font>

274
00:15:09,709 --> 00:15:16,579
<font color="#E5E5E5">interesting to play with it and</font>

275
00:15:12,040 --> 00:15:19,930
researchers from<font color="#CCCCCC"> mitra</font><font color="#E5E5E5"> and also it</font><font color="#CCCCCC"> wants</font>

276
00:15:16,579 --> 00:15:23,029
<font color="#CCCCCC">a trade research team from intel</font>

277
00:15:19,930 --> 00:15:25,399
<font color="#E5E5E5">discovered</font><font color="#CCCCCC"> together the issue which is</font>

278
00:15:23,029 --> 00:15:29,089
related with<font color="#CCCCCC"> a</font><font color="#E5E5E5"> stupid script table</font>

279
00:15:25,399 --> 00:15:32,810
modification and what we can do here

280
00:15:29,089 --> 00:15:37,160
<font color="#E5E5E5">actually first this issue was presented</font>

281
00:15:32,810 --> 00:15:40,189
<font color="#E5E5E5">in</font><font color="#CCCCCC"> end of 2014 in</font><font color="#E5E5E5"> December and in</font>

282
00:15:37,160 --> 00:15:44,060
February it<font color="#CCCCCC"> was first release of public</font>

283
00:15:40,190 --> 00:15:47,680
exploit for this issue<font color="#E5E5E5"> and it's pretty</font>

284
00:15:44,060 --> 00:15:51,619
interesting<font color="#E5E5E5"> actually exploit because</font>

285
00:15:47,680 --> 00:15:57,399
attacker<font color="#E5E5E5"> can from normal operating</font>

286
00:15:51,620 --> 00:15:57,399
system can modify s3<font color="#E5E5E5"> would script table</font>

287
00:15:59,260 --> 00:16:09,339
<font color="#CCCCCC">okay I have 10 minutes it can beat rusev</font>

288
00:16:05,990 --> 00:16:09,339
to just<font color="#CCCCCC"> speak 20 minutes</font>

289
00:16:11,110 --> 00:16:16,100
yeah<font color="#E5E5E5"> you scared me because</font><font color="#CCCCCC"> I have a lot</font>

290
00:16:14,390 --> 00:16:23,360
of more<font color="#E5E5E5"> toys</font>

291
00:16:16,100 --> 00:16:26,420
<font color="#E5E5E5">okay so so a stupid script table can</font><font color="#CCCCCC"> be</font>

292
00:16:23,360 --> 00:16:29,630
modified from<font color="#E5E5E5"> normal</font><font color="#CCCCCC"> US kernel mode and</font>

293
00:16:26,420 --> 00:16:33,349
then attacker can inject some dispatch

294
00:16:29,630 --> 00:16:37,930
<font color="#CCCCCC">codes which is a actually normal</font><font color="#E5E5E5"> normal</font>

295
00:16:33,350 --> 00:16:41,260
assembly code and it<font color="#CCCCCC"> can be executed and</font>

296
00:16:37,930 --> 00:16:46,069
actually execution will be happens when

297
00:16:41,260 --> 00:16:50,060
<font color="#CCCCCC">the</font><font color="#E5E5E5"> system will be back from sleep mode</font>

298
00:16:46,070 --> 00:16:53,540
<font color="#CCCCCC">and very interesting because</font><font color="#E5E5E5"> actually</font>

299
00:16:50,060 --> 00:16:54,920
how many times during<font color="#E5E5E5"> the week you</font>

300
00:16:53,540 --> 00:17:00,230
reboot<font color="#CCCCCC"> your system</font>

301
00:16:54,920 --> 00:17:02,990
I think people in<font color="#E5E5E5"> nowadays</font><font color="#CCCCCC"> just like go</font>

302
00:17:00,230 --> 00:17:05,690
provide to sleep the system but reboot

303
00:17:02,990 --> 00:17:07,720
<font color="#CCCCCC">maybe just</font><font color="#E5E5E5"> after updates of a grading</font>

304
00:17:05,690 --> 00:17:11,000
system<font color="#E5E5E5"> or maybe install some software</font>

305
00:17:07,720 --> 00:17:14,060
<font color="#E5E5E5">but usually you not reboot</font><font color="#CCCCCC"> everyday your</font>

306
00:17:11,000 --> 00:17:18,250
system<font color="#E5E5E5"> and this kind of exploit can keep</font>

307
00:17:14,060 --> 00:17:24,109
<font color="#CCCCCC">working like weeks away beyond months</font>

308
00:17:18,250 --> 00:17:27,319
and but the is to boot script<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> also</font>

309
00:17:24,109 --> 00:17:32,090
can be used<font color="#CCCCCC"> for modification</font><font color="#E5E5E5"> of spy</font>

310
00:17:27,319 --> 00:17:36,350
flash image because you can modify if

311
00:17:32,090 --> 00:17:39,919
<font color="#CCCCCC">you in fact the stable script</font><font color="#E5E5E5"> and after</font>

312
00:17:36,350 --> 00:17:42,379
that modifies the splat spy flash

313
00:17:39,920 --> 00:17:45,050
policies and try to modify<font color="#E5E5E5"> content of</font>

314
00:17:42,380 --> 00:17:47,450
spy flash image then<font color="#E5E5E5"> you can make more</font>

315
00:17:45,050 --> 00:17:53,300
persistent<font color="#E5E5E5"> but also it's much more</font>

316
00:17:47,450 --> 00:17:55,220
complex exploit just briefly about the

317
00:17:53,300 --> 00:18:00,230
<font color="#E5E5E5">system I handlers because I feel I have</font>

318
00:17:55,220 --> 00:18:00,830
<font color="#E5E5E5">less time than</font><font color="#CCCCCC"> I need</font><font color="#E5E5E5"> so it's my</font>

319
00:18:00,230 --> 00:18:03,050
handlers

320
00:18:00,830 --> 00:18:05,360
it's very<font color="#E5E5E5"> actually common issues in the</font>

321
00:18:03,050 --> 00:18:07,730
past and<font color="#E5E5E5"> in my</font><font color="#CCCCCC"> opinion it's</font><font color="#E5E5E5"> never ending</font>

322
00:18:05,360 --> 00:18:09,979
story because we have a lot of different

323
00:18:07,730 --> 00:18:14,660
biases and<font color="#E5E5E5"> a lot of different</font><font color="#CCCCCC"> platforms</font>

324
00:18:09,980 --> 00:18:19,010
which is up<font color="#CCCCCC"> to date</font><font color="#E5E5E5"> and the issue is as</font>

325
00:18:14,660 --> 00:18:21,389
my handler this<font color="#E5E5E5"> is this</font><font color="#CCCCCC"> figure show how</font>

326
00:18:19,010 --> 00:18:23,669
we<font color="#E5E5E5"> can actually pass the</font>

327
00:18:21,389 --> 00:18:27,389
pointer to the data<font color="#CCCCCC"> buffer</font><font color="#E5E5E5"> to this my</font>

328
00:18:23,669 --> 00:18:32,779
handler during CPU state and<font color="#E5E5E5"> herbux you</font>

329
00:18:27,389 --> 00:18:32,779
register it's usually used<font color="#E5E5E5"> for that but</font>

330
00:18:33,229 --> 00:18:40,409
what we can do with the semi handler<font color="#CCCCCC"> in</font>

331
00:18:36,149 --> 00:18:42,149
the way for make a persistent infection

332
00:18:40,409 --> 00:18:43,499
<font color="#E5E5E5">into the machine more actually</font>

333
00:18:42,149 --> 00:18:45,869
<font color="#E5E5E5">information you can find</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> our</font>

334
00:18:43,499 --> 00:18:52,019
representation with<font color="#CCCCCC"> HR attacking and</font>

335
00:18:45,869 --> 00:18:56,158
defending<font color="#CCCCCC"> BIOS in 2015 and so here is</font>

336
00:18:52,019 --> 00:18:58,320
some scheme<font color="#E5E5E5"> actually you can exploit SMI</font>

337
00:18:56,159 --> 00:19:02,070
handler<font color="#E5E5E5"> from the normal kernel mode and</font>

338
00:18:58,320 --> 00:19:04,259
then<font color="#E5E5E5"> you can you</font><font color="#CCCCCC"> managed to execute some</font>

339
00:19:02,070 --> 00:19:06,599
malicious payload inside system

340
00:19:04,259 --> 00:19:11,159
management mode and same<font color="#CCCCCC"> thing</font><font color="#E5E5E5"> try to</font>

341
00:19:06,599 --> 00:19:16,049
modify system firmware<font color="#CCCCCC"> yeah system</font>

342
00:19:11,159 --> 00:19:19,909
thermal image into the spy flash just

343
00:19:16,049 --> 00:19:24,450
briefly about<font color="#E5E5E5"> the secure boot scheme so</font>

344
00:19:19,909 --> 00:19:27,029
it was like a lot<font color="#E5E5E5"> of interesting things</font>

345
00:19:24,450 --> 00:19:29,969
<font color="#CCCCCC">about secure boot</font><font color="#E5E5E5"> because in the past</font>

346
00:19:27,029 --> 00:19:32,609
<font color="#E5E5E5">and now it's actually evolved a lot and</font>

347
00:19:29,969 --> 00:19:36,709
we<font color="#CCCCCC"> have a measured boot</font><font color="#E5E5E5"> and also we have</font>

348
00:19:32,609 --> 00:19:42,539
<font color="#CCCCCC">a Intel good guard on the modern system</font>

349
00:19:36,709 --> 00:19:46,979
from<font color="#CCCCCC"> Hasbro</font><font color="#E5E5E5"> and actually secure boot</font>

350
00:19:42,539 --> 00:19:54,179
<font color="#CCCCCC">take cares about chain of trust from</font><font color="#E5E5E5"> the</font>

351
00:19:46,979 --> 00:19:56,700
<font color="#E5E5E5">bootloader</font><font color="#CCCCCC"> to operating</font><font color="#E5E5E5"> system</font><font color="#CCCCCC"> path also</font>

352
00:19:54,179 --> 00:19:59,609
<font color="#CCCCCC">we have a measured boot which is related</font>

353
00:19:56,700 --> 00:20:03,739
with TPM and all the keys<font color="#CCCCCC"> have support</font>

354
00:19:59,609 --> 00:20:06,928
of some hardware<font color="#E5E5E5"> encryption engine but</font>

355
00:20:03,739 --> 00:20:10,799
so what will be happens if we will

356
00:20:06,929 --> 00:20:13,799
infect the firmware<font color="#E5E5E5"> and actually secure</font>

357
00:20:10,799 --> 00:20:19,049
boot verification will be just started

358
00:20:13,799 --> 00:20:21,809
after<font color="#CCCCCC"> that</font><font color="#E5E5E5"> if the system don't have some</font>

359
00:20:19,049 --> 00:20:26,570
<font color="#CCCCCC">you mitigations like into a boot guard</font>

360
00:20:21,809 --> 00:20:28,350
<font color="#E5E5E5">and in the wise guard then it will be</font>

361
00:20:26,570 --> 00:20:33,240
easy to

362
00:20:28,350 --> 00:20:36,360
in fact<font color="#CCCCCC"> insights by flesh Dixit driver</font>

363
00:20:33,240 --> 00:20:42,750
which is<font color="#E5E5E5"> will be compromised</font><font color="#CCCCCC"> whose him</font>

364
00:20:36,360 --> 00:20:48,360
<font color="#E5E5E5">during trust chain of secure boot yeah</font>

365
00:20:42,750 --> 00:20:51,509
and here is actually same thing<font color="#E5E5E5"> system</font>

366
00:20:48,360 --> 00:20:55,830
will be compromised<font color="#E5E5E5"> but let's actually</font>

367
00:20:51,509 --> 00:21:00,889
discuss<font color="#E5E5E5"> what in the in the past we have</font>

368
00:20:55,830 --> 00:21:03,840
in the wild<font color="#E5E5E5"> in the last year</font><font color="#CCCCCC"> I already</font>

369
00:21:00,889 --> 00:21:06,769
write the blog post about hacking<font color="#E5E5E5"> team</font>

370
00:21:03,840 --> 00:21:11,100
rootkit<font color="#CCCCCC"> reactor in decay but it's</font>

371
00:21:06,769 --> 00:21:15,960
nothing<font color="#E5E5E5"> serious here it's actually</font><font color="#CCCCCC"> very</font>

372
00:21:11,100 --> 00:21:19,019
known scheme for infection<font color="#CCCCCC"> it's in fact</font>

373
00:21:15,960 --> 00:21:23,429
malicious<font color="#CCCCCC"> it's inject malicious Dixie</font>

374
00:21:19,019 --> 00:21:26,850
driver inside the BIOS update image but

375
00:21:23,429 --> 00:21:28,950
if you inject some malicious contact

376
00:21:26,850 --> 00:21:33,418
inside BIOS update of course you can't

377
00:21:28,950 --> 00:21:38,460
<font color="#CCCCCC">just update the BIOS</font><font color="#E5E5E5"> by software way but</font>

378
00:21:33,419 --> 00:21:42,179
hacking<font color="#CCCCCC"> Tim</font><font color="#E5E5E5"> mentioned</font><font color="#CCCCCC"> like physical</font>

379
00:21:38,460 --> 00:21:44,399
access to the machine<font color="#CCCCCC"> so but if you can</font>

380
00:21:42,179 --> 00:21:46,440
modify<font color="#CCCCCC"> some spy flash inside the spy</font>

381
00:21:44,399 --> 00:21:48,809
flash<font color="#CCCCCC"> image in the</font><font color="#E5E5E5"> skin which I</font>

382
00:21:46,440 --> 00:21:50,909
discussed before with the exploit then

383
00:21:48,809 --> 00:21:56,190
it can be more<font color="#E5E5E5"> interesting because it</font>

384
00:21:50,909 --> 00:21:58,289
can be remote way for infection let's

385
00:21:56,190 --> 00:22:01,860
discuss a little<font color="#E5E5E5"> bit how hacking team</font>

386
00:21:58,289 --> 00:22:05,429
implant works<font color="#E5E5E5"> so they have few models</font>

387
00:22:01,860 --> 00:22:08,219
which<font color="#E5E5E5"> is one ntfs driver for person who</font>

388
00:22:05,429 --> 00:22:14,730
<font color="#E5E5E5">NTFS file system</font><font color="#CCCCCC"> other model</font><font color="#E5E5E5"> it's</font>

389
00:22:08,220 --> 00:22:17,429
actually<font color="#E5E5E5"> hook the event when on the last</font>

390
00:22:14,730 --> 00:22:20,009
stage when the firmware loads all<font color="#CCCCCC"> the</font>

391
00:22:17,429 --> 00:22:23,490
<font color="#CCCCCC">dixit drivers and has the control</font><font color="#E5E5E5"> to</font>

392
00:22:20,009 --> 00:22:26,509
<font color="#E5E5E5">operating system boot loaders this Dixit</font>

393
00:22:23,490 --> 00:22:30,019
<font color="#CCCCCC">specifical different</font><font color="#E5E5E5"> Dixit driver hook</font>

394
00:22:26,509 --> 00:22:34,340
<font color="#E5E5E5">the event and make</font><font color="#CCCCCC"> some malicious</font>

395
00:22:30,019 --> 00:22:34,340
modification<font color="#E5E5E5"> into the file system</font>

396
00:22:35,520 --> 00:22:42,668
so how it's<font color="#E5E5E5"> actually worked but I'm</font><font color="#CCCCCC"> all</font>

397
00:22:40,780 --> 00:22:45,960
think I'm already covered as him<font color="#E5E5E5"> but</font>

398
00:22:42,669 --> 00:22:48,760
doesn't<font color="#CCCCCC"> matter so just</font><font color="#E5E5E5"> briefly first</font>

399
00:22:45,960 --> 00:22:51,190
<font color="#E5E5E5">it's loading the cute main boot kit</font>

400
00:22:48,760 --> 00:22:54,460
inside the bias which is<font color="#E5E5E5"> hook they went</font>

401
00:22:51,190 --> 00:22:58,929
then start<font color="#CCCCCC"> the parser for the in</font><font color="#E5E5E5"> DFS and</font>

402
00:22:54,460 --> 00:23:01,480
inject malicious executables for<font color="#CCCCCC"> loading</font>

403
00:22:58,929 --> 00:23:04,780
<font color="#E5E5E5">con separating system levels and it's</font>

404
00:23:01,480 --> 00:23:07,929
pretty<font color="#E5E5E5"> much</font><font color="#CCCCCC"> healed so it's visible</font><font color="#E5E5E5"> but</font>

405
00:23:04,780 --> 00:23:10,450
if you even format your hard<font color="#E5E5E5"> drive it</font>

406
00:23:07,929 --> 00:23:12,610
will<font color="#CCCCCC"> be</font><font color="#E5E5E5"> still there because it infection</font>

407
00:23:10,450 --> 00:23:14,890
inside the bias<font color="#CCCCCC"> it's every time inject</font>

408
00:23:12,610 --> 00:23:17,350
the binaries to the file system<font color="#CCCCCC"> and also</font>

409
00:23:14,890 --> 00:23:19,870
<font color="#E5E5E5">can</font><font color="#CCCCCC"> make some specific lock from user</font>

410
00:23:17,350 --> 00:23:22,889
mode<font color="#CCCCCC"> and you need develop some driver to</font>

411
00:23:19,870 --> 00:23:26,949
unlock<font color="#E5E5E5"> file system for delete</font><font color="#CCCCCC"> this</font>

412
00:23:22,890 --> 00:23:30,490
malicious<font color="#E5E5E5"> treads it's a code from a</font>

413
00:23:26,950 --> 00:23:34,870
liquid<font color="#CCCCCC"> you find point from hacking team</font>

414
00:23:30,490 --> 00:23:37,600
and here you can see the hook for event

415
00:23:34,870 --> 00:23:39,790
<font color="#E5E5E5">which is actually if I went for group</font>

416
00:23:37,600 --> 00:23:43,980
ready to boot<font color="#E5E5E5"> which I mentioned it's</font>

417
00:23:39,790 --> 00:23:43,980
just before<font color="#E5E5E5"> booting Kappa rating system</font>

418
00:23:45,360 --> 00:23:52,270
so and here you can see the list of

419
00:23:49,240 --> 00:23:53,620
operation which is<font color="#E5E5E5"> actually the</font>

420
00:23:52,270 --> 00:23:58,080
malicious driver

421
00:23:53,620 --> 00:23:58,080
<font color="#CCCCCC">Dixey drivers can do with a file system</font>

422
00:23:58,950 --> 00:24:08,530
and also<font color="#E5E5E5"> here</font><font color="#CCCCCC"> are the names and paths</font>

423
00:24:03,250 --> 00:24:12,730
where binaries would be inject for<font color="#E5E5E5"> a</font>

424
00:24:08,530 --> 00:24:17,070
<font color="#CCCCCC">startup</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> a auto start with</font><font color="#E5E5E5"> booted</font>

425
00:24:12,730 --> 00:24:19,780
operating system<font color="#E5E5E5"> and here is actually</font>

426
00:24:17,070 --> 00:24:21,610
<font color="#CCCCCC">screenshot of the slide from</font><font color="#E5E5E5"> liquid</font>

427
00:24:19,780 --> 00:24:26,190
information<font color="#E5E5E5"> from hacking team and you</font>

428
00:24:21,610 --> 00:24:26,189
can see actually<font color="#E5E5E5"> here is nothing</font><font color="#CCCCCC"> about</font>

429
00:24:26,910 --> 00:24:34,750
exploitable vulnerability installation

430
00:24:29,669 --> 00:24:38,169
<font color="#CCCCCC">they really count of physical access</font>

431
00:24:34,750 --> 00:24:40,510
which<font color="#CCCCCC"> is actually a point</font><font color="#E5E5E5"> as thinking in</font>

432
00:24:38,169 --> 00:24:44,080
the way it can be<font color="#E5E5E5"> some targeted attacks</font>

433
00:24:40,510 --> 00:24:46,770
and but to be honest it's pretty simple

434
00:24:44,080 --> 00:24:51,649
rootkit<font color="#E5E5E5"> even the in DFS parser</font><font color="#CCCCCC"> it's</font>

435
00:24:46,770 --> 00:24:56,700
use some opens of<font color="#CCCCCC"> open-source software</font>

436
00:24:51,650 --> 00:25:00,570
but<font color="#E5E5E5"> also in the past it was discovered</font>

437
00:24:56,700 --> 00:25:02,580
some information<font color="#CCCCCC"> about most complex more</font>

438
00:25:00,570 --> 00:25:07,710
complex but<font color="#E5E5E5"> for</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> legacy</font><font color="#CCCCCC"> virus</font>

439
00:25:02,580 --> 00:25:10,320
<font color="#E5E5E5">implants and dirty bouncer</font><font color="#CCCCCC"> it's just</font>

440
00:25:07,710 --> 00:25:12,390
like liquid information and binaries is

441
00:25:10,320 --> 00:25:17,280
not available<font color="#E5E5E5"> but it's still very</font>

442
00:25:12,390 --> 00:25:21,600
interesting because this particular

443
00:25:17,280 --> 00:25:25,410
infection implant<font color="#CCCCCC"> working for Dell or H</font>

444
00:25:21,600 --> 00:25:29,669
and you can see here is like specific

445
00:25:25,410 --> 00:25:34,590
<font color="#CCCCCC">SMM execution stage mentioned</font><font color="#E5E5E5"> on this</font>

446
00:25:29,670 --> 00:25:38,070
document<font color="#CCCCCC"> let's assume how</font><font color="#E5E5E5"> it's worked</font>

447
00:25:34,590 --> 00:25:40,379
<font color="#CCCCCC">based</font><font color="#E5E5E5"> on this information</font><font color="#CCCCCC"> we have some</font>

448
00:25:38,070 --> 00:25:48,419
dropper<font color="#CCCCCC"> which is actually communicating</font>

449
00:25:40,380 --> 00:25:50,880
<font color="#CCCCCC">with</font><font color="#E5E5E5"> system firmware and we have some</font>

450
00:25:48,420 --> 00:25:54,440
malicious SMI handler inside the<font color="#CCCCCC"> bias</font>

451
00:25:50,880 --> 00:25:57,540
<font color="#E5E5E5">and actually this is my handler patch</font>

452
00:25:54,440 --> 00:26:02,130
<font color="#E5E5E5">specifically OS kernel and that inject</font>

453
00:25:57,540 --> 00:26:07,440
malicious model<font color="#E5E5E5"> it's offical</font><font color="#CCCCCC"> II this</font>

454
00:26:02,130 --> 00:26:11,310
<font color="#E5E5E5">implant was confirmed by another league</font>

455
00:26:07,440 --> 00:26:13,950
from<font color="#E5E5E5"> equation from shadow workers group</font>

456
00:26:11,310 --> 00:26:17,570
with information<font color="#CCCCCC"> about the equation</font>

457
00:26:13,950 --> 00:26:23,250
<font color="#E5E5E5">group implant and here is a specific</font>

458
00:26:17,570 --> 00:26:26,370
<font color="#E5E5E5">implant for Cisco routers but what is</font>

459
00:26:23,250 --> 00:26:29,310
<font color="#CCCCCC">most</font><font color="#E5E5E5"> interesting</font><font color="#CCCCCC"> part here we can</font>

460
00:26:26,370 --> 00:26:31,649
actually have a binaries for more deeper

461
00:26:29,310 --> 00:26:35,340
analysis because it's<font color="#E5E5E5"> leaked this</font>

462
00:26:31,650 --> 00:26:39,570
archive<font color="#E5E5E5"> of information and we</font><font color="#CCCCCC"> can see</font>

463
00:26:35,340 --> 00:26:42,120
some<font color="#E5E5E5"> common</font><font color="#CCCCCC"> - with XML format</font><font color="#E5E5E5"> from since</font>

464
00:26:39,570 --> 00:26:45,210
its<font color="#E5E5E5"> handles server for</font><font color="#CCCCCC"> install the</font>

465
00:26:42,120 --> 00:26:49,469
malicious implant<font color="#E5E5E5"> and also here is the</font>

466
00:26:45,210 --> 00:26:53,610
import table of the drug<font color="#CCCCCC"> are for in fact</font>

467
00:26:49,470 --> 00:26:56,029
the system<font color="#E5E5E5"> it's the compiled</font><font color="#CCCCCC"> code of</font>

468
00:26:53,610 --> 00:26:59,738
mine routine for

469
00:26:56,029 --> 00:27:02,059
<font color="#CCCCCC">bias infection into</font><font color="#E5E5E5"> the Cisco router and</font>

470
00:26:59,739 --> 00:27:04,820
actually it's very<font color="#CCCCCC"> interesting because</font>

471
00:27:02,059 --> 00:27:08,239
it's very<font color="#E5E5E5"> carefully check the</font><font color="#CCCCCC"> version</font>

472
00:27:04,820 --> 00:27:11,149
check the updates inside the image

473
00:27:08,239 --> 00:27:17,259
everything<font color="#CCCCCC"> and take care</font><font color="#E5E5E5"> to choose very</font>

474
00:27:11,149 --> 00:27:20,418
<font color="#E5E5E5">carefully right implant for</font><font color="#CCCCCC"> the bias and</font>

475
00:27:17,259 --> 00:27:22,309
also I<font color="#E5E5E5"> don't know it's essentially or</font>

476
00:27:20,419 --> 00:27:25,429
what<font color="#E5E5E5"> it was available a source</font>

477
00:27:22,309 --> 00:27:28,519
information<font color="#CCCCCC"> Oh</font><font color="#E5E5E5"> similar</font><font color="#CCCCCC"> information</font>

478
00:27:25,429 --> 00:27:33,889
inside the<font color="#E5E5E5"> binary and we can see here</font>

479
00:27:28,519 --> 00:27:35,599
the<font color="#E5E5E5"> name of the models which</font><font color="#CCCCCC"> is actually</font>

480
00:27:33,889 --> 00:27:40,879
very<font color="#E5E5E5"> interesting</font><font color="#CCCCCC"> I don't know why it's</font>

481
00:27:35,599 --> 00:27:45,559
here and<font color="#E5E5E5"> it tells a</font><font color="#CCCCCC"> lot about what this</font>

482
00:27:40,879 --> 00:27:48,289
<font color="#CCCCCC">infant doing and this him</font><font color="#E5E5E5"> actually shows</font>

483
00:27:45,559 --> 00:27:52,129
<font color="#E5E5E5">what is this implant modify particularly</font>

484
00:27:48,289 --> 00:27:53,779
<font color="#E5E5E5">I take the screenshot from this report</font>

485
00:27:52,129 --> 00:27:56,209
which is was released by digital

486
00:27:53,779 --> 00:27:59,499
security Russian security<font color="#E5E5E5"> research</font>

487
00:27:56,210 --> 00:28:05,629
company and they did<font color="#CCCCCC"> very well research</font>

488
00:27:59,499 --> 00:28:10,909
for this implant<font color="#E5E5E5"> and we can see actually</font>

489
00:28:05,629 --> 00:28:14,059
malicious<font color="#CCCCCC"> smy was modified</font><font color="#E5E5E5"> and most</font>

490
00:28:10,909 --> 00:28:18,529
interesting<font color="#CCCCCC"> part</font><font color="#E5E5E5"> because actually this</font>

491
00:28:14,059 --> 00:28:20,809
malicious<font color="#CCCCCC"> semi just</font><font color="#E5E5E5"> hook some events and</font>

492
00:28:18,529 --> 00:28:25,249
<font color="#E5E5E5">after that the main point</font><font color="#CCCCCC"> load will be</font>

493
00:28:20,809 --> 00:28:27,320
<font color="#E5E5E5">loads into</font><font color="#CCCCCC"> the system what about</font>

494
00:28:25,249 --> 00:28:34,729
<font color="#CCCCCC">computer eyes who is</font><font color="#E5E5E5"> now what is</font>

495
00:28:27,320 --> 00:28:37,939
<font color="#CCCCCC">complete race is so but you don't know</font>

496
00:28:34,729 --> 00:28:40,129
what I'm<font color="#E5E5E5"> sure like</font><font color="#CCCCCC"> seventy percent of</font>

497
00:28:37,940 --> 00:28:44,989
this room have it on your laptops

498
00:28:40,129 --> 00:28:51,019
<font color="#E5E5E5">because</font><font color="#CCCCCC"> it's leadership software and but</font>

499
00:28:44,989 --> 00:28:53,299
working<font color="#E5E5E5"> as</font><font color="#CCCCCC"> by ASUS him for bias rootkit</font>

500
00:28:51,019 --> 00:28:57,259
infection<font color="#CCCCCC"> this</font><font color="#E5E5E5"> software actually used</font>

501
00:28:53,299 --> 00:29:00,799
for<font color="#CCCCCC"> anti-theft</font><font color="#E5E5E5"> and if you have Lenovo</font>

502
00:28:57,259 --> 00:29:04,099
laptop<font color="#E5E5E5"> all think parts have compute race</font>

503
00:29:00,799 --> 00:29:07,639
for anti-theft activation for enterprise

504
00:29:04,099 --> 00:29:08,750
networks<font color="#CCCCCC"> if you want but this software</font>

505
00:29:07,639 --> 00:29:12,770
<font color="#CCCCCC">actually</font>

506
00:29:08,750 --> 00:29:15,290
works specifically like hacking team

507
00:29:12,770 --> 00:29:18,290
rootkit yeah it's part of the file

508
00:29:15,290 --> 00:29:24,379
system<font color="#CCCCCC"> it's injected</font><font color="#E5E5E5"> binaries inside the</font>

509
00:29:18,290 --> 00:29:27,860
memory<font color="#E5E5E5"> and then loads so and it's</font>

510
00:29:24,380 --> 00:29:31,520
actually the image of my Lenovo<font color="#CCCCCC"> laptop</font>

511
00:29:27,860 --> 00:29:36,439
and you can see here the<font color="#E5E5E5"> Dixit drivers</font>

512
00:29:31,520 --> 00:29:40,910
which is<font color="#E5E5E5"> so compute race models inside</font>

513
00:29:36,440 --> 00:29:43,580
my image<font color="#CCCCCC"> but ok what is in operating</font>

514
00:29:40,910 --> 00:29:47,870
<font color="#E5E5E5">system level you can check</font><font color="#CCCCCC"> actually it's</font>

515
00:29:43,580 --> 00:29:50,449
<font color="#CCCCCC">everytime visible in process manager but</font>

516
00:29:47,870 --> 00:29:53,330
probably<font color="#E5E5E5"> you should use</font><font color="#CCCCCC"> some more</font>

517
00:29:50,450 --> 00:29:55,730
advanced process viewer for that<font color="#E5E5E5"> yeah</font>

518
00:29:53,330 --> 00:30:01,189
and here is the name of<font color="#CCCCCC"> the models which</font>

519
00:29:55,730 --> 00:30:08,630
<font color="#CCCCCC">is appears</font><font color="#E5E5E5"> if your computer a software</font>

520
00:30:01,190 --> 00:30:13,600
is active and here is scheme how it's

521
00:30:08,630 --> 00:30:17,870
worked<font color="#CCCCCC"> so we have inside the firmware</font>

522
00:30:13,600 --> 00:30:21,439
<font color="#E5E5E5">few</font><font color="#CCCCCC"> Dixit drivers which</font><font color="#E5E5E5"> is one just for</font>

523
00:30:17,870 --> 00:30:25,209
enable compute<font color="#E5E5E5"> race and then it's loads</font>

524
00:30:21,440 --> 00:30:29,290
<font color="#E5E5E5">Lenovo computer is loader Dixit</font><font color="#CCCCCC"> then</font>

525
00:30:25,210 --> 00:30:33,650
<font color="#E5E5E5">it's specific installer will be runs and</font>

526
00:30:29,290 --> 00:30:36,379
inject to the file<font color="#CCCCCC"> system the</font><font color="#E5E5E5"> binary</font>

527
00:30:33,650 --> 00:30:39,050
models and executed on<font color="#E5E5E5"> operating system</font>

528
00:30:36,380 --> 00:30:41,210
level<font color="#CCCCCC"> and it will be also communicating</font>

529
00:30:39,050 --> 00:30:44,450
with specific computer<font color="#CCCCCC"> 8</font><font color="#E5E5E5"> servers for</font>

530
00:30:41,210 --> 00:30:52,490
track your machine but it's again it's

531
00:30:44,450 --> 00:30:55,160
<font color="#CCCCCC">anti-theft software yeah</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> and switch</font><font color="#E5E5E5"> a</font>

532
00:30:52,490 --> 00:30:58,910
little<font color="#CCCCCC"> bit to the BIOS updates</font><font color="#E5E5E5"> issues</font>

533
00:30:55,160 --> 00:31:06,440
<font color="#E5E5E5">how many people recently update your</font>

534
00:30:58,910 --> 00:31:10,550
<font color="#CCCCCC">wires so not a</font><font color="#E5E5E5"> lot and it's</font><font color="#CCCCCC"> very</font>

535
00:31:06,440 --> 00:31:12,800
important by<font color="#CCCCCC"> the</font><font color="#E5E5E5"> way because on the end</font>

536
00:31:10,550 --> 00:31:15,350
I<font color="#E5E5E5"> will</font><font color="#CCCCCC"> be mentioned some recently posted</font>

537
00:31:12,800 --> 00:31:16,250
<font color="#CCCCCC">information about very interesting issue</font>

538
00:31:15,350 --> 00:31:18,709
<font color="#CCCCCC">disk are</font>

539
00:31:16,250 --> 00:31:23,180
by<font color="#CCCCCC"> meeting Alex you are also known as</font>

540
00:31:18,710 --> 00:31:23,990
crash<font color="#CCCCCC"> today and it's very important</font><font color="#E5E5E5"> to</font>

541
00:31:23,180 --> 00:31:27,860
<font color="#CCCCCC">update your</font><font color="#E5E5E5"> BIOS</font>

542
00:31:23,990 --> 00:31:30,890
it's not<font color="#E5E5E5"> helps too much but it counts</font>

543
00:31:27,860 --> 00:31:33,379
<font color="#E5E5E5">about the known issues some</font><font color="#CCCCCC"> of them</font><font color="#E5E5E5"> but</font>

544
00:31:30,890 --> 00:31:37,040
the main<font color="#CCCCCC"> problem we have a</font><font color="#E5E5E5"> lot of</font>

545
00:31:33,380 --> 00:31:39,860
different<font color="#E5E5E5"> bias vendors but so we have a</font>

546
00:31:37,040 --> 00:31:42,500
lot<font color="#CCCCCC"> of hardware vendors and all of them</font>

547
00:31:39,860 --> 00:31:46,719
based on different code<font color="#CCCCCC"> bases most</font>

548
00:31:42,500 --> 00:31:50,740
<font color="#E5E5E5">actually common it's american megatrends</font>

549
00:31:46,720 --> 00:31:56,360
<font color="#CCCCCC">but it's also</font><font color="#E5E5E5"> exist the phoenix bias and</font>

550
00:31:50,740 --> 00:31:59,450
<font color="#E5E5E5">inside software and all of these systems</font>

551
00:31:56,360 --> 00:32:02,060
<font color="#E5E5E5">actually patch it in the different time</font>

552
00:31:59,450 --> 00:32:07,370
frames<font color="#E5E5E5"> and also have different updaters</font>

553
00:32:02,060 --> 00:32:11,780
and as example just if you who knows

554
00:32:07,370 --> 00:32:16,729
what is device guard<font color="#CCCCCC"> okay device guard</font>

555
00:32:11,780 --> 00:32:21,080
<font color="#CCCCCC">its</font><font color="#E5E5E5"> new security feature on enterprise</font>

556
00:32:16,730 --> 00:32:24,890
<font color="#E5E5E5">Windows 10 versions which is make</font>

557
00:32:21,080 --> 00:32:27,530
available<font color="#E5E5E5"> some specific</font><font color="#CCCCCC"> virtual</font><font color="#E5E5E5"> security</font>

558
00:32:24,890 --> 00:32:31,010
<font color="#E5E5E5">mode and also make specific policies to</font>

559
00:32:27,530 --> 00:32:34,399
load<font color="#E5E5E5"> kernel mode drivers and as example</font>

560
00:32:31,010 --> 00:32:37,550
it's<font color="#E5E5E5"> just</font><font color="#CCCCCC"> rezoned</font><font color="#E5E5E5"> update which is was</font>

561
00:32:34,400 --> 00:32:40,940
released on the<font color="#CCCCCC"> last week by Lenovo</font><font color="#E5E5E5"> and</font>

562
00:32:37,550 --> 00:32:44,659
if you run<font color="#E5E5E5"> this update tool you will</font>

563
00:32:40,940 --> 00:32:48,050
because the blue screen with active

564
00:32:44,660 --> 00:32:50,510
device guard<font color="#E5E5E5"> but here is no like</font>

565
00:32:48,050 --> 00:32:52,550
specific issues and vulnerabilities<font color="#CCCCCC"> is</font>

566
00:32:50,510 --> 00:32:54,850
just because the driver of updater<font color="#E5E5E5"> it's</font>

567
00:32:52,550 --> 00:32:57,649
not<font color="#CCCCCC"> follow</font><font color="#E5E5E5"> the device guard policies and</font>

568
00:32:54,850 --> 00:33:01,219
just make a blue screen<font color="#CCCCCC"> onto your</font><font color="#E5E5E5"> system</font>

569
00:32:57,650 --> 00:33:03,380
because of<font color="#CCCCCC"> that and here's some</font>

570
00:33:01,220 --> 00:33:06,830
collision because device guard was

571
00:33:03,380 --> 00:33:09,890
developed for your<font color="#CCCCCC"> make your</font><font color="#E5E5E5"> system more</font>

572
00:33:06,830 --> 00:33:12,320
secure<font color="#E5E5E5"> into enterprise networks and if</font>

573
00:33:09,890 --> 00:33:14,080
you try as admin to update your bias<font color="#CCCCCC"> it</font>

574
00:33:12,320 --> 00:33:20,899
will be blue screen<font color="#CCCCCC"> over</font><font color="#E5E5E5"> your network</font>

575
00:33:14,080 --> 00:33:22,939
<font color="#E5E5E5">yeah it's some funny fact okay let's</font>

576
00:33:20,900 --> 00:33:27,490
discuss<font color="#E5E5E5"> about some forensic approaches</font>

577
00:33:22,940 --> 00:33:27,490
what we can do with good or bad bias

578
00:33:27,670 --> 00:33:34,130
so you can follow the software way<font color="#E5E5E5"> to</font>

579
00:33:31,910 --> 00:33:35,780
<font color="#E5E5E5">dump and research the vulnerabilities</font>

580
00:33:34,130 --> 00:33:38,090
inside the system<font color="#E5E5E5"> and they can suggest</font>

581
00:33:35,780 --> 00:33:43,180
<font color="#E5E5E5">the software like</font><font color="#CCCCCC"> chip sack</font><font color="#E5E5E5"> it's</font>

582
00:33:38,090 --> 00:33:47,230
actually one<font color="#CCCCCC"> of</font><font color="#E5E5E5"> most known</font><font color="#CCCCCC"> - for</font>

583
00:33:43,180 --> 00:33:50,810
vulnerability assessment and security

584
00:33:47,230 --> 00:33:54,310
assessment for the<font color="#CCCCCC"> bias and</font><font color="#E5E5E5"> also you can</font>

585
00:33:50,810 --> 00:33:57,740
dump with<font color="#E5E5E5"> chip sex by flash image but</font>

586
00:33:54,310 --> 00:33:59,480
<font color="#E5E5E5">you should remember</font><font color="#CCCCCC"> if you already have</font>

587
00:33:57,740 --> 00:34:02,540
a persistent<font color="#E5E5E5"> rootkit inside your</font>

588
00:33:59,480 --> 00:34:05,600
firmware<font color="#E5E5E5"> it doesn't mean if you saw in</font>

589
00:34:02,540 --> 00:34:08,540
software will be<font color="#CCCCCC"> dumped</font><font color="#E5E5E5"> your spy flash</font>

590
00:34:05,600 --> 00:34:12,139
image it will be<font color="#E5E5E5"> real spy image of your</font>

591
00:34:08,540 --> 00:34:15,259
machine<font color="#E5E5E5"> it can be some fake also you can</font>

592
00:34:12,139 --> 00:34:19,790
dump all information about secure boot

593
00:34:15,260 --> 00:34:21,919
and also you can check variables and a

594
00:34:19,790 --> 00:34:26,509
lot<font color="#CCCCCC"> of</font><font color="#E5E5E5"> different things</font><font color="#CCCCCC"> which is where</font>

595
00:34:21,918 --> 00:34:28,850
it helps<font color="#E5E5E5"> for forensic investigations but</font>

596
00:34:26,510 --> 00:34:32,690
<font color="#E5E5E5">let's</font><font color="#CCCCCC"> discuss a little</font><font color="#E5E5E5"> bit how</font><font color="#CCCCCC"> you can</font>

597
00:34:28,850 --> 00:34:35,000
dump spy flash<font color="#E5E5E5"> image in software so</font>

598
00:34:32,690 --> 00:34:38,179
usually you need access to spy<font color="#E5E5E5"> flash</font>

599
00:34:35,000 --> 00:34:41,239
controller with some specific memory

600
00:34:38,179 --> 00:34:44,840
regions<font color="#E5E5E5"> so usually you need to access</font>

601
00:34:41,239 --> 00:34:48,939
<font color="#E5E5E5">for</font><font color="#CCCCCC"> region spy bar</font><font color="#E5E5E5"> flash memory inside</font>

602
00:34:44,840 --> 00:34:52,850
<font color="#E5E5E5">the normal memory regions and then</font>

603
00:34:48,940 --> 00:34:55,220
actually here is the way how software

604
00:34:52,850 --> 00:34:59,299
with<font color="#CCCCCC"> reader as examples</font><font color="#E5E5E5"> chipset during</font>

605
00:34:55,219 --> 00:35:02,000
the kernel<font color="#CCCCCC"> mode driver reads send</font>

606
00:34:59,300 --> 00:35:05,660
<font color="#E5E5E5">request to spy controller and try to</font>

607
00:35:02,000 --> 00:35:12,670
read<font color="#E5E5E5"> figure out to read its spy flash</font>

608
00:35:05,660 --> 00:35:12,670
<font color="#E5E5E5">image main thing all this</font><font color="#CCCCCC"> red</font>

609
00:35:14,770 --> 00:35:23,619
highlighted by<font color="#E5E5E5"> red regions can be faked</font>

610
00:35:18,580 --> 00:35:25,990
by<font color="#CCCCCC"> firmware rootkit and if you already</font>

611
00:35:23,619 --> 00:35:32,800
<font color="#E5E5E5">have a</font><font color="#CCCCCC"> persistent infection it's very</font>

612
00:35:25,990 --> 00:35:35,740
<font color="#E5E5E5">difficult to get real information yeah</font>

613
00:35:32,800 --> 00:35:38,830
it's actually<font color="#CCCCCC"> helped</font><font color="#E5E5E5"> attack your fake</font>

614
00:35:35,740 --> 00:35:42,368
<font color="#E5E5E5">which kind of hardware requests to the</font>

615
00:35:38,830 --> 00:35:44,950
spy controller and you will be get the

616
00:35:42,369 --> 00:35:48,970
spy image in the end but it will be not

617
00:35:44,950 --> 00:35:52,140
<font color="#E5E5E5">real what we can do here it's actually</font>

618
00:35:48,970 --> 00:35:55,560
<font color="#CCCCCC">good</font><font color="#E5E5E5"> question but of</font><font color="#CCCCCC"> course people</font><font color="#E5E5E5"> who</font>

619
00:35:52,140 --> 00:35:58,930
<font color="#CCCCCC">working with the system firmware it's</font>

620
00:35:55,560 --> 00:36:02,470
will be<font color="#E5E5E5"> point us to some hardware</font>

621
00:35:58,930 --> 00:36:05,830
programmers and<font color="#E5E5E5"> you</font><font color="#CCCCCC"> write guys but what</font>

622
00:36:02,470 --> 00:36:08,350
we have<font color="#CCCCCC"> other Hardware programmers it's</font>

623
00:36:05,830 --> 00:36:12,009
a<font color="#E5E5E5"> bad</font><font color="#CCCCCC"> pilot</font><font color="#E5E5E5"> it's good</font><font color="#CCCCCC"> friend</font><font color="#E5E5E5"> but it will</font>

624
00:36:08,350 --> 00:36:16,569
be<font color="#E5E5E5"> very slow because you</font><font color="#CCCCCC"> will be read</font>

625
00:36:12,010 --> 00:36:19,390
<font color="#E5E5E5">like nine Giga megabytes of spy flash</font>

626
00:36:16,570 --> 00:36:22,210
memory<font color="#E5E5E5"> and it will be took like in</font>

627
00:36:19,390 --> 00:36:24,368
<font color="#CCCCCC">routine</font><font color="#E5E5E5"> maybe 5-10 minutes but if you</font>

628
00:36:22,210 --> 00:36:27,580
dump a lot<font color="#E5E5E5"> of machines it's took a while</font>

629
00:36:24,369 --> 00:36:28,240
or frequently<font color="#E5E5E5"> you</font><font color="#CCCCCC"> will have different</font>

630
00:36:27,580 --> 00:36:31,900
<font color="#E5E5E5">one</font>

631
00:36:28,240 --> 00:36:34,410
<font color="#E5E5E5">so this program or DD proc which I</font>

632
00:36:31,900 --> 00:36:37,180
<font color="#CCCCCC">suggest in the use in my work</font><font color="#E5E5E5"> it's</font>

633
00:36:34,410 --> 00:36:41,259
actually automatically recognized<font color="#E5E5E5"> the</font>

634
00:36:37,180 --> 00:36:46,210
spy<font color="#CCCCCC"> flash pins for the power and</font><font color="#E5E5E5"> also</font>

635
00:36:41,260 --> 00:36:48,850
data and<font color="#E5E5E5"> I have forgot</font><font color="#CCCCCC"> to mention here</font>

636
00:36:46,210 --> 00:36:50,500
is<font color="#CCCCCC"> a</font><font color="#E5E5E5"> problem also with these tools</font>

637
00:36:48,850 --> 00:36:54,220
because you should know the

638
00:36:50,500 --> 00:36:56,859
specification of the<font color="#E5E5E5"> pins map for your</font>

639
00:36:54,220 --> 00:36:59,290
specific spy controller before<font color="#CCCCCC"> you</font>

640
00:36:56,859 --> 00:37:01,960
connect because<font color="#E5E5E5"> if you connect randomly</font>

641
00:36:59,290 --> 00:37:04,270
<font color="#E5E5E5">if you connect power to the data then</font>

642
00:37:01,960 --> 00:37:07,810
you will be just burn your<font color="#CCCCCC"> flashing spy</font>

643
00:37:04,270 --> 00:37:11,290
flash controller<font color="#CCCCCC"> or controller chip and</font>

644
00:37:07,810 --> 00:37:15,700
destroy actually opportunity to access

645
00:37:11,290 --> 00:37:20,230
to them and<font color="#E5E5E5"> also one of the cheap and</font>

646
00:37:15,700 --> 00:37:21,618
good ways<font color="#E5E5E5"> it's was presented by</font><font color="#CCCCCC"> Trammell</font>

647
00:37:20,230 --> 00:37:25,859
Hudson

648
00:37:21,619 --> 00:37:29,099
it's teensy board with some are<font color="#CCCCCC"> doing a</font>

649
00:37:25,859 --> 00:37:31,859
micro program if you will<font color="#E5E5E5"> be actually</font>

650
00:37:29,099 --> 00:37:37,890
<font color="#CCCCCC">keen cu5 firmware down google it you</font>

651
00:37:31,859 --> 00:37:39,900
<font color="#CCCCCC">found some sketch for for them but it</font>

652
00:37:37,890 --> 00:37:43,470
will<font color="#E5E5E5"> be not recognized automatically the</font>

653
00:37:39,900 --> 00:37:47,910
pins which you should every time to care

654
00:37:43,470 --> 00:37:51,419
just<font color="#CCCCCC"> for reversing you can use either</font><font color="#E5E5E5"> to</font>

655
00:37:47,910 --> 00:37:54,569
connect remotely for<font color="#CCCCCC"> eq mo</font><font color="#E5E5E5"> gdb and use</font>

656
00:37:51,420 --> 00:37:59,119
<font color="#CCCCCC">coreboot bias for</font><font color="#E5E5E5"> us example inject</font>

657
00:37:54,569 --> 00:38:03,960
possibly malicious<font color="#CCCCCC"> Dixit driver</font><font color="#E5E5E5"> and also</font>

658
00:37:59,119 --> 00:38:06,150
the problem is<font color="#E5E5E5"> all the platforms is</font>

659
00:38:03,960 --> 00:38:08,309
different and if<font color="#CCCCCC"> you have some</font><font color="#E5E5E5"> hardware</font>

660
00:38:06,150 --> 00:38:10,770
<font color="#E5E5E5">specifics and your</font><font color="#CCCCCC"> Dixit driver</font><font color="#E5E5E5"> use you</font>

661
00:38:08,309 --> 00:38:16,250
want<font color="#E5E5E5"> to be the back here it will be</font>

662
00:38:10,770 --> 00:38:20,220
problem<font color="#E5E5E5"> so we can use some really</font>

663
00:38:16,250 --> 00:38:23,339
expensive<font color="#E5E5E5"> tools like simulator from</font><font color="#CCCCCC"> Wind</font>

664
00:38:20,220 --> 00:38:26,160
<font color="#E5E5E5">River simek's which is can emulate</font>

665
00:38:23,339 --> 00:38:28,619
<font color="#E5E5E5">hardware and if you can provide</font><font color="#CCCCCC"> the</font>

666
00:38:26,160 --> 00:38:31,440
<font color="#E5E5E5">right configuration you possibly can</font>

667
00:38:28,619 --> 00:38:35,690
emulate<font color="#E5E5E5"> any of PC hardware for at the</font>

668
00:38:31,440 --> 00:38:43,530
<font color="#CCCCCC">moment but it's kind of expensive</font>

669
00:38:35,690 --> 00:38:45,990
<font color="#CCCCCC">$15,000 so other way</font><font color="#E5E5E5"> it's</font><font color="#CCCCCC"> minor</font><font color="#E5E5E5"> word max</font>

670
00:38:43,530 --> 00:38:50,790
which is<font color="#CCCCCC"> opened</font><font color="#E5E5E5"> hardware and open source</font>

671
00:38:45,990 --> 00:38:57,058
bias and it's pretty much cheap solution

672
00:38:50,790 --> 00:39:02,579
<font color="#CCCCCC">it's $130 but you can try</font><font color="#E5E5E5"> to debug with</font>

673
00:38:57,059 --> 00:39:04,829
<font color="#CCCCCC">them with the serial who art and you can</font>

674
00:39:02,579 --> 00:39:06,780
get all the<font color="#E5E5E5"> bug messages for the</font><font color="#CCCCCC"> buyers</font>

675
00:39:04,829 --> 00:39:09,569
and if you don't need<font color="#E5E5E5"> some hardware</font>

676
00:39:06,780 --> 00:39:11,309
specifics here you can use this board

677
00:39:09,569 --> 00:39:13,558
and also<font color="#CCCCCC"> this</font><font color="#E5E5E5"> board very interesting</font>

678
00:39:11,309 --> 00:39:16,140
because the latest version of firmware

679
00:39:13,559 --> 00:39:19,410
<font color="#E5E5E5">have</font><font color="#CCCCCC"> Verto TPM inside and you can then</font>

680
00:39:16,140 --> 00:39:21,690
run on Windows 10 as example<font color="#E5E5E5"> Verto</font>

681
00:39:19,410 --> 00:39:23,640
secure mode and device guard and play

682
00:39:21,690 --> 00:39:25,710
something<font color="#CCCCCC"> from firmware because</font><font color="#E5E5E5"> it's</font>

683
00:39:23,640 --> 00:39:30,900
open source<font color="#CCCCCC"> just</font><font color="#E5E5E5"> some hints for</font>

684
00:39:25,710 --> 00:39:32,890
directions<font color="#E5E5E5"> and my new board also have a</font>

685
00:39:30,900 --> 00:39:35,010
g'tok<font color="#E5E5E5"> heater but</font><font color="#CCCCCC"> it's specific</font>

686
00:39:32,890 --> 00:39:40,480
<font color="#E5E5E5">like Heder notice which</font><font color="#CCCCCC"> is normally</font>

687
00:39:35,010 --> 00:39:44,140
known in arm upwards<font color="#CCCCCC"> its</font><font color="#E5E5E5"> Intel</font><font color="#CCCCCC"> XDP</font>

688
00:39:40,480 --> 00:39:47,470
<font color="#CCCCCC">header</font><font color="#E5E5E5"> and the card where debugger for</font>

689
00:39:44,140 --> 00:39:53,020
this specific<font color="#CCCCCC"> g'tok it's very very</font>

690
00:39:47,470 --> 00:39:53,830
<font color="#CCCCCC">expensive so</font><font color="#E5E5E5"> this tools it's too</font>

691
00:39:53,020 --> 00:39:57,040
<font color="#CCCCCC">different</font>

692
00:39:53,830 --> 00:40:00,279
so this both of<font color="#CCCCCC"> this its</font><font color="#E5E5E5"> Intel</font><font color="#CCCCCC"> Developer</font>

693
00:39:57,040 --> 00:40:05,710
<font color="#CCCCCC">G</font><font color="#E5E5E5"> tags and this one</font><font color="#CCCCCC"> it's developed but</font>

694
00:40:00,280 --> 00:40:08,410
company asset and this one it's very

695
00:40:05,710 --> 00:40:10,090
interesting<font color="#E5E5E5"> because I don't need the</font>

696
00:40:08,410 --> 00:40:13,750
<font color="#E5E5E5">port inside the board</font>

697
00:40:10,090 --> 00:40:16,360
it's just need actually new<font color="#CCCCCC"> skylake</font>

698
00:40:13,750 --> 00:40:20,730
because USB debugging start supported

699
00:40:16,360 --> 00:40:24,580
from<font color="#CCCCCC"> Skyway but you need active debug</font>

700
00:40:20,730 --> 00:40:26,980
platform for users<font color="#CCCCCC"> though</font><font color="#E5E5E5"> what it also</font>

701
00:40:24,580 --> 00:40:34,360
can<font color="#CCCCCC"> be configured</font><font color="#E5E5E5"> in some form well I</font>

702
00:40:26,980 --> 00:40:36,670
assume and then you can make a<font color="#E5E5E5"> break</font>

703
00:40:34,360 --> 00:40:39,310
point during as example<font color="#CCCCCC"> interval system</font>

704
00:40:36,670 --> 00:40:42,490
debugger which is software common

705
00:40:39,310 --> 00:40:45,640
software<font color="#E5E5E5"> for that on</font><font color="#CCCCCC"> SMM</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> rukon all</font>

706
00:40:42,490 --> 00:40:51,279
is my hand layers of all all the list of

707
00:40:45,640 --> 00:40:53,410
<font color="#E5E5E5">my handlers so I</font><font color="#CCCCCC"> think I pretty much out</font>

708
00:40:51,280 --> 00:40:56,970
of the<font color="#CCCCCC"> time and they will be just</font><font color="#E5E5E5"> drop</font>

709
00:40:53,410 --> 00:41:02,069
<font color="#CCCCCC">few words about EFI firmware mitigations</font>

710
00:40:56,970 --> 00:41:05,109
so it's not too<font color="#E5E5E5"> much from the casual</font>

711
00:41:02,070 --> 00:41:06,790
generation of Intel CPUs was released

712
00:41:05,110 --> 00:41:09,150
into<font color="#E5E5E5"> a good guard which</font><font color="#CCCCCC"> is mainly</font>

713
00:41:06,790 --> 00:41:17,290
<font color="#CCCCCC">armored at the secure boot scheme and</font>

714
00:41:09,150 --> 00:41:20,590
other way it's<font color="#CCCCCC"> ok so and Intel BIOS</font>

715
00:41:17,290 --> 00:41:23,230
guard<font color="#E5E5E5"> is another mitigation which is</font>

716
00:41:20,590 --> 00:41:26,640
actually<font color="#CCCCCC"> armored at the spy flash</font><font color="#E5E5E5"> from</font>

717
00:41:23,230 --> 00:41:26,640
malicious updates

718
00:41:28,590 --> 00:41:35,550
and actually<font color="#E5E5E5"> I highly recommend you guys</font>

719
00:41:31,770 --> 00:41:39,540
after<font color="#E5E5E5"> this talk follow this link to read</font>

720
00:41:35,550 --> 00:41:44,370
<font color="#E5E5E5">about the</font><font color="#CCCCCC"> exploiting firmware for some</font>

721
00:41:39,540 --> 00:41:47,130
<font color="#E5E5E5">specific hardware and it's very</font>

722
00:41:44,370 --> 00:41:50,040
interesting blog post which is<font color="#E5E5E5"> show some</font>

723
00:41:47,130 --> 00:41:56,100
code execution vulnerability<font color="#E5E5E5"> into</font><font color="#CCCCCC"> SMM</font>

724
00:41:50,040 --> 00:42:00,630
and also show<font color="#CCCCCC"> how many</font><font color="#E5E5E5"> platforms can be</font>

725
00:41:56,100 --> 00:42:06,000
<font color="#E5E5E5">in like attacked by the same issue and</font>

726
00:42:00,630 --> 00:42:10,440
same vendor of fervor<font color="#E5E5E5"> like reference</font>

727
00:42:06,000 --> 00:42:14,670
called<font color="#E5E5E5"> the vendor because mostly all</font><font color="#CCCCCC"> the</font>

728
00:42:10,440 --> 00:42:17,430
hardware developers they develop their

729
00:42:14,670 --> 00:42:19,350
own<font color="#E5E5E5"> firmware but of course not from</font>

730
00:42:17,430 --> 00:42:24,649
scratch and based on some<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the vendors</font>

731
00:42:19,350 --> 00:42:24,650
<font color="#E5E5E5">who just focus it on the bias software</font>

732
00:42:25,490 --> 00:42:35,390
so I'm pretty<font color="#E5E5E5"> much it with my</font>

733
00:42:29,760 --> 00:42:39,990
presentation<font color="#E5E5E5"> and soon we actually</font><font color="#CCCCCC"> assume</font>

734
00:42:35,390 --> 00:42:42,270
not<font color="#E5E5E5"> as some like we trying to release as</font>

735
00:42:39,990 --> 00:42:44,129
fast as we can but<font color="#CCCCCC"> we had some new stuff</font>

736
00:42:42,270 --> 00:42:46,640
about firmware owner abilities and

737
00:42:44,130 --> 00:42:49,260
firmware rotates to<font color="#E5E5E5"> the book and</font>

738
00:42:46,640 --> 00:42:52,770
currently we have<font color="#E5E5E5"> a date for printed</font>

739
00:42:49,260 --> 00:42:54,510
copies it will be<font color="#CCCCCC"> February 2017 this</font>

740
00:42:52,770 --> 00:42:57,060
book with<font color="#CCCCCC"> Sergey brought us a new</font>

741
00:42:54,510 --> 00:43:00,330
<font color="#E5E5E5">generation of it will be about the</font>

742
00:42:57,060 --> 00:43:02,700
<font color="#E5E5E5">reversing of route kids and boot kids</font>

743
00:43:00,330 --> 00:43:07,520
<font color="#E5E5E5">and also some new generation traits</font>

744
00:43:02,700 --> 00:43:11,730
inside the bias<font color="#E5E5E5"> so</font><font color="#CCCCCC"> what's the next and</font>

745
00:43:07,520 --> 00:43:14,030
the next<font color="#CCCCCC"> it would</font><font color="#E5E5E5"> be revisited version</font>

746
00:43:11,730 --> 00:43:17,280
of this research for<font color="#CCCCCC"> zero</font><font color="#E5E5E5"> nights and</font>

747
00:43:14,030 --> 00:43:20,160
also on<font color="#CCCCCC"> zero nights with my colleague</font>

748
00:43:17,280 --> 00:43:23,340
<font color="#CCCCCC">from</font><font color="#E5E5E5"> winter it has a phone of we will be</font>

749
00:43:20,160 --> 00:43:25,529
<font color="#E5E5E5">present some interesting topic and</font>

750
00:43:23,340 --> 00:43:28,550
project excite project which is a

751
00:43:25,530 --> 00:43:30,600
symbolic<font color="#E5E5E5"> execution framework for</font>

752
00:43:28,550 --> 00:43:33,150
vulnerability assessment with SMI

753
00:43:30,600 --> 00:43:34,040
handlers and we will be<font color="#CCCCCC"> discuss</font><font color="#E5E5E5"> how</font><font color="#CCCCCC"> we</font>

754
00:43:33,150 --> 00:43:37,340
<font color="#E5E5E5">can actually</font>

755
00:43:34,040 --> 00:43:43,520
<font color="#E5E5E5">recognize and make a code coverage with</font>

756
00:43:37,340 --> 00:43:46,900
with some scheme which is<font color="#E5E5E5"> mixed some</font>

757
00:43:43,520 --> 00:43:49,190
<font color="#E5E5E5">fuzzing and symbolic execution</font>

758
00:43:46,900 --> 00:43:52,610
<font color="#CCCCCC">specifically</font><font color="#E5E5E5"> can colleague symbolic</font>

759
00:43:49,190 --> 00:43:55,340
execution<font color="#E5E5E5"> and we named this him like a</font>

760
00:43:52,610 --> 00:43:57,230
symbolic execution guided by fastened

761
00:43:55,340 --> 00:44:01,220
<font color="#E5E5E5">and it will be released after</font><font color="#CCCCCC"> zero</font>

762
00:43:57,230 --> 00:44:03,050
<font color="#E5E5E5">nights</font><font color="#CCCCCC"> or you</font><font color="#E5E5E5"> guys invited for coming to</font>

763
00:44:01,220 --> 00:44:09,470
<font color="#CCCCCC">zero night's</font><font color="#E5E5E5"> conference which it will be</font>

764
00:44:03,050 --> 00:44:13,450
next November 17 and<font color="#E5E5E5"> 18 November so</font>

765
00:44:09,470 --> 00:44:13,450
thank you very<font color="#E5E5E5"> much for your attention</font>

766
00:44:14,970 --> 00:44:18,149
[Music]

767
00:44:25,740 --> 00:44:28,740
questions

768
00:44:43,780 --> 00:44:48,470
<font color="#E5E5E5">okay thank you</font><font color="#CCCCCC"> very</font><font color="#E5E5E5"> much it was my</font>

769
00:44:46,910 --> 00:44:52,029
pleasure presenting that second time<font color="#CCCCCC"> I</font>

770
00:44:48,470 --> 00:44:52,029
<font color="#CCCCCC">think it's executive functions</font>

