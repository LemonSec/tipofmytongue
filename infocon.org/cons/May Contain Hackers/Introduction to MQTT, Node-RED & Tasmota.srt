1
00:00:01,280 --> 00:00:12,559
[Music]

2
00:00:14,420 --> 00:00:17,279
maybe you saw the talk before this one

3
00:00:17,279 --> 00:00:19,560
uh with the the Hacked two-year light

4
00:00:19,560 --> 00:00:22,800
those lights actually can talk with the

5
00:00:22,800 --> 00:00:26,279
alternative firmware via mqtt and we can

6
00:00:26,279 --> 00:00:31,080
use this to our advantage and I will go

7
00:00:31,080 --> 00:00:33,120
into that a little bit in this talk and

8
00:00:33,120 --> 00:00:36,420
see how we can build on this

9
00:00:36,420 --> 00:00:38,579
um my name is crazy some people call me

10
00:00:38,579 --> 00:00:41,579
as at or know me just as a because

11
00:00:41,579 --> 00:00:43,500
they're lazy probably I've been

12
00:00:43,500 --> 00:00:46,200
tinkering for years with different stuff

13
00:00:46,200 --> 00:00:49,260
um normal day job involves industrial

14
00:00:49,260 --> 00:00:52,199
Control Systems so it's a bit away from

15
00:00:52,199 --> 00:00:55,199
this but still technical some people

16
00:00:55,199 --> 00:00:56,820
might know me from the angry nudge

17
00:00:56,820 --> 00:00:59,579
podcast and I want to preface I am not

18
00:00:59,579 --> 00:01:03,120
an expert on these subjects but I think

19
00:01:03,120 --> 00:01:04,860
they're awesome and that's why I want to

20
00:01:04,860 --> 00:01:07,260
share them with you today we're going to

21
00:01:07,260 --> 00:01:10,979
see a buildup of three building blocks

22
00:01:10,979 --> 00:01:13,380
to create our entire system and the

23
00:01:13,380 --> 00:01:16,020
first one will be mqtt itself I mean

24
00:01:16,020 --> 00:01:18,119
we've probably seen the term but what

25
00:01:18,119 --> 00:01:20,220
does it stand for it stands for nothing

26
00:01:20,220 --> 00:01:23,600
anymore originally it was called mq

27
00:01:23,600 --> 00:01:26,280
telemetic transport when it was first

28
00:01:26,280 --> 00:01:28,460
developed by IBM

29
00:01:28,460 --> 00:01:31,500
now it's just the four letters and used

30
00:01:31,500 --> 00:01:33,479
like that it's a publish And subscribe

31
00:01:33,479 --> 00:01:36,299
Network transport mechanism it shouldn't

32
00:01:36,299 --> 00:01:38,360
be called a protocol I was corrected

33
00:01:38,360 --> 00:01:41,700
just after I finished the slide so there

34
00:01:41,700 --> 00:01:43,680
there is some protocol reference in

35
00:01:43,680 --> 00:01:46,079
there it's a transport and not a

36
00:01:46,079 --> 00:01:49,740
protocol per se as it's it's unaware of

37
00:01:49,740 --> 00:01:52,619
the data it is carrying

38
00:01:52,619 --> 00:01:54,780
um it's a a system where you have one

39
00:01:54,780 --> 00:01:56,640
broker one Central server where

40
00:01:56,640 --> 00:01:59,040
everything connects to just using one

41
00:01:59,040 --> 00:02:01,560
simple TCP Port so on a network it's

42
00:02:01,560 --> 00:02:05,219
very easy to route a firewall there are

43
00:02:05,219 --> 00:02:07,340
authentication and SSL Support

44
00:02:07,340 --> 00:02:10,258
options but I'm not using it in this

45
00:02:10,258 --> 00:02:12,200
demo because that would be too

46
00:02:12,200 --> 00:02:14,760
complicated and convoluted for this

47
00:02:14,760 --> 00:02:17,400
short time like I said it was developed

48
00:02:17,400 --> 00:02:22,020
by IBM and development started in 99 it

49
00:02:22,020 --> 00:02:25,200
was an internal development for use in

50
00:02:25,200 --> 00:02:26,520
Pipelines

51
00:02:26,520 --> 00:02:28,319
to communicate all the status

52
00:02:28,319 --> 00:02:30,660
information along the pipeline it had to

53
00:02:30,660 --> 00:02:32,519
be lightweight it had to use very little

54
00:02:32,519 --> 00:02:35,220
power very little CPU power and

55
00:02:35,220 --> 00:02:37,680
bandwidth but it had to have some

56
00:02:37,680 --> 00:02:40,560
guarantees for data delivery and there

57
00:02:40,560 --> 00:02:43,920
is a qos built in in three levels where

58
00:02:43,920 --> 00:02:48,060
we come through come to later and in

59
00:02:48,060 --> 00:02:51,180
2010 which is a quite a while after its

60
00:02:51,180 --> 00:02:54,120
initial release version 3.1 was released

61
00:02:54,120 --> 00:02:57,000
royalty free to the public and that was

62
00:02:57,000 --> 00:03:00,560
when we first were introduced to it and

63
00:03:00,560 --> 00:03:05,760
it has slowly been well it became part

64
00:03:05,760 --> 00:03:08,340
of the standard iot and home automation

65
00:03:08,340 --> 00:03:12,540
Suite I think in 2014 we had a little

66
00:03:12,540 --> 00:03:16,140
update with the 311 version and that is

67
00:03:16,140 --> 00:03:18,540
the one we usually see supported in our

68
00:03:18,540 --> 00:03:21,060
devices and our libraries if not the

69
00:03:21,060 --> 00:03:23,099
version 5 that was released in 2019

70
00:03:23,099 --> 00:03:26,760
version 4 does not exist or at least

71
00:03:26,760 --> 00:03:29,640
kind of does because in the header of

72
00:03:29,640 --> 00:03:33,360
the packet they used version 4 when they

73
00:03:33,360 --> 00:03:35,700
were using 3.1.1

74
00:03:35,700 --> 00:03:37,500
and that's why they skipped to version

75
00:03:37,500 --> 00:03:39,120
5.

76
00:03:39,120 --> 00:03:41,099
um so what what happens there is a

77
00:03:41,099 --> 00:03:43,620
client and this client can publish into

78
00:03:43,620 --> 00:03:47,040
a topic and another client or the same

79
00:03:47,040 --> 00:03:50,099
client can subscribe to a topic or

80
00:03:50,099 --> 00:03:52,260
several and then the broker which is the

81
00:03:52,260 --> 00:03:54,860
central server will relay messages

82
00:03:54,860 --> 00:03:59,580
between clients every message in this

83
00:03:59,580 --> 00:04:02,099
system has at least a topic and a

84
00:04:02,099 --> 00:04:03,060
payload

85
00:04:03,060 --> 00:04:05,519
and this payload can be anything it

86
00:04:05,519 --> 00:04:07,379
could be a binary file it could be text

87
00:04:07,379 --> 00:04:11,040
and most commonly used is is a text or

88
00:04:11,040 --> 00:04:13,500
Json or just a number

89
00:04:13,500 --> 00:04:16,079
um so if we visualize that we'll see we

90
00:04:16,079 --> 00:04:17,940
have a broker in the middle we have two

91
00:04:17,940 --> 00:04:20,600
clients and if client one on the left

92
00:04:20,600 --> 00:04:23,639
publishes something to the topic room

93
00:04:23,639 --> 00:04:25,380
temperature

94
00:04:25,380 --> 00:04:27,780
then the message gets sent to the broker

95
00:04:27,780 --> 00:04:29,880
and nothing happens

96
00:04:29,880 --> 00:04:32,100
there is no subscription

97
00:04:32,100 --> 00:04:34,580
and the message is lost forever

98
00:04:34,580 --> 00:04:36,780
asterisks there is

99
00:04:36,780 --> 00:04:38,460
an exception and we'll come to that

100
00:04:38,460 --> 00:04:41,340
later but first we'll need some clients

101
00:04:41,340 --> 00:04:43,860
to subscribe to the topic and then if

102
00:04:43,860 --> 00:04:46,020
there is a publish on that same topic

103
00:04:46,020 --> 00:04:48,419
the broker will relay the message and

104
00:04:48,419 --> 00:04:50,759
send the message to client 2 who now

105
00:04:50,759 --> 00:04:53,400
gets the updated value this also works

106
00:04:53,400 --> 00:04:55,919
with multiple clients and note that the

107
00:04:55,919 --> 00:04:57,780
client number three uses a different

108
00:04:57,780 --> 00:05:01,080
topic than clients two and four so if

109
00:05:01,080 --> 00:05:03,240
client one now sends the updated room

110
00:05:03,240 --> 00:05:04,320
temperature

111
00:05:04,320 --> 00:05:06,780
only clients two and four will receive

112
00:05:06,780 --> 00:05:07,919
this message

113
00:05:07,919 --> 00:05:10,800
the topics are the addresses of the

114
00:05:10,800 --> 00:05:13,259
messages in mqtt and they're structured

115
00:05:13,259 --> 00:05:15,180
in a hierarchy a bit like a file system

116
00:05:15,180 --> 00:05:18,000
with a slash as a separator

117
00:05:18,000 --> 00:05:20,460
um in contrast to a file system you

118
00:05:20,460 --> 00:05:22,800
don't start with the root with a

119
00:05:22,800 --> 00:05:23,759
separator

120
00:05:23,759 --> 00:05:24,539
um

121
00:05:24,539 --> 00:05:26,639
just remember that when you build this

122
00:05:26,639 --> 00:05:29,340
for yourself you can use wildcards in

123
00:05:29,340 --> 00:05:31,020
the in the topic names when subscribing

124
00:05:31,020 --> 00:05:33,960
but only for a complete level or

125
00:05:33,960 --> 00:05:36,240
multiple levels you cannot do character

126
00:05:36,240 --> 00:05:38,460
substitution it's only for the whole

127
00:05:38,460 --> 00:05:40,440
part between the separator between the

128
00:05:40,440 --> 00:05:42,180
slashes and they are case sensitive

129
00:05:42,180 --> 00:05:44,539
although some firmwares will actually

130
00:05:44,539 --> 00:05:48,000
listen on both the full caps the

131
00:05:48,000 --> 00:05:50,100
non-caps or the capitalized version of

132
00:05:50,100 --> 00:05:51,560
the same topic

133
00:05:51,560 --> 00:05:54,000
please don't put spaces in your topic

134
00:05:54,000 --> 00:05:55,500
names that would

135
00:05:55,500 --> 00:05:57,419
be annoying and you know weird

136
00:05:57,419 --> 00:05:59,699
characters just used common ASCII and

137
00:05:59,699 --> 00:06:02,400
you'll be fine you could actually go and

138
00:06:02,400 --> 00:06:06,060
build a ginormous uh hierarchy for your

139
00:06:06,060 --> 00:06:07,220
house

140
00:06:07,220 --> 00:06:09,780
you could also make it very simple and

141
00:06:09,780 --> 00:06:11,639
just say Okay I want sensors and I'll

142
00:06:11,639 --> 00:06:13,500
just number them one through three and

143
00:06:13,500 --> 00:06:16,080
and and so on and later on we'll be

144
00:06:16,080 --> 00:06:18,419
talking about tesmota and there we'll

145
00:06:18,419 --> 00:06:21,539
see uh test motor already provides a

146
00:06:21,539 --> 00:06:24,419
default way of of topics

147
00:06:24,419 --> 00:06:27,000
um earlier I said a message was lost

148
00:06:27,000 --> 00:06:30,900
forever if there was no subscription but

149
00:06:30,900 --> 00:06:32,520
there was an Asterix and the Asterix is

150
00:06:32,520 --> 00:06:35,639
a retained message you can actually say

151
00:06:35,639 --> 00:06:36,960
Okay I want this message to be

152
00:06:36,960 --> 00:06:38,340
remembered forever

153
00:06:38,340 --> 00:06:41,520
or until I have a new message flagged as

154
00:06:41,520 --> 00:06:44,100
retained and this message will actually

155
00:06:44,100 --> 00:06:48,419
survive a reboot of the broker and if a

156
00:06:48,419 --> 00:06:51,240
new subscription is done to a topic this

157
00:06:51,240 --> 00:06:53,880
message will immediately be sent to the

158
00:06:53,880 --> 00:06:56,340
client which you don't know from when

159
00:06:56,340 --> 00:06:57,960
this message was so it could be a week

160
00:06:57,960 --> 00:06:59,340
old

161
00:06:59,340 --> 00:07:00,780
um the quality of service we mentioned

162
00:07:00,780 --> 00:07:03,500
in the beginning of the talk

163
00:07:03,500 --> 00:07:06,780
the delivery guarantees we have three

164
00:07:06,780 --> 00:07:09,720
levels we have qos0 which is like Raid 0

165
00:07:09,720 --> 00:07:12,840
nothing because there is no guarantee it

166
00:07:12,840 --> 00:07:14,940
just tries once and if the client

167
00:07:14,940 --> 00:07:17,099
receives it's mature and if it doesn't

168
00:07:17,099 --> 00:07:19,020
they're not

169
00:07:19,020 --> 00:07:21,780
um qs1 requires an acknowledgment from

170
00:07:21,780 --> 00:07:24,419
the client this could also mean that the

171
00:07:24,419 --> 00:07:26,460
message is sent three times and then

172
00:07:26,460 --> 00:07:27,960
finally the acknowledge comes through

173
00:07:27,960 --> 00:07:31,199
and the client has received the same

174
00:07:31,199 --> 00:07:33,599
message three times if that is a toggle

175
00:07:33,599 --> 00:07:36,539
for a light switch this is annoying

176
00:07:36,539 --> 00:07:38,759
um so that's why you have qos2 which

177
00:07:38,759 --> 00:07:40,199
will make sure that the client only

178
00:07:40,199 --> 00:07:44,099
receives this message once and once only

179
00:07:44,099 --> 00:07:45,900
um last will and testament is a method

180
00:07:45,900 --> 00:07:49,139
where you can uh while connecting tell

181
00:07:49,139 --> 00:07:50,940
the broker okay if you lose connection

182
00:07:50,940 --> 00:07:54,300
with me please inform others of my

183
00:07:54,300 --> 00:07:57,000
disappearance by sending this message to

184
00:07:57,000 --> 00:08:00,180
this topic and that will enable you if

185
00:08:00,180 --> 00:08:02,099
at the other end of the pipeline

186
00:08:02,099 --> 00:08:04,099
original

187
00:08:04,099 --> 00:08:07,080
development uh if at the other end of

188
00:08:07,080 --> 00:08:09,300
the pipeline the power is cut and the

189
00:08:09,300 --> 00:08:12,060
device disappears but only transmits an

190
00:08:12,060 --> 00:08:13,800
update every five minutes you don't have

191
00:08:13,800 --> 00:08:16,319
to wait five full minutes to notice it's

192
00:08:16,319 --> 00:08:20,400
gone you get a response within a couple

193
00:08:20,400 --> 00:08:23,039
of seconds because of the keep alive to

194
00:08:23,039 --> 00:08:25,440
this to the broker not being updated and

195
00:08:25,440 --> 00:08:26,879
then the broker notifies the rest of the

196
00:08:26,879 --> 00:08:29,879
world I lost a client maybe you want to

197
00:08:29,879 --> 00:08:31,919
do something about that

198
00:08:31,919 --> 00:08:34,860
so let's see if we can actually get this

199
00:08:34,860 --> 00:08:38,099
to work in a in a live demo I I did try

200
00:08:38,099 --> 00:08:40,860
to uh pray to the demo Gods this morning

201
00:08:40,860 --> 00:08:43,019
um pray with me

202
00:08:43,019 --> 00:08:46,019
um what we can do is uh simply uh look

203
00:08:46,019 --> 00:08:50,100
at a uh mosquito uh subscription command

204
00:08:50,100 --> 00:08:53,820
which is uh make it slightly larger is

205
00:08:53,820 --> 00:08:57,240
just subscribe to all the system uh

206
00:08:57,240 --> 00:09:00,959
topics that the broker already provides

207
00:09:00,959 --> 00:09:02,880
um the slash V in there is to actually

208
00:09:02,880 --> 00:09:05,459
get the topic names with them so if I

209
00:09:05,459 --> 00:09:08,279
run this simple command I get all my

210
00:09:08,279 --> 00:09:10,500
information from the broker

211
00:09:10,500 --> 00:09:11,700
um these are all retained messages

212
00:09:11,700 --> 00:09:13,560
because I immediately get some data

213
00:09:13,560 --> 00:09:15,720
normally you only get when there's an

214
00:09:15,720 --> 00:09:18,180
update but these are retained

215
00:09:18,180 --> 00:09:21,180
um what we can also do is uh actually

216
00:09:21,180 --> 00:09:22,800
say Okay I want the broker information

217
00:09:22,800 --> 00:09:26,339
but only the number of messages sent in

218
00:09:26,339 --> 00:09:28,560
the last five minutes or the messages

219
00:09:28,560 --> 00:09:32,100
received in the last five minutes and to

220
00:09:32,100 --> 00:09:34,500
demonstrate that I have to type it

221
00:09:34,500 --> 00:09:37,380
correctly the plus sign is the wild card

222
00:09:37,380 --> 00:09:40,260
for a single level and as you can see at

223
00:09:40,260 --> 00:09:42,180
the bottom of the screen which is a

224
00:09:42,180 --> 00:09:43,399
little bit

225
00:09:43,399 --> 00:09:46,740
the received or sent a differentiation

226
00:09:46,740 --> 00:09:50,160
is done in the second to last

227
00:09:50,160 --> 00:09:53,220
level of the topic and I use the plus

228
00:09:53,220 --> 00:09:57,120
wild card to uh wildcard out that single

229
00:09:57,120 --> 00:10:00,120
level and I also have a retained message

230
00:10:00,120 --> 00:10:02,279
from last week and I actually put it in

231
00:10:02,279 --> 00:10:05,700
last week so it now tells the truth

232
00:10:05,700 --> 00:10:07,380
um we can make it slightly more

233
00:10:07,380 --> 00:10:10,860
complicated a bit more fun if we have a

234
00:10:10,860 --> 00:10:13,140
publish command a publish command is

235
00:10:13,140 --> 00:10:15,000
also provided with in this case the

236
00:10:15,000 --> 00:10:18,959
mosquito browser to send messages so if

237
00:10:18,959 --> 00:10:21,300
we start sending out some random data

238
00:10:21,300 --> 00:10:25,579
and then take another screen

239
00:10:25,579 --> 00:10:28,680
And subscribe to

240
00:10:28,680 --> 00:10:34,079
uh wrong one subscribe to our test

241
00:10:34,079 --> 00:10:37,760
we actually see some random numbers

242
00:10:38,160 --> 00:10:41,579
um we could also do this with of course

243
00:10:41,579 --> 00:10:44,100
a python script because there are

244
00:10:44,100 --> 00:10:46,440
libraries available for many uh

245
00:10:46,440 --> 00:10:48,959
languages including Python and with just

246
00:10:48,959 --> 00:10:51,620
a few lines of python we can actually

247
00:10:51,620 --> 00:10:55,980
Generate random numbers in another Topic

248
00:10:55,980 --> 00:10:57,660
in this case it's Pi random and we'll

249
00:10:57,660 --> 00:11:00,740
see that in a in a later demo as well

250
00:11:00,740 --> 00:11:02,279
and

251
00:11:02,279 --> 00:11:06,060
um I'm running this as a live demo on uh

252
00:11:06,060 --> 00:11:08,459
in this case a Raspberry Pi zero in in

253
00:11:08,459 --> 00:11:11,220
the little box on on the desk here and

254
00:11:11,220 --> 00:11:13,200
that's basically all you need

255
00:11:13,200 --> 00:11:16,500
um it could run on on any OS uh Linux is

256
00:11:16,500 --> 00:11:18,120
commonly used but there are windows

257
00:11:18,120 --> 00:11:21,360
implementations uh Mac OS and you can

258
00:11:21,360 --> 00:11:22,940
run it on very

259
00:11:22,940 --> 00:11:25,740
light Hardware like the pi zero I have

260
00:11:25,740 --> 00:11:27,899
over here and

261
00:11:27,899 --> 00:11:30,720
um this should not be any uh

262
00:11:30,720 --> 00:11:33,839
uh anything you you need to invest in to

263
00:11:33,839 --> 00:11:36,240
get started so um I hope you start

264
00:11:36,240 --> 00:11:38,519
tomorrow when you're back at home or

265
00:11:38,519 --> 00:11:40,560
after tear down in a couple of days when

266
00:11:40,560 --> 00:11:43,380
you're back at home and um

267
00:11:43,380 --> 00:11:45,959
when you install mosquito broker keep in

268
00:11:45,959 --> 00:11:49,500
mind that it usually uh defaults to only

269
00:11:49,500 --> 00:11:51,720
listening at localhost if you want to

270
00:11:51,720 --> 00:11:53,639
connect more devices to your broker you

271
00:11:53,639 --> 00:11:55,260
need to add a listener in the config

272
00:11:55,260 --> 00:11:58,160
file to listen to all the devices

273
00:11:58,160 --> 00:12:00,480
this is the first Google action you do

274
00:12:00,480 --> 00:12:01,980
after installing it because it doesn't

275
00:12:01,980 --> 00:12:04,200
work and then you get to this and I had

276
00:12:04,200 --> 00:12:05,940
to put in allow anonymous because I'm

277
00:12:05,940 --> 00:12:07,860
not running any security which you

278
00:12:07,860 --> 00:12:09,839
should because there is already a slight

279
00:12:09,839 --> 00:12:12,600
vulnerability in there

280
00:12:12,600 --> 00:12:15,300
but now you have the mqtt broker you

281
00:12:15,300 --> 00:12:17,040
need something to connect to the broker

282
00:12:17,040 --> 00:12:20,519
and that is where I usually use tasmota

283
00:12:20,519 --> 00:12:22,800
which is a universal firmware for ESP

284
00:12:22,800 --> 00:12:25,440
chips like the one we saw in the 2L

285
00:12:25,440 --> 00:12:27,420
light in the previous presentation

286
00:12:27,420 --> 00:12:31,740
and this enables you to control the

287
00:12:31,740 --> 00:12:37,019
any ESP over mqtt via a web UI over HTTP

288
00:12:37,019 --> 00:12:39,120
get requests or even over a serial

289
00:12:39,120 --> 00:12:41,040
connection and it already has support

290
00:12:41,040 --> 00:12:43,079
for many many peripherals you could hook

291
00:12:43,079 --> 00:12:45,420
up to your ESP it's very configurable

292
00:12:45,420 --> 00:12:49,260
and although it started out for a smart

293
00:12:49,260 --> 00:12:54,120
relay a sonoff relay it is now a huge

294
00:12:54,120 --> 00:12:57,240
library for a lot of different devices

295
00:12:57,240 --> 00:13:00,420
and you could probably have the ESP

296
00:13:00,420 --> 00:13:02,399
version of the two-year light in there

297
00:13:02,399 --> 00:13:04,139
with just a few clicks which will

298
00:13:04,139 --> 00:13:07,019
actually try and do there are

299
00:13:07,019 --> 00:13:09,120
alternatives for this you could use ESP

300
00:13:09,120 --> 00:13:12,360
home or ESP easy to to get the same

301
00:13:12,360 --> 00:13:14,880
tasks done in this case we'll just go

302
00:13:14,880 --> 00:13:17,100
for tosmota and what you usually do is

303
00:13:17,100 --> 00:13:20,100
you flash it you set up the Wi-Fi and

304
00:13:20,100 --> 00:13:22,079
then you over the air configure and

305
00:13:22,079 --> 00:13:26,459
update your devices so if it's stuck

306
00:13:26,459 --> 00:13:28,800
behind a wall or somewhere high up in

307
00:13:28,800 --> 00:13:30,480
the ceiling in a light fixture no

308
00:13:30,480 --> 00:13:33,420
worries as we things can be done over

309
00:13:33,420 --> 00:13:35,820
the air and the easiest way to install

310
00:13:35,820 --> 00:13:39,420
is the new web installer using web USB

311
00:13:39,420 --> 00:13:40,980
just like the badge

312
00:13:40,980 --> 00:13:43,740
that you probably have already tried so

313
00:13:43,740 --> 00:13:45,360
if you have the correct browser for it

314
00:13:45,360 --> 00:13:48,540
that supports web USB you can just plug

315
00:13:48,540 --> 00:13:51,540
it in go to the website and say Flash

316
00:13:51,540 --> 00:13:53,459
it'll it'll blink a few times and then

317
00:13:53,459 --> 00:13:55,019
it'll take you through the Wi-Fi

318
00:13:55,019 --> 00:13:57,120
configuration and then your visit device

319
00:13:57,120 --> 00:13:58,860
and you're greeted with the standard

320
00:13:58,860 --> 00:14:01,079
test motor web UI

321
00:14:01,079 --> 00:14:03,240
and from there is where the fun starts

322
00:14:03,240 --> 00:14:04,620
because now we have a configuration

323
00:14:04,620 --> 00:14:08,279
button to actually configure our device

324
00:14:08,279 --> 00:14:10,860
and this can be done with the with the

325
00:14:10,860 --> 00:14:13,139
templates for all the common devices

326
00:14:13,139 --> 00:14:16,620
that we already see and in this template

327
00:14:16,620 --> 00:14:18,720
you say okay I have this for example

328
00:14:18,720 --> 00:14:21,779
some of smart relay and we Define it as

329
00:14:21,779 --> 00:14:23,940
a button it has a relay and it has a

330
00:14:23,940 --> 00:14:26,279
status LED and it's on these and these

331
00:14:26,279 --> 00:14:29,220
pins the pins that are usually definable

332
00:14:29,220 --> 00:14:32,639
which are which can be used by the user

333
00:14:32,639 --> 00:14:34,800
and for the sonoff there's a few pins

334
00:14:34,800 --> 00:14:37,500
actually a few iOS broken out on pins on

335
00:14:37,500 --> 00:14:40,019
the inside you put them as user and then

336
00:14:40,019 --> 00:14:42,000
when the user has selected the template

337
00:14:42,000 --> 00:14:43,740
and goes into the module configuration

338
00:14:43,740 --> 00:14:46,699
you see the pins that were user defined

339
00:14:46,699 --> 00:14:50,639
available to set up whatever you want so

340
00:14:50,639 --> 00:14:52,860
if you would want to connect something

341
00:14:52,860 --> 00:14:55,800
extra to it this is where you tap into

342
00:14:55,800 --> 00:14:57,899
and

343
00:14:57,899 --> 00:14:58,560
um

344
00:14:58,560 --> 00:15:01,620
of course you have to also set up the

345
00:15:01,620 --> 00:15:04,079
mqtt broker and

346
00:15:04,079 --> 00:15:06,959
um one thing I always do is I set the

347
00:15:06,959 --> 00:15:09,420
Telemetry period from five minutes down

348
00:15:09,420 --> 00:15:11,940
to 15 seconds because otherwise I have

349
00:15:11,940 --> 00:15:15,240
to wait too long when I'm tinkering

350
00:15:15,240 --> 00:15:18,000
I don't have any patience but with this

351
00:15:18,000 --> 00:15:21,600
set of tools we can build a lot of

352
00:15:21,600 --> 00:15:24,300
different setups we can do things with

353
00:15:24,300 --> 00:15:26,699
power monitoring environmental

354
00:15:26,699 --> 00:15:31,199
monitoring light with or without RGB and

355
00:15:31,199 --> 00:15:34,320
we'll try if we can do this for real now

356
00:15:34,320 --> 00:15:37,399
so what I have here is in

357
00:15:37,399 --> 00:15:41,040
esp8266 it also works on the esp32 but

358
00:15:41,040 --> 00:15:43,019
this is what I had laying around and

359
00:15:43,019 --> 00:15:44,959
it's in this little box here

360
00:15:44,959 --> 00:15:50,399
so it's just this ESB

361
00:15:50,399 --> 00:15:51,060
um

362
00:15:51,060 --> 00:15:52,560
and

363
00:15:52,560 --> 00:15:54,839
the configuration starts out empty

364
00:15:54,839 --> 00:15:57,060
there's nothing in there

365
00:15:57,060 --> 00:15:59,639
so I wanted something I added a shield

366
00:15:59,639 --> 00:16:01,800
with a temperature and humidity sensor

367
00:16:01,800 --> 00:16:04,079
and all I have to do to get the data is

368
00:16:04,079 --> 00:16:07,440
just say okay I'll go to pin let's see

369
00:16:07,440 --> 00:16:10,079
configuration it's over there

370
00:16:10,079 --> 00:16:11,459
module

371
00:16:11,459 --> 00:16:13,380
pin D4

372
00:16:13,380 --> 00:16:18,720
I want my am 2301 sensor I click save

373
00:16:18,720 --> 00:16:22,160
wait for it to reboot

374
00:16:22,199 --> 00:16:24,779
wait for it to reboot and my temperature

375
00:16:24,779 --> 00:16:26,579
sensor is done

376
00:16:26,579 --> 00:16:29,759
I can now put this on the field and

377
00:16:29,759 --> 00:16:31,500
it's done

378
00:16:31,500 --> 00:16:34,920
thank you and if we look at the mqtt

379
00:16:34,920 --> 00:16:37,860
data we actually see there is already a

380
00:16:37,860 --> 00:16:40,680
Telemetry package coming down with the

381
00:16:40,680 --> 00:16:44,399
temperature of 22.8 degrees on stage

382
00:16:44,399 --> 00:16:46,920
so this is how easy it is to get started

383
00:16:46,920 --> 00:16:50,100
with your project and if we want

384
00:16:50,100 --> 00:16:52,920
anything more from this we could simply

385
00:16:52,920 --> 00:16:56,759
add another thing like a button I have a

386
00:16:56,759 --> 00:16:59,459
shield for a button so let me just go

387
00:16:59,459 --> 00:17:01,620
back to the browser and click on

388
00:17:01,620 --> 00:17:04,919
configuration again add my button to the

389
00:17:04,919 --> 00:17:08,819
top pin button this is button one we

390
00:17:08,819 --> 00:17:09,959
actually have support for eight

391
00:17:09,959 --> 00:17:11,880
different buttons so we could actually

392
00:17:11,880 --> 00:17:14,220
make a box with eight buttons eight

393
00:17:14,220 --> 00:17:15,959
relays

394
00:17:15,959 --> 00:17:20,360
or any configuration between those

395
00:17:21,660 --> 00:17:24,599
now we don't see much we need to put

396
00:17:24,599 --> 00:17:26,359
something in there to actually

397
00:17:26,359 --> 00:17:29,760
show us the output let's add some RGB I

398
00:17:29,760 --> 00:17:31,740
think that would be fitting I do not

399
00:17:31,740 --> 00:17:33,660
have this exact Shields but I have a

400
00:17:33,660 --> 00:17:36,179
little RGB light in there so if we go to

401
00:17:36,179 --> 00:17:37,559
the configuration

402
00:17:37,559 --> 00:17:40,260
uh to D7

403
00:17:40,260 --> 00:17:42,419
I can put in an RGB

404
00:17:42,419 --> 00:17:46,200
LED or a whole strip of legs LEDs you

405
00:17:46,200 --> 00:17:47,940
could actually have a couple of meters

406
00:17:47,940 --> 00:17:51,299
of LED strip connected up and make it do

407
00:17:51,299 --> 00:17:54,740
all kinds of rainbows

408
00:17:55,020 --> 00:17:57,120
once it's rebooted we're actually

409
00:17:57,120 --> 00:17:59,580
greeted with a complete interface to

410
00:17:59,580 --> 00:18:03,480
turn on the the LED make it shine make

411
00:18:03,480 --> 00:18:04,980
it different colors I hope you you can

412
00:18:04,980 --> 00:18:06,900
see it from the back of the room and on

413
00:18:06,900 --> 00:18:09,840
on camera but we have full control over

414
00:18:09,840 --> 00:18:14,280
our RGB LED now uh just by a few clicks

415
00:18:14,280 --> 00:18:16,020
and obviously we can control this

416
00:18:16,020 --> 00:18:19,140
through mqtt as well

417
00:18:19,140 --> 00:18:21,539
if we want to add more this is actually

418
00:18:21,539 --> 00:18:23,520
the full setup that is in in the little

419
00:18:23,520 --> 00:18:26,280
box on on stage with me I've added two

420
00:18:26,280 --> 00:18:29,340
more sensors and I've added them using I

421
00:18:29,340 --> 00:18:31,799
squared C bus so we just go back into

422
00:18:31,799 --> 00:18:34,520
the configuration

423
00:18:34,860 --> 00:18:39,900
go into the module and for pins to

424
00:18:39,900 --> 00:18:45,600
we have the data and here is the clock

425
00:18:45,600 --> 00:18:48,260
click save

426
00:18:49,440 --> 00:18:52,860
go to the main menu and now we have all

427
00:18:52,860 --> 00:18:55,020
the sensor data we want

428
00:18:55,020 --> 00:18:57,360
I'm running this of a power bank I could

429
00:18:57,360 --> 00:18:59,760
now put this in the other tent

430
00:18:59,760 --> 00:19:03,660
and through Wi-Fi get all my data

431
00:19:03,660 --> 00:19:04,260
um

432
00:19:04,260 --> 00:19:06,539
via the web interface

433
00:19:06,539 --> 00:19:09,240
or via the mqtt messages that come by

434
00:19:09,240 --> 00:19:12,000
every 15 seconds

435
00:19:12,000 --> 00:19:14,120
there it is

436
00:19:14,120 --> 00:19:17,340
we added the button

437
00:19:17,340 --> 00:19:20,400
I can click the button over here

438
00:19:20,400 --> 00:19:24,419
I can click the button on the webpage

439
00:19:24,419 --> 00:19:26,640
for toggle

440
00:19:26,640 --> 00:19:31,280
or I could send a message through mqtt

441
00:19:31,320 --> 00:19:33,379
um

442
00:19:33,559 --> 00:19:37,980
we see the mqtt messages and they use

443
00:19:37,980 --> 00:19:40,260
topics and these topics and now I have

444
00:19:40,260 --> 00:19:43,020
to find the slide again

445
00:19:43,020 --> 00:19:44,520
there we go

446
00:19:44,520 --> 00:19:47,640
the topics are defined by desmota per

447
00:19:47,640 --> 00:19:50,700
default with a prefix that tells you

448
00:19:50,700 --> 00:19:54,059
what kind of mqtt messages you'll be

449
00:19:54,059 --> 00:19:56,880
getting there and its own name which is

450
00:19:56,880 --> 00:19:59,100
tesmota underscore and the last part of

451
00:19:59,100 --> 00:20:00,900
the MAC address

452
00:20:00,900 --> 00:20:02,460
um you could change this into anything

453
00:20:02,460 --> 00:20:06,240
you want and if it is not included in

454
00:20:06,240 --> 00:20:08,220
the firmware like you like as you like

455
00:20:08,220 --> 00:20:09,659
it you could actually build your own

456
00:20:09,659 --> 00:20:11,760
firmware because this is all open source

457
00:20:11,760 --> 00:20:13,200
now

458
00:20:13,200 --> 00:20:13,860
um

459
00:20:13,860 --> 00:20:16,440
you can send the commands through mqtt

460
00:20:16,440 --> 00:20:18,419
through web interface through get

461
00:20:18,419 --> 00:20:20,640
requests through the serial console you

462
00:20:20,640 --> 00:20:23,299
can string multiple commands together

463
00:20:23,299 --> 00:20:25,740
and then there are a lot of commands I

464
00:20:25,740 --> 00:20:30,059
mean I could make this slide uh

465
00:20:30,059 --> 00:20:32,159
10 times bigger you won't be able to

466
00:20:32,159 --> 00:20:33,720
read it but please go to the

467
00:20:33,720 --> 00:20:36,480
documentation on tesmota and you get the

468
00:20:36,480 --> 00:20:39,000
full list of the 150 200 different

469
00:20:39,000 --> 00:20:41,159
commands and and we're not even touching

470
00:20:41,159 --> 00:20:42,900
on the scripting that is possible within

471
00:20:42,900 --> 00:20:45,840
tesmoto as well there's also very nice

472
00:20:45,840 --> 00:20:48,679
information when you're using an esp32

473
00:20:48,679 --> 00:20:52,380
8266 which pins to not use because

474
00:20:52,380 --> 00:20:55,620
there's a couple that are high on boot

475
00:20:55,620 --> 00:20:57,140
or low on boot

476
00:20:57,140 --> 00:21:01,380
mandatory so if you do that if you

477
00:21:01,380 --> 00:21:03,360
connect a button to the wrong PIN it'll

478
00:21:03,360 --> 00:21:04,640
boot loop

479
00:21:04,640 --> 00:21:07,140
but this enables you to get any smart

480
00:21:07,140 --> 00:21:10,380
socket any smart light and with an ESP

481
00:21:10,380 --> 00:21:14,400
and run this firmware I've maybe someone

482
00:21:14,400 --> 00:21:17,580
saw this on Twitter once I've taken I've

483
00:21:17,580 --> 00:21:20,340
taken a blitzwolf smart socket and added

484
00:21:20,340 --> 00:21:24,179
a temperature sensor and that worked

485
00:21:24,179 --> 00:21:26,220
but if we have

486
00:21:26,220 --> 00:21:29,520
measurements if we have a smart socket

487
00:21:29,520 --> 00:21:31,919
maybe with a built-in temperature sensor

488
00:21:31,919 --> 00:21:33,840
or not we have to make a decision at

489
00:21:33,840 --> 00:21:37,559
some point we want some part of our mqtt

490
00:21:37,559 --> 00:21:41,220
network of devices to make decisions

491
00:21:41,220 --> 00:21:43,260
and have effect on another part on

492
00:21:43,260 --> 00:21:45,480
another device and that is where we

493
00:21:45,480 --> 00:21:47,400
actually come to the last part which is

494
00:21:47,400 --> 00:21:48,419
node red

495
00:21:48,419 --> 00:21:51,960
and node red is a event-based system of

496
00:21:51,960 --> 00:21:55,500
nodes and these nodes created connected

497
00:21:55,500 --> 00:21:57,440
together creative flow

498
00:21:57,440 --> 00:22:00,480
there are messages that go from node to

499
00:22:00,480 --> 00:22:03,059
node and they have they have a payload

500
00:22:03,059 --> 00:22:04,980
and a topic just like an mqtt message

501
00:22:04,980 --> 00:22:09,059
it's not exactly mqtt but it is close

502
00:22:09,059 --> 00:22:11,820
um there are nodes that come with no

503
00:22:11,820 --> 00:22:15,480
grid by default there is a whole slew of

504
00:22:15,480 --> 00:22:16,919
more nodes available on the internet

505
00:22:16,919 --> 00:22:19,980
they can be easily installed and in this

506
00:22:19,980 --> 00:22:22,440
demo we'll see very short but we'll see

507
00:22:22,440 --> 00:22:25,740
a little dashboard node as well be

508
00:22:25,740 --> 00:22:27,240
installed separately

509
00:22:27,240 --> 00:22:28,140
um

510
00:22:28,140 --> 00:22:31,320
and version three was just released the

511
00:22:31,320 --> 00:22:34,320
demo is still using a version to point

512
00:22:34,320 --> 00:22:35,179
something

513
00:22:35,179 --> 00:22:37,860
I didn't want to risk it

514
00:22:37,860 --> 00:22:40,740
two days in before the the talk to to

515
00:22:40,740 --> 00:22:42,960
upgrade so

516
00:22:42,960 --> 00:22:47,460
nodes and flows that looks like this

517
00:22:47,460 --> 00:22:51,120
in this case we have on the left a mqtt

518
00:22:51,120 --> 00:22:54,780
input node this listens to a topic so it

519
00:22:54,780 --> 00:22:56,520
subscribes to a topic just like we did

520
00:22:56,520 --> 00:22:59,460
in the first demo and if a message is

521
00:22:59,460 --> 00:23:01,860
received this will pass on the payload

522
00:23:01,860 --> 00:23:03,840
and the topic to the next node which in

523
00:23:03,840 --> 00:23:05,940
this case is a switch node it has one

524
00:23:05,940 --> 00:23:09,240
input and two outputs and it'll check is

525
00:23:09,240 --> 00:23:13,440
the payload more or less than 50. and

526
00:23:13,440 --> 00:23:16,080
depending on that I will set the payload

527
00:23:16,080 --> 00:23:18,600
from the value that came into the word

528
00:23:18,600 --> 00:23:20,460
on or the word off

529
00:23:20,460 --> 00:23:22,980
and if it's different than the previous

530
00:23:22,980 --> 00:23:25,380
time that a message was received it'll

531
00:23:25,380 --> 00:23:27,360
go through the filter node up to the

532
00:23:27,360 --> 00:23:29,940
mqtt output node which just does a

533
00:23:29,940 --> 00:23:32,159
publish on mqtt

534
00:23:32,159 --> 00:23:34,620
and it actually sends it in this case to

535
00:23:34,620 --> 00:23:40,140
the power topic of this ESP

536
00:23:40,140 --> 00:23:41,100
um

537
00:23:41,100 --> 00:23:42,779
like I said it flows are triggered

538
00:23:42,779 --> 00:23:44,940
because something happens at the

539
00:23:44,940 --> 00:23:47,240
beginning so when this mqtt node here

540
00:23:47,240 --> 00:23:50,640
gets a message it'll start going through

541
00:23:50,640 --> 00:23:52,260
the flow

542
00:23:52,260 --> 00:23:55,380
um but that means that only at that

543
00:23:55,380 --> 00:23:56,940
specific moment you have the payload

544
00:23:56,940 --> 00:23:59,940
available what if I want to have a value

545
00:23:59,940 --> 00:24:02,100
from another device from another mqtt

546
00:24:02,100 --> 00:24:05,340
message that came in just recently and

547
00:24:05,340 --> 00:24:08,159
use that in a a decision I want to make

548
00:24:08,159 --> 00:24:11,400
now what you could do is use the flow or

549
00:24:11,400 --> 00:24:14,400
Global variables to store some data and

550
00:24:14,400 --> 00:24:16,020
you can do this with it either a change

551
00:24:16,020 --> 00:24:18,240
node or a function node in a function

552
00:24:18,240 --> 00:24:19,440
node you can actually make your own

553
00:24:19,440 --> 00:24:21,900
JavaScript to create a complete program

554
00:24:21,900 --> 00:24:26,039
within one node so I think we'll just

555
00:24:26,039 --> 00:24:30,240
have to look into it and try to get the

556
00:24:30,240 --> 00:24:32,059
demo goes to cooperate one last time

557
00:24:32,059 --> 00:24:34,799
this is the node-red editor

558
00:24:34,799 --> 00:24:37,980
and I'll just make this disappear with a

559
00:24:37,980 --> 00:24:40,320
little arrow this is the flow we just

560
00:24:40,320 --> 00:24:43,919
saw with the addition of two notes for

561
00:24:43,919 --> 00:24:45,500
the dashboard

562
00:24:45,500 --> 00:24:49,620
so we have a mqtt node that connects to

563
00:24:49,620 --> 00:24:53,640
my local node uh localhost broker and it

564
00:24:53,640 --> 00:24:56,880
listens on Pi random we already saw the

565
00:24:56,880 --> 00:24:58,500
pi random because that is still running

566
00:24:58,500 --> 00:24:59,779
in the background

567
00:24:59,779 --> 00:25:04,260
spitting out numbers and it passes on

568
00:25:04,260 --> 00:25:07,740
the number into this well if then

569
00:25:07,740 --> 00:25:08,900
statement

570
00:25:08,900 --> 00:25:12,240
uh in the switch node so higher than 50

571
00:25:12,240 --> 00:25:15,600
output one otherwise output two uh we

572
00:25:15,600 --> 00:25:18,059
set the payload to either the word on or

573
00:25:18,059 --> 00:25:20,100
the word off and we'll send it off to

574
00:25:20,100 --> 00:25:24,539
the power of this led if I

575
00:25:24,539 --> 00:25:29,220
connect the last line over here and

576
00:25:29,220 --> 00:25:31,200
deploy my changes

577
00:25:31,200 --> 00:25:33,779
immediately the light turns on because

578
00:25:33,779 --> 00:25:37,679
the current value is higher than 50.

579
00:25:37,679 --> 00:25:39,960
and if we want to see that in the

580
00:25:39,960 --> 00:25:42,299
dashboard we'll actually have to well

581
00:25:42,299 --> 00:25:44,279
I'll just type it in it's probably

582
00:25:44,279 --> 00:25:46,799
faster

583
00:25:46,799 --> 00:25:48,659
we can go to the dashboard and we

584
00:25:48,659 --> 00:25:53,039
actually see 61 60 61 which are the

585
00:25:53,039 --> 00:25:54,179
numbers

586
00:25:54,179 --> 00:25:56,159
we can also see over there

587
00:25:56,159 --> 00:25:58,740
so now it is working and if the

588
00:25:58,740 --> 00:26:01,260
randomness would help and go below 50

589
00:26:01,260 --> 00:26:04,080
right now which it probably doesn't

590
00:26:04,080 --> 00:26:08,100
um I'll just restart it and I hope it'll

591
00:26:08,100 --> 00:26:11,940
get and well obviously not it's the demo

592
00:26:11,940 --> 00:26:15,059
Gods yes it's off

593
00:26:15,059 --> 00:26:16,980
the lights in front of me is now off I

594
00:26:16,980 --> 00:26:18,179
hope you can all see it in the back as

595
00:26:18,179 --> 00:26:21,659
well and if it actually goes up above 50

596
00:26:21,659 --> 00:26:23,520
again the light will turn on again there

597
00:26:23,520 --> 00:26:25,500
it is

598
00:26:25,500 --> 00:26:28,020
so that works

599
00:26:28,020 --> 00:26:28,860
um

600
00:26:28,860 --> 00:26:31,039
we can do a different

601
00:26:31,039 --> 00:26:34,799
flows as well let's see if we can get

602
00:26:34,799 --> 00:26:37,080
over here yes

603
00:26:37,080 --> 00:26:39,840
um the flow variables that we mentioned

604
00:26:39,840 --> 00:26:43,440
earlier are available within this tab in

605
00:26:43,440 --> 00:26:46,080
the in the editor a global variable is

606
00:26:46,080 --> 00:26:48,779
available on all the different flows all

607
00:26:48,779 --> 00:26:50,279
the different tabs

608
00:26:50,279 --> 00:26:53,100
but here I have another one and what we

609
00:26:53,100 --> 00:26:57,000
have here is the same mqtt topic with

610
00:26:57,000 --> 00:27:00,240
the random numbers and the only thing it

611
00:27:00,240 --> 00:27:01,200
does

612
00:27:01,200 --> 00:27:05,460
is setting the payload

613
00:27:05,460 --> 00:27:07,980
from

614
00:27:07,980 --> 00:27:09,720
the message

615
00:27:09,720 --> 00:27:14,220
to a local flow variable so this is the

616
00:27:14,220 --> 00:27:16,620
mechanism to store the value for later

617
00:27:16,620 --> 00:27:20,039
use I also applaud it on the chart and

618
00:27:20,039 --> 00:27:22,080
just to show you that if you want a

619
00:27:22,080 --> 00:27:24,299
fancy graph like this it's very simple

620
00:27:24,299 --> 00:27:27,240
you just drag in one node

621
00:27:27,240 --> 00:27:30,240
give it a name or a title and tell it I

622
00:27:30,240 --> 00:27:32,460
want 10 minutes or I want an hour or 24

623
00:27:32,460 --> 00:27:36,960
hours and you instantly get a nice graph

624
00:27:36,960 --> 00:27:37,679
um

625
00:27:37,679 --> 00:27:42,260
if we want to use this information

626
00:27:42,260 --> 00:27:46,340
we can have a function node

627
00:27:46,340 --> 00:27:49,919
retrieving the same data you just call

628
00:27:49,919 --> 00:27:53,159
Flow dot get and the variable you stored

629
00:27:53,159 --> 00:27:55,320
earlier and uh

630
00:27:55,320 --> 00:27:57,200
there's your data

631
00:27:57,200 --> 00:28:01,380
this is a special node which is also at

632
00:28:01,380 --> 00:28:03,600
the top of the available nodes on the

633
00:28:03,600 --> 00:28:07,919
left and this node can be activated by

634
00:28:07,919 --> 00:28:09,000
pressing it

635
00:28:09,000 --> 00:28:11,880
or you can tell it at the bottom of the

636
00:28:11,880 --> 00:28:14,880
screen there it says you can put it onto

637
00:28:14,880 --> 00:28:17,399
an interval in this case when 21 seconds

638
00:28:17,399 --> 00:28:20,419
so it just keeps repeating and repeating

639
00:28:20,419 --> 00:28:24,679
uh triggering this single node and

640
00:28:24,679 --> 00:28:27,120
what it could do

641
00:28:27,120 --> 00:28:31,860
is change the color of our LED Friend on

642
00:28:31,860 --> 00:28:35,340
stage here so what I did is I took the

643
00:28:35,340 --> 00:28:37,740
stored value which is updated every 15

644
00:28:37,740 --> 00:28:39,140
seconds

645
00:28:39,140 --> 00:28:42,360
this injection node is running every 21

646
00:28:42,360 --> 00:28:44,820
seconds it gets the latest value it had

647
00:28:44,820 --> 00:28:49,380
and just calculate it uh uh divides it

648
00:28:49,380 --> 00:28:52,980
by nine so we would get a a number

649
00:28:52,980 --> 00:28:55,440
between 1 and 12.

650
00:28:55,440 --> 00:28:56,940
which is

651
00:28:56,940 --> 00:28:59,399
compatible with the color command

652
00:28:59,399 --> 00:29:01,679
in this motor and that actually changes

653
00:29:01,679 --> 00:29:05,580
the color of my LED there's also a green

654
00:29:05,580 --> 00:29:07,320
node over here

655
00:29:07,320 --> 00:29:12,240
which is a very handy if you are making

656
00:29:12,240 --> 00:29:15,179
something new it's the debug node if you

657
00:29:15,179 --> 00:29:17,580
look in the side on the sidebar on the

658
00:29:17,580 --> 00:29:20,640
right we can have a debug window and as

659
00:29:20,640 --> 00:29:23,299
soon as this is triggered we get updates

660
00:29:23,299 --> 00:29:27,299
of the payload visible on the right so

661
00:29:27,299 --> 00:29:29,580
you can immediately see what data goes

662
00:29:29,580 --> 00:29:32,460
where if I was curious what the

663
00:29:32,460 --> 00:29:34,860
injection node was sending out I could

664
00:29:34,860 --> 00:29:38,220
just drag a line from over here to my

665
00:29:38,220 --> 00:29:39,059
node

666
00:29:39,059 --> 00:29:42,179
deploy it and now I have full visibility

667
00:29:42,179 --> 00:29:44,820
over what is actually going from no to

668
00:29:44,820 --> 00:29:46,440
node

669
00:29:46,440 --> 00:29:48,360
um

670
00:29:48,360 --> 00:29:50,460
what we could do what I don't have with

671
00:29:50,460 --> 00:29:52,740
me but if you want to see this uh find

672
00:29:52,740 --> 00:29:55,620
me later we could actually have the

673
00:29:55,620 --> 00:29:59,700
result from the One ESP uh set a command

674
00:29:59,700 --> 00:30:03,179
on a different ESP so I could turn on a

675
00:30:03,179 --> 00:30:07,620
light based on what this ESP is doing

676
00:30:07,620 --> 00:30:11,460
um and with that I am through my

677
00:30:11,460 --> 00:30:13,320
demonstration and it actually worked

678
00:30:13,320 --> 00:30:16,140
thank God if you want to know more

679
00:30:16,140 --> 00:30:18,679
please

680
00:30:20,820 --> 00:30:22,919
thank you if you want to know more

681
00:30:22,919 --> 00:30:24,840
there's a lot of that documentation

682
00:30:24,840 --> 00:30:27,000
available on the mqtt website on the

683
00:30:27,000 --> 00:30:28,620
test motor website and on the Node red

684
00:30:28,620 --> 00:30:30,779
website I want to thank you for your

685
00:30:30,779 --> 00:30:32,580
attention and I would love to see what

686
00:30:32,580 --> 00:30:35,340
you are going to make with this and if

687
00:30:35,340 --> 00:30:36,899
you tag me on Twitter I I will

688
00:30:36,899 --> 00:30:39,539
definitely uh look at it and and like it

689
00:30:39,539 --> 00:30:42,679
and retweet it and Etc

690
00:30:43,020 --> 00:30:45,059
and and we have time for some questions

691
00:30:45,059 --> 00:30:47,279
so please if you have questions come to

692
00:30:47,279 --> 00:30:49,380
these microphones in the middle

693
00:30:49,380 --> 00:30:50,940
um also I don't know if we have any

694
00:30:50,940 --> 00:30:52,799
messages over the internet

695
00:30:52,799 --> 00:30:55,260
uh nope okay

696
00:30:55,260 --> 00:30:55,860
um

697
00:30:55,860 --> 00:31:00,620
yeah we'll take this question

698
00:31:01,500 --> 00:31:03,899
go ahead

699
00:31:03,899 --> 00:31:06,299
thank you very much for uh doing this

700
00:31:06,299 --> 00:31:08,760
speech you are the one that taught me

701
00:31:08,760 --> 00:31:11,820
how to do mqtz I was like expecting and

702
00:31:11,820 --> 00:31:14,220
talk about mqtt but you did the whole

703
00:31:14,220 --> 00:31:16,799
shebang and it was like an epic talk

704
00:31:16,799 --> 00:31:18,779
thank you very much man thank you thank

705
00:31:18,779 --> 00:31:21,179
you because this is the man who said you

706
00:31:21,179 --> 00:31:24,240
should do this as a talk

707
00:31:24,240 --> 00:31:27,240
so

708
00:31:31,860 --> 00:31:33,080
hello

709
00:31:33,080 --> 00:31:34,740
thanks

710
00:31:34,740 --> 00:31:35,880
um

711
00:31:35,880 --> 00:31:38,039
one question if you have lots of devices

712
00:31:38,039 --> 00:31:41,640
like 50 devices plus would you advise to

713
00:31:41,640 --> 00:31:44,340
um set up a separate wireless LAN or

714
00:31:44,340 --> 00:31:46,140
will it congest my my normal Wireless

715
00:31:46,140 --> 00:31:47,820
plan

716
00:31:47,820 --> 00:31:51,419
um yeah so uh setting up a a separate uh

717
00:31:51,419 --> 00:31:55,380
AP might be a way if you have an AP that

718
00:31:55,380 --> 00:31:59,100
supports different ssids on one access

719
00:31:59,100 --> 00:32:01,620
point that would be ideal because then

720
00:32:01,620 --> 00:32:06,059
you don't pollute the the Airways but

721
00:32:06,059 --> 00:32:07,860
you still have the separation and you

722
00:32:07,860 --> 00:32:09,659
could run them all in a separate VLAN

723
00:32:09,659 --> 00:32:12,720
and if you have your broker running on a

724
00:32:12,720 --> 00:32:16,080
machine that has access to that field

725
00:32:16,080 --> 00:32:18,720
and you could just route the one port

726
00:32:18,720 --> 00:32:22,799
that you're using for your mqtt on there

727
00:32:22,799 --> 00:32:25,580
okay thanks

728
00:32:27,440 --> 00:32:29,760
for great presentation

729
00:32:29,760 --> 00:32:31,260
um thank you it's very interesting

730
00:32:31,260 --> 00:32:32,760
correctly you have one broker running on

731
00:32:32,760 --> 00:32:35,399
your LS3 pi and one node red instance

732
00:32:35,399 --> 00:32:38,279
right yeah okay can you remotely access

733
00:32:38,279 --> 00:32:41,820
the node red and instance as well

734
00:32:41,820 --> 00:32:44,820
um if you uh have access to the pi then

735
00:32:44,820 --> 00:32:48,240
you can okay so you need to create your

736
00:32:48,240 --> 00:32:50,340
own access to it basically yeah okay

737
00:32:50,340 --> 00:32:54,480
yeah it is all uh run locally so you are

738
00:32:54,480 --> 00:32:56,519
in full control if you want to set it up

739
00:32:56,519 --> 00:33:00,200
uh to be accessed from outside you could

740
00:33:00,200 --> 00:33:03,299
if you want I personally use this only

741
00:33:03,299 --> 00:33:05,820
on my local network and I can VPN in on

742
00:33:05,820 --> 00:33:08,159
my local network and that way uh is is

743
00:33:08,159 --> 00:33:11,039
the easiest way to to keep it safe but

744
00:33:11,039 --> 00:33:13,620
this is all locally running so there's

745
00:33:13,620 --> 00:33:16,380
no Cloud involved there's no tuya that

746
00:33:16,380 --> 00:33:19,080
that has some infrastructure hello

747
00:33:19,080 --> 00:33:20,399
thanks

748
00:33:20,399 --> 00:33:21,600
right

749
00:33:21,600 --> 00:33:23,399
now we have we have time for one more

750
00:33:23,399 --> 00:33:26,519
question if anybody has it if not uh

751
00:33:26,519 --> 00:33:29,039
let's give another round of applause for

752
00:33:29,039 --> 00:33:30,760
this presentation

753
00:33:30,760 --> 00:33:32,940
[Music]

754
00:33:32,940 --> 00:33:35,480
thank you

