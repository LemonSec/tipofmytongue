1
00:00:01,280 --> 00:00:12,559
[Music]

2
00:00:14,299 --> 00:00:17,340
I will be talking to you about how to

3
00:00:17,340 --> 00:00:18,960
sneak past the blue team of your

4
00:00:18,960 --> 00:00:21,420
nightmares so in this talk what we're

5
00:00:21,420 --> 00:00:24,300
gonna do is we are gonna assume the

6
00:00:24,300 --> 00:00:26,279
perfect blue team what if we are against

7
00:00:26,279 --> 00:00:28,500
the imaginary blue team that does

8
00:00:28,500 --> 00:00:30,599
everything perfect but we still want to

9
00:00:30,599 --> 00:00:32,880
fish them how can we do that

10
00:00:32,880 --> 00:00:35,280
well before I go into it I am

11
00:00:35,280 --> 00:00:37,380
motorbounced and I am the founder of

12
00:00:37,380 --> 00:00:39,300
compound C which is a startup that is

13
00:00:39,300 --> 00:00:41,520
still like in the early process I'm

14
00:00:41,520 --> 00:00:43,140
still busy with setting everything up

15
00:00:43,140 --> 00:00:45,539
but before starting on my own I started

16
00:00:45,539 --> 00:00:48,059
as I worked as a red team operator at

17
00:00:48,059 --> 00:00:50,760
invisio in Belgium and I also worked as

18
00:00:50,760 --> 00:00:53,039
a penetration tester at ey in the

19
00:00:53,039 --> 00:00:55,739
Netherlands well during this talk we

20
00:00:55,739 --> 00:00:57,600
will go across

21
00:00:57,600 --> 00:00:59,820
um the the whole stage of a red team

22
00:00:59,820 --> 00:01:01,980
operator and how it is set up a phishing

23
00:01:01,980 --> 00:01:04,680
campaign and during each stage what we

24
00:01:04,680 --> 00:01:06,540
need to into account like what the blue

25
00:01:06,540 --> 00:01:09,900
team could detect from us so first of

26
00:01:09,900 --> 00:01:12,000
all we are going to look at how we set

27
00:01:12,000 --> 00:01:13,860
up a campaign so we are going to see

28
00:01:13,860 --> 00:01:15,900
okay how what do we need to take into

29
00:01:15,900 --> 00:01:17,820
account when we buy a phishing domain

30
00:01:17,820 --> 00:01:19,500
what do we need to take into account

31
00:01:19,500 --> 00:01:21,540
when we set up the servers behind it

32
00:01:21,540 --> 00:01:23,700
what do we need to do then take into

33
00:01:23,700 --> 00:01:25,920
account once our phishing campaign like

34
00:01:25,920 --> 00:01:29,159
is set up and we want to launch it what

35
00:01:29,159 --> 00:01:30,360
are the things that we need to be

36
00:01:30,360 --> 00:01:32,159
careful is when we actually press the

37
00:01:32,159 --> 00:01:35,400
send button and also if we get our fish

38
00:01:35,400 --> 00:01:38,100
the whole way through the process we

39
00:01:38,100 --> 00:01:40,799
have the fish ex like on the desktop of

40
00:01:40,799 --> 00:01:43,200
our Target if they then press the

41
00:01:43,200 --> 00:01:45,780
execute what do we need to take her into

42
00:01:45,780 --> 00:01:48,240
account for that specific phase so

43
00:01:48,240 --> 00:01:49,860
during this talk we will go through all

44
00:01:49,860 --> 00:01:52,079
four of them and then see for each phase

45
00:01:52,079 --> 00:01:54,000
which are the opsec requirements that we

46
00:01:54,000 --> 00:01:56,040
need to take into account

47
00:01:56,040 --> 00:01:59,460
now this talk is important we'll be

48
00:01:59,460 --> 00:02:01,860
using the purple team approach so there

49
00:02:01,860 --> 00:02:03,180
will be two different kind of slides

50
00:02:03,180 --> 00:02:04,860
there will be the red slides which is

51
00:02:04,860 --> 00:02:06,540
like the red teaming so the offensive

52
00:02:06,540 --> 00:02:08,940
side and there is like the blue the blue

53
00:02:08,940 --> 00:02:10,860
slides and on the blue slides I will try

54
00:02:10,860 --> 00:02:12,660
to analyze how The Blue Team might

55
00:02:12,660 --> 00:02:15,300
detect us on the red slides I will see

56
00:02:15,300 --> 00:02:17,640
how can we actually anticipate that so

57
00:02:17,640 --> 00:02:19,140
during this whole talk you will actually

58
00:02:19,140 --> 00:02:21,239
see the whole cat and mouse game it will

59
00:02:21,239 --> 00:02:23,099
become very clear on how to get a mouse

60
00:02:23,099 --> 00:02:25,220
game during this play

61
00:02:25,220 --> 00:02:28,379
during this talk also we have set up

62
00:02:28,379 --> 00:02:30,660
something uh like an imaginary company

63
00:02:30,660 --> 00:02:34,140
it's called blueperfect.net it if you go

64
00:02:34,140 --> 00:02:35,640
to the link you can actually see the

65
00:02:35,640 --> 00:02:39,239
site and blueperfect.net is a seller of

66
00:02:39,239 --> 00:02:41,340
crystal clear water but also has the

67
00:02:41,340 --> 00:02:43,260
perfect blue team and we will try to

68
00:02:43,260 --> 00:02:45,959
fish them all right so during this whole

69
00:02:45,959 --> 00:02:47,459
talk there will be different domains

70
00:02:47,459 --> 00:02:49,980
these domains are all legit I have all

71
00:02:49,980 --> 00:02:51,959
set them up they can all be correlated

72
00:02:51,959 --> 00:02:54,360
because I made some mistakes in there

73
00:02:54,360 --> 00:02:57,060
and this way you can also follow along

74
00:02:57,060 --> 00:02:58,800
at home

75
00:02:58,800 --> 00:03:02,580
now first of all we have our scenario we

76
00:03:02,580 --> 00:03:04,159
know we want to finish

77
00:03:04,159 --> 00:03:06,360
booperfect.net but how are we actually

78
00:03:06,360 --> 00:03:08,280
going to do that first we need our

79
00:03:08,280 --> 00:03:09,720
domains right

80
00:03:09,720 --> 00:03:13,200
well as a redeemer and I need a domain I

81
00:03:13,200 --> 00:03:15,300
want to make it legit and there are

82
00:03:15,300 --> 00:03:16,739
different ways I can do it at different

83
00:03:16,739 --> 00:03:19,379
types of the text the first one is typo

84
00:03:19,379 --> 00:03:22,200
squatting in which I will try to use the

85
00:03:22,200 --> 00:03:25,019
domain make some small alterations to it

86
00:03:25,019 --> 00:03:27,299
and then so that like for the naked eye

87
00:03:27,299 --> 00:03:30,180
it's almost impossible to see for that

88
00:03:30,180 --> 00:03:31,920
person that it's actually like a

89
00:03:31,920 --> 00:03:33,360
spelling mistake

90
00:03:33,360 --> 00:03:35,640
I will give a quick hint all of the

91
00:03:35,640 --> 00:03:38,640
domains here listed here none of them is

92
00:03:38,640 --> 00:03:41,540
real so especially for example the

93
00:03:41,540 --> 00:03:43,680
blueperfect.net with like Double R or

94
00:03:43,680 --> 00:03:45,599
the first one are the ones that I would

95
00:03:45,599 --> 00:03:47,640
not immediately see if I would actually

96
00:03:47,640 --> 00:03:49,739
be inspecting the link

97
00:03:49,739 --> 00:03:52,799
now a second type is actually the combo

98
00:03:52,799 --> 00:03:54,780
supporting and that is where I will try

99
00:03:54,780 --> 00:03:57,000
to make a legit domain by using a random

100
00:03:57,000 --> 00:03:58,860
word and then pasting something next to

101
00:03:58,860 --> 00:04:00,680
it for example water Dash

102
00:04:00,680 --> 00:04:02,840
blueperfect.net or the

103
00:04:02,840 --> 00:04:05,220
shopblueperfect.net I still have full

104
00:04:05,220 --> 00:04:06,959
control over that domain it's my domain

105
00:04:06,959 --> 00:04:09,299
so I can do whatever I want with it and

106
00:04:09,299 --> 00:04:10,980
it looks very legit to the original

107
00:04:10,980 --> 00:04:13,620
owner all right and then there is also a

108
00:04:13,620 --> 00:04:16,019
last one which is doppelganger domain if

109
00:04:16,019 --> 00:04:18,899
you have uh if blue perfect for example

110
00:04:18,899 --> 00:04:21,238
has a gyrosite and in the Gyros side

111
00:04:21,238 --> 00:04:22,440
they have

112
00:04:22,440 --> 00:04:23,240
um like

113
00:04:23,240 --> 00:04:25,440
gyro.blueperfect.net I can actually buy

114
00:04:25,440 --> 00:04:27,479
gyrah blue perfect without a DOT and

115
00:04:27,479 --> 00:04:29,220
then I have still have full access to

116
00:04:29,220 --> 00:04:30,780
that domain as well

117
00:04:30,780 --> 00:04:32,100
now

118
00:04:32,100 --> 00:04:33,960
this is like a first step but this is

119
00:04:33,960 --> 00:04:35,580
already a very important one we need to

120
00:04:35,580 --> 00:04:37,500
be careful of this because Defenders can

121
00:04:37,500 --> 00:04:39,479
actually detect domains being bought

122
00:04:39,479 --> 00:04:42,540
that have been that are very related to

123
00:04:42,540 --> 00:04:45,240
their first original domain for example

124
00:04:45,240 --> 00:04:48,840
here we have a screenshot of the DNS

125
00:04:48,840 --> 00:04:51,120
twister and that is like an open source

126
00:04:51,120 --> 00:04:52,680
tool that will go through all the

127
00:04:52,680 --> 00:04:54,720
different alterations of the different

128
00:04:54,720 --> 00:04:56,100
domains so it will see like

129
00:04:56,100 --> 00:04:58,740
blueperfect.com blueperfect.net it will

130
00:04:58,740 --> 00:05:00,720
try to place a dot it will try to like

131
00:05:00,720 --> 00:05:02,699
make other alterations as it can find

132
00:05:02,699 --> 00:05:05,039
and then it will see are these already

133
00:05:05,039 --> 00:05:08,340
registered or not and if so it might be

134
00:05:08,340 --> 00:05:10,500
a very interesting part if those are

135
00:05:10,500 --> 00:05:12,479
registered you might want to block them

136
00:05:12,479 --> 00:05:15,800
because the chances of someone having

137
00:05:15,800 --> 00:05:19,080
blooper.fect.net are quite suspicious

138
00:05:19,080 --> 00:05:22,340
right so the blue perfect

139
00:05:22,340 --> 00:05:24,840
organization would already block us as

140
00:05:24,840 --> 00:05:27,840
an attacker on that part and so this is

141
00:05:27,840 --> 00:05:29,340
an open source tool but there are still

142
00:05:29,340 --> 00:05:30,600
many like

143
00:05:30,600 --> 00:05:31,380
um

144
00:05:31,380 --> 00:05:34,020
there are still a lot of the of pay

145
00:05:34,020 --> 00:05:35,699
tools where like also automate this

146
00:05:35,699 --> 00:05:37,860
process for you so that you have like

147
00:05:37,860 --> 00:05:40,020
can just keep hands off

148
00:05:40,020 --> 00:05:42,120
well as an adverse adversary we actually

149
00:05:42,120 --> 00:05:44,340
want to avoid being detected that way so

150
00:05:44,340 --> 00:05:46,680
a technique that I am very fond of is

151
00:05:46,680 --> 00:05:48,060
just take a domain that's like

152
00:05:48,060 --> 00:05:50,520
completely different from all the other

153
00:05:50,520 --> 00:05:52,740
things that like might be related to it

154
00:05:52,740 --> 00:05:55,080
so I will just buy a domain which is

155
00:05:55,080 --> 00:05:56,120
called

156
00:05:56,120 --> 00:05:57,660
registrationportal.org for example

157
00:05:57,660 --> 00:06:00,120
nobody will be able to trace that domain

158
00:06:00,120 --> 00:06:03,000
tube to Blue perfect well to make it

159
00:06:03,000 --> 00:06:04,919
still look legit what I will try to do

160
00:06:04,919 --> 00:06:08,660
is in the sub domains I will add

161
00:06:08,660 --> 00:06:10,380
blueperfect.registrationportal.com so

162
00:06:10,380 --> 00:06:12,840
that if someone that is trained and is

163
00:06:12,840 --> 00:06:15,240
looking at the URL they just see they

164
00:06:15,240 --> 00:06:16,979
look at it okay it doesn't have any

165
00:06:16,979 --> 00:06:19,979
spelling mistakes so probably it looks

166
00:06:19,979 --> 00:06:22,259
okay well nope it's not but that's what

167
00:06:22,259 --> 00:06:24,539
we want of course

168
00:06:24,539 --> 00:06:27,479
um but here we also need to be very

169
00:06:27,479 --> 00:06:29,520
careful because if you are actually

170
00:06:29,520 --> 00:06:31,979
requesting an SSL certificate for your

171
00:06:31,979 --> 00:06:34,500
domain so for example I have registered

172
00:06:34,500 --> 00:06:36,740
the

173
00:06:36,740 --> 00:06:38,639
blueperfect.fileportalcloud.com if I

174
00:06:38,639 --> 00:06:40,740
have registered that I need to be very

175
00:06:40,740 --> 00:06:42,960
careful because if I ask an SSL

176
00:06:42,960 --> 00:06:45,840
certificate all SSL certificates are

177
00:06:45,840 --> 00:06:47,400
reflected in the certificate

178
00:06:47,400 --> 00:06:50,940
transparency logs those are public those

179
00:06:50,940 --> 00:06:53,280
can be searched by anyone and there are

180
00:06:53,280 --> 00:06:54,960
actually like

181
00:06:54,960 --> 00:06:57,240
um some services like census.io that you

182
00:06:57,240 --> 00:07:00,180
can see here on the slide that index

183
00:07:00,180 --> 00:07:01,800
them all and I can start looking for

184
00:07:01,800 --> 00:07:04,319
them so for example if I look for all

185
00:07:04,319 --> 00:07:07,319
blue perfect dot wildcard so just all

186
00:07:07,319 --> 00:07:09,060
the domains with blue perfect in the

187
00:07:09,060 --> 00:07:11,220
front I will actually like see popping

188
00:07:11,220 --> 00:07:12,900
up one domain that's called file

189
00:07:12,900 --> 00:07:14,880
portalcloud.com

190
00:07:14,880 --> 00:07:17,280
even though it was nothing related those

191
00:07:17,280 --> 00:07:19,440
certificate transparency logs actually

192
00:07:19,440 --> 00:07:21,960
got me busted so this way if I would

193
00:07:21,960 --> 00:07:23,160
have set it up

194
00:07:23,160 --> 00:07:25,440
The Blue Team would have detected these

195
00:07:25,440 --> 00:07:28,139
two domains already so the blue

196
00:07:28,139 --> 00:07:30,060
perfected file portal cloud and the file

197
00:07:30,060 --> 00:07:32,759
portal cloud.com as well

198
00:07:32,759 --> 00:07:33,780
now

199
00:07:33,780 --> 00:07:35,460
don't don't worry there's still a way

200
00:07:35,460 --> 00:07:37,259
that we can actually bypass that and

201
00:07:37,259 --> 00:07:39,180
it's like just one thing that's very

202
00:07:39,180 --> 00:07:40,800
helpful and it's wild card SSL

203
00:07:40,800 --> 00:07:43,199
certificates so instead of making a

204
00:07:43,199 --> 00:07:45,660
certificate for each of your sub domains

205
00:07:45,660 --> 00:07:47,840
you can just use a

206
00:07:47,840 --> 00:07:49,259
certificate.star.blueperfect.net and

207
00:07:49,259 --> 00:07:51,180
this way if I for example have the

208
00:07:51,180 --> 00:07:53,280
domain salarychecks.com if somebody

209
00:07:53,280 --> 00:07:55,259
tries to look for it they will only see

210
00:07:55,259 --> 00:07:57,000
a star and they will never see the blue

211
00:07:57,000 --> 00:07:59,340
perfect and those looks reflected

212
00:07:59,340 --> 00:08:01,860
all right so that is actually how we can

213
00:08:01,860 --> 00:08:03,960
buy our domains get an SSL certificate

214
00:08:03,960 --> 00:08:07,080
for those without being detected

215
00:08:07,080 --> 00:08:09,900
now we have our domains but we also need

216
00:08:09,900 --> 00:08:11,720
to set up the servers behind it right

217
00:08:11,720 --> 00:08:15,060
and those can actually require a lot of

218
00:08:15,060 --> 00:08:17,580
work and I'm lazy I try to be as

219
00:08:17,580 --> 00:08:19,259
efficient as possible but that also

220
00:08:19,259 --> 00:08:22,199
comes with its opsec mistakes because I

221
00:08:22,199 --> 00:08:25,080
try to reuse the servers I try to reuse

222
00:08:25,080 --> 00:08:27,479
the IPS I try to reuse the

223
00:08:27,479 --> 00:08:29,879
recategorization templates I try to

224
00:08:29,879 --> 00:08:32,039
reuse domain names if I can just to save

225
00:08:32,039 --> 00:08:33,599
a bit of time because if I have to do

226
00:08:33,599 --> 00:08:36,360
the whole process over from scratch is a

227
00:08:36,360 --> 00:08:38,159
very tedious process

228
00:08:38,159 --> 00:08:41,458
well this is actually something that the

229
00:08:41,458 --> 00:08:44,159
Defenders can capitalize on because if I

230
00:08:44,159 --> 00:08:46,560
use same techniques in the same

231
00:08:46,560 --> 00:08:48,779
different parts

232
00:08:48,779 --> 00:08:50,519
that means there is a possible

233
00:08:50,519 --> 00:08:53,160
correlation between the two so Defenders

234
00:08:53,160 --> 00:08:55,920
can start to correlate between if I have

235
00:08:55,920 --> 00:08:59,580
found one domain maybe there are other

236
00:08:59,580 --> 00:09:01,860
domains connected to it so they can see

237
00:09:01,860 --> 00:09:03,839
okay it has a domain been pointed to the

238
00:09:03,839 --> 00:09:05,700
same IP address if yes probably

239
00:09:05,700 --> 00:09:08,580
suspicious it doesn't have the same HTML

240
00:09:08,580 --> 00:09:11,519
hash yes probably suspicious image

241
00:09:11,519 --> 00:09:13,980
hashes with there are different kind of

242
00:09:13,980 --> 00:09:16,320
ways to actually start correlating them

243
00:09:16,320 --> 00:09:19,440
and one way that Defenders really like

244
00:09:19,440 --> 00:09:21,720
to do it is they use a functionality of

245
00:09:21,720 --> 00:09:24,540
virus total so virus total graph is

246
00:09:24,540 --> 00:09:26,279
functionality in which you can search

247
00:09:26,279 --> 00:09:28,680
for one domain and then from the domain

248
00:09:28,680 --> 00:09:30,600
it will start the graph out it will

249
00:09:30,600 --> 00:09:33,240
start to correlate to other parts so

250
00:09:33,240 --> 00:09:35,279
what you can see here is here I typed in

251
00:09:35,279 --> 00:09:38,100
this example file portal cloud.com and

252
00:09:38,100 --> 00:09:40,500
with this example it will see all the

253
00:09:40,500 --> 00:09:42,959
different notes we see two IP addresses

254
00:09:42,959 --> 00:09:45,300
popping up so within this functionality

255
00:09:45,300 --> 00:09:47,880
we can just double click on the IP

256
00:09:47,880 --> 00:09:50,880
addresses and it will expand from there

257
00:09:50,880 --> 00:09:53,519
again now in this graph if you look

258
00:09:53,519 --> 00:09:55,680
carefully you will also see instead of

259
00:09:55,680 --> 00:09:58,200
only file portal cloud.com you'll also

260
00:09:58,200 --> 00:10:00,019
see one popping up that is

261
00:10:00,019 --> 00:10:02,160
wordofficeonline.com which is like here

262
00:10:02,160 --> 00:10:04,200
in the

263
00:10:04,200 --> 00:10:06,480
so here in the bottom

264
00:10:06,480 --> 00:10:08,519
so this way a blue team with if they

265
00:10:08,519 --> 00:10:09,839
found one of our domains could already

266
00:10:09,839 --> 00:10:11,820
start burning or whole other campaign

267
00:10:11,820 --> 00:10:13,200
and that's something that we don't want

268
00:10:13,200 --> 00:10:14,940
because all the precious effort that we

269
00:10:14,940 --> 00:10:16,800
put in into setting things up just got

270
00:10:16,800 --> 00:10:20,220
burned in one go and so this way if we

271
00:10:20,220 --> 00:10:21,660
would have done all the mistakes that

272
00:10:21,660 --> 00:10:23,579
I've just said the perfect blue team

273
00:10:23,579 --> 00:10:25,680
would have cut our file portal cloud.com

274
00:10:25,680 --> 00:10:27,200
and with a

275
00:10:27,200 --> 00:10:30,180
found our wordofficeonline.com which was

276
00:10:30,180 --> 00:10:32,220
another one of our domains

277
00:10:32,220 --> 00:10:33,500
so

278
00:10:33,500 --> 00:10:36,839
we also want to break that right so we

279
00:10:36,839 --> 00:10:38,519
want to have the balance between being

280
00:10:38,519 --> 00:10:40,140
efficient we don't want to set up

281
00:10:40,140 --> 00:10:42,060
everything from scratch but we also want

282
00:10:42,060 --> 00:10:44,279
to do like um break the correlation

283
00:10:44,279 --> 00:10:46,500
between the two so we can do that in one

284
00:10:46,500 --> 00:10:48,839
way so we can break IP DNS correlations

285
00:10:48,839 --> 00:10:51,420
so I will never use the same IP address

286
00:10:51,420 --> 00:10:54,300
for a server or I will never use the

287
00:10:54,300 --> 00:10:56,160
same domain name that's already one way

288
00:10:56,160 --> 00:10:58,200
that I can like split those up

289
00:10:58,200 --> 00:11:01,140
or another approach is I actually just

290
00:11:01,140 --> 00:11:02,760
want to point everything at the same

291
00:11:02,760 --> 00:11:05,160
thing while everybody else is pointing

292
00:11:05,160 --> 00:11:07,560
at the same thing let's say I use a CDN

293
00:11:07,560 --> 00:11:09,000
from cloudflare

294
00:11:09,000 --> 00:11:12,420
there are so many domains pointing at

295
00:11:12,420 --> 00:11:14,640
the same domain that is actually like I

296
00:11:14,640 --> 00:11:16,320
become the needle in the haystack right

297
00:11:16,320 --> 00:11:17,940
like good like on the blue team to

298
00:11:17,940 --> 00:11:19,440
actually find me out between the

299
00:11:19,440 --> 00:11:21,420
millions of other systems connecting to

300
00:11:21,420 --> 00:11:22,920
it

301
00:11:22,920 --> 00:11:26,100
but even though we can break the DNS IP

302
00:11:26,100 --> 00:11:28,140
relationship we also need to be careful

303
00:11:28,140 --> 00:11:30,060
because if they found one of our domains

304
00:11:30,060 --> 00:11:32,880
they can actually start with hashes and

305
00:11:32,880 --> 00:11:35,040
like see okay where are there other

306
00:11:35,040 --> 00:11:37,500
sites using the same hash in for example

307
00:11:37,500 --> 00:11:40,380
an image hash using uh the same part of

308
00:11:40,380 --> 00:11:42,779
an HTML page and there are different

309
00:11:42,779 --> 00:11:45,060
Services here is one for example URL

310
00:11:45,060 --> 00:11:47,100
scan and this can be whole internet and

311
00:11:47,100 --> 00:11:49,200
the index though so they have a huge

312
00:11:49,200 --> 00:11:51,360
collection of all these image hashes so

313
00:11:51,360 --> 00:11:53,459
if they have if you would have one of

314
00:11:53,459 --> 00:11:55,440
our images and you would actually so

315
00:11:55,440 --> 00:11:57,600
this is an image from file portal

316
00:11:57,600 --> 00:12:00,839
cloud.com that I used if I would make

317
00:12:00,839 --> 00:12:03,720
the hash search for the hash in

318
00:12:03,720 --> 00:12:07,620
um in the URL scan.io you would actually

319
00:12:07,620 --> 00:12:10,380
see a lot of different domains popping

320
00:12:10,380 --> 00:12:12,660
up and very interesting here is the the

321
00:12:12,660 --> 00:12:16,019
fourth one so salary checks.com this one

322
00:12:16,019 --> 00:12:18,420
had not been previously detected but the

323
00:12:18,420 --> 00:12:20,160
blue team of our nightmares could

324
00:12:20,160 --> 00:12:22,139
actually start correlating those all

325
00:12:22,139 --> 00:12:24,480
together to get to to this domain purely

326
00:12:24,480 --> 00:12:26,040
on an image hash

327
00:12:26,040 --> 00:12:28,680
so as a red team you already feel if the

328
00:12:28,680 --> 00:12:30,540
perfect the perfect blue team would be

329
00:12:30,540 --> 00:12:32,760
doing a lot we need to take a lot into

330
00:12:32,760 --> 00:12:34,860
considerations as well right

331
00:12:34,860 --> 00:12:36,060
so

332
00:12:36,060 --> 00:12:38,040
this way they actually like have the

333
00:12:38,040 --> 00:12:39,720
salary checks.com

334
00:12:39,720 --> 00:12:42,540
how can we try to anticipate that again

335
00:12:42,540 --> 00:12:44,279
yeah we want to beat the blur for Blue

336
00:12:44,279 --> 00:12:46,320
Team by being the perfect red team we

337
00:12:46,320 --> 00:12:48,480
want to break those hashes we don't want

338
00:12:48,480 --> 00:12:51,180
to be a hash to be found in two domains

339
00:12:51,180 --> 00:12:53,519
at the same time one way for an image

340
00:12:53,519 --> 00:12:55,440
that we can do it is if we take the

341
00:12:55,440 --> 00:12:58,320
original image like on top we can do

342
00:12:58,320 --> 00:13:00,240
different alterations I can just change

343
00:13:00,240 --> 00:13:02,459
one pixel and because of that the whole

344
00:13:02,459 --> 00:13:04,440
hash of the image will be different so

345
00:13:04,440 --> 00:13:06,360
if people would be looking to it it will

346
00:13:06,360 --> 00:13:08,040
be different as well

347
00:13:08,040 --> 00:13:10,139
if we there are different ways that we

348
00:13:10,139 --> 00:13:11,519
can also do it like a bit more properly

349
00:13:11,519 --> 00:13:13,380
we can just turn the image around and

350
00:13:13,380 --> 00:13:14,880
because all the pictures have shifted

351
00:13:14,880 --> 00:13:16,380
the image looks completely different

352
00:13:16,380 --> 00:13:19,019
again we can add some noise obfuscation

353
00:13:19,019 --> 00:13:21,360
or we can actually start with colors

354
00:13:21,360 --> 00:13:22,740
different colors and then we break the

355
00:13:22,740 --> 00:13:25,079
complete hash so every time we set up a

356
00:13:25,079 --> 00:13:26,820
server every time we set up like a new

357
00:13:26,820 --> 00:13:28,500
landing page we actually need to make

358
00:13:28,500 --> 00:13:31,680
sure that all the hashes are different

359
00:13:31,680 --> 00:13:34,019
and then if we do that we have an image

360
00:13:34,019 --> 00:13:37,019
which is obfuscated we take our hash we

361
00:13:37,019 --> 00:13:38,639
look for it you will not find anything

362
00:13:38,639 --> 00:13:41,279
anymore and then we as a red team we can

363
00:13:41,279 --> 00:13:42,959
actually sleep well at night without

364
00:13:42,959 --> 00:13:44,880
being worried over domain being burnt

365
00:13:44,880 --> 00:13:46,260
overnight

366
00:13:46,260 --> 00:13:48,660
all right so we've been through the

367
00:13:48,660 --> 00:13:50,639
whole setup right so we bought our

368
00:13:50,639 --> 00:13:54,120
domain we have our servers what's next

369
00:13:54,120 --> 00:13:56,459
we just want to send everything right

370
00:13:56,459 --> 00:13:58,740
well before we actually hit the send

371
00:13:58,740 --> 00:14:00,060
button there are different things that

372
00:14:00,060 --> 00:14:01,560
we need to take into account different

373
00:14:01,560 --> 00:14:03,420
ways that we can actually be blocked

374
00:14:03,420 --> 00:14:05,940
during our send itself and one of those

375
00:14:05,940 --> 00:14:08,279
ways is reputation-based filtering that

376
00:14:08,279 --> 00:14:10,440
they can do so reputation based

377
00:14:10,440 --> 00:14:12,000
filtering can be done on different ways

378
00:14:12,000 --> 00:14:14,279
yes so a blue team can have some

379
00:14:14,279 --> 00:14:15,899
software in place that actually checks

380
00:14:15,899 --> 00:14:18,180
all inter incoming connections and they

381
00:14:18,180 --> 00:14:20,459
will check is that IP trusted or does it

382
00:14:20,459 --> 00:14:22,519
have is it linked to a phishing domain

383
00:14:22,519 --> 00:14:25,740
does it have a domain reputation is the

384
00:14:25,740 --> 00:14:28,320
age correctly so if I have an H with

385
00:14:28,320 --> 00:14:30,779
less than 30 days old that's a super new

386
00:14:30,779 --> 00:14:32,699
domain it doesn't happen often so

387
00:14:32,699 --> 00:14:34,199
oftentimes I'm already blocked from

388
00:14:34,199 --> 00:14:36,360
beginning that way I also want to look

389
00:14:36,360 --> 00:14:38,519
at my mail server reputation and also

390
00:14:38,519 --> 00:14:40,800
the content of my mail itself

391
00:14:40,800 --> 00:14:43,079
and that is actually a lot of the things

392
00:14:43,079 --> 00:14:45,360
to take into account here I've I've

393
00:14:45,360 --> 00:14:47,699
added two screenshots of common uh

394
00:14:47,699 --> 00:14:49,980
software software vendors that I come

395
00:14:49,980 --> 00:14:52,260
across which is like semantic and teles

396
00:14:52,260 --> 00:14:54,660
intelligence and what they do is for

397
00:14:54,660 --> 00:14:56,639
each incoming domain they will check in

398
00:14:56,639 --> 00:14:59,579
the domain does this domain is is this

399
00:14:59,579 --> 00:15:01,740
domain connected to

400
00:15:01,740 --> 00:15:03,240
um category for example does it look

401
00:15:03,240 --> 00:15:05,699
Finance is it just a redirector or

402
00:15:05,699 --> 00:15:07,500
whatever and then each company can

403
00:15:07,500 --> 00:15:09,360
select okay I want to block all

404
00:15:09,360 --> 00:15:11,459
categories that are not Finance or

405
00:15:11,459 --> 00:15:14,420
health or whatever

406
00:15:14,519 --> 00:15:16,800
um so again this is something that can

407
00:15:16,800 --> 00:15:19,019
be very tedious to bypass so we actually

408
00:15:19,019 --> 00:15:22,019
need to do a lot for it and I can try to

409
00:15:22,019 --> 00:15:25,260
get reputational IPS based on just

410
00:15:25,260 --> 00:15:27,480
trying and getting an IP from a cloud

411
00:15:27,480 --> 00:15:29,579
vendor and then see is there already

412
00:15:29,579 --> 00:15:32,160
like a bad reputation connected to it if

413
00:15:32,160 --> 00:15:34,440
there is I can just request a new IP and

414
00:15:34,440 --> 00:15:36,000
then I have a clean IP again but that's

415
00:15:36,000 --> 00:15:37,259
actually one with a bit of a low

416
00:15:37,259 --> 00:15:40,019
reputation what I personally really like

417
00:15:40,019 --> 00:15:42,600
to do is use an IP from cloudflare

418
00:15:42,600 --> 00:15:44,699
because again there are millions of

419
00:15:44,699 --> 00:15:46,500
packets like packets coming into

420
00:15:46,500 --> 00:15:48,300
cloudframe from millions of connections

421
00:15:48,300 --> 00:15:51,360
those IPS have a very high reputation so

422
00:15:51,360 --> 00:15:54,060
by just blending again in in with the

423
00:15:54,060 --> 00:15:56,220
masses I can become a needle in the

424
00:15:56,220 --> 00:15:57,959
haystack and actually get a high

425
00:15:57,959 --> 00:16:00,420
reputation AP on the side so that's very

426
00:16:00,420 --> 00:16:03,660
sweet for us also for mail servers if I

427
00:16:03,660 --> 00:16:06,420
hit if I send my mail I don't want to be

428
00:16:06,420 --> 00:16:09,060
blocked by because my mail server is

429
00:16:09,060 --> 00:16:10,920
actually just non-reputable because it's

430
00:16:10,920 --> 00:16:12,779
not trusted if I would set up a mail

431
00:16:12,779 --> 00:16:15,180
server on my own I can be sure that it

432
00:16:15,180 --> 00:16:16,920
takes a hell of a time to actually like

433
00:16:16,920 --> 00:16:18,839
be landing not in a spam folder but

434
00:16:18,839 --> 00:16:20,220
being accepted

435
00:16:20,220 --> 00:16:23,100
now also the content is important if

436
00:16:23,100 --> 00:16:25,139
I'll have if if I have a mail and it's

437
00:16:25,139 --> 00:16:28,019
like urgent covet whatever like you also

438
00:16:28,019 --> 00:16:30,720
see Prince of Nigeria I don't know like

439
00:16:30,720 --> 00:16:34,860
these typical phishing spams all these

440
00:16:34,860 --> 00:16:37,800
keywords I need to like try and um avoid

441
00:16:37,800 --> 00:16:40,380
those and there is one last one and that

442
00:16:40,380 --> 00:16:42,540
is the domain reputation and the age

443
00:16:42,540 --> 00:16:45,899
that's the trickiest one in my uh in in

444
00:16:45,899 --> 00:16:49,800
my experience so for that I use mainly

445
00:16:49,800 --> 00:16:52,380
four different strategies one strategy

446
00:16:52,380 --> 00:16:54,240
to have a domain with a high reputation

447
00:16:54,240 --> 00:16:57,000
is to actually try and find vulnerable

448
00:16:57,000 --> 00:16:58,980
web servers on the on the internet

449
00:16:58,980 --> 00:17:01,620
compromise those and this way we can add

450
00:17:01,620 --> 00:17:03,540
our back doors we can just use that

451
00:17:03,540 --> 00:17:06,240
domain and we have a domain with a high

452
00:17:06,240 --> 00:17:08,699
reputation and the pro for that is it's

453
00:17:08,699 --> 00:17:11,160
very hard to correlate for actually

454
00:17:11,160 --> 00:17:13,740
um for for an uh for a Defender like

455
00:17:13,740 --> 00:17:15,780
from the outside you can't really tell

456
00:17:15,780 --> 00:17:17,339
that this domain which functions

457
00:17:17,339 --> 00:17:19,740
perfectly is actually compromised in the

458
00:17:19,740 --> 00:17:20,579
back end

459
00:17:20,579 --> 00:17:23,220
well the cons of course is I can't use

460
00:17:23,220 --> 00:17:25,559
it I've never used it it's illegal I'm

461
00:17:25,559 --> 00:17:27,240
reaching other people's sites without

462
00:17:27,240 --> 00:17:29,580
having their consent so I stay away from

463
00:17:29,580 --> 00:17:33,299
that and also it can be like tough to do

464
00:17:33,299 --> 00:17:35,220
all the scanning process all that data

465
00:17:35,220 --> 00:17:38,220
and then go and exploit those

466
00:17:38,220 --> 00:17:39,960
um there are some services that actually

467
00:17:39,960 --> 00:17:43,020
go and they automate the process for you

468
00:17:43,020 --> 00:17:45,240
so for example in show them if you show

469
00:17:45,240 --> 00:17:47,340
them if you have a business license you

470
00:17:47,340 --> 00:17:48,900
can just check for all the systems

471
00:17:48,900 --> 00:17:51,059
vulnerable to Eternal blue and then you

472
00:17:51,059 --> 00:17:52,799
just need to pick out but I hope they

473
00:17:52,799 --> 00:17:54,360
don't sell these to threat actors and

474
00:17:54,360 --> 00:17:56,220
only to the good companies

475
00:17:56,220 --> 00:17:59,940
okay so that's a strategy one it's not

476
00:17:59,940 --> 00:18:01,559
available for me I hope it's not

477
00:18:01,559 --> 00:18:03,240
available for you guys as well because

478
00:18:03,240 --> 00:18:06,120
we need to stay within the law right so

479
00:18:06,120 --> 00:18:08,460
a next thing that we can do is actually

480
00:18:08,460 --> 00:18:10,740
set up the whole thing on our own so we

481
00:18:10,740 --> 00:18:14,100
by domain we make up a server we make it

482
00:18:14,100 --> 00:18:16,679
look like a finance page for example a

483
00:18:16,679 --> 00:18:18,960
fake bank and then we try to categorize

484
00:18:18,960 --> 00:18:21,299
those we try to age those we just set

485
00:18:21,299 --> 00:18:23,820
everything up so it looks legit and then

486
00:18:23,820 --> 00:18:25,860
we let them be categorized by one of

487
00:18:25,860 --> 00:18:27,780
these servers for example here with blue

488
00:18:27,780 --> 00:18:30,900
code we can actually just within our

489
00:18:30,900 --> 00:18:33,660
domain say we would like this to be

490
00:18:33,660 --> 00:18:36,120
categorized as this template could you

491
00:18:36,120 --> 00:18:37,380
please do that for us and then

492
00:18:37,380 --> 00:18:39,299
automatically in the back end they will

493
00:18:39,299 --> 00:18:41,280
start to scan the site and see if it

494
00:18:41,280 --> 00:18:42,840
could be correlated to The Domain that

495
00:18:42,840 --> 00:18:45,059
we are requesting and it's automatic so

496
00:18:45,059 --> 00:18:47,700
it's fairly easy to get that done but it

497
00:18:47,700 --> 00:18:50,100
just requires a lot of steps to do it

498
00:18:50,100 --> 00:18:51,539
because we also need to still take into

499
00:18:51,539 --> 00:18:53,940
account if we use the same template for

500
00:18:53,940 --> 00:18:55,799
finance for three different domains it

501
00:18:55,799 --> 00:18:57,960
can be correlated again so we need to be

502
00:18:57,960 --> 00:19:00,620
very careful of that

503
00:19:00,620 --> 00:19:04,320
is actually it's very time intensive and

504
00:19:04,320 --> 00:19:07,140
it requires a lot of opsec to do but we

505
00:19:07,140 --> 00:19:09,240
can actually use like get it categorized

506
00:19:09,240 --> 00:19:11,880
as a category that we want maybe a quick

507
00:19:11,880 --> 00:19:13,559
tip I don't know if you know this but I

508
00:19:13,559 --> 00:19:14,640
would also always try to get it

509
00:19:14,640 --> 00:19:17,760
categorized as Finance Health military

510
00:19:17,760 --> 00:19:21,120
or religion because these four are very

511
00:19:21,120 --> 00:19:23,760
important like in a very sensitive data

512
00:19:23,760 --> 00:19:25,740
in there and companies will actually

513
00:19:25,740 --> 00:19:27,840
like eliminate those for deep deep

514
00:19:27,840 --> 00:19:30,240
packet level inspections so deep packet

515
00:19:30,240 --> 00:19:31,799
level inspection is where all the

516
00:19:31,799 --> 00:19:34,500
traffic is going through one system they

517
00:19:34,500 --> 00:19:37,260
see what's inside if it's okay they send

518
00:19:37,260 --> 00:19:40,020
it true if it's not they just block it

519
00:19:40,020 --> 00:19:42,240
well if it's they check if it's military

520
00:19:42,240 --> 00:19:44,280
health or whatever they will actually

521
00:19:44,280 --> 00:19:45,900
just like forward it because they say

522
00:19:45,900 --> 00:19:47,700
this is sensitive data we can't touch

523
00:19:47,700 --> 00:19:49,799
this hands off well actually just the

524
00:19:49,799 --> 00:19:52,140
red team packet coming through so that

525
00:19:52,140 --> 00:19:53,760
is what I always like to do

526
00:19:53,760 --> 00:19:56,520
uh a third one and it's actually another

527
00:19:56,520 --> 00:19:58,260
very known technique it's a technique

528
00:19:58,260 --> 00:20:00,660
that actually found like by accident

529
00:20:00,660 --> 00:20:03,360
almost and I just use a suffix domain

530
00:20:03,360 --> 00:20:05,820
all these blue code vendors what they do

531
00:20:05,820 --> 00:20:09,179
is they um they go and they check domain

532
00:20:09,179 --> 00:20:12,000
domain so for example domain.com and for

533
00:20:12,000 --> 00:20:14,940
that they will give a category but if I

534
00:20:14,940 --> 00:20:17,520
have a suffix domain then I just buy a

535
00:20:17,520 --> 00:20:19,440
domain from someone already like

536
00:20:19,440 --> 00:20:22,260
defending a subdomain to me let's say

537
00:20:22,260 --> 00:20:24,559
for example we have the top domain which

538
00:20:24,559 --> 00:20:27,380
is.com dot NL

539
00:20:27,380 --> 00:20:29,880
someonebot.com.nel and they are selling

540
00:20:29,880 --> 00:20:31,860
all the different zip domains for it for

541
00:20:31,860 --> 00:20:34,919
example I can then buy uh fishing Dot

542
00:20:34,919 --> 00:20:36,720
com.nl from them

543
00:20:36,720 --> 00:20:38,880
these vendors have not taken this into

544
00:20:38,880 --> 00:20:40,980
account so what they are checking is

545
00:20:40,980 --> 00:20:43,620
just com.nel which for me is sweet right

546
00:20:43,620 --> 00:20:46,559
so I can just use their reputation their

547
00:20:46,559 --> 00:20:48,840
age oftentimes it's like I get a

548
00:20:48,840 --> 00:20:51,780
reputation of 26 years old I technology

549
00:20:51,780 --> 00:20:54,840
and an internet like you can see here on

550
00:20:54,840 --> 00:20:56,880
this slide and it's a very simple way

551
00:20:56,880 --> 00:20:58,919
for me to get a categorized domain now

552
00:20:58,919 --> 00:21:02,360
the cons of that is also because I am

553
00:21:02,360 --> 00:21:05,760
using.com.nel it looks a bit weird so

554
00:21:05,760 --> 00:21:08,100
people might get suspicious of it but in

555
00:21:08,100 --> 00:21:10,860
my experience I never found this as like

556
00:21:10,860 --> 00:21:12,720
a limiting factor people just click it

557
00:21:12,720 --> 00:21:14,520
even because it doesn't have a spelling

558
00:21:14,520 --> 00:21:17,240
mistake I guess

559
00:21:17,400 --> 00:21:19,200
um and the fourth strategy is if you

560
00:21:19,200 --> 00:21:20,520
also want to like have a bit of a

561
00:21:20,520 --> 00:21:21,960
shortcut you can use one of these

562
00:21:21,960 --> 00:21:24,059
vendors one of these cdns and use domain

563
00:21:24,059 --> 00:21:26,880
of them so one is for example blue uh

564
00:21:26,880 --> 00:21:29,039
blue perfect.zure edge.net so in which

565
00:21:29,039 --> 00:21:31,919
we'll use Azure cdns we can use fastly

566
00:21:31,919 --> 00:21:34,320
we can use Amazon cloudfront we can

567
00:21:34,320 --> 00:21:36,539
actually start using a SharePoint so set

568
00:21:36,539 --> 00:21:38,100
up a whole SharePoint server on our own

569
00:21:38,100 --> 00:21:40,500
make it public so that other people can

570
00:21:40,500 --> 00:21:43,740
connect to it and the good thing here is

571
00:21:43,740 --> 00:21:46,620
also the those domains have a very high

572
00:21:46,620 --> 00:21:49,320
reputation but the con is it's often

573
00:21:49,320 --> 00:21:50,880
against the terms and conditions of

574
00:21:50,880 --> 00:21:52,559
those companies so you need to be very

575
00:21:52,559 --> 00:21:54,299
careful not to get blocked don't do this

576
00:21:54,299 --> 00:21:56,640
on your main account we almost got

577
00:21:56,640 --> 00:21:59,760
banned because cloud from like Azure at

578
00:21:59,760 --> 00:22:01,380
a certain point they started to come up

579
00:22:01,380 --> 00:22:03,419
like very heavily against these types of

580
00:22:03,419 --> 00:22:05,640
techniques and we almost got like our

581
00:22:05,640 --> 00:22:07,559
whole company wiped on Azure just

582
00:22:07,559 --> 00:22:09,240
because we were going against the terms

583
00:22:09,240 --> 00:22:10,860
in conditions so that was for us a time

584
00:22:10,860 --> 00:22:13,860
that we said like oh okay let's stop uh

585
00:22:13,860 --> 00:22:15,780
so be care very careful when you do that

586
00:22:15,780 --> 00:22:17,820
preferably sets up something on your own

587
00:22:17,820 --> 00:22:20,159
these are also very good for domain

588
00:22:20,159 --> 00:22:21,720
fronting for the people who know this

589
00:22:21,720 --> 00:22:23,280
technique I don't have the time to go

590
00:22:23,280 --> 00:22:25,020
into it but if you know it it's very

591
00:22:25,020 --> 00:22:28,320
useful to use these as well

592
00:22:28,320 --> 00:22:30,000
um so

593
00:22:30,000 --> 00:22:32,880
like here I've come to like three

594
00:22:32,880 --> 00:22:35,460
different parts of the whole setup but

595
00:22:35,460 --> 00:22:37,620
you need to be taken into account you

596
00:22:37,620 --> 00:22:39,299
don't always need to set up your whole

597
00:22:39,299 --> 00:22:40,919
sending domain you don't always need to

598
00:22:40,919 --> 00:22:42,900
set up your whole landing page or

599
00:22:42,900 --> 00:22:45,419
actually like the payload server those

600
00:22:45,419 --> 00:22:46,919
are things that you can actually try to

601
00:22:46,919 --> 00:22:50,220
bypass and just to save a little save up

602
00:22:50,220 --> 00:22:53,100
a lot of time right so first one is if I

603
00:22:53,100 --> 00:22:55,380
want to be uh avoiding to

604
00:22:55,380 --> 00:22:57,360
um have the sending mail I can actually

605
00:22:57,360 --> 00:22:58,559
use

606
00:22:58,559 --> 00:23:01,140
um these Public Services like I can use

607
00:23:01,140 --> 00:23:02,940
a Gmail account I can use an Outlook

608
00:23:02,940 --> 00:23:05,100
account and send my mail from there this

609
00:23:05,100 --> 00:23:06,299
way I don't have to set up anything

610
00:23:06,299 --> 00:23:08,640
everything goes automatically and the

611
00:23:08,640 --> 00:23:10,620
chances of that mail Landing in the

612
00:23:10,620 --> 00:23:13,919
mailbox of my targets is very high I can

613
00:23:13,919 --> 00:23:16,440
also use like social media I can go on

614
00:23:16,440 --> 00:23:18,299
Twitter and just contact someone of my

615
00:23:18,299 --> 00:23:20,940
targets immediately send them a link and

616
00:23:20,940 --> 00:23:22,400
then I'm done

617
00:23:22,400 --> 00:23:25,320
the next thing that I also can do is I

618
00:23:25,320 --> 00:23:27,780
can avoid trying to set up a landing

619
00:23:27,780 --> 00:23:29,760
domain and that is just really trying to

620
00:23:29,760 --> 00:23:33,360
make make my pretext not need one so I

621
00:23:33,360 --> 00:23:35,520
they don't need to see a web page in

622
00:23:35,520 --> 00:23:37,260
order for them to feel like it's

623
00:23:37,260 --> 00:23:39,659
legitimate that don't feel like it's a

624
00:23:39,659 --> 00:23:40,500
fish

625
00:23:40,500 --> 00:23:44,279
and I also can avoid the Mel the the

626
00:23:44,279 --> 00:23:47,100
male sending domain uh the payload

627
00:23:47,100 --> 00:23:49,020
server and because I can avoid the

628
00:23:49,020 --> 00:23:50,659
payloads or I can use this public

629
00:23:50,659 --> 00:23:53,340
services like Bob for example Anonymous

630
00:23:53,340 --> 00:23:55,799
GitHub gists I can just put my payload

631
00:23:55,799 --> 00:23:58,080
on there send someone the link and this

632
00:23:58,080 --> 00:24:00,059
way I did not have to set up any of the

633
00:24:00,059 --> 00:24:01,799
domains with the whole categorization

634
00:24:01,799 --> 00:24:05,279
part of it I can just bypass those well

635
00:24:05,279 --> 00:24:07,980
this seems like a lot simpler right but

636
00:24:07,980 --> 00:24:09,779
on the other hand it also limits our

637
00:24:09,779 --> 00:24:12,240
possibilities a bit as a red teamer so

638
00:24:12,240 --> 00:24:14,279
it's a very viable approach especially

639
00:24:14,279 --> 00:24:16,559
because these are texts are highly

640
00:24:16,559 --> 00:24:18,840
targeted so the chance of it succeeding

641
00:24:18,840 --> 00:24:21,720
is a lot higher we have also a huge time

642
00:24:21,720 --> 00:24:23,580
reduction most of the time that we need

643
00:24:23,580 --> 00:24:25,620
to celebrate everything up in like two

644
00:24:25,620 --> 00:24:27,960
weeks we can just reduce to setting up a

645
00:24:27,960 --> 00:24:30,000
fake LinkedIn profile for example and

646
00:24:30,000 --> 00:24:31,500
then actually sending our fishes from

647
00:24:31,500 --> 00:24:32,419
there

648
00:24:32,419 --> 00:24:35,039
also we focus more on the pretext

649
00:24:35,039 --> 00:24:37,320
instead of the technical part so we can

650
00:24:37,320 --> 00:24:39,720
make sure there's three texts that we

651
00:24:39,720 --> 00:24:41,220
use the scenario that that we use is

652
00:24:41,220 --> 00:24:43,440
like really hard on and will make the

653
00:24:43,440 --> 00:24:46,260
user click on the link and also this is

654
00:24:46,260 --> 00:24:48,000
a lot less opportunity for a blue team

655
00:24:48,000 --> 00:24:51,120
to detect us from the beginning now why

656
00:24:51,120 --> 00:24:53,820
am I not always taking this approach as

657
00:24:53,820 --> 00:24:55,640
it's again because it's highly targeted

658
00:24:55,640 --> 00:24:58,799
companies don't always like that we are

659
00:24:58,799 --> 00:25:00,840
targeting one person and as an

660
00:25:00,840 --> 00:25:03,779
individual because they don't want their

661
00:25:03,779 --> 00:25:06,299
employees feel focused of a certain test

662
00:25:06,299 --> 00:25:10,080
so they are often very like careful with

663
00:25:10,080 --> 00:25:11,760
these kind of tests so that makes that

664
00:25:11,760 --> 00:25:13,980
we need to make me like take a group of

665
00:25:13,980 --> 00:25:17,220
six or seven it's also not possible if

666
00:25:17,220 --> 00:25:18,600
you want to do this with credential

667
00:25:18,600 --> 00:25:20,640
phishing then we again need to like set

668
00:25:20,640 --> 00:25:22,140
up the whole page for credential

669
00:25:22,140 --> 00:25:24,840
phishing and it's also like less

670
00:25:24,840 --> 00:25:27,000
flexibility

671
00:25:27,000 --> 00:25:29,520
uh so we have gone through the whole

672
00:25:29,520 --> 00:25:32,760
process so we have our um domain we have

673
00:25:32,760 --> 00:25:36,360
our server setup we have the we have

674
00:25:36,360 --> 00:25:39,299
passed all reputational based filtering

675
00:25:39,299 --> 00:25:42,179
and now our fish we can assume the user

676
00:25:42,179 --> 00:25:44,640
opened it it is on the workstation of

677
00:25:44,640 --> 00:25:47,700
that specific user or Target are there

678
00:25:47,700 --> 00:25:49,980
still things or have we won already well

679
00:25:49,980 --> 00:25:51,720
sadly if we were up against the perfect

680
00:25:51,720 --> 00:25:54,240
blue team we haven't because they might

681
00:25:54,240 --> 00:25:57,240
have a lot of the endpoint hardening

682
00:25:57,240 --> 00:25:58,620
measures in place

683
00:25:58,620 --> 00:26:01,919
and these are like the mo five most

684
00:26:01,919 --> 00:26:02,700
common

685
00:26:02,700 --> 00:26:05,220
endpoint hardening that I've seen come

686
00:26:05,220 --> 00:26:08,039
across so the first one is micro

687
00:26:08,039 --> 00:26:10,440
execution hardening this is actually one

688
00:26:10,440 --> 00:26:12,240
that I haven't seen a lot I wish I

689
00:26:12,240 --> 00:26:14,880
hadn't seen it more I this would have

690
00:26:14,880 --> 00:26:17,340
blocked me so many times but it's almost

691
00:26:17,340 --> 00:26:20,520
never enabled so the first one is Mark

692
00:26:20,520 --> 00:26:22,200
of the web Mark of the web is only

693
00:26:22,200 --> 00:26:24,120
recently becoming like by default by

694
00:26:24,120 --> 00:26:26,039
Microsoft so we have to step up our game

695
00:26:26,039 --> 00:26:29,520
as a red teamer anyway but also the I

696
00:26:29,520 --> 00:26:31,740
may be good to explain Mark of the web

697
00:26:31,740 --> 00:26:34,140
what does it do if I download a Word

698
00:26:34,140 --> 00:26:36,539
document from the internet I get it on

699
00:26:36,539 --> 00:26:39,299
my computer all macros macros in those

700
00:26:39,299 --> 00:26:41,580
documents will be blocked by default

701
00:26:41,580 --> 00:26:43,559
they will not be able to execute like

702
00:26:43,559 --> 00:26:45,419
whatever the end user is doing it will

703
00:26:45,419 --> 00:26:48,900
not work at all but I can try to bypass

704
00:26:48,900 --> 00:26:52,380
that again also we they can try and make

705
00:26:52,380 --> 00:26:54,659
only the execution of signed macros

706
00:26:54,659 --> 00:26:56,820
available and that would block us in the

707
00:26:56,820 --> 00:26:58,200
whole process

708
00:26:58,200 --> 00:27:01,679
uh so if we have the mark of the web the

709
00:27:01,679 --> 00:27:04,020
we can actually try to bypass that with

710
00:27:04,020 --> 00:27:06,840
zip files so if we put our document in a

711
00:27:06,840 --> 00:27:08,940
zip file the zip file has the mark of

712
00:27:08,940 --> 00:27:11,220
the web we send the zip file over this

713
00:27:11,220 --> 00:27:13,559
download has the mark of the web the

714
00:27:13,559 --> 00:27:16,320
user expands it and because the content

715
00:27:16,320 --> 00:27:18,120
itself does not have the mark of the web

716
00:27:18,120 --> 00:27:20,640
we can actually bypass that already

717
00:27:20,640 --> 00:27:23,640
and also with the signed macros we can

718
00:27:23,640 --> 00:27:25,140
just sign the macro with our own

719
00:27:25,140 --> 00:27:27,360
certificate but the problem with that is

720
00:27:27,360 --> 00:27:28,740
if we sign up with our own certificate

721
00:27:28,740 --> 00:27:29,940
it's expensive to get our own

722
00:27:29,940 --> 00:27:32,039
certificate we need to put it on our

723
00:27:32,039 --> 00:27:34,799
company name so it immediately gets like

724
00:27:34,799 --> 00:27:38,220
traceable back to us and also the it's

725
00:27:38,220 --> 00:27:39,500
immediate

726
00:27:39,500 --> 00:27:43,200
it is quite extensive if we have burned

727
00:27:43,200 --> 00:27:45,179
one of these certificates we cannot use

728
00:27:45,179 --> 00:27:47,220
it again anymore so that's actually

729
00:27:47,220 --> 00:27:49,679
quite a lot of work into it so if you

730
00:27:49,679 --> 00:27:52,080
are a blue teamer please try if this

731
00:27:52,080 --> 00:27:53,880
works in your company it will block me

732
00:27:53,880 --> 00:27:57,120
almost 100 with times

733
00:27:57,120 --> 00:27:58,460
um

734
00:27:58,460 --> 00:28:01,020
so a next thing that we can look at is

735
00:28:01,020 --> 00:28:03,600
ad blocker and attack surface reduction

736
00:28:03,600 --> 00:28:05,820
so these are two

737
00:28:05,820 --> 00:28:08,220
um two ways that they can actually avoid

738
00:28:08,220 --> 00:28:10,440
the execution of certain payloads with

739
00:28:10,440 --> 00:28:11,700
ad blocker

740
00:28:11,700 --> 00:28:14,159
already like a blue team or can in the

741
00:28:14,159 --> 00:28:16,500
configuration put in some rules for

742
00:28:16,500 --> 00:28:19,500
example exits can only execute it from

743
00:28:19,500 --> 00:28:21,419
this and this and this location and the

744
00:28:21,419 --> 00:28:24,120
same for dlls for scripts for installer

745
00:28:24,120 --> 00:28:27,000
files so with applocker they can do a

746
00:28:27,000 --> 00:28:30,419
lot to block us from the beginning well

747
00:28:30,419 --> 00:28:32,580
this app Locker has for me never been

748
00:28:32,580 --> 00:28:36,179
really like a big issue because mostly

749
00:28:36,179 --> 00:28:38,159
we've just been sending Word documents

750
00:28:38,159 --> 00:28:39,539
and then those bird documents get

751
00:28:39,539 --> 00:28:41,640
executed by word which is actually

752
00:28:41,640 --> 00:28:44,039
allowed and this way we can get our

753
00:28:44,039 --> 00:28:45,960
payload on there and on the other hand

754
00:28:45,960 --> 00:28:47,940
there are a lot of bypasses for app

755
00:28:47,940 --> 00:28:50,520
blocker here I've added like a link as

756
00:28:50,520 --> 00:28:53,220
well this link contains so many bypasses

757
00:28:53,220 --> 00:28:54,779
that you just need to choose a couple

758
00:28:54,779 --> 00:28:57,360
and then try and see if it works on the

759
00:28:57,360 --> 00:29:00,059
company the con to that of course is we

760
00:29:00,059 --> 00:29:01,620
don't know exactly what rules are into

761
00:29:01,620 --> 00:29:03,480
place in that company so we're not

762
00:29:03,480 --> 00:29:05,580
entirely sure if we send the fish that

763
00:29:05,580 --> 00:29:07,760
it will be executed or not

764
00:29:07,760 --> 00:29:11,460
now one thing that I do am very careful

765
00:29:11,460 --> 00:29:13,080
about and that is attack surface

766
00:29:13,080 --> 00:29:15,779
reduction this is a technique this is a

767
00:29:15,779 --> 00:29:17,820
feature from Microsoft that comes with

768
00:29:17,820 --> 00:29:20,279
an E5 license so if you buy Defender for

769
00:29:20,279 --> 00:29:23,039
endpoint this comes with it and it will

770
00:29:23,039 --> 00:29:25,320
block a lot with different things from

771
00:29:25,320 --> 00:29:28,020
Office applications so one of the rules

772
00:29:28,020 --> 00:29:29,880
that they do is that they will Block

773
00:29:29,880 --> 00:29:31,799
office applications from creating child

774
00:29:31,799 --> 00:29:34,559
processes so if I have my word document

775
00:29:34,559 --> 00:29:37,740
and it is trying to spawn a cmd.xit to

776
00:29:37,740 --> 00:29:39,480
make a command it will be blocked

777
00:29:39,480 --> 00:29:42,480
automatically by this Rule now me as a

778
00:29:42,480 --> 00:29:44,880
red teamer I try to bypass everything so

779
00:29:44,880 --> 00:29:46,679
one of the things that I try to bypass

780
00:29:46,679 --> 00:29:49,080
here is just make someone else execute

781
00:29:49,080 --> 00:29:51,419
it's a command one of the ways is Task

782
00:29:51,419 --> 00:29:53,700
scheduler I can ask task scheduler can

783
00:29:53,700 --> 00:29:57,000
you please do this cmd.x with this

784
00:29:57,000 --> 00:29:58,799
command and execute it for me please

785
00:29:58,799 --> 00:30:01,320
another way to do it is with com objects

786
00:30:01,320 --> 00:30:03,240
so with com objects I could make another

787
00:30:03,240 --> 00:30:05,520
program actually execute my command that

788
00:30:05,520 --> 00:30:07,500
I want to do so let's already rule one

789
00:30:07,500 --> 00:30:10,860
bypassed if I want to go and with the

790
00:30:10,860 --> 00:30:12,539
second rule the second rule is office

791
00:30:12,539 --> 00:30:14,659
applications that create

792
00:30:14,659 --> 00:30:17,700
executable content so let's say I've got

793
00:30:17,700 --> 00:30:20,520
a dll I'm planning to do a dll hijack

794
00:30:20,520 --> 00:30:23,220
with my word document I try to get a dll

795
00:30:23,220 --> 00:30:25,620
in a certain place so it's like executed

796
00:30:25,620 --> 00:30:27,899
by another program again this rule would

797
00:30:27,899 --> 00:30:30,720
block me from downloading the URL and

798
00:30:30,720 --> 00:30:32,760
writing it on disk there would be

799
00:30:32,760 --> 00:30:35,100
blocked right well actually apparently

800
00:30:35,100 --> 00:30:37,919
they are just looking at the extension

801
00:30:37,919 --> 00:30:41,880
so if I write dot if I write to a DOT

802
00:30:41,880 --> 00:30:45,720
dxt file and then rename it.dll I

803
00:30:45,720 --> 00:30:48,360
bypassed it so a lot of these rules are

804
00:30:48,360 --> 00:30:50,159
quite simple to bypass but you need to

805
00:30:50,159 --> 00:30:51,600
take them into account because they're

806
00:30:51,600 --> 00:30:52,919
if you don't know they're quite

807
00:30:52,919 --> 00:30:54,240
effective

808
00:30:54,240 --> 00:30:57,240
also one important one is that I can't

809
00:30:57,240 --> 00:30:59,580
inject into other processes from Office

810
00:30:59,580 --> 00:31:02,279
applications and this is one that is a

811
00:31:02,279 --> 00:31:04,500
bit of a Troublesome one because if I

812
00:31:04,500 --> 00:31:06,360
try to if I am contained in my word

813
00:31:06,360 --> 00:31:08,340
document I try to migrate to other

814
00:31:08,340 --> 00:31:10,679
processes just to like have more of a

815
00:31:10,679 --> 00:31:12,000
stable Beacon

816
00:31:12,000 --> 00:31:15,539
and this is one that I can actually try

817
00:31:15,539 --> 00:31:18,840
to bypass by using a p bit spoof and

818
00:31:18,840 --> 00:31:21,299
BP's proofs is where I say okay word

819
00:31:21,299 --> 00:31:24,240
office so worth is not anymore the

820
00:31:24,240 --> 00:31:24,980
parent

821
00:31:24,980 --> 00:31:27,260
application it's actually no

822
00:31:27,260 --> 00:31:29,820
explorer.exe so if I would try to from

823
00:31:29,820 --> 00:31:32,519
word word to inject into another process

824
00:31:32,519 --> 00:31:34,500
it would see okay word is trying to

825
00:31:34,500 --> 00:31:38,100
inject block if I say a word is doing it

826
00:31:38,100 --> 00:31:40,340
but the parent process is actually

827
00:31:40,340 --> 00:31:42,600
explorer.exe then the application

828
00:31:42,600 --> 00:31:46,559
service will say okay let's go ahead

829
00:31:46,559 --> 00:31:48,480
um so that's one way to bypass that as

830
00:31:48,480 --> 00:31:49,919
well

831
00:31:49,919 --> 00:31:52,080
um a next rule that I need to be careful

832
00:31:52,080 --> 00:31:55,200
of is actually the that they block the

833
00:31:55,200 --> 00:31:58,080
execution of obfuscated scripts

834
00:31:58,080 --> 00:32:00,480
obfuscated scripts this rule I haven't

835
00:32:00,480 --> 00:32:03,539
even with heavily obfuscated payloads I

836
00:32:03,539 --> 00:32:05,039
never really had a lot of troubles with

837
00:32:05,039 --> 00:32:07,320
it they the rule just doesn't trigger

838
00:32:07,320 --> 00:32:09,960
correctly all the time now

839
00:32:09,960 --> 00:32:12,059
so it just doesn't uh trigger correctly

840
00:32:12,059 --> 00:32:14,159
all the time I think that actually if

841
00:32:14,159 --> 00:32:15,840
you have a highly obfuscated payload you

842
00:32:15,840 --> 00:32:17,519
should be more afraid of the antivirus

843
00:32:17,519 --> 00:32:21,179
than actually of the of this rule

844
00:32:21,179 --> 00:32:23,640
because you just passed through it and

845
00:32:23,640 --> 00:32:26,220
another one is that that they block you

846
00:32:26,220 --> 00:32:28,799
from making win32 API calls so that

847
00:32:28,799 --> 00:32:30,360
would block you from making the process

848
00:32:30,360 --> 00:32:32,340
injections trying to interact with the

849
00:32:32,340 --> 00:32:34,620
system but this can also be bypassed

850
00:32:34,620 --> 00:32:37,260
quite easily because if I have a Word

851
00:32:37,260 --> 00:32:40,799
document and the this attack surface

852
00:32:40,799 --> 00:32:42,480
reduction sees that that word document

853
00:32:42,480 --> 00:32:45,360
is trying to connect to like reads from

854
00:32:45,360 --> 00:32:47,820
the kernel.dll they will just block it

855
00:32:47,820 --> 00:32:49,320
straight away I can't even open the

856
00:32:49,320 --> 00:32:52,799
document well if I try to First copy the

857
00:32:52,799 --> 00:32:55,919
kernel.dll to my custom own location and

858
00:32:55,919 --> 00:32:58,500
then use that kernel dll it is bypassed

859
00:32:58,500 --> 00:32:59,340
again

860
00:32:59,340 --> 00:33:02,039
so as you see these rules can be quite

861
00:33:02,039 --> 00:33:04,500
effective but can also be bypassed quite

862
00:33:04,500 --> 00:33:06,720
easily if we just know that we need to

863
00:33:06,720 --> 00:33:08,820
take them into account so these are the

864
00:33:08,820 --> 00:33:10,799
most important ones but if you really

865
00:33:10,799 --> 00:33:12,360
want to dive deeper into all the ACT

866
00:33:12,360 --> 00:33:14,399
tech service reductions I've added like

867
00:33:14,399 --> 00:33:16,740
a really helpful Link in here it's like

868
00:33:16,740 --> 00:33:18,840
a white paper with a lot of the bypasses

869
00:33:18,840 --> 00:33:21,299
and you can just use it like go through

870
00:33:21,299 --> 00:33:23,399
it and you will learn a lot about it

871
00:33:23,399 --> 00:33:26,880
now another thing that blue teamers can

872
00:33:26,880 --> 00:33:30,419
try to block us is by file filtering if

873
00:33:30,419 --> 00:33:32,580
I have a domain and somebody tries to

874
00:33:32,580 --> 00:33:34,679
download an exit the chance of that

875
00:33:34,679 --> 00:33:36,779
being like wrong are also quite high so

876
00:33:36,779 --> 00:33:37,799
you want to block that from the

877
00:33:37,799 --> 00:33:41,760
beginning so this way companies can exit

878
00:33:41,760 --> 00:33:43,860
can block the download of exit files of

879
00:33:43,860 --> 00:33:47,220
dlls scripts and like it can go on a lot

880
00:33:47,220 --> 00:33:49,320
further but there is again we try to

881
00:33:49,320 --> 00:33:51,720
camouflage it so we just put it in a zip

882
00:33:51,720 --> 00:33:54,000
and send it through if if they have

883
00:33:54,000 --> 00:33:55,440
software that actually look inside of

884
00:33:55,440 --> 00:33:57,539
Zips we use an encrypted zip so they

885
00:33:57,539 --> 00:33:59,279
can't look into it and then we send a

886
00:33:59,279 --> 00:34:01,260
password to the user so those are all

887
00:34:01,260 --> 00:34:03,840
valuable strategies to bypass these it's

888
00:34:03,840 --> 00:34:06,480
just this is more of a question of you

889
00:34:06,480 --> 00:34:08,579
need to know what you're up against and

890
00:34:08,579 --> 00:34:11,760
also you need to know uh how to like you

891
00:34:11,760 --> 00:34:14,280
can be very creative to bypass these

892
00:34:14,280 --> 00:34:17,940
uh and then a last one that is very

893
00:34:17,940 --> 00:34:19,918
important for us to take into account is

894
00:34:19,918 --> 00:34:23,219
if they have a good EDR in place that

895
00:34:23,219 --> 00:34:24,899
might block us already from the

896
00:34:24,899 --> 00:34:28,199
beginning and bypassing edrs is like a

897
00:34:28,199 --> 00:34:31,260
whole day course on its own uh but I

898
00:34:31,260 --> 00:34:32,760
want to just talk with you a couple of

899
00:34:32,760 --> 00:34:35,940
nice quick tips on how to like bypass

900
00:34:35,940 --> 00:34:39,239
one of the common for like like problems

901
00:34:39,239 --> 00:34:41,940
that I came across and one of it is

902
00:34:41,940 --> 00:34:43,440
actually you can avoid a lot of

903
00:34:43,440 --> 00:34:45,599
detections if you decouple your

904
00:34:45,599 --> 00:34:48,119
execution versus the execution of the

905
00:34:48,119 --> 00:34:50,820
word document so if for example a user

906
00:34:50,820 --> 00:34:53,099
clicks on a Word document a dll is

907
00:34:53,099 --> 00:34:55,379
written the disk that is then three four

908
00:34:55,379 --> 00:34:57,300
minutes later on read by another process

909
00:34:57,300 --> 00:34:59,579
it's very hard to for the EDR to

910
00:34:59,579 --> 00:35:02,579
correlate this together if word would be

911
00:35:02,579 --> 00:35:05,040
spawning a cmd.exe we're the never

912
00:35:05,040 --> 00:35:07,560
spawning CMD so that is a very obvious

913
00:35:07,560 --> 00:35:09,300
correlation and that would be blocked

914
00:35:09,300 --> 00:35:12,000
well if I can separate those that will

915
00:35:12,000 --> 00:35:14,760
help a lot for me

916
00:35:14,760 --> 00:35:16,859
um a next one that I've struggled with

917
00:35:16,859 --> 00:35:20,579
quite a lot is the that the edrs are

918
00:35:20,579 --> 00:35:22,980
blocking word because it is doing a

919
00:35:22,980 --> 00:35:26,339
suspicious call to the internet and I

920
00:35:26,339 --> 00:35:27,540
can understand that they block it but

921
00:35:27,540 --> 00:35:29,220
I've tried a lot of things to like

922
00:35:29,220 --> 00:35:31,440
bypass this but in the end I found quite

923
00:35:31,440 --> 00:35:33,480
a valuable solution that is com objects

924
00:35:33,480 --> 00:35:36,240
with com objects I can make a com object

925
00:35:36,240 --> 00:35:38,280
from Internet Explorer so Internet

926
00:35:38,280 --> 00:35:40,500
Explorer is downloading downloading my

927
00:35:40,500 --> 00:35:42,839
payloads and this way like it is away

928
00:35:42,839 --> 00:35:44,940
from word to word is not doing the

929
00:35:44,940 --> 00:35:47,820
connections uh the word is not doing the

930
00:35:47,820 --> 00:35:50,339
connections but a small instance of

931
00:35:50,339 --> 00:35:53,099
Internet exploring is doing it for us so

932
00:35:53,099 --> 00:35:54,660
this is one that you need to take into

933
00:35:54,660 --> 00:35:56,820
account you might come across it so

934
00:35:56,820 --> 00:35:58,440
that's an easy one I like that's an

935
00:35:58,440 --> 00:36:00,540
easier one to bypass than

936
00:36:00,540 --> 00:36:02,640
and also like the suspicious sub process

937
00:36:02,640 --> 00:36:04,260
system that's something that I just said

938
00:36:04,260 --> 00:36:06,359
so take it into account that you need to

939
00:36:06,359 --> 00:36:08,520
try and decouple those

940
00:36:08,520 --> 00:36:09,720
now

941
00:36:09,720 --> 00:36:13,320
this is has been a lot of information a

942
00:36:13,320 --> 00:36:15,359
lot of information to take in well

943
00:36:15,359 --> 00:36:17,760
actually as already said with compound C

944
00:36:17,760 --> 00:36:20,160
I'm starting my my own business and it

945
00:36:20,160 --> 00:36:22,020
will actually be to teaching people how

946
00:36:22,020 --> 00:36:24,420
to fish properly so with compound C I

947
00:36:24,420 --> 00:36:26,880
will be sharing like I will be sharing a

948
00:36:26,880 --> 00:36:28,680
lot of the techniques that I am using to

949
00:36:28,680 --> 00:36:31,020
do proper fish and if you want to learn

950
00:36:31,020 --> 00:36:32,820
it if you want to go more into detail

951
00:36:32,820 --> 00:36:35,220
into it you can already sign up on the

952
00:36:35,220 --> 00:36:38,760
academy.com C link maybe put in your

953
00:36:38,760 --> 00:36:40,380
email and you can keep up to date when

954
00:36:40,380 --> 00:36:42,180
the course is already if you would be

955
00:36:42,180 --> 00:36:43,680
interested

956
00:36:43,680 --> 00:36:46,440
now this was my talk if you would like

957
00:36:46,440 --> 00:36:48,240
to stay connected feel free to connect

958
00:36:48,240 --> 00:36:50,880
with me on here and

959
00:36:50,880 --> 00:36:53,440
um then I would like to thank you all

960
00:36:53,440 --> 00:37:02,060
[Applause]

961
00:37:02,060 --> 00:37:04,680
thank you for the amazing talk we have

962
00:37:04,680 --> 00:37:06,839
about 10 minutes left for any questions

963
00:37:06,839 --> 00:37:09,540
if anyone has any questions you can walk

964
00:37:09,540 --> 00:37:11,940
up to the mic stand in the middle of the

965
00:37:11,940 --> 00:37:14,400
uh of the walkway you can ask your

966
00:37:14,400 --> 00:37:17,180
questions throughout

967
00:37:17,240 --> 00:37:19,920
no one has any questions

968
00:37:19,920 --> 00:37:22,380
I think it was a very clear presentation

969
00:37:22,380 --> 00:37:24,859
sorry

970
00:37:27,599 --> 00:37:30,380
oh yeah

971
00:37:30,480 --> 00:37:32,970
true

972
00:37:32,970 --> 00:37:39,928
[Applause]

973
00:37:41,940 --> 00:37:45,180
so so I accept a question so you were

974
00:37:45,180 --> 00:37:47,099
talking here about the perfect blue team

975
00:37:47,099 --> 00:37:49,740
obviously don't they always face the

976
00:37:49,740 --> 00:37:51,540
perfect blue the blue team sometimes you

977
00:37:51,540 --> 00:37:53,940
just not as good as you expect them to

978
00:37:53,940 --> 00:37:57,060
to be so do you have any tricks or

979
00:37:57,060 --> 00:38:00,359
techniques to estimate the capability

980
00:38:00,359 --> 00:38:02,099
and maturity of the blue team and then

981
00:38:02,099 --> 00:38:04,320
determine how much time you want to

982
00:38:04,320 --> 00:38:05,760
spend in all the techniques as you

983
00:38:05,760 --> 00:38:07,380
showed because otherwise it's just a

984
00:38:07,380 --> 00:38:08,579
waste of time

985
00:38:08,579 --> 00:38:11,460
I think it's mostly just checking how

986
00:38:11,460 --> 00:38:13,140
mature a company would look from the

987
00:38:13,140 --> 00:38:14,640
outside and how mature you would expect

988
00:38:14,640 --> 00:38:17,400
them to be if you for example go up

989
00:38:17,400 --> 00:38:19,619
against a bank you would expect them to

990
00:38:19,619 --> 00:38:22,079
be quite mature so you would Implement a

991
00:38:22,079 --> 00:38:24,359
lot of these strategies if you are up

992
00:38:24,359 --> 00:38:27,300
against just a random company that is

993
00:38:27,300 --> 00:38:30,300
like for example in biogenetics or

994
00:38:30,300 --> 00:38:32,040
something they don't focus on security

995
00:38:32,040 --> 00:38:34,740
so for them you can skip a lot of these

996
00:38:34,740 --> 00:38:36,480
measures already but you need to be

997
00:38:36,480 --> 00:38:38,040
careful because it's always a balance

998
00:38:38,040 --> 00:38:40,260
right but then this way we can already

999
00:38:40,260 --> 00:38:42,780
make a first estimation and then also

1000
00:38:42,780 --> 00:38:45,359
just from experience we know which

1001
00:38:45,359 --> 00:38:47,579
financial institutions are better than

1002
00:38:47,579 --> 00:38:50,040
the others so we can already make our

1003
00:38:50,040 --> 00:38:53,940
estimation ourselves beforehand yeah

1004
00:38:53,940 --> 00:38:56,119
foreign

1005
00:38:58,140 --> 00:39:00,900
for example monitor your locks or set up

1006
00:39:00,900 --> 00:39:03,780
some like Honeypot systems to monitor if

1007
00:39:03,780 --> 00:39:06,000
the blue team is actually taking actions

1008
00:39:06,000 --> 00:39:08,040
is that your opinion worth taking

1009
00:39:08,040 --> 00:39:10,260
spending time on it's honestly it's

1010
00:39:10,260 --> 00:39:12,900
something that I haven't done much to to

1011
00:39:12,900 --> 00:39:14,760
like try and detect what the blue team

1012
00:39:14,760 --> 00:39:16,680
is doing

1013
00:39:16,680 --> 00:39:18,300
but it would be definitely very

1014
00:39:18,300 --> 00:39:20,760
interesting to oh when you should like

1015
00:39:20,760 --> 00:39:22,619
leave one campaign alone and not put

1016
00:39:22,619 --> 00:39:25,140
more indicators into it

1017
00:39:25,140 --> 00:39:28,220
cool thanks a lot

1018
00:39:28,680 --> 00:39:30,599
yes

1019
00:39:30,599 --> 00:39:34,140
um so you just explained to us how you

1020
00:39:34,140 --> 00:39:36,599
actually were able to bypass some of the

1021
00:39:36,599 --> 00:39:38,300
technologies that you already

1022
00:39:38,300 --> 00:39:39,980
encountered

1023
00:39:39,980 --> 00:39:42,660
however how would you deal with that if

1024
00:39:42,660 --> 00:39:45,300
you are in a blind environment how would

1025
00:39:45,300 --> 00:39:47,180
you discover what technology

1026
00:39:47,180 --> 00:39:49,500
the company that you are trying to

1027
00:39:49,500 --> 00:39:51,720
attack is actually using do you mean

1028
00:39:51,720 --> 00:39:54,000
from the external before we launch the

1029
00:39:54,000 --> 00:39:55,560
fish or when we're already busy with the

1030
00:39:55,560 --> 00:39:58,200
fish uh no after the fishing in second

1031
00:39:58,200 --> 00:40:00,420
after the fish yeah so for example

1032
00:40:00,420 --> 00:40:04,319
bypassing office protection so yeah

1033
00:40:04,319 --> 00:40:07,020
um you might for example encounter an

1034
00:40:07,020 --> 00:40:10,260
issue having a your payload executed but

1035
00:40:10,260 --> 00:40:12,359
how would you actually know that they

1036
00:40:12,359 --> 00:40:14,520
are using specific type of technology so

1037
00:40:14,520 --> 00:40:16,940
you can bypass it in a specific method

1038
00:40:16,940 --> 00:40:19,440
so one of the things that I like to do

1039
00:40:19,440 --> 00:40:21,300
if I'm not sure what I will come up

1040
00:40:21,300 --> 00:40:24,540
against is with our Word document we

1041
00:40:24,540 --> 00:40:26,579
will actually inject in the word

1042
00:40:26,579 --> 00:40:28,500
document itself so we stay in the

1043
00:40:28,500 --> 00:40:31,619
process and this way we have minimal of

1044
00:40:31,619 --> 00:40:34,140
Rules from the attack surface reduction

1045
00:40:34,140 --> 00:40:37,200
that might be triggered and block us so

1046
00:40:37,200 --> 00:40:39,660
because we are done in the word profile

1047
00:40:39,660 --> 00:40:42,660
in the word process itself we can then

1048
00:40:42,660 --> 00:40:44,520
see and do a reconnaissance on the

1049
00:40:44,520 --> 00:40:46,319
system we can check okay what attack

1050
00:40:46,319 --> 00:40:47,940
surface reduction rules that they have

1051
00:40:47,940 --> 00:40:49,859
if they're an app locker and then with

1052
00:40:49,859 --> 00:40:52,680
those into place we can then try to go

1053
00:40:52,680 --> 00:40:54,300
further into it

1054
00:40:54,300 --> 00:40:57,079
thank you

1055
00:40:57,300 --> 00:41:00,599
you okay I'm in the back yeah hi uh

1056
00:41:00,599 --> 00:41:03,720
would you say that uh put in a link in

1057
00:41:03,720 --> 00:41:06,300
an interactive PDF while trying to fish

1058
00:41:06,300 --> 00:41:08,400
for credentials is more efficient than

1059
00:41:08,400 --> 00:41:12,300
having the link in the email itself

1060
00:41:12,300 --> 00:41:13,079
um

1061
00:41:13,079 --> 00:41:15,660
I always put it in the email itself

1062
00:41:15,660 --> 00:41:18,300
because it's like one step that you can

1063
00:41:18,300 --> 00:41:20,760
avoid the user to do so they can just

1064
00:41:20,760 --> 00:41:22,500
open the link and the phishing page is

1065
00:41:22,500 --> 00:41:24,780
there if you do the PDF they need to

1066
00:41:24,780 --> 00:41:27,060
open the PDF click on the link so it's

1067
00:41:27,060 --> 00:41:30,060
an extra step for them but of course I

1068
00:41:30,060 --> 00:41:32,760
understand why you would do it in an in

1069
00:41:32,760 --> 00:41:35,400
a PDF because then you don't have the

1070
00:41:35,400 --> 00:41:37,560
scanners going through it I can say

1071
00:41:37,560 --> 00:41:40,500
cloudflare I'll use of cloudflare you

1072
00:41:40,500 --> 00:41:42,359
can actually use the bot protection from

1073
00:41:42,359 --> 00:41:44,760
cloudflare in front of the link and this

1074
00:41:44,760 --> 00:41:47,400
way the bot protections cannot all right

1075
00:41:47,400 --> 00:41:50,940
the automatic analysis can not see

1076
00:41:50,940 --> 00:41:53,400
what's behind the URL and this way the

1077
00:41:53,400 --> 00:41:55,260
user can just click on the link and go

1078
00:41:55,260 --> 00:41:57,960
and the Bots can't see anything

1079
00:41:57,960 --> 00:42:00,480
we're we're all familiar with the Google

1080
00:42:00,480 --> 00:42:03,900
Chrome red page which is suspicious so

1081
00:42:03,900 --> 00:42:06,000
do you have

1082
00:42:06,000 --> 00:42:08,400
um some kind of controlled redirection

1083
00:42:08,400 --> 00:42:11,160
that in case your landing page goes red

1084
00:42:11,160 --> 00:42:13,200
that you would change that redirection

1085
00:42:13,200 --> 00:42:17,880
to another page which is let's say green

1086
00:42:17,880 --> 00:42:19,920
um do you mean that if one of my pages

1087
00:42:19,920 --> 00:42:23,040
is already burned

1088
00:42:23,040 --> 00:42:25,859
um well I think if your domain is

1089
00:42:25,859 --> 00:42:27,540
already burned you should stay away from

1090
00:42:27,540 --> 00:42:29,720
it don't try to correlate other things

1091
00:42:29,720 --> 00:42:32,640
oh okay so don't try to correlate other

1092
00:42:32,640 --> 00:42:34,319
domains to it because that might just

1093
00:42:34,319 --> 00:42:36,540
get them burned straight away what I try

1094
00:42:36,540 --> 00:42:38,400
to do is just avoid them from being

1095
00:42:38,400 --> 00:42:40,920
burned from external so I will use

1096
00:42:40,920 --> 00:42:43,020
always a domain that looks legit for

1097
00:42:43,020 --> 00:42:45,240
example the same the same Finance

1098
00:42:45,240 --> 00:42:47,280
template that I used to let it be

1099
00:42:47,280 --> 00:42:49,740
categorized and then only like for

1100
00:42:49,740 --> 00:42:51,660
example the packets that are necessary

1101
00:42:51,660 --> 00:42:54,599
for the back end those are forwarded the

1102
00:42:54,599 --> 00:42:57,240
rest always is the front so Google they

1103
00:42:57,240 --> 00:42:59,220
use automatic Scanners from the for the

1104
00:42:59,220 --> 00:43:00,839
internet and then based on that they

1105
00:43:00,839 --> 00:43:03,420
will see if it's suspicious or not and I

1106
00:43:03,420 --> 00:43:05,040
will just try to block those Scanners

1107
00:43:05,040 --> 00:43:06,839
from the beginning on so they don't have

1108
00:43:06,839 --> 00:43:09,780
a chance of marketing it as suspicious I

1109
00:43:09,780 --> 00:43:12,780
see but my question was about after your

1110
00:43:12,780 --> 00:43:14,760
launch your campaign and you've sent

1111
00:43:14,760 --> 00:43:17,339
already a lot of emails to the employees

1112
00:43:17,339 --> 00:43:19,859
and everything let's say you finish to

1113
00:43:19,859 --> 00:43:22,460
sending and then your page

1114
00:43:22,460 --> 00:43:25,740
burned yeah well if it's burnt and I

1115
00:43:25,740 --> 00:43:28,440
don't have any measures for that if if

1116
00:43:28,440 --> 00:43:30,240
one of the pages is burnt then it's just

1117
00:43:30,240 --> 00:43:31,680
useless and then we should stay away

1118
00:43:31,680 --> 00:43:35,160
from it don't try to make it redirect to

1119
00:43:35,160 --> 00:43:37,140
another page for example because then

1120
00:43:37,140 --> 00:43:39,440
that other page might be burnt as well

1121
00:43:39,440 --> 00:43:42,859
okay thank you no problem

1122
00:43:42,859 --> 00:43:46,800
uh so with the company setting up to

1123
00:43:46,800 --> 00:43:49,500
teach people to fish with red teaming

1124
00:43:49,500 --> 00:43:51,720
techniques have you also considered your

1125
00:43:51,720 --> 00:43:53,579
platform being used by actual

1126
00:43:53,579 --> 00:43:55,440
adversaries

1127
00:43:55,440 --> 00:43:57,900
to include in the fish like in the

1128
00:43:57,900 --> 00:44:01,140
course uh yes no that they can use your

1129
00:44:01,140 --> 00:44:03,839
platform to get to know the techniques

1130
00:44:03,839 --> 00:44:06,720
to send actual phishing emails yes at a

1131
00:44:06,720 --> 00:44:08,520
very high level it's of course indeed

1132
00:44:08,520 --> 00:44:10,200
like the very ethical question right

1133
00:44:10,200 --> 00:44:12,420
like if I'm putting out all of these

1134
00:44:12,420 --> 00:44:14,819
techniques we will actually be able to

1135
00:44:14,819 --> 00:44:17,220
access them will I be teaching more like

1136
00:44:17,220 --> 00:44:19,859
the the bad guys than the good guys and

1137
00:44:19,859 --> 00:44:22,319
I'm actually convinced that because we

1138
00:44:22,319 --> 00:44:25,020
are like limited and what we can do we

1139
00:44:25,020 --> 00:44:26,520
should be able to have more information

1140
00:44:26,520 --> 00:44:29,220
on our side so with my course I try to

1141
00:44:29,220 --> 00:44:32,460
teach more good guys than bad guys so

1142
00:44:32,460 --> 00:44:34,319
the balance is tipping more towards the

1143
00:44:34,319 --> 00:44:37,619
good guys okay thank you but it's indeed

1144
00:44:37,619 --> 00:44:39,540
a very good question one that I've been

1145
00:44:39,540 --> 00:44:41,640
thinking about a lot like how could I

1146
00:44:41,640 --> 00:44:44,280
maybe like make a shifting in that but

1147
00:44:44,280 --> 00:44:45,900
it's very hard because I would need a

1148
00:44:45,900 --> 00:44:48,060
background check for everyone then

1149
00:44:48,060 --> 00:44:49,980
and there are already like a lot of

1150
00:44:49,980 --> 00:44:52,319
courses for hacking and those are also

1151
00:44:52,319 --> 00:44:55,079
free for everyone so I just hope with

1152
00:44:55,079 --> 00:44:57,180
that there are more good guys actually

1153
00:44:57,180 --> 00:45:00,560
learning it than the bad guys

1154
00:45:00,900 --> 00:45:03,599
okay right so I don't think we have any

1155
00:45:03,599 --> 00:45:05,819
more questions from the audience do we

1156
00:45:05,819 --> 00:45:08,760
have any questions from online no so uh

1157
00:45:08,760 --> 00:45:11,160
this is it give it up again for about

1158
00:45:11,160 --> 00:45:14,299
first amazing talk

