1
00:00:01,280 --> 00:00:12,559
[Music]

2
00:00:13,820 --> 00:00:15,839
thank you

3
00:00:15,839 --> 00:00:19,080
okay here we go so the live demos are

4
00:00:19,080 --> 00:00:20,820
already going great so that promises

5
00:00:20,820 --> 00:00:24,480
good stuff for today so I'm Jasper I'm a

6
00:00:24,480 --> 00:00:27,060
technical cyber security specialist but

7
00:00:27,060 --> 00:00:30,960
I also do Media stuff like podcasts and

8
00:00:30,960 --> 00:00:32,520
fun fact I started the company here this

9
00:00:32,520 --> 00:00:37,020
week which I think is pretty cool so

10
00:00:38,219 --> 00:00:41,579
so I'm uh I'm also known as Muse I'm a

11
00:00:41,579 --> 00:00:46,559
pen tester at KPMG cyber uh I I love

12
00:00:46,559 --> 00:00:48,120
physical security I love physical

13
00:00:48,120 --> 00:00:50,160
devices you know and I really hate

14
00:00:50,160 --> 00:00:52,079
riding these small blurbs about myself

15
00:00:52,079 --> 00:00:53,340
so

16
00:00:53,340 --> 00:00:57,000
let's go on so how how do you roll into

17
00:00:57,000 --> 00:00:58,199
this so

18
00:00:58,199 --> 00:00:59,940
um a couple of years ago one of the

19
00:00:59,940 --> 00:01:02,039
major grocers in the Netherlands started

20
00:01:02,039 --> 00:01:03,960
handing out like Loyalty cards so

21
00:01:03,960 --> 00:01:05,880
basically it's a card you get and if you

22
00:01:05,880 --> 00:01:07,560
scan the card before every purchase you

23
00:01:07,560 --> 00:01:10,080
get like a small discount on certain

24
00:01:10,080 --> 00:01:12,540
products and it's there's sort of entry

25
00:01:12,540 --> 00:01:15,000
into the the Big Data thing they want to

26
00:01:15,000 --> 00:01:16,500
do on all their customers and I was like

27
00:01:16,500 --> 00:01:18,540
this is interesting so six years ago I

28
00:01:18,540 --> 00:01:20,460
was doing this really naively and I was

29
00:01:20,460 --> 00:01:22,860
like how can I mess around with this so

30
00:01:22,860 --> 00:01:25,380
I just got like 10 bonus cards at the

31
00:01:25,380 --> 00:01:27,360
grocery like just got them from the from

32
00:01:27,360 --> 00:01:29,579
teller and I had a whole stack and just

33
00:01:29,579 --> 00:01:31,439
started noting down the numbers and I

34
00:01:31,439 --> 00:01:33,360
noticed that they were all sort of

35
00:01:33,360 --> 00:01:35,700
similar they had just 13 digits they all

36
00:01:35,700 --> 00:01:37,740
had the same starting sequence

37
00:01:37,740 --> 00:01:40,619
and um you could actually use them on

38
00:01:40,619 --> 00:01:43,259
the uh website of the grocer at the time

39
00:01:43,259 --> 00:01:45,600
you just filled in the number and it

40
00:01:45,600 --> 00:01:47,040
would tell you what your last purchases

41
00:01:47,040 --> 00:01:48,840
were there was no other sort of

42
00:01:48,840 --> 00:01:51,060
validation it was interesting

43
00:01:51,060 --> 00:01:53,579
and um I noticed a small sort of race

44
00:01:53,579 --> 00:01:55,740
condition some of the numbers I just

45
00:01:55,740 --> 00:01:58,500
randomly made up were instantly declined

46
00:01:58,500 --> 00:02:00,659
and the numbers that were sort of valid

47
00:02:00,659 --> 00:02:03,180
it took like half a second later so I

48
00:02:03,180 --> 00:02:04,560
noticed there was like a sort of

49
00:02:04,560 --> 00:02:06,540
pre-validation and that actually

50
00:02:06,540 --> 00:02:08,878
indicated there was a check bit so

51
00:02:08,878 --> 00:02:11,340
all that taken together I realized these

52
00:02:11,340 --> 00:02:13,020
are actually product codes so the same

53
00:02:13,020 --> 00:02:14,280
thing that you have on a pack of cookies

54
00:02:14,280 --> 00:02:18,180
now the user is the product too so

55
00:02:18,180 --> 00:02:20,959
um but the nice thing is this

56
00:02:20,959 --> 00:02:24,720
this also allowed me to sort of uh

57
00:02:24,720 --> 00:02:26,580
figure out what the conditions were for

58
00:02:26,580 --> 00:02:29,040
a valid uh we call them bonus cards it

59
00:02:29,040 --> 00:02:30,540
was really simple it needed to be within

60
00:02:30,540 --> 00:02:32,220
a certain range because it's a reserve

61
00:02:32,220 --> 00:02:34,500
range in like a large database and it

62
00:02:34,500 --> 00:02:36,720
just needed to have a valid Checkmate so

63
00:02:36,720 --> 00:02:39,060
I could create all the bonus cards and

64
00:02:39,060 --> 00:02:41,040
even funnier I could create what

65
00:02:41,040 --> 00:02:42,599
technically would be the first ever

66
00:02:42,599 --> 00:02:44,220
bonus card because I knew the lower

67
00:02:44,220 --> 00:02:46,200
bounce and it could just generate that

68
00:02:46,200 --> 00:02:49,620
so I don't know some engineer in in that

69
00:02:49,620 --> 00:02:51,780
Grocer's card probably was his testing

70
00:02:51,780 --> 00:02:53,160
card or something like that but also

71
00:02:53,160 --> 00:02:55,319
random cars and the funny thing is even

72
00:02:55,319 --> 00:02:58,260
though I did that six years ago

73
00:02:58,260 --> 00:03:00,360
they're still valid I could register

74
00:03:00,360 --> 00:03:02,819
them yesterday on the website this bonus

75
00:03:02,819 --> 00:03:04,860
card number is actually the number I got

76
00:03:04,860 --> 00:03:07,620
six years ago because they still allow

77
00:03:07,620 --> 00:03:09,120
the ranges they did change the

78
00:03:09,120 --> 00:03:11,159
validation model a bit so you now have

79
00:03:11,159 --> 00:03:12,959
to register a proper account and you

80
00:03:12,959 --> 00:03:14,340
just connect the bonus card to your

81
00:03:14,340 --> 00:03:16,140
account so there's no the card doesn't

82
00:03:16,140 --> 00:03:19,739
do anything more in terms of access but

83
00:03:19,739 --> 00:03:24,140
um they um do have distill all the old

84
00:03:24,140 --> 00:03:26,519
ranges so I could release all costs but

85
00:03:26,519 --> 00:03:27,720
even funnier

86
00:03:27,720 --> 00:03:30,480
even The Not So valid guards like zero

87
00:03:30,480 --> 00:03:33,180
zero Zine zero zero zero zero zero zero

88
00:03:33,180 --> 00:03:35,459
seven I could still register those as

89
00:03:35,459 --> 00:03:37,440
well and those are not cards I actually

90
00:03:37,440 --> 00:03:40,280
had at any point

91
00:03:40,739 --> 00:03:43,860
yeah so yeah so uh there are also some

92
00:03:43,860 --> 00:03:45,659
other attacks with barcodes and we jump

93
00:03:45,659 --> 00:03:47,459
a little bit to QR codes but we'll

94
00:03:47,459 --> 00:03:49,080
regard them a little bit as the same and

95
00:03:49,080 --> 00:03:51,120
we'll come back to that in a moment but

96
00:03:51,120 --> 00:03:53,700
for example what happens in in China for

97
00:03:53,700 --> 00:03:54,720
example

98
00:03:54,720 --> 00:03:56,939
um a lot of people pay with QR code so

99
00:03:56,939 --> 00:03:58,739
it's like it works a little bit like a

100
00:03:58,739 --> 00:04:01,140
tiki and what you can do as an adversary

101
00:04:01,140 --> 00:04:02,760
and what's really a problem there as

102
00:04:02,760 --> 00:04:05,040
well is that you can print your own

103
00:04:05,040 --> 00:04:06,239
barcode

104
00:04:06,239 --> 00:04:08,580
um paste it over a barcode or for

105
00:04:08,580 --> 00:04:10,799
example a shop and then you can just uh

106
00:04:10,799 --> 00:04:12,480
yeah well get the income steal the

107
00:04:12,480 --> 00:04:14,700
income of the shop and this seems a

108
00:04:14,700 --> 00:04:16,680
little bit far from home maybe but let

109
00:04:16,680 --> 00:04:20,220
me see if it works yeah you can also do

110
00:04:20,220 --> 00:04:22,560
this for example while shoplifting so

111
00:04:22,560 --> 00:04:24,300
you can paste over a barcode over

112
00:04:24,300 --> 00:04:27,300
another for cheaper products would work

113
00:04:27,300 --> 00:04:30,300
and even more modern you now have those

114
00:04:30,300 --> 00:04:32,940
like those sharing write services and

115
00:04:32,940 --> 00:04:35,280
they also have these barcodes so if you

116
00:04:35,280 --> 00:04:37,560
walk up to one of those for the first

117
00:04:37,560 --> 00:04:39,900
time you have this barcode you scan it

118
00:04:39,900 --> 00:04:41,220
you go to the website you can download

119
00:04:41,220 --> 00:04:44,100
the app couple your credit card a small

120
00:04:44,100 --> 00:04:46,919
exclamation mark so also people just

121
00:04:46,919 --> 00:04:49,380
paste it over another QR code to their

122
00:04:49,380 --> 00:04:51,479
own portal with where you can enter your

123
00:04:51,479 --> 00:04:53,400
credit card details on the malicious

124
00:04:53,400 --> 00:04:56,160
side and if you have a little bit of a

125
00:04:56,160 --> 00:04:58,380
lower kind of style for Tech you could

126
00:04:58,380 --> 00:04:59,580
even

127
00:04:59,580 --> 00:05:01,620
um it's a bit more complicated but you

128
00:05:01,620 --> 00:05:03,840
could if you want to rent a scooter you

129
00:05:03,840 --> 00:05:05,639
take a picture of the QR code of your

130
00:05:05,639 --> 00:05:07,380
scooter you paste that over another

131
00:05:07,380 --> 00:05:09,539
scooter somebody else base and you drive

132
00:05:09,539 --> 00:05:11,780
with your scooter away

133
00:05:11,780 --> 00:05:15,060
so in short a lot of fun things with

134
00:05:15,060 --> 00:05:17,520
barcodes and that started as thinking a

135
00:05:17,520 --> 00:05:19,259
little bit

136
00:05:19,259 --> 00:05:22,440
there we go so um one of the interesting

137
00:05:22,440 --> 00:05:25,080
attacks that's also possible and it sort

138
00:05:25,080 --> 00:05:27,840
of goes onto the replacing effects in

139
00:05:27,840 --> 00:05:29,639
Dutch we have static health or as the

140
00:05:29,639 --> 00:05:31,380
Germans know it's fund

141
00:05:31,380 --> 00:05:34,979
um so we have a found on plastic bottles

142
00:05:34,979 --> 00:05:36,960
and it basically means you pay a small

143
00:05:36,960 --> 00:05:38,759
fee you get a plastic bottle with the

144
00:05:38,759 --> 00:05:40,440
drink in it and afterwards you return a

145
00:05:40,440 --> 00:05:42,000
bottle for recycling which is a really

146
00:05:42,000 --> 00:05:44,940
nice system there's a whole industry of

147
00:05:44,940 --> 00:05:47,520
what they call reverse fending that's

148
00:05:47,520 --> 00:05:48,780
basically you put the bottle in a

149
00:05:48,780 --> 00:05:50,759
machine the machine scans it and it

150
00:05:50,759 --> 00:05:53,699
gives you like a small ticket for

151
00:05:53,699 --> 00:05:56,160
um for your static health or the amount

152
00:05:56,160 --> 00:05:58,199
that the bottle is worth

153
00:05:58,199 --> 00:05:58,800
um

154
00:05:58,800 --> 00:06:01,139
however in the older version of the

155
00:06:01,139 --> 00:06:03,479
systems the little ticket you got had a

156
00:06:03,479 --> 00:06:04,860
barcode on it and the barcode was

157
00:06:04,860 --> 00:06:06,960
nothing else than a product code and at

158
00:06:06,960 --> 00:06:09,120
the end it just said something like zero

159
00:06:09,120 --> 00:06:12,419
two five or one two five which just

160
00:06:12,419 --> 00:06:14,340
happened to be the amount you were due

161
00:06:14,340 --> 00:06:16,680
to get back so

162
00:06:16,680 --> 00:06:19,020
um you could actually just replicate

163
00:06:19,020 --> 00:06:21,960
copy just cut them out again or even

164
00:06:21,960 --> 00:06:24,539
create your own barcodes and this was

165
00:06:24,539 --> 00:06:26,520
really popular on the students I think

166
00:06:26,520 --> 00:06:29,340
that uh 10 15 years ago many drink

167
00:06:29,340 --> 00:06:32,400
budgets for students was subsidized by

168
00:06:32,400 --> 00:06:34,800
this kind of things but nowadays they

169
00:06:34,800 --> 00:06:37,199
they changed it so it's a unique ID you

170
00:06:37,199 --> 00:06:39,360
get a barcode and that's actually does

171
00:06:39,360 --> 00:06:42,000
the transaction ID and the system the

172
00:06:42,000 --> 00:06:44,039
return vending machine is connected to

173
00:06:44,039 --> 00:06:47,039
the uh to the teller so you get a code

174
00:06:47,039 --> 00:06:49,500
that's valid for one-time use it gets

175
00:06:49,500 --> 00:06:50,699
scanned you get the amount that's

176
00:06:50,699 --> 00:06:53,819
connected to it and it also has a

177
00:06:53,819 --> 00:06:55,259
limited validity and this is actually

178
00:06:55,259 --> 00:06:58,139
interesting because the tickets legally

179
00:06:58,139 --> 00:07:01,020
they're sort a valid for five years but

180
00:07:01,020 --> 00:07:02,759
the machine actually doesn't maintain

181
00:07:02,759 --> 00:07:05,520
more than about two weeks of code so if

182
00:07:05,520 --> 00:07:07,860
you ever forget one of your tickets

183
00:07:07,860 --> 00:07:09,720
um you'll bring it to the to the teller

184
00:07:09,720 --> 00:07:11,340
they'll say oh I can scan it this is

185
00:07:11,340 --> 00:07:13,020
computer says no

186
00:07:13,020 --> 00:07:14,340
um you have to go to the help desk

187
00:07:14,340 --> 00:07:16,560
because they actually can still validate

188
00:07:16,560 --> 00:07:17,940
those tickets but that's just because

189
00:07:17,940 --> 00:07:21,000
they had to do some kind of fix to make

190
00:07:21,000 --> 00:07:22,800
it more secure

191
00:07:22,800 --> 00:07:24,599
um at least that's how I think it works

192
00:07:24,599 --> 00:07:26,759
I mean you never know you Hope they've

193
00:07:26,759 --> 00:07:29,479
learned at some point

194
00:07:30,000 --> 00:07:32,460
yeah so the picture is not great but I

195
00:07:32,460 --> 00:07:33,840
also wanted to touch on this example

196
00:07:33,840 --> 00:07:35,400
this was a couple of years ago it was

197
00:07:35,400 --> 00:07:37,440
also a Defcon talk and it's about flight

198
00:07:37,440 --> 00:07:38,900
tickets because they also use

199
00:07:38,900 --> 00:07:41,340
standardized barcodes on flight tickets

200
00:07:41,340 --> 00:07:43,979
and what's funny is that there's all

201
00:07:43,979 --> 00:07:46,259
kinds of fun information printed on it

202
00:07:46,259 --> 00:07:48,120
as well I hope you can see it I think

203
00:07:48,120 --> 00:07:50,520
not but stuff like your name your flight

204
00:07:50,520 --> 00:07:52,919
number your destination where flying

205
00:07:52,919 --> 00:07:56,819
from your seat Etc and so if you want to

206
00:07:56,819 --> 00:07:58,979
know more about this you could edit it I

207
00:07:58,979 --> 00:08:00,360
don't know if that's still possible but

208
00:08:00,360 --> 00:08:01,560
you could just change your flight

209
00:08:01,560 --> 00:08:04,199
details or for example if other people

210
00:08:04,199 --> 00:08:06,300
post like a picture on Instagram with

211
00:08:06,300 --> 00:08:08,479
their flight details she also got name

212
00:08:08,479 --> 00:08:10,800
and some flight details and on most

213
00:08:10,800 --> 00:08:12,780
website with just these details you can

214
00:08:12,780 --> 00:08:14,759
also log in and see more information

215
00:08:14,759 --> 00:08:16,860
about your account with the the flight

216
00:08:16,860 --> 00:08:21,300
operator so a lot of fun so that was all

217
00:08:21,300 --> 00:08:23,759
um fun things that you could do with

218
00:08:23,759 --> 00:08:25,440
barcodes so then we delve a little bit

219
00:08:25,440 --> 00:08:30,620
deeper in this barcode phenomenon

220
00:08:32,099 --> 00:08:35,279
there we go so let's dive deep a bit

221
00:08:35,279 --> 00:08:37,140
deeper into how do barcodes work or what

222
00:08:37,140 --> 00:08:38,940
are they actually so what are barcodes

223
00:08:38,940 --> 00:08:42,179
it's actually a machine readable

224
00:08:42,179 --> 00:08:44,279
information it's it's made for a machine

225
00:08:44,279 --> 00:08:46,920
to be read and the data is encoded in

226
00:08:46,920 --> 00:08:49,860
the variations in the width and spacing

227
00:08:49,860 --> 00:08:52,500
so originally this will

228
00:08:52,500 --> 00:08:55,680
um patented in like I think 1951 and it

229
00:08:55,680 --> 00:08:58,860
was uh the idea the concept was based

230
00:08:58,860 --> 00:09:00,540
sort of a morse code so the guy that

231
00:09:00,540 --> 00:09:02,100
made it up was thinking like Morse code

232
00:09:02,100 --> 00:09:04,440
it has like a nice sort of pattern and

233
00:09:04,440 --> 00:09:06,060
they actually created barcodes with that

234
00:09:06,060 --> 00:09:07,140
idea

235
00:09:07,140 --> 00:09:11,040
and um it's it has a lot of old it's

236
00:09:11,040 --> 00:09:12,779
it's really old so there's a lot of fun

237
00:09:12,779 --> 00:09:15,060
Legacy stuff in there it's still used

238
00:09:15,060 --> 00:09:17,339
nowadays because there's nothing else

239
00:09:17,339 --> 00:09:20,100
that's as good readable or as quick as

240
00:09:20,100 --> 00:09:23,220
readable as barcodes I think even at the

241
00:09:23,220 --> 00:09:25,200
time something like British Railways

242
00:09:25,200 --> 00:09:28,080
found out a way to read barcodes on the

243
00:09:28,080 --> 00:09:29,459
side of containers while they were going

244
00:09:29,459 --> 00:09:31,019
like 100 miles an hour or something like

245
00:09:31,019 --> 00:09:33,839
that they were actually scanning trains

246
00:09:33,839 --> 00:09:36,000
in transit and the nice thing about this

247
00:09:36,000 --> 00:09:38,360
barcode is technically it has like a

248
00:09:38,360 --> 00:09:42,120
99.9 fault tolerance but only vertically

249
00:09:42,120 --> 00:09:44,640
so you always see it will get a cut

250
00:09:44,640 --> 00:09:46,920
through the middle

251
00:09:46,920 --> 00:09:50,399
so we have two kind of barcode shapes so

252
00:09:50,399 --> 00:09:51,420
we have the what we call the

253
00:09:51,420 --> 00:09:52,980
one-dimensional barcodes which is the

254
00:09:52,980 --> 00:09:56,160
regular stripe ones that you know and we

255
00:09:56,160 --> 00:09:58,140
have the 2D barcode so the 2D barcodes

256
00:09:58,140 --> 00:10:00,720
are the newer ones that we've all grown

257
00:10:00,720 --> 00:10:02,760
a bit more familiar with like QR codes

258
00:10:02,760 --> 00:10:05,220
we have Aztec we have data Matrix we

259
00:10:05,220 --> 00:10:07,380
have dot code and they're all different

260
00:10:07,380 --> 00:10:11,100
ways of encoding data and the sort of

261
00:10:11,100 --> 00:10:13,200
overarching feature is they're all

262
00:10:13,200 --> 00:10:16,140
standards so there's no sort of global

263
00:10:16,140 --> 00:10:18,899
way of of how to put data in there it's

264
00:10:18,899 --> 00:10:21,300
always somebody made a definition of how

265
00:10:21,300 --> 00:10:23,160
to encode it it says you put the data in

266
00:10:23,160 --> 00:10:24,839
like this for instance with a QR code

267
00:10:24,839 --> 00:10:27,240
you have masking and

268
00:10:27,240 --> 00:10:27,839
um

269
00:10:27,839 --> 00:10:31,079
it describes how data should be stored

270
00:10:31,079 --> 00:10:33,300
in the barcodes and if you look at a 1D

271
00:10:33,300 --> 00:10:35,160
barcodes for instance and we'll get to

272
00:10:35,160 --> 00:10:36,660
that later as well

273
00:10:36,660 --> 00:10:39,300
um we'll have like um and this is a

274
00:10:39,300 --> 00:10:41,339
couple of examples

275
00:10:41,339 --> 00:10:43,920
um you have like the the code

276
00:10:43,920 --> 00:10:45,420
definitions

277
00:10:45,420 --> 00:10:47,640
um the nice thing is for the 2D barcodes

278
00:10:47,640 --> 00:10:49,380
they actually have proper fault

279
00:10:49,380 --> 00:10:52,500
tolerance so you can miss like 75 of the

280
00:10:52,500 --> 00:10:54,480
of the QR code and it will still be

281
00:10:54,480 --> 00:10:56,100
readable because the data can be

282
00:10:56,100 --> 00:10:57,920
reconstructed

283
00:10:57,920 --> 00:11:01,320
so um it's all standards so we have

284
00:11:01,320 --> 00:11:05,640
something like code 128 or which is an

285
00:11:05,640 --> 00:11:07,200
encoding standard for barcodes and it

286
00:11:07,200 --> 00:11:09,420
also includes check bits so when you

287
00:11:09,420 --> 00:11:11,040
scan a barcode the scanner actually

288
00:11:11,040 --> 00:11:13,800
knows did I read this correctly and it

289
00:11:13,800 --> 00:11:16,140
also knows did I read it upside down or

290
00:11:16,140 --> 00:11:18,660
not uh you have code 39 which is really

291
00:11:18,660 --> 00:11:20,100
interesting because it's more like a

292
00:11:20,100 --> 00:11:22,680
font style barcode so the problem is the

293
00:11:22,680 --> 00:11:24,600
data density isn't that large because

294
00:11:24,600 --> 00:11:27,779
basically it has a specific barcode

295
00:11:27,779 --> 00:11:30,779
character so a combination of stripes in

296
00:11:30,779 --> 00:11:33,120
it for every single character it wants

297
00:11:33,120 --> 00:11:35,459
to encode and it's built in such a way

298
00:11:35,459 --> 00:11:38,820
that if you scan it halfway in between

299
00:11:38,820 --> 00:11:41,579
the characters that if you get the last

300
00:11:41,579 --> 00:11:43,680
bit of the first character in the first

301
00:11:43,680 --> 00:11:45,779
bit of the second character those don't

302
00:11:45,779 --> 00:11:48,000
combine into a proper character so

303
00:11:48,000 --> 00:11:49,500
there's no way to misread it and this is

304
00:11:49,500 --> 00:11:50,940
used in a lot of Legacy application

305
00:11:50,940 --> 00:11:52,920
because you don't actually need to

306
00:11:52,920 --> 00:11:54,779
calculate a barcode you can just put a

307
00:11:54,779 --> 00:11:56,700
font on a system and let it print

308
00:11:56,700 --> 00:11:58,680
whatever number you're originally

309
00:11:58,680 --> 00:12:01,019
wanting to print so different encoding

310
00:12:01,019 --> 00:12:03,839
different uses we have the UBC codes

311
00:12:03,839 --> 00:12:05,279
which was the product codes as well

312
00:12:05,279 --> 00:12:07,860
which we've already seen

313
00:12:07,860 --> 00:12:10,380
well now we talked about the barcodes

314
00:12:10,380 --> 00:12:11,880
themselves but now we're going to talk a

315
00:12:11,880 --> 00:12:13,560
little bit about the scanners it looks

316
00:12:13,560 --> 00:12:16,019
like this I think most of you have seen

317
00:12:16,019 --> 00:12:18,000
one and I have a question about that for

318
00:12:18,000 --> 00:12:20,820
you to think about for a moment so if

319
00:12:20,820 --> 00:12:22,380
you were a vendor and you want to create

320
00:12:22,380 --> 00:12:25,200
a cheap Barcode Scanner how would you

321
00:12:25,200 --> 00:12:26,760
make it

322
00:12:26,760 --> 00:12:28,980
just maybe think about that for a little

323
00:12:28,980 --> 00:12:30,720
moment

324
00:12:30,720 --> 00:12:33,180
um probably you want to have like a USB

325
00:12:33,180 --> 00:12:36,180
port because that's very popular maybe a

326
00:12:36,180 --> 00:12:39,000
serial connection of some sort

327
00:12:39,000 --> 00:12:39,600
um

328
00:12:39,600 --> 00:12:43,139
right well actually no because most

329
00:12:43,139 --> 00:12:45,240
barcode scanners

330
00:12:45,240 --> 00:12:47,579
are keyboards

331
00:12:47,579 --> 00:12:50,160
um so what does it actually mean at the

332
00:12:50,160 --> 00:12:52,560
barcode register itself as a keyboard to

333
00:12:52,560 --> 00:12:54,720
the computer and this is another a crazy

334
00:12:54,720 --> 00:12:56,700
like weird setting that you need to set

335
00:12:56,700 --> 00:12:58,800
this is the default mode for almost all

336
00:12:58,800 --> 00:13:01,380
modern barcode scanners that you can buy

337
00:13:01,380 --> 00:13:03,240
what it does if you scan a regular

338
00:13:03,240 --> 00:13:04,920
barcode so for example a product number

339
00:13:04,920 --> 00:13:07,440
it types in that product number and

340
00:13:07,440 --> 00:13:10,040
presses enter

341
00:13:10,320 --> 00:13:13,200
hmm

342
00:13:13,200 --> 00:13:16,579
what would go wrong

343
00:13:17,700 --> 00:13:18,899
so

344
00:13:18,899 --> 00:13:21,660
yes usb hid devices what could go wrong

345
00:13:21,660 --> 00:13:24,910
so technically it works as a keyboard

346
00:13:24,910 --> 00:13:29,140
[Laughter]

347
00:13:30,120 --> 00:13:32,940
yeah so then the next question is how do

348
00:13:32,940 --> 00:13:35,220
you think you would configure search a

349
00:13:35,220 --> 00:13:36,660
barcode scanner

350
00:13:36,660 --> 00:13:38,880
maybe you're thinking about proprietary

351
00:13:38,880 --> 00:13:43,440
tooling maybe some Hardware hacking well

352
00:13:43,440 --> 00:13:46,260
yeah yeah right of course you scan

353
00:13:46,260 --> 00:13:48,779
barcode so we have these huge manuals

354
00:13:48,779 --> 00:13:51,240
actually a lot of fun they're actually

355
00:13:51,240 --> 00:13:53,940
most of them are in Chinese so at the

356
00:13:53,940 --> 00:13:56,100
top right you see Rob trying to decipher

357
00:13:56,100 --> 00:13:57,959
some of the the text that's beneath them

358
00:13:57,959 --> 00:14:00,240
but you configure the barcode scanners

359
00:14:00,240 --> 00:14:03,139
with barcodes

360
00:14:03,139 --> 00:14:05,820
that's convenient user accessible even

361
00:14:05,820 --> 00:14:08,519
if we wanna yeah and most of the barcode

362
00:14:08,519 --> 00:14:11,160
scanners they are in the end input

363
00:14:11,160 --> 00:14:15,180
devices facing a user so you can uh well

364
00:14:15,180 --> 00:14:17,940
input everything you want in theory so

365
00:14:17,940 --> 00:14:19,740
for example some of the more interesting

366
00:14:19,740 --> 00:14:21,959
codes we found in the booklets are they

367
00:14:21,959 --> 00:14:24,660
can already see them Factory resets and

368
00:14:24,660 --> 00:14:26,699
you can switch the character sets of

369
00:14:26,699 --> 00:14:28,860
barcodes very fun maybe we'll see that

370
00:14:28,860 --> 00:14:31,440
in a moment as well you can switch to

371
00:14:31,440 --> 00:14:32,760
the serial mode

372
00:14:32,760 --> 00:14:34,560
but a lot of people and developers don't

373
00:14:34,560 --> 00:14:36,240
do that because that's very complicated

374
00:14:36,240 --> 00:14:38,579
nowadays you have to download this Shady

375
00:14:38,579 --> 00:14:40,560
driver from this Chinese website that

376
00:14:40,560 --> 00:14:42,540
enables or the other way around of

377
00:14:42,540 --> 00:14:45,300
course you you as a developer you set it

378
00:14:45,300 --> 00:14:47,699
up in serial mode think you're secure we

379
00:14:47,699 --> 00:14:52,079
just use B mode change character sets

380
00:14:52,079 --> 00:14:55,199
hmm interesting

381
00:14:55,199 --> 00:14:58,019
let me see next one

382
00:14:58,019 --> 00:14:59,579
so

383
00:14:59,579 --> 00:15:02,639
I think now is our first demo time hit

384
00:15:02,639 --> 00:15:03,959
it

385
00:15:03,959 --> 00:15:07,199
what could go wrong so

386
00:15:07,199 --> 00:15:11,000
just give a second for the camera yeah

387
00:15:14,519 --> 00:15:15,959
so

388
00:15:15,959 --> 00:15:18,720
let's take a regular sort of uh barcode

389
00:15:18,720 --> 00:15:20,160
so

390
00:15:20,160 --> 00:15:25,880
oh hold on for a sec demo effect no

391
00:15:27,899 --> 00:15:30,060
shall I explain the setup a little bit

392
00:15:30,060 --> 00:15:33,540
when we counter the demo effect today so

393
00:15:33,540 --> 00:15:35,820
we have we have a small e-ink reader and

394
00:15:35,820 --> 00:15:37,980
we prepared some barcodes for the demo

395
00:15:37,980 --> 00:15:39,839
today and Rob was Now quickly uh

396
00:15:39,839 --> 00:15:43,259
resetting resetting the thing

397
00:15:43,259 --> 00:15:44,579
um and what we're going to do on the

398
00:15:44,579 --> 00:15:48,000
screen you will see a notepad window and

399
00:15:48,000 --> 00:15:49,440
on the camera you can see that we're

400
00:15:49,440 --> 00:15:51,660
scanning something so let's imagine this

401
00:15:51,660 --> 00:15:53,579
is like your uh generator itself

402
00:15:53,579 --> 00:15:55,320
checkout

403
00:15:55,320 --> 00:15:57,839
Delaware machine so I just got a regular

404
00:15:57,839 --> 00:15:59,579
barcode and says test one two three four

405
00:15:59,579 --> 00:16:01,440
it works perfect that's what you want

406
00:16:01,440 --> 00:16:03,600
now I'll actually go to the manual of

407
00:16:03,600 --> 00:16:05,040
this device and it has this really nice

408
00:16:05,040 --> 00:16:08,399
barcode that said put me into zero mode

409
00:16:08,399 --> 00:16:10,440
it gave a nice beep so apparently it

410
00:16:10,440 --> 00:16:11,399
worked

411
00:16:11,399 --> 00:16:13,860
and now none of the barcodes will print

412
00:16:13,860 --> 00:16:15,360
out anymore

413
00:16:15,360 --> 00:16:17,699
so this is just a really simple sort of

414
00:16:17,699 --> 00:16:19,920
denial service attack we just set it

415
00:16:19,920 --> 00:16:21,839
into a mode that's not configured on the

416
00:16:21,839 --> 00:16:23,699
receiving system and all the barcodes

417
00:16:23,699 --> 00:16:25,199
will fail from this we put it back to

418
00:16:25,199 --> 00:16:26,339
USB mode

419
00:16:26,339 --> 00:16:29,420
and it will work again

420
00:16:31,079 --> 00:16:33,620
so

421
00:16:33,899 --> 00:16:35,639
now the next one and this is actually

422
00:16:35,639 --> 00:16:38,399
credit to pillar attacking

423
00:16:38,399 --> 00:16:40,259
um so in the manuals we found that

424
00:16:40,259 --> 00:16:42,240
language modes and we were like why is

425
00:16:42,240 --> 00:16:44,399
there a language mode in here like why

426
00:16:44,399 --> 00:16:46,800
do you need a language for a scanner so

427
00:16:46,800 --> 00:16:49,079
and then we figured out wait a minute

428
00:16:49,079 --> 00:16:52,320
it's a USB scanner that goes to a usb

429
00:16:52,320 --> 00:16:55,139
hid device and it like communicates scan

430
00:16:55,139 --> 00:16:57,839
codes the host system and then it uses

431
00:16:57,839 --> 00:17:00,480
key mapping and then it's text so that

432
00:17:00,480 --> 00:17:02,040
actually means that

433
00:17:02,040 --> 00:17:06,000
the key mapping on your machine matters

434
00:17:06,000 --> 00:17:08,760
well well so what can go wrong

435
00:17:08,760 --> 00:17:10,020
so

436
00:17:10,020 --> 00:17:13,199
I have another demo barcode and

437
00:17:13,199 --> 00:17:14,099
um

438
00:17:14,099 --> 00:17:17,160
let's put the camera on there thanks

439
00:17:17,160 --> 00:17:20,099
it's fun to see you close

440
00:17:20,099 --> 00:17:22,639
so

441
00:17:22,740 --> 00:17:24,780
what could go wrong I don't know but

442
00:17:24,780 --> 00:17:27,419
let's change my key mapping to something

443
00:17:27,419 --> 00:17:30,980
that a lot of hackers use the forek

444
00:17:33,059 --> 00:17:37,260
yes okay now we know what can go wrong

445
00:17:37,260 --> 00:17:39,600
let's put it back because otherwise I'm

446
00:17:39,600 --> 00:17:42,379
helplessly lost

447
00:17:43,140 --> 00:17:45,299
all right so now let's look at another

448
00:17:45,299 --> 00:17:47,340
interesting property so a little bit

449
00:17:47,340 --> 00:17:48,900
before in the presentation you saw that

450
00:17:48,900 --> 00:17:50,880
we had different kinds of standards for

451
00:17:50,880 --> 00:17:53,039
printing the barcodes but also some

452
00:17:53,039 --> 00:17:55,080
different standards for how the data is

453
00:17:55,080 --> 00:17:57,539
being interpreted uh one popular one is

454
00:17:57,539 --> 00:17:59,480
code 128

455
00:17:59,480 --> 00:18:03,020
and what it basically does is it Maps a

456
00:18:03,020 --> 00:18:07,320
120 128 character positions to the ASCII

457
00:18:07,320 --> 00:18:09,980
table I printed the ASCII table for you

458
00:18:09,980 --> 00:18:13,020
and well what we think happened is some

459
00:18:13,020 --> 00:18:15,660
vendors of those devices were looking at

460
00:18:15,660 --> 00:18:17,220
the stable and we're like

461
00:18:17,220 --> 00:18:22,260
hmm especially this half of the table

462
00:18:22,260 --> 00:18:24,299
if it works

463
00:18:24,299 --> 00:18:27,419
yeah we don't use those characters old

464
00:18:27,419 --> 00:18:29,580
serial Legacy stuff very modern now we

465
00:18:29,580 --> 00:18:33,539
use a USB yeah so Defenders we think

466
00:18:33,539 --> 00:18:36,960
thought we can swap those characters out

467
00:18:36,960 --> 00:18:39,179
for some more interesting combinations

468
00:18:39,179 --> 00:18:42,000
something more useful maybe control and

469
00:18:42,000 --> 00:18:44,520
a key control shift and a key

470
00:18:44,520 --> 00:18:46,020
Etc

471
00:18:46,020 --> 00:18:47,039
um

472
00:18:47,039 --> 00:18:49,860
we really like that if offenders do this

473
00:18:49,860 --> 00:18:52,200
and what's funny to mention is that

474
00:18:52,200 --> 00:18:55,140
there's no standard for this so we had

475
00:18:55,140 --> 00:18:56,700
like we have a couple of barcode

476
00:18:56,700 --> 00:18:59,280
scanners here they all work differently

477
00:18:59,280 --> 00:19:01,980
so probably Defenders thought well what

478
00:19:01,980 --> 00:19:04,080
are good keys to use let's just put it

479
00:19:04,080 --> 00:19:06,960
there document it nowhere in the world

480
00:19:06,960 --> 00:19:09,120
let's give the user all the options yeah

481
00:19:09,120 --> 00:19:11,340
so yeah then the next question would be

482
00:19:11,340 --> 00:19:14,178
of course

483
00:19:17,360 --> 00:19:20,820
let me see all right so let's put up the

484
00:19:20,820 --> 00:19:23,039
next demo this is our most sophisticated

485
00:19:23,039 --> 00:19:25,200
demo so I hope the demo got so will be

486
00:19:25,200 --> 00:19:27,000
with us

487
00:19:27,000 --> 00:19:30,960
um we we created a small uh well webshop

488
00:19:30,960 --> 00:19:32,160
portal

489
00:19:32,160 --> 00:19:33,960
um put a lot of effort on it um

490
00:19:33,960 --> 00:19:37,919
yesterday evening lots of coding uh so

491
00:19:37,919 --> 00:19:41,130
so imagine

492
00:19:41,130 --> 00:19:44,329
[Applause]

493
00:19:45,240 --> 00:19:46,500
but

494
00:19:46,500 --> 00:19:48,059
but this is how it might actually work

495
00:19:48,059 --> 00:19:50,160
like you have just a single computer in

496
00:19:50,160 --> 00:19:52,080
Kiosk mode and it basically has like

497
00:19:52,080 --> 00:19:54,539
this sort of thing where please use the

498
00:19:54,539 --> 00:19:56,220
scanner that's next to the thing and

499
00:19:56,220 --> 00:19:58,559
scan your products before you leave

500
00:19:58,559 --> 00:20:01,320
so then the question is what fun things

501
00:20:01,320 --> 00:20:03,900
could we do with especially this barcode

502
00:20:03,900 --> 00:20:06,960
scanner in this very simple software so

503
00:20:06,960 --> 00:20:09,240
we split it into different parts so I'll

504
00:20:09,240 --> 00:20:10,980
walk you through some of the thin steps

505
00:20:10,980 --> 00:20:13,740
that we came up with but this is just an

506
00:20:13,740 --> 00:20:14,780
example

507
00:20:14,780 --> 00:20:17,640
and so we prepared some of the barcodes

508
00:20:17,640 --> 00:20:20,280
so let's scan the first one I think this

509
00:20:20,280 --> 00:20:24,179
is Ctrl l so then most bus systems based

510
00:20:24,179 --> 00:20:27,179
on our browser already fill a little bit

511
00:20:27,179 --> 00:20:31,620
so okay what can we do next let me see

512
00:20:31,620 --> 00:20:34,380
I hope it skins okay proceed with

513
00:20:34,380 --> 00:20:36,360
caution that's probably good we can we

514
00:20:36,360 --> 00:20:39,059
can go to a configuration I think we can

515
00:20:39,059 --> 00:20:41,299
enhance the security of this webshop

516
00:20:41,299 --> 00:20:43,679
well it was pretty secure right okay

517
00:20:43,679 --> 00:20:45,539
until we connected the scanner of course

518
00:20:45,539 --> 00:20:47,400
yeah all right let's see let's see if

519
00:20:47,400 --> 00:20:48,900
you can do a little bit more we can

520
00:20:48,900 --> 00:20:49,860
actually

521
00:20:49,860 --> 00:20:52,860
uh yeah we just kept the warning we

522
00:20:52,860 --> 00:20:54,780
skipped a warning maybe we can search

523
00:20:54,780 --> 00:20:56,940
some interesting preferences also with a

524
00:20:56,940 --> 00:20:58,500
barcode

525
00:20:58,500 --> 00:21:01,620
that would be cool an HTTP proxy that

526
00:21:01,620 --> 00:21:04,380
you can set that

527
00:21:04,380 --> 00:21:09,140
it's actually the time would be fun

528
00:21:09,600 --> 00:21:11,520
this is the most difficult workouts high

529
00:21:11,520 --> 00:21:13,200
density barcodes

530
00:21:13,200 --> 00:21:14,700
aha

531
00:21:14,700 --> 00:21:16,799
so with just a couple of barcodes and no

532
00:21:16,799 --> 00:21:18,900
further interaction with the machine we

533
00:21:18,900 --> 00:21:21,600
could actually override these these

534
00:21:21,600 --> 00:21:24,360
proxy settings which I think is uh yes

535
00:21:24,360 --> 00:21:25,980
pretty cool and let's put them back

536
00:21:25,980 --> 00:21:27,840
because I think I'm actually using an

537
00:21:27,840 --> 00:21:30,059
online PowerPoint slide so this will

538
00:21:30,059 --> 00:21:32,900
probably mess up everything I don't know

539
00:21:32,900 --> 00:21:35,960
all right

540
00:21:36,179 --> 00:21:37,440
so

541
00:21:37,440 --> 00:21:39,419
um I hope you enjoyed this if you like

542
00:21:39,419 --> 00:21:41,340
this there's a lot more people when we

543
00:21:41,340 --> 00:21:43,799
were still like babies that already dove

544
00:21:43,799 --> 00:21:45,480
into this uh there's a really cool talk

545
00:21:45,480 --> 00:21:47,520
by Felix linter

546
00:21:47,520 --> 00:21:51,419
um he did a a talk at Defcon 16 and uh

547
00:21:51,419 --> 00:21:54,120
uh chaos computer Congress where he

548
00:21:54,120 --> 00:21:56,820
actually Dove more into the barcodes

549
00:21:56,820 --> 00:21:59,159
themselves but also the system behind

550
00:21:59,159 --> 00:22:01,200
the implementation so

551
00:22:01,200 --> 00:22:03,600
um don't forget it's it's like it talks

552
00:22:03,600 --> 00:22:05,880
directly to a back-end system so if it

553
00:22:05,880 --> 00:22:07,740
puts it directly into a database code

554
00:22:07,740 --> 00:22:10,140
injection is possible he has a lot of

555
00:22:10,140 --> 00:22:13,919
nice examples another talk is was given

556
00:22:13,919 --> 00:22:16,200
by Michael West and Colin Campbell this

557
00:22:16,200 --> 00:22:18,419
was a Defcon 26 result a couple of years

558
00:22:18,419 --> 00:22:20,100
ago and we found it while researching

559
00:22:20,100 --> 00:22:21,240
this topic a bit more for this

560
00:22:21,240 --> 00:22:23,220
presentation they actually made a

561
00:22:23,220 --> 00:22:25,500
framework for generating malicious

562
00:22:25,500 --> 00:22:27,179
barcodes

563
00:22:27,179 --> 00:22:29,220
um as sort of like a rubber ducky they

564
00:22:29,220 --> 00:22:31,140
call it so it's a rubber duck is for

565
00:22:31,140 --> 00:22:33,360
barcodes unfortunately we couldn't get

566
00:22:33,360 --> 00:22:36,120
it to work but it needs a bit of

567
00:22:36,120 --> 00:22:39,000
uh love and carrots five years since the

568
00:22:39,000 --> 00:22:40,860
last commit but you could probably get

569
00:22:40,860 --> 00:22:43,380
it to work with a bit of fabric and we

570
00:22:43,380 --> 00:22:45,600
used a simple JavaScript barcode

571
00:22:45,600 --> 00:22:47,940
generator so we needed quick barcodes we

572
00:22:47,940 --> 00:22:49,440
actually used e-ink because some of the

573
00:22:49,440 --> 00:22:51,240
scanners are a bit finicky about what

574
00:22:51,240 --> 00:22:53,280
kind of server you scan them from so if

575
00:22:53,280 --> 00:22:55,260
you have troubles print them out or use

576
00:22:55,260 --> 00:22:57,179
something like e-ink and we use the

577
00:22:57,179 --> 00:22:59,340
simple JavaScript barcode generator for

578
00:22:59,340 --> 00:23:03,199
that so uh what

579
00:23:03,559 --> 00:23:06,200
no okay

580
00:23:06,200 --> 00:23:08,640
giving up so some things to take home

581
00:23:08,640 --> 00:23:10,919
from this presentation uh always

582
00:23:10,919 --> 00:23:13,740
sanitize your inputs even USB devices

583
00:23:13,740 --> 00:23:16,200
whatever they might be are input devices

584
00:23:16,200 --> 00:23:19,559
they can be manipulated so never think

585
00:23:19,559 --> 00:23:22,740
also that something is secure a lot of

586
00:23:22,740 --> 00:23:24,419
this stuff that you find in those

587
00:23:24,419 --> 00:23:26,940
Barcode Scanner is undocumented so

588
00:23:26,940 --> 00:23:29,280
always check that and even even the

589
00:23:29,280 --> 00:23:31,200
funny thing this barcode scanner I could

590
00:23:31,200 --> 00:23:33,120
not find a serial number on it I even

591
00:23:33,120 --> 00:23:36,000
unscrewed it looked at the PCB there's

592
00:23:36,000 --> 00:23:38,640
nothing on there it's like it almost

593
00:23:38,640 --> 00:23:40,559
demolished a thing yesterday before the

594
00:23:40,559 --> 00:23:42,720
presentation in order to find still the

595
00:23:42,720 --> 00:23:45,020
serial number but you couldn't find it

596
00:23:45,020 --> 00:23:47,640
default configurations are scary don't

597
00:23:47,640 --> 00:23:49,740
trust those because by default all these

598
00:23:49,740 --> 00:23:51,360
scanners we tested are quite vulnerable

599
00:23:51,360 --> 00:23:54,299
to the attacks it always depends on what

600
00:23:54,299 --> 00:23:55,919
kind of Hardware you got so the scanner

601
00:23:55,919 --> 00:23:58,559
and also what tool you have the demo we

602
00:23:58,559 --> 00:24:00,480
showed is interesting we also seen this

603
00:24:00,480 --> 00:24:02,279
kind of stuff in practice as well so

604
00:24:02,279 --> 00:24:04,860
it's not just a demo but also so

605
00:24:04,860 --> 00:24:09,020
um yeah well we've seen it unfortunately

606
00:24:09,020 --> 00:24:11,220
and users who have configuration

607
00:24:11,220 --> 00:24:13,919
barcodes are even scarier and be mindful

608
00:24:13,919 --> 00:24:16,500
that I think you should never want this

609
00:24:16,500 --> 00:24:18,360
this kind of future Scanner with this

610
00:24:18,360 --> 00:24:21,480
this tells me and a lot of barcodes uh

611
00:24:21,480 --> 00:24:23,400
format supports facial characters should

612
00:24:23,400 --> 00:24:26,279
always be wary of that one as well and

613
00:24:26,279 --> 00:24:29,539
of course everything is an input device

614
00:24:29,539 --> 00:24:32,220
this was our talk thank you very much

615
00:24:32,220 --> 00:24:34,300
we'll have barcode

616
00:24:34,300 --> 00:24:37,579
[Music]

617
00:24:38,100 --> 00:24:40,380
so

618
00:24:40,380 --> 00:24:40,940
um

619
00:24:40,940 --> 00:24:43,860
to add a little bit after our

620
00:24:43,860 --> 00:24:45,840
presentation there will be a break in

621
00:24:45,840 --> 00:24:48,900
the stands we will be I think somewhere

622
00:24:48,900 --> 00:24:50,400
over there we have some more barcode

623
00:24:50,400 --> 00:24:52,080
scanners with us so if you would like to

624
00:24:52,080 --> 00:24:53,760
try some of the stuff we showed or have

625
00:24:53,760 --> 00:24:55,380
ideas or anything I want to talk about

626
00:24:55,380 --> 00:24:58,980
it join us probably there are quite a

627
00:24:58,980 --> 00:25:00,779
lot of barcode scanners so if you're

628
00:25:00,779 --> 00:25:02,820
interested and like we said every

629
00:25:02,820 --> 00:25:04,620
implementation difference so we have we

630
00:25:04,620 --> 00:25:06,240
do not even know all the secrets of all

631
00:25:06,240 --> 00:25:08,220
the barcode scanners we own ourselves so

632
00:25:08,220 --> 00:25:09,840
so even if you want to test your own

633
00:25:09,840 --> 00:25:12,179
Barcode Scanner you can well bring it

634
00:25:12,179 --> 00:25:13,799
you can have a look at least at what

635
00:25:13,799 --> 00:25:16,679
their special first 20 characters self

636
00:25:16,679 --> 00:25:19,440
will be

637
00:25:19,440 --> 00:25:21,120
um any questions I think yeah I think

638
00:25:21,120 --> 00:25:22,980
the first time left we can have a

639
00:25:22,980 --> 00:25:25,080
question and answer are there any

640
00:25:25,080 --> 00:25:27,299
questions from the internet already no

641
00:25:27,299 --> 00:25:29,940
does the audience please go to the

642
00:25:29,940 --> 00:25:32,340
microphone in the middle so that you are

643
00:25:32,340 --> 00:25:34,020
hurt by all

644
00:25:34,020 --> 00:25:36,799
perfect

645
00:25:37,500 --> 00:25:39,720
that's right here

646
00:25:39,720 --> 00:25:40,620
um

647
00:25:40,620 --> 00:25:42,720
thank you for the great talk uh I think

648
00:25:42,720 --> 00:25:45,840
the most obvious question would be how

649
00:25:45,840 --> 00:25:47,400
possible is it to attack the local

650
00:25:47,400 --> 00:25:50,240
supermarket

651
00:25:50,880 --> 00:25:53,700
um that one is still on our bucket list

652
00:25:53,700 --> 00:25:58,080
to try uh we haven't actually yet

653
00:25:58,080 --> 00:26:02,279
it's um so so it really depends on the

654
00:26:02,279 --> 00:26:04,320
whoever implemented the systems because

655
00:26:04,320 --> 00:26:06,059
they basically asked somebody can you

656
00:26:06,059 --> 00:26:07,559
give us a machine that talks to this or

657
00:26:07,559 --> 00:26:09,600
talk to this and there's somebody there

658
00:26:09,600 --> 00:26:11,039
in engineering that's responsible for

659
00:26:11,039 --> 00:26:13,559
hooking it all up together and if they

660
00:26:13,559 --> 00:26:15,299
know their stuff and they're like I want

661
00:26:15,299 --> 00:26:16,860
to spend extra time on this and use a

662
00:26:16,860 --> 00:26:18,179
serial connection or something like that

663
00:26:18,179 --> 00:26:20,760
have a dedicated Channel it might be a

664
00:26:20,760 --> 00:26:22,919
lot more difficult but even then if it's

665
00:26:22,919 --> 00:26:24,720
hooked up through USB and somebody puts

666
00:26:24,720 --> 00:26:27,059
like the USB mode barcode scanner on it

667
00:26:27,059 --> 00:26:29,580
it will switch to a keyboard so in the

668
00:26:29,580 --> 00:26:30,779
end

669
00:26:30,779 --> 00:26:33,059
um I wouldn't say like hey a certain

670
00:26:33,059 --> 00:26:35,039
grocer is vulnerable it really depends

671
00:26:35,039 --> 00:26:36,419
on what kind of system they bought what

672
00:26:36,419 --> 00:26:38,340
kind of measures are in there and even

673
00:26:38,340 --> 00:26:40,320
one of the examples that we had where we

674
00:26:40,320 --> 00:26:42,840
were testing a system like that

675
00:26:42,840 --> 00:26:45,779
um we we told the vendor like hey we use

676
00:26:45,779 --> 00:26:48,120
this uh combination of hotkeys to

677
00:26:48,120 --> 00:26:49,919
actually move out of your uh your

678
00:26:49,919 --> 00:26:51,659
environment you're like then we block

679
00:26:51,659 --> 00:26:53,460
all that and then the engineer was now

680
00:26:53,460 --> 00:26:54,960
we block control of the lead but we

681
00:26:54,960 --> 00:26:59,640
didn't block alt move down minimize so

682
00:26:59,640 --> 00:27:01,500
there's always options

683
00:27:01,500 --> 00:27:05,279
yeah and and I think uh to to add to

684
00:27:05,279 --> 00:27:08,159
that I think no one uh here ran out of

685
00:27:08,159 --> 00:27:10,020
the room like oh I need to check my

686
00:27:10,020 --> 00:27:12,000
Barcode Scanner so I hope

687
00:27:12,000 --> 00:27:14,279
um well it won't be a problem though

688
00:27:14,279 --> 00:27:17,100
it's um but I think the only way to

689
00:27:17,100 --> 00:27:18,960
really check it is if you would just

690
00:27:18,960 --> 00:27:21,720
well print barcos and scan them but it's

691
00:27:21,720 --> 00:27:23,340
also a little bit if you would crash

692
00:27:23,340 --> 00:27:26,700
something it's a bit not nicer

693
00:27:26,700 --> 00:27:31,880
difficult okay next question please

694
00:27:32,580 --> 00:27:36,240
a bit out of scope but um have you

695
00:27:36,240 --> 00:27:39,059
verified mobile application as well that

696
00:27:39,059 --> 00:27:41,580
allow you to scan barcode on your mobile

697
00:27:41,580 --> 00:27:42,779
phone

698
00:27:42,779 --> 00:27:45,720
no we we haven't but I actually know of

699
00:27:45,720 --> 00:27:48,360
a really good attack and this is my

700
00:27:48,360 --> 00:27:50,700
stupid brain I know the attack still I

701
00:27:50,700 --> 00:27:52,559
don't know who to give credit to there's

702
00:27:52,559 --> 00:27:54,600
this guy that actually found out that in

703
00:27:54,600 --> 00:27:57,059
QR codes uh Unicode characters are all

704
00:27:57,059 --> 00:27:59,760
supported and he actually was able to do

705
00:27:59,760 --> 00:28:02,159
reverse reading Direction into a barcode

706
00:28:02,159 --> 00:28:05,520
so his barcode was read something like

707
00:28:05,520 --> 00:28:08,640
mock Dot

708
00:28:08,640 --> 00:28:10,740
question mark and then his website All

709
00:28:10,740 --> 00:28:12,840
In Reverse so if you scanned it it

710
00:28:12,840 --> 00:28:14,960
looked like google.com question mark

711
00:28:14,960 --> 00:28:19,260
reverse malicious website so he was able

712
00:28:19,260 --> 00:28:21,179
to create a QR code that would in

713
00:28:21,179 --> 00:28:24,299
display on the on the app show the

714
00:28:24,299 --> 00:28:25,740
reverse reading Direction but when you

715
00:28:25,740 --> 00:28:26,940
click follow link it would actually

716
00:28:26,940 --> 00:28:28,740
follow the reverse one which was his

717
00:28:28,740 --> 00:28:31,740
malicious website so and our security

718
00:28:31,740 --> 00:28:34,380
thing so this is just an introduction so

719
00:28:34,380 --> 00:28:35,940
I think if you would dive into it even

720
00:28:35,940 --> 00:28:39,059
more there's a whole world of like yeah

721
00:28:39,059 --> 00:28:41,120
Madness

722
00:28:41,120 --> 00:28:44,220
on implementation whatever the App Maker

723
00:28:44,220 --> 00:28:46,860
did I hope they fixed that unique outfit

724
00:28:46,860 --> 00:28:49,559
now I don't actually know

725
00:28:49,559 --> 00:28:51,600
okay and we have time for one more

726
00:28:51,600 --> 00:28:54,320
question so

727
00:28:54,960 --> 00:28:58,559
um how much did you research public QR

728
00:28:58,559 --> 00:29:00,299
code scanners because I feel like those

729
00:29:00,299 --> 00:29:03,240
are more vulnerable to these kind of

730
00:29:03,240 --> 00:29:04,380
attacks

731
00:29:04,380 --> 00:29:07,740
so the funny thing is about a lot of the

732
00:29:07,740 --> 00:29:10,860
QR code scanners they also support 1D

733
00:29:10,860 --> 00:29:13,860
barcodes so so we never actually needed

734
00:29:13,860 --> 00:29:15,419
to do something so QR cards has been

735
00:29:15,419 --> 00:29:16,980
more difficult because basically they're

736
00:29:16,980 --> 00:29:19,740
just raw texts well Unicode but raw text

737
00:29:19,740 --> 00:29:22,919
so they don't have control characters so

738
00:29:22,919 --> 00:29:25,620
no control alts super keys or whatever

739
00:29:25,620 --> 00:29:28,320
however all those scanners if they

740
00:29:28,320 --> 00:29:30,419
support 2D they probably have backwards

741
00:29:30,419 --> 00:29:32,640
compatibility with 1D they also support

742
00:29:32,640 --> 00:29:34,440
all the encoding sets and if it's

743
00:29:34,440 --> 00:29:36,240
disabled you can just re-enable it by

744
00:29:36,240 --> 00:29:39,720
scanning the proper barcodes so

745
00:29:39,720 --> 00:29:41,299
perfect

746
00:29:41,299 --> 00:29:44,100
so we we only kind of had to focus on

747
00:29:44,100 --> 00:29:47,159
the 1D barcodes yet and still well I

748
00:29:47,159 --> 00:29:49,740
have a QR code for you to scan if you're

749
00:29:49,740 --> 00:29:52,820
doing enough perfect scores

750
00:29:52,820 --> 00:29:55,220
in a few minutes

751
00:29:55,220 --> 00:29:56,940
thank you

752
00:29:56,940 --> 00:29:58,980
so thank you very much for this very

753
00:29:58,980 --> 00:30:01,500
entertaining talk if you have a warm

754
00:30:01,500 --> 00:30:04,640
Round of Applause again please

755
00:30:09,899 --> 00:30:12,439
thank you

756
00:30:14,039 --> 00:30:16,640
foreign

