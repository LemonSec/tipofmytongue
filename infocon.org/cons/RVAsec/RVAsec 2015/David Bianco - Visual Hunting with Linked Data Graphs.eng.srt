1
00:00:48,540 --> 00:00:50,600
you

2
00:00:52,070 --> 00:00:54,130
you

3
00:01:23,120 --> 00:01:25,180
you

4
00:01:32,159 --> 00:01:39,539
have about your state of<font color="#E5E5E5"> your networks</font>

5
00:01:36,240 --> 00:01:41,100
and IT systems and really the what we're

6
00:01:39,539 --> 00:01:43,380
talking about today the what I<font color="#E5E5E5"> call the</font>

7
00:01:41,100 --> 00:01:46,288
art and science of hunting for new

8
00:01:43,380 --> 00:01:47,579
threats in your environment I've<font color="#E5E5E5"> been</font>

9
00:01:46,289 --> 00:01:50,599
<font color="#E5E5E5">doing</font><font color="#CCCCCC"> this for a long time won't bore</font>

10
00:01:47,579 --> 00:01:54,419
you with reading that I got a lot of my

11
00:01:50,599 --> 00:01:57,270
experience with first with a as a

12
00:01:54,420 --> 00:01:58,920
founding member of assert that some of

13
00:01:57,270 --> 00:02:01,649
you might in here might know since we

14
00:01:58,920 --> 00:02:04,200
have a big facility here in Richmond and

15
00:02:01,649 --> 00:02:08,098
then I moved on<font color="#E5E5E5"> to work for mandiant at</font>

16
00:02:04,200 --> 00:02:09,899
fireeye now I work for squirrel so I'm

17
00:02:08,098 --> 00:02:13,950
going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> talk</font><font color="#CCCCCC"> to you about three things</font>

18
00:02:09,899 --> 00:02:16,790
today first thing is<font color="#E5E5E5"> the title of the</font>

19
00:02:13,950 --> 00:02:18,988
talk is visual hunting with linked data

20
00:02:16,790 --> 00:02:22,010
so I want<font color="#E5E5E5"> to talk</font><font color="#CCCCCC"> to you a little bit</font>

21
00:02:18,989 --> 00:02:24,000
about what linked data is what it means

22
00:02:22,010 --> 00:02:26,429
and then<font color="#E5E5E5"> I'm going to talk to you about</font>

23
00:02:24,000 --> 00:02:29,400
why you might want<font color="#E5E5E5"> to use</font><font color="#CCCCCC"> it for hunting</font>

24
00:02:26,430 --> 00:02:32,250
over or in addition<font color="#E5E5E5"> to what you might</font>

25
00:02:29,400 --> 00:02:33,959
already be doing and then i'll talk to

26
00:02:32,250 --> 00:02:35,609
you about using<font color="#CCCCCC"> that linked data to</font>

27
00:02:33,959 --> 00:02:37,590
create some<font color="#E5E5E5"> visualizations so you can</font>

28
00:02:35,609 --> 00:02:41,670
derive some insights about the status of

29
00:02:37,590 --> 00:02:43,709
your networks so first of all what is

30
00:02:41,670 --> 00:02:46,980
linked data well if you go to Wikipedia

31
00:02:43,709 --> 00:02:49,769
you'll see this it's a<font color="#CCCCCC"> method of</font>

32
00:02:46,980 --> 00:02:52,138
publishing structured data so that it

33
00:02:49,769 --> 00:02:56,970
can be interlinked and become more

34
00:02:52,139 --> 00:03:00,480
useful through semantic queries which is

35
00:02:56,970 --> 00:03:02,910
technically correct but it doesn't

36
00:03:00,480 --> 00:03:05,010
really address the question what is

37
00:03:02,910 --> 00:03:07,530
linked data so i have my own definition

38
00:03:05,010 --> 00:03:12,989
its data with links in it to other data

39
00:03:07,530 --> 00:03:14,579
and those links can be implicit links

40
00:03:12,989 --> 00:03:16,200
explicit links i'll talk to you about

41
00:03:14,579 --> 00:03:19,919
those in a minute but basically it's

42
00:03:16,200 --> 00:03:23,480
data with links we also to these links

43
00:03:19,919 --> 00:03:25,470
as relationships so if you think<font color="#E5E5E5"> of your</font>

44
00:03:23,480 --> 00:03:30,599
things<font color="#E5E5E5"> that you might who has a sim</font>

45
00:03:25,470 --> 00:03:31,950
raise your hand okay who has<font color="#CCCCCC"> splunk or</font>

46
00:03:30,599 --> 00:03:35,339
something<font color="#E5E5E5"> that's not a sin</font><font color="#CCCCCC"> but you do</font>

47
00:03:31,950 --> 00:03:37,230
something<font color="#E5E5E5"> with your logs okay if you</font>

48
00:03:35,340 --> 00:03:39,040
think<font color="#E5E5E5"> of all that kind of data and look</font>

49
00:03:37,230 --> 00:03:42,969
<font color="#CCCCCC">inside it</font>

50
00:03:39,040 --> 00:03:46,409
you have host names IP addresses user

51
00:03:42,969 --> 00:03:50,079
account<font color="#E5E5E5"> names windows domains maybe</font>

52
00:03:46,409 --> 00:03:52,179
email addresses details of possibly

53
00:03:50,079 --> 00:03:54,730
files that got transferred or were

54
00:03:52,180 --> 00:03:56,590
attached to an email you have the<font color="#CCCCCC"> email</font>

55
00:03:54,730 --> 00:03:58,409
message transactions and HTTP

56
00:03:56,590 --> 00:04:01,150
transactions all these things are

57
00:03:58,409 --> 00:04:04,569
entities some of them are physical

58
00:04:01,150 --> 00:04:07,030
things like<font color="#E5E5E5"> people or computers they</font>

59
00:04:04,569 --> 00:04:09,310
refer<font color="#CCCCCC"> to some of them</font><font color="#E5E5E5"> are less physical</font>

60
00:04:07,030 --> 00:04:11,620
like the transactions and HTTP

61
00:04:09,310 --> 00:04:13,359
transaction doesn't have that isn't<font color="#CCCCCC"> a</font>

62
00:04:11,620 --> 00:04:16,298
thing that<font color="#CCCCCC"> you can touch but</font><font color="#E5E5E5"> it's still</font>

63
00:04:13,359 --> 00:04:20,680
in your<font color="#E5E5E5"> data you can think of it</font><font color="#CCCCCC"> as</font>

64
00:04:16,298 --> 00:04:23,888
extracting these things out and then

65
00:04:20,680 --> 00:04:25,630
based on the log you can create the

66
00:04:23,889 --> 00:04:29,110
relationships between these and I'll

67
00:04:25,630 --> 00:04:31,150
show you<font color="#E5E5E5"> what this means so remember I</font>

68
00:04:29,110 --> 00:04:35,770
said we had these two types implicit and

69
00:04:31,150 --> 00:04:39,310
explicit an implicit link is something

70
00:04:35,770 --> 00:04:42,130
that is just inferred from<font color="#CCCCCC"> the log files</font>

71
00:04:39,310 --> 00:04:47,039
themselves so here you have at the top

72
00:04:42,130 --> 00:04:49,180
here<font color="#E5E5E5"> you have a snort alert about some</font>

73
00:04:47,039 --> 00:04:52,030
successful administrator<font color="#E5E5E5"> or privilege</font>

74
00:04:49,180 --> 00:04:55,630
gain and then you have on the<font color="#E5E5E5"> the second</font>

75
00:04:52,030 --> 00:05:00,039
one here it's an<font color="#E5E5E5"> SSH remote log on for</font>

76
00:04:55,630 --> 00:05:04,240
route now there<font color="#E5E5E5"> are implicit links in</font>

77
00:05:00,039 --> 00:05:07,150
here so you can<font color="#CCCCCC"> see for example you have</font>

78
00:05:04,240 --> 00:05:11,229
the the root account<font color="#CCCCCC"> was involved</font><font color="#E5E5E5"> in</font>

79
00:05:07,150 --> 00:05:15,789
both<font color="#E5E5E5"> of these the same to</font><font color="#CCCCCC"> endpoint IP</font>

80
00:05:11,229 --> 00:05:18,760
addresses and ports so right now you can

81
00:05:15,789 --> 00:05:21,210
tell that these two events are linked

82
00:05:18,760 --> 00:05:21,210
somehow

83
00:05:22,150 --> 00:05:27,640
if you were to take those<font color="#E5E5E5"> and put them</font>

84
00:05:24,970 --> 00:05:30,850
into what we use a<font color="#CCCCCC"> lot for this is we</font>

85
00:05:27,640 --> 00:05:32,800
use a graph database where the entities

86
00:05:30,850 --> 00:05:35,200
that<font color="#E5E5E5"> you find in your logs are nodes</font>

87
00:05:32,800 --> 00:05:37,660
like these big circles here and the

88
00:05:35,200 --> 00:05:44,640
relationships we draw the relationships

89
00:05:37,660 --> 00:05:50,050
as arrows and we name them so you'll see

90
00:05:44,640 --> 00:05:52,150
we have two nodes that are the

91
00:05:50,050 --> 00:05:55,810
corresponding endpoints of that

92
00:05:52,150 --> 00:05:57,250
communication that we saw we have this

93
00:05:55,810 --> 00:05:59,020
one here maybe is a little bit hard to

94
00:05:57,250 --> 00:06:02,110
see with the blue background but it says

95
00:05:59,020 --> 00:06:03,990
<font color="#E5E5E5">root so that's the the account and then</font>

96
00:06:02,110 --> 00:06:06,640
the relationships are this node

97
00:06:03,990 --> 00:06:08,740
connected to we call that a connected

98
00:06:06,640 --> 00:06:12,849
relationship and then<font color="#E5E5E5"> this connected to</font>

99
00:06:08,740 --> 00:06:17,200
this node this account logged<font color="#CCCCCC"> into</font><font color="#E5E5E5"> this</font>

100
00:06:12,850 --> 00:06:19,800
node so that's that's how we've taken

101
00:06:17,200 --> 00:06:23,380
<font color="#E5E5E5">that information and derived and</font>

102
00:06:19,800 --> 00:06:26,410
inferred some links and that's implicit

103
00:06:23,380 --> 00:06:29,230
linkage but some things like the focus

104
00:06:26,410 --> 00:06:33,190
of my talk today actually our explicit

105
00:06:29,230 --> 00:06:38,080
links are actually right there in the

106
00:06:33,190 --> 00:06:40,300
data as a field or<font color="#CCCCCC"> something so I'm</font>

107
00:06:38,080 --> 00:06:44,620
using in this talk I'm using a lot of

108
00:06:40,300 --> 00:06:48,430
<font color="#E5E5E5">data from the bro network platform who</font>

109
00:06:44,620 --> 00:06:50,290
here is use<font color="#E5E5E5"> bro before ok it's pretty</font>

110
00:06:48,430 --> 00:06:52,450
good<font color="#E5E5E5"> amount so</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> you guys have used</font>

111
00:06:50,290 --> 00:06:55,510
bro before probably already know this

112
00:06:52,450 --> 00:06:58,570
but every single log entry that<font color="#E5E5E5"> bro</font>

113
00:06:55,510 --> 00:07:02,260
creates has a unique<font color="#CCCCCC"> identifier for that</font>

114
00:06:58,570 --> 00:07:06,940
thing that<font color="#CCCCCC"> it's referring</font><font color="#E5E5E5"> to so for</font>

115
00:07:02,260 --> 00:07:09,580
<font color="#E5E5E5">example at the top here I have a file</font>

116
00:07:06,940 --> 00:07:13,900
transfer log like it noticed a file with

117
00:07:09,580 --> 00:07:17,260
like a md5 sum here being transferred

118
00:07:13,900 --> 00:07:19,060
here<font color="#E5E5E5"> I have an email log so it noticed</font>

119
00:07:17,260 --> 00:07:22,390
this email transaction and the bottom<font color="#E5E5E5"> I</font>

120
00:07:19,060 --> 00:07:24,510
have a connection log just a similar to

121
00:07:22,390 --> 00:07:27,370
net flow or network<font color="#E5E5E5"> session data and</font>

122
00:07:24,510 --> 00:07:29,230
each one of these you see this this has

123
00:07:27,370 --> 00:07:29,810
a unique<font color="#CCCCCC"> identifier for this connection</font>

124
00:07:29,230 --> 00:07:33,770
here

125
00:07:29,810 --> 00:07:35,690
and each one of these<font color="#E5E5E5"> also explicitly</font>

126
00:07:33,770 --> 00:07:37,669
names the connection<font color="#CCCCCC"> that it was</font>

127
00:07:35,690 --> 00:07:41,270
<font color="#E5E5E5">associated with so you have an explicit</font>

128
00:07:37,669 --> 00:07:43,909
link between this email transaction and

129
00:07:41,270 --> 00:07:47,080
what network connection it occurred over

130
00:07:43,910 --> 00:07:50,480
you have an explicit link between this

131
00:07:47,080 --> 00:07:52,909
file transfer this attachment to not

132
00:07:50,480 --> 00:07:55,850
only this email that it was attached to

133
00:07:52,910 --> 00:07:57,919
<font color="#E5E5E5">but also to the file that the connection</font>

134
00:07:55,850 --> 00:08:00,230
it was transferred<font color="#E5E5E5"> over but that's</font><font color="#CCCCCC"> not</font>

135
00:07:57,919 --> 00:08:03,710
<font color="#CCCCCC">all as bro actually does the same thing</font>

136
00:08:00,230 --> 00:08:05,900
for<font color="#E5E5E5"> the individual files so you can see</font>

137
00:08:03,710 --> 00:08:08,690
that<font color="#E5E5E5"> this file is assigned a unique file</font>

138
00:08:05,900 --> 00:08:12,320
ID which also occurs in this email

139
00:08:08,690 --> 00:08:14,030
transaction to show you<font color="#CCCCCC"> that this indeed</font>

140
00:08:12,320 --> 00:08:16,280
these two do go together and they

141
00:08:14,030 --> 00:08:18,950
weren't just part of multiple emails

142
00:08:16,280 --> 00:08:22,250
that went on the same connection so here

143
00:08:18,950 --> 00:08:24,409
<font color="#E5E5E5">we have explicitly stated exactly how</font>

144
00:08:22,250 --> 00:08:26,990
all<font color="#E5E5E5"> three of these entities relate to</font>

145
00:08:24,410 --> 00:08:29,930
each other just<font color="#E5E5E5"> because bro does that</font>

146
00:08:26,990 --> 00:08:33,289
which<font color="#CCCCCC"> is an awesome way an awesome way</font>

147
00:08:29,930 --> 00:08:35,330
to pivot through there now if<font color="#E5E5E5"> we start</font>

148
00:08:33,289 --> 00:08:37,010
graphing these just like we graph the

149
00:08:35,330 --> 00:08:39,589
simple graph earlier we start graphing

150
00:08:37,010 --> 00:08:42,700
these you might start<font color="#CCCCCC"> with the</font>

151
00:08:39,589 --> 00:08:49,100
<font color="#CCCCCC">transaction so</font><font color="#E5E5E5"> I have a connection and</font>

152
00:08:42,700 --> 00:08:52,010
then I have the file transfer and it's a

153
00:08:49,100 --> 00:08:54,620
contains relationship so actually the

154
00:08:52,010 --> 00:08:57,890
connection contains this<font color="#E5E5E5"> file transfer</font>

155
00:08:54,620 --> 00:08:59,270
somewhere right that's not<font color="#E5E5E5"> all we can</font>

156
00:08:57,890 --> 00:09:03,470
get out of it though we have these other

157
00:08:59,270 --> 00:09:07,100
entities so we have for example this

158
00:09:03,470 --> 00:09:08,780
host was the source host for the

159
00:09:07,100 --> 00:09:10,610
connection we have this host was the

160
00:09:08,780 --> 00:09:13,850
destination host for the connection and

161
00:09:10,610 --> 00:09:17,270
we have this file that was contained in

162
00:09:13,850 --> 00:09:18,830
this file transfer now there's other

163
00:09:17,270 --> 00:09:20,990
entities that you could have pulled out

164
00:09:18,830 --> 00:09:22,730
<font color="#CCCCCC">of there it</font><font color="#E5E5E5"> makes the the slide really</font>

165
00:09:20,990 --> 00:09:25,910
complicated when I start pulling<font color="#CCCCCC"> out the</font>

166
00:09:22,730 --> 00:09:28,970
email addresses<font color="#E5E5E5"> and everything that were</font>

167
00:09:25,910 --> 00:09:30,439
the subject lines and<font color="#E5E5E5"> everything that</font>

168
00:09:28,970 --> 00:09:31,940
goes with all those transactions but I

169
00:09:30,440 --> 00:09:34,550
think you're starting<font color="#CCCCCC"> to get the idea is</font>

170
00:09:31,940 --> 00:09:38,480
that now with with<font color="#CCCCCC"> the explicit linkage</font>

171
00:09:34,550 --> 00:09:38,990
we can actually<font color="#CCCCCC"> create this transaction</font>

172
00:09:38,480 --> 00:09:42,230
node

173
00:09:38,990 --> 00:09:43,610
not just that these things are connected

174
00:09:42,230 --> 00:09:46,880
but they're connected through certain

175
00:09:43,610 --> 00:09:49,640
transactions now that may<font color="#CCCCCC"> not be</font><font color="#E5E5E5"> always</font>

176
00:09:46,880 --> 00:09:51,200
the best way to look at this to have to

177
00:09:49,640 --> 00:09:54,500
always go through the transactions on

178
00:09:51,200 --> 00:09:56,120
the graph so<font color="#CCCCCC"> I would also like</font><font color="#E5E5E5"> to</font>

179
00:09:54,500 --> 00:09:58,520
introduce<font color="#E5E5E5"> you</font><font color="#CCCCCC"> to the concept of</font><font color="#E5E5E5"> what</font><font color="#CCCCCC"> we</font>

180
00:09:56,120 --> 00:10:00,440
call transitive closure it means for

181
00:09:58,520 --> 00:10:02,060
<font color="#E5E5E5">example</font><font color="#CCCCCC"> if this thing is connected as</font>

182
00:10:00,440 --> 00:10:03,680
the source to a connection<font color="#CCCCCC"> and this</font>

183
00:10:02,060 --> 00:10:05,959
thing<font color="#E5E5E5"> is connected as a destination to a</font>

184
00:10:03,680 --> 00:10:08,209
<font color="#E5E5E5">connection we can also make a direct</font>

185
00:10:05,959 --> 00:10:11,329
<font color="#CCCCCC">connection so that you can</font><font color="#E5E5E5"> just see hey</font>

186
00:10:08,209 --> 00:10:13,969
these two hosts connect you know they're

187
00:10:11,330 --> 00:10:16,730
in a relationship<font color="#E5E5E5"> directly similarly</font>

188
00:10:13,970 --> 00:10:19,550
this file transfer that with this file

189
00:10:16,730 --> 00:10:23,110
that we transferred it was sent by this

190
00:10:19,550 --> 00:10:25,790
this guy and it was received by this guy

191
00:10:23,110 --> 00:10:29,209
so we<font color="#E5E5E5"> just made some convenience links</font>

192
00:10:25,790 --> 00:10:31,880
that were not directly reflected in the

193
00:10:29,209 --> 00:10:34,479
actual fields but they were implied by

194
00:10:31,880 --> 00:10:34,480
those fields

195
00:10:37,560 --> 00:10:43,920
so why in the world are do we care<font color="#E5E5E5"> about</font>

196
00:10:41,250 --> 00:10:46,110
this<font color="#E5E5E5"> anybody in here</font><font color="#CCCCCC"> doing incident</font>

197
00:10:43,920 --> 00:10:48,079
hunting themselves already or someone in

198
00:10:46,110 --> 00:10:53,580
your organization is doing it a couple

199
00:10:48,080 --> 00:10:55,470
hands I should<font color="#E5E5E5"> also say this I feel like</font>

200
00:10:53,580 --> 00:10:57,680
incident hunting has like an eighty or

201
00:10:55,470 --> 00:11:00,450
ninety percent overlap with incident

202
00:10:57,680 --> 00:11:04,469
investigations so if something<font color="#E5E5E5"> is</font>

203
00:11:00,450 --> 00:11:06,120
already detected it so everything here

204
00:11:04,470 --> 00:11:07,950
that we're talking about for hunting you

205
00:11:06,120 --> 00:11:10,170
can also a lot<font color="#E5E5E5"> of it used for your</font>

206
00:11:07,950 --> 00:11:14,250
incident investigations why would<font color="#E5E5E5"> you</font>

207
00:11:10,170 --> 00:11:16,680
want to use linked data for hunting or

208
00:11:14,250 --> 00:11:20,940
for incident investigations well this<font color="#CCCCCC"> is</font>

209
00:11:16,680 --> 00:11:23,910
probably how you're doing it now this is

210
00:11:20,940 --> 00:11:27,120
what the folks that are experienced with

211
00:11:23,910 --> 00:11:30,600
bro probably do a lot they they may send

212
00:11:27,120 --> 00:11:32,700
it to<font color="#E5E5E5"> two log file somewhere on a on a</font>

213
00:11:30,600 --> 00:11:35,820
hard drive or whatever and this is

214
00:11:32,700 --> 00:11:38,190
basically<font color="#E5E5E5"> me on my Mac gripping around</font>

215
00:11:35,820 --> 00:11:43,320
for those links so you<font color="#E5E5E5"> see i'm</font>

216
00:11:38,190 --> 00:11:45,930
interested here in the in the md5 sum of

217
00:11:43,320 --> 00:11:49,190
a certain file and<font color="#CCCCCC"> i'm finding out where</font>

218
00:11:45,930 --> 00:11:52,920
it occurred in my<font color="#E5E5E5"> logs now i have the</font>

219
00:11:49,190 --> 00:11:54,270
<font color="#E5E5E5">the connection ID here that I saw that</font>

220
00:11:52,920 --> 00:11:55,890
file and now<font color="#E5E5E5"> I want to see everything</font>

221
00:11:54,270 --> 00:11:57,560
that happened over that connection and

222
00:11:55,890 --> 00:12:01,170
it's another grip command and I have

223
00:11:57,560 --> 00:12:05,819
looks<font color="#E5E5E5"> like a connection log and a file</font>

224
00:12:01,170 --> 00:12:08,310
transfer log and another email log if

225
00:12:05,820 --> 00:12:11,550
you send this to something like Elsa or

226
00:12:08,310 --> 00:12:13,500
if you if you<font color="#CCCCCC"> are paying for splunk or</font>

227
00:12:11,550 --> 00:12:15,870
something like that<font color="#E5E5E5"> you might have</font><font color="#CCCCCC"> a</font>

228
00:12:13,500 --> 00:12:19,370
fancier GUI interface but you're still

229
00:12:15,870 --> 00:12:26,250
basically doing these same operations I

230
00:12:19,370 --> 00:12:27,930
call this row oriented analysis nothing

231
00:12:26,250 --> 00:12:31,020
wrong<font color="#CCCCCC"> with</font><font color="#E5E5E5"> that and there's still plenty</font>

232
00:12:27,930 --> 00:12:36,150
<font color="#E5E5E5">of great use cases for looking at events</font>

233
00:12:31,020 --> 00:12:38,640
row by row but<font color="#E5E5E5"> sometimes it really helps</font>

234
00:12:36,150 --> 00:12:42,980
you out if you can get a little bit

235
00:12:38,640 --> 00:12:46,860
different view so here<font color="#CCCCCC"> we have</font>

236
00:12:42,980 --> 00:12:49,590
two perspectives on the<font color="#E5E5E5"> same data so on</font>

237
00:12:46,860 --> 00:12:51,750
this side again<font color="#E5E5E5"> who's me on my laptop</font>

238
00:12:49,590 --> 00:12:54,990
here doing a grep through a bunch of bro

239
00:12:51,750 --> 00:13:00,720
logs to try to<font color="#E5E5E5"> find information</font><font color="#CCCCCC"> about</font>

240
00:12:54,990 --> 00:13:04,250
some suspicious connections and it

241
00:13:00,720 --> 00:13:08,340
basically just<font color="#E5E5E5"> becomes a wall of text</font>

242
00:13:04,250 --> 00:13:10,320
it's<font color="#E5E5E5"> very difficult but possible but</font>

243
00:13:08,340 --> 00:13:11,820
very difficult to<font color="#E5E5E5"> kind of get the big</font>

244
00:13:10,320 --> 00:13:13,860
picture of<font color="#E5E5E5"> what's</font><font color="#CCCCCC"> happening just by</font>

245
00:13:11,820 --> 00:13:16,230
looking row by row but here we've

246
00:13:13,860 --> 00:13:18,300
actually created a graph that<font color="#CCCCCC"> has</font>

247
00:13:16,230 --> 00:13:22,130
basically the<font color="#E5E5E5"> same information in it</font>

248
00:13:18,300 --> 00:13:25,469
that tells more of a story we received a

249
00:13:22,130 --> 00:13:29,400
malicious email which was sent to<font color="#CCCCCC"> a</font>

250
00:13:25,470 --> 00:13:33,330
certain email<font color="#E5E5E5"> address that email address</font>

251
00:13:29,400 --> 00:13:35,610
<font color="#E5E5E5">belongs to a individual user who logs</font><font color="#CCCCCC"> in</font>

252
00:13:33,330 --> 00:13:38,820
<font color="#CCCCCC">to this computer who happened to be</font>

253
00:13:35,610 --> 00:13:41,940
compromised<font color="#CCCCCC"> by that malicious email and</font>

254
00:13:38,820 --> 00:13:44,670
they use HTTP to connect to a command

255
00:13:41,940 --> 00:13:47,760
and control and we also saw some non

256
00:13:44,670 --> 00:13:52,170
HTTP net flows out to add a<font color="#E5E5E5"> 2x</font>

257
00:13:47,760 --> 00:13:54,030
<font color="#E5E5E5">filtration point now admittedly not all</font>

258
00:13:52,170 --> 00:13:56,550
of<font color="#E5E5E5"> this is connection-oriented these</font>

259
00:13:54,030 --> 00:13:58,800
things pretty much are the connection

260
00:13:56,550 --> 00:14:00,479
piece these things are derived<font color="#E5E5E5"> from</font>

261
00:13:58,800 --> 00:14:03,120
other log sources all of it came<font color="#E5E5E5"> from</font>

262
00:14:00,480 --> 00:14:09,600
bro though bro logs logs all those

263
00:14:03,120 --> 00:14:12,690
things so if you look at<font color="#CCCCCC"> it</font><font color="#E5E5E5"> row oriented</font>

264
00:14:09,600 --> 00:14:15,330
you have to say well I need<font color="#E5E5E5"> to grep</font>

265
00:14:12,690 --> 00:14:17,820
through my email file and to find the

266
00:14:15,330 --> 00:14:20,340
email and<font color="#E5E5E5"> the address it went to you may</font>

267
00:14:17,820 --> 00:14:23,300
need to consult your LDAP directory to

268
00:14:20,340 --> 00:14:26,130
find out what user<font color="#E5E5E5"> that belongs to if</font>

269
00:14:23,300 --> 00:14:29,490
you're super lucky you can find which

270
00:14:26,130 --> 00:14:31,080
users use which hosts from monitoring

271
00:14:29,490 --> 00:14:33,150
your bro logs<font color="#E5E5E5"> because they will try to</font>

272
00:14:31,080 --> 00:14:35,520
record usernames whenever they see them

273
00:14:33,150 --> 00:14:37,170
and then you go to the connection<font color="#E5E5E5"> logs</font>

274
00:14:35,520 --> 00:14:38,430
to find out what the suspicious

275
00:14:37,170 --> 00:14:40,469
connections were or anything like that

276
00:14:38,430 --> 00:14:45,609
around here<font color="#E5E5E5"> but here I mean you can</font><font color="#CCCCCC"> just</font>

277
00:14:40,470 --> 00:14:49,310
basically see the the picture so

278
00:14:45,610 --> 00:14:54,730
not that<font color="#CCCCCC"> Oh</font><font color="#E5E5E5"> oriented</font><font color="#CCCCCC"> versus linked data</font>

279
00:14:49,310 --> 00:14:59,449
analysis is a competitive process I

280
00:14:54,730 --> 00:15:01,459
actually say use both but sometimes you

281
00:14:59,449 --> 00:15:03,199
will have situations where<font color="#CCCCCC"> linked data</font>

282
00:15:01,459 --> 00:15:05,029
is the better choice and sometimes

283
00:15:03,199 --> 00:15:07,339
<font color="#CCCCCC">you'll have situations where r 0</font>

284
00:15:05,029 --> 00:15:11,649
oriented data is a better choice now

285
00:15:07,339 --> 00:15:14,720
which<font color="#E5E5E5"> one is which row oriented analysis</font>

286
00:15:11,649 --> 00:15:17,870
operates of course on on individual

287
00:15:14,720 --> 00:15:22,100
events and there are a lot of existing

288
00:15:17,870 --> 00:15:25,120
tools some for free some for pay pretty

289
00:15:22,100 --> 00:15:29,800
much<font color="#CCCCCC"> Confed any budget and any need</font>

290
00:15:25,120 --> 00:15:32,990
<font color="#CCCCCC">Splunk</font><font color="#E5E5E5"> Elsa you saw me using grep a lot</font>

291
00:15:29,800 --> 00:15:36,349
I'm a big fan of Griffin rock and said

292
00:15:32,990 --> 00:15:40,550
and those<font color="#E5E5E5"> things for for log oriented</font>

293
00:15:36,350 --> 00:15:42,110
analysis but it gets hard<font color="#E5E5E5"> to see the big</font>

294
00:15:40,550 --> 00:15:46,910
picture when all you're doing is staring

295
00:15:42,110 --> 00:15:50,540
<font color="#E5E5E5">at individual lines because you can't</font>

296
00:15:46,910 --> 00:15:51,829
see the relationships you can't see it's

297
00:15:50,540 --> 00:15:53,809
hard because they're all in different

298
00:15:51,829 --> 00:15:56,989
log files and you have to bounce<font color="#E5E5E5"> around</font>

299
00:15:53,809 --> 00:15:59,719
through and pivot through it's<font color="#E5E5E5"> possible</font>

300
00:15:56,990 --> 00:16:01,370
<font color="#E5E5E5">to pivot through those but you</font><font color="#CCCCCC"> usually</font>

301
00:15:59,720 --> 00:16:04,639
have<font color="#E5E5E5"> to do it one step at a time and</font>

302
00:16:01,370 --> 00:16:07,430
it's easy<font color="#E5E5E5"> to lose track of where you are</font>

303
00:16:04,639 --> 00:16:10,069
if or where you have been in your

304
00:16:07,430 --> 00:16:13,099
investigation it's really<font color="#CCCCCC"> good though</font>

305
00:16:10,069 --> 00:16:14,750
for searching you<font color="#E5E5E5"> just have a string and</font>

306
00:16:13,100 --> 00:16:16,639
you want to<font color="#E5E5E5"> know if it like an indicator</font>

307
00:16:14,750 --> 00:16:18,319
a domain name or something<font color="#E5E5E5"> you</font><font color="#CCCCCC"> want to</font>

308
00:16:16,639 --> 00:16:20,029
<font color="#E5E5E5">know if it occurs in your logs certainly</font>

309
00:16:18,319 --> 00:16:21,860
row are native analysis is probably your

310
00:16:20,029 --> 00:16:25,370
<font color="#E5E5E5">best choice anytime you want to do</font>

311
00:16:21,860 --> 00:16:28,069
counting some basic statistics all all

312
00:16:25,370 --> 00:16:30,439
that especially of course if you want

313
00:16:28,069 --> 00:16:32,449
the detailed proof because the log

314
00:16:30,439 --> 00:16:35,509
oriented or the row oriented events

315
00:16:32,449 --> 00:16:37,579
actually give you the most detail about

316
00:16:35,509 --> 00:16:39,740
every<font color="#E5E5E5"> single event so when you've</font>

317
00:16:37,579 --> 00:16:41,779
completed your investigation no matter

318
00:16:39,740 --> 00:16:44,569
whether you use dro oriented or linked

319
00:16:41,779 --> 00:16:46,639
data analysis you almost certainly need

320
00:16:44,569 --> 00:16:50,439
to go<font color="#E5E5E5"> back to the individual logs to</font>

321
00:16:46,639 --> 00:16:50,439
extract them<font color="#CCCCCC"> and prove what happened</font>

322
00:16:52,370 --> 00:16:58,130
so just as a<font color="#CCCCCC"> little</font><font color="#E5E5E5"> bit of a more of an</font>

323
00:16:56,010 --> 00:17:03,150
example here this is what<font color="#E5E5E5"> you get if you</font>

324
00:16:58,130 --> 00:17:08,520
see a typical sim or IDs alert as it

325
00:17:03,150 --> 00:17:11,339
occurs in your traditional graph so you

326
00:17:08,520 --> 00:17:13,109
just get an IP<font color="#CCCCCC"> address you get the</font><font color="#E5E5E5"> IDS</font>

327
00:17:11,339 --> 00:17:15,270
alert and you get the destination<font color="#E5E5E5"> IP</font>

328
00:17:13,109 --> 00:17:18,208
address to IP addresses a source<font color="#E5E5E5"> in a</font>

329
00:17:15,270 --> 00:17:19,379
desk and the alert probably would have

330
00:17:18,209 --> 00:17:21,780
more detail<font color="#CCCCCC"> about what the alert</font>

331
00:17:19,380 --> 00:17:26,490
actually was trying to tell you but not

332
00:17:21,780 --> 00:17:28,590
so much here but when you actually send

333
00:17:26,490 --> 00:17:30,360
it into a full graph with all of your

334
00:17:28,590 --> 00:17:33,480
other data<font color="#CCCCCC"> that you're collecting you</font>

335
00:17:30,360 --> 00:17:37,350
start to see a lot more context<font color="#E5E5E5"> about</font>

336
00:17:33,480 --> 00:17:40,230
that alert so here's your alert again

337
00:17:37,350 --> 00:17:42,000
and the same<font color="#CCCCCC"> to the source IP address</font>

338
00:17:40,230 --> 00:17:44,220
and the destination IP address but now

339
00:17:42,000 --> 00:17:46,230
if you've collected this data over a

340
00:17:44,220 --> 00:17:48,360
certain<font color="#E5E5E5"> amount of time you may find hey</font>

341
00:17:46,230 --> 00:17:50,760
I found this source IP address is

342
00:17:48,360 --> 00:17:53,010
associated with a login session around

343
00:17:50,760 --> 00:17:57,800
<font color="#E5E5E5">that same time window from this user so</font>

344
00:17:53,010 --> 00:17:57,800
now you can make path

345
00:17:59,430 --> 00:18:08,720
I call this<font color="#E5E5E5"> auto pivot plus plus it's</font>

346
00:18:04,560 --> 00:18:08,720
similar to the same way you could use a

347
00:18:09,560 --> 00:18:15,030
row oriented techniques to say well find

348
00:18:13,200 --> 00:18:18,480
me the IP address who logged on around

349
00:18:15,030 --> 00:18:20,460
<font color="#E5E5E5">that time who was it but now we can</font><font color="#CCCCCC"> just</font>

350
00:18:18,480 --> 00:18:22,230
basically use a graph algorithm and

351
00:18:20,460 --> 00:18:24,600
there's decades of computer science

352
00:18:22,230 --> 00:18:27,120
research about graph algorithms to say

353
00:18:24,600 --> 00:18:29,790
find me a short of the shortest<font color="#E5E5E5"> path in</font>

354
00:18:27,120 --> 00:18:32,459
the same time window from this<font color="#E5E5E5"> IDs alert</font>

355
00:18:29,790 --> 00:18:34,050
to any user account ask the graph to do

356
00:18:32,460 --> 00:18:36,120
all the hard work<font color="#CCCCCC"> for you there it is</font>

357
00:18:34,050 --> 00:18:38,210
that's your user that<font color="#E5E5E5"> is probably the</font>

358
00:18:36,120 --> 00:18:41,639
one that has<font color="#CCCCCC"> to do with that IDs alert</font>

359
00:18:38,210 --> 00:18:45,740
any IDs analysts in this room ever have

360
00:18:41,640 --> 00:18:48,870
any problems tracking down the users

361
00:18:45,740 --> 00:18:50,750
none<font color="#CCCCCC"> of</font><font color="#E5E5E5"> them some guy was yes I'm two</font>

362
00:18:48,870 --> 00:18:53,070
guys back there<font color="#E5E5E5"> raise their hand I</font><font color="#CCCCCC"> think</font>

363
00:18:50,750 --> 00:18:54,300
you could<font color="#E5E5E5"> also do other things too</font><font color="#CCCCCC"> and</font>

364
00:18:53,070 --> 00:18:56,280
you can see<font color="#E5E5E5"> the same type of thing you</font>

365
00:18:54,300 --> 00:18:59,639
can you maybe find the<font color="#E5E5E5"> host name or</font>

366
00:18:56,280 --> 00:19:02,580
<font color="#E5E5E5">something on the on</font><font color="#CCCCCC"> the destination side</font>

367
00:18:59,640 --> 00:19:04,530
well here's the IP address<font color="#E5E5E5"> and the host</font>

368
00:19:02,580 --> 00:19:07,290
name here but also you may find other

369
00:19:04,530 --> 00:19:09,210
HTTP transactions or other network

370
00:19:07,290 --> 00:19:13,680
transactions that are also associated

371
00:19:09,210 --> 00:19:17,280
with this malicious destination the<font color="#E5E5E5"> URIs</font>

372
00:19:13,680 --> 00:19:20,160
the files the user agents or anything

373
00:19:17,280 --> 00:19:21,440
<font color="#CCCCCC">that you saw</font><font color="#E5E5E5"> on there so right then you</font>

374
00:19:20,160 --> 00:19:24,150
there's actually a fairly

375
00:19:21,440 --> 00:19:27,750
straightforward algorithm for taking

376
00:19:24,150 --> 00:19:29,970
your<font color="#E5E5E5"> IDs alert or your sim alert putting</font>

377
00:19:27,750 --> 00:19:33,260
it into the graph and then extracting

378
00:19:29,970 --> 00:19:37,320
the first<font color="#E5E5E5"> couple of hops of data and</font>

379
00:19:33,260 --> 00:19:39,180
creating<font color="#E5E5E5"> a package of context and that</font>

380
00:19:37,320 --> 00:19:41,760
you<font color="#CCCCCC"> can just</font><font color="#E5E5E5"> give to your IDs analyst</font>

381
00:19:39,180 --> 00:19:44,660
ideally all automated but maybe not

382
00:19:41,760 --> 00:19:44,660
always

383
00:19:47,270 --> 00:19:54,650
so let's talk<font color="#E5E5E5"> a little bit now about how</font>

384
00:19:51,740 --> 00:19:57,760
<font color="#CCCCCC">we can use this idea of</font><font color="#E5E5E5"> linked data and</font>

385
00:19:54,650 --> 00:20:05,240
linked data analysis to derive some

386
00:19:57,760 --> 00:20:09,500
insights for visualization I do a<font color="#E5E5E5"> lot of</font>

387
00:20:05,240 --> 00:20:11,780
thinking<font color="#CCCCCC"> about how to proactively find</font>

388
00:20:09,500 --> 00:20:14,930
threats in your environment that haven't

389
00:20:11,780 --> 00:20:19,490
been caught by your automated intrusion

390
00:20:14,930 --> 00:20:22,610
detection or sim systems and one of the

391
00:20:19,490 --> 00:20:24,440
things<font color="#CCCCCC"> that I always</font><font color="#E5E5E5"> say is that before</font>

392
00:20:22,610 --> 00:20:27,830
you can<font color="#E5E5E5"> really start going</font><font color="#CCCCCC"> into the</font>

393
00:20:24,440 --> 00:20:29,630
details<font color="#E5E5E5"> of individual events that happen</font>

394
00:20:27,830 --> 00:20:33,379
you really need<font color="#CCCCCC"> to make sure</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> you're</font>

395
00:20:29,630 --> 00:20:37,940
<font color="#E5E5E5">familiar with the</font><font color="#CCCCCC"> environment and also</font>

396
00:20:33,380 --> 00:20:41,480
the data sets that you<font color="#E5E5E5"> have it's no</font>

397
00:20:37,940 --> 00:20:43,550
sense hunting trying to hunt down a very

398
00:20:41,480 --> 00:20:46,340
specific type of scenario if you don't

399
00:20:43,550 --> 00:20:48,530
really<font color="#E5E5E5"> know what kind of data you have</font>

400
00:20:46,340 --> 00:20:50,810
what<font color="#CCCCCC"> kind of systems that you have what</font>

401
00:20:48,530 --> 00:20:53,629
the in our case what the kinds of nodes

402
00:20:50,810 --> 00:20:55,629
and relationships and them are so I

403
00:20:53,630 --> 00:20:58,130
<font color="#E5E5E5">always say to start at the high level</font>

404
00:20:55,630 --> 00:20:59,780
maybe you don't have to do this<font color="#CCCCCC"> every</font>

405
00:20:58,130 --> 00:21:01,340
day that you sit down<font color="#E5E5E5"> because after a</font>

406
00:20:59,780 --> 00:21:03,680
<font color="#CCCCCC">while you start to know the data sets</font>

407
00:21:01,340 --> 00:21:05,929
and the organizational environment but

408
00:21:03,680 --> 00:21:12,980
<font color="#CCCCCC">when you're first getting started start</font>

409
00:21:05,930 --> 00:21:16,460
at the high level so I'm about<font color="#E5E5E5"> to talk</font>

410
00:21:12,980 --> 00:21:18,650
to you about a<font color="#CCCCCC"> a bunch</font><font color="#E5E5E5"> of stuff</font><font color="#CCCCCC"> that</font>

411
00:21:16,460 --> 00:21:21,650
I've put together to kind of help me<font color="#E5E5E5"> of</font>

412
00:21:18,650 --> 00:21:22,910
course<font color="#E5E5E5"> squirrel does this</font><font color="#CCCCCC"> thing does</font>

413
00:21:21,650 --> 00:21:24,710
this kind of analysis we have a

414
00:21:22,910 --> 00:21:25,760
commercial<font color="#E5E5E5"> product but that commercial</font>

415
00:21:24,710 --> 00:21:29,180
product does not appear<font color="#CCCCCC"> in this</font>

416
00:21:25,760 --> 00:21:31,400
presentation I was telling a friend of

417
00:21:29,180 --> 00:21:35,780
mine earlier I i created this kind<font color="#E5E5E5"> of</font>

418
00:21:31,400 --> 00:21:38,930
open source stack because it gives me

419
00:21:35,780 --> 00:21:40,340
the visibility into all of the layers

420
00:21:38,930 --> 00:21:42,680
and get my hands in it and do

421
00:21:40,340 --> 00:21:46,250
prototyping but I realized it's also a

422
00:21:42,680 --> 00:21:48,740
really<font color="#E5E5E5"> great</font><font color="#CCCCCC"> idea for people who are</font>

423
00:21:46,250 --> 00:21:51,640
<font color="#CCCCCC">interested in just trying out linked</font>

424
00:21:48,740 --> 00:21:53,750
<font color="#E5E5E5">data analysis to kind of show this stack</font>

425
00:21:51,640 --> 00:21:55,850
so that<font color="#E5E5E5"> this is something that you can</font>

426
00:21:53,750 --> 00:21:57,950
go<font color="#E5E5E5"> back to your</font><font color="#CCCCCC"> office next week or</font>

427
00:21:55,850 --> 00:22:00,860
something and download the software

428
00:21:57,950 --> 00:22:02,570
install it and start sending it bro logs

429
00:22:00,860 --> 00:22:07,939
user logs a lot because i really like

430
00:22:02,570 --> 00:22:09,379
bro and just kind of try out some of

431
00:22:07,940 --> 00:22:12,230
<font color="#E5E5E5">these linked data analysis techniques</font>

432
00:22:09,380 --> 00:22:15,080
these graph techniques visualization or

433
00:22:12,230 --> 00:22:16,610
if you're really super into computer

434
00:22:15,080 --> 00:22:19,870
science you<font color="#E5E5E5"> can try some</font><font color="#CCCCCC"> of the graph</font>

435
00:22:16,610 --> 00:22:23,000
algorithms against your graph database

436
00:22:19,870 --> 00:22:26,090
this is meant to<font color="#CCCCCC"> be super simple it's</font>

437
00:22:23,000 --> 00:22:28,160
<font color="#E5E5E5">not really going to scale to</font><font color="#CCCCCC"> a big data</font>

438
00:22:26,090 --> 00:22:30,020
set it's something<font color="#E5E5E5"> that was designed for</font>

439
00:22:28,160 --> 00:22:33,080
me<font color="#CCCCCC"> to use with you know medium or</font>

440
00:22:30,020 --> 00:22:35,450
smallish data sets on<font color="#CCCCCC"> my laptop to try</font>

441
00:22:33,080 --> 00:22:38,870
out some<font color="#CCCCCC"> of my ideas you will need the</font>

442
00:22:35,450 --> 00:22:41,720
following things first of all and<font color="#E5E5E5"> I'm</font>

443
00:22:38,870 --> 00:22:45,979
also almost ashamed to admit<font color="#E5E5E5"> it my test</font>

444
00:22:41,720 --> 00:22:50,240
data is from the DARPA 99 set so it's

445
00:22:45,980 --> 00:22:52,250
like 16<font color="#CCCCCC"> years old pcap by now there is a</font>

446
00:22:50,240 --> 00:22:54,020
side note but there's a really<font color="#E5E5E5"> big</font>

447
00:22:52,250 --> 00:22:57,260
problem in<font color="#E5E5E5"> the security analytics</font>

448
00:22:54,020 --> 00:23:03,500
industry in getting good realistic test

449
00:22:57,260 --> 00:23:05,690
data sets to try things<font color="#CCCCCC"> out on so</font><font color="#E5E5E5"> I'm</font>

450
00:23:03,500 --> 00:23:08,059
using<font color="#E5E5E5"> this data set for this</font>

451
00:23:05,690 --> 00:23:10,429
presentation because everyone in here

452
00:23:08,059 --> 00:23:13,450
can access it at this URL and download

453
00:23:10,429 --> 00:23:15,590
it there are certain<font color="#CCCCCC"> things in it that</font>

454
00:23:13,450 --> 00:23:18,950
people have complained about over the

455
00:23:15,590 --> 00:23:22,340
years about how it<font color="#E5E5E5"> is not necessarily a</font>

456
00:23:18,950 --> 00:23:24,770
awesome data set but what<font color="#E5E5E5"> I like about</font>

457
00:23:22,340 --> 00:23:28,668
it is it's a real it tries hard<font color="#E5E5E5"> to be a</font>

458
00:23:24,770 --> 00:23:30,830
realistic data set of a small small

459
00:23:28,669 --> 00:23:34,280
number of hosts doing real things with

460
00:23:30,830 --> 00:23:37,820
the internet so<font color="#E5E5E5"> you will need that that</font>

461
00:23:34,280 --> 00:23:39,799
creates that comes as a pcap a packet

462
00:23:37,820 --> 00:23:44,090
capture file so<font color="#E5E5E5"> you will also need of</font>

463
00:23:39,799 --> 00:23:46,970
course the bro platform so that you can

464
00:23:44,090 --> 00:23:50,629
transfer translate that packet capture

465
00:23:46,970 --> 00:23:52,309
data into logs that you will then ingest

466
00:23:50,630 --> 00:23:54,620
by these scripts here that<font color="#E5E5E5"> I wrote in</font>

467
00:23:52,309 --> 00:23:56,690
the middle this is my only contribution

468
00:23:54,620 --> 00:23:58,790
to the<font color="#CCCCCC"> open-source pieces these broad to</font>

469
00:23:56,690 --> 00:24:00,549
graph scripts which you will<font color="#CCCCCC"> be able to</font>

470
00:23:58,790 --> 00:24:02,330
<font color="#E5E5E5">get from github they're actually not</font>

471
00:24:00,549 --> 00:24:03,740
available quite yet because I didn't

472
00:24:02,330 --> 00:24:05,899
finish the documentation but they will

473
00:24:03,740 --> 00:24:08,030
<font color="#CCCCCC">be finished and available sometime</font>

474
00:24:05,900 --> 00:24:10,130
within the next week if you follow me<font color="#CCCCCC"> on</font>

475
00:24:08,030 --> 00:24:12,420
<font color="#CCCCCC">Twitter</font><font color="#E5E5E5"> I will tweet when those</font><font color="#CCCCCC"> are</font>

476
00:24:10,130 --> 00:24:14,860
available so you'll<font color="#E5E5E5"> know</font>

477
00:24:12,420 --> 00:24:17,170
and once you have created the graphs

478
00:24:14,860 --> 00:24:19,240
excuse me once you've created the logs

479
00:24:17,170 --> 00:24:20,650
and you've got the scripts you're going

480
00:24:19,240 --> 00:24:22,690
to<font color="#E5E5E5"> have the scripts have to take that</font>

481
00:24:20,650 --> 00:24:25,300
<font color="#E5E5E5">data and put it into a graph database</font>

482
00:24:22,690 --> 00:24:27,730
somewhere so i'm using<font color="#E5E5E5"> this other open</font>

483
00:24:25,300 --> 00:24:30,129
<font color="#E5E5E5">source tool called</font><font color="#CCCCCC"> rec stir there's a</font>

484
00:24:27,730 --> 00:24:35,190
interesting<font color="#E5E5E5"> graph database project</font>

485
00:24:30,130 --> 00:24:37,540
called tinker pop where they try to be a

486
00:24:35,190 --> 00:24:39,310
abstraction layer between a<font color="#CCCCCC"> bunch</font><font color="#E5E5E5"> of</font>

487
00:24:37,540 --> 00:24:41,620
<font color="#E5E5E5">different types of commercial graph</font>

488
00:24:39,310 --> 00:24:43,929
databases with a consistent API and

489
00:24:41,620 --> 00:24:45,909
everything you don't actually<font color="#E5E5E5"> need to</font>

490
00:24:43,930 --> 00:24:47,590
<font color="#E5E5E5">provide your own graph database though</font>

491
00:24:45,910 --> 00:24:50,800
because they actually<font color="#E5E5E5"> provide a simple</font>

492
00:24:47,590 --> 00:24:53,830
one embedded<font color="#CCCCCC"> into their solutions so the</font>

493
00:24:50,800 --> 00:24:56,470
rector graph database<font color="#CCCCCC"> I've wrote my code</font>

494
00:24:53,830 --> 00:25:01,540
in Python so I also needed an API the

495
00:24:56,470 --> 00:25:04,090
bulb flow or just bulbs for Python you

496
00:25:01,540 --> 00:25:05,590
can<font color="#E5E5E5"> get that from their domain or if you</font>

497
00:25:04,090 --> 00:25:08,649
already have Python installed you can

498
00:25:05,590 --> 00:25:11,379
just do pip install bulbs and finally

499
00:25:08,650 --> 00:25:13,540
<font color="#E5E5E5">for the visual layer all the graphs that</font>

500
00:25:11,380 --> 00:25:15,550
you're about to see we're generated by

501
00:25:13,540 --> 00:25:21,879
this awesome<font color="#CCCCCC"> open-source graph project</font>

502
00:25:15,550 --> 00:25:24,490
called gevey there's a note<font color="#CCCCCC"> here about a</font>

503
00:25:21,880 --> 00:25:26,860
couple of plugins for<font color="#E5E5E5"> jeffy that you</font>

504
00:25:24,490 --> 00:25:29,320
will<font color="#E5E5E5"> need</font><font color="#CCCCCC"> to download and install</font>

505
00:25:26,860 --> 00:25:35,110
through the tool it has its<font color="#E5E5E5"> own plug-in</font>

506
00:25:29,320 --> 00:25:39,550
<font color="#E5E5E5">manager so here's our first try I just</font>

507
00:25:35,110 --> 00:25:42,790
<font color="#CCCCCC">ran the darpa 9 a-9 data set loaded of</font>

508
00:25:39,550 --> 00:25:47,770
<font color="#E5E5E5">the things into the graph database and</font>

509
00:25:42,790 --> 00:25:50,320
visualized everything I will<font color="#E5E5E5"> admit maybe</font>

510
00:25:47,770 --> 00:25:53,740
not super useful but the nodes are

511
00:25:50,320 --> 00:25:57,310
<font color="#E5E5E5">color-coded by type so you can kind of</font>

512
00:25:53,740 --> 00:25:59,020
start to see things so it's hard<font color="#CCCCCC"> to see</font>

513
00:25:57,310 --> 00:26:00,429
on this<font color="#CCCCCC"> particular one but there are a</font>

514
00:25:59,020 --> 00:26:03,970
few<font color="#CCCCCC"> places where</font><font color="#E5E5E5"> there's little dots of</font>

515
00:26:00,430 --> 00:26:09,220
red which are individual hosts you'll

516
00:26:03,970 --> 00:26:11,410
also see like these big green of<font color="#CCCCCC"> DNS</font>

517
00:26:09,220 --> 00:26:15,580
transactions and these yellow file

518
00:26:11,410 --> 00:26:17,410
transfers and these blue HTTP

519
00:26:15,580 --> 00:26:19,179
transactions and things like that<font color="#E5E5E5"> you</font>

520
00:26:17,410 --> 00:26:22,210
can start<font color="#CCCCCC"> to see</font><font color="#E5E5E5"> a little bit of</font>

521
00:26:19,180 --> 00:26:24,550
information<font color="#CCCCCC"> like there's this big kind</font>

522
00:26:22,210 --> 00:26:25,270
of dandelion looking feature up here

523
00:26:24,550 --> 00:26:26,830
that you might<font color="#E5E5E5"> be</font>

524
00:26:25,270 --> 00:26:28,780
oh I<font color="#E5E5E5"> want to maybe check that out a</font>

525
00:26:26,830 --> 00:26:30,790
little bit there's some semi

526
00:26:28,780 --> 00:26:33,430
disconnected pieces that might be

527
00:26:30,790 --> 00:26:35,170
interested to look at and then you can

528
00:26:33,430 --> 00:26:36,760
see a little bit of structure you can

529
00:26:35,170 --> 00:26:39,880
start seeing some structure down here

530
00:26:36,760 --> 00:26:43,020
but it gets really messy so the problem

531
00:26:39,880 --> 00:26:45,520
is I just graphed everything that I knew

532
00:26:43,020 --> 00:26:48,550
which might be<font color="#E5E5E5"> okay if you're just</font>

533
00:26:45,520 --> 00:26:51,160
looking at general shapes if you do this

534
00:26:48,550 --> 00:26:53,440
<font color="#CCCCCC">for all your pcap you capture each day</font>

535
00:26:51,160 --> 00:26:57,610
and you do this over a course of a week

536
00:26:53,440 --> 00:27:00,640
or a month you<font color="#E5E5E5"> might start to see common</font>

537
00:26:57,610 --> 00:27:03,070
features that you know or find<font color="#E5E5E5"> because</font>

538
00:27:00,640 --> 00:27:05,260
you see them every day and then you

539
00:27:03,070 --> 00:27:07,210
start seeing giant mutations of the

540
00:27:05,260 --> 00:27:08,740
<font color="#E5E5E5">graph one day that might give you a</font>

541
00:27:07,210 --> 00:27:12,490
<font color="#CCCCCC">little bit</font><font color="#E5E5E5"> of information</font><font color="#CCCCCC"> about what's</font>

542
00:27:08,740 --> 00:27:16,240
going on but honestly I don't<font color="#E5E5E5"> really</font>

543
00:27:12,490 --> 00:27:20,710
drive a lot of information<font color="#CCCCCC"> from this but</font>

544
00:27:16,240 --> 00:27:22,810
it turns out that the some basic simple

545
00:27:20,710 --> 00:27:25,740
things give<font color="#E5E5E5"> you some</font><font color="#CCCCCC"> really interesting</font>

546
00:27:22,810 --> 00:27:28,270
results so one of the things I try is to

547
00:27:25,740 --> 00:27:31,150
just take all the types of nodes that I

548
00:27:28,270 --> 00:27:33,220
have and graph like two or three of them

549
00:27:31,150 --> 00:27:35,800
in relation to each other and see what

550
00:27:33,220 --> 00:27:39,060
that shows so for<font color="#E5E5E5"> example here's just</font>

551
00:27:35,800 --> 00:27:39,060
all my hosts

552
00:27:40,989 --> 00:27:46,729
you can<font color="#E5E5E5"> kind of</font><font color="#CCCCCC"> see some interesting</font>

553
00:27:43,489 --> 00:27:49,519
<font color="#CCCCCC">things like the thing that jumps out at</font>

554
00:27:46,729 --> 00:27:53,389
me is you have these two giant dots and

555
00:27:49,519 --> 00:27:56,779
this<font color="#E5E5E5"> really thick line so the the graph</font>

556
00:27:53,389 --> 00:27:59,570
algorithm kind of<font color="#CCCCCC"> weights things larger</font>

557
00:27:56,779 --> 00:28:03,889
dots mean that they have<font color="#E5E5E5"> more</font>

558
00:27:59,570 --> 00:28:07,700
connections thicker lines means that

559
00:28:03,889 --> 00:28:09,619
that same relationship occurred more so

560
00:28:07,700 --> 00:28:11,269
here<font color="#CCCCCC"> we have like a bunch</font><font color="#E5E5E5"> of small dots</font>

561
00:28:09,619 --> 00:28:15,289
that we probably only seen once or twice

562
00:28:11,269 --> 00:28:18,619
a bunch of thin lines but when we see

563
00:28:15,289 --> 00:28:20,899
this giant set here that means<font color="#E5E5E5"> that</font>

564
00:28:18,619 --> 00:28:22,699
whatever that is occurs a lot and<font color="#E5E5E5"> we'll</font>

565
00:28:20,899 --> 00:28:24,619
<font color="#E5E5E5">get into that and pretty much detail</font>

566
00:28:22,700 --> 00:28:27,259
here but you can<font color="#CCCCCC"> also kind of see things</font>

567
00:28:24,619 --> 00:28:29,449
like there's a bunch of these they look

568
00:28:27,259 --> 00:28:32,269
<font color="#E5E5E5">like flowers or maybe I don't</font><font color="#CCCCCC"> know</font>

569
00:28:29,450 --> 00:28:34,220
bouquets of flowers or something that

570
00:28:32,269 --> 00:28:35,840
come from individual host so here's like

571
00:28:34,220 --> 00:28:40,369
these are all the internet hosts<font color="#E5E5E5"> that</font>

572
00:28:35,840 --> 00:28:42,199
this guy really talks to a lot and you

573
00:28:40,369 --> 00:28:45,918
can kind<font color="#E5E5E5"> of see it kind of a giant mess</font>

574
00:28:42,200 --> 00:28:47,749
in the middle it's hard to<font color="#E5E5E5"> see really</font>

575
00:28:45,919 --> 00:28:49,759
what you're talking about here because

576
00:28:47,749 --> 00:28:52,279
all of the hosts are colored<font color="#CCCCCC"> stained</font>

577
00:28:49,759 --> 00:28:55,059
because they are all hosts so one thing

578
00:28:52,279 --> 00:28:59,840
I will<font color="#E5E5E5"> do I will do what</font><font color="#CCCCCC"> we call</font>

579
00:28:55,059 --> 00:29:02,539
partitioning the graph by color now it

580
00:28:59,840 --> 00:29:05,779
starts to bring out the hosts that are

581
00:29:02,539 --> 00:29:08,239
in green are what bro considers to my

582
00:29:05,779 --> 00:29:11,330
local hosts when you run bro you tell it

583
00:29:08,239 --> 00:29:13,580
which your local domains are excuse me

584
00:29:11,330 --> 00:29:15,228
your local IP ranges are and it records

585
00:29:13,580 --> 00:29:17,449
it when it sees it in the<font color="#CCCCCC"> connection</font>

586
00:29:15,229 --> 00:29:20,929
logs or sometimes in the I<font color="#E5E5E5"> think it's</font>

587
00:29:17,450 --> 00:29:24,019
the<font color="#E5E5E5"> file transfer log if it says this</font>

588
00:29:20,929 --> 00:29:26,119
source of this is a local host I record

589
00:29:24,019 --> 00:29:28,489
that in the graph as a they call it a

590
00:29:26,119 --> 00:29:31,519
feature but it's a property of the node

591
00:29:28,489 --> 00:29:34,190
and so I can<font color="#E5E5E5"> look and see and there's</font>

592
00:29:31,519 --> 00:29:35,749
three categories of things it's things

593
00:29:34,190 --> 00:29:37,759
that<font color="#CCCCCC"> I</font><font color="#E5E5E5"> definitely know where local</font>

594
00:29:35,749 --> 00:29:39,679
<font color="#E5E5E5">because bro told me things that I</font>

595
00:29:37,759 --> 00:29:42,889
<font color="#E5E5E5">definitely know we're not local because</font>

596
00:29:39,679 --> 00:29:46,340
again bro<font color="#E5E5E5"> told me and the third is bro</font>

597
00:29:42,889 --> 00:29:50,529
didn't say anything at all about<font color="#E5E5E5"> this so</font>

598
00:29:46,340 --> 00:29:55,879
I don't<font color="#CCCCCC"> know usually that's because the</font>

599
00:29:50,529 --> 00:29:58,999
hosts occurred in a log file that but it

600
00:29:55,879 --> 00:30:01,609
never saw a connection to it or it never

601
00:29:58,999 --> 00:30:03,019
saw file transferred to it I think<font color="#CCCCCC"> those</font>

602
00:30:01,609 --> 00:30:04,549
are the only two places I know of and

603
00:30:03,019 --> 00:30:08,659
bro where it actually tells you local or

604
00:30:04,549 --> 00:30:11,450
not<font color="#E5E5E5"> with definition so so you'll see the</font>

605
00:30:08,659 --> 00:30:14,330
red things<font color="#E5E5E5"> are internet hosts definitely</font>

606
00:30:11,450 --> 00:30:16,429
not local and the<font color="#CCCCCC"> gray things are</font><font color="#E5E5E5"> things</font>

607
00:30:14,330 --> 00:30:20,330
that I<font color="#CCCCCC"> don't really know but</font><font color="#E5E5E5"> in practice</font>

608
00:30:16,429 --> 00:30:21,950
most of those are<font color="#E5E5E5"> also not local and you</font>

609
00:30:20,330 --> 00:30:24,199
<font color="#E5E5E5">start to see interesting things here a</font>

610
00:30:21,950 --> 00:30:28,129
little bit more<font color="#CCCCCC"> about this pattern it's</font>

611
00:30:24,200 --> 00:30:31,309
an internal host and making a lot of

612
00:30:28,129 --> 00:30:33,049
connections to this internet hosts if

613
00:30:31,309 --> 00:30:38,779
it's me that's probably the one I'm

614
00:30:33,049 --> 00:30:41,168
interested in checking out first so here

615
00:30:38,779 --> 00:30:44,179
I'm seeing the same<font color="#CCCCCC"> kind of graph but</font>

616
00:30:41,169 --> 00:30:47,450
instead of just<font color="#CCCCCC"> doing the hosts I've</font>

617
00:30:44,179 --> 00:30:50,869
added in<font color="#CCCCCC"> the file transfers in yellow</font>

618
00:30:47,450 --> 00:30:53,690
and if you<font color="#E5E5E5"> look close you can see I got</font>

619
00:30:50,869 --> 00:30:54,830
the same green and red hosts up here but

620
00:30:53,690 --> 00:30:57,349
now they have<font color="#E5E5E5"> that that's where that</font>

621
00:30:54,830 --> 00:30:59,509
dandelion structure came in because it

622
00:30:57,349 --> 00:31:02,809
was all generated by both<font color="#CCCCCC"> of those two</font>

623
00:30:59,509 --> 00:31:04,940
hosts now there's a whole<font color="#E5E5E5"> bunch of other</font>

624
00:31:02,809 --> 00:31:07,428
stuff down<font color="#CCCCCC"> in here which is still</font><font color="#E5E5E5"> kind</font>

625
00:31:04,940 --> 00:31:08,929
of an undifferentiated miss for now but

626
00:31:07,429 --> 00:31:14,089
we'll see what<font color="#E5E5E5"> we can do about that and</font>

627
00:31:08,929 --> 00:31:16,519
just<font color="#CCCCCC"> a bit my first question</font><font color="#E5E5E5"> as a hunter</font>

628
00:31:14,089 --> 00:31:18,168
might be well what are those two files

629
00:31:16,519 --> 00:31:23,450
or what I'm excuse me what are those

630
00:31:18,169 --> 00:31:25,849
files that are around those two hosts so

631
00:31:23,450 --> 00:31:29,089
what<font color="#E5E5E5"> I just did was zoom into the graph</font>

632
00:31:25,849 --> 00:31:30,889
the graph once you get a little<font color="#E5E5E5"> bit into</font>

633
00:31:29,089 --> 00:31:33,019
it so that it can actually<font color="#E5E5E5"> tell you</font>

634
00:31:30,889 --> 00:31:35,149
something will tell you the types of

635
00:31:33,019 --> 00:31:37,839
hosts I know it's<font color="#E5E5E5"> really hard</font><font color="#CCCCCC"> to read on</font>

636
00:31:35,149 --> 00:31:40,428
here but I wanted to<font color="#E5E5E5"> show</font><font color="#CCCCCC"> you that</font>

637
00:31:37,839 --> 00:31:42,168
there's still I mean even<font color="#CCCCCC"> if this zoom</font>

638
00:31:40,429 --> 00:31:44,419
there's just<font color="#E5E5E5"> a ton of hosts and</font>

639
00:31:42,169 --> 00:31:47,690
everything each one of these is<font color="#CCCCCC"> a mime</font>

640
00:31:44,419 --> 00:31:51,470
type and you read that and you'll see

641
00:31:47,690 --> 00:31:56,059
its image / jpg image / gift text / HTML

642
00:31:51,470 --> 00:31:59,640
image / jpg image / jpg etc so actually

643
00:31:56,059 --> 00:32:02,100
all those things<font color="#E5E5E5"> are HTML pages</font>

644
00:31:59,640 --> 00:32:04,770
and images that you would typically

645
00:32:02,100 --> 00:32:06,929
expect to find embedded in HTML pages

646
00:32:04,770 --> 00:32:10,920
remember this is all 1999 so you're<font color="#E5E5E5"> not</font>

647
00:32:06,930 --> 00:32:12,750
going to see a<font color="#CCCCCC"> lot of flash or PHP's or</font>

648
00:32:10,920 --> 00:32:14,820
anything like that you're you're pretty

649
00:32:12,750 --> 00:32:17,700
<font color="#CCCCCC">much still talking about</font><font color="#E5E5E5"> mostly static</font>

650
00:32:14,820 --> 00:32:20,550
web content at that time so it's

651
00:32:17,700 --> 00:32:23,730
probably<font color="#E5E5E5"> all web traffic now that really</font>

652
00:32:20,550 --> 00:32:27,540
thick edge the connected to edge that we

653
00:32:23,730 --> 00:32:31,140
saw was showing<font color="#CCCCCC"> that the internal host</font>

654
00:32:27,540 --> 00:32:34,409
made a lot of requests to<font color="#CCCCCC"> the external</font>

655
00:32:31,140 --> 00:32:36,330
host and then it's all going out and

656
00:32:34,410 --> 00:32:38,790
then you can't see it on here<font color="#E5E5E5"> but the</font>

657
00:32:36,330 --> 00:32:41,669
arrows on these are all going opposite

658
00:32:38,790 --> 00:32:43,620
way so the that's showing not that the

659
00:32:41,670 --> 00:32:45,360
internal is sending a<font color="#E5E5E5"> lot</font><font color="#CCCCCC"> of data out</font>

660
00:32:43,620 --> 00:32:49,020
it's actually sending a<font color="#E5E5E5"> lot of requests</font>

661
00:32:45,360 --> 00:32:53,610
but fetching a lot of data which<font color="#E5E5E5"> is</font>

662
00:32:49,020 --> 00:32:58,920
pretty normal for HTTP requests so right

663
00:32:53,610 --> 00:33:00,659
<font color="#E5E5E5">there that's good it turns out at this</font>

664
00:32:58,920 --> 00:33:02,340
<font color="#E5E5E5">point I actually found it a little bit</font>

665
00:33:00,660 --> 00:33:05,070
easier<font color="#CCCCCC"> to go back to</font><font color="#E5E5E5"> the Connecticut a</font>

666
00:33:02,340 --> 00:33:07,949
row oriented thing and just find a

667
00:33:05,070 --> 00:33:10,409
couple<font color="#E5E5E5"> of these file transfers and see</font>

668
00:33:07,950 --> 00:33:12,780
what they were a couple of<font color="#E5E5E5"> these</font>

669
00:33:10,410 --> 00:33:15,240
connections and it actually all turns

670
00:33:12,780 --> 00:33:17,070
<font color="#E5E5E5">out to be going to</font><font color="#CCCCCC"> Canon you know they</font>

671
00:33:15,240 --> 00:33:20,370
make printers and copiers and things

672
00:33:17,070 --> 00:33:23,850
like that<font color="#E5E5E5"> so that was actually some</font>

673
00:33:20,370 --> 00:33:27,389
cannon device that was calling<font color="#E5E5E5"> home so</font>

674
00:33:23,850 --> 00:33:31,379
no<font color="#E5E5E5"> problem all those are HTTP things</font>

675
00:33:27,390 --> 00:33:32,880
that we<font color="#E5E5E5"> kind of expect so let's see what</font>

676
00:33:31,380 --> 00:33:36,000
<font color="#E5E5E5">happens when we take those things out</font>

677
00:33:32,880 --> 00:33:37,950
there just junking up my graph making it

678
00:33:36,000 --> 00:33:43,440
really complicated so let's filter out

679
00:33:37,950 --> 00:33:45,240
all of the HTTP and image files and now

680
00:33:43,440 --> 00:33:49,350
you can<font color="#E5E5E5"> see we</font><font color="#CCCCCC"> have a little</font><font color="#E5E5E5"> bit more</font>

681
00:33:45,240 --> 00:33:51,300
simple of graph right we don't<font color="#E5E5E5"> really</font>

682
00:33:49,350 --> 00:33:55,379
<font color="#E5E5E5">have time to</font><font color="#CCCCCC"> go into</font><font color="#E5E5E5"> every single one of</font>

683
00:33:51,300 --> 00:33:57,720
those but<font color="#CCCCCC"> I will just</font><font color="#E5E5E5"> say if it was me I</font>

684
00:33:55,380 --> 00:34:00,000
might be<font color="#CCCCCC"> interested in going into a</font>

685
00:33:57,720 --> 00:34:05,290
little bit more detail about some of

686
00:34:00,000 --> 00:34:08,860
these file types here in the in the

687
00:34:05,290 --> 00:34:11,080
and the yellow it turns out if<font color="#E5E5E5"> you do</font>

688
00:34:08,860 --> 00:34:13,330
that you'll find<font color="#CCCCCC"> like a bunch of C</font>

689
00:34:11,080 --> 00:34:17,650
source code that their ftp around

690
00:34:13,330 --> 00:34:21,130
there's a there's a couple executables

691
00:34:17,650 --> 00:34:22,720
that get uploaded to my internal web

692
00:34:21,130 --> 00:34:25,360
servers there's<font color="#E5E5E5"> interesting things in</font>

693
00:34:22,719 --> 00:34:27,730
this data set that you<font color="#E5E5E5"> can find but</font>

694
00:34:25,360 --> 00:34:30,460
pretty<font color="#CCCCCC"> much this is</font><font color="#E5E5E5"> how I approach it I</font>

695
00:34:27,730 --> 00:34:32,620
find one thing that I think is

696
00:34:30,460 --> 00:34:36,360
<font color="#E5E5E5">interesting dig down into it in a fight</font>

697
00:34:32,620 --> 00:34:39,040
if it doesn't if it doesn't show me any

698
00:34:36,360 --> 00:34:40,390
confirmed malicious activity then I

699
00:34:39,040 --> 00:34:42,190
start thinking well let's filter this

700
00:34:40,389 --> 00:34:43,900
out and go back through the process

701
00:34:42,190 --> 00:34:47,320
again what's the next thing I want<font color="#E5E5E5"> to</font>

702
00:34:43,900 --> 00:34:49,389
find dig into that and after<font color="#CCCCCC"> you do that</font>

703
00:34:47,320 --> 00:34:52,210
for a while most of them will be nothing

704
00:34:49,389 --> 00:34:54,429
<font color="#CCCCCC">but then you start to kind of</font><font color="#E5E5E5"> I think of</font>

705
00:34:52,210 --> 00:34:57,070
as distilling your kind of distilling

706
00:34:54,429 --> 00:34:59,890
the data set to bring the bad things up

707
00:34:57,070 --> 00:35:01,480
so<font color="#E5E5E5"> after a few iterations hopefully you</font>

708
00:34:59,890 --> 00:35:04,540
will find some things<font color="#E5E5E5"> that are</font>

709
00:35:01,480 --> 00:35:05,620
suspicious that's only you know one<font color="#CCCCCC"> time</font>

710
00:35:04,540 --> 00:35:07,300
that I<font color="#E5E5E5"> can say that hopefully you'll</font>

711
00:35:05,620 --> 00:35:09,609
find some bad things in<font color="#E5E5E5"> your network</font><font color="#CCCCCC"> no</font>

712
00:35:07,300 --> 00:35:12,670
people<font color="#E5E5E5"> get upset at me out like yes I</font>

713
00:35:09,610 --> 00:35:16,930
found some hacker my<font color="#E5E5E5"> bosses are like</font>

714
00:35:12,670 --> 00:35:18,420
what no come on that's<font color="#E5E5E5"> not good I'll</font>

715
00:35:16,930 --> 00:35:23,230
give you a bonus so we talked about

716
00:35:18,420 --> 00:35:24,640
plotting files and hosts together but

717
00:35:23,230 --> 00:35:26,440
those are<font color="#E5E5E5"> not the only kind of things</font>

718
00:35:24,640 --> 00:35:27,700
that you can plot together all of<font color="#E5E5E5"> the</font>

719
00:35:26,440 --> 00:35:29,320
different types<font color="#E5E5E5"> of things it's really</font>

720
00:35:27,700 --> 00:35:30,970
interesting to try to plot them together

721
00:35:29,320 --> 00:35:33,820
see if there's any correlations so

722
00:35:30,970 --> 00:35:36,370
here's one where I just<font color="#E5E5E5"> looked at the</font>

723
00:35:33,820 --> 00:35:40,270
individual HTTP transactions here in

724
00:35:36,370 --> 00:35:42,100
green<font color="#E5E5E5"> and then there's some brown nodes</font>

725
00:35:40,270 --> 00:35:44,740
right in the center of all<font color="#E5E5E5"> these they</font>

726
00:35:42,100 --> 00:35:47,770
don't show<font color="#CCCCCC"> up too well</font><font color="#E5E5E5"> on the projector</font>

727
00:35:44,740 --> 00:35:50,770
and there are specific user agent

728
00:35:47,770 --> 00:35:52,960
strings that we saw<font color="#E5E5E5"> so user agents for</font>

729
00:35:50,770 --> 00:35:54,880
HTTP or how the browsers or the web

730
00:35:52,960 --> 00:35:58,570
clients identify themselves and sure

731
00:35:54,880 --> 00:36:00,820
they can lie but it turns out a lot<font color="#CCCCCC"> of</font>

732
00:35:58,570 --> 00:36:05,020
times<font color="#CCCCCC"> just like most people are poor</font>

733
00:36:00,820 --> 00:36:07,870
liars so it was most malware and so just

734
00:36:05,020 --> 00:36:09,460
looking at the unique I user agent

735
00:36:07,870 --> 00:36:12,220
strings in your environment can often

736
00:36:09,460 --> 00:36:14,650
give you a kind of<font color="#E5E5E5"> a clue about which</font>

737
00:36:12,220 --> 00:36:16,660
<font color="#CCCCCC">ones might</font><font color="#E5E5E5"> be a little bit suspicious so</font>

738
00:36:14,650 --> 00:36:17,750
if you<font color="#CCCCCC"> think that most of your people</font>

739
00:36:16,660 --> 00:36:19,970
and your

740
00:36:17,750 --> 00:36:22,820
your company<font color="#E5E5E5"> probably have us the same</font>

741
00:36:19,970 --> 00:36:25,310
or similar desktop software load out you

742
00:36:22,820 --> 00:36:28,430
would<font color="#E5E5E5"> expect to see things like giant</font>

743
00:36:25,310 --> 00:36:31,759
blooms here here which would<font color="#CCCCCC"> probably</font>

744
00:36:28,430 --> 00:36:33,710
mean most of your HTTP train of traffic

745
00:36:31,760 --> 00:36:36,110
and therefore most of you users are

746
00:36:33,710 --> 00:36:39,170
using the same set of user agents so

747
00:36:36,110 --> 00:36:42,920
that's fine when you start<font color="#CCCCCC"> seeing a few</font>

748
00:36:39,170 --> 00:36:44,540
things<font color="#E5E5E5"> here that are less popular and</font>

749
00:36:42,920 --> 00:36:46,700
there's even<font color="#CCCCCC"> if you if you download the</font>

750
00:36:44,540 --> 00:36:50,150
slides and see this there's some really

751
00:36:46,700 --> 00:36:53,359
light ones around here those might be

752
00:36:50,150 --> 00:36:55,670
the ones that<font color="#CCCCCC"> you want to dig into</font><font color="#E5E5E5"> a</font>

753
00:36:53,360 --> 00:36:58,640
little bit and find out what those user

754
00:36:55,670 --> 00:37:02,420
agents are maybe you will expand the

755
00:36:58,640 --> 00:37:05,240
graph then to add hosts to see how<font color="#CCCCCC"> many</font>

756
00:37:02,420 --> 00:37:08,000
hosts are using those if it's<font color="#CCCCCC"> so if</font><font color="#E5E5E5"> it's</font>

757
00:37:05,240 --> 00:37:10,069
a lot maybe it's<font color="#CCCCCC"> okay if it's only if</font>

758
00:37:08,000 --> 00:37:17,180
one or two maybe you have something to

759
00:37:10,070 --> 00:37:20,930
<font color="#E5E5E5">worry about so I'm starting to get the</font>

760
00:37:17,180 --> 00:37:24,859
<font color="#CCCCCC">the time signs so let</font><font color="#E5E5E5"> me go ahead and</font>

761
00:37:20,930 --> 00:37:31,129
wrap up I'll leave my contact

762
00:37:24,860 --> 00:37:34,040
information up here I will say this is

763
00:37:31,130 --> 00:37:35,390
only the tip of the<font color="#E5E5E5"> iceberg I spent a</font>

764
00:37:34,040 --> 00:37:36,830
<font color="#CCCCCC">lot of time if</font><font color="#E5E5E5"> you notice at the</font>

765
00:37:35,390 --> 00:37:39,470
beginning of the presentation talking

766
00:37:36,830 --> 00:37:42,110
about how great<font color="#E5E5E5"> link data is in graphs</font>

767
00:37:39,470 --> 00:37:43,970
and<font color="#E5E5E5"> I alluded a few times to the fact</font>

768
00:37:42,110 --> 00:37:45,500
that there's you know decades<font color="#E5E5E5"> of</font>

769
00:37:43,970 --> 00:37:49,549
computer science research on how to

770
00:37:45,500 --> 00:37:51,530
derive interesting data from graphs but

771
00:37:49,550 --> 00:37:53,510
I didn't<font color="#CCCCCC"> really go into that there's a</font>

772
00:37:51,530 --> 00:37:55,730
couple reasons one is it just takes a

773
00:37:53,510 --> 00:37:58,880
long<font color="#E5E5E5"> time and you could spend a couple</font>

774
00:37:55,730 --> 00:38:00,830
of days probably just talking<font color="#CCCCCC"> about how</font>

775
00:37:58,880 --> 00:38:02,690
cool graphs are when you're<font color="#E5E5E5"> trying</font><font color="#CCCCCC"> to do</font>

776
00:38:00,830 --> 00:38:07,279
incident detection or incident hunting

777
00:38:02,690 --> 00:38:10,370
the other thing<font color="#CCCCCC"> is though there are not</font>

778
00:38:07,280 --> 00:38:15,200
a lot of open source tools yet that

779
00:38:10,370 --> 00:38:19,009
allow you to<font color="#CCCCCC"> apply graph technology to</font>

780
00:38:15,200 --> 00:38:21,740
security data I won't say<font color="#CCCCCC"> that there</font>

781
00:38:19,010 --> 00:38:23,200
aren't any but the ones that I'm aware

782
00:38:21,740 --> 00:38:26,569
of don't really have a lot of

783
00:38:23,200 --> 00:38:28,549
complicated graph analytic in them so I

784
00:38:26,570 --> 00:38:30,559
didn't want<font color="#E5E5E5"> to start</font>

785
00:38:28,549 --> 00:38:33,170
walking digging into that quite so much

786
00:38:30,559 --> 00:38:35,569
as I said before I<font color="#CCCCCC"> think the most</font>

787
00:38:33,170 --> 00:38:38,269
reasonable place to start when you're

788
00:38:35,569 --> 00:38:40,719
just<font color="#E5E5E5"> getting into link data analysis is</font>

789
00:38:38,269 --> 00:38:44,390
that<font color="#CCCCCC"> the top level visualizations</font>

790
00:38:40,719 --> 00:38:45,739
interacting if you go to download some

791
00:38:44,390 --> 00:38:47,538
<font color="#CCCCCC">of these tools that I mentioned in the</font>

792
00:38:45,739 --> 00:38:50,179
earlier slide and try this in your

793
00:38:47,539 --> 00:38:53,449
office either with the<font color="#CCCCCC"> darpa set or your</font>

794
00:38:50,179 --> 00:38:55,429
own set you'll find<font color="#E5E5E5"> that gevey actually</font>

795
00:38:53,449 --> 00:38:57,199
has a lot of those graph algorithms in

796
00:38:55,429 --> 00:38:58,459
it might be a little bit tricky to know

797
00:38:57,199 --> 00:39:01,009
what they're for and when you should use

798
00:38:58,459 --> 00:39:03,109
them but it does actually have a rich

799
00:39:01,009 --> 00:39:04,609
set so hopefully<font color="#CCCCCC"> if you catch my</font>

800
00:39:03,109 --> 00:39:08,900
presentation and maybe<font color="#E5E5E5"> another six</font>

801
00:39:04,609 --> 00:39:12,348
months or whatever I will have<font color="#CCCCCC"> a little</font>

802
00:39:08,900 --> 00:39:16,609
bit more detailed information as I put

803
00:39:12,349 --> 00:39:18,199
some more into my bro to graph sweet put

804
00:39:16,609 --> 00:39:19,429
some more<font color="#E5E5E5"> of those smarts in there it</font>

805
00:39:18,199 --> 00:39:22,609
can already do a few things like

806
00:39:19,429 --> 00:39:24,949
pathfinding not super well but it does

807
00:39:22,609 --> 00:39:26,328
them so you can do that auto pivot plus

808
00:39:24,949 --> 00:39:31,309
plus kind of thing<font color="#CCCCCC"> that I talked about</font>

809
00:39:26,329 --> 00:39:32,869
just<font color="#E5E5E5"> not visually yet so</font><font color="#CCCCCC"> i understand i</font>

810
00:39:31,309 --> 00:39:35,209
have about what<font color="#E5E5E5"> 10 minutes or something</font>

811
00:39:32,869 --> 00:39:38,319
like that so<font color="#CCCCCC"> i'm happy</font><font color="#E5E5E5"> to take some</font>

812
00:39:35,209 --> 00:39:38,319
questions if there are any

