1
00:00:21,830 --> 00:00:26,369
yes again thank thank you<font color="#E5E5E5"> guys so much</font>

2
00:00:24,180 --> 00:00:29,640
<font color="#E5E5E5">for joining</font><font color="#CCCCCC"> us and</font><font color="#E5E5E5"> last talk I mean</font>

3
00:00:26,369 --> 00:00:32,820
<font color="#CCCCCC">could be</font><font color="#E5E5E5"> the bar already</font><font color="#CCCCCC"> but you're here</font>

4
00:00:29,640 --> 00:00:34,980
<font color="#CCCCCC">and we so this is talk is</font><font color="#E5E5E5"> a red team</font>

5
00:00:32,820 --> 00:00:38,699
apocalypse<font color="#CCCCCC"> the idea</font><font color="#E5E5E5"> of this talk kind of</font>

6
00:00:34,980 --> 00:00:41,099
came<font color="#E5E5E5"> from another talk that I did a few</font>

7
00:00:38,699 --> 00:00:43,620
years<font color="#CCCCCC"> ago</font><font color="#E5E5E5"> to b-sides conference</font><font color="#CCCCCC"> the the</font>

8
00:00:41,100 --> 00:00:45,960
<font color="#E5E5E5">original concept was</font><font color="#CCCCCC"> pin test</font><font color="#E5E5E5"> apocalypse</font>

9
00:00:43,620 --> 00:00:47,580
<font color="#E5E5E5">and in in that talk I kind of walked</font>

10
00:00:45,960 --> 00:00:50,640
through the top<font color="#CCCCCC"> ten</font><font color="#E5E5E5"> things that we find</font>

11
00:00:47,580 --> 00:00:52,500
<font color="#E5E5E5">on penetration tests</font><font color="#CCCCCC"> and there were</font>

12
00:00:50,640 --> 00:00:53,670
things that I was<font color="#CCCCCC"> able to list out and a</font>

13
00:00:52,500 --> 00:00:56,309
lot of<font color="#E5E5E5"> organizations that we</font><font color="#CCCCCC"> Penn to us</font>

14
00:00:53,670 --> 00:00:58,320
today<font color="#CCCCCC"> like go fix</font><font color="#E5E5E5"> that stuff before we</font>

15
00:00:56,309 --> 00:01:00,449
pen test them<font color="#CCCCCC"> so we were forced to</font><font color="#E5E5E5"> find</font>

16
00:00:58,320 --> 00:01:02,160
new things<font color="#E5E5E5"> and out of</font><font color="#CCCCCC"> that came the idea</font>

17
00:01:00,449 --> 00:01:04,319
<font color="#CCCCCC">of</font><font color="#E5E5E5"> doing this red team apocalypse talk</font>

18
00:01:02,160 --> 00:01:05,280
which is<font color="#E5E5E5"> kind of like</font><font color="#CCCCCC"> the next</font><font color="#E5E5E5"> like it's</font>

19
00:01:04,319 --> 00:01:06,360
<font color="#E5E5E5">not even ten things it's</font><font color="#CCCCCC"> more than</font><font color="#E5E5E5"> ten</font>

20
00:01:05,280 --> 00:01:08,280
things we're gonna cram a lot<font color="#E5E5E5"> of stuff</font>

21
00:01:06,360 --> 00:01:11,160
and you're gonna get a lot<font color="#CCCCCC"> of</font>

22
00:01:08,280 --> 00:01:18,119
information<font color="#CCCCCC"> from this hopefully and yeah</font>

23
00:01:11,160 --> 00:01:19,740
it's basically the the<font color="#E5E5E5"> next step so how</font>

24
00:01:18,119 --> 00:01:22,080
many<font color="#E5E5E5"> people do regular pen testing at</font>

25
00:01:19,740 --> 00:01:24,570
their companies<font color="#CCCCCC"> so you</font><font color="#E5E5E5"> know hopefully it</font>

26
00:01:22,080 --> 00:01:26,759
went<font color="#E5E5E5"> well</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> you know how many</font>

27
00:01:24,570 --> 00:01:30,298
people use an<font color="#CCCCCC"> endpoint</font><font color="#E5E5E5"> detection and</font>

28
00:01:26,759 --> 00:01:32,909
response type cyber<font color="#E5E5E5"> apt blinky box thing</font>

29
00:01:30,299 --> 00:01:34,680
<font color="#E5E5E5">right so what would you do if you came</font>

30
00:01:32,909 --> 00:01:36,090
in one morning on<font color="#E5E5E5"> a Monday</font><font color="#CCCCCC"> you got your</font>

31
00:01:34,680 --> 00:01:38,939
coffee and<font color="#E5E5E5"> you sat</font><font color="#CCCCCC"> down</font><font color="#E5E5E5"> you found out</font>

32
00:01:36,090 --> 00:01:41,009
that<font color="#CCCCCC"> your sensitive</font><font color="#E5E5E5"> database is being</font>

33
00:01:38,939 --> 00:01:46,079
sold on the dark web<font color="#E5E5E5"> see if I can get</font>

34
00:01:41,009 --> 00:01:47,520
<font color="#E5E5E5">one more</font><font color="#CCCCCC"> buzzword in there so</font><font color="#E5E5E5"> that</font>

35
00:01:46,079 --> 00:01:48,809
that's what<font color="#E5E5E5"> this talks about like how</font>

36
00:01:47,520 --> 00:01:49,829
would<font color="#CCCCCC"> an attacker if you're</font><font color="#E5E5E5"> doing all</font>

37
00:01:48,810 --> 00:01:50,729
the things<font color="#CCCCCC"> that you thought you were</font>

38
00:01:49,829 --> 00:01:52,860
supposed<font color="#E5E5E5"> to be doing</font>

39
00:01:50,729 --> 00:01:55,860
you you're getting annual pen<font color="#E5E5E5"> tests you</font>

40
00:01:52,860 --> 00:01:57,990
have<font color="#CCCCCC"> defense-in-depth yet somehow you</font>

41
00:01:55,860 --> 00:02:02,729
still got compromised<font color="#CCCCCC"> how did that</font>

42
00:01:57,990 --> 00:02:04,530
happen so a little<font color="#E5E5E5"> bit about us we</font><font color="#CCCCCC"> work</font>

43
00:02:02,729 --> 00:02:08,100
<font color="#E5E5E5">for Black Hills information security</font>

44
00:02:04,530 --> 00:02:10,320
I'm<font color="#E5E5E5"> Derek banks I'm Bo Bullock and so</font>

45
00:02:08,100 --> 00:02:11,730
we're pen testers<font color="#E5E5E5"> we do red teams</font>

46
00:02:10,320 --> 00:02:13,828
together<font color="#E5E5E5"> in fact I'm gonna let Bo tell</font>

47
00:02:11,730 --> 00:02:15,209
you about this picture<font color="#CCCCCC"> yeah so</font><font color="#E5E5E5"> this</font>

48
00:02:13,829 --> 00:02:17,220
<font color="#E5E5E5">actually from a</font><font color="#CCCCCC"> red team engagement we</font>

49
00:02:15,209 --> 00:02:20,100
went on we were<font color="#E5E5E5"> testing a music industry</font>

50
00:02:17,220 --> 00:02:23,100
company<font color="#E5E5E5"> and I got our owner John strand</font>

51
00:02:20,100 --> 00:02:26,220
to let me expense in a<font color="#E5E5E5"> guitar to have a</font>

52
00:02:23,100 --> 00:02:28,858
ruse to<font color="#E5E5E5"> go in musicians</font><font color="#CCCCCC"> it's awesome so</font>

53
00:02:26,220 --> 00:02:31,889
we we broke into<font color="#CCCCCC"> a building</font><font color="#E5E5E5"> with guitars</font>

54
00:02:28,859 --> 00:02:34,319
<font color="#E5E5E5">it was pretty good the yeah my wife</font>

55
00:02:31,889 --> 00:02:36,090
<font color="#E5E5E5">wasn't having a security footage later</font><font color="#CCCCCC"> I</font>

56
00:02:34,319 --> 00:02:37,619
you know a picture<font color="#CCCCCC"> of me with</font><font color="#E5E5E5"> like you</font>

57
00:02:36,090 --> 00:02:39,389
know guitars and me and<font color="#E5E5E5"> him and</font><font color="#CCCCCC"> just</font>

58
00:02:37,620 --> 00:02:40,650
yeah<font color="#E5E5E5"> it looked bad it looked like one of</font>

59
00:02:39,389 --> 00:02:43,379
<font color="#E5E5E5">those things that you know you'd see</font><font color="#CCCCCC"> on</font>

60
00:02:40,650 --> 00:02:45,269
<font color="#E5E5E5">the news yeah so we actually hung out in</font>

61
00:02:43,379 --> 00:02:48,599
<font color="#CCCCCC">the practice room that they had set</font>

62
00:02:45,269 --> 00:02:50,459
aside<font color="#E5E5E5"> for musicians</font><font color="#CCCCCC"> for you know</font><font color="#E5E5E5"> like</font>

63
00:02:48,599 --> 00:02:52,920
four or five<font color="#CCCCCC"> hours actually playing</font>

64
00:02:50,459 --> 00:02:55,379
music and then waited for everybody to

65
00:02:52,920 --> 00:02:56,760
go home<font color="#CCCCCC"> and then started</font><font color="#E5E5E5"> going around</font>

66
00:02:55,379 --> 00:02:57,480
<font color="#E5E5E5">and trying to get into people's</font>

67
00:02:56,760 --> 00:02:59,819
<font color="#CCCCCC">computers</font>

68
00:02:57,480 --> 00:03:02,069
unless work stations you know<font color="#CCCCCC"> yeah words</font>

69
00:02:59,819 --> 00:03:04,018
on post-it notes<font color="#CCCCCC"> there was actually a</font>

70
00:03:02,069 --> 00:03:05,488
live<font color="#CCCCCC"> Jack in that room too which was</font>

71
00:03:04,019 --> 00:03:09,180
<font color="#E5E5E5">pretty fun there were some pretty sweet</font>

72
00:03:05,489 --> 00:03:11,340
<font color="#E5E5E5">amps in that building</font><font color="#CCCCCC"> too thank you sue</font>

73
00:03:09,180 --> 00:03:13,620
<font color="#E5E5E5">we go back one side real quick</font><font color="#CCCCCC"> we also</font>

74
00:03:11,340 --> 00:03:14,849
do we started a few meetups<font color="#CCCCCC"> so</font><font color="#E5E5E5"> city</font>

75
00:03:13,620 --> 00:03:16,739
second meetups if you're familiar<font color="#E5E5E5"> with</font>

76
00:03:14,849 --> 00:03:18,480
<font color="#CCCCCC">like</font><font color="#E5E5E5"> the reddit</font><font color="#CCCCCC"> city SEC thing</font><font color="#E5E5E5"> so if</font>

77
00:03:16,739 --> 00:03:21,150
you're ever<font color="#E5E5E5"> in Florida there's Tampa and</font>

78
00:03:18,480 --> 00:03:23,129
Orlando and<font color="#E5E5E5"> he's got Tidewater</font><font color="#CCCCCC"> sec yeah</font>

79
00:03:21,150 --> 00:03:24,900
so normally<font color="#CCCCCC"> when I asked this question</font>

80
00:03:23,129 --> 00:03:28,459
<font color="#E5E5E5">nobody raises their hand but how many</font>

81
00:03:24,900 --> 00:03:30,569
<font color="#E5E5E5">people</font><font color="#CCCCCC"> are here from Virginia oh yeah</font>

82
00:03:28,459 --> 00:03:32,639
<font color="#CCCCCC">normally that's</font><font color="#E5E5E5"> not the case so if</font>

83
00:03:30,569 --> 00:03:34,349
you're<font color="#E5E5E5"> down</font><font color="#CCCCCC"> in the peninsula area you</font>

84
00:03:32,639 --> 00:03:36,299
know Newport News<font color="#CCCCCC"> and Hampton</font><font color="#E5E5E5"> we have a</font>

85
00:03:34,349 --> 00:03:38,219
local<font color="#E5E5E5"> meetup the same thing we</font><font color="#CCCCCC"> get</font>

86
00:03:36,299 --> 00:03:40,799
together once a<font color="#CCCCCC"> month</font><font color="#E5E5E5"> hanging out the</font>

87
00:03:38,219 --> 00:03:44,129
bar and and you know talk<font color="#CCCCCC"> about security</font>

88
00:03:40,799 --> 00:03:48,150
computers whatever<font color="#CCCCCC"> also how many people</font>

89
00:03:44,129 --> 00:03:49,198
use office<font color="#E5E5E5"> web app that's a lot less</font>

90
00:03:48,150 --> 00:03:53,129
<font color="#CCCCCC">than it used</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> be</font>

91
00:03:49,199 --> 00:03:53,939
so really<font color="#E5E5E5"> Outlook Web App yeah well</font>

92
00:03:53,129 --> 00:03:56,250
there should be<font color="#E5E5E5"> some more hands</font><font color="#CCCCCC"> than</font>

93
00:03:53,939 --> 00:03:57,659
that oh well<font color="#E5E5E5"> good</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> you because that's</font>

94
00:03:56,250 --> 00:03:59,639
<font color="#CCCCCC">actually one of</font><font color="#E5E5E5"> my favorite Microsoft</font>

95
00:03:57,659 --> 00:04:03,259
products yes<font color="#CCCCCC"> well we'll</font><font color="#E5E5E5"> talk</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> that</font>

96
00:03:59,639 --> 00:04:05,639
<font color="#E5E5E5">some more soon</font><font color="#CCCCCC"> okay so this slide is a</font>

97
00:04:03,259 --> 00:04:09,000
basically<font color="#E5E5E5"> condensed</font><font color="#CCCCCC"> version of an entire</font>

98
00:04:05,639 --> 00:04:10,530
like<font color="#CCCCCC"> 60 minute talk so I'll go through</font>

99
00:04:09,000 --> 00:04:13,319
<font color="#CCCCCC">stria Lee quickly this</font><font color="#E5E5E5"> was the original</font>

100
00:04:10,530 --> 00:04:15,359
<font color="#E5E5E5">pen test pin test apocalypse</font><font color="#CCCCCC"> top 10</font>

101
00:04:13,319 --> 00:04:18,149
<font color="#E5E5E5">things that</font><font color="#CCCCCC"> we kind of found on</font>

102
00:04:15,359 --> 00:04:20,340
assessments and<font color="#E5E5E5"> one of these is</font><font color="#CCCCCC"> actually</font>

103
00:04:18,149 --> 00:04:22,710
two<font color="#E5E5E5"> things that's why you only see nine</font>

104
00:04:20,339 --> 00:04:23,729
slides there but so vulnerability

105
00:04:22,710 --> 00:04:27,180
management of course like finding

106
00:04:23,729 --> 00:04:28,590
finding exploit exploitable<font color="#E5E5E5"> services is</font>

107
00:04:27,180 --> 00:04:31,979
a<font color="#E5E5E5"> very common thing we find</font><font color="#CCCCCC"> up in test</font>

108
00:04:28,590 --> 00:04:33,719
<font color="#E5E5E5">group policy preferences so it used to</font>

109
00:04:31,979 --> 00:04:36,659
<font color="#CCCCCC">be</font><font color="#E5E5E5"> whenever you created a local admin</font>

110
00:04:33,719 --> 00:04:39,270
user with a<font color="#CCCCCC"> GPP</font><font color="#E5E5E5"> that it would actually</font>

111
00:04:36,659 --> 00:04:41,159
<font color="#E5E5E5">store that credential in a reversible</font>

112
00:04:39,270 --> 00:04:42,779
format on a share that's accessible by

113
00:04:41,159 --> 00:04:44,729
everybody and we still find<font color="#E5E5E5"> it very</font>

114
00:04:42,779 --> 00:04:46,380
often<font color="#E5E5E5"> today it's one of the first things</font>

115
00:04:44,729 --> 00:04:47,969
we<font color="#CCCCCC"> always look for</font><font color="#E5E5E5"> in</font><font color="#CCCCCC"> Pentos is just go</font>

116
00:04:46,380 --> 00:04:50,400
see<font color="#E5E5E5"> if there's clear text</font><font color="#CCCCCC"> Cruden</font>

117
00:04:47,970 --> 00:04:51,570
<font color="#E5E5E5">and</font><font color="#CCCCCC"> GPP files</font><font color="#E5E5E5"> widespread local</font>

118
00:04:50,400 --> 00:04:53,159
administrator<font color="#E5E5E5"> accounts so this is you</font>

119
00:04:51,570 --> 00:04:55,800
<font color="#E5E5E5">know your typical we have the same local</font>

120
00:04:53,160 --> 00:04:57,180
<font color="#E5E5E5">admin user on every</font><font color="#CCCCCC"> workstation and when</font>

121
00:04:55,800 --> 00:04:59,610
<font color="#E5E5E5">that's the case you know we can pass the</font>

122
00:04:57,180 --> 00:05:00,960
hash of<font color="#E5E5E5"> that user</font><font color="#CCCCCC"> you know if they're</font>

123
00:04:59,610 --> 00:05:03,450
not randomizing the local administrator

124
00:05:00,960 --> 00:05:06,510
credential<font color="#E5E5E5"> weak passwords</font><font color="#CCCCCC"> this is</font>

125
00:05:03,450 --> 00:05:08,010
something we still find all the time<font color="#CCCCCC"> we</font>

126
00:05:06,510 --> 00:05:10,050
do what's called password<font color="#CCCCCC"> spraying</font>

127
00:05:08,010 --> 00:05:11,460
attacks against networks where we

128
00:05:10,050 --> 00:05:14,100
<font color="#E5E5E5">basically take the entire user list and</font>

129
00:05:11,460 --> 00:05:16,500
then perform an authentication attempt

130
00:05:14,100 --> 00:05:18,390
<font color="#E5E5E5">one at</font><font color="#CCCCCC"> 100 10 occasionally to those</font>

131
00:05:16,500 --> 00:05:20,580
<font color="#E5E5E5">users so we're not locking anybody out</font>

132
00:05:18,390 --> 00:05:22,979
but<font color="#CCCCCC"> it enables us to do</font><font color="#E5E5E5"> things like</font>

133
00:05:20,580 --> 00:05:24,630
perform thousands of login attempts for

134
00:05:22,980 --> 00:05:27,450
<font color="#E5E5E5">a single password something like</font><font color="#CCCCCC"> Summer</font>

135
00:05:24,630 --> 00:05:28,890
2017<font color="#E5E5E5"> or you know common common common</font>

136
00:05:27,450 --> 00:05:30,599
passwords<font color="#CCCCCC"> like company name</font><font color="#E5E5E5"> one two</font>

137
00:05:28,890 --> 00:05:34,680
<font color="#E5E5E5">three that's a summer</font><font color="#CCCCCC"> twenty twenty</font>

138
00:05:30,600 --> 00:05:36,420
<font color="#CCCCCC">eighteen this</font><font color="#E5E5E5"> yeah you're right</font><font color="#CCCCCC"> over</font>

139
00:05:34,680 --> 00:05:38,280
privileged users so<font color="#CCCCCC"> having</font><font color="#E5E5E5"> users that</font>

140
00:05:36,420 --> 00:05:41,070
are already admin of their system is

141
00:05:38,280 --> 00:05:43,679
something<font color="#CCCCCC"> we find</font><font color="#E5E5E5"> pretty often and also</font>

142
00:05:41,070 --> 00:05:44,969
<font color="#E5E5E5">so this would be the other this is the</font>

143
00:05:43,680 --> 00:05:46,440
<font color="#E5E5E5">one that has two</font><font color="#CCCCCC"> different</font><font color="#E5E5E5"> meanings so</font>

144
00:05:44,970 --> 00:05:48,210
the over privileged users of your<font color="#CCCCCC"> local</font>

145
00:05:46,440 --> 00:05:50,310
system<font color="#CCCCCC"> and then over privileged users on</font>

146
00:05:48,210 --> 00:05:52,979
the domain<font color="#E5E5E5"> so a lot of times we'll find</font>

147
00:05:50,310 --> 00:05:56,580
that<font color="#E5E5E5"> users have been added</font><font color="#CCCCCC"> to groups</font>

148
00:05:52,980 --> 00:05:58,169
<font color="#CCCCCC">such as local admins that that are</font>

149
00:05:56,580 --> 00:05:59,940
members<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the domain</font><font color="#CCCCCC"> users group so</font>

150
00:05:58,169 --> 00:06:01,380
<font color="#E5E5E5">domain users group gets added to local</font>

151
00:05:59,940 --> 00:06:03,510
admins<font color="#E5E5E5"> and when that happens we will</font>

152
00:06:01,380 --> 00:06:05,340
<font color="#E5E5E5">find that workstation on the network and</font>

153
00:06:03,510 --> 00:06:06,659
domain users if<font color="#E5E5E5"> you're you're you know</font>

154
00:06:05,340 --> 00:06:09,060
everyone's a member of domain users<font color="#CCCCCC"> so</font>

155
00:06:06,660 --> 00:06:11,010
<font color="#E5E5E5">now local admin on that system</font><font color="#CCCCCC"> sensitive</font>

156
00:06:09,060 --> 00:06:13,800
data in file shares<font color="#E5E5E5"> this is you know</font>

157
00:06:11,010 --> 00:06:15,390
exactly<font color="#CCCCCC"> the title right finding things</font>

158
00:06:13,800 --> 00:06:16,890
<font color="#E5E5E5">on the network</font><font color="#CCCCCC"> that shouldn't be in</font>

159
00:06:15,390 --> 00:06:20,219
files like finding passwords and

160
00:06:16,890 --> 00:06:22,680
document files finding databases that

161
00:06:20,220 --> 00:06:24,450
are<font color="#E5E5E5"> just accessible finding images of</font>

162
00:06:22,680 --> 00:06:26,190
virtual machines<font color="#E5E5E5"> that</font><font color="#CCCCCC"> are accessible</font>

163
00:06:24,450 --> 00:06:29,340
that<font color="#CCCCCC"> I can go</font><font color="#E5E5E5"> download and you know</font>

164
00:06:26,190 --> 00:06:30,600
extract<font color="#E5E5E5"> credentials from intranet</font>

165
00:06:29,340 --> 00:06:32,429
information disclosure so this is

166
00:06:30,600 --> 00:06:33,900
<font color="#E5E5E5">something</font><font color="#CCCCCC"> that actually is</font><font color="#E5E5E5"> it's really</font>

167
00:06:32,430 --> 00:06:34,919
fun to<font color="#E5E5E5"> find when you're actually pen</font>

168
00:06:33,900 --> 00:06:37,289
<font color="#E5E5E5">testing a company that uses something</font>

169
00:06:34,919 --> 00:06:39,090
like office 365<font color="#CCCCCC"> and you get a credential</font>

170
00:06:37,290 --> 00:06:40,650
to access something<font color="#E5E5E5"> like SharePoint</font><font color="#CCCCCC"> now</font>

171
00:06:39,090 --> 00:06:42,989
you can go look for things like<font color="#E5E5E5"> how do</font><font color="#CCCCCC"> I</font>

172
00:06:40,650 --> 00:06:44,549
VPN into the organization<font color="#E5E5E5"> and</font><font color="#CCCCCC"> oftentimes</font>

173
00:06:42,990 --> 00:06:48,090
<font color="#CCCCCC">will find that that documentation</font><font color="#E5E5E5"> is</font>

174
00:06:44,550 --> 00:06:50,040
there<font color="#E5E5E5"> and in many cases</font><font color="#CCCCCC"> the things the</font>

175
00:06:48,090 --> 00:06:52,080
items you<font color="#CCCCCC"> need are</font><font color="#E5E5E5"> there to like like</font>

176
00:06:50,040 --> 00:06:53,990
<font color="#E5E5E5">keys like if you need like</font><font color="#CCCCCC"> a second</font>

177
00:06:52,080 --> 00:06:56,580
factor<font color="#E5E5E5"> that's like a workstation key</font>

178
00:06:53,990 --> 00:06:59,430
<font color="#CCCCCC">NetBIOS an element are poisoning this is</font>

179
00:06:56,580 --> 00:07:01,020
your<font color="#E5E5E5"> your responder attack</font><font color="#CCCCCC"> if you're</font>

180
00:06:59,430 --> 00:07:01,889
familiar<font color="#E5E5E5"> with the tool responder it</font>

181
00:07:01,020 --> 00:07:03,810
basically will

182
00:07:01,889 --> 00:07:06,840
<font color="#CCCCCC">we'll respond</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> ello M&R</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> NetBIOS</font>

183
00:07:03,810 --> 00:07:10,259
queries and allow you<font color="#E5E5E5"> to obtain net</font>

184
00:07:06,840 --> 00:07:11,938
until env2 hashes<font color="#CCCCCC"> and lastly</font><font color="#E5E5E5"> local</font>

185
00:07:10,259 --> 00:07:14,430
workstation<font color="#E5E5E5"> pool adjust escalation so</font>

186
00:07:11,939 --> 00:07:16,169
<font color="#CCCCCC">oftentimes we'll find</font><font color="#E5E5E5"> that we can</font>

187
00:07:14,430 --> 00:07:20,999
escalate privileges locally through

188
00:07:16,169 --> 00:07:23,568
various misconfigured services<font color="#CCCCCC"> the</font>

189
00:07:20,999 --> 00:07:25,650
ability to hijack different dll's<font color="#CCCCCC"> and</font>

190
00:07:23,569 --> 00:07:28,199
<font color="#E5E5E5">yeah that's that's pretty much the top</font>

191
00:07:25,650 --> 00:07:30,299
<font color="#CCCCCC">10 pen test</font><font color="#E5E5E5"> spot</font><font color="#CCCCCC"> clip stuff so now</font><font color="#E5E5E5"> we're</font>

192
00:07:28,199 --> 00:07:32,370
on<font color="#CCCCCC"> to</font><font color="#E5E5E5"> the red team yeah so all that</font>

193
00:07:30,300 --> 00:07:33,599
<font color="#CCCCCC">stuff still actually works but what's</font>

194
00:07:32,370 --> 00:07:36,060
the<font color="#E5E5E5"> difference between our red team</font><font color="#CCCCCC"> and</font>

195
00:07:33,599 --> 00:07:38,060
a pen pen test and a red team anyway

196
00:07:36,060 --> 00:07:41,219
does anybody know<font color="#E5E5E5"> what the difference is</font>

197
00:07:38,060 --> 00:07:42,870
<font color="#E5E5E5">so it's probably it could be sort of</font>

198
00:07:41,219 --> 00:07:44,819
like<font color="#CCCCCC"> a religious debate right</font><font color="#E5E5E5"> like red</font>

199
00:07:42,870 --> 00:07:46,740
teams have to have like physical aspects

200
00:07:44,819 --> 00:07:48,449
and stuff<font color="#E5E5E5"> yeah so</font><font color="#CCCCCC"> maybe so this is sort</font>

201
00:07:46,740 --> 00:07:51,360
<font color="#E5E5E5">of my opinion and I think the</font><font color="#CCCCCC"> pirates</font>

202
00:07:48,449 --> 00:07:52,949
<font color="#E5E5E5">versus ninja analogy is apt and that</font>

203
00:07:51,360 --> 00:07:56,310
actually<font color="#E5E5E5"> comes from rapid7 but I look at</font>

204
00:07:52,949 --> 00:07:58,439
<font color="#E5E5E5">a pen test the goal of a pen test is to</font>

205
00:07:56,310 --> 00:08:01,199
find as many vulnerabilities<font color="#E5E5E5"> in the</font>

206
00:07:58,439 --> 00:08:03,060
environment as possible<font color="#E5E5E5"> in the amount of</font>

207
00:08:01,199 --> 00:08:04,379
time<font color="#E5E5E5"> that you have allotted for the pen</font>

208
00:08:03,060 --> 00:08:06,089
test<font color="#E5E5E5"> so</font><font color="#CCCCCC"> that's</font><font color="#E5E5E5"> why</font><font color="#CCCCCC"> you use</font><font color="#E5E5E5"> something</font>

209
00:08:04,379 --> 00:08:08,039
<font color="#E5E5E5">like a vulnerability scanner like</font><font color="#CCCCCC"> necess</font>

210
00:08:06,089 --> 00:08:10,080
you're actually looking<font color="#CCCCCC"> to cover as much</font>

211
00:08:08,039 --> 00:08:11,430
ground<font color="#E5E5E5"> to get some of that low-hanging</font>

212
00:08:10,080 --> 00:08:14,520
fruit<font color="#CCCCCC"> that we were talking about before</font>

213
00:08:11,430 --> 00:08:17,370
<font color="#CCCCCC">well a rep team</font><font color="#E5E5E5"> in my opinion a red team</font>

214
00:08:14,520 --> 00:08:19,830
is<font color="#CCCCCC"> goal-oriented so that's more like an</font>

215
00:08:17,370 --> 00:08:22,289
assassin or<font color="#E5E5E5"> a ninja you have one goal in</font>

216
00:08:19,830 --> 00:08:24,180
mind<font color="#E5E5E5"> and the goal of</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> red team is to</font>

217
00:08:22,289 --> 00:08:26,669
go find<font color="#E5E5E5"> the</font><font color="#CCCCCC"> company's sensitive data and</font>

218
00:08:24,180 --> 00:08:29,610
<font color="#E5E5E5">access it and any means necessary</font>

219
00:08:26,669 --> 00:08:34,348
now that might mean<font color="#CCCCCC"> that you know you go</font>

220
00:08:29,610 --> 00:08:36,479
to physically on site it may not you may

221
00:08:34,349 --> 00:08:37,919
even model a threat actor if that's an

222
00:08:36,479 --> 00:08:39,240
appropriate<font color="#CCCCCC"> thing for</font><font color="#E5E5E5"> the red team</font><font color="#CCCCCC"> that</font>

223
00:08:37,919 --> 00:08:41,458
you're at and so the<font color="#E5E5E5"> Pirates</font><font color="#CCCCCC"> versus</font>

224
00:08:39,240 --> 00:08:44,130
<font color="#E5E5E5">ninjas I think you know</font><font color="#CCCCCC"> Penn</font><font color="#E5E5E5"> test is</font>

225
00:08:41,458 --> 00:08:45,779
loud it's noisy<font color="#E5E5E5"> just like pirates</font>

226
00:08:44,130 --> 00:08:49,110
<font color="#E5E5E5">maybe the pen testers are drunk like</font>

227
00:08:45,779 --> 00:08:51,029
<font color="#E5E5E5">pirates I don't know</font><font color="#CCCCCC"> then you know</font><font color="#E5E5E5"> a red</font>

228
00:08:49,110 --> 00:08:52,500
team<font color="#CCCCCC"> you're stealthy you're not sure you</font>

229
00:08:51,029 --> 00:08:54,269
<font color="#E5E5E5">don't want to</font><font color="#CCCCCC"> get caught you don't you</font>

230
00:08:52,500 --> 00:08:56,070
care<font color="#CCCCCC"> about</font><font color="#E5E5E5"> getting caught if you get</font>

231
00:08:54,269 --> 00:08:58,350
caught well that's pretty<font color="#E5E5E5"> much the</font><font color="#CCCCCC"> end</font>

232
00:08:56,070 --> 00:09:00,230
<font color="#E5E5E5">of the red team right so it's silent</font>

233
00:08:58,350 --> 00:09:03,780
like a ninja

234
00:09:00,230 --> 00:09:05,760
so how would<font color="#CCCCCC"> you go about conducting</font><font color="#E5E5E5"> a</font>

235
00:09:03,780 --> 00:09:08,540
red team<font color="#E5E5E5"> so this is sort of a condensed</font>

236
00:09:05,760 --> 00:09:10,260
methodology<font color="#CCCCCC"> the the first phase is</font>

237
00:09:08,540 --> 00:09:13,050
reconnaissance<font color="#E5E5E5"> you have to know your</font>

238
00:09:10,260 --> 00:09:14,280
target<font color="#CCCCCC"> you have</font><font color="#E5E5E5"> to know you know the</font>

239
00:09:13,050 --> 00:09:17,459
employees<font color="#CCCCCC"> that work there</font><font color="#E5E5E5"> what the</font>

240
00:09:14,280 --> 00:09:19,050
business does<font color="#CCCCCC"> you know recon is probably</font>

241
00:09:17,460 --> 00:09:20,880
one of the most<font color="#E5E5E5"> important steps and</font>

242
00:09:19,050 --> 00:09:23,160
<font color="#E5E5E5">actually done properly takes a little</font>

243
00:09:20,880 --> 00:09:25,110
<font color="#CCCCCC">bit of</font><font color="#E5E5E5"> time to do next you have</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> gain</font>

244
00:09:23,160 --> 00:09:26,670
some<font color="#CCCCCC"> kind of foothold in the environment</font>

245
00:09:25,110 --> 00:09:29,070
and we'll<font color="#E5E5E5"> call that compromise</font>

246
00:09:26,670 --> 00:09:31,469
exploitation whatever so that's<font color="#E5E5E5"> you know</font>

247
00:09:29,070 --> 00:09:34,980
getting some<font color="#CCCCCC"> kind of code execution or</font>

248
00:09:31,470 --> 00:09:37,410
some kind<font color="#E5E5E5"> of access</font><font color="#CCCCCC"> to assets</font><font color="#E5E5E5"> that are</font>

249
00:09:34,980 --> 00:09:41,460
going<font color="#E5E5E5"> to lead you</font><font color="#CCCCCC"> to sensitive data</font>

250
00:09:37,410 --> 00:09:42,870
<font color="#E5E5E5">eventually then persistence</font><font color="#CCCCCC"> I think that</font>

251
00:09:41,460 --> 00:09:46,320
a proper<font color="#CCCCCC"> red team you're</font><font color="#E5E5E5"> going to</font>

252
00:09:42,870 --> 00:09:49,080
establish<font color="#CCCCCC"> some</font><font color="#E5E5E5"> kind of quote long term</font>

253
00:09:46,320 --> 00:09:50,700
backdoor not long term but<font color="#E5E5E5"> you want some</font>

254
00:09:49,080 --> 00:09:52,380
way<font color="#E5E5E5"> to maintain access into the</font>

255
00:09:50,700 --> 00:09:55,110
environment<font color="#CCCCCC"> whether</font><font color="#E5E5E5"> that's the VPN that</font>

256
00:09:52,380 --> 00:09:57,000
<font color="#CCCCCC">we you</font><font color="#E5E5E5"> know may be gone out of email or</font>

257
00:09:55,110 --> 00:09:58,650
if that's you know some kind<font color="#CCCCCC"> of command</font>

258
00:09:57,000 --> 00:10:02,730
<font color="#CCCCCC">and</font><font color="#E5E5E5"> control system like you know a</font>

259
00:09:58,650 --> 00:10:04,650
<font color="#CCCCCC">backdoor and</font><font color="#E5E5E5"> then after that asset</font>

260
00:10:02,730 --> 00:10:06,240
discovery<font color="#E5E5E5"> so that's more like internal</font>

261
00:10:04,650 --> 00:10:09,510
reconnaissance like finding<font color="#E5E5E5"> out what's</font>

262
00:10:06,240 --> 00:10:12,210
going on<font color="#CCCCCC"> inside the</font><font color="#E5E5E5"> network where those</font>

263
00:10:09,510 --> 00:10:14,689
servers<font color="#E5E5E5"> or databases that you're trying</font>

264
00:10:12,210 --> 00:10:16,530
<font color="#E5E5E5">to go after where they where they live</font>

265
00:10:14,690 --> 00:10:18,660
<font color="#E5E5E5">typically to do that you'll need to</font>

266
00:10:16,530 --> 00:10:19,949
<font color="#E5E5E5">escalate your privileges in some manner</font>

267
00:10:18,660 --> 00:10:21,689
<font color="#E5E5E5">right you'll need to be a database</font>

268
00:10:19,950 --> 00:10:23,250
<font color="#E5E5E5">administrator you'll need to be some</font>

269
00:10:21,690 --> 00:10:25,500
<font color="#E5E5E5">kind of administrator to get there</font><font color="#CCCCCC"> and</font>

270
00:10:23,250 --> 00:10:28,200
then<font color="#CCCCCC"> you'll</font><font color="#E5E5E5"> move laterally through</font><font color="#CCCCCC"> the</font>

271
00:10:25,500 --> 00:10:29,790
network<font color="#CCCCCC"> so going to</font><font color="#E5E5E5"> workstation to</font>

272
00:10:28,200 --> 00:10:32,900
workstation or<font color="#E5E5E5"> workstation</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> server</font>

273
00:10:29,790 --> 00:10:35,550
through some means and then finally

274
00:10:32,900 --> 00:10:37,199
we'll call it actions on objectives<font color="#CCCCCC"> yes</font>

275
00:10:35,550 --> 00:10:41,790
I did steal<font color="#E5E5E5"> that from a trademarked</font>

276
00:10:37,200 --> 00:10:45,120
<font color="#E5E5E5">thing but okay so and what I mean</font><font color="#CCCCCC"> by</font>

277
00:10:41,790 --> 00:10:46,589
that<font color="#E5E5E5"> is that you</font><font color="#CCCCCC"> go get</font><font color="#E5E5E5"> that data and</font>

278
00:10:45,120 --> 00:10:48,570
maybe do like a mock exfiltration

279
00:10:46,590 --> 00:10:49,830
whatever the<font color="#E5E5E5"> point</font><font color="#CCCCCC"> of contact or</font><font color="#E5E5E5"> the</font>

280
00:10:48,570 --> 00:10:51,300
client wants you to do if it's<font color="#E5E5E5"> just</font>

281
00:10:49,830 --> 00:10:53,280
<font color="#E5E5E5">gaining access if it's copying it to</font>

282
00:10:51,300 --> 00:10:55,260
<font color="#E5E5E5">your machine</font><font color="#CCCCCC"> whatever that's so that's</font>

283
00:10:53,280 --> 00:10:57,780
how a threat actor in my opinion would

284
00:10:55,260 --> 00:11:01,220
go about conducting<font color="#CCCCCC"> an actual attack</font>

285
00:10:57,780 --> 00:11:01,220
<font color="#E5E5E5">which are modeling in the red team</font>

286
00:11:03,440 --> 00:11:07,040
<font color="#E5E5E5">okay so we're actually getting into the</font>

287
00:11:04,940 --> 00:11:08,569
<font color="#CCCCCC">the actual techniques and tactics at</font>

288
00:11:07,040 --> 00:11:09,560
this point<font color="#CCCCCC"> a lot of</font><font color="#E5E5E5"> this stuff I think</font>

289
00:11:08,569 --> 00:11:10,759
<font color="#E5E5E5">we're probably gonna go through pretty</font>

290
00:11:09,560 --> 00:11:13,729
quickly because<font color="#E5E5E5"> we</font><font color="#CCCCCC"> have</font><font color="#E5E5E5"> a lot of stuff</font>

291
00:11:10,759 --> 00:11:15,620
to cover<font color="#CCCCCC"> we as an organization have been</font>

292
00:11:13,730 --> 00:11:17,449
<font color="#CCCCCC">doing a lot of research into attacking</font><font color="#E5E5E5"> G</font>

293
00:11:15,620 --> 00:11:18,620
<font color="#E5E5E5">suite lately just because we've had a</font>

294
00:11:17,449 --> 00:11:21,199
number<font color="#CCCCCC"> of customers that</font><font color="#E5E5E5"> we've come up</font>

295
00:11:18,620 --> 00:11:22,879
<font color="#CCCCCC">against</font><font color="#E5E5E5"> that are you know they using G</font>

296
00:11:21,199 --> 00:11:26,779
suite<font color="#E5E5E5"> for for everything you know email</font>

297
00:11:22,879 --> 00:11:28,550
<font color="#E5E5E5">sharing data and so through that</font><font color="#CCCCCC"> we have</font>

298
00:11:26,779 --> 00:11:29,899
developed<font color="#CCCCCC"> a few different techniques</font><font color="#E5E5E5"> for</font>

299
00:11:28,550 --> 00:11:31,399
trying<font color="#E5E5E5"> to attack those types of</font>

300
00:11:29,899 --> 00:11:33,079
<font color="#E5E5E5">organizations</font><font color="#CCCCCC"> that are</font><font color="#E5E5E5"> used utilizing</font>

301
00:11:31,399 --> 00:11:34,790
<font color="#CCCCCC">newsfeed</font><font color="#E5E5E5"> so I'm gonna walk through</font><font color="#CCCCCC"> a few</font>

302
00:11:33,079 --> 00:11:37,008
of these real quick<font color="#CCCCCC"> all right so Google</font>

303
00:11:34,790 --> 00:11:38,540
<font color="#E5E5E5">Hangouts</font><font color="#CCCCCC"> aru's so remember like whenever</font>

304
00:11:37,009 --> 00:11:40,610
<font color="#E5E5E5">used to try to chat</font><font color="#CCCCCC"> with somebody</font><font color="#E5E5E5"> in</font>

305
00:11:38,540 --> 00:11:42,589
Gmail<font color="#CCCCCC"> they used to get this</font><font color="#E5E5E5"> little</font>

306
00:11:40,610 --> 00:11:45,379
<font color="#E5E5E5">pop-up they said hey you know so-and-so</font>

307
00:11:42,589 --> 00:11:47,000
wants to chat with you<font color="#E5E5E5"> is that okay</font><font color="#CCCCCC"> so</font>

308
00:11:45,379 --> 00:11:49,040
apparently<font color="#CCCCCC"> this was too much for some</font>

309
00:11:47,000 --> 00:11:51,319
users<font color="#E5E5E5"> is like too much work to click the</font>

310
00:11:49,040 --> 00:11:53,290
yes button<font color="#E5E5E5"> because now by default it</font>

311
00:11:51,319 --> 00:11:55,790
just lets<font color="#E5E5E5"> you pop</font><font color="#CCCCCC"> up a message</font><font color="#E5E5E5"> anybody</font>

312
00:11:53,290 --> 00:11:56,449
<font color="#E5E5E5">if you've started if you created</font><font color="#CCCCCC"> a gmail</font>

313
00:11:55,790 --> 00:11:58,219
<font color="#E5E5E5">account today</font>

314
00:11:56,449 --> 00:12:00,378
<font color="#CCCCCC">you have to go actually change your</font>

315
00:11:58,220 --> 00:12:03,079
<font color="#E5E5E5">default setting to make it so that it</font>

316
00:12:00,379 --> 00:12:04,850
requires an invite<font color="#E5E5E5"> for you to accept</font><font color="#CCCCCC"> but</font>

317
00:12:03,079 --> 00:12:06,649
now the<font color="#CCCCCC"> default is that I can literally</font>

318
00:12:04,850 --> 00:12:08,029
<font color="#E5E5E5">open</font><font color="#CCCCCC"> up</font><font color="#E5E5E5"> a message and oh yeah I can</font><font color="#CCCCCC"> make</font>

319
00:12:06,649 --> 00:12:11,329
<font color="#E5E5E5">it</font><font color="#CCCCCC"> look</font><font color="#E5E5E5"> like Google security talking to</font>

320
00:12:08,029 --> 00:12:12,949
you<font color="#E5E5E5"> too so by</font><font color="#CCCCCC"> just changing your</font><font color="#E5E5E5"> name</font><font color="#CCCCCC"> so</font>

321
00:12:11,329 --> 00:12:14,750
the email address doesn't<font color="#E5E5E5"> even get shown</font>

322
00:12:12,949 --> 00:12:17,439
and hangouts anymore so this<font color="#CCCCCC"> be creates</font>

323
00:12:14,750 --> 00:12:19,519
a pretty fun social<font color="#E5E5E5"> engineering</font>

324
00:12:17,439 --> 00:12:22,399
<font color="#CCCCCC">opportunity</font><font color="#E5E5E5"> here where you can now pop a</font>

325
00:12:19,519 --> 00:12:25,040
message box open to somebody and say<font color="#CCCCCC"> hey</font>

326
00:12:22,399 --> 00:12:27,470
you know like you<font color="#E5E5E5"> know click this link</font>

327
00:12:25,040 --> 00:12:29,569
<font color="#E5E5E5">because you know whatever</font><font color="#CCCCCC"> like backup</font>

328
00:12:27,470 --> 00:12:33,589
<font color="#E5E5E5">your your your security codes or</font>

329
00:12:29,569 --> 00:12:36,649
<font color="#CCCCCC">something and if</font><font color="#E5E5E5"> even if you have like</font>

330
00:12:33,589 --> 00:12:38,269
the invite enabled<font color="#CCCCCC"> it looks you can</font>

331
00:12:36,649 --> 00:12:40,189
somewhat<font color="#E5E5E5"> make it look really legit like</font>

332
00:12:38,269 --> 00:12:41,569
<font color="#E5E5E5">so this is a new hangout invite from</font>

333
00:12:40,189 --> 00:12:42,889
Google<font color="#CCCCCC"> Security with a logo and</font>

334
00:12:41,569 --> 00:12:44,719
<font color="#E5E5E5">everything let's hang out like there's</font>

335
00:12:42,889 --> 00:12:47,839
nothing indicative of maliciousness

336
00:12:44,720 --> 00:12:49,160
there<font color="#CCCCCC"> and so like</font><font color="#E5E5E5"> you know somebody</font>

337
00:12:47,839 --> 00:12:50,959
who's<font color="#E5E5E5"> not really paying attention might</font>

338
00:12:49,160 --> 00:12:52,579
just click<font color="#CCCCCC"> accept it now</font><font color="#E5E5E5"> kind</font><font color="#CCCCCC"> of think</font>

339
00:12:50,959 --> 00:12:55,279
of this same concept<font color="#CCCCCC"> but you know</font>

340
00:12:52,579 --> 00:12:56,630
mimicking somebody they've already<font color="#CCCCCC"> had</font>

341
00:12:55,279 --> 00:12:58,819
<font color="#CCCCCC">they have a relationship</font><font color="#E5E5E5"> with somebody</font>

342
00:12:56,630 --> 00:13:00,949
<font color="#E5E5E5">that they work with you know just grab</font>

343
00:12:58,819 --> 00:13:02,870
their their profile picture use that and

344
00:13:00,949 --> 00:13:05,719
their name and now you are<font color="#E5E5E5"> them talking</font>

345
00:13:02,870 --> 00:13:09,790
to<font color="#E5E5E5"> them</font><font color="#CCCCCC"> through through hangouts</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> it</font>

346
00:13:05,720 --> 00:13:09,790
creates a very<font color="#E5E5E5"> interesting</font>

347
00:13:10,180 --> 00:13:14,839
social engineering aspect and the other

348
00:13:13,069 --> 00:13:15,949
thing<font color="#CCCCCC"> that kind of is really bad about</font>

349
00:13:14,839 --> 00:13:17,600
this is there doesn't really<font color="#CCCCCC"> appear to</font>

350
00:13:15,949 --> 00:13:20,500
be a global<font color="#E5E5E5"> auction up</font>

351
00:13:17,600 --> 00:13:24,100
within<font color="#E5E5E5"> Google</font><font color="#CCCCCC"> G suite</font><font color="#E5E5E5"> to lock that down</font>

352
00:13:20,500 --> 00:13:27,920
<font color="#CCCCCC">so</font><font color="#E5E5E5"> that you know requires everyone</font><font color="#CCCCCC"> to</font>

353
00:13:24,100 --> 00:13:29,630
require an invite another<font color="#CCCCCC"> thing is this</font>

354
00:13:27,920 --> 00:13:31,160
Google Doc<font color="#CCCCCC"> Rouge so this is another</font>

355
00:13:29,630 --> 00:13:32,560
social<font color="#E5E5E5"> engineering thing these these</font>

356
00:13:31,160 --> 00:13:35,870
three<font color="#E5E5E5"> things I'm gonna talk</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> are</font>

357
00:13:32,560 --> 00:13:38,030
primarily social<font color="#E5E5E5"> engineering avenues</font><font color="#CCCCCC"> so</font>

358
00:13:35,870 --> 00:13:40,130
this one is basically creating a Google

359
00:13:38,030 --> 00:13:41,930
Doc with a title something<font color="#E5E5E5"> like you know</font>

360
00:13:40,130 --> 00:13:44,030
critical<font color="#E5E5E5"> update pending so you're you're</font>

361
00:13:41,930 --> 00:13:46,250
creating a gmail<font color="#CCCCCC"> doc right</font><font color="#E5E5E5"> you add</font>

362
00:13:44,030 --> 00:13:48,280
<font color="#E5E5E5">content that looks like you know Terms</font>

363
00:13:46,250 --> 00:13:50,960
of Service update<font color="#CCCCCC"> or something or</font>

364
00:13:48,280 --> 00:13:52,760
whatever<font color="#E5E5E5"> and then you</font><font color="#CCCCCC"> know you know you</font>

365
00:13:50,960 --> 00:13:54,650
can<font color="#E5E5E5"> create a comment in the</font><font color="#CCCCCC"> Google Doc</font>

366
00:13:52,760 --> 00:13:57,380
like you can tag<font color="#E5E5E5"> you can tag people</font><font color="#CCCCCC"> in</font>

367
00:13:54,650 --> 00:13:59,990
<font color="#E5E5E5">that comment</font><font color="#CCCCCC"> so if you</font><font color="#E5E5E5"> tag somebody in a</font>

368
00:13:57,380 --> 00:14:03,470
Google Doc Docs<font color="#E5E5E5"> or an email address from</font>

369
00:13:59,990 --> 00:14:05,780
<font color="#CCCCCC">a</font><font color="#E5E5E5"> Docs Google com will send them an</font>

370
00:14:03,470 --> 00:14:07,130
email<font color="#E5E5E5"> so like this is the comment box</font>

371
00:14:05,780 --> 00:14:08,900
right so<font color="#E5E5E5"> like you have your</font><font color="#CCCCCC"> typical</font>

372
00:14:07,130 --> 00:14:11,240
comment<font color="#CCCCCC"> box on</font><font color="#E5E5E5"> the right there and</font><font color="#CCCCCC"> if I</font>

373
00:14:08,900 --> 00:14:14,420
assign that task or<font color="#E5E5E5"> that comment to</font>

374
00:14:11,240 --> 00:14:15,710
somebody Google will<font color="#CCCCCC"> then email</font><font color="#E5E5E5"> them so</font>

375
00:14:14,420 --> 00:14:18,260
this<font color="#CCCCCC"> is a fun situation where you can</font>

376
00:14:15,710 --> 00:14:19,790
<font color="#CCCCCC">have an actual fishing URL sent from</font>

377
00:14:18,260 --> 00:14:20,810
Google so they would get any mail<font color="#E5E5E5"> it</font>

378
00:14:19,790 --> 00:14:21,949
looks something like this<font color="#CCCCCC"> it looks</font><font color="#E5E5E5"> like</font>

379
00:14:20,810 --> 00:14:23,630
it's coming<font color="#CCCCCC"> from Google security that</font>

380
00:14:21,950 --> 00:14:24,860
says<font color="#CCCCCC"> you're can't be deactivated unless</font>

381
00:14:23,630 --> 00:14:26,840
you review the updated Terms of Service

382
00:14:24,860 --> 00:14:30,640
located<font color="#E5E5E5"> here and you could use like</font><font color="#CCCCCC"> a</font>

383
00:14:26,840 --> 00:14:32,960
Google shortened URL to send them<font color="#E5E5E5"> to</font>

384
00:14:30,640 --> 00:14:35,360
<font color="#E5E5E5">calendar event injection so this is a</font>

385
00:14:32,960 --> 00:14:36,860
fun one<font color="#CCCCCC"> so this one we actually reported</font>

386
00:14:35,360 --> 00:14:42,640
to Google and they said it's just<font color="#CCCCCC"> a</font>

387
00:14:36,860 --> 00:14:46,910
feature so they're not<font color="#E5E5E5"> gonna fix it so</font>

388
00:14:42,640 --> 00:14:49,370
whenever you go<font color="#E5E5E5"> to add a new event</font><font color="#CCCCCC"> and</font>

389
00:14:46,910 --> 00:14:50,959
in Google<font color="#CCCCCC"> Calendar</font><font color="#E5E5E5"> it gives you the</font>

390
00:14:49,370 --> 00:14:53,480
option of sending them an invite right

391
00:14:50,960 --> 00:14:55,820
<font color="#E5E5E5">and if you don't send them an invite</font><font color="#CCCCCC"> it</font>

392
00:14:53,480 --> 00:14:58,160
then it will still add it to their

393
00:14:55,820 --> 00:15:00,350
<font color="#CCCCCC">calendar but not send them an email</font><font color="#E5E5E5"> so</font>

394
00:14:58,160 --> 00:15:02,319
you can<font color="#E5E5E5"> add things to any Google users</font>

395
00:15:00,350 --> 00:15:04,430
calendar without<font color="#CCCCCC"> sending them an email</font>

396
00:15:02,320 --> 00:15:05,780
so first off<font color="#E5E5E5"> that's kind</font><font color="#CCCCCC"> of interesting</font>

397
00:15:04,430 --> 00:15:07,430
right<font color="#E5E5E5"> because</font><font color="#CCCCCC"> then I can I can make</font>

398
00:15:05,780 --> 00:15:08,630
something<font color="#CCCCCC"> alert in your face because</font>

399
00:15:07,430 --> 00:15:09,920
it's gonna pop<font color="#E5E5E5"> up on</font><font color="#CCCCCC"> your</font><font color="#E5E5E5"> phone and say</font>

400
00:15:08,630 --> 00:15:12,980
hey you<font color="#CCCCCC"> have a meeting in ten minutes</font>

401
00:15:09,920 --> 00:15:14,839
check this<font color="#CCCCCC"> agenda before the</font><font color="#E5E5E5"> meeting</font><font color="#CCCCCC"> and</font>

402
00:15:12,980 --> 00:15:17,390
<font color="#E5E5E5">again like make it look like it came</font>

403
00:15:14,840 --> 00:15:19,670
<font color="#E5E5E5">from somebody they know include a link</font>

404
00:15:17,390 --> 00:15:21,860
to a conference call and you<font color="#E5E5E5"> know you</font>

405
00:15:19,670 --> 00:15:23,930
could even so like<font color="#CCCCCC"> the this gets deep</font>

406
00:15:21,860 --> 00:15:25,490
<font color="#E5E5E5">too because a lot</font><font color="#CCCCCC"> of the GCP customers</font>

407
00:15:23,930 --> 00:15:27,589
we use implement two-factor they use

408
00:15:25,490 --> 00:15:29,090
like<font color="#E5E5E5"> Google</font><font color="#CCCCCC"> two factors so</font><font color="#E5E5E5"> one of</font><font color="#CCCCCC"> our</font>

409
00:15:27,590 --> 00:15:31,480
<font color="#E5E5E5">employees Mike felt</font><font color="#CCCCCC"> Road cred sniper</font>

410
00:15:29,090 --> 00:15:34,240
which is really amazing<font color="#CCCCCC"> at</font>

411
00:15:31,480 --> 00:15:36,339
shirring those two-factor codes<font color="#E5E5E5"> so on</font>

412
00:15:34,240 --> 00:15:38,290
our<font color="#CCCCCC"> phishing page</font><font color="#E5E5E5"> not only</font><font color="#CCCCCC"> are we</font>

413
00:15:36,339 --> 00:15:39,730
<font color="#E5E5E5">capturing credentials but we're also</font>

414
00:15:38,290 --> 00:15:41,620
prompting that<font color="#E5E5E5"> user for that that</font>

415
00:15:39,730 --> 00:15:42,970
two-factor code<font color="#E5E5E5"> getting the two-factor</font>

416
00:15:41,620 --> 00:15:45,160
code on the<font color="#E5E5E5"> back end we're logging in</font>

417
00:15:42,970 --> 00:15:47,050
redirecting them to another<font color="#CCCCCC"> Google page</font>

418
00:15:45,160 --> 00:15:51,850
and now we're logged in by passing

419
00:15:47,050 --> 00:15:54,430
two-factor on the<font color="#E5E5E5"> back side</font><font color="#CCCCCC"> so with the</font>

420
00:15:51,850 --> 00:15:55,899
event<font color="#CCCCCC"> injection thing the thing</font><font color="#E5E5E5"> that's</font>

421
00:15:54,430 --> 00:15:57,609
kind<font color="#CCCCCC"> of fun too is like</font><font color="#E5E5E5"> you can make it</font>

422
00:15:55,899 --> 00:16:00,480
look<font color="#E5E5E5"> like</font><font color="#CCCCCC"> they accepted the invite so</font>

423
00:15:57,610 --> 00:16:03,160
Google's API allows you to<font color="#CCCCCC"> actually</font>

424
00:16:00,480 --> 00:16:04,660
create an event<font color="#E5E5E5"> in their calendar</font><font color="#CCCCCC"> that</font>

425
00:16:03,160 --> 00:16:06,670
looks like they actually<font color="#CCCCCC"> accept</font><font color="#E5E5E5"> the</font>

426
00:16:04,660 --> 00:16:08,829
<font color="#E5E5E5">invite that you sent them without them</font>

427
00:16:06,670 --> 00:16:12,310
ever actually<font color="#E5E5E5"> sending you know an email</font>

428
00:16:08,829 --> 00:16:14,260
<font color="#E5E5E5">so another fun fishing opportunity right</font>

429
00:16:12,310 --> 00:16:16,869
you know<font color="#E5E5E5"> you pop up</font><font color="#CCCCCC"> pop</font><font color="#E5E5E5"> up an alert that</font>

430
00:16:14,260 --> 00:16:19,959
<font color="#CCCCCC">says hey</font><font color="#E5E5E5"> you need to read this</font><font color="#CCCCCC"> agenda</font>

431
00:16:16,870 --> 00:16:25,180
<font color="#E5E5E5">before</font><font color="#CCCCCC"> this meeting it sounds</font><font color="#E5E5E5"> like a</font>

432
00:16:19,959 --> 00:16:28,199
feature to me yes<font color="#CCCCCC"> you know traditionally</font>

433
00:16:25,180 --> 00:16:31,709
you<font color="#E5E5E5"> know business email compromise is</font>

434
00:16:28,199 --> 00:16:34,569
doing some<font color="#E5E5E5"> of those same</font><font color="#CCCCCC"> things but</font>

435
00:16:31,709 --> 00:16:36,040
getting<font color="#E5E5E5"> into</font><font color="#CCCCCC"> an</font><font color="#E5E5E5"> email box right or</font>

436
00:16:34,570 --> 00:16:38,800
getting<font color="#E5E5E5"> into someone's email we're</font>

437
00:16:36,040 --> 00:16:41,849
asking<font color="#E5E5E5"> about</font><font color="#CCCCCC"> Oh earlier</font><font color="#E5E5E5"> this is actually</font>

438
00:16:38,800 --> 00:16:45,550
why we<font color="#E5E5E5"> like Oso much is</font><font color="#CCCCCC"> because</font>

439
00:16:41,850 --> 00:16:47,589
typically it you know it we find it not

440
00:16:45,550 --> 00:16:48,819
two-factor enabled<font color="#E5E5E5"> and even if it is</font>

441
00:16:47,589 --> 00:16:50,740
two-factor enabled there are certain

442
00:16:48,819 --> 00:16:55,599
circumstances<font color="#CCCCCC"> a</font><font color="#E5E5E5"> service is on by default</font>

443
00:16:50,740 --> 00:16:58,389
<font color="#CCCCCC">that let us</font><font color="#E5E5E5"> just bypass that so you know</font>

444
00:16:55,600 --> 00:17:00,930
a lot<font color="#CCCCCC"> of times email services or</font>

445
00:16:58,389 --> 00:17:02,680
internal exchange something<font color="#E5E5E5"> like that</font>

446
00:17:00,930 --> 00:17:04,510
<font color="#E5E5E5">sometimes pen tests are sort of</font>

447
00:17:02,680 --> 00:17:06,668
overlooked that<font color="#E5E5E5"> I mean it's the business</font>

448
00:17:04,510 --> 00:17:08,230
email<font color="#E5E5E5"> right</font><font color="#CCCCCC"> thread actors and red</font>

449
00:17:06,669 --> 00:17:11,350
teamers do not there's so much

450
00:17:08,230 --> 00:17:13,480
<font color="#E5E5E5">information and</font><font color="#CCCCCC"> email that</font><font color="#E5E5E5"> you know it's</font>

451
00:17:11,349 --> 00:17:16,599
an information goldmine we found like

452
00:17:13,480 --> 00:17:18,760
<font color="#CCCCCC">Boas saying earlier basically</font><font color="#E5E5E5"> usernames</font>

453
00:17:16,599 --> 00:17:22,178
and passwords<font color="#E5E5E5"> and the second fact or</font>

454
00:17:18,760 --> 00:17:24,609
certificates to VPN in as you know a

455
00:17:22,179 --> 00:17:26,650
user which is amazing<font color="#CCCCCC"> to me why that's</font>

456
00:17:24,609 --> 00:17:27,990
an email to begin with but that's a

457
00:17:26,650 --> 00:17:30,910
different<font color="#CCCCCC"> story</font>

458
00:17:27,990 --> 00:17:32,320
yeah so when we're doing any any sort<font color="#CCCCCC"> of</font>

459
00:17:30,910 --> 00:17:34,169
external assessment<font color="#E5E5E5"> like we're doing a</font>

460
00:17:32,320 --> 00:17:36,428
<font color="#CCCCCC">Red Team assessment</font><font color="#E5E5E5"> we are targeting</font>

461
00:17:34,169 --> 00:17:38,590
<font color="#CCCCCC">anything that has to do with like ntlm</font>

462
00:17:36,429 --> 00:17:40,600
authentication really hard<font color="#E5E5E5"> because we</font>

463
00:17:38,590 --> 00:17:43,510
love<font color="#E5E5E5"> to get any sort of</font><font color="#CCCCCC"> credential that</font>

464
00:17:40,600 --> 00:17:45,399
might allow us to you know<font color="#E5E5E5"> actually log</font>

465
00:17:43,510 --> 00:17:47,800
<font color="#E5E5E5">into</font><font color="#CCCCCC"> 200 and read email</font>

466
00:17:45,400 --> 00:17:49,720
and the great thing about<font color="#E5E5E5"> OA is it does</font>

467
00:17:47,800 --> 00:17:51,159
<font color="#E5E5E5">have a number of services so when</font><font color="#CCCCCC"> you're</font>

468
00:17:49,720 --> 00:17:53,110
<font color="#E5E5E5">whenever you set up an</font><font color="#CCCCCC"> exchange server</font>

469
00:17:51,160 --> 00:17:54,490
with Outlook Web Access<font color="#E5E5E5"> it not only has</font>

470
00:17:53,110 --> 00:17:56,080
that that web portal that<font color="#CCCCCC"> you're</font>

471
00:17:54,490 --> 00:17:57,340
familiar with but<font color="#E5E5E5"> it also has this thing</font>

472
00:17:56,080 --> 00:17:59,740
called<font color="#E5E5E5"> exchange</font><font color="#CCCCCC"> Web Services which is</font>

473
00:17:57,340 --> 00:18:01,209
<font color="#E5E5E5">right alongside it and one of</font><font color="#CCCCCC"> the things</font>

474
00:17:59,740 --> 00:18:03,340
that we found is that some two-factor

475
00:18:01,210 --> 00:18:05,050
<font color="#E5E5E5">software's only protect that that normal</font>

476
00:18:03,340 --> 00:18:06,399
web<font color="#E5E5E5"> portal right alongside</font><font color="#CCCCCC"> or</font><font color="#E5E5E5"> does</font>

477
00:18:05,050 --> 00:18:08,649
exchange<font color="#CCCCCC"> web services</font><font color="#E5E5E5"> that gives you the</font>

478
00:18:06,400 --> 00:18:10,600
same access<font color="#CCCCCC"> yeah when</font><font color="#E5E5E5"> we were reported</font>

479
00:18:08,650 --> 00:18:12,370
that to Microsoft<font color="#CCCCCC"> they said that that</font>

480
00:18:10,600 --> 00:18:14,679
<font color="#E5E5E5">was a feature and they're not gonna fix</font>

481
00:18:12,370 --> 00:18:18,010
it yeah

482
00:18:14,680 --> 00:18:20,080
so<font color="#E5E5E5"> that out of that</font><font color="#CCCCCC"> whole thing kind of</font>

483
00:18:18,010 --> 00:18:22,810
spawned a tool called<font color="#CCCCCC"> mail sniper that</font>

484
00:18:20,080 --> 00:18:24,580
<font color="#CCCCCC">we wrote</font><font color="#E5E5E5"> and that's</font><font color="#CCCCCC"> who'll does a number</font>

485
00:18:22,810 --> 00:18:27,490
<font color="#CCCCCC">of different</font><font color="#E5E5E5"> things first off it does</font>

486
00:18:24,580 --> 00:18:28,960
<font color="#CCCCCC">domain</font><font color="#E5E5E5"> username enumeration so we can we</font>

487
00:18:27,490 --> 00:18:30,670
can<font color="#E5E5E5"> tell if a</font><font color="#CCCCCC"> username or a domain is</font>

488
00:18:28,960 --> 00:18:32,410
valid for an<font color="#E5E5E5"> organization like an</font>

489
00:18:30,670 --> 00:18:34,570
internal domain<font color="#E5E5E5"> and an internal</font><font color="#CCCCCC"> username</font>

490
00:18:32,410 --> 00:18:37,630
based off of timing responses from the

491
00:18:34,570 --> 00:18:39,220
web application from OA so you know if

492
00:18:37,630 --> 00:18:40,870
you submit<font color="#E5E5E5"> a</font><font color="#CCCCCC"> user name that's invalid</font><font color="#E5E5E5"> it</font>

493
00:18:39,220 --> 00:18:42,250
might take 300 milliseconds<font color="#E5E5E5"> a valid one</font>

494
00:18:40,870 --> 00:18:44,439
might take<font color="#E5E5E5"> a thousand milliseconds to</font>

495
00:18:42,250 --> 00:18:46,780
come back so we<font color="#CCCCCC"> through timing attacks</font>

496
00:18:44,440 --> 00:18:48,970
were able to enumerate those<font color="#E5E5E5"> usernames</font>

497
00:18:46,780 --> 00:18:50,110
<font color="#E5E5E5">another thing is this tool also does</font>

498
00:18:48,970 --> 00:18:51,760
password<font color="#CCCCCC"> spring so we're talking about</font>

499
00:18:50,110 --> 00:18:53,679
password<font color="#E5E5E5"> spring earlier taking like an</font>

500
00:18:51,760 --> 00:18:55,690
entire list<font color="#CCCCCC"> so what</font><font color="#E5E5E5"> we'll typically do</font>

501
00:18:53,680 --> 00:18:58,660
is do some<font color="#CCCCCC"> recon</font><font color="#E5E5E5"> find a bunch of</font>

502
00:18:55,690 --> 00:19:01,150
employee names from LinkedIn<font color="#E5E5E5"> create a</font>

503
00:18:58,660 --> 00:19:04,630
list and then try one attempt for each

504
00:19:01,150 --> 00:19:07,000
of those<font color="#E5E5E5"> and</font><font color="#CCCCCC"> then once we have a valid</font>

505
00:19:04,630 --> 00:19:09,580
cred<font color="#E5E5E5"> with with</font><font color="#CCCCCC"> OA</font><font color="#E5E5E5"> you're able to get the</font>

506
00:19:07,000 --> 00:19:10,780
<font color="#CCCCCC">global address lists</font><font color="#E5E5E5"> so now with a</font>

507
00:19:09,580 --> 00:19:12,040
<font color="#E5E5E5">single cred we're able to go and</font>

508
00:19:10,780 --> 00:19:13,840
<font color="#E5E5E5">download the entire global address list</font>

509
00:19:12,040 --> 00:19:17,250
which contains<font color="#CCCCCC"> all</font><font color="#E5E5E5"> the emails for the</font>

510
00:19:13,840 --> 00:19:19,899
entire domain<font color="#E5E5E5"> then you know perform</font><font color="#CCCCCC"> more</font>

511
00:19:17,250 --> 00:19:21,670
password<font color="#E5E5E5"> spring with that list</font><font color="#CCCCCC"> and then</font>

512
00:19:19,900 --> 00:19:22,750
<font color="#E5E5E5">one thing that I thought</font><font color="#CCCCCC"> was pretty</font>

513
00:19:21,670 --> 00:19:24,610
<font color="#CCCCCC">interesting is this open inbox</font>

514
00:19:22,750 --> 00:19:26,170
delegation thing so there's there's a

515
00:19:24,610 --> 00:19:28,629
module<font color="#CCCCCC"> called open inbox finder</font><font color="#E5E5E5"> and mail</font>

516
00:19:26,170 --> 00:19:30,520
sniper<font color="#CCCCCC"> that allows you to find</font><font color="#E5E5E5"> users who</font>

517
00:19:28,630 --> 00:19:33,070
have delegated<font color="#E5E5E5"> access to their inbox</font><font color="#CCCCCC"> and</font>

518
00:19:30,520 --> 00:19:35,470
it's amazing<font color="#CCCCCC"> how many people</font><font color="#E5E5E5"> actually</font>

519
00:19:33,070 --> 00:19:36,970
just<font color="#CCCCCC"> delegate access</font><font color="#E5E5E5"> and the reason is</font>

520
00:19:35,470 --> 00:19:38,440
<font color="#E5E5E5">because it's a</font><font color="#CCCCCC"> very</font><font color="#E5E5E5"> easy thing</font><font color="#CCCCCC"> to do</font><font color="#E5E5E5"> all</font>

521
00:19:36,970 --> 00:19:40,120
you have<font color="#CCCCCC"> to do is open up Outlook right</font>

522
00:19:38,440 --> 00:19:41,350
<font color="#CCCCCC">click your inbox and click properties</font>

523
00:19:40,120 --> 00:19:47,550
and<font color="#E5E5E5"> there's a setting right there</font><font color="#CCCCCC"> that</font>

524
00:19:41,350 --> 00:19:50,230
allows you<font color="#E5E5E5"> to - it's called reviewer</font>

525
00:19:47,550 --> 00:19:53,850
reviewer access to your<font color="#CCCCCC"> email</font><font color="#E5E5E5"> if you</font>

526
00:19:50,230 --> 00:19:57,580
provide what they consider I<font color="#E5E5E5"> think it's</font>

527
00:19:53,850 --> 00:19:58,929
<font color="#E5E5E5">anonymous access to have reviewer</font>

528
00:19:57,580 --> 00:20:00,669
privileges then that

529
00:19:58,930 --> 00:20:02,200
essentially<font color="#E5E5E5"> grants domain users in your</font>

530
00:20:00,670 --> 00:20:04,420
environment<font color="#CCCCCC"> access</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> reader</font><font color="#E5E5E5"> email and</font>

531
00:20:02,200 --> 00:20:06,220
we found<font color="#E5E5E5"> act like were where the entire</font>

532
00:20:04,420 --> 00:20:10,210
domain<font color="#E5E5E5"> has access to the CEOs email at</font>

533
00:20:06,220 --> 00:20:11,770
the<font color="#E5E5E5"> company</font><font color="#CCCCCC"> and then the other thing</font>

534
00:20:10,210 --> 00:20:13,630
that the tool does and this<font color="#E5E5E5"> is actually</font>

535
00:20:11,770 --> 00:20:15,520
the original<font color="#E5E5E5"> thing that we wrote the</font>

536
00:20:13,630 --> 00:20:17,140
tool for<font color="#E5E5E5"> was searching for sensitive</font>

537
00:20:15,520 --> 00:20:20,020
data<font color="#CCCCCC"> an email so like he was</font><font color="#E5E5E5"> saying like</font>

538
00:20:17,140 --> 00:20:22,540
with with email<font color="#E5E5E5"> you know people send all</font>

539
00:20:20,020 --> 00:20:24,940
kinds<font color="#CCCCCC"> of awesome stuff</font><font color="#E5E5E5"> an email you know</font>

540
00:20:22,540 --> 00:20:26,320
we will search it for passwords for any

541
00:20:24,940 --> 00:20:28,290
any sensitive<font color="#CCCCCC"> data that we might be</font>

542
00:20:26,320 --> 00:20:30,879
looking<font color="#CCCCCC"> for for that</font><font color="#E5E5E5"> for that</font><font color="#CCCCCC"> assessment</font>

543
00:20:28,290 --> 00:20:32,530
<font color="#CCCCCC">the next slide actually includes a kind</font>

544
00:20:30,880 --> 00:20:33,880
<font color="#E5E5E5">of a flow</font><font color="#CCCCCC"> of exactly what</font><font color="#E5E5E5"> are just</font>

545
00:20:32,530 --> 00:20:36,760
talking<font color="#E5E5E5"> about so starting with</font><font color="#CCCCCC"> nothing</font>

546
00:20:33,880 --> 00:20:38,710
<font color="#E5E5E5">moving on to recon finding the</font><font color="#CCCCCC"> actual</font>

547
00:20:36,760 --> 00:20:41,920
you know mail server<font color="#E5E5E5"> and this a lot of</font>

548
00:20:38,710 --> 00:20:44,380
this translates<font color="#E5E5E5"> to</font><font color="#CCCCCC"> or</font><font color="#E5E5E5"> 365 to by the way</font>

549
00:20:41,920 --> 00:20:46,210
do an internal domain enumeration<font color="#CCCCCC"> using</font>

550
00:20:44,380 --> 00:20:47,890
<font color="#CCCCCC">name</font><font color="#E5E5E5"> convention discovery username a</font>

551
00:20:46,210 --> 00:20:49,270
numeration password spraying get the

552
00:20:47,890 --> 00:20:51,850
<font color="#E5E5E5">global</font><font color="#CCCCCC"> address list</font><font color="#E5E5E5"> more password</font>

553
00:20:49,270 --> 00:20:53,770
spraying and then you know like I

554
00:20:51,850 --> 00:20:55,990
mentioned<font color="#CCCCCC"> before if they're using two</font><font color="#E5E5E5"> FA</font>

555
00:20:53,770 --> 00:20:58,540
on OA<font color="#E5E5E5"> then we might be</font><font color="#CCCCCC"> able to</font><font color="#E5E5E5"> bypass</font>

556
00:20:55,990 --> 00:21:01,600
<font color="#CCCCCC">two FA</font><font color="#E5E5E5"> by connecting to EWTN</font><font color="#CCCCCC"> Web</font>

557
00:20:58,540 --> 00:21:03,450
<font color="#CCCCCC">Services</font><font color="#E5E5E5"> and then look for for various</font>

558
00:21:01,600 --> 00:21:05,800
things<font color="#CCCCCC"> like remote access through VPNs</font>

559
00:21:03,450 --> 00:21:07,660
<font color="#CCCCCC">you can do malicious outlook rules and</font>

560
00:21:05,800 --> 00:21:09,070
employee to employee phishing that's one

561
00:21:07,660 --> 00:21:10,930
of the key things to is once you have

562
00:21:09,070 --> 00:21:13,990
access from<font color="#E5E5E5"> a single employee phishing</font>

563
00:21:10,930 --> 00:21:15,220
to other employees<font color="#CCCCCC"> as somebody they know</font>

564
00:21:13,990 --> 00:21:16,330
or you<font color="#E5E5E5"> know jump into like a</font>

565
00:21:15,220 --> 00:21:20,550
<font color="#E5E5E5">conversation they already have started</font>

566
00:21:16,330 --> 00:21:20,550
<font color="#E5E5E5">you have a lot higher chances of success</font>

567
00:21:20,930 --> 00:21:25,320
so this is actually one of my favorite

568
00:21:23,640 --> 00:21:27,990
things<font color="#E5E5E5"> to</font><font color="#CCCCCC"> use</font><font color="#E5E5E5"> and I</font><font color="#CCCCCC"> use it</font><font color="#E5E5E5"> actually on</font>

569
00:21:25,320 --> 00:21:29,909
pen<font color="#CCCCCC"> tests and red teams now so so how</font>

570
00:21:27,990 --> 00:21:32,250
many<font color="#CCCCCC"> people use a proxy</font><font color="#E5E5E5"> server or</font>

571
00:21:29,910 --> 00:21:34,350
<font color="#E5E5E5">something like a web sense or blue code</font>

572
00:21:32,250 --> 00:21:36,060
or something<font color="#E5E5E5"> in</font><font color="#CCCCCC"> your environment so it's</font>

573
00:21:34,350 --> 00:21:39,570
a it's a common thing<font color="#E5E5E5"> do you block</font>

574
00:21:36,060 --> 00:21:41,129
categories of<font color="#CCCCCC"> stuff</font><font color="#E5E5E5"> like you can't go to</font>

575
00:21:39,570 --> 00:21:44,129
gambling<font color="#CCCCCC"> and</font><font color="#E5E5E5"> websites or something like</font>

576
00:21:41,130 --> 00:21:45,420
<font color="#E5E5E5">that so that that's something that we</font>

577
00:21:44,130 --> 00:21:48,900
<font color="#E5E5E5">find that's really common and we also</font>

578
00:21:45,420 --> 00:21:51,780
find that you know people organizations

579
00:21:48,900 --> 00:21:54,060
<font color="#E5E5E5">will block</font><font color="#CCCCCC"> like say raw IP or something</font>

580
00:21:51,780 --> 00:21:55,500
like<font color="#CCCCCC"> that</font><font color="#E5E5E5"> so sometimes</font><font color="#CCCCCC"> we run into some</font>

581
00:21:54,060 --> 00:21:58,500
outbound filtering<font color="#E5E5E5"> based on</font>

582
00:21:55,500 --> 00:22:01,620
categorization of domains<font color="#E5E5E5"> and it's</font>

583
00:21:58,500 --> 00:22:04,860
actually not difficult to bypass<font color="#CCCCCC"> so what</font>

584
00:22:01,620 --> 00:22:06,479
you need<font color="#E5E5E5"> is</font><font color="#CCCCCC"> a domain</font><font color="#E5E5E5"> right to call out</font>

585
00:22:04,860 --> 00:22:08,189
<font color="#CCCCCC">to for your</font><font color="#E5E5E5"> payload for command and</font>

586
00:22:06,480 --> 00:22:10,170
control well you can go to expired

587
00:22:08,190 --> 00:22:13,560
domains dotnet<font color="#E5E5E5"> and find something that's</font>

588
00:22:10,170 --> 00:22:16,290
recently expired<font color="#CCCCCC"> and that's also</font>

589
00:22:13,560 --> 00:22:18,060
categorized by you know<font color="#E5E5E5"> like</font><font color="#CCCCCC"> IT or</font>

590
00:22:16,290 --> 00:22:22,649
<font color="#CCCCCC">healthcare</font><font color="#E5E5E5"> or something of that nature</font>

591
00:22:18,060 --> 00:22:25,889
<font color="#E5E5E5">and then on top of that it's actually</font>

592
00:22:22,650 --> 00:22:28,680
trivial to create a certificate<font color="#E5E5E5"> that's</font>

593
00:22:25,890 --> 00:22:30,600
trusted by default<font color="#E5E5E5"> through something</font>

594
00:22:28,680 --> 00:22:32,880
called let's encrypt<font color="#E5E5E5"> right so I can</font>

595
00:22:30,600 --> 00:22:36,030
<font color="#CCCCCC">actually</font><font color="#E5E5E5"> create</font><font color="#CCCCCC"> legitimacy you know</font>

596
00:22:32,880 --> 00:22:38,460
<font color="#CCCCCC">categorize traffic for my payload out of</font>

597
00:22:36,030 --> 00:22:40,980
an environment<font color="#CCCCCC"> with a legitimate cert</font>

598
00:22:38,460 --> 00:22:45,260
that's trusted by the Microsoft Store

599
00:22:40,980 --> 00:22:48,300
<font color="#CCCCCC">and you know expired</font><font color="#E5E5E5"> that means net is</font>

600
00:22:45,260 --> 00:22:53,430
basically<font color="#E5E5E5"> a free service that and go</font>

601
00:22:48,300 --> 00:22:56,340
find<font color="#E5E5E5"> these domains so you know one of</font>

602
00:22:53,430 --> 00:22:58,200
<font color="#E5E5E5">the I think most fun it's almost like a</font>

603
00:22:56,340 --> 00:23:01,409
hobby for<font color="#CCCCCC"> me</font><font color="#E5E5E5"> it's when</font><font color="#CCCCCC"> I when I find a</font>

604
00:22:58,200 --> 00:23:03,360
hash<font color="#E5E5E5"> I just want to crack it</font><font color="#CCCCCC"> it's it's</font>

605
00:23:01,410 --> 00:23:04,850
<font color="#E5E5E5">like it's it's in my nature right if I</font>

606
00:23:03,360 --> 00:23:07,439
see something looks<font color="#E5E5E5"> like hash I just</font>

607
00:23:04,850 --> 00:23:09,179
it's something<font color="#E5E5E5"> it just wants to</font><font color="#CCCCCC"> be</font>

608
00:23:07,440 --> 00:23:11,430
cracked<font color="#E5E5E5"> right so how do you go about</font>

609
00:23:09,180 --> 00:23:12,870
gathering hashes in<font color="#E5E5E5"> an environment</font><font color="#CCCCCC"> there</font>

610
00:23:11,430 --> 00:23:14,400
<font color="#CCCCCC">are actually a number of ways</font><font color="#E5E5E5"> because</font>

611
00:23:12,870 --> 00:23:18,689
you know you know in a Microsoft

612
00:23:14,400 --> 00:23:22,560
environment<font color="#E5E5E5"> in a Microsoft environment</font>

613
00:23:18,690 --> 00:23:26,010
<font color="#E5E5E5">you can get just by</font><font color="#CCCCCC"> the way</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> SMB</font>

614
00:23:22,560 --> 00:23:29,730
works you can get hashes from just

615
00:23:26,010 --> 00:23:31,590
asking a machine questions<font color="#E5E5E5"> so one</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> my</font>

616
00:23:29,730 --> 00:23:33,390
<font color="#E5E5E5">favorite tax when I get a foothold in</font>

617
00:23:31,590 --> 00:23:34,050
<font color="#E5E5E5">network is something called Kerberos</font>

618
00:23:33,390 --> 00:23:36,690
<font color="#CCCCCC">ting</font><font color="#E5E5E5"> the</font>

619
00:23:34,050 --> 00:23:40,169
was invented by a friend<font color="#E5E5E5"> of mine named</font>

620
00:23:36,690 --> 00:23:42,780
Tenma Dean and it was released<font color="#CCCCCC"> what 2014</font>

621
00:23:40,170 --> 00:23:45,630
<font color="#E5E5E5">or something at hackfest</font><font color="#CCCCCC"> sans hackfest</font>

622
00:23:42,780 --> 00:23:47,310
<font color="#CCCCCC">and so the Microsoft Kerberos</font><font color="#E5E5E5"> in from</font>

623
00:23:45,630 --> 00:23:50,640
implementation we could probably<font color="#E5E5E5"> talk</font>

624
00:23:47,310 --> 00:23:51,899
about<font color="#E5E5E5"> that</font><font color="#CCCCCC"> for the rest of the time</font><font color="#E5E5E5"> we</font>

625
00:23:50,640 --> 00:23:54,630
have because it's actually<font color="#CCCCCC"> really</font>

626
00:23:51,900 --> 00:23:58,320
<font color="#CCCCCC">complicated the gist of</font><font color="#E5E5E5"> it is is that</font>

627
00:23:54,630 --> 00:23:59,820
<font color="#E5E5E5">any domain user can make a request for</font>

628
00:23:58,320 --> 00:24:04,320
our<font color="#CCCCCC"> can</font><font color="#E5E5E5"> query what's called a service</font>

629
00:23:59,820 --> 00:24:05,760
<font color="#CCCCCC">principal</font><font color="#E5E5E5"> name on a network and the part</font>

630
00:24:04,320 --> 00:24:10,399
of<font color="#E5E5E5"> the Kerberos ticket they get back the</font>

631
00:24:05,760 --> 00:24:13,740
TGT ticket has the<font color="#CCCCCC"> an encrypted</font>

632
00:24:10,400 --> 00:24:17,670
representation<font color="#E5E5E5"> the ticket has</font><font color="#CCCCCC"> a part</font>

633
00:24:13,740 --> 00:24:20,370
that has an<font color="#E5E5E5"> encrypted representation of</font>

634
00:24:17,670 --> 00:24:22,530
the ntlm hash of the service so like a

635
00:24:20,370 --> 00:24:24,629
<font color="#E5E5E5">sequel service is really common where</font>

636
00:24:22,530 --> 00:24:25,200
that Kerberos service where that service

637
00:24:24,630 --> 00:24:27,450
<font color="#E5E5E5">lives</font>

638
00:24:25,200 --> 00:24:30,720
<font color="#E5E5E5">so essentially what it boils</font><font color="#CCCCCC"> down to is</font>

639
00:24:27,450 --> 00:24:33,120
<font color="#CCCCCC">that any user in the environment</font><font color="#E5E5E5"> can get</font>

640
00:24:30,720 --> 00:24:34,950
a hash<font color="#E5E5E5"> that</font><font color="#CCCCCC"> can be cracked</font><font color="#E5E5E5"> and taken</font>

641
00:24:33,120 --> 00:24:36,989
offline and cracked<font color="#E5E5E5"> and so however</font><font color="#CCCCCC"> long</font>

642
00:24:34,950 --> 00:24:38,190
they have<font color="#CCCCCC"> to do that so</font><font color="#E5E5E5"> let's say you</font>

643
00:24:36,990 --> 00:24:40,020
have a sequel server that's<font color="#CCCCCC"> running in</font>

644
00:24:38,190 --> 00:24:42,060
<font color="#E5E5E5">your</font><font color="#CCCCCC"> environment</font><font color="#E5E5E5"> any valid domain</font>

645
00:24:40,020 --> 00:24:45,330
account can go get a ticket through

646
00:24:42,060 --> 00:24:48,270
Kerberos<font color="#E5E5E5"> and that ticket that comes back</font>

647
00:24:45,330 --> 00:24:51,449
can<font color="#CCCCCC"> be taken offline</font><font color="#E5E5E5"> and attempted to</font>

648
00:24:48,270 --> 00:24:53,639
<font color="#E5E5E5">crack I have gotten</font><font color="#CCCCCC"> straight-out domain</font>

649
00:24:51,450 --> 00:24:56,720
administrator<font color="#CCCCCC"> out of the gate in five</font>

650
00:24:53,640 --> 00:24:58,700
minutes into<font color="#E5E5E5"> a test with this attack and</font>

651
00:24:56,720 --> 00:25:00,870
because you know the sequel server

652
00:24:58,700 --> 00:25:04,560
service account<font color="#E5E5E5"> absolutely had to be</font>

653
00:25:00,870 --> 00:25:06,689
domain admin for some reason right and

654
00:25:04,560 --> 00:25:09,060
even<font color="#E5E5E5"> if it's just the service where the</font>

655
00:25:06,690 --> 00:25:11,700
server<font color="#E5E5E5"> is</font><font color="#CCCCCC"> the sequel server the service</font>

656
00:25:09,060 --> 00:25:13,080
<font color="#CCCCCC">counts typically an administrator so</font><font color="#E5E5E5"> at</font>

657
00:25:11,700 --> 00:25:15,300
the<font color="#CCCCCC"> very</font><font color="#E5E5E5"> least I've become admin on the</font>

658
00:25:13,080 --> 00:25:17,730
server<font color="#CCCCCC"> right so I remember</font><font color="#E5E5E5"> one time I</font>

659
00:25:15,300 --> 00:25:19,919
did this attack<font color="#E5E5E5"> and it was a client we</font>

660
00:25:17,730 --> 00:25:21,210
had done it<font color="#CCCCCC"> at least</font><font color="#E5E5E5"> the third or fourth</font>

661
00:25:19,920 --> 00:25:24,750
<font color="#E5E5E5">test we had done and they had been</font>

662
00:25:21,210 --> 00:25:26,400
<font color="#E5E5E5">fixing everything and I performed this</font>

663
00:25:24,750 --> 00:25:29,490
attack and there was an old sequel

664
00:25:26,400 --> 00:25:33,180
server in their environment and it had a

665
00:25:29,490 --> 00:25:35,480
password<font color="#E5E5E5"> of corn with a</font><font color="#CCCCCC"> capital</font><font color="#E5E5E5"> K yes</font>

666
00:25:33,180 --> 00:25:37,710
like the band not backwards but you<font color="#CCCCCC"> know</font>

667
00:25:35,480 --> 00:25:38,940
<font color="#E5E5E5">so a lot</font><font color="#CCCCCC"> of times you know</font>

668
00:25:37,710 --> 00:25:40,650
administrators look I used to be a

669
00:25:38,940 --> 00:25:44,130
systems<font color="#CCCCCC"> administrator in a previous life</font>

670
00:25:40,650 --> 00:25:45,420
I get if it ain't broke don't fix it but

671
00:25:44,130 --> 00:25:46,590
a lot<font color="#CCCCCC"> of</font><font color="#E5E5E5"> times organizations just</font>

672
00:25:45,420 --> 00:25:48,600
<font color="#E5E5E5">overlook</font>

673
00:25:46,590 --> 00:25:50,820
making service accounts complicated or

674
00:25:48,600 --> 00:25:52,168
changing service account passwords<font color="#CCCCCC"> I've</font>

675
00:25:50,820 --> 00:25:55,230
seen<font color="#E5E5E5"> service accounts that have had</font>

676
00:25:52,169 --> 00:25:58,110
valid passwords for like<font color="#CCCCCC"> ten year no</font>

677
00:25:55,230 --> 00:26:00,149
password<font color="#E5E5E5"> change for like</font><font color="#CCCCCC"> ten years and I</font>

678
00:25:58,110 --> 00:26:02,879
mean<font color="#E5E5E5"> if how long would it take me</font><font color="#CCCCCC"> to</font>

679
00:26:00,149 --> 00:26:05,459
crack a you know a<font color="#CCCCCC"> ten character</font>

680
00:26:02,879 --> 00:26:06,750
password<font color="#E5E5E5"> well if I had</font><font color="#CCCCCC"> ten years what is</font>

681
00:26:05,460 --> 00:26:10,440
it Matt I mean<font color="#E5E5E5"> I'm probably</font><font color="#CCCCCC"> McCracken in</font>

682
00:26:06,750 --> 00:26:13,470
<font color="#E5E5E5">ten years right I mean so Kerberos thing</font>

683
00:26:10,440 --> 00:26:15,600
is fun<font color="#CCCCCC"> another</font><font color="#E5E5E5"> way that I can</font><font color="#CCCCCC"> get a hash</font>

684
00:26:13,470 --> 00:26:17,190
is if your<font color="#E5E5E5"> wireless</font><font color="#CCCCCC"> environment so how</font>

685
00:26:15,600 --> 00:26:18,330
many people have<font color="#CCCCCC"> wireless at work you</font>

686
00:26:17,190 --> 00:26:20,429
don't<font color="#CCCCCC"> have to raise your</font><font color="#E5E5E5"> hands cuz it's</font>

687
00:26:18,330 --> 00:26:22,259
everybody now right if you don't<font color="#CCCCCC"> have</font>

688
00:26:20,429 --> 00:26:23,730
<font color="#E5E5E5">wireless where you work I feel sorry for</font>

689
00:26:22,259 --> 00:26:25,710
you<font color="#CCCCCC"> I'm sorry</font>

690
00:26:23,730 --> 00:26:29,940
I mean<font color="#CCCCCC"> Wireless is just everywhere</font><font color="#E5E5E5"> now</font>

691
00:26:25,710 --> 00:26:31,830
and so the usually what people<font color="#CCCCCC"> do in an</font>

692
00:26:29,940 --> 00:26:36,690
enterprise<font color="#CCCCCC"> environment</font><font color="#E5E5E5"> is they use wpa2</font>

693
00:26:31,830 --> 00:26:39,570
<font color="#E5E5E5">enterprise and so there are there aren't</font>

694
00:26:36,690 --> 00:26:41,580
ways to attack wpa2<font color="#CCCCCC"> Enterprise like wpa2</font>

695
00:26:39,570 --> 00:26:43,500
there's no handshake to grab but what

696
00:26:41,580 --> 00:26:45,629
you can do is you<font color="#E5E5E5"> can set</font><font color="#CCCCCC"> up</font><font color="#E5E5E5"> in what's</font>

697
00:26:43,500 --> 00:26:49,169
called an evil twin<font color="#CCCCCC"> Wireless attack so</font>

698
00:26:45,629 --> 00:26:52,259
basically the<font color="#CCCCCC"> idea is</font><font color="#E5E5E5"> I create a hotspot</font>

699
00:26:49,169 --> 00:26:57,360
a wireless<font color="#E5E5E5"> ap that's named the same as</font>

700
00:26:52,259 --> 00:27:00,269
your corporate Wi-Fi access point<font color="#E5E5E5"> and if</font>

701
00:26:57,360 --> 00:27:03,740
I can get a user to try and authenticate

702
00:27:00,269 --> 00:27:06,179
to<font color="#E5E5E5"> my evil</font><font color="#CCCCCC"> ap based on just the name I</font>

703
00:27:03,740 --> 00:27:08,070
if there aren't<font color="#E5E5E5"> if it's not configured</font>

704
00:27:06,179 --> 00:27:11,700
correctly I can<font color="#E5E5E5"> potentially get</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> net</font>

705
00:27:08,070 --> 00:27:14,939
<font color="#E5E5E5">ntlm</font><font color="#CCCCCC"> v2 hash to crack</font>

706
00:27:11,700 --> 00:27:16,680
and this is another<font color="#CCCCCC"> I know I've said</font>

707
00:27:14,940 --> 00:27:19,620
this<font color="#E5E5E5"> is my favorite</font><font color="#CCCCCC"> thing this is also</font>

708
00:27:16,680 --> 00:27:21,540
my favorite thing maybe<font color="#E5E5E5"> it's all my</font>

709
00:27:19,620 --> 00:27:23,850
favorite<font color="#CCCCCC"> thing</font><font color="#E5E5E5"> so how many people do</font>

710
00:27:21,540 --> 00:27:26,159
outbound<font color="#CCCCCC"> port filtering in their</font>

711
00:27:23,850 --> 00:27:28,560
environment<font color="#CCCCCC"> so you don't yeah</font>

712
00:27:26,160 --> 00:27:30,180
so a lot of organizations still don't

713
00:27:28,560 --> 00:27:31,620
they just<font color="#CCCCCC"> think hey it</font><font color="#E5E5E5"> doesn't you know</font>

714
00:27:30,180 --> 00:27:33,330
everything in the end you know<font color="#CCCCCC"> my</font>

715
00:27:31,620 --> 00:27:36,030
internal network is trusted there's no

716
00:27:33,330 --> 00:27:38,310
reason for<font color="#E5E5E5"> me</font><font color="#CCCCCC"> to filter traffic out</font><font color="#E5E5E5"> back</font>

717
00:27:36,030 --> 00:27:42,300
out of the<font color="#CCCCCC"> network well I love</font><font color="#E5E5E5"> it when I</font>

718
00:27:38,310 --> 00:27:45,870
find<font color="#CCCCCC"> TCP 445</font><font color="#E5E5E5"> open outbound and then in</font>

719
00:27:42,300 --> 00:27:50,610
in an environment because that's anybody

720
00:27:45,870 --> 00:27:55,350
<font color="#CCCCCC">s in SMB</font><font color="#E5E5E5"> so if I find TCP 445 open</font>

721
00:27:50,610 --> 00:27:58,560
outbound<font color="#CCCCCC"> I can set up</font><font color="#E5E5E5"> SMB listener on</font>

722
00:27:55,350 --> 00:28:01,290
the<font color="#CCCCCC"> Internet and I can go</font><font color="#E5E5E5"> find a share</font>

723
00:27:58,560 --> 00:28:02,580
that I have access<font color="#CCCCCC"> to which</font><font color="#E5E5E5"> typically</font>

724
00:28:01,290 --> 00:28:05,220
there's going to be some share and in

725
00:28:02,580 --> 00:28:07,139
some environments<font color="#E5E5E5"> I love shares that</font>

726
00:28:05,220 --> 00:28:09,540
everybody<font color="#CCCCCC"> uses like a temp dumping</font>

727
00:28:07,140 --> 00:28:11,400
ground<font color="#E5E5E5"> like you know that every employee</font>

728
00:28:09,540 --> 00:28:12,750
can get to that share and<font color="#E5E5E5"> just share</font>

729
00:28:11,400 --> 00:28:15,540
stuff<font color="#CCCCCC"> with whoever</font><font color="#E5E5E5"> and whatever</font>

730
00:28:12,750 --> 00:28:18,270
<font color="#CCCCCC">department</font><font color="#E5E5E5"> because I can create a</font>

731
00:28:15,540 --> 00:28:20,639
weaponized shortcut file and so that

732
00:28:18,270 --> 00:28:23,639
<font color="#E5E5E5">shortcut file you put</font><font color="#CCCCCC"> it out in that</font>

733
00:28:20,640 --> 00:28:26,970
share and you create the icon<font color="#E5E5E5"> or the</font>

734
00:28:23,640 --> 00:28:29,610
icon in that link points out<font color="#CCCCCC"> to my</font>

735
00:28:26,970 --> 00:28:33,510
malicious server<font color="#E5E5E5"> and when someone just</font>

736
00:28:29,610 --> 00:28:37,139
views the shortcut in Explorer<font color="#E5E5E5"> it tries</font>

737
00:28:33,510 --> 00:28:39,420
to go grab the icon it tries to it tries

738
00:28:37,140 --> 00:28:43,020
to authenticate to<font color="#CCCCCC"> the server with an</font>

739
00:28:39,420 --> 00:28:44,310
empty<font color="#E5E5E5"> on</font><font color="#CCCCCC"> v2 hash</font><font color="#E5E5E5"> and I can you know I</font>

740
00:28:43,020 --> 00:28:46,560
can<font color="#CCCCCC"> even send this kind of thing in</font>

741
00:28:44,310 --> 00:28:48,389
email right like there's the

742
00:28:46,560 --> 00:28:51,560
possibilities are<font color="#CCCCCC"> endless like I</font><font color="#E5E5E5"> said</font>

743
00:28:48,390 --> 00:28:55,170
this is<font color="#E5E5E5"> another one of my favorite acts</font>

744
00:28:51,560 --> 00:28:56,940
so here's a few various attacks and

745
00:28:55,170 --> 00:28:58,650
things that<font color="#E5E5E5"> we would do when</font><font color="#CCCCCC"> we go on</font>

746
00:28:56,940 --> 00:29:00,780
site a lot of these things<font color="#E5E5E5"> we've talked</font>

747
00:28:58,650 --> 00:29:01,920
<font color="#CCCCCC">about so far been remote attacks or</font>

748
00:29:00,780 --> 00:29:03,899
things that<font color="#E5E5E5"> we could do you know over</font>

749
00:29:01,920 --> 00:29:05,160
the<font color="#E5E5E5"> internet</font><font color="#CCCCCC"> so one thing that</font><font color="#E5E5E5"> we find</font>

750
00:29:03,900 --> 00:29:07,230
<font color="#E5E5E5">pretty often on</font><font color="#CCCCCC"> a lot</font><font color="#E5E5E5"> of the</font><font color="#CCCCCC"> pin tests</font>

751
00:29:05,160 --> 00:29:09,780
we're doing these days<font color="#CCCCCC"> are network</font>

752
00:29:07,230 --> 00:29:11,760
access control ports that<font color="#CCCCCC"> are that are</font>

753
00:29:09,780 --> 00:29:14,850
locked down<font color="#E5E5E5"> on</font><font color="#CCCCCC"> most</font><font color="#E5E5E5"> the networks we test</font>

754
00:29:11,760 --> 00:29:16,379
so what what<font color="#E5E5E5"> nack is is is basically the</font>

755
00:29:14,850 --> 00:29:18,030
<font color="#E5E5E5">concept of preventing unauthorized</font>

756
00:29:16,380 --> 00:29:21,030
devices from<font color="#E5E5E5"> being plugged into your</font>

757
00:29:18,030 --> 00:29:22,560
<font color="#CCCCCC">network</font><font color="#E5E5E5"> and essentially the way it does</font>

758
00:29:21,030 --> 00:29:24,870
that is it usually has some sort<font color="#E5E5E5"> of</font>

759
00:29:22,560 --> 00:29:26,610
<font color="#E5E5E5">profiling that happens</font><font color="#CCCCCC"> so that</font><font color="#E5E5E5"> the</font>

760
00:29:24,870 --> 00:29:28,649
<font color="#E5E5E5">devices that you plugged in if they</font>

761
00:29:26,610 --> 00:29:30,899
don't match<font color="#E5E5E5"> your organization's profiles</font>

762
00:29:28,650 --> 00:29:34,050
<font color="#E5E5E5">then they just get knocked off</font><font color="#CCCCCC"> to like a</font>

763
00:29:30,900 --> 00:29:35,820
separate VLAN<font color="#CCCCCC"> or something so one of the</font>

764
00:29:34,050 --> 00:29:37,409
obvious obvious ways that we<font color="#E5E5E5"> get around</font>

765
00:29:35,820 --> 00:29:38,820
<font color="#E5E5E5">this is</font><font color="#CCCCCC"> just find a printer and</font><font color="#E5E5E5"> just</font>

766
00:29:37,410 --> 00:29:40,350
copy the MAC address<font color="#CCCCCC"> of</font><font color="#E5E5E5"> that or</font><font color="#CCCCCC"> just</font>

767
00:29:38,820 --> 00:29:43,260
plug into the port because<font color="#E5E5E5"> oftentimes</font>

768
00:29:40,350 --> 00:29:45,209
the printers and and various<font color="#E5E5E5"> VoIP phones</font>

769
00:29:43,260 --> 00:29:47,460
<font color="#E5E5E5">so on most of these pendants we're on</font>

770
00:29:45,210 --> 00:29:49,740
don't have the<font color="#CCCCCC"> ability to</font><font color="#E5E5E5"> install like</font>

771
00:29:47,460 --> 00:29:51,960
certificates for for the<font color="#CCCCCC"> knack</font><font color="#E5E5E5"> to</font>

772
00:29:49,740 --> 00:29:53,250
authenticate with and so that's one of

773
00:29:51,960 --> 00:29:54,990
<font color="#E5E5E5">the easier ways there's a tool called</font>

774
00:29:53,250 --> 00:29:57,650
<font color="#E5E5E5">void popper that works really well to</font>

775
00:29:54,990 --> 00:30:01,230
hop from<font color="#E5E5E5"> VLAN</font><font color="#CCCCCC"> to viewing</font><font color="#E5E5E5"> as well on</font>

776
00:29:57,650 --> 00:30:03,150
Wi-Fi based 802<font color="#CCCCCC"> annex</font><font color="#E5E5E5"> nak networks a lot</font>

777
00:30:01,230 --> 00:30:04,830
of times you can<font color="#E5E5E5"> find like iPhone</font>

778
00:30:03,150 --> 00:30:06,090
devices<font color="#E5E5E5"> that are connected and the cool</font>

779
00:30:04,830 --> 00:30:09,330
<font color="#CCCCCC">thing about</font><font color="#E5E5E5"> Wi-Fi is you can see the MAC</font>

780
00:30:06,090 --> 00:30:11,870
addresses through Wi-Fi<font color="#CCCCCC"> I think somebody</font>

781
00:30:09,330 --> 00:30:16,350
just got some Wi-Fi going up maybe<font color="#E5E5E5"> here</font>

782
00:30:11,870 --> 00:30:18,030
<font color="#CCCCCC">and</font><font color="#E5E5E5"> then another</font><font color="#CCCCCC"> time or another thing</font>

783
00:30:16,350 --> 00:30:19,770
that's<font color="#E5E5E5"> that's an interesting point out</font>

784
00:30:18,030 --> 00:30:22,740
here is<font color="#CCCCCC"> that you can actually</font><font color="#E5E5E5"> bypass</font>

785
00:30:19,770 --> 00:30:26,400
<font color="#CCCCCC">nack if you can situate yourself</font><font color="#E5E5E5"> in</font>

786
00:30:22,740 --> 00:30:28,590
between<font color="#CCCCCC"> an authenticated device using an</font>

787
00:30:26,400 --> 00:30:31,560
<font color="#E5E5E5">actual like layer 2 and layer 3 based</font>

788
00:30:28,590 --> 00:30:33,419
<font color="#E5E5E5">control so there's there's a it's a</font>

789
00:30:31,560 --> 00:30:34,320
rather old script these days it's called

790
00:30:33,420 --> 00:30:36,060
a beagle in the middle

791
00:30:34,320 --> 00:30:37,590
<font color="#CCCCCC">it's Python script that actually</font><font color="#E5E5E5"> will</font>

792
00:30:36,060 --> 00:30:40,649
listen<font color="#E5E5E5"> to both</font><font color="#CCCCCC"> sides of</font><font color="#E5E5E5"> the wire and</font>

793
00:30:37,590 --> 00:30:42,060
basically<font color="#E5E5E5"> simulate what</font><font color="#CCCCCC"> the wall is to</font>

794
00:30:40,650 --> 00:30:44,130
the computer<font color="#CCCCCC"> and what</font><font color="#E5E5E5"> the computers to</font>

795
00:30:42,060 --> 00:30:46,919
the wall so you're essentially sitting

796
00:30:44,130 --> 00:30:50,400
<font color="#E5E5E5">it like a bridge point in between an</font>

797
00:30:46,920 --> 00:30:52,590
authenticated a between<font color="#CCCCCC"> 1x device so</font>

798
00:30:50,400 --> 00:30:54,990
this is a<font color="#CCCCCC"> Dropbox</font><font color="#E5E5E5"> that we wrote an</font>

799
00:30:52,590 --> 00:30:56,850
article how to<font color="#E5E5E5"> build this is a no droid</font>

800
00:30:54,990 --> 00:30:58,350
<font color="#E5E5E5">see</font><font color="#CCCCCC"> - I need to update it</font><font color="#E5E5E5"> with like</font>

801
00:30:56,850 --> 00:30:59,879
<font color="#E5E5E5">maybe like one of the new roads that</font>

802
00:30:58,350 --> 00:31:01,530
they've released<font color="#E5E5E5"> recently but the old</font>

803
00:30:59,880 --> 00:31:04,620
route<font color="#CCCCCC"> c2 is pretty awesome this is a</font>

804
00:31:01,530 --> 00:31:06,899
very powerful little system

805
00:31:04,620 --> 00:31:09,750
and I believe it's still<font color="#E5E5E5"> under</font><font color="#CCCCCC"> 100 bucks</font>

806
00:31:06,900 --> 00:31:12,330
<font color="#CCCCCC">to build this but it's basically like</font>

807
00:31:09,750 --> 00:31:14,670
<font color="#E5E5E5">the idea</font><font color="#CCCCCC"> of creating you know</font><font color="#E5E5E5"> like a</font>

808
00:31:12,330 --> 00:31:15,990
poem plug of sorts<font color="#CCCCCC"> you know creating a</font>

809
00:31:14,670 --> 00:31:18,990
device that has<font color="#CCCCCC"> a linux-based</font>

810
00:31:15,990 --> 00:31:21,480
<font color="#CCCCCC">distribution that</font><font color="#E5E5E5"> can call out either</font>

811
00:31:18,990 --> 00:31:23,220
over over the the cell signal that maybe

812
00:31:21,480 --> 00:31:26,010
you have hooked<font color="#E5E5E5"> up through</font><font color="#CCCCCC"> three</font><font color="#E5E5E5"> 4G</font>

813
00:31:23,220 --> 00:31:27,809
adapter<font color="#E5E5E5"> over Wi-Fi you can control it</font>

814
00:31:26,010 --> 00:31:29,490
like directly<font color="#E5E5E5"> over Wi-Fi if you have if</font>

815
00:31:27,809 --> 00:31:30,690
<font color="#E5E5E5">you if you're close</font><font color="#CCCCCC"> enough to it</font><font color="#E5E5E5"> so the</font>

816
00:31:29,490 --> 00:31:32,010
<font color="#E5E5E5">idea would be you you sneak into an</font>

817
00:31:30,690 --> 00:31:33,600
office plug this in under<font color="#E5E5E5"> a desk</font>

818
00:31:32,010 --> 00:31:36,290
somewhere<font color="#E5E5E5"> nobody notices but it's</font>

819
00:31:33,600 --> 00:31:36,290
plugged into the<font color="#CCCCCC"> network</font>

820
00:31:36,840 --> 00:31:41,610
pixee booting attacks<font color="#CCCCCC"> I threw this image</font>

821
00:31:39,779 --> 00:31:43,950
in<font color="#E5E5E5"> here</font><font color="#CCCCCC"> primarily because this was me</font>

822
00:31:41,610 --> 00:31:47,699
<font color="#E5E5E5">and Derrick Tuesday at Busch Gardens on</font>

823
00:31:43,950 --> 00:31:49,789
the the<font color="#E5E5E5"> Battle of</font><font color="#CCCCCC"> eire right there it</font>

824
00:31:47,700 --> 00:31:54,150
was<font color="#E5E5E5"> awesome</font>

825
00:31:49,789 --> 00:31:57,600
and there were Pixies<font color="#E5E5E5"> so pixie booting</font>

826
00:31:54,150 --> 00:31:59,760
attacks so on a lot of<font color="#E5E5E5"> networks that are</font>

827
00:31:57,600 --> 00:32:02,459
very large and scale what a lot<font color="#CCCCCC"> of</font>

828
00:31:59,760 --> 00:32:04,350
organizations do is they actually enable

829
00:32:02,460 --> 00:32:08,130
systems to boot<font color="#CCCCCC"> to an image</font><font color="#E5E5E5"> like a</font>

830
00:32:04,350 --> 00:32:09,480
golden image<font color="#E5E5E5"> over over pixie and one of</font>

831
00:32:08,130 --> 00:32:10,950
the attacks that<font color="#CCCCCC"> we do</font><font color="#E5E5E5"> sometimes when we</font>

832
00:32:09,480 --> 00:32:12,779
get on site is just<font color="#E5E5E5"> set a virtual</font>

833
00:32:10,950 --> 00:32:15,149
<font color="#E5E5E5">machine to boot over the network and it</font>

834
00:32:12,779 --> 00:32:16,559
will<font color="#E5E5E5"> query for those for those images</font>

835
00:32:15,149 --> 00:32:19,260
<font color="#E5E5E5">and a lot of times we can get that pixie</font>

836
00:32:16,559 --> 00:32:22,080
boot image directly from<font color="#CCCCCC"> the network and</font>

837
00:32:19,260 --> 00:32:24,929
<font color="#E5E5E5">then boot that VM maybe snapshot it and</font>

838
00:32:22,080 --> 00:32:26,370
then go steal admin hashes from<font color="#E5E5E5"> it</font><font color="#CCCCCC"> so</font>

839
00:32:24,929 --> 00:32:27,390
you<font color="#CCCCCC"> can you can perform</font><font color="#E5E5E5"> a lot</font><font color="#CCCCCC"> of</font>

840
00:32:26,370 --> 00:32:29,489
different attacks like mounting it

841
00:32:27,390 --> 00:32:32,039
mounting the actual like storage from

842
00:32:29,490 --> 00:32:36,049
<font color="#E5E5E5">the VM itself and grabbing like the</font>

843
00:32:32,039 --> 00:32:38,399
admin hashes from from the<font color="#CCCCCC"> anteed file</font>

844
00:32:36,049 --> 00:32:41,158
<font color="#CCCCCC">you could set the local</font><font color="#E5E5E5"> ID and password</font>

845
00:32:38,399 --> 00:32:43,049
<font color="#E5E5E5">to just completely bypass authentication</font>

846
00:32:41,159 --> 00:32:45,419
all together<font color="#E5E5E5"> and then you could</font><font color="#CCCCCC"> also</font>

847
00:32:43,049 --> 00:32:48,360
overwrite<font color="#E5E5E5"> sticky keys to do something</font>

848
00:32:45,419 --> 00:32:52,690
like you<font color="#CCCCCC"> know</font><font color="#E5E5E5"> palpable command shell</font>

849
00:32:48,360 --> 00:32:56,799
<font color="#CCCCCC">alright post exploitation</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> powerup</font>

850
00:32:52,690 --> 00:32:58,840
sequel is a project written<font color="#E5E5E5"> by Ken</font>

851
00:32:56,799 --> 00:33:01,270
Sutherland<font color="#CCCCCC"> I think the reason we threw</font>

852
00:32:58,840 --> 00:33:03,820
this in here<font color="#CCCCCC"> is for it's sort of like</font>

853
00:33:01,270 --> 00:33:06,610
male sniper in a way where if you get

854
00:33:03,820 --> 00:33:08,350
into an<font color="#CCCCCC"> environment</font><font color="#E5E5E5"> and there are</font><font color="#CCCCCC"> 400</font>

855
00:33:06,610 --> 00:33:10,510
sequel servers and<font color="#E5E5E5"> you're trying to find</font>

856
00:33:08,350 --> 00:33:13,178
the sensitive data<font color="#E5E5E5"> so the</font><font color="#CCCCCC"> best choice</font><font color="#E5E5E5"> of</font>

857
00:33:10,510 --> 00:33:14,740
action is<font color="#CCCCCC"> to install</font><font color="#E5E5E5"> sequel Enterprise</font>

858
00:33:13,179 --> 00:33:17,799
Manager and go look at each<font color="#CCCCCC"> one of them</font>

859
00:33:14,740 --> 00:33:18,790
one at a time<font color="#CCCCCC"> right no that's terrible</font>

860
00:33:17,799 --> 00:33:20,830
<font color="#E5E5E5">idea</font>

861
00:33:18,790 --> 00:33:23,379
so powerup sequel does a number<font color="#CCCCCC"> of</font>

862
00:33:20,830 --> 00:33:24,909
<font color="#E5E5E5">things but I think</font><font color="#CCCCCC"> one of my my one of</font>

863
00:33:23,380 --> 00:33:26,530
<font color="#E5E5E5">the best things that it does is</font><font color="#CCCCCC"> it</font>

864
00:33:24,910 --> 00:33:29,260
<font color="#CCCCCC">allows you to</font><font color="#E5E5E5"> search for data in</font>

865
00:33:26,530 --> 00:33:32,860
<font color="#E5E5E5">databases that you have access to at</font>

866
00:33:29,260 --> 00:33:35,830
scale and<font color="#E5E5E5"> that's really powerful right</font>

867
00:33:32,860 --> 00:33:38,469
because you know as an attacker or as a

868
00:33:35,830 --> 00:33:40,928
red teamer<font color="#E5E5E5"> I really a lot of times might</font>

869
00:33:38,470 --> 00:33:43,120
not know where the sensitive data is and

870
00:33:40,929 --> 00:33:45,700
so I can throw<font color="#CCCCCC"> in terms to look for that</font>

871
00:33:43,120 --> 00:33:47,830
sensitive<font color="#CCCCCC"> data or to look for other</font>

872
00:33:45,700 --> 00:33:50,650
types of data<font color="#E5E5E5"> so using this tool in the</font>

873
00:33:47,830 --> 00:33:53,230
past<font color="#CCCCCC"> I found a</font><font color="#E5E5E5"> friend</font><font color="#CCCCCC"> in clear-text</font>

874
00:33:50,650 --> 00:33:54,910
credit card numbers<font color="#CCCCCC"> that was a good one</font>

875
00:33:53,230 --> 00:34:00,010
<font color="#CCCCCC">I found social security numbers I found</font>

876
00:33:54,910 --> 00:34:01,450
<font color="#E5E5E5">passwords and then also used it to to</font>

877
00:34:00,010 --> 00:34:05,200
find the<font color="#E5E5E5"> data that the client was asking</font>

878
00:34:01,450 --> 00:34:06,850
<font color="#CCCCCC">for us</font><font color="#E5E5E5"> to find</font><font color="#CCCCCC"> so that's one of</font><font color="#E5E5E5"> the</font>

879
00:34:05,200 --> 00:34:08,980
things that it does<font color="#E5E5E5"> it also has modules</font>

880
00:34:06,850 --> 00:34:10,719
for privilege escalation again<font color="#CCCCCC"> you know</font>

881
00:34:08,980 --> 00:34:12,219
as I<font color="#CCCCCC"> mentioned before</font><font color="#E5E5E5"> is a previous</font>

882
00:34:10,719 --> 00:34:15,040
<font color="#E5E5E5">systems administrator a lot of times</font>

883
00:34:12,219 --> 00:34:17,949
sequel is an overlooked thing<font color="#E5E5E5"> you know</font>

884
00:34:15,040 --> 00:34:20,020
<font color="#E5E5E5">it it's some kind of you know database</font>

885
00:34:17,949 --> 00:34:21,520
that<font color="#E5E5E5"> you know you're given like two days</font>

886
00:34:20,020 --> 00:34:24,009
to stand it up and<font color="#E5E5E5"> it had to be live</font>

887
00:34:21,520 --> 00:34:26,440
yesterday<font color="#CCCCCC"> so you just you know configure</font>

888
00:34:24,010 --> 00:34:29,080
it improperly<font color="#E5E5E5"> and so a power-up sequel</font>

889
00:34:26,440 --> 00:34:31,600
will help you find some<font color="#CCCCCC"> of those</font><font color="#E5E5E5"> some of</font>

890
00:34:29,080 --> 00:34:33,668
<font color="#E5E5E5">those issues and configuration like you</font>

891
00:34:31,600 --> 00:34:35,819
know over privileged users things of

892
00:34:33,668 --> 00:34:35,819
that nature

893
00:34:36,690 --> 00:34:43,510
so living off the land so as an attacker

894
00:34:40,690 --> 00:34:45,760
<font color="#CCCCCC">I want to fly under the radar I'll use</font>

895
00:34:43,510 --> 00:34:52,240
<font color="#E5E5E5">some of the commands that are just built</font>

896
00:34:45,760 --> 00:34:54,429
<font color="#CCCCCC">into two windows it those commands how</font>

897
00:34:52,239 --> 00:34:57,790
many people do<font color="#E5E5E5"> command-line logging in</font>

898
00:34:54,429 --> 00:35:01,119
their environment yes I see a couple<font color="#E5E5E5"> of</font>

899
00:34:57,790 --> 00:35:04,450
hands right so in your environment how

900
00:35:01,119 --> 00:35:07,809
common is it for folks to run like<font color="#E5E5E5"> say</font>

901
00:35:04,450 --> 00:35:10,450
net commands everybody especially

902
00:35:07,809 --> 00:35:15,250
accounting they run<font color="#CCCCCC"> net commands right</font>

903
00:35:10,450 --> 00:35:16,569
or<font color="#E5E5E5"> maybe encoded power show like I sent</font>

904
00:35:15,250 --> 00:35:19,240
some PowerShell commands and there's a

905
00:35:16,569 --> 00:35:20,770
big long<font color="#CCCCCC"> base64-encoded PowerShell that</font>

906
00:35:19,240 --> 00:35:23,140
seems really<font color="#CCCCCC"> close to definitely</font><font color="#E5E5E5"> running</font>

907
00:35:20,770 --> 00:35:26,490
that right yeah absolutely<font color="#CCCCCC"> ray that</font>

908
00:35:23,140 --> 00:35:29,558
seems totally legit right<font color="#E5E5E5"> so you can use</font>

909
00:35:26,490 --> 00:35:32,109
<font color="#E5E5E5">windows built-in</font><font color="#CCCCCC"> windows features to do</font>

910
00:35:29,559 --> 00:35:34,390
you know<font color="#E5E5E5"> copy files back</font><font color="#CCCCCC"> and forth</font>

911
00:35:32,109 --> 00:35:36,910
across<font color="#E5E5E5"> the network and even use</font>

912
00:35:34,390 --> 00:35:40,540
<font color="#E5E5E5">something like</font><font color="#CCCCCC"> W</font><font color="#E5E5E5"> make to move laterally</font>

913
00:35:36,910 --> 00:35:41,920
<font color="#CCCCCC">so here are just a couple of examples</font><font color="#E5E5E5"> I</font>

914
00:35:40,540 --> 00:35:44,770
mean there's like an entire github

915
00:35:41,920 --> 00:35:47,170
project now called<font color="#CCCCCC"> all binaries where</font>

916
00:35:44,770 --> 00:35:49,059
<font color="#E5E5E5">they there's a lot of stuff in Microsoft</font>

917
00:35:47,170 --> 00:35:52,299
that<font color="#E5E5E5"> I mean I'm sure someone at</font>

918
00:35:49,059 --> 00:35:54,040
Microsoft knows what it does but like it

919
00:35:52,299 --> 00:35:56,799
<font color="#E5E5E5">just seems like the</font><font color="#CCCCCC"> Windows is such a</font>

920
00:35:54,040 --> 00:35:58,200
big project now that<font color="#E5E5E5"> no one person knows</font>

921
00:35:56,799 --> 00:36:01,509
<font color="#E5E5E5">at all and so there are all these</font>

922
00:35:58,200 --> 00:36:03,279
binaries<font color="#CCCCCC"> that have some let's just say</font>

923
00:36:01,510 --> 00:36:06,250
maybe unintended or undocumented

924
00:36:03,280 --> 00:36:07,299
features but just you<font color="#E5E5E5"> know here are a</font>

925
00:36:06,250 --> 00:36:12,280
couple<font color="#E5E5E5"> of minutes like I said net</font>

926
00:36:07,299 --> 00:36:15,190
commands you can use<font color="#CCCCCC"> Durer</font><font color="#E5E5E5"> to list files</font>

927
00:36:12,280 --> 00:36:18,309
remotely<font color="#E5E5E5"> that seems really useful</font><font color="#CCCCCC"> and</font>

928
00:36:15,190 --> 00:36:21,339
then when<font color="#E5E5E5"> RM like I mentioned</font><font color="#CCCCCC"> how do</font><font color="#E5E5E5"> you</font>

929
00:36:18,309 --> 00:36:26,530
make I mean<font color="#E5E5E5"> use win RM to move laterally</font>

930
00:36:21,339 --> 00:36:28,808
<font color="#CCCCCC">so we were making fun of the cyber apt</font>

931
00:36:26,530 --> 00:36:30,460
blinky box thing earlier and I and I do

932
00:36:28,809 --> 00:36:32,710
that not<font color="#CCCCCC"> because these companies are</font>

933
00:36:30,460 --> 00:36:34,720
<font color="#E5E5E5">doing something bad but because the way</font>

934
00:36:32,710 --> 00:36:37,000
that they mark it<font color="#E5E5E5"> and what I've seen</font>

935
00:36:34,720 --> 00:36:38,828
other organizations do is they think

936
00:36:37,000 --> 00:36:41,290
<font color="#E5E5E5">it's some</font><font color="#CCCCCC"> kind of</font><font color="#E5E5E5"> silver bullet</font><font color="#CCCCCC"> because</font>

937
00:36:38,829 --> 00:36:43,089
they've been<font color="#E5E5E5"> told that so they're in</font>

938
00:36:41,290 --> 00:36:46,319
fact<font color="#E5E5E5"> not they're just another layer of</font>

939
00:36:43,089 --> 00:36:48,790
security<font color="#CCCCCC"> and so I won't mention the the</font>

940
00:36:46,319 --> 00:36:50,140
<font color="#E5E5E5">company's name but you guys want to see</font>

941
00:36:48,790 --> 00:36:53,589
the super<font color="#CCCCCC"> sophisticated</font>

942
00:36:50,140 --> 00:36:57,519
way<font color="#CCCCCC"> i</font><font color="#E5E5E5"> bypassed one of these next</font><font color="#CCCCCC"> gen AI</font>

943
00:36:53,589 --> 00:37:02,380
cyber blinky box things how<font color="#E5E5E5"> many people</font>

944
00:36:57,519 --> 00:37:04,509
have heard<font color="#E5E5E5"> of a net cat yeah I shoveled</font>

945
00:37:02,380 --> 00:37:07,960
a reverse<font color="#CCCCCC"> shell with one</font><font color="#E5E5E5"> of these one of</font>

946
00:37:04,510 --> 00:37:13,390
<font color="#E5E5E5">the agents running on a machine and it</font>

947
00:37:07,960 --> 00:37:15,880
<font color="#E5E5E5">was totally cool no problem there</font><font color="#CCCCCC"> we</font>

948
00:37:13,390 --> 00:37:16,779
added this one in<font color="#E5E5E5"> because I you know</font>

949
00:37:15,880 --> 00:37:19,089
this is actually<font color="#CCCCCC"> something that I think</font>

950
00:37:16,779 --> 00:37:21,369
<font color="#CCCCCC">I I thought was a fairly well-known</font>

951
00:37:19,089 --> 00:37:23,319
<font color="#E5E5E5">technique for for dumping memory from a</font>

952
00:37:21,369 --> 00:37:24,849
system<font color="#CCCCCC"> but I had a conversation</font><font color="#E5E5E5"> with me</font>

953
00:37:23,319 --> 00:37:26,890
last night<font color="#E5E5E5"> and it blew their mind that</font>

954
00:37:24,849 --> 00:37:29,049
this<font color="#E5E5E5"> is possible</font><font color="#CCCCCC"> so a lot of the you</font>

955
00:37:26,890 --> 00:37:30,190
know<font color="#CCCCCC"> next-gen actually most any viruses</font>

956
00:37:29,049 --> 00:37:32,829
these days will detect something<font color="#E5E5E5"> like</font>

957
00:37:30,190 --> 00:37:34,779
<font color="#CCCCCC">mini cats</font><font color="#E5E5E5"> and so let's say you want to</font>

958
00:37:32,829 --> 00:37:35,799
run mini cats on a system<font color="#E5E5E5"> without you</font>

959
00:37:34,779 --> 00:37:37,390
know<font color="#E5E5E5"> being able to because you're</font>

960
00:37:35,799 --> 00:37:39,880
getting blocked or it's getting<font color="#CCCCCC"> alerted</font>

961
00:37:37,390 --> 00:37:41,410
on<font color="#CCCCCC"> you can create a dump file the</font><font color="#E5E5E5"> L SAS</font>

962
00:37:39,880 --> 00:37:43,630
process and then just go run<font color="#E5E5E5"> many cats</font>

963
00:37:41,410 --> 00:37:44,859
<font color="#CCCCCC">offline against it and</font><font color="#E5E5E5"> you can use the</font>

964
00:37:43,630 --> 00:37:46,480
feature that's built into<font color="#E5E5E5"> Microsoft to</font>

965
00:37:44,859 --> 00:37:48,848
do it<font color="#CCCCCC"> all have</font><font color="#E5E5E5"> to do is open</font><font color="#CCCCCC"> up task</font>

966
00:37:46,480 --> 00:37:51,130
manager right click<font color="#CCCCCC"> L SAS process click</font>

967
00:37:48,849 --> 00:37:53,019
create dump file<font color="#CCCCCC"> you know have a memory</font>

968
00:37:51,130 --> 00:37:54,460
dump of the<font color="#E5E5E5"> LSS process that contains</font>

969
00:37:53,019 --> 00:37:56,078
all<font color="#E5E5E5"> the stuff you need</font><font color="#CCCCCC"> to get clear text</font>

970
00:37:54,460 --> 00:37:58,180
creds out of it with mini cats<font color="#E5E5E5"> all you</font>

971
00:37:56,079 --> 00:37:59,319
have to do is get it<font color="#E5E5E5"> offline and then go</font>

972
00:37:58,180 --> 00:38:02,649
<font color="#E5E5E5">run it against it on a system that's</font><font color="#CCCCCC"> not</font>

973
00:37:59,319 --> 00:38:04,359
being<font color="#CCCCCC"> protected they</font><font color="#E5E5E5"> actually added that</font>

974
00:38:02,650 --> 00:38:07,539
in Windows<font color="#CCCCCC"> 7</font><font color="#E5E5E5"> used to have to use proc</font>

975
00:38:04,359 --> 00:38:09,940
<font color="#E5E5E5">dump so I don't know why it would</font><font color="#CCCCCC"> be</font>

976
00:38:07,539 --> 00:38:13,690
added<font color="#E5E5E5"> and then I mean at least don't</font><font color="#CCCCCC"> let</font>

977
00:38:09,940 --> 00:38:15,910
you do the<font color="#CCCCCC"> else's process right yeah so</font>

978
00:38:13,690 --> 00:38:18,490
we were talking<font color="#E5E5E5"> earlier</font><font color="#CCCCCC"> about using</font>

979
00:38:15,910 --> 00:38:21,690
<font color="#E5E5E5">built-in commands</font><font color="#CCCCCC"> so we can get a little</font>

980
00:38:18,490 --> 00:38:24,879
<font color="#E5E5E5">bit stealthier to by using</font><font color="#CCCCCC"> built-in</font>

981
00:38:21,690 --> 00:38:27,339
dotnet direct queries instead of

982
00:38:24,880 --> 00:38:29,230
actually using powerful<font color="#E5E5E5"> commands and and</font>

983
00:38:27,339 --> 00:38:31,690
<font color="#CCCCCC">Kamiya and command</font><font color="#E5E5E5"> line commands so a</font>

984
00:38:29,230 --> 00:38:34,299
<font color="#E5E5E5">tool we wrote</font><font color="#CCCCCC"> called host recon</font><font color="#E5E5E5"> will do</font>

985
00:38:31,690 --> 00:38:36,430
a lot<font color="#CCCCCC"> of the typical why</font><font color="#E5E5E5"> a typical recon</font>

986
00:38:34,299 --> 00:38:39,579
against the<font color="#E5E5E5"> system such</font><font color="#CCCCCC"> as like you know</font>

987
00:38:36,430 --> 00:38:41,649
<font color="#E5E5E5">figuring out what what like data get</font>

988
00:38:39,579 --> 00:38:43,329
back<font color="#E5E5E5"> from like IP config net commands</font>

989
00:38:41,650 --> 00:38:45,490
like figure<font color="#E5E5E5"> out all the users from a</font>

990
00:38:43,329 --> 00:38:46,930
domain<font color="#CCCCCC"> netstat Who am I all that stuff</font>

991
00:38:45,490 --> 00:38:49,720
<font color="#E5E5E5">but without actually running any of</font>

992
00:38:46,930 --> 00:38:52,660
those binaries<font color="#CCCCCC"> so</font><font color="#E5E5E5"> you know a lot</font><font color="#CCCCCC"> of</font>

993
00:38:49,720 --> 00:38:55,058
times<font color="#CCCCCC"> will will alert on things like net</font>

994
00:38:52,660 --> 00:38:57,430
users or things<font color="#CCCCCC"> like IP config will get</font>

995
00:38:55,059 --> 00:38:58,690
alerted<font color="#E5E5E5"> on these days so this tool will</font>

996
00:38:57,430 --> 00:39:01,538
kind of get<font color="#E5E5E5"> around that a little</font><font color="#CCCCCC"> bit by</font>

997
00:38:58,690 --> 00:39:03,140
<font color="#CCCCCC">doing it all through direct dotnet</font>

998
00:39:01,539 --> 00:39:06,000
queries

999
00:39:03,140 --> 00:39:09,000
we made<font color="#E5E5E5"> it to detection prevention</font><font color="#CCCCCC"> Wow</font>

1000
00:39:06,000 --> 00:39:10,770
we actually<font color="#CCCCCC"> still</font><font color="#E5E5E5"> have time um</font><font color="#CCCCCC"> so this</font>

1001
00:39:09,000 --> 00:39:12,330
<font color="#E5E5E5">talk would</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> pretty useless if we ended</font>

1002
00:39:10,770 --> 00:39:14,520
here and just said<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> guys that's</font>

1003
00:39:12,330 --> 00:39:16,410
<font color="#E5E5E5">great um you're sorry you're</font><font color="#CCCCCC"> old</font><font color="#E5E5E5"> you</font>

1004
00:39:14,520 --> 00:39:18,540
know<font color="#E5E5E5"> not able to do anything about any</font>

1005
00:39:16,410 --> 00:39:21,990
<font color="#E5E5E5">of this and that's really not true</font>

1006
00:39:18,540 --> 00:39:24,300
so I firmly believe that<font color="#E5E5E5"> good security</font>

1007
00:39:21,990 --> 00:39:26,310
<font color="#E5E5E5">starts with you know solid systems</font>

1008
00:39:24,300 --> 00:39:27,960
<font color="#E5E5E5">administration if you have a good</font>

1009
00:39:26,310 --> 00:39:30,240
systems<font color="#E5E5E5"> administration team and they're</font>

1010
00:39:27,960 --> 00:39:33,270
<font color="#E5E5E5">doing what they</font><font color="#CCCCCC"> should be doing you have</font>

1011
00:39:30,240 --> 00:39:35,879
the foundation<font color="#E5E5E5"> for what good security</font>

1012
00:39:33,270 --> 00:39:37,020
should be<font color="#E5E5E5"> built on so you know going</font>

1013
00:39:35,880 --> 00:39:39,360
<font color="#E5E5E5">through there's something like the 20</font>

1014
00:39:37,020 --> 00:39:41,520
critical controls it starts with systems

1015
00:39:39,360 --> 00:39:43,080
administration<font color="#E5E5E5"> you know know what is in</font>

1016
00:39:41,520 --> 00:39:45,330
your<font color="#CCCCCC"> environment</font><font color="#E5E5E5"> you know know your</font>

1017
00:39:43,080 --> 00:39:47,100
machine names<font color="#CCCCCC"> you know what software is</font>

1018
00:39:45,330 --> 00:39:49,950
<font color="#E5E5E5">there and then set up alerts if</font>

1019
00:39:47,100 --> 00:39:51,750
something is not in that<font color="#CCCCCC"> baseline</font><font color="#E5E5E5"> it's</font>

1020
00:39:49,950 --> 00:39:53,879
<font color="#E5E5E5">really easy for</font><font color="#CCCCCC"> me to say that I realize</font>

1021
00:39:51,750 --> 00:39:57,210
it<font color="#E5E5E5"> takes like six</font><font color="#CCCCCC"> years to implement</font><font color="#E5E5E5"> but</font>

1022
00:39:53,880 --> 00:39:59,580
you know<font color="#CCCCCC"> you should still get there</font>

1023
00:39:57,210 --> 00:40:02,430
eventually right if you want to make me

1024
00:39:59,580 --> 00:40:05,100
have a really<font color="#E5E5E5"> really bad day</font><font color="#CCCCCC"> as an</font>

1025
00:40:02,430 --> 00:40:06,419
attacker prevent all your workstations

1026
00:40:05,100 --> 00:40:10,069
from<font color="#CCCCCC"> talking to each other</font>

1027
00:40:06,420 --> 00:40:12,540
<font color="#E5E5E5">I think that would probably make me cry</font>

1028
00:40:10,070 --> 00:40:15,240
<font color="#E5E5E5">it's and there are a</font><font color="#CCCCCC"> number of ways to</font>

1029
00:40:12,540 --> 00:40:16,890
do it<font color="#CCCCCC"> one way is cisco has a feature</font>

1030
00:40:15,240 --> 00:40:20,819
called private VLANs if you enable

1031
00:40:16,890 --> 00:40:22,410
<font color="#E5E5E5">private VLANs your workstations won't be</font>

1032
00:40:20,820 --> 00:40:24,510
able<font color="#E5E5E5"> to talk</font><font color="#CCCCCC"> to each</font><font color="#E5E5E5"> other you can also</font>

1033
00:40:22,410 --> 00:40:26,700
do it<font color="#CCCCCC"> with something like a Windows you</font>

1034
00:40:24,510 --> 00:40:28,500
know host-based firewall right but again

1035
00:40:26,700 --> 00:40:30,540
<font color="#CCCCCC">this is</font><font color="#E5E5E5"> like good systems administration</font>

1036
00:40:28,500 --> 00:40:33,330
this isn't like a cyber apt<font color="#CCCCCC"> blinkie box</font>

1037
00:40:30,540 --> 00:40:35,220
<font color="#E5E5E5">I don't get concerned really when I see</font>

1038
00:40:33,330 --> 00:40:38,100
those things<font color="#CCCCCC"> I get concerned when</font><font color="#E5E5E5"> I</font>

1039
00:40:35,220 --> 00:40:39,240
found out<font color="#E5E5E5"> that lateral movement is not</font>

1040
00:40:38,100 --> 00:40:41,730
going to happen

1041
00:40:39,240 --> 00:40:43,830
<font color="#CCCCCC">all right it takes</font><font color="#E5E5E5"> an entire category</font>

1042
00:40:41,730 --> 00:40:46,470
away and good systems administration

1043
00:40:43,830 --> 00:40:49,049
workstations should talk to<font color="#E5E5E5"> servers they</font>

1044
00:40:46,470 --> 00:40:50,609
shouldn't talk to other workstations<font color="#CCCCCC"> you</font>

1045
00:40:49,050 --> 00:40:54,360
know so and<font color="#E5E5E5"> that gets to</font><font color="#CCCCCC"> like baseline</font>

1046
00:40:50,610 --> 00:40:56,850
images with<font color="#E5E5E5"> GPO enforcement and again if</font>

1047
00:40:54,360 --> 00:40:59,460
you if you're if you<font color="#CCCCCC"> know what should be</font>

1048
00:40:56,850 --> 00:41:01,770
there and you look for what<font color="#E5E5E5"> shouldn't</font><font color="#CCCCCC"> be</font>

1049
00:40:59,460 --> 00:41:05,520
there<font color="#E5E5E5"> its security becomes a little</font><font color="#CCCCCC"> bit</font>

1050
00:41:01,770 --> 00:41:07,500
<font color="#E5E5E5">easier right</font><font color="#CCCCCC"> and then everything that</font>

1051
00:41:05,520 --> 00:41:09,000
<font color="#E5E5E5">comes into your</font><font color="#CCCCCC"> network and everything</font>

1052
00:41:07,500 --> 00:41:12,180
that goes out<font color="#E5E5E5"> of your network should go</font>

1053
00:41:09,000 --> 00:41:14,190
<font color="#E5E5E5">through some application level proxy and</font>

1054
00:41:12,180 --> 00:41:16,740
the reason I say that is<font color="#E5E5E5"> we've been in</font>

1055
00:41:14,190 --> 00:41:16,980
environments<font color="#E5E5E5"> that have you know no proxy</font>

1056
00:41:16,740 --> 00:41:18,118
sir

1057
00:41:16,980 --> 00:41:19,619
they just<font color="#E5E5E5"> allow you know their</font>

1058
00:41:18,119 --> 00:41:23,340
<font color="#E5E5E5">workstations to talk out you know port</font>

1059
00:41:19,619 --> 00:41:24,930
80 and<font color="#CCCCCC"> 443 and so what if I you know if</font>

1060
00:41:23,340 --> 00:41:26,910
<font color="#E5E5E5">those</font><font color="#CCCCCC"> are the two ports that are</font><font color="#E5E5E5"> open</font>

1061
00:41:24,930 --> 00:41:29,368
<font color="#E5E5E5">and everything else is filtered</font><font color="#CCCCCC"> I mean I</font>

1062
00:41:26,910 --> 00:41:33,089
I have<font color="#E5E5E5"> to talk HTTP through that port 80</font>

1063
00:41:29,369 --> 00:41:34,770
<font color="#CCCCCC">right no I don't I</font><font color="#E5E5E5"> can just talk raw TCP</font>

1064
00:41:33,090 --> 00:41:38,550
or I can encrypt traffic<font color="#E5E5E5"> and it doesn't</font>

1065
00:41:34,770 --> 00:41:41,250
even<font color="#E5E5E5"> have</font><font color="#CCCCCC"> to look</font><font color="#E5E5E5"> like HTTP but if you</font>

1066
00:41:38,550 --> 00:41:44,010
send it through a proxy<font color="#CCCCCC"> and that proxy</font>

1067
00:41:41,250 --> 00:41:46,200
doesn't allow<font color="#E5E5E5"> anything that's not HTTP</font>

1068
00:41:44,010 --> 00:41:48,270
or you know<font color="#E5E5E5"> something that should the</font>

1069
00:41:46,200 --> 00:41:54,290
traffic should<font color="#CCCCCC"> look like</font><font color="#E5E5E5"> it makes me</font>

1070
00:41:48,270 --> 00:41:56,490
have a worse day so good user behavior

1071
00:41:54,290 --> 00:41:58,050
we didn't really<font color="#E5E5E5"> talk about phishing</font>

1072
00:41:56,490 --> 00:42:01,080
that was sort of in<font color="#E5E5E5"> the in the you know</font>

1073
00:41:58,050 --> 00:42:03,990
first talk right but so when you have<font color="#CCCCCC"> an</font>

1074
00:42:01,080 --> 00:42:07,020
email<font color="#E5E5E5"> come inbound to a user</font><font color="#CCCCCC"> tag the</font>

1075
00:42:03,990 --> 00:42:09,868
subject line for<font color="#E5E5E5"> external and don't tell</font>

1076
00:42:07,020 --> 00:42:11,910
your users not<font color="#CCCCCC"> to click on links that is</font>

1077
00:42:09,869 --> 00:42:13,200
actually terrible<font color="#E5E5E5"> advice because we say</font>

1078
00:42:11,910 --> 00:42:15,170
don't<font color="#E5E5E5"> click on links</font><font color="#CCCCCC"> it's bad don't</font>

1079
00:42:13,200 --> 00:42:17,640
<font color="#E5E5E5">click on links</font><font color="#CCCCCC"> and then what do</font><font color="#E5E5E5"> we do</font>

1080
00:42:15,170 --> 00:42:20,040
the security team sends out an email

1081
00:42:17,640 --> 00:42:22,799
<font color="#E5E5E5">with a link in it so don't click on</font>

1082
00:42:20,040 --> 00:42:25,560
<font color="#CCCCCC">links except for the good ones no one's</font>

1083
00:42:22,800 --> 00:42:27,630
<font color="#E5E5E5">no one's ever gonna do well at</font><font color="#CCCCCC"> that</font>

1084
00:42:25,560 --> 00:42:29,730
right but you<font color="#E5E5E5"> what you could do is say</font>

1085
00:42:27,630 --> 00:42:31,650
hey look<font color="#E5E5E5"> if you get an email with an</font>

1086
00:42:29,730 --> 00:42:33,990
external tag that means it didn't come

1087
00:42:31,650 --> 00:42:36,450
<font color="#CCCCCC">from our organization be suspicious</font><font color="#E5E5E5"> of</font>

1088
00:42:33,990 --> 00:42:41,459
that email<font color="#E5E5E5"> and links that might be in</font>

1089
00:42:36,450 --> 00:42:44,100
that<font color="#CCCCCC"> email</font><font color="#E5E5E5"> and then probably one of the</font>

1090
00:42:41,460 --> 00:42:46,380
easiest changes to make<font color="#E5E5E5"> is the one that</font>

1091
00:42:44,100 --> 00:42:49,650
has the<font color="#CCCCCC"> most</font><font color="#E5E5E5"> political you know in an</font>

1092
00:42:46,380 --> 00:42:53,130
organization<font color="#E5E5E5"> challenge and that is stop</font>

1093
00:42:49,650 --> 00:42:54,710
<font color="#E5E5E5">using</font><font color="#CCCCCC"> eight character passwords if you</font>

1094
00:42:53,130 --> 00:42:57,450
put your care if you put your<font color="#E5E5E5"> password</font>

1095
00:42:54,710 --> 00:43:00,859
<font color="#CCCCCC">complex</font><font color="#E5E5E5"> or password character</font><font color="#CCCCCC"> lengths to</font>

1096
00:42:57,450 --> 00:43:03,330
<font color="#E5E5E5">15 or more characters that takes away</font><font color="#CCCCCC"> I</font>

1097
00:43:00,859 --> 00:43:04,650
it makes it a lot<font color="#CCCCCC"> harder for</font><font color="#E5E5E5"> me to try</font>

1098
00:43:03,330 --> 00:43:06,779
<font color="#E5E5E5">and guess a password with like something</font>

1099
00:43:04,650 --> 00:43:09,000
<font color="#CCCCCC">like password spraying or if I do end up</font>

1100
00:43:06,780 --> 00:43:11,520
<font color="#E5E5E5">getting a hash</font><font color="#CCCCCC"> if it's a 15 character</font>

1101
00:43:09,000 --> 00:43:14,010
password it is going to take me<font color="#E5E5E5"> forever</font>

1102
00:43:11,520 --> 00:43:16,560
<font color="#CCCCCC">to</font><font color="#E5E5E5"> crack it's just gonna take</font>

1103
00:43:14,010 --> 00:43:19,410
exponential<font color="#E5E5E5"> II longer than if it was an</font>

1104
00:43:16,560 --> 00:43:21,270
eight character<font color="#CCCCCC"> password and then you</font>

1105
00:43:19,410 --> 00:43:24,089
<font color="#CCCCCC">know</font><font color="#E5E5E5"> consider a you know additional</font>

1106
00:43:21,270 --> 00:43:26,250
<font color="#E5E5E5">credential defense</font><font color="#CCCCCC"> last year at Derby</font>

1107
00:43:24,090 --> 00:43:29,670
con we released a project called a

1108
00:43:26,250 --> 00:43:30,900
credit offense toolkit where it was one

1109
00:43:29,670 --> 00:43:33,059
<font color="#CCCCCC">of the portion or parts</font>

1110
00:43:30,900 --> 00:43:34,589
of it was a password filter that<font color="#E5E5E5"> said on</font>

1111
00:43:33,059 --> 00:43:37,260
<font color="#E5E5E5">your domain</font><font color="#CCCCCC"> controller</font><font color="#E5E5E5"> that had a list</font>

1112
00:43:34,589 --> 00:43:41,038
of banned words<font color="#CCCCCC"> so even if you up your</font>

1113
00:43:37,260 --> 00:43:43,470
you know password<font color="#CCCCCC"> character</font><font color="#E5E5E5"> links to</font><font color="#CCCCCC"> 8</font>

1114
00:43:41,039 --> 00:43:45,900
characters<font color="#CCCCCC"> or 15</font><font color="#E5E5E5"> characters it doesn't</font>

1115
00:43:43,470 --> 00:43:47,549
really take away<font color="#E5E5E5"> the entire ability for</font>

1116
00:43:45,900 --> 00:43:49,410
someone<font color="#E5E5E5"> to choose a really poor password</font>

1117
00:43:47,549 --> 00:43:50,309
<font color="#CCCCCC">and we thought we joked about summer</font>

1118
00:43:49,410 --> 00:43:54,078
2018

1119
00:43:50,309 --> 00:43:56,250
well what if I did summer summer 2018

1120
00:43:54,079 --> 00:43:58,559
that's longer<font color="#E5E5E5"> than 15 characters it's</font>

1121
00:43:56,250 --> 00:44:01,140
still a really terrible password but if

1122
00:43:58,559 --> 00:44:04,319
you blacklist the word summer<font color="#CCCCCC"> or</font><font color="#E5E5E5"> you</font>

1123
00:44:01,140 --> 00:44:06,118
know all the seasons<font color="#E5E5E5"> all the months it</font>

1124
00:44:04,319 --> 00:44:08,369
becomes a<font color="#CCCCCC"> little bit more difficult as</font>

1125
00:44:06,119 --> 00:44:12,059
an attacker<font color="#CCCCCC"> and there are commercial</font>

1126
00:44:08,369 --> 00:44:13,470
offerings that do this<font color="#E5E5E5"> as well</font><font color="#CCCCCC"> so I saw</font>

1127
00:44:12,059 --> 00:44:16,049
a couple<font color="#E5E5E5"> of hands when I asked about a</font>

1128
00:44:13,470 --> 00:44:17,459
<font color="#E5E5E5">host log consolidation so when I first</font>

1129
00:44:16,049 --> 00:44:19,380
<font color="#E5E5E5">started at Black Hills you know the</font>

1130
00:44:17,460 --> 00:44:21,089
first<font color="#E5E5E5"> couple of</font><font color="#CCCCCC"> years</font><font color="#E5E5E5"> I was kind of</font>

1131
00:44:19,380 --> 00:44:24,480
getting<font color="#CCCCCC"> a little</font><font color="#E5E5E5"> depressed because it</font>

1132
00:44:21,089 --> 00:44:26,520
<font color="#CCCCCC">just seemed really easy like I kept</font>

1133
00:44:24,480 --> 00:44:29,460
being successful I never was caught<font color="#CCCCCC"> in</font>

1134
00:44:26,520 --> 00:44:32,700
<font color="#E5E5E5">like oh man this is kind of depressing</font>

1135
00:44:29,460 --> 00:44:35,700
<font color="#CCCCCC">right</font><font color="#E5E5E5"> and then last year</font><font color="#CCCCCC"> I got caught a</font>

1136
00:44:32,700 --> 00:44:38,098
handful of<font color="#E5E5E5"> times and every</font><font color="#CCCCCC"> time I got</font>

1137
00:44:35,700 --> 00:44:40,410
caught<font color="#CCCCCC"> it was because of endpoint log</font>

1138
00:44:38,099 --> 00:44:42,390
consolidation the end point users

1139
00:44:40,410 --> 00:44:44,670
workstations<font color="#E5E5E5"> that's where all the bad</font>

1140
00:44:42,390 --> 00:44:47,390
stuff happens right<font color="#CCCCCC"> if you're logging</font>

1141
00:44:44,670 --> 00:44:50,220
what's happening on those workstations

1142
00:44:47,390 --> 00:44:51,930
<font color="#CCCCCC">like I was</font><font color="#E5E5E5"> talking about net commands</font>

1143
00:44:50,220 --> 00:44:53,788
earlier if you're<font color="#E5E5E5"> if you have an alert</font>

1144
00:44:51,930 --> 00:44:56,730
for<font color="#CCCCCC"> anytime</font><font color="#E5E5E5"> someone runs a net command</font>

1145
00:44:53,789 --> 00:44:57,630
<font color="#CCCCCC">yeah it might not be bad</font><font color="#E5E5E5"> but it's</font>

1146
00:44:56,730 --> 00:45:00,109
certainly<font color="#CCCCCC"> something that</font><font color="#E5E5E5"> should</font><font color="#CCCCCC"> be</font>

1147
00:44:57,630 --> 00:45:04,349
<font color="#CCCCCC">investigated also a PowerShell</font>

1148
00:45:00,109 --> 00:45:07,109
<font color="#E5E5E5">PowerShell v5</font><font color="#CCCCCC"> if you're running Windows</font>

1149
00:45:04,349 --> 00:45:08,369
10<font color="#E5E5E5"> you can already do this Windows 7 if</font>

1150
00:45:07,109 --> 00:45:11,819
you<font color="#E5E5E5"> want to know how to do it when</font><font color="#CCCCCC"> to 7</font>

1151
00:45:08,369 --> 00:45:14,369
come<font color="#E5E5E5"> see me after this talk you can log</font>

1152
00:45:11,819 --> 00:45:16,410
all PowerShell execution to the Windows

1153
00:45:14,369 --> 00:45:18,510
<font color="#CCCCCC">Event log</font><font color="#E5E5E5"> and also there's a product</font>

1154
00:45:16,410 --> 00:45:20,578
<font color="#E5E5E5">called</font><font color="#CCCCCC"> sis Mon</font><font color="#E5E5E5"> that's put out</font><font color="#CCCCCC"> it's</font>

1155
00:45:18,510 --> 00:45:23,010
sysinternals<font color="#CCCCCC"> that gives you a whole lot</font>

1156
00:45:20,579 --> 00:45:29,819
<font color="#E5E5E5">more</font><font color="#CCCCCC"> visibility</font><font color="#E5E5E5"> than the default that's</font>

1157
00:45:23,010 --> 00:45:32,460
delivered with<font color="#E5E5E5"> with</font><font color="#CCCCCC"> Windows and</font><font color="#E5E5E5"> oh one</font>

1158
00:45:29,819 --> 00:45:34,650
<font color="#E5E5E5">other point on that so that can actually</font>

1159
00:45:32,460 --> 00:45:37,920
be a whole talk in itself<font color="#CCCCCC"> I wrote a blog</font>

1160
00:45:34,650 --> 00:45:40,170
<font color="#E5E5E5">post</font><font color="#CCCCCC"> on how to do endpoint log</font>

1161
00:45:37,920 --> 00:45:42,420
consolidation<font color="#E5E5E5"> on the cheap I say on the</font>

1162
00:45:40,170 --> 00:45:44,050
cheap instead of free everything<font color="#CCCCCC"> is free</font>

1163
00:45:42,420 --> 00:45:46,900
<font color="#E5E5E5">but you still need a server</font>

1164
00:45:44,050 --> 00:45:48,220
so it's not really<font color="#E5E5E5"> free right so if</font>

1165
00:45:46,900 --> 00:45:51,070
you're interested<font color="#CCCCCC"> in doing this with</font>

1166
00:45:48,220 --> 00:45:53,290
things<font color="#E5E5E5"> that Microsoft provides you then</font>

1167
00:45:51,070 --> 00:45:54,610
I that blog<font color="#CCCCCC"> post will help you</font><font color="#E5E5E5"> and by</font>

1168
00:45:53,290 --> 00:45:58,360
the<font color="#CCCCCC"> way the slides will be posted after</font>

1169
00:45:54,610 --> 00:46:00,610
this and also<font color="#E5E5E5"> I was talking about</font>

1170
00:45:58,360 --> 00:46:02,170
<font color="#E5E5E5">network logging</font><font color="#CCCCCC"> it's our</font><font color="#E5E5E5"> host based</font>

1171
00:46:00,610 --> 00:46:05,500
logging it's still really important to

1172
00:46:02,170 --> 00:46:08,770
log on the network<font color="#E5E5E5"> so in</font><font color="#CCCCCC"> in my</font><font color="#E5E5E5"> previous</font>

1173
00:46:05,500 --> 00:46:10,950
life doing<font color="#E5E5E5"> IR</font><font color="#CCCCCC"> I was an unapologetic bro</font>

1174
00:46:08,770 --> 00:46:14,830
<font color="#E5E5E5">fanboy how many people use bro</font>

1175
00:46:10,950 --> 00:46:16,720
yeah<font color="#CCCCCC"> so if you're</font><font color="#E5E5E5"> doing network</font>

1176
00:46:14,830 --> 00:46:18,790
monitoring<font color="#E5E5E5"> or network forensics and</font>

1177
00:46:16,720 --> 00:46:22,120
you're not using bro it's my opinion

1178
00:46:18,790 --> 00:46:24,130
that<font color="#E5E5E5"> you're doing it wrong</font><font color="#CCCCCC"> bro is</font>

1179
00:46:22,120 --> 00:46:26,020
there's no<font color="#E5E5E5"> other</font><font color="#CCCCCC"> from</font><font color="#E5E5E5"> you know a</font>

1180
00:46:24,130 --> 00:46:28,090
commercial product that's even like it

1181
00:46:26,020 --> 00:46:29,860
well except for the<font color="#E5E5E5"> guys that now I</font>

1182
00:46:28,090 --> 00:46:32,320
guess the bro authors do have an

1183
00:46:29,860 --> 00:46:34,950
appliance<font color="#E5E5E5"> so that's not entirely true</font>

1184
00:46:32,320 --> 00:46:37,300
now but<font color="#CCCCCC"> you can still</font><font color="#E5E5E5"> do it open source</font>

1185
00:46:34,950 --> 00:46:40,600
<font color="#E5E5E5">and so out of the box it's sort of like</font>

1186
00:46:37,300 --> 00:46:43,330
running<font color="#E5E5E5"> a text-based Wireshark</font><font color="#CCCCCC"> on your</font>

1187
00:46:40,600 --> 00:46:45,220
network and<font color="#E5E5E5"> default protocols or common</font>

1188
00:46:43,330 --> 00:46:48,009
protocols or just log to<font color="#E5E5E5"> text file</font><font color="#CCCCCC"> you</font>

1189
00:46:45,220 --> 00:46:49,270
get usually when you first see a bro log

1190
00:46:48,010 --> 00:46:52,750
and what's actually<font color="#E5E5E5"> running on your</font>

1191
00:46:49,270 --> 00:46:55,060
network<font color="#CCCCCC"> you</font><font color="#E5E5E5"> got to get up walk away from</font>

1192
00:46:52,750 --> 00:46:56,790
the<font color="#E5E5E5"> computer</font><font color="#CCCCCC"> take a little break come</font>

1193
00:46:55,060 --> 00:47:00,190
back<font color="#CCCCCC"> you look</font><font color="#E5E5E5"> again you're like what in</font>

1194
00:46:56,790 --> 00:47:03,430
what is this<font color="#E5E5E5"> it's an eye-opening</font>

1195
00:47:00,190 --> 00:47:06,400
experience<font color="#E5E5E5"> and also you know it can</font>

1196
00:47:03,430 --> 00:47:08,680
provide some can provide some visibility

1197
00:47:06,400 --> 00:47:10,150
<font color="#E5E5E5">the visibility into SSL you can like</font>

1198
00:47:08,680 --> 00:47:12,009
start doing something<font color="#CCCCCC"> like SSL</font>

1199
00:47:10,150 --> 00:47:13,840
fingerprinting where if an attacker is

1200
00:47:12,010 --> 00:47:16,570
<font color="#CCCCCC">using encrypted</font><font color="#E5E5E5"> traffic if they're using</font>

1201
00:47:13,840 --> 00:47:18,700
<font color="#CCCCCC">HTTPS you know unless you're breaking</font>

1202
00:47:16,570 --> 00:47:21,250
<font color="#CCCCCC">HTTP</font><font color="#E5E5E5"> you know you might</font><font color="#CCCCCC"> think that</font>

1203
00:47:18,700 --> 00:47:24,279
there's limited<font color="#E5E5E5"> visibility there you can</font>

1204
00:47:21,250 --> 00:47:27,880
use something<font color="#E5E5E5"> like ja3 from Salesforce</font>

1205
00:47:24,280 --> 00:47:30,550
<font color="#E5E5E5">to fingerprint SSL</font><font color="#CCCCCC"> Certificates and it's</font>

1206
00:47:27,880 --> 00:47:32,620
actually if certificates used for

1207
00:47:30,550 --> 00:47:34,180
malware<font color="#CCCCCC"> look a lot different than</font>

1208
00:47:32,620 --> 00:47:36,490
certificates used for people<font color="#CCCCCC"> actually</font>

1209
00:47:34,180 --> 00:47:38,109
<font color="#E5E5E5">just browsing</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> Internet and then</font>

1210
00:47:36,490 --> 00:47:41,589
there's a project<font color="#CCCCCC"> that we have for free</font>

1211
00:47:38,110 --> 00:47:43,450
<font color="#E5E5E5">as well called</font><font color="#CCCCCC"> Rito</font><font color="#E5E5E5"> and what that will</font>

1212
00:47:41,590 --> 00:47:46,150
<font color="#E5E5E5">do</font><font color="#CCCCCC"> is it'll take bro logs and</font><font color="#E5E5E5"> ingest</font>

1213
00:47:43,450 --> 00:47:48,250
them and look for beacons<font color="#E5E5E5"> inside of the</font>

1214
00:47:46,150 --> 00:47:50,020
traffic so it looks for you know

1215
00:47:48,250 --> 00:47:51,460
essentially<font color="#E5E5E5"> a machine traffic being</font>

1216
00:47:50,020 --> 00:47:53,170
generated for something like malware

1217
00:47:51,460 --> 00:47:57,930
although Windows updates look like

1218
00:47:53,170 --> 00:48:00,480
malware<font color="#CCCCCC"> too maybe they are malware</font>

1219
00:47:57,930 --> 00:48:02,040
so if something's beaconing in your

1220
00:48:00,480 --> 00:48:03,390
<font color="#E5E5E5">network it might not be bad but it might</font>

1221
00:48:02,040 --> 00:48:06,630
be something<font color="#CCCCCC"> that you</font><font color="#E5E5E5"> need to go take</font><font color="#CCCCCC"> a</font>

1222
00:48:03,390 --> 00:48:09,990
<font color="#E5E5E5">look at and so the whole point of this</font>

1223
00:48:06,630 --> 00:48:12,119
talk was for us<font color="#E5E5E5"> to tell you to become a</font>

1224
00:48:09,990 --> 00:48:15,598
Red Team prepper<font color="#CCCCCC"> take these</font><font color="#E5E5E5"> things and</font>

1225
00:48:12,119 --> 00:48:16,349
go<font color="#E5E5E5"> figure out how to implement them in</font>

1226
00:48:15,599 --> 00:48:18,000
your<font color="#E5E5E5"> environment</font>

1227
00:48:16,349 --> 00:48:19,859
there's a<font color="#CCCCCC"> number of</font><font color="#E5E5E5"> resources that</font><font color="#CCCCCC"> you</font>

1228
00:48:18,000 --> 00:48:22,470
<font color="#CCCCCC">can use</font><font color="#E5E5E5"> like</font><font color="#CCCCCC"> the mitre attack framework</font>

1229
00:48:19,859 --> 00:48:24,990
<font color="#E5E5E5">red canary is now kind</font><font color="#CCCCCC"> of automating</font>

1230
00:48:22,470 --> 00:48:26,459
some<font color="#CCCCCC"> of the</font><font color="#E5E5E5"> mitre attack framework and</font>

1231
00:48:24,990 --> 00:48:29,790
you<font color="#E5E5E5"> can start testing to see</font><font color="#CCCCCC"> if your</font>

1232
00:48:26,460 --> 00:48:31,410
detection capabilities will find some<font color="#E5E5E5"> of</font>

1233
00:48:29,790 --> 00:48:34,140
these attacks<font color="#CCCCCC"> I find what the</font>

1234
00:48:31,410 --> 00:48:36,990
<font color="#E5E5E5">nation-state actors are doing</font><font color="#CCCCCC"> and by the</font>

1235
00:48:34,140 --> 00:48:44,240
time you<font color="#E5E5E5"> have that red team come perhaps</font>

1236
00:48:36,990 --> 00:48:44,240
you will catch them that is it so

1237
00:48:48,780 --> 00:48:50,840
you

