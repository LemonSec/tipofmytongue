1
00:00:19,789 --> 00:00:27,300
so my<font color="#CCCCCC"> name is juan cortez title my talk</font>

2
00:00:23,910 --> 00:00:28,380
is reversing for humans hopefully<font color="#CCCCCC"> i'll</font>

3
00:00:27,300 --> 00:00:31,140
talk about<font color="#E5E5E5"> a little bit more what</font><font color="#CCCCCC"> i'm</font>

4
00:00:28,380 --> 00:00:33,510
going<font color="#E5E5E5"> to talk about the outline the</font>

5
00:00:31,140 --> 00:00:36,900
whole purpose of this<font color="#CCCCCC"> talk and whatnot</font>

6
00:00:33,510 --> 00:00:39,180
so that's a title here's<font color="#E5E5E5"> the outline for</font>

7
00:00:36,900 --> 00:00:43,589
today we're gonna a<font color="#E5E5E5"> little bit about me</font>

8
00:00:39,180 --> 00:00:45,030
really<font color="#E5E5E5"> quick intro quick sight of why we</font>

9
00:00:43,589 --> 00:00:48,930
<font color="#E5E5E5">were bursting so why we're interested in</font>

10
00:00:45,030 --> 00:00:51,360
reversing the purpose kind<font color="#E5E5E5"> of a malware</font>

11
00:00:48,930 --> 00:00:55,229
intro just what is malware with type

12
00:00:51,360 --> 00:00:57,269
mowers out there<font color="#CCCCCC"> very quick times time</font>

13
00:00:55,229 --> 00:00:59,159
stem like super fast I mean<font color="#CCCCCC"> obviously we</font>

14
00:00:57,269 --> 00:01:00,839
<font color="#E5E5E5">all know what malware is so hopefully</font>

15
00:00:59,159 --> 00:01:03,360
<font color="#E5E5E5">we'll just quick intro just to make sure</font>

16
00:01:00,839 --> 00:01:05,960
we're<font color="#E5E5E5"> all on the same</font><font color="#CCCCCC"> page and there's a</font>

17
00:01:03,360 --> 00:01:05,960
feedback<font color="#E5E5E5"> okay</font>

18
00:01:08,770 --> 00:01:14,630
hello<font color="#E5E5E5"> okay so and then we'll talk a bit</font>

19
00:01:12,170 --> 00:01:16,250
<font color="#E5E5E5">about tools that I'll be using for kind</font>

20
00:01:14,630 --> 00:01:18,530
of the demos and just tools that i use

21
00:01:16,250 --> 00:01:20,570
on<font color="#E5E5E5"> day-to-day basis and then we'll do</font>

22
00:01:18,530 --> 00:01:21,890
some reversing time some actual demos

23
00:01:20,570 --> 00:01:24,710
hopefully it works out with the

24
00:01:21,890 --> 00:01:27,130
resolution and I practice the demo so

25
00:01:24,710 --> 00:01:30,408
hopefully they don't break but we'll see

26
00:01:27,130 --> 00:01:33,619
so I'm am our research shirt and

27
00:01:30,409 --> 00:01:34,970
reversed I palo alto networks<font color="#CCCCCC"> i'll leave</font>

28
00:01:33,619 --> 00:01:37,810
it at that you<font color="#E5E5E5"> can want to know more</font>

29
00:01:34,970 --> 00:01:40,000
just come talk<font color="#CCCCCC"> to me I love red bull</font>

30
00:01:37,810 --> 00:01:42,890
chocolate-covered espresso beans and

31
00:01:40,000 --> 00:01:48,289
assembly and learning so you have any of

32
00:01:42,890 --> 00:01:51,200
those things we can<font color="#E5E5E5"> be friends so quick</font>

33
00:01:48,289 --> 00:01:53,840
intro person is hard to some people

34
00:01:51,200 --> 00:01:55,940
write a lot<font color="#E5E5E5"> of people love it for</font><font color="#CCCCCC"> case i</font>

35
00:01:53,840 --> 00:01:57,979
love i love doing it<font color="#E5E5E5"> i have the patience</font>

36
00:01:55,940 --> 00:02:00,560
<font color="#E5E5E5">i guess sit down</font><font color="#CCCCCC"> and look at this</font>

37
00:01:57,979 --> 00:02:04,610
assembly and debug something for a few

38
00:02:00,560 --> 00:02:06,380
hours<font color="#E5E5E5"> maybe even days some people are</font>

39
00:02:04,610 --> 00:02:08,149
really really<font color="#CCCCCC"> good at it super fast at</font>

40
00:02:06,380 --> 00:02:11,120
it under just understand how things work

41
00:02:08,149 --> 00:02:14,030
and and you<font color="#CCCCCC"> know those those guys or</font>

42
00:02:11,120 --> 00:02:17,150
girls<font color="#E5E5E5"> just amazing and what they do but</font>

43
00:02:14,030 --> 00:02:18,920
it's definitely learnable I've learned

44
00:02:17,150 --> 00:02:21,290
it from the<font color="#E5E5E5"> ground up so in college on</font>

45
00:02:18,920 --> 00:02:23,480
the grad I hated programming just at all

46
00:02:21,290 --> 00:02:25,820
<font color="#E5E5E5">just hated it I'd never touched</font>

47
00:02:23,480 --> 00:02:27,380
programming at all in college and then

48
00:02:25,820 --> 00:02:29,510
as<font color="#E5E5E5"> you know things went on and things</font>

49
00:02:27,380 --> 00:02:31,850
evolved obviously you know<font color="#CCCCCC"> I had to</font>

50
00:02:29,510 --> 00:02:33,608
learn see how to learn something<font color="#E5E5E5"> things</font>

51
00:02:31,850 --> 00:02:36,160
like that so it's definitely doable

52
00:02:33,609 --> 00:02:38,959
second of a wide reverse it there's a

53
00:02:36,160 --> 00:02:41,120
emoji poop load of malware out there so

54
00:02:38,959 --> 00:02:44,450
there's a lot<font color="#CCCCCC"> of it to</font><font color="#E5E5E5"> look at a lot of</font>

55
00:02:41,120 --> 00:02:45,920
it<font color="#E5E5E5"> analyzed is kind of really</font><font color="#CCCCCC"> just kind</font>

56
00:02:44,450 --> 00:02:47,298
of pick what you want to look at and

57
00:02:45,920 --> 00:02:49,399
basically we all want<font color="#E5E5E5"> to save the</font><font color="#CCCCCC"> world</font>

58
00:02:47,299 --> 00:02:51,440
and then you know<font color="#E5E5E5"> we drink coffee to do</font>

59
00:02:49,400 --> 00:02:53,810
<font color="#CCCCCC">something</font><font color="#E5E5E5"> things faster with both energy</font>

60
00:02:51,440 --> 00:02:59,420
<font color="#E5E5E5">which I did not have</font><font color="#CCCCCC"> my red ball today</font>

61
00:02:53,810 --> 00:03:01,070
so so why don't we reverse things oh so

62
00:02:59,420 --> 00:03:02,869
reverse engineering kind of if I nobody

63
00:03:01,070 --> 00:03:04,160
knows what it<font color="#CCCCCC"> is is well i'll give you</font>

64
00:03:02,870 --> 00:03:06,620
the webster dictionary there is

65
00:03:04,160 --> 00:03:08,870
disassembled in examine or<font color="#CCCCCC"> analyze in</font>

66
00:03:06,620 --> 00:03:11,480
detail to discover the concepts involved

67
00:03:08,870 --> 00:03:13,190
in manufacturing usually in order to

68
00:03:11,480 --> 00:03:15,619
produce something similar that's a lot

69
00:03:13,190 --> 00:03:17,060
<font color="#CCCCCC">of words</font><font color="#E5E5E5"> basically my initials in my</font>

70
00:03:15,620 --> 00:03:17,960
dictionary is figure out what thing is

71
00:03:17,060 --> 00:03:20,030
doing what think so

72
00:03:17,960 --> 00:03:22,490
usually when I do it reverse a sample I

73
00:03:20,030 --> 00:03:24,200
try to look<font color="#E5E5E5"> at what specific thing is</font>

74
00:03:22,490 --> 00:03:26,510
doing what big so<font color="#CCCCCC"> that I can produce</font>

75
00:03:24,200 --> 00:03:29,480
results or some sort of answer to

76
00:03:26,510 --> 00:03:31,250
whoever wants me or ever wants that

77
00:03:29,480 --> 00:03:34,459
answer to reverse or if it's me or

78
00:03:31,250 --> 00:03:37,430
somebody else in my other in my team and

79
00:03:34,460 --> 00:03:39,350
then<font color="#E5E5E5"> actually this the other one is it</font>

80
00:03:37,430 --> 00:03:42,470
should be part of your instant response

81
00:03:39,350 --> 00:03:44,329
point underline and bold at your because

82
00:03:42,470 --> 00:03:46,280
everybody has their own unique plan

83
00:03:44,330 --> 00:03:47,600
their own unique well come from

84
00:03:46,280 --> 00:03:49,780
different industries different

85
00:03:47,600 --> 00:03:52,160
backgrounds we have different threats

86
00:03:49,780 --> 00:03:54,770
different components in our network so<font color="#E5E5E5"> I</font>

87
00:03:52,160 --> 00:03:57,410
just strongly believe it should be part

88
00:03:54,770 --> 00:04:00,530
of your incident response plan somewhere

89
00:03:57,410 --> 00:04:02,510
in there it should be<font color="#E5E5E5"> some sort of you</font>

90
00:04:00,530 --> 00:04:04,220
know reverse the sample or some sort of

91
00:04:02,510 --> 00:04:06,260
threat they came into<font color="#E5E5E5"> your network that</font>

92
00:04:04,220 --> 00:04:08,090
race alerts raise flags that you know

93
00:04:06,260 --> 00:04:12,470
you should<font color="#CCCCCC"> be able to really understand</font>

94
00:04:08,090 --> 00:04:13,790
what it's doing and then basically for

95
00:04:12,470 --> 00:04:15,680
me<font color="#CCCCCC"> I love reversing because it's a</font>

96
00:04:13,790 --> 00:04:18,170
challenge i like the puzzles I want to

97
00:04:15,680 --> 00:04:20,360
<font color="#E5E5E5">know what why how of an attackers code i</font>

98
00:04:18,170 --> 00:04:22,370
think<font color="#CCCCCC"> i'm</font><font color="#E5E5E5"> at my point in my career</font>

99
00:04:20,360 --> 00:04:25,790
bursting where<font color="#E5E5E5"> i can look at a piece of</font>

100
00:04:22,370 --> 00:04:27,980
code and quickly tell that the attacker

101
00:04:25,790 --> 00:04:30,320
was very shitty at writing your code

102
00:04:27,980 --> 00:04:32,480
didn't spent their time hiding it they

103
00:04:30,320 --> 00:04:34,940
didn't really<font color="#E5E5E5"> care if it was you know if</font>

104
00:04:32,480 --> 00:04:36,080
it was wonderful at all sometimes so and

105
00:04:34,940 --> 00:04:37,490
then there's times where<font color="#CCCCCC"> you find the</font>

106
00:04:36,080 --> 00:04:40,609
attacker<font color="#CCCCCC"> that has code is very</font>

107
00:04:37,490 --> 00:04:42,740
sophisticated takes the time makes my

108
00:04:40,610 --> 00:04:44,090
job harder and a lot more<font color="#E5E5E5"> fun and then</font>

109
00:04:42,740 --> 00:04:46,340
obviously it is slow and stop their

110
00:04:44,090 --> 00:04:47,869
badness basically though at the end

111
00:04:46,340 --> 00:04:51,140
though<font color="#CCCCCC"> i think it's a cat-and-mouse game</font>

112
00:04:47,870 --> 00:04:53,690
totally Batman and Joker relationship

113
00:04:51,140 --> 00:04:56,330
I'm not<font color="#E5E5E5"> saying</font><font color="#CCCCCC"> that man we should exist</font>

114
00:04:53,690 --> 00:04:58,570
in order for us to have jobs but you

115
00:04:56,330 --> 00:05:01,370
know if<font color="#E5E5E5"> somebody has the solution to</font>

116
00:04:58,570 --> 00:05:03,409
completely stop my work<font color="#E5E5E5"> I am you know I</font>

117
00:05:01,370 --> 00:05:05,930
would be without the job but<font color="#E5E5E5"> I know it's</font>

118
00:05:03,410 --> 00:05:08,840
I love to be part of that solution but

119
00:05:05,930 --> 00:05:11,960
for<font color="#CCCCCC"> now it's a cat-and-mouse game you</font>

120
00:05:08,840 --> 00:05:14,630
know malware lives I live I live malware

121
00:05:11,960 --> 00:05:17,840
lips etc so and the way that works is

122
00:05:14,630 --> 00:05:20,780
obviously I I find Bauer that tries to

123
00:05:17,840 --> 00:05:23,080
<font color="#E5E5E5">evade either sandboxing or anti analysis</font>

124
00:05:20,780 --> 00:05:25,489
anti debugging techniques we try to

125
00:05:23,080 --> 00:05:27,140
obviously<font color="#E5E5E5"> we fix those we alleviate</font>

126
00:05:25,490 --> 00:05:28,280
those and somehow attackers find a

127
00:05:27,140 --> 00:05:30,890
different way so it's always back and

128
00:05:28,280 --> 00:05:31,869
forth kind of thing so the goal for

129
00:05:30,890 --> 00:05:35,900
<font color="#CCCCCC">today</font>

130
00:05:31,870 --> 00:05:38,570
is to help you yeah that worked also

131
00:05:35,900 --> 00:05:40,190
it's a hub you<font color="#E5E5E5"> reverse faster not to the</font>

132
00:05:38,570 --> 00:05:42,260
point where we cut off arms at our

133
00:05:40,190 --> 00:05:45,020
keyboards but hopefully be able more

134
00:05:42,260 --> 00:05:46,520
efficient in being able to<font color="#E5E5E5"> analyze a</font>

135
00:05:45,020 --> 00:05:49,210
sample be able to<font color="#E5E5E5"> provide answers</font>

136
00:05:46,520 --> 00:05:51,500
quickly and then basically the whole

137
00:05:49,210 --> 00:05:55,219
basically kind of where this idea came

138
00:05:51,500 --> 00:05:56,900
from is hope you reverses help you so I

139
00:05:55,220 --> 00:05:59,690
forgot to answer a question who actually

140
00:05:56,900 --> 00:06:01,580
reverse years for a<font color="#CCCCCC"> full time job</font><font color="#E5E5E5"> sig</font>

141
00:05:59,690 --> 00:06:04,510
buddy<font color="#CCCCCC"> reverse like is that part of their</font>

142
00:06:01,580 --> 00:06:07,550
title part of the day-to-day jobs nobody

143
00:06:04,510 --> 00:06:11,570
<font color="#CCCCCC">okay well hopefully the demos are not</font>

144
00:06:07,550 --> 00:06:14,210
too too too daunting who has reverses

145
00:06:11,570 --> 00:06:16,820
that<font color="#E5E5E5"> help you guys reverse stuff</font><font color="#CCCCCC"> okay so</font>

146
00:06:14,210 --> 00:06:19,370
we have one couple people go so then

147
00:06:16,820 --> 00:06:21,260
this this is kind of<font color="#CCCCCC"> my goal to you guys</font>

148
00:06:19,370 --> 00:06:23,600
and you know everybody else can we all

149
00:06:21,260 --> 00:06:26,810
can learn together but is so we have a

150
00:06:23,600 --> 00:06:30,020
team at<font color="#E5E5E5"> Palo Alto and we have four sub T</font>

151
00:06:26,810 --> 00:06:31,760
sub teams I'm with<font color="#E5E5E5"> the reversing team</font>

152
00:06:30,020 --> 00:06:33,500
and then we have a threat until team 30

153
00:06:31,760 --> 00:06:35,450
<font color="#E5E5E5">until team does a lot of very basic</font>

154
00:06:33,500 --> 00:06:38,810
analysis<font color="#E5E5E5"> stuff finds all the cool stuff</font>

155
00:06:35,450 --> 00:06:40,310
to look at and then they don't<font color="#E5E5E5"> usually</font>

156
00:06:38,810 --> 00:06:42,050
find a sample that they can't reverse

157
00:06:40,310 --> 00:06:43,850
these it has the decoding algorithm or

158
00:06:42,050 --> 00:06:46,160
just by passing or sandbox or bypassing

159
00:06:43,850 --> 00:06:48,260
all sandbox but it just doesn't execute

160
00:06:46,160 --> 00:06:49,760
in their vm so then they give it<font color="#CCCCCC"> to us</font>

161
00:06:48,260 --> 00:06:51,950
and<font color="#CCCCCC"> that's when we have the fun stuff so</font>

162
00:06:49,760 --> 00:06:54,800
what<font color="#CCCCCC"> I</font><font color="#E5E5E5"> mean by help you reverses help</font>

163
00:06:51,950 --> 00:06:57,170
you is<font color="#E5E5E5"> not ready until team has a very</font>

164
00:06:54,800 --> 00:06:59,870
specific template of what information<font color="#CCCCCC"> to</font>

165
00:06:57,170 --> 00:07:02,240
give us in order<font color="#E5E5E5"> for us to give</font><font color="#CCCCCC"> them</font>

166
00:06:59,870 --> 00:07:03,650
answers faster and<font color="#E5E5E5"> we'll see that and</font>

167
00:07:02,240 --> 00:07:05,360
then<font color="#E5E5E5"> obviously they get better all</font>

168
00:07:03,650 --> 00:07:10,940
better all things<font color="#E5E5E5"> just to step our game</font>

169
00:07:05,360 --> 00:07:12,950
up and be be good<font color="#E5E5E5"> at reversing stuff so</font>

170
00:07:10,940 --> 00:07:16,520
<font color="#E5E5E5">going back</font><font color="#CCCCCC"> to that goal we're helping</font>

171
00:07:12,950 --> 00:07:18,409
you reverse help you yeah kind of the

172
00:07:16,520 --> 00:07:21,080
<font color="#CCCCCC">idea there is no what to actually</font>

173
00:07:18,410 --> 00:07:23,240
reverses for so you go to example you

174
00:07:21,080 --> 00:07:25,550
have an<font color="#E5E5E5"> example a sample that you want</font>

175
00:07:23,240 --> 00:07:28,130
<font color="#E5E5E5">to analyze make</font><font color="#CCCCCC"> sure you give them some</font>

176
00:07:25,550 --> 00:07:30,410
sort of ideas some sort<font color="#E5E5E5"> of story behind</font>

177
00:07:28,130 --> 00:07:32,690
it right this comes<font color="#CCCCCC"> with the context the</font>

178
00:07:30,410 --> 00:07:34,490
more is better I love story<font color="#E5E5E5"> time I love</font>

179
00:07:32,690 --> 00:07:36,920
it when somebody tells me look this<font color="#E5E5E5"> is</font>

180
00:07:34,490 --> 00:07:38,810
worth on the sample I found<font color="#E5E5E5"> it here it's</font>

181
00:07:36,920 --> 00:07:41,000
doing this doing that but I can't figure

182
00:07:38,810 --> 00:07:42,860
out this<font color="#E5E5E5"> exact thing I I just enjoy that</font>

183
00:07:41,000 --> 00:07:43,800
<font color="#E5E5E5">because I know what he has already he or</font>

184
00:07:42,860 --> 00:07:46,169
she already

185
00:07:43,800 --> 00:07:48,180
done for<font color="#E5E5E5"> the sample I already know that</font>

186
00:07:46,169 --> 00:07:49,889
<font color="#E5E5E5">you take steps 1 2</font><font color="#CCCCCC"> & 3 to kind of solve</font>

187
00:07:48,180 --> 00:07:51,870
it but you couldn't because there's

188
00:07:49,889 --> 00:07:54,449
other hard stuff<font color="#CCCCCC"> to look at and then</font>

189
00:07:51,870 --> 00:07:56,940
we'll get back to what i mean by offsets

190
00:07:54,449 --> 00:08:02,129
offices and offsets well circle back to

191
00:07:56,940 --> 00:08:03,449
<font color="#E5E5E5">it and this is sort of the</font><font color="#CCCCCC"> other goal so</font>

192
00:08:02,129 --> 00:08:05,940
this is and what come back to this is

193
00:08:03,449 --> 00:08:09,419
actually one of the demos that will walk

194
00:08:05,940 --> 00:08:11,940
through so this<font color="#CCCCCC"> is just I'm sorry that</font>

195
00:08:09,419 --> 00:08:14,190
kid really<font color="#E5E5E5"> no um this is</font><font color="#CCCCCC"> the idea of</font>

196
00:08:11,940 --> 00:08:15,900
what my buddy sends me when he wants me

197
00:08:14,190 --> 00:08:19,770
to reverse something for him right he

198
00:08:15,900 --> 00:08:21,840
sends<font color="#CCCCCC"> me at exile exe name the yellow</font>

199
00:08:19,770 --> 00:08:25,080
and<font color="#E5E5E5"> tells me all these offsets is what I</font>

200
00:08:21,840 --> 00:08:27,179
be my opposites and then tells me where

201
00:08:25,080 --> 00:08:29,310
he stuck it right and then at the<font color="#CCCCCC"> end</font>

202
00:08:27,180 --> 00:08:30,840
it's<font color="#E5E5E5"> not an offset but he does shuffle</font>

203
00:08:29,310 --> 00:08:32,789
things so he understands that it does

204
00:08:30,840 --> 00:08:34,260
shellcode thinks that helps me<font color="#E5E5E5"> to</font>

205
00:08:32,789 --> 00:08:36,208
understand the sample better and be able

206
00:08:34,260 --> 00:08:38,819
<font color="#E5E5E5">to you know to analyze it quickly and</font>

207
00:08:36,208 --> 00:08:41,159
focus on the things that that he he

208
00:08:38,820 --> 00:08:42,300
wants me to<font color="#E5E5E5"> get answers</font><font color="#CCCCCC"> for and I</font><font color="#E5E5E5"> just</font>

209
00:08:41,159 --> 00:08:43,979
love them for that and I love<font color="#E5E5E5"> anybody</font>

210
00:08:42,299 --> 00:08:47,010
that gives me that<font color="#CCCCCC"> information quickly</font>

211
00:08:43,979 --> 00:08:51,480
and then so circling back to what now

212
00:08:47,010 --> 00:08:53,100
where is so its members just short of

213
00:08:51,480 --> 00:08:54,240
malicious software general temperature

214
00:08:53,100 --> 00:08:57,360
<font color="#CCCCCC">described all forms of malicious</font>

215
00:08:54,240 --> 00:09:02,010
software<font color="#E5E5E5"> where inspires back doors or</font>

216
00:08:57,360 --> 00:09:05,579
<font color="#E5E5E5">Trojans and then regex example they ran</font>

217
00:09:02,010 --> 00:09:07,050
some spy a scare where so you know and

218
00:09:05,579 --> 00:09:09,989
then in dinner and it's dangerous

219
00:09:07,050 --> 00:09:12,990
<font color="#E5E5E5">careful but we'll leave it at that and</font>

220
00:09:09,990 --> 00:09:15,450
<font color="#E5E5E5">then malware is like I mentioned put</font>

221
00:09:12,990 --> 00:09:19,320
simply favorites so it<font color="#E5E5E5"> has windows OSX</font>

222
00:09:15,450 --> 00:09:22,370
android/ios and Linux so basically

223
00:09:19,320 --> 00:09:25,680
figure poison dive in and learn it

224
00:09:22,370 --> 00:09:29,449
mainly windows in analyzing I've<font color="#E5E5E5"> started</font>

225
00:09:25,680 --> 00:09:31,739
working with android stuff so again just

226
00:09:29,449 --> 00:09:33,959
<font color="#E5E5E5">whatever you want to learn you just take</font>

227
00:09:31,740 --> 00:09:37,520
to it so my mandatory graph slide for

228
00:09:33,959 --> 00:09:40,890
the<font color="#E5E5E5"> talk is this graph from the verizon</font>

229
00:09:37,520 --> 00:09:42,980
report this year bad news this year i

230
00:09:40,890 --> 00:09:45,569
wish i had a pointer but<font color="#E5E5E5"> the red light</font>

231
00:09:42,980 --> 00:09:48,120
nobody<font color="#CCCCCC"> like the red line is the one</font><font color="#E5E5E5"> that</font>

232
00:09:45,570 --> 00:09:50,760
says the number breaches / threat

233
00:09:48,120 --> 00:09:52,970
category over time so the red one is the

234
00:09:50,760 --> 00:09:54,769
Mauer so it's definitely top out there

235
00:09:52,970 --> 00:09:56,480
so my words<font color="#E5E5E5"> out there we definitely</font>

236
00:09:54,769 --> 00:10:03,050
should pay attention do something about

237
00:09:56,480 --> 00:10:05,750
it then so we'll talk<font color="#E5E5E5"> about tools so the</font>

238
00:10:03,050 --> 00:10:11,779
reason<font color="#E5E5E5"> I picked this this slide is here</font>

239
00:10:05,750 --> 00:10:13,160
let me get<font color="#E5E5E5"> someone so that you know i</font>

240
00:10:11,779 --> 00:10:14,449
love tools i love scripts a lot of

241
00:10:13,160 --> 00:10:15,860
<font color="#CCCCCC">people that right tools and there's a</font>

242
00:10:14,449 --> 00:10:18,740
lot<font color="#CCCCCC"> of open source tools that I use that</font>

243
00:10:15,860 --> 00:10:21,860
<font color="#E5E5E5">I would not I would make my job harder</font>

244
00:10:18,740 --> 00:10:23,569
without them so I really appreciate

245
00:10:21,860 --> 00:10:25,160
tools but the same time I feel<font color="#E5E5E5"> like</font>

246
00:10:23,569 --> 00:10:26,719
other people use tools that don't we

247
00:10:25,160 --> 00:10:29,120
understand what they're doing or they

248
00:10:26,720 --> 00:10:31,939
want<font color="#CCCCCC"> to lay to give them some sort of</font>

249
00:10:29,120 --> 00:10:33,790
output that's not there so in order<font color="#CCCCCC"> you</font>

250
00:10:31,939 --> 00:10:38,449
know point being understand your tools

251
00:10:33,790 --> 00:10:41,240
let's<font color="#E5E5E5"> not beat those guys so for</font>

252
00:10:38,449 --> 00:10:42,829
reversing malware basically falls out in

253
00:10:41,240 --> 00:10:45,529
<font color="#E5E5E5">two categories that you have your static</font>

254
00:10:42,829 --> 00:10:47,779
and you have your dynamic tools the way

255
00:10:45,529 --> 00:10:49,910
I formed this slide was so the static

256
00:10:47,779 --> 00:10:51,709
side you have the icons I do mostly

257
00:10:49,910 --> 00:10:53,930
static and then on the other side the

258
00:10:51,709 --> 00:10:55,910
<font color="#E5E5E5">dynamic tools that do dynamic analysis</font>

259
00:10:53,930 --> 00:10:58,910
and<font color="#E5E5E5"> it's sort of the middle or tools</font>

260
00:10:55,910 --> 00:11:00,500
<font color="#CCCCCC">that kind of</font><font color="#E5E5E5"> use for both we won't walk</font>

261
00:10:58,910 --> 00:11:03,969
through all these tools<font color="#E5E5E5"> and how what</font>

262
00:11:00,500 --> 00:11:07,519
they do and what they don't do I think

263
00:11:03,970 --> 00:11:10,730
pretty familiar<font color="#E5E5E5"> with most of them</font><font color="#CCCCCC"> Ida</font>

264
00:11:07,519 --> 00:11:13,279
pro everybody knows iOS regard to is a

265
00:11:10,730 --> 00:11:16,790
reversion framework has a lot of sub

266
00:11:13,279 --> 00:11:20,180
tools in it s command line based so it's

267
00:11:16,790 --> 00:11:21,740
<font color="#E5E5E5">very good it's a</font><font color="#CCCCCC"> takes a very</font><font color="#E5E5E5"> huge</font>

268
00:11:20,180 --> 00:11:23,449
learning curve to learn but it's cup and

269
00:11:21,740 --> 00:11:26,120
coming it's kind of competing what I

270
00:11:23,449 --> 00:11:28,219
doubt but not there yet p studios for

271
00:11:26,120 --> 00:11:30,350
anybody's used it before very cool

272
00:11:28,220 --> 00:11:32,000
static analysis<font color="#CCCCCC"> tool it's very quick</font>

273
00:11:30,350 --> 00:11:34,189
triage way to kind of look at AP file

274
00:11:32,000 --> 00:11:36,949
and quickly understand kind<font color="#E5E5E5"> of grab</font>

275
00:11:34,189 --> 00:11:39,170
things to hook on and then deep dive in

276
00:11:36,949 --> 00:11:42,378
something else detect easy he's been

277
00:11:39,170 --> 00:11:44,029
replacing my<font color="#CCCCCC"> toolset replacing PID so</font>

278
00:11:42,379 --> 00:11:46,189
kind of detect the compiler to type the

279
00:11:44,029 --> 00:11:50,029
linker that it was used<font color="#E5E5E5"> for that sample</font>

280
00:11:46,189 --> 00:11:52,219
<font color="#CCCCCC">in C cords it has multiple tools in it</font>

281
00:11:50,029 --> 00:11:56,139
but I really<font color="#CCCCCC"> only use CFS</font><font color="#E5E5E5"> explorer it's</font>

282
00:11:52,220 --> 00:11:59,569
a<font color="#CCCCCC"> P file format extractor or parser and</font>

283
00:11:56,139 --> 00:12:00,889
then a pay monitor you don't know if

284
00:11:59,569 --> 00:12:02,929
anybody use that before but just

285
00:12:00,889 --> 00:12:04,759
basically hooks all the windows api

286
00:12:02,929 --> 00:12:06,930
calls that you can think of and<font color="#E5E5E5"> it spits</font>

287
00:12:04,759 --> 00:12:08,910
<font color="#E5E5E5">mile back to you both so we run a sample</font>

288
00:12:06,930 --> 00:12:11,399
with it it tells you all the windows api

289
00:12:08,910 --> 00:12:13,140
calls<font color="#CCCCCC"> it gets</font><font color="#E5E5E5"> called it's good for</font>

290
00:12:11,399 --> 00:12:15,300
tracing what the mauers doing sometimes

291
00:12:13,140 --> 00:12:18,000
figure out what<font color="#E5E5E5"> api call it's</font>

292
00:12:15,300 --> 00:12:21,599
interesting or calling that you're not

293
00:12:18,000 --> 00:12:24,450
aware of windows his internals<font color="#E5E5E5"> nobody</font>

294
00:12:21,600 --> 00:12:27,180
knows about that that's kind of<font color="#E5E5E5"> a</font><font color="#CCCCCC"> by</font>

295
00:12:24,450 --> 00:12:30,630
<font color="#E5E5E5">mark cool guy I love him I hope to meet</font>

296
00:12:27,180 --> 00:12:32,430
<font color="#E5E5E5">him one day</font><font color="#CCCCCC"> but he has different tools</font>

297
00:12:30,630 --> 00:12:34,800
in there that mostly aimed for like say

298
00:12:32,430 --> 00:12:36,959
Simon but he has kind of shifted those

299
00:12:34,800 --> 00:12:39,439
over to malware<font color="#E5E5E5"> analysis too so he</font>

300
00:12:36,959 --> 00:12:42,359
actually gives really great talks on

301
00:12:39,440 --> 00:12:44,010
malware analysis and using<font color="#E5E5E5"> his tools and</font>

302
00:12:42,360 --> 00:12:46,320
<font color="#E5E5E5">they're free up in technical I think so</font>

303
00:12:44,010 --> 00:12:49,830
pretty<font color="#CCCCCC"> good and fake Nick and I said</font>

304
00:12:46,320 --> 00:12:52,649
those<font color="#E5E5E5"> are tools for kind of emulating</font>

305
00:12:49,830 --> 00:12:55,050
network services I netsim runs and linux

306
00:12:52,649 --> 00:12:58,529
like that runs on windows by code viewer

307
00:12:55,050 --> 00:13:01,500
is a very cool toast kind of new has

308
00:12:58,529 --> 00:13:04,200
about three or four job at the compilers

309
00:13:01,500 --> 00:13:06,000
and by code disassembler so you can look

310
00:13:04,200 --> 00:13:08,970
at<font color="#CCCCCC"> Java code and look at the job of the</font>

311
00:13:06,000 --> 00:13:11,640
<font color="#CCCCCC">compile code side by side you can also</font>

312
00:13:08,970 --> 00:13:14,220
throw in a peek at it it compresses it

313
00:13:11,640 --> 00:13:17,670
and gives you all the<font color="#CCCCCC"> Java code in to</font>

314
00:13:14,220 --> 00:13:19,980
look<font color="#E5E5E5"> at and then the NS pie I don't know</font>

315
00:13:17,670 --> 00:13:22,380
who wrote<font color="#CCCCCC"> it I probably</font><font color="#E5E5E5"> should but that</font>

316
00:13:19,980 --> 00:13:25,200
guy is just amazing it's a<font color="#E5E5E5"> it's used for</font>

317
00:13:22,380 --> 00:13:27,480
debugging and disassembling dotnet

318
00:13:25,200 --> 00:13:30,270
samples so you throw it in there<font color="#CCCCCC"> and you</font>

319
00:13:27,480 --> 00:13:32,490
can debug net and it's just it's amazing

320
00:13:30,270 --> 00:13:35,279
tool so those<font color="#E5E5E5"> are kind of the day to day</font>

321
00:13:32,490 --> 00:13:38,459
toes that<font color="#E5E5E5"> I've used will touch probably</font>

322
00:13:35,279 --> 00:13:42,990
most<font color="#E5E5E5"> of these except for the ones in</font>

323
00:13:38,459 --> 00:13:48,029
Linux and no java stuff and no sono down

324
00:13:42,990 --> 00:13:52,709
in a demo so so reversing methodology

325
00:13:48,029 --> 00:13:54,839
and go so this<font color="#CCCCCC"> is kind of my eye I guess</font>

326
00:13:52,709 --> 00:13:57,420
idea how things get down my path in

327
00:13:54,839 --> 00:13:58,860
order to reverse something obviously

328
00:13:57,420 --> 00:14:00,779
again everybody comes<font color="#CCCCCC"> from different</font>

329
00:13:58,860 --> 00:14:02,040
backgrounds different industries but

330
00:14:00,779 --> 00:14:04,170
most of the time we'll have like a

331
00:14:02,040 --> 00:14:05,790
<font color="#E5E5E5">security event some sort of a</font><font color="#CCCCCC"> B firewall</font>

332
00:14:04,170 --> 00:14:09,110
notification something that comes up

333
00:14:05,790 --> 00:14:12,029
that raises a red flag<font color="#E5E5E5"> for us for us to</font>

334
00:14:09,110 --> 00:14:14,610
analyze<font color="#CCCCCC"> a</font><font color="#E5E5E5"> sample right which then we do</font>

335
00:14:12,029 --> 00:14:17,370
<font color="#E5E5E5">some basic static analysis we inspect</font>

336
00:14:14,610 --> 00:14:20,920
the P file we do public resources check

337
00:14:17,370 --> 00:14:23,860
by<font color="#CCCCCC"> total check google any public</font>

338
00:14:20,920 --> 00:14:25,420
sandbox report so we<font color="#E5E5E5"> can use another</font>

339
00:14:23,860 --> 00:14:27,550
thing I like to do if it's there's no

340
00:14:25,420 --> 00:14:30,729
reports you know hopefully fire starter

341
00:14:27,550 --> 00:14:33,189
has matching a<font color="#CCCCCC"> B names so I mean an Ivy</font>

342
00:14:30,730 --> 00:14:35,829
needs matching detection names you can

343
00:14:33,190 --> 00:14:37,209
<font color="#E5E5E5">kind of in google for that virus name</font>

344
00:14:35,829 --> 00:14:39,609
and kind of<font color="#E5E5E5"> get</font><font color="#CCCCCC"> an idea with it what it</font>

345
00:14:37,209 --> 00:14:41,469
is and would what it's doing you can

346
00:14:39,610 --> 00:14:44,380
<font color="#E5E5E5">then dive into dynamic can be here</font><font color="#CCCCCC"> one</font>

347
00:14:41,470 --> 00:14:46,360
Alice's so sandbox execution in<font color="#CCCCCC"> a vm so</font>

348
00:14:44,380 --> 00:14:49,420
executioner vm is your own vm sandbox is

349
00:14:46,360 --> 00:14:51,339
<font color="#E5E5E5">cuckoo hybrid analysis there's a few</font>

350
00:14:49,420 --> 00:14:53,170
other<font color="#CCCCCC"> ones out</font><font color="#E5E5E5"> there they're coming</font><font color="#CCCCCC"> up</font>

351
00:14:51,339 --> 00:14:55,420
there's this one<font color="#E5E5E5"> I just</font><font color="#CCCCCC"> signed</font><font color="#E5E5E5"> up for</font>

352
00:14:53,170 --> 00:14:57,550
and I've never heard of it they're

353
00:14:55,420 --> 00:14:59,349
actually doing<font color="#CCCCCC"> some boxing in bare metal</font>

354
00:14:57,550 --> 00:15:00,639
machines so they're<font color="#E5E5E5"> not using your</font>

355
00:14:59,350 --> 00:15:03,160
typical virtual machines they're

356
00:15:00,639 --> 00:15:05,589
actually using<font color="#CCCCCC"> berber metal machines in</font>

357
00:15:03,160 --> 00:15:08,199
order to run the sample so hopefully<font color="#CCCCCC"> I</font>

358
00:15:05,589 --> 00:15:10,269
get to invite<font color="#E5E5E5"> to join check that one out</font>

359
00:15:08,199 --> 00:15:11,589
that seems pretty interesting and then

360
00:15:10,269 --> 00:15:14,199
obviously you dive into your advanced

361
00:15:11,589 --> 00:15:17,860
analysis the ballgame disassembling code

362
00:15:14,199 --> 00:15:19,870
analysis reversing algorithms as far as

363
00:15:17,860 --> 00:15:22,570
the codeine how is it communicating and

364
00:15:19,870 --> 00:15:26,380
things like that<font color="#E5E5E5"> so I've kind of learned</font>

365
00:15:22,570 --> 00:15:27,970
to do<font color="#E5E5E5"> this most of the time because even</font>

366
00:15:26,380 --> 00:15:30,519
me even for myself that I've<font color="#E5E5E5"> done it for</font>

367
00:15:27,970 --> 00:15:31,990
<font color="#E5E5E5">a few years I'll get</font><font color="#CCCCCC"> a sample kind of</font>

368
00:15:30,519 --> 00:15:33,760
get<font color="#CCCCCC"> an idea</font><font color="#E5E5E5"> what it's doing and I'll</font>

369
00:15:31,990 --> 00:15:35,680
dive straight to advanced analysis and

370
00:15:33,760 --> 00:15:37,449
then I'll find something like crap i

371
00:15:35,680 --> 00:15:41,229
should have gone back<font color="#E5E5E5"> and done the basic</font>

372
00:15:37,449 --> 00:15:42,279
or the dynamic so i usually<font color="#CCCCCC"> just doesn't</font>

373
00:15:41,230 --> 00:15:44,110
<font color="#E5E5E5">matter how many years you be doing if</font>

374
00:15:42,279 --> 00:15:46,390
you kind<font color="#E5E5E5"> of take these steps you get</font>

375
00:15:44,110 --> 00:15:47,860
answers quickly because i<font color="#E5E5E5"> find myself</font>

376
00:15:46,390 --> 00:15:49,930
<font color="#E5E5E5">that I either jump in the middle</font>

377
00:15:47,860 --> 00:15:54,459
<font color="#CCCCCC">somewhere and have to jump back so it's</font>

378
00:15:49,930 --> 00:15:56,979
<font color="#CCCCCC">just helpful so reversing with the go</font>

379
00:15:54,459 --> 00:16:01,239
this is another idea that<font color="#CCCCCC"> I've kind of</font>

380
00:15:56,980 --> 00:16:03,190
learned is and I've kind of repeated

381
00:16:01,240 --> 00:16:04,750
this over is when you want to reverse

382
00:16:03,190 --> 00:16:07,720
some things there's a<font color="#E5E5E5"> reversal obviously</font>

383
00:16:04,750 --> 00:16:09,459
you want<font color="#E5E5E5"> to have a go I nothing hurts me</font>

384
00:16:07,720 --> 00:16:12,430
more in my heart than getting a sample

385
00:16:09,459 --> 00:16:13,689
and telling me he reverse this and they

386
00:16:12,430 --> 00:16:15,630
don't<font color="#E5E5E5"> they</font><font color="#CCCCCC"> don't give</font><font color="#E5E5E5"> me anything that</font>

387
00:16:13,690 --> 00:16:17,680
they want back right now do you want

388
00:16:15,630 --> 00:16:21,850
communications you want to see tues you

389
00:16:17,680 --> 00:16:24,130
want persistence whole space indicators

390
00:16:21,850 --> 00:16:26,050
what do you want you know it's just<font color="#E5E5E5"> yeah</font>

391
00:16:24,130 --> 00:16:28,060
so when you reverse something<font color="#CCCCCC"> reversible</font>

392
00:16:26,050 --> 00:16:30,790
<font color="#E5E5E5">to go go in mind what would you want to</font>

393
00:16:28,060 --> 00:16:32,219
do right<font color="#E5E5E5"> I had tried</font><font color="#CCCCCC"> to find a meme in</font>

394
00:16:30,790 --> 00:16:35,829
the hair but I<font color="#E5E5E5"> couldn't</font>

395
00:16:32,220 --> 00:16:38,920
just googling for what why just wasn't

396
00:16:35,830 --> 00:16:41,380
giving me the right image and we're

397
00:16:38,920 --> 00:16:43,780
actually actually way ahead of<font color="#E5E5E5"> time but</font>

398
00:16:41,380 --> 00:16:45,400
<font color="#E5E5E5">that's good so we'll get</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> reversing</font>

399
00:16:43,780 --> 00:16:47,110
time the way I've a structured<font color="#E5E5E5"> this is</font>

400
00:16:45,400 --> 00:16:49,530
we have I have three samples so

401
00:16:47,110 --> 00:16:51,610
hopefully we get to all<font color="#E5E5E5"> three of them</font>

402
00:16:49,530 --> 00:16:55,209
and then hopefully<font color="#CCCCCC"> we can see them</font>

403
00:16:51,610 --> 00:16:57,580
correctly in the screen so sample one we

404
00:16:55,210 --> 00:16:59,950
have cool guy which is my buddy and then

405
00:16:57,580 --> 00:17:02,800
I'm the other side cool guy too he tells

406
00:16:59,950 --> 00:17:07,140
<font color="#E5E5E5">me hey friend I have a deal with an</font>

407
00:17:02,800 --> 00:17:07,139
export CI which begins to google so

408
00:17:07,440 --> 00:17:11,230
without going into too much detail a

409
00:17:09,790 --> 00:17:14,349
<font color="#CCCCCC">deal though obviously</font><font color="#E5E5E5"> just another</font>

410
00:17:11,230 --> 00:17:16,630
peafowl it's a library use for windows

411
00:17:14,349 --> 00:17:18,969
and they have instead<font color="#E5E5E5"> of they have</font>

412
00:17:16,630 --> 00:17:20,890
export so they have functions or methods

413
00:17:18,970 --> 00:17:22,510
that they get called out in<font color="#CCCCCC"> order for</font>

414
00:17:20,890 --> 00:17:26,079
them to be used you know for another

415
00:17:22,510 --> 00:17:28,060
library another funk program and it's

416
00:17:26,079 --> 00:17:30,159
all them hi friend<font color="#E5E5E5"> I am very excited</font>

417
00:17:28,060 --> 00:17:32,290
much excite tell me<font color="#CCCCCC"> what what's going on</font>

418
00:17:30,160 --> 00:17:33,850
and say it looks like it's the coating

419
00:17:32,290 --> 00:17:38,920
strange would function and it gives me

420
00:17:33,850 --> 00:17:41,370
an offset so I'm excited let's let's do

421
00:17:38,920 --> 00:17:44,550
the first live demo hopefully this works

422
00:17:41,370 --> 00:17:44,550
should work

423
00:17:50,519 --> 00:18:00,639
there you go awesome okay so this is my

424
00:17:53,769 --> 00:18:06,489
windows vm um let me copy the off 60 i

425
00:18:00,639 --> 00:18:10,869
always forget it<font color="#CCCCCC"> alright so we have a</font>

426
00:18:06,489 --> 00:18:12,190
sample one he gives me this dll we have

427
00:18:10,869 --> 00:18:14,499
everything up in running here so that we

428
00:18:12,190 --> 00:18:16,929
don't have<font color="#E5E5E5"> to wait two loads so this</font><font color="#CCCCCC"> is</font>

429
00:18:14,499 --> 00:18:18,940
<font color="#E5E5E5">the fsx for this is the PE partial one</font>

430
00:18:16,929 --> 00:18:21,519
this is one that takes a pee file and

431
00:18:18,940 --> 00:18:28,570
just parses it for all<font color="#CCCCCC"> of its data and</font>

432
00:18:21,519 --> 00:18:32,049
it's horrible let me see<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> would</font>

433
00:18:28,570 --> 00:18:34,619
hold on there you go so it's actually

434
00:18:32,049 --> 00:18:37,418
part of the sysinternals tool<font color="#E5E5E5"> zoom it</font>

435
00:18:34,619 --> 00:18:40,840
yeah it's pretty cool anyway so this is

436
00:18:37,419 --> 00:18:42,729
<font color="#CCCCCC">a peafowl hunter for the</font><font color="#E5E5E5"> sample a lot of</font>

437
00:18:40,840 --> 00:18:46,059
numbers a lot of hacks valued stuff that

438
00:18:42,729 --> 00:18:47,769
probably not quickly understand if you

439
00:18:46,059 --> 00:18:52,739
never looked at this before but one

440
00:18:47,769 --> 00:18:52,739
thing to look at is an odd right<font color="#E5E5E5"> is</font><font color="#CCCCCC"> I</font>

441
00:18:52,830 --> 00:19:01,470
forgot<font color="#E5E5E5"> the shortcut come on hold</font>

442
00:19:04,809 --> 00:19:11,510
control to that that was was working

443
00:19:09,730 --> 00:19:13,940
because I have<font color="#E5E5E5"> to click it and then</font>

444
00:19:11,510 --> 00:19:17,240
anyway so here we see the the export

445
00:19:13,940 --> 00:19:19,130
right the one he talked<font color="#E5E5E5"> about he told me</font>

446
00:19:17,240 --> 00:19:21,110
that<font color="#E5E5E5"> one and specifically he didn't tell</font>

447
00:19:19,130 --> 00:19:22,700
me a there's an export that<font color="#CCCCCC"> I don't know</font>

448
00:19:21,110 --> 00:19:24,408
what it's doing at one function and then

449
00:19:22,700 --> 00:19:26,780
Albert giving me de lo and I wouldn't

450
00:19:24,409 --> 00:19:28,130
come back I'm<font color="#E5E5E5"> like well which export you</font>

451
00:19:26,780 --> 00:19:30,350
know there's three different ones and

452
00:19:28,130 --> 00:19:32,000
then that that's dialogue that just

453
00:19:30,350 --> 00:19:33,230
unnecessary dialogue that he could have

454
00:19:32,000 --> 00:19:36,400
already<font color="#E5E5E5"> shared because he already knows</font>

455
00:19:33,230 --> 00:19:39,260
so we're going<font color="#E5E5E5"> to focus on that export</font>

456
00:19:36,400 --> 00:19:40,760
so that's<font color="#E5E5E5"> the effects Explorer this is</font>

457
00:19:39,260 --> 00:19:44,379
<font color="#E5E5E5">the other one the piece</font><font color="#CCCCCC"> to do want that</font>

458
00:19:40,760 --> 00:19:48,110
<font color="#CCCCCC">I sometimes use it not a lot just</font>

459
00:19:44,380 --> 00:19:52,150
because it gives you great information

460
00:19:48,110 --> 00:19:55,250
but so this<font color="#E5E5E5"> is this is the startup point</font>

461
00:19:52,150 --> 00:20:00,080
you know gives you hash it gives you cpu

462
00:19:55,250 --> 00:20:01,789
stuff the<font color="#CCCCCC"> CPU 1i so the</font><font color="#E5E5E5"> p file without</font>

463
00:20:00,080 --> 00:20:03,590
diving too much into details and getting

464
00:20:01,789 --> 00:20:05,470
too involved<font color="#E5E5E5"> in the people there p file</font>

465
00:20:03,590 --> 00:20:08,330
header for my actually<font color="#E5E5E5"> has two different</font>

466
00:20:05,470 --> 00:20:11,990
fields that you<font color="#E5E5E5"> can determine whether it</font>

467
00:20:08,330 --> 00:20:13,668
is 64 32 bit so this<font color="#E5E5E5"> is where I don't</font>

468
00:20:11,990 --> 00:20:15,710
<font color="#E5E5E5">just come with the idea with I don't</font>

469
00:20:13,669 --> 00:20:18,020
know the tool so I<font color="#E5E5E5"> don't know what feel</font>

470
00:20:15,710 --> 00:20:19,730
this piece to do is pulling it from so i

471
00:20:18,020 --> 00:20:23,658
don't know<font color="#E5E5E5"> if it's mean it's for 32-bit</font>

472
00:20:19,730 --> 00:20:26,539
or if it's<font color="#E5E5E5"> um or if the p files for a</font>

473
00:20:23,659 --> 00:20:27,799
32-bit machine it's so this is kind of

474
00:20:26,539 --> 00:20:31,309
where you have to<font color="#E5E5E5"> go back and understand</font>

475
00:20:27,799 --> 00:20:34,490
your tools right nothing cool about the

476
00:20:31,309 --> 00:20:37,580
piece to<font color="#E5E5E5"> do this is sort of a plug-in</font>

477
00:20:34,490 --> 00:20:39,530
kind of basting where you can tell it

478
00:20:37,580 --> 00:20:43,428
well if you<font color="#E5E5E5"> find this string or you find</font>

479
00:20:39,530 --> 00:20:45,678
this the market is potentially bad so

480
00:20:43,429 --> 00:20:48,650
this one actually I found<font color="#E5E5E5"> a couple of</font>

481
00:20:45,679 --> 00:20:50,030
strings obviously quickly triage you can

482
00:20:48,650 --> 00:20:51,860
see that<font color="#E5E5E5"> it's doing some sort of HTTP</font>

483
00:20:50,030 --> 00:20:55,450
communication so you see some windows

484
00:20:51,860 --> 00:20:59,270
API calls for HTTP stuff alright so

485
00:20:55,450 --> 00:21:03,110
that's being studio and then I think

486
00:20:59,270 --> 00:21:04,970
what yeah so<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is a this is</font><font color="#E5E5E5"> the</font>

487
00:21:03,110 --> 00:21:08,658
techniques the one I love<font color="#E5E5E5"> the black and</font>

488
00:21:04,970 --> 00:21:11,510
<font color="#CCCCCC">gray it just makes it look more</font><font color="#E5E5E5"> cool as</font>

489
00:21:08,659 --> 00:21:12,890
a compiler the linker not a lot<font color="#CCCCCC"> of</font>

490
00:21:11,510 --> 00:21:13,760
information same information you find

491
00:21:12,890 --> 00:21:17,090
here you can find

492
00:21:13,760 --> 00:21:19,340
and see if I explore but I like this one

493
00:21:17,090 --> 00:21:21,139
because it<font color="#E5E5E5"> has a very good detection for</font>

494
00:21:19,340 --> 00:21:23,540
again the compilers and it's good when

495
00:21:21,140 --> 00:21:25,550
you're trying to deal<font color="#CCCCCC"> with I'm Packers</font>

496
00:21:23,540 --> 00:21:27,170
that I mean on packers for packers and

497
00:21:25,550 --> 00:21:33,800
trying to identify what Packard is used

498
00:21:27,170 --> 00:21:41,690
for that particular p and then<font color="#CCCCCC"> all right</font>

499
00:21:33,800 --> 00:21:42,830
so<font color="#E5E5E5"> okay let's see horrible um give me a</font>

500
00:21:41,690 --> 00:21:45,170
second let's see if we can<font color="#CCCCCC"> make this</font>

501
00:21:42,830 --> 00:21:55,730
little bit bigger just<font color="#E5E5E5"> so</font><font color="#CCCCCC"> that weekend</font>

502
00:21:45,170 --> 00:21:58,970
but that didn't work<font color="#CCCCCC"> alright well play</font>

503
00:21:55,730 --> 00:22:01,340
would zoom it alright so again if

504
00:21:58,970 --> 00:22:03,860
nobody's just<font color="#E5E5E5"> Ida this is not a talk to</font>

505
00:22:01,340 --> 00:22:07,030
kind of go over<font color="#E5E5E5"> Ida in how to idle works</font>

506
00:22:03,860 --> 00:22:10,179
I dies<font color="#CCCCCC"> and this assembler though</font>

507
00:22:07,030 --> 00:22:12,950
debugger it also has other plugins or

508
00:22:10,180 --> 00:22:14,510
<font color="#E5E5E5">you pay the guy more money gives you the</font>

509
00:22:12,950 --> 00:22:16,460
compiler so you can think<font color="#CCCCCC"> of pile code</font>

510
00:22:14,510 --> 00:22:21,290
that looks so you have this and you can

511
00:22:16,460 --> 00:22:22,790
<font color="#E5E5E5">have stuff that ends up looking like as</font>

512
00:22:21,290 --> 00:22:26,810
I'm<font color="#CCCCCC"> looking</font><font color="#E5E5E5"> like that so pseudo seen</font>

513
00:22:22,790 --> 00:22:29,540
code right that kind of kind of easier

514
00:22:26,810 --> 00:22:34,879
to read other than assembly definitely

515
00:22:29,540 --> 00:22:36,740
helpful<font color="#E5E5E5"> I use it sometimes I um I just</font>

516
00:22:34,880 --> 00:22:38,480
looking at assembly this is helpful when

517
00:22:36,740 --> 00:22:40,490
I usually wouldn't do a CT have

518
00:22:38,480 --> 00:22:42,500
challenges out fortunately there's no

519
00:22:40,490 --> 00:22:46,340
reverse and challenges here so can't use

520
00:22:42,500 --> 00:22:49,700
this a lot but um anyways here the

521
00:22:46,340 --> 00:22:51,830
exports again this is CI the one we want

522
00:22:49,700 --> 00:22:53,810
to<font color="#E5E5E5"> focus on and it obviously it's the</font>

523
00:22:51,830 --> 00:22:56,720
<font color="#E5E5E5">one ID compiled so this is the one we're</font>

524
00:22:53,810 --> 00:22:58,639
looking<font color="#E5E5E5"> at</font><font color="#CCCCCC"> right and then this is a</font>

525
00:22:56,720 --> 00:23:02,330
function that he wants me to concentrate

526
00:22:58,640 --> 00:23:03,800
on so we'll click on that one<font color="#CCCCCC"> we'll</font><font color="#E5E5E5"> make</font>

527
00:23:02,330 --> 00:23:06,470
this little bigger just to kind of get

528
00:23:03,800 --> 00:23:08,180
an<font color="#E5E5E5"> idea of what the graph looks like so</font>

529
00:23:06,470 --> 00:23:10,970
the other thing<font color="#E5E5E5"> cool about Ida this is</font>

530
00:23:08,180 --> 00:23:14,210
where<font color="#E5E5E5"> I think without Ida we making jobs</font>

531
00:23:10,970 --> 00:23:16,130
a lot harder we have these this graph

532
00:23:14,210 --> 00:23:17,900
mode<font color="#CCCCCC"> either does a very good job of</font>

533
00:23:16,130 --> 00:23:20,780
telling you how<font color="#CCCCCC"> the function flows how</font>

534
00:23:17,900 --> 00:23:21,770
it does out you know it does things and

535
00:23:20,780 --> 00:23:25,490
then the other cool thing that it does

536
00:23:21,770 --> 00:23:26,240
is these bolted blue lines these are

537
00:23:25,490 --> 00:23:28,190
loot

538
00:23:26,240 --> 00:23:29,679
so the itis has identified that that's a

539
00:23:28,190 --> 00:23:31,910
loop so there's a loop going on there

540
00:23:29,679 --> 00:23:35,390
there's obviously<font color="#E5E5E5"> one two three</font>

541
00:23:31,910 --> 00:23:37,490
different loops going on here so that

542
00:23:35,390 --> 00:23:40,429
kind of again graph mode really helpful

543
00:23:37,490 --> 00:23:44,030
I had someone<font color="#E5E5E5"> tell me before that you</font>

544
00:23:40,429 --> 00:23:46,490
<font color="#E5E5E5">you're you're a wuss if you use graph</font>

545
00:23:44,030 --> 00:23:48,440
mode because it makes you reverse faster

546
00:23:46,490 --> 00:23:51,140
i guess i<font color="#E5E5E5"> don't know but i like rapid</font>

547
00:23:48,440 --> 00:23:54,080
side<font color="#E5E5E5"> okay it is definitely easier to</font>

548
00:23:51,140 --> 00:23:56,300
move around so<font color="#CCCCCC"> alright so going</font><font color="#E5E5E5"> back</font><font color="#CCCCCC"> to</font>

549
00:23:54,080 --> 00:23:58,250
that function right again we won't step

550
00:23:56,300 --> 00:23:59,120
through all this we're not going<font color="#CCCCCC"> to not</font>

551
00:23:58,250 --> 00:24:02,390
going to tell<font color="#CCCCCC"> you everything what's</font>

552
00:23:59,120 --> 00:24:05,059
going on here basically this is where

553
00:24:02,390 --> 00:24:07,480
<font color="#E5E5E5">for us reversers for those that reverse</font>

554
00:24:05,059 --> 00:24:10,370
a lot kind<font color="#E5E5E5"> of jump into this function</font>

555
00:24:07,480 --> 00:24:12,230
focus on this<font color="#E5E5E5"> function itself and just</font>

556
00:24:10,370 --> 00:24:14,000
kind of you know figure out what things

557
00:24:12,230 --> 00:24:15,710
are going on right<font color="#CCCCCC"> now</font><font color="#E5E5E5"> I'll break it</font>

558
00:24:14,000 --> 00:24:17,809
down for you guys obviously<font color="#E5E5E5"> again we</font>

559
00:24:15,710 --> 00:24:20,809
won't go through everything but there's

560
00:24:17,809 --> 00:24:22,250
three<font color="#E5E5E5"> loops and I see this value the</font>

561
00:24:20,809 --> 00:24:23,990
<font color="#E5E5E5">other thing that either does a lot to is</font>

562
00:24:22,250 --> 00:24:26,900
and we'll see it so if you highlight

563
00:24:23,990 --> 00:24:28,490
something if<font color="#E5E5E5"> I had matching things it'll</font>

564
00:24:26,900 --> 00:24:30,850
<font color="#E5E5E5">highlight everywhere all the function</font>

565
00:24:28,490 --> 00:24:33,050
graph so it's very<font color="#E5E5E5"> easy to see matching</font>

566
00:24:30,850 --> 00:24:34,280
matching variable names for matching

567
00:24:33,050 --> 00:24:37,460
values that is used throughout the

568
00:24:34,280 --> 00:24:40,040
function so I use that early a<font color="#CCCCCC"> lot too</font>

569
00:24:37,460 --> 00:24:46,610
so<font color="#CCCCCC"> you see here this hex value 100 which</font>

570
00:24:40,040 --> 00:24:50,450
is 256 in decimal<font color="#E5E5E5"> and</font><font color="#CCCCCC"> we'll keep the</font>

571
00:24:46,610 --> 00:24:53,000
back to so I like working wax so use

572
00:24:50,450 --> 00:24:55,700
that twice and I see two loops and they

573
00:24:53,000 --> 00:24:57,610
see another loop so looking<font color="#E5E5E5"> at this and</font>

574
00:24:55,700 --> 00:25:00,080
I've already looked at this<font color="#E5E5E5"> plenty I</font>

575
00:24:57,610 --> 00:25:04,129
identify right off the bat to this is

576
00:25:00,080 --> 00:25:05,840
rc4 encryption so it's the way rc4

577
00:25:04,130 --> 00:25:07,880
encryption works and not a cryptology so

578
00:25:05,840 --> 00:25:10,159
i'll definitely mess up the ecology

579
00:25:07,880 --> 00:25:12,440
names and all the proper names but the

580
00:25:10,160 --> 00:25:14,660
first loop it the first two loops are

581
00:25:12,440 --> 00:25:17,420
the key in a civilization so initialize

582
00:25:14,660 --> 00:25:19,730
the key with the buffer and why not and

583
00:25:17,420 --> 00:25:21,920
then uses<font color="#CCCCCC"> the key to randomize that</font>

584
00:25:19,730 --> 00:25:24,260
buffer with with<font color="#E5E5E5"> the key values and then</font>

585
00:25:21,920 --> 00:25:25,970
the second of the final loop is when it

586
00:25:24,260 --> 00:25:28,040
actually decrypts or decrypt the

587
00:25:25,970 --> 00:25:31,700
functions back<font color="#CCCCCC"> I mean the characters</font>

588
00:25:28,040 --> 00:25:35,149
back we're using that 256 array of

589
00:25:31,700 --> 00:25:37,460
values that<font color="#CCCCCC"> it just initialized so</font>

590
00:25:35,150 --> 00:25:38,790
anyway so we have a very fine dust as

591
00:25:37,460 --> 00:25:42,120
our c4

592
00:25:38,790 --> 00:25:48,180
I told him and then which<font color="#CCCCCC"> is named this</font>

593
00:25:42,120 --> 00:25:49,620
to our c4 cool right again we're not

594
00:25:48,180 --> 00:25:50,610
gonna talk about how assembly works and

595
00:25:49,620 --> 00:25:54,870
things like that we'll<font color="#CCCCCC"> talk a</font><font color="#E5E5E5"> little bit</font>

596
00:25:50,610 --> 00:25:58,229
in the in<font color="#E5E5E5"> this example here so I've</font>

597
00:25:54,870 --> 00:26:00,149
identify it I see that it's called twice

598
00:25:58,230 --> 00:26:01,800
within the function that<font color="#E5E5E5"> he asked me</font>

599
00:26:00,150 --> 00:26:05,220
about or not the functioning<font color="#CCCCCC"> is</font><font color="#E5E5E5"> May but</font>

600
00:26:01,800 --> 00:26:07,980
within the export so it's called twice

601
00:26:05,220 --> 00:26:11,040
so then he wants to<font color="#E5E5E5"> know what's the key</font>

602
00:26:07,980 --> 00:26:14,490
for this rc4 encryption so that<font color="#CCCCCC"> I can</font>

603
00:26:11,040 --> 00:26:17,240
decrypt all the strings and be happy so

604
00:26:14,490 --> 00:26:20,790
then again we use Ida's wonderful

605
00:26:17,240 --> 00:26:22,230
highlighting capabilities so right

606
00:26:20,790 --> 00:26:23,879
<font color="#E5E5E5">before it's called if you know how</font>

607
00:26:22,230 --> 00:26:26,850
assembly works it pushes arguments on to

608
00:26:23,880 --> 00:26:29,490
the stack for x86 so you see<font color="#CCCCCC"> that it's</font>

609
00:26:26,850 --> 00:26:31,770
pushing this value here and it's pushing

610
00:26:29,490 --> 00:26:33,660
it for the other one<font color="#E5E5E5"> too you go above</font>

611
00:26:31,770 --> 00:26:35,190
<font color="#CCCCCC">the other one which is also moving into</font>

612
00:26:33,660 --> 00:26:37,410
EDX and then pushing it to the stack

613
00:26:35,190 --> 00:26:39,150
it's also calling it again or pushing it

614
00:26:37,410 --> 00:26:41,070
to the stack then we have<font color="#E5E5E5"> this third</font>

615
00:26:39,150 --> 00:26:45,300
value up here with this one's not called

616
00:26:41,070 --> 00:26:48,200
again on the second call so I kind of

617
00:26:45,300 --> 00:26:51,570
then you kind of look at these values

618
00:26:48,200 --> 00:26:53,580
looking at this one and then looking at

619
00:26:51,570 --> 00:26:56,580
this one so this<font color="#E5E5E5"> one has a value of</font><font color="#CCCCCC"> 10</font>

620
00:26:53,580 --> 00:26:58,949
hacks which is 16 bytes if you were to

621
00:26:56,580 --> 00:27:01,740
count this this is actually 16 bytes so

622
00:26:58,950 --> 00:27:03,540
<font color="#E5E5E5">I guessed right off the bat I'm</font><font color="#CCCCCC"> going to</font>

623
00:27:01,740 --> 00:27:05,400
tell you<font color="#E5E5E5"> that I you know my guess was</font>

624
00:27:03,540 --> 00:27:09,060
right but I guess that this is the key

625
00:27:05,400 --> 00:27:11,970
so we'll just<font color="#E5E5E5"> call this the key sure so</font>

626
00:27:09,060 --> 00:27:13,560
I like keeping the address names<font color="#CCCCCC"> of the</font>

627
00:27:11,970 --> 00:27:15,570
addresses<font color="#E5E5E5"> just because when I do</font>

628
00:27:13,560 --> 00:27:20,159
back-and-forth debugging with Ali I like

629
00:27:15,570 --> 00:27:22,409
<font color="#E5E5E5">to have it there so we identify the</font>

630
00:27:20,160 --> 00:27:25,470
length we identify<font color="#E5E5E5"> the key I can</font><font color="#CCCCCC"> give</font>

631
00:27:22,410 --> 00:27:27,000
<font color="#CCCCCC">that to him and then basically this</font>

632
00:27:25,470 --> 00:27:29,880
these are the strings that he wants so

633
00:27:27,000 --> 00:27:32,040
Absalom here the strings here's the<font color="#E5E5E5"> key</font>

634
00:27:29,880 --> 00:27:34,640
and then<font color="#E5E5E5"> he writes I conscript that</font>

635
00:27:32,040 --> 00:27:37,379
description for him and he's<font color="#E5E5E5"> happy so</font>

636
00:27:34,640 --> 00:27:39,890
that was fairly quickly for me to

637
00:27:37,380 --> 00:27:42,270
analyze because I really looked at this

638
00:27:39,890 --> 00:27:45,810
rc4 before<font color="#E5E5E5"> I've actually stepped through</font>

639
00:27:42,270 --> 00:27:47,340
it manually plenty unfortunately but<font color="#CCCCCC"> you</font>

640
00:27:45,810 --> 00:27:49,710
learned the hard way right<font color="#CCCCCC"> um but</font>

641
00:27:47,340 --> 00:27:51,100
anyways so that was that sample were

642
00:27:49,710 --> 00:27:55,510
<font color="#CCCCCC">over it done he has a key</font>

643
00:27:51,100 --> 00:27:59,949
<font color="#CCCCCC">drinks is happy</font><font color="#E5E5E5"> all right so move on to</font>

644
00:27:55,510 --> 00:28:03,640
the next sample we have fun if I can

645
00:27:59,950 --> 00:28:07,090
just get<font color="#E5E5E5"> away with just doing this so</font>

646
00:28:03,640 --> 00:28:11,110
that the Refresh doesn't kill it<font color="#E5E5E5"> right</font>

647
00:28:07,090 --> 00:28:12,850
yeah<font color="#E5E5E5"> all right so we have done them all</font>

648
00:28:11,110 --> 00:28:16,719
hope that work hopefully caught

649
00:28:12,850 --> 00:28:18,549
something second demo the same guy like

650
00:28:16,720 --> 00:28:22,450
a friend you wanna help me again Mike

651
00:28:18,549 --> 00:28:24,220
for show how I will help you so he tells

652
00:28:22,450 --> 00:28:26,049
me use this scenario and if you notice

653
00:28:24,220 --> 00:28:27,820
the names they're very similar to<font color="#E5E5E5"> the</font>

654
00:28:26,049 --> 00:28:30,549
ones we saw on the first sample<font color="#CCCCCC"> when I</font>

655
00:28:27,820 --> 00:28:33,580
show you<font color="#E5E5E5"> the red boxes so he told you</font>

656
00:28:30,549 --> 00:28:35,110
the whole story and I'm<font color="#E5E5E5"> like</font><font color="#CCCCCC"> okay cool</font>

657
00:28:33,580 --> 00:28:40,840
give me give me<font color="#E5E5E5"> the files give me the</font>

658
00:28:35,110 --> 00:28:42,280
offsets and then can do that it gives me

659
00:28:40,840 --> 00:28:43,959
all that information which<font color="#CCCCCC"> is just</font>

660
00:28:42,280 --> 00:28:45,789
wonderful again we can focus on the

661
00:28:43,960 --> 00:28:49,240
things<font color="#E5E5E5"> that we want to focus on excuse</font>

662
00:28:45,789 --> 00:28:52,559
me the first thing I exe calls dll

663
00:28:49,240 --> 00:28:55,720
around this code cause some shell code

664
00:28:52,559 --> 00:28:58,090
does some<font color="#CCCCCC"> x1 incremental again calls the</font>

665
00:28:55,720 --> 00:28:59,740
dll custom shell code and then he tells

666
00:28:58,090 --> 00:29:03,129
me the shot code to be<font color="#CCCCCC"> a should be at</font>

667
00:28:59,740 --> 00:29:05,049
memory 3b 00 and then the decoding blue

668
00:29:03,130 --> 00:29:07,330
Tina he's interested in<font color="#E5E5E5"> said that offset</font>

669
00:29:05,049 --> 00:29:10,450
so a couple of things<font color="#E5E5E5"> to take from this</font>

670
00:29:07,330 --> 00:29:15,399
story is the first of all going back to

671
00:29:10,450 --> 00:29:18,880
one slide is so he's looking<font color="#E5E5E5"> at us again</font>

672
00:29:15,400 --> 00:29:22,419
yellow working on this export<font color="#CCCCCC"> preprocess</font>

673
00:29:18,880 --> 00:29:23,890
<font color="#CCCCCC">command-line exe w and he's focused on</font>

674
00:29:22,419 --> 00:29:26,320
he already knows<font color="#E5E5E5"> it does one thing</font>

675
00:29:23,890 --> 00:29:27,970
persistence great why because if<font color="#CCCCCC"> I were</font>

676
00:29:26,320 --> 00:29:30,730
to look at<font color="#E5E5E5"> the</font><font color="#CCCCCC"> zillow and I look at it</font>

677
00:29:27,970 --> 00:29:32,740
in like a I noticed persistence if we I

678
00:29:30,730 --> 00:29:34,059
could if<font color="#CCCCCC"> I notice the persistence I</font>

679
00:29:32,740 --> 00:29:35,559
already know he<font color="#E5E5E5"> knows that I don't need</font>

680
00:29:34,059 --> 00:29:37,090
to<font color="#E5E5E5"> worry about it but if he didn't tell</font>

681
00:29:35,559 --> 00:29:38,889
me<font color="#CCCCCC"> that then i will look</font><font color="#E5E5E5"> at it and</font><font color="#CCCCCC"> i</font>

682
00:29:37,090 --> 00:29:41,470
<font color="#E5E5E5">would express that to him I mean</font>

683
00:29:38,890 --> 00:29:43,030
obviously different dialogue would start

684
00:29:41,470 --> 00:29:45,820
up and then the<font color="#E5E5E5"> other thing thing is</font>

685
00:29:43,030 --> 00:29:48,240
delivered in a self-extracting archive

686
00:29:45,820 --> 00:29:50,770
they all have to<font color="#E5E5E5"> be the same directory</font>

687
00:29:48,240 --> 00:29:52,419
that's also helpful because usually

688
00:29:50,770 --> 00:29:53,620
you'll have samples you<font color="#E5E5E5"> move to</font>

689
00:29:52,419 --> 00:29:56,230
different folders and things like that

690
00:29:53,620 --> 00:29:58,360
so<font color="#E5E5E5"> when you execute it it all works fine</font>

691
00:29:56,230 --> 00:29:59,980
and it's actually bit mean but when<font color="#CCCCCC"> I</font>

692
00:29:58,360 --> 00:30:02,049
was working on demo because I wanted<font color="#E5E5E5"> to</font>

693
00:29:59,980 --> 00:30:03,100
change<font color="#E5E5E5"> the filenames and it wasn't</font>

694
00:30:02,049 --> 00:30:04,370
working<font color="#E5E5E5"> I'm like it's in the same</font>

695
00:30:03,100 --> 00:30:06,040
directory

696
00:30:04,370 --> 00:30:09,409
sorry short looking back<font color="#E5E5E5"> at the files</font>

697
00:30:06,040 --> 00:30:10,700
they all have hard-coded file name so

698
00:30:09,410 --> 00:30:14,809
they all have<font color="#CCCCCC"> to be the same file names</font>

699
00:30:10,700 --> 00:30:16,850
if not it doesn't run<font color="#E5E5E5"> too so I kept</font>

700
00:30:14,809 --> 00:30:21,220
doing it so<font color="#CCCCCC"> alright so let's dive into</font>

701
00:30:16,850 --> 00:30:24,919
this one really quick hopefully it's a

702
00:30:21,220 --> 00:30:26,570
little bit<font color="#E5E5E5"> more interesting it was for</font>

703
00:30:24,920 --> 00:30:29,570
me actually took me a while to decode

704
00:30:26,570 --> 00:30:33,500
this one so we're done<font color="#CCCCCC"> with this one so</font>

705
00:30:29,570 --> 00:30:34,879
we have the exe again this one has a

706
00:30:33,500 --> 00:30:36,500
<font color="#E5E5E5">little bit more information that we can</font>

707
00:30:34,880 --> 00:30:41,390
go off of that you can you know Troy

708
00:30:36,500 --> 00:30:43,340
triage on research google and whatnot we

709
00:30:41,390 --> 00:30:48,080
won't spend too much on that one this

710
00:30:43,340 --> 00:30:51,139
<font color="#E5E5E5">one has where is it not a lot</font><font color="#CCCCCC"> of</font>

711
00:30:48,080 --> 00:30:58,520
information<font color="#E5E5E5"> to go off</font><font color="#CCCCCC"> of peace to do is</font>

712
00:30:51,140 --> 00:31:00,550
<font color="#E5E5E5">this the same one yeah so p stood here</font>

713
00:30:58,520 --> 00:31:03,260
helps me a little bit more I'll helps us

714
00:31:00,550 --> 00:31:05,300
because in the indicators it tells<font color="#E5E5E5"> you</font>

715
00:31:03,260 --> 00:31:09,350
<font color="#E5E5E5">the slope is able to extract HTTP</font>

716
00:31:05,300 --> 00:31:11,419
communications URLs Toby to get off<font color="#E5E5E5"> of</font>

717
00:31:09,350 --> 00:31:13,280
<font color="#CCCCCC">that so all these seem pretty legit</font>

718
00:31:11,420 --> 00:31:15,800
they're all certificate information on

719
00:31:13,280 --> 00:31:20,510
that tries to<font color="#E5E5E5"> do except for the last one</font>

720
00:31:15,800 --> 00:31:22,629
that's<font color="#E5E5E5"> TB pop but obviously again quick</font>

721
00:31:20,510 --> 00:31:25,160
tool kind of look at a file identify

722
00:31:22,630 --> 00:31:29,210
indicators if you<font color="#E5E5E5"> just want to quickly</font>

723
00:31:25,160 --> 00:31:31,100
move on and then I don't think any of

724
00:31:29,210 --> 00:31:32,929
these I won't show you the tact is all

725
00:31:31,100 --> 00:31:35,870
the same thing they're all compile with

726
00:31:32,929 --> 00:31:37,400
visual c++ so this was a little bit<font color="#E5E5E5"> more</font>

727
00:31:35,870 --> 00:31:40,909
fun because we'll actually do some

728
00:31:37,400 --> 00:31:45,830
debugging so this is<font color="#CCCCCC"> Ali does</font><font color="#E5E5E5"> anybody</font>

729
00:31:40,910 --> 00:31:49,220
know what Ali is so debugger it's fairly

730
00:31:45,830 --> 00:31:50,689
old I I like it there's all the

731
00:31:49,220 --> 00:31:56,480
debuggers out there but<font color="#CCCCCC"> I still like</font>

732
00:31:50,690 --> 00:31:58,700
doing this one anyway so<font color="#CCCCCC"> alright so this</font>

733
00:31:56,480 --> 00:32:06,530
is<font color="#CCCCCC"> where we start acceleration playing</font>

734
00:31:58,700 --> 00:32:11,720
with the demo<font color="#CCCCCC"> ok so give me a second</font>

735
00:32:06,530 --> 00:32:17,850
here let's pull it up<font color="#CCCCCC"> is</font><font color="#E5E5E5"> it</font>

736
00:32:11,720 --> 00:32:19,950
this one<font color="#CCCCCC"> all right so huge binary has a</font>

737
00:32:17,850 --> 00:32:21,779
lot of functions not pretty to look at

738
00:32:19,950 --> 00:32:23,789
but I don't<font color="#E5E5E5"> need</font><font color="#CCCCCC"> to worry about that</font>

739
00:32:21,779 --> 00:32:26,419
because<font color="#E5E5E5"> I just</font><font color="#CCCCCC"> need to worry about the</font>

740
00:32:23,789 --> 00:32:29,820
<font color="#CCCCCC">information that my buddy gave me which</font>

741
00:32:26,419 --> 00:32:37,279
it tells me<font color="#E5E5E5"> the maniac cell calls the</font>

742
00:32:29,820 --> 00:32:44,100
dll around 40 11 be so here is<font color="#E5E5E5"> 40 11b</font>

743
00:32:37,279 --> 00:32:45,750
come on 4011 be I made<font color="#E5E5E5"> it comment</font>

744
00:32:44,100 --> 00:32:47,699
they're saying offset given by cool guy

745
00:32:45,750 --> 00:32:51,059
start looking<font color="#E5E5E5"> at those things</font><font color="#CCCCCC"> so what</font><font color="#E5E5E5"> I</font>

746
00:32:47,700 --> 00:32:53,000
can do<font color="#E5E5E5"> is I trust this analysis I just</font>

747
00:32:51,059 --> 00:32:57,210
need to<font color="#E5E5E5"> focus on this I kind of want to</font>

748
00:32:53,000 --> 00:33:02,639
get to<font color="#CCCCCC"> the shellcode so we'll do it step</font>

749
00:32:57,210 --> 00:33:05,130
by step so this is<font color="#E5E5E5"> so here's the only</font>

750
00:33:02,639 --> 00:33:09,629
thing<font color="#E5E5E5"> I actually did some purpose to so</font>

751
00:33:05,130 --> 00:33:15,510
if you own an item I mean<font color="#CCCCCC"> an ollie its</font>

752
00:33:09,630 --> 00:33:19,500
main is at different f9c ef5 915 that

753
00:33:15,510 --> 00:33:21,029
does not match if I were to go to the

754
00:33:19,500 --> 00:33:23,159
start function here it definitely

755
00:33:21,029 --> 00:33:27,590
doesn't match even if you go to the

756
00:33:23,159 --> 00:33:30,559
command line here do<font color="#E5E5E5"> I need</font><font color="#CCCCCC"> to shut up</font>

757
00:33:27,590 --> 00:33:34,230
what's a good<font color="#CCCCCC"> time okay anyways um</font>

758
00:33:30,559 --> 00:33:36,658
whereas when may still doesn't match up

759
00:33:34,230 --> 00:33:38,760
why does that<font color="#E5E5E5"> match up another cool</font>

760
00:33:36,659 --> 00:33:41,549
trick that<font color="#CCCCCC"> you kind of keep in mind for</font>

761
00:33:38,760 --> 00:33:44,429
<font color="#E5E5E5">those that like to do this so pop player</font>

762
00:33:41,549 --> 00:33:46,679
dll the<font color="#E5E5E5"> p file header has this option</font>

763
00:33:44,429 --> 00:33:48,929
where you can set it<font color="#E5E5E5"> to randomize is</font>

764
00:33:46,679 --> 00:33:50,730
start address every time you load it up

765
00:33:48,929 --> 00:33:53,159
in it every time it's loaded by the

766
00:33:50,730 --> 00:33:56,549
window windows loader and you can change

767
00:33:53,159 --> 00:33:58,860
<font color="#E5E5E5">that so that's actually what the</font>

768
00:33:56,549 --> 00:34:01,529
structures but there's this structure

769
00:33:58,860 --> 00:34:04,678
called do logistics and if you uncheck

770
00:34:01,529 --> 00:34:06,779
this so here but<font color="#CCCCCC"> I</font><font color="#E5E5E5"> can't see this they</font>

771
00:34:04,679 --> 00:34:08,250
all can move that's telling the windows

772
00:34:06,779 --> 00:34:10,139
loader every time you load me change

773
00:34:08,250 --> 00:34:14,429
change my base address don't put it in

774
00:34:10,139 --> 00:34:16,230
<font color="#E5E5E5">the same water so we can uncheck this we</font>

775
00:34:14,429 --> 00:34:17,090
<font color="#E5E5E5">need to save this</font><font color="#CCCCCC"> and just</font><font color="#E5E5E5"> save it all</font>

776
00:34:16,230 --> 00:34:19,130
right yeah

777
00:34:17,090 --> 00:34:23,800
oh I need to say with different name

778
00:34:19,130 --> 00:34:28,100
because it's being loaded here all<font color="#E5E5E5"> right</font>

779
00:34:23,800 --> 00:34:29,060
what just say don't know i don't want to

780
00:34:28,100 --> 00:34:30,889
say because it's gonna kill everything

781
00:34:29,060 --> 00:34:37,070
else let me<font color="#E5E5E5"> just call all this analysis</font>

782
00:34:30,889 --> 00:34:43,580
because it's<font color="#CCCCCC"> probably not letting me all</font>

783
00:34:37,070 --> 00:34:52,550
right try<font color="#E5E5E5"> this one more time what's</font>

784
00:34:43,580 --> 00:34:56,929
still using it it's<font color="#E5E5E5"> not Ali I mean I</font>

785
00:34:52,550 --> 00:34:59,000
<font color="#E5E5E5">know it's not why is it all right that's</font>

786
00:34:56,929 --> 00:35:05,029
<font color="#E5E5E5">fine</font><font color="#CCCCCC"> we'll just save it ok this is the</font>

787
00:34:59,000 --> 00:35:11,960
<font color="#CCCCCC">dll sorry um which is being used</font><font color="#E5E5E5"> here so</font>

788
00:35:05,030 --> 00:35:17,270
just close this where is it what this

789
00:35:11,960 --> 00:35:25,660
one can't move sorry damn it<font color="#E5E5E5"> ok</font><font color="#CCCCCC"> I think</font>

790
00:35:17,270 --> 00:35:25,660
<font color="#E5E5E5">I can mess this one up try this again so</font>

791
00:35:25,870 --> 00:35:29,049
<font color="#E5E5E5">it's up to</font>

792
00:35:30,660 --> 00:35:40,799
I just ran it damn<font color="#CCCCCC"> it oh wow it's okay</font>

793
00:35:33,930 --> 00:35:44,069
<font color="#E5E5E5">where no vm that's happened to me plenty</font>

794
00:35:40,799 --> 00:35:45,420
of times and it's I yeah I just nap

795
00:35:44,069 --> 00:35:47,670
shots and things like that so<font color="#CCCCCC"> we're</font><font color="#E5E5E5"> all</font>

796
00:35:45,420 --> 00:35:50,390
good<font color="#E5E5E5"> all right so yeah so sorry i was</font>

797
00:35:47,670 --> 00:35:52,680
looking at<font color="#E5E5E5"> the wrong file it's alright</font>

798
00:35:50,390 --> 00:35:53,848
cool we're backing track hopefully it is

799
00:35:52,680 --> 00:35:55,710
still run<font color="#CCCCCC"> i don't think it has any</font>

800
00:35:53,849 --> 00:35:56,819
checkings as far as<font color="#CCCCCC"> if it tough it's</font>

801
00:35:55,710 --> 00:36:03,930
already running<font color="#E5E5E5"> I'm not going to run</font>

802
00:35:56,819 --> 00:36:05,369
<font color="#E5E5E5">again</font><font color="#CCCCCC"> alright so going</font><font color="#E5E5E5"> back to so here's</font>

803
00:36:03,930 --> 00:36:11,328
the main point we're<font color="#E5E5E5"> going to set a</font>

804
00:36:05,369 --> 00:36:11,329
breakpoint here then copy this go here

805
00:36:13,490 --> 00:36:18,808
it's already have a break point there

806
00:36:16,250 --> 00:36:20,520
we're just<font color="#E5E5E5"> gonna play through it so</font>

807
00:36:18,809 --> 00:36:24,359
remember you told me it calls the code

808
00:36:20,520 --> 00:36:25,890
<font color="#E5E5E5">around that around that area it's not</font>

809
00:36:24,359 --> 00:36:28,920
necessarily happy there yet but

810
00:36:25,890 --> 00:36:30,839
basically we see some names there pop

811
00:36:28,920 --> 00:36:33,569
player mini which is the dll that's

812
00:36:30,839 --> 00:36:43,920
getting loaded will step through this

813
00:36:33,569 --> 00:36:46,079
will step over it so and then we see the

814
00:36:43,920 --> 00:36:49,380
export that's being called that we're

815
00:36:46,079 --> 00:36:51,059
interested in so here's a export<font color="#CCCCCC"> that he</font>

816
00:36:49,380 --> 00:36:53,670
told<font color="#E5E5E5"> me about he's interested in and</font>

817
00:36:51,059 --> 00:36:54,990
it's calling into it so here instead up

818
00:36:53,670 --> 00:37:00,119
stepping over it so we wanna show you

819
00:36:54,990 --> 00:37:01,890
don't step into it and then this<font color="#E5E5E5"> is the</font>

820
00:37:00,119 --> 00:37:04,230
deal also free from Iran we're done with

821
00:37:01,890 --> 00:37:12,868
this one let's open up the<font color="#E5E5E5"> DL oh and I'd</font>

822
00:37:04,230 --> 00:37:16,559
are where is<font color="#CCCCCC"> it so this one yeah so</font>

823
00:37:12,869 --> 00:37:18,450
again as a couple<font color="#E5E5E5"> of exports we only</font>

824
00:37:16,559 --> 00:37:22,950
really worried about<font color="#E5E5E5"> the one we want to</font>

825
00:37:18,450 --> 00:37:25,348
work<font color="#E5E5E5"> on so without diving too much into</font>

826
00:37:22,950 --> 00:37:27,598
this<font color="#CCCCCC"> because obviously some of this can</font>

827
00:37:25,349 --> 00:37:30,750
be very daunting or boring for<font color="#CCCCCC"> some ones</font>

828
00:37:27,599 --> 00:37:32,910
we see some registry stuff this is where

829
00:37:30,750 --> 00:37:34,339
it sets persistence up we don't worry

830
00:37:32,910 --> 00:37:39,029
about<font color="#E5E5E5"> that because he already knows</font><font color="#CCCCCC"> that</font>

831
00:37:34,339 --> 00:37:40,349
we have this<font color="#E5E5E5"> other jump is where he and</font>

832
00:37:39,029 --> 00:37:42,859
then that's the other second location

833
00:37:40,349 --> 00:37:44,590
that he's interested in<font color="#E5E5E5"> so then</font><font color="#CCCCCC"> delisle</font>

834
00:37:42,859 --> 00:37:51,490
calls<font color="#CCCCCC"> a shellcode</font>

835
00:37:44,590 --> 00:37:56,680
around 1012 TD<font color="#E5E5E5"> dozen 12 TD which is down</font>

836
00:37:51,490 --> 00:38:00,069
here here<font color="#E5E5E5"> doesn't</font><font color="#CCCCCC"> tool here it is so</font>

837
00:37:56,680 --> 00:38:05,109
we'll<font color="#E5E5E5"> put a comment here call shell code</font>

838
00:38:00,070 --> 00:38:08,590
and then so we'll go back<font color="#CCCCCC"> to ollie</font>

839
00:38:05,110 --> 00:38:10,300
really quick and then this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> where the</font>

840
00:38:08,590 --> 00:38:13,360
dll can move right so this is where

841
00:38:10,300 --> 00:38:15,790
inside that dll and we see<font color="#CCCCCC"> that the</font>

842
00:38:13,360 --> 00:38:17,860
address was in<font color="#E5E5E5"> my job because of my</font>

843
00:38:15,790 --> 00:38:19,360
failed attempt<font color="#E5E5E5"> to tell you about</font><font color="#CCCCCC"> that</font>

844
00:38:17,860 --> 00:38:21,370
earlier was actually i was actually

845
00:38:19,360 --> 00:38:25,690
debugging the dll so what changed that

846
00:38:21,370 --> 00:38:27,069
day although so i cannot move and<font color="#CCCCCC"> then</font>

847
00:38:25,690 --> 00:38:32,970
we actually<font color="#CCCCCC"> have to restart this so</font>

848
00:38:27,070 --> 00:38:37,900
click close this save this and what what

849
00:38:32,970 --> 00:38:39,730
just close this so the dildo is the one

850
00:38:37,900 --> 00:38:42,100
that<font color="#E5E5E5"> has an option where it can be moved</font>

851
00:38:39,730 --> 00:38:46,720
all the time<font color="#E5E5E5"> it's save a different name</font>

852
00:38:42,100 --> 00:38:48,339
would just copy it so we want<font color="#E5E5E5"> to change</font>

853
00:38:46,720 --> 00:38:51,549
<font color="#E5E5E5">that so that makes that analysis easier</font>

854
00:38:48,340 --> 00:38:58,410
for us to kind of so we can move them

855
00:38:51,550 --> 00:38:58,410
around with<font color="#E5E5E5"> that and where is</font><font color="#CCCCCC"> it so</font>

856
00:39:02,370 --> 00:39:06,060
so if you saw that<font color="#E5E5E5"> the name was</font>

857
00:39:04,140 --> 00:39:07,259
hard-coded in there so even if I would

858
00:39:06,060 --> 00:39:09,150
have changed it would still not worked

859
00:39:07,260 --> 00:39:11,390
<font color="#CCCCCC">alright so</font><font color="#E5E5E5"> let's try this again with</font>

860
00:39:09,150 --> 00:39:19,590
<font color="#E5E5E5">Ollie one more time and then after this</font>

861
00:39:11,390 --> 00:39:22,049
bowl or wrap up so here's the main

862
00:39:19,590 --> 00:39:25,790
executable breakpoint shirt or beauty be

863
00:39:22,050 --> 00:39:29,010
there yeah so we'll just<font color="#E5E5E5"> play through it</font>

864
00:39:25,790 --> 00:39:34,259
I won't domain because this is stuff we

865
00:39:29,010 --> 00:39:37,050
already went into<font color="#CCCCCC"> know something</font><font color="#E5E5E5"> alright</font>

866
00:39:34,260 --> 00:39:40,260
so then<font color="#CCCCCC"> alright so see now the address</font>

867
00:39:37,050 --> 00:39:47,450
is change actually now we can put a

868
00:39:40,260 --> 00:39:47,450
breakpoint on on this guy control copy

869
00:39:53,380 --> 00:39:59,570
all right so which let it run and it

870
00:39:56,119 --> 00:40:02,480
breaks there the other thing interesting

871
00:39:59,570 --> 00:40:04,460
here so we'll swim in here so it's

872
00:40:02,480 --> 00:40:06,830
calling eax so it's calling<font color="#E5E5E5"> it into eex</font>

873
00:40:04,460 --> 00:40:10,340
whatever buffers at eax pointing at

874
00:40:06,830 --> 00:40:12,049
we've 3c 000 doesn't match up with the

875
00:40:10,340 --> 00:40:13,640
officer that he gave me when he<font color="#E5E5E5"> told me</font>

876
00:40:12,050 --> 00:40:16,369
to look at this<font color="#E5E5E5"> at shell code which is</font>

877
00:40:13,640 --> 00:40:17,540
<font color="#E5E5E5">fine it's okay um if you know how</font>

878
00:40:16,369 --> 00:40:19,420
<font color="#E5E5E5">Windows works you're never going to get</font>

879
00:40:17,540 --> 00:40:21,410
the<font color="#E5E5E5"> same address loaded every time so</font>

880
00:40:19,420 --> 00:40:27,290
we'll just<font color="#CCCCCC"> step through it will step</font>

881
00:40:21,410 --> 00:40:28,910
into it<font color="#E5E5E5"> and then did I do this I do not</font>

882
00:40:27,290 --> 00:40:30,290
do this I didn't know it up to Ida I was

883
00:40:28,910 --> 00:40:34,279
gonna load it up to either but i forgot

884
00:40:30,290 --> 00:40:39,259
i was gonna do here but little slower

885
00:40:34,280 --> 00:40:40,760
than i wanted<font color="#E5E5E5"> to anyways um</font><font color="#CCCCCC"> like me I</font>

886
00:40:39,260 --> 00:40:49,850
with the back up hold on<font color="#E5E5E5"> give me a</font>

887
00:40:40,760 --> 00:40:52,730
second I do<font color="#E5E5E5"> not have it</font><font color="#CCCCCC"> ok but</font><font color="#E5E5E5"> basically</font>

888
00:40:49,850 --> 00:40:57,670
the way this<font color="#E5E5E5"> works is at this point i</font>

889
00:40:52,730 --> 00:40:57,670
can grab this with a leak and save

890
00:40:58,180 --> 00:41:05,180
backup sync data to file that saves a

891
00:41:01,400 --> 00:41:07,400
whole memory pejic page 20 file saves it

892
00:41:05,180 --> 00:41:08,600
and then you can load that up to<font color="#CCCCCC"> idle</font>

893
00:41:07,400 --> 00:41:10,940
<font color="#CCCCCC">and you can</font><font color="#E5E5E5"> start doing your analysis</font>

894
00:41:08,600 --> 00:41:12,980
from there and then<font color="#E5E5E5"> I can you know look</font>

895
00:41:10,940 --> 00:41:19,580
<font color="#E5E5E5">at that second um function day that he</font>

896
00:41:12,980 --> 00:41:22,310
was yes trouble with so load up in Ida

897
00:41:19,580 --> 00:41:26,840
Ida doesn't know if it's 62 16 16 or

898
00:41:22,310 --> 00:41:29,720
32-bit we know<font color="#E5E5E5"> 32 bit and it has one</font>

899
00:41:26,840 --> 00:41:32,869
function and then and it's ugly to look

900
00:41:29,720 --> 00:41:34,549
at and then<font color="#E5E5E5"> this is a whole other step</font>

901
00:41:32,869 --> 00:41:38,180
or kind of<font color="#E5E5E5"> walk to know how to clean</font>

902
00:41:34,550 --> 00:41:40,070
this up in this fight but<font color="#CCCCCC"> we won't doing</font>

903
00:41:38,180 --> 00:41:42,680
here because it's obviously not helpful

904
00:41:40,070 --> 00:41:43,790
but the whole idea is we got<font color="#E5E5E5"> in there I</font>

905
00:41:42,680 --> 00:41:47,000
kind<font color="#CCCCCC"> of spent a lot of time quicker</font>

906
00:41:43,790 --> 00:41:49,400
getting to where I wanted to be the end

907
00:41:47,000 --> 00:41:51,369
it long story short<font color="#E5E5E5"> the function</font>

908
00:41:49,400 --> 00:41:54,560
actually had a custom rc4 encryption

909
00:41:51,369 --> 00:41:58,250
there was a very it kind of hard to

910
00:41:54,560 --> 00:41:59,180
analyze but eventually we got I got that

911
00:41:58,250 --> 00:42:01,930
to him and

912
00:41:59,180 --> 00:42:06,740
and he was happy<font color="#E5E5E5"> to cut all the strings</font>

913
00:42:01,930 --> 00:42:08,419
so anyways there this other sample I

914
00:42:06,740 --> 00:42:12,950
don't know we won't<font color="#E5E5E5"> do it</font><font color="#CCCCCC"> because we</font>

915
00:42:08,420 --> 00:42:16,640
<font color="#E5E5E5">don't have time but um that's basically</font>

916
00:42:12,950 --> 00:42:17,868
um learn to wrap up so you want to know

917
00:42:16,640 --> 00:42:19,430
make<font color="#CCCCCC"> sure that when you reverse</font>

918
00:42:17,869 --> 00:42:21,170
something or you want in reverse to

919
00:42:19,430 --> 00:42:24,589
reverse something give them<font color="#E5E5E5"> some ideas</font>

920
00:42:21,170 --> 00:42:26,720
kind<font color="#E5E5E5"> of points to look at take the time</font>

921
00:42:24,589 --> 00:42:29,420
to you know do the basic or the basic

922
00:42:26,720 --> 00:42:30,770
dynamic analysis to be unboxing and

923
00:42:29,420 --> 00:42:31,700
things like that the third sample<font color="#E5E5E5"> I</font>

924
00:42:30,770 --> 00:42:34,130
really wanted<font color="#E5E5E5"> to go through</font><font color="#CCCCCC"> it because</font>

925
00:42:31,700 --> 00:42:37,490
it<font color="#CCCCCC"> was a</font><font color="#E5E5E5"> good idea of be able to</font>

926
00:42:34,130 --> 00:42:39,770
interpret the cuckoo results and this is

927
00:42:37,490 --> 00:42:42,259
actually<font color="#E5E5E5"> the sample only has two pages</font>

928
00:42:39,770 --> 00:42:44,450
of<font color="#E5E5E5"> the report</font><font color="#CCCCCC"> as far as behavioral</font>

929
00:42:42,260 --> 00:42:47,030
analysis that's very<font color="#E5E5E5"> very short for</font>

930
00:42:44,450 --> 00:42:48,819
<font color="#E5E5E5">example so when it's something</font><font color="#CCCCCC"> like that</font>

931
00:42:47,030 --> 00:42:51,619
sends out you can obviously pinpoint

932
00:42:48,819 --> 00:42:53,720
from those<font color="#E5E5E5"> API calls that it hooks where</font>

933
00:42:51,619 --> 00:42:56,859
look at where to jump into and do you

934
00:42:53,720 --> 00:42:58,759
reversing from there but anyway so

935
00:42:56,859 --> 00:43:01,910
basically it I don't know if anybody has

936
00:42:58,760 --> 00:43:05,569
any<font color="#CCCCCC"> questions apologize</font><font color="#E5E5E5"> for the mixup on</font>

937
00:43:01,910 --> 00:43:06,859
the second sample and then obviously for

938
00:43:05,569 --> 00:43:08,329
not be able<font color="#E5E5E5"> to do the third one if</font>

939
00:43:06,859 --> 00:43:10,369
anybody's interested be more than

940
00:43:08,329 --> 00:43:16,180
<font color="#E5E5E5">welcome to to walk you through if you</font>

941
00:43:10,369 --> 00:43:16,180
want<font color="#CCCCCC"> but we're done no</font><font color="#E5E5E5"> question</font>

